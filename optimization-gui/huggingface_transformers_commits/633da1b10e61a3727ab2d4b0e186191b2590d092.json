{
    "author": "shyshin",
    "message": "[Idefics3] Move image features to same device as input embeds (#35100)\n\n* [Idefics3] Move image features to same device as input embeds\r\n\r\n* Update src/transformers/models/idefics3/modeling_idefics3.py\r\n\r\n* make style\r\n\r\n---------\r\n\r\nCo-authored-by: Saif Rehman Nasir <shyshin@github.com>\r\nCo-authored-by: Raushan Turganbay <raushan.turganbay@alumni.nu.edu.kz>\r\nCo-authored-by: Raushan Turganbay <raushan@huggingface.co>",
    "sha": "633da1b10e61a3727ab2d4b0e186191b2590d092",
    "files": [
        {
            "sha": "0bfa2823c52e7db5d2a22939221fe438f59147c1",
            "filename": "src/transformers/models/idefics3/modeling_idefics3.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/633da1b10e61a3727ab2d4b0e186191b2590d092/src%2Ftransformers%2Fmodels%2Fidefics3%2Fmodeling_idefics3.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/633da1b10e61a3727ab2d4b0e186191b2590d092/src%2Ftransformers%2Fmodels%2Fidefics3%2Fmodeling_idefics3.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fidefics3%2Fmodeling_idefics3.py?ref=633da1b10e61a3727ab2d4b0e186191b2590d092",
            "patch": "@@ -899,7 +899,7 @@ def inputs_merger(\n         new_inputs_embeds = inputs_embeds.clone()\n         reshaped_image_hidden_states = image_hidden_states.view(-1, vision_hidden_size)\n         # cast to the dtype of the input_embeds to support quantized models\n-        reshaped_image_hidden_states = reshaped_image_hidden_states.to(inputs_embeds.dtype)\n+        reshaped_image_hidden_states = reshaped_image_hidden_states.to(inputs_embeds.device, inputs_embeds.dtype)\n         new_inputs_embeds[special_image_token_mask] = reshaped_image_hidden_states\n         return new_inputs_embeds\n "
        }
    ],
    "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    }
}