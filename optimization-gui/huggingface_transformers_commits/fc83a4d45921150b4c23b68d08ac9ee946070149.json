{
    "author": "umarbutler",
    "message": "Added support for bfloat16 to zero-shot classification pipeline (#33554)\n\n* Added support for bfloat16 to zero-shot classification pipeline\r\n\r\n* Ensure support for TF.\r\n\r\nCo-authored-by: Matt <Rocketknight1@users.noreply.github.com>\r\n\r\n* Remove dependency on `torch`.\r\n\r\nCo-authored-by: Matt <Rocketknight1@users.noreply.github.com>\r\n\r\n---------\r\n\r\nCo-authored-by: Matt <Rocketknight1@users.noreply.github.com>",
    "sha": "fc83a4d45921150b4c23b68d08ac9ee946070149",
    "files": [
        {
            "sha": "f4aee3341e30d55691ea74d0e90dd00ba4567c8b",
            "filename": "src/transformers/pipelines/zero_shot_classification.py",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/huggingface/transformers/blob/fc83a4d45921150b4c23b68d08ac9ee946070149/src%2Ftransformers%2Fpipelines%2Fzero_shot_classification.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/fc83a4d45921150b4c23b68d08ac9ee946070149/src%2Ftransformers%2Fpipelines%2Fzero_shot_classification.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fpipelines%2Fzero_shot_classification.py?ref=fc83a4d45921150b4c23b68d08ac9ee946070149",
            "patch": "@@ -239,7 +239,10 @@ def _forward(self, inputs):\n     def postprocess(self, model_outputs, multi_label=False):\n         candidate_labels = [outputs[\"candidate_label\"] for outputs in model_outputs]\n         sequences = [outputs[\"sequence\"] for outputs in model_outputs]\n-        logits = np.concatenate([output[\"logits\"].numpy() for output in model_outputs])\n+        if self.framework == \"pt\":\n+            logits = np.concatenate([output[\"logits\"].float().numpy() for output in model_outputs])\n+        else:\n+            logits = np.concatenate([output[\"logits\"].numpy() for output in model_outputs])\n         N = logits.shape[0]\n         n = len(candidate_labels)\n         num_sequences = N // n"
        }
    ],
    "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
    }
}