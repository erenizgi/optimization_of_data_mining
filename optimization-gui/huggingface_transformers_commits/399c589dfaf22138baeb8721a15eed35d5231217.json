{
    "author": "ahadnagy",
    "message": "Separate docker images for Nvidia and AMD in benchmarking (#41119)\n\nSeparate docker images for Nvidia and AMD",
    "sha": "399c589dfaf22138baeb8721a15eed35d5231217",
    "files": [
        {
            "sha": "fc9e07635185bb4eb07eef03a3a6fcd131c164de",
            "filename": ".github/workflows/benchmark_v2.yml",
            "status": "modified",
            "additions": 10,
            "deletions": 2,
            "changes": 12,
            "blob_url": "https://github.com/huggingface/transformers/blob/399c589dfaf22138baeb8721a15eed35d5231217/.github%2Fworkflows%2Fbenchmark_v2.yml",
            "raw_url": "https://github.com/huggingface/transformers/raw/399c589dfaf22138baeb8721a15eed35d5231217/.github%2Fworkflows%2Fbenchmark_v2.yml",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fworkflows%2Fbenchmark_v2.yml?ref=399c589dfaf22138baeb8721a15eed35d5231217",
            "patch": "@@ -7,6 +7,14 @@ on:\n         description: 'GH Actions runner group to use'\n         required: true\n         type: string\n+      container_image:\n+        description: 'Docker image to use'\n+        required: true\n+        type: string\n+      container_options:\n+        description: 'Container options to use'\n+        required: true\n+        type: string\n       commit_sha:\n         description: 'Commit SHA to benchmark'\n         required: false\n@@ -38,8 +46,8 @@ jobs:\n       (github.event_name == 'pull_request' && contains( github.event.pull_request.labels.*.name, 'run-benchmark')) ||\n       (github.event_name == 'schedule')\n     container:\n-      image: huggingface/transformers-pytorch-gpu\n-      options: --gpus all --privileged --ipc host --shm-size \"16gb\"\n+      image: ${{ inputs.container_image }}\n+      options: ${{ inputs.container_options }}\n     steps:\n       - name: Get repo\n         uses: actions/checkout@v4"
        },
        {
            "sha": "6573d398b000128ab9f3fecf0752e5551beae0de",
            "filename": ".github/workflows/benchmark_v2_a10_caller.yml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/399c589dfaf22138baeb8721a15eed35d5231217/.github%2Fworkflows%2Fbenchmark_v2_a10_caller.yml",
            "raw_url": "https://github.com/huggingface/transformers/raw/399c589dfaf22138baeb8721a15eed35d5231217/.github%2Fworkflows%2Fbenchmark_v2_a10_caller.yml",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fworkflows%2Fbenchmark_v2_a10_caller.yml?ref=399c589dfaf22138baeb8721a15eed35d5231217",
            "patch": "@@ -13,6 +13,8 @@ jobs:\n     uses: ./.github/workflows/benchmark_v2.yml\n     with:\n       runner: aws-g5-4xlarge-cache-use1-public-80\n+      container_image: huggingface/transformers-pytorch-gpu\n+      container_options: --gpus all --privileged --ipc host --shm-size \"16gb\"\n       commit_sha: ${{ github.sha }}\n       run_id: ${{ github.run_id }}\n       benchmark_repo_id: hf-internal-testing/transformers-daily-benchmarks"
        },
        {
            "sha": "ed403148e59671cb8c03cf7e02d044bf966262ad",
            "filename": ".github/workflows/benchmark_v2_mi325_caller.yml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/399c589dfaf22138baeb8721a15eed35d5231217/.github%2Fworkflows%2Fbenchmark_v2_mi325_caller.yml",
            "raw_url": "https://github.com/huggingface/transformers/raw/399c589dfaf22138baeb8721a15eed35d5231217/.github%2Fworkflows%2Fbenchmark_v2_mi325_caller.yml",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fworkflows%2Fbenchmark_v2_mi325_caller.yml?ref=399c589dfaf22138baeb8721a15eed35d5231217",
            "patch": "@@ -13,6 +13,8 @@ jobs:\n     uses: ./.github/workflows/benchmark_v2.yml\n     with:\n       runner: amd-mi325-ci-1gpu\n+      container_image: huggingface/transformers-pytorch-amd-gpu\n+      container_options: --device /dev/kfd --device /dev/dri --env ROCR_VISIBLE_DEVICES --shm-size \"16gb\" --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache\n       commit_sha: ${{ github.sha }}\n       run_id: ${{ github.run_id }}\n       benchmark_repo_id: hf-internal-testing/transformers-daily-benchmarks"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 14,
        "deletions": 2
    }
}