{
    "author": "ydshieh",
    "message": "unpin torch/torchcodec for CircleCI (#41839)\n\nCirCleCI with torch 2.9\n\nCo-authored-by: ydshieh <ydshieh@users.noreply.github.com>",
    "sha": "9c20660138830ca362533551ca978c27b48283a1",
    "files": [
        {
            "sha": "0c973d06afa9fe1dc1c903804b7a8a296e4c1cf1",
            "filename": "docker/consistency.dockerfile",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/9c20660138830ca362533551ca978c27b48283a1/docker%2Fconsistency.dockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/9c20660138830ca362533551ca978c27b48283a1/docker%2Fconsistency.dockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Fconsistency.dockerfile?ref=9c20660138830ca362533551ca978c27b48283a1",
            "patch": "@@ -5,7 +5,7 @@ ARG REF=main\n RUN apt-get update && apt-get install -y time git g++ pkg-config make git-lfs\n ENV UV_PYTHON=/usr/local/bin/python\n RUN pip install uv && uv pip install --no-cache-dir -U pip setuptools GitPython\n-RUN uv pip install --no-cache-dir --upgrade 'torch<2.9' 'torchaudio' 'torchvision' --index-url https://download.pytorch.org/whl/cpu\n+RUN uv pip install --no-cache-dir --upgrade 'torch' 'torchaudio' 'torchvision' --index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install --no-cache-dir pypi-kenlm\n RUN uv pip install --no-cache-dir \"git+https://github.com/huggingface/transformers.git@${REF}#egg=transformers[quality,testing,torch-speech,vision]\"\n RUN git lfs install"
        },
        {
            "sha": "c00a9edb7db26eea54e6e5588ad1baf61d611aee",
            "filename": "docker/custom-tokenizers.dockerfile",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/9c20660138830ca362533551ca978c27b48283a1/docker%2Fcustom-tokenizers.dockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/9c20660138830ca362533551ca978c27b48283a1/docker%2Fcustom-tokenizers.dockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Fcustom-tokenizers.dockerfile?ref=9c20660138830ca362533551ca978c27b48283a1",
            "patch": "@@ -17,7 +17,7 @@ RUN make install -j 10\n \n WORKDIR /\n \n-RUN uv pip install --no-cache --upgrade 'torch<2.9' --index-url https://download.pytorch.org/whl/cpu\n+RUN uv pip install --no-cache --upgrade 'torch' --index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install --no-cache-dir  --no-deps accelerate --extra-index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install  --no-cache-dir \"git+https://github.com/huggingface/transformers.git@${REF}#egg=transformers[ja,testing,sentencepiece,spacy,ftfy,rjieba]\" unidic unidic-lite\n # spacy is not used so not tested. Causes to failures. TODO fix later"
        },
        {
            "sha": "5960930ae48c5e627b5a868d1bbe199fb27c67dc",
            "filename": "docker/examples-torch.dockerfile",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/9c20660138830ca362533551ca978c27b48283a1/docker%2Fexamples-torch.dockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/9c20660138830ca362533551ca978c27b48283a1/docker%2Fexamples-torch.dockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Fexamples-torch.dockerfile?ref=9c20660138830ca362533551ca978c27b48283a1",
            "patch": "@@ -5,7 +5,7 @@ USER root\n RUN apt-get update &&  apt-get install -y --no-install-recommends libsndfile1-dev espeak-ng time git g++ cmake pkg-config openssh-client git-lfs ffmpeg curl\n ENV UV_PYTHON=/usr/local/bin/python\n RUN pip --no-cache-dir install uv && uv pip install --no-cache-dir -U pip setuptools\n-RUN uv pip install --no-cache-dir 'torch<2.9' 'torchaudio' 'torchvision' 'torchcodec<0.8' --index-url https://download.pytorch.org/whl/cpu\n+RUN uv pip install --no-cache-dir 'torch' 'torchaudio' 'torchvision' 'torchcodec' --index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install --no-deps timm accelerate --extra-index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install --no-cache-dir librosa \"git+https://github.com/huggingface/transformers.git@${REF}#egg=transformers[sklearn,sentencepiece,vision,testing]\" seqeval albumentations jiwer\n "
        },
        {
            "sha": "1e16ae77d4a953dce0fb1a1e08d178f5b9bfd2b1",
            "filename": "docker/exotic-models.dockerfile",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/9c20660138830ca362533551ca978c27b48283a1/docker%2Fexotic-models.dockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/9c20660138830ca362533551ca978c27b48283a1/docker%2Fexotic-models.dockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Fexotic-models.dockerfile?ref=9c20660138830ca362533551ca978c27b48283a1",
            "patch": "@@ -5,7 +5,7 @@ USER root\n RUN apt-get update && apt-get install -y libsndfile1-dev espeak-ng time git libgl1 g++ tesseract-ocr git-lfs curl\n ENV UV_PYTHON=/usr/local/bin/python\n RUN pip --no-cache-dir install uv && uv pip install --no-cache-dir -U pip setuptools\n-RUN uv pip install --no-cache-dir 'torch<2.9' 'torchaudio' 'torchvision' --index-url https://download.pytorch.org/whl/cpu\n+RUN uv pip install --no-cache-dir 'torch' 'torchaudio' 'torchvision' --index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install --no-cache-dir  --no-deps timm accelerate\n RUN uv pip install -U --no-cache-dir pytesseract python-Levenshtein opencv-python nltk\n # RUN uv pip install --no-cache-dir natten==0.15.1+torch210cpu -f https://shi-labs.com/natten/wheels"
        },
        {
            "sha": "e434eeaed93fbb274e2239798b8efde3de986af0",
            "filename": "docker/pipeline-torch.dockerfile",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/9c20660138830ca362533551ca978c27b48283a1/docker%2Fpipeline-torch.dockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/9c20660138830ca362533551ca978c27b48283a1/docker%2Fpipeline-torch.dockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Fpipeline-torch.dockerfile?ref=9c20660138830ca362533551ca978c27b48283a1",
            "patch": "@@ -5,7 +5,7 @@ USER root\n RUN apt-get update &&  apt-get install -y --no-install-recommends libsndfile1-dev espeak-ng time git pkg-config openssh-client git ffmpeg curl\n ENV UV_PYTHON=/usr/local/bin/python\n RUN pip --no-cache-dir install uv && uv pip install --no-cache-dir -U pip setuptools\n-RUN uv pip install --no-cache-dir 'torch<2.9' 'torchaudio' 'torchvision' 'torchcodec<0.8' --index-url https://download.pytorch.org/whl/cpu\n+RUN uv pip install --no-cache-dir 'torch' 'torchaudio' 'torchvision' 'torchcodec' --index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install --no-deps timm accelerate --extra-index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install --no-cache-dir librosa \"git+https://github.com/huggingface/transformers.git@${REF}#egg=transformers[sklearn,sentencepiece,vision,testing]\"\n "
        },
        {
            "sha": "14ba613bdb37c86d4d843afaed1f9018d9ec65b9",
            "filename": "docker/torch-light.dockerfile",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/9c20660138830ca362533551ca978c27b48283a1/docker%2Ftorch-light.dockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/9c20660138830ca362533551ca978c27b48283a1/docker%2Ftorch-light.dockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftorch-light.dockerfile?ref=9c20660138830ca362533551ca978c27b48283a1",
            "patch": "@@ -5,7 +5,7 @@ USER root\n RUN apt-get update &&  apt-get install -y --no-install-recommends libsndfile1-dev espeak-ng time git g++ cmake pkg-config openssh-client git-lfs ffmpeg curl\n ENV UV_PYTHON=/usr/local/bin/python\n RUN pip --no-cache-dir install uv && uv pip install --no-cache-dir -U pip setuptools\n-RUN uv pip install --no-cache-dir 'torch<2.9' 'torchaudio' 'torchvision' 'torchcodec<0.8' --index-url https://download.pytorch.org/whl/cpu\n+RUN uv pip install --no-cache-dir 'torch' 'torchaudio' 'torchvision' 'torchcodec' --index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install --no-deps timm accelerate --extra-index-url https://download.pytorch.org/whl/cpu\n RUN uv pip install --no-cache-dir librosa \"git+https://github.com/huggingface/transformers.git@${REF}#egg=transformers[sklearn,sentencepiece,vision,testing,tiktoken,num2words,video]\"\n "
        },
        {
            "sha": "ea5288cc0eeb7c97108cee3509d1775afcc3c002",
            "filename": "setup.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/9c20660138830ca362533551ca978c27b48283a1/setup.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/9c20660138830ca362533551ca978c27b48283a1/setup.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/setup.py?ref=9c20660138830ca362533551ca978c27b48283a1",
            "patch": "@@ -170,7 +170,7 @@\n     \"tiktoken\",\n     \"timm<=1.0.19,!=1.0.18\",\n     \"tokenizers>=0.22.0,<=0.23.0\",\n-    \"torch>=2.2,<2.9\",\n+    \"torch>=2.2\",\n     \"torchaudio\",\n     \"torchvision\",\n     \"pyctcdecode>=0.4.0\","
        },
        {
            "sha": "ad0c59f764f82c3bda7cf3cc5f179b90c4e6f2f0",
            "filename": "src/transformers/dependency_versions_table.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/9c20660138830ca362533551ca978c27b48283a1/src%2Ftransformers%2Fdependency_versions_table.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/9c20660138830ca362533551ca978c27b48283a1/src%2Ftransformers%2Fdependency_versions_table.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fdependency_versions_table.py?ref=9c20660138830ca362533551ca978c27b48283a1",
            "patch": "@@ -77,7 +77,7 @@\n     \"tiktoken\": \"tiktoken\",\n     \"timm\": \"timm<=1.0.19,!=1.0.18\",\n     \"tokenizers\": \"tokenizers>=0.22.0,<=0.23.0\",\n-    \"torch\": \"torch>=2.2,<2.9\",\n+    \"torch\": \"torch>=2.2\",\n     \"torchaudio\": \"torchaudio\",\n     \"torchvision\": \"torchvision\",\n     \"pyctcdecode\": \"pyctcdecode>=0.4.0\","
        },
        {
            "sha": "e1a7532c8fadc8ce12782a47a0603931b55dda4e",
            "filename": "src/transformers/video_utils.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/9c20660138830ca362533551ca978c27b48283a1/src%2Ftransformers%2Fvideo_utils.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/9c20660138830ca362533551ca978c27b48283a1/src%2Ftransformers%2Fvideo_utils.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fvideo_utils.py?ref=9c20660138830ca362533551ca978c27b48283a1",
            "patch": "@@ -594,7 +594,7 @@ def sample_indices_fn(metadata, **kwargs):\n         seek_mode=\"exact\",\n         # Allow FFmpeg decide on the number of threads for efficiency\n         num_ffmpeg_threads=0,\n-        device=kwargs.get(\"device\"),\n+        device=kwargs.get(\"device\", \"cpu\"),\n     )\n     metadata = VideoMetadata(\n         total_num_frames=decoder.metadata.num_frames,"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 9,
        "deletions": 9
    }
}