{
    "author": "jitesh-gupta",
    "message": "Cache latest pytorch amd image locally on mi325 CI runner cluster (#41926)",
    "sha": "76fc50a1527a7db593a6057903b749598f7000a9",
    "files": [
        {
            "sha": "45fd82c21d2a6c62a3a4923e96ff2021b254724f",
            "filename": ".github/workflows/build-docker-images.yml",
            "status": "modified",
            "additions": 31,
            "deletions": 0,
            "changes": 31,
            "blob_url": "https://github.com/huggingface/transformers/blob/76fc50a1527a7db593a6057903b749598f7000a9/.github%2Fworkflows%2Fbuild-docker-images.yml",
            "raw_url": "https://github.com/huggingface/transformers/raw/76fc50a1527a7db593a6057903b749598f7000a9/.github%2Fworkflows%2Fbuild-docker-images.yml",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fworkflows%2Fbuild-docker-images.yml?ref=76fc50a1527a7db593a6057903b749598f7000a9",
            "patch": "@@ -200,6 +200,37 @@ jobs:\n           status: ${{ job.status }}\n           slack_token: ${{ secrets.SLACK_CIFEEDBACK_BOT_TOKEN }}\n \n+  cache-latest-pytorch-amd:\n+    name: \"Cache Latest Pytorch (AMD) Image\"\n+    needs: latest-pytorch-amd\n+    runs-on:\n+      group: amd-mi325-1gpu\n+    steps:\n+      -\n+        name: Login to DockerHub\n+        uses: docker/login-action@v3\n+        with:\n+          username: ${{ secrets.DOCKERHUB_USERNAME }}\n+          password: ${{ secrets.DOCKERHUB_PASSWORD }}\n+        \n+      - \n+        name: Pull and save docker image to cache\n+        run: |\n+          image=\"huggingface/transformers-pytorch-amd-gpu\"\n+          final_path=\"/mnt/image-cache/transformers-pytorch-amd-gpu.tar\"\n+          tmp_path=\"${final_path}.tmp\"\n+\n+          echo \"Pulling image: ${image}\"\n+          docker pull \"${image}\"\n+\n+          echo \"Saving to temp file: ${tmp_path}\"\n+          docker save \"${image}\" -o \"${tmp_path}\"\n+\n+          echo \"Moving to final path: ${final_path}\"\n+          mv -f \"${tmp_path}\" \"${final_path}\"\n+\n+          echo \"Cache populated successfully at ${final_path}\"\n+\n   latest-pytorch-deepspeed-amd:\n     name: \"PyTorch + DeepSpeed (AMD) [dev]\"\n     runs-on:"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 31,
        "deletions": 0
    }
}