{
    "author": "manueldeprada",
    "message": "Add test to ensure unknown exceptions reraising in utils/hub.py::cached_files() (#37651)\n\n* add test to ensure unknown exceptions are reraised in utils/hub.py::cached_files()",
    "sha": "1cd110c6cb6a6237614130c470e9a902dbc1a4bd",
    "files": [
        {
            "sha": "0bccec449f0d5343af5c959b4dcf002323e3d5a4",
            "filename": "tests/utils/test_hub_utils.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/huggingface/transformers/blob/1cd110c6cb6a6237614130c470e9a902dbc1a4bd/tests%2Futils%2Ftest_hub_utils.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/1cd110c6cb6a6237614130c470e9a902dbc1a4bd/tests%2Futils%2Ftest_hub_utils.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Futils%2Ftest_hub_utils.py?ref=1cd110c6cb6a6237614130c470e9a902dbc1a4bd",
            "patch": "@@ -189,3 +189,12 @@ def test_has_file_gated_repo(self):\n         with self.assertRaisesRegex(EnvironmentError, \"is a gated repository\"):\n             # All files except README.md are protected on a gated repo.\n             has_file(GATED_REPO, \"gated_file.txt\", token=False)\n+\n+    def test_cached_files_exception_raised(self):\n+        \"\"\"Test that unhadled exceptions, e.g. ModuleNotFoundError, is properly re-raised by cached_files when hf_hub_download fails.\"\"\"\n+        with mock.patch(\n+            \"transformers.utils.hub.hf_hub_download\", side_effect=ModuleNotFoundError(\"No module named 'MockModule'\")\n+        ):\n+            with self.assertRaises(ModuleNotFoundError):\n+                # The error should be re-raised by cached_files, not caught in the exception handling block\n+                cached_file(RANDOM_BERT, \"nonexistent.json\")"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 9,
        "deletions": 0
    }
}