{
    "author": "ebezzam",
    "message": "Clean up X-Codec. (#40271)\n\n* Clean up xcodec addition.\n\n* Clean up config.\n\n* Switch to fixtures test.\n\n* Small stuff.",
    "sha": "d0f1a6ec3692160302a21613d8b7599aabf49f17",
    "files": [
        {
            "sha": "70beed9185a4fe91930141fce746f1fe75b78ad2",
            "filename": "docs/source/en/_toctree.yml",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/docs%2Fsource%2Fen%2F_toctree.yml",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/docs%2Fsource%2Fen%2F_toctree.yml",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2F_toctree.yml?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -693,8 +693,6 @@\n         title: UL2\n       - local: model_doc/umt5\n         title: UMT5\n-      - local: model_doc/xcodec\n-        title: X-CODEC\n       - local: model_doc/xmod\n         title: X-MOD\n       - local: model_doc/xglm\n@@ -945,6 +943,8 @@\n         title: WavLM\n       - local: model_doc/whisper\n         title: Whisper\n+      - local: model_doc/xcodec\n+        title: X-Codec\n       - local: model_doc/xls_r\n         title: XLS-R\n       - local: model_doc/xlsr_wav2vec2"
        },
        {
            "sha": "c4a0b92a26f612fc09ae48a29fea747169314d2d",
            "filename": "docs/source/en/model_doc/xcodec.md",
            "status": "modified",
            "additions": 19,
            "deletions": 10,
            "changes": 29,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/docs%2Fsource%2Fen%2Fmodel_doc%2Fxcodec.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/docs%2Fsource%2Fen%2Fmodel_doc%2Fxcodec.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fxcodec.md?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -1,4 +1,4 @@\n-<!--Copyright 2023 The HuggingFace Team. All rights reserved.\n+<!--Copyright 2025 The HuggingFace Team. All rights reserved.\n \n Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n the License. You may obtain a copy of the License at\n@@ -13,6 +13,7 @@ specific language governing permissions and limitations under the License.\n rendered properly in your Markdown viewer.\n \n -->\n+*This model was released on 2024-08-30 and added to Hugging Face Transformers on 2025-08-15.*\n \n # X-Codec\n \n@@ -22,23 +23,28 @@ rendered properly in your Markdown viewer.\n \n ## Overview\n \n-The X-Codec model was proposed in [Codec Does Matter: Exploring the Semantic Shortcoming of Codec for Audio Language Model](https://arxiv.org/abs/2408.17175) by Zhen Ye,Â Peiwen Sun,Â Jiahe Lei,Â Hongzhan Lin,Â Xu Tan,Â Zheqi Dai,Â Qiuqiang Kong,Â Jianyi Chen,Â Jiahao Pan,Â Qifeng Liu,Â Yike Guo,Â Wei Xue\n+The X-Codec model was proposed in [Codec Does Matter: Exploring the Semantic Shortcoming of Codec for Audio Language Model](https://huggingface.co/papers/2408.17175) by Zhen Ye,Â Peiwen Sun,Â Jiahe Lei,Â Hongzhan Lin,Â Xu Tan,Â Zheqi Dai,Â Qiuqiang Kong,Â Jianyi Chen,Â Jiahao Pan,Â Qifeng Liu,Â Yike Guo,Â Wei Xue.\n \n-The X-Codec model is a neural audio codec that integrates semantic information from self-supervised models (e.g., HuBERT) alongside traditional acoustic information. This enables :\n+The X-Codec model is a neural audio codec that integrates semantic information from self-supervised models (e.g., HuBERT) alongside traditional acoustic information. This enables:\n \n-- **Music continuation** : Better modeling of musical semantics yields more coherent continuations.\n-- **Text-to-Sound Synthesis** : X-Codec captures semantic alignment between text prompts and generated audio.\n+- **Music continuation**: Better modeling of musical semantics yields more coherent continuations.\n+- **Text-to-Sound Synthesis**: X-Codec captures semantic alignment between text prompts and generated audio.\n - **Semantic aware audio tokenization**: X-Codec is used as an audio tokenizer in the YuE lyrics to song generation model.\n \n The abstract of the paper states the following:\n \n *Recent advancements in audio generation have been significantly propelled by the capabilities of Large Language Models (LLMs). The existing research on audio LLM has primarily focused on enhancing the architecture and scale of audio language models, as well as leveraging larger datasets, and generally, acoustic codecs, such as EnCodec, are used for audio tokenization. However, these codecs were originally designed for audio compression, which may lead to suboptimal performance in the context of audio LLM. Our research aims to address the shortcomings of current audio LLM codecs, particularly their challenges in maintaining semantic integrity in generated audio. For instance, existing methods like VALL-E, which condition acoustic token generation on text transcriptions, often suffer from content inaccuracies and elevated word error rates (WER) due to semantic misinterpretations of acoustic tokens, resulting in word skipping and errors. To overcome these issues, we propose a straightforward yet effective approach called X-Codec. X-Codec incorporates semantic features from a pre-trained semantic encoder before the Residual Vector Quantization (RVQ) stage and introduces a semantic reconstruction loss after RVQ. By enhancing the semantic ability of the codec, X-Codec significantly reduces WER in speech synthesis tasks and extends these benefits to non-speech applications, including music and sound generation. Our experiments in text-to-speech, music continuation, and text-to-sound tasks demonstrate that integrating semantic information substantially improves the overall performance of language models in audio generation.* \n \n-Demos can be found in this [post](https://x-codec-audio.github.io/).\n+Model cards:\n+- [xcodec-hubert-librispeech](https://huggingface.co/hf-audio/xcodec-hubert-librispeech) (for speech)\n+- [xcodec-wavlm-mls](https://huggingface.co/hf-audio/xcodec-wavlm-mls) (for speech)\n+- [xcodec-wavlm-more-data](https://huggingface.co/hf-audio/xcodec-wavlm-more-data) (for speech)\n+- [xcodec-hubert-general](https://huggingface.co/hf-audio/xcodec-hubert-general) (for general audio)\n+- [xcodec-hubert-general-balanced](https://huggingface.co/hf-audio/xcodec-hubert-general-balanced) (for general audio)\n \n+This model was contributed byÂ [Manal El Aidouni](https://huggingface.co/Manel). The original code can be foundÂ [here](https://github.com/zhenye234/xcodec) and original checkpoints for the five different models [here](https://github.com/zhenye234/xcodec?tab=readme-ov-file#available-models).\n \n-This model was contributed byÂ [Manal El Aidouni](https://huggingface.co/Manel). The original code can be foundÂ [here](https://github.com/zhenye234/xcodec) and original checkpoint [here](https://huggingface.co/ZhenYe234/xcodec/blob/main/xcodec_speech_hubert_librispeech.pth).\n-\n+Demos can be found on this [page](https://x-codec-audio.github.io/).\n \n \n ## Usage example \n@@ -51,13 +57,16 @@ from transformers import XcodecModel, AutoFeatureExtractor\n dummy_dataset = load_dataset(\"hf-internal-testing/librispeech_asr_dummy\", \"clean\", split=\"validation\")\n \n # load model and feature extractor\n-model = XcodecModel.from_pretrained(\"Manel/X-Codec\")\n-feature_extractor = AutoFeatureExtractor.from_pretrained(\"Manel/X-Codec\")\n+model_id = \"hf-audio/xcodec-hubert-librispeech\"\n+model = XcodecModel.from_pretrained(model_id)\n+feature_extractor = AutoFeatureExtractor.from_pretrained(model_id)\n+\n # load audio sample\n dummy_dataset = dummy_dataset.cast_column(\"audio\", Audio(sampling_rate=feature_extractor.sampling_rate))\n audio_sample = dummy_dataset[-1][\"audio\"][\"array\"]\n inputs = feature_extractor(raw_audio=audio_sample, sampling_rate=feature_extractor.sampling_rate, return_tensors=\"pt\")\n \n+# encode and decode\n encoder_outputs = model.encode(inputs[\"input_values\"])\n decoder_outputs = model.decode(encoder_outputs.audio_codes)\n audio_values = decoder_outputs.audio_values"
        },
        {
            "sha": "0307aeba077fdf8d00d4d7895c2a76368532fbfd",
            "filename": "src/transformers/models/auto/feature_extraction_auto.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fauto%2Ffeature_extraction_auto.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fauto%2Ffeature_extraction_auto.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fauto%2Ffeature_extraction_auto.py?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -115,7 +115,7 @@\n         (\"wavlm\", \"Wav2Vec2FeatureExtractor\"),\n         (\"whisper\", \"WhisperFeatureExtractor\"),\n         (\"xclip\", \"CLIPFeatureExtractor\"),\n-        (\"xcodec\", \"EncodecFeatureExtractor\"),\n+        (\"xcodec\", \"DacFeatureExtractor\"),\n         (\"yolos\", \"YolosFeatureExtractor\"),\n     ]\n )"
        },
        {
            "sha": "17c79e8aeeed547655d59eb8543333b0b7425319",
            "filename": "src/transformers/models/xcodec/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fxcodec%2F__init__.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fxcodec%2F__init__.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fxcodec%2F__init__.py?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -1,4 +1,4 @@\n-# Copyright 2024 The HuggingFace Team. All rights reserved.\n+# Copyright 2025 The HuggingFace Team. All rights reserved.\n #\n # Licensed under the Apache License, Version 2.0 (the \"License\");\n # you may not use this file except in compliance with the License."
        },
        {
            "sha": "959838cc1d575f6bad7b10a68acbbeec2d25b9ec",
            "filename": "src/transformers/models/xcodec/configuration_xcodec.py",
            "status": "modified",
            "additions": 50,
            "deletions": 50,
            "changes": 100,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fxcodec%2Fconfiguration_xcodec.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fxcodec%2Fconfiguration_xcodec.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fxcodec%2Fconfiguration_xcodec.py?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -1,5 +1,5 @@\n # coding=utf-8\n-# Copyright 2024 Descript and The HuggingFace Inc. team. All rights reserved.\n+# Copyright 2025 The HuggingFace Inc. team. All rights reserved.\n #\n # Licensed under the Apache License, Version 2.0 (the \"License\");\n # you may not use this file except in compliance with the License.\n@@ -19,7 +19,7 @@\n \n import numpy as np\n \n-from transformers import DacConfig, HubertConfig\n+from transformers import AutoConfig, DacConfig, HubertConfig, WavLMConfig\n \n from ...configuration_utils import PretrainedConfig\n from ...utils import logging\n@@ -41,14 +41,8 @@ class XcodecConfig(PretrainedConfig):\n     Args:\n         target_bandwidths (`List[float]`, *optional*, defaults to `[0.5, 1, 1.5, 2, 4]`):\n             The range of different bandwidths (in kbps) the model can encode audio with.\n-        audio_channels (`int`, *optional*, defaults to 1):\n-            Number of channels in the audio data. Either 1 for mono or 2 for stereo.\n         sample_rate (`int`, *optional*, defaults to 16000):\n             The sampling rate at which the audio waveform should be digitalized, in hertz (Hz).\n-        input_channels (`int`, *optional*, defaults to 768):\n-            Number of channels of the input to the first convolution in the semantic encoder.\n-        encoder_channels (`int`, *optional*, defaults to 768):\n-            Number of hidden channels in each semantic encoder block.\n         kernel_size (`int`, *optional*, defaults to 3):\n             Kernel size for the initial semantic convolution.\n         channel_ratios (`List[float]`, *optional*, defaults to `[1, 1]`):\n@@ -59,38 +53,26 @@ class XcodecConfig(PretrainedConfig):\n             Dilation factors for the residual units in semantic blocks.\n         unit_kernel_size (`int`, *optional*, defaults to 3):\n             Kernel size inside each ResidualUnit in semantic blocks.\n-        decoder_channels (`int`, *optional*, defaults to 768):\n-            Number of hidden channels in each semantic decoder block.\n-        output_channels (`int`, *optional*, defaults to 768):\n-            Number of output channels in the semantic decoder.\n         codebook_size (`int`, *optional*, defaults to 1024):\n-            Number of entries in each residual quantizerâ€™s codebook.\n-        num_quantizers (`int`, *optional*, defaults to 8):\n-            Number of sequential quantizers (codebooks) in the RVQ stack.\n-        codebook_dim (`int`, *optional*, defaults to 1024):\n-            Dimensionality of each codebook vector.\n+            Number of entries in each residual quantizer's codebook.\n+        codebook_dim (`int`, *optional*):\n+            Dimensionality of each codebook vector. Defaults to sum of hidden size of acoustic and semantic models.\n         initializer_range (`float`, *optional*, defaults to 0.02):\n             Standard deviation of the truncated normal initializer for all weight matrices.\n-        hidden_dim (`int`, *optional*, defaults to 1024):\n-            Dimensionality of the joint acoustic+semantic FC layer.\n-        intermediate_dim (`int`, *optional*, defaults to 768):\n-            Dimensionality of the next FC layer in the decoder path.\n-        output_dim (`int`, *optional*, defaults to 256):\n-            Dimensionality of the final FC layer before feeding into the acoustic decoder.\n         acoustic_model_config (`Union[Dict, DacConfig]`, *optional*):\n             An instance of the configuration for the acoustic (DAC) model.\n-        semantic_model_config (`Union[Dict, HubertConfig]`, *optional*):\n+        semantic_model_config (`Union[Dict, HubertConfig, WavLMConfig]`, *optional*):\n             An instance of the configuration object for the semantic (HuBERT) model.\n \n     Example:\n \n     ```python\n     >>> from transformers import XcodecModel, XcodecConfig\n \n-    >>> # Initializing a \" \" style configuration\n+    >>> # Initializing configuration\n     >>> configuration = XcodecConfig()\n \n-    >>> # Initializing a model (with random weights) from the \" \" style configuration\n+    >>> # Initializing a model (with random weights) from the configuration\n     >>> model = XcodecModel(configuration)\n \n     >>> # Accessing the model configuration\n@@ -101,30 +83,21 @@ class XcodecConfig(PretrainedConfig):\n \n     sub_configs = {\n         \"acoustic_model_config\": DacConfig,\n-        \"semantic_model_config\": HubertConfig,\n+        \"semantic_model_config\": AutoConfig,\n     }\n \n     def __init__(\n         self,\n         target_bandwidths: Optional[list[float]] = None,\n-        audio_channels: int = 1,\n         sample_rate: int = 16000,\n-        input_channels: int = 768,\n-        encoder_channels: int = 768,\n         kernel_size: int = 3,\n         channel_ratios: list[float] = [1, 1],\n         strides: list[int] = [1, 1],\n         block_dilations: list[int] = [1, 1],\n         unit_kernel_size: int = 3,\n-        decoder_channels: int = 768,\n-        output_channels: int = 768,\n         codebook_size: int = 1024,\n-        num_quantizers: int = 8,\n-        codebook_dim: int = 1024,\n+        codebook_dim: Optional[int] = None,\n         initializer_range: float = 0.02,\n-        hidden_dim: int = 1024,\n-        intermediate_dim: int = 768,\n-        output_dim: int = 256,\n         acoustic_model_config: Union[dict, DacConfig] = None,\n         semantic_model_config: Union[dict, HubertConfig] = None,\n         **kwargs,\n@@ -134,6 +107,8 @@ def __init__(\n         if acoustic_model_config is None:\n             self.acoustic_model_config = DacConfig(\n                 encoder_hidden_size=64,\n+                # NOTE: original DAC uses [2, 4, 8, 8] `downsampling ratios`, namely reverse of `upsampling_ratios`\n+                # (not sure if intentional by Xcodec but we keep it)\n                 downsampling_ratios=[8, 5, 4, 2],\n                 decoder_hidden_size=1024,\n                 upsampling_ratios=[8, 5, 4, 2],\n@@ -143,44 +118,69 @@ def __init__(\n             self.acoustic_model_config = DacConfig(**acoustic_model_config)\n         elif isinstance(acoustic_model_config, DacConfig):\n             self.acoustic_model_config = acoustic_model_config\n+        else:\n+            raise ValueError(\n+                f\"acoustic_model_config must be a dict or DacConfig instance, but got {type(acoustic_model_config)}\"\n+            )\n \n         if semantic_model_config is None:\n             self.semantic_model_config = HubertConfig()\n         elif isinstance(semantic_model_config, dict):\n-            self.semantic_model_config = HubertConfig(**semantic_model_config)\n-        elif isinstance(semantic_model_config, HubertConfig):\n+            if \"_name_or_path\" in semantic_model_config:\n+                # If the config is a path, load it using AutoConfig\n+                self.semantic_model_config = AutoConfig.from_pretrained(semantic_model_config[\"_name_or_path\"])\n+            else:\n+                # assume HubertConfig as probably created from scratch\n+                logger.warning(\n+                    \"Could not determine semantic model type from config architecture. Defaulting to `HubertConfig`.\"\n+                )\n+                self.semantic_model_config = HubertConfig(**semantic_model_config)\n+        elif isinstance(semantic_model_config, WavLMConfig) or isinstance(semantic_model_config, HubertConfig):\n             self.semantic_model_config = semantic_model_config\n+        else:\n+            raise ValueError(\n+                f\"semantic_model_config must be a dict, HubertConfig, or WavLMConfig instance, but got {type(semantic_model_config)}\"\n+            )\n \n         if target_bandwidths is None:\n             target_bandwidths = [0.5, 1, 1.5, 2, 4]\n \n         self.target_bandwidths = target_bandwidths\n-        self.audio_channels = audio_channels\n         self.sample_rate = sample_rate\n-        self.input_channels = input_channels\n-        self.encoder_channels = encoder_channels\n         self.kernel_size = kernel_size\n         self.channel_ratios = channel_ratios\n         self.strides = strides\n         self.block_dilations = block_dilations\n         self.unit_kernel_size = unit_kernel_size\n-        self.decoder_channels = decoder_channels\n-        self.output_channels = output_channels\n         self.codebook_size = codebook_size\n-        self.num_quantizers = num_quantizers\n-        self.codebook_dim = codebook_dim\n         self.initializer_range = initializer_range\n-        self.hidden_dim = hidden_dim\n-        self.intermediate_dim = intermediate_dim\n-        self.output_dim = output_dim\n+        if codebook_dim is None:\n+            codebook_dim = self.acoustic_model_config.hidden_size + self.semantic_model_config.hidden_size\n+        self.codebook_dim = codebook_dim\n \n     @property\n     def frame_rate(self) -> int:\n-        return math.ceil(self.sample_rate / np.prod(self.acoustic_model_config.upsampling_ratios))\n+        return math.ceil(self.sample_rate / self.hop_length)\n+\n+    @property\n+    def semantic_hidden_size(self) -> int:\n+        return self.semantic_model_config.hidden_size\n \n     @property\n     def hop_length(self) -> int:\n         return int(np.prod(self.acoustic_model_config.downsampling_ratios))\n \n+    @property\n+    def codebook_nbits(self) -> int:\n+        return math.ceil(math.log2(self.codebook_size))\n+\n+    @property\n+    def hidden_size(self) -> int:\n+        return self.acoustic_model_config.hidden_size + self.semantic_model_config.hidden_size\n+\n+    @property\n+    def num_quantizers(self) -> int:\n+        return int(1000 * self.target_bandwidths[-1] // (self.frame_rate * self.codebook_nbits))\n+\n \n __all__ = [\"XcodecConfig\"]"
        },
        {
            "sha": "e0ea399cb4af76a3465bf66ac69dea56c7ebf5a2",
            "filename": "src/transformers/models/xcodec/convert_xcodec_weights_to_hf.py",
            "status": "modified",
            "additions": 119,
            "deletions": 16,
            "changes": 135,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fxcodec%2Fconvert_xcodec_weights_to_hf.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fxcodec%2Fconvert_xcodec_weights_to_hf.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fxcodec%2Fconvert_xcodec_weights_to_hf.py?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -1,5 +1,5 @@\n # coding=utf-8\n-# Copyright 2024 Descript and The HuggingFace Inc. team. All rights reserved.\n+# Copyright 2025 The HuggingFace Inc. team. All rights reserved.\n #\n # Licensed under the Apache License, Version 2.0 (the \"License\");\n # you may not use this file except in compliance with the License.\n@@ -17,9 +17,11 @@\n import re\n \n import torch\n+import yaml\n \n from transformers import (\n-    EncodecFeatureExtractor,\n+    AutoConfig,\n+    DacFeatureExtractor,\n     XcodecConfig,\n     XcodecModel,\n     logging,\n@@ -178,15 +180,50 @@ def convert_old_keys_to_new_keys(original_state_dict: dict[str, torch.Tensor]) -\n     return converted_checkpoint\n \n \n+# for reference, see original implementation: https://github.com/zhenye234/xcodec/blob/main/models/soundstream_semantic.py#L24\n @torch.no_grad()\n-def convert_checkpoint(checkpoint_path, pytorch_dump_folder_path, config_path=None, push_to_hub=None):\n-    if config_path is not None:\n-        config = XcodecConfig.from_pretrained(config_path)\n+def convert_checkpoint(checkpoint_path, config_path, pytorch_dump_folder_path=None, push_to_hub=None):\n+    # load config yaml file\n+    with open(config_path, \"r\") as f:\n+        model_config = yaml.safe_load(f)\n+\n+    # extra relevant parameters\n+    ratios = model_config[\"generator\"][\"config\"][\"ratios\"]\n+    target_bandwidths = model_config[\"generator\"][\"config\"][\"target_bandwidths\"]\n+    sample_rate = model_config[\"generator\"][\"config\"][\"sample_rate\"]\n+    acoustic_model_config = {\n+        \"encoder_hidden_size\": 64,\n+        \"decoder_hidden_size\": 1024,\n+        # NOTE: original DAC uses [2, 4, 8, 8] `downsampling ratios`, namely reverse of `upsampling_ratios`\n+        # (not sure if intentional by Xcodec but we keep it)\n+        \"downsampling_ratios\": ratios,\n+        \"upsampling_ratios\": ratios,\n+        \"sampling_rate\": sample_rate,\n+        \"hidden_size\": model_config[\"generator\"][\"config\"][\"D\"],\n+    }\n+    semantic_model = model_config[\"generator\"][\"config\"][\"semantic_techer\"]\n+    if semantic_model == \"hubert_base\":\n+        semantic_model_config = AutoConfig.from_pretrained(\"facebook/hubert-base-ls960\")\n+    elif semantic_model == \"wavlm_base_plus\":\n+        semantic_model_config = AutoConfig.from_pretrained(\"microsoft/wavlm-base-plus\")\n+    elif semantic_model == \"hubert_base_general\":\n+        semantic_model_config = AutoConfig.from_pretrained(\"ZhenYe234/hubert_base_general_audio\")\n     else:\n-        config = XcodecConfig()\n+        raise ValueError(f\"Unknown semantic model: {semantic_model}\")\n+\n+    config = XcodecConfig(\n+        target_bandwidths=target_bandwidths,\n+        acoustic_model_config=acoustic_model_config,\n+        semantic_model_config=semantic_model_config,\n+        sample_rate=sample_rate,\n+        codebook_size=model_config[\"generator\"][\"config\"][\"bins\"],\n+    )\n \n-    with torch.device(\"meta\"):\n-        model = XcodecModel(config)\n+    # create model\n+    if not torch.cuda.is_available():\n+        raise ValueError(\"Run this script on a machine with a GPU for weight norm layers to be correctly copied.\")\n+    torch_device = \"cuda\"\n+    model = XcodecModel(config).to(torch_device)\n \n     logger.info(\"Loading original checkpoint ...\")\n \n@@ -208,34 +245,100 @@ def convert_checkpoint(checkpoint_path, pytorch_dump_folder_path, config_path=No\n         raise ValueError(f\"missing keys found: {missing_keys}\")\n \n     model.remove_weight_norm()\n+    if pytorch_dump_folder_path is not None:\n+        model.save_pretrained(pytorch_dump_folder_path)\n \n-    model.save_pretrained(pytorch_dump_folder_path)\n-\n-    feature_extractor = EncodecFeatureExtractor(feature_size=config.audio_channels, sampling_rate=config.sample_rate)\n-\n-    feature_extractor.save_pretrained(pytorch_dump_folder_path)\n+    feature_extractor = DacFeatureExtractor(\n+        sampling_rate=config.sample_rate,\n+        hop_length=config.acoustic_model_config.hop_length,\n+    )\n+    if pytorch_dump_folder_path is not None:\n+        feature_extractor.save_pretrained(pytorch_dump_folder_path)\n \n     if push_to_hub:\n         print(\"Pushing to the hub...\")\n         feature_extractor.push_to_hub(push_to_hub)\n         model.push_to_hub(push_to_hub)\n \n \n+\"\"\"\n+Models checkpoints can be downloaded from here:\n+https://github.com/zhenye234/xcodec?tab=readme-ov-file#available-models\n+\n+1) `xcodec_hubert_librispeech`:\n+```\n+# Download config and checkpoint files\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/config_hubert.yaml -P /raid/eric/xcodec_original\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/xcodec_speech_hubert_librispeech.pth -P /raid/eric/xcodec_original\n+# Run conversion:\n+python src/transformers/models/xcodec/convert_xcodec_weights_to_hf.py \\\n+    --checkpoint_path /raid/eric/xcodec_original/xcodec_speech_hubert_librispeech.pth \\\n+    --config_path /raid/eric/xcodec_original/config_hubert.yaml \\\n+    --push_to_hub hf-audio/xcodec-hubert-librispeech\n+```\n+\n+2) `xcodec_hubert_general_audio`:\n+```\n+# Download config and checkpoint files\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/config_hubert_general.yaml -P /raid/eric/xcodec_original\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/xcodec_hubert_general_audio.pth -P /raid/eric/xcodec_original\n+# Run conversion:\n+python src/transformers/models/xcodec/convert_xcodec_weights_to_hf.py \\\n+    --checkpoint_path /raid/eric/xcodec_original/xcodec_hubert_general_audio.pth \\\n+    --config_path /raid/eric/xcodec_original/config_hubert_general.yaml \\\n+    --push_to_hub hf-audio/xcodec-hubert-general\n+```\n+\n+3) `xcodec_hubert_general_audio_more_data` (more balanced dataset):\n+```\n+# Download config and checkpoint files\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/config_hubert_general.yaml -P /raid/eric/xcodec_original\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/xcodec_hubert_general_audio_v2.pth -P /raid/eric/xcodec_original\n+# Run conversion:\n+python src/transformers/models/xcodec/convert_xcodec_weights_to_hf.py \\\n+    --checkpoint_path /raid/eric/xcodec_original/xcodec_hubert_general_audio_v2.pth \\\n+    --config_path /raid/eric/xcodec_original/config_hubert_general.yaml \\\n+    --push_to_hub hf-audio/xcodec-hubert-general-balanced\n+```\n+\n+4) `xcodec_wavlm_mls`:\n+```\n+# Download config and checkpoint files\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/config_wavlm.yaml -P /raid/eric/xcodec_original\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/xcodec_speech_wavlm_mls.pth -P /raid/eric/xcodec_original\n+# Run conversion:\n+python src/transformers/models/xcodec/convert_xcodec_weights_to_hf.py \\\n+    --checkpoint_path /raid/eric/xcodec_original/xcodec_speech_wavlm_mls.pth \\\n+    --config_path /raid/eric/xcodec_original/config_wavlm.yaml \\\n+    --push_to_hub hf-audio/xcodec-wavlm-mls\n+```\n+\n+5) `xcodec_wavlm_more_data`:\n+```\n+# Download config and checkpoint files\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/config_wavlm.yaml -P /raid/eric/xcodec_original\n+wget https://huggingface.co/ZhenYe234/xcodec/resolve/main/xcodec_speech_wavlm_more_data.pth -P /raid/eric/xcodec_original\n+# Run conversion:\n+python src/transformers/models/xcodec/convert_xcodec_weights_to_hf.py \\\n+    --checkpoint_path /raid/eric/xcodec_original/xcodec_speech_wavlm_more_data.pth \\\n+    --config_path /raid/eric/xcodec_original/config_wavlm.yaml \\\n+    --push_to_hub hf-audio/xcodec-wavlm-more-data\n+\"\"\"\n if __name__ == \"__main__\":\n     parser = argparse.ArgumentParser()\n     parser.add_argument(\"--checkpoint_path\", required=True, default=None, type=str, help=\"Path to original checkpoint\")\n-    parser.add_argument(\"--config_path\", default=None, type=str, help=\"Path to hf config.json of model to convert\")\n     parser.add_argument(\n-        \"--pytorch_dump_folder_path\", required=True, default=None, type=str, help=\"Path to the output PyTorch model.\"\n+        \"--config_path\", required=True, default=None, type=str, help=\"Path to hf config.yaml of model to convert\"\n     )\n+    parser.add_argument(\"--pytorch_dump_folder_path\", default=None, type=str, help=\"Path to the output PyTorch model.\")\n     parser.add_argument(\n         \"--push_to_hub\", default=None, type=str, help=\"Where to upload the converted model on the ðŸ¤— hub.\"\n     )\n \n     args = parser.parse_args()\n     convert_checkpoint(\n         args.checkpoint_path,\n-        args.pytorch_dump_folder_path,\n         args.config_path,\n+        args.pytorch_dump_folder_path,\n         args.push_to_hub,\n     )"
        },
        {
            "sha": "71064c7f1d3f94594ffbbedd0bc9c506bc72fd09",
            "filename": "src/transformers/models/xcodec/modeling_xcodec.py",
            "status": "modified",
            "additions": 31,
            "deletions": 26,
            "changes": 57,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fxcodec%2Fmodeling_xcodec.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/src%2Ftransformers%2Fmodels%2Fxcodec%2Fmodeling_xcodec.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fxcodec%2Fmodeling_xcodec.py?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -1,5 +1,5 @@\n # coding=utf-8\n-# Copyright 2024 Descript and The HuggingFace Inc. team. All rights reserved.\n+# Copyright 2025 The HuggingFace Inc. team. All rights reserved.\n #\n # Licensed under the Apache License, Version 2.0 (the \"License\");\n # you may not use this file except in compliance with the License.\n@@ -115,15 +115,19 @@ def __init__(self, config):\n         super().__init__()\n         if len(config.strides) != len(config.channel_ratios):\n             raise ValueError(\"Number of strides must match the number of channel_ratios.\")\n-\n         self.conv = nn.Conv1d(\n-            config.input_channels, config.encoder_channels, config.kernel_size, 1, config.kernel_size // 2, bias=False\n+            config.semantic_hidden_size,\n+            config.semantic_hidden_size,\n+            config.kernel_size,\n+            1,\n+            config.kernel_size // 2,\n+            bias=False,\n         )\n \n-        in_channels = config.encoder_channels\n+        in_channels = config.semantic_hidden_size\n         conv_blocks = []\n         for i, stride in enumerate(config.strides):\n-            out_channels = int(config.encoder_channels * config.channel_ratios[i])\n+            out_channels = int(config.semantic_hidden_size * config.channel_ratios[i])\n             conv_blocks += [SemanticEncoderBlock(config, in_channels, out_channels, stride)]\n             in_channels = out_channels\n \n@@ -171,28 +175,28 @@ class SemanticDecoder(nn.Module):\n     def __init__(self, config):\n         super().__init__()\n         self.conv1 = nn.Conv1d(\n-            in_channels=config.decoder_channels,\n-            out_channels=int(config.decoder_channels * config.channel_ratios[0]),\n+            in_channels=config.semantic_hidden_size,\n+            out_channels=int(config.semantic_hidden_size * config.channel_ratios[0]),\n             kernel_size=config.kernel_size,\n             stride=1,\n             padding=config.kernel_size // 2,\n             bias=False,\n         )\n         conv_blocks = []\n         for i, stride in enumerate(config.strides):\n-            in_channels = int(config.decoder_channels * config.channel_ratios[i])\n+            in_channels = int(config.semantic_hidden_size * config.channel_ratios[i])\n \n             if i < (len(config.channel_ratios) - 1):\n-                out_channels = int(config.decoder_channels * config.channel_ratios[i + 1])\n+                out_channels = int(config.semantic_hidden_size * config.channel_ratios[i + 1])\n             else:\n-                out_channels = config.decoder_channels\n+                out_channels = config.semantic_hidden_size\n \n             conv_blocks += [SemanticDecoderBlock(config, in_channels, out_channels, stride)]\n \n         self.conv_blocks = nn.ModuleList(conv_blocks)\n         self.conv2 = nn.Conv1d(\n-            config.decoder_channels,\n-            config.output_channels,\n+            config.semantic_hidden_size,\n+            config.semantic_hidden_size,\n             config.kernel_size,\n             stride=1,\n             padding=config.kernel_size // 2,\n@@ -381,16 +385,16 @@ def __init__(self, config):\n         super().__init__(config)\n         self.config = config\n         self.pad = config.hop_length // 2\n-        dac = AutoModel.from_config(config.acoustic_model_config)\n-        self.acoustic_encoder = dac.encoder\n-        self.acoustic_decoder = dac.decoder\n+        acoustic_model = AutoModel.from_config(config.acoustic_model_config)\n+        self.acoustic_encoder = acoustic_model.encoder\n+        self.acoustic_decoder = acoustic_model.decoder\n         self._adjust_dac_decoder(self.acoustic_decoder)\n         self.encoder_semantic = SemanticEncoder(config)\n         self.decoder_semantic = SemanticDecoder(config)\n-        self.semantic_model = AutoModel.from_config(config.semantic_model_config)\n-        self.fc = nn.Linear(config.hidden_dim, config.hidden_dim)\n-        self.fc1 = nn.Linear(config.hidden_dim, config.intermediate_dim)\n-        self.fc2 = nn.Linear(config.hidden_dim, config.output_dim)\n+        self.semantic_model = AutoModel.from_config(config.semantic_model_config).eval()\n+        self.fc = nn.Linear(config.hidden_size, config.hidden_size)\n+        self.fc1 = nn.Linear(config.hidden_size, config.semantic_model_config.hidden_size)\n+        self.fc2 = nn.Linear(config.hidden_size, config.acoustic_model_config.hidden_size)\n         self.quantizer = XcodecResidualVectorQuantization(config)\n \n     @staticmethod\n@@ -524,16 +528,16 @@ def forward(\n         return_dict: Optional[bool] = None,\n         **kwargs,\n     ) -> Union[tuple[torch.Tensor, torch.Tensor], XcodecOutput]:\n-        r\"\"\"\n+        \"\"\"\n         Encodes and quantizes the input audio into discrete codes, then decodes those codes back into an audio waveform.\n+\n         Args:\n             input_values (`torch.FloatTensor` of shape `(batch_size, channels, num_samples)`):\n                 The raw float values of the input audio waveform.\n             audio_codes (`torch.LongTensor`  of shape `(batch_size, num_quantizers, codes_length)`:\n                 Discrete code indices computed using `model.encode`.\n             bandwidth (`float`, *optional*):\n-                Target bandwidth in kbps. Must be one of `config.target_bandwidths`.\n-                Defaults to the highest available bandwidth.\n+                Target bandwidth in kbps. Must be one of `config.target_bandwidths`. Defaults to the highest available bandwidth.\n             return_dict (`bool`, *optional*):\n                 Whether to return a [`XcodecOutput`] instead of a plain tuple.\n \n@@ -548,13 +552,14 @@ def forward(\n         >>> from datasets import load_dataset\n         >>> from transformers import AutoFeatureExtractor, XcodecModel\n \n-        >>> dataset = load_dataset(\"hf-internal-testing/ashraq-esc50-1-dog-example\")\n-        >>> audio_sample = dataset[\"train\"][\"audio\"][0][\"array\"]\n-\n-        >>> model_id = \"Manel/X-Codec\"\n+        >>> model_id = \"hf-audio/xcodec-hubert-librispeech\"\n         >>> model = XcodecModel.from_pretrained(model_id)\n         >>> feature_extractor = AutoFeatureExtractor.from_pretrained(model_id)\n \n+        >>> dataset = load_dataset(\"hf-internal-testing/librispeech_asr_dummy\", \"clean\", split=\"validation\")\n+        >>> dataset = dataset.cast_column(\"audio\", Audio(sampling_rate=feature_extractor.sampling_rate))\n+        >>> audio_sample = dataset[0]['audio']['array']\n+\n         >>> inputs = feature_extractor(raw_audio=audio_sample, return_tensors=\"pt\")\n \n         >>> outputs = model(**inputs)"
        },
        {
            "sha": "6c4e436350f2b5c3a3ef1e6e1960a0cf0cca25df",
            "filename": "tests/fixtures/xcodec/integration_tests.json",
            "status": "added",
            "additions": 2150,
            "deletions": 0,
            "changes": 2150,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/tests%2Ffixtures%2Fxcodec%2Fintegration_tests.json",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/tests%2Ffixtures%2Fxcodec%2Fintegration_tests.json",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Ffixtures%2Fxcodec%2Fintegration_tests.json?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -0,0 +1,2150 @@\n+[\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-librispeech\",\n+        \"bandwidth\": 0.5,\n+        \"codes\": [\n+            [\n+                [\n+                    590,\n+                    590,\n+                    306,\n+                    306,\n+                    590,\n+                    1006,\n+                    826,\n+                    916,\n+                    590,\n+                    826,\n+                    826,\n+                    844,\n+                    844,\n+                    746,\n+                    392\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.000644786050543189,\n+                    0.00013058912009000778,\n+                    0.0006741542601957917,\n+                    0.00034384033642709255,\n+                    -0.00010847719386219978,\n+                    0.00014182832092046738,\n+                    6.248801946640015e-05,\n+                    -0.0003324758727103472,\n+                    -0.0005267199594527483,\n+                    -0.0010175877250730991,\n+                    -0.0011251929681748152,\n+                    -0.0006446582265198231,\n+                    -0.00047831423580646515,\n+                    -0.00023265788331627846,\n+                    -0.0001271876972168684,\n+                    -1.8235761672258377e-05,\n+                    -5.327444523572922e-05,\n+                    -0.0001765203196555376,\n+                    -0.0004240723792463541,\n+                    -0.0002993491943925619,\n+                    -0.0002642744220793247,\n+                    -0.0003135430160909891,\n+                    -0.0002605144400149584,\n+                    -0.00026806839741766453,\n+                    -2.2151507437229156e-06,\n+                    0.00020786607638001442,\n+                    0.00017593754455447197,\n+                    -0.00016461312770843506,\n+                    -0.0003985136281698942,\n+                    -0.00025607552379369736,\n+                    -0.00013757869601249695,\n+                    -6.365473382174969e-05,\n+                    -0.00020918482914566994,\n+                    -0.0002473779022693634,\n+                    -0.00014893501065671444,\n+                    0.0001332222018390894,\n+                    0.00040268548764288425,\n+                    0.0002646979410201311,\n+                    7.32732005417347e-05,\n+                    -0.00025837705470621586,\n+                    -0.0007715015672147274,\n+                    -0.0012102078180760145,\n+                    -0.0009501995518803596,\n+                    -0.00017246650531888008,\n+                    0.0003386975731700659,\n+                    0.0003189577255398035,\n+                    0.00021003605797886848,\n+                    0.0001099675428122282,\n+                    0.00024433922953903675,\n+                    3.217277117073536e-05\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.005472081247717142,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-librispeech\",\n+        \"bandwidth\": 1.0,\n+        \"codes\": [\n+            [\n+                [\n+                    590,\n+                    590,\n+                    306,\n+                    306,\n+                    590,\n+                    1006,\n+                    826,\n+                    916,\n+                    590,\n+                    826,\n+                    826,\n+                    844,\n+                    844,\n+                    746,\n+                    392\n+                ],\n+                [\n+                    748,\n+                    375,\n+                    156,\n+                    327,\n+                    327,\n+                    156,\n+                    448,\n+                    448,\n+                    327,\n+                    346,\n+                    1023,\n+                    346,\n+                    346,\n+                    1023,\n+                    1023\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.00022301427088677883,\n+                    0.00018040905706584454,\n+                    0.00034872093237936497,\n+                    0.00010567391291260719,\n+                    -0.0002222477924078703,\n+                    -0.00012606964446604252,\n+                    -7.731537334620953e-05,\n+                    -0.00012137391604483128,\n+                    -0.0001762432511895895,\n+                    -0.0007736883126199245,\n+                    -0.0010079797357320786,\n+                    -0.00046425615437328815,\n+                    -7.964251562952995e-05,\n+                    -3.2845884561538696e-05,\n+                    -1.0334886610507965e-05,\n+                    8.499552495777607e-05,\n+                    -0.00010045897215604782,\n+                    -0.00029115937650203705,\n+                    -0.00044626137241721153,\n+                    -0.00014261016622185707,\n+                    -0.00036265188828110695,\n+                    -0.0005839171353727579,\n+                    -0.00024048984050750732,\n+                    1.8859747797250748e-05,\n+                    5.6158751249313354e-06,\n+                    0.00017515220679342747,\n+                    0.0004101542290300131,\n+                    0.0001747957430779934,\n+                    -0.0003047185018658638,\n+                    -0.00032516056671738625,\n+                    -0.0002171192318201065,\n+                    -0.0002566229086369276,\n+                    -0.00022618728689849377,\n+                    8.058198727667332e-05,\n+                    0.00029059057123959064,\n+                    0.000731412204913795,\n+                    0.0009413085645064712,\n+                    0.0005381645169109106,\n+                    -7.746554911136627e-05,\n+                    -0.0005039803218096495,\n+                    -0.0008559448178857565,\n+                    -0.0010777676943689585,\n+                    -0.0005720553454011679,\n+                    0.00046507292427122593,\n+                    0.0009388792095705867,\n+                    0.0007773893885314465,\n+                    0.000560535816475749,\n+                    0.00030490709468722343,\n+                    0.00010391278192400932,\n+                    -0.0004857585299760103\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.005680468864738941,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-librispeech\",\n+        \"bandwidth\": 1.5,\n+        \"codes\": [\n+            [\n+                [\n+                    590,\n+                    590,\n+                    306,\n+                    306,\n+                    590,\n+                    1006,\n+                    826,\n+                    916,\n+                    590,\n+                    826,\n+                    826,\n+                    844,\n+                    844,\n+                    746,\n+                    392\n+                ],\n+                [\n+                    748,\n+                    375,\n+                    156,\n+                    327,\n+                    327,\n+                    156,\n+                    448,\n+                    448,\n+                    327,\n+                    346,\n+                    1023,\n+                    346,\n+                    346,\n+                    1023,\n+                    1023\n+                ],\n+                [\n+                    351,\n+                    835,\n+                    351,\n+                    992,\n+                    992,\n+                    817,\n+                    127,\n+                    832,\n+                    855,\n+                    177,\n+                    817,\n+                    177,\n+                    177,\n+                    97,\n+                    472\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    -8.131377398967743e-05,\n+                    0.0003722899127751589,\n+                    0.0005264813080430031,\n+                    0.00024720048531889915,\n+                    -0.00012781796976923943,\n+                    -6.020977161824703e-05,\n+                    2.0435545593500137e-06,\n+                    -9.971903637051582e-06,\n+                    -5.366327241063118e-05,\n+                    -0.0007150094024837017,\n+                    -0.0009912890382111073,\n+                    -0.00038447463884949684,\n+                    5.855737254023552e-05,\n+                    0.00012949109077453613,\n+                    0.00017356942407786846,\n+                    0.0002417820505797863,\n+                    -4.827766679227352e-05,\n+                    -0.00032059219665825367,\n+                    -0.0004915285389870405,\n+                    -0.00013681501150131226,\n+                    -0.00028307782486081123,\n+                    -0.00039494410157203674,\n+                    5.228118970990181e-05,\n+                    0.0003737024962902069,\n+                    0.0003404058516025543,\n+                    0.0004928638227283955,\n+                    0.000665064319036901,\n+                    0.00023967307060956955,\n+                    -0.000433565117418766,\n+                    -0.0005353728774935007,\n+                    -0.00038189860060811043,\n+                    -0.00032747630029916763,\n+                    -0.00019068107940256596,\n+                    0.0002735431771725416,\n+                    0.0006756627699360251,\n+                    0.0012527555227279663,\n+                    0.0013769968645647168,\n+                    0.000728685175999999,\n+                    -0.0001932412851601839,\n+                    -0.0009031407535076141,\n+                    -0.0014542911667376757,\n+                    -0.0017141078133136034,\n+                    -0.001031694933772087,\n+                    0.00032188743352890015,\n+                    0.0010538509814068675,\n+                    0.0010152260074391961,\n+                    0.0008743192302063107,\n+                    0.0006233796011656523,\n+                    0.0002936923410743475,\n+                    -0.0004914039745926857\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.005860992707312107,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-librispeech\",\n+        \"bandwidth\": 2.0,\n+        \"codes\": [\n+            [\n+                [\n+                    590,\n+                    590,\n+                    306,\n+                    306,\n+                    590,\n+                    1006,\n+                    826,\n+                    916,\n+                    590,\n+                    826,\n+                    826,\n+                    844,\n+                    844,\n+                    746,\n+                    392\n+                ],\n+                [\n+                    748,\n+                    375,\n+                    156,\n+                    327,\n+                    327,\n+                    156,\n+                    448,\n+                    448,\n+                    327,\n+                    346,\n+                    1023,\n+                    346,\n+                    346,\n+                    1023,\n+                    1023\n+                ],\n+                [\n+                    351,\n+                    835,\n+                    351,\n+                    992,\n+                    992,\n+                    817,\n+                    127,\n+                    832,\n+                    855,\n+                    177,\n+                    817,\n+                    177,\n+                    177,\n+                    97,\n+                    472\n+                ],\n+                [\n+                    156,\n+                    1008,\n+                    546,\n+                    266,\n+                    856,\n+                    116,\n+                    173,\n+                    531,\n+                    894,\n+                    938,\n+                    87,\n+                    531,\n+                    745,\n+                    747,\n+                    747\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    6.87665306031704e-05,\n+                    0.0005173773970454931,\n+                    0.0006601555505767465,\n+                    0.0004073025193065405,\n+                    2.4633249267935753e-05,\n+                    6.317137740552425e-05,\n+                    0.00011769519187510014,\n+                    0.00010632933117449284,\n+                    6.606383249163628e-05,\n+                    -0.0006399150006473064,\n+                    -0.0008867487777024508,\n+                    -0.00026029557920992374,\n+                    0.00015681260265409946,\n+                    0.00021465751342475414,\n+                    0.00026818737387657166,\n+                    0.00039722840301692486,\n+                    0.00010386388748884201,\n+                    -0.0001172386109828949,\n+                    -0.0002974425442516804,\n+                    6.535928696393967e-05,\n+                    -0.00014087161980569363,\n+                    -0.0002665710635483265,\n+                    0.00022345990873873234,\n+                    0.0005574806127697229,\n+                    0.0005362457595765591,\n+                    0.0006526130018755794,\n+                    0.0007966818520799279,\n+                    0.0003330092877149582,\n+                    -0.00044982251711189747,\n+                    -0.0006805681623518467,\n+                    -0.0005900394171476364,\n+                    -0.0005267017986625433,\n+                    -0.00036593549884855747,\n+                    0.00016947905533015728,\n+                    0.0006881445879116654,\n+                    0.001375970197841525,\n+                    0.0014863089891150594,\n+                    0.0008116817334666848,\n+                    -8.753198198974133e-05,\n+                    -0.0008385318797081709,\n+                    -0.0014865880366414785,\n+                    -0.0017615130636841059,\n+                    -0.0009944913908839226,\n+                    0.00041615008376538754,\n+                    0.0011417579371482134,\n+                    0.001129985903389752,\n+                    0.0010677824029698968,\n+                    0.0007883547805249691,\n+                    0.00044182222336530685,\n+                    -0.0003320761024951935\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.005977352149784565,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-librispeech\",\n+        \"bandwidth\": 4.0,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    4.919269122183323e-05,\n+                    0.00044998968951404095,\n+                    0.0005170812364667654,\n+                    0.00038593681529164314,\n+                    0.00012237182818353176,\n+                    6.045890040695667e-05,\n+                    7.303990423679352e-05,\n+                    0.00023534847423434258,\n+                    0.00028711999766528606,\n+                    -0.0004980487283319235,\n+                    -0.0007807251531630754,\n+                    -0.0001900549978017807,\n+                    0.00020040222443640232,\n+                    0.00022384990006685257,\n+                    0.00028798868879675865,\n+                    0.0005522638093680143,\n+                    0.0003211870789527893,\n+                    5.3691910579800606e-05,\n+                    -0.0002666471991688013,\n+                    3.6196084693074226e-05,\n+                    -0.00030040694400668144,\n+                    -0.0006298250518739223,\n+                    -0.00017189816571772099,\n+                    0.0004776653368026018,\n+                    0.0007132112514227629,\n+                    0.0007824968779459596,\n+                    0.0010266141034662724,\n+                    0.0007283660816028714,\n+                    -0.00011806422844529152,\n+                    -0.0006026057526469231,\n+                    -0.0005629444494843483,\n+                    -0.00034018163569271564,\n+                    -0.0001810593530535698,\n+                    0.00023290864191949368,\n+                    0.0007565215928480029,\n+                    0.001519701792858541,\n+                    0.0016510691493749619,\n+                    0.0009673768654465675,\n+                    0.00013116677291691303,\n+                    -0.0004444648511707783,\n+                    -0.001082052243873477,\n+                    -0.001428384566679597,\n+                    -0.0006310269236564636,\n+                    0.0007636576192453504,\n+                    0.0013155697379261255,\n+                    0.001216168631799519,\n+                    0.0012932788813486695,\n+                    0.0010688184993341565,\n+                    0.0005435235798358917,\n+                    -0.00032686395570635796\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.00608655484393239,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general\",\n+        \"bandwidth\": 0.5,\n+        \"codes\": [\n+            [\n+                [\n+                    935,\n+                    433,\n+                    126,\n+                    803,\n+                    850,\n+                    448,\n+                    917,\n+                    387,\n+                    387,\n+                    592,\n+                    592,\n+                    855,\n+                    917,\n+                    572,\n+                    28\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.00021017552353441715,\n+                    0.0004965162370353937,\n+                    0.0001386473886668682,\n+                    -0.00020841951481997967,\n+                    -8.969777263700962e-05,\n+                    -0.0002771597355604172,\n+                    -0.00027932715602219105,\n+                    5.5042095482349396e-05,\n+                    0.00026329560205340385,\n+                    0.00017548329196870327,\n+                    0.00038894289173185825,\n+                    0.0005539481062442064,\n+                    0.00014357827603816986,\n+                    -0.00031660543754696846,\n+                    -0.0005882629193365574,\n+                    -0.00044182687997817993,\n+                    -0.0001490083523094654,\n+                    -5.8116158470511436e-05,\n+                    4.0457816794514656e-05,\n+                    -7.796147838234901e-05,\n+                    3.5779085010290146e-06,\n+                    0.00017821392975747585,\n+                    9.860633872449398e-05,\n+                    0.00010030693374574184,\n+                    1.2427102774381638e-05,\n+                    -0.0001045640092343092,\n+                    -9.76896844804287e-05,\n+                    -5.82672655582428e-05,\n+                    0.00017144251614809036,\n+                    7.190275937318802e-06,\n+                    -0.00019244407303631306,\n+                    5.330890417098999e-05,\n+                    0.0001915388274937868,\n+                    2.933409996330738e-05,\n+                    -9.671831503510475e-05,\n+                    -0.00038430141285061836,\n+                    -0.000596470432356,\n+                    -0.00054143276065588,\n+                    -0.0003454047255218029,\n+                    -0.0001294529065489769,\n+                    -0.00019761803559958935,\n+                    -0.00011440459638834,\n+                    1.8423888832330704e-05,\n+                    5.5767595767974854e-05,\n+                    0.00012666056863963604,\n+                    -9.990530088543892e-06,\n+                    -8.841603994369507e-05,\n+                    -7.79847614467144e-05,\n+                    -0.0001224260777235031,\n+                    -9.860680438578129e-05\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0038952771574258804,\n+        \"codec_tol\": 1e-06,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general\",\n+        \"bandwidth\": 1.0,\n+        \"codes\": [\n+            [\n+                [\n+                    935,\n+                    433,\n+                    126,\n+                    803,\n+                    850,\n+                    448,\n+                    917,\n+                    387,\n+                    387,\n+                    592,\n+                    592,\n+                    855,\n+                    917,\n+                    572,\n+                    28\n+                ],\n+                [\n+                    739,\n+                    882,\n+                    882,\n+                    49,\n+                    459,\n+                    64,\n+                    189,\n+                    459,\n+                    459,\n+                    459,\n+                    143,\n+                    551,\n+                    550,\n+                    760,\n+                    808\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.0002046455629169941,\n+                    0.00046922592446208,\n+                    0.00011031189933419228,\n+                    -0.0002996474504470825,\n+                    -0.00021691364236176014,\n+                    -0.00039181788451969624,\n+                    -0.0003864085301756859,\n+                    -4.2735831812024117e-05,\n+                    0.00022559752687811852,\n+                    0.00019318307749927044,\n+                    0.00036341347731649876,\n+                    0.00047189113683998585,\n+                    5.879811942577362e-05,\n+                    -0.00035421736538410187,\n+                    -0.0005878964439034462,\n+                    -0.00047568860463798046,\n+                    -0.00024429219774901867,\n+                    -8.333590812981129e-05,\n+                    9.222817607223988e-05,\n+                    -2.709287218749523e-05,\n+                    2.5267712771892548e-05,\n+                    0.00020193355157971382,\n+                    0.00010740640573203564,\n+                    1.998012885451317e-05,\n+                    -0.00012808036990463734,\n+                    -0.00025810301303863525,\n+                    -0.00024647475220263004,\n+                    -0.0001851061824709177,\n+                    6.030406802892685e-05,\n+                    -3.3717602491378784e-05,\n+                    -0.00014680484309792519,\n+                    5.045789293944836e-05,\n+                    3.881426528096199e-05,\n+                    -0.00020871451124548912,\n+                    -0.0002821478992700577,\n+                    -0.0005010757595300674,\n+                    -0.0007123809773474932,\n+                    -0.0006850638892501593,\n+                    -0.0005063675343990326,\n+                    -0.00030805286951363087,\n+                    -0.0003586956299841404,\n+                    -0.00024597207084298134,\n+                    -0.0001272936351597309,\n+                    -0.0001404962968081236,\n+                    -9.55783762037754e-05,\n+                    -0.00024282699450850487,\n+                    -0.0003365979064255953,\n+                    -0.000235437648370862,\n+                    -0.00011085602454841137,\n+                    -1.4352379366755486e-05\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.003511926392093301,\n+        \"codec_tol\": 1e-06,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general\",\n+        \"bandwidth\": 1.5,\n+        \"codes\": [\n+            [\n+                [\n+                    935,\n+                    433,\n+                    126,\n+                    803,\n+                    850,\n+                    448,\n+                    917,\n+                    387,\n+                    387,\n+                    592,\n+                    592,\n+                    855,\n+                    917,\n+                    572,\n+                    28\n+                ],\n+                [\n+                    739,\n+                    882,\n+                    882,\n+                    49,\n+                    459,\n+                    64,\n+                    189,\n+                    459,\n+                    459,\n+                    459,\n+                    143,\n+                    551,\n+                    550,\n+                    760,\n+                    808\n+                ],\n+                [\n+                    710,\n+                    536,\n+                    176,\n+                    531,\n+                    623,\n+                    626,\n+                    100,\n+                    833,\n+                    796,\n+                    311,\n+                    457,\n+                    382,\n+                    360,\n+                    176,\n+                    410\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.0001305723562836647,\n+                    0.0007112827152013779,\n+                    0.0003338572569191456,\n+                    -6.938702426850796e-05,\n+                    0.0001109603326767683,\n+                    -7.854425348341465e-05,\n+                    -5.859602242708206e-05,\n+                    0.00043661193922162056,\n+                    0.0007921892683953047,\n+                    0.0007424359209835529,\n+                    0.0009273507166653872,\n+                    0.0010653517674654722,\n+                    0.0005372778978198767,\n+                    -4.121800884604454e-05,\n+                    -0.0003301908727735281,\n+                    -0.00012553343549370766,\n+                    0.00018500350415706635,\n+                    0.000404976774007082,\n+                    0.0006721802055835724,\n+                    0.0005569383502006531,\n+                    0.0005787969566881657,\n+                    0.0007312376983463764,\n+                    0.0005475706420838833,\n+                    0.00038789398968219757,\n+                    0.00024302303791046143,\n+                    0.0001421694178134203,\n+                    0.00014890613965690136,\n+                    0.000260709086433053,\n+                    0.0005868605803698301,\n+                    0.0004271466750651598,\n+                    0.00019052578136324883,\n+                    0.000402234960347414,\n+                    0.00040456512942910194,\n+                    8.718366734683514e-05,\n+                    8.386559784412384e-07,\n+                    -0.00021422700956463814,\n+                    -0.00043249805457890034,\n+                    -0.00034649111330509186,\n+                    -9.317276999354362e-05,\n+                    0.00012367917224764824,\n+                    -5.164183676242828e-06,\n+                    4.87668439745903e-05,\n+                    0.0001070518046617508,\n+                    2.7181115001440048e-05,\n+                    0.0001189960166811943,\n+                    4.686368629336357e-05,\n+                    7.493654265999794e-06,\n+                    0.00016385293565690517,\n+                    0.0002651643007993698,\n+                    0.0002767094410955906\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0034364312887191772,\n+        \"codec_tol\": 1e-06,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general\",\n+        \"bandwidth\": 2.0,\n+        \"codes\": [\n+            [\n+                [\n+                    935,\n+                    433,\n+                    126,\n+                    803,\n+                    850,\n+                    448,\n+                    917,\n+                    387,\n+                    387,\n+                    592,\n+                    592,\n+                    855,\n+                    917,\n+                    572,\n+                    28\n+                ],\n+                [\n+                    739,\n+                    882,\n+                    882,\n+                    49,\n+                    459,\n+                    64,\n+                    189,\n+                    459,\n+                    459,\n+                    459,\n+                    143,\n+                    551,\n+                    550,\n+                    760,\n+                    808\n+                ],\n+                [\n+                    710,\n+                    536,\n+                    176,\n+                    531,\n+                    623,\n+                    626,\n+                    100,\n+                    833,\n+                    796,\n+                    311,\n+                    457,\n+                    382,\n+                    360,\n+                    176,\n+                    410\n+                ],\n+                [\n+                    791,\n+                    515,\n+                    953,\n+                    596,\n+                    454,\n+                    753,\n+                    295,\n+                    454,\n+                    454,\n+                    115,\n+                    515,\n+                    816,\n+                    36,\n+                    75,\n+                    226\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.00014006253331899643,\n+                    0.0007989001460373402,\n+                    0.00046538468450307846,\n+                    8.566956967115402e-05,\n+                    0.0002664625644683838,\n+                    5.368725396692753e-05,\n+                    4.951213486492634e-05,\n+                    0.000605646288022399,\n+                    0.001051453989930451,\n+                    0.0011005131527781487,\n+                    0.001340654562227428,\n+                    0.0014765722444280982,\n+                    0.0008794022724032402,\n+                    0.00019451347179710865,\n+                    -0.0001761973835527897,\n+                    1.8655788153409958e-05,\n+                    0.0003523188643157482,\n+                    0.0006215828470885754,\n+                    0.0009482598397880793,\n+                    0.0008765892125666142,\n+                    0.0009128025267273188,\n+                    0.0010658367536962032,\n+                    0.0008650952950119972,\n+                    0.0006931314710527658,\n+                    0.0005274452269077301,\n+                    0.00040836725383996964,\n+                    0.0003828315529972315,\n+                    0.00045729358680546284,\n+                    0.0008139281999319792,\n+                    0.0007075911853462458,\n+                    0.0004986736457794905,\n+                    0.0007380517199635506,\n+                    0.0007470641285181046,\n+                    0.0003727404400706291,\n+                    0.00020861998200416565,\n+                    -4.448019899427891e-05,\n+                    -0.00026486185379326344,\n+                    -0.00014658598229289055,\n+                    0.00014992570504546165,\n+                    0.0003946979995816946,\n+                    0.00024374201893806458,\n+                    0.000254632206633687,\n+                    0.00027234642766416073,\n+                    0.00017000176012516022,\n+                    0.0002736307214945555,\n+                    0.00022304686717689037,\n+                    0.00018746289424598217,\n+                    0.0003647569101303816,\n+                    0.00047829560935497284,\n+                    0.0004925637040287256\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.003246477572247386,\n+        \"codec_tol\": 1e-06,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general\",\n+        \"bandwidth\": 4.0,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.0001746553461998701,\n+                    0.0008285697549581528,\n+                    0.0005095258820801973,\n+                    0.00022105872631072998,\n+                    0.00047804228961467743,\n+                    0.0002920464612543583,\n+                    0.00020101177506148815,\n+                    0.0006921763997524977,\n+                    0.001189485308714211,\n+                    0.001171361654996872,\n+                    0.001430683652870357,\n+                    0.0016735134413465858,\n+                    0.0011466527357697487,\n+                    0.0004955567419528961,\n+                    0.00013427832163870335,\n+                    0.0003044463228434324,\n+                    0.0005627109203487635,\n+                    0.0007822064217180014,\n+                    0.001134557300247252,\n+                    0.0010599115630611777,\n+                    0.0011251196265220642,\n+                    0.001351013546809554,\n+                    0.001148079987615347,\n+                    0.0009455143008381128,\n+                    0.000764030497521162,\n+                    0.0005778523627668619,\n+                    0.00042620301246643066,\n+                    0.0005069044418632984,\n+                    0.0009447732008993626,\n+                    0.0009011845104396343,\n+                    0.0007778429426252842,\n+                    0.0010773082030937076,\n+                    0.0009713636245578527,\n+                    0.00035730027593672276,\n+                    0.00012435344979166985,\n+                    -0.0001019404735416174,\n+                    -0.0003732512705028057,\n+                    -0.00022046314552426338,\n+                    0.0002396036870777607,\n+                    0.0005130092613399029,\n+                    0.00034346291795372963,\n+                    0.00045024044811725616,\n+                    0.000551396980881691,\n+                    0.00038504088297486305,\n+                    0.00042170868255198,\n+                    0.000304151326417923,\n+                    0.00014883745461702347,\n+                    0.00035709445364773273,\n+                    0.0005582491867244244,\n+                    0.0006064062472432852\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0029708717484027147,\n+        \"codec_tol\": 1e-06,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general-balanced\",\n+        \"bandwidth\": 0.5,\n+        \"codes\": [\n+            [\n+                [\n+                    361,\n+                    327,\n+                    361,\n+                    220,\n+                    296,\n+                    448,\n+                    794,\n+                    794,\n+                    220,\n+                    215,\n+                    215,\n+                    523,\n+                    794,\n+                    572,\n+                    837\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.00034493682323955,\n+                    0.0004888690891675651,\n+                    5.2613399020629004e-05,\n+                    -0.0003154197765979916,\n+                    -0.000374013528926298,\n+                    -0.0006679014186374843,\n+                    -0.0004468882689252496,\n+                    0.00014481281687039882,\n+                    0.0004187110753264278,\n+                    0.0002444020356051624,\n+                    0.0005527980392798781,\n+                    0.0007324246689677238,\n+                    0.0001953293103724718,\n+                    -0.0001868946710601449,\n+                    -0.00039330992149189115,\n+                    -1.5875579265411943e-05,\n+                    0.0003087812219746411,\n+                    0.00023550353944301605,\n+                    0.00026388472178950906,\n+                    -1.399356551701203e-05,\n+                    5.0710201321635395e-05,\n+                    0.00025053517310880125,\n+                    0.0001787259243428707,\n+                    0.0004594939819071442,\n+                    0.000588070775847882,\n+                    0.00020284971105866134,\n+                    -0.0001789979578461498,\n+                    -0.0004223345313221216,\n+                    -0.0005676769069395959,\n+                    -0.0009293632465414703,\n+                    -0.0010678550461307168,\n+                    -0.0005041397525928915,\n+                    4.17735063820146e-05,\n+                    0.0003083720221184194,\n+                    0.00022762120352126658,\n+                    -0.0001844105718191713,\n+                    -0.0003540224861353636,\n+                    -0.0004843481001444161,\n+                    -0.0005098123801872134,\n+                    -4.7943081881385297e-05,\n+                    0.0003332827764097601,\n+                    0.0006624205270782113,\n+                    0.0007267107721418142,\n+                    0.0005331048159860075,\n+                    0.0005102302529849112,\n+                    0.00026525993598625064,\n+                    -0.00011996129614999518,\n+                    -0.0003491249808575958,\n+                    -0.00035246959305368364,\n+                    -0.00011564368469407782\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0033109495416283607,\n+        \"codec_tol\": 0.0001,\n+        \"dec_tol\": 1e-05\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general-balanced\",\n+        \"bandwidth\": 1.0,\n+        \"codes\": [\n+            [\n+                [\n+                    361,\n+                    327,\n+                    361,\n+                    220,\n+                    296,\n+                    448,\n+                    794,\n+                    794,\n+                    220,\n+                    215,\n+                    215,\n+                    523,\n+                    794,\n+                    572,\n+                    837\n+                ],\n+                [\n+                    558,\n+                    561,\n+                    17,\n+                    689,\n+                    341,\n+                    17,\n+                    17,\n+                    746,\n+                    995,\n+                    203,\n+                    203,\n+                    626,\n+                    44,\n+                    930,\n+                    137\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    0.00030808174051344395,\n+                    0.001045881537720561,\n+                    0.0007541970699094236,\n+                    0.00033998070284724236,\n+                    0.0003453573735896498,\n+                    9.488919749855995e-05,\n+                    0.00013062538346275687,\n+                    0.0006009942735545337,\n+                    0.0008533764048479497,\n+                    0.0006959228776395321,\n+                    0.0010016924934461713,\n+                    0.0011683015618473291,\n+                    0.0007219507242552936,\n+                    0.0004506743571255356,\n+                    0.0003839473647531122,\n+                    0.0006096045835874975,\n+                    0.0006778741371817887,\n+                    0.0006203189841471612,\n+                    0.0006753152702003717,\n+                    0.0004131025052629411,\n+                    0.000491982267703861,\n+                    0.000795087602455169,\n+                    0.0007778703584335744,\n+                    0.0009378900285810232,\n+                    0.0010353495599702,\n+                    0.0006254438776522875,\n+                    0.000214845611480996,\n+                    0.00012940631131641567,\n+                    0.00015907330089248717,\n+                    -7.865422958275303e-05,\n+                    -4.9406051402911544e-05,\n+                    0.000535525381565094,\n+                    0.0008429466979578137,\n+                    0.0009230281575582922,\n+                    0.0009178092004731297,\n+                    0.0005792290903627872,\n+                    0.0003179354825988412,\n+                    0.0002350879949517548,\n+                    0.0002593859098851681,\n+                    0.00047500411164946854,\n+                    0.0005929681938141584,\n+                    0.0008235352579504251,\n+                    0.0009488606592640281,\n+                    0.0009453080128878355,\n+                    0.0011052204063162208,\n+                    0.0009675186011008918,\n+                    0.0005994988605380058,\n+                    0.00043946868390776217,\n+                    0.0004515677283052355,\n+                    0.00041880516801029444\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0031247916631400585,\n+        \"codec_tol\": 0.0001,\n+        \"dec_tol\": 1e-05\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general-balanced\",\n+        \"bandwidth\": 1.5,\n+        \"codes\": [\n+            [\n+                [\n+                    361,\n+                    327,\n+                    361,\n+                    220,\n+                    296,\n+                    448,\n+                    794,\n+                    794,\n+                    220,\n+                    215,\n+                    215,\n+                    523,\n+                    794,\n+                    572,\n+                    837\n+                ],\n+                [\n+                    558,\n+                    561,\n+                    17,\n+                    689,\n+                    341,\n+                    17,\n+                    17,\n+                    746,\n+                    995,\n+                    203,\n+                    203,\n+                    626,\n+                    44,\n+                    930,\n+                    137\n+                ],\n+                [\n+                    551,\n+                    408,\n+                    315,\n+                    232,\n+                    209,\n+                    733,\n+                    935,\n+                    96,\n+                    644,\n+                    260,\n+                    204,\n+                    1005,\n+                    360,\n+                    220,\n+                    566\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    0.000503583112731576,\n+                    0.0012962579494342208,\n+                    0.000953793409280479,\n+                    0.000562680943403393,\n+                    0.0005354040767997503,\n+                    0.0001995227939914912,\n+                    0.00021683776867575943,\n+                    0.0007633829372934997,\n+                    0.0011789660202339292,\n+                    0.0011270726099610329,\n+                    0.0015703362878412008,\n+                    0.0018343244446441531,\n+                    0.0013319269055500627,\n+                    0.000994652509689331,\n+                    0.000904104090295732,\n+                    0.0010642888955771923,\n+                    0.001001085969619453,\n+                    0.0008879639790393412,\n+                    0.0009764981223270297,\n+                    0.0007446073577739298,\n+                    0.0009423579322174191,\n+                    0.0014007777208462358,\n+                    0.0014580122660845518,\n+                    0.001651210943236947,\n+                    0.0017139619449153543,\n+                    0.0011293691350147128,\n+                    0.00046205963008105755,\n+                    0.0002840239612851292,\n+                    0.00037141164648346603,\n+                    0.00018329237354919314,\n+                    0.00032734169508330524,\n+                    0.0011594139505177736,\n+                    0.001596459187567234,\n+                    0.0016294002998620272,\n+                    0.00158004742115736,\n+                    0.0011817252961918712,\n+                    0.0007946674595586956,\n+                    0.0006213290616869926,\n+                    0.0006479363073594868,\n+                    0.0008777808980084956,\n+                    0.0010338183492422104,\n+                    0.001345760771073401,\n+                    0.0015597327146679163,\n+                    0.0016180119710043073,\n+                    0.0018115403363481164,\n+                    0.001682001631706953,\n+                    0.0012854461092501879,\n+                    0.001027835882268846,\n+                    0.0009527513175271451,\n+                    0.000887712521944195\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0029652512166649103,\n+        \"codec_tol\": 0.0001,\n+        \"dec_tol\": 1e-05\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general-balanced\",\n+        \"bandwidth\": 2.0,\n+        \"codes\": [\n+            [\n+                [\n+                    361,\n+                    327,\n+                    361,\n+                    220,\n+                    296,\n+                    448,\n+                    794,\n+                    794,\n+                    220,\n+                    215,\n+                    215,\n+                    523,\n+                    794,\n+                    572,\n+                    837\n+                ],\n+                [\n+                    558,\n+                    561,\n+                    17,\n+                    689,\n+                    341,\n+                    17,\n+                    17,\n+                    746,\n+                    995,\n+                    203,\n+                    203,\n+                    626,\n+                    44,\n+                    930,\n+                    137\n+                ],\n+                [\n+                    551,\n+                    408,\n+                    315,\n+                    232,\n+                    209,\n+                    733,\n+                    935,\n+                    96,\n+                    644,\n+                    260,\n+                    204,\n+                    1005,\n+                    360,\n+                    220,\n+                    566\n+                ],\n+                [\n+                    14,\n+                    14,\n+                    407,\n+                    656,\n+                    472,\n+                    407,\n+                    472,\n+                    365,\n+                    444,\n+                    521,\n+                    162,\n+                    128,\n+                    575,\n+                    340,\n+                    407\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    0.0005418736836872995,\n+                    0.001448116498067975,\n+                    0.001061455113813281,\n+                    0.0007103311945684254,\n+                    0.0007390136015601456,\n+                    0.00034474380663596094,\n+                    0.0003522688348311931,\n+                    0.0008343191584572196,\n+                    0.001150410040281713,\n+                    0.0010256256209686399,\n+                    0.001495253061875701,\n+                    0.001773528871126473,\n+                    0.0012762193800881505,\n+                    0.0009920906741172075,\n+                    0.0009303519036620855,\n+                    0.0011235735146328807,\n+                    0.0010679269907996058,\n+                    0.0009568841778673232,\n+                    0.0010723505401983857,\n+                    0.0007524813408963382,\n+                    0.0009166915551759303,\n+                    0.0013677531387656927,\n+                    0.0013341642916202545,\n+                    0.0015379394171759486,\n+                    0.0016818979056552052,\n+                    0.001159622217528522,\n+                    0.0005840237135998905,\n+                    0.00046342622954398394,\n+                    0.0005499363178387284,\n+                    0.00028997453046031296,\n+                    0.0003494007105473429,\n+                    0.00111175118945539,\n+                    0.0014719140017405152,\n+                    0.001518196426331997,\n+                    0.0015718521317467093,\n+                    0.0012554096756502986,\n+                    0.0009631850407458842,\n+                    0.0008293383289128542,\n+                    0.0007663772557862103,\n+                    0.0008835261687636375,\n+                    0.0009167938260361552,\n+                    0.0011743532959371805,\n+                    0.0012979755410924554,\n+                    0.0013041547499597073,\n+                    0.0016306998440995812,\n+                    0.001617942820303142,\n+                    0.0012842006981372833,\n+                    0.001117410254664719,\n+                    0.0010679230326786637,\n+                    0.0009179076296277344\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.002776096574962139,\n+        \"codec_tol\": 0.0001,\n+        \"dec_tol\": 1e-05\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-hubert-general-balanced\",\n+        \"bandwidth\": 4.0,\n+        \"codes\": null,\n+        \"decoded\": null,\n+        \"codec_error\": 0.002473212545737624,\n+        \"codec_tol\": 0.0001,\n+        \"dec_tol\": 1e-05\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-mls\",\n+        \"bandwidth\": 0.5,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.0002471721963956952,\n+                    -0.0007365602068603039,\n+                    -0.00029661963344551623,\n+                    -0.0001487718109274283,\n+                    -0.00025510278646834195,\n+                    -8.943512511905283e-06,\n+                    0.0001678174448898062,\n+                    0.0001996321661863476,\n+                    -4.0839742723619565e-05,\n+                    -0.00035881157964468,\n+                    -0.0003721409884747118,\n+                    -0.00031694662175141275,\n+                    -0.00031707881134934723,\n+                    -0.000331440765876323,\n+                    -4.38143324572593e-05,\n+                    0.0003987671807408333,\n+                    0.0005647469661198556,\n+                    0.000618462567217648,\n+                    0.00044193019857630134,\n+                    -8.946254092734307e-05,\n+                    -0.00041933005559258163,\n+                    -0.00044410640839487314,\n+                    -0.00023401528596878052,\n+                    -3.552871567080729e-05,\n+                    0.00014210691733751446,\n+                    0.0002467158483341336,\n+                    0.00015603734937030822,\n+                    3.193183147232048e-05,\n+                    -0.00013763393508270383,\n+                    -0.00035281648160889745,\n+                    -0.000529766664840281,\n+                    -0.0006517550209537148,\n+                    -0.0006077081197872758,\n+                    -0.00020284725178498775,\n+                    0.00034685738501138985,\n+                    0.0006811313796788454,\n+                    0.000679212505929172,\n+                    0.0005077550304122269,\n+                    0.0003816273238044232,\n+                    0.0002144991885870695,\n+                    -0.00016964729002211243,\n+                    -0.00016414248966611922,\n+                    7.161950634326786e-05,\n+                    0.0002906467125285417,\n+                    0.0007565916166640818,\n+                    0.0010058481711894274,\n+                    0.0012552258558571339,\n+                    0.0010698521509766579,\n+                    0.0009335971553809941,\n+                    0.000667513522785157\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.002784556010738015,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-mls\",\n+        \"bandwidth\": 1.0,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.00021897304395679384,\n+                    -0.0006707283901050687,\n+                    -0.0003198632912244648,\n+                    -0.0002019737585214898,\n+                    -0.00031223104451783,\n+                    -0.00015073314716573805,\n+                    1.3109893188811839e-05,\n+                    0.00010109333379659802,\n+                    -4.4847565732197836e-05,\n+                    -0.00026841764338314533,\n+                    -0.0002181670570280403,\n+                    -0.00029383719083853066,\n+                    -0.0005045154830440879,\n+                    -0.0005756605532951653,\n+                    -0.0002519423433113843,\n+                    0.00017382082296535373,\n+                    0.0003450627264101058,\n+                    0.0004639998951461166,\n+                    0.00032735118293203413,\n+                    -0.0002998501295223832,\n+                    -0.0007324003963731229,\n+                    -0.0006358272512443364,\n+                    -0.00019679185061249882,\n+                    9.154963481705636e-05,\n+                    0.00023105139553081244,\n+                    0.0002694898867048323,\n+                    5.3933585149934515e-05,\n+                    -0.00017367034160997719,\n+                    -0.000370326975826174,\n+                    -0.00045389344450086355,\n+                    -0.0003742754051927477,\n+                    -0.0003183094668202102,\n+                    -0.0003107236698269844,\n+                    -7.117551285773516e-05,\n+                    0.00032562544220127165,\n+                    0.0005173510289750993,\n+                    0.00035740318708121777,\n+                    0.0001532924798084423,\n+                    8.018290100153536e-05,\n+                    -8.011072350200266e-05,\n+                    -0.0004129649023525417,\n+                    -0.0002168295468436554,\n+                    0.00016200236859731376,\n+                    0.00034917722223326564,\n+                    0.0006240003858692944,\n+                    0.0007102257804945111,\n+                    0.0006860584835521877,\n+                    0.00021981803001835942,\n+                    -7.106941484380513e-05,\n+                    -0.00018566018843557686\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0025421823374927044,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-mls\",\n+        \"bandwidth\": 1.5,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.00028943613870069385,\n+                    -0.0007279455894604325,\n+                    -0.00037402231828309596,\n+                    -0.00023792865977156907,\n+                    -0.0003411142679397017,\n+                    -0.0001595417852513492,\n+                    4.3847772758454084e-05,\n+                    3.897479109582491e-05,\n+                    -0.00015776942018419504,\n+                    -0.0003887333150487393,\n+                    -0.0003272934991400689,\n+                    -0.000308241811580956,\n+                    -0.0005203168257139623,\n+                    -0.0006497218855656683,\n+                    -0.00032806317904032767,\n+                    9.003604645840824e-05,\n+                    0.0002507736498955637,\n+                    0.00038551652687601745,\n+                    0.00031532219145447016,\n+                    -0.00028256408404558897,\n+                    -0.000780107919126749,\n+                    -0.0006798981921747327,\n+                    -0.000187133060535416,\n+                    9.075377602130175e-05,\n+                    0.0002059313701465726,\n+                    0.000252072379225865,\n+                    8.591249934397638e-05,\n+                    -6.903265602886677e-05,\n+                    -0.00022177191567607224,\n+                    -0.0003164776717312634,\n+                    -0.0002896834921557456,\n+                    -0.00034714731737039983,\n+                    -0.0004501724033616483,\n+                    -0.00014487521548289806,\n+                    0.00042451676563359797,\n+                    0.0007103644893504679,\n+                    0.0005320025375112891,\n+                    0.00030199086177162826,\n+                    0.00017571817443240434,\n+                    -7.344436016865075e-05,\n+                    -0.0004125718551222235,\n+                    -0.00022480337065644562,\n+                    0.00010712102812249213,\n+                    0.00021271411969792098,\n+                    0.0004759627627208829,\n+                    0.0007045314996503294,\n+                    0.0008243073243647814,\n+                    0.00042970190406776965,\n+                    0.00021766081044916064,\n+                    3.350689439685084e-05\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0024348432198166847,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-mls\",\n+        \"bandwidth\": 2.0,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.00010455434676259756,\n+                    -0.0006130463443696499,\n+                    -0.00019683418213389814,\n+                    -0.00010099369683302939,\n+                    -0.00021099163859616965,\n+                    -2.6220950530841947e-06,\n+                    0.00020871838205493987,\n+                    0.00018668117991182953,\n+                    -1.0649124305928126e-05,\n+                    -0.00018443060980644077,\n+                    -9.16237331693992e-05,\n+                    -0.00010015940642915666,\n+                    -0.0003710154560394585,\n+                    -0.0004892981378361583,\n+                    -0.00011564286251086742,\n+                    0.00032124019344337285,\n+                    0.0004669901682063937,\n+                    0.000622692343313247,\n+                    0.0005683908239006996,\n+                    -0.0001299505529459566,\n+                    -0.0007344742771238089,\n+                    -0.0006522545008920133,\n+                    -7.369450759142637e-05,\n+                    0.00023016634804662317,\n+                    0.00029706733766943216,\n+                    0.00040724140126258135,\n+                    0.00031984460656531155,\n+                    0.00010261082206852734,\n+                    -0.00017221950110979378,\n+                    -0.0002610271912999451,\n+                    -0.00015819921100046486,\n+                    -0.00027220440097153187,\n+                    -0.00047697784611955285,\n+                    -0.00013687692990060896,\n+                    0.0004770267987623811,\n+                    0.0007236705278046429,\n+                    0.0005755429738201201,\n+                    0.0005305277300067246,\n+                    0.0004971636226400733,\n+                    9.585886436980218e-05,\n+                    -0.00044038970372639596,\n+                    -0.0002591072116047144,\n+                    8.882302790880203e-05,\n+                    0.00010468350956216455,\n+                    0.0004465210950002074,\n+                    0.0008701237966306508,\n+                    0.001133413054049015,\n+                    0.0006035252590663731,\n+                    0.00032269812072627246,\n+                    0.0001862043427536264\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0022935366723686457,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-mls\",\n+        \"bandwidth\": 4.0,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    0.0002609139191918075,\n+                    -0.0005568607593886554,\n+                    -8.985280146589503e-06,\n+                    8.966325549408793e-05,\n+                    -7.479086343664676e-05,\n+                    0.0002076481468975544,\n+                    0.00034824819886125624,\n+                    0.000307059584883973,\n+                    0.00019627390429377556,\n+                    -3.6874123907182366e-05,\n+                    -7.025599188636988e-06,\n+                    -0.00012438457633834332,\n+                    -0.00032755275606177747,\n+                    -0.000411909946706146,\n+                    -8.821926894597709e-05,\n+                    0.0003717693325597793,\n+                    0.0004727449850179255,\n+                    0.0006257848581299186,\n+                    0.0005679113091900945,\n+                    -0.00014851021114736795,\n+                    -0.0006242442759685218,\n+                    -0.0005352640873752534,\n+                    -1.3237040548119694e-06,\n+                    0.0003045561315957457,\n+                    0.00041467309347353876,\n+                    0.0005932425847277045,\n+                    0.00044341094326227903,\n+                    0.00023843055532779545,\n+                    8.901742694433779e-05,\n+                    -1.0392006515758112e-05,\n+                    0.0001084191317204386,\n+                    0.00021004895097576082,\n+                    8.228524529840797e-05,\n+                    0.0003851399233099073,\n+                    0.0008233294356614351,\n+                    0.0008892629412002861,\n+                    0.000785985728725791,\n+                    0.0006910106167197227,\n+                    0.0005654219421558082,\n+                    0.00034487323137000203,\n+                    -0.00012858158152084798,\n+                    -3.434516838751733e-05,\n+                    0.0003092561091762036,\n+                    0.0003492308605927974,\n+                    0.0006020109285600483,\n+                    0.0008246254292316735,\n+                    0.0010068734409287572,\n+                    0.000397632597014308,\n+                    0.00017323131032753736,\n+                    0.00012472675007302314\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.002119641751050949,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 0.0001\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-more-data\",\n+        \"bandwidth\": 0.5,\n+        \"codes\": [\n+            [\n+                [\n+                    44,\n+                    881,\n+                    344,\n+                    344,\n+                    344,\n+                    881,\n+                    44,\n+                    881,\n+                    571,\n+                    813,\n+                    107,\n+                    950,\n+                    437,\n+                    950,\n+                    437\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    8.60798463691026e-05,\n+                    -0.0003060192975681275,\n+                    9.043663885677233e-05,\n+                    0.00014830089639872313,\n+                    -2.100023630191572e-05,\n+                    0.00017922179540619254,\n+                    0.00023896087077446282,\n+                    0.00024265481624752283,\n+                    9.400439739692956e-05,\n+                    -0.0001393423299305141,\n+                    -0.00017324750660918653,\n+                    -0.00010024692164734006,\n+                    -9.44490238907747e-05,\n+                    -0.00022922895732335746,\n+                    -1.1478223314043134e-06,\n+                    0.0003733094781637192,\n+                    0.00048060796689242125,\n+                    0.00044257345143705606,\n+                    0.00030929266358725727,\n+                    -2.485524964868091e-05,\n+                    -0.00015137175796553493,\n+                    -4.780884046340361e-05,\n+                    0.00020679077715612948,\n+                    0.00033283786615356803,\n+                    0.0003789166221395135,\n+                    0.0004155742935836315,\n+                    0.00019656820222735405,\n+                    -6.525123899336904e-05,\n+                    -0.00014414236648008227,\n+                    -0.00024506013141945004,\n+                    -0.0002763999509625137,\n+                    -0.0002528353070374578,\n+                    -0.0002784187672659755,\n+                    -5.5240401707123965e-05,\n+                    0.00034663392580114305,\n+                    0.0005081702838651836,\n+                    0.0003451743978075683,\n+                    0.00017948850290849805,\n+                    0.0001805563224479556,\n+                    5.415735358837992e-05,\n+                    -0.0002908696769736707,\n+                    -0.00022546530817635357,\n+                    -2.816985215758905e-06,\n+                    8.796519978204742e-05,\n+                    0.00036707063554786146,\n+                    0.0004874078440479934,\n+                    0.0006295923958532512,\n+                    0.00048173684626817703,\n+                    0.0004252410144545138,\n+                    0.00026322310441173613\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.002914232201874256,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 1e-05\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-more-data\",\n+        \"bandwidth\": 1.0,\n+        \"codes\": [\n+            [\n+                [\n+                    44,\n+                    881,\n+                    344,\n+                    344,\n+                    344,\n+                    881,\n+                    44,\n+                    881,\n+                    571,\n+                    813,\n+                    107,\n+                    950,\n+                    437,\n+                    950,\n+                    437\n+                ],\n+                [\n+                    659,\n+                    335,\n+                    335,\n+                    801,\n+                    30,\n+                    726,\n+                    647,\n+                    721,\n+                    562,\n+                    421,\n+                    421,\n+                    797,\n+                    797,\n+                    797,\n+                    797\n+                ]\n+            ]\n+        ],\n+        \"decoded\": [\n+            [\n+                [\n+                    -0.00013853900600224733,\n+                    -0.0006001053261570632,\n+                    -0.00014205696061253548,\n+                    -5.91947537031956e-06,\n+                    -0.00010432626731926575,\n+                    8.372707816306502e-05,\n+                    0.00019299553241580725,\n+                    0.0002358516794629395,\n+                    -3.9954891690285876e-05,\n+                    -0.0002931125636678189,\n+                    -0.00026569172041490674,\n+                    -0.00043283088598400354,\n+                    -0.0006556544685736299,\n+                    -0.0006934062112122774,\n+                    -0.00022642247495241463,\n+                    0.0002532481448724866,\n+                    0.0005737473256886005,\n+                    0.0007966211414895952,\n+                    0.000520562578458339,\n+                    -0.00015708617866039276,\n+                    -0.0004774363187607378,\n+                    -0.0003260352532379329,\n+                    6.291552563197911e-05,\n+                    0.0002651271061040461,\n+                    0.00031190537265501916,\n+                    0.0003755779762286693,\n+                    0.00024414766812697053,\n+                    7.252671639434993e-05,\n+                    -6.486603524535894e-05,\n+                    -0.00016354414401575923,\n+                    -3.527149237925187e-05,\n+                    -0.00011908992746612057,\n+                    -0.0004999941447749734,\n+                    -0.0004161799151916057,\n+                    0.0002218327426817268,\n+                    0.0004935782635584474,\n+                    0.0002801110385917127,\n+                    0.00032458442728966475,\n+                    0.0007008450338616967,\n+                    0.0006555632571689785,\n+                    7.318511052289978e-05,\n+                    0.0001435471058357507,\n+                    0.0003743935376405716,\n+                    0.00017988341278396547,\n+                    0.00022015272406861186,\n+                    0.00037314006476663053,\n+                    0.0005442615947686136,\n+                    0.00028906844090670347,\n+                    0.0002551917568780482,\n+                    0.00038736595888622105\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.002613937947899103,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 1e-05\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-more-data\",\n+        \"bandwidth\": 1.5,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    6.279885565163568e-05,\n+                    -0.00033689799602143466,\n+                    0.00011250129318796098,\n+                    0.00019457557937130332,\n+                    0.0001285735343117267,\n+                    0.00032528748852200806,\n+                    0.0003915508568752557,\n+                    0.0003026904596481472,\n+                    0.0002715887385420501,\n+                    0.00014779283083043993,\n+                    0.00011752712453017011,\n+                    5.8236309996573254e-05,\n+                    -0.00019055884331464767,\n+                    -0.0003741715627256781,\n+                    6.279123772401363e-05,\n+                    0.0007348853396251798,\n+                    0.0010394826531410217,\n+                    0.0010661018313840032,\n+                    0.0007755373371765018,\n+                    -2.9394934244919568e-05,\n+                    -0.000576356309466064,\n+                    -0.00027806576690636575,\n+                    0.00037756405072286725,\n+                    0.0006358004757203162,\n+                    0.0006607291288673878,\n+                    0.000555443752091378,\n+                    0.00015076500130817294,\n+                    -7.972745515871793e-05,\n+                    -7.068378909025341e-05,\n+                    -0.00018670226563699543,\n+                    -0.00018936209380626678,\n+                    -0.00012967083603143692,\n+                    -0.0003847008920274675,\n+                    -0.0004100532678421587,\n+                    0.0002501893322914839,\n+                    0.0007843074854463339,\n+                    0.000563940207939595,\n+                    0.000467402336653322,\n+                    0.0007548240246251225,\n+                    0.0005277566961012781,\n+                    -1.5599987818859518e-05,\n+                    0.0002939583209808916,\n+                    0.0006670067086815834,\n+                    0.0005304471123963594,\n+                    0.000824933813419193,\n+                    0.0012162369675934315,\n+                    0.001134063582867384,\n+                    0.0007296190597116947,\n+                    0.0008042262634262443,\n+                    0.0005679695168510079\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.002474759239703417,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 1e-05\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-more-data\",\n+        \"bandwidth\": 2.0,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    0.00025080336490646005,\n+                    -0.00017259249580092728,\n+                    0.00025967558030970395,\n+                    0.000364720297511667,\n+                    0.0002696491137612611,\n+                    0.0004170248284935951,\n+                    0.0005731081473641098,\n+                    0.0005545281455852091,\n+                    0.0004947385750710964,\n+                    0.00031294734799303114,\n+                    0.0002801477094180882,\n+                    0.0001770674716681242,\n+                    -0.00011514315701788291,\n+                    -0.00026510338648222387,\n+                    0.00021959032164886594,\n+                    0.000816573272459209,\n+                    0.001120111788623035,\n+                    0.0012912392849102616,\n+                    0.001166811096481979,\n+                    0.0005309308762662113,\n+                    8.758961485000327e-06,\n+                    0.00021711227600462735,\n+                    0.0007150850724428892,\n+                    0.0008045516442507505,\n+                    0.0007022423087619245,\n+                    0.0007424060022458434,\n+                    0.0006152429268695414,\n+                    0.0004591939796227962,\n+                    0.0003924915799871087,\n+                    0.00026367188547737896,\n+                    0.00017671581008471549,\n+                    4.0699342207517475e-05,\n+                    -0.0001596197544131428,\n+                    -7.874160655774176e-05,\n+                    0.0004457739123608917,\n+                    0.0008729892433620989,\n+                    0.0007467817049473524,\n+                    0.0007103694952093065,\n+                    0.0010271944338455796,\n+                    0.0008960479754023254,\n+                    0.0004278179258108139,\n+                    0.0006703450926579535,\n+                    0.0008964851731434464,\n+                    0.0006187634426169097,\n+                    0.0007422066992148757,\n+                    0.0010011898120865226,\n+                    0.0008749665576033294,\n+                    0.00045576749835163355,\n+                    0.0005878594820387661,\n+                    0.00046867664786987007\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0023411870934069157,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 1e-05\n+    },\n+    {\n+        \"repo_id\": \"hf-audio/xcodec-wavlm-more-data\",\n+        \"bandwidth\": 4.0,\n+        \"codes\": null,\n+        \"decoded\": [\n+            [\n+                [\n+                    0.0005943458527326584,\n+                    0.00017469993326812983,\n+                    0.0007098331698216498,\n+                    0.0008159588905982673,\n+                    0.0008173630340024829,\n+                    0.0010675098747015,\n+                    0.0011202740715816617,\n+                    0.0009797199163585901,\n+                    0.0008500582771375775,\n+                    0.0006013234378769994,\n+                    0.000489078345708549,\n+                    0.0004758498689625412,\n+                    0.0004311382654123008,\n+                    0.00044707287452183664,\n+                    0.0008811730076558888,\n+                    0.0014070728793740273,\n+                    0.0015382873825728893,\n+                    0.0014448357978835702,\n+                    0.001160905696451664,\n+                    0.0004969813744537532,\n+                    -1.3974204193800688e-06,\n+                    0.00016932631842792034,\n+                    0.0007671721396036446,\n+                    0.0010725297033786774,\n+                    0.0010861807968467474,\n+                    0.0010590273886919022,\n+                    0.0007575892377644777,\n+                    0.0003892407985404134,\n+                    -1.2117772712372243e-05,\n+                    -0.00036681993515230715,\n+                    -0.0004377248405944556,\n+                    -0.00038845473318360746,\n+                    -0.00036490376805886626,\n+                    -5.0593931518960744e-05,\n+                    0.0005764220259152353,\n+                    0.0010159657103940845,\n+                    0.000954087299760431,\n+                    0.0009282709797844291,\n+                    0.0010461328784003854,\n+                    0.0007925458485260606,\n+                    0.0002687857486307621,\n+                    0.00048614019760861993,\n+                    0.0009145350777544081,\n+                    0.0009633700246922672,\n+                    0.0012744814157485962,\n+                    0.0016483643557876348,\n+                    0.0016050116391852498,\n+                    0.0008498440147377551,\n+                    0.0005446132854558527,\n+                    0.00015282645472325385\n+                ]\n+            ]\n+        ],\n+        \"codec_error\": 0.0021570040844380856,\n+        \"codec_tol\": 1e-05,\n+        \"dec_tol\": 1e-05\n+    }\n+]\n\\ No newline at end of file"
        },
        {
            "sha": "9ceec8fd61b03a11fc8f1ee224a379c4d01984af",
            "filename": "tests/models/dac/test_modeling_dac.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/tests%2Fmodels%2Fdac%2Ftest_modeling_dac.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/tests%2Fmodels%2Fdac%2Ftest_modeling_dac.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Fmodels%2Fdac%2Ftest_modeling_dac.py?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -376,12 +376,14 @@ def test_identity_shortcut(self):\n         self.model_tester.create_and_check_model_forward(config, inputs_dict)\n \n \n+# Copied from transformers.tests.encodec.test_modeling_encodec.normalize\n def normalize(arr):\n     norm = np.linalg.norm(arr)\n     normalized_arr = arr / norm\n     return normalized_arr\n \n \n+# Copied from transformers.tests.encodec.test_modeling_encodec.compute_rmse\n def compute_rmse(arr1, arr2):\n     arr1_np = arr1.cpu().numpy().squeeze()\n     arr2_np = arr2.cpu().numpy().squeeze()"
        },
        {
            "sha": "186ff364c2ce7f6d90f3c212da852517ed1890f8",
            "filename": "tests/models/xcodec/test_modeling_xcodec.py",
            "status": "modified",
            "additions": 90,
            "deletions": 46,
            "changes": 136,
            "blob_url": "https://github.com/huggingface/transformers/blob/d0f1a6ec3692160302a21613d8b7599aabf49f17/tests%2Fmodels%2Fxcodec%2Ftest_modeling_xcodec.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/d0f1a6ec3692160302a21613d8b7599aabf49f17/tests%2Fmodels%2Fxcodec%2Ftest_modeling_xcodec.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Fmodels%2Fxcodec%2Ftest_modeling_xcodec.py?ref=d0f1a6ec3692160302a21613d8b7599aabf49f17",
            "patch": "@@ -1,4 +1,4 @@\n-# Copyright 2024 The HuggingFace Inc. team. All rights reserved.\n+# Copyright 2025 The HuggingFace Inc. team. All rights reserved.\n #\n # Licensed under the Apache License, Version 2.0 (the \"License\");\n # you may not use this file except in compliance with the License.\n@@ -14,13 +14,16 @@\n \"\"\"Testing suite for the PyTorch Xcodec model.\"\"\"\n \n import inspect\n+import json\n import math\n import os\n import tempfile\n import unittest\n+from pathlib import Path\n \n import numpy as np\n from datasets import Audio, load_dataset\n+from parameterized import parameterized\n from pytest import mark\n \n from tests.test_configuration_common import ConfigTester\n@@ -52,7 +55,6 @@ def __init__(\n         num_channels=1,\n         sample_rate=16000,\n         codebook_size=1024,\n-        num_quantizers=8,\n         num_samples=400,\n         is_training=False,\n     ):\n@@ -61,7 +63,6 @@ def __init__(\n         self.num_channels = num_channels\n         self.sample_rate = sample_rate\n         self.codebook_size = codebook_size\n-        self.num_quantizers = num_quantizers\n         self.is_training = is_training\n         self.num_samples = num_samples\n \n@@ -79,7 +80,7 @@ def prepare_config_and_inputs_for_model_class(self, model_class):\n         config, inputs_dict = self.prepare_config_and_inputs()\n         codes_length = math.ceil(self.num_samples / config.hop_length)\n         inputs_dict[\"audio_codes\"] = ids_tensor(\n-            [self.batch_size, self.num_quantizers, codes_length], config.codebook_size\n+            [self.batch_size, config.num_quantizers, codes_length], config.codebook_size\n         )\n \n         return config, inputs_dict\n@@ -89,7 +90,6 @@ def get_config(self):\n             sample_rate=self.sample_rate,\n             audio_channels=self.num_channels,\n             codebook_size=self.codebook_size,\n-            num_quantizers=self.num_quantizers,\n         )\n \n     def create_and_check_model_forward(self, config, inputs_dict):\n@@ -121,7 +121,7 @@ def _prepare_for_class(self, inputs_dict, model_class, return_labels=False):\n     def setUp(self):\n         self.model_tester = XcodecModelTester(self)\n         self.config_tester = ConfigTester(\n-            self, config_class=XcodecConfig, hidden_size=37, common_properties=[], has_text_modality=False\n+            self, config_class=XcodecConfig, common_properties=[], has_text_modality=False\n         )\n \n     def test_config(self):\n@@ -417,53 +417,97 @@ def normalize(arr):\n \n # Copied from transformers.tests.encodec.test_modeling_encodec.compute_rmse\n def compute_rmse(arr1, arr2):\n-    arr1_normalized = normalize(arr1)\n-    arr2_normalized = normalize(arr2)\n+    arr1_np = arr1.cpu().numpy().squeeze()\n+    arr2_np = arr2.cpu().numpy().squeeze()\n+    max_length = min(arr1.shape[-1], arr2.shape[-1])\n+    arr1_np = arr1_np[..., :max_length]\n+    arr2_np = arr2_np[..., :max_length]\n+    arr1_normalized = normalize(arr1_np)\n+    arr2_normalized = normalize(arr2_np)\n     return np.sqrt(((arr1_normalized - arr2_normalized) ** 2).mean())\n \n \n-# @slow\n-@require_torch\n-class XcodecIntegrationTest(unittest.TestCase):\n-    def test_integration(self):\n-        expected_rmse = {\n-            \"0.5\": 0.0065491,\n-            \"4.0\": 0.0070978,\n-        }\n-        expected_codesums = {\n-            \"0.5\": [117262],\n-            \"4.0\": [926416],\n-        }\n-\n-        librispeech = load_dataset(\"hf-internal-testing/librispeech_asr_dummy\", \"clean\", split=\"validation\")\n-        model_id = \"Manel/X-Codec\"\n-        model = XcodecModel.from_pretrained(model_id).to(torch_device).eval()\n-        feature_extractor = AutoFeatureExtractor.from_pretrained(model_id)\n-\n-        librispeech = librispeech.cast_column(\"audio\", Audio(sampling_rate=feature_extractor.sampling_rate))\n-        audio = librispeech[-1][\"audio\"][\"array\"]\n+\"\"\"\n+Integration tests for XCodec\n \n-        inputs = feature_extractor(\n-            raw_audio=audio, sampling_rate=feature_extractor.sampling_rate, return_tensors=\"pt\"\n-        ).to(torch_device)\n+Code for reproducing expected outputs can be found here:\n+https://gist.github.com/ebezzam/cdaf8c223e59e7677b2ea6bc2dc8230b\n \n-        for bandwidth, exp_rmse in expected_rmse.items():\n-            bandwidth = float(bandwidth)\n-            with torch.no_grad():\n-                audio_codes = model.encode(inputs[\"input_values\"], bandwidth=bandwidth, return_dict=False)\n-                codesum = int(audio_codes.sum().item())\n+One reason for higher tolerances is because of different implementation of `Snake1d` within Transformer version DAC\n+See here: https://github.com/huggingface/transformers/pull/39793#issue-3277407384\n \n-                expected_codesum = expected_codesums[str(bandwidth)][0]\n-                self.assertEqual(codesum, expected_codesum)\n+\"\"\"\n \n-                input_values_dec = model.decode(audio_codes, return_dict=False)\n-                input_values_enc_dec = model(inputs[\"input_values\"], bandwidth=bandwidth)[1]\n+RESULTS_PATH = Path(__file__).parent.parent.parent / \"fixtures/xcodec/integration_tests.json\"\n \n-            self.assertTrue(torch.allclose(input_values_dec, input_values_enc_dec, atol=1e-3))\n+with open(RESULTS_PATH, \"r\") as f:\n+    raw_data = json.load(f)\n+\n+# convert dicts into tuples ordered to match test args\n+EXPECTED_OUTPUTS_JSON = [\n+    (\n+        f\"{d['repo_id']}_{d['bandwidth']}\",\n+        d[\"repo_id\"],\n+        d[\"bandwidth\"],\n+        d[\"codes\"],\n+        d[\"decoded\"],\n+        d[\"codec_error\"],\n+        d[\"codec_tol\"],\n+        d[\"dec_tol\"],\n+    )\n+    for d in raw_data\n+]\n+\n+\n+@slow\n+@require_torch\n+class XcodecIntegrationTest(unittest.TestCase):\n+    @parameterized.expand(EXPECTED_OUTPUTS_JSON)\n+    def test_integration(\n+        self, test_name, repo_id, bandwidth, exp_codes, exp_decoded, exp_codec_err, codec_tol, dec_tol\n+    ):\n+        # load model\n+        model = XcodecModel.from_pretrained(repo_id).to(torch_device).eval()\n+        feature_extractor = AutoFeatureExtractor.from_pretrained(repo_id)\n+\n+        # load audio example\n+        librispeech_dummy = load_dataset(\"hf-internal-testing/librispeech_asr_dummy\", \"clean\", split=\"validation\")\n+        librispeech_dummy = librispeech_dummy.cast_column(\n+            \"audio\", Audio(sampling_rate=feature_extractor.sampling_rate)\n+        )\n+        audio_array = librispeech_dummy[0][\"audio\"][\"array\"]\n+        inputs = feature_extractor(\n+            raw_audio=audio_array, sampling_rate=feature_extractor.sampling_rate, return_tensors=\"pt\"\n+        ).to(torch_device)\n+        x = inputs[\"input_values\"]\n+\n+        with torch.no_grad():\n+            ENC_TOL = 0\n+            audio_codes = model.encode(x, bandwidth=bandwidth, return_dict=False)\n+            if exp_codes is not None:\n+                exp_codes = torch.tensor(exp_codes).to(torch_device)\n+                torch.testing.assert_close(\n+                    audio_codes[..., : exp_codes.shape[-1]],\n+                    exp_codes,\n+                    rtol=ENC_TOL,\n+                    atol=ENC_TOL,\n+                )\n+\n+            # dec_tol = 1e-5    # increased to 1e-4 for passing on 4 kbps\n+            input_values_dec = model.decode(audio_codes).audio_values\n+            if exp_decoded is not None:\n+                exp_decoded = torch.tensor(exp_decoded).to(torch_device)\n+                torch.testing.assert_close(\n+                    input_values_dec[..., : exp_decoded.shape[-1]],\n+                    exp_decoded,\n+                    rtol=dec_tol,\n+                    atol=dec_tol,\n+                )\n \n-            self.assertTrue(inputs[\"input_values\"].shape == input_values_enc_dec.shape)\n+            # compute codec error\n+            codec_err = compute_rmse(input_values_dec, x)\n+            torch.testing.assert_close(codec_err, exp_codec_err, rtol=codec_tol, atol=codec_tol)\n \n-            arr = inputs[\"input_values\"][0].cpu().numpy()\n-            arr_enc_dec = input_values_enc_dec[0].cpu().numpy()\n-            rmse = compute_rmse(arr, arr_enc_dec)\n-            self.assertTrue(np.abs(rmse - exp_rmse) < 1e-5)\n+            # make sure forward and decode gives same result\n+            audio_values_enc_dec = model(x, bandwidth=bandwidth).audio_values\n+            torch.testing.assert_close(input_values_dec, audio_values_enc_dec, rtol=1e-6, atol=1e-6)"
        }
    ],
    "stats": {
        "total": 2617,
        "additions": 2465,
        "deletions": 152
    }
}