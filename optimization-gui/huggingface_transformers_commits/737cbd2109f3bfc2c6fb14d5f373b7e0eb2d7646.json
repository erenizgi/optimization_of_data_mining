{
    "author": "jiqing-feng",
    "message": "Fix llava xpu tests. (#37130)\n\n* fix llava 4bit xpu test\n\nSigned-off-by: jiqing-feng <jiqing.feng@intel.com>\n\n* fix llava 4bit xpu test\n\nSigned-off-by: jiqing-feng <jiqing.feng@intel.com>\n\n* fix format\n\nSigned-off-by: jiqing-feng <jiqing.feng@intel.com>\n\n* fix format\n\nSigned-off-by: jiqing-feng <jiqing.feng@intel.com>\n\n---------\n\nSigned-off-by: jiqing-feng <jiqing.feng@intel.com>",
    "sha": "737cbd2109f3bfc2c6fb14d5f373b7e0eb2d7646",
    "files": [
        {
            "sha": "23f9f1a7d09c3e821acda3cba388d009da9ed434",
            "filename": "tests/models/llava/test_modeling_llava.py",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/huggingface/transformers/blob/737cbd2109f3bfc2c6fb14d5f373b7e0eb2d7646/tests%2Fmodels%2Fllava%2Ftest_modeling_llava.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/737cbd2109f3bfc2c6fb14d5f373b7e0eb2d7646/tests%2Fmodels%2Fllava%2Ftest_modeling_llava.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Fmodels%2Fllava%2Ftest_modeling_llava.py?ref=737cbd2109f3bfc2c6fb14d5f373b7e0eb2d7646",
            "patch": "@@ -617,8 +617,13 @@ def test_pixtral_4bit(self):\n         generate_ids = model.generate(**inputs, max_new_tokens=50)\n         output = processor.batch_decode(generate_ids, skip_special_tokens=True, clean_up_tokenization_spaces=False)[0]\n \n-        EXPECTED_GENERATION = \"Describe the images. The image showcases a dog, which is prominently positioned in the center, taking up a significant portion of the frame. The dog is situated against a backdrop of a wooden surface, which spans the entire image. The dog appears to be a black Labrador\"  # fmt: skip\n-        self.assertEqual(output, EXPECTED_GENERATION)\n+        EXPECTED_GENERATION = [\n+            # CUDA output\n+            \"Describe the images. The image showcases a dog, which is prominently positioned in the center, taking up a significant portion of the frame. The dog is situated against a backdrop of a wooden surface, which spans the entire image. The dog appears to be a black Labrador\",\n+            # XPU output\n+            \"Describe the images.The image showcases a dog, which is prominently positioned in the center, taking up a significant portion of the frame. The dog is situated against a backdrop of a wooden surface, which covers the entire background. The dog appears to be the main focus\",\n+        ]  # fmt: skip\n+        self.assertTrue(output in EXPECTED_GENERATION)\n \n     @slow\n     @require_bitsandbytes"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 7,
        "deletions": 2
    }
}