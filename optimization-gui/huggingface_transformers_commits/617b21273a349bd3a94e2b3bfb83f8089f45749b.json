{
    "author": "McPatate",
    "message": "fix(ci): benchmarks dashboard was failing due to missing quotations (#34100)",
    "sha": "617b21273a349bd3a94e2b3bfb83f8089f45749b",
    "files": [
        {
            "sha": "2375663ffbc6dbf0c48c60cca063fc09e503e0ec",
            "filename": "benchmark/grafana_dashboard.json",
            "status": "modified",
            "additions": 34,
            "deletions": 34,
            "changes": 68,
            "blob_url": "https://github.com/huggingface/transformers/blob/617b21273a349bd3a94e2b3bfb83f8089f45749b/benchmark%2Fgrafana_dashboard.json",
            "raw_url": "https://github.com/huggingface/transformers/raw/617b21273a349bd3a94e2b3bfb83f8089f45749b/benchmark%2Fgrafana_dashboard.json",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/benchmark%2Fgrafana_dashboard.json?ref=617b21273a349bd3a94e2b3bfb83f8089f45749b",
            "patch": "@@ -148,7 +148,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT commit_id as commit_id, commit_message, gpu_name FROM benchmarks WHERE branch = ${branch};\",\n+          \"rawSql\": \"SELECT commit_id as commit_id, commit_message, gpu_name FROM benchmarks WHERE branch = '${branch}';\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -283,7 +283,7 @@\n       \"id\": 7,\n       \"options\": {\n         \"barRadius\": 0.05,\n-        \"barWidth\": 0.3,\n+        \"barWidth\": 0.8,\n         \"fullHighlight\": false,\n         \"groupWidth\": 0.7,\n         \"legend\": {\n@@ -312,7 +312,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'first_eager_forward_pass_time_secs' AS double precision) AS first_eager_forward_pass_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'first_eager_forward_pass_time_secs' AS double precision) AS first_eager_forward_pass_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -424,7 +424,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'second_eager_forward_pass_time_secs' AS double precision) AS second_eager_forward_pass_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'second_eager_forward_pass_time_secs' AS double precision) AS second_eager_forward_pass_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -545,7 +545,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_first_token_secs' AS double precision) AS time_to_first_token_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_first_token_secs' AS double precision) AS time_to_first_token_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -653,7 +653,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_second_token_secs' AS double precision) AS time_to_second_token_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_second_token_secs' AS double precision) AS time_to_second_token_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -761,7 +761,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_third_token_secs' AS double precision) AS time_to_third_token_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_third_token_secs' AS double precision) AS time_to_third_token_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -869,7 +869,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_next_token_mean_secs' AS double precision) AS time_to_next_token_mean_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_next_token_mean_secs' AS double precision) AS time_to_next_token_mean_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -990,7 +990,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'first_compile_generate_time_secs' AS double precision) AS first_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'first_compile_generate_time_secs' AS double precision) AS first_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -1098,7 +1098,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'second_compile_generate_time_secs' AS double precision) AS second_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}';\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'second_compile_generate_time_secs' AS double precision) AS second_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}';\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -1206,7 +1206,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'third_compile_generate_time_secs' AS double precision) AS third_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}';\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'third_compile_generate_time_secs' AS double precision) AS third_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}';\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -1314,7 +1314,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT CAST(m.measurements->'fourth_compile_generate_time_secs' AS double precision) AS fourth_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}';\",\n+          \"rawSql\": \"SELECT CAST(m.measurements->'fourth_compile_generate_time_secs' AS double precision) AS fourth_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = '${branch}' AND gpu_name = '${gpu_name}';\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -1442,7 +1442,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT\\n  d.cpu_util,\\n  d.time\\nFROM\\n  benchmarks AS b\\n  JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id\\nWHERE\\n  branch = ${branch}\",\n+          \"rawSql\": \"SELECT\\n  d.cpu_util,\\n  d.time\\nFROM\\n  benchmarks AS b\\n  JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id\\nWHERE\\n  branch = '${branch}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -1627,7 +1627,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT\\n  b.commit_id,\\n  d.gpu_util,\\n  d.time\\nFROM\\n  benchmarks AS b\\n  JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id\\nWHERE\\n  branch = ${branch}\",\n+          \"rawSql\": \"SELECT\\n  b.commit_id,\\n  d.gpu_util,\\n  d.time\\nFROM\\n  benchmarks AS b\\n  JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id\\nWHERE\\n  branch = '${branch}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -1812,7 +1812,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT d.mem_megabytes, d.time FROM benchmarks AS b JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id WHERE branch = ${branch}\",\n+          \"rawSql\": \"SELECT d.mem_megabytes, d.time FROM benchmarks AS b JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id WHERE branch = '${branch}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -1997,7 +1997,7 @@\n           \"editorMode\": \"code\",\n           \"format\": \"table\",\n           \"rawQuery\": true,\n-          \"rawSql\": \"SELECT\\n  d.gpu_mem_megabytes,\\n  d.time\\nFROM\\n  benchmarks AS b\\n  JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id\\nWHERE\\n  branch = ${branch}\",\n+          \"rawSql\": \"SELECT\\n  d.gpu_mem_megabytes,\\n  d.time\\nFROM\\n  benchmarks AS b\\n  JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id\\nWHERE\\n  branch = '${branch}'\",\n           \"refId\": \"A\",\n           \"sql\": {\n             \"columns\": [\n@@ -2099,13 +2099,9 @@\n     \"list\": [\n       {\n         \"current\": {\n-          \"selected\": true,\n-          \"text\": [\n-            \"refactor/benchmarks\"\n-          ],\n-          \"value\": [\n-            \"refactor/benchmarks\"\n-          ]\n+          \"selected\": false,\n+          \"text\": \"main\",\n+          \"value\": \"main\"\n         },\n         \"datasource\": {\n           \"type\": \"grafana-postgresql-datasource\",\n@@ -2129,21 +2125,21 @@\n       {\n         \"current\": {\n           \"selected\": false,\n-          \"text\": \"1728570853117\",\n-          \"value\": \"1728570853117\"\n+          \"text\": \"1728662868776\",\n+          \"value\": \"1728662868776\"\n         },\n         \"datasource\": {\n           \"type\": \"grafana-postgresql-datasource\",\n           \"uid\": \"de0dbhs18ho1sc\"\n         },\n-        \"definition\": \"SELECT created_at - INTERVAL '5 secs' FROM benchmarks WHERE branch = ${branch} ORDER BY benchmark_id ASC LIMIT 1;\",\n+        \"definition\": \"SELECT created_at - INTERVAL '5 secs' FROM benchmarks WHERE branch = '${branch}' ORDER BY benchmark_id ASC LIMIT 1;\",\n         \"description\": \"\",\n         \"hide\": 2,\n         \"includeAll\": false,\n         \"multi\": false,\n         \"name\": \"StartTime\",\n         \"options\": [],\n-        \"query\": \"SELECT created_at - INTERVAL '5 secs' FROM benchmarks WHERE branch = ${branch} ORDER BY benchmark_id ASC LIMIT 1;\",\n+        \"query\": \"SELECT created_at - INTERVAL '5 secs' FROM benchmarks WHERE branch = '${branch}' ORDER BY benchmark_id ASC LIMIT 1;\",\n         \"refresh\": 2,\n         \"regex\": \"\",\n         \"skipUrlSync\": false,\n@@ -2153,21 +2149,21 @@\n       {\n         \"current\": {\n           \"selected\": false,\n-          \"text\": \"1728657828802\",\n-          \"value\": \"1728657828802\"\n+          \"text\": \"1728663254125\",\n+          \"value\": \"1728663254125\"\n         },\n         \"datasource\": {\n           \"type\": \"grafana-postgresql-datasource\",\n           \"uid\": \"de0dbhs18ho1sc\"\n         },\n-        \"definition\": \"SELECT time + INTERVAL '5 secs' FROM benchmarks AS b JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id WHERE branch = ${branch} ORDER BY b.benchmark_id DESC, d.measurement_id DESC LIMIT 1;\",\n+        \"definition\": \"SELECT time + INTERVAL '5 secs' FROM benchmarks AS b JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id WHERE branch = '${branch}' ORDER BY b.benchmark_id DESC, d.measurement_id DESC LIMIT 1;\",\n         \"description\": \"\",\n         \"hide\": 2,\n         \"includeAll\": false,\n         \"multi\": false,\n         \"name\": \"EndTime\",\n         \"options\": [],\n-        \"query\": \"SELECT time + INTERVAL '5 secs' FROM benchmarks AS b JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id WHERE branch = ${branch} ORDER BY b.benchmark_id DESC, d.measurement_id DESC LIMIT 1;\",\n+        \"query\": \"SELECT time + INTERVAL '5 secs' FROM benchmarks AS b JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id WHERE branch = '${branch}' ORDER BY b.benchmark_id DESC, d.measurement_id DESC LIMIT 1;\",\n         \"refresh\": 2,\n         \"regex\": \"\",\n         \"skipUrlSync\": false,\n@@ -2180,6 +2176,10 @@\n           \"text\": \"NVIDIA A10G\",\n           \"value\": \"NVIDIA A10G\"\n         },\n+        \"datasource\": {\n+          \"type\": \"grafana-postgresql-datasource\",\n+          \"uid\": \"de0dbhs18ho1sc\"\n+        },\n         \"definition\": \"SELECT DISTINCT gpu_name FROM benchmarks;\",\n         \"hide\": 0,\n         \"includeAll\": false,\n@@ -2197,15 +2197,15 @@\n     ]\n   },\n   \"time\": {\n-    \"from\": \"2024-10-11T13:10:01.641Z\",\n-    \"to\": \"2024-10-11T13:25:21.783Z\"\n+    \"from\": \"now-1h\",\n+    \"to\": \"now\"\n   },\n   \"timepicker\": {\n     \"hidden\": false\n   },\n   \"timezone\": \"browser\",\n   \"title\": \"Transformers benchmarks\",\n   \"uid\": \"fdz33iyzln9c0a\",\n-  \"version\": 9,\n+  \"version\": 11,\n   \"weekStart\": \"\"\n }"
        }
    ],
    "stats": {
        "total": 68,
        "additions": 34,
        "deletions": 34
    }
}