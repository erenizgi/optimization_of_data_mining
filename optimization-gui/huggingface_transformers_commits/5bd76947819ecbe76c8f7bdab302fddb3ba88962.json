{
    "author": "zucchini-nlp",
    "message": "Processors: allow tuples of images when checking (#36084)\n\nallow tuples of images",
    "sha": "5bd76947819ecbe76c8f7bdab302fddb3ba88962",
    "files": [
        {
            "sha": "9502f1e9582970a37110b144319fd2a04cdbade1",
            "filename": "src/transformers/models/idefics2/processing_idefics2.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/5bd76947819ecbe76c8f7bdab302fddb3ba88962/src%2Ftransformers%2Fmodels%2Fidefics2%2Fprocessing_idefics2.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/5bd76947819ecbe76c8f7bdab302fddb3ba88962/src%2Ftransformers%2Fmodels%2Fidefics2%2Fprocessing_idefics2.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fidefics2%2Fprocessing_idefics2.py?ref=5bd76947819ecbe76c8f7bdab302fddb3ba88962",
            "patch": "@@ -221,7 +221,7 @@ def __call__(\n         if images is not None:\n             if is_image_or_image_url(images):\n                 images = [[images]]\n-            elif isinstance(images, list) and is_image_or_image_url(images[0]):\n+            elif isinstance(images, (list, tuple)) and is_image_or_image_url(images[0]):\n                 if text is not None:\n                     if sum(n_images_in_text) != len(images):\n                         raise ValueError(\n@@ -238,8 +238,8 @@ def __call__(\n                     images = [images]\n \n             elif (\n-                not isinstance(images, list)\n-                and not isinstance(images[0], list)\n+                not isinstance(images, (list, tuple))\n+                and not isinstance(images[0], (list, tuple))\n                 and not is_image_or_image_url(images[0][0])\n             ):\n                 raise ValueError("
        },
        {
            "sha": "06be2d0c03325afb0cac2a44b74edd049ac8a1d7",
            "filename": "src/transformers/models/idefics3/processing_idefics3.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/5bd76947819ecbe76c8f7bdab302fddb3ba88962/src%2Ftransformers%2Fmodels%2Fidefics3%2Fprocessing_idefics3.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/5bd76947819ecbe76c8f7bdab302fddb3ba88962/src%2Ftransformers%2Fmodels%2Fidefics3%2Fprocessing_idefics3.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fidefics3%2Fprocessing_idefics3.py?ref=5bd76947819ecbe76c8f7bdab302fddb3ba88962",
            "patch": "@@ -252,7 +252,7 @@ def __call__(\n         if images is not None:\n             if is_image_or_image_url(images):\n                 images = [[images]]\n-            elif isinstance(images, list) and is_image_or_image_url(images[0]):\n+            elif isinstance(images, (list, tuple)) and is_image_or_image_url(images[0]):\n                 if text is not None:\n                     if sum(n_images_in_text) != len(images):\n                         raise ValueError(\n@@ -268,8 +268,8 @@ def __call__(\n                 else:\n                     images = [images]\n             elif (\n-                not isinstance(images, list)\n-                and not isinstance(images[0], list)\n+                not isinstance(images, (list, tuple))\n+                and not isinstance(images[0], (list, tuple))\n                 and not is_image_or_image_url(images[0][0])\n             ):\n                 raise ValueError("
        },
        {
            "sha": "63ea785df19b33a31edbfe59370440c5f71f5bb9",
            "filename": "src/transformers/models/paligemma/processing_paligemma.py",
            "status": "modified",
            "additions": 2,
            "deletions": 8,
            "changes": 10,
            "blob_url": "https://github.com/huggingface/transformers/blob/5bd76947819ecbe76c8f7bdab302fddb3ba88962/src%2Ftransformers%2Fmodels%2Fpaligemma%2Fprocessing_paligemma.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/5bd76947819ecbe76c8f7bdab302fddb3ba88962/src%2Ftransformers%2Fmodels%2Fpaligemma%2Fprocessing_paligemma.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fpaligemma%2Fprocessing_paligemma.py?ref=5bd76947819ecbe76c8f7bdab302fddb3ba88962",
            "patch": "@@ -19,7 +19,7 @@\n from typing import List, Optional, Union\n \n from ...feature_extraction_utils import BatchFeature\n-from ...image_utils import ImageInput, is_valid_image, make_flat_list_of_images\n+from ...image_utils import ImageInput, is_valid_image, make_flat_list_of_images, make_nested_list_of_images\n from ...processing_utils import (\n     ImagesKwargs,\n     ProcessingKwargs,\n@@ -256,13 +256,7 @@ def __call__(\n                         )\n \n                 # make a nested list of lists to be able to iterate over the images and text below\n-                if is_valid_image(images):\n-                    images = [[images]]\n-                elif isinstance(images, list) and is_valid_image(images[0]):\n-                    images = [[image] for image in images]\n-                elif not (isinstance(images, list) and isinstance(images[0], list) and is_valid_image(images[0][0])):\n-                    raise ValueError(\"images must be an image, list of images or list of list of images\")\n-\n+                images = make_nested_list_of_images(images)\n                 input_strings = [\n                     build_string_from_input(\n                         prompt=prompt,"
        },
        {
            "sha": "d6130699fd736e44e39ee80d5ebef0c42e64496b",
            "filename": "src/transformers/models/pixtral/processing_pixtral.py",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/huggingface/transformers/blob/5bd76947819ecbe76c8f7bdab302fddb3ba88962/src%2Ftransformers%2Fmodels%2Fpixtral%2Fprocessing_pixtral.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/5bd76947819ecbe76c8f7bdab302fddb3ba88962/src%2Ftransformers%2Fmodels%2Fpixtral%2Fprocessing_pixtral.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fpixtral%2Fprocessing_pixtral.py?ref=5bd76947819ecbe76c8f7bdab302fddb3ba88962",
            "patch": "@@ -154,9 +154,13 @@ def __call__(\n         if images is not None:\n             if is_image_or_image_url(images):\n                 images = [images]\n-            elif isinstance(images, list) and is_image_or_image_url(images[0]):\n+            elif isinstance(images, (list, tuple)) and is_image_or_image_url(images[0]):\n                 pass\n-            elif isinstance(images, list) and isinstance(images[0], list) and is_image_or_image_url(images[0][0]):\n+            elif (\n+                isinstance(images, (list, tuple))\n+                and isinstance(images[0], (list, tuple))\n+                and is_image_or_image_url(images[0][0])\n+            ):\n                 images = [image for sublist in images for image in sublist]\n             else:\n                 raise ValueError("
        }
    ],
    "stats": {
        "total": 30,
        "additions": 14,
        "deletions": 16
    }
}