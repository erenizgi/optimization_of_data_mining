{
    "author": "orionw",
    "message": "Update modernbertdecoder docs (#39453)\n\n* update docs with paper and real model\n\n* nit\n\n* Apply suggestions from code review\r\n\r\nThanks to @stevhlui!\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Remove usage examples, add quantization\n\n---------\n\nCo-authored-by: oweller2 <oweller2@dsailogin.mgmt.ai.cluster>\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>",
    "sha": "641aaed7c0a77a9ad100d767f091b4f6a1ae5a2a",
    "files": [
        {
            "sha": "e5a681a46526b3e31be0e44efb9b02f9a58aec25",
            "filename": "docs/source/en/model_doc/modernbert-decoder.md",
            "status": "modified",
            "additions": 51,
            "deletions": 18,
            "changes": 69,
            "blob_url": "https://github.com/huggingface/transformers/blob/641aaed7c0a77a9ad100d767f091b4f6a1ae5a2a/docs%2Fsource%2Fen%2Fmodel_doc%2Fmodernbert-decoder.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/641aaed7c0a77a9ad100d767f091b4f6a1ae5a2a/docs%2Fsource%2Fen%2Fmodel_doc%2Fmodernbert-decoder.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmodernbert-decoder.md?ref=641aaed7c0a77a9ad100d767f091b4f6a1ae5a2a",
            "patch": "@@ -24,14 +24,18 @@ rendered properly in your Markdown viewer.\n \n # ModernBERT Decoder\n \n-ModernBERT Decoder is the same architecture as [ModernBERT](https://huggingface.co/papers/2412.13663) but trained from scratch with a causal language modeling (CLM) objective. This allows for using the same architecture for comparing encoders and decoders. This is the decoder architecture implementation of ModernBERT, designed for autoregressive text generation tasks.\n+ModernBERT Decoder has the same architecture as [ModernBERT](https://huggingface.co/papers/2412.13663) but it is trained from scratch with a causal language modeling objective from the [Ettin paper](https://huggingface.co/papers/2507.11412). This allows for using the same architecture to compare encoders and decoders. This model is the decoder architecture implementation of ModernBERT, designed for autoregressive text generation tasks.\n \n-Like the encoder version, ModernBERT Decoder incorporates modern architectural improvements such as rotary positional embeddings to support sequences of up to 8192 tokens, unpadding to avoid wasting compute on padding tokens, GeGLU layers, and alternating attention patterns. However, it uses causal (unidirectional) attention to enable autoregressive generation.\n+ModernBERT Decoder uses sliding window attention and rotary positional embeddings for efficiency and to handle longer sequences.\n+\n+You can find all the original ModernBERT Decoder checkpoints under the [jhu-clsp](https://huggingface.co/collections/jhu-clsp/encoders-vs-decoders-the-ettin-suite-686303e16142257eed8e6aeb) collection.\n \n > [!TIP]\n+> This model was contributed by [orionw](https://huggingface.co/orionweller).\n+>\n > Click on the ModernBERT Decoder models in the right sidebar for more examples of how to apply ModernBERT Decoder to different text generation tasks.\n \n-The example below demonstrates how to use ModernBERT Decoder for text generation with [`Pipeline`], [`AutoModel`], and from the command line.\n+The example below demonstrates how to use ModernBERT Decoder for text generation with [`Pipeline`], [`AutoModel`] (with and without quantization), and from the command line. \n \n <hfoptions id=\"usage\">\n <hfoption id=\"Pipeline\">\n@@ -42,7 +46,7 @@ from transformers import pipeline\n \n generator = pipeline(\n     task=\"text-generation\",\n-    model=\"blab-jhu/test-32m-dec\",\n+    model=\"jhu-clsp/ettin-decoder-17m\",\n     torch_dtype=torch.float16,\n     device=0\n )\n@@ -51,7 +55,7 @@ generator(\"The future of artificial intelligence is\", max_length=50, num_return_\n # For sequence classification\n classifier = pipeline(\n     task=\"text-classification\",\n-    model=\"blab-jhu/test-32m-dec\",\n+    model=\"jhu-clsp/ettin-decoder-17m\",\n     torch_dtype=torch.float16,\n     device=0\n )\n@@ -65,9 +69,9 @@ classifier(\"This movie is really great!\")\n import torch\n from transformers import AutoModelForCausalLM, AutoTokenizer\n \n-tokenizer = AutoTokenizer.from_pretrained(\"blab-jhu/test-32m-dec\")\n+tokenizer = AutoTokenizer.from_pretrained(\"jhu-clsp/ettin-decoder-17m\")\n model = AutoModelForCausalLM.from_pretrained(\n-    \"blab-jhu/test-32m-dec\",\n+    \"jhu-clsp/ettin-decoder-17m\",\n     torch_dtype=torch.float16,\n     device_map=\"auto\",\n )\n@@ -92,7 +96,7 @@ print(f\"Generated text: {generated_text}\")\n from transformers import AutoModelForSequenceClassification\n \n classifier_model = AutoModelForSequenceClassification.from_pretrained(\n-    \"blab-jhu/test-32m-dec\",\n+    \"jhu-clsp/ettin-decoder-17m\",\n     torch_dtype=torch.float16,\n     device_map=\"auto\",\n     num_labels=2\n@@ -111,15 +115,53 @@ print(f\"Prediction probabilities: {predictions}\")\n ```\n \n </hfoption>\n+\n+<hfoption id=\"AutoModel (w/quantization)\">\n+\n+```\n+import torch\n+from transformers import AutoModelForCausalLM, AutoTokenizer, BitsAndBytesConfig\n+\n+quantization_config = BitsAndBytesConfig(\n+    load_in_8bit=True,\n+)\n+\n+tokenizer = AutoTokenizer.from_pretrained(\"jhu-clsp/ettin-decoder-1b\")\n+model = AutoModelForCausalLM.from_pretrained(\n+    \"jhu-clsp/ettin-decoder-1b\",\n+    torch_dtype=torch.float16,\n+    device_map=\"auto\",\n+    quantization_config=quantization_config\n+)\n+\n+prompt = \"The future of artificial intelligence is\"\n+inputs = tokenizer(prompt, return_tensors=\"pt\").to(\"cuda\")\n+\n+with torch.no_grad():\n+    outputs = model.generate(\n+        **inputs,\n+        max_length=50,\n+        num_return_sequences=1,\n+        temperature=0.7,\n+        do_sample=True,\n+        pad_token_id=tokenizer.eos_token_id\n+    )\n+\n+generated_text = tokenizer.decode(outputs[0], skip_special_tokens=True)\n+print(f\"Generated text: {generated_text}\")\n+```\n+</hfoption>\n+\n <hfoption id=\"transformers CLI\">\n \n ```bash\n-echo \"The future of artificial intelligence is\" | transformers run --task text-generation --model your-username/modernbert-decoder-base --device 0\n+echo \"The future of artificial intelligence is\" | transformers run --task text-generation --model jhu-clsp/ettin-decoder-17m --device 0\n ```\n \n </hfoption>\n </hfoptions>\n \n+\n ## ModernBertDecoderConfig\n \n [[autodoc]] ModernBertDecoderConfig\n@@ -142,14 +184,5 @@ echo \"The future of artificial intelligence is\" | transformers run --task text-g\n [[autodoc]] ModernBertDecoderForSequenceClassification\n     - forward\n \n-### Usage tips\n-\n-The ModernBertDecoder model can be fine-tuned for various text generation tasks using the HuggingFace Transformers library. It supports efficient inference with features like:\n-\n-- **Causal attention**: Ensures autoregressive generation by masking future tokens\n-- **Sliding window attention**: Alternates between local and global attention patterns for efficiency\n-- **Rotary positional embeddings**: Enables handling of longer sequences up to 8000 tokens\n-- **FlashAttention support**: Optimized attention computation for faster training and inference\n-\n </pt>\n </frameworkcontent>"
        }
    ],
    "stats": {
        "total": 69,
        "additions": 51,
        "deletions": 18
    }
}