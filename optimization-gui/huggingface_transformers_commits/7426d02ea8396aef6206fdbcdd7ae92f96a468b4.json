{
    "author": "Zebz13",
    "message": "Fixing typo in gemma3 image_processor_fast and adding a small test (#36776)\n\nCo-authored-by: zebz13 <zeb@fedora>\nCo-authored-by: Yih-Dar <2521628+ydshieh@users.noreply.github.com>",
    "sha": "7426d02ea8396aef6206fdbcdd7ae92f96a468b4",
    "files": [
        {
            "sha": "47a676ce2a5d941dfacad5bdd7f1c67766be9c85",
            "filename": "src/transformers/models/gemma3/image_processing_gemma3_fast.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/7426d02ea8396aef6206fdbcdd7ae92f96a468b4/src%2Ftransformers%2Fmodels%2Fgemma3%2Fimage_processing_gemma3_fast.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/7426d02ea8396aef6206fdbcdd7ae92f96a468b4/src%2Ftransformers%2Fmodels%2Fgemma3%2Fimage_processing_gemma3_fast.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fgemma3%2Fimage_processing_gemma3_fast.py?ref=7426d02ea8396aef6206fdbcdd7ae92f96a468b4",
            "patch": "@@ -277,17 +277,17 @@ def _preprocess(\n         processed_images = []\n         batch_num_crops = []\n \n-        for image_list in images:\n+        for images_list in images:\n             if do_pan_and_scan:\n                 images_list, num_crops = self._process_images_for_pan_and_scan(\n-                    images=image_list,\n+                    images=images_list,\n                     do_pan_and_scan=do_pan_and_scan,\n                     pan_and_scan_min_crop_size=pan_and_scan_min_crop_size,\n                     pan_and_scan_max_num_crops=pan_and_scan_max_num_crops,\n                     pan_and_scan_min_ratio_to_activate=pan_and_scan_min_ratio_to_activate,\n                 )\n             else:\n-                num_crops = [[0] for images in images_list]\n+                num_crops = [[0] for _ in images_list]\n \n             # Group images by size for batched processing\n             processed_image_patches_grouped = {}"
        },
        {
            "sha": "895c04c668f06aa430afc5cd340a4e7e44e68cf7",
            "filename": "tests/models/gemma3/test_image_processing_gemma3.py",
            "status": "modified",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/huggingface/transformers/blob/7426d02ea8396aef6206fdbcdd7ae92f96a468b4/tests%2Fmodels%2Fgemma3%2Ftest_image_processing_gemma3.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/7426d02ea8396aef6206fdbcdd7ae92f96a468b4/tests%2Fmodels%2Fgemma3%2Ftest_image_processing_gemma3.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Fmodels%2Fgemma3%2Ftest_image_processing_gemma3.py?ref=7426d02ea8396aef6206fdbcdd7ae92f96a468b4",
            "patch": "@@ -143,6 +143,29 @@ def test_image_processor_from_dict_with_kwargs(self):\n             image_processor = image_processing_class.from_dict(self.image_processor_dict, size=84)\n             self.assertEqual(image_processor.size, {\"height\": 84, \"width\": 84})\n \n+    def test_without_pan_and_scan(self):\n+        \"\"\"\n+        Disable do_pan_and_scan parameter.\n+        \"\"\"\n+        for image_processing_class in self.image_processor_list:\n+            # Initialize image_processing\n+            image_processor = image_processing_class.from_dict(self.image_processor_dict, do_pan_and_scan=False)\n+\n+            # create random PIL images\n+            image_inputs = self.image_processor_tester.prepare_image_inputs(equal_resolution=True)\n+            for image in image_inputs:\n+                self.assertIsInstance(image, Image.Image)\n+\n+            # Test not batched input\n+            encoded_images = image_processor(image_inputs[0], return_tensors=\"pt\").pixel_values\n+            expected_output_image_shape = (1, 3, 18, 18)\n+            self.assertEqual(tuple(encoded_images.shape), expected_output_image_shape)\n+\n+            # Test batched\n+            encoded_images = image_processor(image_inputs, return_tensors=\"pt\").pixel_values\n+            expected_output_image_shape = (7, 3, 18, 18)\n+            self.assertEqual(tuple(encoded_images.shape), expected_output_image_shape)\n+\n     def test_pan_and_scan(self):\n         \"\"\"\n         Enables Pan and Scan path by choosing the correct input image resolution. If you are changing"
        }
    ],
    "stats": {
        "total": 29,
        "additions": 26,
        "deletions": 3
    }
}