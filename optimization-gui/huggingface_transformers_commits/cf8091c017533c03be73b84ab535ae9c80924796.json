{
    "author": "qubvel",
    "message": "Fix import for torch 2.0, 2.1 - guard typehint for \"device_mesh\"  (#36768)\n\n* Fix device_mesh\n\n* Remove rebase leftover",
    "sha": "cf8091c017533c03be73b84ab535ae9c80924796",
    "files": [
        {
            "sha": "c4e8a960af97fea5edc62473d469a591424d04a2",
            "filename": "src/transformers/modeling_utils.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/cf8091c017533c03be73b84ab535ae9c80924796/src%2Ftransformers%2Fmodeling_utils.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/cf8091c017533c03be73b84ab535ae9c80924796/src%2Ftransformers%2Fmodeling_utils.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodeling_utils.py?ref=cf8091c017533c03be73b84ab535ae9c80924796",
            "patch": "@@ -755,7 +755,7 @@ def _load_state_dict_into_meta_model(\n     is_safetensors: bool = False,\n     keep_in_fp32_modules: Optional[List[str]] = None,\n     unexpected_keys: Optional[List[str]] = None,  # passing `unexpected` for cleanup from quantization items\n-    device_mesh: Optional[torch.distributed.device_mesh.DeviceMesh] = None,\n+    device_mesh: Optional[\"torch.distributed.device_mesh.DeviceMesh\"] = None,\n ) -> Tuple[Optional[Dict], Optional[Dict]]:\n     \"\"\"Load parameters from `meta_state_dict` into the model. The parameters of the `meta_state_dict` are on the meta\n     device in order to easily infer the shapes and dtypes that they will have. Then proper parameters are then loaded\n@@ -4665,7 +4665,7 @@ def _load_pretrained_model(\n         dtype: Optional[torch.dtype] = None,\n         hf_quantizer: Optional[HfQuantizer] = None,\n         keep_in_fp32_modules: Optional[List[str]] = None,\n-        device_mesh: Optional[torch.distributed.device_mesh.DeviceMesh] = None,\n+        device_mesh: Optional[\"torch.distributed.device_mesh.DeviceMesh\"] = None,\n         key_mapping: Optional[Dict[str, str]] = None,\n         weights_only: bool = True,\n         _fast_init: bool = True,"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    }
}