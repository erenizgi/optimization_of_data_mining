{
    "author": "ivarflakstad",
    "message": "Fix collated reports model directory traversal (#40437)\n\nFix model dir traversal",
    "sha": "f0e87b436d8bd4dd4225da235ac8f988d4bbe845",
    "files": [
        {
            "sha": "1caf53634ffcc1bff3a397620a4707c68d69889b",
            "filename": "utils/collated_reports.py",
            "status": "modified",
            "additions": 5,
            "deletions": 9,
            "changes": 14,
            "blob_url": "https://github.com/huggingface/transformers/blob/f0e87b436d8bd4dd4225da235ac8f988d4bbe845/utils%2Fcollated_reports.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/f0e87b436d8bd4dd4225da235ac8f988d4bbe845/utils%2Fcollated_reports.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/utils%2Fcollated_reports.py?ref=f0e87b436d8bd4dd4225da235ac8f988d4bbe845",
            "patch": "@@ -166,17 +166,13 @@ def upload_collated_report(job: str, report_repo_id: str, filename: str):\n     job = args.job\n     report_repo_id = args.report_repo_id\n \n-    # Find the origin directory based on machine type\n-    origin = path\n-    for p in path.iterdir():\n-        if machine_type in p.name:\n-            origin = p\n-            break\n-\n     # Loop through model directories and create collated reports\n-    for model_dir in sorted(origin.iterdir()):\n+    for model_dir in sorted(path.iterdir()):\n+        if not model_dir.name.startswith(machine_type):\n+            continue\n+\n         # Create a new entry for the model\n-        model_name = model_dir.name.removesuffix(\"_test_reports\")\n+        model_name = model_dir.name.removeprefix(machine_type).removesuffix(\"_test_reports\")\n         report = {\"model\": model_name, \"results\": []}\n         results = []\n "
        }
    ],
    "stats": {
        "total": 14,
        "additions": 5,
        "deletions": 9
    }
}