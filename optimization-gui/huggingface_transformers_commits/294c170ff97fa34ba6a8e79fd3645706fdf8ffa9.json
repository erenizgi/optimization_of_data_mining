{
    "author": "McPatate",
    "message": "feat: add benchmarks pg indexes (#34536)\n\n* feat: add benchmarks pg indexes\r\n\r\n* refactor: remove debug `df -h`",
    "sha": "294c170ff97fa34ba6a8e79fd3645706fdf8ffa9",
    "files": [
        {
            "sha": "eaa4b3b2f824569e9a6e9d44d3edd933cd9c49dc",
            "filename": ".github/workflows/benchmark.yml",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/huggingface/transformers/blob/294c170ff97fa34ba6a8e79fd3645706fdf8ffa9/.github%2Fworkflows%2Fbenchmark.yml",
            "raw_url": "https://github.com/huggingface/transformers/raw/294c170ff97fa34ba6a8e79fd3645706fdf8ffa9/.github%2Fworkflows%2Fbenchmark.yml",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fworkflows%2Fbenchmark.yml?ref=294c170ff97fa34ba6a8e79fd3645706fdf8ffa9",
            "patch": "@@ -63,7 +63,6 @@ jobs:\n             commit_id=$GITHUB_SHA\r\n           fi\r\n           commit_msg=$(git show -s --format=%s | cut -c1-70)\r\n-          df -h\r\n           python3 benchmark/llama.py \"${{ github.head_ref || github.ref_name }}\" \"$commit_id\" \"$commit_msg\"\r\n         env:\r\n           HF_TOKEN: ${{ secrets.HF_HUB_READ_TOKEN }}\r"
        },
        {
            "sha": "573cc11518e8576d97248eea41fb370a6113db66",
            "filename": "benchmark/init_db.sql",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/huggingface/transformers/blob/294c170ff97fa34ba6a8e79fd3645706fdf8ffa9/benchmark%2Finit_db.sql",
            "raw_url": "https://github.com/huggingface/transformers/raw/294c170ff97fa34ba6a8e79fd3645706fdf8ffa9/benchmark%2Finit_db.sql",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/benchmark%2Finit_db.sql?ref=294c170ff97fa34ba6a8e79fd3645706fdf8ffa9",
            "patch": "@@ -7,6 +7,10 @@ CREATE TABLE IF NOT EXISTS benchmarks (\n   created_at timestamp without time zone NOT NULL DEFAULT (current_timestamp AT TIME ZONE 'UTC')\n );\n \n+CREATE INDEX IF NOT EXISTS benchmarks_benchmark_id_idx ON benchmarks (benchmark_id);\n+\n+CREATE INDEX IF NOT EXISTS benchmarks_branch_idx ON benchmarks (branch);\n+\n CREATE TABLE IF NOT EXISTS device_measurements (\n   measurement_id SERIAL PRIMARY KEY,\n   benchmark_id int REFERENCES benchmarks (benchmark_id),\n@@ -17,10 +21,13 @@ CREATE TABLE IF NOT EXISTS device_measurements (\n   time timestamp without time zone NOT NULL DEFAULT (current_timestamp AT TIME ZONE 'UTC')\n );\n \n+CREATE INDEX IF NOT EXISTS device_measurements_branch_idx ON device_measurements (benchmark_id);\n+\n CREATE TABLE IF NOT EXISTS model_measurements (\n   measurement_id SERIAL PRIMARY KEY,\n   benchmark_id int REFERENCES benchmarks (benchmark_id),\n   measurements jsonb,\n   time timestamp without time zone NOT NULL DEFAULT (current_timestamp AT TIME ZONE 'UTC')\n );\n \n+CREATE INDEX IF NOT EXISTS model_measurements_branch_idx ON model_measurements (benchmark_id);"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 7,
        "deletions": 1
    }
}