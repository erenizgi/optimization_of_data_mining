{
    "author": "xenova",
    "message": "[vjepa2] replace einsum with unsqueeze (#39234)",
    "sha": "b283d52f7f89d9cf3c77cfef233c4cbf700959ff",
    "files": [
        {
            "sha": "c05ebd74483b940b5c80aace31a479dbd5877df2",
            "filename": "src/transformers/models/vjepa2/modeling_vjepa2.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/b283d52f7f89d9cf3c77cfef233c4cbf700959ff/src%2Ftransformers%2Fmodels%2Fvjepa2%2Fmodeling_vjepa2.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/b283d52f7f89d9cf3c77cfef233c4cbf700959ff/src%2Ftransformers%2Fmodels%2Fvjepa2%2Fmodeling_vjepa2.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fvjepa2%2Fmodeling_vjepa2.py?ref=b283d52f7f89d9cf3c77cfef233c4cbf700959ff",
            "patch": "@@ -187,7 +187,7 @@ def rotate_queries_or_keys(x, pos):\n     omega = torch.arange(D // 2, dtype=x.dtype, device=x.device)\n     omega /= D / 2.0\n     omega = 1.0 / 10000**omega  # (D/2,)\n-    freq = torch.einsum(\"..., f -> ... f\", pos, omega)  # (..., N, D/2), outer product\n+    freq = pos.unsqueeze(-1) * omega  # (..., N, D/2), outer product\n \n     # -- build rotation matrix and apply\n     emb_sin = freq.sin()  # (..., N, D/2)"
        }
    ],
    "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    }
}