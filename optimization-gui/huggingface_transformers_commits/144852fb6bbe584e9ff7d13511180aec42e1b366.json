{
    "author": "McPatate",
    "message": "refactor: benchmarks (#33896)\n\n* refactor: benchmarks\r\n\r\nBased on a discussion with @LysandreJik & @ArthurZucker, the goal of\r\nthis PR is to improve transformers' benchmark system.\r\n\r\nThis is a WIP, for the moment the infrastructure required to make things\r\nwork is not ready. Will update the PR description when it is the case.\r\n\r\n* feat: add db init in benchmarks CI\r\n\r\n* fix: pg_config is missing in runner\r\n\r\n* fix: add psql to the runner\r\n\r\n* fix: connect info from env vars + PR comments\r\n\r\n* refactor: set database as env var\r\n\r\n* fix: invalid working directory\r\n\r\n* fix: `commit_msg` -> `commit_message`\r\n\r\n* fix: git marking checked out repo as unsafe\r\n\r\n* feat: add logging\r\n\r\n* fix: invalid device\r\n\r\n* feat: update grafana dashboard for prod grafana\r\n\r\n* feat: add `commit_id` to header table\r\n\r\n* feat: commit latest version of dashboard\r\n\r\n* feat: move measurements into json field\r\n\r\n* feat: remove drop table migration queries\r\n\r\n* fix: `torch.arrange` -> `torch.arange`\r\n\r\n* fix: add missing `s` to `cache_position` positional argument\r\n\r\n* fix: change model\r\n\r\n* revert: `cache_positions` -> `cache_position`\r\n\r\n* fix: set device for `StaticCache`\r\n\r\n* fix: set `StaticCache` dtype\r\n\r\n* feat: limit max cache len\r\n\r\n* fix script\r\n\r\n* raise error on failure!\r\n\r\n* not try catch\r\n\r\n* try to skip generate compilation\r\n\r\n* update\r\n\r\n* update docker image!\r\n\r\n* update\r\n\r\n* update again!@\r\n\r\n* update\r\n\r\n* updates\r\n\r\n* ???\r\n\r\n* ??\r\n\r\n* use `torch.cuda.synchronize()`\r\n\r\n* fix json\r\n\r\n* nits\r\n\r\n* fix\r\n\r\n* fixed!\r\n\r\n* f**k\r\n\r\n* feat: add TTNT panels\r\n\r\n* feat: add try except\r\n\r\n---------\r\n\r\nCo-authored-by: Arthur Zucker <arthur.zucker@gmail.com>",
    "sha": "144852fb6bbe584e9ff7d13511180aec42e1b366",
    "files": [
        {
            "sha": "c264dfe462aae7344a6ba10a12bca264c439dd6a",
            "filename": ".github/workflows/benchmark.yml",
            "status": "modified",
            "additions": 51,
            "deletions": 22,
            "changes": 73,
            "blob_url": "https://github.com/huggingface/transformers/blob/144852fb6bbe584e9ff7d13511180aec42e1b366/.github%2Fworkflows%2Fbenchmark.yml",
            "raw_url": "https://github.com/huggingface/transformers/raw/144852fb6bbe584e9ff7d13511180aec42e1b366/.github%2Fworkflows%2Fbenchmark.yml",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fworkflows%2Fbenchmark.yml?ref=144852fb6bbe584e9ff7d13511180aec42e1b366",
            "patch": "@@ -1,43 +1,72 @@\n name: Self-hosted runner (benchmark)\r\n \r\n on:\r\n-  schedule:\r\n-    - cron: \"17 2 * * *\"\r\n-  workflow_call:\r\n+  push:\r\n+    branches: [main]\r\n+  pull_request:\r\n+    types: [ opened, labeled, reopened, synchronize ]\r\n+\r\n+concurrency:\r\n+  group: ${{ github.workflow }}-${{ github.head_ref || github.run_id }}\r\n+  cancel-in-progress: true\r\n \r\n env:\r\n   HF_HOME: /mnt/cache\r\n-  TF_FORCE_GPU_ALLOW_GROWTH: true\r\n-\r\n \r\n jobs:\r\n   benchmark:\r\n     name: Benchmark\r\n-    runs-on: \r\n+    runs-on:\r\n       group: aws-g5-4xlarge-cache\r\n     container:\r\n-      image: huggingface/transformers-all-latest-gpu\r\n-      options: --gpus all --privileged --ipc host -v /mnt/cache/.cache/huggingface:/mnt/cache/\r\n+      image: huggingface/transformers-pytorch-gpu\r\n+      options: --gpus all --privileged --ipc host\r\n     steps:\r\n-      - name: Update clone\r\n-        working-directory: /transformers\r\n+      - name: Get repo\r\n+        if: github.event_name == 'pull_request'\r\n+        uses: actions/checkout@v4\r\n+        with:\r\n+          ref: ${{ github.event.pull_request.head.sha }}\r\n+\r\n+      - name: Get repo\r\n+        if: github.event_name == 'push'\r\n+        uses: actions/checkout@v4\r\n+        with:\r\n+          ref: ${{ github.sha }}\r\n+\r\n+      - name: Install libpq-dev & psql\r\n         run: |\r\n-          git fetch && git checkout ${{ github.sha }}\r\n+          apt update\r\n+          apt install -y libpq-dev postgresql-client\r\n+\r\n+      - name: Install benchmark script dependencies\r\n+        run: python3 -m pip install -r benchmark/requirements.txt\r\n \r\n       - name: Reinstall transformers in edit mode (remove the one installed during docker image build)\r\n         working-directory: /transformers\r\n-        run: python3 -m pip uninstall -y transformers && python3 -m pip install -e .\r\n+        run: python3 -m pip uninstall -y transformers && python3 -m pip install -e \".[torch]\"\r\n \r\n-      - name: Benchmark (daily)\r\n-        if: github.event_name == 'schedule'\r\n-        working-directory: /transformers\r\n+      - name: Run database init script\r\n         run: |\r\n-          python3 -m pip install optimum-benchmark>=0.3.0\r\n-          HF_TOKEN=${{ secrets.TRANSFORMERS_BENCHMARK_TOKEN }} python3 benchmark/benchmark.py --repo_id hf-internal-testing/benchmark_results --path_in_repo $(date +'%Y-%m-%d') --config-dir benchmark/config --config-name generation --commit=${{ github.sha }} backend.model=google/gemma-2b backend.cache_implementation=null,static backend.torch_compile=false,true --multirun\r\n+          psql -f benchmark/init_db.sql\r\n+        env:\r\n+          PGDATABASE: metrics\r\n+          PGHOST: ${{ secrets.TRANSFORMERS_BENCHMARKS_PGHOST }}\r\n+          PGUSER: transformers_benchmarks\r\n+          PGPASSWORD: ${{ secrets.TRANSFORMERS_BENCHMARKS_PGPASSWORD }}\r\n \r\n-      - name: Benchmark (merged to main event)\r\n-        if: github.event_name == 'push' && github.ref_name == 'main'\r\n-        working-directory: /transformers\r\n+      - name: Run benchmark\r\n         run: |\r\n-          python3 -m pip install optimum-benchmark>=0.3.0\r\n-          HF_TOKEN=${{ secrets.TRANSFORMERS_BENCHMARK_TOKEN }} python3 benchmark/benchmark.py --repo_id hf-internal-testing/benchmark_results_merge_event --path_in_repo $(date +'%Y-%m-%d') --config-dir benchmark/config --config-name generation --commit=${{ github.sha }} backend.model=google/gemma-2b backend.cache_implementation=null,static backend.torch_compile=false,true --multirun\r\n+          git config --global --add safe.directory /__w/transformers/transformers\r\n+          if [ \"$GITHUB_EVENT_NAME\" = \"pull_request\" ]; then\r\n+            commit_id=$(echo \"${{ github.event.pull_request.head.sha }}\")\r\n+          elif [ \"$GITHUB_EVENT_NAME\" = \"push\" ]; then\r\n+            commit_id=$GITHUB_SHA\r\n+          fi\r\n+          commit_msg=$(git show -s --format=%s | cut -c1-70)\r\n+          python3 benchmark/llama.py \"${{ github.head_ref || github.ref_name }}\" \"$commit_id\" \"$commit_msg\"\r\n+        env:\r\n+          HF_TOKEN: ${{ secrets.HF_HUB_READ_TOKEN }}\r\n+          PGHOST: ${{ secrets.TRANSFORMERS_BENCHMARKS_PGHOST }}\r\n+          PGUSER: transformers_benchmarks\r\n+          PGPASSWORD: ${{ secrets.TRANSFORMERS_BENCHMARKS_PGPASSWORD }}\r"
        },
        {
            "sha": "be471a6314ecc743ebe396b1f308fb0f76ef4368",
            "filename": "benchmark/grafana_dashboard.json",
            "status": "added",
            "additions": 2211,
            "deletions": 0,
            "changes": 2211,
            "blob_url": "https://github.com/huggingface/transformers/blob/144852fb6bbe584e9ff7d13511180aec42e1b366/benchmark%2Fgrafana_dashboard.json",
            "raw_url": "https://github.com/huggingface/transformers/raw/144852fb6bbe584e9ff7d13511180aec42e1b366/benchmark%2Fgrafana_dashboard.json",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/benchmark%2Fgrafana_dashboard.json?ref=144852fb6bbe584e9ff7d13511180aec42e1b366",
            "patch": "@@ -0,0 +1,2211 @@\n+{\n+  \"annotations\": {\n+    \"list\": [\n+      {\n+        \"builtIn\": 1,\n+        \"datasource\": {\n+          \"type\": \"grafana\",\n+          \"uid\": \"-- Grafana --\"\n+        },\n+        \"enable\": true,\n+        \"hide\": true,\n+        \"iconColor\": \"rgba(0, 211, 255, 1)\",\n+        \"name\": \"Annotations & Alerts\",\n+        \"type\": \"dashboard\"\n+      }\n+    ]\n+  },\n+  \"editable\": true,\n+  \"fiscalYearStartMonth\": 0,\n+  \"graphTooltip\": 0,\n+  \"id\": 1,\n+  \"links\": [\n+    {\n+      \"asDropdown\": false,\n+      \"icon\": \"external link\",\n+      \"includeVars\": false,\n+      \"keepTime\": false,\n+      \"tags\": [],\n+      \"targetBlank\": false,\n+      \"title\": \"Go to data\",\n+      \"tooltip\": \"Go to data\",\n+      \"type\": \"link\",\n+      \"url\": \"http://transformers-benchmarks.huggingface.co/d/fdz33iyzln9c0a/transformers-benchmarks?orgId=1&from=${StartTime}&to=${EndTime}\"\n+    }\n+  ],\n+  \"liveNow\": true,\n+  \"panels\": [\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"thresholds\"\n+          },\n+          \"custom\": {\n+            \"align\": \"left\",\n+            \"cellOptions\": {\n+              \"type\": \"auto\"\n+            },\n+            \"inspect\": false\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              },\n+              {\n+                \"color\": \"red\",\n+                \"value\": 80\n+              }\n+            ]\n+          }\n+        },\n+        \"overrides\": [\n+          {\n+            \"matcher\": {\n+              \"id\": \"byName\",\n+              \"options\": \"gpu_name\"\n+            },\n+            \"properties\": [\n+              {\n+                \"id\": \"custom.width\",\n+                \"value\": 364\n+              }\n+            ]\n+          },\n+          {\n+            \"matcher\": {\n+              \"id\": \"byName\",\n+              \"options\": \"left\"\n+            },\n+            \"properties\": [\n+              {\n+                \"id\": \"custom.width\",\n+                \"value\": 407\n+              }\n+            ]\n+          },\n+          {\n+            \"matcher\": {\n+              \"id\": \"byName\",\n+              \"options\": \"commit_message\"\n+            },\n+            \"properties\": [\n+              {\n+                \"id\": \"custom.width\",\n+                \"value\": 708\n+              }\n+            ]\n+          },\n+          {\n+            \"matcher\": {\n+              \"id\": \"byName\",\n+              \"options\": \"commit_id\"\n+            },\n+            \"properties\": [\n+              {\n+                \"id\": \"custom.width\",\n+                \"value\": 388\n+              }\n+            ]\n+          }\n+        ]\n+      },\n+      \"gridPos\": {\n+        \"h\": 6,\n+        \"w\": 24,\n+        \"x\": 0,\n+        \"y\": 0\n+      },\n+      \"id\": 5,\n+      \"options\": {\n+        \"cellHeight\": \"sm\",\n+        \"footer\": {\n+          \"countRows\": false,\n+          \"fields\": \"\",\n+          \"reducer\": [\n+            \"sum\"\n+          ],\n+          \"show\": false\n+        },\n+        \"showHeader\": true,\n+        \"sortBy\": []\n+      },\n+      \"pluginVersion\": \"11.2.2\",\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT commit_id as commit_id, commit_message, gpu_name FROM benchmarks WHERE branch = ${branch};\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"commit_id\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"gpu_name\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50,\n+            \"whereJsonTree\": {\n+              \"children1\": [\n+                {\n+                  \"id\": \"baaa8aaa-89ab-4cde-b012-31922f96de3f\",\n+                  \"properties\": {\n+                    \"field\": \"commit_id\",\n+                    \"fieldSrc\": \"field\",\n+                    \"operator\": \"equal\",\n+                    \"value\": [\n+                      \"${commit}\"\n+                    ],\n+                    \"valueError\": [\n+                      null\n+                    ],\n+                    \"valueSrc\": [\n+                      \"value\"\n+                    ],\n+                    \"valueType\": [\n+                      \"text\"\n+                    ]\n+                  },\n+                  \"type\": \"rule\"\n+                }\n+              ],\n+              \"id\": \"bab88a98-0123-4456-b89a-b1922f7d4f11\",\n+              \"type\": \"group\"\n+            },\n+            \"whereString\": \"commit_id = '${commit}'\"\n+          },\n+          \"table\": \"benchmarks\"\n+        }\n+      ],\n+      \"transparent\": true,\n+      \"type\": \"table\"\n+    },\n+    {\n+      \"collapsed\": false,\n+      \"gridPos\": {\n+        \"h\": 1,\n+        \"w\": 24,\n+        \"x\": 0,\n+        \"y\": 6\n+      },\n+      \"id\": 13,\n+      \"panels\": [],\n+      \"title\": \"Eager Forward Pass\",\n+      \"type\": \"row\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"scheme\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 0,\n+        \"y\": 7\n+      },\n+      \"id\": 7,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.3,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"auto\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"pluginVersion\": \"11.2.2\",\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'first_eager_forward_pass_time_secs' AS double precision) AS first_eager_forward_pass_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"First eager forward pass\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"scheme\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              },\n+              {\n+                \"color\": \"red\",\n+                \"value\": 80\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 12,\n+        \"y\": 7\n+      },\n+      \"id\": 9,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.8,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"auto\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'second_eager_forward_pass_time_secs' AS double precision) AS second_eager_forward_pass_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"Second eager forward pass\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"collapsed\": false,\n+      \"gridPos\": {\n+        \"h\": 1,\n+        \"w\": 24,\n+        \"x\": 0,\n+        \"y\": 18\n+      },\n+      \"id\": 16,\n+      \"panels\": [],\n+      \"title\": \"Time to next token\",\n+      \"type\": \"row\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"scheme\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 0,\n+        \"y\": 19\n+      },\n+      \"id\": 17,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.8,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"always\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_first_token_secs' AS double precision) AS time_to_first_token_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"Time to first token\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"scheme\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 12,\n+        \"y\": 19\n+      },\n+      \"id\": 18,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.8,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"always\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_second_token_secs' AS double precision) AS time_to_second_token_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"Time to second token\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"scheme\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 0,\n+        \"y\": 30\n+      },\n+      \"id\": 19,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.8,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"always\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_third_token_secs' AS double precision) AS time_to_third_token_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"Time to third token\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"scheme\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 12,\n+        \"y\": 30\n+      },\n+      \"id\": 20,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.8,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"always\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'time_to_next_token_mean_secs' AS double precision) AS time_to_next_token_mean_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"Time to subsequent next tokens mean\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"collapsed\": false,\n+      \"gridPos\": {\n+        \"h\": 1,\n+        \"w\": 24,\n+        \"x\": 0,\n+        \"y\": 41\n+      },\n+      \"id\": 14,\n+      \"panels\": [],\n+      \"title\": \"Compiled Generate\",\n+      \"type\": \"row\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"scheme\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 0,\n+        \"y\": 42\n+      },\n+      \"id\": 8,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.8,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"always\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'first_compile_generate_time_secs' AS double precision) AS first_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}'\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"First compile generate\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"scheme\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 12,\n+        \"y\": 42\n+      },\n+      \"id\": 10,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.8,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"auto\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'second_compile_generate_time_secs' AS double precision) AS second_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}';\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"Second compile generate\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"scheme\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 0,\n+        \"y\": 53\n+      },\n+      \"id\": 11,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.8,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"auto\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'third_compile_generate_time_secs' AS double precision) AS third_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}';\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"Third compile generate\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"continuous-YlBl\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"fillOpacity\": 80,\n+            \"gradientMode\": \"none\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"lineWidth\": 0,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              }\n+            ]\n+          },\n+          \"unit\": \"s\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 11,\n+        \"w\": 12,\n+        \"x\": 12,\n+        \"y\": 53\n+      },\n+      \"id\": 12,\n+      \"options\": {\n+        \"barRadius\": 0.05,\n+        \"barWidth\": 0.8,\n+        \"fullHighlight\": false,\n+        \"groupWidth\": 0.7,\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": false\n+        },\n+        \"orientation\": \"auto\",\n+        \"showValue\": \"auto\",\n+        \"stacking\": \"none\",\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        },\n+        \"xTickLabelRotation\": 0,\n+        \"xTickLabelSpacing\": 0\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT CAST(m.measurements->'fourth_compile_generate_time_secs' AS double precision) AS fourth_compile_generate_time_secs, left(b.commit_id, 7), m.time FROM benchmarks as b JOIN model_measurements AS m ON b.benchmark_id = m.benchmark_id WHERE b.branch = ${branch} AND gpu_name = '${gpu_name}';\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50\n+          }\n+        }\n+      ],\n+      \"title\": \"Fourth compile generate\",\n+      \"transparent\": true,\n+      \"type\": \"barchart\"\n+    },\n+    {\n+      \"collapsed\": false,\n+      \"gridPos\": {\n+        \"h\": 1,\n+        \"w\": 24,\n+        \"x\": 0,\n+        \"y\": 64\n+      },\n+      \"id\": 15,\n+      \"panels\": [],\n+      \"title\": \"Usage metrics\",\n+      \"type\": \"row\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"palette-classic\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"barAlignment\": 0,\n+            \"barWidthFactor\": 0.6,\n+            \"drawStyle\": \"line\",\n+            \"fillOpacity\": 0,\n+            \"gradientMode\": \"none\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"insertNulls\": 60000,\n+            \"lineInterpolation\": \"linear\",\n+            \"lineWidth\": 1,\n+            \"pointSize\": 5,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"showPoints\": \"auto\",\n+            \"spanNulls\": false,\n+            \"stacking\": {\n+              \"group\": \"A\",\n+              \"mode\": \"none\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              },\n+              {\n+                \"color\": \"red\",\n+                \"value\": 80\n+              }\n+            ]\n+          },\n+          \"unit\": \"percent\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 9,\n+        \"w\": 12,\n+        \"x\": 0,\n+        \"y\": 65\n+      },\n+      \"id\": 1,\n+      \"options\": {\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": true\n+        },\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        }\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT\\n  d.cpu_util,\\n  d.time\\nFROM\\n  benchmarks AS b\\n  JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id\\nWHERE\\n  branch = ${branch}\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"cpu_util\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"mem_megabytes\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"gpu_util\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"gpu_mem_megabytes\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"\\\"time\\\"\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50,\n+            \"whereJsonTree\": {\n+              \"children1\": [\n+                {\n+                  \"id\": \"baa888b8-89ab-4cde-b012-31922f8671e9\",\n+                  \"properties\": {\n+                    \"field\": \"commit_id\",\n+                    \"fieldSrc\": \"field\",\n+                    \"operator\": \"equal\",\n+                    \"value\": [\n+                      \"${commit}\"\n+                    ],\n+                    \"valueError\": [\n+                      null\n+                    ],\n+                    \"valueSrc\": [\n+                      \"value\"\n+                    ],\n+                    \"valueType\": [\n+                      \"text\"\n+                    ]\n+                  },\n+                  \"type\": \"rule\"\n+                }\n+              ],\n+              \"id\": \"bab88a98-0123-4456-b89a-b1922f7d4f11\",\n+              \"type\": \"group\"\n+            },\n+            \"whereString\": \"commit_id = '${commit}'\"\n+          },\n+          \"table\": \"measurements\"\n+        }\n+      ],\n+      \"title\": \"CPU Utilization\",\n+      \"transparent\": true,\n+      \"type\": \"timeseries\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"palette-classic\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"barAlignment\": 0,\n+            \"barWidthFactor\": 0.6,\n+            \"drawStyle\": \"line\",\n+            \"fillOpacity\": 0,\n+            \"gradientMode\": \"none\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"insertNulls\": 60000,\n+            \"lineInterpolation\": \"linear\",\n+            \"lineWidth\": 1,\n+            \"pointSize\": 5,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"showPoints\": \"auto\",\n+            \"spanNulls\": false,\n+            \"stacking\": {\n+              \"group\": \"A\",\n+              \"mode\": \"none\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              },\n+              {\n+                \"color\": \"red\",\n+                \"value\": 80\n+              }\n+            ]\n+          },\n+          \"unit\": \"percent\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 9,\n+        \"w\": 12,\n+        \"x\": 12,\n+        \"y\": 65\n+      },\n+      \"id\": 4,\n+      \"options\": {\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": true\n+        },\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        }\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT\\n  b.commit_id,\\n  d.gpu_util,\\n  d.time\\nFROM\\n  benchmarks AS b\\n  JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id\\nWHERE\\n  branch = ${branch}\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"cpu_util\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"mem_megabytes\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"gpu_util\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"gpu_mem_megabytes\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"\\\"time\\\"\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50,\n+            \"whereJsonTree\": {\n+              \"children1\": [\n+                {\n+                  \"id\": \"baa888b8-89ab-4cde-b012-31922f8671e9\",\n+                  \"properties\": {\n+                    \"field\": \"commit_id\",\n+                    \"fieldSrc\": \"field\",\n+                    \"operator\": \"equal\",\n+                    \"value\": [\n+                      \"${commit}\"\n+                    ],\n+                    \"valueError\": [\n+                      null\n+                    ],\n+                    \"valueSrc\": [\n+                      \"value\"\n+                    ],\n+                    \"valueType\": [\n+                      \"text\"\n+                    ]\n+                  },\n+                  \"type\": \"rule\"\n+                }\n+              ],\n+              \"id\": \"bab88a98-0123-4456-b89a-b1922f7d4f11\",\n+              \"type\": \"group\"\n+            },\n+            \"whereString\": \"commit_id = '${commit}'\"\n+          },\n+          \"table\": \"measurements\"\n+        }\n+      ],\n+      \"title\": \"GPU Utilization\",\n+      \"transparent\": true,\n+      \"type\": \"timeseries\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"palette-classic\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"barAlignment\": 0,\n+            \"barWidthFactor\": 0.6,\n+            \"drawStyle\": \"line\",\n+            \"fillOpacity\": 0,\n+            \"gradientMode\": \"none\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"insertNulls\": 60000,\n+            \"lineInterpolation\": \"linear\",\n+            \"lineWidth\": 1,\n+            \"pointSize\": 5,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"showPoints\": \"auto\",\n+            \"spanNulls\": false,\n+            \"stacking\": {\n+              \"group\": \"A\",\n+              \"mode\": \"none\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              },\n+              {\n+                \"color\": \"red\",\n+                \"value\": 80\n+              }\n+            ]\n+          },\n+          \"unit\": \"decmbytes\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 9,\n+        \"w\": 12,\n+        \"x\": 0,\n+        \"y\": 74\n+      },\n+      \"id\": 2,\n+      \"options\": {\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": true\n+        },\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        }\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT d.mem_megabytes, d.time FROM benchmarks AS b JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id WHERE branch = ${branch}\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"cpu_util\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"mem_megabytes\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"gpu_util\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"gpu_mem_megabytes\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"\\\"time\\\"\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50,\n+            \"whereJsonTree\": {\n+              \"children1\": [\n+                {\n+                  \"id\": \"baa888b8-89ab-4cde-b012-31922f8671e9\",\n+                  \"properties\": {\n+                    \"field\": \"commit_id\",\n+                    \"fieldSrc\": \"field\",\n+                    \"operator\": \"equal\",\n+                    \"value\": [\n+                      \"${commit}\"\n+                    ],\n+                    \"valueError\": [\n+                      null\n+                    ],\n+                    \"valueSrc\": [\n+                      \"value\"\n+                    ],\n+                    \"valueType\": [\n+                      \"text\"\n+                    ]\n+                  },\n+                  \"type\": \"rule\"\n+                }\n+              ],\n+              \"id\": \"bab88a98-0123-4456-b89a-b1922f7d4f11\",\n+              \"type\": \"group\"\n+            },\n+            \"whereString\": \"commit_id = '${commit}'\"\n+          },\n+          \"table\": \"measurements\"\n+        }\n+      ],\n+      \"title\": \"Memory usage\",\n+      \"transparent\": true,\n+      \"type\": \"timeseries\"\n+    },\n+    {\n+      \"datasource\": {\n+        \"default\": true,\n+        \"type\": \"grafana-postgresql-datasource\",\n+        \"uid\": \"de0dbhs18ho1sc\"\n+      },\n+      \"fieldConfig\": {\n+        \"defaults\": {\n+          \"color\": {\n+            \"mode\": \"palette-classic\"\n+          },\n+          \"custom\": {\n+            \"axisBorderShow\": false,\n+            \"axisCenteredZero\": false,\n+            \"axisColorMode\": \"text\",\n+            \"axisLabel\": \"\",\n+            \"axisPlacement\": \"auto\",\n+            \"barAlignment\": 0,\n+            \"barWidthFactor\": 0.6,\n+            \"drawStyle\": \"line\",\n+            \"fillOpacity\": 0,\n+            \"gradientMode\": \"none\",\n+            \"hideFrom\": {\n+              \"legend\": false,\n+              \"tooltip\": false,\n+              \"viz\": false\n+            },\n+            \"insertNulls\": 60000,\n+            \"lineInterpolation\": \"linear\",\n+            \"lineWidth\": 1,\n+            \"pointSize\": 5,\n+            \"scaleDistribution\": {\n+              \"type\": \"linear\"\n+            },\n+            \"showPoints\": \"auto\",\n+            \"spanNulls\": false,\n+            \"stacking\": {\n+              \"group\": \"A\",\n+              \"mode\": \"none\"\n+            },\n+            \"thresholdsStyle\": {\n+              \"mode\": \"off\"\n+            }\n+          },\n+          \"mappings\": [],\n+          \"thresholds\": {\n+            \"mode\": \"absolute\",\n+            \"steps\": [\n+              {\n+                \"color\": \"green\",\n+                \"value\": null\n+              },\n+              {\n+                \"color\": \"red\",\n+                \"value\": 80\n+              }\n+            ]\n+          },\n+          \"unit\": \"decmbytes\"\n+        },\n+        \"overrides\": []\n+      },\n+      \"gridPos\": {\n+        \"h\": 9,\n+        \"w\": 12,\n+        \"x\": 12,\n+        \"y\": 74\n+      },\n+      \"id\": 3,\n+      \"options\": {\n+        \"legend\": {\n+          \"calcs\": [],\n+          \"displayMode\": \"list\",\n+          \"placement\": \"bottom\",\n+          \"showLegend\": true\n+        },\n+        \"tooltip\": {\n+          \"mode\": \"single\",\n+          \"sort\": \"none\"\n+        }\n+      },\n+      \"targets\": [\n+        {\n+          \"datasource\": {\n+            \"type\": \"grafana-postgresql-datasource\",\n+            \"uid\": \"bdz2yss7sxo1sc\"\n+          },\n+          \"editorMode\": \"code\",\n+          \"format\": \"table\",\n+          \"rawQuery\": true,\n+          \"rawSql\": \"SELECT\\n  d.gpu_mem_megabytes,\\n  d.time\\nFROM\\n  benchmarks AS b\\n  JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id\\nWHERE\\n  branch = ${branch}\",\n+          \"refId\": \"A\",\n+          \"sql\": {\n+            \"columns\": [\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"cpu_util\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"mem_megabytes\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"gpu_util\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"gpu_mem_megabytes\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              },\n+              {\n+                \"parameters\": [\n+                  {\n+                    \"name\": \"\\\"time\\\"\",\n+                    \"type\": \"functionParameter\"\n+                  }\n+                ],\n+                \"type\": \"function\"\n+              }\n+            ],\n+            \"groupBy\": [\n+              {\n+                \"property\": {\n+                  \"type\": \"string\"\n+                },\n+                \"type\": \"groupBy\"\n+              }\n+            ],\n+            \"limit\": 50,\n+            \"whereJsonTree\": {\n+              \"children1\": [\n+                {\n+                  \"id\": \"baa888b8-89ab-4cde-b012-31922f8671e9\",\n+                  \"properties\": {\n+                    \"field\": \"commit_id\",\n+                    \"fieldSrc\": \"field\",\n+                    \"operator\": \"equal\",\n+                    \"value\": [\n+                      \"${commit}\"\n+                    ],\n+                    \"valueError\": [\n+                      null\n+                    ],\n+                    \"valueSrc\": [\n+                      \"value\"\n+                    ],\n+                    \"valueType\": [\n+                      \"text\"\n+                    ]\n+                  },\n+                  \"type\": \"rule\"\n+                }\n+              ],\n+              \"id\": \"bab88a98-0123-4456-b89a-b1922f7d4f11\",\n+              \"type\": \"group\"\n+            },\n+            \"whereString\": \"commit_id = '${commit}'\"\n+          },\n+          \"table\": \"measurements\"\n+        }\n+      ],\n+      \"title\": \"GPU memory usage\",\n+      \"transparent\": true,\n+      \"type\": \"timeseries\"\n+    }\n+  ],\n+  \"schemaVersion\": 39,\n+  \"tags\": [],\n+  \"templating\": {\n+    \"list\": [\n+      {\n+        \"current\": {\n+          \"selected\": true,\n+          \"text\": [\n+            \"refactor/benchmarks\"\n+          ],\n+          \"value\": [\n+            \"refactor/benchmarks\"\n+          ]\n+        },\n+        \"datasource\": {\n+          \"type\": \"grafana-postgresql-datasource\",\n+          \"uid\": \"de0dbhs18ho1sc\"\n+        },\n+        \"definition\": \"SELECT DISTINCT branch FROM benchmarks;\",\n+        \"description\": \"\",\n+        \"hide\": 0,\n+        \"includeAll\": false,\n+        \"label\": \"branch\",\n+        \"multi\": false,\n+        \"name\": \"branch\",\n+        \"options\": [],\n+        \"query\": \"SELECT DISTINCT branch FROM benchmarks;\",\n+        \"refresh\": 2,\n+        \"regex\": \"\",\n+        \"skipUrlSync\": false,\n+        \"sort\": 0,\n+        \"type\": \"query\"\n+      },\n+      {\n+        \"current\": {\n+          \"selected\": false,\n+          \"text\": \"1728570853117\",\n+          \"value\": \"1728570853117\"\n+        },\n+        \"datasource\": {\n+          \"type\": \"grafana-postgresql-datasource\",\n+          \"uid\": \"de0dbhs18ho1sc\"\n+        },\n+        \"definition\": \"SELECT created_at - INTERVAL '5 secs' FROM benchmarks WHERE branch = ${branch} ORDER BY benchmark_id ASC LIMIT 1;\",\n+        \"description\": \"\",\n+        \"hide\": 2,\n+        \"includeAll\": false,\n+        \"multi\": false,\n+        \"name\": \"StartTime\",\n+        \"options\": [],\n+        \"query\": \"SELECT created_at - INTERVAL '5 secs' FROM benchmarks WHERE branch = ${branch} ORDER BY benchmark_id ASC LIMIT 1;\",\n+        \"refresh\": 2,\n+        \"regex\": \"\",\n+        \"skipUrlSync\": false,\n+        \"sort\": 0,\n+        \"type\": \"query\"\n+      },\n+      {\n+        \"current\": {\n+          \"selected\": false,\n+          \"text\": \"1728657828802\",\n+          \"value\": \"1728657828802\"\n+        },\n+        \"datasource\": {\n+          \"type\": \"grafana-postgresql-datasource\",\n+          \"uid\": \"de0dbhs18ho1sc\"\n+        },\n+        \"definition\": \"SELECT time + INTERVAL '5 secs' FROM benchmarks AS b JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id WHERE branch = ${branch} ORDER BY b.benchmark_id DESC, d.measurement_id DESC LIMIT 1;\",\n+        \"description\": \"\",\n+        \"hide\": 2,\n+        \"includeAll\": false,\n+        \"multi\": false,\n+        \"name\": \"EndTime\",\n+        \"options\": [],\n+        \"query\": \"SELECT time + INTERVAL '5 secs' FROM benchmarks AS b JOIN device_measurements AS d ON b.benchmark_id = d.benchmark_id WHERE branch = ${branch} ORDER BY b.benchmark_id DESC, d.measurement_id DESC LIMIT 1;\",\n+        \"refresh\": 2,\n+        \"regex\": \"\",\n+        \"skipUrlSync\": false,\n+        \"sort\": 0,\n+        \"type\": \"query\"\n+      },\n+      {\n+        \"current\": {\n+          \"selected\": false,\n+          \"text\": \"NVIDIA A10G\",\n+          \"value\": \"NVIDIA A10G\"\n+        },\n+        \"definition\": \"SELECT DISTINCT gpu_name FROM benchmarks;\",\n+        \"hide\": 0,\n+        \"includeAll\": false,\n+        \"label\": \"GPU\",\n+        \"multi\": false,\n+        \"name\": \"gpu_name\",\n+        \"options\": [],\n+        \"query\": \"SELECT DISTINCT gpu_name FROM benchmarks;\",\n+        \"refresh\": 1,\n+        \"regex\": \"\",\n+        \"skipUrlSync\": false,\n+        \"sort\": 0,\n+        \"type\": \"query\"\n+      }\n+    ]\n+  },\n+  \"time\": {\n+    \"from\": \"2024-10-11T13:10:01.641Z\",\n+    \"to\": \"2024-10-11T13:25:21.783Z\"\n+  },\n+  \"timepicker\": {\n+    \"hidden\": false\n+  },\n+  \"timezone\": \"browser\",\n+  \"title\": \"Transformers benchmarks\",\n+  \"uid\": \"fdz33iyzln9c0a\",\n+  \"version\": 9,\n+  \"weekStart\": \"\"\n+}"
        },
        {
            "sha": "4381b99cea660e09e6787f4b690ca1f192b02ecc",
            "filename": "benchmark/init_db.sql",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/huggingface/transformers/blob/144852fb6bbe584e9ff7d13511180aec42e1b366/benchmark%2Finit_db.sql",
            "raw_url": "https://github.com/huggingface/transformers/raw/144852fb6bbe584e9ff7d13511180aec42e1b366/benchmark%2Finit_db.sql",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/benchmark%2Finit_db.sql?ref=144852fb6bbe584e9ff7d13511180aec42e1b366",
            "patch": "@@ -0,0 +1,26 @@\n+CREATE TABLE IF NOT EXISTS benchmarks (\n+  benchmark_id SERIAL PRIMARY KEY,\n+  branch VARCHAR(255),\n+  commit_id VARCHAR(72),\n+  commit_message VARCHAR(70),\n+  gpu_name VARCHAR(255),\n+  created_at timestamp without time zone NOT NULL DEFAULT (current_timestamp AT TIME ZONE 'UTC')\n+);\n+\n+CREATE TABLE IF NOT EXISTS device_measurements (\n+  measurement_id SERIAL PRIMARY KEY,\n+  benchmark_id int REFERENCES benchmarks (benchmark_id),\n+  cpu_util double precision,\n+  mem_megabytes double precision,\n+  gpu_util double precision,\n+  gpu_mem_megabytes double precision,\n+  time timestamp without time zone NOT NULL DEFAULT (current_timestamp AT TIME ZONE 'UTC')\n+);\n+\n+CREATE TABLE IF NOT EXISTS model_measurements (\n+  measurement_id SERIAL PRIMARY KEY,\n+  benchmark_id int REFERENCES benchmarks (benchmark_id),\n+  measurements jsonb,\n+  time timestamp without time zone NOT NULL DEFAULT (current_timestamp AT TIME ZONE 'UTC')\n+);\n+"
        },
        {
            "sha": "a926f90348660730cb65be4470935d086b0cddc1",
            "filename": "benchmark/llama.py",
            "status": "added",
            "additions": 404,
            "deletions": 0,
            "changes": 404,
            "blob_url": "https://github.com/huggingface/transformers/blob/144852fb6bbe584e9ff7d13511180aec42e1b366/benchmark%2Fllama.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/144852fb6bbe584e9ff7d13511180aec42e1b366/benchmark%2Fllama.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/benchmark%2Fllama.py?ref=144852fb6bbe584e9ff7d13511180aec42e1b366",
            "patch": "@@ -0,0 +1,404 @@\n+import argparse\n+import json\n+import logging\n+import os\n+import sys\n+from statistics import mean\n+from threading import Event, Thread\n+from time import perf_counter, sleep\n+from typing import Optional\n+import gpustat\n+import psutil\n+import psycopg2\n+import torch\n+\n+from transformers import AutoModelForCausalLM, AutoTokenizer, GenerationConfig, StaticCache\n+from psycopg2.extras import Json\n+from psycopg2.extensions import register_adapter\n+\n+\n+os.environ[\"HF_HUB_ENABLE_HF_TRANSFER\"] = \"1\"\n+\n+logger = logging.getLogger(__name__)\n+logger.setLevel(logging.INFO)\n+\n+handler = logging.StreamHandler(sys.stdout)\n+handler.setLevel(logging.INFO)\n+formatter = logging.Formatter(\"[%(levelname)s - %(asctime)s] %(message)s\")\n+handler.setFormatter(formatter)\n+logger.addHandler(handler)\n+\n+os.environ[\"TOKENIZERS_PARALLELISM\"] = \"1\"\n+torch.set_float32_matmul_precision(\"high\")\n+register_adapter(dict, Json)\n+\n+\n+def parse_arguments():\n+    \"\"\"\n+    Parse command line arguments for the benchmarking CLI.\n+    \"\"\"\n+    parser = argparse.ArgumentParser(description=\"CLI for benchmarking the huggingface/transformers.\")\n+\n+    parser.add_argument(\n+        \"branch\",\n+        type=str,\n+        help=\"The branch name on which the benchmarking is performed.\",\n+    )\n+\n+    parser.add_argument(\n+        \"commit_id\",\n+        type=str,\n+        help=\"The commit hash on which the benchmarking is performed.\",\n+    )\n+\n+    parser.add_argument(\n+        \"commit_msg\",\n+        type=str,\n+        help=\"The commit message associated with the commit, truncated to 70 characters.\",\n+    )\n+\n+    args = parser.parse_args()\n+\n+    return args.branch, args.commit_id, args.commit_msg\n+\n+\n+def collect_metrics(benchmark_id, continue_metric_collection):\n+    p = psutil.Process(os.getpid())\n+    conn = psycopg2.connect(\"dbname=metrics\")\n+    cur = conn.cursor()\n+    while not continue_metric_collection.is_set():\n+        with p.oneshot():\n+            cpu_util = p.cpu_percent()\n+            mem_megabytes = p.memory_info().rss / (1024 * 1024)\n+        gpu_stats = gpustat.GPUStatCollection.new_query()\n+        gpu_util = gpu_stats[0][\"utilization.gpu\"]\n+        gpu_mem_megabytes = gpu_stats[0][\"memory.used\"]\n+        cur.execute(\n+            \"INSERT INTO device_measurements (benchmark_id, cpu_util, mem_megabytes, gpu_util, gpu_mem_megabytes) VALUES (%s, %s, %s, %s, %s)\",\n+            (benchmark_id, cpu_util, mem_megabytes, gpu_util, gpu_mem_megabytes),\n+        )\n+        sleep(0.01)\n+        conn.commit()\n+    conn.close()\n+\n+\n+def run_benchmark(branch: str, commit_id: str, commit_msg: str, num_tokens_to_generate=100):\n+    continue_metric_collection = Event()\n+    metrics_thread = None\n+    try:\n+        gpu_stats = gpustat.GPUStatCollection.new_query()\n+        gpu_name = gpu_stats[0][\"name\"]\n+        conn = psycopg2.connect(\"dbname=metrics\")\n+        cur = conn.cursor()\n+        cur.execute(\n+            \"INSERT INTO benchmarks (branch, commit_id, commit_message, gpu_name) VALUES (%s, %s, %s, %s) RETURNING benchmark_id\",\n+            (branch, commit_id, commit_msg, gpu_name),\n+        )\n+        conn.commit()\n+        benchmark_id = cur.fetchone()[0]\n+        metrics_thread = Thread(target=collect_metrics, args=[benchmark_id, continue_metric_collection])\n+        metrics_thread.start()\n+\n+        os.environ[\"TOKENIZERS_PARALLELISM\"] = \"false\"  # silence warnings when compiling\n+\n+        device = \"cuda\"\n+        ckpt = \"meta-llama/Llama-2-7b-hf\"\n+\n+        # This is to avoid counting download in model load time measurement\n+        model = AutoModelForCausalLM.from_pretrained(ckpt, torch_dtype=torch.float16)\n+        gen_config = GenerationConfig(do_sample=False, top_p=1, temperature=1)\n+        start = perf_counter()\n+        model = AutoModelForCausalLM.from_pretrained(\n+            ckpt, torch_dtype=torch.float16, generation_config=gen_config\n+        ).eval()\n+        model.to(device)\n+        torch.cuda.synchronize()\n+        end = perf_counter()\n+        model_load_time = end - start\n+        logger.info(f\"loaded model in: {model_load_time}s\")\n+\n+        tokenizer = AutoTokenizer.from_pretrained(ckpt)\n+\n+        prompt = \"Why dogs are so cute?\"\n+        inputs = tokenizer(prompt, return_tensors=\"pt\").to(device)\n+\n+        # Specify the max length (including both the prompt and the response)\n+        # When calling `generate` with `cache_implementation=\"static\" later, this is also used to create a `StaticCache` object\n+        # with sequence length = `max_length`. The longer the more you will re-use it\n+        seq_length = inputs[\"input_ids\"].shape[1]\n+        model.generation_config.max_length = seq_length + num_tokens_to_generate\n+        batch_size = inputs[\"input_ids\"].shape[0]\n+\n+        # Copied from the gpt-fast repo\n+        def multinomial_sample_one_no_sync(probs_sort):  # Does multinomial sampling without a cuda synchronization\n+            q = torch.empty_like(probs_sort).exponential_(1)\n+            return torch.argmax(probs_sort / q, dim=-1, keepdim=True).to(dtype=torch.int)\n+\n+        def logits_to_probs(logits, temperature: float = 1.0, top_k: Optional[int] = None):\n+            logits = logits / max(temperature, 1e-5)\n+\n+            if top_k is not None:\n+                v, _ = torch.topk(logits, min(top_k, logits.size(-1)))\n+                pivot = v.select(-1, -1).unsqueeze(-1)\n+                logits = torch.where(logits < pivot, -float(\"Inf\"), logits)\n+            probs = torch.nn.functional.softmax(logits, dim=-1)\n+            return probs\n+\n+        def sample(logits, temperature: float = 1.0, top_k: Optional[int] = None):\n+            probs = logits_to_probs(logits[:, -1], temperature, top_k)\n+            idx_next = multinomial_sample_one_no_sync(probs)\n+            return idx_next, probs\n+\n+        def decode_one_token(model, cur_token, cache_position, past_key_values):\n+            logits = model(\n+                cur_token,\n+                cache_position=cache_position,\n+                past_key_values=past_key_values,\n+                return_dict=False,\n+                use_cache=True,\n+            )[0]\n+            new_token = sample(logits, temperature=0.6, top_k=5)[0]\n+            return new_token\n+\n+        #########\n+        # Eager #\n+        #########\n+        with torch.no_grad():\n+            past_key_values = StaticCache(\n+                model.config,\n+                batch_size=batch_size,\n+                device=device,\n+                dtype=torch.float16,\n+                max_cache_len=seq_length + num_tokens_to_generate,\n+            )\n+            cache_position = torch.arange(seq_length, device=device)\n+            start = perf_counter()\n+            model(\n+                **inputs,\n+                cache_position=cache_position,\n+                past_key_values=past_key_values,\n+                return_dict=False,\n+                use_cache=True,\n+            )\n+            end = perf_counter()\n+            first_eager_fwd_pass_time = end - start\n+            logger.info(f\"completed first eager fwd pass in: {first_eager_fwd_pass_time}s\")\n+            start = perf_counter()\n+            output = model.generate(**inputs, do_sample=False)\n+            end = perf_counter()\n+            first_eager_generate_time = end - start\n+            logger.info(f\"completed first eager generation in: {first_eager_generate_time}s\")\n+            logger.info(f\"generated: {tokenizer.batch_decode(output.cpu().tolist())}\")\n+\n+            past_key_values = StaticCache(\n+                model.config,\n+                batch_size=batch_size,\n+                device=device,\n+                dtype=torch.float16,\n+                max_cache_len=seq_length + num_tokens_to_generate,\n+            )\n+            cache_position = torch.arange(seq_length, device=device)\n+            start = perf_counter()\n+            model(\n+                **inputs,\n+                cache_position=cache_position,\n+                past_key_values=past_key_values,\n+                return_dict=False,\n+                use_cache=True,\n+            )\n+            end = perf_counter()\n+            second_eager_fwd_pass_time = end - start\n+            logger.info(f\"completed second eager fwd pass in: {second_eager_fwd_pass_time}s\")\n+            start = perf_counter()\n+            model.generate(**inputs, do_sample=False)\n+            end = perf_counter()\n+            second_eager_generate_time = end - start\n+            logger.info(f\"completed second eager generation in: {second_eager_generate_time}s\")\n+            logger.info(f\"generated: {tokenizer.batch_decode(output.cpu().tolist())}\")\n+\n+            torch.compiler.reset()\n+\n+            ################\n+            # Forward pass #\n+            ################\n+\n+            # `torch.compile(model, ...)` is not recommended as you compile callbacks\n+            # and full generate. We recommend compiling only the forward for now.\n+            # \"reduce-overhead\" will use cudagraphs.\n+            generated_ids = torch.zeros(\n+                (batch_size, num_tokens_to_generate + seq_length), dtype=torch.int, device=device\n+            )\n+\n+            generated_ids[:, :seq_length] = inputs[\"input_ids\"]\n+            decode_one_token = torch.compile(decode_one_token, mode=\"reduce-overhead\", fullgraph=True)\n+            # model.forward = torch.compile(model.forward, mode=\"reduce-overhead\", fullgraph=True)\n+            # TODO use  decode_one_token(model, input_id.clone(), cache_position) for verification\n+            past_key_values = StaticCache(\n+                model.config,\n+                batch_size=batch_size,\n+                device=device,\n+                dtype=torch.float16,\n+                max_cache_len=seq_length + num_tokens_to_generate + 10,\n+            )\n+            cache_position = torch.arange(seq_length, device=device)\n+            all_generated_tokens = []\n+            ### First compile, prefill\n+            start = perf_counter()\n+            next_token = decode_one_token(\n+                model, inputs[\"input_ids\"], cache_position=cache_position, past_key_values=past_key_values\n+            )\n+            torch.cuda.synchronize()\n+            end = perf_counter()\n+            time_to_first_token = end - start\n+            logger.info(f\"completed first compile generation in: {time_to_first_token}s\")\n+            cache_position += 1\n+            all_generated_tokens += next_token.clone().detach().cpu().tolist()\n+\n+            cache_position = torch.tensor([seq_length], device=device)\n+            ### First compile, decoding\n+            start = perf_counter()\n+            next_token = decode_one_token(\n+                model, next_token.clone(), cache_position=cache_position, past_key_values=past_key_values\n+            )\n+            torch.cuda.synchronize()\n+            end = perf_counter()\n+            time_to_second_token = end - start\n+            logger.info(f\"completed second compile generation in: {time_to_first_token}s\")\n+            cache_position += 1\n+            all_generated_tokens += next_token.clone().detach().cpu().tolist()\n+\n+            ### Second compile, decoding\n+            start = perf_counter()\n+            next_token = decode_one_token(\n+                model, next_token.clone(), cache_position=cache_position, past_key_values=past_key_values\n+            )\n+            torch.cuda.synchronize()\n+            end = perf_counter()\n+            time_to_third_token = end - start\n+            logger.info(f\"completed third compile forward in: {time_to_first_token}s\")\n+            cache_position += 1\n+            all_generated_tokens += next_token.clone().detach().cpu().tolist()\n+\n+            ### Using cuda graphs decoding\n+\n+            start = perf_counter()\n+            for _ in range(1, num_tokens_to_generate):\n+                all_generated_tokens += next_token.clone().detach().cpu().tolist()\n+                next_token = decode_one_token(\n+                    model, next_token.clone(), cache_position=cache_position, past_key_values=past_key_values\n+                )\n+                cache_position += 1\n+            torch.cuda.synchronize()\n+            end = perf_counter()\n+            mean_time_to_next_token = (end - start) / num_tokens_to_generate\n+            logger.info(f\"completed next compile generation in: {mean_time_to_next_token}s\")\n+            logger.info(f\"generated: {tokenizer.batch_decode(all_generated_tokens)}\")\n+\n+            ####################\n+            # Generate compile #\n+            ####################\n+            torch.compiler.reset()\n+            # we will not compile full generate as it' s to intensive, tho we measure full forward!\n+\n+            past_key_values = StaticCache(\n+                model.config,\n+                batch_size=batch_size,\n+                device=device,\n+                dtype=torch.float16,\n+                max_cache_len=seq_length + 128,\n+            )\n+\n+            # 1st call\n+            start = perf_counter()\n+            output = model.generate(**inputs, past_key_values=past_key_values)\n+            torch.cuda.synchronize()\n+            end = perf_counter()\n+            first_compile_generate_time = end - start\n+            logger.info(f\"completed first compile generation in: {first_compile_generate_time}s\")\n+            logger.info(f\"generated: {tokenizer.batch_decode(output.cpu().tolist())}\")\n+\n+            past_key_values = StaticCache(\n+                model.config,\n+                batch_size=batch_size,\n+                device=device,\n+                dtype=torch.float16,\n+                max_cache_len=seq_length + 128,\n+            )\n+            # 2nd call\n+            start = perf_counter()\n+            output = model.generate(**inputs, past_key_values=past_key_values)\n+            torch.cuda.synchronize()\n+            end = perf_counter()\n+            second_compile_generate_time = end - start\n+            logger.info(f\"completed second compile generation in: {second_compile_generate_time}s\")\n+            logger.info(f\"generated: {tokenizer.batch_decode(output.cpu().tolist())}\")\n+\n+            past_key_values = StaticCache(\n+                model.config,\n+                batch_size=batch_size,\n+                device=device,\n+                dtype=torch.float16,\n+                max_cache_len=seq_length + 128,\n+            )\n+\n+            # 3nd call\n+            start = perf_counter()\n+            output = model.generate(**inputs, past_key_values=past_key_values)\n+            end = perf_counter()\n+            third_compile_generate_time = end - start\n+            logger.info(f\"completed second compile generation in: {third_compile_generate_time}s\")\n+            logger.info(f\"generated: {tokenizer.batch_decode(output.cpu().tolist())}\")\n+\n+            past_key_values = StaticCache(\n+                model.config,\n+                batch_size=batch_size,\n+                device=device,\n+                dtype=torch.float16,\n+                max_cache_len=seq_length + 128,\n+            )\n+            # 4th call\n+            start = perf_counter()\n+            output = model.generate(**inputs, past_key_values=past_key_values)\n+            end = perf_counter()\n+            fourth_compile_generate_time = end - start\n+            logger.info(f\"completed second compile generation in: {fourth_compile_generate_time}s\")\n+            logger.info(f\"generated: {tokenizer.batch_decode(output.cpu().tolist())}\")\n+\n+        cur.execute(\n+            \"\"\"\n+            INSERT INTO model_measurements (\n+                benchmark_id,\n+                measurements\n+            ) VALUES (%s, %s)\n+            \"\"\",\n+            (\n+                benchmark_id,\n+                {\n+                    \"model_load_time\": model_load_time,\n+                    \"first_eager_forward_pass_time_secs\": first_eager_fwd_pass_time,\n+                    \"second_eager_forward_pass_time_secs\": second_eager_fwd_pass_time,\n+                    \"first_eager_generate_time_secs\": first_eager_generate_time,\n+                    \"second_eager_generate_time_secs\": second_eager_generate_time,\n+                    \"time_to_first_token_secs\": time_to_first_token,\n+                    \"time_to_second_token_secs\": time_to_second_token,\n+                    \"time_to_third_token_secs\": time_to_third_token,\n+                    \"time_to_next_token_mean_secs\": mean_time_to_next_token,\n+                    \"first_compile_generate_time_secs\": first_compile_generate_time,\n+                    \"second_compile_generate_time_secs\": second_compile_generate_time,\n+                    \"third_compile_generate_time_secs\": third_compile_generate_time,\n+                    \"fourth_compile_generate_time_secs\": fourth_compile_generate_time,\n+                },\n+            ),\n+        )\n+        conn.commit()\n+        conn.close()\n+    except Exception as e:\n+        logger.error(f\"Caught exception: {e}\")\n+    continue_metric_collection.set()\n+    if metrics_thread is not None:\n+        metrics_thread.join()\n+\n+\n+if __name__ == \"__main__\":\n+    branch, commit_id, commit_msg = parse_arguments()\n+    run_benchmark(branch, commit_id, commit_msg, num_tokens_to_generate=20)"
        },
        {
            "sha": "50e9dfaddfa4cab8bea5b51561198d47d14c3b35",
            "filename": "benchmark/requirements.txt",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/huggingface/transformers/blob/144852fb6bbe584e9ff7d13511180aec42e1b366/benchmark%2Frequirements.txt",
            "raw_url": "https://github.com/huggingface/transformers/raw/144852fb6bbe584e9ff7d13511180aec42e1b366/benchmark%2Frequirements.txt",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/benchmark%2Frequirements.txt?ref=144852fb6bbe584e9ff7d13511180aec42e1b366",
            "patch": "@@ -0,0 +1,5 @@\n+gpustat==1.1.1\n+psutil==6.0.0\n+psycopg2==2.9.9\n+torch>=2.4.0\n+hf_transfer\n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 2719,
        "additions": 2697,
        "deletions": 22
    }
}