{
    "author": "ydshieh",
    "message": "Use `weights_only=True` with `torch.load` for `transfo_xl` (#35241)\n\nfix\r\n\r\nCo-authored-by: ydshieh <ydshieh@users.noreply.github.com>",
    "sha": "0fc2970363796c36054b5f41ffa6b6aa3906736e",
    "files": [
        {
            "sha": "53dec63cfc4fd87db02cf1b4daf08cffd05f44e8",
            "filename": "src/transformers/models/deprecated/transfo_xl/tokenization_transfo_xl.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/0fc2970363796c36054b5f41ffa6b6aa3906736e/src%2Ftransformers%2Fmodels%2Fdeprecated%2Ftransfo_xl%2Ftokenization_transfo_xl.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/0fc2970363796c36054b5f41ffa6b6aa3906736e/src%2Ftransformers%2Fmodels%2Fdeprecated%2Ftransfo_xl%2Ftokenization_transfo_xl.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fdeprecated%2Ftransfo_xl%2Ftokenization_transfo_xl.py?ref=0fc2970363796c36054b5f41ffa6b6aa3906736e",
            "patch": "@@ -222,7 +222,7 @@ def __init__(\n                             \"from a PyTorch pretrained vocabulary, \"\n                             \"or activate it with environment variables USE_TORCH=1 and USE_TF=0.\"\n                         )\n-                    vocab_dict = torch.load(pretrained_vocab_file)\n+                    vocab_dict = torch.load(pretrained_vocab_file, weights_only=True)\n \n             if vocab_dict is not None:\n                 for key, value in vocab_dict.items():\n@@ -705,7 +705,7 @@ def from_pretrained(cls, pretrained_model_name_or_path, cache_dir=None, *inputs,\n \n         # Instantiate tokenizer.\n         corpus = cls(*inputs, **kwargs)\n-        corpus_dict = torch.load(resolved_corpus_file)\n+        corpus_dict = torch.load(resolved_corpus_file, weights_only=True)\n         for key, value in corpus_dict.items():\n             corpus.__dict__[key] = value\n         corpus.vocab = vocab\n@@ -784,7 +784,7 @@ def get_lm_corpus(datadir, dataset):\n     fn_pickle = os.path.join(datadir, \"cache.pkl\")\n     if os.path.exists(fn):\n         logger.info(\"Loading cached dataset...\")\n-        corpus = torch.load(fn_pickle)\n+        corpus = torch.load(fn_pickle, weights_only=True)\n     elif os.path.exists(fn):\n         logger.info(\"Loading cached dataset from pickle...\")\n         if not strtobool(os.environ.get(\"TRUST_REMOTE_CODE\", \"False\")):"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
    }
}