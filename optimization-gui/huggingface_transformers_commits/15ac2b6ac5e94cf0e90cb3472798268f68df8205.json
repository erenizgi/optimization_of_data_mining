{
    "author": "ParagEkbote",
    "message": "Update Model Card for ModernBERT (#37052)\n\n* Modify Model Card for ModernBERT.\n\n* Update as per code review.\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update model card.\n\n* Update model card.\n\n---------\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>",
    "sha": "15ac2b6ac5e94cf0e90cb3472798268f68df8205",
    "files": [
        {
            "sha": "16ada230a2ae3fa5cba788270868d7b9b391416b",
            "filename": "docs/source/en/model_doc/modernbert.md",
            "status": "modified",
            "additions": 55,
            "deletions": 31,
            "changes": 86,
            "blob_url": "https://github.com/huggingface/transformers/blob/15ac2b6ac5e94cf0e90cb3472798268f68df8205/docs%2Fsource%2Fen%2Fmodel_doc%2Fmodernbert.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/15ac2b6ac5e94cf0e90cb3472798268f68df8205/docs%2Fsource%2Fen%2Fmodel_doc%2Fmodernbert.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmodernbert.md?ref=15ac2b6ac5e94cf0e90cb3472798268f68df8205",
            "patch": "@@ -14,55 +14,79 @@ rendered properly in your Markdown viewer.\n \n -->\n \n-# ModernBERT\n-\n-<div class=\"flex flex-wrap space-x-1\">\n-<img alt=\"PyTorch\" src=\"https://img.shields.io/badge/PyTorch-DE3412?style=flat&logo=pytorch&logoColor=white\">\n-<img alt=\"FlashAttention\" src=\"https://img.shields.io/badge/%E2%9A%A1%EF%B8%8E%20FlashAttention-eae0c8?style=flat\">\n-<img alt=\"SDPA\" src=\"https://img.shields.io/badge/SDPA-DE3412?style=flat&logo=pytorch&logoColor=white\">\n+<div style=\"float: right;\">\n+  <div class=\"flex flex-wrap space-x-1\">\n+    <img alt=\"PyTorch\" src=\"https://img.shields.io/badge/PyTorch-DE3412?style=flat&logo=pytorch&logoColor=white\">\n+    <img alt=\"FlashAttention\" src=\"https://img.shields.io/badge/%E2%9A%A1%EF%B8%8E%20FlashAttention-eae0c8?style=flat\">\n+    <img alt=\"SDPA\" src=\"https://img.shields.io/badge/SDPA-DE3412?style=flat&logo=pytorch&logoColor=white\">\n+  </div>\n </div>\n \n-## Overview\n+# ModernBERT\n \n-The ModernBERT model was proposed in [Smarter, Better, Faster, Longer: A Modern Bidirectional Encoder for Fast, Memory Efficient, and Long Context Finetuning and Inference](https://arxiv.org/abs/2412.13663) by Benjamin Warner, Antoine Chaffin, Benjamin ClaviÃ©, Orion Weller, Oskar HallstrÃ¶m, Said Taghadouini, Alexis Galalgher, Raja Bisas, Faisal Ladhak, Tom Aarsen, Nathan Cooper, Grifin Adams, Jeremy Howard and Iacopo Poli.\n+[ModernBERT](https://huggingface.co/papers/2412.13663) is a modernized version of [`BERT`] trained on 2T tokens. It brings many improvements to the original architecture such as rotary positional embeddings to support sequences of up to 8192 tokens, unpadding to avoid wasting compute on padding tokens, GeGLU layers, and alternating attention.\n \n-It is a refresh of the traditional encoder architecture, as used in previous models such as [BERT](https://huggingface.co/docs/transformers/en/model_doc/bert) and [RoBERTa](https://huggingface.co/docs/transformers/en/model_doc/roberta). \n+You can find all the original ModernBERT checkpoints under the [ModernBERT](https://huggingface.co/collections/answerdotai/modernbert-67627ad707a4acbf33c41deb) collection.\n \n-It builds on BERT and implements many modern architectural improvements which have been developed since its original release, such as:\n-- [Rotary Positional Embeddings](https://huggingface.co/blog/designing-positional-encoding) to support sequences of up to 8192 tokens.\n-- [Unpadding](https://arxiv.org/abs/2208.08124) to ensure no compute is wasted on padding tokens, speeding up processing time for batches with mixed-length sequences.\n-- [GeGLU](https://arxiv.org/abs/2002.05202) Replacing the original MLP layers with GeGLU layers, shown to improve performance.\n-- [Alternating Attention](https://arxiv.org/abs/2004.05150v2) where most attention layers employ a sliding window of 128 tokens, with Global Attention only used every 3 layers.\n-- [Flash Attention](https://github.com/Dao-AILab/flash-attention) to speed up processing.\n-- A model designed following recent [The Case for Co-Designing Model Architectures with Hardware](https://arxiv.org/abs/2401.14489), ensuring maximum efficiency across inference GPUs.\n-- Modern training data scales (2 trillion tokens) and mixtures (including code ande math data)\n+> [!TIP]\n+> Click on the ModernBERT models in the right sidebar for more examples of how to apply ModernBERT to different language tasks.\n \n-The abstract from the paper is the following:\n+The example below demonstrates how to predict the `[MASK]` token with [`Pipeline`], [`AutoModel`], and from the command line.\n \n-*Encoder-only transformer models such as BERT offer a great performance-size tradeoff for retrieval and classification tasks with respect to larger decoder-only models. Despite being the workhorse of numerous production pipelines, there have been limited Pareto improvements to BERT since its release. In this paper, we introduce ModernBERT, bringing modern model optimizations to encoder-only models and representing a major Pareto improvement over older encoders. Trained on 2 trillion tokens with a native 8192 sequence length, ModernBERT models exhibit state-of-the-art results on a large pool of evaluations encompassing diverse classification tasks and both single and multi-vector retrieval on different domains (including code). In addition to strong downstream performance, ModernBERT is also the most speed and memory efficient encoder and is designed for inference on common GPUs.*\n+<hfoptions id=\"usage\">\n+<hfoption id=\"Pipeline\">\n \n-The original code can be found [here](https://github.com/answerdotai/modernbert).\n+```py\n+import torch\n+from transformers import pipeline\n \n-## Resources\n+pipeline = pipeline(\n+    task=\"fill-mask\",\n+    model=\"answerdotai/ModernBERT-base\",\n+    torch_dtype=torch.float16,\n+    device=0\n+)\n+pipeline(\"Plants create [MASK] through a process known as photosynthesis.\")\n+```\n \n-A list of official Hugging Face and community (indicated by ðŸŒŽ) resources to help you get started with ModernBert.\n+</hfoption>\n+<hfoption id=\"AutoModel\">\n \n-<PipelineTag pipeline=\"text-classification\"/>\n+```py\n+import torch\n+from transformers import AutoModelForMaskedLM, AutoTokenizer\n \n-- A notebook on how to [finetune for General Language Understanding Evaluation (GLUE) with Transformers](https://github.com/AnswerDotAI/ModernBERT/blob/main/examples/finetune_modernbert_on_glue.ipynb), also available as a Google Colab [notebook](https://colab.research.google.com/github/AnswerDotAI/ModernBERT/blob/main/examples/finetune_modernbert_on_glue.ipynb). ðŸŒŽ\n+tokenizer = AutoTokenizer.from_pretrained(\n+    \"answerdotai/ModernBERT-base\",\n+)\n+model = AutoModelForMaskedLM.from_pretrained(\n+    \"answerdotai/ModernBERT-base\",\n+    torch_dtype=torch.float16,\n+    device_map=\"auto\",\n+    attn_implementation=\"sdpa\"\n+)\n+inputs = tokenizer(\"Plants create [MASK] through a process known as photosynthesis.\", return_tensors=\"pt\").to(\"cuda\")\n \n-<PipelineTag pipeline=\"sentence-similarity\"/>\n+with torch.no_grad():\n+    outputs = model(**inputs)\n+    predictions = outputs.logits\n \n-- A script on how to [finetune for text similarity or information retrieval with Sentence Transformers](https://github.com/AnswerDotAI/ModernBERT/blob/main/examples/train_st.py). ðŸŒŽ\n-- A script on how to [finetune for information retrieval with PyLate](https://github.com/AnswerDotAI/ModernBERT/blob/main/examples/train_pylate.py). ðŸŒŽ\n+masked_index = torch.where(inputs['input_ids'] == tokenizer.mask_token_id)[1]\n+predicted_token_id = predictions[0, masked_index].argmax(dim=-1)\n+predicted_token = tokenizer.decode(predicted_token_id)\n \n-<PipelineTag pipeline=\"fill-mask\"/>\n+print(f\"The predicted token is: {predicted_token}\")\n+```\n \n-- [Masked language modeling task guide](../tasks/masked_language_modeling)\n+</hfoption>\n+<hfoption id=\"transformers-cli\">\n \n-<PipelineTag pipeline=\"question-answering\"/>\n+```bash\n+echo -e \"Plants create [MASK] through a process known as photosynthesis.\" | transformers-cli run --task fill-mask --model answerdotai/ModernBERT-base --device 0\n+```\n \n-- [`ModernBertForQuestionAnswering`] is supported by this [example script](https://github.com/huggingface/transformers/tree/main/examples/pytorch/question-answering) and [colab notebook](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/question_answering.ipynb).\n+</hfoption>\n+</hfoptions>\n \n ## ModernBertConfig\n "
        }
    ],
    "stats": {
        "total": 86,
        "additions": 55,
        "deletions": 31
    }
}