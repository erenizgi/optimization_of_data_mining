{
    "author": "MekkCyber",
    "message": "[kernels] Fix failling tests (#42953)\n\nfix",
    "sha": "cf0f071eb8d820d29bb90b19e28da7b3a2c2692b",
    "files": [
        {
            "sha": "1cc44ea4aea33541a96d6f04c29e918b5bbab8a4",
            "filename": "tests/kernels/test_kernels.py",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/huggingface/transformers/blob/cf0f071eb8d820d29bb90b19e28da7b3a2c2692b/tests%2Fkernels%2Ftest_kernels.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/cf0f071eb8d820d29bb90b19e28da7b3a2c2692b/tests%2Fkernels%2Ftest_kernels.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Fkernels%2Ftest_kernels.py?ref=cf0f071eb8d820d29bb90b19e28da7b3a2c2692b",
            "patch": "@@ -44,6 +44,8 @@\n     import kernels as kernels_pkg\n     from kernels import Device, Mode, kernelize\n \n+    import transformers.integrations.hub_kernels as hub_kernels_pkg\n+\n \n @require_kernels\n @slow\n@@ -95,6 +97,7 @@ def test_forward(self):\n \n         self.EXPECTED_OUTPUT = set()\n         self.EXPECTED_OUTPUT.add(\"Hello, I'm looking for a reliable and trustworthy online\")\n+        self.EXPECTED_OUTPUT.add(\"Hello! I'm excited to be a part of this\")\n \n         self.assertTrue(output in self.EXPECTED_OUTPUT)\n \n@@ -249,7 +252,7 @@ def fake_get_kernel(repo_id, revision=None, version=None):\n                 self.assertIn(repo_id, {\"kernels-community/causal-conv1d\"})\n                 return sentinel\n \n-            setattr(kernels_pkg, \"get_kernel\", fake_get_kernel)\n+            setattr(hub_kernels_pkg, \"get_kernel\", fake_get_kernel)\n             _KERNEL_MODULE_MAPPING.pop(\"causal-conv1d\", None)\n \n             mod1 = lazy_load_kernel(\"causal-conv1d\")\n@@ -286,15 +289,15 @@ def test_lazy_load_kernel_version(self):\n             HUB[name] = {\"repo_id\": \"kernels-community/causal-conv1d\", \"version\": version_spec}  # type: ignore[assignment]\n             _KERNEL_MODULE_MAPPING.pop(name, None)\n \n-            def fake_get_kernel(repo_id, revision=None, version=None, user_agent=None):\n+            def fake_get_kernel(repo_id, revision=None, version=None):\n                 call_count[\"n\"] += 1\n                 self.assertEqual(repo_id, \"kernels-community/causal-conv1d\")\n                 self.assertIsNone(revision, \"revision must not be set when version is provided\")\n                 self.assertEqual(version, version_spec)\n                 return sentinel_mod\n \n             # Patch kernels.get_kernel so lazy_load_kernel picks it up on import\n-            setattr(kernels_pkg, \"get_kernel\", fake_get_kernel)\n+            setattr(hub_kernels_pkg, \"get_kernel\", fake_get_kernel)\n \n             # Act\n             mod1 = lazy_load_kernel(name)"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 6,
        "deletions": 3
    }
}