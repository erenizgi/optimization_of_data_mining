{
    "author": "ArthurZucker",
    "message": "[`Patch helper`] update to not have to checkout main (#34006)\n\nadd more support",
    "sha": "e783f12f204ead2906ecd9c8c1196650b4c4adad",
    "files": [
        {
            "sha": "f31e755efdc94e71c35c68a7d9b3ee48de12ca3a",
            "filename": "utils/patch_helper.py",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/huggingface/transformers/blob/e783f12f204ead2906ecd9c8c1196650b4c4adad/utils%2Fpatch_helper.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/e783f12f204ead2906ecd9c8c1196650b4c4adad/utils%2Fpatch_helper.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/utils%2Fpatch_helper.py?ref=e783f12f204ead2906ecd9c8c1196650b4c4adad",
            "patch": "@@ -44,7 +44,7 @@\n def get_merge_commit(repo, pr_number, since_tag):\n     try:\n         # Use git log to find the merge commit for the PR within the given tag range\n-        merge_commit = next(repo.iter_commits(f\"v{since_tag}...HEAD\", grep=f\"#{pr_number}\"))\n+        merge_commit = next(repo.iter_commits(f\"v{since_tag}...origin/main\", grep=f\"#{pr_number}\"))\n         return merge_commit\n     except StopIteration:\n         print(f\"No merge commit found for PR #{pr_number} between tags {since_tag} and {main}\")\n@@ -71,6 +71,7 @@ def main(pr_numbers):\n     major_minor = f\"{last_tag.major}.{last_tag.minor}.0\"\n     # Iterate through tag ranges to find the merge commits\n     for pr in pr_numbers:\n+        pr = pr.split(\"https://github.com/huggingface/transformers/pull/\")[-1]\n         commit = get_merge_commit(repo, pr, major_minor)\n         if commit:\n             merge_commits.append(commit)\n@@ -86,7 +87,9 @@ def main(pr_numbers):\n \n if __name__ == \"__main__\":\n     parser = argparse.ArgumentParser(description=\"Find and sort merge commits for specified PRs.\")\n-    parser.add_argument(\"--prs\", nargs=\"+\", required=True, type=int, help=\"PR numbers to find merge commits for\")\n+    parser.add_argument(\"--prs\", nargs=\"+\", required=False, type=str, help=\"PR numbers to find merge commits for\")\n \n     args = parser.parse_args()\n+    if args.prs is None:\n+        args.prs = \"https://github.com/huggingface/transformers/pull/33753  https://github.com/huggingface/transformers/pull/33861  https://github.com/huggingface/transformers/pull/33906  https://github.com/huggingface/transformers/pull/33761  https://github.com/huggingface/transformers/pull/33586  https://github.com/huggingface/transformers/pull/33766  https://github.com/huggingface/transformers/pull/33958 https://github.com/huggingface/transformers/pull/33965\".split()\n     main(args.prs)"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
    }
}