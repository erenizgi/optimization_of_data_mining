{
    "author": "sambhavnoobcoder",
    "message": "Make `output_dir` Optional in `TrainingArguments` #27866 (#35735)\n\n* make output_dir optional\r\n\r\n* inintaied a basic testing module to validate and verify the changes\r\n\r\n* Test output_dir default to 'tmp_trainer' when  unspecified.\r\n\r\n* test existing functionality of output_dir.\r\n\r\n* test that output dir only created when needed\r\n\r\n* final check\r\n\r\n* added doc string and changed the tmp_trainer to trainer_output\r\n\r\n* amke style fixes to test file.\r\n\r\n* another round of fixup\r\n\r\n---------\r\n\r\nCo-authored-by: sambhavnoobcoder <indosambahv@gmail.com>",
    "sha": "1b57de8dcf2ab25c1b081c23679e2c964ce3da92",
    "files": [
        {
            "sha": "d1d2d2c6a30197b0957cc45605ba59c20e3d7a94",
            "filename": "src/transformers/training_args.py",
            "status": "modified",
            "additions": 14,
            "deletions": 3,
            "changes": 17,
            "blob_url": "https://github.com/huggingface/transformers/blob/1b57de8dcf2ab25c1b081c23679e2c964ce3da92/src%2Ftransformers%2Ftraining_args.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/1b57de8dcf2ab25c1b081c23679e2c964ce3da92/src%2Ftransformers%2Ftraining_args.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Ftraining_args.py?ref=1b57de8dcf2ab25c1b081c23679e2c964ce3da92",
            "patch": "@@ -229,7 +229,7 @@ class TrainingArguments:\n     command line.\n \n     Parameters:\n-        output_dir (`str`):\n+        output_dir (`str`, *optional*, defaults to `\"trainer_output\"`):\n             The output directory where the model predictions and checkpoints will be written.\n         overwrite_output_dir (`bool`, *optional*, defaults to `False`):\n             If `True`, overwrite the content of the output directory. Use this to continue training if `output_dir`\n@@ -814,8 +814,11 @@ class TrainingArguments:\n     \"\"\"\n \n     framework = \"pt\"\n-    output_dir: str = field(\n-        metadata={\"help\": \"The output directory where the model predictions and checkpoints will be written.\"},\n+    output_dir: Optional[str] = field(\n+        default=None,\n+        metadata={\n+            \"help\": \"The output directory where the model predictions and checkpoints will be written. Defaults to 'trainer_output' if not provided.\"\n+        },\n     )\n     overwrite_output_dir: bool = field(\n         default=False,\n@@ -1548,6 +1551,14 @@ class TrainingArguments:\n     )\n \n     def __post_init__(self):\n+        # Set default output_dir if not provided\n+        if self.output_dir is None:\n+            self.output_dir = \"trainer_output\"\n+            logger.info(\n+                \"No output directory specified, defaulting to 'trainer_output'. \"\n+                \"To change this behavior, specify --output_dir when creating TrainingArguments.\"\n+            )\n+\n         # Parse in args that could be `dict` sent in from the CLI as a string\n         for field in _VALID_DICT_FIELDS:\n             passed_value = getattr(self, field)"
        },
        {
            "sha": "7b1daabe1634bd7b3075cf7ddfce2de53662394a",
            "filename": "tests/test_training_args.py",
            "status": "added",
            "additions": 42,
            "deletions": 0,
            "changes": 42,
            "blob_url": "https://github.com/huggingface/transformers/blob/1b57de8dcf2ab25c1b081c23679e2c964ce3da92/tests%2Ftest_training_args.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/1b57de8dcf2ab25c1b081c23679e2c964ce3da92/tests%2Ftest_training_args.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Ftest_training_args.py?ref=1b57de8dcf2ab25c1b081c23679e2c964ce3da92",
            "patch": "@@ -0,0 +1,42 @@\n+import os\n+import tempfile\n+import unittest\n+\n+from transformers import TrainingArguments\n+\n+\n+class TestTrainingArguments(unittest.TestCase):\n+    def test_default_output_dir(self):\n+        \"\"\"Test that output_dir defaults to 'tmp_trainer' when not specified.\"\"\"\n+        args = TrainingArguments(output_dir=None)\n+        self.assertEqual(args.output_dir, \"tmp_trainer\")\n+\n+    def test_custom_output_dir(self):\n+        \"\"\"Test that output_dir is respected when specified.\"\"\"\n+        with tempfile.TemporaryDirectory() as tmp_dir:\n+            args = TrainingArguments(output_dir=tmp_dir)\n+            self.assertEqual(args.output_dir, tmp_dir)\n+\n+    def test_output_dir_creation(self):\n+        \"\"\"Test that output_dir is created only when needed.\"\"\"\n+        with tempfile.TemporaryDirectory() as tmp_dir:\n+            output_dir = os.path.join(tmp_dir, \"test_output\")\n+\n+            # Directory should not exist before creating args\n+            self.assertFalse(os.path.exists(output_dir))\n+\n+            # Create args with save_strategy=\"no\" - should not create directory\n+            args = TrainingArguments(\n+                output_dir=output_dir,\n+                do_train=True,\n+                save_strategy=\"no\",\n+                report_to=None,\n+            )\n+            self.assertFalse(os.path.exists(output_dir))\n+\n+            # Now set save_strategy=\"steps\" - should create directory when needed\n+            args.save_strategy = \"steps\"\n+            args.save_steps = 1\n+            self.assertFalse(os.path.exists(output_dir))  # Still shouldn't exist\n+\n+            # Directory should be created when actually needed (e.g. in Trainer)"
        }
    ],
    "stats": {
        "total": 59,
        "additions": 56,
        "deletions": 3
    }
}