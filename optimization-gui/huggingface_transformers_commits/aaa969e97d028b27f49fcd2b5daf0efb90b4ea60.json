{
    "author": "gante",
    "message": "Remove `pt_to_tf` (#35672)\n\n* rm command\r\n\r\n* remove exception",
    "sha": "aaa969e97d028b27f49fcd2b5daf0efb90b4ea60",
    "files": [
        {
            "sha": "ad0dbd14e15b5611bbf00d7e04cbb67e77af716c",
            "filename": "src/transformers/commands/pt_to_tf.py",
            "status": "removed",
            "additions": 0,
            "deletions": 137,
            "changes": 137,
            "blob_url": "https://github.com/huggingface/transformers/blob/80dbbd103c217f422de91a3265bf6d8e8bc414f7/src%2Ftransformers%2Fcommands%2Fpt_to_tf.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/80dbbd103c217f422de91a3265bf6d8e8bc414f7/src%2Ftransformers%2Fcommands%2Fpt_to_tf.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fcommands%2Fpt_to_tf.py?ref=80dbbd103c217f422de91a3265bf6d8e8bc414f7",
            "patch": "@@ -1,137 +0,0 @@\n-# Copyright 2022 The HuggingFace Team. All rights reserved.\n-#\n-# Licensed under the Apache License, Version 2.0 (the \"License\");\n-# you may not use this file except in compliance with the License.\n-# You may obtain a copy of the License at\n-#\n-#     http://www.apache.org/licenses/LICENSE-2.0\n-#\n-# Unless required by applicable law or agreed to in writing, software\n-# distributed under the License is distributed on an \"AS IS\" BASIS,\n-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n-# See the License for the specific language governing permissions and\n-# limitations under the License.\n-\n-import os\n-from argparse import ArgumentParser, Namespace\n-\n-from ..utils import logging\n-from . import BaseTransformersCLICommand\n-\n-\n-MAX_ERROR = 5e-5  # larger error tolerance than in our internal tests, to avoid flaky user-facing errors\n-\n-\n-def convert_command_factory(args: Namespace):\n-    \"\"\"\n-    Factory function used to convert a model PyTorch checkpoint in a TensorFlow 2 checkpoint.\n-\n-    Returns: ServeCommand\n-    \"\"\"\n-    return PTtoTFCommand(\n-        args.model_name,\n-        args.local_dir,\n-        args.max_error,\n-        args.new_weights,\n-        args.no_pr,\n-        args.push,\n-        args.extra_commit_description,\n-        args.override_model_class,\n-    )\n-\n-\n-class PTtoTFCommand(BaseTransformersCLICommand):\n-    @staticmethod\n-    def register_subcommand(parser: ArgumentParser):\n-        \"\"\"\n-        Register this command to argparse so it's available for the transformer-cli\n-\n-        Args:\n-            parser: Root parser to register command-specific arguments\n-        \"\"\"\n-        train_parser = parser.add_parser(\n-            \"pt-to-tf\",\n-            help=(\n-                \"CLI tool to run convert a transformers model from a PyTorch checkpoint to a TensorFlow checkpoint.\"\n-                \" Can also be used to validate existing weights without opening PRs, with --no-pr.\"\n-            ),\n-        )\n-        train_parser.add_argument(\n-            \"--model-name\",\n-            type=str,\n-            required=True,\n-            help=\"The model name, including owner/organization, as seen on the hub.\",\n-        )\n-        train_parser.add_argument(\n-            \"--local-dir\",\n-            type=str,\n-            default=\"\",\n-            help=\"Optional local directory of the model repository. Defaults to /tmp/{model_name}\",\n-        )\n-        train_parser.add_argument(\n-            \"--max-error\",\n-            type=float,\n-            default=MAX_ERROR,\n-            help=(\n-                f\"Maximum error tolerance. Defaults to {MAX_ERROR}. This flag should be avoided, use at your own risk.\"\n-            ),\n-        )\n-        train_parser.add_argument(\n-            \"--new-weights\",\n-            action=\"store_true\",\n-            help=\"Optional flag to create new TensorFlow weights, even if they already exist.\",\n-        )\n-        train_parser.add_argument(\n-            \"--no-pr\", action=\"store_true\", help=\"Optional flag to NOT open a PR with converted weights.\"\n-        )\n-        train_parser.add_argument(\n-            \"--push\",\n-            action=\"store_true\",\n-            help=\"Optional flag to push the weights directly to `main` (requires permissions)\",\n-        )\n-        train_parser.add_argument(\n-            \"--extra-commit-description\",\n-            type=str,\n-            default=\"\",\n-            help=\"Optional additional commit description to use when opening a PR (e.g. to tag the owner).\",\n-        )\n-        train_parser.add_argument(\n-            \"--override-model-class\",\n-            type=str,\n-            default=None,\n-            help=\"If you think you know better than the auto-detector, you can specify the model class here. \"\n-            \"Can be either an AutoModel class or a specific model class like BertForSequenceClassification.\",\n-        )\n-        train_parser.set_defaults(func=convert_command_factory)\n-\n-    def __init__(\n-        self,\n-        model_name: str,\n-        local_dir: str,\n-        max_error: float,\n-        new_weights: bool,\n-        no_pr: bool,\n-        push: bool,\n-        extra_commit_description: str,\n-        override_model_class: str,\n-        *args,\n-    ):\n-        self._logger = logging.get_logger(\"transformers-cli/pt_to_tf\")\n-        self._model_name = model_name\n-        self._local_dir = local_dir if local_dir else os.path.join(\"/tmp\", model_name)\n-        self._max_error = max_error\n-        self._new_weights = new_weights\n-        self._no_pr = no_pr\n-        self._push = push\n-        self._extra_commit_description = extra_commit_description\n-        self._override_model_class = override_model_class\n-\n-    def run(self):\n-        # TODO (joao): delete file in v4.47\n-        raise NotImplementedError(\n-            \"\\n\\nConverting PyTorch weights to TensorFlow weights was removed in v4.43. \"\n-            \"Instead, we recommend that you convert PyTorch weights to Safetensors, an improved \"\n-            \"format that can be loaded by any framework, including TensorFlow. For more information, \"\n-            \"please see the Safetensors conversion guide: \"\n-            \"https://huggingface.co/docs/safetensors/en/convert-weights\\n\\n\"\n-        )"
        },
        {
            "sha": "8e25eb6e13fe871261351df33e4ecd0db2b0662a",
            "filename": "src/transformers/commands/transformers_cli.py",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/aaa969e97d028b27f49fcd2b5daf0efb90b4ea60/src%2Ftransformers%2Fcommands%2Ftransformers_cli.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/aaa969e97d028b27f49fcd2b5daf0efb90b4ea60/src%2Ftransformers%2Fcommands%2Ftransformers_cli.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fcommands%2Ftransformers_cli.py?ref=aaa969e97d028b27f49fcd2b5daf0efb90b4ea60",
            "patch": "@@ -20,7 +20,6 @@\n from .download import DownloadCommand\n from .env import EnvironmentCommand\n from .lfs import LfsCommands\n-from .pt_to_tf import PTtoTFCommand\n from .run import RunCommand\n from .serving import ServeCommand\n from .user import UserCommands\n@@ -39,7 +38,6 @@ def main():\n     UserCommands.register_subcommand(commands_parser)\n     AddNewModelLikeCommand.register_subcommand(commands_parser)\n     LfsCommands.register_subcommand(commands_parser)\n-    PTtoTFCommand.register_subcommand(commands_parser)\n \n     # Let's go\n     args = parser.parse_args()"
        },
        {
            "sha": "0d05b105a4dc575262dc589d5b475ab602297f69",
            "filename": "utils/not_doctested.txt",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/huggingface/transformers/blob/aaa969e97d028b27f49fcd2b5daf0efb90b4ea60/utils%2Fnot_doctested.txt",
            "raw_url": "https://github.com/huggingface/transformers/raw/aaa969e97d028b27f49fcd2b5daf0efb90b4ea60/utils%2Fnot_doctested.txt",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/utils%2Fnot_doctested.txt?ref=aaa969e97d028b27f49fcd2b5daf0efb90b4ea60",
            "patch": "@@ -351,7 +351,6 @@ src/transformers/commands/convert.py\n src/transformers/commands/download.py\n src/transformers/commands/env.py\n src/transformers/commands/lfs.py\n-src/transformers/commands/pt_to_tf.py\n src/transformers/commands/run.py\n src/transformers/commands/serving.py\n src/transformers/commands/train.py"
        }
    ],
    "stats": {
        "total": 140,
        "additions": 0,
        "deletions": 140
    }
}