{
    "author": "yao-matrix",
    "message": "fix prepare_config_and_inputs_for_common bug in llava test (#41942)\n\nfix bug\n\nSigned-off-by: Yao, Matrix <matrix.yao@intel.com>",
    "sha": "90d1b67db1ecf15a631b8020d412bfbee2f0206c",
    "files": [
        {
            "sha": "8af99c47187e99407dc8d12148fac6ef35b755ba",
            "filename": "tests/models/llava/test_modeling_llava.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/huggingface/transformers/blob/90d1b67db1ecf15a631b8020d412bfbee2f0206c/tests%2Fmodels%2Fllava%2Ftest_modeling_llava.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/90d1b67db1ecf15a631b8020d412bfbee2f0206c/tests%2Fmodels%2Fllava%2Ftest_modeling_llava.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Fmodels%2Fllava%2Ftest_modeling_llava.py?ref=90d1b67db1ecf15a631b8020d412bfbee2f0206c",
            "patch": "@@ -152,10 +152,11 @@ def prepare_config_and_inputs(self):\n     def prepare_config_and_inputs_for_common(self):\n         config_and_inputs = self.prepare_config_and_inputs()\n         config, pixel_values = config_and_inputs\n-        input_ids = ids_tensor([self.batch_size, self.seq_length], config.text_config.vocab_size - 1) + 1\n+\n+        input_ids = ids_tensor([self.batch_size, self.seq_length], config.text_config.vocab_size - 2) + 2\n+        attention_mask = torch.ones(input_ids.shape, dtype=torch.long).to(torch_device)\n         input_ids[input_ids == config.image_token_index] = self.pad_token_id\n         input_ids[:, : self.num_image_tokens] = config.image_token_index\n-        attention_mask = input_ids.ne(1).to(torch_device)\n \n         inputs_dict = {\n             \"pixel_values\": pixel_values,"
        }
    ],
    "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
    }
}