{
    "author": "ydshieh",
    "message": "unpin `torchcodec==0.5.0` and use `torch 2.8` on daily CI (#40072)\n\nfix\n\nCo-authored-by: ydshieh <ydshieh@users.noreply.github.com>",
    "sha": "99c747539e07b2e141cb5f13961b72108e9dc864",
    "files": [
        {
            "sha": "cf7248d628da4f2f05fe8ebd90d6a917d7c19950",
            "filename": "docker/transformers-all-latest-gpu/Dockerfile",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/99c747539e07b2e141cb5f13961b72108e9dc864/docker%2Ftransformers-all-latest-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/99c747539e07b2e141cb5f13961b72108e9dc864/docker%2Ftransformers-all-latest-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-all-latest-gpu%2FDockerfile?ref=99c747539e07b2e141cb5f13961b72108e9dc864",
            "patch": "@@ -9,7 +9,7 @@ SHELL [\"sh\", \"-lc\"]\n # The following `ARG` are mainly used to specify the versions explicitly & directly in this docker file, and not meant\n # to be used as arguments for docker build (so far).\n \n-ARG PYTORCH='2.7.1'\n+ARG PYTORCH='2.8.0'\n # Example: `cu102`, `cu113`, etc.\n ARG CUDA='cu126'\n # Disable kernel mapping for now until all tests pass\n@@ -26,7 +26,7 @@ RUN git clone https://github.com/huggingface/transformers && cd transformers &&\n # 1. Put several commands in a single `RUN` to avoid image/layer exporting issue. Could be revised in the future.\n # 2. Regarding `torch` part, We might need to specify proper versions for `torchvision` and `torchaudio`.\n #    Currently, let's not bother to specify their versions explicitly (so installed with their latest release versions).\n-RUN python3 -m pip install --no-cache-dir -e ./transformers[dev,onnxruntime] && [ ${#PYTORCH} -gt 0 -a \"$PYTORCH\" != \"pre\" ] && VERSION='torch=='$PYTORCH'.*' ||  VERSION='torch'; echo \"export VERSION='$VERSION'\" >> ~/.profile && echo torch=$VERSION && [ \"$PYTORCH\" != \"pre\" ] && python3 -m pip install --no-cache-dir -U $VERSION torchvision torchaudio torchcodec==0.5.0 --extra-index-url https://download.pytorch.org/whl/$CUDA || python3 -m pip install --no-cache-dir -U --pre torch torchvision torchaudio torchcodec --extra-index-url https://download.pytorch.org/whl/nightly/$CUDA && python3 -m pip uninstall -y tensorflow tensorflow_text tensorflow_probability\n+RUN python3 -m pip install --no-cache-dir -e ./transformers[dev,onnxruntime] && [ ${#PYTORCH} -gt 0 -a \"$PYTORCH\" != \"pre\" ] && VERSION='torch=='$PYTORCH'.*' ||  VERSION='torch'; echo \"export VERSION='$VERSION'\" >> ~/.profile && echo torch=$VERSION && [ \"$PYTORCH\" != \"pre\" ] && python3 -m pip install --no-cache-dir -U $VERSION torchvision torchaudio torchcodec --extra-index-url https://download.pytorch.org/whl/$CUDA || python3 -m pip install --no-cache-dir -U --pre torch torchvision torchaudio torchcodec --extra-index-url https://download.pytorch.org/whl/nightly/$CUDA && python3 -m pip uninstall -y tensorflow tensorflow_text tensorflow_probability\n \n RUN python3 -m pip uninstall -y flax jax\n "
        },
        {
            "sha": "41611b350def58875f435e649b43f95d46d65ed0",
            "filename": "docker/transformers-pytorch-deepspeed-latest-gpu/Dockerfile",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/99c747539e07b2e141cb5f13961b72108e9dc864/docker%2Ftransformers-pytorch-deepspeed-latest-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/99c747539e07b2e141cb5f13961b72108e9dc864/docker%2Ftransformers-pytorch-deepspeed-latest-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-pytorch-deepspeed-latest-gpu%2FDockerfile?ref=99c747539e07b2e141cb5f13961b72108e9dc864",
            "patch": "@@ -4,7 +4,7 @@ LABEL maintainer=\"Hugging Face\"\n \n ARG DEBIAN_FRONTEND=noninteractive\n \n-ARG PYTORCH='2.7.1'\n+ARG PYTORCH='2.8.0'\n # Example: `cu102`, `cu113`, etc.\n ARG CUDA='cu126'\n \n@@ -21,7 +21,7 @@ RUN python3 -m pip install --no-cache-dir './transformers[deepspeed-testing]' 'p\n # Install latest release PyTorch\n # (PyTorch must be installed before pre-compiling any DeepSpeed c++/cuda ops.)\n # (https://www.deepspeed.ai/tutorials/advanced-install/#pre-install-deepspeed-ops)\n-RUN python3 -m pip uninstall -y torch torchvision torchaudio && python3 -m pip install --no-cache-dir -U torch==$PYTORCH torchvision torchaudio torchcodec==0.5.0 --extra-index-url https://download.pytorch.org/whl/$CUDA\n+RUN python3 -m pip uninstall -y torch torchvision torchaudio && python3 -m pip install --no-cache-dir -U torch==$PYTORCH torchvision torchaudio torchcodec --extra-index-url https://download.pytorch.org/whl/$CUDA\n \n RUN python3 -m pip install --no-cache-dir git+https://github.com/huggingface/accelerate@main#egg=accelerate\n "
        },
        {
            "sha": "3a8ca977354f7561cb4e5aa3aeba418c78cbe98f",
            "filename": "docker/transformers-pytorch-deepspeed-nightly-gpu/Dockerfile",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/99c747539e07b2e141cb5f13961b72108e9dc864/docker%2Ftransformers-pytorch-deepspeed-nightly-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/99c747539e07b2e141cb5f13961b72108e9dc864/docker%2Ftransformers-pytorch-deepspeed-nightly-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-pytorch-deepspeed-nightly-gpu%2FDockerfile?ref=99c747539e07b2e141cb5f13961b72108e9dc864",
            "patch": "@@ -19,7 +19,7 @@ RUN python3 -m pip uninstall -y torch torchvision torchaudio\n # Install **nightly** release PyTorch (flag `--pre`)\n # (PyTorch must be installed before pre-compiling any DeepSpeed c++/cuda ops.)\n # (https://www.deepspeed.ai/tutorials/advanced-install/#pre-install-deepspeed-ops)\n-RUN python3 -m pip install --no-cache-dir -U --pre torch torchvision torchaudio torchcodec==0.5.0 --extra-index-url https://download.pytorch.org/whl/nightly/$CUDA\n+RUN python3 -m pip install --no-cache-dir -U --pre torch torchvision torchaudio torchcodec --extra-index-url https://download.pytorch.org/whl/nightly/$CUDA\n \n # `datasets` requires pandas, pandas has some modules compiled with numpy=1.x causing errors\n RUN python3 -m pip install --no-cache-dir './transformers[deepspeed-testing]' 'pandas<2' 'numpy<2'"
        },
        {
            "sha": "5909ac436525fd98707545c339849096a804591c",
            "filename": "docker/transformers-pytorch-gpu/Dockerfile",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/99c747539e07b2e141cb5f13961b72108e9dc864/docker%2Ftransformers-pytorch-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/99c747539e07b2e141cb5f13961b72108e9dc864/docker%2Ftransformers-pytorch-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-pytorch-gpu%2FDockerfile?ref=99c747539e07b2e141cb5f13961b72108e9dc864",
            "patch": "@@ -11,7 +11,7 @@ ARG REF=main\n RUN git clone https://github.com/huggingface/transformers && cd transformers && git checkout $REF\n \n # If set to nothing, will install the latest version\n-ARG PYTORCH='2.7.1'\n+ARG PYTORCH='2.8.0'\n ARG TORCH_VISION=''\n ARG TORCH_AUDIO=''\n # Example: `cu102`, `cu113`, etc."
        }
    ],
    "stats": {
        "total": 12,
        "additions": 6,
        "deletions": 6
    }
}