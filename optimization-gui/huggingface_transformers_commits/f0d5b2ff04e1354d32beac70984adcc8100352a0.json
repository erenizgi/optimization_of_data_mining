{
    "author": "rasmi",
    "message": "Update deprecated Jax calls (#35919)\n\n* Remove deprecated arguments for jax.numpy.clip.\n\n* Remove deprecated arguments for jax.numpy.clip.\n\n* Update jax version to 0.4.27 to 0.4.38.\n\n* Avoid use of deprecated xla_bridge.get_backend().platform\n\nCo-authored-by: Jake Vanderplas <jakevdp@google.com>\n\n---------\n\nCo-authored-by: Jake Vanderplas <jakevdp@google.com>",
    "sha": "f0d5b2ff04e1354d32beac70984adcc8100352a0",
    "files": [
        {
            "sha": "5f1e40f767f05354ede6f8250e943d3114a4a46a",
            "filename": "setup.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/f0d5b2ff04e1354d32beac70984adcc8100352a0/setup.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/f0d5b2ff04e1354d32beac70984adcc8100352a0/setup.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/setup.py?ref=f0d5b2ff04e1354d32beac70984adcc8100352a0",
            "patch": "@@ -121,8 +121,8 @@\n     \"importlib_metadata\",\n     \"ipadic>=1.0.0,<2.0\",\n     \"isort>=5.5.4\",\n-    \"jax>=0.4.1,<=0.4.13\",\n-    \"jaxlib>=0.4.1,<=0.4.13\",\n+    \"jax>=0.4.27,<=0.4.38\",\n+    \"jaxlib>=0.4.27,<=0.4.38\",\n     \"jieba\",\n     \"jinja2>=3.1.0\",\n     \"kenlm\","
        },
        {
            "sha": "ea30526a24ea3d500ad2e495805466a8d68a1f9c",
            "filename": "src/transformers/commands/env.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/f0d5b2ff04e1354d32beac70984adcc8100352a0/src%2Ftransformers%2Fcommands%2Fenv.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/f0d5b2ff04e1354d32beac70984adcc8100352a0/src%2Ftransformers%2Fcommands%2Fenv.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fcommands%2Fenv.py?ref=f0d5b2ff04e1354d32beac70984adcc8100352a0",
            "patch": "@@ -129,7 +129,7 @@ def run(self):\n             flax_version = flax.__version__\n             jax_version = jax.__version__\n             jaxlib_version = jaxlib.__version__\n-            jax_backend = jax.lib.xla_bridge.get_backend().platform\n+            jax_backend = jax.default_backend()\n \n         info = {\n             \"`transformers` version\": version,"
        },
        {
            "sha": "f63990f771566af1897e12f15e868cf9dff7f257",
            "filename": "src/transformers/dependency_versions_table.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/f0d5b2ff04e1354d32beac70984adcc8100352a0/src%2Ftransformers%2Fdependency_versions_table.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/f0d5b2ff04e1354d32beac70984adcc8100352a0/src%2Ftransformers%2Fdependency_versions_table.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fdependency_versions_table.py?ref=f0d5b2ff04e1354d32beac70984adcc8100352a0",
            "patch": "@@ -28,8 +28,8 @@\n     \"importlib_metadata\": \"importlib_metadata\",\n     \"ipadic\": \"ipadic>=1.0.0,<2.0\",\n     \"isort\": \"isort>=5.5.4\",\n-    \"jax\": \"jax>=0.4.1,<=0.4.13\",\n-    \"jaxlib\": \"jaxlib>=0.4.1,<=0.4.13\",\n+    \"jax\": \"jax>=0.4.27,<=0.4.38\",\n+    \"jaxlib\": \"jaxlib>=0.4.27,<=0.4.38\",\n     \"jieba\": \"jieba\",\n     \"jinja2\": \"jinja2>=3.1.0\",\n     \"kenlm\": \"kenlm\","
        },
        {
            "sha": "4b2378cc38560c7bd8a4feb5affdc693d16513eb",
            "filename": "src/transformers/models/longt5/modeling_flax_longt5.py",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/huggingface/transformers/blob/f0d5b2ff04e1354d32beac70984adcc8100352a0/src%2Ftransformers%2Fmodels%2Flongt5%2Fmodeling_flax_longt5.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/f0d5b2ff04e1354d32beac70984adcc8100352a0/src%2Ftransformers%2Fmodels%2Flongt5%2Fmodeling_flax_longt5.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Flongt5%2Fmodeling_flax_longt5.py?ref=f0d5b2ff04e1354d32beac70984adcc8100352a0",
            "patch": "@@ -387,7 +387,7 @@ def _relative_position_bucket(relative_position, bidirectional=True, num_buckets\n             relative_buckets += (relative_position > 0) * num_buckets\n             relative_position = jnp.abs(relative_position)\n         else:\n-            relative_position = -jnp.clip(relative_position, a_max=0)\n+            relative_position = -jnp.clip(relative_position, max=0)\n         # now relative_position is in the range [0, inf)\n \n         # half of the buckets are for exact increments in positions\n@@ -398,7 +398,7 @@ def _relative_position_bucket(relative_position, bidirectional=True, num_buckets\n         relative_position_if_large = max_exact + (\n             jnp.log(relative_position / max_exact) / jnp.log(max_distance / max_exact) * (num_buckets - max_exact)\n         )\n-        relative_position_if_large = jnp.clip(relative_position_if_large, a_max=num_buckets - 1)\n+        relative_position_if_large = jnp.clip(relative_position_if_large, max=num_buckets - 1)\n \n         relative_buckets += jnp.where(is_small, relative_position, relative_position_if_large)\n \n@@ -672,7 +672,7 @@ def _relative_position_bucket(relative_position, bidirectional=True, num_buckets\n             relative_buckets += (relative_position > 0) * num_buckets\n             relative_position = jnp.abs(relative_position)\n         else:\n-            relative_position = -jnp.clip(relative_position, a_max=0)\n+            relative_position = -jnp.clip(relative_position, max=0)\n         # now relative_position is in the range [0, inf)\n \n         # half of the buckets are for exact increments in positions\n@@ -683,7 +683,7 @@ def _relative_position_bucket(relative_position, bidirectional=True, num_buckets\n         relative_position_if_large = max_exact + (\n             jnp.log(relative_position / max_exact) / jnp.log(max_distance / max_exact) * (num_buckets - max_exact)\n         )\n-        relative_position_if_large = jnp.clip(relative_position_if_large, a_max=num_buckets - 1)\n+        relative_position_if_large = jnp.clip(relative_position_if_large, max=num_buckets - 1)\n \n         relative_buckets += jnp.where(is_small, relative_position, relative_position_if_large)\n \n@@ -895,7 +895,7 @@ def _relative_position_bucket(relative_position, bidirectional=True, num_buckets\n             relative_buckets += (relative_position > 0) * num_buckets\n             relative_position = jnp.abs(relative_position)\n         else:\n-            relative_position = -jnp.clip(relative_position, a_max=0)\n+            relative_position = -jnp.clip(relative_position, max=0)\n         # now relative_position is in the range [0, inf)\n \n         # half of the buckets are for exact increments in positions\n@@ -906,7 +906,7 @@ def _relative_position_bucket(relative_position, bidirectional=True, num_buckets\n         relative_position_if_large = max_exact + (\n             jnp.log(relative_position / max_exact) / jnp.log(max_distance / max_exact) * (num_buckets - max_exact)\n         )\n-        relative_position_if_large = jnp.clip(relative_position_if_large, a_max=num_buckets - 1)\n+        relative_position_if_large = jnp.clip(relative_position_if_large, max=num_buckets - 1)\n \n         relative_buckets += jnp.where(is_small, relative_position, relative_position_if_large)\n "
        },
        {
            "sha": "1eb6d208a9fdcbce3d3bf45fa3d6de5a2fedc644",
            "filename": "src/transformers/models/t5/modeling_flax_t5.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/f0d5b2ff04e1354d32beac70984adcc8100352a0/src%2Ftransformers%2Fmodels%2Ft5%2Fmodeling_flax_t5.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/f0d5b2ff04e1354d32beac70984adcc8100352a0/src%2Ftransformers%2Fmodels%2Ft5%2Fmodeling_flax_t5.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Ft5%2Fmodeling_flax_t5.py?ref=f0d5b2ff04e1354d32beac70984adcc8100352a0",
            "patch": "@@ -247,7 +247,7 @@ def _relative_position_bucket(relative_position, bidirectional=True, num_buckets\n             relative_buckets += (relative_position > 0) * num_buckets\n             relative_position = jnp.abs(relative_position)\n         else:\n-            relative_position = -jnp.clip(relative_position, a_max=0)\n+            relative_position = -jnp.clip(relative_position, max=0)\n         # now relative_position is in the range [0, inf)\n \n         # half of the buckets are for exact increments in positions\n@@ -258,7 +258,7 @@ def _relative_position_bucket(relative_position, bidirectional=True, num_buckets\n         relative_position_if_large = max_exact + (\n             jnp.log(relative_position / max_exact) / jnp.log(max_distance / max_exact) * (num_buckets - max_exact)\n         )\n-        relative_position_if_large = jnp.clip(relative_position_if_large, a_max=num_buckets - 1)\n+        relative_position_if_large = jnp.clip(relative_position_if_large, max=num_buckets - 1)\n \n         relative_buckets += jnp.where(is_small, relative_position, relative_position_if_large)\n "
        }
    ],
    "stats": {
        "total": 26,
        "additions": 13,
        "deletions": 13
    }
}