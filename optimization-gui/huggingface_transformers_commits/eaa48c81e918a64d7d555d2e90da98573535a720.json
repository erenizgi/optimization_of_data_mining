{
    "author": "yao-matrix",
    "message": "make model docs device agnostic (2) (#40256)\n\n* doc cont.\n\nSigned-off-by: Yao, Matrix <matrix.yao@intel.com>\n\n* more models\n\nSigned-off-by: Yao, Matrix <matrix.yao@intel.com>\n\n* Update docs/source/en/quicktour.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/quicktour.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/quicktour.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/quicktour.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update mixtral.md\n\n---------\n\nSigned-off-by: Yao, Matrix <matrix.yao@intel.com>\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>",
    "sha": "eaa48c81e918a64d7d555d2e90da98573535a720",
    "files": [
        {
            "sha": "0a4850499d9dfe01c1e064c53f64ad3d16656734",
            "filename": "docs/source/en/model_doc/bart.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbart.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbart.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fbart.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -65,7 +65,7 @@ model = AutoModelForMaskedLM.from_pretrained(\n     device_map=\"auto\",\n     attn_implementation=\"sdpa\"\n )\n-inputs = tokenizer(\"Plants create <mask> through a process known as photosynthesis.\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"Plants create <mask> through a process known as photosynthesis.\", return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)"
        },
        {
            "sha": "2193c9d6ffc89cad2d26271a7c9f76df00040607",
            "filename": "docs/source/en/model_doc/barthez.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbarthez.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbarthez.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fbarthez.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -68,7 +68,7 @@ model = AutoModelForMaskedLM.from_pretrained(\n     torch_dtype=torch.float16,\n     device_map=\"auto\",\n )\n-inputs = tokenizer(\"Les plantes produisent <mask> grâce à un processus appelé photosynthèse.\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"Les plantes produisent <mask> grâce à un processus appelé photosynthèse.\", return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)"
        },
        {
            "sha": "14fed2b4aae866853f3395aeff025fb0584ebd16",
            "filename": "docs/source/en/model_doc/bartpho.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbartpho.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbartpho.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fbartpho.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -82,7 +82,7 @@ Quang tổng hợp hay gọi tắt là quang hợp là quá trình thu nhận v\n tảo và một số vi khuẩn để tạo ra hợp chất hữu cơ phục vụ bản thân cũng như làm nguồn thức ăn cho hầu hết các sinh vật \n trên Trái Đất. Quang hợp trong thực vật thường liên quan đến chất tố diệp lục màu xanh lá cây và tạo ra oxy như một sản phẩm phụ\n \"\"\"\n-inputs = tokenizer(text, return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(text, return_tensors=\"pt\").to(model.device)\n \n outputs = model.generate(inputs[\"input_ids\"], num_beams=2, min_length=0, max_length=20)\n tokenizer.batch_decode(outputs, skip_special_tokens=True, clean_up_tokenization_spaces=False)[0]"
        },
        {
            "sha": "164c2859cd76e913698c24de8b5d10926e662e95",
            "filename": "docs/source/en/model_doc/bertweet.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbertweet.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbertweet.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fbertweet.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -67,7 +67,7 @@ model = AutoModelForMaskedLM.from_pretrained(\n     torch_dtype=torch.float16,\n     device_map=\"auto\"\n )\n-inputs = tokenizer(\"Plants create <mask> through a process known as photosynthesis.\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"Plants create <mask> through a process known as photosynthesis.\", return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)"
        },
        {
            "sha": "0a8b00bab84f8a3aa1c13560a024f24038025878",
            "filename": "docs/source/en/model_doc/big_bird.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbig_bird.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbig_bird.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fbig_bird.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -64,7 +64,7 @@ model = AutoModelForMaskedLM.from_pretrained(\n     torch_dtype=torch.float16,\n     device_map=\"auto\",\n )\n-inputs = tokenizer(\"Plants create [MASK] through a process known as photosynthesis.\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"Plants create [MASK] through a process known as photosynthesis.\", return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)"
        },
        {
            "sha": "a629c0367fec67824bc40dcc57985a5c62e8197a",
            "filename": "docs/source/en/model_doc/bigbird_pegasus.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbigbird_pegasus.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fbigbird_pegasus.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fbigbird_pegasus.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -72,7 +72,7 @@ input_text = \"\"\"Plants are among the most remarkable and essential life forms on\n Through photosynthesis, plants capture energy from sunlight using a green pigment called chlorophyll, which is located in specialized cell structures called chloroplasts. In the presence of light, plants absorb carbon dioxide from the atmosphere through small pores in their leaves called stomata, and take in water from the soil through their root systems.\n These ingredients are then transformed into glucose, a type of sugar that serves as a source of chemical energy, and oxygen, which is released as a byproduct into the atmosphere. The glucose produced during photosynthesis is not just used immediately; plants also store it as starch or convert it into other organic compounds like cellulose, which is essential for building their cellular structure.\n This energy reserve allows them to grow, develop leaves, produce flowers, bear fruit, and carry out various physiological processes throughout their lifecycle.\"\"\"\n-input_ids = tokenizer(input_text, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(input_text, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))\n@@ -115,7 +115,7 @@ input_text = \"\"\"Plants are among the most remarkable and essential life forms on\n Through photosynthesis, plants capture energy from sunlight using a green pigment called chlorophyll, which is located in specialized cell structures called chloroplasts. In the presence of light, plants absorb carbon dioxide from the atmosphere through small pores in their leaves called stomata, and take in water from the soil through their root systems.\n These ingredients are then transformed into glucose, a type of sugar that serves as a source of chemical energy, and oxygen, which is released as a byproduct into the atmosphere. The glucose produced during photosynthesis is not just used immediately; plants also store it as starch or convert it into other organic compounds like cellulose, which is essential for building their cellular structure.\n This energy reserve allows them to grow, develop leaves, produce flowers, bear fruit, and carry out various physiological processes throughout their lifecycle.\"\"\"\n-input_ids = tokenizer(input_text, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(input_text, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "5273589a1454c0a31017651f59d06dbe6be907f8",
            "filename": "docs/source/en/model_doc/blip.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fblip.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fblip.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fblip.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -73,7 +73,7 @@ url = \"https://huggingface.co/datasets/huggingface/documentation-images/resolve/\n image = Image.open(requests.get(url, stream=True).raw)\n \n question = \"What is the weather in this image?\"\n-inputs = processor(images=image, text=question, return_tensors=\"pt\").to(\"cuda\", torch.float16)\n+inputs = processor(images=image, text=question, return_tensors=\"pt\").to(model.device, torch.float16)\n \n output = model.generate(**inputs)\n processor.batch_decode(output, skip_special_tokens=True)[0]"
        },
        {
            "sha": "43b12aef1648b2041e43b1703569e49bb4251d0d",
            "filename": "docs/source/en/model_doc/clap.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fclap.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fclap.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fclap.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -48,7 +48,7 @@ tokenizer = AutoTokenizer.from_pretrained(\"laion/clap-htsat-unfused\")\n \n texts = [\"the sound of a cat\", \"the sound of a dog\", \"music playing\"]\n \n-inputs = tokenizer(texts, padding=True, return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(texts, padding=True, return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     text_features = model.get_text_features(**inputs)"
        },
        {
            "sha": "9a3a0f522aa03624bcf4abf481f0e872db7dd960",
            "filename": "docs/source/en/model_doc/code_llama.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fcode_llama.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fcode_llama.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fcode_llama.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -74,7 +74,7 @@ model = AutoModelForCausalLM.from_pretrained(\n \n # basic code generation\n prompt = \"# Function to calculate the factorial of a number\\ndef factorial(n):\"\n-input_ids = tokenizer(prompt, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(prompt, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(\n     **input_ids,\n@@ -121,7 +121,7 @@ model = AutoModelForCausalLM.from_pretrained(\n )\n \n prompt = \"# Write a Python function to check if a string is a palindrome\\ndef is_palindrome(s):\"\n-input_ids = tokenizer(prompt, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(prompt, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, max_new_tokens=200, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "57d42f7f32abfe68d0e473876254c35790073069",
            "filename": "docs/source/en/model_doc/csm.md",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fcsm.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fcsm.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fcsm.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -38,10 +38,10 @@ CSM can be used to simply generate speech from a text prompt:\n \n ```python\n import torch\n-from transformers import CsmForConditionalGeneration, AutoProcessor\n+from transformers import CsmForConditionalGeneration, AutoProcessor, infer_device\n \n model_id = \"sesame/csm-1b\"\n-device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+device = infer_device()\n \n # load the model and the processor\n processor = AutoProcessor.from_pretrained(model_id)\n@@ -72,11 +72,11 @@ CSM can be used to generate speech given a conversation, allowing consistency in\n \n ```python\n import torch\n-from transformers import CsmForConditionalGeneration, AutoProcessor\n+from transformers import CsmForConditionalGeneration, AutoProcessor, infer_device\n from datasets import load_dataset, Audio\n \n model_id = \"sesame/csm-1b\"\n-device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+device = infer_device()\n \n # load the model and the processor\n processor = AutoProcessor.from_pretrained(model_id)\n@@ -117,11 +117,11 @@ CSM supports batched inference!\n \n ```python\n import torch\n-from transformers import CsmForConditionalGeneration, AutoProcessor\n+from transformers import CsmForConditionalGeneration, AutoProcessor, infer_device\n from datasets import load_dataset, Audio\n \n model_id = \"sesame/csm-1b\"\n-device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+device = infer_device()\n \n # load the model and the processor\n processor = AutoProcessor.from_pretrained(model_id)\n@@ -306,11 +306,11 @@ print(\"=\"*50)\n CSM Transformers integration supports training!\n \n ```python\n-from transformers import CsmForConditionalGeneration, AutoProcessor\n+from transformers import CsmForConditionalGeneration, AutoProcessor, infer_device\n from datasets import load_dataset, Audio\n \n model_id = \"sesame/csm-1b\"\n-device = \"cuda\"\n+device = infer_device()\n \n # load the model and the processor\n processor = AutoProcessor.from_pretrained(model_id)"
        },
        {
            "sha": "b247668cc4efb7d84584b66526e0603435040929",
            "filename": "docs/source/en/model_doc/cvt.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fcvt.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fcvt.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fcvt.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -69,7 +69,7 @@ model = AutoModelForImageClassification.from_pretrained(\n \n url = \"https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/pipeline-cat-chonk.jpeg\"\n image = Image.open(requests.get(url, stream=True).raw)\n-inputs = image_processor(image, return_tensors=\"pt\").to(\"cuda\")\n+inputs = image_processor(image, return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n   logits = model(**inputs).logits"
        },
        {
            "sha": "3647e4196cdf0e213ce064e827a245fd9775f111",
            "filename": "docs/source/en/model_doc/dbrx.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdbrx.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdbrx.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fdbrx.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -58,7 +58,7 @@ model = DbrxForCausalLM.from_pretrained(\n \n input_text = \"What does it take to build a great LLM?\"\n messages = [{\"role\": \"user\", \"content\": input_text}]\n-input_ids = tokenizer.apply_chat_template(messages, return_dict=True, tokenize=True, add_generation_prompt=True, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer.apply_chat_template(messages, return_dict=True, tokenize=True, add_generation_prompt=True, return_tensors=\"pt\").to(model.device)\n \n outputs = model.generate(**input_ids, max_new_tokens=200)\n print(tokenizer.decode(outputs[0]))\n@@ -80,7 +80,7 @@ model = DbrxForCausalLM.from_pretrained(\n \n input_text = \"What does it take to build a great LLM?\"\n messages = [{\"role\": \"user\", \"content\": input_text}]\n-input_ids = tokenizer.apply_chat_template(messages, return_dict=True, tokenize=True, add_generation_prompt=True, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer.apply_chat_template(messages, return_dict=True, tokenize=True, add_generation_prompt=True, return_tensors=\"pt\").to(model.device)\n \n outputs = model.generate(**input_ids, max_new_tokens=200)\n print(tokenizer.decode(outputs[0]))\n@@ -102,7 +102,7 @@ model = DbrxForCausalLM.from_pretrained(\n \n input_text = \"What does it take to build a great LLM?\"\n messages = [{\"role\": \"user\", \"content\": input_text}]\n-input_ids = tokenizer.apply_chat_template(messages, return_dict=True, tokenize=True, add_generation_prompt=True, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer.apply_chat_template(messages, return_dict=True, tokenize=True, add_generation_prompt=True, return_tensors=\"pt\").to(model.device)\n \n outputs = model.generate(**input_ids, max_new_tokens=200)\n print(tokenizer.decode(outputs[0]))"
        },
        {
            "sha": "db0d27d1d308577852a9e02a93b939ce6d13719e",
            "filename": "docs/source/en/model_doc/depth_pro.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdepth_pro.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdepth_pro.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fdepth_pro.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -46,17 +46,17 @@ The DepthPro model processes an input image by first downsampling it at multiple\n >>> import requests\n >>> from PIL import Image\n >>> import torch\n->>> from transformers import DepthProImageProcessorFast, DepthProForDepthEstimation\n+>>> from transformers import DepthProImageProcessorFast, DepthProForDepthEstimation, infer_device\n \n->>> device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n+>>> device = infer_device()\n \n >>> url = 'http://images.cocodataset.org/val2017/000000039769.jpg'\n >>> image = Image.open(requests.get(url, stream=True).raw)\n \n >>> image_processor = DepthProImageProcessorFast.from_pretrained(\"apple/DepthPro-hf\")\n >>> model = DepthProForDepthEstimation.from_pretrained(\"apple/DepthPro-hf\").to(device)\n \n->>> inputs = image_processor(images=image, return_tensors=\"pt\").to(device)\n+>>> inputs = image_processor(images=image, return_tensors=\"pt\").to(model.device)\n \n >>> with torch.no_grad():\n ...     outputs = model(**inputs)"
        },
        {
            "sha": "1a07e8831ee7eb9b7bf9d85c10df3d6140c2904e",
            "filename": "docs/source/en/model_doc/dia.md",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdia.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdia.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fdia.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -42,9 +42,9 @@ tokens and decodes them back into audio.\n ### Generation with Text\n \n ```python\n-from transformers import AutoProcessor, DiaForConditionalGeneration\n+from transformers import AutoProcessor, DiaForConditionalGeneration, infer_device\n \n-torch_device = \"cuda\"\n+torch_device = infer_device()\n model_checkpoint = \"nari-labs/Dia-1.6B-0626\"\n \n text = [\"[S1] Dia is an open weights text to dialogue model.\"]\n@@ -64,9 +64,9 @@ processor.save_audio(outputs, \"example.wav\")\n \n ```python\n from datasets import load_dataset, Audio\n-from transformers import AutoProcessor, DiaForConditionalGeneration\n+from transformers import AutoProcessor, DiaForConditionalGeneration, infer_device\n \n-torch_device = \"cuda\"\n+torch_device = infer_device()\n model_checkpoint = \"nari-labs/Dia-1.6B-0626\"\n \n ds = load_dataset(\"hf-internal-testing/dailytalk-dummy\", split=\"train\")\n@@ -91,9 +91,9 @@ processor.save_audio(outputs, \"example_with_audio.wav\")\n \n ```python\n from datasets import load_dataset, Audio\n-from transformers import AutoProcessor, DiaForConditionalGeneration\n+from transformers import AutoProcessor, DiaForConditionalGeneration, infer_device\n \n-torch_device = \"cuda\"\n+torch_device = infer_device()\n model_checkpoint = \"nari-labs/Dia-1.6B-0626\"\n \n ds = load_dataset(\"hf-internal-testing/dailytalk-dummy\", split=\"train\")"
        },
        {
            "sha": "254cdc7008e8e795a395b3ef50a32eb2343b14a2",
            "filename": "docs/source/en/model_doc/distilbert.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdistilbert.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdistilbert.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fdistilbert.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -72,7 +72,7 @@ model = AutoModelForSequenceClassification.from_pretrained(\n     device_map=\"auto\",\n     attn_implementation=\"sdpa\"\n )\n-inputs = tokenizer(\"I love using Hugging Face Transformers!\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"I love using Hugging Face Transformers!\", return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)"
        },
        {
            "sha": "736b41f91af2a94b809b8bcc40713479e37e074c",
            "filename": "docs/source/en/model_doc/dit.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdit.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fdit.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fdit.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -70,7 +70,7 @@ model = AutoModelForImageClassification.from_pretrained(\n )\n url = \"https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/transformers/model_doc/dit-example.jpg\"\n image = Image.open(requests.get(url, stream=True).raw)\n-inputs = image_processor(image, return_tensors=\"pt\").to(\"cuda\")\n+inputs = image_processor(image, return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n   logits = model(**inputs).logits"
        },
        {
            "sha": "ff227c3e3882a42979f7a961c227766fbbb93d49",
            "filename": "docs/source/en/model_doc/gemma2.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fgemma2.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fgemma2.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fgemma2.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -52,7 +52,7 @@ pipe = pipeline(\n     task=\"text-generation\",\n     model=\"google/gemma-2-9b\",\n     torch_dtype=torch.bfloat16,\n-    device=\"cuda\",\n+    device_map=\"auto\",\n )\n \n pipe(\"Explain quantum computing simply. \", max_new_tokens=50)\n@@ -74,7 +74,7 @@ model = AutoModelForCausalLM.from_pretrained(\n )\n \n input_text = \"Explain quantum computing simply.\"\n-input_ids = tokenizer(input_text, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(input_text, return_tensors=\"pt\").to(model.device)\n \n outputs = model.generate(**input_ids, max_new_tokens=32, cache_implementation=\"static\")\n print(tokenizer.decode(outputs[0], skip_special_tokens=True))\n@@ -108,7 +108,7 @@ model = AutoModelForCausalLM.from_pretrained(\n )\n \n input_text = \"Explain quantum computing simply.\"\n-input_ids = tokenizer(input_text, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(input_text, return_tensors=\"pt\").to(model.device)\n \n outputs = model.generate(**input_ids, max_new_tokens=32, cache_implementation=\"static\")\n print(tokenizer.decode(outputs[0], skip_special_tokens=True))"
        },
        {
            "sha": "ca50c32da21b62922da09ac306728f4faa980591",
            "filename": "docs/source/en/model_doc/glm.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fglm.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fglm.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fglm.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -61,8 +61,8 @@ Tips:\n In the following, we demonstrate how to use `glm-4-9b-chat` for the inference. Note that we have used the ChatML format for dialog, in this demo we show how to leverage `apply_chat_template` for this purpose.\n \n ```python\n->>> from transformers import AutoModelForCausalLM, AutoTokenizer\n->>> device = \"cuda\" # the device to load the model onto\n+>>> from transformers import AutoModelForCausalLM, AutoTokenizer, infer_device\n+>>> device = infer_device() # the device to load the model onto\n \n >>> model = AutoModelForCausalLM.from_pretrained(\"THUDM/glm-4-9b-chat\", device_map=\"auto\", trust_remote_code=True)\n >>> tokenizer = AutoTokenizer.from_pretrained(\"THUDM/glm-4-9b-chat\")\n@@ -73,7 +73,7 @@ In the following, we demonstrate how to use `glm-4-9b-chat` for the inference. N\n \n >>> text = tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True)\n \n->>> model_inputs = tokenizer([text], return_tensors=\"pt\").to(device)\n+>>> model_inputs = tokenizer([text], return_tensors=\"pt\").to(model.device)\n \n >>> generated_ids = model.generate(model_inputs.input_ids, max_new_tokens=512, do_sample=True)\n "
        },
        {
            "sha": "54de3240374a3ff003e6ae1bd33d55e899505e88",
            "filename": "docs/source/en/model_doc/gpt2.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fgpt2.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fgpt2.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fgpt2.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -58,7 +58,7 @@ from transformers import AutoModelForCausalLM, AutoTokenizer\n model = AutoModelForCausalLM.from_pretrained(\"openai-community/gpt2\", torch_dtype=torch.float16, device_map=\"auto\", attn_implementation=\"sdpa\")\n tokenizer = AutoTokenizer.from_pretrained(\"openai-community/gpt2\")\n \n-input_ids = tokenizer(\"Hello, I'm a language model\", return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(\"Hello, I'm a language model\", return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))\n@@ -102,7 +102,7 @@ model = AutoModelForCausalLM.from_pretrained(\n )\n \n tokenizer = AutoTokenizer.from_pretrained(\"openai-community/gpt2-xl\")\n-inputs = tokenizer(\"Once upon a time, there was a magical forest\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"Once upon a time, there was a magical forest\", return_tensors=\"pt\").to(model.device)\n outputs = model.generate(**inputs, max_new_tokens=100)\n print(tokenizer.decode(outputs[0], skip_special_tokens=True))\n ```"
        },
        {
            "sha": "ba32babe3f53ca62de4aee080876dced9678fe41",
            "filename": "docs/source/en/model_doc/gpt_bigcode.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fgpt_bigcode.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fgpt_bigcode.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fgpt_bigcode.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -67,15 +67,15 @@ To load and run a model using Flash Attention 2, refer to the snippet below:\n \n ```python\n >>> import torch\n->>> from transformers import AutoModelForCausalLM, AutoTokenizer\n->>> device = \"cuda\" # the device to load the model onto\n+>>> from transformers import AutoModelForCausalLM, AutoTokenizer, infer_device\n+>>> device = infer_device() # the device to load the model onto\n \n >>> model = AutoModelForCausalLM.from_pretrained(\"bigcode/gpt_bigcode-santacoder\", torch_dtype=torch.float16, attn_implementation=\"flash_attention_2\")\n >>> tokenizer = AutoTokenizer.from_pretrained(\"bigcode/gpt_bigcode-santacoder\")\n \n >>> prompt = \"def hello_world():\"\n \n->>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(device)\n+>>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(model.device)\n >>> model.to(device)\n \n >>> generated_ids = model.generate(**model_inputs, max_new_tokens=30, do_sample=False)"
        },
        {
            "sha": "9d13e8aa9256f16665f8a38d1c2621e320d3e5f8",
            "filename": "docs/source/en/model_doc/gptj.md",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fgptj.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fgptj.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fgptj.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -41,10 +41,10 @@ This model was contributed by [Stella Biderman](https://huggingface.co/stellaath\n   which could be used to further minimize the RAM usage:\n \n ```python\n->>> from transformers import GPTJForCausalLM\n+>>> from transformers import GPTJForCausalLM, infer_device\n >>> import torch\n \n->>> device = \"cuda\"\n+>>> device = infer_device()\n >>> model = GPTJForCausalLM.from_pretrained(\n ...     \"EleutherAI/gpt-j-6B\",\n ...     revision=\"float16\",\n@@ -96,10 +96,10 @@ model.\n ...or in float16 precision:\n \n ```python\n->>> from transformers import GPTJForCausalLM, AutoTokenizer\n+>>> from transformers import GPTJForCausalLM, AutoTokenizer, infer_device\n >>> import torch\n \n->>> device = \"cuda\"\n+>>> device = infer_device()\n >>> model = GPTJForCausalLM.from_pretrained(\"EleutherAI/gpt-j-6B\", torch_dtype=torch.float16).to(device)\n >>> tokenizer = AutoTokenizer.from_pretrained(\"EleutherAI/gpt-j-6B\")\n \n@@ -109,7 +109,7 @@ model.\n ...     \"researchers was the fact that the unicorns spoke perfect English.\"\n ... )\n \n->>> input_ids = tokenizer(prompt, return_tensors=\"pt\").input_ids.to(device)\n+>>> input_ids = tokenizer(prompt, return_tensors=\"pt\").input_ids.to(model.device)\n \n >>> gen_tokens = model.generate(\n ...     input_ids,"
        },
        {
            "sha": "ba06feb18fbe1711b2264d929a93a131de899f13",
            "filename": "docs/source/en/model_doc/helium.md",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fhelium.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fhelium.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fhelium.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -119,14 +119,13 @@ In the following, we demonstrate how to use `helium-1-preview` for the inference\n \n ```python\n >>> from transformers import AutoModelForCausalLM, AutoTokenizer\n->>> device = \"cuda\" # the device to load the model onto\n \n >>> model = AutoModelForCausalLM.from_pretrained(\"kyutai/helium-1-preview-2b\", device_map=\"auto\")\n >>> tokenizer = AutoTokenizer.from_pretrained(\"kyutai/helium-1-preview-2b\")\n \n >>> prompt = \"Give me a short introduction to large language model.\"\n \n->>> model_inputs = tokenizer(prompt, return_tensors=\"pt\").to(device)\n+>>> model_inputs = tokenizer(prompt, return_tensors=\"pt\").to(model.device)\n \n >>> generated_ids = model.generate(model_inputs.input_ids, max_new_tokens=512, do_sample=True)\n "
        },
        {
            "sha": "f2d3a64fe00564ca8259c2ec5205306e0ec2b73e",
            "filename": "docs/source/en/model_doc/internvl.md",
            "status": "modified",
            "additions": 5,
            "deletions": 10,
            "changes": 15,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Finternvl.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Finternvl.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Finternvl.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -86,10 +86,9 @@ This example demonstrates how to perform inference on a single image with the In\n >>> from transformers import AutoProcessor, AutoModelForImageTextToText\n >>> import torch\n \n->>> torch_device = \"cuda\"\n >>> model_checkpoint = \"OpenGVLab/InternVL3-1B-hf\"\n >>> processor = AutoProcessor.from_pretrained(model_checkpoint)\n->>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=torch_device, torch_dtype=torch.bfloat16)\n+>>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=\"auto\", torch_dtype=torch.bfloat16)\n \n >>> messages = [\n ...     {\n@@ -118,10 +117,9 @@ This example shows how to generate text using the InternVL model without providi\n >>> from transformers import AutoProcessor, AutoModelForImageTextToText\n >>> import torch\n \n->>> torch_device = \"cuda\"\n >>> model_checkpoint = \"OpenGVLab/InternVL3-1B-hf\"\n >>> processor = AutoProcessor.from_pretrained(model_checkpoint)\n->>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=torch_device, torch_dtype=torch.bfloat16)\n+>>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=\"auto\", torch_dtype=torch.bfloat16)\n \n >>> messages = [\n ...     {\n@@ -148,10 +146,9 @@ InternVL models also support batched image and text inputs.\n >>> from transformers import AutoProcessor, AutoModelForImageTextToText\n >>> import torch\n \n->>> torch_device = \"cuda\"\n >>> model_checkpoint = \"OpenGVLab/InternVL3-1B-hf\"\n >>> processor = AutoProcessor.from_pretrained(model_checkpoint)\n->>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=torch_device, torch_dtype=torch.bfloat16)\n+>>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=\"auto\", torch_dtype=torch.bfloat16)\n \n >>> messages = [\n ...     [\n@@ -192,10 +189,9 @@ This implementation of the InternVL models supports batched text-images inputs w\n >>> from transformers import AutoProcessor, AutoModelForImageTextToText\n >>> import torch\n \n->>> torch_device = \"cuda\"\n >>> model_checkpoint = \"OpenGVLab/InternVL3-1B-hf\"\n >>> processor = AutoProcessor.from_pretrained(model_checkpoint)\n->>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=torch_device, torch_dtype=torch.bfloat16)\n+>>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=\"auto\", torch_dtype=torch.bfloat16)\n \n >>> messages = [\n ...     [\n@@ -275,10 +271,9 @@ This example showcases how to handle a batch of chat conversations with interlea\n >>> from transformers import AutoProcessor, AutoModelForImageTextToText, BitsAndBytesConfig\n >>> import torch\n \n->>> torch_device = \"cuda\"\n >>> model_checkpoint = \"OpenGVLab/InternVL3-1B-hf\"\n >>> processor = AutoProcessor.from_pretrained(model_checkpoint)\n->>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=torch_device, torch_dtype=torch.bfloat16)\n+>>> model = AutoModelForImageTextToText.from_pretrained(model_checkpoint, device_map=\"auto\", torch_dtype=torch.bfloat16)\n \n >>> messages = [\n ...     ["
        },
        {
            "sha": "46903a50cdf4ead95da398b35bf8acf495864ab4",
            "filename": "docs/source/en/model_doc/jamba.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fjamba.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fjamba.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fjamba.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -70,7 +70,7 @@ model = AutoModelForCausalLM.from_pretrained(\n     device_map=\"auto\",\n     attn_implementation=\"sdpa\"\n )\n-input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "0d9b45ba9380f4b6c9fad7497ff6cc30430598ee",
            "filename": "docs/source/en/model_doc/kyutai_speech_to_text.md",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fkyutai_speech_to_text.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fkyutai_speech_to_text.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fkyutai_speech_to_text.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -33,10 +33,10 @@ rendered properly in your Markdown viewer.\n ```python\n import torch\n from datasets import load_dataset, Audio\n-from transformers import KyutaiSpeechToTextProcessor, KyutaiSpeechToTextForConditionalGeneration\n+from transformers import infer_device, KyutaiSpeechToTextProcessor, KyutaiSpeechToTextForConditionalGeneration\n \n # 1. load the model and the processor\n-torch_device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+torch_device = infer_device()\n model_id = \"kyutai/stt-2.6b-en-trfs\"\n \n processor = KyutaiSpeechToTextProcessor.from_pretrained(model_id)\n@@ -52,7 +52,7 @@ ds = ds.cast_column(\"audio\", Audio(sampling_rate=24000))\n inputs = processor(\n     ds[0][\"audio\"][\"array\"],\n )\n-inputs.to(torch_device)\n+inputs.to(model.device)\n \n # 4. infer the model\n output_tokens = model.generate(**inputs)\n@@ -66,10 +66,10 @@ print(processor.batch_decode(output_tokens, skip_special_tokens=True))\n ```python\n import torch\n from datasets import load_dataset, Audio\n-from transformers import KyutaiSpeechToTextProcessor, KyutaiSpeechToTextForConditionalGeneration\n+from transformers import infer_device, KyutaiSpeechToTextProcessor, KyutaiSpeechToTextForConditionalGeneration\n \n # 1. load the model and the processor\n-torch_device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+torch_device = infer_device()\n model_id = \"kyutai/stt-2.6b-en-trfs\"\n \n processor = KyutaiSpeechToTextProcessor.from_pretrained(model_id)\n@@ -84,7 +84,7 @@ ds = ds.cast_column(\"audio\", Audio(sampling_rate=24000))\n # 3. prepare the model inputs\n audio_arrays = [ds[i][\"audio\"][\"array\"] for i in range(4)]\n inputs = processor(audio_arrays, return_tensors=\"pt\", padding=True)\n-inputs = inputs.to(torch_device)\n+inputs = inputs.to(model.device)\n \n # 4. infer the model\n output_tokens = model.generate(**inputs)"
        },
        {
            "sha": "d241ccdd1001dcfe9732875e652f889216fad4e5",
            "filename": "docs/source/en/model_doc/llama.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fllama.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fllama.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fllama.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -69,7 +69,7 @@ model = AutoModelForCausalLM.from_pretrained(\n     device_map=\"auto\",\n     attn_implementation=\"sdpa\"\n )\n-input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))\n@@ -103,7 +103,7 @@ model = AutoModelForCausalLM.from_pretrained(\n )\n \n tokenizer = AutoTokenizer.from_pretrained(\"huggyllama/llama-30b\")\n-input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "4025830735cb2bb9d9918d74a85f2cb60caae4cf",
            "filename": "docs/source/en/model_doc/llama2.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fllama2.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fllama2.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fllama2.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -69,7 +69,7 @@ model = AutoModelForCausalLM.from_pretrained(\n     device_map=\"auto\",\n     attn_implementation=\"sdpa\"\n )\n-input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))\n@@ -103,7 +103,7 @@ model = AutoModelForCausalLM.from_pretrained(\n )\n \n tokenizer = AutoTokenizer.from_pretrained(\"meta-llama/Llama-2-13b-hf\")\n-input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "ffaa9cfc12f3a36d8b8e8db1d70e7b8193e13aba",
            "filename": "docs/source/en/model_doc/longt5.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Flongt5.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Flongt5.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Flongt5.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -75,7 +75,7 @@ The complexity of this mechanism is `O(l(r + l/k))`.\n >>> dataset = load_dataset(\"scientific_papers\", \"pubmed\", split=\"validation\")\n >>> model = (\n ...     LongT5ForConditionalGeneration.from_pretrained(\"Stancld/longt5-tglobal-large-16384-pubmed-3k_steps\")\n-...     .to(\"cuda\")\n+...     .to(\"auto\")\n ...     .half()\n ... )\n >>> tokenizer = AutoTokenizer.from_pretrained(\"Stancld/longt5-tglobal-large-16384-pubmed-3k_steps\")\n@@ -85,8 +85,8 @@ The complexity of this mechanism is `O(l(r + l/k))`.\n ...     inputs_dict = tokenizer(\n ...         batch[\"article\"], max_length=16384, padding=\"max_length\", truncation=True, return_tensors=\"pt\"\n ...     )\n-...     input_ids = inputs_dict.input_ids.to(\"cuda\")\n-...     attention_mask = inputs_dict.attention_mask.to(\"cuda\")\n+...     input_ids = inputs_dict.input_ids.to(model.device)\n+...     attention_mask = inputs_dict.attention_mask.to(model.device)\n ...     output_ids = model.generate(input_ids, attention_mask=attention_mask, max_length=512, num_beams=2)\n ...     batch[\"predicted_abstract\"] = tokenizer.batch_decode(output_ids, skip_special_tokens=True)\n ...     return batch"
        },
        {
            "sha": "08513b319cd354ba1068a19198246b652d0f64a4",
            "filename": "docs/source/en/model_doc/mamba.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmamba.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmamba.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmamba.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -59,7 +59,7 @@ from transformers import AutoModelForCausalLM, AutoTokenizer\n \n tokenizer = AutoTokenizer.from_pretrained(\"state-spaces/mamba-130m-hf\")\n model = AutoModelForCausalLM.from_pretrained(\"state-spaces/mamba-130m-hf\", torch_dtype=torch.float16, device_map=\"auto\",)  \n-input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(\"cuda\")  \n+input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(model.device)  \n \n output = model.generate(**input_ids)  \n print(tokenizer.decode(output[0], skip_special_tokens=True)\n@@ -88,7 +88,7 @@ quantization_config = Int4WeightOnlyConfig(group_size=128)\n quantization_config = TorchAoConfig(quant_type=quant_config)\n tokenizer = AutoTokenizer.from_pretrained(\"state-spaces/mamba-2.8b-hf\")\n model = AutoModelForCausalLM.from_pretrained(\"state-spaces/mamba-2.8b-hf\", torch_dtype=torch.bfloat16, quantization_config=quantization_config, device_map=\"auto\",)\n-input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids)\n print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "e7358ce3c9eb4cb662773e720fd1ca9d72eda58d",
            "filename": "docs/source/en/model_doc/mamba2.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmamba2.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmamba2.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmamba2.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -57,7 +57,7 @@ from transformers import AutoModelForCausalLM, AutoTokenizer\n \n tokenizer = AutoTokenizer.from_pretrained(\"mistralai/Mamba-Codestral-7B-v0.1\")\n model = AutoModelForCausalLM.from_pretrained(\"mistralai/Mamba-Codestral-7B-v0.1\", torch_dtype=torch.bfloat16, device_map=\"auto\")  \n-input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(\"cuda\")  \n+input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(model.device)  \n \n output = model.generate(**input_ids)  \n print(tokenizer.decode(output[0], skip_special_tokens=True))\n@@ -84,7 +84,7 @@ from transformers import AutoModelForCausalLM, AutoTokenizer, TorchAoConfig\n quantization_config = TorchAoConfig(\"int4_weight_only\", group_size=128)\n tokenizer = AutoTokenizer.from_pretrained(\"mistralai/Mamba-Codestral-7B-v0.1\")\n model = AutoModelForCausalLM.from_pretrained(\"mistralai/Mamba-Codestral-7B-v0.1\", torch_dtype=torch.bfloat16, quantization_config=quantization_config, device_map=\"auto\")\n-input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(\"Plants create energy through a process known as\", return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids)\n print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "aa2663208e1d7adf5c2097b8299f4d0fdce9065d",
            "filename": "docs/source/en/model_doc/mbart.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmbart.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmbart.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmbart.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -72,7 +72,7 @@ model = AutoModelForSeq2SeqLM.from_pretrained(\"facebook/mbart-large-50-many-to-m\n tokenizer = AutoTokenizer.from_pretrained(\"facebook/mbart-large-50-many-to-many-mmt\")\n \n tokenizer.src_lang = \"en_XX\"\n-encoded_hi = tokenizer(article_en, return_tensors=\"pt\").to(\"cuda\")\n+encoded_hi = tokenizer(article_en, return_tensors=\"pt\").to(model.device)\n generated_tokens = model.generate(**encoded_hi, forced_bos_token_id=tokenizer.lang_code_to_id[\"fr_XX\"], cache_implementation=\"static\")\n print(tokenizer.batch_decode(generated_tokens, skip_special_tokens=True))\n ```\n@@ -208,4 +208,4 @@ print(tokenizer.batch_decode(generated_tokens, skip_special_tokens=True))\n     - decode\n \n </jax>\n-</frameworkcontent>\n\\ No newline at end of file\n+</frameworkcontent>"
        },
        {
            "sha": "4b96e567f572585673e9dc8702fea11123193caf",
            "filename": "docs/source/en/model_doc/minimax.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fminimax.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fminimax.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fminimax.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -67,7 +67,7 @@ The pre-trained model can be used as follows:\n ...     {\"role\": \"user\", \"content\": \"Do you have mayonnaise recipes?\"}\n ... ]\n \n->>> model_inputs = tokenizer.apply_chat_template(messages, return_tensors=\"pt\").to(\"cuda\")\n+>>> model_inputs = tokenizer.apply_chat_template(messages, return_tensors=\"pt\").to(model.device)\n \n >>> generated_ids = model.generate(model_inputs, max_new_tokens=100, do_sample=True)\n >>> tokenizer.batch_decode(generated_ids)[0]\n@@ -99,7 +99,7 @@ To load and run a model using Flash Attention-2, refer to the snippet below:\n \n >>> prompt = \"My favourite condiment is\"\n \n->>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(\"cuda\")\n+>>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(model.device)\n >>> model.to(device)\n \n >>> generated_ids = model.generate(**model_inputs, max_new_tokens=100, do_sample=True)\n@@ -142,7 +142,7 @@ Quantizing a model is as simple as passing a `quantization_config` to the model.\n ...     {\"role\": \"user\", \"content\": \"Do you have mayonnaise recipes?\"}\n ... ]\n \n->>> model_inputs = tokenizer.apply_chat_template(messages, return_tensors=\"pt\").to(\"cuda\")\n+>>> model_inputs = tokenizer.apply_chat_template(messages, return_tensors=\"pt\").to(model.device)\n \n >>> generated_ids = model.generate(model_inputs, max_new_tokens=100, do_sample=True)\n >>> tokenizer.batch_decode(generated_ids)[0]"
        },
        {
            "sha": "07a6ffe82bb65e7b037f32e86e53fef892aa4b11",
            "filename": "docs/source/en/model_doc/mixtral.md",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmixtral.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmixtral.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmixtral.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -68,8 +68,7 @@ The base model can be used as follows:\n \n >>> prompt = \"My favourite condiment is\"\n \n->>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(\"cuda\")\n->>> model.to(device)\n+>>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(model.device)\n \n >>> generated_ids = model.generate(**model_inputs, max_new_tokens=100, do_sample=True)\n >>> tokenizer.batch_decode(generated_ids)[0]\n@@ -90,7 +89,7 @@ The instruction tuned model can be used as follows:\n ...     {\"role\": \"user\", \"content\": \"Do you have mayonnaise recipes?\"}\n ... ]\n \n->>> model_inputs = tokenizer.apply_chat_template(messages, return_tensors=\"pt\").to(\"cuda\")\n+>>> model_inputs = tokenizer.apply_chat_template(messages, return_tensors=\"pt\").to(model.device)\n \n >>> generated_ids = model.generate(model_inputs, max_new_tokens=100, do_sample=True)\n >>> tokenizer.batch_decode(generated_ids)[0]\n@@ -122,8 +121,7 @@ To load and run a model using Flash Attention-2, refer to the snippet below:\n \n >>> prompt = \"My favourite condiment is\"\n \n->>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(\"cuda\")\n->>> model.to(device)\n+>>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(model.device)\n \n >>> generated_ids = model.generate(**model_inputs, max_new_tokens=100, do_sample=True)\n >>> tokenizer.batch_decode(generated_ids)[0]\n@@ -173,7 +171,7 @@ Quantizing a model is as simple as passing a `quantization_config` to the model.\n ...     {\"role\": \"user\", \"content\": \"Do you have mayonnaise recipes?\"}\n ... ]\n \n->>> model_inputs = tokenizer.apply_chat_template(messages, return_tensors=\"pt\").to(\"cuda\")\n+>>> model_inputs = tokenizer.apply_chat_template(messages, return_tensors=\"pt\").to(model.device)\n \n >>> generated_ids = model.generate(model_inputs, max_new_tokens=100, do_sample=True)\n >>> tokenizer.batch_decode(generated_ids)[0]\n@@ -191,7 +189,7 @@ A list of official Hugging Face and community (indicated by 🌎) resources to h\n \n - A demo notebook to perform supervised fine-tuning (SFT) of Mixtral-8x7B can be found [here](https://github.com/NielsRogge/Transformers-Tutorials/blob/master/Mistral/Supervised_fine_tuning_(SFT)_of_an_LLM_using_Hugging_Face_tooling.ipynb). 🌎\n - A [blog post](https://medium.com/@prakharsaxena11111/finetuning-mixtral-7bx8-6071b0ebf114) on fine-tuning Mixtral-8x7B using PEFT. 🌎\n-- The [Alignment Handbook](https://github.com/huggingface/alignment-handbook) by Hugging Face includes scripts and recipes to perform supervised fine-tuning (SFT) and direct preference optimization with Mistral-7B. This includes scripts for full fine-tuning, QLoRa on a single GPU as well as multi-GPU fine-tuning.\n+- The [Alignment Handbook](https://github.com/huggingface/alignment-handbook) by Hugging Face includes scripts and recipes to perform supervised fine-tuning (SFT) and direct preference optimization with Mistral-7B. This includes scripts for full fine-tuning, QLoRa on a single accelerator as well as multi-accelerator fine-tuning.\n - [Causal language modeling task guide](../tasks/language_modeling)\n \n ## MixtralConfig"
        },
        {
            "sha": "e411ef5defb6be7cb225ebdd30586ea2889d7b0e",
            "filename": "docs/source/en/model_doc/mm-grounding-dino.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmm-grounding-dino.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmm-grounding-dino.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmm-grounding-dino.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -39,13 +39,13 @@ The example below demonstrates how to generate text based on an image with the [\n \n ```py\n import torch\n-from transformers import AutoModelForZeroShotObjectDetection, AutoProcessor\n+from transformers import AutoModelForZeroShotObjectDetection, AutoProcessor, infer_device\n from transformers.image_utils import load_image\n \n \n # Prepare processor and model\n model_id = \"openmmlab-community/mm_grounding_dino_tiny_o365v1_goldg_v3det\"\n-device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+device = infer_device()\n processor = AutoProcessor.from_pretrained(model_id)\n model = AutoModelForZeroShotObjectDetection.from_pretrained(model_id).to(device)\n "
        },
        {
            "sha": "2beae5b2e9f35cad7db52fcd2a874d9af75c224f",
            "filename": "docs/source/en/model_doc/mobilevit.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmobilevit.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmobilevit.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmobilevit.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -75,11 +75,11 @@ image_processor = AutoImageProcessor.from_pretrained(\n    \"apple/mobilevit-small\",\n    use_fast=True,\n )\n-model = MobileViTForImageClassification.from_pretrained(\"apple/mobilevit-small\")\n+model = MobileViTForImageClassification.from_pretrained(\"apple/mobilevit-small\", device_map=\"auto\")\n \n url = \"https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/pipeline-cat-chonk.jpeg\"\n image = Image.open(requests.get(url, stream=True).raw)\n-inputs = image_processor(image, return_tensors=\"pt\").to(\"cuda\")\n+inputs = image_processor(image, return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     logits = model(**inputs).logits"
        },
        {
            "sha": "399e7a57c6a70dd7097b318077b909a702bf5887",
            "filename": "docs/source/en/model_doc/modernbert.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmodernbert.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmodernbert.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmodernbert.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -66,7 +66,7 @@ model = AutoModelForMaskedLM.from_pretrained(\n     device_map=\"auto\",\n     attn_implementation=\"sdpa\"\n )\n-inputs = tokenizer(\"Plants create [MASK] through a process known as photosynthesis.\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"Plants create [MASK] through a process known as photosynthesis.\", return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)"
        },
        {
            "sha": "e17a1b7b8b14707a8fd028c4f889ce0fb58eabdf",
            "filename": "docs/source/en/model_doc/moshi.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmoshi.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmoshi.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmoshi.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -116,13 +116,13 @@ To follow the example of the following image, `\"Hello, I'm Moshi\"` could be tran\n ```python \n >>> from datasets import load_dataset, Audio\n >>> import torch, math\n->>> from transformers import MoshiForConditionalGeneration, AutoFeatureExtractor, AutoTokenizer\n+>>> from transformers import MoshiForConditionalGeneration, AutoFeatureExtractor, AutoTokenizer, infer_device\n \n \n >>> librispeech_dummy = load_dataset(\"hf-internal-testing/librispeech_asr_dummy\", \"clean\", split=\"validation\")\n >>> feature_extractor = AutoFeatureExtractor.from_pretrained(\"kyutai/moshiko-pytorch-bf16\")\n >>> tokenizer = AutoTokenizer.from_pretrained(\"kyutai/moshiko-pytorch-bf16\")\n->>> device = \"cuda\"\n+>>> device = infer_device()\n >>> dtype = torch.bfloat16\n \n >>> # prepare user input audio "
        },
        {
            "sha": "088c5bf478d86c9a8a71ab3c5aa0993dbd51726f",
            "filename": "docs/source/en/model_doc/mt5.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmt5.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fmt5.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmt5.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -73,7 +73,7 @@ model = AutoModelForSeq2SeqLM.from_pretrained(\n input_text = \"\"\"Plants are remarkable organisms that produce their own food using a method called photosynthesis.\n This process involves converting sunlight, carbon dioxide, and water into glucose, which provides energy for growth.\n Plants play a crucial role in sustaining life on Earth by generating oxygen and serving as the foundation of most ecosystems.\"\"\"\n-input_ids = tokenizer(input_text, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(input_text, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))\n@@ -115,7 +115,7 @@ tokenizer = AutoTokenizer.from_pretrained(\n input_text = \"\"\"Plants are remarkable organisms that produce their own food using a method called photosynthesis.\n This process involves converting sunlight, carbon dioxide, and water into glucose, which provides energy for growth.\n Plants play a crucial role in sustaining life on Earth by generating oxygen and serving as the foundation of most ecosystems.\"\"\"\n-input_ids = tokenizer(input_text, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(input_text, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "0a189d9b6e596f0a55016f24f0b9b21e219ed41f",
            "filename": "docs/source/en/model_doc/nougat.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fnougat.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fnougat.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fnougat.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -65,14 +65,14 @@ into a single instance to both extract the input features and decode the predict\n >>> import re\n >>> from PIL import Image\n \n->>> from transformers import NougatProcessor, VisionEncoderDecoderModel\n+>>> from transformers import NougatProcessor, VisionEncoderDecoderModel, infer_device\n >>> from datasets import load_dataset\n >>> import torch\n \n >>> processor = NougatProcessor.from_pretrained(\"facebook/nougat-base\")\n >>> model = VisionEncoderDecoderModel.from_pretrained(\"facebook/nougat-base\")\n \n->>> device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+>>> device = infer_device()\n >>> model.to(device)  # doctest: +IGNORE_RESULT\n \n >>> # prepare PDF image for the model\n@@ -125,4 +125,4 @@ The model is identical to [Donut](donut) in terms of architecture.\n     - save_pretrained\n     - batch_decode\n     - decode\n-    - post_process_generation\n\\ No newline at end of file\n+    - post_process_generation"
        },
        {
            "sha": "9b97525dd0e13a7dee61b1e72902f2354dcd4709",
            "filename": "docs/source/en/model_doc/olmoe.md",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Folmoe.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Folmoe.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Folmoe.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -59,9 +59,9 @@ print(result)\n \n ```py\n import torch\n-from transformers import AutoModelForCausalLM, AutoTokenizer\n+from transformers import AutoModelForCausalLM, AutoTokenizer, infer_device\n \n-device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+device = infer_device()\n \n model = AutoModelForCausalLM.from_pretrained(\"allenai/OLMoE-1B-7B-0924\", attn_implementation=\"sdpa\", torch_dtype=\"auto\", device_map=\"auto\").to(device)\n tokenizer = AutoTokenizer.from_pretrained(\"allenai/OLMoE-1B-7B-0924\")\n@@ -79,9 +79,9 @@ The example below uses [bitsandbytes](../quantization/bitsandbytes) to only quan\n \n ```py\n import torch\n-from transformers import AutoModelForCausalLM, AutoTokenizer, BitsAndBytesConfig\n+from transformers import AutoModelForCausalLM, AutoTokenizer, BitsAndBytesConfig, infer_device\n \n-device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+device = infer_device()\n \n quantization_config = BitsAndBytesConfig(\n    load_in_4bit=True,"
        },
        {
            "sha": "2ff64076d53a0f1fc199a2d678888f8548398e59",
            "filename": "docs/source/en/model_doc/paligemma.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fpaligemma.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fpaligemma.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fpaligemma.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -77,7 +77,7 @@ processor = AutoProcessor.from_pretrained(\n prompt = \"What is in this image?\"\n url = \"https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/pipeline-cat-chonk.jpeg\"\n image = Image.open(requests.get(url, stream=True).raw)\n-inputs = processor(image, prompt, return_tensors=\"pt\").to(\"cuda\")\n+inputs = processor(image, prompt, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**inputs, max_new_tokens=50, cache_implementation=\"static\")\n print(processor.decode(output[0], skip_special_tokens=True))\n@@ -111,7 +111,7 @@ processor = AutoProcessor.from_pretrained(\n prompt = \"What is in this image?\"\n url = \"https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/pipeline-cat-chonk.jpeg\"\n image = Image.open(requests.get(url, stream=True).raw)\n-inputs = processor(image, prompt, return_tensors=\"pt\").to(\"cuda\")\n+inputs = processor(image, prompt, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**inputs, max_new_tokens=50, cache_implementation=\"static\")\n print(processor.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "a85b85fa01a3d523365a9a521bb7a15a311a2516",
            "filename": "docs/source/en/model_doc/pegasus.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fpegasus.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fpegasus.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fpegasus.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -75,7 +75,7 @@ model = AutoModelForSeq2SeqLM.from_pretrained(\n input_text = \"\"\"Plants are remarkable organisms that produce their own food using a method called photosynthesis.\n This process involves converting sunlight, carbon dioxide, and water into glucose, which provides energy for growth.\n Plants play a crucial role in sustaining life on Earth by generating oxygen and serving as the foundation of most ecosystems.\"\"\"\n-input_ids = tokenizer(input_text, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(input_text, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))\n@@ -117,7 +117,7 @@ tokenizer = AutoTokenizer.from_pretrained(\n input_text = \"\"\"Plants are remarkable organisms that produce their own food using a method called photosynthesis.\n This process involves converting sunlight, carbon dioxide, and water into glucose, which provides energy for growth.\n Plants play a crucial role in sustaining life on Earth by generating oxygen and serving as the foundation of most ecosystems.\"\"\"\n-input_ids = tokenizer(input_text, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(input_text, return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "f16c56ad8f4073d2ff5bd95b2304d95e7a4aa1d5",
            "filename": "docs/source/en/model_doc/phi.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fphi.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fphi.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fphi.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -60,7 +60,7 @@ model = AutoModelForCausalLM.from_pretrained(\"microsoft/phi-1\", torch_dtype=torc\n input_ids = tokenizer('''def print_prime(n):\n    \"\"\"\n    Print all primes between 1 and n\n-   \"\"\"''', return_tensors=\"pt\").to(\"cuda\")\n+   \"\"\"''', return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))\n@@ -91,7 +91,7 @@ model = AutoModelForCausalLM.from_pretrained(\"microsoft/phi-1\", torch_dtype=torc\n input_ids = tokenizer('''def print_prime(n):\n    \"\"\"\n    Print all primes between 1 and n\n-   \"\"\"''', return_tensors=\"pt\").to(\"cuda\")\n+   \"\"\"''', return_tensors=\"pt\").to(model.device)\n \n output = model.generate(**input_ids, cache_implementation=\"static\")\n print(tokenizer.decode(output[0], skip_special_tokens=True))\n@@ -116,7 +116,7 @@ print(tokenizer.decode(output[0], skip_special_tokens=True))\n     input_ids = tokenizer('''def print_prime(n):\n        \"\"\"\n        Print all primes between 1 and n\n-       \"\"\"''', return_tensors=\"pt\").to(\"cuda\")\n+       \"\"\"''', return_tensors=\"pt\").to(model.device)\n \n     output = model.generate(**input_ids, cache_implementation=\"static\")\n     print(tokenizer.decode(output[0], skip_special_tokens=True))"
        },
        {
            "sha": "0bc043556f8e646a8db45907398efa7ec8d83471",
            "filename": "docs/source/en/model_doc/phimoe.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fphimoe.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fphimoe.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fphimoe.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -67,7 +67,7 @@ torch.random.manual_seed(0)\n \n model = AutoModelForCausalLM.from_pretrained( \n     \"microsoft/Phi-3.5-MoE-instruct\",  \n-    device_map=\"cuda\",  \n+    device_map=\"auto\",  \n     torch_dtype=\"auto\",  \n     trust_remote_code=True,  \n ) "
        },
        {
            "sha": "4145db0ad3e88d30a258bb20a994a2dba18e9ecf",
            "filename": "docs/source/en/model_doc/pixtral.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fpixtral.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fpixtral.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fpixtral.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -58,7 +58,7 @@ from transformers import AutoProcessor, LlavaForConditionalGeneration\n \n model_id = \"mistral-community/pixtral-12b\"\n processor = AutoProcessor.from_pretrained(model_id)\n-model = LlavaForConditionalGeneration.from_pretrained(model_id, device_map=\"cuda\")\n+model = LlavaForConditionalGeneration.from_pretrained(model_id, device_map=\"auto\")\n \n chat = [\n     {"
        },
        {
            "sha": "978b5abe64a3dbb2eb8e37ac2f5244d08afe7018",
            "filename": "docs/source/en/model_doc/qwen2.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fqwen2.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fqwen2.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fqwen2.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -82,7 +82,7 @@ text = tokenizer.apply_chat_template(\n     tokenize=False,\n     add_generation_prompt=True\n )\n-model_inputs = tokenizer([text], return_tensors=\"pt\").to(\"cuda\")\n+model_inputs = tokenizer([text], return_tensors=\"pt\").to(model.device)\n \n generated_ids = model.generate(\n     model_inputs.input_ids,\n@@ -137,7 +137,7 @@ model = AutoModelForCausalLM.from_pretrained(\n     attn_implementation=\"flash_attention_2\"\n )\n \n-inputs = tokenizer(\"The Qwen2 model family is\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"The Qwen2 model family is\", return_tensors=\"pt\").to(model.device)\n outputs = model.generate(**inputs, max_new_tokens=100)\n print(tokenizer.decode(outputs[0], skip_special_tokens=True))\n ```"
        },
        {
            "sha": "fcef002c2614e45a0c42dcffd5fe80876479699f",
            "filename": "docs/source/en/model_doc/qwen2_moe.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fqwen2_moe.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fqwen2_moe.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fqwen2_moe.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -82,7 +82,7 @@ text = tokenizer.apply_chat_template(\n     tokenize=False,\n     add_generation_prompt=True\n )\n-model_inputs = tokenizer([text], return_tensors=\"pt\").to(\"cuda\")\n+model_inputs = tokenizer([text], return_tensors=\"pt\").to(model.device)\n \n generated_ids = model.generate(\n     model_inputs.input_ids,\n@@ -131,7 +131,7 @@ model = AutoModelForCausalLM.from_pretrained(\n     attn_implementation=\"flash_attention_2\"\n )\n \n-inputs = tokenizer(\"The Qwen2 model family is\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"The Qwen2 model family is\", return_tensors=\"pt\").to(model.device)\n outputs = model.generate(**inputs, max_new_tokens=100)\n print(tokenizer.decode(outputs[0], skip_special_tokens=True))\n ```"
        },
        {
            "sha": "7313d632cef07eef994a01176596ed5f79608915",
            "filename": "docs/source/en/model_doc/roberta.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Froberta.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Froberta.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Froberta.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -69,7 +69,7 @@ model = AutoModelForMaskedLM.from_pretrained(\n     device_map=\"auto\",\n     attn_implementation=\"sdpa\"\n )\n-inputs = tokenizer(\"Plants create <mask> through a process known as photosynthesis.\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"Plants create <mask> through a process known as photosynthesis.\", return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)"
        },
        {
            "sha": "f56692c17e3e7dc4906c41da0ca728f5f91903d7",
            "filename": "docs/source/en/model_doc/roc_bert.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Froc_bert.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Froc_bert.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Froc_bert.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -65,7 +65,7 @@ model = AutoModelForMaskedLM.from_pretrained(\n    torch_dtype=torch.float16,\n    device_map=\"auto\",\n )\n-inputs = tokenizer(\"這家餐廳的拉麵是我[MASK]過的最好的拉麵之\", return_tensors=\"pt\").to(\"cuda\")\n+inputs = tokenizer(\"這家餐廳的拉麵是我[MASK]過的最好的拉麵之\", return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n    outputs = model(**inputs)"
        },
        {
            "sha": "b6d8bc295fe05dd39d9427ae73e53e3478a7545f",
            "filename": "docs/source/en/model_doc/sam.md",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fsam.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fsam.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fsam.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -52,9 +52,9 @@ Below is an example on how to run mask generation given an image and a 2D point:\n import torch\n from PIL import Image\n import requests\n-from transformers import SamModel, SamProcessor\n+from transformers import SamModel, SamProcessor, infer_device\n \n-device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+device = infer_device()\n model = SamModel.from_pretrained(\"facebook/sam-vit-huge\").to(device)\n processor = SamProcessor.from_pretrained(\"facebook/sam-vit-huge\")\n \n@@ -78,9 +78,9 @@ You can also process your own masks alongside the input images in the processor\n import torch\n from PIL import Image\n import requests\n-from transformers import SamModel, SamProcessor\n+from transformers import SamModel, SamProcessor, infer_device\n \n-device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+device = infer_device()\n model = SamModel.from_pretrained(\"facebook/sam-vit-huge\").to(device)\n processor = SamProcessor.from_pretrained(\"facebook/sam-vit-huge\")\n "
        },
        {
            "sha": "67d4584b48b143c179d88f1e097291b90851b33f",
            "filename": "docs/source/en/model_doc/sam2_video.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fsam2_video.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fsam2_video.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fsam2_video.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -52,10 +52,10 @@ SAM2's key strength is its ability to track objects across video frames. Here's\n #### Basic Video Tracking\n \n ```python\n->>> from transformers import Sam2VideoModel, Sam2VideoProcessor\n+>>> from transformers import Sam2VideoModel, Sam2VideoProcessor, infer_device\n >>> import torch\n \n->>> device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+>>> device = infer_device()\n >>> model = Sam2VideoModel.from_pretrained(\"facebook/sam2.1-hiera-tiny\").to(device, dtype=torch.bfloat16)\n >>> processor = Sam2VideoProcessor.from_pretrained(\"facebook/sam2.1-hiera-tiny\")\n "
        },
        {
            "sha": "f8fb56ffbb54eeacc59484315ec802cc09e60ed6",
            "filename": "docs/source/en/model_doc/siglip2.md",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fsiglip2.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fsiglip2.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fsiglip2.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -74,7 +74,7 @@ candidate_labels = [\"a Pallas cat\", \"a lion\", \"a Siberian tiger\"]\n texts = [f'This is a photo of {label}.' for label in candidate_labels]\n \n # IMPORTANT: we pass `padding=max_length` and `max_length=64` since the model was trained with this\n-inputs = processor(text=texts, images=image, padding=\"max_length\", max_length=64, return_tensors=\"pt\").to(\"cuda\")\n+inputs = processor(text=texts, images=image, padding=\"max_length\", max_length=64, return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)\n@@ -102,7 +102,7 @@ candidate_labels = [\"a Pallas cat\", \"a lion\", \"a Siberian tiger\"]\n texts = [f'This is a photo of {label}.' for label in candidate_labels]\n \n # default value for `max_num_patches` is 256, but you can increase resulted image resolution providing higher values e.g. `max_num_patches=512`\n-inputs = processor(text=texts, images=image, padding=\"max_length\", max_num_patches=256, return_tensors=\"pt\").to(\"cuda\")\n+inputs = processor(text=texts, images=image, padding=\"max_length\", max_num_patches=256, return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)\n@@ -137,7 +137,7 @@ candidate_labels = [\"a Pallas cat\", \"a lion\", \"a Siberian tiger\"]\n texts = [f'This is a photo of {label}.' for label in candidate_labels]\n \n # IMPORTANT: we pass `padding=max_length` and `max_length=64` since the model was trained with this\n-inputs = processor(text=texts, images=image, padding=\"max_length\", max_length=64, return_tensors=\"pt\").to(\"cuda\")\n+inputs = processor(text=texts, images=image, padding=\"max_length\", max_length=64, return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n     outputs = model(**inputs)\n@@ -149,7 +149,7 @@ print(f\"{probs[0][0]:.1%} that image 0 is '{candidate_labels[0]}'\")\n \n ## Notes\n \n-- Training is supported for DDP and FSDP on single-node multi-GPU setups. However, it does not use [torch.distributed](https://pytorch.org/tutorials/beginner/dist_overview.html) utilities which may limit the scalability of batch size.\n+- Training is supported for DDP and FSDP on single-node multi-accelerator setups. However, it does not use [torch.distributed](https://pytorch.org/tutorials/beginner/dist_overview.html) utilities which may limit the scalability of batch size.\n - When using the standalone [`GemmaTokenizerFast`] make sure to pass `padding=\"max_length\"` and `max_length=64` as that's how the model was trained.\n - Model was trained with *lowercased* text, so make sure your text labels are preprocessed the same way.\n - To get the same results as the [`Pipeline`], a prompt template of `\"This is a photo of {label}.\"` should be passed to the processor."
        },
        {
            "sha": "dc92ffb81a6829a6816c7640681ee7bf50b7c42b",
            "filename": "docs/source/en/model_doc/smolvlm.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fsmolvlm.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fsmolvlm.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fsmolvlm.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -63,7 +63,7 @@ processor = AutoProcessor.from_pretrained(\"HuggingFaceTB/SmolVLM2-256M-Video-Ins\n model = AutoModelForImageTextToText.from_pretrained(\n     \"HuggingFaceTB/SmolVLM2-256M-Video-Instruct\",\n     torch_dtype=torch.bfloat16,\n-    device_map=\"cuda\"\n+    device_map=\"auto\"\n )\n \n conversation = [\n@@ -125,7 +125,7 @@ processor = AutoProcessor.from_pretrained(\"HuggingFaceTB/SmolVLM2-256M-Video-Ins\n model = AutoModelForImageTextToText.from_pretrained(\n     \"HuggingFaceTB/SmolVLM2-256M-Video-Instruct\",\n     torch_dtype=torch.bfloat16,\n-    device_map=\"cuda\"\n+    device_map=\"auto\"\n )\n \n # Conversation for the first image"
        },
        {
            "sha": "2d27aed399cd5fdd91786af8f6ee06c4c3ca1b4d",
            "filename": "docs/source/en/model_doc/starcoder2.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fstarcoder2.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fstarcoder2.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fstarcoder2.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -49,7 +49,7 @@ These ready-to-use checkpoints can be downloaded and used via the HuggingFace Hu\n \n >>> prompt = \"def print_hello_world():\"\n \n->>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(\"cuda\")\n+>>> model_inputs = tokenizer([prompt], return_tensors=\"pt\").to(model.device)\n \n >>> generated_ids = model.generate(**model_inputs, max_new_tokens=10, do_sample=False)\n >>> tokenizer.batch_decode(generated_ids)[0]"
        },
        {
            "sha": "7d4ccfe332cc6e930cf367a436ae70199436965c",
            "filename": "docs/source/en/model_doc/timesfm.md",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Ftimesfm.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Ftimesfm.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Ftimesfm.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -47,7 +47,7 @@ model = TimesFmModelForPrediction.from_pretrained(\n     \"google/timesfm-2.0-500m-pytorch\",\n     torch_dtype=torch.bfloat16,\n     attn_implementation=\"sdpa\",\n-    device_map=\"cuda\" if torch.cuda.is_available() else None\n+    device_map=\"auto\"\n )\n \n \n@@ -61,12 +61,10 @@ frequency_input = [0, 1, 2]\n \n # Convert inputs to sequence of tensors\n forecast_input_tensor = [\n-    torch.tensor(ts, dtype=torch.bfloat16).to(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n+    torch.tensor(ts, dtype=torch.bfloat16).to(model.device)\n     for ts in forecast_input\n ]\n-frequency_input_tensor = torch.tensor(frequency_input, dtype=torch.long).to(\n-    \"cuda\" if torch.cuda.is_available() else \"cpu\"\n-)\n+frequency_input_tensor = torch.tensor(frequency_input, dtype=torch.long).to(model.device)\n \n # Get predictions from the pre-trained model\n with torch.no_grad():"
        },
        {
            "sha": "aa21e18d536578b62aee1be54591d1f74a6ff44f",
            "filename": "docs/source/en/model_doc/wav2vec2.md",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fwav2vec2.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fwav2vec2.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fwav2vec2.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -159,13 +159,14 @@ Otherwise, [`~Wav2Vec2ProcessorWithLM.batch_decode`] performance will be slower\n ```python\n >>> # Let's see how to use a user-managed pool for batch decoding multiple audios\n >>> from multiprocessing import get_context\n->>> from transformers import AutoTokenizer, AutoProcessor, AutoModelForCTC\n+>>> from transformers import AutoTokenizer, AutoProcessor, AutoModelForCTC, infer_device\n >>> from datasets import load_dataset\n >>> import datasets\n >>> import torch\n \n+>>> device = infer_device()\n >>> # import model, feature extractor, tokenizer\n->>> model = AutoModelForCTC.from_pretrained(\"patrickvonplaten/wav2vec2-base-100h-with-lm\").to(\"cuda\")\n+>>> model = AutoModelForCTC.from_pretrained(\"patrickvonplaten/wav2vec2-base-100h-with-lm\").to(device)\n >>> processor = AutoProcessor.from_pretrained(\"patrickvonplaten/wav2vec2-base-100h-with-lm\")\n \n >>> # load example dataset\n@@ -183,8 +184,9 @@ Otherwise, [`~Wav2Vec2ProcessorWithLM.batch_decode`] performance will be slower\n \n \n >>> def map_to_pred(batch, pool):\n+...     device = infer_device()\n ...     inputs = processor(batch[\"speech\"], sampling_rate=16_000, padding=True, return_tensors=\"pt\")\n-...     inputs = {k: v.to(\"cuda\") for k, v in inputs.items()}\n+...     inputs = {k: v.to(device) for k, v in inputs.items()}\n \n ...     with torch.no_grad():\n ...         logits = model(**inputs).logits"
        },
        {
            "sha": "ef06db04ac6a3a2691187d6ffec304ca0b3fa0f7",
            "filename": "docs/source/en/model_doc/zamba.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fzamba.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fzamba.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fzamba.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -60,7 +60,7 @@ tokenizer = AutoTokenizer.from_pretrained(\"Zyphra/Zamba-7B-v1\")\n model = AutoModelForCausalLM.from_pretrained(\"Zyphra/Zamba-7B-v1\", device_map=\"auto\", torch_dtype=torch.bfloat16)\n \n input_text = \"A funny prompt would be \"\n-input_ids = tokenizer(input_text, return_tensors=\"pt\").to(\"cuda\")\n+input_ids = tokenizer(input_text, return_tensors=\"pt\").to(model.device)\n \n outputs = model.generate(**input_ids, max_new_tokens=100)\n print(tokenizer.decode(outputs[0]))"
        },
        {
            "sha": "5ab3f27fcf18188532586adb416c7f047f70a7e3",
            "filename": "docs/source/en/model_doc/zoedepth.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fzoedepth.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fmodel_doc%2Fzoedepth.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fzoedepth.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -72,7 +72,7 @@ model = AutoModelForDepthEstimation.from_pretrained(\n )\n url = \"https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/pipeline-cat-chonk.jpeg\"\n image = Image.open(requests.get(url, stream=True).raw)\n-inputs = image_processor(image, return_tensors=\"pt\").to(\"cuda\")\n+inputs = image_processor(image, return_tensors=\"pt\").to(model.device)\n \n with torch.no_grad():\n   outputs = model(inputs)\n@@ -128,4 +128,4 @@ Image.fromarray(depth.astype(\"uint8\"))\n ## ZoeDepthForDepthEstimation\n \n [[autodoc]] ZoeDepthForDepthEstimation\n-    - forward\n\\ No newline at end of file\n+    - forward"
        },
        {
            "sha": "18e273651c1f128b94f65caa978af35eeec8642a",
            "filename": "docs/source/en/quicktour.md",
            "status": "modified",
            "additions": 18,
            "deletions": 12,
            "changes": 30,
            "blob_url": "https://github.com/huggingface/transformers/blob/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fquicktour.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/eaa48c81e918a64d7d555d2e90da98573535a720/docs%2Fsource%2Fen%2Fquicktour.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fquicktour.md?ref=eaa48c81e918a64d7d555d2e90da98573535a720",
            "patch": "@@ -99,7 +99,7 @@ Use [`~PreTrainedModel.from_pretrained`] to load the weights and configuration f\n \n When you load a model, configure the following parameters to ensure the model is optimally loaded.\n \n-- `device_map=\"auto\"` automatically allocates the model weights to your fastest device first, which is typically the GPU.\n+- `device_map=\"auto\"` automatically allocates the model weights to your fastest device first.\n - `torch_dtype=\"auto\"` directly initializes the model weights in the data type they're stored in, which can help avoid loading the weights twice (PyTorch loads weights in `torch.float32` by default).\n \n ```py\n@@ -109,10 +109,10 @@ model = AutoModelForCausalLM.from_pretrained(\"meta-llama/Llama-2-7b-hf\", torch_d\n tokenizer = AutoTokenizer.from_pretrained(\"meta-llama/Llama-2-7b-hf\")\n ```\n \n-Tokenize the text and return PyTorch tensors with the tokenizer. Move the model to a GPU if it's available to accelerate inference.\n+Tokenize the text and return PyTorch tensors with the tokenizer. Move the model to an accelerator if it's available to accelerate inference.\n \n ```py\n-model_inputs = tokenizer([\"The secret to baking a good cake is \"], return_tensors=\"pt\").to(\"cuda\")\n+model_inputs = tokenizer([\"The secret to baking a good cake is \"], return_tensors=\"pt\").to(model.device)\n ```\n \n The model is now ready for inference or training.\n@@ -169,12 +169,14 @@ Create a [`Pipeline`] object and select a task. By default, [`Pipeline`] downloa\n <hfoptions id=\"pipeline-tasks\">\n <hfoption id=\"text generation\">\n \n-Set `device=\"cuda\"` to accelerate inference with a GPU.\n+Use [`~infer_device`] to automatically detect an available accelerator for inference.\n \n ```py\n-from transformers import pipeline\n+from transformers import pipeline, infer_device\n \n-pipeline = pipeline(\"text-generation\", model=\"meta-llama/Llama-2-7b-hf\", device=\"cuda\")\n+device = infer_device()\n+\n+pipeline = pipeline(\"text-generation\", model=\"meta-llama/Llama-2-7b-hf\", device=device)\n ```\n \n Prompt [`Pipeline`] with some initial text to generate more text.\n@@ -187,12 +189,14 @@ pipeline(\"The secret to baking a good cake is \", max_length=50)\n </hfoption>\n <hfoption id=\"image segmentation\">\n \n-Set `device=\"cuda\"` to accelerate inference with a GPU.\n+Use [`~infer_device`] to automatically detect an available accelerator for inference.\n \n ```py\n-from transformers import pipeline\n+from transformers import pipeline, infer_device\n+\n+device = infer_device()\n \n-pipeline = pipeline(\"image-segmentation\", model=\"facebook/detr-resnet-50-panoptic\", device=\"cuda\")\n+pipeline = pipeline(\"image-segmentation\", model=\"facebook/detr-resnet-50-panoptic\", device=device)\n ```\n \n Pass an image - a URL or local path to the image - to [`Pipeline`].\n@@ -212,12 +216,14 @@ segments[1][\"label\"]\n </hfoption>\n <hfoption id=\"automatic speech recognition\">\n \n-Set `device=\"cuda\"` to accelerate inference with a GPU.\n+Use [`~infer_device`] to automatically detect an available accelerator for inference.\n \n ```py\n-from transformers import pipeline\n+from transformers import pipeline, infer_device\n+\n+device = infer_device()\n \n-pipeline = pipeline(\"automatic-speech-recognition\", model=\"openai/whisper-large-v3\", device=\"cuda\")\n+pipeline = pipeline(\"automatic-speech-recognition\", model=\"openai/whisper-large-v3\", device=device)\n ```\n \n Pass an audio file to [`Pipeline`]."
        }
    ],
    "stats": {
        "total": 316,
        "additions": 157,
        "deletions": 159
    }
}