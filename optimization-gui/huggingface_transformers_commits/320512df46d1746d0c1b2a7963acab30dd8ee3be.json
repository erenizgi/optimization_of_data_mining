{
    "author": "kmehant",
    "message": "feat: add TP plan for granite (#35573)\n\nSigned-off-by: Mehant Kammakomati <mehant.kammakomati2@ibm.com>",
    "sha": "320512df46d1746d0c1b2a7963acab30dd8ee3be",
    "files": [
        {
            "sha": "404d60ca32a3e0b41d744ae8d292dc7dfe432de5",
            "filename": "src/transformers/models/granite/configuration_granite.py",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/huggingface/transformers/blob/320512df46d1746d0c1b2a7963acab30dd8ee3be/src%2Ftransformers%2Fmodels%2Fgranite%2Fconfiguration_granite.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/320512df46d1746d0c1b2a7963acab30dd8ee3be/src%2Ftransformers%2Fmodels%2Fgranite%2Fconfiguration_granite.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fgranite%2Fconfiguration_granite.py?ref=320512df46d1746d0c1b2a7963acab30dd8ee3be",
            "patch": "@@ -112,6 +112,16 @@ class GraniteConfig(PretrainedConfig):\n \n     model_type = \"granite\"\n     keys_to_ignore_at_inference = [\"past_key_values\"]\n+    # Default tensor parallel plan for base model `GraniteModel`\n+    base_model_tp_plan = {\n+        \"layers.*.self_attn.q_proj\": \"colwise\",\n+        \"layers.*.self_attn.k_proj\": \"colwise\",\n+        \"layers.*.self_attn.v_proj\": \"colwise\",\n+        \"layers.*.self_attn.o_proj\": \"rowwise\",\n+        \"layers.*.mlp.gate_proj\": \"colwise\",\n+        \"layers.*.mlp.up_proj\": \"colwise\",\n+        \"layers.*.mlp.down_proj\": \"rowwise\",\n+    }\n \n     def __init__(\n         self,"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 10,
        "deletions": 0
    }
}