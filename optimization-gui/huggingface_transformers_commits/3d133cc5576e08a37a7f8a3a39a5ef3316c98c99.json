{
    "author": "Rocketknight1",
    "message": "Stop DOSing the Hub in the CI (#37209)\n\n* As the title suggests, stop hammering the same files\n\n* make fixup\n\n* Use shutil instead of pathlib",
    "sha": "3d133cc5576e08a37a7f8a3a39a5ef3316c98c99",
    "files": [
        {
            "sha": "d3ce39fa89aa4ac20dfcbea3deb4860d6fdbbe63",
            "filename": "tests/models/fuyu/test_processor_fuyu.py",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/huggingface/transformers/blob/3d133cc5576e08a37a7f8a3a39a5ef3316c98c99/tests%2Fmodels%2Ffuyu%2Ftest_processor_fuyu.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/3d133cc5576e08a37a7f8a3a39a5ef3316c98c99/tests%2Fmodels%2Ffuyu%2Ftest_processor_fuyu.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Fmodels%2Ffuyu%2Ftest_processor_fuyu.py?ref=3d133cc5576e08a37a7f8a3a39a5ef3316c98c99",
            "patch": "@@ -1,6 +1,7 @@\n import io\n import tempfile\n import unittest\n+from shutil import rmtree\n \n import requests\n \n@@ -32,18 +33,21 @@\n class FuyuProcessingTest(ProcessorTesterMixin, unittest.TestCase):\n     processor_class = FuyuProcessor\n \n-    def setUp(self):\n-        self.tmpdirname = tempfile.mkdtemp()\n+    @classmethod\n+    def setUpClass(cls):\n+        cls.tmpdirname = tempfile.mkdtemp()\n+        # Ensure tempdir is cleaned up even if there's a failure\n+        cls.addClassCleanup(lambda tempdir=cls.tmpdirname: rmtree(tempdir))\n \n         image_processor = FuyuImageProcessor()\n         tokenizer = AutoTokenizer.from_pretrained(\"adept/fuyu-8b\")\n \n         processor = FuyuProcessor(image_processor=image_processor, tokenizer=tokenizer)\n-        processor.save_pretrained(self.tmpdirname)\n+        processor.save_pretrained(cls.tmpdirname)\n \n-        self.text_prompt = \"Generate a coco-style caption.\\\\n\"\n+        cls.text_prompt = \"Generate a coco-style caption.\\\\n\"\n         bus_image_url = \"https://huggingface.co/datasets/hf-internal-testing/fixtures-captioning/resolve/main/bus.png\"\n-        self.bus_image_pil = Image.open(io.BytesIO(requests.get(bus_image_url).content))\n+        cls.bus_image_pil = Image.open(io.BytesIO(requests.get(bus_image_url).content))\n \n     def get_processor(self):\n         image_processor = FuyuImageProcessor()"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 9,
        "deletions": 5
    }
}