{
    "author": "ydshieh",
    "message": "pin torchcodec on CI docker image (#41703)\n\npin\n\nCo-authored-by: ydshieh <ydshieh@users.noreply.github.com>",
    "sha": "cb4d4f5b754ad95e0597af99414755a1f543cf28",
    "files": [
        {
            "sha": "5034c4da384f18343144ac1c78abce4a2c925155",
            "filename": "docker/transformers-all-latest-gpu/Dockerfile",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/huggingface/transformers/blob/cb4d4f5b754ad95e0597af99414755a1f543cf28/docker%2Ftransformers-all-latest-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/cb4d4f5b754ad95e0597af99414755a1f543cf28/docker%2Ftransformers-all-latest-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-all-latest-gpu%2FDockerfile?ref=cb4d4f5b754ad95e0597af99414755a1f543cf28",
            "patch": "@@ -24,7 +24,8 @@ RUN git clone https://github.com/huggingface/transformers && cd transformers &&\n # 1. Put several commands in a single `RUN` to avoid image/layer exporting issue. Could be revised in the future.\n # 2. Regarding `torch` part, We might need to specify proper versions for `torchvision` and `torchaudio`.\n #    Currently, let's not bother to specify their versions explicitly (so installed with their latest release versions).\n-RUN python3 -m pip install --no-cache-dir -e ./transformers[dev,onnxruntime] && [ ${#PYTORCH} -gt 0 -a \"$PYTORCH\" != \"pre\" ] && VERSION='torch=='$PYTORCH'.*' ||  VERSION='torch'; echo \"export VERSION='$VERSION'\" >> ~/.profile && echo torch=$VERSION && [ \"$PYTORCH\" != \"pre\" ] && python3 -m pip install --no-cache-dir -U $VERSION torchvision torchaudio torchcodec --extra-index-url https://download.pytorch.org/whl/$CUDA || python3 -m pip install --no-cache-dir -U --pre torch torchvision torchaudio torchcodec --extra-index-url https://download.pytorch.org/whl/nightly/$CUDA\n+# 3. For `torchcodec<0.8`: this is quickly added as torch 2.9.0 + torchcodec 0.8.0 fails on our CI env. Need to remove later once they work.\n+RUN python3 -m pip install --no-cache-dir -e ./transformers[dev,onnxruntime] && [ ${#PYTORCH} -gt 0 -a \"$PYTORCH\" != \"pre\" ] && VERSION='torch=='$PYTORCH'.*' ||  VERSION='torch'; echo \"export VERSION='$VERSION'\" >> ~/.profile && echo torch=$VERSION && [ \"$PYTORCH\" != \"pre\" ] && python3 -m pip install --no-cache-dir -U $VERSION torchvision torchaudio \"torchcodec<0.8\" --extra-index-url https://download.pytorch.org/whl/$CUDA || python3 -m pip install --no-cache-dir -U --pre torch torchvision torchaudio torchcodec --extra-index-url https://download.pytorch.org/whl/nightly/$CUDA\n \n RUN python3 -m pip install --no-cache-dir -U timm\n "
        }
    ],
    "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
    }
}