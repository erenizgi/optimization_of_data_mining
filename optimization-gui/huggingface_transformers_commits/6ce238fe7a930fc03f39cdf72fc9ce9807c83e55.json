{
    "author": "Cyrilvallez",
    "message": "Fix test (#37213)\n\n* Update test_modeling_common.py\n\n* style",
    "sha": "6ce238fe7a930fc03f39cdf72fc9ce9807c83e55",
    "files": [
        {
            "sha": "42aea7b67d0064188dff022b663d6118690dc8a8",
            "filename": "tests/test_modeling_common.py",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/huggingface/transformers/blob/6ce238fe7a930fc03f39cdf72fc9ce9807c83e55/tests%2Ftest_modeling_common.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/6ce238fe7a930fc03f39cdf72fc9ce9807c83e55/tests%2Ftest_modeling_common.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Ftest_modeling_common.py?ref=6ce238fe7a930fc03f39cdf72fc9ce9807c83e55",
            "patch": "@@ -860,11 +860,12 @@ def test_causal_lm_can_accept_kwargs(self):\n                         model_eager = AutoModelForCausalLM.from_config(config, torch_dtype=torch.float32)\n \n                     model_eager.save_pretrained(tmpdir)\n-                    with torch.device(torch_device):\n-                        model = AutoModelForCausalLM.from_pretrained(tmpdir, torch_dtype=torch.float32)\n-                        inputs_dict[\"num_items_in_batch\"] = inputs_dict[\"input_ids\"].shape[0]\n-                        inputs_dict[\"labels\"] = inputs_dict[\"input_ids\"]\n-                        _ = model(**inputs_dict, return_dict=False)\n+                    model = AutoModelForCausalLM.from_pretrained(\n+                        tmpdir, torch_dtype=torch.float32, device_map=torch_device\n+                    )\n+                    inputs_dict[\"num_items_in_batch\"] = inputs_dict[\"input_ids\"].shape[0]\n+                    inputs_dict[\"labels\"] = inputs_dict[\"input_ids\"]\n+                    _ = model(**inputs_dict, return_dict=False)\n \n     def test_training_gradient_checkpointing(self):\n         # Scenario - 1 default behaviour"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 6,
        "deletions": 5
    }
}