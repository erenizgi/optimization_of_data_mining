{
    "author": "Rocketknight1",
    "message": "Fix auto-assign reviewers (#36631)\n\n* Fix auto-assign reviewers\n\n* Clean up endanchor a bit\n\n* We don't actually need the end anchor at all",
    "sha": "a929c466d053cd51dd06f51eb17ef84495fb37c3",
    "files": [
        {
            "sha": "1b8fd9b4be0919d406d9fddc99ee80435b0e4b10",
            "filename": ".github/scripts/assign_reviewers.py",
            "status": "modified",
            "additions": 16,
            "deletions": 5,
            "changes": 21,
            "blob_url": "https://github.com/huggingface/transformers/blob/a929c466d053cd51dd06f51eb17ef84495fb37c3/.github%2Fscripts%2Fassign_reviewers.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/a929c466d053cd51dd06f51eb17ef84495fb37c3/.github%2Fscripts%2Fassign_reviewers.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fscripts%2Fassign_reviewers.py?ref=a929c466d053cd51dd06f51eb17ef84495fb37c3",
            "patch": "@@ -17,10 +17,19 @@\n import github\n import json\n from github import Github\n-from fnmatch import fnmatch\n+import re\n from collections import Counter\n from pathlib import Path\n \n+def pattern_to_regex(pattern):\n+    start_anchor = pattern.startswith(\"/\")\n+    pattern = re.escape(pattern)\n+    # Replace `*` with \"any number of non-slash characters\"\n+    pattern = pattern.replace(r\"\\*\", \"[^/]*\")\n+    if start_anchor:\n+        pattern = \"^\" + pattern\n+    return pattern\n+\n def get_file_owners(file_path, codeowners_lines):\n     # Process lines in reverse (last matching pattern takes precedence)\n     for line in reversed(codeowners_lines):\n@@ -36,18 +45,20 @@ def get_file_owners(file_path, codeowners_lines):\n         owners = [owner.removeprefix(\"@\") for owner in parts[1:]]\n \n         # Check if file matches pattern\n-        if fnmatch(file_path, pattern):\n+        file_regex = pattern_to_regex(pattern)\n+        if re.search(file_regex, file_path) is not None:\n             return owners  # Remember, can still be empty!\n     return []  # Should never happen, but just in case\n \n def main():\n+    script_dir = Path(__file__).parent.absolute()\n+    with open(script_dir / \"codeowners_for_review_action\") as f:\n+        codeowners_lines = f.readlines()\n+\n     g = Github(os.environ['GITHUB_TOKEN'])\n     repo = g.get_repo(\"huggingface/transformers\")\n     with open(os.environ['GITHUB_EVENT_PATH']) as f:\n         event = json.load(f)\n-    script_dir = Path(__file__).parent.absolute()\n-    with open(script_dir / \"codeowners_for_review_action\") as f:\n-        codeowners_lines = f.readlines()\n \n     # The PR number is available in the event payload\n     pr_number = event['pull_request']['number']"
        },
        {
            "sha": "f3da6d516ca8fbb020f68447e22e12ad19837ede",
            "filename": ".github/scripts/codeowners_for_review_action",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/a929c466d053cd51dd06f51eb17ef84495fb37c3/.github%2Fscripts%2Fcodeowners_for_review_action",
            "raw_url": "https://github.com/huggingface/transformers/raw/a929c466d053cd51dd06f51eb17ef84495fb37c3/.github%2Fscripts%2Fcodeowners_for_review_action",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fscripts%2Fcodeowners_for_review_action?ref=a929c466d053cd51dd06f51eb17ef84495fb37c3",
            "patch": "@@ -11,14 +11,14 @@ docs/ @stevhliu\n /src/transformers/models/*/image_processing* @qubvel\n /src/transformers/models/*/image_processing_*_fast* @yonigozlan\n \n-\n # Owners of subsections of the library\n /src/transformers/generation/ @gante\n /src/transformers/pipeline/ @Rocketknight1 @yonigozlan\n /src/transformers/integrations/ @SunMarc @MekkCyber @muellerzr\n /src/transformers/quantizers/ @SunMarc @MekkCyber\n-/src/transformers/tests/ @ydshieh\n-/src/transformers/tests/generation/ @gante\n+tests/ @ydshieh\n+tests/generation/ @gante\n+\n /src/transformers/models/auto/ @ArthurZucker\n /src/transformers/utils/ @ArthurZucker @Rocketknight1\n /src/transformers/loss/ @ArthurZucker"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 19,
        "deletions": 8
    }
}