{
    "author": "jiqing-feng",
    "message": "update doc (#34478)\n\n* update doc\r\n\r\n* Update docs/source/en/perf_train_cpu.md\r\n\r\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\r\n\r\n* delete closing tip\r\n\r\n---------\r\n\r\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>",
    "sha": "2801d7bcf6ebb256ad807f41815a0a2a50e83f0e",
    "files": [
        {
            "sha": "7ef98932d537acd1dab92614fcd36a6556d704e3",
            "filename": "docs/source/en/perf_train_cpu.md",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/huggingface/transformers/blob/2801d7bcf6ebb256ad807f41815a0a2a50e83f0e/docs%2Fsource%2Fen%2Fperf_train_cpu.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/2801d7bcf6ebb256ad807f41815a0a2a50e83f0e/docs%2Fsource%2Fen%2Fperf_train_cpu.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fperf_train_cpu.md?ref=2801d7bcf6ebb256ad807f41815a0a2a50e83f0e",
            "patch": "@@ -18,11 +18,11 @@ rendered properly in your Markdown viewer.\n This guide focuses on training large models efficiently on CPU.\n \n ## Mixed precision with IPEX\n-Mixed precision uses single (fp32) and half-precision (bf16/fp16) data types in a model to accelerate training or inference while still preserving much of the single-precision accuracy. Modern CPUs such as 3rd and 4th Gen Intel® Xeon® Scalable processors natively support bf16, so you should get more performance out of the box by enabling mixed precision training with bf16.\n+Mixed precision uses single (fp32) and half-precision (bf16/fp16) data types in a model to accelerate training or inference while still preserving much of the single-precision accuracy. Modern CPUs such as 3rd, 4th, and 5th Gen Intel® Xeon® Scalable processors natively support bf16. 6th Gen Intel® Xeon® Scalable processors natively support bf16 and fp16. You should get more performance out of the box by enabling mixed precision training with bf16 or fp16.\n \n To further maximize training performance, you can use Intel® Extension for PyTorch (IPEX), which is a library built on PyTorch and adds additional CPU instruction level architecture (ISA) level support such as Intel® Advanced Vector Extensions 512 Vector Neural Network Instructions (Intel® AVX512-VNNI), and Intel® Advanced Matrix Extensions (Intel® AMX) for an extra performance boost on Intel CPUs. However, CPUs with only AVX2 (e.g., AMD or older Intel CPUs) are not guaranteed to have better performance under IPEX.\n \n-Auto Mixed Precision (AMP) for CPU backends has been enabled since PyTorch 1.10. AMP support for bf16 on CPUs and bf16 operator optimization is also supported in IPEX and partially upstreamed to the main PyTorch branch. You can get better performance and user experience with IPEX AMP.\n+Auto Mixed Precision (AMP) for CPU backends has been enabled since PyTorch 1.10. AMP support for bf16/fp16 on CPUs and bf16/fp16 operator optimization is also supported in IPEX and partially upstreamed to the main PyTorch branch. You can get better performance and user experience with IPEX AMP.\n \n Check more detailed information for [Auto Mixed Precision](https://intel.github.io/intel-extension-for-pytorch/cpu/latest/tutorials/features/amp.html).\n \n@@ -32,10 +32,10 @@ IPEX release is following PyTorch, to install via pip:\n \n | PyTorch Version   | IPEX version   |\n | :---------------: | :----------:   |\n-| 2.1.x             |  2.1.100+cpu   |\n-| 2.0.x             |  2.0.100+cpu   |\n-| 1.13              |  1.13.0+cpu    |\n-| 1.12              |  1.12.300+cpu  |\n+| 2.5.0             |  2.5.0+cpu     |\n+| 2.4.0             |  2.4.0+cpu     |\n+| 2.3.0             |  2.3.0+cpu     |\n+| 2.2.0             |  2.2.0+cpu     |\n \n Please run `pip list | grep torch` to get your `pytorch_version`, so you can get the `IPEX version_name`.\n ```bash\n@@ -46,7 +46,7 @@ You can check the latest versions in [ipex-whl-stable-cpu](https://developer.int\n Check more approaches for [IPEX installation](https://intel.github.io/intel-extension-for-pytorch/cpu/latest/tutorials/installation.html).\n \n ### Usage in Trainer\n-To enable auto mixed precision with IPEX in Trainer, users should add `use_ipex`, `bf16` and `no_cuda` in training command arguments.\n+To enable auto mixed precision with IPEX in Trainer, users should add `use_ipex`, `bf16` or `fp16`, and `no_cuda` in training command arguments.\n \n Take an example of the use cases on [Transformers question-answering](https://github.com/huggingface/transformers/tree/main/examples/pytorch/question-answering)\n "
        },
        {
            "sha": "ed782caca3b1f128e129aa3edf5fe685102af5bb",
            "filename": "docs/source/en/perf_train_cpu_many.md",
            "status": "modified",
            "additions": 10,
            "deletions": 24,
            "changes": 34,
            "blob_url": "https://github.com/huggingface/transformers/blob/2801d7bcf6ebb256ad807f41815a0a2a50e83f0e/docs%2Fsource%2Fen%2Fperf_train_cpu_many.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/2801d7bcf6ebb256ad807f41815a0a2a50e83f0e/docs%2Fsource%2Fen%2Fperf_train_cpu_many.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fperf_train_cpu_many.md?ref=2801d7bcf6ebb256ad807f41815a0a2a50e83f0e",
            "patch": "@@ -30,46 +30,32 @@ Check more detailed information for [oneccl_bind_pt](https://github.com/intel/to\n \n Wheel files are available for the following Python versions:\n \n-| Extension Version | Python 3.6 | Python 3.7 | Python 3.8 | Python 3.9 | Python 3.10 |\n-| :---------------: | :--------: | :--------: | :--------: | :--------: | :---------: |\n-| 2.1.0             |            | √          | √          | √          | √           |\n-| 2.0.0             |            | √          | √          | √          | √           |\n-| 1.13.0            |            | √          | √          | √          | √           |\n-| 1.12.100          |            | √          | √          | √          | √           |\n-| 1.12.0            |            | √          | √          | √          | √           |\n+| Extension Version | Python 3.7 | Python 3.8 | Python 3.9 | Python 3.10 | Python 3.11 |\n+| :---------------: | :--------: | :--------: | :--------: | :---------: | :---------: |\n+| 2.5.0             |            | √          | √          | √           | √           |\n+| 2.4.0             |            | √          | √          | √           | √           |\n+| 2.3.0             |            | √          | √          | √           | √           |\n+| 2.2.0             |            | √          | √          | √           | √           |\n \n Please run `pip list | grep torch` to get your `pytorch_version`.\n ```bash\n pip install oneccl_bind_pt=={pytorch_version} -f https://developer.intel.com/ipex-whl-stable-cpu\n ```\n-where `{pytorch_version}` should be your PyTorch version, for instance 2.1.0.\n+where `{pytorch_version}` should be your PyTorch version, for instance 2.4.0.\n Check more approaches for [oneccl_bind_pt installation](https://github.com/intel/torch-ccl).\n Versions of oneCCL and PyTorch must match.\n \n-<Tip warning={true}>\n-\n-oneccl_bindings_for_pytorch 1.12.0 prebuilt wheel does not work with PyTorch 1.12.1 (it is for PyTorch 1.12.0)\n-PyTorch 1.12.1 should work with oneccl_bindings_for_pytorch 1.12.100\n-\n-</Tip>\n \n ## Intel® MPI library\n Use this standards-based MPI implementation to deliver flexible, efficient, scalable cluster messaging on Intel® architecture. This component is part of the Intel® oneAPI HPC Toolkit.\n \n oneccl_bindings_for_pytorch is installed along with the MPI tool set. Need to source the environment before using it.\n \n-for Intel® oneCCL >= 1.12.0\n ```bash\n oneccl_bindings_for_pytorch_path=$(python -c \"from oneccl_bindings_for_pytorch import cwd; print(cwd)\")\n source $oneccl_bindings_for_pytorch_path/env/setvars.sh\n ```\n \n-for Intel® oneCCL whose version < 1.12.0\n-```bash\n-torch_ccl_path=$(python -c \"import torch; import torch_ccl; import os;  print(os.path.abspath(os.path.dirname(torch_ccl.__file__)))\")\n-source $torch_ccl_path/env/setvars.sh\n-```\n-\n #### Intel® Extension for PyTorch installation\n \n Intel Extension for PyTorch (IPEX) provides performance optimizations for CPU training with both Float32 and BFloat16 (refer to the [single CPU section](./perf_train_cpu) to learn more).\n@@ -155,7 +141,7 @@ This example assumes that you have:\n The snippet below is an example of a Dockerfile that uses a base image that supports distributed CPU training and then\n extracts a Transformers release to the `/workspace` directory, so that the example scripts are included in the image:\n ```dockerfile\n-FROM intel/intel-optimized-pytorch:2.3.0-pip-multinode\n+FROM intel/intel-optimized-pytorch:2.4.0-pip-multinode\n \n RUN apt-get update -y && \\\n     apt-get install -y --no-install-recommends --fix-missing \\\n@@ -165,7 +151,7 @@ RUN apt-get update -y && \\\n WORKDIR /workspace\n \n # Download and extract the transformers code\n-ARG HF_TRANSFORMERS_VER=\"4.44.0\"\n+ARG HF_TRANSFORMERS_VER=\"4.46.0\"\n RUN pip install --no-cache-dir \\\n     transformers==${HF_TRANSFORMERS_VER} && \\\n     mkdir transformers && \\\n@@ -319,4 +305,4 @@ with the job, the PyTorchJob resource can be deleted from the cluster using `kub\n \n This guide covered running distributed PyTorch training jobs using multiple CPUs on bare metal and on a Kubernetes\n cluster. Both cases utilize Intel Extension for PyTorch and Intel oneCCL Bindings for PyTorch for optimal training\n-performance, and can be used as a template to run your own workload on multiple nodes.\n\\ No newline at end of file\n+performance, and can be used as a template to run your own workload on multiple nodes."
        }
    ],
    "stats": {
        "total": 48,
        "additions": 17,
        "deletions": 31
    }
}