{
    "author": "m-gallus",
    "message": "Fix error on importing unavailable torch.distributed (#40038)\n\nCurrently model_debugging_utils.py would have an unguarded `import torch.distributed.tensor`. This PR ensures that the distributed module is available before including its tensor module.",
    "sha": "a5fac1c394eafb07312519fcef48ffe8f1a247dc",
    "files": [
        {
            "sha": "de560300bec279c2c4f8b3dd21b559bb1f5576c7",
            "filename": "src/transformers/model_debugging_utils.py",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/huggingface/transformers/blob/a5fac1c394eafb07312519fcef48ffe8f1a247dc/src%2Ftransformers%2Fmodel_debugging_utils.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/a5fac1c394eafb07312519fcef48ffe8f1a247dc/src%2Ftransformers%2Fmodel_debugging_utils.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodel_debugging_utils.py?ref=a5fac1c394eafb07312519fcef48ffe8f1a247dc",
            "patch": "@@ -26,11 +26,13 @@\n \n if is_torch_available():\n     import torch\n-    import torch.distributed.tensor\n     from safetensors.torch import save_file\n \n     # Note to code inspectors: this toolbox is intended for people who add models to `transformers`.\n-    _torch_distributed_available = torch.distributed.is_available()\n+    if torch.distributed.is_available():\n+        import torch.distributed.tensor\n+\n+        _torch_distributed_available = True\n else:\n     _torch_distributed_available = False\n from .utils import logging"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
    }
}