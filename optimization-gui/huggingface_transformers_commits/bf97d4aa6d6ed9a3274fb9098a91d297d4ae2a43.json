{
    "author": "ydshieh",
    "message": "Fix benchmark script (#32635)\n\n* fix\r\n\r\n* >= 0.3.0\r\n\r\n---------\r\n\r\nCo-authored-by: ydshieh <ydshieh@users.noreply.github.com>",
    "sha": "bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43",
    "files": [
        {
            "sha": "cb9a3d7b7974aa64b63f6185ab8acb236d6f9d41",
            "filename": ".github/workflows/benchmark.yml",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43/.github%2Fworkflows%2Fbenchmark.yml",
            "raw_url": "https://github.com/huggingface/transformers/raw/bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43/.github%2Fworkflows%2Fbenchmark.yml",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fworkflows%2Fbenchmark.yml?ref=bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43",
            "patch": "@@ -31,12 +31,12 @@ jobs:\n         if: github.event_name == 'schedule'\r\n         working-directory: /transformers\r\n         run: |\r\n-          python3 -m pip install optimum-benchmark>=0.2.0\r\n+          python3 -m pip install optimum-benchmark>=0.3.0\r\n           HF_TOKEN=${{ secrets.TRANSFORMERS_BENCHMARK_TOKEN }} python3 benchmark/benchmark.py --repo_id hf-internal-testing/benchmark_results --path_in_repo $(date +'%Y-%m-%d') --config-dir benchmark/config --config-name generation --commit=${{ github.sha }} backend.model=google/gemma-2b backend.cache_implementation=null,static backend.torch_compile=false,true --multirun\r\n \r\n       - name: Benchmark (merged to main event)\r\n         if: github.event_name == 'push' && github.ref_name == 'main'\r\n         working-directory: /transformers\r\n         run: |\r\n-          python3 -m pip install optimum-benchmark>=0.2.0\r\n+          python3 -m pip install optimum-benchmark>=0.3.0\r\n           HF_TOKEN=${{ secrets.TRANSFORMERS_BENCHMARK_TOKEN }} python3 benchmark/benchmark.py --repo_id hf-internal-testing/benchmark_results_merge_event --path_in_repo $(date +'%Y-%m-%d') --config-dir benchmark/config --config-name generation --commit=${{ github.sha }} backend.model=google/gemma-2b backend.cache_implementation=null,static backend.torch_compile=false,true --multirun\r"
        },
        {
            "sha": "304bbd4441cf660d3e4eb60e86b1ef36ccf979ec",
            "filename": "benchmark/benchmark.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43/benchmark%2Fbenchmark.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43/benchmark%2Fbenchmark.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/benchmark%2Fbenchmark.py?ref=bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43",
            "patch": "@@ -101,7 +101,7 @@ def summarize(run_dir, metrics, expand_metrics=False):\n         # post-processing of report: show a few selected/important metric\n         for metric in metrics:\n             keys = metric.split(\".\")\n-            value = report\n+            value = report.to_dict()\n             current = metrics_values\n             for key in keys:\n                 # Avoid KeyError when a user's specified metric has typo."
        },
        {
            "sha": "26cb0faca0713e740ffd82c1ccc2efa1123acd12",
            "filename": "setup.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43/setup.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43/setup.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/setup.py?ref=bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43",
            "patch": "@@ -137,7 +137,7 @@\n     \"onnxruntime-tools>=1.4.2\",\n     \"onnxruntime>=1.4.0\",\n     \"opencv-python\",\n-    \"optimum-benchmark>=0.2.0\",\n+    \"optimum-benchmark>=0.3.0\",\n     \"optuna\",\n     \"optax>=0.0.8,<=0.1.4\",\n     \"packaging>=20.0\","
        },
        {
            "sha": "d8347371b3ad89ce351a4e24f67c0f19c892c053",
            "filename": "src/transformers/dependency_versions_table.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43/src%2Ftransformers%2Fdependency_versions_table.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43/src%2Ftransformers%2Fdependency_versions_table.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fdependency_versions_table.py?ref=bf97d4aa6d6ed9a3274fb9098a91d297d4ae2a43",
            "patch": "@@ -43,7 +43,7 @@\n     \"onnxruntime-tools\": \"onnxruntime-tools>=1.4.2\",\n     \"onnxruntime\": \"onnxruntime>=1.4.0\",\n     \"opencv-python\": \"opencv-python\",\n-    \"optimum-benchmark\": \"optimum-benchmark>=0.2.0\",\n+    \"optimum-benchmark\": \"optimum-benchmark>=0.3.0\",\n     \"optuna\": \"optuna\",\n     \"optax\": \"optax>=0.0.8,<=0.1.4\",\n     \"packaging\": \"packaging>=20.0\","
        }
    ],
    "stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
    }
}