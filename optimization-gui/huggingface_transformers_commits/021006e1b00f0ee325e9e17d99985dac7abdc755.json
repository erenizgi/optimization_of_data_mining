{
    "author": "anadon",
    "message": "Fix removing \"cpu\" from frozenset in bitsandbytes.py to allow better ROCm support. (#36975)\n\n* Fix removing \"cpu\" from frozenset in bitsandbytes.py to allow better ROCm support.\n\nRelated to https://github.com/bitsandbytes-foundation/bitsandbytes/issues/1573 and https://github.com/huggingface/transformers/issues/36949 , this resolves a bug in allowing ROCm/HIP support in bitsandbytes.\n\n* Related to bitsandbytes-foundation/bitsandbytes#1573 and huggingface#36949 , this resolves a bug in the biteandbytes integration, allowing ROCm/HIP support in bitsandbytes.\n\n---------\n\nCo-authored-by: Mohamed Mekkouri <93391238+MekkCyber@users.noreply.github.com>",
    "sha": "021006e1b00f0ee325e9e17d99985dac7abdc755",
    "files": [
        {
            "sha": "3973dc58c062bc9b1755a24c708e39e1ad4016ce",
            "filename": "src/transformers/integrations/bitsandbytes.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/021006e1b00f0ee325e9e17d99985dac7abdc755/src%2Ftransformers%2Fintegrations%2Fbitsandbytes.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/021006e1b00f0ee325e9e17d99985dac7abdc755/src%2Ftransformers%2Fintegrations%2Fbitsandbytes.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fintegrations%2Fbitsandbytes.py?ref=021006e1b00f0ee325e9e17d99985dac7abdc755",
            "patch": "@@ -496,7 +496,9 @@ def _validate_bnb_multi_backend_availability(raise_exception):\n                 \"You have Intel IPEX installed but if you're intending to use it for CPU, it might not have the right version. Be sure to double check that your PyTorch and IPEX installs are compatible.\"\n             )\n \n-        available_devices.discard(\"cpu\")  # Only Intel CPU is supported by BNB at the moment\n+        available_devices = frozenset(\n+            [device for device in available_devices if device != \"cpu\"]\n+        )  # Only Intel CPU is supported by BNB at the moment\n \n     if not available_devices.intersection(bnb_supported_devices):\n         if raise_exception:"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 3,
        "deletions": 1
    }
}