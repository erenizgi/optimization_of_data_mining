{
    "author": "Cyrilvallez",
    "message": "Reduce Glm4v model test size significantly (#39173)\n\n* fix test size\n\n* Update test_modeling_glm4v.py",
    "sha": "2b4a12b5bf5b5fa609c64268c600e81fe8623afc",
    "files": [
        {
            "sha": "a9901ded23970a3c37eaa2f2467ae73de83adffe",
            "filename": "tests/models/glm4v/test_modeling_glm4v.py",
            "status": "modified",
            "additions": 8,
            "deletions": 14,
            "changes": 22,
            "blob_url": "https://github.com/huggingface/transformers/blob/2b4a12b5bf5b5fa609c64268c600e81fe8623afc/tests%2Fmodels%2Fglm4v%2Ftest_modeling_glm4v.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/2b4a12b5bf5b5fa609c64268c600e81fe8623afc/tests%2Fmodels%2Fglm4v%2Ftest_modeling_glm4v.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Fmodels%2Fglm4v%2Ftest_modeling_glm4v.py?ref=2b4a12b5bf5b5fa609c64268c600e81fe8623afc",
            "patch": "@@ -69,16 +69,15 @@ def __init__(\n         is_training=True,\n         text_config={\n             \"vocab_size\": 99,\n-            \"hidden_size\": 32,\n-            \"intermediate_size\": 37,\n-            \"num_hidden_layers\": 4,\n-            \"num_attention_heads\": 4,\n-            \"num_key_value_heads\": 2,\n+            \"hidden_size\": 16,\n+            \"intermediate_size\": 22,\n+            \"num_hidden_layers\": 2,\n+            \"num_attention_heads\": 2,\n+            \"num_key_value_heads\": 1,\n             \"output_channels\": 64,\n             \"hidden_act\": \"silu\",\n             \"max_position_embeddings\": 512,\n             \"rope_scaling\": {\"type\": \"default\", \"mrope_section\": [2, 1, 1]},\n-            \"max_window_layers\": 3,\n             \"rope_theta\": 10000,\n             \"tie_word_embeddings\": True,\n             \"bos_token_id\": 0,\n@@ -87,11 +86,10 @@ def __init__(\n         },\n         vision_config={\n             \"depth\": 2,\n-            \"embed_dim\": 32,\n             \"hidden_act\": \"silu\",\n-            \"hidden_size\": 32,\n-            \"mlp_ratio\": 4,\n-            \"num_heads\": 4,\n+            \"hidden_size\": 48,\n+            \"out_hidden_size\": 16,\n+            \"intermediate_size\": 22,\n             \"patch_size\": 14,\n             \"spatial_merge_size\": 1,\n             \"temporal_patch_size\": 2,\n@@ -239,10 +237,6 @@ def test_sdpa_can_dispatch_on_flash(self):\n     def test_multi_gpu_data_parallel_forward(self):\n         pass\n \n-    @unittest.skip(reason=\"We cannot configure to output a smaller model.\")\n-    def test_model_is_small(self):\n-        pass\n-\n     @unittest.skip(\"Error with compilation\")\n     def test_generate_from_inputs_embeds_with_static_cache(self):\n         pass"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 8,
        "deletions": 14
    }
}