{
    "author": "RyanMullins",
    "message": "fix: Gemma 3 weights conversion vision and multimodal projector paths (#41767)\n\nfix: Gemma 3 vision and multimodal projector paths",
    "sha": "48a36c96da1148e4fbb28b23b233c05ccf2516db",
    "files": [
        {
            "sha": "a963f1a3f62e2ae0b3817d8c3c33245da75a2bcd",
            "filename": "src/transformers/models/gemma3/convert_gemma3_weights.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/48a36c96da1148e4fbb28b23b233c05ccf2516db/src%2Ftransformers%2Fmodels%2Fgemma3%2Fconvert_gemma3_weights.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/48a36c96da1148e4fbb28b23b233c05ccf2516db/src%2Ftransformers%2Fmodels%2Fgemma3%2Fconvert_gemma3_weights.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fgemma3%2Fconvert_gemma3_weights.py?ref=48a36c96da1148e4fbb28b23b233c05ccf2516db",
            "patch": "@@ -447,7 +447,7 @@ def convert_transformer_weights(\n             return zip([], [])\n         else:\n             raise ValueError(f\"Unexpected member, {prop}, in Embedder.\")\n-    elif path.startswith(f\"{_TRANSFORMER_EMBEDDER}/mm\"):\n+    elif f\"{_TRANSFORMER_EMBEDDER}/mm_\" in path:\n         if not _INCLUDE_VISION_ENCODER.value:\n             return zip([], [])\n \n@@ -553,7 +553,7 @@ def update_tree(path: str, weights: np.ndarray, target_dtype: torch.dtype) -> No\n                 continue\n \n             path, weights = convert_siglip_weight(config=config.vision_config, paths=paths, weights=value)\n-            update_tree(path, weights, config.vision_config.dtype)\n+            update_tree(f\"model.{path}\", weights, config.vision_config.dtype)\n         else:\n             for path, weights in convert_transformer_weights(config=config.text_config, paths=paths, weights=value):\n                 if not _INCLUDE_VISION_ENCODER.value:"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    }
}