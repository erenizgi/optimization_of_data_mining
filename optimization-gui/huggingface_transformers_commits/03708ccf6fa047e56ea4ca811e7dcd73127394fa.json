{
    "author": "bzantium",
    "message": "add DeepseekV3ForTokenClassification (#40641)\n\n* add DeepseekV3ForTokenClassification\n\n* fix typo\n\n---------\n\nCo-authored-by: json.bourne <json.bourne@kakaocorp.com>",
    "sha": "03708ccf6fa047e56ea4ca811e7dcd73127394fa",
    "files": [
        {
            "sha": "d8eb2e942033c50664cfcb1201f0e9dd10b911f3",
            "filename": "docs/source/en/model_doc/deepseek_v3.md",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/huggingface/transformers/blob/03708ccf6fa047e56ea4ca811e7dcd73127394fa/docs%2Fsource%2Fen%2Fmodel_doc%2Fdeepseek_v3.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/03708ccf6fa047e56ea4ca811e7dcd73127394fa/docs%2Fsource%2Fen%2Fmodel_doc%2Fdeepseek_v3.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fdeepseek_v3.md?ref=03708ccf6fa047e56ea4ca811e7dcd73127394fa",
            "patch": "@@ -188,3 +188,8 @@ error, it means NCCL was probably not loaded.\n \n [[autodoc]] DeepseekV3ForSequenceClassification\n     - forward\n+\n+## DeepseekV3ForTokenClassification\n+\n+[[autodoc]] DeepseekV3ForTokenClassification\n+    - forward\n\\ No newline at end of file"
        },
        {
            "sha": "45eba2ec0a14aeafa1e0b384b392d0fdc8fb7dd9",
            "filename": "src/transformers/models/auto/modeling_auto.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/huggingface/transformers/blob/03708ccf6fa047e56ea4ca811e7dcd73127394fa/src%2Ftransformers%2Fmodels%2Fauto%2Fmodeling_auto.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/03708ccf6fa047e56ea4ca811e7dcd73127394fa/src%2Ftransformers%2Fmodels%2Fauto%2Fmodeling_auto.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fauto%2Fmodeling_auto.py?ref=03708ccf6fa047e56ea4ca811e7dcd73127394fa",
            "patch": "@@ -1412,6 +1412,7 @@ class _BaseModelWithGenerate(PreTrainedModel, GenerationMixin):\n         (\"data2vec-text\", \"Data2VecTextForTokenClassification\"),\n         (\"deberta\", \"DebertaForTokenClassification\"),\n         (\"deberta-v2\", \"DebertaV2ForTokenClassification\"),\n+        (\"deepseek_v3\", \"DeepseekV3ForTokenClassification\"),\n         (\"diffllama\", \"DiffLlamaForTokenClassification\"),\n         (\"distilbert\", \"DistilBertForTokenClassification\"),\n         (\"electra\", \"ElectraForTokenClassification\"),"
        },
        {
            "sha": "c4552fb218eec0550322702103d645ac286fa0b0",
            "filename": "src/transformers/models/deepseek_v3/modeling_deepseek_v3.py",
            "status": "modified",
            "additions": 10,
            "deletions": 1,
            "changes": 11,
            "blob_url": "https://github.com/huggingface/transformers/blob/03708ccf6fa047e56ea4ca811e7dcd73127394fa/src%2Ftransformers%2Fmodels%2Fdeepseek_v3%2Fmodeling_deepseek_v3.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/03708ccf6fa047e56ea4ca811e7dcd73127394fa/src%2Ftransformers%2Fmodels%2Fdeepseek_v3%2Fmodeling_deepseek_v3.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fdeepseek_v3%2Fmodeling_deepseek_v3.py?ref=03708ccf6fa047e56ea4ca811e7dcd73127394fa",
            "patch": "@@ -17,7 +17,11 @@\n from ...integrations import use_kernel_forward_from_hub\n from ...masking_utils import create_causal_mask\n from ...modeling_flash_attention_utils import FlashAttentionKwargs\n-from ...modeling_layers import GenericForSequenceClassification, GradientCheckpointingLayer\n+from ...modeling_layers import (\n+    GenericForSequenceClassification,\n+    GenericForTokenClassification,\n+    GradientCheckpointingLayer,\n+)\n from ...modeling_outputs import BaseModelOutputWithPast, CausalLMOutputWithPast\n from ...modeling_rope_utils import ROPE_INIT_FUNCTIONS, dynamic_rope_update\n from ...modeling_utils import ALL_ATTENTION_FUNCTIONS, PreTrainedModel\n@@ -676,9 +680,14 @@ class DeepseekV3ForSequenceClassification(GenericForSequenceClassification, Deep\n     pass\n \n \n+class DeepseekV3ForTokenClassification(GenericForTokenClassification, DeepseekV3PreTrainedModel):\n+    pass\n+\n+\n __all__ = [\n     \"DeepseekV3PreTrainedModel\",\n     \"DeepseekV3Model\",\n     \"DeepseekV3ForCausalLM\",\n     \"DeepseekV3ForSequenceClassification\",\n+    \"DeepseekV3ForTokenClassification\",\n ]"
        },
        {
            "sha": "38cc8dbb5ea10374dc0ad44c50e53674b157e7a1",
            "filename": "src/transformers/models/deepseek_v3/modular_deepseek_v3.py",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/huggingface/transformers/blob/03708ccf6fa047e56ea4ca811e7dcd73127394fa/src%2Ftransformers%2Fmodels%2Fdeepseek_v3%2Fmodular_deepseek_v3.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/03708ccf6fa047e56ea4ca811e7dcd73127394fa/src%2Ftransformers%2Fmodels%2Fdeepseek_v3%2Fmodular_deepseek_v3.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fdeepseek_v3%2Fmodular_deepseek_v3.py?ref=03708ccf6fa047e56ea4ca811e7dcd73127394fa",
            "patch": "@@ -9,7 +9,7 @@\n from ...activations import ACT2FN\n from ...cache_utils import Cache\n from ...modeling_flash_attention_utils import FlashAttentionKwargs\n-from ...modeling_layers import GenericForSequenceClassification\n+from ...modeling_layers import GenericForSequenceClassification, GenericForTokenClassification\n from ...modeling_utils import ALL_ATTENTION_FUNCTIONS, PreTrainedModel\n from ...processing_utils import Unpack\n from ...utils import logging\n@@ -361,9 +361,14 @@ class DeepseekV3ForSequenceClassification(GenericForSequenceClassification, Deep\n     pass\n \n \n+class DeepseekV3ForTokenClassification(GenericForTokenClassification, DeepseekV3PreTrainedModel):\n+    pass\n+\n+\n __all__ = [\n     \"DeepseekV3PreTrainedModel\",\n     \"DeepseekV3Model\",\n     \"DeepseekV3ForCausalLM\",\n     \"DeepseekV3ForSequenceClassification\",\n+    \"DeepseekV3ForTokenClassification\",\n ]"
        },
        {
            "sha": "9a7028ecc831bb55362af3cac9b4298a713e24ee",
            "filename": "tests/models/deepseek_v3/test_modeling_deepseek_v3.py",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/huggingface/transformers/blob/03708ccf6fa047e56ea4ca811e7dcd73127394fa/tests%2Fmodels%2Fdeepseek_v3%2Ftest_modeling_deepseek_v3.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/03708ccf6fa047e56ea4ca811e7dcd73127394fa/tests%2Fmodels%2Fdeepseek_v3%2Ftest_modeling_deepseek_v3.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Fmodels%2Fdeepseek_v3%2Ftest_modeling_deepseek_v3.py?ref=03708ccf6fa047e56ea4ca811e7dcd73127394fa",
            "patch": "@@ -43,6 +43,7 @@\n     from transformers import (\n         DeepseekV3ForCausalLM,\n         DeepseekV3ForSequenceClassification,\n+        DeepseekV3ForTokenClassification,\n         DeepseekV3Model,\n     )\n     from transformers.models.deepseek_v3.modeling_deepseek_v3 import (\n@@ -217,6 +218,7 @@ class DeepseekV3ModelTest(ModelTesterMixin, GenerationTesterMixin, PipelineTeste\n             DeepseekV3Model,\n             DeepseekV3ForCausalLM,\n             DeepseekV3ForSequenceClassification,\n+            DeepseekV3ForTokenClassification,\n         )\n         if is_torch_available()\n         else ()\n@@ -226,6 +228,7 @@ class DeepseekV3ModelTest(ModelTesterMixin, GenerationTesterMixin, PipelineTeste\n         {\n             \"feature-extraction\": DeepseekV3Model,\n             \"text-classification\": DeepseekV3ForSequenceClassification,\n+            \"token-classification\": DeepseekV3ForTokenClassification,\n             \"text-generation\": DeepseekV3ForCausalLM,\n             \"zero-shot\": DeepseekV3ForSequenceClassification,\n         }"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 25,
        "deletions": 2
    }
}