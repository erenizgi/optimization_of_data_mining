{
    "author": "jp1924",
    "message": "fix: AttributeError: 'LlavaProcessor' object has no attribute 'image_token_id' (#37026)\n\n* Add image_token_id and video_token_id handling in Llava processors\n\n* fix: image to video\n\n* fix: correct image and video token ID handling in Llava processors\n\n* fix: improve image and video token ID handling in Llava processors",
    "sha": "3af425d4c6aa4af1c6dc79c6c1eb185826619f86",
    "files": [
        {
            "sha": "6253e1992f02714c5d42e4bd7190edd1bb6cce22",
            "filename": "src/transformers/models/llava/processing_llava.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/huggingface/transformers/blob/3af425d4c6aa4af1c6dc79c6c1eb185826619f86/src%2Ftransformers%2Fmodels%2Fllava%2Fprocessing_llava.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/3af425d4c6aa4af1c6dc79c6c1eb185826619f86/src%2Ftransformers%2Fmodels%2Fllava%2Fprocessing_llava.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fllava%2Fprocessing_llava.py?ref=3af425d4c6aa4af1c6dc79c6c1eb185826619f86",
            "patch": "@@ -89,6 +89,11 @@ def __init__(\n         self.num_additional_image_tokens = num_additional_image_tokens\n         self.vision_feature_select_strategy = vision_feature_select_strategy\n         self.image_token = tokenizer.image_token if hasattr(tokenizer, \"image_token\") else image_token\n+        self.image_token_id = (\n+            tokenizer.image_token_id\n+            if getattr(tokenizer, \"image_token_id\", None)\n+            else tokenizer.convert_tokens_to_ids(self.image_token)\n+        )\n         super().__init__(image_processor, tokenizer, chat_template=chat_template)\n \n     def __call__("
        },
        {
            "sha": "61bb2cdd7fed0583e65487823ae6289c2e4bdc84",
            "filename": "src/transformers/models/llava_next/processing_llava_next.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/huggingface/transformers/blob/3af425d4c6aa4af1c6dc79c6c1eb185826619f86/src%2Ftransformers%2Fmodels%2Fllava_next%2Fprocessing_llava_next.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/3af425d4c6aa4af1c6dc79c6c1eb185826619f86/src%2Ftransformers%2Fmodels%2Fllava_next%2Fprocessing_llava_next.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fllava_next%2Fprocessing_llava_next.py?ref=3af425d4c6aa4af1c6dc79c6c1eb185826619f86",
            "patch": "@@ -92,6 +92,11 @@ def __init__(\n         self.num_additional_image_tokens = num_additional_image_tokens\n         self.vision_feature_select_strategy = vision_feature_select_strategy\n         self.image_token = tokenizer.image_token if hasattr(tokenizer, \"image_token\") else image_token\n+        self.image_token_id = (\n+            tokenizer.image_token_id\n+            if getattr(tokenizer, \"image_token_id\", None)\n+            else tokenizer.convert_tokens_to_ids(self.image_token)\n+        )\n         super().__init__(image_processor, tokenizer, chat_template=chat_template)\n \n     def __call__("
        },
        {
            "sha": "43b4102b9668e0fd9368b61a51cfb8947d8608ce",
            "filename": "src/transformers/models/llava_next_video/processing_llava_next_video.py",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/huggingface/transformers/blob/3af425d4c6aa4af1c6dc79c6c1eb185826619f86/src%2Ftransformers%2Fmodels%2Fllava_next_video%2Fprocessing_llava_next_video.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/3af425d4c6aa4af1c6dc79c6c1eb185826619f86/src%2Ftransformers%2Fmodels%2Fllava_next_video%2Fprocessing_llava_next_video.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fllava_next_video%2Fprocessing_llava_next_video.py?ref=3af425d4c6aa4af1c6dc79c6c1eb185826619f86",
            "patch": "@@ -107,6 +107,16 @@ def __init__(\n         self.vision_feature_select_strategy = vision_feature_select_strategy\n         self.image_token = tokenizer.image_token if hasattr(tokenizer, \"image_token\") else image_token\n         self.video_token = tokenizer.video_token if hasattr(tokenizer, \"video_token\") else video_token\n+        self.image_token_id = (\n+            tokenizer.image_token_id\n+            if getattr(tokenizer, \"image_token_id\", None)\n+            else tokenizer.convert_tokens_to_ids(self.image_token)\n+        )\n+        self.video_token_id = (\n+            tokenizer.video_token_id\n+            if getattr(tokenizer, \"video_token_id\", None)\n+            else tokenizer.convert_tokens_to_ids(self.video_token)\n+        )\n         super().__init__(video_processor, image_processor, tokenizer, chat_template=chat_template)\n \n     def __call__("
        },
        {
            "sha": "4b1443ab9e49bb804fd347e1ac4c630d7a1bc726",
            "filename": "src/transformers/models/llava_onevision/processing_llava_onevision.py",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/huggingface/transformers/blob/3af425d4c6aa4af1c6dc79c6c1eb185826619f86/src%2Ftransformers%2Fmodels%2Fllava_onevision%2Fprocessing_llava_onevision.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/3af425d4c6aa4af1c6dc79c6c1eb185826619f86/src%2Ftransformers%2Fmodels%2Fllava_onevision%2Fprocessing_llava_onevision.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodels%2Fllava_onevision%2Fprocessing_llava_onevision.py?ref=3af425d4c6aa4af1c6dc79c6c1eb185826619f86",
            "patch": "@@ -100,6 +100,16 @@ def __init__(\n         self.vision_feature_select_strategy = vision_feature_select_strategy\n         self.image_token = tokenizer.image_token if hasattr(tokenizer, \"image_token\") else image_token\n         self.video_token = tokenizer.video_token if hasattr(tokenizer, \"video_token\") else video_token\n+        self.image_token_id = (\n+            tokenizer.image_token_id\n+            if getattr(tokenizer, \"image_token_id\", None)\n+            else tokenizer.convert_tokens_to_ids(self.image_token)\n+        )\n+        self.video_token_id = (\n+            tokenizer.video_token_id\n+            if getattr(tokenizer, \"video_token_id\", None)\n+            else tokenizer.convert_tokens_to_ids(self.video_token)\n+        )\n         super().__init__(image_processor, tokenizer, video_processor, chat_template=chat_template)\n \n     def __call__("
        }
    ],
    "stats": {
        "total": 30,
        "additions": 30,
        "deletions": 0
    }
}