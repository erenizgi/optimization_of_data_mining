{
    "author": "Shivamjan",
    "message": "Add model card for MobileViT (#40033)\n\n* Add model card for MobileViT\n\n* Update docs/source/en/model_doc/mobilevit.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/mobilevit.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/mobilevit.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/mobilevit.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/mobilevit.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update mobilevit.md\n\n* Update mobilevit.md\n\n* Update mobilevit.md\n\n* Update docs/source/en/model_doc/mobilevit.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/mobilevit.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update mobilevit.md\n\n* Update mobilevit.md\n\n* Update mobilevit.md\n\n* Update mobilevit.md\n\n---------\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>",
    "sha": "a1a4fcd03e3455772415e6400fee91f3159e7ac5",
    "files": [
        {
            "sha": "698fab3b8293f5bedebd7df97e0e5d01a14ae309",
            "filename": "docs/source/en/model_doc/mobilevit.md",
            "status": "modified",
            "additions": 80,
            "deletions": 50,
            "changes": 130,
            "blob_url": "https://github.com/huggingface/transformers/blob/a1a4fcd03e3455772415e6400fee91f3159e7ac5/docs%2Fsource%2Fen%2Fmodel_doc%2Fmobilevit.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/a1a4fcd03e3455772415e6400fee91f3159e7ac5/docs%2Fsource%2Fen%2Fmodel_doc%2Fmobilevit.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fmobilevit.md?ref=a1a4fcd03e3455772415e6400fee91f3159e7ac5",
            "patch": "@@ -1,84 +1,114 @@\n <!--Copyright 2022 The HuggingFace Team. All rights reserved.\n \n-Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n-the License. You may obtain a copy of the License at\n+Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with  the License. You may obtain a copy of the License at\n \n-http://www.apache.org/licenses/LICENSE-2.0\n+[http://www.apache.org/licenses/LICENSE-2.0](http://www.apache.org/licenses/LICENSE-2.0)\n \n-Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n-an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n-specific language governing permissions and limitations under the License.\n+Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on  an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the  specific language governing permissions and limitations under the License.\n \n-âš ï¸ Note that this file is in Markdown but contain specific syntax for our doc-builder (similar to MDX) that may not be\n-rendered properly in your Markdown viewer.\n+âš ï¸ Note that this file is in Markdown but contain specific syntax for our doc-builder (similar to MDX) that may not be  rendered properly in your Markdown viewer.\n \n -->\n \n+\n+\n # MobileViT\n \n-<div class=\"flex flex-wrap space-x-1\">\n-<img alt=\"PyTorch\" src=\"https://img.shields.io/badge/PyTorch-DE3412?style=flat&logo=pytorch&logoColor=white\">\n-<img alt=\"TensorFlow\" src=\"https://img.shields.io/badge/TensorFlow-FF6F00?style=flat&logo=tensorflow&logoColor=white\">\n+\n+<div style=\"float: right;\">\n+    <div class=\"flex flex-wrap space-x-2\">\n+        <img alt=\"PyTorch\" src=\"https://img.shields.io/badge/PyTorch-DE3412?style=flat&logo=pytorch&logoColor=white\">\n+        <img alt=\"TensorFlow\" src=\"https://img.shields.io/badge/TensorFlow-FF6F00?style=flat&logo=tensorflow&logoColor=white\">\n+    </div>\n </div>\n \n-## Overview\n+[MobileViT](https://huggingface.co/papers/2110.02178) is a lightweight vision transformer for mobile devices that merges CNNs's efficiency and inductive biases with transformers global context modeling. It treats transformers as convolutions, enabling global information processing without the heavy computational cost of standard ViTs.\n \n-The MobileViT model was proposed in [MobileViT: Light-weight, General-purpose, and Mobile-friendly Vision Transformer](https://huggingface.co/papers/2110.02178) by Sachin Mehta and Mohammad Rastegari. MobileViT introduces a new layer that replaces local processing in convolutions with global processing using transformers.\n \n-The abstract from the paper is the following:\n+<div class=\"flex justify-center\">\n+   <img src = \"https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/transformers/model_doc/MobileViT.png\">\n+</div>\n+\n \n-*Light-weight convolutional neural networks (CNNs) are the de-facto for mobile vision tasks. Their spatial inductive biases allow them to learn representations with fewer parameters across different vision tasks. However, these networks are spatially local. To learn global representations, self-attention-based vision trans-formers (ViTs) have been adopted. Unlike CNNs, ViTs are heavy-weight. In this paper, we ask the following question: is it possible to combine the strengths of CNNs and ViTs to build a light-weight and low latency network for mobile vision tasks? Towards this end, we introduce MobileViT, a light-weight and general-purpose vision transformer for mobile devices. MobileViT presents a different perspective for the global processing of information with transformers, i.e., transformers as convolutions. Our results show that MobileViT significantly outperforms CNN- and ViT-based networks across different tasks and datasets. On the ImageNet-1k dataset, MobileViT achieves top-1 accuracy of 78.4% with about 6 million parameters, which is 3.2% and 6.2% more accurate than MobileNetv3 (CNN-based) and DeIT (ViT-based) for a similar number of parameters. On the MS-COCO object detection task, MobileViT is 5.7% more accurate than MobileNetv3 for a similar number of parameters.*\n+You can find all the original MobileViT checkpoints under the [Apple](https://huggingface.co/apple/models?search=mobilevit) organization.\n \n-This model was contributed by [matthijs](https://huggingface.co/Matthijs). The TensorFlow version of the model was contributed by [sayakpaul](https://huggingface.co/sayakpaul). The original code and weights can be found [here](https://github.com/apple/ml-cvnets).\n \n-## Usage tips\n+> [!TIP]\n+> - This model was contributed by [matthijs](https://huggingface.co/Matthijs) and the TensorFlow version was contributed by [sayakpaul](https://huggingface.co/sayakpaul).\n+>\n+> Click on the MobileViT models in the right sidebar for more examples of how to apply MobileViT to different vision tasks.\n \n-- MobileViT is more like a CNN than a Transformer model. It does not work on sequence data but on batches of images. Unlike ViT, there are no embeddings. The backbone model outputs a feature map. You can follow [this tutorial](https://keras.io/examples/vision/mobilevit) for a lightweight introduction.\n-- One can use [`MobileViTImageProcessor`] to prepare images for the model. Note that if you do your own preprocessing, the pretrained checkpoints expect images to be in BGR pixel order (not RGB).\n-- The available image classification checkpoints are pre-trained on [ImageNet-1k](https://huggingface.co/datasets/imagenet-1k) (also referred to as ILSVRC 2012, a collection of 1.3 million images and 1,000 classes).\n-- The segmentation model uses a [DeepLabV3](https://huggingface.co/papers/1706.05587) head. The available semantic segmentation checkpoints are pre-trained on [PASCAL VOC](http://host.robots.ox.ac.uk/pascal/VOC/).\n-- As the name suggests MobileViT was designed to be performant and efficient on mobile phones. The TensorFlow versions of the MobileViT models are fully compatible with [TensorFlow Lite](https://www.tensorflow.org/lite).\n \n-  You can use the following code to convert a MobileViT checkpoint (be it image classification or semantic segmentation) to generate a\n-  TensorFlow Lite model:\n+The example below demonstrates how to do [Image Classification] with [`Pipeline`] and the [`AutoModel`] class.\n \n-```py\n-from transformers import TFMobileViTForImageClassification\n-import tensorflow as tf\n+<hfoptions id=\"usage\">\n+<hfoption id=\"Pipeline\">\n \n+```python\n \n-model_ckpt = \"apple/mobilevit-xx-small\"\n-model = TFMobileViTForImageClassification.from_pretrained(model_ckpt)\n+import torch\n+from transformers import pipeline\n \n-converter = tf.lite.TFLiteConverter.from_keras_model(model)\n-converter.optimizations = [tf.lite.Optimize.DEFAULT]\n-converter.target_spec.supported_ops = [\n-    tf.lite.OpsSet.TFLITE_BUILTINS,\n-    tf.lite.OpsSet.SELECT_TF_OPS,\n-]\n-tflite_model = converter.convert()\n-tflite_filename = model_ckpt.split(\"/\")[-1] + \".tflite\"\n-with open(tflite_filename, \"wb\") as f:\n-    f.write(tflite_model)\n+classifier = pipeline(\n+   task=\"image-classification\",\n+   model=\"apple/mobilevit-small\",\n+   torch_dtype=torch.float16, device=0,\n+)\n+\n+preds = classifier(\"https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/pipeline-cat-chonk.jpeg\")\n+print(f\"Prediction: {preds}\\n\")\n ```\n \n-  The resulting model will be just **about an MB** making it a good fit for mobile applications where resources and network\n-  bandwidth can be constrained.\n+</hfoption>\n+\n+<hfoption id=\"AutoModel\">\n+\n+```python\n+\n+import torch\n+import requests\n+from PIL import Image\n+from transformers import AutoImageProcessor, MobileViTForImageClassification\n+\n+image_processor = AutoImageProcessor.from_pretrained(\n+   \"apple/mobilevit-small\",\n+   use_fast=True,\n+)\n+model = MobileViTForImageClassification.from_pretrained(\"apple/mobilevit-small\")\n+\n+url = \"https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/pipeline-cat-chonk.jpeg\"\n+image = Image.open(requests.get(url, stream=True).raw)\n+inputs = image_processor(image, return_tensors=\"pt\").to(\"cuda\")\n+\n+with torch.no_grad():\n+    logits = model(**inputs).logits\n+predicted_class_id = logits.argmax(dim=-1).item()\n+\n+class_labels = model.config.id2label\n+predicted_class_label = class_labels[predicted_class_id]\n+print(f\"The predicted class label is:{predicted_class_label}\")\n+```\n+\n+</hfoption>\n+</hfoptions>\n+\n+\n \n-## Resources\n \n-A list of official Hugging Face and community (indicated by ðŸŒŽ) resources to help you get started with MobileViT.\n+## Notes\n \n-<PipelineTag pipeline=\"image-classification\"/>\n+- Does **not** operate on sequential data, it's purely designed for image tasks.\n+- Feature maps are used directly instead of token embeddings.\n+- Use [`MobileViTImageProcessor`] to preprocess images.\n+- If using custom preprocessing, ensure that images are in **BGR** format (not RGB), as expected by the pretrained weights.\n+- The classification models are pretrained on [ImageNet-1k](https://huggingface.co/datasets/imagenet-1k).\n+- The segmentation models use a [DeepLabV3](https://huggingface.co/papers/1706.05587) head and are pretrained on [PASCAL VOC](http://host.robots.ox.ac.uk/pascal/VOC/).\n+- TensorFlow versions are compatible with TensorFlow Lite, making them ideal for edge/mobile deployment.\n \n-- [`MobileViTForImageClassification`] is supported by this [example script](https://github.com/huggingface/transformers/tree/main/examples/pytorch/image-classification) and [notebook](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/image_classification.ipynb).\n-- See also: [Image classification task guide](../tasks/image_classification)\n \n-**Semantic segmentation**\n-- [Semantic segmentation task guide](../tasks/semantic_segmentation)\n \n-If you're interested in submitting a resource to be included here, please feel free to open a Pull Request and we'll review it! The resource should ideally demonstrate something new instead of duplicating an existing resource.\n \n+  \n ## MobileViTConfig\n \n [[autodoc]] MobileViTConfig\n@@ -138,4 +168,4 @@ If you're interested in submitting a resource to be included here, please feel f\n     - call\n \n </tf>\n-</frameworkcontent>\n\\ No newline at end of file\n+</frameworkcontent>"
        }
    ],
    "stats": {
        "total": 130,
        "additions": 80,
        "deletions": 50
    }
}