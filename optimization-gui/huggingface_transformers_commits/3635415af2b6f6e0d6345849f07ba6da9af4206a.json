{
    "author": "MilkClouds",
    "message": "[Docs] Fix typo in CustomTrainer compute_loss method and adjust loss reduction logic (#39391)\n\nFix typo in CustomTrainer compute_loss method and adjust loss reduction logic",
    "sha": "3635415af2b6f6e0d6345849f07ba6da9af4206a",
    "files": [
        {
            "sha": "48325da6893c2bfbfb85c58414da3f7ca8449232",
            "filename": "docs/source/en/trainer.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/huggingface/transformers/blob/3635415af2b6f6e0d6345849f07ba6da9af4206a/docs%2Fsource%2Fen%2Ftrainer.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/3635415af2b6f6e0d6345849f07ba6da9af4206a/docs%2Fsource%2Fen%2Ftrainer.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Ftrainer.md?ref=3635415af2b6f6e0d6345849f07ba6da9af4206a",
            "patch": "@@ -187,13 +187,13 @@ from torch import nn\n from transformers import Trainer\n \n class CustomTrainer(Trainer):\n-    def compute_losss(self, model: nn.Module, inputs: dict[str, Union[torch.Tensor, Any]], return_outputs: bool = False num_items_in_batch: Optional[torch.Tensor] = None):\n+    def compute_loss(self, model: nn.Module, inputs: dict[str, Union[torch.Tensor, Any]], return_outputs: bool = False num_items_in_batch: Optional[torch.Tensor] = None):\n         labels = inputs.pop(\"labels\")\n         # forward pass\n         outputs = model(**inputs)\n         logits = outputs.get(\"logits\")\n         # compute custom loss for 3 labels with different weights\n-        reduction = \"mean\" if num_items_in_batch is not None else \"sum\"\n+        reduction = \"sum\" if num_items_in_batch is not None else \"mean\"\n         loss_fct = nn.CrossEntropyLoss(weight=torch.tensor([1.0, 2.0, 3.0], device=model.device, reduction=reduction))\n         loss = loss_fct(logits.view(-1, self.model.config.num_labels), labels.view(-1))\n         if num_items_in_batch is not None:"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    }
}