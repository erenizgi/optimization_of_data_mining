{
    "author": "ArthurZucker",
    "message": "add disable compile option (#36161)\n\n* add disable compile code\n\n* fix",
    "sha": "06231fdfc7b3dac79897b3cd81f5e2d859c51395",
    "files": [
        {
            "sha": "50f7b29f75207b30bf11cbf2a188b565d06ef149",
            "filename": "src/transformers/generation/configuration_utils.py",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/huggingface/transformers/blob/06231fdfc7b3dac79897b3cd81f5e2d859c51395/src%2Ftransformers%2Fgeneration%2Fconfiguration_utils.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/06231fdfc7b3dac79897b3cd81f5e2d859c51395/src%2Ftransformers%2Fgeneration%2Fconfiguration_utils.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fgeneration%2Fconfiguration_utils.py?ref=06231fdfc7b3dac79897b3cd81f5e2d859c51395",
            "patch": "@@ -379,6 +379,9 @@ class GenerationConfig(PushToHubMixin):\n             If using a static cache, this controls how `generate` will `compile` the forward pass for performance\n             gains.\n \n+        disable_compile (`bool`, *optional*): Whether to disable the compilation of the forward pass when using 'statis' cache\n+            implementation.\n+\n         > Wild card\n \n         generation_kwargs:\n@@ -482,7 +485,7 @@ def __init__(self, **kwargs):\n \n         # Performances\n         self.compile_config = kwargs.pop(\"compile_config\", CompileConfig())\n-\n+        self.disable_compile = kwargs.pop(\"disable_compile\", False)\n         # Wild card\n         self.generation_kwargs = kwargs.pop(\"generation_kwargs\", {})\n "
        },
        {
            "sha": "db8bbe50e508a296d01949f110f511b992af4a4f",
            "filename": "src/transformers/generation/utils.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/huggingface/transformers/blob/06231fdfc7b3dac79897b3cd81f5e2d859c51395/src%2Ftransformers%2Fgeneration%2Futils.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/06231fdfc7b3dac79897b3cd81f5e2d859c51395/src%2Ftransformers%2Fgeneration%2Futils.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fgeneration%2Futils.py?ref=06231fdfc7b3dac79897b3cd81f5e2d859c51395",
            "patch": "@@ -3189,6 +3189,7 @@ def _sample(\n         model_forward = self.__call__\n         if isinstance(model_kwargs.get(\"past_key_values\"), Cache):\n             is_compileable = model_kwargs[\"past_key_values\"].is_compileable and self._supports_static_cache\n+            is_compileable = is_compileable and not self.generation_config.disable_compile\n             if is_compileable and (\n                 self.device.type == \"cuda\" or generation_config.compile_config._compile_all_devices\n             ):"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
    }
}