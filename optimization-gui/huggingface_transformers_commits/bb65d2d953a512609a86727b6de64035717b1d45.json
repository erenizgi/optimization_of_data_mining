{
    "author": "ydshieh",
    "message": "Fix `pr_slow_ci_suggestion.yml` after #42023 (#42049)\n\nfix\n\nCo-authored-by: ydshieh <ydshieh@users.noreply.github.com>",
    "sha": "bb65d2d953a512609a86727b6de64035717b1d45",
    "files": [
        {
            "sha": "7d6c2e5335535b0dcfc55892ce0fd23f3e433175",
            "filename": ".github/workflows/pr_slow_ci_suggestion.yml",
            "status": "modified",
            "additions": 19,
            "deletions": 40,
            "changes": 59,
            "blob_url": "https://github.com/huggingface/transformers/blob/bb65d2d953a512609a86727b6de64035717b1d45/.github%2Fworkflows%2Fpr_slow_ci_suggestion.yml",
            "raw_url": "https://github.com/huggingface/transformers/raw/bb65d2d953a512609a86727b6de64035717b1d45/.github%2Fworkflows%2Fpr_slow_ci_suggestion.yml",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/.github%2Fworkflows%2Fpr_slow_ci_suggestion.yml?ref=bb65d2d953a512609a86727b6de64035717b1d45",
            "patch": "@@ -23,11 +23,26 @@ jobs:\n     outputs:\n       jobs: ${{ steps.get_jobs.outputs.jobs_to_run }}\n     steps:\n+      # This checkout to the main branch\n+      - uses: actions/checkout@v4\n+        with:\n+          fetch-depth: \"0\"\n+\n+      - name: Write pr_files file\n+        env:\n+          PR_FILES: ${{ needs.get-pr-info.outputs.PR_FILES }}\n+        run: |\n+          cat > pr_files.txt << EOF\n+          $PR_FILES\n+          EOF\n+\n       - name: Get repository content\n         id: repo_content\n         uses: actions/github-script@v6\n         with:\n           script: |\n+            const fs = require('node:fs');\n+\n             const { data: tests_dir } = await github.rest.repos.getContent({\n               owner: '${{ needs.get-pr-info.outputs.PR_HEAD_REPO_OWNER }}',\n               repo: '${{ needs.get-pr-info.outputs.PR_HEAD_REPO_NAME }}',\n@@ -49,46 +64,10 @@ jobs:\n               ref: '${{ needs.get-pr-info.outputs.PR_HEAD_SHA }}',\n             });\n \n-            core.setOutput('tests_dir', tests_dir);\n-            core.setOutput('tests_models_dir', tests_models_dir);\n-            core.setOutput('tests_quantization_dir', tests_quantization_dir);\n-\n-      # This checkout to the main branch\n-      - uses: actions/checkout@v4\n-        with:\n-          fetch-depth: \"0\"\n-\n-      - name: Write pr_files file\n-        env:\n-          PR_FILES: ${{ needs.get-pr-info.outputs.PR_FILES }}\n-        run: |\n-          cat > pr_files.txt << EOF\n-          $PR_FILES\n-          EOF\n-\n-      - name: Write tests_dir file\n-        env:\n-          tests_dir: ${{ steps.repo_content.outputs.tests_dir }}\n-        run: |\n-          cat > tests_dir.txt << EOF\n-          $tests_dir\n-          EOF\n-\n-      - name: Write tests_models_dir file\n-        env:\n-          tests_models_dir: ${{ steps.repo_content.outputs.tests_models_dir }}\n-        run: |\n-          cat > tests_models_dir.txt << EOF\n-          $tests_models_dir\n-          EOF\n-\n-      - name: Write tests_quantization_dir file\n-        env:\n-          tests_quantization_dir: ${{ steps.repo_content.outputs.tests_quantization_dir }}\n-        run: |\n-          cat > tests_quantization_dir.txt << EOF\n-          $tests_quantization_dir\n-          EOF\n+            // Write to files instead of outputs\n+            fs.writeFileSync('tests_dir.txt', JSON.stringify(tests_dir, null, 2));\n+            fs.writeFileSync('tests_models_dir.txt', JSON.stringify(tests_models_dir, null, 2));\n+            fs.writeFileSync('tests_quantization_dir.txt', JSON.stringify(tests_quantization_dir, null, 2));\n \n       - name: Run script to get jobs to run\n         id: get_jobs"
        }
    ],
    "stats": {
        "total": 59,
        "additions": 19,
        "deletions": 40
    }
}