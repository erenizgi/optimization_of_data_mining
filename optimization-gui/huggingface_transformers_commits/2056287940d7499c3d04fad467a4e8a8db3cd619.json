{
    "author": "Aravind-11",
    "message": "Updated model card for Qwen2  (#37192)\n\n* Update qwen2.md\n\n* Update qwen2.md\n\n* Update qwen2.md\n\n* Update qwen2.md\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update qwen2.md\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n* Update docs/source/en/model_doc/qwen2.md\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>\n\n---------\n\nCo-authored-by: Steven Liu <59462357+stevhliu@users.noreply.github.com>",
    "sha": "2056287940d7499c3d04fad467a4e8a8db3cd619",
    "files": [
        {
            "sha": "1c5e3880938da39b05fb75246a4ba622cb40f227",
            "filename": "docs/source/en/model_doc/qwen2.md",
            "status": "modified",
            "additions": 111,
            "deletions": 25,
            "changes": 136,
            "blob_url": "https://github.com/huggingface/transformers/blob/2056287940d7499c3d04fad467a4e8a8db3cd619/docs%2Fsource%2Fen%2Fmodel_doc%2Fqwen2.md",
            "raw_url": "https://github.com/huggingface/transformers/raw/2056287940d7499c3d04fad467a4e8a8db3cd619/docs%2Fsource%2Fen%2Fmodel_doc%2Fqwen2.md",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docs%2Fsource%2Fen%2Fmodel_doc%2Fqwen2.md?ref=2056287940d7499c3d04fad467a4e8a8db3cd619",
            "patch": "@@ -14,50 +14,136 @@ rendered properly in your Markdown viewer.\n \n -->\n \n-# Qwen2\n-\n-<div class=\"flex flex-wrap space-x-1\">\n-<img alt=\"PyTorch\" src=\"https://img.shields.io/badge/PyTorch-DE3412?style=flat&logo=pytorch&logoColor=white\">\n-<img alt=\"FlashAttention\" src=\"https://img.shields.io/badge/%E2%9A%A1%EF%B8%8E%20FlashAttention-eae0c8?style=flat\">\n-<img alt=\"SDPA\" src=\"https://img.shields.io/badge/SDPA-DE3412?style=flat&logo=pytorch&logoColor=white\">\n+<div style=\"float: right;\">\n+    <div class=\"flex flex-wrap space-x-1\">\n+        <img alt=\"PyTorch\" src=\"https://img.shields.io/badge/PyTorch-DE3412?style=flat&logo=pytorch&logoColor=white\">\n+        <img alt=\"FlashAttention\" src=\"https://img.shields.io/badge/%E2%9A%A1%EF%B8%8E%20FlashAttention-eae0c8?style=flat\">\n+        <img alt=\"SDPA\" src=\"https://img.shields.io/badge/SDPA-DE3412?style=flat&logo=pytorch&logoColor=white\">\n+    </div>\n </div>\n \n-## Overview\n+# Qwen2\n \n-Qwen2 is the new model series of large language models from the Qwen team. Previously, we released the Qwen series, including Qwen2-0.5B, Qwen2-1.5B, Qwen2-7B, Qwen2-57B-A14B, Qwen2-72B, Qwen2-Audio, etc.\n+[Qwen2](https://huggingface.co/papers/2407.10671) is a family of large language models (pretrained, instruction-tuned and mixture-of-experts) available in sizes from 0.5B to 72B parameters. The models are built on the Transformer architecture featuring enhancements like group query attention (GQA), rotary positional embeddings (RoPE), a mix of sliding window and full attention, and dual chunk attention with YARN for training stability. Qwen2 models support multiple languages and context lengths up to 131,072 tokens.\n \n-### Model Details\n+You can find all the official Qwen2 checkpoints under the [Qwen2](https://huggingface.co/collections/Qwen/qwen2-6659360b33528ced941e557f) collection.\n \n-Qwen2 is a language model series including decoder language models of different model sizes. For each size, we release the base language model and the aligned chat model. It is based on the Transformer architecture with SwiGLU activation, attention QKV bias, group query attention, mixture of sliding window attention and full attention, etc. Additionally, we have an improved tokenizer adaptive to multiple natural languages and codes.\n+> [!TIP]\n+> Click on the Qwen2 models in the right sidebar for more examples of how to apply Qwen2 to different language tasks.\n \n+The example below demonstrates how to generate text with [`Pipeline`], [`AutoModel`], and from the command line using the instruction-tuned models.\n \n-## Usage tips\n+<hfoptions id=\"usage\">\n+<hfoption id=\"Pipeline\">\n \n-`Qwen2-7B` and `Qwen2-7B-Instruct` can be found on the [Huggingface Hub](https://huggingface.co/Qwen)\n+```python\n+import torch\n+from transformers import pipeline\n+\n+pipe = pipeline(\n+    task=\"text-generation\",\n+    model=\"Qwen/Qwen2-1.5B-Instruct\",\n+    torch_dtype=torch.bfloat16,\n+    device_map=0\n+)\n+\n+messages = [\n+    {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"},\n+    {\"role\": \"user\", \"content\": \"Tell me about the Qwen2 model family.\"},\n+]\n+outputs = pipe(messages, max_new_tokens=256, do_sample=True, temperature=0.7, top_k=50, top_p=0.95)\n+print(outputs[0][\"generated_text\"][-1]['content'])\n+```\n \n-In the following, we demonstrate how to use `Qwen2-7B-Instruct` for the inference. Note that we have used the ChatML format for dialog, in this demo we show how to leverage `apply_chat_template` for this purpose.\n+</hfoption>\n+<hfoption id=\"AutoModel\">\n \n ```python\n->>> from transformers import AutoModelForCausalLM, AutoTokenizer\n->>> device = \"cuda\" # the device to load the model onto\n+import torch\n+from transformers import AutoModelForCausalLM, AutoTokenizer\n+\n+model = AutoModelForCausalLM.from_pretrained(\n+    \"Qwen/Qwen2-1.5B-Instruct\",\n+    torch_dtype=torch.bfloat16, \n+    device_map=\"auto\",\n+    attn_implementation=\"sdpa\"\n+)\n+tokenizer = AutoTokenizer.from_pretrained(\"Qwen/Qwen2-1.5B-Instruct\")\n+\n+prompt = \"Give me a short introduction to large language models.\"\n+messages = [\n+    {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"},\n+    {\"role\": \"user\", \"content\": prompt}\n+]\n+text = tokenizer.apply_chat_template(\n+    messages,\n+    tokenize=False,\n+    add_generation_prompt=True\n+)\n+model_inputs = tokenizer([text], return_tensors=\"pt\").to(\"cuda\")\n+\n+generated_ids = model.generate(\n+    model_inputs.input_ids,\n+    cache_implementation=\"static\",\n+    max_new_tokens=512,\n+    do_sample=True, \n+    temperature=0.7, \n+    top_k=50,        \n+    top_p=0.95       \n+)\n+generated_ids = [\n+    output_ids[len(input_ids):] for input_ids, output_ids in zip(model_inputs.input_ids, generated_ids)\n+]\n+\n+response = tokenizer.batch_decode(generated_ids, skip_special_tokens=True)[0]\n+print(response)\n+```\n \n->>> model = AutoModelForCausalLM.from_pretrained(\"Qwen/Qwen2-7B-Instruct\", device_map=\"auto\")\n->>> tokenizer = AutoTokenizer.from_pretrained(\"Qwen/Qwen2-7B-Instruct\")\n+</hfoption>\n+<hfoption id=\"transformers-cli\">\n \n->>> prompt = \"Give me a short introduction to large language model.\"\n+```bash\n+# pip install -U flash-attn --no-build-isolation\n+transformers-cli chat --model_name_or_path Qwen/Qwen2-7B-Instruct --torch_dtype auto --attn_implementation flash_attention_2 --device 0\n+```\n \n->>> messages = [{\"role\": \"user\", \"content\": prompt}]\n+</hfoption>\n+</hfoptions>\n \n->>> text = tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True)\n+Quantization reduces the memory burden of large models by representing the weights in a lower precision. Refer to the [Quantization](../quantization/overview) overview for more available quantization backends.\n \n->>> model_inputs = tokenizer([text], return_tensors=\"pt\").to(device)\n+The example below uses [bitsandbytes](../quantization/bitsandbytes) to quantize the weights to 4-bits.\n \n->>> generated_ids = model.generate(model_inputs.input_ids, max_new_tokens=512, do_sample=True)\n+```python\n+# pip install -U flash-attn --no-build-isolation\n+import torch\n+from transformers import AutoTokenizer, AutoModelForCausalLM, BitsAndBytesConfig\n+\n+quantization_config = BitsAndBytesConfig(\n+    load_in_4bit=True,\n+    bnb_4bit_compute_dtype=torch.bfloat16, \n+    bnb_4bit_quant_type=\"nf4\",             \n+    bnb_4bit_use_double_quant=True,       \n+)\n+\n+tokenizer = AutoTokenizer.from_pretrained(\"Qwen/Qwen2-7B\") \n+model = AutoModelForCausalLM.from_pretrained(\n+    \"Qwen/Qwen2-7B\",\n+    torch_dtype=torch.bfloat16,\n+    device_map=\"auto\",\n+    quantization_config=quantization_config,\n+    attn_implementation=\"flash_attention_2\" \n+)\n+\n+inputs = tokenizer(\"The Qwen2 model family is\", return_tensors=\"pt\").to(\"cuda\") \n+outputs = model.generate(**inputs, max_new_tokens=100)\n+print(tokenizer.decode(outputs[0], skip_special_tokens=True))\n+```\n \n->>> generated_ids = [output_ids[len(input_ids):] for input_ids, output_ids in zip(model_inputs.input_ids, generated_ids)]\n \n->>> response = tokenizer.batch_decode(generated_ids, skip_special_tokens=True)[0]\n-```\n+## Notes\n+\n+- Ensure your Transformers library version is up-to-date. Qwen2 requires Transformers>=4.37.0 for full support.\n \n ## Qwen2Config\n "
        }
    ],
    "stats": {
        "total": 136,
        "additions": 111,
        "deletions": 25
    }
}