{
    "author": "aymeric-roucher",
    "message": "Tool calling: support more types (#35776)\n\n* Tool calling: support NoneType for function return type",
    "sha": "44393df089cb6623b01b268958fb2026eb5c03e8",
    "files": [
        {
            "sha": "a6dff34ebc565670e828c525ac0966e154959f18",
            "filename": "src/transformers/utils/chat_template_utils.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/huggingface/transformers/blob/44393df089cb6623b01b268958fb2026eb5c03e8/src%2Ftransformers%2Futils%2Fchat_template_utils.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/44393df089cb6623b01b268958fb2026eb5c03e8/src%2Ftransformers%2Futils%2Fchat_template_utils.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Futils%2Fchat_template_utils.py?ref=44393df089cb6623b01b268958fb2026eb5c03e8",
            "patch": "@@ -19,6 +19,7 @@\n from contextlib import contextmanager\n from datetime import datetime\n from functools import lru_cache\n+from types import NoneType\n from typing import Any, Callable, Dict, List, Optional, Tuple, Union, get_args, get_origin, get_type_hints\n \n from packaging import version\n@@ -77,6 +78,7 @@ def _get_json_schema_type(param_type: str) -> Dict[str, str]:\n         float: {\"type\": \"number\"},\n         str: {\"type\": \"string\"},\n         bool: {\"type\": \"boolean\"},\n+        NoneType: {\"type\": \"null\"},\n         Any: {},\n     }\n     if is_vision_available():"
        },
        {
            "sha": "730f64859d7358efb71faca43dd9e092120bb23e",
            "filename": "tests/utils/test_chat_template_utils.py",
            "status": "modified",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/huggingface/transformers/blob/44393df089cb6623b01b268958fb2026eb5c03e8/tests%2Futils%2Ftest_chat_template_utils.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/44393df089cb6623b01b268958fb2026eb5c03e8/tests%2Futils%2Ftest_chat_template_utils.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/tests%2Futils%2Ftest_chat_template_utils.py?ref=44393df089cb6623b01b268958fb2026eb5c03e8",
            "patch": "@@ -419,6 +419,31 @@ def fn(x: int, y: int):\n \n         self.assertEqual(schema[\"function\"], expected_schema)\n \n+    def test_return_none(self):\n+        def fn(x: int) -> None:\n+            \"\"\"\n+            Test function\n+\n+            Args:\n+                x: The first input\n+            \"\"\"\n+            pass\n+\n+        schema = get_json_schema(fn)\n+        expected_schema = {\n+            \"name\": \"fn\",\n+            \"description\": \"Test function\",\n+            \"parameters\": {\n+                \"type\": \"object\",\n+                \"properties\": {\n+                    \"x\": {\"type\": \"integer\", \"description\": \"The first input\"},\n+                },\n+                \"required\": [\"x\"],\n+            },\n+            \"return\": {\"type\": \"null\"},\n+        }\n+        self.assertEqual(schema[\"function\"], expected_schema)\n+\n     def test_everything_all_at_once(self):\n         def fn(\n             x: str, y: Optional[List[Union[str, int]]], z: Tuple[Union[str, int], str] = (42, \"hello\")"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 27,
        "deletions": 0
    }
}