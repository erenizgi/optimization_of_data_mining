{
    "author": "Melody-coder923",
    "message": "Support FlaxPreTrainedModel to load model checkpoint from local subfolder safetensors (#37732)\n\nSupport FlaxPreTrainedModel to load model checkpoint from subfolder in local directory as safetensors format\n\nSigned-off-by: Yan Zhao <zhao.y4@northeastern.edu>",
    "sha": "2c1155519f742a2ee23161c26eddd977eb8f6a34",
    "files": [
        {
            "sha": "ac7a47e29bc57e3c424b473c60dbb2c2e0fe253e",
            "filename": "src/transformers/modeling_flax_utils.py",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/huggingface/transformers/blob/2c1155519f742a2ee23161c26eddd977eb8f6a34/src%2Ftransformers%2Fmodeling_flax_utils.py",
            "raw_url": "https://github.com/huggingface/transformers/raw/2c1155519f742a2ee23161c26eddd977eb8f6a34/src%2Ftransformers%2Fmodeling_flax_utils.py",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/src%2Ftransformers%2Fmodeling_flax_utils.py?ref=2c1155519f742a2ee23161c26eddd977eb8f6a34",
            "patch": "@@ -702,14 +702,19 @@ def from_pretrained(\n         if pretrained_model_name_or_path is not None:\n             pretrained_model_name_or_path = str(pretrained_model_name_or_path)\n             is_local = os.path.isdir(pretrained_model_name_or_path)\n-            if os.path.isdir(pretrained_model_name_or_path):\n+            if is_local:\n                 if os.path.isfile(os.path.join(pretrained_model_name_or_path, subfolder, FLAX_WEIGHTS_NAME)):\n                     # Load from a Flax checkpoint\n                     archive_file = os.path.join(pretrained_model_name_or_path, subfolder, FLAX_WEIGHTS_NAME)\n                 elif os.path.isfile(os.path.join(pretrained_model_name_or_path, subfolder, FLAX_WEIGHTS_INDEX_NAME)):\n                     # Load from a sharded Flax checkpoint\n                     archive_file = os.path.join(pretrained_model_name_or_path, subfolder, FLAX_WEIGHTS_INDEX_NAME)\n                     is_sharded = True\n+                elif is_safetensors_available() and os.path.isfile(\n+                    os.path.join(pretrained_model_name_or_path, subfolder, SAFE_WEIGHTS_NAME)\n+                ):\n+                    # Load from a safetensors checkpoint\n+                    archive_file = os.path.join(pretrained_model_name_or_path, subfolder, SAFE_WEIGHTS_NAME)\n                 elif is_safetensors_available() and os.path.isfile(\n                     os.path.join(pretrained_model_name_or_path, SAFE_WEIGHTS_NAME)\n                 ):"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
    }
}