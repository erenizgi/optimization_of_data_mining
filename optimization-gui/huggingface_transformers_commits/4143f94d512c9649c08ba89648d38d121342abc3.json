{
    "author": "ydshieh",
    "message": "uninstall `kernels` from docker images (#38083)\n\nuninstall kernels\n\nCo-authored-by: ydshieh <ydshieh@users.noreply.github.com>",
    "sha": "4143f94d512c9649c08ba89648d38d121342abc3",
    "files": [
        {
            "sha": "80f44f6294805ff8e30ff19d8de7227df0b72048",
            "filename": "docker/transformers-all-latest-gpu/Dockerfile",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/huggingface/transformers/blob/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-all-latest-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-all-latest-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-all-latest-gpu%2FDockerfile?ref=4143f94d512c9649c08ba89648d38d121342abc3",
            "patch": "@@ -71,6 +71,9 @@ RUN python3 -m pip install --no-cache-dir g2p-en\n # For Some bitsandbytes tests\n RUN python3 -m pip install --no-cache-dir einops\n \n+# `kernels` may give different outputs (within 1e-5 range) even with the same model (weights) and the same inputs\n+RUN python3 -m pip uninstall -y kernels\n+\n # When installing in editable mode, `transformers` is not recognized as a package.\n # this line must be added in order for python to be aware of transformers.\n RUN cd transformers && python3 setup.py develop"
        },
        {
            "sha": "746026d7eceedc596fabaaa1e08050cd4fc328f3",
            "filename": "docker/transformers-pytorch-deepspeed-latest-gpu/Dockerfile",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/huggingface/transformers/blob/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-pytorch-deepspeed-latest-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-pytorch-deepspeed-latest-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-pytorch-deepspeed-latest-gpu%2FDockerfile?ref=4143f94d512c9649c08ba89648d38d121342abc3",
            "patch": "@@ -45,6 +45,9 @@ RUN python3 -m pip uninstall -y deepspeed\n # TODO: Find out why test fail.\n RUN DS_BUILD_CPU_ADAM=1 DS_BUILD_FUSED_ADAM=1 python3 -m pip install deepspeed --global-option=\"build_ext\" --global-option=\"-j8\" --no-cache -v --disable-pip-version-check 2>&1\n \n+# `kernels` may give different outputs (within 1e-5 range) even with the same model (weights) and the same inputs\n+RUN python3 -m pip uninstall -y kernels\n+\n # When installing in editable mode, `transformers` is not recognized as a package.\n # this line must be added in order for python to be aware of transformers.\n RUN cd transformers && python3 setup.py develop"
        },
        {
            "sha": "d71b4ad3348efc3f46ef81c37c9b33b81de5f8a9",
            "filename": "docker/transformers-pytorch-deepspeed-nightly-gpu/Dockerfile",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/huggingface/transformers/blob/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-pytorch-deepspeed-nightly-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-pytorch-deepspeed-nightly-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-pytorch-deepspeed-nightly-gpu%2FDockerfile?ref=4143f94d512c9649c08ba89648d38d121342abc3",
            "patch": "@@ -57,6 +57,9 @@ RUN python3 -m pip uninstall -y deepspeed\n #RUN git clone https://github.com/pytorch/TensorRT.git\n #RUN cd TensorRT/py && python3 setup.py install --fx-only\n \n+# `kernels` may give different outputs (within 1e-5 range) even with the same model (weights) and the same inputs\n+RUN python3 -m pip uninstall -y kernels\n+\n # When installing in editable mode, `transformers` is not recognized as a package.\n # this line must be added in order for python to be aware of transformers.\n RUN cd transformers && python3 setup.py develop"
        },
        {
            "sha": "ee7f8a84036400ada2898b670f7a2a656038afd5",
            "filename": "docker/transformers-pytorch-gpu/Dockerfile",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/huggingface/transformers/blob/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-pytorch-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-pytorch-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-pytorch-gpu%2FDockerfile?ref=4143f94d512c9649c08ba89648d38d121342abc3",
            "patch": "@@ -28,6 +28,9 @@ RUN python3 -m pip uninstall -y tensorflow flax\n RUN python3 -m pip install --no-cache-dir git+https://github.com/facebookresearch/detectron2.git pytesseract\n RUN python3 -m pip install -U \"itsdangerous<2.1.0\"\n \n+# `kernels` may give different outputs (within 1e-5 range) even with the same model (weights) and the same inputs\n+RUN python3 -m pip uninstall -y kernels\n+\n # When installing in editable mode, `transformers` is not recognized as a package.\n # this line must be added in order for python to be aware of transformers.\n RUN cd transformers && python3 setup.py develop"
        },
        {
            "sha": "c860dabd6ace5cb6adff649623234b4d5ca1db9a",
            "filename": "docker/transformers-quantization-latest-gpu/Dockerfile",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/huggingface/transformers/blob/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-quantization-latest-gpu%2FDockerfile",
            "raw_url": "https://github.com/huggingface/transformers/raw/4143f94d512c9649c08ba89648d38d121342abc3/docker%2Ftransformers-quantization-latest-gpu%2FDockerfile",
            "contents_url": "https://api.github.com/repos/huggingface/transformers/contents/docker%2Ftransformers-quantization-latest-gpu%2FDockerfile?ref=4143f94d512c9649c08ba89648d38d121342abc3",
            "patch": "@@ -90,6 +90,9 @@ RUN python3 -m pip install --no-cache-dir \"auto-round>=0.5.0\"\n # Add transformers in editable mode\n RUN python3 -m pip install --no-cache-dir -e ./transformers[dev-torch]\n \n+# `kernels` may give different outputs (within 1e-5 range) even with the same model (weights) and the same inputs\n+RUN python3 -m pip uninstall -y kernels\n+\n # When installing in editable mode, `transformers` is not recognized as a package.\n # this line must be added in order for python to be aware of transformers.\n RUN cd transformers && python3 setup.py develop"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 15,
        "deletions": 0
    }
}