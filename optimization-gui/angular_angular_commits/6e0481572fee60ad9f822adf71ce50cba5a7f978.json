{
    "author": "shejialuo",
    "message": "docs(docs-infra): change the testing guide due to deprecation (#44674)\nThe jasmine used in the docs is\n\n```typescript\nexpect(<variableName>).<matcher>(predicate, failOutput)\n```\n\nThe new version should be\n\n```typescript\nexpect(<variableName>).withContext(failOutput).<matcher>(predicate)\n```\n\nSo, this commit mainly focuses on changing the former to latter with\nformat below\n\n```typescript\nexpect(<variableName>)\n  .withContext(failOutput)\n  .<matcher>(predicate)\n```\n\nAnd for RxJs, see https://rxjs.dev/deprecations/subscribe-arguments.\n\n> For example someone could name functions poorly and confuse the next\nreader: `source$.subscribe(doSomething, doSomethingElse, lol)` with that\nsignature, you have to know unapparent details about subscribe, where\nusing a partial observer solves that neatly: `source$.subscribe({ next:\ndoSomething, error: doSomethingElse, complete: lol }`).\n\nThis commit also does this conversion.\n\nLast, remove the unused imported `async` from file\n`twain.component.marbles.spec.ts`.\n\nPR Close #44674",
    "sha": "6e0481572fee60ad9f822adf71ce50cba5a7f978",
    "files": [
        {
            "sha": "c6676a19c3260b42807f8ec647130d1ddd85f1b7",
            "filename": "aio/content/examples/testing/src/app/app.component.router.spec.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fapp.component.router.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fapp.component.router.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fapp.component.router.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -170,11 +170,15 @@ class Page {\n }\n \n function expectPathToBe(path: string, expectationFailOutput?: any) {\n-  expect(location.path()).toEqual(path, expectationFailOutput || 'location.path()');\n+  expect(location.path())\n+  .withContext(expectationFailOutput || 'location.path()')\n+  .toEqual(path);\n }\n \n function expectElementOf(type: Type<any>): any {\n   const el = fixture.debugElement.query(By.directive(type));\n-  expect(el).toBeTruthy('expected an element for ' + type.name);\n+  expect(el)\n+    .withContext(`expected an element for ${type.name}`)\n+    .toBeTruthy();\n   return el;\n }"
        },
        {
            "sha": "781a3bbe42a68fec898fd75e61eab9ae519d71e4",
            "filename": "aio/content/examples/testing/src/app/app.component.spec.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fapp.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fapp.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fapp.component.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -121,7 +121,9 @@ function tests() {\n \n   // #docregion tests\n   it('can get RouterLinks from template', () => {\n-    expect(routerLinks.length).toBe(3, 'should have 3 routerLinks');\n+    expect(routerLinks.length)\n+      .withContext('should have 3 routerLinks')\n+      .toBe(3);\n     expect(routerLinks[0].linkParams).toBe('/dashboard');\n     expect(routerLinks[1].linkParams).toBe('/heroes');\n     expect(routerLinks[2].linkParams).toBe('/about');\n@@ -131,7 +133,9 @@ function tests() {\n     const heroesLinkDe = linkDes[1];    // heroes link DebugElement\n     const heroesLink = routerLinks[1];  // heroes link directive\n \n-    expect(heroesLink.navigatedTo).toBeNull('should not have navigated yet');\n+    expect(heroesLink.navigatedTo)\n+      .withContext('should not have navigated yet')\n+      .toBeNull();\n \n     heroesLinkDe.triggerEventHandler('click', null);\n     fixture.detectChanges();"
        },
        {
            "sha": "116d8a2fa9e2f288467b0b4d66dff49e98d50371",
            "filename": "aio/content/examples/testing/src/app/dashboard/dashboard.component.no-testbed.spec.ts",
            "status": "modified",
            "additions": 18,
            "deletions": 12,
            "changes": 30,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdashboard%2Fdashboard.component.no-testbed.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdashboard%2Fdashboard.component.no-testbed.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdashboard%2Fdashboard.component.no-testbed.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -23,27 +23,31 @@ describe('DashboardComponent class only', () => {\n   });\n \n   it('should NOT have heroes before calling OnInit', () => {\n-    expect(comp.heroes.length).toBe(0,\n-      'should not have heroes before OnInit');\n+    expect(comp.heroes.length)\n+      .withContext('should not have heroes before OnInit')\n+      .toBe(0);\n   });\n \n   it('should NOT have heroes immediately after OnInit', () => {\n     comp.ngOnInit(); // ngOnInit -> getHeroes\n-    expect(comp.heroes.length).toBe(0,\n-      'should not have heroes until service promise resolves');\n+    expect(comp.heroes.length)\n+      .withContext('should not have heroes until service promise resolves')\n+      .toBe(0);\n   });\n \n   it('should HAVE heroes after HeroService gets them', (done: DoneFn) => {\n     comp.ngOnInit(); // ngOnInit -> getHeroes\n     heroService.lastResult // the one from getHeroes\n-      .subscribe(\n-        () => {\n+      .subscribe({\n+        next: () => {\n         // throw new Error('deliberate error'); // see it fail gracefully\n-        expect(comp.heroes.length).toBeGreaterThan(0,\n-          'should have heroes after service promise resolves');\n-        done();\n-      },\n-      done.fail);\n+          expect(comp.heroes.length)\n+            .withContext('should have heroes after service promise resolves')\n+            .toBeGreaterThan(0);\n+          done();\n+        },\n+        error: done.fail\n+      });\n   });\n \n   it('should tell ROUTER to navigate by hero id', () => {\n@@ -53,7 +57,9 @@ describe('DashboardComponent class only', () => {\n     comp.gotoDetail(hero);\n \n     const navArgs = spy.calls.mostRecent().args[0];\n-    expect(navArgs).toBe('/heroes/42', 'should nav to HeroDetail for Hero 42');\n+    expect(navArgs)\n+      .withContext('should nav to HeroDetail for Hero 42')\n+      .toBe('/heroes/42');\n   });\n \n });"
        },
        {
            "sha": "1a896d496f4c983176b6c5c0406974ec50adccd0",
            "filename": "aio/content/examples/testing/src/app/dashboard/dashboard.component.spec.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 5,
            "changes": 19,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdashboard%2Fdashboard.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdashboard%2Fdashboard.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdashboard%2Fdashboard.component.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -87,13 +87,17 @@ function compileAndCreate() {\n function tests(heroClick: () => void) {\n \n   it('should NOT have heroes before ngOnInit', () => {\n-    expect(comp.heroes.length).toBe(0, 'should not have heroes before ngOnInit');\n+    expect(comp.heroes.length)\n+      .withContext('should not have heroes before ngOnInit')\n+      .toBe(0);\n   });\n \n   it('should NOT have heroes immediately after ngOnInit', () => {\n     fixture.detectChanges();  // runs initial lifecycle hooks\n \n-    expect(comp.heroes.length).toBe(0, 'should not have heroes until service promise resolves');\n+    expect(comp.heroes.length)\n+      .withContext('should not have heroes until service promise resolves')\n+      .toBe(0);\n   });\n \n   describe('after get dashboard heroes', () => {\n@@ -109,14 +113,17 @@ function tests(heroClick: () => void) {\n \n     it('should HAVE heroes', () => {\n       expect(comp.heroes.length)\n-          .toBeGreaterThan(0, 'should have heroes after service promise resolves');\n+        .withContext('should have heroes after service promise resolves')\n+        .toBeGreaterThan(0);\n     });\n \n     it('should DISPLAY heroes', () => {\n       // Find and examine the displayed heroes\n       // Look for them in the DOM by css class\n       const heroes = fixture.nativeElement.querySelectorAll('dashboard-hero');\n-      expect(heroes.length).toBe(4, 'should display 4 heroes');\n+      expect(heroes.length)\n+        .withContext('should display 4 heroes')\n+        .toBe(4);\n     });\n \n     // #docregion navigate-test\n@@ -129,7 +136,9 @@ function tests(heroClick: () => void) {\n \n       // expecting to navigate to id of the component's first hero\n       const id = comp.heroes[0].id;\n-      expect(navArgs).toBe('/heroes/' + id, 'should nav to HeroDetail for first hero');\n+      expect(navArgs)\n+        .withContext('should nav to HeroDetail for first hero')\n+        .toBe('/heroes/' + id);\n     });\n     // #enddocregion navigate-test\n   });"
        },
        {
            "sha": "3f75b8184b93173acbb7240380f8d26721adef75",
            "filename": "aio/content/examples/testing/src/app/demo/async-helper.spec.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 4,
            "changes": 17,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fasync-helper.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fasync-helper.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fasync-helper.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -11,7 +11,9 @@ describe('Angular async helper', () => {\n     });\n \n     afterEach(() => {\n-      expect(actuallyDone).toBe(true, 'actuallyDone should be true');\n+      expect(actuallyDone)\n+        .withContext('actuallyDone should be true')\n+        .toBe(true);\n     });\n \n     it('should run normal test', () => {\n@@ -59,17 +61,24 @@ describe('Angular async helper', () => {\n     // Use done. Can also use async or fakeAsync.\n     it('should run async test with successful delayed Observable', (done: DoneFn) => {\n       const source = of(true).pipe(delay(10));\n-      source.subscribe(val => actuallyDone = true, err => fail(err), done);\n+      source.subscribe({\n+        next: val => actuallyDone = true,\n+        error: err => fail(err),\n+        complete: done});\n     });\n \n     it('should run async test with successful delayed Observable', waitForAsync(() => {\n          const source = of(true).pipe(delay(10));\n-         source.subscribe(val => actuallyDone = true, err => fail(err));\n+         source.subscribe({\n+           next: val => actuallyDone = true,\n+           error: err => fail(err)});\n        }));\n \n     it('should run async test with successful delayed Observable', fakeAsync(() => {\n          const source = of(true).pipe(delay(10));\n-         source.subscribe(val => actuallyDone = true, err => fail(err));\n+         source.subscribe({\n+           next: val => actuallyDone = true,\n+           error: err => fail(err)});\n \n          tick(10);\n        }));"
        },
        {
            "sha": "9ef0d6138e3b23b1e1c89f07ce82f31e1fbdea0a",
            "filename": "aio/content/examples/testing/src/app/demo/demo.spec.ts",
            "status": "modified",
            "additions": 23,
            "deletions": 9,
            "changes": 32,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fdemo.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fdemo.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fdemo.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -74,9 +74,11 @@ describe('demo (no TestBed):', () => {\n       masterService = new MasterService(valueServiceSpy);\n \n       expect(masterService.getValue())\n-        .toBe(stubValue, 'service returned stub value');\n+        .withContext('service returned stub value')\n+        .toBe(stubValue);\n       expect(valueServiceSpy.getValue.calls.count())\n-        .toBe(1, 'spy method was called once');\n+        .withContext('spy method was called once')\n+        .toBe(1);\n       expect(valueServiceSpy.getValue.calls.mostRecent().returnValue)\n         .toBe(stubValue);\n     });\n@@ -90,9 +92,11 @@ describe('demo (no TestBed):', () => {\n       const { masterService, stubValue, valueServiceSpy } = setup();\n       // #enddocregion no-before-each-setup-call\n       expect(masterService.getValue())\n-        .toBe(stubValue, 'service returned stub value');\n+        .withContext('service returned stub value')\n+        .toBe(stubValue);\n       expect(valueServiceSpy.getValue.calls.count())\n-        .toBe(1, 'spy method was called once');\n+        .withContext('spy method was called once')\n+        .toBe(1);\n       expect(valueServiceSpy.getValue.calls.mostRecent().returnValue)\n         .toBe(stubValue);\n     });\n@@ -131,18 +135,28 @@ describe('demo (no TestBed):', () => {\n   describe('LightswitchComp', () => {\n     it('#clicked() should toggle #isOn', () => {\n       const comp = new LightswitchComponent();\n-      expect(comp.isOn).toBe(false, 'off at first');\n+      expect(comp.isOn)\n+        .withContext('off at first')\n+        .toBe(false);\n       comp.clicked();\n-      expect(comp.isOn).toBe(true, 'on after click');\n+      expect(comp.isOn)\n+        .withContext('on after click')\n+        .toBe(true);\n       comp.clicked();\n-      expect(comp.isOn).toBe(false, 'off after second click');\n+      expect(comp.isOn)\n+        .withContext('off after second click')\n+        .toBe(false);\n     });\n \n     it('#clicked() should set #message to \"is on\"', () => {\n       const comp = new LightswitchComponent();\n-      expect(comp.message).toMatch(/is off/i, 'off at first');\n+      expect(comp.message)\n+        .withContext('off at first')\n+        .toMatch(/is off/i);\n       comp.clicked();\n-      expect(comp.message).toMatch(/is on/i, 'on after clicked');\n+      expect(comp.message)\n+        .withContext('on after clicked')\n+        .toMatch(/is on/i);\n     });\n   });\n   // #enddocregion Lightswitch"
        },
        {
            "sha": "872d2d3a36c2505663e3c41e01ab30c52776e9fd",
            "filename": "aio/content/examples/testing/src/app/demo/demo.testbed.spec.ts",
            "status": "modified",
            "additions": 136,
            "deletions": 61,
            "changes": 197,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fdemo.testbed.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fdemo.testbed.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fdemo.testbed.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -119,9 +119,11 @@ describe('demo (with TestBed):', () => {\n       valueServiceSpy.getValue.and.returnValue(stubValue);\n \n       expect(masterService.getValue())\n-        .toBe(stubValue, 'service returned stub value');\n+        .withContext('service returned stub value')\n+        .toBe(stubValue);\n       expect(valueServiceSpy.getValue.calls.count())\n-        .toBe(1, 'spy method was called once');\n+        .withContext('spy method was called once')\n+        .toBe(1);\n       expect(valueServiceSpy.getValue.calls.mostRecent().returnValue)\n         .toBe(stubValue);\n     });\n@@ -201,7 +203,9 @@ describe('demo (with TestBed):', () => {\n \n       fixture.detectChanges();\n       const heroes = fixture.debugElement.queryAll(By.css('.hero'));\n-      expect(heroes.length).toBeGreaterThan(0, 'has heroes');\n+      expect(heroes.length)\n+        .withContext('has heroes')\n+        .toBeGreaterThan(0);\n \n       const comp = fixture.componentInstance;\n       const hero = comp.heroes[0];\n@@ -222,12 +226,18 @@ describe('demo (with TestBed):', () => {\n       const ngForRow = fixture.debugElement.query(By.directive(IoComponent)); // first hero ngForRow\n \n       const hero = ngForRow.context.hero; // the hero object passed into the row\n-      expect(hero.name).toBe(heroName, 'ngRow.context.hero');\n+      expect(hero.name)\n+        .withContext('ngRow.context.hero')\n+        .toBe(heroName);\n \n       const rowComp = ngForRow.componentInstance;\n       // jasmine.any is an \"instance-of-type\" test.\n-      expect(rowComp).toEqual(jasmine.any(IoComponent), 'component is IoComp');\n-      expect(rowComp.hero.name).toBe(heroName, 'component.hero');\n+      expect(rowComp)\n+        .withContext('component is IoComp')\n+        .toEqual(jasmine.any(IoComponent));\n+      expect(rowComp.hero.name)\n+        .withContext('component.hero')\n+        .toBe(heroName);\n     });\n \n     it('should support clicking a button', () => {\n@@ -236,11 +246,15 @@ describe('demo (with TestBed):', () => {\n       const span = fixture.debugElement.query(By.css('span')).nativeElement;\n \n       fixture.detectChanges();\n-      expect(span.textContent).toMatch(/is off/i, 'before click');\n+      expect(span.textContent)\n+        .withContext('before click')\n+        .toMatch(/is off/i);\n \n       click(btn);\n       fixture.detectChanges();\n-      expect(span.textContent).toMatch(/is on/i, 'after click');\n+      expect(span.textContent)\n+        .withContext('after click')\n+        .toMatch(/is on/i);\n     });\n \n     // ngModel is async so we must wait for it with promise-based `whenStable`\n@@ -254,20 +268,23 @@ describe('demo (with TestBed):', () => {\n       const comp = fixture.componentInstance;\n       const input = fixture.debugElement.query(By.css('input')).nativeElement as HTMLInputElement;\n \n-      expect(comp.name).toBe(expectedOrigName,\n-        `At start name should be ${expectedOrigName} `);\n+      expect(comp.name)\n+        .withContext(`At start name should be ${expectedOrigName} `)\n+        .toBe(expectedOrigName);\n \n       // wait until ngModel binds comp.name to input box\n       fixture.whenStable().then(() => {\n-        expect(input.value).toBe(expectedOrigName,\n-          `After ngModel updates input box, input.value should be ${expectedOrigName} `);\n+        expect(input.value)\n+          .withContext(`After ngModel updates input box, input.value should be ${expectedOrigName} `)\n+          .toBe(expectedOrigName);\n \n         // simulate user entering new name in input\n         input.value = expectedNewName;\n \n         // that change doesn't flow to the component immediately\n-        expect(comp.name).toBe(expectedOrigName,\n-          `comp.name should still be ${expectedOrigName} after value change, before binding happens`);\n+        expect(comp.name)\n+          .withContext(`comp.name should still be ${expectedOrigName} after value change, before binding happens`)\n+          .toBe(expectedOrigName);\n \n         // Dispatch a DOM event so that Angular learns of input value change.\n         // then wait while ngModel pushes input.box value to comp.name\n@@ -277,8 +294,9 @@ describe('demo (with TestBed):', () => {\n         return fixture.whenStable();\n       })\n         .then(() => {\n-          expect(comp.name).toBe(expectedNewName,\n-            `After ngModel updates the model, comp.name should be ${expectedNewName} `);\n+          expect(comp.name)\n+            .withContext(`After ngModel updates the model, comp.name should be ${expectedNewName} `)\n+            .toBe(expectedNewName);\n         });\n     }));\n \n@@ -294,29 +312,33 @@ describe('demo (with TestBed):', () => {\n       const comp =  fixture.componentInstance;\n       const input = fixture.debugElement.query(By.css('input')).nativeElement as HTMLInputElement;\n \n-      expect(comp.name).toBe(expectedOrigName,\n-        `At start name should be ${expectedOrigName} `);\n+      expect(comp.name)\n+        .withContext(`At start name should be ${expectedOrigName} `)\n+        .toBe(expectedOrigName);\n \n       // wait until ngModel binds comp.name to input box\n       tick();\n-      expect(input.value).toBe(expectedOrigName,\n-        `After ngModel updates input box, input.value should be ${expectedOrigName} `);\n+      expect(input.value)\n+        .withContext(`After ngModel updates input box, input.value should be ${expectedOrigName} `)\n+        .toBe(expectedOrigName);\n \n       // simulate user entering new name in input\n       input.value = expectedNewName;\n \n       // that change doesn't flow to the component immediately\n-      expect(comp.name).toBe(expectedOrigName,\n-        `comp.name should still be ${expectedOrigName} after value change, before binding happens`);\n+      expect(comp.name)\n+        .withContext(`comp.name should still be ${expectedOrigName} after value change, before binding happens`)\n+        .toBe(expectedOrigName);\n \n       // Dispatch a DOM event so that Angular learns of input value change.\n       // then wait a tick while ngModel pushes input.box value to comp.name\n       // In older browsers, such as IE, you might need a CustomEvent instead. See\n       // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n       input.dispatchEvent(new Event('input'));\n       tick();\n-      expect(comp.name).toBe(expectedNewName,\n-        `After ngModel updates the model, comp.name should be ${expectedNewName} `);\n+      expect(comp.name)\n+        .withContext(`After ngModel updates the model, comp.name should be ${expectedNewName} `)\n+        .toBe(expectedNewName);\n     }));\n \n     it('ReversePipeComp should reverse the input text', fakeAsync(() => {\n@@ -341,8 +363,12 @@ describe('demo (with TestBed):', () => {\n       input.dispatchEvent(new Event('input'));\n       tick();\n       fixture.detectChanges();\n-      expect(span.textContent).toBe(expectedText, 'output span');\n-      expect(comp.text).toBe(inputText, 'component.text');\n+      expect(span.textContent)\n+        .withContext('output span')\n+        .toBe(expectedText);\n+      expect(comp.text)\n+        .withContext('component.text')\n+        .toBe(inputText);\n     }));\n \n     // Use this technique to find attached directives of any kind\n@@ -352,12 +378,18 @@ describe('demo (with TestBed):', () => {\n \n       const inputEl = fixture.debugElement.query(By.css('input'));\n \n-      expect(inputEl.providerTokens).toContain(NgModel, 'NgModel directive');\n+      expect(inputEl.providerTokens)\n+        .withContext('NgModel directive')\n+        .toContain(NgModel);\n \n       const ngControl = inputEl.injector.get(NgControl);\n-      expect(ngControl).toEqual(jasmine.any(NgControl), 'NgControl directive');\n+      expect(ngControl)\n+        .withContext('NgControl directive')\n+        .toEqual(jasmine.any(NgControl));\n \n-      expect(inputEl.listeners.length).toBeGreaterThan(2, 'several listeners attached');\n+      expect(inputEl.listeners.length)\n+        .withContext('several listeners attached')\n+        .toBeGreaterThan(2);\n     });\n \n     it('BankAccountComponent should set attributes, styles, classes, and properties', () => {\n@@ -370,16 +402,30 @@ describe('demo (with TestBed):', () => {\n       const childComp = el.componentInstance as BankAccountComponent;\n       expect(childComp).toEqual(jasmine.any(BankAccountComponent));\n \n-      expect(el.context).toBe(childComp, 'context is the child component');\n-\n-      expect(el.attributes['account']).toBe(childComp.id, 'account attribute');\n-      expect(el.attributes['bank']).toBe(childComp.bank, 'bank attribute');\n-\n-      expect(el.classes['closed']).toBe(true, 'closed class');\n-      expect(el.classes['open']).toBeFalsy('open class');\n-\n-      expect(el.styles['color']).toBe(comp.color, 'color style');\n-      expect(el.styles['width']).toBe(comp.width + 'px', 'width style');\n+      expect(el.context)\n+        .withContext('context is the child component')\n+        .toBe(childComp);\n+\n+      expect(el.attributes['account'])\n+        .withContext('account attribute')\n+        .toBe(childComp.id);\n+      expect(el.attributes['bank'])\n+        .withContext('bank attribute')\n+        .toBe(childComp.bank);\n+\n+      expect(el.classes['closed'])\n+        .withContext('closed class')\n+        .toBe(true);\n+      expect(el.classes['open'])\n+        .withContext('open class')\n+        .toBeFalsy();\n+\n+      expect(el.styles['color'])\n+        .withContext('color style')\n+        .toBe(comp.color);\n+      expect(el.styles['width'])\n+        .withContext('width style')\n+        .toBe(comp.width + 'px');\n \n       // Removed on 12/02/2016 when ceased public discussion of the `Renderer`. Revive in future?\n       // expect(el.properties['customProperty']).toBe(true, 'customProperty');\n@@ -423,9 +469,15 @@ describe('demo (with TestBed):', () => {\n \n       // Explore the providerTokens\n       const tokens = fixture.debugElement.providerTokens;\n-      expect(tokens).toContain(fixture.componentInstance.constructor, 'component ctor');\n-      expect(tokens).toContain(TestProvidersComponent, 'TestProvidersComp');\n-      expect(tokens).toContain(ValueService, 'ValueService');\n+      expect(tokens)\n+        .withContext('component ctor')\n+        .toContain(fixture.componentInstance.constructor);\n+      expect(tokens)\n+        .withContext('TestProvidersComp')\n+        .toContain(TestProvidersComponent);\n+      expect(tokens)\n+        .withContext('ValueService')\n+        .toContain(ValueService);\n     });\n \n     it(\"should override TestViewProvidersComp's ValueService viewProvider\", () => {\n@@ -471,12 +523,22 @@ describe('demo (with TestBed):', () => {\n       const tcProvider = fixture.debugElement.injector.get(ValueService) as ValueService;\n       const tpcProvider = fixture.debugElement.children[0].injector.get(ValueService) as FakeValueService;\n \n-      expect(testBedProvider).not.toBe(tcProvider, 'testBed/tc not same providers');\n-      expect(testBedProvider).not.toBe(tpcProvider, 'testBed/tpc not same providers');\n+      expect(testBedProvider)\n+        .withContext('testBed/tc not same providers')\n+        .not.toBe(tcProvider);\n+      expect(testBedProvider)\n+        .withContext('testBed/tpc not same providers')\n+        .not.toBe(tpcProvider);\n \n-      expect(testBedProvider instanceof ValueService).toBe(true, 'testBedProvider is ValueService');\n-      expect(tcProvider).toEqual({} as ValueService, 'tcProvider is {}');\n-      expect(tpcProvider instanceof FakeValueService).toBe(true, 'tpcProvider is FakeValueService');\n+      expect(testBedProvider instanceof ValueService)\n+        .withContext('testBedProvider is ValueService')\n+        .toBe(true);\n+      expect(tcProvider)\n+        .withContext('tcProvider is {}')\n+        .toEqual({} as ValueService);\n+      expect(tpcProvider instanceof FakeValueService)\n+        .withContext('tpcProvider is FakeValueService')\n+        .toBe(true);\n     });\n \n     it('can access template local variables as references', () => {\n@@ -505,16 +567,21 @@ describe('demo (with TestBed):', () => {\n       const el = fixture.debugElement.children[0];\n       const comp = el.componentInstance;\n \n-      expect(comp.children.toArray().length).toBe(4,\n-        'three different child components and an ElementRef with #content');\n+      expect(comp.children.toArray().length)\n+        .withContext('three different child components and an ElementRef with #content')\n+        .toBe(4);\n \n-      expect(el.references['nc']).toBe(comp, '#nc reference to component');\n+      expect(el.references['nc'])\n+        .withContext('#nc reference to component')\n+        .toBe(comp);\n \n       // #docregion custom-predicate\n       // Filter for DebugElements with a #content reference\n       const contentRefs = el.queryAll( de => de.references['content']);\n       // #enddocregion custom-predicate\n-      expect(contentRefs.length).toBe(4, 'elements w/ a #content reference');\n+      expect(contentRefs.length)\n+        .withContext('elements w/ a #content reference')\n+        .toBe(4);\n     });\n \n   });\n@@ -565,7 +632,9 @@ describe('demo (with TestBed):', () => {\n     });\n \n     it('should instantiate parent component', () => {\n-      expect(parent).not.toBeNull('parent component should exist');\n+      expect(parent)\n+        .withContext('parent component should exist')\n+        .not.toBeNull();\n     });\n \n     it('parent component OnInit should NOT be called before first detectChanges()', () => {\n@@ -580,7 +649,9 @@ describe('demo (with TestBed):', () => {\n     it('child component should exist after OnInit', () => {\n       fixture.detectChanges();\n       getChild();\n-      expect(child instanceof MyIfChildComponent).toBe(true, 'should create child');\n+      expect(child instanceof MyIfChildComponent)\n+        .withContext('should create child')\n+        .toBe(true);\n     });\n \n     it(\"should have called child component's OnInit \", () => {\n@@ -602,10 +673,12 @@ describe('demo (with TestBed):', () => {\n       parent.parentValue = 'foo';\n       fixture.detectChanges();\n \n-      expect(child.ngOnChangesCounter).toBe(2,\n-        'expected 2 changes: initial value and changed value');\n-      expect(child.childValue).toBe('foo',\n-        'childValue should eq changed parent value');\n+      expect(child.ngOnChangesCounter)\n+        .withContext('expected 2 changes: initial value and changed value')\n+        .toBe(2);\n+      expect(child.childValue)\n+        .withContext('childValue should eq changed parent value')\n+        .toBe('foo');\n     });\n \n     // must be async test to see child flow to parent\n@@ -622,10 +695,12 @@ describe('demo (with TestBed):', () => {\n         .then(() => {\n           fixture.detectChanges();\n \n-          expect(child.ngOnChangesCounter).toBe(2,\n-            'expected 2 changes: initial value and changed value');\n-          expect(parent.parentValue).toBe('bar',\n-            'parentValue should eq changed parent value');\n+          expect(child.ngOnChangesCounter)\n+            .withContext('expected 2 changes: initial value and changed value')\n+            .toBe(2);\n+          expect(parent.parentValue)\n+            .withContext('parentValue should eq changed parent value')\n+            .toBe('bar');\n         });\n \n     }));"
        },
        {
            "sha": "e325ed88177c61174c1b8df5588b1bd4437a4112",
            "filename": "aio/content/examples/testing/src/app/hero/hero-detail.component.no-testbed.spec.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.no-testbed.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.no-testbed.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.no-testbed.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -36,21 +36,29 @@ describe('HeroDetailComponent - no TestBed', () => {\n \n   it('should navigate when click cancel', () => {\n     comp.cancel();\n-    expect(router.navigate.calls.any()).toBe(true, 'router.navigate called');\n+    expect(router.navigate.calls.any())\n+      .withContext('router.navigate called')\n+      .toBe(true);\n   });\n \n   it('should save when click save', () => {\n     comp.save();\n-    expect(hds.saveHero.calls.any()).toBe(true, 'HeroDetailService.save called');\n-    expect(router.navigate.calls.any()).toBe(false, 'router.navigate not called yet');\n+    expect(hds.saveHero.calls.any())\n+      .withContext('HeroDetailService.save called')\n+      .toBe(true);\n+    expect(router.navigate.calls.any())\n+      .withContext('router.navigate not called yet')\n+      .toBe(false);\n   });\n \n   it('should navigate when click save resolves', (done: DoneFn) => {\n     comp.save();\n     // waits for async save to complete before navigating\n     hds.saveHero.calls.first().returnValue\n     .subscribe(() => {\n-      expect(router.navigate.calls.any()).toBe(true, 'router.navigate called');\n+      expect(router.navigate.calls.any())\n+        .withContext('router.navigate called')\n+        .toBe(true);\n       done();\n     });\n   });"
        },
        {
            "sha": "01db4882c6400392c25cb296dac310b24539f87c",
            "filename": "aio/content/examples/testing/src/app/hero/hero-detail.component.spec.ts",
            "status": "modified",
            "additions": 42,
            "deletions": 14,
            "changes": 56,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -87,7 +87,9 @@ function overrideSetup() {\n   });\n \n   it('should have called `getHero`', () => {\n-    expect(hdsSpy.getHero.calls.count()).toBe(1, 'getHero called once');\n+    expect(hdsSpy.getHero.calls.count())\n+      .withContext('getHero called once')\n+      .toBe(1, 'getHero called once');\n   });\n \n   it(\"should display stub hero's name\", () => {\n@@ -104,15 +106,25 @@ function overrideSetup() {\n        // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n        page.nameInput.dispatchEvent(new Event('input')); // tell Angular\n \n-       expect(component.hero.name).toBe(newName, 'component hero has new name');\n-       expect(hdsSpy.testHero.name).toBe(origName, 'service hero unchanged before save');\n+       expect(component.hero.name)\n+        .withContext('component hero has new name')\n+        .toBe(newName);\n+       expect(hdsSpy.testHero.name)\n+        .withContext('service hero unchanged before save')\n+        .toBe(origName);\n \n        click(page.saveBtn);\n-       expect(hdsSpy.saveHero.calls.count()).toBe(1, 'saveHero called once');\n+       expect(hdsSpy.saveHero.calls.count())\n+        .withContext('saveHero called once')\n+        .toBe(1);\n \n        tick();  // wait for async save to complete\n-       expect(hdsSpy.testHero.name).toBe(newName, 'service hero has new name after save');\n-       expect(page.navigateSpy.calls.any()).toBe(true, 'router.navigate called');\n+       expect(hdsSpy.testHero.name)\n+        .withContext('service hero has new name after save')\n+        .toBe(newName);\n+       expect(page.navigateSpy.calls.any())\n+        .withContext('router.navigate called')\n+        .toBe(true);\n      }));\n   // #enddocregion override-tests\n \n@@ -122,7 +134,9 @@ function overrideSetup() {\n        // use `fixture.debugElement.injector` to get service from component\n        const componentService = fixture.debugElement.injector.get(HeroDetailService);\n \n-       expect(fixtureService).not.toBe(componentService, 'service injected from fixture');\n+       expect(fixtureService)\n+        .withContext('service injected from fixture')\n+        .not.toBe(componentService);\n      }));\n }\n \n@@ -170,7 +184,9 @@ function heroModuleSetup() {\n \n     it('should navigate when click cancel', () => {\n       click(page.cancelBtn);\n-      expect(page.navigateSpy.calls.any()).toBe(true, 'router.navigate called');\n+      expect(page.navigateSpy.calls.any())\n+        .withContext('router.navigate called')\n+        .toBe(true);\n     });\n \n     it('should save when click save but not navigate immediately', () => {\n@@ -180,14 +196,20 @@ function heroModuleSetup() {\n       const saveSpy = spyOn(hds, 'saveHero').and.callThrough();\n \n       click(page.saveBtn);\n-      expect(saveSpy.calls.any()).toBe(true, 'HeroDetailService.save called');\n-      expect(page.navigateSpy.calls.any()).toBe(false, 'router.navigate not called');\n+      expect(saveSpy.calls.any())\n+        .withContext('HeroDetailService.save called')\n+        .toBe(true);\n+      expect(page.navigateSpy.calls.any())\n+        .withContext('router.navigate not called')\n+        .toBe(false);\n     });\n \n     it('should navigate when click save and save resolves', fakeAsync(() => {\n          click(page.saveBtn);\n          tick();  // wait for async save to complete\n-         expect(page.navigateSpy.calls.any()).toBe(true, 'router.navigate called');\n+         expect(page.navigateSpy.calls.any())\n+          .withContext('router.navigate called')\n+          .toBe(true);\n        }));\n \n     // #docregion title-case-pipe\n@@ -240,8 +262,12 @@ function heroModuleSetup() {\n     });\n \n     it('should try to navigate back to hero list', () => {\n-      expect(page.gotoListSpy.calls.any()).toBe(true, 'comp.gotoList called');\n-      expect(page.navigateSpy.calls.any()).toBe(true, 'router.navigate called');\n+      expect(page.gotoListSpy.calls.any())\n+        .withContext('comp.gotoList called')\n+        .toBe(true);\n+      expect(page.navigateSpy.calls.any())\n+        .withContext('router.navigate called')\n+        .toBe(true);\n     });\n   });\n   // #enddocregion route-bad-id\n@@ -258,7 +284,9 @@ function heroModuleSetup() {\n \n     // get `HeroDetailService` with component's own injector\n     service = fixture.debugElement.injector.get(HeroDetailService);\n-    expect(service).toBeDefined('debugElement.injector');\n+    expect(service)\n+      .withContext('debugElement.injector')\n+      .toBeDefined();\n   });\n }\n "
        },
        {
            "sha": "23d88cd9a79f0c3e1a82e71bdcb8bfd1a3c4b4a4",
            "filename": "aio/content/examples/testing/src/app/hero/hero-list.component.spec.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 7,
            "changes": 28,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-list.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-list.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-list.component.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -46,8 +46,12 @@ describe('HeroListComponent', () => {\n   it('1st hero should match 1st test hero', () => {\n     const expectedHero = HEROES[0];\n     const actualHero = page.heroRows[0].textContent;\n-    expect(actualHero).toContain(expectedHero.id.toString(), 'hero.id');\n-    expect(actualHero).toContain(expectedHero.name, 'hero.name');\n+    expect(actualHero)\n+      .withContext('hero.id')\n+      .toContain(expectedHero.id.toString());\n+    expect(actualHero)\n+      .withContext('hero.name')\n+      .toContain(expectedHero.name);\n   });\n \n   it('should select hero on click', fakeAsync(() => {\n@@ -72,14 +76,20 @@ describe('HeroListComponent', () => {\n        tick();\n \n        // should have navigated\n-       expect(page.navSpy.calls.any()).toBe(true, 'navigate called');\n+       expect(page.navSpy.calls.any())\n+        .withContext('navigate called')\n+        .toBe(true);\n \n        // composed hero detail will be URL like 'heroes/42'\n        // expect link array with the route path and hero id\n        // first argument to router.navigate is link array\n        const navArgs = page.navSpy.calls.first().args[0];\n-       expect(navArgs[0]).toContain('heroes', 'nav to heroes detail URL');\n-       expect(navArgs[1]).toBe(expectedHero.id, 'expected hero.id');\n+       expect(navArgs[0])\n+        .withContext('nav to heroes detail URL')\n+        .toContain('heroes');\n+       expect(navArgs[1])\n+        .withContext('expected hero.id')\n+        .toBe(expectedHero.id);\n      }));\n \n   it('should find `HighlightDirective` with `By.directive', () => {\n@@ -97,11 +107,15 @@ describe('HeroListComponent', () => {\n \n     // different browsers report color values differently\n     const isExpectedColor = bgColor === 'gold' || bgColor === 'rgb(255, 215, 0)';\n-    expect(isExpectedColor).toBe(true, 'backgroundColor');\n+    expect(isExpectedColor)\n+      .withContext('backgroundColor')\n+      .toBe(true);\n   });\n \n   it(\"the `HighlightDirective` is among the element's providers\", () => {\n-    expect(page.highlightDe.providerTokens).toContain(HighlightDirective, 'HighlightDirective');\n+    expect(page.highlightDe.providerTokens)\n+      .withContext('HighlightDirective')\n+      .toContain(HighlightDirective);\n   });\n });\n "
        },
        {
            "sha": "8914cae42ec545852af4a3d24f5141b20af701a9",
            "filename": "aio/content/examples/testing/src/app/model/hero.service.spec.ts",
            "status": "modified",
            "additions": 53,
            "deletions": 39,
            "changes": 92,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fmodel%2Fhero.service.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fmodel%2Fhero.service.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fmodel%2Fhero.service.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -26,14 +26,18 @@ describe ('HeroesService (with spies)', () => {\n \n     httpClientSpy.get.and.returnValue(asyncData(expectedHeroes));\n \n-    heroService.getHeroes().subscribe(\n-      heroes => {\n-        expect(heroes).toEqual(expectedHeroes, 'expected heroes');\n+    heroService.getHeroes().subscribe({\n+      next: heroes => {\n+        expect(heroes)\n+          .withContext('expected heroes')\n+          .toEqual(expectedHeroes);\n         done();\n       },\n-      done.fail\n-    );\n-    expect(httpClientSpy.get.calls.count()).toBe(1, 'one call');\n+      error: done.fail\n+    });\n+    expect(httpClientSpy.get.calls.count())\n+      .withContext('one call')\n+      .toBe(1);\n   });\n \n   it('should return an error when the server returns a 404', (done: DoneFn) => {\n@@ -44,13 +48,13 @@ describe ('HeroesService (with spies)', () => {\n \n     httpClientSpy.get.and.returnValue(asyncError(errorResponse));\n \n-    heroService.getHeroes().subscribe(\n-      heroes => done.fail('expected an error, not heroes'),\n-      error  => {\n+    heroService.getHeroes().subscribe({\n+      next: heroes => done.fail('expected an error, not heroes'),\n+      error: error  => {\n         expect(error.message).toContain('test 404 error');\n         done();\n       }\n-    );\n+    });\n   });\n   // #enddocregion test-with-spies\n \n@@ -94,10 +98,12 @@ describe('HeroesService (with mocks)', () => {\n     });\n \n     it('should return expected heroes (called once)', () => {\n-      heroService.getHeroes().subscribe(\n-        heroes => expect(heroes).toEqual(expectedHeroes, 'should return expected heroes'),\n-        fail\n-      );\n+      heroService.getHeroes().subscribe({\n+        next: heroes => expect(heroes)\n+          .withContext('should return expected heroes')\n+          .toEqual(expectedHeroes),\n+        error: fail\n+      });\n \n       // HeroService should have made one request to GET heroes from expected URL\n       const req = httpTestingController.expectOne(heroService.heroesUrl);\n@@ -108,21 +114,23 @@ describe('HeroesService (with mocks)', () => {\n     });\n \n     it('should be OK returning no heroes', () => {\n-      heroService.getHeroes().subscribe(\n-        heroes => expect(heroes.length).toEqual(0, 'should have empty heroes array'),\n-        fail\n-      );\n+      heroService.getHeroes().subscribe({\n+        next: heroes => expect(heroes.length)\n+          .withContext('should have empty heroes array')\n+          .toEqual(0),\n+        error: fail\n+      });\n \n       const req = httpTestingController.expectOne(heroService.heroesUrl);\n       req.flush([]); // Respond with no heroes\n     });\n \n     it('should turn 404 into a user-friendly error', () => {\n       const msg = 'Deliberate 404';\n-      heroService.getHeroes().subscribe(\n-        heroes => fail('expected to fail'),\n-        error => expect(error.message).toContain(msg)\n-      );\n+      heroService.getHeroes().subscribe({\n+        next: heroes => fail('expected to fail'),\n+        error: error => expect(error.message).toContain(msg)\n+      });\n \n       const req = httpTestingController.expectOne(heroService.heroesUrl);\n \n@@ -133,13 +141,17 @@ describe('HeroesService (with mocks)', () => {\n     it('should return expected heroes (called multiple times)', () => {\n       heroService.getHeroes().subscribe();\n       heroService.getHeroes().subscribe();\n-      heroService.getHeroes().subscribe(\n-        heroes => expect(heroes).toEqual(expectedHeroes, 'should return expected heroes'),\n-        fail\n-      );\n+      heroService.getHeroes().subscribe({\n+        next: heroes => expect(heroes)\n+          .withContext('should return expected heroes')\n+          .toEqual(expectedHeroes),\n+        error: fail\n+      });\n \n       const requests = httpTestingController.match(heroService.heroesUrl);\n-      expect(requests.length).toEqual(3, 'calls to getHeroes()');\n+      expect(requests.length)\n+        .withContext('calls to getHeroes()')\n+        .toEqual(3);\n \n       // Respond to each request with different mock hero results\n       requests[0].flush([]);\n@@ -156,10 +168,12 @@ describe('HeroesService (with mocks)', () => {\n \n       const updateHero: Hero = { id: 1, name: 'A' };\n \n-      heroService.updateHero(updateHero).subscribe(\n-        data => expect(data).toEqual(updateHero, 'should return the hero'),\n-        fail\n-      );\n+      heroService.updateHero(updateHero).subscribe({\n+        next: data => expect(data)\n+          .withContext('should return the hero')\n+          .toEqual(updateHero),\n+        error: fail\n+      });\n \n       // HeroService should have made one request to PUT hero\n       const req = httpTestingController.expectOne(heroService.heroesUrl);\n@@ -175,10 +189,10 @@ describe('HeroesService (with mocks)', () => {\n     it('should turn 404 error into user-facing error', () => {\n       const msg = 'Deliberate 404';\n       const updateHero: Hero = { id: 1, name: 'A' };\n-      heroService.updateHero(updateHero).subscribe(\n-        heroes => fail('expected to fail'),\n-        error => expect(error.message).toContain(msg)\n-      );\n+      heroService.updateHero(updateHero).subscribe({\n+        next: heroes => fail('expected to fail'),\n+        error: error => expect(error.message).toContain(msg)\n+      });\n \n       const req = httpTestingController.expectOne(heroService.heroesUrl);\n \n@@ -192,13 +206,13 @@ describe('HeroesService (with mocks)', () => {\n       const errorEvent = new ProgressEvent('error');\n \n       const updateHero: Hero = { id: 1, name: 'A' };\n-      heroService.updateHero(updateHero).subscribe(\n-        heroes => fail('expected to fail'),\n-        error => {\n+      heroService.updateHero(updateHero).subscribe({\n+        next: heroes => fail('expected to fail'),\n+        error: error => {\n           expect(error).toBe(errorEvent);\n           done();\n         }\n-      );\n+      });\n \n       const req = httpTestingController.expectOne(heroService.heroesUrl);\n "
        },
        {
            "sha": "d266eb548a8a3dae67efdb05c081ea36aa7298e6",
            "filename": "aio/content/examples/testing/src/app/model/testing/http-client.spec.ts",
            "status": "modified",
            "additions": 23,
            "deletions": 13,
            "changes": 36,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fmodel%2Ftesting%2Fhttp-client.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fmodel%2Ftesting%2Fhttp-client.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fmodel%2Ftesting%2Fhttp-client.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -86,13 +86,19 @@ describe('HttpClient testing', () => {\n \n     // Make three requests in a row\n     httpClient.get<Data[]>(testUrl)\n-      .subscribe(d => expect(d.length).toEqual(0, 'should have no data'));\n+      .subscribe(d => expect(d.length)\n+        .withContext('should have no data')\n+        .toEqual(0));\n \n     httpClient.get<Data[]>(testUrl)\n-      .subscribe(d => expect(d).toEqual([testData[0]], 'should be one element array'));\n+      .subscribe(d => expect(d)\n+        .withContext('should be one element array')\n+        .toEqual([testData[0]]));\n \n     httpClient.get<Data[]>(testUrl)\n-      .subscribe(d => expect(d).toEqual(testData, 'should be expected data'));\n+      .subscribe(d => expect(d)\n+        .withContext('should be expected data')\n+        .toEqual(testData));\n \n     // get all pending requests that match the given URL\n     const requests = httpTestingController.match(testUrl);\n@@ -107,12 +113,16 @@ describe('HttpClient testing', () => {\n   it('can test for 404 error', () => {\n     const emsg = 'deliberate 404 error';\n \n-    httpClient.get<Data[]>(testUrl).subscribe(\n-      data => fail('should have failed with the 404 error'),\n-      (error: HttpErrorResponse) => {\n-        expect(error.status).toEqual(404, 'status');\n-        expect(error.error).toEqual(emsg, 'message');\n-      }\n+    httpClient.get<Data[]>(testUrl).subscribe({\n+      next: data => fail('should have failed with the 404 error'),\n+      error: (error: HttpErrorResponse) => {\n+        expect(error.status)\n+          .withContext('status')\n+          .toEqual(404);\n+        expect(error.error)\n+          .withContext('message')\n+          .toEqual(emsg);\n+      }}\n     );\n \n     const req = httpTestingController.expectOne(testUrl);\n@@ -126,12 +136,12 @@ describe('HttpClient testing', () => {\n     // the network level. Connection timeout, DNS error, offline, etc.\n     const errorEvent = new ProgressEvent('error');\n \n-    httpClient.get<Data[]>(testUrl).subscribe(\n-      data => fail('should have failed with the network error'),\n-      (error: HttpErrorResponse) => {\n+    httpClient.get<Data[]>(testUrl).subscribe({\n+      next: data => fail('should have failed with the network error'),\n+      error: (error: HttpErrorResponse) => {\n         expect(error.error).toBe(errorEvent);\n         done();\n-      }\n+      }}\n     );\n \n     const req = httpTestingController.expectOne(testUrl);"
        },
        {
            "sha": "1cb8bd2bee71b00fbb631b1f9c2f4330e05d6677",
            "filename": "aio/content/examples/testing/src/app/shared/highlight.directive.spec.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fshared%2Fhighlight.directive.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fshared%2Fhighlight.directive.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fshared%2Fhighlight.directive.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -56,7 +56,9 @@ describe('HighlightDirective', () => {\n   it('should bind <input> background to value color', () => {\n     // easier to work with nativeElement\n     const input = des[2].nativeElement as HTMLInputElement;\n-    expect(input.style.backgroundColor).toBe('cyan', 'initial backgroundColor');\n+    expect(input.style.backgroundColor)\n+      .withContext('initial backgroundColor')\n+      .toBe('cyan');\n \n     input.value = 'green';\n \n@@ -66,7 +68,9 @@ describe('HighlightDirective', () => {\n     input.dispatchEvent(new Event('input'));\n     fixture.detectChanges();\n \n-    expect(input.style.backgroundColor).toBe('green', 'changed backgroundColor');\n+    expect(input.style.backgroundColor)\n+      .withContext('changed backgroundColor')\n+      .toBe('green');\n   });\n \n "
        },
        {
            "sha": "f1b709d2e6f1fc3f0e640caa7ec4c7e8310c3914",
            "filename": "aio/content/examples/testing/src/app/twain/twain.component.marbles.spec.ts",
            "status": "modified",
            "additions": 19,
            "deletions": 7,
            "changes": 26,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Ftwain%2Ftwain.component.marbles.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Ftwain%2Ftwain.component.marbles.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Ftwain%2Ftwain.component.marbles.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -1,5 +1,5 @@\n // #docplaster\n-import { async, fakeAsync, ComponentFixture, TestBed, tick } from '@angular/core/testing';\n+import { fakeAsync, ComponentFixture, TestBed, tick } from '@angular/core/testing';\n \n // #docregion import-marbles\n import { cold, getTestScheduler } from 'jasmine-marbles';\n@@ -51,16 +51,22 @@ describe('TwainComponent (marbles)', () => {\n     getQuoteSpy.and.returnValue( q$ );\n \n     fixture.detectChanges(); // ngOnInit()\n-    expect(quoteEl.textContent).toBe('...', 'should show placeholder');\n+    expect(quoteEl.textContent)\n+      .withContext('should show placeholder')\n+      .toBe('...');\n \n     // #docregion test-scheduler-flush\n     getTestScheduler().flush(); // flush the observables\n     // #enddocregion test-scheduler-flush\n \n     fixture.detectChanges(); // update view\n \n-    expect(quoteEl.textContent).toBe(testQuote, 'should show quote');\n-    expect(errorMessage()).toBeNull('should not show error');\n+    expect(quoteEl.textContent)\n+      .withContext('should show quote')\n+      .toBe(testQuote);\n+    expect(errorMessage())\n+      .withContext('should not show error')\n+      .toBeNull();\n   });\n   // #enddocregion get-quote-test\n \n@@ -74,14 +80,20 @@ describe('TwainComponent (marbles)', () => {\n     getQuoteSpy.and.returnValue( q$ );\n \n     fixture.detectChanges(); // ngOnInit()\n-    expect(quoteEl.textContent).toBe('...', 'should show placeholder');\n+    expect(quoteEl.textContent)\n+      .withContext('should show placeholder')\n+      .toBe('...');\n \n     getTestScheduler().flush(); // flush the observables\n     tick();                     // component shows error after a setTimeout()\n     fixture.detectChanges();    // update error message\n \n-    expect(errorMessage()).toMatch(/test failure/, 'should display error');\n-    expect(quoteEl.textContent).toBe('...', 'should show placeholder');\n+    expect(errorMessage())\n+      .withContext('should display error')\n+      .toMatch(/test failure/);\n+    expect(quoteEl.textContent)\n+      .withContext('should show placeholder')\n+      .toBe('...');\n   }));\n   // #enddocregion error-test\n });"
        },
        {
            "sha": "e59d2302bc2515f2df96c0ffd3978f0ab8f4da3a",
            "filename": "aio/content/examples/testing/src/app/twain/twain.component.spec.ts",
            "status": "modified",
            "additions": 64,
            "deletions": 23,
            "changes": 87,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Ftwain%2Ftwain.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Ftwain%2Ftwain.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Ftwain%2Ftwain.component.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -47,9 +47,15 @@ describe('TwainComponent', () => {\n \n   describe('when test with synchronous observable', () => {\n     it('should not show quote before OnInit', () => {\n-      expect(quoteEl.textContent).toBe('', 'nothing displayed');\n-      expect(errorMessage()).toBeNull('should not show error element');\n-      expect(getQuoteSpy.calls.any()).toBe(false, 'getQuote not yet called');\n+      expect(quoteEl.textContent)\n+        .withContext('nothing displayed')\n+        .toBe('');\n+      expect(errorMessage())\n+        .withContext('should not show error element')\n+        .toBeNull();\n+      expect(getQuoteSpy.calls.any())\n+        .withContext('getQuote not yet called')\n+        .toBe(false);\n     });\n \n     // The quote would not be immediately available if the service were truly async.\n@@ -59,7 +65,9 @@ describe('TwainComponent', () => {\n \n       // sync spy result shows testQuote immediately after init\n       expect(quoteEl.textContent).toBe(testQuote);\n-      expect(getQuoteSpy.calls.any()).toBe(true, 'getQuote called');\n+      expect(getQuoteSpy.calls.any())\n+        .withContext('getQuote called')\n+        .toBe(true);\n     });\n     // #enddocregion sync-test\n \n@@ -69,17 +77,20 @@ describe('TwainComponent', () => {\n     // #docregion error-test\n     it('should display error when TwainService fails', fakeAsync(() => {\n          // tell spy to return an error observable\n-         getQuoteSpy.and.returnValue(throwError('TwainService test failure'));\n-\n+         getQuoteSpy.and.returnValue(throwError(() => new Error('TwainService test failure')));\n          fixture.detectChanges();  // onInit()\n          // sync spy errors immediately after init\n \n          tick();  // flush the component's setTimeout()\n \n          fixture.detectChanges();  // update errorMessage within setTimeout()\n \n-         expect(errorMessage()).toMatch(/test failure/, 'should display error');\n-         expect(quoteEl.textContent).toBe('...', 'should show placeholder');\n+         expect(errorMessage())\n+          .withContext('should display error')\n+          .toMatch(/test failure/, );\n+         expect(quoteEl.textContent)\n+          .withContext('should show placeholder')\n+          .toBe('...');\n        }));\n     // #enddocregion error-test\n   });\n@@ -93,42 +104,64 @@ describe('TwainComponent', () => {\n     });\n \n     it('should not show quote before OnInit', () => {\n-      expect(quoteEl.textContent).toBe('', 'nothing displayed');\n-      expect(errorMessage()).toBeNull('should not show error element');\n-      expect(getQuoteSpy.calls.any()).toBe(false, 'getQuote not yet called');\n+      expect(quoteEl.textContent)\n+        .withContext('nothing displayed')\n+        .toBe('');\n+      expect(errorMessage())\n+        .withContext('should not show error element')\n+        .toBeNull();\n+      expect(getQuoteSpy.calls.any())\n+        .withContext('getQuote not yet called')\n+        .toBe(false);\n     });\n \n     it('should still not show quote after component initialized', () => {\n       fixture.detectChanges();\n       // getQuote service is async => still has not returned with quote\n       // so should show the start value, '...'\n-      expect(quoteEl.textContent).toBe('...', 'should show placeholder');\n-      expect(errorMessage()).toBeNull('should not show error');\n-      expect(getQuoteSpy.calls.any()).toBe(true, 'getQuote called');\n+      expect(quoteEl.textContent)\n+        .withContext('should show placeholder')\n+        .toBe('...');\n+      expect(errorMessage())\n+        .withContext('should not show error')\n+        .toBeNull();\n+      expect(getQuoteSpy.calls.any())\n+        .withContext('getQuote called')\n+        .toBe(true);\n     });\n \n     // #docregion fake-async-test\n     it('should show quote after getQuote (fakeAsync)', fakeAsync(() => {\n          fixture.detectChanges();  // ngOnInit()\n-         expect(quoteEl.textContent).toBe('...', 'should show placeholder');\n+         expect(quoteEl.textContent)\n+          .withContext('should show placeholder')\n+          .toBe('...');\n \n          tick();                   // flush the observable to get the quote\n          fixture.detectChanges();  // update view\n \n-         expect(quoteEl.textContent).toBe(testQuote, 'should show quote');\n-         expect(errorMessage()).toBeNull('should not show error');\n+         expect(quoteEl.textContent)\n+          .withContext('should show quote')\n+          .toBe(testQuote);\n+         expect(errorMessage())\n+          .withContext('should not show error')\n+          .toBeNull();\n        }));\n     // #enddocregion fake-async-test\n \n     // #docregion waitForAsync-test\n     it('should show quote after getQuote (waitForAsync)', waitForAsync(() => {\n          fixture.detectChanges();  // ngOnInit()\n-         expect(quoteEl.textContent).toBe('...', 'should show placeholder');\n+         expect(quoteEl.textContent)\n+          .withContext('should show placeholder')\n+          .toBe('...');\n \n          fixture.whenStable().then(() => {  // wait for async getQuote\n            fixture.detectChanges();         // update view with quote\n            expect(quoteEl.textContent).toBe(testQuote);\n-           expect(errorMessage()).toBeNull('should not show error');\n+           expect(errorMessage())\n+            .withContext('should not show error')\n+            .toBeNull();\n          });\n        }));\n     // #enddocregion waitForAsync-test\n@@ -141,7 +174,9 @@ describe('TwainComponent', () => {\n       component.quote.pipe(last()).subscribe(() => {\n         fixture.detectChanges();  // update view with quote\n         expect(quoteEl.textContent).toBe(testQuote);\n-        expect(errorMessage()).toBeNull('should not show error');\n+        expect(errorMessage())\n+          .withContext('should not show error')\n+          .toBeNull();\n         done();\n       });\n     });\n@@ -155,7 +190,9 @@ describe('TwainComponent', () => {\n       getQuoteSpy.calls.mostRecent().returnValue.subscribe(() => {\n         fixture.detectChanges();  // update view with quote\n         expect(quoteEl.textContent).toBe(testQuote);\n-        expect(errorMessage()).toBeNull('should not show error');\n+        expect(errorMessage())\n+          .withContext('should not show error')\n+          .toBeNull();\n         done();\n       });\n     });\n@@ -169,8 +206,12 @@ describe('TwainComponent', () => {\n          tick();                   // component shows error after a setTimeout()\n          fixture.detectChanges();  // update error message\n \n-         expect(errorMessage()).toMatch(/test failure/, 'should display error');\n-         expect(quoteEl.textContent).toBe('...', 'should show placeholder');\n+         expect(errorMessage())\n+          .withContext('should display error')\n+          .toMatch(/test failure/);\n+         expect(quoteEl.textContent)\n+          .withContext('should show placeholder')\n+          .toBe('...');\n        }));\n   });\n });"
        },
        {
            "sha": "edfbc2c5700a0b244f30ea15e57c24281f3bdf8e",
            "filename": "aio/content/examples/testing/src/app/welcome/welcome.component.spec.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fwelcome%2Fwelcome.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6e0481572fee60ad9f822adf71ce50cba5a7f978/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fwelcome%2Fwelcome.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fwelcome%2Fwelcome.component.spec.ts?ref=6e0481572fee60ad9f822adf71ce50cba5a7f978",
            "patch": "@@ -105,8 +105,12 @@ describe('WelcomeComponent', () => {\n   it('should welcome the user', () => {\n     fixture.detectChanges();\n     const content = el.textContent;\n-    expect(content).toContain('Welcome', '\"Welcome ...\"');\n-    expect(content).toContain('Test User', 'expected name');\n+    expect(content)\n+      .withContext('\"Welcome ...\"')\n+      .toContain('Welcome');\n+    expect(content)\n+      .withContext('expected name')\n+      .toContain('Test User');\n   });\n \n   it('should welcome \"Bubba\"', () => {\n@@ -119,8 +123,12 @@ describe('WelcomeComponent', () => {\n     userService.isLoggedIn = false; // welcome message hasn't been shown yet\n     fixture.detectChanges();\n     const content = el.textContent;\n-    expect(content).not.toContain('Welcome', 'not welcomed');\n-    expect(content).toMatch(/log in/i, '\"log in\"');\n+    expect(content)\n+      .withContext('not welcomed')\n+      .not.toContain('Welcome');\n+    expect(content)\n+      .withContext('\"log in\"')\n+      .toMatch(/log in/i);\n   });\n   // #enddocregion tests\n "
        }
    ],
    "stats": {
        "total": 676,
        "additions": 468,
        "deletions": 208
    }
}