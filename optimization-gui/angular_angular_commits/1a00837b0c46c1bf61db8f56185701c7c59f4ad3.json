{
    "author": "AleksanderBodurri",
    "message": "perf(devtools): prevent highlighter from rebuilding the directive forest every time a node is hovered over in the directive forest",
    "sha": "1a00837b0c46c1bf61db8f56185701c7c59f4ad3",
    "files": [
        {
            "sha": "e7bf50098ae2a6340afe7d308a2f4690457207ce",
            "filename": "projects/ng-devtools-backend/src/lib/client-event-subscribers.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 13,
            "changes": 25,
            "blob_url": "https://github.com/angular/angular/blob/1a00837b0c46c1bf61db8f56185701c7c59f4ad3/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fclient-event-subscribers.ts",
            "raw_url": "https://github.com/angular/angular/raw/1a00837b0c46c1bf61db8f56185701c7c59f4ad3/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fclient-event-subscribers.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fclient-event-subscribers.ts?ref=1a00837b0c46c1bf61db8f56185701c7c59f4ad3",
            "patch": "@@ -12,7 +12,7 @@ import {\n import { ComponentTreeNode, getLatestComponentState, queryDirectiveForest, updateState } from './component-tree';\n import { start as startProfiling, stop as stopProfiling } from './hooks/capture';\n import { serializeDirectiveState } from './state-serializer/state-serializer';\n-import { ComponentInspector, ComponentInspectorOptions } from './component-inspector/component-inspector';\n+import { ComponentInspector } from './component-inspector/component-inspector';\n import { setConsoleReference } from './set-console-reference';\n import { unHighlight } from './highlighter';\n import {\n@@ -146,18 +146,17 @@ const checkForAngular = (messageBus: MessageBus<Events>, attempt = 0): void => {\n };\n \n const setupInspector = (messageBus: MessageBus<Events>) => {\n-  const onComponentEnter = (id: number) => {\n-    messageBus.emit('highlightComponent', [id]);\n-  };\n-  const onComponentLeave = () => {\n-    messageBus.emit('removeComponentHighlight');\n-  };\n-  const onComponentSelect = (id: number) => {\n-    messageBus.emit('selectComponent', [id]);\n-  };\n-\n-  const inspectorOptions: ComponentInspectorOptions = { onComponentEnter, onComponentLeave, onComponentSelect };\n-  const inspector = new ComponentInspector(inspectorOptions);\n+  const inspector = new ComponentInspector({\n+    onComponentEnter: (id: number) => {\n+      messageBus.emit('highlightComponent', [id]);\n+    },\n+    onComponentLeave: () => {\n+      messageBus.emit('removeComponentHighlight');\n+    },\n+    onComponentSelect: (id: number) => {\n+      messageBus.emit('selectComponent', [id]);\n+    },\n+  });\n \n   messageBus.on('inspectorStart', inspector.startInspecting);\n   messageBus.on('inspectorEnd', inspector.stopInspecting);"
        },
        {
            "sha": "2f17ca9b040b322e6eb2f8dccad8a3a7c43d1f29",
            "filename": "projects/ng-devtools-backend/src/lib/component-inspector/component-inspector.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/1a00837b0c46c1bf61db8f56185701c7c59f4ad3/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fcomponent-inspector%2Fcomponent-inspector.ts",
            "raw_url": "https://github.com/angular/angular/raw/1a00837b0c46c1bf61db8f56185701c7c59f4ad3/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fcomponent-inspector%2Fcomponent-inspector.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fcomponent-inspector%2Fcomponent-inspector.ts?ref=1a00837b0c46c1bf61db8f56185701c7c59f4ad3",
            "patch": "@@ -1,6 +1,6 @@\n import { unHighlight, highlight, findComponentAndHost } from '../highlighter';\n import { Type } from '@angular/core';\n-import { buildDirectiveForest, ComponentTreeNode, findNodeInForest } from '../component-tree';\n+import { ComponentTreeNode, findNodeInForest } from '../component-tree';\n import { ElementPosition } from 'protocol';\n import { initializeOrGetDirectiveForestHooks } from '../hooks';\n \n@@ -80,7 +80,7 @@ export class ComponentInspector {\n   }\n \n   highlightByPosition(position: ElementPosition): void {\n-    const forest: ComponentTreeNode[] = buildDirectiveForest();\n+    const forest: ComponentTreeNode[] = initializeOrGetDirectiveForestHooks().getDirectiveForest();\n     const elementToHighlight: HTMLElement | null = findNodeInForest(position, forest);\n     if (elementToHighlight) {\n       highlight(elementToHighlight);"
        }
    ],
    "stats": {
        "total": 29,
        "additions": 14,
        "deletions": 15
    }
}