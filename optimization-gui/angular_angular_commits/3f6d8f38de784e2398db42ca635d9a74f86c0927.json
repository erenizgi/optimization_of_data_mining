{
    "author": "AndrewKushnir",
    "message": "refactor(forms): minor refactoring of `SelectMultipleControlValueAccessor` (#44261)\n\nThis commit updates the code of the `SelectMultipleControlValueAccessor` to:\n- improve typings to make them more precise\n- updates the note that refers to IE, but we still can not remove the branch since it's needed for Universal (that uses Domino)\n\nPR Close #44261",
    "sha": "3f6d8f38de784e2398db42ca635d9a74f86c0927",
    "files": [
        {
            "sha": "6d05a21bac85062e446ba57834a5085ef54871a0",
            "filename": "packages/forms/src/directives/select_multiple_control_value_accessor.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 9,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/3f6d8f38de784e2398db42ca635d9a74f86c0927/packages%2Fforms%2Fsrc%2Fdirectives%2Fselect_multiple_control_value_accessor.ts",
            "raw_url": "https://github.com/angular/angular/raw/3f6d8f38de784e2398db42ca635d9a74f86c0927/packages%2Fforms%2Fsrc%2Fdirectives%2Fselect_multiple_control_value_accessor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fdirectives%2Fselect_multiple_control_value_accessor.ts?ref=3f6d8f38de784e2398db42ca635d9a74f86c0927",
            "patch": "@@ -137,23 +137,26 @@ export class SelectMultipleControlValueAccessor extends BuiltInControlValueAcces\n    * @nodoc\n    */\n   override registerOnChange(fn: (value: any) => any): void {\n-    this.onChange = (_: any) => {\n+    this.onChange = (element: HTMLSelectElement) => {\n       const selected: Array<any> = [];\n-      if (_.selectedOptions !== undefined) {\n-        const options: HTMLCollection = _.selectedOptions;\n+      const selectedOptions = element.selectedOptions;\n+      if (selectedOptions !== undefined) {\n+        const options = selectedOptions;\n         for (let i = 0; i < options.length; i++) {\n-          const opt: any = options.item(i);\n-          const val: any = this._getOptionValue(opt.value);\n+          const opt = options[i];\n+          const val = this._getOptionValue(opt.value);\n           selected.push(val);\n         }\n       }\n-      // Degrade on IE\n+      // Degrade to use `options` when `selectedOptions` property is not available.\n+      // Note: the `selectedOptions` is available in all supported browsers, but the Domino lib\n+      // doesn't have it currently, see https://github.com/fgnass/domino/issues/177.\n       else {\n-        const options: HTMLCollection = <HTMLCollection>_.options;\n+        const options = element.options;\n         for (let i = 0; i < options.length; i++) {\n-          const opt: HTMLOption = options.item(i);\n+          const opt = options[i];\n           if (opt.selected) {\n-            const val: any = this._getOptionValue(opt.value);\n+            const val = this._getOptionValue(opt.value);\n             selected.push(val);\n           }\n         }"
        },
        {
            "sha": "3b905e7f04978be1258e6368d7b986ec52f5dee7",
            "filename": "packages/forms/test/value_accessor_integration_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/3f6d8f38de784e2398db42ca635d9a74f86c0927/packages%2Fforms%2Ftest%2Fvalue_accessor_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/3f6d8f38de784e2398db42ca635d9a74f86c0927/packages%2Fforms%2Ftest%2Fvalue_accessor_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Fvalue_accessor_integration_spec.ts?ref=3f6d8f38de784e2398db42ca635d9a74f86c0927",
            "patch": "@@ -508,7 +508,7 @@ import {dispatchEvent} from '@angular/platform-browser/testing/src/browser_util'\n \n              selectOptionViaUI('1: Object');\n              assertOptionElementSelectedState([false, true, false]);\n-             expect(spy.calls.count()).toBe(2);\n+             expect(spy).toHaveBeenCalled();\n            }));\n \n         it('should reflect state of model after option selected and new options subsequently added',"
        }
    ],
    "stats": {
        "total": 23,
        "additions": 13,
        "deletions": 10
    }
}