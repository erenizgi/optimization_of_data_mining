{
    "author": "alan-agius4",
    "message": "fix(compiler-cli): support reflecting namespace declarations (#42728)\n\nDTS bundling, will cause originally namespaced imports become namespace declarations within the same file. Example:\n\nBefore bundling\n```ts\nimport * as i1 from './router';\n\nexport declare class RouterModule {\n    constructor(guard: any, router: Router);\n\n    static ɵmod: i0.ɵɵNgModuleDeclaration<RouterModule, [typeof i1.RouterOutlet...]>;\n}\n```\n\nAfter bundling\n```\ndeclare namespace i1 {\n  export {\n    RouterOutletContract,\n    RouterOutlet\n  }\n}\n\nexport declare class RouterModule {\n    constructor(guard: any, router: Router);\n\n    static ɵmod: i0.ɵɵNgModuleDeclaration<RouterModule, [typeof i1.RouterOutlet...]>;\n}\n```\n\nAnd therefore this commit adds support for reflecting types that are defined in such namespace declarations.\n\nCloses #42064\n\nPR Close #42728",
    "sha": "4c78984ad26825851d78d6f0339d8e4cb7bf1e54",
    "files": [
        {
            "sha": "7c3ebc6e560462ebda9d6ec8490d528e1d45cb22",
            "filename": "packages/compiler-cli/src/ngtsc/reflection/src/typescript.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/4c78984ad26825851d78d6f0339d8e4cb7bf1e54/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Ftypescript.ts",
            "raw_url": "https://github.com/angular/angular/raw/4c78984ad26825851d78d6f0339d8e4cb7bf1e54/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Ftypescript.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Ftypescript.ts?ref=4c78984ad26825851d78d6f0339d8e4cb7bf1e54",
            "patch": "@@ -548,6 +548,8 @@ export function reflectTypeEntityToDeclaration(\n         throw new Error(`Module specifier is not a string`);\n       }\n       return {node, from: importDecl.moduleSpecifier.text};\n+    } else if (ts.isModuleDeclaration(decl)) {\n+      return {node, from: null};\n     } else {\n       throw new Error(`Unknown import type?`);\n     }"
        },
        {
            "sha": "fd5c7c7ffb1354bf8e8dda73e8d8339bad1184e6",
            "filename": "packages/compiler-cli/src/ngtsc/reflection/test/ts_host_spec.ts",
            "status": "modified",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/angular/angular/blob/4c78984ad26825851d78d6f0339d8e4cb7bf1e54/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Ftest%2Fts_host_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/4c78984ad26825851d78d6f0339d8e4cb7bf1e54/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Ftest%2Fts_host_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Ftest%2Fts_host_spec.ts?ref=4c78984ad26825851d78d6f0339d8e4cb7bf1e54",
            "patch": "@@ -153,6 +153,30 @@ runInEachFileSystem(() => {\n         expectParameter(args[0], 'bar', {moduleName: './bar', name: 'Bar'});\n       });\n \n+      it('should reflect an argument from a namespace declarations', () => {\n+        const {program} = makeProgram([{\n+          name: _('/entry.ts'),\n+          contents: `\n+            export declare class Bar {}\n+            declare namespace i1 {\n+              export {\n+                Bar,\n+              }\n+            }\n+\n+            class Foo {\n+              constructor(bar: i1.Bar) {}\n+            }\n+        `\n+        }]);\n+        const clazz = getDeclaration(program, _('/entry.ts'), 'Foo', isNamedClassDeclaration);\n+        const checker = program.getTypeChecker();\n+        const host = new TypeScriptReflectionHost(checker);\n+        const args = host.getConstructorParameters(clazz)!;\n+        expect(args.length).toBe(1);\n+        expectParameter(args[0], 'bar', 'i1.Bar');\n+      });\n+\n       it('should reflect an argument from a default import', () => {\n         const {program} = makeProgram([\n           {"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 26,
        "deletions": 0
    }
}