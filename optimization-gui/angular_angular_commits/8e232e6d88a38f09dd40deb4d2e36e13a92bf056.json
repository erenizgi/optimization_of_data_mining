{
    "author": "petebacondarwin",
    "message": "build(docs-infra): show a dist-tag when installing the CLI on non-stable versions (#41991)\n\nIt is important to use the correct major version of the Angular CLI when\nfollowing the examples in the tutorials. This commit provides a custom\nelement that renders an appropriate dist-tag in the setup step of\nthe tutorial when the docs are not in \"stable\" mode.\n\nFixes #39821\n\nPR Close #41991",
    "sha": "8e232e6d88a38f09dd40deb4d2e36e13a92bf056",
    "files": [
        {
            "sha": "799be7fda7b2694dbbaaf99fef16d2c6c1e85366",
            "filename": "aio/content/guide/setup-local.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fcontent%2Fguide%2Fsetup-local.md",
            "raw_url": "https://github.com/angular/angular/raw/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fcontent%2Fguide%2Fsetup-local.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fguide%2Fsetup-local.md?ref=8e232e6d88a38f09dd40deb4d2e36e13a92bf056",
            "patch": "@@ -59,7 +59,7 @@ You use the Angular CLI to create projects, generate application and library cod\n To install the Angular CLI, open a terminal window and run the following command:\n \n <code-example language=\"sh\">\n-  npm install -g @angular/cli\n+  npm install -g @angular/cli<aio-angular-dist-tag class=\"pln\"></aio-angular-dist-tag>\n </code-example>\n \n {@a create-proj}"
        },
        {
            "sha": "da0ad8012dde2b39e0bb94052ba2ae4ee87e7d56",
            "filename": "aio/src/app/custom-elements/dist-tag/dist-tag.component.spec.ts",
            "status": "added",
            "additions": 47,
            "deletions": 0,
            "changes": 47,
            "blob_url": "https://github.com/angular/angular/blob/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fsrc%2Fapp%2Fcustom-elements%2Fdist-tag%2Fdist-tag.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fsrc%2Fapp%2Fcustom-elements%2Fdist-tag%2Fdist-tag.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fcustom-elements%2Fdist-tag%2Fdist-tag.component.spec.ts?ref=8e232e6d88a38f09dd40deb4d2e36e13a92bf056",
            "patch": "@@ -0,0 +1,47 @@\n+import { VERSION } from '@angular/core';\n+import { TestBed } from '@angular/core/testing';\n+import { environment } from 'environments/environment';\n+import { DistTagComponent } from './dist-tag.component';\n+\n+describe('DistTagComponent', () => {\n+  let actualMode: string;\n+\n+  beforeEach(() => {\n+    TestBed.configureTestingModule({ declarations: [DistTagComponent] });\n+    actualMode = environment.mode;\n+  });\n+\n+  afterEach(() => {\n+    (environment.mode as any) = actualMode;\n+  });\n+\n+  describe('rendering', () => {\n+    it('should display nothing (for stable versions)', () => {\n+      environment.mode = 'stable';\n+      const fixture = TestBed.createComponent(DistTagComponent);\n+      fixture.detectChanges();\n+      expect(fixture.nativeElement.innerHTML).toEqual('');\n+    });\n+\n+    it('should display the current major version (for archive versions)', () => {\n+      environment.mode = 'archive';\n+      const fixture = TestBed.createComponent(DistTagComponent);\n+      fixture.detectChanges();\n+      expect(fixture.nativeElement.innerHTML).toEqual('@' + VERSION.major);\n+    });\n+\n+    it('should display \"@next\" (for rc versions)', () => {\n+      environment.mode = 'rc';\n+      const fixture = TestBed.createComponent(DistTagComponent);\n+      fixture.detectChanges();\n+      expect(fixture.nativeElement.innerHTML).toEqual('@next');\n+    });\n+\n+    it('should display \"@next\" (for next versions)', () => {\n+      environment.mode = 'next';\n+      const fixture = TestBed.createComponent(DistTagComponent);\n+      fixture.detectChanges();\n+      expect(fixture.nativeElement.innerHTML).toEqual('@next');\n+    });\n+  });\n+});"
        },
        {
            "sha": "143aad039fe9aff6bdbefdc4650ad58c213bc12b",
            "filename": "aio/src/app/custom-elements/dist-tag/dist-tag.component.ts",
            "status": "added",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/angular/angular/blob/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fsrc%2Fapp%2Fcustom-elements%2Fdist-tag%2Fdist-tag.component.ts",
            "raw_url": "https://github.com/angular/angular/raw/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fsrc%2Fapp%2Fcustom-elements%2Fdist-tag%2Fdist-tag.component.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fcustom-elements%2Fdist-tag%2Fdist-tag.component.ts?ref=8e232e6d88a38f09dd40deb4d2e36e13a92bf056",
            "patch": "@@ -0,0 +1,27 @@\n+import { Component, VERSION } from '@angular/core';\n+import { environment } from 'environments/environment';\n+\n+/**\n+ * Display the dist-tag of Angular for installing from npm at the point these docs are generated.\n+ */\n+@Component({\n+  selector: 'aio-angular-dist-tag',\n+  template: '{{tag}}',\n+})\n+export class DistTagComponent {\n+  tag: string;\n+\n+  constructor() {\n+    switch (environment.mode) {\n+      case 'stable':\n+        this.tag = '';\n+        break;\n+      case 'next':\n+      case 'rc':\n+        this.tag = '@next';\n+        break;\n+      default:\n+        this.tag = `@${VERSION.major}`;\n+    }\n+  }\n+}"
        },
        {
            "sha": "e945dbfcfe1d48d1afa2f675b777f7d9702bb3ce",
            "filename": "aio/src/app/custom-elements/dist-tag/dist-tag.module.ts",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fsrc%2Fapp%2Fcustom-elements%2Fdist-tag%2Fdist-tag.module.ts",
            "raw_url": "https://github.com/angular/angular/raw/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fsrc%2Fapp%2Fcustom-elements%2Fdist-tag%2Fdist-tag.module.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fcustom-elements%2Fdist-tag%2Fdist-tag.module.ts?ref=8e232e6d88a38f09dd40deb4d2e36e13a92bf056",
            "patch": "@@ -0,0 +1,12 @@\n+import { NgModule, Type } from '@angular/core';\n+import { WithCustomElementComponent } from '../element-registry';\n+\n+import { DistTagComponent } from './dist-tag.component';\n+\n+@NgModule({\n+  declarations: [ DistTagComponent ],\n+  entryComponents: [ DistTagComponent ],\n+})\n+export class DistTagModule implements WithCustomElementComponent {\n+  customElementComponent: Type<any> = DistTagComponent;\n+}"
        },
        {
            "sha": "776a60d1653acc7a58c5b35785581b36630c5d64",
            "filename": "aio/src/app/custom-elements/element-registry.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fsrc%2Fapp%2Fcustom-elements%2Felement-registry.ts",
            "raw_url": "https://github.com/angular/angular/raw/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/aio%2Fsrc%2Fapp%2Fcustom-elements%2Felement-registry.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fcustom-elements%2Felement-registry.ts?ref=8e232e6d88a38f09dd40deb4d2e36e13a92bf056",
            "patch": "@@ -21,6 +21,10 @@ export const ELEMENT_MODULE_LOAD_CALLBACKS_AS_ROUTES = [\n     selector: 'aio-file-not-found-search',\n     loadChildren: () => import('./search/file-not-found-search.module').then(m => m.FileNotFoundSearchModule)\n   },\n+  {\n+    selector: 'aio-angular-dist-tag',\n+    loadChildren: () => import('./dist-tag/dist-tag.module').then(m => m.DistTagModule)\n+  },\n   {\n     selector: 'aio-resource-list',\n     loadChildren: () => import('./resource/resource-list.module').then(m => m.ResourceListModule)"
        },
        {
            "sha": "f98024bf2144c3ade1da8f6ea34d54220dac7528",
            "filename": "goldens/size-tracking/aio-payloads.json",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/goldens%2Fsize-tracking%2Faio-payloads.json",
            "raw_url": "https://github.com/angular/angular/raw/8e232e6d88a38f09dd40deb4d2e36e13a92bf056/goldens%2Fsize-tracking%2Faio-payloads.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fsize-tracking%2Faio-payloads.json?ref=8e232e6d88a38f09dd40deb4d2e36e13a92bf056",
            "patch": "@@ -2,18 +2,18 @@\n   \"aio\": {\n     \"master\": {\n       \"uncompressed\": {\n-        \"runtime-es2015\": 4444,\n-        \"main-es2015\": 451200,\n-        \"polyfills-es2015\": 55283\n+        \"runtime-es2015\": 4538,\n+        \"main-es2015\": 451314,\n+        \"polyfills-es2015\": 55210\n       }\n     }\n   },\n   \"aio-local\": {\n     \"master\": {\n       \"uncompressed\": {\n-        \"runtime-es2015\": 4444,\n-        \"main-es2015\": 451200,\n-        \"polyfills-es2015\": 55283\n+        \"runtime-es2015\": 4538,\n+        \"main-es2015\": 451493,\n+        \"polyfills-es2015\": 55291\n       }\n     }\n   }"
        }
    ],
    "stats": {
        "total": 104,
        "additions": 97,
        "deletions": 7
    }
}