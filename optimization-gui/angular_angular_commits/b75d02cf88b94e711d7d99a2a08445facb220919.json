{
    "author": "profanis",
    "message": "docs: describe how to run tests in GitLab CI (#40411)\n\nThe documentation has a very useful configuration for Travis and CircleCI but not for GitLab CI.\nSo, I thought that might be useful to have that as well.\n\nPR Close #40411",
    "sha": "b75d02cf88b94e711d7d99a2a08445facb220919",
    "files": [
        {
            "sha": "5dfdc04ab7f7b8af6008413c851b1e60ae3d64b3",
            "filename": "aio/content/guide/testing.md",
            "status": "modified",
            "additions": 53,
            "deletions": 0,
            "changes": 53,
            "blob_url": "https://github.com/angular/angular/blob/b75d02cf88b94e711d7d99a2a08445facb220919/aio%2Fcontent%2Fguide%2Ftesting.md",
            "raw_url": "https://github.com/angular/angular/raw/b75d02cf88b94e711d7d99a2a08445facb220919/aio%2Fcontent%2Fguide%2Ftesting.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fguide%2Ftesting.md?ref=b75d02cf88b94e711d7d99a2a08445facb220919",
            "patch": "@@ -219,6 +219,59 @@ You'll need to push a new commit to trigger a build.\n \n * Learn more about Travis CI testing from [Travis CI documentation](https://docs.travis-ci.com/).\n \n+### Configure project for GitLab CI\n+\n+Step 1: Create a file called `.gitlab-ci.yml` at the project root, with the following content:\n+\n+```\n+image: node:14.15-stretch\n+variables:\n+  FF_USE_FASTZIP: \"true\"\n+\n+cache:\n+  untracked: true\n+  policy: push\n+  key: ${CI_COMMIT_SHORT_SHA}\n+  paths:\n+    - node_modules/\n+\n+.pull_cached_node_modules:\n+  cache:\n+    untracked: true\n+    key: ${CI_COMMIT_SHORT_SHA}\n+    policy: pull\n+\n+stages:\n+  - setup\n+  - test\n+\n+install:\n+  stage: setup\n+  script:\n+    - npm ci\n+\n+test:\n+  stage: test\n+  extends: .pull_cached_node_modules\n+  before_script:\n+    - apt-get update\n+    - wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb\n+    - apt install -y ./google-chrome*.deb;\n+    - export CHROME_BIN=/usr/bin/google-chrome\n+  script:\n+    - npm run test -- --no-watch --no-progress --browsers=ChromeHeadlessCI\n+    - npm run e2e -- --protractor-config=e2e/protractor-ci.conf.js\n+```\n+\n+This configuration caches `node_modules/` in the `install` job and re-uses the cached `node_modules/` in the `test` job.\n+\n+Step 2: [Sign up for GitLab CI](https://gitlab.com/users/sign_in) and [add your project](https://gitlab.com/projects/new).\n+You'll need to push a new commit to trigger a build.\n+\n+Step 3: Commit your changes and push them to your repository.\n+\n+* Learn more about GitLab CI testing from [GitLab CI/CD documentation](https://docs.gitlab.com/ee/ci/).\n+\n ### Configure CLI for CI testing in Chrome\n \n When the CLI commands `ng test` and `ng e2e` are generally running the CI tests in your environment, you might still need to adjust your configuration to run the Chrome browser tests."
        }
    ],
    "stats": {
        "total": 53,
        "additions": 53,
        "deletions": 0
    }
}