{
    "author": "bjarkler",
    "message": "fix(core): mark Trusted Types as declarations (#39471)\n\nAngular-internal type definitions for Trusted Types were added in #39211.\nWhen compiled using the Closure compiler with certain optimization\nflags, identifiers from these type definitions (such as createPolicy)\nare currently uglified and renamed to shorter strings. This causes\nAngular applications compiled in this way to fail to create a Trusted\nTypes policy, and fall bock to using strings.\n\nTo fix this, mark the internal Trusted Types definitions as declarations\nusing the \"declare\" keyword. Also convert types to interfaces, for\nthe reasons explained in https://ncjamieson.com/prefer-interfaces/\n\nPR Close #39471",
    "sha": "f54662e93164ffb14cb0ba98dea5887b40fde8da",
    "files": [
        {
            "sha": "8d831e592a86d8bff36bb2b22a066d30a786a87f",
            "filename": "packages/compiler/src/output/output_jit_trusted_types.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 6,
            "changes": 13,
            "blob_url": "https://github.com/angular/angular/blob/f54662e93164ffb14cb0ba98dea5887b40fde8da/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_jit_trusted_types.ts",
            "raw_url": "https://github.com/angular/angular/raw/f54662e93164ffb14cb0ba98dea5887b40fde8da/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_jit_trusted_types.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_jit_trusted_types.ts?ref=f54662e93164ffb14cb0ba98dea5887b40fde8da",
            "patch": "@@ -28,24 +28,25 @@ import {global} from '../util';\n  * will keep Angular's public API surface free of references to Trusted Types.\n  * For internal and semi-private APIs that need to reference Trusted Types, the\n  * minimal type definitions for the Trusted Types API provided by this module\n- * should be used instead.\n+ * should be used instead. They are marked as \"declare\" to prevent them from\n+ * being renamed by compiler optimization.\n  *\n  * Adapted from\n  * https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/trusted-types/index.d.ts\n  * but restricted to the API surface used within Angular.\n  */\n \n-export type TrustedScript = {\n-  __brand__: 'TrustedScript'\n-};\n+export declare interface TrustedScript {\n+  __brand__: 'TrustedScript';\n+}\n \n-export interface TrustedTypePolicyFactory {\n+export declare interface TrustedTypePolicyFactory {\n   createPolicy(policyName: string, policyOptions: {\n     createScript?: (input: string) => string,\n   }): TrustedTypePolicy;\n }\n \n-export interface TrustedTypePolicy {\n+export declare interface TrustedTypePolicy {\n   createScript(input: string): TrustedScript;\n }\n "
        },
        {
            "sha": "c3ac5a2004219bef1526f67c3978bf5fffe7105e",
            "filename": "packages/core/src/util/security/trusted_type_defs.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 12,
            "changes": 25,
            "blob_url": "https://github.com/angular/angular/blob/f54662e93164ffb14cb0ba98dea5887b40fde8da/packages%2Fcore%2Fsrc%2Futil%2Fsecurity%2Ftrusted_type_defs.ts",
            "raw_url": "https://github.com/angular/angular/raw/f54662e93164ffb14cb0ba98dea5887b40fde8da/packages%2Fcore%2Fsrc%2Futil%2Fsecurity%2Ftrusted_type_defs.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Futil%2Fsecurity%2Ftrusted_type_defs.ts?ref=f54662e93164ffb14cb0ba98dea5887b40fde8da",
            "patch": "@@ -17,24 +17,25 @@\n  * will keep Angular's public API surface free of references to Trusted Types.\n  * For internal and semi-private APIs that need to reference Trusted Types, the\n  * minimal type definitions for the Trusted Types API provided by this module\n- * should be used instead.\n+ * should be used instead. They are marked as \"declare\" to prevent them from\n+ * being renamed by compiler optimization.\n  *\n  * Adapted from\n  * https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/trusted-types/index.d.ts\n  * but restricted to the API surface used within Angular.\n  */\n \n-export type TrustedHTML = {\n-  __brand__: 'TrustedHTML'\n-};\n-export type TrustedScript = {\n-  __brand__: 'TrustedScript'\n-};\n-export type TrustedScriptURL = {\n-  __brand__: 'TrustedScriptURL'\n-};\n+export declare interface TrustedHTML {\n+  __brand__: 'TrustedHTML';\n+}\n+export declare interface TrustedScript {\n+  __brand__: 'TrustedScript';\n+}\n+export declare interface TrustedScriptURL {\n+  __brand__: 'TrustedScriptURL';\n+}\n \n-export interface TrustedTypePolicyFactory {\n+export declare interface TrustedTypePolicyFactory {\n   createPolicy(policyName: string, policyOptions: {\n     createHTML?: (input: string) => string,\n     createScript?: (input: string) => string,\n@@ -43,7 +44,7 @@ export interface TrustedTypePolicyFactory {\n   getAttributeType(tagName: string, attribute: string): string|null;\n }\n \n-export interface TrustedTypePolicy {\n+export declare interface TrustedTypePolicy {\n   createHTML(input: string): TrustedHTML;\n   createScript(input: string): TrustedScript;\n   createScriptURL(input: string): TrustedScriptURL;"
        }
    ],
    "stats": {
        "total": 38,
        "additions": 20,
        "deletions": 18
    }
}