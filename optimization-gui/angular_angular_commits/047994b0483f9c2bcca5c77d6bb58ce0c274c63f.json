{
    "author": "devversion",
    "message": "feat(dev-infra): introduce release action for directly branching-off into RC (#42973)\n\nIntroduces a new release action for cutting a release-action by directly\nmoving the next release-train into the `release-candidate` phase.\n\nThis allows the Angular team to release minor versions without\nneeding to branch-off first into the feature-freeze phase. For\nminors this phase can be skipped. Switching into the feature-freeze\nphase beforehand as a workaround would have allowed for branching-off\nbut has the downside that `target: minor` would no longer point to the\nbranched-off release train (only `target: rc` would work then).\n\nPR Close #42973",
    "sha": "047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
    "files": [
        {
            "sha": "52f3604c3e6d4270e8cea2c483d58b49b64c717a",
            "filename": "dev-infra/ng-dev.js",
            "status": "modified",
            "additions": 76,
            "deletions": 19,
            "changes": 95,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -7094,7 +7094,7 @@ class CutNextPrereleaseAction extends ReleaseAction {\n  * Cuts the first release candidate for a release-train currently in the\n  * feature-freeze phase. The version is bumped from `next` to `rc.0`.\n  */\n-class CutReleaseCandidateAction extends ReleaseAction {\n+class CutReleaseCandidateForFeatureFreezeAction extends ReleaseAction {\n     constructor() {\n         super(...arguments);\n         this._newVersion = semverInc(this.active.releaseCandidate.version, 'prerelease', 'rc');\n@@ -7208,27 +7208,23 @@ class CutStableAction extends ReleaseAction {\n  * found in the LICENSE file at https://angular.io/license\n  */\n /**\n- * Release action that moves the next release-train into the feature-freeze phase. This means\n- * that a new version branch is created from the next branch, and a new next pre-release is\n- * cut indicating the started feature-freeze.\n+ * Base action that can be used to move the next release-train into the feature-freeze or\n+ * release-candidate phase. This means that a new version branch is created from the next\n+ * branch, and a new pre-release (either RC or another `next`) is cut indicating the new phase.\n  */\n-class MoveNextIntoFeatureFreezeAction extends ReleaseAction {\n-    constructor() {\n-        super(...arguments);\n-        this._newVersion = computeNewPrereleaseVersionForNext(this.active, this.config);\n-    }\n+class BranchOffNextBranchBaseAction extends ReleaseAction {\n     getDescription() {\n         return tslib.__awaiter(this, void 0, void 0, function* () {\n             const { branchName } = this.active.next;\n-            const newVersion = yield this._newVersion;\n-            return `Move the \"${branchName}\" branch into feature-freeze phase (v${newVersion}).`;\n+            const newVersion = yield this._computeNewVersion();\n+            return `Move the \"${branchName}\" branch into ${this.newPhaseName} phase (v${newVersion}).`;\n         });\n     }\n     perform() {\n         return tslib.__awaiter(this, void 0, void 0, function* () {\n-            const newVersion = yield this._newVersion;\n+            const newVersion = yield this._computeNewVersion();\n             const newBranch = `${newVersion.major}.${newVersion.minor}.x`;\n-            // Branch-off the next branch into a feature-freeze branch.\n+            // Branch-off the next branch into a new version branch.\n             yield this._createNewVersionBranchFromNext(newBranch);\n             // Stage the new version for the newly created branch, and push changes to a\n             // fork in order to create a staging pull request. Note that we re-use the newly\n@@ -7242,6 +7238,17 @@ class MoveNextIntoFeatureFreezeAction extends ReleaseAction {\n             yield this._createNextBranchUpdatePullRequest(releaseNotes, newVersion);\n         });\n     }\n+    /** Computes the new version for the release-train being branched-off. */\n+    _computeNewVersion() {\n+        return tslib.__awaiter(this, void 0, void 0, function* () {\n+            if (this.newPhaseName === 'feature-freeze') {\n+                return computeNewPrereleaseVersionForNext(this.active, this.config);\n+            }\n+            else {\n+                return semverInc(this.active.next.version, 'prerelease', 'rc');\n+            }\n+        });\n+    }\n     /** Creates a new version branch from the next branch. */\n     _createNewVersionBranchFromNext(newBranch) {\n         return tslib.__awaiter(this, void 0, void 0, function* () {\n@@ -7255,7 +7262,8 @@ class MoveNextIntoFeatureFreezeAction extends ReleaseAction {\n     }\n     /**\n      * Creates a pull request for the next branch that bumps the version to the next\n-     * minor, and cherry-picks the changelog for the newly branched-off feature-freeze version.\n+     * minor, and cherry-picks the changelog for the newly branched-off release-candidate\n+     * or feature-freeze version.\n      */\n     _createNextBranchUpdatePullRequest(releaseNotes, newVersion) {\n         return tslib.__awaiter(this, void 0, void 0, function* () {\n@@ -7273,19 +7281,67 @@ class MoveNextIntoFeatureFreezeAction extends ReleaseAction {\n             const commitMessage = getReleaseNoteCherryPickCommitMessage(releaseNotes.version);\n             yield this.createCommit(commitMessage, [changelogPath]);\n             let nextPullRequestMessage = `The previous \"next\" release-train has moved into the ` +\n-                `release-candidate phase. This PR updates the next branch to the subsequent ` +\n+                `${this.newPhaseName} phase. This PR updates the next branch to the subsequent ` +\n                 `release-train.\\n\\nAlso this PR cherry-picks the changelog for ` +\n                 `v${newVersion} into the ${nextBranch} branch so that the changelog is up to date.`;\n             const nextUpdatePullRequest = yield this.pushChangesToForkAndCreatePullRequest(nextBranch, `next-release-train-${newNextVersion}`, `Update next branch to reflect new release-train \"v${newNextVersion}\".`, nextPullRequestMessage);\n             info(green(`  ✓   Pull request for updating the \"${nextBranch}\" branch has been created.`));\n             info(yellow(`      Please ask team members to review: ${nextUpdatePullRequest.url}.`));\n         });\n     }\n+}\n+\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+/**\n+ * Release action that moves the next release-train into the feature-freeze phase. This means\n+ * that a new version branch is created from the next branch, and a new next pre-release is\n+ * cut indicating the started feature-freeze.\n+ */\n+class MoveNextIntoFeatureFreezeAction extends BranchOffNextBranchBaseAction {\n+    constructor() {\n+        super(...arguments);\n+        this.newPhaseName = 'feature-freeze';\n+    }\n+    static isActive(active) {\n+        return tslib.__awaiter(this, void 0, void 0, function* () {\n+            // A new feature-freeze branch can only be created if there is no active\n+            // release-train in feature-freeze/release-candidate phase and the version\n+            // currently in the `next` branch is for a major. The feature-freeze phase\n+            // is not foreseen for minor versions.\n+            return active.releaseCandidate === null && active.next.isMajor;\n+        });\n+    }\n+}\n+\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+/**\n+ * Release action that moves the next release-train into the release-candidate phase. This means\n+ * that a new version branch is created from the next branch, and the first release candidate\n+ * version is cut indicating the new phase.\n+ */\n+class MoveNextIntoReleaseCandidateAction extends BranchOffNextBranchBaseAction {\n+    constructor() {\n+        super(...arguments);\n+        this.newPhaseName = 'release-candidate';\n+    }\n     static isActive(active) {\n         return tslib.__awaiter(this, void 0, void 0, function* () {\n-            // A new feature-freeze/release-candidate branch can only be created if there\n-            // is no active release-train in feature-freeze/release-candidate phase.\n-            return active.releaseCandidate === null;\n+            // Directly switching a next release-train into the `release-candidate`\n+            // phase is only allowed for minor releases. Major version always need to\n+            // go through the `feature-freeze` phase.\n+            return active.releaseCandidate === null && !active.next.isMajor;\n         });\n     }\n }\n@@ -7352,10 +7408,11 @@ class TagRecentMajorAsLatest extends ReleaseAction {\n const actions = [\n     TagRecentMajorAsLatest,\n     CutStableAction,\n-    CutReleaseCandidateAction,\n+    CutReleaseCandidateForFeatureFreezeAction,\n     CutNewPatchAction,\n     CutNextPrereleaseAction,\n     MoveNextIntoFeatureFreezeAction,\n+    MoveNextIntoReleaseCandidateAction,\n     CutLongTermSupportPatchAction,\n ];\n "
        },
        {
            "sha": "5b64b3a6e1dd43d77a5d8224e757b52f6481f4c1",
            "filename": "dev-infra/release/publish/actions/branch-off-next-branch.ts",
            "status": "added",
            "additions": 120,
            "deletions": 0,
            "changes": 120,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Fbranch-off-next-branch.ts",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Fbranch-off-next-branch.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Factions%2Fbranch-off-next-branch.ts?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -0,0 +1,120 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+import * as semver from 'semver';\n+\n+import {green, info, yellow} from '../../../utils/console';\n+import {semverInc} from '../../../utils/semver';\n+import {ReleaseNotes} from '../../notes/release-notes';\n+import {ActiveReleaseTrains} from '../../versioning/active-release-trains';\n+import {computeNewPrereleaseVersionForNext} from '../../versioning/next-prerelease-version';\n+import {ReleaseAction} from '../actions';\n+import {getCommitMessageForExceptionalNextVersionBump, getReleaseNoteCherryPickCommitMessage} from '../commit-message';\n+import {changelogPath, packageJsonPath} from '../constants';\n+\n+/**\n+ * Base action that can be used to move the next release-train into the feature-freeze or\n+ * release-candidate phase. This means that a new version branch is created from the next\n+ * branch, and a new pre-release (either RC or another `next`) is cut indicating the new phase.\n+ */\n+export abstract class BranchOffNextBranchBaseAction extends ReleaseAction {\n+  /**\n+   * Phase which the release-train currently in the `next` phase will move into.\n+   *\n+   * Note that we only allow for a next version to branch into feature-freeze or\n+   * directly into the release-candidate phase. A stable version cannot be released\n+   * without release-candidate.\n+   */\n+  abstract newPhaseName: 'feature-freeze'|'release-candidate';\n+\n+  override async getDescription() {\n+    const {branchName} = this.active.next;\n+    const newVersion = await this._computeNewVersion();\n+    return `Move the \"${branchName}\" branch into ${this.newPhaseName} phase (v${newVersion}).`;\n+  }\n+\n+  override async perform() {\n+    const newVersion = await this._computeNewVersion();\n+    const newBranch = `${newVersion.major}.${newVersion.minor}.x`;\n+\n+    // Branch-off the next branch into a new version branch.\n+    await this._createNewVersionBranchFromNext(newBranch);\n+\n+    // Stage the new version for the newly created branch, and push changes to a\n+    // fork in order to create a staging pull request. Note that we re-use the newly\n+    // created branch instead of re-fetching from the upstream.\n+    const {pullRequest, releaseNotes} =\n+        await this.stageVersionForBranchAndCreatePullRequest(newVersion, newBranch);\n+\n+    // Wait for the staging PR to be merged. Then build and publish the feature-freeze next\n+    // pre-release. Finally, cherry-pick the release notes into the next branch in combination\n+    // with bumping the version to the next minor too.\n+    await this.waitForPullRequestToBeMerged(pullRequest);\n+    await this.buildAndPublish(releaseNotes, newBranch, 'next');\n+    await this._createNextBranchUpdatePullRequest(releaseNotes, newVersion);\n+  }\n+\n+  /** Computes the new version for the release-train being branched-off. */\n+  private async _computeNewVersion() {\n+    if (this.newPhaseName === 'feature-freeze') {\n+      return computeNewPrereleaseVersionForNext(this.active, this.config);\n+    } else {\n+      return semverInc(this.active.next.version, 'prerelease', 'rc');\n+    }\n+  }\n+\n+  /** Creates a new version branch from the next branch. */\n+  private async _createNewVersionBranchFromNext(newBranch: string) {\n+    const {branchName: nextBranch} = this.active.next;\n+    await this.verifyPassingGithubStatus(nextBranch);\n+    await this.checkoutUpstreamBranch(nextBranch);\n+    await this.createLocalBranchFromHead(newBranch);\n+    await this.pushHeadToRemoteBranch(newBranch);\n+    info(green(`  ✓   Version branch \"${newBranch}\" created.`));\n+  }\n+\n+  /**\n+   * Creates a pull request for the next branch that bumps the version to the next\n+   * minor, and cherry-picks the changelog for the newly branched-off release-candidate\n+   * or feature-freeze version.\n+   */\n+  private async _createNextBranchUpdatePullRequest(\n+      releaseNotes: ReleaseNotes, newVersion: semver.SemVer) {\n+    const {branchName: nextBranch, version} = this.active.next;\n+    // We increase the version for the next branch to the next minor. The team can decide\n+    // later if they want next to be a major through the `Configure Next as Major` release action.\n+    const newNextVersion = semver.parse(`${version.major}.${version.minor + 1}.0-next.0`)!;\n+    const bumpCommitMessage = getCommitMessageForExceptionalNextVersionBump(newNextVersion);\n+\n+    await this.checkoutUpstreamBranch(nextBranch);\n+    await this.updateProjectVersion(newNextVersion);\n+\n+    // Create an individual commit for the next version bump. The changelog should go into\n+    // a separate commit that makes it clear where the changelog is cherry-picked from.\n+    await this.createCommit(bumpCommitMessage, [packageJsonPath]);\n+\n+    await this.prependReleaseNotesToChangelog(releaseNotes);\n+\n+    const commitMessage = getReleaseNoteCherryPickCommitMessage(releaseNotes.version);\n+\n+    await this.createCommit(commitMessage, [changelogPath]);\n+\n+    let nextPullRequestMessage = `The previous \"next\" release-train has moved into the ` +\n+        `${this.newPhaseName} phase. This PR updates the next branch to the subsequent ` +\n+        `release-train.\\n\\nAlso this PR cherry-picks the changelog for ` +\n+        `v${newVersion} into the ${nextBranch} branch so that the changelog is up to date.`;\n+\n+    const nextUpdatePullRequest = await this.pushChangesToForkAndCreatePullRequest(\n+        nextBranch, `next-release-train-${newNextVersion}`,\n+        `Update next branch to reflect new release-train \"v${newNextVersion}\".`,\n+        nextPullRequestMessage);\n+\n+    info(green(`  ✓   Pull request for updating the \"${nextBranch}\" branch has been created.`));\n+    info(yellow(`      Please ask team members to review: ${nextUpdatePullRequest.url}.`));\n+  }\n+}"
        },
        {
            "sha": "bf3d8e6c8aa4d3d8531f23124e5578ee3bfbd71e",
            "filename": "dev-infra/release/publish/actions/cut-release-candidate-for-feature-freeze.ts",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Fcut-release-candidate-for-feature-freeze.ts",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Fcut-release-candidate-for-feature-freeze.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Factions%2Fcut-release-candidate-for-feature-freeze.ts?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -14,7 +14,7 @@ import {ReleaseAction} from '../actions';\n  * Cuts the first release candidate for a release-train currently in the\n  * feature-freeze phase. The version is bumped from `next` to `rc.0`.\n  */\n-export class CutReleaseCandidateAction extends ReleaseAction {\n+export class CutReleaseCandidateForFeatureFreezeAction extends ReleaseAction {\n   private _newVersion = semverInc(this.active.releaseCandidate!.version, 'prerelease', 'rc');\n \n   override async getDescription() {",
            "previous_filename": "dev-infra/release/publish/actions/cut-release-candidate.ts"
        },
        {
            "sha": "d3f7558591e7dffb5a0a862a87b54b3452409e7e",
            "filename": "dev-infra/release/publish/actions/index.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Factions%2Findex.ts?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -11,9 +11,10 @@ import {ReleaseActionConstructor} from '../actions';\n import {CutLongTermSupportPatchAction} from './cut-lts-patch';\n import {CutNewPatchAction} from './cut-new-patch';\n import {CutNextPrereleaseAction} from './cut-next-prerelease';\n-import {CutReleaseCandidateAction} from './cut-release-candidate';\n+import {CutReleaseCandidateForFeatureFreezeAction} from './cut-release-candidate-for-feature-freeze';\n import {CutStableAction} from './cut-stable';\n import {MoveNextIntoFeatureFreezeAction} from './move-next-into-feature-freeze';\n+import {MoveNextIntoReleaseCandidateAction} from './move-next-into-release-candidate';\n import {TagRecentMajorAsLatest} from './tag-recent-major-as-latest';\n \n /**\n@@ -23,9 +24,10 @@ import {TagRecentMajorAsLatest} from './tag-recent-major-as-latest';\n export const actions: ReleaseActionConstructor[] = [\n   TagRecentMajorAsLatest,\n   CutStableAction,\n-  CutReleaseCandidateAction,\n+  CutReleaseCandidateForFeatureFreezeAction,\n   CutNewPatchAction,\n   CutNextPrereleaseAction,\n   MoveNextIntoFeatureFreezeAction,\n+  MoveNextIntoReleaseCandidateAction,\n   CutLongTermSupportPatchAction,\n ];"
        },
        {
            "sha": "90ccd3d8270b10d95cb5f5a4d934b2f0adad2b09",
            "filename": "dev-infra/release/publish/actions/move-next-into-feature-freeze.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 89,
            "changes": 98,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Fmove-next-into-feature-freeze.ts",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Fmove-next-into-feature-freeze.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Factions%2Fmove-next-into-feature-freeze.ts?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -6,103 +6,23 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import * as semver from 'semver';\n+import {ActiveReleaseTrains} from '../../versioning';\n \n-import {green, info, yellow} from '../../../utils/console';\n-import {ReleaseNotes} from '../../notes/release-notes';\n-import {ActiveReleaseTrains} from '../../versioning/active-release-trains';\n-import {computeNewPrereleaseVersionForNext} from '../../versioning/next-prerelease-version';\n-import {ReleaseAction} from '../actions';\n-import {getCommitMessageForExceptionalNextVersionBump, getReleaseNoteCherryPickCommitMessage} from '../commit-message';\n-import {changelogPath, packageJsonPath} from '../constants';\n+import {BranchOffNextBranchBaseAction} from './branch-off-next-branch';\n \n /**\n  * Release action that moves the next release-train into the feature-freeze phase. This means\n  * that a new version branch is created from the next branch, and a new next pre-release is\n  * cut indicating the started feature-freeze.\n  */\n-export class MoveNextIntoFeatureFreezeAction extends ReleaseAction {\n-  private _newVersion = computeNewPrereleaseVersionForNext(this.active, this.config);\n-\n-  override async getDescription() {\n-    const {branchName} = this.active.next;\n-    const newVersion = await this._newVersion;\n-    return `Move the \"${branchName}\" branch into feature-freeze phase (v${newVersion}).`;\n-  }\n-\n-  override async perform() {\n-    const newVersion = await this._newVersion;\n-    const newBranch = `${newVersion.major}.${newVersion.minor}.x`;\n-\n-    // Branch-off the next branch into a feature-freeze branch.\n-    await this._createNewVersionBranchFromNext(newBranch);\n-\n-    // Stage the new version for the newly created branch, and push changes to a\n-    // fork in order to create a staging pull request. Note that we re-use the newly\n-    // created branch instead of re-fetching from the upstream.\n-    const {pullRequest, releaseNotes} =\n-        await this.stageVersionForBranchAndCreatePullRequest(newVersion, newBranch);\n-\n-    // Wait for the staging PR to be merged. Then build and publish the feature-freeze next\n-    // pre-release. Finally, cherry-pick the release notes into the next branch in combination\n-    // with bumping the version to the next minor too.\n-    await this.waitForPullRequestToBeMerged(pullRequest);\n-    await this.buildAndPublish(releaseNotes, newBranch, 'next');\n-    await this._createNextBranchUpdatePullRequest(releaseNotes, newVersion);\n-  }\n-\n-  /** Creates a new version branch from the next branch. */\n-  private async _createNewVersionBranchFromNext(newBranch: string) {\n-    const {branchName: nextBranch} = this.active.next;\n-    await this.verifyPassingGithubStatus(nextBranch);\n-    await this.checkoutUpstreamBranch(nextBranch);\n-    await this.createLocalBranchFromHead(newBranch);\n-    await this.pushHeadToRemoteBranch(newBranch);\n-    info(green(`  ✓   Version branch \"${newBranch}\" created.`));\n-  }\n-\n-  /**\n-   * Creates a pull request for the next branch that bumps the version to the next\n-   * minor, and cherry-picks the changelog for the newly branched-off feature-freeze version.\n-   */\n-  private async _createNextBranchUpdatePullRequest(\n-      releaseNotes: ReleaseNotes, newVersion: semver.SemVer) {\n-    const {branchName: nextBranch, version} = this.active.next;\n-    // We increase the version for the next branch to the next minor. The team can decide\n-    // later if they want next to be a major through the `Configure Next as Major` release action.\n-    const newNextVersion = semver.parse(`${version.major}.${version.minor + 1}.0-next.0`)!;\n-    const bumpCommitMessage = getCommitMessageForExceptionalNextVersionBump(newNextVersion);\n-\n-    await this.checkoutUpstreamBranch(nextBranch);\n-    await this.updateProjectVersion(newNextVersion);\n-\n-    // Create an individual commit for the next version bump. The changelog should go into\n-    // a separate commit that makes it clear where the changelog is cherry-picked from.\n-    await this.createCommit(bumpCommitMessage, [packageJsonPath]);\n-\n-    await this.prependReleaseNotesToChangelog(releaseNotes);\n-\n-    const commitMessage = getReleaseNoteCherryPickCommitMessage(releaseNotes.version);\n-\n-    await this.createCommit(commitMessage, [changelogPath]);\n-\n-    let nextPullRequestMessage = `The previous \"next\" release-train has moved into the ` +\n-        `release-candidate phase. This PR updates the next branch to the subsequent ` +\n-        `release-train.\\n\\nAlso this PR cherry-picks the changelog for ` +\n-        `v${newVersion} into the ${nextBranch} branch so that the changelog is up to date.`;\n-\n-    const nextUpdatePullRequest = await this.pushChangesToForkAndCreatePullRequest(\n-        nextBranch, `next-release-train-${newNextVersion}`,\n-        `Update next branch to reflect new release-train \"v${newNextVersion}\".`,\n-        nextPullRequestMessage);\n-\n-    info(green(`  ✓   Pull request for updating the \"${nextBranch}\" branch has been created.`));\n-    info(yellow(`      Please ask team members to review: ${nextUpdatePullRequest.url}.`));\n-  }\n+export class MoveNextIntoFeatureFreezeAction extends BranchOffNextBranchBaseAction {\n+  override newPhaseName = 'feature-freeze' as const;\n \n   static override async isActive(active: ActiveReleaseTrains) {\n-    // A new feature-freeze/release-candidate branch can only be created if there\n-    // is no active release-train in feature-freeze/release-candidate phase.\n-    return active.releaseCandidate === null;\n+    // A new feature-freeze branch can only be created if there is no active\n+    // release-train in feature-freeze/release-candidate phase and the version\n+    // currently in the `next` branch is for a major. The feature-freeze phase\n+    // is not foreseen for minor versions.\n+    return active.releaseCandidate === null && active.next.isMajor;\n   }\n }"
        },
        {
            "sha": "4d9b7280edb91ab9ef41af3373ab4caf396f2a2b",
            "filename": "dev-infra/release/publish/actions/move-next-into-release-candidate.ts",
            "status": "added",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Fmove-next-into-release-candidate.ts",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Factions%2Fmove-next-into-release-candidate.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Factions%2Fmove-next-into-release-candidate.ts?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -0,0 +1,27 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+import {ActiveReleaseTrains} from '../../versioning';\n+\n+import {BranchOffNextBranchBaseAction} from './branch-off-next-branch';\n+\n+/**\n+ * Release action that moves the next release-train into the release-candidate phase. This means\n+ * that a new version branch is created from the next branch, and the first release candidate\n+ * version is cut indicating the new phase.\n+ */\n+export class MoveNextIntoReleaseCandidateAction extends BranchOffNextBranchBaseAction {\n+  override newPhaseName = 'release-candidate' as const;\n+\n+  static override async isActive(active: ActiveReleaseTrains) {\n+    // Directly switching a next release-train into the `release-candidate`\n+    // phase is only allowed for minor releases. Major version always need to\n+    // go through the `feature-freeze` phase.\n+    return active.releaseCandidate === null && !active.next.isMajor;\n+  }\n+}"
        },
        {
            "sha": "1934d872f460c21ec9ae22eb333b6d42e8be58c7",
            "filename": "dev-infra/release/publish/test/branch-off-next-branch-testing.ts",
            "status": "added",
            "additions": 103,
            "deletions": 0,
            "changes": 103,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Ftest%2Fbranch-off-next-branch-testing.ts",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Ftest%2Fbranch-off-next-branch-testing.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2Fbranch-off-next-branch-testing.ts?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -0,0 +1,103 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+import {getBranchPushMatcher} from '../../../utils/testing';\n+import {ActiveReleaseTrains} from '../../versioning';\n+import * as npm from '../../versioning/npm-publish';\n+import {ReleaseActionConstructor} from '../actions';\n+import {BranchOffNextBranchBaseAction} from '../actions/branch-off-next-branch';\n+import * as externalCommands from '../external-commands';\n+\n+import {setupReleaseActionForTesting, testTmpDir} from './test-utils';\n+\n+/**\n+ * Performs the given branch-off release action and expects versions and\n+ * branches to be determined and created properly.\n+ */\n+export async function expectBranchOffActionToRun(\n+    action: ReleaseActionConstructor<BranchOffNextBranchBaseAction>, active: ActiveReleaseTrains,\n+    isNextPublishedToNpm: boolean, expectedNextVersion: string, expectedVersion: string,\n+    expectedNewBranch: string) {\n+  const {repo, fork, instance, gitClient} =\n+      setupReleaseActionForTesting(action, active, isNextPublishedToNpm);\n+\n+  const expectedNextUpdateBranch = `next-release-train-${expectedNextVersion}`;\n+  const expectedStagingForkBranch = `release-stage-${expectedVersion}`;\n+  const expectedTagName = expectedVersion;\n+\n+  // We first mock the commit status check for the next branch, then expect two pull\n+  // requests from a fork that are targeting next and the new feature-freeze branch.\n+  repo.expectBranchRequest('master', 'MASTER_COMMIT_SHA')\n+      .expectCommitStatusCheck('MASTER_COMMIT_SHA', 'success')\n+      .expectFindForkRequest(fork)\n+      .expectPullRequestToBeCreated(expectedNewBranch, fork, expectedStagingForkBranch, 200)\n+      .expectPullRequestWait(200)\n+      .expectBranchRequest(expectedNewBranch, 'STAGING_COMMIT_SHA')\n+      .expectCommitRequest(\n+          'STAGING_COMMIT_SHA', `release: cut the v${expectedVersion} release\\n\\nPR Close #200.`)\n+      .expectTagToBeCreated(expectedTagName, 'STAGING_COMMIT_SHA')\n+      .expectReleaseToBeCreated(`v${expectedVersion}`, expectedTagName)\n+      .expectPullRequestToBeCreated('master', fork, expectedNextUpdateBranch, 100);\n+\n+  // In the fork, we make the following branches appear as non-existent,\n+  // so that the PRs can be created properly without collisions.\n+  fork.expectBranchRequest(expectedStagingForkBranch, null)\n+      .expectBranchRequest(expectedNextUpdateBranch, null);\n+\n+  await instance.perform();\n+\n+  expect(gitClient.pushed.length).toBe(3);\n+  expect(gitClient.pushed[0])\n+      .toEqual(\n+          getBranchPushMatcher({\n+            baseRepo: repo,\n+            baseBranch: 'master',\n+            targetRepo: repo,\n+            targetBranch: expectedNewBranch,\n+            expectedCommits: [],\n+          }),\n+          'Expected new version-branch to be created upstream and based on \"master\".');\n+  expect(gitClient.pushed[1])\n+      .toEqual(\n+          getBranchPushMatcher({\n+            baseBranch: 'master',\n+            baseRepo: repo,\n+            targetBranch: expectedStagingForkBranch,\n+            targetRepo: fork,\n+            expectedCommits: [{\n+              message: `release: cut the v${expectedVersion} release`,\n+              files: ['package.json', 'CHANGELOG.md'],\n+            }],\n+          }),\n+          'Expected release staging branch to be created in fork.');\n+\n+  expect(gitClient.pushed[2])\n+      .toEqual(\n+          getBranchPushMatcher({\n+            baseBranch: 'master',\n+            baseRepo: repo,\n+            targetBranch: expectedNextUpdateBranch,\n+            targetRepo: fork,\n+            expectedCommits: [\n+              {\n+                message: `release: bump the next branch to v${expectedNextVersion}`,\n+                files: ['package.json']\n+              },\n+              {\n+                message: `docs: release notes for the v${expectedVersion} release`,\n+                files: ['CHANGELOG.md']\n+              },\n+            ],\n+          }),\n+          'Expected next release-train update branch be created in fork.');\n+\n+  expect(externalCommands.invokeReleaseBuildCommand).toHaveBeenCalledTimes(1);\n+  expect(npm.runNpmPublish).toHaveBeenCalledTimes(2);\n+  expect(npm.runNpmPublish).toHaveBeenCalledWith(`${testTmpDir}/dist/pkg1`, 'next', undefined);\n+  expect(npm.runNpmPublish).toHaveBeenCalledWith(`${testTmpDir}/dist/pkg2`, 'next', undefined);\n+}"
        },
        {
            "sha": "abb913f0903eb1427d156112909a7b95415bdd64",
            "filename": "dev-infra/release/publish/test/cut-release-candidate-for-feature-freeze.spec.ts",
            "status": "renamed",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Ftest%2Fcut-release-candidate-for-feature-freeze.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Ftest%2Fcut-release-candidate-for-feature-freeze.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2Fcut-release-candidate-for-feature-freeze.spec.ts?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -7,21 +7,21 @@\n  */\n \n import {ReleaseTrain} from '../../versioning/release-trains';\n-import {CutReleaseCandidateAction} from '../actions/cut-release-candidate';\n+import {CutReleaseCandidateForFeatureFreezeAction} from '../actions/cut-release-candidate-for-feature-freeze';\n \n import {expectStagingAndPublishWithCherryPick, parse, setupReleaseActionForTesting} from './test-utils';\n \n-describe('cut release candidate action', () => {\n+describe('cut release candidate for feature-freeze action', () => {\n   it('should activate if a feature-freeze release-train is active', async () => {\n-    expect(await CutReleaseCandidateAction.isActive({\n+    expect(await CutReleaseCandidateForFeatureFreezeAction.isActive({\n       releaseCandidate: new ReleaseTrain('10.1.x', parse('10.1.0-next.1')),\n       next: new ReleaseTrain('master', parse('10.2.0-next.0')),\n       latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n     })).toBe(true);\n   });\n \n   it('should not activate if release-candidate release-train is active', async () => {\n-    expect(await CutReleaseCandidateAction.isActive({\n+    expect(await CutReleaseCandidateForFeatureFreezeAction.isActive({\n       // No longer in feature-freeze but in release-candidate phase.\n       releaseCandidate: new ReleaseTrain('10.1.x', parse('10.1.0-rc.0')),\n       next: new ReleaseTrain('master', parse('10.2.0-next.0')),\n@@ -30,15 +30,15 @@ describe('cut release candidate action', () => {\n   });\n \n   it('should not activate if no FF/RC release-train is active', async () => {\n-    expect(await CutReleaseCandidateAction.isActive({\n+    expect(await CutReleaseCandidateForFeatureFreezeAction.isActive({\n       releaseCandidate: null,\n       next: new ReleaseTrain('master', parse('10.1.0-next.0')),\n       latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n     })).toBe(false);\n   });\n \n   it('should create a proper new version and select correct branch', async () => {\n-    const action = setupReleaseActionForTesting(CutReleaseCandidateAction, {\n+    const action = setupReleaseActionForTesting(CutReleaseCandidateForFeatureFreezeAction, {\n       releaseCandidate: new ReleaseTrain('10.1.x', parse('10.1.0-next.1')),\n       next: new ReleaseTrain('master', parse('10.2.0-next.0')),\n       latest: new ReleaseTrain('10.0.x', parse('10.0.3')),",
            "previous_filename": "dev-infra/release/publish/test/cut-release-candidate.spec.ts"
        },
        {
            "sha": "bf84b90b6bfb9bc9a05167ead446f5d6472cce07",
            "filename": "dev-infra/release/publish/test/move-next-into-feature-freeze.spec.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 93,
            "changes": 108,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Ftest%2Fmove-next-into-feature-freeze.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Ftest%2Fmove-next-into-feature-freeze.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2Fmove-next-into-feature-freeze.spec.ts?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -6,14 +6,11 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {getBranchPushMatcher} from '../../../utils/testing';\n-import {ActiveReleaseTrains} from '../../versioning/active-release-trains';\n-import * as npm from '../../versioning/npm-publish';\n import {ReleaseTrain} from '../../versioning/release-trains';\n import {MoveNextIntoFeatureFreezeAction} from '../actions/move-next-into-feature-freeze';\n-import * as externalCommands from '../external-commands';\n \n-import {parse, setupReleaseActionForTesting, testTmpDir} from './test-utils';\n+import {expectBranchOffActionToRun} from './branch-off-next-branch-testing';\n+import {parse} from './test-utils';\n \n describe('move next into feature-freeze action', () => {\n   it('should not activate if a feature-freeze release-train is active', async () => {\n@@ -33,17 +30,25 @@ describe('move next into feature-freeze action', () => {\n     })).toBe(false);\n   });\n \n+  it('should not activate if the next release-train is for a minor', async () => {\n+    expect(await MoveNextIntoFeatureFreezeAction.isActive({\n+      releaseCandidate: null,\n+      next: new ReleaseTrain('master', parse('10.1.0-next.2')),\n+      latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n+    })).toBe(false);\n+  });\n+\n   it('should activate if no FF/RC release-train is active', async () => {\n     expect(await MoveNextIntoFeatureFreezeAction.isActive({\n       releaseCandidate: null,\n-      next: new ReleaseTrain('master', parse('10.1.0-next.0')),\n+      next: new ReleaseTrain('master', parse('11.0.0-next.0')),\n       latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n     })).toBe(true);\n   });\n \n   it('should create pull requests and feature-freeze branch', async () => {\n-    await expectVersionAndBranchToBeCreated(\n-        {\n+    await expectBranchOffActionToRun(\n+        MoveNextIntoFeatureFreezeAction, {\n           releaseCandidate: null,\n           next: new ReleaseTrain('master', parse('10.2.0-next.0')),\n           latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n@@ -52,95 +57,12 @@ describe('move next into feature-freeze action', () => {\n   });\n \n   it('should not increment the version if \"next\" version is not yet published', async () => {\n-    await expectVersionAndBranchToBeCreated(\n-        {\n+    await expectBranchOffActionToRun(\n+        MoveNextIntoFeatureFreezeAction, {\n           releaseCandidate: null,\n           next: new ReleaseTrain('master', parse('10.2.0-next.0')),\n           latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n         },\n         /* isNextPublishedToNpm */ false, '10.3.0-next.0', '10.2.0-next.0', '10.2.x');\n   });\n-\n-  /** Performs the action and expects versions and branches to be determined properly. */\n-  async function expectVersionAndBranchToBeCreated(\n-      active: ActiveReleaseTrains, isNextPublishedToNpm: boolean, expectedNextVersion: string,\n-      expectedVersion: string, expectedNewBranch: string) {\n-    const {repo, fork, instance, gitClient, releaseConfig} =\n-        setupReleaseActionForTesting(MoveNextIntoFeatureFreezeAction, active, isNextPublishedToNpm);\n-\n-    const expectedNextUpdateBranch = `next-release-train-${expectedNextVersion}`;\n-    const expectedStagingForkBranch = `release-stage-${expectedVersion}`;\n-    const expectedTagName = expectedVersion;\n-\n-    // We first mock the commit status check for the next branch, then expect two pull\n-    // requests from a fork that are targeting next and the new feature-freeze branch.\n-    repo.expectBranchRequest('master', 'MASTER_COMMIT_SHA')\n-        .expectCommitStatusCheck('MASTER_COMMIT_SHA', 'success')\n-        .expectFindForkRequest(fork)\n-        .expectPullRequestToBeCreated(expectedNewBranch, fork, expectedStagingForkBranch, 200)\n-        .expectPullRequestWait(200)\n-        .expectBranchRequest(expectedNewBranch, 'STAGING_COMMIT_SHA')\n-        .expectCommitRequest(\n-            'STAGING_COMMIT_SHA', `release: cut the v${expectedVersion} release\\n\\nPR Close #200.`)\n-        .expectTagToBeCreated(expectedTagName, 'STAGING_COMMIT_SHA')\n-        .expectReleaseToBeCreated(`v${expectedVersion}`, expectedTagName)\n-        .expectPullRequestToBeCreated('master', fork, expectedNextUpdateBranch, 100);\n-\n-    // In the fork, we make the following branches appear as non-existent,\n-    // so that the PRs can be created properly without collisions.\n-    fork.expectBranchRequest(expectedStagingForkBranch, null)\n-        .expectBranchRequest(expectedNextUpdateBranch, null);\n-\n-    await instance.perform();\n-\n-    expect(gitClient.pushed.length).toBe(3);\n-    expect(gitClient.pushed[0])\n-        .toEqual(\n-            getBranchPushMatcher({\n-              baseRepo: repo,\n-              baseBranch: 'master',\n-              targetRepo: repo,\n-              targetBranch: expectedNewBranch,\n-              expectedCommits: [],\n-            }),\n-            'Expected feature-freeze branch to be created upstream and based on \"master\".');\n-    expect(gitClient.pushed[1])\n-        .toEqual(\n-            getBranchPushMatcher({\n-              baseBranch: 'master',\n-              baseRepo: repo,\n-              targetBranch: expectedStagingForkBranch,\n-              targetRepo: fork,\n-              expectedCommits: [{\n-                message: `release: cut the v${expectedVersion} release`,\n-                files: ['package.json', 'CHANGELOG.md'],\n-              }],\n-            }),\n-            'Expected release staging branch to be created in fork.');\n-\n-    expect(gitClient.pushed[2])\n-        .toEqual(\n-            getBranchPushMatcher({\n-              baseBranch: 'master',\n-              baseRepo: repo,\n-              targetBranch: expectedNextUpdateBranch,\n-              targetRepo: fork,\n-              expectedCommits: [\n-                {\n-                  message: `release: bump the next branch to v${expectedNextVersion}`,\n-                  files: ['package.json']\n-                },\n-                {\n-                  message: `docs: release notes for the v${expectedVersion} release`,\n-                  files: ['CHANGELOG.md']\n-                },\n-              ],\n-            }),\n-            'Expected next release-train update branch be created in fork.');\n-\n-    expect(externalCommands.invokeReleaseBuildCommand).toHaveBeenCalledTimes(1);\n-    expect(npm.runNpmPublish).toHaveBeenCalledTimes(2);\n-    expect(npm.runNpmPublish).toHaveBeenCalledWith(`${testTmpDir}/dist/pkg1`, 'next', undefined);\n-    expect(npm.runNpmPublish).toHaveBeenCalledWith(`${testTmpDir}/dist/pkg2`, 'next', undefined);\n-  }\n });"
        },
        {
            "sha": "d12b2ae159fe435a86e109d369c284ef9902ae1e",
            "filename": "dev-infra/release/publish/test/move-next-into-release-candidate.spec.ts",
            "status": "added",
            "additions": 58,
            "deletions": 0,
            "changes": 58,
            "blob_url": "https://github.com/angular/angular/blob/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Ftest%2Fmove-next-into-release-candidate.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/047994b0483f9c2bcca5c77d6bb58ce0c274c63f/dev-infra%2Frelease%2Fpublish%2Ftest%2Fmove-next-into-release-candidate.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2Fmove-next-into-release-candidate.spec.ts?ref=047994b0483f9c2bcca5c77d6bb58ce0c274c63f",
            "patch": "@@ -0,0 +1,58 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+import {ReleaseTrain} from '../../versioning/release-trains';\n+import {MoveNextIntoReleaseCandidateAction} from '../actions/move-next-into-release-candidate';\n+\n+import {expectBranchOffActionToRun} from './branch-off-next-branch-testing';\n+import {parse} from './test-utils';\n+\n+describe('move next into release-candidate action', () => {\n+  it('should not activate if a feature-freeze release-train is active', async () => {\n+    expect(await MoveNextIntoReleaseCandidateAction.isActive({\n+      releaseCandidate: new ReleaseTrain('10.1.x', parse('10.1.0-next.1')),\n+      next: new ReleaseTrain('master', parse('10.2.0-next.0')),\n+      latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n+    })).toBe(false);\n+  });\n+\n+  it('should not activate if release-candidate release-train is active', async () => {\n+    expect(await MoveNextIntoReleaseCandidateAction.isActive({\n+      // No longer in feature-freeze but in release-candidate phase.\n+      releaseCandidate: new ReleaseTrain('10.1.x', parse('10.1.0-rc.0')),\n+      next: new ReleaseTrain('master', parse('10.2.0-next.0')),\n+      latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n+    })).toBe(false);\n+  });\n+\n+  it('should not activate if the next release-train is for a major', async () => {\n+    expect(await MoveNextIntoReleaseCandidateAction.isActive({\n+      releaseCandidate: null,\n+      next: new ReleaseTrain('master', parse('11.0.0-next.0')),\n+      latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n+    })).toBe(false);\n+  });\n+\n+  it('should activate if no FF/RC release-train is active', async () => {\n+    expect(await MoveNextIntoReleaseCandidateAction.isActive({\n+      releaseCandidate: null,\n+      next: new ReleaseTrain('master', parse('10.1.0-next.0')),\n+      latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n+    })).toBe(true);\n+  });\n+\n+  it('should create pull requests and new version-branch', async () => {\n+    await expectBranchOffActionToRun(\n+        MoveNextIntoReleaseCandidateAction, {\n+          releaseCandidate: null,\n+          next: new ReleaseTrain('master', parse('10.2.0-next.0')),\n+          latest: new ReleaseTrain('10.0.x', parse('10.0.3')),\n+        },\n+        /* isNextPublishedToNpm */ true, '10.3.0-next.0', '10.2.0-rc.0', '10.2.x');\n+  });\n+});"
        }
    ],
    "stats": {
        "total": 629,
        "additions": 419,
        "deletions": 210
    }
}