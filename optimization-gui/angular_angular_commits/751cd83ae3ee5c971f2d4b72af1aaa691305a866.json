{
    "author": "iRealNirmal",
    "message": "fix(forms): the `min` and `max` validators should work correctly with `0` as a value (#42412)\n\nPrior to this change the `min` and `max` validator directives would not\nset the `min` and `max` attributes on the host element. The problem was\ncaused by the truthy check in host binding expression that was\ncalculated as `false` when `0` is used as a value. This commit updates\nthe logic to leverage nullish coalescing operator in these host binding\nexpressions, so `0` is treated as a valid value, thus the `min` and\n`max` attributes are set correctly.\n\nPartially closes #42267\n\nPR Close #42412",
    "sha": "751cd83ae3ee5c971f2d4b72af1aaa691305a866",
    "files": [
        {
            "sha": "53b53d2450ee9853946618df9c4c4fe8b65252c9",
            "filename": "packages/forms/src/directives/validators.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/751cd83ae3ee5c971f2d4b72af1aaa691305a866/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "raw_url": "https://github.com/angular/angular/raw/751cd83ae3ee5c971f2d4b72af1aaa691305a866/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts?ref=751cd83ae3ee5c971f2d4b72af1aaa691305a866",
            "patch": "@@ -167,7 +167,7 @@ export const MAX_VALIDATOR: StaticProvider = {\n   selector:\n       'input[type=number][max][formControlName],input[type=number][max][formControl],input[type=number][max][ngModel]',\n   providers: [MAX_VALIDATOR],\n-  host: {'[attr.max]': 'max ? max : null'}\n+  host: {'[attr.max]': 'max ?? null'}\n })\n export class MaxValidator extends AbstractValidatorDirective implements OnChanges {\n   /**\n@@ -227,7 +227,7 @@ export const MIN_VALIDATOR: StaticProvider = {\n   selector:\n       'input[type=number][min][formControlName],input[type=number][min][formControl],input[type=number][min][ngModel]',\n   providers: [MIN_VALIDATOR],\n-  host: {'[attr.min]': 'min ? min : null'}\n+  host: {'[attr.min]': 'min ?? null'}\n })\n export class MinValidator extends AbstractValidatorDirective implements OnChanges {\n   /**"
        },
        {
            "sha": "b75e4c3e13eb1a97aefe1110e1003184e5690e34",
            "filename": "packages/forms/test/reactive_integration_spec.ts",
            "status": "modified",
            "additions": 37,
            "deletions": 0,
            "changes": 37,
            "blob_url": "https://github.com/angular/angular/blob/751cd83ae3ee5c971f2d4b72af1aaa691305a866/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/751cd83ae3ee5c971f2d4b72af1aaa691305a866/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts?ref=751cd83ae3ee5c971f2d4b72af1aaa691305a866",
            "patch": "@@ -2558,8 +2558,23 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n             fixture.componentInstance.max = 1;\n             fixture.detectChanges();\n \n+            expect(input.getAttribute('max')).toEqual('1');\n             expect(form.valid).toBeFalse();\n             expect(form.controls.pin.errors).toEqual({max: {max: 1, actual: 2}});\n+\n+            fixture.componentInstance.min = 0;\n+            fixture.componentInstance.max = 0;\n+            fixture.detectChanges();\n+            expect(input.getAttribute('min')).toEqual('0');\n+            expect(input.getAttribute('max')).toEqual('0');\n+            expect(form.valid).toBeFalse();\n+            expect(form.controls.pin.errors).toEqual({max: {max: 0, actual: 2}});\n+\n+            input.value = 0;\n+            dispatchEvent(input, 'input');\n+            fixture.detectChanges();\n+            expect(form.valid).toBeTruthy();\n+            expect(form.controls.pin.errors).toBeNull();\n           });\n \n           it('should validate max for float number', () => {\n@@ -2573,6 +2588,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n             const input = fixture.debugElement.query(By.css('input')).nativeElement;\n             const form = fixture.componentInstance.form;\n \n+            expect(input.getAttribute('max')).toEqual('10.35');\n             expect(input.value).toEqual('10.25');\n             expect(form.valid).toBeTruthy();\n             expect(form.controls.pin.errors).toBeNull();\n@@ -2586,6 +2602,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n             fixture.componentInstance.max = 10.05;\n             fixture.detectChanges();\n \n+            expect(input.getAttribute('max')).toEqual('10.05');\n             expect(form.valid).toBeFalse();\n             expect(form.controls.pin.errors).toEqual({max: {max: 10.05, actual: 10.15}});\n \n@@ -2618,6 +2635,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n             fixture.componentInstance.max = 1;\n             fixture.detectChanges();\n+            expect(input.getAttribute('max')).toEqual('1');\n             expect(form.valid).toBeFalse();\n             expect(form.controls.pin.errors).toEqual({max: {max: 1, actual: 2}});\n           });\n@@ -2644,8 +2662,23 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n             fixture.componentInstance.min = 5;\n             fixture.detectChanges();\n+            expect(input.getAttribute('min')).toEqual('5');\n             expect(form.valid).toBeFalse();\n             expect(form.controls.pin.errors).toEqual({min: {min: 5, actual: 2}});\n+\n+            fixture.componentInstance.min = 0;\n+            input.value = -5;\n+            dispatchEvent(input, 'input');\n+            fixture.detectChanges();\n+            expect(input.getAttribute('min')).toEqual('0');\n+            expect(form.valid).toBeFalse();\n+            expect(form.controls.pin.errors).toEqual({min: {min: 0, actual: -5}});\n+\n+            input.value = 0;\n+            dispatchEvent(input, 'input');\n+            fixture.detectChanges();\n+            expect(form.valid).toBeTruthy();\n+            expect(form.controls.pin.errors).toBeNull();\n           });\n \n           it('should validate min for float number', () => {\n@@ -2660,6 +2693,8 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n             const input = fixture.debugElement.query(By.css('input')).nativeElement;\n             const form = fixture.componentInstance.form;\n \n+            expect(input.getAttribute('min')).toEqual('10.25');\n+            expect(input.getAttribute('max')).toEqual('10.5');\n             expect(input.value).toEqual('10.25');\n             expect(form.valid).toBeTruthy();\n             expect(form.controls.pin.errors).toBeNull();\n@@ -2672,6 +2707,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n             fixture.componentInstance.min = 10.40;\n             fixture.detectChanges();\n+            expect(input.getAttribute('min')).toEqual('10.4');\n             expect(form.valid).toBeFalse();\n             expect(form.controls.pin.errors).toEqual({min: {min: 10.40, actual: 10.35}});\n \n@@ -2704,6 +2740,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n             fixture.componentInstance.min = 5;\n             fixture.detectChanges();\n+            expect(input.getAttribute('min')).toEqual('5');\n             expect(form.valid).toBeFalse();\n             expect(form.controls.pin.errors).toEqual({min: {min: 5, actual: 2}});\n           });"
        },
        {
            "sha": "8270270cebd7c243fd76d5059974bbdd7da2f62c",
            "filename": "packages/forms/test/template_integration_spec.ts",
            "status": "modified",
            "additions": 37,
            "deletions": 0,
            "changes": 37,
            "blob_url": "https://github.com/angular/angular/blob/751cd83ae3ee5c971f2d4b72af1aaa691305a866/packages%2Fforms%2Ftest%2Ftemplate_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/751cd83ae3ee5c971f2d4b72af1aaa691305a866/packages%2Fforms%2Ftest%2Ftemplate_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Ftemplate_integration_spec.ts?ref=751cd83ae3ee5c971f2d4b72af1aaa691305a866",
            "patch": "@@ -1524,6 +1524,7 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            input.value = '';\n            dispatchEvent(input, 'input');\n            fixture.detectChanges();\n+           expect(input.getAttribute('max')).toEqual('10');\n            expect(form.valid).toEqual(true);\n            expect(form.controls.max.errors).toBeNull();\n \n@@ -1538,6 +1539,21 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            fixture.detectChanges();\n            expect(form.valid).toEqual(true);\n            expect(form.controls.max.errors).toBeNull();\n+\n+           fixture.componentInstance.max = 0;\n+           fixture.detectChanges();\n+           tick();\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(input.getAttribute('max')).toEqual('0');\n+           expect(form.valid).toEqual(false);\n+           expect(form.controls.max.errors).toEqual({max: {max: 0, actual: 9}});\n+\n+           input.value = 0;\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(true);\n+           expect(form.controls.max.errors).toBeNull();\n          }));\n \n       it('should validate max for float number', fakeAsync(() => {\n@@ -1552,6 +1568,7 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            input.value = '';\n            dispatchEvent(input, 'input');\n            fixture.detectChanges();\n+           expect(input.getAttribute('max')).toEqual('10.25');\n            expect(form.valid).toEqual(true);\n            expect(form.controls.max.errors).toBeNull();\n \n@@ -1586,6 +1603,7 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            input.value = '11';\n            dispatchEvent(input, 'input');\n            fixture.detectChanges();\n+           expect(input.getAttribute('max')).toEqual('10');\n            expect(form.valid).toEqual(false);\n            expect(form.controls.max.errors).toEqual({max: {max: 10, actual: 11}});\n \n@@ -1635,6 +1653,7 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            input.value = '';\n            dispatchEvent(input, 'input');\n            fixture.detectChanges();\n+           expect(input.getAttribute('min')).toEqual('10');\n            expect(form.valid).toEqual(true);\n            expect(form.controls.min.errors).toBeNull();\n \n@@ -1649,6 +1668,22 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            fixture.detectChanges();\n            expect(form.valid).toEqual(false);\n            expect(form.controls.min.errors).toEqual({min: {min: 10, actual: 9}});\n+\n+           fixture.componentInstance.min = 0;\n+           fixture.detectChanges();\n+           tick();\n+           input.value = -5;\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(input.getAttribute('min')).toEqual('0');\n+           expect(form.valid).toEqual(false);\n+           expect(form.controls.min.errors).toEqual({min: {min: 0, actual: -5}});\n+\n+           input.value = 0;\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(true);\n+           expect(form.controls.min.errors).toBeNull();\n          }));\n \n       it('should validate min for float number', fakeAsync(() => {\n@@ -1663,6 +1698,7 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            input.value = '';\n            dispatchEvent(input, 'input');\n            fixture.detectChanges();\n+           expect(input.getAttribute('min')).toEqual('10.25');\n            expect(form.valid).toEqual(true);\n            expect(form.controls.min.errors).toBeNull();\n \n@@ -1696,6 +1732,7 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            input.value = '11';\n            dispatchEvent(input, 'input');\n            fixture.detectChanges();\n+           expect(input.getAttribute('min')).toEqual('10');\n            expect(form.valid).toEqual(true);\n            expect(form.controls.min.errors).toBeNull();\n "
        }
    ],
    "stats": {
        "total": 78,
        "additions": 76,
        "deletions": 2
    }
}