{
    "author": "bjarkler",
    "message": "fix(core): use Trusted Types policy in named_array_type (#39209)\n\nAddress a Trusted Types violation that occurs in createNamedArrayType\nduring development mode. Instead of passing strings directly to \"new\nFunction\", use the Trusted Types compatible function constructor exposed\nby the Trusted Types policy.\n\nPR Close #39209",
    "sha": "f6d5cdfbd74f2712309f23c952915f4ac7d001d7",
    "files": [
        {
            "sha": "d5f2d76421c23c2815bb3761c97c3fd222d2bce9",
            "filename": "packages/core/src/util/named_array_type.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/f6d5cdfbd74f2712309f23c952915f4ac7d001d7/packages%2Fcore%2Fsrc%2Futil%2Fnamed_array_type.ts",
            "raw_url": "https://github.com/angular/angular/raw/f6d5cdfbd74f2712309f23c952915f4ac7d001d7/packages%2Fcore%2Fsrc%2Futil%2Fnamed_array_type.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Futil%2Fnamed_array_type.ts?ref=f6d5cdfbd74f2712309f23c952915f4ac7d001d7",
            "patch": "@@ -8,6 +8,7 @@\n  */\n \n import './ng_dev_mode';\n+import {newTrustedFunctionForDev} from './security/trusted_types';\n \n /**\n  * THIS FILE CONTAINS CODE WHICH SHOULD BE TREE SHAKEN AND NEVER CALLED FROM PRODUCTION CODE!!!\n@@ -27,9 +28,10 @@ export function createNamedArrayType(name: string): typeof Array {\n   // This should never be called in prod mode, so let's verify that is the case.\n   if (ngDevMode) {\n     try {\n-      // We need to do it this way so that TypeScript does not down-level the below code.\n-      const FunctionConstructor: any = createNamedArrayType.constructor;\n-      return (new FunctionConstructor('Array', `return class ${name} extends Array{}`))(Array);\n+      // If this function were compromised the following could lead to arbitrary\n+      // script execution. We bless it with Trusted Types anyway since this\n+      // function is stripped out of production binaries.\n+      return (newTrustedFunctionForDev('Array', `return class ${name} extends Array{}`))(Array);\n     } catch (e) {\n       // If it does not work just give up and fall back to regular Array.\n       return Array;"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 5,
        "deletions": 3
    }
}