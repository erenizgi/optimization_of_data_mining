{
    "author": "JoostK",
    "message": "fix(core): handle invalid constructor parameters in partial factory declarations (#43619)\n\nThis commit fixes an oversight in the JIT compilation of partial factory\ndeclarations, where the literal `'invalid'` was not accounted for\n(unlike the AOT linker).\n\nFixes #43609\n\nPR Close #43619",
    "sha": "ad6407dcd02881c55b6c44b18a3eefc7fed247f8",
    "files": [
        {
            "sha": "6a27e8e1786e00afc0188e8471fc311d73bb1de6",
            "filename": "packages/compiler/src/compiler_facade_interface.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/ad6407dcd02881c55b6c44b18a3eefc7fed247f8/packages%2Fcompiler%2Fsrc%2Fcompiler_facade_interface.ts",
            "raw_url": "https://github.com/angular/angular/raw/ad6407dcd02881c55b6c44b18a3eefc7fed247f8/packages%2Fcompiler%2Fsrc%2Fcompiler_facade_interface.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fcompiler_facade_interface.ts?ref=ad6407dcd02881c55b6c44b18a3eefc7fed247f8",
            "patch": "@@ -241,7 +241,7 @@ export interface R3FactoryDefMetadataFacade {\n \n export interface R3DeclareFactoryFacade {\n   type: Type;\n-  deps: R3DeclareDependencyMetadataFacade[]|null;\n+  deps: R3DeclareDependencyMetadataFacade[]|'invalid'|null;\n   target: FactoryTarget;\n }\n "
        },
        {
            "sha": "ff2ca97bc8f696b138a3cf3d61033f1f1f2c6751",
            "filename": "packages/compiler/src/jit_compiler_facade.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/ad6407dcd02881c55b6c44b18a3eefc7fed247f8/packages%2Fcompiler%2Fsrc%2Fjit_compiler_facade.ts",
            "raw_url": "https://github.com/angular/angular/raw/ad6407dcd02881c55b6c44b18a3eefc7fed247f8/packages%2Fcompiler%2Fsrc%2Fjit_compiler_facade.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fjit_compiler_facade.ts?ref=ad6407dcd02881c55b6c44b18a3eefc7fed247f8",
            "patch": "@@ -241,7 +241,8 @@ export class CompilerFacadeImpl implements CompilerFacade {\n       type: wrapReference(meta.type),\n       internalType: new WrappedNodeExpr(meta.type),\n       typeArgumentCount: 0,\n-      deps: meta.deps && meta.deps.map(convertR3DeclareDependencyMetadata),\n+      deps: Array.isArray(meta.deps) ? meta.deps.map(convertR3DeclareDependencyMetadata) :\n+                                       meta.deps,\n       target: meta.target,\n     });\n     return this.jitExpression("
        },
        {
            "sha": "6a27e8e1786e00afc0188e8471fc311d73bb1de6",
            "filename": "packages/core/src/compiler/compiler_facade_interface.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/ad6407dcd02881c55b6c44b18a3eefc7fed247f8/packages%2Fcore%2Fsrc%2Fcompiler%2Fcompiler_facade_interface.ts",
            "raw_url": "https://github.com/angular/angular/raw/ad6407dcd02881c55b6c44b18a3eefc7fed247f8/packages%2Fcore%2Fsrc%2Fcompiler%2Fcompiler_facade_interface.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Fcompiler%2Fcompiler_facade_interface.ts?ref=ad6407dcd02881c55b6c44b18a3eefc7fed247f8",
            "patch": "@@ -241,7 +241,7 @@ export interface R3FactoryDefMetadataFacade {\n \n export interface R3DeclareFactoryFacade {\n   type: Type;\n-  deps: R3DeclareDependencyMetadataFacade[]|null;\n+  deps: R3DeclareDependencyMetadataFacade[]|'invalid'|null;\n   target: FactoryTarget;\n }\n "
        },
        {
            "sha": "8a47ae317dc51850bf059e0bdc8de7cda152538a",
            "filename": "packages/core/test/render3/jit/declare_factory_spec.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/ad6407dcd02881c55b6c44b18a3eefc7fed247f8/packages%2Fcore%2Ftest%2Frender3%2Fjit%2Fdeclare_factory_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/ad6407dcd02881c55b6c44b18a3eefc7fed247f8/packages%2Fcore%2Ftest%2Frender3%2Fjit%2Fdeclare_factory_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fjit%2Fdeclare_factory_spec.ts?ref=ad6407dcd02881c55b6c44b18a3eefc7fed247f8",
            "patch": "@@ -36,6 +36,11 @@ describe('Factory declaration jit compilation', () => {\n     expect(instance).toBeInstanceOf(ChildClass);\n     expect(instance.testClass).toBeInstanceOf(TestClass);\n   });\n+\n+  it('should compile a factory declaration with an invalid dependency', () => {\n+    const factory = InvalidDepsClass.ɵfac as Function;\n+    expect(() => factory()).toThrowError(/not compatible/);\n+  });\n });\n \n class TestClass {\n@@ -56,6 +61,11 @@ class ChildClass extends DependingClass {\n       ɵɵngDeclareFactory({type: ChildClass, deps: null, target: ɵɵFactoryTarget.Injectable});\n }\n \n+class InvalidDepsClass {\n+  static ɵfac = ɵɵngDeclareFactory(\n+      {type: InvalidDepsClass, deps: 'invalid', target: ɵɵFactoryTarget.Injectable});\n+}\n+\n class TestInjector {\n   static ɵinj = ɵɵdefineInjector({\n     providers: [TestClass, DependingClass, ChildClass],"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 14,
        "deletions": 3
    }
}