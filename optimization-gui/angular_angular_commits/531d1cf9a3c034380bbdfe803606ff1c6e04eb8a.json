{
    "author": "iRealNirmal",
    "message": "refactor(forms): update required validator and checkbox validator to inherit abstractValidator (#44162)\n\nModified required validator and checkbox validator to inherit abstractValidator.\n\nFor every validato type different PR will be raised as discussed in #42378.\n\nCloses #42267\n\nPR Close #44162",
    "sha": "531d1cf9a3c034380bbdfe803606ff1c6e04eb8a",
    "files": [
        {
            "sha": "3ac1513ee1c59ca99d2b172167e8bf85dda21e7c",
            "filename": "goldens/public-api/forms/forms.md",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/goldens%2Fpublic-api%2Fforms%2Fforms.md",
            "raw_url": "https://github.com/angular/angular/raw/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/goldens%2Fpublic-api%2Fforms%2Fforms.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fforms%2Fforms.md?ref=531d1cf9a3c034380bbdfe803606ff1c6e04eb8a",
            "patch": "@@ -167,7 +167,6 @@ export class CheckboxControlValueAccessor extends BuiltInControlValueAccessor im\n \n // @public\n export class CheckboxRequiredValidator extends RequiredValidator {\n-    validate(control: AbstractControl): ValidationErrors | null;\n     // (undocumented)\n     static ɵdir: i0.ɵɵDirectiveDeclaration<CheckboxRequiredValidator, \"input[type=checkbox][required][formControlName],input[type=checkbox][required][formControl],input[type=checkbox][required][ngModel]\", never, {}, {}, never>;\n     // (undocumented)\n@@ -694,11 +693,10 @@ export class ReactiveFormsModule {\n }\n \n // @public\n-export class RequiredValidator implements Validator {\n-    registerOnValidatorChange(fn: () => void): void;\n-    get required(): boolean | string;\n-    set required(value: boolean | string);\n-    validate(control: AbstractControl): ValidationErrors | null;\n+export class RequiredValidator extends AbstractValidatorDirective {\n+    // (undocumented)\n+    enabled(input: boolean): boolean;\n+    required: boolean | string;\n     // (undocumented)\n     static ɵdir: i0.ɵɵDirectiveDeclaration<RequiredValidator, \":not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]\", never, { \"required\": \"required\"; }, {}, never>;\n     // (undocumented)"
        },
        {
            "sha": "113084934d3ea32cc049a72d0b09b17e10cdd6fe",
            "filename": "goldens/size-tracking/integration-payloads.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/goldens%2Fsize-tracking%2Fintegration-payloads.json",
            "raw_url": "https://github.com/angular/angular/raw/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/goldens%2Fsize-tracking%2Fintegration-payloads.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fsize-tracking%2Fintegration-payloads.json?ref=531d1cf9a3c034380bbdfe803606ff1c6e04eb8a",
            "patch": "@@ -52,8 +52,8 @@\n     \"master\": {\n       \"uncompressed\": {\n         \"runtime\": 1063,\n-        \"main\": 162121,\n-        \"polyfills\": 37206\n+        \"main\": 163160,\n+        \"polyfills\": 36975\n       }\n     }\n   },"
        },
        {
            "sha": "7820c2688f6bd686879b007fbecb96adaa985f16",
            "filename": "packages/core/test/bundling/forms_template_driven/bundle.golden_symbols.json",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/packages%2Fcore%2Ftest%2Fbundling%2Fforms_template_driven%2Fbundle.golden_symbols.json",
            "raw_url": "https://github.com/angular/angular/raw/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/packages%2Fcore%2Ftest%2Fbundling%2Fforms_template_driven%2Fbundle.golden_symbols.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Fbundling%2Fforms_template_driven%2Fbundle.golden_symbols.json?ref=531d1cf9a3c034380bbdfe803606ff1c6e04eb8a",
            "patch": "@@ -29,6 +29,9 @@\n   {\n     \"name\": \"AbstractFormGroupDirective\"\n   },\n+  {\n+    \"name\": \"AbstractValidatorDirective\"\n+  },\n   {\n     \"name\": \"AnonymousSubject\"\n   },\n@@ -1307,6 +1310,9 @@\n   {\n     \"name\": \"notFoundValueOrThrow\"\n   },\n+  {\n+    \"name\": \"nullValidator\"\n+  },\n   {\n     \"name\": \"observable\"\n   },\n@@ -1397,6 +1403,9 @@\n   {\n     \"name\": \"renderView\"\n   },\n+  {\n+    \"name\": \"requiredValidator\"\n+  },\n   {\n     \"name\": \"resetPreOrderHookFlags\"\n   },"
        },
        {
            "sha": "40634492c6c52d5bdffdc16c663e18cd573276da",
            "filename": "packages/forms/src/directives/validators.ts",
            "status": "modified",
            "additions": 31,
            "deletions": 40,
            "changes": 71,
            "blob_url": "https://github.com/angular/angular/blob/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "raw_url": "https://github.com/angular/angular/raw/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts?ref=531d1cf9a3c034380bbdfe803606ff1c6e04eb8a",
            "patch": "@@ -15,22 +15,33 @@ import {emailValidator, maxLengthValidator, maxValidator, minLengthValidator, mi\n /**\n  * Method that updates string to integer if not already a number\n  *\n- * @param value The value to convert to integer\n- * @returns value of parameter in number or integer.\n+ * @param value The value to convert to integer.\n+ * @returns value of parameter converted to number or integer.\n  */\n function toInteger(value: string|number): number {\n   return typeof value === 'number' ? value : parseInt(value, 10);\n }\n \n+/**\n+ * Method that converts null, false or 'false' string to boolean.\n+ *\n+ * @param value input value.\n+ * @returns value of parameter converted to boolean.\n+ */\n+function toBoolean(input: unknown): boolean {\n+  return input != null && input !== false && `${input}` !== 'false';\n+}\n+\n /**\n  * Method that ensures that provided value is a float (and converts it to float if needed).\n  *\n- * @param value The value to convert to float\n- * @returns value of parameter in number or float.\n+ * @param value The value to convert to float.\n+ * @returns value of parameter converted to number or float.\n  */\n function toFloat(value: string|number): number {\n   return typeof value === 'number' ? value : parseFloat(value);\n }\n+\n /**\n  * @description\n  * Defines the map of errors returned from failed validation checks.\n@@ -356,41 +367,27 @@ export const CHECKBOX_REQUIRED_VALIDATOR: StaticProvider = {\n   selector:\n       ':not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]',\n   providers: [REQUIRED_VALIDATOR],\n-  host: {'[attr.required]': 'required ? \"\" : null'}\n+  host: {'[attr.required]': '_enabled ? \"\" : null'}\n })\n-export class RequiredValidator implements Validator {\n-  private _required = false;\n-  private _onChange?: () => void;\n-\n+export class RequiredValidator extends AbstractValidatorDirective {\n   /**\n    * @description\n    * Tracks changes to the required attribute bound to this directive.\n    */\n-  @Input()\n-  get required(): boolean|string {\n-    return this._required;\n-  }\n+  @Input() required!: boolean|string;\n \n-  set required(value: boolean|string) {\n-    this._required = value != null && value !== false && `${value}` !== 'false';\n-    if (this._onChange) this._onChange();\n-  }\n+  /** @internal */\n+  override inputName = 'required';\n \n-  /**\n-   * Method that validates whether the control is empty.\n-   * Returns the validation result if enabled, otherwise null.\n-   * @nodoc\n-   */\n-  validate(control: AbstractControl): ValidationErrors|null {\n-    return this.required ? requiredValidator(control) : null;\n-  }\n+  /** @internal */\n+  override normalizeInput = (input: unknown): boolean => toBoolean(input);\n \n-  /**\n-   * Registers a callback function to call when the validator inputs change.\n-   * @nodoc\n-   */\n-  registerOnValidatorChange(fn: () => void): void {\n-    this._onChange = fn;\n+  /** @internal */\n+  override createValidator = (input: boolean): ValidatorFn => requiredValidator;\n+\n+  /** @nodoc */\n+  override enabled(input: boolean): boolean {\n+    return input;\n   }\n }\n \n@@ -420,17 +417,11 @@ export class RequiredValidator implements Validator {\n   selector:\n       'input[type=checkbox][required][formControlName],input[type=checkbox][required][formControl],input[type=checkbox][required][ngModel]',\n   providers: [CHECKBOX_REQUIRED_VALIDATOR],\n-  host: {'[attr.required]': 'required ? \"\" : null'}\n+  host: {'[attr.required]': '_enabled ? \"\" : null'}\n })\n export class CheckboxRequiredValidator extends RequiredValidator {\n-  /**\n-   * Method that validates whether or not the checkbox has been checked.\n-   * Returns the validation result if enabled, otherwise null.\n-   * @nodoc\n-   */\n-  override validate(control: AbstractControl): ValidationErrors|null {\n-    return this.required ? requiredTrueValidator(control) : null;\n-  }\n+  /** @internal */\n+  override createValidator = (input: unknown): ValidatorFn => requiredTrueValidator;\n }\n \n /**"
        },
        {
            "sha": "8fd3936b532389214cab87b7b5ad02bf8784f4dd",
            "filename": "packages/forms/test/reactive_integration_spec.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts?ref=531d1cf9a3c034380bbdfe803606ff1c6e04eb8a",
            "patch": "@@ -2268,6 +2268,21 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n         expect(checkbox.nativeElement.checked).toBe(true);\n         expect(control.hasError('required')).toEqual(false);\n+\n+        checkbox.nativeElement.required = false;\n+        dispatchEvent(checkbox.nativeElement, 'change');\n+        fixture.detectChanges();\n+\n+        expect(checkbox.nativeElement.checked).toBe(true);\n+        expect(control.hasError('required')).toEqual(false);\n+\n+        checkbox.nativeElement.checked = false;\n+        checkbox.nativeElement.required = true;\n+        dispatchEvent(checkbox.nativeElement, 'change');\n+        fixture.detectChanges();\n+\n+        expect(checkbox.nativeElement.checked).toBe(false);\n+        expect(control.hasError('required')).toEqual(true);\n       });\n \n       // Note: this scenario goes against validator function rules were `null` is the only"
        },
        {
            "sha": "9a8b5bee1b8a18bea0578757c5b3246187f9b6fb",
            "filename": "packages/forms/test/template_integration_spec.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/packages%2Fforms%2Ftest%2Ftemplate_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/531d1cf9a3c034380bbdfe803606ff1c6e04eb8a/packages%2Fforms%2Ftest%2Ftemplate_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Ftemplate_integration_spec.ts?ref=531d1cf9a3c034380bbdfe803606ff1c6e04eb8a",
            "patch": "@@ -1315,6 +1315,14 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n \n            expect(input.nativeElement.checked).toBe(false);\n            expect(control.hasError('required')).toBe(true);\n+\n+           fixture.componentInstance.required = false;\n+           dispatchEvent(input.nativeElement, 'change');\n+           fixture.detectChanges();\n+           tick();\n+\n+           expect(input.nativeElement.checked).toBe(false);\n+           expect(control.hasError('required')).toBe(false);\n          }));\n \n       it('should validate email', fakeAsync(() => {"
        }
    ],
    "stats": {
        "total": 117,
        "additions": 69,
        "deletions": 48
    }
}