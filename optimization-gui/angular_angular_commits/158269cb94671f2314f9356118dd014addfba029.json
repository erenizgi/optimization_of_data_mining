{
    "author": "josephperrott",
    "message": "feat(dev-infra): automatically add labels to release PRs (#40016)\n\nAutomatically add provided labels to PRs created for release.\n\nPR Close #40016",
    "sha": "158269cb94671f2314f9356118dd014addfba029",
    "files": [
        {
            "sha": "8177c3c3e1a9cf137babb6f84e31ced2ccfe9110",
            "filename": ".ng-dev/release.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/158269cb94671f2314f9356118dd014addfba029/.ng-dev%2Frelease.ts",
            "raw_url": "https://github.com/angular/angular/raw/158269cb94671f2314f9356118dd014addfba029/.ng-dev%2Frelease.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/.ng-dev%2Frelease.ts?ref=158269cb94671f2314f9356118dd014addfba029",
            "patch": "@@ -32,7 +32,5 @@ export const release: ReleaseConfig = {\n   generateReleaseNotesForHead: async () => {\n     exec('yarn -s gulp changelog', {cwd: join(__dirname, '../')});\n   },\n-  // The `comp: *` labels will be automatically added by PullApprove and the targeting label will\n-  // be added by the release tooling, only `action: merge` must be manually included to the list.\n   releasePrLabels: ['comp: build & ci', 'action: merge', 'PullApprove: disable'],\n };"
        },
        {
            "sha": "eb699a79bb586918c15e0f6e2b67f3f455d7f2a5",
            "filename": "dev-infra/ng-dev.js",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/158269cb94671f2314f9356118dd014addfba029/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/158269cb94671f2314f9356118dd014addfba029/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=158269cb94671f2314f9356118dd014addfba029",
            "patch": "@@ -5676,6 +5676,10 @@ class ReleaseAction {\n             const { fork, branchName } = yield this._pushHeadToFork(proposedForkBranchName, true);\n             const { data } = yield this.git.github.pulls.create(Object.assign(Object.assign({}, this.git.remoteParams), { head: `${fork.owner}:${branchName}`, base: targetBranch, body,\n                 title }));\n+            // Add labels to the newly created PR if provided in the configuration.\n+            if (this.config.releasePrLabels !== undefined) {\n+                yield this.git.github.issues.addLabels(Object.assign(Object.assign({}, this.git.remoteParams), { issue_number: data.number, labels: this.config.releasePrLabels }));\n+            }\n             info(green(`  ✓   Created pull request #${data.number} in ${repoSlug}.`));\n             return {\n                 id: data.number,"
        },
        {
            "sha": "e8fb95909ab473479d5cf5000a481d8ab545fc89",
            "filename": "dev-infra/release/config/index.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/158269cb94671f2314f9356118dd014addfba029/dev-infra%2Frelease%2Fconfig%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/158269cb94671f2314f9356118dd014addfba029/dev-infra%2Frelease%2Fconfig%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fconfig%2Findex.ts?ref=158269cb94671f2314f9356118dd014addfba029",
            "patch": "@@ -34,6 +34,8 @@ export interface ReleaseConfig {\n    */\n   // TODO: Remove this in favor of a canonical changelog format across the Angular organization.\n   extractReleaseNotesPattern?: (version: semver.SemVer) => RegExp;\n+  /** The list of github labels to add to the release PRs. */\n+  releasePrLabels?: string[];\n }\n \n /** Configuration for releases in the dev-infra configuration. */"
        },
        {
            "sha": "fd55d6543b72e80cd7448c4d372e63a1f849c720",
            "filename": "dev-infra/release/publish/actions.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/158269cb94671f2314f9356118dd014addfba029/dev-infra%2Frelease%2Fpublish%2Factions.ts",
            "raw_url": "https://github.com/angular/angular/raw/158269cb94671f2314f9356118dd014addfba029/dev-infra%2Frelease%2Fpublish%2Factions.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Factions.ts?ref=158269cb94671f2314f9356118dd014addfba029",
            "patch": "@@ -282,6 +282,15 @@ export abstract class ReleaseAction {\n       title,\n     });\n \n+    // Add labels to the newly created PR if provided in the configuration.\n+    if (this.config.releasePrLabels !== undefined) {\n+      await this.git.github.issues.addLabels({\n+        ...this.git.remoteParams,\n+        issue_number: data.number,\n+        labels: this.config.releasePrLabels,\n+      });\n+    }\n+\n     info(green(`  ✓   Created pull request #${data.number} in ${repoSlug}.`));\n     return {\n       id: data.number,"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 15,
        "deletions": 2
    }
}