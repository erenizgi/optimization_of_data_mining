{
    "author": "dario-piotrowicz",
    "message": "docs(animations): improve animation transition api docs (#44396)\n\nimprove the transition api docs by removing unnecessary examplanations\nand examples\n\nalso provide helpful information regarding entering and leaving\nelements (as part of #44253)\n\nPR Close #44396",
    "sha": "92495060d2baadf58586b74f378e18eff698b30b",
    "files": [
        {
            "sha": "90b9cac4436be7cfb3aecbbb0be9e36adc5653ef",
            "filename": "packages/animations/src/animation_metadata.ts",
            "status": "modified",
            "additions": 122,
            "deletions": 144,
            "changes": 266,
            "blob_url": "https://github.com/angular/angular/blob/92495060d2baadf58586b74f378e18eff698b30b/packages%2Fanimations%2Fsrc%2Fanimation_metadata.ts",
            "raw_url": "https://github.com/angular/angular/raw/92495060d2baadf58586b74f378e18eff698b30b/packages%2Fanimations%2Fsrc%2Fanimation_metadata.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fanimations%2Fsrc%2Fanimation_metadata.ts?ref=92495060d2baadf58586b74f378e18eff698b30b",
            "patch": "@@ -871,170 +871,148 @@ export function keyframes(steps: AnimationStyleMetadata[]): AnimationKeyframesSe\n }\n \n /**\n- * Declares an animation transition as a sequence of animation steps to run when a given\n- * condition is satisfied. The condition is a Boolean expression or function that compares\n- * the previous and current animation states, and returns true if this transition should occur.\n- * When the state criteria of a defined transition are met, the associated animation is\n- * triggered.\n- *\n- * @param stateChangeExpr A Boolean expression or function that compares the previous and current\n- * animation states, and returns true if this transition should occur. Note that  \"true\" and \"false\"\n- * match 1 and 0, respectively. An expression is evaluated each time a state change occurs in the\n- * animation trigger element.\n- * The animation steps run when the expression evaluates to true.\n- *\n- * - A state-change string takes the form \"state1 => state2\", where each side is a defined animation\n- * state, or an asterisk (*) to refer to a dynamic start or end state.\n- *   - The expression string can contain multiple comma-separated statements;\n- * for example \"state1 => state2, state3 => state4\".\n- *   - Special values `:enter` and `:leave` initiate a transition on the entry and exit states,\n- * equivalent to  \"void => *\"  and \"* => void\".\n- *   - Special values `:increment` and `:decrement` initiate a transition when a numeric value has\n- * increased or decreased in value.\n- * - A function is executed each time a state change occurs in the animation trigger element.\n- * The animation steps run when the function returns true.\n- *\n- * @param steps One or more animation objects, as returned by the `animate()` or\n- * `sequence()` function, that form a transformation from one state to another.\n- * A sequence is used by default when you pass an array.\n- * @param options An options object that can contain a delay value for the start of the animation,\n- * and additional developer-defined parameters. Provided values for additional parameters are used\n- * as defaults, and override values can be passed to the caller on invocation.\n- * @returns An object that encapsulates the transition data.\n+ * Declares an animation transition which is played when a certain specified condition is met.\n  *\n- * @usageNotes\n- * The template associated with a component binds an animation trigger to an element.\n+ * @param stateChangeExpr A string with a specific format or a function that specifies when the\n+ * animation transition should occur (see [State Change Expression](#state-change-expression)).\n  *\n- * ```HTML\n- * <!-- somewhere inside of my-component-tpl.html -->\n- * <div [@myAnimationTrigger]=\"myStatusExp\">...</div>\n- * ```\n+ * @param steps One or more animation objects that represent the animation's instructions.\n  *\n- * All transitions are defined within an animation trigger,\n- * along with named states that the transitions change to and from.\n+ * @param options An options object that can be used to specify a delay for the animation or provide\n+ * custom parameters for it.\n  *\n- * ```typescript\n- * trigger(\"myAnimationTrigger\", [\n- *  // define states\n- *  state(\"on\", style({ background: \"green\" })),\n- *  state(\"off\", style({ background: \"grey\" })),\n- *  ...]\n- * ```\n- *\n- * Note that when you call the `sequence()` function within a `{@link animations/group group()}`\n- * or a `transition()` call, execution does not continue to the next instruction\n- * until each of the inner animation steps have completed.\n- *\n- * ### Syntax examples\n- *\n- * The following examples define transitions between the two defined states (and default states),\n- * using various options:\n- *\n- * ```typescript\n- * // Transition occurs when the state value\n- * // bound to \"myAnimationTrigger\" changes from \"on\" to \"off\"\n- * transition(\"on => off\", animate(500))\n- * // Run the same animation for both directions\n- * transition(\"on <=> off\", animate(500))\n- * // Define multiple state-change pairs separated by commas\n- * transition(\"on => off, off => void\", animate(500))\n- * ```\n- *\n- * ### Special values for state-change expressions\n- *\n- * - Catch-all state change for when an element is inserted into the page and the\n- * destination state is unknown:\n+ * @returns An object that encapsulates the transition data.\n  *\n- * ```typescript\n- * transition(\"void => *\", [\n- *  style({ opacity: 0 }),\n- *  animate(500)\n- *  ])\n- * ```\n+ * @usageNotes\n  *\n- * - Capture a state change between any states:\n+ * ### State Change Expression\n+ *\n+ * The State Change Expression instructs Angular when to run the transition's animations, it can\n+ *either be\n+ *  - a string with a specific syntax\n+ *  - or a function that compares the previous and current state (value of the expression bound to\n+ *    the element's trigger) and returns `true` if the transition should occur or `false` otherwise\n+ *\n+ * The string format can be:\n+ *  - `fromState => toState`, which indicates that the transition's animations should occur then the\n+ *    expression bound to the trigger's element goes from `fromState` to `toState`\n+ *\n+ *    _Example:_\n+ *      ```typescript\n+ *        transition('open => closed', animate('.5s ease-out', style({ height: 0 }) ))\n+ *      ```\n+ *\n+ *  - `fromState <=> toState`, which indicates that the transition's animations should occur then\n+ *    the expression bound to the trigger's element goes from `fromState` to `toState` or vice versa\n+ *\n+ *    _Example:_\n+ *      ```typescript\n+ *        transition('enabled <=> disabled', animate('1s cubic-bezier(0.8,0.3,0,1)'))\n+ *      ```\n+ *\n+ *  - `:enter`/`:leave`, which indicates that the transition's animations should occur when the\n+ *    element enters or exists the DOM\n+ *\n+ *    _Example:_\n+ *      ```typescript\n+ *        transition(':enter', [\n+ *          style({ opacity: 0 }),\n+ *          animate('500ms', style({ opacity: 1 }))\n+ *        ])\n+ *      ```\n+ *\n+ *  - `:increment`/`:decrement`, which indicates that the transition's animations should occur when\n+ *    the numerical expression bound to the trigger's element has increased in value or decreased\n+ *\n+ *    _Example:_\n+ *      ```typescript\n+ *        transition(':increment', query('@counter', animateChild()))\n+ *      ```\n+ *\n+ *  - a sequence of any of the above divided by commas, which indicates that transition's animations\n+ *    should occur whenever one of the state change expressions matches\n+ *\n+ *    _Example:_\n+ *      ```typescript\n+ *        transition(':increment, * => enabled, :enter', animate('1s ease', keyframes([\n+ *          style({ transform: 'scale(1)', offset: 0}),\n+ *          style({ transform: 'scale(1.1)', offset: 0.7}),\n+ *          style({ transform: 'scale(1)', offset: 1})\n+ *        ]))),\n+ *      ```\n+ *\n+ * Also note that in such context:\n+ *  - `void` can be used to indicate the absence of the element\n+ *  - asterisks can be used as wildcards that match any state\n+ *  - (as a consequence of the above, `void => *` is equivalent to `:enter` and `* => void` is\n+ *    equivalent to `:leave`)\n+ *  - `true` and `false` also match expression values of `1` and `0` respectively (but do not match\n+ *    _truthy_ and _falsy_ values)\n  *\n- *  `transition(\"* => *\", animate(\"1s 0s\"))`\n+ * <div class=\"alert is-helpful\">\n  *\n- * - Entry and exit transitions:\n+ *  Be careful about entering end leaving elements as their transitions present a common\n+ *  pitfall for developers.\n  *\n- * ```typescript\n- * transition(\":enter\", [\n- *   style({ opacity: 0 }),\n- *   animate(500, style({ opacity: 1 }))\n- *   ]),\n- * transition(\":leave\", [\n- *   animate(500, style({ opacity: 0 }))\n- *   ])\n- * ```\n+ *  Note that when an element with a trigger enters the DOM its `:enter` transition always\n+ *  gets executed, but its `:leave` transition will not be executed if the element is removed\n+ *  alongside its parent (as it will be removed \"without warning\" before its transition has\n+ *  a chance to be executed, the only way that such transition can occur is if the element\n+ *  is exiting the DOM on its own).\n  *\n- * - Use `:increment` and `:decrement` to initiate transitions:\n  *\n- * ```typescript\n- * transition(\":increment\", group([\n- *  query(':enter', [\n- *     style({ left: '100%' }),\n- *     animate('0.5s ease-out', style('*'))\n- *   ]),\n- *  query(':leave', [\n- *     animate('0.5s ease-out', style({ left: '-100%' }))\n- *  ])\n- * ]))\n+ * </div>\n  *\n- * transition(\":decrement\", group([\n- *  query(':enter', [\n- *     style({ left: '100%' }),\n- *     animate('0.5s ease-out', style('*'))\n- *   ]),\n- *  query(':leave', [\n- *     animate('0.5s ease-out', style({ left: '-100%' }))\n- *  ])\n- * ]))\n- * ```\n+ * ### Animating to a Final State\n  *\n- * ### State-change functions\n+ * If the final step in a transition is a call to `animate()` that uses a timing value\n+ * with no `style` data, that step is automatically considered the final animation arc,\n+ * for the element to reach the final state, in such case Angular automatically adds or removes\n+ * CSS styles to ensure that the element is in the correct final state.\n  *\n- * Here is an example of a `fromState` specified as a state-change function that invokes an\n- * animation when true:\n  *\n- * ```typescript\n- * transition((fromState, toState) =>\n- *  {\n- *   return fromState == \"off\" && toState == \"on\";\n- *  },\n- *  animate(\"1s 0s\"))\n- * ```\n+ * ### Usage Examples\n  *\n- * ### Animating to the final state\n+ *  - Transition animations applied based on\n+ *    the trigger's expression value\n  *\n- * If the final step in a transition is a call to `animate()` that uses a timing value\n- * with no style data, that step is automatically considered the final animation arc,\n- * for the element to reach the final state. Angular automatically adds or removes\n- * CSS styles to ensure that the element is in the correct final state.\n+ *   ```HTML\n+ *   <div [@myAnimationTrigger]=\"myStatusExp\">\n+ *    ...\n+ *   </div>\n+ *   ```\n  *\n- * The following example defines a transition that starts by hiding the element,\n- * then makes sure that it animates properly to whatever state is currently active for trigger:\n+ *   ```typescript\n+ *   trigger(\"myAnimationTrigger\", [\n+ *     ..., // states\n+ *     transition(\"on => off, open => closed\", animate(500)),\n+ *     transition(\"* <=> error\", query('.indicator', animateChild()))\n+ *   ])\n+ *   ```\n  *\n- * ```typescript\n- * transition(\"void => *\", [\n- *   style({ opacity: 0 }),\n- *   animate(500)\n- *  ])\n- * ```\n- * ### Boolean value matching\n- * If a trigger binding value is a Boolean, it can be matched using a transition expression\n- * that compares true and false or 1 and 0. For example:\n+ *  - Transition animations applied based on custom logic dependent\n+ *    on the trigger's expression value and provided parameters\n  *\n- * ```\n- * // in the template\n- * <div [@openClose]=\"open ? true : false\">...</div>\n- * // in the component metadata\n- * trigger('openClose', [\n- *   state('true', style({ height: '*' })),\n- *   state('false', style({ height: '0px' })),\n- *   transition('false <=> true', animate(500))\n- * ])\n- * ```\n+ *    ```HTML\n+ *    <div [@myAnimationTrigger]=\"{\n+ *     value: stepName,\n+ *     params: { target: currentTarget }\n+ *    }\">\n+ *     ...\n+ *    </div>\n+ *    ```\n+ *\n+ *    ```typescript\n+ *    trigger(\"myAnimationTrigger\", [\n+ *      ..., // states\n+ *      transition(\n+ *        (fromState, toState, _element, params) =>\n+ *          ['firststep', 'laststep'].includes(fromState.toLowerCase())\n+ *          && toState === params?.['target'],\n+ *        animate('1s')\n+ *      )\n+ *    ])\n+ *    ```\n  *\n  * @publicApi\n  **/"
        }
    ],
    "stats": {
        "total": 266,
        "additions": 122,
        "deletions": 144
    }
}