{
    "author": "kirjs",
    "message": "fix(platform-browser): improve error message for missing animation trigger (#41356)\n\nThere are two reasons why this error can be called, but only one was covered before.\n\nFixes #15581\n\nPR Close #41356",
    "sha": "35725f5550e305762038f154f1c9a0b9e809c883",
    "files": [
        {
            "sha": "c5e9f2f92f71ab4cea9650bc0b1b9ed3796d2592",
            "filename": "packages/core/test/animation/animation_integration_spec.ts",
            "status": "modified",
            "additions": 54,
            "deletions": 18,
            "changes": 72,
            "blob_url": "https://github.com/angular/angular/blob/35725f5550e305762038f154f1c9a0b9e809c883/packages%2Fcore%2Ftest%2Fanimation%2Fanimation_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/35725f5550e305762038f154f1c9a0b9e809c883/packages%2Fcore%2Ftest%2Fanimation%2Fanimation_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Fanimation%2Fanimation_integration_spec.ts?ref=35725f5550e305762038f154f1c9a0b9e809c883",
            "patch": "@@ -3827,29 +3827,65 @@ describe('animation tests', function() {\n       });\n     });\n \n-    it('should throw when using an @prop binding without the animation module', () => {\n-      @Component({template: `<div [@myAnimation]=\"true\"></div>`})\n-      class Cmp {\n-      }\n \n-      TestBed.configureTestingModule({declarations: [Cmp]});\n-      const comp = TestBed.createComponent(Cmp);\n-      expect(() => comp.detectChanges())\n-          .toThrowError(\n-              'Found the synthetic property @myAnimation. Please include either \"BrowserAnimationsModule\" or \"NoopAnimationsModule\" in your application.');\n+    function syntheticPropError(name: string, nameKind: string) {\n+      return `Unexpected synthetic ${nameKind} ${name} found. Please make sure that:\n+  - Either \\`BrowserAnimationsModule\\` or \\`NoopAnimationsModule\\` are imported in your application.\n+  - There is corresponding configuration for the animation named \\`${\n+          name}\\` defined in the \\`animations\\` field of the \\`@Component\\` decorator (see https://angular.io/api/core/Component#animations).`;\n+    }\n+\n+    describe('when modules are missing', () => {\n+      it('should throw when using an @prop binding without the animation module', () => {\n+        @Component({template: `<div [@myAnimation]=\"true\"></div>`})\n+        class Cmp {\n+        }\n+\n+        TestBed.configureTestingModule({declarations: [Cmp]});\n+        const comp = TestBed.createComponent(Cmp);\n+        expect(() => comp.detectChanges())\n+            .toThrowError(syntheticPropError('@myAnimation', 'property'));\n+      });\n+\n+      it('should throw when using an @prop listener without the animation module', () => {\n+        @Component({template: `<div (@myAnimation.start)=\"a = true\"></div>`})\n+        class Cmp {\n+          a = false;\n+        }\n+\n+        TestBed.configureTestingModule({declarations: [Cmp]});\n+\n+        expect(() => TestBed.createComponent(Cmp))\n+            .toThrowError(syntheticPropError('@myAnimation.start', 'listener'));\n+      });\n     });\n \n-    it('should throw when using an @prop listener without the animation module', () => {\n-      @Component({template: `<div (@myAnimation.start)=\"a = true\"></div>`})\n-      class Cmp {\n-        a: any;\n-      }\n+    describe('when modules are present, but animations are missing', () => {\n+      it('should throw when using an @prop property, BrowserAnimationModule is imported, but there is no animation rule',\n+         () => {\n+           @Component({template: `<div [@myAnimation]=\"true\"></div>`})\n+           class Cmp {\n+           }\n \n-      TestBed.configureTestingModule({declarations: [Cmp]});\n+           TestBed.configureTestingModule(\n+               {declarations: [Cmp], imports: [BrowserAnimationsModule]});\n+           const comp = TestBed.createComponent(Cmp);\n+           expect(() => comp.detectChanges())\n+               .toThrowError(syntheticPropError('@myAnimation', 'property'));\n+         });\n \n-      expect(() => TestBed.createComponent(Cmp))\n-          .toThrowError(\n-              'Found the synthetic listener @myAnimation.start. Please include either \"BrowserAnimationsModule\" or \"NoopAnimationsModule\" in your application.');\n+      it('should throw when using an @prop listener, BrowserAnimationModule is imported, but there is no animation rule',\n+         () => {\n+           @Component({template: `<div (@myAnimation.start)=\"true\"></div>`})\n+           class Cmp {\n+           }\n+\n+           TestBed.configureTestingModule(\n+               {declarations: [Cmp], imports: [BrowserAnimationsModule]});\n+\n+           expect(() => TestBed.createComponent(Cmp))\n+               .toThrowError(syntheticPropError('@myAnimation.start', 'listener'));\n+         });\n     });\n   });\n });"
        },
        {
            "sha": "c4669275ba0c8d02d0c6763957ebd910f8549643",
            "filename": "packages/platform-browser/src/dom/dom_renderer.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/35725f5550e305762038f154f1c9a0b9e809c883/packages%2Fplatform-browser%2Fsrc%2Fdom%2Fdom_renderer.ts",
            "raw_url": "https://github.com/angular/angular/raw/35725f5550e305762038f154f1c9a0b9e809c883/packages%2Fplatform-browser%2Fsrc%2Fdom%2Fdom_renderer.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fplatform-browser%2Fsrc%2Fdom%2Fdom_renderer.ts?ref=35725f5550e305762038f154f1c9a0b9e809c883",
            "patch": "@@ -280,8 +280,10 @@ class DefaultDomRenderer2 implements Renderer2 {\n const AT_CHARCODE = (() => '@'.charCodeAt(0))();\n function checkNoSyntheticProp(name: string, nameKind: string) {\n   if (name.charCodeAt(0) === AT_CHARCODE) {\n-    throw new Error(`Found the synthetic ${nameKind} ${\n-        name}. Please include either \"BrowserAnimationsModule\" or \"NoopAnimationsModule\" in your application.`);\n+    throw new Error(`Unexpected synthetic ${nameKind} ${name} found. Please make sure that:\n+  - Either \\`BrowserAnimationsModule\\` or \\`NoopAnimationsModule\\` are imported in your application.\n+  - There is corresponding configuration for the animation named \\`${\n+        name}\\` defined in the \\`animations\\` field of the \\`@Component\\` decorator (see https://angular.io/api/core/Component#animations).`);\n   }\n }\n "
        },
        {
            "sha": "c1e72e5dc70c0591de7f9af0f12a8f023059c765",
            "filename": "packages/platform-server/src/server_renderer.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/35725f5550e305762038f154f1c9a0b9e809c883/packages%2Fplatform-server%2Fsrc%2Fserver_renderer.ts",
            "raw_url": "https://github.com/angular/angular/raw/35725f5550e305762038f154f1c9a0b9e809c883/packages%2Fplatform-server%2Fsrc%2Fserver_renderer.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fplatform-server%2Fsrc%2Fserver_renderer.ts?ref=35725f5550e305762038f154f1c9a0b9e809c883",
            "patch": "@@ -241,8 +241,10 @@ class DefaultServerRenderer2 implements Renderer2 {\n const AT_CHARCODE = '@'.charCodeAt(0);\n function checkNoSyntheticProp(name: string, nameKind: string) {\n   if (name.charCodeAt(0) === AT_CHARCODE) {\n-    throw new Error(`Found the synthetic ${nameKind} ${\n-        name}. Please include either \"BrowserAnimationsModule\" or \"NoopAnimationsModule\" in your application.`);\n+    throw new Error(`Unexpected synthetic ${nameKind} ${name} found. Please make sure that:\n+  - Either \\`BrowserAnimationsModule\\` or \\`NoopAnimationsModule\\` are imported in your application.\n+  - There is corresponding configuration for the animation named \\`${\n+        name}\\` defined in the \\`animations\\` field of the \\`@Component\\` decorator (see https://angular.io/api/core/Component#animations).`);\n   }\n }\n "
        }
    ],
    "stats": {
        "total": 84,
        "additions": 62,
        "deletions": 22
    }
}