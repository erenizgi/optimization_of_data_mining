{
    "author": "devversion",
    "message": "feat(dev-infra): add logic for printing active release trains (#38656)\n\nAdds a method for printing active release trains for a configured\nproject. This is helpful for the release tool that will print\nthe active release trains. Also this can be useful for the\ncaretaker status command, where we could print the active\nversion branches (i.e. \"is there currently a feature-freeze branch\").\n\nPR Close #38656",
    "sha": "474ecf6d0009f044649dbd79c1e89ca181e44c7a",
    "files": [
        {
            "sha": "f0e740c32ac06f495cff230565c2a03e422a0efc",
            "filename": "dev-infra/release/versioning/print-active-trains.ts",
            "status": "added",
            "additions": 80,
            "deletions": 0,
            "changes": 80,
            "blob_url": "https://github.com/angular/angular/blob/474ecf6d0009f044649dbd79c1e89ca181e44c7a/dev-infra%2Frelease%2Fversioning%2Fprint-active-trains.ts",
            "raw_url": "https://github.com/angular/angular/raw/474ecf6d0009f044649dbd79c1e89ca181e44c7a/dev-infra%2Frelease%2Fversioning%2Fprint-active-trains.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fversioning%2Fprint-active-trains.ts?ref=474ecf6d0009f044649dbd79c1e89ca181e44c7a",
            "patch": "@@ -0,0 +1,80 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+import {blue, bold, info} from '../../utils/console';\n+import {ReleaseConfig} from '../config/index';\n+\n+import {ActiveReleaseTrains} from './active-release-trains';\n+import {fetchLongTermSupportBranchesFromNpm} from './long-term-support';\n+import {isVersionPublishedToNpm} from './npm-registry';\n+\n+/**\n+ * Prints the active release trains to the console.\n+ * @params active Active release trains that should be printed.\n+ * @params config Release configuration used for querying NPM on published versions.\n+ */\n+export async function printActiveReleaseTrains(\n+    active: ActiveReleaseTrains, config: ReleaseConfig): Promise<void> {\n+  const {releaseCandidate, next, latest} = active;\n+  const isNextPublishedToNpm = await isVersionPublishedToNpm(next.version, config);\n+  const nextTrainType = next.isMajor ? 'major' : 'minor';\n+  const ltsBranches = await fetchLongTermSupportBranchesFromNpm(config);\n+\n+  info();\n+  info(blue('Current version branches in the project:'));\n+\n+  // Print information for release trains in the feature-freeze/release-candidate phase.\n+  if (releaseCandidate !== null) {\n+    const rcVersion = releaseCandidate.version;\n+    const rcTrainType = releaseCandidate.isMajor ? 'major' : 'minor';\n+    const rcTrainPhase =\n+        rcVersion.prerelease[0] === 'next' ? 'feature-freeze' : 'release-candidate';\n+    info(\n+        ` • ${bold(releaseCandidate.branchName)} contains changes for an upcoming ` +\n+        `${rcTrainType} that is currently in ${bold(rcTrainPhase)} phase.`);\n+    info(`   Most recent pre-release for this branch is \"${bold(`v${rcVersion}`)}\".`);\n+  }\n+\n+  // Print information about the release-train in the latest phase. i.e. the patch branch.\n+  info(` • ${bold(latest.branchName)} contains changes for the most recent patch.`);\n+  info(`   Most recent patch version for this branch is \"${bold(`v${latest.version}`)}\".`);\n+\n+  // Print information about the release-train in the next phase.\n+  info(\n+      ` • ${bold(next.branchName)} contains changes for a ${nextTrainType} ` +\n+      `currently in active development.`);\n+  // Note that there is a special case for versions in the next release-train. The version in\n+  // the next branch is not always published to NPM. This can happen when we recently branched\n+  // off for a feature-freeze release-train. More details are in the next pre-release action.\n+  if (isNextPublishedToNpm) {\n+    info(`   Most recent pre-release version for this branch is \"${bold(`v${next.version}`)}\".`);\n+  } else {\n+    info(\n+        `   Version is currently set to \"${bold(`v${next.version}`)}\", but has not been ` +\n+        `published yet.`);\n+  }\n+\n+  // If no release-train in release-candidate of feature-freeze phase is active,\n+  // we print a message as last bullet point to make this clear.\n+  if (releaseCandidate === null) {\n+    info(` • No release-candidate or feature-freeze branch currently active.`);\n+  }\n+\n+  info();\n+  info(blue(`Current active LTS version branches:`));\n+\n+  // Print all active LTS branches (each branch as own bullet point).\n+  if (ltsBranches.active.length !== 0) {\n+    for (const ltsBranch of ltsBranches.active) {\n+      info(` • ${bold(ltsBranch.name)} is currently in active long-term support phase.`);\n+      info(`   Most recent patch version for this branch is \"${bold(`v${ltsBranch.version}`)}\".`);\n+    }\n+  }\n+\n+  info();\n+}"
        },
        {
            "sha": "41d2c8a3a513909138d1ed7a5ffe3c7d3751e6b4",
            "filename": "dev-infra/utils/console.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/474ecf6d0009f044649dbd79c1e89ca181e44c7a/dev-infra%2Futils%2Fconsole.ts",
            "raw_url": "https://github.com/angular/angular/raw/474ecf6d0009f044649dbd79c1e89ca181e44c7a/dev-infra%2Futils%2Fconsole.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2Fconsole.ts?ref=474ecf6d0009f044649dbd79c1e89ca181e44c7a",
            "patch": "@@ -20,6 +20,7 @@ export const red: typeof chalk = chalk.red;\n export const green: typeof chalk = chalk.green;\n export const yellow: typeof chalk = chalk.yellow;\n export const bold: typeof chalk = chalk.bold;\n+export const blue: typeof chalk = chalk.blue;\n \n /** Prompts the user with a confirmation question and a specified message. */\n export async function promptConfirm(message: string, defaultValue = false): Promise<boolean> {"
        }
    ],
    "stats": {
        "total": 81,
        "additions": 81,
        "deletions": 0
    }
}