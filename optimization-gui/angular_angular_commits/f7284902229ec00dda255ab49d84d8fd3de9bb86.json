{
    "author": "josephperrott",
    "message": "fix(compiler): update type castings for JSON.parse usage (#40710)\n\nUpdate usages of JSON.parse to be cast as specific types.\n\nPR Close #40710",
    "sha": "f7284902229ec00dda255ab49d84d8fd3de9bb86",
    "files": [
        {
            "sha": "64da4af375cc33b3a9995fb05d26312efe23a3b8",
            "filename": "modules/playground/e2e_test/example_test.bzl",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/f7284902229ec00dda255ab49d84d8fd3de9bb86/modules%2Fplayground%2Fe2e_test%2Fexample_test.bzl",
            "raw_url": "https://github.com/angular/angular/raw/f7284902229ec00dda255ab49d84d8fd3de9bb86/modules%2Fplayground%2Fe2e_test%2Fexample_test.bzl",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/modules%2Fplayground%2Fe2e_test%2Fexample_test.bzl?ref=f7284902229ec00dda255ab49d84d8fd3de9bb86",
            "patch": "@@ -1,6 +1,6 @@\n load(\"//tools:defaults.bzl\", \"protractor_web_test_suite\", \"ts_library\")\n \n-def example_test(name, srcs, server, data = [], **kwargs):\n+def example_test(name, srcs, server, data = [], deps = [], **kwargs):\n     ts_library(\n         name = \"%s_lib\" % name,\n         testonly = True,\n@@ -12,7 +12,7 @@ def example_test(name, srcs, server, data = [], **kwargs):\n             \"@npm//@types/jasminewd2\",\n             \"@npm//@types/selenium-webdriver\",\n             \"@npm//protractor\",\n-        ],\n+        ] + deps,\n     )\n \n     protractor_web_test_suite("
        },
        {
            "sha": "94ec11168064cf91501dcc105a5c5478bf81a044",
            "filename": "modules/playground/e2e_test/sourcemap/BUILD.bazel",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/f7284902229ec00dda255ab49d84d8fd3de9bb86/modules%2Fplayground%2Fe2e_test%2Fsourcemap%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/f7284902229ec00dda255ab49d84d8fd3de9bb86/modules%2Fplayground%2Fe2e_test%2Fsourcemap%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/modules%2Fplayground%2Fe2e_test%2Fsourcemap%2FBUILD.bazel?ref=f7284902229ec00dda255ab49d84d8fd3de9bb86",
            "patch": "@@ -8,4 +8,7 @@ example_test(\n         \"//modules/playground/src/sourcemap:index.ts\",\n     ],\n     server = \"//modules/playground/src/sourcemap:devserver\",\n+    deps = [\n+        \"@npm//source-map\",\n+    ],\n )"
        },
        {
            "sha": "adcd57101241f7dbc3214959093ab9ea75572669",
            "filename": "modules/playground/e2e_test/sourcemap/sourcemap_spec.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 9,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/f7284902229ec00dda255ab49d84d8fd3de9bb86/modules%2Fplayground%2Fe2e_test%2Fsourcemap%2Fsourcemap_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/f7284902229ec00dda255ab49d84d8fd3de9bb86/modules%2Fplayground%2Fe2e_test%2Fsourcemap%2Fsourcemap_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/modules%2Fplayground%2Fe2e_test%2Fsourcemap%2Fsourcemap_spec.ts?ref=f7284902229ec00dda255ab49d84d8fd3de9bb86",
            "patch": "@@ -6,11 +6,10 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n+import {readFileSync} from 'fs';\n import {$, browser} from 'protractor';\n import {logging} from 'selenium-webdriver';\n-\n-const fs = require('fs');\n-const sourceMap = require('source-map');\n+import {RawSourceMap, SourceMapConsumer} from 'source-map';\n \n describe('sourcemaps', function() {\n   const URL = '/';\n@@ -36,19 +35,18 @@ describe('sourcemaps', function() {\n \n \n       const content =\n-          fs.readFileSync(require.resolve('../../src/sourcemap/index.js')).toString('utf8');\n+          readFileSync(require.resolve('../../src/sourcemap/index.js')).toString('utf8');\n       const marker = '//# sourceMappingURL=data:application/json;base64,';\n       const index = content.indexOf(marker);\n       const sourceMapData =\n           Buffer.from(content.substring(index + marker.length), 'base64').toString('utf8');\n \n-      const decoder = new sourceMap.SourceMapConsumer(JSON.parse(sourceMapData));\n+      const decoder = new SourceMapConsumer(JSON.parse(sourceMapData) as RawSourceMap);\n \n       const originalPosition = decoder.originalPositionFor({line: errorLine, column: errorColumn});\n-\n-      const sourceCodeLines = fs.readFileSync(require.resolve('../../src/sourcemap/index.ts'), {\n-                                  encoding: 'UTF-8'\n-                                }).split('\\n');\n+      const sourceCodeLines = readFileSync(require.resolve('../../src/sourcemap/index.ts'), {\n+                                encoding: 'UTF-8'\n+                              }).split('\\n');\n       expect(sourceCodeLines[originalPosition.line - 1])\n           .toMatch(/throw new Error\\(\\'Sourcemap test\\'\\)/);\n     });"
        },
        {
            "sha": "956910f3116325df58eb8a0bcbac4fc94bead862",
            "filename": "packages/compiler/src/aot/summary_serializer.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/f7284902229ec00dda255ab49d84d8fd3de9bb86/packages%2Fcompiler%2Fsrc%2Faot%2Fsummary_serializer.ts",
            "raw_url": "https://github.com/angular/angular/raw/f7284902229ec00dda255ab49d84d8fd3de9bb86/packages%2Fcompiler%2Fsrc%2Faot%2Fsummary_serializer.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fsummary_serializer.ts?ref=f7284902229ec00dda255ab49d84d8fd3de9bb86",
            "patch": "@@ -461,7 +461,7 @@ class FromJsonDeserializer extends ValueTransformer {\n     summaries: Summary<StaticSymbol>[],\n     importAs: {symbol: StaticSymbol, importAs: StaticSymbol}[]\n   } {\n-    const data: {moduleName: string|null, summaries: any[], symbols: any[]} = JSON.parse(json);\n+    const data = JSON.parse(json) as {moduleName: string | null, summaries: any[], symbols: any[]};\n     const allImportAs: {symbol: StaticSymbol, importAs: StaticSymbol}[] = [];\n     this.symbols = data.symbols.map(\n         (serializedSymbol) => this.symbolCache.get("
        },
        {
            "sha": "bb37cf06fed46c1610fa6c8230d00f5aff56626b",
            "filename": "packages/compiler/test/aot/test_util.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/f7284902229ec00dda255ab49d84d8fd3de9bb86/packages%2Fcompiler%2Ftest%2Faot%2Ftest_util.ts",
            "raw_url": "https://github.com/angular/angular/raw/f7284902229ec00dda255ab49d84d8fd3de9bb86/packages%2Fcompiler%2Ftest%2Faot%2Ftest_util.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Ftest%2Faot%2Ftest_util.ts?ref=f7284902229ec00dda255ab49d84d8fd3de9bb86",
            "patch": "@@ -427,7 +427,7 @@ export class MockAotCompilerHost implements AotCompilerHost {\n       if (this.metadataVisible) {\n         const metadataPath = modulePath.replace(DTS, '.metadata.json');\n         if (this.tsHost.fileExists(metadataPath)) {\n-          let result = JSON.parse(this.tsHost.readFile(metadataPath));\n+          let result = JSON.parse(this.tsHost.readFile(metadataPath)) as {[key: string]: any}[];\n           return Array.isArray(result) ? result : [result];\n         }\n       }"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 14,
        "deletions": 13
    }
}