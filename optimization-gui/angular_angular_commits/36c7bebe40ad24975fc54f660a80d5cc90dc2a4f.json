{
    "author": "crisbeto",
    "message": "test(core): make tests more resilient to header offset changes (#41883)\n\nUpdates some tests where values related to the `HEADER_OFFSET` are hardcoded, causing them to break when the offset is updated. This comes up once in a while during refactorings and these changes should save us some time in the future.\n\nPR Close #41883",
    "sha": "36c7bebe40ad24975fc54f660a80d5cc90dc2a4f",
    "files": [
        {
            "sha": "b0648ad5c25368be86b8d81b59bce67c6cf1c698",
            "filename": "packages/core/test/acceptance/i18n_spec.ts",
            "status": "modified",
            "additions": 66,
            "deletions": 46,
            "changes": 112,
            "blob_url": "https://github.com/angular/angular/blob/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Facceptance%2Fi18n_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Facceptance%2Fi18n_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Facceptance%2Fi18n_spec.ts?ref=36c7bebe40ad24975fc54f660a80d5cc90dc2a4f",
            "patch": "@@ -652,12 +652,15 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n         const lViewDebug = lView.debug!;\n         fixture.detectChanges();\n         expect((fixture.nativeElement as Element).textContent).toEqual('just now');\n-        expect(lViewDebug.nodes.map(toTypeContent)).toEqual(['IcuContainer(<!--ICU 21:0-->)']);\n+        expect(lViewDebug.nodes.map(toTypeContent)).toEqual([\n+          `IcuContainer(<!--ICU ${HEADER_OFFSET + 0}:0-->)`\n+        ]);\n         // We want to ensure that the ICU container does not have any content!\n         // This is because the content is instance dependent and therefore can't be shared\n         // across `TNode`s.\n         expect(lViewDebug.nodes[0].children.map(toTypeContent)).toEqual([]);\n-        expect(fixture.nativeElement.innerHTML).toEqual('just now<!--ICU 21:0-->');\n+        expect(fixture.nativeElement.innerHTML)\n+            .toEqual(`just now<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n \n       it('should support multiple ICUs', () => {\n@@ -674,15 +677,16 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n         `);\n         const lView = getComponentLView(fixture.componentInstance);\n         expect(lView.debug!.nodes.map(toTypeContent)).toEqual([\n-          'IcuContainer(<!--ICU 21:0-->)',\n-          'IcuContainer(<!--ICU 22:0-->)',\n+          `IcuContainer(<!--ICU ${HEADER_OFFSET + 0}:0-->)`,\n+          `IcuContainer(<!--ICU ${HEADER_OFFSET + 1}:0-->)`,\n         ]);\n         // We want to ensure that the ICU container does not have any content!\n         // This is because the content is instance dependent and therefore can't be shared\n         // across `TNode`s.\n         expect(lView.debug!.nodes[0].children.map(toTypeContent)).toEqual([]);\n         expect(fixture.nativeElement.innerHTML)\n-            .toEqual('just now<!--ICU 21:0-->Mr. Angular<!--ICU 22:0-->');\n+            .toEqual(`just now<!--ICU ${HEADER_OFFSET + 0}:0-->Mr. Angular<!--ICU ${\n+                HEADER_OFFSET + 1}:0-->`);\n       });\n     });\n   });\n@@ -778,19 +782,21 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n         other {({{name}})}\n       }</div>`);\n       expect(fixture.nativeElement.innerHTML)\n-          .toEqual(`<div>aucun <b>email</b>!<!--ICU 22:0--> - (Angular)<!--ICU 22:3--></div>`);\n+          .toEqual(`<div>aucun <b>email</b>!<!--ICU ${HEADER_OFFSET + 1}:0--> - (Angular)<!--ICU ${\n+              HEADER_OFFSET + 1}:3--></div>`);\n \n       fixture.componentRef.instance.count = 4;\n       fixture.detectChanges();\n       expect(fixture.nativeElement.innerHTML)\n-          .toEqual(\n-              `<div>4 <span title=\"Angular\">emails</span><!--ICU 22:0--> - (Angular)<!--ICU 22:3--></div>`);\n+          .toEqual(`<div>4 <span title=\"Angular\">emails</span><!--ICU ${\n+              HEADER_OFFSET + 1}:0--> - (Angular)<!--ICU ${HEADER_OFFSET + 1}:3--></div>`);\n \n       fixture.componentRef.instance.count = 0;\n       fixture.componentRef.instance.name = 'John';\n       fixture.detectChanges();\n       expect(fixture.nativeElement.innerHTML)\n-          .toEqual(`<div>aucun <b>email</b>!<!--ICU 22:0--> - (John)<!--ICU 22:3--></div>`);\n+          .toEqual(`<div>aucun <b>email</b>!<!--ICU ${HEADER_OFFSET + 1}:0--> - (John)<!--ICU ${\n+              HEADER_OFFSET + 1}:3--></div>`);\n     });\n \n     it('with custom interpolation config', () => {\n@@ -829,19 +835,20 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n       expect(fixture.nativeElement.innerHTML)\n           .toEqual(\n               `<div>` +\n-              `<span>aucun <b>email</b>!<!--ICU 22:0--></span>` +\n+              `<span>aucun <b>email</b>!<!--ICU ${HEADER_OFFSET + 1}:0--></span>` +\n               ` - ` +\n-              `<span>(Angular)<!--ICU 22:3--></span>` +\n+              `<span>(Angular)<!--ICU ${HEADER_OFFSET + 1}:3--></span>` +\n               `</div>`);\n \n       fixture.componentRef.instance.count = 4;\n       fixture.detectChanges();\n       expect(fixture.nativeElement.innerHTML)\n           .toEqual(\n               `<div>` +\n-              `<span>4 <span title=\"Angular\">emails</span><!--ICU 22:0--></span>` +\n+              `<span>4 <span title=\"Angular\">emails</span><!--ICU ${\n+                  HEADER_OFFSET + 1}:0--></span>` +\n               ` - ` +\n-              `<span>(Angular)<!--ICU 22:3--></span>` +\n+              `<span>(Angular)<!--ICU ${HEADER_OFFSET + 1}:3--></span>` +\n               `</div>`);\n \n       fixture.componentRef.instance.count = 0;\n@@ -850,9 +857,9 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n       expect(fixture.nativeElement.innerHTML)\n           .toEqual(\n               `<div>` +\n-              `<span>aucun <b>email</b>!<!--ICU 22:0--></span>` +\n+              `<span>aucun <b>email</b>!<!--ICU ${HEADER_OFFSET + 1}:0--></span>` +\n               ` - ` +\n-              `<span>(John)<!--ICU 22:3--></span>` +\n+              `<span>(John)<!--ICU ${HEADER_OFFSET + 1}:3--></span>` +\n               `</div>`);\n     });\n \n@@ -867,7 +874,7 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n         other {({{name}})}\n       }</span></div>`);\n       expect(fixture.nativeElement.innerHTML)\n-          .toEqual(`<div><span>(Angular)<!--ICU 21:0--></span><!--bindings={\n+          .toEqual(`<div><span>(Angular)<!--ICU ${HEADER_OFFSET + 0}:0--></span><!--bindings={\n   \"ng-reflect-ng-if\": \"true\"\n }--></div>`);\n \n@@ -887,7 +894,7 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n         other {({{name}})}\n       }</ng-container>`);\n       expect(fixture.nativeElement.innerHTML)\n-          .toEqual(`(Angular)<!--ICU 22:0--><!--ng-container-->`);\n+          .toEqual(`(Angular)<!--ICU ${HEADER_OFFSET + 1}:0--><!--ng-container-->`);\n     });\n \n     it('inside <ng-template>', () => {\n@@ -922,12 +929,13 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n                        other {animals}\n                      }!}\n       }</div>`);\n-      expect(fixture.nativeElement.innerHTML).toEqual(`<div>zero<!--ICU 22:1--></div>`);\n+      expect(fixture.nativeElement.innerHTML)\n+          .toEqual(`<div>zero<!--ICU ${HEADER_OFFSET + 1}:1--></div>`);\n \n       fixture.componentRef.instance.count = 4;\n       fixture.detectChanges();\n       expect(fixture.nativeElement.innerHTML)\n-          .toEqual(`<div>4 animaux<!--nested ICU 0-->!<!--ICU 22:1--></div>`);\n+          .toEqual(`<div>4 animaux<!--nested ICU 0-->!<!--ICU ${HEADER_OFFSET + 1}:1--></div>`);\n     });\n \n     it('nested with interpolations in \"other\" blocks', () => {\n@@ -947,16 +955,18 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n                      }!}\n         other {other - {{count}}}\n       }</div>`);\n-      expect(fixture.nativeElement.innerHTML).toEqual(`<div>zero<!--ICU 22:1--></div>`);\n+      expect(fixture.nativeElement.innerHTML)\n+          .toEqual(`<div>zero<!--ICU ${HEADER_OFFSET + 1}:1--></div>`);\n \n       fixture.componentRef.instance.count = 2;\n       fixture.detectChanges();\n       expect(fixture.nativeElement.innerHTML)\n-          .toEqual(`<div>2 animaux<!--nested ICU 0-->!<!--ICU 22:1--></div>`);\n+          .toEqual(`<div>2 animaux<!--nested ICU 0-->!<!--ICU ${HEADER_OFFSET + 1}:1--></div>`);\n \n       fixture.componentRef.instance.count = 4;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual(`<div>autre - 4<!--ICU 22:1--></div>`);\n+      expect(fixture.nativeElement.innerHTML)\n+          .toEqual(`<div>autre - 4<!--ICU ${HEADER_OFFSET + 1}:1--></div>`);\n     });\n \n     it('should return the correct plural form for ICU expressions when using \"ro\" locale', () => {\n@@ -989,31 +999,34 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n             =other {lots of emails}\n           }`);\n \n-      expect(fixture.nativeElement.innerHTML).toEqual('no email<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML).toEqual(`no email<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       // Change detection cycle, no model changes\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('no email<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML).toEqual(`no email<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 3;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('a few emails<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML)\n+          .toEqual(`a few emails<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 1;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('one email<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML).toEqual(`one email<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 10;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('a few emails<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML)\n+          .toEqual(`a few emails<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 20;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('lots of emails<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML)\n+          .toEqual(`lots of emails<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 0;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('no email<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML).toEqual(`no email<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n     });\n \n     it(`should return the correct plural form for ICU expressions when using \"es\" locale`, () => {\n@@ -1040,31 +1053,34 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n             =other {lots of emails}\n           }`);\n \n-      expect(fixture.nativeElement.innerHTML).toEqual('no email<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML).toEqual(`no email<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       // Change detection cycle, no model changes\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('no email<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML).toEqual(`no email<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 3;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('lots of emails<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML)\n+          .toEqual(`lots of emails<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 1;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('one email<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML).toEqual(`one email<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 10;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('lots of emails<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML)\n+          .toEqual(`lots of emails<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 20;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('lots of emails<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML)\n+          .toEqual(`lots of emails<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n \n       fixture.componentInstance.count = 0;\n       fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML).toEqual('no email<!--ICU 21:0-->');\n+      expect(fixture.nativeElement.innerHTML).toEqual(`no email<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n     });\n \n     it('projection', () => {\n@@ -1159,12 +1175,14 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n       const fixture = TestBed.createComponent(App);\n       fixture.detectChanges();\n       expect(fixture.debugElement.nativeElement.innerHTML)\n-          .toContain('<my-cmp><div>ONE<!--ICU 22:0--></div><!--container--></my-cmp>');\n+          .toContain(\n+              `<my-cmp><div>ONE<!--ICU ${HEADER_OFFSET + 1}:0--></div><!--container--></my-cmp>`);\n \n       fixture.componentRef.instance.count = 2;\n       fixture.detectChanges();\n       expect(fixture.debugElement.nativeElement.innerHTML)\n-          .toContain('<my-cmp><div>OTHER<!--ICU 22:0--></div><!--container--></my-cmp>');\n+          .toContain(\n+              `<my-cmp><div>OTHER<!--ICU ${HEADER_OFFSET + 1}:0--></div><!--container--></my-cmp>`);\n \n       // destroy component\n       fixture.componentInstance.condition = false;\n@@ -1176,7 +1194,8 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n       fixture.componentInstance.count = 1;\n       fixture.detectChanges();\n       expect(fixture.debugElement.nativeElement.innerHTML)\n-          .toContain('<my-cmp><div>ONE<!--ICU 22:0--></div><!--container--></my-cmp>');\n+          .toContain(\n+              `<my-cmp><div>ONE<!--ICU ${HEADER_OFFSET + 1}:0--></div><!--container--></my-cmp>`);\n     });\n \n     it('with nested ICU expression and inside a container when creating a view via vcr.createEmbeddedView',\n@@ -1247,13 +1266,14 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n          dir!.attachEmbeddedView();\n          fixture.detectChanges();\n          expect(fixture.debugElement.nativeElement.innerHTML)\n-             .toBe(\n-                 '<my-cmp><div>2 animals<!--nested ICU 0-->!<!--ICU 22:1--></div><!--container--></my-cmp>');\n+             .toBe(`<my-cmp><div>2 animals<!--nested ICU 0-->!<!--ICU ${\n+                 HEADER_OFFSET + 1}:1--></div><!--container--></my-cmp>`);\n \n          fixture.componentRef.instance.count = 1;\n          fixture.detectChanges();\n          expect(fixture.debugElement.nativeElement.innerHTML)\n-             .toBe('<my-cmp><div>ONE<!--ICU 22:1--></div><!--container--></my-cmp>');\n+             .toBe(`<my-cmp><div>ONE<!--ICU ${\n+                 HEADER_OFFSET + 1}:1--></div><!--container--></my-cmp>`);\n        });\n \n     it('with nested containers', () => {\n@@ -2356,14 +2376,14 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n       const fixture = TestBed.createComponent(Parent);\n       fixture.detectChanges();\n       expect(fixture.nativeElement.innerHTML)\n-          .toEqual(\n-              `<child><div>Contenu enfant et projection depuis Parent<!--ICU 22:0--></div></child>`);\n+          .toEqual(`<child><div>Contenu enfant et projection depuis Parent<!--ICU ${\n+              HEADER_OFFSET + 1}:0--></div></child>`);\n \n       fixture.componentRef.instance.name = 'angular';\n       fixture.detectChanges();\n       expect(fixture.nativeElement.innerHTML)\n-          .toEqual(\n-              `<child><div>Contenu enfant et projection depuis Angular<!--ICU 22:0--></div></child>`);\n+          .toEqual(`<child><div>Contenu enfant et projection depuis Angular<!--ICU ${\n+              HEADER_OFFSET + 1}:0--></div></child>`);\n     });\n \n     it(`shouldn't project deleted projections in i18n blocks`, () => {"
        },
        {
            "sha": "7817f24003fc8fe72636d88136f00b052c578fb4",
            "filename": "packages/core/test/render3/i18n/i18n_insert_before_index_spec.ts",
            "status": "modified",
            "additions": 83,
            "deletions": 72,
            "changes": 155,
            "blob_url": "https://github.com/angular/angular/blob/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_insert_before_index_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_insert_before_index_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_insert_before_index_spec.ts?ref=36c7bebe40ad24975fc54f660a80d5cc90dc2a4f",
            "patch": "@@ -9,6 +9,7 @@\n import {addTNodeAndUpdateInsertBeforeIndex} from '@angular/core/src/render3/i18n/i18n_insert_before_index';\n import {createTNode} from '@angular/core/src/render3/instructions/shared';\n import {TNode, TNodeType} from '@angular/core/src/render3/interfaces/node';\n+import {HEADER_OFFSET} from '@angular/core/src/render3/interfaces/view';\n import {matchTNode} from '../matchers';\n \n \n@@ -29,69 +30,73 @@ describe('addTNodeAndUpdateInsertBeforeIndex', () => {\n \n   it('should add first node', () => {\n     const previousTNodes: TNode[] = [];\n-    addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(21));\n+    addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 0));\n     expect(previousTNodes).toEqual([\n-      matchTNode({index: 21, insertBeforeIndex: null}),\n+      matchTNode({index: HEADER_OFFSET + 0, insertBeforeIndex: null}),\n     ]);\n   });\n \n   describe('when adding a placeholder', () => {\n     describe('whose index is greater than those already there', () => {\n       it('should not update the `insertBeforeIndex` values', () => {\n         const previousTNodes: TNode[] = [\n-          tPlaceholderElementNode(21),\n-          tPlaceholderElementNode(22),\n+          tPlaceholderElementNode(HEADER_OFFSET + 0),\n+          tPlaceholderElementNode(HEADER_OFFSET + 1),\n         ];\n-        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(23));\n+        addTNodeAndUpdateInsertBeforeIndex(\n+            previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 2));\n         expect(previousTNodes).toEqual([\n-          matchTNode({index: 21, insertBeforeIndex: null}),\n-          matchTNode({index: 22, insertBeforeIndex: null}),\n-          matchTNode({index: 23, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 0, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 1, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 2, insertBeforeIndex: null}),\n         ]);\n       });\n     });\n \n     describe('whose index is smaller than current nodes', () => {\n       it('should update the previous insertBeforeIndex', () => {\n         const previousTNodes: TNode[] = [\n-          tPlaceholderElementNode(22),\n-          tPlaceholderElementNode(23),\n+          tPlaceholderElementNode(HEADER_OFFSET + 1),\n+          tPlaceholderElementNode(HEADER_OFFSET + 2),\n         ];\n-        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(21));\n+        addTNodeAndUpdateInsertBeforeIndex(\n+            previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 0));\n         expect(previousTNodes).toEqual([\n-          matchTNode({index: 22, insertBeforeIndex: 21}),\n-          matchTNode({index: 23, insertBeforeIndex: 21}),\n-          matchTNode({index: 21, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 1, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 2, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 0, insertBeforeIndex: null}),\n         ]);\n       });\n \n       it('should not update the previous insertBeforeIndex if it is already set', () => {\n         const previousTNodes: TNode[] = [\n-          tPlaceholderElementNode(23, 22),\n-          tPlaceholderElementNode(24, 22),\n-          tPlaceholderElementNode(22),\n+          tPlaceholderElementNode(HEADER_OFFSET + 2, HEADER_OFFSET + 1),\n+          tPlaceholderElementNode(HEADER_OFFSET + 3, HEADER_OFFSET + 1),\n+          tPlaceholderElementNode(HEADER_OFFSET + 1),\n         ];\n-        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(21));\n+        addTNodeAndUpdateInsertBeforeIndex(\n+            previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 0));\n         expect(previousTNodes).toEqual([\n-          matchTNode({index: 23, insertBeforeIndex: 22}),\n-          matchTNode({index: 24, insertBeforeIndex: 22}),\n-          matchTNode({index: 22, insertBeforeIndex: 21}),\n-          matchTNode({index: 21, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 2, insertBeforeIndex: HEADER_OFFSET + 1}),\n+          matchTNode({index: HEADER_OFFSET + 3, insertBeforeIndex: HEADER_OFFSET + 1}),\n+          matchTNode({index: HEADER_OFFSET + 1, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 0, insertBeforeIndex: null}),\n         ]);\n       });\n \n       it('should not update the previous insertBeforeIndex if it is created after', () => {\n         const previousTNodes: TNode[] = [\n-          tPlaceholderElementNode(26, 21),\n-          tPlaceholderElementNode(27, 21),\n-          tPlaceholderElementNode(21),\n+          tPlaceholderElementNode(HEADER_OFFSET + 5, HEADER_OFFSET + 0),\n+          tPlaceholderElementNode(HEADER_OFFSET + 6, HEADER_OFFSET + 0),\n+          tPlaceholderElementNode(HEADER_OFFSET + 0),\n         ];\n-        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(24));\n+        addTNodeAndUpdateInsertBeforeIndex(\n+            previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 3));\n         expect(previousTNodes).toEqual([\n-          matchTNode({index: 26, insertBeforeIndex: 21}),\n-          matchTNode({index: 27, insertBeforeIndex: 21}),\n-          matchTNode({index: 21, insertBeforeIndex: null}),\n-          matchTNode({index: 24, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 5, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 6, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 0, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 3, insertBeforeIndex: null}),\n         ]);\n       });\n     });\n@@ -101,59 +106,59 @@ describe('addTNodeAndUpdateInsertBeforeIndex', () => {\n     describe('whose index is greater than those already there', () => {\n       it('should not update the `insertBeforeIndex` values', () => {\n         const previousTNodes: TNode[] = [\n-          tPlaceholderElementNode(21),\n-          tPlaceholderElementNode(22),\n+          tPlaceholderElementNode(HEADER_OFFSET + 0),\n+          tPlaceholderElementNode(HEADER_OFFSET + 1),\n         ];\n-        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(23));\n+        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(HEADER_OFFSET + 2));\n         expect(previousTNodes).toEqual([\n-          matchTNode({index: 21, insertBeforeIndex: 23}),\n-          matchTNode({index: 22, insertBeforeIndex: 23}),\n-          matchTNode({index: 23, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 0, insertBeforeIndex: HEADER_OFFSET + 2}),\n+          matchTNode({index: HEADER_OFFSET + 1, insertBeforeIndex: HEADER_OFFSET + 2}),\n+          matchTNode({index: HEADER_OFFSET + 2, insertBeforeIndex: null}),\n         ]);\n       });\n     });\n \n     describe('whose index is smaller than current nodes', () => {\n       it('should update the previous insertBeforeIndex', () => {\n         const previousTNodes: TNode[] = [\n-          tPlaceholderElementNode(22),\n-          tPlaceholderElementNode(23),\n+          tPlaceholderElementNode(HEADER_OFFSET + 1),\n+          tPlaceholderElementNode(HEADER_OFFSET + 2),\n         ];\n-        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(21));\n+        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(HEADER_OFFSET + 0));\n         expect(previousTNodes).toEqual([\n-          matchTNode({index: 22, insertBeforeIndex: 21}),\n-          matchTNode({index: 23, insertBeforeIndex: 21}),\n-          matchTNode({index: 21, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 1, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 2, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 0, insertBeforeIndex: null}),\n         ]);\n       });\n \n       it('should not update the previous insertBeforeIndex if it is already set', () => {\n         const previousTNodes: TNode[] = [\n-          tPlaceholderElementNode(23, 22),\n-          tPlaceholderElementNode(24, 22),\n-          tPlaceholderElementNode(22),\n+          tPlaceholderElementNode(HEADER_OFFSET + 2, HEADER_OFFSET + 1),\n+          tPlaceholderElementNode(HEADER_OFFSET + 3, HEADER_OFFSET + 1),\n+          tPlaceholderElementNode(HEADER_OFFSET + 1),\n         ];\n-        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(21));\n+        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(HEADER_OFFSET + 0));\n         expect(previousTNodes).toEqual([\n-          matchTNode({index: 23, insertBeforeIndex: 22}),\n-          matchTNode({index: 24, insertBeforeIndex: 22}),\n-          matchTNode({index: 22, insertBeforeIndex: 21}),\n-          matchTNode({index: 21, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 2, insertBeforeIndex: HEADER_OFFSET + 1}),\n+          matchTNode({index: HEADER_OFFSET + 3, insertBeforeIndex: HEADER_OFFSET + 1}),\n+          matchTNode({index: HEADER_OFFSET + 1, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 0, insertBeforeIndex: null}),\n         ]);\n       });\n \n       it('should not update the previous insertBeforeIndex if it is created after', () => {\n         const previousTNodes: TNode[] = [\n-          tPlaceholderElementNode(26, 21),\n-          tPlaceholderElementNode(27, 21),\n-          tPlaceholderElementNode(21),\n+          tPlaceholderElementNode(HEADER_OFFSET + 5, HEADER_OFFSET + 0),\n+          tPlaceholderElementNode(HEADER_OFFSET + 6, HEADER_OFFSET + 0),\n+          tPlaceholderElementNode(HEADER_OFFSET + 0),\n         ];\n-        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(24));\n+        addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(HEADER_OFFSET + 3));\n         expect(previousTNodes).toEqual([\n-          matchTNode({index: 26, insertBeforeIndex: 21}),\n-          matchTNode({index: 27, insertBeforeIndex: 21}),\n-          matchTNode({index: 21, insertBeforeIndex: 24}),\n-          matchTNode({index: 24, insertBeforeIndex: null}),\n+          matchTNode({index: HEADER_OFFSET + 5, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 6, insertBeforeIndex: HEADER_OFFSET + 0}),\n+          matchTNode({index: HEADER_OFFSET + 0, insertBeforeIndex: HEADER_OFFSET + 3}),\n+          matchTNode({index: HEADER_OFFSET + 3, insertBeforeIndex: null}),\n         ]);\n       });\n     });\n@@ -162,21 +167,27 @@ describe('addTNodeAndUpdateInsertBeforeIndex', () => {\n   describe('scenario', () => {\n     it('should rearrange the nodes', () => {\n       const previousTNodes: TNode[] = [];\n-      addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(23));\n-      addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(29));\n-      addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(25));\n-      addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(26));\n-      addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(30));\n-      addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(24));\n-      addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tPlaceholderElementNode(28));\n+      addTNodeAndUpdateInsertBeforeIndex(\n+          previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 2));\n+      addTNodeAndUpdateInsertBeforeIndex(\n+          previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 8));\n+      addTNodeAndUpdateInsertBeforeIndex(\n+          previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 4));\n+      addTNodeAndUpdateInsertBeforeIndex(\n+          previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 5));\n+      addTNodeAndUpdateInsertBeforeIndex(previousTNodes, tI18NTextNode(HEADER_OFFSET + 9));\n+      addTNodeAndUpdateInsertBeforeIndex(\n+          previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 3));\n+      addTNodeAndUpdateInsertBeforeIndex(\n+          previousTNodes, tPlaceholderElementNode(HEADER_OFFSET + 7));\n       expect(previousTNodes).toEqual([\n-        matchTNode({index: 23, insertBeforeIndex: 30}),\n-        matchTNode({index: 29, insertBeforeIndex: 25}),\n-        matchTNode({index: 25, insertBeforeIndex: 30}),\n-        matchTNode({index: 26, insertBeforeIndex: 30}),\n-        matchTNode({index: 30, insertBeforeIndex: null}),\n-        matchTNode({index: 24, insertBeforeIndex: null}),\n-        matchTNode({index: 28, insertBeforeIndex: null}),\n+        matchTNode({index: HEADER_OFFSET + 2, insertBeforeIndex: HEADER_OFFSET + 9}),\n+        matchTNode({index: HEADER_OFFSET + 8, insertBeforeIndex: HEADER_OFFSET + 4}),\n+        matchTNode({index: HEADER_OFFSET + 4, insertBeforeIndex: HEADER_OFFSET + 9}),\n+        matchTNode({index: HEADER_OFFSET + 5, insertBeforeIndex: HEADER_OFFSET + 9}),\n+        matchTNode({index: HEADER_OFFSET + 9, insertBeforeIndex: null}),\n+        matchTNode({index: HEADER_OFFSET + 3, insertBeforeIndex: null}),\n+        matchTNode({index: HEADER_OFFSET + 7, insertBeforeIndex: null}),\n       ]);\n     });\n   });"
        },
        {
            "sha": "6408a30495660624228a43f06877ea38ca15c7be",
            "filename": "packages/core/test/render3/i18n/i18n_parse_spec.ts",
            "status": "modified",
            "additions": 81,
            "deletions": 73,
            "changes": 154,
            "blob_url": "https://github.com/angular/angular/blob/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_parse_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_parse_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_parse_spec.ts?ref=36c7bebe40ad24975fc54f660a80d5cc90dc2a4f",
            "patch": "@@ -11,7 +11,7 @@ import {applyCreateOpCodes} from '@angular/core/src/render3/i18n/i18n_apply';\n import {i18nStartFirstCreatePass} from '@angular/core/src/render3/i18n/i18n_parse';\n import {getTIcu} from '@angular/core/src/render3/i18n/i18n_util';\n import {I18nUpdateOpCodes, IcuType, TI18n} from '@angular/core/src/render3/interfaces/i18n';\n-import {HEADER_OFFSET} from '@angular/core/src/render3/interfaces/view';\n+import {HEADER_OFFSET, HOST} from '@angular/core/src/render3/interfaces/view';\n import {expect} from '@angular/core/testing/src/testing_internal';\n import {matchTI18n, matchTIcu} from '../matchers';\n import {matchDebug} from '../utils';\n@@ -26,8 +26,8 @@ describe('i18n_parse', () => {\n       const tI18n = toT18n('some text');\n       expect(tI18n).toEqual(matchTI18n({\n         create: matchDebug([\n-          'lView[23] = document.createText(\"some text\");',\n-          'parent.appendChild(lView[23]);',\n+          `lView[${HEADER_OFFSET + 2}] = document.createText(\"some text\");`,\n+          `parent.appendChild(lView[${HEADER_OFFSET + 2}]);`,\n         ]),\n         update: [] as unknown as I18nUpdateOpCodes,\n       }));\n@@ -57,60 +57,63 @@ describe('i18n_parse', () => {\n         }|after`);\n       expect(tI18n).toEqual(matchTI18n({\n         create: matchDebug([\n-          'lView[23] = document.createText(\"before|\");',\n-          'parent.appendChild(lView[23]);',\n-          'lView[24] = document.createComment(\"ICU 21:0\");',\n-          'parent.appendChild(lView[24]);',\n-          'lView[28] = document.createText(\"|after\");',\n-          'parent.appendChild(lView[28]);',\n+          `lView[${HEADER_OFFSET + 2}] = document.createText(\"before|\");`,\n+          `parent.appendChild(lView[${HEADER_OFFSET + 2}]);`,\n+          `lView[${HEADER_OFFSET + 3}] = document.createComment(\"ICU ${HEADER_OFFSET + 0}:0\");`,\n+          `parent.appendChild(lView[${HEADER_OFFSET + 3}]);`,\n+          `lView[${HEADER_OFFSET + 7}] = document.createText(\"|after\");`,\n+          `parent.appendChild(lView[${HEADER_OFFSET + 7}]);`,\n         ]),\n         update: matchDebug([\n-          'if (mask & 0b1) { icuSwitchCase(24, `${lView[i-1]}`); }',\n+          `if (mask & 0b1) { icuSwitchCase(${HEADER_OFFSET + 3}, \\`\\${lView[i-1]}\\`); }`,\n         ])\n       }));\n-      expect(getTIcu(fixture.tView, 24)).toEqual(matchTIcu({\n+      expect(getTIcu(fixture.tView, HEADER_OFFSET + 3)).toEqual(matchTIcu({\n         type: IcuType.select,\n-        anchorIdx: 24,\n-        currentCaseLViewIndex: 25,\n+        anchorIdx: HEADER_OFFSET + 3,\n+        currentCaseLViewIndex: HEADER_OFFSET + 4,\n         cases: ['A', 'other'],\n         create: [\n           matchDebug([\n-            'lView[26] = document.createTextNode(\"caseA\")',\n-            '(lView[0] as Element).appendChild(lView[26])'\n+            `lView[${HEADER_OFFSET + 5}] = document.createTextNode(\"caseA\")`,\n+            `(lView[${HOST}] as Element).appendChild(lView[${HEADER_OFFSET + 5}])`\n           ]),\n           matchDebug([\n-            'lView[27] = document.createTextNode(\"otherCase\")',\n-            '(lView[0] as Element).appendChild(lView[27])',\n+            `lView[${HEADER_OFFSET + 6}] = document.createTextNode(\"otherCase\")`,\n+            `(lView[${HOST}] as Element).appendChild(lView[${HEADER_OFFSET + 6}])`,\n           ])\n         ],\n         update: [\n           matchDebug([]),\n           matchDebug([]),\n         ],\n         remove: [\n-          matchDebug(['remove(lView[26])']),\n-          matchDebug(['remove(lView[27])']),\n+          matchDebug([`remove(lView[${HEADER_OFFSET + 5}])`]),\n+          matchDebug([`remove(lView[${HEADER_OFFSET + 6}])`]),\n         ],\n       }));\n \n       fixture.apply(() => {\n         applyCreateOpCodes(fixture.lView, tI18n.create, fixture.host, null);\n-        expect(fixture.host.innerHTML).toEqual('before|<!--ICU 21:0-->|after');\n+        expect(fixture.host.innerHTML).toEqual(`before|<!--ICU ${HEADER_OFFSET + 0}:0-->|after`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('A');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n-        expect(fixture.host.innerHTML).toEqual('before|caseA<!--ICU 21:0-->|after');\n+        ɵɵi18nApply(0);\n+        expect(fixture.host.innerHTML)\n+            .toEqual(`before|caseA<!--ICU ${HEADER_OFFSET + 0}:0-->|after`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('x');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n-        expect(fixture.host.innerHTML).toEqual('before|otherCase<!--ICU 21:0-->|after');\n+        ɵɵi18nApply(0);\n+        expect(fixture.host.innerHTML)\n+            .toEqual(`before|otherCase<!--ICU ${HEADER_OFFSET + 0}:0-->|after`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('A');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n-        expect(fixture.host.innerHTML).toEqual('before|caseA<!--ICU 21:0-->|after');\n+        ɵɵi18nApply(0);\n+        expect(fixture.host.innerHTML)\n+            .toEqual(`before|caseA<!--ICU ${HEADER_OFFSET + 0}:0-->|after`);\n       });\n     });\n \n@@ -122,23 +125,25 @@ describe('i18n_parse', () => {\n       }`);\n       fixture.apply(() => {\n         applyCreateOpCodes(fixture.lView, tI18n.create, fixture.host, null);\n-        expect(fixture.host.innerHTML).toEqual('<!--ICU 21:0-->');\n+        expect(fixture.host.innerHTML).toEqual(`<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('A');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n-        expect(fixture.host.innerHTML).toEqual('Hello <b>world<i>!</i></b><!--ICU 21:0-->');\n+        ɵɵi18nApply(0);\n+        expect(fixture.host.innerHTML)\n+            .toEqual(`Hello <b>world<i>!</i></b><!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('x');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n+        ɵɵi18nApply(0);\n         expect(fixture.host.innerHTML)\n-            .toEqual('<div>nestedOther<!--nested ICU 0--></div><!--ICU 21:0-->');\n+            .toEqual(`<div>nestedOther<!--nested ICU 0--></div><!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('A');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n-        expect(fixture.host.innerHTML).toEqual('Hello <b>world<i>!</i></b><!--ICU 21:0-->');\n+        ɵɵi18nApply(0);\n+        expect(fixture.host.innerHTML)\n+            .toEqual(`Hello <b>world<i>!</i></b><!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n     });\n \n@@ -170,32 +175,32 @@ describe('i18n_parse', () => {\n         }`);\n       expect(tI18n).toEqual(matchTI18n({\n         create: matchDebug([\n-          'lView[25] = document.createComment(\"ICU 21:0\");',\n-          'parent.appendChild(lView[25]);',\n+          `lView[${HEADER_OFFSET + 4}] = document.createComment(\"ICU ${HEADER_OFFSET + 0}:0\");`,\n+          `parent.appendChild(lView[${HEADER_OFFSET + 4}]);`,\n         ]),\n         update: matchDebug([\n-          'if (mask & 0b1) { icuSwitchCase(25, `${lView[i-1]}`); }',\n-          'if (mask & 0b10) { icuSwitchCase(28, `${lView[i-2]}`); }',\n-          'if (mask & 0b100) { icuUpdateCase(28); }',\n+          `if (mask & 0b1) { icuSwitchCase(${HEADER_OFFSET + 4}, \\`\\${lView[i-1]}\\`); }`,\n+          `if (mask & 0b10) { icuSwitchCase(${HEADER_OFFSET + 7}, \\`\\${lView[i-2]}\\`); }`,\n+          `if (mask & 0b100) { icuUpdateCase(${HEADER_OFFSET + 7}); }`,\n         ]),\n       }));\n-      expect(getTIcu(fixture.tView, 25)).toEqual(matchTIcu({\n+      expect(getTIcu(fixture.tView, HEADER_OFFSET + 4)).toEqual(matchTIcu({\n         type: IcuType.select,\n-        anchorIdx: 25,\n-        currentCaseLViewIndex: 26,\n+        anchorIdx: HEADER_OFFSET + 4,\n+        currentCaseLViewIndex: HEADER_OFFSET + 5,\n         cases: ['A', 'other'],\n         create: [\n           matchDebug([\n-            'lView[27] = document.createTextNode(\"parentA \")',\n-            '(lView[0] as Element).appendChild(lView[27])',\n-            'lView[28] = document.createComment(\"nested ICU 0\")',\n-            '(lView[0] as Element).appendChild(lView[28])',\n-            'lView[32] = document.createTextNode(\"!\")',\n-            '(lView[0] as Element).appendChild(lView[32])',\n+            `lView[${HEADER_OFFSET + 6}] = document.createTextNode(\"parentA \")`,\n+            `(lView[${HOST}] as Element).appendChild(lView[${HEADER_OFFSET + 6}])`,\n+            `lView[${HEADER_OFFSET + 7}] = document.createComment(\"nested ICU 0\")`,\n+            `(lView[${HOST}] as Element).appendChild(lView[${HEADER_OFFSET + 7}])`,\n+            `lView[${HEADER_OFFSET + 11}] = document.createTextNode(\"!\")`,\n+            `(lView[${HOST}] as Element).appendChild(lView[${HEADER_OFFSET + 11}])`,\n           ]),\n           matchDebug([\n-            'lView[33] = document.createTextNode(\"parentOther\")',\n-            '(lView[0] as Element).appendChild(lView[33])',\n+            `lView[${HEADER_OFFSET + 12}] = document.createTextNode(\"parentOther\")`,\n+            `(lView[${HOST}] as Element).appendChild(lView[${HEADER_OFFSET + 12}])`,\n           ])\n         ],\n         update: [\n@@ -204,76 +209,79 @@ describe('i18n_parse', () => {\n         ],\n         remove: [\n           matchDebug([\n-            'remove(lView[27])',\n-            'removeNestedICU(28)',\n-            'remove(lView[28])',\n-            'remove(lView[32])',\n+            `remove(lView[${HEADER_OFFSET + 6}])`,\n+            `removeNestedICU(${HEADER_OFFSET + 7})`,\n+            `remove(lView[${HEADER_OFFSET + 7}])`,\n+            `remove(lView[${HEADER_OFFSET + 11}])`,\n           ]),\n           matchDebug([\n-            'remove(lView[33])',\n+            `remove(lView[${HEADER_OFFSET + 12}])`,\n           ])\n         ],\n       }));\n \n-      expect(getTIcu(fixture.tView, 28)).toEqual(matchTIcu({\n+      expect(getTIcu(fixture.tView, HEADER_OFFSET + 7)).toEqual(matchTIcu({\n         type: IcuType.select,\n-        anchorIdx: 28,\n-        currentCaseLViewIndex: 29,\n+        anchorIdx: HEADER_OFFSET + 7,\n+        currentCaseLViewIndex: HEADER_OFFSET + 8,\n         cases: ['0', 'other'],\n         create: [\n           matchDebug([\n-            'lView[30] = document.createTextNode(\"nested0\")',\n-            '(lView[0] as Element).appendChild(lView[30])'\n+            `lView[${HEADER_OFFSET + 9}] = document.createTextNode(\"nested0\")`,\n+            `(lView[${HOST}] as Element).appendChild(lView[${HEADER_OFFSET + 9}])`\n           ]),\n           matchDebug([\n-            'lView[31] = document.createTextNode(\"\")',\n-            '(lView[0] as Element).appendChild(lView[31])',\n+            `lView[${HEADER_OFFSET + 10}] = document.createTextNode(\"\")`,\n+            `(lView[${HOST}] as Element).appendChild(lView[${HEADER_OFFSET + 10}])`,\n           ])\n         ],\n         update: [\n           matchDebug([]),\n           matchDebug([\n-            'if (mask & 0b100) { (lView[31] as Text).textContent = `${lView[i-3]}`; }',\n+            `if (mask & 0b100) { (lView[${\n+                HEADER_OFFSET + 10}] as Text).textContent = \\`\\${lView[i-3]}\\`; }`,\n           ]),\n         ],\n         remove: [\n-          matchDebug(['remove(lView[30])']),\n-          matchDebug(['remove(lView[31])']),\n+          matchDebug([`remove(lView[${HEADER_OFFSET + 9}])`]),\n+          matchDebug([`remove(lView[${HEADER_OFFSET + 10}])`]),\n         ],\n       }));\n \n       fixture.apply(() => {\n         applyCreateOpCodes(fixture.lView, tI18n.create, fixture.host, null);\n-        expect(fixture.host.innerHTML).toEqual('<!--ICU 21:0-->');\n+        expect(fixture.host.innerHTML).toEqual(`<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('A');\n         ɵɵi18nExp('0');\n         ɵɵi18nExp('value1');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n+        ɵɵi18nApply(0);\n         expect(fixture.host.innerHTML)\n-            .toEqual('parentA nested0<!--nested ICU 0-->!<!--ICU 21:0-->');\n+            .toEqual(`parentA nested0<!--nested ICU 0-->!<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('A');\n         ɵɵi18nExp('x');\n         ɵɵi18nExp('value1');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n-        expect(fixture.host.innerHTML).toEqual('parentA value1<!--nested ICU 0-->!<!--ICU 21:0-->');\n+        ɵɵi18nApply(0);\n+        expect(fixture.host.innerHTML)\n+            .toEqual(`parentA value1<!--nested ICU 0-->!<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('x');\n         ɵɵi18nExp('x');\n         ɵɵi18nExp('value2');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n-        expect(fixture.host.innerHTML).toEqual('parentOther<!--ICU 21:0-->');\n+        ɵɵi18nApply(0);\n+        expect(fixture.host.innerHTML).toEqual(`parentOther<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n       fixture.apply(() => {\n         ɵɵi18nExp('A');\n         ɵɵi18nExp('A');\n         ɵɵi18nExp('value2');\n-        ɵɵi18nApply(0);  // index 0 + HEADER_OFFSET = 20;\n-        expect(fixture.host.innerHTML).toEqual('parentA value2<!--nested ICU 0-->!<!--ICU 21:0-->');\n+        ɵɵi18nApply(0);\n+        expect(fixture.host.innerHTML)\n+            .toEqual(`parentA value2<!--nested ICU 0-->!<!--ICU ${HEADER_OFFSET + 0}:0-->`);\n       });\n     });\n   });"
        },
        {
            "sha": "2577ffa2883e3ed61046f59e6036a4b75008f8bf",
            "filename": "packages/core/test/render3/i18n/i18n_spec.ts",
            "status": "modified",
            "additions": 81,
            "deletions": 67,
            "changes": 148,
            "blob_url": "https://github.com/angular/angular/blob/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_spec.ts?ref=36c7bebe40ad24975fc54f660a80d5cc90dc2a4f",
            "patch": "@@ -127,17 +127,17 @@ describe('Runtime i18n', () => {\n         ɵɵelementEnd();\n       }, undefined, nbConsts, HEADER_OFFSET + index);\n \n-      expect((opCodes as any).update.debug).toEqual([\n-        'if (mask & 0b1) { (lView[23] as Text).textContent = `Hello ${lView[i-1]}!`; }'\n-      ]);\n+      expect((opCodes as any).update.debug).toEqual([`if (mask & 0b1) { (lView[${\n+          HEADER_OFFSET + 2}] as Text).textContent = \\`Hello \\${lView[i-1]}!\\`; }`]);\n \n       expect(opCodes).toEqual({\n         create: matchDebug([\n           `lView[${HEADER_OFFSET + 2}] = document.createText(\"\");`,\n           `parent.appendChild(lView[${HEADER_OFFSET + 2}]);`,\n         ]),\n         update: matchDebug([\n-          'if (mask & 0b1) { (lView[23] as Text).textContent = `Hello ${lView[i-1]}!`; }',\n+          `if (mask & 0b1) { (lView[${\n+              HEADER_OFFSET + 2}] as Text).textContent = \\`Hello \\${lView[i-1]}!\\`; }`,\n         ]),\n       });\n     });\n@@ -158,7 +158,9 @@ describe('Runtime i18n', () => {\n           `parent.appendChild(lView[${HEADER_OFFSET + 2}]);`,\n         ]),\n         update: matchDebug([\n-          'if (mask & 0b11) { (lView[23] as Text).textContent = `Hello ${lView[i-1]} and ${lView[i-2]}, again ${lView[i-1]}!`; }',\n+          `if (mask & 0b11) { (lView[${\n+              HEADER_OFFSET +\n+              2}] as Text).textContent = \\`Hello \\${lView[i-1]} and \\${lView[i-2]}, again \\${lView[i-1]}!\\`; }`,\n         ]),\n       });\n     });\n@@ -193,7 +195,8 @@ describe('Runtime i18n', () => {\n           `parent.appendChild(lView[${HEADER_OFFSET + 4}]);`,\n         ]),\n         update: matchDebug([\n-          'if (mask & 0b1) { (lView[24] as Text).textContent = `${lView[i-1]} is rendered as: `; }',\n+          `if (mask & 0b1) { (lView[${\n+              HEADER_OFFSET + 3}] as Text).textContent = \\`\\${lView[i-1]} is rendered as: \\`; }`,\n         ]),\n       });\n \n@@ -249,26 +252,26 @@ describe('Runtime i18n', () => {\n \n       expect(opCodes).toEqual({\n         create: matchDebug([\n-          `lView[${HEADER_OFFSET + 2}] = document.createComment(\"ICU 22:0\");`,\n+          `lView[${HEADER_OFFSET + 2}] = document.createComment(\"ICU ${HEADER_OFFSET + 1}:0\");`,\n           `parent.appendChild(lView[${HEADER_OFFSET + 2}]);`,\n         ]),\n         update: matchDebug([\n-          'if (mask & 0b1) { icuSwitchCase(23, `${lView[i-1]}`); }',\n-          'if (mask & 0b1) { icuUpdateCase(23); }',\n+          `if (mask & 0b1) { icuSwitchCase(${HEADER_OFFSET + 2}, \\`\\${lView[i-1]}\\`); }`,\n+          `if (mask & 0b1) { icuUpdateCase(${HEADER_OFFSET + 2}); }`,\n         ]),\n       });\n-      expect(getTIcu(tView, 23)).toEqual(<TIcu>{\n+      expect(getTIcu(tView, HEADER_OFFSET + 2)).toEqual(<TIcu>{\n         type: 1,\n-        currentCaseLViewIndex: 24,\n-        anchorIdx: 23,\n+        currentCaseLViewIndex: HEADER_OFFSET + 3,\n+        anchorIdx: HEADER_OFFSET + 2,\n         cases: ['0', '1', 'other'],\n         create: [\n           matchDebug([\n             `lView[${HEADER_OFFSET + 4}] = document.createTextNode(\"no \")`,\n             `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 4}])`,\n-            'lView[26] = document.createElement(\"b\")',\n+            `lView[${HEADER_OFFSET + 5}] = document.createElement(\"b\")`,\n             `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 5}])`,\n-            '(lView[26] as Element).setAttribute(\"title\", \"none\")',\n+            `(lView[${HEADER_OFFSET + 5}] as Element).setAttribute(\"title\", \"none\")`,\n             `lView[${HEADER_OFFSET + 6}] = document.createTextNode(\"emails\")`,\n             `(lView[${HEADER_OFFSET + 5}] as Element).appendChild(lView[${HEADER_OFFSET + 6}])`,\n             `lView[${HEADER_OFFSET + 7}] = document.createTextNode(\"!\")`,\n@@ -277,41 +280,43 @@ describe('Runtime i18n', () => {\n           matchDebug([\n             `lView[${HEADER_OFFSET + 8}] = document.createTextNode(\"one \")`,\n             `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 8}])`,\n-            'lView[30] = document.createElement(\"i\")',\n+            `lView[${HEADER_OFFSET + 9}] = document.createElement(\"i\")`,\n             `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 9}])`,\n-            'lView[31] = document.createTextNode(\"email\")',\n-            '(lView[30] as Element).appendChild(lView[31])',\n+            `lView[${HEADER_OFFSET + 10}] = document.createTextNode(\"email\")`,\n+            `(lView[${HEADER_OFFSET + 9}] as Element).appendChild(lView[${HEADER_OFFSET + 10}])`,\n           ]),\n           matchDebug([\n-            'lView[32] = document.createTextNode(\"\")',\n-            '(lView[21] as Element).appendChild(lView[32])',\n-            'lView[33] = document.createElement(\"span\")',\n-            '(lView[21] as Element).appendChild(lView[33])',\n-            'lView[34] = document.createTextNode(\"emails\")',\n-            '(lView[33] as Element).appendChild(lView[34])',\n+            `lView[${HEADER_OFFSET + 11}] = document.createTextNode(\"\")`,\n+            `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 11}])`,\n+            `lView[${HEADER_OFFSET + 12}] = document.createElement(\"span\")`,\n+            `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 12}])`,\n+            `lView[${HEADER_OFFSET + 13}] = document.createTextNode(\"emails\")`,\n+            `(lView[${HEADER_OFFSET + 12}] as Element).appendChild(lView[${HEADER_OFFSET + 13}])`,\n           ]),\n         ],\n         remove: [\n           matchDebug([\n-            'remove(lView[25])',\n-            'remove(lView[26])',\n-            'remove(lView[28])',\n+            `remove(lView[${HEADER_OFFSET + 4}])`,\n+            `remove(lView[${HEADER_OFFSET + 5}])`,\n+            `remove(lView[${HEADER_OFFSET + 7}])`,\n           ]),\n           matchDebug([\n-            'remove(lView[29])',\n-            'remove(lView[30])',\n+            `remove(lView[${HEADER_OFFSET + 8}])`,\n+            `remove(lView[${HEADER_OFFSET + 9}])`,\n           ]),\n           matchDebug([\n-            'remove(lView[32])',\n-            'remove(lView[33])',\n+            `remove(lView[${HEADER_OFFSET + 11}])`,\n+            `remove(lView[${HEADER_OFFSET + 12}])`,\n           ]),\n         ],\n         update: [\n           matchDebug([]),\n           matchDebug([]),\n           matchDebug([\n-            'if (mask & 0b1) { (lView[32] as Text).textContent = `${lView[i-1]} `; }',\n-            'if (mask & 0b10) { (lView[33] as Element).setAttribute(\\'title\\', `${lView[i-2]}`); }',\n+            `if (mask & 0b1) { (lView[${\n+                HEADER_OFFSET + 11}] as Text).textContent = \\`\\${lView[i-1]} \\`; }`,\n+            `if (mask & 0b10) { (lView[${\n+                HEADER_OFFSET + 12}] as Element).setAttribute('title', \\`\\${lView[i-2]}\\`); }`,\n           ]),\n         ]\n       });\n@@ -336,19 +341,19 @@ describe('Runtime i18n', () => {\n \n       expect(opCodes).toEqual({\n         create: matchDebug([\n-          `lView[${HEADER_OFFSET + 2}] = document.createComment(\"ICU 22:0\");`,\n+          `lView[${HEADER_OFFSET + 2}] = document.createComment(\"ICU ${HEADER_OFFSET + 1}:0\");`,\n           `parent.appendChild(lView[${HEADER_OFFSET + 2}]);`,\n         ]),\n         update: matchDebug([\n-          'if (mask & 0b1) { icuSwitchCase(23, `${lView[i-1]}`); }',\n-          'if (mask & 0b10) { icuSwitchCase(27, `${lView[i-2]}`); }',\n-          'if (mask & 0b1) { icuUpdateCase(23); }',\n+          `if (mask & 0b1) { icuSwitchCase(${HEADER_OFFSET + 2}, \\`\\${lView[i-1]}\\`); }`,\n+          `if (mask & 0b10) { icuSwitchCase(${HEADER_OFFSET + 6}, \\`\\${lView[i-2]}\\`); }`,\n+          `if (mask & 0b1) { icuUpdateCase(${HEADER_OFFSET + 2}); }`,\n         ]),\n       });\n-      expect(getTIcu(tView, 23)).toEqual({\n+      expect(getTIcu(tView, HEADER_OFFSET + 2)).toEqual({\n         type: 1,\n-        anchorIdx: 23,\n-        currentCaseLViewIndex: 24,\n+        anchorIdx: HEADER_OFFSET + 2,\n+        currentCaseLViewIndex: HEADER_OFFSET + 3,\n         cases: ['0', 'other'],\n         create: [\n           matchDebug([\n@@ -358,34 +363,35 @@ describe('Runtime i18n', () => {\n           matchDebug([\n             `lView[${HEADER_OFFSET + 5}] = document.createTextNode(\"\")`,\n             `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 5}])`,\n-            'lView[27] = document.createComment(\"nested ICU 0\")',\n+            `lView[${HEADER_OFFSET + 6}] = document.createComment(\"nested ICU 0\")`,\n             `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 6}])`,\n-            'lView[32] = document.createTextNode(\"!\")',\n-            '(lView[21] as Element).appendChild(lView[32])',\n+            `lView[${HEADER_OFFSET + 11}] = document.createTextNode(\"!\")`,\n+            `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 11}])`,\n           ]),\n         ],\n         update: [\n           matchDebug([]),\n           matchDebug([\n-            'if (mask & 0b1) { (lView[26] as Text).textContent = `${lView[i-1]} `; }',\n+            `if (mask & 0b1) { (lView[${\n+                HEADER_OFFSET + 5}] as Text).textContent = \\`\\${lView[i-1]} \\`; }`,\n           ]),\n         ],\n         remove: [\n           matchDebug([\n-            'remove(lView[25])',\n+            `remove(lView[${HEADER_OFFSET + 4}])`,\n           ]),\n           matchDebug([\n-            'remove(lView[26])',\n-            'removeNestedICU(27)',\n-            'remove(lView[27])',\n-            'remove(lView[32])',\n+            `remove(lView[${HEADER_OFFSET + 5}])`,\n+            `removeNestedICU(${HEADER_OFFSET + 6})`,\n+            `remove(lView[${HEADER_OFFSET + 6}])`,\n+            `remove(lView[${HEADER_OFFSET + 11}])`,\n           ]),\n         ],\n       });\n-      expect(tView.data[27]).toEqual({\n+      expect(tView.data[HEADER_OFFSET + 6]).toEqual({\n         type: 0,\n-        anchorIdx: 27,\n-        currentCaseLViewIndex: 28,\n+        anchorIdx: HEADER_OFFSET + 6,\n+        currentCaseLViewIndex: HEADER_OFFSET + 7,\n         cases: ['cat', 'dog', 'other'],\n         create: [\n           matchDebug([\n@@ -397,8 +403,8 @@ describe('Runtime i18n', () => {\n             `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 9}])`,\n           ]),\n           matchDebug([\n-            'lView[31] = document.createTextNode(\"animals\")',\n-            '(lView[21] as Element).appendChild(lView[31])',\n+            `lView[${HEADER_OFFSET + 10}] = document.createTextNode(\"animals\")`,\n+            `(lView[${HEADER_OFFSET + 0}] as Element).appendChild(lView[${HEADER_OFFSET + 10}])`,\n           ]),\n         ],\n         update: [\n@@ -407,9 +413,9 @@ describe('Runtime i18n', () => {\n           matchDebug([]),\n         ],\n         remove: [\n-          matchDebug(['remove(lView[29])']),\n-          matchDebug(['remove(lView[30])']),\n-          matchDebug(['remove(lView[31])']),\n+          matchDebug([`remove(lView[${HEADER_OFFSET + 8}])`]),\n+          matchDebug([`remove(lView[${HEADER_OFFSET + 9}])`]),\n+          matchDebug([`remove(lView[${HEADER_OFFSET + 10}])`]),\n         ],\n       });\n     });\n@@ -428,7 +434,8 @@ describe('Runtime i18n', () => {\n       }, undefined, nbConsts, HEADER_OFFSET + index);\n \n       expect(opCodes).toEqual(matchDebug([\n-        'if (mask & 0b1) { (lView[21] as Element).setAttribute(\\'title\\', `Hello ${lView[i-1]}!`); }',\n+        `if (mask & 0b1) { (lView[${\n+            HEADER_OFFSET + 0}] as Element).setAttribute('title', \\`Hello \\$\\{lView[i-1]}!\\`); }`,\n       ]));\n     });\n \n@@ -444,7 +451,9 @@ describe('Runtime i18n', () => {\n       }, undefined, nbConsts, HEADER_OFFSET + index);\n \n       expect(opCodes).toEqual(matchDebug([\n-        'if (mask & 0b11) { (lView[21] as Element).setAttribute(\\'title\\', `Hello ${lView[i-1]} and ${lView[i-2]}, again ${lView[i-1]}!`); }',\n+        `if (mask & 0b11) { (lView[${\n+            HEADER_OFFSET +\n+            0}] as Element).setAttribute('title', \\`Hello \\$\\{lView[i-1]} and \\$\\{lView[i-2]}, again \\$\\{lView[i-1]}!\\`); }`,\n       ]));\n     });\n \n@@ -460,8 +469,11 @@ describe('Runtime i18n', () => {\n       }, undefined, nbConsts, HEADER_OFFSET + index);\n \n       expect(opCodes).toEqual(matchDebug([\n-        'if (mask & 0b1) { (lView[21] as Element).setAttribute(\\'title\\', `Hello ${lView[i-1]}!`); }',\n-        'if (mask & 0b1) { (lView[21] as Element).setAttribute(\\'aria-label\\', `Hello ${lView[i-1]}!`); }',\n+        `if (mask & 0b1) { (lView[${\n+            HEADER_OFFSET + 0}] as Element).setAttribute('title', \\`Hello \\$\\{lView[i-1]}!\\`); }`,\n+        `if (mask & 0b1) { (lView[${\n+            HEADER_OFFSET +\n+            0}] as Element).setAttribute('aria-label', \\`Hello \\$\\{lView[i-1]}!\\`); }`,\n       ]));\n     });\n   });\n@@ -702,8 +714,10 @@ describe('Runtime i18n', () => {\n         ],\n       }));\n       expect(ti18n.update).toEqual(matchDebug([\n-        'if (mask & 0b1) { (lView[51] as Text).textContent = `${lView[i-1]} `; }',\n-        'if (mask & 0b10) { (lView[52] as Text).textContent = `${lView[i-2]}`; }'\n+        `if (mask & 0b1) { (lView[${\n+            HEADER_OFFSET + 30}] as Text).textContent = \\`\\${lView[i-1]} \\`; }`,\n+        `if (mask & 0b10) { (lView[${\n+            HEADER_OFFSET + 31}] as Text).textContent = \\`\\${lView[i-2]}\\`; }`\n       ]));\n       const lViewDebug = fixture.lView.debug!;\n       expect(lViewDebug.template).toEqual('<div>{{?}}<Placeholder>{{?}}</Placeholder>!</div>');\n@@ -714,16 +728,16 @@ describe('Runtime i18n', () => {\n           fixture.tView, 0, fixture.lView, HEADER_OFFSET + 1, 'Hello �*2:1�World�/*2:1�!', -1);\n       const ti18n = fixture.tView.data[HEADER_OFFSET + 1] as TI18n;\n       expect(ti18n.create.debug).toEqual([\n-        'lView[51] = document.createText(\"Hello \");',\n-        'parent.appendChild(lView[51]);',\n-        'lView[52] = document.createText(\"!\");',\n-        'parent.appendChild(lView[52]);',\n+        `lView[${HEADER_OFFSET + 30}] = document.createText(\"Hello \");`,\n+        `parent.appendChild(lView[${HEADER_OFFSET + 30}]);`,\n+        `lView[${HEADER_OFFSET + 31}] = document.createText(\"!\");`,\n+        `parent.appendChild(lView[${HEADER_OFFSET + 31}]);`,\n       ]);\n       // Leave behind `Placeholder` to be picked up by `TNode` creation.\n       // It should insert itself in front of \"!\"\n       expect(fixture.tView.data[HEADER_OFFSET + 2]).toEqual(matchTNode({\n         type: TNodeType.Placeholder,\n-        insertBeforeIndex: 52,\n+        insertBeforeIndex: HEADER_OFFSET + 31,\n       }));\n     });\n   });"
        },
        {
            "sha": "e055c3ec8022c1891961e74912f6a0da4e7e0041",
            "filename": "packages/core/test/render3/instructions/lview_debug_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Frender3%2Finstructions%2Flview_debug_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/36c7bebe40ad24975fc54f660a80d5cc90dc2a4f/packages%2Fcore%2Ftest%2Frender3%2Finstructions%2Flview_debug_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Finstructions%2Flview_debug_spec.ts?ref=36c7bebe40ad24975fc54f660a80d5cc90dc2a4f",
            "patch": "@@ -13,7 +13,7 @@ import {ɵɵelement, ɵɵelementEnd, ɵɵelementStart} from '@angular/core/src/r\n import {TNodeDebug} from '@angular/core/src/render3/instructions/lview_debug';\n import {createTNode, createTView} from '@angular/core/src/render3/instructions/shared';\n import {TNodeType} from '@angular/core/src/render3/interfaces/node';\n-import {LView, LViewDebug, TView, TViewType} from '@angular/core/src/render3/interfaces/view';\n+import {HEADER_OFFSET, LView, LViewDebug, TView, TViewType} from '@angular/core/src/render3/interfaces/view';\n import {enterView, leaveView} from '@angular/core/src/render3/state';\n import {insertTStylingBinding} from '@angular/core/src/render3/styling/style_binding_list';\n import {getComponentLView} from '@angular/core/src/render3/util/discovery_utils';\n@@ -242,7 +242,7 @@ describe('lView_debug', () => {\n         cumulativeBloom: jasmine.anything(),\n         providers: [MyChild.ɵdir],\n         viewProviders: [],\n-        parentInjectorIndex: 23,\n+        parentInjectorIndex: HEADER_OFFSET + 2,\n       });\n     });\n   });"
        }
    ],
    "stats": {
        "total": 573,
        "additions": 313,
        "deletions": 260
    }
}