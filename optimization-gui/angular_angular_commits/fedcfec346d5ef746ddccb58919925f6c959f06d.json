{
    "author": "sonukapoor",
    "message": "test(docs-infra): add missing tests for obserables and promises (#34537)\n\nThis commit adds missing tests for obserables and promises which\nare both stand-alone mini-apps.\n\nPR Close #34537",
    "sha": "fedcfec346d5ef746ddccb58919925f6c959f06d",
    "files": [
        {
            "sha": "e27ee9ced1a20915a9eecbf1004629a4491be944",
            "filename": "aio/content/examples/comparing-observables/src/observables.spec.ts",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/angular/angular/blob/fedcfec346d5ef746ddccb58919925f6c959f06d/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fobservables.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/fedcfec346d5ef746ddccb58919925f6c959f06d/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fobservables.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fobservables.spec.ts?ref=fedcfec346d5ef746ddccb58919925f6c959f06d",
            "patch": "@@ -0,0 +1,26 @@\n+import { docRegionChain, docRegionObservable, docRegionUnsubscribe } from './observables';\n+\n+describe('observables', () => {\n+  it('should print 2', (doneFn: DoneFn) => {\n+    const consoleLogSpy = spyOn(console, 'log');\n+    const observable = docRegionObservable(console);\n+    observable.subscribe(() => {\n+      expect(consoleLogSpy).toHaveBeenCalledTimes(1);\n+      expect(consoleLogSpy).toHaveBeenCalledWith(2);\n+      doneFn();\n+    });\n+  });\n+\n+  it('should close the subscription', () => {\n+    const subscription = docRegionUnsubscribe();\n+    expect(subscription.closed).toBeTruthy();\n+  });\n+\n+  it('should chain an observable', (doneFn: DoneFn) => {\n+    const observable = docRegionChain();\n+    observable.subscribe(value => {\n+      expect(value).toBe(4);\n+      doneFn();\n+    });\n+  });\n+});"
        },
        {
            "sha": "ffa1777279180a0a25594337c2775461b3bec618",
            "filename": "aio/content/examples/comparing-observables/src/observables.ts",
            "status": "modified",
            "additions": 57,
            "deletions": 25,
            "changes": 82,
            "blob_url": "https://github.com/angular/angular/blob/fedcfec346d5ef746ddccb58919925f6c959f06d/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fobservables.ts",
            "raw_url": "https://github.com/angular/angular/raw/fedcfec346d5ef746ddccb58919925f6c959f06d/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fobservables.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fobservables.ts?ref=fedcfec346d5ef746ddccb58919925f6c959f06d",
            "patch": "@@ -1,40 +1,72 @@\n-import { map } from 'rxjs/operators';\n+// #docplaster\n+\n import { Observable } from 'rxjs';\n+import { map } from 'rxjs/operators';\n \n-// #docregion observable\n+export function docRegionObservable(console: Console) {\n+  // #docregion observable\n \n-// declare a publishing operation\n-const observable = new Observable<number>(observer => {\n-  // Subscriber fn...\n-});\n+  // declare a publishing operation\n+  const observable = new Observable<number>(observer => {\n+    // Subscriber fn...\n+    // #enddocregion observable\n+    // The below code is used for unit testing only\n+    observer.next(2);\n+    // #docregion observable\n+  });\n \n-// initiate execution\n-observable.subscribe(() => {\n-  // observer handles notifications\n-});\n+  // initiate execution\n+  observable.subscribe(value => {\n+    // observer handles notifications\n+    // #enddocregion observable\n+    // The below code is used for unit testing only\n+    console.log(value);\n+    // #docregion observable\n+  });\n \n-// #enddocregion observable\n+  // #enddocregion observable\n+  return observable;\n+}\n \n-// #docregion unsubscribe\n+export function docRegionUnsubscribe() {\n+  const observable = new Observable<number>(() => {\n+    // Subscriber fn...\n+  });\n+  // #docregion unsubscribe\n \n-const subscription = observable.subscribe(() => {\n-  // observer handles notifications\n-});\n+  const subscription = observable.subscribe(() => {\n+    // observer handles notifications\n+  });\n \n-subscription.unsubscribe();\n+  subscription.unsubscribe();\n \n-// #enddocregion unsubscribe\n+  // #enddocregion unsubscribe\n+  return subscription;\n+}\n \n-// #docregion error\n+export function docRegionError() {\n+  const observable = new Observable<number>(() => {\n+    // Subscriber fn...\n+  });\n \n-observable.subscribe(() => {\n-  throw Error('my error');\n-});\n+  // #docregion error\n+  observable.subscribe(() => {\n+    throw new Error('my error');\n+  });\n+  // #enddocregion error\n+}\n \n-// #enddocregion error\n+export function docRegionChain() {\n+  let observable = new Observable<number>(observer => {\n+    // Subscriber fn...\n+    observer.next(2);\n+  });\n \n-// #docregion chain\n+  observable =\n+  // #docregion chain\n \n-observable.pipe(map(v => 2 * v));\n+  observable.pipe(map(v => 2 * v));\n \n-// #enddocregion chain\n+  // #enddocregion chain\n+  return observable;\n+}"
        },
        {
            "sha": "9d10092f1dc2367a53de3d7e492a895189fb3efa",
            "filename": "aio/content/examples/comparing-observables/src/promises.spec.ts",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/angular/angular/blob/fedcfec346d5ef746ddccb58919925f6c959f06d/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fpromises.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/fedcfec346d5ef746ddccb58919925f6c959f06d/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fpromises.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fpromises.spec.ts?ref=fedcfec346d5ef746ddccb58919925f6c959f06d",
            "patch": "@@ -0,0 +1,23 @@\n+import { docRegionError, docRegionPromise } from './promises';\n+\n+describe('promises', () => {\n+  it('should print 2', (doneFn: DoneFn) => {\n+    const consoleLogSpy = spyOn(console, 'log');\n+    const pr = docRegionPromise(console, 2);\n+    pr.then((value) => {\n+      expect(consoleLogSpy).toHaveBeenCalledTimes(1);\n+      expect(consoleLogSpy).toHaveBeenCalledWith(2);\n+      expect(value).toBe(4);\n+      doneFn();\n+    });\n+  });\n+\n+  it('should throw an error', (doneFn: DoneFn) => {\n+    const promise = docRegionError();\n+    promise\n+      .then(() => {\n+        throw new Error('Promise should be rejected.');\n+      },\n+        () => doneFn());\n+  });\n+});"
        },
        {
            "sha": "d24bba12ae4f6454c9b9ffacce26ef027c64d8ef",
            "filename": "aio/content/examples/comparing-observables/src/promises.ts",
            "status": "modified",
            "additions": 44,
            "deletions": 25,
            "changes": 69,
            "blob_url": "https://github.com/angular/angular/blob/fedcfec346d5ef746ddccb58919925f6c959f06d/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fpromises.ts",
            "raw_url": "https://github.com/angular/angular/raw/fedcfec346d5ef746ddccb58919925f6c959f06d/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fpromises.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fsrc%2Fpromises.ts?ref=fedcfec346d5ef746ddccb58919925f6c959f06d",
            "patch": "@@ -1,25 +1,44 @@\n-// #docregion promise\n-// initiate execution\n-const promise = new Promise<number>((resolve, reject) => {\n-  // Executer fn...\n-});\n-\n-promise.then(value => {\n-  // handle result here\n-});\n-\n-// #enddocregion promise\n-\n-// #docregion chain\n-\n-promise.then(v => 2 * v);\n-\n-// #enddocregion chain\n-\n-// #docregion error\n-\n-promise.then(() => {\n-  throw Error('my error');\n-});\n-\n-// #enddocregion error\n+// #docplaster\n+\n+export function docRegionPromise(console: Console, inputValue: number) {\n+  // #docregion promise\n+  // initiate execution\n+  let promise = new Promise<number>((resolve, reject) => {\n+    // Executer fn...\n+    // #enddocregion promise\n+    // The below is used in the unit tests.\n+    resolve(inputValue);\n+    // #docregion promise\n+  });\n+  // #enddocregion promise\n+  promise =\n+  // #docregion promise\n+  promise.then(value => {\n+    // handle result here\n+    // #enddocregion promise\n+    // The below is used in the unit tests.\n+    console.log(value);\n+    return value;\n+    // #docregion promise\n+  });\n+  // #enddocregion promise\n+  promise =\n+  // #docregion chain\n+  promise.then(v => 2 * v);\n+  // #enddocregion chain\n+\n+  return promise;\n+}\n+\n+export function docRegionError() {\n+  let promise = Promise.resolve();\n+  promise =\n+  // #docregion error\n+\n+  promise.then(() => {\n+    throw new Error('my error');\n+  });\n+\n+  // #enddocregion error\n+  return promise;\n+}"
        }
    ],
    "stats": {
        "total": 200,
        "additions": 150,
        "deletions": 50
    }
}