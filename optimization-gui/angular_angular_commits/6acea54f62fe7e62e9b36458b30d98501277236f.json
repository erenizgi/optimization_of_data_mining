{
    "author": "unknown",
    "message": "fix(common): mark locale data arrays as readonly (#30397)\n\nTo discourage developers from mutating the arrays returned\nfrom the following methods, their return types have been marked\nas readonly.\n\n* `getLocaleDayPeriods()`\n* `getLocaleDayNames()`\n* `getLocaleMonthNames()`\n* `getLocaleEraNames()`\n\nFixes #27003\n\nBREAKING CHANGE:\nThe locale data API has been marked as returning readonly arrays, rather\nthan mutable arrays, since these arrays are shared across calls to the\nAPI. If you were mutating them (e.g. calling `sort()`, `push()`, `splice()`, etc)\nthen your code will not longer compile. If you need to mutate the array, you\nshould now take a copy (e.g. by calling `slice()`) and mutate the copy.\n\nPR Close #30397",
    "sha": "6acea54f62fe7e62e9b36458b30d98501277236f",
    "files": [
        {
            "sha": "d7f8438c85aa04e613fd65cff02ac5038d370758",
            "filename": "goldens/public-api/common/common.d.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/6acea54f62fe7e62e9b36458b30d98501277236f/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/6acea54f62fe7e62e9b36458b30d98501277236f/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts?ref=6acea54f62fe7e62e9b36458b30d98501277236f",
            "patch": "@@ -61,13 +61,13 @@ export declare function getLocaleDateFormat(locale: string, width: FormatWidth):\n \n export declare function getLocaleDateTimeFormat(locale: string, width: FormatWidth): string;\n \n-export declare function getLocaleDayNames(locale: string, formStyle: FormStyle, width: TranslationWidth): string[];\n+export declare function getLocaleDayNames(locale: string, formStyle: FormStyle, width: TranslationWidth): ReadonlyArray<string>;\n \n-export declare function getLocaleDayPeriods(locale: string, formStyle: FormStyle, width: TranslationWidth): [string, string];\n+export declare function getLocaleDayPeriods(locale: string, formStyle: FormStyle, width: TranslationWidth): Readonly<[string, string]>;\n \n export declare function getLocaleDirection(locale: string): 'ltr' | 'rtl';\n \n-export declare function getLocaleEraNames(locale: string, width: TranslationWidth): [string, string];\n+export declare function getLocaleEraNames(locale: string, width: TranslationWidth): Readonly<[string, string]>;\n \n export declare function getLocaleExtraDayPeriodRules(locale: string): (Time | [Time, Time])[];\n \n@@ -77,7 +77,7 @@ export declare function getLocaleFirstDayOfWeek(locale: string): WeekDay;\n \n export declare function getLocaleId(locale: string): string;\n \n-export declare function getLocaleMonthNames(locale: string, formStyle: FormStyle, width: TranslationWidth): string[];\n+export declare function getLocaleMonthNames(locale: string, formStyle: FormStyle, width: TranslationWidth): ReadonlyArray<string>;\n \n export declare function getLocaleNumberFormat(locale: string, type: NumberFormatStyle): string;\n "
        },
        {
            "sha": "20221f759bab21bcf81078810ec4840bf0b8e73a",
            "filename": "packages/common/src/i18n/locale_data_api.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/6acea54f62fe7e62e9b36458b30d98501277236f/packages%2Fcommon%2Fsrc%2Fi18n%2Flocale_data_api.ts",
            "raw_url": "https://github.com/angular/angular/raw/6acea54f62fe7e62e9b36458b30d98501277236f/packages%2Fcommon%2Fsrc%2Fi18n%2Flocale_data_api.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fsrc%2Fi18n%2Flocale_data_api.ts?ref=6acea54f62fe7e62e9b36458b30d98501277236f",
            "patch": "@@ -233,7 +233,7 @@ export function getLocaleId(locale: string): string {\n  * @publicApi\n  */\n export function getLocaleDayPeriods(\n-    locale: string, formStyle: FormStyle, width: TranslationWidth): [string, string] {\n+    locale: string, formStyle: FormStyle, width: TranslationWidth): Readonly<[string, string]> {\n   const data = ɵfindLocaleData(locale);\n   const amPmData = <[string, string][][]>[\n     data[ɵLocaleDataIndex.DayPeriodsFormat], data[ɵLocaleDataIndex.DayPeriodsStandalone]\n@@ -255,7 +255,7 @@ export function getLocaleDayPeriods(\n  * @publicApi\n  */\n export function getLocaleDayNames(\n-    locale: string, formStyle: FormStyle, width: TranslationWidth): string[] {\n+    locale: string, formStyle: FormStyle, width: TranslationWidth): ReadonlyArray<string> {\n   const data = ɵfindLocaleData(locale);\n   const daysData =\n       <string[][][]>[data[ɵLocaleDataIndex.DaysFormat], data[ɵLocaleDataIndex.DaysStandalone]];\n@@ -276,7 +276,7 @@ export function getLocaleDayNames(\n  * @publicApi\n  */\n export function getLocaleMonthNames(\n-    locale: string, formStyle: FormStyle, width: TranslationWidth): string[] {\n+    locale: string, formStyle: FormStyle, width: TranslationWidth): ReadonlyArray<string> {\n   const data = ɵfindLocaleData(locale);\n   const monthsData =\n       <string[][][]>[data[ɵLocaleDataIndex.MonthsFormat], data[ɵLocaleDataIndex.MonthsStandalone]];\n@@ -287,7 +287,6 @@ export function getLocaleMonthNames(\n /**\n  * Retrieves Gregorian-calendar eras for the given locale.\n  * @param locale A locale code for the locale format rules to use.\n- * @param formStyle The required grammatical form.\n  * @param width The required character width.\n \n  * @returns An array of localized era strings.\n@@ -296,7 +295,8 @@ export function getLocaleMonthNames(\n  *\n  * @publicApi\n  */\n-export function getLocaleEraNames(locale: string, width: TranslationWidth): [string, string] {\n+export function getLocaleEraNames(\n+    locale: string, width: TranslationWidth): Readonly<[string, string]> {\n   const data = ɵfindLocaleData(locale);\n   const erasData = <[string, string][]>data[ɵLocaleDataIndex.Eras];\n   return getLastDefinedValue(erasData, width);"
        },
        {
            "sha": "406e1327dbcb596b19675df26f5bca768a27b92f",
            "filename": "packages/common/test/i18n/locale_data_api_spec.ts",
            "status": "modified",
            "additions": 92,
            "deletions": 1,
            "changes": 93,
            "blob_url": "https://github.com/angular/angular/blob/6acea54f62fe7e62e9b36458b30d98501277236f/packages%2Fcommon%2Ftest%2Fi18n%2Flocale_data_api_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6acea54f62fe7e62e9b36458b30d98501277236f/packages%2Fcommon%2Ftest%2Fi18n%2Flocale_data_api_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Ftest%2Fi18n%2Flocale_data_api_spec.ts?ref=6acea54f62fe7e62e9b36458b30d98501277236f",
            "patch": "@@ -13,7 +13,7 @@ import localeHe from '@angular/common/locales/he';\n import localeZh from '@angular/common/locales/zh';\n import {ɵregisterLocaleData, ɵunregisterLocaleData} from '@angular/core';\n \n-import {FormatWidth, getCurrencySymbol, getLocaleDateFormat, getLocaleDirection, getNumberOfCurrencyDigits} from '../../src/i18n/locale_data_api';\n+import {FormatWidth, FormStyle, getCurrencySymbol, getLocaleDateFormat, getLocaleDayNames, getLocaleDirection, getLocaleMonthNames, getNumberOfCurrencyDigits, TranslationWidth} from '../../src/i18n/locale_data_api';\n \n {\n   describe('locale data api', () => {\n@@ -71,5 +71,96 @@ import {FormatWidth, getCurrencySymbol, getLocaleDateFormat, getLocaleDirection,\n         expect(getLocaleDirection('en')).toEqual('ltr');\n       });\n     });\n+\n+    describe('getLocaleDayNames', () => {\n+      it('should return english short list of days', () => {\n+        expect(\n+            getLocaleDayNames('en-US', FormStyle.Format, TranslationWidth.Short),\n+            )\n+            .toEqual(['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa']);\n+      });\n+\n+      it('should return french short list of days', () => {\n+        expect(\n+            getLocaleDayNames('fr-CA', FormStyle.Format, TranslationWidth.Short),\n+            )\n+            .toEqual(['di', 'lu', 'ma', 'me', 'je', 've', 'sa']);\n+      });\n+\n+      it('should return english wide list of days', () => {\n+        expect(\n+            getLocaleDayNames('en-US', FormStyle.Format, TranslationWidth.Wide),\n+            )\n+            .toEqual(\n+                ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']);\n+      });\n+\n+      it('should return french wide list of days', () => {\n+        expect(\n+            getLocaleDayNames('fr-CA', FormStyle.Format, TranslationWidth.Wide),\n+            )\n+            .toEqual(['dimanche', 'lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi', 'samedi']);\n+      });\n+\n+      it('should return the full short list of days after manipulations', () => {\n+        const days =\n+            Array.from(getLocaleDayNames('en-US', FormStyle.Format, TranslationWidth.Short));\n+\n+        days.splice(2);\n+        days.push('unexisting_day');\n+\n+        const newDays = getLocaleDayNames('en-US', FormStyle.Format, TranslationWidth.Short);\n+\n+        expect(newDays.length).toBe(7);\n+\n+        expect(newDays).toEqual(['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa']);\n+      });\n+    });\n+\n+    describe('getLocaleMonthNames', () => {\n+      it('should return english abbreviated list of month', () => {\n+        expect(getLocaleMonthNames('en-US', FormStyle.Format, TranslationWidth.Abbreviated))\n+            .toEqual([\n+              'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'\n+            ]);\n+      });\n+\n+      it('should return french abbreviated list of month', () => {\n+        expect(getLocaleMonthNames('fr-CA', FormStyle.Format, TranslationWidth.Abbreviated))\n+            .toEqual([\n+              'janv.', 'févr.', 'mars', 'avr.', 'mai', 'juin', 'juil.', 'août', 'sept.', 'oct.',\n+              'nov.', 'déc.'\n+            ]);\n+      });\n+\n+      it('should return english wide list of month', () => {\n+        expect(getLocaleMonthNames('en-US', FormStyle.Format, TranslationWidth.Wide)).toEqual([\n+          'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September',\n+          'October', 'November', 'December'\n+        ]);\n+      });\n+\n+      it('should return french wide list of month', () => {\n+        expect(getLocaleMonthNames('fr-CA', FormStyle.Format, TranslationWidth.Wide)).toEqual([\n+          'janvier', 'février', 'mars', 'avril', 'mai', 'juin', 'juillet', 'août', 'septembre',\n+          'octobre', 'novembre', 'décembre'\n+        ]);\n+      });\n+\n+      it('should return the full abbreviated list of month after manipulations', () => {\n+        const month = Array.from(\n+            getLocaleMonthNames('en-US', FormStyle.Format, TranslationWidth.Abbreviated));\n+        month.splice(2);\n+        month.push('unexisting_month');\n+\n+        const newMonth =\n+            getLocaleMonthNames('en-US', FormStyle.Format, TranslationWidth.Abbreviated);\n+\n+        expect(newMonth.length).toBe(12);\n+\n+        expect(newMonth).toEqual(\n+            ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']);\n+      });\n+    });\n   });\n }"
        }
    ],
    "stats": {
        "total": 111,
        "additions": 101,
        "deletions": 10
    }
}