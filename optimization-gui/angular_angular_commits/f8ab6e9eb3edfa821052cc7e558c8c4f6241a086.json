{
    "author": "gkalpak",
    "message": "refactor(docs-infra): move `deploy-to-firebase.js` into a dedicated directory (#43963)\n\nThis commit moves the `aio/scripts/deploy-to-firebase.js` script into a\nnew directory, `aio/scripts/deploy-to-firebase/`. This will make it\neasier to break it up into multiple smaller files to better organize the\ncode (without polluting the `aio/scripts/` directory).\n\nPR Close #43963",
    "sha": "f8ab6e9eb3edfa821052cc7e558c8c4f6241a086",
    "files": [
        {
            "sha": "c1d986de779b4d7b698405260f93a8047ded510a",
            "filename": "aio/aio-builds-setup/docs/misc--integrate-with-ci.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Faio-builds-setup%2Fdocs%2Fmisc--integrate-with-ci.md",
            "raw_url": "https://github.com/angular/angular/raw/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Faio-builds-setup%2Fdocs%2Fmisc--integrate-with-ci.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Faio-builds-setup%2Fdocs%2Fmisc--integrate-with-ci.md?ref=f8ab6e9eb3edfa821052cc7e558c8c4f6241a086",
            "patch": "@@ -6,4 +6,4 @@ TODO (gkalpak): Add docs. Mention:\n   Relevant files: `aio/aio-builds-setup/scripts/test.sh`\n - Deploying from CI.\n   Relevant files: `.circleci/config.yml`, `scripts/ci/deploy.sh`, `aio/scripts/build-artifacts.sh`,\n-  `aio/scripts/deploy-to-firebase.js`\n+  `aio/scripts/deploy-to-firebase/index.js`"
        },
        {
            "sha": "0bb4e90207b325ad1467b33ce0c5563972e501a6",
            "filename": "aio/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Fpackage.json",
            "raw_url": "https://github.com/angular/angular/raw/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fpackage.json?ref=f8ab6e9eb3edfa821052cc7e558c8c4f6241a086",
            "patch": "@@ -57,7 +57,7 @@\n     \"redirects-test\": \"node tests/deployment/unit/test\",\n     \"firebase-utils-test\": \"node tools/firebase-test-utils/test\",\n     \"tools-lint\": \"eslint tools/firebase-test-utils && eslint tools/ng-packages-installer\",\n-    \"tools-test\": \"yarn docs-test && yarn boilerplate:test && jasmine tools/ng-packages-installer/index.spec.js && jasmine scripts/deploy-to-firebase.spec.js && yarn firebase-utils-test\",\n+    \"tools-test\": \"yarn docs-test && yarn boilerplate:test && jasmine tools/ng-packages-installer/index.spec.js && jasmine scripts/deploy-to-firebase/**/*.spec.js && yarn firebase-utils-test\",\n     \"preserve-and-sync\": \"yarn docs\",\n     \"serve-and-sync\": \"run-p \\\"docs-watch --watch-only\\\" \\\"start {@}\\\" --\",\n     \"boilerplate:add\": \"node ./tools/examples/example-boilerplate add\","
        },
        {
            "sha": "440f28838952fc89edcaa914d2733451361892ef",
            "filename": "aio/scripts/deploy-to-firebase/index.js",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Fscripts%2Fdeploy-to-firebase%2Findex.js",
            "raw_url": "https://github.com/angular/angular/raw/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Fscripts%2Fdeploy-to-firebase%2Findex.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fscripts%2Fdeploy-to-firebase%2Findex.js?ref=f8ab6e9eb3edfa821052cc7e558c8c4f6241a086",
            "patch": "@@ -244,7 +244,7 @@ function deploy(data) {\n     siteId,\n   } = data;\n \n-  cd(`${__dirname}/..`);\n+  cd(`${__dirname}/../..`);\n \n   console.log('\\n\\n\\n==== Run pre-deploy actions. ====\\n');\n   preDeployActions.forEach(fn => fn(data));",
            "previous_filename": "aio/scripts/deploy-to-firebase.js"
        },
        {
            "sha": "36b62b7c50df2c865a287139a30ac1c78adda110",
            "filename": "aio/scripts/deploy-to-firebase/index.spec.js",
            "status": "renamed",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Fscripts%2Fdeploy-to-firebase%2Findex.spec.js",
            "raw_url": "https://github.com/angular/angular/raw/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Fscripts%2Fdeploy-to-firebase%2Findex.spec.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fscripts%2Fdeploy-to-firebase%2Findex.spec.js?ref=f8ab6e9eb3edfa821052cc7e558c8c4f6241a086",
            "patch": "@@ -8,7 +8,7 @@ const {\n   computeMajorVersion,\n   getLatestCommit,\n   getMostRecentMinorBranch,\n-} = require('./deploy-to-firebase');\n+} = require('./index');\n \n \n describe('deploy-to-firebase:', () => {\n@@ -389,11 +389,11 @@ describe('deploy-to-firebase:', () => {\n \n   it('integration - should run the main script without error', () => {\n     // NOTE:\n-    // This test executes a new instance of the `deploy-to-firebase.js` script on a separate process\n+    // This test executes a new instance of the `deploy-to-firebase` script on a separate process\n     // and thus does not share the `getRemoteRefs()` cache. To improve stability, we retrieve the\n     // latest commit from master ignoring any cached entries.\n     const latestCommitOnMaster = getLatestCommit('master', {retrieveFromCache: false});\n-    const cmd = `\"${process.execPath}\" \"${__dirname}/deploy-to-firebase\" --dry-run`;\n+    const cmd = `\"${process.execPath}\" \"${__dirname}\" --dry-run`;\n     const env = {\n       CI_REPO_OWNER: 'angular',\n       CI_REPO_NAME: 'angular',",
            "previous_filename": "aio/scripts/deploy-to-firebase.spec.js"
        },
        {
            "sha": "a61c5ec205af5a10322859c798c632e16fa9df7e",
            "filename": "aio/src/extra-files/README.md",
            "status": "modified",
            "additions": 3,
            "deletions": 6,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Fsrc%2Fextra-files%2FREADME.md",
            "raw_url": "https://github.com/angular/angular/raw/f8ab6e9eb3edfa821052cc7e558c8c4f6241a086/aio%2Fsrc%2Fextra-files%2FREADME.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fextra-files%2FREADME.md?ref=f8ab6e9eb3edfa821052cc7e558c8c4f6241a086",
            "patch": "@@ -2,12 +2,9 @@\n \n This folder is used for extra files that should be included in deployments to firebase.\n \n-After the AIO application had been built and before it is deployed all files and folders\n-inside the folder with the same name as the current deployment mode (next, stable, archive)\n-will be copied to the `dist` folder.\n+After the AIO application had been built and before it is deployed all files and folders inside the folder with the same name as the current deployment mode (next, stable, archive) will be copied to the `dist` folder.\n \n-See the `scripts/deploy-to-firebase.js` script for more details.\n+See the `scripts/deploy-to-firebase/index.js` script for more details.\n \n **Note:**\n-The `deploy-to-firebase.js` script always expects there to be a folder for the current deployment\n-mode (even if it is empty).\n+The script always expects there to be a folder for the current deployment mode (even if it is empty)."
        }
    ],
    "stats": {
        "total": 21,
        "additions": 9,
        "deletions": 12
    }
}