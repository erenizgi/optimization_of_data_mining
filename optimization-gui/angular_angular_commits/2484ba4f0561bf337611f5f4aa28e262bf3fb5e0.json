{
    "author": "JoostK",
    "message": "refactor(compiler-cli): prepare linker options for compilation of components (#39707)\n\nThis commit adds the `i18nUseExternalIds` option to the linker options,\nas the compliance tests exercise compilation results with and without\nthis flag enabled. We therefore need to configure the linker to take\nthis option into account, as otherwise the compliance test output would\nnot be identical.\n\nAdditionally, this commit switches away from spread syntax to set\nthe default options. This introduced a problem when the user-provided\noptions object did specify the keys, but with an undefined value. This\nwould have prevented the default options from being applied.\n\nPR Close #39707",
    "sha": "2484ba4f0561bf337611f5f4aa28e262bf3fb5e0",
    "files": [
        {
            "sha": "ff1401b028f9450b7d6e52358bb4b528b25e8893",
            "filename": "packages/compiler-cli/linker/src/file_linker/linker_environment.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/2484ba4f0561bf337611f5f4aa28e262bf3fb5e0/packages%2Fcompiler-cli%2Flinker%2Fsrc%2Ffile_linker%2Flinker_environment.ts",
            "raw_url": "https://github.com/angular/angular/raw/2484ba4f0561bf337611f5f4aa28e262bf3fb5e0/packages%2Fcompiler-cli%2Flinker%2Fsrc%2Ffile_linker%2Flinker_environment.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Flinker%2Fsrc%2Ffile_linker%2Flinker_environment.ts?ref=2484ba4f0561bf337611f5f4aa28e262bf3fb5e0",
            "patch": "@@ -20,6 +20,12 @@ export class LinkerEnvironment<TStatement, TExpression> {\n   static create<TStatement, TExpression>(\n       host: AstHost<TExpression>, factory: AstFactory<TStatement, TExpression>,\n       options: Partial<LinkerOptions>): LinkerEnvironment<TStatement, TExpression> {\n-    return new LinkerEnvironment(host, factory, {...DEFAULT_LINKER_OPTIONS, ...options});\n+    return new LinkerEnvironment(host, factory, {\n+      enableI18nLegacyMessageIdFormat: options.enableI18nLegacyMessageIdFormat ??\n+          DEFAULT_LINKER_OPTIONS.enableI18nLegacyMessageIdFormat,\n+      i18nNormalizeLineEndingsInICUs: options.i18nNormalizeLineEndingsInICUs ??\n+          DEFAULT_LINKER_OPTIONS.i18nNormalizeLineEndingsInICUs,\n+      i18nUseExternalIds: options.i18nUseExternalIds ?? DEFAULT_LINKER_OPTIONS.i18nUseExternalIds,\n+    });\n   }\n }"
        },
        {
            "sha": "9c4d8feed0b9fd5fec8a23380cfd712dd0bccd53",
            "filename": "packages/compiler-cli/linker/src/file_linker/linker_options.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/2484ba4f0561bf337611f5f4aa28e262bf3fb5e0/packages%2Fcompiler-cli%2Flinker%2Fsrc%2Ffile_linker%2Flinker_options.ts",
            "raw_url": "https://github.com/angular/angular/raw/2484ba4f0561bf337611f5f4aa28e262bf3fb5e0/packages%2Fcompiler-cli%2Flinker%2Fsrc%2Ffile_linker%2Flinker_options.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Flinker%2Fsrc%2Ffile_linker%2Flinker_options.ts?ref=2484ba4f0561bf337611f5f4aa28e262bf3fb5e0",
            "patch": "@@ -20,6 +20,13 @@ export interface LinkerOptions {\n    * The default is `false`.\n    */\n   i18nNormalizeLineEndingsInICUs: boolean;\n+\n+  /**\n+   * Whether translation variable name should contain external message id\n+   * (used by Closure Compiler's output of `goog.getMsg` for transition period)\n+   * The default is `false`.\n+   */\n+  i18nUseExternalIds: boolean;\n }\n \n /**\n@@ -28,4 +35,5 @@ export interface LinkerOptions {\n export const DEFAULT_LINKER_OPTIONS: LinkerOptions = {\n   enableI18nLegacyMessageIdFormat: true,\n   i18nNormalizeLineEndingsInICUs: false,\n+  i18nUseExternalIds: false,\n };"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 15,
        "deletions": 1
    }
}