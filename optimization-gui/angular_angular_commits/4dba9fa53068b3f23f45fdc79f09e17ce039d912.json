{
    "author": "gkalpak",
    "message": "test(docs-infra): fix the `dependency-injection-in-action` e2e tests (#39818)\n\nPreviously, the tests made no meaningful assertions. It seems that the\nintention was to ensure that some elements were present on the page, but\nall the assertions did was verify that the corresponding\n`ElementFinder`s were defined. The `ElementFinder`s would always be\ndefined, even if there were no corresponding elements on the page. In\nfact, some of the `ElementFinder` selectors were incorrect, so they did\nnot match any actual elements.\n\nThis commit fixes the tests by fixing the `ElementFinder` selectors and\nasserting that the elements are actually present on the page.\n\nPR Close #39818",
    "sha": "4dba9fa53068b3f23f45fdc79f09e17ce039d912",
    "files": [
        {
            "sha": "857468f5b6f58911520a732a610105e288524189",
            "filename": "aio/content/examples/dependency-injection-in-action/e2e/src/app.e2e-spec.ts",
            "status": "modified",
            "additions": 27,
            "deletions": 34,
            "changes": 61,
            "blob_url": "https://github.com/angular/angular/blob/4dba9fa53068b3f23f45fdc79f09e17ce039d912/aio%2Fcontent%2Fexamples%2Fdependency-injection-in-action%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/4dba9fa53068b3f23f45fdc79f09e17ce039d912/aio%2Fcontent%2Fexamples%2Fdependency-injection-in-action%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fdependency-injection-in-action%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts?ref=4dba9fa53068b3f23f45fdc79f09e17ce039d912",
            "patch": "@@ -6,54 +6,47 @@ describe('Dependency Injection Cookbook', () => {\n         browser.get('');\n     });\n \n-    it('should render Logged in User example', () => {\n-      const loggedInUser = element.all(by.xpath('//h3[text()=\"Logged in user\"]')).get(0);\n-      expect(loggedInUser).toBeDefined();\n+    it('should render Logged in User example', async () => {\n+      const loggedInUser = element(by.cssContainingText('h3', 'Logged in user'));\n+      expect(await loggedInUser.isPresent()).toBe(true);\n     });\n \n-    it('\"Bombasto\" should be the logged in user', () => {\n-      const loggedInUser = element.all(by.xpath('//div[text()=\"Name: Bombasto\"]')).get(0);\n-      expect(loggedInUser).toBeDefined();\n+    it('\"Bombasto\" should be the logged in user', async () => {\n+      const loggedInUser = element(by.cssContainingText('div', 'Name: Bombasto'));\n+      expect(await loggedInUser.isPresent()).toBe(true);\n     });\n \n-    it('should render sorted heroes', () => {\n-      const sortedHeroes = element.all(by.xpath('//h3[text()=\"Sorted Heroes\" and position()=1]')).get(0);\n-      expect(sortedHeroes).toBeDefined();\n-    });\n-\n-    it('Dr Nice should be in sorted heroes', () => {\n-      const sortedHero = element.all(by.xpath('//sorted-heroes/[text()=\"Dr Nice\" and position()=2]')).get(0);\n-      expect(sortedHero).toBeDefined();\n-    });\n+    it('should render sorted heroes', async () => {\n+      const sortedHeroes = element(by.cssContainingText('h3', 'Sorted Heroes'));\n+      expect(await sortedHeroes.isPresent()).toBe(true);\n \n-    it('RubberMan should be in sorted heroes', () => {\n-      const sortedHero = element.all(by.xpath('//sorted-heroes/[text()=\"RubberMan\" and position()=3]')).get(0);\n-      expect(sortedHero).toBeDefined();\n+      const sortedHeroElems = element.all(by.css('app-sorted-heroes div'));\n+      const sortedHeroNames = await sortedHeroElems.map(elem => elem.getText());\n+      expect(sortedHeroNames).toEqual(['Dr Nice', 'Magma', 'RubberMan']);\n     });\n \n-    it('Magma should be in sorted heroes', () => {\n-      const sortedHero = element.all(by.xpath('//sorted-heroes/[text()=\"Magma\"]')).get(0);\n-      expect(sortedHero).toBeDefined();\n+    it('should render Hero of the Month', async () => {\n+      const heroOfTheMonth = element(by.cssContainingText('h3', 'Hero of the Month'));\n+      expect(await heroOfTheMonth.isPresent()).toBe(true);\n     });\n \n-    it('should render Hero of the Month', () => {\n-      const heroOfTheMonth = element.all(by.xpath('//h3[text()=\"Hero of the month\"]')).get(0);\n-      expect(heroOfTheMonth).toBeDefined();\n+    it('should render Hero Bios', async () => {\n+      const heroBios = element(by.cssContainingText('h3', 'Hero Bios'));\n+      expect(await heroBios.isPresent()).toBe(true);\n     });\n \n-    it('should render Hero Bios', () => {\n-      const heroBios = element.all(by.xpath('//h3[text()=\"Hero Bios\"]')).get(0);\n-      expect(heroBios).toBeDefined();\n-    });\n+    it('should render Magma\\'s description in Hero Bios', async () => {\n+      const magmaBioElem = element.all(by.css('app-hero-bio')).get(1);\n+      const magmaNameElem = magmaBioElem.element(by.css('h4'));\n+      const magmaDescElem = magmaBioElem.element(by.css('textarea'));\n \n-    it('should render Magma\\'s description in Hero Bios', () => {\n-      const magmaText =  element.all(by.xpath('//textarea[text()=\"Hero of all trades\"]')).get(0);\n-      expect(magmaText).toBeDefined();\n+      expect(await magmaNameElem.getText()).toBe('Magma');\n+      expect(await magmaDescElem.getAttribute('value')).toBe('Hero of all trades');\n     });\n \n-    it('should render Magma\\'s phone in Hero Bios and Contacts', () => {\n-      const magmaPhone =  element.all(by.xpath('//div[text()=\"Phone #: 555-555-5555\"]')).get(0);\n-      expect(magmaPhone).toBeDefined();\n+    it('should render Magma\\'s phone in Hero Bios and Contacts', async () => {\n+      const magmaPhone = element(by.cssContainingText('div', 'Phone #: 555-555-5555'));\n+      expect(await magmaPhone.isPresent()).toBe(true);\n     });\n \n     it('should render Hero-of-the-Month runner-ups', () => {"
        }
    ],
    "stats": {
        "total": 61,
        "additions": 27,
        "deletions": 34
    }
}