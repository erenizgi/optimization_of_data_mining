{
    "author": "petebacondarwin",
    "message": "refactor(localize): allow ParsedMessage to hold additional location data (#38536)\n\nIn preparation for supporting `equiv-text` placeholder information in\nextracted translation files, this commit adds these optional properties\nto the `ParsedMessage` interface and updates `parseMessage()` to\nbe able to store them.\n\nPR Close #38536",
    "sha": "23f855b3000b46f10af44baae23fb5ea5b31d106",
    "files": [
        {
            "sha": "e19593ccdfcfcda718a669bb12989b1ba4774cdc",
            "filename": "packages/localize/src/utils/src/messages.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 2,
            "changes": 18,
            "blob_url": "https://github.com/angular/angular/blob/23f855b3000b46f10af44baae23fb5ea5b31d106/packages%2Flocalize%2Fsrc%2Futils%2Fsrc%2Fmessages.ts",
            "raw_url": "https://github.com/angular/angular/raw/23f855b3000b46f10af44baae23fb5ea5b31d106/packages%2Flocalize%2Fsrc%2Futils%2Fsrc%2Fmessages.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flocalize%2Fsrc%2Futils%2Fsrc%2Fmessages.ts?ref=23f855b3000b46f10af44baae23fb5ea5b31d106",
            "patch": "@@ -48,6 +48,7 @@ export interface SourceLocation {\n   start: {line: number, column: number};\n   end: {line: number, column: number};\n   file: AbsoluteFsPath;\n+  text?: string;\n }\n \n /**\n@@ -118,10 +119,18 @@ export interface ParsedMessage extends MessageMetadata {\n    * A mapping of placeholder names to substitution values.\n    */\n   substitutions: Record<string, any>;\n+  /**\n+   * An optional mapping of placeholder names to source locations\n+   */\n+  substitutionLocations?: Record<string, SourceLocation|undefined>;\n   /**\n    * The static parts of the message.\n    */\n   messageParts: string[];\n+  /**\n+   * An optional mapping of message parts to source locations\n+   */\n+  messagePartLocations?: (SourceLocation|undefined)[];\n   /**\n    * The names of the placeholders that will be replaced with substitutions.\n    */\n@@ -135,9 +144,11 @@ export interface ParsedMessage extends MessageMetadata {\n  * See `ParsedMessage` for an example.\n  */\n export function parseMessage(\n-    messageParts: TemplateStringsArray, expressions?: readonly any[],\n-    location?: SourceLocation): ParsedMessage {\n+    messageParts: TemplateStringsArray, expressions?: readonly any[], location?: SourceLocation,\n+    messagePartLocations?: (SourceLocation|undefined)[],\n+    expressionLocations: (SourceLocation|undefined)[] = []): ParsedMessage {\n   const substitutions: {[placeholderName: string]: any} = {};\n+  const substitutionLocations: {[placeholderName: string]: SourceLocation|undefined} = {};\n   const metadata = parseMetadata(messageParts[0], messageParts.raw[0]);\n   const cleanedMessageParts: string[] = [metadata.text];\n   const placeholderNames: string[] = [];\n@@ -148,6 +159,7 @@ export function parseMessage(\n     messageString += `{$${placeholderName}}${messagePart}`;\n     if (expressions !== undefined) {\n       substitutions[placeholderName] = expressions[i - 1];\n+      substitutionLocations[placeholderName] = expressionLocations[i - 1];\n     }\n     placeholderNames.push(placeholderName);\n     cleanedMessageParts.push(messagePart);\n@@ -158,11 +170,13 @@ export function parseMessage(\n     id: messageId,\n     legacyIds,\n     substitutions,\n+    substitutionLocations,\n     text: messageString,\n     customId: metadata.customId,\n     meaning: metadata.meaning || '',\n     description: metadata.description || '',\n     messageParts: cleanedMessageParts,\n+    messagePartLocations,\n     placeholderNames,\n     location,\n   };"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 16,
        "deletions": 2
    }
}