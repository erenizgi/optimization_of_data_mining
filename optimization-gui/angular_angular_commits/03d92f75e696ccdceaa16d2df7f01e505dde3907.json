{
    "author": "petebacondarwin",
    "message": "build(docs-infra): enable Ivy in StackBlitz examples (#40930)\n\nWe need to explicitly set the `enableIvy` option in a tsconfig file\nto tell StackBlitz not to use ViewEngine.\n\nThis commit will generate an appropriate tsconfig.json file in the\nexample data that is sent to StackBlitz, which matches the Ivy\nsetting of the AIO project itself.\n\nPR Close #40930",
    "sha": "03d92f75e696ccdceaa16d2df7f01e505dde3907",
    "files": [
        {
            "sha": "2c974301ffd594c80eb530fdef9be1aae6e7e4c6",
            "filename": "aio/tools/examples/shared/boilerplate/viewengine/cli/tsconfig.json",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/03d92f75e696ccdceaa16d2df7f01e505dde3907/aio%2Ftools%2Fexamples%2Fshared%2Fboilerplate%2Fviewengine%2Fcli%2Ftsconfig.json",
            "raw_url": "https://github.com/angular/angular/raw/03d92f75e696ccdceaa16d2df7f01e505dde3907/aio%2Ftools%2Fexamples%2Fshared%2Fboilerplate%2Fviewengine%2Fcli%2Ftsconfig.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Ftools%2Fexamples%2Fshared%2Fboilerplate%2Fviewengine%2Fcli%2Ftsconfig.json?ref=03d92f75e696ccdceaa16d2df7f01e505dde3907",
            "patch": "@@ -26,7 +26,6 @@\n     \"enableIvy\": false,\n     \"strictInjectionParameters\": true,\n     \"strictInputAccessModifiers\": true,\n-    // TODO(gkalpak): Fix the code and enable this (i.e. switch from `fullTemplateTypeCheck` to `strictTemplates`).\n-    \"fullTemplateTypeCheck\": true,// \"strictTemplates\": true\n+    \"strictTemplates\": true\n   }\n }"
        },
        {
            "sha": "52fc3b1f1ec8483296f0bcc21db871e399a720be",
            "filename": "aio/tools/stackblitz-builder/builder.js",
            "status": "modified",
            "additions": 14,
            "deletions": 2,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/03d92f75e696ccdceaa16d2df7f01e505dde3907/aio%2Ftools%2Fstackblitz-builder%2Fbuilder.js",
            "raw_url": "https://github.com/angular/angular/raw/03d92f75e696ccdceaa16d2df7f01e505dde3907/aio%2Ftools%2Fstackblitz-builder%2Fbuilder.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Ftools%2Fstackblitz-builder%2Fbuilder.js?ref=03d92f75e696ccdceaa16d2df7f01e505dde3907",
            "patch": "@@ -5,6 +5,7 @@ const path = require('canonical-path');\n const fs = require('fs-extra');\n const globby = require('globby');\n const jsdom = require('jsdom');\n+const json5 = require('json5');\n \n const regionExtractor = require('../transforms/examples-package/services/region-parser');\n \n@@ -226,6 +227,18 @@ class StackblitzBuilder {\n       postData[`files[${relativeFileName}]`] = content;\n     });\n \n+    // Stackblitz defaults to ViewEngine unless `\"enableIvy\": true`\n+    // So if there is a tsconfig.json file and there is no `enableIvy` property, we need to\n+    // explicitly set it.\n+    const tsConfigJSON = postData['files[tsconfig.json]'];\n+    if (tsConfigJSON !== undefined) {\n+      const tsConfig = json5.parse(tsConfigJSON);\n+      if (tsConfig.angularCompilerOptions.enableIvy === undefined) {\n+        tsConfig.angularCompilerOptions.enableIvy = true;\n+        postData['files[tsconfig.json]'] = JSON.stringify(tsConfig, null, 2);\n+      }\n+    }\n+\n     const tags = ['angular', 'example', ...config.tags || []];\n     tags.forEach((tag, ix) => postData[`tags[${ix}]`] = tag);\n \n@@ -263,7 +276,7 @@ class StackblitzBuilder {\n     const config = this._parseConfig(configFileName);\n \n     const defaultIncludes = ['**/*.ts', '**/*.js', '**/*.css', '**/*.html', '**/*.md', '**/*.json', '**/*.png', '**/*.svg'];\n-    const boilerplateIncludes = ['src/environments/*.*', 'angular.json', 'src/polyfills.ts'];\n+    const boilerplateIncludes = ['src/environments/*.*', 'angular.json', 'src/polyfills.ts', 'tsconfig.json'];\n     if (config.files) {\n       if (config.files.length > 0) {\n         if (config.files[0][0] === '!') {\n@@ -288,7 +301,6 @@ class StackblitzBuilder {\n \n     const defaultExcludes = [\n       '!**/e2e/**/*.*',\n-      '!**/tsconfig.json',\n       '!**/package.json',\n       '!**/example-config.json',\n       '!**/tslint.json',"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 15,
        "deletions": 4
    }
}