{
    "author": "iRealNirmal",
    "message": "fix(forms): Add float number support for min and max validator (#42223)\n\nAdded float number support for minValidator and maxValidator\n\nCloses #42215\n\nPR Close #42223",
    "sha": "3d9062dad74c28e7c5b7849ae35dcb2e85ee7921",
    "files": [
        {
            "sha": "566e0167acc07f17b583c28fb6c867a5231fe71e",
            "filename": "packages/forms/src/directives/validators.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/3d9062dad74c28e7c5b7849ae35dcb2e85ee7921/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "raw_url": "https://github.com/angular/angular/raw/3d9062dad74c28e7c5b7849ae35dcb2e85ee7921/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts?ref=3d9062dad74c28e7c5b7849ae35dcb2e85ee7921",
            "patch": "@@ -178,7 +178,7 @@ export class MaxValidator extends AbstractValidatorDirective implements OnChange\n   /** @internal */\n   inputName = 'max';\n   /** @internal */\n-  normalizeInput = (input: string): number => parseInt(input, 10);\n+  normalizeInput = (input: string): number => parseFloat(input);\n   /** @internal */\n   createValidator = (max: number): ValidatorFn => maxValidator(max);\n   /**\n@@ -238,7 +238,7 @@ export class MinValidator extends AbstractValidatorDirective implements OnChange\n   /** @internal */\n   inputName = 'min';\n   /** @internal */\n-  normalizeInput = (input: string): number => parseInt(input, 10);\n+  normalizeInput = (input: string): number => parseFloat(input);\n   /** @internal */\n   createValidator = (min: number): ValidatorFn => minValidator(min);\n   /**"
        },
        {
            "sha": "acbe4eb995c64901206dba2105b36fcac44a5a89",
            "filename": "packages/forms/test/reactive_integration_spec.ts",
            "status": "modified",
            "additions": 68,
            "deletions": 0,
            "changes": 68,
            "blob_url": "https://github.com/angular/angular/blob/3d9062dad74c28e7c5b7849ae35dcb2e85ee7921/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/3d9062dad74c28e7c5b7849ae35dcb2e85ee7921/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts?ref=3d9062dad74c28e7c5b7849ae35dcb2e85ee7921",
            "patch": "@@ -2563,6 +2563,40 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n             expect(form.controls.pin.errors).toEqual({max: {max: 1, actual: 2}});\n           });\n \n+          it('should validate max for float number', () => {\n+            const fixture = initTest(getComponent(dir));\n+            const control = new FormControl(10.25);\n+            fixture.componentInstance.control = control;\n+            fixture.componentInstance.form = new FormGroup({'pin': control});\n+            fixture.componentInstance.max = 10.35;\n+            fixture.detectChanges();\n+\n+            const input = fixture.debugElement.query(By.css('input')).nativeElement;\n+            const form = fixture.componentInstance.form;\n+\n+            expect(input.value).toEqual('10.25');\n+            expect(form.valid).toBeTruthy();\n+            expect(form.controls.pin.errors).toBeNull();\n+\n+            input.value = 10.15;\n+            dispatchEvent(input, 'input');\n+            expect(form.value).toEqual({pin: 10.15});\n+            expect(form.valid).toBeTruthy();\n+            expect(form.controls.pin.errors).toBeNull();\n+\n+            fixture.componentInstance.max = 10.05;\n+            fixture.detectChanges();\n+\n+            expect(form.valid).toBeFalse();\n+            expect(form.controls.pin.errors).toEqual({max: {max: 10.05, actual: 10.15}});\n+\n+            input.value = 10.01;\n+            dispatchEvent(input, 'input');\n+            expect(form.value).toEqual({pin: 10.01});\n+            expect(form.valid).toBeTruthy();\n+            expect(form.controls.pin.errors).toBeNull();\n+          });\n+\n           it('should apply max validation when control value is defined as a string', () => {\n             const fixture = initTest(getComponent(dir));\n             const control = new FormControl('5');\n@@ -2615,6 +2649,40 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n             expect(form.controls.pin.errors).toEqual({min: {min: 5, actual: 2}});\n           });\n \n+          it('should validate min for float number', () => {\n+            const fixture = initTest(getComponent(dir));\n+            const control = new FormControl(10.25);\n+            fixture.componentInstance.control = control;\n+            fixture.componentInstance.form = new FormGroup({'pin': control});\n+            fixture.componentInstance.max = 10.50;\n+            fixture.componentInstance.min = 10.25;\n+            fixture.detectChanges();\n+\n+            const input = fixture.debugElement.query(By.css('input')).nativeElement;\n+            const form = fixture.componentInstance.form;\n+\n+            expect(input.value).toEqual('10.25');\n+            expect(form.valid).toBeTruthy();\n+            expect(form.controls.pin.errors).toBeNull();\n+\n+            input.value = 10.35;\n+            dispatchEvent(input, 'input');\n+            expect(form.value).toEqual({pin: 10.35});\n+            expect(form.valid).toBeTruthy();\n+            expect(form.controls.pin.errors).toBeNull();\n+\n+            fixture.componentInstance.min = 10.40;\n+            fixture.detectChanges();\n+            expect(form.valid).toBeFalse();\n+            expect(form.controls.pin.errors).toEqual({min: {min: 10.40, actual: 10.35}});\n+\n+            input.value = 10.45;\n+            dispatchEvent(input, 'input');\n+            expect(form.value).toEqual({pin: 10.45});\n+            expect(form.valid).toBeTruthy();\n+            expect(form.controls.pin.errors).toBeNull();\n+          });\n+\n           it('should apply min validation when control value is defined as a string', () => {\n             const fixture = initTest(getComponent(dir));\n             const control = new FormControl('5');"
        },
        {
            "sha": "859c25f9e8fef41b32180beaa80e1e2cb6ab25d7",
            "filename": "packages/forms/test/template_integration_spec.ts",
            "status": "modified",
            "additions": 67,
            "deletions": 0,
            "changes": 67,
            "blob_url": "https://github.com/angular/angular/blob/3d9062dad74c28e7c5b7849ae35dcb2e85ee7921/packages%2Fforms%2Ftest%2Ftemplate_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/3d9062dad74c28e7c5b7849ae35dcb2e85ee7921/packages%2Fforms%2Ftest%2Ftemplate_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Ftemplate_integration_spec.ts?ref=3d9062dad74c28e7c5b7849ae35dcb2e85ee7921",
            "patch": "@@ -1540,6 +1540,40 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            expect(form.controls.max.errors).toBeNull();\n          }));\n \n+      it('should validate max for float number', fakeAsync(() => {\n+           const fixture = initTest(NgModelMaxValidator);\n+           fixture.componentInstance.max = 10.25;\n+           fixture.detectChanges();\n+           tick();\n+\n+           const input = fixture.debugElement.query(By.css('input')).nativeElement;\n+           const form = fixture.debugElement.children[0].injector.get(NgForm);\n+\n+           input.value = '';\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(true);\n+           expect(form.controls.max.errors).toBeNull();\n+\n+           input.value = 10.25;\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(true);\n+           expect(form.controls.max.errors).toBeNull();\n+\n+           input.value = 10.15;\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(true);\n+           expect(form.controls.max.errors).toBeNull();\n+\n+           input.value = 10.35;\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(false);\n+           expect(form.controls.max.errors).toEqual({max: {max: 10.25, actual: 10.35}});\n+         }));\n+\n       it('should apply max validation when control value is defined as a string', fakeAsync(() => {\n            const fixture = initTest(NgModelMaxValidator);\n            fixture.componentInstance.max = 10;\n@@ -1617,6 +1651,39 @@ import {NgModelCustomComp, NgModelCustomWrapper} from './value_accessor_integrat\n            expect(form.controls.min.errors).toEqual({min: {min: 10, actual: 9}});\n          }));\n \n+      it('should validate min for float number', fakeAsync(() => {\n+           const fixture = initTest(NgModelMinValidator);\n+           fixture.componentInstance.min = 10.25;\n+           fixture.detectChanges();\n+           tick();\n+\n+           const input = fixture.debugElement.query(By.css('input')).nativeElement;\n+           const form = fixture.debugElement.children[0].injector.get(NgForm);\n+\n+           input.value = '';\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(true);\n+           expect(form.controls.min.errors).toBeNull();\n+\n+           input.value = 10.35;\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(true);\n+           expect(form.controls.min.errors).toBeNull();\n+\n+           input.value = 10.25;\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(true);\n+           expect(form.controls.min.errors).toBeNull();\n+\n+           input.value = 10.15;\n+           dispatchEvent(input, 'input');\n+           fixture.detectChanges();\n+           expect(form.valid).toEqual(false);\n+           expect(form.controls.min.errors).toEqual({min: {min: 10.25, actual: 10.15}});\n+         }));\n       it('should apply min validation when control value is defined as a string', fakeAsync(() => {\n            const fixture = initTest(NgModelMinValidator);\n            fixture.componentInstance.min = 10;"
        },
        {
            "sha": "a42c14774ce8af99757f9d484c51d332910867e1",
            "filename": "packages/forms/test/validators_spec.ts",
            "status": "modified",
            "additions": 28,
            "deletions": 0,
            "changes": 28,
            "blob_url": "https://github.com/angular/angular/blob/3d9062dad74c28e7c5b7849ae35dcb2e85ee7921/packages%2Fforms%2Ftest%2Fvalidators_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/3d9062dad74c28e7c5b7849ae35dcb2e85ee7921/packages%2Fforms%2Ftest%2Fvalidators_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Fvalidators_spec.ts?ref=3d9062dad74c28e7c5b7849ae35dcb2e85ee7921",
            "patch": "@@ -61,6 +61,20 @@ describe('Validators', () => {\n       expect(Validators.min(2)(new FormControl('1'))).toEqual({'min': {'min': 2, 'actual': '1'}});\n     });\n \n+    it('should not error on small float number validation', () => {\n+      expect(Validators.min(1.20)(new FormControl(1.25))).toBeNull();\n+    });\n+\n+    it('should not error on equal float values', () => {\n+      expect(Validators.min(1.25)(new FormControl(1.25))).toBeNull();\n+    });\n+\n+    it('should return a validation error on big values', () => {\n+      expect(Validators.min(1.25)(new FormControl(1.20))).toEqual({\n+        'min': {'min': 1.25, 'actual': 1.20}\n+      });\n+    });\n+\n     it('should not error on big values', () => {\n       expect(Validators.min(2)(new FormControl(3))).toBeNull();\n     });\n@@ -105,6 +119,20 @@ describe('Validators', () => {\n       expect(Validators.max(2)(new FormControl('aaa'))).toBeNull();\n     });\n \n+    it('should not error on small float number validation', () => {\n+      expect(Validators.max(1.20)(new FormControl(1.15))).toBeNull();\n+    });\n+\n+    it('should not error on equal float values', () => {\n+      expect(Validators.max(1.25)(new FormControl(1.25))).toBeNull();\n+    });\n+\n+    it('should return a validation error on big values', () => {\n+      expect(Validators.max(1.25)(new FormControl(1.30))).toEqual({\n+        'max': {'max': 1.25, 'actual': 1.30}\n+      });\n+    });\n+\n     it('should return a validation error on big values', () => {\n       expect(Validators.max(2)(new FormControl(3))).toEqual({'max': {'max': 2, 'actual': 3}});\n     });"
        }
    ],
    "stats": {
        "total": 167,
        "additions": 165,
        "deletions": 2
    }
}