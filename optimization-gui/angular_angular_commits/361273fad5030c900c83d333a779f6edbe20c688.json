{
    "author": "JoostK",
    "message": "refactor(router): remove support for `loadChildren` string syntax (#43591)\n\nThis commit removes the ability to configure lazy routes using a string\nfor `loadChildren`, together with the supporting classes to load an\n`NgModuleFactory` at runtime.\n\nBREAKING CHANGE:\n\nIt is no longer possible to use `Route.loadChildren` using a string\nvalue. The following supporting classes were removed from\n`@angular/core`:\n\n- `NgModuleFactoryLoader`\n- `SystemJsNgModuleFactoryLoader`\n\nThe `@angular/router` package no longer exports these symbols:\n\n- `SpyNgModuleFactoryLoader`\n- `DeprecatedLoadChildren`\n\nThe signature of the `setupTestingRouter` function from\n`@angular/core/testing` has been changed to drop its `NgModuleFactoryLoader`\nparameter, as an argument for that parameter can no longer be created.\n\nPR Close #43591",
    "sha": "361273fad5030c900c83d333a779f6edbe20c688",
    "files": [
        {
            "sha": "675944949aaa69bc99b3dcec43cc66b438c2eeee",
            "filename": "aio/content/guide/deprecations.md",
            "status": "modified",
            "additions": 9,
            "deletions": 1,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/aio%2Fcontent%2Fguide%2Fdeprecations.md",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/aio%2Fcontent%2Fguide%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fguide%2Fdeprecations.md?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -55,7 +55,6 @@ v12 - v15\n | `@angular/core`         | [`entryComponents`](api/core/NgModule#entryComponents)                                        | <!--v9--> v11         |\n | `@angular/core`         | [`ANALYZE_FOR_ENTRY_COMPONENTS`](api/core/ANALYZE_FOR_ENTRY_COMPONENTS)                       | <!--v9--> v11         |\n | `@angular/core`         | [Factory-based signature of `ViewContainerRef.createComponent`](api/core/ViewContainerRef#createComponent)                       | <!--v13--> v15         |\n-| `@angular/router`       | [`loadChildren` string syntax](#loadChildren)                                                 | <!--v9--> v11         |\n | `@angular/core/testing` | [`TestBed.get`](#testing)                                                                     | <!--v9--> v12         |\n | `@angular/core/testing` | [`async`](#testing)                                                                           | <!--v9--> v12         |\n | `@angular/core/testing` | [`aotSummaries` argument in `TestBed.initTestEnvironment`](#testing)                                                                           | <!--v13--> v14         |\n@@ -630,6 +629,15 @@ For more information about the npm package format, see the [Angular Package Form\n \n Angular used to sanitize `[style]` and `[style.prop]` bindings to prevent malicious code from being inserted through `javascript:` expressions in CSS `url()` entries. However, most modern browsers no longer support the usage of these expressions, so sanitization was only maintained for the sake of IE 6 and 7. Given that Angular does not support either IE 6 or 7 and sanitization has a performance cost, we will no longer sanitize style bindings as of version 10 of Angular.\n \n+### `loadChildren` string syntax in `@angular/router`\n+\n+It is no longer possible to use the `loadChildren` string syntax to configure lazy routes.\n+The string syntax has been replaced with dynamic import statements.\n+The `DeprecatedLoadChildren` type was removed from `@angular/router`.\n+Find more information about the replacement in the [`LoadChildrenCallback` documentation](api/router/LoadChildrenCallback).\n+\n+The supporting classes `NgModuleFactoryLoader`, `SystemJsNgModuleLoader` and `SystemJsNgModuleLoaderConfig` classes were removed from `@angular/core`, as well as `SpyNgModuleFactoryLoader` from `@angular/router`.\n+\n <!-- links -->\n \n [AioGuideI18nCommonMergeDefineLocalesInTheBuildConfiguration]: guide/i18n-common-merge#define-locales-in-the-build-configuration \"Define locales in the build configuration - Common Internationalization task #6: Merge translations into the application | Angular\""
        },
        {
            "sha": "a24d056349de1e5aad3a6bf54860ced1e4e4b92c",
            "filename": "goldens/public-api/core/core.md",
            "status": "modified",
            "additions": 0,
            "deletions": 19,
            "changes": 19,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fpublic-api%2Fcore%2Fcore.md",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fpublic-api%2Fcore%2Fcore.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fcore%2Fcore.md?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -813,12 +813,6 @@ export abstract class NgModuleFactory<T> {\n     abstract get moduleType(): Type<T>;\n }\n \n-// @public @deprecated\n-export abstract class NgModuleFactoryLoader {\n-    // (undocumented)\n-    abstract load(path: string): Promise<NgModuleFactory<any>>;\n-}\n-\n // @public\n export abstract class NgModuleRef<T> {\n     abstract get componentFactoryResolver(): ComponentFactoryResolver;\n@@ -1213,19 +1207,6 @@ export interface StaticClassSansProvider {\n // @public\n export type StaticProvider = ValueProvider | ExistingProvider | StaticClassProvider | ConstructorProvider | FactoryProvider | any[];\n \n-// @public @deprecated\n-export class SystemJsNgModuleLoader implements NgModuleFactoryLoader {\n-    constructor(_compiler: Compiler, config?: SystemJsNgModuleLoaderConfig);\n-    // (undocumented)\n-    load(path: string): Promise<NgModuleFactory<any>>;\n-}\n-\n-// @public @deprecated\n-export abstract class SystemJsNgModuleLoaderConfig {\n-    factoryPathPrefix: string;\n-    factoryPathSuffix: string;\n-}\n-\n // @public\n export abstract class TemplateRef<C> {\n     abstract createEmbeddedView(context: C): EmbeddedViewRef<C>;"
        },
        {
            "sha": "d6358e4c489aabc18f038e74f50be1b7ace611c6",
            "filename": "goldens/public-api/router/router.md",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fpublic-api%2Frouter%2Frouter.md",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fpublic-api%2Frouter%2Frouter.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Frouter%2Frouter.md?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -17,7 +17,6 @@ import { Location as Location_2 } from '@angular/common';\n import { LocationStrategy } from '@angular/common';\n import { ModuleWithProviders } from '@angular/core';\n import { NgModuleFactory } from '@angular/core';\n-import { NgModuleFactoryLoader } from '@angular/core';\n import { Observable } from 'rxjs';\n import { OnChanges } from '@angular/core';\n import { OnDestroy } from '@angular/core';\n@@ -174,9 +173,6 @@ export class DefaultUrlSerializer implements UrlSerializer {\n     serialize(tree: UrlTree): string;\n }\n \n-// @public @deprecated\n-export type DeprecatedLoadChildren = string;\n-\n // @public\n export type DetachedRouteHandle = {};\n \n@@ -246,7 +242,7 @@ export interface IsActiveMatchOptions {\n }\n \n // @public\n-export type LoadChildren = LoadChildrenCallback | DeprecatedLoadChildren;\n+export type LoadChildren = LoadChildrenCallback;\n \n // @public\n export type LoadChildrenCallback = () => Type<any> | NgModuleFactory<any> | Observable<Type<any>> | Promise<NgModuleFactory<any> | Type<any> | any>;\n@@ -466,7 +462,7 @@ export class RouteConfigLoadStart {\n \n // @public\n export class Router {\n-    constructor(rootComponentType: Type<any> | null, urlSerializer: UrlSerializer, rootContexts: ChildrenOutletContexts, location: Location_2, injector: Injector, loader: NgModuleFactoryLoader, compiler: Compiler, config: Routes);\n+    constructor(rootComponentType: Type<any> | null, urlSerializer: UrlSerializer, rootContexts: ChildrenOutletContexts, location: Location_2, injector: Injector, compiler: Compiler, config: Routes);\n     canceledNavigationResolution: 'replace' | 'computed';\n     // (undocumented)\n     config: Routes;\n@@ -650,7 +646,7 @@ export interface RouterOutletContract {\n \n // @public\n export class RouterPreloader implements OnDestroy {\n-    constructor(router: Router, moduleLoader: NgModuleFactoryLoader, compiler: Compiler, injector: Injector, preloadingStrategy: PreloadingStrategy);\n+    constructor(router: Router, compiler: Compiler, injector: Injector, preloadingStrategy: PreloadingStrategy);\n     // (undocumented)\n     ngOnDestroy(): void;\n     // (undocumented)"
        },
        {
            "sha": "22bfa41058a3c1276eed9094a971f34239c59e83",
            "filename": "goldens/public-api/router/testing/testing.md",
            "status": "modified",
            "additions": 2,
            "deletions": 21,
            "changes": 23,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fpublic-api%2Frouter%2Ftesting%2Ftesting.md",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fpublic-api%2Frouter%2Ftesting%2Ftesting.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Frouter%2Ftesting%2Ftesting.md?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -10,10 +10,9 @@ import { ExtraOptions } from '@angular/router';\n import { Injector } from '@angular/core';\n import { Location as Location_2 } from '@angular/common';\n import { ModuleWithProviders } from '@angular/core';\n-import { NgModuleFactory } from '@angular/core';\n-import { NgModuleFactoryLoader } from '@angular/core';\n import { Route } from '@angular/router';\n import { Router } from '@angular/router';\n+import { RouteReuseStrategy } from '@angular/router';\n import { Routes } from '@angular/router';\n import { UrlHandlingStrategy } from '@angular/router';\n import { UrlSerializer } from '@angular/router';\n@@ -25,25 +24,7 @@ export class RouterTestingModule {\n }\n \n // @public\n-export function setupTestingRouter(urlSerializer: UrlSerializer, contexts: ChildrenOutletContexts, location: Location_2, loader: NgModuleFactoryLoader, compiler: Compiler, injector: Injector, routes: Route[][], opts?: ExtraOptions, urlHandlingStrategy?: UrlHandlingStrategy): Router;\n-\n-// @public @deprecated\n-export function setupTestingRouter(urlSerializer: UrlSerializer, contexts: ChildrenOutletContexts, location: Location_2, loader: NgModuleFactoryLoader, compiler: Compiler, injector: Injector, routes: Route[][], urlHandlingStrategy?: UrlHandlingStrategy): Router;\n-\n-// @public\n-export class SpyNgModuleFactoryLoader implements NgModuleFactoryLoader {\n-    constructor(compiler: Compiler);\n-    // (undocumented)\n-    load(path: string): Promise<NgModuleFactory<any>>;\n-    set stubbedModules(modules: {\n-        [path: string]: any;\n-    });\n-    // (undocumented)\n-    get stubbedModules(): {\n-        [path: string]: any;\n-    };\n-    }\n-\n+export function setupTestingRouter(urlSerializer: UrlSerializer, contexts: ChildrenOutletContexts, location: Location_2, compiler: Compiler, injector: Injector, routes: Route[][], opts?: ExtraOptions | UrlHandlingStrategy, urlHandlingStrategy?: UrlHandlingStrategy, routeReuseStrategy?: RouteReuseStrategy): Router;\n \n // (No @packageDocumentation comment for this package)\n "
        },
        {
            "sha": "fef032ee04b732f37f7b60e72ef9760ef82ed254",
            "filename": "goldens/size-tracking/aio-payloads.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fsize-tracking%2Faio-payloads.json",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fsize-tracking%2Faio-payloads.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fsize-tracking%2Faio-payloads.json?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -15,12 +15,12 @@\n     \"master\": {\n       \"uncompressed\": {\n         \"runtime-es2017\": 4841,\n-        \"main-es2017\": 463023,\n+        \"main-es2017\": 462372,\n         \"polyfills-es2017\": 55373,\n         \"styles\": 69772,\n         \"light-theme\": 79025,\n         \"dark-theme\": 78924\n       }\n     }\n   }\n-}\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "14bc58b9a1d2723c0996dab41968f35c26fdfb0c",
            "filename": "goldens/size-tracking/integration-payloads.json",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fsize-tracking%2Fintegration-payloads.json",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/goldens%2Fsize-tracking%2Fintegration-payloads.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fsize-tracking%2Fintegration-payloads.json?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -24,7 +24,7 @@\n     \"master\": {\n       \"uncompressed\": {\n         \"runtime\": 1105,\n-        \"main\": 145314,\n+        \"main\": 144744,\n         \"polyfills\": 36939\n       }\n     }\n@@ -33,7 +33,7 @@\n     \"master\": {\n       \"uncompressed\": {\n         \"runtime\": 1101,\n-        \"main\": 137914,\n+        \"main\": 137399,\n         \"polyfills\": 37641\n       }\n     }\n@@ -42,7 +42,7 @@\n     \"master\": {\n       \"uncompressed\": {\n         \"runtime\": 2843,\n-        \"main\": 239937,\n+        \"main\": 238453,\n         \"polyfills\": 37064,\n         \"src_app_lazy_lazy_module_ts\": 795\n       }"
        },
        {
            "sha": "aabca219a7434d3814782f15b68d371a6860f9cf",
            "filename": "packages/compiler-cli/test/ngc_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Fcompiler-cli%2Ftest%2Fngc_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Fcompiler-cli%2Ftest%2Fngc_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fngc_spec.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -917,7 +917,7 @@ describe('ngc transformer command-line', () => {\n           import {Component, NgModule} from '@angular/core';\n           import {RouterModule} from '@angular/router';\n \n-          export function foo(): string {\n+          export function foo(): any {\n             console.log('side-effect');\n             return 'test';\n           }\n@@ -951,7 +951,7 @@ describe('ngc transformer command-line', () => {\n           import {Component, NgModule} from '@angular/core';\n           import {RouterModule} from '@angular/router';\n \n-          export function foo(): string {\n+          export function foo(): any {\n             console.log('side-effect');\n             return 'test';\n           }"
        },
        {
            "sha": "d923e7af91b760998597ee5e9f81bd379a918011",
            "filename": "packages/core/src/linker.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Fcore%2Fsrc%2Flinker.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Fcore%2Fsrc%2Flinker.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Flinker.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -12,9 +12,8 @@ export {ComponentFactory, ComponentRef} from './linker/component_factory';\n export {ComponentFactoryResolver} from './linker/component_factory_resolver';\n export {ElementRef} from './linker/element_ref';\n export {NgModuleFactory, NgModuleRef} from './linker/ng_module_factory';\n-export {getModuleFactory, NgModuleFactoryLoader} from './linker/ng_module_factory_loader';\n+export {getModuleFactory} from './linker/ng_module_factory_loader';\n export {QueryList} from './linker/query_list';\n-export {SystemJsNgModuleLoader, SystemJsNgModuleLoaderConfig} from './linker/system_js_ng_module_factory_loader';\n export {TemplateRef} from './linker/template_ref';\n export {ViewContainerRef} from './linker/view_container_ref';\n export {EmbeddedViewRef, ViewRef} from './linker/view_ref';"
        },
        {
            "sha": "44a5a3ec40481c62630efe35e75163763768a452",
            "filename": "packages/core/src/linker/ng_module_factory_loader.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 12,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Fcore%2Fsrc%2Flinker%2Fng_module_factory_loader.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Fcore%2Fsrc%2Flinker%2Fng_module_factory_loader.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Flinker%2Fng_module_factory_loader.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -12,18 +12,6 @@ import {NgModuleFactory as R3NgModuleFactory} from '../render3/ng_module_ref';\n import {NgModuleFactory} from './ng_module_factory';\n import {getRegisteredNgModuleType} from './ng_module_factory_registration';\n \n-\n-/**\n- * Used to load ng module factories.\n- *\n- * @publicApi\n- * @deprecated the `string` form of `loadChildren` is deprecated, and `NgModuleFactoryLoader` is\n- * part of its implementation. See `LoadChildren` for more details.\n- */\n-export abstract class NgModuleFactoryLoader {\n-  abstract load(path: string): Promise<NgModuleFactory<any>>;\n-}\n-\n export function getModuleFactory__PRE_R3__(id: string): NgModuleFactory<any> {\n   const factory = getRegisteredNgModuleType(id) as NgModuleFactory<any>| null;\n   if (!factory) throw noModuleError(id);"
        },
        {
            "sha": "625467febdba9894aedf89321724931d145dd700",
            "filename": "packages/core/src/linker/system_js_ng_module_factory_loader.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 99,
            "changes": 99,
            "blob_url": "https://github.com/angular/angular/blob/05c08cac9a63a4acab34e5ed8eeed2716790307c/packages%2Fcore%2Fsrc%2Flinker%2Fsystem_js_ng_module_factory_loader.ts",
            "raw_url": "https://github.com/angular/angular/raw/05c08cac9a63a4acab34e5ed8eeed2716790307c/packages%2Fcore%2Fsrc%2Flinker%2Fsystem_js_ng_module_factory_loader.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Flinker%2Fsystem_js_ng_module_factory_loader.ts?ref=05c08cac9a63a4acab34e5ed8eeed2716790307c",
            "patch": "@@ -1,99 +0,0 @@\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-\n-import {Injectable, Optional} from '../di';\n-import {ivyEnabled} from '../ivy_switch';\n-\n-import {Compiler} from './compiler';\n-import {NgModuleFactory} from './ng_module_factory';\n-import {NgModuleFactoryLoader} from './ng_module_factory_loader';\n-\n-const _SEPARATOR = '#';\n-\n-const FACTORY_CLASS_SUFFIX = 'NgFactory';\n-declare var System: any;\n-\n-/**\n- * Configuration for SystemJsNgModuleLoader.\n- * token.\n- *\n- * @publicApi\n- * @deprecated the `string` form of `loadChildren` is deprecated, and `SystemJsNgModuleLoaderConfig`\n- * is part of its implementation. See `LoadChildren` for more details.\n- */\n-export abstract class SystemJsNgModuleLoaderConfig {\n-  /**\n-   * Prefix to add when computing the name of the factory module for a given module name.\n-   */\n-  // TODO(issue/24571): remove '!'.\n-  factoryPathPrefix!: string;\n-\n-  /**\n-   * Suffix to add when computing the name of the factory module for a given module name.\n-   */\n-  // TODO(issue/24571): remove '!'.\n-  factoryPathSuffix!: string;\n-}\n-\n-const DEFAULT_CONFIG: SystemJsNgModuleLoaderConfig = {\n-  factoryPathPrefix: '',\n-  factoryPathSuffix: '.ngfactory',\n-};\n-\n-/**\n- * NgModuleFactoryLoader that uses SystemJS to load NgModuleFactory\n- * @publicApi\n- * @deprecated the `string` form of `loadChildren` is deprecated, and `SystemJsNgModuleLoader` is\n- * part of its implementation. See `LoadChildren` for more details.\n- */\n-@Injectable()\n-export class SystemJsNgModuleLoader implements NgModuleFactoryLoader {\n-  private _config: SystemJsNgModuleLoaderConfig;\n-\n-  constructor(private _compiler: Compiler, @Optional() config?: SystemJsNgModuleLoaderConfig) {\n-    this._config = config || DEFAULT_CONFIG;\n-  }\n-\n-  load(path: string): Promise<NgModuleFactory<any>> {\n-    const legacyOfflineMode = !ivyEnabled && this._compiler instanceof Compiler;\n-    return legacyOfflineMode ? this.loadFactory(path) : this.loadAndCompile(path);\n-  }\n-\n-  private loadAndCompile(path: string): Promise<NgModuleFactory<any>> {\n-    let [module, exportName] = path.split(_SEPARATOR);\n-    if (exportName === undefined) {\n-      exportName = 'default';\n-    }\n-\n-    return System.import(module)\n-        .then((module: any) => module[exportName])\n-        .then((type: any) => checkNotEmpty(type, module, exportName))\n-        .then((type: any) => this._compiler.compileModuleAsync(type));\n-  }\n-\n-  private loadFactory(path: string): Promise<NgModuleFactory<any>> {\n-    let [module, exportName] = path.split(_SEPARATOR);\n-    let factoryClassSuffix = FACTORY_CLASS_SUFFIX;\n-    if (exportName === undefined) {\n-      exportName = 'default';\n-      factoryClassSuffix = '';\n-    }\n-\n-    return System.import(this._config.factoryPathPrefix + module + this._config.factoryPathSuffix)\n-        .then((module: any) => module[exportName + factoryClassSuffix])\n-        .then((factory: any) => checkNotEmpty(factory, module, exportName));\n-  }\n-}\n-\n-function checkNotEmpty(value: any, modulePath: string, exportName: string): any {\n-  if (!value) {\n-    throw new Error(`Cannot find '${exportName}' in '${modulePath}'`);\n-  }\n-  return value;\n-}"
        },
        {
            "sha": "242931b87b150706a038d32be04f0b9459bc57f9",
            "filename": "packages/core/test/bundling/router/bundle.golden_symbols.json",
            "status": "modified",
            "additions": 0,
            "deletions": 15,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Fcore%2Ftest%2Fbundling%2Frouter%2Fbundle.golden_symbols.json",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Fcore%2Ftest%2Fbundling%2Frouter%2Fbundle.golden_symbols.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Fbundling%2Frouter%2Fbundle.golden_symbols.json?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -176,9 +176,6 @@\n   {\n     \"name\": \"DATA_URL_PATTERN\"\n   },\n-  {\n-    \"name\": \"DEFAULT_CONFIG\"\n-  },\n   {\n     \"name\": \"DEFAULT_CURRENCY_CODE\"\n   },\n@@ -476,9 +473,6 @@\n   {\n     \"name\": \"NgModuleFactory\"\n   },\n-  {\n-    \"name\": \"NgModuleFactoryLoader\"\n-  },\n   {\n     \"name\": \"NgModuleRef\"\n   },\n@@ -767,12 +761,6 @@\n   {\n     \"name\": \"SwitchMapSubscriber\"\n   },\n-  {\n-    \"name\": \"SystemJsNgModuleLoader\"\n-  },\n-  {\n-    \"name\": \"SystemJsNgModuleLoaderConfig\"\n-  },\n   {\n     \"name\": \"THROW_IF_NOT_FOUND\"\n   },\n@@ -1004,9 +992,6 @@\n   {\n     \"name\": \"catchError\"\n   },\n-  {\n-    \"name\": \"checkNotEmpty\"\n-  },\n   {\n     \"name\": \"checkStable\"\n   },"
        },
        {
            "sha": "516be3006ca5f4b6f5938d3675cc8ab5b06810df",
            "filename": "packages/core/test/linker/system_ng_module_factory_loader_spec.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 85,
            "changes": 85,
            "blob_url": "https://github.com/angular/angular/blob/05c08cac9a63a4acab34e5ed8eeed2716790307c/packages%2Fcore%2Ftest%2Flinker%2Fsystem_ng_module_factory_loader_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/05c08cac9a63a4acab34e5ed8eeed2716790307c/packages%2Fcore%2Ftest%2Flinker%2Fsystem_ng_module_factory_loader_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Flinker%2Fsystem_ng_module_factory_loader_spec.ts?ref=05c08cac9a63a4acab34e5ed8eeed2716790307c",
            "patch": "@@ -1,85 +0,0 @@\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-import {Compiler, SystemJsNgModuleLoader} from '@angular/core';\n-import {global} from '@angular/core/src/util/global';\n-import {waitForAsync} from '@angular/core/testing';\n-import {modifiedInIvy, onlyInIvy} from '@angular/private/testing';\n-\n-function mockSystem(modules: {[module: string]: any}) {\n-  return {\n-    'import': (target: string) => {\n-      expect(modules[target]).not.toBe(undefined);\n-      return Promise.resolve(modules[target]);\n-    }\n-  };\n-}\n-\n-describe('SystemJsNgModuleLoader', () => {\n-  let oldSystem: any = null;\n-  modifiedInIvy('only loads ngfactory shims in View Engine').describe('(View Engine)', () => {\n-    beforeEach(() => {\n-      oldSystem = global['System'];\n-      global['System'] = mockSystem({\n-        'test.ngfactory':\n-            {'default': 'test module factory', 'NamedNgFactory': 'test NamedNgFactory'},\n-        'prefixed/test/suffixed': {'NamedNgFactory': 'test module factory'}\n-      });\n-    });\n-    afterEach(() => {\n-      global['System'] = oldSystem;\n-    });\n-\n-    it('loads a default factory by appending the factory suffix', waitForAsync(() => {\n-         const loader = new SystemJsNgModuleLoader(new Compiler());\n-         loader.load('test').then(contents => {\n-           expect(contents).toBe('test module factory' as any);\n-         });\n-       }));\n-    it('loads a named factory by appending the factory suffix', waitForAsync(() => {\n-         const loader = new SystemJsNgModuleLoader(new Compiler());\n-         loader.load('test#Named').then(contents => {\n-           expect(contents).toBe('test NamedNgFactory' as any);\n-         });\n-       }));\n-    it('loads a named factory with a configured prefix and suffix', waitForAsync(() => {\n-         const loader = new SystemJsNgModuleLoader(new Compiler(), {\n-           factoryPathPrefix: 'prefixed/',\n-           factoryPathSuffix: '/suffixed',\n-         });\n-         loader.load('test#Named').then(contents => {\n-           expect(contents).toBe('test module factory' as any);\n-         });\n-       }));\n-  });\n-\n-  onlyInIvy('loads modules directly in Ivy').describe('(Ivy)', () => {\n-    beforeEach(() => {\n-      oldSystem = global['System'];\n-      global['System'] = mockSystem({\n-        'test': {'default': 'test module', 'NamedModule': 'test NamedModule'},\n-      });\n-    });\n-    afterEach(() => {\n-      global['System'] = oldSystem;\n-    });\n-\n-    it('loads a default module', waitForAsync(() => {\n-         const loader = new SystemJsNgModuleLoader(new Compiler());\n-         loader.load('test').then(contents => {\n-           expect(contents.moduleType).toBe('test module' as any);\n-         });\n-       }));\n-    it('loads a named module', waitForAsync(() => {\n-         const loader = new SystemJsNgModuleLoader(new Compiler());\n-         loader.load('test#NamedModule').then(contents => {\n-           expect(contents.moduleType).toBe('test NamedModule' as any);\n-         });\n-       }));\n-  });\n-});"
        },
        {
            "sha": "35bcd039af414c7533116783adf64019d4add4c5",
            "filename": "packages/router/src/config.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 17,
            "changes": 19,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Fconfig.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Fconfig.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -113,25 +113,10 @@ export type LoadChildrenCallback = () => Type<any>|NgModuleFactory<any>|Observab\n  *\n  * A function that returns a set of routes to load.\n  *\n- * The string form of `LoadChildren` is deprecated (see `DeprecatedLoadChildren`). The function\n- * form (`LoadChildrenCallback`) should be used instead.\n- *\n- * @see `loadChildrenCallback`\n- * @publicApi\n- */\n-export type LoadChildren = LoadChildrenCallback|DeprecatedLoadChildren;\n-\n-/**\n- * A string of the form `path/to/file#exportName` that acts as a URL for a set of routes to load.\n- *\n- * @see `loadChildrenCallback`\n+ * @see `LoadChildrenCallback`\n  * @publicApi\n- * @deprecated The `string` form of `loadChildren` is deprecated in favor of the\n- * `LoadChildrenCallback` function which uses the ES dynamic `import()` expression.\n- * This offers a more natural and standards-based mechanism to dynamically\n- * load an ES module at runtime.\n  */\n-export type DeprecatedLoadChildren = string;\n+export type LoadChildren = LoadChildrenCallback;\n \n /**\n  *"
        },
        {
            "sha": "6de40612e125f3c9d97e4b696b8ef80405eb196d",
            "filename": "packages/router/src/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Findex.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n \n-export {Data, DeprecatedLoadChildren, LoadChildren, LoadChildrenCallback, QueryParamsHandling, ResolveData, Route, Routes, RunGuardsAndResolvers, UrlMatcher, UrlMatchResult} from './config';\n+export {Data, LoadChildren, LoadChildrenCallback, QueryParamsHandling, ResolveData, Route, Routes, RunGuardsAndResolvers, UrlMatcher, UrlMatchResult} from './config';\n export {RouterLink, RouterLinkWithHref} from './directives/router_link';\n export {RouterLinkActive} from './directives/router_link_active';\n export {RouterOutlet, RouterOutletContract} from './directives/router_outlet';"
        },
        {
            "sha": "944a123fb1af337b08236a071c5f2f5ff714bc79",
            "filename": "packages/router/src/router.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Frouter.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Frouter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Frouter.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n import {Location, PopStateEvent} from '@angular/common';\n-import {Compiler, Injectable, Injector, NgModuleFactoryLoader, NgModuleRef, NgZone, Type, ɵConsole as Console} from '@angular/core';\n+import {Compiler, Injectable, Injector, NgModuleRef, NgZone, Type, ɵConsole as Console} from '@angular/core';\n import {BehaviorSubject, EMPTY, Observable, of, Subject, SubscriptionLike} from 'rxjs';\n import {catchError, filter, finalize, map, switchMap, tap} from 'rxjs/operators';\n \n@@ -581,7 +581,7 @@ export class Router {\n   constructor(\n       private rootComponentType: Type<any>|null, private urlSerializer: UrlSerializer,\n       private rootContexts: ChildrenOutletContexts, private location: Location, injector: Injector,\n-      loader: NgModuleFactoryLoader, compiler: Compiler, public config: Routes) {\n+      compiler: Compiler, public config: Routes) {\n     const onLoadStart = (r: Route) => this.triggerEvent(new RouteConfigLoadStart(r));\n     const onLoadEnd = (r: Route) => this.triggerEvent(new RouteConfigLoadEnd(r));\n \n@@ -595,7 +595,7 @@ export class Router {\n     this.rawUrlTree = this.currentUrlTree;\n     this.browserUrlTree = this.currentUrlTree;\n \n-    this.configLoader = new RouterConfigLoader(loader, compiler, onLoadStart, onLoadEnd);\n+    this.configLoader = new RouterConfigLoader(injector, compiler, onLoadStart, onLoadEnd);\n     this.routerState = createEmptyState(this.currentUrlTree, this.rootComponentType);\n \n     this.transitions = new BehaviorSubject<NavigationTransition>({"
        },
        {
            "sha": "0f0a3bb1d2e896e1e42dc9bfc6e035ea00cfc9a8",
            "filename": "packages/router/src/router_config_loader.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 13,
            "changes": 22,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Frouter_config_loader.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Frouter_config_loader.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Frouter_config_loader.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {Compiler, InjectFlags, InjectionToken, Injector, NgModuleFactory, NgModuleFactoryLoader} from '@angular/core';\n+import {Compiler, InjectFlags, InjectionToken, Injector, NgModuleFactory} from '@angular/core';\n import {ConnectableObservable, from, Observable, of, Subject} from 'rxjs';\n import {catchError, map, mergeMap, refCount, tap} from 'rxjs/operators';\n \n@@ -28,7 +28,7 @@ export const ROUTES = new InjectionToken<Route[][]>('ROUTES');\n \n export class RouterConfigLoader {\n   constructor(\n-      private loader: NgModuleFactoryLoader, private compiler: Compiler,\n+      private injector: Injector, private compiler: Compiler,\n       private onLoadStartListener?: (r: Route) => void,\n       private onLoadEndListener?: (r: Route) => void) {}\n \n@@ -69,16 +69,12 @@ export class RouterConfigLoader {\n   }\n \n   private loadModuleFactory(loadChildren: LoadChildren): Observable<NgModuleFactory<any>> {\n-    if (typeof loadChildren === 'string') {\n-      return from(this.loader.load(loadChildren));\n-    } else {\n-      return wrapIntoObservable(loadChildren()).pipe(mergeMap((t: any) => {\n-        if (t instanceof NgModuleFactory) {\n-          return of(t);\n-        } else {\n-          return from(this.compiler.compileModuleAsync(t));\n-        }\n-      }));\n-    }\n+    return wrapIntoObservable(loadChildren()).pipe(mergeMap((t: any) => {\n+      if (t instanceof NgModuleFactory) {\n+        return of(t);\n+      } else {\n+        return from(this.compiler.compileModuleAsync(t));\n+      }\n+    }));\n   }\n }"
        },
        {
            "sha": "6036a2efb49921683471d6bd81a0d55f2f39b1e5",
            "filename": "packages/router/src/router_module.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 9,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Frouter_module.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Frouter_module.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Frouter_module.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n import {APP_BASE_HREF, HashLocationStrategy, Location, LOCATION_INITIALIZED, LocationStrategy, PathLocationStrategy, PlatformLocation, ViewportScroller} from '@angular/common';\n-import {ANALYZE_FOR_ENTRY_COMPONENTS, APP_BOOTSTRAP_LISTENER, APP_INITIALIZER, ApplicationRef, Compiler, ComponentRef, Inject, Injectable, InjectionToken, Injector, ModuleWithProviders, NgModule, NgModuleFactoryLoader, NgProbeToken, OnDestroy, Optional, Provider, SkipSelf, SystemJsNgModuleLoader} from '@angular/core';\n+import {ANALYZE_FOR_ENTRY_COMPONENTS, APP_BOOTSTRAP_LISTENER, APP_INITIALIZER, ApplicationRef, Compiler, ComponentRef, Inject, Injectable, InjectionToken, Injector, ModuleWithProviders, NgModule, NgProbeToken, OnDestroy, Optional, Provider, SkipSelf} from '@angular/core';\n import {of, Subject} from 'rxjs';\n \n import {EmptyOutletComponent} from './components/empty_outlet';\n@@ -52,14 +52,13 @@ export const ROUTER_PROVIDERS: Provider[] = [\n     provide: Router,\n     useFactory: setupRouter,\n     deps: [\n-      UrlSerializer, ChildrenOutletContexts, Location, Injector, NgModuleFactoryLoader, Compiler,\n-      ROUTES, ROUTER_CONFIGURATION, [UrlHandlingStrategy, new Optional()],\n+      UrlSerializer, ChildrenOutletContexts, Location, Injector, Compiler, ROUTES,\n+      ROUTER_CONFIGURATION, [UrlHandlingStrategy, new Optional()],\n       [RouteReuseStrategy, new Optional()]\n     ]\n   },\n   ChildrenOutletContexts,\n   {provide: ActivatedRoute, useFactory: rootRoute, deps: [Router]},\n-  {provide: NgModuleFactoryLoader, useClass: SystemJsNgModuleLoader},\n   RouterPreloader,\n   NoPreloading,\n   PreloadAllModules,\n@@ -431,11 +430,10 @@ export interface ExtraOptions {\n \n export function setupRouter(\n     urlSerializer: UrlSerializer, contexts: ChildrenOutletContexts, location: Location,\n-    injector: Injector, loader: NgModuleFactoryLoader, compiler: Compiler, config: Route[][],\n-    opts: ExtraOptions = {}, urlHandlingStrategy?: UrlHandlingStrategy,\n-    routeReuseStrategy?: RouteReuseStrategy) {\n-  const router = new Router(\n-      null, urlSerializer, contexts, location, injector, loader, compiler, flatten(config));\n+    injector: Injector, compiler: Compiler, config: Route[][], opts: ExtraOptions = {},\n+    urlHandlingStrategy?: UrlHandlingStrategy, routeReuseStrategy?: RouteReuseStrategy) {\n+  const router =\n+      new Router(null, urlSerializer, contexts, location, injector, compiler, flatten(config));\n \n   if (urlHandlingStrategy) {\n     router.urlHandlingStrategy = urlHandlingStrategy;"
        },
        {
            "sha": "5b24fe524add56fa1ce184455f62c39617ba9e7f",
            "filename": "packages/router/src/router_preloader.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Frouter_preloader.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Fsrc%2Frouter_preloader.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Frouter_preloader.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {Compiler, Injectable, Injector, NgModuleFactoryLoader, NgModuleRef, OnDestroy} from '@angular/core';\n+import {Compiler, Injectable, Injector, NgModuleRef, OnDestroy} from '@angular/core';\n import {from, Observable, of, Subscription} from 'rxjs';\n import {catchError, concatMap, filter, map, mergeAll, mergeMap} from 'rxjs/operators';\n \n@@ -77,12 +77,12 @@ export class RouterPreloader implements OnDestroy {\n   private subscription?: Subscription;\n \n   constructor(\n-      private router: Router, moduleLoader: NgModuleFactoryLoader, compiler: Compiler,\n-      private injector: Injector, private preloadingStrategy: PreloadingStrategy) {\n+      private router: Router, compiler: Compiler, private injector: Injector,\n+      private preloadingStrategy: PreloadingStrategy) {\n     const onStartLoad = (r: Route) => router.triggerEvent(new RouteConfigLoadStart(r));\n     const onEndLoad = (r: Route) => router.triggerEvent(new RouteConfigLoadEnd(r));\n \n-    this.loader = new RouterConfigLoader(moduleLoader, compiler, onStartLoad, onEndLoad);\n+    this.loader = new RouterConfigLoader(injector, compiler, onStartLoad, onEndLoad);\n   }\n \n   setUpPreloading(): void {"
        },
        {
            "sha": "94d5c620b6ecbabe1ef4d768e7e625e810738f7c",
            "filename": "packages/router/test/router_preloader.spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Ftest%2Frouter_preloader.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Ftest%2Frouter_preloader.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Frouter_preloader.spec.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {Compiler, Component, Injector, NgModule, NgModuleFactory, NgModuleFactoryLoader, NgModuleRef, Type} from '@angular/core';\n+import {Compiler, Component, Injector, NgModule, NgModuleFactory, NgModuleRef, Type} from '@angular/core';\n import {resolveComponentResources} from '@angular/core/src/metadata/resource_loading';\n import {fakeAsync, inject, TestBed, tick} from '@angular/core/testing';\n import {PreloadAllModules, PreloadingStrategy, RouterPreloader} from '@angular/router';\n@@ -15,7 +15,7 @@ import {catchError, delay, filter, switchMap, take} from 'rxjs/operators';\n \n import {Route, RouteConfigLoadEnd, RouteConfigLoadStart, Router, RouterModule} from '../index';\n import {LoadedRouterConfig} from '../src/config';\n-import {RouterTestingModule, SpyNgModuleFactoryLoader} from '../testing';\n+import {RouterTestingModule} from '../testing';\n \n \n describe('RouterPreloader', () => {"
        },
        {
            "sha": "192f2a86336e6865aa98796b3bc8f0d98ab58f24",
            "filename": "packages/router/test/spy_ng_module_factory_loader.spec.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 45,
            "changes": 45,
            "blob_url": "https://github.com/angular/angular/blob/05c08cac9a63a4acab34e5ed8eeed2716790307c/packages%2Frouter%2Ftest%2Fspy_ng_module_factory_loader.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/05c08cac9a63a4acab34e5ed8eeed2716790307c/packages%2Frouter%2Ftest%2Fspy_ng_module_factory_loader.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fspy_ng_module_factory_loader.spec.ts?ref=05c08cac9a63a4acab34e5ed8eeed2716790307c",
            "patch": "@@ -1,45 +0,0 @@\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-import {fakeAsync, tick} from '@angular/core/testing';\n-import {SpyNgModuleFactoryLoader} from '@angular/router/testing';\n-\n-describe('SpyNgModuleFactoryLoader', () => {\n-  it('should invoke the compiler when the setter is called', () => {\n-    const expected = Promise.resolve('returned');\n-    const compiler: any = {compileModuleAsync: () => {}};\n-    spyOn(compiler, 'compileModuleAsync').and.returnValue(expected);\n-\n-    const r = new SpyNgModuleFactoryLoader(<any>compiler);\n-    r.stubbedModules = {'one': 'someModule'};\n-\n-    expect(compiler.compileModuleAsync).toHaveBeenCalledWith('someModule');\n-    expect(r.stubbedModules['one']).toBe(expected);\n-  });\n-\n-  it('should return the created promise', () => {\n-    const expected: any = Promise.resolve('returned');\n-    const compiler: any = {compileModuleAsync: () => expected};\n-\n-    const r = new SpyNgModuleFactoryLoader(<any>compiler);\n-    r.stubbedModules = {'one': 'someModule'};\n-\n-    expect(r.load('one')).toBe(expected);\n-  });\n-\n-  it('should return a rejected promise when given an invalid path', fakeAsync(() => {\n-       const r = new SpyNgModuleFactoryLoader(<any>null);\n-\n-       let error: any = null;\n-       r.load('two').catch((e: any) => error = e);\n-\n-       tick();\n-\n-       expect(error).toEqual(new Error('Cannot find module two'));\n-     }));\n-});"
        },
        {
            "sha": "6e2160617b38c1a14f22bc2dceb2a6a67f34dd7f",
            "filename": "packages/router/testing/src/router_testing_module.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 99,
            "changes": 107,
            "blob_url": "https://github.com/angular/angular/blob/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Ftesting%2Fsrc%2Frouter_testing_module.ts",
            "raw_url": "https://github.com/angular/angular/raw/361273fad5030c900c83d333a779f6edbe20c688/packages%2Frouter%2Ftesting%2Fsrc%2Frouter_testing_module.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftesting%2Fsrc%2Frouter_testing_module.ts?ref=361273fad5030c900c83d333a779f6edbe20c688",
            "patch": "@@ -8,76 +8,9 @@\n \n import {Location, LocationStrategy} from '@angular/common';\n import {MockLocationStrategy, SpyLocation} from '@angular/common/testing';\n-import {Compiler, Injectable, Injector, ModuleWithProviders, NgModule, NgModuleFactory, NgModuleFactoryLoader, Optional} from '@angular/core';\n+import {Compiler, Injector, ModuleWithProviders, NgModule, Optional} from '@angular/core';\n import {ChildrenOutletContexts, ExtraOptions, NoPreloading, PreloadingStrategy, provideRoutes, Route, Router, ROUTER_CONFIGURATION, RouteReuseStrategy, RouterModule, ROUTES, Routes, UrlHandlingStrategy, UrlSerializer, ɵassignExtraOptionsToRouter as assignExtraOptionsToRouter, ɵflatten as flatten, ɵROUTER_PROVIDERS as ROUTER_PROVIDERS} from '@angular/router';\n \n-\n-\n-/**\n- * @description\n- *\n- * Allows to simulate the loading of ng modules in tests.\n- *\n- * ```\n- * const loader = TestBed.inject(NgModuleFactoryLoader);\n- *\n- * @Component({template: 'lazy-loaded'})\n- * class LazyLoadedComponent {}\n- * @NgModule({\n- *   declarations: [LazyLoadedComponent],\n- *   imports: [RouterModule.forChild([{path: 'loaded', component: LazyLoadedComponent}])]\n- * })\n- *\n- * class LoadedModule {}\n- *\n- * // sets up stubbedModules\n- * loader.stubbedModules = {lazyModule: LoadedModule};\n- *\n- * router.resetConfig([\n- *   {path: 'lazy', loadChildren: 'lazyModule'},\n- * ]);\n- *\n- * router.navigateByUrl('/lazy/loaded');\n- * ```\n- *\n- * @publicApi\n- */\n-@Injectable()\n-export class SpyNgModuleFactoryLoader implements NgModuleFactoryLoader {\n-  /**\n-   * @docsNotRequired\n-   */\n-  private _stubbedModules: {[path: string]: Promise<NgModuleFactory<any>>|undefined} = {};\n-\n-  /**\n-   * @docsNotRequired\n-   */\n-  set stubbedModules(modules: {[path: string]: any}) {\n-    const res: {[path: string]: any} = {};\n-    for (const t of Object.keys(modules)) {\n-      res[t] = this.compiler.compileModuleAsync(modules[t]);\n-    }\n-    this._stubbedModules = res;\n-  }\n-\n-  /**\n-   * @docsNotRequired\n-   */\n-  get stubbedModules(): {[path: string]: any} {\n-    return this._stubbedModules;\n-  }\n-\n-  constructor(private compiler: Compiler) {}\n-\n-  load(path: string): Promise<NgModuleFactory<any>> {\n-    if (this._stubbedModules[path]) {\n-      return this._stubbedModules[path]!;\n-    } else {\n-      return <any>Promise.reject(new Error(`Cannot find module ${path}`));\n-    }\n-  }\n-}\n-\n function isUrlHandlingStrategy(opts: ExtraOptions|\n                                UrlHandlingStrategy): opts is UrlHandlingStrategy {\n   // This property check is needed because UrlHandlingStrategy is an interface and doesn't exist at\n@@ -92,33 +25,11 @@ function isUrlHandlingStrategy(opts: ExtraOptions|\n  */\n export function setupTestingRouter(\n     urlSerializer: UrlSerializer, contexts: ChildrenOutletContexts, location: Location,\n-    loader: NgModuleFactoryLoader, compiler: Compiler, injector: Injector, routes: Route[][],\n-    opts?: ExtraOptions, urlHandlingStrategy?: UrlHandlingStrategy): Router;\n-\n-/**\n- * Router setup factory function used for testing.\n- *\n- * @deprecated As of v5.2. The 2nd-to-last argument should be `ExtraOptions`, not\n- * `UrlHandlingStrategy`\n- * @publicApi\n- */\n-export function setupTestingRouter(\n-    urlSerializer: UrlSerializer, contexts: ChildrenOutletContexts, location: Location,\n-    loader: NgModuleFactoryLoader, compiler: Compiler, injector: Injector, routes: Route[][],\n-    urlHandlingStrategy?: UrlHandlingStrategy): Router;\n-\n-/**\n- * Router setup factory function used for testing.\n- *\n- * @publicApi\n- */\n-export function setupTestingRouter(\n-    urlSerializer: UrlSerializer, contexts: ChildrenOutletContexts, location: Location,\n-    loader: NgModuleFactoryLoader, compiler: Compiler, injector: Injector, routes: Route[][],\n+    compiler: Compiler, injector: Injector, routes: Route[][],\n     opts?: ExtraOptions|UrlHandlingStrategy, urlHandlingStrategy?: UrlHandlingStrategy,\n     routeReuseStrategy?: RouteReuseStrategy) {\n-  const router = new Router(\n-      null!, urlSerializer, contexts, location, injector, loader, compiler, flatten(routes));\n+  const router =\n+      new Router(null!, urlSerializer, contexts, location, injector, compiler, flatten(routes));\n   if (opts) {\n     // Handle deprecated argument ordering.\n     if (isUrlHandlingStrategy(opts)) {\n@@ -146,8 +57,7 @@ export function setupTestingRouter(\n  * Sets up the router to be used for testing.\n  *\n  * The modules sets up the router to be used for testing.\n- * It provides spy implementations of `Location`, `LocationStrategy`, and {@link\n- * NgModuleFactoryLoader}.\n+ * It provides spy implementations of `Location` and `LocationStrategy`.\n  *\n  * @usageNotes\n  * ### Example\n@@ -170,13 +80,12 @@ export function setupTestingRouter(\n   exports: [RouterModule],\n   providers: [\n     ROUTER_PROVIDERS, {provide: Location, useClass: SpyLocation},\n-    {provide: LocationStrategy, useClass: MockLocationStrategy},\n-    {provide: NgModuleFactoryLoader, useClass: SpyNgModuleFactoryLoader}, {\n+    {provide: LocationStrategy, useClass: MockLocationStrategy}, {\n       provide: Router,\n       useFactory: setupTestingRouter,\n       deps: [\n-        UrlSerializer, ChildrenOutletContexts, Location, NgModuleFactoryLoader, Compiler, Injector,\n-        ROUTES, ROUTER_CONFIGURATION, [UrlHandlingStrategy, new Optional()],\n+        UrlSerializer, ChildrenOutletContexts, Location, Compiler, Injector, ROUTES,\n+        ROUTER_CONFIGURATION, [UrlHandlingStrategy, new Optional()],\n         [RouteReuseStrategy, new Optional()]\n       ]\n     },"
        }
    ],
    "stats": {
        "total": 519,
        "additions": 58,
        "deletions": 461
    }
}