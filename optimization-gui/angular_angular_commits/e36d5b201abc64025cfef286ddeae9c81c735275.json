{
    "author": "sonukapoor",
    "message": "fix(forms): correct usage of `selectedOptions` (#37620)\n\nPreviously, `registerOnChange` used `hasOwnProperty` to identify if the\nproperty is supported. However, this does not work as the `selectedOptions`\nproperty is an inherited property. This commit fixes this by verifying\nthe property on the prototype instead.\n\nCloses #37433\n\nPR Close #37620",
    "sha": "e36d5b201abc64025cfef286ddeae9c81c735275",
    "files": [
        {
            "sha": "ebee78150422f87bfa8ecec1ca61330e1febfe73",
            "filename": "packages/forms/src/directives/select_multiple_control_value_accessor.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/e36d5b201abc64025cfef286ddeae9c81c735275/packages%2Fforms%2Fsrc%2Fdirectives%2Fselect_multiple_control_value_accessor.ts",
            "raw_url": "https://github.com/angular/angular/raw/e36d5b201abc64025cfef286ddeae9c81c735275/packages%2Fforms%2Fsrc%2Fdirectives%2Fselect_multiple_control_value_accessor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fdirectives%2Fselect_multiple_control_value_accessor.ts?ref=e36d5b201abc64025cfef286ddeae9c81c735275",
            "patch": "@@ -156,7 +156,7 @@ export class SelectMultipleControlValueAccessor implements ControlValueAccessor\n   registerOnChange(fn: (value: any) => any): void {\n     this.onChange = (_: any) => {\n       const selected: Array<any> = [];\n-      if (_.hasOwnProperty('selectedOptions')) {\n+      if (_.selectedOptions !== undefined) {\n         const options: HTMLCollection = _.selectedOptions;\n         for (let i = 0; i < options.length; i++) {\n           const opt: any = options.item(i);"
        },
        {
            "sha": "f6cce04653fcba3b3dd45b7657e1936a26f1ca32",
            "filename": "packages/forms/test/value_accessor_integration_spec.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/e36d5b201abc64025cfef286ddeae9c81c735275/packages%2Fforms%2Ftest%2Fvalue_accessor_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/e36d5b201abc64025cfef286ddeae9c81c735275/packages%2Fforms%2Ftest%2Fvalue_accessor_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Fvalue_accessor_integration_spec.ts?ref=e36d5b201abc64025cfef286ddeae9c81c735275",
            "patch": "@@ -499,6 +499,18 @@ import {dispatchEvent} from '@angular/platform-browser/testing/src/browser_util'\n           }\n         };\n \n+        it('verify that native `selectedOptions` field is used while detecting the list of selected options',\n+           fakeAsync(() => {\n+             if (isNode || !HTMLSelectElement.prototype.hasOwnProperty('selectedOptions')) return;\n+             const spy = spyOnProperty(HTMLSelectElement.prototype, 'selectedOptions', 'get')\n+                             .and.callThrough();\n+             setSelectedCities([]);\n+\n+             selectOptionViaUI('1: Object');\n+             assertOptionElementSelectedState([false, true, false]);\n+             expect(spy.calls.count()).toBe(2);\n+           }));\n+\n         it('should reflect state of model after option selected and new options subsequently added',\n            fakeAsync(() => {\n              if (isNode) return;"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 13,
        "deletions": 1
    }
}