{
    "author": "PowerKiKi",
    "message": "docs: drop `newEvent()` compatibility function (#37251)\n\nBecause PhantomJS has been deprecated since March 2018, and `newEvent`\nis very confusing for newcomers that read the testing documentation,\nwe remove it entirely, and instead assume most, if not all, newcomers\nwill run tests in Chrome as it is the default.\n\nFixes #23370\n\nPR Close #37251",
    "sha": "c4b8964424f8a70bf0247211e4494d1b3f809b94",
    "files": [
        {
            "sha": "9510eb8f51c642b2face956641158fc71428eaa4",
            "filename": "aio/content/examples/testing/src/app/demo/demo.testbed.spec.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 7,
            "changes": 20,
            "blob_url": "https://github.com/angular/angular/blob/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fdemo.testbed.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fdemo.testbed.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fdemo%2Fdemo.testbed.spec.ts?ref=c4b8964424f8a70bf0247211e4494d1b3f809b94",
            "patch": "@@ -28,7 +28,7 @@ import {\n   ComponentFixture, fakeAsync, inject, TestBed, tick, waitForAsync\n } from '@angular/core/testing';\n \n-import { addMatchers, newEvent, click } from '../../testing';\n+import { addMatchers, click } from '../../testing';\n \n export class NotProvided extends ValueService { /* example below */ }\n beforeEach(addMatchers);\n@@ -274,9 +274,11 @@ describe('demo (with TestBed):', () => {\n         expect(comp.name).toBe(expectedOrigName,\n           `comp.name should still be ${expectedOrigName} after value change, before binding happens`);\n \n-        // dispatch a DOM event so that Angular learns of input value change.\n+        // Dispatch a DOM event so that Angular learns of input value change.\n         // then wait while ngModel pushes input.box value to comp.name\n-        input.dispatchEvent(newEvent('input'));\n+        // In older browsers, such as IE, you might need a CustomEvent instead. See\n+        // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n+        input.dispatchEvent(new Event('input'));\n         return fixture.whenStable();\n       })\n         .then(() => {\n@@ -312,9 +314,11 @@ describe('demo (with TestBed):', () => {\n       expect(comp.name).toBe(expectedOrigName,\n         `comp.name should still be ${expectedOrigName} after value change, before binding happens`);\n \n-      // dispatch a DOM event so that Angular learns of input value change.\n+      // Dispatch a DOM event so that Angular learns of input value change.\n       // then wait a tick while ngModel pushes input.box value to comp.name\n-      input.dispatchEvent(newEvent('input'));\n+      // In older browsers, such as IE, you might need a CustomEvent instead. See\n+      // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n+      input.dispatchEvent(new Event('input'));\n       tick();\n       expect(comp.name).toBe(expectedNewName,\n         `After ngModel updates the model, comp.name should be ${expectedNewName} `);\n@@ -335,10 +339,12 @@ describe('demo (with TestBed):', () => {\n       // simulate user entering new name in input\n       input.value = inputText;\n \n-      // dispatch a DOM event so that Angular learns of input value change.\n+      // Dispatch a DOM event so that Angular learns of input value change.\n       // then wait a tick while ngModel pushes input.box value to comp.text\n       // and Angular updates the output span\n-      input.dispatchEvent(newEvent('input'));\n+      // In older browsers, such as IE, you might need a CustomEvent instead. See\n+      // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n+      input.dispatchEvent(new Event('input'));\n       tick();\n       fixture.detectChanges();\n       expect(span.textContent).toBe(expectedText, 'output span');"
        },
        {
            "sha": "8f4ee4f6d7e1117b6e964af2995035000bc0f459",
            "filename": "aio/content/examples/testing/src/app/hero/hero-detail.component.spec.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.spec.ts?ref=c4b8964424f8a70bf0247211e4494d1b3f809b94",
            "patch": "@@ -3,7 +3,7 @@ import { ComponentFixture, fakeAsync, inject, TestBed, tick, waitForAsync } from\n import { Router } from '@angular/router';\n \n import {\n-  ActivatedRoute, ActivatedRouteStub, asyncData, click, newEvent\n+  ActivatedRoute, ActivatedRouteStub, asyncData, click\n } from '../../testing';\n \n import { Hero } from '../model/hero';\n@@ -99,7 +99,10 @@ function overrideSetup() {\n        const newName = 'New Name';\n \n        page.nameInput.value = newName;\n-       page.nameInput.dispatchEvent(newEvent('input'));  // tell Angular\n+\n+       // In older browsers, such as IE, you might need a CustomEvent instead. See\n+       // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n+       page.nameInput.dispatchEvent(new Event('input')); // tell Angular\n \n        expect(component.hero.name).toBe(newName, 'component hero has new name');\n        expect(hdsSpy.testHero.name).toBe(origName, 'service hero unchanged before save');\n@@ -197,9 +200,10 @@ function heroModuleSetup() {\n       // simulate user entering a new name into the input box\n       nameInput.value = 'quick BROWN  fOx';\n \n-      // dispatch a DOM event so that Angular learns of input value change.\n-      // use newEvent utility function (not provided by Angular) for better browser compatibility\n-      nameInput.dispatchEvent(newEvent('input'));\n+      // Dispatch a DOM event so that Angular learns of input value change.\n+      // In older browsers, such as IE, you might need a CustomEvent instead. See\n+      // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n+      nameInput.dispatchEvent(new Event('input'));\n \n       // Tell Angular to update the display binding through the title pipe\n       fixture.detectChanges();"
        },
        {
            "sha": "b65eaada82aa88a3750515dc0bfb780f99f90acd",
            "filename": "aio/content/examples/testing/src/app/hero/hero-list.component.spec.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-list.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-list.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-list.component.spec.ts?ref=c4b8964424f8a70bf0247211e4494d1b3f809b94",
            "patch": "@@ -6,7 +6,7 @@ import { DebugElement } from '@angular/core';\n \n import { Router } from '@angular/router';\n \n-import { addMatchers, newEvent } from '../../testing';\n+import { addMatchers } from '../../testing';\n import { HeroService } from '../model/hero.service';\n import { getTestHeroes, TestHeroService } from '../model/testing/test-hero.service';\n \n@@ -53,7 +53,10 @@ describe('HeroListComponent', () => {\n   it('should select hero on click', fakeAsync(() => {\n        const expectedHero = HEROES[1];\n        const li = page.heroRows[1];\n-       li.dispatchEvent(newEvent('click'));\n+\n+       // In older browsers, such as IE, you might need a CustomEvent instead. See\n+       // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n+       li.dispatchEvent(new Event('click'));\n        tick();\n        // `.toEqual` because selectedHero is clone of expectedHero; see FakeHeroService\n        expect(comp.selectedHero).toEqual(expectedHero);\n@@ -62,7 +65,10 @@ describe('HeroListComponent', () => {\n   it('should navigate to selected hero detail on click', fakeAsync(() => {\n        const expectedHero = HEROES[1];\n        const li = page.heroRows[1];\n-       li.dispatchEvent(newEvent('click'));\n+\n+       // In older browsers, such as IE, you might need a CustomEvent instead. See\n+       // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n+       li.dispatchEvent(new Event('click'));\n        tick();\n \n        // should have navigated"
        },
        {
            "sha": "1ab8d68a6c7aa5816d72206c0d38a3f0ddc1434b",
            "filename": "aio/content/examples/testing/src/app/shared/highlight.directive.spec.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fshared%2Fhighlight.directive.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fshared%2Fhighlight.directive.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fshared%2Fhighlight.directive.spec.ts?ref=c4b8964424f8a70bf0247211e4494d1b3f809b94",
            "patch": "@@ -3,7 +3,6 @@ import { ComponentFixture, TestBed } from '@angular/core/testing';\n import { By } from '@angular/platform-browser';\n \n import { HighlightDirective } from './highlight.directive';\n-import { newEvent } from '../../testing';\n \n // #docregion test-component\n @Component({\n@@ -59,9 +58,12 @@ describe('HighlightDirective', () => {\n     const input = des[2].nativeElement as HTMLInputElement;\n     expect(input.style.backgroundColor).toBe('cyan', 'initial backgroundColor');\n \n-    // dispatch a DOM event so that Angular responds to the input value change.\n     input.value = 'green';\n-    input.dispatchEvent(newEvent('input'));\n+\n+    // Dispatch a DOM event so that Angular responds to the input value change.\n+    // In older browsers, such as IE, you might need a CustomEvent instead. See\n+    // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n+    input.dispatchEvent(new Event('input'));\n     fixture.detectChanges();\n \n     expect(input.style.backgroundColor).toBe('green', 'changed backgroundColor');"
        },
        {
            "sha": "bcea4482a219b5f4f21a65907af8e76a573a1a2a",
            "filename": "aio/content/examples/testing/src/testing/index.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 12,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Ftesting%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/c4b8964424f8a70bf0247211e4494d1b3f809b94/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Ftesting%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Ftesting%2Findex.ts?ref=c4b8964424f8a70bf0247211e4494d1b3f809b94",
            "patch": "@@ -14,18 +14,6 @@ export function advance(f: ComponentFixture<any>): void {\n   f.detectChanges();\n }\n \n-/**\n- * Create custom DOM event the old fashioned way\n- *\n- * https://developer.mozilla.org/en-US/docs/Web/API/Event/initEvent\n- * Although officially deprecated, some browsers (phantom) don't accept the preferred \"new Event(eventName)\"\n- */\n-export function newEvent(eventName: string, bubbles = false, cancelable = false) {\n-  const evt = document.createEvent('CustomEvent');  // MUST be 'CustomEvent'\n-  evt.initCustomEvent(eventName, bubbles, cancelable, null);\n-  return evt;\n-}\n-\n // See https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\n // #docregion click-event\n /** Button events to pass to `DebugElement.triggerEventHandler` for RouterLink event handler */"
        }
    ],
    "stats": {
        "total": 66,
        "additions": 36,
        "deletions": 30
    }
}