{
    "author": "petebacondarwin",
    "message": "fix(compiler-cli): ensure file_system handles mixed Windows drives (#37959)\n\nThe `fs.relative()` method assumed that the file-system is a single tree,\nwhich is not the case in Windows, where you can have multiple drives,\ne.g. `C:`, `D:` etc.\n\nThis commit changes `fs.relative()` so that it no longer forces the result\nto be a `PathSegment` and then flows that refactoring through the rest of\nthe compiler-cli (and ngcc).  The main difference is that now, in some cases,\nwe needed to check whether the result is \"rooted\", i.e an `AbsoluteFsPath`,\nrather than a `PathSegment`, before using it.\n\nFixes #36777\n\nPR Close #37959",
    "sha": "6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
    "files": [
        {
            "sha": "dfe2b6188bad3d0012aa07d66dfe596c5348cbaf",
            "filename": "packages/compiler-cli/ngcc/src/analysis/util.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Fanalysis%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Fanalysis%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Fanalysis%2Futil.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -5,12 +5,12 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-import {AbsoluteFsPath, relative} from '../../../src/ngtsc/file_system';\n+import {AbsoluteFsPath, isLocalRelativePath, relative} from '../../../src/ngtsc/file_system';\n import {DependencyTracker} from '../../../src/ngtsc/incremental/api';\n \n export function isWithinPackage(packagePath: AbsoluteFsPath, filePath: AbsoluteFsPath): boolean {\n   const relativePath = relative(packagePath, filePath);\n-  return !relativePath.startsWith('..') && !relativePath.startsWith('node_modules/');\n+  return isLocalRelativePath(relativePath) && !relativePath.startsWith('node_modules/');\n }\n \n class NoopDependencyTracker implements DependencyTracker {"
        },
        {
            "sha": "7b24af8835f8a14216c9af61c60bef3632e7bf96",
            "filename": "packages/compiler-cli/ngcc/src/entry_point_finder/targeted_entry_point_finder.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Fentry_point_finder%2Ftargeted_entry_point_finder.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Fentry_point_finder%2Ftargeted_entry_point_finder.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Fentry_point_finder%2Ftargeted_entry_point_finder.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -228,11 +228,13 @@ export class TargetedEntryPointFinder extends TracingEntryPointFinder {\n   /**\n    * Split the given `path` into path segments using an FS independent algorithm.\n    */\n-  private splitPath(path: PathSegment) {\n+  private splitPath(path: PathSegment|AbsoluteFsPath) {\n     const segments = [];\n-    while (path !== '.') {\n+    let container = this.fs.dirname(path);\n+    while (path !== container) {\n       segments.unshift(this.fs.basename(path));\n-      path = this.fs.dirname(path);\n+      path = container;\n+      container = this.fs.dirname(container);\n     }\n     return segments;\n   }"
        },
        {
            "sha": "5f113661fba2f3c3989f3bec09e07168ff694622",
            "filename": "packages/compiler-cli/ngcc/src/rendering/esm_rendering_formatter.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 6,
            "changes": 13,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Frendering%2Fesm_rendering_formatter.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Frendering%2Fesm_rendering_formatter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Frendering%2Fesm_rendering_formatter.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -9,7 +9,7 @@ import {Statement} from '@angular/compiler';\n import MagicString from 'magic-string';\n import * as ts from 'typescript';\n \n-import {absoluteFromSourceFile, AbsoluteFsPath, dirname, relative} from '../../../src/ngtsc/file_system';\n+import {absoluteFromSourceFile, AbsoluteFsPath, dirname, relative, toRelativeImport} from '../../../src/ngtsc/file_system';\n import {NOOP_DEFAULT_IMPORT_RECORDER, Reexport} from '../../../src/ngtsc/imports';\n import {Import, ImportManager, translateStatement} from '../../../src/ngtsc/translator';\n import {isDtsPath} from '../../../src/ngtsc/util/src/typescript';\n@@ -57,8 +57,9 @@ export class EsmRenderingFormatter implements RenderingFormatter {\n \n       if (from) {\n         const basePath = stripExtension(from);\n-        const relativePath = './' + relative(dirname(entryPointBasePath), basePath);\n-        exportFrom = entryPointBasePath !== basePath ? ` from '${relativePath}'` : '';\n+        const relativePath = relative(dirname(entryPointBasePath), basePath);\n+        const relativeImport = toRelativeImport(relativePath);\n+        exportFrom = entryPointBasePath !== basePath ? ` from '${relativeImport}'` : '';\n       }\n \n       const exportStr = `\\nexport {${e.identifier}}${exportFrom};`;\n@@ -197,10 +198,10 @@ export class EsmRenderingFormatter implements RenderingFormatter {\n       const ngModuleName = info.ngModule.node.name.text;\n       const declarationFile = absoluteFromSourceFile(info.declaration.getSourceFile());\n       const ngModuleFile = absoluteFromSourceFile(info.ngModule.node.getSourceFile());\n+      const relativePath = relative(dirname(declarationFile), ngModuleFile);\n+      const relativeImport = toRelativeImport(relativePath);\n       const importPath = info.ngModule.ownedByModuleGuess ||\n-          (declarationFile !== ngModuleFile ?\n-               stripExtension(`./${relative(dirname(declarationFile), ngModuleFile)}`) :\n-               null);\n+          (declarationFile !== ngModuleFile ? stripExtension(relativeImport) : null);\n       const ngModule = generateImportString(importManager, importPath, ngModuleName);\n \n       if (info.declaration.type) {"
        },
        {
            "sha": "a3931bf926153429226027d55e8e6bdc7d380774",
            "filename": "packages/compiler-cli/ngcc/src/writing/new_entry_point_file_writer.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 8,
            "changes": 17,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Fwriting%2Fnew_entry_point_file_writer.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Fwriting%2Fnew_entry_point_file_writer.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Fwriting%2Fnew_entry_point_file_writer.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -6,7 +6,7 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-import {absoluteFromSourceFile, AbsoluteFsPath, dirname, FileSystem, join, relative} from '../../../src/ngtsc/file_system';\n+import {absoluteFromSourceFile, AbsoluteFsPath, dirname, FileSystem, isLocalRelativePath, join, relative, resolve} from '../../../src/ngtsc/file_system';\n import {Logger} from '../../../src/ngtsc/logging';\n import {isDtsPath} from '../../../src/ngtsc/util/src/typescript';\n import {EntryPoint, EntryPointJsonProperty} from '../packages/entry_point';\n@@ -70,9 +70,9 @@ export class NewEntryPointFileWriter extends InPlaceFileWriter {\n       bundle: EntryPointBundle, packagePath: AbsoluteFsPath, ngccFolder: AbsoluteFsPath) {\n     bundle.src.program.getSourceFiles().forEach(sourceFile => {\n       const relativePath = relative(packagePath, absoluteFromSourceFile(sourceFile));\n-      const isOutsidePackage = relativePath.startsWith('..');\n-      if (!sourceFile.isDeclarationFile && !isOutsidePackage) {\n-        const newFilePath = join(ngccFolder, relativePath);\n+      const isInsidePackage = isLocalRelativePath(relativePath);\n+      if (!sourceFile.isDeclarationFile && isInsidePackage) {\n+        const newFilePath = resolve(ngccFolder, relativePath);\n         this.fs.ensureDir(dirname(newFilePath));\n         this.fs.copyFile(absoluteFromSourceFile(sourceFile), newFilePath);\n       }\n@@ -86,7 +86,7 @@ export class NewEntryPointFileWriter extends InPlaceFileWriter {\n       super.writeFileAndBackup(file);\n     } else {\n       const relativePath = relative(packagePath, file.path);\n-      const newFilePath = join(ngccFolder, relativePath);\n+      const newFilePath = resolve(ngccFolder, relativePath);\n       this.fs.ensureDir(dirname(newFilePath));\n       this.fs.writeFile(newFilePath, file.contents);\n     }\n@@ -98,7 +98,7 @@ export class NewEntryPointFileWriter extends InPlaceFileWriter {\n       super.revertFileAndBackup(filePath);\n     } else if (this.fs.exists(filePath)) {\n       const relativePath = relative(packagePath, filePath);\n-      const newFilePath = join(packagePath, NGCC_DIRECTORY, relativePath);\n+      const newFilePath = resolve(packagePath, NGCC_DIRECTORY, relativePath);\n       this.fs.removeFile(newFilePath);\n     }\n   }\n@@ -117,8 +117,9 @@ export class NewEntryPointFileWriter extends InPlaceFileWriter {\n     // All format properties point to the same format-path.\n     const oldFormatProp = formatProperties[0]!;\n     const oldFormatPath = packageJson[oldFormatProp]!;\n-    const oldAbsFormatPath = join(entryPoint.path, oldFormatPath);\n-    const newAbsFormatPath = join(ngccFolder, relative(entryPoint.packagePath, oldAbsFormatPath));\n+    const oldAbsFormatPath = resolve(entryPoint.path, oldFormatPath);\n+    const newAbsFormatPath =\n+        resolve(ngccFolder, relative(entryPoint.packagePath, oldAbsFormatPath));\n     const newFormatPath = relative(entryPoint.path, newAbsFormatPath);\n \n     // Update all properties in `package.json` (both in memory and on disk)."
        },
        {
            "sha": "218f99de4b924eee65d893be2b83d193237cc25c",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Findex.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n export {NgtscCompilerHost} from './src/compiler_host';\n-export {absoluteFrom, absoluteFromSourceFile, basename, dirname, getFileSystem, isRoot, isRooted, join, relative, relativeFrom, resolve, setFileSystem} from './src/helpers';\n+export {absoluteFrom, absoluteFromSourceFile, basename, dirname, getFileSystem, isLocalRelativePath, isRoot, isRooted, join, relative, relativeFrom, resolve, setFileSystem, toRelativeImport} from './src/helpers';\n export {LogicalFileSystem, LogicalProjectPath} from './src/logical';\n export {NodeJSFileSystem} from './src/node_js_file_system';\n export {AbsoluteFsPath, FileStats, FileSystem, PathSegment, PathString} from './src/types';"
        },
        {
            "sha": "9e3476e64b905c3b104dacfa6243a85c16f401d5",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/src/helpers.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 1,
            "changes": 22,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Fhelpers.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Fhelpers.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Fhelpers.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -83,7 +83,7 @@ export function isRooted(path: string): boolean {\n /**\n  * Static access to `relative`.\n  */\n-export function relative<T extends PathString>(from: T, to: T): PathSegment {\n+export function relative<T extends PathString>(from: T, to: T): PathSegment|AbsoluteFsPath {\n   return fs.relative(from, to);\n }\n \n@@ -93,3 +93,23 @@ export function relative<T extends PathString>(from: T, to: T): PathSegment {\n export function basename(filePath: PathString, extension?: string): PathSegment {\n   return fs.basename(filePath, extension) as PathSegment;\n }\n+\n+/**\n+ * Returns true if the given path is locally relative.\n+ *\n+ * This is used to work out if the given path is relative (i.e. not absolute) but also is not\n+ * escaping the current directory.\n+ */\n+export function isLocalRelativePath(relativePath: string): boolean {\n+  return !isRooted(relativePath) && !relativePath.startsWith('..');\n+}\n+\n+/**\n+ * Converts a path to a form suitable for use as a relative module import specifier.\n+ *\n+ * In other words it adds the `./` to the path if it is locally relative.\n+ */\n+export function toRelativeImport(relativePath: PathSegment|AbsoluteFsPath): PathSegment|\n+    AbsoluteFsPath {\n+  return isLocalRelativePath(relativePath) ? `./${relativePath}` as PathSegment : relativePath;\n+}"
        },
        {
            "sha": "b55223efa8cad0f9649443fa7b03a66e5b7cd120",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/src/invalid_file_system.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Finvalid_file_system.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Finvalid_file_system.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Finvalid_file_system.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -82,7 +82,7 @@ export class InvalidFileSystem implements FileSystem {\n   isRooted(path: string): boolean {\n     throw makeError();\n   }\n-  relative<T extends PathString>(from: T, to: T): PathSegment {\n+  relative<T extends PathString>(from: T, to: T): PathSegment|AbsoluteFsPath {\n     throw makeError();\n   }\n   basename(filePath: string, extension?: string): PathSegment {"
        },
        {
            "sha": "02076286e3f871128aba80b1387db655a7444587",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/src/logical.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 7,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Flogical.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Flogical.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Flogical.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -7,7 +7,7 @@\n  */\n import * as ts from 'typescript';\n \n-import {absoluteFrom, dirname, relative, resolve} from './helpers';\n+import {absoluteFrom, dirname, isLocalRelativePath, relative, resolve, toRelativeImport} from './helpers';\n import {AbsoluteFsPath, BrandedPath, PathSegment} from './types';\n import {stripExtension} from './util';\n \n@@ -29,11 +29,8 @@ export const LogicalProjectPath = {\n    * importing from `to`.\n    */\n   relativePathBetween: function(from: LogicalProjectPath, to: LogicalProjectPath): PathSegment {\n-    let relativePath = relative(dirname(resolve(from)), resolve(to));\n-    if (!relativePath.startsWith('../')) {\n-      relativePath = ('./' + relativePath) as PathSegment;\n-    }\n-    return relativePath as PathSegment;\n+    const relativePath = relative(dirname(resolve(from)), resolve(to));\n+    return toRelativeImport(relativePath) as PathSegment;\n   },\n };\n \n@@ -122,5 +119,5 @@ export class LogicalFileSystem {\n  * E.g. `foo/bar/zee` is within `foo/bar` but not within `foo/car`.\n  */\n function isWithinBasePath(base: AbsoluteFsPath, path: AbsoluteFsPath): boolean {\n-  return !relative(base, path).startsWith('..');\n+  return isLocalRelativePath(relative(base, path));\n }"
        },
        {
            "sha": "44ad46a16dd5fb46fe4bf575d2fb0e275c86d649",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/src/node_js_file_system.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Fnode_js_file_system.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Fnode_js_file_system.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Fnode_js_file_system.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -9,7 +9,7 @@\n import * as fs from 'fs';\n import * as fsExtra from 'fs-extra';\n import * as p from 'path';\n-import {absoluteFrom, relativeFrom} from './helpers';\n+import {absoluteFrom} from './helpers';\n import {AbsoluteFsPath, FileStats, FileSystem, PathSegment, PathString} from './types';\n \n /**\n@@ -93,8 +93,8 @@ export class NodeJSFileSystem implements FileSystem {\n   isRooted(path: string): boolean {\n     return p.isAbsolute(path);\n   }\n-  relative<T extends PathString>(from: T, to: T): PathSegment {\n-    return relativeFrom(this.normalize(p.relative(from, to)));\n+  relative<T extends PathString>(from: T, to: T): PathSegment|AbsoluteFsPath {\n+    return this.normalize(p.relative(from, to)) as PathSegment | AbsoluteFsPath;\n   }\n   basename(filePath: string, extension?: string): PathSegment {\n     return p.basename(filePath, extension) as PathSegment;"
        },
        {
            "sha": "b232db828c83211dbd3c58e18d18622d7ed8db4f",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/src/types.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Ftypes.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Ftypes.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -57,7 +57,14 @@ export interface FileSystem {\n   resolve(...paths: string[]): AbsoluteFsPath;\n   dirname<T extends PathString>(file: T): T;\n   join<T extends PathString>(basePath: T, ...paths: string[]): T;\n-  relative<T extends PathString>(from: T, to: T): PathSegment;\n+  /**\n+   * Compute the relative path between `from` and `to`.\n+   *\n+   * In file-systems that can have multiple file trees the returned path may not actually be\n+   * \"relative\" (i.e. `PathSegment`). For example, Windows can have multiple drives :\n+   * `relative('c:/a/b', 'd:/a/c')` would be `d:/a/c'.\n+   */\n+  relative<T extends PathString>(from: T, to: T): PathSegment|AbsoluteFsPath;\n   basename(filePath: string, extension?: string): PathSegment;\n   realpath(filePath: AbsoluteFsPath): AbsoluteFsPath;\n   getDefaultLibLocation(): AbsoluteFsPath;"
        },
        {
            "sha": "728bc93fbdb12f335cdce622bc5b7a414f9735ba",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/src/util.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Fsrc%2Futil.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n import * as ts from 'typescript';\n-import {AbsoluteFsPath} from './types';\n+import {AbsoluteFsPath, PathString} from './types';\n \n const TS_DTS_JS_EXTENSION = /(?:\\.d)?\\.ts$|\\.js$/;\n \n@@ -21,8 +21,8 @@ export function normalizeSeparators(path: string): string {\n /**\n  * Remove a .ts, .d.ts, or .js extension from a file name.\n  */\n-export function stripExtension(path: string): string {\n-  return path.replace(TS_DTS_JS_EXTENSION, '');\n+export function stripExtension<T extends PathString>(path: T): T {\n+  return path.replace(TS_DTS_JS_EXTENSION, '') as T;\n }\n \n export function getSourceFileOrError(program: ts.Program, fileName: AbsoluteFsPath): ts.SourceFile {"
        },
        {
            "sha": "ea87f7dc626648fbda2ad0da5ad526e87ecbad6f",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/test/node_js_file_system_spec.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftest%2Fnode_js_file_system_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftest%2Fnode_js_file_system_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftest%2Fnode_js_file_system_spec.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -7,6 +7,7 @@\n  */\n import * as realFs from 'fs';\n import * as fsExtra from 'fs-extra';\n+import * as os from 'os';\n import {absoluteFrom, dirname, relativeFrom, setFileSystem} from '../src/helpers';\n import {NodeJSFileSystem} from '../src/node_js_file_system';\n import {AbsoluteFsPath} from '../src/types';\n@@ -245,4 +246,13 @@ describe('NodeJSFileSystem', () => {\n       expect(fs.isCaseSensitive()).toEqual(isCaseSensitive);\n     });\n   });\n+\n+  if (os.platform() === 'win32') {\n+    // Only relevant on Windows\n+    describe('relative', () => {\n+      it('should handle Windows paths on different drives', () => {\n+        expect(fs.relative('C:\\\\a\\\\b\\\\c', 'D:\\\\a\\\\b\\\\d')).toEqual(absoluteFrom('D:\\\\a\\\\b\\\\d'));\n+      });\n+    });\n+  }\n });"
        },
        {
            "sha": "5d4cc337bac5690fdeccda55846233f7491314f0",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/testing/src/mock_file_system.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -214,7 +214,7 @@ export abstract class MockFileSystem implements FileSystem {\n   abstract resolve(...paths: string[]): AbsoluteFsPath;\n   abstract dirname<T extends string>(file: T): T;\n   abstract join<T extends string>(basePath: T, ...paths: string[]): T;\n-  abstract relative<T extends PathString>(from: T, to: T): PathSegment;\n+  abstract relative<T extends PathString>(from: T, to: T): PathSegment|AbsoluteFsPath;\n   abstract basename(filePath: string, extension?: string): PathSegment;\n   abstract isRooted(path: string): boolean;\n   abstract normalize<T extends PathString>(path: T): T;"
        },
        {
            "sha": "e856448a35c0d69d115ea7d5d7d55287a5f561ba",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/testing/src/mock_file_system_native.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system_native.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system_native.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system_native.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -30,7 +30,7 @@ export class MockFileSystemNative extends MockFileSystem {\n   join<T extends string>(basePath: T, ...paths: string[]): T {\n     return NodeJSFileSystem.prototype.join.call(this, basePath, ...paths) as T;\n   }\n-  relative<T extends PathString>(from: T, to: T): PathSegment {\n+  relative<T extends PathString>(from: T, to: T): PathSegment|AbsoluteFsPath {\n     return NodeJSFileSystem.prototype.relative.call(this, from, to);\n   }\n "
        },
        {
            "sha": "a8e84806b5b16f19101ee1784eeb3c7a7e0442fe",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/testing/src/mock_file_system_posix.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system_posix.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system_posix.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system_posix.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -25,8 +25,8 @@ export class MockFileSystemPosix extends MockFileSystem {\n     return this.normalize(p.posix.join(basePath, ...paths)) as T;\n   }\n \n-  relative<T extends PathString>(from: T, to: T): PathSegment {\n-    return this.normalize(p.posix.relative(from, to)) as PathSegment;\n+  relative<T extends PathString>(from: T, to: T): PathSegment|AbsoluteFsPath {\n+    return this.normalize(p.posix.relative(from, to)) as PathSegment | AbsoluteFsPath;\n   }\n \n   basename(filePath: string, extension?: string): PathSegment {"
        },
        {
            "sha": "a34a7f61b9db59d032b11b049614b7688ae17d16",
            "filename": "packages/compiler-cli/src/ngtsc/file_system/testing/src/mock_file_system_windows.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system_windows.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system_windows.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ffile_system%2Ftesting%2Fsrc%2Fmock_file_system_windows.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -25,8 +25,8 @@ export class MockFileSystemWindows extends MockFileSystem {\n     return this.normalize(p.win32.join(basePath, ...paths)) as T;\n   }\n \n-  relative<T extends PathString>(from: T, to: T): PathSegment {\n-    return this.normalize(p.win32.relative(from, to)) as PathSegment;\n+  relative<T extends PathString>(from: T, to: T): PathSegment|AbsoluteFsPath {\n+    return this.normalize(p.win32.relative(from, to)) as PathSegment | AbsoluteFsPath;\n   }\n \n   basename(filePath: string, extension?: string): PathSegment {"
        },
        {
            "sha": "2fa42012c84f85a763a813011bf5ffe1149ee8d0",
            "filename": "packages/compiler-cli/src/ngtsc/imports/src/emitter.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fimports%2Fsrc%2Femitter.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fimports%2Fsrc%2Femitter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fimports%2Fsrc%2Femitter.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -9,7 +9,7 @@ import {Expression, ExternalExpr, ExternalReference, WrappedNodeExpr} from '@ang\n import * as ts from 'typescript';\n \n import {UnifiedModulesHost} from '../../core/api';\n-import {absoluteFromSourceFile, dirname, LogicalFileSystem, LogicalProjectPath, PathSegment, relative} from '../../file_system';\n+import {absoluteFromSourceFile, dirname, LogicalFileSystem, LogicalProjectPath, relative, toRelativeImport} from '../../file_system';\n import {stripExtension} from '../../file_system/src/util';\n import {ReflectionHost} from '../../reflection';\n import {getSourceFile, isDeclaration, isTypeDeclaration, nodeNameForError} from '../../util/src/typescript';\n@@ -269,11 +269,9 @@ export class RelativePathStrategy implements ReferenceEmitStrategy {\n \n   emit(ref: Reference<ts.Node>, context: ts.SourceFile): Expression|null {\n     const destSf = getSourceFile(ref.node);\n-    let moduleName = stripExtension(\n-        relative(dirname(absoluteFromSourceFile(context)), absoluteFromSourceFile(destSf)));\n-    if (!moduleName.startsWith('../')) {\n-      moduleName = ('./' + moduleName) as PathSegment;\n-    }\n+    const relativePath =\n+        relative(dirname(absoluteFromSourceFile(context)), absoluteFromSourceFile(destSf));\n+    const moduleName = toRelativeImport(stripExtension(relativePath));\n \n     const name = findExportedNameOfNode(ref.node, destSf, this.reflector);\n     return new ExternalExpr({moduleName, name});"
        },
        {
            "sha": "81bf17f5a91ad6f4eadc28586d84002b99246178",
            "filename": "packages/compiler-cli/src/ngtsc/util/src/path.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 15,
            "changes": 19,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Futil%2Fsrc%2Fpath.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Futil%2Fsrc%2Fpath.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Futil%2Fsrc%2Fpath.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -5,23 +5,12 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-import {dirname, relative, resolve} from '../../file_system';\n-\n-const TS_DTS_JS_EXTENSION = /(?:\\.d)?\\.ts$|\\.js$/;\n+import {dirname, relative, resolve, toRelativeImport} from '../../file_system';\n+import {stripExtension} from '../../file_system/src/util';\n \n export function relativePathBetween(from: string, to: string): string|null {\n-  let relativePath = relative(dirname(resolve(from)), resolve(to)).replace(TS_DTS_JS_EXTENSION, '');\n-\n-  if (relativePath === '') {\n-    return null;\n-  }\n-\n-  // path.relative() does not include the leading './'.\n-  if (!relativePath.startsWith('.')) {\n-    relativePath = `./${relativePath}`;\n-  }\n-\n-  return relativePath;\n+  const relativePath = stripExtension(relative(dirname(resolve(from)), resolve(to)));\n+  return relativePath !== '' ? toRelativeImport(relativePath) : null;\n }\n \n export function normalizeSeparators(path: string): string {"
        },
        {
            "sha": "dcf3a3f25d9e7f23c9c29caf6dea8ea68065af4f",
            "filename": "packages/compiler-cli/test/ngtsc/env.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Fenv.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Fenv.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Fenv.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -12,7 +12,7 @@ import * as ts from 'typescript';\n \n import {createCompilerHost, createProgram} from '../../index';\n import {main, mainDiagnosticsForTest, readNgcCommandLineAndConfiguration} from '../../src/main';\n-import {absoluteFrom, AbsoluteFsPath, FileSystem, getFileSystem, NgtscCompilerHost} from '../../src/ngtsc/file_system';\n+import {absoluteFrom, AbsoluteFsPath, FileSystem, getFileSystem, NgtscCompilerHost, relativeFrom} from '../../src/ngtsc/file_system';\n import {Folder, MockFileSystem} from '../../src/ngtsc/file_system/testing';\n import {IndexedComponent} from '../../src/ngtsc/indexer';\n import {NgtscProgram} from '../../src/ngtsc/program';\n@@ -274,7 +274,8 @@ const ROOT_PREFIX = 'root/';\n \n class FileNameToModuleNameHost extends AugmentedCompilerHost {\n   fileNameToModuleName(importedFilePath: string): string {\n-    const relativeFilePath = this.fs.relative(this.fs.pwd(), this.fs.resolve(importedFilePath));\n+    const relativeFilePath =\n+        relativeFrom(this.fs.relative(this.fs.pwd(), this.fs.resolve(importedFilePath)));\n     const rootedPath = this.fs.join('root', relativeFilePath);\n     return rootedPath.replace(/(\\.d)?.ts$/, '');\n   }"
        },
        {
            "sha": "97ae7ba8a6e2cd8ef971c78fd44d23ea560a31d6",
            "filename": "packages/localize/src/tools/src/translate/asset_files/asset_translation_handler.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Fasset_files%2Fasset_translation_handler.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Fasset_files%2Fasset_translation_handler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Fasset_files%2Fasset_translation_handler.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -17,14 +17,14 @@ import {TranslationBundle, TranslationHandler} from '../translator';\n export class AssetTranslationHandler implements TranslationHandler {\n   constructor(private fs: FileSystem) {}\n \n-  canTranslate(_relativeFilePath: PathSegment, _contents: Buffer): boolean {\n+  canTranslate(_relativeFilePath: PathSegment|AbsoluteFsPath, _contents: Buffer): boolean {\n     return true;\n   }\n \n   translate(\n-      diagnostics: Diagnostics, _sourceRoot: AbsoluteFsPath, relativeFilePath: PathSegment,\n-      contents: Buffer, outputPathFn: OutputPathFn, translations: TranslationBundle[],\n-      sourceLocale?: string): void {\n+      diagnostics: Diagnostics, _sourceRoot: AbsoluteFsPath,\n+      relativeFilePath: PathSegment|AbsoluteFsPath, contents: Buffer, outputPathFn: OutputPathFn,\n+      translations: TranslationBundle[], sourceLocale?: string): void {\n     for (const translation of translations) {\n       this.writeAssetFile(\n           diagnostics, outputPathFn, translation.locale, relativeFilePath, contents);\n@@ -36,7 +36,7 @@ export class AssetTranslationHandler implements TranslationHandler {\n \n   private writeAssetFile(\n       diagnostics: Diagnostics, outputPathFn: OutputPathFn, locale: string,\n-      relativeFilePath: PathSegment, contents: Buffer): void {\n+      relativeFilePath: PathSegment|AbsoluteFsPath, contents: Buffer): void {\n     try {\n       const outputPath = absoluteFrom(outputPathFn(locale, relativeFilePath));\n       this.fs.ensureDir(this.fs.dirname(outputPath));"
        },
        {
            "sha": "4d1e6cc763fb3a4cfc11090d121241bc6e6aa54a",
            "filename": "packages/localize/src/tools/src/translate/source_files/source_file_translation_handler.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Fsource_files%2Fsource_file_translation_handler.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Fsource_files%2Fsource_file_translation_handler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Fsource_files%2Fsource_file_translation_handler.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -5,7 +5,7 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-import {absoluteFrom, AbsoluteFsPath, FileSystem, PathSegment, relativeFrom} from '@angular/compiler-cli/src/ngtsc/file_system';\n+import {absoluteFrom, AbsoluteFsPath, FileSystem, PathSegment} from '@angular/compiler-cli/src/ngtsc/file_system';\n import {parseSync, transformFromAstSync} from '@babel/core';\n import {File, Program} from '@babel/types';\n \n@@ -27,8 +27,8 @@ export class SourceFileTranslationHandler implements TranslationHandler {\n       TranslatePluginOptions = {...this.translationOptions, missingTranslation: 'ignore'};\n   constructor(private fs: FileSystem, private translationOptions: TranslatePluginOptions = {}) {}\n \n-  canTranslate(relativeFilePath: PathSegment, _contents: Buffer): boolean {\n-    return this.fs.extname(relativeFrom(relativeFilePath)) === '.js';\n+  canTranslate(relativeFilePath: PathSegment|AbsoluteFsPath, _contents: Buffer): boolean {\n+    return this.fs.extname(relativeFilePath) === '.js';\n   }\n \n   translate("
        },
        {
            "sha": "a72e1d87bbc5c66d9baf3396a2207c10466f13dc",
            "filename": "packages/localize/src/tools/src/translate/translator.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Ftranslator.ts",
            "raw_url": "https://github.com/angular/angular/raw/6b311552f04e3b35f1089145c0a44b93d9aa2fdd/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Ftranslator.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Ftranslator.ts?ref=6b311552f04e3b35f1089145c0a44b93d9aa2fdd",
            "patch": "@@ -35,7 +35,7 @@ export interface TranslationHandler {\n    * @param relativeFilePath A relative path from the sourceRoot to the resource file to handle.\n    * @param contents The contents of the file to handle.\n    */\n-  canTranslate(relativeFilePath: PathSegment, contents: Buffer): boolean;\n+  canTranslate(relativeFilePath: PathSegment|AbsoluteFsPath, contents: Buffer): boolean;\n \n   /**\n    * Translate the file at `relativeFilePath` containing `contents`, using the given `translations`,\n@@ -53,9 +53,9 @@ export interface TranslationHandler {\n    * stripped out.\n    */\n   translate(\n-      diagnostics: Diagnostics, sourceRoot: AbsoluteFsPath, relativeFilePath: PathSegment,\n-      contents: Buffer, outputPathFn: OutputPathFn, translations: TranslationBundle[],\n-      sourceLocale?: string): void;\n+      diagnostics: Diagnostics, sourceRoot: AbsoluteFsPath,\n+      relativeFilePath: PathSegment|AbsoluteFsPath, contents: Buffer, outputPathFn: OutputPathFn,\n+      translations: TranslationBundle[], sourceLocale?: string): void;\n }\n \n /**"
        }
    ],
    "stats": {
        "total": 180,
        "additions": 103,
        "deletions": 77
    }
}