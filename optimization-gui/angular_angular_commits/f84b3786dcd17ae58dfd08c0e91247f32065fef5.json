{
    "author": "JoostK",
    "message": "test(language-service): test ICU expressions in hybrid visitor (#39072)\n\nThis commit adds tests for locating expressions within ICU expressions.\n\nPR Close #39072",
    "sha": "f84b3786dcd17ae58dfd08c0e91247f32065fef5",
    "files": [
        {
            "sha": "04d357823863c73b22efa45f2343924d3e7c3bc5",
            "filename": "packages/language-service/ivy/test/hybrid_visitor_spec.ts",
            "status": "modified",
            "additions": 39,
            "deletions": 0,
            "changes": 39,
            "blob_url": "https://github.com/angular/angular/blob/f84b3786dcd17ae58dfd08c0e91247f32065fef5/packages%2Flanguage-service%2Fivy%2Ftest%2Fhybrid_visitor_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/f84b3786dcd17ae58dfd08c0e91247f32065fef5/packages%2Flanguage-service%2Fivy%2Ftest%2Fhybrid_visitor_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Fhybrid_visitor_spec.ts?ref=f84b3786dcd17ae58dfd08c0e91247f32065fef5",
            "patch": "@@ -324,6 +324,45 @@ describe('findNodeAtPosition for template AST', () => {\n     expect(node).toBeInstanceOf(e.PropertyRead);\n     expect((node as e.PropertyRead).name).toBe('bar');\n   });\n+\n+  it('should locate switch value in ICUs', () => {\n+    const {errors, nodes, position} = parse(`<span i18n>{sw¦itch, plural, other {text}}\"></span>`);\n+    expect(errors).toBe(null);\n+    const node = findNodeAtPosition(nodes, position);\n+    expect(isExpressionNode(node!)).toBe(true);\n+    expect(node).toBeInstanceOf(e.PropertyRead);\n+    expect((node as e.PropertyRead).name).toBe('switch');\n+  });\n+\n+  it('should locate switch value in nested ICUs', () => {\n+    const {errors, nodes, position} = parse(\n+        `<span i18n>{expr, plural, other { {ne¦sted, plural, =1 { {{nestedInterpolation}} }} }}\"></span>`);\n+    expect(errors).toBe(null);\n+    const node = findNodeAtPosition(nodes, position);\n+    expect(isExpressionNode(node!)).toBe(true);\n+    expect(node).toBeInstanceOf(e.PropertyRead);\n+    expect((node as e.PropertyRead).name).toBe('nested');\n+  });\n+\n+  it('should locate interpolation expressions in ICUs', () => {\n+    const {errors, nodes, position} =\n+        parse(`<span i18n>{expr, plural, other { {{ i¦nterpolation }} }}\"></span>`);\n+    expect(errors).toBe(null);\n+    const node = findNodeAtPosition(nodes, position);\n+    expect(isExpressionNode(node!)).toBe(true);\n+    expect(node).toBeInstanceOf(e.PropertyRead);\n+    expect((node as e.PropertyRead).name).toBe('interpolation');\n+  });\n+\n+  it('should locate interpolation expressions in nested ICUs', () => {\n+    const {errors, nodes, position} = parse(\n+        `<span i18n>{expr, plural, other { {nested, plural, =1 { {{n¦estedInterpolation}} }} }}\"></span>`);\n+    expect(errors).toBe(null);\n+    const node = findNodeAtPosition(nodes, position);\n+    expect(isExpressionNode(node!)).toBe(true);\n+    expect(node).toBeInstanceOf(e.PropertyRead);\n+    expect((node as e.PropertyRead).name).toBe('nestedInterpolation');\n+  });\n });\n \n describe('findNodeAtPosition for expression AST', () => {"
        }
    ],
    "stats": {
        "total": 39,
        "additions": 39,
        "deletions": 0
    }
}