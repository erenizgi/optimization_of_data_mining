{
    "author": "JoostK",
    "message": "feat(compiler-cli): partial compilation of directives (#39518)\n\nThis commit implements partial code generation for directives, which\nwill be transformed by the linker plugin to fully AOT compiled code in\nfollow-up work.\n\nPR Close #39518",
    "sha": "8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
    "files": [
        {
            "sha": "728e56ac6412fd0bc98807d4e55994bd34bc62cd",
            "filename": "goldens/public-api/core/core.d.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/goldens%2Fpublic-api%2Fcore%2Fcore.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/goldens%2Fpublic-api%2Fcore%2Fcore.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fcore%2Fcore.d.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -1,3 +1,6 @@\n+/** @codeGenApi */\n+export declare function $ngDeclareDirective(decl: unknown): unknown;\n+\n export declare interface AbstractType<T> extends Function {\n     prototype: T;\n }"
        },
        {
            "sha": "304da8b032a0db82e0046c238455bbf1d6ea7474",
            "filename": "packages/compiler-cli/src/ngtsc/annotations/src/directive.ts",
            "status": "modified",
            "additions": 22,
            "deletions": 7,
            "changes": 29,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fannotations%2Fsrc%2Fdirective.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fannotations%2Fsrc%2Fdirective.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fannotations%2Fsrc%2Fdirective.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {compileDirectiveFromMetadata, ConstantPool, Expression, Identifiers, makeBindingParser, ParsedHostBindings, ParseError, parseHostBindings, R3DependencyMetadata, R3DirectiveMetadata, R3FactoryTarget, R3QueryMetadata, Statement, verifyHostBindings, WrappedNodeExpr} from '@angular/compiler';\n+import {compileDeclareDirectiveFromMetadata, compileDirectiveFromMetadata, ConstantPool, Expression, Identifiers, makeBindingParser, ParsedHostBindings, ParseError, parseHostBindings, R3DependencyMetadata, R3DirectiveDef, R3DirectiveMetadata, R3FactoryTarget, R3QueryMetadata, Statement, verifyHostBindings, WrappedNodeExpr} from '@angular/compiler';\n import * as ts from 'typescript';\n \n import {ErrorCode, FatalDiagnosticError} from '../../diagnostics';\n@@ -154,19 +154,34 @@ export class DirectiveDecoratorHandler implements\n   compileFull(\n       node: ClassDeclaration, analysis: Readonly<DirectiveHandlerData>,\n       resolution: Readonly<unknown>, pool: ConstantPool): CompileResult[] {\n-    const meta = analysis.meta;\n-    const res = compileDirectiveFromMetadata(meta, pool, makeBindingParser());\n-    const factoryRes = compileNgFactoryDefField(\n-        {...meta, injectFn: Identifiers.directiveInject, target: R3FactoryTarget.Directive});\n+    const def = compileDirectiveFromMetadata(analysis.meta, pool, makeBindingParser());\n+    return this.compileDirective(analysis, def);\n+  }\n+\n+  compilePartial(\n+      node: ClassDeclaration, analysis: Readonly<DirectiveHandlerData>,\n+      resolution: Readonly<unknown>): CompileResult[] {\n+    const def = compileDeclareDirectiveFromMetadata(analysis.meta);\n+    return this.compileDirective(analysis, def);\n+  }\n+\n+  private compileDirective(\n+      analysis: Readonly<DirectiveHandlerData>,\n+      {expression: initializer, type}: R3DirectiveDef): CompileResult[] {\n+    const factoryRes = compileNgFactoryDefField({\n+      ...analysis.meta,\n+      injectFn: Identifiers.directiveInject,\n+      target: R3FactoryTarget.Directive,\n+    });\n     if (analysis.metadataStmt !== null) {\n       factoryRes.statements.push(analysis.metadataStmt);\n     }\n     return [\n       factoryRes, {\n         name: 'ɵdir',\n-        initializer: res.expression,\n+        initializer,\n         statements: [],\n-        type: res.type,\n+        type,\n       }\n     ];\n   }"
        },
        {
            "sha": "2a5c16f61a578b6e3896052f3007cb208e571564",
            "filename": "packages/compiler-cli/src/ngtsc/translator/src/translator.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftranslator%2Fsrc%2Ftranslator.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftranslator%2Fsrc%2Ftranslator.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftranslator%2Fsrc%2Ftranslator.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -249,7 +249,10 @@ export class ExpressionTranslatorVisitor<TStatement, TExpression> implements o.E\n \n   visitExternalExpr(ast: o.ExternalExpr, _context: Context): TExpression {\n     if (ast.value.name === null) {\n-      throw new Error(`Import unknown module or symbol ${ast.value}`);\n+      if (ast.value.moduleName === null) {\n+        throw new Error('Invalid import without name nor moduleName');\n+      }\n+      return this.imports.generateNamespaceImport(ast.value.moduleName);\n     }\n     // If a moduleName is specified, this is a normal import. If there's no module name, it's a\n     // reference to a global/ambient symbol."
        },
        {
            "sha": "84d6e2d30c815e76947124b09c31f0712ddd3c33",
            "filename": "packages/compiler/src/compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fcompiler.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -102,6 +102,7 @@ export {compilePipeFromMetadata, R3PipeMetadata} from './render3/r3_pipe_compile\n export {makeBindingParser, ParsedTemplate, parseTemplate, ParseTemplateOptions} from './render3/view/template';\n export {R3Reference} from './render3/util';\n export {compileComponentFromMetadata, compileDirectiveFromMetadata, parseHostBindings, ParsedHostBindings, verifyHostBindings} from './render3/view/compiler';\n+export {compileDeclareDirectiveFromMetadata} from './render3/partial/directive';\n export {publishFacade} from './jit_compiler_facade';\n // This file only reexports content of the `src` folder. Keep it that way.\n "
        },
        {
            "sha": "b02a3a99c5470d02a6fc46d6b77d9e0282d9c8f8",
            "filename": "packages/compiler/src/render3/partial/api.ts",
            "status": "added",
            "additions": 157,
            "deletions": 0,
            "changes": 157,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fpartial%2Fapi.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fpartial%2Fapi.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fpartial%2Fapi.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -0,0 +1,157 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+import * as o from '../../output/output_ast';\n+\n+/**\n+ * This interface describes the shape of the object that partial directive declarations are compiled\n+ * into. This serves only as documentation, as conformance of this interface is not enforced during\n+ * the generation of the partial declaration, nor when the linker applies full compilation from the\n+ * partial declaration.\n+ */\n+export interface R3DeclareDirectiveMetadata {\n+  /**\n+   * Version number of the metadata format. This is used to evolve the metadata\n+   * interface later - the linker will be able to detect which version a library\n+   * is using and interpret its metadata accordingly.\n+   */\n+  version: 1;\n+\n+  /**\n+   * Unparsed selector of the directive.\n+   */\n+  selector?: string;\n+\n+  /**\n+   * Reference to the directive class itself.\n+   */\n+  type: o.Expression;\n+\n+  /**\n+   * A mapping of inputs from class property names to binding property names, or to a tuple of\n+   * binding property name and class property name if the names are different.\n+   */\n+  inputs?: {[classPropertyName: string]: string|[string, string]};\n+\n+  /**\n+   * A mapping of outputs from class property names to binding property names, or to a tuple of\n+   * binding property name and class property name if the names are different.\n+   */\n+  outputs?: {[classPropertyName: string]: string};\n+\n+  /**\n+   * Information about host bindings present on the component.\n+   */\n+  host?: {\n+    /**\n+     * A mapping of attribute names to their value expression.\n+     */\n+    attributes?: {[key: string]: o.Expression};\n+\n+    /**\n+     * A mapping of event names to their unparsed event handler expression.\n+     */\n+    listeners: {[key: string]: string};\n+\n+    /**\n+     * A mapping of bound properties to their unparsed binding expression.\n+     */\n+    properties?: {[key: string]: string};\n+\n+    /**\n+     * The value of the class attribute, if present. This is stored outside of `attributes` as its\n+     * string value must be known statically.\n+     */\n+    classAttribute?: string;\n+\n+    /**\n+     * The value of the style attribute, if present. This is stored outside of `attributes` as its\n+     * string value must be known statically.\n+     */\n+    styleAttribute?: string;\n+  };\n+\n+  /**\n+   * Information about the content queries made by the directive.\n+   */\n+  queries?: R3DeclareQueryMetadata[];\n+\n+  /**\n+   * Information about the view queries made by the directive.\n+   */\n+  viewQueries?: R3DeclareQueryMetadata[];\n+\n+  /**\n+   * The list of providers provided by the directive.\n+   */\n+  providers?: o.Expression;\n+\n+  /**\n+   * The names by which the directive is exported.\n+   */\n+  exportAs?: string[];\n+\n+  /**\n+   * Whether the directive has an inheritance clause. Defaults to false.\n+   */\n+  usesInheritance?: boolean;\n+\n+  /**\n+   * Whether the directive implements the `ngOnChanges` hook. Defaults to false.\n+   */\n+  usesOnChanges?: boolean;\n+\n+  /**\n+   * A reference to the `@angular/core` ES module, which allows access\n+   * to all Angular exports, including Ivy instructions.\n+   */\n+  ngImport: o.Expression;\n+}\n+\n+export interface R3DeclareQueryMetadata {\n+  /**\n+   * Name of the property on the class to update with query results.\n+   */\n+  propertyName: string;\n+\n+  /**\n+   * Whether to read only the first matching result, or an array of results. Defaults to false.\n+   */\n+  first?: boolean;\n+\n+  /**\n+   * Either an expression representing a type or `InjectionToken` for the query\n+   * predicate, or a set of string selectors.\n+   */\n+  predicate: o.Expression|string[];\n+\n+  /**\n+   * Whether to include only direct children or all descendants. Defaults to false.\n+   */\n+  descendants?: boolean;\n+\n+  /**\n+   * An expression representing a type to read from each matched node, or null if the default value\n+   * for a given node is to be returned.\n+   */\n+  read?: o.Expression;\n+\n+  /**\n+   * Whether or not this query should collect only static results. Defaults to false.\n+   *\n+   * If static is true, the query's results will be set on the component after nodes are created,\n+   * but before change detection runs. This means that any results that relied upon change detection\n+   * to run (e.g. results inside *ngIf or *ngFor views) will not be collected. Query results are\n+   * available in the ngOnInit hook.\n+   *\n+   * If static is false, the query's results will be set on the component after change detection\n+   * runs. This means that the query results can contain nodes inside *ngIf or *ngFor views, but\n+   * the results will not be available in the ngOnInit hook (only in the ngAfterContentInit for\n+   * content hooks and ngAfterViewInit for view hooks).\n+   */\n+  static?: boolean;\n+}"
        },
        {
            "sha": "71496c4225de75ccfc8be16984b1a437b2a12108",
            "filename": "packages/compiler/src/render3/partial/directive.ts",
            "status": "added",
            "additions": 143,
            "deletions": 0,
            "changes": 143,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fpartial%2Fdirective.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fpartial%2Fdirective.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fpartial%2Fdirective.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -0,0 +1,143 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+import * as o from '../../output/output_ast';\n+import {Identifiers as R3} from '../r3_identifiers';\n+import {R3DirectiveDef, R3DirectiveMetadata, R3HostMetadata, R3QueryMetadata} from '../view/api';\n+import {createDirectiveTypeParams} from '../view/compiler';\n+import {asLiteral, conditionallyCreateMapObjectLiteral, DefinitionMap} from '../view/util';\n+\n+\n+/**\n+ * Compile a directive declaration defined by the `R3DirectiveMetadata`.\n+ */\n+export function compileDeclareDirectiveFromMetadata(meta: R3DirectiveMetadata): R3DirectiveDef {\n+  const definitionMap = createDirectiveDefinitionMap(meta);\n+\n+  const expression = o.importExpr(R3.declareDirective).callFn([definitionMap.toLiteralMap()]);\n+\n+  const typeParams = createDirectiveTypeParams(meta);\n+  const type = o.expressionType(o.importExpr(R3.DirectiveDefWithMeta, typeParams));\n+\n+  return {expression, type};\n+}\n+\n+/**\n+ * Gathers the declaration fields for a directive into a `DefinitionMap`. This allows for reusing\n+ * this logic for components, as they extend the directive metadata.\n+ */\n+export function createDirectiveDefinitionMap(meta: R3DirectiveMetadata): DefinitionMap {\n+  const definitionMap = new DefinitionMap();\n+\n+  definitionMap.set('version', o.literal(1));\n+\n+  // e.g. `type: MyDirective`\n+  definitionMap.set('type', meta.internalType);\n+\n+  // e.g. `selector: 'some-dir'`\n+  if (meta.selector !== null) {\n+    definitionMap.set('selector', o.literal(meta.selector));\n+  }\n+\n+  definitionMap.set('inputs', conditionallyCreateMapObjectLiteral(meta.inputs, true));\n+  definitionMap.set('outputs', conditionallyCreateMapObjectLiteral(meta.outputs));\n+\n+  definitionMap.set('host', compileHostMetadata(meta.host));\n+\n+  definitionMap.set('providers', meta.providers);\n+\n+  if (meta.queries.length > 0) {\n+    definitionMap.set('queries', o.literalArr(meta.queries.map(compileQuery)));\n+  }\n+  if (meta.viewQueries.length > 0) {\n+    definitionMap.set('viewQueries', o.literalArr(meta.viewQueries.map(compileQuery)));\n+  }\n+\n+  if (meta.exportAs !== null) {\n+    definitionMap.set('exportAs', asLiteral(meta.exportAs));\n+  }\n+\n+  if (meta.usesInheritance) {\n+    definitionMap.set('usesInheritance', o.literal(true));\n+  }\n+  if (meta.lifecycle.usesOnChanges) {\n+    definitionMap.set('usesOnChanges', o.literal(true));\n+  }\n+\n+  definitionMap.set('ngImport', o.importExpr(R3.core));\n+\n+  return definitionMap;\n+}\n+\n+/**\n+ * Compiles the metadata of a single query into its partial declaration form as declared\n+ * by `R3DeclareQueryMetadata`.\n+ */\n+function compileQuery(query: R3QueryMetadata): o.LiteralMapExpr {\n+  const meta = new DefinitionMap();\n+  meta.set('propertyName', o.literal(query.propertyName));\n+  if (query.first) {\n+    meta.set('first', o.literal(true));\n+  }\n+  meta.set(\n+      'predicate', Array.isArray(query.predicate) ? asLiteral(query.predicate) : query.predicate);\n+  if (query.descendants) {\n+    meta.set('descendants', o.literal(true));\n+  }\n+  meta.set('read', query.read);\n+  if (query.static) {\n+    meta.set('static', o.literal(true));\n+  }\n+  return meta.toLiteralMap();\n+}\n+\n+/**\n+ * Compiles the host metadata into its partial declaration form as declared\n+ * in `R3DeclareDirectiveMetadata['host']`\n+ */\n+function compileHostMetadata(meta: R3HostMetadata): o.LiteralMapExpr|null {\n+  const hostMetadata = new DefinitionMap();\n+  hostMetadata.set('attributes', toOptionalLiteralMap(meta.attributes, expression => expression));\n+  hostMetadata.set('listeners', toOptionalLiteralMap(meta.listeners, o.literal));\n+  hostMetadata.set('properties', toOptionalLiteralMap(meta.properties, o.literal));\n+\n+  if (meta.specialAttributes.styleAttr) {\n+    hostMetadata.set('styleAttribute', o.literal(meta.specialAttributes.styleAttr));\n+  }\n+  if (meta.specialAttributes.classAttr) {\n+    hostMetadata.set('classAttribute', o.literal(meta.specialAttributes.classAttr));\n+  }\n+\n+  if (hostMetadata.values.length > 0) {\n+    return hostMetadata.toLiteralMap();\n+  } else {\n+    return null;\n+  }\n+}\n+\n+/**\n+ * Creates an object literal expression from the given object, mapping all values to an expression\n+ * using the provided mapping function. If the object has no keys, then null is returned.\n+ *\n+ * @param object The object to transfer into an object literal expression.\n+ * @param mapper The logic to use for creating an expression for the object's values.\n+ * @returns An object literal expression representing `object`, or null if `object` does not have\n+ * any keys.\n+ */\n+function toOptionalLiteralMap<T>(\n+    object: {[key: string]: T}, mapper: (value: T) => o.Expression): o.LiteralMapExpr|null {\n+  const entries = Object.keys(object).map(key => {\n+    const value = object[key];\n+    return {key, value: mapper(value), quoted: true};\n+  });\n+\n+  if (entries.length > 0) {\n+    return o.literalMap(entries);\n+  } else {\n+    return null;\n+  }\n+}"
        },
        {
            "sha": "980944756179cfa9dead80c7db62f854a736099b",
            "filename": "packages/compiler/src/render3/r3_identifiers.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fr3_identifiers.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fr3_identifiers.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fr3_identifiers.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -16,6 +16,8 @@ export class Identifiers {\n   static TRANSFORM_METHOD = 'transform';\n   static PATCH_DEPS = 'patchedDeps';\n \n+  static core: o.ExternalReference = {name: null, moduleName: CORE};\n+\n   /* Instructions */\n   static namespaceHTML: o.ExternalReference = {name: 'ɵɵnamespaceHTML', moduleName: CORE};\n \n@@ -245,10 +247,8 @@ export class Identifiers {\n     moduleName: CORE,\n   };\n \n-  static defineDirective: o.ExternalReference = {\n-    name: 'ɵɵdefineDirective',\n-    moduleName: CORE,\n-  };\n+  static defineDirective: o.ExternalReference = {name: 'ɵɵdefineDirective', moduleName: CORE};\n+  static declareDirective: o.ExternalReference = {name: '$ngDeclareDirective', moduleName: CORE};\n \n   static DirectiveDefWithMeta: o.ExternalReference = {\n     name: 'ɵɵDirectiveDefWithMeta',"
        },
        {
            "sha": "8e92fe39a94c276b2273a3ce2adf622943c4a1f5",
            "filename": "packages/compiler/src/render3/view/api.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fapi.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fapi.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fapi.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -86,12 +86,14 @@ export interface R3DirectiveMetadata {\n   };\n \n   /**\n-   * A mapping of input field names to the property names.\n+   * A mapping of inputs from class property names to binding property names, or to a tuple of\n+   * binding property name and class property name if the names are different.\n    */\n   inputs: {[field: string]: string|[string, string]};\n \n   /**\n-   * A mapping of output field names to the property names.\n+   * A mapping of outputs from class property names to binding property names, or to a tuple of\n+   * binding property name and class property name if the names are different.\n    */\n   outputs: {[field: string]: string};\n "
        },
        {
            "sha": "cc72464a9d3776298822e4b15e7d61988a0cd228",
            "filename": "packages/compiler/src/render3/view/compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fcompiler.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -492,7 +492,7 @@ function stringArrayAsType(arr: ReadonlyArray<string|null>): o.Type {\n                           o.NONE_TYPE;\n }\n \n-function createDirectiveTypeParams(meta: R3DirectiveMetadata): o.Type[] {\n+export function createDirectiveTypeParams(meta: R3DirectiveMetadata): o.Type[] {\n   // On the type side, remove newlines from the selector as it will need to fit into a TypeScript\n   // string literal, which must be on one line.\n   const selectorForType = meta.selector !== null ? meta.selector.replace(/\\n/g, '') : null;"
        },
        {
            "sha": "f06189347494984b86866ad08163acb48eb7dd63",
            "filename": "packages/core/src/core_render3_private_export.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcore%2Fsrc%2Fcore_render3_private_export.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcore%2Fsrc%2Fcore_render3_private_export.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Fcore_render3_private_export.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -77,6 +77,8 @@ export {\n   NG_PIPE_DEF as ɵNG_PIPE_DEF,\n } from './render3/fields';\n export {\n+\n+  $ngDeclareDirective,\n   AttributeMarker as ɵAttributeMarker,\n   ComponentDef as ɵComponentDef,\n   ComponentFactory as ɵRender3ComponentFactory,"
        },
        {
            "sha": "cfdf8187d92b29f8f86a073348b526dd243c3235",
            "filename": "packages/core/src/render3/index.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcore%2Fsrc%2Frender3%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcore%2Fsrc%2Frender3%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Findex.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -133,6 +133,9 @@ export {\n   AttributeMarker\n } from './interfaces/node';\n export {CssSelectorList, ProjectionSlots} from './interfaces/projection';\n+export {\n+  $ngDeclareDirective,\n+} from './jit/partial';\n export {\n   setClassMetadata,\n } from './metadata';"
        },
        {
            "sha": "ce4bb0179f73847f9a24f6d965099e9c5f415991",
            "filename": "packages/core/src/render3/jit/environment.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcore%2Fsrc%2Frender3%2Fjit%2Fenvironment.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcore%2Fsrc%2Frender3%2Fjit%2Fenvironment.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fjit%2Fenvironment.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -10,6 +10,7 @@ import {ɵɵinject, ɵɵinvalidFactoryDep} from '../../di/injector_compatibility\n import {ɵɵdefineInjectable, ɵɵdefineInjector} from '../../di/interface/defs';\n import * as sanitization from '../../sanitization/sanitization';\n import * as r3 from '../index';\n+import * as partial from './partial';\n \n \n \n@@ -169,4 +170,6 @@ export const angularCoreEnv: {[name: string]: Function} =\n        'ɵɵtrustConstantHtml': sanitization.ɵɵtrustConstantHtml,\n        'ɵɵtrustConstantScript': sanitization.ɵɵtrustConstantScript,\n        'ɵɵtrustConstantResourceUrl': sanitization.ɵɵtrustConstantResourceUrl,\n+\n+       '$ngDeclareDirective': partial.$ngDeclareDirective,\n      }))();"
        },
        {
            "sha": "9ba050fba6ab51a284ecffae9eb38f4a5c8cbd80",
            "filename": "packages/core/src/render3/jit/partial.ts",
            "status": "added",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcore%2Fsrc%2Frender3%2Fjit%2Fpartial.ts",
            "raw_url": "https://github.com/angular/angular/raw/8c0a92bb4559cdf04a9bcd631255567ffb91e73e/packages%2Fcore%2Fsrc%2Frender3%2Fjit%2Fpartial.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fjit%2Fpartial.ts?ref=8c0a92bb4559cdf04a9bcd631255567ffb91e73e",
            "patch": "@@ -0,0 +1,16 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+/**\n+ * Compiles a partial directive declaration object into a full directive definition object.\n+ *\n+ * @codeGenApi\n+ */\n+export function $ngDeclareDirective(decl: unknown): unknown {\n+  throw new Error('Not yet implemented');\n+}"
        }
    ],
    "stats": {
        "total": 378,
        "additions": 363,
        "deletions": 15
    }
}