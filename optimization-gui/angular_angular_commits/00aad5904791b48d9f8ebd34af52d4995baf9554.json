{
    "author": "danieltre23",
    "message": "test(language-service): add test for extended diagnostics (#43134)\n\nAdd a test to make sure extended template diagnostics are being correctly\ngenerated in the language service for non-ts files.\n\nRefs #42966\n\nPR Close #43134",
    "sha": "00aad5904791b48d9f8ebd34af52d4995baf9554",
    "files": [
        {
            "sha": "4bffd146778c98267ef3831f265667015ccb9ad9",
            "filename": "packages/language-service/ivy/test/diagnostic_spec.ts",
            "status": "modified",
            "additions": 45,
            "deletions": 1,
            "changes": 46,
            "blob_url": "https://github.com/angular/angular/blob/00aad5904791b48d9f8ebd34af52d4995baf9554/packages%2Flanguage-service%2Fivy%2Ftest%2Fdiagnostic_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/00aad5904791b48d9f8ebd34af52d4995baf9554/packages%2Flanguage-service%2Fivy%2Ftest%2Fdiagnostic_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Fdiagnostic_spec.ts?ref=00aad5904791b48d9f8ebd34af52d4995baf9554",
            "patch": "@@ -384,7 +384,7 @@ describe('getSemanticDiagnostics', () => {\n     expect(diags[0].category).toEqual(ts.DiagnosticCategory.Warning);\n   });\n \n-  it('should not produce invalid banana in box warning', () => {\n+  it('should not produce invalid banana in box warning without the required flags', () => {\n     const files = {\n       'app.ts': `\n         import {Component} from '@angular/core';\n@@ -402,6 +402,50 @@ describe('getSemanticDiagnostics', () => {\n     const diags = project.getDiagnosticsForFile('app.ts');\n     expect(diags.length).toEqual(0);\n   });\n+\n+  it('should produce invalid banana in box warning in external html file', () => {\n+    const files = {\n+      'app.ts': `\n+        import {Component} from '@angular/core';\n+        @Component({\n+          selector: 'test',\n+          templateUrl: './app.html',\n+        })\n+        export class TestCmp { \n+          bar: string = \"text\"; \n+        }\n+    `,\n+      'app.html': `<div ([foo])=\"bar\"></div>`\n+    };\n+    const project = createModuleAndProjectWithDeclarations(\n+        env, 'test', files, {strictTemplates: true, _extendedTemplateDiagnostics: true});\n+\n+    const diags = project.getDiagnosticsForFile('app.html');\n+    expect(diags.length).toEqual(1);\n+    expect(diags[0].code).toEqual(ngErrorCode(ErrorCode.INVALID_BANANA_IN_BOX));\n+    expect(diags[0].category).toEqual(ts.DiagnosticCategory.Warning);\n+  });\n+\n+  it('should not produce invalid banana in box warning in external html file without the required flags',\n+     () => {\n+       const files = {\n+         'app.ts': `\n+        import {Component} from '@angular/core';\n+        @Component({\n+          selector: 'test',\n+          templateUrl: './app.html',\n+        })\n+        export class TestCmp { \n+          bar: string = \"text\"; \n+        }\n+    `,\n+         'app.html': `<div ([foo])=\"bar\"></div>`\n+       };\n+       const project = createModuleAndProjectWithDeclarations(env, 'test', files);\n+\n+       const diags = project.getDiagnosticsForFile('app.html');\n+       expect(diags.length).toEqual(0);\n+     });\n });\n \n function getTextOfDiagnostic(diag: ts.Diagnostic): string {"
        }
    ],
    "stats": {
        "total": 46,
        "additions": 45,
        "deletions": 1
    }
}