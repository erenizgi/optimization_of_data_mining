{
    "author": "devversion",
    "message": "ci: do not capture nested bazel integration test workspace within Bazel (#44061)\n\nThe `integration/bazel` folder cannot be excluded within the\n`.bazelignore` file. This is necessary so that the integration test\nrule can glob for all files within the integration test.\n\nThe downside is that the `integration/bazel/<..>` folder is being\ndiscovered by the `//...` target query, causing Starlark files to\nbe interpreted/validated. e.g.\n\nhttps://app.circleci.com/pipelines/github/angular/angular/39255/workflows/c6c448ed-9a44-49b3-a0c2-2c7328ce2855/jobs/1079169\n\nPreviously such errors did not appear because no Starlark `.bzl` files\nwithin the test imported other files using the `//` absolute resolution.\n\nExplicitly excluding the nested packages using the `--deleted_packages`\noption is the most idiomatic way of achieving this currently (similarly\ndone by `rules_nodejs`). More information on why this is so verbose\ncurrently:\n\nhttps://github.com/bazelbuild/bazel/issues/12034\n\nPR Close #44061",
    "sha": "bac03a95d76849e4950771f2f95560cebd98d804",
    "files": [
        {
            "sha": "ca2d73f8e1d9a2d04ff2429c4e8eac0ddc0589ed",
            "filename": ".bazelrc",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/bac03a95d76849e4950771f2f95560cebd98d804/.bazelrc",
            "raw_url": "https://github.com/angular/angular/raw/bac03a95d76849e4950771f2f95560cebd98d804/.bazelrc",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/.bazelrc?ref=bac03a95d76849e4950771f2f95560cebd98d804",
            "patch": "@@ -142,6 +142,16 @@ test:saucelabs --flaky_test_attempts=1\n # --ng_perf will ask the Ivy compiler to produce performance results for each build.\n build --flag_alias=ng_perf=//packages/compiler-cli:ng_perf\n \n+#####################################################################\n+# Folders to ignore for integration tests (nested Bazel workspaces) #\n+#####################################################################\n+\n+# The nested Bazel integration test workspace should not be analysed as part of\n+# Skyframe, but should also not be ignored in order to be able to glob for its files.\n+# TODO: Simplify this once https://github.com/bazelbuild/bazel/issues/12034 is fixed\n+build --deleted_packages=integration/bazel,integration/bazel/src,integration/bazel/src/hello-world,integration/bazel/test,integration/bazel/test/e2e,integration/bazel/tools,integration/bazel/tools/angular\n+query --deleted_packages=integration/bazel,integration/bazel/src,integration/bazel/src/hello-world,integration/bazel/test,integration/bazel/test/e2e,integration/bazel/tools,integration/bazel/tools/angular\n+\n ####################################################\n # User bazel configuration\n # NOTE: This needs to be the *last* entry in the config."
        },
        {
            "sha": "4d533cf272c9f17558482adf9a045a8dee5e47f1",
            "filename": ".circleci/config.yml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/bac03a95d76849e4950771f2f95560cebd98d804/.circleci%2Fconfig.yml",
            "raw_url": "https://github.com/angular/angular/raw/bac03a95d76849e4950771f2f95560cebd98d804/.circleci%2Fconfig.yml",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/.circleci%2Fconfig.yml?ref=bac03a95d76849e4950771f2f95560cebd98d804",
            "patch": "@@ -306,7 +306,7 @@ jobs:\n           # We need to explicitly specify the --symlink_prefix option because otherwise we would\n           # not be able to easily find the output bin directory when uploading artifacts for size\n           # measurements.\n-          command: yarn test  --symlink_prefix=dist/ //...\n+          command: yarn test --symlink_prefix=dist/ -- //...\n           no_output_timeout: 20m\n         # Publish bundle artifacts which will be used to calculate the size change. **Note**: Make\n         # sure that the size plugin from the Angular robot fetches the artifacts from this CircleCI"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 11,
        "deletions": 1
    }
}