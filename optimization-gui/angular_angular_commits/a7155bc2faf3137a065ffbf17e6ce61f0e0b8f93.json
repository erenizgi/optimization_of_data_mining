{
    "author": "alxhub",
    "message": "test(language-service): move existing tests to legacy directory (#39594)\n\nIn preparation for in-memory testing infrastructure, the existing Ivy\nlanguage service tests are moved to a `legacy` directory. These existing\ntests rely on a single integration project in `test/project/app`, which\npresents a number of challenges:\n\n * adding extra fields/properties to the integration project for one test\n   can cause others to fail/flake.\n * it's especially difficult to test any cases that require introducing\n   intentional errors, as those tend to break other tests.\n * tests load files from disk, which is slower.\n * tests rely on the real built versions of @angular/core and\n   @angular/common, which makes them both slow to build and require rebuilds\n   on every compiler change.\n * tests share a single tsconfig.json, making it extremely difficult to test\n   how the language service handles different configuration scenarios (e.g.\n   different type-checking flags).\n\nPR Close #39594",
    "sha": "a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
    "files": [
        {
            "sha": "776992f3f00d7b33f440317f59d810f63f0258e3",
            "filename": "packages/language-service/ivy/test/legacy/BUILD.bazel",
            "status": "renamed",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2FBUILD.bazel?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "patch": "@@ -1,7 +1,7 @@\n load(\"//tools:defaults.bzl\", \"jasmine_node_test\", \"ts_library\")\n \n ts_library(\n-    name = \"test_lib\",\n+    name = \"legacy_lib\",\n     testonly = True,\n     srcs = glob([\"*.ts\"]),\n     deps = [\n@@ -12,7 +12,7 @@ ts_library(\n )\n \n jasmine_node_test(\n-    name = \"test\",\n+    name = \"legacy\",\n     data = [\n         # Note that we used to depend on the npm_package of common, core, and\n         # forms, but this is no longer the case. We did it for View Engine\n@@ -28,6 +28,6 @@ jasmine_node_test(\n         \"ivy-only\",\n     ],\n     deps = [\n-        \":test_lib\",\n+        \":legacy_lib\",\n     ],\n )",
            "previous_filename": "packages/language-service/ivy/test/BUILD.bazel"
        },
        {
            "sha": "b04296591e739dbae2a665154afa2f670a01e9b9",
            "filename": "packages/language-service/ivy/test/legacy/compiler_factory_spec.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fcompiler_factory_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fcompiler_factory_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fcompiler_factory_spec.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "previous_filename": "packages/language-service/ivy/test/compiler_factory_spec.ts"
        },
        {
            "sha": "58bfa993dfa5ef4feae438cf2af42af6cc3f4dcc",
            "filename": "packages/language-service/ivy/test/legacy/definitions_spec.ts",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fdefinitions_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fdefinitions_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fdefinitions_spec.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {LanguageService} from '../language_service';\n+import {LanguageService} from '../../language_service';\n \n import {APP_COMPONENT, MockService, setup} from './mock_host';\n import {humanizeDefinitionInfo} from './test_utils';",
            "previous_filename": "packages/language-service/ivy/test/definitions_spec.ts"
        },
        {
            "sha": "1d8f6c4ef31308568e89c1ca72f28e5caebd88c6",
            "filename": "packages/language-service/ivy/test/legacy/diagnostic_spec.ts",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fdiagnostic_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fdiagnostic_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fdiagnostic_spec.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "patch": "@@ -8,7 +8,7 @@\n \n import * as ts from 'typescript/lib/tsserverlibrary';\n \n-import {LanguageService} from '../language_service';\n+import {LanguageService} from '../../language_service';\n \n import {APP_COMPONENT, MockService, setup, TEST_TEMPLATE} from './mock_host';\n ",
            "previous_filename": "packages/language-service/ivy/test/diagnostic_spec.ts"
        },
        {
            "sha": "32d9f4e8be729ae5c695258ac7938725a2bb0d9b",
            "filename": "packages/language-service/ivy/test/legacy/language_service_adapter_spec.ts",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Flanguage_service_adapter_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Flanguage_service_adapter_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Flanguage_service_adapter_spec.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "patch": "@@ -8,7 +8,7 @@\n \n import * as ts from 'typescript/lib/tsserverlibrary';\n \n-import {LanguageServiceAdapter} from '../language_service_adapter';\n+import {LanguageServiceAdapter} from '../../language_service_adapter';\n \n import {MockService, setup, TEST_TEMPLATE} from './mock_host';\n ",
            "previous_filename": "packages/language-service/ivy/test/language_service_adapter_spec.ts"
        },
        {
            "sha": "1831138563a6618e841ee8e8231a5870274afac1",
            "filename": "packages/language-service/ivy/test/legacy/language_service_spec.ts",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Flanguage_service_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Flanguage_service_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Flanguage_service_spec.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "patch": "@@ -8,7 +8,7 @@\n \n import * as ts from 'typescript/lib/tsserverlibrary';\n \n-import {LanguageService, parseNgCompilerOptions} from '../language_service';\n+import {LanguageService, parseNgCompilerOptions} from '../../language_service';\n \n import {MockService, setup, TEST_TEMPLATE} from './mock_host';\n ",
            "previous_filename": "packages/language-service/ivy/test/language_service_spec.ts"
        },
        {
            "sha": "bf86c266ac84c38ebf3e3aa11cc39be60226ac79",
            "filename": "packages/language-service/ivy/test/legacy/mock_host.ts",
            "status": "renamed",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fmock_host.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fmock_host.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fmock_host.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "patch": "@@ -9,7 +9,7 @@\n import {join} from 'path';\n import * as ts from 'typescript/lib/tsserverlibrary';\n \n-import {isTypeScriptFile} from '../utils';\n+import {isTypeScriptFile} from '../../utils';\n \n const logger: ts.server.Logger = {\n   close(): void{},\n@@ -147,7 +147,7 @@ export class MockService {\n     return this.overwriteScriptInfo(scriptInfo, text);\n   }\n \n-  reset() {\n+  reset(): void {\n     if (this.overwritten.size === 0) {\n       return;\n     }",
            "previous_filename": "packages/language-service/ivy/test/mock_host.ts"
        },
        {
            "sha": "967cad67728b93988b5dcfe3464d08addffb0651",
            "filename": "packages/language-service/ivy/test/legacy/mock_host_spec.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fmock_host_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fmock_host_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fmock_host_spec.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "previous_filename": "packages/language-service/ivy/test/mock_host_spec.ts"
        },
        {
            "sha": "8516c8a069d9f551cb15e5297d82ce5992774219",
            "filename": "packages/language-service/ivy/test/legacy/quick_info_spec.ts",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fquick_info_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fquick_info_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Fquick_info_spec.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "patch": "@@ -8,7 +8,7 @@\n \n import * as ts from 'typescript/lib/tsserverlibrary';\n \n-import {LanguageService} from '../language_service';\n+import {LanguageService} from '../../language_service';\n \n import {APP_COMPONENT, MockService, setup, TEST_TEMPLATE} from './mock_host';\n ",
            "previous_filename": "packages/language-service/ivy/test/quick_info_spec.ts"
        },
        {
            "sha": "adbfb5f6d2add9bd564d5808c3d905f7ebaebc98",
            "filename": "packages/language-service/ivy/test/legacy/template_target_spec.ts",
            "status": "renamed",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Ftemplate_target_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Ftemplate_target_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Ftemplate_target_spec.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "patch": "@@ -10,8 +10,8 @@ import {ParseError, parseTemplate} from '@angular/compiler';\n import * as e from '@angular/compiler/src/expression_parser/ast';  // e for expression AST\n import * as t from '@angular/compiler/src/render3/r3_ast';         // t for template AST\n \n-import {getTargetAtPosition} from '../template_target';\n-import {isExpressionNode, isTemplateNode} from '../utils';\n+import {getTargetAtPosition} from '../../template_target';\n+import {isExpressionNode, isTemplateNode} from '../../utils';\n \n interface ParseResult {\n   nodes: t.Node[];",
            "previous_filename": "packages/language-service/ivy/test/template_target_spec.ts"
        },
        {
            "sha": "e4b62f8c611f0fa27ead63a1702f1fadf63ad918",
            "filename": "packages/language-service/ivy/test/legacy/test_utils.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Ftest_utils.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Ftest_utils.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Ftest_utils.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "previous_filename": "packages/language-service/ivy/test/test_utils.ts"
        },
        {
            "sha": "11214608737606d4bfd2458bbc0678ce66aa3342",
            "filename": "packages/language-service/ivy/test/legacy/type_definitions_spec.ts",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Ftype_definitions_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Ftype_definitions_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Flegacy%2Ftype_definitions_spec.ts?ref=a7155bc2faf3137a065ffbf17e6ce61f0e0b8f93",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {LanguageService} from '../language_service';\n+import {LanguageService} from '../../language_service';\n \n import {APP_COMPONENT, MockService, setup} from './mock_host';\n import {HumanizedDefinitionInfo, humanizeDefinitionInfo} from './test_utils';",
            "previous_filename": "packages/language-service/ivy/test/type_definitions_spec.ts"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 13,
        "deletions": 13
    }
}