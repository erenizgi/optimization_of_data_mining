{
    "author": "IgorMinar",
    "message": "fix(core): ensure that autoRegisterModuleById registration in ɵɵdefineNgModule is not DCE-ed by closure (#42529)\n\nPreviously the autoRegisterModuleById registration was marked with noSideEffects wrapper to ensure that we don't end up retaining all NgModules.\n\nHowever the return value was not referenced by anything, so closure compiler removed it because it determined that this code has no side effects and is not referenced by anyone.\n\nThis issue affects apps that use Closure Compiler and also rely on https://angular.io/api/core/getModuleFactory to retrieve factories by ID. This combination is used heavily in google3, especially in Pantheon.\n\nFixes b/188453434\n\nPR Close #42529",
    "sha": "3961b3c3606bb835e539c66d5ac8d91d2a9b0f80",
    "files": [
        {
            "sha": "626c0dd6bba639dfa6102a84640e0f70b5c0608f",
            "filename": "packages/core/src/render3/definition.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 15,
            "changes": 30,
            "blob_url": "https://github.com/angular/angular/blob/3961b3c3606bb835e539c66d5ac8d91d2a9b0f80/packages%2Fcore%2Fsrc%2Frender3%2Fdefinition.ts",
            "raw_url": "https://github.com/angular/angular/raw/3961b3c3606bb835e539c66d5ac8d91d2a9b0f80/packages%2Fcore%2Fsrc%2Frender3%2Fdefinition.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fdefinition.ts?ref=3961b3c3606bb835e539c66d5ac8d91d2a9b0f80",
            "patch": "@@ -410,22 +410,22 @@ export function ɵɵdefineNgModule<T>(def: {\n   /** Unique ID for the module that is used with `getModuleFactory`. */\n   id?: string | null;\n }): unknown {\n-  const res: NgModuleDef<T> = {\n-    type: def.type,\n-    bootstrap: def.bootstrap || EMPTY_ARRAY,\n-    declarations: def.declarations || EMPTY_ARRAY,\n-    imports: def.imports || EMPTY_ARRAY,\n-    exports: def.exports || EMPTY_ARRAY,\n-    transitiveCompileScopes: null,\n-    schemas: def.schemas || null,\n-    id: def.id || null,\n-  };\n-  if (def.id != null) {\n-    noSideEffects(() => {\n+  return noSideEffects(() => {\n+    const res: NgModuleDef<T> = {\n+      type: def.type,\n+      bootstrap: def.bootstrap || EMPTY_ARRAY,\n+      declarations: def.declarations || EMPTY_ARRAY,\n+      imports: def.imports || EMPTY_ARRAY,\n+      exports: def.exports || EMPTY_ARRAY,\n+      transitiveCompileScopes: null,\n+      schemas: def.schemas || null,\n+      id: def.id || null,\n+    };\n+    if (def.id != null) {\n       autoRegisterModuleById[def.id!] = def.type as unknown as NgModuleType;\n-    });\n-  }\n-  return res;\n+    }\n+    return res;\n+  });\n }\n \n /**"
        }
    ],
    "stats": {
        "total": 30,
        "additions": 15,
        "deletions": 15
    }
}