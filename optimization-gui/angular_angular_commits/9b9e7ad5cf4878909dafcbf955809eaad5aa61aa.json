{
    "author": "JoostK",
    "message": "test(compiler-cli): disable `emitDecoratorMetadata` in the compiler test environment (#41557)\n\nThe `emitDecoratorMetadata` compiler option does not have to be enabled\nas Angular decorators are transformed by the AOT compiler. Having the\noption enabled in our tests can hide issues around import preservation,\nas with `emitDecoratorMetadata` enabled the TypeScript compiler itself\ndoes not elide imports even if they are only used in type-positions.\nThis is unlike having `emitDecoratorMetadata` disabled, however; in that\ncase the Angular compiler has to actively trick TypeScript into\nretaining default imports when an identifier in a type-only position has\nbeen reified into a value position for DI purposes.\n\nA subsequent commit addresses a bug in default import preservation\nthat relies on this flag being `false`.\n\nPR Close #41557",
    "sha": "9b9e7ad5cf4878909dafcbf955809eaad5aa61aa",
    "files": [
        {
            "sha": "b456573d72e7eea4a73a439fd715078ae847f389",
            "filename": "packages/compiler-cli/test/ngtsc/env.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9b9e7ad5cf4878909dafcbf955809eaad5aa61aa/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Fenv.ts",
            "raw_url": "https://github.com/angular/angular/raw/9b9e7ad5cf4878909dafcbf955809eaad5aa61aa/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Fenv.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Fenv.ts?ref=9b9e7ad5cf4878909dafcbf955809eaad5aa61aa",
            "patch": "@@ -53,7 +53,7 @@ export class NgtscTestEnvironment {\n \n     env.write(absoluteFrom('/tsconfig-base.json'), `{\n       \"compilerOptions\": {\n-        \"emitDecoratorMetadata\": true,\n+        \"emitDecoratorMetadata\": false,\n         \"experimentalDecorators\": true,\n         \"skipLibCheck\": true,\n         \"noImplicitAny\": true,"
        },
        {
            "sha": "f98377ea0f8e6fc6aefd435cedd6ea2b45cdec43",
            "filename": "packages/compiler-cli/test/ngtsc/ngtsc_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9b9e7ad5cf4878909dafcbf955809eaad5aa61aa/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Fngtsc_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/9b9e7ad5cf4878909dafcbf955809eaad5aa61aa/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Fngtsc_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Fngtsc_spec.ts?ref=9b9e7ad5cf4878909dafcbf955809eaad5aa61aa",
            "patch": "@@ -4648,7 +4648,7 @@ function allTests(os: string) {\n \n       env.driveMain();\n       const jsContents = trim(env.getContents('test.js'));\n-      expect(jsContents).toContain(`import { KeyCodes } from './keycodes';`);\n+      expect(jsContents).toContain(`import * as i1 from \"./keycodes\";`);\n       expect(jsContents).toMatch(setClassMetadataRegExp('type: i1.KeyCodes'));\n     });\n "
        }
    ],
    "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    }
}