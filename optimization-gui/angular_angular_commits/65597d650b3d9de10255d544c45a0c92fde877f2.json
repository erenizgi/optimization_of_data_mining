{
    "author": "AndrewKushnir",
    "message": "refactor(forms): inherit `ngOnChanges` hooks from the base class (#43945)\n\nThis commit updates the code of the min/max and minlength/maxlength validator directives to inherit `ngOnChanges` hooks from the base class (the `AbstractValidatorDirective` one), rather than implementing the hooks on the child classes. This was needed to avoid issues with hooks inheritance in ViewEngine, but since it's deprecated, the code can be cleaned up.\n\nPR Close #43945",
    "sha": "65597d650b3d9de10255d544c45a0c92fde877f2",
    "files": [
        {
            "sha": "aaf60bff532318adce93cd4c43110e00b81710cb",
            "filename": "goldens/public-api/forms/forms.md",
            "status": "modified",
            "additions": 4,
            "deletions": 10,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/65597d650b3d9de10255d544c45a0c92fde877f2/goldens%2Fpublic-api%2Fforms%2Fforms.md",
            "raw_url": "https://github.com/angular/angular/raw/65597d650b3d9de10255d544c45a0c92fde877f2/goldens%2Fpublic-api%2Fforms%2Fforms.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fforms%2Fforms.md?ref=65597d650b3d9de10255d544c45a0c92fde877f2",
            "patch": "@@ -454,41 +454,35 @@ export class FormsModule {\n }\n \n // @public\n-export class MaxLengthValidator extends AbstractValidatorDirective implements OnChanges {\n+export class MaxLengthValidator extends AbstractValidatorDirective {\n     maxlength: string | number | null;\n     // (undocumented)\n-    ngOnChanges(changes: SimpleChanges): void;\n-    // (undocumented)\n     static ɵdir: i0.ɵɵDirectiveDeclaration<MaxLengthValidator, \"[maxlength][formControlName],[maxlength][formControl],[maxlength][ngModel]\", never, { \"maxlength\": \"maxlength\"; }, {}, never>;\n     // (undocumented)\n     static ɵfac: i0.ɵɵFactoryDeclaration<MaxLengthValidator, never>;\n }\n \n // @public\n-export class MaxValidator extends AbstractValidatorDirective implements OnChanges {\n+export class MaxValidator extends AbstractValidatorDirective {\n     max: string | number | null;\n-    ngOnChanges(changes: SimpleChanges): void;\n     // (undocumented)\n     static ɵdir: i0.ɵɵDirectiveDeclaration<MaxValidator, \"input[type=number][max][formControlName],input[type=number][max][formControl],input[type=number][max][ngModel]\", never, { \"max\": \"max\"; }, {}, never>;\n     // (undocumented)\n     static ɵfac: i0.ɵɵFactoryDeclaration<MaxValidator, never>;\n }\n \n // @public\n-export class MinLengthValidator extends AbstractValidatorDirective implements OnChanges {\n+export class MinLengthValidator extends AbstractValidatorDirective {\n     minlength: string | number | null;\n     // (undocumented)\n-    ngOnChanges(changes: SimpleChanges): void;\n-    // (undocumented)\n     static ɵdir: i0.ɵɵDirectiveDeclaration<MinLengthValidator, \"[minlength][formControlName],[minlength][formControl],[minlength][ngModel]\", never, { \"minlength\": \"minlength\"; }, {}, never>;\n     // (undocumented)\n     static ɵfac: i0.ɵɵFactoryDeclaration<MinLengthValidator, never>;\n }\n \n // @public\n-export class MinValidator extends AbstractValidatorDirective implements OnChanges {\n+export class MinValidator extends AbstractValidatorDirective {\n     min: string | number | null;\n-    ngOnChanges(changes: SimpleChanges): void;\n     // (undocumented)\n     static ɵdir: i0.ɵɵDirectiveDeclaration<MinValidator, \"input[type=number][min][formControlName],input[type=number][min][formControl],input[type=number][min][ngModel]\", never, { \"min\": \"min\"; }, {}, never>;\n     // (undocumented)"
        },
        {
            "sha": "a25ecb001eb71fd79224dddfbca253ff3e6976ea",
            "filename": "packages/forms/src/directives/validators.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 38,
            "changes": 47,
            "blob_url": "https://github.com/angular/angular/blob/65597d650b3d9de10255d544c45a0c92fde877f2/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "raw_url": "https://github.com/angular/angular/raw/65597d650b3d9de10255d544c45a0c92fde877f2/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts?ref=65597d650b3d9de10255d544c45a0c92fde877f2",
            "patch": "@@ -94,7 +94,7 @@ export interface Validator {\n  * For internal use only, this class is not intended for use outside of the Forms package.\n  */\n @Directive()\n-abstract class AbstractValidatorDirective implements Validator {\n+abstract class AbstractValidatorDirective implements Validator, OnChanges {\n   private _validator: ValidatorFn = nullValidator;\n   private _onChange!: () => void;\n \n@@ -125,11 +125,8 @@ abstract class AbstractValidatorDirective implements Validator {\n    */\n   abstract normalizeInput(input: unknown): unknown;\n \n-  /**\n-   * Helper function invoked from child classes to process changes (from `ngOnChanges` hook).\n-   * @nodoc\n-   */\n-  handleChanges(changes: SimpleChanges): void {\n+  /** @nodoc */\n+  ngOnChanges(changes: SimpleChanges): void {\n     if (this.inputName in changes) {\n       const input = this.normalizeInput(changes[this.inputName].currentValue);\n       this._validator = this.enabled() ? this.createValidator(input) : nullValidator;\n@@ -199,7 +196,7 @@ export const MAX_VALIDATOR: StaticProvider = {\n   providers: [MAX_VALIDATOR],\n   host: {'[attr.max]': 'enabled() ? max : null'}\n })\n-export class MaxValidator extends AbstractValidatorDirective implements OnChanges {\n+export class MaxValidator extends AbstractValidatorDirective {\n   /**\n    * @description\n    * Tracks changes to the max bound to this directive.\n@@ -211,15 +208,6 @@ export class MaxValidator extends AbstractValidatorDirective implements OnChange\n   override normalizeInput = (input: string|number): number => toFloat(input);\n   /** @internal */\n   override createValidator = (max: number): ValidatorFn => maxValidator(max);\n-  /**\n-   * Declare `ngOnChanges` lifecycle hook at the main directive level (vs keeping it in base class)\n-   * to avoid differences in handling inheritance of lifecycle hooks between Ivy and ViewEngine in\n-   * AOT mode. This could be refactored once ViewEngine is removed.\n-   * @nodoc\n-   */\n-  ngOnChanges(changes: SimpleChanges): void {\n-    this.handleChanges(changes);\n-  }\n }\n \n /**\n@@ -259,7 +247,7 @@ export const MIN_VALIDATOR: StaticProvider = {\n   providers: [MIN_VALIDATOR],\n   host: {'[attr.min]': 'enabled() ? min : null'}\n })\n-export class MinValidator extends AbstractValidatorDirective implements OnChanges {\n+export class MinValidator extends AbstractValidatorDirective {\n   /**\n    * @description\n    * Tracks changes to the min bound to this directive.\n@@ -271,15 +259,6 @@ export class MinValidator extends AbstractValidatorDirective implements OnChange\n   override normalizeInput = (input: string|number): number => toFloat(input);\n   /** @internal */\n   override createValidator = (min: number): ValidatorFn => minValidator(min);\n-  /**\n-   * Declare `ngOnChanges` lifecycle hook at the main directive level (vs keeping it in base class)\n-   * to avoid differences in handling inheritance of lifecycle hooks between Ivy and ViewEngine in\n-   * AOT mode. This could be refactored once ViewEngine is removed.\n-   * @nodoc\n-   */\n-  ngOnChanges(changes: SimpleChanges): void {\n-    this.handleChanges(changes);\n-  }\n }\n \n /**\n@@ -572,12 +551,13 @@ export const MIN_LENGTH_VALIDATOR: any = {\n   providers: [MIN_LENGTH_VALIDATOR],\n   host: {'[attr.minlength]': 'enabled() ? minlength : null'}\n })\n-export class MinLengthValidator extends AbstractValidatorDirective implements OnChanges {\n+export class MinLengthValidator extends AbstractValidatorDirective {\n   /**\n    * @description\n    * Tracks changes to the minimum length bound to this directive.\n    */\n   @Input() minlength!: string|number|null;\n+\n   /** @internal */\n   override inputName = 'minlength';\n \n@@ -586,11 +566,6 @@ export class MinLengthValidator extends AbstractValidatorDirective implements On\n \n   /** @internal */\n   override createValidator = (minlength: number): ValidatorFn => minLengthValidator(minlength);\n-\n-  /** @nodoc */\n-  ngOnChanges(changes: SimpleChanges): void {\n-    this.handleChanges(changes);\n-  }\n }\n \n /**\n@@ -629,12 +604,13 @@ export const MAX_LENGTH_VALIDATOR: any = {\n   providers: [MAX_LENGTH_VALIDATOR],\n   host: {'[attr.maxlength]': 'enabled() ? maxlength : null'}\n })\n-export class MaxLengthValidator extends AbstractValidatorDirective implements OnChanges {\n+export class MaxLengthValidator extends AbstractValidatorDirective {\n   /**\n    * @description\n    * Tracks changes to the minimum length bound to this directive.\n    */\n   @Input() maxlength!: string|number|null;\n+\n   /** @internal */\n   override inputName = 'maxlength';\n \n@@ -643,11 +619,6 @@ export class MaxLengthValidator extends AbstractValidatorDirective implements On\n \n   /** @internal */\n   override createValidator = (maxlength: number): ValidatorFn => maxLengthValidator(maxlength);\n-\n-  /** @nodoc */\n-  ngOnChanges(changes: SimpleChanges): void {\n-    this.handleChanges(changes);\n-  }\n }\n \n /**"
        }
    ],
    "stats": {
        "total": 61,
        "additions": 13,
        "deletions": 48
    }
}