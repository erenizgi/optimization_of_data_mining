{
    "author": "thePunderWoman",
    "message": "refactor(animations): Remove unnecessary IE specific code (#44686)\n\nThere were a few places we were still checking for Internet Explorer. This removes the references throughout the animations package.\n\nPR Close #44686",
    "sha": "290df4f806472cb3c3fe1d7cbd132990bf3b15ab",
    "files": [
        {
            "sha": "07301070cceaaa101ff71cdf06695fb09e65b915",
            "filename": "packages/animations/browser/src/render/shared.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 18,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fanimations%2Fbrowser%2Fsrc%2Frender%2Fshared.ts",
            "raw_url": "https://github.com/angular/angular/raw/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fanimations%2Fbrowser%2Fsrc%2Frender%2Fshared.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fanimations%2Fbrowser%2Fsrc%2Frender%2Fshared.ts?ref=290df4f806472cb3c3fe1d7cbd132990bf3b15ab",
            "patch": "@@ -173,26 +173,11 @@ if (_isNode || typeof Element !== 'undefined') {\n   }\n \n   _query = (element: any, selector: string, multi: boolean): any[] => {\n-    let results: any[] = [];\n     if (multi) {\n-      // DO NOT REFACTOR TO USE SPREAD SYNTAX.\n-      // For element queries that return sufficiently large NodeList objects,\n-      // using spread syntax to populate the results array causes a RangeError\n-      // due to the call stack limit being reached. `Array.from` can not be used\n-      // as well, since NodeList is not iterable in IE 11, see\n-      // https://developer.mozilla.org/en-US/docs/Web/API/NodeList\n-      // More info is available in #38551.\n-      const elems = element.querySelectorAll(selector);\n-      for (let i = 0; i < elems.length; i++) {\n-        results.push(elems[i]);\n-      }\n-    } else {\n-      const elm = element.querySelector(selector);\n-      if (elm) {\n-        results.push(elm);\n-      }\n+      return Array.from(element.querySelectorAll(selector));\n     }\n-    return results;\n+    const elem = element.querySelector(selector);\n+    return elem ? [elem] : [];\n   };\n }\n "
        },
        {
            "sha": "f940d24c3991e46a7ca18707473798023320594b",
            "filename": "packages/animations/browser/test/render/css_keyframes/css_keyframes_driver_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 9,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fanimations%2Fbrowser%2Ftest%2Frender%2Fcss_keyframes%2Fcss_keyframes_driver_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fanimations%2Fbrowser%2Ftest%2Frender%2Fcss_keyframes%2Fcss_keyframes_driver_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fanimations%2Fbrowser%2Ftest%2Frender%2Fcss_keyframes%2Fcss_keyframes_driver_spec.ts?ref=290df4f806472cb3c3fe1d7cbd132990bf3b15ab",
            "patch": "@@ -6,14 +6,13 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n import {fakeAsync, flushMicrotasks} from '@angular/core/testing';\n-\n import {browserDetection} from '@angular/platform-browser/testing/src/browser_util';\n \n import {CssKeyframesDriver} from '../../../src/render/css_keyframes/css_keyframes_driver';\n import {CssKeyframesPlayer} from '../../../src/render/css_keyframes/css_keyframes_player';\n import {DirectStylePlayer} from '../../../src/render/css_keyframes/direct_style_player';\n \n-import {assertElementExistsInDom, createElement, findKeyframeDefinition, forceReflow, makeAnimationEvent, supportsAnimationEventCreation} from './shared';\n+import {assertElementExistsInDom, createElement, findKeyframeDefinition, forceReflow, makeAnimationEvent} from './shared';\n \n const CSS_KEYFRAME_RULE_TYPE = 7;\n \n@@ -108,9 +107,6 @@ describe('CssKeyframesDriver tests', () => {\n \n     it('should animate until the `animationend` method is emitted, but still retain the <style> method and the element animation details',\n        fakeAsync(() => {\n-         // IE11 cannot create an instanceof AnimationEvent\n-         if (!supportsAnimationEventCreation()) return;\n-\n          const elm = createElement();\n          const animator = new CssKeyframesDriver();\n \n@@ -295,10 +291,6 @@ describe('CssKeyframesDriver tests', () => {\n \n     it('should capture existing keyframe player styles in and merge in the styles into the follow up player\\'s keyframes',\n        () => {\n-         // IE cannot modify the position of an animation...\n-         // note that this feature is only for testing purposes\n-         if (browserDetection.isIE) return;\n-\n          const elm = createElement();\n          elm.style.border = '1px solid black';\n          document.body.appendChild(elm);  // this is required so GCS works"
        },
        {
            "sha": "4e6750e456375029fac84730b5d966b324adbc5c",
            "filename": "packages/animations/browser/test/render/css_keyframes/element_animation_style_handler_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fanimations%2Fbrowser%2Ftest%2Frender%2Fcss_keyframes%2Felement_animation_style_handler_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fanimations%2Fbrowser%2Ftest%2Frender%2Fcss_keyframes%2Felement_animation_style_handler_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fanimations%2Fbrowser%2Ftest%2Frender%2Fcss_keyframes%2Felement_animation_style_handler_spec.ts?ref=290df4f806472cb3c3fe1d7cbd132990bf3b15ab",
            "patch": "@@ -6,8 +6,8 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n import {ElementAnimationStyleHandler, getAnimationStyle} from '../../../src/render/css_keyframes/element_animation_style_handler';\n-import {computeStyle} from '../../../src/util';\n-import {assertStyle, createElement, makeAnimationEvent, supportsAnimationEventCreation} from './shared';\n+\n+import {assertStyle, createElement, makeAnimationEvent} from './shared';\n \n const EMPTY_FN = () => {};\n {\n@@ -194,9 +194,6 @@ const EMPTY_FN = () => {};\n     });\n \n     it('should fire the onDone method when the matching animationend event is emitted', () => {\n-      // IE11 cannot create an instanceof AnimationEvent\n-      if (!supportsAnimationEventCreation()) return;\n-\n       const element = createElement();\n       document.body.appendChild(element);\n "
        },
        {
            "sha": "5e0ab78393aa14fcb1ad7ff54f300b51c65d1baf",
            "filename": "packages/animations/browser/test/render/css_keyframes/shared.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 10,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fanimations%2Fbrowser%2Ftest%2Frender%2Fcss_keyframes%2Fshared.ts",
            "raw_url": "https://github.com/angular/angular/raw/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fanimations%2Fbrowser%2Ftest%2Frender%2Fcss_keyframes%2Fshared.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fanimations%2Fbrowser%2Ftest%2Frender%2Fcss_keyframes%2Fshared.ts?ref=290df4f806472cb3c3fe1d7cbd132990bf3b15ab",
            "patch": "@@ -18,16 +18,6 @@ export function makeAnimationEvent(\n   return e;\n }\n \n-export function supportsAnimationEventCreation() {\n-  let supported = false;\n-  try {\n-    makeAnimationEvent('end', 'test', 0);\n-    supported = true;\n-  } catch {\n-  }\n-  return supported;\n-}\n-\n export function findKeyframeDefinition(sheet: any): any|null {\n   return sheet.cssRules[0] || null;\n }"
        },
        {
            "sha": "86a052c7a0fb3e0ccdd0c763a874c6d1e9046e4e",
            "filename": "packages/common/test/pipes/async_pipe_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fcommon%2Ftest%2Fpipes%2Fasync_pipe_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fcommon%2Ftest%2Fpipes%2Fasync_pipe_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Ftest%2Fpipes%2Fasync_pipe_spec.ts?ref=290df4f806472cb3c3fe1d7cbd132990bf3b15ab",
            "patch": "@@ -8,7 +8,6 @@\n \n import {AsyncPipe, ÉµgetDOM as getDOM} from '@angular/common';\n import {ChangeDetectorRef, EventEmitter} from '@angular/core';\n-import {browserDetection} from '@angular/platform-browser/testing/src/browser_util';\n import {Subscribable, Unsubscribable} from 'rxjs';\n \n {\n@@ -144,7 +143,7 @@ import {Subscribable, Unsubscribable} from 'rxjs';\n       let promise: Promise<any>;\n       let ref: any;\n       // adds longer timers for passing tests in IE\n-      const timer = (getDOM() && browserDetection.isIE) ? 50 : 10;\n+      const timer = 10;\n \n       beforeEach(() => {\n         promise = new Promise((res, rej) => {"
        },
        {
            "sha": "26dde092bd725d2c46d52356d5d4c57efea0f9d0",
            "filename": "packages/platform-browser/test/browser_util_spec.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 39,
            "changes": 39,
            "blob_url": "https://github.com/angular/angular/blob/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fplatform-browser%2Ftest%2Fbrowser_util_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fplatform-browser%2Ftest%2Fbrowser_util_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fplatform-browser%2Ftest%2Fbrowser_util_spec.ts?ref=290df4f806472cb3c3fe1d7cbd132990bf3b15ab",
            "patch": "@@ -18,7 +18,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: false,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: false,\n         isSlow: false,\n@@ -31,7 +30,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: false,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: false,\n         isSlow: false,\n@@ -44,46 +42,18 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: true,\n         isAndroid: false,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: false,\n         isIOS7: false,\n         isSlow: false,\n         isChromeDesktop: false,\n         isOldChrome: false\n       },\n-      {\n-        name: 'IE11',\n-        ua: 'Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; .NET4.0E; .NET4.0C; rv:11.0) like Gecko',\n-        isFirefox: false,\n-        isAndroid: false,\n-        isEdge: false,\n-        isIE: true,\n-        isWebkit: false,\n-        isIOS7: false,\n-        isSlow: true,\n-        isChromeDesktop: false,\n-        isOldChrome: false\n-      },\n-      {\n-        name: 'IEMobile',\n-        ua: 'Mozilla/5.0 (Mobile; Windows Phone 8.1; Android 4.0; ARM; Trident/7.0; Touch; rv:11.0; IEMobile/11.0; NOKIA; Lumia 520) like iPhone OS 7_0_3 Mac OS X AppleWebKit/537 (KHTML, like Gecko) Mobile Safari/537',\n-        isFirefox: false,\n-        isAndroid: false,\n-        isEdge: false,\n-        isIE: true,\n-        isWebkit: false,\n-        isIOS7: false,\n-        isSlow: true,\n-        isChromeDesktop: false,\n-        isOldChrome: false\n-      },\n       {\n         name: 'Edge',\n         ua: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10136',\n         isFirefox: false,\n         isAndroid: false,\n         isEdge: true,\n-        isIE: false,\n         isWebkit: false,\n         isIOS7: false,\n         isSlow: false,\n@@ -96,7 +66,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: true,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: false,\n         isSlow: true,\n@@ -109,7 +78,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: true,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: false,\n         isSlow: true,\n@@ -122,7 +90,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: true,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: false,\n         isSlow: true,\n@@ -135,7 +102,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: false,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: false,\n         isSlow: false,\n@@ -148,7 +114,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: false,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: false,\n         isSlow: false,\n@@ -161,7 +126,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: false,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: false,\n         isSlow: false,\n@@ -174,7 +138,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: false,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: true,\n         isSlow: true,\n@@ -187,7 +150,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         isFirefox: false,\n         isAndroid: false,\n         isEdge: false,\n-        isIE: false,\n         isWebkit: true,\n         isIOS7: false,\n         isSlow: false,\n@@ -202,7 +164,6 @@ import {BrowserDetection} from '../testing/src/browser_util';\n         expect(bd.isFirefox).toBe(browser['isFirefox']);\n         expect(bd.isAndroid).toBe(browser['isAndroid']);\n         expect(bd.isEdge).toBe(browser['isEdge']);\n-        expect(bd.isIE).toBe(browser['isIE']);\n         expect(bd.isWebkit).toBe(browser['isWebkit']);\n         expect(bd.isIOS7).toBe(browser['isIOS7']);\n         expect(bd.isSlow).toBe(browser['isSlow']);"
        },
        {
            "sha": "91ebee58e7bf94d5518bd1bd61a9fbedfcfd60e9",
            "filename": "packages/platform-browser/testing/src/browser_util.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fplatform-browser%2Ftesting%2Fsrc%2Fbrowser_util.ts",
            "raw_url": "https://github.com/angular/angular/raw/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fplatform-browser%2Ftesting%2Fsrc%2Fbrowser_util.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fplatform-browser%2Ftesting%2Fsrc%2Fbrowser_util.ts?ref=290df4f806472cb3c3fe1d7cbd132990bf3b15ab",
            "patch": "@@ -41,10 +41,6 @@ export class BrowserDetection {\n     return this._ua.indexOf('Edge') > -1;\n   }\n \n-  get isIE(): boolean {\n-    return this._ua.indexOf('Trident') > -1;\n-  }\n-\n   get isWebkit(): boolean {\n     return this._ua.indexOf('AppleWebKit') > -1 && this._ua.indexOf('Edge') == -1 &&\n         this._ua.indexOf('IEMobile') == -1;\n@@ -56,7 +52,7 @@ export class BrowserDetection {\n   }\n \n   get isSlow(): boolean {\n-    return this.isAndroid || this.isIE || this.isIOS7;\n+    return this.isAndroid || this.isIOS7;\n   }\n \n   get isChromeDesktop(): boolean {"
        },
        {
            "sha": "d416ed2084bc6fd10b7d6fb0320e3825c978764a",
            "filename": "packages/upgrade/static/test/integration/downgrade_module_spec.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fupgrade%2Fstatic%2Ftest%2Fintegration%2Fdowngrade_module_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/290df4f806472cb3c3fe1d7cbd132990bf3b15ab/packages%2Fupgrade%2Fstatic%2Ftest%2Fintegration%2Fdowngrade_module_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fupgrade%2Fstatic%2Ftest%2Fintegration%2Fdowngrade_module_spec.ts?ref=290df4f806472cb3c3fe1d7cbd132990bf3b15ab",
            "patch": "@@ -10,7 +10,6 @@ import {AfterContentChecked, AfterContentInit, AfterViewChecked, AfterViewInit,\n import {fakeAsync, tick, waitForAsync} from '@angular/core/testing';\n import {BrowserModule} from '@angular/platform-browser';\n import {platformBrowserDynamic} from '@angular/platform-browser-dynamic';\n-import {browserDetection} from '@angular/platform-browser/testing/src/browser_util';\n import {downgradeComponent, downgradeModule, UpgradeComponent} from '@angular/upgrade/static';\n \n import * as angular from '../../../src/common/src/angular1';\n@@ -1310,7 +1309,6 @@ withEachNg1Version(() => {\n              ngDoBootstrap() {}\n            }\n \n-           const tickDelay = browserDetection.isIE ? 100 : 0;\n            const bootstrapFn = (extraProviders: StaticProvider[]) =>\n                platformBrowserDynamic(extraProviders).bootstrapModule(Ng2Module);\n            const lazyModuleName = downgradeModule<Ng2Module>(bootstrapFn);\n@@ -1324,8 +1322,8 @@ withEachNg1Version(() => {\n            const $rootScope = $injector.get($ROOT_SCOPE) as angular.IRootScopeService;\n \n            $rootScope.$apply('showNg2 = true');\n-           tick(tickDelay);  // Wait for the module to be bootstrapped and `$evalAsync()` to\n-                             // propagate inputs.\n+           tick(0);  // Wait for the module to be bootstrapped and `$evalAsync()` to\n+                     // propagate inputs.\n \n            const injector = ($injector.get(LAZY_MODULE_REF) as LazyModuleRef).injector!;\n            const injectorGet = injector.get;\n@@ -1340,7 +1338,7 @@ withEachNg1Version(() => {\n            expect(element.textContent).toBe('');\n \n            $rootScope.$apply('showNg2 = true');\n-           tick(tickDelay);  // Wait for `$evalAsync()` to propagate inputs.\n+           tick(0);  // Wait for `$evalAsync()` to propagate inputs.\n            expect(element.textContent).toBe('Count: 2 | In the zone: true');\n \n            $rootScope.$destroy();"
        }
    ],
    "stats": {
        "total": 104,
        "additions": 11,
        "deletions": 93
    }
}