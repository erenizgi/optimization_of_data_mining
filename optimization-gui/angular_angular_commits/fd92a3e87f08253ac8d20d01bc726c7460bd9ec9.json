{
    "author": "josephperrott",
    "message": "fix(dev-infra): perform actual npm login verification for wombot proxy (#42871)\n\nPreviously the wombot proxy was not able to be queried for login state, now\nthat it is able to be checked via `npm whoami` a specific alternate flow\nis no longer needed.\n\nPR Close #42871",
    "sha": "fd92a3e87f08253ac8d20d01bc726c7460bd9ec9",
    "files": [
        {
            "sha": "e993e07c96aafb3af800e1c8d4de2181d2b0ffe5",
            "filename": "dev-infra/ng-dev.js",
            "status": "modified",
            "additions": 2,
            "deletions": 14,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/fd92a3e87f08253ac8d20d01bc726c7460bd9ec9/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/fd92a3e87f08253ac8d20d01bc726c7460bd9ec9/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=fd92a3e87f08253ac8d20d01bc726c7460bd9ec9",
            "patch": "@@ -7467,21 +7467,9 @@ class ReleaseTool {\n      * @returns a boolean indicating whether the user is logged into NPM.\n      */\n     _verifyNpmLoginState() {\n-        var _a, _b;\n+        var _a;\n         return tslib.__awaiter(this, void 0, void 0, function* () {\n             const registry = `NPM at the ${(_a = this._config.publishRegistry) !== null && _a !== void 0 ? _a : 'default NPM'} registry`;\n-            // TODO(josephperrott): remove wombat specific block once wombot allows `npm whoami` check to\n-            // check the status of the local token in the .npmrc file.\n-            if ((_b = this._config.publishRegistry) === null || _b === void 0 ? void 0 : _b.includes('wombat-dressing-room.appspot.com')) {\n-                info('Unable to determine NPM login state for wombat proxy, requiring login now.');\n-                try {\n-                    yield npmLogin(this._config.publishRegistry);\n-                }\n-                catch (_c) {\n-                    return false;\n-                }\n-                return true;\n-            }\n             if (yield npmIsLoggedIn(this._config.publishRegistry)) {\n                 debug(`Already logged into ${registry}.`);\n                 return true;\n@@ -7493,7 +7481,7 @@ class ReleaseTool {\n                 try {\n                     yield npmLogin(this._config.publishRegistry);\n                 }\n-                catch (_d) {\n+                catch (_b) {\n                     return false;\n                 }\n                 return true;"
        },
        {
            "sha": "ac4b5255e2653bb5b65a1cc58f4ad10d0132c3af",
            "filename": "dev-infra/release/publish/index.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 11,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/fd92a3e87f08253ac8d20d01bc726c7460bd9ec9/dev-infra%2Frelease%2Fpublish%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/fd92a3e87f08253ac8d20d01bc726c7460bd9ec9/dev-infra%2Frelease%2Fpublish%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Findex.ts?ref=fd92a3e87f08253ac8d20d01bc726c7460bd9ec9",
            "patch": "@@ -184,17 +184,6 @@ export class ReleaseTool {\n    */\n   private async _verifyNpmLoginState(): Promise<boolean> {\n     const registry = `NPM at the ${this._config.publishRegistry ?? 'default NPM'} registry`;\n-    // TODO(josephperrott): remove wombat specific block once wombot allows `npm whoami` check to\n-    // check the status of the local token in the .npmrc file.\n-    if (this._config.publishRegistry?.includes('wombat-dressing-room.appspot.com')) {\n-      info('Unable to determine NPM login state for wombat proxy, requiring login now.');\n-      try {\n-        await npmLogin(this._config.publishRegistry);\n-      } catch {\n-        return false;\n-      }\n-      return true;\n-    }\n     if (await npmIsLoggedIn(this._config.publishRegistry)) {\n       debug(`Already logged into ${registry}.`);\n       return true;"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 2,
        "deletions": 25
    }
}