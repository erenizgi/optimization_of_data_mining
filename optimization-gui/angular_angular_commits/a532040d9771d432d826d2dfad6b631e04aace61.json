{
    "author": "dylhunn",
    "message": "Revert \"feat(core): add migration to remove entryComponents (#44308)\" (#44318)\n\nThis reverts commit 5dff077d505da60ddead9f2ff2ddaaaea6feeb4a.\n\nPR Close #44318",
    "sha": "a532040d9771d432d826d2dfad6b631e04aace61",
    "files": [
        {
            "sha": "a60dbd252def92cce26d4c6d198d343cfd538f42",
            "filename": "packages/core/schematics/BUILD.bazel",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/a532040d9771d432d826d2dfad6b631e04aace61/packages%2Fcore%2Fschematics%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/a532040d9771d432d826d2dfad6b631e04aace61/packages%2Fcore%2Fschematics%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2FBUILD.bazel?ref=a532040d9771d432d826d2dfad6b631e04aace61",
            "patch": "@@ -13,7 +13,6 @@ pkg_npm(\n     ],\n     visibility = [\"//packages/core:__pkg__\"],\n     deps = [\n-        \"//packages/core/schematics/migrations/entry-components\",\n         \"//packages/core/schematics/migrations/router-link-empty-expression\",\n         \"//packages/core/schematics/migrations/testbed-teardown\",\n     ],"
        },
        {
            "sha": "05f02c3dec062da3001fad1fa767b7a0501b8a02",
            "filename": "packages/core/schematics/migrations.json",
            "status": "modified",
            "additions": 0,
            "deletions": 10,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/a532040d9771d432d826d2dfad6b631e04aace61/packages%2Fcore%2Fschematics%2Fmigrations.json",
            "raw_url": "https://github.com/angular/angular/raw/a532040d9771d432d826d2dfad6b631e04aace61/packages%2Fcore%2Fschematics%2Fmigrations.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations.json?ref=a532040d9771d432d826d2dfad6b631e04aace61",
            "patch": "@@ -9,16 +9,6 @@\n       \"version\": \"13.0.0-beta\",\n       \"description\": \"In Angular version 13, the `teardown` flag in `TestBed` will be enabled by default. This migration automatically opts out existing apps from the new teardown behavior.\",\n       \"factory\": \"./migrations/testbed-teardown/index\"\n-    },\n-    \"migration-v13.1-entry-components\": {\n-      \"version\": \"13.1.0-beta\",\n-      \"description\": \"As of Angular version 13, `entryComponents` are no longer necessary.\",\n-      \"factory\": \"./migrations/entry-components/index\"\n-    },\n-    \"migration-v14-entry-components\": {\n-      \"version\": \"14.0.0-beta\",\n-      \"description\": \"As of Angular version 13, `entryComponents` are no longer necessary.\",\n-      \"factory\": \"./migrations/entry-components/index\"\n     }\n   }\n }"
        },
        {
            "sha": "29508aa640a5b74b05d52af4748055892514d5a7",
            "filename": "packages/core/schematics/migrations/entry-components/BUILD.bazel",
            "status": "removed",
            "additions": 0,
            "deletions": 18,
            "changes": 18,
            "blob_url": "https://github.com/angular/angular/blob/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2FBUILD.bazel?ref=24baa5e61d3c8f11a9dae0c51b0510757d5fe43e",
            "patch": "@@ -1,18 +0,0 @@\n-load(\"//tools:defaults.bzl\", \"ts_library\")\n-\n-ts_library(\n-    name = \"entry-components\",\n-    srcs = glob([\"**/*.ts\"]),\n-    tsconfig = \"//packages/core/schematics:tsconfig.json\",\n-    visibility = [\n-        \"//packages/core/schematics:__pkg__\",\n-        \"//packages/core/schematics/migrations/google3:__pkg__\",\n-        \"//packages/core/schematics/test:__pkg__\",\n-    ],\n-    deps = [\n-        \"//packages/core/schematics/utils\",\n-        \"@npm//@angular-devkit/schematics\",\n-        \"@npm//@types/node\",\n-        \"@npm//typescript\",\n-    ],\n-)"
        },
        {
            "sha": "4cbdedb44437c6e53c0c81ef07b07405cc9e02eb",
            "filename": "packages/core/schematics/migrations/entry-components/README.md",
            "status": "removed",
            "additions": 0,
            "deletions": 33,
            "changes": 33,
            "blob_url": "https://github.com/angular/angular/blob/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2FREADME.md",
            "raw_url": "https://github.com/angular/angular/raw/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2FREADME.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2FREADME.md?ref=24baa5e61d3c8f11a9dae0c51b0510757d5fe43e",
            "patch": "@@ -1,33 +0,0 @@\n-## entryComponents migration\n-As of Angular version 13, the `entryComponents` option in `@NgModule` and `@Component` isn't\n-necessary anymore. This migration will automatically remove any usages.\n-\n-#### Before\n-```ts\n-import { NgModule, Component } from '@angular/core';\n-\n-@Component({selector: 'my-comp', template: ''})\n-export class MyComp {}\n-\n-@NgModule({\n-  declarations: [MyComp],\n-  entryComponents: [MyComp],\n-  exports: [MyComp]\n-})\n-export class MyModule {}\n-```\n-\n-#### After\n-```ts\n-import { NgModule, Component } from '@angular/core';\n-\n-@Component({selector: 'my-comp', template: ''})\n-export class MyComp {}\n-\n-@NgModule({\n-  declarations: [MyComp],\n-  exports: [MyComp]\n-})\n-export class MyModule {}\n-```\n-"
        },
        {
            "sha": "8719bc68481a72f3cf31a9bdffe532019e8018e2",
            "filename": "packages/core/schematics/migrations/entry-components/index.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 56,
            "changes": 56,
            "blob_url": "https://github.com/angular/angular/blob/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2Findex.ts?ref=24baa5e61d3c8f11a9dae0c51b0510757d5fe43e",
            "patch": "@@ -1,56 +0,0 @@\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-import {Rule, SchematicsException, Tree} from '@angular-devkit/schematics';\n-import {relative} from 'path';\n-import ts from 'typescript';\n-\n-import {getProjectTsConfigPaths} from '../../utils/project_tsconfig_paths';\n-import {canMigrateFile, createMigrationProgram} from '../../utils/typescript/compiler_host';\n-\n-import {migrateEntryComponentsUsages} from './util';\n-\n-\n-/** Migration that removes `entryComponents` usages. */\n-export default function(): Rule {\n-  return async (tree: Tree) => {\n-    const {buildPaths, testPaths} = await getProjectTsConfigPaths(tree);\n-    const basePath = process.cwd();\n-    const allPaths = [...buildPaths, ...testPaths];\n-\n-    if (!allPaths.length) {\n-      throw new SchematicsException(\n-          'Could not find any tsconfig file. Cannot remove `entryComponents`.');\n-    }\n-\n-    for (const tsconfigPath of allPaths) {\n-      runEntryComponentsMigration(tree, tsconfigPath, basePath);\n-    }\n-  };\n-}\n-\n-function runEntryComponentsMigration(tree: Tree, tsconfigPath: string, basePath: string) {\n-  const {program} = createMigrationProgram(tree, tsconfigPath, basePath);\n-  const typeChecker = program.getTypeChecker();\n-  const printer = ts.createPrinter();\n-\n-  program.getSourceFiles()\n-      .filter(sourceFile => canMigrateFile(basePath, sourceFile, program))\n-      .forEach(sourceFile => {\n-        const usages = migrateEntryComponentsUsages(typeChecker, printer, sourceFile);\n-\n-        if (usages.length > 0) {\n-          const update = tree.beginUpdate(relative(basePath, sourceFile.fileName));\n-          usages.forEach(usage => {\n-            update.remove(usage.start, usage.length);\n-            update.insertRight(usage.start, usage.replacement);\n-          });\n-          tree.commitUpdate(update);\n-        }\n-      });\n-}"
        },
        {
            "sha": "451ec00aefdd30aa22ea5012091ea5ff35928184",
            "filename": "packages/core/schematics/migrations/entry-components/util.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 51,
            "changes": 51,
            "blob_url": "https://github.com/angular/angular/blob/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Fentry-components%2Futil.ts?ref=24baa5e61d3c8f11a9dae0c51b0510757d5fe43e",
            "patch": "@@ -1,51 +0,0 @@\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-import ts from 'typescript';\n-\n-import {getCallDecoratorImport} from '../../utils/typescript/decorators';\n-\n-/** Finds and migrates all Angular decorators that pass in `entryComponents`. */\n-export function migrateEntryComponentsUsages(\n-    typeChecker: ts.TypeChecker, printer: ts.Printer, sourceFile: ts.SourceFile) {\n-  const results: {start: number, length: number, end: number, replacement: string}[] = [];\n-\n-  sourceFile.forEachChild(function walk(node: ts.Node) {\n-    if (ts.isDecorator(node) && ts.isCallExpression(node.expression) &&\n-        node.expression.arguments.length === 1 &&\n-        ts.isObjectLiteralExpression(node.expression.arguments[0])) {\n-      const analysis = getCallDecoratorImport(typeChecker, node);\n-\n-      if (analysis && analysis.importModule === '@angular/core' &&\n-          (analysis.name === 'Component' || analysis.name === 'NgModule')) {\n-        const literal = node.expression.arguments[0];\n-        const entryComponentsProp = literal.properties.find(\n-            property => ts.isPropertyAssignment(property) && ts.isIdentifier(property.name) &&\n-                property.name.text === 'entryComponents');\n-\n-        if (entryComponentsProp) {\n-          const replacementNode = ts.updateObjectLiteral(\n-              literal, literal.properties.filter(prop => prop !== entryComponentsProp));\n-\n-          results.push({\n-            start: literal.getStart(),\n-            length: literal.getWidth(),\n-            end: literal.getEnd(),\n-            replacement: printer.printNode(ts.EmitHint.Unspecified, replacementNode, sourceFile)\n-          });\n-        }\n-      }\n-    }\n-\n-    node.forEachChild(walk);\n-  });\n-\n-  // Sort the operations in reverse order in order to avoid\n-  // issues when migrating multiple usages within the same file.\n-  return results.sort((a, b) => b.start - a.start);\n-}"
        },
        {
            "sha": "e7a14c4c7fc6b81d677e6c872c349c1fbe165716",
            "filename": "packages/core/schematics/migrations/google3/BUILD.bazel",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/a532040d9771d432d826d2dfad6b631e04aace61/packages%2Fcore%2Fschematics%2Fmigrations%2Fgoogle3%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/a532040d9771d432d826d2dfad6b631e04aace61/packages%2Fcore%2Fschematics%2Fmigrations%2Fgoogle3%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Fgoogle3%2FBUILD.bazel?ref=a532040d9771d432d826d2dfad6b631e04aace61",
            "patch": "@@ -6,7 +6,6 @@ ts_library(\n     tsconfig = \"//packages/core/schematics:tsconfig.json\",\n     visibility = [\"//packages/core/schematics/test/google3:__pkg__\"],\n     deps = [\n-        \"//packages/core/schematics/migrations/entry-components\",\n         \"//packages/core/schematics/migrations/testbed-teardown\",\n         \"//packages/core/schematics/utils\",\n         \"//packages/core/schematics/utils/tslint\","
        },
        {
            "sha": "21db701c3f8a7513d9525a8546ac898eb93a3c36",
            "filename": "packages/core/schematics/migrations/google3/entryComponentsRule.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 28,
            "changes": 28,
            "blob_url": "https://github.com/angular/angular/blob/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fgoogle3%2FentryComponentsRule.ts",
            "raw_url": "https://github.com/angular/angular/raw/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Fmigrations%2Fgoogle3%2FentryComponentsRule.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Fgoogle3%2FentryComponentsRule.ts?ref=24baa5e61d3c8f11a9dae0c51b0510757d5fe43e",
            "patch": "@@ -1,28 +0,0 @@\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-import {Replacement, RuleFailure, Rules} from 'tslint';\n-import ts from 'typescript';\n-\n-import {migrateEntryComponentsUsages} from '../../migrations/entry-components/util';\n-\n-\n-/** TSLint rule that removes usages of `entryComponents`. */\n-export class Rule extends Rules.TypedRule {\n-  override applyWithProgram(sourceFile: ts.SourceFile, program: ts.Program): RuleFailure[] {\n-    const typeChecker = program.getTypeChecker();\n-    const printer = ts.createPrinter();\n-\n-    return migrateEntryComponentsUsages(typeChecker, printer, sourceFile).map(usage => {\n-      return new RuleFailure(\n-          sourceFile, usage.start, usage.end,\n-          'entryComponents are deprecated and don\\'t need to be passed in.', this.ruleName,\n-          new Replacement(usage.start, usage.length, usage.replacement));\n-    });\n-  }\n-}"
        },
        {
            "sha": "631e77da3e7e403fe12cac3e5d4bc530895ea90a",
            "filename": "packages/core/schematics/test/BUILD.bazel",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/a532040d9771d432d826d2dfad6b631e04aace61/packages%2Fcore%2Fschematics%2Ftest%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/a532040d9771d432d826d2dfad6b631e04aace61/packages%2Fcore%2Fschematics%2Ftest%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Ftest%2FBUILD.bazel?ref=a532040d9771d432d826d2dfad6b631e04aace61",
            "patch": "@@ -8,7 +8,6 @@ ts_library(\n         \"//packages/core/schematics:migrations.json\",\n     ],\n     deps = [\n-        \"//packages/core/schematics/migrations/entry-components\",\n         \"//packages/core/schematics/migrations/router-link-empty-expression\",\n         \"//packages/core/schematics/migrations/testbed-teardown\",\n         \"//packages/core/schematics/utils\","
        },
        {
            "sha": "2ef3d8e61c4eb1b7a2a67dc9e7c01eb57e3b66ed",
            "filename": "packages/core/schematics/test/entry_components_spec.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 182,
            "changes": 182,
            "blob_url": "https://github.com/angular/angular/blob/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Ftest%2Fentry_components_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Ftest%2Fentry_components_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Ftest%2Fentry_components_spec.ts?ref=24baa5e61d3c8f11a9dae0c51b0510757d5fe43e",
            "patch": "@@ -1,182 +0,0 @@\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-import {getSystemPath, normalize, virtualFs} from '@angular-devkit/core';\n-import {TempScopedNodeJsSyncHost} from '@angular-devkit/core/node/testing';\n-import {HostTree} from '@angular-devkit/schematics';\n-import {SchematicTestRunner, UnitTestTree} from '@angular-devkit/schematics/testing';\n-import * as shx from 'shelljs';\n-\n-\n-describe('entryComponents migration', () => {\n-  let runner: SchematicTestRunner;\n-  let host: TempScopedNodeJsSyncHost;\n-  let tree: UnitTestTree;\n-  let tmpDirPath: string;\n-  let previousWorkingDir: string;\n-\n-  beforeEach(() => {\n-    runner = new SchematicTestRunner('test', require.resolve('../migrations.json'));\n-    host = new TempScopedNodeJsSyncHost();\n-    tree = new UnitTestTree(new HostTree(host));\n-\n-    writeFile('/tsconfig.json', JSON.stringify({\n-      compilerOptions: {\n-        lib: ['es2015'],\n-        strictNullChecks: true,\n-      },\n-    }));\n-    writeFile('/angular.json', JSON.stringify({\n-      version: 1,\n-      projects: {t: {architect: {build: {options: {tsConfig: './tsconfig.json'}}}}}\n-    }));\n-\n-    previousWorkingDir = shx.pwd();\n-    tmpDirPath = getSystemPath(host.root);\n-\n-    // Switch into the temporary directory path. This allows us to run\n-    // the schematic against our custom unit test tree.\n-    shx.cd(tmpDirPath);\n-  });\n-\n-  afterEach(() => {\n-    shx.cd(previousWorkingDir);\n-    shx.rm('-r', tmpDirPath);\n-  });\n-\n-  it('should remove `entryComponents` usages from NgModule', async () => {\n-    writeFile('/index.ts', `\n-      import { NgModule, Component } from '@angular/core';\n-\n-      @Component({selector: 'my-comp', template: ''})\n-      export class MyComp {}\n-\n-      @NgModule({\n-        declarations: [MyComp],\n-        entryComponents: [MyComp],\n-        exports: [MyComp]\n-      })\n-      export class MyModule {}\n-    `);\n-\n-    await runMigration();\n-\n-    expect(stripWhitespace(tree.readContent('/index.ts'))).toContain(stripWhitespace(`\n-      @NgModule({\n-        declarations: [MyComp],\n-        exports: [MyComp]\n-      })\n-    `));\n-  });\n-\n-  it('should remove `entryComponents` usages from Component', async () => {\n-    writeFile('/index.ts', `\n-      import { Component } from '@angular/core';\n-\n-      @Component({selector: 'comp-a', template: ''})\n-      export class CompA {}\n-\n-      @Component({\n-        selector: 'comp-b',\n-        entryComponents: [CompA],\n-        template: ''\n-      })\n-      export class CompB {}\n-    `);\n-\n-    await runMigration();\n-\n-    expect(stripWhitespace(tree.readContent('/index.ts'))).toContain(stripWhitespace(`\n-      @Component({\n-        selector: 'comp-b',\n-        template: ''\n-      })\n-    `));\n-  });\n-\n-  it('should remove multiple `entryComponents` usages from a single file', async () => {\n-    writeFile('/index.ts', `\n-      import { NgModule, Component } from '@angular/core';\n-\n-      @Component({selector: 'comp-a', template: ''})\n-      export class CompA {}\n-\n-      @Component({\n-        selector: 'comp-b',\n-        entryComponents: [CompA],\n-        template: ''\n-      })\n-      export class CompB {}\n-\n-      @NgModule({\n-        declarations: [CompA, CompB],\n-        entryComponents: [CompB],\n-        exports: [CompA, CompB]\n-      })\n-      export class MyModule {}\n-    `);\n-\n-    await runMigration();\n-\n-    const content = stripWhitespace(tree.readContent('/index.ts'));\n-\n-    expect(content).toContain(stripWhitespace(`\n-      @Component({\n-        selector: 'comp-b',\n-        template: ''\n-      })\n-    `));\n-\n-    expect(content).toContain(stripWhitespace(`\n-      @NgModule({\n-        declarations: [CompA, CompB],\n-        exports: [CompA, CompB]\n-      })\n-    `));\n-  });\n-\n-  it('should not remove `entryComponents` usages from decorators that do not come from Angular',\n-     async () => {\n-       writeFile('/index.ts', `\n-        import { Component } from '@angular/core';\n-        import { NgModule } from '@not-angular/core';\n-\n-        @Component({selector: 'my-comp', template: ''})\n-        export class MyComp {}\n-\n-        @NgModule({\n-          declarations: [MyComp],\n-          entryComponents: [MyComp],\n-          exports: [MyComp]\n-        })\n-        export class MyModule {}\n-      `);\n-\n-       await runMigration();\n-\n-       expect(stripWhitespace(tree.readContent('/index.ts'))).toContain(stripWhitespace(`\n-          @NgModule({\n-            declarations: [MyComp],\n-            entryComponents: [MyComp],\n-            exports: [MyComp]\n-          })\n-        `));\n-     });\n-\n-  function writeFile(filePath: string, contents: string) {\n-    host.sync.write(normalize(filePath), virtualFs.stringToFileBuffer(contents));\n-  }\n-\n-  function runMigration() {\n-    return runner.runSchematicAsync('migration-v13.1-entry-components', {}, tree).toPromise();\n-  }\n-\n-  function stripWhitespace(contents: string) {\n-    return contents.replace(/\\s/g, '');\n-  }\n-});"
        },
        {
            "sha": "30462c302d8da78bdf4547da76d141dd390f3680",
            "filename": "packages/core/schematics/test/google3/entry_components_spec.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 214,
            "changes": 214,
            "blob_url": "https://github.com/angular/angular/blob/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Ftest%2Fgoogle3%2Fentry_components_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/24baa5e61d3c8f11a9dae0c51b0510757d5fe43e/packages%2Fcore%2Fschematics%2Ftest%2Fgoogle3%2Fentry_components_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Ftest%2Fgoogle3%2Fentry_components_spec.ts?ref=24baa5e61d3c8f11a9dae0c51b0510757d5fe43e",
            "patch": "@@ -1,214 +0,0 @@\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-import {readFileSync, writeFileSync} from 'fs';\n-import {dirname, join} from 'path';\n-import * as shx from 'shelljs';\n-import {Configuration, Linter} from 'tslint';\n-\n-describe('Google3 entryComponents TSLint rule', () => {\n-  const rulesDirectory = dirname(require.resolve('../../migrations/google3/entryComponentsRule'));\n-  let tmpDir: string;\n-\n-  beforeEach(() => {\n-    tmpDir = join(process.env['TEST_TMPDIR']!, 'google3-test');\n-    shx.mkdir('-p', tmpDir);\n-\n-    writeFile('tsconfig.json', JSON.stringify({\n-      compilerOptions: {module: 'es2015', baseUrl: './'},\n-    }));\n-  });\n-\n-  afterEach(() => shx.rm('-r', tmpDir));\n-\n-  function runTSLint(fix: boolean) {\n-    const program = Linter.createProgram(join(tmpDir, 'tsconfig.json'));\n-    const linter = new Linter({fix, rulesDirectory: [rulesDirectory]}, program);\n-    const config = Configuration.parseConfigFile({rules: {'entryComponents': true}});\n-\n-    program.getRootFileNames().forEach(fileName => {\n-      linter.lint(fileName, program.getSourceFile(fileName)!.getFullText(), config);\n-    });\n-\n-    return linter;\n-  }\n-\n-  function writeFile(fileName: string, content: string) {\n-    writeFileSync(join(tmpDir, fileName), content);\n-  }\n-\n-  function getFile(fileName: string) {\n-    return readFileSync(join(tmpDir, fileName), 'utf8');\n-  }\n-\n-\n-  function stripWhitespace(contents: string) {\n-    return contents.replace(/\\s/g, '');\n-  }\n-\n-  it('should flag entryComponents in NgModule', () => {\n-    writeFile('/index.ts', `\n-      import { NgModule, Component } from '@angular/core';\n-\n-      @Component({selector: 'my-comp', template: ''})\n-      export class MyComp {}\n-\n-      @NgModule({\n-        declarations: [MyComp],\n-        entryComponents: [MyComp],\n-        exports: [MyComp]\n-      })\n-      export class MyModule {}\n-    `);\n-\n-    const linter = runTSLint(false);\n-    const failures = linter.getResult().failures.map(failure => failure.getFailure());\n-    expect(failures.length).toBe(1);\n-    expect(failures[0]).toMatch(/entryComponents are deprecated and don't need to be passed in/);\n-  });\n-\n-  it('should flag entryComponents in Component', () => {\n-    writeFile('/index.ts', `\n-      import { Component } from '@angular/core';\n-\n-      @Component({selector: 'comp-a', template: ''})\n-      export class CompA {}\n-\n-      @Component({\n-        selector: 'comp-b',\n-        entryComponents: [CompA],\n-        template: ''\n-      })\n-      export class CompB {}\n-    `);\n-\n-    const linter = runTSLint(false);\n-    const failures = linter.getResult().failures.map(failure => failure.getFailure());\n-    expect(failures.length).toBe(1);\n-    expect(failures[0]).toMatch(/entryComponents are deprecated and don't need to be passed in/);\n-  });\n-\n-  it('should remove `entryComponents` usages from NgModule', () => {\n-    writeFile('/index.ts', `\n-      import { NgModule, Component } from '@angular/core';\n-\n-      @Component({selector: 'my-comp', template: ''})\n-      export class MyComp {}\n-\n-      @NgModule({\n-        declarations: [MyComp],\n-        entryComponents: [MyComp],\n-        exports: [MyComp]\n-      })\n-      export class MyModule {}\n-    `);\n-\n-    runTSLint(true);\n-\n-    expect(stripWhitespace(getFile('/index.ts'))).toContain(stripWhitespace(`\n-      @NgModule({\n-        declarations: [MyComp],\n-        exports: [MyComp]\n-      })\n-    `));\n-  });\n-\n-  it('should remove `entryComponents` usages from Component', () => {\n-    writeFile('/index.ts', `\n-      import { Component } from '@angular/core';\n-\n-      @Component({selector: 'comp-a', template: ''})\n-      export class CompA {}\n-\n-      @Component({\n-        selector: 'comp-b',\n-        entryComponents: [CompA],\n-        template: ''\n-      })\n-      export class CompB {}\n-    `);\n-\n-    runTSLint(true);\n-\n-    expect(stripWhitespace(getFile('/index.ts'))).toContain(stripWhitespace(`\n-      @Component({\n-        selector: 'comp-b',\n-        template: ''\n-      })\n-    `));\n-  });\n-\n-  it('should remove multiple `entryComponents` usages from a single file', () => {\n-    writeFile('/index.ts', `\n-      import { NgModule, Component } from '@angular/core';\n-\n-      @Component({selector: 'comp-a', template: ''})\n-      export class CompA {}\n-\n-      @Component({\n-        selector: 'comp-b',\n-        entryComponents: [CompA],\n-        template: ''\n-      })\n-      export class CompB {}\n-\n-      @NgModule({\n-        declarations: [CompA, CompB],\n-        entryComponents: [CompB],\n-        exports: [CompA, CompB]\n-      })\n-      export class MyModule {}\n-    `);\n-\n-    runTSLint(true);\n-\n-    const content = stripWhitespace(getFile('/index.ts'));\n-\n-    expect(content).toContain(stripWhitespace(`\n-      @Component({\n-        selector: 'comp-b',\n-        template: ''\n-      })\n-    `));\n-\n-    expect(content).toContain(stripWhitespace(`\n-      @NgModule({\n-        declarations: [CompA, CompB],\n-        exports: [CompA, CompB]\n-      })\n-    `));\n-  });\n-\n-  it('should not remove `entryComponents` usages from decorators that do not come from Angular',\n-     () => {\n-       writeFile('/index.ts', `\n-        import { Component } from '@angular/core';\n-        import { NgModule } from '@not-angular/core';\n-\n-        @Component({selector: 'my-comp', template: ''})\n-        export class MyComp {}\n-\n-        @NgModule({\n-          declarations: [MyComp],\n-          entryComponents: [MyComp],\n-          exports: [MyComp]\n-        })\n-        export class MyModule {}\n-      `);\n-\n-       runTSLint(true);\n-\n-       expect(stripWhitespace(getFile('/index.ts'))).toContain(stripWhitespace(`\n-        @NgModule({\n-          declarations: [MyComp],\n-          entryComponents: [MyComp],\n-          exports: [MyComp]\n-        })\n-      `));\n-     });\n-});"
        }
    ],
    "stats": {
        "total": 595,
        "additions": 0,
        "deletions": 595
    }
}