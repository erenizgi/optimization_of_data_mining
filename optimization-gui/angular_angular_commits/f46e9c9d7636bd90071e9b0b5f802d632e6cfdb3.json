{
    "author": "AleksanderBodurri",
    "message": "feat(devtools): fix component styling for tooltip; add overflow  to tree wrapper; truncate long tree labels",
    "sha": "f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3",
    "files": [
        {
            "sha": "2eafffa4dc4e0852fd6f785627beccfe2149277d",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/devtools-tabs.component.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdevtools-tabs.component.ts",
            "raw_url": "https://github.com/angular/angular/raw/f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdevtools-tabs.component.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdevtools-tabs.component.ts?ref=f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3",
            "patch": "@@ -56,7 +56,7 @@ export class DevToolsTabsComponent implements OnInit, OnDestroy, AfterViewInit {\n     this.activeTab = tab;\n     this.tabUpdate.notify();\n     if (tab === 'Router Tree') {\n-      setTimeout(() => this.routerTree.render());\n+      this._messageBus.emit('getRoutes');\n     }\n   }\n "
        },
        {
            "sha": "e9c8f4a2923c36359644395199aec873128cc3fc",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/router-tree/router-tree.component.html",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Frouter-tree%2Frouter-tree.component.html",
            "raw_url": "https://github.com/angular/angular/raw/f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Frouter-tree%2Frouter-tree.component.html",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Frouter-tree%2Frouter-tree.component.html?ref=f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3",
            "patch": "@@ -4,11 +4,7 @@ <h1>\n       There are no routes to display.\n     </h1>\n   </div>\n-  <div class=\"full-height\" [hidden]=\"routes?.length === 0\">\n-    <div class=\"full-height\" #routeTree>\n-      <svg #svgContainer class=\"svg-container\">\n-        <g #mainGroup></g>\n-      </svg>\n-    </div>\n-  </div>\n+  <svg #svgContainer class=\"svg-container\" [hidden]=\"routes?.length === 0\">\n+    <g #mainGroup></g>\n+  </svg>\n </div>"
        },
        {
            "sha": "8fe31cb7ce359e86eda85ac3bb487c7650c368ec",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/router-tree/router-tree.component.scss",
            "status": "modified",
            "additions": 55,
            "deletions": 77,
            "changes": 132,
            "blob_url": "https://github.com/angular/angular/blob/f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Frouter-tree%2Frouter-tree.component.scss",
            "raw_url": "https://github.com/angular/angular/raw/f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Frouter-tree%2Frouter-tree.component.scss",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Frouter-tree%2Frouter-tree.component.scss?ref=f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3",
            "patch": "@@ -1,75 +1,71 @@\n-:host {\n-  .full-height {\n-    font-family: Menlo, monospace;\n-    font-size: 11px;\n-    height: 100%;\n-  }\n-\n-  .router-tree-wrapper {\n-    font-size: 1em;\n-    width: 100%;\n-    height: calc(100% - 28px);\n-  }\n+.router-tree-wrapper {\n+  font-size: 1em;\n+  width: 100%;\n+  height: 100%;\n+  overflow-x: auto;\n+}\n \n-  .no-routes {\n-    padding-top: 1rem;\n-    text-align: center;\n-    color: #b0b0b0;\n-  }\n+.no-routes {\n+  padding-top: 1rem;\n+  text-align: center;\n+  color: #b0b0b0;\n+}\n \n-  .svg-container {\n-    max-height: inherit;\n-  }\n+.svg-container {\n+  max-height: inherit;\n }\n \n ::ng-deep {\n-  .link {\n-    stroke: #9b9b9b;\n-    stroke-width: 1px;\n-    fill: none;\n+  .tooltip {\n+    position: absolute;\n+    background: #ebf1fb;\n+    border: 0px;\n+    border-radius: 2px;\n+    pointer-events: none;\n+    font-family: Roboto, 'Helvetica Neue', sans-serif;\n+    font-size: 0.8rem;\n+    line-height: 1.25rem;\n   }\n+}\n \n-  .node {\n-    cursor: pointer;\n-  }\n+:host {\n+  ::ng-deep {\n+    .link {\n+      stroke: #9b9b9b;\n+      stroke-width: 1px;\n+      fill: none;\n+    }\n \n-  .node-route {\n-    stroke: #f05057;\n-    fill: #fff0f0;\n-    stroke-width: 1px;\n-  }\n+    .node {\n+      cursor: pointer;\n+    }\n \n-  & .node-route:hover,\n-  & .node-route.selected {\n-    fill: #f05057;\n-  }\n+    .node-route {\n+      stroke: #f05057;\n+      fill: #fff0f0;\n+      stroke-width: 1px;\n+    }\n \n-  & .node-aux-route {\n-    stroke: #2828ab;\n-    fill: #ebf2fc;\n-    stroke-width: 1px;\n-  }\n+    & .node-route:hover,\n+    & .node-route.selected {\n+      fill: #f05057;\n+    }\n \n-  & .node-aux-route:hover,\n-  & .node-aux-route.selected {\n-    fill: #2828ab;\n-  }\n+    & .node-aux-route {\n+      stroke: #2828ab;\n+      fill: #ebf2fc;\n+      stroke-width: 1px;\n+    }\n \n-  & text {\n-    fill: #000000;\n-    font-weight: 300;\n-  }\n+    & .node-aux-route:hover,\n+    & .node-aux-route.selected {\n+      fill: #2828ab;\n+    }\n \n-  & .tooltip {\n-    position: absolute;\n-    padding: 4px 8px;\n-    background: #ebf1fb;\n-    border: 0px;\n-    border-radius: 2px;\n-    pointer-events: none;\n-    font-family: Menlo, monospace;\n-    font-size: 11px;\n-    line-height: 18px;\n+    & text {\n+      fill: #000000;\n+      font-weight: 300;\n+    }\n   }\n }\n \n@@ -81,14 +77,9 @@\n       fill: none;\n     }\n \n-    .node {\n-      cursor: pointer;\n-    }\n-\n     .node-route {\n       stroke: #54c9bd;\n       fill: #242424;\n-      stroke-width: 1px;\n     }\n \n     & .node-route:hover,\n@@ -99,7 +90,6 @@\n     & .node-aux-route {\n       stroke: #2828ab;\n       fill: #ebf2fc;\n-      stroke-width: 1px;\n     }\n \n     & .node-aux-route:hover,\n@@ -110,17 +100,5 @@\n     & text {\n       fill: #bcc5ce;\n     }\n-\n-    & .tooltip {\n-      position: absolute;\n-      padding: 4px 8px;\n-      background: #ebf1fb;\n-      border: 0px;\n-      border-radius: 2px;\n-      pointer-events: none;\n-      font-family: Menlo, monospace;\n-      font-size: 11px;\n-      line-height: 18px;\n-    }\n   }\n }"
        },
        {
            "sha": "040b0954e488339fda3e84df25396c1f5fbf4892",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/router-tree/router-tree.component.ts",
            "status": "modified",
            "additions": 22,
            "deletions": 16,
            "changes": 38,
            "blob_url": "https://github.com/angular/angular/blob/f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Frouter-tree%2Frouter-tree.component.ts",
            "raw_url": "https://github.com/angular/angular/raw/f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Frouter-tree%2Frouter-tree.component.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Frouter-tree%2Frouter-tree.component.ts?ref=f46e9c9d7636bd90071e9b0b5f802d632e6cfdb3",
            "patch": "@@ -1,4 +1,4 @@\n-import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\n+import { Component, OnInit, ViewChild, ElementRef, AfterViewInit } from '@angular/core';\n import { MessageBus, Events } from 'protocol';\n import * as d3 from 'd3';\n \n@@ -7,32 +7,36 @@ import * as d3 from 'd3';\n   templateUrl: './router-tree.component.html',\n   styleUrls: ['./router-tree.component.scss'],\n })\n-export class RouterTreeComponent implements OnInit {\n+export class RouterTreeComponent implements OnInit, AfterViewInit {\n   @ViewChild('svgContainer', { static: true }) private svgContainer: ElementRef;\n   @ViewChild('mainGroup', { static: true }) private g: ElementRef;\n \n   routes: any[] = [];\n   private tree: d3.TreeLayout<{}>;\n+  private tooltip: any;\n \n-  constructor(private _messageBus: MessageBus<Events>) {\n-    this._messageBus.emit('getRoutes');\n-  }\n+  constructor(private _messageBus: MessageBus<Events>) {}\n \n   ngOnInit(): void {\n     this._messageBus.on('updateRouterTree', (routes) => {\n-      this.routes = routes;\n-      if (routes && this.g) {\n-        d3.select(this.g.nativeElement).selectAll('*').remove();\n-      }\n+      this.routes = routes || [];\n       this.render();\n     });\n   }\n \n+  ngAfterViewInit(): void {\n+    this._messageBus.emit('getRoutes');\n+  }\n+\n   render(): void {\n-    if (this.routes.length === 0) {\n+    if (this.routes.length === 0 || !this.g) {\n       return;\n     }\n \n+    // cleanup old render\n+    this.tooltip?.remove?.();\n+    d3.select(this.g.nativeElement).selectAll('*').remove();\n+\n     this.tree = d3.tree();\n     const svg = d3.select(this.svgContainer.nativeElement);\n     svg.attr('height', 500).attr('width', 500);\n@@ -51,7 +55,7 @@ export class RouterTreeComponent implements OnInit {\n     );\n \n     // Define the div for the tooltip\n-    const div = d3.select('body').append('div').attr('class', 'tooltip').style('opacity', 0);\n+    this.tooltip = d3.select('body').append('div').attr('class', 'tooltip').style('opacity', 0).style('padding', '0');\n \n     g.selectAll('.link')\n       .data(nodes.descendants().slice(1))\n@@ -83,13 +87,13 @@ export class RouterTreeComponent implements OnInit {\n           <b>Specificity:</b> ${n.data.specificity}<br/>\n           <b>Handler:</b> ${n.data.handler}<br/>\n         `;\n-        div.transition().style('opacity', 0.9);\n-        div\n+        this.tooltip.style('padding', '4px 8px').transition().style('opacity', 0.9);\n+        this.tooltip\n           .html(content)\n           .style('left', d3.event.pageX + 8 + 'px')\n           .style('top', d3.event.pageY + 8 + 'px');\n       })\n-      .on('mouseout', () => div.transition().style('opacity', 0))\n+      .on('mouseout', () => this.tooltip.transition().style('opacity', 0))\n       .attr('transform', (d) => `translate(${d.y},${d.x})`);\n \n     node\n@@ -110,8 +114,10 @@ export class RouterTreeComponent implements OnInit {\n         }\n       })\n       .attr('text-anchor', (d) => (d.children ? 'end' : 'start'))\n-      .text((d) => (d.data as any).name)\n-      .attr('class', 'monospace');\n+      .text((d) => {\n+        const label = (d.data as any).name;\n+        return label.length > 20 ? label.slice(0, 17) + '...' : label;\n+      });\n \n     // reset transform\n     g.attr('transform', 'translate(0, 0)');"
        }
    ],
    "stats": {
        "total": 182,
        "additions": 81,
        "deletions": 101
    }
}