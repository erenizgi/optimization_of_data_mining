{
    "author": "mhevery",
    "message": "Revert \"build: update to use npm_package.pack rule (#39636)\"\n\nThis reverts commit fbfc7dff48cc9c63d3dd44934c7f17f8d0ba47f4.",
    "sha": "73e15bd78f1a124cfcd477e3a633bcbdfa9a5470",
    "files": [
        {
            "sha": "f0adb929098538ab621b5f11a7d2c2536ffced3c",
            "filename": "scripts/build/zone-js-builder.js",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/73e15bd78f1a124cfcd477e3a633bcbdfa9a5470/scripts%2Fbuild%2Fzone-js-builder.js",
            "raw_url": "https://github.com/angular/angular/raw/73e15bd78f1a124cfcd477e3a633bcbdfa9a5470/scripts%2Fbuild%2Fzone-js-builder.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/scripts%2Fbuild%2Fzone-js-builder.js?ref=73e15bd78f1a124cfcd477e3a633bcbdfa9a5470",
            "patch": "@@ -35,7 +35,7 @@ function buildZoneJsPackage(destPath) {\n   console.info(`${scriptPath}:`);\n   console.info('  Building zone.js npm package');\n   console.info('##############################');\n-  exec(`${bazelCmd} run //packages/zone.js:npm_package.pack`);\n+  exec(`${bazelCmd} build //packages/zone.js:npm_package`);\n \n   // Create the output directory.\n   const absDestPath = resolve(baseDir, destPath);\n@@ -46,6 +46,10 @@ function buildZoneJsPackage(destPath) {\n   const buildOutputDir = `${bazelBin}/packages/zone.js/npm_package`;\n   const distTargetDir = `${absDestPath}/zone.js`;\n \n+  // Also create an archive so we can test the package itself.\n+  // Currently, the `npm_package.pack` rule does not work on Windows, so run `npm pack` directly.\n+  exec(`npm pack ${buildOutputDir}`, false, {cwd: baseDir});\n+\n   console.info(`# Copy npm_package artifacts to ${distTargetDir}`);\n   rm('-rf', distTargetDir);\n   cp('-R', buildOutputDir, distTargetDir);"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
    }
}