{
    "author": "anandtiwary",
    "message": "feat(router): new output that would notify when link is activated (#43280)\n\nThis commit adds a new output to `routerLinkActive` directive.\nWhenever, the associated link becomes active or inactive, an\nevent will be fired on this out with the correct status\n\nPR Close #37284\n\nPR Close #43280",
    "sha": "faf9f5a3bc444bb6cbf75916c8022f60e0742bca",
    "files": [
        {
            "sha": "96c07c34f2582f54fd1357657e30d87a2edb40a1",
            "filename": "goldens/public-api/router/router.md",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/faf9f5a3bc444bb6cbf75916c8022f60e0742bca/goldens%2Fpublic-api%2Frouter%2Frouter.md",
            "raw_url": "https://github.com/angular/angular/raw/faf9f5a3bc444bb6cbf75916c8022f60e0742bca/goldens%2Fpublic-api%2Frouter%2Frouter.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Frouter%2Frouter.md?ref=faf9f5a3bc444bb6cbf75916c8022f60e0742bca",
            "patch": "@@ -549,6 +549,7 @@ export class RouterLinkActive implements OnChanges, OnDestroy, AfterContentInit\n     constructor(router: Router, element: ElementRef, renderer: Renderer2, cdr: ChangeDetectorRef, link?: RouterLink | undefined, linkWithHref?: RouterLinkWithHref | undefined);\n     // (undocumented)\n     readonly isActive: boolean;\n+    readonly isActiveChange: EventEmitter<boolean>;\n     // (undocumented)\n     links: QueryList<RouterLink>;\n     // (undocumented)"
        },
        {
            "sha": "f19619fd95d0fb5cec8b1421b077f9c29462fb30",
            "filename": "packages/router/src/directives/router_link_active.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 1,
            "changes": 22,
            "blob_url": "https://github.com/angular/angular/blob/faf9f5a3bc444bb6cbf75916c8022f60e0742bca/packages%2Frouter%2Fsrc%2Fdirectives%2Frouter_link_active.ts",
            "raw_url": "https://github.com/angular/angular/raw/faf9f5a3bc444bb6cbf75916c8022f60e0742bca/packages%2Frouter%2Fsrc%2Fdirectives%2Frouter_link_active.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Fdirectives%2Frouter_link_active.ts?ref=faf9f5a3bc444bb6cbf75916c8022f60e0742bca",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {AfterContentInit, ChangeDetectorRef, ContentChildren, Directive, ElementRef, Input, OnChanges, OnDestroy, Optional, QueryList, Renderer2, SimpleChanges} from '@angular/core';\n+import {AfterContentInit, ChangeDetectorRef, ContentChildren, Directive, ElementRef, EventEmitter, Input, OnChanges, OnDestroy, Optional, Output, QueryList, Renderer2, SimpleChanges} from '@angular/core';\n import {from, of, Subscription} from 'rxjs';\n import {mergeAll} from 'rxjs/operators';\n \n@@ -99,6 +99,23 @@ export class RouterLinkActive implements OnChanges, OnDestroy, AfterContentInit\n    */\n   @Input() routerLinkActiveOptions: {exact: boolean}|IsActiveMatchOptions = {exact: false};\n \n+  /**\n+   *\n+   * You can use the output `isActiveChange` to get notified each time the link becomes\n+   * active or inactive.\n+   *\n+   * Emits:\n+   * true  -> Route is active\n+   * false -> Route is inactive\n+   *\n+   * ```\n+   * <a\n+   *  routerLink=\"/user/bob\"\n+   *  routerLinkActive=\"active-link\"\n+   *  (isActiveChange)=\"this.onRouterLinkActive($event)\">Bob</a>\n+   * ```\n+   */\n+  @Output() readonly isActiveChange: EventEmitter<boolean> = new EventEmitter();\n \n   constructor(\n       private router: Router, private element: ElementRef, private renderer: Renderer2,\n@@ -163,6 +180,9 @@ export class RouterLinkActive implements OnChanges, OnDestroy, AfterContentInit\n             this.renderer.removeClass(this.element.nativeElement, c);\n           }\n         });\n+\n+        // Emit on isActiveChange after classes are updated\n+        this.isActiveChange.emit(hasActiveLinks);\n       }\n     });\n   }"
        },
        {
            "sha": "c224d3deac9d975ae096f196ceada013ec41c8bb",
            "filename": "packages/router/test/integration.spec.ts",
            "status": "modified",
            "additions": 45,
            "deletions": 1,
            "changes": 46,
            "blob_url": "https://github.com/angular/angular/blob/faf9f5a3bc444bb6cbf75916c8022f60e0742bca/packages%2Frouter%2Ftest%2Fintegration.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/faf9f5a3bc444bb6cbf75916c8022f60e0742bca/packages%2Frouter%2Ftest%2Fintegration.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fintegration.spec.ts?ref=faf9f5a3bc444bb6cbf75916c8022f60e0742bca",
            "patch": "@@ -4662,6 +4662,44 @@ describe('Integration', () => {\n          fixture.detectChanges(false /** checkNoChanges */);\n          expect(TestBed.inject(NgZone).hasPendingMicrotasks).toBe(false);\n        }));\n+\n+    it('should emit on isActiveChange output when link is activated or inactivated',\n+       fakeAsync(inject([Router, Location], (router: Router, location: Location) => {\n+         const fixture = createRoot(router, RootCmp);\n+\n+         router.resetConfig([{\n+           path: 'team/:id',\n+           component: TeamCmp,\n+           children: [{\n+             path: 'link',\n+             component: DummyLinkCmp,\n+             children: [{path: 'simple', component: SimpleCmp}, {path: '', component: BlankCmp}]\n+           }]\n+         }]);\n+\n+         router.navigateByUrl('/team/22/link;exact=true');\n+         advance(fixture);\n+         advance(fixture);\n+         expect(location.path()).toEqual('/team/22/link;exact=true');\n+\n+         const linkComponent =\n+             fixture.debugElement.query(By.directive(DummyLinkCmp)).componentInstance as\n+             DummyLinkCmp;\n+\n+         expect(linkComponent.isLinkActivated).toEqual(true);\n+         const nativeLink = fixture.nativeElement.querySelector('a');\n+         const nativeButton = fixture.nativeElement.querySelector('button');\n+         expect(nativeLink.className).toEqual('active');\n+         expect(nativeButton.className).toEqual('active');\n+\n+\n+         router.navigateByUrl('/team/22/link/simple');\n+         advance(fixture);\n+         expect(location.path()).toEqual('/team/22/link/simple');\n+         expect(linkComponent.isLinkActivated).toEqual(false);\n+         expect(nativeLink.className).toEqual('');\n+         expect(nativeButton.className).toEqual('');\n+       })));\n   });\n \n   describe('lazy loading', () => {\n@@ -5928,15 +5966,21 @@ class AbsoluteLinkCmp {\n @Component({\n   selector: 'link-cmp',\n   template:\n-      `<router-outlet></router-outlet><a routerLinkActive=\"active\" [routerLinkActiveOptions]=\"{exact: exact}\" [routerLink]=\"['./']\">link</a>\n+      `<router-outlet></router-outlet><a routerLinkActive=\"active\" (isActiveChange)=\"this.onRouterLinkActivated($event)\" [routerLinkActiveOptions]=\"{exact: exact}\" [routerLink]=\"['./']\">link</a>\n  <button routerLinkActive=\"active\" [routerLinkActiveOptions]=\"{exact: exact}\" [routerLink]=\"['./']\">button</button>\n  `\n })\n class DummyLinkCmp {\n   private exact: boolean;\n+  public isLinkActivated?: boolean;\n+\n   constructor(route: ActivatedRoute) {\n     this.exact = route.snapshot.paramMap.get('exact') === 'true';\n   }\n+\n+  public onRouterLinkActivated(isActive: boolean): void {\n+    this.isLinkActivated = isActive;\n+  }\n }\n \n @Component({selector: 'link-cmp', template: `<a [routerLink]=\"['/simple']\">link</a>`})"
        }
    ],
    "stats": {
        "total": 69,
        "additions": 67,
        "deletions": 2
    }
}