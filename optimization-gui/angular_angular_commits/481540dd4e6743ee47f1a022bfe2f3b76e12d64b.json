{
    "author": "JoostK",
    "message": "test(compiler-cli): load type declarations from fake_common (#41995)\n\nThe ngtsc test targets have fake declarations files for `@angular/core`\nand `@angular/common` and the template type checking tests can leverage\nthe fake common declarations instead of declaring its own types.\n\nPR Close #41995",
    "sha": "481540dd4e6743ee47f1a022bfe2f3b76e12d64b",
    "files": [
        {
            "sha": "da99030fb72cbb48d48d8238fdeeabe16fc4f0ba",
            "filename": "packages/compiler-cli/src/ngtsc/testing/fake_common/index.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 2,
            "changes": 13,
            "blob_url": "https://github.com/angular/angular/blob/481540dd4e6743ee47f1a022bfe2f3b76e12d64b/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Ffake_common%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/481540dd4e6743ee47f1a022bfe2f3b76e12d64b/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Ffake_common%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Ffake_common%2Findex.ts?ref=481540dd4e6743ee47f1a022bfe2f3b76e12d64b",
            "patch": "@@ -56,6 +56,7 @@ export declare class NgIf<T = unknown> {\n     'ngIfElse': 'ngIfElse';\n   }\n   , {}, never > ;\n+  static ngTemplateGuard_ngIf: 'binding';\n   static ngTemplateContextGuard<T>(dir: NgIf<T>, ctx: any):\n       ctx is NgIfContext<Exclude<T, false|0|''|null|undefined>>;\n }\n@@ -83,8 +84,16 @@ export declare class DatePipe {\n   static ɵpipe: ɵɵPipeDeclaration<DatePipe, 'date'>;\n }\n \n+export declare class IndexPipe {\n+  transform<T>(value: T[], index: number): T;\n+\n+  static ɵpipe: ɵɵPipeDeclaration<IndexPipe, 'index'>;\n+}\n+\n export declare class CommonModule {\n   static ɵmod: ɵɵNgModuleDeclaration<\n-      CommonModule, [typeof NgForOf, typeof NgIf, typeof DatePipe, typeof NgTemplateOutlet], never,\n-      [typeof NgForOf, typeof NgIf, typeof DatePipe, typeof NgTemplateOutlet]>;\n+      CommonModule,\n+      [typeof NgForOf, typeof NgIf, typeof DatePipe, typeof IndexPipe, typeof NgTemplateOutlet],\n+      never,\n+      [typeof NgForOf, typeof NgIf, typeof DatePipe, typeof IndexPipe, typeof NgTemplateOutlet]>;\n }"
        },
        {
            "sha": "328c699f6b5f4e250bd9d78004d30691749d51d4",
            "filename": "packages/compiler-cli/test/ngtsc/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/481540dd4e6743ee47f1a022bfe2f3b76e12d64b/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/481540dd4e6743ee47f1a022bfe2f3b76e12d64b/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2FBUILD.bazel?ref=481540dd4e6743ee47f1a022bfe2f3b76e12d64b",
            "patch": "@@ -26,6 +26,7 @@ jasmine_node_test(\n     timeout = \"long\",\n     bootstrap = [\"//tools/testing:node_no_angular_es5\"],\n     data = [\n+        \"//packages/compiler-cli/src/ngtsc/testing/fake_common:npm_package\",\n         \"//packages/compiler-cli/src/ngtsc/testing/fake_core:npm_package\",\n     ],\n     shard_count = 4,"
        },
        {
            "sha": "ce9bc10924749f7b77a5089ee0e6308c208e5737",
            "filename": "packages/compiler-cli/test/ngtsc/template_typecheck_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 61,
            "changes": 62,
            "blob_url": "https://github.com/angular/angular/blob/481540dd4e6743ee47f1a022bfe2f3b76e12d64b/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Ftemplate_typecheck_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/481540dd4e6743ee47f1a022bfe2f3b76e12d64b/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Ftemplate_typecheck_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Ftemplate_typecheck_spec.ts?ref=481540dd4e6743ee47f1a022bfe2f3b76e12d64b",
            "patch": "@@ -15,7 +15,7 @@ import {expectCompleteReuse, loadStandardTestFiles} from '../../src/ngtsc/testin\n \n import {NgtscTestEnvironment} from './env';\n \n-const testFiles = loadStandardTestFiles();\n+const testFiles = loadStandardTestFiles({fakeCore: true, fakeCommon: true});\n \n runInEachFileSystem(() => {\n   describe('ngtsc type checking', () => {\n@@ -24,66 +24,6 @@ runInEachFileSystem(() => {\n     beforeEach(() => {\n       env = NgtscTestEnvironment.setup(testFiles);\n       env.tsconfig({fullTemplateTypeCheck: true});\n-      env.write('node_modules/@angular/common/index.d.ts', `\n-import * as i0 from '@angular/core';\n-\n-export declare class NgForOfContext<T, U extends i0.NgIterable<T> = i0.NgIterable<T>> {\n-  $implicit: T;\n-  count: number;\n-  readonly even: boolean;\n-  readonly first: boolean;\n-  index: number;\n-  readonly last: boolean;\n-  ngForOf: U;\n-  readonly odd: boolean;\n-  constructor($implicit: T, ngForOf: U, index: number, count: number);\n-}\n-\n-export declare class IndexPipe {\n-  transform<T>(value: T[], index: number): T;\n-\n-  static ɵpipe: i0.ɵPipeDeclaration<IndexPipe, 'index'>;\n-}\n-\n-export declare class SlicePipe {\n-  transform<T>(value: ReadonlyArray<T>, start: number, end?: number): Array<T>;\n-  transform(value: string, start: number, end?: number): string;\n-  transform(value: null, start: number, end?: number): null;\n-  transform(value: undefined, start: number, end?: number): undefined;\n-  transform(value: any, start: number, end?: number): any;\n-\n-  static ɵpipe: i0.ɵPipeDeclaration<SlicePipe, 'slice'>;\n-}\n-\n-export declare class NgForOf<T, U extends i0.NgIterable<T> = i0.NgIterable<T>> implements DoCheck {\n-  ngForOf: (U & i0.NgIterable<T>) | undefined | null;\n-  ngForTemplate: TemplateRef<NgForOfContext<T, U>>;\n-  ngForTrackBy: TrackByFunction<T>;\n-  constructor(_viewContainer: ViewContainerRef, _template: TemplateRef<NgForOfContext<T, U>>, _differs: IterableDiffers);\n-  ngDoCheck(): void;\n-  static ngTemplateContextGuard<T, U extends i0.NgIterable<T>>(dir: NgForOf<T, U>, ctx: any): ctx is NgForOfContext<T, U>;\n-  static ɵdir: i0.ɵɵDirectiveDeclaration<NgForOf<any>, '[ngFor][ngForOf]', never, {'ngForOf': 'ngForOf'}, {}, never>;\n-}\n-\n-export declare class NgIf<T = unknown> {\n-  ngIf: T;\n-  ngIfElse: TemplateRef<NgIfContext<T>> | null;\n-  ngIfThen: TemplateRef<NgIfContext<T>> | null;\n-  constructor(_viewContainer: ViewContainerRef, templateRef: TemplateRef<NgIfContext<T>>);\n-  static ngTemplateGuard_ngIf: 'binding';\n-  static ngTemplateContextGuard<T>(dir: NgIf<T>, ctx: any): ctx is NgIfContext<Exclude<T, false | 0 | \"\" | null | undefined>>;\n-  static ɵdir: i0.ɵɵDirectiveDeclaration<NgIf<any>, '[ngIf]', never, {'ngIf': 'ngIf'}, {}, never>;\n-}\n-\n-export declare class NgIfContext<T = unknown> {\n-  $implicit: T;\n-  ngIf: T;\n-}\n-\n-export declare class CommonModule {\n-  static ɵmod: i0.ɵɵNgModuleDeclaration<CommonModule, [typeof NgIf, typeof NgForOf, typeof IndexPipe, typeof SlicePipe], never, [typeof NgIf, typeof NgForOf, typeof IndexPipe, typeof SlicePipe]>;\n-}\n-`);\n       env.write('node_modules/@angular/animations/index.d.ts', `\n export declare class AnimationEvent {\n   element: any;"
        }
    ],
    "stats": {
        "total": 76,
        "additions": 13,
        "deletions": 63
    }
}