{
    "author": "josephperrott",
    "message": "ci: use larger resource classes for bazel builds (#39124)\n\nMigrates to using larger resource classes for windows CI runs as well as updating\nthe bazel rcs for windows and linux to use all/more of the resources available in\nthe executors\n\nPR Close #39124",
    "sha": "ee03408c4417ced00cb39791f88fdce2511dc4d8",
    "files": [
        {
            "sha": "9bbc339b2004a18048b1409a62faa8c637bef206",
            "filename": ".circleci/bazel.linux.rc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/ee03408c4417ced00cb39791f88fdce2511dc4d8/.circleci%2Fbazel.linux.rc",
            "raw_url": "https://github.com/angular/angular/raw/ee03408c4417ced00cb39791f88fdce2511dc4d8/.circleci%2Fbazel.linux.rc",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/.circleci%2Fbazel.linux.rc?ref=ee03408c4417ced00cb39791f88fdce2511dc4d8",
            "patch": "@@ -14,8 +14,8 @@ build --repository_cache=/home/circleci/bazel_repository_cache\n # Bazel doesn't calculate the memory ceiling correctly when running under Docker.\n # Limit Bazel to consuming resources that fit in CircleCI \"xlarge\" class\n # https://circleci.com/docs/2.0/configuration-reference/#resource_class\n-build --local_cpu_resources=8\n-build --local_ram_resources=14336\n+build --local_cpu_resources=20\n+build --local_ram_resources=32768\n \n # All build executed remotely should be done using our RBE configuration.\n build:remote --google_default_credentials"
        },
        {
            "sha": "4e2378b43cc5b902c98a207686f4df1d07039634",
            "filename": ".circleci/bazel.windows.rc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/ee03408c4417ced00cb39791f88fdce2511dc4d8/.circleci%2Fbazel.windows.rc",
            "raw_url": "https://github.com/angular/angular/raw/ee03408c4417ced00cb39791f88fdce2511dc4d8/.circleci%2Fbazel.windows.rc",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/.circleci%2Fbazel.windows.rc?ref=ee03408c4417ced00cb39791f88fdce2511dc4d8",
            "patch": "@@ -11,8 +11,8 @@ try-import %workspace%/.circleci/bazel.common.rc\n build --repository_cache=C:/Users/circleci/bazel_repository_cache\n \n # Manually set the local resources used in windows CI runs\n-build --local_ram_resources=13500\n-build --local_cpu_resources=4\n+build --local_ram_resources=120000\n+build --local_cpu_resources=32\n \n # All windows jobs run on master and should use http caching\n build --remote_http_cache=https://storage.googleapis.com/angular-team-cache"
        },
        {
            "sha": "4d208c6250c9aa62e0d97d7f1d74e19d423070b2",
            "filename": ".circleci/config.yml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/ee03408c4417ced00cb39791f88fdce2511dc4d8/.circleci%2Fconfig.yml",
            "raw_url": "https://github.com/angular/angular/raw/ee03408c4417ced00cb39791f88fdce2511dc4d8/.circleci%2Fconfig.yml",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/.circleci%2Fconfig.yml?ref=ee03408c4417ced00cb39791f88fdce2511dc4d8",
            "patch": "@@ -80,7 +80,7 @@ executors:\n \n   windows-executor:\n     working_directory: ~/ng\n-    resource_class: windows.medium\n+    resource_class: windows.2xlarge\n     # CircleCI windows VMs do have the GitBash shell available:\n     # https://github.com/CircleCI-Public/windows-preview-docs#shells\n     # But in this specific case we really should not use it because Bazel must not be ran from"
        },
        {
            "sha": "c0a06787365085d8cf2bb3ad2fde7f2c1c1c0bce",
            "filename": ".circleci/windows-env.ps1",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/ee03408c4417ced00cb39791f88fdce2511dc4d8/.circleci%2Fwindows-env.ps1",
            "raw_url": "https://github.com/angular/angular/raw/ee03408c4417ced00cb39791f88fdce2511dc4d8/.circleci%2Fwindows-env.ps1",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/.circleci%2Fwindows-env.ps1?ref=ee03408c4417ced00cb39791f88fdce2511dc4d8",
            "patch": "@@ -41,7 +41,8 @@ copy .circleci\\bazel.windows.rc ${Env:USERPROFILE}\\.bazelrc\n ####################################################################################################\n # Install specific version of node.\n ####################################################################################################\n-choco install nodejs --version 12.14.1 --no-progress\n+nvm install 12.14.1\n+nvm use 12.14.1\n \n # These Bazel prereqs aren't needed because the CircleCI image already includes them.\n # choco install yarn --version 1.16.0 --no-progress"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 7,
        "deletions": 6
    }
}