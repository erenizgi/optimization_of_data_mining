{
    "author": "peruukki",
    "message": "fix(core): determine required DOMParser feature availability (#36578) (#36578)\n\nVerify that HTML parsing is supported in addition to DOMParser existence.\nThis maybe wasn't as important before when DOMParser was used just as a\nfallback on Firefox, but now that DOMParser is the default choice, we need\nto be more accurate.\n\nPR Close #36578",
    "sha": "c509243af58e64293b16baf518494d9ca508d9e2",
    "files": [
        {
            "sha": "62c6598df8a70db68b2e34b1f4c455e74ee26e65",
            "filename": "packages/core/src/sanitization/inert_body.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/c509243af58e64293b16baf518494d9ca508d9e2/packages%2Fcore%2Fsrc%2Fsanitization%2Finert_body.ts",
            "raw_url": "https://github.com/angular/angular/raw/c509243af58e64293b16baf518494d9ca508d9e2/packages%2Fcore%2Fsrc%2Fsanitization%2Finert_body.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Fsanitization%2Finert_body.ts?ref=c509243af58e64293b16baf518494d9ca508d9e2",
            "patch": "@@ -120,15 +120,15 @@ class InertDocumentHelper implements InertBodyHelper {\n }\n \n /**\n- * We need to determine whether the DOMParser exists in the global context.\n- * The try-catch is because, on some browsers, trying to access this property\n- * on window can actually throw an error.\n+ * We need to determine whether the DOMParser exists in the global context and\n+ * supports parsing HTML; HTML parsing support is not as wide as other formats, see\n+ * https://developer.mozilla.org/en-US/docs/Web/API/DOMParser#Browser_compatibility.\n  *\n  * @suppress {uselessCode}\n  */\n-function isDOMParserAvailable() {\n+export function isDOMParserAvailable() {\n   try {\n-    return !!(window as any).DOMParser;\n+    return !!new (window as any).DOMParser().parseFromString('', 'text/html');\n   } catch {\n     return false;\n   }"
        },
        {
            "sha": "dc83ca31f53d367f6dddf91868f206d4473bc3a5",
            "filename": "packages/core/test/sanitization/html_sanitizer_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 15,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/c509243af58e64293b16baf518494d9ca508d9e2/packages%2Fcore%2Ftest%2Fsanitization%2Fhtml_sanitizer_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c509243af58e64293b16baf518494d9ca508d9e2/packages%2Fcore%2Ftest%2Fsanitization%2Fhtml_sanitizer_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Fsanitization%2Fhtml_sanitizer_spec.ts?ref=c509243af58e64293b16baf518494d9ca508d9e2",
            "patch": "@@ -9,6 +9,7 @@\n import {browserDetection} from '@angular/platform-browser/testing/src/browser_util';\n \n import {_sanitizeHtml} from '../../src/sanitization/html_sanitizer';\n+import {isDOMParserAvailable} from '../../src/sanitization/inert_body';\n \n {\n   describe('HTML sanitizer', () => {\n@@ -229,18 +230,3 @@ import {_sanitizeHtml} from '../../src/sanitization/html_sanitizer';\n     }\n   });\n }\n-\n-/**\n- * We need to determine whether the DOMParser exists in the global context.\n- * The try-catch is because, on some browsers, trying to access this property\n- * on window can actually throw an error.\n- *\n- * @suppress {uselessCode}\n- */\n-function isDOMParserAvailable() {\n-  try {\n-    return !!(window as any).DOMParser;\n-  } catch (e) {\n-    return false;\n-  }\n-}"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 6,
        "deletions": 20
    }
}