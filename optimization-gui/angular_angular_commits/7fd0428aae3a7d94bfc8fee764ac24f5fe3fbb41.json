{
    "author": "crisbeto",
    "message": "fix(core): don't rethrow errors if test teardown has been disabled (#43635)\n\nFixes that the current logic was set up so that error rethrowing was enabled even when teardown is disabled.\n\nPR Close #43635",
    "sha": "7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41",
    "files": [
        {
            "sha": "49c72c226cbe692dc70b0f15ad4436480de591d4",
            "filename": "packages/core/test/test_bed_spec.ts",
            "status": "modified",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/angular/angular/blob/7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41/packages%2Fcore%2Ftest%2Ftest_bed_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41/packages%2Fcore%2Ftest%2Ftest_bed_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Ftest_bed_spec.ts?ref=7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41",
            "patch": "@@ -12,6 +12,7 @@ import {By} from '@angular/platform-browser';\n import {expect} from '@angular/platform-browser/testing/src/matchers';\n import {onlyInIvy} from '@angular/private/testing';\n import {TestBedRender3} from '../testing/src/r3_test_bed';\n+import {TEARDOWN_TESTING_MODULE_ON_DESTROY_DEFAULT} from '../testing/src/test_bed_common';\n \n const NAME = new InjectionToken<string>('name');\n \n@@ -1528,4 +1529,28 @@ describe('TestBed module teardown', () => {\n     TestBed.resetTestingModule();\n     expect(fixtureDocument.body.contains(fixture.nativeElement)).toBe(false);\n   });\n+\n+  it('should rethrow errors based on the default teardown behavior', () => {\n+    expect(TestBed.shouldRethrowTeardownErrors()).toBe(TEARDOWN_TESTING_MODULE_ON_DESTROY_DEFAULT);\n+  });\n+\n+  it('should rethrow errors if the option is omitted and test teardown is enabled', () => {\n+    TestBed.configureTestingModule({teardown: {destroyAfterEach: true}});\n+    expect(TestBed.shouldRethrowTeardownErrors()).toBe(true);\n+  });\n+\n+  it('should not rethrow errors if the option is omitted and test teardown is disabled', () => {\n+    TestBed.configureTestingModule({teardown: {destroyAfterEach: false}});\n+    expect(TestBed.shouldRethrowTeardownErrors()).toBe(false);\n+  });\n+\n+  it('should rethrow errors if the option is enabled, but teardown is disabled', () => {\n+    TestBed.configureTestingModule({teardown: {destroyAfterEach: false, rethrowErrors: true}});\n+    expect(TestBed.shouldRethrowTeardownErrors()).toBe(true);\n+  });\n+\n+  it('should not rethrow errors if the option is disabled, but teardown is enabled', () => {\n+    TestBed.configureTestingModule({teardown: {destroyAfterEach: true, rethrowErrors: false}});\n+    expect(TestBed.shouldRethrowTeardownErrors()).toBe(false);\n+  });\n });"
        },
        {
            "sha": "25347e39be7e4e5b09d1cb1cd5b18c0adf8a1b2a",
            "filename": "packages/core/testing/src/r3_test_bed.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41/packages%2Fcore%2Ftesting%2Fsrc%2Fr3_test_bed.ts",
            "raw_url": "https://github.com/angular/angular/raw/7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41/packages%2Fcore%2Ftesting%2Fsrc%2Fr3_test_bed.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftesting%2Fsrc%2Fr3_test_bed.ts?ref=7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41",
            "patch": "@@ -469,17 +469,18 @@ export class TestBedRender3 implements TestBed {\n     }\n   }\n \n-  private shouldRethrowTeardownErrors() {\n+  shouldRethrowTeardownErrors() {\n     const instanceOptions = this._instanceTeardownOptions;\n     const environmentOptions = TestBedRender3._environmentTeardownOptions;\n \n     // If the new teardown behavior hasn't been configured, preserve the old behavior.\n     if (!instanceOptions && !environmentOptions) {\n-      return false;\n+      return TEARDOWN_TESTING_MODULE_ON_DESTROY_DEFAULT;\n     }\n \n     // Otherwise use the configured behavior or default to rethrowing.\n-    return instanceOptions?.rethrowErrors ?? environmentOptions?.rethrowErrors ?? true;\n+    return instanceOptions?.rethrowErrors ?? environmentOptions?.rethrowErrors ??\n+        this.shouldTearDownTestingModule();\n   }\n \n   shouldTearDownTestingModule(): boolean {"
        },
        {
            "sha": "06d45690aca8799ce4be256b266c0024f2be2db6",
            "filename": "packages/core/testing/src/test_bed.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41/packages%2Fcore%2Ftesting%2Fsrc%2Ftest_bed.ts",
            "raw_url": "https://github.com/angular/angular/raw/7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41/packages%2Fcore%2Ftesting%2Fsrc%2Ftest_bed.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftesting%2Fsrc%2Ftest_bed.ts?ref=7fd0428aae3a7d94bfc8fee764ac24f5fe3fbb41",
            "patch": "@@ -694,17 +694,18 @@ export class TestBedViewEngine implements TestBed {\n     }\n   }\n \n-  private shouldRethrowTeardownErrors() {\n+  shouldRethrowTeardownErrors() {\n     const instanceOptions = this._instanceTeardownOptions;\n     const environmentOptions = TestBedViewEngine._environmentTeardownOptions;\n \n     // If the new teardown behavior hasn't been configured, preserve the old behavior.\n     if (!instanceOptions && !environmentOptions) {\n-      return false;\n+      return TEARDOWN_TESTING_MODULE_ON_DESTROY_DEFAULT;\n     }\n \n     // Otherwise use the configured behavior or default to rethrowing.\n-    return instanceOptions?.rethrowErrors ?? environmentOptions?.rethrowErrors ?? true;\n+    return instanceOptions?.rethrowErrors ?? environmentOptions?.rethrowErrors ??\n+        this.shouldTearDownTestingModule();\n   }\n \n   shouldTearDownTestingModule(): boolean {"
        }
    ],
    "stats": {
        "total": 39,
        "additions": 33,
        "deletions": 6
    }
}