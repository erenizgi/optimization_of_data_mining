{
    "author": "josephperrott",
    "message": "feat(dev-infra): allow suppression of `GitClient`s verbose logging (#39474)\n\nSome usages of the `GitClient` are better served by suppressing the\nlogging of lines that express what commands are being run. Many usages\nof `GitClient` are contained within tools which are best served by\nkeeping the output clean as mostly read actions are occurring.\n\nPR Close #39474",
    "sha": "af8e547d86e810ea1a1d38f6a586a5c1ea091781",
    "files": [
        {
            "sha": "7880f99a68e9c5dbb279ae77b00ab5ff86bce070",
            "filename": "dev-infra/ng-dev.js",
            "status": "modified",
            "additions": 8,
            "deletions": 9,
            "changes": 17,
            "blob_url": "https://github.com/angular/angular/blob/af8e547d86e810ea1a1d38f6a586a5c1ea091781/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/af8e547d86e810ea1a1d38f6a586a5c1ea091781/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=af8e547d86e810ea1a1d38f6a586a5c1ea091781",
            "patch": "@@ -502,7 +502,7 @@ var GithubApiRequestError = /** @class */ (function (_super) {\n var GithubClient = /** @class */ (function (_super) {\n     tslib.__extends(GithubClient, _super);\n     function GithubClient(token) {\n-        var _this = \n+        var _this =\n         // Pass in authentication token to base Octokit class.\n         _super.call(this, { auth: token }) || this;\n         /** The current user based on checking against the Github API. */\n@@ -581,7 +581,7 @@ var GithubGraphqlClient = /** @class */ (function () {\n var GitCommandError = /** @class */ (function (_super) {\n     tslib.__extends(GitCommandError, _super);\n     function GitCommandError(client, args) {\n-        var _this = \n+        var _this =\n         // Errors are not guaranteed to be caught. To ensure that we don't\n         // accidentally leak the Github token that might be used in a command,\n         // we sanitize the command that will be part of the error message.\n@@ -647,14 +647,13 @@ var GitClient = /** @class */ (function () {\n     GitClient.prototype.runGraceful = function (args, options) {\n         if (options === void 0) { options = {}; }\n         // To improve the debugging experience in case something fails, we print all executed Git\n-        // commands unless the `stdio` is explicitly set to `ignore` (which is equivalent to silent).\n+        // commands to better understand the git actions occuring. Depending on the command being\n+        // executed, this debugging information should be logged at different logging levels.\n+        var printFn = (!GitClient.LOG_COMMANDS || options.stdio === 'ignore') ? debug : info;\n         // Note that we do not want to print the token if it is contained in the command. It's common\n         // to share errors with others if the tool failed, and we do not want to leak tokens.\n-        // TODO: Add support for configuring this on a per-client basis. Some tools do not want\n-        // to print the Git command messages to the console at all (e.g. to maintain clean output).\n-        var printFn = options.stdio !== 'ignore' ? info : debug;\n         printFn('Executing: git', this.omitGithubTokenFromMessage(args.join(' ')));\n-        var result = child_process.spawnSync('git', args, tslib.__assign(tslib.__assign({ cwd: this._projectRoot, stdio: 'pipe' }, options), { \n+        var result = child_process.spawnSync('git', args, tslib.__assign(tslib.__assign({ cwd: this._projectRoot, stdio: 'pipe' }, options), {\n             // Encoding is always `utf8` and not overridable. This ensures that this method\n             // always returns `string` as output instead of buffers.\n             encoding: 'utf8' }));\n@@ -792,7 +791,7 @@ function getCaretakerConfig() {\n class ReleaseTrain {\n     constructor(\n     /** Name of the branch for this release-train. */\n-    branchName, \n+    branchName,\n     /** Most recent version for this release train. */\n     version) {\n         this.branchName = branchName;\n@@ -3050,7 +3049,7 @@ function validateMergeConfig(config) {\n var PullRequestFailure = /** @class */ (function () {\n     function PullRequestFailure(\n     /** Human-readable message for the failure */\n-    message, \n+    message,\n     /** Whether the failure is non-fatal and can be forcibly ignored. */\n     nonFatal) {\n         if (nonFatal === void 0) { nonFatal = false; }"
        },
        {
            "sha": "8c4dbc6e4c24dfd4c31e719ae2b131fb0794bf8c",
            "filename": "dev-infra/utils/git/index.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 4,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/af8e547d86e810ea1a1d38f6a586a5c1ea091781/dev-infra%2Futils%2Fgit%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/af8e547d86e810ea1a1d38f6a586a5c1ea091781/dev-infra%2Futils%2Fgit%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2Fgit%2Findex.ts?ref=af8e547d86e810ea1a1d38f6a586a5c1ea091781",
            "patch": "@@ -42,6 +42,8 @@ export class GitCommandError extends Error {\n  *     the dev-infra configuration is loaded with its Github configuration.\n  **/\n export class GitClient {\n+  /** Whether verbose logging of Git actions should be used. */\n+  static LOG_COMMANDS = true;\n   /** Short-hand for accessing the default remote configuration. */\n   remoteConfig = this._config.github;\n   /** Octokit request parameters object for targeting the configured remote. */\n@@ -88,12 +90,11 @@ export class GitClient {\n    */\n   runGraceful(args: string[], options: SpawnSyncOptions = {}): SpawnSyncReturns<string> {\n     // To improve the debugging experience in case something fails, we print all executed Git\n-    // commands unless the `stdio` is explicitly set to `ignore` (which is equivalent to silent).\n+    // commands to better understand the git actions occuring. Depending on the command being\n+    // executed, this debugging information should be logged at different logging levels.\n+    const printFn = (!GitClient.LOG_COMMANDS || options.stdio === 'ignore') ? debug : info;\n     // Note that we do not want to print the token if it is contained in the command. It's common\n     // to share errors with others if the tool failed, and we do not want to leak tokens.\n-    // TODO: Add support for configuring this on a per-client basis. Some tools do not want\n-    // to print the Git command messages to the console at all (e.g. to maintain clean output).\n-    const printFn = options.stdio !== 'ignore' ? info : debug;\n     printFn('Executing: git', this.omitGithubTokenFromMessage(args.join(' ')));\n \n     const result = spawnSync('git', args, {"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 13,
        "deletions": 13
    }
}