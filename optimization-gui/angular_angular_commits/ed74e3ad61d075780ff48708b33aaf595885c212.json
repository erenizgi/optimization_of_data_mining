{
    "author": "dgp1130",
    "message": "refactor(compiler-cli): add `ExtendedTemplateDiagnosticName` and `TemplateCheckFactory` (#44391)\n\nRefs #42966.\n\nThe enum of extended template diagnostic names allows a global registry of first-party diagnostics with a developer-friendly string name which can be used for configuration. This name is used in the new `TemplateCheckFactory` to bind the name to a particular `ErrorCode` and make both available *before* constructing the actual template check, which is necessary to configure it appropriately.\n\nPR Close #44391",
    "sha": "ed74e3ad61d075780ff48708b33aaf595885c212",
    "files": [
        {
            "sha": "0a99fb4dca154f65520f3bdb52472be10c905f34",
            "filename": "goldens/public-api/compiler-cli/extended_template_diagnostic_name.md",
            "status": "added",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/goldens%2Fpublic-api%2Fcompiler-cli%2Fextended_template_diagnostic_name.md",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/goldens%2Fpublic-api%2Fcompiler-cli%2Fextended_template_diagnostic_name.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fcompiler-cli%2Fextended_template_diagnostic_name.md?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -0,0 +1,17 @@\n+## API Report File for \"angular-srcs\"\n+\n+> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).\n+\n+```ts\n+\n+// @public\n+export enum ExtendedTemplateDiagnosticName {\n+    // (undocumented)\n+    INVALID_BANANA_IN_BOX = \"invalidBananaInBox\",\n+    // (undocumented)\n+    NULLISH_COALESCING_NOT_NULLABLE = \"nullishCoalescingNotNullable\"\n+}\n+\n+// (No @packageDocumentation comment for this package)\n+\n+```"
        },
        {
            "sha": "271e538575c2c77fce109b629f1f7c197703eba1",
            "filename": "packages/compiler-cli/BUILD.bazel",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2FBUILD.bazel?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -152,6 +152,16 @@ api_golden_test(\n     golden = \"angular/goldens/public-api/compiler-cli/error_code.md\",\n )\n \n+api_golden_test(\n+    name = \"extended_template_diagnostic_name_api\",\n+    data = [\n+        \":npm_package\",\n+        \"//goldens:public-api\",\n+    ],\n+    entry_point = \"angular/packages/compiler-cli/npm_package/src/ngtsc/diagnostics/src/extended_template_diagnostic_name.d.ts\",\n+    golden = \"angular/goldens/public-api/compiler-cli/extended_template_diagnostic_name.md\",\n+)\n+\n api_golden_test(\n     name = \"compiler_options_api\",\n     data = ["
        },
        {
            "sha": "f0b07691e38ef243817898d307f3de7a2dc0d42e",
            "filename": "packages/compiler-cli/src/ngtsc/core/src/compiler.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Fsrc%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Fsrc%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Fsrc%2Fcompiler.ts?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -30,8 +30,8 @@ import {TemplateTypeCheckerImpl} from '../../typecheck';\n import {OptimizeFor, TemplateTypeChecker, TypeCheckingConfig} from '../../typecheck/api';\n import {ExtendedTemplateCheckerImpl} from '../../typecheck/extended';\n import {ExtendedTemplateChecker, TemplateCheck} from '../../typecheck/extended/api';\n-import {InvalidBananaInBoxCheck} from '../../typecheck/extended/checks/invalid_banana_in_box';\n-import {NullishCoalescingNotNullableCheck} from '../../typecheck/extended/checks/nullish_coalescing_not_nullable';\n+import {factory as invalidBananaInBoxFactory} from '../../typecheck/extended/checks/invalid_banana_in_box';\n+import {factory as NullishCoalescingNotNullableFactory} from '../../typecheck/extended/checks/nullish_coalescing_not_nullable';\n import {getSourceFileOrNull, isDtsPath, toUnredirectedSourceFile} from '../../util/src/typescript';\n import {Xi18nContext} from '../../xi18n';\n import {NgCompilerAdapter, NgCompilerOptions} from '../api';\n@@ -1067,9 +1067,9 @@ export class NgCompiler {\n         reflector, this.adapter, this.incrementalCompilation, scopeRegistry, typeCheckScopeRegistry,\n         this.delegatingPerfRecorder);\n \n-    const templateChecks: TemplateCheck<ErrorCode>[] = [new InvalidBananaInBoxCheck()];\n+    const templateChecks: TemplateCheck<ErrorCode>[] = [invalidBananaInBoxFactory.create()];\n     if (this.options.strictNullChecks) {\n-      templateChecks.push(new NullishCoalescingNotNullableCheck());\n+      templateChecks.push(NullishCoalescingNotNullableFactory.create());\n     }\n     const extendedTemplateChecker =\n         new ExtendedTemplateCheckerImpl(templateTypeChecker, checker, templateChecks);"
        },
        {
            "sha": "8764277a5a7ce38764c31d46b5b16c347694917c",
            "filename": "packages/compiler-cli/src/ngtsc/diagnostics/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Findex.ts?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -10,4 +10,5 @@ export {COMPILER_ERRORS_WITH_GUIDES} from './src/docs';\n export {FatalDiagnosticError, isFatalDiagnosticError, makeDiagnostic, makeDiagnosticChain, makeRelatedInformation} from './src/error';\n export {ErrorCode} from './src/error_code';\n export {ERROR_DETAILS_PAGE_BASE_URL} from './src/error_details_base_url';\n+export {ExtendedTemplateDiagnosticName} from './src/extended_template_diagnostic_name';\n export {ngErrorCode, replaceTsWithNgInErrors} from './src/util';"
        },
        {
            "sha": "57a6df6c4fa7bed44aeb3ac4d21c016ba44e7d5e",
            "filename": "packages/compiler-cli/src/ngtsc/diagnostics/src/extended_template_diagnostic_name.ts",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Fextended_template_diagnostic_name.ts",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Fextended_template_diagnostic_name.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Fextended_template_diagnostic_name.ts?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -0,0 +1,21 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+/**\n+ * Enum holding the name of each extended template diagnostic. The name is used as a user-meaningful\n+ * value for configuring the diagnostic in the project's options.\n+ *\n+ * See the corresponding `ErrorCode` for documentation about each specific error.\n+ * packages/compiler-cli/src/ngtsc/diagnostics/src/error_code.ts\n+ *\n+ * @publicApi\n+ */\n+export enum ExtendedTemplateDiagnosticName {\n+  INVALID_BANANA_IN_BOX = 'invalidBananaInBox',\n+  NULLISH_COALESCING_NOT_NULLABLE = 'nullishCoalescingNotNullable',\n+}"
        },
        {
            "sha": "d39d782f9a1c71cd92450e57db5db1f030a8d235",
            "filename": "packages/compiler-cli/src/ngtsc/typecheck/extended/api/api.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 1,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Fapi%2Fapi.ts",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Fapi%2Fapi.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Fapi%2Fapi.ts?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -9,7 +9,7 @@\n import {AST, ASTWithSource, RecursiveAstVisitor, TmplAstBoundAttribute, TmplAstBoundEvent, TmplAstBoundText, TmplAstContent, TmplAstElement, TmplAstIcu, TmplAstNode, TmplAstRecursiveVisitor, TmplAstReference, TmplAstTemplate, TmplAstText, TmplAstTextAttribute, TmplAstVariable} from '@angular/compiler';\n import ts from 'typescript';\n \n-import {ErrorCode} from '../../../diagnostics';\n+import {ErrorCode, ExtendedTemplateDiagnosticName} from '../../../diagnostics';\n import {NgTemplateDiagnostic, TemplateTypeChecker} from '../../api';\n \n /**\n@@ -39,6 +39,19 @@ export interface TemplateContext {\n   typeChecker: ts.TypeChecker;\n }\n \n+/**\n+ * A factory which creates a template check for a particular code and name. This binds the two\n+ * together and associates them with a specific `TemplateCheck`.\n+ */\n+export interface TemplateCheckFactory<\n+  Code extends ErrorCode,\n+  Name extends ExtendedTemplateDiagnosticName,\n+> {\n+  code: Code;\n+  name: Name;\n+  create(): TemplateCheck<Code>;\n+}\n+\n /**\n  * This abstract class provides a base implementation for the run method.\n  */"
        },
        {
            "sha": "f2760a2e1420dd069cd4816a5d9b071038fd53dc",
            "filename": "packages/compiler-cli/src/ngtsc/typecheck/extended/checks/invalid_banana_in_box/index.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 4,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Fchecks%2Finvalid_banana_in_box%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Fchecks%2Finvalid_banana_in_box%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Fchecks%2Finvalid_banana_in_box%2Findex.ts?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -9,17 +9,16 @@\n import {AST, TmplAstBoundEvent, TmplAstNode} from '@angular/compiler';\n import ts from 'typescript';\n \n-import {ErrorCode} from '../../../../diagnostics';\n+import {ErrorCode, ExtendedTemplateDiagnosticName} from '../../../../diagnostics';\n import {NgTemplateDiagnostic} from '../../../api';\n-import {TemplateCheckWithVisitor, TemplateContext} from '../../api';\n+import {TemplateCheckFactory, TemplateCheckWithVisitor, TemplateContext} from '../../api';\n \n /**\n  * Ensures the two-way binding syntax is correct.\n  * Parentheses should be inside the brackets \"[()]\".\n  * Will return diagnostic information when \"([])\" is found.\n  */\n-export class InvalidBananaInBoxCheck extends\n-    TemplateCheckWithVisitor<ErrorCode.INVALID_BANANA_IN_BOX> {\n+class InvalidBananaInBoxCheck extends TemplateCheckWithVisitor<ErrorCode.INVALID_BANANA_IN_BOX> {\n   override code = ErrorCode.INVALID_BANANA_IN_BOX as const;\n \n   override visitNode(ctx: TemplateContext, component: ts.ClassDeclaration, node: TmplAstNode|AST):\n@@ -39,3 +38,10 @@ export class InvalidBananaInBoxCheck extends\n     return [diagnostic];\n   }\n }\n+\n+export const factory: TemplateCheckFactory<\n+    ErrorCode.INVALID_BANANA_IN_BOX, ExtendedTemplateDiagnosticName.INVALID_BANANA_IN_BOX> = {\n+  code: ErrorCode.INVALID_BANANA_IN_BOX,\n+  name: ExtendedTemplateDiagnosticName.INVALID_BANANA_IN_BOX,\n+  create: () => new InvalidBananaInBoxCheck(),\n+};"
        },
        {
            "sha": "357e654545d06dfdcdbd02a1cc68022a3dc23903",
            "filename": "packages/compiler-cli/src/ngtsc/typecheck/extended/checks/nullish_coalescing_not_nullable/index.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 3,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Fchecks%2Fnullish_coalescing_not_nullable%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Fchecks%2Fnullish_coalescing_not_nullable%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Fchecks%2Fnullish_coalescing_not_nullable%2Findex.ts?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -9,17 +9,17 @@\n import {AST, Binary, TmplAstNode} from '@angular/compiler';\n import ts from 'typescript';\n \n-import {ErrorCode} from '../../../../diagnostics';\n+import {ErrorCode, ExtendedTemplateDiagnosticName} from '../../../../diagnostics';\n import {NgTemplateDiagnostic, SymbolKind} from '../../../api';\n-import {TemplateCheckWithVisitor, TemplateContext} from '../../api';\n+import {TemplateCheckFactory, TemplateCheckWithVisitor, TemplateContext} from '../../api';\n \n /**\n  * Ensures the left side of a nullish coalescing operation is nullable.\n  * Returns diagnostics for the cases where the operator is useless.\n  * This check should only be use if `strictNullChecks` is enabled,\n  * otherwise it would produce inaccurate results.\n  */\n-export class NullishCoalescingNotNullableCheck extends\n+class NullishCoalescingNotNullableCheck extends\n     TemplateCheckWithVisitor<ErrorCode.NULLISH_COALESCING_NOT_NULLABLE> {\n   override code = ErrorCode.NULLISH_COALESCING_NOT_NULLABLE as const;\n \n@@ -49,3 +49,11 @@ export class NullishCoalescingNotNullableCheck extends\n     return [diagnostic];\n   }\n }\n+\n+export const factory: TemplateCheckFactory<\n+    ErrorCode.NULLISH_COALESCING_NOT_NULLABLE,\n+    ExtendedTemplateDiagnosticName.NULLISH_COALESCING_NOT_NULLABLE> = {\n+  code: ErrorCode.NULLISH_COALESCING_NOT_NULLABLE,\n+  name: ExtendedTemplateDiagnosticName.NULLISH_COALESCING_NOT_NULLABLE,\n+  create: () => new NullishCoalescingNotNullableCheck(),\n+};"
        },
        {
            "sha": "0a663e213eb0f26ad34ac30e3e030d035e5fd04b",
            "filename": "packages/compiler-cli/src/ngtsc/typecheck/extended/test/checks/invalid_banana_in_box/invalid_banana_in_box_spec.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 6,
            "changes": 19,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Ftest%2Fchecks%2Finvalid_banana_in_box%2Finvalid_banana_in_box_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Ftest%2Fchecks%2Finvalid_banana_in_box%2Finvalid_banana_in_box_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Ftest%2Fchecks%2Finvalid_banana_in_box%2Finvalid_banana_in_box_spec.ts?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -7,16 +7,23 @@\n  */\n \n import ts from 'typescript';\n-import {ErrorCode, ngErrorCode} from '../../../../../diagnostics';\n+\n+import {ErrorCode, ExtendedTemplateDiagnosticName, ngErrorCode} from '../../../../../diagnostics';\n import {absoluteFrom, getSourceFileOrError} from '../../../../../file_system';\n import {runInEachFileSystem} from '../../../../../file_system/testing';\n import {getSourceCodeForDiagnostic} from '../../../../../testing';\n import {getClass, setup} from '../../../../testing';\n-import {InvalidBananaInBoxCheck} from '../../../checks/invalid_banana_in_box/index';\n+import {factory as invalidBananaInBoxFactory} from '../../../checks/invalid_banana_in_box/index';\n import {ExtendedTemplateCheckerImpl} from '../../../src/extended_template_checker';\n \n runInEachFileSystem(() => {\n   describe('TemplateChecks', () => {\n+    it('binds the error code to its extended template diagnostic name', () => {\n+      expect(invalidBananaInBoxFactory.code).toBe(ErrorCode.INVALID_BANANA_IN_BOX);\n+      expect(invalidBananaInBoxFactory.name)\n+          .toBe(ExtendedTemplateDiagnosticName.INVALID_BANANA_IN_BOX);\n+    });\n+\n     it('should produce invalid banana in a box warning', () => {\n       const fileName = absoluteFrom('/main.ts');\n       const {program, templateTypeChecker} = setup([{\n@@ -29,7 +36,7 @@ runInEachFileSystem(() => {\n       const sf = getSourceFileOrError(program, fileName);\n       const component = getClass(sf, 'TestCmp');\n       const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n-          templateTypeChecker, program.getTypeChecker(), [new InvalidBananaInBoxCheck()]);\n+          templateTypeChecker, program.getTypeChecker(), [invalidBananaInBoxFactory.create()]);\n       const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n       expect(diags.length).toBe(1);\n       expect(diags[0].category).toBe(ts.DiagnosticCategory.Warning);\n@@ -49,7 +56,7 @@ runInEachFileSystem(() => {\n       const sf = getSourceFileOrError(program, fileName);\n       const component = getClass(sf, 'TestCmp');\n       const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n-          templateTypeChecker, program.getTypeChecker(), [new InvalidBananaInBoxCheck()]);\n+          templateTypeChecker, program.getTypeChecker(), [invalidBananaInBoxFactory.create()]);\n       const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n       expect(diags.length).toBe(0);\n     });\n@@ -67,7 +74,7 @@ runInEachFileSystem(() => {\n          const sf = getSourceFileOrError(program, fileName);\n          const component = getClass(sf, 'TestCmp');\n          const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n-             templateTypeChecker, program.getTypeChecker(), [new InvalidBananaInBoxCheck()]);\n+             templateTypeChecker, program.getTypeChecker(), [invalidBananaInBoxFactory.create()]);\n          const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n          expect(diags.length).toBe(0);\n        });\n@@ -89,7 +96,7 @@ runInEachFileSystem(() => {\n       const sf = getSourceFileOrError(program, fileName);\n       const component = getClass(sf, 'TestCmp');\n       const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n-          templateTypeChecker, program.getTypeChecker(), [new InvalidBananaInBoxCheck()]);\n+          templateTypeChecker, program.getTypeChecker(), [invalidBananaInBoxFactory.create()]);\n       const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n       expect(diags.length).toBe(2);\n       expect(diags[0].category).toBe(ts.DiagnosticCategory.Warning);"
        },
        {
            "sha": "f8fc0932294a3f5e57672b1a6db45678a96fb376",
            "filename": "packages/compiler-cli/src/ngtsc/typecheck/extended/test/checks/nullish_coalescing_not_nullable/nullish_coalescing_not_nullable_spec.ts",
            "status": "modified",
            "additions": 19,
            "deletions": 8,
            "changes": 27,
            "blob_url": "https://github.com/angular/angular/blob/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Ftest%2Fchecks%2Fnullish_coalescing_not_nullable%2Fnullish_coalescing_not_nullable_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/ed74e3ad61d075780ff48708b33aaf595885c212/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Ftest%2Fchecks%2Fnullish_coalescing_not_nullable%2Fnullish_coalescing_not_nullable_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fextended%2Ftest%2Fchecks%2Fnullish_coalescing_not_nullable%2Fnullish_coalescing_not_nullable_spec.ts?ref=ed74e3ad61d075780ff48708b33aaf595885c212",
            "patch": "@@ -8,16 +8,23 @@\n \n import ts from 'typescript';\n \n-import {ErrorCode, ngErrorCode} from '../../../../../diagnostics';\n+import {ErrorCode, ExtendedTemplateDiagnosticName, ngErrorCode} from '../../../../../diagnostics';\n import {absoluteFrom, getSourceFileOrError} from '../../../../../file_system';\n import {runInEachFileSystem} from '../../../../../file_system/testing';\n import {getSourceCodeForDiagnostic} from '../../../../../testing';\n import {getClass, setup} from '../../../../testing';\n-import {NullishCoalescingNotNullableCheck} from '../../../checks/nullish_coalescing_not_nullable';\n+import {factory as nullishCoalescingNotNullableFactory} from '../../../checks/nullish_coalescing_not_nullable';\n import {ExtendedTemplateCheckerImpl} from '../../../src/extended_template_checker';\n \n runInEachFileSystem(() => {\n   describe('NullishCoalescingNotNullableCheck', () => {\n+    it('binds the error code to its extended template diagnostic name', () => {\n+      expect(nullishCoalescingNotNullableFactory.code)\n+          .toBe(ErrorCode.NULLISH_COALESCING_NOT_NULLABLE);\n+      expect(nullishCoalescingNotNullableFactory.name)\n+          .toBe(ExtendedTemplateDiagnosticName.NULLISH_COALESCING_NOT_NULLABLE);\n+    });\n+\n     it('should produce nullish coalescing warning', () => {\n       const fileName = absoluteFrom('/main.ts');\n       const {program, templateTypeChecker} = setup([{\n@@ -30,7 +37,8 @@ runInEachFileSystem(() => {\n       const sf = getSourceFileOrError(program, fileName);\n       const component = getClass(sf, 'TestCmp');\n       const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n-          templateTypeChecker, program.getTypeChecker(), [new NullishCoalescingNotNullableCheck()]);\n+          templateTypeChecker, program.getTypeChecker(),\n+          [nullishCoalescingNotNullableFactory.create()]);\n       const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n       expect(diags.length).toBe(1);\n       expect(diags[0].category).toBe(ts.DiagnosticCategory.Warning);\n@@ -50,7 +58,8 @@ runInEachFileSystem(() => {\n       const sf = getSourceFileOrError(program, fileName);\n       const component = getClass(sf, 'TestCmp');\n       const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n-          templateTypeChecker, program.getTypeChecker(), [new NullishCoalescingNotNullableCheck()]);\n+          templateTypeChecker, program.getTypeChecker(),\n+          [nullishCoalescingNotNullableFactory.create()]);\n       const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n       expect(diags.length).toBe(0);\n     });\n@@ -67,7 +76,8 @@ runInEachFileSystem(() => {\n       const sf = getSourceFileOrError(program, fileName);\n       const component = getClass(sf, 'TestCmp');\n       const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n-          templateTypeChecker, program.getTypeChecker(), [new NullishCoalescingNotNullableCheck()]);\n+          templateTypeChecker, program.getTypeChecker(),\n+          [nullishCoalescingNotNullableFactory.create()]);\n       const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n       expect(diags.length).toBe(0);\n     });\n@@ -96,7 +106,7 @@ runInEachFileSystem(() => {\n          const component = getClass(sf, 'TestCmp');\n          const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n              templateTypeChecker, program.getTypeChecker(),\n-             [new NullishCoalescingNotNullableCheck()]);\n+             [nullishCoalescingNotNullableFactory.create()]);\n          const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n          expect(diags.length).toBe(1);\n          expect(diags[0].category).toBe(ts.DiagnosticCategory.Warning);\n@@ -128,7 +138,8 @@ runInEachFileSystem(() => {\n       const sf = getSourceFileOrError(program, fileName);\n       const component = getClass(sf, 'TestCmp');\n       const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n-          templateTypeChecker, program.getTypeChecker(), [new NullishCoalescingNotNullableCheck()]);\n+          templateTypeChecker, program.getTypeChecker(),\n+          [nullishCoalescingNotNullableFactory.create()]);\n       const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n       expect(diags.length).toBe(0);\n     });\n@@ -153,7 +164,7 @@ runInEachFileSystem(() => {\n          const component = getClass(sf, 'TestCmp');\n          const extendedTemplateChecker = new ExtendedTemplateCheckerImpl(\n              templateTypeChecker, program.getTypeChecker(),\n-             [new NullishCoalescingNotNullableCheck()]);\n+             [nullishCoalescingNotNullableFactory.create()]);\n          const diags = extendedTemplateChecker.getDiagnosticsForComponent(component);\n          expect(diags.length).toBe(0);\n        });"
        }
    ],
    "stats": {
        "total": 146,
        "additions": 120,
        "deletions": 26
    }
}