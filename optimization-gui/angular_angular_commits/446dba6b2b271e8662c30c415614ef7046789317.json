{
    "author": "AndrewKushnir",
    "message": "build(docs-infra): add more checks to verify contributors.json data (#40369)\n\nThis commit adds extra steps to verify contributors.json data, such as checking `lead` and `mentor` field as well as\nmaking sure the list is sorted alphabetically.\n\nPR Close #40369",
    "sha": "446dba6b2b271e8662c30c415614ef7046789317",
    "files": [
        {
            "sha": "61cedc3b5258fbd9032acecde999b3815b345d41",
            "filename": "aio/scripts/contributors/validate-data.js",
            "status": "modified",
            "additions": 32,
            "deletions": 0,
            "changes": 32,
            "blob_url": "https://github.com/angular/angular/blob/446dba6b2b271e8662c30c415614ef7046789317/aio%2Fscripts%2Fcontributors%2Fvalidate-data.js",
            "raw_url": "https://github.com/angular/angular/raw/446dba6b2b271e8662c30c415614ef7046789317/aio%2Fscripts%2Fcontributors%2Fvalidate-data.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fscripts%2Fcontributors%2Fvalidate-data.js?ref=446dba6b2b271e8662c30c415614ef7046789317",
            "patch": "@@ -8,13 +8,16 @@ const {join, resolve} = require('path');\n const CONTENT_DIR = resolve(__dirname, '../../content');\n const IMAGES_DIR = join(CONTENT_DIR, 'images/bios');\n const CONTRIBUTORS_PATH = join(CONTENT_DIR, 'marketing/contributors.json');\n+const EXISTING_GROUPS = new Set(['Angular', 'GDE', 'Collaborators']);\n \n // Run\n _main();\n \n // Functions - Definitions\n function _main() {\n   const contributors = JSON.parse(readFileSync(CONTRIBUTORS_PATH, 'utf8'));\n+\n+  // Check that there are no missing images.\n   const expectedImages = Object.keys(contributors)\n       .filter(key => !!contributors[key].picture)\n       .map(key => join(IMAGES_DIR, contributors[key].picture));\n@@ -25,4 +28,33 @@ function _main() {\n         'The following pictures are referenced in \\'contributors.json\\' but do not exist:' +\n         missingImages.map(path => `\\n  - ${path}`).join(''));\n   }\n+\n+  // Verify that all keys are sorted alphabetically\n+  const keys = Object.keys(contributors);\n+  for (let i = 1; i < keys.length; i++) {\n+    if (keys[i - 1].toLowerCase() > keys[i].toLowerCase()) {\n+      throw new Error(\n+        `The following keys in 'contributors.json' are not in alphabetical order: '${keys[i - 1]}' and '${keys[i]}'.`\n+      );\n+    }\n+  }\n+\n+  Object.entries(contributors).forEach(([key, entry]) => {\n+    // Make sure `lead` and `mentor` fields refer to existing entries\n+    if (entry.lead && !contributors[entry.lead]) {\n+      throw new Error(`The '${key}' entry contains 'lead' field, but it refers to non-existing entry ('${entry.lead}').`);\n+    }\n+    if (entry.mentor && !contributors[entry.mentor]) {\n+      throw new Error(`The '${key}' entry contains 'mentor' field, but it refers to non-existing entry ('${entry.mentor}').`);\n+    }\n+\n+    // Verify that `groups` field is always present and contains existing groups\n+    if (!entry.groups || !Array.isArray(entry.groups) || entry.groups.length === 0) {\n+      throw new Error(`The 'groups' field should be defined as a non-empty array (entry: '${key}').`);\n+    }\n+    if (entry.groups.some(group => !EXISTING_GROUPS.has(group))) {\n+      throw new Error(`The '${key}' entry contains 'groups' field with unknown values ` +\n+        `(groups: ${JSON.stringify(entry.groups)}, known values: ${JSON.stringify(Array.from(EXISTING_GROUPS))}).`);\n+    }\n+  });\n }"
        }
    ],
    "stats": {
        "total": 32,
        "additions": 32,
        "deletions": 0
    }
}