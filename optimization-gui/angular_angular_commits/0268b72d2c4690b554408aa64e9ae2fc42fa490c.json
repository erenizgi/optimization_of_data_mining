{
    "author": "kyliau",
    "message": "Revert \"test(language-service): Make project service a singleton (#39308)\" (#39322)\n\nThis reverts commit 1b21350e1719428b8d0c3280add470d1b395e2af.\n\nPR Close #39322",
    "sha": "0268b72d2c4690b554408aa64e9ae2fc42fa490c",
    "files": [
        {
            "sha": "34a052eacff47fe6f078bf775a57380c489dcde3",
            "filename": "packages/language-service/ivy/test/mock_host.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 19,
            "changes": 30,
            "blob_url": "https://github.com/angular/angular/blob/0268b72d2c4690b554408aa64e9ae2fc42fa490c/packages%2Flanguage-service%2Fivy%2Ftest%2Fmock_host.ts",
            "raw_url": "https://github.com/angular/angular/raw/0268b72d2c4690b554408aa64e9ae2fc42fa490c/packages%2Flanguage-service%2Fivy%2Ftest%2Fmock_host.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Fmock_host.ts?ref=0268b72d2c4690b554408aa64e9ae2fc42fa490c",
            "patch": "@@ -69,32 +69,24 @@ export const host: ts.server.ServerHost = {\n   },\n };\n \n-/**\n- * Constructing a project service is expensive (~2.5s on MacBook Pro), so it\n- * should be a singleton service shared throughout all tests.\n- */\n-let projectService: ts.server.ProjectService;\n-\n /**\n  * Create a ConfiguredProject and an actual program for the test project located\n  * in packages/language-service/test/project. Project creation exercises the\n  * actual code path, but a mock host is used for the filesystem to intercept\n  * and modify test files.\n  */\n export function setup() {\n-  if (!projectService) {\n-    projectService = new ts.server.ProjectService({\n-      host,\n-      logger,\n-      cancellationToken: ts.server.nullCancellationToken,\n-      useSingleInferredProject: true,\n-      useInferredProjectPerProjectRoot: true,\n-      typingsInstaller: ts.server.nullTypingsInstaller,\n-    });\n-    // Opening APP_COMPONENT forces a new ConfiguredProject to be created based\n-    // on the tsconfig.json in the test project.\n-    projectService.openClientFile(APP_COMPONENT);\n-  }\n+  const projectService = new ts.server.ProjectService({\n+    host,\n+    logger,\n+    cancellationToken: ts.server.nullCancellationToken,\n+    useSingleInferredProject: true,\n+    useInferredProjectPerProjectRoot: true,\n+    typingsInstaller: ts.server.nullTypingsInstaller,\n+  });\n+  // Opening APP_COMPONENT forces a new ConfiguredProject to be created based\n+  // on the tsconfig.json in the test project.\n+  projectService.openClientFile(APP_COMPONENT);\n   const project = projectService.findProject(TSCONFIG);\n   if (!project) {\n     throw new Error(`Failed to create project for ${TSCONFIG}`);"
        }
    ],
    "stats": {
        "total": 30,
        "additions": 11,
        "deletions": 19
    }
}