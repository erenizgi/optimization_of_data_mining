{
    "author": "mhevery",
    "message": "refactor(core): rename `COMMENT_MARKER` to `ICU_MARKER` (#39233)\n\n`COMMENT_MARKER` is a generic name which does not make it obvious that\nit is used for ICU use case. `ICU_MARKER` is more explicit as it is used\nexclusively with ICUs.\n\nPR Close #39233",
    "sha": "e1f80d73a8906b852f547ba36a251e1c32c4997b",
    "files": [
        {
            "sha": "e476df408db3329bbfd469b75ee3884eb9f3e22b",
            "filename": "packages/core/src/render3/i18n/i18n.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n.md",
            "raw_url": "https://github.com/angular/angular/raw/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n.md?ref=e1f80d73a8906b852f547ba36a251e1c32c4997b",
            "patch": "@@ -434,7 +434,7 @@ const tI18n = <TI18n>{\n     //   // Assume expandoIndex = 200;\n     //   const node = lView[expandoIndex++] = document.createComment('');\n     //   lView[1].appendChild(node);\n-    COMMENT_MARKER, '', 1 << SHIFT_PARENT | AppendChild,\n+    ICU_MARKER, '', 1 << SHIFT_PARENT | AppendChild,\n   ],\n   update: <I18nUpdateOpCodes>[\n     // The following OpCodes represent: `<b>{count, plural, ... }</b>\">`\n@@ -968,7 +968,7 @@ const tI18n = <TI18n>{\n         ],\n         <I18nMutateOpCodes>[                         // Case: `other`: `{�0� <!--subICU-->}`\n           '', 1 << SHIFT_PARENT | AppendChild,       // Expando location: 100\n-          COMMENT_MARKER, '', 0 << SHIFT_PARENT | AppendChild,    // Expando location: 101\n+          ICU_MARKER, '', 0 << SHIFT_PARENT | AppendChild,    // Expando location: 101\n         ],\n       ],\n       remove: ["
        },
        {
            "sha": "499a399da53d4ab244af584c13ab892934e1b6a2",
            "filename": "packages/core/src/render3/i18n/i18n_apply.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_apply.ts",
            "raw_url": "https://github.com/angular/angular/raw/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_apply.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_apply.ts?ref=e1f80d73a8906b852f547ba36a251e1c32c4997b",
            "patch": "@@ -11,7 +11,7 @@ import {assertDefined, assertDomNode, assertEqual, assertGreaterThan, assertInde\n import {assertIndexInExpandoRange, assertTIcu} from '../assert';\n import {attachPatchData} from '../context_discovery';\n import {elementPropertyInternal, setElementAttribute} from '../instructions/shared';\n-import {COMMENT_MARKER, ELEMENT_MARKER, getCurrentICUCaseIndex, getParentFromI18nMutateOpCode, getRefFromI18nMutateOpCode, I18nCreateOpCode, I18nCreateOpCodes, I18nMutateOpCode, I18nMutateOpCodes, I18nUpdateOpCode, I18nUpdateOpCodes, IcuType, TI18n, TIcu} from '../interfaces/i18n';\n+import {ELEMENT_MARKER, getCurrentICUCaseIndex, getParentFromI18nMutateOpCode, getRefFromI18nMutateOpCode, I18nCreateOpCode, I18nCreateOpCodes, I18nMutateOpCode, I18nMutateOpCodes, I18nUpdateOpCode, I18nUpdateOpCodes, ICU_MARKER, IcuType, TI18n, TIcu} from '../interfaces/i18n';\n import {TNode} from '../interfaces/node';\n import {RElement, RNode, RText} from '../interfaces/renderer';\n import {SanitizerFn} from '../interfaces/sanitization';\n@@ -20,6 +20,7 @@ import {createCommentNode, createElementNode, createTextNode, nativeInsertBefore\n import {getBindingIndex} from '../state';\n import {renderStringify} from '../util/misc_utils';\n import {getNativeByIndex, unwrapRNode} from '../util/view_utils';\n+\n import {getLocaleId} from './i18n_locale_id';\n import {getTIcu} from './i18n_util';\n \n@@ -202,7 +203,7 @@ export function applyMutableOpCodes(\n       }\n     } else {\n       switch (opCode) {\n-        case COMMENT_MARKER:\n+        case ICU_MARKER:\n           const commentValue = mutableOpCodes[++i] as string;\n           const commentNodeIndex = mutableOpCodes[++i] as number;\n           if (lView[commentNodeIndex] === null) {"
        },
        {
            "sha": "c048e9ee2b094609c7af1db56903aa04a3c92b6f",
            "filename": "packages/core/src/render3/i18n/i18n_debug.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_debug.ts",
            "raw_url": "https://github.com/angular/angular/raw/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_debug.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_debug.ts?ref=e1f80d73a8906b852f547ba36a251e1c32c4997b",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n import {assertNumber, assertString} from '../../util/assert';\n-import {COMMENT_MARKER, ELEMENT_MARKER, getInstructionFromI18nMutateOpCode, getParentFromI18nMutateOpCode, getRefFromI18nMutateOpCode, I18nCreateOpCode, I18nMutateOpCode, I18nMutateOpCodes, I18nUpdateOpCode, I18nUpdateOpCodes} from '../interfaces/i18n';\n+import {ELEMENT_MARKER, getInstructionFromI18nMutateOpCode, getParentFromI18nMutateOpCode, getRefFromI18nMutateOpCode, I18nCreateOpCode, I18nMutateOpCode, I18nMutateOpCodes, I18nUpdateOpCode, I18nUpdateOpCodes, ICU_MARKER} from '../interfaces/i18n';\n \n \n /**\n@@ -137,7 +137,7 @@ export function i18nMutateOpCodesToString(\n   let lastRef = -1;\n   while (parser.hasMore()) {\n     let value = parser.consumeNumberStringOrMarker();\n-    if (value === COMMENT_MARKER) {\n+    if (value === ICU_MARKER) {\n       const text = parser.consumeString();\n       lastRef = parser.consumeNumber();\n       lines.push(`lView[${lastRef}] = document.createComment(\"${text}\")`);\n@@ -201,13 +201,13 @@ class OpCodeParser {\n     return value;\n   }\n \n-  consumeNumberStringOrMarker(): number|string|COMMENT_MARKER|ELEMENT_MARKER {\n+  consumeNumberStringOrMarker(): number|string|ICU_MARKER|ELEMENT_MARKER {\n     let value = this.codes[this.i++];\n-    if (typeof value === 'string' || typeof value === 'number' || value == COMMENT_MARKER ||\n+    if (typeof value === 'string' || typeof value === 'number' || value == ICU_MARKER ||\n         value == ELEMENT_MARKER) {\n       return value;\n     }\n-    assertNumber(value, 'expecting number, string, COMMENT_MARKER or ELEMENT_MARKER in OpCode');\n+    assertNumber(value, 'expecting number, string, ICU_MARKER or ELEMENT_MARKER in OpCode');\n     return value;\n   }\n }"
        },
        {
            "sha": "11be9980e94facd1dde2b813154a9f1ab0748a64",
            "filename": "packages/core/src/render3/i18n/i18n_parse.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_parse.ts",
            "raw_url": "https://github.com/angular/angular/raw/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_parse.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_parse.ts?ref=e1f80d73a8906b852f547ba36a251e1c32c4997b",
            "patch": "@@ -16,7 +16,7 @@ import {CharCode} from '../../util/char_code';\n import {loadIcuContainerVisitor} from '../instructions/i18n_icu_container_visitor';\n import {allocExpando, createTNodeAtIndex, elementAttributeInternal, setInputsForProperty, setNgReflectProperties} from '../instructions/shared';\n import {getDocument} from '../interfaces/document';\n-import {COMMENT_MARKER, ELEMENT_MARKER, ensureIcuContainerVisitorLoaded, I18nCreateOpCode, I18nCreateOpCodes, I18nMutateOpCode, i18nMutateOpCode, I18nMutateOpCodes, I18nUpdateOpCode, I18nUpdateOpCodes, IcuExpression, IcuType, TI18n, TIcu} from '../interfaces/i18n';\n+import {ELEMENT_MARKER, ensureIcuContainerVisitorLoaded, I18nCreateOpCode, I18nCreateOpCodes, I18nMutateOpCode, i18nMutateOpCode, I18nMutateOpCodes, I18nUpdateOpCode, I18nUpdateOpCodes, ICU_MARKER, IcuExpression, IcuType, TI18n, TIcu} from '../interfaces/i18n';\n import {TNode, TNodeType} from '../interfaces/node';\n import {RComment, RElement} from '../interfaces/renderer';\n import {SanitizerFn} from '../interfaces/sanitization';\n@@ -678,7 +678,7 @@ function walkIcuTree(\n           const icuExpression: IcuExpression = nestedIcus[nestedIcuIndex];\n           // Create the comment node that will anchor the ICU expression\n           addCreateNodeAndAppend(\n-              create, COMMENT_MARKER, ngDevMode ? `nested ICU ${nestedIcuIndex}` : '', parentIdx,\n+              create, ICU_MARKER, ngDevMode ? `nested ICU ${nestedIcuIndex}` : '', parentIdx,\n               newIndex);\n           icuStart(tView, lView, sharedUpdateOpCodes, parentIdx, icuExpression, newIndex);\n           addRemoveNestedIcu(remove, newIndex, depth);\n@@ -714,7 +714,7 @@ function addUpdateIcuUpdate(update: I18nUpdateOpCodes, bindingMask: number, inde\n }\n \n function addCreateNodeAndAppend(\n-    create: I18nMutateOpCodes, marker: null|COMMENT_MARKER|ELEMENT_MARKER, text: string,\n+    create: I18nMutateOpCodes, marker: null|ICU_MARKER|ELEMENT_MARKER, text: string,\n     appendToParentIdx: number, createAtIdx: number) {\n   if (marker !== null) {\n     create.push(marker);"
        },
        {
            "sha": "4ae81e8e497f356fd987562f72276cf4d967a075",
            "filename": "packages/core/src/render3/interfaces/i18n.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 8,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Finterfaces%2Fi18n.ts",
            "raw_url": "https://github.com/angular/angular/raw/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Fsrc%2Frender3%2Finterfaces%2Fi18n.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finterfaces%2Fi18n.ts?ref=e1f80d73a8906b852f547ba36a251e1c32c4997b",
            "patch": "@@ -117,17 +117,16 @@ export interface ELEMENT_MARKER {\n }\n \n /**\n- * Marks that the next string is comment text.\n+ * Marks that the next string is comment text need for ICU.\n  *\n  * See `I18nMutateOpCodes` documentation.\n  */\n-// FIXME(misko): Rename to ICU marker\n-export const COMMENT_MARKER: COMMENT_MARKER = {\n-  marker: 'comment'\n+export const ICU_MARKER: ICU_MARKER = {\n+  marker: 'ICU'\n };\n \n-export interface COMMENT_MARKER {\n-  marker: 'comment';\n+export interface ICU_MARKER {\n+  marker: 'ICU';\n }\n \n export interface I18nDebug {\n@@ -220,7 +219,7 @@ export enum I18nCreateOpCode {\n  *   // ---------------------\n  *   // Equivalent to:\n  *   //   lView[1].appendChild(lView[0] = document.createComment(''));\n- *   COMMENT_MARKER, '', 0, 1 << SHIFT_PARENT | 0 << SHIFT_REF | AppendChild,\n+ *   ICU_MARKER, '', 0, 1 << SHIFT_PARENT | 0 << SHIFT_REF | AppendChild,\n  *\n  *   // For moving existing nodes to a different location\n  *   // --------------------------------------------------\n@@ -245,7 +244,7 @@ export enum I18nCreateOpCode {\n  *\n  * See: `applyI18nCreateOpCodes`;\n  */\n-export interface I18nMutateOpCodes extends Array<number|string|ELEMENT_MARKER|COMMENT_MARKER|null>,\n+export interface I18nMutateOpCodes extends Array<number|string|ELEMENT_MARKER|ICU_MARKER|null>,\n                                            I18nDebug {}\n \n export const enum I18nUpdateOpCode {"
        },
        {
            "sha": "9a0580868020bf5753ef2720799a319da028d7df",
            "filename": "packages/core/test/render3/i18n_debug_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Ftest%2Frender3%2Fi18n_debug_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/e1f80d73a8906b852f547ba36a251e1c32c4997b/packages%2Fcore%2Ftest%2Frender3%2Fi18n_debug_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fi18n_debug_spec.ts?ref=e1f80d73a8906b852f547ba36a251e1c32c4997b",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n import {i18nCreateOpCodesToString, i18nMutateOpCodesToString, i18nUpdateOpCodesToString} from '@angular/core/src/render3/i18n/i18n_debug';\n-import {COMMENT_MARKER, ELEMENT_MARKER, I18nCreateOpCode, I18nMutateOpCode, I18nUpdateOpCode} from '@angular/core/src/render3/interfaces/i18n';\n+import {ELEMENT_MARKER, I18nCreateOpCode, I18nMutateOpCode, I18nUpdateOpCode, ICU_MARKER} from '@angular/core/src/render3/interfaces/i18n';\n \n describe('i18n debug', () => {\n   describe('i18nUpdateOpCodesToString', () => {\n@@ -92,7 +92,7 @@ describe('i18n debug', () => {\n \n     it('should print comment AppendChild', () => {\n       expect(i18nMutateOpCodesToString([\n-        COMMENT_MARKER, 'xyz', 0,\n+        ICU_MARKER, 'xyz', 0,\n         1 << I18nMutateOpCode.SHIFT_PARENT | 0 << I18nMutateOpCode.SHIFT_REF |\n             I18nMutateOpCode.AppendChild\n       ]))"
        }
    ],
    "stats": {
        "total": 44,
        "additions": 22,
        "deletions": 22
    }
}