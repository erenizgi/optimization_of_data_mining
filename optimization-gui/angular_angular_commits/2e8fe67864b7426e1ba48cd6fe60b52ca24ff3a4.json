{
    "author": "mgechev",
    "message": "fix(devtools): change the isIvy detection",
    "sha": "2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4",
    "files": [
        {
            "sha": "9fdc078cd5947d15f7117ad327193ad63326bce1",
            "filename": "projects/ng-devtools-backend/src/lib/angular-check.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fangular-check.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fangular-check.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fangular-check.ts?ref=2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4",
            "patch": "@@ -5,7 +5,7 @@ export const appIsAngularInDevMode = (): boolean => {\n };\n \n export const appIsAngularIvy = (): boolean => {\n-  return !!(window as any).getAllAngularRootElements?.()?.[0]?.__ngContext__;\n+  return typeof (window as any).getAllAngularRootElements?.()?.[0]?.__ngContext__ !== 'undefined';\n };\n \n export const appIsAngular = (): boolean => {"
        },
        {
            "sha": "56a5dca387a04f3cf1c4999d0540797c8b2e0923",
            "filename": "projects/ng-devtools-backend/src/lib/component-tree.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 4,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fcomponent-tree.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fcomponent-tree.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fcomponent-tree.ts?ref=2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4",
            "patch": "@@ -77,9 +77,9 @@ const enum DirectiveMetadataKey {\n // the global `getDirectiveMetadata`. For prior versions of the framework\n // the method directly interacts with the directive/component definition.\n export const getDirectiveMetadata = (dir: any): DirectiveMetadata => {\n-  const getDirectiveMetadata = (window as any).ng.getDirectiveMetadata;\n-  if (getDirectiveMetadata) {\n-    const metadata = getDirectiveMetadata(dir);\n+  const getMetadata = (window as any).ng.getDirectiveMetadata;\n+  if (getMetadata) {\n+    const metadata = getMetadata(dir);\n     if (metadata) {\n       return {\n         inputs: metadata.inputs,\n@@ -128,7 +128,8 @@ const getRoots = () => {\n   const roots = Array.from(document.documentElement.querySelectorAll('[ng-version]'));\n   const isTopLevel = (element: HTMLElement) => {\n     let parent: HTMLElement | null = element;\n-    while ((parent = parent.parentElement)) {\n+    while (parent?.parentElement) {\n+      parent = parent.parentElement;\n       if (parent.hasAttribute('ng-version')) {\n         return false;\n       }"
        },
        {
            "sha": "2aa54e9db6a75947a5434ec66d39117fa07798d7",
            "filename": "projects/ng-devtools-backend/src/lib/directive-forest/ltree.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fdirective-forest%2Fltree.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fdirective-forest%2Fltree.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fdirective-forest%2Fltree.ts?ref=2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4",
            "patch": "@@ -58,8 +58,8 @@ export const getDirectiveHostElement = (dir: any) => {\n };\n \n export class LTreeStrategy {\n-  supports(element: Element) {\n-    return (element as any).__ngContext__;\n+  supports(element: Element): boolean {\n+    return typeof (element as any).__ngContext__ !== 'undefined';\n   }\n \n   private _getNode(lView: any, data: any, idx: number): ComponentTreeNode {\n@@ -93,7 +93,7 @@ export class LTreeStrategy {\n     };\n   }\n \n-  private _extract(lViewOrLContainer: any, nodes: ComponentTreeNode[] = []) {\n+  private _extract(lViewOrLContainer: any, nodes: ComponentTreeNode[] = []): ComponentTreeNode[] {\n     if (isLContainer(lViewOrLContainer)) {\n       for (let i = 9; i < lViewOrLContainer.length; i++) {\n         if (lViewOrLContainer[i]) {"
        },
        {
            "sha": "3d3310c78c4d3ab819d57ee0f36f075100843769",
            "filename": "projects/ng-devtools-backend/src/lib/directive-forest/render-tree.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fdirective-forest%2Frender-tree.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fdirective-forest%2Frender-tree.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fdirective-forest%2Frender-tree.ts?ref=2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4",
            "patch": "@@ -20,19 +20,19 @@ const extractViewTree = (\n         name: dir.constructor.name,\n       };\n     }),\n-    element: node.nodeName.toLowerCase(),\n-    nativeElement: node,\n+    element: domNode.nodeName.toLowerCase(),\n+    nativeElement: domNode,\n   };\n   if (!(domNode instanceof Element)) {\n     result.push(componentTreeNode);\n     return result;\n   }\n-  const component = getComponent(node);\n+  const component = getComponent(domNode);\n   if (component) {\n     componentTreeNode.component = {\n       instance: component,\n-      isElement: isCustomElement(node),\n-      name: node.nodeName.toLowerCase(),\n+      isElement: isCustomElement(domNode),\n+      name: domNode.nodeName.toLowerCase(),\n     };\n   }\n   if (component || componentTreeNode.directives.length) {\n@@ -49,7 +49,7 @@ const extractViewTree = (\n };\n \n export class RTreeStrategy {\n-  supports(_: any) {\n+  supports(_: any): boolean {\n     return ['getDirectiveMetadata', 'getComponent', 'getDirectives'].every(\n       (method) => typeof (window as any).ng[method] === 'function'\n     );"
        },
        {
            "sha": "c02bb3716836d1e71721d48a327a7675670f062a",
            "filename": "projects/shell-chrome/src/app/ng-validate.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fshell-chrome%2Fsrc%2Fapp%2Fng-validate.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4/projects%2Fshell-chrome%2Fsrc%2Fapp%2Fng-validate.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fshell-chrome%2Fsrc%2Fapp%2Fng-validate.ts?ref=2e8fe67864b7426e1ba48cd6fe60b52ca24ff3a4",
            "patch": "@@ -36,7 +36,7 @@ function detectAngular(win: Window): void {\n     {\n       // Needs to be inline because we're stringifying\n       // this function and executing it with eval.\n-      isIvy: !!(window as any).getAllAngularRootElements?.()?.[0]?.__ngContext__,\n+      isIvy: typeof (window as any).getAllAngularRootElements?.()?.[0]?.__ngContext__ !== 'undefined',\n       isAngular,\n       isDebugMode,\n       isSupportedAngularVersion,"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 16,
        "deletions": 15
    }
}