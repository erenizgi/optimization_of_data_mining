{
    "author": "alan-agius4",
    "message": "refactor(compiler-cli): remove usage of `ts.updateIdentifier` (#38076)\n\nWith Typescript 4, `ts.updateIdentifier` is no longer available.\nCalling `ts.updateIdentifier` used to return the same node when\n`typeArguments` was `undefined` because `node.typeArguments`\nwas also `undefined`.\n\nRelevant TS code:\n```js\nfunction updateIdentifier(node, typeArguments) {\n  return node.typeArguments !== typeArguments\n      ? updateNode(createIdentifier(ts.idText(node), typeArguments), node)\n      : node;\n}\n```\n\nPR Close #38076",
    "sha": "281b647f1550bee215db53862ae83cdda6703606",
    "files": [
        {
            "sha": "ce1a358c8a8bde8e4392581f6b3da5ad6e47e083",
            "filename": "packages/compiler-cli/src/ngtsc/annotations/src/metadata.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/281b647f1550bee215db53862ae83cdda6703606/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fannotations%2Fsrc%2Fmetadata.ts",
            "raw_url": "https://github.com/angular/angular/raw/281b647f1550bee215db53862ae83cdda6703606/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fannotations%2Fsrc%2Fmetadata.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fannotations%2Fsrc%2Fmetadata.ts?ref=281b647f1550bee215db53862ae83cdda6703606",
            "patch": "@@ -28,7 +28,7 @@ export function generateSetClassMetadataCall(\n   if (!reflection.isClass(clazz)) {\n     return null;\n   }\n-  const id = ts.updateIdentifier(reflection.getAdjacentNameOfClass(clazz));\n+  const id = reflection.getAdjacentNameOfClass(clazz);\n \n   // Reflect over the class decorators. If none are present, or those that are aren't from\n   // Angular, then return null. Otherwise, turn them into metadata."
        },
        {
            "sha": "f07ea36462a0b21a27a690ed6dee4862af8c2941",
            "filename": "packages/compiler-cli/src/ngtsc/imports/test/default_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/281b647f1550bee215db53862ae83cdda6703606/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fimports%2Ftest%2Fdefault_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/281b647f1550bee215db53862ae83cdda6703606/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fimports%2Ftest%2Fdefault_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fimports%2Ftest%2Fdefault_spec.ts?ref=281b647f1550bee215db53862ae83cdda6703606",
            "patch": "@@ -69,7 +69,7 @@ runInEachFileSystem(() => {\n             module: ts.ModuleKind.CommonJS,\n           });\n       const fooClause = getDeclaration(program, _('/test.ts'), 'Foo', ts.isImportClause);\n-      const fooId = ts.updateIdentifier(fooClause.name!);\n+      const fooId = fooClause.name!;\n       const fooDecl = fooClause.parent;\n \n       const tracker = new DefaultImportTracker();"
        },
        {
            "sha": "eea33c9bfe5c71511c40ff40a51f33c708f147cb",
            "filename": "packages/compiler-cli/src/ngtsc/reflection/src/type_to_value.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/281b647f1550bee215db53862ae83cdda6703606/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Ftype_to_value.ts",
            "raw_url": "https://github.com/angular/angular/raw/281b647f1550bee215db53862ae83cdda6703606/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Ftype_to_value.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Ftype_to_value.ts?ref=281b647f1550bee215db53862ae83cdda6703606",
            "patch": "@@ -59,9 +59,7 @@ export function typeToValue(\n \n       return {\n         kind: TypeValueReferenceKind.LOCAL,\n-        // Copying the name here ensures the generated references will be correctly transformed\n-        // along with the import.\n-        expression: ts.updateIdentifier(firstDecl.name),\n+        expression: firstDecl.name,\n         defaultImportStatement: firstDecl.parent,\n       };\n     } else if (ts.isImportSpecifier(firstDecl)) {"
        },
        {
            "sha": "8d40c1e3dbd032b1337a88e9b22d4e4e814ff815",
            "filename": "packages/compiler-cli/src/ngtsc/switch/src/switch.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/281b647f1550bee215db53862ae83cdda6703606/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fswitch%2Fsrc%2Fswitch.ts",
            "raw_url": "https://github.com/angular/angular/raw/281b647f1550bee215db53862ae83cdda6703606/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fswitch%2Fsrc%2Fswitch.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fswitch%2Fsrc%2Fswitch.ts?ref=281b647f1550bee215db53862ae83cdda6703606",
            "patch": "@@ -110,10 +110,6 @@ function flipIvySwitchesInVariableStatement(\n           stmt.getSourceFile().fileName} for the Ivy switch.`);\n     }\n \n-    // Copy the identifier with updateIdentifier(). This copies the internal information which\n-    // allows TS to write a correct reference to the identifier.\n-    newIdentifier = ts.updateIdentifier(newIdentifier);\n-\n     newDeclarations[i] = ts.updateVariableDeclaration(\n         /* node */ decl,\n         /* name */ decl.name,"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 3,
        "deletions": 9
    }
}