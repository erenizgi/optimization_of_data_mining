{
    "author": "josephperrott",
    "message": "feat(dev-infra): support --no-branch-prompt to suppress the merge tool branch target confirmation (#40528)\n\nAdd support for a `--no-branch-prompt` flag for the `ng-dev pr merge` tool.  This\nflag enables suppression of the confirmation prompt for which branches the specified\nPR will merge into.\n\nPR Close #40528",
    "sha": "2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f",
    "files": [
        {
            "sha": "7fc25d5c19bd39d697a0ef2f5c21335bdb83c4ed",
            "filename": "dev-infra/ng-dev.js",
            "status": "modified",
            "additions": 85,
            "deletions": 60,
            "changes": 145,
            "blob_url": "https://github.com/angular/angular/blob/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f",
            "patch": "@@ -3970,15 +3970,20 @@ var AutosquashMergeStrategy = /** @class */ (function (_super) {\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n+var defaultPullRequestMergeTaskFlags = {\n+    branchPrompt: true,\n+};\n /**\n  * Class that accepts a merge script configuration and Github token. It provides\n  * a programmatic interface for merging multiple pull requests based on their\n  * labels that have been resolved through the merge script configuration.\n  */\n var PullRequestMergeTask = /** @class */ (function () {\n-    function PullRequestMergeTask(config, git) {\n+    function PullRequestMergeTask(config, git, flags) {\n         this.config = config;\n         this.git = git;\n+        // Update flags property with the provided flags values as patches to the default flag values.\n+        this.flags = tslib.__assign(tslib.__assign({}, defaultPullRequestMergeTaskFlags), flags);\n     }\n     /**\n      * Merges the given pull request and pushes it upstream.\n@@ -3988,10 +3993,10 @@ var PullRequestMergeTask = /** @class */ (function () {\n     PullRequestMergeTask.prototype.merge = function (prNumber, force) {\n         if (force === void 0) { force = false; }\n         return tslib.__awaiter(this, void 0, void 0, function () {\n-            var hasOauthScopes, pullRequest, _a, strategy, previousBranchOrRevision, failure, e_1;\n+            var hasOauthScopes, pullRequest, _a, _b, strategy, previousBranchOrRevision, failure, e_1;\n             var _this = this;\n-            return tslib.__generator(this, function (_b) {\n-                switch (_b.label) {\n+            return tslib.__generator(this, function (_c) {\n+                switch (_c.label) {\n                     case 0: return [4 /*yield*/, this.git.hasOauthScopes(function (scopes, missing) {\n                             if (!scopes.includes('repo')) {\n                                 if (_this.config.remote.private) {\n@@ -4003,7 +4008,7 @@ var PullRequestMergeTask = /** @class */ (function () {\n                             }\n                         })];\n                     case 1:\n-                        hasOauthScopes = _b.sent();\n+                        hasOauthScopes = _c.sent();\n                         if (hasOauthScopes !== true) {\n                             return [2 /*return*/, {\n                                     status: 5 /* GITHUB_ERROR */,\n@@ -4015,70 +4020,75 @@ var PullRequestMergeTask = /** @class */ (function () {\n                         }\n                         return [4 /*yield*/, loadAndValidatePullRequest(this, prNumber, force)];\n                     case 2:\n-                        pullRequest = _b.sent();\n+                        pullRequest = _c.sent();\n                         if (!isPullRequest(pullRequest)) {\n                             return [2 /*return*/, { status: 3 /* FAILED */, failure: pullRequest }];\n                         }\n+                        _a = this.flags.branchPrompt;\n+                        if (!_a) return [3 /*break*/, 4];\n                         return [4 /*yield*/, promptConfirm(getTargettedBranchesConfirmationPromptMessage(pullRequest))];\n                     case 3:\n-                        if (!(_b.sent())) {\n+                        _a = !(_c.sent());\n+                        _c.label = 4;\n+                    case 4:\n+                        if (_a) {\n                             return [2 /*return*/, { status: 4 /* USER_ABORTED */ }];\n                         }\n-                        _a = pullRequest.hasCaretakerNote;\n-                        if (!_a) return [3 /*break*/, 5];\n+                        _b = pullRequest.hasCaretakerNote;\n+                        if (!_b) return [3 /*break*/, 6];\n                         return [4 /*yield*/, promptConfirm(getCaretakerNotePromptMessage(pullRequest))];\n-                    case 4:\n-                        _a = !(_b.sent());\n-                        _b.label = 5;\n                     case 5:\n+                        _b = !(_c.sent());\n+                        _c.label = 6;\n+                    case 6:\n                         // If the pull request has a caretaker note applied, raise awareness by prompting\n                         // the caretaker. The caretaker can then decide to proceed or abort the merge.\n-                        if (_a) {\n+                        if (_b) {\n                             return [2 /*return*/, { status: 4 /* USER_ABORTED */ }];\n                         }\n                         strategy = this.config.githubApiMerge ?\n                             new GithubApiMergeStrategy(this.git, this.config.githubApiMerge) :\n                             new AutosquashMergeStrategy(this.git);\n                         previousBranchOrRevision = null;\n-                        _b.label = 6;\n-                    case 6:\n-                        _b.trys.push([6, 10, 11, 12]);\n+                        _c.label = 7;\n+                    case 7:\n+                        _c.trys.push([7, 11, 12, 13]);\n                         previousBranchOrRevision = this.git.getCurrentBranchOrRevision();\n                         // Run preparations for the merge (e.g. fetching branches).\n                         return [4 /*yield*/, strategy.prepare(pullRequest)];\n-                    case 7:\n+                    case 8:\n                         // Run preparations for the merge (e.g. fetching branches).\n-                        _b.sent();\n+                        _c.sent();\n                         return [4 /*yield*/, strategy.merge(pullRequest)];\n-                    case 8:\n-                        failure = _b.sent();\n+                    case 9:\n+                        failure = _c.sent();\n                         if (failure !== null) {\n                             return [2 /*return*/, { status: 3 /* FAILED */, failure: failure }];\n                         }\n                         // Switch back to the previous branch. We need to do this before deleting the temporary\n                         // branches because we cannot delete branches which are currently checked out.\n                         this.git.run(['checkout', '-f', previousBranchOrRevision]);\n                         return [4 /*yield*/, strategy.cleanup(pullRequest)];\n-                    case 9:\n-                        _b.sent();\n+                    case 10:\n+                        _c.sent();\n                         // Return a successful merge status.\n                         return [2 /*return*/, { status: 2 /* SUCCESS */ }];\n-                    case 10:\n-                        e_1 = _b.sent();\n+                    case 11:\n+                        e_1 = _c.sent();\n                         // Catch all git command errors and return a merge result w/ git error status code.\n                         // Other unknown errors which aren't caused by a git command are re-thrown.\n                         if (e_1 instanceof GitCommandError) {\n                             return [2 /*return*/, { status: 0 /* UNKNOWN_GIT_ERROR */ }];\n                         }\n                         throw e_1;\n-                    case 11:\n+                    case 12:\n                         // Always try to restore the branch if possible. We don't want to leave\n                         // the repository in a different state than before.\n                         if (previousBranchOrRevision !== null) {\n                             this.git.runGraceful(['checkout', '-f', previousBranchOrRevision]);\n                         }\n                         return [7 /*endfinally*/];\n-                    case 12: return [2 /*return*/];\n+                    case 13: return [2 /*return*/];\n                 }\n             });\n         });\n@@ -4106,8 +4116,7 @@ var PullRequestMergeTask = /** @class */ (function () {\n  * @param projectRoot Path to the local Git project that is used for merging.\n  * @param config Configuration for merging pull requests.\n  */\n-function mergePullRequest(prNumber, githubToken, projectRoot, config) {\n-    if (projectRoot === void 0) { projectRoot = getRepoBaseDir(); }\n+function mergePullRequest(prNumber, githubToken, flags) {\n     return tslib.__awaiter(this, void 0, void 0, function () {\n         /** Performs the merge and returns whether it was successful or not. */\n         function performMerge(ignoreFatalErrors) {\n@@ -4223,7 +4232,7 @@ function mergePullRequest(prNumber, githubToken, projectRoot, config) {\n                     // Set the environment variable to skip all git commit hooks triggered by husky. We are unable to\n                     // rely on `--no-verify` as some hooks still run, notably the `prepare-commit-msg` hook.\n                     process.env['HUSKY'] = '0';\n-                    return [4 /*yield*/, createPullRequestMergeTask(githubToken, projectRoot, config)];\n+                    return [4 /*yield*/, createPullRequestMergeTask(githubToken, flags)];\n                 case 1:\n                     api = _a.sent();\n                     return [4 /*yield*/, performMerge(false)];\n@@ -4244,16 +4253,13 @@ function mergePullRequest(prNumber, githubToken, projectRoot, config) {\n  * and optional explicit configuration. An explicit configuration can be specified\n  * when the merge script is used outside of a `ng-dev` configured repository.\n  */\n-function createPullRequestMergeTask(githubToken, projectRoot, explicitConfig) {\n+function createPullRequestMergeTask(githubToken, flags) {\n     return tslib.__awaiter(this, void 0, void 0, function () {\n-        var git_1, devInfraConfig, git, _a, config, errors;\n+        var projectRoot, devInfraConfig, git, _a, config, errors;\n         return tslib.__generator(this, function (_b) {\n             switch (_b.label) {\n                 case 0:\n-                    if (explicitConfig !== undefined) {\n-                        git_1 = new GitClient(githubToken, { github: explicitConfig.remote }, projectRoot);\n-                        return [2 /*return*/, new PullRequestMergeTask(explicitConfig, git_1)];\n-                    }\n+                    projectRoot = getRepoBaseDir();\n                     devInfraConfig = getConfig();\n                     git = new GitClient(githubToken, devInfraConfig, projectRoot);\n                     return [4 /*yield*/, loadAndValidateConfig(devInfraConfig, git.github)];\n@@ -4269,7 +4275,7 @@ function createPullRequestMergeTask(githubToken, projectRoot, explicitConfig) {\n                     config.remote = devInfraConfig.github;\n                     // We can cast this to a merge config with remote because we always set the\n                     // remote above.\n-                    return [2 /*return*/, new PullRequestMergeTask(config, git)];\n+                    return [2 /*return*/, new PullRequestMergeTask(config, git, flags)];\n             }\n         });\n     });\n@@ -4282,24 +4288,43 @@ function createPullRequestMergeTask(githubToken, projectRoot, explicitConfig) {\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-/** Builds the options for the merge command. */\n-function buildMergeCommand(yargs) {\n-    return addGithubTokenOption(yargs).help().strict().positional('pr-number', { demandOption: true, type: 'number' });\n+/** Builds the command. */\n+function builder$7(yargs) {\n+    return addGithubTokenOption(yargs)\n+        .help()\n+        .strict()\n+        .positional('pr', {\n+        demandOption: true,\n+        type: 'number',\n+        description: 'The PR to be merged.',\n+    })\n+        .option('branch-prompt', {\n+        type: 'boolean',\n+        default: true,\n+        description: 'Whether to prompt to confirm the branches a PR will merge into.',\n+    });\n }\n-/** Handles the merge command. i.e. performs the merge of a specified pull request. */\n-function handleMergeCommand(_a) {\n-    var pr = _a[\"pr-number\"], githubToken = _a.githubToken;\n+/** Handles the command. */\n+function handler$7(_a) {\n+    var pr = _a.pr, githubToken = _a.githubToken, branchPrompt = _a.branchPrompt;\n     return tslib.__awaiter(this, void 0, void 0, function () {\n         return tslib.__generator(this, function (_b) {\n             switch (_b.label) {\n-                case 0: return [4 /*yield*/, mergePullRequest(pr, githubToken)];\n+                case 0: return [4 /*yield*/, mergePullRequest(pr, githubToken, { branchPrompt: branchPrompt })];\n                 case 1:\n                     _b.sent();\n                     return [2 /*return*/];\n             }\n         });\n     });\n }\n+/** yargs command module describing the command.  */\n+var MergeCommandModule = {\n+    handler: handler$7,\n+    builder: builder$7,\n+    command: 'merge <pr>',\n+    describe: 'Merge a PR into its targeted branches.',\n+};\n \n /**\n  * @license\n@@ -4459,9 +4484,9 @@ function buildPrParser(localYargs) {\n     return localYargs.help()\n         .strict()\n         .demandCommand()\n-        .command('merge <pr-number>', 'Merge pull requests', buildMergeCommand, handleMergeCommand)\n         .command('discover-new-conflicts <pr-number>', 'Check if a pending PR causes new conflicts for other pending PRs', buildDiscoverNewConflictsCommand, handleDiscoverNewConflictsCommand)\n         .command('rebase <pr-number>', 'Rebase a pending PR and push the rebased commits back to Github', buildRebaseCommand, handleRebaseCommand)\n+        .command(MergeCommandModule)\n         .command(CheckoutCommandModule)\n         .command(CheckTargetBranchesModule);\n }\n@@ -4930,15 +4955,15 @@ function buildReleaseOutput() {\n  * found in the LICENSE file at https://angular.io/license\n  */\n /** Yargs command builder for configuring the `ng-dev release build` command. */\n-function builder$7(argv) {\n+function builder$8(argv) {\n     return argv.option('json', {\n         type: 'boolean',\n         description: 'Whether the built packages should be printed to stdout as JSON.',\n         default: false,\n     });\n }\n /** Yargs command handler for building a release. */\n-function handler$7(args) {\n+function handler$8(args) {\n     return tslib.__awaiter(this, void 0, void 0, function* () {\n         const { npmPackages } = getReleaseConfig();\n         let builtPackages = yield buildReleaseOutput();\n@@ -4973,8 +4998,8 @@ function handler$7(args) {\n }\n /** CLI command module for building release output. */\n const ReleaseBuildCommandModule = {\n-    builder: builder$7,\n-    handler: handler$7,\n+    builder: builder$8,\n+    handler: handler$8,\n     command: 'build',\n     describe: 'Builds the release output for the current branch.',\n };\n@@ -6450,11 +6475,11 @@ class ReleaseTool {\n  * found in the LICENSE file at https://angular.io/license\n  */\n /** Yargs command builder for configuring the `ng-dev release publish` command. */\n-function builder$8(argv) {\n+function builder$9(argv) {\n     return addGithubTokenOption(argv);\n }\n /** Yargs command handler for staging a release. */\n-function handler$8(args) {\n+function handler$9(args) {\n     return tslib.__awaiter(this, void 0, void 0, function* () {\n         const config = getConfig();\n         const releaseConfig = getReleaseConfig(config);\n@@ -6477,8 +6502,8 @@ function handler$8(args) {\n }\n /** CLI command module for publishing a release. */\n const ReleasePublishCommandModule = {\n-    builder: builder$8,\n-    handler: handler$8,\n+    builder: builder$9,\n+    handler: handler$9,\n     command: 'publish',\n     describe: 'Publish new releases and configure version branches.',\n };\n@@ -6490,7 +6515,7 @@ const ReleasePublishCommandModule = {\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-function builder$9(args) {\n+function builder$a(args) {\n     return args\n         .positional('tagName', {\n         type: 'string',\n@@ -6504,7 +6529,7 @@ function builder$9(args) {\n     });\n }\n /** Yargs command handler for building a release. */\n-function handler$9(args) {\n+function handler$a(args) {\n     return tslib.__awaiter(this, void 0, void 0, function* () {\n         const { targetVersion: rawVersion, tagName } = args;\n         const { npmPackages, publishRegistry } = getReleaseConfig();\n@@ -6536,8 +6561,8 @@ function handler$9(args) {\n }\n /** CLI command module for setting an NPM dist tag. */\n const ReleaseSetDistTagCommand = {\n-    builder: builder$9,\n-    handler: handler$9,\n+    builder: builder$a,\n+    handler: handler$a,\n     command: 'set-dist-tag <tag-name> <target-version>',\n     describe: 'Sets a given NPM dist tag for all release packages.',\n };\n@@ -6616,22 +6641,22 @@ function getCurrentGitUser() {\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-function builder$a(args) {\n+function builder$b(args) {\n     return args.option('mode', {\n         demandOption: true,\n         description: 'Whether the env-stamp should be built for a snapshot or release',\n         choices: ['snapshot', 'release']\n     });\n }\n-function handler$a({ mode }) {\n+function handler$b({ mode }) {\n     return tslib.__awaiter(this, void 0, void 0, function* () {\n         buildEnvStamp(mode);\n     });\n }\n /** CLI command module for building the environment stamp. */\n const BuildEnvStampCommand = {\n-    builder: builder$a,\n-    handler: handler$a,\n+    builder: builder$b,\n+    handler: handler$b,\n     command: 'build-env-stamp',\n     describe: 'Build the environment stamping information',\n };"
        },
        {
            "sha": "df57551dfabd98300c9e7c68e3a71109d617330c",
            "filename": "dev-infra/pr/cli.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fpr%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fpr%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fcli.ts?ref=2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f",
            "patch": "@@ -11,22 +11,22 @@ import * as yargs from 'yargs';\n import {CheckTargetBranchesModule} from './check-target-branches/cli';\n import {CheckoutCommandModule} from './checkout/cli';\n import {buildDiscoverNewConflictsCommand, handleDiscoverNewConflictsCommand} from './discover-new-conflicts/cli';\n-import {buildMergeCommand, handleMergeCommand} from './merge/cli';\n+import {MergeCommandModule} from './merge/cli';\n import {buildRebaseCommand, handleRebaseCommand} from './rebase/cli';\n \n /** Build the parser for pull request commands. */\n export function buildPrParser(localYargs: yargs.Argv) {\n   return localYargs.help()\n       .strict()\n       .demandCommand()\n-      .command('merge <pr-number>', 'Merge pull requests', buildMergeCommand, handleMergeCommand)\n       .command(\n           'discover-new-conflicts <pr-number>',\n           'Check if a pending PR causes new conflicts for other pending PRs',\n           buildDiscoverNewConflictsCommand, handleDiscoverNewConflictsCommand)\n       .command(\n           'rebase <pr-number>', 'Rebase a pending PR and push the rebased commits back to Github',\n           buildRebaseCommand, handleRebaseCommand)\n+      .command(MergeCommandModule)\n       .command(CheckoutCommandModule)\n       .command(CheckTargetBranchesModule);\n }"
        },
        {
            "sha": "a71b142a2f98b252779b06555fd21df7d640ac85",
            "filename": "dev-infra/pr/merge/cli.ts",
            "status": "modified",
            "additions": 29,
            "deletions": 10,
            "changes": 39,
            "blob_url": "https://github.com/angular/angular/blob/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fpr%2Fmerge%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fpr%2Fmerge%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2Fcli.ts?ref=2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {Arguments, Argv} from 'yargs';\n+import {Arguments, Argv, CommandModule} from 'yargs';\n \n import {addGithubTokenOption} from '../../utils/git/github-yargs';\n \n@@ -15,17 +15,36 @@ import {mergePullRequest} from './index';\n /** The options available to the merge command via CLI. */\n export interface MergeCommandOptions {\n   githubToken: string;\n-  'pr-number': number;\n+  pr: number;\n+  branchPrompt: boolean;\n }\n \n-/** Builds the options for the merge command. */\n-export function buildMergeCommand(yargs: Argv): Argv<MergeCommandOptions> {\n-  return addGithubTokenOption(yargs).help().strict().positional(\n-      'pr-number', {demandOption: true, type: 'number'});\n+/** Builds the command. */\n+function builder(yargs: Argv) {\n+  return addGithubTokenOption(yargs)\n+      .help()\n+      .strict()\n+      .positional('pr', {\n+        demandOption: true,\n+        type: 'number',\n+        description: 'The PR to be merged.',\n+      })\n+      .option('branch-prompt' as 'branchPrompt', {\n+        type: 'boolean',\n+        default: true,\n+        description: 'Whether to prompt to confirm the branches a PR will merge into.',\n+      });\n }\n \n-/** Handles the merge command. i.e. performs the merge of a specified pull request. */\n-export async function handleMergeCommand(\n-    {'pr-number': pr, githubToken}: Arguments<MergeCommandOptions>) {\n-  await mergePullRequest(pr, githubToken);\n+/** Handles the command. */\n+async function handler({pr, githubToken, branchPrompt}: Arguments<MergeCommandOptions>) {\n+  await mergePullRequest(pr, githubToken, {branchPrompt});\n }\n+\n+/** yargs command module describing the command.  */\n+export const MergeCommandModule: CommandModule<{}, MergeCommandOptions> = {\n+  handler,\n+  builder,\n+  command: 'merge <pr>',\n+  describe: 'Merge a PR into its targeted branches.',\n+};"
        },
        {
            "sha": "c2f5e1a193e64dcfd523a61a855f36cab3782bb1",
            "filename": "dev-infra/pr/merge/index.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 12,
            "changes": 18,
            "blob_url": "https://github.com/angular/angular/blob/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fpr%2Fmerge%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fpr%2Fmerge%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2Findex.ts?ref=2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f",
            "patch": "@@ -14,7 +14,7 @@ import {GITHUB_TOKEN_GENERATE_URL} from '../../utils/git/github-urls';\n import {GitClient} from '../../utils/git/index';\n \n import {loadAndValidateConfig, MergeConfigWithRemote} from './config';\n-import {MergeResult, MergeStatus, PullRequestMergeTask} from './task';\n+import {MergeResult, MergeStatus, PullRequestMergeTask, PullRequestMergeTaskFlags} from './task';\n \n /**\n  * Merges a given pull request based on labels configured in the given merge configuration.\n@@ -30,13 +30,12 @@ import {MergeResult, MergeStatus, PullRequestMergeTask} from './task';\n  * @param config Configuration for merging pull requests.\n  */\n export async function mergePullRequest(\n-    prNumber: number, githubToken: string, projectRoot: string = getRepoBaseDir(),\n-    config?: MergeConfigWithRemote) {\n+    prNumber: number, githubToken: string, flags: PullRequestMergeTaskFlags) {\n   // Set the environment variable to skip all git commit hooks triggered by husky. We are unable to\n   // rely on `--no-verify` as some hooks still run, notably the `prepare-commit-msg` hook.\n   process.env['HUSKY'] = '0';\n \n-  const api = await createPullRequestMergeTask(githubToken, projectRoot, config);\n+  const api = await createPullRequestMergeTask(githubToken, flags);\n \n   // Perform the merge. Force mode can be activated through a command line flag.\n   // Alternatively, if the merge fails with non-fatal failures, the script\n@@ -128,13 +127,8 @@ export async function mergePullRequest(\n  * and optional explicit configuration. An explicit configuration can be specified\n  * when the merge script is used outside of a `ng-dev` configured repository.\n  */\n-async function createPullRequestMergeTask(\n-    githubToken: string, projectRoot: string, explicitConfig?: MergeConfigWithRemote) {\n-  if (explicitConfig !== undefined) {\n-    const git = new GitClient(githubToken, {github: explicitConfig.remote}, projectRoot);\n-    return new PullRequestMergeTask(explicitConfig, git);\n-  }\n-\n+async function createPullRequestMergeTask(githubToken: string, flags: PullRequestMergeTaskFlags) {\n+  const projectRoot = getRepoBaseDir();\n   const devInfraConfig = getConfig();\n   const git = new GitClient(githubToken, devInfraConfig, projectRoot);\n   const {config, errors} = await loadAndValidateConfig(devInfraConfig, git.github);\n@@ -150,5 +144,5 @@ async function createPullRequestMergeTask(\n   config!.remote = devInfraConfig.github;\n   // We can cast this to a merge config with remote because we always set the\n   // remote above.\n-  return new PullRequestMergeTask(config! as MergeConfigWithRemote, git);\n+  return new PullRequestMergeTask(config! as MergeConfigWithRemote, git, flags);\n }"
        },
        {
            "sha": "19e2fd7dd9237ab2a26abdd545c7a80180186e4b",
            "filename": "dev-infra/pr/merge/task.ts",
            "status": "modified",
            "additions": 18,
            "deletions": 2,
            "changes": 20,
            "blob_url": "https://github.com/angular/angular/blob/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fpr%2Fmerge%2Ftask.ts",
            "raw_url": "https://github.com/angular/angular/raw/2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f/dev-infra%2Fpr%2Fmerge%2Ftask.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2Ftask.ts?ref=2980d85b8cd8ec7d0dda657c2ade640fc7f5ff0f",
            "patch": "@@ -34,13 +34,28 @@ export interface MergeResult {\n   failure?: PullRequestFailure;\n }\n \n+export interface PullRequestMergeTaskFlags {\n+  branchPrompt: boolean;\n+}\n+\n+const defaultPullRequestMergeTaskFlags: PullRequestMergeTaskFlags = {\n+  branchPrompt: true,\n+};\n+\n /**\n  * Class that accepts a merge script configuration and Github token. It provides\n  * a programmatic interface for merging multiple pull requests based on their\n  * labels that have been resolved through the merge script configuration.\n  */\n export class PullRequestMergeTask {\n-  constructor(public config: MergeConfigWithRemote, public git: GitClient) {}\n+  private flags: PullRequestMergeTaskFlags;\n+\n+  constructor(\n+      public config: MergeConfigWithRemote, public git: GitClient,\n+      flags: Partial<PullRequestMergeTaskFlags>) {\n+    // Update flags property with the provided flags values as patches to the default flag values.\n+    this.flags = {...defaultPullRequestMergeTaskFlags, ...flags};\n+  }\n \n   /**\n    * Merges the given pull request and pushes it upstream.\n@@ -79,7 +94,8 @@ export class PullRequestMergeTask {\n     }\n \n \n-    if (!await promptConfirm(getTargettedBranchesConfirmationPromptMessage(pullRequest))) {\n+    if (this.flags.branchPrompt &&\n+        !await promptConfirm(getTargettedBranchesConfirmationPromptMessage(pullRequest))) {\n       return {status: MergeStatus.USER_ABORTED};\n     }\n "
        }
    ],
    "stats": {
        "total": 226,
        "additions": 140,
        "deletions": 86
    }
}