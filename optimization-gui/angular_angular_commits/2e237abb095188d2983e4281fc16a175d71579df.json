{
    "author": "mhevery",
    "message": "refactor(core): Change `TName.tagName` to a more generic `value` name. (#39233)\n\nThis is a pre-requisite for making the `TNode.value` a generic storage\nmechanism for attaching data to `TNode`.\n\nPR Close #39233",
    "sha": "2e237abb095188d2983e4281fc16a175d71579df",
    "files": [
        {
            "sha": "8f0cc9a70632aa281e563b7059017b7490e4a75c",
            "filename": "packages/core/src/debug/debug_node.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Fdebug%2Fdebug_node.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Fdebug%2Fdebug_node.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Fdebug%2Fdebug_node.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -266,7 +266,7 @@ class DebugElement__POST_R3__ extends DebugNode__POST_R3__ implements DebugEleme\n       const lView = context.lView;\n       const tData = lView[TVIEW].data;\n       const tNode = tData[context.nodeIndex] as TNode;\n-      return tNode.tagName!;\n+      return tNode.value!;\n     } catch (e) {\n       return this.nativeNode.nodeName;\n     }"
        },
        {
            "sha": "ad163b5447f772adde5042ccc244bd0d22f57454",
            "filename": "packages/core/src/render3/errors.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Ferrors.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Ferrors.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Ferrors.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -22,7 +22,7 @@ export function throwCyclicDependencyError(token: any): never {\n \n /** Called when there are multiple component selectors that match a given node */\n export function throwMultipleComponentError(tNode: TNode): never {\n-  throw new Error(`Multiple components match node with tagname ${tNode.tagName}`);\n+  throw new Error(`Multiple components match node with tagname ${tNode.value}`);\n }\n \n export function throwMixedMultiProviderError() {"
        },
        {
            "sha": "8993c6093dbc698f1286b591a80675d433e1146b",
            "filename": "packages/core/src/render3/i18n/i18n_util.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_util.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_util.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_util.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -40,9 +40,9 @@ export function getTIcu(tView: TView, index: number): TIcu|null {\n   // either TIcu or TIcuContainerNode. This is not ideal, but we still think it is OK because it\n   // will be just two cases which fits into the browser inline cache (inline cache can take up to\n   // 4)\n-  const tIcu = value.hasOwnProperty('currentCaseLViewIndex') ?\n+  const tIcu: TIcu = value.hasOwnProperty('currentCaseLViewIndex') ?\n       value :\n-      (value as TIcuContainerNode).tagName as any;\n+      (value as TIcuContainerNode).value as any;\n   ngDevMode && assertTIcu(tIcu);\n   return tIcu;\n }\n@@ -71,9 +71,7 @@ export function setTIcu(tView: TView, index: number, tIcu: TIcu): void {\n     tView.data[index] = tIcu;\n   } else {\n     ngDevMode && assertNodeType(tNode, TNodeType.IcuContainer);\n-    // FIXME(misko): This is a hack which allows us to associate `TI18n` with `TNode`.\n-    // This should be refactored so that one can attach arbitrary data with `TNode`\n-    tNode.tagName = tIcu as any;\n+    tNode.value = tIcu as any;\n   }\n }\n "
        },
        {
            "sha": "01aaa4c4e5a51d3c0e55a882fb58c7e6535604fa",
            "filename": "packages/core/src/render3/instructions/element.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Felement.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Felement.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Felement.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -188,7 +188,7 @@ function logUnknownElementError(\n   // execute the check below.\n   if (schemas === null) return;\n \n-  const tagName = tNode.tagName;\n+  const tagName = tNode.value;\n \n   // If the element matches any directive, it's considered as valid.\n   if (!hasDirectives && tagName !== null) {"
        },
        {
            "sha": "78c239d7cd49eb70626df3b0bb04d5f5058e0c14",
            "filename": "packages/core/src/render3/instructions/i18n_icu_container_visitor.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fi18n_icu_container_visitor.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fi18n_icu_container_visitor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fi18n_icu_container_visitor.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -43,7 +43,7 @@ export function loadIcuContainerVisitor() {\n     // FIXME(misko): This is a hack which allows us to associate `TI18n` with `TNode`.\n     // This should be refactored so that one can attach arbitrary data with `TNode`\n     ngDevMode && assertTNodeForLView(tIcuContainerNode, lView);\n-    const tIcu: TIcu = tIcuContainerNode.tagName as any;\n+    const tIcu: TIcu = tIcuContainerNode.value as any;\n     enterIcu(tIcu, lView);\n     return icuContainerIteratorNext;\n   }"
        },
        {
            "sha": "4d929b06420b3cc7e2232d1cf9a7a59e5927563d",
            "filename": "packages/core/src/render3/instructions/lview_debug.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Flview_debug.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Flview_debug.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Flview_debug.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -184,7 +184,7 @@ class TNode implements ITNode {\n       public propertyBindings: number[]|null,                                        //\n       public flags: TNodeFlags,                                                      //\n       public providerIndexes: TNodeProviderIndexes,                                  //\n-      public tagName: string|null,                                                   //\n+      public value: string|null,                                                     //\n       public attrs: (string|AttributeMarker|(string|SelectorFlags)[])[]|null,        //\n       public mergedAttrs: (string|AttributeMarker|(string|SelectorFlags)[])[]|null,  //\n       public localNames: (string|number)[]|null,                                     //\n@@ -256,9 +256,9 @@ class TNode implements ITNode {\n   }\n \n   get template_(): string {\n-    if (this.tagName === null && this.type === TNodeType.Element) return '#text';\n+    if (this.value === null && this.type === TNodeType.Element) return '#text';\n     const buf: string[] = [];\n-    const tagName = typeof this.tagName === 'string' && this.tagName || this.type_;\n+    const tagName = typeof this.value === 'string' && this.value || this.type_;\n     buf.push('<', tagName);\n     if (this.flags) {\n       buf.push(' ', this.flags_);"
        },
        {
            "sha": "3ed54440a8a4b0e091a3f15a89050b21ef2a9078",
            "filename": "packages/core/src/render3/instructions/shared.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 11,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fshared.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fshared.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fshared.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -227,7 +227,7 @@ export function getOrCreateTNode(\n     }\n   } else if (tNode.type == TNodeType.Placeholder) {\n     tNode.type = type;\n-    tNode.tagName = name;\n+    tNode.value = name;\n     tNode.attrs = attrs;\n     const parent = getCurrentParentTNode();\n     tNode.injectorIndex = parent === null ? -1 : parent.injectorIndex;\n@@ -834,7 +834,7 @@ export function createTNode(\n     tagName: string|null, attrs: TAttributes|null): TNode;\n export function createTNode(\n     tView: TView, tParent: TElementNode|TContainerNode|null, type: TNodeType, adjustedIndex: number,\n-    tagName: string|null, attrs: TAttributes|null): TNode {\n+    value: string|null, attrs: TAttributes|null): TNode {\n   ngDevMode && assertNotSame(attrs, undefined, '\\'undefined\\' is not valid value for \\'attrs\\'');\n   ngDevMode && ngDevMode.tNode++;\n   ngDevMode && tParent && assertTNodeForTView(tParent, tView);\n@@ -852,7 +852,7 @@ export function createTNode(\n           null,           // propertyBindings: number[]|null\n           0,              // flags: TNodeFlags\n           0,              // providerIndexes: TNodeProviderIndexes\n-          tagName,        // tagName: string|null\n+          value,          // value: string|null\n           attrs,          // attrs: (string|AttributeMarker|(string|SelectorFlags)[])[]|null\n           null,           // mergedAttrs\n           null,           // localNames: (string|number)[]|null\n@@ -885,7 +885,7 @@ export function createTNode(\n         propertyBindings: null,\n         flags: 0,\n         providerIndexes: 0,\n-        tagName: tagName,\n+        value: value,\n         attrs: attrs,\n         mergedAttrs: null,\n         localNames: null,\n@@ -1027,7 +1027,7 @@ export function elementPropertyInternal<T>(\n \n     // It is assumed that the sanitizer is only added when the compiler determines that the\n     // property is risky, so sanitization can be done without further checks.\n-    value = sanitizer != null ? (sanitizer(value, tNode.tagName || '', propName) as any) : value;\n+    value = sanitizer != null ? (sanitizer(value, tNode.value || '', propName) as any) : value;\n     if (isProceduralRenderer(renderer)) {\n       renderer.setProperty(element as RElement, propName, value);\n     } else if (!isAnimationProp(propName)) {\n@@ -1037,7 +1037,7 @@ export function elementPropertyInternal<T>(\n   } else if (tNode.type === TNodeType.Container || tNode.type === TNodeType.ElementContainer) {\n     // If the node is a container and the property didn't\n     // match any of the inputs or schemas we should throw.\n-    if (ngDevMode && !matchingSchemas(tView, tNode.tagName)) {\n+    if (ngDevMode && !matchingSchemas(tView, tNode.value)) {\n       logUnknownPropertyError(propName, tNode);\n     }\n   }\n@@ -1104,7 +1104,7 @@ function validateProperty(\n \n   // The property is considered valid if the element matches the schema, it exists on the element\n   // or it is synthetic, and we are in a browser context (web worker nodes should be skipped).\n-  if (matchingSchemas(tView, tNode.tagName) || propName in element || isAnimationProp(propName)) {\n+  if (matchingSchemas(tView, tNode.value) || propName in element || isAnimationProp(propName)) {\n     return true;\n   }\n \n@@ -1135,8 +1135,7 @@ export function matchingSchemas(tView: TView, tagName: string|null): boolean {\n  * @param tNode Node on which we encountered the property.\n  */\n function logUnknownPropertyError(propName: string, tNode: TNode): void {\n-  console.error(\n-      `Can't bind to '${propName}' since it isn't a known property of '${tNode.tagName}'.`);\n+  console.error(`Can't bind to '${propName}' since it isn't a known property of '${tNode.value}'.`);\n }\n \n /**\n@@ -1404,7 +1403,7 @@ function findDirectiveDefMatches(\n           if (ngDevMode) {\n             assertNodeOfPossibleTypes(\n                 tNode, [TNodeType.Element],\n-                `\"${tNode.tagName}\" tags cannot be used as component hosts. ` +\n+                `\"${tNode.value}\" tags cannot be used as component hosts. ` +\n                     `Please use a different tag to activate the ${stringify(def.type)} component.`);\n \n             if (tNode.flags & TNodeFlags.isComponentHost) throwMultipleComponentError(tNode);\n@@ -1525,7 +1524,7 @@ export function elementAttributeInternal(\n             `Host bindings are not valid on ng-container or ng-template.`);\n   }\n   const element = getNativeByTNode(tNode, lView) as RElement;\n-  setElementAttribute(lView[RENDERER], element, namespace, tNode.tagName, name, value, sanitizer);\n+  setElementAttribute(lView[RENDERER], element, namespace, tNode.value, name, value, sanitizer);\n }\n \n export function setElementAttribute("
        },
        {
            "sha": "e68212203158f0ad28d56f0a15769e73c5b9a574",
            "filename": "packages/core/src/render3/interfaces/node.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finterfaces%2Fnode.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Finterfaces%2Fnode.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finterfaces%2Fnode.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -427,10 +427,14 @@ export interface TNode {\n   // TODO(misko): break this into actual vars.\n   providerIndexes: TNodeProviderIndexes;\n \n-  /** The tag name associated with this node. */\n-  // FIXME(misko): rename to `value` and change the type to `any` so that\n-  // subclasses of `TNode` can use it to link additional payload\n-  tagName: string|null;\n+  /**\n+   * The value name associated with this node.\n+   * if type:\n+   *   `TNodeType.Text`: text value\n+   *   `TNodeType.Element`: tag name\n+   *   `TNodeType.ICUContainer`: `TIcu`\n+   */\n+  value: string|null;\n \n   /**\n    * Attributes associated with an element. We need to store attributes to support various use-cases"
        },
        {
            "sha": "9730a741d0b20c10c277c86523f6c7c5f4bee432",
            "filename": "packages/core/src/render3/node_selector_matcher.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Fnode_selector_matcher.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Fsrc%2Frender3%2Fnode_selector_matcher.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fnode_selector_matcher.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -62,7 +62,7 @@ function isCssClassMatching(\n  * @param tNode current TNode\n  */\n export function isInlineTemplate(tNode: TNode): boolean {\n-  return tNode.type === TNodeType.Container && tNode.tagName !== NG_TEMPLATE_SELECTOR;\n+  return tNode.type === TNodeType.Container && tNode.value !== NG_TEMPLATE_SELECTOR;\n }\n \n /**\n@@ -78,9 +78,8 @@ export function isInlineTemplate(tNode: TNode): boolean {\n  */\n function hasTagAndTypeMatch(\n     tNode: TNode, currentSelector: string, isProjectionMode: boolean): boolean {\n-  const tagNameToCompare = tNode.type === TNodeType.Container && !isProjectionMode ?\n-      NG_TEMPLATE_SELECTOR :\n-      tNode.tagName;\n+  const tagNameToCompare =\n+      tNode.type === TNodeType.Container && !isProjectionMode ? NG_TEMPLATE_SELECTOR : tNode.value;\n   return currentSelector === tagNameToCompare;\n }\n "
        },
        {
            "sha": "8172c98f90facff9dff6d4a085b90ecbd426ea44",
            "filename": "packages/core/test/acceptance/debug_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Ftest%2Facceptance%2Fdebug_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Ftest%2Facceptance%2Fdebug_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Facceptance%2Fdebug_spec.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -54,7 +54,7 @@ onlyInIvy('Ivy specific').describe('Debug Representation', () => {\n           end: HEADER_OFFSET + 2,\n           length: 2,\n           content: [\n-            {index: HEADER_OFFSET + 0, t: matchTNode({tagName: 'div'}), l: matchDomElement('div')},\n+            {index: HEADER_OFFSET + 0, t: matchTNode({value: 'div'}), l: matchDomElement('div')},\n             {index: HEADER_OFFSET + 1, t: matchTI18n(), l: null},\n           ]\n         });\n@@ -70,7 +70,7 @@ onlyInIvy('Ivy specific').describe('Debug Representation', () => {\n           length: 1,\n           content: [{\n             index: HEADER_OFFSET + 3,\n-            t: matchTNode({type: TNodeType.Element, tagName: null}),\n+            t: matchTNode({type: TNodeType.Element, value: null}),\n             l: matchDomText('Hello World')\n           }]\n         });"
        },
        {
            "sha": "ac72703c7ebe1b602ccb31f2b03fab9fa857c9ff",
            "filename": "packages/core/test/render3/is_shape_of.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Ftest%2Frender3%2Fis_shape_of.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Ftest%2Frender3%2Fis_shape_of.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fis_shape_of.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -157,7 +157,7 @@ const ShapeOfTNode: ShapeOf<TNode> = {\n   propertyBindings: true,\n   flags: true,\n   providerIndexes: true,\n-  tagName: true,\n+  value: true,\n   attrs: true,\n   mergedAttrs: true,\n   localNames: true,"
        },
        {
            "sha": "a9f0e1fc7138fa53ccd51c23db9dc94233f4ed23",
            "filename": "packages/core/test/render3/matchers_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Ftest%2Frender3%2Fmatchers_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/2e237abb095188d2983e4281fc16a175d71579df/packages%2Fcore%2Ftest%2Frender3%2Fmatchers_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fmatchers_spec.ts?ref=2e237abb095188d2983e4281fc16a175d71579df",
            "patch": "@@ -60,7 +60,7 @@ describe('render3 matchers', () => {\n \n     it('should match', () => {\n       expect(tNode).toEqual(matchTNode());\n-      expect(tNode).toEqual(matchTNode({type: TNodeType.Element, tagName: 'tagName'}));\n+      expect(tNode).toEqual(matchTNode({type: TNodeType.Element, value: 'tagName'}));\n       expect({node: tNode}).toEqual({node: matchTNode({type: TNodeType.Element})});\n     });\n   });"
        }
    ],
    "stats": {
        "total": 70,
        "additions": 35,
        "deletions": 35
    }
}