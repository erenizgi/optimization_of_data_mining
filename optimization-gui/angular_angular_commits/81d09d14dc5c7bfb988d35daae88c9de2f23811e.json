{
    "author": "JoostK",
    "message": "docs: deprecate input setter coercion fields (#43506)\n\nSince the `strictTemplates` flag has been introduced in Angular the\ncompiler has been able to type-check input bindings to the declared\ninput type of the corresponding directive. When a getter/setter pair is\nbeing used for the input it may be desirable to let the setter accept a\nbroader set of types than what is returned by the getter, for example\nwhen the setter first converts the input value. However, until\nTypeScript 4.3 a getter/setter pair was required to have identical types\nso this pattern could not be accurately declared.\n\nTo mitigate this limitation, it was made possible to declare\ninput setter coercion fields in directives that are used when\ntype-checking input bindings. However, since TypeScript 4.3 the\nlimitation has been removed; setters can now accept a wider type than\nwhat is returned by the getter. This means that input coercion fields\nare no longer needed, as their effects can be achieved by widening the\ntype of the setter.\n\nPR Close #43506",
    "sha": "81d09d14dc5c7bfb988d35daae88c9de2f23811e",
    "files": [
        {
            "sha": "bc430713151c00b2a04b57324ab10d0b8fbdac14",
            "filename": "aio/content/guide/aot-compiler.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/81d09d14dc5c7bfb988d35daae88c9de2f23811e/aio%2Fcontent%2Fguide%2Faot-compiler.md",
            "raw_url": "https://github.com/angular/angular/raw/81d09d14dc5c7bfb988d35daae88c9de2f23811e/aio%2Fcontent%2Fguide%2Faot-compiler.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fguide%2Faot-compiler.md?ref=81d09d14dc5c7bfb988d35daae88c9de2f23811e",
            "patch": "@@ -618,7 +618,7 @@ For example, to avoid `Object is possibly 'undefined'` error in the template abo\n \n Using `*ngIf` allows the TypeScript compiler to infer that the `person` used in the binding expression will never be `undefined`.\n \n-For more information about input type narrowing, see [Input setter coercion](guide/template-typecheck#input-setter-coercion) and [Improving template type checking for custom directives](guide/structural-directives#directive-type-checks).\n+For more information about input type narrowing, see [Improving template type checking for custom directives](guide/structural-directives#directive-type-checks).\n \n ### Non-null type assertion operator\n "
        },
        {
            "sha": "f3a92f5357a390ae4c457420ca109b34a631fbd0",
            "filename": "aio/content/guide/deprecations.md",
            "status": "modified",
            "additions": 50,
            "deletions": 0,
            "changes": 50,
            "blob_url": "https://github.com/angular/angular/blob/81d09d14dc5c7bfb988d35daae88c9de2f23811e/aio%2Fcontent%2Fguide%2Fdeprecations.md",
            "raw_url": "https://github.com/angular/angular/raw/81d09d14dc5c7bfb988d35daae88c9de2f23811e/aio%2Fcontent%2Fguide%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fguide%2Fdeprecations.md?ref=81d09d14dc5c7bfb988d35daae88c9de2f23811e",
            "patch": "@@ -48,6 +48,7 @@ v12 - v15\n | template syntax         | [`<template>`](#template-tag)                                                                 | <!--v7--> v11         |\n | polyfills               | [reflect-metadata](#reflect-metadata)                                                         | <!--v8--> v11         |\n | npm package format      | [`esm5` and `fesm5` entry-points in @angular/* npm packages](guide/deprecations#esm5-fesm5)   | <!-- v9 --> v11       |\n+| `@angular/compiler-cli` | [Input setter coercion](#input-setter-coercion)                                               | <!--v13--> v15        |\n | `@angular/core`         | [`defineInjectable`](#core)                                                                   | <!--v8--> v11         |\n | `@angular/core`         | [`entryComponents`](api/core/NgModule#entryComponents)                                        | <!--v9--> v11         |\n | `@angular/core`         | [`ANALYZE_FOR_ENTRY_COMPONENTS`](api/core/ANALYZE_FOR_ENTRY_COMPONENTS)                       | <!--v9--> v11         |\n@@ -475,6 +476,55 @@ For full rationale and discussion behind this deprecation, see [RFC: Internet Ex\n **Note**: IE11 will be supported in Angular v12 LTS releases through November 2022.\n -->\n \n+{@a input-setter-coercion}\n+### Input setter coercion\n+\n+Since the `strictTemplates` flag has been introduced in Angular the compiler has been able to type-check input bindings to the declared input type of the corresponding directive.\n+When a getter/setter pair is being used for the input it may be desirable to let the setter accept a broader set of types than what is returned by the getter, for example when the setter first converts the input value.\n+However, until TypeScript 4.3 a getter/setter pair was required to have identical types so this pattern could not be accurately declared.\n+\n+To mitigate this limitation, it was made possible to declare [input setter coercion fields](guide/template-typecheck#input-setter-coercion) in directives that are used when type-checking input bindings.\n+However, since [TypeScript 4.3](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-3.html#separate-write-types-on-properties) the limitation has been removed; setters can now accept a wider type than what is returned by the getter.\n+This means that input coercion fields are no longer needed, as their effects can be achieved by widening the type of the setter.\n+\n+For example, the following directive:\n+\n+```typescript\n+@Component({...})\n+class SubmitButton {\n+  private _disabled: boolean;\n+\n+  @Input()\n+  get disabled(): boolean {\n+    return this._disabled;\n+  }\n+\n+  set disabled(value: boolean) {\n+    this._disabled = (value === '') || value;\n+  }\n+\n+  static ngAcceptInputType_disabled: boolean|'';\n+}\n+```\n+\n+can be refactored as follows:\n+\n+```typescript\n+@Component({...})\n+class SubmitButton {\n+  private _disabled: boolean;\n+\n+  @Input()\n+  get disabled(): boolean {\n+    return this._disabled;\n+  }\n+\n+  set disabled(value: boolean|'') {\n+    this._disabled = (value === '') || value;\n+  }\n+}\n+```\n+\n {@a deprecated-cli-flags}\n \n ## Deprecated CLI APIs and Options"
        },
        {
            "sha": "3593b18ba4430949475eaa33d0bade8b7d0d98b1",
            "filename": "aio/content/guide/template-typecheck.md",
            "status": "modified",
            "additions": 8,
            "deletions": 2,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/81d09d14dc5c7bfb988d35daae88c9de2f23811e/aio%2Fcontent%2Fguide%2Ftemplate-typecheck.md",
            "raw_url": "https://github.com/angular/angular/raw/81d09d14dc5c7bfb988d35daae88c9de2f23811e/aio%2Fcontent%2Fguide%2Ftemplate-typecheck.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fguide%2Ftemplate-typecheck.md?ref=81d09d14dc5c7bfb988d35daae88c9de2f23811e",
            "patch": "@@ -207,7 +207,7 @@ Here, during type checking of the template for `AppComponent`, the `[user]=\"sele\n Therefore, Angular assigns the `selectedUser` property to `UserDetailComponent.user`, which would result in an error if their types were incompatible.\n TypeScript checks the assignment according to its type system, obeying flags such as `strictNullChecks` as they are configured in the application.\n \n-Avoid run-time type errors by providing more specific in-template type requirements to the template type checker. Make the input type requirements for your own directives as specific as possible by providing template-guard functions in the directive definition. See [Improving template type checking for custom directives](guide/structural-directives#directive-type-checks), and [Input setter coercion](#input-setter-coercion) in this guide.\n+Avoid run-time type errors by providing more specific in-template type requirements to the template type checker. Make the input type requirements for your own directives as specific as possible by providing template-guard functions in the directive definition. See [Improving template type checking for custom directives](guide/structural-directives#directive-type-checks) in this guide.\n \n \n ### Strict null checks\n@@ -299,7 +299,7 @@ set disabled(value: boolean) {\n ```\n \n It would be ideal to change the type of `value` here, from `boolean` to `boolean|''`, to match the set of values which are actually accepted by the setter.\n-TypeScript requires that both the getter and setter have the same type, so if the getter should return a `boolean` then the setter is stuck with the narrower type.\n+TypeScript prior to version 4.3 requires that both the getter and setter have the same type, so if the getter should return a `boolean` then the setter is stuck with the narrower type.\n \n If the consumer has Angular's strictest type checking for templates enabled, this creates a problem: the empty string `''` is not actually assignable to the `disabled` field, which creates a type error when the attribute form is used.\n \n@@ -322,6 +322,12 @@ class SubmitButton {\n }\n ```\n \n+<div class=\"alert is-important\">\n+\n+Since TypeScript 4.3, the setter could have been declared to accept `boolean|''` as type, making the input setter coercion field obsolete. As such, input setters coercion fields have been deprecated. \n+\n+</div>\n+\n This field does not need to have a value. Its existence communicates to the Angular type checker that the `disabled` input should be considered as accepting bindings that match the type `boolean|''`. The suffix should be the `@Input` _field_ name.\n \n Care should be taken that if an `ngAcceptInputType_` override is present for a given input, then the setter should be able to handle any values of the overridden type."
        }
    ],
    "stats": {
        "total": 62,
        "additions": 59,
        "deletions": 3
    }
}