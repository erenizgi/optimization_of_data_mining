{
    "author": "dario-piotrowicz",
    "message": "docs(core): improve viewEncapsulation documentation (#44151)\n\nSlighlty improve the `viewEncapsulation` documentation (both in code\ncomments and content files) to make it more clear and understandable.\n\nSee https://github.com/angular/angular/pull/44099#discussion_r745890903\n\nPR Close #44151",
    "sha": "6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19",
    "files": [
        {
            "sha": "c50bee777f5525d886cef15200ee5a5ab09ecfff",
            "filename": "aio/content/examples/component-styles/src/app/quest-summary.component.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/aio%2Fcontent%2Fexamples%2Fcomponent-styles%2Fsrc%2Fapp%2Fquest-summary.component.ts",
            "raw_url": "https://github.com/angular/angular/raw/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/aio%2Fcontent%2Fexamples%2Fcomponent-styles%2Fsrc%2Fapp%2Fquest-summary.component.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fcomponent-styles%2Fsrc%2Fapp%2Fquest-summary.component.ts?ref=6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19",
            "patch": "@@ -10,9 +10,3 @@ import { Component } from '@angular/core';\n })\n export class QuestSummaryComponent { }\n // #enddocregion\n-/*\n-  // #docregion encapsulation.shadow\n-  // warning: not all browsers support shadow DOM encapsulation at this time\n-  encapsulation: ViewEncapsulation.ShadowDom\n-  // #enddocregion encapsulation.shadow\n-*/"
        },
        {
            "sha": "e531edd7139db861586c161621c83255885d8289",
            "filename": "aio/content/guide/view-encapsulation.md",
            "status": "modified",
            "additions": 43,
            "deletions": 52,
            "changes": 95,
            "blob_url": "https://github.com/angular/angular/blob/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/aio%2Fcontent%2Fguide%2Fview-encapsulation.md",
            "raw_url": "https://github.com/angular/angular/raw/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/aio%2Fcontent%2Fguide%2Fview-encapsulation.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fguide%2Fview-encapsulation.md?ref=6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19",
            "patch": "@@ -1,46 +1,37 @@\n # View encapsulation\n \n-In Angular, component CSS styles are encapsulated into the component's view and don't\n-affect the rest of the application.\n+In Angular, a component's styles can be encapsulated within the component's host element so that they don't affect the rest of the application.\n+\n+The `Component`'s decorator provides the [`encapsulation`](api/core/Component#encapsulation) option which can be used to control how the encapsulation is applied on a _per component_ basis.\n \n-To control how this encapsulation happens on a _per\n-component_ basis, set the _view encapsulation mode_ in the component metadata.\n Choose from the following modes:\n \n-- `ShadowDom` view encapsulation uses the browser's built-in shadow DOM implementation (see\n-  [Shadow DOM](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM))\n-  to attach a shadow DOM to the component's host element, and then puts the component\n-  view inside that shadow DOM. The component's styles are included within the shadow DOM.\n+- `ViewEncapsulation.ShadowDom`, Angular uses the browser's built-in [Shadow DOM API](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM)) to enclose the component's view inside a ShadowRoot (used as the component's host element) and apply the provided styles in an isolated manner.\n+\n+- `ViewEncapsulation.Emulated`, Angular modifies the component's CSS selectors so that they are only applied to the component's view and do not affect other elements in the application (_emulating_ Shadow DOM behavior). For more details, see [Inspecting generated CSS](guide/view-encapsulation#inspect-generated-css).\n \n-- `Emulated` view encapsulation (the default) emulates the behavior of shadow DOM by preprocessing\n-  (and renaming) the CSS code to effectively scope the CSS to the component's view.\n-  For details, see [Inspecting generated CSS](guide/view-encapsulation#inspect-generated-css).\n+- `ViewEncapsulation.None`, Angular does not apply any sort of view encapsulation meaning that any styles specified\n+  for the component are actually globally applied and can affect any HTML element present within the application.\n+  This mode is essentially the same as including the styles into the HTML itself.\n \n-- `None` means that Angular does no view encapsulation.\n-  Angular adds the CSS to the global styles.\n-  The scoping rules, isolations, and protections discussed earlier don't apply.\n-  This mode is essentially the same as pasting the component's styles into the HTML.\n+<div class=\"alert is-important\">\n \n-To set the component's encapsulation mode, use the `encapsulation` property in the component metadata:\n+  `ViewEncapsulation.ShadowDom` only works on browsers that have built-in support\n+  for the shadow DOM (see [Can I use - Shadow DOM v1](https://caniuse.com/shadowdomv1)).\n+  Not all browsers support it, which is why the `ViewEncapsulation.Emulated` is the recommended and default mode.\n \n-<code-example path=\"component-styles/src/app/quest-summary.component.ts\" region=\"encapsulation.shadow\" header=\"src/app/quest-summary.component.ts\"></code-example>\n+</div>\n \n-`ShadowDom` view encapsulation only works on browsers that have built-in support\n-for shadow DOM (see [Can I use - Shadow DOM v1](https://caniuse.com/shadowdomv1)).\n-The support is still limited, which is why `Emulated` view encapsulation is the default mode and recommended in most cases.\n \n {@a inspect-generated-css}\n \n ## Inspecting generated CSS\n \n-When using emulated view encapsulation, Angular preprocesses\n-all component styles so that they approximate the standard shadow CSS scoping rules.\n+When using the emulated view encapsulation, Angular pre-processes all the component's styles so that they are only applied to the component's view.\n \n-In the DOM of a running Angular application with emulated view\n-encapsulation enabled, each DOM element has some extra attributes\n-attached to it:\n+In the DOM of a running Angular application, elements belonging to components using emulated view encapsulation have some extra attributes attached to them:\n \n-<code-example format=\"\">\n+<code-example format=\"html\" language=\"html\">\n &lt;hero-details _nghost-pmm-5>\n   &lt;h2 _ngcontent-pmm-5>Mister Fantastic&lt;/h2>\n   &lt;hero-team _ngcontent-pmm-5 _nghost-pmm-6>\n@@ -49,18 +40,16 @@ attached to it:\n &lt;/hero-detail>\n </code-example>\n \n-There are two kinds of generated attributes:\n+There are two kinds of such attributes:\n+\n+- `_nghost` attributes are added to elements that enclose a component's view and that would be ShadowRoots in a native Shadow DOM encapsulation. This is typically the case for components' host elements.\n+- `_ngcontent` attributes are added to child element within a component's view, those are used to match the elements with their respective emulated ShadowRoots (host elements with a matching `_nghost` attribute).\n \n-- An element that would be a shadow DOM host in native encapsulation has a\n-  generated `_nghost` attribute. This is typically the case for component host elements.\n-- An element within a component's view has a `_ngcontent` attribute\n-  that identifies to which host's emulated shadow DOM this element belongs.\n+The exact values of these attributes are a private implementation detail of Angular. They are automatically generated and you should never refer to them in application code.\n \n-The exact values of these attributes aren't important. They are automatically\n-generated and you should never refer to them in application code. But they are targeted\n-by the generated component styles, which are in the `<head>` section of the DOM:\n+They are targeted by the generated component styles, which are injected in the `<head>` section of the DOM:\n \n-<code-example format=\"\">\n+<code-example format=\"css\" language=\"css\">\n [_nghost-pmm-5] {\n   display: block;\n   border: 1px solid black;\n@@ -72,25 +61,29 @@ h3[_ngcontent-pmm-6] {\n }\n </code-example>\n \n-These styles are post-processed so that each selector is augmented\n-with `_nghost` or `_ngcontent` attribute selectors.\n-These extra selectors enable the scoping rules described in this page.\n+These styles are post-processed so that each CSS selector is augmented with the appropriate `_nghost` or `_ngcontent` attribute. These modified selectors make sure the styles to be applied to components' views in an isolated and targeted fashion.\n \n ## Mixing encapsulation modes\n \n-Avoid mixing components that use different view encapsulation. Where it is necessary, you should be aware of how the component styles will interact.\n+As previously mentioned you specify the encapsulation mode in the Component's decorator on a _per component_ basis, this means that within your application you can have different components using different encapsulation strategies.\n+\n+Although possible, this is not recommended. If it is really needed you should be aware of how the styles of components using different encapsulation modes will interact with each other:\n+\n+- The styles of components with `ViewEncapsulation.Emulated` are added to the `<head>` of the document, making them available throughout the application, but their selectors only affect elements within their respective components' templates.\n+\n+- The styles of components with `ViewEncapsulation.None` are added to the `<head>` of the document, making them available throughout the application, so are completely global and affect any matching elements within the document.\n \n-- The styles of components with `ViewEncapsulation.Emulated` are added to the `<head>` of the document, making them available throughout the application, but are \"scoped\" so they only affect elements within the component's template.\n+- The styles of components with `ViewEncapsulation.ShadowDom` are only added to the shadow DOM host, ensuring that they only affect elements within their respective components' views.\n \n-- The styles of components with `ViewEncapsulation.None` are added to the `<head>` of the document, making them available throughout the application, and are not \"scoped\" so they can affect any element in the application.\n+<div class=\"alert is-helpful\">\n \n-- The styles of components with `ViewEncapsulation.ShadowDom` are only added to the shadow DOM host, ensuring that they only affect elements within the component's template.\n+  Styles of `ViewEncapsulation.Emulated` and `ViewEncapsulation.None` components are also added to the shadow DOM host of each `ViewEncapsulation.ShadowDom` component.\n \n-**All the styles for `ViewEncapsulation.Emulated` and `ViewEncapsulation.None` components are also added to the shadow DOM host of each `ViewEncapsulation.ShadowDom` component.**\n+  This means that styles for components with `ViewEncapsulation.None` will affect matching elements within shadow DOMs.\n \n-The result is that styling for components with `ViewEncapsulation.None` will affect matching elements within the shadow DOM.\n+  This approach may seem counter-intuitive at first, but without it a component with `ViewEncapsulation.None` would be rendered differently within a component using `ViewEncapsulation.ShadowDom`, since its styles would not be available.\n \n-This approach may seem counter-intuitive at first, but without it a component with `ViewEncapsulation.None` could not be used within a component with `ViewEncapsulation.ShadowDom`, since its styles would not be available.\n+</div>\n \n ### Examples\n \n@@ -106,7 +99,7 @@ The first example shows a component that has `ViewEncapsulation.None`. This comp\n \n Angular adds the styles for this component as global styles to the `<head>` of the document.\n \n-**Angular also adds the styles to all shadow DOM hosts.** Therefore, the styles are available throughout the application.\n+As already mentioned Angular also adds the styles to all shadow DOM hosts. Therefore, the styles are available throughout the whole application.\n \n <img src=\"generated/images/guide/view-encapsulation/no-encapsulation.png\" alt=\"component with no encapsulation\">\n \n@@ -116,14 +109,12 @@ The second example shows a component that has `ViewEncapsulation.Emulated`. This\n \n <code-example path=\"view-encapsulation/src/app/emulated-encapsulation.component.ts\" header=\"src/app/emulated-encapsulation.component.ts\"></code-example>>\n \n-Similar to `ViewEncapsulation.None`, Angular adds the styles for this component to the `<head>` of the document, and to all the shadow DOM hosts.\n-But in this case, the styles are \"scoped\" by the attributes described in [\"Inspecting generated CSS\"](#inspecting-generated-css).\n+Similar to `ViewEncapsulation.None`, Angular adds the styles for this component to the `<head>` of the document, but with \"scoped\" styles.\n \n Therefore, only the elements directly within this component's template will match its styles.\n Since the \"scoped\" styles from the `EmulatedEncapsulationComponent` are very specific, they override the global styles from the `NoEncapsulationComponent`.\n \n-In this example, the `EmulatedEncapsulationComponent` contains a `NoEncapsulationComponent`.\n-The `NoEncapsulationComponent` is styled as expected because the scoped styles do not match elements in its template.\n+In this example, the `EmulatedEncapsulationComponent` contains a `NoEncapsulationComponent`, but `NoEncapsulationComponent` is still styled as expected since the `EmulatedEncapsulationComponent`'s \"scoped\" styles do not match elements in its template.\n \n <img src=\"generated/images/guide/view-encapsulation/emulated-encapsulation.png\" alt=\"component with no encapsulation\">\n \n@@ -144,8 +135,8 @@ The styles added by the `ShadowDomEncapsulationComponent` component are availabl\n The `EmulatedEncapsulationComponent` has specific \"scoped\" styles, so the styling of this component's template is unaffected.\n \n But since styles from `ShadowDomEncapsulationComponent` are added to the shadow host after the global styles, the `h2` style overrides the style from the `NoEncapsulationComponent`.\n-The result is that the `<h2>` element in the `NoEncapsulationComponent` is colored blue rather than red, which may not be what the component author intended.\n+The result is that the `<h2>` element in the `NoEncapsulationComponent` is colored blue rather than red, which may not be what the component's author intended.\n \n <img src=\"generated/images/guide/view-encapsulation/shadow-dom-encapsulation.png\" alt=\"component with no encapsulation\">\n \n-@reviewed 2021-09-17\n+@reviewed 2021-11-10"
        },
        {
            "sha": "03f5428d1629ad01a062415bbfb65ab01e7b615d",
            "filename": "packages/compiler/src/render3/partial/api.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/packages%2Fcompiler%2Fsrc%2Frender3%2Fpartial%2Fapi.ts",
            "raw_url": "https://github.com/angular/angular/raw/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/packages%2Fcompiler%2Fsrc%2Frender3%2Fpartial%2Fapi.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fpartial%2Fapi.ts?ref=6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19",
            "patch": "@@ -177,7 +177,7 @@ export interface R3DeclareComponentMetadata extends R3DeclareDirectiveMetadata {\n   changeDetection?: ChangeDetectionStrategy;\n \n   /**\n-   * An encapsulation policy for the template and CSS styles.\n+   * An encapsulation policy for the component's styling.\n    * Defaults to `ViewEncapsulation.Emulated`.\n    */\n   encapsulation?: ViewEncapsulation;"
        },
        {
            "sha": "c12ec91acf2086edecdc05e4142c4d49fd11981b",
            "filename": "packages/compiler/src/render3/view/api.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fapi.ts",
            "raw_url": "https://github.com/angular/angular/raw/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fapi.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fapi.ts?ref=6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19",
            "patch": "@@ -206,11 +206,12 @@ export interface R3ComponentMetadata extends R3DirectiveMetadata {\n   styles: string[];\n \n   /**\n-   * An encapsulation policy for the template and CSS styles. One of:\n-   * - `ViewEncapsulation.Emulated`: Use shimmed CSS that emulates the native behavior.\n-   * - `ViewEncapsulation.None`: Use global CSS without any encapsulation.\n-   * - `ViewEncapsulation.ShadowDom`: Use the latest ShadowDOM API to natively encapsulate styles\n-   * into a shadow root.\n+   * An encapsulation policy for the component's styling.\n+   * Possible values:\n+   * - `ViewEncapsulation.Emulated`: Apply modified component styles in order to emulate\n+   *                                 a native Shadow DOM CSS encapsulation behavior.\n+   * - `ViewEncapsulation.None`: Apply component styles globally without any sort of encapsulation.\n+   * - `ViewEncapsulation.ShadowDom`: Use the browser's native Shadow DOM API to encapsulate styles.\n    */\n   encapsulation: ViewEncapsulation;\n "
        },
        {
            "sha": "3ac581b69a219211177f15bc583ade34d5b8533d",
            "filename": "packages/core/src/metadata/directives.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 12,
            "changes": 25,
            "blob_url": "https://github.com/angular/angular/blob/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/packages%2Fcore%2Fsrc%2Fmetadata%2Fdirectives.ts",
            "raw_url": "https://github.com/angular/angular/raw/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/packages%2Fcore%2Fsrc%2Fmetadata%2Fdirectives.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Fmetadata%2Fdirectives.ts?ref=6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19",
            "patch": "@@ -516,18 +516,19 @@ export interface Component extends Directive {\n   animations?: any[];\n \n   /**\n-   * An encapsulation policy for the template and CSS styles. One of:\n-   * - `ViewEncapsulation.Emulated`: Use shimmed CSS that\n-   * emulates the native behavior.\n-   * - `ViewEncapsulation.None`: Use global CSS without any\n-   * encapsulation.\n-   * - `ViewEncapsulation.ShadowDom`: Use Shadow DOM v1 to encapsulate styles.\n-   *\n-   * If not supplied, the value is taken from `CompilerOptions`. The default compiler option is\n-   * `ViewEncapsulation.Emulated`.\n-   *\n-   * If the policy is set to `ViewEncapsulation.Emulated` and the component has no `styles`\n-   * or `styleUrls` specified, the policy is automatically switched to `ViewEncapsulation.None`.\n+   * An encapsulation policy for the component's styling.\n+   * Possible values:\n+   * - `ViewEncapsulation.Emulated`: Apply modified component styles in order to emulate\n+   *                                 a native Shadow DOM CSS encapsulation behavior.\n+   * - `ViewEncapsulation.None`: Apply component styles globally without any sort of encapsulation.\n+   * - `ViewEncapsulation.ShadowDom`: Use the browser's native Shadow DOM API to encapsulate styles.\n+   *\n+   * If not supplied, the value is taken from the `CompilerOptions`\n+   * which defaults to `ViewEncapsulation.Emulated`.\n+   *\n+   * If the policy is `ViewEncapsulation.Emulated` and the component has no\n+   * {@link Component#styles styles} nor {@link Component#styleUrls styleUrls},\n+   * the policy is automatically switched to `ViewEncapsulation.None`.\n    */\n   encapsulation?: ViewEncapsulation;\n "
        },
        {
            "sha": "04838345b191c02af42219c4e549ccd842be162f",
            "filename": "packages/core/src/metadata/view.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/angular/angular/blob/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/packages%2Fcore%2Fsrc%2Fmetadata%2Fview.ts",
            "raw_url": "https://github.com/angular/angular/raw/6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19/packages%2Fcore%2Fsrc%2Fmetadata%2Fview.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Fmetadata%2Fview.ts?ref=6ae38584b03fa5ebb4e70a360de7cb64ca3cbb19",
            "patch": "@@ -7,7 +7,8 @@\n  */\n \n /**\n- * Defines template and style encapsulation options available for Component's {@link Component}.\n+ * Defines the CSS styles encapsulation policies for the {@link Component} decorator's\n+ * `encapsulation` option.\n  *\n  * See {@link Component#encapsulation encapsulation}.\n  *\n@@ -23,10 +24,9 @@ export enum ViewEncapsulation {\n   // https://github.com/angular/angular/issues/44119 for additional information.\n \n   /**\n-   * Emulate `Native` scoping of styles by adding an attribute containing surrogate id to the Host\n-   * Element and pre-processing the style rules provided via {@link Component#styles styles} or\n-   * {@link Component#styleUrls styleUrls}, and adding the new Host Element attribute to all\n-   * selectors.\n+   * Emulates a native Shadow DOM encapsulation behavior by adding a specific attribute to the\n+   * component's host element and applying the same attribute to all the CSS selectors provided\n+   * via {@link Component#styles styles} or {@link Component#styleUrls styleUrls}.\n    *\n    * This is the default option.\n    */\n@@ -35,16 +35,16 @@ export enum ViewEncapsulation {\n   // Historically the 1 value was for `Native` encapsulation which has been removed as of v11.\n \n   /**\n-   * Don't provide any template or style encapsulation.\n+   * Doesn't provide any sort of CSS style encapsulation, meaning that all the styles provided\n+   * via {@link Component#styles styles} or {@link Component#styleUrls styleUrls} are applicable\n+   * to any HTML element of the application regardless of their host Component.\n    */\n   None = 2,\n \n   /**\n-   * Use Shadow DOM to encapsulate styles.\n-   *\n-   * For the DOM this means using modern [Shadow\n-   * DOM](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM) and\n-   * creating a ShadowRoot for Component's Host Element.\n+   * Uses the browser's native Shadow DOM API to encapsulate CSS styles, meaning that it creates\n+   * a ShadowRoot for the component's host element which is then used to encapsulate\n+   * all the Component's styling.\n    */\n   ShadowDom = 3\n }"
        }
    ],
    "stats": {
        "total": 161,
        "additions": 74,
        "deletions": 87
    }
}