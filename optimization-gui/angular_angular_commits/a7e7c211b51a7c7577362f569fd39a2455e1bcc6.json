{
    "author": "clydin",
    "message": "feat(compiler-cli): add support for using TypeScript 4.1 (#39571)\n\nThis change enables projects to be built with TypeScript 4.1.  Support for TypeScript 4.0 is also retained.\n\nPR Close #39571",
    "sha": "a7e7c211b51a7c7577362f569fd39a2455e1bcc6",
    "files": [
        {
            "sha": "b7abbfc5350c412ce3a893d37bbac6f4b270a6e3",
            "filename": "packages/compiler-cli/src/transformers/program.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/a7e7c211b51a7c7577362f569fd39a2455e1bcc6/packages%2Fcompiler-cli%2Fsrc%2Ftransformers%2Fprogram.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7e7c211b51a7c7577362f569fd39a2455e1bcc6/packages%2Fcompiler-cli%2Fsrc%2Ftransformers%2Fprogram.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Ftransformers%2Fprogram.ts?ref=a7e7c211b51a7c7577362f569fd39a2455e1bcc6",
            "patch": "@@ -654,7 +654,10 @@ class AngularCompilerProgram implements Program {\n     // - we cache all the files in the hostAdapter\n     // - new new stubs use the exactly same imports/exports as the old once (we assert that in\n     // hostAdapter.updateGeneratedFile).\n-    if (tsStructureIsReused(tmpProgram) !== StructureIsReused.Completely) {\n+    // TS 4.1+ stores the reuse state in the new program\n+    const checkReuseProgram =\n+        (ts.versionMajorMinor as string) === '4.0' ? tmpProgram : this._tsProgram;\n+    if (tsStructureIsReused(checkReuseProgram) !== StructureIsReused.Completely) {\n       throw new Error(`Internal Error: The structure of the program changed during codegen.`);\n     }\n   }"
        },
        {
            "sha": "efdd34c8deda4cc830c34b193f30ba09e3f0dd6b",
            "filename": "packages/compiler-cli/src/typescript_support.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/a7e7c211b51a7c7577362f569fd39a2455e1bcc6/packages%2Fcompiler-cli%2Fsrc%2Ftypescript_support.ts",
            "raw_url": "https://github.com/angular/angular/raw/a7e7c211b51a7c7577362f569fd39a2455e1bcc6/packages%2Fcompiler-cli%2Fsrc%2Ftypescript_support.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Ftypescript_support.ts?ref=a7e7c211b51a7c7577362f569fd39a2455e1bcc6",
            "patch": "@@ -25,7 +25,7 @@ const MIN_TS_VERSION = '4.0.0';\n  * Note: this check is disabled in g3, search for\n  * `angularCompilerOptions.disableTypeScriptVersionCheck` config param value in g3.\n  */\n-const MAX_TS_VERSION = '4.1.0';\n+const MAX_TS_VERSION = '4.2.0';\n \n /**\n  * The currently used version of TypeScript, which can be adjusted for testing purposes using"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
    }
}