{
    "author": "JiaLiPassion",
    "message": "build(zone.js): zone.js should output esm format for fesm2015 bundles (#39203)\n\nZone.js support `Angular package format` since `0.11`, but the `fesm2015` bundles\nare not `esm` format, it still use `umd` bundle which is not correct, in this PR,\na new `esm` bundle output is added in `rollup_bundle` rule under `tools`, so\nzone.js can use the new rule to generate `esm` bundles.\n\nPR Close #39203",
    "sha": "497af77d7af88ef6ab9fd106b2f151314b55be5e",
    "files": [
        {
            "sha": "11058c72bbe63ac2add4056fee2c6490d78613e5",
            "filename": "packages/zone.js/tools.bzl",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/497af77d7af88ef6ab9fd106b2f151314b55be5e/packages%2Fzone.js%2Ftools.bzl",
            "raw_url": "https://github.com/angular/angular/raw/497af77d7af88ef6ab9fd106b2f151314b55be5e/packages%2Fzone.js%2Ftools.bzl",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fzone.js%2Ftools.bzl?ref=497af77d7af88ef6ab9fd106b2f151314b55be5e",
            "patch": "@@ -31,7 +31,7 @@ def copy_dist(module_name, module_format, output_module_name, suffix, umd):\n     native.genrule(\n         name = module_name + \".\" + suffix_output + \"dist\",\n         srcs = [\n-            \"//packages/zone.js:\" + module_name + \"-rollup.\" + suffix_output + module_format + \"umd.js\",\n+            \"//packages/zone.js:\" + module_name + \"-rollup.\" + suffix_output + module_format,\n         ],\n         outs = [\n             output_module_name + \".\" + umd_output + suffix_output + \"js\",\n@@ -69,9 +69,9 @@ def generate_rollup_bundle(bundles):\n             )\n \n def generate_dist(bundles, output_format, umd):\n-    module_format = \"\"\n+    module_format = \"esm.js\"\n     if output_format == \"es5\":\n-        module_format = \"es5\"\n+        module_format = \"es5umd.js\"\n     for b in bundles:\n         module_name = b[0]\n         copy_dist("
        },
        {
            "sha": "b6c48bf31682763d5c7e8bed3dcb50f7fa897828",
            "filename": "tools/defaults.bzl",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/497af77d7af88ef6ab9fd106b2f151314b55be5e/tools%2Fdefaults.bzl",
            "raw_url": "https://github.com/angular/angular/raw/497af77d7af88ef6ab9fd106b2f151314b55be5e/tools%2Fdefaults.bzl",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/tools%2Fdefaults.bzl?ref=497af77d7af88ef6ab9fd106b2f151314b55be5e",
            "patch": "@@ -400,6 +400,8 @@ def rollup_bundle(name, testonly = False, sourcemap = \"true\", **kwargs):\n     es2015 iife                  : \"%{name}.es2015.js\"\n     es2015 iife minified         : \"%{name}.min.es2015.js\"\n     es2015 iife minified (debug) : \"%{name}.min_debug.es2015.js\"\n+    esm                          : \"%{name}.esm.js\"\n+    esm                          : \"%{name}.min.esm.js\"\n     es5 iife                     : \"%{name}.js\"\n     es5 iife minified            : \"%{name}.min.js\"\n     es5 iife minified (debug)    : \"%{name}.min_debug.js\"\n@@ -422,6 +424,11 @@ def rollup_bundle(name, testonly = False, sourcemap = \"true\", **kwargs):\n         \"sourcemap\": False,\n     }\n \n+    # esm\n+    _rollup_bundle(name = name + \".esm\", testonly = testonly, format = \"esm\", sourcemap = sourcemap, **kwargs)\n+    terser_minified(name = name + \".min.esm\", testonly = testonly, src = name + \".esm\", **common_terser_args)\n+    native.filegroup(name = name + \".min.esm.js\", testonly = testonly, srcs = [name + \".min.esm\"])\n+\n     # es2015\n     _rollup_bundle(name = name + \".es2015\", testonly = testonly, format = \"iife\", sourcemap = sourcemap, **kwargs)\n     terser_minified(name = name + \".min.es2015\", testonly = testonly, src = name + \".es2015\", **common_terser_args)"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 10,
        "deletions": 3
    }
}