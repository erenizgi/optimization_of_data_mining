{
    "author": "gkalpak",
    "message": "refactor(docs-infra): decouple showing the top-menu in top-bar from showing the sidenav (#37938)\n\nAs part of angular.io's responsive layout, the following rules are\napplied:\n- On wide screens, a menu is shown in the top-bar and the sidenav is\n  shown side-by-side with the docs content.\n- On narrow screens, the top-menu is moved from the top-bar to the\n  sidenav and the sidenav is closed by default and floats over the\n  content when manually opened.\n\nPreviously, the break-points at which the top-menu was shown in the\ntop-bar and the sidenav was shown side-by-side with the content were the\nsame (using a single variable).\n\nThis commit decouples the two break-points to make it possible to use\ndifferent values in the future.\n\nPR Close #37938",
    "sha": "fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b",
    "files": [
        {
            "sha": "96b5e6df29530d610e6600e4042fa0ec2ba9743b",
            "filename": "aio/src/app/app.component.html",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b/aio%2Fsrc%2Fapp%2Fapp.component.html",
            "raw_url": "https://github.com/angular/angular/raw/fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b/aio%2Fsrc%2Fapp%2Fapp.component.html",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fapp.component.html?ref=fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b",
            "patch": "@@ -18,11 +18,11 @@\n     <button mat-button class=\"hamburger\" [class.starting]=\"isStarting\" (click)=\"sidenav.toggle()\" title=\"Docs menu\">\n       <mat-icon svgIcon=\"menu\"></mat-icon>\n     </button>\n-    <a class=\"nav-link home\" href=\"/\" [ngSwitch]=\"isSideBySide\">\n+    <a class=\"nav-link home\" href=\"/\" [ngSwitch]=\"showTopMenu\">\n       <img *ngSwitchCase=\"true\" src=\"assets/images/logos/angular/logo-nav@2x.png\" width=\"150\" height=\"40\" title=\"Home\" alt=\"Home\">\n       <img *ngSwitchDefault src=\"assets/images/logos/angular/shield-large.svg\" width=\"37\" height=\"40\" title=\"Home\" alt=\"Home\">\n     </a>\n-    <aio-top-menu *ngIf=\"isSideBySide\" [nodes]=\"topMenuNodes\" [currentNode]=\"currentNodes?.TopBar\"></aio-top-menu>\n+    <aio-top-menu *ngIf=\"showTopMenu\" [nodes]=\"topMenuNodes\" [currentNode]=\"currentNodes?.TopBar\"></aio-top-menu>\n     <aio-search-box class=\"search-container\" #searchBox (onSearch)=\"doSearch($event)\" (onFocus)=\"doSearch($event)\"></aio-search-box>\n     <div class=\"toolbar-external-icons-container\">\n       <a href=\"https://twitter.com/angular\" title=\"Twitter\" aria-label=\"Angular on twitter\">\n@@ -39,9 +39,9 @@\n \n <mat-sidenav-container class=\"sidenav-container\" [class.starting]=\"isStarting\" [class.has-floating-toc]=\"hasFloatingToc\" role=\"main\">\n \n-  <mat-sidenav [ngClass]=\"{'collapsed': !isSideBySide}\" #sidenav class=\"sidenav\" [mode]=\"mode\" [opened]=\"isOpened\" (openedChange)=\"updateHostClasses()\">\n-    <aio-nav-menu *ngIf=\"!isSideBySide\" [nodes]=\"topMenuNarrowNodes\" [currentNode]=\"currentNodes?.TopBarNarrow\" [isWide]=\"false\"></aio-nav-menu>\n-    <aio-nav-menu [nodes]=\"sideNavNodes\" [currentNode]=\"currentNodes?.SideNav\" [isWide]=\"isSideBySide\"></aio-nav-menu>\n+  <mat-sidenav [ngClass]=\"{'collapsed': !dockSideNav}\" #sidenav class=\"sidenav\" [mode]=\"mode\" [opened]=\"isOpened\" (openedChange)=\"updateHostClasses()\">\n+    <aio-nav-menu *ngIf=\"!showTopMenu\" [nodes]=\"topMenuNarrowNodes\" [currentNode]=\"currentNodes?.TopBarNarrow\" [isWide]=\"false\"></aio-nav-menu>\n+    <aio-nav-menu [nodes]=\"sideNavNodes\" [currentNode]=\"currentNodes?.SideNav\" [isWide]=\"dockSideNav\"></aio-nav-menu>\n \n     <div class=\"doc-version\">\n       <aio-select (change)=\"onDocVersionChange($event.index)\" [options]=\"docVersions\" [selected]=\"currentDocVersion\"></aio-select>"
        },
        {
            "sha": "a872868931571b7561a221347d8a85e98d4dec60",
            "filename": "aio/src/app/app.component.spec.ts",
            "status": "modified",
            "additions": 42,
            "deletions": 34,
            "changes": 76,
            "blob_url": "https://github.com/angular/angular/blob/fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b/aio%2Fsrc%2Fapp%2Fapp.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b/aio%2Fsrc%2Fapp%2Fapp.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fapp.component.spec.ts?ref=fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b",
            "patch": "@@ -25,11 +25,9 @@ import { first, mapTo } from 'rxjs/operators';\n import { MockLocationService } from 'testing/location.service';\n import { MockLogger } from 'testing/logger.service';\n import { MockSearchService } from 'testing/search.service';\n-import { AppComponent } from './app.component';\n+import { AppComponent, dockSideNavWidth, showFloatingTocWidth, showTopMenuWidth } from './app.component';\n import { AppModule } from './app.module';\n \n-const sideBySideBreakPoint = 992;\n-const hideToCBreakPoint = 800;\n const startedDelay = 100;\n \n describe('AppComponent', () => {\n@@ -58,7 +56,7 @@ describe('AppComponent', () => {\n     component = fixture.componentInstance;\n \n     fixture.detectChanges();\n-    component.onResize(sideBySideBreakPoint + 1); // wide by default\n+    component.onResize(showTopMenuWidth + 1); // wide by default\n \n     const de = fixture.debugElement;\n     const docViewerDe = de.query(By.css('aio-doc-viewer'));\n@@ -99,7 +97,7 @@ describe('AppComponent', () => {\n       });\n \n       it('should be false on narrow screens', () => {\n-        component.onResize(hideToCBreakPoint - 1);\n+        component.onResize(showFloatingTocWidth - 1);\n \n         tocService.tocList.next([{}, {}, {}] as TocItem[]);\n         expect(component.hasFloatingToc).toBe(false);\n@@ -112,7 +110,7 @@ describe('AppComponent', () => {\n       });\n \n       it('should be true on wide screens unless the toc is empty', () => {\n-        component.onResize(hideToCBreakPoint + 1);\n+        component.onResize(showFloatingTocWidth + 1);\n \n         tocService.tocList.next([{}, {}, {}] as TocItem[]);\n         expect(component.hasFloatingToc).toBe(true);\n@@ -127,37 +125,47 @@ describe('AppComponent', () => {\n       it('should be false when toc is empty', () => {\n         tocService.tocList.next([]);\n \n-        component.onResize(hideToCBreakPoint + 1);\n+        component.onResize(showFloatingTocWidth + 1);\n         expect(component.hasFloatingToc).toBe(false);\n \n-        component.onResize(hideToCBreakPoint - 1);\n+        component.onResize(showFloatingTocWidth - 1);\n         expect(component.hasFloatingToc).toBe(false);\n \n-        component.onResize(hideToCBreakPoint + 1);\n+        component.onResize(showFloatingTocWidth + 1);\n         expect(component.hasFloatingToc).toBe(false);\n       });\n \n       it('should be true when toc is not empty unless the screen is narrow', () => {\n         tocService.tocList.next([{}, {}, {}] as TocItem[]);\n \n-        component.onResize(hideToCBreakPoint + 1);\n+        component.onResize(showFloatingTocWidth + 1);\n         expect(component.hasFloatingToc).toBe(true);\n \n-        component.onResize(hideToCBreakPoint - 1);\n+        component.onResize(showFloatingTocWidth - 1);\n         expect(component.hasFloatingToc).toBe(false);\n \n-        component.onResize(hideToCBreakPoint + 1);\n+        component.onResize(showFloatingTocWidth + 1);\n         expect(component.hasFloatingToc).toBe(true);\n       });\n     });\n \n-    describe('isSideBySide', () => {\n+    describe('showTopMenu', () => {\n       it('should be updated on resize', () => {\n-        component.onResize(sideBySideBreakPoint - 1);\n-        expect(component.isSideBySide).toBe(false);\n+        component.onResize(showTopMenuWidth - 1);\n+        expect(component.showTopMenu).toBe(false);\n \n-        component.onResize(sideBySideBreakPoint + 1);\n-        expect(component.isSideBySide).toBe(true);\n+        component.onResize(showTopMenuWidth + 1);\n+        expect(component.showTopMenu).toBe(true);\n+      });\n+    });\n+\n+    describe('dockSideNav', () => {\n+      it('should be updated on resize', () => {\n+        component.onResize(dockSideNavWidth - 1);\n+        expect(component.dockSideNav).toBe(false);\n+\n+        component.onResize(dockSideNavWidth + 1);\n+        expect(component.dockSideNav).toBe(true);\n       });\n     });\n \n@@ -185,8 +193,8 @@ describe('AppComponent', () => {\n         fixture.detectChanges();\n       };\n \n-      describe('when side-by-side (wide)', () => {\n-        beforeEach(() => resizeTo(sideBySideBreakPoint + 1));  // side-by-side\n+      describe('when view is wide', () => {\n+        beforeEach(() => resizeTo(dockSideNavWidth + 1));  // wide view\n \n         it('should open when navigating to a guide page (guide/pipes)', () => {\n           navigateTo('guide/pipes');\n@@ -232,8 +240,8 @@ describe('AppComponent', () => {\n         });\n       });\n \n-      describe('when NOT side-by-side (narrow)', () => {\n-        beforeEach(() => resizeTo(sideBySideBreakPoint - 1)); // NOT side-by-side\n+      describe('when view is narrow', () => {\n+        beforeEach(() => resizeTo(dockSideNavWidth - 1)); // narrow view\n \n         it('should be closed when navigating to a guide page (guide/pipes)', () => {\n           navigateTo('guide/pipes');\n@@ -286,64 +294,64 @@ describe('AppComponent', () => {\n         });\n       });\n \n-      describe('when changing side-by-side (narrow --> wide)', () => {\n+      describe('when changing from narrow to wide view', () => {\n         const sidenavDocs = ['api/a/b/c/d', 'guide/pipes'];\n         const nonSidenavDocs = ['features', 'about'];\n \n         sidenavDocs.forEach(doc => {\n           it(`should open when on a sidenav doc (${doc})`, () => {\n-            resizeTo(sideBySideBreakPoint - 1);\n+            resizeTo(dockSideNavWidth - 1);\n \n             navigateTo(doc);\n             expect(sidenav.opened).toBe(false);\n \n-            resizeTo(sideBySideBreakPoint + 1);\n+            resizeTo(dockSideNavWidth + 1);\n             expect(sidenav.opened).toBe(true);\n           });\n         });\n \n         nonSidenavDocs.forEach(doc => {\n           it(`should remain closed when on a non-sidenav doc (${doc})`, () => {\n-            resizeTo(sideBySideBreakPoint - 1);\n+            resizeTo(dockSideNavWidth - 1);\n \n             navigateTo(doc);\n             expect(sidenav.opened).toBe(false);\n \n-            resizeTo(sideBySideBreakPoint + 1);\n+            resizeTo(dockSideNavWidth + 1);\n             expect(sidenav.opened).toBe(false);\n           });\n         });\n \n         describe('when manually opened', () => {\n           sidenavDocs.forEach(doc => {\n             it(`should remain opened when on a sidenav doc (${doc})`, () => {\n-              resizeTo(sideBySideBreakPoint - 1);\n+              resizeTo(dockSideNavWidth - 1);\n \n               navigateTo(doc);\n               toggleSidenav();\n               expect(sidenav.opened).toBe(true);\n \n-              resizeTo(sideBySideBreakPoint + 1);\n+              resizeTo(dockSideNavWidth + 1);\n               expect(sidenav.opened).toBe(true);\n             });\n           });\n \n           nonSidenavDocs.forEach(doc => {\n             it(`should close when on a non-sidenav doc (${doc})`, () => {\n-              resizeTo(sideBySideBreakPoint - 1);\n+              resizeTo(dockSideNavWidth - 1);\n \n               navigateTo(doc);\n               toggleSidenav();\n               expect(sidenav.opened).toBe(true);\n \n-              resizeTo(sideBySideBreakPoint + 1);\n+              resizeTo(showTopMenuWidth + 1);\n               expect(sidenav.opened).toBe(false);\n             });\n           });\n         });\n       });\n \n-      describe('when changing side-by-side (wide --> narrow)', () => {\n+      describe('when changing from wide to narrow view', () => {\n         const sidenavDocs = ['api/a/b/c/d', 'guide/pipes'];\n         const nonSidenavDocs = ['features', 'about'];\n \n@@ -352,7 +360,7 @@ describe('AppComponent', () => {\n             navigateTo(doc);\n             expect(sidenav.opened).toBe(true);\n \n-            resizeTo(sideBySideBreakPoint - 1);\n+            resizeTo(dockSideNavWidth - 1);\n             expect(sidenav.opened).toBe(false);\n           });\n         });\n@@ -362,7 +370,7 @@ describe('AppComponent', () => {\n             navigateTo(doc);\n             expect(sidenav.opened).toBe(false);\n \n-            resizeTo(sideBySideBreakPoint - 1);\n+            resizeTo(dockSideNavWidth - 1);\n             expect(sidenav.opened).toBe(false);\n           });\n         });\n@@ -376,7 +384,7 @@ describe('AppComponent', () => {\n       async function setupSelectorForTesting(mode?: string) {\n         createTestingModule('a/b', mode);\n         await initializeTest();\n-        component.onResize(sideBySideBreakPoint + 1); // side-by-side\n+        component.onResize(dockSideNavWidth + 1); // wide view\n         selectElement = fixture.debugElement.query(By.directive(SelectComponent));\n         selectComponent = selectElement.componentInstance;\n       }"
        },
        {
            "sha": "822f4b2e5e992b3298ae188afdfabf65e6f7b255",
            "filename": "aio/src/app/app.component.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 10,
            "changes": 23,
            "blob_url": "https://github.com/angular/angular/blob/fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b/aio%2Fsrc%2Fapp%2Fapp.component.ts",
            "raw_url": "https://github.com/angular/angular/raw/fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b/aio%2Fsrc%2Fapp%2Fapp.component.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fapp.component.ts?ref=fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b",
            "patch": "@@ -14,6 +14,9 @@ import { BehaviorSubject, combineLatest, Observable } from 'rxjs';\n import { first, map } from 'rxjs/operators';\n \n const sideNavView = 'SideNav';\n+export const showTopMenuWidth = 992;\n+export const dockSideNavWidth = 992;\n+export const showFloatingTocWidth = 800;\n \n @Component({\n   selector: 'aio-shell',\n@@ -57,27 +60,26 @@ export class AppComponent implements OnInit {\n   isStarting = true;\n   isTransitioning = true;\n   isFetching = false;\n-  isSideBySide = false;\n+  showTopMenu = false;\n+  dockSideNav = false;\n   private isFetchingTimeout: any;\n   private isSideNavDoc = false;\n \n-  private sideBySideWidth = 992;\n   sideNavNodes: NavigationNode[];\n   topMenuNodes: NavigationNode[];\n   topMenuNarrowNodes: NavigationNode[];\n \n   hasFloatingToc = false;\n   private showFloatingToc = new BehaviorSubject(false);\n-  private showFloatingTocWidth = 800;\n   tocMaxHeight: string;\n   private tocMaxHeightOffset = 0;\n \n   versionInfo: VersionInfo;\n \n   private currentUrl: string;\n \n-  get isOpened() { return this.isSideBySide && this.isSideNavDoc; }\n-  get mode() { return this.isSideBySide ? 'side' : 'over'; }\n+  get isOpened() { return this.dockSideNav && this.isSideNavDoc; }\n+  get mode() { return this.dockSideNav && (this.isSideNavDoc || this.showTopMenu) ? 'side' : 'over'; }\n \n   // Search related properties\n   showSearchResults = false;\n@@ -239,13 +241,14 @@ export class AppComponent implements OnInit {\n \n   @HostListener('window:resize', ['$event.target.innerWidth'])\n   onResize(width: number) {\n-    this.isSideBySide = width >= this.sideBySideWidth;\n-    this.showFloatingToc.next(width > this.showFloatingTocWidth);\n+    this.showTopMenu = width >= showTopMenuWidth;\n+    this.dockSideNav = width >= dockSideNavWidth;\n+    this.showFloatingToc.next(width > showFloatingTocWidth);\n \n-    if (this.isSideBySide && !this.isSideNavDoc) {\n+    if (this.showTopMenu && !this.isSideNavDoc) {\n       // If this is a non-sidenav doc and the screen is wide enough so that we can display menu\n       // items in the top-bar, ensure the sidenav is closed.\n-      // (This condition can only be met when the resize event changes the value of `isSideBySide`\n+      // (This condition can only be met when the resize event changes the value of `showTopMenu`\n       //  from `false` to `true` while on a non-sidenav doc.)\n       this.sidenav.toggle(false);\n     }\n@@ -338,7 +341,7 @@ export class AppComponent implements OnInit {\n     }\n \n     // May be open or closed when wide; always closed when narrow.\n-    this.sidenav.toggle(this.isSideBySide && openSideNav);\n+    this.sidenav.toggle(this.dockSideNav && openSideNav);\n   }\n \n   // Dynamically change height of table of contents container"
        },
        {
            "sha": "da915c8b62c1583c66a694503719b453ac0a9aff",
            "filename": "aio/src/styles/1-layouts/_top-menu.scss",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b/aio%2Fsrc%2Fstyles%2F1-layouts%2F_top-menu.scss",
            "raw_url": "https://github.com/angular/angular/raw/fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b/aio%2Fsrc%2Fstyles%2F1-layouts%2F_top-menu.scss",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fstyles%2F1-layouts%2F_top-menu.scss?ref=fc7e77934fd9b5d9aacea0c5a132d7dbd13bcd3b",
            "patch": "@@ -1,6 +1,6 @@\n // VARIABLES\n-$hamburgerShownMaxWidth: 991px;\n-$hamburgerHiddenMinWidth: $hamburgerShownMaxWidth + 1;\n+$showTopMenuWidth: 992px;\n+$hideTopMenuWidth: $showTopMenuWidth - 1;\n $hamburgerShownMargin: 0 8px 0 0;\n $hamburgerHiddenMargin: 0 16px 0 -64px;\n \n@@ -54,7 +54,7 @@ aio-shell.folder-docs mat-toolbar.mat-toolbar,\n aio-shell.folder-guide mat-toolbar.mat-toolbar,\n aio-shell.folder-start mat-toolbar.mat-toolbar,\n aio-shell.folder-tutorial mat-toolbar.mat-toolbar {\n-  @media (min-width: $hamburgerHiddenMinWidth) {\n+  @media (min-width: $showTopMenuWidth) {\n     .hamburger.mat-button {\n       // Hamburger shown on non-marketing pages even on large screens.\n       margin: $hamburgerShownMargin;\n@@ -68,7 +68,7 @@ aio-shell.folder-tutorial mat-toolbar.mat-toolbar {\n   margin: $hamburgerShownMargin;\n   padding: 0;\n \n-  @media (min-width: $hamburgerHiddenMinWidth) {\n+  @media (min-width: $showTopMenuWidth) {\n     // Hamburger hidden by default on large screens.\n     // (Will be shown per doc.)\n     margin: $hamburgerHiddenMargin;\n@@ -106,7 +106,7 @@ aio-shell.folder-tutorial mat-toolbar.mat-toolbar {\n     outline-offset: 4px;\n   }\n \n-  @media screen and (max-width: $hamburgerShownMaxWidth) {\n+  @media screen and (max-width: $hideTopMenuWidth) {\n     padding: 4px 0;\n   }\n \n@@ -120,7 +120,7 @@ aio-shell.folder-tutorial mat-toolbar.mat-toolbar {\n     top: 12px;\n     height: 40px;\n \n-    @media (max-width: $hamburgerShownMaxWidth) {\n+    @media (max-width: $hideTopMenuWidth) {\n       &:hover {\n         transform: scale(1.1);\n       }"
        }
    ],
    "stats": {
        "total": 121,
        "additions": 66,
        "deletions": 55
    }
}