{
    "author": "devversion",
    "message": "refactor(platform-server): switch from dynamic require to import statement (#43431)\n\nIn order to support ESM for the `platform-server` package, we need to\nremove two usages of dynamic imports and replace them with their\ncorresponding/equivalent import statement. This will also allow ESBuild\nto recognize this import. Note that we want to keep these imports external, so\nwe explicitly specify the `externals` option for the `ng_package` rule.\n\nPR Close #43431",
    "sha": "364c0eaaaecf3abaea4658062dca1751c66c98b9",
    "files": [
        {
            "sha": "3331fe9a03f9fd05e9321119f365efdb584781c5",
            "filename": "packages/core/test/render3/BUILD.bazel",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fcore%2Ftest%2Frender3%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fcore%2Ftest%2Frender3%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2FBUILD.bazel?ref=364c0eaaaecf3abaea4658062dca1751c66c98b9",
            "patch": "@@ -53,7 +53,6 @@ ts_library(\n     name = \"domino\",\n     testonly = True,\n     srcs = [\n-        \"domino.d.ts\",\n         \"load_domino.ts\",\n     ],\n     deps = ["
        },
        {
            "sha": "92a8d4e24572a1f3c2954576791011cd7001d254",
            "filename": "packages/core/test/render3/domino.d.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 12,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/a274de088afc88b0ddedc314c4b3947f22bb7f3b/packages%2Fcore%2Ftest%2Frender3%2Fdomino.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/a274de088afc88b0ddedc314c4b3947f22bb7f3b/packages%2Fcore%2Ftest%2Frender3%2Fdomino.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fdomino.d.ts?ref=a274de088afc88b0ddedc314c4b3947f22bb7f3b",
            "patch": "@@ -1,12 +0,0 @@\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-declare module 'domino' {\n-  function createWindow(html: string, url: string): Window;\n-  const impl: {Element: any};\n-}"
        },
        {
            "sha": "629f4558a3b3f7ed1cf9a9e47223f8114d260e2f",
            "filename": "packages/platform-server/BUILD.bazel",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fplatform-server%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fplatform-server%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fplatform-server%2FBUILD.bazel?ref=364c0eaaaecf3abaea4658062dca1751c66c98b9",
            "patch": "@@ -40,6 +40,10 @@ ng_package(\n         \"//packages/platform-server/init:package.json\",\n         \"//packages/platform-server/testing:package.json\",\n     ],\n+    externals = [\n+        \"domino\",\n+        \"xhr2\",\n+    ],\n     tags = [\n         \"release-with-framework\",\n     ],"
        },
        {
            "sha": "811df4cd04ee8f37a940405c88bfd97581e8ca41",
            "filename": "packages/platform-server/src/domino_adapter.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fplatform-server%2Fsrc%2Fdomino_adapter.ts",
            "raw_url": "https://github.com/angular/angular/raw/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fplatform-server%2Fsrc%2Fdomino_adapter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fplatform-server%2Fsrc%2Fdomino_adapter.ts?ref=364c0eaaaecf3abaea4658062dca1751c66c98b9",
            "patch": "@@ -5,10 +5,10 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-const domino = require('domino');\n \n-import {ɵBrowserDomAdapter as BrowserDomAdapter} from '@angular/platform-browser';\n import {ɵsetRootDomAdapter as setRootDomAdapter} from '@angular/common';\n+import {ɵBrowserDomAdapter as BrowserDomAdapter} from '@angular/platform-browser';\n+import * as domino from 'domino';\n \n export function setDomTypes() {\n   // Make all Domino types available in the global env."
        },
        {
            "sha": "185eaef1f2dda751a65c6671931689006fefe528",
            "filename": "packages/platform-server/src/http.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fplatform-server%2Fsrc%2Fhttp.ts",
            "raw_url": "https://github.com/angular/angular/raw/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fplatform-server%2Fsrc%2Fhttp.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fplatform-server%2Fsrc%2Fhttp.ts?ref=364c0eaaaecf3abaea4658062dca1751c66c98b9",
            "patch": "@@ -5,15 +5,14 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-import {INITIAL_CONFIG, PlatformConfig} from './tokens';\n-\n \n-const xhr2: any = require('xhr2');\n-\n-import {Injectable, Injector, Provider} from '@angular/core';\n import {PlatformLocation, XhrFactory} from '@angular/common';\n-import {HttpEvent, HttpRequest, HttpHandler, HttpBackend, ɵHttpInterceptingHandler as HttpInterceptingHandler} from '@angular/common/http';\n+import {HttpBackend, HttpEvent, HttpHandler, HttpRequest, ɵHttpInterceptingHandler as HttpInterceptingHandler} from '@angular/common/http';\n+import {Injectable, Injector, Provider} from '@angular/core';\n import {Observable, Observer, Subscription} from 'rxjs';\n+import * as xhr2 from 'xhr2';\n+\n+import {INITIAL_CONFIG, PlatformConfig} from './tokens';\n \n // @see https://www.w3.org/Protocols/HTTP/1.1/draft-ietf-http-v11-spec-01#URI-syntax\n const isAbsoluteUrl = /^[a-zA-Z\\-\\+.]+:\\/\\//;"
        },
        {
            "sha": "3dd15eaf41a657b2acf95be2d82643d6d74bf617",
            "filename": "packages/platform-server/src/types.d.ts",
            "status": "added",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/angular/angular/blob/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fplatform-server%2Fsrc%2Ftypes.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/364c0eaaaecf3abaea4658062dca1751c66c98b9/packages%2Fplatform-server%2Fsrc%2Ftypes.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fplatform-server%2Fsrc%2Ftypes.d.ts?ref=364c0eaaaecf3abaea4658062dca1751c66c98b9",
            "patch": "@@ -0,0 +1,22 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+// Type definitions for `domino` and `xhr2`. These modules were previously referenced\n+// through `require`. We switched these to actual ESM imports in order to emit full-ESM\n+// as package output. To not introduce a dependency on the `domino` or `xhr2` types, we\n+// define local module typings and set them to `any`.\n+\n+declare module 'domino' {\n+  export const createWindow: any;\n+  export const createDocument: any;\n+  export const impl: any;\n+}\n+\n+declare module 'xhr2' {\n+  export const XMLHttpRequest: any;\n+}"
        }
    ],
    "stats": {
        "total": 54,
        "additions": 33,
        "deletions": 21
    }
}