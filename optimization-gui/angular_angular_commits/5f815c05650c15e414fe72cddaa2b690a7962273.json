{
    "author": "ranma42",
    "message": "fix(common): correct and simplify typing of AsyncPipe (#37447)\n\n`AsyncPipe.transform` will never return `undefined`, even when passed\n`undefined` in input, in contrast with what was declared in the\noverloads.\n\nAdditionally the \"actual\" method signature can be updated to match the\nmost generic case, since the implementation does not rely on wrappers\nanymore.\n\nBREAKING CHANGE:\nThe async pipe no longer claims to return `undefined` for an input that\nwas typed as `undefined`. Note that the code actually returned `null` on\n`undefined` inputs. In the unlikely case you were relying on this,\nplease fix the typing of the consumers of the pipe output.\n\nPR Close #37447",
    "sha": "5f815c05650c15e414fe72cddaa2b690a7962273",
    "files": [
        {
            "sha": "f0daa116c8bb1fcda21b18adb6fd636c5ad6cbe9",
            "filename": "goldens/public-api/common/common.d.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/5f815c05650c15e414fe72cddaa2b690a7962273/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/5f815c05650c15e414fe72cddaa2b690a7962273/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts?ref=5f815c05650c15e414fe72cddaa2b690a7962273",
            "patch": "@@ -3,10 +3,9 @@ export declare const APP_BASE_HREF: InjectionToken<string>;\n export declare class AsyncPipe implements OnDestroy, PipeTransform {\n     constructor(_ref: ChangeDetectorRef);\n     ngOnDestroy(): void;\n-    transform<T>(obj: null): null;\n-    transform<T>(obj: undefined): undefined;\n-    transform<T>(obj: Observable<T> | null | undefined): T | null;\n-    transform<T>(obj: Promise<T> | null | undefined): T | null;\n+    transform<T>(obj: Observable<T> | Promise<T>): T | null;\n+    transform<T>(obj: null | undefined): null;\n+    transform<T>(obj: Observable<T> | Promise<T> | null | undefined): T | null;\n }\n \n export declare class CommonModule {"
        },
        {
            "sha": "3921e1c018067a8e98fc4174303b582a06ce80a5",
            "filename": "packages/common/src/pipes/async_pipe.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/5f815c05650c15e414fe72cddaa2b690a7962273/packages%2Fcommon%2Fsrc%2Fpipes%2Fasync_pipe.ts",
            "raw_url": "https://github.com/angular/angular/raw/5f815c05650c15e414fe72cddaa2b690a7962273/packages%2Fcommon%2Fsrc%2Fpipes%2Fasync_pipe.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fsrc%2Fpipes%2Fasync_pipe.ts?ref=5f815c05650c15e414fe72cddaa2b690a7962273",
            "patch": "@@ -94,11 +94,10 @@ export class AsyncPipe implements OnDestroy, PipeTransform {\n     }\n   }\n \n-  transform<T>(obj: null): null;\n-  transform<T>(obj: undefined): undefined;\n-  transform<T>(obj: Observable<T>|null|undefined): T|null;\n-  transform<T>(obj: Promise<T>|null|undefined): T|null;\n-  transform(obj: Observable<any>|Promise<any>|null|undefined): any {\n+  transform<T>(obj: Observable<T>|Promise<T>): T|null;\n+  transform<T>(obj: null|undefined): null;\n+  transform<T>(obj: Observable<T>|Promise<T>|null|undefined): T|null;\n+  transform<T>(obj: Observable<T>|Promise<T>|null|undefined): T|null {\n     if (!this._obj) {\n       if (obj) {\n         this._subscribe(obj);\n@@ -108,7 +107,7 @@ export class AsyncPipe implements OnDestroy, PipeTransform {\n \n     if (obj !== this._obj) {\n       this._dispose();\n-      return this.transform(obj as any);\n+      return this.transform(obj);\n     }\n \n     return this._latestValue;"
        },
        {
            "sha": "00a2de5064eb69a78322cb3aac2d123bd0ab03e3",
            "filename": "packages/common/test/pipes/async_pipe_spec.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/5f815c05650c15e414fe72cddaa2b690a7962273/packages%2Fcommon%2Ftest%2Fpipes%2Fasync_pipe_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/5f815c05650c15e414fe72cddaa2b690a7962273/packages%2Fcommon%2Ftest%2Fpipes%2Fasync_pipe_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Ftest%2Fpipes%2Fasync_pipe_spec.ts?ref=5f815c05650c15e414fe72cddaa2b690a7962273",
            "patch": "@@ -129,7 +129,7 @@ import {SpyChangeDetectorRef} from '../spies';\n           reject = rej;\n         });\n         ref = new SpyChangeDetectorRef();\n-        pipe = new AsyncPipe(<any>ref);\n+        pipe = new AsyncPipe(ref as any);\n       });\n \n       describe('transform', () => {\n@@ -218,10 +218,17 @@ import {SpyChangeDetectorRef} from '../spies';\n       });\n     });\n \n+    describe('undefined', () => {\n+      it('should return null when given undefined', () => {\n+        const pipe = new AsyncPipe(null as any);\n+        expect(pipe.transform(undefined)).toEqual(null);\n+      });\n+    });\n+\n     describe('other types', () => {\n       it('should throw when given an invalid object', () => {\n         const pipe = new AsyncPipe(null as any);\n-        expect(() => pipe.transform(<any>'some bogus object')).toThrowError();\n+        expect(() => pipe.transform('some bogus object' as any)).toThrowError();\n       });\n     });\n   });"
        },
        {
            "sha": "954736b8ce101f023726134ec180e36b03234175",
            "filename": "packages/language-service/test/definitions_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/5f815c05650c15e414fe72cddaa2b690a7962273/packages%2Flanguage-service%2Ftest%2Fdefinitions_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/5f815c05650c15e414fe72cddaa2b690a7962273/packages%2Flanguage-service%2Ftest%2Fdefinitions_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Ftest%2Fdefinitions_spec.ts?ref=5f815c05650c15e414fe72cddaa2b690a7962273",
            "patch": "@@ -251,7 +251,7 @@ describe('definitions', () => {\n     expect(textSpan).toEqual(marker);\n \n     expect(definitions).toBeDefined();\n-    expect(definitions!.length).toBe(4);\n+    expect(definitions!.length).toBe(3);\n \n     const refFileName = '/node_modules/@angular/common/common.d.ts';\n     for (const def of definitions!) {"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 18,
        "deletions": 13
    }
}