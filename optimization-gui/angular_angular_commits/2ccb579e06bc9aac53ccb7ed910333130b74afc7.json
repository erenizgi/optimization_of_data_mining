{
    "author": "AndrewKushnir",
    "message": "feat(docs-infra): add profile picture size check (#41253)\n\nThis commit updates the logic that validates contributors.json data and introduces a new check that verifies that profile images don't exceed specified limit.\n\nPR Close #41253",
    "sha": "2ccb579e06bc9aac53ccb7ed910333130b74afc7",
    "files": [
        {
            "sha": "b677104fe11518e5b9628469c793d72857b02c57",
            "filename": "aio/scripts/contributors/validate-data.js",
            "status": "modified",
            "additions": 25,
            "deletions": 2,
            "changes": 27,
            "blob_url": "https://github.com/angular/angular/blob/2ccb579e06bc9aac53ccb7ed910333130b74afc7/aio%2Fscripts%2Fcontributors%2Fvalidate-data.js",
            "raw_url": "https://github.com/angular/angular/raw/2ccb579e06bc9aac53ccb7ed910333130b74afc7/aio%2Fscripts%2Fcontributors%2Fvalidate-data.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fscripts%2Fcontributors%2Fvalidate-data.js?ref=2ccb579e06bc9aac53ccb7ed910333130b74afc7",
            "patch": "@@ -1,15 +1,28 @@\n #!/usr/bin/env node\n \n // Imports\n-const {existsSync, readFileSync} = require('fs');\n-const {join, resolve} = require('path');\n+const {existsSync, readFileSync, statSync} = require('fs');\n+const {basename, join, resolve} = require('path');\n \n // Constants\n+const MAX_IMAGE_SIZE = 30 * 1024;  // 30kb\n const CONTENT_DIR = resolve(__dirname, '../../content');\n const IMAGES_DIR = join(CONTENT_DIR, 'images/bios');\n const CONTRIBUTORS_PATH = join(CONTENT_DIR, 'marketing/contributors.json');\n const EXISTING_GROUPS = new Set(['Angular', 'GDE', 'Collaborators']);\n \n+// The list of profile images that exceed specified `MAX_IMAGE_SIZE` limit.\n+// These images were added before the size check was introduced. Exclude these images\n+// from size check for now, but still check other images (more importantly run the check\n+// for new PRs where profile images are added).\n+const EXCLUDE_FROM_SIZE_CHECK = new Set([\n+  'alainchautard.png', 'ahsanayaz.jpg', 'alan-agius4.jpg', 'andrew-kushnir.jpg',\n+  'brian-love.jpg', 'cexbrayat.jpg', 'christianliebel.jpg', 'patovargas.png', 'gerardsans.jpg',\n+  'jessicajaniuk.jpg', 'JiaLiPassion.jpg', 'juristr.jpg', 'katerina.jpg', 'kimmaida.jpg',\n+  'kyliau.jpg', 'lacolaco.jpg', 'leonardo.jpg', 'nirkaufman.jpg', 'sajee.jpg', 'sonukapoor.jpg',\n+  'tracylee.jpg', 'twerske.jpg', 'wesgrimes.jpg'\n+]);\n+\n // Run\n _main();\n \n@@ -29,6 +42,16 @@ function _main() {\n         missingImages.map(path => `\\n  - ${path}`).join(''));\n   }\n \n+  // Check that there are no images that exceed the size limit.\n+  const tooLargeImages = expectedImages\n+       .filter(path => !EXCLUDE_FROM_SIZE_CHECK.has(basename(path)))\n+       .filter(path => statSync(path).size > MAX_IMAGE_SIZE);\n+  if (tooLargeImages.length > 0) {\n+    throw new Error(\n+        `The following pictures exceed maximum size limit of ${MAX_IMAGE_SIZE / 1024}kb:` +\n+        tooLargeImages.map(path => `\\n  - ${path}`).join(''));\n+  }\n+\n   // Verify that all keys are sorted alphabetically\n   const keys = Object.keys(contributors);\n   for (let i = 1; i < keys.length; i++) {"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 25,
        "deletions": 2
    }
}