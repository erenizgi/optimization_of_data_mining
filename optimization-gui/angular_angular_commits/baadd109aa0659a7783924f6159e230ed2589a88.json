{
    "author": "QuentinFchx",
    "message": "test(http): use HttpStatusCode enum in tests (#23548)\n\nNow that we have introduced human-readable http status codes,\nwe can use it in our tests to improve clarity.\n\nPR Close #23548",
    "sha": "baadd109aa0659a7783924f6159e230ed2589a88",
    "files": [
        {
            "sha": "d41693b368feeb66f79fc959160b517524b0343a",
            "filename": "packages/common/http/test/client_spec.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 7,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/baadd109aa0659a7783924f6159e230ed2589a88/packages%2Fcommon%2Fhttp%2Ftest%2Fclient_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/baadd109aa0659a7783924f6159e230ed2589a88/packages%2Fcommon%2Fhttp%2Ftest%2Fclient_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fhttp%2Ftest%2Fclient_spec.ts?ref=baadd109aa0659a7783924f6159e230ed2589a88",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n import {HttpClient} from '@angular/common/http/src/client';\n-import {HttpErrorResponse, HttpEventType, HttpResponse} from '@angular/common/http/src/response';\n+import {HttpErrorResponse, HttpEventType, HttpResponse, HttpStatusCode} from '@angular/common/http/src/response';\n import {HttpClientTestingBackend} from '@angular/common/http/testing/src/backend';\n import {ddescribe, describe, fit, it} from '@angular/core/testing/src/testing_internal';\n import {toArray} from 'rxjs/operators';\n@@ -105,7 +105,7 @@ import {toArray} from 'rxjs/operators';\n         client.post('/test', 'text body', {observe: 'response', responseType: 'text'})\n             .subscribe(res => {\n               expect(res.ok).toBeTruthy();\n-              expect(res.status).toBe(200);\n+              expect(res.status).toBe(HttpStatusCode.Ok);\n               done();\n             });\n         backend.expectOne('/test').flush('hello world');\n@@ -114,7 +114,7 @@ import {toArray} from 'rxjs/operators';\n         const body = {data: 'json body'};\n         client.post('/test', body, {observe: 'response', responseType: 'text'}).subscribe(res => {\n           expect(res.ok).toBeTruthy();\n-          expect(res.status).toBe(200);\n+          expect(res.status).toBe(HttpStatusCode.Ok);\n           done();\n         });\n         const testReq = backend.expectOne('/test');\n@@ -124,7 +124,7 @@ import {toArray} from 'rxjs/operators';\n       it('with a json body of false', done => {\n         client.post('/test', false, {observe: 'response', responseType: 'text'}).subscribe(res => {\n           expect(res.ok).toBeTruthy();\n-          expect(res.status).toBe(200);\n+          expect(res.status).toBe(HttpStatusCode.Ok);\n           done();\n         });\n         const testReq = backend.expectOne('/test');\n@@ -134,7 +134,7 @@ import {toArray} from 'rxjs/operators';\n       it('with a json body of 0', done => {\n         client.post('/test', 0, {observe: 'response', responseType: 'text'}).subscribe(res => {\n           expect(res.ok).toBeTruthy();\n-          expect(res.status).toBe(200);\n+          expect(res.status).toBe(HttpStatusCode.Ok);\n           done();\n         });\n         const testReq = backend.expectOne('/test');\n@@ -145,7 +145,7 @@ import {toArray} from 'rxjs/operators';\n         const body = new ArrayBuffer(4);\n         client.post('/test', body, {observe: 'response', responseType: 'text'}).subscribe(res => {\n           expect(res.ok).toBeTruthy();\n-          expect(res.status).toBe(200);\n+          expect(res.status).toBe(HttpStatusCode.Ok);\n           done();\n         });\n         const testReq = backend.expectOne('/test');\n@@ -167,7 +167,8 @@ import {toArray} from 'rxjs/operators';\n           done();\n         });\n         backend.expectOne('/test').flush(\n-            {'data': 'hello world'}, {status: 500, statusText: 'Server error'});\n+            {'data': 'hello world'},\n+            {status: HttpStatusCode.InternalServerError, statusText: 'Server error'});\n       });\n     });\n   });"
        },
        {
            "sha": "c9d31174d5d66714b23dcfcf02062a1298a8d770",
            "filename": "packages/common/http/test/response_spec.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 12,
            "changes": 25,
            "blob_url": "https://github.com/angular/angular/blob/baadd109aa0659a7783924f6159e230ed2589a88/packages%2Fcommon%2Fhttp%2Ftest%2Fresponse_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/baadd109aa0659a7783924f6159e230ed2589a88/packages%2Fcommon%2Fhttp%2Ftest%2Fresponse_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fhttp%2Ftest%2Fresponse_spec.ts?ref=baadd109aa0659a7783924f6159e230ed2589a88",
            "patch": "@@ -7,8 +7,8 @@\n  */\n \n import {HttpHeaders} from '@angular/common/http/src/headers';\n-import {HttpResponse} from '@angular/common/http/src/response';\n-import {ddescribe, describe, it} from '@angular/core/testing/src/testing_internal';\n+import {HttpResponse, HttpStatusCode} from '@angular/common/http/src/response';\n+import {describe, it} from '@angular/core/testing/src/testing_internal';\n \n {\n   describe('HttpResponse', () => {\n@@ -19,21 +19,21 @@ import {ddescribe, describe, it} from '@angular/core/testing/src/testing_interna\n           headers: new HttpHeaders({\n             'Test': 'Test header',\n           }),\n-          status: 201,\n+          status: HttpStatusCode.Created,\n           statusText: 'Created',\n           url: '/test',\n         });\n         expect(resp.body).toBe('test body');\n         expect(resp.headers instanceof HttpHeaders).toBeTruthy();\n         expect(resp.headers.get('Test')).toBe('Test header');\n-        expect(resp.status).toBe(201);\n+        expect(resp.status).toBe(HttpStatusCode.Created);\n         expect(resp.statusText).toBe('Created');\n         expect(resp.url).toBe('/test');\n       });\n       it('uses defaults if no args passed', () => {\n         const resp = new HttpResponse({});\n         expect(resp.headers).not.toBeNull();\n-        expect(resp.status).toBe(200);\n+        expect(resp.status).toBe(HttpStatusCode.Ok);\n         expect(resp.statusText).toBe('OK');\n         expect(resp.body).toBeNull();\n         expect(resp.ok).toBeTruthy();\n@@ -57,21 +57,22 @@ import {ddescribe, describe, it} from '@angular/core/testing/src/testing_interna\n     describe('.clone()', () => {\n       it('copies the original when given no arguments', () => {\n         const clone =\n-            new HttpResponse({body: 'test', status: 201, statusText: 'created', url: '/test'})\n+            new HttpResponse(\n+                {body: 'test', status: HttpStatusCode.Created, statusText: 'created', url: '/test'})\n                 .clone();\n         expect(clone.body).toBe('test');\n-        expect(clone.status).toBe(201);\n+        expect(clone.status).toBe(HttpStatusCode.Created);\n         expect(clone.statusText).toBe('created');\n         expect(clone.url).toBe('/test');\n         expect(clone.headers).not.toBeNull();\n       });\n       it('overrides the original', () => {\n-        const orig =\n-            new HttpResponse({body: 'test', status: 201, statusText: 'created', url: '/test'});\n-        const clone =\n-            orig.clone({body: {data: 'test'}, status: 200, statusText: 'Okay', url: '/bar'});\n+        const orig = new HttpResponse(\n+            {body: 'test', status: HttpStatusCode.Created, statusText: 'created', url: '/test'});\n+        const clone = orig.clone(\n+            {body: {data: 'test'}, status: HttpStatusCode.Ok, statusText: 'Okay', url: '/bar'});\n         expect(clone.body).toEqual({data: 'test'});\n-        expect(clone.status).toBe(200);\n+        expect(clone.status).toBe(HttpStatusCode.Ok);\n         expect(clone.statusText).toBe('Okay');\n         expect(clone.url).toBe('/bar');\n         expect(clone.headers).toBe(orig.headers);"
        },
        {
            "sha": "d645be91e35c4e82544d07cee21a34d7fb64e159",
            "filename": "packages/common/http/test/xhr_spec.ts",
            "status": "modified",
            "additions": 29,
            "deletions": 25,
            "changes": 54,
            "blob_url": "https://github.com/angular/angular/blob/baadd109aa0659a7783924f6159e230ed2589a88/packages%2Fcommon%2Fhttp%2Ftest%2Fxhr_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/baadd109aa0659a7783924f6159e230ed2589a88/packages%2Fcommon%2Fhttp%2Ftest%2Fxhr_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fhttp%2Ftest%2Fxhr_spec.ts?ref=baadd109aa0659a7783924f6159e230ed2589a88",
            "patch": "@@ -7,9 +7,9 @@\n  */\n \n import {HttpRequest} from '@angular/common/http/src/request';\n-import {HttpDownloadProgressEvent, HttpErrorResponse, HttpEvent, HttpEventType, HttpHeaderResponse, HttpResponse, HttpResponseBase, HttpUploadProgressEvent} from '@angular/common/http/src/response';\n+import {HttpDownloadProgressEvent, HttpErrorResponse, HttpEvent, HttpEventType, HttpHeaderResponse, HttpResponse, HttpResponseBase, HttpStatusCode, HttpUploadProgressEvent} from '@angular/common/http/src/response';\n import {HttpXhrBackend} from '@angular/common/http/src/xhr';\n-import {ddescribe, describe, fit, it} from '@angular/core/testing/src/testing_internal';\n+import {describe, it} from '@angular/core/testing/src/testing_internal';\n import {Observable} from 'rxjs';\n import {toArray} from 'rxjs/operators';\n \n@@ -78,54 +78,58 @@ const XSSI_PREFIX = ')]}\\'\\n';\n     });\n     it('handles a text response', () => {\n       const events = trackEvents(backend.handle(TEST_POST));\n-      factory.mock.mockFlush(200, 'OK', 'some response');\n+      factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'some response');\n       expect(events.length).toBe(2);\n       expect(events[1].type).toBe(HttpEventType.Response);\n       expect(events[1] instanceof HttpResponse).toBeTruthy();\n       const res = events[1] as HttpResponse<string>;\n       expect(res.body).toBe('some response');\n-      expect(res.status).toBe(200);\n+      expect(res.status).toBe(HttpStatusCode.Ok);\n       expect(res.statusText).toBe('OK');\n     });\n     it('handles a json response', () => {\n       const events = trackEvents(backend.handle(TEST_POST.clone({responseType: 'json'})));\n-      factory.mock.mockFlush(200, 'OK', JSON.stringify({data: 'some data'}));\n+      factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', JSON.stringify({data: 'some data'}));\n       expect(events.length).toBe(2);\n       const res = events[1] as HttpResponse<{data: string}>;\n       expect(res.body!.data).toBe('some data');\n     });\n     it('handles a blank json response', () => {\n       const events = trackEvents(backend.handle(TEST_POST.clone({responseType: 'json'})));\n-      factory.mock.mockFlush(200, 'OK', '');\n+      factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', '');\n       expect(events.length).toBe(2);\n       const res = events[1] as HttpResponse<{data: string}>;\n       expect(res.body).toBeNull();\n     });\n     it('handles a json error response', () => {\n       const events = trackEvents(backend.handle(TEST_POST.clone({responseType: 'json'})));\n-      factory.mock.mockFlush(500, 'Error', JSON.stringify({data: 'some data'}));\n+      factory.mock.mockFlush(\n+          HttpStatusCode.InternalServerError, 'Error', JSON.stringify({data: 'some data'}));\n       expect(events.length).toBe(2);\n       const res = events[1] as any as HttpErrorResponse;\n       expect(res.error!.data).toBe('some data');\n     });\n     it('handles a json error response with XSSI prefix', () => {\n       const events = trackEvents(backend.handle(TEST_POST.clone({responseType: 'json'})));\n-      factory.mock.mockFlush(500, 'Error', XSSI_PREFIX + JSON.stringify({data: 'some data'}));\n+      factory.mock.mockFlush(\n+          HttpStatusCode.InternalServerError, 'Error',\n+          XSSI_PREFIX + JSON.stringify({data: 'some data'}));\n       expect(events.length).toBe(2);\n       const res = events[1] as any as HttpErrorResponse;\n       expect(res.error!.data).toBe('some data');\n     });\n     it('handles a json string response', () => {\n       const events = trackEvents(backend.handle(TEST_POST.clone({responseType: 'json'})));\n       expect(factory.mock.responseType).toEqual('text');\n-      factory.mock.mockFlush(200, 'OK', JSON.stringify('this is a string'));\n+      factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', JSON.stringify('this is a string'));\n       expect(events.length).toBe(2);\n       const res = events[1] as HttpResponse<string>;\n       expect(res.body).toEqual('this is a string');\n     });\n     it('handles a json response with an XSSI prefix', () => {\n       const events = trackEvents(backend.handle(TEST_POST.clone({responseType: 'json'})));\n-      factory.mock.mockFlush(200, 'OK', XSSI_PREFIX + JSON.stringify({data: 'some data'}));\n+      factory.mock.mockFlush(\n+          HttpStatusCode.Ok, 'OK', XSSI_PREFIX + JSON.stringify({data: 'some data'}));\n       expect(events.length).toBe(2);\n       const res = events[1] as HttpResponse<{data: string}>;\n       expect(res.body!.data).toBe('some data');\n@@ -136,7 +140,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n         expect(err.error).toBe('this is the error');\n         done();\n       });\n-      factory.mock.mockFlush(400, 'Bad Request', 'this is the error');\n+      factory.mock.mockFlush(HttpStatusCode.BadRequest, 'Bad Request', 'this is the error');\n     });\n     it('emits real errors via the error path', done => {\n       backend.handle(TEST_POST).subscribe(undefined, (err: HttpErrorResponse) => {\n@@ -156,7 +160,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n       });\n \n       factory.mock.abort = abort;\n-      factory.mock.mockFlush(200, 'OK', 'Done');\n+      factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'Done');\n     });\n     describe('progress events', () => {\n       it('are emitted for download progress', done => {\n@@ -187,7 +191,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n         factory.mock.mockDownloadProgressEvent(100, 300);\n         factory.mock.responseText = 'download';\n         factory.mock.mockDownloadProgressEvent(200, 300);\n-        factory.mock.mockFlush(200, 'OK', 'downloaded');\n+        factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'downloaded');\n       });\n       it('are emitted for upload progress', done => {\n         backend.handle(TEST_POST.clone({reportProgress: true}))\n@@ -211,7 +215,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n             });\n         factory.mock.mockUploadProgressEvent(100, 300);\n         factory.mock.mockUploadProgressEvent(200, 300);\n-        factory.mock.mockFlush(200, 'OK', 'Done');\n+        factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'Done');\n       });\n       it('are emitted when both upload and download progress are available', done => {\n         backend.handle(TEST_POST.clone({reportProgress: true}))\n@@ -228,7 +232,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n             });\n         factory.mock.mockUploadProgressEvent(100, 300);\n         factory.mock.mockDownloadProgressEvent(200, 300);\n-        factory.mock.mockFlush(200, 'OK', 'Done');\n+        factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'Done');\n       });\n       it('are emitted even if length is not computable', done => {\n         backend.handle(TEST_POST.clone({reportProgress: true}))\n@@ -245,7 +249,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n             });\n         factory.mock.mockUploadProgressEvent(100);\n         factory.mock.mockDownloadProgressEvent(200);\n-        factory.mock.mockFlush(200, 'OK', 'Done');\n+        factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'Done');\n       });\n       it('include ResponseHeader with headers and status', done => {\n         backend.handle(TEST_POST.clone({reportProgress: true}))\n@@ -264,7 +268,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n             });\n         factory.mock.mockResponseHeaders = 'Test: Test header\\nContent-Type: text/plain\\n';\n         factory.mock.mockDownloadProgressEvent(200);\n-        factory.mock.mockFlush(200, 'OK', 'Done');\n+        factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'Done');\n       });\n       it('are unsubscribed along with the main request', () => {\n         const sub = backend.handle(TEST_POST.clone({reportProgress: true})).subscribe();\n@@ -282,16 +286,16 @@ const XSSI_PREFIX = ')]}\\'\\n';\n                           event.type === HttpEventType.ResponseHeader)\n                   .map(event => event as HttpResponseBase)\n                   .forEach(event => {\n-                    expect(event.status).toBe(203);\n+                    expect(event.status).toBe(HttpStatusCode.NonAuthoritativeInformation);\n                     expect(event.headers.get('Test')).toEqual('This is a test');\n                   });\n               done();\n             });\n         factory.mock.mockResponseHeaders = 'Test: This is a test\\n';\n-        factory.mock.status = 203;\n+        factory.mock.status = HttpStatusCode.NonAuthoritativeInformation;\n         factory.mock.mockDownloadProgressEvent(100, 300);\n         factory.mock.mockResponseHeaders = 'Test: should never be read\\n';\n-        factory.mock.mockFlush(203, 'OK', 'Testing 1 2 3');\n+        factory.mock.mockFlush(HttpStatusCode.NonAuthoritativeInformation, 'OK', 'Testing 1 2 3');\n       });\n     });\n     describe('gets response URL', () => {\n@@ -304,7 +308,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n           done();\n         });\n         factory.mock.responseURL = '/response/url';\n-        factory.mock.mockFlush(200, 'OK', 'Test');\n+        factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'Test');\n       });\n       it('from X-Request-URL header if XHR.responseURL is not present', done => {\n         backend.handle(TEST_POST).pipe(toArray()).subscribe(events => {\n@@ -315,7 +319,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n           done();\n         });\n         factory.mock.mockResponseHeaders = 'X-Request-URL: /response/url\\n';\n-        factory.mock.mockFlush(200, 'OK', 'Test');\n+        factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'Test');\n       });\n       it('falls back on Request.url if neither are available', done => {\n         backend.handle(TEST_POST).pipe(toArray()).subscribe(events => {\n@@ -325,7 +329,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n           expect(response.url).toBe('/test');\n           done();\n         });\n-        factory.mock.mockFlush(200, 'OK', 'Test');\n+        factory.mock.mockFlush(HttpStatusCode.Ok, 'OK', 'Test');\n       });\n     });\n     describe('corrects for quirks', () => {\n@@ -334,7 +338,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n           expect(events.length).toBe(2);\n           expect(events[1].type).toBe(HttpEventType.Response);\n           const response = events[1] as HttpResponse<string>;\n-          expect(response.status).toBe(204);\n+          expect(response.status).toBe(HttpStatusCode.NoContent);\n           done();\n         });\n         factory.mock.mockFlush(1223, 'IE Special Status', 'Test');\n@@ -344,7 +348,7 @@ const XSSI_PREFIX = ')]}\\'\\n';\n           expect(events.length).toBe(2);\n           expect(events[1].type).toBe(HttpEventType.Response);\n           const response = events[1] as HttpResponse<string>;\n-          expect(response.status).toBe(200);\n+          expect(response.status).toBe(HttpStatusCode.Ok);\n           done();\n         });\n         factory.mock.mockFlush(0, 'CORS 0 status', 'Test');"
        },
        {
            "sha": "f2039bc7f3fc24e8710db2ae12271ca3e84c8919",
            "filename": "packages/common/http/testing/src/request.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/baadd109aa0659a7783924f6159e230ed2589a88/packages%2Fcommon%2Fhttp%2Ftesting%2Fsrc%2Frequest.ts",
            "raw_url": "https://github.com/angular/angular/raw/baadd109aa0659a7783924f6159e230ed2589a88/packages%2Fcommon%2Fhttp%2Ftesting%2Fsrc%2Frequest.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fhttp%2Ftesting%2Fsrc%2Frequest.ts?ref=baadd109aa0659a7783924f6159e230ed2589a88",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {HttpErrorResponse, HttpEvent, HttpHeaders, HttpRequest, HttpResponse} from '@angular/common/http';\n+import {HttpErrorResponse, HttpEvent, HttpHeaders, HttpRequest, HttpResponse, HttpStatusCode} from '@angular/common/http';\n import {Observer} from 'rxjs';\n \n /**\n@@ -56,10 +56,10 @@ export class TestRequest {\n         (opts.headers instanceof HttpHeaders) ? opts.headers : new HttpHeaders(opts.headers);\n     body = _maybeConvertBody(this.request.responseType, body);\n     let statusText: string|undefined = opts.statusText;\n-    let status: number = opts.status !== undefined ? opts.status : 200;\n+    let status: number = opts.status !== undefined ? opts.status : HttpStatusCode.Ok;\n     if (opts.status === undefined) {\n       if (body === null) {\n-        status = 204;\n+        status = HttpStatusCode.NoContent;\n         statusText = statusText || 'No Content';\n       } else {\n         statusText = statusText || 'OK';"
        }
    ],
    "stats": {
        "total": 100,
        "additions": 53,
        "deletions": 47
    }
}