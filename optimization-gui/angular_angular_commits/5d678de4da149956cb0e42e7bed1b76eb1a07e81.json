{
    "author": "JoostK",
    "message": "fix(compiler-cli): avoid broken references in .d.ts files due to @internal markers (#43527)\n\nThe `ErrorCode` enum in the `error_code.ts` file is governed by public\napi guards but the other top-level exports from that file are exempt\nfrom public api documentation and are therefore marked as `@internal`.\nHowever, TypeScript is configured with the `stripInternal` compiler\noption such that declarations with `@internal` markers are not emitted\ninto the `.d.ts` files, but this means that the reexports in the barrel\nfile end up referring to missing declarations.\n\nThe `stripInternal` option is considered internal and its documentation\nstates to use at your own risk (as per https://github.com/microsoft/TypeScript/issues/45307).\nHaving the option enabled is desirable for us as it works well for\nhiding class fields that are marked `@internal`, which is an effective\nway to hide members from the .d.ts file. As a workaround for the issue\nwith top-level symbols, the declarations with `@internal` markers are\nmoved to dedicated files for which no public api guard is setup,\ntherefore allowing their `@internal` markers to be dropped.\n\nFixes #43097\n\nPR Close #43527",
    "sha": "5d678de4da149956cb0e42e7bed1b76eb1a07e81",
    "files": [
        {
            "sha": "58513e7c9349a3e812f422757464958b345d5c25",
            "filename": "packages/compiler-cli/src/ngtsc/diagnostics/index.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Findex.ts?ref=5d678de4da149956cb0e42e7bed1b76eb1a07e81",
            "patch": "@@ -6,6 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n+export {COMPILER_ERRORS_WITH_GUIDES, ERROR_DETAILS_PAGE_BASE_URL} from './src/docs';\n export {FatalDiagnosticError, isFatalDiagnosticError, makeDiagnostic, makeRelatedInformation} from './src/error';\n-export {COMPILER_ERRORS_WITH_GUIDES, ERROR_DETAILS_PAGE_BASE_URL, ErrorCode, ngErrorCode} from './src/error_code';\n-export {replaceTsWithNgInErrors} from './src/util';\n+export {ErrorCode} from './src/error_code';\n+export {ngErrorCode, replaceTsWithNgInErrors} from './src/util';"
        },
        {
            "sha": "28c0a90dae023b5a6ae9a6d15dcbc43d989faf00",
            "filename": "packages/compiler-cli/src/ngtsc/diagnostics/src/docs.ts",
            "status": "added",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/angular/angular/blob/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Fdocs.ts",
            "raw_url": "https://github.com/angular/angular/raw/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Fdocs.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Fdocs.ts?ref=5d678de4da149956cb0e42e7bed1b76eb1a07e81",
            "patch": "@@ -0,0 +1,30 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+import {ErrorCode} from './error_code';\n+\n+/**\n+ * Base URL for the error details page.\n+ * Keep this value in sync with a similar const in\n+ * `packages/core/src/render3/error_code.ts`.\n+ */\n+export const ERROR_DETAILS_PAGE_BASE_URL = 'https://angular.io/errors';\n+\n+/**\n+ * Contains a set of error messages that have detailed guides at angular.io.\n+ * Full list of available error guides can be found at https://angular.io/errors\n+ */\n+export const COMPILER_ERRORS_WITH_GUIDES = new Set([\n+  ErrorCode.DECORATOR_ARG_NOT_LITERAL,\n+  ErrorCode.IMPORT_CYCLE_DETECTED,\n+  ErrorCode.PARAM_MISSING_TOKEN,\n+  ErrorCode.SCHEMA_INVALID_ELEMENT,\n+  ErrorCode.SCHEMA_INVALID_ATTRIBUTE,\n+  ErrorCode.MISSING_REFERENCE_TARGET,\n+  ErrorCode.COMPONENT_INVALID_SHADOW_DOM_SELECTOR,\n+]);"
        },
        {
            "sha": "9ef6d8665c1256fcca8e67f7fb57a37e9b355848",
            "filename": "packages/compiler-cli/src/ngtsc/diagnostics/src/error.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Ferror.ts",
            "raw_url": "https://github.com/angular/angular/raw/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Ferror.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Ferror.ts?ref=5d678de4da149956cb0e42e7bed1b76eb1a07e81",
            "patch": "@@ -8,7 +8,8 @@\n \n import ts from 'typescript';\n \n-import {ErrorCode, ngErrorCode} from './error_code';\n+import {ErrorCode} from './error_code';\n+import {ngErrorCode} from './util';\n \n export class FatalDiagnosticError {\n   constructor("
        },
        {
            "sha": "f791145f786bc9369e7f46549ac664fb29042cc9",
            "filename": "packages/compiler-cli/src/ngtsc/diagnostics/src/error_code.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 30,
            "changes": 30,
            "blob_url": "https://github.com/angular/angular/blob/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Ferror_code.ts",
            "raw_url": "https://github.com/angular/angular/raw/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Ferror_code.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Ferror_code.ts?ref=5d678de4da149956cb0e42e7bed1b76eb1a07e81",
            "patch": "@@ -226,33 +226,3 @@ export enum ErrorCode {\n    */\n   SUGGEST_SUBOPTIMAL_TYPE_INFERENCE = 10002,\n }\n-\n-/**\n- * @internal\n- * Base URL for the error details page.\n- * Keep this value in sync with a similar const in\n- * `packages/core/src/render3/error_code.ts`.\n- */\n-export const ERROR_DETAILS_PAGE_BASE_URL = 'https://angular.io/errors';\n-\n-/**\n- * @internal\n- * Contains a set of error messages that have detailed guides at angular.io.\n- * Full list of available error guides can be found at https://angular.io/errors\n- */\n-export const COMPILER_ERRORS_WITH_GUIDES = new Set([\n-  ErrorCode.DECORATOR_ARG_NOT_LITERAL,\n-  ErrorCode.IMPORT_CYCLE_DETECTED,\n-  ErrorCode.PARAM_MISSING_TOKEN,\n-  ErrorCode.SCHEMA_INVALID_ELEMENT,\n-  ErrorCode.SCHEMA_INVALID_ATTRIBUTE,\n-  ErrorCode.MISSING_REFERENCE_TARGET,\n-  ErrorCode.COMPONENT_INVALID_SHADOW_DOM_SELECTOR,\n-]);\n-\n-/**\n- * @internal\n- */\n-export function ngErrorCode(code: ErrorCode): number {\n-  return parseInt('-99' + code);\n-}"
        },
        {
            "sha": "898a3a1d446de485cdd72c7d3d0f4949a7521513",
            "filename": "packages/compiler-cli/src/ngtsc/diagnostics/src/util.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fdiagnostics%2Fsrc%2Futil.ts?ref=5d678de4da149956cb0e42e7bed1b76eb1a07e81",
            "patch": "@@ -6,6 +6,8 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n+import {ErrorCode} from './error_code';\n+\n const ERROR_CODE_MATCHER = /(\\u001b\\[\\d+m ?)TS-99(\\d+: ?\\u001b\\[\\d+m)/g;\n \n /**\n@@ -20,3 +22,7 @@ const ERROR_CODE_MATCHER = /(\\u001b\\[\\d+m ?)TS-99(\\d+: ?\\u001b\\[\\d+m)/g;\n export function replaceTsWithNgInErrors(errors: string): string {\n   return errors.replace(ERROR_CODE_MATCHER, '$1NG$2');\n }\n+\n+export function ngErrorCode(code: ErrorCode): number {\n+  return parseInt('-99' + code);\n+}"
        },
        {
            "sha": "700d5eded389af72da056e01ecf7efcf01039a3e",
            "filename": "packages/core/src/render3/error_code.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcore%2Fsrc%2Frender3%2Ferror_code.ts",
            "raw_url": "https://github.com/angular/angular/raw/5d678de4da149956cb0e42e7bed1b76eb1a07e81/packages%2Fcore%2Fsrc%2Frender3%2Ferror_code.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Ferror_code.ts?ref=5d678de4da149956cb0e42e7bed1b76eb1a07e81",
            "patch": "@@ -8,7 +8,7 @@\n \n // Base URL for the error details page.\n // Keep this value in sync with a similar const in\n-// `packages/compiler-cli/src/ngtsc/diagnostics/src/error_code.ts`.\n+// `packages/compiler-cli/src/ngtsc/diagnostics/src/docs.ts`.\n const ERROR_DETAILS_PAGE_BASE_URL = 'https://angular.io/errors';\n \n export const enum RuntimeErrorCode {"
        }
    ],
    "stats": {
        "total": 76,
        "additions": 42,
        "deletions": 34
    }
}