{
    "author": "AleksanderBodurri",
    "message": "fix(devtools): ensure that the dark mode toggle button reflects the current theme on load\n\nPreviously this button would appear toggled independent of the current theme. This caused the button to appear to be untoggled in the case when angular devtools detected darkmode in chrome devtools.",
    "sha": "50723bf1db7c88b1341c62654bf9ec21bc4cf589",
    "files": [
        {
            "sha": "25aee97adc1553417248b1a127fd5a9ef8ebb472",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/devtools-tabs.component.html",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/50723bf1db7c88b1341c62654bf9ec21bc4cf589/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdevtools-tabs.component.html",
            "raw_url": "https://github.com/angular/angular/raw/50723bf1db7c88b1341c62654bf9ec21bc4cf589/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdevtools-tabs.component.html",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdevtools-tabs.component.html?ref=50723bf1db7c88b1341c62654bf9ec21bc4cf589",
            "patch": "@@ -30,6 +30,7 @@\n   <br />\n   <br />\n   <mat-slide-toggle\n+    [checked]=\"currentTheme === 'dark-theme'\"\n     (change)=\"themeService.toggleDarkMode($event.checked)\"\n     class=\"menu-toggle-button\"\n     (click)=\"$event.stopPropagation()\""
        },
        {
            "sha": "439664c41dc3b97d68a9ebb4860f06321369edb0",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/devtools-tabs.component.ts",
            "status": "modified",
            "additions": 17,
            "deletions": 5,
            "changes": 22,
            "blob_url": "https://github.com/angular/angular/blob/50723bf1db7c88b1341c62654bf9ec21bc4cf589/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdevtools-tabs.component.ts",
            "raw_url": "https://github.com/angular/angular/raw/50723bf1db7c88b1341c62654bf9ec21bc4cf589/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdevtools-tabs.component.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdevtools-tabs.component.ts?ref=50723bf1db7c88b1341c62654bf9ec21bc4cf589",
            "patch": "@@ -1,35 +1,47 @@\n-import { Component, Input, ViewChild } from '@angular/core';\n+import { Component, Input, OnDestroy, OnInit, ViewChild } from '@angular/core';\n import { Events, MessageBus } from 'protocol';\n import { MatTabGroup } from '@angular/material/tabs';\n import { DirectiveExplorerComponent } from './directive-explorer/directive-explorer.component';\n import { ApplicationEnvironment } from '../application-environment';\n import { MatSlideToggleChange } from '@angular/material/slide-toggle';\n import { TabUpdate } from './tab-update';\n-import { ThemeService } from '../theme-service';\n+import { Theme, ThemeService } from '../theme-service';\n+import { Subscription } from 'rxjs';\n \n @Component({\n   selector: 'ng-devtools-tabs',\n   templateUrl: './devtools-tabs.component.html',\n   styleUrls: ['./devtools-tabs.component.scss'],\n })\n-export class DevToolsTabsComponent {\n+export class DevToolsTabsComponent implements OnInit, OnDestroy {\n   @Input() angularVersion: string | undefined = undefined;\n   @ViewChild(MatTabGroup) tabGroup: MatTabGroup;\n   @ViewChild(DirectiveExplorerComponent) directiveExplorer: DirectiveExplorerComponent;\n \n+  inspectorRunning = false;\n+\n+  private _currentThemeSubscription: Subscription;\n+  currentTheme: Theme;\n+\n   constructor(\n     public tabUpdate: TabUpdate,\n     public themeService: ThemeService,\n     private _messageBus: MessageBus<Events>,\n     private _applicationEnvironment: ApplicationEnvironment\n   ) {}\n \n+  ngOnInit(): void {\n+    this._currentThemeSubscription = this.themeService.currentTheme.subscribe((theme) => (this.currentTheme = theme));\n+  }\n+\n+  ngOnDestroy(): void {\n+    this._currentThemeSubscription.unsubscribe();\n+  }\n+\n   get latestSHA(): string {\n     return this._applicationEnvironment.environment.process.env.LATEST_SHA;\n   }\n \n-  inspectorRunning = false;\n-\n   toggleInspector(): void {\n     this.toggleInspectorState();\n     this.emitInspectorEvent();"
        },
        {
            "sha": "a2b5f4ac8d063568c0a1632ae1fc3617be1df7a0",
            "filename": "projects/ng-devtools/src/lib/theme-service.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/50723bf1db7c88b1341c62654bf9ec21bc4cf589/projects%2Fng-devtools%2Fsrc%2Flib%2Ftheme-service.ts",
            "raw_url": "https://github.com/angular/angular/raw/50723bf1db7c88b1341c62654bf9ec21bc4cf589/projects%2Fng-devtools%2Fsrc%2Flib%2Ftheme-service.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Ftheme-service.ts?ref=50723bf1db7c88b1341c62654bf9ec21bc4cf589",
            "patch": "@@ -1,14 +1,14 @@\n-import { Subject } from 'rxjs';\n+import { ReplaySubject, Subject } from 'rxjs';\n import { Injectable, RendererFactory2, Renderer2 } from '@angular/core';\n \n-export type Themes = 'dark-theme' | 'light-theme';\n+export type Theme = 'dark-theme' | 'light-theme';\n \n @Injectable({\n   providedIn: 'root',\n })\n export class ThemeService {\n   private renderer: Renderer2;\n-  currentTheme: Subject<Themes> = new Subject();\n+  currentTheme: Subject<Theme> = new ReplaySubject();\n \n   constructor(private _rendererFactory: RendererFactory2) {\n     this.renderer = this._rendererFactory.createRenderer(null, null);"
        }
    ],
    "stats": {
        "total": 29,
        "additions": 21,
        "deletions": 8
    }
}