{
    "author": "josephperrott",
    "message": "docs: update docs to reflect new PR targeting methods for release trains (#38401)\n\nAs part of the migration to a common strategy/method for branching and releasing across\nthe main angular repositories, updates need to be made to the documentation. These changes\nreflect the updates made and is based on the following document which describes the\nmerging label expectations: https://docs.google.com/document/d/197kVillDwx-RZtSVOBtPb4BBIAw0E9RT3q3v6DZkykU\n\nPR Close #38401",
    "sha": "e8ea839df804576f2a39759304b5158832bd22b7",
    "files": [
        {
            "sha": "ac7a005b84dbd7600d876c5d0b91136d9a402f70",
            "filename": "docs/CARETAKER.md",
            "status": "modified",
            "additions": 8,
            "deletions": 56,
            "changes": 64,
            "blob_url": "https://github.com/angular/angular/blob/e8ea839df804576f2a39759304b5158832bd22b7/docs%2FCARETAKER.md",
            "raw_url": "https://github.com/angular/angular/raw/e8ea839df804576f2a39759304b5158832bd22b7/docs%2FCARETAKER.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/docs%2FCARETAKER.md?ref=e8ea839df804576f2a39759304b5158832bd22b7",
            "patch": "@@ -4,71 +4,23 @@ Caretaker is responsible for merging PRs into the individual branches and intern\n \n ## Responsibilities\n \n-- Draining the queue of PRs ready to be merged. (PRs with [`PR action: merge`](https://github.com/angular/angular/pulls?q=is%3Aopen+is%3Apr+label%3A%22PR+action%3A+merge%22) label)\n+- Draining the queue of PRs ready to be merged. (PRs with [`action: merge`](https://github.com/angular/angular/pulls?q=is%3Aopen+is%3Apr+label%3A%22action%3A+merge%22) label)\n - Assigning [new issues](https://github.com/angular/angular/issues?q=is%3Aopen+is%3Aissue+no%3Alabel) to individual component authors.\n \n ## Merging the PR\n \n-A PR needs to have `PR action: merge` and `PR target: *` labels to be considered\n-ready to merge. Merging is performed by running `merge-pr` with a PR number to merge.\n+A PR needs to have `action: merge` and `target: *` labels to be considered\n+ready to merge. Merging is performed by running `ng-dev pr merge` with a PR number to merge.\n+\n+The tooling automatically verifies the given PR is ready for merge. If the PR passes the tests, the\n+tool will automatically merge it based on the applied target label.\n \n To merge a PR run:\n \n ```\n-$ ./scripts/github/merge-pr 1234\n+$ yarn ng-dev pr merge <pr number>\n ```\n \n-The `merge-pr` script will:\n-- Ensure that all appropriate labels are on the PR.\n-- Fetches the latest PR code from the `angular/angular` repo.\n-- It will `cherry-pick` all of the SHAs from the PR into the current corresponding branches `master` and or `?.?.x` (patch).\n-- It will rewrite commit history by automatically adding `Close #1234` and `(#1234)` into the commit message.\n-\n-NOTE: The `merge-pr` will land the PR on `master` and or `?.?.x` (patch) as described by `PR target: *` label.\n-\n ### Recovering from failed `merge-pr` due to conflicts\n \n-When running `merge-pr` the script will output the commands which it is about to run.\n-\n-```\n-$ ./scripts/github/merge-pr 1234\n-======================\n-GitHub Merge PR Steps\n-======================\n-   git cherry-pick angular/pr/1234~1..angular/pr/1234\n-   git filter-branch -f --msg-filter \"/home/misko/angular/scripts/github/utils/github.closes 1234\" HEAD~1..HEAD\n-```\n-\n-If the `cherry-pick` command fails than resolve conflicts and use `git cherry-pick --continue` once ready. After the `cherry-pick` is done cut&paste and run the `filter-branch` command to properly rewrite the messages\n-\n-## Cherry-picking PRs into patch branch\n-\n-In addition to merging PRs into the master branch, many PRs need to be also merged into a patch branch.\n-Follow these steps to get patch branch up to date.\n-\n-1. Check out the most recent patch branch: `git checkout 4.3.x`\n-2. Get a list of PRs merged into master: `git log master --oneline -n10`\n-3. For each PR number in the commit message run: `./scripts/github/merge-pr 1234`\n-   - The PR will only merge if the `PR target:` matches the branch.\n-\n-Once all of the PRs are in patch branch, push the all branches and tags to github using `push-upstream` script.\n-\n-\n-## Pushing merged PRs into github\n-\n-Use `push-upstream` script to push all of the branch and tags to github.\n-\n-```\n-$ ./scripts/github/push-upstream\n-git push git@github.com:angular/angular.git master:master 4.3.x:4.3.x\n-Counting objects: 25, done.\n-Delta compression using up to 6 threads.\n-Compressing objects: 100% (17/17), done.\n-Writing objects: 100% (25/25), 2.22 KiB | 284.00 KiB/s, done.\n-Total 25 (delta 22), reused 8 (delta 7)\n-remote: Resolving deltas: 100% (22/22), completed with 18 local objects.\n-To github.com:angular/angular.git\n-   079d884b6..d1c4a94bb  master -> master\n-git push --tags -f git@github.com:angular/angular.git patch_sync:patch_sync\n-Everything up-to-date\n-```\n+The `ng-dev pr merge` tool will automatically restore to the previous git state when a merge fails."
        },
        {
            "sha": "91abbb4c6608e4ed19742e3611aeb229b46dab34",
            "filename": "docs/COMMITTER.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/e8ea839df804576f2a39759304b5158832bd22b7/docs%2FCOMMITTER.md",
            "raw_url": "https://github.com/angular/angular/raw/e8ea839df804576f2a39759304b5158832bd22b7/docs%2FCOMMITTER.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/docs%2FCOMMITTER.md?ref=e8ea839df804576f2a39759304b5158832bd22b7",
            "patch": "@@ -12,7 +12,7 @@ Change approvals in our monorepo are managed via [PullApprove](https://docs.pull\n # Merging\n \n Once a change has all of the required approvals, either the last approver or the PR author (if PR author has the project collaborator status)\n-should mark the PR with the `PR action: merge` label and the correct [target label](https://github.com/angular/angular/blob/master/docs/TRIAGE_AND_LABELS.md#pr-target).\n+should mark the PR with the `action: merge` label and the correct [target label](https://github.com/angular/angular/blob/master/docs/TRIAGE_AND_LABELS.md#pr-target).\n This signals to the caretaker that the PR should be merged. See [merge instructions](CARETAKER.md).\n \n # Who is the Caretaker?"
        },
        {
            "sha": "05101743f230e180eceff66adfd5d4f506b1eff1",
            "filename": "docs/TRIAGE_AND_LABELS.md",
            "status": "modified",
            "additions": 30,
            "deletions": 16,
            "changes": 46,
            "blob_url": "https://github.com/angular/angular/blob/e8ea839df804576f2a39759304b5158832bd22b7/docs%2FTRIAGE_AND_LABELS.md",
            "raw_url": "https://github.com/angular/angular/raw/e8ea839df804576f2a39759304b5158832bd22b7/docs%2FTRIAGE_AND_LABELS.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/docs%2FTRIAGE_AND_LABELS.md?ref=e8ea839df804576f2a39759304b5158832bd22b7",
            "patch": "@@ -125,28 +125,28 @@ Triaging PRs is the same as triaging issues, except that the labels `frequency:\n \n PRs also have additional label categories that should be used to signal their state.\n \n-Every triaged PR must have a `PR action` label assigned to it:\n+Every triaged PR must have a `action: *` label assigned to it:\n \n-* `PR action: discuss`: Discussion is needed, to be led by the author.\n+* `action: discuss`: Discussion is needed, to be led by the author.\n   * _**Who adds it:** Typically the PR author._\n   * _**Who removes it:** Whoever added it._\n-* `PR action: review` (optional): One or more reviews are pending. The label is optional, since the review status can be derived from GitHub's Reviewers interface.\n+* `action: review` (optional): One or more reviews are pending. The label is optional, since the review status can be derived from GitHub's Reviewers interface.\n   * _**Who adds it:** Any team member. The caretaker can use it to differentiate PRs pending review from merge-ready PRs._\n   * _**Who removes it:** Whoever added it or the reviewer adding the last missing review._\n-* `PR action: cleanup`: More work is needed from the author.\n+* `action: cleanup`: More work is needed from the author.\n   * _**Who adds it:** The reviewer requesting changes to the PR._\n   * _**Who removes it:** Either the author (after implementing the requested changes) or the reviewer (after confirming the requested changes have been implemented)._\n-* `PR action: merge`: The PR author is ready for the changes to be merged by the caretaker as soon as the PR is green (or merge-assistance label is applied and caretaker has deemed it acceptable manually). In other words, this label indicates to \"auto submit when ready\".\n+* `action: merge`: The PR author is ready for the changes to be merged by the caretaker as soon as the PR is green (or merge-assistance label is applied and caretaker has deemed it acceptable manually). In other words, this label indicates to \"auto submit when ready\".\n   * _**Who adds it:** Typically the PR author._\n   * _**Who removes it:** Whoever added it._\n \n \n In addition, PRs can have the following states:\n \n-* `PR state: WIP`: PR is experimental or rapidly changing. Not ready for review or triage.\n+* `state: WIP`: PR is experimental or rapidly changing. Not ready for review or triage.\n   * _**Who adds it:** The PR author._\n   * _**Who removes it:** Whoever added it._\n-* `PR state: blocked`: PR is blocked on an issue or other PR. Not ready for merge.\n+* `state: blocked`: PR is blocked on an issue or other PR. Not ready for merge.\n   * _**Who adds it:** Any team member._\n   * _**Who removes it:** Any team member._\n \n@@ -162,13 +162,27 @@ This decision is then honored when the PR is being merged by the caretaker.\n \n To communicate the target we use the following labels:\n \n-* `PR target: master & patch`: the PR should me merged into the master branch and cherry-picked into the most recent patch branch. All PRs with fixes, docs and refactorings should use this target.\n-* `PR target: master-only`: the PR should be merged only into the `master` branch. All PRs with new features, API changes or high-risk changes should use this target.\n-* `PR target: patch-only`: the PR should be merged only into the most recent patch branch (e.g. 5.0.x). This target is useful if a `master & patch` PR can't be cleanly cherry-picked into the stable branch and a new PR is needed.\n-* `PR target: LTS-only`: the PR should be merged only into the active LTS branch(es). Only security and critical fixes are allowed in these branches. Always send a new PR targeting just the LTS branch and request review approval from @IgorMinar.\n-* `PR target: TBD`: the target is yet to be determined.\n+Targeting an active release train:\n \n-If a PR is missing the `PR target: *` label, or if the label is set to \"TBD\" when the PR is sent to the caretaker, the caretaker should reject the PR and request the appropriate target label to be applied before the PR is merged.\n+* `target: major`: Any breaking change\n+* `target: minor`: Any new feature\n+* `target: patch`: Bug fixes, refactorings, documentation changes, etc. that pose no or very low risk of adversely\n+  affecting existing applications.\n+\n+Special Cases:\n+* `target: rc`: A critical fix for an active release-train while it is in a feature freeze or RC phase\n+* `target: lts`: A criticial fix for a specific release-train that is still within the long term support phase\n+\n+\n+Notes:\n+  - To land a change only in a patch/RC branch, without landing it in any other active release-train branch (such\n+  as `master`), the patch/RC branch can be targeted in the Github UI with the appropriate\n+  `target: patch`/`target: rc` label.\n+  - `target: lts` PRs must target the specific LTS branch they would need to merge into in the Github UI, in\n+  cases which a change is desired in multiple LTS branches, individual PRs for each LTS branch must be created\n+\n+\n+If a PR is missing the `target:*` label, it will be marked as pending by the angular robot status checks.\n \n \n ## PR Approvals\n@@ -182,7 +196,7 @@ In any case, the reviewer should actually look through the code and provide feed\n \n Note that approved state does not mean a PR is ready to be merged.\n For example, a reviewer might approve the PR but request a minor tweak that doesn't need further review, e.g., a rebase or small uncontroversial change.\n-Only the `PR action: merge` label means that the PR is ready for merging.\n+Only the `action: merge` label means that the PR is ready for merging.\n \n \n ## Special Labels\n@@ -201,7 +215,7 @@ Only issues with `cla:yes` should be merged into master.\n \n Applying this label to a PR makes the angular.io preview available regardless of the author. [More info](../aio/aio-builds-setup/docs/overview--security-model.md)\n \n-### `PR action: merge-assistance`\n+### `action: merge-assistance`\n * _**Who adds it:** Any team member._\n * _**Who removes it:** Any team member._\n \n@@ -211,7 +225,7 @@ The comment should be formatted like this: `merge-assistance: <explain what kind\n \n For example, the PR owner might not be a Googler and needs help to run g3sync; or one of the checks is failing due to external causes and the PR should still be merged.\n \n-### `PR action: rerun CI at HEAD`\n+### `action: rerun CI at HEAD`\n * _**Who adds it:** Any team member._\n * _**Who removes it:** The Angular Bot, once it triggers the CI rerun._\n "
        }
    ],
    "stats": {
        "total": 112,
        "additions": 39,
        "deletions": 73
    }
}