{
    "author": "petebacondarwin",
    "message": "test(compiler): check that the parser supports prematurely terminated interpolations (#42062)\n\nSuch interpolations turned up during internal testing at Google, so this\ncommit adds a test to prevent regressions.\n\nPR Close #42062",
    "sha": "11ebe21d0dc8d82970153007e780800c87a76021",
    "files": [
        {
            "sha": "a47d29ca3b2d645e3d69f5f78bd98b9608a85e87",
            "filename": "packages/compiler/test/ml_parser/html_parser_spec.ts",
            "status": "modified",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/angular/angular/blob/11ebe21d0dc8d82970153007e780800c87a76021/packages%2Fcompiler%2Ftest%2Fml_parser%2Fhtml_parser_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/11ebe21d0dc8d82970153007e780800c87a76021/packages%2Fcompiler%2Ftest%2Fml_parser%2Fhtml_parser_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Ftest%2Fml_parser%2Fhtml_parser_spec.ts?ref=11ebe21d0dc8d82970153007e780800c87a76021",
            "patch": "@@ -239,6 +239,23 @@ import {humanizeDom, humanizeDomSourceSpans, humanizeLineColumn, humanizeNodes}\n           ]);\n           expect(parsed.errors).toEqual([]);\n         });\n+\n+        it('should treat prematurely terminated interpolation as text', () => {\n+          const {errors, rootNodes} =\n+              parser.parse('<div><span>x {{ expr }<!---->} y</span><div></div></div>', 'TestComp');\n+          expect(humanizeNodes(rootNodes, true)).toEqual([\n+            [\n+              html.Element, 'div', 0, '<div><span>x {{ expr }<!---->} y</span><div></div></div>',\n+              '<div>', '</div>'\n+            ],\n+            [html.Element, 'span', 1, '<span>x {{ expr }<!---->} y</span>', '<span>', '</span>'],\n+            [html.Text, 'x {{ expr }', 2, ['x '], ['{{', ' expr }'], [''], 'x {{ expr }'],\n+            [html.Comment, '', 2, '<!--'],\n+            [html.Text, '} y', 2, ['} y'], '} y'],\n+            [html.Element, 'div', 1, '<div></div>', '<div>', '</div>'],\n+          ]);\n+          expect(errors).toEqual([]);\n+        });\n       });\n \n       describe('attributes', () => {\n@@ -318,6 +335,16 @@ import {humanizeDom, humanizeDomSourceSpans, humanizeLineColumn, humanizeNodes}\n             [html.Attribute, ':xlink:href', 'Port', ['Port']],\n           ]);\n         });\n+\n+        it('should support a prematurely terminated interpolation in attribute', () => {\n+          const {errors, rootNodes} = parser.parse('<div p=\"{{ abc\"><span></span>', 'TestComp');\n+          expect(humanizeNodes(rootNodes, true)).toEqual([\n+            [html.Element, 'div', 0, '<div p=\"{{ abc\">', '<div p=\"{{ abc\">', null],\n+            [html.Attribute, 'p', '{{ abc', [''], ['{{', ' abc'], [''], 'p=\"{{ abc\"'],\n+            [html.Element, 'span', 1, '<span></span>', '<span>', '</span>'],\n+          ]);\n+          expect(humanizeErrors(errors)).toEqual([]);\n+        });\n       });\n \n       describe('comments', () => {"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 27,
        "deletions": 0
    }
}