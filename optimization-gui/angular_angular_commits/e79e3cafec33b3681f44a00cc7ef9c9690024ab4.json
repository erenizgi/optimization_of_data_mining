{
    "author": "atscott",
    "message": "fix(router): fix Router's public API for canceledNavigationResolution (#43842)\n\nThe commit which made the `canceledNavigationResolution` property on the `Router`\npublic did not add the corresponding configuration in the `ExtraOptions`.\nhttps://github.com/angular/angular/commit/3c6b653089837459809a370ebcaf8911c3bab9ed\nThis was a mistake and is being corrected in this commit. We should not\nencourage changing the properties post-setup (i.e.\n`inject(Router).canceledNavigationResolution = 'computed'`). This manner\nof configuration makes the options non-tree shakeable because we have to\nkeep both implementations in case the value changes at runtime.\n\nPR Close #43842",
    "sha": "e79e3cafec33b3681f44a00cc7ef9c9690024ab4",
    "files": [
        {
            "sha": "4a75df4db6b79e8e81e7feb159f0390d6f031a9a",
            "filename": "goldens/public-api/router/router.md",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/e79e3cafec33b3681f44a00cc7ef9c9690024ab4/goldens%2Fpublic-api%2Frouter%2Frouter.md",
            "raw_url": "https://github.com/angular/angular/raw/e79e3cafec33b3681f44a00cc7ef9c9690024ab4/goldens%2Fpublic-api%2Frouter%2Frouter.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Frouter%2Frouter.md?ref=e79e3cafec33b3681f44a00cc7ef9c9690024ab4",
            "patch": "@@ -184,6 +184,7 @@ export { Event_2 as Event }\n // @public\n export interface ExtraOptions {\n     anchorScrolling?: 'disabled' | 'enabled';\n+    canceledNavigationResolution?: 'replace' | 'computed';\n     enableTracing?: boolean;\n     errorHandler?: ErrorHandler;\n     initialNavigation?: InitialNavigation;"
        },
        {
            "sha": "8c97d92278dcdcb71be51142249088b1d6bc9857",
            "filename": "packages/router/src/router_module.ts",
            "status": "modified",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/angular/angular/blob/e79e3cafec33b3681f44a00cc7ef9c9690024ab4/packages%2Frouter%2Fsrc%2Frouter_module.ts",
            "raw_url": "https://github.com/angular/angular/raw/e79e3cafec33b3681f44a00cc7ef9c9690024ab4/packages%2Frouter%2Fsrc%2Frouter_module.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Frouter_module.ts?ref=e79e3cafec33b3681f44a00cc7ef9c9690024ab4",
            "patch": "@@ -426,6 +426,29 @@ export interface ExtraOptions {\n    * The default in v11 is `corrected`.\n    */\n   relativeLinkResolution?: 'legacy'|'corrected';\n+\n+  /**\n+   * Configures how the Router attempts to restore state when a navigation is cancelled.\n+   *\n+   * 'replace' - Always uses `location.replaceState` to set the browser state to the state of the\n+   * router before the navigation started. This means that if the URL of the browser is updated\n+   * _before_ the navigation is canceled, the Router will simply replace the item in history rather\n+   * than trying to restore to the previous location in the session history. This happens most\n+   * frequently with `urlUpdateStrategy: 'eager'` and navigations with the browser back/forward\n+   * buttons.\n+   *\n+   * 'computed' - Will attempt to return to the same index in the session history that corresponds\n+   * to the Angular route when the navigation gets cancelled. For example, if the browser back\n+   * button is clicked and the navigation is cancelled, the Router will trigger a forward navigation\n+   * and vice versa.\n+   *\n+   * Note: the 'computed' option is incompatible with any `UrlHandlingStrategy` which only\n+   * handles a portion of the URL because the history restoration navigates to the previous place in\n+   * the browser history rather than simply resetting a portion of the URL.\n+   *\n+   * The default value is `replace` when not set.\n+   */\n+  canceledNavigationResolution?: 'replace'|'computed';\n }\n \n export function setupRouter(\n@@ -483,6 +506,10 @@ export function assignExtraOptionsToRouter(opts: ExtraOptions, router: Router):\n   if (opts.urlUpdateStrategy) {\n     router.urlUpdateStrategy = opts.urlUpdateStrategy;\n   }\n+\n+  if (opts.canceledNavigationResolution) {\n+    router.canceledNavigationResolution = opts.canceledNavigationResolution;\n+  }\n }\n \n export function rootRoute(router: Router): ActivatedRoute {"
        },
        {
            "sha": "ba76bce72d1c0fc9f7dd4dc5ac10251a84d82b88",
            "filename": "packages/router/test/computed_state_restoration.spec.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/e79e3cafec33b3681f44a00cc7ef9c9690024ab4/packages%2Frouter%2Ftest%2Fcomputed_state_restoration.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/e79e3cafec33b3681f44a00cc7ef9c9690024ab4/packages%2Frouter%2Ftest%2Fcomputed_state_restoration.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fcomputed_state_restoration.spec.ts?ref=e79e3cafec33b3681f44a00cc7ef9c9690024ab4",
            "patch": "@@ -81,7 +81,6 @@ describe('`restoredState#ÉµrouterPageId`', () => {\n       ]\n     });\n     const router = TestBed.inject(Router);\n-    (router as any).canceledNavigationResolution = 'computed';\n     const location = TestBed.inject(Location);\n     fixture = createRoot(router, RootCmp);\n     router.resetConfig([\n@@ -486,7 +485,9 @@ function advance(fixture: ComponentFixture<any>, millis?: number): void {\n }\n \n @NgModule({\n-  imports: [RouterTestingModule, CommonModule],\n+  imports: [\n+    RouterTestingModule.withRoutes([], {canceledNavigationResolution: 'computed'}), CommonModule\n+  ],\n   exports: [SimpleCmp, RootCmp, ThrowingCmp],\n   entryComponents: [SimpleCmp, RootCmp, ThrowingCmp],\n   declarations: [SimpleCmp, RootCmp, ThrowingCmp]"
        }
    ],
    "stats": {
        "total": 33,
        "additions": 31,
        "deletions": 2
    }
}