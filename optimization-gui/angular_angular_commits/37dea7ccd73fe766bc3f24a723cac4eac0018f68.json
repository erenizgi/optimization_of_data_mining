{
    "author": "AleksanderBodurri",
    "message": "fix(devtools): sort array indexes in ascending order",
    "sha": "37dea7ccd73fe766bc3f24a723cac4eac0018f68",
    "files": [
        {
            "sha": "d7fdfb15a47ffe8f4711e94e29031ec838602869",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/directive-explorer/property-resolver/arrayify-props.spec.ts",
            "status": "added",
            "additions": 81,
            "deletions": 0,
            "changes": 81,
            "blob_url": "https://github.com/angular/angular/blob/37dea7ccd73fe766bc3f24a723cac4eac0018f68/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Farrayify-props.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/37dea7ccd73fe766bc3f24a723cac4eac0018f68/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Farrayify-props.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Farrayify-props.spec.ts?ref=37dea7ccd73fe766bc3f24a723cac4eac0018f68",
            "patch": "@@ -0,0 +1,81 @@\n+import { PropType } from 'protocol';\n+import { arrayifyProps } from './arrayify-props';\n+\n+describe('arrayify', () => {\n+  it('should return an array from prop object', () => {\n+    const arr = arrayifyProps({\n+      foo: {\n+        editable: true,\n+        expandable: true,\n+        preview: '',\n+        type: PropType.Array,\n+      },\n+      bar: {\n+        editable: true,\n+        expandable: true,\n+        preview: '',\n+        type: PropType.Array,\n+      },\n+    });\n+    expect(arr).toEqual([\n+      {\n+        name: 'bar',\n+        descriptor: {\n+          editable: true,\n+          expandable: true,\n+          preview: '',\n+          type: PropType.Array,\n+        },\n+        parent: null,\n+      },\n+      {\n+        name: 'foo',\n+        descriptor: {\n+          editable: true,\n+          expandable: true,\n+          preview: '',\n+          type: PropType.Array,\n+        },\n+        parent: null,\n+      },\n+    ]);\n+  });\n+  it('should properly sort array objects', () => {\n+    const arr = arrayifyProps({\n+      11: {\n+        editable: true,\n+        expandable: true,\n+        preview: '',\n+        type: PropType.Array,\n+      },\n+      2: {\n+        editable: true,\n+        expandable: true,\n+        preview: '',\n+        type: PropType.Array,\n+      },\n+    });\n+    expect(arr).toEqual([\n+      {\n+        name: '2',\n+        descriptor: {\n+          editable: true,\n+          expandable: true,\n+          preview: '',\n+          type: PropType.Array,\n+        },\n+        parent: null,\n+      },\n+      {\n+        name: '11',\n+        descriptor: {\n+          editable: true,\n+          expandable: true,\n+          preview: '',\n+          type: PropType.Array,\n+        },\n+        parent: null,\n+      },\n+    ]);\n+  });\n+});"
        },
        {
            "sha": "d3d40cc0b2a291b1cb34e956f869713d60128b1f",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/directive-explorer/property-resolver/arrayify-props.ts",
            "status": "added",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/angular/angular/blob/37dea7ccd73fe766bc3f24a723cac4eac0018f68/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Farrayify-props.ts",
            "raw_url": "https://github.com/angular/angular/raw/37dea7ccd73fe766bc3f24a723cac4eac0018f68/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Farrayify-props.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Farrayify-props.ts?ref=37dea7ccd73fe766bc3f24a723cac4eac0018f68",
            "patch": "@@ -0,0 +1,19 @@\n+import { Descriptor } from 'protocol';\n+import { Property } from './element-property-resolver';\n+\n+export const arrayifyProps = (\n+  props: { [prop: string]: Descriptor } | Descriptor[],\n+  parent: Property | null = null\n+): Property[] =>\n+  Object.keys(props)\n+    .map((name) => ({ name, descriptor: props[name], parent }))\n+    .sort((a, b) => {\n+      const parsedA = parseInt(a.name, 10);\n+      const parsedB = parseInt(b.name, 10);\n+\n+      if (isNaN(parsedA) || isNaN(parsedB)) {\n+        return a.name > b.name ? 1 : -1;\n+      }\n+\n+      return parsedA - parsedB;\n+    });"
        },
        {
            "sha": "fa12410cded7b17bf5c3a05c8d4e0c0e2eabf921",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/directive-explorer/property-resolver/arrayify.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 14,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/ec66218c28f68e97fd9f632dbeec0cfc3f9a161c/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Farrayify.ts",
            "raw_url": "https://github.com/angular/angular/raw/ec66218c28f68e97fd9f632dbeec0cfc3f9a161c/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Farrayify.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Farrayify.ts?ref=ec66218c28f68e97fd9f632dbeec0cfc3f9a161c",
            "patch": "@@ -1,14 +0,0 @@\n-import { Descriptor } from 'protocol';\n-import { Property } from './element-property-resolver';\n-\n-export const arrayify = (props: { [prop: string]: Descriptor }, parent: Property | null = null): Property[] =>\n-  Object.keys(props)\n-    .map((name) => ({ name, descriptor: props[name], parent }))\n-    .sort((a, b) => {\n-      if (a.name > b.name) {\n-        return 1;\n-      } else if (a.name < b.name) {\n-        return -1;\n-      }\n-      return 0;\n-    });"
        },
        {
            "sha": "288a4801fbb1fddb47a0aeaa3fd73f879ef05095",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/directive-explorer/property-resolver/directive-property-resolver.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/37dea7ccd73fe766bc3f24a723cac4eac0018f68/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Fdirective-property-resolver.ts",
            "raw_url": "https://github.com/angular/angular/raw/37dea7ccd73fe766bc3f24a723cac4eac0018f68/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Fdirective-property-resolver.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Fdirective-property-resolver.ts?ref=37dea7ccd73fe766bc3f24a723cac4eac0018f68",
            "patch": "@@ -6,7 +6,7 @@ import { getExpandedDirectiveProperties } from './property-expanded-directive-pr\n import { Observable } from 'rxjs';\n import { Property, FlatNode } from './element-property-resolver';\n import { ViewEncapsulation } from '@angular/core';\n-import { arrayify } from './arrayify';\n+import { arrayifyProps } from './arrayify-props';\n \n export interface DirectiveTreeData {\n   dataSource: PropertyDataSource;\n@@ -131,7 +131,7 @@ export class DirectivePropertyResolver {\n       (descriptor.type === PropType.Object || descriptor.type === PropType.Array) &&\n       !(descriptor.value instanceof Observable)\n     ) {\n-      return arrayify(descriptor.value || {}, prop);\n+      return arrayifyProps(descriptor.value || {}, prop);\n     } else {\n       console.error('Unexpected data type', descriptor, 'in property', prop);\n     }"
        },
        {
            "sha": "3270fa8c3b47fe70ca63f5a172fb0bd1189661b6",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/directive-explorer/property-resolver/property-data-source.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/37dea7ccd73fe766bc3f24a723cac4eac0018f68/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Fproperty-data-source.ts",
            "raw_url": "https://github.com/angular/angular/raw/37dea7ccd73fe766bc3f24a723cac4eac0018f68/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Fproperty-data-source.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Fproperty-data-source.ts?ref=37dea7ccd73fe766bc3f24a723cac4eac0018f68",
            "patch": "@@ -7,7 +7,7 @@ import { map } from 'rxjs/operators';\n import { DefaultIterableDiffer } from '@angular/core';\n import { diff } from '../../diffing';\n import { FlatNode, Property } from './element-property-resolver';\n-import { arrayify } from './arrayify';\n+import { arrayifyProps } from './arrayify-props';\n \n const trackBy = (_: number, item: FlatNode) => {\n   return `#${item.prop.name}#${item.level}`;\n@@ -27,7 +27,7 @@ export class PropertyDataSource extends DataSource<FlatNode> {\n     private _messageBus: MessageBus<Events>\n   ) {\n     super();\n-    this._data.next(this._treeFlattener.flattenNodes(arrayify(props)));\n+    this._data.next(this._treeFlattener.flattenNodes(arrayifyProps(props)));\n   }\n \n   get data(): FlatNode[] {\n@@ -39,7 +39,7 @@ export class PropertyDataSource extends DataSource<FlatNode> {\n   }\n \n   update(props: { [prop: string]: Descriptor }): void {\n-    const newData = this._treeFlattener.flattenNodes(arrayify(props));\n+    const newData = this._treeFlattener.flattenNodes(arrayifyProps(props));\n     diff(this._differ, this.data, newData);\n     this._data.next(this.data);\n   }\n@@ -99,7 +99,7 @@ export class PropertyDataSource extends DataSource<FlatNode> {\n     this._messageBus.once('nestedProperties', (position: DirectivePosition, data: Properties, _path: string[]) => {\n       node.prop.descriptor.value = data.props;\n       this._treeControl.expand(node);\n-      const props = arrayify(data.props, node.prop);\n+      const props = arrayifyProps(data.props, node.prop);\n       const flatNodes = this._treeFlattener.flattenNodes(props);\n       flatNodes.forEach((f) => (f.level += node.level + 1));\n       this.data.splice(index + 1, 0, ...flatNodes);"
        }
    ],
    "stats": {
        "total": 126,
        "additions": 106,
        "deletions": 20
    }
}