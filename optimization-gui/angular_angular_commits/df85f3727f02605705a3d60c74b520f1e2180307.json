{
    "author": "atscott",
    "message": "refactor(router): Produce error message when canActivate is used with redirectTo (#40067)\n\nRedirects in the router are processed before activations. This means that a canActivate will\nnever execute if a route has a redirect. Rather than silently ignoring\nthe invalid config, developers should be notified so they know why it\ndoesn't work.\n\nCloses #18605\nThe feature request for a function/class redirect is covered in #13373.\n\nPR Close #40067",
    "sha": "df85f3727f02605705a3d60c74b520f1e2180307",
    "files": [
        {
            "sha": "ed45e9b1513467d4ac530519c9fbe7f609a4c1ee",
            "filename": "packages/router/src/utils/config.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/df85f3727f02605705a3d60c74b520f1e2180307/packages%2Frouter%2Fsrc%2Futils%2Fconfig.ts",
            "raw_url": "https://github.com/angular/angular/raw/df85f3727f02605705a3d60c74b520f1e2180307/packages%2Frouter%2Fsrc%2Futils%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Futils%2Fconfig.ts?ref=df85f3727f02605705a3d60c74b520f1e2180307",
            "patch": "@@ -58,6 +58,12 @@ function validateNode(route: Route, fullPath: string): void {\n       throw new Error(`Invalid configuration of route '${\n           fullPath}': redirectTo and component cannot be used together`);\n     }\n+    if (route.redirectTo && route.canActivate) {\n+      throw new Error(\n+          `Invalid configuration of route '${\n+              fullPath}': redirectTo and canActivate cannot be used together. Redirects happen before activation ` +\n+          `so canActivate will never be executed.`);\n+    }\n     if (route.path && route.matcher) {\n       throw new Error(\n           `Invalid configuration of route '${fullPath}': path and matcher cannot be used together`);"
        },
        {
            "sha": "248767d415f9d157d16c87a96316bb02f33cb1e4",
            "filename": "packages/router/test/config.spec.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/df85f3727f02605705a3d60c74b520f1e2180307/packages%2Frouter%2Ftest%2Fconfig.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/df85f3727f02605705a3d60c74b520f1e2180307/packages%2Frouter%2Ftest%2Fconfig.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fconfig.spec.ts?ref=df85f3727f02605705a3d60c74b520f1e2180307",
            "patch": "@@ -98,6 +98,15 @@ describe('config', () => {\n               `Invalid configuration of route 'a': redirectTo and component cannot be used together`);\n     });\n \n+    it('should throw when component and redirectTo are used together', () => {\n+      expect(() => {\n+        validateConfig([{path: 'a', redirectTo: 'b', canActivate: []}]);\n+      })\n+          .toThrowError(\n+              `Invalid configuration of route 'a': redirectTo and canActivate cannot be used together. ` +\n+              `Redirects happen before activation so canActivate will never be executed.`);\n+    });\n+\n     it('should throw when path and matcher are used together', () => {\n       expect(() => {\n         validateConfig([{path: 'a', matcher: <any>'someFunc', children: []}]);"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 15,
        "deletions": 0
    }
}