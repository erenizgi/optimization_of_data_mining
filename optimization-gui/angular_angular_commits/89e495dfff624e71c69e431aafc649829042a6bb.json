{
    "author": "mgechev",
    "message": "build(devtools): update scripts and manifest",
    "sha": "89e495dfff624e71c69e431aafc649829042a6bb",
    "files": [
        {
            "sha": "6830f7f9f86f1b8302886c97d2a581a9a871082c",
            "filename": "package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/89e495dfff624e71c69e431aafc649829042a6bb/package.json",
            "raw_url": "https://github.com/angular/angular/raw/89e495dfff624e71c69e431aafc649829042a6bb/package.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/package.json?ref=89e495dfff624e71c69e431aafc649829042a6bb",
            "patch": "@@ -8,7 +8,7 @@\n     \"start\": \"cross-env LATEST_SHA=`git rev-parse --short HEAD` ng serve\",\n     \"build\": \"ng build\",\n     \"build:chrome\": \"cross-env LATEST_SHA=`git rev-parse --short HEAD` ng build shell-chrome\",\n-    \"release\": \"node projects/shell-chrome/set-version.js && cross-env LATEST_SHA=`git rev-parse --short HEAD` ng build shell-chrome --prod\",\n+    \"release\": \"node projects/shell-chrome/set-version.js && cross-env LATEST_SHA=`git rev-parse --short HEAD` ng build shell-chrome --configuration production\",\n     \"test\": \"ng test\",\n     \"lint\": \"ng lint\",\n     \"lint:fix\": \"ng lint --fix\","
        },
        {
            "sha": "a28664eeb79a3a21ea35a894819f894cf66da3b6",
            "filename": "projects/shell-chrome/set-version.js",
            "status": "modified",
            "additions": 30,
            "deletions": 13,
            "changes": 43,
            "blob_url": "https://github.com/angular/angular/blob/89e495dfff624e71c69e431aafc649829042a6bb/projects%2Fshell-chrome%2Fset-version.js",
            "raw_url": "https://github.com/angular/angular/raw/89e495dfff624e71c69e431aafc649829042a6bb/projects%2Fshell-chrome%2Fset-version.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fshell-chrome%2Fset-version.js?ref=89e495dfff624e71c69e431aafc649829042a6bb",
            "patch": "@@ -8,27 +8,44 @@ const MANIFEST_PATH = join(__dirname, 'src/manifest.json');\n \n const manifest = JSON.parse(readFileSync(MANIFEST_PATH).toString());\n \n+console.log('Current version', chalk.yellow(manifest.version));\n+console.log('Current version name', chalk.yellow(manifest.version_name));\n+\n+const setVersion = (nextVersion) => {\n+  manifest.version = nextVersion;\n+  manifest.version_name = nextVersion;\n+\n+  writeFileSync(MANIFEST_PATH, JSON.stringify(manifest, null, 2));\n+};\n+\n+const answerMap = {\n+  yes: true,\n+  y: true,\n+  no: false,\n+  n: false,\n+};\n+\n const rl = createInterface({\n   input: process.stdin,\n   output: process.stdout,\n });\n \n-console.log('Current version', chalk.yellow(manifest.version));\n-console.log('Current version name', chalk.yellow(manifest.version_name));\n-\n rl.question(chalk.yellowBright('Set the current version: '), (nextVersion) => {\n-  rl.close();\n   if (!semver.valid(nextVersion)) {\n     console.error(chalk.red('Invalid version'));\n-    process.exit(1);\n   }\n-  if (semver.lte(nextVersion, manifest.version)) {\n-    console.error(chalk.red('Next version cant be smaller than the previous one'));\n-    process.exit(1);\n+  if (semver.gt(nextVersion, manifest.version)) {\n+    rl.close();\n+    setVersion(nextVersion);\n+    return;\n   }\n-\n-  manifest.version = nextVersion;\n-  manifest.version_name = nextVersion;\n-\n-  writeFileSync(MANIFEST_PATH, JSON.stringify(manifest, null, 2));\n+  console.error(chalk.yellow('Next version cannot be smaller or equal to the previous one'));\n+  rl.question('Are you sure you want to continue? (y/n) ', (answer) => {\n+    rl.close();\n+    answer = answer.toLowerCase();\n+    if (!answerMap[answer]) {\n+      throw new Error('Exiting');\n+    }\n+    setVersion(nextVersion);\n+  });\n });"
        },
        {
            "sha": "8cda59f7a9337da90abd5e163895228e747364ea",
            "filename": "projects/shell-chrome/src/manifest.json",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/89e495dfff624e71c69e431aafc649829042a6bb/projects%2Fshell-chrome%2Fsrc%2Fmanifest.json",
            "raw_url": "https://github.com/angular/angular/raw/89e495dfff624e71c69e431aafc649829042a6bb/projects%2Fshell-chrome%2Fsrc%2Fmanifest.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fshell-chrome%2Fsrc%2Fmanifest.json?ref=89e495dfff624e71c69e431aafc649829042a6bb",
            "patch": "@@ -1,10 +1,10 @@\n {\n   \"manifest_version\": 2,\n-  \"short_name\": \"Angular DevTools Alpha\",\n-  \"name\": \"Angular Developer Tools Alpha\",\n+  \"short_name\": \"Angular DevTools\",\n+  \"name\": \"Angular Developer Tools\",\n   \"description\": \"Extends the Developer Tools, adding tools for debugging and profiling Angular applications.\",\n-  \"version\": \"1.0.12\",\n-  \"version_name\": \"1.0.12\",\n+  \"version\": \"1.0.0\",\n+  \"version_name\": \"1.0.0\",\n   \"minimum_chrome_version\": \"50\",\n   \"content_security_policy\": \"script-src 'self' 'unsafe-eval'; object-src 'self'\",\n   \"icons\": {"
        }
    ],
    "stats": {
        "total": 53,
        "additions": 35,
        "deletions": 18
    }
}