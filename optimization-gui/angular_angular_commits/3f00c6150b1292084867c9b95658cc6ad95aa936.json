{
    "author": "ayazhafiz",
    "message": "test(compiler): Demonstrate recoverable parsing of unterminated pipes (#39113)\n\nThere is no actionable change in this commit other than to pretty-print\nEOF tokens. Actual parsing of unterminated pipes is already supported,\nthis just adds a test for it.\n\nPart of #38596\n\nPR Close #39113",
    "sha": "3f00c6150b1292084867c9b95658cc6ad95aa936",
    "files": [
        {
            "sha": "577b3ea249ed8f0d73d3a714a7d2af541dbd778c",
            "filename": "packages/compiler/src/expression_parser/parser.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/3f00c6150b1292084867c9b95658cc6ad95aa936/packages%2Fcompiler%2Fsrc%2Fexpression_parser%2Fparser.ts",
            "raw_url": "https://github.com/angular/angular/raw/3f00c6150b1292084867c9b95658cc6ad95aa936/packages%2Fcompiler%2Fsrc%2Fexpression_parser%2Fparser.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fexpression_parser%2Fparser.ts?ref=3f00c6150b1292084867c9b95658cc6ad95aa936",
            "patch": "@@ -491,10 +491,14 @@ export class _ParseAST {\n     this.error(`Missing expected operator ${operator}`);\n   }\n \n+  prettyPrintToken(tok: Token): string {\n+    return tok === EOF ? 'end of input' : `token ${tok}`;\n+  }\n+\n   expectIdentifierOrKeyword(): string {\n     const n = this.next;\n     if (!n.isIdentifier() && !n.isKeyword()) {\n-      this.error(`Unexpected token ${n}, expected identifier or keyword`);\n+      this.error(`Unexpected ${this.prettyPrintToken(n)}, expected identifier or keyword`);\n       return '';\n     }\n     this.advance();\n@@ -504,7 +508,7 @@ export class _ParseAST {\n   expectIdentifierOrKeywordOrString(): string {\n     const n = this.next;\n     if (!n.isIdentifier() && !n.isKeyword() && !n.isString()) {\n-      this.error(`Unexpected token ${n}, expected identifier, keyword, or string`);\n+      this.error(`Unexpected ${this.prettyPrintToken(n)}, expected identifier, keyword, or string`);\n       return '';\n     }\n     this.advance();"
        },
        {
            "sha": "c091a25a1ac6072836a0f769e3d9a9a6546f9f57",
            "filename": "packages/compiler/test/expression_parser/parser_spec.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/3f00c6150b1292084867c9b95658cc6ad95aa936/packages%2Fcompiler%2Ftest%2Fexpression_parser%2Fparser_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/3f00c6150b1292084867c9b95658cc6ad95aa936/packages%2Fcompiler%2Ftest%2Fexpression_parser%2Fparser_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Ftest%2Fexpression_parser%2Fparser_spec.ts?ref=3f00c6150b1292084867c9b95658cc6ad95aa936",
            "patch": "@@ -393,6 +393,11 @@ describe('parser', () => {\n         checkBinding('a | b:(c | d)', '(a | b:(c | d))');\n       });\n \n+      it('should parse incomplete pipes', () => {\n+        checkBinding('a | b | ', '((a | b) | )');\n+        expectBindingError('a | b | ', 'Unexpected end of input, expected identifier or keyword');\n+      });\n+\n       it('should only allow identifier or keyword as formatter names', () => {\n         expectBindingError('\"Foo\"|(', 'identifier or keyword');\n         expectBindingError('\"Foo\"|1234', 'identifier or keyword');"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 11,
        "deletions": 2
    }
}