{
    "author": "petebacondarwin",
    "message": "test(ngcc): use `isNamedDeclaration()` helper to simplify tests (#38959)\n\nPreviously these tests were checking multiple specific expression\ntypes. The new helper function is more general and will also support\n`PropertyAccessExpression` nodes for `InlineDeclaration` types.\n\nPR Close #38959",
    "sha": "47eab61cadb63e53c0da360e5bb3850773f4e554",
    "files": [
        {
            "sha": "c3735c4184da3edcba7e94babc27c23d51c009b5",
            "filename": "packages/compiler-cli/ngcc/test/analysis/module_with_providers_analyzer_spec.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/47eab61cadb63e53c0da360e5bb3850773f4e554/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fanalysis%2Fmodule_with_providers_analyzer_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/47eab61cadb63e53c0da360e5bb3850773f4e554/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fanalysis%2Fmodule_with_providers_analyzer_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fanalysis%2Fmodule_with_providers_analyzer_spec.ts?ref=47eab61cadb63e53c0da360e5bb3850773f4e554",
            "patch": "@@ -10,8 +10,8 @@ import * as ts from 'typescript';\n import {absoluteFrom, AbsoluteFsPath, getSourceFileOrError} from '../../../src/ngtsc/file_system';\n import {runInEachFileSystem, TestFile} from '../../../src/ngtsc/file_system/testing';\n import {MockLogger} from '../../../src/ngtsc/logging/testing';\n-import {DeclarationNode, isNamedClassDeclaration, isNamedVariableDeclaration} from '../../../src/ngtsc/reflection';\n-import {getDeclaration} from '../../../src/ngtsc/testing';\n+import {DeclarationNode} from '../../../src/ngtsc/reflection';\n+import {getDeclaration, isNamedDeclaration} from '../../../src/ngtsc/testing';\n import {loadTestFiles} from '../../../test/helpers';\n import {ModuleWithProvidersAnalyses, ModuleWithProvidersAnalyzer} from '../../src/analysis/module_with_providers_analyzer';\n import {NgccReferencesRegistry} from '../../src/analysis/ngcc_references_registry';\n@@ -661,9 +661,7 @@ runInEachFileSystem(() => {\n       }\n \n       function getName(node: DeclarationNode|null): string {\n-        return node && (isNamedVariableDeclaration(node) || isNamedClassDeclaration(node)) ?\n-            `${node.name.text}.` :\n-            '';\n+        return node && isNamedDeclaration(node) ? `${node.name.text}.` : '';\n       }\n     });\n   });"
        },
        {
            "sha": "052bfc87736093497818604ae2bbff66dcb92b33",
            "filename": "packages/compiler-cli/src/ngtsc/testing/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/47eab61cadb63e53c0da360e5bb3850773f4e554/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/47eab61cadb63e53c0da360e5bb3850773f4e554/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Findex.ts?ref=47eab61cadb63e53c0da360e5bb3850773f4e554",
            "patch": "@@ -5,4 +5,4 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-export {expectCompleteReuse, getDeclaration, makeProgram} from './src/utils';\n+export {expectCompleteReuse, getDeclaration, isNamedDeclaration, makeProgram} from './src/utils';"
        },
        {
            "sha": "7fe09b668681121cd3cf831ca8c58f7b04293f57",
            "filename": "packages/compiler-cli/src/ngtsc/testing/src/utils.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/47eab61cadb63e53c0da360e5bb3850773f4e554/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Fsrc%2Futils.ts",
            "raw_url": "https://github.com/angular/angular/raw/47eab61cadb63e53c0da360e5bb3850773f4e554/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Fsrc%2Futils.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Fsrc%2Futils.ts?ref=47eab61cadb63e53c0da360e5bb3850773f4e554",
            "patch": "@@ -93,9 +93,7 @@ export function walkForDeclarations(name: string, rootNode: ts.Node): Declaratio\n           chosenDecls.push(...walkForDeclarations(name, node));\n         }\n       });\n-    } else if (\n-        ts.isClassDeclaration(node) || ts.isFunctionDeclaration(node) ||\n-        ts.isInterfaceDeclaration(node) || ts.isClassExpression(node)) {\n+    } else if (isNamedDeclaration(node)) {\n       if (node.name !== undefined && node.name.text === name) {\n         chosenDecls.push(node);\n       }\n@@ -111,6 +109,11 @@ export function walkForDeclarations(name: string, rootNode: ts.Node): Declaratio\n   return chosenDecls;\n }\n \n+export function isNamedDeclaration(node: ts.Node): node is ts.Declaration&{name: ts.Identifier} {\n+  const namedNode = node as {name?: ts.Identifier};\n+  return namedNode.name !== undefined && ts.isIdentifier(namedNode.name);\n+}\n+\n const COMPLETE_REUSE_FAILURE_MESSAGE =\n     'The original program was not reused completely, even though no changes should have been made to its structure';\n "
        }
    ],
    "stats": {
        "total": 19,
        "additions": 10,
        "deletions": 9
    }
}