{
    "author": "atscott",
    "message": "fix(language-service): bound attributes should not break directive matching (#41597)\n\nThe language service uses an elements attributes to determine if it\nmatches a directive in the component scope. We do this by accumulating\nall attribute bindings and matching against the selectors for the\navailable directives. The compiler itself does a similar thing. In\naddition, the compiler does not use the value of `BoundAttribute`s to\nmatch directives (https://github.com/angular/angular/blob/cdf1ea1951fb7187b1f6c9bb8a847c859c41e0b8/packages/compiler/src/render3/view/util.ts#L174-L206). This commit changes the language\nservice to also ignore bound attribute values for directive matching.\n\nFixes https://github.com/angular/vscode-ng-language-service/issues/1278\n\nPR Close #41597",
    "sha": "bd34bc9e89f18a4d3c4fc633bf5624bfbdc3d1a3",
    "files": [
        {
            "sha": "1160c80000e41f197938f655c6095abb18f7f5ae",
            "filename": "packages/language-service/ivy/test/quick_info_spec.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/bd34bc9e89f18a4d3c4fc633bf5624bfbdc3d1a3/packages%2Flanguage-service%2Fivy%2Ftest%2Fquick_info_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/bd34bc9e89f18a4d3c4fc633bf5624bfbdc3d1a3/packages%2Flanguage-service%2Fivy%2Ftest%2Fquick_info_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Fquick_info_spec.ts?ref=bd34bc9e89f18a4d3c4fc633bf5624bfbdc3d1a3",
            "patch": "@@ -151,6 +151,15 @@ describe('quick info', () => {\n         expect(toText(documentation)).toBe('This Component provides the `test-comp` selector.');\n       });\n \n+      it('should work for components with bound attributes', () => {\n+        const {documentation} = expectQuickInfo({\n+          templateOverride: `<t¦est-comp [attr.id]=\"'1' + '2'\" [attr.name]=\"'myName'\"></test-comp>`,\n+          expectedSpanText: `<test-comp [attr.id]=\"'1' + '2'\" [attr.name]=\"'myName'\"></test-comp>`,\n+          expectedDisplayString: '(component) AppModule.TestComponent'\n+        });\n+        expect(toText(documentation)).toBe('This Component provides the `test-comp` selector.');\n+      });\n+\n       it('should work for structural directives', () => {\n         const {documentation} = expectQuickInfo({\n           templateOverride: `<div *¦ngFor=\"let item of heroes\"></div>`,"
        },
        {
            "sha": "977d49be7802c29fd95860a812efee7100c2fdec",
            "filename": "packages/language-service/ivy/utils.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/bd34bc9e89f18a4d3c4fc633bf5624bfbdc3d1a3/packages%2Flanguage-service%2Fivy%2Futils.ts",
            "raw_url": "https://github.com/angular/angular/raw/bd34bc9e89f18a4d3c4fc633bf5624bfbdc3d1a3/packages%2Flanguage-service%2Fivy%2Futils.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Futils.ts?ref=bd34bc9e89f18a4d3c4fc633bf5624bfbdc3d1a3",
            "patch": "@@ -171,7 +171,7 @@ function getFirstComponentForTemplateFile(fileName: string, compiler: NgCompiler\n  * Given an attribute node, converts it to string form.\n  */\n function toAttributeString(attribute: t.TextAttribute|t.BoundAttribute|t.BoundEvent): string {\n-  if (attribute instanceof t.BoundEvent) {\n+  if (attribute instanceof t.BoundEvent || attribute instanceof t.BoundAttribute) {\n     return `[${attribute.name}]`;\n   } else {\n     return `[${attribute.name}=${attribute.valueSpan?.toString() ?? ''}]`;"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 10,
        "deletions": 1
    }
}