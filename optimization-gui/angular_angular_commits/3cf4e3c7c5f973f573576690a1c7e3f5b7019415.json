{
    "author": "AlexMokin",
    "message": "fix(router): always stringify matrix parameters (#25095)\n\nFix a case where matrix parameters weren't stringified when they are passed as a first command\nwhen creating a url tree. Fix return type in parseMatrixParams method\nbecause it always returns {[key: string]: string}\n\nCloses #23165\n\nPR Close #25095",
    "sha": "3cf4e3c7c5f973f573576690a1c7e3f5b7019415",
    "files": [
        {
            "sha": "f70887abc3437bbd0ff61eb5c3fd84dc66f40f64",
            "filename": "packages/router/src/create_url_tree.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/3cf4e3c7c5f973f573576690a1c7e3f5b7019415/packages%2Frouter%2Fsrc%2Fcreate_url_tree.ts",
            "raw_url": "https://github.com/angular/angular/raw/3cf4e3c7c5f973f573576690a1c7e3f5b7019415/packages%2Frouter%2Fsrc%2Fcreate_url_tree.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Fcreate_url_tree.ts?ref=3cf4e3c7c5f973f573576690a1c7e3f5b7019415",
            "patch": "@@ -296,7 +296,7 @@ function createNewSegmentGroup(\n     // if we start with an object literal, we need to reuse the path part from the segment\n     if (i === 0 && isMatrixParams(commands[0])) {\n       const p = segmentGroup.segments[startIndex];\n-      paths.push(new UrlSegment(p.path, commands[0]));\n+      paths.push(new UrlSegment(p.path, stringify(commands[0])));\n       i++;\n       continue;\n     }"
        },
        {
            "sha": "8d943ab841ceefbf18b54a712694cdaea1cc35ea",
            "filename": "packages/router/src/url_tree.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/3cf4e3c7c5f973f573576690a1c7e3f5b7019415/packages%2Frouter%2Fsrc%2Furl_tree.ts",
            "raw_url": "https://github.com/angular/angular/raw/3cf4e3c7c5f973f573576690a1c7e3f5b7019415/packages%2Frouter%2Fsrc%2Furl_tree.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Furl_tree.ts?ref=3cf4e3c7c5f973f573576690a1c7e3f5b7019415",
            "patch": "@@ -522,15 +522,15 @@ class UrlParser {\n     return new UrlSegment(decode(path), this.parseMatrixParams());\n   }\n \n-  private parseMatrixParams(): {[key: string]: any} {\n-    const params: {[key: string]: any} = {};\n+  private parseMatrixParams(): {[key: string]: string} {\n+    const params: {[key: string]: string} = {};\n     while (this.consumeOptional(';')) {\n       this.parseParam(params);\n     }\n     return params;\n   }\n \n-  private parseParam(params: {[key: string]: any}): void {\n+  private parseParam(params: {[key: string]: string}): void {\n     const key = matchSegments(this.remaining);\n     if (!key) {\n       return;"
        },
        {
            "sha": "2d6a0dd3ece5a25eb2ad097484ed3996be388979",
            "filename": "packages/router/test/create_url_tree.spec.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/3cf4e3c7c5f973f573576690a1c7e3f5b7019415/packages%2Frouter%2Ftest%2Fcreate_url_tree.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/3cf4e3c7c5f973f573576690a1c7e3f5b7019415/packages%2Frouter%2Ftest%2Fcreate_url_tree.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fcreate_url_tree.spec.ts?ref=3cf4e3c7c5f973f573576690a1c7e3f5b7019415",
            "patch": "@@ -267,6 +267,18 @@ describe('createUrlTree', () => {\n     expect(serializer.serialize(t)).toEqual('/a/b;aa=22;bb=33');\n   });\n \n+  it('should stringify matrix parameters', () => {\n+    const pr = serializer.parse('/r');\n+    const relative = create(pr.root.children[PRIMARY_OUTLET], 0, pr, [{pp: 22}]);\n+    const segmentR = relative.root.children[PRIMARY_OUTLET].segments[0];\n+    expect(segmentR.parameterMap.get('pp')).toEqual('22');\n+\n+    const pa = serializer.parse('/a');\n+    const absolute = createRoot(pa, ['/b', {pp: 33}]);\n+    const segmentA = absolute.root.children[PRIMARY_OUTLET].segments[0];\n+    expect(segmentA.parameterMap.get('pp')).toEqual('33');\n+  });\n+\n   describe('relative navigation', () => {\n     it('should work', () => {\n       const p = serializer.parse('/a/(c//left:cp)(left:ap)');"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 16,
        "deletions": 4
    }
}