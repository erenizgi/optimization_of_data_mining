{
    "author": "zarend",
    "message": "fix(compiler-cli): report non-template diagnostics (#40331)\n\nReport non-template diagnotics when calling `getDiagnotics` function of\nthe language service we only returned template diagnotics. This change\ncauses it to return all diagnotics, not just diagnostics from the\ntemplate type checker.\n\nPR Close #40331",
    "sha": "4db89f4576fe11ae66bb33eead821900dd685933",
    "files": [
        {
            "sha": "5e57f02cd6dc524a479c2f4fca58adeadcdb7148",
            "filename": "packages/compiler-cli/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2FBUILD.bazel?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -33,6 +33,7 @@ ts_library(\n         \"//packages/compiler-cli/src/ngtsc/shims\",\n         \"//packages/compiler-cli/src/ngtsc/translator\",\n         \"//packages/compiler-cli/src/ngtsc/typecheck\",\n+        \"//packages/compiler-cli/src/ngtsc/typecheck/api\",\n         \"@npm//@bazel/typescript\",\n         \"@npm//@types/node\",\n         \"@npm//chokidar\","
        },
        {
            "sha": "e32dd7d9e3062c86e4d8fc896ea0d90613be884a",
            "filename": "packages/compiler-cli/src/ngtsc/core/src/compiler.ts",
            "status": "modified",
            "additions": 47,
            "deletions": 31,
            "changes": 78,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Fsrc%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Fsrc%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Fsrc%2Fcompiler.ts?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -30,7 +30,6 @@ import {ivySwitchTransform} from '../../switch';\n import {aliasTransformFactory, CompilationMode, declarationTransformFactory, DecoratorHandler, DtsTransformRegistry, ivyTransformFactory, TraitCompiler} from '../../transform';\n import {TemplateTypeCheckerImpl} from '../../typecheck';\n import {OptimizeFor, TemplateTypeChecker, TypeCheckingConfig, TypeCheckingProgramStrategy} from '../../typecheck/api';\n-import {isTemplateDiagnostic} from '../../typecheck/diagnostics';\n import {getSourceFileOrNull, isDtsPath, resolveModuleName} from '../../util/src/typescript';\n import {LazyRoute, NgCompilerAdapter, NgCompilerOptions} from '../api';\n \n@@ -84,11 +83,12 @@ export class NgCompiler {\n   private constructionDiagnostics: ts.Diagnostic[] = [];\n \n   /**\n-   * Semantic diagnostics related to the program itself.\n+   * Non-template diagnostics related to the program itself. Does not include template\n+   * diagnostics because the template type checker memoizes them itself.\n    *\n-   * This is set by (and memoizes) `getDiagnostics`.\n+   * This is set by (and memoizes) `getNonTemplateDiagnostics`.\n    */\n-  private diagnostics: ts.Diagnostic[]|null = null;\n+  private nonTemplateDiagnostics: ts.Diagnostic[]|null = null;\n \n   private closureCompilerEnabled: boolean;\n   private nextProgram: ts.Program;\n@@ -175,38 +175,23 @@ export class NgCompiler {\n     return this.incrementalDriver.depGraph.getResourceDependencies(file);\n   }\n \n+  /**\n+   * Get all Angular-related diagnostics for this compilation.\n+   */\n+  getDiagnostics(): ts.Diagnostic[] {\n+    return [...this.getNonTemplateDiagnostics(), ...this.getTemplateDiagnostics()];\n+  }\n+\n   /**\n    * Get all Angular-related diagnostics for this compilation.\n    *\n    * If a `ts.SourceFile` is passed, only diagnostics related to that file are returned.\n    */\n-  getDiagnostics(file?: ts.SourceFile): ts.Diagnostic[] {\n-    if (this.diagnostics === null) {\n-      const compilation = this.ensureAnalyzed();\n-      this.diagnostics =\n-          [...compilation.traitCompiler.diagnostics, ...this.getTemplateDiagnostics()];\n-      if (this.entryPoint !== null && compilation.exportReferenceGraph !== null) {\n-        this.diagnostics.push(...checkForPrivateExports(\n-            this.entryPoint, this.tsProgram.getTypeChecker(), compilation.exportReferenceGraph));\n-      }\n-    }\n-\n-    if (file === undefined) {\n-      return this.diagnostics;\n-    } else {\n-      return this.diagnostics.filter(diag => {\n-        if (diag.file === file) {\n-          return true;\n-        } else if (isTemplateDiagnostic(diag) && diag.componentFile === file) {\n-          // Template diagnostics are reported when diagnostics for the component file are\n-          // requested (since no consumer of `getDiagnostics` would ever ask for diagnostics from\n-          // the fake ts.SourceFile for templates).\n-          return true;\n-        } else {\n-          return false;\n-        }\n-      });\n-    }\n+  getDiagnosticsForFile(file: ts.SourceFile, optimizeFor: OptimizeFor): ts.Diagnostic[] {\n+    return [\n+      ...this.getNonTemplateDiagnostics().filter(diag => diag.file === file),\n+      ...this.getTemplateDiagnosticsForFile(file, optimizeFor)\n+    ];\n   }\n \n   /**\n@@ -582,6 +567,37 @@ export class NgCompiler {\n     return diagnostics;\n   }\n \n+  private getTemplateDiagnosticsForFile(sf: ts.SourceFile, optimizeFor: OptimizeFor):\n+      ReadonlyArray<ts.Diagnostic> {\n+    const compilation = this.ensureAnalyzed();\n+\n+    // Get the diagnostics.\n+    const typeCheckSpan = this.perfRecorder.start('typeCheckDiagnostics');\n+    const diagnostics: ts.Diagnostic[] = [];\n+    if (!sf.isDeclarationFile && !this.adapter.isShim(sf)) {\n+      diagnostics.push(...compilation.templateTypeChecker.getDiagnosticsForFile(sf, optimizeFor));\n+    }\n+\n+    const program = this.typeCheckingProgramStrategy.getProgram();\n+    this.perfRecorder.stop(typeCheckSpan);\n+    this.incrementalStrategy.setIncrementalDriver(this.incrementalDriver, program);\n+    this.nextProgram = program;\n+\n+    return diagnostics;\n+  }\n+\n+  private getNonTemplateDiagnostics(): ts.Diagnostic[] {\n+    if (this.nonTemplateDiagnostics === null) {\n+      const compilation = this.ensureAnalyzed();\n+      this.nonTemplateDiagnostics = [...compilation.traitCompiler.diagnostics];\n+      if (this.entryPoint !== null && compilation.exportReferenceGraph !== null) {\n+        this.nonTemplateDiagnostics.push(...checkForPrivateExports(\n+            this.entryPoint, this.tsProgram.getTypeChecker(), compilation.exportReferenceGraph));\n+      }\n+    }\n+    return this.nonTemplateDiagnostics;\n+  }\n+\n   /**\n    * Reifies the inter-dependencies of NgModules and the components within their compilation scopes\n    * into the `IncrementalDriver`'s dependency graph."
        },
        {
            "sha": "92a81665dc265fc61971d9495b7d5cdd871465e4",
            "filename": "packages/compiler-cli/src/ngtsc/core/test/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Ftest%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Ftest%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Ftest%2FBUILD.bazel?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -17,6 +17,7 @@ ts_library(\n         \"//packages/compiler-cli/src/ngtsc/incremental\",\n         \"//packages/compiler-cli/src/ngtsc/reflection\",\n         \"//packages/compiler-cli/src/ngtsc/typecheck\",\n+        \"//packages/compiler-cli/src/ngtsc/typecheck/api\",\n         \"@npm//typescript\",\n     ],\n )"
        },
        {
            "sha": "6ba8d8c7ddfc120d6a194409cd728c4c71b79d49",
            "filename": "packages/compiler-cli/src/ngtsc/core/test/compiler_test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Ftest%2Fcompiler_test.ts",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Ftest%2Fcompiler_test.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fcore%2Ftest%2Fcompiler_test.ts?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -13,6 +13,7 @@ import {runInEachFileSystem} from '../../file_system/testing';\n import {NoopIncrementalBuildStrategy} from '../../incremental';\n import {ClassDeclaration, isNamedClassDeclaration} from '../../reflection';\n import {ReusedProgramStrategy} from '../../typecheck';\n+import {OptimizeFor} from '../../typecheck/api';\n \n import {NgCompilerOptions} from '../api';\n \n@@ -54,7 +55,8 @@ runInEachFileSystem(() => {\n           new NoopIncrementalBuildStrategy(), /** enableTemplateTypeChecker */ false,\n           /* usePoisonedData */ false);\n \n-      const diags = compiler.getDiagnostics(getSourceFileOrError(program, COMPONENT));\n+      const diags = compiler.getDiagnosticsForFile(\n+          getSourceFileOrError(program, COMPONENT), OptimizeFor.SingleFile);\n       expect(diags.length).toBe(1);\n       expect(diags[0].messageText).toContain('does_not_exist');\n     });"
        },
        {
            "sha": "da7c2493bf58577b8201ce02210f8b329de2b5ba",
            "filename": "packages/compiler-cli/src/ngtsc/program.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fprogram.ts",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fprogram.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fprogram.ts?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -20,6 +20,7 @@ import {NOOP_PERF_RECORDER, PerfRecorder, PerfTracker} from './perf';\n import {DeclarationNode} from './reflection';\n import {retagAllTsFiles, untagAllTsFiles} from './shims';\n import {ReusedProgramStrategy} from './typecheck';\n+import {OptimizeFor} from './typecheck/api';\n \n \n \n@@ -182,7 +183,9 @@ export class NgtscProgram implements api.Program {\n       }\n     }\n \n-    const diagnostics = this.compiler.getDiagnostics(sf);\n+    const diagnostics = sf === undefined ?\n+        this.compiler.getDiagnostics() :\n+        this.compiler.getDiagnosticsForFile(sf, OptimizeFor.WholeProgram);\n     this.reuseTsProgram = this.compiler.getNextProgram();\n     return diagnostics;\n   }"
        },
        {
            "sha": "b1deb803584fec0105cf23d2398a43ed20e5ec9e",
            "filename": "packages/compiler-cli/src/ngtsc/tsc_plugin.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftsc_plugin.ts",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftsc_plugin.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftsc_plugin.ts?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -14,6 +14,7 @@ import {NodeJSFileSystem, setFileSystem} from './file_system';\n import {PatchedProgramIncrementalBuildStrategy} from './incremental';\n import {NOOP_PERF_RECORDER} from './perf';\n import {untagAllTsFiles} from './shims';\n+import {OptimizeFor} from './typecheck/api';\n import {ReusedProgramStrategy} from './typecheck/src/augmented_program';\n \n // The following is needed to fix a the chicken-and-egg issue where the sync (into g3) script will\n@@ -111,7 +112,10 @@ export class NgTscPlugin implements TscPlugin {\n   }\n \n   getDiagnostics(file?: ts.SourceFile): ts.Diagnostic[] {\n-    return this.compiler.getDiagnostics(file);\n+    if (file === undefined) {\n+      return this.compiler.getDiagnostics();\n+    }\n+    return this.compiler.getDiagnosticsForFile(file, OptimizeFor.WholeProgram);\n   }\n \n   getOptionDiagnostics(): ts.Diagnostic[] {"
        },
        {
            "sha": "138a0acc92bc2a28af7f9ab4ac8a62bb4ece669d",
            "filename": "packages/language-service/ivy/language_service.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Flanguage-service%2Fivy%2Flanguage_service.ts",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Flanguage-service%2Fivy%2Flanguage_service.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Flanguage_service.ts?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -51,7 +51,7 @@ export class LanguageService {\n       const program = compiler.getNextProgram();\n       const sourceFile = program.getSourceFile(fileName);\n       if (sourceFile) {\n-        diagnostics.push(...ttc.getDiagnosticsForFile(sourceFile, OptimizeFor.SingleFile));\n+        diagnostics.push(...compiler.getDiagnosticsForFile(sourceFile, OptimizeFor.SingleFile));\n       }\n     } else {\n       const components = compiler.getComponentsWithTemplateFile(fileName);"
        },
        {
            "sha": "f0bcbc33129e6e360a12530e0323fbad41654f5d",
            "filename": "packages/language-service/ivy/test/compiler_spec.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 7,
            "changes": 23,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Flanguage-service%2Fivy%2Ftest%2Fcompiler_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Flanguage-service%2Fivy%2Ftest%2Fcompiler_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Fcompiler_spec.ts?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -8,6 +8,7 @@\n \n import {absoluteFrom, getSourceFileOrError} from '@angular/compiler-cli/src/ngtsc/file_system';\n import {initMockFileSystem} from '@angular/compiler-cli/src/ngtsc/file_system/testing';\n+import {OptimizeFor} from '@angular/compiler-cli/src/ngtsc/typecheck/api';\n \n import {LanguageServiceTestEnvironment} from './env';\n \n@@ -68,9 +69,15 @@ describe('language-service/compiler integration', () => {\n     // Expect that this program is clean diagnostically.\n     const ngCompiler = env.ngLS.compilerFactory.getOrCreate();\n     const program = ngCompiler.getNextProgram();\n-    expect(ngCompiler.getDiagnostics(getSourceFileOrError(program, appCmpFile))).toEqual([]);\n-    expect(ngCompiler.getDiagnostics(getSourceFileOrError(program, appModuleFile))).toEqual([]);\n-    expect(ngCompiler.getDiagnostics(getSourceFileOrError(program, testFile))).toEqual([]);\n+    expect(ngCompiler.getDiagnosticsForFile(\n+               getSourceFileOrError(program, appCmpFile), OptimizeFor.WholeProgram))\n+        .toEqual([]);\n+    expect(ngCompiler.getDiagnosticsForFile(\n+               getSourceFileOrError(program, appModuleFile), OptimizeFor.WholeProgram))\n+        .toEqual([]);\n+    expect(ngCompiler.getDiagnosticsForFile(\n+               getSourceFileOrError(program, testFile), OptimizeFor.WholeProgram))\n+        .toEqual([]);\n   });\n \n   it('should show type-checking errors from components with poisoned scopes', () => {\n@@ -153,9 +160,9 @@ describe('language-service/compiler integration', () => {\n         name: moduleFile,\n         contents: `\n           import {NgModule} from '@angular/core';\n-    \n+\n           import {Cmp} from './cmp';\n-    \n+\n           @NgModule({\n             declarations: [Cmp],\n           })\n@@ -173,7 +180,8 @@ describe('language-service/compiler integration', () => {\n     // Angular should be complaining about the module not being understandable.\n     const programBefore = env.tsLS.getProgram()!;\n     const moduleSfBefore = programBefore.getSourceFile(moduleFile)!;\n-    const ngDiagsBefore = env.ngLS.compilerFactory.getOrCreate().getDiagnostics(moduleSfBefore);\n+    const ngDiagsBefore = env.ngLS.compilerFactory.getOrCreate().getDiagnosticsForFile(\n+        moduleSfBefore, OptimizeFor.SingleFile);\n     expect(ngDiagsBefore.length).toBe(1);\n \n     // Fix the import.\n@@ -182,7 +190,8 @@ describe('language-service/compiler integration', () => {\n     // Angular should stop complaining about the NgModule.\n     const programAfter = env.tsLS.getProgram()!;\n     const moduleSfAfter = programAfter.getSourceFile(moduleFile)!;\n-    const ngDiagsAfter = env.ngLS.compilerFactory.getOrCreate().getDiagnostics(moduleSfAfter);\n+    const ngDiagsAfter = env.ngLS.compilerFactory.getOrCreate().getDiagnosticsForFile(\n+        moduleSfAfter, OptimizeFor.SingleFile);\n     expect(ngDiagsAfter.length).toBe(0);\n   });\n });"
        },
        {
            "sha": "ea37503a09dac70b278df1954bcca489e5960007",
            "filename": "packages/language-service/ivy/test/diagnostic_spec.ts",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Flanguage-service%2Fivy%2Ftest%2Fdiagnostic_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Flanguage-service%2Fivy%2Ftest%2Fdiagnostic_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Fdiagnostic_spec.ts?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -174,4 +174,22 @@ describe('getSemanticDiagnostics', () => {\n       'Parser Error: Bindings cannot contain assignments at column 8 in [{{nope = true}}] in /app2.html@0:0'\n     ]);\n   });\n+\n+  it('reports a diagnostic for a component without a template', () => {\n+    const appFile = {\n+      name: absoluteFrom('/app.ts'),\n+      contents: `\n+      import {Component} from '@angular/core';\n+      @Component({})\n+      export class MyComponent {}\n+    `\n+    };\n+\n+    const env = createModuleWithDeclarations([appFile]);\n+    const diags = env.ngLS.getSemanticDiagnostics(absoluteFrom('/app.ts'));\n+\n+    expect(diags.map(x => x.messageText)).toEqual([\n+      'component is missing a template',\n+    ]);\n+  });\n });"
        },
        {
            "sha": "f73e4fdfa7856d812ca1bb003f7ce0e0fe71c944",
            "filename": "packages/language-service/ivy/test/env.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Flanguage-service%2Fivy%2Ftest%2Fenv.ts",
            "raw_url": "https://github.com/angular/angular/raw/4db89f4576fe11ae66bb33eead821900dd685933/packages%2Flanguage-service%2Fivy%2Ftest%2Fenv.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fivy%2Ftest%2Fenv.ts?ref=4db89f4576fe11ae66bb33eead821900dd685933",
            "patch": "@@ -11,7 +11,7 @@ import {StrictTemplateOptions} from '@angular/compiler-cli/src/ngtsc/core/api';\n import {absoluteFrom, AbsoluteFsPath, FileSystem, getFileSystem, getSourceFileOrError} from '@angular/compiler-cli/src/ngtsc/file_system';\n import {MockFileSystem, TestFile} from '@angular/compiler-cli/src/ngtsc/file_system/testing';\n import {loadStandardTestFiles} from '@angular/compiler-cli/src/ngtsc/testing';\n-import {TemplateTypeChecker} from '@angular/compiler-cli/src/ngtsc/typecheck/api';\n+import {OptimizeFor, TemplateTypeChecker} from '@angular/compiler-cli/src/ngtsc/typecheck/api';\n import * as ts from 'typescript/lib/tsserverlibrary';\n \n import {LanguageService} from '../language_service';\n@@ -172,7 +172,9 @@ export class LanguageServiceTestEnvironment {\n         continue;\n       }\n \n-      const ngDiagnostics = ngCompiler.getDiagnostics(sf);\n+      // It's more efficient to optimize for WholeProgram since we call this with every file in the\n+      // program.\n+      const ngDiagnostics = ngCompiler.getDiagnosticsForFile(sf, OptimizeFor.WholeProgram);\n       expect(ngDiagnostics.map(diag => diag.messageText)).toEqual([]);\n     }\n "
        }
    ],
    "stats": {
        "total": 144,
        "additions": 100,
        "deletions": 44
    }
}