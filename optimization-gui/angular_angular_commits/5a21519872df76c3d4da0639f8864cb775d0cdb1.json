{
    "author": "gkalpak",
    "message": "refactor(docs-infra): create `logSectionHeader()` helper in `deploy-to-firebase` script (#43963)\n\nCreate a `logSectionHeader()` helper function to avoid duplicating code.\n\nPR Close #43963",
    "sha": "5a21519872df76c3d4da0639f8864cb775d0cdb1",
    "files": [
        {
            "sha": "b1c84f79eb3b20e8f54a76bb37e7819bd58085e7",
            "filename": "aio/scripts/deploy-to-firebase/index.mjs",
            "status": "modified",
            "additions": 15,
            "deletions": 8,
            "changes": 23,
            "blob_url": "https://github.com/angular/angular/blob/5a21519872df76c3d4da0639f8864cb775d0cdb1/aio%2Fscripts%2Fdeploy-to-firebase%2Findex.mjs",
            "raw_url": "https://github.com/angular/angular/raw/5a21519872df76c3d4da0639f8864cb775d0cdb1/aio%2Fscripts%2Fdeploy-to-firebase%2Findex.mjs",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fscripts%2Fdeploy-to-firebase%2Findex.mjs?ref=5a21519872df76c3d4da0639f8864cb775d0cdb1",
            "patch": "@@ -69,18 +69,18 @@ if (fileURLToPath(import.meta.url) === process.argv[1]) {\n \n // Helpers\n function build({deployedUrl, deployEnv}) {\n-  console.log('\\n\\n\\n==== Build the AIO app. ====\\n');\n+  logSectionHeader('Build the AIO app.');\n   yarn(`build --configuration=${deployEnv} --progress=false`);\n \n-  console.log('\\n\\n\\n==== Add any mode-specific files into the AIO distribution. ====\\n');\n+  logSectionHeader('Add any mode-specific files into the AIO distribution.');\n   sh.cp('-rf', `src/extra-files/${deployEnv}/.`, 'dist/');\n \n-  console.log('\\n\\n\\n==== Update opensearch descriptor for AIO with `deployedUrl`. ====\\n');\n+  logSectionHeader('Update opensearch descriptor for AIO with `deployedUrl`.');\n   yarn(`set-opensearch-url ${deployedUrl.replace(/[^/]$/, '$&/')}`);  // The URL must end with `/`.\n }\n \n function checkPayloadSize() {\n-  console.log('\\n\\n\\n==== Check payload size and upload the numbers to Firebase DB. ====\\n');\n+  logSectionHeader('Check payload size and upload the numbers to Firebase DB.');\n   yarn('payload-size');\n }\n \n@@ -278,17 +278,17 @@ function deploy(data) {\n \n   sh.cd(`${getDirname(import.meta.url)}/../..`);\n \n-  console.log('\\n\\n\\n==== Run pre-deploy actions. ====\\n');\n+  logSectionHeader('Run pre-deploy actions.');\n   preDeployActions.forEach(fn => fn(data));\n \n-  console.log('\\n\\n\\n==== Deploy AIO to Firebase hosting. ====\\n');\n+  logSectionHeader('Deploy AIO to Firebase hosting.');\n   const firebase = cmd => yarn(`firebase ${cmd} --token \"${firebaseToken}\"`);\n   firebase(`use \"${projectId}\"`);\n   firebase('target:clear hosting aio');\n   firebase(`target:apply hosting aio \"${siteId}\"`);\n   firebase(`deploy --only hosting:aio --message \"Commit: ${currentCommit}\" --non-interactive`);\n \n-  console.log('\\n\\n\\n==== Run post-deploy actions. ====\\n');\n+  logSectionHeader('Run post-deploy actions.');\n   postDeployActions.forEach(fn => fn(data));\n }\n \n@@ -341,6 +341,10 @@ function listDeployTargetNames(deploymentsList) {\n   return deploymentsList.map(({name = '<no name>'}) => name).join(', ') || '-';\n }\n \n+function logSectionHeader(message) {\n+  console.log(`\\n\\n\\n==== ${message} ====\\n`);\n+}\n+\n function redirectToAngularIo() {\n   // Update the Firebase hosting configuration redirect all non-file requests (i.e. requests that do\n   // not contain a dot in their last path segment) to `angular.io`.\n@@ -365,6 +369,9 @@ function skipDeployment(reason) {\n }\n \n function testNoActiveRcDeployment({deployedUrl}) {\n+  logSectionHeader(\n+      'Verify deployed RC version redirects to stable (and disables old ServiceWorker).');\n+\n   const deployedOrigin = deployedUrl.replace(/\\/$/, '');\n \n   // Ensure a request for `ngsw.json` returns 404.\n@@ -403,7 +410,7 @@ function testNoActiveRcDeployment({deployedUrl}) {\n }\n \n function testPwaScore({deployedUrl, minPwaScore}) {\n-  console.log('\\n\\n\\n==== Run PWA-score tests. ====\\n');\n+  logSectionHeader('Run PWA-score tests.');\n   yarn(`test-pwa-score \"${deployedUrl}\" \"${minPwaScore}\"`);\n }\n "
        }
    ],
    "stats": {
        "total": 23,
        "additions": 15,
        "deletions": 8
    }
}