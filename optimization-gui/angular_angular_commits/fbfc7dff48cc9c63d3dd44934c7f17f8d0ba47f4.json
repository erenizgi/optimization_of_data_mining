{
    "author": "JiaLiPassion",
    "message": "build: update to use npm_package.pack rule (#39636)\n\nRemove the work around solution for the `npm pack`, we can now\nuse `npm_package.pack` rule of bazel, since the windows os issue\nhas been fixed here https://github.com/bazelbuild/rules_nodejs/commit/bc36519\n\nPR Close #39636",
    "sha": "fbfc7dff48cc9c63d3dd44934c7f17f8d0ba47f4",
    "files": [
        {
            "sha": "41108f7088b6f642c75492507e2075fa6dce754d",
            "filename": "scripts/build/zone-js-builder.js",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/fbfc7dff48cc9c63d3dd44934c7f17f8d0ba47f4/scripts%2Fbuild%2Fzone-js-builder.js",
            "raw_url": "https://github.com/angular/angular/raw/fbfc7dff48cc9c63d3dd44934c7f17f8d0ba47f4/scripts%2Fbuild%2Fzone-js-builder.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/scripts%2Fbuild%2Fzone-js-builder.js?ref=fbfc7dff48cc9c63d3dd44934c7f17f8d0ba47f4",
            "patch": "@@ -35,7 +35,7 @@ function buildZoneJsPackage(destPath) {\n   console.info(`${scriptPath}:`);\n   console.info('  Building zone.js npm package');\n   console.info('##############################');\n-  exec(`${bazelCmd} build //packages/zone.js:npm_package`);\n+  exec(`${bazelCmd} run //packages/zone.js:npm_package.pack`);\n \n   // Create the output directory.\n   const absDestPath = resolve(baseDir, destPath);\n@@ -46,10 +46,6 @@ function buildZoneJsPackage(destPath) {\n   const buildOutputDir = `${bazelBin}/packages/zone.js/npm_package`;\n   const distTargetDir = `${absDestPath}/zone.js`;\n \n-  // Also create an archive so we can test the package itself.\n-  // Currently, the `npm_package.pack` rule does not work on Windows, so run `npm pack` directly.\n-  exec(`npm pack ${buildOutputDir}`, false, {cwd: baseDir});\n-\n   console.info(`# Copy npm_package artifacts to ${distTargetDir}`);\n   rm('-rf', distTargetDir);\n   cp('-R', buildOutputDir, distTargetDir);"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 1,
        "deletions": 5
    }
}