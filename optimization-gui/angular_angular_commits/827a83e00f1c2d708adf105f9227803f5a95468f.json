{
    "author": "devversion",
    "message": "refactor(bazel): update api-extractor bazel tool to only accept a single input (#43431)\n\nUpdates the API extractor tool used by the `ng_module` rule to only\naccept a single entry-point file. This change is made in preparation\nfor APF v13 where this logic is no longer needed.\n\nThe logic previously only existed to also bundle the `r3_symbols` file.\nThis file is no longer needed in APF v13 because Angular core no longer needs\nto be processed with `ngcc`. This allows us to clean up this logic which\nhelps simplifying `ng_module`.\n\nConsumers that use an older version of `@angular/core` should\nrespectively also use a compiler-cli version matching the core\nversion.\n\nPR Close #43431",
    "sha": "827a83e00f1c2d708adf105f9227803f5a95468f",
    "files": [
        {
            "sha": "ab3b0c945545fd1cc4632592c72389dd7877957d",
            "filename": "packages/bazel/src/api-extractor/index.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 21,
            "changes": 28,
            "blob_url": "https://github.com/angular/angular/blob/827a83e00f1c2d708adf105f9227803f5a95468f/packages%2Fbazel%2Fsrc%2Fapi-extractor%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/827a83e00f1c2d708adf105f9227803f5a95468f/packages%2Fbazel%2Fsrc%2Fapi-extractor%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fbazel%2Fsrc%2Fapi-extractor%2Findex.ts?ref=827a83e00f1c2d708adf105f9227803f5a95468f",
            "patch": "@@ -17,7 +17,7 @@ import * as path from 'path';\n const DEBUG = false;\n \n export function runMain(\n-    tsConfig: string, entryPoint: string, dtsBundleOut?: string, apiReviewFolder?: string,\n+    tsConfig: string, entryPointExecPath: string, dtsBundleOut: string, apiReviewFolder?: string,\n     acceptApiUpdates = false): 1|0 {\n   const [parsedConfig, errors] = parseTsconfig(tsConfig);\n   if (errors && errors.length) {\n@@ -26,7 +26,7 @@ export function runMain(\n     return 1;\n   }\n \n-  const pkgJson = path.resolve(path.dirname(entryPoint), 'package.json');\n+  const pkgJson = path.resolve(path.dirname(entryPointExecPath), 'package.json');\n   if (!fs.existsSync(pkgJson)) {\n     fs.writeFileSync(pkgJson, JSON.stringify({\n       'name': 'GENERATED-BY-BAZEL',\n@@ -64,7 +64,7 @@ export function runMain(\n       overrideTsconfig: parsedTsConfig,\n     },\n     projectFolder: path.resolve(path.dirname(tsConfig)),\n-    mainEntryPointFilePath: path.resolve(entryPoint),\n+    mainEntryPointFilePath: path.resolve(entryPointExecPath),\n     apiReport: {\n       enabled: !!apiReviewFolder,\n       // TODO(alan-agius4): remove this folder name when the below issue is solved upstream\n@@ -75,8 +75,8 @@ export function runMain(\n       enabled: false,\n     },\n     dtsRollup: {\n-      enabled: !!dtsBundleOut,\n-      untrimmedFilePath: dtsBundleOut && path.resolve(dtsBundleOut),\n+      enabled: true,\n+      untrimmedFilePath: path.resolve(dtsBundleOut),\n     },\n     tsdocMetadata: {\n       enabled: false,\n@@ -108,20 +108,6 @@ api-extractor: running with\n   `);\n   }\n \n-  const [tsConfig, entryPoint, dtsBundleOut] = process.argv.slice(2);\n-  const entryPoints = entryPoint.split(',');\n-  const dtsBundleOuts = dtsBundleOut.split(',');\n-\n-  if (entryPoints.length !== entryPoints.length) {\n-    throw new Error(`Entry points count (${entryPoints.length}) does not match Bundle out count (${\n-        dtsBundleOuts.length})`);\n-  }\n-\n-  for (let i = 0; i < entryPoints.length; i++) {\n-    process.exitCode = runMain(tsConfig, entryPoints[i], dtsBundleOuts[i]);\n-\n-    if (process.exitCode !== 0) {\n-      break;\n-    }\n-  }\n+  const [tsConfig, entryPointExecPath, outputExecPath] = process.argv.slice(2);\n+  process.exitCode = runMain(tsConfig, entryPointExecPath, outputExecPath);\n }"
        }
    ],
    "stats": {
        "total": 28,
        "additions": 7,
        "deletions": 21
    }
}