{
    "author": "clydin",
    "message": "refactor(migrations): remove most template AST deep imports (#43627)\n\nMost of the deep imports into the `@angular/compiler` package in the `@angular/core` migrations are for template AST types that are available as exports from the main entry point of the package (albeit under slightly different names). For the available main entry point exports, the deep imports have been transitioned to no longer use the deep import.\n\nPR Close #43627",
    "sha": "db5392f383ea9a46de54cd1feaa44a8450fb2138",
    "files": [
        {
            "sha": "7263895f66ca9a0dac4a82955273d4c18f8a5ca4",
            "filename": "packages/core/schematics/migrations/router-link-empty-expression/analyze_template.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Fmigrations%2Frouter-link-empty-expression%2Fanalyze_template.ts",
            "raw_url": "https://github.com/angular/angular/raw/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Fmigrations%2Frouter-link-empty-expression%2Fanalyze_template.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Frouter-link-empty-expression%2Fanalyze_template.ts?ref=db5392f383ea9a46de54cd1feaa44a8450fb2138",
            "patch": "@@ -6,14 +6,15 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {BoundAttribute, visitAll} from '@angular/compiler/src/render3/r3_ast';\n+import {TmplAstBoundAttribute} from '@angular/compiler';\n+import {visitAll} from '@angular/compiler/src/render3/r3_ast';\n \n import {ResolvedTemplate} from '../../utils/ng_component_template';\n import {parseHtmlGracefully} from '../../utils/parse_html';\n \n import {RouterLinkEmptyExprVisitor} from './angular/html_routerlink_empty_expr_visitor';\n \n-export function analyzeResolvedTemplate(template: ResolvedTemplate): BoundAttribute[]|null {\n+export function analyzeResolvedTemplate(template: ResolvedTemplate): TmplAstBoundAttribute[]|null {\n   const templateNodes = parseHtmlGracefully(template.content, template.filePath);\n \n   if (!templateNodes) {"
        },
        {
            "sha": "c0d8daa85ffad295cf9d9219bd04bd588e779406",
            "filename": "packages/core/schematics/migrations/router-link-empty-expression/angular/html_routerlink_empty_expr_visitor.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Fmigrations%2Frouter-link-empty-expression%2Fangular%2Fhtml_routerlink_empty_expr_visitor.ts",
            "raw_url": "https://github.com/angular/angular/raw/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Fmigrations%2Frouter-link-empty-expression%2Fangular%2Fhtml_routerlink_empty_expr_visitor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Frouter-link-empty-expression%2Fangular%2Fhtml_routerlink_empty_expr_visitor.ts?ref=db5392f383ea9a46de54cd1feaa44a8450fb2138",
            "patch": "@@ -6,27 +6,27 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {ASTWithSource, EmptyExpr} from '@angular/compiler';\n-import {BoundAttribute, Element, NullVisitor, Template, visitAll} from '@angular/compiler/src/render3/r3_ast';\n+import {ASTWithSource, EmptyExpr, TmplAstBoundAttribute, TmplAstElement, TmplAstTemplate} from '@angular/compiler';\n+import {NullVisitor, visitAll} from '@angular/compiler/src/render3/r3_ast';\n \n /**\n  * HTML AST visitor that traverses the Render3 HTML AST in order to find all\n  * undefined routerLink asssignment ([routerLink]=\"\").\n  */\n export class RouterLinkEmptyExprVisitor extends NullVisitor {\n-  readonly emptyRouterLinkExpressions: BoundAttribute[] = [];\n+  readonly emptyRouterLinkExpressions: TmplAstBoundAttribute[] = [];\n \n-  override visitElement(element: Element): void {\n+  override visitElement(element: TmplAstElement): void {\n     visitAll(this, element.inputs);\n     visitAll(this, element.children);\n   }\n \n-  override visitTemplate(t: Template): void {\n+  override visitTemplate(t: TmplAstTemplate): void {\n     visitAll(this, t.inputs);\n     visitAll(this, t.children);\n   }\n \n-  override visitBoundAttribute(node: BoundAttribute) {\n+  override visitBoundAttribute(node: TmplAstBoundAttribute) {\n     if (node.name === 'routerLink' && node.value instanceof ASTWithSource &&\n         node.value.ast instanceof EmptyExpr) {\n       this.emptyRouterLinkExpressions.push(node);"
        },
        {
            "sha": "9102a5b07fba01c8609598d374d02822a59329fb",
            "filename": "packages/core/schematics/migrations/static-queries/strategies/usage_strategy/template_usage_visitor.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Fmigrations%2Fstatic-queries%2Fstrategies%2Fusage_strategy%2Ftemplate_usage_visitor.ts",
            "raw_url": "https://github.com/angular/angular/raw/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Fmigrations%2Fstatic-queries%2Fstrategies%2Fusage_strategy%2Ftemplate_usage_visitor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Fstatic-queries%2Fstrategies%2Fusage_strategy%2Ftemplate_usage_visitor.ts?ref=db5392f383ea9a46de54cd1feaa44a8450fb2138",
            "patch": "@@ -6,8 +6,8 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {ImplicitReceiver, ParseSourceSpan, PropertyRead, RecursiveAstVisitor} from '@angular/compiler';\n-import {BoundAttribute, BoundEvent, BoundText, Element, Node, NullVisitor, Template, visitAll} from '@angular/compiler/src/render3/r3_ast';\n+import {ImplicitReceiver, ParseSourceSpan, PropertyRead, RecursiveAstVisitor, TmplAstBoundAttribute, TmplAstBoundEvent, TmplAstBoundText, TmplAstElement, TmplAstNode, TmplAstTemplate} from '@angular/compiler';\n+import {NullVisitor, visitAll} from '@angular/compiler/src/render3/r3_ast';\n \n /**\n  * AST visitor that traverses the Render3 HTML AST in order to check if the given\n@@ -22,7 +22,7 @@ export class TemplateUsageVisitor extends NullVisitor {\n   }\n \n   /** Checks whether the given query is statically accessed within the specified HTML nodes. */\n-  isQueryUsedStatically(htmlNodes: Node[]): boolean {\n+  isQueryUsedStatically(htmlNodes: TmplAstNode[]): boolean {\n     this.hasQueryTemplateReference = false;\n     this.expressionAstVisitor.hasQueryPropertyRead = false;\n \n@@ -32,7 +32,7 @@ export class TemplateUsageVisitor extends NullVisitor {\n     return !this.hasQueryTemplateReference && this.expressionAstVisitor.hasQueryPropertyRead;\n   }\n \n-  override visitElement(element: Element): void {\n+  override visitElement(element: TmplAstElement): void {\n     // In case there is a template references variable that matches the query property\n     // name, we can finish this visitor as such a template variable can be used in the\n     // entire template and the query therefore can't be accessed from the template.\n@@ -47,7 +47,7 @@ export class TemplateUsageVisitor extends NullVisitor {\n     visitAll(this, element.children);\n   }\n \n-  override visitTemplate(template: Template): void {\n+  override visitTemplate(template: TmplAstTemplate): void {\n     visitAll(this, template.attributes);\n     visitAll(this, template.inputs);\n     visitAll(this, template.outputs);\n@@ -57,15 +57,15 @@ export class TemplateUsageVisitor extends NullVisitor {\n     // lifecycle hook at the earliest.\n   }\n \n-  override visitBoundAttribute(attribute: BoundAttribute) {\n+  override visitBoundAttribute(attribute: TmplAstBoundAttribute) {\n     attribute.value.visit(this.expressionAstVisitor, attribute.sourceSpan);\n   }\n \n-  override visitBoundText(text: BoundText) {\n+  override visitBoundText(text: TmplAstBoundText) {\n     text.value.visit(this.expressionAstVisitor, text.sourceSpan);\n   }\n \n-  override visitBoundEvent(node: BoundEvent) {\n+  override visitBoundEvent(node: TmplAstBoundEvent) {\n     node.handler.visit(this.expressionAstVisitor, node.handlerSpan);\n   }\n }"
        },
        {
            "sha": "57e2164def81d8e288731d286eb7ca6f34db1abc",
            "filename": "packages/core/schematics/migrations/template-var-assignment/angular/html_variable_assignment_visitor.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Fmigrations%2Ftemplate-var-assignment%2Fangular%2Fhtml_variable_assignment_visitor.ts",
            "raw_url": "https://github.com/angular/angular/raw/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Fmigrations%2Ftemplate-var-assignment%2Fangular%2Fhtml_variable_assignment_visitor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Fmigrations%2Ftemplate-var-assignment%2Fangular%2Fhtml_variable_assignment_visitor.ts?ref=db5392f383ea9a46de54cd1feaa44a8450fb2138",
            "patch": "@@ -6,8 +6,8 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {ImplicitReceiver, ParseSourceSpan, PropertyWrite, RecursiveAstVisitor} from '@angular/compiler';\n-import {BoundEvent, Element, NullVisitor, Template, Variable, visitAll} from '@angular/compiler/src/render3/r3_ast';\n+import {ImplicitReceiver, ParseSourceSpan, PropertyWrite, RecursiveAstVisitor, TmplAstBoundEvent, TmplAstElement, TmplAstTemplate, TmplAstVariable} from '@angular/compiler';\n+import {NullVisitor, visitAll} from '@angular/compiler/src/render3/r3_ast';\n \n export interface TemplateVariableAssignment {\n   start: number;\n@@ -22,16 +22,16 @@ export interface TemplateVariableAssignment {\n export class HtmlVariableAssignmentVisitor extends NullVisitor {\n   variableAssignments: TemplateVariableAssignment[] = [];\n \n-  private currentVariables: Variable[] = [];\n+  private currentVariables: TmplAstVariable[] = [];\n   private expressionAstVisitor =\n       new ExpressionAstVisitor(this.variableAssignments, this.currentVariables);\n \n-  override visitElement(element: Element): void {\n+  override visitElement(element: TmplAstElement): void {\n     visitAll(this, element.outputs);\n     visitAll(this, element.children);\n   }\n \n-  override visitTemplate(template: Template): void {\n+  override visitTemplate(template: TmplAstTemplate): void {\n     // Keep track of the template variables which can be accessed by the template\n     // child nodes through the implicit receiver.\n     this.currentVariables.push(...template.variables);\n@@ -52,7 +52,7 @@ export class HtmlVariableAssignmentVisitor extends NullVisitor {\n     });\n   }\n \n-  override visitBoundEvent(node: BoundEvent) {\n+  override visitBoundEvent(node: TmplAstBoundEvent) {\n     node.handler.visit(this.expressionAstVisitor, node.handlerSpan);\n   }\n }\n@@ -61,7 +61,7 @@ export class HtmlVariableAssignmentVisitor extends NullVisitor {\n class ExpressionAstVisitor extends RecursiveAstVisitor {\n   constructor(\n       private variableAssignments: TemplateVariableAssignment[],\n-      private currentVariables: Variable[]) {\n+      private currentVariables: TmplAstVariable[]) {\n     super();\n   }\n "
        },
        {
            "sha": "d7b1997ed0f71f30c8d7bd3f2d7ae7929702ffff",
            "filename": "packages/core/schematics/utils/parse_html.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Futils%2Fparse_html.ts",
            "raw_url": "https://github.com/angular/angular/raw/db5392f383ea9a46de54cd1feaa44a8450fb2138/packages%2Fcore%2Fschematics%2Futils%2Fparse_html.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Futils%2Fparse_html.ts?ref=db5392f383ea9a46de54cd1feaa44a8450fb2138",
            "patch": "@@ -6,14 +6,13 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {parseTemplate} from '@angular/compiler';\n-import {Node} from '@angular/compiler/src/render3/r3_ast';\n+import {parseTemplate, TmplAstNode} from '@angular/compiler';\n \n /**\n  * Parses the given HTML content using the Angular compiler. In case the parsing\n  * fails, null is being returned.\n  */\n-export function parseHtmlGracefully(htmlContent: string, filePath: string): Node[]|null {\n+export function parseHtmlGracefully(htmlContent: string, filePath: string): TmplAstNode[]|null {\n   try {\n     return parseTemplate(htmlContent, filePath).nodes;\n   } catch {"
        }
    ],
    "stats": {
        "total": 52,
        "additions": 26,
        "deletions": 26
    }
}