{
    "author": "AleksanderBodurri",
    "message": "fix(devtools): disable animations when running e2e testing to fix flaky tests",
    "sha": "08af1134e997c93da9008328d42e1162aa8df713",
    "files": [
        {
            "sha": "fbfe8702d63eeed135e1354f3ec783f21683f8d9",
            "filename": "angular.json",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/08af1134e997c93da9008328d42e1162aa8df713/angular.json",
            "raw_url": "https://github.com/angular/angular/raw/08af1134e997c93da9008328d42e1162aa8df713/angular.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/angular.json?ref=08af1134e997c93da9008328d42e1162aa8df713",
            "patch": "@@ -64,6 +64,14 @@\n                   \"maximumError\": \"10kb\"\n                 }\n               ]\n+            },\n+            \"e2e\": {\n+              \"fileReplacements\": [\n+                {\n+                  \"replace\": \"src/environments/environment.ts\",\n+                  \"with\": \"src/environments/environment.e2e.ts\"\n+                }\n+              ]\n             }\n           }\n         },\n@@ -76,6 +84,9 @@\n           \"configurations\": {\n             \"production\": {\n               \"browserTarget\": \"shell-dev:build:production\"\n+            },\n+            \"e2e\": {\n+              \"browserTarget\": \"shell-dev:build:e2e\"\n             }\n           }\n         },"
        },
        {
            "sha": "603b5eeb063c1fe31ba848dbbc0d8670dec7a661",
            "filename": "cypress/integration/node-selection.e2e.js",
            "status": "modified",
            "additions": 10,
            "deletions": 7,
            "changes": 17,
            "blob_url": "https://github.com/angular/angular/blob/08af1134e997c93da9008328d42e1162aa8df713/cypress%2Fintegration%2Fnode-selection.e2e.js",
            "raw_url": "https://github.com/angular/angular/raw/08af1134e997c93da9008328d42e1162aa8df713/cypress%2Fintegration%2Fnode-selection.e2e.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/cypress%2Fintegration%2Fnode-selection.e2e.js?ref=08af1134e997c93da9008328d42e1162aa8df713",
            "patch": "@@ -61,14 +61,17 @@ describe('node selection', () => {\n         });\n     });\n \n-    it.skip('should scroll right when right scroll button is clicked', () => {\n+    it('should scroll right when right scroll button is clicked', () => {\n       cy.get('.tree-wrapper')\n         .find('.tree-node:contains(\"div[TooltipDirective]\")')\n         .last()\n         .click({ force: true })\n         .then(() => {\n           cy.get('ng-breadcrumbs')\n             .find('.breadcrumbs')\n+            .then((el) => {\n+              el[0].style.scrollBehavior = 'auto';\n+            })\n             .then((breadcrumbsContainer) => {\n               const scrollLeft = () => breadcrumbsContainer[0].scrollLeft;\n               expect(scrollLeft()).to.eql(0);\n@@ -77,22 +80,24 @@ describe('node selection', () => {\n                 .find('.scroll-button')\n                 .last()\n                 .click()\n-                .wait(150) // wait for scroll animation to end\n                 .then(() => {\n-                  expect(scrollLeft()).to.eql(15);\n+                  expect(scrollLeft()).to.be.greaterThan(0);\n                 });\n             });\n         });\n     });\n \n-    it.skip('should scroll left when left scroll button is clicked', () => {\n+    it('should scroll left when left scroll button is clicked', () => {\n       cy.get('.tree-wrapper')\n         .find('.tree-node:contains(\"div[TooltipDirective]\")')\n         .last()\n         .click({ force: true })\n         .then(() => {\n           cy.get('ng-breadcrumbs')\n             .find('.breadcrumbs')\n+            .then((el) => {\n+              el[0].style.scrollBehavior = 'auto';\n+            })\n             .then((breadcrumbsContainer) => {\n               const scrollLeft = () => breadcrumbsContainer[0].scrollLeft;\n               expect(scrollLeft()).to.eql(0);\n@@ -101,15 +106,13 @@ describe('node selection', () => {\n                 .find('.scroll-button')\n                 .last()\n                 .click()\n-                .wait(150) // wait for scroll animation to end\n                 .then(() => {\n-                  expect(scrollLeft()).to.eql(15);\n+                  expect(scrollLeft()).to.be.greaterThan(0);\n \n                   cy.get('ng-breadcrumbs')\n                     .find('.scroll-button')\n                     .first()\n                     .click()\n-                    .wait(150) // wait for scroll animation to end\n                     .then(() => {\n                       expect(scrollLeft()).to.eql(0);\n                     });"
        },
        {
            "sha": "7fa1d69cf13c1c012e0bcb928b3b60ec0e4d6a5a",
            "filename": "cypress/integration/view-component-metadata.e2e.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/08af1134e997c93da9008328d42e1162aa8df713/cypress%2Fintegration%2Fview-component-metadata.e2e.js",
            "raw_url": "https://github.com/angular/angular/raw/08af1134e997c93da9008328d42e1162aa8df713/cypress%2Fintegration%2Fview-component-metadata.e2e.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/cypress%2Fintegration%2Fview-component-metadata.e2e.js?ref=08af1134e997c93da9008328d42e1162aa8df713",
            "patch": "@@ -1,6 +1,5 @@\n const prepareHeaderExpansionPanelForAssertions = (selector) => {\n   cy.get('.tree-wrapper').find(selector).first().click({ force: true });\n-  cy.wait(1000);\n   cy.get('.element-header .component-name').click();\n };\n "
        },
        {
            "sha": "1c397e70c4bed68c1717690ca11e46cb74f79d2c",
            "filename": "package.json",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/08af1134e997c93da9008328d42e1162aa8df713/package.json",
            "raw_url": "https://github.com/angular/angular/raw/08af1134e997c93da9008328d42e1162aa8df713/package.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/package.json?ref=08af1134e997c93da9008328d42e1162aa8df713",
            "patch": "@@ -6,6 +6,7 @@\n     \"ng\": \"ng\",\n     \"cypress:verify\": \"cypress verify\",\n     \"start\": \"cross-env LATEST_SHA=`git rev-parse --short HEAD` ng serve\",\n+    \"start-no-animations\": \"yarn start --configuration=e2e\",\n     \"build\": \"ng build\",\n     \"build:chrome\": \"cross-env LATEST_SHA=`git rev-parse --short HEAD` ng build shell-chrome\",\n     \"release\": \"node projects/shell-chrome/set-version.js && cross-env LATEST_SHA=`git rev-parse --short HEAD` ng build shell-chrome --configuration production\",\n@@ -17,8 +18,8 @@\n     \"cy:version\": \"$(npm bin)/cypress version\",\n     \"cy:run\": \"$(yarn bin)/cypress run\",\n     \"cy:open\": \"$(yarn bin)/cypress open\",\n-    \"cy:ci\": \"start-server-and-test start http-get://localhost:4200 cy:run\",\n-    \"cy:watch\": \"start-server-and-test start http-get://localhost:4200 cy:open\",\n+    \"cy:ci\": \"start-server-and-test start-no-animations http-get://localhost:4200 cy:run\",\n+    \"cy:watch\": \"start-server-and-test start-no-animations http-get://localhost:4200 cy:open\",\n     \"test:backend\": \"ng test ng-devtools-backend --watch=false\",\n     \"test:devtools\": \"ng test ng-devtools --watch=false\",\n     \"test:shared-utils\": \"ng test shared-utils --watch=false\","
        },
        {
            "sha": "23542b44f5ffa885f1fd7c2443319ca88e46fb21",
            "filename": "src/app/app.module.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/08af1134e997c93da9008328d42e1162aa8df713/src%2Fapp%2Fapp.module.ts",
            "raw_url": "https://github.com/angular/angular/raw/08af1134e997c93da9008328d42e1162aa8df713/src%2Fapp%2Fapp.module.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/src%2Fapp%2Fapp.module.ts?ref=08af1134e997c93da9008328d42e1162aa8df713",
            "patch": "@@ -2,15 +2,15 @@ import { NgModule } from '@angular/core';\n import { RouterModule } from '@angular/router';\n \n import { AppComponent } from './app.component';\n-import { BrowserAnimationsModule } from '@angular/platform-browser/animations';\n import { DemoApplicationOperations } from '../demo-application-operations';\n import { ApplicationEnvironment, ApplicationOperations } from 'ng-devtools';\n import { DemoApplicationEnvironment } from '../demo-application-environment';\n+import { environment } from 'src/environments/environment';\n \n @NgModule({\n   declarations: [AppComponent],\n   imports: [\n-    BrowserAnimationsModule,\n+    environment.animationModule,\n     RouterModule.forRoot([\n       {\n         path: '',"
        },
        {
            "sha": "07f3296c965be822d885fa9c78376f39c8fea942",
            "filename": "src/environments/environment.e2e.ts",
            "status": "added",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/08af1134e997c93da9008328d42e1162aa8df713/src%2Fenvironments%2Fenvironment.e2e.ts",
            "raw_url": "https://github.com/angular/angular/raw/08af1134e997c93da9008328d42e1162aa8df713/src%2Fenvironments%2Fenvironment.e2e.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/src%2Fenvironments%2Fenvironment.e2e.ts?ref=08af1134e997c93da9008328d42e1162aa8df713",
            "patch": "@@ -0,0 +1,14 @@\n+import { NoopAnimationsModule } from '@angular/platform-browser/animations';\n+import { Process } from 'ng-devtools';\n+\n+declare let process: Process;\n+\n+export const environment = {\n+  production: false,\n+  process: {\n+    env: {\n+      LATEST_SHA: process.env.LATEST_SHA,\n+    },\n+  },\n+  animationModule: NoopAnimationsModule,\n+};"
        },
        {
            "sha": "fc0732caf652c67ee6cf0af51771fdc685493d7e",
            "filename": "src/environments/environment.prod.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/08af1134e997c93da9008328d42e1162aa8df713/src%2Fenvironments%2Fenvironment.prod.ts",
            "raw_url": "https://github.com/angular/angular/raw/08af1134e997c93da9008328d42e1162aa8df713/src%2Fenvironments%2Fenvironment.prod.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/src%2Fenvironments%2Fenvironment.prod.ts?ref=08af1134e997c93da9008328d42e1162aa8df713",
            "patch": "@@ -1,3 +1,4 @@\n+import { BrowserAnimationsModule } from '@angular/platform-browser/animations';\n import { Process } from 'ng-devtools';\n \n declare let process: Process;\n@@ -9,4 +10,5 @@ export const environment = {\n       LATEST_SHA: process.env.LATEST_SHA,\n     },\n   },\n+  animationModule: BrowserAnimationsModule,\n };"
        },
        {
            "sha": "6e2c4c6f5c4b0798deeadcd17114ab82b49ec41e",
            "filename": "src/environments/environment.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/08af1134e997c93da9008328d42e1162aa8df713/src%2Fenvironments%2Fenvironment.ts",
            "raw_url": "https://github.com/angular/angular/raw/08af1134e997c93da9008328d42e1162aa8df713/src%2Fenvironments%2Fenvironment.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/src%2Fenvironments%2Fenvironment.ts?ref=08af1134e997c93da9008328d42e1162aa8df713",
            "patch": "@@ -2,6 +2,7 @@\n // `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n // The list of file replacements can be found in `angular.json`.\n \n+import { BrowserAnimationsModule } from '@angular/platform-browser/animations';\n import { Process } from 'ng-devtools';\n \n declare let process: Process;\n@@ -13,6 +14,7 @@ export const environment = {\n       LATEST_SHA: process.env.LATEST_SHA,\n     },\n   },\n+  animationModule: BrowserAnimationsModule,\n };\n \n /*"
        }
    ],
    "stats": {
        "total": 56,
        "additions": 44,
        "deletions": 12
    }
}