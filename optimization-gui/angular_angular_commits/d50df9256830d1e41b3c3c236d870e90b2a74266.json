{
    "author": "mhevery",
    "message": "refactor(core): Remove hack where we `TIcu` was stored in `tagName` (#39233)\n\nRemove casting where we stored `TIcu` in `TNode.tagName` which was of\ntype `string` rather than `TIcu'. (renamed to `TNode.value` in previous\ncommit.)\n\nPR Close #39233",
    "sha": "d50df9256830d1e41b3c3c236d870e90b2a74266",
    "files": [
        {
            "sha": "44bf466091b680844f03fd4c98e2405e238ab74a",
            "filename": "packages/core/src/render3/i18n/i18n_parse.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d50df9256830d1e41b3c3c236d870e90b2a74266/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_parse.ts",
            "raw_url": "https://github.com/angular/angular/raw/d50df9256830d1e41b3c3c236d870e90b2a74266/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_parse.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_parse.ts?ref=d50df9256830d1e41b3c3c236d870e90b2a74266",
            "patch": "@@ -17,7 +17,7 @@ import {loadIcuContainerVisitor} from '../instructions/i18n_icu_container_visito\n import {allocExpando, createTNodeAtIndex, elementAttributeInternal, setInputsForProperty, setNgReflectProperties} from '../instructions/shared';\n import {getDocument} from '../interfaces/document';\n import {COMMENT_MARKER, ELEMENT_MARKER, ensureIcuContainerVisitorLoaded, I18nCreateOpCode, I18nCreateOpCodes, I18nMutateOpCode, i18nMutateOpCode, I18nMutateOpCodes, I18nUpdateOpCode, I18nUpdateOpCodes, IcuExpression, IcuType, TI18n, TIcu} from '../interfaces/i18n';\n-import {TNode, TNodeType} from '../interfaces/node';\n+import {TIcuContainerNode, TNode, TNodeType} from '../interfaces/node';\n import {RComment, RElement} from '../interfaces/renderer';\n import {SanitizerFn} from '../interfaces/sanitization';\n import {HEADER_OFFSET, LView, TView} from '../interfaces/view';"
        },
        {
            "sha": "ce300e9539721e07d6ec85cd6847a783df2ac3d4",
            "filename": "packages/core/src/render3/i18n/i18n_util.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/d50df9256830d1e41b3c3c236d870e90b2a74266/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_util.ts",
            "raw_url": "https://github.com/angular/angular/raw/d50df9256830d1e41b3c3c236d870e90b2a74266/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_util.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_util.ts?ref=d50df9256830d1e41b3c3c236d870e90b2a74266",
            "patch": "@@ -40,9 +40,8 @@ export function getTIcu(tView: TView, index: number): TIcu|null {\n   // either TIcu or TIcuContainerNode. This is not ideal, but we still think it is OK because it\n   // will be just two cases which fits into the browser inline cache (inline cache can take up to\n   // 4)\n-  const tIcu: TIcu = value.hasOwnProperty('currentCaseLViewIndex') ?\n-      value :\n-      (value as TIcuContainerNode).value as any;\n+  const tIcu = value.hasOwnProperty('currentCaseLViewIndex') ? value as TIcu :\n+                                                               (value as TIcuContainerNode).value;\n   ngDevMode && assertTIcu(tIcu);\n   return tIcu;\n }\n@@ -71,7 +70,7 @@ export function setTIcu(tView: TView, index: number, tIcu: TIcu): void {\n     tView.data[index] = tIcu;\n   } else {\n     ngDevMode && assertNodeType(tNode, TNodeType.IcuContainer);\n-    tNode.value = tIcu as any;\n+    tNode.value = tIcu;\n   }\n }\n "
        },
        {
            "sha": "fbfe11ac8e887a765c0784f728559f6259a0fffe",
            "filename": "packages/core/src/render3/instructions/i18n_icu_container_visitor.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/d50df9256830d1e41b3c3c236d870e90b2a74266/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fi18n_icu_container_visitor.ts",
            "raw_url": "https://github.com/angular/angular/raw/d50df9256830d1e41b3c3c236d870e90b2a74266/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fi18n_icu_container_visitor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fi18n_icu_container_visitor.ts?ref=d50df9256830d1e41b3c3c236d870e90b2a74266",
            "patch": "@@ -40,11 +40,8 @@ export function loadIcuContainerVisitor() {\n       RNode | null {\n     _lView = lView;\n     while (_stack.length) _stack.pop();\n-    // FIXME(misko): This is a hack which allows us to associate `TI18n` with `TNode`.\n-    // This should be refactored so that one can attach arbitrary data with `TNode`\n     ngDevMode && assertTNodeForLView(tIcuContainerNode, lView);\n-    const tIcu: TIcu = tIcuContainerNode.value as any;\n-    enterIcu(tIcu, lView);\n+    enterIcu(tIcuContainerNode.value, lView);\n     return icuContainerIteratorNext;\n   }\n "
        },
        {
            "sha": "d8a46638ea2aa86689eb5c951e5758473abda1e7",
            "filename": "packages/core/src/render3/interfaces/node.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/d50df9256830d1e41b3c3c236d870e90b2a74266/packages%2Fcore%2Fsrc%2Frender3%2Finterfaces%2Fnode.ts",
            "raw_url": "https://github.com/angular/angular/raw/d50df9256830d1e41b3c3c236d870e90b2a74266/packages%2Fcore%2Fsrc%2Frender3%2Finterfaces%2Fnode.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finterfaces%2Fnode.ts?ref=d50df9256830d1e41b3c3c236d870e90b2a74266",
            "patch": "@@ -434,7 +434,7 @@ export interface TNode {\n    *   `TNodeType.Element`: tag name\n    *   `TNodeType.ICUContainer`: `TIcu`\n    */\n-  value: string|null;\n+  value: any;\n \n   /**\n    * Attributes associated with an element. We need to store attributes to support various use-cases\n@@ -744,6 +744,11 @@ export interface TElementNode extends TNode {\n    * a component without projection, it will be null.\n    */\n   projection: (TNode|RNode[])[]|null;\n+\n+  /**\n+   * Stores TagName\n+   */\n+  value: string;\n }\n \n /** Static data for a text node */\n@@ -781,6 +786,7 @@ export interface TContainerNode extends TNode {\n   parent: TElementNode|TElementContainerNode|null;\n   tViews: TView|TView[]|null;\n   projection: null;\n+  value: null;\n }\n \n /** Static data for an <ng-container> */\n@@ -801,8 +807,7 @@ export interface TIcuContainerNode extends TNode {\n   parent: TElementNode|TElementContainerNode|null;\n   tViews: null;\n   projection: null;\n-  // FIXME(misko): Refactor to enable the next line\n-  // tagName: TIcu;\n+  value: TIcu;\n }\n \n /** Static data for an LProjectionNode  */\n@@ -819,6 +824,7 @@ export interface TProjectionNode extends TNode {\n \n   /** Index of the projection node. (See TNode.projection for more info.) */\n   projection: number;\n+  value: null;\n }\n \n /**"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 14,
        "deletions": 12
    }
}