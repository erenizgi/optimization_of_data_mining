{
    "author": "iRealNirmal",
    "message": "docs: update testing components doc with generated compileComponent (#41947)\n\nUpdated testing-components-scenarios.md to match CLI generated test case.\n\nCloses #39740\n\nPR Close #41947",
    "sha": "2b939767fe3a43eb6b3eb220a5b8670ff66bbaec",
    "files": [
        {
            "sha": "d7d67e861de0012b876fae0b31094c3113f4d4ed",
            "filename": "aio/content/examples/testing/src/app/banner/banner-external.component.spec.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 17,
            "changes": 28,
            "blob_url": "https://github.com/angular/angular/blob/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fbanner%2Fbanner-external.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fbanner%2Fbanner-external.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fbanner%2Fbanner-external.component.spec.ts?ref=2b939767fe3a43eb6b3eb220a5b8670ff66bbaec",
            "patch": "@@ -1,7 +1,5 @@\n // #docplaster\n-// #docregion import-async\n-import { ComponentFixture, TestBed, waitForAsync } from '@angular/core/testing';\n-// #enddocregion import-async\n+import { ComponentFixture, TestBed } from '@angular/core/testing';\n import { By } from '@angular/platform-browser';\n import { DebugElement } from '@angular/core';\n \n@@ -14,13 +12,13 @@ describe('BannerComponent (external files)', () => {\n \n   describe('Two beforeEach', () => {\n     // #docregion async-before-each\n-    beforeEach(waitForAsync(() => {\n+    beforeEach(async () => {\n       TestBed\n           .configureTestingModule({\n             declarations: [BannerComponent],\n           })\n           .compileComponents();  // compile template and css\n-    }));\n+    });\n     // #enddocregion async-before-each\n \n     // synchronous beforeEach\n@@ -37,18 +35,14 @@ describe('BannerComponent (external files)', () => {\n \n   describe('One beforeEach', () => {\n     // #docregion one-before-each\n-    beforeEach(waitForAsync(() => {\n-      TestBed\n-          .configureTestingModule({\n-            declarations: [BannerComponent],\n-          })\n-          .compileComponents()\n-          .then(() => {\n-            fixture = TestBed.createComponent(BannerComponent);\n-            component = fixture.componentInstance;\n-            h1 = fixture.nativeElement.querySelector('h1');\n-          });\n-    }));\n+    beforeEach(async () => {\n+      await TestBed.configureTestingModule({\n+        declarations: [BannerComponent],\n+      }).compileComponents();\n+      fixture = TestBed.createComponent(BannerComponent);\n+      component = fixture.componentInstance;\n+      h1 = fixture.nativeElement.querySelector('h1');\n+    });\n     // #enddocregion one-before-each\n \n     tests();"
        },
        {
            "sha": "0b79132224eafe4b40badc2afa3c2d3ceb60ca88",
            "filename": "aio/content/examples/testing/src/app/banner/banner.component.spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fbanner%2Fbanner.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fbanner%2Fbanner.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fbanner%2Fbanner.component.spec.ts?ref=2b939767fe3a43eb6b3eb220a5b8670ff66bbaec",
            "patch": "@@ -12,8 +12,8 @@ describe('BannerComponent (inline template)', () => {\n   let h1: HTMLElement;\n \n   // #docregion configure-and-create\n-  beforeEach(() => {\n-    TestBed.configureTestingModule({\n+  beforeEach(async () => {\n+    await TestBed.configureTestingModule({\n       declarations: [ BannerComponent ],\n     });\n     fixture = TestBed.createComponent(BannerComponent);"
        },
        {
            "sha": "ca8260f1d60fe6b0f5d202b4fbef088b7fb52e9f",
            "filename": "aio/content/examples/testing/src/app/hero/hero-detail.component.spec.ts",
            "status": "modified",
            "additions": 24,
            "deletions": 22,
            "changes": 46,
            "blob_url": "https://github.com/angular/angular/blob/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fhero%2Fhero-detail.component.spec.ts?ref=2b939767fe3a43eb6b3eb220a5b8670ff66bbaec",
            "patch": "@@ -50,10 +50,10 @@ function overrideSetup() {\n   beforeEach(() => activatedRoute.setParamMap({id: 99999}));\n \n   // #docregion setup-override\n-  beforeEach(waitForAsync(() => {\n+  beforeEach(async () => {\n     const routerSpy = createRouterSpy();\n \n-    TestBed\n+    await TestBed\n         .configureTestingModule({\n           imports: [HeroModule],\n           providers: [\n@@ -74,17 +74,17 @@ function overrideSetup() {\n         // #enddocregion override-component-method\n \n         .compileComponents();\n-  }));\n+  });\n   // #enddocregion setup-override\n \n   // #docregion override-tests\n   let hdsSpy: HeroDetailServiceSpy;\n \n-  beforeEach(waitForAsync(() => {\n-    createComponent();\n+  beforeEach(async () => {\n+    await createComponent();\n     // get the component's injected HeroDetailServiceSpy\n     hdsSpy = fixture.debugElement.injector.get(HeroDetailService) as any;\n-  }));\n+  });\n \n   it('should have called `getHero`', () => {\n     expect(hdsSpy.getHero.calls.count()).toBe(1, 'getHero called once');\n@@ -133,10 +133,10 @@ const firstHero = getTestHeroes()[0];\n \n function heroModuleSetup() {\n   // #docregion setup-hero-module\n-  beforeEach(waitForAsync(() => {\n+  beforeEach(async () => {\n     const routerSpy = createRouterSpy();\n \n-    TestBed\n+    await TestBed\n         .configureTestingModule({\n           imports: [HeroModule],\n           // #enddocregion setup-hero-module\n@@ -149,18 +149,18 @@ function heroModuleSetup() {\n           ]\n         })\n         .compileComponents();\n-  }));\n+  });\n   // #enddocregion setup-hero-module\n \n   // #docregion route-good-id\n   describe('when navigate to existing hero', () => {\n     let expectedHero: Hero;\n \n-    beforeEach(waitForAsync(() => {\n+    beforeEach(async () => {\n       expectedHero = firstHero;\n       activatedRoute.setParamMap({id: expectedHero.id});\n-      createComponent();\n-    }));\n+      await createComponent();\n+    });\n \n     // #docregion selected-tests\n     it('should display that hero\\'s name', () => {\n@@ -218,7 +218,9 @@ function heroModuleSetup() {\n \n   // #docregion route-no-id\n   describe('when navigate with no hero id', () => {\n-    beforeEach(waitForAsync(createComponent));\n+    beforeEach(async () => {\n+      await createComponent();\n+    });\n \n     it('should have hero.id === 0', () => {\n       expect(component.hero.id).toBe(0);\n@@ -232,10 +234,10 @@ function heroModuleSetup() {\n \n   // #docregion route-bad-id\n   describe('when navigate to non-existent hero id', () => {\n-    beforeEach(waitForAsync(() => {\n+    beforeEach(async () => {\n       activatedRoute.setParamMap({id: 99999});\n-      createComponent();\n-    }));\n+      await createComponent();\n+    });\n \n     it('should try to navigate back to hero list', () => {\n       expect(page.gotoListSpy.calls.any()).toBe(true, 'comp.gotoList called');\n@@ -266,10 +268,10 @@ import { TitleCasePipe } from '../shared/title-case.pipe';\n \n function formsModuleSetup() {\n   // #docregion setup-forms-module\n-  beforeEach(waitForAsync(() => {\n+  beforeEach(async () => {\n     const routerSpy = createRouterSpy();\n \n-    TestBed\n+    await TestBed\n         .configureTestingModule({\n           imports: [FormsModule],\n           declarations: [HeroDetailComponent, TitleCasePipe],\n@@ -280,7 +282,7 @@ function formsModuleSetup() {\n           ]\n         })\n         .compileComponents();\n-  }));\n+  });\n   // #enddocregion setup-forms-module\n \n   it('should display 1st hero\\'s name', waitForAsync(() => {\n@@ -297,10 +299,10 @@ import { SharedModule } from '../shared/shared.module';\n \n function sharedModuleSetup() {\n   // #docregion setup-shared-module\n-  beforeEach(waitForAsync(() => {\n+  beforeEach(async () => {\n     const routerSpy = createRouterSpy();\n \n-    TestBed\n+    await TestBed\n         .configureTestingModule({\n           imports: [SharedModule],\n           declarations: [HeroDetailComponent],\n@@ -311,7 +313,7 @@ function sharedModuleSetup() {\n           ]\n         })\n         .compileComponents();\n-  }));\n+  });\n   // #enddocregion setup-shared-module\n \n   it('should display 1st hero\\'s name', waitForAsync(() => {"
        },
        {
            "sha": "b3b0e56a55d1a49e56668ceaf9b051e4cfe45398",
            "filename": "aio/content/examples/testing/src/app/shared/canvas.component.spec.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fshared%2Fcanvas.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fshared%2Fcanvas.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Fshared%2Fcanvas.component.spec.ts?ref=2b939767fe3a43eb6b3eb220a5b8670ff66bbaec",
            "patch": "@@ -1,6 +1,6 @@\n // #docplaster\n // #docregion without-toBlob-macrotask\n-import { fakeAsync, TestBed, tick, waitForAsync } from '@angular/core/testing';\n+import { fakeAsync, TestBed, tick } from '@angular/core/testing';\n \n import { CanvasComponent } from './canvas.component';\n \n@@ -17,13 +17,13 @@ describe('CanvasComponent', () => {\n   });\n   // #enddocregion enable-toBlob-macrotask\n   // #docregion without-toBlob-macrotask\n-  beforeEach(waitForAsync(() => {\n-    TestBed\n+  beforeEach(async () => {\n+    await TestBed\n         .configureTestingModule({\n           declarations: [CanvasComponent],\n         })\n         .compileComponents();\n-  }));\n+  });\n \n   it('should be able to generate blob data from canvas', fakeAsync(() => {\n        const fixture = TestBed.createComponent(CanvasComponent);"
        },
        {
            "sha": "ed4a425822ba8c02c293841f1dd2a4cfcd3f9740",
            "filename": "aio/content/examples/testing/src/app/twain/twain.component.spec.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Ftwain%2Ftwain.component.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Ftwain%2Ftwain.component.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Ftesting%2Fsrc%2Fapp%2Ftwain%2Ftwain.component.spec.ts?ref=2b939767fe3a43eb6b3eb220a5b8670ff66bbaec",
            "patch": "@@ -120,8 +120,8 @@ describe('TwainComponent', () => {\n        }));\n     // #enddocregion fake-async-test\n \n-    // #docregion async-test\n-    it('should show quote after getQuote (async)', waitForAsync(() => {\n+    // #docregion waitForAsync-test\n+    it('should show quote after getQuote (waitForAsync)', waitForAsync(() => {\n          fixture.detectChanges();  // ngOnInit()\n          expect(quoteEl.textContent).toBe('...', 'should show placeholder');\n \n@@ -131,7 +131,7 @@ describe('TwainComponent', () => {\n            expect(errorMessage()).toBeNull('should not show error');\n          });\n        }));\n-    // #enddocregion async-test\n+    // #enddocregion waitForAsync-test\n \n \n     // #docregion quote-done-test"
        },
        {
            "sha": "5bcadb02191f26577cae30cdcd77a603b54af0d4",
            "filename": "aio/content/guide/testing-components-scenarios.md",
            "status": "modified",
            "additions": 2,
            "deletions": 19,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fguide%2Ftesting-components-scenarios.md",
            "raw_url": "https://github.com/angular/angular/raw/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fguide%2Ftesting-components-scenarios.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fguide%2Ftesting-components-scenarios.md?ref=2b939767fe3a43eb6b3eb220a5b8670ff66bbaec",
            "patch": "@@ -586,19 +586,11 @@ Then you can assert that the quote element displays the expected text.\n To use `waitForAsync()` functionality, you must import `zone.js/testing` in your test setup file.\n If you created your project with the Angular CLI, `zone-testing` is already imported in `src/test.ts`.\n \n-<div class=\"alert is-helpful\">\n-\n-The `TestBed.compileComponents()` method (see [below](#compile-components)) calls `XHR`\n-to read external template and css files during \"just-in-time\" compilation.\n-Write tests that call `compileComponents()` with the `waitForAsync()` utility.\n-\n-</div>\n-\n Here's the previous `fakeAsync()` test, re-written with the `waitForAsync()` utility.\n \n <code-example\n   path=\"testing/src/app/twain/twain.component.spec.ts\"\n-  region=\"async-test\">\n+  region=\"waitForAsync-test\">\n </code-example>\n \n The `waitForAsync()` utility hides some asynchronous boilerplate by arranging for the tester's code\n@@ -1502,7 +1494,7 @@ You must call `compileComponents()` within an asynchronous test function.\n <div class=\"alert is-critical\">\n \n If you neglect to make the test function async\n-(e.g., forget to use `waitForAsync()` as described below),\n+(e.g., forget to use the `async` keyword as described below),\n you'll see this error message\n \n <code-example language=\"sh\" class=\"code-shell\" hideCopy>\n@@ -1516,13 +1508,6 @@ A typical approach is to divide the setup logic into two separate `beforeEach()`\n 1.  An async `beforeEach()` that compiles the components\n 1.  A synchronous `beforeEach()` that performs the remaining setup.\n \n-To follow this pattern, import the `waitForAsync()` helper with the other testing symbols.\n-\n-<code-example\n-  path=\"testing/src/app/banner/banner-external.component.spec.ts\"\n-  region=\"import-async\">\n-</code-example>\n-\n #### The async _beforeEach_\n \n Write the first async `beforeEach` like this.\n@@ -1532,8 +1517,6 @@ Write the first async `beforeEach` like this.\n   region=\"async-before-each\"\n   header=\"app/banner/banner-external.component.spec.ts (async beforeEach)\"></code-example>\n \n-The `waitForAsync()` helper function takes a parameterless function with the body of the setup.\n-\n The `TestBed.configureTestingModule()` method returns the `TestBed` class so you can chain\n calls to other `TestBed` static methods such as `compileComponents()`.\n "
        },
        {
            "sha": "c4154e12121ee58e8072b888c3f8fc66c9874be8",
            "filename": "aio/content/guide/upgrade-setup.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fguide%2Fupgrade-setup.md",
            "raw_url": "https://github.com/angular/angular/raw/2b939767fe3a43eb6b3eb220a5b8670ff66bbaec/aio%2Fcontent%2Fguide%2Fupgrade-setup.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fguide%2Fupgrade-setup.md?ref=2b939767fe3a43eb6b3eb220a5b8670ff66bbaec",
            "patch": "@@ -308,7 +308,7 @@ So when IE is refreshed (manually or automatically by `ng serve`), sometimes the\n \n ## Appendix: Test using `fakeAsync()/waitForAsync()`\n \n-If you use the `fakeAsync()/waitForAsync()` helper function to run unit tests (for details, read the [Testing guide](guide/testing-components-scenarios#fake-async)), you need to import `zone.js/testing` in your test setup file.\n+If you use the `fakeAsync()/waitForAsync()` helper functions to run unit tests (for details, read the [Testing guide](guide/testing-components-scenarios#fake-async)), you need to import `zone.js/testing` in your test setup file.\n \n <div class=\"alert is-important\">\n If you create project with `Angular/CLI`, it is already imported in `src/test.ts`."
        }
    ],
    "stats": {
        "total": 115,
        "additions": 47,
        "deletions": 68
    }
}