{
    "author": "unknown",
    "message": "build(language-service): Remove ls_rollup_bundle (#38086)\n\n`ls_rollup_bundle` is no longer needed since we could invoke `ng_rollup_bundle`\ndirectly.\n\nBackground: language service runs rollup to produce a single file to reduce\nstartup time in the editor. However, due to the need to load dynamic versions\nof typescript at runtime (think the case where users can change typescript\nversion in their editor), we hack the \"banner\" to export a CommonJS default function,\nso that we could dynamically load the typescript module provided at runtime via AMD\nand use it throughout the implementation.\n\nPR Close #38086",
    "sha": "bd71f1023467af575d3686c87ffc5b6dd074c346",
    "files": [
        {
            "sha": "320cc2399550d472b2826274bef808245ccb9e8e",
            "filename": "packages/language-service/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/bd71f1023467af575d3686c87ffc5b6dd074c346/packages%2Flanguage-service%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/bd71f1023467af575d3686c87ffc5b6dd074c346/packages%2Flanguage-service%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2FBUILD.bazel?ref=bd71f1023467af575d3686c87ffc5b6dd074c346",
            "patch": "@@ -46,7 +46,7 @@ pkg_npm(\n     deps = [\n         \":language-service\",\n         # min bundle is not used at the moment; omit from package to speed up build\n-        \"//packages/language-service/bundles:language-service.umd.js\",\n-        \"//packages/language-service/bundles:ivy.umd.js\",\n+        \"//packages/language-service/bundles:language-service.js\",\n+        \"//packages/language-service/bundles:ivy.js\",\n     ],\n )"
        },
        {
            "sha": "3f323a589364021990357cf219d6cdf8d97dcd54",
            "filename": "packages/language-service/bundles/BUILD.bazel",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/bd71f1023467af575d3686c87ffc5b6dd074c346/packages%2Flanguage-service%2Fbundles%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/bd71f1023467af575d3686c87ffc5b6dd074c346/packages%2Flanguage-service%2Fbundles%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fbundles%2FBUILD.bazel?ref=bd71f1023467af575d3686c87ffc5b6dd074c346",
            "patch": "@@ -1,8 +1,10 @@\n-load(\"//packages/language-service/bundles:index.bzl\", \"ls_rollup_bundle\")\n+load(\"//dev-infra/benchmark/ng_rollup_bundle:ng_rollup_bundle.bzl\", \"ng_rollup_bundle\")\n \n-ls_rollup_bundle(\n+ng_rollup_bundle(\n     name = \"language-service\",\n+    build_optimizer = False,\n     entry_point = \"//packages/language-service:index.ts\",\n+    format = \"amd\",\n     globals = {\n         \"fs\": \"fs\",\n         \"path\": \"path\",\n@@ -18,9 +20,11 @@ ls_rollup_bundle(\n     ],\n )\n \n-ls_rollup_bundle(\n+ng_rollup_bundle(\n     name = \"ivy\",\n+    build_optimizer = False,\n     entry_point = \"//packages/language-service/ivy:ts_plugin.ts\",\n+    format = \"amd\",\n     globals = {\n         \"fs\": \"fs\",\n         \"path\": \"path\","
        },
        {
            "sha": "ca2498d940aa7983f914c2a9e075e550a0a47a09",
            "filename": "packages/language-service/bundles/index.bzl",
            "status": "removed",
            "additions": 0,
            "deletions": 25,
            "changes": 25,
            "blob_url": "https://github.com/angular/angular/blob/e0b35bfc18142fa8e8f4674d41eabe8867cb0fd3/packages%2Flanguage-service%2Fbundles%2Findex.bzl",
            "raw_url": "https://github.com/angular/angular/raw/e0b35bfc18142fa8e8f4674d41eabe8867cb0fd3/packages%2Flanguage-service%2Fbundles%2Findex.bzl",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fbundles%2Findex.bzl?ref=e0b35bfc18142fa8e8f4674d41eabe8867cb0fd3",
            "patch": "@@ -1,25 +0,0 @@\n-load(\"//dev-infra/benchmark/ng_rollup_bundle:ng_rollup_bundle.bzl\", \"ng_rollup_bundle\")\n-\n-def ls_rollup_bundle(name, **kwargs):\n-    \"\"\"\n-        A variant of ng_rollup_bundle for the language-service bundle that\n-        outputs in AMD format.\n-    \"\"\"\n-    visibility = kwargs.pop(\"visibility\", None)\n-\n-    # Note: the output file is called \"umd.js\" because of historical reasons.\n-    # The format is actually AMD and not UMD, but we are afraid to rename\n-    # the file because that would likely break the IDE and other integrations that\n-    # have the path hardcoded in them.\n-    ng_rollup_bundle(\n-        name = name + \".umd\",\n-        build_optimizer = False,\n-        format = \"amd\",\n-        visibility = visibility,\n-        **kwargs\n-    )\n-    native.alias(\n-        name = name,\n-        actual = name + \".umd\",\n-        visibility = visibility,\n-    )"
        },
        {
            "sha": "e3e5b2a1b56c2ff9b55e921f826a923778a70737",
            "filename": "packages/language-service/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/bd71f1023467af575d3686c87ffc5b6dd074c346/packages%2Flanguage-service%2Fpackage.json",
            "raw_url": "https://github.com/angular/angular/raw/bd71f1023467af575d3686c87ffc5b6dd074c346/packages%2Flanguage-service%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fpackage.json?ref=bd71f1023467af575d3686c87ffc5b6dd074c346",
            "patch": "@@ -2,7 +2,7 @@\n   \"name\": \"@angular/language-service\",\n   \"version\": \"0.0.0-PLACEHOLDER\",\n   \"description\": \"Angular - language services\",\n-  \"main\": \"./bundles/language-service.umd.js\",\n+  \"main\": \"./bundles/language-service.js\",\n   \"typings\": \"./index.d.ts\",\n   \"author\": \"angular\",\n   \"license\": \"MIT\","
        }
    ],
    "stats": {
        "total": 41,
        "additions": 10,
        "deletions": 31
    }
}