{
    "author": "alan-agius4",
    "message": "feat(compiler-cli): add support for TypeScript 4.0 (#38076)\n\nWith this change we add support for TypeScript 4.0\n\nPR Close #38076",
    "sha": "0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
    "files": [
        {
            "sha": "5481b3eae4bfe5930502166ba50f12ef800712d8",
            "filename": "goldens/public-api/common/common.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -216,7 +216,7 @@ export declare class NgComponentOutlet implements OnChanges, OnDestroy {\n }\n \n export declare class NgForOf<T, U extends NgIterable<T> = NgIterable<T>> implements DoCheck {\n-    set ngForOf(ngForOf: (U & NgIterable<T>) | undefined | null);\n+    set ngForOf(ngForOf: U & NgIterable<T> | undefined | null);\n     set ngForTemplate(value: TemplateRef<NgForOfContext<T, U>>);\n     set ngForTrackBy(fn: TrackByFunction<T>);\n     get ngForTrackBy(): TrackByFunction<T>;"
        },
        {
            "sha": "baafc1693d888b94229c6c8048cb92c3f5fdf868",
            "filename": "goldens/public-api/elements/elements.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/goldens%2Fpublic-api%2Felements%2Felements.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/goldens%2Fpublic-api%2Felements%2Felements.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Felements%2Felements.d.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -2,7 +2,7 @@ export declare function createCustomElement<P>(component: Type<any>, config: NgE\n \n export declare abstract class NgElement extends HTMLElement {\n     protected ngElementEventsSubscription: Subscription | null;\n-    protected ngElementStrategy: NgElementStrategy;\n+    protected abstract ngElementStrategy: NgElementStrategy;\n     abstract attributeChangedCallback(attrName: string, oldValue: string | null, newValue: string, namespace?: string): void;\n     abstract connectedCallback(): void;\n     abstract disconnectedCallback(): void;"
        },
        {
            "sha": "a58be0c1d56fbbed0bfd643ea164484e21a24fac",
            "filename": "integration/BUILD.bazel",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/integration%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/integration%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/integration%2FBUILD.bazel?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -85,6 +85,12 @@ INTEGRATION_TESTS = {\n         # root @npm//typescript package.\n         \"pinned_npm_packages\": [\"typescript\"],\n     },\n+    \"typings_test_ts40\": {\n+        # Special case for `typings_test_ts40` test as we want to pin\n+        # `typescript` at version 4.0.x for that test and not link to the\n+        # root @npm//typescript package.\n+        \"pinned_npm_packages\": [\"typescript\"],\n+    },\n }\n \n ["
        },
        {
            "sha": "81d94b0a01934b8c77ee6d3f5ae922cb3f72bc34",
            "filename": "integration/typings_test_ts40/include-all.ts",
            "status": "added",
            "additions": 71,
            "deletions": 0,
            "changes": 71,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/integration%2Ftypings_test_ts40%2Finclude-all.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/integration%2Ftypings_test_ts40%2Finclude-all.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/integration%2Ftypings_test_ts40%2Finclude-all.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -0,0 +1,71 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+\n+\n+import * as animations from '@angular/animations';\n+import * as animationsBrowser from '@angular/animations/browser';\n+import * as animationsBrowserTesting from '@angular/animations/browser/testing';\n+import * as common from '@angular/common';\n+import * as commonHttp from '@angular/common/http';\n+import * as commonTesting from '@angular/common/testing';\n+import * as commonHttpTesting from '@angular/common/testing';\n+import * as compiler from '@angular/compiler';\n+import * as compilerTesting from '@angular/compiler/testing';\n+import * as core from '@angular/core';\n+import * as coreTesting from '@angular/core/testing';\n+import * as elements from '@angular/elements';\n+import * as forms from '@angular/forms';\n+import * as platformBrowser from '@angular/platform-browser';\n+import * as platformBrowserDynamic from '@angular/platform-browser-dynamic';\n+import * as platformBrowserDynamicTesting from '@angular/platform-browser-dynamic/testing';\n+import * as platformBrowserAnimations from '@angular/platform-browser/animations';\n+import * as platformBrowserTesting from '@angular/platform-browser/testing';\n+import * as platformServer from '@angular/platform-server';\n+import * as platformServerTesting from '@angular/platform-server/testing';\n+import * as platformWebworker from '@angular/platform-webworker';\n+import * as platformWebworkerDynamic from '@angular/platform-webworker-dynamic';\n+import * as router from '@angular/router';\n+import * as routerTesting from '@angular/router/testing';\n+import * as routerUpgrade from '@angular/router/upgrade';\n+import * as serviceWorker from '@angular/service-worker';\n+import * as upgrade from '@angular/upgrade';\n+import * as upgradeStatic from '@angular/upgrade/static';\n+import * as upgradeTesting from '@angular/upgrade/static/testing';\n+\n+export default {\n+  animations,\n+  animationsBrowser,\n+  animationsBrowserTesting,\n+  common,\n+  commonTesting,\n+  commonHttp,\n+  commonHttpTesting,\n+  compiler,\n+  compilerTesting,\n+  core,\n+  coreTesting,\n+  elements,\n+  forms,\n+  platformBrowser,\n+  platformBrowserTesting,\n+  platformBrowserDynamic,\n+  platformBrowserDynamicTesting,\n+  platformBrowserAnimations,\n+  platformServer,\n+  platformServerTesting,\n+  platformWebworker,\n+  platformWebworkerDynamic,\n+  router,\n+  routerTesting,\n+  routerUpgrade,\n+  serviceWorker,\n+  upgrade,\n+  upgradeStatic,\n+  upgradeTesting,\n+};"
        },
        {
            "sha": "c184501a814d8b2a0de468779e682434c7f98fe3",
            "filename": "integration/typings_test_ts40/package.json",
            "status": "added",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/integration%2Ftypings_test_ts40%2Fpackage.json",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/integration%2Ftypings_test_ts40%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/integration%2Ftypings_test_ts40%2Fpackage.json?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -0,0 +1,30 @@\n+{\n+  \"name\": \"angular-integration\",\n+  \"description\": \"Assert that users with TypeScript 4.0 can type-check an Angular application\",\n+  \"version\": \"0.0.0\",\n+  \"license\": \"MIT\",\n+  \"dependencies\": {\n+    \"@angular/animations\": \"file:../../dist/packages-dist/animations\",\n+    \"@angular/common\": \"file:../../dist/packages-dist/common\",\n+    \"@angular/compiler\": \"file:../../dist/packages-dist/compiler\",\n+    \"@angular/compiler-cli\": \"file:../../dist/packages-dist/compiler-cli\",\n+    \"@angular/core\": \"file:../../dist/packages-dist/core\",\n+    \"@angular/elements\": \"file:../../dist/packages-dist/elements\",\n+    \"@angular/forms\": \"file:../../dist/packages-dist/forms\",\n+    \"@angular/platform-browser\": \"file:../../dist/packages-dist/platform-browser\",\n+    \"@angular/platform-browser-dynamic\": \"file:../../dist/packages-dist/platform-browser-dynamic\",\n+    \"@angular/platform-server\": \"file:../../dist/packages-dist/platform-server\",\n+    \"@angular/platform-webworker\": \"file:../../dist/packages-dist/platform-webworker\",\n+    \"@angular/platform-webworker-dynamic\": \"file:../../dist/packages-dist/platform-webworker-dynamic\",\n+    \"@angular/router\": \"file:../../dist/packages-dist/router\",\n+    \"@angular/service-worker\": \"file:../../dist/packages-dist/service-worker\",\n+    \"@angular/upgrade\": \"file:../../dist/packages-dist/upgrade\",\n+    \"@types/jasmine\": \"file:../../node_modules/@types/jasmine\",\n+    \"rxjs\": \"file:../../node_modules/rxjs\",\n+    \"typescript\": \"4.0.2\",\n+    \"zone.js\": \"file:../../dist/zone.js-dist/zone.js\"\n+  },\n+  \"scripts\": {\n+    \"test\": \"tsc\"\n+  }\n+}"
        },
        {
            "sha": "30e25c2209734194d3848550110bbc0848381535",
            "filename": "integration/typings_test_ts40/tsconfig.json",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/integration%2Ftypings_test_ts40%2Ftsconfig.json",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/integration%2Ftypings_test_ts40%2Ftsconfig.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/integration%2Ftypings_test_ts40%2Ftsconfig.json?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -0,0 +1,26 @@\n+{\n+  \"compilerOptions\": {\n+    \"forceConsistentCasingInFileNames\": true,\n+    \"strict\": true,\n+    \"noImplicitReturns\": true,\n+    \"noFallthroughCasesInSwitch\": true,\n+    \"experimentalDecorators\": true,\n+    \"module\": \"commonjs\",\n+    \"moduleResolution\": \"node\",\n+    \"outDir\": \"./dist/out-tsc\",\n+    \"rootDir\": \".\",\n+    \"target\": \"es5\",\n+    \"lib\": [\n+      \"es5\",\n+      \"dom\",\n+      \"es2015.collection\",\n+      \"es2015.iterable\",\n+      \"es2015.promise\"\n+    ],\n+    \"types\": [],\n+  },\n+  \"files\": [\n+    \"include-all.ts\",\n+    \"node_modules/@types/jasmine/index.d.ts\"\n+  ]\n+}"
        },
        {
            "sha": "73f4d37002daeee2226b250f5f8bdd5495f9c9eb",
            "filename": "package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/package.json",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/package.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/package.json?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -149,8 +149,8 @@\n     \"terser\": \"^4.4.0\",\n     \"tsickle\": \"0.38.1\",\n     \"tslib\": \"^2.0.0\",\n-    \"tslint\": \"6.0.0\",\n-    \"typescript\": \"~3.9.5\",\n+    \"tslint\": \"6.1.3\",\n+    \"typescript\": \"~4.0.2\",\n     \"xhr2\": \"0.2.0\",\n     \"yaml\": \"^1.7.2\",\n     \"yargs\": \"^15.4.1\""
        },
        {
            "sha": "a5828feb5668725f8afd43b920b5d4cef1fbb3af",
            "filename": "packages/bazel/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fbazel%2Fpackage.json",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fbazel%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fbazel%2Fpackage.json?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -34,7 +34,7 @@\n     \"@angular/compiler-cli\": \"0.0.0-PLACEHOLDER\",\n     \"@bazel/typescript\": \">=1.0.0\",\n     \"terser\": \"^4.3.1\",\n-    \"typescript\": \">=3.9 <4.0\",\n+    \"typescript\": \">=3.9 <4.1\",\n     \"rollup\": \">=1.20.0\",\n     \"rollup-plugin-commonjs\": \">=9.0.0\",\n     \"rollup-plugin-node-resolve\": \">=4.2.0\","
        },
        {
            "sha": "d1940a59d3cd53251819f844874ab00563a5565a",
            "filename": "packages/compiler-cli/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fpackage.json",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fpackage.json?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -27,7 +27,7 @@\n   },\n   \"peerDependencies\": {\n     \"@angular/compiler\": \"0.0.0-PLACEHOLDER\",\n-    \"typescript\": \">=3.9 <4.0\"\n+    \"typescript\": \">=3.9 <4.1\"\n   },\n   \"engines\": {\n     \"node\": \">=10.0\""
        },
        {
            "sha": "a7afb4e01df9c84920563d5eba9ef2c1256c74a7",
            "filename": "packages/compiler-cli/src/metadata/evaluator.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 6,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fmetadata%2Fevaluator.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fmetadata%2Fevaluator.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fmetadata%2Fevaluator.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -476,13 +476,16 @@ export class Evaluator {\n         return recordEntry(typeReference, node);\n       case ts.SyntaxKind.UnionType:\n         const unionType = <ts.UnionTypeNode>node;\n-\n         // Remove null and undefined from the list of unions.\n-        const references = unionType.types\n-                               .filter(\n-                                   n => n.kind != ts.SyntaxKind.NullKeyword &&\n-                                       n.kind != ts.SyntaxKind.UndefinedKeyword)\n-                               .map(n => this.evaluateNode(n));\n+        // TODO(alan-agius4): remove `n.kind !== ts.SyntaxKind.NullKeyword` when\n+        // TS 3.9 support is dropped. In TS 4.0 NullKeyword is a child of LiteralType.\n+        const references =\n+            unionType.types\n+                .filter(\n+                    n => n.kind !== ts.SyntaxKind.NullKeyword &&\n+                        n.kind !== ts.SyntaxKind.UndefinedKeyword &&\n+                        !(ts.isLiteralTypeNode(n) && n.literal.kind === ts.SyntaxKind.NullKeyword))\n+                .map(n => this.evaluateNode(n));\n \n         // The remmaining reference must be the same. If two have type arguments consider them\n         // different even if the type arguments are the same."
        },
        {
            "sha": "21400f45bb60fbc4da9a4dac037cc78dcd4d0069",
            "filename": "packages/compiler-cli/src/metadata/symbols.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fmetadata%2Fsymbols.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fmetadata%2Fsymbols.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fmetadata%2Fsymbols.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -62,8 +62,8 @@ export class Symbols {\n                 // even if the `SourceFile` was not type checked (which looks for `SourceFile`\n                 // in the parent chain). This doesn't damage the node as the binder unconditionally\n                 // sets the parent.\n-                externalReference.expression.parent = externalReference;\n-                externalReference.parent = this.sourceFile as any;\n+                (externalReference.expression.parent as ts.Node) = externalReference;\n+                (externalReference.parent as ts.Node) = this.sourceFile;\n               }\n               const from = stripQuotes(externalReference.expression.getText());\n               symbols.set(\n@@ -83,8 +83,8 @@ export class Symbols {\n           }\n           if (!importDecl.moduleSpecifier.parent) {\n             // See note above in the `ImportEqualDeclaration` case.\n-            importDecl.moduleSpecifier.parent = importDecl;\n-            importDecl.parent = this.sourceFile;\n+            (importDecl.moduleSpecifier.parent as ts.Node) = importDecl;\n+            (importDecl.parent as ts.Node) = this.sourceFile;\n           }\n           const from = stripQuotes(importDecl.moduleSpecifier.getText());\n           if (importDecl.importClause.name) {"
        },
        {
            "sha": "2f465dd977054413f825aeee81ddd94b506e392b",
            "filename": "packages/compiler-cli/src/ngtsc/metadata/src/util.ts",
            "status": "modified",
            "additions": 29,
            "deletions": 22,
            "changes": 51,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fmetadata%2Fsrc%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fmetadata%2Fsrc%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fmetadata%2Fsrc%2Futil.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -20,22 +20,26 @@ export function extractReferencesFromType(\n   if (!ts.isTupleTypeNode(def)) {\n     return [];\n   }\n-  return def.elementTypes.map(element => {\n-    if (!ts.isTypeQueryNode(element)) {\n-      throw new Error(`Expected TypeQueryNode: ${nodeDebugInfo(element)}`);\n-    }\n-    const type = element.exprName;\n-    const {node, from} = reflectTypeEntityToDeclaration(type, checker);\n-    if (!isNamedClassDeclaration(node)) {\n-      throw new Error(`Expected named ClassDeclaration: ${nodeDebugInfo(node)}`);\n-    }\n-    const specifier = (from !== null && !from.startsWith('.') ? from : ngModuleImportedFrom);\n-    if (specifier !== null) {\n-      return new Reference(node, {specifier, resolutionContext});\n-    } else {\n-      return new Reference(node);\n-    }\n-  });\n+\n+  // TODO(alan-agius4): remove `def.elementTypes` and casts when TS 3.9 support is dropped and G3 is\n+  // using TS 4.0.\n+  return (((def as any).elements || (def as any).elementTypes) as ts.NodeArray<ts.TypeNode>)\n+      .map(element => {\n+        if (!ts.isTypeQueryNode(element)) {\n+          throw new Error(`Expected TypeQueryNode: ${nodeDebugInfo(element)}`);\n+        }\n+        const type = element.exprName;\n+        const {node, from} = reflectTypeEntityToDeclaration(type, checker);\n+        if (!isNamedClassDeclaration(node)) {\n+          throw new Error(`Expected named ClassDeclaration: ${nodeDebugInfo(node)}`);\n+        }\n+        const specifier = (from !== null && !from.startsWith('.') ? from : ngModuleImportedFrom);\n+        if (specifier !== null) {\n+          return new Reference(node, {specifier, resolutionContext});\n+        } else {\n+          return new Reference(node);\n+        }\n+      });\n }\n \n export function readStringType(type: ts.TypeNode): string|null {\n@@ -69,12 +73,15 @@ export function readStringArrayType(type: ts.TypeNode): string[] {\n     return [];\n   }\n   const res: string[] = [];\n-  type.elementTypes.forEach(el => {\n-    if (!ts.isLiteralTypeNode(el) || !ts.isStringLiteral(el.literal)) {\n-      return;\n-    }\n-    res.push(el.literal.text);\n-  });\n+  // TODO(alan-agius4): remove `def.elementTypes` and casts when TS 3.9 support is dropped and G3 is\n+  // using TS 4.0.\n+  (((type as any).elements || (type as any).elementTypes) as ts.NodeArray<ts.TypeNode>)\n+      .forEach(el => {\n+        if (!ts.isLiteralTypeNode(el) || !ts.isStringLiteral(el.literal)) {\n+          return;\n+        }\n+        res.push(el.literal.text);\n+      });\n   return res;\n }\n "
        },
        {
            "sha": "85be99477c5fbbb0a7e5ea3cb0ab6286cb851c14",
            "filename": "packages/compiler-cli/src/ngtsc/reflection/src/typescript.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Ftypescript.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Ftypescript.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Ftypescript.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -64,7 +64,11 @@ export class TypeScriptReflectionHost implements ReflectionHost {\n       // optional tokes that don't have providers.\n       if (typeNode && ts.isUnionTypeNode(typeNode)) {\n         let childTypeNodes = typeNode.types.filter(\n-            childTypeNode => childTypeNode.kind !== ts.SyntaxKind.NullKeyword);\n+            // TODO(alan-agius4): remove `childTypeNode.kind !== ts.SyntaxKind.NullKeyword` when\n+            // TS 3.9 support is dropped. In TS 4.0 NullKeyword is a child of LiteralType.\n+            childTypeNode => childTypeNode.kind !== ts.SyntaxKind.NullKeyword &&\n+                !(ts.isLiteralTypeNode(childTypeNode) &&\n+                  childTypeNode.literal.kind === ts.SyntaxKind.NullKeyword));\n \n         if (childTypeNodes.length === 1) {\n           typeNode = childTypeNodes[0];"
        },
        {
            "sha": "6746a8e0d20cba0e327eebf3956a3d83476277c8",
            "filename": "packages/compiler-cli/src/ngtsc/shims/src/factory_generator.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fshims%2Fsrc%2Ffactory_generator.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fshims%2Fsrc%2Ffactory_generator.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fshims%2Fsrc%2Ffactory_generator.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -128,8 +128,6 @@ function transformFactorySourceFile(\n \n   const {moduleSymbols, sourceFilePath} = factoryMap.get(file.fileName)!;\n \n-  file = ts.getMutableClone(file);\n-\n   // Not every exported factory statement is valid. They were generated before the program was\n   // analyzed, and before ngtsc knew which symbols were actually NgModules. factoryMap contains\n   // that knowledge now, so this transform filters the statement list and removes exported factories\n@@ -221,7 +219,8 @@ function transformFactorySourceFile(\n     // satisfy closure compiler.\n     transformedStatements.push(nonEmptyExport);\n   }\n-  file.statements = ts.createNodeArray(transformedStatements);\n+\n+  file = ts.updateSourceFileNode(file, transformedStatements);\n \n   // If any imports to @angular/core were detected and rewritten (which happens when compiling\n   // @angular/core), go through the SourceFile and rewrite references to symbols imported from core."
        },
        {
            "sha": "aa8897d74cbe6e65b215c27ea1f87b586addcfe0",
            "filename": "packages/compiler-cli/src/ngtsc/switch/src/switch.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fswitch%2Fsrc%2Fswitch.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fswitch%2Fsrc%2Fswitch.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fswitch%2Fsrc%2Fswitch.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -42,8 +42,7 @@ function flipIvySwitchInFile(sf: ts.SourceFile): ts.SourceFile {\n \n   // Only update the statements in the SourceFile if any have changed.\n   if (newStatements !== undefined) {\n-    sf = ts.getMutableClone(sf);\n-    sf.statements = ts.createNodeArray(newStatements);\n+    return ts.updateSourceFileNode(sf, newStatements);\n   }\n   return sf;\n }\n@@ -105,7 +104,7 @@ function flipIvySwitchesInVariableStatement(\n \n     // Find the post-switch variable identifier. If one can't be found, it's an error. This is\n     // reported as a thrown error and not a diagnostic as transformers cannot output diagnostics.\n-    let newIdentifier = findPostSwitchIdentifier(statements, postSwitchName);\n+    const newIdentifier = findPostSwitchIdentifier(statements, postSwitchName);\n     if (newIdentifier === null) {\n       throw new Error(`Unable to find identifier ${postSwitchName} in ${\n           stmt.getSourceFile().fileName} for the Ivy switch.`);"
        },
        {
            "sha": "a5ba308a92586fe595f94449dba94a92713201d0",
            "filename": "packages/compiler-cli/src/ngtsc/transform/src/alias.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Falias.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Falias.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Falias.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -28,9 +28,7 @@ export function aliasTransformFactory(exportStatements: Map<string, Map<string,\n         statements.push(stmt);\n       });\n \n-      file = ts.getMutableClone(file);\n-      file.statements = ts.createNodeArray(statements);\n-      return file;\n+      return ts.updateSourceFileNode(file, statements);\n     };\n   };\n }"
        },
        {
            "sha": "acc757c6e6d1fe56268be6d64c4c47ede192c3f4",
            "filename": "packages/compiler-cli/src/ngtsc/transform/src/declaration.ts",
            "status": "modified",
            "additions": 38,
            "deletions": 22,
            "changes": 60,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Fdeclaration.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Fdeclaration.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Fdeclaration.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -239,32 +239,48 @@ export class ReturnTypeTransform implements DtsTransform {\n   }\n \n   transformClassElement(element: ts.ClassElement, imports: ImportManager): ts.ClassElement {\n-    if (!ts.isMethodSignature(element)) {\n-      return element;\n-    }\n-\n-    const original = ts.getOriginalNode(element) as ts.MethodDeclaration;\n-    if (!this.typeReplacements.has(original)) {\n-      return element;\n+    // // TODO(alan-agius4): Remove when we no longer support TS 3.9\n+    // TS <= 3.9\n+    if (ts.isMethodSignature(element)) {\n+      const original = ts.getOriginalNode(element) as ts.MethodDeclaration;\n+      if (!this.typeReplacements.has(original)) {\n+        return element;\n+      }\n+      const returnType = this.typeReplacements.get(original)!;\n+      const tsReturnType = translateType(returnType, imports);\n+      const methodSignature = ts.updateMethodSignature(\n+          /* node */ element,\n+          /* typeParameters */ element.typeParameters,\n+          /* parameters */ element.parameters,\n+          /* type */ tsReturnType,\n+          /* name */ element.name,\n+          /* questionToken */ element.questionToken);\n+\n+      // Copy over any modifiers, these cannot be set during the `ts.updateMethodSignature` call.\n+      (methodSignature.modifiers as ts.ModifiersArray | undefined) = element.modifiers;\n+\n+      // A bug in the TypeScript declaration causes `ts.MethodSignature` not to be assignable to\n+      // `ts.ClassElement`. Since `element` was a `ts.MethodSignature` already, transforming it into\n+      // this type is actually correct.\n+      return methodSignature as unknown as ts.ClassElement;\n     }\n-    const returnType = this.typeReplacements.get(original)!;\n-    const tsReturnType = translateType(returnType, imports);\n \n-    const methodSignature = ts.updateMethodSignature(\n-        /* node */ element,\n-        /* typeParameters */ element.typeParameters,\n-        /* parameters */ element.parameters,\n-        /* type */ tsReturnType,\n-        /* name */ element.name,\n-        /* questionToken */ element.questionToken);\n+    // TS 4.0 +\n+    if (ts.isMethodDeclaration(element)) {\n+      const original = ts.getOriginalNode(element, ts.isMethodDeclaration);\n+      if (!this.typeReplacements.has(original)) {\n+        return element;\n+      }\n+      const returnType = this.typeReplacements.get(original)!;\n+      const tsReturnType = translateType(returnType, imports);\n \n-    // Copy over any modifiers, these cannot be set during the `ts.updateMethodSignature` call.\n-    methodSignature.modifiers = element.modifiers;\n+      return ts.updateMethod(\n+          element, element.decorators, element.modifiers, element.asteriskToken, element.name,\n+          element.questionToken, element.typeParameters, element.parameters, tsReturnType,\n+          element.body);\n+    }\n \n-    // A bug in the TypeScript declaration causes `ts.MethodSignature` not to be assignable to\n-    // `ts.ClassElement`. Since `element` was a `ts.MethodSignature` already, transforming it into\n-    // this type is actually correct.\n-    return methodSignature as unknown as ts.ClassElement;\n+    return element;\n   }\n \n   transformFunctionDeclaration(element: ts.FunctionDeclaration, imports: ImportManager):"
        },
        {
            "sha": "b93af50e39480b6ef31439de4627fbb710ac134a",
            "filename": "packages/compiler-cli/src/ngtsc/transform/src/transform.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Ftransform.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Ftransform.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Ftransform.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -187,8 +187,8 @@ class IvyTransformationVisitor extends Visitor {\n \n     // Create a new `NodeArray` with the filtered decorators that sourcemaps back to the original.\n     const array = ts.createNodeArray(filtered);\n-    array.pos = node.decorators.pos;\n-    array.end = node.decorators.end;\n+    (array.pos as number) = node.decorators.pos;\n+    (array.end as number) = node.decorators.end;\n     return array;\n   }\n "
        },
        {
            "sha": "ddbdfe7397914592692f482c65ea850510a10bca",
            "filename": "packages/compiler-cli/src/ngtsc/transform/src/utils.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Futils.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Futils.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftransform%2Fsrc%2Futils.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -40,8 +40,9 @@ export function addImports(\n     // for @fileoverview Closure annotation. If there is no @fileoverview annotations, this\n     // statement would be a noop.\n     const fileoverviewAnchorStmt = ts.createNotEmittedStatement(sf);\n-    sf.statements = ts.createNodeArray(\n-        [fileoverviewAnchorStmt, ...existingImports, ...addedImports, ...extraStatements, ...body]);\n+    return ts.updateSourceFileNode(sf, ts.createNodeArray([\n+      fileoverviewAnchorStmt, ...existingImports, ...addedImports, ...extraStatements, ...body\n+    ]));\n   }\n \n   return sf;"
        },
        {
            "sha": "195cae9f67009a0a90eff795fdb8c28d41b1ae5d",
            "filename": "packages/compiler-cli/src/ngtsc/translator/src/translator.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftranslator%2Fsrc%2Ftranslator.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftranslator%2Fsrc%2Ftranslator.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftranslator%2Fsrc%2Ftranslator.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -526,7 +526,11 @@ export class TypeTranslatorVisitor implements ExpressionVisitor, TypeVisitor {\n \n   visitLiteralExpr(ast: LiteralExpr, context: Context): ts.TypeNode {\n     if (ast.value === null) {\n-      return ts.createKeywordTypeNode(ts.SyntaxKind.NullKeyword);\n+      // TODO(alan-agius4): Remove when we no longer support TS 3.9\n+      // Use: return ts.createLiteralTypeNode(ts.createNull()) directly.\n+      return ts.versionMajorMinor.charAt(0) === '4' ?\n+          ts.createLiteralTypeNode(ts.createNull() as any) :\n+          ts.createKeywordTypeNode(ts.SyntaxKind.NullKeyword as any);\n     } else if (ast.value === undefined) {\n       return ts.createKeywordTypeNode(ts.SyntaxKind.UndefinedKeyword);\n     } else if (typeof ast.value === 'boolean') {\n@@ -696,15 +700,15 @@ function createLocalizedStringTaggedTemplate(\n // Revert once https://github.com/microsoft/TypeScript/issues/35374 is fixed\n function createTemplateMiddle(cooked: string, raw: string): ts.TemplateMiddle {\n   const node: ts.TemplateLiteralLikeNode = ts.createTemplateHead(cooked, raw);\n-  node.kind = ts.SyntaxKind.TemplateMiddle;\n+  (node.kind as ts.SyntaxKind) = ts.SyntaxKind.TemplateMiddle;\n   return node as ts.TemplateMiddle;\n }\n \n // HACK: Use this in place of `ts.createTemplateTail()`.\n // Revert once https://github.com/microsoft/TypeScript/issues/35374 is fixed\n function createTemplateTail(cooked: string, raw: string): ts.TemplateTail {\n   const node: ts.TemplateLiteralLikeNode = ts.createTemplateHead(cooked, raw);\n-  node.kind = ts.SyntaxKind.TemplateTail;\n+  (node.kind as ts.SyntaxKind) = ts.SyntaxKind.TemplateTail;\n   return node as ts.TemplateTail;\n }\n "
        },
        {
            "sha": "794cd2475da9cef5e4903f87bea8e1d1187109d3",
            "filename": "packages/compiler-cli/src/ngtsc/typecheck/src/type_emitter.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fsrc%2Ftype_emitter.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fsrc%2Ftype_emitter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Fsrc%2Ftype_emitter.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -36,6 +36,7 @@ export function canEmitType(type: ts.TypeNode, resolver: TypeReferenceResolver):\n       visitTypeReferenceNode: type => canEmitTypeReference(type),\n       visitArrayTypeNode: type => canEmitTypeWorker(type.elementType),\n       visitKeywordType: () => true,\n+      visitLiteralType: () => true,\n       visitOtherType: () => false,\n     });\n   }\n@@ -111,6 +112,7 @@ export class TypeEmitter {\n       visitTypeReferenceNode: type => this.emitTypeReference(type),\n       visitArrayTypeNode: type => ts.updateArrayTypeNode(type, this.emitType(type.elementType)),\n       visitKeywordType: type => type,\n+      visitLiteralType: type => type,\n       visitOtherType: () => {\n         throw new Error('Unable to emit a complex type');\n       },\n@@ -159,6 +161,7 @@ interface TypeEmitterVisitor<R> {\n   visitTypeReferenceNode(type: ts.TypeReferenceNode): R;\n   visitArrayTypeNode(type: ts.ArrayTypeNode): R;\n   visitKeywordType(type: ts.KeywordTypeNode): R;\n+  visitLiteralType(type: ts.LiteralTypeNode): R;\n   visitOtherType(type: ts.TypeNode): R;\n }\n \n@@ -167,6 +170,8 @@ function visitTypeNode<R>(type: ts.TypeNode, visitor: TypeEmitterVisitor<R>): R\n     return visitor.visitTypeReferenceNode(type);\n   } else if (ts.isArrayTypeNode(type)) {\n     return visitor.visitArrayTypeNode(type);\n+  } else if (ts.isLiteralTypeNode(type)) {\n+    return visitor.visitLiteralType(type);\n   }\n \n   switch (type.kind) {"
        },
        {
            "sha": "5838f2fc8e1a5b2ec391baf8047e6b6d9a269cdb",
            "filename": "packages/compiler-cli/src/ngtsc/typecheck/test/diagnostics_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Ftest%2Fdiagnostics_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Ftest%2Fdiagnostics_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Ftest%2Fdiagnostics_spec.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -456,7 +456,7 @@ class TestComponent {\n         }`);\n \n       expect(messages).toEqual(\n-          [`TestComponent.html(1, 15): Type '2' is not assignable to type 'string'.`]);\n+          [`TestComponent.html(1, 15): Type 'number' is not assignable to type 'string'.`]);\n     });\n   });\n });"
        },
        {
            "sha": "97a0465b0a13808ae10796a29caf665370d5d85b",
            "filename": "packages/compiler-cli/src/transformers/downlevel_decorators_transform.ts",
            "status": "modified",
            "additions": 24,
            "deletions": 14,
            "changes": 38,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Ftransformers%2Fdownlevel_decorators_transform.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Ftransformers%2Fdownlevel_decorators_transform.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Ftransformers%2Fdownlevel_decorators_transform.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -140,10 +140,16 @@ function createCtorParametersClassPropertyType(): ts.TypeNode {\n             undefined),\n       ])),\n       undefined));\n-  return ts.createFunctionTypeNode(\n-      undefined, [],\n-      ts.createArrayTypeNode(\n-          ts.createUnionTypeNode([ts.createTypeLiteralNode(typeElements), ts.createNull()])));\n+\n+  // TODO(alan-agius4): Remove when we no longer support TS 3.9\n+  const nullLiteral = ts.createNull() as any;\n+  const nullType = ts.versionMajorMinor.charAt(0) === '4' ?\n+      ts.createLiteralTypeNode(nullLiteral as any) :\n+      nullLiteral;\n+  return ts.createFunctionTypeNode(undefined, [], ts.createArrayTypeNode(ts.createUnionTypeNode([\n+    ts.createTypeLiteralNode(typeElements),\n+    nullType,\n+  ])));\n }\n \n /**\n@@ -287,8 +293,13 @@ function typeReferenceToExpression(\n       // Ignore any generic types, just return the base type.\n       return entityNameToExpression(typeRef.typeName);\n     case ts.SyntaxKind.UnionType:\n+      // TODO(alan-agius4): remove `t.kind !== ts.SyntaxKind.NullKeyword` when\n+      // TS 3.9 support is dropped. In TS 4.0 NullKeyword is a child of LiteralType.\n       const childTypeNodes =\n-          (node as ts.UnionTypeNode).types.filter(t => t.kind !== ts.SyntaxKind.NullKeyword);\n+          (node as ts.UnionTypeNode)\n+              .types.filter(\n+                  t => t.kind !== ts.SyntaxKind.NullKeyword &&\n+                      !(ts.isLiteralTypeNode(t) && t.literal.kind === ts.SyntaxKind.NullKeyword));\n       return childTypeNodes.length === 1 ?\n           typeReferenceToExpression(entityNameToExpression, childTypeNodes[0]) :\n           undefined;\n@@ -434,7 +445,7 @@ export function getDownlevelDecoratorsTransform(\n \n       const name = (element.name as ts.Identifier).text;\n       const mutable = ts.getMutableClone(element);\n-      mutable.decorators = decoratorsToKeep.length ?\n+      (mutable as any).decorators = decoratorsToKeep.length ?\n           ts.setTextRange(ts.createNodeArray(decoratorsToKeep), mutable.decorators) :\n           undefined;\n       return [name, mutable, toLower];\n@@ -551,8 +562,6 @@ export function getDownlevelDecoratorsTransform(\n         }\n       }\n \n-      const newClassDeclaration = ts.getMutableClone(classDecl);\n-\n       if (decoratorsToLower.length) {\n         newMembers.push(createDecoratorClassProperty(decoratorsToLower));\n       }\n@@ -567,12 +576,13 @@ export function getDownlevelDecoratorsTransform(\n       if (decoratedProperties.size) {\n         newMembers.push(createPropDecoratorsClassProperty(diagnostics, decoratedProperties));\n       }\n-      newClassDeclaration.members = ts.setTextRange(\n-          ts.createNodeArray(newMembers, newClassDeclaration.members.hasTrailingComma),\n-          classDecl.members);\n-      newClassDeclaration.decorators =\n-          decoratorsToKeep.length ? ts.createNodeArray(decoratorsToKeep) : undefined;\n-      return newClassDeclaration;\n+\n+      const members = ts.setTextRange(\n+          ts.createNodeArray(newMembers, classDecl.members.hasTrailingComma), classDecl.members);\n+\n+      return ts.updateClassDeclaration(\n+          classDecl, decoratorsToKeep.length ? decoratorsToKeep : undefined, classDecl.modifiers,\n+          classDecl.name, classDecl.typeParameters, classDecl.heritageClauses, members);\n     }\n \n     /**"
        },
        {
            "sha": "8a5dc858e1cd88529e593e647e86036a905ff68d",
            "filename": "packages/compiler-cli/src/transformers/lower_expressions.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 11,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Ftransformers%2Flower_expressions.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Ftransformers%2Flower_expressions.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Ftransformers%2Flower_expressions.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -167,14 +167,13 @@ function transformSourceFile(\n \n       newStatements = tmpStatements;\n     }\n-    // Note: We cannot use ts.updateSourcefile here as\n-    // it does not work well with decorators.\n-    // See https://github.com/Microsoft/TypeScript/issues/17384\n-    const newSf = ts.getMutableClone(sourceFile);\n+\n+    const newSf = ts.updateSourceFileNode(\n+        sourceFile, ts.setTextRange(ts.createNodeArray(newStatements), sourceFile.statements));\n     if (!(sourceFile.flags & ts.NodeFlags.Synthesized)) {\n-      newSf.flags &= ~ts.NodeFlags.Synthesized;\n+      (newSf.flags as ts.NodeFlags) &= ~ts.NodeFlags.Synthesized;\n     }\n-    newSf.statements = ts.setTextRange(ts.createNodeArray(newStatements), sourceFile.statements);\n+\n     return newSf;\n   }\n \n@@ -209,11 +208,6 @@ export interface RequestsMap {\n   getRequests(sourceFile: ts.SourceFile): RequestLocationMap;\n }\n \n-interface MetadataAndLoweringRequests {\n-  metadata: ModuleMetadata|undefined;\n-  requests: RequestLocationMap;\n-}\n-\n function isEligibleForLowering(node: ts.Node|undefined): boolean {\n   if (node) {\n     switch (node.kind) {"
        },
        {
            "sha": "c3e41650364ee73ebd4fecd8e41fe3ae03580ae7",
            "filename": "packages/compiler-cli/src/typescript_support.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Ftypescript_support.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Fsrc%2Ftypescript_support.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Ftypescript_support.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -19,7 +19,7 @@ const MIN_TS_VERSION = '3.9.2';\n  * âˆ€ supported typescript version v, v < MAX_TS_VERSION\n  * MAX_TS_VERSION is not considered as a supported TypeScript version\n  */\n-const MAX_TS_VERSION = '4.0.0';\n+const MAX_TS_VERSION = '4.1.0';\n \n /**\n  * The currently used version of TypeScript, which can be adjusted for testing purposes using"
        },
        {
            "sha": "13fff9ad356e395971286ce45d066e705ac84c2d",
            "filename": "packages/compiler-cli/test/diagnostics/check_types_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Ftest%2Fdiagnostics%2Fcheck_types_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Ftest%2Fdiagnostics%2Fcheck_types_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fdiagnostics%2Fcheck_types_spec.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -787,7 +787,7 @@ describe('ng type checker', () => {\n     it('should report an invalid call to a pipe', () => {\n       rejectOnlyWithFullTemplateTypeCheck(\n           '<div>{{\"hello\" | aPipe}}</div>',\n-          `Argument of type '\"hello\"' is not assignable to parameter of type 'number'.`, '0:5');\n+          `Argument of type 'string' is not assignable to parameter of type 'number'.`, '0:5');\n     });\n     it('should report an invalid property on an exportAs directive', () => {\n       rejectOnlyWithFullTemplateTypeCheck("
        },
        {
            "sha": "63c6a168eb052d2e6239feb908b68bf994fb62f2",
            "filename": "packages/compiler-cli/test/ngtsc/template_typecheck_spec.ts",
            "status": "modified",
            "additions": 17,
            "deletions": 17,
            "changes": 34,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Ftemplate_typecheck_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Ftemplate_typecheck_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fngtsc%2Ftemplate_typecheck_spec.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -136,7 +136,7 @@ export declare class AnimationEvent {\n \n       const diags = env.driveDiagnostics();\n       expect(diags.length).toBe(1);\n-      expect(diags[0].messageText).toEqual(`Type '\"2\"' is not assignable to type 'number'.`);\n+      expect(diags[0].messageText).toEqual(`Type 'string' is not assignable to type 'number'.`);\n       // The reported error code should be in the TS error space, not a -99 \"NG\" code.\n       expect(diags[0].code).toBeGreaterThan(0);\n     });\n@@ -168,8 +168,8 @@ export declare class AnimationEvent {\n \n          const diags = env.driveDiagnostics();\n          expect(diags.length).toBe(2);\n-         expect(diags[0].messageText).toEqual(`Type '\"2\"' is not assignable to type 'number'.`);\n-         expect(diags[1].messageText).toEqual(`Type '\"2\"' is not assignable to type 'number'.`);\n+         expect(diags[0].messageText).toEqual(`Type 'string' is not assignable to type 'number'.`);\n+         expect(diags[1].messageText).toEqual(`Type 'string' is not assignable to type 'number'.`);\n        });\n \n     it('should support inputs and outputs with names that are not JavaScript identifiers', () => {\n@@ -204,7 +204,7 @@ export declare class AnimationEvent {\n \n       const diags = env.driveDiagnostics();\n       expect(diags.length).toBe(2);\n-      expect(diags[0].messageText).toEqual(`Type '2' is not assignable to type 'string'.`);\n+      expect(diags[0].messageText).toEqual(`Type 'number' is not assignable to type 'string'.`);\n       expect(diags[1].messageText)\n           .toEqual(`Argument of type 'string' is not assignable to parameter of type 'number'.`);\n     });\n@@ -380,7 +380,7 @@ export declare class AnimationEvent {\n \n         const diags = env.driveDiagnostics();\n         expect(diags.length).toBe(2);\n-        expect(diags[0].messageText).toEqual(`Type '1' is not assignable to type 'string'.`);\n+        expect(diags[0].messageText).toEqual(`Type 'number' is not assignable to type 'string'.`);\n         expect(diags[1].messageText)\n             .toEqual(`Property 'invalid' does not exist on type 'TestCmp'.`);\n       });\n@@ -390,7 +390,7 @@ export declare class AnimationEvent {\n \n         const diags = env.driveDiagnostics();\n         expect(diags.length).toBe(2);\n-        expect(diags[0].messageText).toEqual(`Type '1' is not assignable to type 'string'.`);\n+        expect(diags[0].messageText).toEqual(`Type 'number' is not assignable to type 'string'.`);\n         expect(diags[1].messageText)\n             .toEqual(`Property 'invalid' does not exist on type 'TestCmp'.`);\n       });\n@@ -716,17 +716,17 @@ export declare class AnimationEvent {\n \n         const diags = env.driveDiagnostics();\n         expect(diags.length).toBe(2);\n-        expect(diags[0].messageText).toEqual(`Type '\"\"' is not assignable to type 'boolean'.`);\n-        expect(diags[1].messageText).toEqual(`Type '\"3\"' is not assignable to type 'number'.`);\n+        expect(diags[0].messageText).toEqual(`Type 'string' is not assignable to type 'boolean'.`);\n+        expect(diags[1].messageText).toEqual(`Type 'string' is not assignable to type 'number'.`);\n       });\n \n       it('should produce an error for text attributes when overall strictness is enabled', () => {\n         env.tsconfig({strictTemplates: true});\n \n         const diags = env.driveDiagnostics();\n         expect(diags.length).toBe(2);\n-        expect(diags[0].messageText).toEqual(`Type '\"\"' is not assignable to type 'boolean'.`);\n-        expect(diags[1].messageText).toEqual(`Type '\"3\"' is not assignable to type 'number'.`);\n+        expect(diags[0].messageText).toEqual(`Type 'string' is not assignable to type 'boolean'.`);\n+        expect(diags[1].messageText).toEqual(`Type 'string' is not assignable to type 'number'.`);\n       });\n \n       it('should not produce an error for text attributes when not enabled', () => {\n@@ -1119,7 +1119,7 @@ export declare class AnimationEvent {\n       const allErrors = [\n         `'does_not_exist' does not exist on type '{ name: string; }'`,\n         `Expected 2 arguments, but got 3.`,\n-        `Argument of type '\"test\"' is not assignable to parameter of type 'number'`,\n+        `Argument of type 'string' is not assignable to parameter of type 'number'`,\n         `Argument of type '{ name: string; }' is not assignable to parameter of type 'unknown[]'`,\n       ];\n \n@@ -1241,11 +1241,11 @@ export declare class AnimationEvent {\n \n       const diags = env.driveDiagnostics();\n       expect(diags.length).toBe(3);\n-      expect(diags[0].messageText).toBe(`Type 'true' is not assignable to type 'number'.`);\n+      expect(diags[0].messageText).toBe(`Type 'boolean' is not assignable to type 'number'.`);\n       expect(getSourceCodeForDiagnostic(diags[0])).toEqual('[fromAbstract]=\"true\"');\n-      expect(diags[1].messageText).toBe(`Type '3' is not assignable to type 'string'.`);\n+      expect(diags[1].messageText).toBe(`Type 'number' is not assignable to type 'string'.`);\n       expect(getSourceCodeForDiagnostic(diags[1])).toEqual('[fromBase]=\"3\"');\n-      expect(diags[2].messageText).toBe(`Type '4' is not assignable to type 'boolean'.`);\n+      expect(diags[2].messageText).toBe(`Type 'number' is not assignable to type 'boolean'.`);\n       expect(getSourceCodeForDiagnostic(diags[2])).toEqual('[fromChild]=\"4\"');\n     });\n \n@@ -1298,11 +1298,11 @@ export declare class AnimationEvent {\n \n       const diags = env.driveDiagnostics();\n       expect(diags.length).toBe(3);\n-      expect(diags[0].messageText).toBe(`Type 'true' is not assignable to type 'number'.`);\n+      expect(diags[0].messageText).toBe(`Type 'boolean' is not assignable to type 'number'.`);\n       expect(getSourceCodeForDiagnostic(diags[0])).toEqual('[fromAbstract]=\"true\"');\n-      expect(diags[1].messageText).toBe(`Type '3' is not assignable to type 'string'.`);\n+      expect(diags[1].messageText).toBe(`Type 'number' is not assignable to type 'string'.`);\n       expect(getSourceCodeForDiagnostic(diags[1])).toEqual('[fromBase]=\"3\"');\n-      expect(diags[2].messageText).toBe(`Type '4' is not assignable to type 'boolean'.`);\n+      expect(diags[2].messageText).toBe(`Type 'number' is not assignable to type 'boolean'.`);\n       expect(getSourceCodeForDiagnostic(diags[2])).toEqual('[fromChild]=\"4\"');\n     });\n "
        },
        {
            "sha": "daf5d946a0515c7f0a62723665ebc3456c61971e",
            "filename": "packages/compiler-cli/test/transformers/downlevel_decorators_transform_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Ftest%2Ftransformers%2Fdownlevel_decorators_transform_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Ftest%2Ftransformers%2Fdownlevel_decorators_transform_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Ftransformers%2Fdownlevel_decorators_transform_spec.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -584,7 +584,7 @@ describe('downlevel decorator transform', () => {\n         const visitNode = (node: ts.Node): ts.Node => {\n           if (ts.isClassDeclaration(node) || ts.isClassElement(node)) {\n             const cloned = ts.getMutableClone(node);\n-            cloned.decorators = undefined;\n+            (cloned.decorators as undefined) = undefined;\n             return cloned;\n           }\n           return ts.visitEachChild(node, visitNode, context);"
        },
        {
            "sha": "683612d72351afffa42f64439f1509498d9f98d8",
            "filename": "packages/compiler-cli/test/transformers/program_spec.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 5,
            "changes": 13,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Ftest%2Ftransformers%2Fprogram_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcompiler-cli%2Ftest%2Ftransformers%2Fprogram_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Ftransformers%2Fprogram_spec.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -492,11 +492,11 @@ describe('ng program', () => {\n           .toBe(true);\n       switch (checks.shouldBe) {\n         case ShouldBe.Empty:\n-          expect(writeData!.data).toMatch(/^(\\s*\\/\\*([^*]|\\*[^/])*\\*\\/\\s*)?$/);\n+          expect(writeData!.data).toMatch(/^(\\s*\\/\\*([^*]|\\*[^\\/])*\\*\\/\\s*)?$/);\n           break;\n         case ShouldBe.EmptyExport:\n           expect(writeData!.data)\n-              .toMatch(/^((\\s*\\/\\*([^*]|\\*[^/])*\\*\\/\\s*)|(\\s*export\\s*{\\s*}\\s*;\\s*)|())$/);\n+              .toMatch(/^((\\s*\\/\\*([^*]|\\*[^\\/])*\\*\\/\\s*)|(\\s*export\\s*{\\s*};\\s*))$/m);\n           break;\n         case ShouldBe.NoneEmpty:\n           expect(writeData!.data).not.toBe('');\n@@ -505,12 +505,14 @@ describe('ng program', () => {\n     }\n \n     assertGenFile(\n-        'built/src/util.ngfactory.js', {originalFileName: 'src/util.ts', shouldBe: ShouldBe.Empty});\n+        'built/src/util.ngfactory.js',\n+        {originalFileName: 'src/util.ts', shouldBe: ShouldBe.EmptyExport});\n     assertGenFile(\n         'built/src/util.ngfactory.d.ts',\n         {originalFileName: 'src/util.ts', shouldBe: ShouldBe.EmptyExport});\n     assertGenFile(\n-        'built/src/util.ngsummary.js', {originalFileName: 'src/util.ts', shouldBe: ShouldBe.Empty});\n+        'built/src/util.ngsummary.js',\n+        {originalFileName: 'src/util.ts', shouldBe: ShouldBe.EmptyExport});\n     assertGenFile(\n         'built/src/util.ngsummary.d.ts',\n         {originalFileName: 'src/util.ts', shouldBe: ShouldBe.EmptyExport});\n@@ -987,7 +989,8 @@ describe('ng program', () => {\n     const errorDiags =\n         program1.emit().diagnostics.filter(d => d.category === ts.DiagnosticCategory.Error);\n     expect(stripAnsi(formatDiagnostics(errorDiags)))\n-        .toContain(`src/main.ts:5:13 - error TS2322: Type '1' is not assignable to type 'string'.`);\n+        .toContain(\n+            `src/main.ts:5:13 - error TS2322: Type 'number' is not assignable to type 'string'.`);\n     expect(stripAnsi(formatDiagnostics(errorDiags)))\n         .toContain(\n             `src/main.html:1:1 - error TS100: Property 'nonExistent' does not exist on type 'MyComp'.`);"
        },
        {
            "sha": "bf4ad3bf80c2a4257ef276b67d85f8245ad1e3a7",
            "filename": "packages/core/schematics/utils/tslint/tslint_html_source_file.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcore%2Fschematics%2Futils%2Ftslint%2Ftslint_html_source_file.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fcore%2Fschematics%2Futils%2Ftslint%2Ftslint_html_source_file.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fschematics%2Futils%2Ftslint%2Ftslint_html_source_file.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -17,7 +17,7 @@ export function createHtmlSourceFile(filePath: string, content: string): ts.Sour\n \n   // Subtract two characters because the string literal quotes are only needed for parsing\n   // and are not part of the actual source file.\n-  sourceFile.end = sourceFile.end - 2;\n+  (sourceFile.end as number) = sourceFile.end - 2;\n \n   // Note: This does not affect the way TSLint applies replacements for external resource files.\n   // At the time of writing, TSLint loads files manually if the actual rule source file is not"
        },
        {
            "sha": "6c29a45a7d4fcada35946f74563b0a6c6c09ebab",
            "filename": "packages/elements/src/create-custom-element.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Felements%2Fsrc%2Fcreate-custom-element.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Felements%2Fsrc%2Fcreate-custom-element.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Felements%2Fsrc%2Fcreate-custom-element.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -45,8 +45,7 @@ export abstract class NgElement extends HTMLElement {\n   /**\n    * The strategy that controls how a component is transformed in a custom element.\n    */\n-  // TODO(issue/24571): remove '!'.\n-  protected ngElementStrategy!: NgElementStrategy;\n+  protected abstract ngElementStrategy: NgElementStrategy;\n   /**\n    * A subscription to change, connect, and disconnect events in the custom element.\n    */"
        },
        {
            "sha": "4412a1e5ac0cc6fbb7daf95ac1114e38bf695c97",
            "filename": "packages/language-service/src/typescript_symbols.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Flanguage-service%2Fsrc%2Ftypescript_symbols.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Flanguage-service%2Fsrc%2Ftypescript_symbols.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Fsrc%2Ftypescript_symbols.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -849,7 +849,7 @@ function getTsTypeFromBuiltinType(builtinType: BuiltinType, ctx: TypeContext): t\n           `Internal error, unhandled literal kind ${builtinType}:${BuiltinType[builtinType]}`);\n   }\n   const node = ts.createNode(syntaxKind);\n-  node.parent = ts.createEmptyStatement();\n+  (node.parent as ts.Node) = ts.createEmptyStatement();\n   return ctx.checker.getTypeAtLocation(node);\n }\n "
        },
        {
            "sha": "a57b9af93092482b31603cc6ce8c0553e290b2eb",
            "filename": "packages/language-service/test/ts_plugin_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Flanguage-service%2Ftest%2Fts_plugin_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Flanguage-service%2Ftest%2Fts_plugin_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flanguage-service%2Ftest%2Fts_plugin_spec.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -50,7 +50,7 @@ describe('plugin', () => {\n     const diags = plugin.getSemanticDiagnostics(fileName);\n     expect(diags.length).toBe(1);\n     expect(diags[0].messageText)\n-        .toBe(`Argument of type '\"hello\"' is not assignable to parameter of type 'number'.`);\n+        .toBe(`Argument of type 'string' is not assignable to parameter of type 'number'.`);\n   });\n \n   it('should not report TypeScript errors on tour of heroes', () => {"
        },
        {
            "sha": "d8bc23fd30cb08d1cb3512b5de8a5cf99429ba62",
            "filename": "packages/router/src/router.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Frouter%2Fsrc%2Frouter.ts",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Frouter%2Fsrc%2Frouter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Frouter.ts?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -33,7 +33,6 @@ import {Checks, getAllRouteGuards} from './utils/preactivation';\n import {isUrlTree} from './utils/type_guards';\n \n \n-\n /**\n  * @description\n  *\n@@ -922,7 +921,7 @@ export class Router {\n             const {source, state, urlTree} = currentChange;\n             const extras: NavigationExtras = {replaceUrl: true};\n             if (state) {\n-              const stateCopy = {...state};\n+              const stateCopy = {...state} as Partial<RestoredState>;\n               delete stateCopy.navigationId;\n               if (Object.keys(stateCopy).length !== 0) {\n                 extras.state = stateCopy;"
        },
        {
            "sha": "a5ad328a58290ff71f9c5309377b03cad817dac4",
            "filename": "packages/zone.js/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fzone.js%2Fpackage.json",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/packages%2Fzone.js%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fzone.js%2Fpackage.json?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -16,7 +16,7 @@\n     \"mocha\": \"^3.1.2\",\n     \"mock-require\": \"3.0.3\",\n     \"promises-aplus-tests\": \"^2.1.2\",\n-    \"typescript\": \"^3.8.3\"\n+    \"typescript\": \"4.0.2\"\n   },\n   \"scripts\": {\n     \"electrontest\": \"cd test/extra && node electron.js\","
        },
        {
            "sha": "4df0b9840e5c76b149589cc004f13bbdeab3ed27",
            "filename": "tools/ts-api-guardian/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/tools%2Fts-api-guardian%2Fpackage.json",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/tools%2Fts-api-guardian%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/tools%2Fts-api-guardian%2Fpackage.json?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -33,7 +33,7 @@\n     \"chai\": \"^4.1.2\",\n     \"jasmine\": \"^3.1.0\",\n     \"source-map-support\": \"^0.5.9\",\n-    \"typescript\": \"~3.9.5\"\n+    \"typescript\": \"4.0.2\"\n   },\n   \"repository\": {},\n   \"keywords\": ["
        },
        {
            "sha": "6fbef7c4c0e2438a7762b2746803896f0c798ee9",
            "filename": "yarn.lock",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/yarn.lock",
            "raw_url": "https://github.com/angular/angular/raw/0fc44e0436fdcbcb43057c57ee38fadb670ac4ad/yarn.lock",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/yarn.lock?ref=0fc44e0436fdcbcb43057c57ee38fadb670ac4ad",
            "patch": "@@ -15329,10 +15329,10 @@ typescript@~3.7.2:\n   resolved \"https://registry.yarnpkg.com/typescript/-/typescript-3.7.5.tgz#0692e21f65fd4108b9330238aac11dd2e177a1ae\"\n   integrity sha512-/P5lkRXkWHNAbcJIiHPfRoKqyd7bsyCma1hZNUGfn20qm64T6ZBlrzprymeu918H+mB/0rIg2gGK/BXkhhYgBw==\n \n-typescript@~3.9.5:\n-  version \"3.9.5\"\n-  resolved \"https://registry.yarnpkg.com/typescript/-/typescript-3.9.5.tgz#586f0dba300cde8be52dd1ac4f7e1009c1b13f36\"\n-  integrity sha512-hSAifV3k+i6lEoCJ2k6R2Z/rp/H3+8sdmcn5NrS3/3kE7+RyZXm9aqvxWqjEXHAd8b0pShatpcdMTvEdvAJltQ==\n+typescript@~4.0.2:\n+  version \"4.0.2\"\n+  resolved \"https://registry.yarnpkg.com/typescript/-/typescript-4.0.2.tgz#7ea7c88777c723c681e33bf7988be5d008d05ac2\"\n+  integrity sha512-e4ERvRV2wb+rRZ/IQeb3jm2VxBsirQLpQhdxplZ2MEzGvDkkMmPglecnNDfSUBivMjP93vRbngYYDQqQ/78bcQ==\n \n uglify-js@^1.3.3:\n   version \"1.3.5\""
        }
    ],
    "stats": {
        "total": 456,
        "additions": 315,
        "deletions": 141
    }
}