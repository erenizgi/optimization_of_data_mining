{
    "author": "mgechev",
    "message": "feat(devtools): improve output formatting",
    "sha": "967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e",
    "files": [
        {
            "sha": "7cdc1716d03ac718e287cac8c27b2a72747887fe",
            "filename": "projects/ng-devtools-backend/src/lib/hooks/profiler/native.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fhooks%2Fprofiler%2Fnative.ts",
            "raw_url": "https://github.com/angular/angular/raw/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fhooks%2Fprofiler%2Fnative.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools-backend%2Fsrc%2Flib%2Fhooks%2Fprofiler%2Fnative.ts?ref=967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e",
            "patch": "@@ -23,14 +23,14 @@ export class NgProfiler extends Profiler {\n     this._initialize();\n   }\n \n-  private _initialize() {\n+  private _initialize(): void {\n     const ng = (window as any).ng;\n     ng.ɵsetProfiler((event: ɵProfilerEvent, instanceOrLView: {}, hookOrListener: any) =>\n       this._callbacks.forEach((cb) => cb(event, instanceOrLView, hookOrListener))\n     );\n   }\n \n-  private _setProfilerCallback(callback: ProfilerCallback) {\n+  private _setProfilerCallback(callback: ProfilerCallback): void {\n     this._callbacks.push(callback);\n   }\n \n@@ -110,14 +110,14 @@ export class NgProfiler extends Profiler {\n     this._onLifecycleHookEnd(directive, lifecycleHookName, element, id, isComponent);\n   }\n \n-  [ɵProfilerEvent.OutputStart](componentOrDirective: any, listener: Function): void {\n+  [ɵProfilerEvent.OutputStart](componentOrDirective: any, listener: () => void): void {\n     const isComponent = !!this._tracker.isComponent.get(componentOrDirective);\n     const node = getDirectiveHostElement(componentOrDirective);\n     const id = this._tracker.getDirectiveId(componentOrDirective);\n     this._onOutputStart(componentOrDirective, listener.name, node, id, isComponent);\n   }\n \n-  [ɵProfilerEvent.OutputEnd](componentOrDirective: any, listener: Function): void {\n+  [ɵProfilerEvent.OutputEnd](componentOrDirective: any, listener: () => void): void {\n     const isComponent = !!this._tracker.isComponent.get(componentOrDirective);\n     const node = getDirectiveHostElement(componentOrDirective);\n     const id = this._tracker.getDirectiveId(componentOrDirective);"
        },
        {
            "sha": "8af844a9d3601f42cd5acce7de8a64588a023057",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/record-formatter/frame-merger.spec.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecord-formatter%2Fframe-merger.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecord-formatter%2Fframe-merger.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecord-formatter%2Fframe-merger.spec.ts?ref=967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e",
            "patch": "@@ -16,6 +16,7 @@ describe('mergeFrames', () => {\n               isComponent: false,\n               isElement: false,\n               lifecycle: {},\n+              outputs: {},\n               name: 'Foo',\n             },\n           ],\n@@ -42,6 +43,7 @@ describe('mergeFrames', () => {\n               isComponent: false,\n               isElement: false,\n               lifecycle: {},\n+              outputs: {},\n               changeDetection: 10,\n               name: 'Foo',\n             },\n@@ -62,6 +64,7 @@ describe('mergeFrames', () => {\n               isComponent: false,\n               isElement: false,\n               lifecycle: {},\n+              outputs: {},\n               changeDetection: 20,\n               name: 'Foo',\n             },\n@@ -83,6 +86,7 @@ describe('mergeFrames', () => {\n               isComponent: false,\n               isElement: false,\n               lifecycle: {},\n+              outputs: {},\n               changeDetection: 10,\n               name: 'Foo',\n             },\n@@ -104,6 +108,7 @@ describe('mergeFrames', () => {\n                   isComponent: false,\n                   isElement: false,\n                   lifecycle: {},\n+                  outputs: {},\n                   changeDetection: 10,\n                   name: 'Foo',\n                 },\n@@ -115,6 +120,7 @@ describe('mergeFrames', () => {\n               isComponent: false,\n               isElement: false,\n               lifecycle: {},\n+              outputs: {},\n               changeDetection: 10,\n               name: 'Foo',\n             },\n@@ -137,6 +143,7 @@ describe('mergeFrames', () => {\n                   isComponent: false,\n                   isElement: false,\n                   lifecycle: {},\n+                  outputs: {},\n                   changeDetection: 10,\n                   name: 'Foo',\n                 },\n@@ -148,6 +155,7 @@ describe('mergeFrames', () => {\n               isComponent: false,\n               isElement: false,\n               lifecycle: {},\n+              outputs: {},\n               changeDetection: 20,\n               name: 'Foo',\n             },"
        },
        {
            "sha": "d77021248c29d65e8f6d3b65fd145c6edc32660a",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/record-formatter/record-formatter-spec-constants.ts",
            "status": "modified",
            "additions": 36,
            "deletions": 2,
            "changes": 38,
            "blob_url": "https://github.com/angular/angular/blob/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecord-formatter%2Frecord-formatter-spec-constants.ts",
            "raw_url": "https://github.com/angular/angular/raw/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecord-formatter%2Frecord-formatter-spec-constants.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecord-formatter%2Frecord-formatter-spec-constants.ts?ref=967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e",
            "patch": "@@ -11,6 +11,7 @@ export const SIMPLE_RECORD = [\n             isElement: false,\n             name: 'TooltipDirective',\n             lifecycle: {},\n+            outputs: {},\n             changeDetection: 5,\n             changeDetected: true,\n           },\n@@ -19,6 +20,7 @@ export const SIMPLE_RECORD = [\n             isElement: false,\n             isComponent: true,\n             lifecycle: {},\n+            outputs: {},\n             name: 'TodoComponent',\n             changeDetected: true,\n           },\n@@ -32,6 +34,7 @@ export const SIMPLE_RECORD = [\n         name: 'NgForOf',\n         changeDetected: false,\n         lifecycle: { ngDoCheck: 7 },\n+        outputs: {},\n         changeDetection: 0,\n       },\n     ],\n@@ -98,13 +101,15 @@ export const NESTED_RECORD = [\n                                         isElement: false,\n                                         name: 'TooltipDirective',\n                                         lifecycle: {},\n+                                        outputs: {},\n                                         changeDetection: 0,\n                                       },\n                                       {\n                                         changeDetection: 0,\n                                         isElement: false,\n                                         isComponent: true,\n                                         lifecycle: {},\n+                                        outputs: {},\n                                         name: 'TodoComponent',\n                                       },\n                                     ],\n@@ -117,13 +122,15 @@ export const NESTED_RECORD = [\n                                         isElement: false,\n                                         name: 'TooltipDirective',\n                                         lifecycle: {},\n+                                        outputs: {},\n                                         changeDetection: 0,\n                                       },\n                                       {\n                                         changeDetection: 0,\n                                         isElement: false,\n                                         isComponent: true,\n                                         lifecycle: {},\n+                                        outputs: {},\n                                         name: 'TodoComponent',\n                                       },\n                                     ],\n@@ -136,13 +143,15 @@ export const NESTED_RECORD = [\n                                         isElement: false,\n                                         name: 'TooltipDirective',\n                                         lifecycle: {},\n+                                        outputs: {},\n                                         changeDetection: 0,\n                                       },\n                                       {\n                                         changeDetection: 0,\n                                         isElement: false,\n                                         isComponent: true,\n                                         lifecycle: {},\n+                                        outputs: {},\n                                         name: 'TodoComponent',\n                                       },\n                                     ],\n@@ -154,6 +163,7 @@ export const NESTED_RECORD = [\n                                     isElement: false,\n                                     name: 'NgForOf',\n                                     lifecycle: { ngDoCheck: 7 },\n+                                    outputs: {},\n                                     changeDetection: 0,\n                                   },\n                                 ],\n@@ -165,6 +175,7 @@ export const NESTED_RECORD = [\n                                 isElement: false,\n                                 isComponent: true,\n                                 lifecycle: {},\n+                                outputs: {},\n                                 name: 'TodosComponent',\n                               },\n                             ],\n@@ -176,6 +187,7 @@ export const NESTED_RECORD = [\n                             isElement: false,\n                             name: 'RouterOutlet',\n                             lifecycle: {},\n+                            outputs: {},\n                             changeDetection: 0,\n                           },\n                         ],\n@@ -187,13 +199,21 @@ export const NESTED_RECORD = [\n                         isElement: false,\n                         isComponent: true,\n                         lifecycle: {},\n+                        outputs: {},\n                         name: 'AppComponent',\n                       },\n                     ],\n                   },\n                 ],\n                 directives: [\n-                  { isComponent: false, isElement: false, name: 'RouterOutlet', lifecycle: {}, changeDetection: 0 },\n+                  {\n+                    isComponent: false,\n+                    isElement: false,\n+                    name: 'RouterOutlet',\n+                    lifecycle: {},\n+                    outputs: {},\n+                    changeDetection: 0,\n+                  },\n                 ],\n               },\n               {\n@@ -204,6 +224,7 @@ export const NESTED_RECORD = [\n                     isElement: false,\n                     isComponent: true,\n                     lifecycle: {},\n+                    outputs: {},\n                     name: 'HeavyComponent',\n                   },\n                 ],\n@@ -215,12 +236,22 @@ export const NESTED_RECORD = [\n                 isElement: false,\n                 isComponent: true,\n                 lifecycle: {},\n+                outputs: {},\n                 name: 'DemoAppComponent',\n               },\n             ],\n           },\n         ],\n-        directives: [{ isComponent: false, isElement: false, name: 'RouterOutlet', lifecycle: {}, changeDetection: 0 }],\n+        directives: [\n+          {\n+            isComponent: false,\n+            isElement: false,\n+            name: 'RouterOutlet',\n+            lifecycle: {},\n+            outputs: {},\n+            changeDetection: 0,\n+          },\n+        ],\n       },\n     ],\n     directives: [\n@@ -229,6 +260,7 @@ export const NESTED_RECORD = [\n         isElement: false,\n         isComponent: true,\n         lifecycle: {},\n+        outputs: {},\n         name: 'AppComponent',\n       },\n     ],\n@@ -241,6 +273,7 @@ export const NESTED_RECORD = [\n         isElement: true,\n         isComponent: true,\n         lifecycle: {},\n+        outputs: {},\n         name: 'ZippyComponent',\n       },\n     ],\n@@ -374,6 +407,7 @@ export const NESTED_FORMATTED_FLAMEGRAPH_RECORD: FlamegraphNode[] = [\n           isElement: true,\n           isComponent: true,\n           lifecycle: {},\n+          outputs: {},\n           name: 'ZippyComponent',\n         },\n       ],"
        },
        {
            "sha": "a19a8c888228869aee80b5372a886526fde16718",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/record-formatter/record-formatter.spec.ts",
            "status": "modified",
            "additions": 28,
            "deletions": 5,
            "changes": 33,
            "blob_url": "https://github.com/angular/angular/blob/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecord-formatter%2Frecord-formatter.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecord-formatter%2Frecord-formatter.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecord-formatter%2Frecord-formatter.spec.ts?ref=967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e",
            "patch": "@@ -73,6 +73,7 @@ describe('getLabel cases', () => {\n           isElement: false,\n           isComponent: true,\n           lifecycle: {},\n+          outputs: {},\n           name: 'AppComponent',\n         },\n       ],\n@@ -89,6 +90,7 @@ describe('getLabel cases', () => {\n           isElement: false,\n           name: 'RouterOutlet',\n           lifecycle: {},\n+          outputs: {},\n           changeDetection: 0,\n         },\n       ],\n@@ -100,8 +102,15 @@ describe('getLabel cases', () => {\n     element = {\n       children: [],\n       directives: [\n-        { isComponent: false, isElement: false, name: 'TooltipDirective', lifecycle: {}, changeDetection: 0 },\n-        { changeDetection: 0, isElement: false, isComponent: true, lifecycle: {}, name: 'TodoComponent' },\n+        {\n+          isComponent: false,\n+          isElement: false,\n+          name: 'TooltipDirective',\n+          lifecycle: {},\n+          outputs: {},\n+          changeDetection: 0,\n+        },\n+        { changeDetection: 0, isElement: false, isComponent: true, lifecycle: {}, outputs: {}, name: 'TodoComponent' },\n       ],\n     };\n     expect(formatter.getLabel(element)).toBe('TodoComponent[TooltipDirective]');\n@@ -111,9 +120,23 @@ describe('getLabel cases', () => {\n     element = {\n       children: [],\n       directives: [\n-        { isComponent: false, isElement: false, name: 'TooltipDirective', lifecycle: {}, changeDetection: 0 },\n-        { isComponent: false, isElement: false, name: 'RandomDirective', lifecycle: {}, changeDetection: 0 },\n-        { changeDetection: 0, isElement: false, isComponent: true, lifecycle: {}, name: 'TodoComponent' },\n+        {\n+          isComponent: false,\n+          isElement: false,\n+          name: 'TooltipDirective',\n+          lifecycle: {},\n+          outputs: {},\n+          changeDetection: 0,\n+        },\n+        {\n+          isComponent: false,\n+          isElement: false,\n+          name: 'RandomDirective',\n+          lifecycle: {},\n+          outputs: {},\n+          changeDetection: 0,\n+        },\n+        { changeDetection: 0, isElement: false, isComponent: true, lifecycle: {}, outputs: {}, name: 'TodoComponent' },\n       ],\n     };\n     expect(formatter.getLabel(element)).toBe('TodoComponent[TooltipDirective, RandomDirective]');"
        },
        {
            "sha": "4092e091445a089357fac4c6f594eae588be7262",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/recording-visualizer/bargraph-visualizer/bargraph-visualizer.component.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecording-visualizer%2Fbargraph-visualizer%2Fbargraph-visualizer.component.ts",
            "raw_url": "https://github.com/angular/angular/raw/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecording-visualizer%2Fbargraph-visualizer%2Fbargraph-visualizer.component.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecording-visualizer%2Fbargraph-visualizer%2Fbargraph-visualizer.component.ts?ref=967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e",
            "patch": "@@ -4,7 +4,7 @@ import { ProfilerFrame } from 'protocol';\n import { SelectedDirective, SelectedEntry } from '../timeline-visualizer.component';\n import { Theme, ThemeService } from 'projects/ng-devtools/src/lib/theme-service';\n import { Subscription } from 'rxjs';\n-import { formatDirectiveProfile } from '../formatter';\n+import { formatDirectiveProfile } from '../profile-formatter';\n \n @Component({\n   selector: 'ng-bargraph-visualizer',"
        },
        {
            "sha": "f370180f46359446f2d071473c2c7230c6567d08",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/recording-visualizer/flamegraph-visualizer/flamegraph-visualizer.component.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecording-visualizer%2Fflamegraph-visualizer%2Fflamegraph-visualizer.component.ts",
            "raw_url": "https://github.com/angular/angular/raw/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecording-visualizer%2Fflamegraph-visualizer%2Fflamegraph-visualizer.component.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecording-visualizer%2Fflamegraph-visualizer%2Fflamegraph-visualizer.component.ts?ref=967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e",
            "patch": "@@ -10,7 +10,7 @@ import { ProfilerFrame } from 'protocol';\n import { SelectedDirective, SelectedEntry } from '../timeline-visualizer.component';\n import { Theme, ThemeService } from 'projects/ng-devtools/src/lib/theme-service';\n import { Subscription } from 'rxjs';\n-import { formatDirectiveProfile } from '../formatter';\n+import { formatDirectiveProfile } from '../profile-formatter';\n \n @Component({\n   selector: 'ng-flamegraph-visualizer',"
        },
        {
            "sha": "8fae7849ab485a14c0b8ee7b31521f246134395e",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/recording-visualizer/profile-formatter.ts",
            "status": "renamed",
            "additions": 20,
            "deletions": 1,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecording-visualizer%2Fprofile-formatter.ts",
            "raw_url": "https://github.com/angular/angular/raw/967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecording-visualizer%2Fprofile-formatter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Frecording-visualizer%2Fprofile-formatter.ts?ref=967bd3cf8eebfbfc9302cd1b687b6500ad0c3b5e",
            "patch": "@@ -1,6 +1,25 @@\n import { DirectiveProfile } from 'protocol';\n import { SelectedDirective } from './timeline-visualizer.component';\n \n+const ignore = /^([A-Z]|listener|\\d|listener)/;\n+\n+const formatOutput = (outputName: string) => {\n+  const parts = outputName.split('_');\n+  const output: string[] = [];\n+  let idx = parts.length;\n+  while (idx >= 0) {\n+    idx--;\n+    if (ignore.test(parts[idx]) && parts[idx] !== 'HostBindingHandler') {\n+      continue;\n+    }\n+    output.push(parts[idx]);\n+  }\n+  return output\n+    .filter((el) => !!el)\n+    .reverse()\n+    .join('-');\n+};\n+\n export const formatDirectiveProfile = (nodes: DirectiveProfile[]) => {\n   const graphData: SelectedDirective[] = [];\n   nodes.forEach((node) => {\n@@ -22,7 +41,7 @@ export const formatDirectiveProfile = (nodes: DirectiveProfile[]) => {\n     Object.keys(node.outputs).forEach((key) => {\n       graphData.push({\n         directive: node.name,\n-        method: key,\n+        method: formatOutput(key),\n         value: +node.outputs[key].toFixed(2),\n       });\n     });",
            "previous_filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/recording-visualizer/formatter.ts"
        }
    ],
    "stats": {
        "total": 112,
        "additions": 98,
        "deletions": 14
    }
}