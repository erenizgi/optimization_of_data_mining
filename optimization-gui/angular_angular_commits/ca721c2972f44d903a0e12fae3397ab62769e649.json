{
    "author": "abarghoud",
    "message": "feat(core): more precise type for `APP_INITIALIZER` token (#40986)\n\nThis commit updates the type of the `APP_INITIALIZER` injection token to\nbetter document the expected types of values that Angular handles. Only\nPromises and Observables are awaited and other types of values are ignored,\nso the type of `APP_INITIALIZER` has been updated to\n`Promise<unknown> | Observable<unknown> | void` to reflect this behavior.\n\nBREAKING CHANGE:\n\nThe type of the `APP_INITIALIZER` token has been changed to more accurately\nreflect the types of return values that are handled by Angular. Previously,\neach initializer callback was typed to return `any`, this is now\n`Promise<unknown> | Observable<unknown> | void`. In the unlikely event that\nyour application uses the `Injector.get` or `TestBed.inject` API to inject\nthe `APP_INITIALIZER` token, you may need to update the code to account for\nthe stricter type.\n\nAdditionally, TypeScript may report the TS2742 error if the `APP_INITIALIZER`\ntoken is used in an expression of which its inferred type has to be emitted\ninto a .d.ts file. To workaround this, an explicit type annotation is needed,\nwhich would typically be `Provider` or `Provider[]`.\n\nCloses #40729\n\nPR Close #40986",
    "sha": "ca721c2972f44d903a0e12fae3397ab62769e649",
    "files": [
        {
            "sha": "99595a7ec4bf39f058655e3835aa4a2337543419",
            "filename": "goldens/public-api/core/core.d.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/ca721c2972f44d903a0e12fae3397ab62769e649/goldens%2Fpublic-api%2Fcore%2Fcore.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/ca721c2972f44d903a0e12fae3397ab62769e649/goldens%2Fpublic-api%2Fcore%2Fcore.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fcore%2Fcore.d.ts?ref=ca721c2972f44d903a0e12fae3397ab62769e649",
            "patch": "@@ -25,12 +25,12 @@ export declare const APP_BOOTSTRAP_LISTENER: InjectionToken<((compRef: Component\n \n export declare const APP_ID: InjectionToken<string>;\n \n-export declare const APP_INITIALIZER: InjectionToken<(() => void)[]>;\n+export declare const APP_INITIALIZER: InjectionToken<readonly (() => Observable<unknown> | Promise<unknown> | void)[]>;\n \n export declare class ApplicationInitStatus {\n     readonly done = false;\n     readonly donePromise: Promise<any>;\n-    constructor(appInits: (() => any)[]);\n+    constructor(appInits: ReadonlyArray<() => Observable<unknown> | Promise<unknown> | void>);\n }\n \n export declare class ApplicationModule {"
        },
        {
            "sha": "b89ed0908a123f691f410ead89abe62f2af42dbd",
            "filename": "packages/core/src/application_init.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/ca721c2972f44d903a0e12fae3397ab62769e649/packages%2Fcore%2Fsrc%2Fapplication_init.ts",
            "raw_url": "https://github.com/angular/angular/raw/ca721c2972f44d903a0e12fae3397ab62769e649/packages%2Fcore%2Fsrc%2Fapplication_init.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Fapplication_init.ts?ref=ca721c2972f44d903a0e12fae3397ab62769e649",
            "patch": "@@ -6,6 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n+import {Observable} from 'rxjs';\n import {Inject, Injectable, InjectionToken, Optional} from './di';\n import {isObservable, isPromise} from './util/lang';\n import {noop} from './util/noop';\n@@ -28,7 +29,9 @@ import {noop} from './util/noop';\n  *\n  * @publicApi\n  */\n-export const APP_INITIALIZER = new InjectionToken<Array<() => void>>('Application Initializer');\n+export const APP_INITIALIZER =\n+    new InjectionToken<ReadonlyArray<() => Observable<unknown>| Promise<unknown>| void>>(\n+        'Application Initializer');\n \n /**\n  * A class that reflects the state of running {@link APP_INITIALIZER} functions.\n@@ -43,7 +46,8 @@ export class ApplicationInitStatus {\n   public readonly donePromise: Promise<any>;\n   public readonly done = false;\n \n-  constructor(@Inject(APP_INITIALIZER) @Optional() private appInits: (() => any)[]) {\n+  constructor(@Inject(APP_INITIALIZER) @Optional() private readonly appInits:\n+                  ReadonlyArray<() => Observable<unknown>| Promise<unknown>| void>) {\n     this.donePromise = new Promise((res, rej) => {\n       this.resolve = res;\n       this.reject = rej;"
        },
        {
            "sha": "810fd68a11d5a7f1427e6c28a528f22402a72da9",
            "filename": "packages/router/src/router_module.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/ca721c2972f44d903a0e12fae3397ab62769e649/packages%2Frouter%2Fsrc%2Frouter_module.ts",
            "raw_url": "https://github.com/angular/angular/raw/ca721c2972f44d903a0e12fae3397ab62769e649/packages%2Frouter%2Fsrc%2Frouter_module.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Frouter_module.ts?ref=ca721c2972f44d903a0e12fae3397ab62769e649",
            "patch": "@@ -584,7 +584,7 @@ export function getBootstrapListener(r: RouterInitializer) {\n export const ROUTER_INITIALIZER =\n     new InjectionToken<(compRef: ComponentRef<any>) => void>('Router Initializer');\n \n-export function provideRouterInitializer() {\n+export function provideRouterInitializer(): ReadonlyArray<Provider> {\n   return [\n     RouterInitializer,\n     {"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 9,
        "deletions": 5
    }
}