{
    "author": "josephperrott",
    "message": "fix(dev-infra): only create authenticated github instance once in yargs (#41603)\n\nFix github token option for yargs to only create an authenticated token one time.\n\nPR Close #41603",
    "sha": "15c307b2008bd4c299245bfc28b5d3a23b020fd0",
    "files": [
        {
            "sha": "d5214b1940bf03f98aa6906b64d9ce0172510ce5",
            "filename": "dev-infra/ng-dev.js",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/15c307b2008bd4c299245bfc28b5d3a23b020fd0/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/15c307b2008bd4c299245bfc28b5d3a23b020fd0/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=15c307b2008bd4c299245bfc28b5d3a23b020fd0",
            "patch": "@@ -805,7 +805,12 @@ function addGithubTokenOption(yargs) {\n                 error(yellow(\"You can generate a token here: \" + GITHUB_TOKEN_GENERATE_URL));\n                 process.exit(1);\n             }\n-            GitClient.authenticateWithToken(githubToken);\n+            try {\n+                GitClient.getAuthenticatedInstance();\n+            }\n+            catch (_a) {\n+                GitClient.authenticateWithToken(githubToken);\n+            }\n             return githubToken;\n         },\n     })"
        },
        {
            "sha": "751d35f5dbd3a9fb6ece187ed83001f8f1208a92",
            "filename": "dev-infra/utils/git/github-yargs.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/15c307b2008bd4c299245bfc28b5d3a23b020fd0/dev-infra%2Futils%2Fgit%2Fgithub-yargs.ts",
            "raw_url": "https://github.com/angular/angular/raw/15c307b2008bd4c299245bfc28b5d3a23b020fd0/dev-infra%2Futils%2Fgit%2Fgithub-yargs.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2Fgit%2Fgithub-yargs.ts?ref=15c307b2008bd4c299245bfc28b5d3a23b020fd0",
            "patch": "@@ -32,7 +32,11 @@ export function addGithubTokenOption(yargs: Argv): ArgvWithGithubToken {\n             error(yellow(`You can generate a token here: ${GITHUB_TOKEN_GENERATE_URL}`));\n             process.exit(1);\n           }\n-          GitClient.authenticateWithToken(githubToken);\n+          try {\n+            GitClient.getAuthenticatedInstance();\n+          } catch {\n+            GitClient.authenticateWithToken(githubToken);\n+          }\n           return githubToken;\n         },\n       })"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 11,
        "deletions": 2
    }
}