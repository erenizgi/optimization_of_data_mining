{
    "author": "gkalpak",
    "message": "fix(docs-infra): focus elements when scrolling to them (if focusable) (#43460)\n\nWhen using `ScrollService#scrollToElement()` to scroll to a specific\nelement, also focus the element if it is focusable (i.e. if it has a\n`focus()` method).\n\nThis will be useful for implementing a \"skip to content\" link as\ndescribed in #42936.\n\nPR Close #43460",
    "sha": "235e4aaa2561c3e702c2ffb6820997475a851143",
    "files": [
        {
            "sha": "9e76f2865530de03b0bd8c639ecc37f0d57db24d",
            "filename": "aio/src/app/shared/scroll.service.spec.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 6,
            "changes": 20,
            "blob_url": "https://github.com/angular/angular/blob/235e4aaa2561c3e702c2ffb6820997475a851143/aio%2Fsrc%2Fapp%2Fshared%2Fscroll.service.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/235e4aaa2561c3e702c2ffb6820997475a851143/aio%2Fsrc%2Fapp%2Fshared%2Fscroll.service.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fshared%2Fscroll.service.spec.ts?ref=235e4aaa2561c3e702c2ffb6820997475a851143",
            "patch": "@@ -15,9 +15,9 @@ describe('ScrollService', () => {\n     return instance;\n   };\n \n-  const topOfPageElem = {} as Element;\n+  const topOfPageElem = {} as HTMLElement;\n   let injector: Injector;\n-  let document: MockDocument;\n+  let document: Document & MockDocument;\n   let platformLocation: MockPlatformLocation;\n   let scrollService: ScrollService;\n   let location: SpyLocation;\n@@ -60,7 +60,7 @@ describe('ScrollService', () => {\n     });\n \n     platformLocation = injector.get(PlatformLocation);\n-    document = injector.get(DOCUMENT) as unknown as MockDocument;\n+    document = injector.get(DOCUMENT) as unknown as Document & MockDocument;\n     scrollService = injector.get(ScrollService);\n     location = injector.get(Location) as unknown as SpyLocation;\n     sessionStorage = injector.get(SessionStorage);\n@@ -241,14 +241,22 @@ describe('ScrollService', () => {\n \n   describe('#scrollToElement', () => {\n     it('should scroll to element', () => {\n-      const element: Element = new MockElement() as any;\n+      const element: HTMLElement = new MockElement() as any;\n       scrollService.scrollToElement(element);\n       expect(element.scrollIntoView).toHaveBeenCalled();\n       expect(window.scrollBy).toHaveBeenCalledWith(0, -scrollService.topOffset);\n     });\n \n+    it('should focus the element if focusable', () => {\n+      const element: HTMLElement = Object.assign(new MockElement() as any, {\n+        focus: jasmine.createSpy('Element focus'),\n+      });\n+      scrollService.scrollToElement(element);\n+      expect(element.focus).toHaveBeenCalled();\n+    });\n+\n     it('should not scroll more than necessary (e.g. for elements close to the bottom)', () => {\n-      const element: Element = new MockElement() as any;\n+      const element: HTMLElement = new MockElement() as any;\n       const getBoundingClientRect = element.getBoundingClientRect as jasmine.Spy;\n       const topOffset = scrollService.topOffset;\n \n@@ -264,7 +272,7 @@ describe('ScrollService', () => {\n     });\n \n     it('should scroll all the way to the top if close enough', () => {\n-      const element: Element = new MockElement() as any;\n+      const element: HTMLElement = new MockElement() as any;\n \n       (window as any).pageYOffset = 25;\n       scrollService.scrollToElement(element);"
        },
        {
            "sha": "0855ae091f9f0ba71ccd3e11b973b3f5775613a3",
            "filename": "aio/src/app/shared/scroll.service.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 4,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/235e4aaa2561c3e702c2ffb6820997475a851143/aio%2Fsrc%2Fapp%2Fshared%2Fscroll.service.ts",
            "raw_url": "https://github.com/angular/angular/raw/235e4aaa2561c3e702c2ffb6820997475a851143/aio%2Fsrc%2Fapp%2Fshared%2Fscroll.service.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fshared%2Fscroll.service.ts?ref=235e4aaa2561c3e702c2ffb6820997475a851143",
            "patch": "@@ -17,7 +17,7 @@ export const topMargin = 16;\n @Injectable()\n export class ScrollService implements OnDestroy {\n   private _topOffset: number|null;\n-  private _topOfPageElement: Element;\n+  private _topOfPageElement: HTMLElement;\n   private onDestroy = new Subject<void>();\n \n   // The scroll position which has to be restored, after a `popstate` event.\n@@ -44,7 +44,7 @@ export class ScrollService implements OnDestroy {\n   }\n \n   constructor(\n-      @Inject(DOCUMENT) private document: any, private platformLocation: PlatformLocation,\n+      @Inject(DOCUMENT) private document: Document, private platformLocation: PlatformLocation,\n       private viewportScroller: ViewportScroller, private location: Location,\n       @Inject(SessionStorage) private storage: Storage) {\n     // On resize, the toolbar might change height, so \"invalidate\" the top offset.\n@@ -100,7 +100,7 @@ export class ScrollService implements OnDestroy {\n    */\n   scroll() {\n     const hash = this.getCurrentHash();\n-    const element: HTMLElement = hash ? this.document.getElementById(hash) : this.topOfPageElement;\n+    const element = hash ? this.document.getElementById(hash) ?? null : this.topOfPageElement;\n     this.scrollToElement(element);\n   }\n \n@@ -147,9 +147,10 @@ export class ScrollService implements OnDestroy {\n    * Scroll to the element.\n    * Don't scroll if no element.\n    */\n-  scrollToElement(element: Element|null) {\n+  scrollToElement(element: HTMLElement|null) {\n     if (element) {\n       element.scrollIntoView();\n+      element.focus?.();\n \n       if (window && window.scrollBy) {\n         // Scroll as much as necessary to align the top of `element` at `topOffset`."
        }
    ],
    "stats": {
        "total": 29,
        "additions": 19,
        "deletions": 10
    }
}