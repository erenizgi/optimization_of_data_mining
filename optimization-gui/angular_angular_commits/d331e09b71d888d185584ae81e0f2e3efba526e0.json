{
    "author": "josephperrott",
    "message": "refactor(dev-infra): create ng-dev executable locally in the repo (#39089)\n\nRather than running ng-dev via ts-node, going forward ng-dev is generated and run\nlocally via node.  Additionally, the generated file is tested on each commit to\nensure that the local generated version stays up to date.\n\nPR Close #39089",
    "sha": "d331e09b71d888d185584ae81e0f2e3efba526e0",
    "files": [
        {
            "sha": "b75dd04979db06d328a587579b530249c6fc107d",
            "filename": ".ng-dev/format.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/.ng-dev%2Fformat.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/.ng-dev%2Fformat.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/.ng-dev%2Fformat.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -16,6 +16,8 @@ export const format: FormatConfig = {\n       '!.yarn/**',\n       // Do not format d.ts files as they are generated\n       '!**/*.d.ts',\n+      // Do not format generated ng-dev script\n+      '!dev-infra/ng-dev.js',\n     ]\n   },\n   'buildifier': true"
        },
        {
            "sha": "e3cdd2f5a2bc6eba5dc87fee8194c5f0f7b78396",
            "filename": "dev-infra/BUILD.bazel",
            "status": "modified",
            "additions": 19,
            "deletions": 1,
            "changes": 20,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2FBUILD.bazel?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -1,5 +1,6 @@\n-load(\"@build_bazel_rules_nodejs//:index.bzl\", \"pkg_npm\")\n+load(\"@build_bazel_rules_nodejs//:index.bzl\", \"generated_file_test\", \"pkg_npm\")\n load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"@npm//@bazel/rollup:index.bzl\", \"rollup_bundle\")\n \n ts_library(\n     name = \"cli\",\n@@ -23,6 +24,23 @@ ts_library(\n     ],\n )\n \n+rollup_bundle(\n+    name = \"cli_rollup\",\n+    entry_point = \":cli.ts\",\n+    format = \"cjs\",\n+    silent = True,\n+    sourcemap = \"false\",\n+    deps = [\n+        \":cli\",\n+    ],\n+)\n+\n+generated_file_test(\n+    name = \"local_ng_dev\",\n+    src = \"ng-dev.js\",\n+    generated = \"cli_rollup\",\n+)\n+\n genrule(\n     name = \"package-json\",\n     srcs = ["
        },
        {
            "sha": "fdbdbe31c43f21fdd65001f5337dddfa32f64b68",
            "filename": "dev-infra/caretaker/check/check.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcaretaker%2Fcheck%2Fcheck.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcaretaker%2Fcheck%2Fcheck.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcaretaker%2Fcheck%2Fcheck.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {GitClient} from '../../utils/git';\n+import {GitClient} from '../../utils/git/index';\n import {getCaretakerConfig} from '../config';\n \n import {printCiStatus} from './ci';"
        },
        {
            "sha": "bdadcb9d0469fa2959591a4468025631f28c3207",
            "filename": "dev-infra/caretaker/check/ci.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcaretaker%2Fcheck%2Fci.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcaretaker%2Fcheck%2Fci.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcaretaker%2Fcheck%2Fci.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -10,7 +10,7 @@ import fetch from 'node-fetch';\n import {fetchActiveReleaseTrains} from '../../release/versioning/index';\n \n import {bold, debug, info} from '../../utils/console';\n-import {GitClient} from '../../utils/git';\n+import {GitClient} from '../../utils/git/index';\n \n \n /** The results of checking the status of CI.  */"
        },
        {
            "sha": "6674322360d241bf500bff43f8a0be93d4ea2ec8",
            "filename": "dev-infra/caretaker/check/g3.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcaretaker%2Fcheck%2Fg3.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcaretaker%2Fcheck%2Fg3.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcaretaker%2Fcheck%2Fg3.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -13,7 +13,7 @@ import {parse as parseYaml} from 'yaml';\n \n import {getRepoBaseDir} from '../../utils/config';\n import {bold, debug, info} from '../../utils/console';\n-import {GitClient} from '../../utils/git';\n+import {GitClient} from '../../utils/git/index';\n \n /** Compare the upstream master to the upstream g3 branch, if it exists. */\n export async function printG3Comparison(git: GitClient) {\n@@ -120,6 +120,8 @@ export async function printG3Comparison(git: GitClient) {\n   /** Determine whether the file name passes both include and exclude checks. */\n   function checkMatchAgainstIncludeAndExclude(\n       file: string, includes: string[], excludes: string[]) {\n-    return multimatch(file, includes).length >= 1 && multimatch(file, excludes).length === 0;\n+    return (\n+        multimatch.call(undefined, file, includes).length >= 1 &&\n+        multimatch.call(undefined, file, excludes).length === 0);\n   }\n }"
        },
        {
            "sha": "6b02a3dbdd452af991a639db1659823b5e3439f0",
            "filename": "dev-infra/caretaker/check/github.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcaretaker%2Fcheck%2Fgithub.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcaretaker%2Fcheck%2Fgithub.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcaretaker%2Fcheck%2Fgithub.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -9,7 +9,7 @@\n import {alias, onUnion, params, types} from 'typed-graphqlify';\n \n import {bold, debug, info} from '../../utils/console';\n-import {GitClient} from '../../utils/git';\n+import {GitClient} from '../../utils/git/index';\n import {CaretakerConfig} from '../config';\n \n /**"
        },
        {
            "sha": "d61055be0e4449a197a71f27b3e8a1c92ed4b8cb",
            "filename": "dev-infra/cli.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcli.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -1,4 +1,3 @@\n-#!/usr/bin/env node\n /**\n  * @license\n  * Copyright Google LLC All Rights Reserved.\n@@ -7,15 +6,16 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n import * as yargs from 'yargs';\n-import {tsCircularDependenciesBuilder} from './ts-circular-dependencies/index';\n-import {buildPullapproveParser} from './pullapprove/cli';\n+\n+import {buildCaretakerParser} from './caretaker/cli';\n import {buildCommitMessageParser} from './commit-message/cli';\n import {buildFormatParser} from './format/cli';\n-import {buildReleaseParser} from './release/cli';\n+import {buildNgbotParser} from './ngbot/cli';\n import {buildPrParser} from './pr/cli';\n+import {buildPullapproveParser} from './pullapprove/cli';\n+import {buildReleaseParser} from './release/cli';\n+import {tsCircularDependenciesBuilder} from './ts-circular-dependencies/index';\n import {captureLogOutputForCommand} from './utils/console';\n-import {buildCaretakerParser} from './caretaker/cli';\n-import {buildNgbotParser} from './ngbot/cli';\n \n yargs.scriptName('ng-dev')\n     .middleware(captureLogOutputForCommand)"
        },
        {
            "sha": "abb734a839c2b1a4432132c4f9e2b07ee7f2d0d1",
            "filename": "dev-infra/commit-message-filter.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcommit-message-filter.js",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcommit-message-filter.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message-filter.js?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -0,0 +1 @@\n+pr/merge/strategies/commit-message-filter.js\n\\ No newline at end of file"
        },
        {
            "sha": "f952ab569c01a7fb5436eedcea137840e65d32fa",
            "filename": "dev-infra/commit-message/cli.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcommit-message%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fcommit-message%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Fcli.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -21,7 +21,3 @@ export function buildCommitMessageParser(localYargs: yargs.Argv) {\n       .command(ValidateFileModule)\n       .command(ValidateRangeModule);\n }\n-\n-if (require.main == module) {\n-  buildCommitMessageParser(yargs).parse();\n-}"
        },
        {
            "sha": "8b3c55297e2aff5e3443613e46742f4a5c18df81",
            "filename": "dev-infra/format/cli.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fformat%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fformat%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fformat%2Fcli.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -48,7 +48,3 @@ export function buildFormatParser(localYargs: yargs.Argv) {\n             executionCmd(files!);\n           });\n }\n-\n-if (require.main === module) {\n-  buildFormatParser(yargs).parse();\n-}"
        },
        {
            "sha": "51dcc34aeb4a05d52dd20d413b77377a84c4b6cf",
            "filename": "dev-infra/format/run-commands-parallel.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fformat%2Frun-commands-parallel.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fformat%2Frun-commands-parallel.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fformat%2Frun-commands-parallel.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -13,7 +13,7 @@ import {exec} from 'shelljs';\n \n import {info} from '../utils/console';\n \n-import {Formatter, FormatterAction, getActiveFormatters} from './formatters';\n+import {Formatter, FormatterAction, getActiveFormatters} from './formatters/index';\n \n const AVAILABLE_THREADS = Math.max(cpus().length - 1, 1);\n \n@@ -36,9 +36,9 @@ export function runFormatterInParallel(allFiles: string[], action: FormatterActi\n     const pendingCommands: {formatter: Formatter, file: string}[] = [];\n \n     for (const formatter of formatters) {\n-      pendingCommands.push(...multimatch(allFiles, formatter.getFileMatcher(), {\n-                             dot: true\n-                           }).map(file => ({formatter, file})));\n+      pendingCommands.push(\n+          ...multimatch.call(undefined, allFiles, formatter.getFileMatcher(), {dot: true})\n+              .map(file => ({formatter, file})));\n     }\n \n     // If no commands are generated, resolve the promise as `false` as no files"
        },
        {
            "sha": "b29c22cbb47e28fe6fc70df06b8121e39ba7c1f4",
            "filename": "dev-infra/ng-dev",
            "status": "removed",
            "additions": 0,
            "deletions": 11,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/d939b5f5983d7aacf59f00145ea1db9f76712792/dev-infra%2Fng-dev",
            "raw_url": "https://github.com/angular/angular/raw/d939b5f5983d7aacf59f00145ea1db9f76712792/dev-infra%2Fng-dev",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev?ref=d939b5f5983d7aacf59f00145ea1db9f76712792",
            "patch": "@@ -1,11 +0,0 @@\n-#!/usr/bin/env ts-node\n-/**\n- * @license\n- * Copyright Google LLC All Rights Reserved.\n- *\n- * Use of this source code is governed by an MIT-style license that can be\n- * found in the LICENSE file at https://angular.io/license\n- */\n-\n-// Loads the ng-dev cli, automatically executing it.\n-require('./cli.ts');"
        },
        {
            "sha": "7b26460334f6fce6720be6602bc4eedab77128bb",
            "filename": "dev-infra/ng-dev.js",
            "status": "added",
            "additions": 6801,
            "deletions": 0,
            "changes": 6801,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=d331e09b71d888d185584ae81e0f2e3efba526e0"
        },
        {
            "sha": "e03b57926fb9d044b2f4bd24745f40bfb9dcd1ce",
            "filename": "dev-infra/ngbot/cli.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fngbot%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fngbot%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fngbot%2Fcli.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -13,7 +13,3 @@ export function buildNgbotParser(localYargs: yargs.Argv) {\n   return localYargs.help().strict().demandCommand().command(\n       'verify', 'Verify the NgBot config', {}, () => verify());\n }\n-\n-if (require.main === module) {\n-  buildNgbotParser(yargs).parse();\n-}"
        },
        {
            "sha": "d05b3069e69ef007b24b68e8bb594c5292f76203",
            "filename": "dev-infra/pr/cli.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fcli.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -28,7 +28,3 @@ export function buildPrParser(localYargs: yargs.Argv) {\n           buildRebaseCommand, handleRebaseCommand)\n       .command(CheckoutCommandModule);\n }\n-\n-if (require.main === module) {\n-  buildPrParser(yargs).parse();\n-}"
        },
        {
            "sha": "7792eb6ca00f5b67ae6f526cb12bb738b5381fba",
            "filename": "dev-infra/pr/common/checkout-pr.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fcommon%2Fcheckout-pr.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fcommon%2Fcheckout-pr.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fcommon%2Fcheckout-pr.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -9,8 +9,8 @@\n import {types as graphQLTypes} from 'typed-graphqlify';\n \n import {info} from '../../utils/console';\n-import {GitClient} from '../../utils/git';\n import {addTokenToGitHttpsUrl} from '../../utils/git/github-urls';\n+import {GitClient} from '../../utils/git/index';\n import {getPr} from '../../utils/github';\n \n /* GraphQL schema for the response body for a pending PR. */"
        },
        {
            "sha": "d73c329b2d7e345078351e2fc9f8f5a9c2c6010d",
            "filename": "dev-infra/pr/discover-new-conflicts/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fdiscover-new-conflicts%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fdiscover-new-conflicts%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fdiscover-new-conflicts%2Findex.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -11,7 +11,7 @@ import {types as graphQLTypes} from 'typed-graphqlify';\n \n import {getConfig, NgDevConfig} from '../../utils/config';\n import {error, info} from '../../utils/console';\n-import {GitClient} from '../../utils/git';\n+import {GitClient} from '../../utils/git/index';\n import {getPendingPrs} from '../../utils/github';\n import {exec} from '../../utils/shelljs';\n "
        },
        {
            "sha": "b252fddc1fc737a4b0154eb7280b0c527a1ecba2",
            "filename": "dev-infra/pr/merge/BUILD.bazel",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2FBUILD.bazel?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -8,6 +8,9 @@ ts_library(\n         exclude = [\"**/*.spec.ts\"],\n     ),\n     module_name = \"@angular/dev-infra-private/pr/merge\",\n+    # prodmode target must be set to es5 as the Ora class, which is extended is not a proper\n+    # prototyped object.\n+    prodmode_target = \"es5\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/commit-message\","
        },
        {
            "sha": "f1dff5031e50922bd774b90012bbe00dc9155a0c",
            "filename": "dev-infra/pr/merge/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2Findex.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -9,9 +9,9 @@\n \n import {getConfig, getRepoBaseDir} from '../../utils/config';\n import {error, green, info, promptConfirm, red, yellow} from '../../utils/console';\n-import {GitClient} from '../../utils/git';\n import {GithubApiRequestError} from '../../utils/git/github';\n import {GITHUB_TOKEN_GENERATE_URL} from '../../utils/git/github-urls';\n+import {GitClient} from '../../utils/git/index';\n \n import {loadAndValidateConfig, MergeConfigWithRemote} from './config';\n import {MergeResult, MergeStatus, PullRequestMergeTask} from './task';"
        },
        {
            "sha": "8d8e66796930c101f95edab9f9cc40dd1341963f",
            "filename": "dev-infra/pr/merge/pull-request.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Fpull-request.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Fpull-request.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2Fpull-request.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -8,7 +8,7 @@\n \n import * as Octokit from '@octokit/rest';\n \n-import {GitClient} from '../../utils/git';\n+import {GitClient} from '../../utils/git/index';\n \n import {PullRequestFailure} from './failures';\n import {matchesPattern} from './string-pattern';"
        },
        {
            "sha": "4268df858028c83dad15276ea84ed6a45feeb562",
            "filename": "dev-infra/pr/merge/strategies/api-merge.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Fstrategies%2Fapi-merge.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Fstrategies%2Fapi-merge.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2Fstrategies%2Fapi-merge.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -10,7 +10,7 @@ import {PullsListCommitsResponse, PullsMergeParams} from '@octokit/rest';\n import {prompt} from 'inquirer';\n \n import {parseCommitMessage} from '../../../commit-message/parse';\n-import {GitClient} from '../../../utils/git';\n+import {GitClient} from '../../../utils/git/index';\n import {GithubApiMergeMethod} from '../config';\n import {PullRequestFailure} from '../failures';\n import {PullRequest} from '../pull-request';"
        },
        {
            "sha": "52fced888fa13b12e2daf471c8be6ebfb6a2489a",
            "filename": "dev-infra/pr/merge/strategies/strategy.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Fstrategies%2Fstrategy.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Fstrategies%2Fstrategy.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2Fstrategies%2Fstrategy.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {GitClient} from '../../../utils/git';\n+import {GitClient} from '../../../utils/git/index';\n import {PullRequestFailure} from '../failures';\n import {PullRequest} from '../pull-request';\n "
        },
        {
            "sha": "b42f532b864d72ed67b1e3454e90bef0111486f7",
            "filename": "dev-infra/pr/merge/task.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Ftask.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Fmerge%2Ftask.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2Ftask.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n import {promptConfirm} from '../../utils/console';\n-import {GitClient, GitCommandError} from '../../utils/git';\n+import {GitClient, GitCommandError} from '../../utils/git/index';\n \n import {MergeConfigWithRemote} from './config';\n import {PullRequestFailure} from './failures';"
        },
        {
            "sha": "974a0f0435163bd2dfd5bad80d5e242b5f95bf04",
            "filename": "dev-infra/pr/rebase/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Frebase%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpr%2Frebase%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Frebase%2Findex.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -10,8 +10,8 @@ import {types as graphQLTypes} from 'typed-graphqlify';\n \n import {getConfig, NgDevConfig} from '../../utils/config';\n import {error, info, promptConfirm} from '../../utils/console';\n-import {GitClient} from '../../utils/git';\n import {addTokenToGitHttpsUrl} from '../../utils/git/github-urls';\n+import {GitClient} from '../../utils/git/index';\n import {getPr} from '../../utils/github';\n \n /* GraphQL schema for the response body for each pending PR. */"
        },
        {
            "sha": "f3fa0b083b9db3da5aad1126417e441190fa1dd4",
            "filename": "dev-infra/pullapprove/cli.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpullapprove%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fpullapprove%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpullapprove%2Fcli.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -13,7 +13,3 @@ export function buildPullapproveParser(localYargs: yargs.Argv) {\n   return localYargs.help().strict().demandCommand().command(\n       'verify', 'Verify the pullapprove config', {}, () => verify());\n }\n-\n-if (require.main === module) {\n-  buildPullapproveParser(yargs).parse();\n-}"
        },
        {
            "sha": "6281e4ab88e9fe33de842e348f1b17659d3ab8e9",
            "filename": "dev-infra/release/cli.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fcli.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -24,7 +24,3 @@ export function buildReleaseParser(localYargs: yargs.Argv) {\n           'build-env-stamp', 'Build the environment stamping information', {},\n           () => buildEnvStamp());\n }\n-\n-if (require.main === module) {\n-  buildReleaseParser(yargs).parse();\n-}"
        },
        {
            "sha": "507498b29c91d491c19ce00c5767e6e693ecaecf",
            "filename": "dev-infra/release/publish/actions.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fpublish%2Factions.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fpublish%2Factions.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Factions.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -301,7 +301,7 @@ export abstract class ReleaseAction {\n     return new Promise((resolve, reject) => {\n       debug(`Waiting for pull request #${id} to be merged.`);\n \n-      const spinner = ora().start(`Waiting for pull request #${id} to be merged.`);\n+      const spinner = ora.call(undefined).start(`Waiting for pull request #${id} to be merged.`);\n       const intervalId = setInterval(async () => {\n         const prState = await getPullRequestState(this.git, id);\n         if (prState === 'merged') {\n@@ -517,7 +517,7 @@ export abstract class ReleaseAction {\n   /** Publishes the given built package to NPM with the specified NPM dist tag. */\n   private async _publishBuiltPackageToNpm(pkg: BuiltPackage, npmDistTag: string) {\n     debug(`Starting publish of \"${pkg.name}\".`);\n-    const spinner = ora().start(`Publishing \"${pkg.name}\"`);\n+    const spinner = ora.call(undefined).start(`Publishing \"${pkg.name}\"`);\n \n     try {\n       await runNpmPublish(pkg.outputPath, npmDistTag, this.config.publishRegistry);"
        },
        {
            "sha": "171f2edb28ad844db2f19b573ac8e2eafd9efb7d",
            "filename": "dev-infra/release/publish/cli.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fpublish%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fpublish%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Fcli.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -11,7 +11,7 @@ import {Arguments, Argv, CommandModule} from 'yargs';\n import {getConfig, getRepoBaseDir} from '../../utils/config';\n import {error, green, info, red, yellow} from '../../utils/console';\n import {addGithubTokenOption} from '../../utils/git/github-yargs';\n-import {getReleaseConfig} from '../config';\n+import {getReleaseConfig} from '../config/index';\n \n import {CompletionState, ReleaseTool} from './index';\n "
        },
        {
            "sha": "49698607e66cc027f8ec48b0f046d5564078e115",
            "filename": "dev-infra/release/publish/external-commands.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fpublish%2Fexternal-commands.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fpublish%2Fexternal-commands.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Fexternal-commands.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -54,7 +54,7 @@ export async function invokeSetNpmDistCommand(npmDistTag: string, version: semve\n  * packages for the currently checked out branch.\n  */\n export async function invokeReleaseBuildCommand(): Promise<BuiltPackage[]> {\n-  const spinner = ora().start('Building release output.');\n+  const spinner = ora.call(undefined).start('Building release output.');\n   try {\n     // Since we expect JSON to be printed from the `ng-dev release build` command,\n     // we spawn the process in silent mode. We have set up an Ora progress spinner."
        },
        {
            "sha": "06c5e7e2a3b2295ab15a6bcdb6233f4309a9be39",
            "filename": "dev-infra/release/set-dist-tag/cli.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fset-dist-tag%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Frelease%2Fset-dist-tag%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fset-dist-tag%2Fcli.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -46,7 +46,7 @@ async function handler(args: Arguments<ReleaseSetDistTagOptions>) {\n     process.exit(1);\n   }\n \n-  const spinner = ora().start();\n+  const spinner = ora.call(undefined).start();\n   debug(`Setting \"${tagName}\" NPM dist tag for release packages to v${version}.`);\n \n   for (const pkgName of npmPackages) {"
        },
        {
            "sha": "2800c31ba40fc790bea27aeb1fd7dd1abd5a4b64",
            "filename": "dev-infra/ts-circular-dependencies/index.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 8,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fts-circular-dependencies%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Fts-circular-dependencies%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fts-circular-dependencies%2Findex.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -1,4 +1,3 @@\n-#!/usr/bin/env node\n /**\n  * @license\n  * Copyright Google LLC All Rights Reserved.\n@@ -13,12 +12,12 @@ import {isAbsolute, relative, resolve} from 'path';\n import * as ts from 'typescript';\n import * as yargs from 'yargs';\n \n-import {green, info, error, red, yellow} from '../utils/console';\n+import {error, green, info, red, yellow} from '../utils/console';\n \n import {Analyzer, ReferenceChain} from './analyzer';\n-import {compareGoldens, convertReferenceChainToGolden, Golden} from './golden';\n+import {CircularDependenciesTestConfig, loadTestConfig} from './config';\n import {convertPathToForwardSlash} from './file_system';\n-import {loadTestConfig, CircularDependenciesTestConfig} from './config';\n+import {compareGoldens, convertReferenceChainToGolden, Golden} from './golden';\n \n \n export function tsCircularDependenciesBuilder(localYargs: yargs.Argv) {\n@@ -134,7 +133,3 @@ function getRelativePath(baseDir: string, path: string) {\n function convertReferenceChainToString(chain: ReferenceChain<string>) {\n   return chain.join(' â†’ ');\n }\n-\n-if (require.main === module) {\n-  tsCircularDependenciesBuilder(yargs).parse();\n-}"
        },
        {
            "sha": "122ad9fdf2b2b91930f86489a31a3066cb39756c",
            "filename": "dev-infra/utils/BUILD.bazel",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Futils%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Futils%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2FBUILD.bazel?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -7,6 +7,9 @@ ts_library(\n         \"git/*.ts\",\n     ]),\n     module_name = \"@angular/dev-infra-private/utils\",\n+    # prodmode target must be set to es5 as the Octokit class, which is extended is not a proper\n+    # prototyped object.\n+    prodmode_target = \"es5\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"@npm//@octokit/graphql\","
        },
        {
            "sha": "6b79440124cc888bdcbbe2b32ceddb740621553c",
            "filename": "dev-infra/utils/github.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Futils%2Fgithub.ts",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/dev-infra%2Futils%2Fgithub.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2Fgithub.ts?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -8,7 +8,7 @@\n \n import {params, types} from 'typed-graphqlify';\n \n-import {GitClient} from './git';\n+import {GitClient} from './git/index';\n \n /** Get a PR from github  */\n export async function getPr<PrSchema>(prSchema: PrSchema, prNumber: number, git: GitClient) {"
        },
        {
            "sha": "c4417a9cf7cd63e07524922555817ecaddd15880",
            "filename": "package.json",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/package.json",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/package.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/package.json?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -34,10 +34,9 @@\n     \"public-api:update\": \"node goldens/public-api/manage.js accept\",\n     \"symbol-extractor:check\": \"node tools/symbol-extractor/run_all_symbols_extractor_tests.js test\",\n     \"symbol-extractor:update\": \"node tools/symbol-extractor/run_all_symbols_extractor_tests.js accept\",\n-    \"ts-circular-deps\": \"ts-node --transpile-only -- dev-infra/ts-circular-dependencies/index.ts --config ./packages/circular-deps-test.conf.js\",\n-    \"ts-circular-deps:check\": \"yarn -s ts-circular-deps check\",\n-    \"ts-circular-deps:approve\": \"yarn -s ts-circular-deps approve\",\n-    \"ng-dev\": \"ts-node --transpile-only -- dev-infra/cli.ts\"\n+    \"ts-circular-deps:check\": \"yarn -s ng-dev ts-circular-deps check --config ./packages/circular-deps-test.conf.js\",\n+    \"ts-circular-deps:approve\": \"yarn -s ng-dev ts-circular-deps approve --config ./packages/circular-deps-test.conf.js\",\n+    \"ng-dev\": \"node dev-infra/ng-dev\"\n   },\n   \"// 1\": \"dependencies are used locally and by bazel\",\n   \"dependencies\": {"
        },
        {
            "sha": "f2ff3e44a33ad421dfbd21bd771183f57aa52250",
            "filename": "tslint.json",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/d331e09b71d888d185584ae81e0f2e3efba526e0/tslint.json",
            "raw_url": "https://github.com/angular/angular/raw/d331e09b71d888d185584ae81e0f2e3efba526e0/tslint.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/tslint.json?ref=d331e09b71d888d185584ae81e0f2e3efba526e0",
            "patch": "@@ -98,7 +98,8 @@\n       \"./modules/benchmarks_external/**/*\",\n       // Ignore zone.js directory\n       // TODO(JiaLiPassion): add zone.js back later\n-      \"./packages/zone.js/**/*\"\n+      \"./packages/zone.js/**/*\",\n+      \"./dev-infra/ng-dev.js\"\n     ]\n   }\n }"
        }
    ],
    "stats": {
        "total": 6946,
        "additions": 6868,
        "deletions": 78
    }
}