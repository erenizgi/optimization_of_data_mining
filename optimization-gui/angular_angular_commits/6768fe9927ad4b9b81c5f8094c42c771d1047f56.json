{
    "author": "josephperrott",
    "message": "fix(dev-infra): correct build setup for dev-infra (#38815)\n\nCorrect's the missing dependencies and incorrect build dependencies for the\ndev-infra bazel targets.\n\nPR Close #38815",
    "sha": "6768fe9927ad4b9b81c5f8094c42c771d1047f56",
    "files": [
        {
            "sha": "f3afe19c7e7322e07936a4b43167488f51040c3e",
            "filename": "dev-infra/caretaker/BUILD.bazel",
            "status": "modified",
            "additions": 10,
            "deletions": 15,
            "changes": 25,
            "blob_url": "https://github.com/angular/angular/blob/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Fcaretaker%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Fcaretaker%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcaretaker%2FBUILD.bazel?ref=6768fe9927ad4b9b81c5f8094c42c771d1047f56",
            "patch": "@@ -2,25 +2,20 @@ load(\"@npm_bazel_typescript//:index.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"caretaker\",\n-    srcs = [\n-        \"cli.ts\",\n-    ],\n+    srcs = glob([\n+        \"**/*.ts\",\n+    ]),\n     module_name = \"@angular/dev-infra-private/caretaker\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n-        \"//dev-infra/caretaker/check\",\n+        \"//dev-infra/utils\",\n+        \"@npm//@types/node\",\n+        \"@npm//@types/node-fetch\",\n         \"@npm//@types/yargs\",\n+        \"@npm//multimatch\",\n+        \"@npm//node-fetch\",\n+        \"@npm//typed-graphqlify\",\n+        \"@npm//yaml\",\n         \"@npm//yargs\",\n     ],\n )\n-\n-ts_library(\n-    name = \"config\",\n-    srcs = [\n-        \"config.ts\",\n-    ],\n-    visibility = [\"//dev-infra:__subpackages__\"],\n-    deps = [\n-        \"//dev-infra/utils\",\n-    ],\n-)"
        },
        {
            "sha": "e4a8644799c09514eeb6b8c66b38b4c26d0bc64d",
            "filename": "dev-infra/caretaker/check/BUILD.bazel",
            "status": "removed",
            "additions": 0,
            "deletions": 21,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/57c442f9308d1b04db0e28feae85be41690540a3/dev-infra%2Fcaretaker%2Fcheck%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/57c442f9308d1b04db0e28feae85be41690540a3/dev-infra%2Fcaretaker%2Fcheck%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcaretaker%2Fcheck%2FBUILD.bazel?ref=57c442f9308d1b04db0e28feae85be41690540a3",
            "patch": "@@ -1,21 +0,0 @@\n-load(\"@npm_bazel_typescript//:index.bzl\", \"ts_library\")\n-\n-ts_library(\n-    name = \"check\",\n-    srcs = glob([\"*.ts\"]),\n-    module_name = \"@angular/dev-infra-private/caretaker/service-statuses\",\n-    visibility = [\"//dev-infra:__subpackages__\"],\n-    deps = [\n-        \"//dev-infra/caretaker:config\",\n-        \"//dev-infra/utils\",\n-        \"@npm//@types/fs-extra\",\n-        \"@npm//@types/node\",\n-        \"@npm//@types/node-fetch\",\n-        \"@npm//@types/yargs\",\n-        \"@npm//multimatch\",\n-        \"@npm//node-fetch\",\n-        \"@npm//typed-graphqlify\",\n-        \"@npm//yaml\",\n-        \"@npm//yargs\",\n-    ],\n-)"
        },
        {
            "sha": "57147905e76e485f06c34420f4758b0a17d96e75",
            "filename": "dev-infra/caretaker/check/g3.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Fcaretaker%2Fcheck%2Fg3.ts",
            "raw_url": "https://github.com/angular/angular/raw/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Fcaretaker%2Fcheck%2Fg3.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcaretaker%2Fcheck%2Fg3.ts?ref=6768fe9927ad4b9b81c5f8094c42c771d1047f56",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {existsSync, readFileSync} from 'fs-extra';\n+import {existsSync, readFileSync} from 'fs';\n import * as multimatch from 'multimatch';\n import {join} from 'path';\n import {parse as parseYaml} from 'yaml';"
        },
        {
            "sha": "a8beb0668445809c705c26fbea3239a3656e61a3",
            "filename": "dev-infra/pr/common/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Fpr%2Fcommon%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Fpr%2Fcommon%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fcommon%2FBUILD.bazel?ref=6768fe9927ad4b9b81c5f8094c42c771d1047f56",
            "patch": "@@ -3,6 +3,7 @@ load(\"@npm_bazel_typescript//:index.bzl\", \"ts_library\")\n ts_library(\n     name = \"common\",\n     srcs = glob([\"*.ts\"]),\n+    module_name = \"@angular/dev-infra-private/pr/common\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\","
        },
        {
            "sha": "40b5e1d36204fed4945412cf1731de0503de5a89",
            "filename": "dev-infra/tmpl-package.json",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Ftmpl-package.json",
            "raw_url": "https://github.com/angular/angular/raw/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Ftmpl-package.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Ftmpl-package.json?ref=6768fe9927ad4b9b81c5f8094c42c771d1047f56",
            "patch": "@@ -12,11 +12,13 @@\n     \"@angular/benchpress\": \"0.2.1\",\n     \"@octokit/graphql\": \"<from-root>\",\n     \"@octokit/types\": \"<from-root>\",\n+    \"@octokit/rest\": \"<from-root>\",\n     \"brotli\": \"<from-root>\",\n     \"chalk\": \"<from-root>\",\n     \"cli-progress\": \"<from-root>\",\n     \"glob\": \"<from-root>\",\n     \"inquirer\": \"<from-root>\",\n+    \"inquirer-autocomplete-prompt\": \"<from-root>\",\n     \"minimatch\": \"<from-root>\",\n     \"multimatch\": \"<from-root>\",\n     \"node-fetch\": \"<from-root>\",\n@@ -26,9 +28,7 @@\n     \"tslib\": \"<from-root>\",\n     \"typed-graphqlify\": \"<from-root>\",\n     \"yaml\": \"<from-root>\",\n-    \"yargs\": \"<from-root>\"\n-  },\n-  \"peerDependencies\": {\n+    \"yargs\": \"<from-root>\",\n     \"@bazel/buildifier\": \"<from-root>\",\n     \"clang-format\": \"<from-root>\",\n     \"protractor\": \"<from-root>\","
        },
        {
            "sha": "38c5ab121e9fc36d14281bd3c3acc8de1cfda009",
            "filename": "dev-infra/utils/BUILD.bazel",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Futils%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Futils%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2FBUILD.bazel?ref=6768fe9927ad4b9b81c5f8094c42c771d1047f56",
            "patch": "@@ -12,13 +12,11 @@ ts_library(\n         \"@npm//@octokit/graphql\",\n         \"@npm//@octokit/rest\",\n         \"@npm//@octokit/types\",\n-        \"@npm//@types/fs-extra\",\n         \"@npm//@types/inquirer\",\n         \"@npm//@types/node\",\n         \"@npm//@types/shelljs\",\n         \"@npm//@types/yargs\",\n         \"@npm//chalk\",\n-        \"@npm//fs-extra\",\n         \"@npm//inquirer\",\n         \"@npm//inquirer-autocomplete-prompt\",\n         \"@npm//shelljs\","
        },
        {
            "sha": "e4e02563346b7a33c0d95b07ef3f724e6999e0c8",
            "filename": "dev-infra/utils/console.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Futils%2Fconsole.ts",
            "raw_url": "https://github.com/angular/angular/raw/6768fe9927ad4b9b81c5f8094c42c771d1047f56/dev-infra%2Futils%2Fconsole.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2Fconsole.ts?ref=6768fe9927ad4b9b81c5f8094c42c771d1047f56",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n import chalk from 'chalk';\n-import {writeFileSync} from 'fs-extra';\n+import {writeFileSync} from 'fs';\n import {createPromptModule, ListChoiceOptions, prompt} from 'inquirer';\n import * as inquirerAutocomplete from 'inquirer-autocomplete-prompt';\n import {join} from 'path';"
        }
    ],
    "stats": {
        "total": 59,
        "additions": 16,
        "deletions": 43
    }
}