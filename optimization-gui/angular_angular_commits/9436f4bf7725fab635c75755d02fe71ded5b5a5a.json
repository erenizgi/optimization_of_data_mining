{
    "author": "atscott",
    "message": "Revert \"refactor(compiler): remove cyclic dependencies (#42062)\" (#43033)\n\nThis reverts commit 75855196e320022e79202ccaeb9be000da55b9eb.\n\nPR Close #43033",
    "sha": "9436f4bf7725fab635c75755d02fe71ded5b5a5a",
    "files": [
        {
            "sha": "cae92bc9715827af78d153b22df68f614a019032",
            "filename": "goldens/circular-deps/packages.json",
            "status": "modified",
            "additions": 54,
            "deletions": 0,
            "changes": 54,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/goldens%2Fcircular-deps%2Fpackages.json",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/goldens%2Fcircular-deps%2Fpackages.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fcircular-deps%2Fpackages.json?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -41,6 +41,55 @@\n     \"packages/compiler-cli/src/ngtsc/scope/src/component_scope.ts\",\n     \"packages/compiler-cli/src/ngtsc/scope/src/local.ts\"\n   ],\n+  [\n+    \"packages/compiler/src/compile_metadata.ts\",\n+    \"packages/compiler/src/lifecycle_reflector.ts\",\n+    \"packages/compiler/src/compile_reflector.ts\",\n+    \"packages/compiler/src/output/output_ast.ts\",\n+    \"packages/compiler/src/parse_util.ts\"\n+  ],\n+  [\n+    \"packages/compiler/src/compile_metadata.ts\",\n+    \"packages/compiler/src/ml_parser/parser.ts\",\n+    \"packages/compiler/src/ml_parser/ast.ts\",\n+    \"packages/compiler/src/i18n/i18n_ast.ts\",\n+    \"packages/compiler/src/parse_util.ts\"\n+  ],\n+  [\n+    \"packages/compiler/src/compile_metadata.ts\",\n+    \"packages/compiler/src/ml_parser/parser.ts\",\n+    \"packages/compiler/src/ml_parser/ast.ts\",\n+    \"packages/compiler/src/parse_util.ts\"\n+  ],\n+  [\n+    \"packages/compiler/src/compile_metadata.ts\",\n+    \"packages/compiler/src/ml_parser/parser.ts\",\n+    \"packages/compiler/src/ml_parser/lexer.ts\",\n+    \"packages/compiler/src/parse_util.ts\"\n+  ],\n+  [\n+    \"packages/compiler/src/compile_metadata.ts\",\n+    \"packages/compiler/src/ml_parser/parser.ts\",\n+    \"packages/compiler/src/parse_util.ts\"\n+  ],\n+  [\n+    \"packages/compiler/src/compile_metadata.ts\",\n+    \"packages/compiler/src/util.ts\",\n+    \"packages/compiler/src/constant_pool.ts\",\n+    \"packages/compiler/src/output/output_ast.ts\",\n+    \"packages/compiler/src/parse_util.ts\"\n+  ],\n+  [\n+    \"packages/compiler/src/compile_metadata.ts\",\n+    \"packages/compiler/src/util.ts\",\n+    \"packages/compiler/src/output/output_ast.ts\",\n+    \"packages/compiler/src/parse_util.ts\"\n+  ],\n+  [\n+    \"packages/compiler/src/compile_metadata.ts\",\n+    \"packages/compiler/src/util.ts\",\n+    \"packages/compiler/src/parse_util.ts\"\n+  ],\n   [\n     \"packages/compiler/src/output/output_ast.ts\",\n     \"packages/compiler/src/render3/view/i18n/meta.ts\"\n@@ -50,6 +99,11 @@\n     \"packages/compiler/src/render3/view/i18n/meta.ts\",\n     \"packages/compiler/src/render3/view/i18n/util.ts\"\n   ],\n+  [\n+    \"packages/compiler/src/render3/r3_factory.ts\",\n+    \"packages/compiler/src/render3/view/util.ts\",\n+    \"packages/compiler/src/render3/view/api.ts\"\n+  ],\n   [\n     \"packages/compiler/src/render3/view/styling_builder.ts\",\n     \"packages/compiler/src/render3/view/template.ts\""
        },
        {
            "sha": "47db67073a0561de8a31f1492b57f005ef34de08",
            "filename": "packages/compiler/src/aot/compiler.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,9 +6,9 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveMetadata, CompileInjectableMetadata, CompileNgModuleMetadata, CompilePipeMetadata, CompilePipeSummary, CompileProviderMetadata, CompileShallowModuleMetadata, CompileStylesheetMetadata, CompileTypeMetadata, CompileTypeSummary, componentFactoryName, flatten, templateSourceUrl} from '../compile_metadata';\n+import {CompileDirectiveMetadata, CompileIdentifierMetadata, CompileInjectableMetadata, CompileNgModuleMetadata, CompilePipeMetadata, CompilePipeSummary, CompileProviderMetadata, CompileShallowModuleMetadata, CompileStylesheetMetadata, CompileTypeMetadata, CompileTypeSummary, componentFactoryName, flatten, identifierName, templateSourceUrl} from '../compile_metadata';\n import {CompilerConfig} from '../config';\n-import {ConstantPool, OutputContext} from '../constant_pool';\n+import {ConstantPool} from '../constant_pool';\n import {ViewEncapsulation} from '../core';\n import {MessageBundle} from '../i18n/message_bundle';\n import {createTokenForExternalReference, Identifiers} from '../identifiers';\n@@ -19,12 +19,12 @@ import {InterpolationConfig} from '../ml_parser/interpolation_config';\n import {NgModuleCompiler} from '../ng_module_compiler';\n import {OutputEmitter} from '../output/abstract_emitter';\n import * as o from '../output/output_ast';\n-import {CompileIdentifierMetadata, identifierName, ParseError, syntaxError} from '../parse_util';\n+import {ParseError} from '../parse_util';\n import {CompiledStylesheet, StyleCompiler} from '../style_compiler';\n import {SummaryResolver} from '../summary_resolver';\n import {TemplateAst} from '../template_parser/template_ast';\n import {TemplateParser} from '../template_parser/template_parser';\n-import {newArray, ValueVisitor, visitValue} from '../util';\n+import {newArray, OutputContext, syntaxError, ValueVisitor, visitValue} from '../util';\n import {TypeCheckCompiler} from '../view_compiler/type_check_compiler';\n import {ViewCompiler, ViewCompileResult} from '../view_compiler/view_compiler';\n "
        },
        {
            "sha": "eeccffff68433432b30b664d98337203c0b2c98a",
            "filename": "packages/compiler/src/aot/compiler_factory.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler_factory.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler_factory.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler_factory.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -19,12 +19,12 @@ import {HtmlParser} from '../ml_parser/html_parser';\n import {NgModuleCompiler} from '../ng_module_compiler';\n import {NgModuleResolver} from '../ng_module_resolver';\n import {TypeScriptEmitter} from '../output/ts_emitter';\n-import {syntaxError} from '../parse_util';\n import {PipeResolver} from '../pipe_resolver';\n import {DomElementSchemaRegistry} from '../schema/dom_element_schema_registry';\n import {StyleCompiler} from '../style_compiler';\n import {TemplateParser} from '../template_parser/template_parser';\n import {UrlResolver} from '../url_resolver';\n+import {syntaxError} from '../util';\n import {TypeCheckCompiler} from '../view_compiler/type_check_compiler';\n import {ViewCompiler} from '../view_compiler/view_compiler';\n "
        },
        {
            "sha": "7a26975c5b24974a4cb1dc219ee55ecb1fbee23c",
            "filename": "packages/compiler/src/aot/formatted_error.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fformatted_error.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fformatted_error.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fformatted_error.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {syntaxError} from '../parse_util';\n+import {syntaxError} from '../util';\n \n export interface Position {\n   fileName: string;"
        },
        {
            "sha": "c6b8e98503a4a9d63ad87c495d4dbc3fb06a8f9e",
            "filename": "packages/compiler/src/aot/static_reflector.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fstatic_reflector.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fstatic_reflector.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fstatic_reflector.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -10,8 +10,8 @@ import {CompileSummaryKind} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n import {createAttribute, createComponent, createContentChild, createContentChildren, createDirective, createHost, createHostBinding, createHostListener, createInject, createInjectable, createInput, createNgModule, createOptional, createOutput, createPipe, createSelf, createSkipSelf, createViewChild, createViewChildren, MetadataFactory} from '../core';\n import * as o from '../output/output_ast';\n-import {syntaxError} from '../parse_util';\n import {SummaryResolver} from '../summary_resolver';\n+import {syntaxError} from '../util';\n \n import {formattedError, FormattedMessageChain} from './formatted_error';\n import {StaticSymbol} from './static_symbol';"
        },
        {
            "sha": "fb7523da5e38092f5e4aa514ebce50459408f5d5",
            "filename": "packages/compiler/src/aot/summary_serializer.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fsummary_serializer.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Faot%2Fsummary_serializer.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fsummary_serializer.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,10 +6,9 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n import {CompileDirectiveMetadata, CompileDirectiveSummary, CompileNgModuleMetadata, CompileNgModuleSummary, CompilePipeMetadata, CompileProviderMetadata, CompileSummaryKind, CompileTypeMetadata, CompileTypeSummary} from '../compile_metadata';\n-import {OutputContext} from '../constant_pool';\n import * as o from '../output/output_ast';\n import {Summary, SummaryResolver} from '../summary_resolver';\n-import {ValueTransformer, ValueVisitor, visitValue} from '../util';\n+import {OutputContext, ValueTransformer, ValueVisitor, visitValue} from '../util';\n \n import {StaticSymbol, StaticSymbolCache} from './static_symbol';\n import {ResolvedStaticSymbol, StaticSymbolResolver, unwrapResolvedMetadata} from './static_symbol_resolver';"
        },
        {
            "sha": "b111371da61b11412c95c479dfe49da67601413a",
            "filename": "packages/compiler/src/compile_metadata.ts",
            "status": "modified",
            "additions": 48,
            "deletions": 2,
            "changes": 50,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fcompile_metadata.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fcompile_metadata.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fcompile_metadata.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -10,15 +10,57 @@ import {StaticSymbol} from './aot/static_symbol';\n import {ChangeDetectionStrategy, SchemaMetadata, Type, ViewEncapsulation} from './core';\n import {LifecycleHooks} from './lifecycle_reflector';\n import {ParseTreeResult as HtmlParseTreeResult} from './ml_parser/parser';\n-import {CompileIdentifierMetadata, identifierName, sanitizeIdentifier} from './parse_util';\n-import {splitAtColon} from './util';\n+import {splitAtColon, stringify} from './util';\n \n // group 0: \"[prop] or (event) or @trigger\"\n // group 1: \"prop\" from \"[prop]\"\n // group 2: \"event\" from \"(event)\"\n // group 3: \"@trigger\" from \"@trigger\"\n const HOST_REG_EXP = /^(?:(?:\\[([^\\]]+)\\])|(?:\\(([^\\)]+)\\)))|(\\@[-\\w]+)$/;\n \n+export function sanitizeIdentifier(name: string): string {\n+  return name.replace(/\\W/g, '_');\n+}\n+\n+let _anonymousTypeIndex = 0;\n+\n+export function identifierName(compileIdentifier: CompileIdentifierMetadata|null|undefined): string|\n+    null {\n+  if (!compileIdentifier || !compileIdentifier.reference) {\n+    return null;\n+  }\n+  const ref = compileIdentifier.reference;\n+  if (ref instanceof StaticSymbol) {\n+    return ref.name;\n+  }\n+  if (ref['__anonymousType']) {\n+    return ref['__anonymousType'];\n+  }\n+  if (ref['__forward_ref__']) {\n+    // We do not want to try to stringify a `forwardRef()` function because that would cause the\n+    // inner function to be evaluated too early, defeating the whole point of the `forwardRef`.\n+    return '__forward_ref__';\n+  }\n+  let identifier = stringify(ref);\n+  if (identifier.indexOf('(') >= 0) {\n+    // case: anonymous functions!\n+    identifier = `anonymous_${_anonymousTypeIndex++}`;\n+    ref['__anonymousType'] = identifier;\n+  } else {\n+    identifier = sanitizeIdentifier(identifier);\n+  }\n+  return identifier;\n+}\n+\n+export function identifierModuleUrl(compileIdentifier: CompileIdentifierMetadata): string {\n+  const ref = compileIdentifier.reference;\n+  if (ref instanceof StaticSymbol) {\n+    return ref.filePath;\n+  }\n+  // Runtime type\n+  return `./${stringify(ref)}`;\n+}\n+\n export function viewClassName(compType: any, embeddedTemplateIndex: number): string {\n   return `View_${identifierName({reference: compType})}_${embeddedTemplateIndex}`;\n }\n@@ -39,6 +81,10 @@ export interface ProxyClass {\n   setDelegate(delegate: any): void;\n }\n \n+export interface CompileIdentifierMetadata {\n+  reference: any;\n+}\n+\n export enum CompileSummaryKind {\n   Pipe,\n   Directive,"
        },
        {
            "sha": "af28935d55b1a36d088e7ca22805569bff177b30",
            "filename": "packages/compiler/src/compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fcompiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -88,7 +88,7 @@ export * from './selector';\n export * from './style_compiler';\n export * from './template_parser/template_parser';\n export {ViewCompiler} from './view_compiler/view_compiler';\n-export {Version} from './util';\n+export {getParseErrors, isSyntaxError, syntaxError, Version} from './util';\n export {SourceMap} from './output/source_map';\n export * from './injectable_compiler_2';\n export * from './render3/partial/api';"
        },
        {
            "sha": "a380c29807be00f964a244f58076341c08135d82",
            "filename": "packages/compiler/src/constant_pool.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 7,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fconstant_pool.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fconstant_pool.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fconstant_pool.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -7,6 +7,7 @@\n  */\n \n import * as o from './output/output_ast';\n+import {error, OutputContext} from './util';\n \n const CONSTANT_PREFIX = '_c';\n \n@@ -275,13 +276,6 @@ export class ConstantPool {\n   }\n }\n \n-export interface OutputContext {\n-  genFilePath: string;\n-  statements: o.Statement[];\n-  constantPool: ConstantPool;\n-  importExpr(reference: any, typeParams?: o.Type[]|null, useSummaries?: boolean): o.Expression;\n-}\n-\n /**\n  * Visitor used to determine if 2 expressions are equivalent and can be shared in the\n  * `ConstantPool`."
        },
        {
            "sha": "372db43b145c935b1a031255ff5569d7d92db5da",
            "filename": "packages/compiler/src/directive_normalizer.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fdirective_normalizer.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fdirective_normalizer.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fdirective_normalizer.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -13,12 +13,11 @@ import * as html from './ml_parser/ast';\n import {HtmlParser} from './ml_parser/html_parser';\n import {InterpolationConfig} from './ml_parser/interpolation_config';\n import {ParseTreeResult as HtmlParseTreeResult} from './ml_parser/parser';\n-import {syntaxError} from './parse_util';\n import {ResourceLoader} from './resource_loader';\n import {extractStyleUrls, isStyleUrlResolvable} from './style_url_resolver';\n import {PreparsedElementType, preparseElement} from './template_parser/template_preparser';\n import {UrlResolver} from './url_resolver';\n-import {isDefined, stringify, SyncAsync} from './util';\n+import {isDefined, stringify, SyncAsync, syntaxError} from './util';\n \n export interface PrenormalizedTemplateMetadata {\n   ngModuleType: any;"
        },
        {
            "sha": "26919b38ceb5de30a9326ac1dc9247778c72c59b",
            "filename": "packages/compiler/src/i18n/extractor.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fi18n%2Fextractor.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fi18n%2Fextractor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fi18n%2Fextractor.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -28,6 +28,7 @@ import {NgModuleResolver} from '../ng_module_resolver';\n import {ParseError} from '../parse_util';\n import {PipeResolver} from '../pipe_resolver';\n import {DomElementSchemaRegistry} from '../schema/dom_element_schema_registry';\n+import {syntaxError} from '../util';\n \n import {MessageBundle} from './message_bundle';\n "
        },
        {
            "sha": "533577a6ddb0c7e790b12aafabc312048cdb5c68",
            "filename": "packages/compiler/src/injectable_compiler.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Finjectable_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Finjectable_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Finjectable_compiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -7,15 +7,14 @@\n  */\n \n import {StaticSymbol} from './aot/static_symbol';\n-import {CompileInjectableMetadata} from './compile_metadata';\n+import {CompileInjectableMetadata, identifierName} from './compile_metadata';\n import {CompileReflector} from './compile_reflector';\n-import {OutputContext} from './constant_pool';\n import {InjectFlags} from './core';\n import {Identifiers} from './identifiers';\n import * as o from './output/output_ast';\n import {convertValueToOutputAst} from './output/value_util';\n-import {identifierName} from './parse_util';\n import {Identifiers as R3} from './render3/r3_identifiers';\n+import {OutputContext} from './util';\n \n type MapEntry = {\n   key: string,"
        },
        {
            "sha": "d7adba8d90659a17387950711fe496f5817e6b4b",
            "filename": "packages/compiler/src/jit/compiler.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fjit%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fjit%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fjit%2Fcompiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,22 +6,21 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveMetadata, CompileNgModuleMetadata, CompilePipeSummary, CompileProviderMetadata, CompileTypeSummary, ngModuleJitUrl, ProxyClass, sharedStylesheetJitUrl, templateJitUrl, templateSourceUrl} from '../compile_metadata';\n+import {CompileDirectiveMetadata, CompileIdentifierMetadata, CompileNgModuleMetadata, CompilePipeSummary, CompileProviderMetadata, CompileStylesheetMetadata, CompileTypeSummary, identifierName, ngModuleJitUrl, ProviderMeta, ProxyClass, sharedStylesheetJitUrl, templateJitUrl, templateSourceUrl} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n import {CompilerConfig} from '../config';\n-import {ConstantPool, OutputContext} from '../constant_pool';\n+import {ConstantPool} from '../constant_pool';\n import {Type} from '../core';\n import {CompileMetadataResolver} from '../metadata_resolver';\n import {NgModuleCompiler} from '../ng_module_compiler';\n import * as ir from '../output/output_ast';\n import {interpretStatements} from '../output/output_interpreter';\n import {JitEvaluator} from '../output/output_jit';\n-import {CompileIdentifierMetadata, identifierName} from '../parse_util';\n import {CompiledStylesheet, StyleCompiler} from '../style_compiler';\n import {SummaryResolver} from '../summary_resolver';\n import {TemplateAst} from '../template_parser/template_ast';\n import {TemplateParser} from '../template_parser/template_parser';\n-import {Console, stringify, SyncAsync} from '../util';\n+import {Console, OutputContext, stringify, SyncAsync} from '../util';\n import {ViewCompiler} from '../view_compiler/view_compiler';\n \n export interface ModuleWithComponentFactories {"
        },
        {
            "sha": "0bf9de3709193efda16f269b5b6a0ce70a7a9838",
            "filename": "packages/compiler/src/metadata_resolver.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 13,
            "changes": 25,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fmetadata_resolver.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fmetadata_resolver.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fmetadata_resolver.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -19,12 +19,11 @@ import {Identifiers} from './identifiers';\n import {getAllLifecycleHooks} from './lifecycle_reflector';\n import {HtmlParser} from './ml_parser/html_parser';\n import {NgModuleResolver} from './ng_module_resolver';\n-import {CompileIdentifierMetadata, identifierName, syntaxError} from './parse_util';\n import {PipeResolver} from './pipe_resolver';\n import {ElementSchemaRegistry} from './schema/element_schema_registry';\n import {CssSelector} from './selector';\n import {SummaryResolver} from './summary_resolver';\n-import {Console, isPromise, noUndefined, resolveForwardRef, stringify, SyncAsync, ValueTransformer, visitValue} from './util';\n+import {Console, isPromise, noUndefined, resolveForwardRef, stringify, SyncAsync, syntaxError, ValueTransformer, visitValue} from './util';\n \n export type ErrorCollector = (error: any, type?: any) => void;\n \n@@ -131,7 +130,7 @@ export class CompileMetadataResolver {\n   }\n \n   getHostComponentType(dirType: any): StaticSymbol|cpl.ProxyClass {\n-    const name = `${identifierName({reference: dirType})}_Host`;\n+    const name = `${cpl.identifierName({reference: dirType})}_Host`;\n     if (dirType instanceof StaticSymbol) {\n       return this._staticSymbolCache.get(dirType.filePath, name);\n     }\n@@ -534,14 +533,14 @@ export class CompileMetadataResolver {\n     if (!meta) {\n       return null;\n     }\n-    const declaredDirectives: CompileIdentifierMetadata[] = [];\n-    const exportedNonModuleIdentifiers: CompileIdentifierMetadata[] = [];\n-    const declaredPipes: CompileIdentifierMetadata[] = [];\n+    const declaredDirectives: cpl.CompileIdentifierMetadata[] = [];\n+    const exportedNonModuleIdentifiers: cpl.CompileIdentifierMetadata[] = [];\n+    const declaredPipes: cpl.CompileIdentifierMetadata[] = [];\n     const importedModules: cpl.CompileNgModuleSummary[] = [];\n     const exportedModules: cpl.CompileNgModuleSummary[] = [];\n     const providers: cpl.CompileProviderMetadata[] = [];\n     const entryComponents: cpl.CompileEntryComponentMetadata[] = [];\n-    const bootstrapComponents: CompileIdentifierMetadata[] = [];\n+    const bootstrapComponents: cpl.CompileIdentifierMetadata[] = [];\n     const schemas: SchemaMetadata[] = [];\n \n     if (meta.imports) {\n@@ -673,8 +672,8 @@ export class CompileMetadataResolver {\n       });\n     }\n \n-    const exportedDirectives: CompileIdentifierMetadata[] = [];\n-    const exportedPipes: CompileIdentifierMetadata[] = [];\n+    const exportedDirectives: cpl.CompileIdentifierMetadata[] = [];\n+    const exportedPipes: cpl.CompileIdentifierMetadata[] = [];\n     exportedNonModuleIdentifiers.forEach((exportedId) => {\n       if (transitiveModule.directivesSet.has(exportedId.reference)) {\n         exportedDirectives.push(exportedId);\n@@ -837,7 +836,7 @@ export class CompileMetadataResolver {\n     return result;\n   }\n \n-  private _getIdentifierMetadata(type: Type): CompileIdentifierMetadata {\n+  private _getIdentifierMetadata(type: Type): cpl.CompileIdentifierMetadata {\n     type = resolveForwardRef(type);\n     return {reference: type};\n   }\n@@ -1094,7 +1093,7 @@ export class CompileMetadataResolver {\n   private _getEntryComponentsFromProvider(provider: cpl.ProviderMeta, type?: any):\n       cpl.CompileEntryComponentMetadata[] {\n     const components: cpl.CompileEntryComponentMetadata[] = [];\n-    const collectedIdentifiers: CompileIdentifierMetadata[] = [];\n+    const collectedIdentifiers: cpl.CompileIdentifierMetadata[] = [];\n \n     if (provider.useFactory || provider.useExisting || provider.useClass) {\n       this._reportError(\n@@ -1264,12 +1263,12 @@ function isValidType(value: any): boolean {\n   return (value instanceof StaticSymbol) || (value instanceof Type);\n }\n \n-function extractIdentifiers(value: any, targetIdentifiers: CompileIdentifierMetadata[]) {\n+function extractIdentifiers(value: any, targetIdentifiers: cpl.CompileIdentifierMetadata[]) {\n   visitValue(value, new _CompileValueConverter(), targetIdentifiers);\n }\n \n class _CompileValueConverter extends ValueTransformer {\n-  override visitOther(value: any, targetIdentifiers: CompileIdentifierMetadata[]): any {\n+  override visitOther(value: any, targetIdentifiers: cpl.CompileIdentifierMetadata[]): any {\n     targetIdentifiers.push({reference: value});\n   }\n }"
        },
        {
            "sha": "7fa3fd14a071c8f5aff077c5b6c3d016011d6ec9",
            "filename": "packages/compiler/src/ng_module_compiler.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fng_module_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fng_module_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fng_module_compiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,14 +6,14 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileNgModuleMetadata, CompileProviderMetadata} from './compile_metadata';\n+import {CompileNgModuleMetadata, CompileProviderMetadata, identifierName} from './compile_metadata';\n import {CompileReflector} from './compile_reflector';\n-import {OutputContext} from './constant_pool';\n import {NodeFlags} from './core';\n import {Identifiers} from './identifiers';\n import * as o from './output/output_ast';\n-import {identifierName, typeSourceSpan} from './parse_util';\n+import {typeSourceSpan} from './parse_util';\n import {NgModuleProviderAnalyzer} from './provider_analyzer';\n+import {OutputContext} from './util';\n import {componentFactoryResolverProviderDef, depDef, providerDef} from './view_compiler/provider_compiler';\n \n export class NgModuleCompileResult {"
        },
        {
            "sha": "1091dd1d3fabac649b21317b71f4a17e43a6ee9d",
            "filename": "packages/compiler/src/output/js_emitter.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Foutput%2Fjs_emitter.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Foutput%2Fjs_emitter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Foutput%2Fjs_emitter.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -5,6 +5,11 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n+\n+\n+import {StaticSymbol} from '../aot/static_symbol';\n+import {CompileIdentifierMetadata} from '../compile_metadata';\n+\n import {EmitterVisitorContext, OutputEmitter} from './abstract_emitter';\n import {AbstractJsEmitterVisitor} from './abstract_js_emitter';\n import * as o from './output_ast';"
        },
        {
            "sha": "ae511e6e54a1cc8bc35feda3906769b79ded8920",
            "filename": "packages/compiler/src/output/output_ast.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_ast.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_ast.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_ast.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,6 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n+\n import {ParseSourceSpan} from '../parse_util';\n import {I18nMeta} from '../render3/view/i18n/meta';\n "
        },
        {
            "sha": "95ec8cc9408d12719352343b31d93a4c3dd11074",
            "filename": "packages/compiler/src/output/output_jit.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_jit.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_jit.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_jit.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,8 +6,8 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n+import {identifierName} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n-import {identifierName} from '../parse_util';\n \n import {EmitterVisitorContext} from './abstract_emitter';\n import {AbstractJsEmitterVisitor} from './abstract_js_emitter';"
        },
        {
            "sha": "a567004669db77680293cfb06478a2fbc0982ca6",
            "filename": "packages/compiler/src/output/value_util.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Foutput%2Fvalue_util.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Foutput%2Fvalue_util.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Foutput%2Fvalue_util.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -7,8 +7,7 @@\n  */\n \n \n-import {OutputContext} from '../constant_pool';\n-import {ValueTransformer, visitValue} from '../util';\n+import {OutputContext, ValueTransformer, visitValue} from '../util';\n \n import * as o from './output_ast';\n "
        },
        {
            "sha": "190233f41328a2d333f66db2fa81290ef9e1f990",
            "filename": "packages/compiler/src/parse_util.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 67,
            "changes": 68,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fparse_util.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fparse_util.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fparse_util.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -5,9 +5,8 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-import {StaticSymbol} from './aot/static_symbol';\n import * as chars from './chars';\n-import {stringify} from './util';\n+import {CompileIdentifierMetadata, identifierModuleUrl, identifierName} from './compile_metadata';\n \n export class ParseLocation {\n   constructor(\n@@ -179,68 +178,3 @@ export function r3JitTypeSourceSpan(\n   return new ParseSourceSpan(\n       new ParseLocation(sourceFile, -1, -1, -1), new ParseLocation(sourceFile, -1, -1, -1));\n }\n-\n-export function syntaxError(msg: string, parseErrors?: ParseError[]): Error {\n-  const error = Error(msg);\n-  (error as any)[ERROR_SYNTAX_ERROR] = true;\n-  if (parseErrors) (error as any)[ERROR_PARSE_ERRORS] = parseErrors;\n-  return error;\n-}\n-\n-const ERROR_SYNTAX_ERROR = 'ngSyntaxError';\n-const ERROR_PARSE_ERRORS = 'ngParseErrors';\n-\n-export function isSyntaxError(error: Error): boolean {\n-  return (error as any)[ERROR_SYNTAX_ERROR];\n-}\n-\n-export function getParseErrors(error: Error): ParseError[] {\n-  return (error as any)[ERROR_PARSE_ERRORS] || [];\n-}\n-\n-let _anonymousTypeIndex = 0;\n-\n-export function identifierName(compileIdentifier: CompileIdentifierMetadata|null|undefined): string|\n-    null {\n-  if (!compileIdentifier || !compileIdentifier.reference) {\n-    return null;\n-  }\n-  const ref = compileIdentifier.reference;\n-  if (ref instanceof StaticSymbol) {\n-    return ref.name;\n-  }\n-  if (ref['__anonymousType']) {\n-    return ref['__anonymousType'];\n-  }\n-  if (ref['__forward_ref__']) {\n-    // We do not want to try to stringify a `forwardRef()` function because that would cause the\n-    // inner function to be evaluated too early, defeating the whole point of the `forwardRef`.\n-    return '__forward_ref__';\n-  }\n-  let identifier = stringify(ref);\n-  if (identifier.indexOf('(') >= 0) {\n-    // case: anonymous functions!\n-    identifier = `anonymous_${_anonymousTypeIndex++}`;\n-    ref['__anonymousType'] = identifier;\n-  } else {\n-    identifier = sanitizeIdentifier(identifier);\n-  }\n-  return identifier;\n-}\n-\n-export function identifierModuleUrl(compileIdentifier: CompileIdentifierMetadata): string {\n-  const ref = compileIdentifier.reference;\n-  if (ref instanceof StaticSymbol) {\n-    return ref.filePath;\n-  }\n-  // Runtime type\n-  return `./${stringify(ref)}`;\n-}\n-\n-export interface CompileIdentifierMetadata {\n-  reference: any;\n-}\n-\n-export function sanitizeIdentifier(name: string): string {\n-  return name.replace(/\\W/g, '_');\n-}"
        },
        {
            "sha": "8cc4dbfc0605dd384982b8bf776eb03d883a9848",
            "filename": "packages/compiler/src/render3/r3_factory.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Frender3%2Fr3_factory.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Frender3%2Fr3_factory.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fr3_factory.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -5,10 +5,17 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n+\n+import {StaticSymbol} from '../aot/static_symbol';\n+import {CompileTypeMetadata, tokenReference} from '../compile_metadata';\n import {InjectFlags} from '../core';\n import * as o from '../output/output_ast';\n import {Identifiers as R3} from '../render3/r3_identifiers';\n+import {OutputContext} from '../util';\n+\n import {R3CompiledExpression, R3Reference, typeWithParameters} from './util';\n+import {unsupported} from './view/util';\n+\n \n \n /**"
        },
        {
            "sha": "49825e0a2ca90e61bf52f4b8d14d7632cfcef9a5",
            "filename": "packages/compiler/src/render3/view/compiler.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fcompiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,13 +6,13 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveSummary} from '../../compile_metadata';\n+import {CompileDirectiveSummary, sanitizeIdentifier} from '../../compile_metadata';\n import {BindingForm, convertPropertyBinding} from '../../compiler_util/expression_converter';\n import {ConstantPool} from '../../constant_pool';\n import * as core from '../../core';\n import {AST, ParsedEvent, ParsedEventType, ParsedProperty} from '../../expression_parser/ast';\n import * as o from '../../output/output_ast';\n-import {ParseError, ParseSourceSpan, sanitizeIdentifier} from '../../parse_util';\n+import {ParseError, ParseSourceSpan} from '../../parse_util';\n import {CssSelector, SelectorMatcher} from '../../selector';\n import {ShadowCss} from '../../shadow_css';\n import {CONTENT_ATTR, HOST_ATTR} from '../../style_compiler';"
        },
        {
            "sha": "600c955626bd9dfaa8b4cd097ad9d92c3e876689",
            "filename": "packages/compiler/src/render3/view/template.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {flatten} from '../../compile_metadata';\n+import {flatten, sanitizeIdentifier} from '../../compile_metadata';\n import {BindingForm, BuiltinFunctionCall, convertActionBinding, convertPropertyBinding, convertUpdateArguments, LocalResolver} from '../../compiler_util/expression_converter';\n import {ConstantPool} from '../../constant_pool';\n import * as core from '../../core';\n@@ -22,7 +22,7 @@ import {LexerRange} from '../../ml_parser/lexer';\n import {isNgContainer as checkIsNgContainer, splitNsName} from '../../ml_parser/tags';\n import {mapLiteral} from '../../output/map_util';\n import * as o from '../../output/output_ast';\n-import {ParseError, ParseSourceSpan, sanitizeIdentifier} from '../../parse_util';\n+import {ParseError, ParseSourceFile, ParseSourceSpan} from '../../parse_util';\n import {DomElementSchemaRegistry} from '../../schema/dom_element_schema_registry';\n import {isTrustedTypesSink} from '../../schema/trusted_types_sinks';\n import {CssSelector, SelectorMatcher} from '../../selector';"
        },
        {
            "sha": "abd2690c3d7b872d5612ebbd10f52e03af400b3f",
            "filename": "packages/compiler/src/style_compiler.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fstyle_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fstyle_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fstyle_compiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,13 +6,12 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveMetadata, CompileStylesheetMetadata} from './compile_metadata';\n-import {OutputContext} from './constant_pool';\n+import {CompileDirectiveMetadata, CompileIdentifierMetadata, CompileStylesheetMetadata, identifierModuleUrl, identifierName} from './compile_metadata';\n import {ViewEncapsulation} from './core';\n import * as o from './output/output_ast';\n-import {identifierModuleUrl, identifierName} from './parse_util';\n import {ShadowCss} from './shadow_css';\n import {UrlResolver} from './url_resolver';\n+import {OutputContext} from './util';\n \n const COMPONENT_VARIABLE = '%COMP%';\n export const HOST_ATTR = `_nghost-${COMPONENT_VARIABLE}`;"
        },
        {
            "sha": "098e8f4979119ebcddef31087fda880d9f1e9062",
            "filename": "packages/compiler/src/template_parser/template_parser.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Ftemplate_parser%2Ftemplate_parser.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Ftemplate_parser%2Ftemplate_parser.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Ftemplate_parser%2Ftemplate_parser.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveMetadata, CompileDirectiveSummary, CompilePipeSummary, CompileTokenMetadata, CompileTypeMetadata} from '../compile_metadata';\n+import {CompileDirectiveMetadata, CompileDirectiveSummary, CompilePipeSummary, CompileTokenMetadata, CompileTypeMetadata, identifierName} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n import {CompilerConfig} from '../config';\n import {SchemaMetadata} from '../core';\n@@ -19,12 +19,12 @@ import {removeWhitespaces, replaceNgsp} from '../ml_parser/html_whitespaces';\n import {expandNodes} from '../ml_parser/icu_ast_expander';\n import {InterpolationConfig} from '../ml_parser/interpolation_config';\n import {isNgTemplate, splitNsName} from '../ml_parser/tags';\n-import {identifierName, ParseError, ParseErrorLevel, ParseSourceSpan, syntaxError} from '../parse_util';\n+import {ParseError, ParseErrorLevel, ParseSourceSpan} from '../parse_util';\n import {ProviderElementContext, ProviderViewContext} from '../provider_analyzer';\n import {ElementSchemaRegistry} from '../schema/element_schema_registry';\n import {CssSelector, SelectorMatcher} from '../selector';\n import {isStyleUrlResolvable} from '../style_url_resolver';\n-import {Console, newArray} from '../util';\n+import {Console, newArray, syntaxError} from '../util';\n \n import {BindingParser} from './binding_parser';\n import * as t from './template_ast';"
        },
        {
            "sha": "8c62653f09b2dfe1f8d428556a7c209142291c51",
            "filename": "packages/compiler/src/util.ts",
            "status": "modified",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Futil.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,6 +6,11 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n+import {ConstantPool} from './constant_pool';\n+\n+import * as o from './output/output_ast';\n+import {ParseError} from './parse_util';\n+\n const DASH_CASE_REGEXP = /-+([a-z0-9])/g;\n \n export function dashCaseToCamelCase(input: string): string {\n@@ -99,6 +104,24 @@ export function error(msg: string): never {\n   throw new Error(`Internal Error: ${msg}`);\n }\n \n+export function syntaxError(msg: string, parseErrors?: ParseError[]): Error {\n+  const error = Error(msg);\n+  (error as any)[ERROR_SYNTAX_ERROR] = true;\n+  if (parseErrors) (error as any)[ERROR_PARSE_ERRORS] = parseErrors;\n+  return error;\n+}\n+\n+const ERROR_SYNTAX_ERROR = 'ngSyntaxError';\n+const ERROR_PARSE_ERRORS = 'ngParseErrors';\n+\n+export function isSyntaxError(error: Error): boolean {\n+  return (error as any)[ERROR_SYNTAX_ERROR];\n+}\n+\n+export function getParseErrors(error: Error): ParseError[] {\n+  return (error as any)[ERROR_PARSE_ERRORS] || [];\n+}\n+\n // Escape characters that have a special meaning in Regular Expressions\n export function escapeRegExp(s: string): string {\n   return s.replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g, '\\\\$1');\n@@ -143,6 +166,13 @@ export function utf8Encode(str: string): Byte[] {\n   return encoded;\n }\n \n+export interface OutputContext {\n+  genFilePath: string;\n+  statements: o.Statement[];\n+  constantPool: ConstantPool;\n+  importExpr(reference: any, typeParams?: o.Type[]|null, useSummaries?: boolean): o.Expression;\n+}\n+\n export function stringify(token: any): string {\n   if (typeof token === 'string') {\n     return token;"
        },
        {
            "sha": "b893f3848a22160896d7b88c7b2f65a36490432b",
            "filename": "packages/compiler/src/view_compiler/provider_compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fprovider_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fprovider_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fprovider_compiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -8,13 +8,13 @@\n \n import {CompileDiDependencyMetadata, CompileEntryComponentMetadata, CompileProviderMetadata, CompileTokenMetadata} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n-import {OutputContext} from '../constant_pool';\n import {DepFlags, NodeFlags} from '../core';\n import {createTokenForExternalReference, Identifiers} from '../identifiers';\n import {LifecycleHooks} from '../lifecycle_reflector';\n import * as o from '../output/output_ast';\n import {convertValueToOutputAst} from '../output/value_util';\n import {ProviderAst, ProviderAstType} from '../template_parser/template_ast';\n+import {OutputContext} from '../util';\n \n export function providerDef(ctx: OutputContext, providerAst: ProviderAst): {\n   providerExpr: o.Expression,"
        },
        {
            "sha": "9518b0a77d924674978964ed10dde7d65cb1d513",
            "filename": "packages/compiler/src/view_compiler/type_check_compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Ftype_check_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Ftype_check_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Ftype_check_compiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -11,11 +11,11 @@ import {StaticReflector} from '../aot/static_reflector';\n import {StaticSymbol} from '../aot/static_symbol';\n import {CompileDirectiveMetadata, CompilePipeSummary} from '../compile_metadata';\n import {BindingForm, convertActionBinding, convertPropertyBinding, convertPropertyBindingBuiltins, EventHandlerVars, LocalResolver} from '../compiler_util/expression_converter';\n-import {OutputContext} from '../constant_pool';\n import {AST, ASTWithSource, Interpolation} from '../expression_parser/ast';\n import * as o from '../output/output_ast';\n import {ParseSourceSpan} from '../parse_util';\n import {AttrAst, BoundDirectivePropertyAst, BoundElementPropertyAst, BoundEventAst, BoundTextAst, DirectiveAst, ElementAst, EmbeddedTemplateAst, NgContentAst, ReferenceAst, TemplateAst, TemplateAstVisitor, templateVisitAll, TextAst, VariableAst} from '../template_parser/template_ast';\n+import {OutputContext} from '../util';\n \n \n /**"
        },
        {
            "sha": "4cbe72a4d8e352b7a277a8c3f0b02f71a14ad227",
            "filename": "packages/compiler/src/view_compiler/view_compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fview_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fview_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fview_compiler.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -9,7 +9,6 @@\n import {CompileDirectiveMetadata, CompilePipeSummary, CompileQueryMetadata, rendererTypeName, tokenReference, viewClassName} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n import {BindingForm, BuiltinConverter, convertActionBinding, convertPropertyBinding, convertPropertyBindingBuiltins, EventHandlerVars, LocalResolver} from '../compiler_util/expression_converter';\n-import {OutputContext} from '../constant_pool';\n import {ArgumentType, BindingFlags, ChangeDetectionStrategy, NodeFlags, QueryBindingType, QueryValueType, ViewFlags} from '../core';\n import {AST, ASTWithSource, Interpolation} from '../expression_parser/ast';\n import {Identifiers} from '../identifiers';\n@@ -19,6 +18,7 @@ import * as o from '../output/output_ast';\n import {convertValueToOutputAst} from '../output/value_util';\n import {ParseSourceSpan} from '../parse_util';\n import {AttrAst, BoundDirectivePropertyAst, BoundElementPropertyAst, BoundEventAst, BoundTextAst, DirectiveAst, ElementAst, EmbeddedTemplateAst, NgContentAst, PropertyBindingType, ProviderAst, QueryMatch, ReferenceAst, TemplateAst, TemplateAstVisitor, templateVisitAll, TextAst, VariableAst} from '../template_parser/template_ast';\n+import {OutputContext} from '../util';\n \n import {componentFactoryResolverProviderDef, depDef, lifecycleHookToNodeFlag, providerDef} from './provider_compiler';\n "
        },
        {
            "sha": "5384580f7f77aa2df7c35de8947be4a5ff8d0548",
            "filename": "packages/compiler/test/aot/summary_resolver_spec.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Ftest%2Faot%2Fsummary_resolver_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Ftest%2Faot%2Fsummary_resolver_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Ftest%2Faot%2Fsummary_resolver_spec.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,10 +6,11 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {AotSummaryResolver, AotSummaryResolverHost, ResolvedStaticSymbol, StaticSymbolCache, StaticSymbolResolver} from '@angular/compiler';\n-import {serializeSummaries} from '@angular/compiler/src/aot/summary_serializer';\n-import {ConstantPool, OutputContext} from '@angular/compiler/src/constant_pool';\n+import {AotSummaryResolver, AotSummaryResolverHost, CompileSummaryKind, CompileTypeSummary, ResolvedStaticSymbol, StaticSymbol, StaticSymbolCache, StaticSymbolResolver} from '@angular/compiler';\n+import {deserializeSummaries, serializeSummaries} from '@angular/compiler/src/aot/summary_serializer';\n+import {ConstantPool} from '@angular/compiler/src/constant_pool';\n import * as o from '@angular/compiler/src/output/output_ast';\n+import {OutputContext} from '@angular/compiler/src/util';\n import * as path from 'path';\n \n import {MockStaticSymbolResolverHost, MockSummaryResolver} from './static_symbol_resolver_spec';"
        },
        {
            "sha": "040d075b4c250bb02862126daab8e6441f6f24c5",
            "filename": "packages/compiler/test/metadata_resolver_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Ftest%2Fmetadata_resolver_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Ftest%2Fmetadata_resolver_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Ftest%2Fmetadata_resolver_spec.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -10,9 +10,8 @@ import {LIFECYCLE_HOOKS_VALUES, LifecycleHooks} from '@angular/compiler/src/life\n import {AfterContentChecked, AfterContentInit, AfterViewChecked, AfterViewInit, ChangeDetectionStrategy, Component, Directive, DoCheck, Injectable, NgModule, OnChanges, OnDestroy, OnInit, Pipe, SimpleChanges, ViewEncapsulation, stringify as stringify} from '@angular/core';\n import {inject, TestBed, waitForAsync} from '@angular/core/testing';\n \n-import {CompileDiDependencyMetadata} from '../src/compile_metadata';\n+import {CompileDiDependencyMetadata, identifierName} from '../src/compile_metadata';\n import {CompileMetadataResolver} from '../src/metadata_resolver';\n-import {identifierName} from '../src/parse_util';\n import {ResourceLoader} from '../src/resource_loader';\n import {MockResourceLoader} from '../testing/src/resource_loader_mock';\n "
        },
        {
            "sha": "3a47c0b1a43a578872359fc1c707d6404e41c350",
            "filename": "packages/compiler/test/output/js_emitter_node_only_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Ftest%2Foutput%2Fjs_emitter_node_only_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/9436f4bf7725fab635c75755d02fe71ded5b5a5a/packages%2Fcompiler%2Ftest%2Foutput%2Fjs_emitter_node_only_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Ftest%2Foutput%2Fjs_emitter_node_only_spec.ts?ref=9436f4bf7725fab635c75755d02fe71ded5b5a5a",
            "patch": "@@ -6,6 +6,8 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n+import {StaticSymbol} from '@angular/compiler/src/aot/static_symbol';\n+import {CompileIdentifierMetadata} from '@angular/compiler/src/compile_metadata';\n import {JavaScriptEmitter} from '@angular/compiler/src/output/js_emitter';\n import * as o from '@angular/compiler/src/output/output_ast';\n import {SourceMap} from '@angular/compiler/src/output/source_map';"
        }
    ],
    "stats": {
        "total": 331,
        "additions": 199,
        "deletions": 132
    }
}