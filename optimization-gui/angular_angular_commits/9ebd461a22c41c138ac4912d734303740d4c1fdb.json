{
    "author": "gkalpak",
    "message": "refactor(docs-infra): improve code readability of `CopierService` (#38244)\n\nThis commit improves the code readability of the `CopierService` by:\n- Adding/Improving JSDoc comments for methods.\n- Avoiding unnecessary instance-wide properties.\n- Fixing indentation to be consistent (at two spaces).\n- Clearly separating the logic for creating and populating a\n  `<textarea>` from the logic for selecting and copying its contents.\n\nPR Close #38244",
    "sha": "9ebd461a22c41c138ac4912d734303740d4c1fdb",
    "files": [
        {
            "sha": "6b62ca7b3b9197d6ca3bef4f888138ce3ba0b229",
            "filename": "aio/src/app/shared/copier.service.ts",
            "status": "modified",
            "additions": 67,
            "deletions": 43,
            "changes": 110,
            "blob_url": "https://github.com/angular/angular/blob/9ebd461a22c41c138ac4912d734303740d4c1fdb/aio%2Fsrc%2Fapp%2Fshared%2Fcopier.service.ts",
            "raw_url": "https://github.com/angular/angular/raw/9ebd461a22c41c138ac4912d734303740d4c1fdb/aio%2Fsrc%2Fapp%2Fshared%2Fcopier.service.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fshared%2Fcopier.service.ts?ref=9ebd461a22c41c138ac4912d734303740d4c1fdb",
            "patch": "@@ -9,59 +9,83 @@\n \n \n export class CopierService {\n-    private fakeElem: HTMLTextAreaElement|null;\n+  /**\n+   * Copy the contents of a `<textarea>` element to the clipboard.\n+   *\n+   * NOTE: For this method to work, the elements must be already inserted into the DOM.\n+   *\n+   * @param textArea The area containing the text to be copied to the clipboard.\n+   * @return Whether the copy operation was successful.\n+   */\n+  private copyTextArea(textArea: HTMLTextAreaElement): boolean {\n+    try {\n+      textArea.select();\n+      textArea.setSelectionRange(0, textArea.value.length);\n \n-    /**\n-     * Creates a fake textarea element, sets its value from `text` property,\n-     * and makes a selection on it.\n-     */\n-    createFake(text: string) {\n-      const docElem = document.documentElement!;\n-      const isRTL = docElem.getAttribute('dir') === 'rtl';\n+      return document.execCommand('copy');\n+    } catch {\n+      return false;\n+    }\n+  }\n \n-      // Create a fake element to hold the contents to copy\n-      this.fakeElem = document.createElement('textarea');\n+  /**\n+   * Create a temporary, hidden `<textarea>` element and set its value to the specified text.\n+   *\n+   * @param text The text to be inserted into the textarea.\n+   * @return The temporary `<textarea>` element containing the specified text.\n+   */\n+  private createTextArea(text: string): HTMLTextAreaElement {\n+    const docElem = document.documentElement!;\n+    const isRTL = docElem.getAttribute('dir') === 'rtl';\n \n-      // Prevent zooming on iOS\n-      this.fakeElem.style.fontSize = '12pt';\n+    // Create a temporary element to hold the contents to copy.\n+    const textArea = document.createElement('textarea');\n+    const style = textArea.style;\n \n-      // Reset box model\n-      this.fakeElem.style.border = '0';\n-      this.fakeElem.style.padding = '0';\n-      this.fakeElem.style.margin = '0';\n+    // Prevent zooming on iOS.\n+    style.fontSize = '12pt';\n \n-      // Move element out of screen horizontally\n-      this.fakeElem.style.position = 'absolute';\n-      this.fakeElem.style[ isRTL ? 'right' : 'left' ] = '-9999px';\n+    // Reset box model.\n+    style.border = '0';\n+    style.padding = '0';\n+    style.margin = '0';\n \n-      // Move element to the same position vertically\n-      const yPosition = window.pageYOffset || docElem.scrollTop;\n-      this.fakeElem.style.top = yPosition + 'px';\n+    // Move element out of screen horizontally.\n+    style.position = 'absolute';\n+    style[ isRTL ? 'right' : 'left' ] = '-9999px';\n \n-      this.fakeElem.setAttribute('readonly', '');\n-      this.fakeElem.value = text;\n+    // Move element to the same position vertically.\n+    const yPosition = window.pageYOffset || docElem.scrollTop;\n+    style.top = yPosition + 'px';\n \n-      document.body.appendChild(this.fakeElem);\n+    textArea.setAttribute('readonly', '');\n+    textArea.value = text;\n \n-      this.fakeElem.select();\n-      this.fakeElem.setSelectionRange(0, this.fakeElem.value.length);\n-    }\n+    return textArea;\n+  }\n \n-    removeFake() {\n-      if (this.fakeElem) {\n-        document.body.removeChild(this.fakeElem);\n-        this.fakeElem = null;\n-      }\n-    }\n+  /**\n+   * Copy the specified text to the clipboard.\n+   *\n+   * @param text The text to be copied to the clipboard.\n+   * @return Whether the copy operation was successful.\n+   */\n+  copyText(text: string): boolean {\n+    // Create a `<textarea>` element with the specified text.\n+    const textArea = this.createTextArea(text);\n \n-    copyText(text: string) {\n-      try {\n-        this.createFake(text);\n-        return document.execCommand('copy');\n-      } catch (err) {\n-        return false;\n-      } finally {\n-        this.removeFake();\n-      }\n+    // Insert it into the DOM.\n+    document.body.appendChild(textArea);\n+\n+    // Copy its contents to the clipboard.\n+    const success = this.copyTextArea(textArea);\n+\n+    // Remove it from the DOM, so it can be garbage-collected.\n+    if (textArea.parentNode) {\n+      // We cannot use ChildNode.remove() because of IE11.\n+      textArea.parentNode.removeChild(textArea);\n     }\n+\n+    return success;\n+  }\n }"
        }
    ],
    "stats": {
        "total": 110,
        "additions": 67,
        "deletions": 43
    }
}