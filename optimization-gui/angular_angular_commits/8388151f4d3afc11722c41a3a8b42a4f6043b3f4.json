{
    "author": "AndrewKushnir",
    "message": "refactor(forms): make validators code compatible with property renaming (#44500)\n\nThis commit refactors the code of the base validators class to make it compatible with the property renaming optimization. Currently the code makes an assumption that the field with a specified name (defined as a string) can be found on an object, but with property renaming optimization this is not correct.\n\nPR Close #44500",
    "sha": "8388151f4d3afc11722c41a3a8b42a4f6043b3f4",
    "files": [
        {
            "sha": "2e4ee0a121fbb478673296b70d167b9e6867179e",
            "filename": "packages/forms/src/directives/validators.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 12,
            "changes": 33,
            "blob_url": "https://github.com/angular/angular/blob/8388151f4d3afc11722c41a3a8b42a4f6043b3f4/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "raw_url": "https://github.com/angular/angular/raw/8388151f4d3afc11722c41a3a8b42a4f6043b3f4/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fdirectives%2Fvalidators.ts?ref=8388151f4d3afc11722c41a3a8b42a4f6043b3f4",
            "patch": "@@ -98,6 +98,15 @@ abstract class AbstractValidatorDirective implements Validator, OnChanges {\n   private _validator: ValidatorFn = nullValidator;\n   private _onChange!: () => void;\n \n+  /**\n+   * A flag that tracks whether this validator is enabled.\n+   *\n+   * Marking it `internal` (vs `protected`), so that this flag can be used in host bindings of\n+   * directive classes that extend this base class.\n+   * @internal\n+   */\n+  _enabled?: boolean;\n+\n   /**\n    * Name of an input that matches directive selector attribute (e.g. `minlength` for\n    * `MinLengthDirective`). An input with a given name might contain configuration information (like\n@@ -129,7 +138,8 @@ abstract class AbstractValidatorDirective implements Validator, OnChanges {\n   ngOnChanges(changes: SimpleChanges): void {\n     if (this.inputName in changes) {\n       const input = this.normalizeInput(changes[this.inputName].currentValue);\n-      this._validator = this.enabled() ? this.createValidator(input) : nullValidator;\n+      this._enabled = this.enabled(input);\n+      this._validator = this._enabled ? this.createValidator(input) : nullValidator;\n       if (this._onChange) {\n         this._onChange();\n       }\n@@ -148,14 +158,13 @@ abstract class AbstractValidatorDirective implements Validator, OnChanges {\n \n   /**\n    * @description\n-   * Determines whether this validator is active or not. Base class implementation\n-   * checks whether an input is defined (if the value is different from `null` and `undefined`).\n-   * Validator classes that extend this base class can override this function with the logic\n-   * specific to a particular validator directive.\n+   * Determines whether this validator should be active or not based on an input.\n+   * Base class implementation checks whether an input is defined (if the value is different from\n+   * `null` and `undefined`). Validator classes that extend this base class can override this\n+   * function with the logic specific to a particular validator directive.\n    */\n-  enabled(): boolean {\n-    const inputValue = (this as unknown as {[key: string]: unknown})[this.inputName];\n-    return inputValue != null /* both `null` and `undefined` */;\n+  enabled(input: unknown): boolean {\n+    return input != null /* both `null` and `undefined` */;\n   }\n }\n \n@@ -194,7 +203,7 @@ export const MAX_VALIDATOR: StaticProvider = {\n   selector:\n       'input[type=number][max][formControlName],input[type=number][max][formControl],input[type=number][max][ngModel]',\n   providers: [MAX_VALIDATOR],\n-  host: {'[attr.max]': 'enabled() ? max : null'}\n+  host: {'[attr.max]': '_enabled ? max : null'}\n })\n export class MaxValidator extends AbstractValidatorDirective {\n   /**\n@@ -245,7 +254,7 @@ export const MIN_VALIDATOR: StaticProvider = {\n   selector:\n       'input[type=number][min][formControlName],input[type=number][min][formControl],input[type=number][min][ngModel]',\n   providers: [MIN_VALIDATOR],\n-  host: {'[attr.min]': 'enabled() ? min : null'}\n+  host: {'[attr.min]': '_enabled ? min : null'}\n })\n export class MinValidator extends AbstractValidatorDirective {\n   /**\n@@ -549,7 +558,7 @@ export const MIN_LENGTH_VALIDATOR: any = {\n @Directive({\n   selector: '[minlength][formControlName],[minlength][formControl],[minlength][ngModel]',\n   providers: [MIN_LENGTH_VALIDATOR],\n-  host: {'[attr.minlength]': 'enabled() ? minlength : null'}\n+  host: {'[attr.minlength]': '_enabled ? minlength : null'}\n })\n export class MinLengthValidator extends AbstractValidatorDirective {\n   /**\n@@ -602,7 +611,7 @@ export const MAX_LENGTH_VALIDATOR: any = {\n @Directive({\n   selector: '[maxlength][formControlName],[maxlength][formControl],[maxlength][ngModel]',\n   providers: [MAX_LENGTH_VALIDATOR],\n-  host: {'[attr.maxlength]': 'enabled() ? maxlength : null'}\n+  host: {'[attr.maxlength]': '_enabled ? maxlength : null'}\n })\n export class MaxLengthValidator extends AbstractValidatorDirective {\n   /**"
        }
    ],
    "stats": {
        "total": 33,
        "additions": 21,
        "deletions": 12
    }
}