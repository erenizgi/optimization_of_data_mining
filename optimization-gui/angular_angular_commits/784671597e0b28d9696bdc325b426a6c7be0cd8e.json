{
    "author": "jonrimmer",
    "message": "fix(router): Allow question marks in query param values (#31187)\n\nAccording to the URI spec, question mark characters are valid in query data,\nso these should accepted by the param parsing.\n\nSee https://tools.ietf.org/html/rfc3986#section-3.4\n\nFixes #31116\n\nBREAKING CHANGE: The default url serializer would previously drop\neverything after and including a question mark in query parameters. That\nis, for a navigation to `/path?q=hello?&other=123`, the query\nparams would be parsed to just `{q: 'hello'}`. This is\nincorrect because the URI spec allows for question mark characers in\nquery data. This change will now correctly parse the params for the\nabove example to be `{v: 'hello?', other: '123'}`.\n\nPR Close #31187",
    "sha": "784671597e0b28d9696bdc325b426a6c7be0cd8e",
    "files": [
        {
            "sha": "13841a278992be7e5f329cbea227e19b4f98b567",
            "filename": "packages/router/src/url_tree.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/784671597e0b28d9696bdc325b426a6c7be0cd8e/packages%2Frouter%2Fsrc%2Furl_tree.ts",
            "raw_url": "https://github.com/angular/angular/raw/784671597e0b28d9696bdc325b426a6c7be0cd8e/packages%2Frouter%2Fsrc%2Furl_tree.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Furl_tree.ts?ref=784671597e0b28d9696bdc325b426a6c7be0cd8e",
            "patch": "@@ -523,7 +523,7 @@ function matchQueryParams(str: string): string {\n   return match ? match[0] : '';\n }\n \n-const QUERY_PARAM_VALUE_RE = /^[^?&#]+/;\n+const QUERY_PARAM_VALUE_RE = /^[^&#]+/;\n // Return the value of the query param at the start of the string or an empty string\n function matchUrlQueryParamValue(str: string): string {\n   const match = str.match(QUERY_PARAM_VALUE_RE);"
        },
        {
            "sha": "4ccbffe99c86d674d25c66fbb803cc463fe03fd0",
            "filename": "packages/router/test/url_tree.spec.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/784671597e0b28d9696bdc325b426a6c7be0cd8e/packages%2Frouter%2Ftest%2Furl_tree.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/784671597e0b28d9696bdc325b426a6c7be0cd8e/packages%2Frouter%2Ftest%2Furl_tree.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Furl_tree.spec.ts?ref=784671597e0b28d9696bdc325b426a6c7be0cd8e",
            "patch": "@@ -26,6 +26,11 @@ describe('UrlTree', () => {\n         'k/(a;b)': 'c',\n       });\n     });\n+\n+    it('should allow question marks in query param values', () => {\n+      const tree = serializer.parse('/path/to?first=http://foo/bar?baz=true&second=123');\n+      expect(tree.queryParams).toEqual({'first': 'http://foo/bar?baz=true', 'second': '123'});\n+    });\n   });\n \n   describe('containsTree', () => {"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
    }
}