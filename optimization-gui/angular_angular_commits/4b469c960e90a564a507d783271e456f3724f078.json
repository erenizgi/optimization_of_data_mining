{
    "author": "josephperrott",
    "message": "fix(localize): update type castings for JSON.parse usage (#40710)\n\nUpdate usages of JSON.parse to be cast as specific types.\n\nPR Close #40710",
    "sha": "4b469c960e90a564a507d783271e456f3724f078",
    "files": [
        {
            "sha": "11457db983351b0d0535c7776e59220b8da8f9fb",
            "filename": "packages/localize/schematics/ng-add/index_spec.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 6,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/4b469c960e90a564a507d783271e456f3724f078/packages%2Flocalize%2Fschematics%2Fng-add%2Findex_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/4b469c960e90a564a507d783271e456f3724f078/packages%2Flocalize%2Fschematics%2Fng-add%2Findex_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flocalize%2Fschematics%2Fng-add%2Findex_spec.ts?ref=4b469c960e90a564a507d783271e456f3724f078",
            "patch": "@@ -177,18 +177,20 @@ export { renderModule, renderModuleFactory } from '@angular/platform-server';`;\n   it('should add package to `devDependencies` by default', async () => {\n     host = await schematicRunner.runSchematicAsync('ng-add', defaultOptions, host).toPromise();\n     const packageJsonText = host.readContent('/package.json');\n-    expect(JSON.parse(packageJsonText).devDependencies?.['@angular/localize'])\n-        .toBe('~0.0.0-PLACEHOLDER');\n-    expect(JSON.parse(packageJsonText).dependencies?.['@angular/localize']).toBeUndefined();\n+    const packageJsonObj = JSON.parse(packageJsonText) as\n+        {devDependencies: {[key: string]: string}, dependencies: {[key: string]: string}};\n+    expect(packageJsonObj.devDependencies?.['@angular/localize']).toBe('~0.0.0-PLACEHOLDER');\n+    expect(packageJsonObj.dependencies?.['@angular/localize']).toBeUndefined();\n   });\n \n   it('should add package to `dependencies` if `useAtRuntime` is `true`', async () => {\n     host = await schematicRunner\n                .runSchematicAsync('ng-add', {...defaultOptions, useAtRuntime: true}, host)\n                .toPromise();\n     const packageJsonText = host.readContent('/package.json');\n-    expect(JSON.parse(packageJsonText).dependencies?.['@angular/localize'])\n-        .toBe('~0.0.0-PLACEHOLDER');\n-    expect(JSON.parse(packageJsonText).devDependencies?.['@angular/localize']).toBeUndefined();\n+    const packageJsonObj = JSON.parse(packageJsonText) as\n+        {devDependencies: {[key: string]: string}, dependencies: {[key: string]: string}};\n+    expect(packageJsonObj.dependencies?.['@angular/localize']).toBe('~0.0.0-PLACEHOLDER');\n+    expect(packageJsonObj.devDependencies?.['@angular/localize']).toBeUndefined();\n   });\n });"
        },
        {
            "sha": "4ef8bb98e67d6d6829581d1d08ff8fe8c2b30026",
            "filename": "packages/localize/src/tools/src/extract/translation_files/format_options.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/4b469c960e90a564a507d783271e456f3724f078/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Fextract%2Ftranslation_files%2Fformat_options.ts",
            "raw_url": "https://github.com/angular/angular/raw/4b469c960e90a564a507d783271e456f3724f078/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Fextract%2Ftranslation_files%2Fformat_options.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Fextract%2Ftranslation_files%2Fformat_options.ts?ref=4b469c960e90a564a507d783271e456f3724f078",
            "patch": "@@ -40,5 +40,5 @@ export function validateOptions(name: string, validOptions: ValidOptions, option\n  * @param optionString The string to parse.\n  */\n export function parseFormatOptions(optionString: string = '{}'): FormatOptions {\n-  return JSON.parse(optionString);\n-}\n\\ No newline at end of file\n+  return JSON.parse(optionString) as FormatOptions;\n+}"
        },
        {
            "sha": "db4b52b4003197f4e60ea00fa6c31a0719637346",
            "filename": "packages/localize/src/tools/src/translate/translation_files/translation_parsers/arb_translation_parser.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/4b469c960e90a564a507d783271e456f3724f078/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Ftranslation_files%2Ftranslation_parsers%2Farb_translation_parser.ts",
            "raw_url": "https://github.com/angular/angular/raw/4b469c960e90a564a507d783271e456f3724f078/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Ftranslation_files%2Ftranslation_parsers%2Farb_translation_parser.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Ftranslation_files%2Ftranslation_parsers%2Farb_translation_parser.ts?ref=4b469c960e90a564a507d783271e456f3724f078",
            "patch": "@@ -93,7 +93,7 @@ export class ArbTranslationParser implements TranslationParser<ArbJsonObject> {\n   }\n \n   private tryParseArbFormat(contents: string): ArbJsonObject {\n-    const json = JSON.parse(contents);\n+    const json = JSON.parse(contents) as ArbJsonObject;\n     if (typeof json['@@locale'] !== 'string') {\n       throw new Error('Missing @@locale property.');\n     }"
        },
        {
            "sha": "f104a53bbf3509374a5fb99c5fb83a1b1138c344",
            "filename": "packages/localize/src/tools/src/translate/translation_files/translation_parsers/simple_json_translation_parser.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 6,
            "changes": 17,
            "blob_url": "https://github.com/angular/angular/blob/4b469c960e90a564a507d783271e456f3724f078/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Ftranslation_files%2Ftranslation_parsers%2Fsimple_json_translation_parser.ts",
            "raw_url": "https://github.com/angular/angular/raw/4b469c960e90a564a507d783271e456f3724f078/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Ftranslation_files%2Ftranslation_parsers%2Fsimple_json_translation_parser.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flocalize%2Fsrc%2Ftools%2Fsrc%2Ftranslate%2Ftranslation_files%2Ftranslation_parsers%2Fsimple_json_translation_parser.ts?ref=4b469c960e90a564a507d783271e456f3724f078",
            "patch": "@@ -11,6 +11,11 @@ import {Diagnostics} from '../../../diagnostics';\n \n import {ParseAnalysis, ParsedTranslationBundle, TranslationParser} from './translation_parser';\n \n+interface SimpleJsonFile {\n+  locale: string;\n+  translations: {[messageId: string]: string};\n+}\n+\n /**\n  * A translation parser that can parse JSON that has the form:\n  *\n@@ -27,16 +32,16 @@ import {ParseAnalysis, ParsedTranslationBundle, TranslationParser} from './trans\n  * @see SimpleJsonTranslationSerializer\n  * @publicApi used by CLI\n  */\n-export class SimpleJsonTranslationParser implements TranslationParser<Object> {\n+export class SimpleJsonTranslationParser implements TranslationParser<SimpleJsonFile> {\n   /**\n    * @deprecated\n    */\n-  canParse(filePath: string, contents: string): Object|false {\n+  canParse(filePath: string, contents: string): SimpleJsonFile|false {\n     const result = this.analyze(filePath, contents);\n     return result.canParse && result.hint;\n   }\n \n-  analyze(filePath: string, contents: string): ParseAnalysis<Object> {\n+  analyze(filePath: string, contents: string): ParseAnalysis<SimpleJsonFile> {\n     const diagnostics = new Diagnostics();\n     // For this to be parsable, the extension must be `.json` and the contents must include \"locale\"\n     // and \"translations\" keys.\n@@ -46,7 +51,7 @@ export class SimpleJsonTranslationParser implements TranslationParser<Object> {\n       return {canParse: false, diagnostics};\n     }\n     try {\n-      const json = JSON.parse(contents);\n+      const json = JSON.parse(contents) as SimpleJsonFile;\n       if (json.locale === undefined) {\n         diagnostics.warn('Required \"locale\" property missing.');\n         return {canParse: false, diagnostics};\n@@ -70,8 +75,8 @@ export class SimpleJsonTranslationParser implements TranslationParser<Object> {\n     }\n   }\n \n-  parse(_filePath: string, contents: string, json?: Object): ParsedTranslationBundle {\n-    const {locale: parsedLocale, translations} = json || JSON.parse(contents);\n+  parse(_filePath: string, contents: string, json?: SimpleJsonFile): ParsedTranslationBundle {\n+    const {locale: parsedLocale, translations} = json || JSON.parse(contents) as SimpleJsonFile;\n     const parsedTranslations: Record<ɵMessageId, ɵParsedTranslation> = {};\n     for (const messageId in translations) {\n       const targetMessage = translations[messageId];"
        }
    ],
    "stats": {
        "total": 37,
        "additions": 22,
        "deletions": 15
    }
}