{
    "author": "sonukapoor",
    "message": "perf(router): use `ngDevMode` to tree-shake error messages in router (#38674)\n\nThis commit adds `ngDevMode` guard to throw some errors only in dev mode\nThe ngDevMode flag helps to tree-shake these error messages from production\nbuilds (in dev mode everything will work as it works right now) to decrease\nproduction bundle size.\n\nPR Close #38674",
    "sha": "db21c4fb448c0017f62adfef350b29d651ff162a",
    "files": [
        {
            "sha": "a0232300df1c5979f481c4158b44f9da602bcbed",
            "filename": "goldens/size-tracking/integration-payloads.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/db21c4fb448c0017f62adfef350b29d651ff162a/goldens%2Fsize-tracking%2Fintegration-payloads.json",
            "raw_url": "https://github.com/angular/angular/raw/db21c4fb448c0017f62adfef350b29d651ff162a/goldens%2Fsize-tracking%2Fintegration-payloads.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fsize-tracking%2Fintegration-payloads.json?ref=db21c4fb448c0017f62adfef350b29d651ff162a",
            "patch": "@@ -39,7 +39,7 @@\n     \"master\": {\n       \"uncompressed\": {\n         \"runtime-es2015\": 2289,\n-        \"main-es2015\": 245303,\n+        \"main-es2015\": 242351,\n         \"polyfills-es2015\": 36938,\n         \"5-es2015\": 751\n       }\n@@ -49,7 +49,7 @@\n     \"master\": {\n       \"uncompressed\": {\n         \"runtime-es2015\": 2289,\n-        \"main-es2015\": 221887,\n+        \"main-es2015\": 218961,\n         \"polyfills-es2015\": 36723,\n         \"5-es2015\": 781\n       }"
        },
        {
            "sha": "96c35d87e0d5f67258a9737d3bd551447c2754b0",
            "filename": "packages/router/src/directives/router_link.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Fdirectives%2Frouter_link.ts",
            "raw_url": "https://github.com/angular/angular/raw/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Fdirectives%2Frouter_link.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Fdirectives%2Frouter_link.ts?ref=db21c4fb448c0017f62adfef350b29d651ff162a",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n import {LocationStrategy} from '@angular/common';\n-import {Attribute, Directive, ElementRef, HostBinding, HostListener, Input, isDevMode, OnChanges, OnDestroy, Renderer2, SimpleChanges} from '@angular/core';\n+import {Attribute, Directive, ElementRef, HostBinding, HostListener, Input, OnChanges, OnDestroy, Renderer2, SimpleChanges} from '@angular/core';\n import {Subject, Subscription} from 'rxjs';\n \n import {QueryParamsHandling} from '../config';\n@@ -206,7 +206,7 @@ export class RouterLink implements OnChanges {\n    */\n   @Input()\n   set preserveQueryParams(value: boolean) {\n-    if (isDevMode() && <any>console && <any>console.warn) {\n+    if ((typeof ngDevMode === 'undefined' || ngDevMode) && <any>console && <any>console.warn) {\n       console.warn('preserveQueryParams is deprecated!, use queryParamsHandling instead.');\n     }\n     this.preserve = value;\n@@ -342,7 +342,7 @@ export class RouterLinkWithHref implements OnChanges, OnDestroy {\n    */\n   @Input()\n   set preserveQueryParams(value: boolean) {\n-    if (isDevMode() && <any>console && <any>console.warn) {\n+    if ((typeof ngDevMode === 'undefined' || ngDevMode) && <any>console && <any>console.warn) {\n       console.warn('preserveQueryParams is deprecated, use queryParamsHandling instead.');\n     }\n     this.preserve = value;"
        },
        {
            "sha": "2de203ea4a41f6464b3a241535064f3fabb7f18a",
            "filename": "packages/router/src/operators/activate_routes.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Foperators%2Factivate_routes.ts",
            "raw_url": "https://github.com/angular/angular/raw/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Foperators%2Factivate_routes.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Foperators%2Factivate_routes.ts?ref=db21c4fb448c0017f62adfef350b29d651ff162a",
            "patch": "@@ -6,7 +6,6 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {isDevMode} from '@angular/core';\n import {MonoTypeOperatorFunction} from 'rxjs';\n import {map} from 'rxjs/operators';\n \n@@ -186,7 +185,7 @@ export class ActivateRoutes {\n             // Activate the outlet when it has already been instantiated\n             // Otherwise it will get activated from its `ngOnInit` when instantiated\n             context.outlet.activateWith(future, cmpFactoryResolver);\n-          } else if (isDevMode() && console && console.warn) {\n+          } else if ((typeof ngDevMode === 'undefined' || ngDevMode) && console && console.warn) {\n             console.warn(\n                 `A router outlet has not been instantiated during routes activation. URL Segment: '${\n                     future.snapshot._urlSegment}'`);"
        },
        {
            "sha": "b1f1f744cb7245c4f2a41bbbacab225d247bdd01",
            "filename": "packages/router/src/router.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Frouter.ts",
            "raw_url": "https://github.com/angular/angular/raw/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Frouter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Frouter.ts?ref=db21c4fb448c0017f62adfef350b29d651ff162a",
            "patch": "@@ -7,7 +7,7 @@\n  */\n \n import {Location, PopStateEvent} from '@angular/common';\n-import {Compiler, Injectable, Injector, isDevMode, NgModuleFactoryLoader, NgModuleRef, NgZone, Type, ɵConsole as Console} from '@angular/core';\n+import {Compiler, Injectable, Injector, NgModuleFactoryLoader, NgModuleRef, NgZone, Type, ɵConsole as Console} from '@angular/core';\n import {BehaviorSubject, EMPTY, Observable, of, Subject, SubscriptionLike} from 'rxjs';\n import {catchError, filter, finalize, map, switchMap, tap} from 'rxjs/operators';\n \n@@ -1077,7 +1077,8 @@ export class Router {\n       queryParamsHandling,\n       preserveFragment\n     } = navigationExtras;\n-    if (isDevMode() && preserveQueryParams && <any>console && <any>console.warn) {\n+    if ((typeof ngDevMode === 'undefined' || ngDevMode) && preserveQueryParams && <any>console &&\n+        <any>console.warn) {\n       console.warn('preserveQueryParams is deprecated, use queryParamsHandling instead.');\n     }\n     const a = relativeTo || this.routerState.root;\n@@ -1131,7 +1132,8 @@ export class Router {\n    */\n   navigateByUrl(url: string|UrlTree, extras: NavigationExtras = {skipLocationChange: false}):\n       Promise<boolean> {\n-    if (isDevMode() && this.isNgZoneEnabled && !NgZone.isInAngularZone()) {\n+    if (typeof ngDevMode === 'undefined' ||\n+        ngDevMode && this.isNgZoneEnabled && !NgZone.isInAngularZone()) {\n       this.console.warn(\n           `Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?`);\n     }"
        },
        {
            "sha": "a9eda6529fa7a76118bd42ac7963d335ed2e32cf",
            "filename": "packages/router/src/router_module.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Frouter_module.ts",
            "raw_url": "https://github.com/angular/angular/raw/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Frouter_module.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Frouter_module.ts?ref=db21c4fb448c0017f62adfef350b29d651ff162a",
            "patch": "@@ -188,7 +188,7 @@ export function provideLocationStrategy(\n }\n \n export function provideForRootGuard(router: Router): any {\n-  if (router) {\n+  if ((typeof ngDevMode === 'undefined' || ngDevMode) && router) {\n     throw new Error(\n         `RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.`);\n   }"
        },
        {
            "sha": "f8f53c6cc6583d792adaf6fd8ed3b2c972de1d41",
            "filename": "packages/router/src/utils/config.ts",
            "status": "modified",
            "additions": 54,
            "deletions": 51,
            "changes": 105,
            "blob_url": "https://github.com/angular/angular/blob/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Futils%2Fconfig.ts",
            "raw_url": "https://github.com/angular/angular/raw/db21c4fb448c0017f62adfef350b29d651ff162a/packages%2Frouter%2Fsrc%2Futils%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Futils%2Fconfig.ts?ref=db21c4fb448c0017f62adfef350b29d651ff162a",
            "patch": "@@ -20,8 +20,9 @@ export function validateConfig(config: Routes, parentPath: string = ''): void {\n }\n \n function validateNode(route: Route, fullPath: string): void {\n-  if (!route) {\n-    throw new Error(`\n+  if (typeof ngDevMode === 'undefined' || ngDevMode) {\n+    if (!route) {\n+      throw new Error(`\n       Invalid configuration of route '${fullPath}': Encountered undefined route.\n       The reason might be an extra comma.\n \n@@ -32,55 +33,57 @@ function validateNode(route: Route, fullPath: string): void {\n         { path: 'detail/:id', component: HeroDetailComponent }\n       ];\n     `);\n-  }\n-  if (Array.isArray(route)) {\n-    throw new Error(`Invalid configuration of route '${fullPath}': Array cannot be specified`);\n-  }\n-  if (!route.component && !route.children && !route.loadChildren &&\n-      (route.outlet && route.outlet !== PRIMARY_OUTLET)) {\n-    throw new Error(`Invalid configuration of route '${\n-        fullPath}': a componentless route without children or loadChildren cannot have a named outlet set`);\n-  }\n-  if (route.redirectTo && route.children) {\n-    throw new Error(`Invalid configuration of route '${\n-        fullPath}': redirectTo and children cannot be used together`);\n-  }\n-  if (route.redirectTo && route.loadChildren) {\n-    throw new Error(`Invalid configuration of route '${\n-        fullPath}': redirectTo and loadChildren cannot be used together`);\n-  }\n-  if (route.children && route.loadChildren) {\n-    throw new Error(`Invalid configuration of route '${\n-        fullPath}': children and loadChildren cannot be used together`);\n-  }\n-  if (route.redirectTo && route.component) {\n-    throw new Error(`Invalid configuration of route '${\n-        fullPath}': redirectTo and component cannot be used together`);\n-  }\n-  if (route.path && route.matcher) {\n-    throw new Error(\n-        `Invalid configuration of route '${fullPath}': path and matcher cannot be used together`);\n-  }\n-  if (route.redirectTo === void 0 && !route.component && !route.children && !route.loadChildren) {\n-    throw new Error(`Invalid configuration of route '${\n-        fullPath}'. One of the following must be provided: component, redirectTo, children or loadChildren`);\n-  }\n-  if (route.path === void 0 && route.matcher === void 0) {\n-    throw new Error(`Invalid configuration of route '${\n-        fullPath}': routes must have either a path or a matcher specified`);\n-  }\n-  if (typeof route.path === 'string' && route.path.charAt(0) === '/') {\n-    throw new Error(`Invalid configuration of route '${fullPath}': path cannot start with a slash`);\n-  }\n-  if (route.path === '' && route.redirectTo !== void 0 && route.pathMatch === void 0) {\n-    const exp =\n-        `The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`;\n-    throw new Error(`Invalid configuration of route '{path: \"${fullPath}\", redirectTo: \"${\n-        route.redirectTo}\"}': please provide 'pathMatch'. ${exp}`);\n-  }\n-  if (route.pathMatch !== void 0 && route.pathMatch !== 'full' && route.pathMatch !== 'prefix') {\n-    throw new Error(`Invalid configuration of route '${\n-        fullPath}': pathMatch can only be set to 'prefix' or 'full'`);\n+    }\n+    if (Array.isArray(route)) {\n+      throw new Error(`Invalid configuration of route '${fullPath}': Array cannot be specified`);\n+    }\n+    if (!route.component && !route.children && !route.loadChildren &&\n+        (route.outlet && route.outlet !== PRIMARY_OUTLET)) {\n+      throw new Error(`Invalid configuration of route '${\n+          fullPath}': a componentless route without children or loadChildren cannot have a named outlet set`);\n+    }\n+    if (route.redirectTo && route.children) {\n+      throw new Error(`Invalid configuration of route '${\n+          fullPath}': redirectTo and children cannot be used together`);\n+    }\n+    if (route.redirectTo && route.loadChildren) {\n+      throw new Error(`Invalid configuration of route '${\n+          fullPath}': redirectTo and loadChildren cannot be used together`);\n+    }\n+    if (route.children && route.loadChildren) {\n+      throw new Error(`Invalid configuration of route '${\n+          fullPath}': children and loadChildren cannot be used together`);\n+    }\n+    if (route.redirectTo && route.component) {\n+      throw new Error(`Invalid configuration of route '${\n+          fullPath}': redirectTo and component cannot be used together`);\n+    }\n+    if (route.path && route.matcher) {\n+      throw new Error(\n+          `Invalid configuration of route '${fullPath}': path and matcher cannot be used together`);\n+    }\n+    if (route.redirectTo === void 0 && !route.component && !route.children && !route.loadChildren) {\n+      throw new Error(`Invalid configuration of route '${\n+          fullPath}'. One of the following must be provided: component, redirectTo, children or loadChildren`);\n+    }\n+    if (route.path === void 0 && route.matcher === void 0) {\n+      throw new Error(`Invalid configuration of route '${\n+          fullPath}': routes must have either a path or a matcher specified`);\n+    }\n+    if (typeof route.path === 'string' && route.path.charAt(0) === '/') {\n+      throw new Error(\n+          `Invalid configuration of route '${fullPath}': path cannot start with a slash`);\n+    }\n+    if (route.path === '' && route.redirectTo !== void 0 && route.pathMatch === void 0) {\n+      const exp =\n+          `The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`;\n+      throw new Error(`Invalid configuration of route '{path: \"${fullPath}\", redirectTo: \"${\n+          route.redirectTo}\"}': please provide 'pathMatch'. ${exp}`);\n+    }\n+    if (route.pathMatch !== void 0 && route.pathMatch !== 'full' && route.pathMatch !== 'prefix') {\n+      throw new Error(`Invalid configuration of route '${\n+          fullPath}': pathMatch can only be set to 'prefix' or 'full'`);\n+    }\n   }\n   if (route.children) {\n     validateConfig(route.children, fullPath);"
        }
    ],
    "stats": {
        "total": 128,
        "additions": 66,
        "deletions": 62
    }
}