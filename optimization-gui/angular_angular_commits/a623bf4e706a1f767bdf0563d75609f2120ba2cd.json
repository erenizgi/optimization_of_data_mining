{
    "author": "gkalpak",
    "message": "build(docs-infra): enable linting for `ng-packages-installer` scripts (#41429)\n\nThis commit enables linting for the scripts in\n`aio/tools/ng-packages-installer/`. It also makes the necessary changes\nto the files to make linting pass.\n\nPR Close #41429",
    "sha": "a623bf4e706a1f767bdf0563d75609f2120ba2cd",
    "files": [
        {
            "sha": "70de62be67dd883e850f292ec5ea14bb2bde2187",
            "filename": "aio/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/a623bf4e706a1f767bdf0563d75609f2120ba2cd/aio%2Fpackage.json",
            "raw_url": "https://github.com/angular/angular/raw/a623bf4e706a1f767bdf0563d75609f2120ba2cd/aio%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fpackage.json?ref=a623bf4e706a1f767bdf0563d75609f2120ba2cd",
            "patch": "@@ -61,7 +61,7 @@\n     \"docs-test\": \"node tools/transforms/test.js\",\n     \"redirects-test\": \"node tests/deployment/unit/test\",\n     \"firebase-utils-test\": \"node tools/firebase-test-utils/test\",\n-    \"tools-lint\": \"tslint --config \\\"tools/tslint.json\\\" --project \\\"tools/firebase-test-utils\\\"\",\n+    \"tools-lint\": \"tslint --config \\\"tools/tslint.json\\\" --project \\\"tools/firebase-test-utils\\\" && eslint tools/ng-packages-installer\",\n     \"tools-test\": \"yarn docs-test && yarn boilerplate:test && jasmine tools/ng-packages-installer/index.spec.js && jasmine scripts/deploy-to-firebase.spec.js && yarn firebase-utils-test\",\n     \"preserve-and-sync\": \"yarn docs\",\n     \"serve-and-sync\": \"run-p \\\"docs-watch --watch-only\\\" \\\"start {@}\\\" --\","
        },
        {
            "sha": "e7de9e6e5a7ba65000d9a85b81a8d49d93d74814",
            "filename": "aio/tools/ng-packages-installer/.eslintrc.js",
            "status": "added",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/angular/angular/blob/a623bf4e706a1f767bdf0563d75609f2120ba2cd/aio%2Ftools%2Fng-packages-installer%2F.eslintrc.js",
            "raw_url": "https://github.com/angular/angular/raw/a623bf4e706a1f767bdf0563d75609f2120ba2cd/aio%2Ftools%2Fng-packages-installer%2F.eslintrc.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Ftools%2Fng-packages-installer%2F.eslintrc.js?ref=a623bf4e706a1f767bdf0563d75609f2120ba2cd",
            "patch": "@@ -0,0 +1,22 @@\n+module.exports = {\n+  extends: [\n+    'eslint:recommended',\n+    'plugin:jasmine/recommended',\n+  ],\n+  env: {\n+    es2020: true,\n+    jasmine: true,\n+    node: true,\n+  },\n+  plugins: [\n+    'jasmine',\n+  ],\n+  rules: {\n+    'indent': ['error', 2],\n+    'linebreak-style': ['error', 'unix'],\n+    'max-len': ['error', 120],\n+    'quotes': ['error', 'single'],\n+    'semi': ['error', 'always'],\n+    'jasmine/new-line-before-expect': ['off'],\n+  },\n+};"
        },
        {
            "sha": "63814a4dcb0b10a9d7e51d6965ccbf9dae508071",
            "filename": "aio/tools/ng-packages-installer/index.js",
            "status": "modified",
            "additions": 15,
            "deletions": 9,
            "changes": 24,
            "blob_url": "https://github.com/angular/angular/blob/a623bf4e706a1f767bdf0563d75609f2120ba2cd/aio%2Ftools%2Fng-packages-installer%2Findex.js",
            "raw_url": "https://github.com/angular/angular/raw/a623bf4e706a1f767bdf0563d75609f2120ba2cd/aio%2Ftools%2Fng-packages-installer%2Findex.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Ftools%2Fng-packages-installer%2Findex.js?ref=a623bf4e706a1f767bdf0563d75609f2120ba2cd",
            "patch": "@@ -162,7 +162,9 @@ class NgPackagesInstaller {\n         this._log(`Overriding dependency with peerDependency: ${key}: ${peerDepRange}`);\n         dependencies[key] = peerDepRange;\n       } else {\n-        this._log(`${devDependencies[key] ? 'Overriding' : 'Assigning'} devDependency with peerDependency: ${key}: ${peerDepRange}`);\n+        this._log(\n+          `${devDependencies[key] ? 'Overriding' : 'Assigning'} devDependency with peerDependency: ` +\n+          `${key}: ${peerDepRange}`);\n         devDependencies[key] = peerDepRange;\n       }\n     });\n@@ -183,10 +185,11 @@ class NgPackagesInstaller {\n       shelljs.exec(DIST_PACKAGES_BUILD_CMD);\n     } else {\n       this._warn([\n-        'Automatically building the local Angular/Zone.js packages is currently not supported on Windows.',\n-        `Please, ensure '${ANGULAR_DIST_PACKAGES_DIR}', ${ZONEJS_DIST_PACKAGES_DIR} and '${ANGULAR_MISC_DIST_PACKAGES}' exist and are up-to-date ` +\n-          `(e.g. by running '${DIST_PACKAGES_BUILD_SCRIPT}' in Git Bash for Windows, Windows Subsystem for Linux or ` +\n-          'a Linux docker container or VM).',\n+        'Automatically building the local Angular/angular-in-memory-web-api/zone.js packages is currently not ' +\n+          'supported on Windows.',\n+        `Please, ensure '${ANGULAR_DIST_PACKAGES_DIR}', '${ZONEJS_DIST_PACKAGES_DIR}' and ` +\n+          `'${ANGULAR_MISC_DIST_PACKAGES}' exist and are up-to-date (e.g. by running '${DIST_PACKAGES_BUILD_SCRIPT}' ` +\n+          'in Git Bash for Windows, Windows Subsystem for Linux or a Linux docker container or VM).',\n         '',\n         'Proceeding anyway...',\n       ].join('\\n'));\n@@ -265,7 +268,7 @@ class NgPackagesInstaller {\n       ...collectPackages(ANGULAR_MISC_DIST_PACKAGES),\n     };\n \n-    this._log('Found the following Angular distributables:', Object.keys(packageConfigs).map(key => `\\n - ${key}`));\n+    this._log('Found the following Angular distributables:', ...Object.keys(packageConfigs).map(key => `\\n - ${key}`));\n     return packageConfigs;\n   }\n \n@@ -277,7 +280,7 @@ class NgPackagesInstaller {\n \n   /**\n    * Log a message if the `debug` property is set to true.\n-   * @param {...string[]} messages - The messages to be logged.\n+   * @param {string[]} messages - The messages to be logged.\n    */\n   _log(...messages) {\n     if (this.debug) {\n@@ -339,7 +342,8 @@ class NgPackagesInstaller {\n     const parsed = lockfile.parse(lockfileContent);\n \n     if (parsed.type !== 'success') {\n-      throw new Error(`[${NgPackagesInstaller.name}]: Error parsing lockfile '${lockfilePath}' (result type: ${parsed.type}).`);\n+      throw new Error(\n+        `[${NgPackagesInstaller.name}]: Error parsing lockfile '${lockfilePath}' (result type: ${parsed.type}).`);\n     }\n \n     return parsed.object;\n@@ -362,7 +366,7 @@ class NgPackagesInstaller {\n \n   /**\n    * Log a warning message do draw user's attention.\n-   * @param {...string[]} messages - The messages to be logged.\n+   * @param {string[]} messages - The messages to be logged.\n    */\n   _warn(...messages) {\n     const lines = messages.join(' ').split('\\n');\n@@ -400,6 +404,7 @@ function main() {\n     return new NgPackagesInstaller(projectDir, options);\n   };\n \n+  /* eslint-disable max-len */\n   yargs\n     .usage('$0 <cmd> [args]')\n \n@@ -421,6 +426,7 @@ function main() {\n     .strict()\n     .wrap(yargs.terminalWidth())\n     .argv;\n+  /* eslint-enable max-len */\n }\n \n module.exports = NgPackagesInstaller;"
        },
        {
            "sha": "549d595e191352bbf6b1da5ea7fe12275b76eafa",
            "filename": "aio/tools/ng-packages-installer/index.spec.js",
            "status": "modified",
            "additions": 13,
            "deletions": 10,
            "changes": 23,
            "blob_url": "https://github.com/angular/angular/blob/a623bf4e706a1f767bdf0563d75609f2120ba2cd/aio%2Ftools%2Fng-packages-installer%2Findex.spec.js",
            "raw_url": "https://github.com/angular/angular/raw/a623bf4e706a1f767bdf0563d75609f2120ba2cd/aio%2Ftools%2Fng-packages-installer%2Findex.spec.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Ftools%2Fng-packages-installer%2Findex.spec.js?ref=a623bf4e706a1f767bdf0563d75609f2120ba2cd",
            "patch": "@@ -46,7 +46,7 @@ describe('NgPackagesInstaller', () => {\n       fs.existsSync.and.returnValue(true);\n       installer.checkDependencies();\n       expect(fs.existsSync).toHaveBeenCalledWith(path.resolve(projectDir, 'node_modules/_local_.json'));\n-      expect(installer._printWarning).toHaveBeenCalled();\n+      expect(installer._printWarning).toHaveBeenCalledWith();\n     });\n   });\n \n@@ -163,15 +163,15 @@ describe('NgPackagesInstaller', () => {\n \n       it('should not continue processing', () => {\n         installer.installLocalDependencies();\n-        expect(installer._checkLocalMarker).toHaveBeenCalled();\n+        expect(installer._checkLocalMarker).toHaveBeenCalledWith();\n         expect(installer._getDistPackages).not.toHaveBeenCalled();\n       });\n \n       it('should continue processing (without checking for local marker) if `force` is true', () => {\n         installer.force = true;\n         installer.installLocalDependencies();\n         expect(installer._checkLocalMarker).not.toHaveBeenCalled();\n-        expect(installer._getDistPackages).toHaveBeenCalled();\n+        expect(installer._getDistPackages).toHaveBeenCalledWith();\n       });\n     });\n \n@@ -180,16 +180,17 @@ describe('NgPackagesInstaller', () => {\n \n       beforeEach(() => {\n         log = [];\n-        fs.writeFileSync.and.callFake((filePath, contents) => filePath === packageJsonPath && log.push(`writeFile: ${contents}`));\n+        fs.writeFileSync.and.callFake((filePath, contents) =>\n+          filePath === packageJsonPath && log.push(`writeFile: ${contents}`));\n         installer._installDeps.and.callFake((...args) => log.push(`installDeps: ${args.join(' ')}`));\n         installer._checkLocalMarker.and.returnValue(false);\n         installer.installLocalDependencies();\n       });\n \n       it('should parse the lockfile and get the dist packages', () => {\n-        expect(installer._checkLocalMarker).toHaveBeenCalled();\n+        expect(installer._checkLocalMarker).toHaveBeenCalledWith();\n         expect(installer._parseLockfile).toHaveBeenCalledWith(yarnLockPath);\n-        expect(installer._getDistPackages).toHaveBeenCalled();\n+        expect(installer._getDistPackages).toHaveBeenCalledWith();\n       });\n \n       it('should temporarily overwrite the package.json files of local Angular packages', () => {\n@@ -260,7 +261,7 @@ describe('NgPackagesInstaller', () => {\n       it('should overwrite package.json, then install deps, then restore original package.json', () => {\n         expect(log).toEqual([\n           `writeFile: ${expectedModifiedPackageJson}`,\n-          `installDeps: --pure-lockfile --check-files`,\n+          'installDeps: --pure-lockfile --check-files',\n           `writeFile: ${dummyPackageJson}`\n         ]);\n       });\n@@ -316,7 +317,8 @@ describe('NgPackagesInstaller', () => {\n \n       expect(shelljs.exec).not.toHaveBeenCalled();\n       expect(warning).toContain(\n-          'Automatically building the local Angular/Zone.js packages is currently not supported on Windows.');\n+        'Automatically building the local Angular/angular-in-memory-web-api/zone.js packages is currently not ' +\n+        'supported on Windows.');\n       expect(warning).toContain('Git Bash for Windows');\n       expect(warning).toContain('Windows Subsystem for Linux');\n       expect(warning).toContain('Linux docker container or VM');\n@@ -340,7 +342,8 @@ describe('NgPackagesInstaller', () => {\n       expect(installer._buildDistPackages).toHaveBeenCalledTimes(1);\n     });\n \n-    it('should not build the local packages by default', () => {\n+    it('should not build the local packages, if `buildPackages` is false', () => {\n+      installer = new NgPackagesInstaller(projectDir, {buildPackages: false});\n       installer._getDistPackages();\n       expect(installer._buildDistPackages).not.toHaveBeenCalled();\n     });\n@@ -506,7 +509,7 @@ describe('NgPackagesInstaller', () => {\n     it('should throw if parsing the lockfile fails', () => {\n       lockfile.parse.and.returnValue({type: 'not success'});\n       expect(() => installer._parseLockfile('/foo/bar/yarn.lock')).toThrowError(\n-          '[NgPackagesInstaller]: Error parsing lockfile \\'/foo/bar/yarn.lock\\' (result type: not success).');\n+        '[NgPackagesInstaller]: Error parsing lockfile \\'/foo/bar/yarn.lock\\' (result type: not success).');\n     });\n \n     it('should return the parsed lockfile content as an object', () => {"
        }
    ],
    "stats": {
        "total": 71,
        "additions": 51,
        "deletions": 20
    }
}