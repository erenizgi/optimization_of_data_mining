{
    "author": "AndrewKushnir",
    "message": "Revert \"test(zone.js): should invoke XHR task even onload handler throw error. (#41562)\" (#41707)\n\nThis reverts commit 6910118b0d82255be60a8580957383d227bcd58e.\n\nReason: this change introduces race conditions on CI.\n\nPR Close #41707",
    "sha": "baa8c70416a2775ed621afd83fa5a7e1d9a91236",
    "files": [
        {
            "sha": "da23b072ffad91810e03737a682332afc5d5116d",
            "filename": "packages/zone.js/test/browser/XMLHttpRequest.spec.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 71,
            "changes": 71,
            "blob_url": "https://github.com/angular/angular/blob/baa8c70416a2775ed621afd83fa5a7e1d9a91236/packages%2Fzone.js%2Ftest%2Fbrowser%2FXMLHttpRequest.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/baa8c70416a2775ed621afd83fa5a7e1d9a91236/packages%2Fzone.js%2Ftest%2Fbrowser%2FXMLHttpRequest.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fzone.js%2Ftest%2Fbrowser%2FXMLHttpRequest.spec.ts?ref=baa8c70416a2775ed621afd83fa5a7e1d9a91236",
            "patch": "@@ -103,77 +103,6 @@ describe('XMLHttpRequest', function() {\n     req!.send();\n   });\n \n-  it('should run onload listeners before internal readystatechange', function(done) {\n-    const logs: string[] = [];\n-    const xhrZone = Zone.current.fork({\n-      name: 'xhr',\n-      onInvokeTask: (delegate, curr, target, task, applyThis, applyArgs) => {\n-        logs.push('invokeTask ' + task.source);\n-        return delegate.invokeTask(target, task, applyThis, applyArgs);\n-      }\n-    });\n-\n-    xhrZone.run(function() {\n-      const req = new XMLHttpRequest();\n-      req.onload = function() {\n-        logs.push('onload');\n-        (window as any)[Zone.__symbol__('setTimeout')](() => {\n-          expect(logs).toEqual([\n-            'invokeTask XMLHttpRequest.addEventListener:load', 'onload',\n-            'invokeTask XMLHttpRequest.send'\n-          ])\n-          done();\n-        });\n-      };\n-      req.open('get', '/', true);\n-      req.send();\n-    });\n-  });\n-\n-  it('should invoke xhr task even onload listener throw error', function(done) {\n-    const logs: string[] = [];\n-    const xhrZone = Zone.current.fork({\n-      name: 'xhr',\n-      onInvokeTask: (delegate, curr, target, task, applyThis, applyArgs) => {\n-        logs.push('invokeTask ' + task.source);\n-        return delegate.invokeTask(target, task, applyThis, applyArgs);\n-      },\n-      onHasTask: (delegate, curr, target, hasTaskState) => {\n-        if (hasTaskState.change === 'macroTask') {\n-          logs.push('hasTask ' + hasTaskState.macroTask);\n-        }\n-        return delegate.hasTask(target, hasTaskState);\n-      }\n-    });\n-\n-    xhrZone.run(function() {\n-      const req = new XMLHttpRequest();\n-      req.onload = function() {\n-        logs.push('onload');\n-        throw new Error('test');\n-      };\n-      const unhandledRejection = (e: PromiseRejectionEvent) => {\n-        logs.push(e.reason.message);\n-      };\n-      window.addEventListener('unhandledrejection', unhandledRejection);\n-      req.addEventListener('load', () => {\n-        logs.push('onload1');\n-        (window as any)[Zone.__symbol__('setTimeout')](() => {\n-          expect(logs).toEqual([\n-            'hasTask true', 'invokeTask XMLHttpRequest.addEventListener:load', 'onload',\n-            'invokeTask XMLHttpRequest.addEventListener:load', 'onload1',\n-            'invokeTask XMLHttpRequest.send', 'hasTask false',\n-            'invokeTask Window.addEventListener:unhandledrejection', 'test'\n-          ]);\n-          window.removeEventListener('unhandledrejection', unhandledRejection);\n-          done();\n-        });\n-      });\n-      req.open('get', '/', true);\n-      req.send();\n-    });\n-  });\n-\n   it('should return null when access ontimeout first time without error', function() {\n     let req: XMLHttpRequest = new XMLHttpRequest();\n     expect(req.ontimeout).toBe(null);"
        }
    ],
    "stats": {
        "total": 71,
        "additions": 0,
        "deletions": 71
    }
}