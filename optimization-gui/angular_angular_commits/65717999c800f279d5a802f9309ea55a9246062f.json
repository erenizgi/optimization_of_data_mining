{
    "author": "dylhunn",
    "message": "refactor(forms): Make the minimum changes to the forms unit tests in order to support the typed forms PR (#43834). (#44451)\n\nCurrently, many of our unit tests are written to use heterogenous groups and arrays, and controls that accept heterogenous values. This PR will make the minimum possible alterations to prepare those usages, mainly by annotating them as untyped controls, etc.\n\nThis PR is *not* intended to test typed forms, merely to minimize the size of the upcoming PR. This will allow that PR to be focused on the actual features and tests, rather than boilerplate fixes.\n\nPR Close #44451",
    "sha": "65717999c800f279d5a802f9309ea55a9246062f",
    "files": [
        {
            "sha": "2cf98ab756e113a6ae3901d1fa7b4fdfa89d288b",
            "filename": "packages/forms/test/form_array_spec.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 6,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fform_array_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fform_array_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Fform_array_spec.ts?ref=65717999c800f279d5a802f9309ea55a9246062f",
            "patch": "@@ -10,6 +10,7 @@ import {fakeAsync, tick} from '@angular/core/testing';\n import {AbstractControl, FormArray, FormControl, FormGroup, ValidationErrors, ValidatorFn} from '@angular/forms';\n import {Validators} from '@angular/forms/src/validators';\n import {of} from 'rxjs';\n+\n import {asyncValidator} from './util';\n \n (function() {\n@@ -137,7 +138,7 @@ describe('FormArray', () => {\n          // becomes invalid.\n          const validatorFn = (value: any) => value.controls.length > 0 ? {controls: true} : null;\n          const asyncValidatorFn = (value: any) => of(validatorFn(value));\n-         const arr = new FormArray([], validatorFn, asyncValidatorFn);\n+         const arr: FormArray = new FormArray([], validatorFn, asyncValidatorFn);\n          expect(arr.valid).toBe(true);\n \n          arr.statusChanges.subscribe(() => logger.push('status change'));\n@@ -178,7 +179,8 @@ describe('FormArray', () => {\n \n     it('should work with nested form groups/arrays', () => {\n       a = new FormArray([\n-        new FormGroup({'c2': new FormControl('v2'), 'c3': new FormControl('v3')}),\n+        new FormGroup(\n+            {'c2': new FormControl('v2') as AbstractControl, 'c3': new FormControl('v3')}),\n         new FormArray([new FormControl('v4'), new FormControl('v5')])\n       ]);\n       a.at(0).get('c3')!.disable();\n@@ -191,7 +193,8 @@ describe('FormArray', () => {\n   describe('markAllAsTouched', () => {\n     it('should mark all descendants as touched', () => {\n       const formArray: FormArray = new FormArray([\n-        new FormControl('v1'), new FormControl('v2'), new FormGroup({'c1': new FormControl('v1')}),\n+        new FormControl('v1') as AbstractControl, new FormControl('v2'),\n+        new FormGroup({'c1': new FormControl('v1')}),\n         new FormArray([new FormGroup({'c2': new FormControl('v2')})])\n       ]);\n \n@@ -306,7 +309,7 @@ describe('FormArray', () => {\n     });\n \n     it('should throw if no controls are set yet', () => {\n-      const empty = new FormArray([]);\n+      const empty: FormArray = new FormArray([]);\n       expect(() => empty.setValue(['one']))\n           .toThrowError(new RegExp(`no form controls registered with this array`));\n     });\n@@ -730,7 +733,7 @@ describe('FormArray', () => {\n       const simpleValidator = (c: FormArray) =>\n           c.controls[0].value != 'correct' ? {'broken': true} : null;\n \n-      const c = new FormControl(null);\n+      const c = new FormControl('');\n       const g = new FormArray([c], simpleValidator as ValidatorFn);\n \n       c.setValue('correct');\n@@ -1174,7 +1177,7 @@ describe('FormArray', () => {\n     });\n \n     it('should keep empty, disabled arrays disabled when updating validity', () => {\n-      const arr = new FormArray([]);\n+      const arr: FormArray = new FormArray([]);\n       expect(arr.status).toEqual('VALID');\n \n       arr.disable();"
        },
        {
            "sha": "5aedcc47821403aa377bbc403886d46bac6a4aac",
            "filename": "packages/forms/test/form_builder_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fform_builder_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fform_builder_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Fform_builder_spec.ts?ref=65717999c800f279d5a802f9309ea55a9246062f",
            "patch": "@@ -107,7 +107,8 @@ describe('Form Builder', () => {\n     const e = b.control(null);\n     const f = b.control(undefined);\n     const a = b.array(\n-        ['one', ['two', syncValidator], c, b.array(['four']), e, f], syncValidator, asyncValidator);\n+        ['one' as any, ['two', syncValidator], c, b.array(['four']), e, f], syncValidator,\n+        asyncValidator);\n \n     expect(a.value).toEqual(['one', 'two', 'three', ['four'], null, null]);\n     expect(a.validator).toBe(syncValidator);"
        },
        {
            "sha": "3d1faf3bd4e6b556e96568e7c659f73697ddf931",
            "filename": "packages/forms/test/form_control_spec.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 5,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fform_control_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fform_control_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Fform_control_spec.ts?ref=65717999c800f279d5a802f9309ea55a9246062f",
            "patch": "@@ -8,8 +8,8 @@\n \n import {fakeAsync, tick} from '@angular/core/testing';\n import {FormControl, FormGroup, Validators} from '@angular/forms';\n-\n import {FormArray} from '@angular/forms/src/model';\n+\n import {asyncValidator, asyncValidatorReturningObservable} from './util';\n \n (function() {\n@@ -59,7 +59,8 @@ describe('FormControl', () => {\n     });\n \n     it('should not treat objects as boxed values if they have more than two props', () => {\n-      const c = new FormControl({value: '', disabled: true, test: 'test'}, null!, null!);\n+      const c: FormControl =\n+          new FormControl({value: '', disabled: true, test: 'test'} as any, null!, null!);\n       expect(c.value).toEqual({value: '', disabled: true, test: 'test'});\n       expect(c.disabled).toBe(false);\n     });\n@@ -175,7 +176,7 @@ describe('FormControl', () => {\n     });\n \n     it('should support single validator from options obj', () => {\n-      const c = new FormControl(null, {validators: Validators.required});\n+      const c: FormControl = new FormControl(null, {validators: Validators.required});\n       expect(c.valid).toEqual(false);\n       expect(c.errors).toEqual({required: true});\n \n@@ -184,7 +185,8 @@ describe('FormControl', () => {\n     });\n \n     it('should support multiple validators from options obj', () => {\n-      const c = new FormControl(null, {validators: [Validators.required, Validators.minLength(3)]});\n+      const c: FormControl =\n+          new FormControl(null, {validators: [Validators.required, Validators.minLength(3)]});\n       expect(c.valid).toEqual(false);\n       expect(c.errors).toEqual({required: true});\n \n@@ -212,7 +214,7 @@ describe('FormControl', () => {\n     });\n \n     it('should set single validator', () => {\n-      const c = new FormControl(null);\n+      const c: FormControl = new FormControl(null);\n       expect(c.valid).toEqual(true);\n \n       c.setValidators(Validators.required);"
        },
        {
            "sha": "0471a38bda688147e93207b7f443035916e4c8cb",
            "filename": "packages/forms/test/form_group_spec.ts",
            "status": "modified",
            "additions": 19,
            "deletions": 17,
            "changes": 36,
            "blob_url": "https://github.com/angular/angular/blob/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fform_group_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fform_group_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Fform_group_spec.ts?ref=65717999c800f279d5a802f9309ea55a9246062f",
            "patch": "@@ -70,7 +70,8 @@ describe('FormGroup', () => {\n         'c1': new FormControl('v1'),\n         'group': new FormGroup({'c2': new FormControl('v2'), 'c3': new FormControl('v3')}),\n         'array': new FormArray([\n-          new FormControl('v4'), new FormControl('v5'), new FormGroup({'c4': new FormControl('v4')})\n+          new FormControl('v4') as any, new FormControl('v5'),\n+          new FormGroup({'c4': new FormControl('v4')})\n         ])\n       });\n \n@@ -132,7 +133,7 @@ describe('FormGroup', () => {\n     });\n \n     it('should update value and validity when control is added', () => {\n-      const g = new FormGroup({'one': new FormControl('1')});\n+      const g: FormGroup = new FormGroup({'one': new FormControl('1')});\n       expect(g.value).toEqual({'one': '1'});\n       expect(g.valid).toBe(true);\n \n@@ -143,7 +144,7 @@ describe('FormGroup', () => {\n     });\n \n     it('should update value and validity when control is removed', () => {\n-      const g = new FormGroup(\n+      const g: FormGroup = new FormGroup(\n           {'one': new FormControl('1'), 'two': new FormControl('2', Validators.minLength(10))});\n       expect(g.value).toEqual({'one': '1', 'two': '2'});\n       expect(g.valid).toBe(false);\n@@ -156,7 +157,7 @@ describe('FormGroup', () => {\n \n     it('should not emit events when `FormGroup.addControl` is called with `emitEvent: false`',\n        () => {\n-         const g = new FormGroup({'one': new FormControl('1')});\n+         const g: FormGroup = new FormGroup({'one': new FormControl('1')});\n          expect(g.value).toEqual({'one': '1'});\n \n          g.valueChanges.subscribe(() => logger.push('value change'));\n@@ -170,7 +171,7 @@ describe('FormGroup', () => {\n \n     it('should not emit events when `FormGroup.removeControl` is called with `emitEvent: false`',\n        () => {\n-         const g = new FormGroup(\n+         const g: FormGroup = new FormGroup(\n              {'one': new FormControl('1'), 'two': new FormControl('2', Validators.minLength(10))});\n          expect(g.value).toEqual({'one': '1', 'two': '2'});\n          expect(g.valid).toBe(false);\n@@ -190,7 +191,7 @@ describe('FormGroup', () => {\n          const validatorFn = (value: any) =>\n              value.controls.invalidCtrl ? {invalidCtrl: true} : null;\n          const asyncValidatorFn = (value: any) => of(validatorFn(value));\n-         const g = new FormGroup({}, validatorFn, asyncValidatorFn);\n+         const g: FormGroup = new FormGroup({}, validatorFn, asyncValidatorFn);\n          expect(g.valid).toBe(true);\n \n          g.statusChanges.subscribe(() => logger.push('status change'));\n@@ -939,7 +940,7 @@ describe('FormGroup', () => {\n     }\n \n     it('should run a single validator when the value changes', () => {\n-      const c = new FormControl(null);\n+      const c: FormControl = new FormControl(null);\n       const g = new FormGroup({'one': c}, simpleValidator);\n \n       c.setValue('correct');\n@@ -1152,14 +1153,14 @@ describe('FormGroup', () => {\n        fakeAsync(() => {\n          const c = new FormControl(\n              'fcValue', null!, simpleAsyncValidator({timeout: 0, shouldFail: false}));\n-         const g = new FormGroup(\n+         const g: FormGroup = new FormGroup(\n              {'one': c}, null!, simpleAsyncValidator({timeout: 0, shouldFail: false}));\n \n          const c2 =\n              new FormControl('fcVal', null!, simpleAsyncValidator({timeout: 0, shouldFail: false}));\n \n-         const a =\n-             new FormArray([g, c2], null!, simpleAsyncValidator({timeout: 0, shouldFail: true}));\n+         const a = new FormArray(\n+             [g as any, c2], null!, simpleAsyncValidator({timeout: 0, shouldFail: true}));\n \n          expect(currentStateOf([a, a.at(0)!, a.at(1)!])).toEqual([\n            {errors: {async: true}, pending: false, status: 'INVALID'},  // Array\n@@ -1266,8 +1267,8 @@ describe('FormGroup', () => {\n          const c2 =\n              new FormControl('fcVal', null!, simpleAsyncValidator({timeout: 3, shouldFail: false}));\n \n-         const a =\n-             new FormArray([g, c2], null!, simpleAsyncValidator({timeout: 4, shouldFail: false}));\n+         const a = new FormArray(\n+             [g as any, c2], null!, simpleAsyncValidator({timeout: 4, shouldFail: false}));\n \n          // Initially, the form array and the tested form group and form control c2 are in pending\n          // state\n@@ -1314,8 +1315,8 @@ describe('FormGroup', () => {\n          const c2 =\n              new FormControl('fcVal', null!, simpleAsyncValidator({timeout: 3, shouldFail: false}));\n \n-         const a =\n-             new FormArray([g, c2], null!, simpleAsyncValidator({timeout: 4, shouldFail: true}));\n+         const a = new FormArray(\n+             [g as any, c2], null!, simpleAsyncValidator({timeout: 4, shouldFail: true}));\n \n          // Initially, the form array and the tested form group and form control c2 are in pending\n          // state\n@@ -1711,7 +1712,7 @@ describe('FormGroup', () => {\n     });\n \n     it('should keep empty, disabled groups disabled when updating validity', () => {\n-      const group = new FormGroup({});\n+      const group: FormGroup = new FormGroup({});\n       expect(group.status).toEqual('VALID');\n \n       group.disable();\n@@ -1764,7 +1765,7 @@ describe('FormGroup', () => {\n       });\n \n       it('should re-populate group errors when enabled from a child', () => {\n-        const g = new FormGroup({'one': new FormControl()}, () => ({'expected': true}));\n+        const g: FormGroup = new FormGroup({'one': new FormControl()}, () => ({'expected': true}));\n         g.disable();\n         expect(g.errors).toEqual(null);\n \n@@ -1786,7 +1787,8 @@ describe('FormGroup', () => {\n          }));\n \n       it('should re-populate async group errors when enabled from a child', fakeAsync(() => {\n-           const g = new FormGroup({'one': new FormControl()}, null!, asyncValidator('expected'));\n+           const g: FormGroup =\n+               new FormGroup({'one': new FormControl()}, null!, asyncValidator('expected'));\n            tick();\n            expect(g.errors).toEqual({'async': true});\n "
        },
        {
            "sha": "dbafbc888c0e908db2456bce66cb0a7428073d97",
            "filename": "packages/forms/test/reactive_integration_spec.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 10,
            "changes": 22,
            "blob_url": "https://github.com/angular/angular/blob/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Freactive_integration_spec.ts?ref=65717999c800f279d5a802f9309ea55a9246062f",
            "patch": "@@ -261,7 +261,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n       it('should strip named controls that are not found', () => {\n         const fixture = initTest(NestedFormGroupNameComp, LoginIsEmptyValidator);\n-        const form = new FormGroup({\n+        const form: FormGroup = new FormGroup({\n           'signin': new FormGroup({'login': new FormControl(''), 'password': new FormControl('')})\n         });\n         fixture.componentInstance.form = form;\n@@ -311,7 +311,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n       describe('nested control rebinding', () => {\n         it('should attach dir to control when leaf control changes', () => {\n-          const form = new FormGroup({'login': new FormControl('oldValue')});\n+          const form: FormGroup = new FormGroup({'login': new FormControl('oldValue')});\n           const fixture = initTest(FormGroupComp);\n           fixture.componentInstance.form = form;\n           fixture.detectChanges();\n@@ -336,7 +336,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n         it('should attach dirs to all child controls when group control changes', () => {\n           const fixture = initTest(NestedFormGroupNameComp, LoginIsEmptyValidator);\n-          const form = new FormGroup({\n+          const form: FormGroup = new FormGroup({\n             signin: new FormGroup(\n                 {login: new FormControl('oldLogin'), password: new FormControl('oldPassword')})\n           });\n@@ -369,7 +369,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n         it('should attach dirs to all present child controls when array control changes', () => {\n           const fixture = initTest(FormArrayComp);\n           const cityArray = new FormArray([new FormControl('SF'), new FormControl('NY')]);\n-          const form = new FormGroup({cities: cityArray});\n+          const form: FormGroup = new FormGroup({cities: cityArray});\n           fixture.componentInstance.form = form;\n           fixture.componentInstance.cityArray = cityArray;\n           fixture.detectChanges();\n@@ -1458,7 +1458,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n           class App implements OnDestroy {\n             private _subscription: Subscription;\n \n-            form = new FormGroup({\n+            form: FormGroup = new FormGroup({\n               name: new FormControl('Frodo'),\n               surname: new FormControl('Baggins'),\n             });\n@@ -1490,7 +1490,8 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n         it('should not emit valueChanges or statusChanges until blur', () => {\n           const fixture = initTest(FormControlComp);\n-          const control = new FormControl('', {validators: Validators.required, updateOn: 'blur'});\n+          const control: FormControl =\n+              new FormControl('', {validators: Validators.required, updateOn: 'blur'});\n           fixture.componentInstance.control = control;\n           fixture.detectChanges();\n           const values: string[] = [];\n@@ -1516,7 +1517,8 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n \n         it('should not emit valueChanges or statusChanges on blur if value unchanged', () => {\n           const fixture = initTest(FormControlComp);\n-          const control = new FormControl('', {validators: Validators.required, updateOn: 'blur'});\n+          const control: FormControl =\n+              new FormControl('', {validators: Validators.required, updateOn: 'blur'});\n           fixture.componentInstance.control = control;\n           fixture.detectChanges();\n           const values: string[] = [];\n@@ -1890,7 +1892,7 @@ const ValueAccessorB = createControlValueAccessor('[cva-b]');\n           fixture.componentInstance.form = formGroup;\n           fixture.detectChanges();\n \n-          const values: (string|{[key: string]: string})[] = [];\n+          const values: any[] = [];\n           const streams = merge(\n               control.valueChanges, control.statusChanges, formGroup.valueChanges,\n               formGroup.statusChanges);\n@@ -5322,7 +5324,7 @@ class FormControlWithAsyncValidatorFn {\n   `\n })\n class FormControlWithValidators {\n-  form = new FormGroup({login: new FormControl('INITIAL')});\n+  form: FormGroup = new FormGroup({login: new FormControl('INITIAL')});\n }\n \n @Component({\n@@ -5353,7 +5355,7 @@ class MultipleFormControls {\n   `\n })\n class NgForFormControlWithValidators {\n-  form = new FormGroup({login: new FormControl('a')});\n+  form: FormGroup = new FormGroup({login: new FormControl('a')});\n   logins = ['a', 'b', 'c'];\n }\n "
        },
        {
            "sha": "1eb1df375164511c92808ddff005a758d5318f0f",
            "filename": "packages/forms/test/value_accessor_integration_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fvalue_accessor_integration_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/65717999c800f279d5a802f9309ea55a9246062f/packages%2Fforms%2Ftest%2Fvalue_accessor_integration_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Ftest%2Fvalue_accessor_integration_spec.ts?ref=65717999c800f279d5a802f9309ea55a9246062f",
            "patch": "@@ -621,7 +621,7 @@ import {dispatchEvent} from '@angular/platform-browser/testing/src/browser_util'\n \n         it('should properly set value to null and undefined', () => {\n           const fixture = initTest(FormControlRadioButtons);\n-          const form = new FormGroup(\n+          const form: FormGroup = new FormGroup(\n               {'food': new FormControl('chicken'), 'drink': new FormControl('sprite')});\n           fixture.componentInstance.form = form;\n           fixture.detectChanges();\n@@ -675,7 +675,7 @@ import {dispatchEvent} from '@angular/platform-browser/testing/src/browser_util'\n         it('should support removing controls from <type=radio>', () => {\n           const fixture = initTest(FormControlRadioButtons);\n           const showRadio = new FormControl('yes');\n-          const form =\n+          const form: FormGroup =\n               new FormGroup({'food': new FormControl('fish'), 'drink': new FormControl('sprite')});\n           fixture.componentInstance.form = form;\n           fixture.componentInstance.showRadio = showRadio;"
        }
    ],
    "stats": {
        "total": 92,
        "additions": 51,
        "deletions": 41
    }
}