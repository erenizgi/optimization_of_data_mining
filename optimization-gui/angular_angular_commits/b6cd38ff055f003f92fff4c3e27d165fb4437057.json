{
    "author": "petebacondarwin",
    "message": "fix(common): parse `YYYY-MM` strings as UTC dates (#40620)\n\nIn 2aba8b0 we fixed the DatePipe so that when it parsed date strings\nthat looked like `YYYY-MM-DD` it created a UTC date that was not\naffected by the local timezone of the JavaScript engine.\n\nThis commit does the same for date strings of the form `YYYY-MM`\nand `YYYY`.\n\nFixes #33944\n\nPR Close #40620",
    "sha": "b6cd38ff055f003f92fff4c3e27d165fb4437057",
    "files": [
        {
            "sha": "acb24f99ca4f96888397fef79424609f6b6e41d0",
            "filename": "packages/common/src/i18n/format_date.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/b6cd38ff055f003f92fff4c3e27d165fb4437057/packages%2Fcommon%2Fsrc%2Fi18n%2Fformat_date.ts",
            "raw_url": "https://github.com/angular/angular/raw/b6cd38ff055f003f92fff4c3e27d165fb4437057/packages%2Fcommon%2Fsrc%2Fi18n%2Fformat_date.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fsrc%2Fi18n%2Fformat_date.ts?ref=b6cd38ff055f003f92fff4c3e27d165fb4437057",
            "patch": "@@ -718,15 +718,15 @@ export function toDate(value: string|number|Date): Date {\n       return new Date(parsedNb);\n     }\n \n-    if (/^(\\d{4}-\\d{1,2}-\\d{1,2})$/.test(value)) {\n+    if (/^(\\d{4}(-\\d{1,2}(-\\d{1,2})?)?)$/.test(value)) {\n       /* For ISO Strings without time the day, month and year must be extracted from the ISO String\n       before Date creation to avoid time offset and errors in the new Date.\n       If we only replace '-' with ',' in the ISO String (\"2015,01,01\"), and try to create a new\n       date, some browsers (e.g. IE 9) will throw an invalid Date error.\n       If we leave the '-' (\"2015-01-01\") and try to create a new Date(\"2015-01-01\") the timeoffset\n       is applied.\n       Note: ISO months are 0 for January, 1 for February, ... */\n-      const [y, m, d] = value.split('-').map((val: string) => +val);\n+      const [y, m = 1, d = 1] = value.split('-').map((val: string) => +val);\n       return new Date(y, m - 1, d);\n     }\n "
        },
        {
            "sha": "fe4dbb83b646cb16872a281a3ca7c9518f744531",
            "filename": "packages/common/test/i18n/format_date_spec.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/b6cd38ff055f003f92fff4c3e27d165fb4437057/packages%2Fcommon%2Ftest%2Fi18n%2Fformat_date_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/b6cd38ff055f003f92fff4c3e27d165fb4437057/packages%2Fcommon%2Ftest%2Fi18n%2Fformat_date_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Ftest%2Fi18n%2Fformat_date_spec.ts?ref=b6cd38ff055f003f92fff4c3e27d165fb4437057",
            "patch": "@@ -60,6 +60,8 @@ describe('Format date', () => {\n \n   describe('formatDate', () => {\n     const isoStringWithoutTime = '2015-01-01';\n+    const isoStringWithoutTimeOrDate = '2015-01';\n+    const isoStringWithoutTimeOrDateOrMonth = '2015-01';\n     const defaultFormat = 'mediumDate';\n     let date: Date;\n \n@@ -231,6 +233,16 @@ describe('Format date', () => {\n         expectDateFormatAs(isoStringWithoutTime, pattern, isoStringWithoutTimeFixtures[pattern]);\n       });\n \n+      Object.keys(isoStringWithoutTimeFixtures).forEach((pattern: string) => {\n+        expectDateFormatAs(\n+            isoStringWithoutTimeOrDate, pattern, isoStringWithoutTimeFixtures[pattern]);\n+      });\n+\n+      Object.keys(isoStringWithoutTimeFixtures).forEach((pattern: string) => {\n+        expectDateFormatAs(\n+            isoStringWithoutTimeOrDateOrMonth, pattern, isoStringWithoutTimeFixtures[pattern]);\n+      });\n+\n       const nightTime = new Date(2015, 5, 15, 2, 3, 1, 550);\n       Object.keys(midnightCrossingPeriods).forEach(pattern => {\n         expectDateFormatAs(nightTime, pattern, midnightCrossingPeriods[pattern]);"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 14,
        "deletions": 2
    }
}