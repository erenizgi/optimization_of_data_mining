{
    "author": "crisbeto",
    "message": "fix(compiler): treat i18n attributes with no bindings as static attributes (#39408)\n\nCurrently `i18n` attributes are treated the same no matter if they have data bindings or not. This\nboth generates more code since they have to go through the `ɵɵi18nAttributes` instruction and\nprevents the translated attributes from being injected using the `@Attribute` decorator.\n\nThese changes makes it so that static translated attributes are treated in the same way as regular\nstatic attributes and all other `i18n` attributes go through the old code path.\n\nFixes #38231.\n\nPR Close #39408",
    "sha": "58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
    "files": [
        {
            "sha": "67bc8ae16c6e488b200ce4a7aee08a495c725b4e",
            "filename": "packages/compiler-cli/test/compliance/r3_view_compiler_i18n_spec.ts",
            "status": "modified",
            "additions": 30,
            "deletions": 109,
            "changes": 139,
            "blob_url": "https://github.com/angular/angular/blob/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Fr3_view_compiler_i18n_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Fr3_view_compiler_i18n_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Fr3_view_compiler_i18n_spec.ts?ref=58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
            "patch": "@@ -153,15 +153,22 @@ ${output}\n   `);\n };\n \n-const verify = (input: string, output: string, extra: any = {}): void => {\n+const verify = (input: string, output: string, extra: {\n+  inputArgs?: any,\n+  compilerOptions?: any,\n+  skipPathBasedCheck?: boolean,\n+  skipIdBasedCheck?: boolean,\n+  verbose?: boolean,\n+  exceptions?: {}\n+} = {}): void => {\n   const files = getAppFilesWithTemplate(input, extra.inputArgs);\n   const opts = (i18nUseExternalIds: boolean) =>\n       ({i18nUseExternalIds, ...(extra.compilerOptions || {})});\n \n   // invoke with file-based prefix translation names\n   if (!extra.skipPathBasedCheck) {\n     const result = compile(files, angularFiles, opts(false));\n-    maybePrint(result.source, extra.verbose);\n+    maybePrint(result.source, !!extra.verbose);\n     expect(verifyPlaceholdersIntegrity(result.source)).toBe(true);\n     expect(verifyUniqueConsts(result.source)).toBe(true);\n     expectEmit(result.source, output, 'Incorrect template');\n@@ -170,7 +177,7 @@ const verify = (input: string, output: string, extra: any = {}): void => {\n   // invoke with translation names based on external ids\n   if (!extra.skipIdBasedCheck) {\n     const result = compile(files, angularFiles, opts(true));\n-    maybePrint(result.source, extra.verbose);\n+    maybePrint(result.source, !!extra.verbose);\n     const interpolationConfig = extra.inputArgs && extra.inputArgs.interpolation ?\n         InterpolationConfig.fromArray(extra.inputArgs.interpolation) :\n         undefined;\n@@ -346,7 +353,6 @@ describe('i18n support in the template compiler', () => {\n           ${i18n_7}\n           return [\n             $i18n_0$,\n-            [${AttributeMarker.I18n}, \"title\"],\n             [\"title\", $i18n_1$],\n             [\"title\", $i18n_2$],\n             [\"title\", $i18n_3$],\n@@ -362,31 +368,25 @@ describe('i18n support in the template compiler', () => {\n             $r3$.ɵɵi18n(1, 0);\n             $r3$.ɵɵelementEnd();\n             $r3$.ɵɵelementStart(2, \"div\", 1);\n-            $r3$.ɵɵi18nAttributes(3, 2);\n-            $r3$.ɵɵtext(4, \"Content B\");\n+            $r3$.ɵɵtext(3, \"Content B\");\n             $r3$.ɵɵelementEnd();\n-            $r3$.ɵɵelementStart(5, \"div\", 1);\n-            $r3$.ɵɵi18nAttributes(6, 3);\n-            $r3$.ɵɵtext(7, \"Content C\");\n+            $r3$.ɵɵelementStart(4, \"div\", 2);\n+            $r3$.ɵɵtext(5, \"Content C\");\n             $r3$.ɵɵelementEnd();\n-            $r3$.ɵɵelementStart(8, \"div\", 1);\n-            $r3$.ɵɵi18nAttributes(9, 4);\n-            $r3$.ɵɵtext(10, \"Content D\");\n+            $r3$.ɵɵelementStart(6, \"div\", 3);\n+            $r3$.ɵɵtext(7, \"Content D\");\n             $r3$.ɵɵelementEnd();\n-            $r3$.ɵɵelementStart(11, \"div\", 1);\n-            $r3$.ɵɵi18nAttributes(12, 5);\n-            $r3$.ɵɵtext(13, \"Content E\");\n+            $r3$.ɵɵelementStart(8, \"div\", 4);\n+            $r3$.ɵɵtext(9, \"Content E\");\n             $r3$.ɵɵelementEnd();\n-            $r3$.ɵɵelementStart(14, \"div\", 1);\n-            $r3$.ɵɵi18nAttributes(15, 6);\n-            $r3$.ɵɵtext(16, \"Content F\");\n+            $r3$.ɵɵelementStart(10, \"div\", 5);\n+            $r3$.ɵɵtext(11, \"Content F\");\n             $r3$.ɵɵelementEnd();\n-            $r3$.ɵɵelementStart(17, \"div\", 1);\n-            $r3$.ɵɵi18nAttributes(18, 7);\n-            $r3$.ɵɵtext(19, \"Content G\");\n+            $r3$.ɵɵelementStart(12, \"div\", 6);\n+            $r3$.ɵɵtext(13, \"Content G\");\n             $r3$.ɵɵelementEnd();\n-            $r3$.ɵɵelementStart(20, \"div\");\n-            $r3$.ɵɵi18n(21, 8);\n+            $r3$.ɵɵelementStart(14, \"div\");\n+            $r3$.ɵɵi18n(15, 7);\n             $r3$.ɵɵelementEnd();\n           }\n         }\n@@ -405,14 +405,12 @@ describe('i18n support in the template compiler', () => {\n         consts: function () {\n           ${i18n_0}\n           return [\n-            [${AttributeMarker.I18n}, \"title\"],\n             [\"title\", $i18n_0$]\n           ];\n         },\n         template: function MyComponent_Template(rf, ctx) {\n           if (rf & 1) {\n             $r3$.ɵɵtemplate(0, MyComponent_ng_template_0_Template, 0, 0, \"ng-template\", 0);\n-            $r3$.ɵɵi18nAttributes(1, 1);\n           }\n         }\n       `;\n@@ -436,21 +434,19 @@ describe('i18n support in the template compiler', () => {\n             function MyComponent_0_Template(rf, ctx) {\n               if (rf & 1) {\n                 $r3$.ɵɵtemplate(0, MyComponent_0_ng_template_0_Template, 1, 0, \"ng-template\", 1);\n-                $r3$.ɵɵi18nAttributes(1, 2);\n               }\n             }\n             …\n             consts: function() {\n               ${i18n_0}\n               return [\n                 [${AttributeMarker.Template}, \"ngIf\"],\n-                [${AttributeMarker.I18n}, \"title\"],\n                 [\"title\", $i18n_0$]\n               ];\n             },\n             template: function MyComponent_Template(rf, ctx) {\n               if (rf & 1) {\n-                $r3$.ɵɵtemplate(0, MyComponent_0_Template, 2, 0, undefined, 0);\n+                $r3$.ɵɵtemplate(0, MyComponent_0_Template, 1, 0, undefined, 0);\n               }\n               if (rf & 2) {\n                 $r3$.ɵɵproperty(\"ngIf\", ctx.visible);\n@@ -584,15 +580,12 @@ describe('i18n support in the template compiler', () => {\n         consts: function() {\n           ${i18n_0}\n           return [\n-            [\"id\", \"static\", ${AttributeMarker.I18n}, \"title\"],\n-            [\"title\", $i18n_0$]\n+            [\"id\", \"static\", \"title\", $i18n_0$]\n           ];\n         },\n         template: function MyComponent_Template(rf, ctx) {\n           if (rf & 1) {\n-            $r3$.ɵɵelementStart(0, \"div\", 0);\n-            $r3$.ɵɵi18nAttributes(1, 1);\n-            $r3$.ɵɵelementEnd();\n+            $r3$.ɵɵelement(0, \"div\", 0);\n           }\n         }\n       `;\n@@ -640,9 +633,9 @@ describe('i18n support in the template compiler', () => {\n           ${i18n_3}\n           ${i18n_4}\n           return [\n-            [\"id\", \"dynamic-1\", ${AttributeMarker.I18n}, \"aria-roledescription\",\n-                                                                \"title\", \"aria-label\"],\n-            [\"aria-roledescription\", $i18n_0$, \"title\", $i18n_1$, \"aria-label\", $i18n_2$],\n+            [\"id\", \"dynamic-1\", \"aria-roledescription\",  $i18n_0$, ${AttributeMarker.I18n},\n+              \"title\", \"aria-label\"],\n+            [\"title\", $i18n_1$, \"aria-label\", $i18n_2$],\n             [\"id\", \"dynamic-2\", ${AttributeMarker.I18n}, \"title\", \"aria-roledescription\"],\n             [\"title\", $i18n_3$, \"aria-roledescription\", $i18n_4$]\n           ];\n@@ -790,76 +783,6 @@ describe('i18n support in the template compiler', () => {\n       verify(input, output);\n     });\n \n-    it('should support interpolation', () => {\n-      const input = `\n-        <div id=\"dynamic-1\"\n-          i18n-title=\"m|d\" title=\"intro {{ valueA | uppercase }}\"\n-          i18n-aria-label=\"m1|d1\" aria-label=\"{{ valueB }}\"\n-          i18n-aria-roledescription aria-roledescription=\"static text\"\n-        ></div>\n-        <div id=\"dynamic-2\"\n-          i18n-title=\"m2|d2\" title=\"{{ valueA }} and {{ valueB }} and again {{ valueA + valueB }}\"\n-          i18n-aria-roledescription aria-roledescription=\"{{ valueC }}\"\n-        ></div>\n-      `;\n-\n-      const i18n_0 = i18nMsg('static text');\n-      const i18n_1 = i18nMsg(\n-          'intro {$interpolation}', [['interpolation', String.raw`\\uFFFD0\\uFFFD`]],\n-          {meaning: 'm', desc: 'd'});\n-      const i18n_2 = i18nMsg(\n-          '{$interpolation}', [['interpolation', String.raw`\\uFFFD0\\uFFFD`]],\n-          {meaning: 'm1', desc: 'd1'});\n-      const i18n_3 = i18nMsg(\n-          '{$interpolation} and {$interpolation_1} and again {$interpolation_2}',\n-          [\n-            ['interpolation', String.raw`\\uFFFD0\\uFFFD`],\n-            ['interpolation_1', String.raw`\\uFFFD1\\uFFFD`],\n-            ['interpolation_2', String.raw`\\uFFFD2\\uFFFD`]\n-          ],\n-          {meaning: 'm2', desc: 'd2'});\n-      const i18n_4 = i18nMsg('{$interpolation}', [['interpolation', String.raw`\\uFFFD0\\uFFFD`]]);\n-\n-      const output = String.raw`\n-        decls: 5,\n-        vars: 8,\n-        consts: function() {\n-          ${i18n_0}\n-          ${i18n_1}\n-          ${i18n_2}\n-          ${i18n_3}\n-          ${i18n_4}\n-          return [\n-            [\"id\", \"dynamic-1\", ${AttributeMarker.I18n}, \"aria-roledescription\",\n-                                                                \"title\", \"aria-label\"],\n-            [\"aria-roledescription\", $i18n_0$, \"title\", $i18n_1$, \"aria-label\", $i18n_2$],\n-            [\"id\", \"dynamic-2\", ${AttributeMarker.I18n}, \"title\", \"aria-roledescription\"],\n-            [\"title\", $i18n_3$, \"aria-roledescription\", $i18n_4$]\n-          ];\n-        },\n-        template: function MyComponent_Template(rf, ctx) {\n-          if (rf & 1) {\n-            $r3$.ɵɵelementStart(0, \"div\", 0);\n-            $r3$.ɵɵpipe(1, \"uppercase\");\n-            $r3$.ɵɵi18nAttributes(2, 1);\n-            $r3$.ɵɵelementEnd();\n-            $r3$.ɵɵelementStart(3, \"div\", 2);\n-            $r3$.ɵɵi18nAttributes(4, 3);\n-            $r3$.ɵɵelementEnd();\n-          }\n-          if (rf & 2) {\n-            $r3$.ɵɵi18nExp($r3$.ɵɵpipeBind1(1, 6, ctx.valueA))(ctx.valueB);\n-            $r3$.ɵɵi18nApply(2);\n-            $r3$.ɵɵadvance(3);\n-            $r3$.ɵɵi18nExp(ctx.valueA)(ctx.valueB)(ctx.valueA + ctx.valueB)(ctx.valueC);\n-            $r3$.ɵɵi18nApply(4);\n-          }\n-        }\n-      `;\n-\n-      verify(input, output);\n-    });\n-\n     it('should correctly bind to context in nested template', () => {\n       const input = `\n         <div *ngFor=\"let outer of items\">\n@@ -925,16 +848,14 @@ describe('i18n support in the template compiler', () => {\n           ${i18n_0}\n           ${i18n_1}\n           return [\n-            [${AttributeMarker.I18n}, \"title\"],\n             [\"title\", $i18n_0$],\n             $i18n_1$\n           ];\n         },\n         template: function MyComponent_Template(rf, ctx) {\n           if (rf & 1) {\n             $r3$.ɵɵelementStart(0, \"div\", 0);\n-            $r3$.ɵɵi18nAttributes(1, 1);\n-            $r3$.ɵɵi18n(2, 2);\n+            $r3$.ɵɵi18n(1, 1);\n             $r3$.ɵɵelementEnd();\n           }\n         }"
        },
        {
            "sha": "b4fe3e95866d4e69ee48694100ced9b4ceb8587c",
            "filename": "packages/compiler/src/render3/view/i18n/util.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fi18n%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fi18n%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fi18n%2Futil.ts?ref=58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
            "patch": "@@ -50,6 +50,11 @@ export function hasI18nMeta(node: t.Node&{i18n?: i18n.I18nMeta}): boolean {\n   return !!node.i18n;\n }\n \n+export function isBoundI18nAttribute(node: t.TextAttribute|\n+                                     t.BoundAttribute): node is t.BoundAttribute {\n+  return node.i18n !== undefined && node instanceof t.BoundAttribute;\n+}\n+\n export function hasI18nAttrs(element: html.Element): boolean {\n   return element.attrs.some((attr: html.Attribute) => isI18nAttribute(attr.name));\n }"
        },
        {
            "sha": "f7b0ebebafefb40b938f2773cbfd59ef085297c2",
            "filename": "packages/compiler/src/render3/view/template.ts",
            "status": "modified",
            "additions": 47,
            "deletions": 38,
            "changes": 85,
            "blob_url": "https://github.com/angular/angular/blob/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts",
            "raw_url": "https://github.com/angular/angular/raw/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts?ref=58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
            "patch": "@@ -36,7 +36,7 @@ import {I18nContext} from './i18n/context';\n import {createGoogleGetMsgStatements} from './i18n/get_msg_utils';\n import {createLocalizeStatements} from './i18n/localize_utils';\n import {I18nMetaVisitor} from './i18n/meta';\n-import {assembleBoundTextPlaceholders, assembleI18nBoundString, declareI18nVariable, getTranslationConstPrefix, hasI18nMeta, I18N_ICU_MAPPING_PREFIX, i18nFormatPlaceholderNames, icuFromI18nMessage, isI18nRootNode, isSingleI18nIcu, placeholdersToParams, TRANSLATION_VAR_PREFIX, wrapI18nPlaceholder} from './i18n/util';\n+import {assembleBoundTextPlaceholders, assembleI18nBoundString, declareI18nVariable, getTranslationConstPrefix, hasI18nMeta, I18N_ICU_MAPPING_PREFIX, i18nFormatPlaceholderNames, icuFromI18nMessage, isBoundI18nAttribute, isI18nRootNode, isSingleI18nIcu, placeholdersToParams, TRANSLATION_VAR_PREFIX, wrapI18nPlaceholder} from './i18n/util';\n import {StylingBuilder, StylingInstruction} from './styling_builder';\n import {asLiteral, chainedInstruction, CONTEXT_NAME, getAttrsForDirectiveMatching, getInterpolationArgsLength, IMPLICIT_REFERENCE, invalid, NON_BINDABLE_ATTR, REFERENCE_PREFIX, RENDER_FLAGS, trimTrailingNulls, unsupported} from './util';\n \n@@ -492,30 +492,25 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n   }\n \n   private i18nAttributesInstruction(\n-      nodeIndex: number, attrs: (t.TextAttribute|t.BoundAttribute)[],\n-      sourceSpan: ParseSourceSpan): void {\n+      nodeIndex: number, attrs: t.BoundAttribute[], sourceSpan: ParseSourceSpan): void {\n     let hasBindings: boolean = false;\n     const i18nAttrArgs: o.Expression[] = [];\n     const bindings: ChainableBindingInstruction[] = [];\n     attrs.forEach(attr => {\n       const message = attr.i18n! as i18n.Message;\n-      if (attr instanceof t.TextAttribute) {\n-        i18nAttrArgs.push(o.literal(attr.name), this.i18nTranslate(message));\n-      } else {\n-        const converted = attr.value.visit(this._valueConverter);\n-        this.allocateBindingSlots(converted);\n-        if (converted instanceof Interpolation) {\n-          const placeholders = assembleBoundTextPlaceholders(message);\n-          const params = placeholdersToParams(placeholders);\n-          i18nAttrArgs.push(o.literal(attr.name), this.i18nTranslate(message, params));\n-          converted.expressions.forEach(expression => {\n-            hasBindings = true;\n-            bindings.push({\n-              sourceSpan,\n-              value: () => this.convertPropertyBinding(expression),\n-            });\n+      const converted = attr.value.visit(this._valueConverter);\n+      this.allocateBindingSlots(converted);\n+      if (converted instanceof Interpolation) {\n+        const placeholders = assembleBoundTextPlaceholders(message);\n+        const params = placeholdersToParams(placeholders);\n+        i18nAttrArgs.push(o.literal(attr.name), this.i18nTranslate(message, params));\n+        converted.expressions.forEach(expression => {\n+          hasBindings = true;\n+          bindings.push({\n+            sourceSpan,\n+            value: () => this.convertPropertyBinding(expression),\n           });\n-        }\n+        });\n       }\n     });\n     if (bindings.length > 0) {\n@@ -591,7 +586,7 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n     const isI18nRootElement: boolean =\n         isI18nRootNode(element.i18n) && !isSingleI18nIcu(element.i18n);\n \n-    const i18nAttrs: (t.TextAttribute|t.BoundAttribute)[] = [];\n+    const boundI18nAttrs: t.BoundAttribute[] = [];\n     const outputAttrs: t.TextAttribute[] = [];\n \n     const [namespaceKey, elementName] = splitNsName(element.name);\n@@ -606,8 +601,12 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n         stylingBuilder.registerStyleAttr(value);\n       } else if (name === 'class') {\n         stylingBuilder.registerClassAttr(value);\n+      } else if (isBoundI18nAttribute(attr)) {\n+        // Note that we don't collect static i18n attributes here, because\n+        // they can be treated in the same way as regular attributes.\n+        boundI18nAttrs.push(attr);\n       } else {\n-        (attr.i18n ? i18nAttrs : outputAttrs).push(attr);\n+        outputAttrs.push(attr);\n       }\n     }\n \n@@ -627,7 +626,7 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n       const stylingInputWasSet = stylingBuilder.registerBoundInput(input);\n       if (!stylingInputWasSet) {\n         if (input.type === BindingType.Property && input.i18n) {\n-          i18nAttrs.push(input);\n+          boundI18nAttrs.push(input);\n         } else {\n           allOtherInputs.push(input);\n         }\n@@ -636,7 +635,8 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n \n     // add attributes for directive and projection matching purposes\n     const attributes: o.Expression[] = this.getAttributeExpressions(\n-        element.name, outputAttrs, allOtherInputs, element.outputs, stylingBuilder, [], i18nAttrs);\n+        element.name, outputAttrs, allOtherInputs, element.outputs, stylingBuilder, [],\n+        boundI18nAttrs);\n     parameters.push(this.addAttrsToConsts(attributes));\n \n     // local refs (ex.: <div #foo #bar=\"baz\">)\n@@ -662,7 +662,7 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n                                                             element.children.length > 0;\n \n     const createSelfClosingInstruction = !stylingBuilder.hasBindingsWithPipes &&\n-        element.outputs.length === 0 && i18nAttrs.length === 0 && !hasChildren;\n+        element.outputs.length === 0 && boundI18nAttrs.length === 0 && !hasChildren;\n     const createSelfClosingI18nInstruction =\n         !createSelfClosingInstruction && hasTextChildrenOnly(element.children);\n \n@@ -679,9 +679,9 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n         this.creationInstruction(element.startSourceSpan, R3.disableBindings);\n       }\n \n-      if (i18nAttrs.length > 0) {\n+      if (boundI18nAttrs.length > 0) {\n         this.i18nAttributesInstruction(\n-            elementIndex, i18nAttrs, element.startSourceSpan ?? element.sourceSpan);\n+            elementIndex, boundI18nAttrs, element.startSourceSpan ?? element.sourceSpan);\n       }\n \n       // Generate Listeners (outputs)\n@@ -866,10 +866,11 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n     this.matchDirectives(NG_TEMPLATE_TAG_NAME, template);\n \n     // prepare attributes parameter (including attributes used for directive matching)\n-    const [i18nStaticAttrs, staticAttrs] = partitionArray(template.attributes, hasI18nMeta);\n+    const [boundI18nAttrs, attrs] = partitionArray<t.BoundAttribute, t.TextAttribute>(\n+        template.attributes, isBoundI18nAttribute);\n     const attrsExprs: o.Expression[] = this.getAttributeExpressions(\n-        NG_TEMPLATE_TAG_NAME, staticAttrs, template.inputs, template.outputs,\n-        undefined /* styles */, template.templateAttrs, i18nStaticAttrs);\n+        NG_TEMPLATE_TAG_NAME, attrs, template.inputs, template.outputs, undefined /* styles */,\n+        template.templateAttrs, boundI18nAttrs);\n     parameters.push(this.addAttrsToConsts(attrsExprs));\n \n     // local refs (ex.: <ng-template #foo>)\n@@ -913,8 +914,9 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n \n     // Only add normal input/output binding instructions on explicit <ng-template> elements.\n     if (template.tagName === NG_TEMPLATE_TAG_NAME) {\n-      const [i18nInputs, inputs] = partitionArray(template.inputs, hasI18nMeta);\n-      const i18nAttrs = [...i18nStaticAttrs, ...i18nInputs];\n+      const [i18nInputs, inputs] =\n+          partitionArray<t.BoundAttribute, t.BoundAttribute>(template.inputs, hasI18nMeta);\n+      const i18nAttrs = [...boundI18nAttrs, ...i18nInputs];\n \n       // Add i18n attributes that may act as inputs to directives. If such attributes are present,\n       // generate `i18nAttributes` instruction. Note: we generate it only for explicit <ng-template>\n@@ -1289,18 +1291,25 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n       elementName: string, renderAttributes: t.TextAttribute[], inputs: t.BoundAttribute[],\n       outputs: t.BoundEvent[], styles?: StylingBuilder,\n       templateAttrs: (t.BoundAttribute|t.TextAttribute)[] = [],\n-      i18nAttrs: (t.BoundAttribute|t.TextAttribute)[] = []): o.Expression[] {\n+      boundI18nAttrs: t.BoundAttribute[] = []): o.Expression[] {\n     const alreadySeen = new Set<string>();\n     const attrExprs: o.Expression[] = [];\n     let ngProjectAsAttr: t.TextAttribute|undefined;\n \n-    renderAttributes.forEach((attr: t.TextAttribute) => {\n+    for (const attr of renderAttributes) {\n       if (attr.name === NG_PROJECT_AS_ATTR_NAME) {\n         ngProjectAsAttr = attr;\n       }\n-      attrExprs.push(\n-          ...getAttributeNameLiterals(attr.name), trustedConstAttribute(elementName, attr));\n-    });\n+\n+      // Note that static i18n attributes aren't in the i18n array,\n+      // because they're treated in the same way as regular attributes.\n+      if (attr.i18n) {\n+        attrExprs.push(o.literal(attr.name), this.i18nTranslate(attr.i18n as i18n.Message));\n+      } else {\n+        attrExprs.push(\n+            ...getAttributeNameLiterals(attr.name), trustedConstAttribute(elementName, attr));\n+      }\n+    }\n \n     // Keep ngProjectAs next to the other name, value pairs so we can verify that we match\n     // ngProjectAs marker in the attribute name slot.\n@@ -1360,9 +1369,9 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n       templateAttrs.forEach(attr => addAttrExpr(attr.name));\n     }\n \n-    if (i18nAttrs.length) {\n+    if (boundI18nAttrs.length) {\n       attrExprs.push(o.literal(core.AttributeMarker.I18n));\n-      i18nAttrs.forEach(attr => addAttrExpr(attr.name));\n+      boundI18nAttrs.forEach(attr => addAttrExpr(attr.name));\n     }\n \n     return attrExprs;"
        },
        {
            "sha": "0d58b083e14212be45d3b5a15f3ccd61ee9db5d5",
            "filename": "packages/compiler/src/util.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcompiler%2Fsrc%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcompiler%2Fsrc%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Futil.ts?ref=58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
            "patch": "@@ -280,12 +280,12 @@ export function newArray<T>(size: number, value?: T): T[] {\n  * @param conditionFn Condition function that is called for each item in a given array and returns a\n  * boolean value.\n  */\n-export function partitionArray<T>(\n-    arr: T[], conditionFn: <K extends T>(value: K) => boolean): [T[], T[]] {\n+export function partitionArray<T, F = T>(\n+    arr: (T|F)[], conditionFn: (value: T|F) => boolean): [T[], F[]] {\n   const truthy: T[] = [];\n-  const falsy: T[] = [];\n-  arr.forEach(item => {\n-    (conditionFn(item) ? truthy : falsy).push(item);\n-  });\n+  const falsy: F[] = [];\n+  for (const item of arr) {\n+    (conditionFn(item) ? truthy : falsy).push(item as any);\n+  }\n   return [truthy, falsy];\n }"
        },
        {
            "sha": "6ed2836bf74724a334175af354698a9fe3addf23",
            "filename": "packages/core/src/render3/i18n/i18n_parse.ts",
            "status": "modified",
            "additions": 29,
            "deletions": 48,
            "changes": 77,
            "blob_url": "https://github.com/angular/angular/blob/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_parse.ts",
            "raw_url": "https://github.com/angular/angular/raw/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_parse.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Fi18n%2Fi18n_parse.ts?ref=58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
            "patch": "@@ -14,16 +14,14 @@ import {_sanitizeUrl, sanitizeSrcset} from '../../sanitization/url_sanitizer';\n import {assertDefined, assertEqual, assertGreaterThanOrEqual, assertOneOf, assertString} from '../../util/assert';\n import {CharCode} from '../../util/char_code';\n import {loadIcuContainerVisitor} from '../instructions/i18n_icu_container_visitor';\n-import {allocExpando, createTNodeAtIndex, elementAttributeInternal, setInputsForProperty, setNgReflectProperties} from '../instructions/shared';\n+import {allocExpando, createTNodeAtIndex} from '../instructions/shared';\n import {getDocument} from '../interfaces/document';\n import {ELEMENT_MARKER, I18nCreateOpCode, I18nCreateOpCodes, I18nRemoveOpCodes, I18nUpdateOpCode, I18nUpdateOpCodes, ICU_MARKER, IcuCreateOpCode, IcuCreateOpCodes, IcuExpression, IcuType, TI18n, TIcu} from '../interfaces/i18n';\n import {TNode, TNodeType} from '../interfaces/node';\n-import {RComment, RElement} from '../interfaces/renderer';\n import {SanitizerFn} from '../interfaces/sanitization';\n import {HEADER_OFFSET, LView, TView} from '../interfaces/view';\n import {getCurrentParentTNode, getCurrentTNode, setCurrentTNode} from '../state';\n import {attachDebugGetter} from '../util/debug_utils';\n-import {getNativeByIndex, getTNode} from '../util/view_utils';\n \n import {i18nCreateOpCodesToString, i18nRemoveOpCodesToString, i18nUpdateOpCodesToString, icuCreateOpCodesToString} from './i18n_debug';\n import {addTNodeAndUpdateInsertBeforeIndex} from './i18n_insert_before_index';\n@@ -102,7 +100,10 @@ export function i18nStartFirstCreatePass(\n           // Verify that ICU expression has the right shape. Translations might contain invalid\n           // constructions (while original messages were correct), so ICU parsing at runtime may\n           // not succeed (thus `icuExpression` remains a string).\n-          if (ngDevMode && typeof icuExpression !== 'object') {\n+          // Note: we intentionally retain the error here by not using `ngDevMode`, because\n+          // the value can change based on the locale and users aren't guaranteed to hit\n+          // an invalid string while they're developing.\n+          if (typeof icuExpression !== 'object') {\n             throw new Error(`Unable to parse ICU expression in \"${message}\" message.`);\n           }\n           const icuContainerTNode = createTNodeAndAddOpCode(\n@@ -225,54 +226,34 @@ function i18nStartFirstCreatePassProcessTextNode(\n /**\n  * See `i18nAttributes` above.\n  */\n-export function i18nAttributesFirstPass(\n-    lView: LView, tView: TView, index: number, values: string[]) {\n+export function i18nAttributesFirstPass(tView: TView, index: number, values: string[]) {\n   const previousElement = getCurrentTNode()!;\n   const previousElementIndex = previousElement.index;\n   const updateOpCodes: I18nUpdateOpCodes = [] as any;\n   if (ngDevMode) {\n     attachDebugGetter(updateOpCodes, i18nUpdateOpCodesToString);\n   }\n-  for (let i = 0; i < values.length; i += 2) {\n-    const attrName = values[i];\n-    const message = values[i + 1];\n-    const parts = message.split(ICU_REGEXP);\n-    for (let j = 0; j < parts.length; j++) {\n-      const value = parts[j];\n-\n-      if (j & 1) {\n-        // Odd indexes are ICU expressions\n-        // TODO(ocombe): support ICU expressions in attributes\n-        throw new Error('ICU expressions are not yet supported in attributes');\n-      } else if (value !== '') {\n-        // Even indexes are text (including bindings)\n-        const hasBinding = !!value.match(BINDING_REGEXP);\n-        if (hasBinding) {\n-          if (tView.firstCreatePass && tView.data[index] === null) {\n-            generateBindingUpdateOpCodes(updateOpCodes, value, previousElementIndex, attrName);\n-          }\n-        } else {\n-          const tNode = getTNode(tView, previousElementIndex);\n-          // Set attributes for Elements only, for other types (like ElementContainer),\n-          // only set inputs below\n-          if (tNode.type & TNodeType.AnyRNode) {\n-            elementAttributeInternal(tNode, lView, attrName, value, null, null);\n-          }\n-          // Check if that attribute is a directive input\n-          const dataValue = tNode.inputs !== null && tNode.inputs[attrName];\n-          if (dataValue) {\n-            setInputsForProperty(tView, lView, dataValue, attrName, value);\n-            if (ngDevMode) {\n-              const element = getNativeByIndex(previousElementIndex, lView) as RElement | RComment;\n-              setNgReflectProperties(lView, element, tNode.type, dataValue, value);\n-            }\n-          }\n+  if (tView.firstCreatePass && tView.data[index] === null) {\n+    for (let i = 0; i < values.length; i += 2) {\n+      const attrName = values[i];\n+      const message = values[i + 1];\n+\n+      if (message !== '') {\n+        // Check if attribute value contains an ICU and throw an error if that's the case.\n+        // ICUs in element attributes are not supported.\n+        // Note: we intentionally retain the error here by not using `ngDevMode`, because\n+        // the `value` can change based on the locale and users aren't guaranteed to hit\n+        // an invalid string while they're developing.\n+        if (ICU_REGEXP.test(message)) {\n+          throw new Error(\n+              `ICU expressions are not supported in attributes. Message: \"${message}\".`);\n         }\n+\n+        // i18n attributes that hit this code path are guaranteed to have bindings, because\n+        // the compiler treats static i18n attributes as regular attribute bindings.\n+        generateBindingUpdateOpCodes(updateOpCodes, message, previousElementIndex, attrName);\n       }\n     }\n-  }\n-\n-  if (tView.firstCreatePass && tView.data[index] === null) {\n     tView.data[index] = updateOpCodes;\n   }\n }\n@@ -622,10 +603,10 @@ function walkIcuTree(\n                   generateBindingUpdateOpCodes(update, attr.value, newIndex, attr.name);\n                 }\n               } else {\n-                ngDevMode && console.warn(` WARNING:\n-      ignoring unsafe attribute value ${lowerAttrName} on element $ {\n-    tagName\n-  } (see http://g.co/ng/security#xss)`);\n+                ngDevMode &&\n+                    console.warn(\n+                        `WARNING: ignoring unsafe attribute value ` +\n+                        `${lowerAttrName} on element ${tagName} (see http://g.co/ng/security#xss)`);\n               }\n             } else {\n               addCreateAttribute(create, newIndex, attr);\n@@ -705,4 +686,4 @@ function addCreateNodeAndAppend(\n \n function addCreateAttribute(create: IcuCreateOpCodes, newIndex: number, attr: Attr) {\n   create.push(newIndex << IcuCreateOpCode.SHIFT_REF | IcuCreateOpCode.Attr, attr.name, attr.value);\n-}\n\\ No newline at end of file\n+}"
        },
        {
            "sha": "cfeda67690b6a98aace3cc434c735ca46f573787",
            "filename": "packages/core/src/render3/instructions/i18n.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fi18n.ts",
            "raw_url": "https://github.com/angular/angular/raw/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fi18n.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fi18n.ts?ref=58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
            "patch": "@@ -122,11 +122,10 @@ export function ɵɵi18n(index: number, messageIndex: number, subTemplateIndex?:\n  * @codeGenApi\n  */\n export function ɵɵi18nAttributes(index: number, attrsIndex: number): void {\n-  const lView = getLView();\n   const tView = getTView();\n   ngDevMode && assertDefined(tView, `tView should be defined`);\n   const attrs = getConstant<string[]>(tView.consts, attrsIndex)!;\n-  i18nAttributesFirstPass(lView, tView, index + HEADER_OFFSET, attrs);\n+  i18nAttributesFirstPass(tView, index + HEADER_OFFSET, attrs);\n }\n \n \n@@ -181,4 +180,4 @@ export function ɵɵi18nApply(index: number) {\n export function ɵɵi18nPostprocess(\n     message: string, replacements: {[key: string]: (string|string[])} = {}): string {\n   return i18nPostprocess(message, replacements);\n-}\n\\ No newline at end of file\n+}"
        },
        {
            "sha": "8bc0206a564d5d4c3aaf2ce888d179ba682fdb40",
            "filename": "packages/core/test/acceptance/di_spec.ts",
            "status": "modified",
            "additions": 20,
            "deletions": 0,
            "changes": 20,
            "blob_url": "https://github.com/angular/angular/blob/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Ftest%2Facceptance%2Fdi_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Ftest%2Facceptance%2Fdi_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Facceptance%2Fdi_spec.ts?ref=58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
            "patch": "@@ -2054,6 +2054,26 @@ describe('di', () => {\n       expect(directive.outputAttr).toBeNull();\n       expect(directive.other).toBe('otherValue');\n     });\n+\n+    it('should inject `null` for attributes with data bindings', () => {\n+      @Directive({selector: '[dir]'})\n+      class MyDir {\n+        constructor(@Attribute('title') public attrValue: string) {}\n+      }\n+\n+      @Component({template: '<div dir title=\"title {{ value }}\"></div>'})\n+      class MyComp {\n+        @ViewChild(MyDir) directiveInstance!: MyDir;\n+        value = 'value';\n+      }\n+\n+      TestBed.configureTestingModule({declarations: [MyDir, MyComp]});\n+      const fixture = TestBed.createComponent(MyComp);\n+      fixture.detectChanges();\n+\n+      expect(fixture.componentInstance.directiveInstance.attrValue).toBeNull();\n+      expect(fixture.nativeElement.querySelector('div').getAttribute('title')).toBe('title value');\n+    });\n   });\n \n   it('should support dependencies in Pipes used inside ICUs', () => {"
        },
        {
            "sha": "315e92d4481e8f086376df86cc16e26b4504ef62",
            "filename": "packages/core/test/acceptance/i18n_spec.ts",
            "status": "modified",
            "additions": 53,
            "deletions": 43,
            "changes": 96,
            "blob_url": "https://github.com/angular/angular/blob/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Ftest%2Facceptance%2Fi18n_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Ftest%2Facceptance%2Fi18n_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Facceptance%2Fi18n_spec.ts?ref=58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
            "patch": "@@ -13,7 +13,7 @@ import {CommonModule, DOCUMENT, registerLocaleData} from '@angular/common';\n import localeEs from '@angular/common/locales/es';\n import localeRo from '@angular/common/locales/ro';\n import {computeMsgId} from '@angular/compiler';\n-import {Component, ContentChild, ContentChildren, Directive, ElementRef, HostBinding, Input, LOCALE_ID, NO_ERRORS_SCHEMA, Pipe, PipeTransform, QueryList, RendererFactory2, TemplateRef, Type, ViewChild, ViewContainerRef, ɵsetDocument} from '@angular/core';\n+import {Attribute, Component, ContentChild, ContentChildren, Directive, ElementRef, HostBinding, Input, LOCALE_ID, NO_ERRORS_SCHEMA, Pipe, PipeTransform, QueryList, RendererFactory2, TemplateRef, Type, ViewChild, ViewContainerRef, ɵsetDocument} from '@angular/core';\n import {DebugNode, HEADER_OFFSET, TVIEW} from '@angular/core/src/render3/interfaces/view';\n import {getComponentLView} from '@angular/core/src/render3/util/discovery_utils';\n import {TestBed} from '@angular/core/testing';\n@@ -642,9 +642,9 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n       // such a case a single `TIcuContainerNode` should be generated only.\n       it('should create a single dynamic TNode for ICU', () => {\n         const fixture = initWithTemplate(AppComp, `\n-          {count, plural, \n-            =0 {just now} \n-            =1 {one minute ago} \n+          {count, plural,\n+            =0 {just now}\n+            =1 {one minute ago}\n             other {{{count}} minutes ago}\n           }\n         `.trim());\n@@ -662,13 +662,13 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n \n       it('should support multiple ICUs', () => {\n         const fixture = initWithTemplate(AppComp, `\n-          {count, plural, \n-            =0 {just now} \n-            =1 {one minute ago} \n+          {count, plural,\n+            =0 {just now}\n+            =1 {one minute ago}\n             other {{{count}} minutes ago}\n           }\n-          {name, select, \n-            Angular {Mr. Angular} \n+          {name, select,\n+            Angular {Mr. Angular}\n             other {Sir}\n           }\n         `);\n@@ -1843,40 +1843,6 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n       expect(fixture.nativeElement.firstChild.title).toEqual(`ANGULAR - value 1 - value 2 (fr)`);\n     });\n \n-    it('should create corresponding ng-reflect properties', () => {\n-      @Component({\n-        selector: 'welcome',\n-        template: '{{ messageText }}',\n-      })\n-      class WelcomeComp {\n-        @Input() messageText!: string;\n-      }\n-\n-      @Component({\n-        template: `\n-          <welcome\n-            messageText=\"Hello\"\n-            i18n-messageText=\"Welcome message description\">\n-          </welcome>\n-        `\n-      })\n-      class App {\n-      }\n-\n-      TestBed.configureTestingModule({\n-        declarations: [App, WelcomeComp],\n-      });\n-      loadTranslations({\n-        [computeMsgId('Hello')]: 'Bonjour',\n-      });\n-      const fixture = TestBed.createComponent(App);\n-      fixture.detectChanges();\n-\n-      const comp = fixture.debugElement.query(By.css('welcome'));\n-      expect(comp.attributes['messagetext']).toBe('Bonjour');\n-      expect(comp.attributes['ng-reflect-message-text']).toBe('Bonjour');\n-    });\n-\n     it('should support i18n attributes on <ng-container> elements', () => {\n       loadTranslations({[computeMsgId('Hello', 'meaning')]: 'Bonjour'});\n \n@@ -3024,6 +2990,50 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n     fixture.detectChanges();\n     expect(fixture.nativeElement.textContent).toEqual(`two,one,`);\n   });\n+\n+  it('should be able to inject a static i18n attribute', () => {\n+    loadTranslations({[computeMsgId('text')]: 'translatedText'});\n+\n+    @Directive({selector: '[injectTitle]'})\n+    class InjectTitleDir {\n+      constructor(@Attribute('title') public title: string) {}\n+    }\n+\n+    @Component({template: `<div i18n-title title=\"text\" injectTitle></div>`})\n+    class App {\n+      @ViewChild(InjectTitleDir) dir!: InjectTitleDir;\n+    }\n+\n+    TestBed.configureTestingModule({declarations: [App, InjectTitleDir]});\n+    const fixture = TestBed.createComponent(App);\n+    fixture.detectChanges();\n+\n+    expect(fixture.componentInstance.dir.title).toBe('translatedText');\n+    expect(fixture.nativeElement.querySelector('div').getAttribute('title')).toBe('translatedText');\n+  });\n+\n+  it('should inject `null` for an i18n attribute with an interpolation', () => {\n+    loadTranslations({[computeMsgId('text {$INTERPOLATION}')]: 'translatedText {$INTERPOLATION}'});\n+\n+    @Directive({selector: '[injectTitle]'})\n+    class InjectTitleDir {\n+      constructor(@Attribute('title') public title: string) {}\n+    }\n+\n+    @Component({template: `<div i18n-title title=\"text {{ value }}\" injectTitle></div>`})\n+    class App {\n+      @ViewChild(InjectTitleDir) dir!: InjectTitleDir;\n+      value = 'value';\n+    }\n+\n+    TestBed.configureTestingModule({declarations: [App, InjectTitleDir]});\n+    const fixture = TestBed.createComponent(App);\n+    fixture.detectChanges();\n+\n+    expect(fixture.componentInstance.dir.title).toBeNull();\n+    expect(fixture.nativeElement.querySelector('div').getAttribute('title'))\n+        .toBe('translatedText value');\n+  });\n });\n \n function initWithTemplate(compType: Type<any>, template: string) {"
        },
        {
            "sha": "26c2be6c2ab646b8d965a3d427fabbcdbddb5bf4",
            "filename": "packages/core/test/render3/i18n/i18n_spec.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 24,
            "changes": 24,
            "blob_url": "https://github.com/angular/angular/blob/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/58408d6a60bd43b89cb1d9ad6f8812c8e696d42d/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fi18n%2Fi18n_spec.ts?ref=58408d6a60bd43b89cb1d9ad6f8812c8e696d42d",
            "patch": "@@ -416,30 +416,6 @@ describe('Runtime i18n', () => {\n   });\n \n   describe(`i18nAttribute`, () => {\n-    it('for text', () => {\n-      const message = `Hello world!`;\n-      const attrs = ['title', message];\n-      const nbDecls = 2;\n-      const index = 1;\n-      const fixture = new TemplateFixture({\n-        create: () => {\n-          ɵɵelementStart(0, 'div');\n-          ɵɵi18nAttributes(index, 0);\n-          ɵɵelementEnd();\n-        },\n-        decls: nbDecls,\n-        vars: index,\n-        consts: [attrs],\n-      });\n-      const tView = fixture.hostView[TVIEW];\n-      const opCodes = tView.data[HEADER_OFFSET + index] as I18nUpdateOpCodes;\n-\n-      expect(opCodes).toEqual([]);\n-      expect((getNativeByIndex(HEADER_OFFSET, fixture.hostView as LView) as any as Element)\n-                 .getAttribute('title'))\n-          .toEqual(message);\n-    });\n-\n     it('for simple bindings', () => {\n       const message = `Hello �0�!`;\n       const attrs = ['title', message];"
        }
    ],
    "stats": {
        "total": 463,
        "additions": 192,
        "deletions": 271
    }
}