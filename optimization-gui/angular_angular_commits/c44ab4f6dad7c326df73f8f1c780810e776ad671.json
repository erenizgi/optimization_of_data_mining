{
    "author": "swseverance",
    "message": "fix(router): fix `serializeQueryParams` logic (#42481)\n\ncorrects a bug that resulted in query params such as\n`[queryParams]={a: 1, b:[]}` being serialized as 'a=1&'\ninstead of 'a=1'\n\nresolves #42445\n\nPR Close #42481",
    "sha": "c44ab4f6dad7c326df73f8f1c780810e776ad671",
    "files": [
        {
            "sha": "cd7d1b131edd017c055ca7eb2b6b998fe6161ca1",
            "filename": "packages/router/src/url_tree.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 6,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/c44ab4f6dad7c326df73f8f1c780810e776ad671/packages%2Frouter%2Fsrc%2Furl_tree.ts",
            "raw_url": "https://github.com/angular/angular/raw/c44ab4f6dad7c326df73f8f1c780810e776ad671/packages%2Frouter%2Fsrc%2Furl_tree.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Furl_tree.ts?ref=c44ab4f6dad7c326df73f8f1c780810e776ad671",
            "patch": "@@ -497,12 +497,15 @@ function serializeMatrixParams(params: {[key: string]: string}): string {\n }\n \n function serializeQueryParams(params: {[key: string]: any}): string {\n-  const strParams: string[] = Object.keys(params).map((name) => {\n-    const value = params[name];\n-    return Array.isArray(value) ?\n-        value.map(v => `${encodeUriQuery(name)}=${encodeUriQuery(v)}`).join('&') :\n-        `${encodeUriQuery(name)}=${encodeUriQuery(value)}`;\n-  });\n+  const strParams: string[] =\n+      Object.keys(params)\n+          .map((name) => {\n+            const value = params[name];\n+            return Array.isArray(value) ?\n+                value.map(v => `${encodeUriQuery(name)}=${encodeUriQuery(v)}`).join('&') :\n+                `${encodeUriQuery(name)}=${encodeUriQuery(value)}`;\n+          })\n+          .filter(s => !!s);\n \n   return strParams.length ? `?${strParams.join('&')}` : '';\n }"
        },
        {
            "sha": "8fd407906a64e2464ed03a930e41d599380a1ca0",
            "filename": "packages/router/test/create_url_tree.spec.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/c44ab4f6dad7c326df73f8f1c780810e776ad671/packages%2Frouter%2Ftest%2Fcreate_url_tree.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c44ab4f6dad7c326df73f8f1c780810e776ad671/packages%2Frouter%2Ftest%2Fcreate_url_tree.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fcreate_url_tree.spec.ts?ref=c44ab4f6dad7c326df73f8f1c780810e776ad671",
            "patch": "@@ -27,6 +27,16 @@ describe('createUrlTree', () => {\n       expect(serializer.serialize(t2)).toEqual('/a/c/c2?m=v1&m=v2');\n     });\n \n+    it('should support parameter with empty arrays as values', () => {\n+      const p1 = serializer.parse('/a/c');\n+      const t1 = create(p1.root.children[PRIMARY_OUTLET], 1, p1, ['c2'], {m: []});\n+      expect(serializer.serialize(t1)).toEqual('/a/c/c2');\n+\n+      const p2 = serializer.parse('/a/c');\n+      const t2 = create(p2.root.children[PRIMARY_OUTLET], 1, p2, ['c2'], {m: [], n: 1});\n+      expect(serializer.serialize(t2)).toEqual('/a/c/c2?n=1');\n+    });\n+\n     it('should set query params', () => {\n       const p = serializer.parse('/');\n       const t = createRoot(p, [], {a: 'hey'});"
        }
    ],
    "stats": {
        "total": 25,
        "additions": 19,
        "deletions": 6
    }
}