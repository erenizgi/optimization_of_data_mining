{
    "author": "mgechev",
    "message": "feat(devtools): add selection of multiple frames with shift",
    "sha": "a5a942b732b332bc3f846add7fa6f225bad2532d",
    "files": [
        {
            "sha": "68c20d3c313fa59da2b47c2254aabc0d4136c182",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/frame-selector/frame-selector.component.html",
            "status": "modified",
            "additions": 2,
            "deletions": 7,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/a5a942b732b332bc3f846add7fa6f225bad2532d/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Fframe-selector%2Fframe-selector.component.html",
            "raw_url": "https://github.com/angular/angular/raw/a5a942b732b332bc3f846add7fa6f225bad2532d/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Fframe-selector%2Fframe-selector.component.html",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Fframe-selector%2Fframe-selector.component.html?ref=a5a942b732b332bc3f846add7fa6f225bad2532d",
            "patch": "@@ -1,10 +1,5 @@\n <mat-card class=\"bar-graph-container\">\n-  <p class=\"txt-frames\">\n-    {{ startFrameIndex + 1 }}\n-    <span *ngIf=\"startFrameIndex !== endFrameIndex\"> - {{ endFrameIndex + 1 }} </span>/{{\n-      (graphData$ | async)?.length\n-    }}\n-  </p>\n+  <p class=\"txt-frames\">{{ selectionLabel }} / {{ (graphData$ | async)?.length }}</p>\n   <button mat-icon-button (click)=\"move.emit(-1)\" [disabled]=\"startFrameIndex <= 0\">\n     <mat-icon>chevron_left</mat-icon>\n   </button>\n@@ -14,7 +9,7 @@\n       *cdkVirtualFor=\"let d of graphData$ | async; let i = index\"\n       [ngStyle]=\"d.style\"\n       [class.selected]=\"i >= startFrameIndex && i <= endFrameIndex\"\n-      (click)=\"selectFrame.emit(i)\"\n+      (click)=\"handleFrameSelection(i)\"\n     ></div>\n   </cdk-virtual-scroll-viewport>\n "
        },
        {
            "sha": "653b2c0f5da53525909cbbae2e4fb81082d4792a",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/frame-selector/frame-selector.component.scss",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/a5a942b732b332bc3f846add7fa6f225bad2532d/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Fframe-selector%2Fframe-selector.component.scss",
            "raw_url": "https://github.com/angular/angular/raw/a5a942b732b332bc3f846add7fa6f225bad2532d/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Fframe-selector%2Fframe-selector.component.scss",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Fframe-selector%2Fframe-selector.component.scss?ref=a5a942b732b332bc3f846add7fa6f225bad2532d",
            "patch": "@@ -14,6 +14,9 @@\n     margin: 0px 10px;\n     width: 35px;\n     text-align: center;\n+    overflow: hidden;\n+    text-overflow: ellipsis;\n+    white-space: nowrap;\n   }\n \n   .bar-container {\n@@ -32,7 +35,7 @@\n     }\n \n     .selected {\n-      border: 2px solid #FFC400;\n+      border: 2px solid #ffc400;\n     }\n   }\n "
        },
        {
            "sha": "cc0df7d2124012695b02df26cf110c8891266b18",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/profiler/recording/timeline/frame-selector/frame-selector.component.ts",
            "status": "modified",
            "additions": 27,
            "deletions": 1,
            "changes": 28,
            "blob_url": "https://github.com/angular/angular/blob/a5a942b732b332bc3f846add7fa6f225bad2532d/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Fframe-selector%2Fframe-selector.component.ts",
            "raw_url": "https://github.com/angular/angular/raw/a5a942b732b332bc3f846add7fa6f225bad2532d/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Fframe-selector%2Fframe-selector.component.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fprofiler%2Frecording%2Ftimeline%2Fframe-selector%2Fframe-selector.component.ts?ref=a5a942b732b332bc3f846add7fa6f225bad2532d",
            "patch": "@@ -3,6 +3,7 @@ import { GraphNode } from '../record-formatter/record-formatter';\n import { Observable, Subscription } from 'rxjs';\n import { CdkVirtualScrollViewport } from '@angular/cdk/scrolling';\n import { TabUpdate } from '../../../../tab-update';\n+import { map, tap } from 'rxjs/operators';\n \n const ITEM_WIDTH = 29;\n \n@@ -34,7 +35,7 @@ export class FrameSelectorComponent implements OnInit, OnDestroy {\n   }\n \n   @Output() move = new EventEmitter<number>();\n-  @Output() selectFrame = new EventEmitter<[number, number]>();\n+  @Output() selectFrames = new EventEmitter<{ start: number; end: number }>();\n   @ViewChild(CdkVirtualScrollViewport) viewport: CdkVirtualScrollViewport;\n \n   startFrameIndex: number;\n@@ -47,6 +48,9 @@ export class FrameSelectorComponent implements OnInit, OnDestroy {\n   private _graphData$: Observable<GraphNode[]>;\n   private _graphDataSubscription: Subscription;\n   private _tabUpdateSubscription: Subscription;\n+  private _keydownCallback: (e: KeyboardEvent) => void;\n+  private _keyupCallback: (e: KeyboardEvent) => void;\n+  private _shiftDown = false;\n \n   constructor(private _tabUpdate: TabUpdate) {}\n \n@@ -59,6 +63,8 @@ export class FrameSelectorComponent implements OnInit, OnDestroy {\n         });\n       }\n     });\n+    window.addEventListener('keydown', (this._keydownCallback = (e: KeyboardEvent) => (this._shiftDown = e.shiftKey)));\n+    window.addEventListener('keyup', (this._keyupCallback = (e: KeyboardEvent) => (this._shiftDown = e.shiftKey)));\n   }\n \n   ngOnDestroy(): void {\n@@ -68,6 +74,26 @@ export class FrameSelectorComponent implements OnInit, OnDestroy {\n     if (this._graphDataSubscription) {\n       this._graphDataSubscription.unsubscribe();\n     }\n+    window.removeEventListener('keydown', this._keydownCallback);\n+    window.removeEventListener('keyup', this._keyupCallback);\n+  }\n+\n+  get selectionLabel(): string {\n+    if (this.startFrameIndex !== this.endFrameIndex) {\n+      return `${this.startFrameIndex + 1}-${this.endFrameIndex + 1}`;\n+    }\n+    return `${this.startFrameIndex + 1}`;\n+  }\n+\n+  handleFrameSelection(idx: number): void {\n+    if (!this._shiftDown) {\n+      this.startFrameIndex = this.endFrameIndex = idx;\n+    } else {\n+      const start = Math.min(this.startFrameIndex, idx);\n+      this.endFrameIndex = Math.max(this.startFrameIndex, this.endFrameIndex, idx);\n+      this.startFrameIndex = start;\n+    }\n+    this.selectFrames.emit({ start: this.startFrameIndex, end: this.endFrameIndex });\n   }\n \n   private _ensureVisible(index: number): void {"
        }
    ],
    "stats": {
        "total": 42,
        "additions": 33,
        "deletions": 9
    }
}