{
    "author": "josephperrott",
    "message": "refactor(dev-infra): use conventional-commits-parser for commit parsing (#41286)\n\nUse conventional-commits-parser for parsing commits for validation, this is being done\nin anticipation of relying on this parser for release note creation.  Unifying how commits\nare parsed will provide the most consistency in our tooling.\n\nPR Close #41286",
    "sha": "0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
    "files": [
        {
            "sha": "7ced3089f7fc1d6926b1a7c5b6b1a0f1f3fb9e39",
            "filename": "dev-infra/commit-message/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2FBUILD.bazel?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -11,10 +11,12 @@ ts_library(\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\",\n+        \"@npm//@types/conventional-commits-parser\",\n         \"@npm//@types/inquirer\",\n         \"@npm//@types/node\",\n         \"@npm//@types/shelljs\",\n         \"@npm//@types/yargs\",\n+        \"@npm//conventional-commits-parser\",\n         \"@npm//inquirer\",\n         \"@npm//shelljs\",\n         \"@npm//yargs\","
        },
        {
            "sha": "b1ec355a812fce91625378cc094d1225e0b1bd92",
            "filename": "dev-infra/commit-message/parse.spec.ts",
            "status": "modified",
            "additions": 87,
            "deletions": 15,
            "changes": 102,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fparse.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fparse.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Fparse.spec.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -6,27 +6,40 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {parseCommitMessage, ParsedCommitMessage} from './parse';\n+import {parseCommitMessage} from './parse';\n \n \n const commitValues = {\n   prefix: '',\n   type: 'fix',\n+  npmScope: '',\n   scope: 'changed-area',\n   summary: 'This is a short summary of the change',\n-  body: 'This is a longer description of the change Closes #1',\n+  body: 'This is a longer description of the change',\n+  footer: 'Closes #1',\n };\n \n-function buildCommitMessage(params = {}) {\n-  const {prefix, type, scope, summary, body} = {...commitValues, ...params};\n-  return `${prefix}${type}${scope ? '(' + scope + ')' : ''}: ${summary}\\n\\n${body}`;\n+function buildCommitMessage(params: Partial<typeof commitValues> = {}) {\n+  const {prefix, npmScope, type, scope, summary, body, footer} = {...commitValues, ...params};\n+  const scopeSlug = npmScope ? `${npmScope}/${scope}` : scope;\n+  return `${prefix}${type}${scopeSlug ? '(' + scopeSlug + ')' : ''}: ${summary}\\n\\n${body}\\n\\n${\n+      footer}`;\n }\n \n \n describe('commit message parsing:', () => {\n-  it('parses the scope', () => {\n-    const message = buildCommitMessage();\n-    expect(parseCommitMessage(message).scope).toBe(commitValues.scope);\n+  describe('parses the scope', () => {\n+    it('when only a scope is defined', () => {\n+      const message = buildCommitMessage();\n+      expect(parseCommitMessage(message).scope).toBe(commitValues.scope);\n+      expect(parseCommitMessage(message).npmScope).toBe('');\n+    });\n+\n+    it('when an npmScope and scope are defined', () => {\n+      const message = buildCommitMessage({npmScope: 'myNpmPackage'});\n+      expect(parseCommitMessage(message).scope).toBe(commitValues.scope);\n+      expect(parseCommitMessage(message).npmScope).toBe('myNpmPackage');\n+    });\n   });\n \n   it('parses the type', () => {\n@@ -45,12 +58,6 @@ describe('commit message parsing:', () => {\n     expect(parseCommitMessage(message).body).toBe(commitValues.body);\n   });\n \n-  it('parses the body without Github linking', () => {\n-    const body = 'This has linking\\nCloses #1';\n-    const message = buildCommitMessage({body});\n-    expect(parseCommitMessage(message).bodyWithoutLinking).toBe('This has linking\\n');\n-  });\n-\n   it('parses the subject', () => {\n     const message = buildCommitMessage();\n     expect(parseCommitMessage(message).subject).toBe(commitValues.summary);\n@@ -100,6 +107,71 @@ describe('commit message parsing:', () => {\n     expect(parsedMessage.body)\n         .toBe(\n             'This is line 1 of the actual body.\\n' +\n-            'This is line 2 of the actual body (and it also contains a # but it not a comment).\\n');\n+            'This is line 2 of the actual body (and it also contains a # but it not a comment).');\n+  });\n+\n+  describe('parses breaking change notes', () => {\n+    const summary = 'This breaks things';\n+    const description = 'This is how it breaks things.';\n+\n+    it('when only a summary is provided', () => {\n+      const message = buildCommitMessage({\n+        footer: `BREAKING CHANGE: ${summary}`,\n+      });\n+      const parsedMessage = parseCommitMessage(message);\n+      expect(parsedMessage.breakingChanges[0].text).toBe(summary);\n+      expect(parsedMessage.breakingChanges.length).toBe(1);\n+    });\n+\n+    it('when only a description is provided', () => {\n+      const message = buildCommitMessage({\n+        footer: `BREAKING CHANGE:\\n\\n${description}`,\n+      });\n+      const parsedMessage = parseCommitMessage(message);\n+      expect(parsedMessage.breakingChanges[0].text).toBe(description);\n+      expect(parsedMessage.breakingChanges.length).toBe(1);\n+    });\n+\n+    it('when a summary and description are provied', () => {\n+      const message = buildCommitMessage({\n+        footer: `BREAKING CHANGE: ${summary}\\n\\n${description}`,\n+      });\n+      const parsedMessage = parseCommitMessage(message);\n+      expect(parsedMessage.breakingChanges[0].text).toBe(`${summary}\\n\\n${description}`);\n+      expect(parsedMessage.breakingChanges.length).toBe(1);\n+    });\n+  });\n+\n+  describe('parses deprecation notes', () => {\n+    const summary = 'This will break things later';\n+    const description = 'This is a long winded explanation of why it \\nwill break things later.';\n+\n+\n+    it('when only a summary is provided', () => {\n+      const message = buildCommitMessage({\n+        footer: `DEPRECATED: ${summary}`,\n+      });\n+      const parsedMessage = parseCommitMessage(message);\n+      expect(parsedMessage.deprecations[0].text).toBe(summary);\n+      expect(parsedMessage.deprecations.length).toBe(1);\n+    });\n+\n+    it('when only a description is provided', () => {\n+      const message = buildCommitMessage({\n+        footer: `DEPRECATED:\\n\\n${description}`,\n+      });\n+      const parsedMessage = parseCommitMessage(message);\n+      expect(parsedMessage.deprecations[0].text).toBe(description);\n+      expect(parsedMessage.deprecations.length).toBe(1);\n+    });\n+\n+    it('when a summary and description are provied', () => {\n+      const message = buildCommitMessage({\n+        footer: `DEPRECATED: ${summary}\\n\\n${description}`,\n+      });\n+      const parsedMessage = parseCommitMessage(message);\n+      expect(parsedMessage.deprecations[0].text).toBe(`${summary}\\n\\n${description}`);\n+      expect(parsedMessage.deprecations.length).toBe(1);\n+    });\n   });\n });"
        },
        {
            "sha": "365b7492b0952642966d4cd9d33b3657e8dfd094",
            "filename": "dev-infra/commit-message/parse.ts",
            "status": "modified",
            "additions": 96,
            "deletions": 47,
            "changes": 143,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fparse.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fparse.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Fparse.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -6,80 +6,129 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n+import {Commit as ParsedCommit, Options, sync as parse} from 'conventional-commits-parser';\n+\n import {exec} from '../utils/shelljs';\n \n-/** A parsed commit message. */\n-export interface ParsedCommitMessage {\n+\n+/** A parsed commit, containing the information needed to validate the commit. */\n+export interface Commit {\n+  /** The full raw text of the commit. */\n+  fullText: string;\n+  /** The header line of the commit, will be used in the changelog entries. */\n   header: string;\n+  /** The full body of the commit, not including the footer. */\n   body: string;\n-  bodyWithoutLinking: string;\n+  /** The footer of the commit, containing issue references and note sections. */\n+  footer: string;\n+  /** A list of the references to other issues made throughout the commit message. */\n+  references: ParsedCommit.Reference[];\n+  /** The type of the commit message. */\n   type: string;\n+  /** The scope of the commit message. */\n   scope: string;\n+  /** The npm scope of the commit message. */\n+  npmScope: string;\n+  /** The subject of the commit message. */\n   subject: string;\n+  /** A list of breaking change notes in the commit message. */\n+  breakingChanges: ParsedCommit.Note[];\n+  /** A list of deprecation notes in the commit message. */\n+  deprecations: ParsedCommit.Note[];\n+  /** Whether the commit is a fixup commit. */\n   isFixup: boolean;\n+  /** Whether the commit is a squash commit. */\n   isSquash: boolean;\n+  /** Whether the commit is a revert commit. */\n   isRevert: boolean;\n }\n \n+/** Markers used to denote the start of a note section in a commit. */\n+enum NoteSections {\n+  BREAKING_CHANGE = 'BREAKING CHANGE',\n+  DEPRECATED = 'DEPRECATED',\n+}\n /** Regex determining if a commit is a fixup. */\n const FIXUP_PREFIX_RE = /^fixup! /i;\n-/** Regex finding all github keyword links. */\n-const GITHUB_LINKING_RE = /((closed?s?)|(fix(es)?(ed)?)|(resolved?s?))\\s\\#(\\d+)/ig;\n /** Regex determining if a commit is a squash. */\n const SQUASH_PREFIX_RE = /^squash! /i;\n /** Regex determining if a commit is a revert. */\n const REVERT_PREFIX_RE = /^revert:? /i;\n-/** Regex determining the scope of a commit if provided. */\n-const TYPE_SCOPE_RE = /^(\\w+)(?:\\(([^)]+)\\))?\\:\\s(.+)$/;\n-/** Regex determining the entire header line of the commit. */\n-const COMMIT_HEADER_RE = /^(.*)/i;\n-/** Regex determining the body of the commit. */\n-const COMMIT_BODY_RE = /^.*\\n\\n([\\s\\S]*)$/;\n+/**\n+ * Regex pattern for parsing the header line of a commit.\n+ *\n+ * Several groups are being matched to be used in the parsed commit object, being mapped to the\n+ * `headerCorrespondence` object.\n+ *\n+ * The pattern can be broken down into component parts:\n+ * - `(\\w+)` - a capturing group discovering the type of the commit.\n+ * - `(?:\\((?:([^/]+)\\/)?([^)]+)\\))?` - a pair of capturing groups to capture the scope and,\n+ * optionally the npmScope of the commit.\n+ * - `(.*)` - a capturing group discovering the subject of the commit.\n+ */\n+const headerPattern = /^(\\w+)(?:\\((?:([^/]+)\\/)?([^)]+)\\))?: (.*)$/;\n+/**\n+ * The property names used for the values extracted from the header via the `headerPattern` regex.\n+ */\n+const headerCorrespondence = ['type', 'npmScope', 'scope', 'subject'];\n+/**\n+ * Configuration options for the commit parser.\n+ *\n+ * NOTE: An extended type from `Options` must be used because the current\n+ * @types/conventional-commits-parser version does not include the `notesPattern` field.\n+ */\n+const parseOptions: Options&{notesPattern: (keywords: string) => RegExp} = {\n+  commentChar: '#',\n+  headerPattern,\n+  headerCorrespondence,\n+  noteKeywords: [NoteSections.BREAKING_CHANGE, NoteSections.DEPRECATED],\n+  notesPattern: (keywords: string) => new RegExp(`(${keywords})(?:: ?)(.*)`),\n+};\n \n-/** Parse a full commit message into its composite parts. */\n-export function parseCommitMessage(commitMsg: string): ParsedCommitMessage {\n-  // Ignore comments (i.e. lines starting with `#`). Comments are automatically removed by git and\n-  // should not be considered part of the final commit message.\n-  commitMsg = commitMsg.split('\\n').filter(line => !line.startsWith('#')).join('\\n');\n \n-  let header = '';\n-  let body = '';\n-  let bodyWithoutLinking = '';\n-  let type = '';\n-  let scope = '';\n-  let subject = '';\n+/** Parse a full commit message into its composite parts. */\n+export function parseCommitMessage(fullText: string): Commit {\n+  /** The commit message text with the fixup and squash markers stripped out. */\n+  const strippedCommitMsg = fullText.replace(FIXUP_PREFIX_RE, '')\n+                                .replace(SQUASH_PREFIX_RE, '')\n+                                .replace(REVERT_PREFIX_RE, '');\n+  /** The initially parsed commit. */\n+  const commit = parse(strippedCommitMsg, parseOptions);\n+  /** A list of breaking change notes from the commit. */\n+  const breakingChanges: ParsedCommit.Note[] = [];\n+  /** A list of deprecation notes from the commit. */\n+  const deprecations: ParsedCommit.Note[] = [];\n \n-  if (COMMIT_HEADER_RE.test(commitMsg)) {\n-    header = COMMIT_HEADER_RE.exec(commitMsg)![1]\n-                 .replace(FIXUP_PREFIX_RE, '')\n-                 .replace(SQUASH_PREFIX_RE, '');\n-  }\n-  if (COMMIT_BODY_RE.test(commitMsg)) {\n-    body = COMMIT_BODY_RE.exec(commitMsg)![1];\n-    bodyWithoutLinking = body.replace(GITHUB_LINKING_RE, '');\n-  }\n+  // Extract the commit message notes by marked types into their respective lists.\n+  commit.notes.forEach((note: ParsedCommit.Note) => {\n+    if (note.title === NoteSections.BREAKING_CHANGE) {\n+      return breakingChanges.push(note);\n+    }\n+    if (note.title === NoteSections.DEPRECATED) {\n+      return deprecations.push(note);\n+    }\n+  });\n \n-  if (TYPE_SCOPE_RE.test(header)) {\n-    const parsedCommitHeader = TYPE_SCOPE_RE.exec(header)!;\n-    type = parsedCommitHeader[1];\n-    scope = parsedCommitHeader[2];\n-    subject = parsedCommitHeader[3];\n-  }\n   return {\n-    header,\n-    body,\n-    bodyWithoutLinking,\n-    type,\n-    scope,\n-    subject,\n-    isFixup: FIXUP_PREFIX_RE.test(commitMsg),\n-    isSquash: SQUASH_PREFIX_RE.test(commitMsg),\n-    isRevert: REVERT_PREFIX_RE.test(commitMsg),\n+    fullText,\n+    breakingChanges,\n+    deprecations,\n+    body: commit.body || '',\n+    footer: commit.footer || '',\n+    header: commit.header || '',\n+    references: commit.references,\n+    scope: commit.scope || '',\n+    subject: commit.subject || '',\n+    type: commit.type || '',\n+    npmScope: commit.npmScope || '',\n+    isFixup: FIXUP_PREFIX_RE.test(fullText),\n+    isSquash: SQUASH_PREFIX_RE.test(fullText),\n+    isRevert: REVERT_PREFIX_RE.test(fullText),\n   };\n }\n \n /** Retrieve and parse each commit message in a provide range. */\n-export function parseCommitMessagesForRange(range: string): ParsedCommitMessage[] {\n+export function parseCommitMessagesForRange(range: string): Commit[] {\n   /** A random number used as a split point in the git log result. */\n   const randomValueSeparator = `${Math.random()}`;\n   /**"
        },
        {
            "sha": "09e0c8354d660539bbeb121430d1243ab1f04850",
            "filename": "dev-infra/commit-message/restore-commit-message/cli.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Frestore-commit-message%2Fcli.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Frestore-commit-message%2Fcli.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Frestore-commit-message%2Fcli.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -8,7 +8,7 @@\n \n import {Arguments, Argv, CommandModule} from 'yargs';\n \n-import {CommitMsgSource} from '../commit-message-source';\n+import {CommitMsgSource} from './commit-message-source';\n \n import {restoreCommitMessage} from './restore-commit-message';\n "
        },
        {
            "sha": "86a5655fd09b092a372351aa696224f0857ea05f",
            "filename": "dev-infra/commit-message/restore-commit-message/commit-message-draft.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Frestore-commit-message%2Fcommit-message-draft.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Frestore-commit-message%2Fcommit-message-draft.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Frestore-commit-message%2Fcommit-message-draft.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "previous_filename": "dev-infra/commit-message/commit-message-draft.ts"
        },
        {
            "sha": "c8a9640e839edca7313635ece7955762b75da3bd",
            "filename": "dev-infra/commit-message/restore-commit-message/commit-message-source.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Frestore-commit-message%2Fcommit-message-source.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Frestore-commit-message%2Fcommit-message-source.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Frestore-commit-message%2Fcommit-message-source.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "previous_filename": "dev-infra/commit-message/commit-message-source.ts"
        },
        {
            "sha": "d2551732bed80036ad8a2f765c6f4744bac4a2b0",
            "filename": "dev-infra/commit-message/restore-commit-message/restore-commit-message.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Frestore-commit-message%2Frestore-commit-message.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Frestore-commit-message%2Frestore-commit-message.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Frestore-commit-message%2Frestore-commit-message.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -10,8 +10,8 @@ import {writeFileSync} from 'fs';\n \n import {debug, log} from '../../utils/console';\n \n-import {loadCommitMessageDraft} from '../commit-message-draft';\n-import {CommitMsgSource} from '../commit-message-source';\n+import {loadCommitMessageDraft} from './commit-message-draft';\n+import {CommitMsgSource} from './commit-message-source';\n \n /**\n  * Restore the commit message draft to the git to be used as the default commit message."
        },
        {
            "sha": "965b0c6a5c5d96e7f8caf6ae1d71b47a531bbf5d",
            "filename": "dev-infra/commit-message/validate-file/validate-file.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fvalidate-file%2Fvalidate-file.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fvalidate-file%2Fvalidate-file.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Fvalidate-file%2Fvalidate-file.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -11,7 +11,7 @@ import {resolve} from 'path';\n import {getRepoBaseDir} from '../../utils/config';\n import {error, green, info, log, red, yellow} from '../../utils/console';\n \n-import {deleteCommitMessageDraft, saveCommitMessageDraft} from '../commit-message-draft';\n+import {deleteCommitMessageDraft, saveCommitMessageDraft} from '../restore-commit-message/commit-message-draft';\n import {printValidationErrors, validateCommitMessage} from '../validate';\n \n /** Validate commit message at the provided file path. */"
        },
        {
            "sha": "226f5bd6d05beb5d75be297f22f5ebbc506321d1",
            "filename": "dev-infra/commit-message/validate-range/validate-range.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fvalidate-range%2Fvalidate-range.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fvalidate-range%2Fvalidate-range.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Fvalidate-range%2Fvalidate-range.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -6,15 +6,14 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n import {error, info} from '../../utils/console';\n-\n-import {parseCommitMessagesForRange, ParsedCommitMessage} from '../parse';\n+import {Commit, parseCommitMessagesForRange} from '../parse';\n import {printValidationErrors, validateCommitMessage, ValidateCommitMessageOptions} from '../validate';\n \n // Whether the provided commit is a fixup commit.\n-const isNonFixup = (commit: ParsedCommitMessage) => !commit.isFixup;\n+const isNonFixup = (commit: Commit) => !commit.isFixup;\n \n // Extracts commit header (first line of commit message).\n-const extractCommitHeader = (commit: ParsedCommitMessage) => commit.header;\n+const extractCommitHeader = (commit: Commit) => commit.header;\n \n /** Validate all commits in a provided git commit range. */\n export function validateCommitRange(range: string) {"
        },
        {
            "sha": "0aa30c5aa132e8a3d4123c927f194c76115bf766",
            "filename": "dev-infra/commit-message/validate.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 8,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fvalidate.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fcommit-message%2Fvalidate.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Fvalidate.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -5,10 +5,11 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n+\n import {error} from '../utils/console';\n \n import {COMMIT_TYPES, getCommitMessageConfig, ScopeRequirement} from './config';\n-import {parseCommitMessage, ParsedCommitMessage} from './parse';\n+import {Commit, parseCommitMessage} from './parse';\n \n /** Options for commit message validation. */\n export interface ValidateCommitMessageOptions {\n@@ -20,7 +21,7 @@ export interface ValidateCommitMessageOptions {\n export interface ValidateCommitMessageResult {\n   valid: boolean;\n   errors: string[];\n-  commit: ParsedCommitMessage;\n+  commit: Commit;\n }\n \n /** Regex matching a URL for an entire commit body line. */\n@@ -38,16 +39,14 @@ const COMMIT_BODY_BREAKING_CHANGE_RE = /^BREAKING CHANGE(:( |\\n{2}))?/m;\n \n /** Validate a commit message against using the local repo's config. */\n export function validateCommitMessage(\n-    commitMsg: string|ParsedCommitMessage,\n+    commitMsg: string|Commit,\n     options: ValidateCommitMessageOptions = {}): ValidateCommitMessageResult {\n   const config = getCommitMessageConfig().commitMessage;\n   const commit = typeof commitMsg === 'string' ? parseCommitMessage(commitMsg) : commitMsg;\n   const errors: string[] = [];\n \n   /** Perform the validation checks against the parsed commit. */\n   function validateCommitAndCollectErrors() {\n-    // TODO(josephperrott): Remove early return calls when commit message errors are found\n-\n     ////////////////////////////////////\n     // Checking revert, squash, fixup //\n     ////////////////////////////////////\n@@ -133,14 +132,14 @@ export function validateCommitMessage(\n     //////////////////////////\n \n     if (!config.minBodyLengthTypeExcludes?.includes(commit.type) &&\n-        commit.bodyWithoutLinking.trim().length < config.minBodyLength) {\n+        commit.body.trim().length < config.minBodyLength) {\n       errors.push(`The commit message body does not meet the minimum length of ${\n           config.minBodyLength} characters`);\n       return false;\n     }\n \n     const bodyByLine = commit.body.split('\\n');\n-    const lineExceedsMaxLength = bodyByLine.some(line => {\n+    const lineExceedsMaxLength = bodyByLine.some((line: string) => {\n       // Check if any line exceeds the max line length limit. The limit is ignored for\n       // lines that just contain an URL (as these usually cannot be wrapped or shortened).\n       return line.length > config.maxLineLength && !COMMIT_BODY_URL_LINE_RE.test(line);\n@@ -155,7 +154,7 @@ export function validateCommitMessage(\n     // Breaking change\n     // Check if the commit message contains a valid break change description.\n     // https://github.com/angular/angular/blob/88fbc066775ab1a2f6a8c75f933375b46d8fa9a4/CONTRIBUTING.md#commit-message-footer\n-    const hasBreakingChange = COMMIT_BODY_BREAKING_CHANGE_RE.exec(commit.body);\n+    const hasBreakingChange = COMMIT_BODY_BREAKING_CHANGE_RE.exec(commit.fullText);\n     if (hasBreakingChange !== null) {\n       const [, breakingChangeDescription] = hasBreakingChange;\n       if (!breakingChangeDescription) {"
        },
        {
            "sha": "20b77696bfb73dd995a58945d875cb7a2531c8bb",
            "filename": "dev-infra/ng-dev.js",
            "status": "modified",
            "additions": 75,
            "deletions": 47,
            "changes": 122,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -19,6 +19,7 @@ var fetch = _interopDefault(require('node-fetch'));\n var semver = require('semver');\n var multimatch = require('multimatch');\n var yaml = require('yaml');\n+var conventionalCommitsParser = require('conventional-commits-parser');\n var cliProgress = require('cli-progress');\n var os = require('os');\n var minimatch = require('minimatch');\n@@ -1683,56 +1684,84 @@ const COMMIT_TYPES = {\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n+/** Markers used to denote the start of a note section in a commit. */\n+var NoteSections;\n+(function (NoteSections) {\n+    NoteSections[\"BREAKING_CHANGE\"] = \"BREAKING CHANGE\";\n+    NoteSections[\"DEPRECATED\"] = \"DEPRECATED\";\n+})(NoteSections || (NoteSections = {}));\n /** Regex determining if a commit is a fixup. */\n const FIXUP_PREFIX_RE = /^fixup! /i;\n-/** Regex finding all github keyword links. */\n-const GITHUB_LINKING_RE = /((closed?s?)|(fix(es)?(ed)?)|(resolved?s?))\\s\\#(\\d+)/ig;\n /** Regex determining if a commit is a squash. */\n const SQUASH_PREFIX_RE = /^squash! /i;\n /** Regex determining if a commit is a revert. */\n const REVERT_PREFIX_RE = /^revert:? /i;\n-/** Regex determining the scope of a commit if provided. */\n-const TYPE_SCOPE_RE = /^(\\w+)(?:\\(([^)]+)\\))?\\:\\s(.+)$/;\n-/** Regex determining the entire header line of the commit. */\n-const COMMIT_HEADER_RE = /^(.*)/i;\n-/** Regex determining the body of the commit. */\n-const COMMIT_BODY_RE = /^.*\\n\\n([\\s\\S]*)$/;\n+/**\n+ * Regex pattern for parsing the header line of a commit.\n+ *\n+ * Several groups are being matched to be used in the parsed commit object, being mapped to the\n+ * `headerCorrespondence` object.\n+ *\n+ * The pattern can be broken down into component parts:\n+ * - `(\\w+)` - a capturing group discovering the type of the commit.\n+ * - `(?:\\((?:([^/]+)\\/)?([^)]+)\\))?` - a pair of capturing groups to capture the scope and,\n+ * optionally the npmScope of the commit.\n+ * - `(.*)` - a capturing group discovering the subject of the commit.\n+ */\n+const headerPattern = /^(\\w+)(?:\\((?:([^/]+)\\/)?([^)]+)\\))?: (.*)$/;\n+/**\n+ * The property names used for the values extracted from the header via the `headerPattern` regex.\n+ */\n+const headerCorrespondence = ['type', 'npmScope', 'scope', 'subject'];\n+/**\n+ * Configuration options for the commit parser.\n+ *\n+ * NOTE: An extended type from `Options` must be used because the current\n+ * @types/conventional-commits-parser version does not include the `notesPattern` field.\n+ */\n+const parseOptions = {\n+    commentChar: '#',\n+    headerPattern,\n+    headerCorrespondence,\n+    noteKeywords: [NoteSections.BREAKING_CHANGE, NoteSections.DEPRECATED],\n+    notesPattern: (keywords) => new RegExp(`(${keywords})(?:: ?)(.*)`),\n+};\n /** Parse a full commit message into its composite parts. */\n-function parseCommitMessage(commitMsg) {\n-    // Ignore comments (i.e. lines starting with `#`). Comments are automatically removed by git and\n-    // should not be considered part of the final commit message.\n-    commitMsg = commitMsg.split('\\n').filter(line => !line.startsWith('#')).join('\\n');\n-    let header = '';\n-    let body = '';\n-    let bodyWithoutLinking = '';\n-    let type = '';\n-    let scope = '';\n-    let subject = '';\n-    if (COMMIT_HEADER_RE.test(commitMsg)) {\n-        header = COMMIT_HEADER_RE.exec(commitMsg)[1]\n-            .replace(FIXUP_PREFIX_RE, '')\n-            .replace(SQUASH_PREFIX_RE, '');\n-    }\n-    if (COMMIT_BODY_RE.test(commitMsg)) {\n-        body = COMMIT_BODY_RE.exec(commitMsg)[1];\n-        bodyWithoutLinking = body.replace(GITHUB_LINKING_RE, '');\n-    }\n-    if (TYPE_SCOPE_RE.test(header)) {\n-        const parsedCommitHeader = TYPE_SCOPE_RE.exec(header);\n-        type = parsedCommitHeader[1];\n-        scope = parsedCommitHeader[2];\n-        subject = parsedCommitHeader[3];\n-    }\n+function parseCommitMessage(fullText) {\n+    /** The commit message text with the fixup and squash markers stripped out. */\n+    const strippedCommitMsg = fullText.replace(FIXUP_PREFIX_RE, '')\n+        .replace(SQUASH_PREFIX_RE, '')\n+        .replace(REVERT_PREFIX_RE, '');\n+    /** The initially parsed commit. */\n+    const commit = conventionalCommitsParser.sync(strippedCommitMsg, parseOptions);\n+    /** A list of breaking change notes from the commit. */\n+    const breakingChanges = [];\n+    /** A list of deprecation notes from the commit. */\n+    const deprecations = [];\n+    // Extract the commit message notes by marked types into their respective lists.\n+    commit.notes.forEach((note) => {\n+        if (note.title === NoteSections.BREAKING_CHANGE) {\n+            return breakingChanges.push(note);\n+        }\n+        if (note.title === NoteSections.DEPRECATED) {\n+            return deprecations.push(note);\n+        }\n+    });\n     return {\n-        header,\n-        body,\n-        bodyWithoutLinking,\n-        type,\n-        scope,\n-        subject,\n-        isFixup: FIXUP_PREFIX_RE.test(commitMsg),\n-        isSquash: SQUASH_PREFIX_RE.test(commitMsg),\n-        isRevert: REVERT_PREFIX_RE.test(commitMsg),\n+        fullText,\n+        breakingChanges,\n+        deprecations,\n+        body: commit.body || '',\n+        footer: commit.footer || '',\n+        header: commit.header || '',\n+        references: commit.references,\n+        scope: commit.scope || '',\n+        subject: commit.subject || '',\n+        type: commit.type || '',\n+        npmScope: commit.npmScope || '',\n+        isFixup: FIXUP_PREFIX_RE.test(fullText),\n+        isSquash: SQUASH_PREFIX_RE.test(fullText),\n+        isRevert: REVERT_PREFIX_RE.test(fullText),\n     };\n }\n /** Retrieve and parse each commit message in a provide range. */\n@@ -1786,11 +1815,10 @@ function validateCommitMessage(commitMsg, options = {}) {\n     const errors = [];\n     /** Perform the validation checks against the parsed commit. */\n     function validateCommitAndCollectErrors() {\n-        // TODO(josephperrott): Remove early return calls when commit message errors are found\n-        var _a;\n         ////////////////////////////////////\n         // Checking revert, squash, fixup //\n         ////////////////////////////////////\n+        var _a;\n         // All revert commits are considered valid.\n         if (commit.isRevert) {\n             return true;\n@@ -1854,12 +1882,12 @@ function validateCommitMessage(commitMsg, options = {}) {\n         // Checking commit body //\n         //////////////////////////\n         if (!((_a = config.minBodyLengthTypeExcludes) === null || _a === void 0 ? void 0 : _a.includes(commit.type)) &&\n-            commit.bodyWithoutLinking.trim().length < config.minBodyLength) {\n+            commit.body.trim().length < config.minBodyLength) {\n             errors.push(`The commit message body does not meet the minimum length of ${config.minBodyLength} characters`);\n             return false;\n         }\n         const bodyByLine = commit.body.split('\\n');\n-        const lineExceedsMaxLength = bodyByLine.some(line => {\n+        const lineExceedsMaxLength = bodyByLine.some((line) => {\n             // Check if any line exceeds the max line length limit. The limit is ignored for\n             // lines that just contain an URL (as these usually cannot be wrapped or shortened).\n             return line.length > config.maxLineLength && !COMMIT_BODY_URL_LINE_RE.test(line);\n@@ -1871,7 +1899,7 @@ function validateCommitMessage(commitMsg, options = {}) {\n         // Breaking change\n         // Check if the commit message contains a valid break change description.\n         // https://github.com/angular/angular/blob/88fbc066775ab1a2f6a8c75f933375b46d8fa9a4/CONTRIBUTING.md#commit-message-footer\n-        const hasBreakingChange = COMMIT_BODY_BREAKING_CHANGE_RE.exec(commit.body);\n+        const hasBreakingChange = COMMIT_BODY_BREAKING_CHANGE_RE.exec(commit.fullText);\n         if (hasBreakingChange !== null) {\n             const [, breakingChangeDescription] = hasBreakingChange;\n             if (!breakingChangeDescription) {"
        },
        {
            "sha": "13089d1cbfbee38a3790ac6217f26f06611977de",
            "filename": "dev-infra/pr/rebase/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fpr%2Frebase%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fpr%2Frebase%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Frebase%2FBUILD.bazel?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -11,9 +11,11 @@ ts_library(\n     deps = [\n         \"//dev-infra/commit-message\",\n         \"//dev-infra/utils\",\n+        \"@npm//@types/conventional-commits-parser\",\n         \"@npm//@types/inquirer\",\n         \"@npm//@types/node\",\n         \"@npm//@types/yargs\",\n+        \"@npm//conventional-commits-parser\",\n         \"@npm//inquirer\",\n         \"@npm//typed-graphqlify\",\n         \"@npm//yargs\","
        },
        {
            "sha": "7fbe88517d6783cc9937ae3b0515ab37e1717860",
            "filename": "dev-infra/pr/rebase/index.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fpr%2Frebase%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Fpr%2Frebase%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Frebase%2Findex.ts?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -7,8 +7,8 @@\n  */\n \n import {types as graphQLTypes} from 'typed-graphqlify';\n-import {parseCommitMessagesForRange, ParsedCommitMessage} from '../../commit-message/parse';\n \n+import {Commit, parseCommitMessagesForRange} from '../../commit-message/parse';\n import {getConfig, NgDevConfig} from '../../utils/config';\n import {error, info, promptConfirm} from '../../utils/console';\n import {addTokenToGitHttpsUrl} from '../../utils/git/github-urls';\n@@ -95,8 +95,7 @@ export async function rebasePr(\n \n     const commits = parseCommitMessagesForRange(`${commonAncestorSha}..HEAD`);\n \n-    let squashFixups =\n-        commits.filter((commit: ParsedCommitMessage) => commit.isFixup).length === 0 ?\n+    let squashFixups = commits.filter((commit: Commit) => commit.isFixup).length === 0 ?\n         false :\n         await promptConfirm(\n             `PR #${prNumber} contains fixup commits, would you like to squash them during rebase?`,"
        },
        {
            "sha": "5a283b205a7c506a4c48b359e03c7792eefc2e4b",
            "filename": "dev-infra/tmpl-package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Ftmpl-package.json",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/dev-infra%2Ftmpl-package.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Ftmpl-package.json?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -16,6 +16,7 @@\n     \"brotli\": \"<from-root>\",\n     \"chalk\": \"<from-root>\",\n     \"cli-progress\": \"<from-root>\",\n+    \"conventional-commits-parser\": \"<from-root>\",\n     \"glob\": \"<from-root>\",\n     \"inquirer\": \"<from-root>\",\n     \"minimatch\": \"<from-root>\","
        },
        {
            "sha": "f247c1de533b29178552682e2729743f2c6cf229",
            "filename": "package.json",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/package.json",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/package.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/package.json?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -48,6 +48,7 @@\n     \"@babel/cli\": \"^7.8.4\",\n     \"@babel/core\": \"^7.8.6\",\n     \"@babel/generator\": \"^7.8.6\",\n+    \"@babel/parser\": \"^7.0.0\",\n     \"@babel/preset-env\": \"^7.10.2\",\n     \"@babel/template\": \"^7.8.6\",\n     \"@babel/traverse\": \"^7.8.6\",\n@@ -61,7 +62,6 @@\n     \"@microsoft/api-extractor\": \"7.7.11\",\n     \"@octokit/rest\": \"16.28.7\",\n     \"@octokit/types\": \"^5.0.1\",\n-    \"tmp\": \"0.0.33\",\n     \"@schematics/angular\": \"11.0.0-rc.1\",\n     \"@types/angular\": \"^1.6.47\",\n     \"@types/babel__core\": \"^7.1.6\",\n@@ -73,14 +73,13 @@\n     \"@types/chai\": \"^4.1.2\",\n     \"@types/convert-source-map\": \"^1.5.1\",\n     \"@types/diff\": \"^3.5.1\",\n+    \"@types/events\": \"3.0.0\",\n     \"@types/fs-extra\": \"4.0.2\",\n     \"@types/hammerjs\": \"2.0.35\",\n     \"@types/inquirer\": \"^7.3.0\",\n     \"@types/jasmine\": \"3.5.10\",\n     \"@types/jasmine-ajax\": \"^3.3.1\",\n     \"@types/jasminewd2\": \"^2.0.8\",\n-    \"@babel/parser\": \"^7.0.0\",\n-    \"@types/events\": \"3.0.0\",\n     \"@types/minimist\": \"^1.2.0\",\n     \"@types/multimatch\": \"^4.0.0\",\n     \"@types/node\": \"^12.11.1\",\n@@ -151,6 +150,7 @@\n     \"sourcemap-codec\": \"^1.4.8\",\n     \"systemjs\": \"0.18.10\",\n     \"terser\": \"^4.4.0\",\n+    \"tmp\": \"0.0.33\",\n     \"tsickle\": \"0.38.1\",\n     \"tslib\": \"^2.1.0\",\n     \"tslint\": \"6.1.3\",\n@@ -167,6 +167,7 @@\n     \"@bazel/ibazel\": \"^0.12.3\",\n     \"@octokit/graphql\": \"^4.3.1\",\n     \"@types/cli-progress\": \"^3.4.2\",\n+    \"@types/conventional-commits-parser\": \"^3.0.1\",\n     \"@types/minimist\": \"^1.2.0\",\n     \"@yarnpkg/lockfile\": \"^1.1.0\",\n     \"browserstacktunnel-wrapper\": \"^2.0.4\",\n@@ -177,6 +178,7 @@\n     \"cldrjs\": \"0.5.0\",\n     \"cli-progress\": \"^3.7.0\",\n     \"conventional-changelog\": \"^2.0.3\",\n+    \"conventional-commits-parser\": \"^3.2.1\",\n     \"entities\": \"1.1.1\",\n     \"firebase-tools\": \"^7.11.0\",\n     \"firefox-profile\": \"1.0.3\","
        },
        {
            "sha": "b6ca40aff32f4872f1832748b7fef18bfebd67c9",
            "filename": "yarn.lock",
            "status": "modified",
            "additions": 20,
            "deletions": 0,
            "changes": 20,
            "blob_url": "https://github.com/angular/angular/blob/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/yarn.lock",
            "raw_url": "https://github.com/angular/angular/raw/0516fbb180e4b1cc5faa4af8a69dd333dbd86a73/yarn.lock",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/yarn.lock?ref=0516fbb180e4b1cc5faa4af8a69dd333dbd86a73",
            "patch": "@@ -2447,6 +2447,13 @@\n   resolved \"https://registry.yarnpkg.com/@types/color-name/-/color-name-1.1.1.tgz#1c1261bbeaa10a8055bbc5d8ab84b7b2afc846a0\"\n   integrity sha512-rr+OQyAjxze7GgWrSaJwydHStIhHq2lvY3BOC2Mj7KnzI7XK0Uw1TOOdI9lDoajEbSWLiYgoo4f1R51erQfhPQ==\n \n+\"@types/conventional-commits-parser@^3.0.1\":\n+  version \"3.0.1\"\n+  resolved \"https://registry.yarnpkg.com/@types/conventional-commits-parser/-/conventional-commits-parser-3.0.1.tgz#1a4796a0ae2bf33b41ea49f55e27ccbdb29cce5e\"\n+  integrity sha512-xkKomW6PqJS0rzFPPQSzKwbKIRqAGjYa1aWWkoT14YYodXyEpG4ok4H1US3olqGBxejz7EeBfT3fTJ3hUOiUkQ==\n+  dependencies:\n+    \"@types/node\" \"*\"\n+\n \"@types/convert-source-map@^1.5.1\":\n   version \"1.5.1\"\n   resolved \"https://registry.yarnpkg.com/@types/convert-source-map/-/convert-source-map-1.5.1.tgz#d4d180dd6adc5cb68ad99bd56e03d637881f4616\"\n@@ -5313,6 +5320,19 @@ conventional-commits-parser@^3.2.0:\n     through2 \"^4.0.0\"\n     trim-off-newlines \"^1.0.0\"\n \n+conventional-commits-parser@^3.2.1:\n+  version \"3.2.1\"\n+  resolved \"https://registry.yarnpkg.com/conventional-commits-parser/-/conventional-commits-parser-3.2.1.tgz#ba44f0b3b6588da2ee9fd8da508ebff50d116ce2\"\n+  integrity sha512-OG9kQtmMZBJD/32NEw5IhN5+HnBqVjy03eC+I71I0oQRFA5rOgA4OtPOYG7mz1GkCfCNxn3gKIX8EiHJYuf1cA==\n+  dependencies:\n+    JSONStream \"^1.0.4\"\n+    is-text-path \"^1.0.1\"\n+    lodash \"^4.17.15\"\n+    meow \"^8.0.0\"\n+    split2 \"^3.0.0\"\n+    through2 \"^4.0.0\"\n+    trim-off-newlines \"^1.0.0\"\n+\n convert-source-map@1.7.0, convert-source-map@^1.1.0, convert-source-map@^1.5.0, convert-source-map@^1.5.1, convert-source-map@^1.6.0, convert-source-map@^1.7.0:\n   version \"1.7.0\"\n   resolved \"https://registry.yarnpkg.com/convert-source-map/-/convert-source-map-1.7.0.tgz#17a2cb882d7f77d3490585e2ce6c524424a3a442\""
        }
    ],
    "stats": {
        "total": 435,
        "additions": 304,
        "deletions": 131
    }
}