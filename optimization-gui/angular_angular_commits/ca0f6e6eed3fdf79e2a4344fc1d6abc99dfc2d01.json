{
    "author": "petebacondarwin",
    "message": "fix(common): parse `YYYY` strings as UTC dates (#40629)\n\nIn b6cd38ff055f003f92fff4c3e27d165fb4437057 we fixed the DatePipe so\nthat when it parsed date strings that looked like `YYYY-MM` it created a UTC\ndate that was not affected by the local timezone of the JavaScript engine.\n\nThis commit does the same for date strings of the form `YYYY`.\n\n(Note that the previous commit, mentioned above, attempted to fix this case\ntoo but the test was not actually checking the correct input string.)\n\nFixes #33944\n\nPR Close #40620\n\nPR Close #40629",
    "sha": "ca0f6e6eed3fdf79e2a4344fc1d6abc99dfc2d01",
    "files": [
        {
            "sha": "ebeefaedb53b47720ab9aae459c242fb26bfe05c",
            "filename": "packages/common/src/i18n/format_date.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/ca0f6e6eed3fdf79e2a4344fc1d6abc99dfc2d01/packages%2Fcommon%2Fsrc%2Fi18n%2Fformat_date.ts",
            "raw_url": "https://github.com/angular/angular/raw/ca0f6e6eed3fdf79e2a4344fc1d6abc99dfc2d01/packages%2Fcommon%2Fsrc%2Fi18n%2Fformat_date.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fsrc%2Fi18n%2Fformat_date.ts?ref=ca0f6e6eed3fdf79e2a4344fc1d6abc99dfc2d01",
            "patch": "@@ -711,13 +711,6 @@ export function toDate(value: string|number|Date): Date {\n   if (typeof value === 'string') {\n     value = value.trim();\n \n-    const parsedNb = parseFloat(value);\n-\n-    // any string that only contains numbers, like \"1234\" but not like \"1234hello\"\n-    if (!isNaN(value as any - parsedNb)) {\n-      return new Date(parsedNb);\n-    }\n-\n     if (/^(\\d{4}(-\\d{1,2}(-\\d{1,2})?)?)$/.test(value)) {\n       /* For ISO Strings without time the day, month and year must be extracted from the ISO String\n       before Date creation to avoid time offset and errors in the new Date.\n@@ -730,6 +723,13 @@ export function toDate(value: string|number|Date): Date {\n       return new Date(y, m - 1, d);\n     }\n \n+    const parsedNb = parseFloat(value);\n+\n+    // any string that only contains numbers, like \"1234\" but not like \"1234hello\"\n+    if (!isNaN(value as any - parsedNb)) {\n+      return new Date(parsedNb);\n+    }\n+\n     let match: RegExpMatchArray|null;\n     if (match = value.match(ISO8601_DATE_REGEX)) {\n       return isoStringToDate(match);"
        },
        {
            "sha": "a08ce87ddc9b9d9dde09c48454fe4e941f4def23",
            "filename": "packages/common/test/i18n/format_date_spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/ca0f6e6eed3fdf79e2a4344fc1d6abc99dfc2d01/packages%2Fcommon%2Ftest%2Fi18n%2Fformat_date_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/ca0f6e6eed3fdf79e2a4344fc1d6abc99dfc2d01/packages%2Fcommon%2Ftest%2Fi18n%2Fformat_date_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Ftest%2Fi18n%2Fformat_date_spec.ts?ref=ca0f6e6eed3fdf79e2a4344fc1d6abc99dfc2d01",
            "patch": "@@ -61,7 +61,7 @@ describe('Format date', () => {\n   describe('formatDate', () => {\n     const isoStringWithoutTime = '2015-01-01';\n     const isoStringWithoutTimeOrDate = '2015-01';\n-    const isoStringWithoutTimeOrDateOrMonth = '2015-01';\n+    const isoStringWithoutTimeOrDateOrMonth = '2015';\n     const defaultFormat = 'mediumDate';\n     let date: Date;\n "
        }
    ],
    "stats": {
        "total": 16,
        "additions": 8,
        "deletions": 8
    }
}