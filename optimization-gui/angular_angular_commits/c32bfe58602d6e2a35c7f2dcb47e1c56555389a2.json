{
    "author": "petebacondarwin",
    "message": "refactor(compiler): remove cyclic dependencies (#43129)\n\nThis commit removes 9 cycles in the dependency graph of the compiler code.\n\nPR Close #43129",
    "sha": "c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
    "files": [
        {
            "sha": "51e1575bf05d0d76c1d5173fd57867b766693d22",
            "filename": "goldens/circular-deps/packages.json",
            "status": "modified",
            "additions": 0,
            "deletions": 54,
            "changes": 54,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/goldens%2Fcircular-deps%2Fpackages.json",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/goldens%2Fcircular-deps%2Fpackages.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fcircular-deps%2Fpackages.json?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -41,55 +41,6 @@\n     \"packages/compiler-cli/src/ngtsc/scope/src/component_scope.ts\",\n     \"packages/compiler-cli/src/ngtsc/scope/src/local.ts\"\n   ],\n-  [\n-    \"packages/compiler/src/compile_metadata.ts\",\n-    \"packages/compiler/src/lifecycle_reflector.ts\",\n-    \"packages/compiler/src/compile_reflector.ts\",\n-    \"packages/compiler/src/output/output_ast.ts\",\n-    \"packages/compiler/src/parse_util.ts\"\n-  ],\n-  [\n-    \"packages/compiler/src/compile_metadata.ts\",\n-    \"packages/compiler/src/ml_parser/parser.ts\",\n-    \"packages/compiler/src/ml_parser/ast.ts\",\n-    \"packages/compiler/src/i18n/i18n_ast.ts\",\n-    \"packages/compiler/src/parse_util.ts\"\n-  ],\n-  [\n-    \"packages/compiler/src/compile_metadata.ts\",\n-    \"packages/compiler/src/ml_parser/parser.ts\",\n-    \"packages/compiler/src/ml_parser/ast.ts\",\n-    \"packages/compiler/src/parse_util.ts\"\n-  ],\n-  [\n-    \"packages/compiler/src/compile_metadata.ts\",\n-    \"packages/compiler/src/ml_parser/parser.ts\",\n-    \"packages/compiler/src/ml_parser/lexer.ts\",\n-    \"packages/compiler/src/parse_util.ts\"\n-  ],\n-  [\n-    \"packages/compiler/src/compile_metadata.ts\",\n-    \"packages/compiler/src/ml_parser/parser.ts\",\n-    \"packages/compiler/src/parse_util.ts\"\n-  ],\n-  [\n-    \"packages/compiler/src/compile_metadata.ts\",\n-    \"packages/compiler/src/util.ts\",\n-    \"packages/compiler/src/constant_pool.ts\",\n-    \"packages/compiler/src/output/output_ast.ts\",\n-    \"packages/compiler/src/parse_util.ts\"\n-  ],\n-  [\n-    \"packages/compiler/src/compile_metadata.ts\",\n-    \"packages/compiler/src/util.ts\",\n-    \"packages/compiler/src/output/output_ast.ts\",\n-    \"packages/compiler/src/parse_util.ts\"\n-  ],\n-  [\n-    \"packages/compiler/src/compile_metadata.ts\",\n-    \"packages/compiler/src/util.ts\",\n-    \"packages/compiler/src/parse_util.ts\"\n-  ],\n   [\n     \"packages/compiler/src/output/output_ast.ts\",\n     \"packages/compiler/src/render3/view/i18n/meta.ts\"\n@@ -99,11 +50,6 @@\n     \"packages/compiler/src/render3/view/i18n/meta.ts\",\n     \"packages/compiler/src/render3/view/i18n/util.ts\"\n   ],\n-  [\n-    \"packages/compiler/src/render3/r3_factory.ts\",\n-    \"packages/compiler/src/render3/view/util.ts\",\n-    \"packages/compiler/src/render3/view/api.ts\"\n-  ],\n   [\n     \"packages/compiler/src/render3/view/styling_builder.ts\",\n     \"packages/compiler/src/render3/view/template.ts\""
        },
        {
            "sha": "f70fd868e929238ecc1c3cc573829776eae9e08a",
            "filename": "packages/compiler/src/aot/compiler.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,9 +6,9 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveMetadata, CompileIdentifierMetadata, CompileInjectableMetadata, CompileNgModuleMetadata, CompilePipeMetadata, CompilePipeSummary, CompileProviderMetadata, CompileShallowModuleMetadata, CompileStylesheetMetadata, CompileTypeMetadata, CompileTypeSummary, componentFactoryName, flatten, identifierName, templateSourceUrl} from '../compile_metadata';\n+import {CompileDirectiveMetadata, CompileInjectableMetadata, CompileNgModuleMetadata, CompilePipeMetadata, CompilePipeSummary, CompileProviderMetadata, CompileShallowModuleMetadata, CompileStylesheetMetadata, CompileTypeMetadata, CompileTypeSummary, componentFactoryName, flatten, templateSourceUrl} from '../compile_metadata';\n import {CompilerConfig} from '../config';\n-import {ConstantPool} from '../constant_pool';\n+import {ConstantPool, OutputContext} from '../constant_pool';\n import {ViewEncapsulation} from '../core';\n import {MessageBundle} from '../i18n/message_bundle';\n import {createTokenForExternalReference, Identifiers} from '../identifiers';\n@@ -19,12 +19,12 @@ import {InterpolationConfig} from '../ml_parser/interpolation_config';\n import {NgModuleCompiler} from '../ng_module_compiler';\n import {OutputEmitter} from '../output/abstract_emitter';\n import * as o from '../output/output_ast';\n-import {ParseError} from '../parse_util';\n+import {CompileIdentifierMetadata, identifierName, ParseError, syntaxError} from '../parse_util';\n import {CompiledStylesheet, StyleCompiler} from '../style_compiler';\n import {SummaryResolver} from '../summary_resolver';\n import {TemplateAst} from '../template_parser/template_ast';\n import {TemplateParser} from '../template_parser/template_parser';\n-import {newArray, OutputContext, syntaxError, ValueVisitor, visitValue} from '../util';\n+import {newArray, ValueVisitor, visitValue} from '../util';\n import {TypeCheckCompiler} from '../view_compiler/type_check_compiler';\n import {ViewCompiler, ViewCompileResult} from '../view_compiler/view_compiler';\n "
        },
        {
            "sha": "7743555b169fb84bbc708232214b1ee5367a027d",
            "filename": "packages/compiler/src/aot/compiler_factory.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler_factory.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler_factory.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fcompiler_factory.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -19,12 +19,12 @@ import {HtmlParser} from '../ml_parser/html_parser';\n import {NgModuleCompiler} from '../ng_module_compiler';\n import {NgModuleResolver} from '../ng_module_resolver';\n import {TypeScriptEmitter} from '../output/ts_emitter';\n+import {syntaxError} from '../parse_util';\n import {PipeResolver} from '../pipe_resolver';\n import {DomElementSchemaRegistry} from '../schema/dom_element_schema_registry';\n import {StyleCompiler} from '../style_compiler';\n import {TemplateParser} from '../template_parser/template_parser';\n import {UrlResolver} from '../url_resolver';\n-import {syntaxError} from '../util';\n import {TypeCheckCompiler} from '../view_compiler/type_check_compiler';\n import {ViewCompiler} from '../view_compiler/view_compiler';\n "
        },
        {
            "sha": "7008329a08b4760d034a82c62f33ba641bdf4fc0",
            "filename": "packages/compiler/src/aot/formatted_error.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fformatted_error.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fformatted_error.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fformatted_error.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {syntaxError} from '../util';\n+import {syntaxError} from '../parse_util';\n \n export interface Position {\n   fileName: string;"
        },
        {
            "sha": "e2e7b1e4f1852cc5ea1d7a72f2cb6bcd10dbd2bc",
            "filename": "packages/compiler/src/aot/static_reflector.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fstatic_reflector.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fstatic_reflector.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fstatic_reflector.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -10,8 +10,8 @@ import {CompileSummaryKind} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n import {createAttribute, createComponent, createContentChild, createContentChildren, createDirective, createHost, createHostBinding, createHostListener, createInject, createInjectable, createInput, createNgModule, createOptional, createOutput, createPipe, createSelf, createSkipSelf, createViewChild, createViewChildren, MetadataFactory} from '../core';\n import * as o from '../output/output_ast';\n+import {syntaxError} from '../parse_util';\n import {SummaryResolver} from '../summary_resolver';\n-import {syntaxError} from '../util';\n \n import {formattedError, FormattedMessageChain} from './formatted_error';\n import {StaticSymbol} from './static_symbol';"
        },
        {
            "sha": "0587276e08dc2f0e9f52457d560e7393607632b2",
            "filename": "packages/compiler/src/aot/summary_serializer.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fsummary_serializer.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Faot%2Fsummary_serializer.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Faot%2Fsummary_serializer.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,9 +6,10 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n import {CompileDirectiveMetadata, CompileDirectiveSummary, CompileNgModuleMetadata, CompileNgModuleSummary, CompilePipeMetadata, CompileProviderMetadata, CompileSummaryKind, CompileTypeMetadata, CompileTypeSummary} from '../compile_metadata';\n+import {OutputContext} from '../constant_pool';\n import * as o from '../output/output_ast';\n import {Summary, SummaryResolver} from '../summary_resolver';\n-import {OutputContext, ValueTransformer, ValueVisitor, visitValue} from '../util';\n+import {ValueTransformer, ValueVisitor, visitValue} from '../util';\n \n import {StaticSymbol, StaticSymbolCache} from './static_symbol';\n import {ResolvedStaticSymbol, StaticSymbolResolver, unwrapResolvedMetadata} from './static_symbol_resolver';"
        },
        {
            "sha": "f24046ab4dc7f6d786a188eb4943162601673e45",
            "filename": "packages/compiler/src/compile_metadata.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 48,
            "changes": 50,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fcompile_metadata.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fcompile_metadata.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fcompile_metadata.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -10,57 +10,15 @@ import {StaticSymbol} from './aot/static_symbol';\n import {ChangeDetectionStrategy, SchemaMetadata, Type, ViewEncapsulation} from './core';\n import {LifecycleHooks} from './lifecycle_reflector';\n import {ParseTreeResult as HtmlParseTreeResult} from './ml_parser/parser';\n-import {splitAtColon, stringify} from './util';\n+import {CompileIdentifierMetadata, identifierName, sanitizeIdentifier} from './parse_util';\n+import {splitAtColon} from './util';\n \n // group 0: \"[prop] or (event) or @trigger\"\n // group 1: \"prop\" from \"[prop]\"\n // group 2: \"event\" from \"(event)\"\n // group 3: \"@trigger\" from \"@trigger\"\n const HOST_REG_EXP = /^(?:(?:\\[([^\\]]+)\\])|(?:\\(([^\\)]+)\\)))|(\\@[-\\w]+)$/;\n \n-export function sanitizeIdentifier(name: string): string {\n-  return name.replace(/\\W/g, '_');\n-}\n-\n-let _anonymousTypeIndex = 0;\n-\n-export function identifierName(compileIdentifier: CompileIdentifierMetadata|null|undefined): string|\n-    null {\n-  if (!compileIdentifier || !compileIdentifier.reference) {\n-    return null;\n-  }\n-  const ref = compileIdentifier.reference;\n-  if (ref instanceof StaticSymbol) {\n-    return ref.name;\n-  }\n-  if (ref['__anonymousType']) {\n-    return ref['__anonymousType'];\n-  }\n-  if (ref['__forward_ref__']) {\n-    // We do not want to try to stringify a `forwardRef()` function because that would cause the\n-    // inner function to be evaluated too early, defeating the whole point of the `forwardRef`.\n-    return '__forward_ref__';\n-  }\n-  let identifier = stringify(ref);\n-  if (identifier.indexOf('(') >= 0) {\n-    // case: anonymous functions!\n-    identifier = `anonymous_${_anonymousTypeIndex++}`;\n-    ref['__anonymousType'] = identifier;\n-  } else {\n-    identifier = sanitizeIdentifier(identifier);\n-  }\n-  return identifier;\n-}\n-\n-export function identifierModuleUrl(compileIdentifier: CompileIdentifierMetadata): string {\n-  const ref = compileIdentifier.reference;\n-  if (ref instanceof StaticSymbol) {\n-    return ref.filePath;\n-  }\n-  // Runtime type\n-  return `./${stringify(ref)}`;\n-}\n-\n export function viewClassName(compType: any, embeddedTemplateIndex: number): string {\n   return `View_${identifierName({reference: compType})}_${embeddedTemplateIndex}`;\n }\n@@ -81,10 +39,6 @@ export interface ProxyClass {\n   setDelegate(delegate: any): void;\n }\n \n-export interface CompileIdentifierMetadata {\n-  reference: any;\n-}\n-\n export enum CompileSummaryKind {\n   Pipe,\n   Directive,"
        },
        {
            "sha": "7bc7b2e357a7a6cbd5e7cf8b7dd5676d2fd81504",
            "filename": "packages/compiler/src/compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fcompiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -88,7 +88,7 @@ export * from './selector';\n export * from './style_compiler';\n export * from './template_parser/template_parser';\n export {ViewCompiler} from './view_compiler/view_compiler';\n-export {getParseErrors, isSyntaxError, syntaxError, Version} from './util';\n+export {Version} from './util';\n export {SourceMap} from './output/source_map';\n export * from './injectable_compiler_2';\n export * from './render3/partial/api';"
        },
        {
            "sha": "03d3b2124d277f7db43d53c41c8bdd8a979d7e12",
            "filename": "packages/compiler/src/constant_pool.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fconstant_pool.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fconstant_pool.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fconstant_pool.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -7,7 +7,6 @@\n  */\n \n import * as o from './output/output_ast';\n-import {error, OutputContext} from './util';\n \n const CONSTANT_PREFIX = '_c';\n \n@@ -276,6 +275,13 @@ export class ConstantPool {\n   }\n }\n \n+export interface OutputContext {\n+  genFilePath: string;\n+  statements: o.Statement[];\n+  constantPool: ConstantPool;\n+  importExpr(reference: any, typeParams?: o.Type[]|null, useSummaries?: boolean): o.Expression;\n+}\n+\n /**\n  * Visitor used to determine if 2 expressions are equivalent and can be shared in the\n  * `ConstantPool`."
        },
        {
            "sha": "3976338d81224d4f2a8041e7a752e5473aa3aeff",
            "filename": "packages/compiler/src/directive_normalizer.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fdirective_normalizer.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fdirective_normalizer.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fdirective_normalizer.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -13,11 +13,12 @@ import * as html from './ml_parser/ast';\n import {HtmlParser} from './ml_parser/html_parser';\n import {InterpolationConfig} from './ml_parser/interpolation_config';\n import {ParseTreeResult as HtmlParseTreeResult} from './ml_parser/parser';\n+import {syntaxError} from './parse_util';\n import {ResourceLoader} from './resource_loader';\n import {extractStyleUrls, isStyleUrlResolvable} from './style_url_resolver';\n import {PreparsedElementType, preparseElement} from './template_parser/template_preparser';\n import {UrlResolver} from './url_resolver';\n-import {isDefined, stringify, SyncAsync, syntaxError} from './util';\n+import {isDefined, stringify, SyncAsync} from './util';\n \n export interface PrenormalizedTemplateMetadata {\n   ngModuleType: any;"
        },
        {
            "sha": "b574db85d0f4e7a90f4bbbb027728d01af0f4f90",
            "filename": "packages/compiler/src/i18n/extractor.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fi18n%2Fextractor.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fi18n%2Fextractor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fi18n%2Fextractor.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -28,7 +28,6 @@ import {NgModuleResolver} from '../ng_module_resolver';\n import {ParseError} from '../parse_util';\n import {PipeResolver} from '../pipe_resolver';\n import {DomElementSchemaRegistry} from '../schema/dom_element_schema_registry';\n-import {syntaxError} from '../util';\n \n import {MessageBundle} from './message_bundle';\n "
        },
        {
            "sha": "8af182b7b33b58bf894a4017a51d3fc57a4d95ab",
            "filename": "packages/compiler/src/injectable_compiler.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Finjectable_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Finjectable_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Finjectable_compiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -7,14 +7,15 @@\n  */\n \n import {StaticSymbol} from './aot/static_symbol';\n-import {CompileInjectableMetadata, identifierName} from './compile_metadata';\n+import {CompileInjectableMetadata} from './compile_metadata';\n import {CompileReflector} from './compile_reflector';\n+import {OutputContext} from './constant_pool';\n import {InjectFlags} from './core';\n import {Identifiers} from './identifiers';\n import * as o from './output/output_ast';\n import {convertValueToOutputAst} from './output/value_util';\n+import {identifierName} from './parse_util';\n import {Identifiers as R3} from './render3/r3_identifiers';\n-import {OutputContext} from './util';\n \n type MapEntry = {\n   key: string,"
        },
        {
            "sha": "ded36fc38fafde409cafb9678f12b66e777a09f3",
            "filename": "packages/compiler/src/jit/compiler.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fjit%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fjit%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fjit%2Fcompiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,21 +6,22 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveMetadata, CompileIdentifierMetadata, CompileNgModuleMetadata, CompilePipeSummary, CompileProviderMetadata, CompileStylesheetMetadata, CompileTypeSummary, identifierName, ngModuleJitUrl, ProviderMeta, ProxyClass, sharedStylesheetJitUrl, templateJitUrl, templateSourceUrl} from '../compile_metadata';\n+import {CompileDirectiveMetadata, CompileNgModuleMetadata, CompilePipeSummary, CompileProviderMetadata, CompileTypeSummary, ngModuleJitUrl, ProxyClass, sharedStylesheetJitUrl, templateJitUrl, templateSourceUrl} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n import {CompilerConfig} from '../config';\n-import {ConstantPool} from '../constant_pool';\n+import {ConstantPool, OutputContext} from '../constant_pool';\n import {Type} from '../core';\n import {CompileMetadataResolver} from '../metadata_resolver';\n import {NgModuleCompiler} from '../ng_module_compiler';\n import * as ir from '../output/output_ast';\n import {interpretStatements} from '../output/output_interpreter';\n import {JitEvaluator} from '../output/output_jit';\n+import {CompileIdentifierMetadata, identifierName} from '../parse_util';\n import {CompiledStylesheet, StyleCompiler} from '../style_compiler';\n import {SummaryResolver} from '../summary_resolver';\n import {TemplateAst} from '../template_parser/template_ast';\n import {TemplateParser} from '../template_parser/template_parser';\n-import {Console, OutputContext, stringify, SyncAsync} from '../util';\n+import {Console, stringify, SyncAsync} from '../util';\n import {ViewCompiler} from '../view_compiler/view_compiler';\n \n export interface ModuleWithComponentFactories {"
        },
        {
            "sha": "5127191c4a7d9c99586c212f684eca9561ad0964",
            "filename": "packages/compiler/src/metadata_resolver.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 12,
            "changes": 25,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fmetadata_resolver.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fmetadata_resolver.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fmetadata_resolver.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -19,11 +19,12 @@ import {Identifiers} from './identifiers';\n import {getAllLifecycleHooks} from './lifecycle_reflector';\n import {HtmlParser} from './ml_parser/html_parser';\n import {NgModuleResolver} from './ng_module_resolver';\n+import {CompileIdentifierMetadata, identifierName, syntaxError} from './parse_util';\n import {PipeResolver} from './pipe_resolver';\n import {ElementSchemaRegistry} from './schema/element_schema_registry';\n import {CssSelector} from './selector';\n import {SummaryResolver} from './summary_resolver';\n-import {Console, isPromise, noUndefined, resolveForwardRef, stringify, SyncAsync, syntaxError, ValueTransformer, visitValue} from './util';\n+import {Console, isPromise, noUndefined, resolveForwardRef, stringify, SyncAsync, ValueTransformer, visitValue} from './util';\n \n export type ErrorCollector = (error: any, type?: any) => void;\n \n@@ -130,7 +131,7 @@ export class CompileMetadataResolver {\n   }\n \n   getHostComponentType(dirType: any): StaticSymbol|cpl.ProxyClass {\n-    const name = `${cpl.identifierName({reference: dirType})}_Host`;\n+    const name = `${identifierName({reference: dirType})}_Host`;\n     if (dirType instanceof StaticSymbol) {\n       return this._staticSymbolCache.get(dirType.filePath, name);\n     }\n@@ -533,14 +534,14 @@ export class CompileMetadataResolver {\n     if (!meta) {\n       return null;\n     }\n-    const declaredDirectives: cpl.CompileIdentifierMetadata[] = [];\n-    const exportedNonModuleIdentifiers: cpl.CompileIdentifierMetadata[] = [];\n-    const declaredPipes: cpl.CompileIdentifierMetadata[] = [];\n+    const declaredDirectives: CompileIdentifierMetadata[] = [];\n+    const exportedNonModuleIdentifiers: CompileIdentifierMetadata[] = [];\n+    const declaredPipes: CompileIdentifierMetadata[] = [];\n     const importedModules: cpl.CompileNgModuleSummary[] = [];\n     const exportedModules: cpl.CompileNgModuleSummary[] = [];\n     const providers: cpl.CompileProviderMetadata[] = [];\n     const entryComponents: cpl.CompileEntryComponentMetadata[] = [];\n-    const bootstrapComponents: cpl.CompileIdentifierMetadata[] = [];\n+    const bootstrapComponents: CompileIdentifierMetadata[] = [];\n     const schemas: SchemaMetadata[] = [];\n \n     if (meta.imports) {\n@@ -672,8 +673,8 @@ export class CompileMetadataResolver {\n       });\n     }\n \n-    const exportedDirectives: cpl.CompileIdentifierMetadata[] = [];\n-    const exportedPipes: cpl.CompileIdentifierMetadata[] = [];\n+    const exportedDirectives: CompileIdentifierMetadata[] = [];\n+    const exportedPipes: CompileIdentifierMetadata[] = [];\n     exportedNonModuleIdentifiers.forEach((exportedId) => {\n       if (transitiveModule.directivesSet.has(exportedId.reference)) {\n         exportedDirectives.push(exportedId);\n@@ -836,7 +837,7 @@ export class CompileMetadataResolver {\n     return result;\n   }\n \n-  private _getIdentifierMetadata(type: Type): cpl.CompileIdentifierMetadata {\n+  private _getIdentifierMetadata(type: Type): CompileIdentifierMetadata {\n     type = resolveForwardRef(type);\n     return {reference: type};\n   }\n@@ -1093,7 +1094,7 @@ export class CompileMetadataResolver {\n   private _getEntryComponentsFromProvider(provider: cpl.ProviderMeta, type?: any):\n       cpl.CompileEntryComponentMetadata[] {\n     const components: cpl.CompileEntryComponentMetadata[] = [];\n-    const collectedIdentifiers: cpl.CompileIdentifierMetadata[] = [];\n+    const collectedIdentifiers: CompileIdentifierMetadata[] = [];\n \n     if (provider.useFactory || provider.useExisting || provider.useClass) {\n       this._reportError(\n@@ -1263,12 +1264,12 @@ function isValidType(value: any): boolean {\n   return (value instanceof StaticSymbol) || (value instanceof Type);\n }\n \n-function extractIdentifiers(value: any, targetIdentifiers: cpl.CompileIdentifierMetadata[]) {\n+function extractIdentifiers(value: any, targetIdentifiers: CompileIdentifierMetadata[]) {\n   visitValue(value, new _CompileValueConverter(), targetIdentifiers);\n }\n \n class _CompileValueConverter extends ValueTransformer {\n-  override visitOther(value: any, targetIdentifiers: cpl.CompileIdentifierMetadata[]): any {\n+  override visitOther(value: any, targetIdentifiers: CompileIdentifierMetadata[]): any {\n     targetIdentifiers.push({reference: value});\n   }\n }"
        },
        {
            "sha": "4359a7170ed2caa3f3d553a0d7648452d7b340e5",
            "filename": "packages/compiler/src/ng_module_compiler.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fng_module_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fng_module_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fng_module_compiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,14 +6,14 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileNgModuleMetadata, CompileProviderMetadata, identifierName} from './compile_metadata';\n+import {CompileNgModuleMetadata, CompileProviderMetadata} from './compile_metadata';\n import {CompileReflector} from './compile_reflector';\n+import {OutputContext} from './constant_pool';\n import {NodeFlags} from './core';\n import {Identifiers} from './identifiers';\n import * as o from './output/output_ast';\n-import {typeSourceSpan} from './parse_util';\n+import {identifierName, typeSourceSpan} from './parse_util';\n import {NgModuleProviderAnalyzer} from './provider_analyzer';\n-import {OutputContext} from './util';\n import {componentFactoryResolverProviderDef, depDef, providerDef} from './view_compiler/provider_compiler';\n \n export class NgModuleCompileResult {"
        },
        {
            "sha": "b3fdc719c6ff6a6771278133ce63a438c4c1f31f",
            "filename": "packages/compiler/src/output/js_emitter.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Foutput%2Fjs_emitter.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Foutput%2Fjs_emitter.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Foutput%2Fjs_emitter.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -5,11 +5,6 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-\n-\n-import {StaticSymbol} from '../aot/static_symbol';\n-import {CompileIdentifierMetadata} from '../compile_metadata';\n-\n import {EmitterVisitorContext, OutputEmitter} from './abstract_emitter';\n import {AbstractJsEmitterVisitor} from './abstract_js_emitter';\n import * as o from './output_ast';"
        },
        {
            "sha": "4f8c51547e15f6980b86f31070d9c81207406b8e",
            "filename": "packages/compiler/src/output/output_ast.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_ast.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_ast.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_ast.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,7 +6,6 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-\n import {ParseSourceSpan} from '../parse_util';\n import {I18nMeta} from '../render3/view/i18n/meta';\n "
        },
        {
            "sha": "5d5f3890aac73663fc4c87de2e7536f086408e28",
            "filename": "packages/compiler/src/output/output_jit.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_jit.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_jit.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Foutput%2Foutput_jit.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,8 +6,8 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {identifierName} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n+import {identifierName} from '../parse_util';\n \n import {EmitterVisitorContext} from './abstract_emitter';\n import {AbstractJsEmitterVisitor} from './abstract_js_emitter';"
        },
        {
            "sha": "904c50b2aae1882d0cd5a3877fa9ce165952aaf6",
            "filename": "packages/compiler/src/output/value_util.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Foutput%2Fvalue_util.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Foutput%2Fvalue_util.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Foutput%2Fvalue_util.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -7,7 +7,8 @@\n  */\n \n \n-import {OutputContext, ValueTransformer, visitValue} from '../util';\n+import {OutputContext} from '../constant_pool';\n+import {ValueTransformer, visitValue} from '../util';\n \n import * as o from './output_ast';\n "
        },
        {
            "sha": "823f507f454dac6395148b3a6b931c71e1b1bcd4",
            "filename": "packages/compiler/src/parse_util.ts",
            "status": "modified",
            "additions": 67,
            "deletions": 1,
            "changes": 68,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fparse_util.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fparse_util.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fparse_util.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -5,8 +5,9 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n+import {StaticSymbol} from './aot/static_symbol';\n import * as chars from './chars';\n-import {CompileIdentifierMetadata, identifierModuleUrl, identifierName} from './compile_metadata';\n+import {stringify} from './util';\n \n export class ParseLocation {\n   constructor(\n@@ -178,3 +179,68 @@ export function r3JitTypeSourceSpan(\n   return new ParseSourceSpan(\n       new ParseLocation(sourceFile, -1, -1, -1), new ParseLocation(sourceFile, -1, -1, -1));\n }\n+\n+export function syntaxError(msg: string, parseErrors?: ParseError[]): Error {\n+  const error = Error(msg);\n+  (error as any)[ERROR_SYNTAX_ERROR] = true;\n+  if (parseErrors) (error as any)[ERROR_PARSE_ERRORS] = parseErrors;\n+  return error;\n+}\n+\n+const ERROR_SYNTAX_ERROR = 'ngSyntaxError';\n+const ERROR_PARSE_ERRORS = 'ngParseErrors';\n+\n+export function isSyntaxError(error: Error): boolean {\n+  return (error as any)[ERROR_SYNTAX_ERROR];\n+}\n+\n+export function getParseErrors(error: Error): ParseError[] {\n+  return (error as any)[ERROR_PARSE_ERRORS] || [];\n+}\n+\n+let _anonymousTypeIndex = 0;\n+\n+export function identifierName(compileIdentifier: CompileIdentifierMetadata|null|undefined): string|\n+    null {\n+  if (!compileIdentifier || !compileIdentifier.reference) {\n+    return null;\n+  }\n+  const ref = compileIdentifier.reference;\n+  if (ref instanceof StaticSymbol) {\n+    return ref.name;\n+  }\n+  if (ref['__anonymousType']) {\n+    return ref['__anonymousType'];\n+  }\n+  if (ref['__forward_ref__']) {\n+    // We do not want to try to stringify a `forwardRef()` function because that would cause the\n+    // inner function to be evaluated too early, defeating the whole point of the `forwardRef`.\n+    return '__forward_ref__';\n+  }\n+  let identifier = stringify(ref);\n+  if (identifier.indexOf('(') >= 0) {\n+    // case: anonymous functions!\n+    identifier = `anonymous_${_anonymousTypeIndex++}`;\n+    ref['__anonymousType'] = identifier;\n+  } else {\n+    identifier = sanitizeIdentifier(identifier);\n+  }\n+  return identifier;\n+}\n+\n+export function identifierModuleUrl(compileIdentifier: CompileIdentifierMetadata): string {\n+  const ref = compileIdentifier.reference;\n+  if (ref instanceof StaticSymbol) {\n+    return ref.filePath;\n+  }\n+  // Runtime type\n+  return `./${stringify(ref)}`;\n+}\n+\n+export interface CompileIdentifierMetadata {\n+  reference: any;\n+}\n+\n+export function sanitizeIdentifier(name: string): string {\n+  return name.replace(/\\W/g, '_');\n+}"
        },
        {
            "sha": "e0c94c90b22bf5d74ec20a3cf93ec0cc551eaa8f",
            "filename": "packages/compiler/src/render3/r3_factory.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Frender3%2Fr3_factory.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Frender3%2Fr3_factory.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fr3_factory.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -5,17 +5,10 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-\n-import {StaticSymbol} from '../aot/static_symbol';\n-import {CompileTypeMetadata, tokenReference} from '../compile_metadata';\n import {InjectFlags} from '../core';\n import * as o from '../output/output_ast';\n import {Identifiers as R3} from '../render3/r3_identifiers';\n-import {OutputContext} from '../util';\n-\n import {R3CompiledExpression, R3Reference, typeWithParameters} from './util';\n-import {unsupported} from './view/util';\n-\n \n \n /**"
        },
        {
            "sha": "852f967bbc7c02b56b2b3edd97725522031484b0",
            "filename": "packages/compiler/src/render3/view/compiler.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fcompiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fcompiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fcompiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,13 +6,13 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveSummary, sanitizeIdentifier} from '../../compile_metadata';\n+import {CompileDirectiveSummary} from '../../compile_metadata';\n import {BindingForm, convertPropertyBinding} from '../../compiler_util/expression_converter';\n import {ConstantPool} from '../../constant_pool';\n import * as core from '../../core';\n import {AST, ParsedEvent, ParsedEventType, ParsedProperty} from '../../expression_parser/ast';\n import * as o from '../../output/output_ast';\n-import {ParseError, ParseSourceSpan} from '../../parse_util';\n+import {ParseError, ParseSourceSpan, sanitizeIdentifier} from '../../parse_util';\n import {CssSelector, SelectorMatcher} from '../../selector';\n import {ShadowCss} from '../../shadow_css';\n import {CONTENT_ATTR, HOST_ATTR} from '../../style_compiler';"
        },
        {
            "sha": "a37caa822b289cb7e2b9b66b8926784433716290",
            "filename": "packages/compiler/src/render3/view/template.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {flatten, sanitizeIdentifier} from '../../compile_metadata';\n+import {flatten} from '../../compile_metadata';\n import {BindingForm, BuiltinFunctionCall, convertActionBinding, convertPropertyBinding, convertUpdateArguments, LocalResolver} from '../../compiler_util/expression_converter';\n import {ConstantPool} from '../../constant_pool';\n import * as core from '../../core';\n@@ -22,7 +22,7 @@ import {LexerRange} from '../../ml_parser/lexer';\n import {isNgContainer as checkIsNgContainer, splitNsName} from '../../ml_parser/tags';\n import {mapLiteral} from '../../output/map_util';\n import * as o from '../../output/output_ast';\n-import {ParseError, ParseSourceFile, ParseSourceSpan} from '../../parse_util';\n+import {ParseError, ParseSourceSpan, sanitizeIdentifier} from '../../parse_util';\n import {DomElementSchemaRegistry} from '../../schema/dom_element_schema_registry';\n import {isTrustedTypesSink} from '../../schema/trusted_types_sinks';\n import {CssSelector, SelectorMatcher} from '../../selector';"
        },
        {
            "sha": "f766f9d4505efaab1bb58277b50e3620212fd386",
            "filename": "packages/compiler/src/style_compiler.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fstyle_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fstyle_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fstyle_compiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,12 +6,13 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveMetadata, CompileIdentifierMetadata, CompileStylesheetMetadata, identifierModuleUrl, identifierName} from './compile_metadata';\n+import {CompileDirectiveMetadata, CompileStylesheetMetadata} from './compile_metadata';\n+import {OutputContext} from './constant_pool';\n import {ViewEncapsulation} from './core';\n import * as o from './output/output_ast';\n+import {identifierModuleUrl, identifierName} from './parse_util';\n import {ShadowCss} from './shadow_css';\n import {UrlResolver} from './url_resolver';\n-import {OutputContext} from './util';\n \n const COMPONENT_VARIABLE = '%COMP%';\n export const HOST_ATTR = `_nghost-${COMPONENT_VARIABLE}`;"
        },
        {
            "sha": "65b2613865fd4a69bf3123295400b049947d4771",
            "filename": "packages/compiler/src/template_parser/template_parser.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Ftemplate_parser%2Ftemplate_parser.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Ftemplate_parser%2Ftemplate_parser.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Ftemplate_parser%2Ftemplate_parser.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {CompileDirectiveMetadata, CompileDirectiveSummary, CompilePipeSummary, CompileTokenMetadata, CompileTypeMetadata, identifierName} from '../compile_metadata';\n+import {CompileDirectiveMetadata, CompileDirectiveSummary, CompilePipeSummary, CompileTokenMetadata, CompileTypeMetadata} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n import {CompilerConfig} from '../config';\n import {SchemaMetadata} from '../core';\n@@ -19,12 +19,12 @@ import {removeWhitespaces, replaceNgsp} from '../ml_parser/html_whitespaces';\n import {expandNodes} from '../ml_parser/icu_ast_expander';\n import {InterpolationConfig} from '../ml_parser/interpolation_config';\n import {isNgTemplate, splitNsName} from '../ml_parser/tags';\n-import {ParseError, ParseErrorLevel, ParseSourceSpan} from '../parse_util';\n+import {identifierName, ParseError, ParseErrorLevel, ParseSourceSpan, syntaxError} from '../parse_util';\n import {ProviderElementContext, ProviderViewContext} from '../provider_analyzer';\n import {ElementSchemaRegistry} from '../schema/element_schema_registry';\n import {CssSelector, SelectorMatcher} from '../selector';\n import {isStyleUrlResolvable} from '../style_url_resolver';\n-import {Console, newArray, syntaxError} from '../util';\n+import {Console, newArray} from '../util';\n \n import {BindingParser} from './binding_parser';\n import * as t from './template_ast';"
        },
        {
            "sha": "e30d002ca495258c3f2c6a3a71e6bb2f3b8d1630",
            "filename": "packages/compiler/src/util.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 30,
            "changes": 30,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Futil.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,11 +6,6 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {ConstantPool} from './constant_pool';\n-\n-import * as o from './output/output_ast';\n-import {ParseError} from './parse_util';\n-\n const DASH_CASE_REGEXP = /-+([a-z0-9])/g;\n \n export function dashCaseToCamelCase(input: string): string {\n@@ -104,24 +99,6 @@ export function error(msg: string): never {\n   throw new Error(`Internal Error: ${msg}`);\n }\n \n-export function syntaxError(msg: string, parseErrors?: ParseError[]): Error {\n-  const error = Error(msg);\n-  (error as any)[ERROR_SYNTAX_ERROR] = true;\n-  if (parseErrors) (error as any)[ERROR_PARSE_ERRORS] = parseErrors;\n-  return error;\n-}\n-\n-const ERROR_SYNTAX_ERROR = 'ngSyntaxError';\n-const ERROR_PARSE_ERRORS = 'ngParseErrors';\n-\n-export function isSyntaxError(error: Error): boolean {\n-  return (error as any)[ERROR_SYNTAX_ERROR];\n-}\n-\n-export function getParseErrors(error: Error): ParseError[] {\n-  return (error as any)[ERROR_PARSE_ERRORS] || [];\n-}\n-\n // Escape characters that have a special meaning in Regular Expressions\n export function escapeRegExp(s: string): string {\n   return s.replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g, '\\\\$1');\n@@ -166,13 +143,6 @@ export function utf8Encode(str: string): Byte[] {\n   return encoded;\n }\n \n-export interface OutputContext {\n-  genFilePath: string;\n-  statements: o.Statement[];\n-  constantPool: ConstantPool;\n-  importExpr(reference: any, typeParams?: o.Type[]|null, useSummaries?: boolean): o.Expression;\n-}\n-\n export function stringify(token: any): string {\n   if (typeof token === 'string') {\n     return token;"
        },
        {
            "sha": "844a5432934184eef88cfd9eaa10a5803c49af99",
            "filename": "packages/compiler/src/view_compiler/provider_compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fprovider_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fprovider_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fprovider_compiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -8,13 +8,13 @@\n \n import {CompileDiDependencyMetadata, CompileEntryComponentMetadata, CompileProviderMetadata, CompileTokenMetadata} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n+import {OutputContext} from '../constant_pool';\n import {DepFlags, NodeFlags} from '../core';\n import {createTokenForExternalReference, Identifiers} from '../identifiers';\n import {LifecycleHooks} from '../lifecycle_reflector';\n import * as o from '../output/output_ast';\n import {convertValueToOutputAst} from '../output/value_util';\n import {ProviderAst, ProviderAstType} from '../template_parser/template_ast';\n-import {OutputContext} from '../util';\n \n export function providerDef(ctx: OutputContext, providerAst: ProviderAst): {\n   providerExpr: o.Expression,"
        },
        {
            "sha": "42bd2b959aaf20b2f31702ebd3770a8507785172",
            "filename": "packages/compiler/src/view_compiler/type_check_compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Ftype_check_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Ftype_check_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Ftype_check_compiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -11,11 +11,11 @@ import {StaticReflector} from '../aot/static_reflector';\n import {StaticSymbol} from '../aot/static_symbol';\n import {CompileDirectiveMetadata, CompilePipeSummary} from '../compile_metadata';\n import {BindingForm, convertActionBinding, convertPropertyBinding, convertPropertyBindingBuiltins, EventHandlerVars, LocalResolver} from '../compiler_util/expression_converter';\n+import {OutputContext} from '../constant_pool';\n import {AST, ASTWithSource, Interpolation} from '../expression_parser/ast';\n import * as o from '../output/output_ast';\n import {ParseSourceSpan} from '../parse_util';\n import {AttrAst, BoundDirectivePropertyAst, BoundElementPropertyAst, BoundEventAst, BoundTextAst, DirectiveAst, ElementAst, EmbeddedTemplateAst, NgContentAst, ReferenceAst, TemplateAst, TemplateAstVisitor, templateVisitAll, TextAst, VariableAst} from '../template_parser/template_ast';\n-import {OutputContext} from '../util';\n \n \n /**"
        },
        {
            "sha": "af14575b9e6c8b110b3f2609d682a5f6adceee0e",
            "filename": "packages/compiler/src/view_compiler/view_compiler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fview_compiler.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fview_compiler.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Fview_compiler%2Fview_compiler.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -9,6 +9,7 @@\n import {CompileDirectiveMetadata, CompilePipeSummary, CompileQueryMetadata, rendererTypeName, tokenReference, viewClassName} from '../compile_metadata';\n import {CompileReflector} from '../compile_reflector';\n import {BindingForm, BuiltinConverter, convertActionBinding, convertPropertyBinding, convertPropertyBindingBuiltins, EventHandlerVars, LocalResolver} from '../compiler_util/expression_converter';\n+import {OutputContext} from '../constant_pool';\n import {ArgumentType, BindingFlags, ChangeDetectionStrategy, NodeFlags, QueryBindingType, QueryValueType, ViewFlags} from '../core';\n import {AST, ASTWithSource, Interpolation} from '../expression_parser/ast';\n import {Identifiers} from '../identifiers';\n@@ -18,7 +19,6 @@ import * as o from '../output/output_ast';\n import {convertValueToOutputAst} from '../output/value_util';\n import {ParseSourceSpan} from '../parse_util';\n import {AttrAst, BoundDirectivePropertyAst, BoundElementPropertyAst, BoundEventAst, BoundTextAst, DirectiveAst, ElementAst, EmbeddedTemplateAst, NgContentAst, PropertyBindingType, ProviderAst, QueryMatch, ReferenceAst, TemplateAst, TemplateAstVisitor, templateVisitAll, TextAst, VariableAst} from '../template_parser/template_ast';\n-import {OutputContext} from '../util';\n \n import {componentFactoryResolverProviderDef, depDef, lifecycleHookToNodeFlag, providerDef} from './provider_compiler';\n "
        },
        {
            "sha": "2870dc6ca0d5960ee425a655154f81c9c8b9cc23",
            "filename": "packages/compiler/test/aot/summary_resolver_spec.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Ftest%2Faot%2Fsummary_resolver_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Ftest%2Faot%2Fsummary_resolver_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Ftest%2Faot%2Fsummary_resolver_spec.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,11 +6,10 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {AotSummaryResolver, AotSummaryResolverHost, CompileSummaryKind, CompileTypeSummary, ResolvedStaticSymbol, StaticSymbol, StaticSymbolCache, StaticSymbolResolver} from '@angular/compiler';\n-import {deserializeSummaries, serializeSummaries} from '@angular/compiler/src/aot/summary_serializer';\n-import {ConstantPool} from '@angular/compiler/src/constant_pool';\n+import {AotSummaryResolver, AotSummaryResolverHost, ResolvedStaticSymbol, StaticSymbolCache, StaticSymbolResolver} from '@angular/compiler';\n+import {serializeSummaries} from '@angular/compiler/src/aot/summary_serializer';\n+import {ConstantPool, OutputContext} from '@angular/compiler/src/constant_pool';\n import * as o from '@angular/compiler/src/output/output_ast';\n-import {OutputContext} from '@angular/compiler/src/util';\n import * as path from 'path';\n \n import {MockStaticSymbolResolverHost, MockSummaryResolver} from './static_symbol_resolver_spec';"
        },
        {
            "sha": "78856d6dba7464aec2f827fb5dc260feb2cb1343",
            "filename": "packages/compiler/test/metadata_resolver_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Ftest%2Fmetadata_resolver_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Ftest%2Fmetadata_resolver_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Ftest%2Fmetadata_resolver_spec.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -10,8 +10,9 @@ import {LIFECYCLE_HOOKS_VALUES, LifecycleHooks} from '@angular/compiler/src/life\n import {AfterContentChecked, AfterContentInit, AfterViewChecked, AfterViewInit, ChangeDetectionStrategy, Component, Directive, DoCheck, Injectable, NgModule, OnChanges, OnDestroy, OnInit, Pipe, SimpleChanges, ViewEncapsulation, stringify as stringify} from '@angular/core';\n import {inject, TestBed, waitForAsync} from '@angular/core/testing';\n \n-import {CompileDiDependencyMetadata, identifierName} from '../src/compile_metadata';\n+import {CompileDiDependencyMetadata} from '../src/compile_metadata';\n import {CompileMetadataResolver} from '../src/metadata_resolver';\n+import {identifierName} from '../src/parse_util';\n import {ResourceLoader} from '../src/resource_loader';\n import {MockResourceLoader} from '../testing/src/resource_loader_mock';\n "
        },
        {
            "sha": "70cd116c6eea6582ed656b618e0d7c3c036f2055",
            "filename": "packages/compiler/test/output/js_emitter_node_only_spec.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Ftest%2Foutput%2Fjs_emitter_node_only_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c32bfe58602d6e2a35c7f2dcb47e1c56555389a2/packages%2Fcompiler%2Ftest%2Foutput%2Fjs_emitter_node_only_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Ftest%2Foutput%2Fjs_emitter_node_only_spec.ts?ref=c32bfe58602d6e2a35c7f2dcb47e1c56555389a2",
            "patch": "@@ -6,8 +6,6 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {StaticSymbol} from '@angular/compiler/src/aot/static_symbol';\n-import {CompileIdentifierMetadata} from '@angular/compiler/src/compile_metadata';\n import {JavaScriptEmitter} from '@angular/compiler/src/output/js_emitter';\n import * as o from '@angular/compiler/src/output/output_ast';\n import {SourceMap} from '@angular/compiler/src/output/source_map';"
        }
    ],
    "stats": {
        "total": 331,
        "additions": 132,
        "deletions": 199
    }
}