{
    "author": "devversion",
    "message": "refactor(dev-infra): remove duplicate method that checks for uncommitted changes (#42409)\n\nRemoves the duplicate `hasLocalChanges` method from the Git client. We\nalready have `hasUncommittedChanges`. Also removes a TODO for adding\n`assertNoLocalChanges` as it seems more flexible to manually check\n(i.e. better messaging with context on the current tool; e.g. \"cannot\nperform rebase\")\n\nPR Close #42409",
    "sha": "49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207",
    "files": [
        {
            "sha": "18f635a8efef481aa3b60996212f2f70497f09d7",
            "filename": "dev-infra/build-worker.js",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fbuild-worker.js",
            "raw_url": "https://github.com/angular/angular/raw/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fbuild-worker.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fbuild-worker.js?ref=49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207",
            "patch": "@@ -172,7 +172,7 @@ var GitCommandError = /** @class */ (function (_super) {\n var GitClient = /** @class */ (function () {\n     /**\n      * @param githubToken The github token used for authentication, if provided.\n-     * @param _config The configuration, containing the github specific configuration.\n+     * @param config The configuration, containing the github specific configuration.\n      * @param baseDir The full path to the root of the repository base.\n      */\n     function GitClient(githubToken, config, baseDir) {\n@@ -294,10 +294,6 @@ var GitClient = /** @class */ (function () {\n     GitClient.prototype.hasUncommittedChanges = function () {\n         return this.runGraceful(['diff-index', '--quiet', 'HEAD']).status !== 0;\n     };\n-    /** Whether the repo has any local changes. */\n-    GitClient.prototype.hasLocalChanges = function () {\n-        return this.runGraceful(['diff-index', '--quiet', 'HEAD']).status !== 0;\n-    };\n     /** Sanitizes a given message by omitting the provided Github token if present. */\n     GitClient.prototype.omitGithubTokenFromMessage = function (value) {\n         // If no token has been defined (i.e. no token regex), we just return the"
        },
        {
            "sha": "21795f21bf0dadbe4c28469154a76f2d11e587e3",
            "filename": "dev-infra/ng-dev.js",
            "status": "modified",
            "additions": 4,
            "deletions": 9,
            "changes": 13,
            "blob_url": "https://github.com/angular/angular/blob/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207",
            "patch": "@@ -340,7 +340,7 @@ var GitCommandError = /** @class */ (function (_super) {\n var GitClient = /** @class */ (function () {\n     /**\n      * @param githubToken The github token used for authentication, if provided.\n-     * @param _config The configuration, containing the github specific configuration.\n+     * @param config The configuration, containing the github specific configuration.\n      * @param baseDir The full path to the root of the repository base.\n      */\n     function GitClient(githubToken, config, baseDir) {\n@@ -462,10 +462,6 @@ var GitClient = /** @class */ (function () {\n     GitClient.prototype.hasUncommittedChanges = function () {\n         return this.runGraceful(['diff-index', '--quiet', 'HEAD']).status !== 0;\n     };\n-    /** Whether the repo has any local changes. */\n-    GitClient.prototype.hasLocalChanges = function () {\n-        return this.runGraceful(['diff-index', '--quiet', 'HEAD']).status !== 0;\n-    };\n     /** Sanitizes a given message by omitting the provided Github token if present. */\n     GitClient.prototype.omitGithubTokenFromMessage = function (value) {\n         // If no token has been defined (i.e. no token regex), we just return the\n@@ -3110,7 +3106,7 @@ function checkOutPullRequestLocally(prNumber, githubToken, opts = {}) {\n         const git = GitClient.getAuthenticatedInstance();\n         // In order to preserve local changes, checkouts cannot occur if local changes are present in the\n         // git environment. Checked before retrieving the PR to fail fast.\n-        if (git.hasLocalChanges()) {\n+        if (git.hasUncommittedChanges()) {\n             throw new UnexpectedLocalChangesError('Unable to checkout PR due to uncommitted changes.');\n         }\n         /**\n@@ -3250,7 +3246,7 @@ function discoverNewConflictsForPr(newPrNumber, updatedAfter) {\n         const git = GitClient.getAuthenticatedInstance();\n         // If there are any local changes in the current repository state, the\n         // check cannot run as it needs to move between branches.\n-        if (git.hasLocalChanges()) {\n+        if (git.hasUncommittedChanges()) {\n             error('Cannot run with local changes. Please make sure there are no local changes.');\n             process.exit(1);\n         }\n@@ -4582,8 +4578,7 @@ function rebasePr(prNumber, githubToken, config = getConfig()) {\n     return tslib.__awaiter(this, void 0, void 0, function* () {\n         /** The singleton instance of the GitClient. */\n         const git = GitClient.getAuthenticatedInstance();\n-        // TODO: Rely on a common assertNoLocalChanges function.\n-        if (git.hasLocalChanges()) {\n+        if (git.hasUncommittedChanges()) {\n             error('Cannot perform rebase of PR with local changes.');\n             process.exit(1);\n         }"
        },
        {
            "sha": "57098d9f19fd1aa5e1e58f5ef475bbe4229015e7",
            "filename": "dev-infra/pr/common/checkout-pr.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fpr%2Fcommon%2Fcheckout-pr.ts",
            "raw_url": "https://github.com/angular/angular/raw/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fpr%2Fcommon%2Fcheckout-pr.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fcommon%2Fcheckout-pr.ts?ref=49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207",
            "patch": "@@ -67,7 +67,7 @@ export async function checkOutPullRequestLocally(\n \n   // In order to preserve local changes, checkouts cannot occur if local changes are present in the\n   // git environment. Checked before retrieving the PR to fail fast.\n-  if (git.hasLocalChanges()) {\n+  if (git.hasUncommittedChanges()) {\n     throw new UnexpectedLocalChangesError('Unable to checkout PR due to uncommitted changes.');\n   }\n "
        },
        {
            "sha": "95ecd95960b243cc14dde056e5a7eb405bd7306b",
            "filename": "dev-infra/pr/discover-new-conflicts/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fpr%2Fdiscover-new-conflicts%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fpr%2Fdiscover-new-conflicts%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fdiscover-new-conflicts%2Findex.ts?ref=49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207",
            "patch": "@@ -57,7 +57,7 @@ export async function discoverNewConflictsForPr(newPrNumber: number, updatedAfte\n   const git = GitClient.getAuthenticatedInstance();\n   // If there are any local changes in the current repository state, the\n   // check cannot run as it needs to move between branches.\n-  if (git.hasLocalChanges()) {\n+  if (git.hasUncommittedChanges()) {\n     error('Cannot run with local changes. Please make sure there are no local changes.');\n     process.exit(1);\n   }"
        },
        {
            "sha": "f5889f992ca4a358c2cb2657629e65f6e06177a3",
            "filename": "dev-infra/pr/rebase/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fpr%2Frebase%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Fpr%2Frebase%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Frebase%2Findex.ts?ref=49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207",
            "patch": "@@ -46,8 +46,7 @@ export async function rebasePr(\n     prNumber: number, githubToken: string, config: Pick<NgDevConfig, 'github'> = getConfig()) {\n   /** The singleton instance of the GitClient. */\n   const git = GitClient.getAuthenticatedInstance();\n-  // TODO: Rely on a common assertNoLocalChanges function.\n-  if (git.hasLocalChanges()) {\n+  if (git.hasUncommittedChanges()) {\n     error('Cannot perform rebase of PR with local changes.');\n     process.exit(1);\n   }"
        },
        {
            "sha": "c428da2c5f80ab04f686c6e6cbb565e6a81f2975",
            "filename": "dev-infra/utils/git/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 6,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Futils%2Fgit%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207/dev-infra%2Futils%2Fgit%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2Fgit%2Findex.ts?ref=49c3ce58bfcc8e92f81a6b386ce5eb6a44f5f207",
            "patch": "@@ -115,7 +115,7 @@ export class GitClient<Authenticated extends boolean> {\n \n   /**\n    * @param githubToken The github token used for authentication, if provided.\n-   * @param _config The configuration, containing the github specific configuration.\n+   * @param config The configuration, containing the github specific configuration.\n    * @param baseDir The full path to the root of the repository base.\n    */\n   protected constructor(public githubToken: Authenticated extends true? string: undefined,\n@@ -214,11 +214,6 @@ export class GitClient<Authenticated extends boolean> {\n     return this.runGraceful(['diff-index', '--quiet', 'HEAD']).status !== 0;\n   }\n \n-  /** Whether the repo has any local changes. */\n-  hasLocalChanges(): boolean {\n-    return this.runGraceful(['diff-index', '--quiet', 'HEAD']).status !== 0;\n-  }\n-\n   /** Sanitizes a given message by omitting the provided Github token if present. */\n   omitGithubTokenFromMessage(value: string): string {\n     // If no token has been defined (i.e. no token regex), we just return the"
        }
    ],
    "stats": {
        "total": 33,
        "additions": 9,
        "deletions": 24
    }
}