{
    "author": "krzysztof-grzybek",
    "message": "fix(router): add null support for RouterLink directive (#32616)\n\nValue of \"undefined\" passed as segment in routerLink is stringified to string \"undefined\".\nThis change introduces the same behavior for value of \"null\".\n\nPR Close #32616",
    "sha": "616543ded07d632438185f3df6f3b73591cdaf80",
    "files": [
        {
            "sha": "cec351c7cc526aaa54f07b58b5b0215e1a4d9aec",
            "filename": "packages/router/src/create_url_tree.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/616543ded07d632438185f3df6f3b73591cdaf80/packages%2Frouter%2Fsrc%2Fcreate_url_tree.ts",
            "raw_url": "https://github.com/angular/angular/raw/616543ded07d632438185f3df6f3b73591cdaf80/packages%2Frouter%2Fsrc%2Fcreate_url_tree.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Fsrc%2Fcreate_url_tree.ts?ref=616543ded07d632438185f3df6f3b73591cdaf80",
            "patch": "@@ -186,9 +186,11 @@ function getPath(command: any): any {\n }\n \n function getOutlets(commands: any[]): {[k: string]: any[]} {\n-  if (!(typeof commands[0] === 'object')) return {[PRIMARY_OUTLET]: commands};\n-  if (commands[0].outlets === undefined) return {[PRIMARY_OUTLET]: commands};\n-  return commands[0].outlets;\n+  if (typeof commands[0] === 'object' && commands[0] !== null && commands[0].outlets) {\n+    return commands[0].outlets;\n+  }\n+\n+  return {[PRIMARY_OUTLET]: commands};\n }\n \n function updateSegmentGroup(\n@@ -274,7 +276,8 @@ function createNewSegmentGroup(\n \n   let i = 0;\n   while (i < commands.length) {\n-    if (typeof commands[i] === 'object' && commands[i].outlets !== undefined) {\n+    if (typeof commands[i] === 'object' && commands[i] !== null &&\n+        commands[i].outlets !== undefined) {\n       const children = createNewSegmentChildren(commands[i].outlets);\n       return new UrlSegmentGroup(paths, children);\n     }"
        },
        {
            "sha": "8603c1062a3be4c001d8d9cd5d347cc0cbe41d30",
            "filename": "packages/router/test/create_url_tree.spec.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 1,
            "changes": 16,
            "blob_url": "https://github.com/angular/angular/blob/616543ded07d632438185f3df6f3b73591cdaf80/packages%2Frouter%2Ftest%2Fcreate_url_tree.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/616543ded07d632438185f3df6f3b73591cdaf80/packages%2Frouter%2Ftest%2Fcreate_url_tree.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fcreate_url_tree.spec.ts?ref=616543ded07d632438185f3df6f3b73591cdaf80",
            "patch": "@@ -68,7 +68,21 @@ describe('createUrlTree', () => {\n     expect(params[1].path).toEqual('11');\n   });\n \n-  it('should support first segments contaings slashes', () => {\n+  it('should work if command = null', () => {\n+    const p = serializer.parse('/a/b');\n+    const t = createRoot(p, [null]);\n+    const params = t.root.children[PRIMARY_OUTLET].segments;\n+    expect(params[0].path).toEqual('null');\n+  });\n+\n+  it('should work if command is undefined', () => {\n+    const p = serializer.parse('/a/b');\n+    const t = createRoot(p, [undefined]);\n+    const params = t.root.children[PRIMARY_OUTLET].segments;\n+    expect(params[0].path).toEqual('undefined');\n+  });\n+\n+  it('should support first segments containing slashes', () => {\n     const p = serializer.parse('/');\n     const t = createRoot(p, [{segmentPath: '/one'}, 'two/three']);\n     expect(serializer.serialize(t)).toEqual('/%2Fone/two%2Fthree');"
        },
        {
            "sha": "9aa3775acabaa9d4756d4f72aeabebf8841538fe",
            "filename": "packages/router/test/integration.spec.ts",
            "status": "modified",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/angular/angular/blob/616543ded07d632438185f3df6f3b73591cdaf80/packages%2Frouter%2Ftest%2Fintegration.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/616543ded07d632438185f3df6f3b73591cdaf80/packages%2Frouter%2Ftest%2Fintegration.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fintegration.spec.ts?ref=616543ded07d632438185f3df6f3b73591cdaf80",
            "patch": "@@ -1994,6 +1994,36 @@ describe('Integration', () => {\n          expect(() => buttons[1].click()).not.toThrow();\n        }));\n \n+    it('should not throw when some command is null', fakeAsync(() => {\n+         @Component({\n+           selector: 'someCmp',\n+           template:\n+               `<router-outlet></router-outlet><a [routerLink]=\"[null]\">Link</a><button [routerLink]=\"[null]\">Button</button>`\n+         })\n+         class CmpWithLink {\n+         }\n+\n+         TestBed.configureTestingModule({declarations: [CmpWithLink]});\n+         const router: Router = TestBed.inject(Router);\n+\n+         expect(() => createRoot(router, CmpWithLink)).not.toThrow();\n+       }));\n+\n+    it('should not throw when some command is undefined', fakeAsync(() => {\n+         @Component({\n+           selector: 'someCmp',\n+           template:\n+               `<router-outlet></router-outlet><a [routerLink]=\"[undefined]\">Link</a><button [routerLink]=\"[undefined]\">Button</button>`\n+         })\n+         class CmpWithLink {\n+         }\n+\n+         TestBed.configureTestingModule({declarations: [CmpWithLink]});\n+         const router: Router = TestBed.inject(Router);\n+\n+         expect(() => createRoot(router, CmpWithLink)).not.toThrow();\n+       }));\n+\n     it('should update hrefs when query params or fragment change', fakeAsync(() => {\n          @Component({\n            selector: 'someRoot',"
        }
    ],
    "stats": {
        "total": 57,
        "additions": 52,
        "deletions": 5
    }
}