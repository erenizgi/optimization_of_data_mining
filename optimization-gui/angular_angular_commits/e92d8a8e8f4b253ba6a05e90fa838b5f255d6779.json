{
    "author": "atscott",
    "message": "test(compiler-cli): Add test for checkTypeOfDomReferences = false (#39539)\n\nAdd test for when `checkTypeOfDomReferences = false` to ensure that we\ndo not regress in behavior at any point. The desired behavior for this\ncase is that the `TemplateTypeChecker` will honor the user's\nconfiguration and not produce symbols for the dom reference.\n\nPR Close #39539",
    "sha": "e92d8a8e8f4b253ba6a05e90fa838b5f255d6779",
    "files": [
        {
            "sha": "cf74e87a2f3d0dc2698daefbdc15022cf12f953a",
            "filename": "packages/compiler-cli/src/ngtsc/typecheck/test/type_checker__get_symbol_of_template_node_spec.ts",
            "status": "modified",
            "additions": 46,
            "deletions": 20,
            "changes": 66,
            "blob_url": "https://github.com/angular/angular/blob/e92d8a8e8f4b253ba6a05e90fa838b5f255d6779/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Ftest%2Ftype_checker__get_symbol_of_template_node_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/e92d8a8e8f4b253ba6a05e90fa838b5f255d6779/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Ftest%2Ftype_checker__get_symbol_of_template_node_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftypecheck%2Ftest%2Ftype_checker__get_symbol_of_template_node_spec.ts?ref=e92d8a8e8f4b253ba6a05e90fa838b5f255d6779",
            "patch": "@@ -539,31 +539,57 @@ runInEachFileSystem(() => {\n         expect(program.getTypeChecker().typeToString(bSymbol.tsType)).toEqual('number');\n       });\n \n-      it('should get symbol for local reference of an Element', () => {\n-        const fileName = absoluteFrom('/main.ts');\n-        const {templateTypeChecker, program} = setup([\n-          {\n-            fileName,\n-            templates: {\n-              'Cmp': `\n+      describe('local reference of an Element', () => {\n+        it('checkTypeOfDomReferences = true', () => {\n+          const fileName = absoluteFrom('/main.ts');\n+          const {templateTypeChecker, program} = setup([\n+            {\n+              fileName,\n+              templates: {\n+                'Cmp': `\n                   <input #myRef>\n                   <div [input]=\"myRef\"></div>`\n+              },\n             },\n-          },\n-        ]);\n-        const sf = getSourceFileOrError(program, fileName);\n-        const cmp = getClass(sf, 'Cmp');\n-        const nodes = getAstElements(templateTypeChecker, cmp);\n+          ]);\n+          const sf = getSourceFileOrError(program, fileName);\n+          const cmp = getClass(sf, 'Cmp');\n+          const nodes = getAstElements(templateTypeChecker, cmp);\n \n-        const refSymbol = templateTypeChecker.getSymbolOfNode(nodes[0].references[0], cmp)!;\n-        assertReferenceSymbol(refSymbol);\n-        expect((refSymbol.target as TmplAstElement).name).toEqual('input');\n-        expect((refSymbol.declaration as TmplAstReference).name).toEqual('myRef');\n+          const refSymbol = templateTypeChecker.getSymbolOfNode(nodes[0].references[0], cmp)!;\n+          assertReferenceSymbol(refSymbol);\n+          expect((refSymbol.target as TmplAstElement).name).toEqual('input');\n+          expect((refSymbol.declaration as TmplAstReference).name).toEqual('myRef');\n \n-        const myRefUsage = templateTypeChecker.getSymbolOfNode(nodes[1].inputs[0].value, cmp)!;\n-        assertReferenceSymbol(myRefUsage);\n-        expect((myRefUsage.target as TmplAstElement).name).toEqual('input');\n-        expect((myRefUsage.declaration as TmplAstReference).name).toEqual('myRef');\n+          const myRefUsage = templateTypeChecker.getSymbolOfNode(nodes[1].inputs[0].value, cmp)!;\n+          assertReferenceSymbol(myRefUsage);\n+          expect((myRefUsage.target as TmplAstElement).name).toEqual('input');\n+          expect((myRefUsage.declaration as TmplAstReference).name).toEqual('myRef');\n+        });\n+\n+        it('checkTypeOfDomReferences = false', () => {\n+          const fileName = absoluteFrom('/main.ts');\n+          const {templateTypeChecker, program} = setup(\n+              [\n+                {\n+                  fileName,\n+                  templates: {\n+                    'Cmp': `\n+                  <input #myRef>\n+                  <div [input]=\"myRef\"></div>`\n+                  },\n+                },\n+              ],\n+              {checkTypeOfDomReferences: false});\n+          const sf = getSourceFileOrError(program, fileName);\n+          const cmp = getClass(sf, 'Cmp');\n+          const nodes = getAstElements(templateTypeChecker, cmp);\n+\n+          const refSymbol = templateTypeChecker.getSymbolOfNode(nodes[0].references[0], cmp);\n+          // Our desired behavior here is to honor the user's compiler settings and not produce a\n+          // symbol for the reference when `checkTypeOfDomReferences` is false.\n+          expect(refSymbol).toBeNull();\n+        });\n       });\n \n       it('should get symbols for references which refer to directives', () => {"
        }
    ],
    "stats": {
        "total": 66,
        "additions": 46,
        "deletions": 20
    }
}