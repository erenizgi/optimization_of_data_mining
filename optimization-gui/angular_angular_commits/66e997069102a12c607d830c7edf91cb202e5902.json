{
    "author": "JoostK",
    "message": "feat(ngcc): support `__read` helper as used by TypeScript 4.2 (#41201)\n\nThis commit complements the support for the `__spreadArray` helper that\nwas added in microsoft/TypeScript#41523. The prior helpers `__spread`\nand `__spreadArrays` used the `__read` helper internally, but the helper\nis now emitted as an argument to `__spreadArray` so ngcc now needs to\nsupport evaluating it statically. The real implementation of `__read`\nreads an iterable into an array, but for ngcc's static evaluation\nsupport it is sufficient to only deal with arrays as is. Additionally,\nthe optional `n` parameter is not supported as that is only emitted for\narray destructuring syntax, which ngcc does not have to support.\n\nPR Close #41201",
    "sha": "66e997069102a12c607d830c7edf91cb202e5902",
    "files": [
        {
            "sha": "7ca4d1923b5f0b5329bb5a24bcbb1bd7b7e217f9",
            "filename": "packages/compiler-cli/ngcc/src/utils.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Futils.ts",
            "raw_url": "https://github.com/angular/angular/raw/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Futils.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fngcc%2Fsrc%2Futils.ts?ref=66e997069102a12c607d830c7edf91cb202e5902",
            "patch": "@@ -163,6 +163,8 @@ export function getTsHelperFnFromIdentifier(id: ts.Identifier): KnownDeclaration\n       return KnownDeclaration.TsHelperSpreadArrays;\n     case '__spreadArray':\n       return KnownDeclaration.TsHelperSpreadArray;\n+    case '__read':\n+      return KnownDeclaration.TsHelperRead;\n     default:\n       return null;\n   }"
        },
        {
            "sha": "419fcf76d2b0c813bbc492065f87b4d87ad6673b",
            "filename": "packages/compiler-cli/ngcc/test/host/commonjs_host_spec.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fhost%2Fcommonjs_host_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fhost%2Fcommonjs_host_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fhost%2Fcommonjs_host_spec.ts?ref=66e997069102a12c607d830c7edf91cb202e5902",
            "patch": "@@ -2000,11 +2000,13 @@ exports.MissingClass2 = MissingClass2;\n               function __spread(...args) { /* ... */ }\n               function __spreadArrays(...args) { /* ... */ }\n               function __spreadArray(to, from) { /* ... */ }\n+              function __read(o) { /* ... */ }\n \n               var a = __assign({foo: 'bar'}, {baz: 'qux'});\n               var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read(['foo', 'bar']);\n             `,\n           };\n           loadTestFiles([file]);\n@@ -2021,6 +2023,7 @@ exports.MissingClass2 = MissingClass2;\n           testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize suffixed TypeScript helpers (as function declarations)', () => {\n@@ -2031,11 +2034,13 @@ exports.MissingClass2 = MissingClass2;\n               function __spread$2(...args) { /* ... */ }\n               function __spreadArrays$3(...args) { /* ... */ }\n               function __spreadArray$3(to, from) { /* ... */ }\n+              function __read$3(o) { /* ... */ }\n \n               var a = __assign$1({foo: 'bar'}, {baz: 'qux'});\n               var b = __spread$2(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays$3(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray$3(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read$3(['foo', 'bar']);\n             `,\n           };\n           loadTestFiles([file]);\n@@ -2052,6 +2057,7 @@ exports.MissingClass2 = MissingClass2;\n           testForHelper('b', '__spread$2', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays$3', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray$3', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read$3', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize TypeScript helpers (as variable declarations)', () => {\n@@ -2062,11 +2068,13 @@ exports.MissingClass2 = MissingClass2;\n               var __spread = (this && this.__spread) || function (...args) { /* ... */ }\n               var __spreadArrays = (this && this.__spreadArrays) || function (...args) { /* ... */ }\n               var __spreadArray = (this && this.__spreadArray) || function (to, from) { /* ... */ }\n+              var __read = (this && this.__read) || function (o) { /* ... */ }\n \n               var a = __assign({foo: 'bar'}, {baz: 'qux'});\n               var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read(['foo', 'bar']);\n             `,\n           };\n           loadTestFiles([file]);\n@@ -2083,6 +2091,7 @@ exports.MissingClass2 = MissingClass2;\n           testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize suffixed TypeScript helpers (as variable declarations)', () => {\n@@ -2093,11 +2102,13 @@ exports.MissingClass2 = MissingClass2;\n               var __spread$2 = (this && this.__spread$2) || function (...args) { /* ... */ }\n               var __spreadArrays$3 = (this && this.__spreadArrays$3) || function (...args) { /* ... */ }\n               var __spreadArray$3 = (this && this.__spreadArray$3) || function (to, from) { /* ... */ }\n+              var __read$3 = (this && this.__read$3) || function (o) { /* ... */ }\n \n               var a = __assign$1({foo: 'bar'}, {baz: 'qux'});\n               var b = __spread$2(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays$3(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray$3(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read$3(['foo', 'bar']);\n             `,\n           };\n           loadTestFiles([file]);\n@@ -2114,6 +2125,7 @@ exports.MissingClass2 = MissingClass2;\n           testForHelper('b', '__spread$2', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays$3', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray$3', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read$3', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize imported TypeScript helpers', () => {\n@@ -2127,6 +2139,7 @@ exports.MissingClass2 = MissingClass2;\n                 var b = tslib_1.__spread(['foo', 'bar'], ['baz', 'qux']);\n                 var c = tslib_1.__spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n                 var d = tslib_1.__spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+                var e = tslib_1.__read(['foo', 'bar']);\n               `,\n             },\n             {\n@@ -2136,6 +2149,7 @@ exports.MissingClass2 = MissingClass2;\n                 export declare function __spread(...args: any[][]): any[];\n                 export declare function __spreadArrays(...args: any[][]): any[];\n                 export declare function __spreadArray(to: any[], from: any[]): any[];\n+                export declare function __read(o: any, n?: number): any[];\n               `,\n             },\n           ];\n@@ -2155,6 +2169,7 @@ exports.MissingClass2 = MissingClass2;\n           testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread, 'tslib');\n           testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays, 'tslib');\n           testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray, 'tslib');\n+          testForHelper('e', '__read', KnownDeclaration.TsHelperRead, 'tslib');\n         });\n \n         it('should recognize undeclared, unimported TypeScript helpers (by name)', () => {\n@@ -2165,6 +2180,7 @@ exports.MissingClass2 = MissingClass2;\n               var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read(['foo', 'bar']);\n             `,\n           };\n           loadTestFiles([file]);\n@@ -2191,6 +2207,7 @@ exports.MissingClass2 = MissingClass2;\n           testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize suffixed, undeclared, unimported TypeScript helpers (by name)', () => {\n@@ -2201,6 +2218,7 @@ exports.MissingClass2 = MissingClass2;\n               var b = __spread$2(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays$3(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray$3(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read$3(['foo', 'bar']);\n             `,\n           };\n           loadTestFiles([file]);\n@@ -2227,6 +2245,7 @@ exports.MissingClass2 = MissingClass2;\n           testForHelper('b', '__spread$2', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays$3', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray$3', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read$3', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize enum declarations with string values', () => {\n@@ -2461,6 +2480,7 @@ exports.MissingClass2 = MissingClass2;\n               export declare function __spread(...args: any[][]): any[];\n               export declare function __spreadArrays(...args: any[][]): any[];\n               export declare function __spreadArray(to: any[], from: any[]): any[];\n+              export declare function __read(o: any, n?: number): any[];\n               export declare function __unknownHelper(...args: any[]): any;\n             `,\n           };\n@@ -2477,6 +2497,7 @@ exports.MissingClass2 = MissingClass2;\n                 ['__spread', KnownDeclaration.TsHelperSpread],\n                 ['__spreadArrays', KnownDeclaration.TsHelperSpreadArrays],\n                 ['__spreadArray', KnownDeclaration.TsHelperSpreadArray],\n+                ['__read', KnownDeclaration.TsHelperRead],\n                 ['__unknownHelper', null],\n               ]);\n         });"
        },
        {
            "sha": "4595d7db56da434d417f66accbcb1eccc07090d1",
            "filename": "packages/compiler-cli/ngcc/test/host/esm5_host_spec.ts",
            "status": "modified",
            "additions": 25,
            "deletions": 1,
            "changes": 26,
            "blob_url": "https://github.com/angular/angular/blob/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fhost%2Fesm5_host_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fhost%2Fesm5_host_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fhost%2Fesm5_host_spec.ts?ref=66e997069102a12c607d830c7edf91cb202e5902",
            "patch": "@@ -2060,11 +2060,13 @@ runInEachFileSystem(() => {\n             function __spread(...args) { /* ... */ }\n             function __spreadArrays(...args) { /* ... */ }\n             function __spreadArray(to, from) { /* ... */ }\n+            function __read(o) { /* ... */ }\n \n             var a = __assign({foo: 'bar'}, {baz: 'qux'});\n             var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n             var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n             var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+            var e = __read(['foo', 'bar']);\n           `,\n         };\n         loadTestFiles([file]);\n@@ -2080,6 +2082,7 @@ runInEachFileSystem(() => {\n         testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread);\n         testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays);\n         testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray);\n+        testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n       });\n \n       it('should recognize suffixed TypeScript helpers (as function declarations)', () => {\n@@ -2090,11 +2093,13 @@ runInEachFileSystem(() => {\n             function __spread$2(...args) { /* ... */ }\n             function __spreadArrays$3(...args) { /* ... */ }\n             function __spreadArray$3(to, from) { /* ... */ }\n+            function __read$3(o) { /* ... */ }\n \n             var a = __assign$1({foo: 'bar'}, {baz: 'qux'});\n             var b = __spread$2(['foo', 'bar'], ['baz', 'qux']);\n             var c = __spreadArrays$3(['foo', 'bar'], ['baz', 'qux']);\n             var d = __spreadArray$3(['foo', 'bar'], ['baz', 'qux']);\n+            var e = __read$3(['foo', 'bar']);\n           `,\n         };\n         loadTestFiles([file]);\n@@ -2110,6 +2115,7 @@ runInEachFileSystem(() => {\n         testForHelper('b', '__spread$2', KnownDeclaration.TsHelperSpread);\n         testForHelper('c', '__spreadArrays$3', KnownDeclaration.TsHelperSpreadArrays);\n         testForHelper('d', '__spreadArray$3', KnownDeclaration.TsHelperSpreadArray);\n+        testForHelper('e', '__read$3', KnownDeclaration.TsHelperRead);\n       });\n \n       it('should recognize TypeScript helpers (as variable declarations)', () => {\n@@ -2120,11 +2126,13 @@ runInEachFileSystem(() => {\n             var __spread = (this && this.__spread) || function (...args) { /* ... */ }\n             var __spreadArrays = (this && this.__spreadArrays) || function (...args) { /* ... */ }\n             var __spreadArray = (this && this.__spreadArray) || function (to, from) { /* ... */ }\n+            var __read = (this && this._read) || function (o) { /* ... */ }\n \n             var a = __assign({foo: 'bar'}, {baz: 'qux'});\n             var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n             var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n             var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+            var e = __read(['foo', 'bar']);\n        `,\n         };\n         loadTestFiles([file]);\n@@ -2140,6 +2148,7 @@ runInEachFileSystem(() => {\n         testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread);\n         testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays);\n         testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray);\n+        testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n       });\n \n       it('should recognize suffixed TypeScript helpers (as variable declarations)', () => {\n@@ -2150,11 +2159,13 @@ runInEachFileSystem(() => {\n             var __spread$2 = (this && this.__spread$2) || function (...args) { /* ... */ }\n             var __spreadArrays$3 = (this && this.__spreadArrays$3) || function (...args) { /* ... */ }\n             var __spreadArray$3 = (this && this.__spreadArray$3) || function (to, from) { /* ... */ }\n+            var __read$3 = (this && this.__read$3) || function (o) { /* ... */ }\n \n             var a = __assign$1({foo: 'bar'}, {baz: 'qux'});\n             var b = __spread$2(['foo', 'bar'], ['baz', 'qux']);\n             var c = __spreadArrays$3(['foo', 'bar'], ['baz', 'qux']);\n             var d = __spreadArray$3(['foo', 'bar'], ['baz', 'qux']);\n+            var e = __read$3(['foo', 'bar']);\n           `,\n         };\n         loadTestFiles([file]);\n@@ -2170,19 +2181,21 @@ runInEachFileSystem(() => {\n         testForHelper('b', '__spread$2', KnownDeclaration.TsHelperSpread);\n         testForHelper('c', '__spreadArrays$3', KnownDeclaration.TsHelperSpreadArrays);\n         testForHelper('d', '__spreadArray$3', KnownDeclaration.TsHelperSpreadArray);\n+        testForHelper('e', '__read$3', KnownDeclaration.TsHelperRead);\n       });\n \n       it('should recognize imported TypeScript helpers (named imports)', () => {\n         const files: TestFile[] = [\n           {\n             name: _('/test.js'),\n             contents: `\n-              import {__assign, __spread, __spreadArrays, __spreadArray} from 'tslib';\n+              import {__assign, __spread, __spreadArrays, __spreadArray, __read} from 'tslib';\n \n               var a = __assign({foo: 'bar'}, {baz: 'qux'});\n               var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read(['foo', 'bar']);\n             `,\n           },\n           {\n@@ -2192,6 +2205,7 @@ runInEachFileSystem(() => {\n               export declare function __spread(...args: any[][]): any[];\n               export declare function __spreadArrays(...args: any[][]): any[];\n               export declare function __spreadArray(to: any[], from: any[]): any[];\n+              export declare function __read(o: any, n?: number): any[];\n             `,\n           },\n         ];\n@@ -2210,6 +2224,7 @@ runInEachFileSystem(() => {\n         testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread, 'tslib');\n         testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays, 'tslib');\n         testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray, 'tslib');\n+        testForHelper('e', '__read', KnownDeclaration.TsHelperRead, 'tslib');\n       });\n \n       it('should recognize imported TypeScript helpers (star import)', () => {\n@@ -2223,6 +2238,7 @@ runInEachFileSystem(() => {\n               var b = tslib_1.__spread(['foo', 'bar'], ['baz', 'qux']);\n               var c = tslib_1.__spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n               var d = tslib_1.__spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+              var e = tslib_1.__read(['foo', 'bar']);\n             `,\n           },\n           {\n@@ -2232,6 +2248,7 @@ runInEachFileSystem(() => {\n               export declare function __spread(...args: any[][]): any[];\n               export declare function __spreadArrays(...args: any[][]): any[];\n               export declare function __spreadArray(to: any[], from: any[]): any[];\n+              export declare function __read(o: any, n?: number): any[];\n             `,\n           },\n         ];\n@@ -2250,6 +2267,7 @@ runInEachFileSystem(() => {\n         testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread, 'tslib');\n         testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays, 'tslib');\n         testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray, 'tslib');\n+        testForHelper('e', '__read', KnownDeclaration.TsHelperRead, 'tslib');\n       });\n \n       it('should recognize undeclared, unimported TypeScript helpers (by name)', () => {\n@@ -2260,6 +2278,7 @@ runInEachFileSystem(() => {\n             var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n             var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n             var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+            var e = __read(['foo', 'bar']);\n           `,\n         };\n         loadTestFiles([file]);\n@@ -2283,6 +2302,7 @@ runInEachFileSystem(() => {\n         testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread);\n         testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays);\n         testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray);\n+        testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n       });\n \n       it('should recognize suffixed, undeclared, unimported TypeScript helpers (by name)', () => {\n@@ -2293,6 +2313,7 @@ runInEachFileSystem(() => {\n             var b = __spread$2(['foo', 'bar'], ['baz', 'qux']);\n             var c = __spreadArrays$3(['foo', 'bar'], ['baz', 'qux']);\n             var d = __spreadArray$3(['foo', 'bar'], ['baz', 'qux']);\n+            var e = __read$3(['foo', 'bar']);\n           `,\n         };\n         loadTestFiles([file]);\n@@ -2316,6 +2337,7 @@ runInEachFileSystem(() => {\n         testForHelper('b', '__spread$2', KnownDeclaration.TsHelperSpread);\n         testForHelper('c', '__spreadArrays$3', KnownDeclaration.TsHelperSpreadArrays);\n         testForHelper('d', '__spreadArray$3', KnownDeclaration.TsHelperSpreadArray);\n+        testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n       });\n \n       it('should recognize enum declarations with string values', () => {\n@@ -2479,6 +2501,7 @@ runInEachFileSystem(() => {\n             export declare function __spread(...args: any[][]): any[];\n             export declare function __spreadArrays(...args: any[][]): any[];\n             export declare function __spreadArray(to: any[], from: any[]): any[];\n+            export declare function __read(o: any, n?: number): any[];\n             export declare function __unknownHelper(...args: any[]): any;\n           `,\n         };\n@@ -2494,6 +2517,7 @@ runInEachFileSystem(() => {\n               ['__spread', KnownDeclaration.TsHelperSpread],\n               ['__spreadArrays', KnownDeclaration.TsHelperSpreadArrays],\n               ['__spreadArray', KnownDeclaration.TsHelperSpreadArray],\n+              ['__read', KnownDeclaration.TsHelperRead],\n               ['__unknownHelper', null],\n             ]);\n       });"
        },
        {
            "sha": "359219cbdfd520c5b106f101c959619347c73640",
            "filename": "packages/compiler-cli/ngcc/test/host/umd_host_spec.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fhost%2Fumd_host_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fhost%2Fumd_host_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fngcc%2Ftest%2Fhost%2Fumd_host_spec.ts?ref=66e997069102a12c607d830c7edf91cb202e5902",
            "patch": "@@ -2332,11 +2332,13 @@ runInEachFileSystem(() => {\n               function __spread(...args) { /* ... */ }\n               function __spreadArrays(...args) { /* ... */ }\n               function __spreadArray(to, from) { /* ... */ }\n+              function __read(o) { /* ... */ }\n \n               var a = __assign({foo: 'bar'}, {baz: 'qux'});\n               var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read(['foo', 'bar']);\n             })));\n           `,\n           };\n@@ -2352,6 +2354,7 @@ runInEachFileSystem(() => {\n           testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize suffixed TypeScript helpers (as function declarations)', () => {\n@@ -2367,11 +2370,13 @@ runInEachFileSystem(() => {\n               function __spread$2(...args) { /* ... */ }\n               function __spreadArrays$3(...args) { /* ... */ }\n               function __spreadArray$3(to, from) { /* ... */ }\n+              function __read$3(o) { /* ... */ }\n \n               var a = __assign$1({foo: 'bar'}, {baz: 'qux'});\n               var b = __spread$2(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays$3(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray$3(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read$3(['foo', 'bar']);\n             })));\n           `,\n           };\n@@ -2387,6 +2392,7 @@ runInEachFileSystem(() => {\n           testForHelper('b', '__spread$2', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays$3', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray$3', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read$3', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize TypeScript helpers (as variable declarations)', () => {\n@@ -2402,11 +2408,13 @@ runInEachFileSystem(() => {\n               var __spread = (this && this.__spread) || function (...args) { /* ... */ }\n               var __spreadArrays = (this && this.__spreadArrays) || function (...args) { /* ... */ }\n               var __spreadArray = (this && this.__spreadArray) || function (to, from) { /* ... */ }\n+              var __read = (this && this.__read) || function (o) { /* ... */ }\n \n               var a = __assign({foo: 'bar'}, {baz: 'qux'});\n               var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read(['foo', 'bar']);\n             })));\n           `,\n           };\n@@ -2422,6 +2430,7 @@ runInEachFileSystem(() => {\n           testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize suffixed TypeScript helpers (as variable declarations)', () => {\n@@ -2437,11 +2446,13 @@ runInEachFileSystem(() => {\n               var __spread$2 = (this && this.__spread$2) || function (...args) { /* ... */ }\n               var __spreadArrays$3 = (this && this.__spreadArrays$3) || function (...args) { /* ... */ }\n               var __spreadArray$3 = (this && this.__spreadArray$3) || function (to, from) { /* ... */ }\n+              var __read$3 = (this && this.__read$3) || function (o) { /* ... */ }\n \n               var a = __assign$1({foo: 'bar'}, {baz: 'qux'});\n               var b = __spread$2(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays$3(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray$3(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read$3(['foo', 'bar']);\n             })));\n           `,\n           };\n@@ -2457,6 +2468,7 @@ runInEachFileSystem(() => {\n           testForHelper('b', '__spread$2', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays$3', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray$3', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read$3', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize imported TypeScript helpers', () => {\n@@ -2473,6 +2485,7 @@ runInEachFileSystem(() => {\n                 var b = tslib_1.__spread(['foo', 'bar'], ['baz', 'qux']);\n                 var c = tslib_1.__spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n                 var d = tslib_1.__spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+                var e = tslib_1.__read(['foo', 'bar']);\n               })));\n             `,\n             },\n@@ -2483,6 +2496,7 @@ runInEachFileSystem(() => {\n               export declare function __spread(...args: any[][]): any[];\n               export declare function __spreadArrays(...args: any[][]): any[];\n               export declare function __spreadArray(to: any[], from: any[]): any[];\n+              export declare function __read(o: any, n?: number): any[];\n             `,\n             },\n           ];\n@@ -2502,6 +2516,7 @@ runInEachFileSystem(() => {\n           testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread, 'tslib');\n           testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays, 'tslib');\n           testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray, 'tslib');\n+          testForHelper('e', '__read', KnownDeclaration.TsHelperRead, 'tslib');\n         });\n \n         it('should recognize undeclared, unimported TypeScript helpers (by name)', () => {\n@@ -2517,6 +2532,7 @@ runInEachFileSystem(() => {\n               var b = __spread(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read(['foo', 'bar']);\n             })));\n           `,\n           };\n@@ -2544,6 +2560,7 @@ runInEachFileSystem(() => {\n           testForHelper('b', '__spread', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize suffixed, undeclared, unimported TypeScript helpers (by name)', () => {\n@@ -2559,6 +2576,7 @@ runInEachFileSystem(() => {\n               var b = __spread$2(['foo', 'bar'], ['baz', 'qux']);\n               var c = __spreadArrays$3(['foo', 'bar'], ['baz', 'qux']);\n               var d = __spreadArray$3(['foo', 'bar'], ['baz', 'qux']);\n+              var e = __read$3(['foo', 'bar']);\n             })));\n           `,\n           };\n@@ -2586,6 +2604,7 @@ runInEachFileSystem(() => {\n           testForHelper('b', '__spread$2', KnownDeclaration.TsHelperSpread);\n           testForHelper('c', '__spreadArrays$3', KnownDeclaration.TsHelperSpreadArrays);\n           testForHelper('d', '__spreadArray$3', KnownDeclaration.TsHelperSpreadArray);\n+          testForHelper('e', '__read$3', KnownDeclaration.TsHelperRead);\n         });\n \n         it('should recognize enum declarations with string values', () => {\n@@ -2861,6 +2880,7 @@ runInEachFileSystem(() => {\n             export declare function __spread(...args: any[][]): any[];\n             export declare function __spreadArrays(...args: any[][]): any[];\n             export declare function __spreadArray(to: any[], from: any[]): any[];\n+            export declare function __read(o: any, n?: number): any[];\n             export declare function __unknownHelper(...args: any[]): any;\n           `,\n           };\n@@ -2876,6 +2896,7 @@ runInEachFileSystem(() => {\n                 ['__spread', KnownDeclaration.TsHelperSpread],\n                 ['__spreadArrays', KnownDeclaration.TsHelperSpreadArrays],\n                 ['__spreadArray', KnownDeclaration.TsHelperSpreadArray],\n+                ['__read', KnownDeclaration.TsHelperRead],\n                 ['__unknownHelper', null],\n               ]);\n         });"
        },
        {
            "sha": "f17e38648b32669c5e521dd6cfc3dca9fa1db4e6",
            "filename": "packages/compiler-cli/src/ngtsc/partial_evaluator/src/known_declaration.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fpartial_evaluator%2Fsrc%2Fknown_declaration.ts",
            "raw_url": "https://github.com/angular/angular/raw/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fpartial_evaluator%2Fsrc%2Fknown_declaration.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fpartial_evaluator%2Fsrc%2Fknown_declaration.ts?ref=66e997069102a12c607d830c7edf91cb202e5902",
            "patch": "@@ -10,7 +10,7 @@ import {KnownDeclaration} from '../../reflection/src/host';\n \n import {ObjectAssignBuiltinFn} from './builtin';\n import {ResolvedValue} from './result';\n-import {AssignHelperFn, SpreadArrayHelperFn, SpreadHelperFn} from './ts_helpers';\n+import {AssignHelperFn, ReadHelperFn, SpreadArrayHelperFn, SpreadHelperFn} from './ts_helpers';\n \n /** Resolved value for the JavaScript global `Object` declaration. */\n export const jsGlobalObjectValue = new Map([['assign', new ObjectAssignBuiltinFn()]]);\n@@ -24,6 +24,9 @@ const spreadTsHelperFn = new SpreadHelperFn();\n /** Resolved value for the `__spreadArray()` TypeScript helper declarations. */\n const spreadArrayTsHelperFn = new SpreadArrayHelperFn();\n \n+/** Resolved value for the `__read()` TypeScript helper declarations. */\n+const readTsHelperFn = new ReadHelperFn();\n+\n /**\n  * Resolves the specified known declaration to a resolved value. For example,\n  * the known JavaScript global `Object` will resolve to a `Map` that provides the\n@@ -40,6 +43,8 @@ export function resolveKnownDeclaration(decl: KnownDeclaration): ResolvedValue {\n       return spreadTsHelperFn;\n     case KnownDeclaration.TsHelperSpreadArray:\n       return spreadArrayTsHelperFn;\n+    case KnownDeclaration.TsHelperRead:\n+      return readTsHelperFn;\n     default:\n       throw new Error(`Cannot resolve known declaration. Received: ${KnownDeclaration[decl]}.`);\n   }"
        },
        {
            "sha": "109ef11292884f9adf998355eb8b0209ecc7a32d",
            "filename": "packages/compiler-cli/src/ngtsc/partial_evaluator/src/ts_helpers.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fpartial_evaluator%2Fsrc%2Fts_helpers.ts",
            "raw_url": "https://github.com/angular/angular/raw/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fpartial_evaluator%2Fsrc%2Fts_helpers.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fpartial_evaluator%2Fsrc%2Fts_helpers.ts?ref=66e997069102a12c607d830c7edf91cb202e5902",
            "patch": "@@ -59,3 +59,24 @@ export class SpreadArrayHelperFn extends KnownFn {\n     return to.concat(from);\n   }\n }\n+\n+// Used for `__read` TypeScript helper function.\n+export class ReadHelperFn extends KnownFn {\n+  evaluate(node: ts.Node, args: ResolvedValueArray): ResolvedValue {\n+    if (args.length !== 1) {\n+      // The `__read` helper accepts a second argument `n` but that case is not supported.\n+      return DynamicValue.fromUnknown(node);\n+    }\n+\n+    const [value] = args;\n+    if (value instanceof DynamicValue) {\n+      return DynamicValue.fromDynamicInput(node, value);\n+    }\n+\n+    if (!Array.isArray(value)) {\n+      return DynamicValue.fromInvalidExpressionType(node, value);\n+    }\n+\n+    return value;\n+  }\n+}"
        },
        {
            "sha": "e597f6d0f303206e2dbb33c21b2f4606998d7477",
            "filename": "packages/compiler-cli/src/ngtsc/partial_evaluator/test/evaluator_spec.ts",
            "status": "modified",
            "additions": 47,
            "deletions": 0,
            "changes": 47,
            "blob_url": "https://github.com/angular/angular/blob/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fpartial_evaluator%2Ftest%2Fevaluator_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fpartial_evaluator%2Ftest%2Fevaluator_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fpartial_evaluator%2Ftest%2Fevaluator_spec.ts?ref=66e997069102a12c607d830c7edf91cb202e5902",
            "patch": "@@ -647,6 +647,7 @@ runInEachFileSystem(() => {\n               export declare function __spread(...args: any[][]): any[];\n               export declare function __spreadArrays(...args: any[][]): any[];\n               export declare function __spreadArray(to: any[], from: any[]): any[];\n+              export declare function __read(o: any, n?: number): any[];\n             `,\n           },\n         ]);\n@@ -758,6 +759,28 @@ runInEachFileSystem(() => {\n \n         expect(arr).toEqual([4, 5, 6]);\n       });\n+\n+      it('should evaluate `__read()` (named import)', () => {\n+        const arr: number[] = evaluateExpression(\n+            `\n+              import {__read} from 'tslib';\n+              const a = [5, 6];\n+            `,\n+            '__read(a)');\n+\n+        expect(arr).toEqual([5, 6]);\n+      });\n+\n+      it('should evaluate `__read()` (star import)', () => {\n+        const arr: number[] = evaluateExpression(\n+            `\n+              import * as tslib from 'tslib';\n+              const a = [5, 6];\n+            `,\n+            'tslib.__read(a)');\n+\n+        expect(arr).toEqual([5, 6]);\n+      });\n     });\n \n     describe('(with emitted TypeScript helpers as functions)', () => {\n@@ -768,6 +791,7 @@ runInEachFileSystem(() => {\n           function __spread(...args) { /* ... */ }\n           function __spreadArrays(...args) { /* ... */ }\n           function __spreadArray(to, from) { /* ... */ }\n+          function __read(o) { /* ... */ }\n         `;\n         const {checker, expression} = makeExpression(helpers + code, expr);\n \n@@ -823,6 +847,16 @@ runInEachFileSystem(() => {\n \n         expect(arr).toEqual([4, 5, 6]);\n       });\n+\n+      it('should evaluate `__read()`', () => {\n+        const arr: number[] = evaluateExpression(\n+            `\n+              const a = [5, 6];\n+            `,\n+            '__read(a)');\n+\n+        expect(arr).toEqual([5, 6]);\n+      });\n     });\n \n     describe('(with emitted TypeScript helpers as variables)', () => {\n@@ -833,6 +867,7 @@ runInEachFileSystem(() => {\n           var __spread = (this && this.__spread) || function (...args) { /* ... */ }\n           var __spreadArrays = (this && this.__spreadArrays) || function (...args) { /* ... */ }\n           var __spreadArray = (this && this.__spreadArray) || function (to, from) { /* ... */ }\n+          var __read = (this && this.__read) || function (o) { /* ... */ }\n         `;\n         const {checker, expression} = makeExpression(helpers + code, expr);\n \n@@ -888,6 +923,16 @@ runInEachFileSystem(() => {\n \n         expect(arr).toEqual([4, 5, 6]);\n       });\n+\n+      it('should evaluate `__read()`', () => {\n+        const arr: number[] = evaluateExpression(\n+            `\n+              const a = [5, 6];\n+            `,\n+            '__read(a)');\n+\n+        expect(arr).toEqual([5, 6]);\n+      });\n     });\n \n     describe('(visited file tracking)', () => {\n@@ -1031,6 +1076,8 @@ runInEachFileSystem(() => {\n         return KnownDeclaration.TsHelperSpreadArrays;\n       case '__spreadArray':\n         return KnownDeclaration.TsHelperSpreadArray;\n+      case '__read':\n+        return KnownDeclaration.TsHelperRead;\n       default:\n         return null;\n     }"
        },
        {
            "sha": "7b6adeadbb65d943414b19162ce667fcc6cb5087",
            "filename": "packages/compiler-cli/src/ngtsc/reflection/src/host.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Fhost.ts",
            "raw_url": "https://github.com/angular/angular/raw/66e997069102a12c607d830c7edf91cb202e5902/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Fhost.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Freflection%2Fsrc%2Fhost.ts?ref=66e997069102a12c607d830c7edf91cb202e5902",
            "patch": "@@ -479,6 +479,11 @@ export enum KnownDeclaration {\n    * Indicates the `__spreadArray` TypeScript helper function.\n    */\n   TsHelperSpreadArray,\n+\n+  /**\n+   * Indicates the `__read` TypeScript helper function.\n+   */\n+  TsHelperRead,\n }\n \n /**"
        }
    ],
    "stats": {
        "total": 150,
        "additions": 148,
        "deletions": 2
    }
}