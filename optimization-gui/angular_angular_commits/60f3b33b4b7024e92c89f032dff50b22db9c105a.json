{
    "author": "AndrewKushnir",
    "message": "Revert \"fix(compiler): support i18n interpolated only attribute bindings (#43815)\" (#43882)\n\nThis reverts commit bba0a8705548f16b4db3b88d03deb6e67a85e414.\n\nThe reason for rollback: this change is breaking some targets in Google's codebase when there is no attribute value is displayed (attr.aria-label) when translated.\n\nPR Close #43882",
    "sha": "60f3b33b4b7024e92c89f032dff50b22db9c105a",
    "files": [
        {
            "sha": "a43dd277b0acd856293860c28bec27816e690b01",
            "filename": "packages/compiler-cli/test/compliance/test_cases/r3_view_compiler_i18n/element_attributes/GOLDEN_PARTIAL.js",
            "status": "modified",
            "additions": 0,
            "deletions": 60,
            "changes": 60,
            "blob_url": "https://github.com/angular/angular/blob/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2FGOLDEN_PARTIAL.js",
            "raw_url": "https://github.com/angular/angular/raw/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2FGOLDEN_PARTIAL.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2FGOLDEN_PARTIAL.js?ref=60f3b33b4b7024e92c89f032dff50b22db9c105a",
            "patch": "@@ -358,66 +358,6 @@ export declare class MyModule {\n     static ɵinj: i0.ɵɵInjectorDeclaration<MyModule>;\n }\n \n-/****************************************************************************************************\n- * PARTIAL FILE: interpolated_attributes.js\n- ****************************************************************************************************/\n-import { Component, NgModule } from '@angular/core';\n-import * as i0 from \"@angular/core\";\n-export class MyComponent {\n-    constructor() {\n-        this.name = 'Angular';\n-    }\n-}\n-MyComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"0.0.0-PLACEHOLDER\", ngImport: i0, type: MyComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });\n-MyComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: \"12.0.0\", version: \"0.0.0-PLACEHOLDER\", type: MyComponent, selector: \"my-component\", ngImport: i0, template: `\n-  <div\n-  title=\"title {{name}}\" i18n-title\n-  attr.label=\"label {{name}}\" i18n-label=\"@@id1\"\n-  attr.lang=\"lang {{name}}\" i18n-attr.lang=\"@@id2\"\n-  attr.dir=\"dir {{name}}\" i18n-attr.dir=\"@@id3\" i18n-dir=\"@@id4\"\n-  attr.draggable=\"draggable {{name}}\" i18n-draggable=\"@@id5\" i18n-attr.draggable=\"@@id6\">\n-  </div>\n-  `, isInline: true });\n-i0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"0.0.0-PLACEHOLDER\", ngImport: i0, type: MyComponent, decorators: [{\n-            type: Component,\n-            args: [{\n-                    selector: 'my-component',\n-                    template: `\n-  <div\n-  title=\"title {{name}}\" i18n-title\n-  attr.label=\"label {{name}}\" i18n-label=\"@@id1\"\n-  attr.lang=\"lang {{name}}\" i18n-attr.lang=\"@@id2\"\n-  attr.dir=\"dir {{name}}\" i18n-attr.dir=\"@@id3\" i18n-dir=\"@@id4\"\n-  attr.draggable=\"draggable {{name}}\" i18n-draggable=\"@@id5\" i18n-attr.draggable=\"@@id6\">\n-  </div>\n-  `\n-                }]\n-        }] });\n-export class MyModule {\n-}\n-MyModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"0.0.0-PLACEHOLDER\", ngImport: i0, type: MyModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\n-MyModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"12.0.0\", version: \"0.0.0-PLACEHOLDER\", ngImport: i0, type: MyModule, declarations: [MyComponent] });\n-MyModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"0.0.0-PLACEHOLDER\", ngImport: i0, type: MyModule });\n-i0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"0.0.0-PLACEHOLDER\", ngImport: i0, type: MyModule, decorators: [{\n-            type: NgModule,\n-            args: [{ declarations: [MyComponent] }]\n-        }] });\n-\n-/****************************************************************************************************\n- * PARTIAL FILE: interpolated_attributes.d.ts\n- ****************************************************************************************************/\n-import * as i0 from \"@angular/core\";\n-export declare class MyComponent {\n-    name: string;\n-    static ɵfac: i0.ɵɵFactoryDeclaration<MyComponent, never>;\n-    static ɵcmp: i0.ɵɵComponentDeclaration<MyComponent, \"my-component\", never, {}, {}, never, never>;\n-}\n-export declare class MyModule {\n-    static ɵfac: i0.ɵɵFactoryDeclaration<MyModule, never>;\n-    static ɵmod: i0.ɵɵNgModuleDeclaration<MyModule, [typeof MyComponent], never, never>;\n-    static ɵinj: i0.ɵɵInjectorDeclaration<MyModule>;\n-}\n-\n /****************************************************************************************************\n  * PARTIAL FILE: static_attributes.js\n  ****************************************************************************************************/"
        },
        {
            "sha": "6d84fd7bcc65dacb7ce866d52bdb743697eba540",
            "filename": "packages/compiler-cli/test/compliance/test_cases/r3_view_compiler_i18n/element_attributes/TEST_CASES.json",
            "status": "modified",
            "additions": 0,
            "deletions": 14,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2FTEST_CASES.json",
            "raw_url": "https://github.com/angular/angular/raw/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2FTEST_CASES.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2FTEST_CASES.json?ref=60f3b33b4b7024e92c89f032dff50b22db9c105a",
            "patch": "@@ -99,20 +99,6 @@\n         }\n       ]\n     },\n-    {\n-      \"description\": \"should create translations for interpolated attributes\",\n-      \"inputFiles\": [\n-        \"interpolated_attributes.ts\"\n-      ],\n-      \"expectations\": [\n-        {\n-          \"extraChecks\": [\n-            \"verifyPlaceholdersIntegrity\",\n-            \"verifyUniqueConsts\"\n-          ]\n-        }\n-      ]\n-    },\n     {\n       \"description\": \"should translate static attributes\",\n       \"inputFiles\": ["
        },
        {
            "sha": "d4953741084f0fd99e31e87875f4ce431dd5b388",
            "filename": "packages/compiler-cli/test/compliance/test_cases/r3_view_compiler_i18n/element_attributes/interpolated_attributes.js",
            "status": "removed",
            "additions": 0,
            "deletions": 21,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/c944fee11b27b5f487927cf23eea4d5f04bb4463/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2Finterpolated_attributes.js",
            "raw_url": "https://github.com/angular/angular/raw/c944fee11b27b5f487927cf23eea4d5f04bb4463/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2Finterpolated_attributes.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2Finterpolated_attributes.js?ref=c944fee11b27b5f487927cf23eea4d5f04bb4463",
            "patch": "@@ -1,21 +0,0 @@\n-consts: function () {\n-  __i18nMsg__('title {$interpolation}', [['interpolation', String.raw`\\uFFFD0\\uFFFD`]], {})\n-  __i18nMsg__('label {$interpolation}', [['interpolation', String.raw`\\uFFFD0\\uFFFD`]], {id: 'id1'})\n-  __i18nMsg__('lang {$interpolation}', [['interpolation', String.raw`\\uFFFD0\\uFFFD`]], {id: 'id2'})\n-  __i18nMsg__('dir {$interpolation}', [['interpolation', String.raw`\\uFFFD0\\uFFFD`]], {id: 'id3'})\n-  __i18nMsg__('draggable {$interpolation}', [['interpolation', String.raw`\\uFFFD0\\uFFFD`]], {id: 'id6'})\n-  return [\n-    [6, \"title\", \"label\", \"lang\", \"dir\", \"draggable\"], [\"title\", $i18n_1$, \"label\", $i18n_2$, \"lang\", $i18n_3$, \"dir\", $i18n_4$, \"draggable\", $i18n_5$]\n-  ];\n-},\n-template: function MyComponent_Template(rf, ctx) {\n-  if (rf & 1) {\n-    i0.ɵɵelementStart(0, \"div\", 0);\n-    i0.ɵɵi18nAttributes(1, 1);\n-    i0.ɵɵelementEnd();\n-  }\n-  if (rf & 2) {\n-    i0.ɵɵi18nExp(ctx.name)(ctx.name)(ctx.name)(ctx.name)(ctx.name);\n-    i0.ɵɵi18nApply(1);\n-  }\n-}"
        },
        {
            "sha": "e641fd48e45d19a0f72b4d39118300fbc56a749a",
            "filename": "packages/compiler-cli/test/compliance/test_cases/r3_view_compiler_i18n/element_attributes/interpolated_attributes.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 21,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/c944fee11b27b5f487927cf23eea4d5f04bb4463/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2Finterpolated_attributes.ts",
            "raw_url": "https://github.com/angular/angular/raw/c944fee11b27b5f487927cf23eea4d5f04bb4463/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2Finterpolated_attributes.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Ftest_cases%2Fr3_view_compiler_i18n%2Felement_attributes%2Finterpolated_attributes.ts?ref=c944fee11b27b5f487927cf23eea4d5f04bb4463",
            "patch": "@@ -1,21 +0,0 @@\n-import {Component, NgModule} from '@angular/core';\n-\n-@Component({\n-  selector: 'my-component',\n-  template: `\n-  <div\n-  title=\"title {{name}}\" i18n-title\n-  attr.label=\"label {{name}}\" i18n-label=\"@@id1\"\n-  attr.lang=\"lang {{name}}\" i18n-attr.lang=\"@@id2\"\n-  attr.dir=\"dir {{name}}\" i18n-attr.dir=\"@@id3\" i18n-dir=\"@@id4\"\n-  attr.draggable=\"draggable {{name}}\" i18n-draggable=\"@@id5\" i18n-attr.draggable=\"@@id6\">\n-  </div>\n-  `\n-})\n-export class MyComponent {\n-  name = 'Angular';\n-}\n-\n-@NgModule({declarations: [MyComponent]})\n-export class MyModule {\n-}"
        },
        {
            "sha": "d4e229eb35c89b4a6d74ae624d150c5a19ef7868",
            "filename": "packages/compiler/src/render3/view/i18n/meta.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 6,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fi18n%2Fmeta.ts",
            "raw_url": "https://github.com/angular/angular/raw/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fi18n%2Fmeta.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fi18n%2Fmeta.ts?ref=60f3b33b4b7024e92c89f032dff50b22db9c105a",
            "patch": "@@ -16,7 +16,7 @@ import {ParseTreeResult} from '../../../ml_parser/parser';\n import * as o from '../../../output/output_ast';\n import {isTrustedTypesSink} from '../../../schema/trusted_types_sinks';\n \n-import {ATTR_BINDING_MATCHER, hasI18nAttrs, I18N_ATTR, I18N_ATTR_PREFIX, icuFromI18nMessage} from './util';\n+import {hasI18nAttrs, I18N_ATTR, I18N_ATTR_PREFIX, icuFromI18nMessage} from './util';\n \n export type I18nMeta = {\n   id?: string,\n@@ -83,7 +83,7 @@ export class I18nMetaVisitor implements html.Visitor {\n \n       for (const attr of element.attrs) {\n         if (attr.name === I18N_ATTR) {\n-          // 'i18n' attribute that marks the element contents as an i18n message\n+          // root 'i18n' node attribute\n           const i18n = element.i18n || attr.value;\n           message = this._generateI18nMessage(element.children, i18n, setI18nRefs);\n           if (message.nodes.length === 0) {\n@@ -110,10 +110,7 @@ export class I18nMetaVisitor implements html.Visitor {\n       // set i18n meta for attributes\n       if (Object.keys(attrsMeta).length) {\n         for (const attr of attrs) {\n-          // First try to match the metadata to the attribute name as-is.\n-          // If that cannot be found try removing any `attr.` prefix from the attribute name.\n-          const meta =\n-              attrsMeta[attr.name] ?? attrsMeta[attr.name.replace(ATTR_BINDING_MATCHER, '')];\n+          const meta = attrsMeta[attr.name];\n           // do not create translation for empty attributes\n           if (meta !== undefined && attr.value) {\n             attr.i18n = this._generateI18nMessage([attr], attr.i18n || meta);"
        },
        {
            "sha": "3c0360cffeb99641977ad16cfa2c45704797c34d",
            "filename": "packages/compiler/src/render3/view/i18n/util.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fi18n%2Futil.ts",
            "raw_url": "https://github.com/angular/angular/raw/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fi18n%2Futil.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Fi18n%2Futil.ts?ref=60f3b33b4b7024e92c89f032dff50b22db9c105a",
            "patch": "@@ -24,12 +24,6 @@ export const TRANSLATION_VAR_PREFIX = 'i18n_';\n /** Name of the i18n attributes **/\n export const I18N_ATTR = 'i18n';\n export const I18N_ATTR_PREFIX = 'i18n-';\n-/**\n- * Matches the prefix used when binding to an attribute rather than a property.\n- *\n- * For example: `[attr.title]=\"expression\"`.\n- * */\n-export const ATTR_BINDING_MATCHER = /^attr\\./i;\n \n /** Prefix of var expressions used in ICUs */\n export const I18N_ICU_VAR_PREFIX = 'VAR_';"
        },
        {
            "sha": "286a0e8aa69e2c6c3172af399a8c725d422286ee",
            "filename": "packages/compiler/src/render3/view/template.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts",
            "raw_url": "https://github.com/angular/angular/raw/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler%2Fsrc%2Frender3%2Fview%2Ftemplate.ts?ref=60f3b33b4b7024e92c89f032dff50b22db9c105a",
            "patch": "@@ -656,8 +656,7 @@ export class TemplateDefinitionBuilder implements t.Visitor<void>, LocalResolver\n     element.inputs.forEach(input => {\n       const stylingInputWasSet = stylingBuilder.registerBoundInput(input);\n       if (!stylingInputWasSet) {\n-        if ((input.type === BindingType.Property || input.type === BindingType.Attribute) &&\n-            input.i18n) {\n+        if (input.type === BindingType.Property && input.i18n) {\n           boundI18nAttrs.push(input);\n         } else {\n           allOtherInputs.push(input);"
        },
        {
            "sha": "e7d53802f7bfeb048da748a1e2e7bc3bdd4e1282",
            "filename": "packages/core/test/acceptance/i18n_spec.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 21,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcore%2Ftest%2Facceptance%2Fi18n_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/60f3b33b4b7024e92c89f032dff50b22db9c105a/packages%2Fcore%2Ftest%2Facceptance%2Fi18n_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Facceptance%2Fi18n_spec.ts?ref=60f3b33b4b7024e92c89f032dff50b22db9c105a",
            "patch": "@@ -1616,27 +1616,6 @@ onlyInIvy('Ivy i18n logic').describe('runtime i18n', () => {\n       expect(fixture.nativeElement.innerHTML).toEqual(`<div title=\"bonjour John\"></div>`);\n     });\n \n-    it('interpolated \"attr.\" bindings', () => {\n-      loadTranslations({\n-        [computeMsgId('hello {$INTERPOLATION}')]: 'bonjour {$INTERPOLATION}',\n-        custom: 'translated-{$INTERPOLATION}'\n-      });\n-      const fixture = initWithTemplate(AppComp, `\n-        <div i18n-attr.title attr.title=\"hello {{name}}\"></div>\n-        <div i18n-title attr.title=\"hello {{name}}\"></div>\n-        <div i18n-attr.title=\"@@custom\" attr.title=\"original-{{name}}\"></div>\n-      `);\n-      expect(fixture.nativeElement.innerHTML)\n-          .toEqual(\n-              `<div title=\"bonjour Angular\"></div><div title=\"bonjour Angular\"></div><div title=\"translated-Angular\"></div>`);\n-\n-      fixture.componentRef.instance.name = 'John';\n-      fixture.detectChanges();\n-      expect(fixture.nativeElement.innerHTML)\n-          .toEqual(\n-              `<div title=\"bonjour John\"></div><div title=\"bonjour John\"></div><div title=\"translated-John\"></div>`);\n-    });\n-\n     it('with pipes', () => {\n       loadTranslations({[computeMsgId('hello {$INTERPOLATION}')]: 'bonjour {$INTERPOLATION}'});\n       const fixture = initWithTemplate("
        }
    ],
    "stats": {
        "total": 155,
        "additions": 4,
        "deletions": 151
    }
}