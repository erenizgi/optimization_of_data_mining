{
    "author": "gkalpak",
    "message": "fix(docs-infra): avoid unnecessarily loading Custom Elements ES5 shim (#41162)\n\nThe custom elements spec is not compatible with ES5 style classes. This\nmeans ES2015 code compiled to ES5 will not work with a native\nimplementation of Custom Elements. To support browsers that natively\nsupport Custom Elements but not ES2015 modules, we load\n`@webcomponents/custom-elements/src/native-shim.js`, which minimally\naugments the native implementation to be compatible with ES5 code.\n(See [here][1] for more details.)\n\nPreviously, the shim was included in `polyfills.ts`, which meant it was\nloaded in all browsers (even those supporting ES2015 modules and thus\nnot needing the shim).\n\nThis commit moves the shim from `polyfills.ts` to a `nomodule` script\ntag in `index.html`. This will ensure that it is only loaded in browsers\nthat do not support ES2015 modules and thus do not needed the shim.\n\nNOTE:\nThis commit also reduces size of the polyfills bundle by ~400B\n(52609B --> 52215B).\n\n[1]: https://www.npmjs.com/package/@webcomponents/custom-elements#es5-vs-es2015\n\nPR Close #41162",
    "sha": "d368fa2fa4721958fde276be5625460273ccd809",
    "files": [
        {
            "sha": "6a9bacc6a3db50ec462b320f2a0778cf1d4ff865",
            "filename": "aio/angular.json",
            "status": "modified",
            "additions": 0,
            "deletions": 10,
            "changes": 10,
            "blob_url": "https://github.com/angular/angular/blob/d368fa2fa4721958fde276be5625460273ccd809/aio%2Fangular.json",
            "raw_url": "https://github.com/angular/angular/raw/d368fa2fa4721958fde276be5625460273ccd809/aio%2Fangular.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fangular.json?ref=d368fa2fa4721958fde276be5625460273ccd809",
            "patch": "@@ -45,11 +45,6 @@\n               \"src/generated\",\n               \"src/pwa-manifest.json\",\n               \"src/google385281288605d160.html\",\n-              {\n-                \"glob\": \"custom-elements.min.js\",\n-                \"input\": \"node_modules/@webcomponents/custom-elements\",\n-                \"output\": \"/assets/js\"\n-              },\n               {\n                 \"glob\": \"native-shim.js\",\n                 \"input\": \"node_modules/@webcomponents/custom-elements/src\",\n@@ -157,11 +152,6 @@\n               \"src/generated\",\n               \"src/pwa-manifest.json\",\n               \"src/google385281288605d160.html\",\n-              {\n-                \"glob\": \"custom-elements.min.js\",\n-                \"input\": \"node_modules/@webcomponents/custom-elements\",\n-                \"output\": \"/assets/js\"\n-              },\n               {\n                 \"glob\": \"native-shim.js\",\n                 \"input\": \"node_modules/@webcomponents/custom-elements/src\","
        },
        {
            "sha": "cfcd69c181dead2c489e86a385ea05d3ccbfede7",
            "filename": "aio/ngsw-config.json",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/d368fa2fa4721958fde276be5625460273ccd809/aio%2Fngsw-config.json",
            "raw_url": "https://github.com/angular/angular/raw/d368fa2fa4721958fde276be5625460273ccd809/aio%2Fngsw-config.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fngsw-config.json?ref=d368fa2fa4721958fde276be5625460273ccd809",
            "patch": "@@ -13,6 +13,7 @@\n           \"/assets/js/*.js\",\n           \"/*.css\",\n           \"/*.js\",\n+          \"!/assets/js/native-shim.js\",\n           \"!/*-es5*.js\"\n         ],\n         \"urls\": [\n@@ -39,6 +40,7 @@\n       \"resources\": {\n         \"files\": [\n           \"/assets/images/favicons/**\",\n+          \"/assets/js/native-shim.js\",\n           \"/*-es5*.js\",\n           \"!/**/_unused/**\"\n         ]"
        },
        {
            "sha": "884786ab03b55e2daa73f6cf46e6bf654bb03618",
            "filename": "aio/src/index.html",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/d368fa2fa4721958fde276be5625460273ccd809/aio%2Fsrc%2Findex.html",
            "raw_url": "https://github.com/angular/angular/raw/d368fa2fa4721958fde276be5625460273ccd809/aio%2Fsrc%2Findex.html",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Findex.html?ref=d368fa2fa4721958fde276be5625460273ccd809",
            "patch": "@@ -108,6 +108,18 @@ <h2 style=\"color: red; margin-top: 40px; position: relative; text-align: center;\n       <b><i>This website requires JavaScript.</i></b>\n     </h2>\n   </noscript>\n+\n+  <!--\n+    Custom Element ES5 shim. Required for browsers that natively support Custom Elements, but do not\n+    support ES2015 modules.\n+    NOTE: Chrome, Firefox and Safari should not need this, because they added support for ES2015\n+          modules before Custom Elements. It is still required for some other (less common) browsers:\n+          - UC browser for android 11.8 (~3.5% global usage)\n+          - Samsung browser 5.0-8.1 (~0.43% global usage)\n+          - Opera 41-47 (~0.02% global usage)\n+  -->\n+  <script src=\"assets/js/native-shim.js\" nomodule></script>;\n+\n </body>\n \n </html>"
        },
        {
            "sha": "ced2732a9c7cbd02cf01c980dfc75f68ae0b9ea9",
            "filename": "aio/src/polyfills.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 8,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/d368fa2fa4721958fde276be5625460273ccd809/aio%2Fsrc%2Fpolyfills.ts",
            "raw_url": "https://github.com/angular/angular/raw/d368fa2fa4721958fde276be5625460273ccd809/aio%2Fsrc%2Fpolyfills.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fpolyfills.ts?ref=d368fa2fa4721958fde276be5625460273ccd809",
            "patch": "@@ -65,11 +65,3 @@ import 'zone.js';  // Included with Angular CLI.\n  */\n // Custom Elements polyfill. Required for browsers that do not natively support Custom Elements.\n import '@webcomponents/custom-elements';\n-// Custom Element ES5 shim. Required for browsers that natively support Custom Elements, but do not\n-// support ES2015 modules.\n-// NOTE: Chrome, Firefox and Safari should not need this, because they added support for ES2015\n-//       modules before Custom Elements. It is still required for some other (less common) browsers:\n-//       - UC browser for android 11.8 (~3.5% global usage)\n-//       - Samsung browser 5.0-8.1 (~0.43% global usage)\n-//       - Opera 41-47 (~0.02% global usage)\n-import '@webcomponents/custom-elements/src/native-shim';"
        },
        {
            "sha": "8bec7475957e08a6063871bd86dada11009ad0a8",
            "filename": "goldens/size-tracking/aio-payloads.json",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/d368fa2fa4721958fde276be5625460273ccd809/goldens%2Fsize-tracking%2Faio-payloads.json",
            "raw_url": "https://github.com/angular/angular/raw/d368fa2fa4721958fde276be5625460273ccd809/goldens%2Fsize-tracking%2Faio-payloads.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fsize-tracking%2Faio-payloads.json?ref=d368fa2fa4721958fde276be5625460273ccd809",
            "patch": "@@ -4,7 +4,7 @@\n       \"uncompressed\": {\n         \"runtime-es2015\": 3033,\n         \"main-es2015\": 450953,\n-        \"polyfills-es2015\": 52343\n+        \"polyfills-es2015\": 52215\n       }\n     }\n   },\n@@ -13,7 +13,7 @@\n       \"uncompressed\": {\n         \"runtime-es2015\": 3033,\n         \"main-es2015\": 451402,\n-        \"polyfills-es2015\": 52493\n+        \"polyfills-es2015\": 52215\n       }\n     }\n   },\n@@ -22,7 +22,7 @@\n       \"uncompressed\": {\n         \"runtime-es2015\": 3153,\n         \"main-es2015\": 437005,\n-        \"polyfills-es2015\": 52493\n+        \"polyfills-es2015\": 52215\n       }\n     }\n   }"
        }
    ],
    "stats": {
        "total": 38,
        "additions": 17,
        "deletions": 21
    }
}