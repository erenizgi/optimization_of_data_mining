{
    "author": "AleksanderBodurri",
    "message": "fix(devtools): update typing of differ objects to fit the new contract of TrackByFunction (rangle/angular-devtools#862)\n\nPreviously `DefaultIterableDiffer` was able to infer the type of it's generic by reading the type contract defined by the user defined trackBy function. This was because `TrackByFunction` can be specified with a generic that is used to type its second argument. If this generic is not provided, like in this case, typescript infers this type from the function contract directly. In this case this inferred type was `FlatNode`. This inference is then propagated to `DefaultIterableDiffer`, which is why we were not seeing this error previously.\r\n\r\nA change in the framework made it so the second argument of `TrackByFunction` is typed as a generic that extends the generic passed into `TrackByFunction`. Since we had not previously passed in this generic to `TrackByFunction`, this type was inferred as an extension of `unknown`, causing a type error when passed as an argument to the `DefaultIterableDiffer` constructor.\r\n\r\nNow the functions being used are typed directly as `TrackByFunction<FlatNode>`\r\n\r\nFor clarity, the `DefaultIterableDiffer` generic is now also typed as `FlatNode`.\r\n\r\nSee https://github.com/angular/angular/pull/41995 for the framework change.",
    "sha": "1b97432960a59218b40427f3d494818540889ac7",
    "files": [
        {
            "sha": "619e554df28fe70b8cd451ce8b6e53f4de13b17b",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/directive-explorer/directive-forest/component-data-source.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/1b97432960a59218b40427f3d494818540889ac7/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fdirective-forest%2Fcomponent-data-source.ts",
            "raw_url": "https://github.com/angular/angular/raw/1b97432960a59218b40427f3d494818540889ac7/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fdirective-forest%2Fcomponent-data-source.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fdirective-forest%2Fcomponent-data-source.ts?ref=1b97432960a59218b40427f3d494818540889ac7",
            "patch": "@@ -4,7 +4,7 @@ import { BehaviorSubject, merge, Observable } from 'rxjs';\n import { MatTreeFlattener } from '@angular/material/tree';\n import { FlatTreeControl } from '@angular/cdk/tree';\n import { map } from 'rxjs/operators';\n-import { DefaultIterableDiffer } from '@angular/core';\n+import { DefaultIterableDiffer, TrackByFunction } from '@angular/core';\n import { IndexedNode, indexForest } from './index-forest';\n import { diff } from '../../diffing';\n \n@@ -22,7 +22,7 @@ export interface FlatNode {\n \n const expandable = (node: IndexedNode) => !!node.children && node.children.length > 0;\n \n-const trackBy = (_: number, item: FlatNode) => `${item.id}#${item.expandable}`;\n+const trackBy: TrackByFunction<FlatNode> = (_: number, item: FlatNode) => `${item.id}#${item.expandable}`;\n \n const getId = (node: IndexedNode) => {\n   let prefix = '';\n@@ -61,7 +61,7 @@ const filterCommentNodes = (nodes: IndexedNode[]) => {\n };\n \n export class ComponentDataSource extends DataSource<FlatNode> {\n-  private _differ = new DefaultIterableDiffer(trackBy);\n+  private _differ = new DefaultIterableDiffer<FlatNode>(trackBy);\n   private _expandedData = new BehaviorSubject<FlatNode[]>([]);\n   private _flattenedData = new BehaviorSubject<FlatNode[]>([]);\n   private _nodeToFlat = new WeakMap<IndexedNode, FlatNode>();"
        },
        {
            "sha": "5e00f8e2306393607f65552d09bad2eb3dab85b9",
            "filename": "projects/ng-devtools/src/lib/devtools-tabs/directive-explorer/property-resolver/property-data-source.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/1b97432960a59218b40427f3d494818540889ac7/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Fproperty-data-source.ts",
            "raw_url": "https://github.com/angular/angular/raw/1b97432960a59218b40427f3d494818540889ac7/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Fproperty-data-source.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/projects%2Fng-devtools%2Fsrc%2Flib%2Fdevtools-tabs%2Fdirective-explorer%2Fproperty-resolver%2Fproperty-data-source.ts?ref=1b97432960a59218b40427f3d494818540889ac7",
            "patch": "@@ -4,18 +4,19 @@ import { BehaviorSubject, merge, Observable, Subscription } from 'rxjs';\n import { MatTreeFlattener } from '@angular/material/tree';\n import { FlatTreeControl } from '@angular/cdk/tree';\n import { map } from 'rxjs/operators';\n-import { DefaultIterableDiffer } from '@angular/core';\n+import { DefaultIterableDiffer, TrackByFunction } from '@angular/core';\n import { diff } from '../../diffing';\n import { FlatNode, Property } from './element-property-resolver';\n import { arrayifyProps } from './arrayify-props';\n \n-const trackBy = (_: number, item: FlatNode) => `#${item.prop.name}#${item.prop.descriptor.preview}#${item.level}`;\n+const trackBy: TrackByFunction<FlatNode> = (_: number, item: FlatNode) =>\n+  `#${item.prop.name}#${item.prop.descriptor.preview}#${item.level}`;\n \n export class PropertyDataSource extends DataSource<FlatNode> {\n   private _data = new BehaviorSubject<FlatNode[]>([]);\n   private _subscriptions: Subscription[] = [];\n   private _expandedData = new BehaviorSubject<FlatNode[]>([]);\n-  private _differ = new DefaultIterableDiffer(trackBy);\n+  private _differ = new DefaultIterableDiffer<FlatNode>(trackBy);\n \n   constructor(\n     props: { [prop: string]: Descriptor },"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 7,
        "deletions": 6
    }
}