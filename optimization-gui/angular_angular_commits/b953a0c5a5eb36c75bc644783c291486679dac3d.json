{
    "author": "gkalpak",
    "message": "refactor(service-worker): notify clients about updates in parallel (#40234)\n\nPreviously, clients were notified about updates sequentially. This\nwasn't necessary.\n\nThis commit changes the `Driver#notifyClientsAboutUpdate()` method to\nnotify the clients in parallel (by switching from `Array#reduce()` to\n`Array#map()` and `Promise.all()`).\n\nThis also aligns the `notifyClientsAboutUpdate()` method with the\n`notifyClientsAboutUnrecoverableState()` method.\n\nPR Close #40234",
    "sha": "b953a0c5a5eb36c75bc644783c291486679dac3d",
    "files": [
        {
            "sha": "106d3a45ca423b272c3a12ccf6ada92ad0b6b63d",
            "filename": "packages/service-worker/worker/src/driver.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/b953a0c5a5eb36c75bc644783c291486679dac3d/packages%2Fservice-worker%2Fworker%2Fsrc%2Fdriver.ts",
            "raw_url": "https://github.com/angular/angular/raw/b953a0c5a5eb36c75bc644783c291486679dac3d/packages%2Fservice-worker%2Fworker%2Fsrc%2Fdriver.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fservice-worker%2Fworker%2Fsrc%2Fdriver.ts?ref=b953a0c5a5eb36c75bc644783c291486679dac3d",
            "patch": "@@ -1037,9 +1037,7 @@ export class Driver implements Debuggable, UpdateSource {\n \n     const clients = await this.scope.clients.matchAll();\n \n-    await clients.reduce(async (previous, client) => {\n-      await previous;\n-\n+    await Promise.all(clients.map(async client => {\n       // Firstly, determine which version this client is on.\n       const version = this.clientVersionMap.get(client.id);\n       if (version === undefined) {\n@@ -1062,7 +1060,7 @@ export class Driver implements Debuggable, UpdateSource {\n       };\n \n       client.postMessage(notice);\n-    }, Promise.resolve());\n+    }));\n   }\n \n   async broadcast(msg: Object): Promise<void> {"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 2,
        "deletions": 4
    }
}