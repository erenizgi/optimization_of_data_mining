{
    "author": "josephperrott",
    "message": "test(dev-infra): add testing for integration of ReleaseNotes in publishing tooling (#41967)\n\nAdd testing of the ReleaseNotes integration with the release publishing tooling.\n\nPR Close #41967",
    "sha": "6d87895ffd0b4dfa53bd993a45c7d7350c692add",
    "files": [
        {
            "sha": "b486b5751824ee785d98cee422b5b2481afeff1e",
            "filename": "dev-infra/ng-dev.js",
            "status": "modified",
            "additions": 22,
            "deletions": 10,
            "changes": 32,
            "blob_url": "https://github.com/angular/angular/blob/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Fng-dev.js",
            "raw_url": "https://github.com/angular/angular/raw/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Fng-dev.js",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fng-dev.js?ref=6d87895ffd0b4dfa53bd993a45c7d7350c692add",
            "patch": "@@ -5855,18 +5855,20 @@ function getLocalChangelogFilePath(projectDir) {\n }\n /** Release note generation. */\n class ReleaseNotes {\n-    constructor(version, config) {\n+    constructor(version, startingRef, endingRef) {\n         this.version = version;\n-        this.config = config;\n+        this.startingRef = startingRef;\n+        this.endingRef = endingRef;\n         /** An instance of GitClient. */\n         this.git = GitClient.getInstance();\n         /** A promise resolving to a list of Commits since the latest semver tag on the branch. */\n-        this.commits = getCommitsInRange(this.git.getLatestSemverTag().format(), 'HEAD');\n+        this.commits = this.getCommitsInRange(this.startingRef, this.endingRef);\n+        /** The configuration for release notes. */\n+        this.config = this.getReleaseConfig().releaseNotes;\n     }\n-    /** Construct a release note generation instance. */\n-    static fromLatestTagToHead(version, config) {\n+    static fromRange(version, startingRef, endingRef) {\n         return tslib.__awaiter(this, void 0, void 0, function* () {\n-            return new ReleaseNotes(version, config);\n+            return new ReleaseNotes(version, startingRef, endingRef);\n         });\n     }\n     /** Retrieve the release note generated for a Github Release. */\n@@ -5888,7 +5890,7 @@ class ReleaseNotes {\n     promptForReleaseTitle() {\n         return tslib.__awaiter(this, void 0, void 0, function* () {\n             if (this.title === undefined) {\n-                if (this.config.releaseNotes.useReleaseTitle) {\n+                if (this.config.useReleaseTitle) {\n                     this.title = yield promptInput('Please provide a title for the release:');\n                 }\n                 else {\n@@ -5906,14 +5908,24 @@ class ReleaseNotes {\n                     commits: yield this.commits,\n                     github: this.git.remoteConfig,\n                     version: this.version.format(),\n-                    groupOrder: this.config.releaseNotes.groupOrder,\n-                    hiddenScopes: this.config.releaseNotes.hiddenScopes,\n+                    groupOrder: this.config.groupOrder,\n+                    hiddenScopes: this.config.hiddenScopes,\n                     title: yield this.promptForReleaseTitle(),\n                 });\n             }\n             return this.renderContext;\n         });\n     }\n+    // These methods are used for access to the utility functions while allowing them to be\n+    // overwritten in subclasses during testing.\n+    getCommitsInRange(from, to) {\n+        return tslib.__awaiter(this, void 0, void 0, function* () {\n+            return getCommitsInRange(from, to);\n+        });\n+    }\n+    getReleaseConfig(config) {\n+        return getReleaseConfig(config);\n+    }\n }\n \n /**\n@@ -6194,7 +6206,7 @@ class ReleaseAction {\n      */\n     stageVersionForBranchAndCreatePullRequest(newVersion, pullRequestBaseBranch) {\n         return tslib.__awaiter(this, void 0, void 0, function* () {\n-            const releaseNotes = yield ReleaseNotes.fromLatestTagToHead(newVersion, this.config);\n+            const releaseNotes = yield ReleaseNotes.fromRange(newVersion, this.git.getLatestSemverTag().format(), 'HEAD');\n             yield this.updateProjectVersion(newVersion);\n             yield this.prependReleaseNotesToChangelog(releaseNotes);\n             yield this.waitForEditsAndCreateReleaseCommit(newVersion);"
        },
        {
            "sha": "fb87ce3e6e54cd1b67cd0122d4361e6d83679636",
            "filename": "dev-infra/release/config/index.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fconfig%2Findex.ts",
            "raw_url": "https://github.com/angular/angular/raw/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fconfig%2Findex.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fconfig%2Findex.ts?ref=6d87895ffd0b4dfa53bd993a45c7d7350c692add",
            "patch": "@@ -6,8 +6,6 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import * as semver from 'semver';\n-\n import {assertNoErrors, getConfig, NgDevConfig} from '../../utils/config';\n \n /** Interface describing a built package. */"
        },
        {
            "sha": "6d067e93a1b5194931f704858f1a93c0e10e7cd8",
            "filename": "dev-infra/release/publish/actions.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Factions.ts",
            "raw_url": "https://github.com/angular/angular/raw/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Factions.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Factions.ts?ref=6d87895ffd0b4dfa53bd993a45c7d7350c692add",
            "patch": "@@ -350,7 +350,8 @@ export abstract class ReleaseAction {\n   protected async stageVersionForBranchAndCreatePullRequest(\n       newVersion: semver.SemVer, pullRequestBaseBranch: string):\n       Promise<{releaseNotes: ReleaseNotes, pullRequest: PullRequest}> {\n-    const releaseNotes = await ReleaseNotes.fromLatestTagToHead(newVersion, this.config);\n+    const releaseNotes =\n+        await ReleaseNotes.fromRange(newVersion, this.git.getLatestSemverTag().format(), 'HEAD');\n     await this.updateProjectVersion(newVersion);\n     await this.prependReleaseNotesToChangelog(releaseNotes);\n     await this.waitForEditsAndCreateReleaseCommit(newVersion);"
        },
        {
            "sha": "5b2e6aff5536ed94439a7febbe0df8ef342e9bf1",
            "filename": "dev-infra/release/publish/release-notes/release-notes.ts",
            "status": "modified",
            "additions": 24,
            "deletions": 11,
            "changes": 35,
            "blob_url": "https://github.com/angular/angular/blob/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Frelease-notes%2Frelease-notes.ts",
            "raw_url": "https://github.com/angular/angular/raw/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Frelease-notes%2Frelease-notes.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Frelease-notes%2Frelease-notes.ts?ref=6d87895ffd0b4dfa53bd993a45c7d7350c692add",
            "patch": "@@ -8,11 +8,12 @@\n import {renderFile} from 'ejs';\n import {join} from 'path';\n import * as semver from 'semver';\n+import {CommitFromGitLog} from '../../../commit-message/parse';\n \n import {getCommitsInRange} from '../../../commit-message/utils';\n import {promptInput} from '../../../utils/console';\n import {GitClient} from '../../../utils/git/index';\n-import {ReleaseConfig} from '../../config/index';\n+import {DevInfraReleaseConfig, getReleaseConfig, ReleaseNotesConfig} from '../../config/index';\n import {changelogPath} from '../constants';\n import {RenderContext} from './context';\n \n@@ -21,13 +22,10 @@ export function getLocalChangelogFilePath(projectDir: string): string {\n   return join(projectDir, changelogPath);\n }\n \n-\n /** Release note generation. */\n export class ReleaseNotes {\n-  /** Construct a release note generation instance. */\n-  static async fromLatestTagToHead(version: semver.SemVer, config: ReleaseConfig):\n-      Promise<ReleaseNotes> {\n-    return new ReleaseNotes(version, config);\n+  static async fromRange(version: semver.SemVer, startingRef: string, endingRef: string) {\n+    return new ReleaseNotes(version, startingRef, endingRef);\n   }\n \n   /** An instance of GitClient. */\n@@ -37,9 +35,13 @@ export class ReleaseNotes {\n   /** The title to use for the release. */\n   private title: string|false|undefined;\n   /** A promise resolving to a list of Commits since the latest semver tag on the branch. */\n-  private commits = getCommitsInRange(this.git.getLatestSemverTag().format(), 'HEAD');\n+  private commits: Promise<CommitFromGitLog[]> =\n+      this.getCommitsInRange(this.startingRef, this.endingRef);\n+  /** The configuration for release notes. */\n+  private config: ReleaseNotesConfig = this.getReleaseConfig().releaseNotes;\n \n-  private constructor(public readonly version: semver.SemVer, private config: ReleaseConfig) {}\n+  protected constructor(\n+      public version: semver.SemVer, private startingRef: string, private endingRef: string) {}\n \n   /** Retrieve the release note generated for a Github Release. */\n   async getGithubReleaseEntry(): Promise<string> {\n@@ -61,7 +63,7 @@ export class ReleaseNotes {\n    */\n   async promptForReleaseTitle() {\n     if (this.title === undefined) {\n-      if (this.config.releaseNotes.useReleaseTitle) {\n+      if (this.config.useReleaseTitle) {\n         this.title = await promptInput('Please provide a title for the release:');\n       } else {\n         this.title = false;\n@@ -77,11 +79,22 @@ export class ReleaseNotes {\n         commits: await this.commits,\n         github: this.git.remoteConfig,\n         version: this.version.format(),\n-        groupOrder: this.config.releaseNotes.groupOrder,\n-        hiddenScopes: this.config.releaseNotes.hiddenScopes,\n+        groupOrder: this.config.groupOrder,\n+        hiddenScopes: this.config.hiddenScopes,\n         title: await this.promptForReleaseTitle(),\n       });\n     }\n     return this.renderContext;\n   }\n+\n+\n+  // These methods are used for access to the utility functions while allowing them to be\n+  // overwritten in subclasses during testing.\n+  protected async getCommitsInRange(from: string, to?: string) {\n+    return getCommitsInRange(from, to);\n+  }\n+\n+  protected getReleaseConfig(config?: Partial<DevInfraReleaseConfig>) {\n+    return getReleaseConfig(config);\n+  }\n }"
        },
        {
            "sha": "28b6044c048fe0245654dd5ce5cc80c4aac76250",
            "filename": "dev-infra/release/publish/test/common.spec.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 9,
            "changes": 15,
            "blob_url": "https://github.com/angular/angular/blob/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Fcommon.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Fcommon.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2Fcommon.spec.ts?ref=6d87895ffd0b4dfa53bd993a45c7d7350c692add",
            "patch": "@@ -20,7 +20,7 @@ import {actions} from '../actions/index';\n import {changelogPath} from '../constants';\n import {ReleaseNotes} from '../release-notes/release-notes';\n \n-import {fakeNpmPackageQueryRequest, getChangelogForVersion, getTestingMocksForReleaseAction, parse, setupReleaseActionForTesting, testTmpDir} from './test-utils';\n+import {fakeNpmPackageQueryRequest, getTestingMocksForReleaseAction, parse, setupReleaseActionForTesting, testTmpDir} from './test-utils';\n \n describe('common release action logic', () => {\n   const baseReleaseTrains: ActiveReleaseTrains = {\n@@ -87,7 +87,6 @@ describe('common release action logic', () => {\n \n   describe('changelog cherry-picking', () => {\n     const {version, branchName} = baseReleaseTrains.latest;\n-    const fakeReleaseNotes = getChangelogForVersion(version.format());\n     const forkBranchName = `changelog-cherry-pick-${version}`;\n \n     it('should prepend the changelog to the next branch', async () => {\n@@ -96,8 +95,7 @@ describe('common release action logic', () => {\n \n       // Expect the changelog to be fetched and return a fake changelog to test that\n       // it is properly appended. Also expect a pull request to be created in the fork.\n-      repo.expectChangelogFetch(branchName, fakeReleaseNotes)\n-          .expectFindForkRequest(fork)\n+      repo.expectFindForkRequest(fork)\n           .expectPullRequestToBeCreated('master', fork, forkBranchName, 200)\n           .expectPullRequestWait(200);\n \n@@ -107,7 +105,7 @@ describe('common release action logic', () => {\n       await instance.testCherryPickWithPullRequest(version, branchName);\n \n       const changelogContent = readFileSync(join(testTmpDir, changelogPath), 'utf8');\n-      expect(changelogContent).toEqual(`${fakeReleaseNotes}Existing changelog`);\n+      expect(changelogContent).toEqual(`Changelog Entry for 10.0.1\\n\\nExisting changelog`);\n     });\n \n     it('should push changes to a fork for creating a pull request', async () => {\n@@ -116,8 +114,7 @@ describe('common release action logic', () => {\n \n       // Expect the changelog to be fetched and return a fake changelog to test that\n       // it is properly appended. Also expect a pull request to be created in the fork.\n-      repo.expectChangelogFetch(branchName, fakeReleaseNotes)\n-          .expectFindForkRequest(fork)\n+      repo.expectFindForkRequest(fork)\n           .expectPullRequestToBeCreated('master', fork, forkBranchName, 200)\n           .expectPullRequestWait(200);\n \n@@ -155,12 +152,12 @@ class TestAction extends ReleaseAction {\n   }\n \n   async testBuildAndPublish(version: semver.SemVer, publishBranch: string, distTag: string) {\n-    const releaseNotes = await ReleaseNotes.fromLatestTagToHead(version, this.config);\n+    const releaseNotes = await ReleaseNotes.fromRange(version, '', '');\n     await this.buildAndPublish(releaseNotes, publishBranch, distTag);\n   }\n \n   async testCherryPickWithPullRequest(version: semver.SemVer, branch: string) {\n-    const releaseNotes = await ReleaseNotes.fromLatestTagToHead(version, this.config);\n+    const releaseNotes = await ReleaseNotes.fromRange(version, '', '');\n     await this.cherryPickChangelogIntoNextBranch(releaseNotes, branch);\n   }\n }"
        },
        {
            "sha": "084b9097dc8921ef147831b00b9c27c1096fce63",
            "filename": "dev-infra/release/publish/test/github-api-testing.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Fgithub-api-testing.ts",
            "raw_url": "https://github.com/angular/angular/raw/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Fgithub-api-testing.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2Fgithub-api-testing.ts?ref=6d87895ffd0b4dfa53bd993a45c7d7350c692add",
            "patch": "@@ -60,13 +60,6 @@ export class GithubTestingRepo {\n     return this;\n   }\n \n-  expectChangelogFetch(branch: string, content: string): this {\n-    nock(this.repoApiUrl).get(`/contents/%2FCHANGELOG.md`).query(p => p.ref === branch).reply(200, {\n-      content: new Buffer(content).toString('base64')\n-    });\n-    return this;\n-  }\n-\n   expectCommitRequest(sha: string, message: string): this {\n     nock(this.repoApiUrl).get(`/commits/${sha}`).reply(200, {commit: {message}});\n     return this;"
        },
        {
            "sha": "fe61b4a97526fc58f80c514eea4045e3b6e67ac8",
            "filename": "dev-infra/release/publish/test/move-next-into-feature-freeze.spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Fmove-next-into-feature-freeze.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Fmove-next-into-feature-freeze.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2Fmove-next-into-feature-freeze.spec.ts?ref=6d87895ffd0b4dfa53bd993a45c7d7350c692add",
            "patch": "@@ -13,7 +13,7 @@ import {ReleaseTrain} from '../../versioning/release-trains';\n import {MoveNextIntoFeatureFreezeAction} from '../actions/move-next-into-feature-freeze';\n import * as externalCommands from '../external-commands';\n \n-import {getChangelogForVersion, parse, setupReleaseActionForTesting, testTmpDir} from './test-utils';\n+import {parse, setupReleaseActionForTesting, testTmpDir} from './test-utils';\n \n describe('move next into feature-freeze action', () => {\n   it('should not activate if a feature-freeze release-train is active', async () => {\n@@ -84,7 +84,6 @@ describe('move next into feature-freeze action', () => {\n             'STAGING_COMMIT_SHA', `release: cut the v${expectedVersion} release\\n\\nPR Close #200.`)\n         .expectTagToBeCreated(expectedTagName, 'STAGING_COMMIT_SHA')\n         .expectReleaseToBeCreated(`v${expectedVersion}`, expectedTagName)\n-        .expectChangelogFetch(expectedNewBranch, getChangelogForVersion(expectedVersion))\n         .expectPullRequestToBeCreated('master', fork, expectedNextUpdateBranch, 100);\n \n     // In the fork, we make the following branches appear as non-existent,"
        },
        {
            "sha": "98424d7bc472cc11b217527c3669cdaccca9a8af",
            "filename": "dev-infra/release/publish/test/release-notes/release-notes-utils.ts",
            "status": "added",
            "additions": 43,
            "deletions": 0,
            "changes": 43,
            "blob_url": "https://github.com/angular/angular/blob/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Frelease-notes%2Frelease-notes-utils.ts",
            "raw_url": "https://github.com/angular/angular/raw/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Frelease-notes%2Frelease-notes-utils.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2Frelease-notes%2Frelease-notes-utils.ts?ref=6d87895ffd0b4dfa53bd993a45c7d7350c692add",
            "patch": "@@ -0,0 +1,43 @@\n+/**\n+ * @license\n+ * Copyright Google LLC All Rights Reserved.\n+ *\n+ * Use of this source code is governed by an MIT-style license that can be\n+ * found in the LICENSE file at https://angular.io/license\n+ */\n+\n+import * as semver from 'semver';\n+\n+import {DevInfraReleaseConfig, ReleaseConfig} from '../../../config';\n+import {ReleaseNotes} from '../../release-notes/release-notes';\n+\n+/**\n+ * Mock version of the ReleaseNotes for testing, preventing actual calls to git for commits and\n+ * returning versioned entry strings.\n+ */\n+class MockReleaseNotes extends ReleaseNotes {\n+  static async fromRange(version: semver.SemVer, startingRef: string, endingRef: string) {\n+    return new MockReleaseNotes(version, startingRef, endingRef);\n+  }\n+\n+  async getChangelogEntry() {\n+    return `Changelog Entry for ${this.version}`;\n+  }\n+\n+  async getGithubReleaseEntry() {\n+    return `Github Release Entry for ${this.version}`;\n+  }\n+\n+  // Overrides of utility functions which call out to other tools and are unused in this mock.\n+  protected async getCommitsInRange(from: string, to?: string) {\n+    return [];\n+  }\n+  protected getReleaseConfig(config?: Partial<DevInfraReleaseConfig>) {\n+    return {} as ReleaseConfig;\n+  }\n+}\n+\n+/** Replace the ReleaseNotes static builder function with the MockReleaseNotes builder function. */\n+export function installMockReleaseNotes() {\n+  spyOn(ReleaseNotes, 'fromRange').and.callFake(MockReleaseNotes.fromRange);\n+}"
        },
        {
            "sha": "f463c635da99402e0558bf1496c3aeeb646ab831",
            "filename": "dev-infra/release/publish/test/test-utils.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 9,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Ftest-utils.ts",
            "raw_url": "https://github.com/angular/angular/raw/6d87895ffd0b4dfa53bd993a45c7d7350c692add/dev-infra%2Frelease%2Fpublish%2Ftest%2Ftest-utils.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2Ftest-utils.ts?ref=6d87895ffd0b4dfa53bd993a45c7d7350c692add",
            "patch": "@@ -11,7 +11,6 @@ import * as nock from 'nock';\n import {join} from 'path';\n import * as semver from 'semver';\n \n-import * as commitMessageUtils from '../../../commit-message/utils';\n import {GithubConfig} from '../../../utils/config';\n import * as console from '../../../utils/console';\n import {getBranchPushMatcher, installVirtualGitClientSpies, VirtualGitClient} from '../../../utils/testing';\n@@ -22,9 +21,9 @@ import {_npmPackageInfoCache, NpmPackageInfo} from '../../versioning/npm-registr\n import {ReleaseAction, ReleaseActionConstructor} from '../actions';\n import * as constants from '../constants';\n import * as externalCommands from '../external-commands';\n-import {buildDateStamp} from '../release-notes/context';\n \n import {GithubTestingRepo} from './github-api-testing';\n+import {installMockReleaseNotes} from './release-notes/release-notes-utils';\n \n /**\n  * Temporary directory which will be used as project directory in tests. Note that\n@@ -70,7 +69,7 @@ export function setupReleaseActionForTesting<T extends ReleaseAction>(\n     actionCtor: ReleaseActionConstructor<T>, active: ActiveReleaseTrains,\n     isNextPublishedToNpm = true): TestReleaseAction<T> {\n   installVirtualGitClientSpies();\n-  spyOn(commitMessageUtils, 'getCommitsInRange').and.returnValue(Promise.resolve([]));\n+  installMockReleaseNotes();\n \n   // Reset existing HTTP interceptors.\n   nock.cleanAll();\n@@ -123,11 +122,6 @@ export function parse(version: string): semver.SemVer {\n   return semver.parse(version)!;\n }\n \n-/** Gets a changelog for the specified version. */\n-export function getChangelogForVersion(version: string): string {\n-  return `<a name=\"${version}\"></a>\\n# ${version} (${buildDateStamp()})\\n\\n\\n`;\n-}\n-\n export async function expectStagingAndPublishWithoutCherryPick(\n     action: TestReleaseAction, expectedBranch: string, expectedVersion: string,\n     expectedNpmDistTag: string) {\n@@ -197,7 +191,6 @@ export async function expectStagingAndPublishWithCherryPick(\n           'STAGING_COMMIT_SHA', `release: cut the v${expectedVersion} release\\n\\nPR Close #200.`)\n       .expectTagToBeCreated(expectedTagName, 'STAGING_COMMIT_SHA')\n       .expectReleaseToBeCreated(`v${expectedVersion}`, expectedTagName)\n-      .expectChangelogFetch(expectedBranch, getChangelogForVersion(expectedVersion))\n       .expectPullRequestToBeCreated('master', fork, expectedCherryPickForkBranch, 300)\n       .expectPullRequestWait(300);\n "
        }
    ],
    "stats": {
        "total": 151,
        "additions": 100,
        "deletions": 51
    }
}