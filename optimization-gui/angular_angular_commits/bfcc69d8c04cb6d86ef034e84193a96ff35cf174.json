{
    "author": "gkalpak",
    "message": "test(service-worker): make `MockResponse` behave more similarly to real responses (#44723)\n\nMake the `MockResponse` class used in tests behave more similarly to how\nreal responses work by making the following improvements:\n- Use an empty `statusText` (`''`) when provided, instead of the default\n  `'OK'` value. This allows better representing opaque responses.\n- Preserve more properties (`redirected`, `type`, `url`) when cloning a\n  `MockResponse`.\n\nPR Close #44723",
    "sha": "bfcc69d8c04cb6d86ef034e84193a96ff35cf174",
    "files": [
        {
            "sha": "d0a337eca6b326fd782f134a50002fd77eeb457b",
            "filename": "packages/service-worker/worker/test/happy_spec.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/bfcc69d8c04cb6d86ef034e84193a96ff35cf174/packages%2Fservice-worker%2Fworker%2Ftest%2Fhappy_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/bfcc69d8c04cb6d86ef034e84193a96ff35cf174/packages%2Fservice-worker%2Fworker%2Ftest%2Fhappy_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fservice-worker%2Fworker%2Ftest%2Fhappy_spec.ts?ref=bfcc69d8c04cb6d86ef034e84193a96ff35cf174",
            "patch": "@@ -362,6 +362,7 @@ describe('Driver', () => {\n     server.assertSawRequestFor('/foo.txt');\n     server.assertSawRequestFor('/bar.txt');\n     server.assertSawRequestFor('/redirected.txt');\n+    server.assertSawRequestFor('/redirect-target.txt');\n     expect(await makeRequest(scope, '/foo.txt')).toEqual('this is foo');\n     expect(await makeRequest(scope, '/bar.txt')).toEqual('this is bar');\n     server.assertNoOtherRequests();\n@@ -374,6 +375,7 @@ describe('Driver', () => {\n     server.assertSawRequestFor('/foo.txt');\n     server.assertSawRequestFor('/bar.txt');\n     server.assertSawRequestFor('/redirected.txt');\n+    server.assertSawRequestFor('/redirect-target.txt');\n     expect(await makeRequest(scope, '/foo.txt')).toEqual('this is foo');\n     expect(await makeRequest(scope, '/bar.txt')).toEqual('this is bar');\n     server.assertNoOtherRequests();\n@@ -391,6 +393,7 @@ describe('Driver', () => {\n     server.assertSawRequestFor('/foo.txt');\n     server.assertSawRequestFor('/bar.txt');\n     server.assertSawRequestFor('/redirected.txt');\n+    server.assertSawRequestFor('/redirect-target.txt');\n \n     // Once initialized, cached resources are served without network requests.\n     expect(await makeRequest(scope, '/foo.txt')).toEqual('this is foo');\n@@ -411,6 +414,7 @@ describe('Driver', () => {\n     server.assertSawRequestFor('/foo.txt');\n     server.assertSawRequestFor('/bar.txt');\n     server.assertSawRequestFor('/redirected.txt');\n+    server.assertSawRequestFor('/redirect-target.txt');\n \n     // Once initialized, pushed messages are handled without re-initializing.\n     await scope.handleMessage({action: 'bar'}, 'someClient');\n@@ -476,6 +480,7 @@ describe('Driver', () => {\n     serverUpdate.assertSawRequestFor('/ngsw.json');\n     serverUpdate.assertSawRequestFor('/foo.txt');\n     serverUpdate.assertSawRequestFor('/redirected.txt');\n+    serverUpdate.assertSawRequestFor('/redirect-target.txt');\n     serverUpdate.assertNoOtherRequests();\n \n     expect(client.messages).toEqual([\n@@ -577,6 +582,7 @@ describe('Driver', () => {\n     serverUpdate.assertSawRequestFor('/ngsw.json');\n     serverUpdate.assertSawRequestFor('/foo.txt');\n     serverUpdate.assertSawRequestFor('/redirected.txt');\n+    serverUpdate.assertSawRequestFor('/redirect-target.txt');\n     serverUpdate.assertNoOtherRequests();\n   });\n "
        },
        {
            "sha": "b53187d8fd272e89859bfadaf45901440ebb9a3c",
            "filename": "packages/service-worker/worker/testing/fetch.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/bfcc69d8c04cb6d86ef034e84193a96ff35cf174/packages%2Fservice-worker%2Fworker%2Ftesting%2Ffetch.ts",
            "raw_url": "https://github.com/angular/angular/raw/bfcc69d8c04cb6d86ef034e84193a96ff35cf174/packages%2Fservice-worker%2Fworker%2Ftesting%2Ffetch.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fservice-worker%2Fworker%2Ftesting%2Ffetch.ts?ref=bfcc69d8c04cb6d86ef034e84193a96ff35cf174",
            "patch": "@@ -171,7 +171,7 @@ export class MockResponse extends MockBody implements Response {\n       init: ResponseInit&{type?: ResponseType, redirected?: boolean, url?: string} = {}) {\n     super(typeof body === 'string' ? body : null);\n     this.status = (init.status !== undefined) ? init.status : 200;\n-    this.statusText = init.statusText || 'OK';\n+    this.statusText = (init.statusText !== undefined) ? init.statusText : 'OK';\n     const headers = init.headers as {[key: string]: string};\n     if (headers !== undefined) {\n       if (headers instanceof MockHeaders) {\n@@ -197,7 +197,13 @@ export class MockResponse extends MockBody implements Response {\n     if (this.bodyUsed) {\n       throw 'Body already consumed';\n     }\n-    return new MockResponse(\n-        this._body, {status: this.status, statusText: this.statusText, headers: this.headers});\n+    return new MockResponse(this._body, {\n+      status: this.status,\n+      statusText: this.statusText,\n+      headers: this.headers,\n+      type: this.type,\n+      redirected: this.redirected,\n+      url: this.url,\n+    });\n   }\n }"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 15,
        "deletions": 3
    }
}