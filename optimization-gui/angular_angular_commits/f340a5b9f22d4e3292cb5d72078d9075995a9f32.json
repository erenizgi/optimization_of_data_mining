{
    "author": "Jefiozie",
    "message": "fix(http): ignore question mark when params are parsed (#40610)\n\nThis commit adds a fix where params will ignore questions marks when\nparsed.\n\nFixes #28722\n\nPR Close #40610",
    "sha": "f340a5b9f22d4e3292cb5d72078d9075995a9f32",
    "files": [
        {
            "sha": "b4841570c8f097ee5bd24f3f51ba9bac9dd0ab63",
            "filename": "packages/common/http/src/params.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/f340a5b9f22d4e3292cb5d72078d9075995a9f32/packages%2Fcommon%2Fhttp%2Fsrc%2Fparams.ts",
            "raw_url": "https://github.com/angular/angular/raw/f340a5b9f22d4e3292cb5d72078d9075995a9f32/packages%2Fcommon%2Fhttp%2Fsrc%2Fparams.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fhttp%2Fsrc%2Fparams.ts?ref=f340a5b9f22d4e3292cb5d72078d9075995a9f32",
            "patch": "@@ -73,7 +73,10 @@ export class HttpUrlEncodingCodec implements HttpParameterCodec {\n function paramParser(rawParams: string, codec: HttpParameterCodec): Map<string, string[]> {\n   const map = new Map<string, string[]>();\n   if (rawParams.length > 0) {\n-    const params: string[] = rawParams.split('&');\n+    // The `window.location.search` can be used while creating an instance of the `HttpParams` class\n+    // (e.g. `new HttpParams({ fromString: window.location.search })`). The `window.location.search`\n+    // may start with the `?` char, so we strip it if it's present.\n+    const params: string[] = rawParams.replace(/^\\?/, '').split('&');\n     params.forEach((param: string) => {\n       const eqIdx = param.indexOf('=');\n       const [key, val]: string[] = eqIdx == -1 ?"
        },
        {
            "sha": "60d20421a0bdf3e77176e61bd03c1b13460568bf",
            "filename": "packages/common/http/test/params_spec.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/angular/angular/blob/f340a5b9f22d4e3292cb5d72078d9075995a9f32/packages%2Fcommon%2Fhttp%2Ftest%2Fparams_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/f340a5b9f22d4e3292cb5d72078d9075995a9f32/packages%2Fcommon%2Fhttp%2Ftest%2Fparams_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fhttp%2Ftest%2Fparams_spec.ts?ref=f340a5b9f22d4e3292cb5d72078d9075995a9f32",
            "patch": "@@ -21,6 +21,19 @@ import {HttpParams} from '@angular/common/http/src/params';\n         expect(body.getAll('a')).toEqual(['b']);\n         expect(body.getAll('c')).toEqual(['d', 'e']);\n       });\n+\n+      it('should ignore question mark in a url', () => {\n+        const body = new HttpParams({fromString: '?a=b&c=d&c=e'});\n+        expect(body.getAll('a')).toEqual(['b']);\n+        expect(body.getAll('c')).toEqual(['d', 'e']);\n+      });\n+\n+      it('should only remove question mark at the beginning of the params', () => {\n+        const body = new HttpParams({fromString: '?a=b&c=d&?e=f'});\n+        expect(body.getAll('a')).toEqual(['b']);\n+        expect(body.getAll('c')).toEqual(['d']);\n+        expect(body.getAll('?e')).toEqual(['f']);\n+      });\n     });\n \n     describe('lazy mutation', () => {"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 17,
        "deletions": 1
    }
}