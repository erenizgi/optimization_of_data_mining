{
    "author": "AndrewKushnir",
    "message": "perf(forms): make `RadioControlRegistry` class tree-shakable (#41126)\n\nThis commit makes the `RadioControlRegistry` class tree-shakable by adding the `providedIn` property to its\n`@Injectable` decorator. Now if the radio buttons are not used in the app (thus no `RadioControlValueAccessor`\ndirective is initialized), the `RadioControlRegistry` should not be included into application's prod bundle.\n\nPR Close #41126",
    "sha": "e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0",
    "files": [
        {
            "sha": "da3f7bc85da816acb18401bb370d097f05230332",
            "filename": "goldens/public-api/forms/forms.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/goldens%2Fpublic-api%2Fforms%2Fforms.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/goldens%2Fpublic-api%2Fforms%2Fforms.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fforms%2Fforms.d.ts?ref=e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0",
            "patch": "@@ -477,7 +477,7 @@ export declare class RadioControlValueAccessor extends ɵangular_packages_forms_\n     onChange: () => void;\n     onTouched: () => void;\n     value: any;\n-    constructor(_renderer: Renderer2, _elementRef: ElementRef, _registry: ɵangular_packages_forms_forms_o, _injector: Injector);\n+    constructor(_renderer: Renderer2, _elementRef: ElementRef, _registry: ɵangular_packages_forms_forms_p, _injector: Injector);\n     fireUncheck(value: any): void;\n     ngOnDestroy(): void;\n     ngOnInit(): void;"
        },
        {
            "sha": "809a19e62f25a418a31288d25d7a48e7ba8f6467",
            "filename": "packages/core/test/bundling/forms_reactive/bundle.golden_symbols.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fcore%2Ftest%2Fbundling%2Fforms_reactive%2Fbundle.golden_symbols.json",
            "raw_url": "https://github.com/angular/angular/raw/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fcore%2Ftest%2Fbundling%2Fforms_reactive%2Fbundle.golden_symbols.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Fbundling%2Fforms_reactive%2Fbundle.golden_symbols.json?ref=e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0",
            "patch": "@@ -450,7 +450,7 @@\n     \"name\": \"R3ViewContainerRef\"\n   },\n   {\n-    \"name\": \"RadioControlRegistry\"\n+    \"name\": \"RadioControlRegistryModule\"\n   },\n   {\n     \"name\": \"ReactiveFormsComponent\""
        },
        {
            "sha": "0baae6f79ec9dbafdad26f26b344de6a9e754bf3",
            "filename": "packages/core/test/bundling/forms_template_driven/bundle.golden_symbols.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fcore%2Ftest%2Fbundling%2Fforms_template_driven%2Fbundle.golden_symbols.json",
            "raw_url": "https://github.com/angular/angular/raw/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fcore%2Ftest%2Fbundling%2Fforms_template_driven%2Fbundle.golden_symbols.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Fbundling%2Fforms_template_driven%2Fbundle.golden_symbols.json?ref=e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0",
            "patch": "@@ -444,7 +444,7 @@\n     \"name\": \"REQUIRED_VALIDATOR\"\n   },\n   {\n-    \"name\": \"RadioControlRegistry\"\n+    \"name\": \"RadioControlRegistryModule\"\n   },\n   {\n     \"name\": \"RecordViewTuple\""
        },
        {
            "sha": "92af71a67ba1743e7ea189470fbabfffe7163de5",
            "filename": "packages/forms/src/directives.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fforms%2Fsrc%2Fdirectives.ts",
            "raw_url": "https://github.com/angular/angular/raw/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fforms%2Fsrc%2Fdirectives.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fdirectives.ts?ref=e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0",
            "patch": "@@ -16,7 +16,7 @@ import {NgModel} from './directives/ng_model';\n import {NgModelGroup} from './directives/ng_model_group';\n import {NgNoValidate} from './directives/ng_no_validate_directive';\n import {NumberValueAccessor} from './directives/number_value_accessor';\n-import {RadioControlValueAccessor} from './directives/radio_control_value_accessor';\n+import {RadioControlRegistryModule, RadioControlValueAccessor} from './directives/radio_control_value_accessor';\n import {RangeValueAccessor} from './directives/range_value_accessor';\n import {FormControlDirective} from './directives/reactive_directives/form_control_directive';\n import {FormControlName} from './directives/reactive_directives/form_control_name';\n@@ -77,6 +77,7 @@ export const REACTIVE_DRIVEN_DIRECTIVES: Type<any>[] =\n  */\n @NgModule({\n   declarations: SHARED_FORM_DIRECTIVES,\n+  imports: [RadioControlRegistryModule],\n   exports: SHARED_FORM_DIRECTIVES,\n })\n export class ɵInternalFormsSharedModule {"
        },
        {
            "sha": "f0b0e2e92f2528959f0909786a2765e69ae4643e",
            "filename": "packages/forms/src/directives/radio_control_value_accessor.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 2,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fforms%2Fsrc%2Fdirectives%2Fradio_control_value_accessor.ts",
            "raw_url": "https://github.com/angular/angular/raw/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fforms%2Fsrc%2Fdirectives%2Fradio_control_value_accessor.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fdirectives%2Fradio_control_value_accessor.ts?ref=e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0",
            "patch": "@@ -6,7 +6,7 @@\n  * found in the LICENSE file at https://angular.io/license\n  */\n \n-import {Directive, ElementRef, forwardRef, Injectable, Injector, Input, OnDestroy, OnInit, Renderer2} from '@angular/core';\n+import {Directive, ElementRef, forwardRef, Injectable, Injector, Input, NgModule, OnDestroy, OnInit, Renderer2} from '@angular/core';\n \n import {BuiltInControlValueAccessor, ControlValueAccessor, NG_VALUE_ACCESSOR} from './control_value_accessor';\n import {NgControl} from './ng_control';\n@@ -24,11 +24,21 @@ function throwNameError() {\n     `);\n }\n \n+/**\n+ * Internal-only NgModule that works as a host for the `RadioControlRegistry` tree-shakable\n+ * provider. Note: the `InternalFormsSharedModule` can not be used here directly, since it's\n+ * declared *after* the `RadioControlRegistry` class and the `providedIn` doesn't support\n+ * `forwardRef` logic.\n+ */\n+@NgModule()\n+export class RadioControlRegistryModule {\n+}\n+\n /**\n  * @description\n  * Class used by Angular to track radio buttons. For internal use only.\n  */\n-@Injectable()\n+@Injectable({providedIn: RadioControlRegistryModule})\n export class RadioControlRegistry {\n   private _accessors: any[] = [];\n "
        },
        {
            "sha": "df86eb45bb76b9d5bd4e7b896303eb58311952e3",
            "filename": "packages/forms/src/form_providers.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 5,
            "changes": 12,
            "blob_url": "https://github.com/angular/angular/blob/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fforms%2Fsrc%2Fform_providers.ts",
            "raw_url": "https://github.com/angular/angular/raw/e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0/packages%2Fforms%2Fsrc%2Fform_providers.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fforms%2Fsrc%2Fform_providers.ts?ref=e88a9c6350a0e2941c9ba2feee0c5db15a32c7e0",
            "patch": "@@ -9,20 +9,21 @@\n import {ModuleWithProviders, NgModule} from '@angular/core';\n \n import {InternalFormsSharedModule, NG_MODEL_WITH_FORM_CONTROL_WARNING, REACTIVE_DRIVEN_DIRECTIVES, TEMPLATE_DRIVEN_DIRECTIVES} from './directives';\n-import {RadioControlRegistry} from './directives/radio_control_value_accessor';\n \n /**\n  * Exports the required providers and directives for template-driven forms,\n  * making them available for import by NgModules that import this module.\n  *\n+ * Providers associated with this module:\n+ * * `RadioControlRegistry`\n+ *\n  * @see [Forms Overview](/guide/forms-overview)\n  * @see [Template-driven Forms Guide](/guide/forms)\n  *\n  * @publicApi\n  */\n @NgModule({\n   declarations: TEMPLATE_DRIVEN_DIRECTIVES,\n-  providers: [RadioControlRegistry],\n   exports: [InternalFormsSharedModule, TEMPLATE_DRIVEN_DIRECTIVES]\n })\n export class FormsModule {\n@@ -32,16 +33,17 @@ export class FormsModule {\n  * Exports the required infrastructure and directives for reactive forms,\n  * making them available for import by NgModules that import this module.\n  *\n+ * Providers associated with this module:\n+ * * `FormBuilder`\n+ * * `RadioControlRegistry`\n+ *\n  * @see [Forms Overview](guide/forms-overview)\n  * @see [Reactive Forms Guide](guide/reactive-forms)\n  *\n  * @publicApi\n  */\n @NgModule({\n   declarations: [REACTIVE_DRIVEN_DIRECTIVES],\n-  // Note: FormBuilder is also provided in this module as a tree-shakable provider,\n-  // see packages/forms/src/form_builder.ts.\n-  providers: [RadioControlRegistry],\n   exports: [InternalFormsSharedModule, REACTIVE_DRIVEN_DIRECTIVES]\n })\n export class ReactiveFormsModule {"
        }
    ],
    "stats": {
        "total": 35,
        "additions": 24,
        "deletions": 11
    }
}