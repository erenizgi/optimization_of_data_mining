{
    "author": "devversion",
    "message": "build: update to rules_nodejs v4.0.0-beta.0 (#42760)\n\nUpdates the Bazel NodeJS rules to v4.0.0-beta.0. This is necessary\nso that the Angular components repo can update, and it's generally\ngood to stay as up-to-date as possible with the Bazel rules as it's\neasy to fall behind, and updating early allows us to discover issues\naffecting our tooling earlier (where they are easier to address due to\ne.g. potential breaking change policy).\n\nPR Close #42760",
    "sha": "762e057e85fe92149d48aa0c5bc9168147d45d5c",
    "files": [
        {
            "sha": "3a28dcbdde37d05db6b3f9da51216d4b5bfc83da",
            "filename": "WORKSPACE",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/WORKSPACE",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/WORKSPACE",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/WORKSPACE?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -8,8 +8,8 @@ load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n # Fetch rules_nodejs so we can install our npm dependencies\n http_archive(\n     name = \"build_bazel_rules_nodejs\",\n-    sha256 = \"8f5f192ba02319254aaf2cdcca00ec12eaafeb979a80a1e946773c520ae0a2c9\",\n-    urls = [\"https://github.com/bazelbuild/rules_nodejs/releases/download/3.7.0/rules_nodejs-3.7.0.tar.gz\"],\n+    sha256 = \"5c40083120eadec50a3497084f99bc75a85400ea727e82e0b2f422720573130f\",\n+    urls = [\"https://github.com/bazelbuild/rules_nodejs/releases/download/4.0.0-beta.0/rules_nodejs-4.0.0-beta.0.tar.gz\"],\n )\n \n # Check the rules_nodejs version and download npm dependencies"
        },
        {
            "sha": "bb88f6418205b25c764bb9faf33ceadf5cd4fbb3",
            "filename": "dev-infra/BUILD.bazel",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,7 +1,6 @@\n # BEGIN-INTERNAL\n load(\"@build_bazel_rules_nodejs//:index.bzl\", \"pkg_npm\")\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n-load(\"//dev-infra:index.bzl\", \"ng_dev_rolled_up_generated_file\")\n+load(\"//dev-infra:defaults.bzl\", \"ng_dev_rolled_up_generated_file\", \"ts_library\")\n # END-INTERNAL\n \n exports_files([\"tsconfig.json\"])\n@@ -12,7 +11,6 @@ ts_library(\n     srcs = [\n         \"cli.ts\",\n     ],\n-    module_name = \"@angular/dev-infra-private\",\n     deps = [\n         \"//dev-infra/caretaker\",\n         \"//dev-infra/commit-message\",\n@@ -47,6 +45,7 @@ genrule(\n pkg_npm(\n     name = \"npm_package\",\n     srcs = [\n+        # Main bazel entry-point for the shared `dev-infra` package.\n         \"index.bzl\",\n         \"BUILD.bazel\",\n         # Some tools within `dev-infra` which are shipped as Bazel rules might\n@@ -60,12 +59,13 @@ pkg_npm(\n         # substitutions to replace these in the published version of dev-infra.\n         \"//dev-infra/\": \"@npm//@angular/dev-infra-private/\",\n         \"//dev-infra:\": \"@npm//@angular/dev-infra-private:\",\n+\n+        # Substitutions needed for `//dev-infra/benchmark`:\n         \"//packages/benchpress\": \"@npm//@angular/benchpress\",\n         \"//packages/bazel\": \"@npm//@angular/bazel\",\n         \"//packages/zone.js/bundles:zone.umd.js\": \"@npm//zone.js\",\n         \"//packages/core\": \"@npm//@angular/core\",\n         \"//packages/platform-browser\": \"@npm//@angular/platform-browser\",\n-\n         # This substitution is particularly verbose because we need to make sure\n         # that only things available via Angular Bazel are imported from\n         # tools/defaults.bzl."
        },
        {
            "sha": "fd575c92b3ef547b9bc869d8f8b2bd287989330a",
            "filename": "dev-infra/benchmark/driver-utilities/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fbenchmark%2Fdriver-utilities%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fbenchmark%2Fdriver-utilities%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fbenchmark%2Fdriver-utilities%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,11 +1,10 @@\n-package(default_visibility = [\"//visibility:public\"])\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+package(default_visibility = [\"//visibility:public\"])\n \n ts_library(\n     name = \"driver-utilities\",\n     srcs = glob([\"*.ts\"]),\n-    module_name = \"@angular/dev-infra-private/benchmark/driver-utilities\",\n     tsconfig = \"//dev-infra/benchmark/component_benchmark:tsconfig-e2e.json\",\n     deps = [\n         \"//packages/benchpress\","
        },
        {
            "sha": "d39384ad4507b7b7368a4ec6df9082a2cbe2c021",
            "filename": "dev-infra/caretaker/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fcaretaker%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fcaretaker%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcaretaker%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,13 +1,11 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n-load(\"//tools:defaults.bzl\", \"jasmine_node_test\")\n+load(\"//dev-infra:defaults.bzl\", \"jasmine_node_test\", \"ts_library\")\n \n ts_library(\n     name = \"caretaker\",\n     srcs = glob(\n         [\"**/*.ts\"],\n         exclude = [\"**/*.spec.ts\"],\n     ),\n-    module_name = \"@angular/dev-infra-private/caretaker\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/release/versioning\",\n@@ -41,7 +39,6 @@ ts_library(\n \n jasmine_node_test(\n     name = \"test\",\n-    bootstrap = [\"//tools/testing:node_no_angular_es5\"],\n     deps = [\n         \":test_lib\",\n     ],"
        },
        {
            "sha": "bbdc0cd5ba4aced99a6aec6f675d0898f1b26982",
            "filename": "dev-infra/commit-message/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fcommit-message%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fcommit-message%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,13 +1,11 @@\n-load(\"//tools:defaults.bzl\", \"jasmine_node_test\")\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"jasmine_node_test\", \"ts_library\")\n \n ts_library(\n     name = \"commit-message\",\n     srcs = glob(\n         [\"**/*.ts\"],\n         exclude = [\"**/*.spec.ts\"],\n     ),\n-    module_name = \"@angular/dev-infra-private/commit-message\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\",\n@@ -41,7 +39,6 @@ ts_library(\n \n jasmine_node_test(\n     name = \"test\",\n-    bootstrap = [\"//tools/testing:node_no_angular_es5\"],\n     deps = [\n         \":test_lib\",\n     ],"
        },
        {
            "sha": "b7f4ad2a0847659f06e376d0395f462abea145d6",
            "filename": "dev-infra/defaults.bzl",
            "status": "added",
            "additions": 67,
            "deletions": 0,
            "changes": 67,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fdefaults.bzl",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fdefaults.bzl",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fdefaults.bzl?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -0,0 +1,67 @@\n+\"\"\"\n+  Defaults for the `//dev-infra` Bazel package. These are different than\n+  the defaults in `//tools:defaults.bzl` which are specific to the package\n+  structure as seen within `/packages/`.\n+\"\"\"\n+\n+load(\"@build_bazel_rules_nodejs//:index.bzl\", \"generated_file_test\")\n+load(\"@npm//@bazel/jasmine:index.bzl\", _jasmine_node_test = \"jasmine_node_test\")\n+load(\"@npm//@bazel/typescript:index.bzl\", _ts_library = \"ts_library\")\n+load(\"@npm//@bazel/rollup:index.bzl\", \"rollup_bundle\")\n+\n+NPM_PACKAGE_NAME = \"@angular/dev-infra-private\"\n+\n+def _compute_module_name():\n+    current_pkg = native.package_name()\n+\n+    if current_pkg == \"dev-infra\":\n+        return NPM_PACKAGE_NAME\n+\n+    # For deep targets within `//dev-infra` construct the module name in a way that matches\n+    # the structure within the NPM package (i.e. simply appending the actual package path)\n+    return \"%s/%s\" % (NPM_PACKAGE_NAME, current_pkg[len(\"dev-infra/\"):])\n+\n+def ts_library(name, **kwargs):\n+    _ts_library(\n+        name = name,\n+        # If no `module_name` is set, compute a module name based on the current Bazel\n+        # package. The module names should match the NPM package structure so that the NPM\n+        # package can be used properly. Note that we disallow any custom `module_name` for\n+        # `//dev-infra` as this usually signifies a mistake we want to raise awareness for.\n+        module_name = _compute_module_name(),\n+        # We use the module name as package name, so that the target can be resolved within\n+        # NodeJS executions, by activating the Bazel NodeJS linker.\n+        # See: https://github.com/bazelbuild/rules_nodejs/pull/2799.\n+        package_name = _compute_module_name(),\n+        **kwargs\n+    )\n+\n+def jasmine_node_test(**kwargs):\n+    _jasmine_node_test(**kwargs)\n+\n+# This file continues to serve as indicator for `rules_nodejs` and instructs it to preserve the\n+# content output in the NPM install workspace. This allows consumers to use rules and targets from\n+# within Bazel. e.g. by using `@npm//@angular/dev-infra-private/<..>`.\n+# See: https://github.com/bazelbuild/rules_nodejs/commit/4f508b1a0be1f5444e9c13b0439e649449792fef.\n+\n+def ng_dev_rolled_up_generated_file(name, entry_point, deps = [], rollup_args = []):\n+    \"\"\"Rollup and generated file test macro.\n+\n+    This provides a single macro to create a rollup bundled script and a generated file\n+    test for the created script to ensure it stays up to date in the repository.\n+    \"\"\"\n+    rollup_bundle(\n+        name = \"%s_bundle\" % name,\n+        args = rollup_args,\n+        entry_point = entry_point,\n+        format = \"cjs\",\n+        silent = True,\n+        sourcemap = \"false\",\n+        deps = deps,\n+    )\n+\n+    generated_file_test(\n+        name = name,\n+        src = \"%s.js\" % name,\n+        generated = \"%s_bundle\" % name,\n+    )"
        },
        {
            "sha": "c280f06d5148e2c5c0b60bb7c1bcdb934b8bd180",
            "filename": "dev-infra/format/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fformat%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fformat%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fformat%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,11 +1,10 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"format\",\n     srcs = glob([\n         \"**/*.ts\",\n     ]),\n-    module_name = \"@angular/dev-infra-private/format\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\","
        },
        {
            "sha": "cd495e8552cf4b72155df44633de38f701412b6d",
            "filename": "dev-infra/index.bzl",
            "status": "modified",
            "additions": 3,
            "deletions": 28,
            "changes": 31,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Findex.bzl",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Findex.bzl",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Findex.bzl?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -3,32 +3,7 @@\n # Use of this source code is governed by an MIT-style license that can be\n # found in the LICENSE file at https://angular.io/license\n \n-load(\"@build_bazel_rules_nodejs//:index.bzl\", \"generated_file_test\")\n-load(\"@npm//@bazel/rollup:index.bzl\", \"rollup_bundle\")\n-\n-# This file continues to serve as indicator for `rules_nodejs` and instructs it  preserve the\n-# content output in the NPM install workspace. This allows consumers to use rules and targets from\n-# within Bazel. e.g. by using `@npm//@angular/dev-infra-private/<..>`.\n+# File is currently empty but serves as indicator for `rules_nodejs` and instructs it to\n+# preserve the content output in the NPM install workspace. This allows consumers to use\n+# rules and targets from within Bazel. e.g. by using `@npm//@angular/dev-infra-private/<..>`.\n # See: https://github.com/bazelbuild/rules_nodejs/commit/4f508b1a0be1f5444e9c13b0439e649449792fef.\n-\n-def ng_dev_rolled_up_generated_file(name, entry_point, deps = [], rollup_args = []):\n-    \"\"\"Rollup and generated file test macro.\n-\n-    This provides a single macro to create a rollup bundled script and a generated file test for the\n-    created script to ensure it stays up to date in the repository.\n-    \"\"\"\n-    rollup_bundle(\n-        name = \"%s_bundle\" % name,\n-        args = rollup_args,\n-        entry_point = entry_point,\n-        format = \"cjs\",\n-        silent = True,\n-        sourcemap = \"false\",\n-        deps = deps,\n-    )\n-\n-    generated_file_test(\n-        name = name,\n-        src = \"%s.js\" % name,\n-        generated = \"%s_bundle\" % name,\n-    )"
        },
        {
            "sha": "49c38e1561503801f29a537db89932dff9d1d338",
            "filename": "dev-infra/misc/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fmisc%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fmisc%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fmisc%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,9 +1,8 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"misc\",\n     srcs = glob([\"**/*.ts\"]),\n-    module_name = \"@angular/dev-infra-private/misc/\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/release/build\","
        },
        {
            "sha": "a22ccaa646f88cfb447fc0d09105822d78901132",
            "filename": "dev-infra/ngbot/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fngbot%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fngbot%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fngbot%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,12 +1,11 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"ngbot\",\n     srcs = [\n         \"cli.ts\",\n         \"verify.ts\",\n     ],\n-    module_name = \"@angular/dev-infra-private/ngbot\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\","
        },
        {
            "sha": "fd55fd837eeb1ebe9d7a4759b58835cdc78a9c06",
            "filename": "dev-infra/pr/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,9 +1,8 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"pr\",\n     srcs = [\"cli.ts\"],\n-    module_name = \"@angular/dev-infra-private/pr\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/pr/check-target-branches\","
        },
        {
            "sha": "7b33c529be91a8328070372dcbb645e7a13ca178",
            "filename": "dev-infra/pr/check-target-branches/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fcheck-target-branches%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fcheck-target-branches%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fcheck-target-branches%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,9 +1,8 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"check-target-branches\",\n     srcs = glob([\"*.ts\"]),\n-    module_name = \"@angular/dev-infra-private/pr/check-target-branches\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/pr/merge\","
        },
        {
            "sha": "a1a2b3e3e24dff82c8d3817f689a3d49f679719d",
            "filename": "dev-infra/pr/checkout/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fcheckout%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fcheckout%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fcheckout%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,9 +1,8 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"checkout\",\n     srcs = glob([\"*.ts\"]),\n-    module_name = \"@angular/dev-infra-private/pr/checkout\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/pr/common\","
        },
        {
            "sha": "36c43925dffb49a4321a9a9806506442f44956bf",
            "filename": "dev-infra/pr/common/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fcommon%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fcommon%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fcommon%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,9 +1,8 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"common\",\n     srcs = glob([\"*.ts\"]),\n-    module_name = \"@angular/dev-infra-private/pr/common\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\","
        },
        {
            "sha": "3ea331122bf6f73dd8a7801477a26c4c3f1dcb63",
            "filename": "dev-infra/pr/discover-new-conflicts/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fdiscover-new-conflicts%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fdiscover-new-conflicts%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fdiscover-new-conflicts%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,12 +1,11 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"discover-new-conflicts\",\n     srcs = [\n         \"cli.ts\",\n         \"index.ts\",\n     ],\n-    module_name = \"@angular/dev-infra-private/pr/discover-new-conflicts\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\","
        },
        {
            "sha": "e1d94a8c6a452e6ad85595eac39b9df02d9e5fa0",
            "filename": "dev-infra/pr/merge/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fmerge%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Fmerge%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Fmerge%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,13 +1,12 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n-load(\"//tools:defaults.bzl\", \"jasmine_node_test\")\n+load(\"//dev-infra:defaults.bzl\", \"jasmine_node_test\", \"ts_library\")\n \n ts_library(\n     name = \"merge\",\n     srcs = glob(\n         [\"**/*.ts\"],\n         exclude = [\"**/*.spec.ts\"],\n     ),\n-    module_name = \"@angular/dev-infra-private/pr/merge\",\n+\n     # prodmode target must be set to es5 as the Ora class, which is extended is not a proper\n     # prototyped object.\n     prodmode_target = \"es5\","
        },
        {
            "sha": "9d1d58a2dba1c70d08cf507a80934a6c1bd3727a",
            "filename": "dev-infra/pr/rebase/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Frebase%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpr%2Frebase%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpr%2Frebase%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,12 +1,11 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"rebase\",\n     srcs = [\n         \"cli.ts\",\n         \"index.ts\",\n     ],\n-    module_name = \"@angular/dev-infra-private/pr/rebase\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/commit-message\","
        },
        {
            "sha": "94bda2d50990478b512d49884777d1a350e44af8",
            "filename": "dev-infra/pullapprove/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpullapprove%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fpullapprove%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fpullapprove%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,5 +1,4 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n-load(\"//tools:defaults.bzl\", \"jasmine_node_test\")\n+load(\"//dev-infra:defaults.bzl\", \"jasmine_node_test\", \"ts_library\")\n \n ts_library(\n     name = \"pullapprove\",\n@@ -13,7 +12,6 @@ ts_library(\n         \"utils.ts\",\n         \"verify.ts\",\n     ],\n-    module_name = \"@angular/dev-infra-private/pullapprove\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\","
        },
        {
            "sha": "0c7b884256358387aa988e8818ba79a84ab4f4d4",
            "filename": "dev-infra/release/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,11 +1,10 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"release\",\n     srcs = glob([\n         \"**/*.ts\",\n     ]),\n-    module_name = \"@angular/dev-infra-private/release\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/release/build\","
        },
        {
            "sha": "de0198f8b45903dc784bbdfecfbff4ad783e4271",
            "filename": "dev-infra/release/build/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fbuild%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fbuild%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fbuild%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,5 +1,4 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n-load(\"//tools:defaults.bzl\", \"jasmine_node_test\")\n+load(\"//dev-infra:defaults.bzl\", \"jasmine_node_test\", \"ts_library\")\n \n exports_files([\n     \"build-worker.ts\",\n@@ -13,7 +12,6 @@ ts_library(\n         ],\n         exclude = [\"*.spec.ts\"],\n     ),\n-    module_name = \"@angular/dev-infra-private/release/build\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/release/config\","
        },
        {
            "sha": "c8170c2acab4a47a77c077b694cfad8c1aa246e5",
            "filename": "dev-infra/release/config/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fconfig%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fconfig%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fconfig%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,11 +1,10 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"config\",\n     srcs = glob([\n         \"**/*.ts\",\n     ]),\n-    module_name = \"@angular/dev-infra-private/release/config\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\","
        },
        {
            "sha": "62b6cdf6fa4887b71a3e7e7a0890099ecebdb9a1",
            "filename": "dev-infra/release/info/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Finfo%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Finfo%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Finfo%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,9 +1,8 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"info\",\n     srcs = [\"cli.ts\"],\n-    module_name = \"@angular/dev-infra-private/release/info\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/release/config\","
        },
        {
            "sha": "7fabae8cc6bef1419897931a681b8e0bc92f7456",
            "filename": "dev-infra/release/notes/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fnotes%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fnotes%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fnotes%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,11 +1,10 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"notes\",\n     srcs = glob([\n         \"**/*.ts\",\n     ]),\n-    module_name = \"@angular/dev-infra-private/release/notes\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/commit-message\","
        },
        {
            "sha": "ec03dfbdf7b2c6c445b69b3896b3504aca836c33",
            "filename": "dev-infra/release/publish/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fpublish%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fpublish%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,11 +1,10 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"publish\",\n     srcs = glob([\n         \"**/*.ts\",\n     ]),\n-    module_name = \"@angular/dev-infra-private/release/publish\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/commit-message\","
        },
        {
            "sha": "b27935084d9c4796c4e1e32177b18feeb3e88a76",
            "filename": "dev-infra/release/publish/test/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fpublish%2Ftest%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fpublish%2Ftest%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fpublish%2Ftest%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,12 +1,10 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n-load(\"//tools:defaults.bzl\", \"jasmine_node_test\")\n+load(\"//dev-infra:defaults.bzl\", \"jasmine_node_test\", \"ts_library\")\n \n ts_library(\n     name = \"test_lib\",\n     srcs = glob([\n         \"**/*.ts\",\n     ]),\n-    module_name = \"@angular/dev-infra-private/release/test\",\n     deps = [\n         \"//dev-infra/commit-message\",\n         \"//dev-infra/release/config\","
        },
        {
            "sha": "3e2f49d3fcf273bc57511d530621a9b18f595138",
            "filename": "dev-infra/release/set-dist-tag/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fset-dist-tag%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fset-dist-tag%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fset-dist-tag%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,5 +1,4 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n-load(\"//tools:defaults.bzl\", \"jasmine_node_test\")\n+load(\"//dev-infra:defaults.bzl\", \"jasmine_node_test\", \"ts_library\")\n \n ts_library(\n     name = \"set-dist-tag\",\n@@ -9,7 +8,6 @@ ts_library(\n         ],\n         exclude = [\"*.spec.ts\"],\n     ),\n-    module_name = \"@angular/dev-infra-private/release/set-dist-tag\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/release/config\","
        },
        {
            "sha": "7a486a5d8f315928c293bb81dd6cc1e8ace07582",
            "filename": "dev-infra/release/versioning/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fversioning%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Frelease%2Fversioning%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Frelease%2Fversioning%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,11 +1,10 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"versioning\",\n     srcs = glob([\n         \"**/*.ts\",\n     ]),\n-    module_name = \"@angular/dev-infra-private/release/versioning\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/release/config\","
        },
        {
            "sha": "13fbc819e06cc705c6448f0faf3bb5b761dc02c5",
            "filename": "dev-infra/ts-circular-dependencies/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fts-circular-dependencies%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Fts-circular-dependencies%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fts-circular-dependencies%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,9 +1,8 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"ts-circular-dependencies\",\n     srcs = glob([\"*.ts\"]),\n-    module_name = \"@angular/dev-infra-private/ts-circular-dependencies\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\","
        },
        {
            "sha": "09c4f9954bb5be98b1505cac0487be452fdd1e6e",
            "filename": "dev-infra/utils/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Futils%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Futils%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,12 +1,12 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"utils\",\n     srcs = glob([\n         \"*.ts\",\n         \"git/*.ts\",\n     ]),\n-    module_name = \"@angular/dev-infra-private/utils\",\n+\n     # prodmode target must be set to es5 as the Octokit class, which is extended is not a proper\n     # prototyped object.\n     prodmode_target = \"es5\","
        },
        {
            "sha": "160d4391971ae6c8be0ab77d9d15a1a9f94d7ee3",
            "filename": "dev-infra/utils/testing/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Futils%2Ftesting%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/dev-infra%2Futils%2Ftesting%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Futils%2Ftesting%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,9 +1,8 @@\n-load(\"@npm//@bazel/typescript:index.bzl\", \"ts_library\")\n+load(\"//dev-infra:defaults.bzl\", \"ts_library\")\n \n ts_library(\n     name = \"testing\",\n     srcs = glob([\"*.ts\"]),\n-    module_name = \"@angular/dev-infra-private/utils/testing\",\n     visibility = [\"//dev-infra:__subpackages__\"],\n     deps = [\n         \"//dev-infra/utils\","
        },
        {
            "sha": "130abd1ec9cb4cef459ef2f1b43582e31b9ed1ee",
            "filename": "package.json",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/package.json",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/package.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/package.json?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -54,13 +54,13 @@\n     \"@babel/template\": \"7.8.6\",\n     \"@babel/traverse\": \"7.8.6\",\n     \"@babel/types\": \"7.8.6\",\n-    \"@bazel/concatjs\": \"3.7.0\",\n-    \"@bazel/jasmine\": \"3.7.0\",\n-    \"@bazel/protractor\": \"3.7.0\",\n-    \"@bazel/rollup\": \"3.7.0\",\n-    \"@bazel/runfiles\": \"3.7.0\",\n-    \"@bazel/terser\": \"3.7.0\",\n-    \"@bazel/typescript\": \"3.7.0\",\n+    \"@bazel/concatjs\": \"4.0.0-beta.0\",\n+    \"@bazel/jasmine\": \"4.0.0-beta.0\",\n+    \"@bazel/protractor\": \"4.0.0-beta.0\",\n+    \"@bazel/rollup\": \"4.0.0-beta.0\",\n+    \"@bazel/runfiles\": \"4.0.0-beta.0\",\n+    \"@bazel/terser\": \"4.0.0-beta.0\",\n+    \"@bazel/typescript\": \"4.0.0-beta.0\",\n     \"@microsoft/api-extractor\": \"7.18.1\",\n     \"@octokit/rest\": \"^18.6.2\",\n     \"@octokit/core\": \"^3.5.1\","
        },
        {
            "sha": "23b98820f0afe850157be136a9ced65a867a3f8e",
            "filename": "packages/compiler-cli/src/ngtsc/testing/fake_common/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Ffake_common%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Ffake_common%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Ffake_common%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,7 +1,7 @@\n-package(default_visibility = [\"//visibility:public\"])\n-\n load(\"//tools:defaults.bzl\", \"ng_package\", \"ts_library\")\n \n+package(default_visibility = [\"//visibility:public\"])\n+\n ts_library(\n     name = \"fake_common\",\n     srcs = ["
        },
        {
            "sha": "18a4907a680653ff69a52c9ec9f2e91d0102caa6",
            "filename": "packages/compiler-cli/src/ngtsc/testing/fake_core/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Ffake_core%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Ffake_core%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Ftesting%2Ffake_core%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,7 +1,7 @@\n-package(default_visibility = [\"//visibility:public\"])\n-\n load(\"//tools:defaults.bzl\", \"ng_package\", \"ts_library\")\n \n+package(default_visibility = [\"//visibility:public\"])\n+\n ts_library(\n     name = \"fake_core\",\n     srcs = ["
        },
        {
            "sha": "bdbce87d4d28a79e1b75e2e881dc910d1e2fb255",
            "filename": "packages/compiler-cli/test/compliance/partial/partial_compliance_goldens.bzl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Fpartial%2Fpartial_compliance_goldens.bzl",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Fpartial%2Fpartial_compliance_goldens.bzl",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Ftest%2Fcompliance%2Fpartial%2Fpartial_compliance_goldens.bzl?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -49,7 +49,7 @@ def partial_compliance_golden(filePath):\n         stdout = \"%s/this_file_should_not_be_committed\" % path,\n         link_workspace_root = True,\n         visibility = [\":__pkg__\"],\n-        data = data,\n+        data = [],\n     )\n \n     generated_file_test("
        },
        {
            "sha": "2a2f7ded97fd1881966cafcfaf7431aca13df41f",
            "filename": "packages/localize/src/tools/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/packages%2Flocalize%2Fsrc%2Ftools%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/packages%2Flocalize%2Fsrc%2Ftools%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Flocalize%2Fsrc%2Ftools%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1,7 +1,7 @@\n-package(default_visibility = [\"//visibility:public\"])\n-\n load(\"//tools:defaults.bzl\", \"pkg_npm\", \"ts_config\", \"ts_library\")\n \n+package(default_visibility = [\"//visibility:public\"])\n+\n ts_config(\n     name = \"tsconfig\",\n     src = \"tsconfig-build.json\","
        },
        {
            "sha": "4132a69fd0a483680625d7890590739e20d88f2d",
            "filename": "tools/defaults.bzl",
            "status": "modified",
            "additions": 53,
            "deletions": 2,
            "changes": 55,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/tools%2Fdefaults.bzl",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/tools%2Fdefaults.bzl",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/tools%2Fdefaults.bzl?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -94,7 +94,7 @@ def ts_devserver(**kwargs):\n \n ts_config = _ts_config\n \n-def ts_library(name, tsconfig = None, testonly = False, deps = [], module_name = None, **kwargs):\n+def ts_library(name, tsconfig = None, testonly = False, deps = [], module_name = None, package_name = None, **kwargs):\n     \"\"\"Default values for ts_library\"\"\"\n     deps = deps + [\"@npm//tslib\"]\n     if testonly:\n@@ -108,12 +108,22 @@ def ts_library(name, tsconfig = None, testonly = False, deps = [], module_name =\n     if not module_name:\n         module_name = _default_module_name(testonly)\n \n+    # If no `package_name` is explicitly set, we use the default module name as package\n+    # name, so that the target can be resolved within NodeJS executions, by activating\n+    # the Bazel NodeJS linker. See: https://github.com/bazelbuild/rules_nodejs/pull/2799.\n+    if not package_name:\n+        package_name = _default_module_name(testonly)\n+\n     _ts_library(\n         name = name,\n         tsconfig = tsconfig,\n         testonly = testonly,\n         deps = deps,\n+        # `module_name` is used for AMD module names within emitted JavaScript files.\n         module_name = module_name,\n+        # `package_name` can be set to allow for the Bazel NodeJS linker to run. This\n+        # allows for resolution of the given target within the `node_modules/`.\n+        package_name = package_name,\n         **kwargs\n     )\n \n@@ -128,7 +138,7 @@ def ts_library(name, tsconfig = None, testonly = False, deps = [], module_name =\n         output_group = \"es5_sources\",\n     )\n \n-def ng_module(name, tsconfig = None, entry_point = None, testonly = False, deps = [], module_name = None, bundle_dts = True, **kwargs):\n+def ng_module(name, tsconfig = None, entry_point = None, testonly = False, deps = [], module_name = None, package_name = None, bundle_dts = True, **kwargs):\n     \"\"\"Default values for ng_module\"\"\"\n     deps = deps + [\"@npm//tslib\"]\n     if testonly:\n@@ -141,6 +151,13 @@ def ng_module(name, tsconfig = None, entry_point = None, testonly = False, deps\n \n     if not module_name:\n         module_name = _default_module_name(testonly)\n+\n+    # If no `package_name` is explicitly set, we use the default module name as package\n+    # name, so that the target can be resolved within NodeJS executions, by activating\n+    # the Bazel NodeJS linker. See: https://github.com/bazelbuild/rules_nodejs/pull/2799.\n+    if not package_name:\n+        package_name = _default_module_name(testonly)\n+\n     if not entry_point:\n         entry_point = \"public_api.ts\"\n     _ng_module(\n@@ -154,7 +171,11 @@ def ng_module(name, tsconfig = None, entry_point = None, testonly = False, deps\n         compiler = _INTERNAL_NG_MODULE_COMPILER,\n         api_extractor = _INTERNAL_NG_MODULE_API_EXTRACTOR,\n         ng_xi18n = _INTERNAL_NG_MODULE_XI18N,\n+        # `module_name` is used for AMD module names within emitted JavaScript files.\n         module_name = module_name,\n+        # `package_name` can be set to allow for the Bazel NodeJS linker to run. This\n+        # allows for resolution of the given target within the `node_modules/`.\n+        package_name = package_name,\n         perf_flag = \"//packages/compiler-cli:ng_perf\",\n         **kwargs\n     )\n@@ -181,6 +202,21 @@ def ng_package(name, readme_md = None, license_banner = None, deps = [], **kwarg\n     _ng_package(\n         name = name,\n         deps = deps,\n+        # We never set a `package_name` for NPM packages, neither do we enable validation.\n+        # This is necessary because the source targets of the NPM packages all have\n+        # package names set and setting a similar `package_name` on the NPM package would\n+        # result in duplicate linker mappings that will conflict. e.g. consider the following\n+        # scenario: We have a `ts_library` for `@angular/core`. We will configure a package\n+        # name for the target so that it can be resolved in NodeJS executions from `node_modules`.\n+        # If we'd also set a `package_name` for the associated `pkg_npm` target, there would be\n+        # two mappings for `@angular/core` and the linker will complain. For a better development\n+        # experience, we want the mapping to resolve to the direct outputs of the `ts_library`\n+        # instead of requiring tests and other targets to assemble the NPM package first.\n+        # TODO(devversion): consider removing this if `rules_nodejs` allows for duplicate\n+        # linker mappings where transitive-determined mappings are skipped on conflicts.\n+        # https://github.com/bazelbuild/rules_nodejs/issues/2810.\n+        package_name = None,\n+        validate = False,\n         readme_md = readme_md,\n         license_banner = license_banner,\n         substitutions = select({\n@@ -218,6 +254,21 @@ def pkg_npm(name, **kwargs):\n \n     _pkg_npm(\n         name = name,\n+        # We never set a `package_name` for NPM packages, neither do we enable validation.\n+        # This is necessary because the source targets of the NPM packages all have\n+        # package names set and setting a similar `package_name` on the NPM package would\n+        # result in duplicate linker mappings that will conflict. e.g. consider the following\n+        # scenario: We have a `ts_library` for `@angular/core`. We will configure a package\n+        # name for the target so that it can be resolved in NodeJS executions from `node_modules`.\n+        # If we'd also set a `package_name` for the associated `pkg_npm` target, there would be\n+        # two mappings for `@angular/core` and the linker will complain. For a better development\n+        # experience, we want the mapping to resolve to the direct outputs of the `ts_library`\n+        # instead of requiring tests and other targets to assemble the NPM package first.\n+        # TODO(devversion): consider removing this if `rules_nodejs` allows for duplicate\n+        # linker mappings where transitive-determined mappings are skipped on conflicts.\n+        # https://github.com/bazelbuild/rules_nodejs/issues/2810.\n+        package_name = None,\n+        validate = False,\n         substitutions = select({\n             \"//:stamp\": stamped_substitutions,\n             \"//conditions:default\": substitutions,"
        },
        {
            "sha": "d408c31f5d8858d0c4add083e899e515d7b8a195",
            "filename": "tools/ts-api-guardian/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/tools%2Fts-api-guardian%2FBUILD.bazel",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/tools%2Fts-api-guardian%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/tools%2Fts-api-guardian%2FBUILD.bazel?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -31,6 +31,7 @@ genrule(\n \n pkg_npm(\n     name = \"ts-api-guardian\",\n+    package_name = \"ts-api-guardian\",\n     srcs = [\n         \"BUILD.bazel\",\n         \"README.md\","
        },
        {
            "sha": "c1cb0289d7d6adf3803c524e1f52434c354df77f",
            "filename": "yarn.lock",
            "status": "modified",
            "additions": 28,
            "deletions": 29,
            "changes": 57,
            "blob_url": "https://github.com/angular/angular/blob/762e057e85fe92149d48aa0c5bc9168147d45d5c/yarn.lock",
            "raw_url": "https://github.com/angular/angular/raw/762e057e85fe92149d48aa0c5bc9168147d45d5c/yarn.lock",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/yarn.lock?ref=762e057e85fe92149d48aa0c5bc9168147d45d5c",
            "patch": "@@ -1008,10 +1008,10 @@\n   resolved \"https://registry.yarnpkg.com/@bazel/buildifier/-/buildifier-4.0.1.tgz#52cfbad5cbb86e9183a29dde2370cd465730ea0d\"\n   integrity sha512-BTmtvJbeeEVrqRApI1gr5hvPgYcHLpdGJ5EXNXEWO692ztMPSj5fB/dH0xUlaW45jn6LimYx8ymqTMhj3538og==\n \n-\"@bazel/concatjs@3.7.0\":\n-  version \"3.7.0\"\n-  resolved \"https://registry.yarnpkg.com/@bazel/concatjs/-/concatjs-3.7.0.tgz#f10649d97d93d96bfe815d6b0c620acad394f799\"\n-  integrity sha512-E+mA3huykyBMcRbhAOYbfmfMIOZD6QtXs6i+IhJQed8DYQLSYf9E2Jq8T/rFefFyZv+loJIAr4JhkAIO5vuFWg==\n+\"@bazel/concatjs@4.0.0-beta.0\":\n+  version \"4.0.0-beta.0\"\n+  resolved \"https://registry.yarnpkg.com/@bazel/concatjs/-/concatjs-4.0.0-beta.0.tgz#f1dddefe2cefc543ec61f06c5bc28c908bfb4569\"\n+  integrity sha512-azGMcLwOIEEbTHm0ORCsSMZ5yBIQaRWlWMN3b7M5uD6C646EaiM7b2wx8CkOJlyZrZOLEajjvePvN7lqkPM1Cg==\n   dependencies:\n     protobufjs \"6.8.8\"\n     source-map-support \"0.5.9\"\n@@ -1022,38 +1022,38 @@\n   resolved \"https://registry.yarnpkg.com/@bazel/ibazel/-/ibazel-0.15.10.tgz#cf0cff1aec6d8e7bb23e1fc618d09fbd39b7a13f\"\n   integrity sha512-0v+OwCQ6fsGFa50r6MXWbUkSGuWOoZ22K4pMSdtWiL5LKFIE4kfmMmtQS+M7/ICNwk2EIYob+NRreyi/DGUz5A==\n \n-\"@bazel/jasmine@3.7.0\":\n-  version \"3.7.0\"\n-  resolved \"https://registry.yarnpkg.com/@bazel/jasmine/-/jasmine-3.7.0.tgz#9d8ed4c73abb4a927cdffecf5c4c877f969d886b\"\n-  integrity sha512-q6Nt1T83isYjIcxQrLkvWCzX6R9oDBwDDN9Hx/vQuvLKMRHSCuj8hkhf42waR9SzTiVHXNDv39l4IwvFhVkfvA==\n+\"@bazel/jasmine@4.0.0-beta.0\":\n+  version \"4.0.0-beta.0\"\n+  resolved \"https://registry.yarnpkg.com/@bazel/jasmine/-/jasmine-4.0.0-beta.0.tgz#575e9cd88932b19c54447fba43cbd62e14ff3022\"\n+  integrity sha512-VYEAaHCi8ot0aSMKbIio6usJZqvINd7LzrrGoChGAGwMgGEpTfMGdprwdlrQPKD6/GbLkVtkCcsViG92ynXhdQ==\n   dependencies:\n     c8 \"~7.5.0\"\n     jasmine-reporters \"~2.4.0\"\n \n-\"@bazel/protractor@3.7.0\":\n-  version \"3.7.0\"\n-  resolved \"https://registry.yarnpkg.com/@bazel/protractor/-/protractor-3.7.0.tgz#04715069cfbf9a8fef147e5d5323ceae434e9a0d\"\n-  integrity sha512-P/PYAvy2UP8SMfwgOYqNO7OCPkt0A1xsCVXskbiImXRZnG+zyRurA9Orz5OIEo1fagr2N+0wylquqO/+jc7T/A==\n+\"@bazel/protractor@4.0.0-beta.0\":\n+  version \"4.0.0-beta.0\"\n+  resolved \"https://registry.yarnpkg.com/@bazel/protractor/-/protractor-4.0.0-beta.0.tgz#fcabfd5c32005fcb93b80f83bcf99058bcf07d4f\"\n+  integrity sha512-cIlqzPEXu3zFhFR+5Vqo5D/qLkOEY/gZ1xc74/V/CVAlbkCZsWJ18gDE1bhca9t1Mj41igDqwlvXUndxdQjNtw==\n \n-\"@bazel/rollup@3.7.0\":\n-  version \"3.7.0\"\n-  resolved \"https://registry.yarnpkg.com/@bazel/rollup/-/rollup-3.7.0.tgz#6045d44f39ebc213fd2f3672421a35d20d9abf37\"\n-  integrity sha512-B9Gut5wdANpnQCUwwp9q/UAU5MNhfUpjTyygNUWoRWAQXRFgmSgsC0Gr5RaWHx9bugaiyPQbPDmb3cYTU+4RQQ==\n+\"@bazel/rollup@4.0.0-beta.0\":\n+  version \"4.0.0-beta.0\"\n+  resolved \"https://registry.yarnpkg.com/@bazel/rollup/-/rollup-4.0.0-beta.0.tgz#ec4bc88f401bd555d43c55c34183cda4f004ae96\"\n+  integrity sha512-CAl5+iNuVgFA52zOFmoQvY9LpjEf/hPiw/PRPXR0JrXy83xk+Nxnrv7UKvP4Jmux+K24uDf+ZOIr62rGzMHVhA==\n \n-\"@bazel/runfiles@3.7.0\":\n-  version \"3.7.0\"\n-  resolved \"https://registry.yarnpkg.com/@bazel/runfiles/-/runfiles-3.7.0.tgz#c00eeee9b7e7c3993f95cab5ad3cced17949869a\"\n-  integrity sha512-lAj01NxpnHvvyHY1TquaQADFex5hfqmDH5KR7US63rpEuDazaGCk1WxEE/3PzZPUq4kyT6PNPLhuNB+OW1lupQ==\n+\"@bazel/runfiles@4.0.0-beta.0\":\n+  version \"4.0.0-beta.0\"\n+  resolved \"https://registry.yarnpkg.com/@bazel/runfiles/-/runfiles-4.0.0-beta.0.tgz#e62679d80cf9fcd84996e5f3ae4bedc33ed1a993\"\n+  integrity sha512-pFdanyvI0wf2WtdQXUmcTZw7OJ83uj2bxF3rOskx45wewBRAlQZkm2q2A6WEffSfdf2WaBlk5u/x2kqK2nyG7w==\n \n-\"@bazel/terser@3.7.0\":\n-  version \"3.7.0\"\n-  resolved \"https://registry.yarnpkg.com/@bazel/terser/-/terser-3.7.0.tgz#a2b3e7488b0c2245add46e0cbf9e89e047223c79\"\n-  integrity sha512-uvs0ir7me/KSIm4YGhkPolIjs+Fzjg6JrkRg8CYjnVLz+I6Ajr2+X9e3ylZP+0lNWhqJkkCjXm1jybPTUV5RKQ==\n+\"@bazel/terser@4.0.0-beta.0\":\n+  version \"4.0.0-beta.0\"\n+  resolved \"https://registry.yarnpkg.com/@bazel/terser/-/terser-4.0.0-beta.0.tgz#2ca1c59e1e109e2f3b0c561b534730a035844a26\"\n+  integrity sha512-qGDLsmg2ekEojDHrTEiPJd0bdqbCPT2/YImsZhg1swpLEFnFCLCUNVnESt62Wd6bKonzvQeFo8zpKaCK326e4g==\n \n-\"@bazel/typescript@3.7.0\":\n-  version \"3.7.0\"\n-  resolved \"https://registry.yarnpkg.com/@bazel/typescript/-/typescript-3.7.0.tgz#a4d648a36f7ef4960c8a16222f853a4c285a522d\"\n-  integrity sha512-bkNHZaCWg4Jk+10wzhFDhB+RRZkfob/yydC4qRzUVxCDLPFICYgC0PWeLhf/ixEhVeHtS0Cmv74M+QziqKSdbw==\n+\"@bazel/typescript@4.0.0-beta.0\":\n+  version \"4.0.0-beta.0\"\n+  resolved \"https://registry.yarnpkg.com/@bazel/typescript/-/typescript-4.0.0-beta.0.tgz#daf2fb0d0bdcd3df331d4320463b1a4beca6031c\"\n+  integrity sha512-dfI3QLQ5bLyK3BIrrwxuH9cLbMHuku0UZH7nwjHjXwQX70O0MSGN6yXx2Vrqatj2iw/UfHX/akPuhGlNqrDFRw==\n   dependencies:\n     protobufjs \"6.8.8\"\n     semver \"5.6.0\"\n@@ -11999,7 +11999,6 @@ sauce-connect-launcher@^1.2.4:\n \n \"sauce-connect@https://saucelabs.com/downloads/sc-4.6.2-linux.tar.gz\":\n   version \"0.0.0\"\n-  uid \"7b7f35433af9c3380758e048894d7b9aecf3754e\"\n   resolved \"https://saucelabs.com/downloads/sc-4.6.2-linux.tar.gz#7b7f35433af9c3380758e048894d7b9aecf3754e\"\n \n saucelabs@^1.5.0:"
        }
    ],
    "stats": {
        "total": 342,
        "additions": 201,
        "deletions": 141
    }
}