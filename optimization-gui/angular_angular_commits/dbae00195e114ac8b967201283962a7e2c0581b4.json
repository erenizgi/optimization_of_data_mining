{
    "author": "dimakuba",
    "message": "feat(router): ability to provide custom route reuse strategy via DI for `RouterTestingModule` (#42434)\n\nFor now it's not possible to provide custom route reuse strategy via DI\nfor `RouterTestingModule`, only imperative instantiation. These changes\nmakes it possible to provide custom route reuse strategy via DI.\n\nPR Close #42434",
    "sha": "dbae00195e114ac8b967201283962a7e2c0581b4",
    "files": [
        {
            "sha": "b3bc41553b9b5e544588e2e28cfcfa7f41260a0d",
            "filename": "packages/router/test/integration.spec.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/dbae00195e114ac8b967201283962a7e2c0581b4/packages%2Frouter%2Ftest%2Fintegration.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/dbae00195e114ac8b967201283962a7e2c0581b4/packages%2Frouter%2Ftest%2Fintegration.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fintegration.spec.ts?ref=dbae00195e114ac8b967201283962a7e2c0581b4",
            "patch": "@@ -5647,6 +5647,17 @@ describe('Integration', () => {\n       }\n     }\n \n+    it('should be injectable', () => {\n+      TestBed.configureTestingModule({\n+        imports: [RouterTestingModule],\n+        providers: [{provide: RouteReuseStrategy, useClass: AttachDetachReuseStrategy}]\n+      });\n+\n+      const router = TestBed.inject(Router);\n+\n+      expect(router.routeReuseStrategy).toBeInstanceOf(AttachDetachReuseStrategy);\n+    });\n+\n     it('should support attaching & detaching fragments',\n        fakeAsync(inject([Router, Location], (router: Router, location: Location) => {\n          const fixture = createRoot(router, RootCmp);"
        },
        {
            "sha": "a1ee2b000d67c87ff44c2c48cfa6f84b3bbb412a",
            "filename": "packages/router/testing/src/router_testing_module.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 3,
            "changes": 13,
            "blob_url": "https://github.com/angular/angular/blob/dbae00195e114ac8b967201283962a7e2c0581b4/packages%2Frouter%2Ftesting%2Fsrc%2Frouter_testing_module.ts",
            "raw_url": "https://github.com/angular/angular/raw/dbae00195e114ac8b967201283962a7e2c0581b4/packages%2Frouter%2Ftesting%2Fsrc%2Frouter_testing_module.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftesting%2Fsrc%2Frouter_testing_module.ts?ref=dbae00195e114ac8b967201283962a7e2c0581b4",
            "patch": "@@ -9,7 +9,7 @@\n import {Location, LocationStrategy} from '@angular/common';\n import {MockLocationStrategy, SpyLocation} from '@angular/common/testing';\n import {Compiler, Injectable, Injector, ModuleWithProviders, NgModule, NgModuleFactory, NgModuleFactoryLoader, Optional} from '@angular/core';\n-import {ChildrenOutletContexts, ExtraOptions, NoPreloading, PreloadingStrategy, provideRoutes, Route, Router, ROUTER_CONFIGURATION, RouterModule, ROUTES, Routes, UrlHandlingStrategy, UrlSerializer, ɵassignExtraOptionsToRouter as assignExtraOptionsToRouter, ɵflatten as flatten, ɵROUTER_PROVIDERS as ROUTER_PROVIDERS} from '@angular/router';\n+import {ChildrenOutletContexts, ExtraOptions, NoPreloading, PreloadingStrategy, provideRoutes, Route, Router, ROUTER_CONFIGURATION, RouteReuseStrategy, RouterModule, ROUTES, Routes, UrlHandlingStrategy, UrlSerializer, ɵassignExtraOptionsToRouter as assignExtraOptionsToRouter, ɵflatten as flatten, ɵROUTER_PROVIDERS as ROUTER_PROVIDERS} from '@angular/router';\n \n \n \n@@ -115,7 +115,8 @@ export function setupTestingRouter(\n export function setupTestingRouter(\n     urlSerializer: UrlSerializer, contexts: ChildrenOutletContexts, location: Location,\n     loader: NgModuleFactoryLoader, compiler: Compiler, injector: Injector, routes: Route[][],\n-    opts?: ExtraOptions|UrlHandlingStrategy, urlHandlingStrategy?: UrlHandlingStrategy) {\n+    opts?: ExtraOptions|UrlHandlingStrategy, urlHandlingStrategy?: UrlHandlingStrategy,\n+    routeReuseStrategy?: RouteReuseStrategy) {\n   const router = new Router(\n       null!, urlSerializer, contexts, location, injector, loader, compiler, flatten(routes));\n   if (opts) {\n@@ -131,6 +132,11 @@ export function setupTestingRouter(\n   if (urlHandlingStrategy) {\n     router.urlHandlingStrategy = urlHandlingStrategy;\n   }\n+\n+  if (routeReuseStrategy) {\n+    router.routeReuseStrategy = routeReuseStrategy;\n+  }\n+\n   return router;\n }\n \n@@ -170,7 +176,8 @@ export function setupTestingRouter(\n       useFactory: setupTestingRouter,\n       deps: [\n         UrlSerializer, ChildrenOutletContexts, Location, NgModuleFactoryLoader, Compiler, Injector,\n-        ROUTES, ROUTER_CONFIGURATION, [UrlHandlingStrategy, new Optional()]\n+        ROUTES, ROUTER_CONFIGURATION, [UrlHandlingStrategy, new Optional()],\n+        [RouteReuseStrategy, new Optional()]\n       ]\n     },\n     {provide: PreloadingStrategy, useExisting: NoPreloading}, provideRoutes([])"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 21,
        "deletions": 3
    }
}