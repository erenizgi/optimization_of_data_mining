{
    "author": "mhevery",
    "message": "refactor(core): Change `TemplateFixture` to named parameters (#39233)\n\n`TemplateFixture` used to have positional parameters and many tests got\nhard to read as number of parameters reach 10+ with many of them `null`.\nThis refactoring changes `TemplateFixture` to take named parameters\nwhich improves usability and readability in tests.\n\nPR Close #39233",
    "sha": "61d56be83ef864b2ca3709bb60bdf0eaa175523e",
    "files": [
        {
            "sha": "0aafa531591619f3f65fc6cdc10beee1ea09c34c",
            "filename": "packages/core/src/render3/instructions/advance.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fadvance.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fadvance.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fadvance.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -5,7 +5,8 @@\n  * Use of this source code is governed by an MIT-style license that can be\n  * found in the LICENSE file at https://angular.io/license\n  */\n-import {assertGreaterThan, assertIndexInRange} from '../../util/assert';\n+import {assertGreaterThan} from '../../util/assert';\n+import {assertIndexInDeclRange} from '../assert';\n import {executeCheckHooks, executeInitAndCheckHooks} from '../hooks';\n import {FLAGS, HEADER_OFFSET, InitPhaseState, LView, LViewFlags, TView} from '../interfaces/view';\n import {getLView, getSelectedIndex, getTView, isInCheckNoChangesMode, setSelectedIndex} from '../state';\n@@ -41,8 +42,7 @@ export function ɵɵadvance(delta: number): void {\n \n export function selectIndexInternal(\n     tView: TView, lView: LView, index: number, checkNoChangesMode: boolean) {\n-  ngDevMode && assertGreaterThan(index, -1, 'Invalid index');\n-  ngDevMode && assertIndexInRange(lView, index + HEADER_OFFSET);\n+  ngDevMode && assertIndexInDeclRange(lView, index + HEADER_OFFSET);\n \n   // Flush the initial hooks for elements in the view that have been added up to this point.\n   // PERF WARNING: do NOT extract this to a separate function without running benchmarks"
        },
        {
            "sha": "863a3832f8832f949ced13323ba923bc8616b90b",
            "filename": "packages/core/src/render3/instructions/shared.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fshared.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fshared.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Finstructions%2Fshared.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -29,7 +29,7 @@ import {NodeInjectorFactory, NodeInjectorOffset} from '../interfaces/injector';\n import {AttributeMarker, InitialInputData, InitialInputs, LocalRefExtractor, PropertyAliases, PropertyAliasValue, TAttributes, TConstantsOrFactory, TContainerNode, TDirectiveHostNode, TElementContainerNode, TElementNode, TIcuContainerNode, TNode, TNodeFlags, TNodeProviderIndexes, TNodeType, TProjectionNode} from '../interfaces/node';\n import {isProceduralRenderer, RComment, RElement, Renderer3, RendererFactory3, RNode, RText} from '../interfaces/renderer';\n import {SanitizerFn} from '../interfaces/sanitization';\n-import {isComponentDef, isComponentHost, isContentQueryHost, isLContainer, isRootView} from '../interfaces/type_checks';\n+import {isComponentDef, isComponentHost, isContentQueryHost, isRootView} from '../interfaces/type_checks';\n import {CHILD_HEAD, CHILD_TAIL, CLEANUP, CONTEXT, DECLARATION_COMPONENT_VIEW, DECLARATION_VIEW, FLAGS, HEADER_OFFSET, HOST, InitPhaseState, INJECTOR, LView, LViewFlags, NEXT, PARENT, RENDERER, RENDERER_FACTORY, RootContext, RootContextFlags, SANITIZER, T_HOST, TData, TRANSPLANTED_VIEWS_TO_REFRESH, TVIEW, TView, TViewType} from '../interfaces/view';\n import {assertNodeNotOfTypes, assertNodeOfPossibleTypes} from '../node_assert';\n import {isInlineTemplate, isNodeMatchingSelectorList} from '../node_selector_matcher';\n@@ -822,6 +822,7 @@ export function createTNode(\n export function createTNode(\n     tView: TView, tParent: TElementNode|TContainerNode|null, type: TNodeType, adjustedIndex: number,\n     tagName: string|null, attrs: TAttributes|null): TNode {\n+  ngDevMode && assertNotSame(attrs, undefined, '\\'undefined\\' is not valid value for \\'attrs\\'');\n   ngDevMode && ngDevMode.tNode++;\n   let injectorIndex = tParent ? tParent.injectorIndex : -1;\n   const tNode = ngDevMode ?"
        },
        {
            "sha": "574c3d2215f04a095f42ead36e10900432ba3d9f",
            "filename": "packages/core/src/render3/util/view_utils.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Fsrc%2Frender3%2Futil%2Fview_utils.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Fsrc%2Frender3%2Futil%2Fview_utils.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Frender3%2Futil%2Fview_utils.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -176,8 +176,13 @@ export function viewAttachedToContainer(view: LView): boolean {\n }\n \n /** Returns a constant from `TConstants` instance. */\n+export function getConstant<T>(consts: TConstants|null, index: null|undefined): null;\n+export function getConstant<T>(consts: TConstants, index: number): T|null;\n+export function getConstant<T>(consts: TConstants|null, index: number|null|undefined): T|null;\n export function getConstant<T>(consts: TConstants|null, index: number|null|undefined): T|null {\n-  return consts === null || index == null ? null : consts[index] as unknown as T;\n+  if (index === null || index === undefined) return null;\n+  ngDevMode && assertIndexInRange(consts!, index);\n+  return consts![index] as unknown as T;\n }\n \n /**"
        },
        {
            "sha": "68d456a24ae2c2e973495edadf19b795434656f3",
            "filename": "packages/core/src/util/assert.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Fsrc%2Futil%2Fassert.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Fsrc%2Futil%2Fassert.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Fsrc%2Futil%2Fassert.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -111,6 +111,9 @@ export function assertDomNode(node: any): asserts node is Node {\n \n \n export function assertIndexInRange(arr: any[], index: number) {\n-  const maxLen = arr ? arr.length : 0;\n-  assertLessThan(index, maxLen, `Index expected to be less than ${maxLen} but got ${index}`);\n+  assertDefined(arr, 'Array must be defined.');\n+  const maxLen = arr.length;\n+  if (index < 0 || index > maxLen) {\n+    throwError(`Index expected to be less than ${maxLen} but got ${index}`);\n+  }\n }"
        },
        {
            "sha": "08d8cb889d1d911655762ee40ebcb761ed4123d4",
            "filename": "packages/core/test/render3/i18n_spec.ts",
            "status": "modified",
            "additions": 18,
            "deletions": 17,
            "changes": 35,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Fi18n_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Fi18n_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fi18n_spec.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -57,19 +57,15 @@ describe('Runtime i18n', () => {\n     });\n   });\n \n-  function prepareFixture(\n-      createTemplate: () => void, updateTemplate: (() => void)|null, nbConsts = 0, nbVars = 0,\n-      consts: TConstants = []): TemplateFixture {\n-    return new TemplateFixture(\n-        createTemplate, updateTemplate || noop, nbConsts, nbVars, null, null, null, undefined,\n-        consts);\n-  }\n-\n   function getOpCodes(\n       messageOrAtrs: string|string[], createTemplate: () => void, updateTemplate: (() => void)|null,\n-      nbConsts: number, index: number): TI18n|I18nUpdateOpCodes {\n-    const fixture =\n-        prepareFixture(createTemplate, updateTemplate, nbConsts, undefined, [messageOrAtrs]);\n+      nbDecls: number, index: number): TI18n|I18nUpdateOpCodes {\n+    const fixture = new TemplateFixture({\n+      create: createTemplate,\n+      update: updateTemplate || undefined,\n+      decls: nbDecls,\n+      consts: [messageOrAtrs]\n+    });\n     const tView = fixture.hostView[TVIEW];\n     return tView.data[index + HEADER_OFFSET] as TI18n;\n   }\n@@ -435,13 +431,18 @@ describe('Runtime i18n', () => {\n     it('for text', () => {\n       const message = `Hello world!`;\n       const attrs = ['title', message];\n-      const nbConsts = 2;\n+      const nbDecls = 2;\n       const index = 1;\n-      const fixture = prepareFixture(() => {\n-        ɵɵelementStart(0, 'div');\n-        ɵɵi18nAttributes(index, 0);\n-        ɵɵelementEnd();\n-      }, null, nbConsts, index, [attrs]);\n+      const fixture = new TemplateFixture({\n+        create: () => {\n+          ɵɵelementStart(0, 'div');\n+          ɵɵi18nAttributes(index, 0);\n+          ɵɵelementEnd();\n+        },\n+        decls: nbDecls,\n+        vars: index,\n+        consts: [attrs],\n+      });\n       const tView = fixture.hostView[TVIEW];\n       const opCodes = tView.data[index + HEADER_OFFSET] as I18nUpdateOpCodes;\n "
        },
        {
            "sha": "3098ea35875f69247c4151ecc7a98ab0a4720057",
            "filename": "packages/core/test/render3/instructions/lview_debug_spec.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 8,
            "changes": 18,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Finstructions%2Flview_debug_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Finstructions%2Flview_debug_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Finstructions%2Flview_debug_spec.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -205,14 +205,16 @@ describe('lView_debug', () => {\n         });\n       }\n \n-      const fixture = new TemplateFixture(\n-          () => {\n-            ɵɵelementStart(0, 'my-comp', 0);\n-            ɵɵelement(1, 'my-child');\n-            ɵɵelementEnd();\n-          },\n-          () => null, 2, 0, [MyComponent, MyDirective, MyChild], null, null, undefined,\n-          [['my-dir', '']]);\n+      const fixture = new TemplateFixture({\n+        create: () => {\n+          ɵɵelementStart(0, 'my-comp', 0);\n+          ɵɵelement(1, 'my-child');\n+          ɵɵelementEnd();\n+        },\n+        decls: 2,\n+        directives: [MyComponent, MyDirective, MyChild],\n+        consts: [['my-dir', '']]\n+      });\n       const lView = fixture.hostView;\n       const lViewDebug = lView.debug!;\n       const myCompNode = lViewDebug.nodes[0];"
        },
        {
            "sha": "4fd8a11d9536071e9d8f36d10430221288d7fbaa",
            "filename": "packages/core/test/render3/instructions_spec.ts",
            "status": "modified",
            "additions": 57,
            "deletions": 38,
            "changes": 95,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Finstructions_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Finstructions_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Finstructions_spec.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -26,7 +26,7 @@ describe('instructions', () => {\n   }\n \n   function createDiv() {\n-    ɵɵelement(0, 'div', 0);\n+    ɵɵelement(0, 'div');\n   }\n \n   function createScript() {\n@@ -36,7 +36,7 @@ describe('instructions', () => {\n   describe('ɵɵadvance', () => {\n     it('should error in DevMode if index is out of range', () => {\n       // Only one constant added, meaning only index `0` is valid.\n-      const t = new TemplateFixture(createDiv, () => {}, 1, 0);\n+      const t = new TemplateFixture({create: createDiv, decls: 1});\n       expect(() => {\n         t.update(() => {\n           ɵɵadvance(-1);\n@@ -52,7 +52,7 @@ describe('instructions', () => {\n \n   describe('bind', () => {\n     it('should update bindings when value changes with the correct perf counters', () => {\n-      const t = new TemplateFixture(createAnchor, () => {}, 1, 1);\n+      const t = new TemplateFixture({create: createAnchor, update: () => {}, decls: 1, vars: 1});\n \n       t.update(() => {\n         ɵɵproperty('title', 'Hello');\n@@ -77,7 +77,8 @@ describe('instructions', () => {\n          const idempotentUpdate = () => {\n            ɵɵproperty('title', 'Hello');\n          };\n-         const t = new TemplateFixture(createAnchor, idempotentUpdate, 1, 1);\n+         const t = new TemplateFixture(\n+             {create: createAnchor, update: idempotentUpdate, decls: 1, vars: 1});\n \n          t.update();\n          expect(t.html).toEqual('<a title=\"Hello\"></a>');\n@@ -96,9 +97,14 @@ describe('instructions', () => {\n \n   describe('element', () => {\n     it('should create an element with the correct perf counters', () => {\n-      const t = new TemplateFixture(() => {\n-        ɵɵelement(0, 'div', 0);\n-      }, () => {}, 1, 0, null, null, null, undefined, [['id', 'test', 'title', 'Hello']]);\n+      const t = new TemplateFixture({\n+        create: () => {\n+          ɵɵelement(0, 'div', 0);\n+        },\n+        decls: 1,\n+        vars: 0,\n+        consts: [['id', 'test', 'title', 'Hello']]\n+      });\n \n       const div = (t.hostElement as HTMLElement).querySelector('div')!;\n       expect(div.id).toEqual('test');\n@@ -114,7 +120,7 @@ describe('instructions', () => {\n \n   describe('attribute', () => {\n     it('should use sanitizer function', () => {\n-      const t = new TemplateFixture(createDiv, () => {}, 1, 1);\n+      const t = new TemplateFixture({create: createDiv, decls: 1, vars: 1});\n \n       t.update(() => {\n         ɵɵattribute('title', 'javascript:true', ɵɵsanitizeUrl);\n@@ -143,7 +149,7 @@ describe('instructions', () => {\n      */\n     it('should chain', () => {\n       // <div [title]=\"title\" [accesskey]=\"key\"></div>\n-      const t = new TemplateFixture(createDiv, () => {}, 1, 2);\n+      const t = new TemplateFixture({create: createDiv, update: () => {}, decls: 1, vars: 2});\n       t.update(() => {\n         ɵɵproperty('title', 'one')('accessKey', 'A');\n       });\n@@ -165,14 +171,16 @@ describe('instructions', () => {\n   describe('styleProp', () => {\n     it('should allow values even if a bypass operation is applied', () => {\n       let backgroundImage: string|SafeValue = 'url(\"http://server\")';\n-      const t = new TemplateFixture(\n-          () => {\n-            return createDiv();\n-          },\n-          () => {\n-            ɵɵstyleProp('background-image', backgroundImage);\n-          },\n-          2, 2);\n+      const t = new TemplateFixture({\n+        create: () => {\n+          return createDiv();\n+        },\n+        update: () => {\n+          ɵɵstyleProp('background-image', backgroundImage);\n+        },\n+        decls: 2,\n+        vars: 2\n+      });\n       // nothing is set because sanitizer suppresses it.\n       expect((t.hostElement.firstChild as HTMLElement).style.getPropertyValue('background-image'))\n           .toEqual('url(\"http://server\")');\n@@ -192,9 +200,15 @@ describe('instructions', () => {\n     }\n \n     it('should add style', () => {\n-      const fixture = new TemplateFixture(createDivWithStyle, () => {\n-        ɵɵstyleMap({'background-color': 'red'});\n-      }, 1, 2, null, null, null, undefined, attrs);\n+      const fixture = new TemplateFixture({\n+        create: createDivWithStyle,\n+        update: () => {\n+          ɵɵstyleMap({'background-color': 'red'});\n+        },\n+        decls: 1,\n+        vars: 2,\n+        consts: attrs\n+      });\n       fixture.update();\n       expect(fixture.html).toEqual('<div style=\"background-color: red; height: 10px;\"></div>');\n     });\n@@ -206,9 +220,14 @@ describe('instructions', () => {\n     }\n \n     it('should add class', () => {\n-      const fixture = new TemplateFixture(createDivWithStyling, () => {\n-        ɵɵclassMap('multiple classes');\n-      }, 1, 2);\n+      const fixture = new TemplateFixture({\n+        create: createDivWithStyling,\n+        update: () => {\n+          ɵɵclassMap('multiple classes');\n+        },\n+        decls: 1,\n+        vars: 2\n+      });\n       const div = fixture.containerElement.querySelector('div.multiple')!;\n       expect(getSortedClassName(div)).toEqual('classes multiple');\n     });\n@@ -284,7 +303,7 @@ describe('instructions', () => {\n   describe('sanitization injection compatibility', () => {\n     it('should work for url sanitization', () => {\n       const s = new LocalMockSanitizer(value => `${value}-sanitized`);\n-      const t = new TemplateFixture(createAnchor, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createAnchor, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = 'http://foo';\n       const outputValue = 'http://foo-sanitized';\n \n@@ -297,7 +316,7 @@ describe('instructions', () => {\n \n     it('should bypass url sanitization if marked by the service', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createAnchor, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createAnchor, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = s.bypassSecurityTrustUrl('http://foo');\n       const outputValue = 'http://foo';\n \n@@ -310,7 +329,7 @@ describe('instructions', () => {\n \n     it('should bypass ivy-level url sanitization if a custom sanitizer is used', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createAnchor, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createAnchor, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = bypassSanitizationTrustUrl('http://foo');\n       const outputValue = 'http://foo-ivy';\n \n@@ -323,7 +342,7 @@ describe('instructions', () => {\n \n     it('should work for style sanitization', () => {\n       const s = new LocalMockSanitizer(value => `color:blue`);\n-      const t = new TemplateFixture(createDiv, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createDiv, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = 'color:red';\n       const outputValue = 'color:blue';\n \n@@ -336,7 +355,7 @@ describe('instructions', () => {\n \n     it('should bypass style sanitization if marked by the service', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createDiv, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createDiv, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = s.bypassSecurityTrustStyle('color:maroon');\n       const outputValue = 'color:maroon';\n \n@@ -349,7 +368,7 @@ describe('instructions', () => {\n \n     it('should bypass ivy-level style sanitization if a custom sanitizer is used', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createDiv, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createDiv, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = bypassSanitizationTrustStyle('font-family:foo');\n       const outputValue = 'font-family:foo-ivy';\n \n@@ -362,7 +381,7 @@ describe('instructions', () => {\n \n     it('should work for resourceUrl sanitization', () => {\n       const s = new LocalMockSanitizer(value => `${value}-sanitized`);\n-      const t = new TemplateFixture(createScript, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createScript, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = 'http://resource';\n       const outputValue = 'http://resource-sanitized';\n \n@@ -375,7 +394,7 @@ describe('instructions', () => {\n \n     it('should bypass resourceUrl sanitization if marked by the service', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createScript, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createScript, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = s.bypassSecurityTrustResourceUrl('file://all-my-secrets.pdf');\n       const outputValue = 'file://all-my-secrets.pdf';\n \n@@ -388,7 +407,7 @@ describe('instructions', () => {\n \n     it('should bypass ivy-level resourceUrl sanitization if a custom sanitizer is used', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createScript, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createScript, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = bypassSanitizationTrustResourceUrl('file://all-my-secrets.pdf');\n       const outputValue = 'file://all-my-secrets.pdf-ivy';\n \n@@ -401,7 +420,7 @@ describe('instructions', () => {\n \n     it('should work for script sanitization', () => {\n       const s = new LocalMockSanitizer(value => `${value} //sanitized`);\n-      const t = new TemplateFixture(createScript, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createScript, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = 'fn();';\n       const outputValue = 'fn(); //sanitized';\n \n@@ -414,7 +433,7 @@ describe('instructions', () => {\n \n     it('should bypass script sanitization if marked by the service', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createScript, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createScript, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = s.bypassSecurityTrustScript('alert(\"bar\")');\n       const outputValue = 'alert(\"bar\")';\n \n@@ -427,7 +446,7 @@ describe('instructions', () => {\n \n     it('should bypass ivy-level script sanitization if a custom sanitizer is used', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createScript, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createScript, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = bypassSanitizationTrustScript('alert(\"bar\")');\n       const outputValue = 'alert(\"bar\")-ivy';\n \n@@ -440,7 +459,7 @@ describe('instructions', () => {\n \n     it('should work for html sanitization', () => {\n       const s = new LocalMockSanitizer(value => `${value} <!--sanitized-->`);\n-      const t = new TemplateFixture(createDiv, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createDiv, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = '<header></header>';\n       const outputValue = '<header></header> <!--sanitized-->';\n \n@@ -453,7 +472,7 @@ describe('instructions', () => {\n \n     it('should bypass html sanitization if marked by the service', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createDiv, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createDiv, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = s.bypassSecurityTrustHtml('<div onclick=\"alert(123)\"></div>');\n       const outputValue = '<div onclick=\"alert(123)\"></div>';\n \n@@ -466,7 +485,7 @@ describe('instructions', () => {\n \n     it('should bypass ivy-level script sanitization if a custom sanitizer is used', () => {\n       const s = new LocalMockSanitizer(value => '');\n-      const t = new TemplateFixture(createDiv, undefined, 1, 1, null, null, s);\n+      const t = new TemplateFixture({create: createDiv, decls: 1, vars: 1, sanitizer: s});\n       const inputValue = bypassSanitizationTrustHtml('<div onclick=\"alert(123)\"></div>');\n       const outputValue = '<div onclick=\"alert(123)\"></div>-ivy';\n "
        },
        {
            "sha": "3fe1e5ac3c9babf2722fc53f34a5f307e92943d7",
            "filename": "packages/core/test/render3/listeners_spec.ts",
            "status": "modified",
            "additions": 18,
            "deletions": 8,
            "changes": 26,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Flisteners_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Flisteners_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Flisteners_spec.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -372,11 +372,16 @@ describe('event listeners', () => {\n       });\n     }\n \n-    const fixture = new TemplateFixture(() => {\n-      ɵɵelementStart(0, 'button', 0);\n-      ɵɵtext(1, 'Click');\n-      ɵɵelementEnd();\n-    }, () => {}, 2, 0, [HostListenerDir], null, null, undefined, [['hostListenerDir', '']]);\n+    const fixture = new TemplateFixture({\n+      create: () => {\n+        ɵɵelementStart(0, 'button', 0);\n+        ɵɵtext(1, 'Click');\n+        ɵɵelementEnd();\n+      },\n+      decls: 2,\n+      directives: [HostListenerDir],\n+      consts: [['hostListenerDir', '']]\n+    });\n \n     const button = fixture.hostElement.querySelector('button')!;\n \n@@ -388,9 +393,14 @@ describe('event listeners', () => {\n   });\n \n   it('should support global host listeners on directives', () => {\n-    const fixture = new TemplateFixture(() => {\n-      ɵɵelement(0, 'div', 0);\n-    }, () => {}, 1, 0, [GlobalHostListenerDir], null, null, undefined, [['hostListenerDir', '']]);\n+    const fixture = new TemplateFixture({\n+      create: () => {\n+        ɵɵelement(0, 'div', 0);\n+      },\n+      decls: 1,\n+      directives: [GlobalHostListenerDir],\n+      consts: [['hostListenerDir', '']]\n+    });\n \n     const doc = fixture.hostElement.ownerDocument!;\n "
        },
        {
            "sha": "4cf1f8e8417f6404d4cddf31bc263dd0b2aa17cd",
            "filename": "packages/core/test/render3/pipe_spec.ts",
            "status": "modified",
            "additions": 26,
            "deletions": 13,
            "changes": 39,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Fpipe_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Fpipe_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fpipe_spec.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -52,14 +52,24 @@ describe('pipe', () => {\n     }\n \n     it('should unwrap', () => {\n-      const fixture =\n-          new TemplateFixture(createTemplate, updateTemplate, 2, 3, undefined, [WrappingPipe]);\n+      const fixture = new TemplateFixture({\n+        create: createTemplate,\n+        update: updateTemplate,\n+        decls: 2,\n+        vars: 3,\n+        pipes: [WrappingPipe]\n+      });\n       expect(fixture.html).toEqual('Bar');\n     });\n \n     it('should force change detection', () => {\n-      const fixture =\n-          new TemplateFixture(createTemplate, updateTemplate, 2, 3, undefined, [WrappingPipe]);\n+      const fixture = new TemplateFixture({\n+        create: createTemplate,\n+        update: updateTemplate,\n+        decls: 2,\n+        vars: 3,\n+        pipes: [WrappingPipe]\n+      });\n       expect(fixture.html).toEqual('Bar');\n \n       fixture.hostElement.childNodes[0]!.textContent = 'Foo';\n@@ -101,15 +111,18 @@ describe('pipe', () => {\n       static ɵpipe = ɵɵdefinePipe({name: 'sayHello', type: SayHelloPipe, pure: true});\n     }\n \n-    const fixture = new TemplateFixture(\n-        () => {\n-          ɵɵtext(0);\n-          ɵɵpipe(1, 'sayHello');\n-        },\n-        () => {\n-          ɵɵtextInterpolate1('', ɵɵpipeBind1(1, 1, null), '');\n-        },\n-        2, 3, undefined, [SayHelloPipe]);\n+    const fixture = new TemplateFixture({\n+      create: () => {\n+        ɵɵtext(0);\n+        ɵɵpipe(1, 'sayHello');\n+      },\n+      update: () => {\n+        ɵɵtextInterpolate1('', ɵɵpipeBind1(1, 1, null), '');\n+      },\n+      decls: 2,\n+      vars: 3,\n+      pipes: [SayHelloPipe]\n+    });\n \n     expect(fixture.html).toBe('Hello there');\n   });"
        },
        {
            "sha": "912f3bbac8cd621b08048e61de0a76fc799b73c7",
            "filename": "packages/core/test/render3/render_util.ts",
            "status": "modified",
            "additions": 33,
            "deletions": 8,
            "changes": 41,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Frender_util.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Frender_util.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Frender_util.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -15,6 +15,7 @@ import {Renderer2} from '@angular/core/src/render/api';\n import {createLView, createTView, getOrCreateTComponentView, getOrCreateTNode, renderComponentOrTemplate} from '@angular/core/src/render3/instructions/shared';\n import {TConstants, TNodeType} from '@angular/core/src/render3/interfaces/node';\n import {enterView, getLView} from '@angular/core/src/render3/state';\n+import {EMPTY_ARRAY} from '@angular/core/src/util/empty';\n import {stringifyElement} from '@angular/platform-browser/testing/src/browser_util';\n \n import {SWITCH_CHANGE_DETECTOR_REF_FACTORY__POST_R3__ as R3_CHANGE_DETECTOR_REF_FACTORY} from '../../src/change_detection/change_detector_ref';\n@@ -97,6 +98,10 @@ export class TemplateFixture extends BaseFixture {\n   private _pipeDefs: PipeDefList|null;\n   private _sanitizer: Sanitizer|null;\n   private _rendererFactory: RendererFactory3;\n+  private _consts: TConstants;\n+  private _vars: number;\n+  private createBlock: () => void;\n+  private updateBlock: () => void;\n \n   /**\n    *\n@@ -105,16 +110,36 @@ export class TemplateFixture extends BaseFixture {\n    * @param updateBlock Optional instructions which go into the update block:\n    *          `if (rf & RenderFlags.Update) { __here__ }`.\n    */\n-  constructor(\n-      private createBlock: () => void, private updateBlock: () => void = noop, decls: number = 0,\n-      private vars: number = 0, directives?: DirectiveTypesOrFactory|null,\n-      pipes?: PipeTypesOrFactory|null, sanitizer?: Sanitizer|null,\n-      rendererFactory?: RendererFactory3, private _consts?: TConstants) {\n+  constructor({\n+    create = noop,\n+    update = noop,\n+    decls = 0,\n+    vars = 0,\n+    directives,\n+    pipes,\n+    sanitizer = null,\n+    rendererFactory = domRendererFactory3,\n+    consts = EMPTY_ARRAY\n+  }: {\n+    create?: (() => void),\n+    update?: (() => void),\n+    decls?: number,\n+    vars?: number,\n+    directives?: DirectiveTypesOrFactory,\n+    pipes?: PipeTypesOrFactory,\n+    sanitizer?: Sanitizer|null,\n+    rendererFactory?: RendererFactory3,\n+    consts?: TConstants\n+  }) {\n     super();\n+    this._consts = consts;\n+    this._vars = vars;\n+    this.createBlock = create;\n+    this.updateBlock = update;\n     this._directiveDefs = toDefs(directives, extractDirectiveDef);\n     this._pipeDefs = toDefs(pipes, extractPipeDef);\n-    this._sanitizer = sanitizer || null;\n-    this._rendererFactory = rendererFactory || domRendererFactory3;\n+    this._sanitizer = sanitizer;\n+    this._rendererFactory = rendererFactory;\n     this.hostView = renderTemplate(\n         this.hostElement,\n         (rf: RenderFlags, ctx: any) => {\n@@ -136,7 +161,7 @@ export class TemplateFixture extends BaseFixture {\n    */\n   update(updateBlock?: () => void): void {\n     renderTemplate(\n-        this.hostElement, updateBlock || this.updateBlock, 0, this.vars, null!,\n+        this.hostElement, updateBlock || this.updateBlock, 0, this._vars, null!,\n         this._rendererFactory, this.hostView, this._directiveDefs, this._pipeDefs, this._sanitizer,\n         this._consts);\n   }"
        },
        {
            "sha": "10ee8debb034dd03bf5c91bec7e39be768f6ab2b",
            "filename": "packages/core/test/render3/view_container_ref_spec.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 10,
            "changes": 26,
            "blob_url": "https://github.com/angular/angular/blob/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Fview_container_ref_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/61d56be83ef864b2ca3709bb60bdf0eaa175523e/packages%2Fcore%2Ftest%2Frender3%2Fview_container_ref_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcore%2Ftest%2Frender3%2Fview_container_ref_spec.ts?ref=61d56be83ef864b2ca3709bb60bdf0eaa175523e",
            "patch": "@@ -232,9 +232,12 @@ describe('ViewContainerRef', () => {\n           ɵɵelement(1, 'footer');\n         }\n \n-        new TemplateFixture(\n-            createTemplate, undefined, 2, 0, [DirectiveWithVCRef], null, null, undefined,\n-            [['vcref', '']]);\n+        new TemplateFixture({\n+          create: createTemplate,\n+          decls: 2,\n+          directives: [DirectiveWithVCRef],\n+          consts: [['vcref', '']]\n+        });\n \n         expect(directiveInstance!.vcref.element.nativeElement.tagName.toLowerCase())\n             .toEqual('header');\n@@ -253,9 +256,12 @@ describe('ViewContainerRef', () => {\n           ɵɵelement(1, 'footer');\n         }\n \n-        new TemplateFixture(\n-            createTemplate, undefined, 2, 0, [HeaderComponent, DirectiveWithVCRef], null, null,\n-            undefined, [['vcref', '']]);\n+        new TemplateFixture({\n+          create: createTemplate,\n+          decls: 2,\n+          directives: [HeaderComponent, DirectiveWithVCRef],\n+          consts: [['vcref', '']]\n+        });\n \n         expect(directiveInstance!.vcref.element.nativeElement.tagName.toLowerCase())\n             .toEqual('header-cmp');\n@@ -430,10 +436,10 @@ describe('ViewContainerRef', () => {\n       fixture.update();\n \n       // Destroying the parent view will also destroy all of its children views and call their\n-      // onDestroy hooks. Here, our child view attempts to destroy itself *again* in its onDestroy.\n-      // This test exists to verify that no errors are thrown when doing this. We want the test\n-      // component to destroy its own view in onDestroy because the destroy hooks happen as a\n-      // *part of* view destruction. We also ensure that the test component has at least one\n+      // onDestroy hooks. Here, our child view attempts to destroy itself *again* in its\n+      // onDestroy. This test exists to verify that no errors are thrown when doing this. We want\n+      // the test component to destroy its own view in onDestroy because the destroy hooks happen\n+      // as a *part of* view destruction. We also ensure that the test component has at least one\n       // listener so that it runs the event listener cleanup code path.\n       fixture.destroy();\n     });"
        }
    ],
    "stats": {
        "total": 303,
        "additions": 194,
        "deletions": 109
    }
}