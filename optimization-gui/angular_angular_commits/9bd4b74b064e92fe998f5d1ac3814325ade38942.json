{
    "author": "devversion",
    "message": "feat(dev-infra): commit message validation should skip lines consisting of URLs (#37890)\n\nThe dev-infra commit message validation optionally can check for lines\nto not exceed a given amount of characters. This is desired for most\ncommit messages, but sometimes not actionable if a long URL is inserted\ninto the commit message. With this commit, we skip the max line length\ncheck for lines that start with an URL.\n\nPR Close #37890",
    "sha": "9bd4b74b064e92fe998f5d1ac3814325ade38942",
    "files": [
        {
            "sha": "edc0bab802d57cb3fe71eb47a1b50456a14f9096",
            "filename": "dev-infra/commit-message/validate.spec.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/9bd4b74b064e92fe998f5d1ac3814325ade38942/dev-infra%2Fcommit-message%2Fvalidate.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/9bd4b74b064e92fe998f5d1ac3814325ade38942/dev-infra%2Fcommit-message%2Fvalidate.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Fvalidate.spec.ts?ref=9bd4b74b064e92fe998f5d1ac3814325ade38942",
            "patch": "@@ -77,6 +77,15 @@ describe('validate-commit-message.js', () => {\n           config.commitMessage.maxLineLength} characters`);\n     });\n \n+    it('should skip max length limit for URLs', () => {\n+      const msg = 'fix(compiler): this is just an usual commit message tile\\n\\n' +\n+          'This is a normal commit message body which does not exceed the max length\\n' +\n+          'limit. For more details see the following super long URL:\\n\\n' +\n+          'https://github.com/angular/components/commit/e2ace018ddfad10608e0e32932c43dcfef4095d7#diff-9879d6db96fd29134fc802214163b95a';\n+\n+      expect(validateCommitMessage(msg)).toBe(VALID);\n+    });\n+\n     it('should validate \"<type>(<scope>): <subject>\" format', () => {\n       const msg = 'not correct format';\n "
        },
        {
            "sha": "7108a63cac221d4cb764d42397b068fcf291d07c",
            "filename": "dev-infra/commit-message/validate.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/angular/angular/blob/9bd4b74b064e92fe998f5d1ac3814325ade38942/dev-infra%2Fcommit-message%2Fvalidate.ts",
            "raw_url": "https://github.com/angular/angular/raw/9bd4b74b064e92fe998f5d1ac3814325ade38942/dev-infra%2Fcommit-message%2Fvalidate.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/dev-infra%2Fcommit-message%2Fvalidate.ts?ref=9bd4b74b064e92fe998f5d1ac3814325ade38942",
            "patch": "@@ -22,6 +22,7 @@ const REVERT_PREFIX_RE = /^revert:? /i;\n const TYPE_SCOPE_RE = /^(\\w+)(?:\\(([^)]+)\\))?\\:\\s(.+)$/;\n const COMMIT_HEADER_RE = /^(.*)/i;\n const COMMIT_BODY_RE = /^.*\\n\\n([\\s\\S]*)$/;\n+const COMMIT_BODY_URL_LINE_RE = /^https?:\\/\\/.*$/;\n \n /** Parse a full commit message into its composite parts. */\n export function parseCommitMessage(commitMsg: string) {\n@@ -156,7 +157,13 @@ export function validateCommitMessage(\n   }\n \n   const bodyByLine = commit.body.split('\\n');\n-  if (bodyByLine.some(line => line.length > config.maxLineLength)) {\n+  const lineExceedsMaxLength = bodyByLine.some(line => {\n+    // Check if any line exceeds the max line length limit. The limit is ignored for\n+    // lines that just contain an URL (as these usually cannot be wrapped or shortened).\n+    return line.length > config.maxLineLength && !COMMIT_BODY_URL_LINE_RE.test(line);\n+  });\n+\n+  if (lineExceedsMaxLength) {\n     printError(\n         `The commit message body contains lines greater than ${config.maxLineLength} characters`);\n     return false;"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 17,
        "deletions": 1
    }
}