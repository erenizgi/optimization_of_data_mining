{
    "author": "wKoza",
    "message": "fix(common): Prefer to use pageXOffset / pageYOffset instance of scrollX / scrollY (#28262)\n\nThis fix ensures a better cross-browser compatibility.\nThis fix has been used for angular.io.\n\nPR Close #28262",
    "sha": "b1d300dc265604418afeb7f813b1b30de94b2b34",
    "files": [
        {
            "sha": "20b133055bf08083fdd469ad13baa3c6345d5b1d",
            "filename": "aio/src/app/shared/scroll.service.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/b1d300dc265604418afeb7f813b1b30de94b2b34/aio%2Fsrc%2Fapp%2Fshared%2Fscroll.service.ts",
            "raw_url": "https://github.com/angular/angular/raw/b1d300dc265604418afeb7f813b1b30de94b2b34/aio%2Fsrc%2Fapp%2Fshared%2Fscroll.service.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fsrc%2Fapp%2Fshared%2Fscroll.service.ts?ref=b1d300dc265604418afeb7f813b1b30de94b2b34",
            "patch": "@@ -24,7 +24,7 @@ export class ScrollService implements OnDestroy {\n   poppedStateScrollPosition: ScrollPosition|null = null;\n   // Whether the browser supports the necessary features for manual scroll restoration.\n   supportManualScrollRestoration: boolean = !!window && ('scrollTo' in window) &&\n-      ('scrollX' in window) && ('scrollY' in window) && isScrollRestorationWritable();\n+      ('pageXOffset' in window) && isScrollRestorationWritable();\n \n   // Offset from the top of the document to bottom of any static elements\n   // at the top (e.g. toolbar) + some margin"
        },
        {
            "sha": "d3ff85d6fde3ac9fab0343aff85db94047ded6fb",
            "filename": "packages/common/src/viewport_scroller.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/b1d300dc265604418afeb7f813b1b30de94b2b34/packages%2Fcommon%2Fsrc%2Fviewport_scroller.ts",
            "raw_url": "https://github.com/angular/angular/raw/b1d300dc265604418afeb7f813b1b30de94b2b34/packages%2Fcommon%2Fsrc%2Fviewport_scroller.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fsrc%2Fviewport_scroller.ts?ref=b1d300dc265604418afeb7f813b1b30de94b2b34",
            "patch": "@@ -89,7 +89,7 @@ export class BrowserViewportScroller implements ViewportScroller {\n    */\n   getScrollPosition(): [number, number] {\n     if (this.supportsScrolling()) {\n-      return [this.window.scrollX, this.window.scrollY];\n+      return [this.window.pageXOffset, this.window.pageYOffset];\n     } else {\n       return [0, 0];\n     }\n@@ -149,7 +149,7 @@ export class BrowserViewportScroller implements ViewportScroller {\n    */\n   private supportScrollRestoration(): boolean {\n     try {\n-      if (!this.window || !this.window.scrollTo) {\n+      if (!this.supportsScrolling()) {\n         return false;\n       }\n       // The `scrollRestoration` property could be on the `history` instance or its prototype.\n@@ -166,7 +166,7 @@ export class BrowserViewportScroller implements ViewportScroller {\n \n   private supportsScrolling(): boolean {\n     try {\n-      return !!this.window.scrollTo;\n+      return !!this.window && !!this.window.scrollTo && 'pageXOffset' in this.window;\n     } catch {\n       return false;\n     }"
        },
        {
            "sha": "90713e62fda9975ca5b089b7a308c079465c7eb5",
            "filename": "packages/common/test/viewport_scroller_spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/angular/angular/blob/b1d300dc265604418afeb7f813b1b30de94b2b34/packages%2Fcommon%2Ftest%2Fviewport_scroller_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/b1d300dc265604418afeb7f813b1b30de94b2b34/packages%2Fcommon%2Ftest%2Fviewport_scroller_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Ftest%2Fviewport_scroller_spec.ts?ref=b1d300dc265604418afeb7f813b1b30de94b2b34",
            "patch": "@@ -15,7 +15,8 @@ describe('BrowserViewportScroller', () => {\n   let windowSpy: any;\n \n   beforeEach(() => {\n-    windowSpy = jasmine.createSpyObj('window', ['history', 'scrollTo']);\n+    windowSpy =\n+        jasmine.createSpyObj('window', ['history', 'scrollTo', 'pageXOffset', 'pageYOffset']);\n     windowSpy.history.scrollRestoration = 'auto';\n     documentSpy = jasmine.createSpyObj('document', ['getElementById', 'getElementsByName']);\n     scroller = new BrowserViewportScroller(documentSpy, windowSpy, null!);"
        },
        {
            "sha": "5c76c6b8e2c9ba02bfaee9451b52d9f310f50d40",
            "filename": "packages/router/test/bootstrap.spec.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 10,
            "changes": 17,
            "blob_url": "https://github.com/angular/angular/blob/b1d300dc265604418afeb7f813b1b30de94b2b34/packages%2Frouter%2Ftest%2Fbootstrap.spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/b1d300dc265604418afeb7f813b1b30de94b2b34/packages%2Frouter%2Ftest%2Fbootstrap.spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Frouter%2Ftest%2Fbootstrap.spec.ts?ref=b1d300dc265604418afeb7f813b1b30de94b2b34",
            "patch": "@@ -348,27 +348,24 @@ describe('bootstrap', () => {\n     await router.navigateByUrl('/aa');\n     window.scrollTo(0, 5000);\n \n-    // IE 11 uses non-standard pageYOffset instead of scrollY\n-    const getScrollY = () => window.scrollY !== undefined ? window.scrollY : window.pageYOffset;\n-\n     await router.navigateByUrl('/fail');\n-    expect(getScrollY()).toEqual(5000);\n+    expect(window.pageYOffset).toEqual(5000);\n \n     await router.navigateByUrl('/bb');\n     window.scrollTo(0, 3000);\n \n-    expect(getScrollY()).toEqual(3000);\n+    expect(window.pageYOffset).toEqual(3000);\n \n     await router.navigateByUrl('/cc');\n-    expect(getScrollY()).toEqual(0);\n+    expect(window.pageYOffset).toEqual(0);\n \n     await router.navigateByUrl('/aa#marker2');\n-    expect(getScrollY()).toBeGreaterThanOrEqual(5900);\n-    expect(getScrollY()).toBeLessThan(6000);  // offset\n+    expect(window.pageYOffset).toBeGreaterThanOrEqual(5900);\n+    expect(window.pageYOffset).toBeLessThan(6000);  // offset\n \n     await router.navigateByUrl('/aa#marker3');\n-    expect(getScrollY()).toBeGreaterThanOrEqual(8900);\n-    expect(getScrollY()).toBeLessThan(9000);\n+    expect(window.pageYOffset).toBeGreaterThanOrEqual(8900);\n+    expect(window.pageYOffset).toBeLessThan(9000);\n     done();\n   });\n "
        }
    ],
    "stats": {
        "total": 28,
        "additions": 13,
        "deletions": 15
    }
}