{
    "author": "gkalpak",
    "message": "build(docs-infra): switch the `example-e2e` script to ESM (#42921)\n\nSwitch the JS script used for running the docs examples tests from\nCommonJS to ESM format. This is necessary for upgrading the `globby`\ndependency to [version 12.0.0][1] in a subsequent commit.\n\n[1]: https://github.com/sindresorhus/globby/releases/v12.0.0\n\nPR Close #42921",
    "sha": "19da73741dc818346b60b8f1eff9cd2dce0e0125",
    "files": [
        {
            "sha": "1902bcde0a45c5c0ecad747828768ac8950fabc7",
            "filename": "aio/content/examples/comparing-observables/e2e/src/app.e2e-spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fcomparing-observables%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts?ref=19da73741dc818346b60b8f1eff9cd2dce0e0125",
            "patch": "@@ -2,7 +2,7 @@\n  * This example project is special in that it is not a cli app. To run tests appropriate for this\n  * project, the test command is overwritten in `aio/content/examples/observables/example-config.json`.\n  *\n- * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.js` runs\n+ * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.mjs` runs\n  * tests for this project.\n  *\n  * TODO: Fix our infrastructure/tooling, so that this hack is not necessary."
        },
        {
            "sha": "2a0938c99b98a9470db1d4eba2b961f9f5b0b6b1",
            "filename": "aio/content/examples/observables-in-angular/e2e/src/app.e2e-spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Fobservables-in-angular%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Fobservables-in-angular%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fobservables-in-angular%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts?ref=19da73741dc818346b60b8f1eff9cd2dce0e0125",
            "patch": "@@ -2,7 +2,7 @@\n  * This example project is special in that it is not a cli app. To run tests appropriate for this\n  * project, the test command is overwritten in `aio/content/examples/observables-in-angular/example-config.json`.\n  *\n- * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.js` runs\n+ * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.mjs` runs\n  * tests for this project.\n  *\n  * TODO: Fix our infrastructure/tooling, so that this hack is not necessary."
        },
        {
            "sha": "1902bcde0a45c5c0ecad747828768ac8950fabc7",
            "filename": "aio/content/examples/observables/e2e/src/app.e2e-spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Fobservables%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Fobservables%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fobservables%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts?ref=19da73741dc818346b60b8f1eff9cd2dce0e0125",
            "patch": "@@ -2,7 +2,7 @@\n  * This example project is special in that it is not a cli app. To run tests appropriate for this\n  * project, the test command is overwritten in `aio/content/examples/observables/example-config.json`.\n  *\n- * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.js` runs\n+ * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.mjs` runs\n  * tests for this project.\n  *\n  * TODO: Fix our infrastructure/tooling, so that this hack is not necessary."
        },
        {
            "sha": "83714788dbdcdc4192790c781d3efaeab6ac9fa8",
            "filename": "aio/content/examples/practical-observable-usage/e2e/src/app.e2e-spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Fpractical-observable-usage%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Fpractical-observable-usage%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Fpractical-observable-usage%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts?ref=19da73741dc818346b60b8f1eff9cd2dce0e0125",
            "patch": "@@ -2,7 +2,7 @@\n  * This example project is special in that it is not a cli app. To run tests appropriate for this\n  * project, the test command is overwritten in `aio/content/examples/practical-observable-usage/example-config.json`.\n  *\n- * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.js` runs\n+ * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.mjs` runs\n  * tests for this project.\n  *\n  * TODO: Fix our infrastructure/tooling, so that this hack is not necessary."
        },
        {
            "sha": "aad3cbca2f28c89570ad8559ad3cf3756e536bcf",
            "filename": "aio/content/examples/rx-library/e2e/src/app.e2e-spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Frx-library%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fcontent%2Fexamples%2Frx-library%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fcontent%2Fexamples%2Frx-library%2Fe2e%2Fsrc%2Fapp.e2e-spec.ts?ref=19da73741dc818346b60b8f1eff9cd2dce0e0125",
            "patch": "@@ -2,7 +2,7 @@\n  * This example project is special in that it is not a cli app. To run tests appropriate for this\n  * project, the test command is overwritten in `aio/content/examples/rx-libary/example-config.json`.\n  *\n- * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.js` runs\n+ * This is an empty placeholder file to ensure that `aio/tools/examples/run-example-e2e.mjs` runs\n  * tests for this project.\n  *\n  * TODO: Fix our infrastructure/tooling, so that this hack is not necessary."
        },
        {
            "sha": "bcbc767b5da78179a98de0894065517bcd62fd82",
            "filename": "aio/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fpackage.json",
            "raw_url": "https://github.com/angular/angular/raw/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Fpackage.json?ref=19da73741dc818346b60b8f1eff9cd2dce0e0125",
            "patch": "@@ -39,7 +39,7 @@\n     \"test-a11y-score-localhost\": \"run-p --race \\\"~~light-server -s dist -p 4200 --quiet\\\" \\\"test-a11y-score http://localhost:4200\\\" --\",\n     \"test-pwa-score\": \"run-s \\\"~~audit-web-app {1} all:0,pwa:{2} {3}\\\" --\",\n     \"test-pwa-score-localhost\": \"run-p --race \\\"~~light-server -s dist -p 4200 --quiet\\\" \\\"test-pwa-score http://localhost:4200 {1} {2}\\\" --\",\n-    \"example-e2e\": \"yarn example-check-local && node ./tools/examples/run-example-e2e\",\n+    \"example-e2e\": \"yarn example-check-local && node ./tools/examples/run-example-e2e.mjs\",\n     \"example-lint\": \"tslint --config \\\"content/examples/tslint.json\\\" \\\"content/examples/**/*.ts\\\" --exclude \\\"content/examples/styleguide/**/*.avoid.ts\\\"\",\n     \"example-use-local\": \"node tools/ng-packages-installer overwrite ./tools/examples/shared --debug --force\",\n     \"example-use-npm\": \"node tools/ng-packages-installer restore ./tools/examples/shared\","
        },
        {
            "sha": "90402cd543a60416f606e7dd364f7301cdcc3823",
            "filename": "aio/tools/README.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/angular/angular/blob/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Ftools%2FREADME.md",
            "raw_url": "https://github.com/angular/angular/raw/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Ftools%2FREADME.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Ftools%2FREADME.md?ref=19da73741dc818346b60b8f1eff9cd2dce0e0125",
            "patch": "@@ -33,7 +33,7 @@ This `examples` tool folder contains three utilities:\n \n * example-boilerplate.js - install/remove the npm dependencies and boilerplate files into/from each of the\n   examples' subfolders.\n-* run-example-e2e.js - run the e2e tests for one or more examples\n+* run-example-e2e.mjs - run the e2e tests for one or more examples\n * create-example.js - create a new example from the `example-scaffold/` directory or by importing files from a CLI project.\n \n See the [README.md](examples/README.md) for more details."
        },
        {
            "sha": "cc78b5824ab65a85b27a8a976657a256ae72d927",
            "filename": "aio/tools/examples/README.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/angular/angular/blob/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Ftools%2Fexamples%2FREADME.md",
            "raw_url": "https://github.com/angular/angular/raw/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Ftools%2Fexamples%2FREADME.md",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Ftools%2Fexamples%2FREADME.md?ref=19da73741dc818346b60b8f1eff9cd2dce0e0125",
            "patch": "@@ -135,9 +135,9 @@ It will remove all files that are not tracked by git, **including any new files\n So, be sure to commit your work before removing the boilerplate.\n \n \n-### `run-example-e2e.js`\n+### `run-example-e2e.mjs`\n \n-The [run-example-e2e.js](./run-example-e2e.js) script will find and run the e2e tests for all examples.\n+The [run-example-e2e.mjs](./run-example-e2e.mjs) script will find and run the e2e tests for all examples.\n Although it only runs e2e tests by default, it can be configured to run any test command (for CLI-based examples) by using the `tests` property of the [example-config.json](#example-config) file.\n It is named `*-e2e` for historical reasons, but it is not limited to running e2e tests.\n "
        },
        {
            "sha": "f53fe215020e5bc8c73ecc65e1f0321d2fc08904",
            "filename": "aio/tools/examples/run-example-e2e.mjs",
            "status": "renamed",
            "additions": 16,
            "deletions": 10,
            "changes": 26,
            "blob_url": "https://github.com/angular/angular/blob/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Ftools%2Fexamples%2Frun-example-e2e.mjs",
            "raw_url": "https://github.com/angular/angular/raw/19da73741dc818346b60b8f1eff9cd2dce0e0125/aio%2Ftools%2Fexamples%2Frun-example-e2e.mjs",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/aio%2Ftools%2Fexamples%2Frun-example-e2e.mjs?ref=19da73741dc818346b60b8f1eff9cd2dce0e0125",
            "patch": "@@ -1,16 +1,22 @@\n-const path = require('canonical-path');\n-const fs = require('fs-extra');\n-const argv = require('yargs').argv;\n-const globby = require('globby');\n-const xSpawn = require('cross-spawn');\n-const treeKill = require('tree-kill');\n-const shelljs = require('shelljs');\n-const findFreePort = require('find-free-port');\n+import path from 'canonical-path';\n+import {spawn} from 'cross-spawn';\n+import findFreePort from 'find-free-port';\n+import fs from 'fs-extra';\n+import globby from 'globby';\n+import puppeteer from 'puppeteer';\n+import shelljs from 'shelljs';\n+import treeKill from 'tree-kill';\n+import {fileURLToPath} from 'url';\n+import yargs from 'yargs';\n+import {hideBin} from 'yargs/helpers'\n \n shelljs.set('-e');\n \n // Set `CHROME_BIN` as an environment variable for Karma to pick up in unit tests.\n-process.env.CHROME_BIN = require('puppeteer').executablePath();\n+process.env.CHROME_BIN = puppeteer.executablePath();\n+\n+const __dirname = path.dirname(fileURLToPath(import.meta.url));\n+const {argv} = yargs(hideBin(process.argv));\n \n const AIO_PATH = path.join(__dirname, '../../');\n const EXAMPLES_PATH = path.join(AIO_PATH, './content/examples/');\n@@ -340,7 +346,7 @@ function spawnExt(\n     let processOutput = '';\n     printMessage(`running: ${descr}\\n`);\n     try {\n-      proc = xSpawn.spawn(command, args, options);\n+      proc = spawn(command, args, options);\n     } catch (e) {\n       console.log(e);\n       reject(e);",
            "previous_filename": "aio/tools/examples/run-example-e2e.js"
        }
    ],
    "stats": {
        "total": 44,
        "additions": 25,
        "deletions": 19
    }
}