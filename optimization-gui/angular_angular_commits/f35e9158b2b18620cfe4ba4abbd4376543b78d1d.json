{
    "author": "petebacondarwin",
    "message": "refactor(compiler-cli): remove unnecessary constraint on `isDeclarationReference()` (#38959)\n\nThere is no need to check that the `ref.node` is of any particular type\nbecause immediately after this check the entry is tested to see if it passes\n`isClassDeclarationReference()`.\n\nThe only difference is that the error that is reported is slightly different\nin the case that it is a `ref` but not one of the TS node types.\n\nPreviously:\n\n```\n`Value at position ${idx} in the NgModule.${arrayName} of ${\n                className} is not a reference`\n```\n\nnow\n\n```\n`Value at position ${idx} in the NgModule.${arrayName} of ${\n                  className} is not a class`\n```\n\nArguably the previous message was wrong, since this entry IS a reference\nbut is not a class.\n\nPR Close #38959",
    "sha": "f35e9158b2b18620cfe4ba4abbd4376543b78d1d",
    "files": [
        {
            "sha": "d57b6e6ea4efbbc660a6b5a0f3fcb63ee40dcc63",
            "filename": "packages/compiler-cli/src/ngtsc/annotations/src/ng_module.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 9,
            "changes": 11,
            "blob_url": "https://github.com/angular/angular/blob/f35e9158b2b18620cfe4ba4abbd4376543b78d1d/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fannotations%2Fsrc%2Fng_module.ts",
            "raw_url": "https://github.com/angular/angular/raw/f35e9158b2b18620cfe4ba4abbd4376543b78d1d/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fannotations%2Fsrc%2Fng_module.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcompiler-cli%2Fsrc%2Fngtsc%2Fannotations%2Fsrc%2Fng_module.ts?ref=f35e9158b2b18620cfe4ba4abbd4376543b78d1d",
            "patch": "@@ -540,8 +540,7 @@ export class NgModuleDecoratorHandler implements\n   }\n \n   // Verify that a `ts.Declaration` reference is a `ClassDeclaration` reference.\n-  private isClassDeclarationReference(ref: Reference<ts.Declaration>):\n-      ref is Reference<ClassDeclaration> {\n+  private isClassDeclarationReference(ref: Reference): ref is Reference<ClassDeclaration> {\n     return this.reflector.isClass(ref.node);\n   }\n \n@@ -568,7 +567,7 @@ export class NgModuleDecoratorHandler implements\n       if (Array.isArray(entry)) {\n         // Recurse into nested arrays.\n         refList.push(...this.resolveTypeList(expr, entry, className, arrayName));\n-      } else if (isDeclarationReference(entry)) {\n+      } else if (entry instanceof Reference) {\n         if (!this.isClassDeclarationReference(entry)) {\n           throw createValueHasWrongTypeError(\n               entry.node, entry,\n@@ -593,9 +592,3 @@ function isNgModule(node: ClassDeclaration, compilation: ScopeData): boolean {\n   return !compilation.directives.some(directive => directive.ref.node === node) &&\n       !compilation.pipes.some(pipe => pipe.ref.node === node);\n }\n-\n-function isDeclarationReference(ref: any): ref is Reference<ts.Declaration> {\n-  return ref instanceof Reference &&\n-      (ts.isClassDeclaration(ref.node) || ts.isFunctionDeclaration(ref.node) ||\n-       ts.isVariableDeclaration(ref.node));\n-}"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 2,
        "deletions": 9
    }
}