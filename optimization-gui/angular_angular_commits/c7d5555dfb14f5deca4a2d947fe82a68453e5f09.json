{
    "author": "ranma42",
    "message": "fix(common): let case conversion pipes accept type unions with `null` (#36259) (#37447)\n\nThe old implementation of case conversion types can handle several\nvalues which are not strings, but the signature did not reflect this.\n\nThe new one reports errors when falsy non-string inputs are given to\nthe pipe (such as `false` or `0`) and has a new signature which\ninstead reflects the behaviour on `null` and `undefined`.\n\nFixes #36259\n\nBREAKING CHANGE:\nThe case conversion pipes no longer let falsy values through. They now\nmap both `null` and `undefined` to `null` and raise an exception on\ninvalid input (`0`, `false`, `NaN`) just like most \"common pipes\". If\nyour code required falsy values to pass through, you need to handle them\nexplicitly.\n\nPR Close #37447",
    "sha": "c7d5555dfb14f5deca4a2d947fe82a68453e5f09",
    "files": [
        {
            "sha": "55856b6199b8a0d4f7797eac2a51d0e008b8460f",
            "filename": "goldens/public-api/common/common.d.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/angular/angular/blob/c7d5555dfb14f5deca4a2d947fe82a68453e5f09/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts",
            "raw_url": "https://github.com/angular/angular/raw/c7d5555dfb14f5deca4a2d947fe82a68453e5f09/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/goldens%2Fpublic-api%2Fcommon%2Fcommon.d.ts?ref=c7d5555dfb14f5deca4a2d947fe82a68453e5f09",
            "patch": "@@ -194,6 +194,8 @@ export declare abstract class LocationStrategy {\n \n export declare class LowerCasePipe implements PipeTransform {\n     transform(value: string): string;\n+    transform(value: null | undefined): null;\n+    transform(value: string | null | undefined): string | null;\n }\n \n export declare class NgClass implements DoCheck {\n@@ -392,6 +394,8 @@ export declare type Time = {\n \n export declare class TitleCasePipe implements PipeTransform {\n     transform(value: string): string;\n+    transform(value: null | undefined): null;\n+    transform(value: string | null | undefined): string | null;\n }\n \n export declare enum TranslationWidth {\n@@ -403,6 +407,8 @@ export declare enum TranslationWidth {\n \n export declare class UpperCasePipe implements PipeTransform {\n     transform(value: string): string;\n+    transform(value: null | undefined): null;\n+    transform(value: string | null | undefined): string | null;\n }\n \n export declare const VERSION: Version;"
        },
        {
            "sha": "fea96ec2d24d4ee97f80e9d2fa52ee4be33af7ee",
            "filename": "packages/common/src/pipes/case_conversion_pipes.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 6,
            "changes": 21,
            "blob_url": "https://github.com/angular/angular/blob/c7d5555dfb14f5deca4a2d947fe82a68453e5f09/packages%2Fcommon%2Fsrc%2Fpipes%2Fcase_conversion_pipes.ts",
            "raw_url": "https://github.com/angular/angular/raw/c7d5555dfb14f5deca4a2d947fe82a68453e5f09/packages%2Fcommon%2Fsrc%2Fpipes%2Fcase_conversion_pipes.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Fsrc%2Fpipes%2Fcase_conversion_pipes.ts?ref=c7d5555dfb14f5deca4a2d947fe82a68453e5f09",
            "patch": "@@ -29,8 +29,11 @@ export class LowerCasePipe implements PipeTransform {\n   /**\n    * @param value The string to transform to lower case.\n    */\n-  transform(value: string): string {\n-    if (!value) return value;\n+  transform(value: string): string;\n+  transform(value: null|undefined): null;\n+  transform(value: string|null|undefined): string|null;\n+  transform(value: string|null|undefined): string|null {\n+    if (value == null) return null;\n     if (typeof value !== 'string') {\n       throw invalidPipeArgumentError(LowerCasePipe, value);\n     }\n@@ -72,8 +75,11 @@ export class TitleCasePipe implements PipeTransform {\n   /**\n    * @param value The string to transform to title case.\n    */\n-  transform(value: string): string {\n-    if (!value) return value;\n+  transform(value: string): string;\n+  transform(value: null|undefined): null;\n+  transform(value: string|null|undefined): string|null;\n+  transform(value: string|null|undefined): string|null {\n+    if (value == null) return null;\n     if (typeof value !== 'string') {\n       throw invalidPipeArgumentError(TitleCasePipe, value);\n     }\n@@ -96,8 +102,11 @@ export class UpperCasePipe implements PipeTransform {\n   /**\n    * @param value The string to transform to upper case.\n    */\n-  transform(value: string): string {\n-    if (!value) return value;\n+  transform(value: string): string;\n+  transform(value: null|undefined): null;\n+  transform(value: string|null|undefined): string|null;\n+  transform(value: string|null|undefined): string|null {\n+    if (value == null) return null;\n     if (typeof value !== 'string') {\n       throw invalidPipeArgumentError(UpperCasePipe, value);\n     }"
        },
        {
            "sha": "ca1bc289ce2cc4e4ffc384115beb0f91b22ddc93",
            "filename": "packages/common/test/pipes/case_conversion_pipes_spec.ts",
            "status": "modified",
            "additions": 33,
            "deletions": 3,
            "changes": 36,
            "blob_url": "https://github.com/angular/angular/blob/c7d5555dfb14f5deca4a2d947fe82a68453e5f09/packages%2Fcommon%2Ftest%2Fpipes%2Fcase_conversion_pipes_spec.ts",
            "raw_url": "https://github.com/angular/angular/raw/c7d5555dfb14f5deca4a2d947fe82a68453e5f09/packages%2Fcommon%2Ftest%2Fpipes%2Fcase_conversion_pipes_spec.ts",
            "contents_url": "https://api.github.com/repos/angular/angular/contents/packages%2Fcommon%2Ftest%2Fpipes%2Fcase_conversion_pipes_spec.ts?ref=c7d5555dfb14f5deca4a2d947fe82a68453e5f09",
            "patch": "@@ -25,8 +25,18 @@ import {LowerCasePipe, TitleCasePipe, UpperCasePipe} from '@angular/common';\n       expect(pipe.transform('BAr')).toEqual('bar');\n     });\n \n+    it('should map null to null', () => {\n+      expect(pipe.transform(null)).toEqual(null);\n+    });\n+    it('should map undefined to null', () => {\n+      expect(pipe.transform(undefined)).toEqual(null);\n+    });\n+\n+    it('should not support numbers', () => {\n+      expect(() => pipe.transform(0 as any)).toThrowError();\n+    });\n     it('should not support other objects', () => {\n-      expect(() => pipe.transform(<any>{})).toThrowError();\n+      expect(() => pipe.transform({} as any)).toThrowError();\n     });\n   });\n \n@@ -80,8 +90,18 @@ import {LowerCasePipe, TitleCasePipe, UpperCasePipe} from '@angular/common';\n       expect(pipe.transform('éric')).toEqual('Éric');\n     });\n \n+    it('should map null to null', () => {\n+      expect(pipe.transform(null)).toEqual(null);\n+    });\n+    it('should map undefined to null', () => {\n+      expect(pipe.transform(undefined)).toEqual(null);\n+    });\n+\n+    it('should not support numbers', () => {\n+      expect(() => pipe.transform(0 as any)).toThrowError();\n+    });\n     it('should not support other objects', () => {\n-      expect(() => pipe.transform(<any>{})).toThrowError();\n+      expect(() => pipe.transform({} as any)).toThrowError();\n     });\n   });\n \n@@ -101,8 +121,18 @@ import {LowerCasePipe, TitleCasePipe, UpperCasePipe} from '@angular/common';\n       expect(pipe.transform('bar')).toEqual('BAR');\n     });\n \n+    it('should map null to null', () => {\n+      expect(pipe.transform(null)).toEqual(null);\n+    });\n+    it('should map undefined to null', () => {\n+      expect(pipe.transform(undefined)).toEqual(null);\n+    });\n+\n+    it('should not support numbers', () => {\n+      expect(() => pipe.transform(0 as any)).toThrowError();\n+    });\n     it('should not support other objects', () => {\n-      expect(() => pipe.transform(<any>{})).toThrowError();\n+      expect(() => pipe.transform({} as any)).toThrowError();\n     });\n   });\n }"
        }
    ],
    "stats": {
        "total": 63,
        "additions": 54,
        "deletions": 9
    }
}