{
    "author": "ztanner",
    "message": "fix CSP docs (#78937)\n\nThis is erroneously showing the app router docs for pages router,\nhowever nonce handling was not added to pages router (support is being\nadded in #78936) and the included examples are using server components.",
    "sha": "0236e185671b9a355888eb11438be4c5347301eb",
    "files": [
        {
            "sha": "0614aa587853774326315b8435ac0a7a8d0955d2",
            "filename": "docs/01-app/02-guides/content-security-policy.mdx",
            "status": "modified",
            "additions": 50,
            "deletions": 1,
            "changes": 51,
            "blob_url": "https://github.com/vercel/next.js/blob/0236e185671b9a355888eb11438be4c5347301eb/docs%2F01-app%2F02-guides%2Fcontent-security-policy.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/0236e185671b9a355888eb11438be4c5347301eb/docs%2F01-app%2F02-guides%2Fcontent-security-policy.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fcontent-security-policy.mdx?ref=0236e185671b9a355888eb11438be4c5347301eb",
            "patch": "@@ -172,7 +172,54 @@ export const config = {\n \n ### Reading the nonce\n \n-You can now read the nonce from a [Server Component](/docs/app/building-your-application/rendering/server-components) using [`headers`](/docs/app/api-reference/functions/headers):\n+<PagesOnly>\n+  You can provide the nonce to your page using\n+  [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props):\n+\n+```tsx filename=\"pages/index.tsx\" switcher\n+import Script from 'next/script'\n+\n+import type { GetServerSideProps } from 'next'\n+\n+export default function Page({ nonce }) {\n+  return (\n+    <Script\n+      src=\"https://www.googletagmanager.com/gtag/js\"\n+      strategy=\"afterInteractive\"\n+      nonce={nonce}\n+    />\n+  )\n+}\n+\n+export const getServerSideProps: GetServerSideProps = async ({ req }) => {\n+  const nonce = req.headers['x-nonce']\n+  return { props: { nonce } }\n+}\n+```\n+\n+```jsx filename=\"pages/index.jsx\" switcher\n+import Script from 'next/script'\n+export default function Page({ nonce }) {\n+  return (\n+    <Script\n+      src=\"https://www.googletagmanager.com/gtag/js\"\n+      strategy=\"afterInteractive\"\n+      nonce={nonce}\n+    />\n+  )\n+}\n+\n+export async function getServerSideProps({ req }) {\n+  const nonce = req.headers['x-nonce']\n+  return { props: { nonce } }\n+}\n+```\n+\n+</PagesOnly>\n+\n+<AppOnly>\n+\n+You can read the nonce from a [Server Component](/docs/app/building-your-application/rendering/server-components) using [`headers`](/docs/app/api-reference/functions/headers):\n \n ```tsx filename=\"app/page.tsx\" switcher\n import { headers } from 'next/headers'\n@@ -208,6 +255,8 @@ export default async function Page() {\n }\n ```\n \n+</AppOnly>\n+\n ## Without Nonces\n \n For applications that do not require nonces, you can set the CSP header directly in your [`next.config.js`](/docs/app/api-reference/config/next-config-js) file:"
        }
    ],
    "stats": {
        "total": 51,
        "additions": 50,
        "deletions": 1
    }
}