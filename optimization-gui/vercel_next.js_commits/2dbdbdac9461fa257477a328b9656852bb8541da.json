{
    "author": "ztanner",
    "message": "[dev-overlay]: make open in editor button a separate click region (#76243)\n\nCurrently the code frame/terminal headers are treated as a clickable\nregion to open in your editor. However, the editor integration might not\nalways work or be desired, and folks might instead want to copy the file\npath for other reasons.\n\nThis moves the \"open in editor\" functionality to be a specific click\narea around the icon, removing interactivity from the header & call\nstack frames.\n\n\n\nhttps://github.com/user-attachments/assets/e7e1c282-233f-4ca1-9668-f520f0b7bbe8\n\n\n\nCloses NDX-794\nCloses NDX-802\n\n---------\n\nCo-authored-by: devjiwonchoi <devjiwonchoi@gmail.com>",
    "sha": "2dbdbdac9461fa257477a328b9656852bb8541da",
    "files": [
        {
            "sha": "ed08cb71bb87ebf52dd15cce6fbe1b7184cbd33a",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/call-stack-frame/call-stack-frame.tsx",
            "status": "modified",
            "additions": 25,
            "deletions": 28,
            "changes": 53,
            "blob_url": "https://github.com/vercel/next.js/blob/2dbdbdac9461fa257477a328b9656852bb8541da/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fcall-stack-frame%2Fcall-stack-frame.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2dbdbdac9461fa257477a328b9656852bb8541da/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fcall-stack-frame%2Fcall-stack-frame.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fcall-stack-frame%2Fcall-stack-frame.tsx?ref=2dbdbdac9461fa257477a328b9656852bb8541da",
            "patch": "@@ -38,34 +38,27 @@ export const CallStackFrame: React.FC<{\n     return null\n   }\n \n-  const props = {\n-    ...(hasSource && {\n-      role: 'button',\n-      tabIndex: 0,\n-      'aria-label': 'Click to open in your editor',\n-      title: 'Click to open in your editor',\n-      onClick: open,\n-    }),\n-  }\n-\n   return (\n     <div\n       data-nextjs-call-stack-frame\n       data-nextjs-call-stack-frame-ignored={!hasSource}\n-      {...props}\n       style={\n         {\n           '--index': index,\n         } as React.CSSProperties\n       }\n     >\n-      <span\n+      <div\n         data-nextjs-frame-expanded={!frame.ignored}\n         className=\"call-stack-frame-method-name\"\n       >\n         <HotlinkedText text={formattedMethod} />\n-        {hasSource && <ExternalIcon width={16} height={16} />}\n-      </span>\n+        {hasSource && (\n+          <button onClick={open} className=\"open-in-editor-button\">\n+            <ExternalIcon width={16} height={16} />\n+          </button>\n+        )}\n+      </div>\n       <span\n         className=\"call-stack-frame-file-source\"\n         data-has-source={hasSource}\n@@ -101,20 +94,6 @@ export const CALL_STACK_FRAME_STYLES = css`\n     padding: 6px 8px;\n \n     border-radius: var(--rounded-lg);\n-    transition: background 100ms ease-out;\n-\n-    &:not(:disabled)[role='button']:hover {\n-      background: var(--color-gray-alpha-100);\n-      cursor: pointer;\n-    }\n-\n-    &:not(:disabled)[role='button']:active {\n-      background: var(--color-gray-alpha-200);\n-    }\n-\n-    &:focus-visible {\n-      outline: var(--focus-ring);\n-    }\n   }\n \n   .call-stack-frame-method-name {\n@@ -131,6 +110,24 @@ export const CALL_STACK_FRAME_STYLES = css`\n     line-height: var(--size-5);\n   }\n \n+  .open-in-editor-button {\n+    display: flex;\n+    align-items: center;\n+    justify-content: center;\n+    border-radius: var(--rounded-full);\n+    padding: 4px;\n+    color: var(--color-font);\n+\n+    &:focus-visible {\n+      outline: var(--focus-ring);\n+      outline-offset: -2px;\n+    }\n+\n+    &:hover {\n+      background: var(--color-gray-100);\n+    }\n+  }\n+\n   .call-stack-frame-file-source {\n     color: var(--color-gray-900);\n     font-size: var(--size-font-small);"
        },
        {
            "sha": "5dc5fefd67b7ef0d5b35b2c258a6fc5bd86ba84b",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/code-frame/code-frame.tsx",
            "status": "modified",
            "additions": 23,
            "deletions": 11,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/2dbdbdac9461fa257477a328b9656852bb8541da/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fcode-frame%2Fcode-frame.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2dbdbdac9461fa257477a328b9656852bb8541da/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fcode-frame%2Fcode-frame.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fcode-frame%2Fcode-frame.tsx?ref=2dbdbdac9461fa257477a328b9656852bb8541da",
            "patch": "@@ -63,24 +63,31 @@ export function CodeFrame({ stackFrame, codeFrame }: CodeFrameProps) {\n   // TODO: make the caret absolute\n   return (\n     <div data-nextjs-codeframe>\n-      <button\n-        aria-label=\"Open error location in editor\"\n-        className=\"code-frame-header\"\n-        onClick={open}\n-      >\n+      <div className=\"code-frame-header\">\n+        {/* TODO: This is <div> in `Terminal` component.\n+        Changing now will require multiple test snapshots updates.\n+        Leaving as <div> as is trivial and does not affect the UI.\n+        Change when the new redbox matcher `toDisplayRedbox` is used.\n+        */}\n         <p className=\"code-frame-link\">\n-          <span className=\"code-frame-icon\" data-icon=\"left\">\n+          <span className=\"code-frame-icon\">\n             <FileIcon lang={fileExtension} />\n           </span>\n           <span data-text>\n             {getFrameSource(stackFrame)} @{' '}\n             <HotlinkedText text={stackFrame.methodName} />\n           </span>\n-          <span className=\"code-frame-icon\" data-icon=\"right\">\n-            <ExternalIcon width={16} height={16} />\n-          </span>\n+          <button\n+            aria-label=\"Open in editor\"\n+            data-with-open-in-editor-link-source-file\n+            onClick={open}\n+          >\n+            <span className=\"code-frame-icon\" data-icon=\"right\">\n+              <ExternalIcon width={16} height={16} />\n+            </span>\n+          </button>\n         </p>\n-      </button>\n+      </div>\n       <pre className=\"code-frame-pre\">\n         {decoded.map((entry, index) => (\n           <span\n@@ -140,11 +147,16 @@ export const CODE_FRAME_STYLES = css`\n \n   .code-frame-header {\n     width: 100%;\n-    cursor: pointer;\n     transition: background 100ms ease-out;\n     border-radius: 8px 8px 0 0;\n     border-bottom: 1px solid var(--color-gray-400);\n+  }\n \n+  [data-with-open-in-editor-link-source-file] {\n+    padding: 4px;\n+    margin: -4px 0 -4px auto;\n+    border-radius: var(--rounded-full);\n+    margin-left: auto;\n     &:focus-visible {\n       outline: var(--focus-ring);\n       outline-offset: -2px;"
        },
        {
            "sha": "ce2981b3480996d9b998e48102ec48170cfc2d18",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/terminal/terminal.tsx",
            "status": "modified",
            "additions": 11,
            "deletions": 10,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/2dbdbdac9461fa257477a328b9656852bb8541da/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fterminal%2Fterminal.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2dbdbdac9461fa257477a328b9656852bb8541da/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fterminal%2Fterminal.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fterminal%2Fterminal.tsx?ref=2dbdbdac9461fa257477a328b9656852bb8541da",
            "patch": "@@ -93,12 +93,7 @@ export const Terminal: React.FC<TerminalProps> = function Terminal({\n \n   return (\n     <div data-nextjs-codeframe>\n-      <button\n-        aria-label=\"Open in editor\"\n-        className=\"code-frame-header\"\n-        data-with-open-in-editor-link-source-file\n-        onClick={open}\n-      >\n+      <div className=\"code-frame-header\">\n         <div className=\"code-frame-link\">\n           <span className=\"code-frame-icon\">\n             <FileIcon lang={fileExtension} />\n@@ -107,11 +102,17 @@ export const Terminal: React.FC<TerminalProps> = function Terminal({\n             {/* TODO: Unlike the CodeFrame component, the `methodName` is unavailable. */}\n             {getFrameSource(stackFrame)}\n           </span>\n-          <span className=\"code-frame-icon\" data-icon=\"right\">\n-            <ExternalIcon width={16} height={16} />\n-          </span>\n+          <button\n+            aria-label=\"Open in editor\"\n+            data-with-open-in-editor-link-source-file\n+            onClick={open}\n+          >\n+            <span className=\"code-frame-icon\" data-icon=\"right\">\n+              <ExternalIcon width={16} height={16} />\n+            </span>\n+          </button>\n         </div>\n-      </button>\n+      </div>\n       <pre className=\"code-frame-pre\">\n         {decoded.map((entry, index) => (\n           <span"
        }
    ],
    "stats": {
        "total": 108,
        "additions": 59,
        "deletions": 49
    }
}