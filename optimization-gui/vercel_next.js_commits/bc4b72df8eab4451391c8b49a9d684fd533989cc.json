{
    "author": "huozhi",
    "message": "[devtool] fix explorer flag consuming and style (#80110)",
    "sha": "bc4b72df8eab4451391c8b49a9d684fd533989cc",
    "files": [
        {
            "sha": "7401a0e08e75713b2cf54d0e63a0d22b363294ea",
            "filename": "packages/next/src/build/templates/app-page.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc4b72df8eab4451391c8b49a9d684fd533989cc/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/bc4b72df8eab4451391c8b49a9d684fd533989cc/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts?ref=bc4b72df8eab4451391c8b49a9d684fd533989cc",
            "patch": "@@ -369,6 +369,8 @@ export async function handler(\n           enableTainting: nextConfig.experimental.taint,\n           // @ts-expect-error fix issue with readonly regex object type\n           htmlLimitedBots: nextConfig.htmlLimitedBots,\n+          devtoolSegmentExplorer:\n+            nextConfig.experimental.devtoolSegmentExplorer,\n           reactMaxHeadersLength: nextConfig.reactMaxHeadersLength,\n \n           multiZoneDraftMode,"
        },
        {
            "sha": "13856c02a4c9cdfad897c81f4ecad747e2328824",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/dev-tools-indicator/dev-tools-indicator.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc4b72df8eab4451391c8b49a9d684fd533989cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc4b72df8eab4451391c8b49a9d684fd533989cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx?ref=bc4b72df8eab4451391c8b49a9d684fd533989cc",
            "patch": "@@ -409,7 +409,7 @@ function DevToolsPopover({\n               />\n               {process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER ? (\n                 <MenuItem\n-                  data-rendered-files\n+                  data-segment-explorer\n                   label=\"Segment Explorer\"\n                   value={<ChevronRight />}\n                   onClick={() => setOpen(OVERLAYS.SegmentExplorer)}"
        },
        {
            "sha": "3f7f64d130b264c3d57fe5c02dc4eb6ab6927597",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/overview/segment-explorer.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/bc4b72df8eab4451391c8b49a9d684fd533989cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Foverview%2Fsegment-explorer.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc4b72df8eab4451391c8b49a9d684fd533989cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Foverview%2Fsegment-explorer.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Foverview%2Fsegment-explorer.tsx?ref=bc4b72df8eab4451391c8b49a9d684fd533989cc",
            "patch": "@@ -54,7 +54,10 @@ function PageSegmentTree({ tree }: { tree: Trie<SegmentNode> | undefined }) {\n     return null\n   }\n   return (\n-    <div className=\"segment-explorer-content\">\n+    <div\n+      className=\"segment-explorer-content\"\n+      data-nextjs-devtool-segment-explorer\n+    >\n       <PageSegmentTreeLayerPresentation\n         tree={tree}\n         node={tree.getRoot()}\n@@ -147,11 +150,6 @@ export const DEV_TOOLS_INFO_RENDER_FILES_STYLES = css`\n \n   .segment-explorer-filename-path {\n     display: inline-block;\n-\n-    &:hover {\n-      color: var(--color-gray-1000);\n-      text-decoration: none;\n-    }\n   }\n \n   .segment-explorer-filename-path a {\n@@ -161,6 +159,7 @@ export const DEV_TOOLS_INFO_RENDER_FILES_STYLES = css`\n \n   .segment-explorer-line {\n     white-space: pre;\n+    cursor: default;\n   }\n \n   .segment-explorer-line-icon {"
        },
        {
            "sha": "e99cd7a68111bc70570712e1d586b331c3ac8179",
            "filename": "packages/next/src/server/app-render/create-component-tree.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/bc4b72df8eab4451391c8b49a9d684fd533989cc/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc4b72df8eab4451391c8b49a9d684fd533989cc/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx?ref=bc4b72df8eab4451391c8b49a9d684fd533989cc",
            "patch": "@@ -1014,12 +1014,13 @@ function normalizePageOrLayoutFilePath(\n   projectDir: string,\n   layoutOrPagePath: string | undefined\n ) {\n-  const dir = projectDir /*ctx.renderOpts.dir*/ || process.cwd()\n   const relativePath = (layoutOrPagePath || '')\n     // remove turbopack [project] prefix\n     .replace(/^\\[project\\][\\\\/]/, '')\n+    // remove the process.cwd() prefix\n+    .replace(process.cwd() + '/', '')\n     // remove the project root from the path\n-    .replace(dir, '')\n+    .replace(projectDir, '')\n     // remove /(src/)?app/ dir prefix\n     .replace(/^[\\\\/](src[\\\\/])?app[\\\\/]/, '')\n "
        },
        {
            "sha": "057e35ed63e3531c87cef0d1f96e30e1f8b2cc51",
            "filename": "test/development/app-dir/segment-explorer/segment-explorer.test.ts",
            "status": "added",
            "additions": 34,
            "deletions": 0,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/bc4b72df8eab4451391c8b49a9d684fd533989cc/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/bc4b72df8eab4451391c8b49a9d684fd533989cc/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts?ref=bc4b72df8eab4451391c8b49a9d684fd533989cc",
            "patch": "@@ -0,0 +1,34 @@\n+import { nextTestSetup } from 'e2e-utils'\n+import { openDevToolsIndicatorPopover } from 'next-test-utils'\n+\n+describe('segment-explorer', () => {\n+  const { next } = nextTestSetup({\n+    files: __dirname,\n+  })\n+\n+  it('should render the segment explorer', async () => {\n+    const browser = await next.browser('/parallel-routes')\n+\n+    // open the devtool button\n+    await openDevToolsIndicatorPopover(browser)\n+\n+    // open the segment explorer\n+    await browser.elementByCss('[data-segment-explorer]').click()\n+\n+    //  wait for the segment explorer to be visible\n+    await browser.waitForElementByCss('[data-nextjs-devtool-segment-explorer]')\n+\n+    const content = await browser.elementByCss(\n+      '[data-nextjs-devtool-segment-explorer]'\n+    )\n+    expect(await content.text()).toMatchInlineSnapshot(`\n+     \"app/parallel-routes/page.tsx\n+     app/parallel-routes/@foo/page.tsx\n+     app/parallel-routes/@foo/layout.tsx\n+     app/parallel-routes/@bar/page.tsx\n+     app/parallel-routes/@bar/layout.tsx\n+     app/parallel-routes/layout.tsx\n+     app/layout.tsx\"\n+    `)\n+  })\n+})"
        }
    ],
    "stats": {
        "total": 54,
        "additions": 45,
        "deletions": 9
    }
}