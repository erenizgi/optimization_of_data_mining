{
    "author": "huozhi",
    "message": "[metadata] promote streaming metadata configs to stable (#76344)",
    "sha": "dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
    "files": [
        {
            "sha": "1f7eaf9ae7d48974a0e1737e3c58e7d192a4b041",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -2757,8 +2757,8 @@ export default async function build(\n                 : undefined\n \n             const htmlBotsRegexString =\n-              config.experimental.htmlLimitedBots ||\n-              HTML_LIMITED_BOT_UA_RE_STRING\n+              // The htmlLimitedBots has been converted to a string during loadConfig\n+              config.htmlLimitedBots || HTML_LIMITED_BOT_UA_RE_STRING\n \n             // this flag is used to selectively bypass the static cache and invoke the lambda directly\n             // to enable server actions on static routes\n@@ -2774,8 +2774,7 @@ export default async function build(\n               ...(isRoutePPREnabled &&\n               // Disable streaming metadata for PPR on deployment where we don't have the special env.\n               // TODO: enable streaming metadata in PPR mode by default once it's ready.\n-              process.env.__NEXT_EXPERIMENTAL_PPR === 'true' &&\n-              config.experimental.streamingMetadata\n+              process.env.__NEXT_EXPERIMENTAL_PPR === 'true'\n                 ? [\n                     {\n                       type: 'header',"
        },
        {
            "sha": "0147e789b66e7dd05027a5e5cb9622c436590d10",
            "filename": "packages/next/src/export/index.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 7,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -380,20 +380,19 @@ async function exportAppImpl(\n       : {}),\n     strictNextHead: nextConfig.experimental.strictNextHead ?? true,\n     deploymentId: nextConfig.deploymentId,\n+    htmlLimitedBots: nextConfig.htmlLimitedBots.source,\n+    streamingMetadata:\n+      // Disable streaming metadata when dynamic IO is enabled.\n+      // FIXME: remove dynamic IO guard once we fixed the dynamic indicator case.\n+      // test/e2e/app-dir/dynamic-io/dynamic-io.test.ts - should not have static indicator on not-found route\n+      !nextConfig.experimental.dynamicIO,\n     experimental: {\n       clientTraceMetadata: nextConfig.experimental.clientTraceMetadata,\n       expireTime: nextConfig.expireTime,\n       dynamicIO: nextConfig.experimental.dynamicIO ?? false,\n       clientSegmentCache: nextConfig.experimental.clientSegmentCache ?? false,\n       inlineCss: nextConfig.experimental.inlineCss ?? false,\n       authInterrupts: !!nextConfig.experimental.authInterrupts,\n-      streamingMetadata:\n-        // Disable streaming metadata when dynamic IO is enabled.\n-        // FIXME: remove dynamic IO guard once we fixed the dynamic indicator case.\n-        // test/e2e/app-dir/dynamic-io/dynamic-io.test.ts - should not have static indicator on not-found route\n-        !nextConfig.experimental.dynamicIO &&\n-        !!nextConfig.experimental.streamingMetadata,\n-      htmlLimitedBots: nextConfig.experimental.htmlLimitedBots,\n     },\n     reactMaxHeadersLength: nextConfig.reactMaxHeadersLength,\n   }"
        },
        {
            "sha": "0fc58c579ea277ca9b13700a01ed85ab018c9aa1",
            "filename": "packages/next/src/export/worker.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fexport%2Fworker.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fexport%2Fworker.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fexport%2Fworker.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -429,8 +429,7 @@ export async function exportPages(\n               // Disable streaming metadata when dynamic IO is enabled.\n               // FIXME: remove dynamic IO guard once we fixed the dynamic indicator case.\n               // test/e2e/app-dir/dynamic-io/dynamic-io.test.ts - should not have static indicator on not-found route\n-              !nextConfig.experimental.dynamicIO &&\n-              !!nextConfig.experimental.streamingMetadata,\n+              !nextConfig.experimental.dynamicIO,\n           }),\n           // If exporting the page takes longer than the timeout, reject the promise.\n           new Promise((_, reject) => {"
        },
        {
            "sha": "e554a1b62eab2bbbf8cf459458b9662ecdf77bc0",
            "filename": "packages/next/src/server/app-render/types.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -204,6 +204,8 @@ export interface RenderOptsPartial {\n   }\n   params?: ParsedUrlQuery\n   isPrefetch?: boolean\n+  htmlLimitedBots: string | undefined\n+  streamingMetadata: boolean\n   experimental: {\n     /**\n      * When true, it indicates that the current page supports partial\n@@ -216,8 +218,6 @@ export interface RenderOptsPartial {\n     clientSegmentCache: boolean\n     inlineCss: boolean\n     authInterrupts: boolean\n-    streamingMetadata: boolean\n-    htmlLimitedBots: string | undefined\n   }\n   postponed?: string\n "
        },
        {
            "sha": "1f5b231d95f5ffe655262df075812580c5a99ba5",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -602,6 +602,13 @@ export default abstract class Server<\n \n       // @ts-expect-error internal field not publicly exposed\n       isExperimentalCompile: this.nextConfig.experimental.isExperimentalCompile,\n+      // `htmlLimitedBots` is passed to server as serialized config in string format\n+      htmlLimitedBots: this.nextConfig.htmlLimitedBots,\n+      streamingMetadata:\n+        // Disable streaming metadata when dynamic IO is enabled.\n+        // FIXME: remove dynamic IO guard once we fixed the dynamic indicator case.\n+        // test/e2e/app-dir/dynamic-io/dynamic-io.test.ts - should not have static indicator on not-found route\n+        !this.nextConfig.experimental.dynamicIO,\n       experimental: {\n         expireTime: this.nextConfig.expireTime,\n         clientTraceMetadata: this.nextConfig.experimental.clientTraceMetadata,\n@@ -610,13 +617,6 @@ export default abstract class Server<\n           this.nextConfig.experimental.clientSegmentCache ?? false,\n         inlineCss: this.nextConfig.experimental.inlineCss ?? false,\n         authInterrupts: !!this.nextConfig.experimental.authInterrupts,\n-        streamingMetadata:\n-          // Disable streaming metadata when dynamic IO is enabled.\n-          // FIXME: remove dynamic IO guard once we fixed the dynamic indicator case.\n-          // test/e2e/app-dir/dynamic-io/dynamic-io.test.ts - should not have static indicator on not-found route\n-          !this.nextConfig.experimental.dynamicIO &&\n-          !!this.nextConfig.experimental.streamingMetadata,\n-        htmlLimitedBots: this.nextConfig.experimental.htmlLimitedBots,\n       },\n       onInstrumentationRequestError:\n         this.instrumentationOnRequestError.bind(this),\n@@ -1769,10 +1769,10 @@ export default abstract class Server<\n         ...this.renderOpts,\n         supportsDynamicResponse: !isBotRequest,\n         botType: getBotType(ua),\n-        serveStreamingMetadata: shouldServeStreamingMetadata(\n-          ua,\n-          this.renderOpts.experimental\n-        ),\n+        serveStreamingMetadata: shouldServeStreamingMetadata(ua, {\n+          streamingMetadata: !!this.renderOpts.streamingMetadata,\n+          htmlLimitedBots: this.nextConfig.htmlLimitedBots,\n+        }),\n       },\n     }\n "
        },
        {
            "sha": "d1b21cf8536df81c68a94ac84c361627e00240ab",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -448,8 +448,6 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n         typedEnv: z.boolean().optional(),\n         serverComponentsHmrCache: z.boolean().optional(),\n         authInterrupts: z.boolean().optional(),\n-        streamingMetadata: z.boolean().optional(),\n-        htmlLimitedBots: z.instanceof(RegExp).optional(),\n         useCache: z.boolean().optional(),\n         slowModuleDetection: z\n           .object({\n@@ -489,6 +487,7 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n       .args()\n       .returns(z.promise(z.array(zHeader)))\n       .optional(),\n+    htmlLimitedBots: z.instanceof(RegExp).optional(),\n     httpAgentOptions: z\n       .strictObject({ keepAlive: z.boolean().optional() })\n       .optional(),"
        },
        {
            "sha": "5927fe8bc8730abdfef8f3a29bc28ada35e257ed",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 16,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -23,9 +23,8 @@ export type NextConfigComplete = Required<NextConfig> & {\n   configFileName: string\n   // override NextConfigComplete.experimental.htmlLimitedBots to string\n   // because it's not defined in NextConfigComplete.experimental\n-  experimental: Omit<ExperimentalConfig, 'htmlLimitedBots'> & {\n-    htmlLimitedBots: string | undefined\n-  }\n+  htmlLimitedBots: string | undefined\n+  experimental: ExperimentalConfig\n }\n \n export type I18NDomains = readonly DomainLocale[]\n@@ -587,17 +586,6 @@ export interface ExperimentalConfig {\n    */\n   authInterrupts?: boolean\n \n-  /**\n-   * When enabled will cause async metadata calls to stream rather than block the render.\n-   */\n-  streamingMetadata?: boolean\n-\n-  /**\n-   * User Agent of bots that can handle streaming metadata.\n-   * Besides the default behavior, Next.js act differently on serving metadata to bots based on their capability.\n-   */\n-  htmlLimitedBots?: RegExp\n-\n   /**\n    * Enables the use of the `\"use cache\"` directive.\n    */\n@@ -1079,6 +1067,12 @@ export interface NextConfig extends Record<string, any> {\n   watchOptions?: {\n     pollIntervalMs?: number\n   }\n+\n+  /**\n+   * User agent of bots that should opt-out streaming metadata.\n+   * User agents that pass this regex will block rendering until metadata has resolved, to ensure it's available in the `head` of the document.\n+   */\n+  htmlLimitedBots?: RegExp\n }\n \n export const defaultConfig: NextConfig = {\n@@ -1258,11 +1252,10 @@ export const defaultConfig: NextConfig = {\n     staticGenerationMinPagesPerWorker: 25,\n     dynamicIO: false,\n     inlineCss: false,\n-    streamingMetadata: true,\n-    htmlLimitedBots: undefined,\n     useCache: undefined,\n     slowModuleDetection: undefined,\n   },\n+  htmlLimitedBots: undefined,\n   bundlePagesRouterDependencies: false,\n }\n "
        },
        {
            "sha": "423bbf3fece0c9c2e2beb3f543219694834a8b01",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -1043,9 +1043,9 @@ function assignDefaults(\n     ]),\n   ]\n \n-  if (!result.experimental.htmlLimitedBots) {\n+  if (!result.htmlLimitedBots) {\n     // @ts-expect-error: override the htmlLimitedBots with default string, type covert: RegExp -> string\n-    result.experimental.htmlLimitedBots = HTML_LIMITED_BOT_UA_RE_STRING\n+    result.htmlLimitedBots = HTML_LIMITED_BOT_UA_RE_STRING\n   }\n \n   // \"use cache\" was originally implicitly enabled with the dynamicIO flag, so\n@@ -1169,10 +1169,10 @@ export default async function loadConfig(\n       throw err\n     }\n \n-    const userConfig = await normalizeConfig(\n+    const userConfig = (await normalizeConfig(\n       phase,\n       userConfigModule.default || userConfigModule\n-    )\n+    )) as NextConfig\n \n     if (!process.env.NEXT_MINIMAL) {\n       // We only validate the config against schema in non minimal mode\n@@ -1221,7 +1221,7 @@ export default async function loadConfig(\n       const { canonicalBase } = userConfig.amp || ({} as any)\n       userConfig.amp = userConfig.amp || {}\n       userConfig.amp.canonicalBase =\n-        (canonicalBase.endsWith('/')\n+        (canonicalBase?.endsWith('/')\n           ? canonicalBase.slice(0, -1)\n           : canonicalBase) || ''\n     }\n@@ -1264,9 +1264,9 @@ export default async function loadConfig(\n     }\n \n     // serialize the regex config into string\n-    if (userConfig.experimental?.htmlLimitedBots instanceof RegExp) {\n-      userConfig.experimental.htmlLimitedBots =\n-        userConfig.experimental.htmlLimitedBots.source\n+    if (userConfig?.htmlLimitedBots instanceof RegExp) {\n+      // @ts-expect-error: override the htmlLimitedBots with default string, type covert: RegExp -> string\n+      userConfig.htmlLimitedBots = userConfig.htmlLimitedBots.source\n     }\n \n     onLoadUserConfig?.(userConfig)"
        },
        {
            "sha": "807126e4cf0bf5b1c8c917e6e0148a27331587d1",
            "filename": "test/e2e/app-dir/metadata-streaming-static-generation/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fe2e%2Fapp-dir%2Fmetadata-streaming-static-generation%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fe2e%2Fapp-dir%2Fmetadata-streaming-static-generation%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fmetadata-streaming-static-generation%2Fnext.config.js?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -1,10 +1,6 @@\n /**\n  * @type {import('next').NextConfig}\n  */\n-const nextConfig = {\n-  experimental: {\n-    streamingMetadata: true,\n-  },\n-}\n+const nextConfig = {}\n \n module.exports = nextConfig"
        },
        {
            "sha": "f8781d30251984f410366250e71b32f0b84016b5",
            "filename": "test/e2e/app-dir/metadata-streaming/metadata-streaming-customized-rule.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fe2e%2Fapp-dir%2Fmetadata-streaming%2Fmetadata-streaming-customized-rule.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fe2e%2Fapp-dir%2Fmetadata-streaming%2Fmetadata-streaming-customized-rule.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fmetadata-streaming%2Fmetadata-streaming-customized-rule.test.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -6,10 +6,7 @@ describe('app-dir - metadata-streaming-customized-rule', () => {\n     overrideFiles: {\n       'next.config.js': `\n         module.exports = {\n-          experimental: {\n-            streamingMetadata: true,\n-            htmlLimitedBots: /Minibot/i,\n-          }\n+          htmlLimitedBots: /Minibot/i,\n         }\n       `,\n     },"
        },
        {
            "sha": "807126e4cf0bf5b1c8c917e6e0148a27331587d1",
            "filename": "test/e2e/app-dir/metadata-streaming/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fe2e%2Fapp-dir%2Fmetadata-streaming%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fe2e%2Fapp-dir%2Fmetadata-streaming%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fmetadata-streaming%2Fnext.config.js?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -1,10 +1,6 @@\n /**\n  * @type {import('next').NextConfig}\n  */\n-const nextConfig = {\n-  experimental: {\n-    streamingMetadata: true,\n-  },\n-}\n+const nextConfig = {}\n \n module.exports = nextConfig"
        },
        {
            "sha": "016ac8833b57fe46d032dcd15c1b751138a86b05",
            "filename": "test/e2e/app-dir/ppr-metadata-streaming/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fe2e%2Fapp-dir%2Fppr-metadata-streaming%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fe2e%2Fapp-dir%2Fppr-metadata-streaming%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fppr-metadata-streaming%2Fnext.config.js?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -4,7 +4,6 @@\n const nextConfig = {\n   experimental: {\n     ppr: true,\n-    streamingMetadata: true,\n   },\n }\n "
        },
        {
            "sha": "90598f2be87c0d7c8c604dfcdb0e2f4d14cc50be",
            "filename": "test/production/app-dir/metadata-streaming-config/metadata-streaming-config-customized.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config-customized.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config-customized.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config-customized.test.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -10,10 +10,9 @@ describe('app-dir - metadata-streaming-config-customized', () => {\n     overrideFiles: {\n       'next.config.js': `\n         module.exports = {\n-          experimental: {\n+          htmlLimitedBots: /MyBot/i,\n+            experimental: {\n             ppr: 'incremental',\n-            streamingMetadata: true,\n-            htmlLimitedBots: /MyBot/i,\n           }\n         }\n       `,"
        },
        {
            "sha": "95f470b963bd9c1b4a86a8f8e9a28127ce26b17a",
            "filename": "test/production/app-dir/metadata-streaming-config/metadata-streaming-config.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config.test.ts?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -16,9 +16,7 @@ describe('app-dir - metadata-streaming-config', () => {\n       await next.readFile('.next/required-server-files.json')\n     )\n \n-    expect(\n-      requiredServerFiles.config.experimental.htmlLimitedBots\n-    ).toMatchInlineSnapshot(\n+    expect(requiredServerFiles.config.htmlLimitedBots).toMatchInlineSnapshot(\n       `\"Mediapartners-Google|Slurp|DuckDuckBot|baiduspider|yandex|sogou|bitlybot|tumblr|vkShare|quora link preview|redditbot|ia_archiver|Bingbot|BingPreview|applebot|facebookexternalhit|facebookcatalog|Twitterbot|LinkedInBot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview\"`\n     )\n "
        },
        {
            "sha": "17dfbe817837992ea828de327e28a35633c5781e",
            "filename": "test/production/app-dir/metadata-streaming-config/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fnext.config.js?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -4,7 +4,6 @@\n const nextConfig = {\n   experimental: {\n     ppr: 'incremental',\n-    streamingMetadata: true,\n   },\n }\n "
        },
        {
            "sha": "17dfbe817837992ea828de327e28a35633c5781e",
            "filename": "test/production/app-dir/ppr-disable-streaming-metadata/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fproduction%2Fapp-dir%2Fppr-disable-streaming-metadata%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c/test%2Fproduction%2Fapp-dir%2Fppr-disable-streaming-metadata%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fppr-disable-streaming-metadata%2Fnext.config.js?ref=dc5dd46f6f84bb33b0d0faf0b4b9c83ab382b38c",
            "patch": "@@ -4,7 +4,6 @@\n const nextConfig = {\n   experimental: {\n     ppr: 'incremental',\n-    streamingMetadata: true,\n   },\n }\n "
        }
    ],
    "stats": {
        "total": 122,
        "additions": 47,
        "deletions": 75
    }
}