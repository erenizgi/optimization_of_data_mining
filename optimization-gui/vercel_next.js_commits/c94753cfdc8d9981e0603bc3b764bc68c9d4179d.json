{
    "author": "delbaoliveira",
    "message": "Docs: Update `useLinkStatus` API reference (#78022)\n\nUpdating the docs after playing around with `useLinkStatus`:\nhttps://github.com/vercel/next-app-router-playground/pull/184\nCloses: https://linear.app/vercel/issue/DOC-4514/update-docs\n\nMain changes:\n\n- Update introduction\n- Simplify example\n- Add example for gracefully handling fast navigations (avoiding UI\nflash)",
    "sha": "c94753cfdc8d9981e0603bc3b764bc68c9d4179d",
    "files": [
        {
            "sha": "11bbf42ba2c19d7e7760ff06469a3de2ff1945d9",
            "filename": "docs/01-app/05-api-reference/04-functions/use-link-status.mdx",
            "status": "modified",
            "additions": 90,
            "deletions": 78,
            "changes": 168,
            "blob_url": "https://github.com/vercel/next.js/blob/c94753cfdc8d9981e0603bc3b764bc68c9d4179d/docs%2F01-app%2F05-api-reference%2F04-functions%2Fuse-link-status.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/c94753cfdc8d9981e0603bc3b764bc68c9d4179d/docs%2F01-app%2F05-api-reference%2F04-functions%2Fuse-link-status.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F04-functions%2Fuse-link-status.mdx?ref=c94753cfdc8d9981e0603bc3b764bc68c9d4179d",
            "patch": "@@ -1,9 +1,20 @@\n ---\n title: useLinkStatus\n description: API Reference for the useLinkStatus hook.\n+related:\n+  title: Next Steps\n+  description: Learn more about the features mentioned in this page by reading the API Reference.\n+  links:\n+    - app/api-reference/components/link\n+    - app/api-reference/file-conventions/loading\n ---\n \n-`useLinkStatus` is a **Client Component** hook that lets you track the loading state of a `Link` component during navigation. It can be used to show loading indicators during page transitions, especially when [prefetching](/docs/app/building-your-application/routing/linking-and-navigating#2-prefetching) is disabled, or the linked route does not have any loading states.\n+The `useLinkStatus` hook lets you tracks the **pending** state of a `<Link>`. You can use it to show inline visual feedback to the user (like spinners or text glimmers) while a navigation to a new route completes.\n+\n+`useLinkStatus` is useful when:\n+\n+- [Prefetching](/docs/app/building-your-application/routing/linking-and-navigating#2-prefetching) is disabled or in progress meaning navigation is blocked.\n+- The destination route is dynamic **and** doesn't include a [`loading.js`](/docs/app/api-reference/file-conventions/loading) file that would allow an instant navigation.\n \n ```tsx filename=\"app/loading-indicator.tsx\" switcher\n 'use client'\n@@ -12,7 +23,9 @@ import { useLinkStatus } from 'next/link'\n \n export default function LoadingIndicator() {\n   const { pending } = useLinkStatus()\n-  return pending ? <span>⌛</span> : null\n+  return pending ? (\n+    <div role=\"status\" aria-label=\"Loading\" className=\"spinner\" />\n+  ) : null\n }\n ```\n \n@@ -23,7 +36,9 @@ import { useLinkStatus } from 'next/link'\n \n export default function LoadingIndicator() {\n   const { pending } = useLinkStatus()\n-  return pending ? <span>⌛</span> : null\n+  return pending ? (\n+    <div role=\"status\" aria-label=\"Loading\" className=\"spinner\" />\n+  ) : null\n }\n ```\n \n@@ -81,13 +96,11 @@ const { pending } = useLinkStatus()\n | -------- | ------- | -------------------------------------------- |\n | pending  | boolean | `true` before history updates, `false` after |\n \n-## Examples\n-\n-### Improving the user experience when navigating with new query parameters\n+## Example\n \n-In this example, navigating between categories updates the query string (e.g. ?category=books). However, the page may appear unresponsive because the `<PageSkeleton />` fallback won't replace the existing content (see [preventing unwanted loading indicators](https://react.dev/reference/react/useTransition#preventing-unwanted-loading-indicators)).\n+### Inline loading indicator\n \n-You can use the `useLinkStatus` hook to render a lightweight loading indicator next to the active link and provide immediate feedback to the user while the data is being fetched.\n+It's helpful to add visual feedback that navigation is happening in case the user clicks a link before prefetching is complete.\n \n ```tsx filename=\"app/components/loading-indicator.tsx\" switcher\n 'use client'\n@@ -96,7 +109,9 @@ import { useLinkStatus } from 'next/link'\n \n export default function LoadingIndicator() {\n   const { pending } = useLinkStatus()\n-  return pending ? <span>⌛</span> : null\n+  return pending ? (\n+    <div role=\"status\" aria-label=\"Loading\" className=\"spinner\" />\n+  ) : null\n }\n ```\n \n@@ -107,105 +122,102 @@ import { useLinkStatus } from 'next/link'\n \n export default function LoadingIndicator() {\n   const { pending } = useLinkStatus()\n-  return pending ? <span>⌛</span> : null\n+  return pending ? (\n+    <div role=\"status\" aria-label=\"Loading\" className=\"spinner\" />\n+  ) : null\n }\n ```\n \n-```tsx filename=\"app/page.tsx\" switcher\n-import { useSearchParams } from 'next/navigation'\n+```tsx filename=\"app/shop/layout.tsx\" switcher\n import Link from 'next/link'\n-import { Suspense } from 'react'\n-import LoadingIndicator from './loading-indicator'\n+import LoadingIndicator from './components/loading-indicator'\n+\n+const links = [\n+  { href: '/shop/electronics', label: 'Electronics' },\n+  { href: '/shop/clothing', label: 'Clothing' },\n+  { href: '/shop/books', label: 'Books' },\n+]\n \n-function MenuBar() {\n+function Menubar() {\n   return (\n     <div>\n-      <Link href=\"?category=electronics\">\n-        Electronics <LoadingIndicator />\n-      </Link>\n-      <Link href=\"?category=clothing\">\n-        Clothing <LoadingIndicator />\n-      </Link>\n-      <Link href=\"?category=books\">\n-        Books <LoadingIndicator />\n-      </Link>\n+      {links.map((link) => (\n+        <Link key={link.label} href={link.href}>\n+          {link.label} <LoadingIndicator />\n+        </Link>\n+      ))}\n     </div>\n   )\n }\n \n-async function ProductList({ category }: { category: string }) {\n-  const products = await fetchProducts(category)\n-\n+export default function Layout({ children }: { children: React.ReactNode }) {\n   return (\n-    <ul>\n-      {products.map((product) => (\n-        <li key={product}>{product}</li>\n-      ))}\n-    </ul>\n+    <div>\n+      <Menubar />\n+      {children}\n+    </div>\n   )\n }\n+```\n+\n+```jsx filename=\"app/shop/layout.js\" switcher\n+import Link from 'next/link'\n+import LoadingIndicator from './components/loading-indicator'\n \n-export default async function ProductCategories({\n-  searchParams,\n-}: {\n-  searchParams: Promise<{\n-    category: string\n-  }>\n-}) {\n-  const { category } = await searchParams\n+const links = [\n+  { href: '/shop/electronics', label: 'Electronics' },\n+  { href: '/shop/clothing', label: 'Clothing' },\n+  { href: '/shop/books', label: 'Books' },\n+]\n \n+function Menubar() {\n   return (\n-    <Suspense fallback={<PageSkeleton />}>\n-      <MenuBar />\n-      <ProductList category={category} />\n-    </Suspense>\n+    <div>\n+      {links.map((link) => (\n+        <Link key={link.label} href={link.href}>\n+          {link.label} <LoadingIndicator />\n+        </Link>\n+      ))}\n+    </div>\n   )\n }\n-```\n \n-```jsx filename=\"app/page.js\" switcher\n-import { useSearchParams } from 'next/navigation'\n-import Link from 'next/link'\n-import { Suspense } from 'react'\n-import LoadingIndicator from './loading-indicator'\n-\n-function MenuBar() {\n+export default function Layout({ children }) {\n   return (\n     <div>\n-      <Link href=\"?category=electronics\">\n-        Electronics <LoadingIndicator />\n-      </Link>\n-      <Link href=\"?category=clothing\">\n-        Clothing <LoadingIndicator />\n-      </Link>\n-      <Link href=\"?category=books\">\n-        Books <LoadingIndicator />\n-      </Link>\n+      <Menubar />\n+      {children}\n     </div>\n   )\n }\n+```\n \n-async function ProductList({ category }) {\n-  const products = await fetchProducts(category)\n+## Gracefully handling fast navigation\n \n-  return (\n-    <ul>\n-      {products.map((product) => (\n-        <li key={product}>{product}</li>\n-      ))}\n-    </ul>\n-  )\n+If the navigation to a new route is fast, users may see an unecessary flash of the loading indicator. One way to improve the user experience and only show the loading indicator when the navigation takes time to complete is to add an initial animation delay (e.g. 100ms) and start the animation as invisible (e.g. `opacity: 0`).\n+\n+```css filename=\"app/styles/global.css\"\n+.spinner {\n+  /* ... */\n+  opacity: 0;\n+  animation:\n+    fadeIn 500ms 100ms forwards,\n+    rotate 1s linear infinite;\n }\n \n-export default async function ProductCategories({ searchParams }) {\n-  const { category } = await searchParams\n+@keyframes fadeIn {\n+  from {\n+    opacity: 0;\n+  }\n+  to {\n+    opacity: 1;\n+  }\n+}\n \n-  return (\n-    <Suspense fallback={<PageSkeleton />}>\n-      <MenuBar />\n-      <ProductList category={category} />\n-    </Suspense>\n-  )\n+@keyframes rotate {\n+  to {\n+    transform: rotate(360deg);\n+  }\n }\n ```\n "
        }
    ],
    "stats": {
        "total": 168,
        "additions": 90,
        "deletions": 78
    }
}