{
    "author": "ztanner",
    "message": "remove dynamicIO flag (#84872)\n\nThis flag is now `experimental.cacheComponents`. We kept around the old\nversion with auto-migration, and now that we've had that around for some\ntime, we're dropping support for the configuration all together.",
    "sha": "7e45ab1a47fccaf038247dcf91dbd5545685f0eb",
    "files": [
        {
            "sha": "93c5d3ca7a139515aea5e8d6a2d7437057cff976",
            "filename": "packages/next/src/build/webpack-config.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts?ref=7e45ab1a47fccaf038247dcf91dbd5545685f0eb",
            "patch": "@@ -1554,7 +1554,7 @@ export default async function getBaseWebpackConfig(\n         ...getNextRootParamsRules({\n           isRootParamsEnabled:\n             config.experimental.rootParams ??\n-            // `experimental.dynamicIO` implies `experimental.rootParams`.\n+            // `experimental.cacheComponents` implies `experimental.rootParams`.\n             config.experimental.cacheComponents ??\n             false,\n           isClient,"
        },
        {
            "sha": "11f53fe9606687785c91431ae39bbef7d31eafce",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=7e45ab1a47fccaf038247dcf91dbd5545685f0eb",
            "patch": "@@ -201,7 +201,6 @@ export const experimentalSchema = {\n   disableOptimizedLoading: z.boolean().optional(),\n   disablePostcssPresetEnv: z.boolean().optional(),\n   cacheComponents: z.boolean().optional(),\n-  dynamicIO: z.boolean().optional(),\n   inlineCss: z.boolean().optional(),\n   esmExternals: z.union([z.boolean(), z.literal('loose')]).optional(),\n   serverActions: z"
        },
        {
            "sha": "7e3006ad834b1b5626b79f030bc1fd100a83236a",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=7e45ab1a47fccaf038247dcf91dbd5545685f0eb",
            "patch": "@@ -722,11 +722,6 @@ export interface ExperimentalConfig {\n    */\n   cacheComponents?: boolean\n \n-  /**\n-   * @deprecated Use `experimental.cacheComponents` instead.\n-   */\n-  dynamicIO?: boolean\n-\n   /**\n    * Render <style> tags inline in the HTML for imported CSS assets.\n    * Supports app-router in production mode only."
        },
        {
            "sha": "b2859f049dec70003131710f66b6330add51430b",
            "filename": "packages/next/src/server/config.test.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 61,
            "changes": 61,
            "blob_url": "https://github.com/vercel/next.js/blob/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.test.ts?ref=7e45ab1a47fccaf038247dcf91dbd5545685f0eb",
            "patch": "@@ -197,66 +197,5 @@ describe('loadConfig', () => {\n \n       expect(result.experimental.rdcForNavigations).toBe(true)\n     })\n-\n-    it('migrates experimental.dynamicIO to experimental.cacheComponents', async () => {\n-      process.env.__NEXT_VERSION = 'canary'\n-\n-      const result = await loadConfig(PHASE_PRODUCTION_BUILD, __dirname, {\n-        customConfig: {\n-          experimental: {\n-            dynamicIO: true,\n-          },\n-        },\n-        silent: true,\n-      })\n-\n-      expect(result.experimental.cacheComponents).toBe(true)\n-      expect(result.experimental.dynamicIO).toBeUndefined()\n-\n-      delete process.env.__NEXT_VERSION\n-    })\n-\n-    it('preserves cacheComponents when both dynamicIO and cacheComponents are set', async () => {\n-      process.env.__NEXT_VERSION = 'canary'\n-\n-      const result = await loadConfig(PHASE_PRODUCTION_BUILD, __dirname, {\n-        customConfig: {\n-          experimental: {\n-            dynamicIO: true,\n-            cacheComponents: false,\n-          },\n-        },\n-        silent: true,\n-      })\n-\n-      expect(result.experimental.cacheComponents).toBe(false)\n-      expect(result.experimental.dynamicIO).toBeUndefined()\n-\n-      delete process.env.__NEXT_VERSION\n-    })\n-\n-    it('warns when using deprecated experimental.dynamicIO', async () => {\n-      process.env.__NEXT_VERSION = 'canary'\n-\n-      const consoleSpy = jest.spyOn(console, 'warn').mockImplementation()\n-\n-      await loadConfig(PHASE_PRODUCTION_BUILD, __dirname, {\n-        customConfig: {\n-          experimental: {\n-            dynamicIO: true,\n-          },\n-        },\n-        silent: false,\n-      })\n-\n-      expect(consoleSpy).toHaveBeenCalledWith(\n-        expect.stringContaining(\n-          '`experimental.dynamicIO` has been renamed to `experimental.cacheComponents`'\n-        )\n-      )\n-\n-      consoleSpy.mockRestore()\n-      delete process.env.__NEXT_VERSION\n-    })\n   })\n })"
        },
        {
            "sha": "e174cfd6f3c5096d60b5423361f2ce455425179a",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 22,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=7e45ab1a47fccaf038247dcf91dbd5545685f0eb",
            "patch": "@@ -130,15 +130,6 @@ function checkDeprecations(\n   silent: boolean,\n   dir: string\n ) {\n-  if (userConfig.experimental?.dynamicIO !== undefined) {\n-    warnOptionHasBeenDeprecated(\n-      userConfig,\n-      'experimental.dynamicIO',\n-      `\\`experimental.dynamicIO\\` has been renamed to \\`experimental.cacheComponents\\`. Please update your ${configFileName} file accordingly.`,\n-      silent\n-    )\n-  }\n-\n   warnOptionHasBeenDeprecated(\n     userConfig,\n     'experimental.middlewarePrefetch',\n@@ -285,19 +276,6 @@ function assignDefaultsAndValidate(\n     delete (userConfig as any).exportTrailingSlash\n   }\n \n-  // Handle migration of experimental.dynamicIO to experimental.cacheComponents\n-  if (userConfig.experimental?.dynamicIO !== undefined) {\n-    // If cacheComponents was not explicitly set by the user (i.e., it's still the default value),\n-    // use the dynamicIO value. We check against the user config, not the merged result.\n-    if (userConfig.experimental?.cacheComponents === undefined) {\n-      userConfig.experimental.cacheComponents =\n-        userConfig.experimental.dynamicIO\n-    }\n-\n-    // Remove the deprecated property\n-    delete userConfig.experimental.dynamicIO\n-  }\n-\n   const config = Object.keys(userConfig).reduce<{ [key: string]: any }>(\n     (currentConfig, key) => {\n       const value = (userConfig as any)[key]"
        },
        {
            "sha": "b16b1983046050596d2d1cb95ef45f394bb416a9",
            "filename": "packages/next/src/server/request/root-params.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Frequest%2Froot-params.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7e45ab1a47fccaf038247dcf91dbd5545685f0eb/packages%2Fnext%2Fsrc%2Fserver%2Frequest%2Froot-params.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Frequest%2Froot-params.ts?ref=7e45ab1a47fccaf038247dcf91dbd5545685f0eb",
            "patch": "@@ -108,7 +108,7 @@ function createPrerenderRootParamPromise(\n \n   switch (prerenderStore.type) {\n     case 'prerender': {\n-      // We are in a dynamicIO prerender.\n+      // We are in a cacheComponents prerender.\n       // The param is a fallback, so it should be treated as dynamic.\n       if (\n         prerenderStore.fallbackRouteParams &&\n@@ -123,7 +123,7 @@ function createPrerenderRootParamPromise(\n       break\n     }\n     case 'prerender-ppr': {\n-      // We aren't in a dynamicIO prerender, but the param is a fallback,\n+      // We aren't in a cacheComponents prerender, but the param is a fallback,\n       // so we need to make an erroring params object which will postpone/error if you access it\n       if (\n         prerenderStore.fallbackRouteParams &&\n@@ -162,7 +162,7 @@ async function makeErroringRootParamPromise(\n   // In most dynamic APIs, we also throw if `dynamic = \"error\"`.\n   // However, root params are only dynamic when we're generating a fallback shell,\n   // and even with `dynamic = \"error\"` we still support generating dynamic fallback shells.\n-  // TODO: remove this comment when dynamicIO is the default since there will be no `dynamic = \"error\"`\n+  // TODO: remove this comment when cacheComponents is the default since there will be no `dynamic = \"error\"`\n   switch (prerenderStore.type) {\n     case 'prerender-ppr': {\n       return postponeWithTracking("
        }
    ],
    "stats": {
        "total": 97,
        "additions": 4,
        "deletions": 93
    }
}