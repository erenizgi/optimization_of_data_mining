{
    "author": "delbaoliveira",
    "message": "Revert \"Docs: Recommend inline `use server` and update examples\" (#77771)\n\nReverts vercel/next.js#77770",
    "sha": "251d1fec82b652aa0d354cb906ec8fc4cfac6308",
    "files": [
        {
            "sha": "1d999170f177b13b6909e571d3d1c2563f14d6d9",
            "filename": "docs/01-app/01-getting-started/07-updating-data.mdx",
            "status": "modified",
            "additions": 28,
            "deletions": 32,
            "changes": 60,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F01-getting-started%2F07-updating-data.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F01-getting-started%2F07-updating-data.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F01-getting-started%2F07-updating-data.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -15,33 +15,23 @@ You can update data in Next.js using React's [Server Functions](https://react.de\n \n ## Creating Server Functions\n \n-A Server Function can be defined by using the [`use server`](https://react.dev/reference/rsc/use-server) directive. You can place the directive in an **asynchronous** function to mark the function as a Server Function.\n+A Server Function can be defined by using the [`use server`](https://react.dev/reference/rsc/use-server) directive. You can place the directive at the top of an **asynchronous** function to mark the function as a Server Function, or at the top of a separate file to mark all exports of that file. We recommend using a separate file in most instances.\n \n ```ts filename=\"app/lib/actions.ts\" switcher\n-export async function createPost(formData: FormData) {\n-  'use server'\n-  // Update data\n-}\n+'use server'\n \n-export async function deletePost(formData: FormData) {\n-  'use server'\n-  // Update data\n-}\n+export async function createPost(formData: FormData) {}\n+\n+export async function deletePost(formData: FormData) {}\n ```\n \n ```js filename=\"app/lib/actions.js\" switcher\n-export async function createPost(formData) {\n-  'use server'\n-  // Update data\n-}\n+'use server'\n \n-export async function deletePost(formData) {\n-  'use server'\n-  // Update data\n-}\n-```\n+export async function createPost(formData) {}\n \n-> You can also add `use server` at the top of a file to mark all exports of that file as Server Functions. However, this can lead to functions being marked as Server Functions when they are not intended to be used as such. We recommend scoping `use server` to the function level instead as shown above.\n+export async function deletePost(formData) {}\n+```\n \n ### Server Components\n \n@@ -75,18 +65,18 @@ export default function Page() {\n \n ### Client Components\n \n-It's not possible to define Server Functions in Client Components. However, you can invoke them in Client Components by placing the functions in a separate file and importing them:\n+It's not possible to define Server Functions in Client Components. However, you can invoke them in Client Components by importing them from a file that has the `\"use server\"` directive at the top of it:\n \n ```ts filename=\"app/actions.ts\" switcher\n-export async function createPost() {\n-  'use server'\n-}\n+'use server'\n+\n+export async function createPost() {}\n ```\n \n ```js filename=\"app/actions.js\" switcher\n-export async function createPost() {\n-  'use server'\n-}\n+'use server'\n+\n+export async function createPost() {}\n ```\n \n ```tsx filename=\"app/ui/button.tsx\" switcher\n@@ -151,8 +141,9 @@ export function Form() {\n ```\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n export async function createPost(formData: FormData) {\n-  'use server'\n   const title = formData.get('title')\n   const content = formData.get('content')\n \n@@ -162,8 +153,9 @@ export async function createPost(formData: FormData) {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n export async function createPost(formData) {\n-  'use server'\n   const title = formData.get('title')\n   const content = formData.get('content')\n \n@@ -273,10 +265,11 @@ export function Button() {\n After performing an update, you can revalidate the Next.js cache and show the updated data by calling [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath) or [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) within the Server Function:\n \n ```ts filename=\"app/lib/actions.ts\" switcher\n+'use server'\n+\n import { revalidatePath } from 'next/cache'\n \n export async function createPost(formData: FormData) {\n-  'use server'\n   // Update data\n   // ...\n \n@@ -285,10 +278,11 @@ export async function createPost(formData: FormData) {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { revalidatePath } from 'next/cache'\n \n export async function createPost(formData) {\n-  'use server'\n   // Update data\n   // ...\n   revalidatePath('/posts')\n@@ -300,10 +294,11 @@ export async function createPost(formData) {\n You may want to redirect the user to a different page after performing an update. You can do this by calling [`redirect`](/docs/app/api-reference/functions/redirect) within the Server Function:\n \n ```ts filename=\"app/lib/actions.ts\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n \n export async function createPost(formData: FormData) {\n-  'use server'\n   // Update data\n   // ...\n \n@@ -312,10 +307,11 @@ export async function createPost(formData: FormData) {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n \n export async function createPost(formData) {\n-  'use server'\n   // Update data\n   // ...\n "
        },
        {
            "sha": "657e7f69969a918d7d2e2edd47c73a57e147fe44",
            "filename": "docs/01-app/01-getting-started/08-error-handling.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F01-getting-started%2F08-error-handling.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F01-getting-started%2F08-error-handling.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F01-getting-started%2F08-error-handling.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -23,8 +23,9 @@ Expected errors are those that can occur during the normal operation of the appl\n You can use the [`useActionState`](https://react.dev/reference/react/useActionState) hook to manage the state of [Server Functions](https://react.dev/reference/rsc/server-functions) and handle expected errors. Avoid using `try`/`catch` blocks for expected errors. Instead, you can model expected errors as return values, not as thrown exceptions.\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n export async function createPost(prevState: any, formData: FormData) {\n-  'use server'\n   const title = formData.get('title')\n   const content = formData.get('content')\n \n@@ -41,8 +42,9 @@ export async function createPost(prevState: any, formData: FormData) {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n export async function createPost(prevState, formData) {\n-  'use server'\n   const title = formData.get('title')\n   const content = formData.get('content')\n "
        },
        {
            "sha": "9a80e88c2deb15a6675f7ae245a7f05154e99760",
            "filename": "docs/01-app/03-building-your-application/01-routing/05-error-handling.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F01-routing%2F05-error-handling.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F01-routing%2F05-error-handling.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-building-your-application%2F01-routing%2F05-error-handling.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -20,10 +20,11 @@ Expected errors are those that can occur during the normal operation of the appl\n Use the `useActionState` hook to manage the state of Server Actions, including handling errors. This approach avoids `try`/`catch` blocks for expected errors, which should be modeled as return values rather than thrown exceptions.\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n \n export async function createUser(prevState: any, formData: FormData) {\n-  'use server'\n   const res = await fetch('https://...')\n   const json = await res.json()\n \n@@ -36,10 +37,11 @@ export async function createUser(prevState: any, formData: FormData) {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n \n export async function createUser(prevState, formData) {\n-  'use server'\n   const res = await fetch('https://...')\n   const json = await res.json()\n "
        },
        {
            "sha": "637a0ce1246b38db45e2c35a886c8bd65d6bbe81",
            "filename": "docs/01-app/03-building-your-application/01-routing/07-redirecting.mdx",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F01-routing%2F07-redirecting.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F01-routing%2F07-redirecting.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-building-your-application%2F01-routing%2F07-redirecting.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -42,11 +42,12 @@ The `redirect` function allows you to redirect the user to another URL. You can\n `redirect` is often used after a mutation or event. For example, creating a post:\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n import { revalidatePath } from 'next/cache'\n \n export async function createPost(id: string) {\n-  'use server'\n   try {\n     // Call database\n   } catch (error) {\n@@ -59,11 +60,12 @@ export async function createPost(id: string) {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n import { revalidatePath } from 'next/cache'\n \n export async function createPost(id) {\n-  'use server'\n   try {\n     // Call database\n   } catch (error) {\n@@ -92,11 +94,12 @@ The `permanentRedirect` function allows you to **permanently** redirect the user\n `permanentRedirect` is often used after a mutation or event that changes an entity's canonical URL, such as updating a user's profile URL after they change their username:\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { permanentRedirect } from 'next/navigation'\n import { revalidateTag } from 'next/cache'\n \n export async function updateUsername(username: string, formData: FormData) {\n-  'use server'\n   try {\n     // Call database\n   } catch (error) {\n@@ -109,11 +112,12 @@ export async function updateUsername(username: string, formData: FormData) {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { permanentRedirect } from 'next/navigation'\n import { revalidateTag } from 'next/cache'\n \n export async function updateUsername(username, formData) {\n-  'use server'\n   try {\n     // Call database\n   } catch (error) {"
        },
        {
            "sha": "0d047ba817b2632954895217cccb8591ff374a53",
            "filename": "docs/01-app/03-building-your-application/02-data-fetching/03-server-actions-and-mutations.mdx",
            "status": "modified",
            "additions": 60,
            "deletions": 34,
            "changes": 94,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F02-data-fetching%2F03-server-actions-and-mutations.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F02-data-fetching%2F03-server-actions-and-mutations.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-building-your-application%2F02-data-fetching%2F03-server-actions-and-mutations.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -46,18 +46,18 @@ export default function Page() {\n \n ### Client Components\n \n-To call a Server Action in a Client Component, create a new file for the Server Action and import it in a Client Component:\n+To call a Server Action in a Client Component, create a new file and add the `\"use server\"` directive at the top of it. All exported functions within the file will be marked as Server Actions that can be reused in both Client and Server Components:\n \n ```tsx filename=\"app/actions.ts\" switcher\n-export async function create() {\n-  'use server'\n-}\n+'use server'\n+\n+export async function create() {}\n ```\n \n ```js filename=\"app/actions.js\" switcher\n-export async function create() {\n-  'use server'\n-}\n+'use server'\n+\n+export async function create() {}\n ```\n \n ```tsx filename=\"app/button.tsx\" switcher\n@@ -220,15 +220,15 @@ export function UserProfile({ userId }) {\n The Server Action will receive the `userId` argument, in addition to the form data:\n \n ```ts filename=\"app/actions.ts\" switcher\n-export async function updateUser(userId: string, formData: FormData) {\n-  'use server'\n-}\n+'use server'\n+\n+export async function updateUser(userId: string, formData: FormData) {}\n ```\n \n ```js filename=\"app/actions.js\" switcher\n-export async function updateUser(userId, formData) {\n-  'use server'\n-}\n+'use server'\n+\n+export async function updateUser(userId, formData) {}\n ```\n \n > **Good to know**:\n@@ -299,6 +299,8 @@ You can use the HTML attributes like `required` and `type=\"email\"` for basic cli\n For more advanced server-side validation, you can use a library like [zod](https://zod.dev/) to validate the form fields before mutating the data:\n \n ```tsx filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { z } from 'zod'\n \n const schema = z.object({\n@@ -308,8 +310,6 @@ const schema = z.object({\n })\n \n export default async function createUser(formData: FormData) {\n-  'use server'\n-\n   const validatedFields = schema.safeParse({\n     email: formData.get('email'),\n   })\n@@ -326,6 +326,8 @@ export default async function createUser(formData: FormData) {\n ```\n \n ```jsx filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { z } from 'zod'\n \n const schema = z.object({\n@@ -335,8 +337,6 @@ const schema = z.object({\n })\n \n export default async function createsUser(formData) {\n-  'use server'\n-\n   const validatedFields = schema.safeParse({\n     email: formData.get('email'),\n   })\n@@ -358,11 +358,11 @@ Once the fields have been validated on the server, you can return a serializable\n - `useActionState` is a React hook and therefore must be used in a Client Component.\n \n ```tsx filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n \n export async function createUser(prevState: any, formData: FormData) {\n-  'use server'\n-\n   const res = await fetch('https://...')\n   const json = await res.json()\n \n@@ -375,11 +375,11 @@ export async function createUser(prevState: any, formData: FormData) {\n ```\n \n ```jsx filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n \n export async function createUser(prevState, formData) {\n-  'use server'\n-\n   const res = await fetch('https://...')\n   const json = await res.json()\n \n@@ -726,10 +726,11 @@ When an error is thrown, it'll be caught by the nearest `error.js` or `<Suspense\n You can revalidate the [Next.js Cache](/docs/app/building-your-application/caching) inside your Server Actions with the [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath) API:\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { revalidatePath } from 'next/cache'\n \n export async function createPost() {\n-  'use server'\n   try {\n     // ...\n   } catch (error) {\n@@ -741,10 +742,11 @@ export async function createPost() {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { revalidatePath } from 'next/cache'\n \n export async function createPost() {\n-  'use server'\n   try {\n     // ...\n   } catch (error) {\n@@ -758,10 +760,11 @@ export async function createPost() {\n Or invalidate a specific data fetch with a cache tag using [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag):\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export async function createPost() {\n-  'use server'\n   try {\n     // ...\n   } catch (error) {\n@@ -773,10 +776,11 @@ export async function createPost() {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export async function createPost() {\n-  'use server'\n   try {\n     // ...\n   } catch (error) {\n@@ -792,11 +796,12 @@ export async function createPost() {\n If you would like to redirect the user to a different route after the completion of a Server Action, you can use [`redirect`](/docs/app/api-reference/functions/redirect) API. `redirect` needs to be called outside of the `try/catch` block:\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n import { revalidateTag } from 'next/cache'\n \n export async function createPost(id: string) {\n-  'use server'\n   try {\n     // ...\n   } catch (error) {\n@@ -809,11 +814,12 @@ export async function createPost(id: string) {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n import { revalidateTag } from 'next/cache'\n \n export async function createPost(id) {\n-  'use server'\n   try {\n     // ...\n   } catch (error) {\n@@ -830,22 +836,41 @@ export async function createPost(id) {\n You can `get`, `set`, and `delete` cookies inside a Server Action using the [`cookies`](/docs/app/api-reference/functions/cookies) API:\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { cookies } from 'next/headers'\n \n export async function exampleAction() {\n-  'use server'\n   const cookieStore = await cookies()\n-  // Implementation\n+\n+  // Get cookie\n+  cookieStore.get('name')?.value\n+\n+  // Set cookie\n+  cookieStore.set('name', 'Delba')\n+\n+  // Delete cookie\n+  cookieStore.delete('name')\n }\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { cookies } from 'next/headers'\n \n export async function exampleAction() {\n-  'use server'\n+  // Get cookie\n   const cookieStore = await cookies()\n-  // Implementation\n+\n+  // Get cookie\n+  cookieStore.get('name')?.value\n+\n+  // Set cookie\n+  cookieStore.set('name', 'Delba')\n+\n+  // Delete cookie\n+  cookieStore.delete('name')\n }\n ```\n \n@@ -854,7 +879,7 @@ See [additional examples](/docs/app/api-reference/functions/cookies#deleting-coo\n ## Security\n \n By default, when a Server Action is created and exported, it creates a public HTTP endpoint\n-and should be treated with the same security assumptions and authorization checks. This means, even if a Server Action or utility function is not imported elsewhere in your code, it's still publicly accessible.\n+and should be treated with the same security assumptions and authorization checks. This means, even if a Server Action or utility function is not imported elsewhere in your code, it’s still publicly accessible.\n \n To improve security, Next.js has the following built-in features:\n \n@@ -867,8 +892,8 @@ To improve security, Next.js has the following built-in features:\n > This security improvement reduces the risk in cases where an authentication layer is missing. However, you should still treat Server Actions like public HTTP endpoints.\n \n ```jsx\n-'use server'\n // app/actions.js\n+'use server'\n \n // This action **is** used in our application, so Next.js\n // will create a secure ID to allow the client to reference\n@@ -886,10 +911,11 @@ export async function deleteUserAction(formData) {}\n You should ensure that the user is authorized to perform the action. For example:\n \n ```tsx filename=\"app/actions.ts\"\n+'use server'\n+\n import { auth } from './lib'\n \n export function addItem() {\n-  'use server'\n   const { user } = auth()\n   if (!user) {\n     throw new Error('You must be signed in to perform this action')"
        },
        {
            "sha": "ed9d2ee4fc810eef645df211592b11bf4199ccbd",
            "filename": "docs/01-app/03-building-your-application/02-data-fetching/04-incremental-static-regeneration.mdx",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F02-data-fetching%2F04-incremental-static-regeneration.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F02-data-fetching%2F04-incremental-static-regeneration.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-building-your-application%2F02-data-fetching%2F04-incremental-static-regeneration.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -291,20 +291,22 @@ For a more precise method of revalidation, invalidate pages on-demand with the `\n For example, this Server Action would get called after adding a new post. Regardless of how you retrieve your data in your Server Component, either using `fetch` or connecting to a database, this will clear the cache for the entire route and allow the Server Component to fetch fresh data.\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { revalidatePath } from 'next/cache'\n \n export async function createPost() {\n-  'use server'\n   // Invalidate the /posts route in the cache\n   revalidatePath('/posts')\n }\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { revalidatePath } from 'next/cache'\n \n export async function createPost() {\n-  'use server'\n   // Invalidate the /posts route in the cache\n   revalidatePath('/posts')\n }\n@@ -377,20 +379,22 @@ export default async function Page() {\n You can then use `revalidateTag` in a [Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) or [Route Handler](/docs/app/building-your-application/routing/route-handlers):\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export async function createPost() {\n-  'use server'\n   // Invalidate all data tagged with 'posts' in the cache\n   revalidateTag('posts')\n }\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export async function createPost() {\n-  'use server'\n   // Invalidate all data tagged with 'posts' in the cache\n   revalidateTag('posts')\n }"
        },
        {
            "sha": "3028385030162f7290b210917c96978754155476",
            "filename": "docs/01-app/03-building-your-application/07-configuring/16-progressive-web-apps.mdx",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F07-configuring%2F16-progressive-web-apps.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F07-configuring%2F16-progressive-web-apps.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-building-your-application%2F07-configuring%2F16-progressive-web-apps.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -404,6 +404,8 @@ Now, let’s create the Server Actions which this file calls.\n Create a new file to contain your actions at `app/actions.ts`. This file will handle creating subscriptions, deleting subscriptions, and sending notifications.\n \n ```tsx filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import webpush from 'web-push'\n \n webpush.setVapidDetails(\n@@ -415,7 +417,6 @@ webpush.setVapidDetails(\n let subscription: PushSubscription | null = null\n \n export async function subscribeUser(sub: PushSubscription) {\n-  'use server'\n   subscription = sub\n   // In a production environment, you would want to store the subscription in a database\n   // For example: await db.subscriptions.create({ data: sub })\n@@ -452,6 +453,7 @@ export async function sendNotification(message: string) {\n ```\n \n ```jsx filename=\"app/actions.js\" switcher\n+'use server';\n \n import webpush from 'web-push';\n \n@@ -464,7 +466,6 @@ webpush.setVapidDetails(\n let subscription= null;\n \n export async function subscribeUser(sub) {\n-  'use server';\n   subscription = sub;\n   // In a production environment, you would want to store the subscription in a database\n   // For example: await db.subscriptions.create({ data: sub })"
        },
        {
            "sha": "0eae1e192c490c9523c358b59abd9c78147b8430",
            "filename": "docs/01-app/03-building-your-application/09-authentication/index.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F09-authentication%2Findex.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F09-authentication%2Findex.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-building-your-application%2F09-authentication%2Findex.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -1407,10 +1407,10 @@ Treat [Server Actions](/docs/app/building-your-application/data-fetching/server-\n In the example below, we check the user's role before allowing the action to proceed:\n \n ```ts filename=\"app/lib/actions.ts\" switcher\n+'use server'\n import { verifySession } from '@/app/lib/dal'\n \n export async function serverAction(formData: FormData) {\n-  'use server'\n   const session = await verifySession()\n   const userRole = session?.user?.role\n \n@@ -1424,10 +1424,10 @@ export async function serverAction(formData: FormData) {\n ```\n \n ```js filename=\"app/lib/actions.js\" switcher\n+'use server'\n import { verifySession } from '@/app/lib/dal'\n \n export async function serverAction() {\n-  'use server'\n   const session = await verifySession()\n   const userRole = session.user.role\n "
        },
        {
            "sha": "70fca2f64008545f2d7d67cbfa05d5a9b5606259",
            "filename": "docs/01-app/03-building-your-application/11-upgrading/08-single-page-applications.mdx",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F11-upgrading%2F08-single-page-applications.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F03-building-your-application%2F11-upgrading%2F08-single-page-applications.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-building-your-application%2F11-upgrading%2F08-single-page-applications.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -356,15 +356,15 @@ You can progressively adopt Server Actions while still using client components.\n For example, create your first Server Action:\n \n ```tsx filename=\"app/actions.ts\" switcher\n-export async function create() {\n-  'use server'\n-}\n+'use server'\n+\n+export async function create() {}\n ```\n \n ```js filename=\"app/actions.js\" switcher\n-export async function create() {\n-  'use server'\n-}\n+'use server'\n+\n+export async function create() {}\n ```\n \n You can import and use a Server Action from the client, similar to calling a JavaScript function. You do not need to create an API endpoint manually:"
        },
        {
            "sha": "88cea45eaeb428fce0a0b8db22d0ccb89874ca7d",
            "filename": "docs/01-app/04-api-reference/01-directives/use-server.mdx",
            "status": "modified",
            "additions": 8,
            "deletions": 6,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F01-directives%2Fuse-server.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F01-directives%2Fuse-server.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F04-api-reference%2F01-directives%2Fuse-server.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -10,20 +10,20 @@ The `use server` directive designates a function or file to be executed on the *\n The following example shows a file with a `use server` directive at the top. All functions in the file are executed on the server.\n \n ```tsx filename=\"app/actions.ts\" highlight={1} switcher\n+'use server'\n import { db } from '@/lib/db' // Your database client\n \n export async function createUser(data: { name: string; email: string }) {\n-  'use server'\n   const user = await db.user.create({ data })\n   return user\n }\n ```\n \n ```jsx filename=\"app/actions.js\" highlight={1} switcher\n+'use server'\n import { db } from '@/lib/db' // Your database client\n \n export async function createUser(data) {\n-  'use server'\n   const user = await db.user.create({ data })\n   return user\n }\n@@ -36,20 +36,20 @@ To use Server Functions in Client Components you need to create your Server Func\n Assuming you have a `fetchUsers` Server Function in `actions.ts`:\n \n ```tsx filename=\"app/actions.ts\" highlight={1} switcher\n+'use server'\n import { db } from '@/lib/db' // Your database client\n \n export async function fetchUsers() {\n-  'use server'\n   const users = await db.user.findMany()\n   return users\n }\n ```\n \n ```jsx filename=\"app/actions.js\" highlight={1} switcher\n+'use server'\n import { db } from '@/lib/db' // Your database client\n \n export async function fetchUsers() {\n-  'use server'\n   const users = await db.user.findMany()\n   return users\n }\n@@ -116,14 +116,15 @@ When using the `use server` directive, it's important to ensure that all server-\n Always authenticate and authorize users before performing sensitive server-side operations.\n \n ```tsx filename=\"app/actions.ts\" highlight={1,7,8,9,10} switcher\n+'use server'\n+\n import { db } from '@/lib/db' // Your database client\n import { authenticate } from '@/lib/auth' // Your authentication library\n \n export async function createUser(\n   data: { name: string; email: string },\n   token: string\n ) {\n-  'use server'\n   const user = authenticate(token)\n   if (!user) {\n     throw new Error('Unauthorized')\n@@ -134,11 +135,12 @@ export async function createUser(\n ```\n \n ```jsx filename=\"app/actions.js\" highlight={1,7,8,9,10} switcher\n+'use server'\n+\n import { db } from '@/lib/db' // Your database client\n import { authenticate } from '@/lib/auth' // Your authentication library\n \n export async function createUser(data, token) {\n-  'use server'\n   const user = authenticate(token)\n   if (!user) {\n     throw new Error('Unauthorized')"
        },
        {
            "sha": "644cc108b3fedaa0f469ed64795766f00dcfcf74",
            "filename": "docs/01-app/04-api-reference/02-components/form.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F02-components%2Fform.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F02-components%2Fform.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F04-api-reference%2F02-components%2Fform.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -338,10 +338,10 @@ After a mutation, it's common to redirect to the new resource. You can use the [\n > **Good to know**: Since the \"destination\" of the form submission is not known until the action is executed, `<Form>` cannot automatically prefetch shared UI.\n \n ```tsx filename=\"/app/posts/actions.ts\" switcher\n+'use server'\n import { redirect } from 'next/navigation'\n \n export async function createPost(formData: FormData) {\n-  'use server'\n   // Create a new post\n   // ...\n \n@@ -351,10 +351,10 @@ export async function createPost(formData: FormData) {\n ```\n \n ```jsx filename=\"/app/posts/actions.js\" switcher\n+'use server'\n import { redirect } from 'next/navigation'\n \n export async function createPost(formData) {\n-  'use server'\n   // Create a new post\n   // ...\n "
        },
        {
            "sha": "00c46b70d2f5389fe9d349c550a137b757e73513",
            "filename": "docs/01-app/04-api-reference/04-functions/cacheTag.mdx",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2FcacheTag.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2FcacheTag.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F04-api-reference%2F04-functions%2FcacheTag.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -67,20 +67,22 @@ export async function getData() {\n You can then purge the cache on-demand using [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) API in another function, for example, a [route handler](/docs/app/building-your-application/routing/route-handlers) or [Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations):\n \n ```tsx filename=\"app/action.ts\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export default async function submit() {\n-  'use server'\n   await addPost()\n   revalidateTag('my-data')\n }\n ```\n \n ```jsx filename=\"app/action.js\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export default async function submit() {\n-  'use server'\n   await addPost()\n   revalidateTag('my-data')\n }\n@@ -178,20 +180,22 @@ export async function Bookings({ type = 'haircut' }) {\n Using [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag), you can invalidate the cache for a specific tag when needed:\n \n ```tsx filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export async function updateBookings() {\n-  'use server'\n   await updateBookingData()\n   revalidateTag('bookings-data')\n }\n ```\n \n ```jsx filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export async function updateBookings() {\n-  'use server'\n   await updateBookingData()\n   revalidateTag('bookings-data')\n }"
        },
        {
            "sha": "6478bd6c304123956dc6cf493596c5bdfab7e70e",
            "filename": "docs/01-app/04-api-reference/04-functions/cookies.mdx",
            "status": "modified",
            "additions": 10,
            "deletions": 8,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2Fcookies.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2Fcookies.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F04-api-reference%2F04-functions%2Fcookies.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -146,10 +146,11 @@ export default async function Page() {\n You can use the `(await cookies()).set(name, value, options)` method in a [Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) or [Route Handler](/docs/app/building-your-application/routing/route-handlers) to set a cookie. The [`options` object](#options) is optional.\n \n ```tsx filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { cookies } from 'next/headers'\n \n export async function create(data) {\n-  'use server'\n   const cookieStore = await cookies()\n \n   cookieStore.set('name', 'lee')\n@@ -166,10 +167,11 @@ export async function create(data) {\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { cookies } from 'next/headers'\n \n export async function create(data) {\n-  'use server'\n   const cookieStore = await cookies()\n \n   cookieStore.set('name', 'lee')\n@@ -216,65 +218,65 @@ There are three ways you can delete a cookie.\n Using the `delete()` method:\n \n ```tsx filename=\"app/actions.ts\" switcher\n+'use server'\n \n import { cookies } from 'next/headers'\n \n export async function delete(data) {\n-  'use server'\n   (await cookies()).delete('name')\n }\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n \n import { cookies } from 'next/headers'\n \n export async function delete(data) {\n-  'use server'\n   (await cookies()).delete('name')\n }\n ```\n \n Setting a new cookie with the same name and an empty value:\n \n ```tsx filename=\"app/actions.ts\" switcher\n+'use server'\n \n import { cookies } from 'next/headers'\n \n export async function delete(data) {\n-  'use server'\n   (await cookies()).set('name', '')\n }\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n \n import { cookies } from 'next/headers'\n \n export async function delete(data) {\n-  'use server'\n   (await cookies()).set('name', '')\n }\n ```\n \n Setting the `maxAge` to 0 will immediately expire a cookie. `maxAge` accepts a value in seconds.\n \n ```tsx filename=\"app/actions.ts\" switcher\n+'use server'\n \n import { cookies } from 'next/headers'\n \n export async function delete(data) {\n-  'use server'\n   (await cookies()).set('name', 'value', { maxAge: 0 })\n }\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n \n import { cookies } from 'next/headers'\n \n export async function delete(data) {\n-  'use server'\n   (await cookies()).set('name', 'value', { maxAge: 0 })\n ``\n }"
        },
        {
            "sha": "97b9ac75bb5b2d625b157d3e0a433cced71a65be",
            "filename": "docs/01-app/04-api-reference/04-functions/forbidden.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2Fforbidden.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2Fforbidden.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F04-api-reference%2F04-functions%2Fforbidden.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -126,12 +126,13 @@ export default async function AdminPage() {\n When implementing mutations in Server Actions, you can use `forbidden` to only allow users with a specific role to update sensitive data.\n \n ```ts filename=\"app/actions/update-role.ts\" switcher\n+'use server'\n+\n import { verifySession } from '@/app/lib/dal'\n import { forbidden } from 'next/navigation'\n import db from '@/app/lib/db'\n \n export async function updateRole(formData: FormData) {\n-  'use server'\n   const session = await verifySession()\n \n   // Ensure only admins can update roles\n@@ -145,12 +146,13 @@ export async function updateRole(formData: FormData) {\n ```\n \n ```js filename=\"app/actions/update-role.js\" switcher\n+'use server'\n+\n import { verifySession } from '@/app/lib/dal'\n import { forbidden } from 'next/navigation'\n import db from '@/app/lib/db'\n \n export async function updateRole(formData) {\n-  'use server'\n   const session = await verifySession()\n \n   // Ensure only admins can update roles"
        },
        {
            "sha": "26d102bf9858a26a9db6f47916eed8379acc4db9",
            "filename": "docs/01-app/04-api-reference/04-functions/redirect.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2Fredirect.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2Fredirect.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F04-api-reference%2F04-functions%2Fredirect.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -163,19 +163,21 @@ export function ClientRedirect() {\n ```\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n \n export async function navigate(data: FormData) {\n-  'use server'\n   redirect(`/posts/${data.get('id')}`)\n }\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { redirect } from 'next/navigation'\n \n export async function navigate(data) {\n-  'use server'\n   redirect(`/posts/${data.get('id')}`)\n }\n ```"
        },
        {
            "sha": "a751493a5d0f164ca7235d0ec84be42b6064c5f8",
            "filename": "docs/01-app/04-api-reference/04-functions/revalidatePath.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2FrevalidatePath.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2FrevalidatePath.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F04-api-reference%2F04-functions%2FrevalidatePath.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -70,10 +70,11 @@ This will purge the Client-side Router Cache, and revalidate the Data Cache on t\n ### Server Action\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { revalidatePath } from 'next/cache'\n \n export default async function submit() {\n-  'use server'\n   await submitForm()\n   revalidatePath('/')\n }"
        },
        {
            "sha": "04f8cf375020dc1aa5dbaba70f56d9012880d040",
            "filename": "docs/01-app/04-api-reference/04-functions/revalidateTag.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2FrevalidateTag.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2FrevalidateTag.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F04-api-reference%2F04-functions%2FrevalidateTag.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -32,20 +32,22 @@ fetch(url, { next: { tags: [...] } });\n ### Server Action\n \n ```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export default async function submit() {\n-  'use server'\n   await addPost()\n   revalidateTag('posts')\n }\n ```\n \n ```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n import { revalidateTag } from 'next/cache'\n \n export default async function submit() {\n-  'use server'\n   await addPost()\n   revalidateTag('posts')\n }"
        },
        {
            "sha": "95334854d8efebcb298916cd08a9ff3e223479b8",
            "filename": "docs/01-app/04-api-reference/04-functions/unauthorized.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2Funauthorized.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/251d1fec82b652aa0d354cb906ec8fc4cfac6308/docs%2F01-app%2F04-api-reference%2F04-functions%2Funauthorized.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F04-api-reference%2F04-functions%2Funauthorized.mdx?ref=251d1fec82b652aa0d354cb906ec8fc4cfac6308",
            "patch": "@@ -148,12 +148,13 @@ export default function UnauthorizedPage() {\n You can invoke `unauthorized` in Server Actions to ensure only authenticated users can perform specific mutations.\n \n ```ts filename=\"app/actions/update-profile.ts\" switcher\n+'use server'\n+\n import { verifySession } from '@/app/lib/dal'\n import { unauthorized } from 'next/navigation'\n import db from '@/app/lib/db'\n \n export async function updateProfile(data: FormData) {\n-  'use server'\n   const session = await verifySession()\n \n   // If the user is not authenticated, return a 401\n@@ -167,12 +168,13 @@ export async function updateProfile(data: FormData) {\n ```\n \n ```js filename=\"app/actions/update-profile.js\" switcher\n+'use server'\n+\n import { verifySession } from '@/app/lib/dal'\n import { unauthorized } from 'next/navigation'\n import db from '@/app/lib/db'\n \n export async function updateProfile(data) {\n-  'use server'\n   const session = await verifySession()\n \n   // If the user is not authenticated, return a 401"
        }
    ],
    "stats": {
        "total": 286,
        "additions": 169,
        "deletions": 117
    }
}