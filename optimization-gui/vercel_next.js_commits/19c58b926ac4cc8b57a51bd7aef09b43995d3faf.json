{
    "author": "wbinnssmith",
    "message": "Turbopack: don’t warn about webpack being configured when `experimental.turbo` is set (#77998)\n\nThis is a regression introduced in 15.3.0 by #77850, when\n`config.experimental.turbo` was moved to `config.turbopack`. We still\nsupport `config.experimental.turbo` as well, so don’t warn when that is\nused.\n\nTest Plan: Added tests for this warning message and each of the\nunset/turbopack/experimental.turbo cases",
    "sha": "19c58b926ac4cc8b57a51bd7aef09b43995d3faf",
    "files": [
        {
            "sha": "3cf52c33e6985c7ab86d6a568901bc6cd7cff45c",
            "filename": "packages/next/src/lib/turbopack-warning.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/19c58b926ac4cc8b57a51bd7aef09b43995d3faf/packages%2Fnext%2Fsrc%2Flib%2Fturbopack-warning.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/19c58b926ac4cc8b57a51bd7aef09b43995d3faf/packages%2Fnext%2Fsrc%2Flib%2Fturbopack-warning.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fturbopack-warning.ts?ref=19c58b926ac4cc8b57a51bd7aef09b43995d3faf",
            "patch": "@@ -144,7 +144,7 @@ export async function validateTurboNextConfig({\n       if (key.startsWith('webpack') && rawNextConfig.webpack) {\n         hasWebpackConfig = true\n       }\n-      if (key.startsWith('turbopack')) {\n+      if (key.startsWith('turbopack') || key.startsWith('experimental.turbo')) {\n         hasTurboConfig = true\n       }\n \n@@ -180,7 +180,7 @@ export async function validateTurboNextConfig({\n       `Webpack is configured while Turbopack is not, which may cause problems.`\n     )\n     Log.warn(\n-      `See instructions if you need to configure Turbopack:\\n  https://nextjs.org/docs/app/api-reference/next-config-js/turbo\\n`\n+      `See instructions if you need to configure Turbopack:\\n  https://nextjs.org/docs/app/api-reference/next-config-js/turbopack\\n`\n     )\n   }\n "
        },
        {
            "sha": "36dacfd63a972f134cef42f2fa82548fb93a3fae",
            "filename": "test/e2e/config-turbopack/index.test.ts",
            "status": "added",
            "additions": 96,
            "deletions": 0,
            "changes": 96,
            "blob_url": "https://github.com/vercel/next.js/blob/19c58b926ac4cc8b57a51bd7aef09b43995d3faf/test%2Fe2e%2Fconfig-turbopack%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/19c58b926ac4cc8b57a51bd7aef09b43995d3faf/test%2Fe2e%2Fconfig-turbopack%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fconfig-turbopack%2Findex.test.ts?ref=19c58b926ac4cc8b57a51bd7aef09b43995d3faf",
            "patch": "@@ -0,0 +1,96 @@\n+/* eslint-disable jest/no-standalone-expect */\n+import { nextTestSetup } from 'e2e-utils'\n+\n+const WARNING_MESSAGE = 'Webpack is configured while Turbopack is not'\n+\n+const itif = (condition: boolean) => (condition ? it : it.skip)\n+\n+describe('config-turbopack', () => {\n+  describe('when webpack is configured but Turbopack is not', () => {\n+    const { next, isTurbopack } = nextTestSetup({\n+      files: {\n+        'app/page.js': `\n+          export default function Page() {\n+            return <p>hello world</p>\n+          }\n+        `,\n+        'next.config.js': `\n+          module.exports = {\n+            webpack: (config) => {\n+              return config\n+            },\n+          }\n+        `,\n+      },\n+    })\n+\n+    itif(isTurbopack)('warns', async () => {\n+      if (next) await next.render('/')\n+      expect(next.cliOutput).toContain(WARNING_MESSAGE)\n+    })\n+  })\n+\n+  describe('when webpack is configured and config.turbopack is set', () => {\n+    const { next, isTurbopack } = nextTestSetup({\n+      files: {\n+        'app/page.js': `\n+          export default function Page() {\n+            return <p>hello world</p>\n+          }\n+        `,\n+        'next.config.js': `\n+          module.exports = {\n+            turbopack: {\n+              rules: {\n+                '*.foo': {\n+                  loaders: ['foo-loader']\n+                }\n+              }\n+            },\n+            webpack: (config) => {\n+              return config\n+            },\n+          }\n+        `,\n+      },\n+    })\n+\n+    itif(isTurbopack)('does not warn', async () => {\n+      if (next) await next.render('/')\n+      expect(next.cliOutput).not.toContain(WARNING_MESSAGE)\n+    })\n+  })\n+\n+  describe('when webpack is configured and config.experimental.turbo is set', () => {\n+    const { next, isTurbopack } = nextTestSetup({\n+      files: {\n+        'app/page.js': `\n+          export default function Page() {\n+            return <p>hello world</p>\n+          }\n+        `,\n+        'next.config.js': `\n+          module.exports = {\n+            experimental: {\n+              turbo: {\n+                rules: {\n+                  '*.foo': {\n+                    loaders: ['foo-loader']\n+                  }\n+                }\n+              }\n+            },\n+            webpack: (config) => {\n+              return config\n+            },\n+          }\n+        `,\n+      },\n+    })\n+\n+    itif(isTurbopack)('does not warn', async () => {\n+      if (next) await next.render('/')\n+      expect(next.cliOutput).not.toContain(WARNING_MESSAGE)\n+    })\n+  })\n+})"
        }
    ],
    "stats": {
        "total": 100,
        "additions": 98,
        "deletions": 2
    }
}