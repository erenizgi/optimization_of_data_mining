{
    "author": "devjiwonchoi",
    "message": "[devtools] fork next-logo (#80457)\n\nFollowing up on https://github.com/vercel/next.js/pull/80456, fork the\nnext-logo as well as it is coupled with the indicator.\n\nLooking at the current\n[next-logo.tsx](https://github.com/vercel/next.js/blob/1d2c31d5907fb5d9c4ed0bfbf73b2430f27c48a7/packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/next-logo.tsx)\nfile, it contains multiple hooks and icons, so ported those to separate\nfiles as well.",
    "sha": "3e27abf43350cfcb10ba6839e7749dd80a628139",
    "files": [
        {
            "sha": "0aa668704aead4d1e21d658cefaefa71a4f5f846",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/devtools-indicator.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx?ref=3e27abf43350cfcb10ba6839e7749dd80a628139",
            "patch": "@@ -2,9 +2,9 @@ import type { CSSProperties } from 'react'\n import type { OverlayState, OverlayDispatch } from '../../shared'\n import type { DevToolsScale } from '../errors/dev-tools-indicator/dev-tools-info/preferences'\n \n-import { useState, useRef } from 'react'\n+import { useState } from 'react'\n+import { NextLogo } from './next-logo'\n import { Toast } from '../toast'\n-import { NextLogo } from '../errors/dev-tools-indicator/next-logo'\n import {\n   MENU_CURVE,\n   MENU_DURATION_MS,\n@@ -31,8 +31,6 @@ export function DevToolsIndicator({\n   const [open, setOpen] = useState(false)\n   const [position, setPosition] = useState(getInitialPosition())\n \n-  const triggerRef = useRef<HTMLButtonElement | null>(null)\n-\n   const [vertical, horizontal] = position.split('-', 2)\n \n   const toggleErrorOverlay = () => {\n@@ -66,7 +64,6 @@ export function DevToolsIndicator({\n       >\n         {/* Trigger */}\n         <NextLogo\n-          ref={triggerRef}\n           aria-haspopup=\"menu\"\n           aria-expanded={open}\n           aria-controls=\"nextjs-dev-tools-menu\""
        },
        {
            "sha": "d562d310ea4a1f676cb881090b21f0127415193e",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/hooks/use-measure-width.ts",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fhooks%2Fuse-measure-width.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fhooks%2Fuse-measure-width.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fhooks%2Fuse-measure-width.ts?ref=3e27abf43350cfcb10ba6839e7749dd80a628139",
            "patch": "@@ -0,0 +1,24 @@\n+import { useEffect, useState } from 'react'\n+\n+export function useMeasureWidth(\n+  ref: React.RefObject<HTMLDivElement | null>\n+): number {\n+  const [width, setWidth] = useState<number>(0)\n+\n+  useEffect(() => {\n+    const el = ref.current\n+\n+    if (!el) {\n+      return\n+    }\n+\n+    const observer = new ResizeObserver(([{ contentRect }]) => {\n+      setWidth(contentRect.width)\n+    })\n+\n+    observer.observe(el)\n+    return () => observer.disconnect()\n+  }, [ref])\n+\n+  return width\n+}"
        },
        {
            "sha": "2ce22435db432279e75b6da341c4aa11c4418d15",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/hooks/use-minimum-loading-time-multiple.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fhooks%2Fuse-minimum-loading-time-multiple.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fhooks%2Fuse-minimum-loading-time-multiple.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fhooks%2Fuse-minimum-loading-time-multiple.ts?ref=3e27abf43350cfcb10ba6839e7749dd80a628139",
            "previous_filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/use-minimum-loading-time-multiple.tsx"
        },
        {
            "sha": "92a30fecba042eb14f522e259cfb8dec1f8fb5d9",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/hooks/use-update-animation.ts",
            "status": "added",
            "additions": 37,
            "deletions": 0,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fhooks%2Fuse-update-animation.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fhooks%2Fuse-update-animation.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fhooks%2Fuse-update-animation.ts?ref=3e27abf43350cfcb10ba6839e7749dd80a628139",
            "patch": "@@ -0,0 +1,37 @@\n+import { useEffect, useRef, useState } from 'react'\n+\n+export function useUpdateAnimation(\n+  issueCount: number,\n+  animationDurationMs = 0\n+) {\n+  const lastUpdatedTimeStamp = useRef<number | null>(null)\n+  const [animate, setAnimate] = useState(false)\n+\n+  useEffect(() => {\n+    if (issueCount > 0) {\n+      const deltaMs = lastUpdatedTimeStamp.current\n+        ? Date.now() - lastUpdatedTimeStamp.current\n+        : -1\n+      lastUpdatedTimeStamp.current = Date.now()\n+\n+      // We don't animate if `issueCount` changes too quickly\n+      if (deltaMs <= animationDurationMs) {\n+        return\n+      }\n+\n+      setAnimate(true)\n+      // It is important to use a CSS transitioned state, not a CSS keyframed animation\n+      // because if the issue count increases faster than the animation duration, it\n+      // will abruptly stop and not transition smoothly back to its original state.\n+      const timeoutId = window.setTimeout(() => {\n+        setAnimate(false)\n+      }, animationDurationMs)\n+\n+      return () => {\n+        clearTimeout(timeoutId)\n+      }\n+    }\n+  }, [issueCount, animationDurationMs])\n+\n+  return animate\n+}"
        },
        {
            "sha": "baf0920e8a8fe1a4f253cb49e1447bdb3779ad88",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/next-logo.stories.tsx",
            "status": "added",
            "additions": 82,
            "deletions": 0,
            "changes": 82,
            "blob_url": "https://github.com/vercel/next.js/blob/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.stories.tsx?ref=3e27abf43350cfcb10ba6839e7749dd80a628139",
            "patch": "@@ -0,0 +1,82 @@\n+import type { Meta, StoryObj } from '@storybook/react'\n+import { NextLogo } from './next-logo'\n+import { withShadowPortal } from '../../storybook/with-shadow-portal'\n+\n+const meta: Meta<typeof NextLogo> = {\n+  component: NextLogo,\n+  parameters: {\n+    layout: 'centered',\n+  },\n+  args: {\n+    'aria-label': 'Open Next.js DevTools',\n+    onClick: () => console.log('Clicked!'),\n+  },\n+  decorators: [withShadowPortal],\n+}\n+\n+export default meta\n+type Story = StoryObj<typeof NextLogo>\n+\n+export const NoIssues: Story = {\n+  args: {\n+    issueCount: 0,\n+    isDevBuilding: false,\n+    isDevRendering: false,\n+  },\n+}\n+\n+export const SingleIssue: Story = {\n+  args: {\n+    issueCount: 1,\n+    isDevBuilding: false,\n+    isDevRendering: false,\n+  },\n+}\n+\n+export const MultipleIssues: Story = {\n+  args: {\n+    issueCount: 5,\n+    isDevBuilding: false,\n+    isDevRendering: false,\n+  },\n+}\n+\n+export const ManyIssues: Story = {\n+  args: {\n+    issueCount: 99,\n+    isDevBuilding: false,\n+    isDevRendering: false,\n+  },\n+}\n+\n+export const Building: Story = {\n+  args: {\n+    issueCount: 0,\n+    isDevBuilding: true,\n+    isDevRendering: false,\n+  },\n+}\n+\n+export const BuildingWithError: Story = {\n+  args: {\n+    issueCount: 1,\n+    isDevBuilding: true,\n+    isDevRendering: false,\n+  },\n+}\n+\n+export const Rendering: Story = {\n+  args: {\n+    issueCount: 0,\n+    isDevBuilding: false,\n+    isDevRendering: true,\n+  },\n+}\n+\n+export const RenderingWithError: Story = {\n+  args: {\n+    issueCount: 1,\n+    isDevBuilding: false,\n+    isDevRendering: true,\n+  },\n+}"
        },
        {
            "sha": "a575bbbd1b1aa1c646f0dec6eda39acfb2dc7e39",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/next-logo.tsx",
            "status": "added",
            "additions": 558,
            "deletions": 0,
            "changes": 558,
            "blob_url": "https://github.com/vercel/next.js/blob/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.tsx?ref=3e27abf43350cfcb10ba6839e7749dd80a628139",
            "patch": "@@ -0,0 +1,558 @@\n+import type { DevToolsScale } from '../errors/dev-tools-indicator/dev-tools-info/preferences'\n+\n+import { useEffect, useRef, useState } from 'react'\n+import { useUpdateAnimation } from './hooks/use-update-animation'\n+import { useMeasureWidth } from './hooks/use-measure-width'\n+import { useMinimumLoadingTimeMultiple } from './hooks/use-minimum-loading-time-multiple'\n+import { Cross } from '../../icons/cross'\n+import { Warning } from '../../icons/warning'\n+import { css } from '../../utils/css'\n+\n+interface Props extends React.ComponentProps<'button'> {\n+  issueCount: number\n+  isDevBuilding: boolean\n+  isDevRendering: boolean\n+  isBuildError: boolean\n+  onTriggerClick: () => void\n+  toggleErrorOverlay: () => void\n+  scale: DevToolsScale\n+}\n+\n+const SHORT_DURATION_MS = 150\n+\n+export function NextLogo({\n+  disabled,\n+  issueCount,\n+  isDevBuilding,\n+  isDevRendering,\n+  isBuildError,\n+  onTriggerClick,\n+  toggleErrorOverlay,\n+  scale = 1,\n+  ...props\n+}: Props) {\n+  const SIZE = 36 / scale\n+\n+  const hasError = issueCount > 0\n+  const [isErrorExpanded, setIsErrorExpanded] = useState(hasError)\n+  const [dismissed, setDismissed] = useState(false)\n+  const newErrorDetected = useUpdateAnimation(issueCount, SHORT_DURATION_MS)\n+\n+  const triggerRef = useRef<HTMLButtonElement | null>(null)\n+  const ref = useRef<HTMLDivElement | null>(null)\n+  const measuredWidth = useMeasureWidth(ref)\n+\n+  const isLoading = useMinimumLoadingTimeMultiple(\n+    isDevBuilding || isDevRendering\n+  )\n+  const isExpanded = isErrorExpanded || disabled\n+  const width = measuredWidth === 0 ? 'auto' : measuredWidth\n+\n+  useEffect(() => {\n+    setIsErrorExpanded(hasError)\n+  }, [hasError])\n+\n+  return (\n+    <div\n+      data-next-badge-root\n+      style={\n+        {\n+          '--size': `${SIZE}px`,\n+          '--duration-short': `${SHORT_DURATION_MS}ms`,\n+          // if the indicator is disabled, hide the badge\n+          // also allow the \"disabled\" state be dismissed, as long as there are no build errors\n+          display: disabled && (!hasError || dismissed) ? 'none' : 'block',\n+        } as React.CSSProperties\n+      }\n+    >\n+      {/* Styles */}\n+      <style>\n+        {css`\n+          [data-next-badge-root] {\n+            --timing: cubic-bezier(0.23, 0.88, 0.26, 0.92);\n+            --duration-long: 250ms;\n+            --color-outer-border: #171717;\n+            --color-inner-border: hsla(0, 0%, 100%, 0.14);\n+            --color-hover-alpha-subtle: hsla(0, 0%, 100%, 0.13);\n+            --color-hover-alpha-error: hsla(0, 0%, 100%, 0.2);\n+            --color-hover-alpha-error-2: hsla(0, 0%, 100%, 0.25);\n+            --mark-size: calc(var(--size) - var(--size-2) * 2);\n+\n+            --focus-color: var(--color-blue-800);\n+            --focus-ring: 2px solid var(--focus-color);\n+\n+            &:has([data-next-badge][data-error='true']) {\n+              --focus-color: #fff;\n+            }\n+          }\n+\n+          [data-disabled-icon] {\n+            display: flex;\n+            align-items: center;\n+            justify-content: center;\n+            padding-right: 4px;\n+          }\n+\n+          [data-next-badge] {\n+            -webkit-font-smoothing: antialiased;\n+            width: var(--size);\n+            height: var(--size);\n+            display: flex;\n+            align-items: center;\n+            position: relative;\n+            background: rgba(0, 0, 0, 0.8);\n+            box-shadow:\n+              0 0 0 1px var(--color-outer-border),\n+              inset 0 0 0 1px var(--color-inner-border),\n+              0px 16px 32px -8px rgba(0, 0, 0, 0.24);\n+            backdrop-filter: blur(48px);\n+            border-radius: var(--rounded-full);\n+            user-select: none;\n+            cursor: pointer;\n+            scale: 1;\n+            overflow: hidden;\n+            will-change: scale, box-shadow, width, background;\n+            transition:\n+              scale var(--duration-short) var(--timing),\n+              width var(--duration-long) var(--timing),\n+              box-shadow var(--duration-long) var(--timing),\n+              background var(--duration-short) ease;\n+\n+            &:active[data-error='false'] {\n+              scale: 0.95;\n+            }\n+\n+            &[data-animate='true']:not(:hover) {\n+              scale: 1.02;\n+            }\n+\n+            &[data-error='false']:has([data-next-mark]:focus-visible) {\n+              outline: var(--focus-ring);\n+              outline-offset: 3px;\n+            }\n+\n+            &[data-error='true'] {\n+              background: #ca2a30;\n+              --color-inner-border: #e5484d;\n+\n+              [data-next-mark] {\n+                background: var(--color-hover-alpha-error);\n+                outline-offset: 0px;\n+\n+                &:focus-visible {\n+                  outline: var(--focus-ring);\n+                  outline-offset: -1px;\n+                }\n+\n+                &:hover {\n+                  background: var(--color-hover-alpha-error-2);\n+                }\n+              }\n+            }\n+\n+            &[data-error-expanded='false'][data-error='true'] ~ [data-dot] {\n+              scale: 1;\n+            }\n+\n+            > div {\n+              display: flex;\n+            }\n+          }\n+\n+          [data-issues-collapse]:focus-visible {\n+            outline: var(--focus-ring);\n+          }\n+\n+          [data-issues]:has([data-issues-open]:focus-visible) {\n+            outline: var(--focus-ring);\n+            outline-offset: -1px;\n+          }\n+\n+          [data-dot] {\n+            content: '';\n+            width: var(--size-8);\n+            height: var(--size-8);\n+            background: #fff;\n+            box-shadow: 0 0 0 1px var(--color-outer-border);\n+            border-radius: 50%;\n+            position: absolute;\n+            top: 2px;\n+            right: 0px;\n+            scale: 0;\n+            pointer-events: none;\n+            transition: scale 200ms var(--timing);\n+            transition-delay: var(--duration-short);\n+          }\n+\n+          [data-issues] {\n+            --padding-left: 8px;\n+            display: flex;\n+            gap: 2px;\n+            align-items: center;\n+            padding-left: 8px;\n+            padding-right: 8px;\n+            height: var(--size-32);\n+            margin-right: 2px;\n+            border-radius: var(--rounded-full);\n+            transition: background var(--duration-short) ease;\n+\n+            &:has([data-issues-open]:hover) {\n+              background: var(--color-hover-alpha-error);\n+            }\n+\n+            &:has([data-issues-collapse]) {\n+              padding-right: calc(var(--padding-left) / 2);\n+            }\n+\n+            [data-cross] {\n+              translate: 0px -1px;\n+            }\n+          }\n+\n+          [data-issues-open] {\n+            font-size: var(--size-13);\n+            color: white;\n+            width: fit-content;\n+            height: 100%;\n+            display: flex;\n+            gap: 2px;\n+            align-items: center;\n+            margin: 0;\n+            line-height: var(--size-36);\n+            font-weight: 500;\n+            z-index: 2;\n+            white-space: nowrap;\n+\n+            &:focus-visible {\n+              outline: 0;\n+            }\n+          }\n+\n+          [data-issues-collapse] {\n+            width: var(--size-24);\n+            height: var(--size-24);\n+            border-radius: var(--rounded-full);\n+            transition: background var(--duration-short) ease;\n+\n+            &:hover {\n+              background: var(--color-hover-alpha-error);\n+            }\n+          }\n+\n+          [data-cross] {\n+            color: #fff;\n+            width: var(--size-12);\n+            height: var(--size-12);\n+          }\n+\n+          [data-next-mark] {\n+            width: var(--mark-size);\n+            height: var(--mark-size);\n+            margin: 0 2px;\n+            display: flex;\n+            align-items: center;\n+            border-radius: var(--rounded-full);\n+            transition: background var(--duration-long) var(--timing);\n+\n+            &:focus-visible {\n+              outline: 0;\n+            }\n+\n+            &:hover {\n+              background: var(--color-hover-alpha-subtle);\n+            }\n+\n+            svg {\n+              flex-shrink: 0;\n+              width: var(--size-40);\n+              height: var(--size-40);\n+            }\n+          }\n+\n+          [data-issues-count-animation] {\n+            display: grid;\n+            place-items: center center;\n+            font-variant-numeric: tabular-nums;\n+\n+            &[data-animate='false'] {\n+              [data-issues-count-exit],\n+              [data-issues-count-enter] {\n+                animation-duration: 0ms;\n+              }\n+            }\n+\n+            > * {\n+              grid-area: 1 / 1;\n+            }\n+\n+            [data-issues-count-exit] {\n+              animation: fadeOut 300ms var(--timing) forwards;\n+            }\n+\n+            [data-issues-count-enter] {\n+              animation: fadeIn 300ms var(--timing) forwards;\n+            }\n+          }\n+\n+          [data-issues-count-plural] {\n+            display: inline-block;\n+            &[data-animate='true'] {\n+              animation: fadeIn 300ms var(--timing) forwards;\n+            }\n+          }\n+\n+          .path0 {\n+            animation: draw0 1.5s ease-in-out infinite;\n+          }\n+\n+          .path1 {\n+            animation: draw1 1.5s ease-out infinite;\n+            animation-delay: 0.3s;\n+          }\n+\n+          .paused {\n+            stroke-dashoffset: 0;\n+          }\n+\n+          @keyframes fadeIn {\n+            0% {\n+              opacity: 0;\n+              filter: blur(2px);\n+              transform: translateY(8px);\n+            }\n+            100% {\n+              opacity: 1;\n+              filter: blur(0px);\n+              transform: translateY(0);\n+            }\n+          }\n+\n+          @keyframes fadeOut {\n+            0% {\n+              opacity: 1;\n+              filter: blur(0px);\n+              transform: translateY(0);\n+            }\n+            100% {\n+              opacity: 0;\n+              transform: translateY(-12px);\n+              filter: blur(2px);\n+            }\n+          }\n+\n+          @keyframes draw0 {\n+            0%,\n+            25% {\n+              stroke-dashoffset: -29.6;\n+            }\n+            25%,\n+            50% {\n+              stroke-dashoffset: 0;\n+            }\n+            50%,\n+            75% {\n+              stroke-dashoffset: 0;\n+            }\n+            75%,\n+            100% {\n+              stroke-dashoffset: 29.6;\n+            }\n+          }\n+\n+          @keyframes draw1 {\n+            0%,\n+            20% {\n+              stroke-dashoffset: -11.6;\n+            }\n+            20%,\n+            50% {\n+              stroke-dashoffset: 0;\n+            }\n+            50%,\n+            75% {\n+              stroke-dashoffset: 0;\n+            }\n+            75%,\n+            100% {\n+              stroke-dashoffset: 11.6;\n+            }\n+          }\n+\n+          @media (prefers-reduced-motion) {\n+            [data-issues-count-exit],\n+            [data-issues-count-enter],\n+            [data-issues-count-plural] {\n+              animation-duration: 0ms !important;\n+            }\n+          }\n+        `}\n+      </style>\n+      <div\n+        data-next-badge\n+        data-error={hasError}\n+        data-error-expanded={isExpanded}\n+        data-animate={newErrorDetected}\n+        style={{ width }}\n+      >\n+        <div ref={ref}>\n+          {/* Children */}\n+          {!disabled && (\n+            <button\n+              ref={triggerRef}\n+              data-next-mark\n+              data-next-mark-loading={isLoading}\n+              onClick={onTriggerClick}\n+              {...props}\n+            >\n+              <NextMark isLoading={isLoading} isDevBuilding={isDevBuilding} />\n+            </button>\n+          )}\n+          {isExpanded && (\n+            <div data-issues>\n+              <button\n+                data-issues-open\n+                aria-label=\"Open issues overlay\"\n+                onClick={toggleErrorOverlay}\n+              >\n+                {disabled && (\n+                  <div data-disabled-icon>\n+                    <Warning />\n+                  </div>\n+                )}\n+                <AnimateCount\n+                  // Used the key to force a re-render when the count changes.\n+                  key={issueCount}\n+                  animate={newErrorDetected}\n+                  data-issues-count-animation\n+                >\n+                  {issueCount}\n+                </AnimateCount>{' '}\n+                <div>\n+                  Issue\n+                  {issueCount > 1 && (\n+                    <span\n+                      aria-hidden\n+                      data-issues-count-plural\n+                      // This only needs to animate once the count changes from 1 -> 2,\n+                      // otherwise it should stay static between re-renders.\n+                      data-animate={newErrorDetected && issueCount === 2}\n+                    >\n+                      s\n+                    </span>\n+                  )}\n+                </div>\n+              </button>\n+              {!isBuildError && (\n+                <button\n+                  data-issues-collapse\n+                  aria-label=\"Collapse issues badge\"\n+                  onClick={() => {\n+                    if (disabled) {\n+                      setDismissed(true)\n+                    } else {\n+                      setIsErrorExpanded(false)\n+                    }\n+                    // Move focus to the trigger to prevent having it stuck on this element\n+                    triggerRef.current?.focus()\n+                  }}\n+                >\n+                  <Cross data-cross />\n+                </button>\n+              )}\n+            </div>\n+          )}\n+        </div>\n+      </div>\n+      <div aria-hidden data-dot />\n+    </div>\n+  )\n+}\n+\n+function AnimateCount({\n+  children: count,\n+  animate = true,\n+  ...props\n+}: {\n+  children: number\n+  animate: boolean\n+}) {\n+  return (\n+    <div {...props} data-animate={animate}>\n+      <div aria-hidden data-issues-count-exit>\n+        {count - 1}\n+      </div>\n+      <div data-issues-count data-issues-count-enter>\n+        {count}\n+      </div>\n+    </div>\n+  )\n+}\n+\n+function NextMark({\n+  isLoading,\n+  isDevBuilding,\n+}: {\n+  isLoading?: boolean\n+  isDevBuilding?: boolean\n+}) {\n+  const strokeColor = isDevBuilding ? 'rgba(255,255,255,0.7)' : 'white'\n+  return (\n+    <svg\n+      width=\"40\"\n+      height=\"40\"\n+      viewBox=\"0 0 40 40\"\n+      fill=\"none\"\n+      data-next-mark-loading={isLoading}\n+    >\n+      <g transform=\"translate(8.5, 13)\">\n+        <path\n+          className={isLoading ? 'path0' : 'paused'}\n+          d=\"M13.3 15.2 L2.34 1 V12.6\"\n+          fill=\"none\"\n+          stroke=\"url(#next_logo_paint0_linear_1357_10853)\"\n+          strokeWidth=\"1.86\"\n+          mask=\"url(#next_logo_mask0)\"\n+          strokeDasharray=\"29.6\"\n+          strokeDashoffset=\"29.6\"\n+        />\n+        <path\n+          className={isLoading ? 'path1' : 'paused'}\n+          d=\"M11.825 1.5 V13.1\"\n+          strokeWidth=\"1.86\"\n+          stroke=\"url(#next_logo_paint1_linear_1357_10853)\"\n+          strokeDasharray=\"11.6\"\n+          strokeDashoffset=\"11.6\"\n+        />\n+      </g>\n+      <defs>\n+        <linearGradient\n+          id=\"next_logo_paint0_linear_1357_10853\"\n+          x1=\"9.95555\"\n+          y1=\"11.1226\"\n+          x2=\"15.4778\"\n+          y2=\"17.9671\"\n+          gradientUnits=\"userSpaceOnUse\"\n+        >\n+          <stop stopColor={strokeColor} />\n+          <stop offset=\"0.604072\" stopColor={strokeColor} stopOpacity=\"0\" />\n+          <stop offset=\"1\" stopColor={strokeColor} stopOpacity=\"0\" />\n+        </linearGradient>\n+        <linearGradient\n+          id=\"next_logo_paint1_linear_1357_10853\"\n+          x1=\"11.8222\"\n+          y1=\"1.40039\"\n+          x2=\"11.791\"\n+          y2=\"9.62542\"\n+          gradientUnits=\"userSpaceOnUse\"\n+        >\n+          <stop stopColor={strokeColor} />\n+          <stop offset=\"1\" stopColor={strokeColor} stopOpacity=\"0\" />\n+        </linearGradient>\n+        <mask id=\"next_logo_mask0\">\n+          <rect width=\"100%\" height=\"100%\" fill=\"white\" />\n+          <rect width=\"5\" height=\"1.5\" fill=\"black\" />\n+        </mask>\n+      </defs>\n+    </svg>\n+  )\n+}"
        },
        {
            "sha": "6f59f4c7a1cfb1fbe3e57180ba52afa4da1be3c0",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/next-logo.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 55,
            "changes": 58,
            "blob_url": "https://github.com/vercel/next.js/blob/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.tsx?ref=3e27abf43350cfcb10ba6839e7749dd80a628139",
            "patch": "@@ -1,8 +1,10 @@\n import { forwardRef, useEffect, useRef, useState } from 'react'\n import { css } from '../../../utils/css'\n import mergeRefs from '../../../utils/merge-refs'\n-import { useMinimumLoadingTimeMultiple } from './use-minimum-loading-time-multiple'\n import type { DevToolsScale } from './dev-tools-info/preferences'\n+import { useMinimumLoadingTimeMultiple } from '../../devtools-indicator/hooks/use-minimum-loading-time-multiple'\n+import { useUpdateAnimation } from '../../devtools-indicator/hooks/use-update-animation'\n+import { useMeasureWidth } from '../../devtools-indicator/hooks/use-measure-width'\n \n interface Props extends React.ComponentProps<'button'> {\n   issueCount: number\n@@ -487,60 +489,6 @@ function AnimateCount({\n   )\n }\n \n-function useMeasureWidth(ref: React.RefObject<HTMLDivElement | null>): number {\n-  const [width, setWidth] = useState<number>(0)\n-\n-  useEffect(() => {\n-    const el = ref.current\n-\n-    if (!el) {\n-      return\n-    }\n-\n-    const observer = new ResizeObserver(([{ contentRect }]) => {\n-      setWidth(contentRect.width)\n-    })\n-\n-    observer.observe(el)\n-    return () => observer.disconnect()\n-  }, [ref])\n-\n-  return width\n-}\n-\n-function useUpdateAnimation(issueCount: number, animationDurationMs = 0) {\n-  const lastUpdatedTimeStamp = useRef<number | null>(null)\n-  const [animate, setAnimate] = useState(false)\n-\n-  useEffect(() => {\n-    if (issueCount > 0) {\n-      const deltaMs = lastUpdatedTimeStamp.current\n-        ? Date.now() - lastUpdatedTimeStamp.current\n-        : -1\n-      lastUpdatedTimeStamp.current = Date.now()\n-\n-      // We don't animate if `issueCount` changes too quickly\n-      if (deltaMs <= animationDurationMs) {\n-        return\n-      }\n-\n-      setAnimate(true)\n-      // It is important to use a CSS transitioned state, not a CSS keyframed animation\n-      // because if the issue count increases faster than the animation duration, it\n-      // will abruptly stop and not transition smoothly back to its original state.\n-      const timeoutId = window.setTimeout(() => {\n-        setAnimate(false)\n-      }, animationDurationMs)\n-\n-      return () => {\n-        clearTimeout(timeoutId)\n-      }\n-    }\n-  }, [issueCount, animationDurationMs])\n-\n-  return animate\n-}\n-\n function NextMark({\n   isLoading,\n   isDevBuilding,"
        },
        {
            "sha": "578d8629967b51f329369730836275414b40c67f",
            "filename": "packages/next/src/next-devtools/dev-overlay/icons/cross.tsx",
            "status": "added",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Ficons%2Fcross.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Ficons%2Fcross.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Ficons%2Fcross.tsx?ref=3e27abf43350cfcb10ba6839e7749dd80a628139",
            "patch": "@@ -0,0 +1,19 @@\n+export function Cross(props: React.SVGProps<SVGSVGElement>) {\n+  return (\n+    <svg\n+      width=\"12\"\n+      height=\"12\"\n+      viewBox=\"0 0 14 14\"\n+      fill=\"none\"\n+      xmlns=\"http://www.w3.org/2000/svg\"\n+      {...props}\n+    >\n+      <path\n+        fillRule=\"evenodd\"\n+        clipRule=\"evenodd\"\n+        d=\"M3.08889 11.8384L2.62486 12.3024L1.69678 11.3744L2.16082 10.9103L6.07178 6.99937L2.16082 3.08841L1.69678 2.62437L2.62486 1.69629L3.08889 2.16033L6.99986 6.07129L10.9108 2.16033L11.3749 1.69629L12.3029 2.62437L11.8389 3.08841L7.92793 6.99937L11.8389 10.9103L12.3029 11.3744L11.3749 12.3024L10.9108 11.8384L6.99986 7.92744L3.08889 11.8384Z\"\n+        fill=\"currentColor\"\n+      />\n+    </svg>\n+  )\n+}"
        },
        {
            "sha": "8ff102e5053d023764da200db7a9de18244f0252",
            "filename": "packages/next/src/next-devtools/dev-overlay/icons/warning.tsx",
            "status": "added",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Ficons%2Fwarning.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3e27abf43350cfcb10ba6839e7749dd80a628139/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Ficons%2Fwarning.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Ficons%2Fwarning.tsx?ref=3e27abf43350cfcb10ba6839e7749dd80a628139",
            "patch": "@@ -0,0 +1,19 @@\n+export function Warning(props: React.SVGProps<SVGSVGElement>) {\n+  return (\n+    <svg\n+      width=\"12\"\n+      height=\"12\"\n+      viewBox=\"0 0 12 12\"\n+      fill=\"none\"\n+      xmlns=\"http://www.w3.org/2000/svg\"\n+      {...props}\n+    >\n+      <path\n+        fillRule=\"evenodd\"\n+        clipRule=\"evenodd\"\n+        d=\"M3.98071 1.125L1.125 3.98071L1.125 8.01929L3.98071 10.875H8.01929L10.875 8.01929V3.98071L8.01929 1.125H3.98071ZM3.82538 0C3.62647 0 3.4357 0.0790176 3.29505 0.21967L0.21967 3.29505C0.0790176 3.4357 0 3.62647 0 3.82538V8.17462C0 8.37353 0.0790178 8.5643 0.21967 8.70495L3.29505 11.7803C3.4357 11.921 3.62647 12 3.82538 12H8.17462C8.37353 12 8.5643 11.921 8.70495 11.7803L11.7803 8.70495C11.921 8.5643 12 8.37353 12 8.17462V3.82538C12 3.62647 11.921 3.4357 11.7803 3.29505L8.70495 0.21967C8.5643 0.0790177 8.37353 0 8.17462 0H3.82538ZM6.5625 2.8125V3.375V6V6.5625H5.4375V6V3.375V2.8125H6.5625ZM6 9C6.41421 9 6.75 8.66421 6.75 8.25C6.75 7.83579 6.41421 7.5 6 7.5C5.58579 7.5 5.25 7.83579 5.25 8.25C5.25 8.66421 5.58579 9 6 9Z\"\n+        fill=\"#EAEAEA\"\n+      />\n+    </svg>\n+  )\n+}"
        }
    ],
    "stats": {
        "total": 804,
        "additions": 744,
        "deletions": 60
    }
}