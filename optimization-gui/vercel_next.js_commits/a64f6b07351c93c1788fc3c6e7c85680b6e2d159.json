{
    "author": "devjiwonchoi",
    "message": "test: replace duplicate test utils to next instance (#73624)\n\nThis PR replaces:\n- `renderViaHTTP -> next.render`\n- `cheerio.load -> next.render$`\n- ~~`process.env.TURBOPACK` -> `isTurbopack`~~ (left as\n`process.env.IS_TURBOPACK_TEST`)",
    "sha": "a64f6b07351c93c1788fc3c6e7c85680b6e2d159",
    "files": [
        {
            "sha": "84955856fb03dbfb9a31c5646834a6da7c5602de",
            "filename": "test/development/basic/hmr/run-error-recovery-hmr-test.util.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/a64f6b07351c93c1788fc3c6e7c85680b6e2d159/test%2Fdevelopment%2Fbasic%2Fhmr%2Frun-error-recovery-hmr-test.util.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/a64f6b07351c93c1788fc3c6e7c85680b6e2d159/test%2Fdevelopment%2Fbasic%2Fhmr%2Frun-error-recovery-hmr-test.util.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fbasic%2Fhmr%2Frun-error-recovery-hmr-test.util.ts?ref=a64f6b07351c93c1788fc3c6e7c85680b6e2d159",
            "patch": "@@ -6,7 +6,6 @@ import {\n   getRedboxHeader,\n   getRedboxDescription,\n   getRedboxSource,\n-  renderViaHTTP,\n   retry,\n   waitFor,\n   trimEndMultiline,\n@@ -245,7 +244,7 @@ export function runErrorRecoveryHmrTest(nextConfig: {\n       const aboutContent = await next.readFile(aboutPage)\n       const browser = await next.browser(basePath + '/hmr/contact')\n       try {\n-        await renderViaHTTP(next.url, basePath + '/hmr/about2')\n+        await next.render(basePath + '/hmr/about2')\n \n         await next.patchFile(aboutPage, aboutContent.replace('</div>', 'div'))\n "
        },
        {
            "sha": "8accb523b768421fb1ccedbd0f49b81fbb28ea66",
            "filename": "test/development/basic/hmr/run-hot-module-reload-hmr-test.util.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 13,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/a64f6b07351c93c1788fc3c6e7c85680b6e2d159/test%2Fdevelopment%2Fbasic%2Fhmr%2Frun-hot-module-reload-hmr-test.util.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/a64f6b07351c93c1788fc3c6e7c85680b6e2d159/test%2Fdevelopment%2Fbasic%2Fhmr%2Frun-hot-module-reload-hmr-test.util.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fbasic%2Fhmr%2Frun-hot-module-reload-hmr-test.util.ts?ref=a64f6b07351c93c1788fc3c6e7c85680b6e2d159",
            "patch": "@@ -1,11 +1,5 @@\n import { join } from 'path'\n-import cheerio from 'cheerio'\n-import {\n-  getBrowserBodyText,\n-  renderViaHTTP,\n-  retry,\n-  waitFor,\n-} from 'next-test-utils'\n+import { getBrowserBodyText, retry, waitFor } from 'next-test-utils'\n import { nextTestSetup } from 'e2e-utils'\n \n export function runHotModuleReloadHmrTest(nextConfig: {\n@@ -197,13 +191,14 @@ export function runHotModuleReloadHmrTest(nextConfig: {\n \n         expect(initialFontSize).toBe('100px')\n \n-        const initialHtml = await renderViaHTTP(\n-          next.url,\n+        const initialHtml = await next.render(\n           basePath + '/hmr/style-dynamic-component'\n         )\n         expect(initialHtml.includes('100px')).toBeTruthy()\n \n-        const $initialHtml = cheerio.load(initialHtml)\n+        const $initialHtml = await next.render$(\n+          basePath + '/hmr/style-dynamic-component'\n+        )\n         const initialServerClassName =\n           $initialHtml('#dynamic-component').attr('class')\n \n@@ -229,12 +224,13 @@ export function runHotModuleReloadHmrTest(nextConfig: {\n         expect(browserHtml.includes('font-size:200px')).toBe(true)\n         expect(browserHtml.includes('font-size:100px')).toBe(false)\n \n-        const editedHtml = await renderViaHTTP(\n-          next.url,\n+        const editedHtml = await next.render(\n           basePath + '/hmr/style-dynamic-component'\n         )\n         expect(editedHtml.includes('200px')).toBeTruthy()\n-        const $editedHtml = cheerio.load(editedHtml)\n+        const $editedHtml = await next.render$(\n+          basePath + '/hmr/style-dynamic-component'\n+        )\n         const editedServerClassName =\n           $editedHtml('#dynamic-component').attr('class')\n "
        }
    ],
    "stats": {
        "total": 25,
        "additions": 10,
        "deletions": 15
    }
}