{
    "author": "sokra",
    "message": "Initial MCP implementation (#81770)\n\n### What?\r\n\r\nAdd MCP for next dev exposing entrypoints, module graph and issues.\r\n\r\nCan be enabled via `NEXT_EXPERIMENTAL_MCP_SECRET=<random>` and makes the MCP available on `/_next/mcp?<random>`.\r\n\r\nInteresting change is in: packages/next/src/server/lib/router-utils/mcp.ts",
    "sha": "b7a97a059877c525ebac41e5d0647e71e5dbb44c",
    "files": [
        {
            "sha": "97d02507fb92e6cbcf31d812a58b57a209900bc6",
            "filename": "crates/napi/src/next_api/endpoint.rs",
            "status": "modified",
            "additions": 112,
            "deletions": 4,
            "changes": 116,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnapi%2Fsrc%2Fnext_api%2Fendpoint.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnapi%2Fsrc%2Fnext_api%2Fendpoint.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnapi%2Fsrc%2Fnext_api%2Fendpoint.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -4,21 +4,25 @@ use anyhow::Result;\n use futures_util::TryFutureExt;\n use napi::{JsFunction, bindgen_prelude::External};\n use next_api::{\n+    module_graph_snapshot::{ModuleGraphSnapshot, get_module_graph_snapshot},\n     operation::OptionEndpoint,\n     paths::ServerPath,\n     route::{\n-        EndpointOutputPaths, endpoint_client_changed_operation, endpoint_server_changed_operation,\n-        endpoint_write_to_disk_operation,\n+        Endpoint, EndpointOutputPaths, endpoint_client_changed_operation,\n+        endpoint_server_changed_operation, endpoint_write_to_disk_operation,\n     },\n };\n use tracing::Instrument;\n-use turbo_tasks::{Completion, Effects, OperationVc, ReadRef, Vc};\n-use turbopack_core::{diagnostics::PlainDiagnostic, issue::PlainIssue};\n+use turbo_tasks::{\n+    Completion, Effects, OperationVc, ReadRef, TryFlatJoinIterExt, TryJoinIterExt, Vc,\n+};\n+use turbopack_core::{diagnostics::PlainDiagnostic, error::PrettyPrintError, issue::PlainIssue};\n \n use super::utils::{\n     DetachedVc, NapiDiagnostic, NapiIssue, RootTask, TurbopackResult,\n     strongly_consistent_catch_collectables, subscribe,\n };\n+use crate::next_api::module_graph::NapiModuleGraphSnapshot;\n \n #[napi(object)]\n #[derive(Default)]\n@@ -81,6 +85,11 @@ impl From<Option<EndpointOutputPaths>> for NapiWrittenEndpoint {\n     }\n }\n \n+#[napi(object)]\n+pub struct NapiModuleGraphSnapshots {\n+    pub module_graphs: Vec<NapiModuleGraphSnapshot>,\n+}\n+\n // NOTE(alexkirsz) We go through an extra layer of indirection here because of\n // two factors:\n // 1. rustc currently has a bug where using a dyn trait as a type argument to\n@@ -155,6 +164,105 @@ pub async fn endpoint_write_to_disk(\n     })\n }\n \n+#[turbo_tasks::value(serialization = \"none\")]\n+struct ModuleGraphsWithIssues {\n+    module_graphs: Option<ReadRef<ModuleGraphSnapshots>>,\n+    issues: Arc<Vec<ReadRef<PlainIssue>>>,\n+    diagnostics: Arc<Vec<ReadRef<PlainDiagnostic>>>,\n+    effects: Arc<Effects>,\n+}\n+\n+#[turbo_tasks::function(operation)]\n+async fn get_module_graphs_with_issues_operation(\n+    endpoint_op: OperationVc<OptionEndpoint>,\n+) -> Result<Vc<ModuleGraphsWithIssues>> {\n+    let module_graphs_op = get_module_graphs_operation(endpoint_op);\n+    let (module_graphs, issues, diagnostics, effects) =\n+        strongly_consistent_catch_collectables(module_graphs_op).await?;\n+    Ok(ModuleGraphsWithIssues {\n+        module_graphs,\n+        issues,\n+        diagnostics,\n+        effects,\n+    }\n+    .cell())\n+}\n+\n+#[turbo_tasks::value(transparent)]\n+struct ModuleGraphSnapshots(Vec<ReadRef<ModuleGraphSnapshot>>);\n+\n+#[turbo_tasks::function(operation)]\n+async fn get_module_graphs_operation(\n+    endpoint_op: OperationVc<OptionEndpoint>,\n+) -> Result<Vc<ModuleGraphSnapshots>> {\n+    let Some(endpoint) = *endpoint_op.connect().await? else {\n+        return Ok(Vc::cell(vec![]));\n+    };\n+    let graphs = endpoint.module_graphs().await?;\n+    let entries = endpoint.entries().await?;\n+    let entry_modules = entries.iter().flat_map(|e| e.entries()).collect::<Vec<_>>();\n+    let snapshots = graphs\n+        .iter()\n+        .map(async |&graph| {\n+            let module_graph = graph.await?;\n+            let entry_modules = entry_modules\n+                .iter()\n+                .map(async |&m| Ok(module_graph.has_entry(m).await?.then_some(m)))\n+                .try_flat_join()\n+                .await?;\n+            Ok((*graph, entry_modules))\n+        })\n+        .try_join()\n+        .await?\n+        .into_iter()\n+        .map(|(graph, entry_modules)| (graph, Vc::cell(entry_modules)))\n+        .collect::<Vec<_>>()\n+        .into_iter()\n+        .map(async |(graph, entry_modules)| {\n+            get_module_graph_snapshot(graph, Some(entry_modules)).await\n+        })\n+        .try_join()\n+        .await?;\n+    Ok(Vc::cell(snapshots))\n+}\n+\n+#[napi]\n+pub async fn endpoint_module_graphs(\n+    #[napi(ts_arg_type = \"{ __napiType: \\\"Endpoint\\\" }\")] endpoint: External<ExternalEndpoint>,\n+) -> napi::Result<TurbopackResult<NapiModuleGraphSnapshots>> {\n+    let endpoint_op: OperationVc<OptionEndpoint> = ***endpoint;\n+    let (module_graphs, issues, diagnostics) = endpoint\n+        .turbopack_ctx()\n+        .turbo_tasks()\n+        .run_once(async move {\n+            let module_graphs_op = get_module_graphs_with_issues_operation(endpoint_op);\n+            let ModuleGraphsWithIssues {\n+                module_graphs,\n+                issues,\n+                diagnostics,\n+                effects: _,\n+            } = &*module_graphs_op.connect().await?;\n+            Ok((module_graphs.clone(), issues.clone(), diagnostics.clone()))\n+        })\n+        .await\n+        .map_err(|e| napi::Error::from_reason(PrettyPrintError(&e).to_string()))?;\n+\n+    Ok(TurbopackResult {\n+        result: NapiModuleGraphSnapshots {\n+            module_graphs: module_graphs\n+                .into_iter()\n+                .flat_map(|m| m.into_iter())\n+                .map(|m| NapiModuleGraphSnapshot::from(&**m))\n+                .collect(),\n+        },\n+        issues: issues.iter().map(|i| NapiIssue::from(&**i)).collect(),\n+        diagnostics: diagnostics\n+            .iter()\n+            .map(|d| NapiDiagnostic::from(d))\n+            .collect(),\n+    })\n+}\n+\n #[napi(ts_return_type = \"{ __napiType: \\\"RootTask\\\" }\")]\n pub fn endpoint_server_changed_subscribe(\n     #[napi(ts_arg_type = \"{ __napiType: \\\"Endpoint\\\" }\")] endpoint: External<ExternalEndpoint>,"
        },
        {
            "sha": "d8a1b0ab8cd266993f49c5a17dc79c670b6c3b50",
            "filename": "crates/napi/src/next_api/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnapi%2Fsrc%2Fnext_api%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnapi%2Fsrc%2Fnext_api%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnapi%2Fsrc%2Fnext_api%2Fmod.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -1,4 +1,5 @@\n pub mod endpoint;\n+pub mod module_graph;\n pub mod project;\n pub mod turbopack_ctx;\n pub mod utils;"
        },
        {
            "sha": "606aa8186a10d96da0113e8c25716ec04e92b92e",
            "filename": "crates/napi/src/next_api/module_graph.rs",
            "status": "added",
            "additions": 98,
            "deletions": 0,
            "changes": 98,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnapi%2Fsrc%2Fnext_api%2Fmodule_graph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnapi%2Fsrc%2Fnext_api%2Fmodule_graph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnapi%2Fsrc%2Fnext_api%2Fmodule_graph.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -0,0 +1,98 @@\n+use next_api::module_graph_snapshot::{ModuleGraphSnapshot, ModuleInfo, ModuleReference};\n+use turbo_rcstr::RcStr;\n+use turbopack_core::chunk::ChunkingType;\n+\n+#[napi(object)]\n+pub struct NapiModuleReference {\n+    /// The index of the referenced/referencing module in the modules list.\n+    pub index: u32,\n+    /// The export used in the module reference.\n+    pub export: String,\n+    /// The type of chunking for the module reference.\n+    pub chunking_type: String,\n+}\n+\n+impl From<&ModuleReference> for NapiModuleReference {\n+    fn from(reference: &ModuleReference) -> Self {\n+        Self {\n+            index: reference.index as u32,\n+            export: reference.export.to_string(),\n+            chunking_type: match &reference.chunking_type {\n+                ChunkingType::Parallel { hoisted: true, .. } => \"hoisted\".to_string(),\n+                ChunkingType::Parallel { hoisted: false, .. } => \"sync\".to_string(),\n+                ChunkingType::Async => \"async\".to_string(),\n+                ChunkingType::Isolated {\n+                    merge_tag: None, ..\n+                } => \"isolated\".to_string(),\n+                ChunkingType::Isolated {\n+                    merge_tag: Some(name),\n+                    ..\n+                } => format!(\"isolated {name}\"),\n+                ChunkingType::Shared {\n+                    merge_tag: None, ..\n+                } => \"shared\".to_string(),\n+                ChunkingType::Shared {\n+                    merge_tag: Some(name),\n+                    ..\n+                } => format!(\"shared {name}\"),\n+                ChunkingType::Traced => \"traced\".to_string(),\n+            },\n+        }\n+    }\n+}\n+\n+#[napi(object)]\n+pub struct NapiModuleInfo {\n+    pub ident: RcStr,\n+    pub path: RcStr,\n+    pub depth: u32,\n+    pub size: u32,\n+    pub retained_size: u32,\n+    pub references: Vec<NapiModuleReference>,\n+    pub incoming_references: Vec<NapiModuleReference>,\n+}\n+\n+impl From<&ModuleInfo> for NapiModuleInfo {\n+    fn from(info: &ModuleInfo) -> Self {\n+        Self {\n+            ident: info.ident.clone(),\n+            path: info.path.clone(),\n+            depth: info.depth,\n+            size: info.size,\n+            retained_size: info.retained_size,\n+            references: info\n+                .references\n+                .iter()\n+                .map(NapiModuleReference::from)\n+                .collect(),\n+            incoming_references: info\n+                .incoming_references\n+                .iter()\n+                .map(NapiModuleReference::from)\n+                .collect(),\n+        }\n+    }\n+}\n+\n+#[napi(object)]\n+#[derive(Default)]\n+pub struct NapiModuleGraphSnapshot {\n+    pub modules: Vec<NapiModuleInfo>,\n+    pub entries: Vec<u32>,\n+}\n+\n+impl From<&ModuleGraphSnapshot> for NapiModuleGraphSnapshot {\n+    fn from(snapshot: &ModuleGraphSnapshot) -> Self {\n+        Self {\n+            modules: snapshot.modules.iter().map(NapiModuleInfo::from).collect(),\n+            entries: snapshot\n+                .entries\n+                .iter()\n+                .map(|&i| {\n+                    // If you have more that 4294967295 entries, you probably have other problems...\n+                    i.try_into().unwrap()\n+                })\n+                .collect(),\n+        }\n+    }\n+}"
        },
        {
            "sha": "63e4560d60ce05324bf6d3f2c2b05343fd1f8f52",
            "filename": "crates/napi/src/next_api/project.rs",
            "status": "modified",
            "additions": 104,
            "deletions": 1,
            "changes": 105,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -9,6 +9,7 @@ use napi::{\n };\n use next_api::{\n     entrypoints::Entrypoints,\n+    module_graph_snapshot::{ModuleGraphSnapshot, get_module_graph_snapshot},\n     operation::{\n         EntrypointsOperation, InstrumentationOperation, MiddlewareOperation, OptionEndpoint,\n         RouteOperation,\n@@ -63,13 +64,14 @@ use url::Url;\n use crate::{\n     next_api::{\n         endpoint::ExternalEndpoint,\n+        module_graph::NapiModuleGraphSnapshot,\n         turbopack_ctx::{\n             NapiNextTurbopackCallbacks, NapiNextTurbopackCallbacksJsObject, NextTurboTasks,\n             NextTurbopackContext, create_turbo_tasks,\n         },\n         utils::{\n             DetachedVc, NapiDiagnostic, NapiIssue, RootTask, TurbopackResult, get_diagnostics,\n-            get_issues, subscribe,\n+            get_issues, strongly_consistent_catch_collectables, subscribe,\n         },\n     },\n     register,\n@@ -987,6 +989,40 @@ async fn output_assets_operation(\n     Ok(Vc::cell(output_assets.into_iter().collect()))\n }\n \n+#[napi]\n+pub async fn project_entrypoints(\n+    #[napi(ts_arg_type = \"{ __napiType: \\\"Project\\\" }\")] project: External<ProjectInstance>,\n+) -> napi::Result<TurbopackResult<NapiEntrypoints>> {\n+    let container = project.container;\n+\n+    let (entrypoints, issues, diags) = project\n+        .turbopack_ctx\n+        .turbo_tasks()\n+        .run_once(async move {\n+            let entrypoints_with_issues_op = get_entrypoints_with_issues_operation(container);\n+\n+            // Read and compile the files\n+            let EntrypointsWithIssues {\n+                entrypoints,\n+                issues,\n+                diagnostics,\n+                effects: _,\n+            } = &*entrypoints_with_issues_op\n+                .read_strongly_consistent()\n+                .await?;\n+\n+            Ok((entrypoints.clone(), issues.clone(), diagnostics.clone()))\n+        })\n+        .await\n+        .map_err(|e| napi::Error::from_reason(PrettyPrintError(&e).to_string()))?;\n+\n+    Ok(TurbopackResult {\n+        result: NapiEntrypoints::from_entrypoints_op(&entrypoints, &project.turbopack_ctx)?,\n+        issues: issues.iter().map(|i| NapiIssue::from(&**i)).collect(),\n+        diagnostics: diags.iter().map(|d| NapiDiagnostic::from(d)).collect(),\n+    })\n+}\n+\n #[napi(ts_return_type = \"{ __napiType: \\\"RootTask\\\" }\")]\n pub fn project_entrypoints_subscribe(\n     #[napi(ts_arg_type = \"{ __napiType: \\\"Project\\\" }\")] project: External<ProjectInstance>,\n@@ -1650,3 +1686,70 @@ pub fn project_get_source_map_sync(\n         tokio::runtime::Handle::current().block_on(project_get_source_map(project, file_path))\n     })\n }\n+\n+#[napi]\n+pub async fn project_module_graph(\n+    #[napi(ts_arg_type = \"{ __napiType: \\\"Project\\\" }\")] project: External<ProjectInstance>,\n+) -> napi::Result<TurbopackResult<NapiModuleGraphSnapshot>> {\n+    let container = project.container;\n+    let (module_graph, issues, diagnostics) = project\n+        .turbopack_ctx\n+        .turbo_tasks()\n+        .run_once(async move {\n+            let module_graph_op = get_module_graph_with_issues_operation(container);\n+            let ModuleGraphWithIssues {\n+                module_graph,\n+                issues,\n+                diagnostics,\n+                effects: _,\n+            } = &*module_graph_op.connect().await?;\n+            Ok((module_graph.clone(), issues.clone(), diagnostics.clone()))\n+        })\n+        .await\n+        .map_err(|e| napi::Error::from_reason(PrettyPrintError(&e).to_string()))?;\n+\n+    Ok(TurbopackResult {\n+        result: module_graph.map_or_else(NapiModuleGraphSnapshot::default, |m| {\n+            NapiModuleGraphSnapshot::from(&*m)\n+        }),\n+        issues: issues.iter().map(|i| NapiIssue::from(&**i)).collect(),\n+        diagnostics: diagnostics\n+            .iter()\n+            .map(|d| NapiDiagnostic::from(d))\n+            .collect(),\n+    })\n+}\n+\n+#[turbo_tasks::value(serialization = \"none\")]\n+struct ModuleGraphWithIssues {\n+    module_graph: Option<ReadRef<ModuleGraphSnapshot>>,\n+    issues: Arc<Vec<ReadRef<PlainIssue>>>,\n+    diagnostics: Arc<Vec<ReadRef<PlainDiagnostic>>>,\n+    effects: Arc<Effects>,\n+}\n+\n+#[turbo_tasks::function(operation)]\n+async fn get_module_graph_with_issues_operation(\n+    project: ResolvedVc<ProjectContainer>,\n+) -> Result<Vc<ModuleGraphWithIssues>> {\n+    let module_graph_op = get_module_graph_operation(project);\n+    let (module_graph, issues, diagnostics, effects) =\n+        strongly_consistent_catch_collectables(module_graph_op).await?;\n+    Ok(ModuleGraphWithIssues {\n+        module_graph,\n+        issues,\n+        diagnostics,\n+        effects,\n+    }\n+    .cell())\n+}\n+\n+#[turbo_tasks::function(operation)]\n+async fn get_module_graph_operation(\n+    project: ResolvedVc<ProjectContainer>,\n+) -> Result<Vc<ModuleGraphSnapshot>> {\n+    let project = project.project();\n+    let graph = project.whole_app_module_graphs().await?.full;\n+    let snapshot = get_module_graph_snapshot(*graph, None).resolve().await?;\n+    Ok(snapshot)\n+}"
        },
        {
            "sha": "093cb5a83b28eab42ebd9ab1ddf51918499e88e9",
            "filename": "crates/next-api/src/app.rs",
            "status": "modified",
            "additions": 22,
            "deletions": 4,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fapp.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fapp.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fapp.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -82,8 +82,10 @@ use crate::{\n         all_paths_in_root, all_server_paths, get_asset_paths_from_root, get_js_paths_from_root,\n         get_wasm_paths_from_root, paths_to_bindings, wasm_paths_to_bindings,\n     },\n-    project::{ModuleGraphs, Project},\n-    route::{AppPageRoute, Endpoint, EndpointOutput, EndpointOutputPaths, Route, Routes},\n+    project::{BaseAndFullModuleGraph, Project},\n+    route::{\n+        AppPageRoute, Endpoint, EndpointOutput, EndpointOutputPaths, ModuleGraphs, Route, Routes,\n+    },\n     server_actions::{build_server_actions_loader, create_server_actions_manifest},\n     webpack_stats::generate_webpack_stats,\n };\n@@ -859,7 +861,7 @@ impl AppProject {\n         rsc_entry: ResolvedVc<Box<dyn Module>>,\n         client_shared_entries: Vc<EvaluatableAssets>,\n         has_layout_segments: bool,\n-    ) -> Result<Vc<ModuleGraphs>> {\n+    ) -> Result<Vc<BaseAndFullModuleGraph>> {\n         if *self.project.per_page_module_graph().await? {\n             let should_trace = self.project.next_mode().await?.is_production();\n             let client_shared_entries = client_shared_entries\n@@ -956,7 +958,7 @@ impl AppProject {\n                 graphs.push(additional_module_graph);\n \n                 let full = ModuleGraph::from_graphs(graphs);\n-                Ok(ModuleGraphs {\n+                Ok(BaseAndFullModuleGraph {\n                     base: base.to_resolved().await?,\n                     full: full.to_resolved().await?,\n                 }\n@@ -2071,6 +2073,22 @@ impl Endpoint for AppEndpoint {\n             server_actions_loader,\n         ])]))\n     }\n+\n+    #[turbo_tasks::function]\n+    async fn module_graphs(self: Vc<Self>) -> Result<Vc<ModuleGraphs>> {\n+        let this = self.await?;\n+        let app_entry = self.app_endpoint_entry().await?;\n+        let module_graphs = this\n+            .app_project\n+            .app_module_graphs(\n+                self,\n+                *app_entry.rsc_entry,\n+                this.app_project.client_runtime_entries(),\n+                matches!(this.ty, AppEndpointType::Page { .. }),\n+            )\n+            .await?;\n+        Ok(Vc::cell(vec![module_graphs.full]))\n+    }\n }\n \n #[turbo_tasks::value]"
        },
        {
            "sha": "cc220d178458e8aaa771005721a9c9bdb818e931",
            "filename": "crates/next-api/src/empty.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fempty.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fempty.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fempty.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -2,7 +2,7 @@ use anyhow::{Result, bail};\n use turbo_tasks::{Completion, Vc};\n use turbopack_core::module_graph::GraphEntries;\n \n-use crate::route::{Endpoint, EndpointOutput};\n+use crate::route::{Endpoint, EndpointOutput, ModuleGraphs};\n \n #[turbo_tasks::value]\n pub struct EmptyEndpoint;\n@@ -36,4 +36,9 @@ impl Endpoint for EmptyEndpoint {\n     fn entries(self: Vc<Self>) -> Vc<GraphEntries> {\n         GraphEntries::empty()\n     }\n+\n+    #[turbo_tasks::function]\n+    fn module_graphs(self: Vc<Self>) -> Vc<ModuleGraphs> {\n+        Vc::cell(vec![])\n+    }\n }"
        },
        {
            "sha": "106c955a76569b171dba1b73bc25827a701ed486",
            "filename": "crates/next-api/src/instrumentation.rs",
            "status": "modified",
            "additions": 19,
            "deletions": 23,
            "changes": 42,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Finstrumentation.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Finstrumentation.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Finstrumentation.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -33,7 +33,7 @@ use crate::{\n         all_server_paths, get_js_paths_from_root, get_wasm_paths_from_root, wasm_paths_to_bindings,\n     },\n     project::Project,\n-    route::{Endpoint, EndpointOutput, EndpointOutputPaths},\n+    route::{Endpoint, EndpointOutput, EndpointOutputPaths, ModuleGraphs},\n };\n \n #[turbo_tasks::value]\n@@ -70,7 +70,7 @@ impl InstrumentationEndpoint {\n     }\n \n     #[turbo_tasks::function]\n-    async fn core_modules(&self) -> Result<Vc<InstrumentationCoreModules>> {\n+    async fn entry_module(&self) -> Result<Vc<Box<dyn Module>>> {\n         let userland_module = self\n             .asset_context\n             .process(\n@@ -81,6 +81,10 @@ impl InstrumentationEndpoint {\n             .to_resolved()\n             .await?;\n \n+        if !self.is_edge {\n+            return Ok(Vc::upcast(*userland_module));\n+        }\n+\n         let edge_entry_module = wrap_edge_entry(\n             *self.asset_context,\n             self.project.project_path().owned().await?,\n@@ -90,17 +94,13 @@ impl InstrumentationEndpoint {\n         .to_resolved()\n         .await?;\n \n-        Ok(InstrumentationCoreModules {\n-            userland_module,\n-            edge_entry_module,\n-        }\n-        .cell())\n+        Ok(Vc::upcast(*edge_entry_module))\n     }\n \n     #[turbo_tasks::function]\n     async fn edge_files(self: Vc<Self>) -> Result<Vc<OutputAssets>> {\n         let this = self.await?;\n-        let module = self.core_modules().await?.edge_entry_module;\n+        let module = self.entry_module().to_resolved().await?;\n \n         let module_graph = this.project.module_graph(*module);\n \n@@ -137,7 +137,7 @@ impl InstrumentationEndpoint {\n \n         let chunking_context = this.project.server_chunking_context(false);\n \n-        let userland_module = self.core_modules().await?.userland_module;\n+        let userland_module = self.entry_module().to_resolved().await?;\n         let module_graph = this.project.module_graph(*userland_module);\n \n         let Some(module) = ResolvedVc::try_downcast(userland_module) else {\n@@ -227,12 +227,6 @@ impl InstrumentationEndpoint {\n     }\n }\n \n-#[turbo_tasks::value]\n-struct InstrumentationCoreModules {\n-    pub userland_module: ResolvedVc<Box<dyn Module>>,\n-    pub edge_entry_module: ResolvedVc<Box<dyn Module>>,\n-}\n-\n #[turbo_tasks::value_impl]\n impl Endpoint for InstrumentationEndpoint {\n     #[turbo_tasks::function]\n@@ -276,13 +270,15 @@ impl Endpoint for InstrumentationEndpoint {\n \n     #[turbo_tasks::function]\n     async fn entries(self: Vc<Self>) -> Result<Vc<GraphEntries>> {\n-        let core_modules = self.core_modules().await?;\n-        Ok(Vc::cell(vec![ChunkGroupEntry::Entry(\n-            if self.await?.is_edge {\n-                vec![core_modules.edge_entry_module]\n-            } else {\n-                vec![core_modules.userland_module]\n-            },\n-        )]))\n+        let entry_module = self.entry_module().to_resolved().await?;\n+        Ok(Vc::cell(vec![ChunkGroupEntry::Entry(vec![entry_module])]))\n+    }\n+\n+    #[turbo_tasks::function]\n+    async fn module_graphs(self: Vc<Self>) -> Result<Vc<ModuleGraphs>> {\n+        let this = self.await?;\n+        let module = self.entry_module();\n+        let module_graph = this.project.module_graph(module).to_resolved().await?;\n+        Ok(Vc::cell(vec![module_graph]))\n     }\n }"
        },
        {
            "sha": "4db17a756ba88587ddca697f147c565b60608fe9",
            "filename": "crates/next-api/src/lib.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Flib.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -13,6 +13,7 @@ mod instrumentation;\n mod loadable_manifest;\n mod middleware;\n mod module_graph;\n+pub mod module_graph_snapshot;\n mod nft_json;\n pub mod operation;\n mod pages;"
        },
        {
            "sha": "ab89d6ee047b67b9fd8c605a0f2f0d480bd1c533",
            "filename": "crates/next-api/src/middleware.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fmiddleware.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fmiddleware.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fmiddleware.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -38,7 +38,7 @@ use crate::{\n         get_wasm_paths_from_root, paths_to_bindings, wasm_paths_to_bindings,\n     },\n     project::Project,\n-    route::{Endpoint, EndpointOutput, EndpointOutputPaths},\n+    route::{Endpoint, EndpointOutput, EndpointOutputPaths, ModuleGraphs},\n };\n \n #[turbo_tasks::value]\n@@ -408,4 +408,15 @@ impl Endpoint for MiddlewareEndpoint {\n             self.entry_module().to_resolved().await?,\n         ])]))\n     }\n+\n+    #[turbo_tasks::function]\n+    async fn module_graphs(self: Vc<Self>) -> Result<Vc<ModuleGraphs>> {\n+        let this = self.await?;\n+        let module_graph = this\n+            .project\n+            .module_graph(self.entry_module())\n+            .to_resolved()\n+            .await?;\n+        Ok(Vc::cell(vec![module_graph]))\n+    }\n }"
        },
        {
            "sha": "dac1bd29502aa8218de85092a7b9405c1cd43679",
            "filename": "crates/next-api/src/module_graph_snapshot.rs",
            "status": "added",
            "additions": 193,
            "deletions": 0,
            "changes": 193,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fmodule_graph_snapshot.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fmodule_graph_snapshot.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fmodule_graph_snapshot.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -0,0 +1,193 @@\n+use std::{cell::RefCell, cmp::Reverse, collections::hash_map::Entry, mem::take};\n+\n+use anyhow::Result;\n+use either::Either;\n+use rustc_hash::{FxHashMap, FxHashSet};\n+use serde::{Deserialize, Serialize};\n+use turbo_rcstr::RcStr;\n+use turbo_tasks::{\n+    NonLocalValue, ResolvedVc, TryJoinIterExt, ValueToString, Vc, trace::TraceRawVcs,\n+};\n+use turbopack_core::{\n+    asset::Asset,\n+    chunk::ChunkingType,\n+    module::{Module, Modules},\n+    module_graph::{GraphTraversalAction, ModuleGraph},\n+    resolve::ExportUsage,\n+};\n+\n+#[derive(PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, Debug)]\n+pub struct ModuleReference {\n+    pub index: usize,\n+    pub chunking_type: ChunkingType,\n+    pub export: ExportUsage,\n+}\n+\n+#[derive(PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, Debug)]\n+pub struct ModuleInfo {\n+    pub ident: RcStr,\n+    pub path: RcStr,\n+    pub depth: u32,\n+    pub size: u32,\n+    // TODO this should be per layer\n+    pub retained_size: u32,\n+    pub references: Vec<ModuleReference>,\n+    pub incoming_references: Vec<ModuleReference>,\n+}\n+\n+#[turbo_tasks::value]\n+pub struct ModuleGraphSnapshot {\n+    pub modules: Vec<ModuleInfo>,\n+    pub entries: Vec<usize>,\n+}\n+\n+#[turbo_tasks::function]\n+pub async fn get_module_graph_snapshot(\n+    module_graph: Vc<ModuleGraph>,\n+    entry_modules: Option<Vc<Modules>>,\n+) -> Result<Vc<ModuleGraphSnapshot>> {\n+    let module_graph = module_graph.await?;\n+\n+    struct RawModuleInfo {\n+        module: ResolvedVc<Box<dyn Module>>,\n+        depth: u32,\n+        retained_modules: RefCell<FxHashSet<u32>>,\n+        references: Vec<ModuleReference>,\n+        incoming_references: Vec<ModuleReference>,\n+    }\n+\n+    let mut entries = Vec::new();\n+    let mut modules = Vec::new();\n+    let mut module_to_index = FxHashMap::default();\n+\n+    fn get_or_create_module(\n+        modules: &mut Vec<RawModuleInfo>,\n+        module_to_index: &mut FxHashMap<ResolvedVc<Box<dyn Module>>, usize>,\n+        module: ResolvedVc<Box<dyn Module>>,\n+    ) -> usize {\n+        match module_to_index.entry(module) {\n+            Entry::Occupied(entry) => *entry.get(),\n+            Entry::Vacant(entry) => {\n+                let index = modules.len();\n+                modules.push(RawModuleInfo {\n+                    module,\n+                    depth: u32::MAX,\n+                    references: Vec::new(),\n+                    incoming_references: Vec::new(),\n+                    retained_modules: Default::default(),\n+                });\n+                entry.insert(index);\n+                index\n+            }\n+        }\n+    }\n+\n+    let entry_modules = if let Some(entry_modules) = entry_modules {\n+        Either::Left(entry_modules.await?)\n+    } else {\n+        Either::Right(module_graph.entries().await?)\n+    };\n+    module_graph\n+        .traverse_edges_from_entries_bfs(entry_modules.iter().copied(), |parent_info, node| {\n+            let module = node.module;\n+            let module_index = get_or_create_module(&mut modules, &mut module_to_index, module);\n+\n+            if let Some((parent_module, ty)) = parent_info {\n+                let parent_index =\n+                    get_or_create_module(&mut modules, &mut module_to_index, parent_module.module);\n+                let parent_module = &mut modules[parent_index];\n+                let parent_depth = parent_module.depth;\n+                debug_assert!(parent_depth < u32::MAX);\n+                parent_module.references.push(ModuleReference {\n+                    index: module_index,\n+                    chunking_type: ty.chunking_type.clone(),\n+                    export: ty.export.clone(),\n+                });\n+                let module = &mut modules[module_index];\n+                module.depth = module.depth.min(parent_depth + 1);\n+                module.incoming_references.push(ModuleReference {\n+                    index: parent_index,\n+                    chunking_type: ty.chunking_type.clone(),\n+                    export: ty.export.clone(),\n+                });\n+            } else {\n+                entries.push(module_index);\n+                let module = &mut modules[module_index];\n+                module.depth = 0;\n+            }\n+\n+            Ok(GraphTraversalAction::Continue)\n+        })\n+        .await?;\n+\n+    let mut modules_by_depth = FxHashMap::default();\n+    for (index, info) in modules.iter().enumerate() {\n+        modules_by_depth\n+            .entry(info.depth)\n+            .or_insert_with(Vec::new)\n+            .push(index);\n+    }\n+    let mut modules_by_depth = modules_by_depth.into_iter().collect::<Vec<_>>();\n+    modules_by_depth.sort_by_key(|(depth, _)| Reverse(*depth));\n+    for (depth, module_indicies) in modules_by_depth {\n+        for module_index in module_indicies {\n+            let module = &modules[module_index];\n+            for ref_info in &module.incoming_references {\n+                let ref_module = &modules[ref_info.index];\n+                if ref_module.depth < depth {\n+                    let mut retained_modules = ref_module.retained_modules.borrow_mut();\n+                    retained_modules.insert(module_index as u32);\n+                    for retained in module.retained_modules.borrow().iter() {\n+                        retained_modules.insert(*retained);\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    let mut final_modules = modules\n+        .iter_mut()\n+        .map(async |info| {\n+            Ok(ModuleInfo {\n+                ident: info.module.ident().to_string().owned().await?,\n+                path: info.module.ident().path().to_string().owned().await?,\n+                depth: info.depth,\n+                size: info\n+                    .module\n+                    .content()\n+                    .len()\n+                    .owned()\n+                    .await\n+                    // TODO all modules should report some content and should not crash\n+                    .unwrap_or_default()\n+                    .unwrap_or_default()\n+                    .try_into()\n+                    .unwrap_or(u32::MAX),\n+                retained_size: 0,\n+                references: take(&mut info.references),\n+                incoming_references: take(&mut info.incoming_references),\n+            })\n+        })\n+        .try_join()\n+        .await?;\n+\n+    for (index, info) in modules.into_iter().enumerate() {\n+        let retained_size = info\n+            .retained_modules\n+            .into_inner()\n+            .iter()\n+            .map(|&retained_index| {\n+                let retained_info = &final_modules[retained_index as usize];\n+                retained_info.size\n+            })\n+            .reduce(|a, b| a.saturating_add(b))\n+            .unwrap_or_default();\n+        final_modules[index].retained_size = retained_size + final_modules[index].size;\n+    }\n+\n+    Ok(ModuleGraphSnapshot {\n+        modules: final_modules,\n+        entries,\n+    }\n+    .cell())\n+}"
        },
        {
            "sha": "a74ce698ef70b4df2053b4c067e3b3207adfb0f7",
            "filename": "crates/next-api/src/pages.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fpages.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -77,7 +77,7 @@ use crate::{\n         get_wasm_paths_from_root, paths_to_bindings, wasm_paths_to_bindings,\n     },\n     project::Project,\n-    route::{Endpoint, EndpointOutput, EndpointOutputPaths, Route, Routes},\n+    route::{Endpoint, EndpointOutput, EndpointOutputPaths, ModuleGraphs, Route, Routes},\n     webpack_stats::generate_webpack_stats,\n };\n \n@@ -1727,6 +1727,13 @@ impl Endpoint for PageEndpoint {\n \n         Ok(Vc::cell(modules))\n     }\n+\n+    #[turbo_tasks::function]\n+    async fn module_graphs(self: Vc<Self>) -> Result<Vc<ModuleGraphs>> {\n+        let client_module_graph = self.client_module_graph().to_resolved().await?;\n+        let ssr_module_graph = self.ssr_module_graph().to_resolved().await?;\n+        Ok(Vc::cell(vec![client_module_graph, ssr_module_graph]))\n+    }\n }\n \n #[turbo_tasks::value]"
        },
        {
            "sha": "0b0a8399e4b9615e03e80c64db3330b84e5cf0ec",
            "filename": "crates/next-api/src/project.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fproject.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Fproject.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fproject.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -973,7 +973,9 @@ impl Project {\n     }\n \n     #[turbo_tasks::function]\n-    pub async fn whole_app_module_graphs(self: ResolvedVc<Self>) -> Result<Vc<ModuleGraphs>> {\n+    pub async fn whole_app_module_graphs(\n+        self: ResolvedVc<Self>,\n+    ) -> Result<Vc<BaseAndFullModuleGraph>> {\n         async move {\n             let module_graphs_op = whole_app_module_graph_operation(self);\n             let module_graphs_vc = module_graphs_op.resolve_strongly_consistent().await?;\n@@ -1813,7 +1815,7 @@ impl Project {\n #[turbo_tasks::function(operation)]\n async fn whole_app_module_graph_operation(\n     project: ResolvedVc<Project>,\n-) -> Result<Vc<ModuleGraphs>> {\n+) -> Result<Vc<BaseAndFullModuleGraph>> {\n     mark_root();\n \n     let should_trace = project.next_mode().await?.is_production();\n@@ -1831,15 +1833,15 @@ async fn whole_app_module_graph_operation(\n     );\n \n     let full = ModuleGraph::from_graphs(vec![base_single_module_graph, additional_module_graph]);\n-    Ok(ModuleGraphs {\n+    Ok(BaseAndFullModuleGraph {\n         base: base.to_resolved().await?,\n         full: full.to_resolved().await?,\n     }\n     .cell())\n }\n \n #[turbo_tasks::value(shared)]\n-pub struct ModuleGraphs {\n+pub struct BaseAndFullModuleGraph {\n     pub base: ResolvedVc<ModuleGraph>,\n     pub full: ResolvedVc<ModuleGraph>,\n }"
        },
        {
            "sha": "5fda6da82881da8a48cf143b4e8ecdf1a221d0a4",
            "filename": "crates/next-api/src/route.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Froute.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/crates%2Fnext-api%2Fsrc%2Froute.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Froute.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -47,6 +47,9 @@ pub enum Route {\n     Conflict,\n }\n \n+#[turbo_tasks::value(transparent)]\n+pub struct ModuleGraphs(Vec<ResolvedVc<ModuleGraph>>);\n+\n #[turbo_tasks::value_trait]\n pub trait Endpoint {\n     #[turbo_tasks::function]\n@@ -65,6 +68,8 @@ pub trait Endpoint {\n     fn additional_entries(self: Vc<Self>, _graph: Vc<ModuleGraph>) -> Vc<GraphEntries> {\n         GraphEntries::empty()\n     }\n+    #[turbo_tasks::function]\n+    fn module_graphs(self: Vc<Self>) -> Vc<ModuleGraphs>;\n }\n \n #[turbo_tasks::value(transparent)]"
        },
        {
            "sha": "e8420b4ca8239a6a15ec33b62d970174a7808caf",
            "filename": "packages/next/errors.json",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Ferrors.json",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Ferrors.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ferrors.json?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -752,5 +752,8 @@\n   \"751\": \"%s cannot not be used outside of a request context.\",\n   \"752\": \"Route %s used \\\"connection\\\" inside \\\"use cache\\\". The \\\\`connection()\\\\` function is used to indicate the subsequent code must only run when there is an actual request, but caches must be able to be produced before a request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\",\n   \"753\": \"Route %s used \\\"connection\\\" inside \\\"use cache: private\\\". The \\\\`connection()\\\\` function is used to indicate the subsequent code must only run when there is an actual navigation request, but caches must be able to be produced before a navigation request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\",\n-  \"754\": \"%s cannot be used outside of a request context.\"\n+  \"754\": \"%s cannot be used outside of a request context.\",\n+  \"755\": \"Route must be a string\",\n+  \"756\": \"Route %s not found\",\n+  \"757\": \"Unknown styled string type: %s\"\n }"
        },
        {
            "sha": "8a99a6f8011ac7b93d83b3221e72f5b3b057e33f",
            "filename": "packages/next/package.json",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fpackage.json?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -107,6 +107,7 @@\n     \"styled-jsx\": \"5.1.6\"\n   },\n   \"peerDependencies\": {\n+    \"@modelcontextprotocol/sdk\": \"^1.15.1\",\n     \"@opentelemetry/api\": \"^1.1.0\",\n     \"@playwright/test\": \"^1.51.1\",\n     \"babel-plugin-react-compiler\": \"*\",\n@@ -121,6 +122,9 @@\n     \"sass\": {\n       \"optional\": true\n     },\n+    \"@modelcontextprotocol/sdk\": {\n+      \"optional\": true\n+    },\n     \"@opentelemetry/api\": {\n       \"optional\": true\n     },\n@@ -161,6 +165,7 @@\n     \"@hapi/accept\": \"5.0.2\",\n     \"@jest/transform\": \"29.5.0\",\n     \"@jest/types\": \"29.5.0\",\n+    \"@modelcontextprotocol/sdk\": \"1.15.1\",\n     \"@mswjs/interceptors\": \"0.23.0\",\n     \"@napi-rs/triples\": \"1.2.0\",\n     \"@next/font\": \"15.4.2-canary.15\","
        },
        {
            "sha": "34bf982be9d21a31662cc2131dd21e885c0bbfd9",
            "filename": "packages/next/src/build/swc/generated-native.d.ts",
            "status": "modified",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Fgenerated-native.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Fgenerated-native.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Fgenerated-native.d.ts?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -64,9 +64,15 @@ export interface NapiWrittenEndpoint {\n   serverPaths: Array<NapiServerPath>\n   config: NapiEndpointConfig\n }\n+export interface NapiModuleGraphSnapshots {\n+  moduleGraphs: Array<NapiModuleGraphSnapshot>\n+}\n export declare function endpointWriteToDisk(endpoint: {\n   __napiType: 'Endpoint'\n }): Promise<TurbopackResult>\n+export declare function endpointModuleGraphs(endpoint: {\n+  __napiType: 'Endpoint'\n+}): Promise<TurbopackResult>\n export declare function endpointServerChangedSubscribe(\n   endpoint: { __napiType: 'Endpoint' },\n   issues: boolean,\n@@ -76,6 +82,27 @@ export declare function endpointClientChangedSubscribe(\n   endpoint: { __napiType: 'Endpoint' },\n   func: (...args: any[]) => any\n ): { __napiType: 'RootTask' }\n+export interface NapiModuleReference {\n+  /** The index of the referenced/referencing module in the modules list. */\n+  index: number\n+  /** The export used in the module reference. */\n+  export: string\n+  /** The type of chunking for the module reference. */\n+  chunkingType: string\n+}\n+export interface NapiModuleInfo {\n+  ident: RcStr\n+  path: RcStr\n+  depth: number\n+  size: number\n+  retainedSize: number\n+  references: Array<NapiModuleReference>\n+  incomingReferences: Array<NapiModuleReference>\n+}\n+export interface NapiModuleGraphSnapshot {\n+  modules: Array<NapiModuleInfo>\n+  entries: Array<number>\n+}\n export interface NapiEnvVar {\n   name: RcStr\n   value: RcStr\n@@ -286,6 +313,9 @@ export declare function projectWriteAllEntrypointsToDisk(\n   project: { __napiType: 'Project' },\n   appDirOnly: boolean\n ): Promise<TurbopackResult>\n+export declare function projectEntrypoints(project: {\n+  __napiType: 'Project'\n+}): Promise<TurbopackResult>\n export declare function projectEntrypointsSubscribe(\n   project: { __napiType: 'Project' },\n   func: (...args: any[]) => any\n@@ -362,6 +392,9 @@ export declare function projectGetSourceMapSync(\n   project: { __napiType: 'Project' },\n   filePath: RcStr\n ): string | null\n+export declare function projectModuleGraph(project: {\n+  __napiType: 'Project'\n+}): Promise<TurbopackResult>\n /**\n  * A version of [`NapiNextTurbopackCallbacks`] that can accepted as an argument to a napi function.\n  *"
        },
        {
            "sha": "e3b4251e1e29a76fa46ab5804f2ba51f09f0ee24",
            "filename": "packages/next/src/build/swc/index.ts",
            "status": "modified",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Findex.ts?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -19,6 +19,8 @@ import { isDeepStrictEqual } from 'util'\n import { type DefineEnvOptions, getDefineEnv } from '../define-env'\n import { getReactCompilerLoader } from '../get-babel-loader-config'\n import type {\n+  NapiModuleGraphSnapshot,\n+  NapiModuleGraphSnapshots,\n   NapiPartialProjectOptions,\n   NapiProjectOptions,\n   NapiSourceDiagnostic,\n@@ -669,6 +671,14 @@ function bindingToApi(\n       return napiEntrypointsToRawEntrypoints(napiEndpoints)\n     }\n \n+    async getEntrypoints() {\n+      const napiEndpoints = (await binding.projectEntrypoints(\n+        this._nativeProject\n+      )) as TurbopackResult<NapiEntrypoints>\n+\n+      return napiEntrypointsToRawEntrypoints(napiEndpoints)\n+    }\n+\n     entrypointsSubscribe() {\n       const subscription = subscribe<TurbopackResult<NapiEntrypoints>>(\n         false,\n@@ -742,6 +752,12 @@ function bindingToApi(\n       )\n     }\n \n+    moduleGraph(): Promise<TurbopackResult<NapiModuleGraphSnapshot>> {\n+      return binding.projectModuleGraph(this._nativeProject) as Promise<\n+        TurbopackResult<NapiModuleGraphSnapshot>\n+      >\n+    }\n+\n     invalidatePersistentCache(): Promise<void> {\n       return binding.projectInvalidatePersistentCache(this._nativeProject)\n     }\n@@ -793,6 +809,12 @@ function bindingToApi(\n       await serverSubscription.next()\n       return serverSubscription\n     }\n+\n+    async moduleGraphs(): Promise<TurbopackResult<NapiModuleGraphSnapshots>> {\n+      return binding.endpointModuleGraphs(this._nativeEndpoint) as Promise<\n+        TurbopackResult<NapiModuleGraphSnapshots>\n+      >\n+    }\n   }\n \n   /**"
        },
        {
            "sha": "8af31514e84712f96b3797ebcb3051d74a9a2ab4",
            "filename": "packages/next/src/build/swc/types.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Ftypes.ts?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -5,6 +5,8 @@ import type {\n   RefCell,\n   NapiTurboEngineOptions,\n   NapiSourceDiagnostic,\n+  NapiModuleGraphSnapshots,\n+  NapiModuleGraphSnapshot,\n } from './generated-native'\n \n export type { NapiTurboEngineOptions as TurboEngineOptions }\n@@ -216,6 +218,7 @@ export interface Project {\n     appDirOnly: boolean\n   ): Promise<TurbopackResult<RawEntrypoints>>\n \n+  getEntrypoints(): Promise<TurbopackResult<RawEntrypoints>>\n   entrypointsSubscribe(): AsyncIterableIterator<TurbopackResult<RawEntrypoints>>\n \n   hmrEvents(identifier: string): AsyncIterableIterator<TurbopackResult<Update>>\n@@ -244,6 +247,8 @@ export interface Project {\n \n   invalidatePersistentCache(): Promise<void>\n \n+  moduleGraph(): Promise<TurbopackResult<NapiModuleGraphSnapshot>>\n+\n   shutdown(): Promise<void>\n \n   onExit(): Promise<void>\n@@ -295,6 +300,11 @@ export interface Endpoint {\n   serverChanged(\n     includeIssues: boolean\n   ): Promise<AsyncIterableIterator<TurbopackResult>>\n+\n+  /**\n+   * Gets a snapshot of the module graphs for the endpoint.\n+   */\n+  moduleGraphs(): Promise<TurbopackResult<NapiModuleGraphSnapshots>>\n }\n \n interface EndpointConfig {"
        },
        {
            "sha": "a79d44dbc26e232fe66be74e108abab6d71d9278",
            "filename": "packages/next/src/server/lib/router-utils/mcp.ts",
            "status": "added",
            "additions": 584,
            "deletions": 0,
            "changes": 584,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fmcp.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fmcp.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fmcp.ts?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -0,0 +1,584 @@\n+import { McpServer } from '@modelcontextprotocol/sdk/server/mcp.js'\n+import { z } from 'next/dist/compiled/zod'\n+import type { NextJsHotReloaderInterface } from '../../dev/hot-reloader-types'\n+import type {\n+  Endpoint,\n+  Issue,\n+  Route,\n+  StyledString,\n+} from '../../../build/swc/types'\n+import type { CallToolResult } from '@modelcontextprotocol/sdk/types'\n+import type {\n+  NapiModuleGraphSnapshot,\n+  NapiModuleInfo,\n+  NapiModuleReference,\n+} from '../../../build/swc/generated-native'\n+import { runInNewContext } from 'node:vm'\n+import * as Log from '../../../build/output/log'\n+import { formatImportTraces } from '../../../shared/lib/turbopack/utils'\n+import { inspect } from 'node:util'\n+\n+export { StreamableHTTPServerTransport } from '@modelcontextprotocol/sdk/server/streamableHttp.js'\n+\n+const QUERY_DESCRIPTION = `A piece of JavaScript code that will be executed.\n+It can access the module graph and extract information it finds useful.\n+The \\`console.log\\` function can be used to log messages, which will also be returned in the response.\n+No Node.js or browser APIs are available, but JavaScript language features are available.\n+When the user is interested in used exports of modules, you can use the \\`export\\` property of ModuleReferences (\\`incomingReferences\\`).\n+When the user is interested in the import path of a module, follow one of the \\`incomingReferences\\` with a smaller \\`depth\\` value than the current module until you hit the root.\n+Do not try to make any assumptions or estimations. See the typings to see which data you have available. If you don't have the data, tell the user that this data is not available and list alternatives that are available.\n+See the following TypeScript typings for reference:\n+\n+\\`\\`\\` typescript\n+interface Module {\n+  /// The identifier of the module, which is a unique string.\n+  /// Example: \"[project]/packages/next-app/src/app/folder/page.tsx [app-rsc] (ecmascript, Next.js Server Component)\"\n+  /// These layers exist in App Router:\n+  /// * Server Components: [app-rsc], [app-edge-rsc]\n+  /// * API routes: [app-route], [app-edge-route]\n+  /// * Client Components: [app-client]\n+  /// * Server Side Rendering of Client Components: [app-ssr], [app-edge-ssr]\n+  /// These layers exist in Pages Router:\n+  /// * Client-side rendering: [client]\n+  /// * Server-side rendering: [ssr], [edge-ssr]\n+  /// * API routes: [api], [edge-api]\n+  /// And these layers also exist:\n+  /// * Middleware: [middleware], [middleware-edge]\n+  /// * Instrumentation: [instrumentation], [instrumentation-edge]\n+  ident: string,\n+  /// The path of the module. It's not unique as multiple modules can have the same path.\n+  /// Separate between application code and node_modules (npm packages, vendor code).\n+  /// Example: \"[project]/pages/folder/index.js\",\n+  /// Example: \"[project]/node_modules/.pnpm/next@file+..+next.js+packages+next_@babel+core@7.27.4_@opentelemetry+api@1.7.0_@playwright+te_5kenhtwdm6lrgjpao5hc34lkgy/node_modules/next/dist/compiled/fresh/index.js\",\n+  /// Example: \"[project]/apps/site/node_modules/@opentelemtry/api/build/src/trace/instrumentation.js\",\n+  path: string,\n+  /// The distance to the entries of the module graph. Use this to traverse the graph in the right direction.\n+  /// This is useful when trying to find the path from a module to the root of the module graph.\n+  /// Example: 0 for the entrypoint, 1 for the first layer of modules, etc.\n+  depth: number,\n+  /// The size of the source code of the module in bytes.\n+  /// Note that it's not the final size of the generated code, but can be a good indicator of that.\n+  /// It's only the size of this single module, not the size of the whole subgraph behind it (see retainedSize instead).\n+  size: number,\n+  /// The size of the whole subgraph behind this module in bytes.\n+  /// Use this value if the user is interested in sizes of modules (except when they are interested in the size of the module itself).\n+  /// Never try to compute the retained size yourself, but use this value instead.\n+  retainedSize: number,\n+  /// The modules that are referenced by this module.\n+  /// Modules could be referenced by \\`import\\`, \\`require\\`, \\`new URL\\`, etc.\n+  /// Beware cycles in the module graph. You can avoid that by only walking edges with a bigger \\`depth\\` value than the current module.\n+  references: ModuleReference[],\n+  /// The modules that reference this module.\n+  /// Beware cycles in the module graph. \n+  /// You can use this to walk up the graph up to the root. When doing this only walk edges with a smaller \\`depth\\` value than the current module.\n+  incomingReferences: ModuleReference[],\n+}\n+\n+interface ModuleReference {\n+  /// The referenced/referencing module.\n+  module: Module\n+  /// The thing that is used from the module.\n+  /// export {name}: The named export that is used.\n+  /// evaluation: Imported for side effects only.\n+  /// all: All exports and the side effects.\n+  export: \"evaluation\" | \"all\" | \\`export \\${string}\\`\n+  /// How this reference affects chunking of the module.\n+  /// hoisted | sync: The module is placed in the same chunk group as the referencing module.\n+  /// hoisted: The module is loaded before all \"sync\" modules.\n+  /// async: The module forms a separate chunk group which is loaded asynchronously.\n+  /// isolated: The module forms a separate chunk group which is loaded as separate entry. When it has a name, all modules imported with this name are placed in the same chunk group.\n+  /// shared: The module forms a separate chunk group which is loaded before the current chunk group. When it has a name, all modules imported with this name are placed in the same chunk group.\n+  /// traced: The module is not bundled, but the graph is still traced and all modules are included unbundled.\n+  chunkingType: \"hoisted\" | \"sync\" | \"async\" | \"isolated\" | \\`isolated \\${string}\\` | \"shared\" | \\`shared \\${string}\\` | \"traced\"\n+}\n+\n+// The following global variables are available in the query:\n+\n+/// The entries of the module graph.\n+/// Note that this only includes the entrypoints of the module graph and not all modules.\n+/// You need to traverse it recursively to find not only children, but also grandchildren (resp, grandparents).\n+/// Prefer to use \\`modules\\` over \\`entries\\` as it contains all modules, not only the entrypoints.\n+const entries: Module[]\n+\n+/// All modules in the module graph.\n+/// Note that this array already contains all the modules as flat list.\n+/// Make sure to iterate over this array and not only consider the first one.\n+/// Prefer to use \\`modules\\` over \\`entries\\` as it contains all modules, not only the entrypoints.\n+const modules: Module[]\n+\n+const console: {\n+  /// Logs a message to the console.\n+  /// The message will be returned in the response.\n+  /// The message can be a string or any other value that can be inspected.\n+  log: (...data: any[]) => void\n+}\n+\\`\\`\\`\n+`\n+\n+async function measureAndHandleErrors(\n+  name: string,\n+  fn: () => Promise<CallToolResult['content']>\n+): Promise<CallToolResult> {\n+  const start = performance.now()\n+  let content: CallToolResult['content'] = []\n+  try {\n+    content = await fn()\n+  } catch (error) {\n+    content.push({\n+      type: 'text',\n+      text: `Error: ${error instanceof Error ? error.stack : String(error)}`,\n+    })\n+    content.push({\n+      type: 'text',\n+      text: 'Fix the error and try again.',\n+    })\n+  }\n+  const duration = performance.now() - start\n+  const formatDurationText =\n+    duration > 2000\n+      ? `${Math.round(duration / 100) / 10}s`\n+      : `${Math.round(duration)}ms`\n+  Log.event(`MCP ${name} in ${formatDurationText}`)\n+  return {\n+    content,\n+  }\n+}\n+\n+function invariant(value: never, errorMessage: (value: any) => string): never {\n+  throw new Error(errorMessage(value))\n+}\n+\n+function styledStringToMarkdown(\n+  styledString: StyledString | undefined\n+): string {\n+  if (!styledString) {\n+    return ''\n+  }\n+  switch (styledString.type) {\n+    case 'text':\n+      return styledString.value\n+    case 'strong':\n+      return `*${styledString.value}*`\n+    case 'code':\n+      return `\\`${styledString.value}\\``\n+    case 'line':\n+      return styledString.value.map(styledStringToMarkdown).join('')\n+    case 'stack':\n+      return styledString.value.map(styledStringToMarkdown).join('\\n\\n')\n+    default:\n+      invariant(styledString, (s) => `Unknown styled string type: ${s.type}`)\n+  }\n+}\n+\n+function indent(str: string, spaces: number = 2): string {\n+  const indentStr = ' '.repeat(spaces)\n+  return `${indentStr}${str.replace(/\\n/g, `\\n${indentStr}`)}`\n+}\n+\n+function issueToString(issue: Issue & { route: string }): string {\n+  return [\n+    `${issue.severity} in ${issue.stage} on ${issue.route}`,\n+    `File Path: ${issue.filePath}`,\n+    issue.source &&\n+      `Source:\n+  ${issue.source.source.ident}\n+  ${issue.source.range ? `Range: ${issue.source.range?.start.line}:${issue.source.range?.start.column} - ${issue.source.range?.end.line}:${issue.source.range?.end.column}` : 'Unknown range'}\n+`,\n+    `Title: ${styledStringToMarkdown(issue.title)}`,\n+    issue.description &&\n+      `Description:\n+${indent(styledStringToMarkdown(issue.description))}`,\n+    issue.detail &&\n+      `Details:\n+${indent(styledStringToMarkdown(issue.detail))}`,\n+    issue.documentationLink && `Documentation: ${issue.documentationLink}`,\n+    issue.importTraces &&\n+      issue.importTraces.length > 0 &&\n+      formatImportTraces(issue.importTraces),\n+  ]\n+    .filter(Boolean)\n+    .join('\\n')\n+}\n+\n+function issuesReference(issues: Issue[]): { type: 'text'; text: string } {\n+  if (issues.length === 0) {\n+    return {\n+      type: 'text',\n+      text: 'Note: There are no issues.',\n+    }\n+  }\n+\n+  const countBySeverity = new Map()\n+\n+  for (const issue of issues) {\n+    const count = countBySeverity.get(issue.severity) || 0\n+    countBySeverity.set(issue.severity, count + 1)\n+  }\n+\n+  const text = [\n+    `Note: There are ${issues.length} issues in total, with the following severities: ${Array.from(\n+      countBySeverity.entries()\n+    )\n+      .map(([severity, count]) => `${count} x ${severity}`)\n+      .join(', ')}.`,\n+  ]\n+\n+  return {\n+    type: 'text',\n+    text: text.join('\\n'),\n+  }\n+}\n+\n+function routeToTitle(route: Route): string {\n+  switch (route.type) {\n+    case 'page':\n+      return 'A page using Pages Router.'\n+    case 'app-page':\n+      return `A page using App Router. Original names: ${route.pages.map((page) => page.originalName).join(', ')}.`\n+    case 'page-api':\n+      return 'An API route using Pages Router.'\n+    case 'app-route':\n+      return `A route using App Router. Original name: ${route.originalName}.`\n+    case 'conflict':\n+      return 'Multiple routes conflict on this path. This is an error in the folder structure.'\n+    default:\n+      invariant(route, (r) => `Unknown route type: ${r.type}`)\n+  }\n+}\n+\n+function routeToEndpoints(route: Route): Endpoint[] {\n+  switch (route.type) {\n+    case 'page':\n+      return [route.htmlEndpoint]\n+    case 'app-page':\n+      return route.pages.map((p) => p.htmlEndpoint)\n+    case 'page-api':\n+      return [route.endpoint]\n+    case 'app-route':\n+      return [route.endpoint]\n+    case 'conflict':\n+      return []\n+    default:\n+      invariant(route, (r) => `Unknown route type: ${r.type}`)\n+  }\n+}\n+\n+function arrayOrSingle<T>(value: T | T[]): T[] {\n+  return Array.isArray(value) ? value : [value]\n+}\n+\n+interface ModuleReference {\n+  module: Module\n+  export: string\n+  chunkingType: string\n+}\n+interface Module {\n+  /// The identifier of the module, which is a unique string.\n+  ident: string\n+  /// The path of the module. It's not unique as multiple modules can have the same path.\n+  path: string\n+  /// The distance to the entries of the module graph. Use this to traverse the graph in the right direction.\n+  depth: number\n+  /// The size of the source code of the module in bytes.\n+  size: number\n+  /// The size of the whole subgraph behind this module in bytes.\n+  retainedSize: number\n+  /// The modules that are referenced by this module.\n+  references: ModuleReference[]\n+  /// The modules that reference this module.\n+  incomingReferences: ModuleReference[]\n+}\n+\n+function createModuleObject(rawModule: NapiModuleInfo): Module {\n+  return {\n+    ident: rawModule.ident,\n+    path: rawModule.path,\n+    depth: rawModule.depth,\n+    size: rawModule.size,\n+    retainedSize: rawModule.retainedSize,\n+    references: [],\n+    incomingReferences: [],\n+  }\n+}\n+\n+function processModuleGraphSnapshot(\n+  moduleGraph: NapiModuleGraphSnapshot,\n+  modules: Module[],\n+  entries: Module[]\n+) {\n+  const queryModules = moduleGraph.modules.map(createModuleObject)\n+  for (let i = 0; i < queryModules.length; i++) {\n+    const rawModule = moduleGraph.modules[i]\n+    const queryModule = queryModules[i]\n+\n+    queryModule.references = rawModule.references.map(\n+      (ref: NapiModuleReference) => ({\n+        module: queryModules[ref.index],\n+        export: ref.export,\n+        chunkingType: ref.chunkingType,\n+      })\n+    )\n+    queryModule.incomingReferences = rawModule.incomingReferences.map(\n+      (ref: NapiModuleReference) => ({\n+        module: queryModules[ref.index],\n+        export: ref.export,\n+        chunkingType: ref.chunkingType,\n+      })\n+    )\n+    modules.push(queryModule)\n+  }\n+  for (const entry of moduleGraph.entries) {\n+    const queryModule = queryModules[entry]\n+    entries.push(queryModule)\n+  }\n+}\n+\n+function runQuery(\n+  query: string,\n+  modules: Module[],\n+  entries: Module[]\n+): CallToolResult['content'] {\n+  const response: CallToolResult['content'] = []\n+  const proto = {\n+    modules,\n+    entries,\n+    console: {\n+      log: (...data: any[]) => {\n+        response.push({\n+          type: 'text',\n+          text: data\n+            .map((item) =>\n+              typeof item === 'string' ? item : inspect(item, false, 2, false)\n+            )\n+            .join(' '),\n+        })\n+      },\n+    },\n+  }\n+  const contextObject = Object.create(proto)\n+  contextObject.global = contextObject\n+  contextObject.self = contextObject\n+  contextObject.globalThis = contextObject\n+  runInNewContext(query, contextObject, {\n+    displayErrors: true,\n+    filename: 'query.js',\n+    timeout: 20000,\n+    contextName: 'Query Context',\n+  })\n+  for (const [key, value] of Object.entries(contextObject)) {\n+    if (typeof value === 'function') continue\n+    if (key === 'global' || key === 'self' || key === 'globalThis') continue\n+    response.push({\n+      type: 'text',\n+      text: `Global variable \\`${key}\\` = ${inspect(value, false, 2, false)}`,\n+    })\n+  }\n+  return response\n+}\n+\n+const ROUTES_DESCRIPTION =\n+  'The routes from which to query the module graph. Can be a single string or an array of strings.'\n+export function createMcpServer(\n+  hotReloader: NextJsHotReloaderInterface\n+): McpServer | undefined {\n+  const turbopack = hotReloader.turbopackProject\n+  if (!turbopack) return undefined\n+  const server = new McpServer({\n+    name: 'next.js',\n+    version: '1.0.0',\n+    instructions: `This is a running next.js dev server with Turbopack.\n+You can use the Model Context Protocol to query information about pages and modules and their relations.`,\n+  })\n+\n+  server.registerTool(\n+    'entrypoints',\n+    {\n+      title: 'Entrypoints',\n+      description:\n+        'Get all entrypoints of a Turbopack project, which are all pages, routes and the middleware.',\n+    },\n+    async () =>\n+      measureAndHandleErrors('entrypoints', async () => {\n+        let entrypoints = await turbopack.getEntrypoints()\n+\n+        const list = []\n+\n+        for (const [key, route] of entrypoints.routes.entries()) {\n+          list.push(`\\`${key}\\` (${routeToTitle(route)})`)\n+        }\n+\n+        if (entrypoints.middleware) {\n+          list.push('Middleware')\n+        }\n+\n+        if (entrypoints.instrumentation) {\n+          list.push('Instrumentation')\n+        }\n+\n+        const content: CallToolResult['content'] = [\n+          issuesReference(entrypoints.issues),\n+          {\n+            type: 'text',\n+            text: `These are the routes of the application:\n+\n+${list.map((e) => `- ${e}`).join('\\n')}`,\n+          },\n+        ]\n+        return content\n+      })\n+  )\n+\n+  server.registerTool(\n+    'query-routes-module-graph',\n+    {\n+      title: 'Query module graph of routes',\n+      description: 'Query details about the module graph of routes.',\n+      inputSchema: {\n+        routes: z\n+          .union([z.string(), z.array(z.string())])\n+          .describe(ROUTES_DESCRIPTION),\n+        query: z.string().describe(QUERY_DESCRIPTION),\n+      },\n+    },\n+    async ({ routes, query }) =>\n+      measureAndHandleErrors(\n+        `module graph query on ${arrayOrSingle(routes).join(', ')}`,\n+        async () => {\n+          const entrypoints = await turbopack.getEntrypoints()\n+          const endpoints = []\n+          for (const route of arrayOrSingle(routes)) {\n+            const routeInfo = entrypoints.routes.get(route)\n+            if (!routeInfo) {\n+              throw new Error(`Route ${route} not found`)\n+            }\n+            endpoints.push(...routeToEndpoints(routeInfo))\n+          }\n+          const issues = []\n+          const modules: Module[] = []\n+          const entries: Module[] = []\n+\n+          for (const endpoint of endpoints) {\n+            const result = await endpoint.moduleGraphs()\n+            issues.push(...result.issues)\n+            const moduleGraphs = result.moduleGraphs\n+            for (const moduleGraph of moduleGraphs) {\n+              processModuleGraphSnapshot(moduleGraph, modules, entries)\n+            }\n+          }\n+          const content: CallToolResult['content'] = []\n+          content.push(issuesReference(issues))\n+          const response = runQuery(query, modules, entries)\n+          content.push(...response)\n+          return content\n+        }\n+      )\n+  )\n+\n+  server.registerTool(\n+    'query-module-graph',\n+    {\n+      title: 'Query whole app module graph',\n+      description:\n+        'Query details about the module graph the whole application. This is a expensive operation and should only be used when module graph of the whole application is needed.',\n+      inputSchema: {\n+        query: z.string().describe(QUERY_DESCRIPTION),\n+      },\n+    },\n+    async ({ query }) =>\n+      measureAndHandleErrors(`whole app module graph query`, async () => {\n+        const moduleGraph = await turbopack.moduleGraph()\n+        const issues = moduleGraph.issues\n+        const modules: Module[] = []\n+        const entries: Module[] = []\n+        processModuleGraphSnapshot(moduleGraph, modules, entries)\n+        const content: CallToolResult['content'] = []\n+        content.push(issuesReference(issues))\n+        const response = runQuery(query, modules, entries)\n+        content.push(...response)\n+        return content\n+      })\n+  )\n+\n+  server.registerTool(\n+    'query-issues',\n+    {\n+      title: 'Query issues of routes',\n+      description:\n+        'Query issues (errors, warnings, lints, etc.) that are reported on routes.',\n+      inputSchema: {\n+        routes: z\n+          .union([z.string(), z.array(z.string())])\n+          .describe(ROUTES_DESCRIPTION),\n+        page: z\n+          .optional(z.number())\n+          .describe(\n+            'Issues are paginated when there are more than 50 issues. The first page is number 0.'\n+          ),\n+      },\n+    },\n+    async ({ routes, page }) =>\n+      measureAndHandleErrors(\n+        `issues on ${arrayOrSingle(routes).join(', ')}`,\n+        async () => {\n+          const entrypoints = await turbopack.getEntrypoints()\n+          const issues = []\n+          for (const route of arrayOrSingle(routes)) {\n+            const routeInfo = entrypoints.routes.get(route)\n+            if (!routeInfo) {\n+              throw new Error(`Route ${route} not found`)\n+            }\n+            for (const endpoint of routeToEndpoints(routeInfo)) {\n+              const result = await endpoint.moduleGraphs()\n+              for (const issue of result.issues) {\n+                const issuesWithRoute = issue as Issue & { route: string }\n+                issuesWithRoute.route = route\n+                issues.push(issuesWithRoute)\n+              }\n+            }\n+          }\n+          const severitiesArray = [\n+            'bug',\n+            'fatal',\n+            'error',\n+            'warning',\n+            'hint',\n+            'note',\n+            'suggestion',\n+            'info',\n+          ]\n+          const severities = new Map(\n+            severitiesArray.map((severity, index) => [severity, index])\n+          )\n+          issues.sort((a, b) => {\n+            const severityA = severities.get(a.severity)\n+            const severityB = severities.get(b.severity)\n+            if (severityA !== undefined && severityB !== undefined) {\n+              return severityA - severityB\n+            }\n+            return 0\n+          })\n+\n+          const content: CallToolResult['content'] = []\n+          content.push(issuesReference(issues))\n+          page = page ?? 0\n+          const currentPage = issues.slice(page * 50, (page + 1) * 50)\n+          for (const issue of currentPage) {\n+            content.push({\n+              type: 'text',\n+              text: issueToString(issue),\n+            })\n+          }\n+          if (issues.length >= (page + 1) * 50) {\n+            content.push({\n+              type: 'text',\n+              text: `Note: There are more issues available. Use the \\`page\\` parameter to query the next page.`,\n+            })\n+          }\n+\n+          return content\n+        }\n+      )\n+  )\n+\n+  return server\n+}"
        },
        {
            "sha": "33d7d3b2722e107fc947b81e932872942330b56c",
            "filename": "packages/next/src/server/lib/router-utils/setup-dev-bundler.ts",
            "status": "modified",
            "additions": 107,
            "deletions": 0,
            "changes": 107,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -85,6 +85,8 @@ import { getDefineEnv } from '../../../build/define-env'\n import { TurbopackInternalError } from '../../../shared/lib/turbopack/internal-error'\n import { normalizePath } from '../../../lib/normalize-path'\n import { JSON_CONTENT_TYPE_HEADER } from '../../../lib/constants'\n+import { parseBody } from '../../api-utils/node/parse-body'\n+import { timingSafeEqual } from 'crypto'\n \n export type SetupOpts = {\n   renderServer: LazyRenderServerInstance\n@@ -969,9 +971,114 @@ async function startWatcher(\n   const devTurbopackMiddlewareManifestPath = `/_next/${CLIENT_STATIC_FILES_PATH}/development/${TURBOPACK_CLIENT_MIDDLEWARE_MANIFEST}`\n   opts.fsChecker.devVirtualFsItems.add(devTurbopackMiddlewareManifestPath)\n \n+  const mcpPath = `/_next/mcp`\n+  opts.fsChecker.devVirtualFsItems.add(mcpPath)\n+\n+  let mcpSecret = process.env.NEXT_EXPERIMENTAL_MCP_SECRET\n+    ? Buffer.from(process.env.NEXT_EXPERIMENTAL_MCP_SECRET)\n+    : undefined\n+\n+  if (mcpSecret) {\n+    try {\n+      // eslint-disable-next-line import/no-extraneous-dependencies\n+      require('@modelcontextprotocol/sdk/package.json')\n+    } catch (error) {\n+      Log.error(\n+        'To use the MCP server, please install the `@modelcontextprotocol/sdk` package.'\n+      )\n+      mcpSecret = undefined\n+    }\n+  }\n+  let createMcpServer: typeof import('./mcp').createMcpServer | undefined\n+  let StreamableHTTPServerTransport:\n+    | typeof import('./mcp').StreamableHTTPServerTransport\n+    | undefined\n+  if (mcpSecret) {\n+    ;({ createMcpServer, StreamableHTTPServerTransport } =\n+      require('./mcp') as typeof import('./mcp'))\n+    Log.info(\n+      `Experimental MCP server is available at: /_next/mcp?${mcpSecret.toString()}`\n+    )\n+  }\n+\n   async function requestHandler(req: IncomingMessage, res: ServerResponse) {\n     const parsedUrl = url.parse(req.url || '/')\n \n+    if (parsedUrl.pathname?.includes(mcpPath)) {\n+      function sendMcpInternalError(message: string) {\n+        res.statusCode = 500\n+        res.setHeader('Content-Type', 'application/json; charset=utf-8')\n+        res.end(\n+          JSON.stringify({\n+            jsonrpc: '2.0',\n+            error: {\n+              // \"Internal error\" see https://www.jsonrpc.org/specification\n+              code: -32603,\n+              message,\n+            },\n+            id: null,\n+          })\n+        )\n+        return { finished: true }\n+      }\n+      if (!mcpSecret) {\n+        Log.error('Next.js MCP server is not enabled')\n+        Log.info(\n+          'To enable it, set the NEXT_EXPERIMENTAL_MCP_SECRET environment variable to a secret value. This will make the MCP server available at /_next/mcp?{NEXT_EXPERIMENTAL_MCP_SECRET}'\n+        )\n+        return sendMcpInternalError(\n+          'Missing NEXT_EXPERIMENTAL_MCP_SECRET environment variable'\n+        )\n+      }\n+      if (!createMcpServer || !StreamableHTTPServerTransport) {\n+        return sendMcpInternalError(\n+          'Model Context Protocol (MCP) server is not available'\n+        )\n+      }\n+      if (!parsedUrl.query) {\n+        Log.error('No MCP secret provided in request query')\n+        Log.info(\n+          `Experimental MCP server is available at: /_next/mcp?${mcpSecret.toString()}`\n+        )\n+        return sendMcpInternalError('No MCP secret provided in request query')\n+      }\n+      let mcpSecretQuery = Buffer.from(parsedUrl.query)\n+      if (\n+        mcpSecretQuery.length !== mcpSecret.length ||\n+        !timingSafeEqual(mcpSecretQuery, mcpSecret)\n+      ) {\n+        Log.error('Invalid MCP secret provided in request query')\n+        Log.info(\n+          `Experimental MCP server is available at: /_next/mcp?${mcpSecret.toString()}`\n+        )\n+        return sendMcpInternalError(\n+          'Invalid MCP secret provided in request query'\n+        )\n+      }\n+\n+      const server = createMcpServer(hotReloader)\n+      if (server) {\n+        try {\n+          const transport = new StreamableHTTPServerTransport({\n+            sessionIdGenerator: undefined,\n+          })\n+          res.on('close', () => {\n+            transport.close()\n+            server.close()\n+          })\n+          await server.connect(transport)\n+          const parsedBody = await parseBody(req, 1024 * 1024 * 1024)\n+          await transport.handleRequest(req, res, parsedBody)\n+        } catch (error) {\n+          Log.error('Error handling MCP request:', error)\n+          if (!res.headersSent) {\n+            return sendMcpInternalError('Internal server error')\n+          }\n+        }\n+        return { finished: true }\n+      }\n+    }\n+\n     if (parsedUrl.pathname?.includes(clientPagesManifestPath)) {\n       res.statusCode = 200\n       res.setHeader('Content-Type', JSON_CONTENT_TYPE_HEADER)"
        },
        {
            "sha": "22ca4707f06cfbe3983abd5797def154f654b5c4",
            "filename": "packages/next/src/shared/lib/turbopack/utils.ts",
            "status": "modified",
            "additions": 35,
            "deletions": 30,
            "changes": 65,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fturbopack%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fturbopack%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fturbopack%2Futils.ts?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -185,43 +185,48 @@ export function formatIssue(issue: Issue) {\n \n   if (importTraces?.length) {\n     // This is the same logic as in turbopack/crates/turbopack-cli-utils/src/issue.rs\n-    // We end up with multiple traces when the file with the error is reachable from multiple\n-    // different entry points (e.g. ssr, client)\n-    message += `Import trace${importTraces.length > 1 ? 's' : ''}:\\n`\n-    const everyTraceHasADistinctRootLayer =\n-      new Set(importTraces.map(leafLayerName).filter((l) => l != null)).size ===\n-      importTraces.length\n-    for (let i = 0; i < importTraces.length; i++) {\n-      const trace = importTraces[i]\n-      const layer = leafLayerName(trace)\n-      let traceIndent = '    '\n-      // If this is true, layer must be present\n-      if (everyTraceHasADistinctRootLayer) {\n-        message += `  ${layer}:\\n`\n-      } else {\n-        if (importTraces.length > 1) {\n-          // Otherwise use simple 1 based indices to disambiguate\n-          message += `  #${i + 1}`\n-          if (layer) {\n-            message += ` [${layer}]`\n-          }\n-          message += ':\\n'\n-        } else if (layer) {\n-          message += ` [${layer}]:\\n`\n-        } else {\n-          // If there is a single trace and no layer name just don't indent it.\n-          traceIndent = '  '\n-        }\n-      }\n-      message += formatIssueTrace(trace, traceIndent, !identicalLayers(trace))\n-    }\n+    message += formatImportTraces(importTraces)\n   }\n   if (documentationLink) {\n     message += documentationLink + '\\n\\n'\n   }\n   return message\n }\n \n+export function formatImportTraces(importTraces: PlainTraceItem[][]) {\n+  // We end up with multiple traces when the file with the error is reachable from multiple\n+  // different entry points (e.g. ssr, client)\n+  let message = `Import trace${importTraces.length > 1 ? 's' : ''}:\\n`\n+  const everyTraceHasADistinctRootLayer =\n+    new Set(importTraces.map(leafLayerName).filter((l) => l != null)).size ===\n+    importTraces.length\n+  for (let i = 0; i < importTraces.length; i++) {\n+    const trace = importTraces[i]\n+    const layer = leafLayerName(trace)\n+    let traceIndent = '    '\n+    // If this is true, layer must be present\n+    if (everyTraceHasADistinctRootLayer) {\n+      message += `  ${layer}:\\n`\n+    } else {\n+      if (importTraces.length > 1) {\n+        // Otherwise use simple 1 based indices to disambiguate\n+        message += `  #${i + 1}`\n+        if (layer) {\n+          message += ` [${layer}]`\n+        }\n+        message += ':\\n'\n+      } else if (layer) {\n+        message += ` [${layer}]:\\n`\n+      } else {\n+        // If there is a single trace and no layer name just don't indent it.\n+        traceIndent = '  '\n+      }\n+    }\n+    message += formatIssueTrace(trace, traceIndent, !identicalLayers(trace))\n+  }\n+  return message\n+}\n+\n /** Returns the first present layer name in the trace */\n function leafLayerName(items: PlainTraceItem[]): string | undefined {\n   for (const item of items) {"
        },
        {
            "sha": "8f4b7178314f7c26eca091e8e0b62066c8fe6d02",
            "filename": "pnpm-lock.yaml",
            "status": "modified",
            "additions": 416,
            "deletions": 0,
            "changes": 416,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/pnpm-lock.yaml",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/pnpm-lock.yaml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/pnpm-lock.yaml?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -1039,6 +1039,9 @@ importers:\n       '@jest/types':\n         specifier: 29.5.0\n         version: 29.5.0\n+      '@modelcontextprotocol/sdk':\n+        specifier: 1.15.1\n+        version: 1.15.1\n       '@mswjs/interceptors':\n         specifier: 0.23.0\n         version: 0.23.0\n@@ -4424,6 +4427,10 @@ packages:\n       '@types/react': 19.1.8\n       react: 19.2.0-canary-7513996f-20250722\n \n+  '@modelcontextprotocol/sdk@1.15.1':\n+    resolution: {integrity: sha512-W/XlN9c528yYn+9MQkVjxiTPgPxoxt+oczfjHBDsJx0+59+O7B75Zhsp0B16Xbwbz8ANISDajh6+V7nIcPMc5w==}\n+    engines: {node: '>=18'}\n+\n   '@module-federation/error-codes@0.15.0':\n     resolution: {integrity: sha512-CFJSF+XKwTcy0PFZ2l/fSUpR4z247+Uwzp1sXVkdIfJ/ATsnqf0Q01f51qqSEA6MYdQi6FKos9FIcu3dCpQNdg==}\n \n@@ -6188,6 +6195,10 @@ packages:\n     resolution: {integrity: sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==}\n     engines: {node: '>= 0.6'}\n \n+  accepts@2.0.0:\n+    resolution: {integrity: sha512-5cvg6CtKwfgdmVqY1WIiXKc3Q1bkRqGLi+2W/6ao+6Y7gu/RCwRuAhGEzh5B4KlszSuTLgZYuqFqo5bImjNKng==}\n+    engines: {node: '>= 0.6'}\n+\n   acorn-globals@7.0.1:\n     resolution: {integrity: sha512-umOSDSDrfHbTNPuNpC2NSnnA3LUrqpevPb4T9jRx4MagXNS0rs+gwiTcAvqCRmsD6utzsrzNt+ebm00SNWiC3Q==}\n \n@@ -6791,6 +6802,10 @@ packages:\n     resolution: {integrity: sha512-7rAxByjUMqQ3/bHJy7D6OGXvx/MMc4IqBn/X0fcM1QUcAItpZrBEYhWGem+tzXH90c+G01ypMcYJBO9Y30203g==}\n     engines: {node: '>= 0.8', npm: 1.2.8000 || >= 1.4.16}\n \n+  body-parser@2.2.0:\n+    resolution: {integrity: sha512-02qvAaxv8tp7fBa/mw1ga98OGm+eCbqzJOKoRt70sLmfEEi+jyBYVTDGfCL/k06/4EMk/z01gCe7HoCH/f2LTg==}\n+    engines: {node: '>=18'}\n+\n   bonjour-service@1.3.0:\n     resolution: {integrity: sha512-3YuAUiSkWykd+2Azjgyxei8OWf8thdn8AITIog2M4UICzoqfjlqr64WIjEXZllf/W6vK1goqleSR6brGomxQqA==}\n \n@@ -6942,13 +6957,21 @@ packages:\n     resolution: {integrity: sha512-kpqOvwXnjjN44D89K5ccQC+RUrsy7jB/XLlRrx0D7/2HNcTPqzsb6XgYoErwko6QsV184CA2YgS1fxDiiDZMWA==}\n     engines: {node: '>=8'}\n \n+  call-bind-apply-helpers@1.0.2:\n+    resolution: {integrity: sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==}\n+    engines: {node: '>= 0.4'}\n+\n   call-bind@1.0.2:\n     resolution: {integrity: sha512-7O+FbCihrB5WGbFYesctwmTKae6rOiIzmz1icreWJ+0aA7LJfuqhEso2T9ncpcFtzMQtzXf2QGGueWJGTYsqrA==}\n \n   call-bind@1.0.7:\n     resolution: {integrity: sha512-GHTSNSYICQ7scH7sZ+M2rFopRoLh8t2bLSW6BbgrtLsahOIB5iyAVJf9GjWK3cYTDaMj4XdBpM1cA6pIS0Kv2w==}\n     engines: {node: '>= 0.4'}\n \n+  call-bound@1.0.4:\n+    resolution: {integrity: sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==}\n+    engines: {node: '>= 0.4'}\n+\n   caller-callsite@2.0.0:\n     resolution: {integrity: sha512-JuG3qI4QOftFsZyOn1qq87fq5grLIyk1JYd5lJmdA+fG7aQ9pA/i3JIJGcO3q0MrRcHlOt1U+ZeHW8Dq9axALQ==}\n     engines: {node: '>=4'}\n@@ -7446,6 +7469,10 @@ packages:\n     resolution: {integrity: sha512-FveZTNuGw04cxlAiWbzi6zTAL/lhehaWbTtgluJh4/E95DqMwTmha3KZN1aAWA8cFIhHzMZUvLevkw5Rqk+tSQ==}\n     engines: {node: '>= 0.6'}\n \n+  content-disposition@1.0.0:\n+    resolution: {integrity: sha512-Au9nRL8VNUut/XSzbQA38+M78dzP4D+eqg3gfJHMIHHYa3bg067xj1KxMUWj+VULbiZMowKngFFbKczUrNJ1mg==}\n+    engines: {node: '>= 0.6'}\n+\n   content-type@1.0.4:\n     resolution: {integrity: sha512-hIP3EEPs8tB9AT1L+NUqtwOAps4mk2Zob89MWXMHjHWg9milF/j4osnnQLXBCBFBk/tvIG/tUc9mOUJiPBhPXA==}\n     engines: {node: '>= 0.6'}\n@@ -7498,6 +7525,10 @@ packages:\n   cookie-signature@1.0.6:\n     resolution: {integrity: sha512-QADzlaHc8icV8I7vbaJXJwod9HWYp8uCqf1xa4OfNu1T7JVxQIrUgOWtHdNDtPiywmFbiS12VjotIXLrKM3orQ==}\n \n+  cookie-signature@1.2.2:\n+    resolution: {integrity: sha512-D76uU73ulSXrD1UXF4KE2TMxVVwhsnCgfAyTg9k8P6KGZjlXKrOLe4dJQKI3Bxi5wjesZoFXJWElNWBjPZMbhg==}\n+    engines: {node: '>=6.6.0'}\n+\n   cookie@0.4.0:\n     resolution: {integrity: sha512-+Hp8fLp57wnUSt0tY0tHEXh4voZRDnoIrZPqlo3DPiI4y9lwg/jqx+1Om94/W6ZaPDOUbnjOt/99w66zk+l1Xg==}\n     engines: {node: '>= 0.6'}\n@@ -8506,6 +8537,10 @@ packages:\n   downsample-lttb@0.0.1:\n     resolution: {integrity: sha512-Olebo5gyh44OAXTd2BKdcbN5VaZOIKFzoeo9JUFwxDlGt6Sd8fUo6SKaLcafy8aP2UrsKmWDpsscsFEghMjeZA==}\n \n+  dunder-proto@1.0.1:\n+    resolution: {integrity: sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==}\n+    engines: {node: '>= 0.4'}\n+\n   duplexer3@0.1.4:\n     resolution: {integrity: sha512-CEj8FwwNA4cVH2uFCoHUrmojhYh1vmCdOaneKJXwkeY1i9jnlslVo9dx+hQ5Hl9GnH/Bwy/IjxAyOePyPKYnzA==}\n \n@@ -8653,6 +8688,10 @@ packages:\n     resolution: {integrity: sha512-jxayLKShrEqqzJ0eumQbVhTYQM27CfT1T35+gCgDFoL82JLsXqTJ76zv6A0YLOgEnLUMvLzsDsGIrl8NFpT2gQ==}\n     engines: {node: '>= 0.4'}\n \n+  es-define-property@1.0.1:\n+    resolution: {integrity: sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==}\n+    engines: {node: '>= 0.4'}\n+\n   es-errors@1.3.0:\n     resolution: {integrity: sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==}\n     engines: {node: '>= 0.4'}\n@@ -8671,6 +8710,10 @@ packages:\n     resolution: {integrity: sha512-MZ4iQ6JwHOBQjahnjwaC1ZtIBH+2ohjamzAO3oaHcXYup7qxjF2fixyH+Q71voWHeOkI2q/TnJao/KfXYIZWbw==}\n     engines: {node: '>= 0.4'}\n \n+  es-object-atoms@1.1.1:\n+    resolution: {integrity: sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==}\n+    engines: {node: '>= 0.4'}\n+\n   es-set-tostringtag@2.0.3:\n     resolution: {integrity: sha512-3T8uNMC3OQTHkFUsFq8r/BwAXLHvU/9O9mE0fBc/MY5iq/8H7ncvO947LmYA6ldWw9Uh8Yhf25zu6n7nML5QWQ==}\n     engines: {node: '>= 0.4'}\n@@ -9057,6 +9100,14 @@ packages:\n     resolution: {integrity: sha512-mQw+2fkQbALzQ7V0MY0IqdnXNOeTtP4r0lN9z7AAawCXgqea7bDii20AYrIBrFd/Hx0M2Ocz6S111CaFkUcb0Q==}\n     engines: {node: '>=0.8.x'}\n \n+  eventsource-parser@3.0.3:\n+    resolution: {integrity: sha512-nVpZkTMM9rF6AQ9gPJpFsNAMt48wIzB5TQgiTLdHiuO8XEDhUgZEhqKlZWXbIzo9VmJ/HvysHqEaVeD5v9TPvA==}\n+    engines: {node: '>=20.0.0'}\n+\n+  eventsource@3.0.7:\n+    resolution: {integrity: sha512-CRT1WTyuQoD771GW56XEZFQ/ZoSfWid1alKGDYMmkt2yl8UXrVR4pspqWNEcqKvVIzg6PAltWjxcSSPrboA4iA==}\n+    engines: {node: '>=18.0.0'}\n+\n   evp_bytestokey@1.0.3:\n     resolution: {integrity: sha512-/f2Go4TognH/KvCISP7OUsHn85hT9nUkxxA9BEWxFn+Oj9o8ZNLm/40hdlgSLyuOimsrTKLUMEorQexp/aPQeA==}\n \n@@ -9110,6 +9161,12 @@ packages:\n     resolution: {integrity: sha512-WVi2V4iHKw/vHEyye00Q9CSZz7KHDbJkJyteUI8kTih9jiyMl3bIk7wLYFcY9D1Blnadlyb5w5NBuNjQBow99g==}\n     engines: {node: ^16.10.0 || ^18.12.0 || >=20.0.0}\n \n+  express-rate-limit@7.5.1:\n+    resolution: {integrity: sha512-7iN8iPMDzOMHPUYllBEsQdWVB6fPDMPqwjBaFrgr4Jgr/+okjvzAy+UHlYYL/Vs0OsOrMkwS6PJDkFlJwoxUnw==}\n+    engines: {node: '>= 16'}\n+    peerDependencies:\n+      express: '>= 4.11'\n+\n   express@4.17.0:\n     resolution: {integrity: sha512-1Z7/t3Z5ZnBG252gKUPyItc4xdeaA0X934ca2ewckAsVsw9EG71i++ZHZPYnus8g/s5Bty8IMpSVEuRkmwwPRQ==}\n     engines: {node: '>= 0.10.0'}\n@@ -9118,6 +9175,10 @@ packages:\n     resolution: {integrity: sha512-28HqgMZAmih1Czt9ny7qr6ek2qddF4FclbMzwhCREB6OFfH+rXAnuNCwo1/wFvrtbgsQDb4kSbX9de9lFbrXnA==}\n     engines: {node: '>= 0.10.0'}\n \n+  express@5.1.0:\n+    resolution: {integrity: sha512-DT9ck5YIRU+8GYzzU5kT3eHGA5iL+1Zd0EutOmTE9Dtk+Tvuzd23VBU+ec7HPNSTxXYO55gPV/hq4pSBJDjFpA==}\n+    engines: {node: '>= 18'}\n+\n   ext@1.6.0:\n     resolution: {integrity: sha512-sdBImtzkq2HpkdRLtlLWDa6w4DX22ijZLKx8BMPUuKe1c5lbN6xwQDQCxSfxBQnHZ13ls/FH0MQZx/q/gr6FQg==}\n \n@@ -9253,6 +9314,10 @@ packages:\n     resolution: {integrity: sha512-6BN9trH7bp3qvnrRyzsBz+g3lZxTNZTbVO2EV1CS0WIcDbawYVdYvGflME/9QP0h0pYlCDBCTjYa9nZzMDpyxQ==}\n     engines: {node: '>= 0.8'}\n \n+  finalhandler@2.1.0:\n+    resolution: {integrity: sha512-/t88Ty3d5JWQbWYgaOGCCYfXRwV1+be02WqYYlL6h0lEiUAMPM8o8qKGO01YIkOHzka2up08wvgYD0mDiI+q3Q==}\n+    engines: {node: '>= 0.8'}\n+\n   find-cache-dir@2.1.0:\n     resolution: {integrity: sha512-Tq6PixE0w/VMFfCgbONnkiQIVol/JJL7nRMi20fqzA4NRs9AfeqMGeRdPi3wIhYkxjeBaWh2rxwapn5Tu3IqOQ==}\n     engines: {node: '>=6'}\n@@ -9402,6 +9467,10 @@ packages:\n     resolution: {integrity: sha512-zJ2mQYM18rEFOudeV4GShTGIQ7RbzA7ozbU9I/XBpm7kqgMywgmylMwXHxZJmkVoYkna9d2pVXVXPdYTP9ej8Q==}\n     engines: {node: '>= 0.6'}\n \n+  fresh@2.0.0:\n+    resolution: {integrity: sha512-Rx/WycZ60HOaqLKAi6cHRKKI7zxWbJ31MhntmtwMoaTeF7XFH9hhBp8vITaMidfljRQ6eYWCKkaTK+ykVJHP2A==}\n+    engines: {node: '>= 0.8'}\n+\n   from@0.1.7:\n     resolution: {integrity: sha512-twe20eF1OxVxp/ML/kq2p1uc6KvFK/+vs8WjEbeKmV2He22MKm7YF2ANIt+EOqhJ5L3K/SuuPhk0hWQDjOM23g==}\n \n@@ -9504,6 +9573,10 @@ packages:\n     resolution: {integrity: sha512-5uYhsJH8VJBTv7oslg4BznJYhDoRI6waYCxMmCdnTrcCrHA/fCFKoTFz2JKKE0HdDFUF7/oQuhzumXJK7paBRQ==}\n     engines: {node: '>= 0.4'}\n \n+  get-intrinsic@1.3.0:\n+    resolution: {integrity: sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==}\n+    engines: {node: '>= 0.4'}\n+\n   get-nonce@1.0.1:\n     resolution: {integrity: sha512-FJhYRoDaiatfEkUK8HKlicmu/3SGFD51q3itKDGoSTysQJBnfOcxU5GxnhE1E6soB76MbT0MBtnKJuXyAx+96Q==}\n     engines: {node: '>=6'}\n@@ -9523,6 +9596,10 @@ packages:\n     resolution: {integrity: sha512-g/Q1aTSDOxFpchXC4i8ZWvxA1lnPqx/JHqcpIw0/LX9T8x/GBbi6YnlN5nhaKIFkT8oFsscUKgDJYxfwfS6QsQ==}\n     engines: {node: '>=8'}\n \n+  get-proto@1.0.1:\n+    resolution: {integrity: sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==}\n+    engines: {node: '>= 0.4'}\n+\n   get-stdin@4.0.1:\n     resolution: {integrity: sha512-F5aQMywwJ2n85s4hJPTT9RPxGmubonuB10MNYo17/xph174n2MIR33HRguhzVag10O/npM7SPk73LMZNP+FaWw==}\n     engines: {node: '>=0.10.0'}\n@@ -9705,6 +9782,10 @@ packages:\n   gopd@1.0.1:\n     resolution: {integrity: sha512-d65bNlIadxvpb/A2abVdlqKqV563juRnZ1Wtk6s1sIR8uNsXR70xqIzVqxVf1eTqDunwT2MkczEeaezCKTZhwA==}\n \n+  gopd@1.2.0:\n+    resolution: {integrity: sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==}\n+    engines: {node: '>= 0.4'}\n+\n   got@7.1.0:\n     resolution: {integrity: sha512-Y5WMo7xKKq1muPsxD+KmrR8DH5auG7fBdDVueZwETwV6VytKyU9OX/ddpq2/1hp1vIPvVb4T81dKQz3BivkNLw==}\n     engines: {node: '>=4'}\n@@ -9804,6 +9885,10 @@ packages:\n     resolution: {integrity: sha512-l3LCuF6MgDNwTDKkdYGEihYjt5pRPbEg46rtlmnSPlUbgmB8LOIrKJbYYFBSbnPaJexMKtiPO8hmeRjRz2Td+A==}\n     engines: {node: '>= 0.4'}\n \n+  has-symbols@1.1.0:\n+    resolution: {integrity: sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==}\n+    engines: {node: '>= 0.4'}\n+\n   has-to-string-tag-x@1.4.1:\n     resolution: {integrity: sha512-vdbKfmw+3LoOYVr+mtxHaX5a96+0f3DljYd8JOqvOLsf5mw2Otda2qCDT9qRqLAhrjyQ0h7ual5nOiASpsGNFw==}\n \n@@ -10564,6 +10649,9 @@ packages:\n   is-potential-custom-element-name@1.0.1:\n     resolution: {integrity: sha512-bCYeRA2rVibKZd+s2625gGnGF/t7DSqDs4dP7CrLA1m7jKWz6pps0LpYLJN8Q64HtmPKJ1hrN3nzPNKFEKOUiQ==}\n \n+  is-promise@4.0.0:\n+    resolution: {integrity: sha512-hvpoI6korhJMnej285dSg6nu1+e6uxs7zG3BYAm5byqDsgJNWwxzM6z6iZiAgQR4TJ30JmBTOwqZUw3WlyH3AQ==}\n+\n   is-reference@1.2.1:\n     resolution: {integrity: sha512-U82MsXXiFIrjCK4otLT+o2NA2Cd2g5MLoOVXUZjIOhLurrRxpEXzI8O0KZHr3IjLvlAH1kTPYSuqer5T9ZVBKQ==}\n \n@@ -11605,6 +11693,10 @@ packages:\n     resolution: {integrity: sha512-WWC0ZuMzCyDHYCasEGs4IPvLyTGftYwh6wIEOULOF0HXcqZlhwRzrK0w2VUlxWA98xnvb/jszw4ZSkJ6ADpM6Q==}\n     engines: {node: '>=0.10.0'}\n \n+  math-intrinsics@1.1.0:\n+    resolution: {integrity: sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==}\n+    engines: {node: '>= 0.4'}\n+\n   maximatch@0.1.0:\n     resolution: {integrity: sha512-9ORVtDUFk4u/NFfo0vG/ND/z7UQCVZBL539YW0+U1I7H1BkZwizcPx5foFv7LCPcBnm2U6RjFnQOsIvN4/Vm2A==}\n     engines: {node: '>=0.10.0'}\n@@ -11710,6 +11802,10 @@ packages:\n     resolution: {integrity: sha512-dq+qelQ9akHpcOl/gUVRTxVIOkAJ1wR3QAvb4RsVjS8oVoFjDGTc679wJYmUmknUF5HwMLOgb5O+a3KxfWapPQ==}\n     engines: {node: '>= 0.6'}\n \n+  media-typer@1.1.0:\n+    resolution: {integrity: sha512-aisnrDP4GNe06UcKFnV5bfMNPBUw4jsLGaWwWfnH3v02GnBuXX2MCVn5RbrWo0j3pczUilYblq7fQ7Nw2t5XKw==}\n+    engines: {node: '>= 0.8'}\n+\n   memfs@3.5.3:\n     resolution: {integrity: sha512-UERzLsxzllchadvbPs5aolHh65ISpKpM+ccLbOJ8/vvpBKmAWf+la7dXFy7Mr0ySHbdHrFv5kGFCUHHe6GFEmw==}\n     engines: {node: '>= 4.0.0'}\n@@ -11743,6 +11839,10 @@ packages:\n   merge-descriptors@1.0.3:\n     resolution: {integrity: sha512-gaNvAS7TZ897/rVaZ0nMtAyxNyi/pdbjbAwUpFQpN70GqnVfOiXpeUUMKRBmzXaSQ8DdTX4/0ms62r2K+hE6mQ==}\n \n+  merge-descriptors@2.0.0:\n+    resolution: {integrity: sha512-Snk314V5ayFLhp3fkUREub6WtjBfPdCPY1Ln8/8munuLuiYhsABgBVWsozAG+MWMbVEvcdcpbi9R7ww22l9Q3g==}\n+    engines: {node: '>=18'}\n+\n   merge-stream@2.0.0:\n     resolution: {integrity: sha512-abv/qOcuPfk3URPfDzmZU1LKmuw8kT+0nIHvKrKgFrwifol/doWcdA4ZqsWQ8ENrFKkd67Mfpo/LovbIUsbt3w==}\n \n@@ -11978,6 +12078,10 @@ packages:\n     resolution: {integrity: sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==}\n     engines: {node: '>= 0.6'}\n \n+  mime-db@1.54.0:\n+    resolution: {integrity: sha512-aU5EJuIN2WDemCcAp2vFBfp/m4EAhWJnUNSSw0ixs7/kXbd6Pg64EmwJkNdFhB8aWt1sH2CTXrLxo/iAGV3oPQ==}\n+    engines: {node: '>= 0.6'}\n+\n   mime-types@2.1.18:\n     resolution: {integrity: sha512-lc/aahn+t4/SWV/qcmumYjymLsWfN3ELhpmVuUFjgsORruuZPVSwAQryq+HHGvO/SI2KVX26bx+En+zhM8g8hQ==}\n     engines: {node: '>= 0.6'}\n@@ -11986,6 +12090,10 @@ packages:\n     resolution: {integrity: sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==}\n     engines: {node: '>= 0.6'}\n \n+  mime-types@3.0.1:\n+    resolution: {integrity: sha512-xRc4oEhT6eaBpU1XF7AjpOFD+xQmXNB5OVKwp4tqCuBpHLS/ZbBDrc07mYTDqVMg6PfxUjjNp85O6Cd2Z/5HWA==}\n+    engines: {node: '>= 0.6'}\n+\n   mime@1.6.0:\n     resolution: {integrity: sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==}\n     engines: {node: '>=4'}\n@@ -12240,6 +12348,10 @@ packages:\n     resolution: {integrity: sha512-+EUsqGPLsM+j/zdChZjsnX51g4XrHFOIXwfnCVPGlQk/k5giakcKsuxCObBRu6DSm9opw/O6slWbJdghQM4bBg==}\n     engines: {node: '>= 0.6'}\n \n+  negotiator@1.0.0:\n+    resolution: {integrity: sha512-8Ofs/AUQh8MaEcrlq5xOX0CQ9ypTF5dl78mjlMNfOK08fzpgTHQRQPBxcPlEtIw0yRpws+Zo/3r+5WRby7u3Gg==}\n+    engines: {node: '>= 0.6'}\n+\n   neo-async@2.6.1:\n     resolution: {integrity: sha512-iyam8fBuCUpWeKPGpaNMetEocMt364qkCsfL9JuhjXX6dRnguRVOfk2GZaDpPjcOKiiXCPINZC1GczQ7iTq3Zw==}\n \n@@ -12503,6 +12615,10 @@ packages:\n     resolution: {integrity: sha512-IRZSRuzJiynemAXPYtPe5BoI/RESNYR7TYm50MC5Mqbd3Jmw5y790sErYw3V6SryFJD64b74qQQs9wn5Bg/k3g==}\n     engines: {node: '>= 0.4'}\n \n+  object-inspect@1.13.4:\n+    resolution: {integrity: sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew==}\n+    engines: {node: '>= 0.4'}\n+\n   object-is@1.0.2:\n     resolution: {integrity: sha512-Epah+btZd5wrrfjkJZq1AOB9O6OxUQto45hzFd7lXGrpHPGE0W1k+426yrZV+k6NJOzLNNW/nVsmZdIWsAqoOQ==}\n     engines: {node: '>= 0.4'}\n@@ -12941,6 +13057,10 @@ packages:\n   path-to-regexp@6.3.0:\n     resolution: {integrity: sha512-Yhpw4T9C6hPpgPeA28us07OJeqZ5EzQTkbfwuhsUg0c237RomFoETJgmp2sa3F/41gfLE6G5cqcYwznmeEeOlQ==}\n \n+  path-to-regexp@8.2.0:\n+    resolution: {integrity: sha512-TdrF7fW9Rphjq4RjrW0Kp2AW0Ahwu9sRGTkS6bvDi0SCwZlEZYmcfDbEsTz8RVk0EHIS/Vd1bv3JhG+1xZuAyQ==}\n+    engines: {node: '>=16'}\n+\n   path-type@1.1.0:\n     resolution: {integrity: sha512-S4eENJz1pkiQn9Znv33Q+deTOKmbl+jj1Fl+qiP/vYezj+S8x+J3Uo0ISrx/QoEvIlOaDWJhPaRd1flJ9HXZqg==}\n     engines: {node: '>=0.10.0'}\n@@ -13046,6 +13166,10 @@ packages:\n     resolution: {integrity: sha512-ugJ4Imy92u55zeznaN/5d7iqOBIZjZ7q10/T+dcd0IuFtbLlsGDvAUabFu1cafER+G9f0T1WtTqvzm4KAdcDgQ==}\n     engines: {node: '>=4.0.0', npm: '>=1.2.10'}\n \n+  pkce-challenge@5.0.0:\n+    resolution: {integrity: sha512-ueGLflrrnvwB3xuo/uGob5pd5FN7l0MsLf0Z87o/UQmRtwjvfylfc9MurIxRAWywCYTgrvpXBcqjV4OfCYGCIQ==}\n+    engines: {node: '>=16.20.0'}\n+\n   pkg-dir@3.0.0:\n     resolution: {integrity: sha512-/E57AYkoeQ25qkxMj5PBOVgF8Kiu/h7cYS30Z5+R7WaiCCBfLq58ZI/dSeaEKb9WVJV5n/03QwrN3IeWIFllvw==}\n     engines: {node: '>=6'}\n@@ -13993,6 +14117,10 @@ packages:\n     resolution: {integrity: sha512-EJPeIn0CYrGu+hli1xilKAPXODtJ12T0sP63Ijx2/khC2JtuaN3JyNIpvmnkmaEtha9ocbG4A4cMcr+TvqvwQg==}\n     engines: {node: '>=0.6'}\n \n+  qs@6.14.0:\n+    resolution: {integrity: sha512-YWWTjgABSKcvs/nWBi9PycY/JiPJqOD4JA6o9Sej2AtvSGarXxKC3OQSk4pAarbdQlKAh5D4FCQkJNkW+GAn3w==}\n+    engines: {node: '>=0.6'}\n+\n   qs@6.5.2:\n     resolution: {integrity: sha512-N5ZAX4/LxJmF+7wN74pUD6qAh9/wnvdQcjq9TZjevvXzSUo7bfmw91saqMjzGS2xq91/odN2dW/WOl7qQHNDGA==}\n     engines: {node: '>=0.6'}\n@@ -14067,6 +14195,10 @@ packages:\n     resolution: {integrity: sha512-8zGqypfENjCIqGhgXToC8aB2r7YrBX+AQAfIPs/Mlk+BtPTztOvTS01NRW/3Eh60J+a48lt8qsCzirQ6loCVfA==}\n     engines: {node: '>= 0.8'}\n \n+  raw-body@3.0.0:\n+    resolution: {integrity: sha512-RmkhL8CAyCRPXCE28MMH0z2PNWQBNk2Q09ZdxM9IOOXwxwZbN+qbWaatPkdkWIKL2ZVDImrN/pK5HTRz2PcS4g==}\n+    engines: {node: '>= 0.8'}\n+\n   rc@1.2.8:\n     resolution: {integrity: sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw==}\n     hasBin: true\n@@ -14667,6 +14799,10 @@ packages:\n     engines: {node: '>=18.0.0', npm: '>=8.0.0'}\n     hasBin: true\n \n+  router@2.2.0:\n+    resolution: {integrity: sha512-nLTrUKm2UyiL7rlhapu/Zl45FwNgkZGaCpZbIHajDYgwlJCOzLSk+cIPAnsEqV955GjILJnKbdQC1nVPz+gAYQ==}\n+    engines: {node: '>= 18'}\n+\n   run-applescript@7.0.0:\n     resolution: {integrity: sha512-9by4Ij99JUr/MCFBUkDKLWK3G9HVXmabKz9U5MlIAIuvuzkiOicRYs8XJLxX+xahD+mLiiCYDqF9dKAgtzKP1A==}\n     engines: {node: '>=18'}\n@@ -14853,6 +14989,10 @@ packages:\n     resolution: {integrity: sha512-dW41u5VfLXu8SJh5bwRmyYUbAoSB3c9uQh6L8h/KtsFREPWpbX1lrljJo186Jc4nmci/sGUZ9a0a0J2zgfq2hw==}\n     engines: {node: '>= 0.8.0'}\n \n+  send@1.2.0:\n+    resolution: {integrity: sha512-uaW0WwXKpL9blXE2o0bRhoL2EGXIrZxQ2ZQ4mgcfoBxdFmQold+qWsD2jLrfZ0trjKL6vOw0j//eAwcALFjKSw==}\n+    engines: {node: '>= 18'}\n+\n   sentence-case@3.0.4:\n     resolution: {integrity: sha512-8LS0JInaQMCRoQ7YUytAo/xUu5W2XnQxV2HI/6uM6U7CITS1RqPElr30V6uIqyMKM9lJGRVFy5/4CuzcixNYSg==}\n \n@@ -14880,6 +15020,10 @@ packages:\n     resolution: {integrity: sha512-VqpjJZKadQB/PEbEwvFdO43Ax5dFBZ2UECszz8bQ7pi7wt//PWe1P6MN7eCnjsatYtBT6EuiClbjSWP2WrIoTw==}\n     engines: {node: '>= 0.8.0'}\n \n+  serve-static@2.2.0:\n+    resolution: {integrity: sha512-61g9pCh0Vnh7IutZjtLGGpTA355+OPn2TyDv/6ivP2h/AdAVX9azsoxmg2/M6nZeQZNYBEwIcsne1mJd9oQItQ==}\n+    engines: {node: '>= 18'}\n+\n   server-only@0.0.1:\n     resolution: {integrity: sha512-qepMx2JxAa5jjfzxG79yPPq+8BuFToHd1hm7kI+Z4zAq1ftQiP7HcxMhDDItrbtwVeLg/cY2JnKnrcFkmiswNA==}\n \n@@ -14946,10 +15090,26 @@ packages:\n     engines: {node: '>=4'}\n     hasBin: true\n \n+  side-channel-list@1.0.0:\n+    resolution: {integrity: sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA==}\n+    engines: {node: '>= 0.4'}\n+\n+  side-channel-map@1.0.1:\n+    resolution: {integrity: sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA==}\n+    engines: {node: '>= 0.4'}\n+\n+  side-channel-weakmap@1.0.2:\n+    resolution: {integrity: sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A==}\n+    engines: {node: '>= 0.4'}\n+\n   side-channel@1.0.6:\n     resolution: {integrity: sha512-fDW/EZ6Q9RiO8eFG8Hj+7u/oW+XrPTIChwCOM2+th2A6OblDtYYIpve9m+KvI9Z4C9qSEXlaGR6bTEYHReuglA==}\n     engines: {node: '>= 0.4'}\n \n+  side-channel@1.1.0:\n+    resolution: {integrity: sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw==}\n+    engines: {node: '>= 0.4'}\n+\n   siginfo@2.0.0:\n     resolution: {integrity: sha512-ybx0WO1/8bSBLEWXZvEd7gMW3Sn3JFlW3TvX1nREbDLRNQNaeNN8WK0meBwPdAaOI7TtRRRJn/Es1zhrrCHu7g==}\n \n@@ -15989,6 +16149,10 @@ packages:\n     resolution: {integrity: sha512-TkRKr9sUTxEH8MdfuCSP7VizJyzRNMjj2J2do2Jr3Kym598JVdEksuzPQCnlFPW4ky9Q+iA+ma9BGm06XQBy8g==}\n     engines: {node: '>= 0.6'}\n \n+  type-is@2.0.1:\n+    resolution: {integrity: sha512-OZs6gsjF4vMp32qrCbiVSkrFmXtG/AZhY3t0iAMrMBiAZyV9oALtXO8hsrHbMXF9x6L3grlFuwW2oAz7cav+Gw==}\n+    engines: {node: '>= 0.6'}\n+\n   type@1.2.0:\n     resolution: {integrity: sha512-+5nt5AAniqsCnu2cEQQdpzCAh33kVx8n0VoFidKpB1dVVLAN/F+bgVOqOJqOnEnrhp222clB5p3vUlD+1QAnfg==}\n \n@@ -16976,6 +17140,11 @@ packages:\n   yoga-wasm-web@0.3.3:\n     resolution: {integrity: sha512-N+d4UJSJbt/R3wqY7Coqs5pcV0aUj2j9IaQ3rNj9bVCLld8tTGKRa2USARjnvZJWVx1NDmQev8EknoczaOQDOA==}\n \n+  zod-to-json-schema@3.24.6:\n+    resolution: {integrity: sha512-h/z3PKvcTcTetyjl1fkj79MHNEjm+HpD6NXheWjzOekY7kV+lwDYnHw+ivHkijnCSMz1yJaWBD9vu/Fcmk+vEg==}\n+    peerDependencies:\n+      zod: ^3.24.1\n+\n   zod-validation-error@3.4.0:\n     resolution: {integrity: sha512-ZOPR9SVY6Pb2qqO5XHt+MkkTRxGXb4EVtnjc9JpXUOtUB1T9Ru7mZOT361AN3MsetVe7R0a1KZshJDZdgp9miQ==}\n     engines: {node: '>=18.0.0'}\n@@ -20118,6 +20287,23 @@ snapshots:\n       '@types/react': 19.1.8\n       react: 19.2.0-canary-7513996f-20250722\n \n+  '@modelcontextprotocol/sdk@1.15.1':\n+    dependencies:\n+      ajv: 6.12.6\n+      content-type: 1.0.5\n+      cors: 2.8.5\n+      cross-spawn: 7.0.6\n+      eventsource: 3.0.7\n+      eventsource-parser: 3.0.3\n+      express: 5.1.0\n+      express-rate-limit: 7.5.1(express@5.1.0)\n+      pkce-challenge: 5.0.0\n+      raw-body: 3.0.0\n+      zod: 3.25.76\n+      zod-to-json-schema: 3.24.6(zod@3.25.76)\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   '@module-federation/error-codes@0.15.0': {}\n \n   '@module-federation/runtime-core@0.15.0':\n@@ -22359,6 +22545,11 @@ snapshots:\n       mime-types: 2.1.35\n       negotiator: 0.6.3\n \n+  accepts@2.0.0:\n+    dependencies:\n+      mime-types: 3.0.1\n+      negotiator: 1.0.0\n+\n   acorn-globals@7.0.1:\n     dependencies:\n       acorn: 8.14.0\n@@ -23030,6 +23221,20 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  body-parser@2.2.0:\n+    dependencies:\n+      bytes: 3.1.2\n+      content-type: 1.0.5\n+      debug: 4.4.0\n+      http-errors: 2.0.0\n+      iconv-lite: 0.6.3\n+      on-finished: 2.4.1\n+      qs: 6.14.0\n+      raw-body: 3.0.0\n+      type-is: 2.0.1\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   bonjour-service@1.3.0:\n     dependencies:\n       fast-deep-equal: 3.1.3\n@@ -23224,6 +23429,11 @@ snapshots:\n       package-hash: 4.0.0\n       write-file-atomic: 3.0.3\n \n+  call-bind-apply-helpers@1.0.2:\n+    dependencies:\n+      es-errors: 1.3.0\n+      function-bind: 1.1.2\n+\n   call-bind@1.0.2:\n     dependencies:\n       function-bind: 1.1.2\n@@ -23237,6 +23447,11 @@ snapshots:\n       get-intrinsic: 1.2.4\n       set-function-length: 1.2.2\n \n+  call-bound@1.0.4:\n+    dependencies:\n+      call-bind-apply-helpers: 1.0.2\n+      get-intrinsic: 1.3.0\n+\n   caller-callsite@2.0.0:\n     dependencies:\n       callsites: 2.0.0\n@@ -23781,6 +23996,10 @@ snapshots:\n     dependencies:\n       safe-buffer: 5.2.1\n \n+  content-disposition@1.0.0:\n+    dependencies:\n+      safe-buffer: 5.2.1\n+\n   content-type@1.0.4: {}\n \n   content-type@1.0.5: {}\n@@ -23857,6 +24076,8 @@ snapshots:\n \n   cookie-signature@1.0.6: {}\n \n+  cookie-signature@1.2.2: {}\n+\n   cookie@0.4.0: {}\n \n   cookie@0.4.1: {}\n@@ -24985,6 +25206,12 @@ snapshots:\n \n   downsample-lttb@0.0.1: {}\n \n+  dunder-proto@1.0.1:\n+    dependencies:\n+      call-bind-apply-helpers: 1.0.2\n+      es-errors: 1.3.0\n+      gopd: 1.2.0\n+\n   duplexer3@0.1.4: {}\n \n   duplexer@0.1.1: {}\n@@ -25187,6 +25414,8 @@ snapshots:\n     dependencies:\n       get-intrinsic: 1.2.4\n \n+  es-define-property@1.0.1: {}\n+\n   es-errors@1.3.0: {}\n \n   es-get-iterator@1.1.3:\n@@ -25224,6 +25453,10 @@ snapshots:\n     dependencies:\n       es-errors: 1.3.0\n \n+  es-object-atoms@1.1.1:\n+    dependencies:\n+      es-errors: 1.3.0\n+\n   es-set-tostringtag@2.0.3:\n     dependencies:\n       get-intrinsic: 1.2.4\n@@ -25973,6 +26206,12 @@ snapshots:\n \n   events@3.3.0: {}\n \n+  eventsource-parser@3.0.3: {}\n+\n+  eventsource@3.0.7:\n+    dependencies:\n+      eventsource-parser: 3.0.3\n+\n   evp_bytestokey@1.0.3:\n     dependencies:\n       md5.js: 1.3.5\n@@ -26073,6 +26312,10 @@ snapshots:\n       jest-mock: 30.0.0-alpha.6\n       jest-util: 30.0.0-alpha.6\n \n+  express-rate-limit@7.5.1(express@5.1.0):\n+    dependencies:\n+      express: 5.1.0\n+\n   express@4.17.0:\n     dependencies:\n       accepts: 1.3.7\n@@ -26144,6 +26387,38 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  express@5.1.0:\n+    dependencies:\n+      accepts: 2.0.0\n+      body-parser: 2.2.0\n+      content-disposition: 1.0.0\n+      content-type: 1.0.5\n+      cookie: 0.7.1\n+      cookie-signature: 1.2.2\n+      debug: 4.4.0\n+      encodeurl: 2.0.0\n+      escape-html: 1.0.3\n+      etag: 1.8.1\n+      finalhandler: 2.1.0\n+      fresh: 2.0.0\n+      http-errors: 2.0.0\n+      merge-descriptors: 2.0.0\n+      mime-types: 3.0.1\n+      on-finished: 2.4.1\n+      once: 1.4.0\n+      parseurl: 1.3.3\n+      proxy-addr: 2.0.7\n+      qs: 6.14.0\n+      range-parser: 1.2.1\n+      router: 2.2.0\n+      send: 1.2.0\n+      serve-static: 2.2.0\n+      statuses: 2.0.1\n+      type-is: 2.0.1\n+      vary: 1.1.2\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   ext@1.6.0:\n     dependencies:\n       type: 2.5.0\n@@ -26311,6 +26586,17 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  finalhandler@2.1.0:\n+    dependencies:\n+      debug: 4.4.0\n+      encodeurl: 2.0.0\n+      escape-html: 1.0.3\n+      on-finished: 2.4.1\n+      parseurl: 1.3.3\n+      statuses: 2.0.1\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   find-cache-dir@2.1.0:\n     dependencies:\n       commondir: 1.0.1\n@@ -26492,6 +26778,8 @@ snapshots:\n \n   fresh@0.5.2: {}\n \n+  fresh@2.0.0: {}\n+\n   from@0.1.7: {}\n \n   fromentries@1.3.2: {}\n@@ -26606,6 +26894,19 @@ snapshots:\n       has-symbols: 1.0.3\n       hasown: 2.0.2\n \n+  get-intrinsic@1.3.0:\n+    dependencies:\n+      call-bind-apply-helpers: 1.0.2\n+      es-define-property: 1.0.1\n+      es-errors: 1.3.0\n+      es-object-atoms: 1.1.1\n+      function-bind: 1.1.2\n+      get-proto: 1.0.1\n+      gopd: 1.2.0\n+      has-symbols: 1.1.0\n+      hasown: 2.0.2\n+      math-intrinsics: 1.1.0\n+\n   get-nonce@1.0.1: {}\n \n   get-package-type@0.1.0: {}\n@@ -26622,6 +26923,11 @@ snapshots:\n \n   get-port@5.1.1: {}\n \n+  get-proto@1.0.1:\n+    dependencies:\n+      dunder-proto: 1.0.1\n+      es-object-atoms: 1.1.1\n+\n   get-stdin@4.0.1: {}\n \n   get-stream@3.0.0: {}\n@@ -26874,6 +27180,8 @@ snapshots:\n     dependencies:\n       get-intrinsic: 1.2.4\n \n+  gopd@1.2.0: {}\n+\n   got@7.1.0:\n     dependencies:\n       '@types/keyv': 3.1.1\n@@ -26978,6 +27286,8 @@ snapshots:\n \n   has-symbols@1.0.3: {}\n \n+  has-symbols@1.1.0: {}\n+\n   has-to-string-tag-x@1.4.1:\n     dependencies:\n       has-symbol-support-x: 1.4.2\n@@ -27794,6 +28104,8 @@ snapshots:\n \n   is-potential-custom-element-name@1.0.1: {}\n \n+  is-promise@4.0.0: {}\n+\n   is-reference@1.2.1:\n     dependencies:\n       '@types/estree': 1.0.7\n@@ -29202,6 +29514,8 @@ snapshots:\n \n   markdown-extensions@1.1.1: {}\n \n+  math-intrinsics@1.1.0: {}\n+\n   maximatch@0.1.0:\n     dependencies:\n       array-differ: 1.0.0\n@@ -29469,6 +29783,8 @@ snapshots:\n \n   media-typer@0.3.0: {}\n \n+  media-typer@1.1.0: {}\n+\n   memfs@3.5.3:\n     dependencies:\n       fs-monkey: 1.0.6\n@@ -29531,6 +29847,8 @@ snapshots:\n \n   merge-descriptors@1.0.3: {}\n \n+  merge-descriptors@2.0.0: {}\n+\n   merge-stream@2.0.0: {}\n \n   merge2@1.4.1: {}\n@@ -30102,6 +30420,8 @@ snapshots:\n \n   mime-db@1.52.0: {}\n \n+  mime-db@1.54.0: {}\n+\n   mime-types@2.1.18:\n     dependencies:\n       mime-db: 1.33.0\n@@ -30110,6 +30430,10 @@ snapshots:\n     dependencies:\n       mime-db: 1.52.0\n \n+  mime-types@3.0.1:\n+    dependencies:\n+      mime-db: 1.54.0\n+\n   mime@1.6.0: {}\n \n   mime@2.5.2: {}\n@@ -30332,6 +30656,8 @@ snapshots:\n \n   negotiator@0.6.3: {}\n \n+  negotiator@1.0.0: {}\n+\n   neo-async@2.6.1: {}\n \n   neo-async@2.6.2: {}\n@@ -30662,6 +30988,8 @@ snapshots:\n \n   object-inspect@1.13.2: {}\n \n+  object-inspect@1.13.4: {}\n+\n   object-is@1.0.2: {}\n \n   object-is@1.1.6:\n@@ -31174,6 +31502,8 @@ snapshots:\n \n   path-to-regexp@6.3.0: {}\n \n+  path-to-regexp@8.2.0: {}\n+\n   path-type@1.1.0:\n     dependencies:\n       graceful-fs: 4.2.11\n@@ -31260,6 +31590,8 @@ snapshots:\n       postcss: 7.0.32\n       reduce-css-calc: 2.1.7\n \n+  pkce-challenge@5.0.0: {}\n+\n   pkg-dir@3.0.0:\n     dependencies:\n       find-up: 3.0.0\n@@ -32256,6 +32588,10 @@ snapshots:\n     dependencies:\n       side-channel: 1.0.6\n \n+  qs@6.14.0:\n+    dependencies:\n+      side-channel: 1.1.0\n+\n   qs@6.5.2: {}\n \n   qs@6.7.0: {}\n@@ -32320,6 +32656,13 @@ snapshots:\n       iconv-lite: 0.4.24\n       unpipe: 1.0.0\n \n+  raw-body@3.0.0:\n+    dependencies:\n+      bytes: 3.1.2\n+      http-errors: 2.0.0\n+      iconv-lite: 0.6.3\n+      unpipe: 1.0.0\n+\n   rc@1.2.8:\n     dependencies:\n       deep-extend: 0.6.0\n@@ -33153,6 +33496,16 @@ snapshots:\n       fsevents: 2.3.3\n     optional: true\n \n+  router@2.2.0:\n+    dependencies:\n+      debug: 4.4.0\n+      depd: 2.0.0\n+      is-promise: 4.0.0\n+      parseurl: 1.3.3\n+      path-to-regexp: 8.2.0\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   run-applescript@7.0.0: {}\n \n   run-async@2.4.1: {}\n@@ -33361,6 +33714,22 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  send@1.2.0:\n+    dependencies:\n+      debug: 4.4.0\n+      encodeurl: 2.0.0\n+      escape-html: 1.0.3\n+      etag: 1.8.1\n+      fresh: 2.0.0\n+      http-errors: 2.0.0\n+      mime-types: 3.0.1\n+      ms: 2.1.3\n+      on-finished: 2.4.1\n+      range-parser: 1.2.1\n+      statuses: 2.0.1\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   sentence-case@3.0.4:\n     dependencies:\n       no-case: 3.0.4\n@@ -33419,6 +33788,15 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  serve-static@2.2.0:\n+    dependencies:\n+      encodeurl: 2.0.0\n+      escape-html: 1.0.3\n+      parseurl: 1.3.3\n+      send: 1.2.0\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   server-only@0.0.1: {}\n \n   set-blocking@2.0.0: {}\n@@ -33508,13 +33886,41 @@ snapshots:\n       interpret: 1.4.0\n       rechoir: 0.6.2\n \n+  side-channel-list@1.0.0:\n+    dependencies:\n+      es-errors: 1.3.0\n+      object-inspect: 1.13.4\n+\n+  side-channel-map@1.0.1:\n+    dependencies:\n+      call-bound: 1.0.4\n+      es-errors: 1.3.0\n+      get-intrinsic: 1.3.0\n+      object-inspect: 1.13.4\n+\n+  side-channel-weakmap@1.0.2:\n+    dependencies:\n+      call-bound: 1.0.4\n+      es-errors: 1.3.0\n+      get-intrinsic: 1.3.0\n+      object-inspect: 1.13.4\n+      side-channel-map: 1.0.1\n+\n   side-channel@1.0.6:\n     dependencies:\n       call-bind: 1.0.7\n       es-errors: 1.3.0\n       get-intrinsic: 1.2.4\n       object-inspect: 1.13.2\n \n+  side-channel@1.1.0:\n+    dependencies:\n+      es-errors: 1.3.0\n+      object-inspect: 1.13.4\n+      side-channel-list: 1.0.0\n+      side-channel-map: 1.0.1\n+      side-channel-weakmap: 1.0.2\n+\n   siginfo@2.0.0:\n     optional: true\n \n@@ -34638,6 +35044,12 @@ snapshots:\n       media-typer: 0.3.0\n       mime-types: 2.1.35\n \n+  type-is@2.0.1:\n+    dependencies:\n+      content-type: 1.0.5\n+      media-typer: 1.1.0\n+      mime-types: 3.0.1\n+\n   type@1.2.0: {}\n \n   type@2.5.0: {}\n@@ -35891,6 +36303,10 @@ snapshots:\n \n   yoga-wasm-web@0.3.3: {}\n \n+  zod-to-json-schema@3.24.6(zod@3.25.76):\n+    dependencies:\n+      zod: 3.25.76\n+\n   zod-validation-error@3.4.0(zod@3.25.76):\n     dependencies:\n       zod: 3.25.76"
        },
        {
            "sha": "c844ef54957fa379468d0b0746fce0b524c95dbc",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/mod.rs",
            "status": "modified",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/b7a97a059877c525ebac41e5d0647e71e5dbb44c/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b7a97a059877c525ebac41e5d0647e71e5dbb44c/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs?ref=b7a97a059877c525ebac41e5d0647e71e5dbb44c",
            "patch": "@@ -1221,6 +1221,23 @@ impl ModuleGraph {\n         Ok(idx)\n     }\n \n+    pub async fn entries(&self) -> Result<Vec<ResolvedVc<Box<dyn Module>>>> {\n+        Ok(self\n+            .get_graphs()\n+            .await?\n+            .iter()\n+            .flat_map(|g| g.entries.iter())\n+            .flat_map(|e| e.entries())\n+            .collect())\n+    }\n+\n+    pub async fn has_entry(&self, entry: ResolvedVc<Box<dyn Module>>) -> Result<bool> {\n+        let graphs = self.get_graphs().await?;\n+        Ok(graphs\n+            .iter()\n+            .any(|graph| graph.modules.contains_key(&entry)))\n+    }\n+\n     /// Traverses all reachable edges exactly once and calls the visitor with the edge source and\n     /// target.\n     ///"
        }
    ],
    "stats": {
        "total": 1890,
        "additions": 1820,
        "deletions": 70
    }
}