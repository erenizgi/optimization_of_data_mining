{
    "author": "huozhi",
    "message": "[devtool] fix duplicate rendered indicator on server (#81729)\n\nThere're should be only one indicator rendered when `showIndicator` state is true, the previous condition is not correct since the previous change seem causing indicator always rendered even on SSR. since devtool bundle is also bundled on ssr layer, but the related code should not get executed. We noticed the previous condition will always render the indicator, which likely triggered some `base-ui` browser code to execute on server and crash on windows.\r\n\r\nRelated #81722",
    "sha": "96b31f8e678bfe2c259a96b97d35632373bced38",
    "files": [
        {
            "sha": "4b6476e1ec7c30bc637d415969cf4a44f5b16b58",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/devtools-indicator.css",
            "status": "added",
            "additions": 145,
            "deletions": 0,
            "changes": 145,
            "blob_url": "https://github.com/vercel/next.js/blob/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.css",
            "raw_url": "https://github.com/vercel/next.js/raw/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.css?ref=96b31f8e678bfe2c259a96b97d35632373bced38",
            "patch": "@@ -0,0 +1,145 @@\n+[data-nextjs-toast] {\n+  &[data-hidden='true'] {\n+    display: none;\n+  }\n+}\n+\n+.dev-tools-indicator-menu {\n+  -webkit-font-smoothing: antialiased;\n+  display: flex;\n+  flex-direction: column;\n+  align-items: flex-start;\n+  background: var(--color-background-100);\n+  border: 1px solid var(--color-gray-alpha-400);\n+  background-clip: padding-box;\n+  box-shadow: var(--shadow-menu);\n+  border-radius: var(--rounded-xl);\n+  position: absolute;\n+  font-family: var(--font-stack-sans);\n+  z-index: 3;\n+  overflow: hidden;\n+  opacity: 0;\n+  outline: 0;\n+  min-width: 248px;\n+  transition: opacity var(--animate-out-duration-ms)\n+    var(--animate-out-timing-function);\n+\n+  &[data-rendered='true'] {\n+    opacity: 1;\n+    scale: 1;\n+  }\n+}\n+\n+.dev-tools-indicator-inner {\n+  padding: 6px;\n+  width: 100%;\n+}\n+\n+.dev-tools-indicator-item {\n+  display: flex;\n+  align-items: center;\n+  padding: 8px 6px;\n+  height: var(--size-36);\n+  border-radius: 6px;\n+  text-decoration: none !important;\n+  user-select: none;\n+  white-space: nowrap;\n+\n+  svg {\n+    width: var(--size-16);\n+    height: var(--size-16);\n+  }\n+\n+  &:focus-visible {\n+    outline: 0;\n+  }\n+}\n+\n+.dev-tools-indicator-footer {\n+  background: var(--color-background-200);\n+  padding: 6px;\n+  border-top: 1px solid var(--color-gray-400);\n+  width: 100%;\n+}\n+\n+.dev-tools-indicator-item[data-selected='true'] {\n+  cursor: pointer;\n+  background-color: var(--color-gray-200);\n+}\n+\n+.dev-tools-indicator-label {\n+  font-size: var(--size-14);\n+  line-height: var(--size-20);\n+  color: var(--color-gray-1000);\n+}\n+\n+.dev-tools-indicator-value {\n+  font-size: var(--size-14);\n+  line-height: var(--size-20);\n+  color: var(--color-gray-900);\n+  margin-left: auto;\n+}\n+\n+.dev-tools-indicator-issue-count {\n+  --color-primary: var(--color-gray-800);\n+  --color-secondary: var(--color-gray-100);\n+  display: flex;\n+  flex-direction: row;\n+  align-items: center;\n+  justify-content: center;\n+  gap: 8px;\n+  min-width: var(--size-40);\n+  height: var(--size-24);\n+  background: var(--color-background-100);\n+  border: 1px solid var(--color-gray-alpha-400);\n+  background-clip: padding-box;\n+  box-shadow: var(--shadow-small);\n+  padding: 2px;\n+  color: var(--color-gray-1000);\n+  border-radius: 128px;\n+  font-weight: 500;\n+  font-size: var(--size-13);\n+  font-variant-numeric: tabular-nums;\n+\n+  &[data-has-issues='true'] {\n+    --color-primary: var(--color-red-800);\n+    --color-secondary: var(--color-red-100);\n+  }\n+\n+  .dev-tools-indicator-issue-count-indicator {\n+    width: var(--size-8);\n+    height: var(--size-8);\n+    background: var(--color-primary);\n+    box-shadow: 0 0 0 2px var(--color-secondary);\n+    border-radius: 50%;\n+  }\n+}\n+\n+.dev-tools-indicator-shortcut {\n+  display: flex;\n+  gap: 4px;\n+\n+  kbd {\n+    width: var(--size-20);\n+    height: var(--size-20);\n+    display: flex;\n+    justify-content: center;\n+    align-items: center;\n+    border-radius: var(--rounded-md);\n+    border: 1px solid var(--color-gray-400);\n+    font-family: var(--font-stack-sans);\n+    background: var(--color-background-100);\n+    color: var(--color-gray-1000);\n+    text-align: center;\n+    font-size: var(--size-12);\n+    line-height: var(--size-16);\n+  }\n+}\n+\n+.dev-tools-grabbing {\n+  cursor: grabbing;\n+\n+  > * {\n+    pointer-events: none;\n+  }\n+}"
        },
        {
            "sha": "4d957bad50df9221a94728a1ff54a59b922f9b79",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/devtools-indicator.stories.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.stories.tsx?ref=96b31f8e678bfe2c259a96b97d35632373bced38",
            "patch": "@@ -1,12 +1,12 @@\n import type { Meta, StoryObj } from '@storybook/react'\n import type { OverlayState } from '../../shared'\n \n-import { DevToolsIndicatorNew } from './devtools-indicator'\n+import { DevToolsIndicator } from './devtools-indicator'\n import { INITIAL_OVERLAY_STATE } from '../../shared'\n import { withShadowPortal } from '../../storybook/with-shadow-portal'\n \n-const meta: Meta<typeof DevToolsIndicatorNew> = {\n-  component: DevToolsIndicatorNew,\n+const meta: Meta<typeof DevToolsIndicator> = {\n+  component: DevToolsIndicator,\n   parameters: {\n     layout: 'centered',\n   },\n@@ -37,7 +37,7 @@ const meta: Meta<typeof DevToolsIndicatorNew> = {\n }\n \n export default meta\n-type Story = StoryObj<typeof DevToolsIndicatorNew>\n+type Story = StoryObj<typeof DevToolsIndicator>\n \n const state: OverlayState = {\n   ...INITIAL_OVERLAY_STATE,"
        },
        {
            "sha": "14f3021abf49a207e5889e66430503c89f1d1a5d",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/devtools-indicator.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx?ref=96b31f8e678bfe2c259a96b97d35632373bced38",
            "patch": "@@ -1,6 +1,6 @@\n+import './devtools-indicator.css'\n import type { CSSProperties } from 'react'\n-\n-import { NextLogoNew } from './next-logo'\n+import { NextLogo } from './next-logo'\n import { Toast } from '../toast'\n import {\n   MENU_CURVE,\n@@ -20,7 +20,7 @@ import type { DevToolsIndicatorPosition } from '../errors/dev-tools-indicator/de\n \n export const INDICATOR_PADDING = 20\n \n-export function DevToolsIndicatorNew() {\n+export function DevToolsIndicator() {\n   const { state, dispatch } = useDevOverlayContext()\n   const { panel, setPanel, setSelectedIndex } = usePanelRouterContext()\n   const updateAllPanelPositions = useUpdateAllPanelPositions()\n@@ -56,7 +56,7 @@ export function DevToolsIndicatorNew() {\n           updateAllPanelPositions(p)\n         }}\n       >\n-        <NextLogoNew\n+        <NextLogo\n           onTriggerClick={() => {\n             const newPanel =\n               panel === 'panel-selector' ? null : 'panel-selector'"
        },
        {
            "sha": "71f130d985481f1e402d1a059cd14d08325e73b1",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/next-logo.stories.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.stories.tsx?ref=96b31f8e678bfe2c259a96b97d35632373bced38",
            "patch": "@@ -1,5 +1,5 @@\n import type { Meta, StoryObj } from '@storybook/react'\n-import { NextLogoNew } from './next-logo'\n+import { NextLogo } from './next-logo'\n import { withShadowPortal } from '../../storybook/with-shadow-portal'\n // TODO(rob): this storybook's configurability is broken intentionally\n // it will be restored when we wrap it in the storybook context addon https://storybook.js.org/addons/storybook-react-context\n@@ -10,7 +10,7 @@ const StoryBookNextLogo = (\n     isDevRendering: boolean\n   } & Record<string, unknown>\n ) => {\n-  return <NextLogoNew onTriggerClick={() => {}} />\n+  return <NextLogo onTriggerClick={() => {}} />\n }\n \n const meta: Meta<typeof StoryBookNextLogo> = {"
        },
        {
            "sha": "f52f325635284046c077e23ca20d6adb86379925",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/next-logo.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fnext-logo.tsx?ref=96b31f8e678bfe2c259a96b97d35632373bced38",
            "patch": "@@ -16,7 +16,7 @@ import { BASE_LOGO_SIZE } from '../../utils/indicator-metrics'\n \n const SHORT_DURATION_MS = 150\n \n-export function NextLogoNew({\n+export function NextLogo({\n   onTriggerClick,\n   ...buttonProps\n }: { onTriggerClick: () => void } & React.ComponentProps<'button'>) {"
        },
        {
            "sha": "04092676b6d0c06d3c6e7e365125245046e8e74c",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/dev-tools-indicator.stories.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 103,
            "changes": 103,
            "blob_url": "https://github.com/vercel/next.js/blob/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.stories.tsx?ref=4e0b1125a466bdc81ead94969008c55509ea4ad0",
            "patch": "@@ -1,103 +0,0 @@\n-import type { Meta, StoryObj } from '@storybook/react'\n-import { DevOverlayStoryWrapper } from '../../../storybook/DevOverlayStoryWrapper'\n-import { withShadowPortal } from '../../../storybook/with-shadow-portal'\n-import type { VersionInfo } from '../../../../../server/dev/parse-version-info'\n-import {\n-  getStoredPanelPosition,\n-  STORE_KEY_SHARED_PANEL_LOCATION,\n-  type OverlayState,\n-} from '../../../shared'\n-\n-const meta: Meta<typeof DevOverlayStoryWrapper> = {\n-  component: DevOverlayStoryWrapper,\n-  parameters: {\n-    layout: 'centered',\n-  },\n-  argTypes: {},\n-  decorators: [\n-    withShadowPortal,\n-    // Test for high z-index\n-    (Story) => (\n-      <div\n-        style={{\n-          position: 'fixed',\n-          top: 0,\n-          left: 0,\n-          width: '100%',\n-          height: '100%',\n-          zIndex: 9999,\n-          display: 'flex',\n-          alignItems: 'center',\n-          justifyContent: 'center',\n-          background:\n-            'linear-gradient(135deg, rgba(230,240,255,0.8) 0%, rgba(200,220,255,0.6) 100%)',\n-        }}\n-      >\n-        <Story />\n-      </div>\n-    ),\n-  ],\n-}\n-\n-export default meta\n-type Story = StoryObj<typeof DevOverlayStoryWrapper>\n-\n-// Mock version info for stories\n-const mockVersionInfo: VersionInfo = {\n-  installed: '15.1.2',\n-  staleness: 'stale-major',\n-}\n-\n-const state: OverlayState = {\n-  routerType: 'app',\n-  devToolsPanelPosition: {\n-    [STORE_KEY_SHARED_PANEL_LOCATION]: getStoredPanelPosition(),\n-  },\n-  nextId: 1,\n-  buildError: null,\n-  errors: [],\n-  refreshState: { type: 'idle' },\n-  disableDevIndicator: false,\n-  showIndicator: true,\n-  versionInfo: mockVersionInfo,\n-  notFound: false,\n-  buildingIndicator: false,\n-  renderingIndicator: false,\n-  staticIndicator: true,\n-  debugInfo: { devtoolsFrontendUrl: undefined },\n-  isErrorOverlayOpen: false,\n-  showRestartServerButton: false,\n-  devToolsPosition: 'bottom-left',\n-  scale: 1,\n-  page: '',\n-}\n-\n-export const StaticRoute: Story = {\n-  render: () => (\n-    <DevOverlayStoryWrapper initialState={state} runtimeErrors={[]} />\n-  ),\n-}\n-\n-export const DynamicRoute: Story = {\n-  render: () => (\n-    <DevOverlayStoryWrapper\n-      initialState={{ ...state, staticIndicator: false }}\n-      runtimeErrors={[]}\n-    />\n-  ),\n-}\n-\n-export const SingleError: Story = {\n-  render: () => (\n-    <DevOverlayStoryWrapper initialState={state} runtimeErrors={[{} as any]} />\n-  ),\n-}\n-\n-export const MultipleErrors: Story = {\n-  render: () => (\n-    <DevOverlayStoryWrapper\n-      initialState={state}\n-      runtimeErrors={[{}, {}, {}] as any}\n-    />\n-  ),\n-}"
        },
        {
            "sha": "a254de86d1d1bb381c24ef9b68d3821d01971138",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/dev-tools-indicator.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 705,
            "changes": 705,
            "blob_url": "https://github.com/vercel/next.js/blob/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx?ref=4e0b1125a466bdc81ead94969008c55509ea4ad0",
            "patch": "@@ -1,705 +0,0 @@\n-import type { CSSProperties, Dispatch, SetStateAction } from 'react'\n-import {\n-  ACTION_ERROR_OVERLAY_OPEN,\n-  ACTION_ERROR_OVERLAY_TOGGLE,\n-  STORAGE_KEY_POSITION,\n-  type OverlayDispatch,\n-  type OverlayState,\n-} from '../../../shared'\n-\n-import { useState, useEffect, useRef, createContext, useContext } from 'react'\n-import { Toast } from '../../toast'\n-import { NextLogo } from './next-logo'\n-import { useDelayedRender } from '../../../hooks/use-delayed-render'\n-import { TurbopackInfo } from './dev-tools-info/turbopack-info'\n-import { RouteInfo } from './dev-tools-info/route-info'\n-import GearIcon from '../../../icons/gear-icon'\n-import { UserPreferences } from './dev-tools-info/user-preferences'\n-import {\n-  MENU_CURVE,\n-  MENU_DURATION_MS,\n-  useClickOutsideAndEscape,\n-  useFocusTrap,\n-} from './utils'\n-import {\n-  getInitialPosition,\n-  useHideShortcutStorage,\n-  type DevToolsScale,\n-} from './dev-tools-info/preferences'\n-import { Draggable } from './draggable'\n-import { useShortcuts } from '../../../hooks/use-shortcuts'\n-\n-// TODO: add E2E tests to cover different scenarios\n-\n-export function DevToolsIndicator({\n-  state,\n-  errorCount,\n-  isBuildError,\n-  ...props\n-}: {\n-  state: OverlayState\n-  dispatch: OverlayDispatch\n-  errorCount: number\n-  isBuildError: boolean\n-\n-  scale: DevToolsScale\n-  setScale: (value: DevToolsScale) => void\n-}) {\n-  const [isDevToolsIndicatorVisible, setIsDevToolsIndicatorVisible] =\n-    useState(true)\n-\n-  return (\n-    <DevToolsPopover\n-      routerType={state.routerType}\n-      semver={state.versionInfo.installed}\n-      issueCount={errorCount}\n-      isDevBuilding={state.buildingIndicator}\n-      isDevRendering={state.renderingIndicator}\n-      isStaticRoute={state.staticIndicator}\n-      hide={() => {\n-        setIsDevToolsIndicatorVisible(false)\n-        fetch('/__nextjs_disable_dev_indicator', {\n-          method: 'POST',\n-        })\n-      }}\n-      toggleVisibility={() => {\n-        setIsDevToolsIndicatorVisible(!isDevToolsIndicatorVisible)\n-      }}\n-      isTurbopack={!!process.env.TURBOPACK}\n-      disabled={state.disableDevIndicator || !isDevToolsIndicatorVisible}\n-      isBuildError={isBuildError}\n-      page={state.page}\n-      {...props}\n-    />\n-  )\n-}\n-\n-//////////////////////////////////////////////////////////////////////////////////////\n-\n-interface C {\n-  closeMenu?: () => void\n-  selectedIndex: number\n-  setSelectedIndex: Dispatch<SetStateAction<number>>\n-}\n-\n-export const MenuContext = createContext({} as C)\n-\n-const OVERLAYS = {\n-  Root: 'root',\n-  Turbo: 'turbo',\n-  Route: 'route',\n-  Preferences: 'preferences',\n-  SegmentExplorer: 'segment-explorer',\n-} as const\n-\n-export type Overlays = (typeof OVERLAYS)[keyof typeof OVERLAYS]\n-\n-const INDICATOR_PADDING = 20\n-\n-// Dynamic import for SegmentsExplorer which including base-ui that causing Edge browser crash\n-// x-ref: https://github.com/vercel/next.js/pull/64602\n-// TODO: remove this once the new base-ui version is released\n-const SegmentsExplorer = process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER\n-  ? (\n-      require('./dev-tools-info/segments-explorer') as typeof import('./dev-tools-info/segments-explorer')\n-    ).SegmentsExplorer\n-  : () => null\n-\n-function DevToolsPopover({\n-  routerType,\n-  disabled,\n-  issueCount,\n-  isDevBuilding,\n-  isDevRendering,\n-  isStaticRoute,\n-  isTurbopack,\n-  isBuildError,\n-  hide,\n-  toggleVisibility,\n-  dispatch,\n-  scale,\n-  setScale,\n-  page,\n-}: {\n-  routerType: 'pages' | 'app'\n-  disabled: boolean\n-  issueCount: number\n-  isStaticRoute: boolean\n-  semver: string | undefined\n-  isDevBuilding: boolean\n-  isDevRendering: boolean\n-  isTurbopack: boolean\n-  isBuildError: boolean\n-  hide: () => void\n-  toggleVisibility: () => void\n-  dispatch: OverlayDispatch\n-  scale: DevToolsScale\n-  setScale: (value: DevToolsScale) => void\n-  page: string\n-}) {\n-  const rootRef = useRef<HTMLDivElement>(null)\n-  const menuRef = useRef<HTMLDivElement>(null)\n-  const triggerRef = useRef<HTMLButtonElement | null>(null)\n-\n-  const [open, setOpen] = useState<Overlays | null>(null)\n-  const [position, setPosition] = useState(getInitialPosition())\n-  const [selectedIndex, setSelectedIndex] = useState(-1)\n-  const [hideShortcut, setHideShortcut] = useHideShortcutStorage()\n-\n-  const isMenuOpen = open === OVERLAYS.Root\n-  const isTurbopackInfoOpen = open === OVERLAYS.Turbo\n-  const isRouteInfoOpen = open === OVERLAYS.Route\n-  const isPreferencesOpen = open === OVERLAYS.Preferences\n-  const isSegmentExplorerOpen = open === OVERLAYS.SegmentExplorer\n-\n-  const { mounted: menuMounted, rendered: menuRendered } = useDelayedRender(\n-    isMenuOpen,\n-    {\n-      // Intentionally no fade in, makes the UI feel more immediate\n-      enterDelay: 0,\n-      // Graceful fade out to confirm that the UI did not break\n-      exitDelay: MENU_DURATION_MS,\n-    }\n-  )\n-\n-  // Features to make the menu accessible\n-  useFocusTrap(menuRef, triggerRef, isMenuOpen)\n-  useClickOutsideAndEscape(menuRef, triggerRef, menuMounted, closeMenu)\n-  useShortcuts(hideShortcut ? { [hideShortcut]: hideDevTools } : {}, triggerRef)\n-\n-  useEffect(() => {\n-    if (open === null) {\n-      // Avoid flashing selected state\n-      const id = setTimeout(() => {\n-        setSelectedIndex(-1)\n-      }, MENU_DURATION_MS)\n-      return () => clearTimeout(id)\n-    }\n-  }, [open])\n-\n-  function hideDevTools() {\n-    toggleVisibility()\n-    const root = rootRef.current\n-    // Toggle custom hidden attribute, no need\n-    // to close the menu in case you want to quickly get it\n-    // out the way to see an element behind it.\n-    if (root) {\n-      root.dataset.hidden = root.dataset.hidden === 'true' ? 'false' : 'true'\n-    }\n-  }\n-\n-  function select(index: number | 'first' | 'last') {\n-    if (index === 'first') {\n-      setTimeout(() => {\n-        const all = menuRef.current?.querySelectorAll('[role=\"menuitem\"]')\n-        if (all) {\n-          const firstIndex = all[0].getAttribute('data-index')\n-          select(Number(firstIndex))\n-        }\n-      })\n-      return\n-    }\n-\n-    if (index === 'last') {\n-      setTimeout(() => {\n-        const all = menuRef.current?.querySelectorAll('[role=\"menuitem\"]')\n-        if (all) {\n-          const lastIndex = all.length - 1\n-          select(lastIndex)\n-        }\n-      })\n-      return\n-    }\n-\n-    const el = menuRef.current?.querySelector(\n-      `[data-index=\"${index}\"]`\n-    ) as HTMLElement\n-\n-    if (el) {\n-      setSelectedIndex(index)\n-      el?.focus()\n-    }\n-  }\n-\n-  function onMenuKeydown(e: React.KeyboardEvent<HTMLDivElement>) {\n-    e.preventDefault()\n-\n-    switch (e.key) {\n-      case 'ArrowDown':\n-        const next = selectedIndex + 1\n-        select(next)\n-        break\n-      case 'ArrowUp':\n-        const prev = selectedIndex - 1\n-        select(prev)\n-        break\n-      case 'Home':\n-        select('first')\n-        break\n-      case 'End':\n-        select('last')\n-        break\n-      default:\n-        break\n-    }\n-  }\n-\n-  function openErrorOverlay() {\n-    setOpen(null)\n-    if (issueCount > 0) {\n-      dispatch({ type: ACTION_ERROR_OVERLAY_OPEN })\n-    }\n-  }\n-\n-  function toggleErrorOverlay() {\n-    dispatch({ type: ACTION_ERROR_OVERLAY_TOGGLE })\n-  }\n-\n-  function closeToRootMenu() {\n-    setOpen(OVERLAYS.Root)\n-    // We wait for the menu animation to complete\n-    setTimeout(() => {\n-      // This places focus again on the selected item\n-      // so you can press Enter to trigger the selected item again\n-      select(selectedIndex)\n-    }, MENU_DURATION_MS)\n-  }\n-\n-  function onTriggerClick() {\n-    if (open === OVERLAYS.Root) {\n-      setOpen(null)\n-    } else {\n-      setOpen(OVERLAYS.Root)\n-      setTimeout(() => {\n-        select('first')\n-      })\n-    }\n-  }\n-\n-  function closeMenu() {\n-    // Only close when we were on `Root`,\n-    // otherwise it will close other overlays\n-    setOpen((prevOpen) => {\n-      if (prevOpen === OVERLAYS.Root) {\n-        return null\n-      }\n-      return prevOpen\n-    })\n-  }\n-\n-  function handleHideDevtools() {\n-    setOpen(null)\n-    hide()\n-  }\n-\n-  const [vertical, horizontal] = position.split('-', 2)\n-  const popover = { [vertical]: 'calc(100% + 8px)', [horizontal]: 0 }\n-\n-  return (\n-    <Toast\n-      ref={rootRef}\n-      data-nextjs-toast\n-      style={\n-        {\n-          '--animate-out-duration-ms': `${MENU_DURATION_MS}ms`,\n-          '--animate-out-timing-function': MENU_CURVE,\n-          boxShadow: 'none',\n-          [vertical]: `${INDICATOR_PADDING}px`,\n-          [horizontal]: `${INDICATOR_PADDING}px`,\n-        } as CSSProperties\n-      }\n-    >\n-      <Draggable\n-        padding={INDICATOR_PADDING}\n-        onDragStart={() => setOpen(null)}\n-        position={position}\n-        setPosition={(p) => {\n-          localStorage.setItem(STORAGE_KEY_POSITION, p)\n-          setPosition(p)\n-        }}\n-      >\n-        {/* Trigger */}\n-        <NextLogo\n-          ref={triggerRef}\n-          aria-haspopup=\"menu\"\n-          aria-expanded={isMenuOpen}\n-          aria-controls=\"nextjs-dev-tools-menu\"\n-          aria-label={`${isMenuOpen ? 'Close' : 'Open'} Next.js Dev Tools`}\n-          data-nextjs-dev-tools-button\n-          disabled={disabled}\n-          issueCount={issueCount}\n-          onTriggerClick={onTriggerClick}\n-          toggleErrorOverlay={toggleErrorOverlay}\n-          isDevBuilding={isDevBuilding}\n-          isDevRendering={isDevRendering}\n-          isBuildError={isBuildError}\n-          scale={scale}\n-        />\n-      </Draggable>\n-\n-      {/* Route Info */}\n-      <RouteInfo\n-        isOpen={isRouteInfoOpen}\n-        close={closeToRootMenu}\n-        triggerRef={triggerRef}\n-        style={popover}\n-        routerType={routerType}\n-        routeType={isStaticRoute ? 'Static' : 'Dynamic'}\n-      />\n-\n-      {/* Turbopack Info */}\n-      <TurbopackInfo\n-        isOpen={isTurbopackInfoOpen}\n-        close={closeToRootMenu}\n-        triggerRef={triggerRef}\n-        style={popover}\n-      />\n-\n-      {/* Preferences */}\n-      <UserPreferences\n-        isOpen={isPreferencesOpen}\n-        close={closeToRootMenu}\n-        triggerRef={triggerRef}\n-        style={popover}\n-        hide={handleHideDevtools}\n-        setPosition={setPosition}\n-        position={position}\n-        scale={scale}\n-        setScale={setScale}\n-        hideShortcut={hideShortcut}\n-        setHideShortcut={setHideShortcut}\n-      />\n-\n-      {/* Page Route Info */}\n-      {process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER ? (\n-        <SegmentsExplorer\n-          isOpen={isSegmentExplorerOpen}\n-          close={closeToRootMenu}\n-          triggerRef={triggerRef}\n-          style={popover}\n-          routerType={routerType}\n-          page={page}\n-        />\n-      ) : null}\n-\n-      {/* Dropdown Menu */}\n-      {menuMounted && (\n-        <div\n-          ref={menuRef}\n-          id=\"nextjs-dev-tools-menu\"\n-          role=\"menu\"\n-          dir=\"ltr\"\n-          aria-orientation=\"vertical\"\n-          aria-label=\"Next.js Dev Tools Items\"\n-          tabIndex={-1}\n-          className=\"dev-tools-indicator-menu\"\n-          onKeyDown={onMenuKeydown}\n-          data-rendered={menuRendered}\n-          style={popover}\n-        >\n-          <MenuContext.Provider\n-            value={{\n-              closeMenu,\n-              selectedIndex,\n-              setSelectedIndex,\n-            }}\n-          >\n-            <div className=\"dev-tools-indicator-inner\">\n-              {issueCount > 0 && (\n-                <MenuItem\n-                  title={`${issueCount} ${issueCount === 1 ? 'issue' : 'issues'} found. Click to view details in the dev overlay.`}\n-                  index={0}\n-                  label=\"Issues\"\n-                  value={<IssueCount>{issueCount}</IssueCount>}\n-                  onClick={openErrorOverlay}\n-                />\n-              )}\n-              <MenuItem\n-                title={`Current route is ${isStaticRoute ? 'static' : 'dynamic'}.`}\n-                label=\"Route\"\n-                index={1}\n-                value={isStaticRoute ? 'Static' : 'Dynamic'}\n-                onClick={() => setOpen(OVERLAYS.Route)}\n-                data-nextjs-route-type={isStaticRoute ? 'static' : 'dynamic'}\n-              />\n-              {isTurbopack ? (\n-                <MenuItem\n-                  title=\"Turbopack is enabled.\"\n-                  label=\"Turbopack\"\n-                  value=\"Enabled\"\n-                />\n-              ) : (\n-                <MenuItem\n-                  index={2}\n-                  title=\"Learn about Turbopack and how to enable it in your application.\"\n-                  label=\"Try Turbopack\"\n-                  value={<ChevronRight />}\n-                  onClick={() => setOpen(OVERLAYS.Turbo)}\n-                />\n-              )}\n-            </div>\n-\n-            <div className=\"dev-tools-indicator-footer\">\n-              <MenuItem\n-                data-preferences\n-                label=\"Preferences\"\n-                value={<GearIcon />}\n-                onClick={() => setOpen(OVERLAYS.Preferences)}\n-                index={isTurbopack ? 2 : 3}\n-              />\n-              {process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER ? (\n-                <MenuItem\n-                  data-segment-explorer\n-                  label=\"Route Info\"\n-                  value={<ChevronRight />}\n-                  onClick={() => setOpen(OVERLAYS.SegmentExplorer)}\n-                  index={isTurbopack ? 3 : 4}\n-                />\n-              ) : null}\n-            </div>\n-          </MenuContext.Provider>\n-        </div>\n-      )}\n-    </Toast>\n-  )\n-}\n-\n-function ChevronRight() {\n-  return (\n-    <svg\n-      xmlns=\"http://www.w3.org/2000/svg\"\n-      width=\"16\"\n-      height=\"16\"\n-      viewBox=\"0 0 16 16\"\n-      fill=\"none\"\n-    >\n-      <path\n-        fill=\"#666\"\n-        fillRule=\"evenodd\"\n-        clipRule=\"evenodd\"\n-        d=\"M5.50011 1.93945L6.03044 2.46978L10.8537 7.293C11.2442 7.68353 11.2442 8.31669 10.8537 8.70722L6.03044 13.5304L5.50011 14.0608L4.43945 13.0001L4.96978 12.4698L9.43945 8.00011L4.96978 3.53044L4.43945 3.00011L5.50011 1.93945Z\"\n-      />\n-    </svg>\n-  )\n-}\n-\n-export function MenuItem({\n-  index,\n-  label,\n-  value,\n-  onClick,\n-  href,\n-  ...props\n-}: {\n-  index?: number\n-  title?: string\n-  label: string\n-  value: React.ReactNode\n-  href?: string\n-  onClick?: () => void\n-}) {\n-  const isInteractive =\n-    typeof onClick === 'function' || typeof href === 'string'\n-  const { closeMenu, selectedIndex, setSelectedIndex } = useContext(MenuContext)\n-  const selected = selectedIndex === index\n-\n-  function click() {\n-    if (isInteractive) {\n-      onClick?.()\n-      closeMenu?.()\n-      if (href) {\n-        window.open(href, '_blank', 'noopener, noreferrer')\n-      }\n-    }\n-  }\n-\n-  return (\n-    <div\n-      className=\"dev-tools-indicator-item\"\n-      data-index={index}\n-      data-selected={selected}\n-      onClick={click}\n-      // Needs `onMouseMove` instead of enter to work together\n-      // with keyboard and mouse input\n-      onMouseMove={() => {\n-        if (isInteractive && index !== undefined && selectedIndex !== index) {\n-          setSelectedIndex(index)\n-        }\n-      }}\n-      onMouseLeave={() => setSelectedIndex(-1)}\n-      onKeyDown={(e) => {\n-        if (e.key === 'Enter' || e.key === ' ') {\n-          click()\n-        }\n-      }}\n-      role={isInteractive ? 'menuitem' : undefined}\n-      tabIndex={selected ? 0 : -1}\n-      {...props}\n-    >\n-      <span className=\"dev-tools-indicator-label\">{label}</span>\n-      <span className=\"dev-tools-indicator-value\">{value}</span>\n-    </div>\n-  )\n-}\n-\n-function IssueCount({ children }: { children: number }) {\n-  return (\n-    <span\n-      className=\"dev-tools-indicator-issue-count\"\n-      data-has-issues={children > 0}\n-    >\n-      <span className=\"dev-tools-indicator-issue-count-indicator\" />\n-      {children}\n-    </span>\n-  )\n-}\n-\n-//////////////////////////////////////////////////////////////////////////////////////\n-\n-export const DEV_TOOLS_INDICATOR_STYLES = `\n-  [data-nextjs-toast] {\n-    &[data-hidden='true'] {\n-      display: none;\n-    }\n-  }\n-\n-  .dev-tools-indicator-menu {\n-    -webkit-font-smoothing: antialiased;\n-    display: flex;\n-    flex-direction: column;\n-    align-items: flex-start;\n-    background: var(--color-background-100);\n-    border: 1px solid var(--color-gray-alpha-400);\n-    background-clip: padding-box;\n-    box-shadow: var(--shadow-menu);\n-    border-radius: var(--rounded-xl);\n-    position: absolute;\n-    font-family: var(--font-stack-sans);\n-    z-index: 3;\n-    overflow: hidden;\n-    opacity: 0;\n-    outline: 0;\n-    min-width: 248px;\n-    transition: opacity var(--animate-out-duration-ms)\n-      var(--animate-out-timing-function);\n-\n-    &[data-rendered='true'] {\n-      opacity: 1;\n-      scale: 1;\n-    }\n-  }\n-\n-  .dev-tools-indicator-inner {\n-    padding: 6px;\n-    width: 100%;\n-  }\n-\n-  .dev-tools-indicator-item {\n-    display: flex;\n-    align-items: center;\n-    padding: 8px 6px;\n-    height: var(--size-36);\n-    border-radius: 6px;\n-    text-decoration: none !important;\n-    user-select: none;\n-    white-space: nowrap;\n-\n-    svg {\n-      width: var(--size-16);\n-      height: var(--size-16);\n-    }\n-\n-    &:focus-visible {\n-      outline: 0;\n-    }\n-  }\n-\n-  .dev-tools-indicator-footer {\n-    background: var(--color-background-200);\n-    padding: 6px;\n-    border-top: 1px solid var(--color-gray-400);\n-    width: 100%;\n-  }\n-\n-  .dev-tools-indicator-item[data-selected='true'] {\n-    cursor: pointer;\n-    background-color: var(--color-gray-200);\n-  }\n-\n-  .dev-tools-indicator-label {\n-    font-size: var(--size-14);\n-    line-height: var(--size-20);\n-    color: var(--color-gray-1000);\n-  }\n-\n-  .dev-tools-indicator-value {\n-    font-size: var(--size-14);\n-    line-height: var(--size-20);\n-    color: var(--color-gray-900);\n-    margin-left: auto;\n-  }\n-\n-  .dev-tools-indicator-issue-count {\n-    --color-primary: var(--color-gray-800);\n-    --color-secondary: var(--color-gray-100);\n-    display: flex;\n-    flex-direction: row;\n-    align-items: center;\n-    justify-content: center;\n-    gap: 8px;\n-    min-width: var(--size-40);\n-    height: var(--size-24);\n-    background: var(--color-background-100);\n-    border: 1px solid var(--color-gray-alpha-400);\n-    background-clip: padding-box;\n-    box-shadow: var(--shadow-small);\n-    padding: 2px;\n-    color: var(--color-gray-1000);\n-    border-radius: 128px;\n-    font-weight: 500;\n-    font-size: var(--size-13);\n-    font-variant-numeric: tabular-nums;\n-\n-    &[data-has-issues='true'] {\n-      --color-primary: var(--color-red-800);\n-      --color-secondary: var(--color-red-100);\n-    }\n-\n-    .dev-tools-indicator-issue-count-indicator {\n-      width: var(--size-8);\n-      height: var(--size-8);\n-      background: var(--color-primary);\n-      box-shadow: 0 0 0 2px var(--color-secondary);\n-      border-radius: 50%;\n-    }\n-  }\n-\n-  .dev-tools-indicator-shortcut {\n-    display: flex;\n-    gap: 4px;\n-\n-    kbd {\n-      width: var(--size-20);\n-      height: var(--size-20);\n-      display: flex;\n-      justify-content: center;\n-      align-items: center;\n-      border-radius: var(--rounded-md);\n-      border: 1px solid var(--color-gray-400);\n-      font-family: var(--font-stack-sans);\n-      background: var(--color-background-100);\n-      color: var(--color-gray-1000);\n-      text-align: center;\n-      font-size: var(--size-12);\n-      line-height: var(--size-16);\n-    }\n-  }\n-\n-  .dev-tools-grabbing {\n-    cursor: grabbing;\n-\n-    > * {\n-      pointer-events: none;\n-    }\n-  }\n-`"
        },
        {
            "sha": "57e8f8eb9875ab509b780984360acc7e9d8bf1a3",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/dev-tools-info/segments-explorer.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 21,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-info%2Fsegments-explorer.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-info%2Fsegments-explorer.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-info%2Fsegments-explorer.tsx?ref=4e0b1125a466bdc81ead94969008c55509ea4ad0",
            "patch": "@@ -1,21 +0,0 @@\n-import { PageSegmentTree } from '../../../overview/segment-explorer'\n-import { DevToolsInfo, type DevToolsInfoPropsCore } from './dev-tools-info'\n-\n-export function SegmentsExplorer({\n-  routerType,\n-  page,\n-  ...props\n-}: DevToolsInfoPropsCore &\n-  React.HTMLProps<HTMLDivElement> & {\n-    routerType: 'app' | 'pages'\n-    page: string\n-  }) {\n-  const isAppRouter = routerType === 'app'\n-  return (\n-    <DevToolsInfo title=\"Route Info\" {...props}>\n-      <div data-nextjs-segments-explorer style={{ margin: '-16px' }}>\n-        <PageSegmentTree isAppRouter={isAppRouter} page={page} />\n-      </div>\n-    </DevToolsInfo>\n-  )\n-}"
        },
        {
            "sha": "276505b3d631b9fcf8156d5673f86e819345e5d5",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/next-logo.stories.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 82,
            "changes": 82,
            "blob_url": "https://github.com/vercel/next.js/blob/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.stories.tsx?ref=4e0b1125a466bdc81ead94969008c55509ea4ad0",
            "patch": "@@ -1,82 +0,0 @@\n-import type { Meta, StoryObj } from '@storybook/react'\n-import { NextLogo } from './next-logo'\n-import { withShadowPortal } from '../../../storybook/with-shadow-portal'\n-\n-const meta: Meta<typeof NextLogo> = {\n-  component: NextLogo,\n-  parameters: {\n-    layout: 'centered',\n-  },\n-  args: {\n-    'aria-label': 'Open Next.js DevTools',\n-    onClick: () => console.log('Clicked!'),\n-  },\n-  decorators: [withShadowPortal],\n-}\n-\n-export default meta\n-type Story = StoryObj<typeof NextLogo>\n-\n-export const NoIssues: Story = {\n-  args: {\n-    issueCount: 0,\n-    isDevBuilding: false,\n-    isDevRendering: false,\n-  },\n-}\n-\n-export const SingleIssue: Story = {\n-  args: {\n-    issueCount: 1,\n-    isDevBuilding: false,\n-    isDevRendering: false,\n-  },\n-}\n-\n-export const MultipleIssues: Story = {\n-  args: {\n-    issueCount: 5,\n-    isDevBuilding: false,\n-    isDevRendering: false,\n-  },\n-}\n-\n-export const ManyIssues: Story = {\n-  args: {\n-    issueCount: 99,\n-    isDevBuilding: false,\n-    isDevRendering: false,\n-  },\n-}\n-\n-export const Building: Story = {\n-  args: {\n-    issueCount: 0,\n-    isDevBuilding: true,\n-    isDevRendering: false,\n-  },\n-}\n-\n-export const BuildingWithError: Story = {\n-  args: {\n-    issueCount: 1,\n-    isDevBuilding: true,\n-    isDevRendering: false,\n-  },\n-}\n-\n-export const Rendering: Story = {\n-  args: {\n-    issueCount: 0,\n-    isDevBuilding: false,\n-    isDevRendering: true,\n-  },\n-}\n-\n-export const RenderingWithError: Story = {\n-  args: {\n-    issueCount: 1,\n-    isDevBuilding: false,\n-    isDevRendering: true,\n-  },\n-}"
        },
        {
            "sha": "6f59f4c7a1cfb1fbe3e57180ba52afa4da1be3c0",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/next-logo.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 598,
            "changes": 598,
            "blob_url": "https://github.com/vercel/next.js/blob/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4e0b1125a466bdc81ead94969008c55509ea4ad0/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.tsx?ref=4e0b1125a466bdc81ead94969008c55509ea4ad0",
            "patch": "@@ -1,598 +0,0 @@\n-import { forwardRef, useEffect, useRef, useState } from 'react'\n-import { css } from '../../../utils/css'\n-import mergeRefs from '../../../utils/merge-refs'\n-import type { DevToolsScale } from './dev-tools-info/preferences'\n-import { useMinimumLoadingTimeMultiple } from '../../devtools-indicator/hooks/use-minimum-loading-time-multiple'\n-import { useUpdateAnimation } from '../../devtools-indicator/hooks/use-update-animation'\n-import { useMeasureWidth } from '../../devtools-indicator/hooks/use-measure-width'\n-\n-interface Props extends React.ComponentProps<'button'> {\n-  issueCount: number\n-  isDevBuilding: boolean\n-  isDevRendering: boolean\n-  isBuildError: boolean\n-  onTriggerClick: () => void\n-  toggleErrorOverlay: () => void\n-  scale: DevToolsScale\n-}\n-\n-const SHORT_DURATION_MS = 150\n-\n-export const NextLogo = forwardRef(function NextLogo(\n-  {\n-    disabled,\n-    issueCount,\n-    isDevBuilding,\n-    isDevRendering,\n-    isBuildError,\n-    onTriggerClick,\n-    toggleErrorOverlay,\n-    scale = 1,\n-    ...props\n-  }: Props,\n-  propRef: React.Ref<HTMLButtonElement>\n-) {\n-  const SIZE = 36 / scale\n-\n-  const hasError = issueCount > 0\n-  const [isErrorExpanded, setIsErrorExpanded] = useState(hasError)\n-  const [dismissed, setDismissed] = useState(false)\n-  const newErrorDetected = useUpdateAnimation(issueCount, SHORT_DURATION_MS)\n-\n-  const triggerRef = useRef<HTMLButtonElement | null>(null)\n-  const ref = useRef<HTMLDivElement | null>(null)\n-  const measuredWidth = useMeasureWidth(ref)\n-\n-  const isLoading = useMinimumLoadingTimeMultiple(\n-    isDevBuilding || isDevRendering\n-  )\n-  const isExpanded = isErrorExpanded || disabled\n-  const width = measuredWidth === 0 ? 'auto' : measuredWidth\n-\n-  useEffect(() => {\n-    setIsErrorExpanded(hasError)\n-  }, [hasError])\n-\n-  return (\n-    <div\n-      data-next-badge-root\n-      style={\n-        {\n-          '--size': `${SIZE}px`,\n-          '--duration-short': `${SHORT_DURATION_MS}ms`,\n-          // if the indicator is disabled, hide the badge\n-          // also allow the \"disabled\" state be dismissed, as long as there are no build errors\n-          display: disabled && (!hasError || dismissed) ? 'none' : 'block',\n-        } as React.CSSProperties\n-      }\n-    >\n-      {/* Styles */}\n-      <style>\n-        {css`\n-          [data-next-badge-root] {\n-            --timing: cubic-bezier(0.23, 0.88, 0.26, 0.92);\n-            --duration-long: 250ms;\n-            --color-outer-border: #171717;\n-            --color-inner-border: hsla(0, 0%, 100%, 0.14);\n-            --color-hover-alpha-subtle: hsla(0, 0%, 100%, 0.13);\n-            --color-hover-alpha-error: hsla(0, 0%, 100%, 0.2);\n-            --color-hover-alpha-error-2: hsla(0, 0%, 100%, 0.25);\n-            --mark-size: calc(var(--size) - var(--size-2) * 2);\n-\n-            --focus-color: var(--color-blue-800);\n-            --focus-ring: 2px solid var(--focus-color);\n-\n-            &:has([data-next-badge][data-error='true']) {\n-              --focus-color: #fff;\n-            }\n-          }\n-\n-          [data-disabled-icon] {\n-            display: flex;\n-            align-items: center;\n-            justify-content: center;\n-            padding-right: 4px;\n-          }\n-\n-          [data-next-badge] {\n-            -webkit-font-smoothing: antialiased;\n-            width: var(--size);\n-            height: var(--size);\n-            display: flex;\n-            align-items: center;\n-            position: relative;\n-            background: rgba(0, 0, 0, 0.8);\n-            box-shadow:\n-              0 0 0 1px var(--color-outer-border),\n-              inset 0 0 0 1px var(--color-inner-border),\n-              0px 16px 32px -8px rgba(0, 0, 0, 0.24);\n-            backdrop-filter: blur(48px);\n-            border-radius: var(--rounded-full);\n-            user-select: none;\n-            cursor: pointer;\n-            scale: 1;\n-            overflow: hidden;\n-            will-change: scale, box-shadow, width, background;\n-            transition:\n-              scale var(--duration-short) var(--timing),\n-              width var(--duration-long) var(--timing),\n-              box-shadow var(--duration-long) var(--timing),\n-              background var(--duration-short) ease;\n-\n-            &:active[data-error='false'] {\n-              scale: 0.95;\n-            }\n-\n-            &[data-animate='true']:not(:hover) {\n-              scale: 1.02;\n-            }\n-\n-            &[data-error='false']:has([data-next-mark]:focus-visible) {\n-              outline: var(--focus-ring);\n-              outline-offset: 3px;\n-            }\n-\n-            &[data-error='true'] {\n-              background: #ca2a30;\n-              --color-inner-border: #e5484d;\n-\n-              [data-next-mark] {\n-                background: var(--color-hover-alpha-error);\n-                outline-offset: 0px;\n-\n-                &:focus-visible {\n-                  outline: var(--focus-ring);\n-                  outline-offset: -1px;\n-                }\n-\n-                &:hover {\n-                  background: var(--color-hover-alpha-error-2);\n-                }\n-              }\n-            }\n-\n-            &[data-error-expanded='false'][data-error='true'] ~ [data-dot] {\n-              scale: 1;\n-            }\n-\n-            > div {\n-              display: flex;\n-            }\n-          }\n-\n-          [data-issues-collapse]:focus-visible {\n-            outline: var(--focus-ring);\n-          }\n-\n-          [data-issues]:has([data-issues-open]:focus-visible) {\n-            outline: var(--focus-ring);\n-            outline-offset: -1px;\n-          }\n-\n-          [data-dot] {\n-            content: '';\n-            width: var(--size-8);\n-            height: var(--size-8);\n-            background: #fff;\n-            box-shadow: 0 0 0 1px var(--color-outer-border);\n-            border-radius: 50%;\n-            position: absolute;\n-            top: 2px;\n-            right: 0px;\n-            scale: 0;\n-            pointer-events: none;\n-            transition: scale 200ms var(--timing);\n-            transition-delay: var(--duration-short);\n-          }\n-\n-          [data-issues] {\n-            --padding-left: 8px;\n-            display: flex;\n-            gap: 2px;\n-            align-items: center;\n-            padding-left: 8px;\n-            padding-right: 8px;\n-            height: var(--size-32);\n-            margin-right: 2px;\n-            border-radius: var(--rounded-full);\n-            transition: background var(--duration-short) ease;\n-\n-            &:has([data-issues-open]:hover) {\n-              background: var(--color-hover-alpha-error);\n-            }\n-\n-            &:has([data-issues-collapse]) {\n-              padding-right: calc(var(--padding-left) / 2);\n-            }\n-\n-            [data-cross] {\n-              translate: 0px -1px;\n-            }\n-          }\n-\n-          [data-issues-open] {\n-            font-size: var(--size-13);\n-            color: white;\n-            width: fit-content;\n-            height: 100%;\n-            display: flex;\n-            gap: 2px;\n-            align-items: center;\n-            margin: 0;\n-            line-height: var(--size-36);\n-            font-weight: 500;\n-            z-index: 2;\n-            white-space: nowrap;\n-\n-            &:focus-visible {\n-              outline: 0;\n-            }\n-          }\n-\n-          [data-issues-collapse] {\n-            width: var(--size-24);\n-            height: var(--size-24);\n-            border-radius: var(--rounded-full);\n-            transition: background var(--duration-short) ease;\n-\n-            &:hover {\n-              background: var(--color-hover-alpha-error);\n-            }\n-          }\n-\n-          [data-cross] {\n-            color: #fff;\n-            width: var(--size-12);\n-            height: var(--size-12);\n-          }\n-\n-          [data-next-mark] {\n-            width: var(--mark-size);\n-            height: var(--mark-size);\n-            margin: 0 2px;\n-            display: flex;\n-            align-items: center;\n-            border-radius: var(--rounded-full);\n-            transition: background var(--duration-long) var(--timing);\n-\n-            &:focus-visible {\n-              outline: 0;\n-            }\n-\n-            &:hover {\n-              background: var(--color-hover-alpha-subtle);\n-            }\n-\n-            svg {\n-              flex-shrink: 0;\n-              width: var(--size-40);\n-              height: var(--size-40);\n-            }\n-          }\n-\n-          [data-issues-count-animation] {\n-            display: grid;\n-            place-items: center center;\n-            font-variant-numeric: tabular-nums;\n-\n-            &[data-animate='false'] {\n-              [data-issues-count-exit],\n-              [data-issues-count-enter] {\n-                animation-duration: 0ms;\n-              }\n-            }\n-\n-            > * {\n-              grid-area: 1 / 1;\n-            }\n-\n-            [data-issues-count-exit] {\n-              animation: fadeOut 300ms var(--timing) forwards;\n-            }\n-\n-            [data-issues-count-enter] {\n-              animation: fadeIn 300ms var(--timing) forwards;\n-            }\n-          }\n-\n-          [data-issues-count-plural] {\n-            display: inline-block;\n-            &[data-animate='true'] {\n-              animation: fadeIn 300ms var(--timing) forwards;\n-            }\n-          }\n-\n-          .path0 {\n-            animation: draw0 1.5s ease-in-out infinite;\n-          }\n-\n-          .path1 {\n-            animation: draw1 1.5s ease-out infinite;\n-            animation-delay: 0.3s;\n-          }\n-\n-          .paused {\n-            stroke-dashoffset: 0;\n-          }\n-\n-          @keyframes fadeIn {\n-            0% {\n-              opacity: 0;\n-              filter: blur(2px);\n-              transform: translateY(8px);\n-            }\n-            100% {\n-              opacity: 1;\n-              filter: blur(0px);\n-              transform: translateY(0);\n-            }\n-          }\n-\n-          @keyframes fadeOut {\n-            0% {\n-              opacity: 1;\n-              filter: blur(0px);\n-              transform: translateY(0);\n-            }\n-            100% {\n-              opacity: 0;\n-              transform: translateY(-12px);\n-              filter: blur(2px);\n-            }\n-          }\n-\n-          @keyframes draw0 {\n-            0%,\n-            25% {\n-              stroke-dashoffset: -29.6;\n-            }\n-            25%,\n-            50% {\n-              stroke-dashoffset: 0;\n-            }\n-            50%,\n-            75% {\n-              stroke-dashoffset: 0;\n-            }\n-            75%,\n-            100% {\n-              stroke-dashoffset: 29.6;\n-            }\n-          }\n-\n-          @keyframes draw1 {\n-            0%,\n-            20% {\n-              stroke-dashoffset: -11.6;\n-            }\n-            20%,\n-            50% {\n-              stroke-dashoffset: 0;\n-            }\n-            50%,\n-            75% {\n-              stroke-dashoffset: 0;\n-            }\n-            75%,\n-            100% {\n-              stroke-dashoffset: 11.6;\n-            }\n-          }\n-\n-          @media (prefers-reduced-motion) {\n-            [data-issues-count-exit],\n-            [data-issues-count-enter],\n-            [data-issues-count-plural] {\n-              animation-duration: 0ms !important;\n-            }\n-          }\n-        `}\n-      </style>\n-      <div\n-        data-next-badge\n-        data-error={hasError}\n-        data-error-expanded={isExpanded}\n-        data-animate={newErrorDetected}\n-        style={{ width }}\n-      >\n-        <div ref={ref}>\n-          {/* Children */}\n-          {!disabled && (\n-            <button\n-              ref={mergeRefs(triggerRef, propRef)}\n-              data-next-mark\n-              data-next-mark-loading={isLoading}\n-              onClick={onTriggerClick}\n-              {...props}\n-            >\n-              <NextMark isLoading={isLoading} isDevBuilding={isDevBuilding} />\n-            </button>\n-          )}\n-          {isExpanded && (\n-            <div data-issues>\n-              <button\n-                data-issues-open\n-                aria-label=\"Open issues overlay\"\n-                onClick={toggleErrorOverlay}\n-              >\n-                {disabled && (\n-                  <div data-disabled-icon>\n-                    <Warning />\n-                  </div>\n-                )}\n-                <AnimateCount\n-                  // Used the key to force a re-render when the count changes.\n-                  key={issueCount}\n-                  animate={newErrorDetected}\n-                  data-issues-count-animation\n-                >\n-                  {issueCount}\n-                </AnimateCount>{' '}\n-                <div>\n-                  Issue\n-                  {issueCount > 1 && (\n-                    <span\n-                      aria-hidden\n-                      data-issues-count-plural\n-                      // This only needs to animate once the count changes from 1 -> 2,\n-                      // otherwise it should stay static between re-renders.\n-                      data-animate={newErrorDetected && issueCount === 2}\n-                    >\n-                      s\n-                    </span>\n-                  )}\n-                </div>\n-              </button>\n-              {!isBuildError && (\n-                <button\n-                  data-issues-collapse\n-                  aria-label=\"Collapse issues badge\"\n-                  onClick={() => {\n-                    if (disabled) {\n-                      setDismissed(true)\n-                    } else {\n-                      setIsErrorExpanded(false)\n-                    }\n-                    // Move focus to the trigger to prevent having it stuck on this element\n-                    triggerRef.current?.focus()\n-                  }}\n-                >\n-                  <Cross data-cross />\n-                </button>\n-              )}\n-            </div>\n-          )}\n-        </div>\n-      </div>\n-      <div aria-hidden data-dot />\n-    </div>\n-  )\n-})\n-\n-function AnimateCount({\n-  children: count,\n-  animate = true,\n-  ...props\n-}: {\n-  children: number\n-  animate: boolean\n-}) {\n-  return (\n-    <div {...props} data-animate={animate}>\n-      <div aria-hidden data-issues-count-exit>\n-        {count - 1}\n-      </div>\n-      <div data-issues-count data-issues-count-enter>\n-        {count}\n-      </div>\n-    </div>\n-  )\n-}\n-\n-function NextMark({\n-  isLoading,\n-  isDevBuilding,\n-}: {\n-  isLoading?: boolean\n-  isDevBuilding?: boolean\n-}) {\n-  const strokeColor = isDevBuilding ? 'rgba(255,255,255,0.7)' : 'white'\n-  return (\n-    <svg\n-      width=\"40\"\n-      height=\"40\"\n-      viewBox=\"0 0 40 40\"\n-      fill=\"none\"\n-      data-next-mark-loading={isLoading}\n-    >\n-      <g transform=\"translate(8.5, 13)\">\n-        <path\n-          className={isLoading ? 'path0' : 'paused'}\n-          d=\"M13.3 15.2 L2.34 1 V12.6\"\n-          fill=\"none\"\n-          stroke=\"url(#next_logo_paint0_linear_1357_10853)\"\n-          strokeWidth=\"1.86\"\n-          mask=\"url(#next_logo_mask0)\"\n-          strokeDasharray=\"29.6\"\n-          strokeDashoffset=\"29.6\"\n-        />\n-        <path\n-          className={isLoading ? 'path1' : 'paused'}\n-          d=\"M11.825 1.5 V13.1\"\n-          strokeWidth=\"1.86\"\n-          stroke=\"url(#next_logo_paint1_linear_1357_10853)\"\n-          strokeDasharray=\"11.6\"\n-          strokeDashoffset=\"11.6\"\n-        />\n-      </g>\n-      <defs>\n-        <linearGradient\n-          id=\"next_logo_paint0_linear_1357_10853\"\n-          x1=\"9.95555\"\n-          y1=\"11.1226\"\n-          x2=\"15.4778\"\n-          y2=\"17.9671\"\n-          gradientUnits=\"userSpaceOnUse\"\n-        >\n-          <stop stopColor={strokeColor} />\n-          <stop offset=\"0.604072\" stopColor={strokeColor} stopOpacity=\"0\" />\n-          <stop offset=\"1\" stopColor={strokeColor} stopOpacity=\"0\" />\n-        </linearGradient>\n-        <linearGradient\n-          id=\"next_logo_paint1_linear_1357_10853\"\n-          x1=\"11.8222\"\n-          y1=\"1.40039\"\n-          x2=\"11.791\"\n-          y2=\"9.62542\"\n-          gradientUnits=\"userSpaceOnUse\"\n-        >\n-          <stop stopColor={strokeColor} />\n-          <stop offset=\"1\" stopColor={strokeColor} stopOpacity=\"0\" />\n-        </linearGradient>\n-        <mask id=\"next_logo_mask0\">\n-          <rect width=\"100%\" height=\"100%\" fill=\"white\" />\n-          <rect width=\"5\" height=\"1.5\" fill=\"black\" />\n-        </mask>\n-      </defs>\n-    </svg>\n-  )\n-}\n-\n-function Warning() {\n-  return (\n-    <svg\n-      width=\"12\"\n-      height=\"12\"\n-      viewBox=\"0 0 12 12\"\n-      fill=\"none\"\n-      xmlns=\"http://www.w3.org/2000/svg\"\n-    >\n-      <path\n-        fillRule=\"evenodd\"\n-        clipRule=\"evenodd\"\n-        d=\"M3.98071 1.125L1.125 3.98071L1.125 8.01929L3.98071 10.875H8.01929L10.875 8.01929V3.98071L8.01929 1.125H3.98071ZM3.82538 0C3.62647 0 3.4357 0.0790176 3.29505 0.21967L0.21967 3.29505C0.0790176 3.4357 0 3.62647 0 3.82538V8.17462C0 8.37353 0.0790178 8.5643 0.21967 8.70495L3.29505 11.7803C3.4357 11.921 3.62647 12 3.82538 12H8.17462C8.37353 12 8.5643 11.921 8.70495 11.7803L11.7803 8.70495C11.921 8.5643 12 8.37353 12 8.17462V3.82538C12 3.62647 11.921 3.4357 11.7803 3.29505L8.70495 0.21967C8.5643 0.0790177 8.37353 0 8.17462 0H3.82538ZM6.5625 2.8125V3.375V6V6.5625H5.4375V6V3.375V2.8125H6.5625ZM6 9C6.41421 9 6.75 8.66421 6.75 8.25C6.75 7.83579 6.41421 7.5 6 7.5C5.58579 7.5 5.25 7.83579 5.25 8.25C5.25 8.66421 5.58579 9 6 9Z\"\n-        fill=\"#EAEAEA\"\n-      />\n-    </svg>\n-  )\n-}\n-\n-export function Cross(props: React.SVGProps<SVGSVGElement>) {\n-  return (\n-    <svg\n-      width=\"12\"\n-      height=\"12\"\n-      viewBox=\"0 0 14 14\"\n-      fill=\"none\"\n-      xmlns=\"http://www.w3.org/2000/svg\"\n-      {...props}\n-    >\n-      <path\n-        fillRule=\"evenodd\"\n-        clipRule=\"evenodd\"\n-        d=\"M3.08889 11.8384L2.62486 12.3024L1.69678 11.3744L2.16082 10.9103L6.07178 6.99937L2.16082 3.08841L1.69678 2.62437L2.62486 1.69629L3.08889 2.16033L6.99986 6.07129L10.9108 2.16033L11.3749 1.69629L12.3029 2.62437L11.8389 3.08841L7.92793 6.99937L11.8389 10.9103L12.3029 11.3744L11.3749 12.3024L10.9108 11.8384L6.99986 7.92744L3.08889 11.8384Z\"\n-        fill=\"currentColor\"\n-      />\n-    </svg>\n-  )\n-}"
        },
        {
            "sha": "c923be72bcd6506ded8fd613dddd8c297077dc8e",
            "filename": "packages/next/src/next-devtools/dev-overlay/dev-overlay.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 28,
            "changes": 31,
            "blob_url": "https://github.com/vercel/next.js/blob/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fdev-overlay.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fdev-overlay.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fdev-overlay.tsx?ref=96b31f8e678bfe2c259a96b97d35632373bced38",
            "patch": "@@ -5,13 +5,11 @@ import { ComponentStyles } from './styles/component-styles'\n import { CssReset } from './styles/css-reset'\n import { Colors } from './styles/colors'\n import { ErrorOverlay } from './components/errors/error-overlay/error-overlay'\n-import { DevToolsIndicator } from './components/errors/dev-tools-indicator/dev-tools-indicator'\n import { RenderError } from './container/runtime-error/render-error'\n import { DarkTheme } from './styles/dark-theme'\n-import { useDevToolsScale } from './components/errors/dev-tools-indicator/dev-tools-info/preferences'\n import type { HydrationErrorState } from '../shared/hydration-error'\n import type { ReadyRuntimeError } from './utils/get-error-by-type'\n-import { DevToolsIndicatorNew } from './components/devtools-indicator/devtools-indicator'\n+import { DevToolsIndicator } from './components/devtools-indicator/devtools-indicator'\n import { PanelRouter } from './menu/panel-router'\n import { PanelRouterContext, type PanelStateKind } from './menu/context'\n import type { OverlayState, OverlayDispatch } from './shared'\n@@ -32,9 +30,7 @@ export function DevOverlay({\n   dispatch: OverlayDispatch\n   getSquashedHydrationErrorDetails: (error: Error) => HydrationErrorState | null\n }) {\n-  const [scale, setScale] = useDevToolsScale()\n   const [panel, setPanel] = useState<null | PanelStateKind>(null)\n-  const isBuildError = state.buildError !== null\n   const [selectedIndex, setSelectedIndex] = useState(-1)\n \n   const triggerRef = useRef<HTMLButtonElement>(null)\n@@ -74,32 +70,11 @@ export function DevOverlay({\n                         errorCount={totalErrorCount}\n                       />\n                       <PanelRouter />\n-                      <DevToolsIndicatorNew />\n+                      <DevToolsIndicator />\n                     </PanelRouterContext>\n                   </RenderErrorContext>\n                 </>\n-              ) : (\n-                <>\n-                  <DevToolsIndicator\n-                    scale={scale}\n-                    setScale={setScale}\n-                    state={state}\n-                    dispatch={dispatch}\n-                    errorCount={totalErrorCount}\n-                    isBuildError={isBuildError}\n-                  />\n-\n-                  <ErrorOverlay\n-                    state={state}\n-                    dispatch={dispatch}\n-                    getSquashedHydrationErrorDetails={\n-                      getSquashedHydrationErrorDetails\n-                    }\n-                    runtimeErrors={runtimeErrors}\n-                    errorCount={totalErrorCount}\n-                  />\n-                </>\n-              )}\n+              ) : null}\n             </>\n           )\n         }}"
        },
        {
            "sha": "2c0aef5c62b2e44588c584938029bac2fcf80037",
            "filename": "packages/next/src/next-devtools/dev-overlay/menu/dev-overlay-menu.tsx",
            "status": "modified",
            "additions": 76,
            "deletions": 5,
            "changes": 81,
            "blob_url": "https://github.com/vercel/next.js/blob/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fmenu%2Fdev-overlay-menu.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fmenu%2Fdev-overlay-menu.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fmenu%2Fdev-overlay-menu.tsx?ref=96b31f8e678bfe2c259a96b97d35632373bced38",
            "patch": "@@ -1,15 +1,86 @@\n import { useDevOverlayContext } from '../../dev-overlay.browser'\n import { useClickOutsideAndEscape } from '../components/errors/dev-tools-indicator/utils'\n-import { useLayoutEffect, useRef, type CSSProperties } from 'react'\n+import {\n+  useLayoutEffect,\n+  useRef,\n+  createContext,\n+  useContext,\n+  type CSSProperties,\n+  type Dispatch,\n+  type SetStateAction,\n+} from 'react'\n import { getIndicatorOffset } from '../utils/indicator-metrics'\n import { INDICATOR_PADDING } from '../components/devtools-indicator/devtools-indicator'\n-import {\n-  MenuContext,\n-  MenuItem,\n-} from '../components/errors/dev-tools-indicator/dev-tools-indicator'\n import { usePanelRouterContext } from './context'\n import { usePanelContext } from './panel-router'\n \n+interface C {\n+  closeMenu?: () => void\n+  selectedIndex: number\n+  setSelectedIndex: Dispatch<SetStateAction<number>>\n+}\n+\n+export const MenuContext = createContext({} as C)\n+\n+export function MenuItem({\n+  index,\n+  label,\n+  value,\n+  onClick,\n+  href,\n+  ...props\n+}: {\n+  index?: number\n+  title?: string\n+  label: string\n+  value: React.ReactNode\n+  href?: string\n+  onClick?: () => void\n+}) {\n+  const isInteractive =\n+    typeof onClick === 'function' || typeof href === 'string'\n+  const { closeMenu, selectedIndex, setSelectedIndex } = useContext(MenuContext)\n+  const selected = selectedIndex === index\n+\n+  function click() {\n+    if (isInteractive) {\n+      onClick?.()\n+      closeMenu?.()\n+      if (href) {\n+        window.open(href, '_blank', 'noopener, noreferrer')\n+      }\n+    }\n+  }\n+\n+  return (\n+    <div\n+      className=\"dev-tools-indicator-item\"\n+      data-index={index}\n+      data-selected={selected}\n+      onClick={click}\n+      // Needs `onMouseMove` instead of enter to work together\n+      // with keyboard and mouse input\n+      onMouseMove={() => {\n+        if (isInteractive && index !== undefined && selectedIndex !== index) {\n+          setSelectedIndex(index)\n+        }\n+      }}\n+      onMouseLeave={() => setSelectedIndex(-1)}\n+      onKeyDown={(e) => {\n+        if (e.key === 'Enter' || e.key === ' ') {\n+          click()\n+        }\n+      }}\n+      role={isInteractive ? 'menuitem' : undefined}\n+      tabIndex={selected ? 0 : -1}\n+      {...props}\n+    >\n+      <span className=\"dev-tools-indicator-label\">{label}</span>\n+      <span className=\"dev-tools-indicator-value\">{value}</span>\n+    </div>\n+  )\n+}\n+\n export const DevtoolMenu = ({\n   closeOnClickOutside = true,\n   items,"
        },
        {
            "sha": "e22167196d1445a0be680b9d425b2acda9e0c364",
            "filename": "packages/next/src/next-devtools/dev-overlay/styles/component-styles.tsx",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fstyles%2Fcomponent-styles.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/96b31f8e678bfe2c259a96b97d35632373bced38/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fstyles%2Fcomponent-styles.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fstyles%2Fcomponent-styles.tsx?ref=96b31f8e678bfe2c259a96b97d35632373bced38",
            "patch": "@@ -12,7 +12,6 @@ import { styles as containerErrorStyles } from '../container/errors'\n import { styles as containerRuntimeErrorStyles } from '../container/runtime-error'\n import { COPY_BUTTON_STYLES } from '../components/copy-button'\n import { CALL_STACK_FRAME_STYLES } from '../components/call-stack-frame/call-stack-frame'\n-import { DEV_TOOLS_INDICATOR_STYLES } from '../components/errors/dev-tools-indicator/dev-tools-indicator'\n import { css } from '../utils/css'\n import { EDITOR_LINK_STYLES } from '../components/terminal/editor-link'\n import { ENVIRONMENT_NAME_LABEL_STYLES } from '../components/errors/environment-name-label/environment-name-label'\n@@ -48,7 +47,6 @@ export function ComponentStyles() {\n         ${containerRuntimeErrorStyles}\n         ${versionStaleness}\n         ${RESTART_SERVER_BUTTON_STYLES}\n-        ${DEV_TOOLS_INDICATOR_STYLES}\n         ${DEV_TOOLS_INFO_STYLES}\n         ${DEV_TOOLS_INFO_TURBOPACK_INFO_STYLES}\n         ${DEV_TOOLS_INFO_ROUTE_INFO_STYLES}"
        }
    ],
    "stats": {
        "total": 1790,
        "additions": 235,
        "deletions": 1555
    }
}