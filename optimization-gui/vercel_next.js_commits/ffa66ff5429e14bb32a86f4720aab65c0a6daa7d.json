{
    "author": "devjiwonchoi",
    "message": "fix: error overlay not closing when backdrop clicked (#83981)\n\nThe ref object wasn't passed to the hook; instead, ref.current (the\nvalue) was passed. This caused `useOnClickOutside` to be noop on initial\nrender when ref.current was null, and only worked later because the\ncomponent re-rendered with a different value. The fix ensures the hook\nalways has access to the current DOM element whenever the effect runs.\n\n### Before\n\n\nhttps://github.com/user-attachments/assets/baa7ea6c-9506-4f14-8950-b4e7e7abbe61\n\n### After\n\n\nhttps://github.com/user-attachments/assets/18c3c569-ca30-41c3-ae92-f2d3e8fcee4c",
    "sha": "ffa66ff5429e14bb32a86f4720aab65c0a6daa7d",
    "files": [
        {
            "sha": "bc72a74532842d3feac69bc1365e123d6ed4f06b",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/dialog/dialog.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/ffa66ff5429e14bb32a86f4720aab65c0a6daa7d/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdialog%2Fdialog.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/ffa66ff5429e14bb32a86f4720aab65c0a6daa7d/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdialog%2Fdialog.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdialog%2Fdialog.tsx?ref=ffa66ff5429e14bb32a86f4720aab65c0a6daa7d",
            "patch": "@@ -37,8 +37,7 @@ const Dialog: React.FC<DialogProps> = function Dialog({\n   )\n \n   useOnClickOutside(\n-    // eslint-disable-next-line react-hooks/refs -- TODO\n-    dialogRef.current,\n+    dialogRef,\n     CSS_SELECTORS_TO_EXCLUDE_ON_CLICK_OUTSIDE,\n     (e) => {\n       e.preventDefault()"
        },
        {
            "sha": "9b75c58934ca3ab949999b9e6a4709f27a68e479",
            "filename": "packages/next/src/next-devtools/dev-overlay/hooks/use-on-click-outside.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/ffa66ff5429e14bb32a86f4720aab65c0a6daa7d/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fhooks%2Fuse-on-click-outside.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ffa66ff5429e14bb32a86f4720aab65c0a6daa7d/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fhooks%2Fuse-on-click-outside.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fhooks%2Fuse-on-click-outside.ts?ref=ffa66ff5429e14bb32a86f4720aab65c0a6daa7d",
            "patch": "@@ -1,18 +1,20 @@\n import * as React from 'react'\n \n export function useOnClickOutside(\n-  el: Node | null,\n+  el: Node | React.RefObject<Node | null> | null,\n   cssSelectorsToExclude: string[],\n   handler: ((e: MouseEvent | TouchEvent) => void) | undefined\n ) {\n   React.useEffect(() => {\n-    if (el == null || handler == null) {\n+    // Support both direct nodes and ref objects\n+    const element = el && 'current' in el ? el.current : el\n+    if (element == null || handler == null) {\n       return\n     }\n \n     const listener = (e: MouseEvent | TouchEvent) => {\n       // Do nothing if clicking ref's element or descendent elements\n-      if (!el || el.contains(e.target as Element)) {\n+      if (!element || element.contains(e.target as Element)) {\n         return\n       }\n \n@@ -28,7 +30,7 @@ export function useOnClickOutside(\n       handler(e)\n     }\n \n-    const root = el.getRootNode()\n+    const root = element.getRootNode()\n     root.addEventListener('mouseup', listener as EventListener)\n     root.addEventListener('touchend', listener as EventListener, {\n       passive: false,"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 7,
        "deletions": 6
    }
}