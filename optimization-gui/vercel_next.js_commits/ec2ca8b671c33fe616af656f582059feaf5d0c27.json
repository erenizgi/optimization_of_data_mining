{
    "author": "mischnic",
    "message": "Cleanup pure span handling (#76846)\n\nThat `add_pure_comment(dummy_pure_span)` shouldn't be necessary with `PURE_SP`.",
    "sha": "ec2ca8b671c33fe616af656f582059feaf5d0c27",
    "files": [
        {
            "sha": "f5d64b67c733dfe0cc274bc88ea2d602dfebd166",
            "filename": "crates/next-custom-transforms/src/transforms/server_actions.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 6,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/ec2ca8b671c33fe616af656f582059feaf5d0c27/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Fserver_actions.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/ec2ca8b671c33fe616af656f582059feaf5d0c27/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Fserver_actions.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Fserver_actions.rs?ref=ec2ca8b671c33fe616af656f582059feaf5d0c27",
            "patch": "@@ -1855,8 +1855,6 @@ impl<C: Comments> VisitMut for ServerActions<C> {\n             for (ident, export_name, ref_id) in self.exported_idents.iter() {\n                 if !self.config.is_react_server_layer {\n                     if export_name == \"default\" {\n-                        self.comments.add_pure_comment(ident.span.lo);\n-\n                         let export_expr = ModuleItem::ModuleDecl(ModuleDecl::ExportDefaultExpr(\n                             ExportDefaultExpr {\n                                 span: DUMMY_SP,\n@@ -1868,6 +1866,7 @@ impl<C: Comments> VisitMut for ServerActions<C> {\n                                     span: if self.config.is_react_server_layer\n                                         || self.config.is_development\n                                     {\n+                                        self.comments.add_pure_comment(ident.span.lo);\n                                         ident.span\n                                     } else {\n                                         PURE_SP\n@@ -1888,9 +1887,6 @@ impl<C: Comments> VisitMut for ServerActions<C> {\n                         ));\n                         new.push(export_expr);\n                     } else {\n-                        let dummy_pure_span = Span::dummy_with_cmt();\n-                        self.comments.add_pure_comment(dummy_pure_span.lo);\n-\n                         let export_expr =\n                             ModuleItem::ModuleDecl(ModuleDecl::ExportDecl(ExportDecl {\n                                 span: DUMMY_SP,\n@@ -1918,7 +1914,7 @@ impl<C: Comments> VisitMut for ServerActions<C> {\n                                             .into(),\n                                         ),\n                                         init: Some(Box::new(Expr::Call(CallExpr {\n-                                            span: dummy_pure_span,\n+                                            span: PURE_SP,\n                                             callee: Callee::Expr(Box::new(Expr::Ident(\n                                                 create_ref_ident.clone(),\n                                             ))),"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 2,
        "deletions": 6
    }
}