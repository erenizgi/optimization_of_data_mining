{
    "author": "huozhi",
    "message": "[metadata]: add pinterest meta tag (#76988)\n\n### What\nAdds support for Pinterest's Rich Pin Data meta tag, while\nfuture-proofing for additional Pinterest tags.\n\nThis currently works like so\n\n```js\npinterest: {\n  richPin: true\n}\n  ```\n And would resolve to:\n \n```html\n <meta property=\"pinterest-rich-pin\" content=\"true\" />\n ```\n\nx-ref: https://help.pinterest.com/en/business/article/rich-pins\n\nCloses #70873\n\n---------\n\nCo-authored-by: Dominik Koch <dominik@koch-bautechnik.de>",
    "sha": "75831c08e83abd120be3968ec32ee0e2a2c4d33d",
    "files": [
        {
            "sha": "2953655962dec27359f38294209b6236d3af34c5",
            "filename": "packages/next/src/lib/metadata/default-metadata.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fdefault-metadata.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fdefault-metadata.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fdefault-metadata.tsx?ref=75831c08e83abd120be3968ec32ee0e2a2c4d33d",
            "patch": "@@ -48,6 +48,7 @@ export function createDefaultMetadata(): ResolvedMetadata {\n     formatDetection: null,\n     itunes: null,\n     facebook: null,\n+    pinterest: null,\n     abstract: null,\n     appLinks: null,\n     archives: null,"
        },
        {
            "sha": "775d0cb966f03f6714a5e558f47c2b1b1871a8b4",
            "filename": "packages/next/src/lib/metadata/generate/basic.tsx",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fgenerate%2Fbasic.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fgenerate%2Fbasic.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fgenerate%2Fbasic.tsx?ref=75831c08e83abd120be3968ec32ee0e2a2c4d33d",
            "patch": "@@ -157,6 +157,18 @@ export function FacebookMeta({\n   ])\n }\n \n+export function PinterestMeta({\n+  pinterest,\n+}: {\n+  pinterest: ResolvedMetadata['pinterest']\n+}) {\n+  if (!pinterest || !pinterest.richPin) return null\n+\n+  const { richPin } = pinterest\n+\n+  return <meta property=\"pinterest-rich-pin\" content={richPin.toString()} />\n+}\n+\n const formatDetectionKeys = [\n   'telephone',\n   'date',"
        },
        {
            "sha": "edacd9b9c2106fa7be9146862ad55bdce00c7d85",
            "filename": "packages/next/src/lib/metadata/metadata.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fmetadata.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fmetadata.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fmetadata.tsx?ref=75831c08e83abd120be3968ec32ee0e2a2c4d33d",
            "patch": "@@ -12,6 +12,7 @@ import {\n   ViewportMeta,\n   VerificationMeta,\n   FacebookMeta,\n+  PinterestMeta,\n } from './generate/basic'\n import { AlternatesMetadata } from './generate/alternate'\n import {\n@@ -392,6 +393,7 @@ function createMetadataElements(metadata: ResolvedMetadata) {\n     AlternatesMetadata({ alternates: metadata.alternates }),\n     ItunesMeta({ itunes: metadata.itunes }),\n     FacebookMeta({ facebook: metadata.facebook }),\n+    PinterestMeta({ pinterest: metadata.pinterest }),\n     FormatDetectionMeta({ formatDetection: metadata.formatDetection }),\n     VerificationMeta({ verification: metadata.verification }),\n     AppleWebAppMeta({ appleWebApp: metadata.appleWebApp }),"
        },
        {
            "sha": "de773a8d20cc273d7bf1d2ac12eabfc4c55f704c",
            "filename": "packages/next/src/lib/metadata/resolve-metadata.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fresolve-metadata.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fresolve-metadata.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fresolve-metadata.ts?ref=75831c08e83abd120be3968ec32ee0e2a2c4d33d",
            "patch": "@@ -215,7 +215,6 @@ function mergeMetadata({\n       case 'facebook':\n         target.facebook = resolveFacebook(source.facebook)\n         break\n-\n       case 'verification':\n         target.verification = resolveVerification(source.verification)\n         break\n@@ -272,6 +271,7 @@ function mergeMetadata({\n       case 'referrer':\n       case 'formatDetection':\n       case 'manifest':\n+      case 'pinterest':\n         // @ts-ignore TODO: support inferring\n         target[key] = source[key] || null\n         break"
        },
        {
            "sha": "ca825b3b98a1da33149adf4efceca4d01a27e716",
            "filename": "packages/next/src/lib/metadata/types/extra-types.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Ftypes%2Fextra-types.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Ftypes%2Fextra-types.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Ftypes%2Fextra-types.ts?ref=75831c08e83abd120be3968ec32ee0e2a2c4d33d",
            "patch": "@@ -106,6 +106,15 @@ export type ResolvedFacebook = {\n   admins?: string[] | undefined\n }\n \n+export type Pinterest = PinterestRichPin\n+export type PinterestRichPin = {\n+  richPin: string | boolean\n+}\n+\n+export type ResolvedPinterest = {\n+  richPin?: string\n+}\n+\n // Format Detection\n // This is a poorly specified metadata export type that is supposed to\n // control whether the device attempts to conver text that matches"
        },
        {
            "sha": "27b60ce4d249ad8c67a2b40f64f191a650a88db9",
            "filename": "packages/next/src/lib/metadata/types/metadata-interface.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Ftypes%2Fmetadata-interface.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/75831c08e83abd120be3968ec32ee0e2a2c4d33d/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Ftypes%2Fmetadata-interface.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Ftypes%2Fmetadata-interface.ts?ref=75831c08e83abd120be3968ec32ee0e2a2c4d33d",
            "patch": "@@ -23,9 +23,11 @@ import type {\n   Facebook,\n   FormatDetection,\n   ItunesApp,\n+  Pinterest,\n   ResolvedAppleWebApp,\n   ResolvedAppLinks,\n   ResolvedFacebook,\n+  ResolvedPinterest,\n   ViewportLayout,\n } from './extra-types'\n import type {\n@@ -369,6 +371,17 @@ interface Metadata extends DeprecatedMetadataFields {\n    */\n   facebook?: null | Facebook | undefined\n \n+  /**\n+   * The Pinterest metadata for the document to choose whether opt out of rich pin data.\n+   *\n+   * @example\n+   * ```tsx\n+   * pinterest: { richPin: true }\n+   * // Renders <meta name=\"pinterest-rich-pin\" content=\"true\" />\n+   * ```\n+   */\n+  pinterest?: null | Pinterest\n+\n   /**\n    * The common verification tokens for the document.\n    *\n@@ -606,6 +619,8 @@ interface ResolvedMetadata extends DeprecatedMetadataFields {\n \n   facebook: null | ResolvedFacebook\n \n+  pinterest: null | ResolvedPinterest\n+\n   // common verification tokens\n   verification: null | ResolvedVerification\n "
        },
        {
            "sha": "4e05d11b9e10c4cfb519d39d95c976fe07240abc",
            "filename": "test/e2e/app-dir/metadata/app/socials/page.tsx",
            "status": "renamed",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/75831c08e83abd120be3968ec32ee0e2a2c4d33d/test%2Fe2e%2Fapp-dir%2Fmetadata%2Fapp%2Fsocials%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/75831c08e83abd120be3968ec32ee0e2a2c4d33d/test%2Fe2e%2Fapp-dir%2Fmetadata%2Fapp%2Fsocials%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fmetadata%2Fapp%2Fsocials%2Fpage.tsx?ref=75831c08e83abd120be3968ec32ee0e2a2c4d33d",
            "patch": "@@ -8,6 +8,9 @@ export async function generateMetadata() {\n       appId: '12345678',\n       admins: ['120', '122', '124'],\n     },\n+    pinterest: {\n+      richPin: true,\n+    },\n   }\n   return metadata\n }",
            "previous_filename": "test/e2e/app-dir/metadata/app/facebook/page.tsx"
        },
        {
            "sha": "1a5d7ea9f06cb4436aea44cef2ff46f2f7e6c87a",
            "filename": "test/e2e/app-dir/metadata/metadata.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/75831c08e83abd120be3968ec32ee0e2a2c4d33d/test%2Fe2e%2Fapp-dir%2Fmetadata%2Fmetadata.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/75831c08e83abd120be3968ec32ee0e2a2c4d33d/test%2Fe2e%2Fapp-dir%2Fmetadata%2Fmetadata.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fmetadata%2Fmetadata.test.ts?ref=75831c08e83abd120be3968ec32ee0e2a2c4d33d",
            "patch": "@@ -162,13 +162,14 @@ describe('app dir - metadata', () => {\n       )\n     })\n \n-    it('should support facebook related tags', async () => {\n-      const browser = await next.browser('/facebook')\n+    it('should support socials related tags like facebook and pinterest', async () => {\n+      const browser = await next.browser('/socials')\n       const matchMultiDom = createMultiDomMatcher(browser)\n \n       await matchMultiDom('meta', 'property', 'content', {\n         'fb:app_id': '12345678',\n         'fb:admins': ['120', '122', '124'],\n+        'pinterest-rich-pin': 'true',\n       })\n     })\n "
        }
    ],
    "stats": {
        "total": 49,
        "additions": 46,
        "deletions": 3
    }
}