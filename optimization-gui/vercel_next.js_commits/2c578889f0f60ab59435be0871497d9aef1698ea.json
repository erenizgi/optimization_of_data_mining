{
    "author": "ztanner",
    "message": "[dev-overlay]: allow disabled state to be dismissable (#76572)\n\nWhen you disable the dev indicator, either with `devIndicators: false`\nor clicking the hide button, we still show a minimized version so you\ncan open up the error overlay.\n\nThat version should also be dismissible within the current browser\nsession.\n\n\nhttps://github.com/user-attachments/assets/bbf114c1-2c73-4051-8fbc-dbd93acb7f64",
    "sha": "2c578889f0f60ab59435be0871497d9aef1698ea",
    "files": [
        {
            "sha": "9e5b0711dfd905fd5c0c99124c361ea494351d22",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/dev-tools-indicator/next-logo.tsx",
            "status": "modified",
            "additions": 15,
            "deletions": 9,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/2c578889f0f60ab59435be0871497d9aef1698ea/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2c578889f0f60ab59435be0871497d9aef1698ea/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fnext-logo.tsx?ref=2c578889f0f60ab59435be0871497d9aef1698ea",
            "patch": "@@ -77,6 +77,7 @@ export const NextLogo = forwardRef(function NextLogo(\n     shouldSkip: (count) => count === 0,\n     animationDuration: SHORT_DURATION_MS,\n   })\n+  const [dismissed, setDismissed] = useState(false)\n \n   const triggerRef = useRef<HTMLButtonElement | null>(null)\n   const ref = useRef<HTMLDivElement | null>(null)\n@@ -90,15 +91,18 @@ export const NextLogo = forwardRef(function NextLogo(\n     setIsErrorExpanded(hasError)\n   }, [hasError])\n \n+  const isExpanded = isErrorExpanded || disabled\n+\n   return (\n     <div\n       data-next-badge-root\n       style={\n         {\n           '--size': SIZE,\n           '--duration-short': `${SHORT_DURATION_MS}ms`,\n-          // if the indicator is disabled and there are no errors, hide the badge\n-          display: disabled && !hasError ? 'none' : 'block',\n+          // if the indicator is disabled, hide the badge\n+          // also allow the \"disabled\" state be dismissed, as long as there are no build errors\n+          display: disabled && (!hasError || dismissed) ? 'none' : 'block',\n         } as React.CSSProperties\n       }\n     >\n@@ -226,9 +230,7 @@ export const NextLogo = forwardRef(function NextLogo(\n             gap: 2px;\n             align-items: center;\n             padding-left: 8px;\n-            padding-right: ${disabled || isBuildError\n-              ? '8px'\n-              : 'calc(2px * 2)'};\n+            padding-right: ${isBuildError ? '8px' : 'calc(2px * 2)'};\n             height: var(--size-32);\n             margin: 0 2px;\n             border-radius: var(--rounded-full);\n@@ -422,7 +424,7 @@ export const NextLogo = forwardRef(function NextLogo(\n       <div\n         data-next-badge\n         data-error={hasError}\n-        data-error-expanded={isErrorExpanded}\n+        data-error-expanded={isExpanded}\n         data-animate={newErrorDetected}\n         style={{\n           width: hasError && width > SIZE_PX ? width : SIZE,\n@@ -441,7 +443,7 @@ export const NextLogo = forwardRef(function NextLogo(\n               <NextMark isLoading={isLoading} isDevBuilding={isDevBuilding} />\n             </button>\n           )}\n-          {isErrorExpanded && (\n+          {isExpanded && (\n             <div data-issues>\n               <button\n                 data-issues-open\n@@ -470,12 +472,16 @@ export const NextLogo = forwardRef(function NextLogo(\n                   )}\n                 </div>\n               </button>\n-              {!disabled && !isBuildError && (\n+              {!isBuildError && (\n                 <button\n                   data-issues-collapse\n                   aria-label=\"Collapse issues badge\"\n                   onClick={() => {\n-                    setIsErrorExpanded(false)\n+                    if (disabled) {\n+                      setDismissed(true)\n+                    } else {\n+                      setIsErrorExpanded(false)\n+                    }\n                     // Move focus to the trigger to prevent having it stuck on this element\n                     triggerRef.current?.focus()\n                   }}"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 15,
        "deletions": 9
    }
}