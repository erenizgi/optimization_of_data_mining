{
    "author": "mischnic",
    "message": "Allow building node-pty in tests (#77187)\n\nSee #76615\n\nPrevents failures like this one:\nhttps://github.com/vercel/next.js/actions/runs/13893521836/job/38869486683?pr=77183\n\n```\n╭ Warning ─────────────────────────────────────────────────────────────────────╮│                                                                              ││   Ignored build scripts: node-pty, sharp.                                    ││   Run \"pnpm approve-builds\" to pick which dependencies should be allowed     ││   to run scripts.                                                            ││                                                                              │╰──────────────────────────────────────────────────────────────────────────────╯\n\nDone in 2.3s using pnpm v10.5.1\n[Error: ENOENT: no such file or directory, lstat '/tmp/next-install-f1b51a9db51b727[335](https://github.com/vercel/next.js/actions/runs/13893521836/job/38869486683?pr=77183#step:33:338)132a63d491f5f34dbe98376b0a6a02f50106f2b0ef705b/.next/trace'] {\n  errno: -2,\n  code: 'ENOENT',\n  syscall: 'lstat',\n  path: '/tmp/next-install-f1b51a9db51b727335132a63d491f5f34dbe98376b0a6a02f50106f2b0ef705b/.next/trace'\n}\ndestroyed next instance: 199.685ms\nFAIL default test/production/build-spinners/index.test.ts\n  build-spinners\n    ✕ should handle build spinners correctly app dir - basic (8 ms)\n    ✕ should handle build spinners correctly app dir - (compile workers) (4 ms)\n    ✕ should handle build spinners correctly page dir (4 ms)\n    ✕ should handle build spinners correctly page dir (compile workers) (3 ms)\n    ✕ should handle build spinners correctly app and pages (3 ms)\n\n  ● build-spinners › should handle build spinners correctly app dir - basic\n\n    Cannot find module '../build/Release/pty.node' from '../../../../../../tmp/next-install-f1b51a9db51b7273[351](https://github.com/vercel/next.js/actions/runs/13893521836/job/38869486683?pr=77183#step:33:354)32a63d491f5f34dbe98376b0a6a02f50106f2b0ef705b/node_modules/.pnpm/node-pty@0.10.1/node_modules/node-pty/lib/unixTerminal.js'\n```",
    "sha": "dadd29beed2977065ee75aee206eac8462c5a70d",
    "files": [
        {
            "sha": "65032a25d7107fc38692968f8bb11b2145f07690",
            "filename": "test/production/build-spinners/index.test.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/dadd29beed2977065ee75aee206eac8462c5a70d/test%2Fproduction%2Fbuild-spinners%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dadd29beed2977065ee75aee206eac8462c5a70d/test%2Fproduction%2Fbuild-spinners%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fbuild-spinners%2Findex.test.ts?ref=dadd29beed2977065ee75aee206eac8462c5a70d",
            "patch": "@@ -55,6 +55,11 @@ describe('build-spinners', () => {\n       dependencies: {\n         'node-pty': '0.10.1',\n       },\n+      packageJson: {\n+        pnpm: {\n+          onlyBuiltDependencies: ['node-pty'],\n+        },\n+      },\n     })\n   })\n "
        }
    ],
    "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
    }
}