{
    "author": "ztanner",
    "message": "[cache components] stabilize cacheLife profiles (#85050)\n\nAs part of stabilizing `cacheComponents`, `cacheLife` profiles should\nalso be accessible from a top-level config. This updates the\nconfiguration, adds the warning, and updates relevant docs.",
    "sha": "1b949df737e216f4cd30cffa58782118731c17d5",
    "files": [
        {
            "sha": "eee738fe0d3ddf833552fe51a051972383fc156e",
            "filename": "docs/01-app/03-api-reference/04-functions/cacheLife.mdx",
            "status": "modified",
            "additions": 15,
            "deletions": 21,
            "changes": 36,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/docs%2F01-app%2F03-api-reference%2F04-functions%2FcacheLife.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/docs%2F01-app%2F03-api-reference%2F04-functions%2FcacheLife.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2FcacheLife.mdx?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -113,13 +113,11 @@ import type { NextConfig } from 'next'\n \n const nextConfig: NextConfig = {\n   cacheComponents: true,\n-  experimental: {\n-    cacheLife: {\n-      biweekly: {\n-        stale: 60 * 60 * 24 * 14, // 14 days\n-        revalidate: 60 * 60 * 24, // 1 day\n-        expire: 60 * 60 * 24 * 14, // 14 days\n-      },\n+  cacheLife: {\n+    biweekly: {\n+      stale: 60 * 60 * 24 * 14, // 14 days\n+      revalidate: 60 * 60 * 24, // 1 day\n+      expire: 60 * 60 * 24 * 14, // 14 days\n     },\n   },\n }\n@@ -130,13 +128,11 @@ module.exports = nextConfig\n ```js filename=\"next.config.js\" switcher\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: {\n-    cacheLife: {\n-      biweekly: {\n-        stale: 60 * 60 * 24 * 14, // 14 days\n-        revalidate: 60 * 60 * 24, // 1 day\n-        expire: 60 * 60 * 24 * 14, // 14 days\n-      },\n+  cacheLife: {\n+    biweekly: {\n+      stale: 60 * 60 * 24 * 14, // 14 days\n+      revalidate: 60 * 60 * 24, // 1 day\n+      expire: 60 * 60 * 24 * 14, // 14 days\n     },\n   },\n }\n@@ -167,13 +163,11 @@ The example below shows how to override the default “days” cache profile:\n ```ts filename=\"next.config.ts\"\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: {\n-    cacheLife: {\n-      days: {\n-        stale: 3600, // 1 hour\n-        revalidate: 900, // 15 minutes\n-        expire: 86400, // 1 day\n-      },\n+  cacheLife: {\n+    days: {\n+      stale: 3600, // 1 hour\n+      revalidate: 900, // 15 minutes\n+      expire: 86400, // 1 day\n     },\n   },\n }"
        },
        {
            "sha": "a5fdd1092bfce60e0c360f9fb6698fbbb236f3d9",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/cacheLife.mdx",
            "status": "modified",
            "additions": 10,
            "deletions": 14,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FcacheLife.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FcacheLife.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FcacheLife.mdx?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -15,13 +15,11 @@ import type { NextConfig } from 'next'\n \n const nextConfig: NextConfig = {\n   cacheComponents: true,\n-  experimental: {\n-    cacheLife: {\n-      blog: {\n-        stale: 3600, // 1 hour\n-        revalidate: 900, // 15 minutes\n-        expire: 86400, // 1 day\n-      },\n+  cacheLife: {\n+    blog: {\n+      stale: 3600, // 1 hour\n+      revalidate: 900, // 15 minutes\n+      expire: 86400, // 1 day\n     },\n   },\n }\n@@ -32,13 +30,11 @@ export default nextConfig\n ```js filename=\"next.config.js\" switcher\n module.exports = {\n   cacheComponents: true,\n-  experimental: {\n-    cacheLife: {\n-      blog: {\n-        stale: 3600, // 1 hour\n-        revalidate: 900, // 15 minutes\n-        expire: 86400, // 1 day\n-      },\n+  cacheLife: {\n+    blog: {\n+      stale: 3600, // 1 hour\n+      revalidate: 900, // 15 minutes\n+      expire: 86400, // 1 day\n     },\n   },\n }"
        },
        {
            "sha": "e944ac3345ab15a97b2bcb9f8259a0e9d9b6e0b8",
            "filename": "packages/next/errors.json",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Ferrors.json",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Ferrors.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ferrors.json?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -885,5 +885,7 @@\n   \"884\": \"Both %s file \\\"./%s\\\" and %s file \\\"./%s\\\" are detected. Please use \\\"./%s\\\" only.\",\n   \"885\": \"Page \\\"%s\\\" cannot use \\\\`export const unstable_prefetch = ...\\\\` without enabling \\\\`cacheComponents\\\\` and \\\\`experimental.clientSegmentCache\\\\`.\",\n   \"886\": \"`cacheTag()` is only available with the `cacheComponents` config.\",\n-  \"887\": \"`cacheLife()` is only available with the `cacheComponents` config.\"\n+  \"887\": \"`cacheLife()` is only available with the `cacheComponents` config.\",\n+  \"888\": \"Unknown \\\\`cacheLife()\\\\` profile \\\"%s\\\" is not configured in next.config.js\\\\nmodule.exports = {\\n  cacheLife: {\\n    \\\"%s\\\": ...\\\\n  }\\n}\",\n+  \"889\": \"Unknown \\\\`cacheLife()\\\\` profile \\\"%s\\\" is not configured in next.config.js\\\\nmodule.exports = {\\n  cacheLife: {\\n      \\\"%s\\\": ...\\\\n    }\\n}\"\n }"
        },
        {
            "sha": "bef575fdd2f7c29fdf124ea5c2f0b7f40f457d5d",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -1977,7 +1977,7 @@ export default async function build(\n               defaultLocale: config.i18n?.defaultLocale,\n               nextConfigOutput: config.output,\n               pprConfig: config.experimental.ppr,\n-              cacheLifeProfiles: config.experimental.cacheLife,\n+              cacheLifeProfiles: config.cacheLife,\n               buildId,\n               sriEnabled,\n             })\n@@ -2198,7 +2198,7 @@ export default async function build(\n                             maxMemoryCacheSize: config.cacheMaxMemorySize,\n                             nextConfigOutput: config.output,\n                             pprConfig: config.experimental.ppr,\n-                            cacheLifeProfiles: config.experimental.cacheLife,\n+                            cacheLifeProfiles: config.cacheLife,\n                             buildId,\n                             sriEnabled,\n                           })"
        },
        {
            "sha": "58035819a0354fdfc6ab6e8ff5530fbb1f4a1ad8",
            "filename": "packages/next/src/build/templates/app-page.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -531,7 +531,7 @@ export async function handler(\n \n           multiZoneDraftMode,\n           incrementalCache,\n-          cacheLifeProfiles: nextConfig.experimental.cacheLife,\n+          cacheLifeProfiles: nextConfig.cacheLife,\n           basePath: nextConfig.basePath,\n           serverActions: nextConfig.experimental.serverActions,\n "
        },
        {
            "sha": "b917f90942224277a6d181a1b44f5604c2a00af1",
            "filename": "packages/next/src/build/templates/app-route.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-route.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-route.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-route.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -195,7 +195,7 @@ export async function handler(\n       cacheComponents: Boolean(nextConfig.cacheComponents),\n       supportsDynamicResponse,\n       incrementalCache: getRequestMeta(req, 'incrementalCache'),\n-      cacheLifeProfiles: nextConfig.experimental?.cacheLife,\n+      cacheLifeProfiles: nextConfig.cacheLife,\n       waitUntil: ctx.waitUntil,\n       onClose: (cb) => {\n         res.on('close', cb)"
        },
        {
            "sha": "566af90348e256438908e6c66df043bdfa7d6b2a",
            "filename": "packages/next/src/build/templates/edge-ssr-app.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -152,7 +152,7 @@ async function requestHandler(\n       reactMaxHeadersLength: nextConfig.reactMaxHeadersLength,\n \n       multiZoneDraftMode: false,\n-      cacheLifeProfiles: nextConfig.experimental.cacheLife,\n+      cacheLifeProfiles: nextConfig.cacheLife,\n       basePath: nextConfig.basePath,\n       serverActions: nextConfig.experimental.serverActions,\n       cacheComponents: Boolean(nextConfig.cacheComponents),"
        },
        {
            "sha": "ebd05ad02c99d59f6e45a2e94c6819d63f4794af",
            "filename": "packages/next/src/build/webpack-config.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -2143,7 +2143,7 @@ export default async function getBaseWebpackConfig(\n           dev,\n           isEdgeServer,\n           pageExtensions: config.pageExtensions,\n-          cacheLifeConfig: config.experimental.cacheLife,\n+          cacheLifeConfig: config.cacheLife,\n           originalRewrites,\n           originalRedirects,\n         }),"
        },
        {
            "sha": "9611e74b533a37de9a2a55b5dbf61e882faec398",
            "filename": "packages/next/src/export/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -379,7 +379,7 @@ async function exportAppImpl(\n     largePageDataBytes: nextConfig.experimental.largePageDataBytes,\n     serverActions: nextConfig.experimental.serverActions,\n     serverComponents: enabledDirectories.app,\n-    cacheLifeProfiles: nextConfig.experimental.cacheLife,\n+    cacheLifeProfiles: nextConfig.cacheLife,\n     nextFontManifest: require(\n       join(distDir, 'server', `${NEXT_FONT_MANIFEST}.json`)\n     ),"
        },
        {
            "sha": "62e75cdf217d8009d8ad9783fb1bb406528314b7",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -535,7 +535,7 @@ export default abstract class Server<\n       domainLocales: this.nextConfig.i18n?.domains,\n       distDir: this.distDir,\n       serverComponents: this.enabledDirectories.app,\n-      cacheLifeProfiles: this.nextConfig.experimental.cacheLife,\n+      cacheLifeProfiles: this.nextConfig.cacheLife,\n       enableTainting: this.nextConfig.experimental.taint,\n       crossOrigin: this.nextConfig.crossOrigin\n         ? this.nextConfig.crossOrigin"
        },
        {
            "sha": "6ab07877ff75ead4e11e64105859bc97d2f0fd83",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -356,6 +356,15 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n     bundlePagesRouterDependencies: z.boolean().optional(),\n     cacheComponents: z.boolean().optional(),\n     cacheHandler: z.string().min(1).optional(),\n+    cacheLife: z\n+      .record(\n+        z.object({\n+          stale: z.number().optional(),\n+          revalidate: z.number().optional(),\n+          expire: z.number().optional(),\n+        })\n+      )\n+      .optional(),\n     cacheMaxMemorySize: z.number().optional(),\n     cleanDistDir: z.boolean().optional(),\n     compiler: z"
        },
        {
            "sha": "41215dda83a6bd576be310e919095b75c249f2c9",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 54,
            "deletions": 37,
            "changes": 91,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -305,6 +305,9 @@ export interface ExperimentalConfig {\n     dynamic?: number\n     static?: number\n   }\n+  /**\n+   * @deprecated use top-level `cacheLife` instead\n+   */\n   cacheLife?: {\n     [profile: string]: {\n       // How long the client can cache a value without checking with the server.\n@@ -1270,6 +1273,20 @@ export interface NextConfig {\n    */\n   cacheComponents?: boolean\n \n+  cacheLife?: {\n+    [profile: string]: {\n+      // How long the client can cache a value without checking with the server.\n+      stale?: number\n+      // How frequently you want the cache to refresh on the server.\n+      // Stale values may be served while revalidating.\n+      revalidate?: number\n+      // In the worst case scenario, where you haven't had traffic in a while,\n+      // how stale can a value be until you prefer deopting to dynamic.\n+      // Must be longer than revalidate.\n+      expire?: number\n+    }\n+  }\n+\n   /**\n    * period (in seconds) where the server allow to serve stale cache\n    */\n@@ -1398,46 +1415,46 @@ export const defaultConfig = Object.freeze({\n   // Will default to cacheComponents value.\n   enablePrerenderSourceMaps: undefined,\n   cacheComponents: false,\n+  cacheLife: {\n+    default: {\n+      stale: undefined, // defaults to staleTimes.static\n+      revalidate: 60 * 15, // 15 minutes\n+      expire: INFINITE_CACHE,\n+    },\n+    seconds: {\n+      stale: 30, // 30 seconds\n+      revalidate: 1, // 1 second\n+      expire: 60, // 1 minute\n+    },\n+    minutes: {\n+      stale: 60 * 5, // 5 minutes\n+      revalidate: 60, // 1 minute\n+      expire: 60 * 60, // 1 hour\n+    },\n+    hours: {\n+      stale: 60 * 5, // 5 minutes\n+      revalidate: 60 * 60, // 1 hour\n+      expire: 60 * 60 * 24, // 1 day\n+    },\n+    days: {\n+      stale: 60 * 5, // 5 minutes\n+      revalidate: 60 * 60 * 24, // 1 day\n+      expire: 60 * 60 * 24 * 7, // 1 week\n+    },\n+    weeks: {\n+      stale: 60 * 5, // 5 minutes\n+      revalidate: 60 * 60 * 24 * 7, // 1 week\n+      expire: 60 * 60 * 24 * 30, // 1 month\n+    },\n+    max: {\n+      stale: 60 * 5, // 5 minutes\n+      revalidate: 60 * 60 * 24 * 30, // 1 month\n+      expire: 60 * 60 * 24 * 365, // 1 year\n+    },\n+  },\n   experimental: {\n     adapterPath: process.env.NEXT_ADAPTER_PATH || undefined,\n     useSkewCookie: false,\n-    cacheLife: {\n-      default: {\n-        stale: undefined, // defaults to staleTimes.static\n-        revalidate: 60 * 15, // 15 minutes\n-        expire: INFINITE_CACHE,\n-      },\n-      seconds: {\n-        stale: 30, // 30 seconds\n-        revalidate: 1, // 1 second\n-        expire: 60, // 1 minute\n-      },\n-      minutes: {\n-        stale: 60 * 5, // 5 minutes\n-        revalidate: 60, // 1 minute\n-        expire: 60 * 60, // 1 hour\n-      },\n-      hours: {\n-        stale: 60 * 5, // 5 minutes\n-        revalidate: 60 * 60, // 1 hour\n-        expire: 60 * 60 * 24, // 1 day\n-      },\n-      days: {\n-        stale: 60 * 5, // 5 minutes\n-        revalidate: 60 * 60 * 24, // 1 day\n-        expire: 60 * 60 * 24 * 7, // 1 week\n-      },\n-      weeks: {\n-        stale: 60 * 5, // 5 minutes\n-        revalidate: 60 * 60 * 24 * 7, // 1 week\n-        expire: 60 * 60 * 24 * 30, // 1 month\n-      },\n-      max: {\n-        stale: 60 * 5, // 5 minutes\n-        revalidate: 60 * 60 * 24 * 30, // 1 month\n-        expire: 60 * 60 * 24 * 365, // 1 year\n-      },\n-    },\n     cacheHandlers: {\n       default: process.env.NEXT_DEFAULT_CACHE_HANDLER_PATH,\n       remote: process.env.NEXT_REMOTE_CACHE_HANDLER_PATH,"
        },
        {
            "sha": "e24f5eb59a90fbc442e854a59d945fb4e23ea5e6",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 7,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -717,6 +717,13 @@ function assignDefaultsAndValidate(\n     configFileName,\n     silent\n   )\n+  warnOptionHasBeenMovedOutOfExperimental(\n+    result,\n+    'cacheLife',\n+    'cacheLife',\n+    configFileName,\n+    silent\n+  )\n \n   if ((result.experimental as any).outputStandalone) {\n     if (!silent) {\n@@ -1086,12 +1093,12 @@ function assignDefaultsAndValidate(\n     }\n   }\n \n-  if (result.experimental) {\n-    result.experimental.cacheLife = {\n-      ...defaultConfig.experimental?.cacheLife,\n-      ...result.experimental.cacheLife,\n+  if (result.cacheLife) {\n+    result.cacheLife = {\n+      ...defaultConfig.cacheLife,\n+      ...result.cacheLife,\n     }\n-    const defaultDefault = defaultConfig.experimental?.cacheLife?.['default']\n+    const defaultDefault = defaultConfig.cacheLife?.['default']\n     if (\n       !defaultDefault ||\n       defaultDefault.revalidate === undefined ||\n@@ -1100,9 +1107,9 @@ function assignDefaultsAndValidate(\n     ) {\n       throw new Error('No default cacheLife profile.')\n     }\n-    const defaultCacheLifeProfile = result.experimental.cacheLife['default']\n+    const defaultCacheLifeProfile = result.cacheLife['default']\n     if (!defaultCacheLifeProfile) {\n-      result.experimental.cacheLife['default'] = defaultDefault\n+      result.cacheLife['default'] = defaultDefault\n     } else {\n       if (defaultCacheLifeProfile.stale === undefined) {\n         const staticStaleTime = result.experimental.staleTimes?.static"
        },
        {
            "sha": "4aa1496825c5f108caaa6ddda87d984e954110b0",
            "filename": "packages/next/src/server/dev/next-dev-server.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fnext-dev-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fnext-dev-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fnext-dev-server.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -761,7 +761,7 @@ export default class DevServer extends Server {\n           requestHeaders,\n           cacheHandler: this.nextConfig.cacheHandler,\n           cacheHandlers: this.nextConfig.experimental.cacheHandlers,\n-          cacheLifeProfiles: this.nextConfig.experimental.cacheLife,\n+          cacheLifeProfiles: this.nextConfig.cacheLife,\n           fetchCacheKeyPrefix: this.nextConfig.experimental.fetchCacheKeyPrefix,\n           isrFlushToDisk: this.nextConfig.experimental.isrFlushToDisk,\n           maxMemoryCacheSize: this.nextConfig.cacheMaxMemorySize,"
        },
        {
            "sha": "1afe1985b32f66bc812a60c6602257034a2182e1",
            "filename": "packages/next/src/server/use-cache/cache-life.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fcache-life.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fcache-life.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fcache-life.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -136,10 +136,8 @@ export function cacheLife(profile: CacheLifeProfiles | CacheLife): void {\n       throw new Error(\n         `Unknown \\`cacheLife()\\` profile \"${profile}\" is not configured in next.config.js\\n` +\n           'module.exports = {\\n' +\n-          '  experimental: {\\n' +\n-          '    cacheLife: {\\n' +\n-          `      \"${profile}\": ...\\n` +\n-          '    }\\n' +\n+          '  cacheLife: {\\n' +\n+          `    \"${profile}\": ...\\n` +\n           '  }\\n' +\n           '}'\n       )"
        },
        {
            "sha": "5af22eebcfcfafe14ea4c641b4f151c9ad442504",
            "filename": "packages/next/src/server/web/edge-route-module-wrapper.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fedge-route-module-wrapper.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fedge-route-module-wrapper.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fedge-route-module-wrapper.ts?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -111,7 +111,7 @@ export class EdgeRouteModuleWrapper {\n         experimental: {\n           authInterrupts: !!process.env.__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS,\n         },\n-        cacheLifeProfiles: this.nextConfig.experimental.cacheLife,\n+        cacheLifeProfiles: this.nextConfig.cacheLife,\n       },\n       sharedContext: {\n         buildId: '', // TODO: Populate this properly."
        },
        {
            "sha": "0429ac62b5a9a46d2b7063142e806c0361c8425b",
            "filename": "test/e2e/app-dir/ppr-unstable-cache/next.config.js",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/test%2Fe2e%2Fapp-dir%2Fppr-unstable-cache%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/test%2Fe2e%2Fapp-dir%2Fppr-unstable-cache%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fppr-unstable-cache%2Fnext.config.js?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -1,12 +1,10 @@\n module.exports = {\n   cacheComponents: true,\n-  experimental: {\n-    cacheLife: {\n-      expireNow: {\n-        stale: 0,\n-        expire: 0,\n-        revalidate: 0,\n-      },\n+  cacheLife: {\n+    expireNow: {\n+      stale: 0,\n+      expire: 0,\n+      revalidate: 0,\n     },\n   },\n }"
        },
        {
            "sha": "1e661af578e684eba5cc4cbda5c8318c2dc85b28",
            "filename": "test/e2e/app-dir/revalidate-dynamic/next.config.mjs",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fnext.config.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fnext.config.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fnext.config.mjs?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -1,11 +1,9 @@\n const nextConfig = {\n-  experimental: {\n-    cacheLife: {\n-      expireNow: {\n-        stale: 0,\n-        expire: 0,\n-        revalidate: 0,\n-      },\n+  cacheLife: {\n+    expireNow: {\n+      stale: 0,\n+      expire: 0,\n+      revalidate: 0,\n     },\n   },\n }"
        },
        {
            "sha": "ebd83601208ebae2534dba2590c9c47acb87dfba",
            "filename": "test/e2e/app-dir/use-cache/next.config.js",
            "status": "modified",
            "additions": 12,
            "deletions": 12,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fnext.config.js?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -4,24 +4,24 @@\n const nextConfig = {\n   experimental: {\n     useCache: true,\n-    cacheLife: {\n-      frequent: {\n-        stale: 19,\n-        revalidate: 100,\n-        expire: 300,\n-      },\n-      expireNow: {\n-        stale: 0,\n-        expire: 0,\n-        revalidate: 0,\n-      },\n-    },\n     cacheHandlers: {\n       custom: require.resolve(\n         'next/dist/server/lib/cache-handlers/default.external'\n       ),\n     },\n   },\n+  cacheLife: {\n+    frequent: {\n+      stale: 19,\n+      revalidate: 100,\n+      expire: 300,\n+    },\n+    expireNow: {\n+      stale: 0,\n+      expire: 0,\n+      revalidate: 0,\n+    },\n+  },\n   cacheHandler: require.resolve('./incremental-cache-handler'),\n }\n "
        },
        {
            "sha": "851fed853311611c80bd9522c630f1df5d50655a",
            "filename": "test/production/app-dir/global-default-cache-handler/next.config.js",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/1b949df737e216f4cd30cffa58782118731c17d5/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/1b949df737e216f4cd30cffa58782118731c17d5/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fnext.config.js?ref=1b949df737e216f4cd30cffa58782118731c17d5",
            "patch": "@@ -5,12 +5,12 @@ const nextConfig = {\n   output: 'standalone',\n   experimental: {\n     useCache: true,\n-    cacheLife: {\n-      expireNow: {\n-        stale: 0,\n-        expire: 0,\n-        revalidate: 0,\n-      },\n+  },\n+  cacheLife: {\n+    expireNow: {\n+      stale: 0,\n+      expire: 0,\n+      revalidate: 0,\n     },\n   },\n }"
        }
    ],
    "stats": {
        "total": 271,
        "additions": 145,
        "deletions": 126
    }
}