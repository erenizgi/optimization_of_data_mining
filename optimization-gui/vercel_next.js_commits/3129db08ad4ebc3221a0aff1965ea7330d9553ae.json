{
    "author": "lukesandberg",
    "message": "[turbopack] Allow withRspack to work even if you already have NEXT_RSPACK set (#84987)\n\nFix an issue where if a user set `NEXT_RSPACK` as an environment variable then `next` would think it was using rspack but `withRspack` would think it was using `--webpack`.   The issue is that the idempotency check was too strict.\n\nThis partially reverts https://github.com/vercel/next.js/pull/84885",
    "sha": "3129db08ad4ebc3221a0aff1965ea7330d9553ae",
    "files": [
        {
            "sha": "e538ed4d7f9bdf5c90b871ec1eb990bb01d74532",
            "filename": "packages/next-rspack/index.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/packages%2Fnext-rspack%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/packages%2Fnext-rspack%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-rspack%2Findex.js?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,10 +1,10 @@\n Error.stackTraceLimit = 100\n module.exports = function withRspack(config) {\n-  if (process.env.NEXT_RSPACK === 'true') {\n+  if (process.env.NEXT_RSPACK) {\n     // we have already been called.  This can happen when using build workers.\n     return config\n   }\n-  if (!process.env.TURBOPACK || process.env.TURBOPACK === 'auto') {\n+  if (process.env.TURBOPACK === 'auto') {\n     delete process.env.TURBOPACK\n     process.env.RSPACK_CONFIG_VALIDATE = 'loose-silent'\n     process.env.NEXT_RSPACK = 'true'"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    }
}