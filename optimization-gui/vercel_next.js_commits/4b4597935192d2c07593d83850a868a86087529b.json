{
    "author": "icyJoseph",
    "message": "Docs/use cache feedback 2 (#85222)\n\n- [x] Update Error",
    "sha": "4b4597935192d2c07593d83850a868a86087529b",
    "files": [
        {
            "sha": "8e8209777c58f581ff41fabd4793c1eaba50601d",
            "filename": "docs/01-app/01-getting-started/06-cache-components.mdx",
            "status": "modified",
            "additions": 21,
            "deletions": 11,
            "changes": 32,
            "blob_url": "https://github.com/vercel/next.js/blob/4b4597935192d2c07593d83850a868a86087529b/docs%2F01-app%2F01-getting-started%2F06-cache-components.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/4b4597935192d2c07593d83850a868a86087529b/docs%2F01-app%2F01-getting-started%2F06-cache-components.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F01-getting-started%2F06-cache-components.mdx?ref=4b4597935192d2c07593d83850a868a86087529b",
            "patch": "@@ -48,7 +48,7 @@ When a user visits a route:\n \n > **ðŸŽ¥ Watch:** Why PPR and how it works â†’ [YouTube (10 minutes)](https://www.youtube.com/watch?v=MTcPrTIBkpA).\n \n-## How it Works\n+## How it works\n \n Cache Components gives you three key tools to control rendering:\n \n@@ -61,6 +61,7 @@ Some data is only available at runtime when an actual user makes a request. APIs\n - [`cookies`](/docs/app/api-reference/functions/cookies)\n - [`headers`](/docs/app/api-reference/functions/headers)\n - [`searchParams` prop](/docs/app/api-reference/file-conventions/page#searchparams-optional)\n+- [`params` prop](/docs/app/api-reference/file-conventions/page#params-optional) - This is runtime data unless you provide at least one example value through [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params). When provided, those specific param values are treated as static for prerendered paths, while other values remain runtime\n \n ### 2. Suspense for dynamic data\n \n@@ -71,21 +72,20 @@ Dynamic data like [`fetch`](/docs/app/api-reference/functions/fetch) calls or da\n - [`fetch`](/docs/app/api-reference/functions/fetch) requests\n - Database queries\n - [`connection`](/docs/app/api-reference/functions/connection)\n-- [`unstable_noStore`](/docs/app/api-reference/functions/unstable_noStore)\n \n ### 3. Cached data with `use cache`\n \n Add `use cache` to any Server Component to make it cached and include it in the pre-rendered shell. You cannot use runtime APIs from inside a cached component. You can also mark utility functions as `use cache` and call them from Server Components.\n \n ```tsx\n-'use cache'\n export async function getProducts() {\n+  'use cache'\n   const data = await db.query('SELECT * FROM products')\n   return data\n }\n ```\n \n-## Using Suspense Boundaries\n+## Using Suspense boundaries\n \n React [Suspense](https://react.dev/reference/react/Suspense) boundaries let you define what fallback UI to use when it wraps dynamic or runtime data.\n \n@@ -137,17 +137,27 @@ async function DynamicContent() {\n \n At build time, Next.js pre-renders the static content and the `fallback` UI, while the dynamic content is postponed until a user requests the route.\n \n-Wrapping a component in `Suspense` doesn't make it dynamic; your API usage does. `Suspense` acts as a boundary that encapsulates dynamic content and enables streaming.\n+> **Good to know**: Wrapping a component in `Suspense` doesn't make it dynamic; your API usage does. `Suspense` acts as a boundary that encapsulates dynamic content and enables streaming.\n \n ### Missing Suspense boundaries\n \n-Cache Components enforces that dynamic code must be wrapped in a `Suspense` boundary. If you forget, you'll see this error:\n+Cache Components enforces that dynamic code must be wrapped in a `Suspense` boundary. If you forget, you'll see the [Uncached data was accessed outside of `<Suspense>`](https://nextjs.org/docs/messages/blocking-route) error:\n \n-> Uncached data was accessed outside of `<Suspense>`\n+> **Uncached data was accessed outside of `<Suspense>`**\n >\n > This delays the entire page from rendering, resulting in a slow user\n > experience. Next.js uses this error to ensure your app loads instantly\n > on every navigation.\n+>\n+> To fix this, you can either:\n+>\n+> **Wrap the component in a `<Suspense>`** boundary. This allows Next.js to stream its contents to the user as soon as it's ready, without blocking the rest of the app.\n+>\n+> or\n+>\n+> **Move the asynchronous await into a Cache Component(\"use cache\")**. This allows Next.js to statically prerender the component as part of the HTML document, so it's instantly visible to the user.\n+>\n+> Note that request-specific information, such as params, cookies, and headers, is not available during static prerendering, so it must be wrapped in `<Suspense>`.\n \n This error helps prevent a situation where, instead of getting a static shell instantly, users would hit a blocking runtime render with nothing to show. To fix it, add a `Suspense` boundary or use `use cache` to cache the work instead.\n \n@@ -181,7 +191,7 @@ To reduce network overhead, the full response, including static HTML and streame\n \n While `Suspense` boundaries manage dynamic content, the [`use cache`](/docs/app/api-reference/directives/use-cache) directive is available for caching data or computations that don't change often.\n \n-### Basic Usage\n+### Basic usage\n \n Add `use cache` to cache a page, component, or async function, and define a lifetime with [`cacheLife`](/docs/app/api-reference/functions/cacheLife):\n \n@@ -251,7 +261,7 @@ export async function CachedWrapper({ children }) {\n \n You must not pass dynamic or runtime data into `use cache` functions unless you avoid introspecting them. Passing values from `cookies()`, `headers()`, or other runtime APIs as arguments will cause errors, as the cache key cannot be determined at pre-render time.\n \n-### Tagging and Revalidating\n+### Tagging and revalidating\n \n Tag cached data with [`cacheTag`](/docs/app/api-reference/functions/cacheTag) and revalidate it after mutations using [`updateTag`](/docs/app/api-reference/functions/updateTag) in Server Actions for immediate updates, or [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) delay in updates are acceptable.\n \n@@ -321,7 +331,7 @@ const nextConfig = {\n module.exports = nextConfig\n ```\n \n-### Effect on Route Segment Config\n+### Effect on route segment config\n \n When Cache Components is enabled, several route segment config options are no longer needed or supported. Here's what changes and how to migrate:\n \n@@ -412,7 +422,7 @@ export default async function Page() {\n }\n ```\n \n-## Before vs. After Cache Components\n+## Before vs. after Cache Components\n \n Understanding how Cache Components changes your mental model:\n "
        },
        {
            "sha": "6f9a3d660ba6aae626d50d9cf0fcf18a5bebc550",
            "filename": "docs/01-app/03-api-reference/04-functions/use-pathname.mdx",
            "status": "modified",
            "additions": 13,
            "deletions": 4,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/4b4597935192d2c07593d83850a868a86087529b/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-pathname.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/4b4597935192d2c07593d83850a868a86087529b/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-pathname.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-pathname.mdx?ref=4b4597935192d2c07593d83850a868a86087529b",
            "patch": "@@ -5,6 +5,8 @@ description: API Reference for the usePathname hook.\n \n `usePathname` is a **Client Component** hook that lets you read the current URL's **pathname**.\n \n+> **Good to know**: When [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) is enabled `usePathname` may require a `Suspense` boundary around it if your route has a dynamic param. If you use `generateStaticParams` the `Suspense` boundary is optional\n+\n ```tsx filename=\"app/example-client-component.tsx\" switcher\n 'use client'\n \n@@ -34,10 +36,17 @@ For example, a Client Component with `usePathname` will be rendered into HTML on\n > **Good to know**:\n >\n > - Reading the current URL from a [Server Component](/docs/app/getting-started/server-and-client-components) is not supported. This design is intentional to support layout state being preserved across page navigations.\n-> - Compatibility mode:\n->   - `usePathname` can return `null` when a [fallback route](/docs/pages/api-reference/functions/get-static-paths#fallback-true) is being rendered or when a `pages` directory page has been [automatically statically optimized](/docs/pages/building-your-application/rendering/automatic-static-optimization) by Next.js and the router is not ready.\n->   - When using `usePathname` with rewrites in [`next.config`](/docs/app/api-reference/config/next-config-js/rewrites) or [`Proxy`](/docs/app/api-reference/file-conventions/proxy), `useState` and `useEffect` must also be used in order to avoid hydration mismatch errors.\n->   - Next.js will automatically update your types if it detects both an `app` and `pages` directory in your project.\n+> - If your page is being statically pre-rendered and your app has [rewrites](/docs/app/api-reference/config/next-config-js/rewrites) in `next.config` or a [Proxy](/docs/app/api-reference/file-conventions/proxy) file, reading the pathname with `usePathname()` can result in hydration mismatch errorsâ€”because the initial value comes from the server and may not match the actual browser pathname after routing. See our [example](#avoid-hydration-mismatch-with-rewrites) for a way to mitigate this issue.\n+\n+<details>\n+\n+<summary>Compatibility with Pages Router</summary>\n+\n+If you have components that use `usePathname` and they are imported into routes within the Pages Router, be aware that `usePathname` may return `null` if the router is not yet initialized. This can occur in cases such as [fallback routes](/docs/pages/api-reference/functions/get-static-paths#fallback-true) or during [Automatic Static Optimization](https://nextjs.org/docs/pages/building-your-application/rendering/static#automatic-static-optimization) in the Pages Router.\n+\n+To enhance compatibility between routing systems, if your project contains both an `app` and a `pages` directory, Next.js will automatically adjust the return type of `usePathname`.\n+\n+</details>\n \n ## Parameters\n "
        }
    ],
    "stats": {
        "total": 49,
        "additions": 34,
        "deletions": 15
    }
}