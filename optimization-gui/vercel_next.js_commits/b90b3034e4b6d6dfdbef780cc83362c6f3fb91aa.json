{
    "author": "icyJoseph",
    "message": "docs: i18n type narrowing w/ runtime guards (#86871)\n\nCloses: https://github.com/vercel/next.js/issues/86864",
    "sha": "b90b3034e4b6d6dfdbef780cc83362c6f3fb91aa",
    "files": [
        {
            "sha": "b7d5bbb568079dab337f6d64f1b0892f248559e1",
            "filename": "docs/01-app/02-guides/internationalization.mdx",
            "status": "modified",
            "additions": 27,
            "deletions": 20,
            "changes": 47,
            "blob_url": "https://github.com/vercel/next.js/blob/b90b3034e4b6d6dfdbef780cc83362c6f3fb91aa/docs%2F01-app%2F02-guides%2Finternationalization.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/b90b3034e4b6d6dfdbef780cc83362c6f3fb91aa/docs%2F01-app%2F02-guides%2Finternationalization.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Finternationalization.mdx?ref=b90b3034e4b6d6dfdbef780cc83362c6f3fb91aa",
            "patch": "@@ -72,11 +72,7 @@ Finally, ensure all special files inside `app/` are nested under `app/[lang]`. T\n ```tsx filename=\"app/[lang]/page.tsx\" switcher\n // You now have access to the current locale\n // e.g. /en-US/products -> `lang` is \"en-US\"\n-export default async function Page({\n-  params,\n-}: {\n-  params: Promise<{ lang: string }>\n-}) {\n+export default async function Page({ params }: PageProps<'/[lang]'>) {\n   const { lang } = await params\n   return ...\n }\n@@ -91,6 +87,8 @@ export default async function Page({ params }) {\n }\n ```\n \n+> **Good to know:** `PageProps` and `LayoutProps` are globally available TypeScript helpers that provide strong typing for route parameters. See [PageProps](/docs/app/api-reference/file-conventions/page#page-props-helper) and [LayoutProps](/docs/app/api-reference/file-conventions/layout#layout-props-helper) for more details.\n+\n The root layout can also be nested in the new folder (e.g. `app/[lang]/layout.js`).\n \n ## Localization\n@@ -125,8 +123,12 @@ const dictionaries = {\n   nl: () => import('./dictionaries/nl.json').then((module) => module.default),\n }\n \n-export const getDictionary = async (locale: 'en' | 'nl') =>\n-  dictionaries[locale]()\n+export type Locale = keyof typeof dictionaries\n+\n+export const hasLocale = (locale: string): locale is Locale =>\n+  locale in dictionaries\n+\n+export const getDictionary = async (locale: Locale) => dictionaries[locale]()\n ```\n \n ```js filename=\"app/[lang]/dictionaries.js\" switcher\n@@ -137,31 +139,39 @@ const dictionaries = {\n   nl: () => import('./dictionaries/nl.json').then((module) => module.default),\n }\n \n+export const hasLocale = (locale) => locale in dictionaries\n+\n export const getDictionary = async (locale) => dictionaries[locale]()\n ```\n \n Given the currently selected language, we can fetch the dictionary inside of a layout or page.\n \n+Since `lang` is typed as `string`, using `hasLocale` narrows the type to your supported locales. It also ensures a 404 is returned if a translation is missing, rather than a runtime error.\n+\n ```tsx filename=\"app/[lang]/page.tsx\" switcher\n-import { getDictionary } from './dictionaries'\n+import { notFound } from 'next/navigation'\n+import { getDictionary, hasLocale } from './dictionaries'\n \n-export default async function Page({\n-  params,\n-}: {\n-  params: Promise<{ lang: 'en' | 'nl' }>\n-}) {\n+export default async function Page({ params }: PageProps<'/[lang]'>) {\n   const { lang } = await params\n-  const dict = await getDictionary(lang) // en\n+\n+  if (!hasLocale(lang)) notFound()\n+\n+  const dict = await getDictionary(lang)\n   return <button>{dict.products.cart}</button> // Add to Cart\n }\n ```\n \n ```jsx filename=\"app/[lang]/page.js\" switcher\n-import { getDictionary } from './dictionaries'\n+import { notFound } from 'next/navigation'\n+import { getDictionary, hasLocale } from './dictionaries'\n \n export default async function Page({ params }) {\n   const { lang } = await params\n-  const dict = await getDictionary(lang) // en\n+\n+  if (!hasLocale(lang)) notFound()\n+\n+  const dict = await getDictionary(lang)\n   return <button>{dict.products.cart}</button> // Add to Cart\n }\n ```\n@@ -180,10 +190,7 @@ export async function generateStaticParams() {\n export default async function RootLayout({\n   children,\n   params,\n-}: Readonly<{\n-  children: React.ReactNode\n-  params: Promise<{ lang: 'en-US' | 'de' }>\n-}>) {\n+}: LayoutProps<'/[lang]'>) {\n   return (\n     <html lang={(await params).lang}>\n       <body>{children}</body>"
        }
    ],
    "stats": {
        "total": 47,
        "additions": 27,
        "deletions": 20
    }
}