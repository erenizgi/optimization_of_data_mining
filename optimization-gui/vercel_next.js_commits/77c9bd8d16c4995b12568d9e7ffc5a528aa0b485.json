{
    "author": "unstubbable",
    "message": "Avoid timeout error when transformed params are passed to `\"use cache\"` (#80463)\n\nWith #79743, we're now providing a filled Resume Data Cache (RDC) when\nprerendering optional fallback shells for routes that have some params\ndefined in `generateStaticParams`.\n\nThis allows us to treat a cache miss in the RDC as an indication that\nparams were part of the cache key. In this case, we can make the cache\nfunction a dynamic hole in the shell (or produce an empty shell if\nthere's no parent suspense boundary).\n\nCurrently, this also includes layouts and pages that don't read params,\nwhich will be improved when we implement NAR-136. Otherwise, we assume\nthat if params are passed explicitly into a `\"use cache\"` function, that\nthe params are also accessed (same as in #78882). This allows us to\nabort early, and treat the function as dynamic, instead of waiting for\nthe timeout to be reached, even when params are transformed with an\nasync function, before being passed into the \"use cache\" function, e.g.:\n\n```js\nimport { CachedComponent } from './cached-component'\n\nasync function getSlug(params) {\n  const { slug } = await params\n\n  return slug\n}\n\nexport default function Page({ params }) {\n  return <CachedComponent slugPromise={getSlug(params)} />\n}\n\nexport async function generateStaticParams() {\n  return [{ slug: 'foo' }]\n}\n```\n\nThis escapes the instrumentation we do to bailout early on fallback\nparams access. That handling is still needed though when prerendering\nfallback shells of routes that don't have any params defined in\n`generateStaticParams`, as we don't have a prefilled RDC in that case.",
    "sha": "77c9bd8d16c4995b12568d9e7ffc5a528aa0b485",
    "files": [
        {
            "sha": "9cc898a553cd07bd865794edd8e9d0670029947f",
            "filename": "packages/next/src/server/app-render/app-render.tsx",
            "status": "modified",
            "additions": 16,
            "deletions": 26,
            "changes": 42,
            "blob_url": "https://github.com/vercel/next.js/blob/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx?ref=77c9bd8d16c4995b12568d9e7ffc5a528aa0b485",
            "patch": "@@ -194,7 +194,6 @@ import {\n   trackPendingImport,\n   trackPendingModules,\n } from './module-loading/track-module-loading.external'\n-import { isUseCacheTimeoutError } from '../use-cache/use-cache-errors'\n \n export type GetDynamicParamFromSegment = (\n   // [slug] / [[slug]] / [...slug]\n@@ -669,7 +668,11 @@ async function warmupDevRender(\n     workStore,\n   } = ctx\n \n-  const { dev, onInstrumentationRequestError } = renderOpts\n+  const {\n+    allowEmptyStaticShell = false,\n+    dev,\n+    onInstrumentationRequestError,\n+  } = renderOpts\n \n   if (!dev) {\n     throw new InvariantError(\n@@ -711,6 +714,7 @@ async function warmupDevRender(\n     controller: prerenderController,\n     cacheSignal,\n     dynamicTracking: null,\n+    allowEmptyStaticShell,\n     revalidate: INFINITE_CACHE,\n     expire: INFINITE_CACHE,\n     stale: INFINITE_CACHE,\n@@ -2263,7 +2267,8 @@ async function spawnDynamicValidationInDev(\n     renderOpts,\n     workStore,\n   } = ctx\n-  const { botType } = renderOpts\n+\n+  const { allowEmptyStaticShell = false, botType } = renderOpts\n \n   // These values are placeholder values for this validating render\n   // that are provided during the actual prerenderToStream.\n@@ -2311,6 +2316,7 @@ async function spawnDynamicValidationInDev(\n     // the final prerender.\n     cacheSignal,\n     dynamicTracking: null,\n+    allowEmptyStaticShell,\n     revalidate: INFINITE_CACHE,\n     expire: INFINITE_CACHE,\n     stale: INFINITE_CACHE,\n@@ -2418,6 +2424,7 @@ async function spawnDynamicValidationInDev(\n       // is module loading, which has it's own cache signal\n       cacheSignal: null,\n       dynamicTracking: null,\n+      allowEmptyStaticShell,\n       revalidate: INFINITE_CACHE,\n       expire: INFINITE_CACHE,\n       stale: INFINITE_CACHE,\n@@ -2504,6 +2511,7 @@ async function spawnDynamicValidationInDev(\n     // All caches we could read must already be filled so no tracking is necessary\n     cacheSignal: null,\n     dynamicTracking: serverDynamicTracking,\n+    allowEmptyStaticShell,\n     revalidate: INFINITE_CACHE,\n     expire: INFINITE_CACHE,\n     stale: INFINITE_CACHE,\n@@ -2567,6 +2575,7 @@ async function spawnDynamicValidationInDev(\n     // No APIs require a cacheSignal through the workUnitStore during the HTML prerender\n     cacheSignal: null,\n     dynamicTracking: clientDynamicTracking,\n+    allowEmptyStaticShell,\n     revalidate: INFINITE_CACHE,\n     expire: INFINITE_CACHE,\n     stale: INFINITE_CACHE,\n@@ -2906,6 +2915,7 @@ async function prerenderToStream(\n         // the final prerender.\n         cacheSignal,\n         dynamicTracking: null,\n+        allowEmptyStaticShell,\n         revalidate: INFINITE_CACHE,\n         expire: INFINITE_CACHE,\n         stale: INFINITE_CACHE,\n@@ -2969,29 +2979,6 @@ async function prerenderToStream(\n       // We don't need to continue the prerender process if we already\n       // detected invalid dynamic usage in the initial prerender phase.\n       if (workStore.invalidDynamicUsageError) {\n-        if (\n-          isUseCacheTimeoutError(workStore.invalidDynamicUsageError) &&\n-          allowEmptyStaticShell\n-        ) {\n-          // If this is a \"use cache\" timeout error, and empty shells are\n-          // allowed (i.e. we're prerendering a fallback shell, and there are\n-          // also more specific routes prerendered) we return an empty shell.\n-          return {\n-            digestErrorsMap: reactServerErrorsByDigest,\n-            ssrErrors: allCapturedErrors,\n-            stream: new ReadableStream({\n-              start(controller) {\n-                controller.close()\n-              },\n-            }),\n-            collectedRevalidate: INFINITE_CACHE,\n-            collectedExpire: INFINITE_CACHE,\n-            collectedStale: selectStaleTime(INFINITE_CACHE),\n-            collectedTags: null,\n-          }\n-        }\n-\n-        // Otherwise we throw the error to fail the build.\n         throw workStore.invalidDynamicUsageError\n       }\n \n@@ -3029,6 +3016,7 @@ async function prerenderToStream(\n           // is module loading, which has it's own cache signal\n           cacheSignal: null,\n           dynamicTracking: null,\n+          allowEmptyStaticShell,\n           revalidate: INFINITE_CACHE,\n           expire: INFINITE_CACHE,\n           stale: INFINITE_CACHE,\n@@ -3115,6 +3103,7 @@ async function prerenderToStream(\n         // All caches we could read must already be filled so no tracking is necessary\n         cacheSignal: null,\n         dynamicTracking: serverDynamicTracking,\n+        allowEmptyStaticShell,\n         revalidate: INFINITE_CACHE,\n         expire: INFINITE_CACHE,\n         stale: INFINITE_CACHE,\n@@ -3186,6 +3175,7 @@ async function prerenderToStream(\n         // No APIs require a cacheSignal through the workUnitStore during the HTML prerender\n         cacheSignal: null,\n         dynamicTracking: clientDynamicTracking,\n+        allowEmptyStaticShell,\n         revalidate: INFINITE_CACHE,\n         expire: INFINITE_CACHE,\n         stale: INFINITE_CACHE,"
        },
        {
            "sha": "1a2c09e5881370449f9692dc5697edf9b83a5673",
            "filename": "packages/next/src/server/app-render/work-unit-async-storage.external.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fwork-unit-async-storage.external.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fwork-unit-async-storage.external.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fwork-unit-async-storage.external.ts?ref=77c9bd8d16c4995b12568d9e7ffc5a528aa0b485",
            "patch": "@@ -109,6 +109,14 @@ export interface PrerenderStoreModern extends CommonWorkUnitStore {\n \n   readonly rootParams: Params\n \n+  /**\n+   * When true, the page is prerendered as a fallback shell, while allowing any\n+   * dynamic accesses to result in an empty shell. This is the case when there\n+   * are also routes prerendered with a more complete set of params.\n+   * Prerendering those routes would catch any invalid dynamic accesses.\n+   */\n+  readonly allowEmptyStaticShell: boolean\n+\n   // Collected revalidate times and tags for this document during the prerender.\n   revalidate: number // in seconds. 0 means dynamic. INFINITE_CACHE and higher means never revalidate.\n   expire: number // server expiration time"
        },
        {
            "sha": "e93ba097c3996ff17ad5ece659ad275fd184fb84",
            "filename": "packages/next/src/server/route-modules/app-route/module.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/packages%2Fnext%2Fsrc%2Fserver%2Froute-modules%2Fapp-route%2Fmodule.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/packages%2Fnext%2Fsrc%2Fserver%2Froute-modules%2Fapp-route%2Fmodule.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Froute-modules%2Fapp-route%2Fmodule.ts?ref=77c9bd8d16c4995b12568d9e7ffc5a528aa0b485",
            "patch": "@@ -391,6 +391,7 @@ export class AppRouteRouteModule extends RouteModule<\n               // During prospective render we don't use a controller\n               // because we need to let all caches fill.\n               dynamicTracking,\n+              allowEmptyStaticShell: false,\n               revalidate: defaultRevalidate,\n               expire: INFINITE_CACHE,\n               stale: INFINITE_CACHE,\n@@ -481,6 +482,7 @@ export class AppRouteRouteModule extends RouteModule<\n             controller: finalController,\n             cacheSignal: null,\n             dynamicTracking,\n+            allowEmptyStaticShell: false,\n             revalidate: defaultRevalidate,\n             expire: INFINITE_CACHE,\n             stale: INFINITE_CACHE,"
        },
        {
            "sha": "9af5b4bb857b99cccfee01c4510c7a826504c7c5",
            "filename": "packages/next/src/server/use-cache/use-cache-wrapper.ts",
            "status": "modified",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fuse-cache-wrapper.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fuse-cache-wrapper.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fuse-cache-wrapper.ts?ref=77c9bd8d16c4995b12568d9e7ffc5a528aa0b485",
            "patch": "@@ -831,6 +831,30 @@ export function cache(\n           if (cacheSignal) {\n             cacheSignal.endRead()\n           }\n+\n+          // If `allowEmptyStaticShell` is true, and a prefilled resume data\n+          // cache was provided, then a cache miss means that params were part\n+          // of the cache key. In this case, we can make this cache function a\n+          // dynamic hole in the shell (or produce an empty shell if there's no\n+          // parent suspense boundary). Currently, this also includes layouts\n+          // and pages that don't read params, which will be improved when we\n+          // implement NAR-136. Otherwise, we assume that if params are passed\n+          // explicitly into a \"use cache\" function, that the params are also\n+          // accessed. This allows us to abort early, and treat the function as\n+          // dynamic, instead of waiting for the timeout to be reached. Compared\n+          // to the instrumentation-based params bailout we do here, this also\n+          // covers the case where params are transformed with an async\n+          // function, before being passed into the \"use cache\" function, which\n+          // escapes the instrumentation.\n+          if (\n+            workUnitStore?.type === 'prerender' &&\n+            workUnitStore.allowEmptyStaticShell\n+          ) {\n+            return makeHangingPromise(\n+              workUnitStore.renderSignal,\n+              'dynamic \"use cache\"'\n+            )\n+          }\n         }\n       }\n "
        },
        {
            "sha": "da66ec8b4b16edc50c9254400e4270250a492749",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/with-suspense/params-transformed/[slug]/page.jsx",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-transformed%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-transformed%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-transformed%2F%5Bslug%5D%2Fpage.jsx?ref=77c9bd8d16c4995b12568d9e7ffc5a528aa0b485",
            "patch": "@@ -0,0 +1,15 @@\n+import { CachedLastModified } from '../../../../last-modified'\n+\n+async function transformParams(params) {\n+  const { slug } = await params\n+\n+  return { slug }\n+}\n+\n+export default async function Page({ params }) {\n+  return <CachedLastModified params={transformParams(params)} />\n+}\n+\n+export async function generateStaticParams() {\n+  return [{ slug: 'foo' }]\n+}"
        },
        {
            "sha": "da66ec8b4b16edc50c9254400e4270250a492749",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/without-suspense/params-transformed/[slug]/page.jsx",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-transformed%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-transformed%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-transformed%2F%5Bslug%5D%2Fpage.jsx?ref=77c9bd8d16c4995b12568d9e7ffc5a528aa0b485",
            "patch": "@@ -0,0 +1,15 @@\n+import { CachedLastModified } from '../../../../last-modified'\n+\n+async function transformParams(params) {\n+  const { slug } = await params\n+\n+  return { slug }\n+}\n+\n+export default async function Page({ params }) {\n+  return <CachedLastModified params={transformParams(params)} />\n+}\n+\n+export async function generateStaticParams() {\n+  return [{ slug: 'foo' }]\n+}"
        },
        {
            "sha": "da8071621861cef9fd53bd61b33b0d1a61f159dd",
            "filename": "test/e2e/app-dir/fallback-shells/fallback-shells.test.ts",
            "status": "modified",
            "additions": 94,
            "deletions": 10,
            "changes": 104,
            "blob_url": "https://github.com/vercel/next.js/blob/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Ffallback-shells.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Ffallback-shells.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Ffallback-shells.test.ts?ref=77c9bd8d16c4995b12568d9e7ffc5a528aa0b485",
            "patch": "@@ -30,8 +30,7 @@ describe('fallback-shells', () => {\n         describe('and the params accessed in the cached page', () => {\n           it('resumes a postponed fallback shell', async () => {\n             const { browser, response } = await next.browserWithResponse(\n-              '/with-cached-io/with-static-params/with-suspense/params-in-page/bar',\n-              { pushErrorAsConsoleLog: true }\n+              '/with-cached-io/with-static-params/with-suspense/params-in-page/bar'\n             )\n \n             const lastModified = await browser\n@@ -54,23 +53,29 @@ describe('fallback-shells', () => {\n             }\n           })\n \n-          // TODO: To be implemented in NAR-136.\n-          it.skip('does not produce hydration errors when resuming a fallback shell containing a layout with unused params', async () => {\n+          it('does not produce hydration errors when resuming a fallback shell containing a layout with unused params', async () => {\n             const browser = await next.browser(\n               '/with-cached-io/with-static-params/with-suspense/params-in-page/bar',\n               { pushErrorAsConsoleLog: true }\n             )\n \n+            // There should also be no hydration errors due to a buildtime date\n+            // being replaced by a new runtime date.\n+            await assertNoConsoleErrors(browser)\n+          })\n+\n+          // TODO: To be implemented in NAR-136.\n+          it.skip('includes a cached layout with unused params in the fallback shell', async () => {\n+            const browser = await next.browser(\n+              '/with-cached-io/with-static-params/with-suspense/params-in-page/bar'\n+            )\n+\n             const layout = await browser.elementById('layout').text()\n \n             // When prerendered, this should be restored from the RDC during the\n             // resume of the fallback shell, so it should be \"buildtime\". If the\n             // layout is unexpectedly a cache miss, then it will be \"runtime\".\n             expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n-\n-            // There should also be no hydration errors due to a buildtime date\n-            // being replaced by a new runtime date.\n-            await assertNoConsoleErrors(browser)\n           })\n \n           // TODO: Activate for deploy tests once background revalidation for\n@@ -198,6 +203,33 @@ describe('fallback-shells', () => {\n             }\n           })\n         })\n+\n+        describe('and the params transformed with an async function and then passed to a cached function', () => {\n+          it('resumes a postponed fallback shell', async () => {\n+            const { browser, response } = await next.browserWithResponse(\n+              '/with-cached-io/with-static-params/with-suspense/params-transformed/bar'\n+            )\n+\n+            const lastModified = await browser\n+              .elementById('last-modified')\n+              .text()\n+            expect(lastModified).toInclude('Page /bar')\n+            expect(lastModified).toInclude('runtime')\n+\n+            const layout = await browser.elementById('root-layout').text()\n+            expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n+\n+            const headers = response.headers()\n+\n+            if (isNextDeploy) {\n+              expect(headers['x-matched-path']).toBe(\n+                '/with-cached-io/with-static-params/with-suspense/params-transformed/[slug]'\n+              )\n+            } else if (isNextStart) {\n+              expect(headers['x-nextjs-postponed']).toBe('1')\n+            }\n+          })\n+        })\n       })\n \n       describe('and the page not wrapped in Suspense', () => {\n@@ -300,15 +332,41 @@ describe('fallback-shells', () => {\n             }\n           })\n         })\n+\n+        describe('and the params transformed with an async function and then passed to a cached function', () => {\n+          it('does not resume a postponed fallback shell', async () => {\n+            const { browser, response } = await next.browserWithResponse(\n+              '/with-cached-io/with-static-params/without-suspense/params-transformed/bar'\n+            )\n+\n+            const lastModified = await browser\n+              .elementById('last-modified')\n+              .text()\n+            expect(lastModified).toInclude('Page /bar')\n+            expect(lastModified).toInclude('runtime')\n+\n+            const layout = await browser.elementById('root-layout').text()\n+            expect(layout).toInclude('runtime')\n+\n+            const headers = response.headers()\n+\n+            if (isNextDeploy) {\n+              expect(headers['x-matched-path']).toBe(\n+                '/with-cached-io/with-static-params/without-suspense/params-transformed/[slug]'\n+              )\n+            } else if (isNextStart) {\n+              expect(headers['x-nextjs-postponed']).not.toBe('1')\n+            }\n+          })\n+        })\n       })\n     })\n \n     describe('without generateStaticParams', () => {\n       describe('and the params accessed in the cached page', () => {\n         it('resumes a postponed fallback shell', async () => {\n           const { browser, response } = await next.browserWithResponse(\n-            '/with-cached-io/without-static-params/params-in-page/foo',\n-            { pushErrorAsConsoleLog: true }\n+            '/with-cached-io/without-static-params/params-in-page/foo'\n           )\n \n           const lastModified = await browser.elementById('last-modified').text()\n@@ -328,6 +386,32 @@ describe('fallback-shells', () => {\n             expect(headers['x-nextjs-postponed']).toBe('1')\n           }\n         })\n+\n+        // TODO: To be implemented in NAR-136.\n+        it.skip('does not produce hydration errors when resuming a fallback shell containing a layout with unused params', async () => {\n+          const browser = await next.browser(\n+            '/with-cached-io/without-static-params/params-in-page/bar',\n+            { pushErrorAsConsoleLog: true }\n+          )\n+\n+          // There should also be no hydration errors due to a buildtime date\n+          // being replaced by a new runtime date.\n+          await assertNoConsoleErrors(browser)\n+        })\n+\n+        // TODO: To be implemented in NAR-136.\n+        it.skip('includes a cached layout with unused params in the fallback shell', async () => {\n+          const browser = await next.browser(\n+            '/with-cached-io/without-static-params/params-in-page/bar'\n+          )\n+\n+          const layout = await browser.elementById('layout').text()\n+\n+          // When prerendered, this should be restored from the RDC during the\n+          // resume of the fallback shell, so it should be \"buildtime\". If the\n+          // layout is unexpectedly a cache miss, then it will be \"runtime\".\n+          expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n+        })\n       })\n \n       describe('and the params accessed in cached non-page function', () => {"
        },
        {
            "sha": "dd218d341d42f62bb89a7a282d8361eb0514dc22",
            "filename": "test/e2e/app-dir/use-cache-hanging-inputs/app/transformed-params/[slug]/page.jsx",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/test%2Fe2e%2Fapp-dir%2Fuse-cache-hanging-inputs%2Fapp%2Ftransformed-params%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/77c9bd8d16c4995b12568d9e7ffc5a528aa0b485/test%2Fe2e%2Fapp-dir%2Fuse-cache-hanging-inputs%2Fapp%2Ftransformed-params%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-hanging-inputs%2Fapp%2Ftransformed-params%2F%5Bslug%5D%2Fpage.jsx?ref=77c9bd8d16c4995b12568d9e7ffc5a528aa0b485",
            "patch": "@@ -20,6 +20,5 @@ export default async function Page({ params }) {\n   return <LastModified params={transformParams(params)} />\n }\n \n-export async function generateStaticParams() {\n-  return [{ slug: 'foo' }]\n-}\n+// Explicitly not defining `generateStaticParams` here. Otherwise, no timeout\n+// error would be triggered."
        }
    ],
    "stats": {
        "total": 215,
        "additions": 176,
        "deletions": 39
    }
}