{
    "author": "gaojude",
    "message": "Fix telemetry event race condition in webpack worker for @vercel/og detection (#86145)",
    "sha": "40a5da531a0ffae1a0a446a8c7459b725366d502",
    "files": [
        {
            "sha": "e332de299a0c8ada790b3ff3569322d7ffff3af0",
            "filename": "packages/next/src/build/webpack-build/impl.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/40a5da531a0ffae1a0a446a8c7459b725366d502/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Fimpl.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/40a5da531a0ffae1a0a446a8c7459b725366d502/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Fimpl.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Fimpl.ts?ref=40a5da531a0ffae1a0a446a8c7459b725366d502",
            "patch": "@@ -414,5 +414,7 @@ export async function workerMain(workerData: {\n     result.buildTraceContext!.chunksTrace!.entryNameFilesMap = entryNameFilesMap\n   }\n   NextBuildContext.nextBuildSpan.stop()\n+  await telemetry.flush()\n+\n   return { ...result, debugTraceEvents: getTraceEvents() }\n }"
        },
        {
            "sha": "e72b980084a3da7ce265ff793671b03eaba6de90",
            "filename": "test/integration/telemetry/test/config.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/40a5da531a0ffae1a0a446a8c7459b725366d502/test%2Fintegration%2Ftelemetry%2Ftest%2Fconfig.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/40a5da531a0ffae1a0a446a8c7459b725366d502/test%2Fintegration%2Ftelemetry%2Ftest%2Fconfig.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Ftelemetry%2Ftest%2Fconfig.test.ts?ref=40a5da531a0ffae1a0a446a8c7459b725366d502",
            "patch": "@@ -441,6 +441,7 @@ describe('config telemetry', () => {\n       ;(process.env.IS_TURBOPACK_TEST ? it.skip : it)(\n         'emits telemetry for usage of @vercel/og',\n         async () => {\n+          // Test vercelImageGeneration telemetry tracking\n           const { stderr } = await nextBuild(appDir, [], {\n             stderr: true,\n             env: { NEXT_TELEMETRY_DEBUG: '1' },"
        }
    ],
    "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
    }
}