{
    "author": "huozhi",
    "message": "fix: logging the correct process for listened port (#81903)",
    "sha": "0fb4a6d4a749723fd644829b92ad750228737d41",
    "files": [
        {
            "sha": "9d16195a4f3640bcb196bd7e4f206a81cc121098",
            "filename": "packages/next/src/server/lib/start-server.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 6,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/0fb4a6d4a749723fd644829b92ad750228737d41/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fstart-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0fb4a6d4a749723fd644829b92ad750228737d41/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fstart-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fstart-server.ts?ref=0fb4a6d4a749723fd644829b92ad750228737d41",
            "patch": "@@ -58,13 +58,14 @@ async function getProcessIdUsingPort(port: number): Promise<string | null> {\n       // Use lsof on Unix-like systems (macOS, Linux)\n       if (process.platform !== 'win32') {\n         exec(\n-          `lsof -ti:${port}`,\n+          `lsof -ti:${port} -sTCP:LISTEN`,\n           { signal: processLookupController.signal },\n           (error, stdout) => {\n             if (error) {\n               handleError(error)\n               return\n             }\n+            // `-sTCP` will ensure there's only one port, clean up output\n             const pid = stdout.trim()\n             resolve(pid || null)\n           }\n@@ -79,11 +80,18 @@ async function getProcessIdUsingPort(port: number): Promise<string | null> {\n               handleError(error)\n               return\n             }\n-            const lines = stdout.trim().split('\\n')\n-            if (lines.length > 0) {\n-              const parts = lines[0].trim().split(/\\s+/)\n-              const pid = parts[parts.length - 1]\n-              resolve(pid || null)\n+            // Clean up output and extract PID\n+            const cleanOutput = stdout.replace(/\\s+/g, ' ').trim()\n+            if (cleanOutput) {\n+              const lines = cleanOutput.split('\\n')\n+              const firstLine = lines[0].trim()\n+              if (firstLine) {\n+                const parts = firstLine.split(' ')\n+                const pid = parts[parts.length - 1]\n+                resolve(pid || null)\n+              } else {\n+                resolve(null)\n+              }\n             } else {\n               resolve(null)\n             }"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 14,
        "deletions": 6
    }
}