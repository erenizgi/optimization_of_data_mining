{
    "author": "bgw",
    "message": "chore(HMR clients): Clean up and share code between app and pages router (#76960)\n\n# Do not review this PR in Graphite, review it one commit at a time: https://github.com/vercel/next.js/pull/76960/commits\n\nThis is a series of very small changes to the hot reloader clients in both app and pages router to share more code and unify some of the logic or behavior between the two.\n\nThis code is very fragile, so lots of small commits have been useful in bisecting test failures.\n\nThese changes are too small to be practical as separate stacked graphite PRs.",
    "sha": "c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed",
    "files": [
        {
            "sha": "3bfe171b668c674f9c2fb9f7599f4b64925edcf7",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/hot-reloader-client.tsx",
            "status": "modified",
            "additions": 17,
            "deletions": 54,
            "changes": 71,
            "blob_url": "https://github.com/vercel/next.js/blob/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fhot-reloader-client.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fhot-reloader-client.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fhot-reloader-client.tsx?ref=c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed",
            "patch": "@@ -21,6 +21,8 @@ import {\n   ACTION_UNHANDLED_ERROR,\n   ACTION_UNHANDLED_REJECTION,\n   ACTION_VERSION_INFO,\n+  REACT_REFRESH_FULL_RELOAD,\n+  reportInvalidHmrMessage,\n   useErrorOverlayReducer,\n } from '../shared'\n import { parseStack } from '../utils/parse-stack'\n@@ -50,6 +52,7 @@ import { shouldRenderRootLevelErrorOverlay } from '../../../lib/is-error-thrown-\n import { handleDevBuildIndicatorHmrEvents } from '../../../dev/dev-build-indicator/internal/handle-dev-build-indicator-hmr-events'\n import type { GlobalErrorComponent } from '../../error-boundary'\n import type { DevIndicatorServerState } from '../../../../server/dev/dev-indicator-server-state'\n+import reportHmrLatency from '../utils/report-hmr-latency'\n \n export interface Dispatcher {\n   onBuildOk(): void\n@@ -83,52 +86,18 @@ export function waitForWebpackRuntimeHotUpdate() {\n   return pendingHotUpdateWebpack\n }\n \n-function handleBeforeHotUpdateWebpack(\n-  dispatcher: Dispatcher,\n-  hasUpdates: boolean\n-) {\n-  if (hasUpdates) {\n-    dispatcher.onBeforeRefresh()\n-  }\n-}\n-\n function handleSuccessfulHotUpdateWebpack(\n   dispatcher: Dispatcher,\n   sendMessage: (message: string) => void,\n   updatedModules: ReadonlyArray<string>\n ) {\n   resolvePendingHotUpdateWebpack()\n   dispatcher.onBuildOk()\n-  reportHmrLatency(sendMessage, updatedModules)\n+  reportHmrLatency(sendMessage, updatedModules, startLatency!, Date.now())\n \n   dispatcher.onRefresh()\n }\n \n-function reportHmrLatency(\n-  sendMessage: (message: string) => void,\n-  updatedModules: ReadonlyArray<string>\n-) {\n-  if (!startLatency) return\n-  // turbopack has a debounce for the \"built\" event which we don't want to\n-  // incorrectly show in this number, use the last TURBOPACK_MESSAGE time\n-  let endLatency = turbopackLastUpdateLatency ?? Date.now()\n-  const latency = endLatency - startLatency\n-  console.log(`[Fast Refresh] done in ${latency}ms`)\n-  sendMessage(\n-    JSON.stringify({\n-      event: 'client-hmr-latency',\n-      id: window.__nextDevClientId,\n-      startTime: startLatency,\n-      endTime: endLatency,\n-      page: window.location.pathname,\n-      updatedModules,\n-      // Whether the page (tab) was hidden at the time the event occurred.\n-      // This can impact the accuracy of the event's timing.\n-      isPageHidden: document.visibilityState === 'hidden',\n-    })\n-  )\n-}\n-\n // There is a newer version of the code available.\n function handleAvailableHash(hash: string) {\n   // Update last known compilation hash.\n@@ -203,21 +172,14 @@ function tryApplyUpdates(\n   if (!isUpdateAvailable() || !canApplyUpdates()) {\n     resolvePendingHotUpdateWebpack()\n     dispatcher.onBuildOk()\n-    reportHmrLatency(sendMessage, [])\n+    reportHmrLatency(sendMessage, [], startLatency!, Date.now())\n     return\n   }\n \n   function handleApplyUpdates(err: any, updatedModules: string[] | null) {\n     if (err || RuntimeErrorHandler.hadRuntimeError || !updatedModules) {\n       if (err) {\n-        console.warn(\n-          '[Fast Refresh] performing full reload\\n\\n' +\n-            \"Fast Refresh will perform a full reload when you edit a file that's imported by modules outside of the React rendering tree.\\n\" +\n-            'You might have a file which exports a React component but also exports a value that is imported by a non-React component file.\\n' +\n-            'Consider migrating the non-React component export to a separate file and importing it into both files.\\n\\n' +\n-            'It is also possible the parent component of the component you edited is a class component, which disables Fast Refresh.\\n' +\n-            'Fast Refresh requires at least one parent function component in your React tree.'\n-        )\n+        console.warn(REACT_REFRESH_FULL_RELOAD)\n       } else if (RuntimeErrorHandler.hadRuntimeError) {\n         console.warn(REACT_REFRESH_FULL_RELOAD_FROM_ERROR)\n       }\n@@ -321,11 +283,18 @@ function processMessage(\n   function handleHotUpdate() {\n     if (process.env.TURBOPACK) {\n       dispatcher.onBuildOk()\n-      reportHmrLatency(sendMessage, [...turbopackUpdatedModules])\n+      reportHmrLatency(\n+        sendMessage,\n+        [...turbopackUpdatedModules],\n+        startLatency!,\n+        turbopackLastUpdateLatency ?? Date.now()\n+      )\n     } else {\n       tryApplyUpdates(\n         function onBeforeHotUpdate(hasUpdates: boolean) {\n-          handleBeforeHotUpdateWebpack(dispatcher, hasUpdates)\n+          if (hasUpdates) {\n+            dispatcher.onBeforeRefresh()\n+          }\n         },\n         function onSuccessfulHotUpdate(webpackUpdatedModules: string[]) {\n           // Only dismiss it when we're sure it's a hot update.\n@@ -437,7 +406,6 @@ function processMessage(\n       )\n \n       if (obj.action === HMR_ACTIONS_SENT_TO_BROWSER.BUILT) {\n-        // Handle hot updates\n         handleHotUpdate()\n       }\n       return\n@@ -691,13 +659,8 @@ export default function HotReload({\n           appIsrManifestRef,\n           pathnameRef\n         )\n-      } catch (err: any) {\n-        console.warn(\n-          '[HMR] Invalid message: ' +\n-            JSON.stringify(event.data) +\n-            '\\n' +\n-            (err?.stack ?? '')\n-        )\n+      } catch (err: unknown) {\n+        reportInvalidHmrMessage(event, err)\n       }\n     }\n "
        },
        {
            "sha": "83432d76ba4e2eb4b3ae92e2e4d823e864a070fc",
            "filename": "packages/next/src/client/components/react-dev-overlay/pages/hot-reloader-client.ts",
            "status": "modified",
            "additions": 26,
            "deletions": 54,
            "changes": 80,
            "blob_url": "https://github.com/vercel/next.js/blob/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fhot-reloader-client.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fhot-reloader-client.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fhot-reloader-client.ts?ref=c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed",
            "patch": "@@ -47,8 +47,13 @@ import type {\n   TurbopackMsgToBrowser,\n } from '../../../../server/dev/hot-reloader-types'\n import { extractModulesFromTurbopackMessage } from '../../../../server/dev/extract-modules-from-turbopack-message'\n-import { REACT_REFRESH_FULL_RELOAD_FROM_ERROR } from '../shared'\n+import {\n+  REACT_REFRESH_FULL_RELOAD,\n+  REACT_REFRESH_FULL_RELOAD_FROM_ERROR,\n+  reportInvalidHmrMessage,\n+} from '../shared'\n import { RuntimeErrorHandler } from '../../errors/runtime-error-handler'\n+import reportHmrLatency from '../utils/report-hmr-latency'\n // This alternative WebpackDevServer combines the functionality of:\n // https://github.com/webpack/webpack-dev-server/blob/webpack-1/client/index.js\n // https://github.com/webpack/webpack/blob/webpack-1/hot/dev-server.js\n@@ -62,17 +67,14 @@ declare global {\n   const __webpack_hash__: string\n   interface Window {\n     __nextDevClientId: number\n-    __NEXT_HMR_LATENCY_CB: any\n   }\n }\n \n window.__nextDevClientId = Math.round(Math.random() * 100 + Date.now())\n \n let customHmrEventHandler: any\n let turbopackMessageListeners: ((msg: TurbopackMsgToBrowser) => void)[] = []\n-let MODE: 'webpack' | 'turbopack' = 'webpack'\n-export default function connect(mode: 'webpack' | 'turbopack') {\n-  MODE = mode\n+export default function connect() {\n   register()\n \n   addMessageListener((payload) => {\n@@ -82,13 +84,8 @@ export default function connect(mode: 'webpack' | 'turbopack') {\n \n     try {\n       processMessage(payload)\n-    } catch (err: any) {\n-      console.warn(\n-        '[HMR] Invalid message: ' +\n-          JSON.stringify(payload) +\n-          '\\n' +\n-          (err?.stack ?? '')\n-      )\n+    } catch (err: unknown) {\n+      reportInvalidHmrMessage(payload, err)\n     }\n   })\n \n@@ -129,7 +126,15 @@ function clearOutdatedErrors() {\n function handleSuccess() {\n   clearOutdatedErrors()\n \n-  if (MODE === 'webpack') {\n+  if (process.env.TURBOPACK) {\n+    reportHmrLatency(\n+      sendMessage,\n+      [...turbopackUpdatedModules],\n+      startLatency!,\n+      turbopackLastUpdateLatency ?? Date.now()\n+    )\n+    onBuildOk()\n+  } else {\n     const isHotUpdate =\n       !isFirstCompilation ||\n       (window.__NEXT_DATA__.page !== '/_error' && isUpdateAvailable())\n@@ -140,9 +145,6 @@ function handleSuccess() {\n     if (isHotUpdate) {\n       tryApplyUpdates(onBeforeFastRefresh, onFastRefresh)\n     }\n-  } else {\n-    reportHmrLatency([...turbopackUpdatedModules])\n-    onBuildOk()\n   }\n }\n \n@@ -238,32 +240,12 @@ function onFastRefresh(updatedModules: ReadonlyArray<string> = []) {\n \n   onRefresh()\n \n-  reportHmrLatency()\n-}\n-\n-function reportHmrLatency(updatedModules: ReadonlyArray<string> = []) {\n-  if (!startLatency) return\n-  // turbopack has a debounce for the BUILT event which we don't want to\n-  // incorrectly show in this number, use the last TURBOPACK_MESSAGE time\n-  let endLatency = turbopackLastUpdateLatency ?? Date.now()\n-  const latency = endLatency - startLatency\n-  console.log(`[Fast Refresh] done in ${latency}ms`)\n-  sendMessage(\n-    JSON.stringify({\n-      event: 'client-hmr-latency',\n-      id: window.__nextDevClientId,\n-      startTime: startLatency,\n-      endTime: endLatency,\n-      page: window.location.pathname,\n-      updatedModules,\n-      // Whether the page (tab) was hidden at the time the event occurred.\n-      // This can impact the accuracy of the event's timing.\n-      isPageHidden: document.visibilityState === 'hidden',\n-    })\n+  reportHmrLatency(\n+    sendMessage,\n+    updatedModules,\n+    startLatency!,\n+    turbopackLastUpdateLatency ?? Date.now()\n   )\n-  if (self.__NEXT_HMR_LATENCY_CB) {\n-    self.__NEXT_HMR_LATENCY_CB(latency)\n-  }\n }\n \n // There is a newer version of the code available.\n@@ -278,7 +260,7 @@ export function handleStaticIndicator() {\n     const pageComponent = routeInfo?.Component\n     const appComponent = window.next.router.components['/_app']?.Component\n     const isDynamicPage =\n-      Boolean(pageComponent?.getInitialProps) || Boolean(routeInfo.__N_SSP)\n+      Boolean(pageComponent?.getInitialProps) || Boolean(routeInfo?.__N_SSP)\n     const hasAppGetInitialProps =\n       Boolean(appComponent?.getInitialProps) &&\n       appComponent?.getInitialProps !== appComponent?.origGetInitialProps\n@@ -297,7 +279,6 @@ function processMessage(obj: HMR_ACTION_TYPES) {\n     return\n   }\n \n-  // Use turbopack message for analytics, (still need built for webpack)\n   switch (obj.action) {\n     case HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST: {\n       isrManifest = obj.data\n@@ -458,18 +439,9 @@ function tryApplyUpdates(\n   function handleApplyUpdates(err: any, updatedModules: string[] | null) {\n     if (err || RuntimeErrorHandler.hadRuntimeError || !updatedModules) {\n       if (err) {\n-        console.warn(\n-          '[Fast Refresh] performing full reload\\n\\n' +\n-            \"Fast Refresh will perform a full reload when you edit a file that's imported by modules outside of the React rendering tree.\\n\" +\n-            'You might have a file which exports a React component but also exports a value that is imported by a non-React component file.\\n' +\n-            'Consider migrating the non-React component export to a separate file and importing it into both files.\\n\\n' +\n-            'It is also possible the parent component of the component you edited is a class component, which disables Fast Refresh.\\n' +\n-            'Fast Refresh requires at least one parent function component in your React tree.'\n-        )\n+        console.warn(REACT_REFRESH_FULL_RELOAD)\n       } else if (RuntimeErrorHandler.hadRuntimeError) {\n-        console.warn(\n-          '[Fast Refresh] performing full reload because your application had an unrecoverable error'\n-        )\n+        console.warn(REACT_REFRESH_FULL_RELOAD_FROM_ERROR)\n       }\n       performFullReload(err)\n       return"
        },
        {
            "sha": "549537203626b6dcfdef576d4b02c03224dec6b6",
            "filename": "packages/next/src/client/components/react-dev-overlay/shared.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fshared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fshared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fshared.ts?ref=c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed",
            "patch": "@@ -6,6 +6,7 @@ import type { SupportedErrorEvent } from './ui/container/runtime-error/render-er\n import type { ComponentStackFrame } from './utils/parse-component-stack'\n import type { DebugInfo } from './types'\n import type { DevIndicatorServerState } from '../../../server/dev/dev-indicator-server-state'\n+import type { HMR_ACTION_TYPES } from '../../../server/dev/hot-reloader-types'\n \n type FastRefreshState =\n   /** No refresh in progress. */\n@@ -224,5 +225,25 @@ export function useErrorOverlayReducer(routerType: 'pages' | 'app') {\n   }, getInitialState(routerType))\n }\n \n+export const REACT_REFRESH_FULL_RELOAD =\n+  '[Fast Refresh] performing full reload\\n\\n' +\n+  \"Fast Refresh will perform a full reload when you edit a file that's imported by modules outside of the React rendering tree.\\n\" +\n+  'You might have a file which exports a React component but also exports a value that is imported by a non-React component file.\\n' +\n+  'Consider migrating the non-React component export to a separate file and importing it into both files.\\n\\n' +\n+  'It is also possible the parent component of the component you edited is a class component, which disables Fast Refresh.\\n' +\n+  'Fast Refresh requires at least one parent function component in your React tree.'\n+\n export const REACT_REFRESH_FULL_RELOAD_FROM_ERROR =\n   '[Fast Refresh] performing full reload because your application had an unrecoverable error'\n+\n+export function reportInvalidHmrMessage(\n+  message: HMR_ACTION_TYPES | MessageEvent<unknown>,\n+  err: unknown\n+) {\n+  console.warn(\n+    '[HMR] Invalid message: ' +\n+      JSON.stringify(message) +\n+      '\\n' +\n+      ((err instanceof Error && err?.stack) || '')\n+  )\n+}"
        },
        {
            "sha": "c5aeacac9b540828b939231860b6b66afe3778d1",
            "filename": "packages/next/src/client/components/react-dev-overlay/utils/report-hmr-latency.ts",
            "status": "added",
            "additions": 31,
            "deletions": 0,
            "changes": 31,
            "blob_url": "https://github.com/vercel/next.js/blob/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Futils%2Freport-hmr-latency.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Futils%2Freport-hmr-latency.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Futils%2Freport-hmr-latency.ts?ref=c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed",
            "patch": "@@ -0,0 +1,31 @@\n+declare global {\n+  interface Window {\n+    __NEXT_HMR_LATENCY_CB: ((latencyMs: number) => void) | undefined\n+  }\n+}\n+\n+export default function reportHmrLatency(\n+  sendMessage: (message: string) => void,\n+  updatedModules: ReadonlyArray<string>,\n+  startMsSinceEpoch: number,\n+  endMsSinceEpoch: number\n+) {\n+  const latencyMs = endMsSinceEpoch - startMsSinceEpoch\n+  console.log(`[Fast Refresh] done in ${latencyMs}ms`)\n+  sendMessage(\n+    JSON.stringify({\n+      event: 'client-hmr-latency',\n+      id: window.__nextDevClientId,\n+      startTime: startMsSinceEpoch,\n+      endTime: endMsSinceEpoch,\n+      page: window.location.pathname,\n+      updatedModules,\n+      // Whether the page (tab) was hidden at the time the event occurred.\n+      // This can impact the accuracy of the event's timing.\n+      isPageHidden: document.visibilityState === 'hidden',\n+    })\n+  )\n+  if (self.__NEXT_HMR_LATENCY_CB) {\n+    self.__NEXT_HMR_LATENCY_CB(latencyMs)\n+  }\n+}"
        },
        {
            "sha": "2077a81c77da2dfb0764c5983592f9dc243a699c",
            "filename": "packages/next/src/client/dev/amp-dev.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Famp-dev.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Famp-dev.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Famp-dev.ts?ref=c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed",
            "patch": "@@ -6,6 +6,7 @@ import {\n   connectHMR,\n } from '../components/react-dev-overlay/pages/websocket'\n import { HMR_ACTIONS_SENT_TO_BROWSER } from '../../server/dev/hot-reloader-types'\n+import { reportInvalidHmrMessage } from '../components/react-dev-overlay/shared'\n \n declare global {\n   const __webpack_runtime_id__: string\n@@ -106,13 +107,8 @@ addMessageListener((message) => {\n     } else if (message.action === HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE) {\n       window.location.reload()\n     }\n-  } catch (err: any) {\n-    console.warn(\n-      '[HMR] Invalid message: ' +\n-        JSON.stringify(message) +\n-        '\\n' +\n-        (err?.stack ?? '')\n-    )\n+  } catch (err: unknown) {\n+    reportInvalidHmrMessage(message, err)\n   }\n })\n "
        },
        {
            "sha": "0e3180eb9b23c6077fb6327c8298135e58a6de5f",
            "filename": "packages/next/src/client/dev/hot-middleware-client.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-middleware-client.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-middleware-client.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-middleware-client.ts?ref=c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed",
            "patch": "@@ -20,8 +20,8 @@ declare const window: NextWindow\n \n let reloading = false\n \n-export default (mode: 'webpack' | 'turbopack') => {\n-  const devClient = connect(mode)\n+export default () => {\n+  const devClient = connect()\n \n   devClient.subscribeToHmrEvent((obj: any) => {\n     if (reloading) return"
        },
        {
            "sha": "161410da2151bb5479550081d9b90cc26489b6a7",
            "filename": "packages/next/src/client/next-dev-turbopack.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fnext-dev-turbopack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fnext-dev-turbopack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fnext-dev-turbopack.ts?ref=c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed",
            "patch": "@@ -21,7 +21,7 @@ window.next = {\n // for the page loader\n declare let __turbopack_load__: any\n \n-const devClient = initHMR('turbopack')\n+const devClient = initHMR()\n initialize({\n   devClient,\n })"
        },
        {
            "sha": "57d459137cef83cdc93176678ac94a9ce0a9739c",
            "filename": "packages/next/src/client/next-dev.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fnext-dev.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed/packages%2Fnext%2Fsrc%2Fclient%2Fnext-dev.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fnext-dev.ts?ref=c37a39bf2bfa0f3cf705df61ae5144fb1d5533ed",
            "patch": "@@ -13,7 +13,7 @@ window.next = {\n   emitter,\n }\n \n-const devClient = initHMR('webpack')\n+const devClient = initHMR()\n initialize({ devClient })\n   .then(({ assetPrefix }) => {\n     return pageBootstrap(assetPrefix)"
        }
    ],
    "stats": {
        "total": 221,
        "additions": 102,
        "deletions": 119
    }
}