{
    "author": "huozhi",
    "message": "Remove the experimental.devtoolSegmentExplorer flag (#83384)",
    "sha": "b5fa24b7662d9cc23e95015cddfecb680908f7bf",
    "files": [
        {
            "sha": "d4512271f0f74d0f1b8af5d5efba76550c529efa",
            "filename": "packages/next/src/build/define-env.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -312,8 +312,6 @@ export function getDefineEnv({\n           ),\n         }\n       : {}),\n-    'process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER':\n-      !!config.experimental.devtoolSegmentExplorer,\n \n     'process.env.__NEXT_BROWSER_DEBUG_INFO_IN_TERMINAL': JSON.stringify(\n       config.experimental.browserDebugInfoInTerminal || false"
        },
        {
            "sha": "a5fae7b48be2270ad0e5da8369320f57e8f20125",
            "filename": "packages/next/src/build/templates/app-page.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -550,8 +550,6 @@ export async function handler(\n           deploymentId: nextConfig.deploymentId,\n           enableTainting: nextConfig.experimental.taint,\n           htmlLimitedBots: nextConfig.htmlLimitedBots,\n-          devtoolSegmentExplorer:\n-            nextConfig.experimental.devtoolSegmentExplorer,\n           reactMaxHeadersLength: nextConfig.reactMaxHeadersLength,\n \n           multiZoneDraftMode,"
        },
        {
            "sha": "b3f7790ca59d1c2f55919e8a93841fd5863a4186",
            "filename": "packages/next/src/build/templates/edge-ssr-app.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -149,7 +149,6 @@ async function requestHandler(\n       deploymentId: nextConfig.deploymentId,\n       enableTainting: nextConfig.experimental.taint,\n       htmlLimitedBots: nextConfig.htmlLimitedBots,\n-      devtoolSegmentExplorer: nextConfig.experimental.devtoolSegmentExplorer,\n       reactMaxHeadersLength: nextConfig.reactMaxHeadersLength,\n \n       multiZoneDraftMode: false,"
        },
        {
            "sha": "fc1583780f2b8e18961ebc0fa2adac63bc92bd27",
            "filename": "packages/next/src/client/components/layout-router.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Flayout-router.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Flayout-router.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Flayout-router.tsx?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -608,10 +608,7 @@ export default function OuterLayoutRouter({\n \n     let segmentBoundaryTriggerNode: React.ReactNode = null\n     let segmentViewStateNode: React.ReactNode = null\n-    if (\n-      process.env.NODE_ENV !== 'production' &&\n-      process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER\n-    ) {\n+    if (process.env.NODE_ENV !== 'production') {\n       const { SegmentBoundaryTriggerNode, SegmentViewStateNode } =\n         require('../../next-devtools/userspace/app/segment-explorer-node') as typeof import('../../next-devtools/userspace/app/segment-explorer-node')\n "
        },
        {
            "sha": "c4dc69fe78b9e0e0545c82cf0f34703415273045",
            "filename": "packages/next/src/next-devtools/dev-overlay/menu/panel-router.tsx",
            "status": "modified",
            "additions": 8,
            "deletions": 9,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fmenu%2Fpanel-router.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fmenu%2Fpanel-router.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fmenu%2Fpanel-router.tsx?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -84,15 +84,14 @@ const MenuPanel = () => {\n               value: <ChevronRight />,\n               onClick: () => setPanel('turbo-info'),\n             },\n-        !!process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER &&\n-          isAppRouter && {\n-            label: 'Route Info',\n-            value: <ChevronRight />,\n-            onClick: () => setPanel('segment-explorer'),\n-            attributes: {\n-              'data-segment-explorer': true,\n-            },\n+        isAppRouter && {\n+          label: 'Route Info',\n+          value: <ChevronRight />,\n+          onClick: () => setPanel('segment-explorer'),\n+          attributes: {\n+            'data-segment-explorer': true,\n           },\n+        },\n         {\n           label: 'Preferences',\n           value: <GearIcon />,\n@@ -201,7 +200,7 @@ export const PanelRouter = () => {\n         </DynamicPanel>\n       </PanelRoute>\n \n-      {process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER && isAppRouter && (\n+      {isAppRouter && (\n         <PanelRoute name=\"segment-explorer\">\n           <DynamicPanel\n             sharePanelSizeGlobally={false}"
        },
        {
            "sha": "c63c467a39792886141167b7d6cd257dce14ed03",
            "filename": "packages/next/src/server/app-render/app-render.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -4612,7 +4612,7 @@ const getGlobalErrorStyles = async (\n       dir,\n       globalErrorModule?.[1]\n     )\n-    if (ctx.renderOpts.devtoolSegmentExplorer && globalErrorModulePath) {\n+    if (globalErrorModulePath) {\n       const SegmentViewNode = ctx.componentMod.SegmentViewNode\n       globalErrorStyles = (\n         // This will be rendered next to GlobalError component under ErrorBoundary,"
        },
        {
            "sha": "575142629ffd75b10b0ec94d419ec1fc1c25573c",
            "filename": "packages/next/src/server/app-render/create-component-tree.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 6,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -422,9 +422,7 @@ async function createComponentTreeInternal(\n \n   // Resolve the segment param\n   const actualSegment = segmentParam ? segmentParam.treeSegment : segment\n-  const isSegmentViewEnabled =\n-    process.env.NODE_ENV === 'development' &&\n-    ctx.renderOpts.devtoolSegmentExplorer\n+  const isSegmentViewEnabled = !!ctx.renderOpts.dev\n   const dir =\n     (process.env.NEXT_RUNTIME === 'edge'\n       ? process.env.__NEXT_EDGE_PROJECT_DIR\n@@ -1145,9 +1143,7 @@ async function createBoundaryConventionElement({\n   styles: React.ReactNode | undefined\n   tree: LoaderTree\n }) {\n-  const isSegmentViewEnabled =\n-    process.env.NODE_ENV === 'development' &&\n-    ctx.renderOpts.devtoolSegmentExplorer\n+  const isSegmentViewEnabled = !!ctx.renderOpts.dev\n   const dir =\n     (process.env.NEXT_RUNTIME === 'edge'\n       ? process.env.__NEXT_EDGE_PROJECT_DIR"
        },
        {
            "sha": "3b392213d853291e280abb35ea6607bc55eb5189",
            "filename": "packages/next/src/server/app-render/types.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -183,11 +183,6 @@ export interface RenderOptsPartial {\n    * Prerendering those routes would catch any invalid dynamic accesses.\n    */\n   allowEmptyStaticShell?: boolean\n-\n-  /**\n-   * next config experimental.devtoolSegmentExplorer\n-   */\n-  devtoolSegmentExplorer?: boolean\n }\n \n export type RenderOpts = LoadComponentsReturnType<AppPageModule> &"
        },
        {
            "sha": "9dd483cd770a81c15b4cbdaf31cbfec0a8b6b33e",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -581,8 +581,6 @@ export default abstract class Server<\n       onInstrumentationRequestError:\n         this.instrumentationOnRequestError.bind(this),\n       reactMaxHeadersLength: this.nextConfig.reactMaxHeadersLength,\n-      devtoolSegmentExplorer:\n-        this.nextConfig.experimental.devtoolSegmentExplorer,\n     }\n \n     // Initialize next/config with the environment configuration"
        },
        {
            "sha": "ae7644ddf8b5edcb630d1584dcbbcd5d91d28e03",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -513,7 +513,6 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n           })\n           .optional(),\n         globalNotFound: z.boolean().optional(),\n-        devtoolSegmentExplorer: z.boolean().optional(),\n         browserDebugInfoInTerminal: z\n           .union([\n             z.boolean(),"
        },
        {
            "sha": "0c70988bfb6404f5fa6f6825dd4ae77a37d7f18a",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -924,11 +924,6 @@ export interface ExperimentalConfig {\n    */\n   globalNotFound?: boolean\n \n-  /**\n-   * Enable segment viewer for the app directory in Next.js DevTools.\n-   */\n-  devtoolSegmentExplorer?: boolean\n-\n   /**\n    * Enable debug information to be forwarded from browser to dev server stdout/stderr\n    */\n@@ -1647,7 +1642,6 @@ export const defaultConfig = Object.freeze({\n     useCache: undefined,\n     slowModuleDetection: undefined,\n     globalNotFound: false,\n-    devtoolSegmentExplorer: true,\n     browserDebugInfoInTerminal: false,\n     optimizeRouterScrolling: false,\n   },"
        },
        {
            "sha": "feaac4f2003354d121b314f4a81af7630bebef10",
            "filename": "test/development/app-dir/segment-explorer-globals/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fnext.config.js?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   experimental: {\n-    devtoolSegmentExplorer: true,\n     authInterrupts: true,\n     globalNotFound: true,\n   },"
        },
        {
            "sha": "b59dc097c72166678f091cd40c928f4e4aa372b2",
            "filename": "test/development/app-dir/segment-explorer/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fnext.config.js?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   experimental: {\n-    devtoolSegmentExplorer: true,\n     authInterrupts: true,\n   },\n }"
        },
        {
            "sha": "807126e4cf0bf5b1c8c917e6e0148a27331587d1",
            "filename": "test/e2e/app-dir/detachable-panels/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/test%2Fe2e%2Fapp-dir%2Fdetachable-panels%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/test%2Fe2e%2Fapp-dir%2Fdetachable-panels%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fdetachable-panels%2Fnext.config.js?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -1,10 +1,6 @@\n /**\n  * @type {import('next').NextConfig}\n  */\n-const nextConfig = {\n-  experimental: {\n-    devtoolSegmentExplorer: true,\n-  },\n-}\n+const nextConfig = {}\n \n module.exports = nextConfig"
        },
        {
            "sha": "53c6977a8388df0916a101cf28fd39782d69b3ad",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/benches/app-page-turbo.runtime.prod.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/b5fa24b7662d9cc23e95015cddfecb680908f7bf/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fbenches%2Fapp-page-turbo.runtime.prod.js",
            "raw_url": "https://github.com/vercel/next.js/raw/b5fa24b7662d9cc23e95015cddfecb680908f7bf/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fbenches%2Fapp-page-turbo.runtime.prod.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fbenches%2Fapp-page-turbo.runtime.prod.js?ref=b5fa24b7662d9cc23e95015cddfecb680908f7bf",
            "patch": "@@ -28191,7 +28191,7 @@ ${e}`),\n       }\n       if (t.renderOpts.dev) {\n         let e = rT(t.renderOpts.dir || '', null == n ? void 0 : n[1])\n-        if (t.renderOpts.devtoolSegmentExplorer && e) {\n+        if (e) {\n           let n = t.componentMod.SegmentViewNode\n           r = (0, u.jsx)(\n             n,"
        }
    ],
    "stats": {
        "total": 61,
        "additions": 14,
        "deletions": 47
    }
}