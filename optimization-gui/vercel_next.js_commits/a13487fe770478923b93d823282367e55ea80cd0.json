{
    "author": "mischnic",
    "message": "Turbopack: trace worker_threads worker entry (#85734)\n\nCloses PACK-5688  \nCloses https://github.com/vercel/next.js/issues/84766\n\n1. Trace `new require(\"worker_threads\").Worker` calls\n2. ignore syntax errors in all traced files\n\nThis does lead to a build error currently with cargo run --bin turbopack-nft -- --show-issues --graph bench/app-router-server/node_modules/thread-stream/index.js:\n\n```\nerror - [analysis] [workspace]/node_modules/.pnpm/thread-stream@3.1.0/node_modules/thread-stream/test/syntax-error.mjs\n  [workspace]/node_modules/.pnpm/thread-stream@3.1.0/node_modules/thread-stream/test/syntax-error.mjs:2:6  Parsing ecmascript source code failed\n       1 | // this is a syntax error\n         +       v\n       2 + import\n         +       ^\n       3 | \n  \n  Expected 'from', got '<eof>'\n```\n\nPulled in by this partly dynamic `new Worker()`  call: https://github.com/pinojs/thread-stream/blob/82e011281b8895bf5e8f70008e0242927fcaf0cb/index.js#L53-L55\n\n(Related to https://github.com/vercel/next.js/pull/84408, where this was previously fixed for extensionless files such as `LICENSE`)",
    "sha": "a13487fe770478923b93d823282367e55ea80cd0",
    "files": [
        {
            "sha": "35099bd467b7d0f7f3f3a3ebe668a08380cc3a3f",
            "filename": "turbopack/crates/turbopack-core/src/reference_type.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference_type.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference_type.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference_type.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -290,6 +290,7 @@ pub enum WorkerReferenceSubType {\n     WebWorker,\n     SharedWorker,\n     ServiceWorker,\n+    NodeWorker,\n     Custom(u8),\n     Undefined,\n }"
        },
        {
            "sha": "57add8060608f127674b8c2aa57ea9e944e20e28",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/mod.rs",
            "status": "modified",
            "additions": 21,
            "deletions": 8,
            "changes": 29,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -1788,15 +1788,19 @@ impl JsValue {\n                         \"module\",\n                         \"The Node.js `module` module: https://nodejs.org/api/module.html\",\n                     ),\n-                    WellKnownObjectKind::ChildProcess | WellKnownObjectKind::ChildProcessDefault => (\n+                    WellKnownObjectKind::WorkerThreadsModule | WellKnownObjectKind::WorkerThreadsModuleDefault => (\n+                        \"worker_threads\",\n+                        \"The Node.js `worker_threads` module: https://nodejs.org/api/worker_threads.html\",\n+                    ),\n+                    WellKnownObjectKind::ChildProcessModule | WellKnownObjectKind::ChildProcessModuleDefault => (\n                         \"child_process\",\n                         \"The Node.js child_process module: https://nodejs.org/api/child_process.html\",\n                     ),\n                     WellKnownObjectKind::OsModule | WellKnownObjectKind::OsModuleDefault => (\n                         \"os\",\n                         \"The Node.js os module: https://nodejs.org/api/os.html\",\n                     ),\n-                    WellKnownObjectKind::NodeProcess => (\n+                    WellKnownObjectKind::NodeProcessModule => (\n                         \"process\",\n                         \"The Node.js process module: https://nodejs.org/api/process.html\",\n                     ),\n@@ -1954,6 +1958,10 @@ impl JsValue {\n                       \"load/loadSync\".to_string(),\n                       \"require('@grpc/proto-loader').load(filepath, { includeDirs: [root] }) https://github.com/grpc/grpc-node\"\n                     ),\n+                    WellKnownFunctionKind::NodeWorkerConstructor => (\n+                      \"Worker\".to_string(),\n+                      \"The Node.js worker_threads Worker constructor: https://nodejs.org/api/worker_threads.html#worker_threads_class_worker\"\n+                    ),\n                     WellKnownFunctionKind::WorkerConstructor => (\n                       \"Worker\".to_string(),\n                       \"The standard Worker constructor: https://developer.mozilla.org/en-US/docs/Web/API/Worker/Worker\"\n@@ -3468,11 +3476,13 @@ pub enum WellKnownObjectKind {\n     ModuleModuleDefault,\n     UrlModule,\n     UrlModuleDefault,\n-    ChildProcess,\n-    ChildProcessDefault,\n+    WorkerThreadsModule,\n+    WorkerThreadsModuleDefault,\n+    ChildProcessModule,\n+    ChildProcessModuleDefault,\n     OsModule,\n     OsModuleDefault,\n-    NodeProcess,\n+    NodeProcessModule,\n     NodeProcessArgv,\n     NodeProcessEnv,\n     NodePreGyp,\n@@ -3492,9 +3502,10 @@ impl WellKnownObjectKind {\n             Self::PathModule => Some(&[\"path\"]),\n             Self::FsModule => Some(&[\"fs\"]),\n             Self::UrlModule => Some(&[\"url\"]),\n-            Self::ChildProcess => Some(&[\"child_process\"]),\n+            Self::ChildProcessModule => Some(&[\"child_process\"]),\n             Self::OsModule => Some(&[\"os\"]),\n-            Self::NodeProcess => Some(&[\"process\"]),\n+            Self::WorkerThreadsModule => Some(&[\"worker_threads\"]),\n+            Self::NodeProcessModule => Some(&[\"process\"]),\n             Self::NodeProcessArgv => Some(&[\"process\", \"argv\"]),\n             Self::NodeProcessEnv => Some(&[\"process\", \"env\"]),\n             Self::NodeBuffer => Some(&[\"Buffer\"]),\n@@ -3623,6 +3634,8 @@ pub enum WellKnownFunctionKind {\n     NodeResolveFrom,\n     NodeProtobufLoad,\n     WorkerConstructor,\n+    // The worker_threads Worker class\n+    NodeWorkerConstructor,\n     URLConstructor,\n }\n \n@@ -3797,7 +3810,7 @@ pub mod test_utils {\n                 ),\n                 \"define\" => JsValue::WellKnownFunction(WellKnownFunctionKind::Define),\n                 \"URL\" => JsValue::WellKnownFunction(WellKnownFunctionKind::URLConstructor),\n-                \"process\" => JsValue::WellKnownObject(WellKnownObjectKind::NodeProcess),\n+                \"process\" => JsValue::WellKnownObject(WellKnownObjectKind::NodeProcessModule),\n                 \"Object\" => JsValue::WellKnownObject(WellKnownObjectKind::GlobalObject),\n                 \"Buffer\" => JsValue::WellKnownObject(WellKnownObjectKind::NodeBuffer),\n                 _ => v.into_unknown(true, \"unknown global\"),"
        },
        {
            "sha": "363dd73214097763fd778bd91cf8260bec75ca52",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/well_known.rs",
            "status": "modified",
            "additions": 38,
            "deletions": 8,
            "changes": 46,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fwell_known.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fwell_known.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fwell_known.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -609,13 +609,18 @@ async fn well_known_object_member(\n         WellKnownObjectKind::UrlModule | WellKnownObjectKind::UrlModuleDefault => {\n             url_module_member(kind, prop)\n         }\n-        WellKnownObjectKind::ChildProcess | WellKnownObjectKind::ChildProcessDefault => {\n-            child_process_module_member(kind, prop)\n+        WellKnownObjectKind::WorkerThreadsModule\n+        | WellKnownObjectKind::WorkerThreadsModuleDefault => {\n+            worker_threads_module_member(kind, prop)\n         }\n+        WellKnownObjectKind::ChildProcessModule\n+        | WellKnownObjectKind::ChildProcessModuleDefault => child_process_module_member(kind, prop),\n         WellKnownObjectKind::OsModule | WellKnownObjectKind::OsModuleDefault => {\n             os_module_member(kind, prop)\n         }\n-        WellKnownObjectKind::NodeProcess => node_process_member(prop, compile_time_info).await?,\n+        WellKnownObjectKind::NodeProcessModule => {\n+            node_process_member(prop, compile_time_info).await?\n+        }\n         WellKnownObjectKind::NodePreGyp => node_pre_gyp(prop),\n         WellKnownObjectKind::NodeExpressApp => express(prop),\n         WellKnownObjectKind::NodeProtobufLoader => protobuf_loader(prop),\n@@ -762,7 +767,7 @@ fn url_module_member(kind: WellKnownObjectKind, prop: JsValue) -> JsValue {\n         (.., Some(\"pathToFileURL\")) => {\n             JsValue::WellKnownFunction(WellKnownFunctionKind::PathToFileUrl)\n         }\n-        (WellKnownObjectKind::UrlModuleDefault, Some(\"default\")) => {\n+        (WellKnownObjectKind::UrlModule, Some(\"default\")) => {\n             JsValue::WellKnownObject(WellKnownObjectKind::UrlModuleDefault)\n         }\n         _ => JsValue::unknown(\n@@ -776,6 +781,27 @@ fn url_module_member(kind: WellKnownObjectKind, prop: JsValue) -> JsValue {\n     }\n }\n \n+fn worker_threads_module_member(kind: WellKnownObjectKind, prop: JsValue) -> JsValue {\n+    match (kind, prop.as_str()) {\n+        (.., Some(\"Worker\")) => {\n+            JsValue::WellKnownFunction(WellKnownFunctionKind::NodeWorkerConstructor)\n+        }\n+        (WellKnownObjectKind::WorkerThreadsModule, Some(\"default\")) => {\n+            JsValue::WellKnownObject(WellKnownObjectKind::WorkerThreadsModuleDefault)\n+        }\n+        _ => JsValue::unknown(\n+            JsValue::member(\n+                Box::new(JsValue::WellKnownObject(\n+                    WellKnownObjectKind::WorkerThreadsModule,\n+                )),\n+                Box::new(prop),\n+            ),\n+            true,\n+            \"unsupported property on Node.js worker_threads module\",\n+        ),\n+    }\n+}\n+\n fn child_process_module_member(kind: WellKnownObjectKind, prop: JsValue) -> JsValue {\n     let prop_str = prop.as_str();\n     match (kind, prop_str) {\n@@ -785,13 +811,15 @@ fn child_process_module_member(kind: WellKnownObjectKind, prop: JsValue) -> JsVa\n             ))\n         }\n         (.., Some(\"fork\")) => JsValue::WellKnownFunction(WellKnownFunctionKind::ChildProcessFork),\n-        (WellKnownObjectKind::ChildProcess, Some(\"default\")) => {\n-            JsValue::WellKnownObject(WellKnownObjectKind::ChildProcessDefault)\n+        (WellKnownObjectKind::ChildProcessModule, Some(\"default\")) => {\n+            JsValue::WellKnownObject(WellKnownObjectKind::ChildProcessModuleDefault)\n         }\n \n         _ => JsValue::unknown(\n             JsValue::member(\n-                Box::new(JsValue::WellKnownObject(WellKnownObjectKind::ChildProcess)),\n+                Box::new(JsValue::WellKnownObject(\n+                    WellKnownObjectKind::ChildProcessModule,\n+                )),\n                 Box::new(prop),\n             ),\n             true,\n@@ -843,7 +871,9 @@ async fn node_process_member(\n         Some(\"env\") => JsValue::WellKnownObject(WellKnownObjectKind::NodeProcessEnv),\n         _ => JsValue::unknown(\n             JsValue::member(\n-                Box::new(JsValue::WellKnownObject(WellKnownObjectKind::NodeProcess)),\n+                Box::new(JsValue::WellKnownObject(\n+                    WellKnownObjectKind::NodeProcessModule,\n+                )),\n                 Box::new(prop),\n             ),\n             true,"
        },
        {
            "sha": "3aa37c0d0ae34c1d4266edc6a331e808c12364b5",
            "filename": "turbopack/crates/turbopack-ecmascript/src/parse.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 9,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fparse.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fparse.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fparse.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -176,15 +176,9 @@ pub async fn parse(\n         ty = display(&ty)\n     );\n \n-    match parse_internal(\n-        source,\n-        ty,\n-        transforms,\n-        is_external_tracing && matches!(ty, EcmascriptModuleAssetType::EcmascriptExtensionless),\n-        inline_helpers,\n-    )\n-    .instrument(span)\n-    .await\n+    match parse_internal(source, ty, transforms, is_external_tracing, inline_helpers)\n+        .instrument(span)\n+        .await\n     {\n         Ok(result) => Ok(result),\n         Err(error) => Err(error.context(format!("
        },
        {
            "sha": "b7056b8d37fa96e84fa06d6cf2fba16d1c930828",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/mod.rs",
            "status": "modified",
            "additions": 73,
            "deletions": 27,
            "changes": 100,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -151,7 +151,7 @@ use crate::{\n         },\n         ident::IdentReplacement,\n         member::MemberReplacement,\n-        node::PackageJsonReference,\n+        node::{FilePathModuleReference, PackageJsonReference},\n         require_context::{RequireContextAssetReference, RequireContextMap},\n         type_issue::SpecifiedModuleTypeIssue,\n     },\n@@ -1646,8 +1646,27 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n             .await\n     };\n \n-    let make_issue_source =\n+    let get_traced_project_dir = async || -> Result<FileSystemPath> {\n+        // readFileSync(\"./foo\") should always be relative to the project root, but this is\n+        // dangerous inside of node_modules as it can cause a lot of false positives in the tracing,\n+        // if some package does `path.join(dynamic)`, it would include everything from the project\n+        // root as well.\n+        //\n+        // Also, when there's no cwd set (i.e. in a tracing-specific module context, as we shouldn't\n+        // assume a `process.cwd()` for all of node_modules), fallback to the source file directory.\n+        // This still allows relative file accesses, just not from the project root.\n+        if allow_project_root_tracing\n+            && let Some(cwd) = compile_time_info.environment().cwd().owned().await?\n+        {\n+            Ok(cwd)\n+        } else {\n+            Ok(source.ident().path().await?.parent())\n+        }\n+    };\n+\n+    let get_issue_source =\n         || IssueSource::from_swc_offsets(source, span.lo.to_u32(), span.hi.to_u32());\n+\n     if new {\n         match func {\n             JsValue::WellKnownFunction(WellKnownFunctionKind::URLConstructor) => {\n@@ -1726,9 +1745,54 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n                 // Ignore (e.g. dynamic parameter or string literal), just as Webpack does\n                 return Ok(());\n             }\n+            JsValue::WellKnownFunction(WellKnownFunctionKind::NodeWorkerConstructor)\n+                if analysis.analyze_mode.is_tracing() =>\n+            {\n+                // Only for tracing, not for bundling (yet?)\n+                let args = linked_args(args).await?;\n+                if !args.is_empty() {\n+                    let pat = js_value_to_pattern(&args[0]);\n+                    if !pat.has_constant_parts() {\n+                        let (args, hints) = explain_args(&args);\n+                        handler.span_warn_with_code(\n+                            span,\n+                            &format!(\"new Worker({args}) is very dynamic{hints}\",),\n+                            DiagnosticId::Lint(\n+                                errors::failed_to_analyze::ecmascript::NEW_WORKER.to_string(),\n+                            ),\n+                        );\n+                        if ignore_dynamic_requests {\n+                            return Ok(());\n+                        }\n+                    }\n+                    analysis.add_reference(\n+                        FilePathModuleReference::new(\n+                            origin.asset_context(),\n+                            get_traced_project_dir().await?,\n+                            Pattern::new(pat),\n+                            collect_affecting_sources,\n+                            get_issue_source(),\n+                        )\n+                        .to_resolved()\n+                        .await?,\n+                    );\n+                    return Ok(());\n+                }\n+                let (args, hints) = explain_args(&args);\n+                handler.span_warn_with_code(\n+                    span,\n+                    &format!(\"new Worker({args}) is not statically analyze-able{hints}\",),\n+                    DiagnosticId::Error(\n+                        errors::failed_to_analyze::ecmascript::FS_METHOD.to_string(),\n+                    ),\n+                );\n+                // Ignore (e.g. dynamic parameter or string literal)\n+                return Ok(());\n+            }\n             _ => {}\n         }\n \n+        // linked_args wasn't called, so manually add the closure effects\n         for arg in args {\n             if let EffectArg::Closure(_, block) = arg {\n                 add_effects(block.effects);\n@@ -1737,24 +1801,6 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n         return Ok(());\n     }\n \n-    let get_traced_project_dir = async || -> Result<FileSystemPath> {\n-        // readFileSync(\"./foo\") should always be relative to the project root, but this is\n-        // dangerous inside of node_modules as it can cause a lot of false positives in the tracing,\n-        // if some package does `path.join(dynamic)`, it would include everything from the project\n-        // root as well.\n-        //\n-        // Also, when there's no cwd set (i.e. in a tracing-specific module context, as we shouldn't\n-        // assume a `process.cwd()` for all of node_modules), fallback to the source file directory.\n-        // This still allows relative file accesses, just not from the project root.\n-        if allow_project_root_tracing\n-            && let Some(cwd) = compile_time_info.environment().cwd().owned().await?\n-        {\n-            Ok(cwd)\n-        } else {\n-            Ok(source.ident().path().await?.parent())\n-        }\n-    };\n-\n     match func {\n         JsValue::Alternatives {\n             total_nodes: _,\n@@ -1988,7 +2034,7 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n                         get_traced_project_dir().await?,\n                         Pattern::new(pat),\n                         collect_affecting_sources,\n-                        make_issue_source(),\n+                        get_issue_source(),\n                     )\n                     .to_resolved()\n                     .await?,\n@@ -2041,7 +2087,7 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n                 DirAssetReference::new(\n                     get_traced_project_dir().await?,\n                     Pattern::new(pat),\n-                    make_issue_source(),\n+                    get_issue_source(),\n                 )\n                 .to_resolved()\n                 .await?,\n@@ -2085,7 +2131,7 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n                 DirAssetReference::new(\n                     get_traced_project_dir().await?,\n                     Pattern::new(pat),\n-                    make_issue_source(),\n+                    get_issue_source(),\n                 )\n                 .to_resolved()\n                 .await?,\n@@ -2376,7 +2422,7 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n                                 DirAssetReference::new(\n                                     get_traced_project_dir().await?,\n                                     Pattern::new(abs_pattern),\n-                                    make_issue_source(),\n+                                    get_issue_source(),\n                                 )\n                                 .to_resolved()\n                                 .await?,\n@@ -2443,7 +2489,7 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n                     DirAssetReference::new(\n                         get_traced_project_dir().await?,\n                         Pattern::new(abs_pattern),\n-                        make_issue_source(),\n+                        get_issue_source(),\n                     )\n                     .to_resolved()\n                     .await?,\n@@ -2512,7 +2558,7 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n                         DirAssetReference::new(\n                             context_dir.clone(),\n                             Pattern::new(Pattern::Constant(dir.into())),\n-                            make_issue_source(),\n+                            get_issue_source(),\n                         )\n                         .to_resolved()\n                     })\n@@ -3147,7 +3193,7 @@ async fn value_visitor_inner(\n             ),\n             \"define\" => JsValue::WellKnownFunction(WellKnownFunctionKind::Define),\n             \"URL\" => JsValue::WellKnownFunction(WellKnownFunctionKind::URLConstructor),\n-            \"process\" => JsValue::WellKnownObject(WellKnownObjectKind::NodeProcess),\n+            \"process\" => JsValue::WellKnownObject(WellKnownObjectKind::NodeProcessModule),\n             \"Object\" => JsValue::WellKnownObject(WellKnownObjectKind::GlobalObject),\n             \"Buffer\" => JsValue::WellKnownObject(WellKnownObjectKind::NodeBuffer),\n             _ => return Ok((v, false)),"
        },
        {
            "sha": "e4e92c7faed2926863452551acc010e51b6792e1",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/node.rs",
            "status": "modified",
            "additions": 97,
            "deletions": 2,
            "changes": 99,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fnode.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fnode.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fnode.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -1,12 +1,21 @@\n use anyhow::Result;\n+use tracing::Instrument;\n use turbo_rcstr::RcStr;\n use turbo_tasks::{ResolvedVc, ValueToString, Vc};\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::{\n-    file_source::FileSource, raw_module::RawModule, reference::ModuleReference,\n-    resolve::ModuleResolveResult,\n+    chunk::{ChunkableModuleReference, ChunkingType, ChunkingTypeOption},\n+    context::AssetContext,\n+    file_source::FileSource,\n+    issue::IssueSource,\n+    raw_module::RawModule,\n+    reference::ModuleReference,\n+    reference_type::{ReferenceType, WorkerReferenceSubType},\n+    resolve::{ModuleResolveResult, pattern::Pattern, resolve_raw},\n };\n \n+use crate::references::util::check_and_emit_too_many_matches_warning;\n+\n #[turbo_tasks::value]\n #[derive(Hash, Clone, Debug)]\n pub struct PackageJsonReference {\n@@ -46,3 +55,89 @@ impl ValueToString for PackageJsonReference {\n         ))\n     }\n }\n+\n+#[turbo_tasks::value]\n+#[derive(Hash, Debug)]\n+pub struct FilePathModuleReference {\n+    asset_context: ResolvedVc<Box<dyn AssetContext>>,\n+    context_dir: FileSystemPath,\n+    path: ResolvedVc<Pattern>,\n+    collect_affecting_sources: bool,\n+    issue_source: IssueSource,\n+}\n+\n+#[turbo_tasks::value_impl]\n+impl FilePathModuleReference {\n+    #[turbo_tasks::function]\n+    pub fn new(\n+        asset_context: ResolvedVc<Box<dyn AssetContext>>,\n+        context_dir: FileSystemPath,\n+        path: ResolvedVc<Pattern>,\n+        collect_affecting_sources: bool,\n+        issue_source: IssueSource,\n+    ) -> Vc<Self> {\n+        Self {\n+            asset_context,\n+            context_dir,\n+            path,\n+            collect_affecting_sources,\n+            issue_source,\n+        }\n+        .cell()\n+    }\n+}\n+\n+// A reference to an module by absolute or cwd-relative file path (e.g. for the\n+// worker-threads `new Worker` which has the resolving behavior of `fs.readFile` but should treat\n+// the resolve result as an module instead of a raw source).\n+#[turbo_tasks::value_impl]\n+impl ModuleReference for FilePathModuleReference {\n+    #[turbo_tasks::function]\n+    async fn resolve_reference(&self) -> Result<Vc<ModuleResolveResult>> {\n+        let span = tracing::info_span!(\n+            \"trace module\",\n+            pattern = display(self.path.to_string().await?)\n+        );\n+        async {\n+            let result = resolve_raw(\n+                self.context_dir.clone(),\n+                *self.path,\n+                self.collect_affecting_sources,\n+                /* force_in_lookup_dir */ false,\n+            );\n+            let result = self.asset_context.process_resolve_result(\n+                result,\n+                ReferenceType::Worker(WorkerReferenceSubType::NodeWorker),\n+            );\n+\n+            check_and_emit_too_many_matches_warning(\n+                result,\n+                self.issue_source,\n+                self.context_dir.clone(),\n+                self.path,\n+            )\n+            .await?;\n+\n+            Ok(result)\n+        }\n+        .instrument(span)\n+        .await\n+    }\n+}\n+#[turbo_tasks::value_impl]\n+impl ChunkableModuleReference for FilePathModuleReference {\n+    #[turbo_tasks::function]\n+    fn chunking_type(&self) -> Vc<ChunkingTypeOption> {\n+        Vc::cell(Some(ChunkingType::Traced))\n+    }\n+}\n+\n+#[turbo_tasks::value_impl]\n+impl ValueToString for FilePathModuleReference {\n+    #[turbo_tasks::function]\n+    async fn to_string(&self) -> Result<Vc<RcStr>> {\n+        Ok(Vc::cell(\n+            format!(\"raw asset {}\", self.path.to_string().await?,).into(),\n+        ))\n+    }\n+}"
        },
        {
            "sha": "9b9330bfcec97a31e1073cad5ea96016e6446161",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/raw.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 81,
            "changes": 85,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fraw.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fraw.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fraw.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -6,10 +6,7 @@ use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::{\n     chunk::{ChunkableModuleReference, ChunkingType, ChunkingTypeOption},\n     file_source::FileSource,\n-    issue::{\n-        Issue, IssueExt, IssueSeverity, IssueSource, IssueStage, OptionIssueSource,\n-        OptionStyledString, StyledString,\n-    },\n+    issue::IssueSource,\n     raw_module::RawModule,\n     reference::ModuleReference,\n     resolve::{\n@@ -18,6 +15,9 @@ use turbopack_core::{\n         resolve_raw,\n     },\n };\n+\n+use crate::references::util::check_and_emit_too_many_matches_warning;\n+\n #[turbo_tasks::value]\n #[derive(Hash, Debug)]\n pub struct FileSourceReference {\n@@ -235,80 +235,3 @@ impl ValueToString for DirAssetReference {\n         ))\n     }\n }\n-\n-/// If a pattern resolves to more than 10000 results, it's likely a mistake so issue a warning.\n-const TOO_MANY_MATCHES_LIMIT: usize = 10000;\n-\n-async fn check_and_emit_too_many_matches_warning(\n-    result: Vc<ModuleResolveResult>,\n-    issue_source: IssueSource,\n-    context_dir: FileSystemPath,\n-    pattern: ResolvedVc<Pattern>,\n-) -> Result<()> {\n-    let num_matches = result.await?.primary.len();\n-    if num_matches > TOO_MANY_MATCHES_LIMIT {\n-        TooManyMatchesWarning {\n-            source: issue_source,\n-            context_dir,\n-            num_matches,\n-            pattern,\n-        }\n-        .resolved_cell()\n-        .emit();\n-    }\n-    Ok(())\n-}\n-\n-#[turbo_tasks::value(shared)]\n-struct TooManyMatchesWarning {\n-    source: IssueSource,\n-    context_dir: FileSystemPath,\n-    num_matches: usize,\n-    pattern: ResolvedVc<Pattern>,\n-}\n-\n-#[turbo_tasks::value_impl]\n-impl Issue for TooManyMatchesWarning {\n-    #[turbo_tasks::function]\n-    async fn title(&self) -> Result<Vc<StyledString>> {\n-        Ok(StyledString::Text(\n-            format!(\n-                \"The file pattern {pattern} matches {num_matches} files in {context_dir}\",\n-                pattern = self.pattern.to_string().await?,\n-                context_dir = self.context_dir.value_to_string().await?,\n-                num_matches = self.num_matches\n-            )\n-            .into(),\n-        )\n-        .cell())\n-    }\n-\n-    #[turbo_tasks::function]\n-    fn description(&self) -> Vc<OptionStyledString> {\n-        Vc::cell(Some(\n-            StyledString::Text(rcstr!(\n-                \"Overly broad patterns can lead to build performance issues and over bundling.\"\n-            ))\n-            .resolved_cell(),\n-        ))\n-    }\n-\n-    #[turbo_tasks::function]\n-    async fn file_path(&self) -> Vc<FileSystemPath> {\n-        self.source.file_path()\n-    }\n-\n-    #[turbo_tasks::function]\n-    fn stage(&self) -> Vc<IssueStage> {\n-        IssueStage::Resolve.cell()\n-    }\n-\n-    fn severity(&self) -> IssueSeverity {\n-        IssueSeverity::Warning\n-    }\n-\n-    #[turbo_tasks::function]\n-    fn source(&self) -> Vc<OptionIssueSource> {\n-        Vc::cell(Some(self.source))\n-    }\n-}"
        },
        {
            "sha": "e43e0b637aa438edde25020d9ca860d55b15b792",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/util.rs",
            "status": "modified",
            "additions": 87,
            "deletions": 2,
            "changes": 89,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Futil.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Futil.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Futil.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -1,8 +1,16 @@\n use anyhow::Result;\n use swc_core::{ecma::ast::Expr, quote};\n use turbo_rcstr::{RcStr, rcstr};\n-use turbo_tasks::Vc;\n-use turbopack_core::{self, resolve::parse::Request};\n+use turbo_tasks::{ResolvedVc, ValueToString, Vc};\n+use turbo_tasks_fs::FileSystemPath;\n+use turbopack_core::{\n+    self,\n+    issue::{\n+        Issue, IssueExt, IssueSeverity, IssueSource, IssueStage, OptionIssueSource,\n+        OptionStyledString, StyledString,\n+    },\n+    resolve::{ModuleResolveResult, parse::Request, pattern::Pattern},\n+};\n \n /// Creates a IIFE expression that throws a \"Cannot find module\" error for the\n /// given request string\n@@ -36,3 +44,80 @@ pub async fn request_to_string(request: Vc<Request>) -> Result<Vc<RcStr>> {\n             .unwrap_or(rcstr!(\"unknown\")),\n     ))\n }\n+\n+/// If a pattern resolves to more than 10000 results, it's likely a mistake so issue a warning.\n+const TOO_MANY_MATCHES_LIMIT: usize = 10000;\n+\n+pub async fn check_and_emit_too_many_matches_warning(\n+    result: Vc<ModuleResolveResult>,\n+    issue_source: IssueSource,\n+    context_dir: FileSystemPath,\n+    pattern: ResolvedVc<Pattern>,\n+) -> Result<()> {\n+    let num_matches = result.await?.primary.len();\n+    if num_matches > TOO_MANY_MATCHES_LIMIT {\n+        TooManyMatchesWarning {\n+            source: issue_source,\n+            context_dir,\n+            num_matches,\n+            pattern,\n+        }\n+        .resolved_cell()\n+        .emit();\n+    }\n+    Ok(())\n+}\n+\n+#[turbo_tasks::value(shared)]\n+struct TooManyMatchesWarning {\n+    source: IssueSource,\n+    context_dir: FileSystemPath,\n+    num_matches: usize,\n+    pattern: ResolvedVc<Pattern>,\n+}\n+\n+#[turbo_tasks::value_impl]\n+impl Issue for TooManyMatchesWarning {\n+    #[turbo_tasks::function]\n+    async fn title(&self) -> Result<Vc<StyledString>> {\n+        Ok(StyledString::Text(\n+            format!(\n+                \"The file pattern {pattern} matches {num_matches} files in {context_dir}\",\n+                pattern = self.pattern.to_string().await?,\n+                context_dir = self.context_dir.value_to_string().await?,\n+                num_matches = self.num_matches\n+            )\n+            .into(),\n+        )\n+        .cell())\n+    }\n+\n+    #[turbo_tasks::function]\n+    fn description(&self) -> Vc<OptionStyledString> {\n+        Vc::cell(Some(\n+            StyledString::Text(rcstr!(\n+                \"Overly broad patterns can lead to build performance issues and over bundling.\"\n+            ))\n+            .resolved_cell(),\n+        ))\n+    }\n+\n+    #[turbo_tasks::function]\n+    async fn file_path(&self) -> Vc<FileSystemPath> {\n+        self.source.file_path()\n+    }\n+\n+    #[turbo_tasks::function]\n+    fn stage(&self) -> Vc<IssueStage> {\n+        IssueStage::Resolve.cell()\n+    }\n+\n+    fn severity(&self) -> IssueSeverity {\n+        IssueSeverity::Warning\n+    }\n+\n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionIssueSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+}"
        },
        {
            "sha": "a3f4e7d914c9d1639ff8d753fdcfcb64189e675d",
            "filename": "turbopack/crates/turbopack-ecmascript/src/static_code.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fstatic_code.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fstatic_code.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fstatic_code.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -16,7 +16,6 @@ use crate::EcmascriptAnalyzable;\n /// the final runtime code, while keeping source map information.\n #[turbo_tasks::value]\n pub struct StaticEcmascriptCode {\n-    asset_context: ResolvedVc<Box<dyn AssetContext>>,\n     asset: ResolvedVc<Box<dyn EcmascriptAnalyzable>>,\n     generate_source_map: bool,\n }\n@@ -42,7 +41,6 @@ impl StaticEcmascriptCode {\n             bail!(\"asset is not an Ecmascript module\")\n         };\n         Ok(Self::cell(StaticEcmascriptCode {\n-            asset_context,\n             asset,\n             generate_source_map,\n         }))"
        },
        {
            "sha": "b7e5523794cc57466f722639a3ce52f70f8afb32",
            "filename": "turbopack/crates/turbopack-ecmascript/src/utils.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Futils.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Futils.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Futils.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -197,12 +197,17 @@ pub fn module_value_to_well_known_object(module_value: &ModuleValue) -> Option<J\n         }\n         \"node:fs\" | \"fs\" => JsValue::WellKnownObject(WellKnownObjectKind::FsModule),\n         \"node:child_process\" | \"child_process\" => {\n-            JsValue::WellKnownObject(WellKnownObjectKind::ChildProcess)\n+            JsValue::WellKnownObject(WellKnownObjectKind::ChildProcessModule)\n         }\n         \"node:os\" | \"os\" => JsValue::WellKnownObject(WellKnownObjectKind::OsModule),\n-        \"node:process\" | \"process\" => JsValue::WellKnownObject(WellKnownObjectKind::NodeProcess),\n+        \"node:process\" | \"process\" => {\n+            JsValue::WellKnownObject(WellKnownObjectKind::NodeProcessModule)\n+        }\n         \"node:url\" | \"url\" => JsValue::WellKnownObject(WellKnownObjectKind::UrlModule),\n         \"node:module\" | \"module\" => JsValue::WellKnownObject(WellKnownObjectKind::ModuleModule),\n+        \"node:worker_threads\" | \"worker_threads\" => {\n+            JsValue::WellKnownObject(WellKnownObjectKind::WorkerThreadsModule)\n+        }\n         \"node-pre-gyp\" | \"@mapbox/node-pre-gyp\" => {\n             JsValue::WellKnownObject(WellKnownObjectKind::NodePreGyp)\n         }"
        },
        {
            "sha": "43d46aa852176006103365f21625b5c050f384a1",
            "filename": "turbopack/crates/turbopack-nft/src/nft.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-nft%2Fsrc%2Fnft.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-nft%2Fsrc%2Fnft.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-nft%2Fsrc%2Fnft.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -76,7 +76,7 @@ async fn node_file_trace_operation(\n     let environment = Environment::new(ExecutionEnvironment::NodeJsLambda(\n         NodeJsEnvironment::default().resolved_cell(),\n     ));\n-    let module_asset_context = ModuleAssetContext::new(\n+    let module_asset_context = ModuleAssetContext::new_without_replace_externals(\n         Default::default(),\n         // This config should be kept in sync with\n         // turbopack/crates/turbopack-tracing/tests/node-file-trace.rs and\n@@ -109,6 +109,7 @@ async fn node_file_trace_operation(\n             enable_node_native_modules: true,\n             enable_node_modules: Some(input_dir),\n             custom_conditions: vec![rcstr!(\"node\")],\n+            enable_node_externals: true,\n             loose_errors: true,\n             collect_affecting_sources: true,\n             ..Default::default()"
        },
        {
            "sha": "a6d8e47dbaf55518a86e6957cbb3f06b3a4caa00",
            "filename": "turbopack/crates/turbopack-tracing/tests/node-file-trace.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -149,6 +149,7 @@ static ALLOC: turbo_tasks_malloc::TurboMalloc = turbo_tasks_malloc::TurboMalloc;\n #[case::pdf2json(\"integration/pdf2json.mjs\")]\n #[case::pdfkit(\"integration/pdfkit.js\")]\n #[case::pg(\"integration/pg.js\")]\n+#[case::pino(\"integration/pino.js\")]\n #[case::playwright_core(\"integration/playwright-core.js\")]\n #[case::pnpm_like(\"integration/pnpm/pnpm-like.js\")]\n #[case::polyfill_library(\"integration/polyfill-library.js\")]\n@@ -357,7 +358,7 @@ async fn node_file_trace_operation(\n         }\n         .resolved_cell(),\n     ));\n-    let module_asset_context = ModuleAssetContext::new(\n+    let module_asset_context = ModuleAssetContext::new_without_replace_externals(\n         Default::default(),\n         // TODO These test cases should move into the `node-file-trace` crate and use the same\n         // config."
        },
        {
            "sha": "7863d7961aa45722b39ca1248abeb499a5b02da7",
            "filename": "turbopack/crates/turbopack-tracing/tests/node-file-trace/integration/pino.js",
            "status": "added",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace%2Fintegration%2Fpino.js",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace%2Fintegration%2Fpino.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace%2Fintegration%2Fpino.js?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -0,0 +1,18 @@\n+// for transport({target: 'pino-pretty'}) to work\n+require('pino-pretty')\n+\n+const { pino, transport } = require('pino')\n+\n+const loggerOptions = {\n+  level: 'info',\n+  timestamp: false,\n+}\n+const loggerTransport = transport({\n+  target: 'pino-pretty',\n+  options: {\n+    ignore: 'pid,hostname',\n+  },\n+})\n+const logger = pino(loggerOptions, loggerTransport)\n+\n+logger.info('foo')"
        },
        {
            "sha": "749ab10f90a9c10e29a51254a4f99becc0555cc0",
            "filename": "turbopack/crates/turbopack-tracing/tests/node-file-trace/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace%2Fpackage.json?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -86,6 +86,8 @@\n     \"pg\": \"^7.11.0\",\n     \"phantomjs-prebuilt\": \"^2.1.16\",\n     \"pixelmatch\": \"^5.3.0\",\n+    \"pino\": \"^10.1.0\",\n+    \"pino-pretty\": \"^13.1.2\",\n     \"playwright-core\": \"^1.17.1\",\n     \"polyfill-library\": \"3.93.0\",\n     \"prismjs\": \"^1.25.0\","
        },
        {
            "sha": "50629bad50dc0d23592c31e03082a3f8b46f0ff8",
            "filename": "turbopack/crates/turbopack-tracing/tests/node-file-trace/pnpm-lock.yaml",
            "status": "modified",
            "additions": 146,
            "deletions": 0,
            "changes": 146,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace%2Fpnpm-lock.yaml",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace%2Fpnpm-lock.yaml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Fnode-file-trace%2Fpnpm-lock.yaml?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -258,6 +258,12 @@ importers:\n       phantomjs-prebuilt:\n         specifier: ^2.1.16\n         version: 2.1.16\n+      pino:\n+        specifier: ^10.1.0\n+        version: 10.1.0\n+      pino-pretty:\n+        specifier: ^13.1.2\n+        version: 13.1.2\n       pixelmatch:\n         specifier: ^5.3.0\n         version: 5.3.0\n@@ -1841,6 +1847,9 @@ packages:\n     resolution: {integrity: sha512-m7X9U6BG2+J+R1lSOdCiITLLrxm+cWlNI3HUFA92oLO77ObGNzaKdh8pMLqdZcshtkKuV84olNNXDfMc4FezBQ==}\n     engines: {node: '>=10'}\n \n+  '@pinojs/redact@0.4.0':\n+    resolution: {integrity: sha512-k2ENnmBugE/rzQfEcdWHcCY+/FM3VLzH9cYEsbdsoqrvzAKRhUZeRNhAZvB8OitQJ1TBed3yqWtdjzS6wJKBwg==}\n+\n   '@prisma/instrumentation@6.10.1':\n     resolution: {integrity: sha512-JC8qzgEDuFKjuBsqrZvXHINUb12psnE6Qy3q5p2MBhalC1KW1MBBUwuonx6iS5TCfCdtNslHft8uc2r+EdLWWg==}\n     peerDependencies:\n@@ -3316,6 +3325,10 @@ packages:\n     engines: {node: '>= 4.5.0'}\n     hasBin: true\n \n+  atomic-sleep@1.0.0:\n+    resolution: {integrity: sha512-kNOjDqAh7px0XWNI+4QbzoiR/nTkHAWNud2uvnJquD1/x5a7EQZMJT0AczqK0Qn67oY/TTQ1LbUKajZpp3I9tQ==}\n+    engines: {node: '>=8.0.0'}\n+\n   atomically@2.0.3:\n     resolution: {integrity: sha512-kU6FmrwZ3Lx7/7y3hPS5QnbJfaohcIul5fGqf7ok+4KklIEk9tJ0C2IQPdacSbVUWv6zVHXEBWoWd6NrVMT7Cw==}\n \n@@ -3941,6 +3954,9 @@ packages:\n     resolution: {integrity: sha512-1rXeuUUiGGrykh+CeBdu5Ie7OJwinCgQY0bc7GCRxy5xVHy+moaqkpL/jqQq0MtQOeYcrqEz4abc5f0KtU7W4A==}\n     engines: {node: '>=12.5.0'}\n \n+  colorette@2.0.20:\n+    resolution: {integrity: sha512-IfEDxwoWIjkeXL1eXcDiow4UbKjhLdq6/EuSVR9GMN7KVH3r9gQ83e73hsz1Nd1T3ijd5xv1wcWRYO+D6kCI2w==}\n+\n   combine-source-map@0.8.0:\n     resolution: {integrity: sha512-UlxQ9Vw0b/Bt/KYwCFqdEwsQ1eL8d1gibiFb7lxQJFdvTgc2hIZi6ugsg+kyhzhPV+QEpUiEIwInIAIrgoEkrg==}\n \n@@ -4369,6 +4385,9 @@ packages:\n     resolution: {integrity: sha512-X5eWTSXO/BJmpdIKCRuKUgSCgAN0OwliVK3yPKbwIWU1Tdw5BRajxlzMidvh+gwko9AfQ9zIj52pzF91Q3YAvQ==}\n     engines: {node: '>=10'}\n \n+  dateformat@4.6.3:\n+    resolution: {integrity: sha512-2P0p0pFGzHS5EMnhdxQi7aJN+iMheud0UhG4dlE1DLAlvL8JHjJJTX/CSm4JXwV0Ka5nGk3zC5mcb5bUQUxxMA==}\n+\n   dayjs@1.11.6:\n     resolution: {integrity: sha512-zZbY5giJAinCG+7AGaw0wIhNZ6J8AhWuSXKvuc1KAyMiRsvGQWqh4L+MomvhdAYjN+lqvVCMq1I41e3YHvXkyQ==}\n \n@@ -5117,6 +5136,9 @@ packages:\n     resolution: {integrity: sha512-HuC1qF9iTnHDnML9YZAdCDQwT0yKl/U55K4XSUXqGAA2GLoafFgWRqdAbhWJxXaYD4pyoVxAJ8wH670jMpI9DQ==}\n     engines: {node: '>=0.4.0'}\n \n+  fast-copy@3.0.2:\n+    resolution: {integrity: sha512-dl0O9Vhju8IrcLndv2eU4ldt1ftXMqqfgN4H1cpmGV7P6jeB9FwpN9a2c8DPGE1Ys88rNUJVYDHq73CGAGOPfQ==}\n+\n   fast-deep-equal@3.1.3:\n     resolution: {integrity: sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==}\n \n@@ -5690,6 +5712,9 @@ packages:\n   help-me@1.1.0:\n     resolution: {integrity: sha512-P/IZ8yOMne3SCTHbVY429NZ67B/2bVQlcYGZh2iPPbdLrEQ/qY5aGChn0YTDmt7Sb4IKRI51fypItav+lNl76w==}\n \n+  help-me@5.0.0:\n+    resolution: {integrity: sha512-7xgomUX6ADmcYzFik0HzAxh/73YlKR9bmFzf51CZwR+b6YtzU2m0u49hQCqV6SvlqIqsaxovfwdvbnsw3b/zpg==}\n+\n   highlights@3.1.6:\n     resolution: {integrity: sha512-WvFo8DzI+DnFWPckWjdK5Sne4ucAaNI4guikzAE5k0qhJE7JX2Px7OOolwVJJQmi7YkJDbubWVAxT3SjMUJWcw==}\n     hasBin: true\n@@ -6482,6 +6507,10 @@ packages:\n     resolution: {integrity: sha512-FVoPY7SflDodE4lknJmbAHSUjLCzE2H1F6MS0RYKMQ8SR+lNccpMf8R4eqkNYyyUjR5qZReOzZo5C5YiHOCjjg==}\n     engines: {node: '>=10.13.0 < 13 || >=13.7.0'}\n \n+  joycon@3.1.1:\n+    resolution: {integrity: sha512-34wB/Y7MW7bzjKRjUKTa46I2Z7eV62Rkhva+KkopW7Qvv/OSWBqvkSY7vusOPrNuZcUG3tApvdVgNB8POj3SPw==}\n+    engines: {node: '>=10'}\n+\n   jpeg-js@0.3.7:\n     resolution: {integrity: sha512-9IXdWudL61npZjvLuVe/ktHiA41iE8qFyLB+4VDTblEsWBzeg8WQTlktdUK4CdncUqtUgUg0bbOmTE2bKBKaBQ==}\n \n@@ -7759,6 +7788,10 @@ packages:\n   omggif@1.0.10:\n     resolution: {integrity: sha512-LMJTtvgc/nugXj0Vcrrs68Mn2D1r0zf630VNtqtpI1FEO7e+O9FP4gqs9AcnBaSEeoHIPm28u6qgPR0oyEpGSw==}\n \n+  on-exit-leak-free@2.1.2:\n+    resolution: {integrity: sha512-0eJJY6hXLGf1udHwfNftBqH+g73EU4B504nZeKpz1sYRKafAghwxEJunB2O7rDZkL4PGfsMVnTXZ2EjibbqcsA==}\n+    engines: {node: '>=14.0.0'}\n+\n   on-finished@2.4.1:\n     resolution: {integrity: sha512-oVlzkg3ENAhCk2zdv7IJwd/QUD4z2RxRwpkcGY8psCVcCYZNq4wYnVWALHM+brtuJjePWiYF/ClmuDr8Ch5+kg==}\n     engines: {node: '>= 0.8'}\n@@ -8141,6 +8174,20 @@ packages:\n     resolution: {integrity: sha512-MnUuEycAemtSaeFSjXKW/aroV7akBbY+Sv+RkyqFjgAe73F+MR0TBWKBRDkmfWq/HiFmdavfZ1G7h4SPZXaCSg==}\n     engines: {node: '>=0.10.0'}\n \n+  pino-abstract-transport@2.0.0:\n+    resolution: {integrity: sha512-F63x5tizV6WCh4R6RHyi2Ml+M70DNRXt/+HANowMflpgGFMAym/VKm6G7ZOQRjqN7XbGxK1Lg9t6ZrtzOaivMw==}\n+\n+  pino-pretty@13.1.2:\n+    resolution: {integrity: sha512-3cN0tCakkT4f3zo9RXDIhy6GTvtYD6bK4CRBLN9j3E/ePqN1tugAXD5rGVfoChW6s0hiek+eyYlLNqc/BG7vBQ==}\n+    hasBin: true\n+\n+  pino-std-serializers@7.0.0:\n+    resolution: {integrity: sha512-e906FRY0+tV27iq4juKzSYPbUj2do2X2JX4EzSca1631EB2QJQUqGbDuERal7LCtOpxl6x3+nvo9NPZcmjkiFA==}\n+\n+  pino@10.1.0:\n+    resolution: {integrity: sha512-0zZC2ygfdqvqK8zJIr1e+wT1T/L+LF6qvqvbzEQ6tiMAoTqEVK9a1K3YRu8HEUvGEvNqZyPJTtb2sNIoTkB83w==}\n+    hasBin: true\n+\n   pirates@4.0.5:\n     resolution: {integrity: sha512-8V9+HQPupnaXMA23c5hvl69zXvTwTzyAYasnkb0Tts4XvO4CliqONMOnvlq26rkhLC3nWDFBJf73LU1e1VZLaQ==}\n     engines: {node: '>= 6'}\n@@ -8254,6 +8301,9 @@ packages:\n   process-nextick-args@2.0.1:\n     resolution: {integrity: sha512-3ouUOpQhtgrbOa17J7+uxOTpITYWaGP7/AhoR3+A+/1e9skrzelGi/dXzEYyvbxubEF6Wn2ypscTKiKJFFn1ag==}\n \n+  process-warning@5.0.0:\n+    resolution: {integrity: sha512-a39t9ApHNx2L4+HBnQKqxxHNs1r7KF+Intd8Q/g1bUh6q0WIp9voPXJ/x0j+ZL45KF1pJd9+q2jLIRMfvEshkA==}\n+\n   process@0.11.10:\n     resolution: {integrity: sha512-cdGef/drWFoydD1JsMzuFf8100nZl+GT+yacc2bEced5f9Rjk4z+WtFUTBu9PhOi9j/jfmBPu0mMEY4wIdAF8A==}\n     engines: {node: '>= 0.6.0'}\n@@ -8436,6 +8486,9 @@ packages:\n   queue-microtask@1.2.3:\n     resolution: {integrity: sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==}\n \n+  quick-format-unescaped@4.0.4:\n+    resolution: {integrity: sha512-tYC1Q1hgyRuHgloV/YXs2w15unPVh8qfu/qCTfhTYamaw7fyhumKa2yGpdSo87vY32rIclj+4fWYQXUMs9EHvg==}\n+\n   quick-lru@5.1.1:\n     resolution: {integrity: sha512-WuyALRjWPDGtt/wzJiadO5AXY+8hZ80hVpe6MyivgraREW751X3SbhRvG3eLKOYN+8VEvqLcf3wdnt44Z4S4SA==}\n     engines: {node: '>=10'}\n@@ -8528,6 +8581,10 @@ packages:\n     resolution: {integrity: sha512-1JU/8q+VgFZyxwrJ+SVIOsh+KywWGpds3NTqikiKpDMZWScmAYyKIgqkO+ARvNWJfXeXR1zxz7aHF4u4CyH6vQ==}\n     engines: {node: '>=0.10'}\n \n+  real-require@0.2.0:\n+    resolution: {integrity: sha512-57frrGM/OCTLqLOAh0mhVA9VBMHd+9U7Zb2THMGdBUoZVOtGbJzjxsYGDJ3A9AYYCP4hn6y1TVbaOfzWtm5GFg==}\n+    engines: {node: '>= 12.13.0'}\n+\n   redis-commands@1.7.0:\n     resolution: {integrity: sha512-nJWqw3bTFy21hX/CPKHth6sfhZbdiHP6bTawSgQBlKOVRG7EZkfHbbHwQJnrE4vsQf0CMNE+3gJ4Fmm16vdVlQ==}\n \n@@ -8751,6 +8808,10 @@ packages:\n   safe-regex@1.1.0:\n     resolution: {integrity: sha512-aJXcif4xnaNUzvUuC5gcb46oTS7zvg4jpMTnuqtrEPlR3vFr4pxtdTwaF1Qs3Enjn9HK+ZlwQui+a7z0SywIzg==}\n \n+  safe-stable-stringify@2.5.0:\n+    resolution: {integrity: sha512-b3rppTKm9T+PsVCBEOUR46GWI7fdOs00VKZ1+9c1EWDaDMvjQc6tUwuFyIprgGgTcWoVHSKrU8H31ZHA2e0RHA==}\n+    engines: {node: '>=10'}\n+\n   safer-buffer@2.1.2:\n     resolution: {integrity: sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==}\n \n@@ -8781,6 +8842,9 @@ packages:\n     resolution: {integrity: sha512-5eq1ZKvsIUTkefE/R6PhJyiDDaalPjmdhUPVMuOFh4Yz2n5pBl1COkzNlxQyI8BXEBEIu1nJeJqJPVD0c3vycQ==}\n     hasBin: true\n \n+  secure-json-parse@4.1.0:\n+    resolution: {integrity: sha512-l4KnYfEyqYJxDwlNVyRfO2E4NTHfMKAWdUuA8J0yve2Dz/E/PdBepY03RvyJpssIpRFwJoCD55wA+mEDs6ByWA==}\n+\n   semaphore@1.0.5:\n     resolution: {integrity: sha512-15WnK4TxpOk33fL0UoDnJ5myIWwJiodIZHtPRBoSxcaADt1Tm7kxEERd8n0vsw6OWsXwCCeROjSKU9MqfHaS1A==}\n     engines: {node: '>=0.8.0'}\n@@ -9009,6 +9073,9 @@ packages:\n     resolution: {integrity: sha512-iF+tNDQla22geJdTyJB1wM/qrX9DMRwWrciEPwWLPRWAUEM8sQiyxgckLxWT1f7+9VabJS0jTGGr4QgBuvi6Ww==}\n     engines: {node: '>= 10.0.0', npm: '>= 3.0.0'}\n \n+  sonic-boom@4.2.0:\n+    resolution: {integrity: sha512-INb7TM37/mAcsGmc9hyyI6+QR3rR1zVRu36B0NeGXKnOOLiZOfER5SA+N7X7k3yUYRzLWafduTDvJAfDswwEww==}\n+\n   sort-keys@2.0.0:\n     resolution: {integrity: sha512-/dPCrG1s3ePpWm6yBbxZq5Be1dXGLyLn9Z791chDC3NFrpkVbWGzkBwPN1knaciexFXgRJ7hzdnwZ4stHSDmjg==}\n     engines: {node: '>=4'}\n@@ -9271,6 +9338,10 @@ packages:\n     resolution: {integrity: sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==}\n     engines: {node: '>=8'}\n \n+  strip-json-comments@5.0.3:\n+    resolution: {integrity: sha512-1tB5mhVo7U+ETBKNf92xT4hrQa3pm0MZ0PQvuDnWgAAGHDsfp4lPSpiS6psrSiet87wyGPh9ft6wmhOMQ0hDiw==}\n+    engines: {node: '>=14.16'}\n+\n   stripe@7.63.1:\n     resolution: {integrity: sha512-W6R2CzMF87DeWVtxrAD8E9As62VIu2M9Ece+YKVw2P4oOBgvj5M2F2xH8R5VMmnDtmx4RJtg8PIJ4DmijpLU6g==}\n     engines: {node: ^6 || ^8.1 || >=10.*}\n@@ -9414,6 +9485,9 @@ packages:\n   third-party-web@0.27.0:\n     resolution: {integrity: sha512-h0JYX+dO2Zr3abCQpS6/uFjujaOjA1DyDzGQ41+oFn9VW/ARiq9g5ln7qEP9+BTzDpOMyIfsfj4OvfgXAsMUSA==}\n \n+  thread-stream@3.1.0:\n+    resolution: {integrity: sha512-OqyPZ9u96VohAyMfJykzmivOrY2wfMSf3C5TtFJVgN+Hm6aj+voFhlK+kZEIv2FBh1X6Xp3DlnCOfEQ3B2J86A==}\n+\n   throat@5.0.0:\n     resolution: {integrity: sha512-fcwX4mndzpLQKBS1DVYhGAcYaYt7vsHNIvQV+WXMvnow5cgjPphq5CaayLaGsjRdSCKZFNGt7/GYAuXaNOiYCA==}\n \n@@ -12507,6 +12581,8 @@ snapshots:\n \n   '@phc/format@1.0.0': {}\n \n+  '@pinojs/redact@0.4.0': {}\n+\n   '@prisma/instrumentation@6.10.1(@opentelemetry/api@1.9.0)':\n     dependencies:\n       '@opentelemetry/api': 1.9.0\n@@ -14821,6 +14897,8 @@ snapshots:\n \n   atob@2.1.2: {}\n \n+  atomic-sleep@1.0.0: {}\n+\n   atomically@2.0.3:\n     dependencies:\n       stubborn-fs: 1.2.5\n@@ -15718,6 +15796,8 @@ snapshots:\n       color-convert: 2.0.1\n       color-string: 1.9.1\n \n+  colorette@2.0.20: {}\n+\n   combine-source-map@0.8.0:\n     dependencies:\n       convert-source-map: 1.1.3\n@@ -16025,6 +16105,8 @@ snapshots:\n       whatwg-mimetype: 2.3.0\n       whatwg-url: 8.7.0\n \n+  dateformat@4.6.3: {}\n+\n   dayjs@1.11.6: {}\n \n   debug@2.6.9:\n@@ -16842,6 +16924,8 @@ snapshots:\n       acorn: 7.4.1\n       isarray: 2.0.5\n \n+  fast-copy@3.0.2: {}\n+\n   fast-deep-equal@3.1.3: {}\n \n   fast-fifo@1.3.2: {}\n@@ -17667,6 +17751,8 @@ snapshots:\n       through2: 2.0.5\n       xtend: 4.0.2\n \n+  help-me@5.0.0: {}\n+\n   highlights@3.1.6:\n     dependencies:\n       first-mate: 7.4.3\n@@ -18704,6 +18790,8 @@ snapshots:\n     dependencies:\n       '@panva/asn1.js': 1.0.0\n \n+  joycon@3.1.1: {}\n+\n   jpeg-js@0.3.7: {}\n \n   jpeg-js@0.4.4: {}\n@@ -20249,6 +20337,8 @@ snapshots:\n \n   omggif@1.0.10: {}\n \n+  on-exit-leak-free@2.1.2: {}\n+\n   on-finished@2.4.1:\n     dependencies:\n       ee-first: 1.1.1\n@@ -20639,6 +20729,42 @@ snapshots:\n \n   pinkie@2.0.4: {}\n \n+  pino-abstract-transport@2.0.0:\n+    dependencies:\n+      split2: 4.1.0\n+\n+  pino-pretty@13.1.2:\n+    dependencies:\n+      colorette: 2.0.20\n+      dateformat: 4.6.3\n+      fast-copy: 3.0.2\n+      fast-safe-stringify: 2.1.1\n+      help-me: 5.0.0\n+      joycon: 3.1.1\n+      minimist: 1.2.7\n+      on-exit-leak-free: 2.1.2\n+      pino-abstract-transport: 2.0.0\n+      pump: 3.0.0\n+      secure-json-parse: 4.1.0\n+      sonic-boom: 4.2.0\n+      strip-json-comments: 5.0.3\n+\n+  pino-std-serializers@7.0.0: {}\n+\n+  pino@10.1.0:\n+    dependencies:\n+      '@pinojs/redact': 0.4.0\n+      atomic-sleep: 1.0.0\n+      on-exit-leak-free: 2.1.2\n+      pino-abstract-transport: 2.0.0\n+      pino-std-serializers: 7.0.0\n+      process-warning: 5.0.0\n+      quick-format-unescaped: 4.0.4\n+      real-require: 0.2.0\n+      safe-stable-stringify: 2.5.0\n+      sonic-boom: 4.2.0\n+      thread-stream: 3.1.0\n+\n   pirates@4.0.5: {}\n \n   piscina@3.2.0:\n@@ -20782,6 +20908,8 @@ snapshots:\n \n   process-nextick-args@2.0.1: {}\n \n+  process-warning@5.0.0: {}\n+\n   process@0.11.10: {}\n \n   progress@1.1.8: {}\n@@ -21041,6 +21169,8 @@ snapshots:\n \n   queue-microtask@1.2.3: {}\n \n+  quick-format-unescaped@4.0.4: {}\n+\n   quick-lru@5.1.1: {}\n \n   quickselect@1.1.1: {}\n@@ -21175,6 +21305,8 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  real-require@0.2.0: {}\n+\n   redis-commands@1.7.0: {}\n \n   redis-errors@1.2.0: {}\n@@ -21428,6 +21560,8 @@ snapshots:\n     dependencies:\n       ret: 0.1.15\n \n+  safe-stable-stringify@2.5.0: {}\n+\n   safer-buffer@2.1.2: {}\n \n   saslprep@1.0.3:\n@@ -21457,6 +21591,8 @@ snapshots:\n       fs-plus: 3.1.1\n       yargs: 3.32.0\n \n+  secure-json-parse@4.1.0: {}\n+\n   semaphore@1.0.5: {}\n \n   semver-compare@1.0.0: {}\n@@ -21843,6 +21979,10 @@ snapshots:\n       ip-address: 9.0.5\n       smart-buffer: 4.2.0\n \n+  sonic-boom@4.2.0:\n+    dependencies:\n+      atomic-sleep: 1.0.0\n+\n   sort-keys@2.0.0:\n     dependencies:\n       is-plain-obj: 1.1.0\n@@ -22153,6 +22293,8 @@ snapshots:\n \n   strip-json-comments@3.1.1: {}\n \n+  strip-json-comments@5.0.3: {}\n+\n   stripe@7.63.1:\n     dependencies:\n       qs: 6.11.0\n@@ -22421,6 +22563,10 @@ snapshots:\n \n   third-party-web@0.27.0: {}\n \n+  thread-stream@3.1.0:\n+    dependencies:\n+      real-require: 0.2.0\n+\n   throat@5.0.0: {}\n \n   throat@6.0.1: {}"
        },
        {
            "sha": "1cf8d7bd2c8f8ce08312c485329aed8832dd0a87",
            "filename": "turbopack/crates/turbopack-tracing/tests/unit.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Funit.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Funit.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tracing%2Ftests%2Funit.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -194,7 +194,7 @@ async fn node_file_trace_operation(package_root: RcStr, input: RcStr) -> Result<\n         }\n         .resolved_cell(),\n     ));\n-    let module_asset_context = ModuleAssetContext::new(\n+    let module_asset_context = ModuleAssetContext::new_without_replace_externals(\n         Default::default(),\n         // TODO These test cases should move into the `node-file-trace` crate and use the same\n         // config."
        },
        {
            "sha": "59895300592e104246b6b54ab5bdcb566c654f02",
            "filename": "turbopack/crates/turbopack/src/lib.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/a13487fe770478923b93d823282367e55ea80cd0/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Flib.rs?ref=a13487fe770478923b93d823282367e55ea80cd0",
            "patch": "@@ -391,8 +391,9 @@ impl ModuleAssetContext {\n         })\n     }\n \n+    /// Doesn't replace external resolve results with a CachedExternalModule.\n     #[turbo_tasks::function]\n-    fn new_without_replace_externals(\n+    pub fn new_without_replace_externals(\n         transitions: ResolvedVc<TransitionOptions>,\n         compile_time_info: ResolvedVc<CompileTimeInfo>,\n         module_options_context: ResolvedVc<ModuleOptionsContext>,"
        }
    ],
    "stats": {
        "total": 649,
        "additions": 504,
        "deletions": 145
    }
}