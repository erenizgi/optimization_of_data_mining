{
    "author": "timneutkens",
    "message": "Turbopack: Use single write to loader ipc socket (#78423)\n\nCo-authored-by: Niklas Mischkulnig <4586894+mischnic@users.noreply.github.com>\nCo-authored-by: Luke Sandberg <lukesandberg@users.noreply.github.com>",
    "sha": "b8f05ff313ae13722eda378c4e2fdb2b9738e439",
    "files": [
        {
            "sha": "5be0d569d6dbba85405cf34857e1bd8e104be467",
            "filename": "turbopack/crates/turbopack-node/js/src/ipc/index.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/b8f05ff313ae13722eda378c4e2fdb2b9738e439/turbopack%2Fcrates%2Fturbopack-node%2Fjs%2Fsrc%2Fipc%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b8f05ff313ae13722eda378c4e2fdb2b9738e439/turbopack%2Fcrates%2Fturbopack-node%2Fjs%2Fsrc%2Fipc%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fjs%2Fsrc%2Fipc%2Findex.ts?ref=b8f05ff313ae13722eda378c4e2fdb2b9738e439",
            "patch": "@@ -96,10 +96,9 @@ function createIpc<TIncoming, TOutgoing>(\n   });\n \n   function send(message: any): Promise<void> {\n-    const packet = Buffer.from(JSON.stringify(message), \"utf8\");\n-    const length = Buffer.alloc(4);\n-    length.writeUInt32BE(packet.length);\n-    socket.write(length);\n+    // Reserve 4 bytes for our length prefix, we will over-write after encoding.\n+    const packet = Buffer.from(\"0000\" + JSON.stringify(message), \"utf8\");\n+    packet.writeUInt32BE(packet.length - 4, 0);\n \n     return new Promise((resolve, reject) => {\n       socket.write(packet, (err) => {"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 3,
        "deletions": 4
    }
}