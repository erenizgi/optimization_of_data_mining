{
    "author": "huozhi",
    "message": "[devtools] segment explorer tab (#80805)",
    "sha": "212d0e7ef91738284a8cc34135088e3eaf8edd87",
    "files": [
        {
            "sha": "2a54217465ad73c2b79e2dca666769a9c8c1c4d6",
            "filename": "packages/next/src/build/define-env.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts?ref=212d0e7ef91738284a8cc34135088e3eaf8edd87",
            "patch": "@@ -107,6 +107,10 @@ export function getDefineEnv({\n   const isDynamicIOEnabled = !!config.experimental.dynamicIO\n   const isUseCacheEnabled = !!config.experimental.useCache\n \n+  const isDevToolPanelUIEnabled =\n+    !!process.env.__NEXT_DEVTOOL_NEW_PANEL_UI ||\n+    !!config.experimental.devtoolNewPanelUI\n+\n   const defineEnv: DefineEnv = {\n     // internal field to identify the plugin config\n     __NEXT_DEFINE_ENV: true,\n@@ -297,9 +301,9 @@ export function getDefineEnv({\n         }\n       : {}),\n     'process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER':\n-      config.experimental.devtoolSegmentExplorer ?? false,\n-    'process.env.__NEXT_DEVTOOL_NEW_PANEL_UI':\n-      config.experimental.devtoolNewPanelUI ?? false,\n+      // Enable segment explorer in devtools\n+      isDevToolPanelUIEnabled || !!config.experimental.devtoolSegmentExplorer,\n+    'process.env.__NEXT_DEVTOOL_NEW_PANEL_UI': isDevToolPanelUIEnabled,\n \n     // The devtools need to know whether or not to show an option to clear the\n     // bundler cache. This option may be removed later once Turbopack's"
        },
        {
            "sha": "099631fe721505c4c5dafa6daf535e61372e8773",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-panel/devtools-panel-tab/devtools-panel-tab.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel-tab%2Fdevtools-panel-tab.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel-tab%2Fdevtools-panel-tab.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel-tab%2Fdevtools-panel-tab.tsx?ref=212d0e7ef91738284a8cc34135088e3eaf8edd87",
            "patch": "@@ -6,11 +6,13 @@ import type { HydrationErrorState } from '../../../../shared/hydration-error'\n \n import { SettingsTab } from './settings-tab'\n import { IssuesTab } from './issues-tab/issues-tab'\n+import { SegmentsExplorerTab } from './segments-explorer-tab'\n \n export function DevToolsPanelTab({\n   activeTab,\n   devToolsPosition,\n   scale,\n+  routerType,\n   handlePositionChange,\n   handleScaleChange,\n   debugInfo,\n@@ -20,6 +22,7 @@ export function DevToolsPanelTab({\n }: {\n   activeTab: DevToolsPanelTabType\n   devToolsPosition: Corners\n+  routerType: 'app' | 'pages'\n   scale: number\n   handlePositionChange: (e: React.ChangeEvent<HTMLSelectElement>) => void\n   handleScaleChange: (e: React.ChangeEvent<HTMLSelectElement>) => void\n@@ -39,7 +42,7 @@ export function DevToolsPanelTab({\n         />\n       )\n     case 'route':\n-      return <div>Route</div>\n+      return <SegmentsExplorerTab routerType={routerType} />\n     case 'issues':\n       return (\n         <IssuesTab"
        },
        {
            "sha": "5296e7f628c557466a02be2de5250b98e0029269",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-panel/devtools-panel-tab/segments-explorer-tab.tsx",
            "status": "added",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/vercel/next.js/blob/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel-tab%2Fsegments-explorer-tab.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel-tab%2Fsegments-explorer-tab.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel-tab%2Fsegments-explorer-tab.tsx?ref=212d0e7ef91738284a8cc34135088e3eaf8edd87",
            "patch": "@@ -0,0 +1,30 @@\n+import { useSegmentTree } from '../../../segment-explorer'\n+import { PageSegmentTree } from '../../overview/segment-explorer'\n+\n+function SegmentsExplorer({\n+  routerType,\n+}: React.HTMLProps<HTMLDivElement> & {\n+  routerType: 'app' | 'pages'\n+}) {\n+  const tree = useSegmentTree()\n+  const isAppRouter = routerType === 'app'\n+  return <PageSegmentTree tree={tree} isAppRouter={isAppRouter} />\n+}\n+\n+export function SegmentsExplorerTab({\n+  routerType,\n+}: {\n+  routerType: 'app' | 'pages'\n+}) {\n+  return (\n+    <div data-nextjs-devtools-panel-segments-explorer>\n+      <SegmentsExplorer routerType={routerType} />\n+    </div>\n+  )\n+}\n+\n+export const SEGMENTS_EXPLORER_TAB_STYLES = `\n+  [data-nextjs-devtools-panel-segments-explorer] {\n+    padding: 0 8px;\n+  }\n+`"
        },
        {
            "sha": "70a06ed2a585b8a5351447880bf8edfe4f5476dd",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-panel/devtools-panel.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx?ref=212d0e7ef91738284a8cc34135088e3eaf8edd87",
            "patch": "@@ -163,6 +163,7 @@ export function DevToolsPanel({\n                   activeTab={activeTab}\n                   devToolsPosition={state.devToolsPosition}\n                   scale={state.scale}\n+                  routerType={state.routerType}\n                   handlePositionChange={handlePositionChange}\n                   handleScaleChange={handleScaleChange}\n                   debugInfo={state.debugInfo}"
        },
        {
            "sha": "f7df9f43830bb79222c5e2c91ab36cf09c7a89fa",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/overview/segment-explorer.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-explorer.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-explorer.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-explorer.tsx?ref=212d0e7ef91738284a8cc34135088e3eaf8edd87",
            "patch": "@@ -9,7 +9,7 @@ const isFileNode = (node: SegmentTrieNode) => {\n   return !!node.value?.type && !!node.value?.pagePath\n }\n \n-function PageSegmentTree({\n+export function PageSegmentTree({\n   tree,\n   isAppRouter,\n }: {"
        },
        {
            "sha": "6898fd565910c2fe38c884e9a80eee293c0281ea",
            "filename": "packages/next/src/next-devtools/dev-overlay/styles/component-styles.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fstyles%2Fcomponent-styles.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/212d0e7ef91738284a8cc34135088e3eaf8edd87/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fstyles%2Fcomponent-styles.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fstyles%2Fcomponent-styles.tsx?ref=212d0e7ef91738284a8cc34135088e3eaf8edd87",
            "patch": "@@ -35,6 +35,7 @@ import { DEVTOOLS_PANEL_TAB_ISSUES_SIDEBAR_FRAME_SKELETON_STYLES } from '../comp\n import { DEVTOOLS_PANEL_TAB_ISSUES_CONTENT_STYLES } from '../components/devtools-panel/devtools-panel-tab/issues-tab/issues-tab-content'\n import { ISSUE_FEEDBACK_BUTTON_STYLES } from '../components/errors/error-overlay-toolbar/issue-feedback-button'\n import { ERROR_CONTENT_SKELETON_STYLES } from '../container/runtime-error/error-content-skeleton'\n+import { SEGMENTS_EXPLORER_TAB_STYLES } from '../components/devtools-panel/devtools-panel-tab/segments-explorer-tab'\n \n export function ComponentStyles() {\n   return (\n@@ -76,6 +77,7 @@ export function ComponentStyles() {\n         ${DEVTOOLS_PANEL_TAB_ISSUES_CONTENT_STYLES}\n         ${ISSUE_FEEDBACK_BUTTON_STYLES}\n         ${ERROR_CONTENT_SKELETON_STYLES}\n+        ${SEGMENTS_EXPLORER_TAB_STYLES}\n       `}\n     </style>\n   )"
        }
    ],
    "stats": {
        "total": 50,
        "additions": 45,
        "deletions": 5
    }
}