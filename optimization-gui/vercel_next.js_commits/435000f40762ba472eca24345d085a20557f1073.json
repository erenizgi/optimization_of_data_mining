{
    "author": "eps1lon",
    "message": "Upgrade React from `55480b4d-20251208` to `80cb7a99-20251211` (#87078)",
    "sha": "435000f40762ba472eca24345d085a20557f1073",
    "files": [
        {
            "sha": "f45ae22a1b43133977e1ec126154c83bc9900390",
            "filename": "examples/reproduction-template/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/examples%2Freproduction-template%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/examples%2Freproduction-template%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/examples%2Freproduction-template%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7,8 +7,8 @@\n   },\n   \"dependencies\": {\n     \"next\": \"canary\",\n-    \"react\": \"19.2.1\",\n-    \"react-dom\": \"19.2.1\"\n+    \"react\": \"19.2.2\",\n+    \"react-dom\": \"19.2.2\"\n   },\n   \"devDependencies\": {\n     \"@types/node\": \"^22\","
        },
        {
            "sha": "8c4f74f05ee6c2978699987be03edbd98f2ffa8f",
            "filename": "package.json",
            "status": "modified",
            "additions": 16,
            "deletions": 16,
            "changes": 32,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/package.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/package.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/package.json?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -197,7 +197,7 @@\n     \"eslint-plugin-jsdoc\": \"48.0.4\",\n     \"eslint-plugin-mdx\": \"3.1.5\",\n     \"eslint-plugin-react\": \"7.37.0\",\n-    \"eslint-plugin-react-hooks\": \"0.0.0-experimental-55480b4d-20251208\",\n+    \"eslint-plugin-react-hooks\": \"0.0.0-experimental-80cb7a99-20251211\",\n     \"event-stream\": \"4.0.1\",\n     \"execa\": \"2.0.3\",\n     \"expect\": \"29.7.0\",\n@@ -257,16 +257,16 @@\n     \"pretty-ms\": \"7.0.0\",\n     \"random-seed\": \"0.3.0\",\n     \"react\": \"19.0.0\",\n-    \"react-builtin\": \"npm:react@19.3.0-canary-55480b4d-20251208\",\n+    \"react-builtin\": \"npm:react@19.3.0-canary-80cb7a99-20251211\",\n     \"react-dom\": \"19.0.0\",\n-    \"react-dom-builtin\": \"npm:react-dom@19.3.0-canary-55480b4d-20251208\",\n-    \"react-dom-experimental-builtin\": \"npm:react-dom@0.0.0-experimental-55480b4d-20251208\",\n-    \"react-experimental-builtin\": \"npm:react@0.0.0-experimental-55480b4d-20251208\",\n-    \"react-is-builtin\": \"npm:react-is@19.3.0-canary-55480b4d-20251208\",\n-    \"react-server-dom-turbopack\": \"19.3.0-canary-55480b4d-20251208\",\n-    \"react-server-dom-turbopack-experimental\": \"npm:react-server-dom-turbopack@0.0.0-experimental-55480b4d-20251208\",\n-    \"react-server-dom-webpack\": \"19.3.0-canary-55480b4d-20251208\",\n-    \"react-server-dom-webpack-experimental\": \"npm:react-server-dom-webpack@0.0.0-experimental-55480b4d-20251208\",\n+    \"react-dom-builtin\": \"npm:react-dom@19.3.0-canary-80cb7a99-20251211\",\n+    \"react-dom-experimental-builtin\": \"npm:react-dom@0.0.0-experimental-80cb7a99-20251211\",\n+    \"react-experimental-builtin\": \"npm:react@0.0.0-experimental-80cb7a99-20251211\",\n+    \"react-is-builtin\": \"npm:react-is@19.3.0-canary-80cb7a99-20251211\",\n+    \"react-server-dom-turbopack\": \"19.3.0-canary-80cb7a99-20251211\",\n+    \"react-server-dom-turbopack-experimental\": \"npm:react-server-dom-turbopack@0.0.0-experimental-80cb7a99-20251211\",\n+    \"react-server-dom-webpack\": \"19.3.0-canary-80cb7a99-20251211\",\n+    \"react-server-dom-webpack-experimental\": \"npm:react-server-dom-webpack@0.0.0-experimental-80cb7a99-20251211\",\n     \"react-ssr-prepass\": \"1.0.8\",\n     \"react-virtualized\": \"9.22.3\",\n     \"relay-compiler\": \"13.0.2\",\n@@ -276,8 +276,8 @@\n     \"resolve-from\": \"5.0.0\",\n     \"sass\": \"1.54.0\",\n     \"satori\": \"0.15.2\",\n-    \"scheduler-builtin\": \"npm:scheduler@0.28.0-canary-55480b4d-20251208\",\n-    \"scheduler-experimental-builtin\": \"npm:scheduler@0.0.0-experimental-55480b4d-20251208\",\n+    \"scheduler-builtin\": \"npm:scheduler@0.28.0-canary-80cb7a99-20251211\",\n+    \"scheduler-experimental-builtin\": \"npm:scheduler@0.0.0-experimental-80cb7a99-20251211\",\n     \"seedrandom\": \"3.0.5\",\n     \"semver\": \"7.3.7\",\n     \"serve-handler\": \"6.1.6\",\n@@ -322,10 +322,10 @@\n       \"@types/react-dom\": \"19.2.1\",\n       \"@types/retry\": \"0.12.0\",\n       \"jest-snapshot\": \"30.0.0-alpha.6\",\n-      \"react\": \"19.3.0-canary-55480b4d-20251208\",\n-      \"react-dom\": \"19.3.0-canary-55480b4d-20251208\",\n-      \"react-is\": \"19.3.0-canary-55480b4d-20251208\",\n-      \"scheduler\": \"0.28.0-canary-55480b4d-20251208\"\n+      \"react\": \"19.3.0-canary-80cb7a99-20251211\",\n+      \"react-dom\": \"19.3.0-canary-80cb7a99-20251211\",\n+      \"react-is\": \"19.3.0-canary-80cb7a99-20251211\",\n+      \"scheduler\": \"0.28.0-canary-80cb7a99-20251211\"\n     },\n     \"packageExtensions\": {\n       \"eslint-plugin-react-hooks@0.0.0-experimental-6de32a5a-20250822\": {"
        },
        {
            "sha": "c2b1f62270676c059a150980348138e5e0da4529",
            "filename": "packages/create-next-app/templates/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fcreate-next-app%2Ftemplates%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fcreate-next-app%2Ftemplates%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Findex.ts?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -14,7 +14,7 @@ import { Bundler, GetTemplateFileArgs, InstallTemplateArgs } from \"./types\";\n \n // Do not rename or format. sync-react script relies on this line.\n // prettier-ignore\n-const nextjsReactPeerVersion = \"19.2.1\";\n+const nextjsReactPeerVersion = \"19.2.2\";\n function sorted(obj: Record<string, string>) {\n   return Object.keys(obj)\n     .sort()"
        },
        {
            "sha": "5d2963d889aa0b588bf27e36fe63a7d606753891",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-client.development.js",
            "status": "modified",
            "additions": 31,
            "deletions": 41,
            "changes": 72,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-client.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-client.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-client.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -25640,21 +25640,6 @@\n       var computedStyle = getComputedStyle(instance);\n       return createMeasurement(measuredRect, computedStyle, instance);\n     }\n-    function cancelAllViewTransitionAnimations(scope) {\n-      for (\n-        var animations = scope.getAnimations({ subtree: !0 }), i = 0;\n-        i < animations.length;\n-        i++\n-      ) {\n-        var anim = animations[i],\n-          effect = anim.effect,\n-          pseudo = effect.pseudoElement;\n-        null != pseudo &&\n-          pseudo.startsWith(\"::view-transition\") &&\n-          effect.target === scope &&\n-          anim.cancel();\n-      }\n-    }\n     function customizeViewTransitionError(error, ignoreAbort) {\n       if (\"object\" === typeof error && null !== error)\n         switch (error.name) {\n@@ -25789,6 +25774,7 @@\n           types: transitionTypes\n         });\n         ownerDocument.__reactViewTransition = transition;\n+        var viewTransitionAnimations = [];\n         transition.ready.then(\n           function () {\n             for (\n@@ -25799,25 +25785,26 @@\n               i < animations.length;\n               i++\n             ) {\n-              var effect = animations[i].effect,\n+              var animation = animations[i],\n+                effect = animation.effect,\n                 pseudoElement = effect.pseudoElement;\n               if (\n                 null != pseudoElement &&\n                 pseudoElement.startsWith(\"::view-transition\")\n               ) {\n-                pseudoElement = effect.getKeyframes();\n+                viewTransitionAnimations.push(animation);\n+                animation = effect.getKeyframes();\n                 for (\n-                  var width = void 0,\n-                    height = void 0,\n+                  var height = (pseudoElement = void 0),\n                     unchangedDimensions = !0,\n                     j = 0;\n-                  j < pseudoElement.length;\n+                  j < animation.length;\n                   j++\n                 ) {\n-                  var keyframe = pseudoElement[j],\n+                  var keyframe = animation[j],\n                     w = keyframe.width;\n-                  if (void 0 === width) width = w;\n-                  else if (width !== w) {\n+                  if (void 0 === pseudoElement) pseudoElement = w;\n+                  else if (pseudoElement !== w) {\n                     unchangedDimensions = !1;\n                     break;\n                   }\n@@ -25832,23 +25819,22 @@\n                   \"none\" === keyframe.transform && delete keyframe.transform;\n                 }\n                 unchangedDimensions &&\n-                  void 0 !== width &&\n+                  void 0 !== pseudoElement &&\n                   void 0 !== height &&\n-                  (effect.setKeyframes(pseudoElement),\n+                  (effect.setKeyframes(animation),\n                   (unchangedDimensions = getComputedStyle(\n                     effect.target,\n                     effect.pseudoElement\n                   )),\n-                  unchangedDimensions.width !== width ||\n+                  unchangedDimensions.width !== pseudoElement ||\n                     unchangedDimensions.height !== height) &&\n-                  ((unchangedDimensions = pseudoElement[0]),\n-                  (unchangedDimensions.width = width),\n+                  ((unchangedDimensions = animation[0]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  (unchangedDimensions =\n-                    pseudoElement[pseudoElement.length - 1]),\n-                  (unchangedDimensions.width = width),\n+                  (unchangedDimensions = animation[animation.length - 1]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  effect.setKeyframes(pseudoElement));\n+                  effect.setKeyframes(animation));\n               }\n             }\n             spawnedWorkCallback();\n@@ -25868,7 +25854,8 @@\n           }\n         );\n         transition.finished.finally(function () {\n-          cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n+          for (var i = 0; i < viewTransitionAnimations.length; i++)\n+            viewTransitionAnimations[i].cancel();\n           ownerDocument.__reactViewTransition === transition &&\n             (ownerDocument.__reactViewTransition = null);\n           finishedAnimation();\n@@ -26006,6 +25993,7 @@\n         });\n         ownerDocument.__reactViewTransition = transition;\n         var customTimelineCleanup = [],\n+          viewTransitionAnimations = [],\n           readyCallback = function () {\n             for (\n               var documentElement = ownerDocument.documentElement,\n@@ -26021,7 +26009,8 @@\n                 pseudoElement = effect.pseudoElement;\n               null != pseudoElement &&\n                 pseudoElement.startsWith(\"::view-transition\") &&\n-                ((effect = effect.getTiming()),\n+                (viewTransitionAnimations.push(animations[i]),\n+                (effect = effect.getTiming()),\n                 (effect =\n                   effect.delay +\n                   (\"number\" === typeof effect.duration ? effect.duration : 0)),\n@@ -26124,8 +26113,9 @@\n           }\n         });\n         transition.finished.finally(function () {\n-          cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n-          for (var i = 0; i < customTimelineCleanup.length; i++)\n+          for (var i = 0; i < viewTransitionAnimations.length; i++)\n+            viewTransitionAnimations[i].cancel();\n+          for (i = 0; i < customTimelineCleanup.length; i++)\n             (0, customTimelineCleanup[i])();\n           ownerDocument.__reactViewTransition === transition &&\n             (ownerDocument.__reactViewTransition = null);\n@@ -32446,11 +32436,11 @@\n     };\n     (function () {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-experimental-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-experimental-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     })();\n     (\"function\" === typeof Map &&\n@@ -32487,10 +32477,10 @@\n       !(function () {\n         var internals = {\n           bundleType: 1,\n-          version: \"19.3.0-experimental-55480b4d-20251208\",\n+          version: \"19.3.0-experimental-80cb7a99-20251211\",\n           rendererPackageName: \"react-dom\",\n           currentDispatcherRef: ReactSharedInternals,\n-          reconcilerVersion: \"19.3.0-experimental-55480b4d-20251208\"\n+          reconcilerVersion: \"19.3.0-experimental-80cb7a99-20251211\"\n         };\n         internals.overrideHookState = overrideHookState;\n         internals.overrideHookStateDeletePath = overrideHookStateDeletePath;\n@@ -32638,7 +32628,7 @@\n       listenToAllSupportedEvents(container);\n       return new ReactDOMHydrationRoot(initialChildren);\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n     \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n       \"function\" ===\n         typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&"
        },
        {
            "sha": "ccbf79e8dc2cd68a33e6af9497c65231928aebec",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-client.production.js",
            "status": "modified",
            "additions": 79,
            "deletions": 88,
            "changes": 167,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-client.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-client.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-client.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -14657,20 +14657,20 @@ function debounceScrollEnd(targetInst, nativeEvent, nativeEventTarget) {\n     (nativeEventTarget[internalScrollTimer] = targetInst));\n }\n for (\n-  var i$jscomp$inline_1795 = 0;\n-  i$jscomp$inline_1795 < simpleEventPluginEvents.length;\n-  i$jscomp$inline_1795++\n+  var i$jscomp$inline_1796 = 0;\n+  i$jscomp$inline_1796 < simpleEventPluginEvents.length;\n+  i$jscomp$inline_1796++\n ) {\n-  var eventName$jscomp$inline_1796 =\n-      simpleEventPluginEvents[i$jscomp$inline_1795],\n-    domEventName$jscomp$inline_1797 =\n-      eventName$jscomp$inline_1796.toLowerCase(),\n-    capitalizedEvent$jscomp$inline_1798 =\n-      eventName$jscomp$inline_1796[0].toUpperCase() +\n-      eventName$jscomp$inline_1796.slice(1);\n+  var eventName$jscomp$inline_1797 =\n+      simpleEventPluginEvents[i$jscomp$inline_1796],\n+    domEventName$jscomp$inline_1798 =\n+      eventName$jscomp$inline_1797.toLowerCase(),\n+    capitalizedEvent$jscomp$inline_1799 =\n+      eventName$jscomp$inline_1797[0].toUpperCase() +\n+      eventName$jscomp$inline_1797.slice(1);\n   registerSimpleEvent(\n-    domEventName$jscomp$inline_1797,\n-    \"on\" + capitalizedEvent$jscomp$inline_1798\n+    domEventName$jscomp$inline_1798,\n+    \"on\" + capitalizedEvent$jscomp$inline_1799\n   );\n }\n registerSimpleEvent(ANIMATION_END, \"onAnimationEnd\");\n@@ -16847,21 +16847,6 @@ function measureClonedInstance(instance) {\n   var computedStyle = getComputedStyle(instance);\n   return createMeasurement(measuredRect, computedStyle, instance);\n }\n-function cancelAllViewTransitionAnimations(scope) {\n-  for (\n-    var animations = scope.getAnimations({ subtree: !0 }), i = 0;\n-    i < animations.length;\n-    i++\n-  ) {\n-    var anim = animations[i],\n-      effect = anim.effect,\n-      pseudo = effect.pseudoElement;\n-    null != pseudo &&\n-      pseudo.startsWith(\"::view-transition\") &&\n-      effect.target === scope &&\n-      anim.cancel();\n-  }\n-}\n function customizeViewTransitionError(error, ignoreAbort) {\n   if (\"object\" === typeof error && null !== error)\n     switch (error.name) {\n@@ -16969,6 +16954,7 @@ function startViewTransition(\n       types: transitionTypes\n     });\n     ownerDocument.__reactViewTransition = transition;\n+    var viewTransitionAnimations = [];\n     transition.ready.then(\n       function () {\n         for (\n@@ -16979,25 +16965,26 @@ function startViewTransition(\n           i < animations.length;\n           i++\n         ) {\n-          var effect = animations[i].effect,\n+          var animation = animations[i],\n+            effect = animation.effect,\n             pseudoElement = effect.pseudoElement;\n           if (\n             null != pseudoElement &&\n             pseudoElement.startsWith(\"::view-transition\")\n           ) {\n-            pseudoElement = effect.getKeyframes();\n+            viewTransitionAnimations.push(animation);\n+            animation = effect.getKeyframes();\n             for (\n-              var width = void 0,\n-                height = void 0,\n+              var height = (pseudoElement = void 0),\n                 unchangedDimensions = !0,\n                 j = 0;\n-              j < pseudoElement.length;\n+              j < animation.length;\n               j++\n             ) {\n-              var keyframe = pseudoElement[j],\n+              var keyframe = animation[j],\n                 w = keyframe.width;\n-              if (void 0 === width) width = w;\n-              else if (width !== w) {\n+              if (void 0 === pseudoElement) pseudoElement = w;\n+              else if (pseudoElement !== w) {\n                 unchangedDimensions = !1;\n                 break;\n               }\n@@ -17012,22 +16999,22 @@ function startViewTransition(\n               \"none\" === keyframe.transform && delete keyframe.transform;\n             }\n             unchangedDimensions &&\n-              void 0 !== width &&\n+              void 0 !== pseudoElement &&\n               void 0 !== height &&\n-              (effect.setKeyframes(pseudoElement),\n+              (effect.setKeyframes(animation),\n               (unchangedDimensions = getComputedStyle(\n                 effect.target,\n                 effect.pseudoElement\n               )),\n-              unchangedDimensions.width !== width ||\n+              unchangedDimensions.width !== pseudoElement ||\n                 unchangedDimensions.height !== height) &&\n-              ((unchangedDimensions = pseudoElement[0]),\n-              (unchangedDimensions.width = width),\n+              ((unchangedDimensions = animation[0]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              (unchangedDimensions = pseudoElement[pseudoElement.length - 1]),\n-              (unchangedDimensions.width = width),\n+              (unchangedDimensions = animation[animation.length - 1]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              effect.setKeyframes(pseudoElement));\n+              effect.setKeyframes(animation));\n           }\n         }\n         spawnedWorkCallback();\n@@ -17044,7 +17031,8 @@ function startViewTransition(\n       }\n     );\n     transition.finished.finally(function () {\n-      cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n+      for (var i = 0; i < viewTransitionAnimations.length; i++)\n+        viewTransitionAnimations[i].cancel();\n       ownerDocument.__reactViewTransition === transition &&\n         (ownerDocument.__reactViewTransition = null);\n       passiveCallback();\n@@ -17168,6 +17156,7 @@ function startGestureTransition(\n     });\n     ownerDocument.__reactViewTransition = transition;\n     var customTimelineCleanup = [],\n+      viewTransitionAnimations = [],\n       readyCallback = function () {\n         for (\n           var documentElement = ownerDocument.documentElement,\n@@ -17183,7 +17172,8 @@ function startGestureTransition(\n             pseudoElement = effect.pseudoElement;\n           null != pseudoElement &&\n             pseudoElement.startsWith(\"::view-transition\") &&\n-            ((effect = effect.getTiming()),\n+            (viewTransitionAnimations.push(animations[i]),\n+            (effect = effect.getTiming()),\n             (effect =\n               effect.delay +\n               (\"number\" === typeof effect.duration ? effect.duration : 0)),\n@@ -17286,8 +17276,9 @@ function startGestureTransition(\n       }\n     });\n     transition.finished.finally(function () {\n-      cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n-      for (var i = 0; i < customTimelineCleanup.length; i++)\n+      for (var i = 0; i < viewTransitionAnimations.length; i++)\n+        viewTransitionAnimations[i].cancel();\n+      for (i = 0; i < customTimelineCleanup.length; i++)\n         (0, customTimelineCleanup[i])();\n       ownerDocument.__reactViewTransition === transition &&\n         (ownerDocument.__reactViewTransition = null);\n@@ -18360,26 +18351,26 @@ function getResource(type, currentProps, pendingProps, currentResource) {\n         \"string\" === typeof pendingProps.precedence\n       ) {\n         type = getStyleKey(pendingProps.href);\n-        var styles$285 = getResourcesFromRoot(\n+        var styles$286 = getResourcesFromRoot(\n             JSCompiler_inline_result\n           ).hoistableStyles,\n-          resource$286 = styles$285.get(type);\n-        resource$286 ||\n+          resource$287 = styles$286.get(type);\n+        resource$287 ||\n           ((JSCompiler_inline_result =\n             JSCompiler_inline_result.ownerDocument || JSCompiler_inline_result),\n-          (resource$286 = {\n+          (resource$287 = {\n             type: \"stylesheet\",\n             instance: null,\n             count: 0,\n             state: { loading: 0, preload: null }\n           }),\n-          styles$285.set(type, resource$286),\n-          (styles$285 = JSCompiler_inline_result.querySelector(\n+          styles$286.set(type, resource$287),\n+          (styles$286 = JSCompiler_inline_result.querySelector(\n             getStylesheetSelectorFromKey(type)\n           )) &&\n-            !styles$285._p &&\n-            ((resource$286.instance = styles$285),\n-            (resource$286.state.loading = 5)),\n+            !styles$286._p &&\n+            ((resource$287.instance = styles$286),\n+            (resource$287.state.loading = 5)),\n           preloadPropsMap.has(type) ||\n             ((pendingProps = {\n               rel: \"preload\",\n@@ -18392,16 +18383,16 @@ function getResource(type, currentProps, pendingProps, currentResource) {\n               referrerPolicy: pendingProps.referrerPolicy\n             }),\n             preloadPropsMap.set(type, pendingProps),\n-            styles$285 ||\n+            styles$286 ||\n               preloadStylesheet(\n                 JSCompiler_inline_result,\n                 type,\n                 pendingProps,\n-                resource$286.state\n+                resource$287.state\n               )));\n         if (currentProps && null === currentResource)\n           throw Error(formatProdErrorMessage(528, \"\"));\n-        return resource$286;\n+        return resource$287;\n       }\n       if (currentProps && null !== currentResource)\n         throw Error(formatProdErrorMessage(529, \"\"));\n@@ -18498,37 +18489,37 @@ function acquireResource(hoistableRoot, resource, props) {\n         return (resource.instance = instance);\n       case \"stylesheet\":\n         styleProps = getStyleKey(props.href);\n-        var instance$291 = hoistableRoot.querySelector(\n+        var instance$292 = hoistableRoot.querySelector(\n           getStylesheetSelectorFromKey(styleProps)\n         );\n-        if (instance$291)\n+        if (instance$292)\n           return (\n             (resource.state.loading |= 4),\n-            (resource.instance = instance$291),\n-            markNodeAsHoistable(instance$291),\n-            instance$291\n+            (resource.instance = instance$292),\n+            markNodeAsHoistable(instance$292),\n+            instance$292\n           );\n         instance = stylesheetPropsFromRawProps(props);\n         (styleProps = preloadPropsMap.get(styleProps)) &&\n           adoptPreloadPropsForStylesheet(instance, styleProps);\n-        instance$291 = (\n+        instance$292 = (\n           hoistableRoot.ownerDocument || hoistableRoot\n         ).createElement(\"link\");\n-        markNodeAsHoistable(instance$291);\n-        var linkInstance = instance$291;\n+        markNodeAsHoistable(instance$292);\n+        var linkInstance = instance$292;\n         linkInstance._p = new Promise(function (resolve, reject) {\n           linkInstance.onload = resolve;\n           linkInstance.onerror = reject;\n         });\n-        setInitialProperties(instance$291, \"link\", instance);\n+        setInitialProperties(instance$292, \"link\", instance);\n         resource.state.loading |= 4;\n-        insertStylesheet(instance$291, props.precedence, hoistableRoot);\n-        return (resource.instance = instance$291);\n+        insertStylesheet(instance$292, props.precedence, hoistableRoot);\n+        return (resource.instance = instance$292);\n       case \"script\":\n-        instance$291 = getScriptKey(props.src);\n+        instance$292 = getScriptKey(props.src);\n         if (\n           (styleProps = hoistableRoot.querySelector(\n-            getScriptSelectorFromKey(instance$291)\n+            getScriptSelectorFromKey(instance$292)\n           ))\n         )\n           return (\n@@ -18537,7 +18528,7 @@ function acquireResource(hoistableRoot, resource, props) {\n             styleProps\n           );\n         instance = props;\n-        if ((styleProps = preloadPropsMap.get(instance$291)))\n+        if ((styleProps = preloadPropsMap.get(instance$292)))\n           (instance = assign({}, props)),\n             adoptPreloadPropsForScript(instance, styleProps);\n         hoistableRoot = hoistableRoot.ownerDocument || hoistableRoot;\n@@ -19664,16 +19655,16 @@ ReactDOMHydrationRoot.prototype.unstable_scheduleHydration = function (target) {\n     0 === i && attemptExplicitHydrationTarget(target);\n   }\n };\n-var isomorphicReactPackageVersion$jscomp$inline_2213 = React.version;\n+var isomorphicReactPackageVersion$jscomp$inline_2214 = React.version;\n if (\n-  \"19.3.0-experimental-55480b4d-20251208\" !==\n-  isomorphicReactPackageVersion$jscomp$inline_2213\n+  \"19.3.0-experimental-80cb7a99-20251211\" !==\n+  isomorphicReactPackageVersion$jscomp$inline_2214\n )\n   throw Error(\n     formatProdErrorMessage(\n       527,\n-      isomorphicReactPackageVersion$jscomp$inline_2213,\n-      \"19.3.0-experimental-55480b4d-20251208\"\n+      isomorphicReactPackageVersion$jscomp$inline_2214,\n+      \"19.3.0-experimental-80cb7a99-20251211\"\n     )\n   );\n ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n@@ -19693,24 +19684,24 @@ ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n     null === componentOrElement ? null : componentOrElement.stateNode;\n   return componentOrElement;\n };\n-var internals$jscomp$inline_2916 = {\n+var internals$jscomp$inline_2917 = {\n   bundleType: 0,\n-  version: \"19.3.0-experimental-55480b4d-20251208\",\n+  version: \"19.3.0-experimental-80cb7a99-20251211\",\n   rendererPackageName: \"react-dom\",\n   currentDispatcherRef: ReactSharedInternals,\n-  reconcilerVersion: \"19.3.0-experimental-55480b4d-20251208\"\n+  reconcilerVersion: \"19.3.0-experimental-80cb7a99-20251211\"\n };\n if (\"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__) {\n-  var hook$jscomp$inline_2917 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n+  var hook$jscomp$inline_2918 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n   if (\n-    !hook$jscomp$inline_2917.isDisabled &&\n-    hook$jscomp$inline_2917.supportsFiber\n+    !hook$jscomp$inline_2918.isDisabled &&\n+    hook$jscomp$inline_2918.supportsFiber\n   )\n     try {\n-      (rendererID = hook$jscomp$inline_2917.inject(\n-        internals$jscomp$inline_2916\n+      (rendererID = hook$jscomp$inline_2918.inject(\n+        internals$jscomp$inline_2917\n       )),\n-        (injectedHook = hook$jscomp$inline_2917);\n+        (injectedHook = hook$jscomp$inline_2918);\n     } catch (err) {}\n }\n exports.createRoot = function (container, options) {\n@@ -19805,4 +19796,4 @@ exports.hydrateRoot = function (container, initialChildren, options) {\n   listenToAllSupportedEvents(container);\n   return new ReactDOMHydrationRoot(initialChildren);\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "4242731067f8749e7e8ec9a972d6c9bbd858f280",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-profiling.development.js",
            "status": "modified",
            "additions": 31,
            "deletions": 41,
            "changes": 72,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-profiling.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-profiling.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-profiling.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -25648,21 +25648,6 @@\n       var computedStyle = getComputedStyle(instance);\n       return createMeasurement(measuredRect, computedStyle, instance);\n     }\n-    function cancelAllViewTransitionAnimations(scope) {\n-      for (\n-        var animations = scope.getAnimations({ subtree: !0 }), i = 0;\n-        i < animations.length;\n-        i++\n-      ) {\n-        var anim = animations[i],\n-          effect = anim.effect,\n-          pseudo = effect.pseudoElement;\n-        null != pseudo &&\n-          pseudo.startsWith(\"::view-transition\") &&\n-          effect.target === scope &&\n-          anim.cancel();\n-      }\n-    }\n     function customizeViewTransitionError(error, ignoreAbort) {\n       if (\"object\" === typeof error && null !== error)\n         switch (error.name) {\n@@ -25797,6 +25782,7 @@\n           types: transitionTypes\n         });\n         ownerDocument.__reactViewTransition = transition;\n+        var viewTransitionAnimations = [];\n         transition.ready.then(\n           function () {\n             for (\n@@ -25807,25 +25793,26 @@\n               i < animations.length;\n               i++\n             ) {\n-              var effect = animations[i].effect,\n+              var animation = animations[i],\n+                effect = animation.effect,\n                 pseudoElement = effect.pseudoElement;\n               if (\n                 null != pseudoElement &&\n                 pseudoElement.startsWith(\"::view-transition\")\n               ) {\n-                pseudoElement = effect.getKeyframes();\n+                viewTransitionAnimations.push(animation);\n+                animation = effect.getKeyframes();\n                 for (\n-                  var width = void 0,\n-                    height = void 0,\n+                  var height = (pseudoElement = void 0),\n                     unchangedDimensions = !0,\n                     j = 0;\n-                  j < pseudoElement.length;\n+                  j < animation.length;\n                   j++\n                 ) {\n-                  var keyframe = pseudoElement[j],\n+                  var keyframe = animation[j],\n                     w = keyframe.width;\n-                  if (void 0 === width) width = w;\n-                  else if (width !== w) {\n+                  if (void 0 === pseudoElement) pseudoElement = w;\n+                  else if (pseudoElement !== w) {\n                     unchangedDimensions = !1;\n                     break;\n                   }\n@@ -25840,23 +25827,22 @@\n                   \"none\" === keyframe.transform && delete keyframe.transform;\n                 }\n                 unchangedDimensions &&\n-                  void 0 !== width &&\n+                  void 0 !== pseudoElement &&\n                   void 0 !== height &&\n-                  (effect.setKeyframes(pseudoElement),\n+                  (effect.setKeyframes(animation),\n                   (unchangedDimensions = getComputedStyle(\n                     effect.target,\n                     effect.pseudoElement\n                   )),\n-                  unchangedDimensions.width !== width ||\n+                  unchangedDimensions.width !== pseudoElement ||\n                     unchangedDimensions.height !== height) &&\n-                  ((unchangedDimensions = pseudoElement[0]),\n-                  (unchangedDimensions.width = width),\n+                  ((unchangedDimensions = animation[0]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  (unchangedDimensions =\n-                    pseudoElement[pseudoElement.length - 1]),\n-                  (unchangedDimensions.width = width),\n+                  (unchangedDimensions = animation[animation.length - 1]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  effect.setKeyframes(pseudoElement));\n+                  effect.setKeyframes(animation));\n               }\n             }\n             spawnedWorkCallback();\n@@ -25876,7 +25862,8 @@\n           }\n         );\n         transition.finished.finally(function () {\n-          cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n+          for (var i = 0; i < viewTransitionAnimations.length; i++)\n+            viewTransitionAnimations[i].cancel();\n           ownerDocument.__reactViewTransition === transition &&\n             (ownerDocument.__reactViewTransition = null);\n           finishedAnimation();\n@@ -26014,6 +26001,7 @@\n         });\n         ownerDocument.__reactViewTransition = transition;\n         var customTimelineCleanup = [],\n+          viewTransitionAnimations = [],\n           readyCallback = function () {\n             for (\n               var documentElement = ownerDocument.documentElement,\n@@ -26029,7 +26017,8 @@\n                 pseudoElement = effect.pseudoElement;\n               null != pseudoElement &&\n                 pseudoElement.startsWith(\"::view-transition\") &&\n-                ((effect = effect.getTiming()),\n+                (viewTransitionAnimations.push(animations[i]),\n+                (effect = effect.getTiming()),\n                 (effect =\n                   effect.delay +\n                   (\"number\" === typeof effect.duration ? effect.duration : 0)),\n@@ -26132,8 +26121,9 @@\n           }\n         });\n         transition.finished.finally(function () {\n-          cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n-          for (var i = 0; i < customTimelineCleanup.length; i++)\n+          for (var i = 0; i < viewTransitionAnimations.length; i++)\n+            viewTransitionAnimations[i].cancel();\n+          for (i = 0; i < customTimelineCleanup.length; i++)\n             (0, customTimelineCleanup[i])();\n           ownerDocument.__reactViewTransition === transition &&\n             (ownerDocument.__reactViewTransition = null);\n@@ -32503,11 +32493,11 @@\n     };\n     (function () {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-experimental-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-experimental-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     })();\n     (\"function\" === typeof Map &&\n@@ -32544,10 +32534,10 @@\n       !(function () {\n         var internals = {\n           bundleType: 1,\n-          version: \"19.3.0-experimental-55480b4d-20251208\",\n+          version: \"19.3.0-experimental-80cb7a99-20251211\",\n           rendererPackageName: \"react-dom\",\n           currentDispatcherRef: ReactSharedInternals,\n-          reconcilerVersion: \"19.3.0-experimental-55480b4d-20251208\"\n+          reconcilerVersion: \"19.3.0-experimental-80cb7a99-20251211\"\n         };\n         internals.overrideHookState = overrideHookState;\n         internals.overrideHookStateDeletePath = overrideHookStateDeletePath;\n@@ -33025,7 +33015,7 @@\n     exports.useFormStatus = function () {\n       return resolveDispatcher().useHostTransitionStatus();\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n     \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n       \"function\" ===\n         typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&"
        },
        {
            "sha": "ce42312cc750965d1fa6aaa2315fdf91fac80e0a",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-profiling.profiling.js",
            "status": "modified",
            "additions": 79,
            "deletions": 88,
            "changes": 167,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-profiling.profiling.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-profiling.profiling.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-profiling.profiling.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -16665,20 +16665,20 @@ function debounceScrollEnd(targetInst, nativeEvent, nativeEventTarget) {\n     (nativeEventTarget[internalScrollTimer] = targetInst));\n }\n for (\n-  var i$jscomp$inline_2091 = 0;\n-  i$jscomp$inline_2091 < simpleEventPluginEvents.length;\n-  i$jscomp$inline_2091++\n+  var i$jscomp$inline_2092 = 0;\n+  i$jscomp$inline_2092 < simpleEventPluginEvents.length;\n+  i$jscomp$inline_2092++\n ) {\n-  var eventName$jscomp$inline_2092 =\n-      simpleEventPluginEvents[i$jscomp$inline_2091],\n-    domEventName$jscomp$inline_2093 =\n-      eventName$jscomp$inline_2092.toLowerCase(),\n-    capitalizedEvent$jscomp$inline_2094 =\n-      eventName$jscomp$inline_2092[0].toUpperCase() +\n-      eventName$jscomp$inline_2092.slice(1);\n+  var eventName$jscomp$inline_2093 =\n+      simpleEventPluginEvents[i$jscomp$inline_2092],\n+    domEventName$jscomp$inline_2094 =\n+      eventName$jscomp$inline_2093.toLowerCase(),\n+    capitalizedEvent$jscomp$inline_2095 =\n+      eventName$jscomp$inline_2093[0].toUpperCase() +\n+      eventName$jscomp$inline_2093.slice(1);\n   registerSimpleEvent(\n-    domEventName$jscomp$inline_2093,\n-    \"on\" + capitalizedEvent$jscomp$inline_2094\n+    domEventName$jscomp$inline_2094,\n+    \"on\" + capitalizedEvent$jscomp$inline_2095\n   );\n }\n registerSimpleEvent(ANIMATION_END, \"onAnimationEnd\");\n@@ -18864,21 +18864,6 @@ function measureClonedInstance(instance) {\n   var computedStyle = getComputedStyle(instance);\n   return createMeasurement(measuredRect, computedStyle, instance);\n }\n-function cancelAllViewTransitionAnimations(scope) {\n-  for (\n-    var animations = scope.getAnimations({ subtree: !0 }), i = 0;\n-    i < animations.length;\n-    i++\n-  ) {\n-    var anim = animations[i],\n-      effect = anim.effect,\n-      pseudo = effect.pseudoElement;\n-    null != pseudo &&\n-      pseudo.startsWith(\"::view-transition\") &&\n-      effect.target === scope &&\n-      anim.cancel();\n-  }\n-}\n function customizeViewTransitionError(error, ignoreAbort) {\n   if (\"object\" === typeof error && null !== error)\n     switch (error.name) {\n@@ -18995,6 +18980,7 @@ function startViewTransition(\n       types: transitionTypes\n     });\n     ownerDocument.__reactViewTransition = transition;\n+    var viewTransitionAnimations = [];\n     transition.ready.then(\n       function () {\n         for (\n@@ -19005,25 +18991,26 @@ function startViewTransition(\n           i < animations.length;\n           i++\n         ) {\n-          var effect = animations[i].effect,\n+          var animation = animations[i],\n+            effect = animation.effect,\n             pseudoElement = effect.pseudoElement;\n           if (\n             null != pseudoElement &&\n             pseudoElement.startsWith(\"::view-transition\")\n           ) {\n-            pseudoElement = effect.getKeyframes();\n+            viewTransitionAnimations.push(animation);\n+            animation = effect.getKeyframes();\n             for (\n-              var width = void 0,\n-                height = void 0,\n+              var height = (pseudoElement = void 0),\n                 unchangedDimensions = !0,\n                 j = 0;\n-              j < pseudoElement.length;\n+              j < animation.length;\n               j++\n             ) {\n-              var keyframe = pseudoElement[j],\n+              var keyframe = animation[j],\n                 w = keyframe.width;\n-              if (void 0 === width) width = w;\n-              else if (width !== w) {\n+              if (void 0 === pseudoElement) pseudoElement = w;\n+              else if (pseudoElement !== w) {\n                 unchangedDimensions = !1;\n                 break;\n               }\n@@ -19038,22 +19025,22 @@ function startViewTransition(\n               \"none\" === keyframe.transform && delete keyframe.transform;\n             }\n             unchangedDimensions &&\n-              void 0 !== width &&\n+              void 0 !== pseudoElement &&\n               void 0 !== height &&\n-              (effect.setKeyframes(pseudoElement),\n+              (effect.setKeyframes(animation),\n               (unchangedDimensions = getComputedStyle(\n                 effect.target,\n                 effect.pseudoElement\n               )),\n-              unchangedDimensions.width !== width ||\n+              unchangedDimensions.width !== pseudoElement ||\n                 unchangedDimensions.height !== height) &&\n-              ((unchangedDimensions = pseudoElement[0]),\n-              (unchangedDimensions.width = width),\n+              ((unchangedDimensions = animation[0]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              (unchangedDimensions = pseudoElement[pseudoElement.length - 1]),\n-              (unchangedDimensions.width = width),\n+              (unchangedDimensions = animation[animation.length - 1]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              effect.setKeyframes(pseudoElement));\n+              effect.setKeyframes(animation));\n           }\n         }\n         spawnedWorkCallback();\n@@ -19073,7 +19060,8 @@ function startViewTransition(\n       }\n     );\n     transition.finished.finally(function () {\n-      cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n+      for (var i = 0; i < viewTransitionAnimations.length; i++)\n+        viewTransitionAnimations[i].cancel();\n       ownerDocument.__reactViewTransition === transition &&\n         (ownerDocument.__reactViewTransition = null);\n       finishedAnimation();\n@@ -19205,6 +19193,7 @@ function startGestureTransition(\n     });\n     ownerDocument.__reactViewTransition = transition;\n     var customTimelineCleanup = [],\n+      viewTransitionAnimations = [],\n       readyCallback = function () {\n         for (\n           var documentElement = ownerDocument.documentElement,\n@@ -19220,7 +19209,8 @@ function startGestureTransition(\n             pseudoElement = effect.pseudoElement;\n           null != pseudoElement &&\n             pseudoElement.startsWith(\"::view-transition\") &&\n-            ((effect = effect.getTiming()),\n+            (viewTransitionAnimations.push(animations[i]),\n+            (effect = effect.getTiming()),\n             (effect =\n               effect.delay +\n               (\"number\" === typeof effect.duration ? effect.duration : 0)),\n@@ -19323,8 +19313,9 @@ function startGestureTransition(\n       }\n     });\n     transition.finished.finally(function () {\n-      cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n-      for (var i = 0; i < customTimelineCleanup.length; i++)\n+      for (var i = 0; i < viewTransitionAnimations.length; i++)\n+        viewTransitionAnimations[i].cancel();\n+      for (i = 0; i < customTimelineCleanup.length; i++)\n         (0, customTimelineCleanup[i])();\n       ownerDocument.__reactViewTransition === transition &&\n         (ownerDocument.__reactViewTransition = null);\n@@ -20398,26 +20389,26 @@ function getResource(type, currentProps, pendingProps, currentResource) {\n         \"string\" === typeof pendingProps.precedence\n       ) {\n         type = getStyleKey(pendingProps.href);\n-        var styles$328 = getResourcesFromRoot(\n+        var styles$329 = getResourcesFromRoot(\n             JSCompiler_inline_result\n           ).hoistableStyles,\n-          resource$329 = styles$328.get(type);\n-        resource$329 ||\n+          resource$330 = styles$329.get(type);\n+        resource$330 ||\n           ((JSCompiler_inline_result =\n             JSCompiler_inline_result.ownerDocument || JSCompiler_inline_result),\n-          (resource$329 = {\n+          (resource$330 = {\n             type: \"stylesheet\",\n             instance: null,\n             count: 0,\n             state: { loading: 0, preload: null }\n           }),\n-          styles$328.set(type, resource$329),\n-          (styles$328 = JSCompiler_inline_result.querySelector(\n+          styles$329.set(type, resource$330),\n+          (styles$329 = JSCompiler_inline_result.querySelector(\n             getStylesheetSelectorFromKey(type)\n           )) &&\n-            !styles$328._p &&\n-            ((resource$329.instance = styles$328),\n-            (resource$329.state.loading = 5)),\n+            !styles$329._p &&\n+            ((resource$330.instance = styles$329),\n+            (resource$330.state.loading = 5)),\n           preloadPropsMap.has(type) ||\n             ((pendingProps = {\n               rel: \"preload\",\n@@ -20430,16 +20421,16 @@ function getResource(type, currentProps, pendingProps, currentResource) {\n               referrerPolicy: pendingProps.referrerPolicy\n             }),\n             preloadPropsMap.set(type, pendingProps),\n-            styles$328 ||\n+            styles$329 ||\n               preloadStylesheet(\n                 JSCompiler_inline_result,\n                 type,\n                 pendingProps,\n-                resource$329.state\n+                resource$330.state\n               )));\n         if (currentProps && null === currentResource)\n           throw Error(formatProdErrorMessage(528, \"\"));\n-        return resource$329;\n+        return resource$330;\n       }\n       if (currentProps && null !== currentResource)\n         throw Error(formatProdErrorMessage(529, \"\"));\n@@ -20536,37 +20527,37 @@ function acquireResource(hoistableRoot, resource, props) {\n         return (resource.instance = instance);\n       case \"stylesheet\":\n         styleProps = getStyleKey(props.href);\n-        var instance$334 = hoistableRoot.querySelector(\n+        var instance$335 = hoistableRoot.querySelector(\n           getStylesheetSelectorFromKey(styleProps)\n         );\n-        if (instance$334)\n+        if (instance$335)\n           return (\n             (resource.state.loading |= 4),\n-            (resource.instance = instance$334),\n-            markNodeAsHoistable(instance$334),\n-            instance$334\n+            (resource.instance = instance$335),\n+            markNodeAsHoistable(instance$335),\n+            instance$335\n           );\n         instance = stylesheetPropsFromRawProps(props);\n         (styleProps = preloadPropsMap.get(styleProps)) &&\n           adoptPreloadPropsForStylesheet(instance, styleProps);\n-        instance$334 = (\n+        instance$335 = (\n           hoistableRoot.ownerDocument || hoistableRoot\n         ).createElement(\"link\");\n-        markNodeAsHoistable(instance$334);\n-        var linkInstance = instance$334;\n+        markNodeAsHoistable(instance$335);\n+        var linkInstance = instance$335;\n         linkInstance._p = new Promise(function (resolve, reject) {\n           linkInstance.onload = resolve;\n           linkInstance.onerror = reject;\n         });\n-        setInitialProperties(instance$334, \"link\", instance);\n+        setInitialProperties(instance$335, \"link\", instance);\n         resource.state.loading |= 4;\n-        insertStylesheet(instance$334, props.precedence, hoistableRoot);\n-        return (resource.instance = instance$334);\n+        insertStylesheet(instance$335, props.precedence, hoistableRoot);\n+        return (resource.instance = instance$335);\n       case \"script\":\n-        instance$334 = getScriptKey(props.src);\n+        instance$335 = getScriptKey(props.src);\n         if (\n           (styleProps = hoistableRoot.querySelector(\n-            getScriptSelectorFromKey(instance$334)\n+            getScriptSelectorFromKey(instance$335)\n           ))\n         )\n           return (\n@@ -20575,7 +20566,7 @@ function acquireResource(hoistableRoot, resource, props) {\n             styleProps\n           );\n         instance = props;\n-        if ((styleProps = preloadPropsMap.get(instance$334)))\n+        if ((styleProps = preloadPropsMap.get(instance$335)))\n           (instance = assign({}, props)),\n             adoptPreloadPropsForScript(instance, styleProps);\n         hoistableRoot = hoistableRoot.ownerDocument || hoistableRoot;\n@@ -21724,16 +21715,16 @@ ReactDOMHydrationRoot.prototype.unstable_scheduleHydration = function (target) {\n     0 === i && attemptExplicitHydrationTarget(target);\n   }\n };\n-var isomorphicReactPackageVersion$jscomp$inline_2509 = React.version;\n+var isomorphicReactPackageVersion$jscomp$inline_2510 = React.version;\n if (\n-  \"19.3.0-experimental-55480b4d-20251208\" !==\n-  isomorphicReactPackageVersion$jscomp$inline_2509\n+  \"19.3.0-experimental-80cb7a99-20251211\" !==\n+  isomorphicReactPackageVersion$jscomp$inline_2510\n )\n   throw Error(\n     formatProdErrorMessage(\n       527,\n-      isomorphicReactPackageVersion$jscomp$inline_2509,\n-      \"19.3.0-experimental-55480b4d-20251208\"\n+      isomorphicReactPackageVersion$jscomp$inline_2510,\n+      \"19.3.0-experimental-80cb7a99-20251211\"\n     )\n   );\n ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n@@ -21753,24 +21744,24 @@ ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n     null === componentOrElement ? null : componentOrElement.stateNode;\n   return componentOrElement;\n };\n-var internals$jscomp$inline_3225 = {\n+var internals$jscomp$inline_3226 = {\n   bundleType: 0,\n-  version: \"19.3.0-experimental-55480b4d-20251208\",\n+  version: \"19.3.0-experimental-80cb7a99-20251211\",\n   rendererPackageName: \"react-dom\",\n   currentDispatcherRef: ReactSharedInternals,\n-  reconcilerVersion: \"19.3.0-experimental-55480b4d-20251208\"\n+  reconcilerVersion: \"19.3.0-experimental-80cb7a99-20251211\"\n };\n if (\"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__) {\n-  var hook$jscomp$inline_3226 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n+  var hook$jscomp$inline_3227 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n   if (\n-    !hook$jscomp$inline_3226.isDisabled &&\n-    hook$jscomp$inline_3226.supportsFiber\n+    !hook$jscomp$inline_3227.isDisabled &&\n+    hook$jscomp$inline_3227.supportsFiber\n   )\n     try {\n-      (rendererID = hook$jscomp$inline_3226.inject(\n-        internals$jscomp$inline_3225\n+      (rendererID = hook$jscomp$inline_3227.inject(\n+        internals$jscomp$inline_3226\n       )),\n-        (injectedHook = hook$jscomp$inline_3226);\n+        (injectedHook = hook$jscomp$inline_3227);\n     } catch (err) {}\n }\n function getCrossOriginStringAs(as, input) {\n@@ -22026,7 +22017,7 @@ exports.useFormState = function (action, initialState, permalink) {\n exports.useFormStatus = function () {\n   return ReactSharedInternals.H.useHostTransitionStatus();\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n   \"function\" ===\n     typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&"
        },
        {
            "sha": "b92128c56ae1621941d5e6dbda1c93d4adfc0eac",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server-legacy.browser.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -10411,5 +10411,5 @@\n         'The server used \"renderToString\" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to \"renderToReadableStream\" which supports Suspense on the server'\n       );\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "b037b4cc8f74b023d2da82257832c5bafd815bf7",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server-legacy.browser.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7035,4 +7035,4 @@ exports.renderToString = function (children, options) {\n     'The server used \"renderToString\" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to \"renderToReadableStream\" which supports Suspense on the server'\n   );\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "54a5f40826557c3d40c06936d26b1edc8c4461dd",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server-legacy.node.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -10411,5 +10411,5 @@\n         'The server used \"renderToString\" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to \"renderToPipeableStream\" which supports Suspense on the server'\n       );\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "40890f50b34fb2fb2d8c18d180ac0b69e7da7d6d",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server-legacy.node.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server-legacy.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7138,4 +7138,4 @@ exports.renderToString = function (children, options) {\n     'The server used \"renderToString\" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to \"renderToPipeableStream\" which supports Suspense on the server'\n   );\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "4d10ccc3ee360c40baf128ca3f5faf54b07bf0c9",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server.browser.development.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -9390,11 +9390,11 @@\n     }\n     function ensureCorrectIsomorphicReactVersion() {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-experimental-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-experimental-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     }\n     var React = require(\"next/dist/compiled/react-experimental\"),\n@@ -11214,5 +11214,5 @@\n         startWork(request);\n       });\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "834c35ca9f02ca12ae29a5d0fcf4778e78a30b9c",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server.browser.production.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7688,12 +7688,12 @@ function getPostponedState(request) {\n }\n function ensureCorrectIsomorphicReactVersion() {\n   var isomorphicReactPackageVersion = React.version;\n-  if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+  if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n     throw Error(\n       formatProdErrorMessage(\n         527,\n         isomorphicReactPackageVersion,\n-        \"19.3.0-experimental-55480b4d-20251208\"\n+        \"19.3.0-experimental-80cb7a99-20251211\"\n       )\n     );\n }\n@@ -7944,4 +7944,4 @@ exports.resumeAndPrerender = function (children, postponedState, options) {\n     startWork(request);\n   });\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "1b28a6a8b62007bb6f0d5aa52e1043c29ad0e7ff",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server.bun.production.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.bun.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.bun.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.bun.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7383,11 +7383,11 @@ function getPostponedState(request) {\n }\n function ensureCorrectIsomorphicReactVersion() {\n   var isomorphicReactPackageVersion = React.version;\n-  if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+  if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n     throw Error(\n       'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n         (isomorphicReactPackageVersion +\n-          \"\\n  - react-dom:  19.3.0-experimental-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+          \"\\n  - react-dom:  19.3.0-experimental-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n     );\n }\n ensureCorrectIsomorphicReactVersion();\n@@ -7932,4 +7932,4 @@ exports.resumeToPipeableStream = function (children, postponedState, options) {\n     }\n   };\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "e092db37b8a3efd26364fada64b829bed4dcc9a9",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server.edge.development.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -9419,11 +9419,11 @@\n     }\n     function ensureCorrectIsomorphicReactVersion() {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-experimental-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-experimental-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     }\n     var React = require(\"next/dist/compiled/react-experimental\"),\n@@ -11239,5 +11239,5 @@\n         startWork(request);\n       });\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "cdba4dde2bc8e8985e51719ad6ecdb19e38a8a5e",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server.edge.production.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7806,11 +7806,11 @@ function getPostponedState(request) {\n }\n function ensureCorrectIsomorphicReactVersion() {\n   var isomorphicReactPackageVersion = React.version;\n-  if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+  if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n     throw Error(\n       'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n         (isomorphicReactPackageVersion +\n-          \"\\n  - react-dom:  19.3.0-experimental-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+          \"\\n  - react-dom:  19.3.0-experimental-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n     );\n }\n ensureCorrectIsomorphicReactVersion();\n@@ -8060,4 +8060,4 @@ exports.resumeAndPrerender = function (children, postponedState, options) {\n     startWork(request);\n   });\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "5462639bb052b8af47bffe7af67e3f7f9c270c2b",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server.node.development.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -9279,11 +9279,11 @@\n     }\n     function ensureCorrectIsomorphicReactVersion() {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-experimental-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-experimental-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     }\n     function createDrainHandler(destination, request) {\n@@ -11405,5 +11405,5 @@\n         }\n       };\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "48d7740238da481f524a1154178ac77a9f28e0ab",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-server.node.production.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-server.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7685,11 +7685,11 @@ function getPostponedState(request) {\n }\n function ensureCorrectIsomorphicReactVersion() {\n   var isomorphicReactPackageVersion = React.version;\n-  if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+  if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n     throw Error(\n       'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n         (isomorphicReactPackageVersion +\n-          \"\\n  - react-dom:  19.3.0-experimental-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+          \"\\n  - react-dom:  19.3.0-experimental-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n     );\n }\n ensureCorrectIsomorphicReactVersion();\n@@ -8239,4 +8239,4 @@ exports.resumeToPipeableStream = function (children, postponedState, options) {\n     }\n   };\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "ca4e53593250f1977b8954206fde5de5e7e05d21",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-unstable_testing.development.js",
            "status": "modified",
            "additions": 31,
            "deletions": 41,
            "changes": 72,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-unstable_testing.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-unstable_testing.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-unstable_testing.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -25863,21 +25863,6 @@\n       var computedStyle = getComputedStyle(instance);\n       return createMeasurement(measuredRect, computedStyle, instance);\n     }\n-    function cancelAllViewTransitionAnimations(scope) {\n-      for (\n-        var animations = scope.getAnimations({ subtree: !0 }), i = 0;\n-        i < animations.length;\n-        i++\n-      ) {\n-        var anim = animations[i],\n-          effect = anim.effect,\n-          pseudo = effect.pseudoElement;\n-        null != pseudo &&\n-          pseudo.startsWith(\"::view-transition\") &&\n-          effect.target === scope &&\n-          anim.cancel();\n-      }\n-    }\n     function customizeViewTransitionError(error, ignoreAbort) {\n       if (\"object\" === typeof error && null !== error)\n         switch (error.name) {\n@@ -26012,6 +25997,7 @@\n           types: transitionTypes\n         });\n         ownerDocument.__reactViewTransition = transition;\n+        var viewTransitionAnimations = [];\n         transition.ready.then(\n           function () {\n             for (\n@@ -26022,25 +26008,26 @@\n               i < animations.length;\n               i++\n             ) {\n-              var effect = animations[i].effect,\n+              var animation = animations[i],\n+                effect = animation.effect,\n                 pseudoElement = effect.pseudoElement;\n               if (\n                 null != pseudoElement &&\n                 pseudoElement.startsWith(\"::view-transition\")\n               ) {\n-                pseudoElement = effect.getKeyframes();\n+                viewTransitionAnimations.push(animation);\n+                animation = effect.getKeyframes();\n                 for (\n-                  var width = void 0,\n-                    height = void 0,\n+                  var height = (pseudoElement = void 0),\n                     unchangedDimensions = !0,\n                     j = 0;\n-                  j < pseudoElement.length;\n+                  j < animation.length;\n                   j++\n                 ) {\n-                  var keyframe = pseudoElement[j],\n+                  var keyframe = animation[j],\n                     w = keyframe.width;\n-                  if (void 0 === width) width = w;\n-                  else if (width !== w) {\n+                  if (void 0 === pseudoElement) pseudoElement = w;\n+                  else if (pseudoElement !== w) {\n                     unchangedDimensions = !1;\n                     break;\n                   }\n@@ -26055,23 +26042,22 @@\n                   \"none\" === keyframe.transform && delete keyframe.transform;\n                 }\n                 unchangedDimensions &&\n-                  void 0 !== width &&\n+                  void 0 !== pseudoElement &&\n                   void 0 !== height &&\n-                  (effect.setKeyframes(pseudoElement),\n+                  (effect.setKeyframes(animation),\n                   (unchangedDimensions = getComputedStyle(\n                     effect.target,\n                     effect.pseudoElement\n                   )),\n-                  unchangedDimensions.width !== width ||\n+                  unchangedDimensions.width !== pseudoElement ||\n                     unchangedDimensions.height !== height) &&\n-                  ((unchangedDimensions = pseudoElement[0]),\n-                  (unchangedDimensions.width = width),\n+                  ((unchangedDimensions = animation[0]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  (unchangedDimensions =\n-                    pseudoElement[pseudoElement.length - 1]),\n-                  (unchangedDimensions.width = width),\n+                  (unchangedDimensions = animation[animation.length - 1]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  effect.setKeyframes(pseudoElement));\n+                  effect.setKeyframes(animation));\n               }\n             }\n             spawnedWorkCallback();\n@@ -26091,7 +26077,8 @@\n           }\n         );\n         transition.finished.finally(function () {\n-          cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n+          for (var i = 0; i < viewTransitionAnimations.length; i++)\n+            viewTransitionAnimations[i].cancel();\n           ownerDocument.__reactViewTransition === transition &&\n             (ownerDocument.__reactViewTransition = null);\n           finishedAnimation();\n@@ -26229,6 +26216,7 @@\n         });\n         ownerDocument.__reactViewTransition = transition;\n         var customTimelineCleanup = [],\n+          viewTransitionAnimations = [],\n           readyCallback = function () {\n             for (\n               var documentElement = ownerDocument.documentElement,\n@@ -26244,7 +26232,8 @@\n                 pseudoElement = effect.pseudoElement;\n               null != pseudoElement &&\n                 pseudoElement.startsWith(\"::view-transition\") &&\n-                ((effect = effect.getTiming()),\n+                (viewTransitionAnimations.push(animations[i]),\n+                (effect = effect.getTiming()),\n                 (effect =\n                   effect.delay +\n                   (\"number\" === typeof effect.duration ? effect.duration : 0)),\n@@ -26347,8 +26336,9 @@\n           }\n         });\n         transition.finished.finally(function () {\n-          cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n-          for (var i = 0; i < customTimelineCleanup.length; i++)\n+          for (var i = 0; i < viewTransitionAnimations.length; i++)\n+            viewTransitionAnimations[i].cancel();\n+          for (i = 0; i < customTimelineCleanup.length; i++)\n             (0, customTimelineCleanup[i])();\n           ownerDocument.__reactViewTransition === transition &&\n             (ownerDocument.__reactViewTransition = null);\n@@ -32767,11 +32757,11 @@\n     };\n     (function () {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-experimental-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-experimental-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-experimental-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-experimental-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     })();\n     (\"function\" === typeof Map &&\n@@ -32808,10 +32798,10 @@\n       !(function () {\n         var internals = {\n           bundleType: 1,\n-          version: \"19.3.0-experimental-55480b4d-20251208\",\n+          version: \"19.3.0-experimental-80cb7a99-20251211\",\n           rendererPackageName: \"react-dom\",\n           currentDispatcherRef: ReactSharedInternals,\n-          reconcilerVersion: \"19.3.0-experimental-55480b4d-20251208\"\n+          reconcilerVersion: \"19.3.0-experimental-80cb7a99-20251211\"\n         };\n         internals.overrideHookState = overrideHookState;\n         internals.overrideHookStateDeletePath = overrideHookStateDeletePath;\n@@ -33125,5 +33115,5 @@\n         }\n       };\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "867305375b743149936b2e980a2f46b4acc32555",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom-unstable_testing.production.js",
            "status": "modified",
            "additions": 79,
            "deletions": 88,
            "changes": 167,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-unstable_testing.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-unstable_testing.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom-unstable_testing.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -14929,20 +14929,20 @@ function debounceScrollEnd(targetInst, nativeEvent, nativeEventTarget) {\n     (nativeEventTarget[internalScrollTimer] = targetInst));\n }\n for (\n-  var i$jscomp$inline_1824 = 0;\n-  i$jscomp$inline_1824 < simpleEventPluginEvents.length;\n-  i$jscomp$inline_1824++\n+  var i$jscomp$inline_1825 = 0;\n+  i$jscomp$inline_1825 < simpleEventPluginEvents.length;\n+  i$jscomp$inline_1825++\n ) {\n-  var eventName$jscomp$inline_1825 =\n-      simpleEventPluginEvents[i$jscomp$inline_1824],\n-    domEventName$jscomp$inline_1826 =\n-      eventName$jscomp$inline_1825.toLowerCase(),\n-    capitalizedEvent$jscomp$inline_1827 =\n-      eventName$jscomp$inline_1825[0].toUpperCase() +\n-      eventName$jscomp$inline_1825.slice(1);\n+  var eventName$jscomp$inline_1826 =\n+      simpleEventPluginEvents[i$jscomp$inline_1825],\n+    domEventName$jscomp$inline_1827 =\n+      eventName$jscomp$inline_1826.toLowerCase(),\n+    capitalizedEvent$jscomp$inline_1828 =\n+      eventName$jscomp$inline_1826[0].toUpperCase() +\n+      eventName$jscomp$inline_1826.slice(1);\n   registerSimpleEvent(\n-    domEventName$jscomp$inline_1826,\n-    \"on\" + capitalizedEvent$jscomp$inline_1827\n+    domEventName$jscomp$inline_1827,\n+    \"on\" + capitalizedEvent$jscomp$inline_1828\n   );\n }\n registerSimpleEvent(ANIMATION_END, \"onAnimationEnd\");\n@@ -17119,21 +17119,6 @@ function measureClonedInstance(instance) {\n   var computedStyle = getComputedStyle(instance);\n   return createMeasurement(measuredRect, computedStyle, instance);\n }\n-function cancelAllViewTransitionAnimations(scope) {\n-  for (\n-    var animations = scope.getAnimations({ subtree: !0 }), i = 0;\n-    i < animations.length;\n-    i++\n-  ) {\n-    var anim = animations[i],\n-      effect = anim.effect,\n-      pseudo = effect.pseudoElement;\n-    null != pseudo &&\n-      pseudo.startsWith(\"::view-transition\") &&\n-      effect.target === scope &&\n-      anim.cancel();\n-  }\n-}\n function customizeViewTransitionError(error, ignoreAbort) {\n   if (\"object\" === typeof error && null !== error)\n     switch (error.name) {\n@@ -17241,6 +17226,7 @@ function startViewTransition(\n       types: transitionTypes\n     });\n     ownerDocument.__reactViewTransition = transition;\n+    var viewTransitionAnimations = [];\n     transition.ready.then(\n       function () {\n         for (\n@@ -17251,25 +17237,26 @@ function startViewTransition(\n           i < animations.length;\n           i++\n         ) {\n-          var effect = animations[i].effect,\n+          var animation = animations[i],\n+            effect = animation.effect,\n             pseudoElement = effect.pseudoElement;\n           if (\n             null != pseudoElement &&\n             pseudoElement.startsWith(\"::view-transition\")\n           ) {\n-            pseudoElement = effect.getKeyframes();\n+            viewTransitionAnimations.push(animation);\n+            animation = effect.getKeyframes();\n             for (\n-              var width = void 0,\n-                height = void 0,\n+              var height = (pseudoElement = void 0),\n                 unchangedDimensions = !0,\n                 j = 0;\n-              j < pseudoElement.length;\n+              j < animation.length;\n               j++\n             ) {\n-              var keyframe = pseudoElement[j],\n+              var keyframe = animation[j],\n                 w = keyframe.width;\n-              if (void 0 === width) width = w;\n-              else if (width !== w) {\n+              if (void 0 === pseudoElement) pseudoElement = w;\n+              else if (pseudoElement !== w) {\n                 unchangedDimensions = !1;\n                 break;\n               }\n@@ -17284,22 +17271,22 @@ function startViewTransition(\n               \"none\" === keyframe.transform && delete keyframe.transform;\n             }\n             unchangedDimensions &&\n-              void 0 !== width &&\n+              void 0 !== pseudoElement &&\n               void 0 !== height &&\n-              (effect.setKeyframes(pseudoElement),\n+              (effect.setKeyframes(animation),\n               (unchangedDimensions = getComputedStyle(\n                 effect.target,\n                 effect.pseudoElement\n               )),\n-              unchangedDimensions.width !== width ||\n+              unchangedDimensions.width !== pseudoElement ||\n                 unchangedDimensions.height !== height) &&\n-              ((unchangedDimensions = pseudoElement[0]),\n-              (unchangedDimensions.width = width),\n+              ((unchangedDimensions = animation[0]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              (unchangedDimensions = pseudoElement[pseudoElement.length - 1]),\n-              (unchangedDimensions.width = width),\n+              (unchangedDimensions = animation[animation.length - 1]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              effect.setKeyframes(pseudoElement));\n+              effect.setKeyframes(animation));\n           }\n         }\n         spawnedWorkCallback();\n@@ -17316,7 +17303,8 @@ function startViewTransition(\n       }\n     );\n     transition.finished.finally(function () {\n-      cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n+      for (var i = 0; i < viewTransitionAnimations.length; i++)\n+        viewTransitionAnimations[i].cancel();\n       ownerDocument.__reactViewTransition === transition &&\n         (ownerDocument.__reactViewTransition = null);\n       passiveCallback();\n@@ -17440,6 +17428,7 @@ function startGestureTransition(\n     });\n     ownerDocument.__reactViewTransition = transition;\n     var customTimelineCleanup = [],\n+      viewTransitionAnimations = [],\n       readyCallback = function () {\n         for (\n           var documentElement = ownerDocument.documentElement,\n@@ -17455,7 +17444,8 @@ function startGestureTransition(\n             pseudoElement = effect.pseudoElement;\n           null != pseudoElement &&\n             pseudoElement.startsWith(\"::view-transition\") &&\n-            ((effect = effect.getTiming()),\n+            (viewTransitionAnimations.push(animations[i]),\n+            (effect = effect.getTiming()),\n             (effect =\n               effect.delay +\n               (\"number\" === typeof effect.duration ? effect.duration : 0)),\n@@ -17558,8 +17548,9 @@ function startGestureTransition(\n       }\n     });\n     transition.finished.finally(function () {\n-      cancelAllViewTransitionAnimations(ownerDocument.documentElement);\n-      for (var i = 0; i < customTimelineCleanup.length; i++)\n+      for (var i = 0; i < viewTransitionAnimations.length; i++)\n+        viewTransitionAnimations[i].cancel();\n+      for (i = 0; i < customTimelineCleanup.length; i++)\n         (0, customTimelineCleanup[i])();\n       ownerDocument.__reactViewTransition === transition &&\n         (ownerDocument.__reactViewTransition = null);\n@@ -18676,26 +18667,26 @@ function getResource(type, currentProps, pendingProps, currentResource) {\n         \"string\" === typeof pendingProps.precedence\n       ) {\n         type = getStyleKey(pendingProps.href);\n-        var styles$286 = getResourcesFromRoot(\n+        var styles$287 = getResourcesFromRoot(\n             JSCompiler_inline_result\n           ).hoistableStyles,\n-          resource$287 = styles$286.get(type);\n-        resource$287 ||\n+          resource$288 = styles$287.get(type);\n+        resource$288 ||\n           ((JSCompiler_inline_result =\n             JSCompiler_inline_result.ownerDocument || JSCompiler_inline_result),\n-          (resource$287 = {\n+          (resource$288 = {\n             type: \"stylesheet\",\n             instance: null,\n             count: 0,\n             state: { loading: 0, preload: null }\n           }),\n-          styles$286.set(type, resource$287),\n-          (styles$286 = JSCompiler_inline_result.querySelector(\n+          styles$287.set(type, resource$288),\n+          (styles$287 = JSCompiler_inline_result.querySelector(\n             getStylesheetSelectorFromKey(type)\n           )) &&\n-            !styles$286._p &&\n-            ((resource$287.instance = styles$286),\n-            (resource$287.state.loading = 5)),\n+            !styles$287._p &&\n+            ((resource$288.instance = styles$287),\n+            (resource$288.state.loading = 5)),\n           preloadPropsMap.has(type) ||\n             ((pendingProps = {\n               rel: \"preload\",\n@@ -18708,16 +18699,16 @@ function getResource(type, currentProps, pendingProps, currentResource) {\n               referrerPolicy: pendingProps.referrerPolicy\n             }),\n             preloadPropsMap.set(type, pendingProps),\n-            styles$286 ||\n+            styles$287 ||\n               preloadStylesheet(\n                 JSCompiler_inline_result,\n                 type,\n                 pendingProps,\n-                resource$287.state\n+                resource$288.state\n               )));\n         if (currentProps && null === currentResource)\n           throw Error(formatProdErrorMessage(528, \"\"));\n-        return resource$287;\n+        return resource$288;\n       }\n       if (currentProps && null !== currentResource)\n         throw Error(formatProdErrorMessage(529, \"\"));\n@@ -18814,37 +18805,37 @@ function acquireResource(hoistableRoot, resource, props) {\n         return (resource.instance = instance);\n       case \"stylesheet\":\n         styleProps = getStyleKey(props.href);\n-        var instance$292 = hoistableRoot.querySelector(\n+        var instance$293 = hoistableRoot.querySelector(\n           getStylesheetSelectorFromKey(styleProps)\n         );\n-        if (instance$292)\n+        if (instance$293)\n           return (\n             (resource.state.loading |= 4),\n-            (resource.instance = instance$292),\n-            markNodeAsHoistable(instance$292),\n-            instance$292\n+            (resource.instance = instance$293),\n+            markNodeAsHoistable(instance$293),\n+            instance$293\n           );\n         instance = stylesheetPropsFromRawProps(props);\n         (styleProps = preloadPropsMap.get(styleProps)) &&\n           adoptPreloadPropsForStylesheet(instance, styleProps);\n-        instance$292 = (\n+        instance$293 = (\n           hoistableRoot.ownerDocument || hoistableRoot\n         ).createElement(\"link\");\n-        markNodeAsHoistable(instance$292);\n-        var linkInstance = instance$292;\n+        markNodeAsHoistable(instance$293);\n+        var linkInstance = instance$293;\n         linkInstance._p = new Promise(function (resolve, reject) {\n           linkInstance.onload = resolve;\n           linkInstance.onerror = reject;\n         });\n-        setInitialProperties(instance$292, \"link\", instance);\n+        setInitialProperties(instance$293, \"link\", instance);\n         resource.state.loading |= 4;\n-        insertStylesheet(instance$292, props.precedence, hoistableRoot);\n-        return (resource.instance = instance$292);\n+        insertStylesheet(instance$293, props.precedence, hoistableRoot);\n+        return (resource.instance = instance$293);\n       case \"script\":\n-        instance$292 = getScriptKey(props.src);\n+        instance$293 = getScriptKey(props.src);\n         if (\n           (styleProps = hoistableRoot.querySelector(\n-            getScriptSelectorFromKey(instance$292)\n+            getScriptSelectorFromKey(instance$293)\n           ))\n         )\n           return (\n@@ -18853,7 +18844,7 @@ function acquireResource(hoistableRoot, resource, props) {\n             styleProps\n           );\n         instance = props;\n-        if ((styleProps = preloadPropsMap.get(instance$292)))\n+        if ((styleProps = preloadPropsMap.get(instance$293)))\n           (instance = assign({}, props)),\n             adoptPreloadPropsForScript(instance, styleProps);\n         hoistableRoot = hoistableRoot.ownerDocument || hoistableRoot;\n@@ -19980,16 +19971,16 @@ ReactDOMHydrationRoot.prototype.unstable_scheduleHydration = function (target) {\n     0 === i && attemptExplicitHydrationTarget(target);\n   }\n };\n-var isomorphicReactPackageVersion$jscomp$inline_2242 = React.version;\n+var isomorphicReactPackageVersion$jscomp$inline_2243 = React.version;\n if (\n-  \"19.3.0-experimental-55480b4d-20251208\" !==\n-  isomorphicReactPackageVersion$jscomp$inline_2242\n+  \"19.3.0-experimental-80cb7a99-20251211\" !==\n+  isomorphicReactPackageVersion$jscomp$inline_2243\n )\n   throw Error(\n     formatProdErrorMessage(\n       527,\n-      isomorphicReactPackageVersion$jscomp$inline_2242,\n-      \"19.3.0-experimental-55480b4d-20251208\"\n+      isomorphicReactPackageVersion$jscomp$inline_2243,\n+      \"19.3.0-experimental-80cb7a99-20251211\"\n     )\n   );\n ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n@@ -20009,24 +20000,24 @@ ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n     null === componentOrElement ? null : componentOrElement.stateNode;\n   return componentOrElement;\n };\n-var internals$jscomp$inline_2950 = {\n+var internals$jscomp$inline_2951 = {\n   bundleType: 0,\n-  version: \"19.3.0-experimental-55480b4d-20251208\",\n+  version: \"19.3.0-experimental-80cb7a99-20251211\",\n   rendererPackageName: \"react-dom\",\n   currentDispatcherRef: ReactSharedInternals,\n-  reconcilerVersion: \"19.3.0-experimental-55480b4d-20251208\"\n+  reconcilerVersion: \"19.3.0-experimental-80cb7a99-20251211\"\n };\n if (\"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__) {\n-  var hook$jscomp$inline_2951 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n+  var hook$jscomp$inline_2952 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n   if (\n-    !hook$jscomp$inline_2951.isDisabled &&\n-    hook$jscomp$inline_2951.supportsFiber\n+    !hook$jscomp$inline_2952.isDisabled &&\n+    hook$jscomp$inline_2952.supportsFiber\n   )\n     try {\n-      (rendererID = hook$jscomp$inline_2951.inject(\n-        internals$jscomp$inline_2950\n+      (rendererID = hook$jscomp$inline_2952.inject(\n+        internals$jscomp$inline_2951\n       )),\n-        (injectedHook = hook$jscomp$inline_2951);\n+        (injectedHook = hook$jscomp$inline_2952);\n     } catch (err) {}\n }\n exports.createComponentSelector = function (component) {\n@@ -20272,4 +20263,4 @@ exports.observeVisibleRects = function (\n     }\n   };\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "82604eab25772dd30434aaab2d9b302473fdf5f4",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -422,7 +422,7 @@\n     exports.useFormStatus = function () {\n       return resolveDispatcher().useHostTransitionStatus();\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n     \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n       \"function\" ===\n         typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&"
        },
        {
            "sha": "4a07bd184602d7b1469a78ad4458585180fda72f",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -213,4 +213,4 @@ exports.useFormState = function (action, initialState, permalink) {\n exports.useFormStatus = function () {\n   return ReactSharedInternals.H.useHostTransitionStatus();\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "512ee45a99d099a431bedee61124140ff58a7b4a",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom.react-server.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.react-server.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.react-server.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.react-server.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -336,5 +336,5 @@\n             }))\n           : Internals.d.m(href));\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "05ee81e3e81a650d5453148dfbadf98170aee406",
            "filename": "packages/next/src/compiled/react-dom-experimental/cjs/react-dom.react-server.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.react-server.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.react-server.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fcjs%2Freact-dom.react-server.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -149,4 +149,4 @@ exports.preloadModule = function (href, options) {\n       });\n     } else Internals.d.m(href);\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "964b2b823ff1cca1a956dc27925d473c45e06c1f",
            "filename": "packages/next/src/compiled/react-dom-experimental/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom-experimental%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -72,10 +72,10 @@\n     \"./package.json\": \"./package.json\"\n   },\n   \"dependencies\": {\n-    \"scheduler\": \"0.0.0-experimental-55480b4d-20251208\"\n+    \"scheduler\": \"0.0.0-experimental-80cb7a99-20251211\"\n   },\n   \"peerDependencies\": {\n-    \"react\": \"0.0.0-experimental-55480b4d-20251208\"\n+    \"react\": \"0.0.0-experimental-80cb7a99-20251211\"\n   },\n   \"browser\": {\n     \"./server.js\": \"./server.browser.js\","
        },
        {
            "sha": "6113f480449d17058fd24074d21a2269d8f76fbb",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-client.development.js",
            "status": "modified",
            "additions": 125,
            "deletions": 137,
            "changes": 262,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-client.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-client.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-client.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -11145,24 +11145,24 @@\n       return current;\n     }\n     function updateSuspenseComponent(current, workInProgress, renderLanes) {\n-      var JSCompiler_object_inline_digest_2946;\n-      var JSCompiler_object_inline_stack_2947 = workInProgress.pendingProps;\n+      var JSCompiler_object_inline_digest_2939;\n+      var JSCompiler_object_inline_stack_2940 = workInProgress.pendingProps;\n       shouldSuspendImpl(workInProgress) && (workInProgress.flags |= 128);\n-      var JSCompiler_object_inline_message_2945 = !1;\n+      var JSCompiler_object_inline_message_2938 = !1;\n       var didSuspend = 0 !== (workInProgress.flags & 128);\n-      (JSCompiler_object_inline_digest_2946 = didSuspend) ||\n-        (JSCompiler_object_inline_digest_2946 =\n+      (JSCompiler_object_inline_digest_2939 = didSuspend) ||\n+        (JSCompiler_object_inline_digest_2939 =\n           null !== current && null === current.memoizedState\n             ? !1\n             : 0 !== (suspenseStackCursor.current & ForceSuspenseFallback));\n-      JSCompiler_object_inline_digest_2946 &&\n-        ((JSCompiler_object_inline_message_2945 = !0),\n+      JSCompiler_object_inline_digest_2939 &&\n+        ((JSCompiler_object_inline_message_2938 = !0),\n         (workInProgress.flags &= -129));\n-      JSCompiler_object_inline_digest_2946 = 0 !== (workInProgress.flags & 32);\n+      JSCompiler_object_inline_digest_2939 = 0 !== (workInProgress.flags & 32);\n       workInProgress.flags &= -33;\n       if (null === current) {\n         if (isHydrating) {\n-          JSCompiler_object_inline_message_2945\n+          JSCompiler_object_inline_message_2938\n             ? pushPrimaryTreeSuspenseHandler(workInProgress)\n             : reuseSuspenseHandlerOnStack(workInProgress);\n           (current = nextHydratableInstance)\n@@ -11175,18 +11175,18 @@\n                   ? renderLanes\n                   : null),\n               null !== renderLanes &&\n-                ((JSCompiler_object_inline_digest_2946 = {\n+                ((JSCompiler_object_inline_digest_2939 = {\n                   dehydrated: renderLanes,\n                   treeContext: getSuspendedTreeContext(),\n                   retryLane: 536870912,\n                   hydrationErrors: null\n                 }),\n                 (workInProgress.memoizedState =\n-                  JSCompiler_object_inline_digest_2946),\n-                (JSCompiler_object_inline_digest_2946 =\n+                  JSCompiler_object_inline_digest_2939),\n+                (JSCompiler_object_inline_digest_2939 =\n                   createFiberFromDehydratedFragment(renderLanes)),\n-                (JSCompiler_object_inline_digest_2946.return = workInProgress),\n-                (workInProgress.child = JSCompiler_object_inline_digest_2946),\n+                (JSCompiler_object_inline_digest_2939.return = workInProgress),\n+                (workInProgress.child = JSCompiler_object_inline_digest_2939),\n                 (hydrationParentFiber = workInProgress),\n                 (nextHydratableInstance = null)))\n             : (renderLanes = null);\n@@ -11200,39 +11200,39 @@\n             : (workInProgress.lanes = 536870912);\n           return null;\n         }\n-        var nextPrimaryChildren = JSCompiler_object_inline_stack_2947.children;\n-        JSCompiler_object_inline_stack_2947 =\n-          JSCompiler_object_inline_stack_2947.fallback;\n-        if (JSCompiler_object_inline_message_2945) {\n+        var nextPrimaryChildren = JSCompiler_object_inline_stack_2940.children;\n+        JSCompiler_object_inline_stack_2940 =\n+          JSCompiler_object_inline_stack_2940.fallback;\n+        if (JSCompiler_object_inline_message_2938) {\n           reuseSuspenseHandlerOnStack(workInProgress);\n           var mode = workInProgress.mode;\n           nextPrimaryChildren = mountWorkInProgressOffscreenFiber(\n             { mode: \"hidden\", children: nextPrimaryChildren },\n             mode\n           );\n-          JSCompiler_object_inline_stack_2947 = createFiberFromFragment(\n-            JSCompiler_object_inline_stack_2947,\n+          JSCompiler_object_inline_stack_2940 = createFiberFromFragment(\n+            JSCompiler_object_inline_stack_2940,\n             mode,\n             renderLanes,\n             null\n           );\n           nextPrimaryChildren.return = workInProgress;\n-          JSCompiler_object_inline_stack_2947.return = workInProgress;\n-          nextPrimaryChildren.sibling = JSCompiler_object_inline_stack_2947;\n+          JSCompiler_object_inline_stack_2940.return = workInProgress;\n+          nextPrimaryChildren.sibling = JSCompiler_object_inline_stack_2940;\n           workInProgress.child = nextPrimaryChildren;\n-          JSCompiler_object_inline_stack_2947 = workInProgress.child;\n-          JSCompiler_object_inline_stack_2947.memoizedState =\n+          JSCompiler_object_inline_stack_2940 = workInProgress.child;\n+          JSCompiler_object_inline_stack_2940.memoizedState =\n             mountSuspenseOffscreenState(renderLanes);\n-          JSCompiler_object_inline_stack_2947.childLanes =\n+          JSCompiler_object_inline_stack_2940.childLanes =\n             getRemainingWorkInPrimaryTree(\n               current,\n-              JSCompiler_object_inline_digest_2946,\n+              JSCompiler_object_inline_digest_2939,\n               renderLanes\n             );\n           workInProgress.memoizedState = SUSPENDED_MARKER;\n           return bailoutOffscreenComponent(\n             null,\n-            JSCompiler_object_inline_stack_2947\n+            JSCompiler_object_inline_stack_2940\n           );\n         }\n         pushPrimaryTreeSuspenseHandler(workInProgress);\n@@ -11243,8 +11243,8 @@\n       }\n       var prevState = current.memoizedState;\n       if (null !== prevState) {\n-        var JSCompiler_object_inline_componentStack_2948 = prevState.dehydrated;\n-        if (null !== JSCompiler_object_inline_componentStack_2948) {\n+        var JSCompiler_object_inline_componentStack_2941 = prevState.dehydrated;\n+        if (null !== JSCompiler_object_inline_componentStack_2941) {\n           if (didSuspend)\n             workInProgress.flags & 256\n               ? (pushPrimaryTreeSuspenseHandler(workInProgress),\n@@ -11261,13 +11261,13 @@\n                   (workInProgress = null))\n                 : (reuseSuspenseHandlerOnStack(workInProgress),\n                   (nextPrimaryChildren =\n-                    JSCompiler_object_inline_stack_2947.fallback),\n+                    JSCompiler_object_inline_stack_2940.fallback),\n                   (mode = workInProgress.mode),\n-                  (JSCompiler_object_inline_stack_2947 =\n+                  (JSCompiler_object_inline_stack_2940 =\n                     mountWorkInProgressOffscreenFiber(\n                       {\n                         mode: \"visible\",\n-                        children: JSCompiler_object_inline_stack_2947.children\n+                        children: JSCompiler_object_inline_stack_2940.children\n                       },\n                       mode\n                     )),\n@@ -11278,76 +11278,76 @@\n                     null\n                   )),\n                   (nextPrimaryChildren.flags |= 2),\n-                  (JSCompiler_object_inline_stack_2947.return = workInProgress),\n+                  (JSCompiler_object_inline_stack_2940.return = workInProgress),\n                   (nextPrimaryChildren.return = workInProgress),\n-                  (JSCompiler_object_inline_stack_2947.sibling =\n+                  (JSCompiler_object_inline_stack_2940.sibling =\n                     nextPrimaryChildren),\n-                  (workInProgress.child = JSCompiler_object_inline_stack_2947),\n+                  (workInProgress.child = JSCompiler_object_inline_stack_2940),\n                   reconcileChildFibers(\n                     workInProgress,\n                     current.child,\n                     null,\n                     renderLanes\n                   ),\n-                  (JSCompiler_object_inline_stack_2947 = workInProgress.child),\n-                  (JSCompiler_object_inline_stack_2947.memoizedState =\n+                  (JSCompiler_object_inline_stack_2940 = workInProgress.child),\n+                  (JSCompiler_object_inline_stack_2940.memoizedState =\n                     mountSuspenseOffscreenState(renderLanes)),\n-                  (JSCompiler_object_inline_stack_2947.childLanes =\n+                  (JSCompiler_object_inline_stack_2940.childLanes =\n                     getRemainingWorkInPrimaryTree(\n                       current,\n-                      JSCompiler_object_inline_digest_2946,\n+                      JSCompiler_object_inline_digest_2939,\n                       renderLanes\n                     )),\n                   (workInProgress.memoizedState = SUSPENDED_MARKER),\n                   (workInProgress = bailoutOffscreenComponent(\n                     null,\n-                    JSCompiler_object_inline_stack_2947\n+                    JSCompiler_object_inline_stack_2940\n                   )));\n           else if (\n             (pushPrimaryTreeSuspenseHandler(workInProgress),\n             warnIfHydrating(),\n             0 !== (renderLanes & 536870912) &&\n               markRenderDerivedCause(workInProgress),\n             isSuspenseInstanceFallback(\n-              JSCompiler_object_inline_componentStack_2948\n+              JSCompiler_object_inline_componentStack_2941\n             ))\n           ) {\n-            JSCompiler_object_inline_digest_2946 =\n-              JSCompiler_object_inline_componentStack_2948.nextSibling &&\n-              JSCompiler_object_inline_componentStack_2948.nextSibling.dataset;\n-            if (JSCompiler_object_inline_digest_2946) {\n-              nextPrimaryChildren = JSCompiler_object_inline_digest_2946.dgst;\n-              var message = JSCompiler_object_inline_digest_2946.msg;\n-              mode = JSCompiler_object_inline_digest_2946.stck;\n-              var componentStack = JSCompiler_object_inline_digest_2946.cstck;\n+            JSCompiler_object_inline_digest_2939 =\n+              JSCompiler_object_inline_componentStack_2941.nextSibling &&\n+              JSCompiler_object_inline_componentStack_2941.nextSibling.dataset;\n+            if (JSCompiler_object_inline_digest_2939) {\n+              nextPrimaryChildren = JSCompiler_object_inline_digest_2939.dgst;\n+              var message = JSCompiler_object_inline_digest_2939.msg;\n+              mode = JSCompiler_object_inline_digest_2939.stck;\n+              var componentStack = JSCompiler_object_inline_digest_2939.cstck;\n             }\n-            JSCompiler_object_inline_message_2945 = message;\n-            JSCompiler_object_inline_digest_2946 = nextPrimaryChildren;\n-            JSCompiler_object_inline_stack_2947 = mode;\n-            JSCompiler_object_inline_componentStack_2948 = componentStack;\n-            nextPrimaryChildren = JSCompiler_object_inline_message_2945;\n-            mode = JSCompiler_object_inline_componentStack_2948;\n+            JSCompiler_object_inline_message_2938 = message;\n+            JSCompiler_object_inline_digest_2939 = nextPrimaryChildren;\n+            JSCompiler_object_inline_stack_2940 = mode;\n+            JSCompiler_object_inline_componentStack_2941 = componentStack;\n+            nextPrimaryChildren = JSCompiler_object_inline_message_2938;\n+            mode = JSCompiler_object_inline_componentStack_2941;\n             nextPrimaryChildren = nextPrimaryChildren\n               ? Error(nextPrimaryChildren)\n               : Error(\n                   \"The server could not finish this Suspense boundary, likely due to an error during server rendering. Switched to client rendering.\"\n                 );\n             nextPrimaryChildren.stack =\n-              JSCompiler_object_inline_stack_2947 || \"\";\n-            nextPrimaryChildren.digest = JSCompiler_object_inline_digest_2946;\n-            JSCompiler_object_inline_digest_2946 =\n+              JSCompiler_object_inline_stack_2940 || \"\";\n+            nextPrimaryChildren.digest = JSCompiler_object_inline_digest_2939;\n+            JSCompiler_object_inline_digest_2939 =\n               void 0 === mode ? null : mode;\n-            JSCompiler_object_inline_stack_2947 = {\n+            JSCompiler_object_inline_stack_2940 = {\n               value: nextPrimaryChildren,\n               source: null,\n-              stack: JSCompiler_object_inline_digest_2946\n+              stack: JSCompiler_object_inline_digest_2939\n             };\n-            \"string\" === typeof JSCompiler_object_inline_digest_2946 &&\n+            \"string\" === typeof JSCompiler_object_inline_digest_2939 &&\n               CapturedStacks.set(\n                 nextPrimaryChildren,\n-                JSCompiler_object_inline_stack_2947\n+                JSCompiler_object_inline_stack_2940\n               );\n-            queueHydrationError(JSCompiler_object_inline_stack_2947);\n+            queueHydrationError(JSCompiler_object_inline_stack_2940);\n             workInProgress = retrySuspenseComponentWithoutHydrating(\n               current,\n               workInProgress,\n@@ -11361,35 +11361,35 @@\n                 renderLanes,\n                 !1\n               ),\n-            (JSCompiler_object_inline_digest_2946 =\n+            (JSCompiler_object_inline_digest_2939 =\n               0 !== (renderLanes & current.childLanes)),\n-            didReceiveUpdate || JSCompiler_object_inline_digest_2946)\n+            didReceiveUpdate || JSCompiler_object_inline_digest_2939)\n           ) {\n-            JSCompiler_object_inline_digest_2946 = workInProgressRoot;\n+            JSCompiler_object_inline_digest_2939 = workInProgressRoot;\n             if (\n-              null !== JSCompiler_object_inline_digest_2946 &&\n-              ((JSCompiler_object_inline_stack_2947 = getBumpedLaneForHydration(\n-                JSCompiler_object_inline_digest_2946,\n+              null !== JSCompiler_object_inline_digest_2939 &&\n+              ((JSCompiler_object_inline_stack_2940 = getBumpedLaneForHydration(\n+                JSCompiler_object_inline_digest_2939,\n                 renderLanes\n               )),\n-              0 !== JSCompiler_object_inline_stack_2947 &&\n-                JSCompiler_object_inline_stack_2947 !== prevState.retryLane)\n+              0 !== JSCompiler_object_inline_stack_2940 &&\n+                JSCompiler_object_inline_stack_2940 !== prevState.retryLane)\n             )\n               throw (\n-                ((prevState.retryLane = JSCompiler_object_inline_stack_2947),\n+                ((prevState.retryLane = JSCompiler_object_inline_stack_2940),\n                 enqueueConcurrentRenderForLane(\n                   current,\n-                  JSCompiler_object_inline_stack_2947\n+                  JSCompiler_object_inline_stack_2940\n                 ),\n                 scheduleUpdateOnFiber(\n-                  JSCompiler_object_inline_digest_2946,\n+                  JSCompiler_object_inline_digest_2939,\n                   current,\n-                  JSCompiler_object_inline_stack_2947\n+                  JSCompiler_object_inline_stack_2940\n                 ),\n                 SelectiveHydrationException)\n               );\n             isSuspenseInstancePending(\n-              JSCompiler_object_inline_componentStack_2948\n+              JSCompiler_object_inline_componentStack_2941\n             ) || renderDidSuspendDelayIfPossible();\n             workInProgress = retrySuspenseComponentWithoutHydrating(\n               current,\n@@ -11398,14 +11398,14 @@\n             );\n           } else\n             isSuspenseInstancePending(\n-              JSCompiler_object_inline_componentStack_2948\n+              JSCompiler_object_inline_componentStack_2941\n             )\n               ? ((workInProgress.flags |= 192),\n                 (workInProgress.child = current.child),\n                 (workInProgress = null))\n               : ((current = prevState.treeContext),\n                 (nextHydratableInstance = getNextHydratable(\n-                  JSCompiler_object_inline_componentStack_2948.nextSibling\n+                  JSCompiler_object_inline_componentStack_2941.nextSibling\n                 )),\n                 (hydrationParentFiber = workInProgress),\n                 (isHydrating = !0),\n@@ -11417,32 +11417,32 @@\n                   restoreSuspendedTreeContext(workInProgress, current),\n                 (workInProgress = mountSuspensePrimaryChildren(\n                   workInProgress,\n-                  JSCompiler_object_inline_stack_2947.children\n+                  JSCompiler_object_inline_stack_2940.children\n                 )),\n                 (workInProgress.flags |= 4096));\n           return workInProgress;\n         }\n       }\n-      if (JSCompiler_object_inline_message_2945)\n+      if (JSCompiler_object_inline_message_2938)\n         return (\n           reuseSuspenseHandlerOnStack(workInProgress),\n-          (nextPrimaryChildren = JSCompiler_object_inline_stack_2947.fallback),\n+          (nextPrimaryChildren = JSCompiler_object_inline_stack_2940.fallback),\n           (mode = workInProgress.mode),\n           (componentStack = current.child),\n-          (JSCompiler_object_inline_componentStack_2948 =\n+          (JSCompiler_object_inline_componentStack_2941 =\n             componentStack.sibling),\n-          (JSCompiler_object_inline_stack_2947 = createWorkInProgress(\n+          (JSCompiler_object_inline_stack_2940 = createWorkInProgress(\n             componentStack,\n             {\n               mode: \"hidden\",\n-              children: JSCompiler_object_inline_stack_2947.children\n+              children: JSCompiler_object_inline_stack_2940.children\n             }\n           )),\n-          (JSCompiler_object_inline_stack_2947.subtreeFlags =\n+          (JSCompiler_object_inline_stack_2940.subtreeFlags =\n             componentStack.subtreeFlags & 132120576),\n-          null !== JSCompiler_object_inline_componentStack_2948\n+          null !== JSCompiler_object_inline_componentStack_2941\n             ? (nextPrimaryChildren = createWorkInProgress(\n-                JSCompiler_object_inline_componentStack_2948,\n+                JSCompiler_object_inline_componentStack_2941,\n                 nextPrimaryChildren\n               ))\n             : ((nextPrimaryChildren = createFiberFromFragment(\n@@ -11453,11 +11453,11 @@\n               )),\n               (nextPrimaryChildren.flags |= 2)),\n           (nextPrimaryChildren.return = workInProgress),\n-          (JSCompiler_object_inline_stack_2947.return = workInProgress),\n-          (JSCompiler_object_inline_stack_2947.sibling = nextPrimaryChildren),\n-          (workInProgress.child = JSCompiler_object_inline_stack_2947),\n-          bailoutOffscreenComponent(null, JSCompiler_object_inline_stack_2947),\n-          (JSCompiler_object_inline_stack_2947 = workInProgress.child),\n+          (JSCompiler_object_inline_stack_2940.return = workInProgress),\n+          (JSCompiler_object_inline_stack_2940.sibling = nextPrimaryChildren),\n+          (workInProgress.child = JSCompiler_object_inline_stack_2940),\n+          bailoutOffscreenComponent(null, JSCompiler_object_inline_stack_2940),\n+          (JSCompiler_object_inline_stack_2940 = workInProgress.child),\n           (nextPrimaryChildren = current.child.memoizedState),\n           null === nextPrimaryChildren\n             ? (nextPrimaryChildren = mountSuspenseOffscreenState(renderLanes))\n@@ -11473,18 +11473,18 @@\n                 baseLanes: nextPrimaryChildren.baseLanes | renderLanes,\n                 cachePool: mode\n               })),\n-          (JSCompiler_object_inline_stack_2947.memoizedState =\n+          (JSCompiler_object_inline_stack_2940.memoizedState =\n             nextPrimaryChildren),\n-          (JSCompiler_object_inline_stack_2947.childLanes =\n+          (JSCompiler_object_inline_stack_2940.childLanes =\n             getRemainingWorkInPrimaryTree(\n               current,\n-              JSCompiler_object_inline_digest_2946,\n+              JSCompiler_object_inline_digest_2939,\n               renderLanes\n             )),\n           (workInProgress.memoizedState = SUSPENDED_MARKER),\n           bailoutOffscreenComponent(\n             current.child,\n-            JSCompiler_object_inline_stack_2947\n+            JSCompiler_object_inline_stack_2940\n           )\n         );\n       null !== prevState &&\n@@ -11496,16 +11496,16 @@\n       current = renderLanes.sibling;\n       renderLanes = createWorkInProgress(renderLanes, {\n         mode: \"visible\",\n-        children: JSCompiler_object_inline_stack_2947.children\n+        children: JSCompiler_object_inline_stack_2940.children\n       });\n       renderLanes.return = workInProgress;\n       renderLanes.sibling = null;\n       null !== current &&\n-        ((JSCompiler_object_inline_digest_2946 = workInProgress.deletions),\n-        null === JSCompiler_object_inline_digest_2946\n+        ((JSCompiler_object_inline_digest_2939 = workInProgress.deletions),\n+        null === JSCompiler_object_inline_digest_2939\n           ? ((workInProgress.deletions = [current]),\n             (workInProgress.flags |= 16))\n-          : JSCompiler_object_inline_digest_2946.push(current));\n+          : JSCompiler_object_inline_digest_2939.push(current));\n       workInProgress.child = renderLanes;\n       workInProgress.memoizedState = null;\n       return renderLanes;\n@@ -24029,6 +24029,7 @@\n           types: transitionTypes\n         });\n         ownerDocument.__reactViewTransition = transition;\n+        var viewTransitionAnimations = [];\n         transition.ready.then(\n           function () {\n             for (\n@@ -24039,25 +24040,26 @@\n               i < animations.length;\n               i++\n             ) {\n-              var effect = animations[i].effect,\n+              var animation = animations[i],\n+                effect = animation.effect,\n                 pseudoElement = effect.pseudoElement;\n               if (\n                 null != pseudoElement &&\n                 pseudoElement.startsWith(\"::view-transition\")\n               ) {\n-                pseudoElement = effect.getKeyframes();\n+                viewTransitionAnimations.push(animation);\n+                animation = effect.getKeyframes();\n                 for (\n-                  var width = void 0,\n-                    height = void 0,\n+                  var height = (pseudoElement = void 0),\n                     unchangedDimensions = !0,\n                     j = 0;\n-                  j < pseudoElement.length;\n+                  j < animation.length;\n                   j++\n                 ) {\n-                  var keyframe = pseudoElement[j],\n+                  var keyframe = animation[j],\n                     w = keyframe.width;\n-                  if (void 0 === width) width = w;\n-                  else if (width !== w) {\n+                  if (void 0 === pseudoElement) pseudoElement = w;\n+                  else if (pseudoElement !== w) {\n                     unchangedDimensions = !1;\n                     break;\n                   }\n@@ -24072,23 +24074,22 @@\n                   \"none\" === keyframe.transform && delete keyframe.transform;\n                 }\n                 unchangedDimensions &&\n-                  void 0 !== width &&\n+                  void 0 !== pseudoElement &&\n                   void 0 !== height &&\n-                  (effect.setKeyframes(pseudoElement),\n+                  (effect.setKeyframes(animation),\n                   (unchangedDimensions = getComputedStyle(\n                     effect.target,\n                     effect.pseudoElement\n                   )),\n-                  unchangedDimensions.width !== width ||\n+                  unchangedDimensions.width !== pseudoElement ||\n                     unchangedDimensions.height !== height) &&\n-                  ((unchangedDimensions = pseudoElement[0]),\n-                  (unchangedDimensions.width = width),\n+                  ((unchangedDimensions = animation[0]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  (unchangedDimensions =\n-                    pseudoElement[pseudoElement.length - 1]),\n-                  (unchangedDimensions.width = width),\n+                  (unchangedDimensions = animation[animation.length - 1]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  effect.setKeyframes(pseudoElement));\n+                  effect.setKeyframes(animation));\n               }\n             }\n             spawnedWorkCallback();\n@@ -24108,21 +24109,8 @@\n           }\n         );\n         transition.finished.finally(function () {\n-          for (\n-            var scope = ownerDocument.documentElement,\n-              animations = scope.getAnimations({ subtree: !0 }),\n-              i = 0;\n-            i < animations.length;\n-            i++\n-          ) {\n-            var anim = animations[i],\n-              effect = anim.effect,\n-              pseudo = effect.pseudoElement;\n-            null != pseudo &&\n-              pseudo.startsWith(\"::view-transition\") &&\n-              effect.target === scope &&\n-              anim.cancel();\n-          }\n+          for (var i = 0; i < viewTransitionAnimations.length; i++)\n+            viewTransitionAnimations[i].cancel();\n           ownerDocument.__reactViewTransition === transition &&\n             (ownerDocument.__reactViewTransition = null);\n           finishedAnimation();\n@@ -30396,11 +30384,11 @@\n     };\n     (function () {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-canary-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-canary-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-canary-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-canary-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     })();\n     (\"function\" === typeof Map &&\n@@ -30437,10 +30425,10 @@\n       !(function () {\n         var internals = {\n           bundleType: 1,\n-          version: \"19.3.0-canary-55480b4d-20251208\",\n+          version: \"19.3.0-canary-80cb7a99-20251211\",\n           rendererPackageName: \"react-dom\",\n           currentDispatcherRef: ReactSharedInternals,\n-          reconcilerVersion: \"19.3.0-canary-55480b4d-20251208\"\n+          reconcilerVersion: \"19.3.0-canary-80cb7a99-20251211\"\n         };\n         internals.overrideHookState = overrideHookState;\n         internals.overrideHookStateDeletePath = overrideHookStateDeletePath;\n@@ -30578,7 +30566,7 @@\n       listenToAllSupportedEvents(container);\n       return new ReactDOMHydrationRoot(initialChildren);\n     };\n-    exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+    exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n     \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n       \"function\" ===\n         typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&"
        },
        {
            "sha": "49ab733bc962487ff0ea83b92cca0d1a8426a16e",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-client.production.js",
            "status": "modified",
            "additions": 35,
            "deletions": 46,
            "changes": 81,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-client.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-client.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-client.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -15523,6 +15523,7 @@ function startViewTransition(\n       types: transitionTypes\n     });\n     ownerDocument.__reactViewTransition = transition;\n+    var viewTransitionAnimations = [];\n     transition.ready.then(\n       function () {\n         for (\n@@ -15533,25 +15534,26 @@ function startViewTransition(\n           i < animations.length;\n           i++\n         ) {\n-          var effect = animations[i].effect,\n+          var animation = animations[i],\n+            effect = animation.effect,\n             pseudoElement = effect.pseudoElement;\n           if (\n             null != pseudoElement &&\n             pseudoElement.startsWith(\"::view-transition\")\n           ) {\n-            pseudoElement = effect.getKeyframes();\n+            viewTransitionAnimations.push(animation);\n+            animation = effect.getKeyframes();\n             for (\n-              var width = void 0,\n-                height = void 0,\n+              var height = (pseudoElement = void 0),\n                 unchangedDimensions = !0,\n                 j = 0;\n-              j < pseudoElement.length;\n+              j < animation.length;\n               j++\n             ) {\n-              var keyframe = pseudoElement[j],\n+              var keyframe = animation[j],\n                 w = keyframe.width;\n-              if (void 0 === width) width = w;\n-              else if (width !== w) {\n+              if (void 0 === pseudoElement) pseudoElement = w;\n+              else if (pseudoElement !== w) {\n                 unchangedDimensions = !1;\n                 break;\n               }\n@@ -15566,22 +15568,22 @@ function startViewTransition(\n               \"none\" === keyframe.transform && delete keyframe.transform;\n             }\n             unchangedDimensions &&\n-              void 0 !== width &&\n+              void 0 !== pseudoElement &&\n               void 0 !== height &&\n-              (effect.setKeyframes(pseudoElement),\n+              (effect.setKeyframes(animation),\n               (unchangedDimensions = getComputedStyle(\n                 effect.target,\n                 effect.pseudoElement\n               )),\n-              unchangedDimensions.width !== width ||\n+              unchangedDimensions.width !== pseudoElement ||\n                 unchangedDimensions.height !== height) &&\n-              ((unchangedDimensions = pseudoElement[0]),\n-              (unchangedDimensions.width = width),\n+              ((unchangedDimensions = animation[0]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              (unchangedDimensions = pseudoElement[pseudoElement.length - 1]),\n-              (unchangedDimensions.width = width),\n+              (unchangedDimensions = animation[animation.length - 1]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              effect.setKeyframes(pseudoElement));\n+              effect.setKeyframes(animation));\n           }\n         }\n         spawnedWorkCallback();\n@@ -15612,21 +15614,8 @@ function startViewTransition(\n       }\n     );\n     transition.finished.finally(function () {\n-      for (\n-        var scope = ownerDocument.documentElement,\n-          animations = scope.getAnimations({ subtree: !0 }),\n-          i = 0;\n-        i < animations.length;\n-        i++\n-      ) {\n-        var anim = animations[i],\n-          effect = anim.effect,\n-          pseudo = effect.pseudoElement;\n-        null != pseudo &&\n-          pseudo.startsWith(\"::view-transition\") &&\n-          effect.target === scope &&\n-          anim.cancel();\n-      }\n+      for (var i = 0; i < viewTransitionAnimations.length; i++)\n+        viewTransitionAnimations[i].cancel();\n       ownerDocument.__reactViewTransition === transition &&\n         (ownerDocument.__reactViewTransition = null);\n       passiveCallback();\n@@ -18011,16 +18000,16 @@ ReactDOMHydrationRoot.prototype.unstable_scheduleHydration = function (target) {\n     0 === i && attemptExplicitHydrationTarget(target);\n   }\n };\n-var isomorphicReactPackageVersion$jscomp$inline_2047 = React.version;\n+var isomorphicReactPackageVersion$jscomp$inline_2040 = React.version;\n if (\n-  \"19.3.0-canary-55480b4d-20251208\" !==\n-  isomorphicReactPackageVersion$jscomp$inline_2047\n+  \"19.3.0-canary-80cb7a99-20251211\" !==\n+  isomorphicReactPackageVersion$jscomp$inline_2040\n )\n   throw Error(\n     formatProdErrorMessage(\n       527,\n-      isomorphicReactPackageVersion$jscomp$inline_2047,\n-      \"19.3.0-canary-55480b4d-20251208\"\n+      isomorphicReactPackageVersion$jscomp$inline_2040,\n+      \"19.3.0-canary-80cb7a99-20251211\"\n     )\n   );\n ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n@@ -18040,24 +18029,24 @@ ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n     null === componentOrElement ? null : componentOrElement.stateNode;\n   return componentOrElement;\n };\n-var internals$jscomp$inline_2635 = {\n+var internals$jscomp$inline_2628 = {\n   bundleType: 0,\n-  version: \"19.3.0-canary-55480b4d-20251208\",\n+  version: \"19.3.0-canary-80cb7a99-20251211\",\n   rendererPackageName: \"react-dom\",\n   currentDispatcherRef: ReactSharedInternals,\n-  reconcilerVersion: \"19.3.0-canary-55480b4d-20251208\"\n+  reconcilerVersion: \"19.3.0-canary-80cb7a99-20251211\"\n };\n if (\"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__) {\n-  var hook$jscomp$inline_2636 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n+  var hook$jscomp$inline_2629 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n   if (\n-    !hook$jscomp$inline_2636.isDisabled &&\n-    hook$jscomp$inline_2636.supportsFiber\n+    !hook$jscomp$inline_2629.isDisabled &&\n+    hook$jscomp$inline_2629.supportsFiber\n   )\n     try {\n-      (rendererID = hook$jscomp$inline_2636.inject(\n-        internals$jscomp$inline_2635\n+      (rendererID = hook$jscomp$inline_2629.inject(\n+        internals$jscomp$inline_2628\n       )),\n-        (injectedHook = hook$jscomp$inline_2636);\n+        (injectedHook = hook$jscomp$inline_2629);\n     } catch (err) {}\n }\n exports.createRoot = function (container, options) {\n@@ -18143,4 +18132,4 @@ exports.hydrateRoot = function (container, initialChildren, options) {\n   listenToAllSupportedEvents(container);\n   return new ReactDOMHydrationRoot(initialChildren);\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";"
        },
        {
            "sha": "8ce5036b6fc694533a0791a825308a6dfc1d41f0",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-profiling.development.js",
            "status": "modified",
            "additions": 125,
            "deletions": 137,
            "changes": 262,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-profiling.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-profiling.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-profiling.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -11153,24 +11153,24 @@\n       return current;\n     }\n     function updateSuspenseComponent(current, workInProgress, renderLanes) {\n-      var JSCompiler_object_inline_digest_2951;\n-      var JSCompiler_object_inline_stack_2952 = workInProgress.pendingProps;\n+      var JSCompiler_object_inline_digest_2944;\n+      var JSCompiler_object_inline_stack_2945 = workInProgress.pendingProps;\n       shouldSuspendImpl(workInProgress) && (workInProgress.flags |= 128);\n-      var JSCompiler_object_inline_message_2950 = !1;\n+      var JSCompiler_object_inline_message_2943 = !1;\n       var didSuspend = 0 !== (workInProgress.flags & 128);\n-      (JSCompiler_object_inline_digest_2951 = didSuspend) ||\n-        (JSCompiler_object_inline_digest_2951 =\n+      (JSCompiler_object_inline_digest_2944 = didSuspend) ||\n+        (JSCompiler_object_inline_digest_2944 =\n           null !== current && null === current.memoizedState\n             ? !1\n             : 0 !== (suspenseStackCursor.current & ForceSuspenseFallback));\n-      JSCompiler_object_inline_digest_2951 &&\n-        ((JSCompiler_object_inline_message_2950 = !0),\n+      JSCompiler_object_inline_digest_2944 &&\n+        ((JSCompiler_object_inline_message_2943 = !0),\n         (workInProgress.flags &= -129));\n-      JSCompiler_object_inline_digest_2951 = 0 !== (workInProgress.flags & 32);\n+      JSCompiler_object_inline_digest_2944 = 0 !== (workInProgress.flags & 32);\n       workInProgress.flags &= -33;\n       if (null === current) {\n         if (isHydrating) {\n-          JSCompiler_object_inline_message_2950\n+          JSCompiler_object_inline_message_2943\n             ? pushPrimaryTreeSuspenseHandler(workInProgress)\n             : reuseSuspenseHandlerOnStack(workInProgress);\n           (current = nextHydratableInstance)\n@@ -11183,18 +11183,18 @@\n                   ? renderLanes\n                   : null),\n               null !== renderLanes &&\n-                ((JSCompiler_object_inline_digest_2951 = {\n+                ((JSCompiler_object_inline_digest_2944 = {\n                   dehydrated: renderLanes,\n                   treeContext: getSuspendedTreeContext(),\n                   retryLane: 536870912,\n                   hydrationErrors: null\n                 }),\n                 (workInProgress.memoizedState =\n-                  JSCompiler_object_inline_digest_2951),\n-                (JSCompiler_object_inline_digest_2951 =\n+                  JSCompiler_object_inline_digest_2944),\n+                (JSCompiler_object_inline_digest_2944 =\n                   createFiberFromDehydratedFragment(renderLanes)),\n-                (JSCompiler_object_inline_digest_2951.return = workInProgress),\n-                (workInProgress.child = JSCompiler_object_inline_digest_2951),\n+                (JSCompiler_object_inline_digest_2944.return = workInProgress),\n+                (workInProgress.child = JSCompiler_object_inline_digest_2944),\n                 (hydrationParentFiber = workInProgress),\n                 (nextHydratableInstance = null)))\n             : (renderLanes = null);\n@@ -11208,39 +11208,39 @@\n             : (workInProgress.lanes = 536870912);\n           return null;\n         }\n-        var nextPrimaryChildren = JSCompiler_object_inline_stack_2952.children;\n-        JSCompiler_object_inline_stack_2952 =\n-          JSCompiler_object_inline_stack_2952.fallback;\n-        if (JSCompiler_object_inline_message_2950) {\n+        var nextPrimaryChildren = JSCompiler_object_inline_stack_2945.children;\n+        JSCompiler_object_inline_stack_2945 =\n+          JSCompiler_object_inline_stack_2945.fallback;\n+        if (JSCompiler_object_inline_message_2943) {\n           reuseSuspenseHandlerOnStack(workInProgress);\n           var mode = workInProgress.mode;\n           nextPrimaryChildren = mountWorkInProgressOffscreenFiber(\n             { mode: \"hidden\", children: nextPrimaryChildren },\n             mode\n           );\n-          JSCompiler_object_inline_stack_2952 = createFiberFromFragment(\n-            JSCompiler_object_inline_stack_2952,\n+          JSCompiler_object_inline_stack_2945 = createFiberFromFragment(\n+            JSCompiler_object_inline_stack_2945,\n             mode,\n             renderLanes,\n             null\n           );\n           nextPrimaryChildren.return = workInProgress;\n-          JSCompiler_object_inline_stack_2952.return = workInProgress;\n-          nextPrimaryChildren.sibling = JSCompiler_object_inline_stack_2952;\n+          JSCompiler_object_inline_stack_2945.return = workInProgress;\n+          nextPrimaryChildren.sibling = JSCompiler_object_inline_stack_2945;\n           workInProgress.child = nextPrimaryChildren;\n-          JSCompiler_object_inline_stack_2952 = workInProgress.child;\n-          JSCompiler_object_inline_stack_2952.memoizedState =\n+          JSCompiler_object_inline_stack_2945 = workInProgress.child;\n+          JSCompiler_object_inline_stack_2945.memoizedState =\n             mountSuspenseOffscreenState(renderLanes);\n-          JSCompiler_object_inline_stack_2952.childLanes =\n+          JSCompiler_object_inline_stack_2945.childLanes =\n             getRemainingWorkInPrimaryTree(\n               current,\n-              JSCompiler_object_inline_digest_2951,\n+              JSCompiler_object_inline_digest_2944,\n               renderLanes\n             );\n           workInProgress.memoizedState = SUSPENDED_MARKER;\n           return bailoutOffscreenComponent(\n             null,\n-            JSCompiler_object_inline_stack_2952\n+            JSCompiler_object_inline_stack_2945\n           );\n         }\n         pushPrimaryTreeSuspenseHandler(workInProgress);\n@@ -11251,8 +11251,8 @@\n       }\n       var prevState = current.memoizedState;\n       if (null !== prevState) {\n-        var JSCompiler_object_inline_componentStack_2953 = prevState.dehydrated;\n-        if (null !== JSCompiler_object_inline_componentStack_2953) {\n+        var JSCompiler_object_inline_componentStack_2946 = prevState.dehydrated;\n+        if (null !== JSCompiler_object_inline_componentStack_2946) {\n           if (didSuspend)\n             workInProgress.flags & 256\n               ? (pushPrimaryTreeSuspenseHandler(workInProgress),\n@@ -11269,13 +11269,13 @@\n                   (workInProgress = null))\n                 : (reuseSuspenseHandlerOnStack(workInProgress),\n                   (nextPrimaryChildren =\n-                    JSCompiler_object_inline_stack_2952.fallback),\n+                    JSCompiler_object_inline_stack_2945.fallback),\n                   (mode = workInProgress.mode),\n-                  (JSCompiler_object_inline_stack_2952 =\n+                  (JSCompiler_object_inline_stack_2945 =\n                     mountWorkInProgressOffscreenFiber(\n                       {\n                         mode: \"visible\",\n-                        children: JSCompiler_object_inline_stack_2952.children\n+                        children: JSCompiler_object_inline_stack_2945.children\n                       },\n                       mode\n                     )),\n@@ -11286,76 +11286,76 @@\n                     null\n                   )),\n                   (nextPrimaryChildren.flags |= 2),\n-                  (JSCompiler_object_inline_stack_2952.return = workInProgress),\n+                  (JSCompiler_object_inline_stack_2945.return = workInProgress),\n                   (nextPrimaryChildren.return = workInProgress),\n-                  (JSCompiler_object_inline_stack_2952.sibling =\n+                  (JSCompiler_object_inline_stack_2945.sibling =\n                     nextPrimaryChildren),\n-                  (workInProgress.child = JSCompiler_object_inline_stack_2952),\n+                  (workInProgress.child = JSCompiler_object_inline_stack_2945),\n                   reconcileChildFibers(\n                     workInProgress,\n                     current.child,\n                     null,\n                     renderLanes\n                   ),\n-                  (JSCompiler_object_inline_stack_2952 = workInProgress.child),\n-                  (JSCompiler_object_inline_stack_2952.memoizedState =\n+                  (JSCompiler_object_inline_stack_2945 = workInProgress.child),\n+                  (JSCompiler_object_inline_stack_2945.memoizedState =\n                     mountSuspenseOffscreenState(renderLanes)),\n-                  (JSCompiler_object_inline_stack_2952.childLanes =\n+                  (JSCompiler_object_inline_stack_2945.childLanes =\n                     getRemainingWorkInPrimaryTree(\n                       current,\n-                      JSCompiler_object_inline_digest_2951,\n+                      JSCompiler_object_inline_digest_2944,\n                       renderLanes\n                     )),\n                   (workInProgress.memoizedState = SUSPENDED_MARKER),\n                   (workInProgress = bailoutOffscreenComponent(\n                     null,\n-                    JSCompiler_object_inline_stack_2952\n+                    JSCompiler_object_inline_stack_2945\n                   )));\n           else if (\n             (pushPrimaryTreeSuspenseHandler(workInProgress),\n             warnIfHydrating(),\n             0 !== (renderLanes & 536870912) &&\n               markRenderDerivedCause(workInProgress),\n             isSuspenseInstanceFallback(\n-              JSCompiler_object_inline_componentStack_2953\n+              JSCompiler_object_inline_componentStack_2946\n             ))\n           ) {\n-            JSCompiler_object_inline_digest_2951 =\n-              JSCompiler_object_inline_componentStack_2953.nextSibling &&\n-              JSCompiler_object_inline_componentStack_2953.nextSibling.dataset;\n-            if (JSCompiler_object_inline_digest_2951) {\n-              nextPrimaryChildren = JSCompiler_object_inline_digest_2951.dgst;\n-              var message = JSCompiler_object_inline_digest_2951.msg;\n-              mode = JSCompiler_object_inline_digest_2951.stck;\n-              var componentStack = JSCompiler_object_inline_digest_2951.cstck;\n+            JSCompiler_object_inline_digest_2944 =\n+              JSCompiler_object_inline_componentStack_2946.nextSibling &&\n+              JSCompiler_object_inline_componentStack_2946.nextSibling.dataset;\n+            if (JSCompiler_object_inline_digest_2944) {\n+              nextPrimaryChildren = JSCompiler_object_inline_digest_2944.dgst;\n+              var message = JSCompiler_object_inline_digest_2944.msg;\n+              mode = JSCompiler_object_inline_digest_2944.stck;\n+              var componentStack = JSCompiler_object_inline_digest_2944.cstck;\n             }\n-            JSCompiler_object_inline_message_2950 = message;\n-            JSCompiler_object_inline_digest_2951 = nextPrimaryChildren;\n-            JSCompiler_object_inline_stack_2952 = mode;\n-            JSCompiler_object_inline_componentStack_2953 = componentStack;\n-            nextPrimaryChildren = JSCompiler_object_inline_message_2950;\n-            mode = JSCompiler_object_inline_componentStack_2953;\n+            JSCompiler_object_inline_message_2943 = message;\n+            JSCompiler_object_inline_digest_2944 = nextPrimaryChildren;\n+            JSCompiler_object_inline_stack_2945 = mode;\n+            JSCompiler_object_inline_componentStack_2946 = componentStack;\n+            nextPrimaryChildren = JSCompiler_object_inline_message_2943;\n+            mode = JSCompiler_object_inline_componentStack_2946;\n             nextPrimaryChildren = nextPrimaryChildren\n               ? Error(nextPrimaryChildren)\n               : Error(\n                   \"The server could not finish this Suspense boundary, likely due to an error during server rendering. Switched to client rendering.\"\n                 );\n             nextPrimaryChildren.stack =\n-              JSCompiler_object_inline_stack_2952 || \"\";\n-            nextPrimaryChildren.digest = JSCompiler_object_inline_digest_2951;\n-            JSCompiler_object_inline_digest_2951 =\n+              JSCompiler_object_inline_stack_2945 || \"\";\n+            nextPrimaryChildren.digest = JSCompiler_object_inline_digest_2944;\n+            JSCompiler_object_inline_digest_2944 =\n               void 0 === mode ? null : mode;\n-            JSCompiler_object_inline_stack_2952 = {\n+            JSCompiler_object_inline_stack_2945 = {\n               value: nextPrimaryChildren,\n               source: null,\n-              stack: JSCompiler_object_inline_digest_2951\n+              stack: JSCompiler_object_inline_digest_2944\n             };\n-            \"string\" === typeof JSCompiler_object_inline_digest_2951 &&\n+            \"string\" === typeof JSCompiler_object_inline_digest_2944 &&\n               CapturedStacks.set(\n                 nextPrimaryChildren,\n-                JSCompiler_object_inline_stack_2952\n+                JSCompiler_object_inline_stack_2945\n               );\n-            queueHydrationError(JSCompiler_object_inline_stack_2952);\n+            queueHydrationError(JSCompiler_object_inline_stack_2945);\n             workInProgress = retrySuspenseComponentWithoutHydrating(\n               current,\n               workInProgress,\n@@ -11369,35 +11369,35 @@\n                 renderLanes,\n                 !1\n               ),\n-            (JSCompiler_object_inline_digest_2951 =\n+            (JSCompiler_object_inline_digest_2944 =\n               0 !== (renderLanes & current.childLanes)),\n-            didReceiveUpdate || JSCompiler_object_inline_digest_2951)\n+            didReceiveUpdate || JSCompiler_object_inline_digest_2944)\n           ) {\n-            JSCompiler_object_inline_digest_2951 = workInProgressRoot;\n+            JSCompiler_object_inline_digest_2944 = workInProgressRoot;\n             if (\n-              null !== JSCompiler_object_inline_digest_2951 &&\n-              ((JSCompiler_object_inline_stack_2952 = getBumpedLaneForHydration(\n-                JSCompiler_object_inline_digest_2951,\n+              null !== JSCompiler_object_inline_digest_2944 &&\n+              ((JSCompiler_object_inline_stack_2945 = getBumpedLaneForHydration(\n+                JSCompiler_object_inline_digest_2944,\n                 renderLanes\n               )),\n-              0 !== JSCompiler_object_inline_stack_2952 &&\n-                JSCompiler_object_inline_stack_2952 !== prevState.retryLane)\n+              0 !== JSCompiler_object_inline_stack_2945 &&\n+                JSCompiler_object_inline_stack_2945 !== prevState.retryLane)\n             )\n               throw (\n-                ((prevState.retryLane = JSCompiler_object_inline_stack_2952),\n+                ((prevState.retryLane = JSCompiler_object_inline_stack_2945),\n                 enqueueConcurrentRenderForLane(\n                   current,\n-                  JSCompiler_object_inline_stack_2952\n+                  JSCompiler_object_inline_stack_2945\n                 ),\n                 scheduleUpdateOnFiber(\n-                  JSCompiler_object_inline_digest_2951,\n+                  JSCompiler_object_inline_digest_2944,\n                   current,\n-                  JSCompiler_object_inline_stack_2952\n+                  JSCompiler_object_inline_stack_2945\n                 ),\n                 SelectiveHydrationException)\n               );\n             isSuspenseInstancePending(\n-              JSCompiler_object_inline_componentStack_2953\n+              JSCompiler_object_inline_componentStack_2946\n             ) || renderDidSuspendDelayIfPossible();\n             workInProgress = retrySuspenseComponentWithoutHydrating(\n               current,\n@@ -11406,14 +11406,14 @@\n             );\n           } else\n             isSuspenseInstancePending(\n-              JSCompiler_object_inline_componentStack_2953\n+              JSCompiler_object_inline_componentStack_2946\n             )\n               ? ((workInProgress.flags |= 192),\n                 (workInProgress.child = current.child),\n                 (workInProgress = null))\n               : ((current = prevState.treeContext),\n                 (nextHydratableInstance = getNextHydratable(\n-                  JSCompiler_object_inline_componentStack_2953.nextSibling\n+                  JSCompiler_object_inline_componentStack_2946.nextSibling\n                 )),\n                 (hydrationParentFiber = workInProgress),\n                 (isHydrating = !0),\n@@ -11425,32 +11425,32 @@\n                   restoreSuspendedTreeContext(workInProgress, current),\n                 (workInProgress = mountSuspensePrimaryChildren(\n                   workInProgress,\n-                  JSCompiler_object_inline_stack_2952.children\n+                  JSCompiler_object_inline_stack_2945.children\n                 )),\n                 (workInProgress.flags |= 4096));\n           return workInProgress;\n         }\n       }\n-      if (JSCompiler_object_inline_message_2950)\n+      if (JSCompiler_object_inline_message_2943)\n         return (\n           reuseSuspenseHandlerOnStack(workInProgress),\n-          (nextPrimaryChildren = JSCompiler_object_inline_stack_2952.fallback),\n+          (nextPrimaryChildren = JSCompiler_object_inline_stack_2945.fallback),\n           (mode = workInProgress.mode),\n           (componentStack = current.child),\n-          (JSCompiler_object_inline_componentStack_2953 =\n+          (JSCompiler_object_inline_componentStack_2946 =\n             componentStack.sibling),\n-          (JSCompiler_object_inline_stack_2952 = createWorkInProgress(\n+          (JSCompiler_object_inline_stack_2945 = createWorkInProgress(\n             componentStack,\n             {\n               mode: \"hidden\",\n-              children: JSCompiler_object_inline_stack_2952.children\n+              children: JSCompiler_object_inline_stack_2945.children\n             }\n           )),\n-          (JSCompiler_object_inline_stack_2952.subtreeFlags =\n+          (JSCompiler_object_inline_stack_2945.subtreeFlags =\n             componentStack.subtreeFlags & 132120576),\n-          null !== JSCompiler_object_inline_componentStack_2953\n+          null !== JSCompiler_object_inline_componentStack_2946\n             ? (nextPrimaryChildren = createWorkInProgress(\n-                JSCompiler_object_inline_componentStack_2953,\n+                JSCompiler_object_inline_componentStack_2946,\n                 nextPrimaryChildren\n               ))\n             : ((nextPrimaryChildren = createFiberFromFragment(\n@@ -11461,11 +11461,11 @@\n               )),\n               (nextPrimaryChildren.flags |= 2)),\n           (nextPrimaryChildren.return = workInProgress),\n-          (JSCompiler_object_inline_stack_2952.return = workInProgress),\n-          (JSCompiler_object_inline_stack_2952.sibling = nextPrimaryChildren),\n-          (workInProgress.child = JSCompiler_object_inline_stack_2952),\n-          bailoutOffscreenComponent(null, JSCompiler_object_inline_stack_2952),\n-          (JSCompiler_object_inline_stack_2952 = workInProgress.child),\n+          (JSCompiler_object_inline_stack_2945.return = workInProgress),\n+          (JSCompiler_object_inline_stack_2945.sibling = nextPrimaryChildren),\n+          (workInProgress.child = JSCompiler_object_inline_stack_2945),\n+          bailoutOffscreenComponent(null, JSCompiler_object_inline_stack_2945),\n+          (JSCompiler_object_inline_stack_2945 = workInProgress.child),\n           (nextPrimaryChildren = current.child.memoizedState),\n           null === nextPrimaryChildren\n             ? (nextPrimaryChildren = mountSuspenseOffscreenState(renderLanes))\n@@ -11481,18 +11481,18 @@\n                 baseLanes: nextPrimaryChildren.baseLanes | renderLanes,\n                 cachePool: mode\n               })),\n-          (JSCompiler_object_inline_stack_2952.memoizedState =\n+          (JSCompiler_object_inline_stack_2945.memoizedState =\n             nextPrimaryChildren),\n-          (JSCompiler_object_inline_stack_2952.childLanes =\n+          (JSCompiler_object_inline_stack_2945.childLanes =\n             getRemainingWorkInPrimaryTree(\n               current,\n-              JSCompiler_object_inline_digest_2951,\n+              JSCompiler_object_inline_digest_2944,\n               renderLanes\n             )),\n           (workInProgress.memoizedState = SUSPENDED_MARKER),\n           bailoutOffscreenComponent(\n             current.child,\n-            JSCompiler_object_inline_stack_2952\n+            JSCompiler_object_inline_stack_2945\n           )\n         );\n       null !== prevState &&\n@@ -11504,16 +11504,16 @@\n       current = renderLanes.sibling;\n       renderLanes = createWorkInProgress(renderLanes, {\n         mode: \"visible\",\n-        children: JSCompiler_object_inline_stack_2952.children\n+        children: JSCompiler_object_inline_stack_2945.children\n       });\n       renderLanes.return = workInProgress;\n       renderLanes.sibling = null;\n       null !== current &&\n-        ((JSCompiler_object_inline_digest_2951 = workInProgress.deletions),\n-        null === JSCompiler_object_inline_digest_2951\n+        ((JSCompiler_object_inline_digest_2944 = workInProgress.deletions),\n+        null === JSCompiler_object_inline_digest_2944\n           ? ((workInProgress.deletions = [current]),\n             (workInProgress.flags |= 16))\n-          : JSCompiler_object_inline_digest_2951.push(current));\n+          : JSCompiler_object_inline_digest_2944.push(current));\n       workInProgress.child = renderLanes;\n       workInProgress.memoizedState = null;\n       return renderLanes;\n@@ -24037,6 +24037,7 @@\n           types: transitionTypes\n         });\n         ownerDocument.__reactViewTransition = transition;\n+        var viewTransitionAnimations = [];\n         transition.ready.then(\n           function () {\n             for (\n@@ -24047,25 +24048,26 @@\n               i < animations.length;\n               i++\n             ) {\n-              var effect = animations[i].effect,\n+              var animation = animations[i],\n+                effect = animation.effect,\n                 pseudoElement = effect.pseudoElement;\n               if (\n                 null != pseudoElement &&\n                 pseudoElement.startsWith(\"::view-transition\")\n               ) {\n-                pseudoElement = effect.getKeyframes();\n+                viewTransitionAnimations.push(animation);\n+                animation = effect.getKeyframes();\n                 for (\n-                  var width = void 0,\n-                    height = void 0,\n+                  var height = (pseudoElement = void 0),\n                     unchangedDimensions = !0,\n                     j = 0;\n-                  j < pseudoElement.length;\n+                  j < animation.length;\n                   j++\n                 ) {\n-                  var keyframe = pseudoElement[j],\n+                  var keyframe = animation[j],\n                     w = keyframe.width;\n-                  if (void 0 === width) width = w;\n-                  else if (width !== w) {\n+                  if (void 0 === pseudoElement) pseudoElement = w;\n+                  else if (pseudoElement !== w) {\n                     unchangedDimensions = !1;\n                     break;\n                   }\n@@ -24080,23 +24082,22 @@\n                   \"none\" === keyframe.transform && delete keyframe.transform;\n                 }\n                 unchangedDimensions &&\n-                  void 0 !== width &&\n+                  void 0 !== pseudoElement &&\n                   void 0 !== height &&\n-                  (effect.setKeyframes(pseudoElement),\n+                  (effect.setKeyframes(animation),\n                   (unchangedDimensions = getComputedStyle(\n                     effect.target,\n                     effect.pseudoElement\n                   )),\n-                  unchangedDimensions.width !== width ||\n+                  unchangedDimensions.width !== pseudoElement ||\n                     unchangedDimensions.height !== height) &&\n-                  ((unchangedDimensions = pseudoElement[0]),\n-                  (unchangedDimensions.width = width),\n+                  ((unchangedDimensions = animation[0]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  (unchangedDimensions =\n-                    pseudoElement[pseudoElement.length - 1]),\n-                  (unchangedDimensions.width = width),\n+                  (unchangedDimensions = animation[animation.length - 1]),\n+                  (unchangedDimensions.width = pseudoElement),\n                   (unchangedDimensions.height = height),\n-                  effect.setKeyframes(pseudoElement));\n+                  effect.setKeyframes(animation));\n               }\n             }\n             spawnedWorkCallback();\n@@ -24116,21 +24117,8 @@\n           }\n         );\n         transition.finished.finally(function () {\n-          for (\n-            var scope = ownerDocument.documentElement,\n-              animations = scope.getAnimations({ subtree: !0 }),\n-              i = 0;\n-            i < animations.length;\n-            i++\n-          ) {\n-            var anim = animations[i],\n-              effect = anim.effect,\n-              pseudo = effect.pseudoElement;\n-            null != pseudo &&\n-              pseudo.startsWith(\"::view-transition\") &&\n-              effect.target === scope &&\n-              anim.cancel();\n-          }\n+          for (var i = 0; i < viewTransitionAnimations.length; i++)\n+            viewTransitionAnimations[i].cancel();\n           ownerDocument.__reactViewTransition === transition &&\n             (ownerDocument.__reactViewTransition = null);\n           finishedAnimation();\n@@ -30454,11 +30442,11 @@\n     };\n     (function () {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-canary-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-canary-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-canary-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-canary-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     })();\n     (\"function\" === typeof Map &&\n@@ -30495,10 +30483,10 @@\n       !(function () {\n         var internals = {\n           bundleType: 1,\n-          version: \"19.3.0-canary-55480b4d-20251208\",\n+          version: \"19.3.0-canary-80cb7a99-20251211\",\n           rendererPackageName: \"react-dom\",\n           currentDispatcherRef: ReactSharedInternals,\n-          reconcilerVersion: \"19.3.0-canary-55480b4d-20251208\"\n+          reconcilerVersion: \"19.3.0-canary-80cb7a99-20251211\"\n         };\n         internals.overrideHookState = overrideHookState;\n         internals.overrideHookStateDeletePath = overrideHookStateDeletePath;\n@@ -30966,7 +30954,7 @@\n     exports.useFormStatus = function () {\n       return resolveDispatcher().useHostTransitionStatus();\n     };\n-    exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+    exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n     \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n       \"function\" ===\n         typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&"
        },
        {
            "sha": "73c839a3e343a0ba49098f6dc92adcb4d7be19b2",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-profiling.profiling.js",
            "status": "modified",
            "additions": 35,
            "deletions": 46,
            "changes": 81,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-profiling.profiling.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-profiling.profiling.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-profiling.profiling.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -17419,6 +17419,7 @@ function startViewTransition(\n       types: transitionTypes\n     });\n     ownerDocument.__reactViewTransition = transition;\n+    var viewTransitionAnimations = [];\n     transition.ready.then(\n       function () {\n         for (\n@@ -17429,25 +17430,26 @@ function startViewTransition(\n           i < animations.length;\n           i++\n         ) {\n-          var effect = animations[i].effect,\n+          var animation = animations[i],\n+            effect = animation.effect,\n             pseudoElement = effect.pseudoElement;\n           if (\n             null != pseudoElement &&\n             pseudoElement.startsWith(\"::view-transition\")\n           ) {\n-            pseudoElement = effect.getKeyframes();\n+            viewTransitionAnimations.push(animation);\n+            animation = effect.getKeyframes();\n             for (\n-              var width = void 0,\n-                height = void 0,\n+              var height = (pseudoElement = void 0),\n                 unchangedDimensions = !0,\n                 j = 0;\n-              j < pseudoElement.length;\n+              j < animation.length;\n               j++\n             ) {\n-              var keyframe = pseudoElement[j],\n+              var keyframe = animation[j],\n                 w = keyframe.width;\n-              if (void 0 === width) width = w;\n-              else if (width !== w) {\n+              if (void 0 === pseudoElement) pseudoElement = w;\n+              else if (pseudoElement !== w) {\n                 unchangedDimensions = !1;\n                 break;\n               }\n@@ -17462,22 +17464,22 @@ function startViewTransition(\n               \"none\" === keyframe.transform && delete keyframe.transform;\n             }\n             unchangedDimensions &&\n-              void 0 !== width &&\n+              void 0 !== pseudoElement &&\n               void 0 !== height &&\n-              (effect.setKeyframes(pseudoElement),\n+              (effect.setKeyframes(animation),\n               (unchangedDimensions = getComputedStyle(\n                 effect.target,\n                 effect.pseudoElement\n               )),\n-              unchangedDimensions.width !== width ||\n+              unchangedDimensions.width !== pseudoElement ||\n                 unchangedDimensions.height !== height) &&\n-              ((unchangedDimensions = pseudoElement[0]),\n-              (unchangedDimensions.width = width),\n+              ((unchangedDimensions = animation[0]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              (unchangedDimensions = pseudoElement[pseudoElement.length - 1]),\n-              (unchangedDimensions.width = width),\n+              (unchangedDimensions = animation[animation.length - 1]),\n+              (unchangedDimensions.width = pseudoElement),\n               (unchangedDimensions.height = height),\n-              effect.setKeyframes(pseudoElement));\n+              effect.setKeyframes(animation));\n           }\n         }\n         spawnedWorkCallback();\n@@ -17511,21 +17513,8 @@ function startViewTransition(\n       }\n     );\n     transition.finished.finally(function () {\n-      for (\n-        var scope = ownerDocument.documentElement,\n-          animations = scope.getAnimations({ subtree: !0 }),\n-          i = 0;\n-        i < animations.length;\n-        i++\n-      ) {\n-        var anim = animations[i],\n-          effect = anim.effect,\n-          pseudo = effect.pseudoElement;\n-        null != pseudo &&\n-          pseudo.startsWith(\"::view-transition\") &&\n-          effect.target === scope &&\n-          anim.cancel();\n-      }\n+      for (var i = 0; i < viewTransitionAnimations.length; i++)\n+        viewTransitionAnimations[i].cancel();\n       ownerDocument.__reactViewTransition === transition &&\n         (ownerDocument.__reactViewTransition = null);\n       finishedAnimation();\n@@ -19939,16 +19928,16 @@ ReactDOMHydrationRoot.prototype.unstable_scheduleHydration = function (target) {\n     0 === i && attemptExplicitHydrationTarget(target);\n   }\n };\n-var isomorphicReactPackageVersion$jscomp$inline_2344 = React.version;\n+var isomorphicReactPackageVersion$jscomp$inline_2337 = React.version;\n if (\n-  \"19.3.0-canary-55480b4d-20251208\" !==\n-  isomorphicReactPackageVersion$jscomp$inline_2344\n+  \"19.3.0-canary-80cb7a99-20251211\" !==\n+  isomorphicReactPackageVersion$jscomp$inline_2337\n )\n   throw Error(\n     formatProdErrorMessage(\n       527,\n-      isomorphicReactPackageVersion$jscomp$inline_2344,\n-      \"19.3.0-canary-55480b4d-20251208\"\n+      isomorphicReactPackageVersion$jscomp$inline_2337,\n+      \"19.3.0-canary-80cb7a99-20251211\"\n     )\n   );\n ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n@@ -19968,24 +19957,24 @@ ReactDOMSharedInternals.findDOMNode = function (componentOrElement) {\n     null === componentOrElement ? null : componentOrElement.stateNode;\n   return componentOrElement;\n };\n-var internals$jscomp$inline_2945 = {\n+var internals$jscomp$inline_2938 = {\n   bundleType: 0,\n-  version: \"19.3.0-canary-55480b4d-20251208\",\n+  version: \"19.3.0-canary-80cb7a99-20251211\",\n   rendererPackageName: \"react-dom\",\n   currentDispatcherRef: ReactSharedInternals,\n-  reconcilerVersion: \"19.3.0-canary-55480b4d-20251208\"\n+  reconcilerVersion: \"19.3.0-canary-80cb7a99-20251211\"\n };\n if (\"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__) {\n-  var hook$jscomp$inline_2946 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n+  var hook$jscomp$inline_2939 = __REACT_DEVTOOLS_GLOBAL_HOOK__;\n   if (\n-    !hook$jscomp$inline_2946.isDisabled &&\n-    hook$jscomp$inline_2946.supportsFiber\n+    !hook$jscomp$inline_2939.isDisabled &&\n+    hook$jscomp$inline_2939.supportsFiber\n   )\n     try {\n-      (rendererID = hook$jscomp$inline_2946.inject(\n-        internals$jscomp$inline_2945\n+      (rendererID = hook$jscomp$inline_2939.inject(\n+        internals$jscomp$inline_2938\n       )),\n-        (injectedHook = hook$jscomp$inline_2946);\n+        (injectedHook = hook$jscomp$inline_2939);\n     } catch (err) {}\n }\n function getCrossOriginStringAs(as, input) {\n@@ -20232,7 +20221,7 @@ exports.useFormState = function (action, initialState, permalink) {\n exports.useFormStatus = function () {\n   return ReactSharedInternals.H.useHostTransitionStatus();\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n   \"function\" ===\n     typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&"
        },
        {
            "sha": "1e9938eabd9fd1f1366f2c8408a1ae799f447f0d",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server-legacy.browser.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -10035,5 +10035,5 @@\n         'The server used \"renderToString\" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to \"renderToReadableStream\" which supports Suspense on the server'\n       );\n     };\n-    exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+    exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "fd94d6fb25e500c7f87c026aa6ae40baf59a0cd2",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server-legacy.browser.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -6763,4 +6763,4 @@ exports.renderToString = function (children, options) {\n     'The server used \"renderToString\" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to \"renderToReadableStream\" which supports Suspense on the server'\n   );\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";"
        },
        {
            "sha": "2a228bb94b67a50ee5af632fc39f7e6f5b06c167",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server-legacy.node.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -10035,5 +10035,5 @@\n         'The server used \"renderToString\" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to \"renderToPipeableStream\" which supports Suspense on the server'\n       );\n     };\n-    exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+    exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "d7b25a41610ee2b42cab5ea4d7dc65b9a669e7d5",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server-legacy.node.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server-legacy.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -6855,4 +6855,4 @@ exports.renderToString = function (children, options) {\n     'The server used \"renderToString\" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to \"renderToPipeableStream\" which supports Suspense on the server'\n   );\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";"
        },
        {
            "sha": "27fd2eac04a7a91ad8c8ba4b9242437c4c4e7866",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server.browser.development.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -9001,11 +9001,11 @@\n     }\n     function ensureCorrectIsomorphicReactVersion() {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-canary-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-canary-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-canary-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-canary-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     }\n     var React = require(\"next/dist/compiled/react\"),\n@@ -10808,5 +10808,5 @@\n         startWork(request);\n       });\n     };\n-    exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+    exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "404aca9360a3354703ccf48c0cdf309c1ec0c1c8",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server.browser.production.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7365,12 +7365,12 @@ function getPostponedState(request) {\n }\n function ensureCorrectIsomorphicReactVersion() {\n   var isomorphicReactPackageVersion = React.version;\n-  if (\"19.3.0-canary-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+  if (\"19.3.0-canary-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n     throw Error(\n       formatProdErrorMessage(\n         527,\n         isomorphicReactPackageVersion,\n-        \"19.3.0-canary-55480b4d-20251208\"\n+        \"19.3.0-canary-80cb7a99-20251211\"\n       )\n     );\n }\n@@ -7621,4 +7621,4 @@ exports.resumeAndPrerender = function (children, postponedState, options) {\n     startWork(request);\n   });\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";"
        },
        {
            "sha": "2b28ee38b394bbed0d9205d9bb087b91bb3c533a",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server.bun.production.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.bun.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.bun.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.bun.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7073,11 +7073,11 @@ function getPostponedState(request) {\n }\n function ensureCorrectIsomorphicReactVersion() {\n   var isomorphicReactPackageVersion = React.version;\n-  if (\"19.3.0-canary-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+  if (\"19.3.0-canary-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n     throw Error(\n       'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n         (isomorphicReactPackageVersion +\n-          \"\\n  - react-dom:  19.3.0-canary-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+          \"\\n  - react-dom:  19.3.0-canary-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n     );\n }\n ensureCorrectIsomorphicReactVersion();\n@@ -7622,4 +7622,4 @@ exports.resumeToPipeableStream = function (children, postponedState, options) {\n     }\n   };\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";"
        },
        {
            "sha": "130f8dc7467c7690b12a13d7bacdee4ae0506c01",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server.edge.development.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -9024,11 +9024,11 @@\n     }\n     function ensureCorrectIsomorphicReactVersion() {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-canary-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-canary-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-canary-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-canary-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     }\n     var React = require(\"next/dist/compiled/react\"),\n@@ -10827,5 +10827,5 @@\n         startWork(request);\n       });\n     };\n-    exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+    exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "ae367b0086d14c64a3ccf3f84f3e4353ef71a818",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server.edge.production.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7472,11 +7472,11 @@ function getPostponedState(request) {\n }\n function ensureCorrectIsomorphicReactVersion() {\n   var isomorphicReactPackageVersion = React.version;\n-  if (\"19.3.0-canary-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+  if (\"19.3.0-canary-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n     throw Error(\n       'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n         (isomorphicReactPackageVersion +\n-          \"\\n  - react-dom:  19.3.0-canary-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+          \"\\n  - react-dom:  19.3.0-canary-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n     );\n }\n ensureCorrectIsomorphicReactVersion();\n@@ -7726,4 +7726,4 @@ exports.resumeAndPrerender = function (children, postponedState, options) {\n     startWork(request);\n   });\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";"
        },
        {
            "sha": "4b8ce1b551e01814625316950be5d16c6515ad94",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server.node.development.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -8898,11 +8898,11 @@\n     }\n     function ensureCorrectIsomorphicReactVersion() {\n       var isomorphicReactPackageVersion = React.version;\n-      if (\"19.3.0-canary-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+      if (\"19.3.0-canary-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n         throw Error(\n           'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n             (isomorphicReactPackageVersion +\n-              \"\\n  - react-dom:  19.3.0-canary-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+              \"\\n  - react-dom:  19.3.0-canary-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n         );\n     }\n     function createDrainHandler(destination, request) {\n@@ -11007,5 +11007,5 @@\n         }\n       };\n     };\n-    exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+    exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "a6c6d8c64db6710c96194b868915a3a8e2eb4621",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom-server.node.production.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom-server.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -7363,11 +7363,11 @@ function getPostponedState(request) {\n }\n function ensureCorrectIsomorphicReactVersion() {\n   var isomorphicReactPackageVersion = React.version;\n-  if (\"19.3.0-canary-55480b4d-20251208\" !== isomorphicReactPackageVersion)\n+  if (\"19.3.0-canary-80cb7a99-20251211\" !== isomorphicReactPackageVersion)\n     throw Error(\n       'Incompatible React versions: The \"react\" and \"react-dom\" packages must have the exact same version. Instead got:\\n  - react:      ' +\n         (isomorphicReactPackageVersion +\n-          \"\\n  - react-dom:  19.3.0-canary-55480b4d-20251208\\nLearn more: https://react.dev/warnings/version-mismatch\")\n+          \"\\n  - react-dom:  19.3.0-canary-80cb7a99-20251211\\nLearn more: https://react.dev/warnings/version-mismatch\")\n     );\n }\n ensureCorrectIsomorphicReactVersion();\n@@ -7917,4 +7917,4 @@ exports.resumeToPipeableStream = function (children, postponedState, options) {\n     }\n   };\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";"
        },
        {
            "sha": "a22ee9cfb56126efc3fbb521b73995d8f4978eb4",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -422,7 +422,7 @@\n     exports.useFormStatus = function () {\n       return resolveDispatcher().useHostTransitionStatus();\n     };\n-    exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+    exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n     \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n       \"function\" ===\n         typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&"
        },
        {
            "sha": "f78ae81fde18bed8a80b0e2a45240fa40b1772f0",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -213,4 +213,4 @@ exports.useFormState = function (action, initialState, permalink) {\n exports.useFormStatus = function () {\n   return ReactSharedInternals.H.useHostTransitionStatus();\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";"
        },
        {
            "sha": "1bdc0fd5f20bae109cefdda1c29cfba709f6e5be",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom.react-server.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.react-server.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.react-server.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.react-server.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -336,5 +336,5 @@\n             }))\n           : Internals.d.m(href));\n     };\n-    exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+    exports.version = \"19.3.0-canary-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "d4a893ae6a8df5f7d15322a30f5654007a29d627",
            "filename": "packages/next/src/compiled/react-dom/cjs/react-dom.react-server.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.react-server.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.react-server.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fcjs%2Freact-dom.react-server.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -149,4 +149,4 @@ exports.preloadModule = function (href, options) {\n       });\n     } else Internals.d.m(href);\n };\n-exports.version = \"19.3.0-canary-55480b4d-20251208\";\n+exports.version = \"19.3.0-canary-80cb7a99-20251211\";"
        },
        {
            "sha": "0a15baf7d9609ce6fd53c6ce494312119fef1405",
            "filename": "packages/next/src/compiled/react-dom/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-dom%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -67,10 +67,10 @@\n     \"./package.json\": \"./package.json\"\n   },\n   \"dependencies\": {\n-    \"scheduler\": \"0.28.0-canary-55480b4d-20251208\"\n+    \"scheduler\": \"0.28.0-canary-80cb7a99-20251211\"\n   },\n   \"peerDependencies\": {\n-    \"react\": \"19.3.0-canary-55480b4d-20251208\"\n+    \"react\": \"19.3.0-canary-80cb7a99-20251211\"\n   },\n   \"browser\": {\n     \"./server.js\": \"./server.browser.js\","
        },
        {
            "sha": "26c299845d4eb265295d5f2a2c17c690f5fc9527",
            "filename": "packages/next/src/compiled/react-experimental/cjs/react.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -1391,7 +1391,7 @@\n     exports.useTransition = function () {\n       return resolveDispatcher().useTransition();\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n     \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n       \"function\" ===\n         typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&"
        },
        {
            "sha": "a5b2ce723cc2a7b694a685e3a7f0965dcddd516b",
            "filename": "packages/next/src/compiled/react-experimental/cjs/react.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -605,4 +605,4 @@ exports.useSyncExternalStore = function (\n exports.useTransition = function () {\n   return ReactSharedInternals.H.useTransition();\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "6d170325e4878856d3178e5e2ff3cfacef4692bf",
            "filename": "packages/next/src/compiled/react-experimental/cjs/react.react-server.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.react-server.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.react-server.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.react-server.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -1061,5 +1061,5 @@\n     exports.useMemo = function (create, deps) {\n       return resolveDispatcher().useMemo(create, deps);\n     };\n-    exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+    exports.version = \"19.3.0-experimental-80cb7a99-20251211\";\n   })();"
        },
        {
            "sha": "cd38cc3e015020ce7d81c807ced360ea4529fd0c",
            "filename": "packages/next/src/compiled/react-experimental/cjs/react.react-server.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.react-server.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.react-server.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-experimental%2Fcjs%2Freact.react-server.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -571,4 +571,4 @@ exports.useId = function () {\n exports.useMemo = function (create, deps) {\n   return ReactSharedInternals.H.useMemo(create, deps);\n };\n-exports.version = \"19.3.0-experimental-55480b4d-20251208\";\n+exports.version = \"19.3.0-experimental-80cb7a99-20251211\";"
        },
        {
            "sha": "4e5df69748bd18a7e54dfe85573e940f148b3cf4",
            "filename": "packages/next/src/compiled/react-is/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-is%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-is%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-is%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"react-is\",\n-  \"version\": \"19.3.0-canary-55480b4d-20251208\",\n+  \"version\": \"19.3.0-canary-80cb7a99-20251211\",\n   \"description\": \"Brand checking of React Elements.\",\n   \"main\": \"index.js\",\n   \"sideEffects\": false,"
        },
        {
            "sha": "08a4dfdd2bbc71a76f566070dc01e6609db19dd7",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-client.browser.development.js",
            "status": "modified",
            "additions": 182,
            "deletions": 148,
            "changes": 330,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -488,13 +488,23 @@\n                 pendingParts--;\n               }\n           }\n+          parentReference = writtenObjects.get(value);\n           if (\"function\" === typeof value.then) {\n+            if (void 0 !== parentReference)\n+              if (modelRoot === value) modelRoot = null;\n+              else return parentReference;\n             null === formData && (formData = new FormData());\n             pendingParts++;\n             var promiseId = nextPartId++;\n+            key = \"$@\" + promiseId.toString(16);\n+            writtenObjects.set(value, key);\n             value.then(function (partValue) {\n               try {\n-                var _partJSON3 = serializeModel(partValue, promiseId);\n+                var previousReference = writtenObjects.get(partValue);\n+                var _partJSON3 =\n+                  void 0 !== previousReference\n+                    ? JSON.stringify(previousReference)\n+                    : serializeModel(partValue, promiseId);\n                 partValue = formData;\n                 partValue.append(formFieldPrefix + promiseId, _partJSON3);\n                 pendingParts--;\n@@ -503,9 +513,8 @@\n                 reject(reason);\n               }\n             }, reject);\n-            return \"$@\" + promiseId.toString(16);\n+            return key;\n           }\n-          parentReference = writtenObjects.get(value);\n           if (void 0 !== parentReference)\n             if (modelRoot === value) modelRoot = null;\n             else return parentReference;\n@@ -663,7 +672,7 @@\n               null === formData && (formData = new FormData()),\n               (parentReference = nextPartId++),\n               formData.set(formFieldPrefix + parentReference, key),\n-              \"$F\" + parentReference.toString(16)\n+              \"$h\" + parentReference.toString(16)\n             );\n           if (\n             void 0 !== temporaryReferences &&\n@@ -1668,6 +1677,7 @@\n           rejectListeners = chunk.reason;\n         chunk.status = \"resolved_module\";\n         chunk.value = value;\n+        chunk.reason = null;\n         value = value[1];\n         for (var debugInfo = [], i = 0; i < value.length; ) {\n           var chunkFilename = value[i++],\n@@ -1853,8 +1863,11 @@\n         response._closed = !0;\n         response._closedReason = error;\n         response._chunks.forEach(function (chunk) {\n-          \"pending\" === chunk.status &&\n-            triggerErrorOnChunk(response, chunk, error);\n+          \"pending\" === chunk.status\n+            ? triggerErrorOnChunk(response, chunk, error)\n+            : \"fulfilled\" === chunk.status &&\n+              null !== chunk.reason &&\n+              chunk.reason.error(error);\n         });\n         weakResponse = response._debugChannel;\n         void 0 !== weakResponse &&\n@@ -1959,125 +1972,136 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value, fulfilledChunk) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          for (\n+            ;\n+            \"object\" === typeof value &&\n+            null !== value &&\n+            value.$$typeof === REACT_LAZY_TYPE;\n+\n+          ) {\n+            var referencedChunk = value._payload;\n+            if (referencedChunk === handler.chunk) value = handler.value;\n+            else {\n+              switch (referencedChunk.status) {\n+                case \"resolved_model\":\n+                  initializeModelChunk(referencedChunk);\n+                  break;\n+                case \"resolved_module\":\n+                  initializeModuleChunk(referencedChunk);\n+              }\n+              switch (referencedChunk.status) {\n+                case \"fulfilled\":\n+                  value = referencedChunk.value;\n+                  continue;\n+                case \"blocked\":\n+                  var cyclicHandler = resolveBlockedCycle(\n+                    referencedChunk,\n+                    reference\n+                  );\n+                  if (null !== cyclicHandler) {\n+                    value = cyclicHandler.value;\n+                    continue;\n+                  }\n+                case \"pending\":\n+                  path.splice(0, i - 1);\n+                  null === referencedChunk.value\n+                    ? (referencedChunk.value = [reference])\n+                    : referencedChunk.value.push(reference);\n+                  null === referencedChunk.reason\n+                    ? (referencedChunk.reason = [reference])\n+                    : referencedChunk.reason.push(reference);\n+                  return;\n+                case \"halted\":\n+                  return;\n+                default:\n+                  rejectReference(\n+                    response,\n+                    reference.handler,\n+                    referencedChunk.reason\n+                  );\n+                  return;\n+              }\n+            }\n+          }\n+          value = value[path[i]];\n+        }\n         for (\n           ;\n           \"object\" === typeof value &&\n           null !== value &&\n           value.$$typeof === REACT_LAZY_TYPE;\n \n-        )\n-          if (((value = value._payload), value === handler.chunk))\n-            value = handler.value;\n+        ) {\n+          var _referencedChunk = value._payload;\n+          if (_referencedChunk === handler.chunk) value = handler.value;\n           else {\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"resolved_model\":\n-                initializeModelChunk(value);\n+                initializeModelChunk(_referencedChunk);\n                 break;\n               case \"resolved_module\":\n-                initializeModuleChunk(value);\n+                initializeModuleChunk(_referencedChunk);\n             }\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"fulfilled\":\n-                value = value.value;\n+                value = _referencedChunk.value;\n                 continue;\n-              case \"blocked\":\n-                var cyclicHandler = resolveBlockedCycle(value, reference);\n-                if (null !== cyclicHandler) {\n-                  value = cyclicHandler.value;\n-                  continue;\n-                }\n-              case \"pending\":\n-                path.splice(0, i - 1);\n-                null === value.value\n-                  ? (value.value = [reference])\n-                  : value.value.push(reference);\n-                null === value.reason\n-                  ? (value.reason = [reference])\n-                  : value.reason.push(reference);\n-                return;\n-              case \"halted\":\n-                return;\n-              default:\n-                rejectReference(response, reference.handler, value.reason);\n-                return;\n             }\n+            break;\n           }\n-        value = value[path[i]];\n-      }\n-      for (\n-        ;\n-        \"object\" === typeof value &&\n-        null !== value &&\n-        value.$$typeof === REACT_LAZY_TYPE;\n-\n-      )\n-        if (((path = value._payload), path === handler.chunk))\n-          value = handler.value;\n-        else {\n-          switch (path.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(path);\n+        }\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+        if (\n+          parentObject[0] === REACT_ELEMENT_TYPE &&\n+          \"object\" === typeof handler.value &&\n+          null !== handler.value &&\n+          handler.value.$$typeof === REACT_ELEMENT_TYPE\n+        ) {\n+          var element = handler.value;\n+          switch (key) {\n+            case \"3\":\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+              element.props = mappedValue;\n               break;\n-            case \"resolved_module\":\n-              initializeModuleChunk(path);\n-          }\n-          switch (path.status) {\n-            case \"fulfilled\":\n-              value = path.value;\n-              continue;\n+            case \"4\":\n+              element._owner = mappedValue;\n+              break;\n+            case \"5\":\n+              element._debugStack = mappedValue;\n+              break;\n+            default:\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n           }\n-          break;\n-        }\n-      map = map(response, value, parentObject, key);\n-      parentObject[key] = map;\n-      \"\" === key && null === handler.value && (handler.value = map);\n-      if (\n-        parentObject[0] === REACT_ELEMENT_TYPE &&\n-        \"object\" === typeof handler.value &&\n-        null !== handler.value &&\n-        handler.value.$$typeof === REACT_ELEMENT_TYPE\n-      )\n-        switch (((reference = handler.value), key)) {\n-          case \"3\":\n-            transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-            reference.props = map;\n-            break;\n-          case \"4\":\n-            reference._owner = map;\n-            break;\n-          case \"5\":\n-            reference._debugStack = map;\n-            break;\n-          default:\n+        } else\n+          reference.isDebug ||\n             transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-        }\n-      else\n-        reference.isDebug ||\n-          transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n+      }\n       handler.deps--;\n       0 === handler.deps &&\n-        ((fulfilledChunk = handler.chunk),\n-        null !== fulfilledChunk &&\n-          \"blocked\" === fulfilledChunk.status &&\n-          ((key = fulfilledChunk.value),\n-          (fulfilledChunk.status = \"fulfilled\"),\n-          (fulfilledChunk.value = handler.value),\n-          (fulfilledChunk.reason = handler.reason),\n-          null !== key\n-            ? wakeChunk(response, key, handler.value, fulfilledChunk)\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value\n+            ? wakeChunk(response, value, handler.value, reference)\n             : ((handler = handler.value),\n-              filterDebugInfo(response, fulfilledChunk),\n-              moveDebugInfoFromChunkToInnerValue(fulfilledChunk, handler))));\n+              filterDebugInfo(response, reference),\n+              moveDebugInfoFromChunkToInnerValue(reference, handler))));\n     }\n     function rejectReference(response, handler, error) {\n       if (!handler.errored) {\n@@ -2223,6 +2247,7 @@\n               ((boundArgs = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== boundArgs\n                 ? wakeChunk(response, boundArgs, handler.value, resolvedValue)\n                 : ((boundArgs = handler.value),\n@@ -2548,7 +2573,7 @@\n             );\n           case \"S\":\n             return Symbol.for(value.slice(2));\n-          case \"F\":\n+          case \"h\":\n             var ref = value.slice(2);\n             return getOutlinedModel(\n               response,\n@@ -2926,7 +2951,8 @@\n           chunks.set(id, stream);\n     }\n     function startReadableStream(response, id, type, streamState) {\n-      var controller = null;\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -2981,24 +3007,28 @@\n             }\n           },\n           close: function () {\n-            if (null === previousBlockedChunk) controller.close();\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.close();\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.close();\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.close();\n+                });\n+              }\n           },\n           error: function (error) {\n-            if (null === previousBlockedChunk) controller.error(error);\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.error(error);\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.error(error);\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.error(error);\n+                });\n+              }\n           }\n         },\n         streamState\n@@ -3054,6 +3084,7 @@\n                 rejectListeners = chunk.reason;\n               chunk.status = \"fulfilled\";\n               chunk.value = { done: !1, value: value };\n+              chunk.reason = null;\n               null !== resolveListeners &&\n                 wakeChunkIfInitialized(\n                   response,\n@@ -3080,36 +3111,39 @@\n             nextWriteIndex++;\n           },\n           close: function (value) {\n-            closed = !0;\n-            nextWriteIndex === buffer.length\n-              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                  response,\n-                  value,\n-                  !0\n-                ))\n-              : resolveIteratorResultChunk(\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length\n+                    ? (buffer[nextWriteIndex] =\n+                        createResolvedIteratorResultChunk(response, value, !0))\n+                    : resolveIteratorResultChunk(\n+                        response,\n+                        buffer[nextWriteIndex],\n+                        value,\n+                        !0\n+                      ),\n+                  nextWriteIndex++;\n+                nextWriteIndex < buffer.length;\n+\n+              )\n+                resolveIteratorResultChunk(\n                   response,\n-                  buffer[nextWriteIndex],\n-                  value,\n+                  buffer[nextWriteIndex++],\n+                  '\"$undefined\"',\n                   !0\n                 );\n-            for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-              resolveIteratorResultChunk(\n-                response,\n-                buffer[nextWriteIndex++],\n-                '\"$undefined\"',\n-                !0\n-              );\n           },\n           error: function (error) {\n-            closed = !0;\n-            for (\n-              nextWriteIndex === buffer.length &&\n-              (buffer[nextWriteIndex] = createPendingChunk(response));\n-              nextWriteIndex < buffer.length;\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length &&\n+                    (buffer[nextWriteIndex] = createPendingChunk(response));\n+                nextWriteIndex < buffer.length;\n \n-            )\n-              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+              )\n+                triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n           }\n         },\n         streamState\n@@ -4966,10 +5000,10 @@\n       return hook.checkDCE ? !0 : !1;\n     })({\n       bundleType: 1,\n-      version: \"19.3.0-experimental-55480b4d-20251208\",\n+      version: \"19.3.0-experimental-80cb7a99-20251211\",\n       rendererPackageName: \"react-server-dom-turbopack\",\n       currentDispatcherRef: ReactSharedInternals,\n-      reconcilerVersion: \"19.3.0-experimental-55480b4d-20251208\",\n+      reconcilerVersion: \"19.3.0-experimental-80cb7a99-20251211\",\n       getCurrentComponentInfo: function () {\n         return currentOwnerInDEV;\n       }"
        },
        {
            "sha": "b2df86e17d76eb425939b9b4351d781890e1d8d1",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-client.browser.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -292,13 +292,23 @@ function processReply(\n             pendingParts--;\n           }\n       }\n+      parentReference = writtenObjects.get(value);\n       if (\"function\" === typeof value.then) {\n+        if (void 0 !== parentReference)\n+          if (modelRoot === value) modelRoot = null;\n+          else return parentReference;\n         null === formData && (formData = new FormData());\n         pendingParts++;\n         var promiseId = nextPartId++;\n+        key = \"$@\" + promiseId.toString(16);\n+        writtenObjects.set(value, key);\n         value.then(function (partValue) {\n           try {\n-            var partJSON$27 = serializeModel(partValue, promiseId);\n+            var previousReference = writtenObjects.get(partValue);\n+            var partJSON$27 =\n+              void 0 !== previousReference\n+                ? JSON.stringify(previousReference)\n+                : serializeModel(partValue, promiseId);\n             partValue = formData;\n             partValue.append(formFieldPrefix + promiseId, partJSON$27);\n             pendingParts--;\n@@ -307,9 +317,8 @@ function processReply(\n             reject(reason);\n           }\n         }, reject);\n-        return \"$@\" + promiseId.toString(16);\n+        return key;\n       }\n-      parentReference = writtenObjects.get(value);\n       if (void 0 !== parentReference)\n         if (modelRoot === value) modelRoot = null;\n         else return parentReference;\n@@ -433,7 +442,7 @@ function processReply(\n           null === formData && (formData = new FormData()),\n           (parentReference = nextPartId++),\n           formData.set(formFieldPrefix + parentReference, key),\n-          \"$F\" + parentReference.toString(16)\n+          \"$h\" + parentReference.toString(16)\n         );\n       if (\n         void 0 !== temporaryReferences &&\n@@ -568,12 +577,12 @@ function readChunk(chunk) {\n       throw chunk.reason;\n   }\n }\n-function wakeChunk(response, listeners, value) {\n+function wakeChunk(response, listeners, value, chunk) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n     \"function\" === typeof listener\n       ? listener(value)\n-      : fulfillReference(response, listener, value);\n+      : fulfillReference(response, listener, value, chunk);\n   }\n }\n function rejectChunk(response, listeners, error) {\n@@ -613,7 +622,7 @@ function wakeChunkIfInitialized(\n ) {\n   switch (chunk.status) {\n     case \"fulfilled\":\n-      wakeChunk(response, resolveListeners, chunk.value);\n+      wakeChunk(response, resolveListeners, chunk.value, chunk);\n       break;\n     case \"blocked\":\n       for (var i = 0; i < resolveListeners.length; i++) {\n@@ -622,7 +631,7 @@ function wakeChunkIfInitialized(\n           var cyclicHandler = resolveBlockedCycle(chunk, listener);\n           if (null !== cyclicHandler)\n             switch (\n-              (fulfillReference(response, listener, cyclicHandler.value),\n+              (fulfillReference(response, listener, cyclicHandler.value, chunk),\n               resolveListeners.splice(i, 1),\n               i--,\n               null !== rejectListeners &&\n@@ -631,7 +640,7 @@ function wakeChunkIfInitialized(\n               chunk.status)\n             ) {\n               case \"fulfilled\":\n-                wakeChunk(response, resolveListeners, chunk.value);\n+                wakeChunk(response, resolveListeners, chunk.value, chunk);\n                 return;\n               case \"rejected\":\n                 null !== rejectListeners &&\n@@ -707,6 +716,7 @@ function resolveModuleChunk(response, chunk, value) {\n       rejectListeners = chunk.reason;\n     chunk.status = \"resolved_module\";\n     chunk.value = value;\n+    chunk.reason = null;\n     null !== resolveListeners &&\n       (initializeModuleChunk(chunk),\n       wakeChunkIfInitialized(\n@@ -769,8 +779,11 @@ function reportGlobalError(weakResponse, error) {\n   weakResponse._closed = !0;\n   weakResponse._closedReason = error;\n   weakResponse._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status &&\n-      triggerErrorOnChunk(weakResponse, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(weakResponse, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function createLazyChunkWrapper(chunk) {\n@@ -787,109 +800,120 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      for (\n+        ;\n+        \"object\" === typeof value &&\n+        null !== value &&\n+        value.$$typeof === REACT_LAZY_TYPE;\n+\n+      ) {\n+        var referencedChunk = value._payload;\n+        if (referencedChunk === handler.chunk) value = handler.value;\n+        else {\n+          switch (referencedChunk.status) {\n+            case \"resolved_model\":\n+              initializeModelChunk(referencedChunk);\n+              break;\n+            case \"resolved_module\":\n+              initializeModuleChunk(referencedChunk);\n+          }\n+          switch (referencedChunk.status) {\n+            case \"fulfilled\":\n+              value = referencedChunk.value;\n+              continue;\n+            case \"blocked\":\n+              var cyclicHandler = resolveBlockedCycle(\n+                referencedChunk,\n+                reference\n+              );\n+              if (null !== cyclicHandler) {\n+                value = cyclicHandler.value;\n+                continue;\n+              }\n+            case \"pending\":\n+              path.splice(0, i - 1);\n+              null === referencedChunk.value\n+                ? (referencedChunk.value = [reference])\n+                : referencedChunk.value.push(reference);\n+              null === referencedChunk.reason\n+                ? (referencedChunk.reason = [reference])\n+                : referencedChunk.reason.push(reference);\n+              return;\n+            case \"halted\":\n+              return;\n+            default:\n+              rejectReference(\n+                response,\n+                reference.handler,\n+                referencedChunk.reason\n+              );\n+              return;\n+          }\n+        }\n+      }\n+      value = value[path[i]];\n+    }\n     for (\n       ;\n       \"object\" === typeof value &&\n       null !== value &&\n       value.$$typeof === REACT_LAZY_TYPE;\n \n-    )\n-      if (((value = value._payload), value === handler.chunk))\n-        value = handler.value;\n+    ) {\n+      var referencedChunk$43 = value._payload;\n+      if (referencedChunk$43 === handler.chunk) value = handler.value;\n       else {\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"resolved_model\":\n-            initializeModelChunk(value);\n+            initializeModelChunk(referencedChunk$43);\n             break;\n           case \"resolved_module\":\n-            initializeModuleChunk(value);\n+            initializeModuleChunk(referencedChunk$43);\n         }\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"fulfilled\":\n-            value = value.value;\n+            value = referencedChunk$43.value;\n             continue;\n-          case \"blocked\":\n-            var cyclicHandler = resolveBlockedCycle(value, reference);\n-            if (null !== cyclicHandler) {\n-              value = cyclicHandler.value;\n-              continue;\n-            }\n-          case \"pending\":\n-            path.splice(0, i - 1);\n-            null === value.value\n-              ? (value.value = [reference])\n-              : value.value.push(reference);\n-            null === value.reason\n-              ? (value.reason = [reference])\n-              : value.reason.push(reference);\n-            return;\n-          case \"halted\":\n-            return;\n-          default:\n-            rejectReference(response, reference.handler, value.reason);\n-            return;\n         }\n+        break;\n       }\n-    value = value[path[i]];\n-  }\n-  for (\n-    ;\n-    \"object\" === typeof value &&\n-    null !== value &&\n-    value.$$typeof === REACT_LAZY_TYPE;\n-\n-  )\n-    if (((reference = value._payload), reference === handler.chunk))\n-      value = handler.value;\n-    else {\n-      switch (reference.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(reference);\n-          break;\n-        case \"resolved_module\":\n-          initializeModuleChunk(reference);\n-      }\n-      switch (reference.status) {\n-        case \"fulfilled\":\n-          value = reference.value;\n-          continue;\n-      }\n-      break;\n     }\n-  map = map(response, value, parentObject, key);\n-  parentObject[key] = map;\n-  \"\" === key && null === handler.value && (handler.value = map);\n-  if (\n-    parentObject[0] === REACT_ELEMENT_TYPE &&\n-    \"object\" === typeof handler.value &&\n-    null !== handler.value &&\n-    handler.value.$$typeof === REACT_ELEMENT_TYPE\n-  )\n-    switch (((parentObject = handler.value), key)) {\n-      case \"3\":\n-        parentObject.props = map;\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+    if (\n+      parentObject[0] === REACT_ELEMENT_TYPE &&\n+      \"object\" === typeof handler.value &&\n+      null !== handler.value &&\n+      handler.value.$$typeof === REACT_ELEMENT_TYPE\n+    ) {\n+      var element = handler.value;\n+      switch (key) {\n+        case \"3\":\n+          element.props = mappedValue;\n+      }\n     }\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n+  }\n   handler.deps--;\n   0 === handler.deps &&\n-    ((key = handler.chunk),\n-    null !== key &&\n-      \"blocked\" === key.status &&\n-      ((parentObject = key.value),\n-      (key.status = \"fulfilled\"),\n-      (key.value = handler.value),\n-      (key.reason = handler.reason),\n-      null !== parentObject &&\n-        wakeChunk(response, parentObject, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value, reference)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -993,7 +1017,9 @@ function loadServerReference(response, metaData, parentObject, key) {\n           ((boundArgs = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n-          null !== boundArgs && wakeChunk(response, boundArgs, handler.value)));\n+          (resolvedValue.reason = null),\n+          null !== boundArgs &&\n+            wakeChunk(response, boundArgs, handler.value, resolvedValue)));\n     },\n     function (error) {\n       if (!handler.errored) {\n@@ -1198,7 +1224,7 @@ function parseModelString(response, parentObject, key, value) {\n         );\n       case \"S\":\n         return Symbol.for(value.slice(2));\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(\n@@ -1337,12 +1363,13 @@ function resolveStream(response, id, stream, controller) {\n       (chunk.status = \"fulfilled\"),\n       (chunk.value = stream),\n       (chunk.reason = controller),\n-      null !== id && wakeChunk(response, id, chunk.value))\n+      null !== id && wakeChunk(response, id, chunk.value, chunk))\n     : ((response = new ReactPromise(\"fulfilled\", stream, controller)),\n       chunks.set(id, response));\n }\n function startReadableStream(response, id, type) {\n-  var controller = null;\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -1392,24 +1419,27 @@ function startReadableStream(response, id, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n }\n@@ -1463,6 +1493,7 @@ function startAsyncIterable(response, id, iterator) {\n             rejectListeners = chunk.reason;\n           chunk.status = \"fulfilled\";\n           chunk.value = { done: !1, value: value };\n+          chunk.reason = null;\n           null !== resolveListeners &&\n             wakeChunkIfInitialized(\n               response,\n@@ -1489,36 +1520,46 @@ function startAsyncIterable(response, id, iterator) {\n         nextWriteIndex++;\n       },\n       close: function (value) {\n-        closed = !0;\n-        nextWriteIndex === buffer.length\n-          ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-              response,\n-              value,\n-              !0\n-            ))\n-          : resolveIteratorResultChunk(\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length\n+                ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                    response,\n+                    value,\n+                    !0\n+                  ))\n+                : resolveIteratorResultChunk(\n+                    response,\n+                    buffer[nextWriteIndex],\n+                    value,\n+                    !0\n+                  ),\n+              nextWriteIndex++;\n+            nextWriteIndex < buffer.length;\n+\n+          )\n+            resolveIteratorResultChunk(\n               response,\n-              buffer[nextWriteIndex],\n-              value,\n+              buffer[nextWriteIndex++],\n+              '\"$undefined\"',\n               !0\n             );\n-        for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-          resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex++],\n-            '\"$undefined\"',\n-            !0\n-          );\n       },\n       error: function (error) {\n-        closed = !0;\n-        for (\n-          nextWriteIndex === buffer.length &&\n-          (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-          nextWriteIndex < buffer.length;\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length &&\n+                (buffer[nextWriteIndex] = new ReactPromise(\n+                  \"pending\",\n+                  null,\n+                  null\n+                ));\n+            nextWriteIndex < buffer.length;\n \n-        )\n-          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+          )\n+            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n       }\n     }\n   );"
        },
        {
            "sha": "5950f374b7ed849ad16835232792f2a14fa8230b",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-client.edge.development.js",
            "status": "modified",
            "additions": 180,
            "deletions": 146,
            "changes": 326,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -513,13 +513,23 @@\n                 pendingParts--;\n               }\n           }\n+          parentReference = writtenObjects.get(value);\n           if (\"function\" === typeof value.then) {\n+            if (void 0 !== parentReference)\n+              if (modelRoot === value) modelRoot = null;\n+              else return parentReference;\n             null === formData && (formData = new FormData());\n             pendingParts++;\n             var promiseId = nextPartId++;\n+            key = \"$@\" + promiseId.toString(16);\n+            writtenObjects.set(value, key);\n             value.then(function (partValue) {\n               try {\n-                var _partJSON3 = serializeModel(partValue, promiseId);\n+                var previousReference = writtenObjects.get(partValue);\n+                var _partJSON3 =\n+                  void 0 !== previousReference\n+                    ? JSON.stringify(previousReference)\n+                    : serializeModel(partValue, promiseId);\n                 partValue = formData;\n                 partValue.append(formFieldPrefix + promiseId, _partJSON3);\n                 pendingParts--;\n@@ -528,9 +538,8 @@\n                 reject(reason);\n               }\n             }, reject);\n-            return \"$@\" + promiseId.toString(16);\n+            return key;\n           }\n-          parentReference = writtenObjects.get(value);\n           if (void 0 !== parentReference)\n             if (modelRoot === value) modelRoot = null;\n             else return parentReference;\n@@ -688,7 +697,7 @@\n               null === formData && (formData = new FormData()),\n               (parentReference = nextPartId++),\n               formData.set(formFieldPrefix + parentReference, key),\n-              \"$F\" + parentReference.toString(16)\n+              \"$h\" + parentReference.toString(16)\n             );\n           if (\n             void 0 !== temporaryReferences &&\n@@ -1880,6 +1889,7 @@\n           rejectListeners = chunk.reason;\n         chunk.status = \"resolved_module\";\n         chunk.value = value;\n+        chunk.reason = null;\n         value = [];\n         null !== value && chunk._debugInfo.push.apply(chunk._debugInfo, value);\n         null !== resolveListeners &&\n@@ -2009,8 +2019,11 @@\n         response._closed = !0;\n         response._closedReason = error;\n         response._chunks.forEach(function (chunk) {\n-          \"pending\" === chunk.status &&\n-            triggerErrorOnChunk(response, chunk, error);\n+          \"pending\" === chunk.status\n+            ? triggerErrorOnChunk(response, chunk, error)\n+            : \"fulfilled\" === chunk.status &&\n+              null !== chunk.reason &&\n+              chunk.reason.error(error);\n         });\n         weakResponse = response._debugChannel;\n         void 0 !== weakResponse &&\n@@ -2115,125 +2128,136 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value, fulfilledChunk) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          for (\n+            ;\n+            \"object\" === typeof value &&\n+            null !== value &&\n+            value.$$typeof === REACT_LAZY_TYPE;\n+\n+          ) {\n+            var referencedChunk = value._payload;\n+            if (referencedChunk === handler.chunk) value = handler.value;\n+            else {\n+              switch (referencedChunk.status) {\n+                case \"resolved_model\":\n+                  initializeModelChunk(referencedChunk);\n+                  break;\n+                case \"resolved_module\":\n+                  initializeModuleChunk(referencedChunk);\n+              }\n+              switch (referencedChunk.status) {\n+                case \"fulfilled\":\n+                  value = referencedChunk.value;\n+                  continue;\n+                case \"blocked\":\n+                  var cyclicHandler = resolveBlockedCycle(\n+                    referencedChunk,\n+                    reference\n+                  );\n+                  if (null !== cyclicHandler) {\n+                    value = cyclicHandler.value;\n+                    continue;\n+                  }\n+                case \"pending\":\n+                  path.splice(0, i - 1);\n+                  null === referencedChunk.value\n+                    ? (referencedChunk.value = [reference])\n+                    : referencedChunk.value.push(reference);\n+                  null === referencedChunk.reason\n+                    ? (referencedChunk.reason = [reference])\n+                    : referencedChunk.reason.push(reference);\n+                  return;\n+                case \"halted\":\n+                  return;\n+                default:\n+                  rejectReference(\n+                    response,\n+                    reference.handler,\n+                    referencedChunk.reason\n+                  );\n+                  return;\n+              }\n+            }\n+          }\n+          value = value[path[i]];\n+        }\n         for (\n           ;\n           \"object\" === typeof value &&\n           null !== value &&\n           value.$$typeof === REACT_LAZY_TYPE;\n \n-        )\n-          if (((value = value._payload), value === handler.chunk))\n-            value = handler.value;\n+        ) {\n+          var _referencedChunk = value._payload;\n+          if (_referencedChunk === handler.chunk) value = handler.value;\n           else {\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"resolved_model\":\n-                initializeModelChunk(value);\n+                initializeModelChunk(_referencedChunk);\n                 break;\n               case \"resolved_module\":\n-                initializeModuleChunk(value);\n+                initializeModuleChunk(_referencedChunk);\n             }\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"fulfilled\":\n-                value = value.value;\n+                value = _referencedChunk.value;\n                 continue;\n-              case \"blocked\":\n-                var cyclicHandler = resolveBlockedCycle(value, reference);\n-                if (null !== cyclicHandler) {\n-                  value = cyclicHandler.value;\n-                  continue;\n-                }\n-              case \"pending\":\n-                path.splice(0, i - 1);\n-                null === value.value\n-                  ? (value.value = [reference])\n-                  : value.value.push(reference);\n-                null === value.reason\n-                  ? (value.reason = [reference])\n-                  : value.reason.push(reference);\n-                return;\n-              case \"halted\":\n-                return;\n-              default:\n-                rejectReference(response, reference.handler, value.reason);\n-                return;\n             }\n+            break;\n           }\n-        value = value[path[i]];\n-      }\n-      for (\n-        ;\n-        \"object\" === typeof value &&\n-        null !== value &&\n-        value.$$typeof === REACT_LAZY_TYPE;\n-\n-      )\n-        if (((path = value._payload), path === handler.chunk))\n-          value = handler.value;\n-        else {\n-          switch (path.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(path);\n+        }\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+        if (\n+          parentObject[0] === REACT_ELEMENT_TYPE &&\n+          \"object\" === typeof handler.value &&\n+          null !== handler.value &&\n+          handler.value.$$typeof === REACT_ELEMENT_TYPE\n+        ) {\n+          var element = handler.value;\n+          switch (key) {\n+            case \"3\":\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+              element.props = mappedValue;\n               break;\n-            case \"resolved_module\":\n-              initializeModuleChunk(path);\n-          }\n-          switch (path.status) {\n-            case \"fulfilled\":\n-              value = path.value;\n-              continue;\n+            case \"4\":\n+              element._owner = mappedValue;\n+              break;\n+            case \"5\":\n+              element._debugStack = mappedValue;\n+              break;\n+            default:\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n           }\n-          break;\n-        }\n-      map = map(response, value, parentObject, key);\n-      parentObject[key] = map;\n-      \"\" === key && null === handler.value && (handler.value = map);\n-      if (\n-        parentObject[0] === REACT_ELEMENT_TYPE &&\n-        \"object\" === typeof handler.value &&\n-        null !== handler.value &&\n-        handler.value.$$typeof === REACT_ELEMENT_TYPE\n-      )\n-        switch (((reference = handler.value), key)) {\n-          case \"3\":\n-            transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-            reference.props = map;\n-            break;\n-          case \"4\":\n-            reference._owner = map;\n-            break;\n-          case \"5\":\n-            reference._debugStack = map;\n-            break;\n-          default:\n+        } else\n+          reference.isDebug ||\n             transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-        }\n-      else\n-        reference.isDebug ||\n-          transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n+      }\n       handler.deps--;\n       0 === handler.deps &&\n-        ((fulfilledChunk = handler.chunk),\n-        null !== fulfilledChunk &&\n-          \"blocked\" === fulfilledChunk.status &&\n-          ((key = fulfilledChunk.value),\n-          (fulfilledChunk.status = \"fulfilled\"),\n-          (fulfilledChunk.value = handler.value),\n-          (fulfilledChunk.reason = handler.reason),\n-          null !== key\n-            ? wakeChunk(response, key, handler.value, fulfilledChunk)\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value\n+            ? wakeChunk(response, value, handler.value, reference)\n             : ((handler = handler.value),\n-              filterDebugInfo(response, fulfilledChunk),\n-              moveDebugInfoFromChunkToInnerValue(fulfilledChunk, handler))));\n+              filterDebugInfo(response, reference),\n+              moveDebugInfoFromChunkToInnerValue(reference, handler))));\n     }\n     function rejectReference(response, handler, error) {\n       if (!handler.errored) {\n@@ -2385,6 +2409,7 @@\n               ((boundArgs = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== boundArgs\n                 ? wakeChunk(response, boundArgs, handler.value, resolvedValue)\n                 : ((boundArgs = handler.value),\n@@ -2710,7 +2735,7 @@\n             );\n           case \"S\":\n             return Symbol.for(value.slice(2));\n-          case \"F\":\n+          case \"h\":\n             var ref = value.slice(2);\n             return getOutlinedModel(\n               response,\n@@ -3073,7 +3098,8 @@\n           chunks.set(id, stream);\n     }\n     function startReadableStream(response, id, type, streamState) {\n-      var controller = null;\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -3128,24 +3154,28 @@\n             }\n           },\n           close: function () {\n-            if (null === previousBlockedChunk) controller.close();\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.close();\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.close();\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.close();\n+                });\n+              }\n           },\n           error: function (error) {\n-            if (null === previousBlockedChunk) controller.error(error);\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.error(error);\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.error(error);\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.error(error);\n+                });\n+              }\n           }\n         },\n         streamState\n@@ -3201,6 +3231,7 @@\n                 rejectListeners = chunk.reason;\n               chunk.status = \"fulfilled\";\n               chunk.value = { done: !1, value: value };\n+              chunk.reason = null;\n               null !== resolveListeners &&\n                 wakeChunkIfInitialized(\n                   response,\n@@ -3227,36 +3258,39 @@\n             nextWriteIndex++;\n           },\n           close: function (value) {\n-            closed = !0;\n-            nextWriteIndex === buffer.length\n-              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                  response,\n-                  value,\n-                  !0\n-                ))\n-              : resolveIteratorResultChunk(\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length\n+                    ? (buffer[nextWriteIndex] =\n+                        createResolvedIteratorResultChunk(response, value, !0))\n+                    : resolveIteratorResultChunk(\n+                        response,\n+                        buffer[nextWriteIndex],\n+                        value,\n+                        !0\n+                      ),\n+                  nextWriteIndex++;\n+                nextWriteIndex < buffer.length;\n+\n+              )\n+                resolveIteratorResultChunk(\n                   response,\n-                  buffer[nextWriteIndex],\n-                  value,\n+                  buffer[nextWriteIndex++],\n+                  '\"$undefined\"',\n                   !0\n                 );\n-            for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-              resolveIteratorResultChunk(\n-                response,\n-                buffer[nextWriteIndex++],\n-                '\"$undefined\"',\n-                !0\n-              );\n           },\n           error: function (error) {\n-            closed = !0;\n-            for (\n-              nextWriteIndex === buffer.length &&\n-              (buffer[nextWriteIndex] = createPendingChunk(response));\n-              nextWriteIndex < buffer.length;\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length &&\n+                    (buffer[nextWriteIndex] = createPendingChunk(response));\n+                nextWriteIndex < buffer.length;\n \n-            )\n-              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+              )\n+                triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n           }\n         },\n         streamState"
        },
        {
            "sha": "58ab74ad57a20e03c7be8078e447897e6966c82f",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-client.edge.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -313,13 +313,23 @@ function processReply(\n             pendingParts--;\n           }\n       }\n+      parentReference = writtenObjects.get(value);\n       if (\"function\" === typeof value.then) {\n+        if (void 0 !== parentReference)\n+          if (modelRoot === value) modelRoot = null;\n+          else return parentReference;\n         null === formData && (formData = new FormData());\n         pendingParts++;\n         var promiseId = nextPartId++;\n+        key = \"$@\" + promiseId.toString(16);\n+        writtenObjects.set(value, key);\n         value.then(function (partValue) {\n           try {\n-            var partJSON$27 = serializeModel(partValue, promiseId);\n+            var previousReference = writtenObjects.get(partValue);\n+            var partJSON$27 =\n+              void 0 !== previousReference\n+                ? JSON.stringify(previousReference)\n+                : serializeModel(partValue, promiseId);\n             partValue = formData;\n             partValue.append(formFieldPrefix + promiseId, partJSON$27);\n             pendingParts--;\n@@ -328,9 +338,8 @@ function processReply(\n             reject(reason);\n           }\n         }, reject);\n-        return \"$@\" + promiseId.toString(16);\n+        return key;\n       }\n-      parentReference = writtenObjects.get(value);\n       if (void 0 !== parentReference)\n         if (modelRoot === value) modelRoot = null;\n         else return parentReference;\n@@ -454,7 +463,7 @@ function processReply(\n           null === formData && (formData = new FormData()),\n           (parentReference = nextPartId++),\n           formData.set(formFieldPrefix + parentReference, key),\n-          \"$F\" + parentReference.toString(16)\n+          \"$h\" + parentReference.toString(16)\n         );\n       if (\n         void 0 !== temporaryReferences &&\n@@ -738,12 +747,12 @@ function readChunk(chunk) {\n       throw chunk.reason;\n   }\n }\n-function wakeChunk(response, listeners, value) {\n+function wakeChunk(response, listeners, value, chunk) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n     \"function\" === typeof listener\n       ? listener(value)\n-      : fulfillReference(response, listener, value);\n+      : fulfillReference(response, listener, value, chunk);\n   }\n }\n function rejectChunk(response, listeners, error) {\n@@ -783,7 +792,7 @@ function wakeChunkIfInitialized(\n ) {\n   switch (chunk.status) {\n     case \"fulfilled\":\n-      wakeChunk(response, resolveListeners, chunk.value);\n+      wakeChunk(response, resolveListeners, chunk.value, chunk);\n       break;\n     case \"blocked\":\n       for (var i = 0; i < resolveListeners.length; i++) {\n@@ -792,7 +801,7 @@ function wakeChunkIfInitialized(\n           var cyclicHandler = resolveBlockedCycle(chunk, listener);\n           if (null !== cyclicHandler)\n             switch (\n-              (fulfillReference(response, listener, cyclicHandler.value),\n+              (fulfillReference(response, listener, cyclicHandler.value, chunk),\n               resolveListeners.splice(i, 1),\n               i--,\n               null !== rejectListeners &&\n@@ -801,7 +810,7 @@ function wakeChunkIfInitialized(\n               chunk.status)\n             ) {\n               case \"fulfilled\":\n-                wakeChunk(response, resolveListeners, chunk.value);\n+                wakeChunk(response, resolveListeners, chunk.value, chunk);\n                 return;\n               case \"rejected\":\n                 null !== rejectListeners &&\n@@ -877,6 +886,7 @@ function resolveModuleChunk(response, chunk, value) {\n       rejectListeners = chunk.reason;\n     chunk.status = \"resolved_module\";\n     chunk.value = value;\n+    chunk.reason = null;\n     null !== resolveListeners &&\n       (initializeModuleChunk(chunk),\n       wakeChunkIfInitialized(\n@@ -939,8 +949,11 @@ function reportGlobalError(weakResponse, error) {\n   weakResponse._closed = !0;\n   weakResponse._closedReason = error;\n   weakResponse._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status &&\n-      triggerErrorOnChunk(weakResponse, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(weakResponse, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function createLazyChunkWrapper(chunk) {\n@@ -957,109 +970,120 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      for (\n+        ;\n+        \"object\" === typeof value &&\n+        null !== value &&\n+        value.$$typeof === REACT_LAZY_TYPE;\n+\n+      ) {\n+        var referencedChunk = value._payload;\n+        if (referencedChunk === handler.chunk) value = handler.value;\n+        else {\n+          switch (referencedChunk.status) {\n+            case \"resolved_model\":\n+              initializeModelChunk(referencedChunk);\n+              break;\n+            case \"resolved_module\":\n+              initializeModuleChunk(referencedChunk);\n+          }\n+          switch (referencedChunk.status) {\n+            case \"fulfilled\":\n+              value = referencedChunk.value;\n+              continue;\n+            case \"blocked\":\n+              var cyclicHandler = resolveBlockedCycle(\n+                referencedChunk,\n+                reference\n+              );\n+              if (null !== cyclicHandler) {\n+                value = cyclicHandler.value;\n+                continue;\n+              }\n+            case \"pending\":\n+              path.splice(0, i - 1);\n+              null === referencedChunk.value\n+                ? (referencedChunk.value = [reference])\n+                : referencedChunk.value.push(reference);\n+              null === referencedChunk.reason\n+                ? (referencedChunk.reason = [reference])\n+                : referencedChunk.reason.push(reference);\n+              return;\n+            case \"halted\":\n+              return;\n+            default:\n+              rejectReference(\n+                response,\n+                reference.handler,\n+                referencedChunk.reason\n+              );\n+              return;\n+          }\n+        }\n+      }\n+      value = value[path[i]];\n+    }\n     for (\n       ;\n       \"object\" === typeof value &&\n       null !== value &&\n       value.$$typeof === REACT_LAZY_TYPE;\n \n-    )\n-      if (((value = value._payload), value === handler.chunk))\n-        value = handler.value;\n+    ) {\n+      var referencedChunk$43 = value._payload;\n+      if (referencedChunk$43 === handler.chunk) value = handler.value;\n       else {\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"resolved_model\":\n-            initializeModelChunk(value);\n+            initializeModelChunk(referencedChunk$43);\n             break;\n           case \"resolved_module\":\n-            initializeModuleChunk(value);\n+            initializeModuleChunk(referencedChunk$43);\n         }\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"fulfilled\":\n-            value = value.value;\n+            value = referencedChunk$43.value;\n             continue;\n-          case \"blocked\":\n-            var cyclicHandler = resolveBlockedCycle(value, reference);\n-            if (null !== cyclicHandler) {\n-              value = cyclicHandler.value;\n-              continue;\n-            }\n-          case \"pending\":\n-            path.splice(0, i - 1);\n-            null === value.value\n-              ? (value.value = [reference])\n-              : value.value.push(reference);\n-            null === value.reason\n-              ? (value.reason = [reference])\n-              : value.reason.push(reference);\n-            return;\n-          case \"halted\":\n-            return;\n-          default:\n-            rejectReference(response, reference.handler, value.reason);\n-            return;\n         }\n+        break;\n       }\n-    value = value[path[i]];\n-  }\n-  for (\n-    ;\n-    \"object\" === typeof value &&\n-    null !== value &&\n-    value.$$typeof === REACT_LAZY_TYPE;\n-\n-  )\n-    if (((reference = value._payload), reference === handler.chunk))\n-      value = handler.value;\n-    else {\n-      switch (reference.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(reference);\n-          break;\n-        case \"resolved_module\":\n-          initializeModuleChunk(reference);\n-      }\n-      switch (reference.status) {\n-        case \"fulfilled\":\n-          value = reference.value;\n-          continue;\n-      }\n-      break;\n     }\n-  map = map(response, value, parentObject, key);\n-  parentObject[key] = map;\n-  \"\" === key && null === handler.value && (handler.value = map);\n-  if (\n-    parentObject[0] === REACT_ELEMENT_TYPE &&\n-    \"object\" === typeof handler.value &&\n-    null !== handler.value &&\n-    handler.value.$$typeof === REACT_ELEMENT_TYPE\n-  )\n-    switch (((parentObject = handler.value), key)) {\n-      case \"3\":\n-        parentObject.props = map;\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+    if (\n+      parentObject[0] === REACT_ELEMENT_TYPE &&\n+      \"object\" === typeof handler.value &&\n+      null !== handler.value &&\n+      handler.value.$$typeof === REACT_ELEMENT_TYPE\n+    ) {\n+      var element = handler.value;\n+      switch (key) {\n+        case \"3\":\n+          element.props = mappedValue;\n+      }\n     }\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n+  }\n   handler.deps--;\n   0 === handler.deps &&\n-    ((key = handler.chunk),\n-    null !== key &&\n-      \"blocked\" === key.status &&\n-      ((parentObject = key.value),\n-      (key.status = \"fulfilled\"),\n-      (key.value = handler.value),\n-      (key.reason = handler.reason),\n-      null !== parentObject &&\n-        wakeChunk(response, parentObject, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value, reference)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -1177,7 +1201,9 @@ function loadServerReference(response, metaData, parentObject, key) {\n           ((boundArgs = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n-          null !== boundArgs && wakeChunk(response, boundArgs, handler.value)));\n+          (resolvedValue.reason = null),\n+          null !== boundArgs &&\n+            wakeChunk(response, boundArgs, handler.value, resolvedValue)));\n     },\n     function (error) {\n       if (!handler.errored) {\n@@ -1382,7 +1408,7 @@ function parseModelString(response, parentObject, key, value) {\n         );\n       case \"S\":\n         return Symbol.for(value.slice(2));\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(\n@@ -1526,12 +1552,13 @@ function resolveStream(response, id, stream, controller) {\n       (chunk.status = \"fulfilled\"),\n       (chunk.value = stream),\n       (chunk.reason = controller),\n-      null !== id && wakeChunk(response, id, chunk.value))\n+      null !== id && wakeChunk(response, id, chunk.value, chunk))\n     : ((response = new ReactPromise(\"fulfilled\", stream, controller)),\n       chunks.set(id, response));\n }\n function startReadableStream(response, id, type) {\n-  var controller = null;\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -1581,24 +1608,27 @@ function startReadableStream(response, id, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n }\n@@ -1652,6 +1682,7 @@ function startAsyncIterable(response, id, iterator) {\n             rejectListeners = chunk.reason;\n           chunk.status = \"fulfilled\";\n           chunk.value = { done: !1, value: value };\n+          chunk.reason = null;\n           null !== resolveListeners &&\n             wakeChunkIfInitialized(\n               response,\n@@ -1678,36 +1709,46 @@ function startAsyncIterable(response, id, iterator) {\n         nextWriteIndex++;\n       },\n       close: function (value) {\n-        closed = !0;\n-        nextWriteIndex === buffer.length\n-          ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-              response,\n-              value,\n-              !0\n-            ))\n-          : resolveIteratorResultChunk(\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length\n+                ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                    response,\n+                    value,\n+                    !0\n+                  ))\n+                : resolveIteratorResultChunk(\n+                    response,\n+                    buffer[nextWriteIndex],\n+                    value,\n+                    !0\n+                  ),\n+              nextWriteIndex++;\n+            nextWriteIndex < buffer.length;\n+\n+          )\n+            resolveIteratorResultChunk(\n               response,\n-              buffer[nextWriteIndex],\n-              value,\n+              buffer[nextWriteIndex++],\n+              '\"$undefined\"',\n               !0\n             );\n-        for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-          resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex++],\n-            '\"$undefined\"',\n-            !0\n-          );\n       },\n       error: function (error) {\n-        closed = !0;\n-        for (\n-          nextWriteIndex === buffer.length &&\n-          (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-          nextWriteIndex < buffer.length;\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length &&\n+                (buffer[nextWriteIndex] = new ReactPromise(\n+                  \"pending\",\n+                  null,\n+                  null\n+                ));\n+            nextWriteIndex < buffer.length;\n \n-        )\n-          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+          )\n+            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n       }\n     }\n   );"
        },
        {
            "sha": "0b20360fd07654d4d6c2ff32836edc8f5003d34d",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-client.node.development.js",
            "status": "modified",
            "additions": 180,
            "deletions": 146,
            "changes": 326,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -513,13 +513,23 @@\n                 pendingParts--;\n               }\n           }\n+          parentReference = writtenObjects.get(value);\n           if (\"function\" === typeof value.then) {\n+            if (void 0 !== parentReference)\n+              if (modelRoot === value) modelRoot = null;\n+              else return parentReference;\n             null === formData && (formData = new FormData());\n             pendingParts++;\n             var promiseId = nextPartId++;\n+            key = \"$@\" + promiseId.toString(16);\n+            writtenObjects.set(value, key);\n             value.then(function (partValue) {\n               try {\n-                var _partJSON3 = serializeModel(partValue, promiseId);\n+                var previousReference = writtenObjects.get(partValue);\n+                var _partJSON3 =\n+                  void 0 !== previousReference\n+                    ? JSON.stringify(previousReference)\n+                    : serializeModel(partValue, promiseId);\n                 partValue = formData;\n                 partValue.append(formFieldPrefix + promiseId, _partJSON3);\n                 pendingParts--;\n@@ -528,9 +538,8 @@\n                 reject(reason);\n               }\n             }, reject);\n-            return \"$@\" + promiseId.toString(16);\n+            return key;\n           }\n-          parentReference = writtenObjects.get(value);\n           if (void 0 !== parentReference)\n             if (modelRoot === value) modelRoot = null;\n             else return parentReference;\n@@ -688,7 +697,7 @@\n               null === formData && (formData = new FormData()),\n               (parentReference = nextPartId++),\n               formData.set(formFieldPrefix + parentReference, key),\n-              \"$F\" + parentReference.toString(16)\n+              \"$h\" + parentReference.toString(16)\n             );\n           if (\n             void 0 !== temporaryReferences &&\n@@ -1880,6 +1889,7 @@\n           rejectListeners = chunk.reason;\n         chunk.status = \"resolved_module\";\n         chunk.value = value;\n+        chunk.reason = null;\n         value = [];\n         null !== value && chunk._debugInfo.push.apply(chunk._debugInfo, value);\n         null !== resolveListeners &&\n@@ -2009,8 +2019,11 @@\n         response._closed = !0;\n         response._closedReason = error;\n         response._chunks.forEach(function (chunk) {\n-          \"pending\" === chunk.status &&\n-            triggerErrorOnChunk(response, chunk, error);\n+          \"pending\" === chunk.status\n+            ? triggerErrorOnChunk(response, chunk, error)\n+            : \"fulfilled\" === chunk.status &&\n+              null !== chunk.reason &&\n+              chunk.reason.error(error);\n         });\n         weakResponse = response._debugChannel;\n         void 0 !== weakResponse &&\n@@ -2115,125 +2128,136 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value, fulfilledChunk) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          for (\n+            ;\n+            \"object\" === typeof value &&\n+            null !== value &&\n+            value.$$typeof === REACT_LAZY_TYPE;\n+\n+          ) {\n+            var referencedChunk = value._payload;\n+            if (referencedChunk === handler.chunk) value = handler.value;\n+            else {\n+              switch (referencedChunk.status) {\n+                case \"resolved_model\":\n+                  initializeModelChunk(referencedChunk);\n+                  break;\n+                case \"resolved_module\":\n+                  initializeModuleChunk(referencedChunk);\n+              }\n+              switch (referencedChunk.status) {\n+                case \"fulfilled\":\n+                  value = referencedChunk.value;\n+                  continue;\n+                case \"blocked\":\n+                  var cyclicHandler = resolveBlockedCycle(\n+                    referencedChunk,\n+                    reference\n+                  );\n+                  if (null !== cyclicHandler) {\n+                    value = cyclicHandler.value;\n+                    continue;\n+                  }\n+                case \"pending\":\n+                  path.splice(0, i - 1);\n+                  null === referencedChunk.value\n+                    ? (referencedChunk.value = [reference])\n+                    : referencedChunk.value.push(reference);\n+                  null === referencedChunk.reason\n+                    ? (referencedChunk.reason = [reference])\n+                    : referencedChunk.reason.push(reference);\n+                  return;\n+                case \"halted\":\n+                  return;\n+                default:\n+                  rejectReference(\n+                    response,\n+                    reference.handler,\n+                    referencedChunk.reason\n+                  );\n+                  return;\n+              }\n+            }\n+          }\n+          value = value[path[i]];\n+        }\n         for (\n           ;\n           \"object\" === typeof value &&\n           null !== value &&\n           value.$$typeof === REACT_LAZY_TYPE;\n \n-        )\n-          if (((value = value._payload), value === handler.chunk))\n-            value = handler.value;\n+        ) {\n+          var _referencedChunk = value._payload;\n+          if (_referencedChunk === handler.chunk) value = handler.value;\n           else {\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"resolved_model\":\n-                initializeModelChunk(value);\n+                initializeModelChunk(_referencedChunk);\n                 break;\n               case \"resolved_module\":\n-                initializeModuleChunk(value);\n+                initializeModuleChunk(_referencedChunk);\n             }\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"fulfilled\":\n-                value = value.value;\n+                value = _referencedChunk.value;\n                 continue;\n-              case \"blocked\":\n-                var cyclicHandler = resolveBlockedCycle(value, reference);\n-                if (null !== cyclicHandler) {\n-                  value = cyclicHandler.value;\n-                  continue;\n-                }\n-              case \"pending\":\n-                path.splice(0, i - 1);\n-                null === value.value\n-                  ? (value.value = [reference])\n-                  : value.value.push(reference);\n-                null === value.reason\n-                  ? (value.reason = [reference])\n-                  : value.reason.push(reference);\n-                return;\n-              case \"halted\":\n-                return;\n-              default:\n-                rejectReference(response, reference.handler, value.reason);\n-                return;\n             }\n+            break;\n           }\n-        value = value[path[i]];\n-      }\n-      for (\n-        ;\n-        \"object\" === typeof value &&\n-        null !== value &&\n-        value.$$typeof === REACT_LAZY_TYPE;\n-\n-      )\n-        if (((path = value._payload), path === handler.chunk))\n-          value = handler.value;\n-        else {\n-          switch (path.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(path);\n+        }\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+        if (\n+          parentObject[0] === REACT_ELEMENT_TYPE &&\n+          \"object\" === typeof handler.value &&\n+          null !== handler.value &&\n+          handler.value.$$typeof === REACT_ELEMENT_TYPE\n+        ) {\n+          var element = handler.value;\n+          switch (key) {\n+            case \"3\":\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+              element.props = mappedValue;\n               break;\n-            case \"resolved_module\":\n-              initializeModuleChunk(path);\n-          }\n-          switch (path.status) {\n-            case \"fulfilled\":\n-              value = path.value;\n-              continue;\n+            case \"4\":\n+              element._owner = mappedValue;\n+              break;\n+            case \"5\":\n+              element._debugStack = mappedValue;\n+              break;\n+            default:\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n           }\n-          break;\n-        }\n-      map = map(response, value, parentObject, key);\n-      parentObject[key] = map;\n-      \"\" === key && null === handler.value && (handler.value = map);\n-      if (\n-        parentObject[0] === REACT_ELEMENT_TYPE &&\n-        \"object\" === typeof handler.value &&\n-        null !== handler.value &&\n-        handler.value.$$typeof === REACT_ELEMENT_TYPE\n-      )\n-        switch (((reference = handler.value), key)) {\n-          case \"3\":\n-            transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-            reference.props = map;\n-            break;\n-          case \"4\":\n-            reference._owner = map;\n-            break;\n-          case \"5\":\n-            reference._debugStack = map;\n-            break;\n-          default:\n+        } else\n+          reference.isDebug ||\n             transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-        }\n-      else\n-        reference.isDebug ||\n-          transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n+      }\n       handler.deps--;\n       0 === handler.deps &&\n-        ((fulfilledChunk = handler.chunk),\n-        null !== fulfilledChunk &&\n-          \"blocked\" === fulfilledChunk.status &&\n-          ((key = fulfilledChunk.value),\n-          (fulfilledChunk.status = \"fulfilled\"),\n-          (fulfilledChunk.value = handler.value),\n-          (fulfilledChunk.reason = handler.reason),\n-          null !== key\n-            ? wakeChunk(response, key, handler.value, fulfilledChunk)\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value\n+            ? wakeChunk(response, value, handler.value, reference)\n             : ((handler = handler.value),\n-              filterDebugInfo(response, fulfilledChunk),\n-              moveDebugInfoFromChunkToInnerValue(fulfilledChunk, handler))));\n+              filterDebugInfo(response, reference),\n+              moveDebugInfoFromChunkToInnerValue(reference, handler))));\n     }\n     function rejectReference(response, handler, error) {\n       if (!handler.errored) {\n@@ -2385,6 +2409,7 @@\n               ((boundArgs = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== boundArgs\n                 ? wakeChunk(response, boundArgs, handler.value, resolvedValue)\n                 : ((boundArgs = handler.value),\n@@ -2710,7 +2735,7 @@\n             );\n           case \"S\":\n             return Symbol.for(value.slice(2));\n-          case \"F\":\n+          case \"h\":\n             var ref = value.slice(2);\n             return getOutlinedModel(\n               response,\n@@ -3093,7 +3118,8 @@\n           chunks.set(id, stream);\n     }\n     function startReadableStream(response, id, type, streamState) {\n-      var controller = null;\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -3148,24 +3174,28 @@\n             }\n           },\n           close: function () {\n-            if (null === previousBlockedChunk) controller.close();\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.close();\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.close();\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.close();\n+                });\n+              }\n           },\n           error: function (error) {\n-            if (null === previousBlockedChunk) controller.error(error);\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.error(error);\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.error(error);\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.error(error);\n+                });\n+              }\n           }\n         },\n         streamState\n@@ -3221,6 +3251,7 @@\n                 rejectListeners = chunk.reason;\n               chunk.status = \"fulfilled\";\n               chunk.value = { done: !1, value: value };\n+              chunk.reason = null;\n               null !== resolveListeners &&\n                 wakeChunkIfInitialized(\n                   response,\n@@ -3247,36 +3278,39 @@\n             nextWriteIndex++;\n           },\n           close: function (value) {\n-            closed = !0;\n-            nextWriteIndex === buffer.length\n-              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                  response,\n-                  value,\n-                  !0\n-                ))\n-              : resolveIteratorResultChunk(\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length\n+                    ? (buffer[nextWriteIndex] =\n+                        createResolvedIteratorResultChunk(response, value, !0))\n+                    : resolveIteratorResultChunk(\n+                        response,\n+                        buffer[nextWriteIndex],\n+                        value,\n+                        !0\n+                      ),\n+                  nextWriteIndex++;\n+                nextWriteIndex < buffer.length;\n+\n+              )\n+                resolveIteratorResultChunk(\n                   response,\n-                  buffer[nextWriteIndex],\n-                  value,\n+                  buffer[nextWriteIndex++],\n+                  '\"$undefined\"',\n                   !0\n                 );\n-            for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-              resolveIteratorResultChunk(\n-                response,\n-                buffer[nextWriteIndex++],\n-                '\"$undefined\"',\n-                !0\n-              );\n           },\n           error: function (error) {\n-            closed = !0;\n-            for (\n-              nextWriteIndex === buffer.length &&\n-              (buffer[nextWriteIndex] = createPendingChunk(response));\n-              nextWriteIndex < buffer.length;\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length &&\n+                    (buffer[nextWriteIndex] = createPendingChunk(response));\n+                nextWriteIndex < buffer.length;\n \n-            )\n-              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+              )\n+                triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n           }\n         },\n         streamState"
        },
        {
            "sha": "c81ea6caa5a1f7eb014e232cc50efb2e7ba98852",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-client.node.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-client.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -314,13 +314,23 @@ function processReply(\n             pendingParts--;\n           }\n       }\n+      parentReference = writtenObjects.get(value);\n       if (\"function\" === typeof value.then) {\n+        if (void 0 !== parentReference)\n+          if (modelRoot === value) modelRoot = null;\n+          else return parentReference;\n         null === formData && (formData = new FormData());\n         pendingParts++;\n         var promiseId = nextPartId++;\n+        key = \"$@\" + promiseId.toString(16);\n+        writtenObjects.set(value, key);\n         value.then(function (partValue) {\n           try {\n-            var partJSON$27 = serializeModel(partValue, promiseId);\n+            var previousReference = writtenObjects.get(partValue);\n+            var partJSON$27 =\n+              void 0 !== previousReference\n+                ? JSON.stringify(previousReference)\n+                : serializeModel(partValue, promiseId);\n             partValue = formData;\n             partValue.append(formFieldPrefix + promiseId, partJSON$27);\n             pendingParts--;\n@@ -329,9 +339,8 @@ function processReply(\n             reject(reason);\n           }\n         }, reject);\n-        return \"$@\" + promiseId.toString(16);\n+        return key;\n       }\n-      parentReference = writtenObjects.get(value);\n       if (void 0 !== parentReference)\n         if (modelRoot === value) modelRoot = null;\n         else return parentReference;\n@@ -455,7 +464,7 @@ function processReply(\n           null === formData && (formData = new FormData()),\n           (parentReference = nextPartId++),\n           formData.set(formFieldPrefix + parentReference, key),\n-          \"$F\" + parentReference.toString(16)\n+          \"$h\" + parentReference.toString(16)\n         );\n       if (\n         void 0 !== temporaryReferences &&\n@@ -739,12 +748,12 @@ function readChunk(chunk) {\n       throw chunk.reason;\n   }\n }\n-function wakeChunk(response, listeners, value) {\n+function wakeChunk(response, listeners, value, chunk) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n     \"function\" === typeof listener\n       ? listener(value)\n-      : fulfillReference(response, listener, value);\n+      : fulfillReference(response, listener, value, chunk);\n   }\n }\n function rejectChunk(response, listeners, error) {\n@@ -784,7 +793,7 @@ function wakeChunkIfInitialized(\n ) {\n   switch (chunk.status) {\n     case \"fulfilled\":\n-      wakeChunk(response, resolveListeners, chunk.value);\n+      wakeChunk(response, resolveListeners, chunk.value, chunk);\n       break;\n     case \"blocked\":\n       for (var i = 0; i < resolveListeners.length; i++) {\n@@ -793,7 +802,7 @@ function wakeChunkIfInitialized(\n           var cyclicHandler = resolveBlockedCycle(chunk, listener);\n           if (null !== cyclicHandler)\n             switch (\n-              (fulfillReference(response, listener, cyclicHandler.value),\n+              (fulfillReference(response, listener, cyclicHandler.value, chunk),\n               resolveListeners.splice(i, 1),\n               i--,\n               null !== rejectListeners &&\n@@ -802,7 +811,7 @@ function wakeChunkIfInitialized(\n               chunk.status)\n             ) {\n               case \"fulfilled\":\n-                wakeChunk(response, resolveListeners, chunk.value);\n+                wakeChunk(response, resolveListeners, chunk.value, chunk);\n                 return;\n               case \"rejected\":\n                 null !== rejectListeners &&\n@@ -878,6 +887,7 @@ function resolveModuleChunk(response, chunk, value) {\n       rejectListeners = chunk.reason;\n     chunk.status = \"resolved_module\";\n     chunk.value = value;\n+    chunk.reason = null;\n     null !== resolveListeners &&\n       (initializeModuleChunk(chunk),\n       wakeChunkIfInitialized(\n@@ -940,8 +950,11 @@ function reportGlobalError(weakResponse, error) {\n   weakResponse._closed = !0;\n   weakResponse._closedReason = error;\n   weakResponse._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status &&\n-      triggerErrorOnChunk(weakResponse, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(weakResponse, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function createLazyChunkWrapper(chunk) {\n@@ -958,109 +971,120 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      for (\n+        ;\n+        \"object\" === typeof value &&\n+        null !== value &&\n+        value.$$typeof === REACT_LAZY_TYPE;\n+\n+      ) {\n+        var referencedChunk = value._payload;\n+        if (referencedChunk === handler.chunk) value = handler.value;\n+        else {\n+          switch (referencedChunk.status) {\n+            case \"resolved_model\":\n+              initializeModelChunk(referencedChunk);\n+              break;\n+            case \"resolved_module\":\n+              initializeModuleChunk(referencedChunk);\n+          }\n+          switch (referencedChunk.status) {\n+            case \"fulfilled\":\n+              value = referencedChunk.value;\n+              continue;\n+            case \"blocked\":\n+              var cyclicHandler = resolveBlockedCycle(\n+                referencedChunk,\n+                reference\n+              );\n+              if (null !== cyclicHandler) {\n+                value = cyclicHandler.value;\n+                continue;\n+              }\n+            case \"pending\":\n+              path.splice(0, i - 1);\n+              null === referencedChunk.value\n+                ? (referencedChunk.value = [reference])\n+                : referencedChunk.value.push(reference);\n+              null === referencedChunk.reason\n+                ? (referencedChunk.reason = [reference])\n+                : referencedChunk.reason.push(reference);\n+              return;\n+            case \"halted\":\n+              return;\n+            default:\n+              rejectReference(\n+                response,\n+                reference.handler,\n+                referencedChunk.reason\n+              );\n+              return;\n+          }\n+        }\n+      }\n+      value = value[path[i]];\n+    }\n     for (\n       ;\n       \"object\" === typeof value &&\n       null !== value &&\n       value.$$typeof === REACT_LAZY_TYPE;\n \n-    )\n-      if (((value = value._payload), value === handler.chunk))\n-        value = handler.value;\n+    ) {\n+      var referencedChunk$43 = value._payload;\n+      if (referencedChunk$43 === handler.chunk) value = handler.value;\n       else {\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"resolved_model\":\n-            initializeModelChunk(value);\n+            initializeModelChunk(referencedChunk$43);\n             break;\n           case \"resolved_module\":\n-            initializeModuleChunk(value);\n+            initializeModuleChunk(referencedChunk$43);\n         }\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"fulfilled\":\n-            value = value.value;\n+            value = referencedChunk$43.value;\n             continue;\n-          case \"blocked\":\n-            var cyclicHandler = resolveBlockedCycle(value, reference);\n-            if (null !== cyclicHandler) {\n-              value = cyclicHandler.value;\n-              continue;\n-            }\n-          case \"pending\":\n-            path.splice(0, i - 1);\n-            null === value.value\n-              ? (value.value = [reference])\n-              : value.value.push(reference);\n-            null === value.reason\n-              ? (value.reason = [reference])\n-              : value.reason.push(reference);\n-            return;\n-          case \"halted\":\n-            return;\n-          default:\n-            rejectReference(response, reference.handler, value.reason);\n-            return;\n         }\n+        break;\n       }\n-    value = value[path[i]];\n-  }\n-  for (\n-    ;\n-    \"object\" === typeof value &&\n-    null !== value &&\n-    value.$$typeof === REACT_LAZY_TYPE;\n-\n-  )\n-    if (((reference = value._payload), reference === handler.chunk))\n-      value = handler.value;\n-    else {\n-      switch (reference.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(reference);\n-          break;\n-        case \"resolved_module\":\n-          initializeModuleChunk(reference);\n-      }\n-      switch (reference.status) {\n-        case \"fulfilled\":\n-          value = reference.value;\n-          continue;\n-      }\n-      break;\n     }\n-  map = map(response, value, parentObject, key);\n-  parentObject[key] = map;\n-  \"\" === key && null === handler.value && (handler.value = map);\n-  if (\n-    parentObject[0] === REACT_ELEMENT_TYPE &&\n-    \"object\" === typeof handler.value &&\n-    null !== handler.value &&\n-    handler.value.$$typeof === REACT_ELEMENT_TYPE\n-  )\n-    switch (((parentObject = handler.value), key)) {\n-      case \"3\":\n-        parentObject.props = map;\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+    if (\n+      parentObject[0] === REACT_ELEMENT_TYPE &&\n+      \"object\" === typeof handler.value &&\n+      null !== handler.value &&\n+      handler.value.$$typeof === REACT_ELEMENT_TYPE\n+    ) {\n+      var element = handler.value;\n+      switch (key) {\n+        case \"3\":\n+          element.props = mappedValue;\n+      }\n     }\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n+  }\n   handler.deps--;\n   0 === handler.deps &&\n-    ((key = handler.chunk),\n-    null !== key &&\n-      \"blocked\" === key.status &&\n-      ((parentObject = key.value),\n-      (key.status = \"fulfilled\"),\n-      (key.value = handler.value),\n-      (key.reason = handler.reason),\n-      null !== parentObject &&\n-        wakeChunk(response, parentObject, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value, reference)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -1178,7 +1202,9 @@ function loadServerReference(response, metaData, parentObject, key) {\n           ((boundArgs = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n-          null !== boundArgs && wakeChunk(response, boundArgs, handler.value)));\n+          (resolvedValue.reason = null),\n+          null !== boundArgs &&\n+            wakeChunk(response, boundArgs, handler.value, resolvedValue)));\n     },\n     function (error) {\n       if (!handler.errored) {\n@@ -1383,7 +1409,7 @@ function parseModelString(response, parentObject, key, value) {\n         );\n       case \"S\":\n         return Symbol.for(value.slice(2));\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(\n@@ -1530,12 +1556,13 @@ function resolveStream(response, id, stream, controller) {\n       (chunk.status = \"fulfilled\"),\n       (chunk.value = stream),\n       (chunk.reason = controller),\n-      null !== id && wakeChunk(response, id, chunk.value))\n+      null !== id && wakeChunk(response, id, chunk.value, chunk))\n     : ((response = new ReactPromise(\"fulfilled\", stream, controller)),\n       chunks.set(id, response));\n }\n function startReadableStream(response, id, type) {\n-  var controller = null;\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -1585,24 +1612,27 @@ function startReadableStream(response, id, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n }\n@@ -1656,6 +1686,7 @@ function startAsyncIterable(response, id, iterator) {\n             rejectListeners = chunk.reason;\n           chunk.status = \"fulfilled\";\n           chunk.value = { done: !1, value: value };\n+          chunk.reason = null;\n           null !== resolveListeners &&\n             wakeChunkIfInitialized(\n               response,\n@@ -1682,36 +1713,46 @@ function startAsyncIterable(response, id, iterator) {\n         nextWriteIndex++;\n       },\n       close: function (value) {\n-        closed = !0;\n-        nextWriteIndex === buffer.length\n-          ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-              response,\n-              value,\n-              !0\n-            ))\n-          : resolveIteratorResultChunk(\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length\n+                ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                    response,\n+                    value,\n+                    !0\n+                  ))\n+                : resolveIteratorResultChunk(\n+                    response,\n+                    buffer[nextWriteIndex],\n+                    value,\n+                    !0\n+                  ),\n+              nextWriteIndex++;\n+            nextWriteIndex < buffer.length;\n+\n+          )\n+            resolveIteratorResultChunk(\n               response,\n-              buffer[nextWriteIndex],\n-              value,\n+              buffer[nextWriteIndex++],\n+              '\"$undefined\"',\n               !0\n             );\n-        for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-          resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex++],\n-            '\"$undefined\"',\n-            !0\n-          );\n       },\n       error: function (error) {\n-        closed = !0;\n-        for (\n-          nextWriteIndex === buffer.length &&\n-          (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-          nextWriteIndex < buffer.length;\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length &&\n+                (buffer[nextWriteIndex] = new ReactPromise(\n+                  \"pending\",\n+                  null,\n+                  null\n+                ));\n+            nextWriteIndex < buffer.length;\n \n-        )\n-          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+          )\n+            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n       }\n     }\n   );"
        },
        {
            "sha": "2c8942305c3da1ad05311fcaf3de39aa76bd98e9",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-server.browser.development.js",
            "status": "modified",
            "additions": 176,
            "deletions": 180,
            "changes": 356,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -2150,7 +2150,7 @@\n     function serializeServerReference(request, serverReference) {\n       var writtenServerReferences = request.writtenServerReferences,\n         existingId = writtenServerReferences.get(serverReference);\n-      if (void 0 !== existingId) return \"$F\" + existingId.toString(16);\n+      if (void 0 !== existingId) return \"$h\" + existingId.toString(16);\n       existingId = serverReference.$$bound;\n       existingId = null === existingId ? null : Promise.resolve(existingId);\n       var id = serverReference.$$id,\n@@ -2176,7 +2176,7 @@\n           : { id: id, bound: existingId };\n       request = outlineModel(request, existingId);\n       writtenServerReferences.set(serverReference, request);\n-      return \"$F\" + request.toString(16);\n+      return \"$h\" + request.toString(16);\n     }\n     function serializeLargeTextString(request, text) {\n       request.pendingChunks++;\n@@ -2572,7 +2572,7 @@\n         if (value instanceof Date) return \"$D\" + value.toJSON();\n         elementReference = getPrototypeOf(value);\n         if (\n-          elementReference !== ObjectPrototype &&\n+          elementReference !== ObjectPrototype$1 &&\n           (null === elementReference ||\n             null !== getPrototypeOf(elementReference))\n         )\n@@ -3173,7 +3173,7 @@\n           return serializeDebugBlob(request, value);\n         if (getIteratorFn(value)) return Array.from(value);\n         request = getPrototypeOf(value);\n-        if (request !== ObjectPrototype && null !== request) {\n+        if (request !== ObjectPrototype$1 && null !== request) {\n           counter = Object.create(null);\n           for (env in value)\n             if (hasOwnProperty.call(value, env) || isGetter(request, env))\n@@ -4135,6 +4135,7 @@\n               ((promiseValue = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== promiseValue &&\n                 wakeChunk(response, promiseValue, handler.value)));\n         },\n@@ -4238,6 +4239,7 @@\n         }\n         chunk.status = \"fulfilled\";\n         chunk.value = value;\n+        chunk.reason = null;\n       } catch (error) {\n         (chunk.status = \"rejected\"), (chunk.reason = error);\n       } finally {\n@@ -4248,8 +4250,11 @@\n       response._closed = !0;\n       response._closedReason = error;\n       response._chunks.forEach(function (chunk) {\n-        \"pending\" === chunk.status &&\n-          triggerErrorOnChunk(response, chunk, error);\n+        \"pending\" === chunk.status\n+          ? triggerErrorOnChunk(response, chunk, error)\n+          : \"fulfilled\" === chunk.status &&\n+            null !== chunk.reason &&\n+            chunk.reason.error(error);\n       });\n     }\n     function getChunk(response, id) {\n@@ -4271,58 +4276,41 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              continue;\n-            case \"blocked\":\n-            case \"pending\":\n-              path.splice(0, i - 1);\n-              null === value.value\n-                ? (value.value = [reference])\n-                : value.value.push(reference);\n-              null === value.reason\n-                ? (value.reason = [reference])\n-                : value.reason.push(reference);\n-              return;\n-            default:\n-              rejectReference(response, reference.handler, value.reason);\n-              return;\n-          }\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          var name = path[i];\n+          if (\n+            \"object\" !== typeof value ||\n+            null === value ||\n+            (getPrototypeOf(value) !== ObjectPrototype &&\n+              getPrototypeOf(value) !== ArrayPrototype) ||\n+            !hasOwnProperty.call(value, name)\n+          )\n+            throw Error(\"Invalid reference.\");\n+          value = value[name];\n         }\n-        var name = path[i];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n       }\n-      reference = map(response, value, parentObject, key);\n-      parentObject[key] = reference;\n-      \"\" === key && null === handler.value && (handler.value = reference);\n       handler.deps--;\n       0 === handler.deps &&\n-        ((parentObject = handler.chunk),\n-        null !== parentObject &&\n-          \"blocked\" === parentObject.status &&\n-          ((key = parentObject.value),\n-          (parentObject.status = \"fulfilled\"),\n-          (parentObject.value = handler.value),\n-          (parentObject.reason = handler.reason),\n-          null !== key && wakeChunk(response, key, handler.value)));\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value && wakeChunk(response, value, handler.value)));\n     }\n     function rejectReference(response, handler, error) {\n       handler.errored ||\n@@ -4334,33 +4322,6 @@\n           \"blocked\" === handler.status &&\n           triggerErrorOnChunk(response, handler, error));\n     }\n-    function waitForReference(\n-      referencedChunk,\n-      parentObject,\n-      key,\n-      response,\n-      map,\n-      path\n-    ) {\n-      initializingHandler\n-        ? ((response = initializingHandler), response.deps++)\n-        : (response = initializingHandler =\n-            { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-      parentObject = {\n-        handler: response,\n-        parentObject: parentObject,\n-        key: key,\n-        map: map,\n-        path: path\n-      };\n-      null === referencedChunk.value\n-        ? (referencedChunk.value = [parentObject])\n-        : referencedChunk.value.push(parentObject);\n-      null === referencedChunk.reason\n-        ? (referencedChunk.reason = [parentObject])\n-        : referencedChunk.reason.push(parentObject);\n-      return null;\n-    }\n     function getOutlinedModel(response, reference, parentObject, key, map) {\n       reference = reference.split(\":\");\n       var id = parseInt(reference[0], 16);\n@@ -4371,59 +4332,47 @@\n       }\n       switch (id.status) {\n         case \"fulfilled\":\n-          var value = id.value;\n-          for (id = 1; id < reference.length; id++) {\n-            for (; value instanceof ReactPromise; ) {\n-              switch (value.status) {\n-                case \"resolved_model\":\n-                  initializeModelChunk(value);\n-              }\n-              switch (value.status) {\n-                case \"fulfilled\":\n-                  value = value.value;\n-                  break;\n-                case \"blocked\":\n-                case \"pending\":\n-                  return waitForReference(\n-                    value,\n-                    parentObject,\n-                    key,\n-                    response,\n-                    map,\n-                    reference.slice(id - 1)\n-                  );\n-                default:\n-                  return (\n-                    initializingHandler\n-                      ? ((initializingHandler.errored = !0),\n-                        (initializingHandler.value = null),\n-                        (initializingHandler.reason = value.reason))\n-                      : (initializingHandler = {\n-                          chunk: null,\n-                          value: null,\n-                          reason: value.reason,\n-                          deps: 0,\n-                          errored: !0\n-                        }),\n-                    null\n-                  );\n-              }\n-            }\n-            var name = reference[id];\n-            \"object\" === typeof value &&\n-              hasOwnProperty.call(value, name) &&\n-              (value = value[name]);\n+          id = id.value;\n+          for (var i = 1; i < reference.length; i++) {\n+            var name = reference[i];\n+            if (\n+              \"object\" !== typeof id ||\n+              null === id ||\n+              (getPrototypeOf(id) !== ObjectPrototype &&\n+                getPrototypeOf(id) !== ArrayPrototype) ||\n+              !hasOwnProperty.call(id, name)\n+            )\n+              throw Error(\"Invalid reference.\");\n+            id = id[name];\n           }\n-          return map(response, value, parentObject, key);\n+          return map(response, id, parentObject, key);\n         case \"pending\":\n         case \"blocked\":\n-          return waitForReference(\n-            id,\n-            parentObject,\n-            key,\n-            response,\n-            map,\n-            reference\n+          return (\n+            initializingHandler\n+              ? ((response = initializingHandler), response.deps++)\n+              : (response = initializingHandler =\n+                  {\n+                    chunk: null,\n+                    value: null,\n+                    reason: null,\n+                    deps: 1,\n+                    errored: !1\n+                  }),\n+            (parentObject = {\n+              handler: response,\n+              parentObject: parentObject,\n+              key: key,\n+              map: map,\n+              path: reference\n+            }),\n+            null === id.value\n+              ? (id.value = [parentObject])\n+              : id.value.push(parentObject),\n+            null === id.reason\n+              ? (id.reason = [parentObject])\n+              : id.reason.push(parentObject),\n+            null\n           );\n         default:\n           return (\n@@ -4463,9 +4412,10 @@\n       parentKey\n     ) {\n       reference = parseInt(reference.slice(2), 16);\n-      reference = response._formData\n-        .get(response._prefix + reference)\n-        .arrayBuffer();\n+      bytesPerElement = response._prefix + reference;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized typed array.\");\n+      reference = response._formData.get(bytesPerElement).arrayBuffer();\n       if (initializingHandler) {\n         var handler = initializingHandler;\n         handler.deps++;\n@@ -4494,6 +4444,7 @@\n             var resolveListeners = buffer.value;\n             buffer.status = \"fulfilled\";\n             buffer.value = handler.value;\n+            buffer.reason = null;\n             null !== resolveListeners &&\n               wakeChunk(response, resolveListeners, handler.value);\n           }\n@@ -4528,7 +4479,10 @@\n     }\n     function parseReadableStream(response, reference, type) {\n       reference = parseInt(reference.slice(2), 16);\n-      var controller = null;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -4575,24 +4529,28 @@\n           }\n         },\n         close: function () {\n-          if (null === previousBlockedChunk) controller.close();\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.close();\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.close();\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.close();\n+              });\n+            }\n         },\n         error: function (error) {\n-          if (null === previousBlockedChunk) controller.error(error);\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.error(error);\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.error(error);\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.error(error);\n+              });\n+            }\n         }\n       });\n       return type;\n@@ -4607,6 +4565,8 @@\n     }\n     function parseAsyncIterable(response, reference, iterator) {\n       reference = parseInt(reference.slice(2), 16);\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n       var buffer = [],\n         closed = !1,\n         nextWriteIndex = 0,\n@@ -4647,36 +4607,46 @@\n           nextWriteIndex++;\n         },\n         close: function (value) {\n-          closed = !0;\n-          nextWriteIndex === buffer.length\n-            ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                response,\n-                value,\n-                !0\n-              ))\n-            : resolveIteratorResultChunk(\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length\n+                  ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                      response,\n+                      value,\n+                      !0\n+                    ))\n+                  : resolveIteratorResultChunk(\n+                      response,\n+                      buffer[nextWriteIndex],\n+                      value,\n+                      !0\n+                    ),\n+                nextWriteIndex++;\n+              nextWriteIndex < buffer.length;\n+\n+            )\n+              resolveIteratorResultChunk(\n                 response,\n-                buffer[nextWriteIndex],\n-                value,\n+                buffer[nextWriteIndex++],\n+                '\"$undefined\"',\n                 !0\n               );\n-          for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-            resolveIteratorResultChunk(\n-              response,\n-              buffer[nextWriteIndex++],\n-              '\"$undefined\"',\n-              !0\n-            );\n         },\n         error: function (error) {\n-          closed = !0;\n-          for (\n-            nextWriteIndex === buffer.length &&\n-            (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-            nextWriteIndex < buffer.length;\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length &&\n+                  (buffer[nextWriteIndex] = new ReactPromise(\n+                    \"pending\",\n+                    null,\n+                    null\n+                  ));\n+              nextWriteIndex < buffer.length;\n \n-          )\n-            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+            )\n+              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n         }\n       });\n       return iterator;\n@@ -4690,7 +4660,7 @@\n             return (\n               (obj = parseInt(value.slice(2), 16)), getChunk(response, obj)\n             );\n-          case \"F\":\n+          case \"h\":\n             return (\n               (value = value.slice(2)),\n               getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -4964,6 +4934,13 @@\n       SERVER_REFERENCE_TAG = Symbol.for(\"react.server.reference\"),\n       FunctionBind = Function.prototype.bind,\n       ArraySlice = Array.prototype.slice,\n+      serverReferenceToString = {\n+        value: function () {\n+          return \"function () { [omitted code] }\";\n+        },\n+        configurable: !0,\n+        writable: !0\n+      },\n       PROMISE_PROTOTYPE = Promise.prototype,\n       deepProxyHandlers = {\n         get: function (target, name) {\n@@ -5349,7 +5326,7 @@\n       patchConsole(console, \"table\"),\n       patchConsole(console, \"trace\"),\n       patchConsole(console, \"warn\"));\n-    var ObjectPrototype = Object.prototype,\n+    var ObjectPrototype$1 = Object.prototype,\n       stringify = JSON.stringify,\n       ABORTING = 12,\n       CLOSED = 14,\n@@ -5380,7 +5357,23 @@\n       }\n       switch (this.status) {\n         case \"fulfilled\":\n-          \"function\" === typeof resolve && resolve(this.value);\n+          if (\"function\" === typeof resolve) {\n+            for (\n+              var inspectedValue = this.value;\n+              inspectedValue instanceof ReactPromise;\n+\n+            ) {\n+              if (inspectedValue === this) {\n+                \"function\" === typeof reject &&\n+                  reject(Error(\"Cannot have cyclic thenables.\"));\n+                return;\n+              }\n+              if (\"fulfilled\" === inspectedValue.status)\n+                inspectedValue = inspectedValue.value;\n+              else break;\n+            }\n+            resolve(this.value);\n+          }\n           break;\n         case \"pending\":\n         case \"blocked\":\n@@ -5395,7 +5388,9 @@\n           \"function\" === typeof reject && reject(this.reason);\n       }\n     };\n-    var initializingHandler = null;\n+    var ObjectPrototype = Object.prototype,\n+      ArrayPrototype = Array.prototype,\n+      initializingHandler = null;\n     exports.createClientModuleProxy = function (moduleId) {\n       moduleId = registerClientReferenceImpl({}, moduleId, !1);\n       return new Proxy(moduleId, proxyHandlers$1);\n@@ -5523,7 +5518,8 @@\n         },\n         $$bound: { value: null, configurable: !0 },\n         $$location: { value: Error(\"react-stack-top-frame\"), configurable: !0 },\n-        bind: { value: bind, configurable: !0 }\n+        bind: { value: bind, configurable: !0 },\n+        toString: serverReferenceToString\n       });\n     };\n     exports.renderToReadableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "a8af4620e59729941adefd8a0b78c3c48e69fb57",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-server.browser.production.js",
            "status": "modified",
            "additions": 169,
            "deletions": 172,
            "changes": 341,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -101,7 +101,14 @@ function bind() {\n   }\n   return newFn;\n }\n-var PROMISE_PROTOTYPE = Promise.prototype,\n+var serverReferenceToString = {\n+    value: function () {\n+      return \"function () { [omitted code] }\";\n+    },\n+    configurable: !0,\n+    writable: !0\n+  },\n+  PROMISE_PROTOTYPE = Promise.prototype,\n   deepProxyHandlers = {\n     get: function (target, name) {\n       switch (name) {\n@@ -820,7 +827,7 @@ function describeObjectForErrorMessage(objectOrArray, expandedName) {\n       : \"\\n  \" + str;\n }\n var hasOwnProperty = Object.prototype.hasOwnProperty,\n-  ObjectPrototype = Object.prototype,\n+  ObjectPrototype$1 = Object.prototype,\n   stringify = JSON.stringify,\n   TaintRegistryObjects = ReactSharedInternalsServer.TaintRegistryObjects,\n   TaintRegistryValues = ReactSharedInternalsServer.TaintRegistryValues,\n@@ -1726,7 +1733,7 @@ function renderModelDestructive(\n     if (value instanceof Date) return \"$D\" + value.toJSON();\n     request = getPrototypeOf(value);\n     if (\n-      request !== ObjectPrototype &&\n+      request !== ObjectPrototype$1 &&\n       (null === request || null !== getPrototypeOf(request))\n     )\n       throw Error(\n@@ -1779,7 +1786,7 @@ function renderModelDestructive(\n         (task = request.writtenServerReferences),\n         (parentPropertyName = task.get(value)),\n         void 0 !== parentPropertyName\n-          ? (value = \"$F\" + parentPropertyName.toString(16))\n+          ? (value = \"$h\" + parentPropertyName.toString(16))\n           : ((parentPropertyName = value.$$bound),\n             (parentPropertyName =\n               null === parentPropertyName\n@@ -1791,7 +1798,7 @@ function renderModelDestructive(\n               0\n             )),\n             task.set(value, request),\n-            (value = \"$F\" + request.toString(16))),\n+            (value = \"$h\" + request.toString(16))),\n         value\n       );\n     if (\n@@ -2319,7 +2326,23 @@ ReactPromise.prototype.then = function (resolve, reject) {\n   }\n   switch (this.status) {\n     case \"fulfilled\":\n-      \"function\" === typeof resolve && resolve(this.value);\n+      if (\"function\" === typeof resolve) {\n+        for (\n+          var inspectedValue = this.value;\n+          inspectedValue instanceof ReactPromise;\n+\n+        ) {\n+          if (inspectedValue === this) {\n+            \"function\" === typeof reject &&\n+              reject(Error(\"Cannot have cyclic thenables.\"));\n+            return;\n+          }\n+          if (\"fulfilled\" === inspectedValue.status)\n+            inspectedValue = inspectedValue.value;\n+          else break;\n+        }\n+        resolve(this.value);\n+      }\n       break;\n     case \"pending\":\n     case \"blocked\":\n@@ -2332,6 +2355,8 @@ ReactPromise.prototype.then = function (resolve, reject) {\n       \"function\" === typeof reject && reject(this.reason);\n   }\n };\n+var ObjectPrototype = Object.prototype,\n+  ArrayPrototype = Array.prototype;\n function wakeChunk(response, listeners, value) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n@@ -2509,6 +2534,7 @@ function loadServerReference$1(response, metaData, parentObject, key) {\n           ((promiseValue = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n+          (resolvedValue.reason = null),\n           null !== promiseValue &&\n             wakeChunk(response, promiseValue, handler.value)));\n     },\n@@ -2600,6 +2626,7 @@ function initializeModelChunk(chunk) {\n     }\n     chunk.status = \"fulfilled\";\n     chunk.value = value;\n+    chunk.reason = null;\n   } catch (error) {\n     (chunk.status = \"rejected\"), (chunk.reason = error);\n   } finally {\n@@ -2610,7 +2637,11 @@ function reportGlobalError(response, error) {\n   response._closed = !0;\n   response._closedReason = error;\n   response._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status && triggerErrorOnChunk(response, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(response, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function getChunk(response, id) {\n@@ -2628,58 +2659,41 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n-    for (; value instanceof ReactPromise; ) {\n-      switch (value.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(value);\n-      }\n-      switch (value.status) {\n-        case \"fulfilled\":\n-          value = value.value;\n-          continue;\n-        case \"blocked\":\n-        case \"pending\":\n-          path.splice(0, i - 1);\n-          null === value.value\n-            ? (value.value = [reference])\n-            : value.value.push(reference);\n-          null === value.reason\n-            ? (value.reason = [reference])\n-            : value.reason.push(reference);\n-          return;\n-        default:\n-          rejectReference(response, reference.handler, value.reason);\n-          return;\n-      }\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      var name = path[i];\n+      if (\n+        \"object\" !== typeof value ||\n+        null === value ||\n+        (getPrototypeOf(value) !== ObjectPrototype &&\n+          getPrototypeOf(value) !== ArrayPrototype) ||\n+        !hasOwnProperty.call(value, name)\n+      )\n+        throw Error(\"Invalid reference.\");\n+      value = value[name];\n     }\n-    var name = path[i];\n-    \"object\" === typeof value &&\n-      hasOwnProperty.call(value, name) &&\n-      (value = value[name]);\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n   }\n-  reference = map(response, value, parentObject, key);\n-  parentObject[key] = reference;\n-  \"\" === key && null === handler.value && (handler.value = reference);\n   handler.deps--;\n   0 === handler.deps &&\n-    ((parentObject = handler.chunk),\n-    null !== parentObject &&\n-      \"blocked\" === parentObject.status &&\n-      ((key = parentObject.value),\n-      (parentObject.status = \"fulfilled\"),\n-      (parentObject.value = handler.value),\n-      (parentObject.reason = handler.reason),\n-      null !== key && wakeChunk(response, key, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -2691,33 +2705,6 @@ function rejectReference(response, handler, error) {\n       \"blocked\" === handler.status &&\n       triggerErrorOnChunk(response, handler, error));\n }\n-function waitForReference(\n-  referencedChunk,\n-  parentObject,\n-  key,\n-  response,\n-  map,\n-  path\n-) {\n-  initializingHandler\n-    ? ((response = initializingHandler), response.deps++)\n-    : (response = initializingHandler =\n-        { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-  parentObject = {\n-    handler: response,\n-    parentObject: parentObject,\n-    key: key,\n-    map: map,\n-    path: path\n-  };\n-  null === referencedChunk.value\n-    ? (referencedChunk.value = [parentObject])\n-    : referencedChunk.value.push(parentObject);\n-  null === referencedChunk.reason\n-    ? (referencedChunk.reason = [parentObject])\n-    : referencedChunk.reason.push(parentObject);\n-  return null;\n-}\n function getOutlinedModel(response, reference, parentObject, key, map) {\n   reference = reference.split(\":\");\n   var id = parseInt(reference[0], 16);\n@@ -2728,53 +2715,42 @@ function getOutlinedModel(response, reference, parentObject, key, map) {\n   }\n   switch (id.status) {\n     case \"fulfilled\":\n-      var value = id.value;\n-      for (id = 1; id < reference.length; id++) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              break;\n-            case \"blocked\":\n-            case \"pending\":\n-              return waitForReference(\n-                value,\n-                parentObject,\n-                key,\n-                response,\n-                map,\n-                reference.slice(id - 1)\n-              );\n-            default:\n-              return (\n-                initializingHandler\n-                  ? ((initializingHandler.errored = !0),\n-                    (initializingHandler.value = null),\n-                    (initializingHandler.reason = value.reason))\n-                  : (initializingHandler = {\n-                      chunk: null,\n-                      value: null,\n-                      reason: value.reason,\n-                      deps: 0,\n-                      errored: !0\n-                    }),\n-                null\n-              );\n-          }\n-        }\n-        var name = reference[id];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+      id = id.value;\n+      for (var i = 1; i < reference.length; i++) {\n+        var name = reference[i];\n+        if (\n+          \"object\" !== typeof id ||\n+          null === id ||\n+          (getPrototypeOf(id) !== ObjectPrototype &&\n+            getPrototypeOf(id) !== ArrayPrototype) ||\n+          !hasOwnProperty.call(id, name)\n+        )\n+          throw Error(\"Invalid reference.\");\n+        id = id[name];\n       }\n-      return map(response, value, parentObject, key);\n+      return map(response, id, parentObject, key);\n     case \"pending\":\n     case \"blocked\":\n-      return waitForReference(id, parentObject, key, response, map, reference);\n+      return (\n+        initializingHandler\n+          ? ((response = initializingHandler), response.deps++)\n+          : (response = initializingHandler =\n+              { chunk: null, value: null, reason: null, deps: 1, errored: !1 }),\n+        (parentObject = {\n+          handler: response,\n+          parentObject: parentObject,\n+          key: key,\n+          map: map,\n+          path: reference\n+        }),\n+        null === id.value\n+          ? (id.value = [parentObject])\n+          : id.value.push(parentObject),\n+        null === id.reason\n+          ? (id.reason = [parentObject])\n+          : id.reason.push(parentObject),\n+        null\n+      );\n     default:\n       return (\n         initializingHandler\n@@ -2813,9 +2789,10 @@ function parseTypedArray(\n   parentKey\n ) {\n   reference = parseInt(reference.slice(2), 16);\n-  reference = response._formData\n-    .get(response._prefix + reference)\n-    .arrayBuffer();\n+  bytesPerElement = response._prefix + reference;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized typed array.\");\n+  reference = response._formData.get(bytesPerElement).arrayBuffer();\n   if (initializingHandler) {\n     var handler = initializingHandler;\n     handler.deps++;\n@@ -2841,6 +2818,7 @@ function parseTypedArray(\n         var resolveListeners = buffer.value;\n         buffer.status = \"fulfilled\";\n         buffer.value = handler.value;\n+        buffer.reason = null;\n         null !== resolveListeners &&\n           wakeChunk(response, resolveListeners, handler.value);\n       }\n@@ -2873,7 +2851,10 @@ function resolveStream(response, id, stream, controller) {\n }\n function parseReadableStream(response, reference, type) {\n   reference = parseInt(reference.slice(2), 16);\n-  var controller = null;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -2916,24 +2897,27 @@ function parseReadableStream(response, reference, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n   return type;\n@@ -2948,6 +2932,8 @@ function createIterator(next) {\n }\n function parseAsyncIterable(response, reference, iterator) {\n   reference = parseInt(reference.slice(2), 16);\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n   var buffer = [],\n     closed = !1,\n     nextWriteIndex = 0,\n@@ -2991,36 +2977,46 @@ function parseAsyncIterable(response, reference, iterator) {\n       nextWriteIndex++;\n     },\n     close: function (value) {\n-      closed = !0;\n-      nextWriteIndex === buffer.length\n-        ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-            response,\n-            value,\n-            !0\n-          ))\n-        : resolveIteratorResultChunk(\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length\n+              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                  response,\n+                  value,\n+                  !0\n+                ))\n+              : resolveIteratorResultChunk(\n+                  response,\n+                  buffer[nextWriteIndex],\n+                  value,\n+                  !0\n+                ),\n+            nextWriteIndex++;\n+          nextWriteIndex < buffer.length;\n+\n+        )\n+          resolveIteratorResultChunk(\n             response,\n-            buffer[nextWriteIndex],\n-            value,\n+            buffer[nextWriteIndex++],\n+            '\"$undefined\"',\n             !0\n           );\n-      for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-        resolveIteratorResultChunk(\n-          response,\n-          buffer[nextWriteIndex++],\n-          '\"$undefined\"',\n-          !0\n-        );\n     },\n     error: function (error) {\n-      closed = !0;\n-      for (\n-        nextWriteIndex === buffer.length &&\n-        (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-        nextWriteIndex < buffer.length;\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length &&\n+              (buffer[nextWriteIndex] = new ReactPromise(\n+                \"pending\",\n+                null,\n+                null\n+              ));\n+          nextWriteIndex < buffer.length;\n \n-      )\n-        triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+        )\n+          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n     }\n   });\n   return iterator;\n@@ -3032,7 +3028,7 @@ function parseModelString(response, obj, key, value, reference) {\n         return value.slice(1);\n       case \"@\":\n         return (obj = parseInt(value.slice(2), 16)), getChunk(response, obj);\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -3293,7 +3289,8 @@ exports.registerServerReference = function (reference, id, exportName) {\n       configurable: !0\n     },\n     $$bound: { value: null, configurable: !0 },\n-    bind: { value: bind, configurable: !0 }\n+    bind: { value: bind, configurable: !0 },\n+    toString: serverReferenceToString\n   });\n };\n exports.renderToReadableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "9e95183a53d23249066e6a93cc84294c2807b5b7",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-server.edge.development.js",
            "status": "modified",
            "additions": 176,
            "deletions": 180,
            "changes": 356,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -2210,7 +2210,7 @@\n     function serializeServerReference(request, serverReference) {\n       var writtenServerReferences = request.writtenServerReferences,\n         existingId = writtenServerReferences.get(serverReference);\n-      if (void 0 !== existingId) return \"$F\" + existingId.toString(16);\n+      if (void 0 !== existingId) return \"$h\" + existingId.toString(16);\n       existingId = serverReference.$$bound;\n       existingId = null === existingId ? null : Promise.resolve(existingId);\n       var id = serverReference.$$id,\n@@ -2236,7 +2236,7 @@\n           : { id: id, bound: existingId };\n       request = outlineModel(request, existingId);\n       writtenServerReferences.set(serverReference, request);\n-      return \"$F\" + request.toString(16);\n+      return \"$h\" + request.toString(16);\n     }\n     function serializeLargeTextString(request, text) {\n       request.pendingChunks++;\n@@ -2632,7 +2632,7 @@\n         if (value instanceof Date) return \"$D\" + value.toJSON();\n         elementReference = getPrototypeOf(value);\n         if (\n-          elementReference !== ObjectPrototype &&\n+          elementReference !== ObjectPrototype$1 &&\n           (null === elementReference ||\n             null !== getPrototypeOf(elementReference))\n         )\n@@ -3243,7 +3243,7 @@\n           return serializeDebugBlob(request, value);\n         if (getIteratorFn(value)) return Array.from(value);\n         request = getPrototypeOf(value);\n-        if (request !== ObjectPrototype && null !== request) {\n+        if (request !== ObjectPrototype$1 && null !== request) {\n           counter = Object.create(null);\n           for (env in value)\n             if (hasOwnProperty.call(value, env) || isGetter(request, env))\n@@ -4209,6 +4209,7 @@\n               ((promiseValue = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== promiseValue &&\n                 wakeChunk(response, promiseValue, handler.value)));\n         },\n@@ -4312,6 +4313,7 @@\n         }\n         chunk.status = \"fulfilled\";\n         chunk.value = value;\n+        chunk.reason = null;\n       } catch (error) {\n         (chunk.status = \"rejected\"), (chunk.reason = error);\n       } finally {\n@@ -4322,8 +4324,11 @@\n       response._closed = !0;\n       response._closedReason = error;\n       response._chunks.forEach(function (chunk) {\n-        \"pending\" === chunk.status &&\n-          triggerErrorOnChunk(response, chunk, error);\n+        \"pending\" === chunk.status\n+          ? triggerErrorOnChunk(response, chunk, error)\n+          : \"fulfilled\" === chunk.status &&\n+            null !== chunk.reason &&\n+            chunk.reason.error(error);\n       });\n     }\n     function getChunk(response, id) {\n@@ -4345,58 +4350,41 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              continue;\n-            case \"blocked\":\n-            case \"pending\":\n-              path.splice(0, i - 1);\n-              null === value.value\n-                ? (value.value = [reference])\n-                : value.value.push(reference);\n-              null === value.reason\n-                ? (value.reason = [reference])\n-                : value.reason.push(reference);\n-              return;\n-            default:\n-              rejectReference(response, reference.handler, value.reason);\n-              return;\n-          }\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          var name = path[i];\n+          if (\n+            \"object\" !== typeof value ||\n+            null === value ||\n+            (getPrototypeOf(value) !== ObjectPrototype &&\n+              getPrototypeOf(value) !== ArrayPrototype) ||\n+            !hasOwnProperty.call(value, name)\n+          )\n+            throw Error(\"Invalid reference.\");\n+          value = value[name];\n         }\n-        var name = path[i];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n       }\n-      reference = map(response, value, parentObject, key);\n-      parentObject[key] = reference;\n-      \"\" === key && null === handler.value && (handler.value = reference);\n       handler.deps--;\n       0 === handler.deps &&\n-        ((parentObject = handler.chunk),\n-        null !== parentObject &&\n-          \"blocked\" === parentObject.status &&\n-          ((key = parentObject.value),\n-          (parentObject.status = \"fulfilled\"),\n-          (parentObject.value = handler.value),\n-          (parentObject.reason = handler.reason),\n-          null !== key && wakeChunk(response, key, handler.value)));\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value && wakeChunk(response, value, handler.value)));\n     }\n     function rejectReference(response, handler, error) {\n       handler.errored ||\n@@ -4408,33 +4396,6 @@\n           \"blocked\" === handler.status &&\n           triggerErrorOnChunk(response, handler, error));\n     }\n-    function waitForReference(\n-      referencedChunk,\n-      parentObject,\n-      key,\n-      response,\n-      map,\n-      path\n-    ) {\n-      initializingHandler\n-        ? ((response = initializingHandler), response.deps++)\n-        : (response = initializingHandler =\n-            { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-      parentObject = {\n-        handler: response,\n-        parentObject: parentObject,\n-        key: key,\n-        map: map,\n-        path: path\n-      };\n-      null === referencedChunk.value\n-        ? (referencedChunk.value = [parentObject])\n-        : referencedChunk.value.push(parentObject);\n-      null === referencedChunk.reason\n-        ? (referencedChunk.reason = [parentObject])\n-        : referencedChunk.reason.push(parentObject);\n-      return null;\n-    }\n     function getOutlinedModel(response, reference, parentObject, key, map) {\n       reference = reference.split(\":\");\n       var id = parseInt(reference[0], 16);\n@@ -4445,59 +4406,47 @@\n       }\n       switch (id.status) {\n         case \"fulfilled\":\n-          var value = id.value;\n-          for (id = 1; id < reference.length; id++) {\n-            for (; value instanceof ReactPromise; ) {\n-              switch (value.status) {\n-                case \"resolved_model\":\n-                  initializeModelChunk(value);\n-              }\n-              switch (value.status) {\n-                case \"fulfilled\":\n-                  value = value.value;\n-                  break;\n-                case \"blocked\":\n-                case \"pending\":\n-                  return waitForReference(\n-                    value,\n-                    parentObject,\n-                    key,\n-                    response,\n-                    map,\n-                    reference.slice(id - 1)\n-                  );\n-                default:\n-                  return (\n-                    initializingHandler\n-                      ? ((initializingHandler.errored = !0),\n-                        (initializingHandler.value = null),\n-                        (initializingHandler.reason = value.reason))\n-                      : (initializingHandler = {\n-                          chunk: null,\n-                          value: null,\n-                          reason: value.reason,\n-                          deps: 0,\n-                          errored: !0\n-                        }),\n-                    null\n-                  );\n-              }\n-            }\n-            var name = reference[id];\n-            \"object\" === typeof value &&\n-              hasOwnProperty.call(value, name) &&\n-              (value = value[name]);\n+          id = id.value;\n+          for (var i = 1; i < reference.length; i++) {\n+            var name = reference[i];\n+            if (\n+              \"object\" !== typeof id ||\n+              null === id ||\n+              (getPrototypeOf(id) !== ObjectPrototype &&\n+                getPrototypeOf(id) !== ArrayPrototype) ||\n+              !hasOwnProperty.call(id, name)\n+            )\n+              throw Error(\"Invalid reference.\");\n+            id = id[name];\n           }\n-          return map(response, value, parentObject, key);\n+          return map(response, id, parentObject, key);\n         case \"pending\":\n         case \"blocked\":\n-          return waitForReference(\n-            id,\n-            parentObject,\n-            key,\n-            response,\n-            map,\n-            reference\n+          return (\n+            initializingHandler\n+              ? ((response = initializingHandler), response.deps++)\n+              : (response = initializingHandler =\n+                  {\n+                    chunk: null,\n+                    value: null,\n+                    reason: null,\n+                    deps: 1,\n+                    errored: !1\n+                  }),\n+            (parentObject = {\n+              handler: response,\n+              parentObject: parentObject,\n+              key: key,\n+              map: map,\n+              path: reference\n+            }),\n+            null === id.value\n+              ? (id.value = [parentObject])\n+              : id.value.push(parentObject),\n+            null === id.reason\n+              ? (id.reason = [parentObject])\n+              : id.reason.push(parentObject),\n+            null\n           );\n         default:\n           return (\n@@ -4537,9 +4486,10 @@\n       parentKey\n     ) {\n       reference = parseInt(reference.slice(2), 16);\n-      reference = response._formData\n-        .get(response._prefix + reference)\n-        .arrayBuffer();\n+      bytesPerElement = response._prefix + reference;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized typed array.\");\n+      reference = response._formData.get(bytesPerElement).arrayBuffer();\n       if (initializingHandler) {\n         var handler = initializingHandler;\n         handler.deps++;\n@@ -4568,6 +4518,7 @@\n             var resolveListeners = buffer.value;\n             buffer.status = \"fulfilled\";\n             buffer.value = handler.value;\n+            buffer.reason = null;\n             null !== resolveListeners &&\n               wakeChunk(response, resolveListeners, handler.value);\n           }\n@@ -4602,7 +4553,10 @@\n     }\n     function parseReadableStream(response, reference, type) {\n       reference = parseInt(reference.slice(2), 16);\n-      var controller = null;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -4649,24 +4603,28 @@\n           }\n         },\n         close: function () {\n-          if (null === previousBlockedChunk) controller.close();\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.close();\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.close();\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.close();\n+              });\n+            }\n         },\n         error: function (error) {\n-          if (null === previousBlockedChunk) controller.error(error);\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.error(error);\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.error(error);\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.error(error);\n+              });\n+            }\n         }\n       });\n       return type;\n@@ -4681,6 +4639,8 @@\n     }\n     function parseAsyncIterable(response, reference, iterator) {\n       reference = parseInt(reference.slice(2), 16);\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n       var buffer = [],\n         closed = !1,\n         nextWriteIndex = 0,\n@@ -4721,36 +4681,46 @@\n           nextWriteIndex++;\n         },\n         close: function (value) {\n-          closed = !0;\n-          nextWriteIndex === buffer.length\n-            ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                response,\n-                value,\n-                !0\n-              ))\n-            : resolveIteratorResultChunk(\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length\n+                  ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                      response,\n+                      value,\n+                      !0\n+                    ))\n+                  : resolveIteratorResultChunk(\n+                      response,\n+                      buffer[nextWriteIndex],\n+                      value,\n+                      !0\n+                    ),\n+                nextWriteIndex++;\n+              nextWriteIndex < buffer.length;\n+\n+            )\n+              resolveIteratorResultChunk(\n                 response,\n-                buffer[nextWriteIndex],\n-                value,\n+                buffer[nextWriteIndex++],\n+                '\"$undefined\"',\n                 !0\n               );\n-          for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-            resolveIteratorResultChunk(\n-              response,\n-              buffer[nextWriteIndex++],\n-              '\"$undefined\"',\n-              !0\n-            );\n         },\n         error: function (error) {\n-          closed = !0;\n-          for (\n-            nextWriteIndex === buffer.length &&\n-            (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-            nextWriteIndex < buffer.length;\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length &&\n+                  (buffer[nextWriteIndex] = new ReactPromise(\n+                    \"pending\",\n+                    null,\n+                    null\n+                  ));\n+              nextWriteIndex < buffer.length;\n \n-          )\n-            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+            )\n+              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n         }\n       });\n       return iterator;\n@@ -4764,7 +4734,7 @@\n             return (\n               (obj = parseInt(value.slice(2), 16)), getChunk(response, obj)\n             );\n-          case \"F\":\n+          case \"h\":\n             return (\n               (value = value.slice(2)),\n               getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -5046,6 +5016,13 @@\n       SERVER_REFERENCE_TAG = Symbol.for(\"react.server.reference\"),\n       FunctionBind = Function.prototype.bind,\n       ArraySlice = Array.prototype.slice,\n+      serverReferenceToString = {\n+        value: function () {\n+          return \"function () { [omitted code] }\";\n+        },\n+        configurable: !0,\n+        writable: !0\n+      },\n       PROMISE_PROTOTYPE = Promise.prototype,\n       deepProxyHandlers = {\n         get: function (target, name) {\n@@ -5423,7 +5400,7 @@\n       patchConsole(console, \"table\"),\n       patchConsole(console, \"trace\"),\n       patchConsole(console, \"warn\"));\n-    var ObjectPrototype = Object.prototype,\n+    var ObjectPrototype$1 = Object.prototype,\n       stringify = JSON.stringify,\n       ABORTING = 12,\n       CLOSED = 14,\n@@ -5454,7 +5431,23 @@\n       }\n       switch (this.status) {\n         case \"fulfilled\":\n-          \"function\" === typeof resolve && resolve(this.value);\n+          if (\"function\" === typeof resolve) {\n+            for (\n+              var inspectedValue = this.value;\n+              inspectedValue instanceof ReactPromise;\n+\n+            ) {\n+              if (inspectedValue === this) {\n+                \"function\" === typeof reject &&\n+                  reject(Error(\"Cannot have cyclic thenables.\"));\n+                return;\n+              }\n+              if (\"fulfilled\" === inspectedValue.status)\n+                inspectedValue = inspectedValue.value;\n+              else break;\n+            }\n+            resolve(this.value);\n+          }\n           break;\n         case \"pending\":\n         case \"blocked\":\n@@ -5469,7 +5462,9 @@\n           \"function\" === typeof reject && reject(this.reason);\n       }\n     };\n-    var initializingHandler = null;\n+    var ObjectPrototype = Object.prototype,\n+      ArrayPrototype = Array.prototype,\n+      initializingHandler = null;\n     exports.createClientModuleProxy = function (moduleId) {\n       moduleId = registerClientReferenceImpl({}, moduleId, !1);\n       return new Proxy(moduleId, proxyHandlers$1);\n@@ -5636,7 +5631,8 @@\n         },\n         $$bound: { value: null, configurable: !0 },\n         $$location: { value: Error(\"react-stack-top-frame\"), configurable: !0 },\n-        bind: { value: bind, configurable: !0 }\n+        bind: { value: bind, configurable: !0 },\n+        toString: serverReferenceToString\n       });\n     };\n     exports.renderToReadableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "c6c8884db58eef8ac67dea33eb65f04c62329440",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-server.edge.production.js",
            "status": "modified",
            "additions": 169,
            "deletions": 172,
            "changes": 341,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -112,7 +112,14 @@ function bind() {\n   }\n   return newFn;\n }\n-var PROMISE_PROTOTYPE = Promise.prototype,\n+var serverReferenceToString = {\n+    value: function () {\n+      return \"function () { [omitted code] }\";\n+    },\n+    configurable: !0,\n+    writable: !0\n+  },\n+  PROMISE_PROTOTYPE = Promise.prototype,\n   deepProxyHandlers = {\n     get: function (target, name) {\n       switch (name) {\n@@ -811,7 +818,7 @@ function describeObjectForErrorMessage(objectOrArray, expandedName) {\n       : \"\\n  \" + str;\n }\n var hasOwnProperty = Object.prototype.hasOwnProperty,\n-  ObjectPrototype = Object.prototype,\n+  ObjectPrototype$1 = Object.prototype,\n   stringify = JSON.stringify,\n   TaintRegistryObjects = ReactSharedInternalsServer.TaintRegistryObjects,\n   TaintRegistryValues = ReactSharedInternalsServer.TaintRegistryValues,\n@@ -1725,7 +1732,7 @@ function renderModelDestructive(\n     if (value instanceof Date) return \"$D\" + value.toJSON();\n     request = getPrototypeOf(value);\n     if (\n-      request !== ObjectPrototype &&\n+      request !== ObjectPrototype$1 &&\n       (null === request || null !== getPrototypeOf(request))\n     )\n       throw Error(\n@@ -1778,7 +1785,7 @@ function renderModelDestructive(\n         (task = request.writtenServerReferences),\n         (parentPropertyName = task.get(value)),\n         void 0 !== parentPropertyName\n-          ? (value = \"$F\" + parentPropertyName.toString(16))\n+          ? (value = \"$h\" + parentPropertyName.toString(16))\n           : ((parentPropertyName = value.$$bound),\n             (parentPropertyName =\n               null === parentPropertyName\n@@ -1790,7 +1797,7 @@ function renderModelDestructive(\n               0\n             )),\n             task.set(value, request),\n-            (value = \"$F\" + request.toString(16))),\n+            (value = \"$h\" + request.toString(16))),\n         value\n       );\n     if (\n@@ -2323,7 +2330,23 @@ ReactPromise.prototype.then = function (resolve, reject) {\n   }\n   switch (this.status) {\n     case \"fulfilled\":\n-      \"function\" === typeof resolve && resolve(this.value);\n+      if (\"function\" === typeof resolve) {\n+        for (\n+          var inspectedValue = this.value;\n+          inspectedValue instanceof ReactPromise;\n+\n+        ) {\n+          if (inspectedValue === this) {\n+            \"function\" === typeof reject &&\n+              reject(Error(\"Cannot have cyclic thenables.\"));\n+            return;\n+          }\n+          if (\"fulfilled\" === inspectedValue.status)\n+            inspectedValue = inspectedValue.value;\n+          else break;\n+        }\n+        resolve(this.value);\n+      }\n       break;\n     case \"pending\":\n     case \"blocked\":\n@@ -2336,6 +2359,8 @@ ReactPromise.prototype.then = function (resolve, reject) {\n       \"function\" === typeof reject && reject(this.reason);\n   }\n };\n+var ObjectPrototype = Object.prototype,\n+  ArrayPrototype = Array.prototype;\n function wakeChunk(response, listeners, value) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n@@ -2513,6 +2538,7 @@ function loadServerReference$1(response, metaData, parentObject, key) {\n           ((promiseValue = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n+          (resolvedValue.reason = null),\n           null !== promiseValue &&\n             wakeChunk(response, promiseValue, handler.value)));\n     },\n@@ -2604,6 +2630,7 @@ function initializeModelChunk(chunk) {\n     }\n     chunk.status = \"fulfilled\";\n     chunk.value = value;\n+    chunk.reason = null;\n   } catch (error) {\n     (chunk.status = \"rejected\"), (chunk.reason = error);\n   } finally {\n@@ -2614,7 +2641,11 @@ function reportGlobalError(response, error) {\n   response._closed = !0;\n   response._closedReason = error;\n   response._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status && triggerErrorOnChunk(response, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(response, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function getChunk(response, id) {\n@@ -2632,58 +2663,41 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n-    for (; value instanceof ReactPromise; ) {\n-      switch (value.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(value);\n-      }\n-      switch (value.status) {\n-        case \"fulfilled\":\n-          value = value.value;\n-          continue;\n-        case \"blocked\":\n-        case \"pending\":\n-          path.splice(0, i - 1);\n-          null === value.value\n-            ? (value.value = [reference])\n-            : value.value.push(reference);\n-          null === value.reason\n-            ? (value.reason = [reference])\n-            : value.reason.push(reference);\n-          return;\n-        default:\n-          rejectReference(response, reference.handler, value.reason);\n-          return;\n-      }\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      var name = path[i];\n+      if (\n+        \"object\" !== typeof value ||\n+        null === value ||\n+        (getPrototypeOf(value) !== ObjectPrototype &&\n+          getPrototypeOf(value) !== ArrayPrototype) ||\n+        !hasOwnProperty.call(value, name)\n+      )\n+        throw Error(\"Invalid reference.\");\n+      value = value[name];\n     }\n-    var name = path[i];\n-    \"object\" === typeof value &&\n-      hasOwnProperty.call(value, name) &&\n-      (value = value[name]);\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n   }\n-  reference = map(response, value, parentObject, key);\n-  parentObject[key] = reference;\n-  \"\" === key && null === handler.value && (handler.value = reference);\n   handler.deps--;\n   0 === handler.deps &&\n-    ((parentObject = handler.chunk),\n-    null !== parentObject &&\n-      \"blocked\" === parentObject.status &&\n-      ((key = parentObject.value),\n-      (parentObject.status = \"fulfilled\"),\n-      (parentObject.value = handler.value),\n-      (parentObject.reason = handler.reason),\n-      null !== key && wakeChunk(response, key, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -2695,33 +2709,6 @@ function rejectReference(response, handler, error) {\n       \"blocked\" === handler.status &&\n       triggerErrorOnChunk(response, handler, error));\n }\n-function waitForReference(\n-  referencedChunk,\n-  parentObject,\n-  key,\n-  response,\n-  map,\n-  path\n-) {\n-  initializingHandler\n-    ? ((response = initializingHandler), response.deps++)\n-    : (response = initializingHandler =\n-        { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-  parentObject = {\n-    handler: response,\n-    parentObject: parentObject,\n-    key: key,\n-    map: map,\n-    path: path\n-  };\n-  null === referencedChunk.value\n-    ? (referencedChunk.value = [parentObject])\n-    : referencedChunk.value.push(parentObject);\n-  null === referencedChunk.reason\n-    ? (referencedChunk.reason = [parentObject])\n-    : referencedChunk.reason.push(parentObject);\n-  return null;\n-}\n function getOutlinedModel(response, reference, parentObject, key, map) {\n   reference = reference.split(\":\");\n   var id = parseInt(reference[0], 16);\n@@ -2732,53 +2719,42 @@ function getOutlinedModel(response, reference, parentObject, key, map) {\n   }\n   switch (id.status) {\n     case \"fulfilled\":\n-      var value = id.value;\n-      for (id = 1; id < reference.length; id++) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              break;\n-            case \"blocked\":\n-            case \"pending\":\n-              return waitForReference(\n-                value,\n-                parentObject,\n-                key,\n-                response,\n-                map,\n-                reference.slice(id - 1)\n-              );\n-            default:\n-              return (\n-                initializingHandler\n-                  ? ((initializingHandler.errored = !0),\n-                    (initializingHandler.value = null),\n-                    (initializingHandler.reason = value.reason))\n-                  : (initializingHandler = {\n-                      chunk: null,\n-                      value: null,\n-                      reason: value.reason,\n-                      deps: 0,\n-                      errored: !0\n-                    }),\n-                null\n-              );\n-          }\n-        }\n-        var name = reference[id];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+      id = id.value;\n+      for (var i = 1; i < reference.length; i++) {\n+        var name = reference[i];\n+        if (\n+          \"object\" !== typeof id ||\n+          null === id ||\n+          (getPrototypeOf(id) !== ObjectPrototype &&\n+            getPrototypeOf(id) !== ArrayPrototype) ||\n+          !hasOwnProperty.call(id, name)\n+        )\n+          throw Error(\"Invalid reference.\");\n+        id = id[name];\n       }\n-      return map(response, value, parentObject, key);\n+      return map(response, id, parentObject, key);\n     case \"pending\":\n     case \"blocked\":\n-      return waitForReference(id, parentObject, key, response, map, reference);\n+      return (\n+        initializingHandler\n+          ? ((response = initializingHandler), response.deps++)\n+          : (response = initializingHandler =\n+              { chunk: null, value: null, reason: null, deps: 1, errored: !1 }),\n+        (parentObject = {\n+          handler: response,\n+          parentObject: parentObject,\n+          key: key,\n+          map: map,\n+          path: reference\n+        }),\n+        null === id.value\n+          ? (id.value = [parentObject])\n+          : id.value.push(parentObject),\n+        null === id.reason\n+          ? (id.reason = [parentObject])\n+          : id.reason.push(parentObject),\n+        null\n+      );\n     default:\n       return (\n         initializingHandler\n@@ -2817,9 +2793,10 @@ function parseTypedArray(\n   parentKey\n ) {\n   reference = parseInt(reference.slice(2), 16);\n-  reference = response._formData\n-    .get(response._prefix + reference)\n-    .arrayBuffer();\n+  bytesPerElement = response._prefix + reference;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized typed array.\");\n+  reference = response._formData.get(bytesPerElement).arrayBuffer();\n   if (initializingHandler) {\n     var handler = initializingHandler;\n     handler.deps++;\n@@ -2845,6 +2822,7 @@ function parseTypedArray(\n         var resolveListeners = buffer.value;\n         buffer.status = \"fulfilled\";\n         buffer.value = handler.value;\n+        buffer.reason = null;\n         null !== resolveListeners &&\n           wakeChunk(response, resolveListeners, handler.value);\n       }\n@@ -2877,7 +2855,10 @@ function resolveStream(response, id, stream, controller) {\n }\n function parseReadableStream(response, reference, type) {\n   reference = parseInt(reference.slice(2), 16);\n-  var controller = null;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -2920,24 +2901,27 @@ function parseReadableStream(response, reference, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n   return type;\n@@ -2952,6 +2936,8 @@ function createIterator(next) {\n }\n function parseAsyncIterable(response, reference, iterator) {\n   reference = parseInt(reference.slice(2), 16);\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n   var buffer = [],\n     closed = !1,\n     nextWriteIndex = 0,\n@@ -2995,36 +2981,46 @@ function parseAsyncIterable(response, reference, iterator) {\n       nextWriteIndex++;\n     },\n     close: function (value) {\n-      closed = !0;\n-      nextWriteIndex === buffer.length\n-        ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-            response,\n-            value,\n-            !0\n-          ))\n-        : resolveIteratorResultChunk(\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length\n+              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                  response,\n+                  value,\n+                  !0\n+                ))\n+              : resolveIteratorResultChunk(\n+                  response,\n+                  buffer[nextWriteIndex],\n+                  value,\n+                  !0\n+                ),\n+            nextWriteIndex++;\n+          nextWriteIndex < buffer.length;\n+\n+        )\n+          resolveIteratorResultChunk(\n             response,\n-            buffer[nextWriteIndex],\n-            value,\n+            buffer[nextWriteIndex++],\n+            '\"$undefined\"',\n             !0\n           );\n-      for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-        resolveIteratorResultChunk(\n-          response,\n-          buffer[nextWriteIndex++],\n-          '\"$undefined\"',\n-          !0\n-        );\n     },\n     error: function (error) {\n-      closed = !0;\n-      for (\n-        nextWriteIndex === buffer.length &&\n-        (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-        nextWriteIndex < buffer.length;\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length &&\n+              (buffer[nextWriteIndex] = new ReactPromise(\n+                \"pending\",\n+                null,\n+                null\n+              ));\n+          nextWriteIndex < buffer.length;\n \n-      )\n-        triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+        )\n+          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n     }\n   });\n   return iterator;\n@@ -3036,7 +3032,7 @@ function parseModelString(response, obj, key, value, reference) {\n         return value.slice(1);\n       case \"@\":\n         return (obj = parseInt(value.slice(2), 16)), getChunk(response, obj);\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -3335,7 +3331,8 @@ exports.registerServerReference = function (reference, id, exportName) {\n       configurable: !0\n     },\n     $$bound: { value: null, configurable: !0 },\n-    bind: { value: bind, configurable: !0 }\n+    bind: { value: bind, configurable: !0 },\n+    toString: serverReferenceToString\n   });\n };\n exports.renderToReadableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "994443474cd0fab81b915e130ed409f6250bca12",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-server.node.development.js",
            "status": "modified",
            "additions": 179,
            "deletions": 183,
            "changes": 362,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -2458,7 +2458,7 @@\n     function serializeServerReference(request, serverReference) {\n       var writtenServerReferences = request.writtenServerReferences,\n         existingId = writtenServerReferences.get(serverReference);\n-      if (void 0 !== existingId) return \"$F\" + existingId.toString(16);\n+      if (void 0 !== existingId) return \"$h\" + existingId.toString(16);\n       existingId = serverReference.$$bound;\n       existingId = null === existingId ? null : Promise.resolve(existingId);\n       var id = serverReference.$$id,\n@@ -2484,7 +2484,7 @@\n           : { id: id, bound: existingId };\n       request = outlineModel(request, existingId);\n       writtenServerReferences.set(serverReference, request);\n-      return \"$F\" + request.toString(16);\n+      return \"$h\" + request.toString(16);\n     }\n     function serializeLargeTextString(request, text) {\n       request.pendingChunks++;\n@@ -2880,7 +2880,7 @@\n         if (value instanceof Date) return \"$D\" + value.toJSON();\n         elementReference = getPrototypeOf(value);\n         if (\n-          elementReference !== ObjectPrototype &&\n+          elementReference !== ObjectPrototype$1 &&\n           (null === elementReference ||\n             null !== getPrototypeOf(elementReference))\n         )\n@@ -3581,7 +3581,7 @@\n           return serializeDebugBlob(request, value);\n         if (getIteratorFn(value)) return Array.from(value);\n         request = getPrototypeOf(value);\n-        if (request !== ObjectPrototype && null !== request) {\n+        if (request !== ObjectPrototype$1 && null !== request) {\n           counter = Object.create(null);\n           for (env in value)\n             if (hasOwnProperty.call(value, env) || isGetter(request, env))\n@@ -4656,6 +4656,7 @@\n               ((promiseValue = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== promiseValue &&\n                 wakeChunk(response, promiseValue, handler.value)));\n         },\n@@ -4759,6 +4760,7 @@\n         }\n         chunk.status = \"fulfilled\";\n         chunk.value = value;\n+        chunk.reason = null;\n       } catch (error) {\n         (chunk.status = \"rejected\"), (chunk.reason = error);\n       } finally {\n@@ -4769,8 +4771,11 @@\n       response._closed = !0;\n       response._closedReason = error;\n       response._chunks.forEach(function (chunk) {\n-        \"pending\" === chunk.status &&\n-          triggerErrorOnChunk(response, chunk, error);\n+        \"pending\" === chunk.status\n+          ? triggerErrorOnChunk(response, chunk, error)\n+          : \"fulfilled\" === chunk.status &&\n+            null !== chunk.reason &&\n+            chunk.reason.error(error);\n       });\n     }\n     function getChunk(response, id) {\n@@ -4792,58 +4797,41 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              continue;\n-            case \"blocked\":\n-            case \"pending\":\n-              path.splice(0, i - 1);\n-              null === value.value\n-                ? (value.value = [reference])\n-                : value.value.push(reference);\n-              null === value.reason\n-                ? (value.reason = [reference])\n-                : value.reason.push(reference);\n-              return;\n-            default:\n-              rejectReference(response, reference.handler, value.reason);\n-              return;\n-          }\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          var name = path[i];\n+          if (\n+            \"object\" !== typeof value ||\n+            null === value ||\n+            (getPrototypeOf(value) !== ObjectPrototype &&\n+              getPrototypeOf(value) !== ArrayPrototype) ||\n+            !hasOwnProperty.call(value, name)\n+          )\n+            throw Error(\"Invalid reference.\");\n+          value = value[name];\n         }\n-        var name = path[i];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n       }\n-      reference = map(response, value, parentObject, key);\n-      parentObject[key] = reference;\n-      \"\" === key && null === handler.value && (handler.value = reference);\n       handler.deps--;\n       0 === handler.deps &&\n-        ((parentObject = handler.chunk),\n-        null !== parentObject &&\n-          \"blocked\" === parentObject.status &&\n-          ((key = parentObject.value),\n-          (parentObject.status = \"fulfilled\"),\n-          (parentObject.value = handler.value),\n-          (parentObject.reason = handler.reason),\n-          null !== key && wakeChunk(response, key, handler.value)));\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value && wakeChunk(response, value, handler.value)));\n     }\n     function rejectReference(response, handler, error) {\n       handler.errored ||\n@@ -4855,33 +4843,6 @@\n           \"blocked\" === handler.status &&\n           triggerErrorOnChunk(response, handler, error));\n     }\n-    function waitForReference(\n-      referencedChunk,\n-      parentObject,\n-      key,\n-      response,\n-      map,\n-      path\n-    ) {\n-      initializingHandler\n-        ? ((response = initializingHandler), response.deps++)\n-        : (response = initializingHandler =\n-            { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-      parentObject = {\n-        handler: response,\n-        parentObject: parentObject,\n-        key: key,\n-        map: map,\n-        path: path\n-      };\n-      null === referencedChunk.value\n-        ? (referencedChunk.value = [parentObject])\n-        : referencedChunk.value.push(parentObject);\n-      null === referencedChunk.reason\n-        ? (referencedChunk.reason = [parentObject])\n-        : referencedChunk.reason.push(parentObject);\n-      return null;\n-    }\n     function getOutlinedModel(response, reference, parentObject, key, map) {\n       reference = reference.split(\":\");\n       var id = parseInt(reference[0], 16);\n@@ -4892,59 +4853,47 @@\n       }\n       switch (id.status) {\n         case \"fulfilled\":\n-          var value = id.value;\n-          for (id = 1; id < reference.length; id++) {\n-            for (; value instanceof ReactPromise; ) {\n-              switch (value.status) {\n-                case \"resolved_model\":\n-                  initializeModelChunk(value);\n-              }\n-              switch (value.status) {\n-                case \"fulfilled\":\n-                  value = value.value;\n-                  break;\n-                case \"blocked\":\n-                case \"pending\":\n-                  return waitForReference(\n-                    value,\n-                    parentObject,\n-                    key,\n-                    response,\n-                    map,\n-                    reference.slice(id - 1)\n-                  );\n-                default:\n-                  return (\n-                    initializingHandler\n-                      ? ((initializingHandler.errored = !0),\n-                        (initializingHandler.value = null),\n-                        (initializingHandler.reason = value.reason))\n-                      : (initializingHandler = {\n-                          chunk: null,\n-                          value: null,\n-                          reason: value.reason,\n-                          deps: 0,\n-                          errored: !0\n-                        }),\n-                    null\n-                  );\n-              }\n-            }\n-            var name = reference[id];\n-            \"object\" === typeof value &&\n-              hasOwnProperty.call(value, name) &&\n-              (value = value[name]);\n+          id = id.value;\n+          for (var i = 1; i < reference.length; i++) {\n+            var name = reference[i];\n+            if (\n+              \"object\" !== typeof id ||\n+              null === id ||\n+              (getPrototypeOf(id) !== ObjectPrototype &&\n+                getPrototypeOf(id) !== ArrayPrototype) ||\n+              !hasOwnProperty.call(id, name)\n+            )\n+              throw Error(\"Invalid reference.\");\n+            id = id[name];\n           }\n-          return map(response, value, parentObject, key);\n+          return map(response, id, parentObject, key);\n         case \"pending\":\n         case \"blocked\":\n-          return waitForReference(\n-            id,\n-            parentObject,\n-            key,\n-            response,\n-            map,\n-            reference\n+          return (\n+            initializingHandler\n+              ? ((response = initializingHandler), response.deps++)\n+              : (response = initializingHandler =\n+                  {\n+                    chunk: null,\n+                    value: null,\n+                    reason: null,\n+                    deps: 1,\n+                    errored: !1\n+                  }),\n+            (parentObject = {\n+              handler: response,\n+              parentObject: parentObject,\n+              key: key,\n+              map: map,\n+              path: reference\n+            }),\n+            null === id.value\n+              ? (id.value = [parentObject])\n+              : id.value.push(parentObject),\n+            null === id.reason\n+              ? (id.reason = [parentObject])\n+              : id.reason.push(parentObject),\n+            null\n           );\n         default:\n           return (\n@@ -4984,9 +4933,10 @@\n       parentKey\n     ) {\n       reference = parseInt(reference.slice(2), 16);\n-      reference = response._formData\n-        .get(response._prefix + reference)\n-        .arrayBuffer();\n+      bytesPerElement = response._prefix + reference;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized typed array.\");\n+      reference = response._formData.get(bytesPerElement).arrayBuffer();\n       if (initializingHandler) {\n         var handler = initializingHandler;\n         handler.deps++;\n@@ -5015,6 +4965,7 @@\n             var resolveListeners = buffer.value;\n             buffer.status = \"fulfilled\";\n             buffer.value = handler.value;\n+            buffer.reason = null;\n             null !== resolveListeners &&\n               wakeChunk(response, resolveListeners, handler.value);\n           }\n@@ -5049,7 +5000,10 @@\n     }\n     function parseReadableStream(response, reference, type) {\n       reference = parseInt(reference.slice(2), 16);\n-      var controller = null;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -5096,24 +5050,28 @@\n           }\n         },\n         close: function () {\n-          if (null === previousBlockedChunk) controller.close();\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.close();\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.close();\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.close();\n+              });\n+            }\n         },\n         error: function (error) {\n-          if (null === previousBlockedChunk) controller.error(error);\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.error(error);\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.error(error);\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.error(error);\n+              });\n+            }\n         }\n       });\n       return type;\n@@ -5128,6 +5086,8 @@\n     }\n     function parseAsyncIterable(response, reference, iterator) {\n       reference = parseInt(reference.slice(2), 16);\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n       var buffer = [],\n         closed = !1,\n         nextWriteIndex = 0,\n@@ -5168,36 +5128,46 @@\n           nextWriteIndex++;\n         },\n         close: function (value) {\n-          closed = !0;\n-          nextWriteIndex === buffer.length\n-            ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                response,\n-                value,\n-                !0\n-              ))\n-            : resolveIteratorResultChunk(\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length\n+                  ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                      response,\n+                      value,\n+                      !0\n+                    ))\n+                  : resolveIteratorResultChunk(\n+                      response,\n+                      buffer[nextWriteIndex],\n+                      value,\n+                      !0\n+                    ),\n+                nextWriteIndex++;\n+              nextWriteIndex < buffer.length;\n+\n+            )\n+              resolveIteratorResultChunk(\n                 response,\n-                buffer[nextWriteIndex],\n-                value,\n+                buffer[nextWriteIndex++],\n+                '\"$undefined\"',\n                 !0\n               );\n-          for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-            resolveIteratorResultChunk(\n-              response,\n-              buffer[nextWriteIndex++],\n-              '\"$undefined\"',\n-              !0\n-            );\n         },\n         error: function (error) {\n-          closed = !0;\n-          for (\n-            nextWriteIndex === buffer.length &&\n-            (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-            nextWriteIndex < buffer.length;\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length &&\n+                  (buffer[nextWriteIndex] = new ReactPromise(\n+                    \"pending\",\n+                    null,\n+                    null\n+                  ));\n+              nextWriteIndex < buffer.length;\n \n-          )\n-            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+            )\n+              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n         }\n       });\n       return iterator;\n@@ -5211,7 +5181,7 @@\n             return (\n               (obj = parseInt(value.slice(2), 16)), getChunk(response, obj)\n             );\n-          case \"F\":\n+          case \"h\":\n             return (\n               (value = value.slice(2)),\n               getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -5551,6 +5521,13 @@\n       SERVER_REFERENCE_TAG = Symbol.for(\"react.server.reference\"),\n       FunctionBind = Function.prototype.bind,\n       ArraySlice = Array.prototype.slice,\n+      serverReferenceToString = {\n+        value: function () {\n+          return \"function () { [omitted code] }\";\n+        },\n+        configurable: !0,\n+        writable: !0\n+      },\n       PROMISE_PROTOTYPE = Promise.prototype,\n       deepProxyHandlers = {\n         get: function (target, name) {\n@@ -6102,7 +6079,7 @@\n       patchConsole(console, \"table\"),\n       patchConsole(console, \"trace\"),\n       patchConsole(console, \"warn\"));\n-    var ObjectPrototype = Object.prototype,\n+    var ObjectPrototype$1 = Object.prototype,\n       stringify = JSON.stringify,\n       ABORTING = 12,\n       CLOSED = 14,\n@@ -6133,7 +6110,23 @@\n       }\n       switch (this.status) {\n         case \"fulfilled\":\n-          \"function\" === typeof resolve && resolve(this.value);\n+          if (\"function\" === typeof resolve) {\n+            for (\n+              var inspectedValue = this.value;\n+              inspectedValue instanceof ReactPromise;\n+\n+            ) {\n+              if (inspectedValue === this) {\n+                \"function\" === typeof reject &&\n+                  reject(Error(\"Cannot have cyclic thenables.\"));\n+                return;\n+              }\n+              if (\"fulfilled\" === inspectedValue.status)\n+                inspectedValue = inspectedValue.value;\n+              else break;\n+            }\n+            resolve(this.value);\n+          }\n           break;\n         case \"pending\":\n         case \"blocked\":\n@@ -6148,7 +6141,9 @@\n           \"function\" === typeof reject && reject(this.reason);\n       }\n     };\n-    var initializingHandler = null;\n+    var ObjectPrototype = Object.prototype,\n+      ArrayPrototype = Array.prototype,\n+      initializingHandler = null;\n     exports.createClientModuleProxy = function (moduleId) {\n       moduleId = registerClientReferenceImpl({}, moduleId, !1);\n       return new Proxy(moduleId, proxyHandlers$1);\n@@ -6276,13 +6271,13 @@\n           );\n         else {\n           pendingFiles++;\n-          var JSCompiler_object_inline_chunks_276 = [];\n+          var JSCompiler_object_inline_chunks_286 = [];\n           value.on(\"data\", function (chunk) {\n-            JSCompiler_object_inline_chunks_276.push(chunk);\n+            JSCompiler_object_inline_chunks_286.push(chunk);\n           });\n           value.on(\"end\", function () {\n             try {\n-              var blob = new Blob(JSCompiler_object_inline_chunks_276, {\n+              var blob = new Blob(JSCompiler_object_inline_chunks_286, {\n                 type: mimeType\n               });\n               response._formData.append(name, blob, filename);\n@@ -6416,7 +6411,8 @@\n         },\n         $$bound: { value: null, configurable: !0 },\n         $$location: { value: Error(\"react-stack-top-frame\"), configurable: !0 },\n-        bind: { value: bind, configurable: !0 }\n+        bind: { value: bind, configurable: !0 },\n+        toString: serverReferenceToString\n       });\n     };\n     exports.renderToPipeableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "3b6893f5d49f927cdfe011641acb4223234c7434",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/cjs/react-server-dom-turbopack-server.node.production.js",
            "status": "modified",
            "additions": 172,
            "deletions": 175,
            "changes": 347,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fcjs%2Freact-server-dom-turbopack-server.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -139,7 +139,14 @@ function bind() {\n   }\n   return newFn;\n }\n-var PROMISE_PROTOTYPE = Promise.prototype,\n+var serverReferenceToString = {\n+    value: function () {\n+      return \"function () { [omitted code] }\";\n+    },\n+    configurable: !0,\n+    writable: !0\n+  },\n+  PROMISE_PROTOTYPE = Promise.prototype,\n   deepProxyHandlers = {\n     get: function (target, name) {\n       switch (name) {\n@@ -837,7 +844,7 @@ function describeObjectForErrorMessage(objectOrArray, expandedName) {\n       : \"\\n  \" + str;\n }\n var hasOwnProperty = Object.prototype.hasOwnProperty,\n-  ObjectPrototype = Object.prototype,\n+  ObjectPrototype$1 = Object.prototype,\n   stringify = JSON.stringify,\n   TaintRegistryObjects = ReactSharedInternalsServer.TaintRegistryObjects,\n   TaintRegistryValues = ReactSharedInternalsServer.TaintRegistryValues,\n@@ -1745,7 +1752,7 @@ function renderModelDestructive(\n     if (value instanceof Date) return \"$D\" + value.toJSON();\n     request = getPrototypeOf(value);\n     if (\n-      request !== ObjectPrototype &&\n+      request !== ObjectPrototype$1 &&\n       (null === request || null !== getPrototypeOf(request))\n     )\n       throw Error(\n@@ -1798,7 +1805,7 @@ function renderModelDestructive(\n         (task = request.writtenServerReferences),\n         (parentPropertyName = task.get(value)),\n         void 0 !== parentPropertyName\n-          ? (value = \"$F\" + parentPropertyName.toString(16))\n+          ? (value = \"$h\" + parentPropertyName.toString(16))\n           : ((parentPropertyName = value.$$bound),\n             (parentPropertyName =\n               null === parentPropertyName\n@@ -1810,7 +1817,7 @@ function renderModelDestructive(\n               0\n             )),\n             task.set(value, request),\n-            (value = \"$F\" + request.toString(16))),\n+            (value = \"$h\" + request.toString(16))),\n         value\n       );\n     if (\n@@ -2353,7 +2360,23 @@ ReactPromise.prototype.then = function (resolve, reject) {\n   }\n   switch (this.status) {\n     case \"fulfilled\":\n-      \"function\" === typeof resolve && resolve(this.value);\n+      if (\"function\" === typeof resolve) {\n+        for (\n+          var inspectedValue = this.value;\n+          inspectedValue instanceof ReactPromise;\n+\n+        ) {\n+          if (inspectedValue === this) {\n+            \"function\" === typeof reject &&\n+              reject(Error(\"Cannot have cyclic thenables.\"));\n+            return;\n+          }\n+          if (\"fulfilled\" === inspectedValue.status)\n+            inspectedValue = inspectedValue.value;\n+          else break;\n+        }\n+        resolve(this.value);\n+      }\n       break;\n     case \"pending\":\n     case \"blocked\":\n@@ -2366,6 +2389,8 @@ ReactPromise.prototype.then = function (resolve, reject) {\n       \"function\" === typeof reject && reject(this.reason);\n   }\n };\n+var ObjectPrototype = Object.prototype,\n+  ArrayPrototype = Array.prototype;\n function wakeChunk(response, listeners, value) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n@@ -2543,6 +2568,7 @@ function loadServerReference$1(response, metaData, parentObject, key) {\n           ((promiseValue = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n+          (resolvedValue.reason = null),\n           null !== promiseValue &&\n             wakeChunk(response, promiseValue, handler.value)));\n     },\n@@ -2634,6 +2660,7 @@ function initializeModelChunk(chunk) {\n     }\n     chunk.status = \"fulfilled\";\n     chunk.value = value;\n+    chunk.reason = null;\n   } catch (error) {\n     (chunk.status = \"rejected\"), (chunk.reason = error);\n   } finally {\n@@ -2644,7 +2671,11 @@ function reportGlobalError(response, error) {\n   response._closed = !0;\n   response._closedReason = error;\n   response._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status && triggerErrorOnChunk(response, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(response, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function getChunk(response, id) {\n@@ -2662,58 +2693,41 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n-    for (; value instanceof ReactPromise; ) {\n-      switch (value.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(value);\n-      }\n-      switch (value.status) {\n-        case \"fulfilled\":\n-          value = value.value;\n-          continue;\n-        case \"blocked\":\n-        case \"pending\":\n-          path.splice(0, i - 1);\n-          null === value.value\n-            ? (value.value = [reference])\n-            : value.value.push(reference);\n-          null === value.reason\n-            ? (value.reason = [reference])\n-            : value.reason.push(reference);\n-          return;\n-        default:\n-          rejectReference(response, reference.handler, value.reason);\n-          return;\n-      }\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      var name = path[i];\n+      if (\n+        \"object\" !== typeof value ||\n+        null === value ||\n+        (getPrototypeOf(value) !== ObjectPrototype &&\n+          getPrototypeOf(value) !== ArrayPrototype) ||\n+        !hasOwnProperty.call(value, name)\n+      )\n+        throw Error(\"Invalid reference.\");\n+      value = value[name];\n     }\n-    var name = path[i];\n-    \"object\" === typeof value &&\n-      hasOwnProperty.call(value, name) &&\n-      (value = value[name]);\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n   }\n-  reference = map(response, value, parentObject, key);\n-  parentObject[key] = reference;\n-  \"\" === key && null === handler.value && (handler.value = reference);\n   handler.deps--;\n   0 === handler.deps &&\n-    ((parentObject = handler.chunk),\n-    null !== parentObject &&\n-      \"blocked\" === parentObject.status &&\n-      ((key = parentObject.value),\n-      (parentObject.status = \"fulfilled\"),\n-      (parentObject.value = handler.value),\n-      (parentObject.reason = handler.reason),\n-      null !== key && wakeChunk(response, key, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -2725,33 +2739,6 @@ function rejectReference(response, handler, error) {\n       \"blocked\" === handler.status &&\n       triggerErrorOnChunk(response, handler, error));\n }\n-function waitForReference(\n-  referencedChunk,\n-  parentObject,\n-  key,\n-  response,\n-  map,\n-  path\n-) {\n-  initializingHandler\n-    ? ((response = initializingHandler), response.deps++)\n-    : (response = initializingHandler =\n-        { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-  parentObject = {\n-    handler: response,\n-    parentObject: parentObject,\n-    key: key,\n-    map: map,\n-    path: path\n-  };\n-  null === referencedChunk.value\n-    ? (referencedChunk.value = [parentObject])\n-    : referencedChunk.value.push(parentObject);\n-  null === referencedChunk.reason\n-    ? (referencedChunk.reason = [parentObject])\n-    : referencedChunk.reason.push(parentObject);\n-  return null;\n-}\n function getOutlinedModel(response, reference, parentObject, key, map) {\n   reference = reference.split(\":\");\n   var id = parseInt(reference[0], 16);\n@@ -2762,53 +2749,42 @@ function getOutlinedModel(response, reference, parentObject, key, map) {\n   }\n   switch (id.status) {\n     case \"fulfilled\":\n-      var value = id.value;\n-      for (id = 1; id < reference.length; id++) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              break;\n-            case \"blocked\":\n-            case \"pending\":\n-              return waitForReference(\n-                value,\n-                parentObject,\n-                key,\n-                response,\n-                map,\n-                reference.slice(id - 1)\n-              );\n-            default:\n-              return (\n-                initializingHandler\n-                  ? ((initializingHandler.errored = !0),\n-                    (initializingHandler.value = null),\n-                    (initializingHandler.reason = value.reason))\n-                  : (initializingHandler = {\n-                      chunk: null,\n-                      value: null,\n-                      reason: value.reason,\n-                      deps: 0,\n-                      errored: !0\n-                    }),\n-                null\n-              );\n-          }\n-        }\n-        var name = reference[id];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+      id = id.value;\n+      for (var i = 1; i < reference.length; i++) {\n+        var name = reference[i];\n+        if (\n+          \"object\" !== typeof id ||\n+          null === id ||\n+          (getPrototypeOf(id) !== ObjectPrototype &&\n+            getPrototypeOf(id) !== ArrayPrototype) ||\n+          !hasOwnProperty.call(id, name)\n+        )\n+          throw Error(\"Invalid reference.\");\n+        id = id[name];\n       }\n-      return map(response, value, parentObject, key);\n+      return map(response, id, parentObject, key);\n     case \"pending\":\n     case \"blocked\":\n-      return waitForReference(id, parentObject, key, response, map, reference);\n+      return (\n+        initializingHandler\n+          ? ((response = initializingHandler), response.deps++)\n+          : (response = initializingHandler =\n+              { chunk: null, value: null, reason: null, deps: 1, errored: !1 }),\n+        (parentObject = {\n+          handler: response,\n+          parentObject: parentObject,\n+          key: key,\n+          map: map,\n+          path: reference\n+        }),\n+        null === id.value\n+          ? (id.value = [parentObject])\n+          : id.value.push(parentObject),\n+        null === id.reason\n+          ? (id.reason = [parentObject])\n+          : id.reason.push(parentObject),\n+        null\n+      );\n     default:\n       return (\n         initializingHandler\n@@ -2847,9 +2823,10 @@ function parseTypedArray(\n   parentKey\n ) {\n   reference = parseInt(reference.slice(2), 16);\n-  reference = response._formData\n-    .get(response._prefix + reference)\n-    .arrayBuffer();\n+  bytesPerElement = response._prefix + reference;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized typed array.\");\n+  reference = response._formData.get(bytesPerElement).arrayBuffer();\n   if (initializingHandler) {\n     var handler = initializingHandler;\n     handler.deps++;\n@@ -2875,6 +2852,7 @@ function parseTypedArray(\n         var resolveListeners = buffer.value;\n         buffer.status = \"fulfilled\";\n         buffer.value = handler.value;\n+        buffer.reason = null;\n         null !== resolveListeners &&\n           wakeChunk(response, resolveListeners, handler.value);\n       }\n@@ -2907,7 +2885,10 @@ function resolveStream(response, id, stream, controller) {\n }\n function parseReadableStream(response, reference, type) {\n   reference = parseInt(reference.slice(2), 16);\n-  var controller = null;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -2950,24 +2931,27 @@ function parseReadableStream(response, reference, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n   return type;\n@@ -2982,6 +2966,8 @@ function createIterator(next) {\n }\n function parseAsyncIterable(response, reference, iterator) {\n   reference = parseInt(reference.slice(2), 16);\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n   var buffer = [],\n     closed = !1,\n     nextWriteIndex = 0,\n@@ -3025,36 +3011,46 @@ function parseAsyncIterable(response, reference, iterator) {\n       nextWriteIndex++;\n     },\n     close: function (value) {\n-      closed = !0;\n-      nextWriteIndex === buffer.length\n-        ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length\n+              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                  response,\n+                  value,\n+                  !0\n+                ))\n+              : resolveIteratorResultChunk(\n+                  response,\n+                  buffer[nextWriteIndex],\n+                  value,\n+                  !0\n+                ),\n+            nextWriteIndex++;\n+          nextWriteIndex < buffer.length;\n+\n+        )\n+          resolveIteratorResultChunk(\n             response,\n-            value,\n-            !0\n-          ))\n-        : resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex],\n-            value,\n+            buffer[nextWriteIndex++],\n+            '\"$undefined\"',\n             !0\n           );\n-      for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-        resolveIteratorResultChunk(\n-          response,\n-          buffer[nextWriteIndex++],\n-          '\"$undefined\"',\n-          !0\n-        );\n     },\n     error: function (error) {\n-      closed = !0;\n-      for (\n-        nextWriteIndex === buffer.length &&\n-        (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-        nextWriteIndex < buffer.length;\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length &&\n+              (buffer[nextWriteIndex] = new ReactPromise(\n+                \"pending\",\n+                null,\n+                null\n+              ));\n+          nextWriteIndex < buffer.length;\n \n-      )\n-        triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+        )\n+          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n     }\n   });\n   return iterator;\n@@ -3066,7 +3062,7 @@ function parseModelString(response, obj, key, value, reference) {\n         return value.slice(1);\n       case \"@\":\n         return (obj = parseInt(value.slice(2), 16)), getChunk(response, obj);\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -3377,13 +3373,13 @@ exports.decodeReplyFromBusboy = function (busboyStream, turbopackMap, options) {\n       );\n     else {\n       pendingFiles++;\n-      var JSCompiler_object_inline_chunks_284 = [];\n+      var JSCompiler_object_inline_chunks_294 = [];\n       value.on(\"data\", function (chunk) {\n-        JSCompiler_object_inline_chunks_284.push(chunk);\n+        JSCompiler_object_inline_chunks_294.push(chunk);\n       });\n       value.on(\"end\", function () {\n         try {\n-          var blob = new Blob(JSCompiler_object_inline_chunks_284, {\n+          var blob = new Blob(JSCompiler_object_inline_chunks_294, {\n             type: mimeType\n           });\n           response._formData.append(name, blob, filename);\n@@ -3510,7 +3506,8 @@ exports.registerServerReference = function (reference, id, exportName) {\n       configurable: !0\n     },\n     $$bound: { value: null, configurable: !0 },\n-    bind: { value: bind, configurable: !0 }\n+    bind: { value: bind, configurable: !0 },\n+    toString: serverReferenceToString\n   });\n };\n exports.renderToPipeableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "0d543d18c69fe1f829a8a314c334bcb7594edcad",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack-experimental/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack-experimental%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -48,7 +48,7 @@\n     \"neo-async\": \"^2.6.1\"\n   },\n   \"peerDependencies\": {\n-    \"react\": \"0.0.0-experimental-55480b4d-20251208\",\n-    \"react-dom\": \"0.0.0-experimental-55480b4d-20251208\"\n+    \"react\": \"0.0.0-experimental-80cb7a99-20251211\",\n+    \"react-dom\": \"0.0.0-experimental-80cb7a99-20251211\"\n   }\n }\n\\ No newline at end of file"
        },
        {
            "sha": "8291db8185e0d1d5df1da7f34d3753d64414d357",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-client.browser.development.js",
            "status": "modified",
            "additions": 182,
            "deletions": 148,
            "changes": 330,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -488,13 +488,23 @@\n                 pendingParts--;\n               }\n           }\n+          parentReference = writtenObjects.get(value);\n           if (\"function\" === typeof value.then) {\n+            if (void 0 !== parentReference)\n+              if (modelRoot === value) modelRoot = null;\n+              else return parentReference;\n             null === formData && (formData = new FormData());\n             pendingParts++;\n             var promiseId = nextPartId++;\n+            key = \"$@\" + promiseId.toString(16);\n+            writtenObjects.set(value, key);\n             value.then(function (partValue) {\n               try {\n-                var _partJSON3 = serializeModel(partValue, promiseId);\n+                var previousReference = writtenObjects.get(partValue);\n+                var _partJSON3 =\n+                  void 0 !== previousReference\n+                    ? JSON.stringify(previousReference)\n+                    : serializeModel(partValue, promiseId);\n                 partValue = formData;\n                 partValue.append(formFieldPrefix + promiseId, _partJSON3);\n                 pendingParts--;\n@@ -503,9 +513,8 @@\n                 reject(reason);\n               }\n             }, reject);\n-            return \"$@\" + promiseId.toString(16);\n+            return key;\n           }\n-          parentReference = writtenObjects.get(value);\n           if (void 0 !== parentReference)\n             if (modelRoot === value) modelRoot = null;\n             else return parentReference;\n@@ -663,7 +672,7 @@\n               null === formData && (formData = new FormData()),\n               (parentReference = nextPartId++),\n               formData.set(formFieldPrefix + parentReference, key),\n-              \"$F\" + parentReference.toString(16)\n+              \"$h\" + parentReference.toString(16)\n             );\n           if (\n             void 0 !== temporaryReferences &&\n@@ -1668,6 +1677,7 @@\n           rejectListeners = chunk.reason;\n         chunk.status = \"resolved_module\";\n         chunk.value = value;\n+        chunk.reason = null;\n         value = value[1];\n         for (var debugInfo = [], i = 0; i < value.length; ) {\n           var chunkFilename = value[i++],\n@@ -1853,8 +1863,11 @@\n         response._closed = !0;\n         response._closedReason = error;\n         response._chunks.forEach(function (chunk) {\n-          \"pending\" === chunk.status &&\n-            triggerErrorOnChunk(response, chunk, error);\n+          \"pending\" === chunk.status\n+            ? triggerErrorOnChunk(response, chunk, error)\n+            : \"fulfilled\" === chunk.status &&\n+              null !== chunk.reason &&\n+              chunk.reason.error(error);\n         });\n         weakResponse = response._debugChannel;\n         void 0 !== weakResponse &&\n@@ -1959,125 +1972,136 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value, fulfilledChunk) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          for (\n+            ;\n+            \"object\" === typeof value &&\n+            null !== value &&\n+            value.$$typeof === REACT_LAZY_TYPE;\n+\n+          ) {\n+            var referencedChunk = value._payload;\n+            if (referencedChunk === handler.chunk) value = handler.value;\n+            else {\n+              switch (referencedChunk.status) {\n+                case \"resolved_model\":\n+                  initializeModelChunk(referencedChunk);\n+                  break;\n+                case \"resolved_module\":\n+                  initializeModuleChunk(referencedChunk);\n+              }\n+              switch (referencedChunk.status) {\n+                case \"fulfilled\":\n+                  value = referencedChunk.value;\n+                  continue;\n+                case \"blocked\":\n+                  var cyclicHandler = resolveBlockedCycle(\n+                    referencedChunk,\n+                    reference\n+                  );\n+                  if (null !== cyclicHandler) {\n+                    value = cyclicHandler.value;\n+                    continue;\n+                  }\n+                case \"pending\":\n+                  path.splice(0, i - 1);\n+                  null === referencedChunk.value\n+                    ? (referencedChunk.value = [reference])\n+                    : referencedChunk.value.push(reference);\n+                  null === referencedChunk.reason\n+                    ? (referencedChunk.reason = [reference])\n+                    : referencedChunk.reason.push(reference);\n+                  return;\n+                case \"halted\":\n+                  return;\n+                default:\n+                  rejectReference(\n+                    response,\n+                    reference.handler,\n+                    referencedChunk.reason\n+                  );\n+                  return;\n+              }\n+            }\n+          }\n+          value = value[path[i]];\n+        }\n         for (\n           ;\n           \"object\" === typeof value &&\n           null !== value &&\n           value.$$typeof === REACT_LAZY_TYPE;\n \n-        )\n-          if (((value = value._payload), value === handler.chunk))\n-            value = handler.value;\n+        ) {\n+          var _referencedChunk = value._payload;\n+          if (_referencedChunk === handler.chunk) value = handler.value;\n           else {\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"resolved_model\":\n-                initializeModelChunk(value);\n+                initializeModelChunk(_referencedChunk);\n                 break;\n               case \"resolved_module\":\n-                initializeModuleChunk(value);\n+                initializeModuleChunk(_referencedChunk);\n             }\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"fulfilled\":\n-                value = value.value;\n+                value = _referencedChunk.value;\n                 continue;\n-              case \"blocked\":\n-                var cyclicHandler = resolveBlockedCycle(value, reference);\n-                if (null !== cyclicHandler) {\n-                  value = cyclicHandler.value;\n-                  continue;\n-                }\n-              case \"pending\":\n-                path.splice(0, i - 1);\n-                null === value.value\n-                  ? (value.value = [reference])\n-                  : value.value.push(reference);\n-                null === value.reason\n-                  ? (value.reason = [reference])\n-                  : value.reason.push(reference);\n-                return;\n-              case \"halted\":\n-                return;\n-              default:\n-                rejectReference(response, reference.handler, value.reason);\n-                return;\n             }\n+            break;\n           }\n-        value = value[path[i]];\n-      }\n-      for (\n-        ;\n-        \"object\" === typeof value &&\n-        null !== value &&\n-        value.$$typeof === REACT_LAZY_TYPE;\n-\n-      )\n-        if (((path = value._payload), path === handler.chunk))\n-          value = handler.value;\n-        else {\n-          switch (path.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(path);\n+        }\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+        if (\n+          parentObject[0] === REACT_ELEMENT_TYPE &&\n+          \"object\" === typeof handler.value &&\n+          null !== handler.value &&\n+          handler.value.$$typeof === REACT_ELEMENT_TYPE\n+        ) {\n+          var element = handler.value;\n+          switch (key) {\n+            case \"3\":\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+              element.props = mappedValue;\n               break;\n-            case \"resolved_module\":\n-              initializeModuleChunk(path);\n-          }\n-          switch (path.status) {\n-            case \"fulfilled\":\n-              value = path.value;\n-              continue;\n+            case \"4\":\n+              element._owner = mappedValue;\n+              break;\n+            case \"5\":\n+              element._debugStack = mappedValue;\n+              break;\n+            default:\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n           }\n-          break;\n-        }\n-      map = map(response, value, parentObject, key);\n-      parentObject[key] = map;\n-      \"\" === key && null === handler.value && (handler.value = map);\n-      if (\n-        parentObject[0] === REACT_ELEMENT_TYPE &&\n-        \"object\" === typeof handler.value &&\n-        null !== handler.value &&\n-        handler.value.$$typeof === REACT_ELEMENT_TYPE\n-      )\n-        switch (((reference = handler.value), key)) {\n-          case \"3\":\n-            transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-            reference.props = map;\n-            break;\n-          case \"4\":\n-            reference._owner = map;\n-            break;\n-          case \"5\":\n-            reference._debugStack = map;\n-            break;\n-          default:\n+        } else\n+          reference.isDebug ||\n             transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-        }\n-      else\n-        reference.isDebug ||\n-          transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n+      }\n       handler.deps--;\n       0 === handler.deps &&\n-        ((fulfilledChunk = handler.chunk),\n-        null !== fulfilledChunk &&\n-          \"blocked\" === fulfilledChunk.status &&\n-          ((key = fulfilledChunk.value),\n-          (fulfilledChunk.status = \"fulfilled\"),\n-          (fulfilledChunk.value = handler.value),\n-          (fulfilledChunk.reason = handler.reason),\n-          null !== key\n-            ? wakeChunk(response, key, handler.value, fulfilledChunk)\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value\n+            ? wakeChunk(response, value, handler.value, reference)\n             : ((handler = handler.value),\n-              filterDebugInfo(response, fulfilledChunk),\n-              moveDebugInfoFromChunkToInnerValue(fulfilledChunk, handler))));\n+              filterDebugInfo(response, reference),\n+              moveDebugInfoFromChunkToInnerValue(reference, handler))));\n     }\n     function rejectReference(response, handler, error) {\n       if (!handler.errored) {\n@@ -2223,6 +2247,7 @@\n               ((boundArgs = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== boundArgs\n                 ? wakeChunk(response, boundArgs, handler.value, resolvedValue)\n                 : ((boundArgs = handler.value),\n@@ -2548,7 +2573,7 @@\n             );\n           case \"S\":\n             return Symbol.for(value.slice(2));\n-          case \"F\":\n+          case \"h\":\n             var ref = value.slice(2);\n             return getOutlinedModel(\n               response,\n@@ -2926,7 +2951,8 @@\n           chunks.set(id, stream);\n     }\n     function startReadableStream(response, id, type, streamState) {\n-      var controller = null;\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -2981,24 +3007,28 @@\n             }\n           },\n           close: function () {\n-            if (null === previousBlockedChunk) controller.close();\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.close();\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.close();\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.close();\n+                });\n+              }\n           },\n           error: function (error) {\n-            if (null === previousBlockedChunk) controller.error(error);\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.error(error);\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.error(error);\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.error(error);\n+                });\n+              }\n           }\n         },\n         streamState\n@@ -3054,6 +3084,7 @@\n                 rejectListeners = chunk.reason;\n               chunk.status = \"fulfilled\";\n               chunk.value = { done: !1, value: value };\n+              chunk.reason = null;\n               null !== resolveListeners &&\n                 wakeChunkIfInitialized(\n                   response,\n@@ -3080,36 +3111,39 @@\n             nextWriteIndex++;\n           },\n           close: function (value) {\n-            closed = !0;\n-            nextWriteIndex === buffer.length\n-              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                  response,\n-                  value,\n-                  !0\n-                ))\n-              : resolveIteratorResultChunk(\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length\n+                    ? (buffer[nextWriteIndex] =\n+                        createResolvedIteratorResultChunk(response, value, !0))\n+                    : resolveIteratorResultChunk(\n+                        response,\n+                        buffer[nextWriteIndex],\n+                        value,\n+                        !0\n+                      ),\n+                  nextWriteIndex++;\n+                nextWriteIndex < buffer.length;\n+\n+              )\n+                resolveIteratorResultChunk(\n                   response,\n-                  buffer[nextWriteIndex],\n-                  value,\n+                  buffer[nextWriteIndex++],\n+                  '\"$undefined\"',\n                   !0\n                 );\n-            for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-              resolveIteratorResultChunk(\n-                response,\n-                buffer[nextWriteIndex++],\n-                '\"$undefined\"',\n-                !0\n-              );\n           },\n           error: function (error) {\n-            closed = !0;\n-            for (\n-              nextWriteIndex === buffer.length &&\n-              (buffer[nextWriteIndex] = createPendingChunk(response));\n-              nextWriteIndex < buffer.length;\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length &&\n+                    (buffer[nextWriteIndex] = createPendingChunk(response));\n+                nextWriteIndex < buffer.length;\n \n-            )\n-              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+              )\n+                triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n           }\n         },\n         streamState\n@@ -4966,10 +5000,10 @@\n       return hook.checkDCE ? !0 : !1;\n     })({\n       bundleType: 1,\n-      version: \"19.3.0-canary-55480b4d-20251208\",\n+      version: \"19.3.0-canary-80cb7a99-20251211\",\n       rendererPackageName: \"react-server-dom-turbopack\",\n       currentDispatcherRef: ReactSharedInternals,\n-      reconcilerVersion: \"19.3.0-canary-55480b4d-20251208\",\n+      reconcilerVersion: \"19.3.0-canary-80cb7a99-20251211\",\n       getCurrentComponentInfo: function () {\n         return currentOwnerInDEV;\n       }"
        },
        {
            "sha": "b2df86e17d76eb425939b9b4351d781890e1d8d1",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-client.browser.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -292,13 +292,23 @@ function processReply(\n             pendingParts--;\n           }\n       }\n+      parentReference = writtenObjects.get(value);\n       if (\"function\" === typeof value.then) {\n+        if (void 0 !== parentReference)\n+          if (modelRoot === value) modelRoot = null;\n+          else return parentReference;\n         null === formData && (formData = new FormData());\n         pendingParts++;\n         var promiseId = nextPartId++;\n+        key = \"$@\" + promiseId.toString(16);\n+        writtenObjects.set(value, key);\n         value.then(function (partValue) {\n           try {\n-            var partJSON$27 = serializeModel(partValue, promiseId);\n+            var previousReference = writtenObjects.get(partValue);\n+            var partJSON$27 =\n+              void 0 !== previousReference\n+                ? JSON.stringify(previousReference)\n+                : serializeModel(partValue, promiseId);\n             partValue = formData;\n             partValue.append(formFieldPrefix + promiseId, partJSON$27);\n             pendingParts--;\n@@ -307,9 +317,8 @@ function processReply(\n             reject(reason);\n           }\n         }, reject);\n-        return \"$@\" + promiseId.toString(16);\n+        return key;\n       }\n-      parentReference = writtenObjects.get(value);\n       if (void 0 !== parentReference)\n         if (modelRoot === value) modelRoot = null;\n         else return parentReference;\n@@ -433,7 +442,7 @@ function processReply(\n           null === formData && (formData = new FormData()),\n           (parentReference = nextPartId++),\n           formData.set(formFieldPrefix + parentReference, key),\n-          \"$F\" + parentReference.toString(16)\n+          \"$h\" + parentReference.toString(16)\n         );\n       if (\n         void 0 !== temporaryReferences &&\n@@ -568,12 +577,12 @@ function readChunk(chunk) {\n       throw chunk.reason;\n   }\n }\n-function wakeChunk(response, listeners, value) {\n+function wakeChunk(response, listeners, value, chunk) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n     \"function\" === typeof listener\n       ? listener(value)\n-      : fulfillReference(response, listener, value);\n+      : fulfillReference(response, listener, value, chunk);\n   }\n }\n function rejectChunk(response, listeners, error) {\n@@ -613,7 +622,7 @@ function wakeChunkIfInitialized(\n ) {\n   switch (chunk.status) {\n     case \"fulfilled\":\n-      wakeChunk(response, resolveListeners, chunk.value);\n+      wakeChunk(response, resolveListeners, chunk.value, chunk);\n       break;\n     case \"blocked\":\n       for (var i = 0; i < resolveListeners.length; i++) {\n@@ -622,7 +631,7 @@ function wakeChunkIfInitialized(\n           var cyclicHandler = resolveBlockedCycle(chunk, listener);\n           if (null !== cyclicHandler)\n             switch (\n-              (fulfillReference(response, listener, cyclicHandler.value),\n+              (fulfillReference(response, listener, cyclicHandler.value, chunk),\n               resolveListeners.splice(i, 1),\n               i--,\n               null !== rejectListeners &&\n@@ -631,7 +640,7 @@ function wakeChunkIfInitialized(\n               chunk.status)\n             ) {\n               case \"fulfilled\":\n-                wakeChunk(response, resolveListeners, chunk.value);\n+                wakeChunk(response, resolveListeners, chunk.value, chunk);\n                 return;\n               case \"rejected\":\n                 null !== rejectListeners &&\n@@ -707,6 +716,7 @@ function resolveModuleChunk(response, chunk, value) {\n       rejectListeners = chunk.reason;\n     chunk.status = \"resolved_module\";\n     chunk.value = value;\n+    chunk.reason = null;\n     null !== resolveListeners &&\n       (initializeModuleChunk(chunk),\n       wakeChunkIfInitialized(\n@@ -769,8 +779,11 @@ function reportGlobalError(weakResponse, error) {\n   weakResponse._closed = !0;\n   weakResponse._closedReason = error;\n   weakResponse._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status &&\n-      triggerErrorOnChunk(weakResponse, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(weakResponse, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function createLazyChunkWrapper(chunk) {\n@@ -787,109 +800,120 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      for (\n+        ;\n+        \"object\" === typeof value &&\n+        null !== value &&\n+        value.$$typeof === REACT_LAZY_TYPE;\n+\n+      ) {\n+        var referencedChunk = value._payload;\n+        if (referencedChunk === handler.chunk) value = handler.value;\n+        else {\n+          switch (referencedChunk.status) {\n+            case \"resolved_model\":\n+              initializeModelChunk(referencedChunk);\n+              break;\n+            case \"resolved_module\":\n+              initializeModuleChunk(referencedChunk);\n+          }\n+          switch (referencedChunk.status) {\n+            case \"fulfilled\":\n+              value = referencedChunk.value;\n+              continue;\n+            case \"blocked\":\n+              var cyclicHandler = resolveBlockedCycle(\n+                referencedChunk,\n+                reference\n+              );\n+              if (null !== cyclicHandler) {\n+                value = cyclicHandler.value;\n+                continue;\n+              }\n+            case \"pending\":\n+              path.splice(0, i - 1);\n+              null === referencedChunk.value\n+                ? (referencedChunk.value = [reference])\n+                : referencedChunk.value.push(reference);\n+              null === referencedChunk.reason\n+                ? (referencedChunk.reason = [reference])\n+                : referencedChunk.reason.push(reference);\n+              return;\n+            case \"halted\":\n+              return;\n+            default:\n+              rejectReference(\n+                response,\n+                reference.handler,\n+                referencedChunk.reason\n+              );\n+              return;\n+          }\n+        }\n+      }\n+      value = value[path[i]];\n+    }\n     for (\n       ;\n       \"object\" === typeof value &&\n       null !== value &&\n       value.$$typeof === REACT_LAZY_TYPE;\n \n-    )\n-      if (((value = value._payload), value === handler.chunk))\n-        value = handler.value;\n+    ) {\n+      var referencedChunk$43 = value._payload;\n+      if (referencedChunk$43 === handler.chunk) value = handler.value;\n       else {\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"resolved_model\":\n-            initializeModelChunk(value);\n+            initializeModelChunk(referencedChunk$43);\n             break;\n           case \"resolved_module\":\n-            initializeModuleChunk(value);\n+            initializeModuleChunk(referencedChunk$43);\n         }\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"fulfilled\":\n-            value = value.value;\n+            value = referencedChunk$43.value;\n             continue;\n-          case \"blocked\":\n-            var cyclicHandler = resolveBlockedCycle(value, reference);\n-            if (null !== cyclicHandler) {\n-              value = cyclicHandler.value;\n-              continue;\n-            }\n-          case \"pending\":\n-            path.splice(0, i - 1);\n-            null === value.value\n-              ? (value.value = [reference])\n-              : value.value.push(reference);\n-            null === value.reason\n-              ? (value.reason = [reference])\n-              : value.reason.push(reference);\n-            return;\n-          case \"halted\":\n-            return;\n-          default:\n-            rejectReference(response, reference.handler, value.reason);\n-            return;\n         }\n+        break;\n       }\n-    value = value[path[i]];\n-  }\n-  for (\n-    ;\n-    \"object\" === typeof value &&\n-    null !== value &&\n-    value.$$typeof === REACT_LAZY_TYPE;\n-\n-  )\n-    if (((reference = value._payload), reference === handler.chunk))\n-      value = handler.value;\n-    else {\n-      switch (reference.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(reference);\n-          break;\n-        case \"resolved_module\":\n-          initializeModuleChunk(reference);\n-      }\n-      switch (reference.status) {\n-        case \"fulfilled\":\n-          value = reference.value;\n-          continue;\n-      }\n-      break;\n     }\n-  map = map(response, value, parentObject, key);\n-  parentObject[key] = map;\n-  \"\" === key && null === handler.value && (handler.value = map);\n-  if (\n-    parentObject[0] === REACT_ELEMENT_TYPE &&\n-    \"object\" === typeof handler.value &&\n-    null !== handler.value &&\n-    handler.value.$$typeof === REACT_ELEMENT_TYPE\n-  )\n-    switch (((parentObject = handler.value), key)) {\n-      case \"3\":\n-        parentObject.props = map;\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+    if (\n+      parentObject[0] === REACT_ELEMENT_TYPE &&\n+      \"object\" === typeof handler.value &&\n+      null !== handler.value &&\n+      handler.value.$$typeof === REACT_ELEMENT_TYPE\n+    ) {\n+      var element = handler.value;\n+      switch (key) {\n+        case \"3\":\n+          element.props = mappedValue;\n+      }\n     }\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n+  }\n   handler.deps--;\n   0 === handler.deps &&\n-    ((key = handler.chunk),\n-    null !== key &&\n-      \"blocked\" === key.status &&\n-      ((parentObject = key.value),\n-      (key.status = \"fulfilled\"),\n-      (key.value = handler.value),\n-      (key.reason = handler.reason),\n-      null !== parentObject &&\n-        wakeChunk(response, parentObject, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value, reference)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -993,7 +1017,9 @@ function loadServerReference(response, metaData, parentObject, key) {\n           ((boundArgs = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n-          null !== boundArgs && wakeChunk(response, boundArgs, handler.value)));\n+          (resolvedValue.reason = null),\n+          null !== boundArgs &&\n+            wakeChunk(response, boundArgs, handler.value, resolvedValue)));\n     },\n     function (error) {\n       if (!handler.errored) {\n@@ -1198,7 +1224,7 @@ function parseModelString(response, parentObject, key, value) {\n         );\n       case \"S\":\n         return Symbol.for(value.slice(2));\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(\n@@ -1337,12 +1363,13 @@ function resolveStream(response, id, stream, controller) {\n       (chunk.status = \"fulfilled\"),\n       (chunk.value = stream),\n       (chunk.reason = controller),\n-      null !== id && wakeChunk(response, id, chunk.value))\n+      null !== id && wakeChunk(response, id, chunk.value, chunk))\n     : ((response = new ReactPromise(\"fulfilled\", stream, controller)),\n       chunks.set(id, response));\n }\n function startReadableStream(response, id, type) {\n-  var controller = null;\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -1392,24 +1419,27 @@ function startReadableStream(response, id, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n }\n@@ -1463,6 +1493,7 @@ function startAsyncIterable(response, id, iterator) {\n             rejectListeners = chunk.reason;\n           chunk.status = \"fulfilled\";\n           chunk.value = { done: !1, value: value };\n+          chunk.reason = null;\n           null !== resolveListeners &&\n             wakeChunkIfInitialized(\n               response,\n@@ -1489,36 +1520,46 @@ function startAsyncIterable(response, id, iterator) {\n         nextWriteIndex++;\n       },\n       close: function (value) {\n-        closed = !0;\n-        nextWriteIndex === buffer.length\n-          ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-              response,\n-              value,\n-              !0\n-            ))\n-          : resolveIteratorResultChunk(\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length\n+                ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                    response,\n+                    value,\n+                    !0\n+                  ))\n+                : resolveIteratorResultChunk(\n+                    response,\n+                    buffer[nextWriteIndex],\n+                    value,\n+                    !0\n+                  ),\n+              nextWriteIndex++;\n+            nextWriteIndex < buffer.length;\n+\n+          )\n+            resolveIteratorResultChunk(\n               response,\n-              buffer[nextWriteIndex],\n-              value,\n+              buffer[nextWriteIndex++],\n+              '\"$undefined\"',\n               !0\n             );\n-        for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-          resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex++],\n-            '\"$undefined\"',\n-            !0\n-          );\n       },\n       error: function (error) {\n-        closed = !0;\n-        for (\n-          nextWriteIndex === buffer.length &&\n-          (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-          nextWriteIndex < buffer.length;\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length &&\n+                (buffer[nextWriteIndex] = new ReactPromise(\n+                  \"pending\",\n+                  null,\n+                  null\n+                ));\n+            nextWriteIndex < buffer.length;\n \n-        )\n-          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+          )\n+            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n       }\n     }\n   );"
        },
        {
            "sha": "5950f374b7ed849ad16835232792f2a14fa8230b",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-client.edge.development.js",
            "status": "modified",
            "additions": 180,
            "deletions": 146,
            "changes": 326,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -513,13 +513,23 @@\n                 pendingParts--;\n               }\n           }\n+          parentReference = writtenObjects.get(value);\n           if (\"function\" === typeof value.then) {\n+            if (void 0 !== parentReference)\n+              if (modelRoot === value) modelRoot = null;\n+              else return parentReference;\n             null === formData && (formData = new FormData());\n             pendingParts++;\n             var promiseId = nextPartId++;\n+            key = \"$@\" + promiseId.toString(16);\n+            writtenObjects.set(value, key);\n             value.then(function (partValue) {\n               try {\n-                var _partJSON3 = serializeModel(partValue, promiseId);\n+                var previousReference = writtenObjects.get(partValue);\n+                var _partJSON3 =\n+                  void 0 !== previousReference\n+                    ? JSON.stringify(previousReference)\n+                    : serializeModel(partValue, promiseId);\n                 partValue = formData;\n                 partValue.append(formFieldPrefix + promiseId, _partJSON3);\n                 pendingParts--;\n@@ -528,9 +538,8 @@\n                 reject(reason);\n               }\n             }, reject);\n-            return \"$@\" + promiseId.toString(16);\n+            return key;\n           }\n-          parentReference = writtenObjects.get(value);\n           if (void 0 !== parentReference)\n             if (modelRoot === value) modelRoot = null;\n             else return parentReference;\n@@ -688,7 +697,7 @@\n               null === formData && (formData = new FormData()),\n               (parentReference = nextPartId++),\n               formData.set(formFieldPrefix + parentReference, key),\n-              \"$F\" + parentReference.toString(16)\n+              \"$h\" + parentReference.toString(16)\n             );\n           if (\n             void 0 !== temporaryReferences &&\n@@ -1880,6 +1889,7 @@\n           rejectListeners = chunk.reason;\n         chunk.status = \"resolved_module\";\n         chunk.value = value;\n+        chunk.reason = null;\n         value = [];\n         null !== value && chunk._debugInfo.push.apply(chunk._debugInfo, value);\n         null !== resolveListeners &&\n@@ -2009,8 +2019,11 @@\n         response._closed = !0;\n         response._closedReason = error;\n         response._chunks.forEach(function (chunk) {\n-          \"pending\" === chunk.status &&\n-            triggerErrorOnChunk(response, chunk, error);\n+          \"pending\" === chunk.status\n+            ? triggerErrorOnChunk(response, chunk, error)\n+            : \"fulfilled\" === chunk.status &&\n+              null !== chunk.reason &&\n+              chunk.reason.error(error);\n         });\n         weakResponse = response._debugChannel;\n         void 0 !== weakResponse &&\n@@ -2115,125 +2128,136 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value, fulfilledChunk) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          for (\n+            ;\n+            \"object\" === typeof value &&\n+            null !== value &&\n+            value.$$typeof === REACT_LAZY_TYPE;\n+\n+          ) {\n+            var referencedChunk = value._payload;\n+            if (referencedChunk === handler.chunk) value = handler.value;\n+            else {\n+              switch (referencedChunk.status) {\n+                case \"resolved_model\":\n+                  initializeModelChunk(referencedChunk);\n+                  break;\n+                case \"resolved_module\":\n+                  initializeModuleChunk(referencedChunk);\n+              }\n+              switch (referencedChunk.status) {\n+                case \"fulfilled\":\n+                  value = referencedChunk.value;\n+                  continue;\n+                case \"blocked\":\n+                  var cyclicHandler = resolveBlockedCycle(\n+                    referencedChunk,\n+                    reference\n+                  );\n+                  if (null !== cyclicHandler) {\n+                    value = cyclicHandler.value;\n+                    continue;\n+                  }\n+                case \"pending\":\n+                  path.splice(0, i - 1);\n+                  null === referencedChunk.value\n+                    ? (referencedChunk.value = [reference])\n+                    : referencedChunk.value.push(reference);\n+                  null === referencedChunk.reason\n+                    ? (referencedChunk.reason = [reference])\n+                    : referencedChunk.reason.push(reference);\n+                  return;\n+                case \"halted\":\n+                  return;\n+                default:\n+                  rejectReference(\n+                    response,\n+                    reference.handler,\n+                    referencedChunk.reason\n+                  );\n+                  return;\n+              }\n+            }\n+          }\n+          value = value[path[i]];\n+        }\n         for (\n           ;\n           \"object\" === typeof value &&\n           null !== value &&\n           value.$$typeof === REACT_LAZY_TYPE;\n \n-        )\n-          if (((value = value._payload), value === handler.chunk))\n-            value = handler.value;\n+        ) {\n+          var _referencedChunk = value._payload;\n+          if (_referencedChunk === handler.chunk) value = handler.value;\n           else {\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"resolved_model\":\n-                initializeModelChunk(value);\n+                initializeModelChunk(_referencedChunk);\n                 break;\n               case \"resolved_module\":\n-                initializeModuleChunk(value);\n+                initializeModuleChunk(_referencedChunk);\n             }\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"fulfilled\":\n-                value = value.value;\n+                value = _referencedChunk.value;\n                 continue;\n-              case \"blocked\":\n-                var cyclicHandler = resolveBlockedCycle(value, reference);\n-                if (null !== cyclicHandler) {\n-                  value = cyclicHandler.value;\n-                  continue;\n-                }\n-              case \"pending\":\n-                path.splice(0, i - 1);\n-                null === value.value\n-                  ? (value.value = [reference])\n-                  : value.value.push(reference);\n-                null === value.reason\n-                  ? (value.reason = [reference])\n-                  : value.reason.push(reference);\n-                return;\n-              case \"halted\":\n-                return;\n-              default:\n-                rejectReference(response, reference.handler, value.reason);\n-                return;\n             }\n+            break;\n           }\n-        value = value[path[i]];\n-      }\n-      for (\n-        ;\n-        \"object\" === typeof value &&\n-        null !== value &&\n-        value.$$typeof === REACT_LAZY_TYPE;\n-\n-      )\n-        if (((path = value._payload), path === handler.chunk))\n-          value = handler.value;\n-        else {\n-          switch (path.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(path);\n+        }\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+        if (\n+          parentObject[0] === REACT_ELEMENT_TYPE &&\n+          \"object\" === typeof handler.value &&\n+          null !== handler.value &&\n+          handler.value.$$typeof === REACT_ELEMENT_TYPE\n+        ) {\n+          var element = handler.value;\n+          switch (key) {\n+            case \"3\":\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+              element.props = mappedValue;\n               break;\n-            case \"resolved_module\":\n-              initializeModuleChunk(path);\n-          }\n-          switch (path.status) {\n-            case \"fulfilled\":\n-              value = path.value;\n-              continue;\n+            case \"4\":\n+              element._owner = mappedValue;\n+              break;\n+            case \"5\":\n+              element._debugStack = mappedValue;\n+              break;\n+            default:\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n           }\n-          break;\n-        }\n-      map = map(response, value, parentObject, key);\n-      parentObject[key] = map;\n-      \"\" === key && null === handler.value && (handler.value = map);\n-      if (\n-        parentObject[0] === REACT_ELEMENT_TYPE &&\n-        \"object\" === typeof handler.value &&\n-        null !== handler.value &&\n-        handler.value.$$typeof === REACT_ELEMENT_TYPE\n-      )\n-        switch (((reference = handler.value), key)) {\n-          case \"3\":\n-            transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-            reference.props = map;\n-            break;\n-          case \"4\":\n-            reference._owner = map;\n-            break;\n-          case \"5\":\n-            reference._debugStack = map;\n-            break;\n-          default:\n+        } else\n+          reference.isDebug ||\n             transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-        }\n-      else\n-        reference.isDebug ||\n-          transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n+      }\n       handler.deps--;\n       0 === handler.deps &&\n-        ((fulfilledChunk = handler.chunk),\n-        null !== fulfilledChunk &&\n-          \"blocked\" === fulfilledChunk.status &&\n-          ((key = fulfilledChunk.value),\n-          (fulfilledChunk.status = \"fulfilled\"),\n-          (fulfilledChunk.value = handler.value),\n-          (fulfilledChunk.reason = handler.reason),\n-          null !== key\n-            ? wakeChunk(response, key, handler.value, fulfilledChunk)\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value\n+            ? wakeChunk(response, value, handler.value, reference)\n             : ((handler = handler.value),\n-              filterDebugInfo(response, fulfilledChunk),\n-              moveDebugInfoFromChunkToInnerValue(fulfilledChunk, handler))));\n+              filterDebugInfo(response, reference),\n+              moveDebugInfoFromChunkToInnerValue(reference, handler))));\n     }\n     function rejectReference(response, handler, error) {\n       if (!handler.errored) {\n@@ -2385,6 +2409,7 @@\n               ((boundArgs = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== boundArgs\n                 ? wakeChunk(response, boundArgs, handler.value, resolvedValue)\n                 : ((boundArgs = handler.value),\n@@ -2710,7 +2735,7 @@\n             );\n           case \"S\":\n             return Symbol.for(value.slice(2));\n-          case \"F\":\n+          case \"h\":\n             var ref = value.slice(2);\n             return getOutlinedModel(\n               response,\n@@ -3073,7 +3098,8 @@\n           chunks.set(id, stream);\n     }\n     function startReadableStream(response, id, type, streamState) {\n-      var controller = null;\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -3128,24 +3154,28 @@\n             }\n           },\n           close: function () {\n-            if (null === previousBlockedChunk) controller.close();\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.close();\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.close();\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.close();\n+                });\n+              }\n           },\n           error: function (error) {\n-            if (null === previousBlockedChunk) controller.error(error);\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.error(error);\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.error(error);\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.error(error);\n+                });\n+              }\n           }\n         },\n         streamState\n@@ -3201,6 +3231,7 @@\n                 rejectListeners = chunk.reason;\n               chunk.status = \"fulfilled\";\n               chunk.value = { done: !1, value: value };\n+              chunk.reason = null;\n               null !== resolveListeners &&\n                 wakeChunkIfInitialized(\n                   response,\n@@ -3227,36 +3258,39 @@\n             nextWriteIndex++;\n           },\n           close: function (value) {\n-            closed = !0;\n-            nextWriteIndex === buffer.length\n-              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                  response,\n-                  value,\n-                  !0\n-                ))\n-              : resolveIteratorResultChunk(\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length\n+                    ? (buffer[nextWriteIndex] =\n+                        createResolvedIteratorResultChunk(response, value, !0))\n+                    : resolveIteratorResultChunk(\n+                        response,\n+                        buffer[nextWriteIndex],\n+                        value,\n+                        !0\n+                      ),\n+                  nextWriteIndex++;\n+                nextWriteIndex < buffer.length;\n+\n+              )\n+                resolveIteratorResultChunk(\n                   response,\n-                  buffer[nextWriteIndex],\n-                  value,\n+                  buffer[nextWriteIndex++],\n+                  '\"$undefined\"',\n                   !0\n                 );\n-            for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-              resolveIteratorResultChunk(\n-                response,\n-                buffer[nextWriteIndex++],\n-                '\"$undefined\"',\n-                !0\n-              );\n           },\n           error: function (error) {\n-            closed = !0;\n-            for (\n-              nextWriteIndex === buffer.length &&\n-              (buffer[nextWriteIndex] = createPendingChunk(response));\n-              nextWriteIndex < buffer.length;\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length &&\n+                    (buffer[nextWriteIndex] = createPendingChunk(response));\n+                nextWriteIndex < buffer.length;\n \n-            )\n-              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+              )\n+                triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n           }\n         },\n         streamState"
        },
        {
            "sha": "58ab74ad57a20e03c7be8078e447897e6966c82f",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-client.edge.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -313,13 +313,23 @@ function processReply(\n             pendingParts--;\n           }\n       }\n+      parentReference = writtenObjects.get(value);\n       if (\"function\" === typeof value.then) {\n+        if (void 0 !== parentReference)\n+          if (modelRoot === value) modelRoot = null;\n+          else return parentReference;\n         null === formData && (formData = new FormData());\n         pendingParts++;\n         var promiseId = nextPartId++;\n+        key = \"$@\" + promiseId.toString(16);\n+        writtenObjects.set(value, key);\n         value.then(function (partValue) {\n           try {\n-            var partJSON$27 = serializeModel(partValue, promiseId);\n+            var previousReference = writtenObjects.get(partValue);\n+            var partJSON$27 =\n+              void 0 !== previousReference\n+                ? JSON.stringify(previousReference)\n+                : serializeModel(partValue, promiseId);\n             partValue = formData;\n             partValue.append(formFieldPrefix + promiseId, partJSON$27);\n             pendingParts--;\n@@ -328,9 +338,8 @@ function processReply(\n             reject(reason);\n           }\n         }, reject);\n-        return \"$@\" + promiseId.toString(16);\n+        return key;\n       }\n-      parentReference = writtenObjects.get(value);\n       if (void 0 !== parentReference)\n         if (modelRoot === value) modelRoot = null;\n         else return parentReference;\n@@ -454,7 +463,7 @@ function processReply(\n           null === formData && (formData = new FormData()),\n           (parentReference = nextPartId++),\n           formData.set(formFieldPrefix + parentReference, key),\n-          \"$F\" + parentReference.toString(16)\n+          \"$h\" + parentReference.toString(16)\n         );\n       if (\n         void 0 !== temporaryReferences &&\n@@ -738,12 +747,12 @@ function readChunk(chunk) {\n       throw chunk.reason;\n   }\n }\n-function wakeChunk(response, listeners, value) {\n+function wakeChunk(response, listeners, value, chunk) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n     \"function\" === typeof listener\n       ? listener(value)\n-      : fulfillReference(response, listener, value);\n+      : fulfillReference(response, listener, value, chunk);\n   }\n }\n function rejectChunk(response, listeners, error) {\n@@ -783,7 +792,7 @@ function wakeChunkIfInitialized(\n ) {\n   switch (chunk.status) {\n     case \"fulfilled\":\n-      wakeChunk(response, resolveListeners, chunk.value);\n+      wakeChunk(response, resolveListeners, chunk.value, chunk);\n       break;\n     case \"blocked\":\n       for (var i = 0; i < resolveListeners.length; i++) {\n@@ -792,7 +801,7 @@ function wakeChunkIfInitialized(\n           var cyclicHandler = resolveBlockedCycle(chunk, listener);\n           if (null !== cyclicHandler)\n             switch (\n-              (fulfillReference(response, listener, cyclicHandler.value),\n+              (fulfillReference(response, listener, cyclicHandler.value, chunk),\n               resolveListeners.splice(i, 1),\n               i--,\n               null !== rejectListeners &&\n@@ -801,7 +810,7 @@ function wakeChunkIfInitialized(\n               chunk.status)\n             ) {\n               case \"fulfilled\":\n-                wakeChunk(response, resolveListeners, chunk.value);\n+                wakeChunk(response, resolveListeners, chunk.value, chunk);\n                 return;\n               case \"rejected\":\n                 null !== rejectListeners &&\n@@ -877,6 +886,7 @@ function resolveModuleChunk(response, chunk, value) {\n       rejectListeners = chunk.reason;\n     chunk.status = \"resolved_module\";\n     chunk.value = value;\n+    chunk.reason = null;\n     null !== resolveListeners &&\n       (initializeModuleChunk(chunk),\n       wakeChunkIfInitialized(\n@@ -939,8 +949,11 @@ function reportGlobalError(weakResponse, error) {\n   weakResponse._closed = !0;\n   weakResponse._closedReason = error;\n   weakResponse._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status &&\n-      triggerErrorOnChunk(weakResponse, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(weakResponse, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function createLazyChunkWrapper(chunk) {\n@@ -957,109 +970,120 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      for (\n+        ;\n+        \"object\" === typeof value &&\n+        null !== value &&\n+        value.$$typeof === REACT_LAZY_TYPE;\n+\n+      ) {\n+        var referencedChunk = value._payload;\n+        if (referencedChunk === handler.chunk) value = handler.value;\n+        else {\n+          switch (referencedChunk.status) {\n+            case \"resolved_model\":\n+              initializeModelChunk(referencedChunk);\n+              break;\n+            case \"resolved_module\":\n+              initializeModuleChunk(referencedChunk);\n+          }\n+          switch (referencedChunk.status) {\n+            case \"fulfilled\":\n+              value = referencedChunk.value;\n+              continue;\n+            case \"blocked\":\n+              var cyclicHandler = resolveBlockedCycle(\n+                referencedChunk,\n+                reference\n+              );\n+              if (null !== cyclicHandler) {\n+                value = cyclicHandler.value;\n+                continue;\n+              }\n+            case \"pending\":\n+              path.splice(0, i - 1);\n+              null === referencedChunk.value\n+                ? (referencedChunk.value = [reference])\n+                : referencedChunk.value.push(reference);\n+              null === referencedChunk.reason\n+                ? (referencedChunk.reason = [reference])\n+                : referencedChunk.reason.push(reference);\n+              return;\n+            case \"halted\":\n+              return;\n+            default:\n+              rejectReference(\n+                response,\n+                reference.handler,\n+                referencedChunk.reason\n+              );\n+              return;\n+          }\n+        }\n+      }\n+      value = value[path[i]];\n+    }\n     for (\n       ;\n       \"object\" === typeof value &&\n       null !== value &&\n       value.$$typeof === REACT_LAZY_TYPE;\n \n-    )\n-      if (((value = value._payload), value === handler.chunk))\n-        value = handler.value;\n+    ) {\n+      var referencedChunk$43 = value._payload;\n+      if (referencedChunk$43 === handler.chunk) value = handler.value;\n       else {\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"resolved_model\":\n-            initializeModelChunk(value);\n+            initializeModelChunk(referencedChunk$43);\n             break;\n           case \"resolved_module\":\n-            initializeModuleChunk(value);\n+            initializeModuleChunk(referencedChunk$43);\n         }\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"fulfilled\":\n-            value = value.value;\n+            value = referencedChunk$43.value;\n             continue;\n-          case \"blocked\":\n-            var cyclicHandler = resolveBlockedCycle(value, reference);\n-            if (null !== cyclicHandler) {\n-              value = cyclicHandler.value;\n-              continue;\n-            }\n-          case \"pending\":\n-            path.splice(0, i - 1);\n-            null === value.value\n-              ? (value.value = [reference])\n-              : value.value.push(reference);\n-            null === value.reason\n-              ? (value.reason = [reference])\n-              : value.reason.push(reference);\n-            return;\n-          case \"halted\":\n-            return;\n-          default:\n-            rejectReference(response, reference.handler, value.reason);\n-            return;\n         }\n+        break;\n       }\n-    value = value[path[i]];\n-  }\n-  for (\n-    ;\n-    \"object\" === typeof value &&\n-    null !== value &&\n-    value.$$typeof === REACT_LAZY_TYPE;\n-\n-  )\n-    if (((reference = value._payload), reference === handler.chunk))\n-      value = handler.value;\n-    else {\n-      switch (reference.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(reference);\n-          break;\n-        case \"resolved_module\":\n-          initializeModuleChunk(reference);\n-      }\n-      switch (reference.status) {\n-        case \"fulfilled\":\n-          value = reference.value;\n-          continue;\n-      }\n-      break;\n     }\n-  map = map(response, value, parentObject, key);\n-  parentObject[key] = map;\n-  \"\" === key && null === handler.value && (handler.value = map);\n-  if (\n-    parentObject[0] === REACT_ELEMENT_TYPE &&\n-    \"object\" === typeof handler.value &&\n-    null !== handler.value &&\n-    handler.value.$$typeof === REACT_ELEMENT_TYPE\n-  )\n-    switch (((parentObject = handler.value), key)) {\n-      case \"3\":\n-        parentObject.props = map;\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+    if (\n+      parentObject[0] === REACT_ELEMENT_TYPE &&\n+      \"object\" === typeof handler.value &&\n+      null !== handler.value &&\n+      handler.value.$$typeof === REACT_ELEMENT_TYPE\n+    ) {\n+      var element = handler.value;\n+      switch (key) {\n+        case \"3\":\n+          element.props = mappedValue;\n+      }\n     }\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n+  }\n   handler.deps--;\n   0 === handler.deps &&\n-    ((key = handler.chunk),\n-    null !== key &&\n-      \"blocked\" === key.status &&\n-      ((parentObject = key.value),\n-      (key.status = \"fulfilled\"),\n-      (key.value = handler.value),\n-      (key.reason = handler.reason),\n-      null !== parentObject &&\n-        wakeChunk(response, parentObject, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value, reference)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -1177,7 +1201,9 @@ function loadServerReference(response, metaData, parentObject, key) {\n           ((boundArgs = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n-          null !== boundArgs && wakeChunk(response, boundArgs, handler.value)));\n+          (resolvedValue.reason = null),\n+          null !== boundArgs &&\n+            wakeChunk(response, boundArgs, handler.value, resolvedValue)));\n     },\n     function (error) {\n       if (!handler.errored) {\n@@ -1382,7 +1408,7 @@ function parseModelString(response, parentObject, key, value) {\n         );\n       case \"S\":\n         return Symbol.for(value.slice(2));\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(\n@@ -1526,12 +1552,13 @@ function resolveStream(response, id, stream, controller) {\n       (chunk.status = \"fulfilled\"),\n       (chunk.value = stream),\n       (chunk.reason = controller),\n-      null !== id && wakeChunk(response, id, chunk.value))\n+      null !== id && wakeChunk(response, id, chunk.value, chunk))\n     : ((response = new ReactPromise(\"fulfilled\", stream, controller)),\n       chunks.set(id, response));\n }\n function startReadableStream(response, id, type) {\n-  var controller = null;\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -1581,24 +1608,27 @@ function startReadableStream(response, id, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n }\n@@ -1652,6 +1682,7 @@ function startAsyncIterable(response, id, iterator) {\n             rejectListeners = chunk.reason;\n           chunk.status = \"fulfilled\";\n           chunk.value = { done: !1, value: value };\n+          chunk.reason = null;\n           null !== resolveListeners &&\n             wakeChunkIfInitialized(\n               response,\n@@ -1678,36 +1709,46 @@ function startAsyncIterable(response, id, iterator) {\n         nextWriteIndex++;\n       },\n       close: function (value) {\n-        closed = !0;\n-        nextWriteIndex === buffer.length\n-          ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-              response,\n-              value,\n-              !0\n-            ))\n-          : resolveIteratorResultChunk(\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length\n+                ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                    response,\n+                    value,\n+                    !0\n+                  ))\n+                : resolveIteratorResultChunk(\n+                    response,\n+                    buffer[nextWriteIndex],\n+                    value,\n+                    !0\n+                  ),\n+              nextWriteIndex++;\n+            nextWriteIndex < buffer.length;\n+\n+          )\n+            resolveIteratorResultChunk(\n               response,\n-              buffer[nextWriteIndex],\n-              value,\n+              buffer[nextWriteIndex++],\n+              '\"$undefined\"',\n               !0\n             );\n-        for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-          resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex++],\n-            '\"$undefined\"',\n-            !0\n-          );\n       },\n       error: function (error) {\n-        closed = !0;\n-        for (\n-          nextWriteIndex === buffer.length &&\n-          (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-          nextWriteIndex < buffer.length;\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length &&\n+                (buffer[nextWriteIndex] = new ReactPromise(\n+                  \"pending\",\n+                  null,\n+                  null\n+                ));\n+            nextWriteIndex < buffer.length;\n \n-        )\n-          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+          )\n+            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n       }\n     }\n   );"
        },
        {
            "sha": "0b20360fd07654d4d6c2ff32836edc8f5003d34d",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-client.node.development.js",
            "status": "modified",
            "additions": 180,
            "deletions": 146,
            "changes": 326,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -513,13 +513,23 @@\n                 pendingParts--;\n               }\n           }\n+          parentReference = writtenObjects.get(value);\n           if (\"function\" === typeof value.then) {\n+            if (void 0 !== parentReference)\n+              if (modelRoot === value) modelRoot = null;\n+              else return parentReference;\n             null === formData && (formData = new FormData());\n             pendingParts++;\n             var promiseId = nextPartId++;\n+            key = \"$@\" + promiseId.toString(16);\n+            writtenObjects.set(value, key);\n             value.then(function (partValue) {\n               try {\n-                var _partJSON3 = serializeModel(partValue, promiseId);\n+                var previousReference = writtenObjects.get(partValue);\n+                var _partJSON3 =\n+                  void 0 !== previousReference\n+                    ? JSON.stringify(previousReference)\n+                    : serializeModel(partValue, promiseId);\n                 partValue = formData;\n                 partValue.append(formFieldPrefix + promiseId, _partJSON3);\n                 pendingParts--;\n@@ -528,9 +538,8 @@\n                 reject(reason);\n               }\n             }, reject);\n-            return \"$@\" + promiseId.toString(16);\n+            return key;\n           }\n-          parentReference = writtenObjects.get(value);\n           if (void 0 !== parentReference)\n             if (modelRoot === value) modelRoot = null;\n             else return parentReference;\n@@ -688,7 +697,7 @@\n               null === formData && (formData = new FormData()),\n               (parentReference = nextPartId++),\n               formData.set(formFieldPrefix + parentReference, key),\n-              \"$F\" + parentReference.toString(16)\n+              \"$h\" + parentReference.toString(16)\n             );\n           if (\n             void 0 !== temporaryReferences &&\n@@ -1880,6 +1889,7 @@\n           rejectListeners = chunk.reason;\n         chunk.status = \"resolved_module\";\n         chunk.value = value;\n+        chunk.reason = null;\n         value = [];\n         null !== value && chunk._debugInfo.push.apply(chunk._debugInfo, value);\n         null !== resolveListeners &&\n@@ -2009,8 +2019,11 @@\n         response._closed = !0;\n         response._closedReason = error;\n         response._chunks.forEach(function (chunk) {\n-          \"pending\" === chunk.status &&\n-            triggerErrorOnChunk(response, chunk, error);\n+          \"pending\" === chunk.status\n+            ? triggerErrorOnChunk(response, chunk, error)\n+            : \"fulfilled\" === chunk.status &&\n+              null !== chunk.reason &&\n+              chunk.reason.error(error);\n         });\n         weakResponse = response._debugChannel;\n         void 0 !== weakResponse &&\n@@ -2115,125 +2128,136 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value, fulfilledChunk) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          for (\n+            ;\n+            \"object\" === typeof value &&\n+            null !== value &&\n+            value.$$typeof === REACT_LAZY_TYPE;\n+\n+          ) {\n+            var referencedChunk = value._payload;\n+            if (referencedChunk === handler.chunk) value = handler.value;\n+            else {\n+              switch (referencedChunk.status) {\n+                case \"resolved_model\":\n+                  initializeModelChunk(referencedChunk);\n+                  break;\n+                case \"resolved_module\":\n+                  initializeModuleChunk(referencedChunk);\n+              }\n+              switch (referencedChunk.status) {\n+                case \"fulfilled\":\n+                  value = referencedChunk.value;\n+                  continue;\n+                case \"blocked\":\n+                  var cyclicHandler = resolveBlockedCycle(\n+                    referencedChunk,\n+                    reference\n+                  );\n+                  if (null !== cyclicHandler) {\n+                    value = cyclicHandler.value;\n+                    continue;\n+                  }\n+                case \"pending\":\n+                  path.splice(0, i - 1);\n+                  null === referencedChunk.value\n+                    ? (referencedChunk.value = [reference])\n+                    : referencedChunk.value.push(reference);\n+                  null === referencedChunk.reason\n+                    ? (referencedChunk.reason = [reference])\n+                    : referencedChunk.reason.push(reference);\n+                  return;\n+                case \"halted\":\n+                  return;\n+                default:\n+                  rejectReference(\n+                    response,\n+                    reference.handler,\n+                    referencedChunk.reason\n+                  );\n+                  return;\n+              }\n+            }\n+          }\n+          value = value[path[i]];\n+        }\n         for (\n           ;\n           \"object\" === typeof value &&\n           null !== value &&\n           value.$$typeof === REACT_LAZY_TYPE;\n \n-        )\n-          if (((value = value._payload), value === handler.chunk))\n-            value = handler.value;\n+        ) {\n+          var _referencedChunk = value._payload;\n+          if (_referencedChunk === handler.chunk) value = handler.value;\n           else {\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"resolved_model\":\n-                initializeModelChunk(value);\n+                initializeModelChunk(_referencedChunk);\n                 break;\n               case \"resolved_module\":\n-                initializeModuleChunk(value);\n+                initializeModuleChunk(_referencedChunk);\n             }\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"fulfilled\":\n-                value = value.value;\n+                value = _referencedChunk.value;\n                 continue;\n-              case \"blocked\":\n-                var cyclicHandler = resolveBlockedCycle(value, reference);\n-                if (null !== cyclicHandler) {\n-                  value = cyclicHandler.value;\n-                  continue;\n-                }\n-              case \"pending\":\n-                path.splice(0, i - 1);\n-                null === value.value\n-                  ? (value.value = [reference])\n-                  : value.value.push(reference);\n-                null === value.reason\n-                  ? (value.reason = [reference])\n-                  : value.reason.push(reference);\n-                return;\n-              case \"halted\":\n-                return;\n-              default:\n-                rejectReference(response, reference.handler, value.reason);\n-                return;\n             }\n+            break;\n           }\n-        value = value[path[i]];\n-      }\n-      for (\n-        ;\n-        \"object\" === typeof value &&\n-        null !== value &&\n-        value.$$typeof === REACT_LAZY_TYPE;\n-\n-      )\n-        if (((path = value._payload), path === handler.chunk))\n-          value = handler.value;\n-        else {\n-          switch (path.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(path);\n+        }\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+        if (\n+          parentObject[0] === REACT_ELEMENT_TYPE &&\n+          \"object\" === typeof handler.value &&\n+          null !== handler.value &&\n+          handler.value.$$typeof === REACT_ELEMENT_TYPE\n+        ) {\n+          var element = handler.value;\n+          switch (key) {\n+            case \"3\":\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+              element.props = mappedValue;\n               break;\n-            case \"resolved_module\":\n-              initializeModuleChunk(path);\n-          }\n-          switch (path.status) {\n-            case \"fulfilled\":\n-              value = path.value;\n-              continue;\n+            case \"4\":\n+              element._owner = mappedValue;\n+              break;\n+            case \"5\":\n+              element._debugStack = mappedValue;\n+              break;\n+            default:\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n           }\n-          break;\n-        }\n-      map = map(response, value, parentObject, key);\n-      parentObject[key] = map;\n-      \"\" === key && null === handler.value && (handler.value = map);\n-      if (\n-        parentObject[0] === REACT_ELEMENT_TYPE &&\n-        \"object\" === typeof handler.value &&\n-        null !== handler.value &&\n-        handler.value.$$typeof === REACT_ELEMENT_TYPE\n-      )\n-        switch (((reference = handler.value), key)) {\n-          case \"3\":\n-            transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-            reference.props = map;\n-            break;\n-          case \"4\":\n-            reference._owner = map;\n-            break;\n-          case \"5\":\n-            reference._debugStack = map;\n-            break;\n-          default:\n+        } else\n+          reference.isDebug ||\n             transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-        }\n-      else\n-        reference.isDebug ||\n-          transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n+      }\n       handler.deps--;\n       0 === handler.deps &&\n-        ((fulfilledChunk = handler.chunk),\n-        null !== fulfilledChunk &&\n-          \"blocked\" === fulfilledChunk.status &&\n-          ((key = fulfilledChunk.value),\n-          (fulfilledChunk.status = \"fulfilled\"),\n-          (fulfilledChunk.value = handler.value),\n-          (fulfilledChunk.reason = handler.reason),\n-          null !== key\n-            ? wakeChunk(response, key, handler.value, fulfilledChunk)\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value\n+            ? wakeChunk(response, value, handler.value, reference)\n             : ((handler = handler.value),\n-              filterDebugInfo(response, fulfilledChunk),\n-              moveDebugInfoFromChunkToInnerValue(fulfilledChunk, handler))));\n+              filterDebugInfo(response, reference),\n+              moveDebugInfoFromChunkToInnerValue(reference, handler))));\n     }\n     function rejectReference(response, handler, error) {\n       if (!handler.errored) {\n@@ -2385,6 +2409,7 @@\n               ((boundArgs = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== boundArgs\n                 ? wakeChunk(response, boundArgs, handler.value, resolvedValue)\n                 : ((boundArgs = handler.value),\n@@ -2710,7 +2735,7 @@\n             );\n           case \"S\":\n             return Symbol.for(value.slice(2));\n-          case \"F\":\n+          case \"h\":\n             var ref = value.slice(2);\n             return getOutlinedModel(\n               response,\n@@ -3093,7 +3118,8 @@\n           chunks.set(id, stream);\n     }\n     function startReadableStream(response, id, type, streamState) {\n-      var controller = null;\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -3148,24 +3174,28 @@\n             }\n           },\n           close: function () {\n-            if (null === previousBlockedChunk) controller.close();\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.close();\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.close();\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.close();\n+                });\n+              }\n           },\n           error: function (error) {\n-            if (null === previousBlockedChunk) controller.error(error);\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.error(error);\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.error(error);\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.error(error);\n+                });\n+              }\n           }\n         },\n         streamState\n@@ -3221,6 +3251,7 @@\n                 rejectListeners = chunk.reason;\n               chunk.status = \"fulfilled\";\n               chunk.value = { done: !1, value: value };\n+              chunk.reason = null;\n               null !== resolveListeners &&\n                 wakeChunkIfInitialized(\n                   response,\n@@ -3247,36 +3278,39 @@\n             nextWriteIndex++;\n           },\n           close: function (value) {\n-            closed = !0;\n-            nextWriteIndex === buffer.length\n-              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                  response,\n-                  value,\n-                  !0\n-                ))\n-              : resolveIteratorResultChunk(\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length\n+                    ? (buffer[nextWriteIndex] =\n+                        createResolvedIteratorResultChunk(response, value, !0))\n+                    : resolveIteratorResultChunk(\n+                        response,\n+                        buffer[nextWriteIndex],\n+                        value,\n+                        !0\n+                      ),\n+                  nextWriteIndex++;\n+                nextWriteIndex < buffer.length;\n+\n+              )\n+                resolveIteratorResultChunk(\n                   response,\n-                  buffer[nextWriteIndex],\n-                  value,\n+                  buffer[nextWriteIndex++],\n+                  '\"$undefined\"',\n                   !0\n                 );\n-            for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-              resolveIteratorResultChunk(\n-                response,\n-                buffer[nextWriteIndex++],\n-                '\"$undefined\"',\n-                !0\n-              );\n           },\n           error: function (error) {\n-            closed = !0;\n-            for (\n-              nextWriteIndex === buffer.length &&\n-              (buffer[nextWriteIndex] = createPendingChunk(response));\n-              nextWriteIndex < buffer.length;\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length &&\n+                    (buffer[nextWriteIndex] = createPendingChunk(response));\n+                nextWriteIndex < buffer.length;\n \n-            )\n-              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+              )\n+                triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n           }\n         },\n         streamState"
        },
        {
            "sha": "c81ea6caa5a1f7eb014e232cc50efb2e7ba98852",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-client.node.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-client.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -314,13 +314,23 @@ function processReply(\n             pendingParts--;\n           }\n       }\n+      parentReference = writtenObjects.get(value);\n       if (\"function\" === typeof value.then) {\n+        if (void 0 !== parentReference)\n+          if (modelRoot === value) modelRoot = null;\n+          else return parentReference;\n         null === formData && (formData = new FormData());\n         pendingParts++;\n         var promiseId = nextPartId++;\n+        key = \"$@\" + promiseId.toString(16);\n+        writtenObjects.set(value, key);\n         value.then(function (partValue) {\n           try {\n-            var partJSON$27 = serializeModel(partValue, promiseId);\n+            var previousReference = writtenObjects.get(partValue);\n+            var partJSON$27 =\n+              void 0 !== previousReference\n+                ? JSON.stringify(previousReference)\n+                : serializeModel(partValue, promiseId);\n             partValue = formData;\n             partValue.append(formFieldPrefix + promiseId, partJSON$27);\n             pendingParts--;\n@@ -329,9 +339,8 @@ function processReply(\n             reject(reason);\n           }\n         }, reject);\n-        return \"$@\" + promiseId.toString(16);\n+        return key;\n       }\n-      parentReference = writtenObjects.get(value);\n       if (void 0 !== parentReference)\n         if (modelRoot === value) modelRoot = null;\n         else return parentReference;\n@@ -455,7 +464,7 @@ function processReply(\n           null === formData && (formData = new FormData()),\n           (parentReference = nextPartId++),\n           formData.set(formFieldPrefix + parentReference, key),\n-          \"$F\" + parentReference.toString(16)\n+          \"$h\" + parentReference.toString(16)\n         );\n       if (\n         void 0 !== temporaryReferences &&\n@@ -739,12 +748,12 @@ function readChunk(chunk) {\n       throw chunk.reason;\n   }\n }\n-function wakeChunk(response, listeners, value) {\n+function wakeChunk(response, listeners, value, chunk) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n     \"function\" === typeof listener\n       ? listener(value)\n-      : fulfillReference(response, listener, value);\n+      : fulfillReference(response, listener, value, chunk);\n   }\n }\n function rejectChunk(response, listeners, error) {\n@@ -784,7 +793,7 @@ function wakeChunkIfInitialized(\n ) {\n   switch (chunk.status) {\n     case \"fulfilled\":\n-      wakeChunk(response, resolveListeners, chunk.value);\n+      wakeChunk(response, resolveListeners, chunk.value, chunk);\n       break;\n     case \"blocked\":\n       for (var i = 0; i < resolveListeners.length; i++) {\n@@ -793,7 +802,7 @@ function wakeChunkIfInitialized(\n           var cyclicHandler = resolveBlockedCycle(chunk, listener);\n           if (null !== cyclicHandler)\n             switch (\n-              (fulfillReference(response, listener, cyclicHandler.value),\n+              (fulfillReference(response, listener, cyclicHandler.value, chunk),\n               resolveListeners.splice(i, 1),\n               i--,\n               null !== rejectListeners &&\n@@ -802,7 +811,7 @@ function wakeChunkIfInitialized(\n               chunk.status)\n             ) {\n               case \"fulfilled\":\n-                wakeChunk(response, resolveListeners, chunk.value);\n+                wakeChunk(response, resolveListeners, chunk.value, chunk);\n                 return;\n               case \"rejected\":\n                 null !== rejectListeners &&\n@@ -878,6 +887,7 @@ function resolveModuleChunk(response, chunk, value) {\n       rejectListeners = chunk.reason;\n     chunk.status = \"resolved_module\";\n     chunk.value = value;\n+    chunk.reason = null;\n     null !== resolveListeners &&\n       (initializeModuleChunk(chunk),\n       wakeChunkIfInitialized(\n@@ -940,8 +950,11 @@ function reportGlobalError(weakResponse, error) {\n   weakResponse._closed = !0;\n   weakResponse._closedReason = error;\n   weakResponse._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status &&\n-      triggerErrorOnChunk(weakResponse, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(weakResponse, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function createLazyChunkWrapper(chunk) {\n@@ -958,109 +971,120 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      for (\n+        ;\n+        \"object\" === typeof value &&\n+        null !== value &&\n+        value.$$typeof === REACT_LAZY_TYPE;\n+\n+      ) {\n+        var referencedChunk = value._payload;\n+        if (referencedChunk === handler.chunk) value = handler.value;\n+        else {\n+          switch (referencedChunk.status) {\n+            case \"resolved_model\":\n+              initializeModelChunk(referencedChunk);\n+              break;\n+            case \"resolved_module\":\n+              initializeModuleChunk(referencedChunk);\n+          }\n+          switch (referencedChunk.status) {\n+            case \"fulfilled\":\n+              value = referencedChunk.value;\n+              continue;\n+            case \"blocked\":\n+              var cyclicHandler = resolveBlockedCycle(\n+                referencedChunk,\n+                reference\n+              );\n+              if (null !== cyclicHandler) {\n+                value = cyclicHandler.value;\n+                continue;\n+              }\n+            case \"pending\":\n+              path.splice(0, i - 1);\n+              null === referencedChunk.value\n+                ? (referencedChunk.value = [reference])\n+                : referencedChunk.value.push(reference);\n+              null === referencedChunk.reason\n+                ? (referencedChunk.reason = [reference])\n+                : referencedChunk.reason.push(reference);\n+              return;\n+            case \"halted\":\n+              return;\n+            default:\n+              rejectReference(\n+                response,\n+                reference.handler,\n+                referencedChunk.reason\n+              );\n+              return;\n+          }\n+        }\n+      }\n+      value = value[path[i]];\n+    }\n     for (\n       ;\n       \"object\" === typeof value &&\n       null !== value &&\n       value.$$typeof === REACT_LAZY_TYPE;\n \n-    )\n-      if (((value = value._payload), value === handler.chunk))\n-        value = handler.value;\n+    ) {\n+      var referencedChunk$43 = value._payload;\n+      if (referencedChunk$43 === handler.chunk) value = handler.value;\n       else {\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"resolved_model\":\n-            initializeModelChunk(value);\n+            initializeModelChunk(referencedChunk$43);\n             break;\n           case \"resolved_module\":\n-            initializeModuleChunk(value);\n+            initializeModuleChunk(referencedChunk$43);\n         }\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"fulfilled\":\n-            value = value.value;\n+            value = referencedChunk$43.value;\n             continue;\n-          case \"blocked\":\n-            var cyclicHandler = resolveBlockedCycle(value, reference);\n-            if (null !== cyclicHandler) {\n-              value = cyclicHandler.value;\n-              continue;\n-            }\n-          case \"pending\":\n-            path.splice(0, i - 1);\n-            null === value.value\n-              ? (value.value = [reference])\n-              : value.value.push(reference);\n-            null === value.reason\n-              ? (value.reason = [reference])\n-              : value.reason.push(reference);\n-            return;\n-          case \"halted\":\n-            return;\n-          default:\n-            rejectReference(response, reference.handler, value.reason);\n-            return;\n         }\n+        break;\n       }\n-    value = value[path[i]];\n-  }\n-  for (\n-    ;\n-    \"object\" === typeof value &&\n-    null !== value &&\n-    value.$$typeof === REACT_LAZY_TYPE;\n-\n-  )\n-    if (((reference = value._payload), reference === handler.chunk))\n-      value = handler.value;\n-    else {\n-      switch (reference.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(reference);\n-          break;\n-        case \"resolved_module\":\n-          initializeModuleChunk(reference);\n-      }\n-      switch (reference.status) {\n-        case \"fulfilled\":\n-          value = reference.value;\n-          continue;\n-      }\n-      break;\n     }\n-  map = map(response, value, parentObject, key);\n-  parentObject[key] = map;\n-  \"\" === key && null === handler.value && (handler.value = map);\n-  if (\n-    parentObject[0] === REACT_ELEMENT_TYPE &&\n-    \"object\" === typeof handler.value &&\n-    null !== handler.value &&\n-    handler.value.$$typeof === REACT_ELEMENT_TYPE\n-  )\n-    switch (((parentObject = handler.value), key)) {\n-      case \"3\":\n-        parentObject.props = map;\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+    if (\n+      parentObject[0] === REACT_ELEMENT_TYPE &&\n+      \"object\" === typeof handler.value &&\n+      null !== handler.value &&\n+      handler.value.$$typeof === REACT_ELEMENT_TYPE\n+    ) {\n+      var element = handler.value;\n+      switch (key) {\n+        case \"3\":\n+          element.props = mappedValue;\n+      }\n     }\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n+  }\n   handler.deps--;\n   0 === handler.deps &&\n-    ((key = handler.chunk),\n-    null !== key &&\n-      \"blocked\" === key.status &&\n-      ((parentObject = key.value),\n-      (key.status = \"fulfilled\"),\n-      (key.value = handler.value),\n-      (key.reason = handler.reason),\n-      null !== parentObject &&\n-        wakeChunk(response, parentObject, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value, reference)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -1178,7 +1202,9 @@ function loadServerReference(response, metaData, parentObject, key) {\n           ((boundArgs = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n-          null !== boundArgs && wakeChunk(response, boundArgs, handler.value)));\n+          (resolvedValue.reason = null),\n+          null !== boundArgs &&\n+            wakeChunk(response, boundArgs, handler.value, resolvedValue)));\n     },\n     function (error) {\n       if (!handler.errored) {\n@@ -1383,7 +1409,7 @@ function parseModelString(response, parentObject, key, value) {\n         );\n       case \"S\":\n         return Symbol.for(value.slice(2));\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(\n@@ -1530,12 +1556,13 @@ function resolveStream(response, id, stream, controller) {\n       (chunk.status = \"fulfilled\"),\n       (chunk.value = stream),\n       (chunk.reason = controller),\n-      null !== id && wakeChunk(response, id, chunk.value))\n+      null !== id && wakeChunk(response, id, chunk.value, chunk))\n     : ((response = new ReactPromise(\"fulfilled\", stream, controller)),\n       chunks.set(id, response));\n }\n function startReadableStream(response, id, type) {\n-  var controller = null;\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -1585,24 +1612,27 @@ function startReadableStream(response, id, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n }\n@@ -1656,6 +1686,7 @@ function startAsyncIterable(response, id, iterator) {\n             rejectListeners = chunk.reason;\n           chunk.status = \"fulfilled\";\n           chunk.value = { done: !1, value: value };\n+          chunk.reason = null;\n           null !== resolveListeners &&\n             wakeChunkIfInitialized(\n               response,\n@@ -1682,36 +1713,46 @@ function startAsyncIterable(response, id, iterator) {\n         nextWriteIndex++;\n       },\n       close: function (value) {\n-        closed = !0;\n-        nextWriteIndex === buffer.length\n-          ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-              response,\n-              value,\n-              !0\n-            ))\n-          : resolveIteratorResultChunk(\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length\n+                ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                    response,\n+                    value,\n+                    !0\n+                  ))\n+                : resolveIteratorResultChunk(\n+                    response,\n+                    buffer[nextWriteIndex],\n+                    value,\n+                    !0\n+                  ),\n+              nextWriteIndex++;\n+            nextWriteIndex < buffer.length;\n+\n+          )\n+            resolveIteratorResultChunk(\n               response,\n-              buffer[nextWriteIndex],\n-              value,\n+              buffer[nextWriteIndex++],\n+              '\"$undefined\"',\n               !0\n             );\n-        for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-          resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex++],\n-            '\"$undefined\"',\n-            !0\n-          );\n       },\n       error: function (error) {\n-        closed = !0;\n-        for (\n-          nextWriteIndex === buffer.length &&\n-          (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-          nextWriteIndex < buffer.length;\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length &&\n+                (buffer[nextWriteIndex] = new ReactPromise(\n+                  \"pending\",\n+                  null,\n+                  null\n+                ));\n+            nextWriteIndex < buffer.length;\n \n-        )\n-          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+          )\n+            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n       }\n     }\n   );"
        },
        {
            "sha": "4194e2df3cef300932f23f27a02fa77cd1ef77ca",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-server.browser.development.js",
            "status": "modified",
            "additions": 176,
            "deletions": 180,
            "changes": 356,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -2132,7 +2132,7 @@\n     function serializeServerReference(request, serverReference) {\n       var writtenServerReferences = request.writtenServerReferences,\n         existingId = writtenServerReferences.get(serverReference);\n-      if (void 0 !== existingId) return \"$F\" + existingId.toString(16);\n+      if (void 0 !== existingId) return \"$h\" + existingId.toString(16);\n       existingId = serverReference.$$bound;\n       existingId = null === existingId ? null : Promise.resolve(existingId);\n       var id = serverReference.$$id,\n@@ -2158,7 +2158,7 @@\n           : { id: id, bound: existingId };\n       request = outlineModel(request, existingId);\n       writtenServerReferences.set(serverReference, request);\n-      return \"$F\" + request.toString(16);\n+      return \"$h\" + request.toString(16);\n     }\n     function serializeLargeTextString(request, text) {\n       request.pendingChunks++;\n@@ -2552,7 +2552,7 @@\n         if (value instanceof Date) return \"$D\" + value.toJSON();\n         elementReference = getPrototypeOf(value);\n         if (\n-          elementReference !== ObjectPrototype &&\n+          elementReference !== ObjectPrototype$1 &&\n           (null === elementReference ||\n             null !== getPrototypeOf(elementReference))\n         )\n@@ -3130,7 +3130,7 @@\n           return serializeDebugBlob(request, value);\n         if (getIteratorFn(value)) return Array.from(value);\n         request = getPrototypeOf(value);\n-        if (request !== ObjectPrototype && null !== request) {\n+        if (request !== ObjectPrototype$1 && null !== request) {\n           counter = Object.create(null);\n           for (env in value)\n             if (hasOwnProperty.call(value, env) || isGetter(request, env))\n@@ -4089,6 +4089,7 @@\n               ((promiseValue = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== promiseValue &&\n                 wakeChunk(response, promiseValue, handler.value)));\n         },\n@@ -4192,6 +4193,7 @@\n         }\n         chunk.status = \"fulfilled\";\n         chunk.value = value;\n+        chunk.reason = null;\n       } catch (error) {\n         (chunk.status = \"rejected\"), (chunk.reason = error);\n       } finally {\n@@ -4202,8 +4204,11 @@\n       response._closed = !0;\n       response._closedReason = error;\n       response._chunks.forEach(function (chunk) {\n-        \"pending\" === chunk.status &&\n-          triggerErrorOnChunk(response, chunk, error);\n+        \"pending\" === chunk.status\n+          ? triggerErrorOnChunk(response, chunk, error)\n+          : \"fulfilled\" === chunk.status &&\n+            null !== chunk.reason &&\n+            chunk.reason.error(error);\n       });\n     }\n     function getChunk(response, id) {\n@@ -4225,58 +4230,41 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              continue;\n-            case \"blocked\":\n-            case \"pending\":\n-              path.splice(0, i - 1);\n-              null === value.value\n-                ? (value.value = [reference])\n-                : value.value.push(reference);\n-              null === value.reason\n-                ? (value.reason = [reference])\n-                : value.reason.push(reference);\n-              return;\n-            default:\n-              rejectReference(response, reference.handler, value.reason);\n-              return;\n-          }\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          var name = path[i];\n+          if (\n+            \"object\" !== typeof value ||\n+            null === value ||\n+            (getPrototypeOf(value) !== ObjectPrototype &&\n+              getPrototypeOf(value) !== ArrayPrototype) ||\n+            !hasOwnProperty.call(value, name)\n+          )\n+            throw Error(\"Invalid reference.\");\n+          value = value[name];\n         }\n-        var name = path[i];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n       }\n-      reference = map(response, value, parentObject, key);\n-      parentObject[key] = reference;\n-      \"\" === key && null === handler.value && (handler.value = reference);\n       handler.deps--;\n       0 === handler.deps &&\n-        ((parentObject = handler.chunk),\n-        null !== parentObject &&\n-          \"blocked\" === parentObject.status &&\n-          ((key = parentObject.value),\n-          (parentObject.status = \"fulfilled\"),\n-          (parentObject.value = handler.value),\n-          (parentObject.reason = handler.reason),\n-          null !== key && wakeChunk(response, key, handler.value)));\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value && wakeChunk(response, value, handler.value)));\n     }\n     function rejectReference(response, handler, error) {\n       handler.errored ||\n@@ -4288,33 +4276,6 @@\n           \"blocked\" === handler.status &&\n           triggerErrorOnChunk(response, handler, error));\n     }\n-    function waitForReference(\n-      referencedChunk,\n-      parentObject,\n-      key,\n-      response,\n-      map,\n-      path\n-    ) {\n-      initializingHandler\n-        ? ((response = initializingHandler), response.deps++)\n-        : (response = initializingHandler =\n-            { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-      parentObject = {\n-        handler: response,\n-        parentObject: parentObject,\n-        key: key,\n-        map: map,\n-        path: path\n-      };\n-      null === referencedChunk.value\n-        ? (referencedChunk.value = [parentObject])\n-        : referencedChunk.value.push(parentObject);\n-      null === referencedChunk.reason\n-        ? (referencedChunk.reason = [parentObject])\n-        : referencedChunk.reason.push(parentObject);\n-      return null;\n-    }\n     function getOutlinedModel(response, reference, parentObject, key, map) {\n       reference = reference.split(\":\");\n       var id = parseInt(reference[0], 16);\n@@ -4325,59 +4286,47 @@\n       }\n       switch (id.status) {\n         case \"fulfilled\":\n-          var value = id.value;\n-          for (id = 1; id < reference.length; id++) {\n-            for (; value instanceof ReactPromise; ) {\n-              switch (value.status) {\n-                case \"resolved_model\":\n-                  initializeModelChunk(value);\n-              }\n-              switch (value.status) {\n-                case \"fulfilled\":\n-                  value = value.value;\n-                  break;\n-                case \"blocked\":\n-                case \"pending\":\n-                  return waitForReference(\n-                    value,\n-                    parentObject,\n-                    key,\n-                    response,\n-                    map,\n-                    reference.slice(id - 1)\n-                  );\n-                default:\n-                  return (\n-                    initializingHandler\n-                      ? ((initializingHandler.errored = !0),\n-                        (initializingHandler.value = null),\n-                        (initializingHandler.reason = value.reason))\n-                      : (initializingHandler = {\n-                          chunk: null,\n-                          value: null,\n-                          reason: value.reason,\n-                          deps: 0,\n-                          errored: !0\n-                        }),\n-                    null\n-                  );\n-              }\n-            }\n-            var name = reference[id];\n-            \"object\" === typeof value &&\n-              hasOwnProperty.call(value, name) &&\n-              (value = value[name]);\n+          id = id.value;\n+          for (var i = 1; i < reference.length; i++) {\n+            var name = reference[i];\n+            if (\n+              \"object\" !== typeof id ||\n+              null === id ||\n+              (getPrototypeOf(id) !== ObjectPrototype &&\n+                getPrototypeOf(id) !== ArrayPrototype) ||\n+              !hasOwnProperty.call(id, name)\n+            )\n+              throw Error(\"Invalid reference.\");\n+            id = id[name];\n           }\n-          return map(response, value, parentObject, key);\n+          return map(response, id, parentObject, key);\n         case \"pending\":\n         case \"blocked\":\n-          return waitForReference(\n-            id,\n-            parentObject,\n-            key,\n-            response,\n-            map,\n-            reference\n+          return (\n+            initializingHandler\n+              ? ((response = initializingHandler), response.deps++)\n+              : (response = initializingHandler =\n+                  {\n+                    chunk: null,\n+                    value: null,\n+                    reason: null,\n+                    deps: 1,\n+                    errored: !1\n+                  }),\n+            (parentObject = {\n+              handler: response,\n+              parentObject: parentObject,\n+              key: key,\n+              map: map,\n+              path: reference\n+            }),\n+            null === id.value\n+              ? (id.value = [parentObject])\n+              : id.value.push(parentObject),\n+            null === id.reason\n+              ? (id.reason = [parentObject])\n+              : id.reason.push(parentObject),\n+            null\n           );\n         default:\n           return (\n@@ -4417,9 +4366,10 @@\n       parentKey\n     ) {\n       reference = parseInt(reference.slice(2), 16);\n-      reference = response._formData\n-        .get(response._prefix + reference)\n-        .arrayBuffer();\n+      bytesPerElement = response._prefix + reference;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized typed array.\");\n+      reference = response._formData.get(bytesPerElement).arrayBuffer();\n       if (initializingHandler) {\n         var handler = initializingHandler;\n         handler.deps++;\n@@ -4448,6 +4398,7 @@\n             var resolveListeners = buffer.value;\n             buffer.status = \"fulfilled\";\n             buffer.value = handler.value;\n+            buffer.reason = null;\n             null !== resolveListeners &&\n               wakeChunk(response, resolveListeners, handler.value);\n           }\n@@ -4482,7 +4433,10 @@\n     }\n     function parseReadableStream(response, reference, type) {\n       reference = parseInt(reference.slice(2), 16);\n-      var controller = null;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -4529,24 +4483,28 @@\n           }\n         },\n         close: function () {\n-          if (null === previousBlockedChunk) controller.close();\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.close();\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.close();\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.close();\n+              });\n+            }\n         },\n         error: function (error) {\n-          if (null === previousBlockedChunk) controller.error(error);\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.error(error);\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.error(error);\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.error(error);\n+              });\n+            }\n         }\n       });\n       return type;\n@@ -4561,6 +4519,8 @@\n     }\n     function parseAsyncIterable(response, reference, iterator) {\n       reference = parseInt(reference.slice(2), 16);\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n       var buffer = [],\n         closed = !1,\n         nextWriteIndex = 0,\n@@ -4601,36 +4561,46 @@\n           nextWriteIndex++;\n         },\n         close: function (value) {\n-          closed = !0;\n-          nextWriteIndex === buffer.length\n-            ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                response,\n-                value,\n-                !0\n-              ))\n-            : resolveIteratorResultChunk(\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length\n+                  ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                      response,\n+                      value,\n+                      !0\n+                    ))\n+                  : resolveIteratorResultChunk(\n+                      response,\n+                      buffer[nextWriteIndex],\n+                      value,\n+                      !0\n+                    ),\n+                nextWriteIndex++;\n+              nextWriteIndex < buffer.length;\n+\n+            )\n+              resolveIteratorResultChunk(\n                 response,\n-                buffer[nextWriteIndex],\n-                value,\n+                buffer[nextWriteIndex++],\n+                '\"$undefined\"',\n                 !0\n               );\n-          for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-            resolveIteratorResultChunk(\n-              response,\n-              buffer[nextWriteIndex++],\n-              '\"$undefined\"',\n-              !0\n-            );\n         },\n         error: function (error) {\n-          closed = !0;\n-          for (\n-            nextWriteIndex === buffer.length &&\n-            (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-            nextWriteIndex < buffer.length;\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length &&\n+                  (buffer[nextWriteIndex] = new ReactPromise(\n+                    \"pending\",\n+                    null,\n+                    null\n+                  ));\n+              nextWriteIndex < buffer.length;\n \n-          )\n-            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+            )\n+              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n         }\n       });\n       return iterator;\n@@ -4644,7 +4614,7 @@\n             return (\n               (obj = parseInt(value.slice(2), 16)), getChunk(response, obj)\n             );\n-          case \"F\":\n+          case \"h\":\n             return (\n               (value = value.slice(2)),\n               getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -4918,6 +4888,13 @@\n       SERVER_REFERENCE_TAG = Symbol.for(\"react.server.reference\"),\n       FunctionBind = Function.prototype.bind,\n       ArraySlice = Array.prototype.slice,\n+      serverReferenceToString = {\n+        value: function () {\n+          return \"function () { [omitted code] }\";\n+        },\n+        configurable: !0,\n+        writable: !0\n+      },\n       PROMISE_PROTOTYPE = Promise.prototype,\n       deepProxyHandlers = {\n         get: function (target, name) {\n@@ -5303,7 +5280,7 @@\n       patchConsole(console, \"table\"),\n       patchConsole(console, \"trace\"),\n       patchConsole(console, \"warn\"));\n-    var ObjectPrototype = Object.prototype,\n+    var ObjectPrototype$1 = Object.prototype,\n       stringify = JSON.stringify,\n       ABORTING = 12,\n       CLOSED = 14,\n@@ -5328,7 +5305,23 @@\n       }\n       switch (this.status) {\n         case \"fulfilled\":\n-          \"function\" === typeof resolve && resolve(this.value);\n+          if (\"function\" === typeof resolve) {\n+            for (\n+              var inspectedValue = this.value;\n+              inspectedValue instanceof ReactPromise;\n+\n+            ) {\n+              if (inspectedValue === this) {\n+                \"function\" === typeof reject &&\n+                  reject(Error(\"Cannot have cyclic thenables.\"));\n+                return;\n+              }\n+              if (\"fulfilled\" === inspectedValue.status)\n+                inspectedValue = inspectedValue.value;\n+              else break;\n+            }\n+            resolve(this.value);\n+          }\n           break;\n         case \"pending\":\n         case \"blocked\":\n@@ -5343,7 +5336,9 @@\n           \"function\" === typeof reject && reject(this.reason);\n       }\n     };\n-    var initializingHandler = null;\n+    var ObjectPrototype = Object.prototype,\n+      ArrayPrototype = Array.prototype,\n+      initializingHandler = null;\n     exports.createClientModuleProxy = function (moduleId) {\n       moduleId = registerClientReferenceImpl({}, moduleId, !1);\n       return new Proxy(moduleId, proxyHandlers$1);\n@@ -5471,7 +5466,8 @@\n         },\n         $$bound: { value: null, configurable: !0 },\n         $$location: { value: Error(\"react-stack-top-frame\"), configurable: !0 },\n-        bind: { value: bind, configurable: !0 }\n+        bind: { value: bind, configurable: !0 },\n+        toString: serverReferenceToString\n       });\n     };\n     exports.renderToReadableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "f3d068a1c36db415f09347927bada0723adc0c95",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-server.browser.production.js",
            "status": "modified",
            "additions": 169,
            "deletions": 172,
            "changes": 341,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -101,7 +101,14 @@ function bind() {\n   }\n   return newFn;\n }\n-var PROMISE_PROTOTYPE = Promise.prototype,\n+var serverReferenceToString = {\n+    value: function () {\n+      return \"function () { [omitted code] }\";\n+    },\n+    configurable: !0,\n+    writable: !0\n+  },\n+  PROMISE_PROTOTYPE = Promise.prototype,\n   deepProxyHandlers = {\n     get: function (target, name) {\n       switch (name) {\n@@ -820,7 +827,7 @@ function describeObjectForErrorMessage(objectOrArray, expandedName) {\n       : \"\\n  \" + str;\n }\n var hasOwnProperty = Object.prototype.hasOwnProperty,\n-  ObjectPrototype = Object.prototype,\n+  ObjectPrototype$1 = Object.prototype,\n   stringify = JSON.stringify;\n function defaultErrorHandler(error) {\n   console.error(error);\n@@ -1700,7 +1707,7 @@ function renderModelDestructive(\n     if (value instanceof Date) return \"$D\" + value.toJSON();\n     request = getPrototypeOf(value);\n     if (\n-      request !== ObjectPrototype &&\n+      request !== ObjectPrototype$1 &&\n       (null === request || null !== getPrototypeOf(request))\n     )\n       throw Error(\n@@ -1751,7 +1758,7 @@ function renderModelDestructive(\n         (task = request.writtenServerReferences),\n         (parentPropertyName = task.get(value)),\n         void 0 !== parentPropertyName\n-          ? (request = \"$F\" + parentPropertyName.toString(16))\n+          ? (request = \"$h\" + parentPropertyName.toString(16))\n           : ((parentPropertyName = value.$$bound),\n             (parentPropertyName =\n               null === parentPropertyName\n@@ -1763,7 +1770,7 @@ function renderModelDestructive(\n               0\n             )),\n             task.set(value, request),\n-            (request = \"$F\" + request.toString(16))),\n+            (request = \"$h\" + request.toString(16))),\n         request\n       );\n     if (\n@@ -2267,7 +2274,23 @@ ReactPromise.prototype.then = function (resolve, reject) {\n   }\n   switch (this.status) {\n     case \"fulfilled\":\n-      \"function\" === typeof resolve && resolve(this.value);\n+      if (\"function\" === typeof resolve) {\n+        for (\n+          var inspectedValue = this.value;\n+          inspectedValue instanceof ReactPromise;\n+\n+        ) {\n+          if (inspectedValue === this) {\n+            \"function\" === typeof reject &&\n+              reject(Error(\"Cannot have cyclic thenables.\"));\n+            return;\n+          }\n+          if (\"fulfilled\" === inspectedValue.status)\n+            inspectedValue = inspectedValue.value;\n+          else break;\n+        }\n+        resolve(this.value);\n+      }\n       break;\n     case \"pending\":\n     case \"blocked\":\n@@ -2280,6 +2303,8 @@ ReactPromise.prototype.then = function (resolve, reject) {\n       \"function\" === typeof reject && reject(this.reason);\n   }\n };\n+var ObjectPrototype = Object.prototype,\n+  ArrayPrototype = Array.prototype;\n function wakeChunk(response, listeners, value) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n@@ -2457,6 +2482,7 @@ function loadServerReference$1(response, metaData, parentObject, key) {\n           ((promiseValue = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n+          (resolvedValue.reason = null),\n           null !== promiseValue &&\n             wakeChunk(response, promiseValue, handler.value)));\n     },\n@@ -2548,6 +2574,7 @@ function initializeModelChunk(chunk) {\n     }\n     chunk.status = \"fulfilled\";\n     chunk.value = value;\n+    chunk.reason = null;\n   } catch (error) {\n     (chunk.status = \"rejected\"), (chunk.reason = error);\n   } finally {\n@@ -2558,7 +2585,11 @@ function reportGlobalError(response, error) {\n   response._closed = !0;\n   response._closedReason = error;\n   response._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status && triggerErrorOnChunk(response, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(response, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function getChunk(response, id) {\n@@ -2576,58 +2607,41 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n-    for (; value instanceof ReactPromise; ) {\n-      switch (value.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(value);\n-      }\n-      switch (value.status) {\n-        case \"fulfilled\":\n-          value = value.value;\n-          continue;\n-        case \"blocked\":\n-        case \"pending\":\n-          path.splice(0, i - 1);\n-          null === value.value\n-            ? (value.value = [reference])\n-            : value.value.push(reference);\n-          null === value.reason\n-            ? (value.reason = [reference])\n-            : value.reason.push(reference);\n-          return;\n-        default:\n-          rejectReference(response, reference.handler, value.reason);\n-          return;\n-      }\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      var name = path[i];\n+      if (\n+        \"object\" !== typeof value ||\n+        null === value ||\n+        (getPrototypeOf(value) !== ObjectPrototype &&\n+          getPrototypeOf(value) !== ArrayPrototype) ||\n+        !hasOwnProperty.call(value, name)\n+      )\n+        throw Error(\"Invalid reference.\");\n+      value = value[name];\n     }\n-    var name = path[i];\n-    \"object\" === typeof value &&\n-      hasOwnProperty.call(value, name) &&\n-      (value = value[name]);\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n   }\n-  reference = map(response, value, parentObject, key);\n-  parentObject[key] = reference;\n-  \"\" === key && null === handler.value && (handler.value = reference);\n   handler.deps--;\n   0 === handler.deps &&\n-    ((parentObject = handler.chunk),\n-    null !== parentObject &&\n-      \"blocked\" === parentObject.status &&\n-      ((key = parentObject.value),\n-      (parentObject.status = \"fulfilled\"),\n-      (parentObject.value = handler.value),\n-      (parentObject.reason = handler.reason),\n-      null !== key && wakeChunk(response, key, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -2639,33 +2653,6 @@ function rejectReference(response, handler, error) {\n       \"blocked\" === handler.status &&\n       triggerErrorOnChunk(response, handler, error));\n }\n-function waitForReference(\n-  referencedChunk,\n-  parentObject,\n-  key,\n-  response,\n-  map,\n-  path\n-) {\n-  initializingHandler\n-    ? ((response = initializingHandler), response.deps++)\n-    : (response = initializingHandler =\n-        { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-  parentObject = {\n-    handler: response,\n-    parentObject: parentObject,\n-    key: key,\n-    map: map,\n-    path: path\n-  };\n-  null === referencedChunk.value\n-    ? (referencedChunk.value = [parentObject])\n-    : referencedChunk.value.push(parentObject);\n-  null === referencedChunk.reason\n-    ? (referencedChunk.reason = [parentObject])\n-    : referencedChunk.reason.push(parentObject);\n-  return null;\n-}\n function getOutlinedModel(response, reference, parentObject, key, map) {\n   reference = reference.split(\":\");\n   var id = parseInt(reference[0], 16);\n@@ -2676,53 +2663,42 @@ function getOutlinedModel(response, reference, parentObject, key, map) {\n   }\n   switch (id.status) {\n     case \"fulfilled\":\n-      var value = id.value;\n-      for (id = 1; id < reference.length; id++) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              break;\n-            case \"blocked\":\n-            case \"pending\":\n-              return waitForReference(\n-                value,\n-                parentObject,\n-                key,\n-                response,\n-                map,\n-                reference.slice(id - 1)\n-              );\n-            default:\n-              return (\n-                initializingHandler\n-                  ? ((initializingHandler.errored = !0),\n-                    (initializingHandler.value = null),\n-                    (initializingHandler.reason = value.reason))\n-                  : (initializingHandler = {\n-                      chunk: null,\n-                      value: null,\n-                      reason: value.reason,\n-                      deps: 0,\n-                      errored: !0\n-                    }),\n-                null\n-              );\n-          }\n-        }\n-        var name = reference[id];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+      id = id.value;\n+      for (var i = 1; i < reference.length; i++) {\n+        var name = reference[i];\n+        if (\n+          \"object\" !== typeof id ||\n+          null === id ||\n+          (getPrototypeOf(id) !== ObjectPrototype &&\n+            getPrototypeOf(id) !== ArrayPrototype) ||\n+          !hasOwnProperty.call(id, name)\n+        )\n+          throw Error(\"Invalid reference.\");\n+        id = id[name];\n       }\n-      return map(response, value, parentObject, key);\n+      return map(response, id, parentObject, key);\n     case \"pending\":\n     case \"blocked\":\n-      return waitForReference(id, parentObject, key, response, map, reference);\n+      return (\n+        initializingHandler\n+          ? ((response = initializingHandler), response.deps++)\n+          : (response = initializingHandler =\n+              { chunk: null, value: null, reason: null, deps: 1, errored: !1 }),\n+        (parentObject = {\n+          handler: response,\n+          parentObject: parentObject,\n+          key: key,\n+          map: map,\n+          path: reference\n+        }),\n+        null === id.value\n+          ? (id.value = [parentObject])\n+          : id.value.push(parentObject),\n+        null === id.reason\n+          ? (id.reason = [parentObject])\n+          : id.reason.push(parentObject),\n+        null\n+      );\n     default:\n       return (\n         initializingHandler\n@@ -2761,9 +2737,10 @@ function parseTypedArray(\n   parentKey\n ) {\n   reference = parseInt(reference.slice(2), 16);\n-  reference = response._formData\n-    .get(response._prefix + reference)\n-    .arrayBuffer();\n+  bytesPerElement = response._prefix + reference;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized typed array.\");\n+  reference = response._formData.get(bytesPerElement).arrayBuffer();\n   if (initializingHandler) {\n     var handler = initializingHandler;\n     handler.deps++;\n@@ -2789,6 +2766,7 @@ function parseTypedArray(\n         var resolveListeners = buffer.value;\n         buffer.status = \"fulfilled\";\n         buffer.value = handler.value;\n+        buffer.reason = null;\n         null !== resolveListeners &&\n           wakeChunk(response, resolveListeners, handler.value);\n       }\n@@ -2821,7 +2799,10 @@ function resolveStream(response, id, stream, controller) {\n }\n function parseReadableStream(response, reference, type) {\n   reference = parseInt(reference.slice(2), 16);\n-  var controller = null;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -2864,24 +2845,27 @@ function parseReadableStream(response, reference, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n   return type;\n@@ -2896,6 +2880,8 @@ function createIterator(next) {\n }\n function parseAsyncIterable(response, reference, iterator) {\n   reference = parseInt(reference.slice(2), 16);\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n   var buffer = [],\n     closed = !1,\n     nextWriteIndex = 0,\n@@ -2939,36 +2925,46 @@ function parseAsyncIterable(response, reference, iterator) {\n       nextWriteIndex++;\n     },\n     close: function (value) {\n-      closed = !0;\n-      nextWriteIndex === buffer.length\n-        ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-            response,\n-            value,\n-            !0\n-          ))\n-        : resolveIteratorResultChunk(\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length\n+              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                  response,\n+                  value,\n+                  !0\n+                ))\n+              : resolveIteratorResultChunk(\n+                  response,\n+                  buffer[nextWriteIndex],\n+                  value,\n+                  !0\n+                ),\n+            nextWriteIndex++;\n+          nextWriteIndex < buffer.length;\n+\n+        )\n+          resolveIteratorResultChunk(\n             response,\n-            buffer[nextWriteIndex],\n-            value,\n+            buffer[nextWriteIndex++],\n+            '\"$undefined\"',\n             !0\n           );\n-      for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-        resolveIteratorResultChunk(\n-          response,\n-          buffer[nextWriteIndex++],\n-          '\"$undefined\"',\n-          !0\n-        );\n     },\n     error: function (error) {\n-      closed = !0;\n-      for (\n-        nextWriteIndex === buffer.length &&\n-        (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-        nextWriteIndex < buffer.length;\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length &&\n+              (buffer[nextWriteIndex] = new ReactPromise(\n+                \"pending\",\n+                null,\n+                null\n+              ));\n+          nextWriteIndex < buffer.length;\n \n-      )\n-        triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+        )\n+          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n     }\n   });\n   return iterator;\n@@ -2980,7 +2976,7 @@ function parseModelString(response, obj, key, value, reference) {\n         return value.slice(1);\n       case \"@\":\n         return (obj = parseInt(value.slice(2), 16)), getChunk(response, obj);\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -3241,7 +3237,8 @@ exports.registerServerReference = function (reference, id, exportName) {\n       configurable: !0\n     },\n     $$bound: { value: null, configurable: !0 },\n-    bind: { value: bind, configurable: !0 }\n+    bind: { value: bind, configurable: !0 },\n+    toString: serverReferenceToString\n   });\n };\n exports.renderToReadableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "86d55db888dc468ed4cfcc546e3da5ca6cdf5388",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-server.edge.development.js",
            "status": "modified",
            "additions": 176,
            "deletions": 180,
            "changes": 356,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -2192,7 +2192,7 @@\n     function serializeServerReference(request, serverReference) {\n       var writtenServerReferences = request.writtenServerReferences,\n         existingId = writtenServerReferences.get(serverReference);\n-      if (void 0 !== existingId) return \"$F\" + existingId.toString(16);\n+      if (void 0 !== existingId) return \"$h\" + existingId.toString(16);\n       existingId = serverReference.$$bound;\n       existingId = null === existingId ? null : Promise.resolve(existingId);\n       var id = serverReference.$$id,\n@@ -2218,7 +2218,7 @@\n           : { id: id, bound: existingId };\n       request = outlineModel(request, existingId);\n       writtenServerReferences.set(serverReference, request);\n-      return \"$F\" + request.toString(16);\n+      return \"$h\" + request.toString(16);\n     }\n     function serializeLargeTextString(request, text) {\n       request.pendingChunks++;\n@@ -2612,7 +2612,7 @@\n         if (value instanceof Date) return \"$D\" + value.toJSON();\n         elementReference = getPrototypeOf(value);\n         if (\n-          elementReference !== ObjectPrototype &&\n+          elementReference !== ObjectPrototype$1 &&\n           (null === elementReference ||\n             null !== getPrototypeOf(elementReference))\n         )\n@@ -3200,7 +3200,7 @@\n           return serializeDebugBlob(request, value);\n         if (getIteratorFn(value)) return Array.from(value);\n         request = getPrototypeOf(value);\n-        if (request !== ObjectPrototype && null !== request) {\n+        if (request !== ObjectPrototype$1 && null !== request) {\n           counter = Object.create(null);\n           for (env in value)\n             if (hasOwnProperty.call(value, env) || isGetter(request, env))\n@@ -4163,6 +4163,7 @@\n               ((promiseValue = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== promiseValue &&\n                 wakeChunk(response, promiseValue, handler.value)));\n         },\n@@ -4266,6 +4267,7 @@\n         }\n         chunk.status = \"fulfilled\";\n         chunk.value = value;\n+        chunk.reason = null;\n       } catch (error) {\n         (chunk.status = \"rejected\"), (chunk.reason = error);\n       } finally {\n@@ -4276,8 +4278,11 @@\n       response._closed = !0;\n       response._closedReason = error;\n       response._chunks.forEach(function (chunk) {\n-        \"pending\" === chunk.status &&\n-          triggerErrorOnChunk(response, chunk, error);\n+        \"pending\" === chunk.status\n+          ? triggerErrorOnChunk(response, chunk, error)\n+          : \"fulfilled\" === chunk.status &&\n+            null !== chunk.reason &&\n+            chunk.reason.error(error);\n       });\n     }\n     function getChunk(response, id) {\n@@ -4299,58 +4304,41 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              continue;\n-            case \"blocked\":\n-            case \"pending\":\n-              path.splice(0, i - 1);\n-              null === value.value\n-                ? (value.value = [reference])\n-                : value.value.push(reference);\n-              null === value.reason\n-                ? (value.reason = [reference])\n-                : value.reason.push(reference);\n-              return;\n-            default:\n-              rejectReference(response, reference.handler, value.reason);\n-              return;\n-          }\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          var name = path[i];\n+          if (\n+            \"object\" !== typeof value ||\n+            null === value ||\n+            (getPrototypeOf(value) !== ObjectPrototype &&\n+              getPrototypeOf(value) !== ArrayPrototype) ||\n+            !hasOwnProperty.call(value, name)\n+          )\n+            throw Error(\"Invalid reference.\");\n+          value = value[name];\n         }\n-        var name = path[i];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n       }\n-      reference = map(response, value, parentObject, key);\n-      parentObject[key] = reference;\n-      \"\" === key && null === handler.value && (handler.value = reference);\n       handler.deps--;\n       0 === handler.deps &&\n-        ((parentObject = handler.chunk),\n-        null !== parentObject &&\n-          \"blocked\" === parentObject.status &&\n-          ((key = parentObject.value),\n-          (parentObject.status = \"fulfilled\"),\n-          (parentObject.value = handler.value),\n-          (parentObject.reason = handler.reason),\n-          null !== key && wakeChunk(response, key, handler.value)));\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value && wakeChunk(response, value, handler.value)));\n     }\n     function rejectReference(response, handler, error) {\n       handler.errored ||\n@@ -4362,33 +4350,6 @@\n           \"blocked\" === handler.status &&\n           triggerErrorOnChunk(response, handler, error));\n     }\n-    function waitForReference(\n-      referencedChunk,\n-      parentObject,\n-      key,\n-      response,\n-      map,\n-      path\n-    ) {\n-      initializingHandler\n-        ? ((response = initializingHandler), response.deps++)\n-        : (response = initializingHandler =\n-            { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-      parentObject = {\n-        handler: response,\n-        parentObject: parentObject,\n-        key: key,\n-        map: map,\n-        path: path\n-      };\n-      null === referencedChunk.value\n-        ? (referencedChunk.value = [parentObject])\n-        : referencedChunk.value.push(parentObject);\n-      null === referencedChunk.reason\n-        ? (referencedChunk.reason = [parentObject])\n-        : referencedChunk.reason.push(parentObject);\n-      return null;\n-    }\n     function getOutlinedModel(response, reference, parentObject, key, map) {\n       reference = reference.split(\":\");\n       var id = parseInt(reference[0], 16);\n@@ -4399,59 +4360,47 @@\n       }\n       switch (id.status) {\n         case \"fulfilled\":\n-          var value = id.value;\n-          for (id = 1; id < reference.length; id++) {\n-            for (; value instanceof ReactPromise; ) {\n-              switch (value.status) {\n-                case \"resolved_model\":\n-                  initializeModelChunk(value);\n-              }\n-              switch (value.status) {\n-                case \"fulfilled\":\n-                  value = value.value;\n-                  break;\n-                case \"blocked\":\n-                case \"pending\":\n-                  return waitForReference(\n-                    value,\n-                    parentObject,\n-                    key,\n-                    response,\n-                    map,\n-                    reference.slice(id - 1)\n-                  );\n-                default:\n-                  return (\n-                    initializingHandler\n-                      ? ((initializingHandler.errored = !0),\n-                        (initializingHandler.value = null),\n-                        (initializingHandler.reason = value.reason))\n-                      : (initializingHandler = {\n-                          chunk: null,\n-                          value: null,\n-                          reason: value.reason,\n-                          deps: 0,\n-                          errored: !0\n-                        }),\n-                    null\n-                  );\n-              }\n-            }\n-            var name = reference[id];\n-            \"object\" === typeof value &&\n-              hasOwnProperty.call(value, name) &&\n-              (value = value[name]);\n+          id = id.value;\n+          for (var i = 1; i < reference.length; i++) {\n+            var name = reference[i];\n+            if (\n+              \"object\" !== typeof id ||\n+              null === id ||\n+              (getPrototypeOf(id) !== ObjectPrototype &&\n+                getPrototypeOf(id) !== ArrayPrototype) ||\n+              !hasOwnProperty.call(id, name)\n+            )\n+              throw Error(\"Invalid reference.\");\n+            id = id[name];\n           }\n-          return map(response, value, parentObject, key);\n+          return map(response, id, parentObject, key);\n         case \"pending\":\n         case \"blocked\":\n-          return waitForReference(\n-            id,\n-            parentObject,\n-            key,\n-            response,\n-            map,\n-            reference\n+          return (\n+            initializingHandler\n+              ? ((response = initializingHandler), response.deps++)\n+              : (response = initializingHandler =\n+                  {\n+                    chunk: null,\n+                    value: null,\n+                    reason: null,\n+                    deps: 1,\n+                    errored: !1\n+                  }),\n+            (parentObject = {\n+              handler: response,\n+              parentObject: parentObject,\n+              key: key,\n+              map: map,\n+              path: reference\n+            }),\n+            null === id.value\n+              ? (id.value = [parentObject])\n+              : id.value.push(parentObject),\n+            null === id.reason\n+              ? (id.reason = [parentObject])\n+              : id.reason.push(parentObject),\n+            null\n           );\n         default:\n           return (\n@@ -4491,9 +4440,10 @@\n       parentKey\n     ) {\n       reference = parseInt(reference.slice(2), 16);\n-      reference = response._formData\n-        .get(response._prefix + reference)\n-        .arrayBuffer();\n+      bytesPerElement = response._prefix + reference;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized typed array.\");\n+      reference = response._formData.get(bytesPerElement).arrayBuffer();\n       if (initializingHandler) {\n         var handler = initializingHandler;\n         handler.deps++;\n@@ -4522,6 +4472,7 @@\n             var resolveListeners = buffer.value;\n             buffer.status = \"fulfilled\";\n             buffer.value = handler.value;\n+            buffer.reason = null;\n             null !== resolveListeners &&\n               wakeChunk(response, resolveListeners, handler.value);\n           }\n@@ -4556,7 +4507,10 @@\n     }\n     function parseReadableStream(response, reference, type) {\n       reference = parseInt(reference.slice(2), 16);\n-      var controller = null;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -4603,24 +4557,28 @@\n           }\n         },\n         close: function () {\n-          if (null === previousBlockedChunk) controller.close();\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.close();\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.close();\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.close();\n+              });\n+            }\n         },\n         error: function (error) {\n-          if (null === previousBlockedChunk) controller.error(error);\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.error(error);\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.error(error);\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.error(error);\n+              });\n+            }\n         }\n       });\n       return type;\n@@ -4635,6 +4593,8 @@\n     }\n     function parseAsyncIterable(response, reference, iterator) {\n       reference = parseInt(reference.slice(2), 16);\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n       var buffer = [],\n         closed = !1,\n         nextWriteIndex = 0,\n@@ -4675,36 +4635,46 @@\n           nextWriteIndex++;\n         },\n         close: function (value) {\n-          closed = !0;\n-          nextWriteIndex === buffer.length\n-            ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                response,\n-                value,\n-                !0\n-              ))\n-            : resolveIteratorResultChunk(\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length\n+                  ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                      response,\n+                      value,\n+                      !0\n+                    ))\n+                  : resolveIteratorResultChunk(\n+                      response,\n+                      buffer[nextWriteIndex],\n+                      value,\n+                      !0\n+                    ),\n+                nextWriteIndex++;\n+              nextWriteIndex < buffer.length;\n+\n+            )\n+              resolveIteratorResultChunk(\n                 response,\n-                buffer[nextWriteIndex],\n-                value,\n+                buffer[nextWriteIndex++],\n+                '\"$undefined\"',\n                 !0\n               );\n-          for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-            resolveIteratorResultChunk(\n-              response,\n-              buffer[nextWriteIndex++],\n-              '\"$undefined\"',\n-              !0\n-            );\n         },\n         error: function (error) {\n-          closed = !0;\n-          for (\n-            nextWriteIndex === buffer.length &&\n-            (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-            nextWriteIndex < buffer.length;\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length &&\n+                  (buffer[nextWriteIndex] = new ReactPromise(\n+                    \"pending\",\n+                    null,\n+                    null\n+                  ));\n+              nextWriteIndex < buffer.length;\n \n-          )\n-            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+            )\n+              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n         }\n       });\n       return iterator;\n@@ -4718,7 +4688,7 @@\n             return (\n               (obj = parseInt(value.slice(2), 16)), getChunk(response, obj)\n             );\n-          case \"F\":\n+          case \"h\":\n             return (\n               (value = value.slice(2)),\n               getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -5000,6 +4970,13 @@\n       SERVER_REFERENCE_TAG = Symbol.for(\"react.server.reference\"),\n       FunctionBind = Function.prototype.bind,\n       ArraySlice = Array.prototype.slice,\n+      serverReferenceToString = {\n+        value: function () {\n+          return \"function () { [omitted code] }\";\n+        },\n+        configurable: !0,\n+        writable: !0\n+      },\n       PROMISE_PROTOTYPE = Promise.prototype,\n       deepProxyHandlers = {\n         get: function (target, name) {\n@@ -5377,7 +5354,7 @@\n       patchConsole(console, \"table\"),\n       patchConsole(console, \"trace\"),\n       patchConsole(console, \"warn\"));\n-    var ObjectPrototype = Object.prototype,\n+    var ObjectPrototype$1 = Object.prototype,\n       stringify = JSON.stringify,\n       ABORTING = 12,\n       CLOSED = 14,\n@@ -5402,7 +5379,23 @@\n       }\n       switch (this.status) {\n         case \"fulfilled\":\n-          \"function\" === typeof resolve && resolve(this.value);\n+          if (\"function\" === typeof resolve) {\n+            for (\n+              var inspectedValue = this.value;\n+              inspectedValue instanceof ReactPromise;\n+\n+            ) {\n+              if (inspectedValue === this) {\n+                \"function\" === typeof reject &&\n+                  reject(Error(\"Cannot have cyclic thenables.\"));\n+                return;\n+              }\n+              if (\"fulfilled\" === inspectedValue.status)\n+                inspectedValue = inspectedValue.value;\n+              else break;\n+            }\n+            resolve(this.value);\n+          }\n           break;\n         case \"pending\":\n         case \"blocked\":\n@@ -5417,7 +5410,9 @@\n           \"function\" === typeof reject && reject(this.reason);\n       }\n     };\n-    var initializingHandler = null;\n+    var ObjectPrototype = Object.prototype,\n+      ArrayPrototype = Array.prototype,\n+      initializingHandler = null;\n     exports.createClientModuleProxy = function (moduleId) {\n       moduleId = registerClientReferenceImpl({}, moduleId, !1);\n       return new Proxy(moduleId, proxyHandlers$1);\n@@ -5584,7 +5579,8 @@\n         },\n         $$bound: { value: null, configurable: !0 },\n         $$location: { value: Error(\"react-stack-top-frame\"), configurable: !0 },\n-        bind: { value: bind, configurable: !0 }\n+        bind: { value: bind, configurable: !0 },\n+        toString: serverReferenceToString\n       });\n     };\n     exports.renderToReadableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "fb5a35106fbe9f832e4033e12aed9472881bdddb",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-server.edge.production.js",
            "status": "modified",
            "additions": 169,
            "deletions": 172,
            "changes": 341,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -112,7 +112,14 @@ function bind() {\n   }\n   return newFn;\n }\n-var PROMISE_PROTOTYPE = Promise.prototype,\n+var serverReferenceToString = {\n+    value: function () {\n+      return \"function () { [omitted code] }\";\n+    },\n+    configurable: !0,\n+    writable: !0\n+  },\n+  PROMISE_PROTOTYPE = Promise.prototype,\n   deepProxyHandlers = {\n     get: function (target, name) {\n       switch (name) {\n@@ -811,7 +818,7 @@ function describeObjectForErrorMessage(objectOrArray, expandedName) {\n       : \"\\n  \" + str;\n }\n var hasOwnProperty = Object.prototype.hasOwnProperty,\n-  ObjectPrototype = Object.prototype,\n+  ObjectPrototype$1 = Object.prototype,\n   stringify = JSON.stringify;\n function defaultErrorHandler(error) {\n   console.error(error);\n@@ -1699,7 +1706,7 @@ function renderModelDestructive(\n     if (value instanceof Date) return \"$D\" + value.toJSON();\n     request = getPrototypeOf(value);\n     if (\n-      request !== ObjectPrototype &&\n+      request !== ObjectPrototype$1 &&\n       (null === request || null !== getPrototypeOf(request))\n     )\n       throw Error(\n@@ -1750,7 +1757,7 @@ function renderModelDestructive(\n         (task = request.writtenServerReferences),\n         (parentPropertyName = task.get(value)),\n         void 0 !== parentPropertyName\n-          ? (request = \"$F\" + parentPropertyName.toString(16))\n+          ? (request = \"$h\" + parentPropertyName.toString(16))\n           : ((parentPropertyName = value.$$bound),\n             (parentPropertyName =\n               null === parentPropertyName\n@@ -1762,7 +1769,7 @@ function renderModelDestructive(\n               0\n             )),\n             task.set(value, request),\n-            (request = \"$F\" + request.toString(16))),\n+            (request = \"$h\" + request.toString(16))),\n         request\n       );\n     if (\n@@ -2271,7 +2278,23 @@ ReactPromise.prototype.then = function (resolve, reject) {\n   }\n   switch (this.status) {\n     case \"fulfilled\":\n-      \"function\" === typeof resolve && resolve(this.value);\n+      if (\"function\" === typeof resolve) {\n+        for (\n+          var inspectedValue = this.value;\n+          inspectedValue instanceof ReactPromise;\n+\n+        ) {\n+          if (inspectedValue === this) {\n+            \"function\" === typeof reject &&\n+              reject(Error(\"Cannot have cyclic thenables.\"));\n+            return;\n+          }\n+          if (\"fulfilled\" === inspectedValue.status)\n+            inspectedValue = inspectedValue.value;\n+          else break;\n+        }\n+        resolve(this.value);\n+      }\n       break;\n     case \"pending\":\n     case \"blocked\":\n@@ -2284,6 +2307,8 @@ ReactPromise.prototype.then = function (resolve, reject) {\n       \"function\" === typeof reject && reject(this.reason);\n   }\n };\n+var ObjectPrototype = Object.prototype,\n+  ArrayPrototype = Array.prototype;\n function wakeChunk(response, listeners, value) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n@@ -2461,6 +2486,7 @@ function loadServerReference$1(response, metaData, parentObject, key) {\n           ((promiseValue = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n+          (resolvedValue.reason = null),\n           null !== promiseValue &&\n             wakeChunk(response, promiseValue, handler.value)));\n     },\n@@ -2552,6 +2578,7 @@ function initializeModelChunk(chunk) {\n     }\n     chunk.status = \"fulfilled\";\n     chunk.value = value;\n+    chunk.reason = null;\n   } catch (error) {\n     (chunk.status = \"rejected\"), (chunk.reason = error);\n   } finally {\n@@ -2562,7 +2589,11 @@ function reportGlobalError(response, error) {\n   response._closed = !0;\n   response._closedReason = error;\n   response._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status && triggerErrorOnChunk(response, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(response, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function getChunk(response, id) {\n@@ -2580,58 +2611,41 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n-    for (; value instanceof ReactPromise; ) {\n-      switch (value.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(value);\n-      }\n-      switch (value.status) {\n-        case \"fulfilled\":\n-          value = value.value;\n-          continue;\n-        case \"blocked\":\n-        case \"pending\":\n-          path.splice(0, i - 1);\n-          null === value.value\n-            ? (value.value = [reference])\n-            : value.value.push(reference);\n-          null === value.reason\n-            ? (value.reason = [reference])\n-            : value.reason.push(reference);\n-          return;\n-        default:\n-          rejectReference(response, reference.handler, value.reason);\n-          return;\n-      }\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      var name = path[i];\n+      if (\n+        \"object\" !== typeof value ||\n+        null === value ||\n+        (getPrototypeOf(value) !== ObjectPrototype &&\n+          getPrototypeOf(value) !== ArrayPrototype) ||\n+        !hasOwnProperty.call(value, name)\n+      )\n+        throw Error(\"Invalid reference.\");\n+      value = value[name];\n     }\n-    var name = path[i];\n-    \"object\" === typeof value &&\n-      hasOwnProperty.call(value, name) &&\n-      (value = value[name]);\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n   }\n-  reference = map(response, value, parentObject, key);\n-  parentObject[key] = reference;\n-  \"\" === key && null === handler.value && (handler.value = reference);\n   handler.deps--;\n   0 === handler.deps &&\n-    ((parentObject = handler.chunk),\n-    null !== parentObject &&\n-      \"blocked\" === parentObject.status &&\n-      ((key = parentObject.value),\n-      (parentObject.status = \"fulfilled\"),\n-      (parentObject.value = handler.value),\n-      (parentObject.reason = handler.reason),\n-      null !== key && wakeChunk(response, key, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -2643,33 +2657,6 @@ function rejectReference(response, handler, error) {\n       \"blocked\" === handler.status &&\n       triggerErrorOnChunk(response, handler, error));\n }\n-function waitForReference(\n-  referencedChunk,\n-  parentObject,\n-  key,\n-  response,\n-  map,\n-  path\n-) {\n-  initializingHandler\n-    ? ((response = initializingHandler), response.deps++)\n-    : (response = initializingHandler =\n-        { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-  parentObject = {\n-    handler: response,\n-    parentObject: parentObject,\n-    key: key,\n-    map: map,\n-    path: path\n-  };\n-  null === referencedChunk.value\n-    ? (referencedChunk.value = [parentObject])\n-    : referencedChunk.value.push(parentObject);\n-  null === referencedChunk.reason\n-    ? (referencedChunk.reason = [parentObject])\n-    : referencedChunk.reason.push(parentObject);\n-  return null;\n-}\n function getOutlinedModel(response, reference, parentObject, key, map) {\n   reference = reference.split(\":\");\n   var id = parseInt(reference[0], 16);\n@@ -2680,53 +2667,42 @@ function getOutlinedModel(response, reference, parentObject, key, map) {\n   }\n   switch (id.status) {\n     case \"fulfilled\":\n-      var value = id.value;\n-      for (id = 1; id < reference.length; id++) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              break;\n-            case \"blocked\":\n-            case \"pending\":\n-              return waitForReference(\n-                value,\n-                parentObject,\n-                key,\n-                response,\n-                map,\n-                reference.slice(id - 1)\n-              );\n-            default:\n-              return (\n-                initializingHandler\n-                  ? ((initializingHandler.errored = !0),\n-                    (initializingHandler.value = null),\n-                    (initializingHandler.reason = value.reason))\n-                  : (initializingHandler = {\n-                      chunk: null,\n-                      value: null,\n-                      reason: value.reason,\n-                      deps: 0,\n-                      errored: !0\n-                    }),\n-                null\n-              );\n-          }\n-        }\n-        var name = reference[id];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+      id = id.value;\n+      for (var i = 1; i < reference.length; i++) {\n+        var name = reference[i];\n+        if (\n+          \"object\" !== typeof id ||\n+          null === id ||\n+          (getPrototypeOf(id) !== ObjectPrototype &&\n+            getPrototypeOf(id) !== ArrayPrototype) ||\n+          !hasOwnProperty.call(id, name)\n+        )\n+          throw Error(\"Invalid reference.\");\n+        id = id[name];\n       }\n-      return map(response, value, parentObject, key);\n+      return map(response, id, parentObject, key);\n     case \"pending\":\n     case \"blocked\":\n-      return waitForReference(id, parentObject, key, response, map, reference);\n+      return (\n+        initializingHandler\n+          ? ((response = initializingHandler), response.deps++)\n+          : (response = initializingHandler =\n+              { chunk: null, value: null, reason: null, deps: 1, errored: !1 }),\n+        (parentObject = {\n+          handler: response,\n+          parentObject: parentObject,\n+          key: key,\n+          map: map,\n+          path: reference\n+        }),\n+        null === id.value\n+          ? (id.value = [parentObject])\n+          : id.value.push(parentObject),\n+        null === id.reason\n+          ? (id.reason = [parentObject])\n+          : id.reason.push(parentObject),\n+        null\n+      );\n     default:\n       return (\n         initializingHandler\n@@ -2765,9 +2741,10 @@ function parseTypedArray(\n   parentKey\n ) {\n   reference = parseInt(reference.slice(2), 16);\n-  reference = response._formData\n-    .get(response._prefix + reference)\n-    .arrayBuffer();\n+  bytesPerElement = response._prefix + reference;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized typed array.\");\n+  reference = response._formData.get(bytesPerElement).arrayBuffer();\n   if (initializingHandler) {\n     var handler = initializingHandler;\n     handler.deps++;\n@@ -2793,6 +2770,7 @@ function parseTypedArray(\n         var resolveListeners = buffer.value;\n         buffer.status = \"fulfilled\";\n         buffer.value = handler.value;\n+        buffer.reason = null;\n         null !== resolveListeners &&\n           wakeChunk(response, resolveListeners, handler.value);\n       }\n@@ -2825,7 +2803,10 @@ function resolveStream(response, id, stream, controller) {\n }\n function parseReadableStream(response, reference, type) {\n   reference = parseInt(reference.slice(2), 16);\n-  var controller = null;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -2868,24 +2849,27 @@ function parseReadableStream(response, reference, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n   return type;\n@@ -2900,6 +2884,8 @@ function createIterator(next) {\n }\n function parseAsyncIterable(response, reference, iterator) {\n   reference = parseInt(reference.slice(2), 16);\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n   var buffer = [],\n     closed = !1,\n     nextWriteIndex = 0,\n@@ -2943,36 +2929,46 @@ function parseAsyncIterable(response, reference, iterator) {\n       nextWriteIndex++;\n     },\n     close: function (value) {\n-      closed = !0;\n-      nextWriteIndex === buffer.length\n-        ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-            response,\n-            value,\n-            !0\n-          ))\n-        : resolveIteratorResultChunk(\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length\n+              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                  response,\n+                  value,\n+                  !0\n+                ))\n+              : resolveIteratorResultChunk(\n+                  response,\n+                  buffer[nextWriteIndex],\n+                  value,\n+                  !0\n+                ),\n+            nextWriteIndex++;\n+          nextWriteIndex < buffer.length;\n+\n+        )\n+          resolveIteratorResultChunk(\n             response,\n-            buffer[nextWriteIndex],\n-            value,\n+            buffer[nextWriteIndex++],\n+            '\"$undefined\"',\n             !0\n           );\n-      for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-        resolveIteratorResultChunk(\n-          response,\n-          buffer[nextWriteIndex++],\n-          '\"$undefined\"',\n-          !0\n-        );\n     },\n     error: function (error) {\n-      closed = !0;\n-      for (\n-        nextWriteIndex === buffer.length &&\n-        (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-        nextWriteIndex < buffer.length;\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length &&\n+              (buffer[nextWriteIndex] = new ReactPromise(\n+                \"pending\",\n+                null,\n+                null\n+              ));\n+          nextWriteIndex < buffer.length;\n \n-      )\n-        triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+        )\n+          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n     }\n   });\n   return iterator;\n@@ -2984,7 +2980,7 @@ function parseModelString(response, obj, key, value, reference) {\n         return value.slice(1);\n       case \"@\":\n         return (obj = parseInt(value.slice(2), 16)), getChunk(response, obj);\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -3283,7 +3279,8 @@ exports.registerServerReference = function (reference, id, exportName) {\n       configurable: !0\n     },\n     $$bound: { value: null, configurable: !0 },\n-    bind: { value: bind, configurable: !0 }\n+    bind: { value: bind, configurable: !0 },\n+    toString: serverReferenceToString\n   });\n };\n exports.renderToReadableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "f32aa276810c9bd5ff9a52b682c9161d64a52c2f",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-server.node.development.js",
            "status": "modified",
            "additions": 179,
            "deletions": 183,
            "changes": 362,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -2440,7 +2440,7 @@\n     function serializeServerReference(request, serverReference) {\n       var writtenServerReferences = request.writtenServerReferences,\n         existingId = writtenServerReferences.get(serverReference);\n-      if (void 0 !== existingId) return \"$F\" + existingId.toString(16);\n+      if (void 0 !== existingId) return \"$h\" + existingId.toString(16);\n       existingId = serverReference.$$bound;\n       existingId = null === existingId ? null : Promise.resolve(existingId);\n       var id = serverReference.$$id,\n@@ -2466,7 +2466,7 @@\n           : { id: id, bound: existingId };\n       request = outlineModel(request, existingId);\n       writtenServerReferences.set(serverReference, request);\n-      return \"$F\" + request.toString(16);\n+      return \"$h\" + request.toString(16);\n     }\n     function serializeLargeTextString(request, text) {\n       request.pendingChunks++;\n@@ -2860,7 +2860,7 @@\n         if (value instanceof Date) return \"$D\" + value.toJSON();\n         elementReference = getPrototypeOf(value);\n         if (\n-          elementReference !== ObjectPrototype &&\n+          elementReference !== ObjectPrototype$1 &&\n           (null === elementReference ||\n             null !== getPrototypeOf(elementReference))\n         )\n@@ -3538,7 +3538,7 @@\n           return serializeDebugBlob(request, value);\n         if (getIteratorFn(value)) return Array.from(value);\n         request = getPrototypeOf(value);\n-        if (request !== ObjectPrototype && null !== request) {\n+        if (request !== ObjectPrototype$1 && null !== request) {\n           counter = Object.create(null);\n           for (env in value)\n             if (hasOwnProperty.call(value, env) || isGetter(request, env))\n@@ -4610,6 +4610,7 @@\n               ((promiseValue = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== promiseValue &&\n                 wakeChunk(response, promiseValue, handler.value)));\n         },\n@@ -4713,6 +4714,7 @@\n         }\n         chunk.status = \"fulfilled\";\n         chunk.value = value;\n+        chunk.reason = null;\n       } catch (error) {\n         (chunk.status = \"rejected\"), (chunk.reason = error);\n       } finally {\n@@ -4723,8 +4725,11 @@\n       response._closed = !0;\n       response._closedReason = error;\n       response._chunks.forEach(function (chunk) {\n-        \"pending\" === chunk.status &&\n-          triggerErrorOnChunk(response, chunk, error);\n+        \"pending\" === chunk.status\n+          ? triggerErrorOnChunk(response, chunk, error)\n+          : \"fulfilled\" === chunk.status &&\n+            null !== chunk.reason &&\n+            chunk.reason.error(error);\n       });\n     }\n     function getChunk(response, id) {\n@@ -4746,58 +4751,41 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              continue;\n-            case \"blocked\":\n-            case \"pending\":\n-              path.splice(0, i - 1);\n-              null === value.value\n-                ? (value.value = [reference])\n-                : value.value.push(reference);\n-              null === value.reason\n-                ? (value.reason = [reference])\n-                : value.reason.push(reference);\n-              return;\n-            default:\n-              rejectReference(response, reference.handler, value.reason);\n-              return;\n-          }\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          var name = path[i];\n+          if (\n+            \"object\" !== typeof value ||\n+            null === value ||\n+            (getPrototypeOf(value) !== ObjectPrototype &&\n+              getPrototypeOf(value) !== ArrayPrototype) ||\n+            !hasOwnProperty.call(value, name)\n+          )\n+            throw Error(\"Invalid reference.\");\n+          value = value[name];\n         }\n-        var name = path[i];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n       }\n-      reference = map(response, value, parentObject, key);\n-      parentObject[key] = reference;\n-      \"\" === key && null === handler.value && (handler.value = reference);\n       handler.deps--;\n       0 === handler.deps &&\n-        ((parentObject = handler.chunk),\n-        null !== parentObject &&\n-          \"blocked\" === parentObject.status &&\n-          ((key = parentObject.value),\n-          (parentObject.status = \"fulfilled\"),\n-          (parentObject.value = handler.value),\n-          (parentObject.reason = handler.reason),\n-          null !== key && wakeChunk(response, key, handler.value)));\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value && wakeChunk(response, value, handler.value)));\n     }\n     function rejectReference(response, handler, error) {\n       handler.errored ||\n@@ -4809,33 +4797,6 @@\n           \"blocked\" === handler.status &&\n           triggerErrorOnChunk(response, handler, error));\n     }\n-    function waitForReference(\n-      referencedChunk,\n-      parentObject,\n-      key,\n-      response,\n-      map,\n-      path\n-    ) {\n-      initializingHandler\n-        ? ((response = initializingHandler), response.deps++)\n-        : (response = initializingHandler =\n-            { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-      parentObject = {\n-        handler: response,\n-        parentObject: parentObject,\n-        key: key,\n-        map: map,\n-        path: path\n-      };\n-      null === referencedChunk.value\n-        ? (referencedChunk.value = [parentObject])\n-        : referencedChunk.value.push(parentObject);\n-      null === referencedChunk.reason\n-        ? (referencedChunk.reason = [parentObject])\n-        : referencedChunk.reason.push(parentObject);\n-      return null;\n-    }\n     function getOutlinedModel(response, reference, parentObject, key, map) {\n       reference = reference.split(\":\");\n       var id = parseInt(reference[0], 16);\n@@ -4846,59 +4807,47 @@\n       }\n       switch (id.status) {\n         case \"fulfilled\":\n-          var value = id.value;\n-          for (id = 1; id < reference.length; id++) {\n-            for (; value instanceof ReactPromise; ) {\n-              switch (value.status) {\n-                case \"resolved_model\":\n-                  initializeModelChunk(value);\n-              }\n-              switch (value.status) {\n-                case \"fulfilled\":\n-                  value = value.value;\n-                  break;\n-                case \"blocked\":\n-                case \"pending\":\n-                  return waitForReference(\n-                    value,\n-                    parentObject,\n-                    key,\n-                    response,\n-                    map,\n-                    reference.slice(id - 1)\n-                  );\n-                default:\n-                  return (\n-                    initializingHandler\n-                      ? ((initializingHandler.errored = !0),\n-                        (initializingHandler.value = null),\n-                        (initializingHandler.reason = value.reason))\n-                      : (initializingHandler = {\n-                          chunk: null,\n-                          value: null,\n-                          reason: value.reason,\n-                          deps: 0,\n-                          errored: !0\n-                        }),\n-                    null\n-                  );\n-              }\n-            }\n-            var name = reference[id];\n-            \"object\" === typeof value &&\n-              hasOwnProperty.call(value, name) &&\n-              (value = value[name]);\n+          id = id.value;\n+          for (var i = 1; i < reference.length; i++) {\n+            var name = reference[i];\n+            if (\n+              \"object\" !== typeof id ||\n+              null === id ||\n+              (getPrototypeOf(id) !== ObjectPrototype &&\n+                getPrototypeOf(id) !== ArrayPrototype) ||\n+              !hasOwnProperty.call(id, name)\n+            )\n+              throw Error(\"Invalid reference.\");\n+            id = id[name];\n           }\n-          return map(response, value, parentObject, key);\n+          return map(response, id, parentObject, key);\n         case \"pending\":\n         case \"blocked\":\n-          return waitForReference(\n-            id,\n-            parentObject,\n-            key,\n-            response,\n-            map,\n-            reference\n+          return (\n+            initializingHandler\n+              ? ((response = initializingHandler), response.deps++)\n+              : (response = initializingHandler =\n+                  {\n+                    chunk: null,\n+                    value: null,\n+                    reason: null,\n+                    deps: 1,\n+                    errored: !1\n+                  }),\n+            (parentObject = {\n+              handler: response,\n+              parentObject: parentObject,\n+              key: key,\n+              map: map,\n+              path: reference\n+            }),\n+            null === id.value\n+              ? (id.value = [parentObject])\n+              : id.value.push(parentObject),\n+            null === id.reason\n+              ? (id.reason = [parentObject])\n+              : id.reason.push(parentObject),\n+            null\n           );\n         default:\n           return (\n@@ -4938,9 +4887,10 @@\n       parentKey\n     ) {\n       reference = parseInt(reference.slice(2), 16);\n-      reference = response._formData\n-        .get(response._prefix + reference)\n-        .arrayBuffer();\n+      bytesPerElement = response._prefix + reference;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized typed array.\");\n+      reference = response._formData.get(bytesPerElement).arrayBuffer();\n       if (initializingHandler) {\n         var handler = initializingHandler;\n         handler.deps++;\n@@ -4969,6 +4919,7 @@\n             var resolveListeners = buffer.value;\n             buffer.status = \"fulfilled\";\n             buffer.value = handler.value;\n+            buffer.reason = null;\n             null !== resolveListeners &&\n               wakeChunk(response, resolveListeners, handler.value);\n           }\n@@ -5003,7 +4954,10 @@\n     }\n     function parseReadableStream(response, reference, type) {\n       reference = parseInt(reference.slice(2), 16);\n-      var controller = null;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -5050,24 +5004,28 @@\n           }\n         },\n         close: function () {\n-          if (null === previousBlockedChunk) controller.close();\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.close();\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.close();\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.close();\n+              });\n+            }\n         },\n         error: function (error) {\n-          if (null === previousBlockedChunk) controller.error(error);\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.error(error);\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.error(error);\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.error(error);\n+              });\n+            }\n         }\n       });\n       return type;\n@@ -5082,6 +5040,8 @@\n     }\n     function parseAsyncIterable(response, reference, iterator) {\n       reference = parseInt(reference.slice(2), 16);\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n       var buffer = [],\n         closed = !1,\n         nextWriteIndex = 0,\n@@ -5122,36 +5082,46 @@\n           nextWriteIndex++;\n         },\n         close: function (value) {\n-          closed = !0;\n-          nextWriteIndex === buffer.length\n-            ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                response,\n-                value,\n-                !0\n-              ))\n-            : resolveIteratorResultChunk(\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length\n+                  ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                      response,\n+                      value,\n+                      !0\n+                    ))\n+                  : resolveIteratorResultChunk(\n+                      response,\n+                      buffer[nextWriteIndex],\n+                      value,\n+                      !0\n+                    ),\n+                nextWriteIndex++;\n+              nextWriteIndex < buffer.length;\n+\n+            )\n+              resolveIteratorResultChunk(\n                 response,\n-                buffer[nextWriteIndex],\n-                value,\n+                buffer[nextWriteIndex++],\n+                '\"$undefined\"',\n                 !0\n               );\n-          for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-            resolveIteratorResultChunk(\n-              response,\n-              buffer[nextWriteIndex++],\n-              '\"$undefined\"',\n-              !0\n-            );\n         },\n         error: function (error) {\n-          closed = !0;\n-          for (\n-            nextWriteIndex === buffer.length &&\n-            (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-            nextWriteIndex < buffer.length;\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length &&\n+                  (buffer[nextWriteIndex] = new ReactPromise(\n+                    \"pending\",\n+                    null,\n+                    null\n+                  ));\n+              nextWriteIndex < buffer.length;\n \n-          )\n-            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+            )\n+              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n         }\n       });\n       return iterator;\n@@ -5165,7 +5135,7 @@\n             return (\n               (obj = parseInt(value.slice(2), 16)), getChunk(response, obj)\n             );\n-          case \"F\":\n+          case \"h\":\n             return (\n               (value = value.slice(2)),\n               getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -5505,6 +5475,13 @@\n       SERVER_REFERENCE_TAG = Symbol.for(\"react.server.reference\"),\n       FunctionBind = Function.prototype.bind,\n       ArraySlice = Array.prototype.slice,\n+      serverReferenceToString = {\n+        value: function () {\n+          return \"function () { [omitted code] }\";\n+        },\n+        configurable: !0,\n+        writable: !0\n+      },\n       PROMISE_PROTOTYPE = Promise.prototype,\n       deepProxyHandlers = {\n         get: function (target, name) {\n@@ -6056,7 +6033,7 @@\n       patchConsole(console, \"table\"),\n       patchConsole(console, \"trace\"),\n       patchConsole(console, \"warn\"));\n-    var ObjectPrototype = Object.prototype,\n+    var ObjectPrototype$1 = Object.prototype,\n       stringify = JSON.stringify,\n       ABORTING = 12,\n       CLOSED = 14,\n@@ -6081,7 +6058,23 @@\n       }\n       switch (this.status) {\n         case \"fulfilled\":\n-          \"function\" === typeof resolve && resolve(this.value);\n+          if (\"function\" === typeof resolve) {\n+            for (\n+              var inspectedValue = this.value;\n+              inspectedValue instanceof ReactPromise;\n+\n+            ) {\n+              if (inspectedValue === this) {\n+                \"function\" === typeof reject &&\n+                  reject(Error(\"Cannot have cyclic thenables.\"));\n+                return;\n+              }\n+              if (\"fulfilled\" === inspectedValue.status)\n+                inspectedValue = inspectedValue.value;\n+              else break;\n+            }\n+            resolve(this.value);\n+          }\n           break;\n         case \"pending\":\n         case \"blocked\":\n@@ -6096,7 +6089,9 @@\n           \"function\" === typeof reject && reject(this.reason);\n       }\n     };\n-    var initializingHandler = null;\n+    var ObjectPrototype = Object.prototype,\n+      ArrayPrototype = Array.prototype,\n+      initializingHandler = null;\n     exports.createClientModuleProxy = function (moduleId) {\n       moduleId = registerClientReferenceImpl({}, moduleId, !1);\n       return new Proxy(moduleId, proxyHandlers$1);\n@@ -6224,13 +6219,13 @@\n           );\n         else {\n           pendingFiles++;\n-          var JSCompiler_object_inline_chunks_276 = [];\n+          var JSCompiler_object_inline_chunks_286 = [];\n           value.on(\"data\", function (chunk) {\n-            JSCompiler_object_inline_chunks_276.push(chunk);\n+            JSCompiler_object_inline_chunks_286.push(chunk);\n           });\n           value.on(\"end\", function () {\n             try {\n-              var blob = new Blob(JSCompiler_object_inline_chunks_276, {\n+              var blob = new Blob(JSCompiler_object_inline_chunks_286, {\n                 type: mimeType\n               });\n               response._formData.append(name, blob, filename);\n@@ -6364,7 +6359,8 @@\n         },\n         $$bound: { value: null, configurable: !0 },\n         $$location: { value: Error(\"react-stack-top-frame\"), configurable: !0 },\n-        bind: { value: bind, configurable: !0 }\n+        bind: { value: bind, configurable: !0 },\n+        toString: serverReferenceToString\n       });\n     };\n     exports.renderToPipeableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "f03a5d0b5a7bf3700e32e2d2b851ca90f20c9699",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/cjs/react-server-dom-turbopack-server.node.production.js",
            "status": "modified",
            "additions": 172,
            "deletions": 175,
            "changes": 347,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fcjs%2Freact-server-dom-turbopack-server.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -139,7 +139,14 @@ function bind() {\n   }\n   return newFn;\n }\n-var PROMISE_PROTOTYPE = Promise.prototype,\n+var serverReferenceToString = {\n+    value: function () {\n+      return \"function () { [omitted code] }\";\n+    },\n+    configurable: !0,\n+    writable: !0\n+  },\n+  PROMISE_PROTOTYPE = Promise.prototype,\n   deepProxyHandlers = {\n     get: function (target, name) {\n       switch (name) {\n@@ -837,7 +844,7 @@ function describeObjectForErrorMessage(objectOrArray, expandedName) {\n       : \"\\n  \" + str;\n }\n var hasOwnProperty = Object.prototype.hasOwnProperty,\n-  ObjectPrototype = Object.prototype,\n+  ObjectPrototype$1 = Object.prototype,\n   stringify = JSON.stringify;\n function defaultErrorHandler(error) {\n   console.error(error);\n@@ -1719,7 +1726,7 @@ function renderModelDestructive(\n     if (value instanceof Date) return \"$D\" + value.toJSON();\n     request = getPrototypeOf(value);\n     if (\n-      request !== ObjectPrototype &&\n+      request !== ObjectPrototype$1 &&\n       (null === request || null !== getPrototypeOf(request))\n     )\n       throw Error(\n@@ -1770,7 +1777,7 @@ function renderModelDestructive(\n         (task = request.writtenServerReferences),\n         (parentPropertyName = task.get(value)),\n         void 0 !== parentPropertyName\n-          ? (request = \"$F\" + parentPropertyName.toString(16))\n+          ? (request = \"$h\" + parentPropertyName.toString(16))\n           : ((parentPropertyName = value.$$bound),\n             (parentPropertyName =\n               null === parentPropertyName\n@@ -1782,7 +1789,7 @@ function renderModelDestructive(\n               0\n             )),\n             task.set(value, request),\n-            (request = \"$F\" + request.toString(16))),\n+            (request = \"$h\" + request.toString(16))),\n         request\n       );\n     if (\n@@ -2301,7 +2308,23 @@ ReactPromise.prototype.then = function (resolve, reject) {\n   }\n   switch (this.status) {\n     case \"fulfilled\":\n-      \"function\" === typeof resolve && resolve(this.value);\n+      if (\"function\" === typeof resolve) {\n+        for (\n+          var inspectedValue = this.value;\n+          inspectedValue instanceof ReactPromise;\n+\n+        ) {\n+          if (inspectedValue === this) {\n+            \"function\" === typeof reject &&\n+              reject(Error(\"Cannot have cyclic thenables.\"));\n+            return;\n+          }\n+          if (\"fulfilled\" === inspectedValue.status)\n+            inspectedValue = inspectedValue.value;\n+          else break;\n+        }\n+        resolve(this.value);\n+      }\n       break;\n     case \"pending\":\n     case \"blocked\":\n@@ -2314,6 +2337,8 @@ ReactPromise.prototype.then = function (resolve, reject) {\n       \"function\" === typeof reject && reject(this.reason);\n   }\n };\n+var ObjectPrototype = Object.prototype,\n+  ArrayPrototype = Array.prototype;\n function wakeChunk(response, listeners, value) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n@@ -2491,6 +2516,7 @@ function loadServerReference$1(response, metaData, parentObject, key) {\n           ((promiseValue = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n+          (resolvedValue.reason = null),\n           null !== promiseValue &&\n             wakeChunk(response, promiseValue, handler.value)));\n     },\n@@ -2582,6 +2608,7 @@ function initializeModelChunk(chunk) {\n     }\n     chunk.status = \"fulfilled\";\n     chunk.value = value;\n+    chunk.reason = null;\n   } catch (error) {\n     (chunk.status = \"rejected\"), (chunk.reason = error);\n   } finally {\n@@ -2592,7 +2619,11 @@ function reportGlobalError(response, error) {\n   response._closed = !0;\n   response._closedReason = error;\n   response._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status && triggerErrorOnChunk(response, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(response, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function getChunk(response, id) {\n@@ -2610,58 +2641,41 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n-    for (; value instanceof ReactPromise; ) {\n-      switch (value.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(value);\n-      }\n-      switch (value.status) {\n-        case \"fulfilled\":\n-          value = value.value;\n-          continue;\n-        case \"blocked\":\n-        case \"pending\":\n-          path.splice(0, i - 1);\n-          null === value.value\n-            ? (value.value = [reference])\n-            : value.value.push(reference);\n-          null === value.reason\n-            ? (value.reason = [reference])\n-            : value.reason.push(reference);\n-          return;\n-        default:\n-          rejectReference(response, reference.handler, value.reason);\n-          return;\n-      }\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      var name = path[i];\n+      if (\n+        \"object\" !== typeof value ||\n+        null === value ||\n+        (getPrototypeOf(value) !== ObjectPrototype &&\n+          getPrototypeOf(value) !== ArrayPrototype) ||\n+        !hasOwnProperty.call(value, name)\n+      )\n+        throw Error(\"Invalid reference.\");\n+      value = value[name];\n     }\n-    var name = path[i];\n-    \"object\" === typeof value &&\n-      hasOwnProperty.call(value, name) &&\n-      (value = value[name]);\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n   }\n-  reference = map(response, value, parentObject, key);\n-  parentObject[key] = reference;\n-  \"\" === key && null === handler.value && (handler.value = reference);\n   handler.deps--;\n   0 === handler.deps &&\n-    ((parentObject = handler.chunk),\n-    null !== parentObject &&\n-      \"blocked\" === parentObject.status &&\n-      ((key = parentObject.value),\n-      (parentObject.status = \"fulfilled\"),\n-      (parentObject.value = handler.value),\n-      (parentObject.reason = handler.reason),\n-      null !== key && wakeChunk(response, key, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -2673,33 +2687,6 @@ function rejectReference(response, handler, error) {\n       \"blocked\" === handler.status &&\n       triggerErrorOnChunk(response, handler, error));\n }\n-function waitForReference(\n-  referencedChunk,\n-  parentObject,\n-  key,\n-  response,\n-  map,\n-  path\n-) {\n-  initializingHandler\n-    ? ((response = initializingHandler), response.deps++)\n-    : (response = initializingHandler =\n-        { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-  parentObject = {\n-    handler: response,\n-    parentObject: parentObject,\n-    key: key,\n-    map: map,\n-    path: path\n-  };\n-  null === referencedChunk.value\n-    ? (referencedChunk.value = [parentObject])\n-    : referencedChunk.value.push(parentObject);\n-  null === referencedChunk.reason\n-    ? (referencedChunk.reason = [parentObject])\n-    : referencedChunk.reason.push(parentObject);\n-  return null;\n-}\n function getOutlinedModel(response, reference, parentObject, key, map) {\n   reference = reference.split(\":\");\n   var id = parseInt(reference[0], 16);\n@@ -2710,53 +2697,42 @@ function getOutlinedModel(response, reference, parentObject, key, map) {\n   }\n   switch (id.status) {\n     case \"fulfilled\":\n-      var value = id.value;\n-      for (id = 1; id < reference.length; id++) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              break;\n-            case \"blocked\":\n-            case \"pending\":\n-              return waitForReference(\n-                value,\n-                parentObject,\n-                key,\n-                response,\n-                map,\n-                reference.slice(id - 1)\n-              );\n-            default:\n-              return (\n-                initializingHandler\n-                  ? ((initializingHandler.errored = !0),\n-                    (initializingHandler.value = null),\n-                    (initializingHandler.reason = value.reason))\n-                  : (initializingHandler = {\n-                      chunk: null,\n-                      value: null,\n-                      reason: value.reason,\n-                      deps: 0,\n-                      errored: !0\n-                    }),\n-                null\n-              );\n-          }\n-        }\n-        var name = reference[id];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+      id = id.value;\n+      for (var i = 1; i < reference.length; i++) {\n+        var name = reference[i];\n+        if (\n+          \"object\" !== typeof id ||\n+          null === id ||\n+          (getPrototypeOf(id) !== ObjectPrototype &&\n+            getPrototypeOf(id) !== ArrayPrototype) ||\n+          !hasOwnProperty.call(id, name)\n+        )\n+          throw Error(\"Invalid reference.\");\n+        id = id[name];\n       }\n-      return map(response, value, parentObject, key);\n+      return map(response, id, parentObject, key);\n     case \"pending\":\n     case \"blocked\":\n-      return waitForReference(id, parentObject, key, response, map, reference);\n+      return (\n+        initializingHandler\n+          ? ((response = initializingHandler), response.deps++)\n+          : (response = initializingHandler =\n+              { chunk: null, value: null, reason: null, deps: 1, errored: !1 }),\n+        (parentObject = {\n+          handler: response,\n+          parentObject: parentObject,\n+          key: key,\n+          map: map,\n+          path: reference\n+        }),\n+        null === id.value\n+          ? (id.value = [parentObject])\n+          : id.value.push(parentObject),\n+        null === id.reason\n+          ? (id.reason = [parentObject])\n+          : id.reason.push(parentObject),\n+        null\n+      );\n     default:\n       return (\n         initializingHandler\n@@ -2795,9 +2771,10 @@ function parseTypedArray(\n   parentKey\n ) {\n   reference = parseInt(reference.slice(2), 16);\n-  reference = response._formData\n-    .get(response._prefix + reference)\n-    .arrayBuffer();\n+  bytesPerElement = response._prefix + reference;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized typed array.\");\n+  reference = response._formData.get(bytesPerElement).arrayBuffer();\n   if (initializingHandler) {\n     var handler = initializingHandler;\n     handler.deps++;\n@@ -2823,6 +2800,7 @@ function parseTypedArray(\n         var resolveListeners = buffer.value;\n         buffer.status = \"fulfilled\";\n         buffer.value = handler.value;\n+        buffer.reason = null;\n         null !== resolveListeners &&\n           wakeChunk(response, resolveListeners, handler.value);\n       }\n@@ -2855,7 +2833,10 @@ function resolveStream(response, id, stream, controller) {\n }\n function parseReadableStream(response, reference, type) {\n   reference = parseInt(reference.slice(2), 16);\n-  var controller = null;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -2898,24 +2879,27 @@ function parseReadableStream(response, reference, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n   return type;\n@@ -2930,6 +2914,8 @@ function createIterator(next) {\n }\n function parseAsyncIterable(response, reference, iterator) {\n   reference = parseInt(reference.slice(2), 16);\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n   var buffer = [],\n     closed = !1,\n     nextWriteIndex = 0,\n@@ -2973,36 +2959,46 @@ function parseAsyncIterable(response, reference, iterator) {\n       nextWriteIndex++;\n     },\n     close: function (value) {\n-      closed = !0;\n-      nextWriteIndex === buffer.length\n-        ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length\n+              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                  response,\n+                  value,\n+                  !0\n+                ))\n+              : resolveIteratorResultChunk(\n+                  response,\n+                  buffer[nextWriteIndex],\n+                  value,\n+                  !0\n+                ),\n+            nextWriteIndex++;\n+          nextWriteIndex < buffer.length;\n+\n+        )\n+          resolveIteratorResultChunk(\n             response,\n-            value,\n-            !0\n-          ))\n-        : resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex],\n-            value,\n+            buffer[nextWriteIndex++],\n+            '\"$undefined\"',\n             !0\n           );\n-      for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-        resolveIteratorResultChunk(\n-          response,\n-          buffer[nextWriteIndex++],\n-          '\"$undefined\"',\n-          !0\n-        );\n     },\n     error: function (error) {\n-      closed = !0;\n-      for (\n-        nextWriteIndex === buffer.length &&\n-        (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-        nextWriteIndex < buffer.length;\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length &&\n+              (buffer[nextWriteIndex] = new ReactPromise(\n+                \"pending\",\n+                null,\n+                null\n+              ));\n+          nextWriteIndex < buffer.length;\n \n-      )\n-        triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+        )\n+          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n     }\n   });\n   return iterator;\n@@ -3014,7 +3010,7 @@ function parseModelString(response, obj, key, value, reference) {\n         return value.slice(1);\n       case \"@\":\n         return (obj = parseInt(value.slice(2), 16)), getChunk(response, obj);\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -3325,13 +3321,13 @@ exports.decodeReplyFromBusboy = function (busboyStream, turbopackMap, options) {\n       );\n     else {\n       pendingFiles++;\n-      var JSCompiler_object_inline_chunks_281 = [];\n+      var JSCompiler_object_inline_chunks_291 = [];\n       value.on(\"data\", function (chunk) {\n-        JSCompiler_object_inline_chunks_281.push(chunk);\n+        JSCompiler_object_inline_chunks_291.push(chunk);\n       });\n       value.on(\"end\", function () {\n         try {\n-          var blob = new Blob(JSCompiler_object_inline_chunks_281, {\n+          var blob = new Blob(JSCompiler_object_inline_chunks_291, {\n             type: mimeType\n           });\n           response._formData.append(name, blob, filename);\n@@ -3458,7 +3454,8 @@ exports.registerServerReference = function (reference, id, exportName) {\n       configurable: !0\n     },\n     $$bound: { value: null, configurable: !0 },\n-    bind: { value: bind, configurable: !0 }\n+    bind: { value: bind, configurable: !0 },\n+    toString: serverReferenceToString\n   });\n };\n exports.renderToPipeableStream = function (model, turbopackMap, options) {"
        },
        {
            "sha": "c9c5a37a31c739d0e3302f57402fefc1c0fb55e1",
            "filename": "packages/next/src/compiled/react-server-dom-turbopack/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-turbopack%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -48,7 +48,7 @@\n     \"neo-async\": \"^2.6.1\"\n   },\n   \"peerDependencies\": {\n-    \"react\": \"19.3.0-canary-55480b4d-20251208\",\n-    \"react-dom\": \"19.3.0-canary-55480b4d-20251208\"\n+    \"react\": \"19.3.0-canary-80cb7a99-20251211\",\n+    \"react-dom\": \"19.3.0-canary-80cb7a99-20251211\"\n   }\n }\n\\ No newline at end of file"
        },
        {
            "sha": "5250f453dce7e56afcef278a200aaf8d6eb81df1",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-client.browser.development.js",
            "status": "modified",
            "additions": 182,
            "deletions": 148,
            "changes": 330,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -495,13 +495,23 @@\n                 pendingParts--;\n               }\n           }\n+          parentReference = writtenObjects.get(value);\n           if (\"function\" === typeof value.then) {\n+            if (void 0 !== parentReference)\n+              if (modelRoot === value) modelRoot = null;\n+              else return parentReference;\n             null === formData && (formData = new FormData());\n             pendingParts++;\n             var promiseId = nextPartId++;\n+            key = \"$@\" + promiseId.toString(16);\n+            writtenObjects.set(value, key);\n             value.then(function (partValue) {\n               try {\n-                var _partJSON3 = serializeModel(partValue, promiseId);\n+                var previousReference = writtenObjects.get(partValue);\n+                var _partJSON3 =\n+                  void 0 !== previousReference\n+                    ? JSON.stringify(previousReference)\n+                    : serializeModel(partValue, promiseId);\n                 partValue = formData;\n                 partValue.append(formFieldPrefix + promiseId, _partJSON3);\n                 pendingParts--;\n@@ -510,9 +520,8 @@\n                 reject(reason);\n               }\n             }, reject);\n-            return \"$@\" + promiseId.toString(16);\n+            return key;\n           }\n-          parentReference = writtenObjects.get(value);\n           if (void 0 !== parentReference)\n             if (modelRoot === value) modelRoot = null;\n             else return parentReference;\n@@ -670,7 +679,7 @@\n               null === formData && (formData = new FormData()),\n               (parentReference = nextPartId++),\n               formData.set(formFieldPrefix + parentReference, key),\n-              \"$F\" + parentReference.toString(16)\n+              \"$h\" + parentReference.toString(16)\n             );\n           if (\n             void 0 !== temporaryReferences &&\n@@ -1675,6 +1684,7 @@\n           rejectListeners = chunk.reason;\n         chunk.status = \"resolved_module\";\n         chunk.value = value;\n+        chunk.reason = null;\n         value = value[1];\n         for (var debugInfo = [], i = 0; i < value.length; ) {\n           var chunkId = value[i++];\n@@ -1862,8 +1872,11 @@\n         response._closed = !0;\n         response._closedReason = error;\n         response._chunks.forEach(function (chunk) {\n-          \"pending\" === chunk.status &&\n-            triggerErrorOnChunk(response, chunk, error);\n+          \"pending\" === chunk.status\n+            ? triggerErrorOnChunk(response, chunk, error)\n+            : \"fulfilled\" === chunk.status &&\n+              null !== chunk.reason &&\n+              chunk.reason.error(error);\n         });\n         weakResponse = response._debugChannel;\n         void 0 !== weakResponse &&\n@@ -1968,125 +1981,136 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value, fulfilledChunk) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          for (\n+            ;\n+            \"object\" === typeof value &&\n+            null !== value &&\n+            value.$$typeof === REACT_LAZY_TYPE;\n+\n+          ) {\n+            var referencedChunk = value._payload;\n+            if (referencedChunk === handler.chunk) value = handler.value;\n+            else {\n+              switch (referencedChunk.status) {\n+                case \"resolved_model\":\n+                  initializeModelChunk(referencedChunk);\n+                  break;\n+                case \"resolved_module\":\n+                  initializeModuleChunk(referencedChunk);\n+              }\n+              switch (referencedChunk.status) {\n+                case \"fulfilled\":\n+                  value = referencedChunk.value;\n+                  continue;\n+                case \"blocked\":\n+                  var cyclicHandler = resolveBlockedCycle(\n+                    referencedChunk,\n+                    reference\n+                  );\n+                  if (null !== cyclicHandler) {\n+                    value = cyclicHandler.value;\n+                    continue;\n+                  }\n+                case \"pending\":\n+                  path.splice(0, i - 1);\n+                  null === referencedChunk.value\n+                    ? (referencedChunk.value = [reference])\n+                    : referencedChunk.value.push(reference);\n+                  null === referencedChunk.reason\n+                    ? (referencedChunk.reason = [reference])\n+                    : referencedChunk.reason.push(reference);\n+                  return;\n+                case \"halted\":\n+                  return;\n+                default:\n+                  rejectReference(\n+                    response,\n+                    reference.handler,\n+                    referencedChunk.reason\n+                  );\n+                  return;\n+              }\n+            }\n+          }\n+          value = value[path[i]];\n+        }\n         for (\n           ;\n           \"object\" === typeof value &&\n           null !== value &&\n           value.$$typeof === REACT_LAZY_TYPE;\n \n-        )\n-          if (((value = value._payload), value === handler.chunk))\n-            value = handler.value;\n+        ) {\n+          var _referencedChunk = value._payload;\n+          if (_referencedChunk === handler.chunk) value = handler.value;\n           else {\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"resolved_model\":\n-                initializeModelChunk(value);\n+                initializeModelChunk(_referencedChunk);\n                 break;\n               case \"resolved_module\":\n-                initializeModuleChunk(value);\n+                initializeModuleChunk(_referencedChunk);\n             }\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"fulfilled\":\n-                value = value.value;\n+                value = _referencedChunk.value;\n                 continue;\n-              case \"blocked\":\n-                var cyclicHandler = resolveBlockedCycle(value, reference);\n-                if (null !== cyclicHandler) {\n-                  value = cyclicHandler.value;\n-                  continue;\n-                }\n-              case \"pending\":\n-                path.splice(0, i - 1);\n-                null === value.value\n-                  ? (value.value = [reference])\n-                  : value.value.push(reference);\n-                null === value.reason\n-                  ? (value.reason = [reference])\n-                  : value.reason.push(reference);\n-                return;\n-              case \"halted\":\n-                return;\n-              default:\n-                rejectReference(response, reference.handler, value.reason);\n-                return;\n             }\n+            break;\n           }\n-        value = value[path[i]];\n-      }\n-      for (\n-        ;\n-        \"object\" === typeof value &&\n-        null !== value &&\n-        value.$$typeof === REACT_LAZY_TYPE;\n-\n-      )\n-        if (((path = value._payload), path === handler.chunk))\n-          value = handler.value;\n-        else {\n-          switch (path.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(path);\n+        }\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+        if (\n+          parentObject[0] === REACT_ELEMENT_TYPE &&\n+          \"object\" === typeof handler.value &&\n+          null !== handler.value &&\n+          handler.value.$$typeof === REACT_ELEMENT_TYPE\n+        ) {\n+          var element = handler.value;\n+          switch (key) {\n+            case \"3\":\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+              element.props = mappedValue;\n               break;\n-            case \"resolved_module\":\n-              initializeModuleChunk(path);\n-          }\n-          switch (path.status) {\n-            case \"fulfilled\":\n-              value = path.value;\n-              continue;\n+            case \"4\":\n+              element._owner = mappedValue;\n+              break;\n+            case \"5\":\n+              element._debugStack = mappedValue;\n+              break;\n+            default:\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n           }\n-          break;\n-        }\n-      map = map(response, value, parentObject, key);\n-      parentObject[key] = map;\n-      \"\" === key && null === handler.value && (handler.value = map);\n-      if (\n-        parentObject[0] === REACT_ELEMENT_TYPE &&\n-        \"object\" === typeof handler.value &&\n-        null !== handler.value &&\n-        handler.value.$$typeof === REACT_ELEMENT_TYPE\n-      )\n-        switch (((reference = handler.value), key)) {\n-          case \"3\":\n-            transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-            reference.props = map;\n-            break;\n-          case \"4\":\n-            reference._owner = map;\n-            break;\n-          case \"5\":\n-            reference._debugStack = map;\n-            break;\n-          default:\n+        } else\n+          reference.isDebug ||\n             transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-        }\n-      else\n-        reference.isDebug ||\n-          transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n+      }\n       handler.deps--;\n       0 === handler.deps &&\n-        ((fulfilledChunk = handler.chunk),\n-        null !== fulfilledChunk &&\n-          \"blocked\" === fulfilledChunk.status &&\n-          ((key = fulfilledChunk.value),\n-          (fulfilledChunk.status = \"fulfilled\"),\n-          (fulfilledChunk.value = handler.value),\n-          (fulfilledChunk.reason = handler.reason),\n-          null !== key\n-            ? wakeChunk(response, key, handler.value, fulfilledChunk)\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value\n+            ? wakeChunk(response, value, handler.value, reference)\n             : ((handler = handler.value),\n-              filterDebugInfo(response, fulfilledChunk),\n-              moveDebugInfoFromChunkToInnerValue(fulfilledChunk, handler))));\n+              filterDebugInfo(response, reference),\n+              moveDebugInfoFromChunkToInnerValue(reference, handler))));\n     }\n     function rejectReference(response, handler, error) {\n       if (!handler.errored) {\n@@ -2232,6 +2256,7 @@\n               ((boundArgs = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== boundArgs\n                 ? wakeChunk(response, boundArgs, handler.value, resolvedValue)\n                 : ((boundArgs = handler.value),\n@@ -2557,7 +2582,7 @@\n             );\n           case \"S\":\n             return Symbol.for(value.slice(2));\n-          case \"F\":\n+          case \"h\":\n             var ref = value.slice(2);\n             return getOutlinedModel(\n               response,\n@@ -2935,7 +2960,8 @@\n           chunks.set(id, stream);\n     }\n     function startReadableStream(response, id, type, streamState) {\n-      var controller = null;\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -2990,24 +3016,28 @@\n             }\n           },\n           close: function () {\n-            if (null === previousBlockedChunk) controller.close();\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.close();\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.close();\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.close();\n+                });\n+              }\n           },\n           error: function (error) {\n-            if (null === previousBlockedChunk) controller.error(error);\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.error(error);\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.error(error);\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.error(error);\n+                });\n+              }\n           }\n         },\n         streamState\n@@ -3063,6 +3093,7 @@\n                 rejectListeners = chunk.reason;\n               chunk.status = \"fulfilled\";\n               chunk.value = { done: !1, value: value };\n+              chunk.reason = null;\n               null !== resolveListeners &&\n                 wakeChunkIfInitialized(\n                   response,\n@@ -3089,36 +3120,39 @@\n             nextWriteIndex++;\n           },\n           close: function (value) {\n-            closed = !0;\n-            nextWriteIndex === buffer.length\n-              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                  response,\n-                  value,\n-                  !0\n-                ))\n-              : resolveIteratorResultChunk(\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length\n+                    ? (buffer[nextWriteIndex] =\n+                        createResolvedIteratorResultChunk(response, value, !0))\n+                    : resolveIteratorResultChunk(\n+                        response,\n+                        buffer[nextWriteIndex],\n+                        value,\n+                        !0\n+                      ),\n+                  nextWriteIndex++;\n+                nextWriteIndex < buffer.length;\n+\n+              )\n+                resolveIteratorResultChunk(\n                   response,\n-                  buffer[nextWriteIndex],\n-                  value,\n+                  buffer[nextWriteIndex++],\n+                  '\"$undefined\"',\n                   !0\n                 );\n-            for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-              resolveIteratorResultChunk(\n-                response,\n-                buffer[nextWriteIndex++],\n-                '\"$undefined\"',\n-                !0\n-              );\n           },\n           error: function (error) {\n-            closed = !0;\n-            for (\n-              nextWriteIndex === buffer.length &&\n-              (buffer[nextWriteIndex] = createPendingChunk(response));\n-              nextWriteIndex < buffer.length;\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length &&\n+                    (buffer[nextWriteIndex] = createPendingChunk(response));\n+                nextWriteIndex < buffer.length;\n \n-            )\n-              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+              )\n+                triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n           }\n         },\n         streamState\n@@ -4982,10 +5016,10 @@\n       return hook.checkDCE ? !0 : !1;\n     })({\n       bundleType: 1,\n-      version: \"19.3.0-experimental-55480b4d-20251208\",\n+      version: \"19.3.0-experimental-80cb7a99-20251211\",\n       rendererPackageName: \"react-server-dom-webpack\",\n       currentDispatcherRef: ReactSharedInternals,\n-      reconcilerVersion: \"19.3.0-experimental-55480b4d-20251208\",\n+      reconcilerVersion: \"19.3.0-experimental-80cb7a99-20251211\",\n       getCurrentComponentInfo: function () {\n         return currentOwnerInDEV;\n       }"
        },
        {
            "sha": "4fe0afc4934c833877a6ea2419d4c3a4904f08b3",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-client.browser.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -303,13 +303,23 @@ function processReply(\n             pendingParts--;\n           }\n       }\n+      parentReference = writtenObjects.get(value);\n       if (\"function\" === typeof value.then) {\n+        if (void 0 !== parentReference)\n+          if (modelRoot === value) modelRoot = null;\n+          else return parentReference;\n         null === formData && (formData = new FormData());\n         pendingParts++;\n         var promiseId = nextPartId++;\n+        key = \"$@\" + promiseId.toString(16);\n+        writtenObjects.set(value, key);\n         value.then(function (partValue) {\n           try {\n-            var partJSON$27 = serializeModel(partValue, promiseId);\n+            var previousReference = writtenObjects.get(partValue);\n+            var partJSON$27 =\n+              void 0 !== previousReference\n+                ? JSON.stringify(previousReference)\n+                : serializeModel(partValue, promiseId);\n             partValue = formData;\n             partValue.append(formFieldPrefix + promiseId, partJSON$27);\n             pendingParts--;\n@@ -318,9 +328,8 @@ function processReply(\n             reject(reason);\n           }\n         }, reject);\n-        return \"$@\" + promiseId.toString(16);\n+        return key;\n       }\n-      parentReference = writtenObjects.get(value);\n       if (void 0 !== parentReference)\n         if (modelRoot === value) modelRoot = null;\n         else return parentReference;\n@@ -444,7 +453,7 @@ function processReply(\n           null === formData && (formData = new FormData()),\n           (parentReference = nextPartId++),\n           formData.set(formFieldPrefix + parentReference, key),\n-          \"$F\" + parentReference.toString(16)\n+          \"$h\" + parentReference.toString(16)\n         );\n       if (\n         void 0 !== temporaryReferences &&\n@@ -579,12 +588,12 @@ function readChunk(chunk) {\n       throw chunk.reason;\n   }\n }\n-function wakeChunk(response, listeners, value) {\n+function wakeChunk(response, listeners, value, chunk) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n     \"function\" === typeof listener\n       ? listener(value)\n-      : fulfillReference(response, listener, value);\n+      : fulfillReference(response, listener, value, chunk);\n   }\n }\n function rejectChunk(response, listeners, error) {\n@@ -624,7 +633,7 @@ function wakeChunkIfInitialized(\n ) {\n   switch (chunk.status) {\n     case \"fulfilled\":\n-      wakeChunk(response, resolveListeners, chunk.value);\n+      wakeChunk(response, resolveListeners, chunk.value, chunk);\n       break;\n     case \"blocked\":\n       for (var i = 0; i < resolveListeners.length; i++) {\n@@ -633,7 +642,7 @@ function wakeChunkIfInitialized(\n           var cyclicHandler = resolveBlockedCycle(chunk, listener);\n           if (null !== cyclicHandler)\n             switch (\n-              (fulfillReference(response, listener, cyclicHandler.value),\n+              (fulfillReference(response, listener, cyclicHandler.value, chunk),\n               resolveListeners.splice(i, 1),\n               i--,\n               null !== rejectListeners &&\n@@ -642,7 +651,7 @@ function wakeChunkIfInitialized(\n               chunk.status)\n             ) {\n               case \"fulfilled\":\n-                wakeChunk(response, resolveListeners, chunk.value);\n+                wakeChunk(response, resolveListeners, chunk.value, chunk);\n                 return;\n               case \"rejected\":\n                 null !== rejectListeners &&\n@@ -718,6 +727,7 @@ function resolveModuleChunk(response, chunk, value) {\n       rejectListeners = chunk.reason;\n     chunk.status = \"resolved_module\";\n     chunk.value = value;\n+    chunk.reason = null;\n     null !== resolveListeners &&\n       (initializeModuleChunk(chunk),\n       wakeChunkIfInitialized(\n@@ -780,8 +790,11 @@ function reportGlobalError(weakResponse, error) {\n   weakResponse._closed = !0;\n   weakResponse._closedReason = error;\n   weakResponse._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status &&\n-      triggerErrorOnChunk(weakResponse, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(weakResponse, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function createLazyChunkWrapper(chunk) {\n@@ -798,109 +811,120 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      for (\n+        ;\n+        \"object\" === typeof value &&\n+        null !== value &&\n+        value.$$typeof === REACT_LAZY_TYPE;\n+\n+      ) {\n+        var referencedChunk = value._payload;\n+        if (referencedChunk === handler.chunk) value = handler.value;\n+        else {\n+          switch (referencedChunk.status) {\n+            case \"resolved_model\":\n+              initializeModelChunk(referencedChunk);\n+              break;\n+            case \"resolved_module\":\n+              initializeModuleChunk(referencedChunk);\n+          }\n+          switch (referencedChunk.status) {\n+            case \"fulfilled\":\n+              value = referencedChunk.value;\n+              continue;\n+            case \"blocked\":\n+              var cyclicHandler = resolveBlockedCycle(\n+                referencedChunk,\n+                reference\n+              );\n+              if (null !== cyclicHandler) {\n+                value = cyclicHandler.value;\n+                continue;\n+              }\n+            case \"pending\":\n+              path.splice(0, i - 1);\n+              null === referencedChunk.value\n+                ? (referencedChunk.value = [reference])\n+                : referencedChunk.value.push(reference);\n+              null === referencedChunk.reason\n+                ? (referencedChunk.reason = [reference])\n+                : referencedChunk.reason.push(reference);\n+              return;\n+            case \"halted\":\n+              return;\n+            default:\n+              rejectReference(\n+                response,\n+                reference.handler,\n+                referencedChunk.reason\n+              );\n+              return;\n+          }\n+        }\n+      }\n+      value = value[path[i]];\n+    }\n     for (\n       ;\n       \"object\" === typeof value &&\n       null !== value &&\n       value.$$typeof === REACT_LAZY_TYPE;\n \n-    )\n-      if (((value = value._payload), value === handler.chunk))\n-        value = handler.value;\n+    ) {\n+      var referencedChunk$43 = value._payload;\n+      if (referencedChunk$43 === handler.chunk) value = handler.value;\n       else {\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"resolved_model\":\n-            initializeModelChunk(value);\n+            initializeModelChunk(referencedChunk$43);\n             break;\n           case \"resolved_module\":\n-            initializeModuleChunk(value);\n+            initializeModuleChunk(referencedChunk$43);\n         }\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"fulfilled\":\n-            value = value.value;\n+            value = referencedChunk$43.value;\n             continue;\n-          case \"blocked\":\n-            var cyclicHandler = resolveBlockedCycle(value, reference);\n-            if (null !== cyclicHandler) {\n-              value = cyclicHandler.value;\n-              continue;\n-            }\n-          case \"pending\":\n-            path.splice(0, i - 1);\n-            null === value.value\n-              ? (value.value = [reference])\n-              : value.value.push(reference);\n-            null === value.reason\n-              ? (value.reason = [reference])\n-              : value.reason.push(reference);\n-            return;\n-          case \"halted\":\n-            return;\n-          default:\n-            rejectReference(response, reference.handler, value.reason);\n-            return;\n         }\n+        break;\n       }\n-    value = value[path[i]];\n-  }\n-  for (\n-    ;\n-    \"object\" === typeof value &&\n-    null !== value &&\n-    value.$$typeof === REACT_LAZY_TYPE;\n-\n-  )\n-    if (((reference = value._payload), reference === handler.chunk))\n-      value = handler.value;\n-    else {\n-      switch (reference.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(reference);\n-          break;\n-        case \"resolved_module\":\n-          initializeModuleChunk(reference);\n-      }\n-      switch (reference.status) {\n-        case \"fulfilled\":\n-          value = reference.value;\n-          continue;\n-      }\n-      break;\n     }\n-  map = map(response, value, parentObject, key);\n-  parentObject[key] = map;\n-  \"\" === key && null === handler.value && (handler.value = map);\n-  if (\n-    parentObject[0] === REACT_ELEMENT_TYPE &&\n-    \"object\" === typeof handler.value &&\n-    null !== handler.value &&\n-    handler.value.$$typeof === REACT_ELEMENT_TYPE\n-  )\n-    switch (((parentObject = handler.value), key)) {\n-      case \"3\":\n-        parentObject.props = map;\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+    if (\n+      parentObject[0] === REACT_ELEMENT_TYPE &&\n+      \"object\" === typeof handler.value &&\n+      null !== handler.value &&\n+      handler.value.$$typeof === REACT_ELEMENT_TYPE\n+    ) {\n+      var element = handler.value;\n+      switch (key) {\n+        case \"3\":\n+          element.props = mappedValue;\n+      }\n     }\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n+  }\n   handler.deps--;\n   0 === handler.deps &&\n-    ((key = handler.chunk),\n-    null !== key &&\n-      \"blocked\" === key.status &&\n-      ((parentObject = key.value),\n-      (key.status = \"fulfilled\"),\n-      (key.value = handler.value),\n-      (key.reason = handler.reason),\n-      null !== parentObject &&\n-        wakeChunk(response, parentObject, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value, reference)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -1004,7 +1028,9 @@ function loadServerReference(response, metaData, parentObject, key) {\n           ((boundArgs = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n-          null !== boundArgs && wakeChunk(response, boundArgs, handler.value)));\n+          (resolvedValue.reason = null),\n+          null !== boundArgs &&\n+            wakeChunk(response, boundArgs, handler.value, resolvedValue)));\n     },\n     function (error) {\n       if (!handler.errored) {\n@@ -1209,7 +1235,7 @@ function parseModelString(response, parentObject, key, value) {\n         );\n       case \"S\":\n         return Symbol.for(value.slice(2));\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(\n@@ -1348,12 +1374,13 @@ function resolveStream(response, id, stream, controller) {\n       (chunk.status = \"fulfilled\"),\n       (chunk.value = stream),\n       (chunk.reason = controller),\n-      null !== id && wakeChunk(response, id, chunk.value))\n+      null !== id && wakeChunk(response, id, chunk.value, chunk))\n     : ((response = new ReactPromise(\"fulfilled\", stream, controller)),\n       chunks.set(id, response));\n }\n function startReadableStream(response, id, type) {\n-  var controller = null;\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -1403,24 +1430,27 @@ function startReadableStream(response, id, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n }\n@@ -1474,6 +1504,7 @@ function startAsyncIterable(response, id, iterator) {\n             rejectListeners = chunk.reason;\n           chunk.status = \"fulfilled\";\n           chunk.value = { done: !1, value: value };\n+          chunk.reason = null;\n           null !== resolveListeners &&\n             wakeChunkIfInitialized(\n               response,\n@@ -1500,36 +1531,46 @@ function startAsyncIterable(response, id, iterator) {\n         nextWriteIndex++;\n       },\n       close: function (value) {\n-        closed = !0;\n-        nextWriteIndex === buffer.length\n-          ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-              response,\n-              value,\n-              !0\n-            ))\n-          : resolveIteratorResultChunk(\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length\n+                ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                    response,\n+                    value,\n+                    !0\n+                  ))\n+                : resolveIteratorResultChunk(\n+                    response,\n+                    buffer[nextWriteIndex],\n+                    value,\n+                    !0\n+                  ),\n+              nextWriteIndex++;\n+            nextWriteIndex < buffer.length;\n+\n+          )\n+            resolveIteratorResultChunk(\n               response,\n-              buffer[nextWriteIndex],\n-              value,\n+              buffer[nextWriteIndex++],\n+              '\"$undefined\"',\n               !0\n             );\n-        for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-          resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex++],\n-            '\"$undefined\"',\n-            !0\n-          );\n       },\n       error: function (error) {\n-        closed = !0;\n-        for (\n-          nextWriteIndex === buffer.length &&\n-          (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-          nextWriteIndex < buffer.length;\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length &&\n+                (buffer[nextWriteIndex] = new ReactPromise(\n+                  \"pending\",\n+                  null,\n+                  null\n+                ));\n+            nextWriteIndex < buffer.length;\n \n-        )\n-          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+          )\n+            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n       }\n     }\n   );"
        },
        {
            "sha": "f16b2625fbc7294a8dd720ef6289438f2133a1a8",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-client.edge.development.js",
            "status": "modified",
            "additions": 180,
            "deletions": 146,
            "changes": 326,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -516,13 +516,23 @@\n                 pendingParts--;\n               }\n           }\n+          parentReference = writtenObjects.get(value);\n           if (\"function\" === typeof value.then) {\n+            if (void 0 !== parentReference)\n+              if (modelRoot === value) modelRoot = null;\n+              else return parentReference;\n             null === formData && (formData = new FormData());\n             pendingParts++;\n             var promiseId = nextPartId++;\n+            key = \"$@\" + promiseId.toString(16);\n+            writtenObjects.set(value, key);\n             value.then(function (partValue) {\n               try {\n-                var _partJSON3 = serializeModel(partValue, promiseId);\n+                var previousReference = writtenObjects.get(partValue);\n+                var _partJSON3 =\n+                  void 0 !== previousReference\n+                    ? JSON.stringify(previousReference)\n+                    : serializeModel(partValue, promiseId);\n                 partValue = formData;\n                 partValue.append(formFieldPrefix + promiseId, _partJSON3);\n                 pendingParts--;\n@@ -531,9 +541,8 @@\n                 reject(reason);\n               }\n             }, reject);\n-            return \"$@\" + promiseId.toString(16);\n+            return key;\n           }\n-          parentReference = writtenObjects.get(value);\n           if (void 0 !== parentReference)\n             if (modelRoot === value) modelRoot = null;\n             else return parentReference;\n@@ -691,7 +700,7 @@\n               null === formData && (formData = new FormData()),\n               (parentReference = nextPartId++),\n               formData.set(formFieldPrefix + parentReference, key),\n-              \"$F\" + parentReference.toString(16)\n+              \"$h\" + parentReference.toString(16)\n             );\n           if (\n             void 0 !== temporaryReferences &&\n@@ -1883,6 +1892,7 @@\n           rejectListeners = chunk.reason;\n         chunk.status = \"resolved_module\";\n         chunk.value = value;\n+        chunk.reason = null;\n         value = [];\n         null !== value && chunk._debugInfo.push.apply(chunk._debugInfo, value);\n         null !== resolveListeners &&\n@@ -2012,8 +2022,11 @@\n         response._closed = !0;\n         response._closedReason = error;\n         response._chunks.forEach(function (chunk) {\n-          \"pending\" === chunk.status &&\n-            triggerErrorOnChunk(response, chunk, error);\n+          \"pending\" === chunk.status\n+            ? triggerErrorOnChunk(response, chunk, error)\n+            : \"fulfilled\" === chunk.status &&\n+              null !== chunk.reason &&\n+              chunk.reason.error(error);\n         });\n         weakResponse = response._debugChannel;\n         void 0 !== weakResponse &&\n@@ -2118,125 +2131,136 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value, fulfilledChunk) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          for (\n+            ;\n+            \"object\" === typeof value &&\n+            null !== value &&\n+            value.$$typeof === REACT_LAZY_TYPE;\n+\n+          ) {\n+            var referencedChunk = value._payload;\n+            if (referencedChunk === handler.chunk) value = handler.value;\n+            else {\n+              switch (referencedChunk.status) {\n+                case \"resolved_model\":\n+                  initializeModelChunk(referencedChunk);\n+                  break;\n+                case \"resolved_module\":\n+                  initializeModuleChunk(referencedChunk);\n+              }\n+              switch (referencedChunk.status) {\n+                case \"fulfilled\":\n+                  value = referencedChunk.value;\n+                  continue;\n+                case \"blocked\":\n+                  var cyclicHandler = resolveBlockedCycle(\n+                    referencedChunk,\n+                    reference\n+                  );\n+                  if (null !== cyclicHandler) {\n+                    value = cyclicHandler.value;\n+                    continue;\n+                  }\n+                case \"pending\":\n+                  path.splice(0, i - 1);\n+                  null === referencedChunk.value\n+                    ? (referencedChunk.value = [reference])\n+                    : referencedChunk.value.push(reference);\n+                  null === referencedChunk.reason\n+                    ? (referencedChunk.reason = [reference])\n+                    : referencedChunk.reason.push(reference);\n+                  return;\n+                case \"halted\":\n+                  return;\n+                default:\n+                  rejectReference(\n+                    response,\n+                    reference.handler,\n+                    referencedChunk.reason\n+                  );\n+                  return;\n+              }\n+            }\n+          }\n+          value = value[path[i]];\n+        }\n         for (\n           ;\n           \"object\" === typeof value &&\n           null !== value &&\n           value.$$typeof === REACT_LAZY_TYPE;\n \n-        )\n-          if (((value = value._payload), value === handler.chunk))\n-            value = handler.value;\n+        ) {\n+          var _referencedChunk = value._payload;\n+          if (_referencedChunk === handler.chunk) value = handler.value;\n           else {\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"resolved_model\":\n-                initializeModelChunk(value);\n+                initializeModelChunk(_referencedChunk);\n                 break;\n               case \"resolved_module\":\n-                initializeModuleChunk(value);\n+                initializeModuleChunk(_referencedChunk);\n             }\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"fulfilled\":\n-                value = value.value;\n+                value = _referencedChunk.value;\n                 continue;\n-              case \"blocked\":\n-                var cyclicHandler = resolveBlockedCycle(value, reference);\n-                if (null !== cyclicHandler) {\n-                  value = cyclicHandler.value;\n-                  continue;\n-                }\n-              case \"pending\":\n-                path.splice(0, i - 1);\n-                null === value.value\n-                  ? (value.value = [reference])\n-                  : value.value.push(reference);\n-                null === value.reason\n-                  ? (value.reason = [reference])\n-                  : value.reason.push(reference);\n-                return;\n-              case \"halted\":\n-                return;\n-              default:\n-                rejectReference(response, reference.handler, value.reason);\n-                return;\n             }\n+            break;\n           }\n-        value = value[path[i]];\n-      }\n-      for (\n-        ;\n-        \"object\" === typeof value &&\n-        null !== value &&\n-        value.$$typeof === REACT_LAZY_TYPE;\n-\n-      )\n-        if (((path = value._payload), path === handler.chunk))\n-          value = handler.value;\n-        else {\n-          switch (path.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(path);\n+        }\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+        if (\n+          parentObject[0] === REACT_ELEMENT_TYPE &&\n+          \"object\" === typeof handler.value &&\n+          null !== handler.value &&\n+          handler.value.$$typeof === REACT_ELEMENT_TYPE\n+        ) {\n+          var element = handler.value;\n+          switch (key) {\n+            case \"3\":\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+              element.props = mappedValue;\n               break;\n-            case \"resolved_module\":\n-              initializeModuleChunk(path);\n-          }\n-          switch (path.status) {\n-            case \"fulfilled\":\n-              value = path.value;\n-              continue;\n+            case \"4\":\n+              element._owner = mappedValue;\n+              break;\n+            case \"5\":\n+              element._debugStack = mappedValue;\n+              break;\n+            default:\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n           }\n-          break;\n-        }\n-      map = map(response, value, parentObject, key);\n-      parentObject[key] = map;\n-      \"\" === key && null === handler.value && (handler.value = map);\n-      if (\n-        parentObject[0] === REACT_ELEMENT_TYPE &&\n-        \"object\" === typeof handler.value &&\n-        null !== handler.value &&\n-        handler.value.$$typeof === REACT_ELEMENT_TYPE\n-      )\n-        switch (((reference = handler.value), key)) {\n-          case \"3\":\n-            transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-            reference.props = map;\n-            break;\n-          case \"4\":\n-            reference._owner = map;\n-            break;\n-          case \"5\":\n-            reference._debugStack = map;\n-            break;\n-          default:\n+        } else\n+          reference.isDebug ||\n             transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-        }\n-      else\n-        reference.isDebug ||\n-          transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n+      }\n       handler.deps--;\n       0 === handler.deps &&\n-        ((fulfilledChunk = handler.chunk),\n-        null !== fulfilledChunk &&\n-          \"blocked\" === fulfilledChunk.status &&\n-          ((key = fulfilledChunk.value),\n-          (fulfilledChunk.status = \"fulfilled\"),\n-          (fulfilledChunk.value = handler.value),\n-          (fulfilledChunk.reason = handler.reason),\n-          null !== key\n-            ? wakeChunk(response, key, handler.value, fulfilledChunk)\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value\n+            ? wakeChunk(response, value, handler.value, reference)\n             : ((handler = handler.value),\n-              filterDebugInfo(response, fulfilledChunk),\n-              moveDebugInfoFromChunkToInnerValue(fulfilledChunk, handler))));\n+              filterDebugInfo(response, reference),\n+              moveDebugInfoFromChunkToInnerValue(reference, handler))));\n     }\n     function rejectReference(response, handler, error) {\n       if (!handler.errored) {\n@@ -2388,6 +2412,7 @@\n               ((boundArgs = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== boundArgs\n                 ? wakeChunk(response, boundArgs, handler.value, resolvedValue)\n                 : ((boundArgs = handler.value),\n@@ -2713,7 +2738,7 @@\n             );\n           case \"S\":\n             return Symbol.for(value.slice(2));\n-          case \"F\":\n+          case \"h\":\n             var ref = value.slice(2);\n             return getOutlinedModel(\n               response,\n@@ -3076,7 +3101,8 @@\n           chunks.set(id, stream);\n     }\n     function startReadableStream(response, id, type, streamState) {\n-      var controller = null;\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -3131,24 +3157,28 @@\n             }\n           },\n           close: function () {\n-            if (null === previousBlockedChunk) controller.close();\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.close();\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.close();\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.close();\n+                });\n+              }\n           },\n           error: function (error) {\n-            if (null === previousBlockedChunk) controller.error(error);\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.error(error);\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.error(error);\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.error(error);\n+                });\n+              }\n           }\n         },\n         streamState\n@@ -3204,6 +3234,7 @@\n                 rejectListeners = chunk.reason;\n               chunk.status = \"fulfilled\";\n               chunk.value = { done: !1, value: value };\n+              chunk.reason = null;\n               null !== resolveListeners &&\n                 wakeChunkIfInitialized(\n                   response,\n@@ -3230,36 +3261,39 @@\n             nextWriteIndex++;\n           },\n           close: function (value) {\n-            closed = !0;\n-            nextWriteIndex === buffer.length\n-              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                  response,\n-                  value,\n-                  !0\n-                ))\n-              : resolveIteratorResultChunk(\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length\n+                    ? (buffer[nextWriteIndex] =\n+                        createResolvedIteratorResultChunk(response, value, !0))\n+                    : resolveIteratorResultChunk(\n+                        response,\n+                        buffer[nextWriteIndex],\n+                        value,\n+                        !0\n+                      ),\n+                  nextWriteIndex++;\n+                nextWriteIndex < buffer.length;\n+\n+              )\n+                resolveIteratorResultChunk(\n                   response,\n-                  buffer[nextWriteIndex],\n-                  value,\n+                  buffer[nextWriteIndex++],\n+                  '\"$undefined\"',\n                   !0\n                 );\n-            for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-              resolveIteratorResultChunk(\n-                response,\n-                buffer[nextWriteIndex++],\n-                '\"$undefined\"',\n-                !0\n-              );\n           },\n           error: function (error) {\n-            closed = !0;\n-            for (\n-              nextWriteIndex === buffer.length &&\n-              (buffer[nextWriteIndex] = createPendingChunk(response));\n-              nextWriteIndex < buffer.length;\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length &&\n+                    (buffer[nextWriteIndex] = createPendingChunk(response));\n+                nextWriteIndex < buffer.length;\n \n-            )\n-              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+              )\n+                triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n           }\n         },\n         streamState"
        },
        {
            "sha": "1fed366e75cc04b85dad9d43f90ffdcbe526e2be",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-client.edge.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -315,13 +315,23 @@ function processReply(\n             pendingParts--;\n           }\n       }\n+      parentReference = writtenObjects.get(value);\n       if (\"function\" === typeof value.then) {\n+        if (void 0 !== parentReference)\n+          if (modelRoot === value) modelRoot = null;\n+          else return parentReference;\n         null === formData && (formData = new FormData());\n         pendingParts++;\n         var promiseId = nextPartId++;\n+        key = \"$@\" + promiseId.toString(16);\n+        writtenObjects.set(value, key);\n         value.then(function (partValue) {\n           try {\n-            var partJSON$27 = serializeModel(partValue, promiseId);\n+            var previousReference = writtenObjects.get(partValue);\n+            var partJSON$27 =\n+              void 0 !== previousReference\n+                ? JSON.stringify(previousReference)\n+                : serializeModel(partValue, promiseId);\n             partValue = formData;\n             partValue.append(formFieldPrefix + promiseId, partJSON$27);\n             pendingParts--;\n@@ -330,9 +340,8 @@ function processReply(\n             reject(reason);\n           }\n         }, reject);\n-        return \"$@\" + promiseId.toString(16);\n+        return key;\n       }\n-      parentReference = writtenObjects.get(value);\n       if (void 0 !== parentReference)\n         if (modelRoot === value) modelRoot = null;\n         else return parentReference;\n@@ -456,7 +465,7 @@ function processReply(\n           null === formData && (formData = new FormData()),\n           (parentReference = nextPartId++),\n           formData.set(formFieldPrefix + parentReference, key),\n-          \"$F\" + parentReference.toString(16)\n+          \"$h\" + parentReference.toString(16)\n         );\n       if (\n         void 0 !== temporaryReferences &&\n@@ -740,12 +749,12 @@ function readChunk(chunk) {\n       throw chunk.reason;\n   }\n }\n-function wakeChunk(response, listeners, value) {\n+function wakeChunk(response, listeners, value, chunk) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n     \"function\" === typeof listener\n       ? listener(value)\n-      : fulfillReference(response, listener, value);\n+      : fulfillReference(response, listener, value, chunk);\n   }\n }\n function rejectChunk(response, listeners, error) {\n@@ -785,7 +794,7 @@ function wakeChunkIfInitialized(\n ) {\n   switch (chunk.status) {\n     case \"fulfilled\":\n-      wakeChunk(response, resolveListeners, chunk.value);\n+      wakeChunk(response, resolveListeners, chunk.value, chunk);\n       break;\n     case \"blocked\":\n       for (var i = 0; i < resolveListeners.length; i++) {\n@@ -794,7 +803,7 @@ function wakeChunkIfInitialized(\n           var cyclicHandler = resolveBlockedCycle(chunk, listener);\n           if (null !== cyclicHandler)\n             switch (\n-              (fulfillReference(response, listener, cyclicHandler.value),\n+              (fulfillReference(response, listener, cyclicHandler.value, chunk),\n               resolveListeners.splice(i, 1),\n               i--,\n               null !== rejectListeners &&\n@@ -803,7 +812,7 @@ function wakeChunkIfInitialized(\n               chunk.status)\n             ) {\n               case \"fulfilled\":\n-                wakeChunk(response, resolveListeners, chunk.value);\n+                wakeChunk(response, resolveListeners, chunk.value, chunk);\n                 return;\n               case \"rejected\":\n                 null !== rejectListeners &&\n@@ -879,6 +888,7 @@ function resolveModuleChunk(response, chunk, value) {\n       rejectListeners = chunk.reason;\n     chunk.status = \"resolved_module\";\n     chunk.value = value;\n+    chunk.reason = null;\n     null !== resolveListeners &&\n       (initializeModuleChunk(chunk),\n       wakeChunkIfInitialized(\n@@ -941,8 +951,11 @@ function reportGlobalError(weakResponse, error) {\n   weakResponse._closed = !0;\n   weakResponse._closedReason = error;\n   weakResponse._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status &&\n-      triggerErrorOnChunk(weakResponse, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(weakResponse, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function createLazyChunkWrapper(chunk) {\n@@ -959,109 +972,120 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      for (\n+        ;\n+        \"object\" === typeof value &&\n+        null !== value &&\n+        value.$$typeof === REACT_LAZY_TYPE;\n+\n+      ) {\n+        var referencedChunk = value._payload;\n+        if (referencedChunk === handler.chunk) value = handler.value;\n+        else {\n+          switch (referencedChunk.status) {\n+            case \"resolved_model\":\n+              initializeModelChunk(referencedChunk);\n+              break;\n+            case \"resolved_module\":\n+              initializeModuleChunk(referencedChunk);\n+          }\n+          switch (referencedChunk.status) {\n+            case \"fulfilled\":\n+              value = referencedChunk.value;\n+              continue;\n+            case \"blocked\":\n+              var cyclicHandler = resolveBlockedCycle(\n+                referencedChunk,\n+                reference\n+              );\n+              if (null !== cyclicHandler) {\n+                value = cyclicHandler.value;\n+                continue;\n+              }\n+            case \"pending\":\n+              path.splice(0, i - 1);\n+              null === referencedChunk.value\n+                ? (referencedChunk.value = [reference])\n+                : referencedChunk.value.push(reference);\n+              null === referencedChunk.reason\n+                ? (referencedChunk.reason = [reference])\n+                : referencedChunk.reason.push(reference);\n+              return;\n+            case \"halted\":\n+              return;\n+            default:\n+              rejectReference(\n+                response,\n+                reference.handler,\n+                referencedChunk.reason\n+              );\n+              return;\n+          }\n+        }\n+      }\n+      value = value[path[i]];\n+    }\n     for (\n       ;\n       \"object\" === typeof value &&\n       null !== value &&\n       value.$$typeof === REACT_LAZY_TYPE;\n \n-    )\n-      if (((value = value._payload), value === handler.chunk))\n-        value = handler.value;\n+    ) {\n+      var referencedChunk$43 = value._payload;\n+      if (referencedChunk$43 === handler.chunk) value = handler.value;\n       else {\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"resolved_model\":\n-            initializeModelChunk(value);\n+            initializeModelChunk(referencedChunk$43);\n             break;\n           case \"resolved_module\":\n-            initializeModuleChunk(value);\n+            initializeModuleChunk(referencedChunk$43);\n         }\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"fulfilled\":\n-            value = value.value;\n+            value = referencedChunk$43.value;\n             continue;\n-          case \"blocked\":\n-            var cyclicHandler = resolveBlockedCycle(value, reference);\n-            if (null !== cyclicHandler) {\n-              value = cyclicHandler.value;\n-              continue;\n-            }\n-          case \"pending\":\n-            path.splice(0, i - 1);\n-            null === value.value\n-              ? (value.value = [reference])\n-              : value.value.push(reference);\n-            null === value.reason\n-              ? (value.reason = [reference])\n-              : value.reason.push(reference);\n-            return;\n-          case \"halted\":\n-            return;\n-          default:\n-            rejectReference(response, reference.handler, value.reason);\n-            return;\n         }\n+        break;\n       }\n-    value = value[path[i]];\n-  }\n-  for (\n-    ;\n-    \"object\" === typeof value &&\n-    null !== value &&\n-    value.$$typeof === REACT_LAZY_TYPE;\n-\n-  )\n-    if (((reference = value._payload), reference === handler.chunk))\n-      value = handler.value;\n-    else {\n-      switch (reference.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(reference);\n-          break;\n-        case \"resolved_module\":\n-          initializeModuleChunk(reference);\n-      }\n-      switch (reference.status) {\n-        case \"fulfilled\":\n-          value = reference.value;\n-          continue;\n-      }\n-      break;\n     }\n-  map = map(response, value, parentObject, key);\n-  parentObject[key] = map;\n-  \"\" === key && null === handler.value && (handler.value = map);\n-  if (\n-    parentObject[0] === REACT_ELEMENT_TYPE &&\n-    \"object\" === typeof handler.value &&\n-    null !== handler.value &&\n-    handler.value.$$typeof === REACT_ELEMENT_TYPE\n-  )\n-    switch (((parentObject = handler.value), key)) {\n-      case \"3\":\n-        parentObject.props = map;\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+    if (\n+      parentObject[0] === REACT_ELEMENT_TYPE &&\n+      \"object\" === typeof handler.value &&\n+      null !== handler.value &&\n+      handler.value.$$typeof === REACT_ELEMENT_TYPE\n+    ) {\n+      var element = handler.value;\n+      switch (key) {\n+        case \"3\":\n+          element.props = mappedValue;\n+      }\n     }\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n+  }\n   handler.deps--;\n   0 === handler.deps &&\n-    ((key = handler.chunk),\n-    null !== key &&\n-      \"blocked\" === key.status &&\n-      ((parentObject = key.value),\n-      (key.status = \"fulfilled\"),\n-      (key.value = handler.value),\n-      (key.reason = handler.reason),\n-      null !== parentObject &&\n-        wakeChunk(response, parentObject, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value, reference)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -1179,7 +1203,9 @@ function loadServerReference(response, metaData, parentObject, key) {\n           ((boundArgs = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n-          null !== boundArgs && wakeChunk(response, boundArgs, handler.value)));\n+          (resolvedValue.reason = null),\n+          null !== boundArgs &&\n+            wakeChunk(response, boundArgs, handler.value, resolvedValue)));\n     },\n     function (error) {\n       if (!handler.errored) {\n@@ -1384,7 +1410,7 @@ function parseModelString(response, parentObject, key, value) {\n         );\n       case \"S\":\n         return Symbol.for(value.slice(2));\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(\n@@ -1528,12 +1554,13 @@ function resolveStream(response, id, stream, controller) {\n       (chunk.status = \"fulfilled\"),\n       (chunk.value = stream),\n       (chunk.reason = controller),\n-      null !== id && wakeChunk(response, id, chunk.value))\n+      null !== id && wakeChunk(response, id, chunk.value, chunk))\n     : ((response = new ReactPromise(\"fulfilled\", stream, controller)),\n       chunks.set(id, response));\n }\n function startReadableStream(response, id, type) {\n-  var controller = null;\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -1583,24 +1610,27 @@ function startReadableStream(response, id, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n }\n@@ -1654,6 +1684,7 @@ function startAsyncIterable(response, id, iterator) {\n             rejectListeners = chunk.reason;\n           chunk.status = \"fulfilled\";\n           chunk.value = { done: !1, value: value };\n+          chunk.reason = null;\n           null !== resolveListeners &&\n             wakeChunkIfInitialized(\n               response,\n@@ -1680,36 +1711,46 @@ function startAsyncIterable(response, id, iterator) {\n         nextWriteIndex++;\n       },\n       close: function (value) {\n-        closed = !0;\n-        nextWriteIndex === buffer.length\n-          ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-              response,\n-              value,\n-              !0\n-            ))\n-          : resolveIteratorResultChunk(\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length\n+                ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                    response,\n+                    value,\n+                    !0\n+                  ))\n+                : resolveIteratorResultChunk(\n+                    response,\n+                    buffer[nextWriteIndex],\n+                    value,\n+                    !0\n+                  ),\n+              nextWriteIndex++;\n+            nextWriteIndex < buffer.length;\n+\n+          )\n+            resolveIteratorResultChunk(\n               response,\n-              buffer[nextWriteIndex],\n-              value,\n+              buffer[nextWriteIndex++],\n+              '\"$undefined\"',\n               !0\n             );\n-        for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-          resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex++],\n-            '\"$undefined\"',\n-            !0\n-          );\n       },\n       error: function (error) {\n-        closed = !0;\n-        for (\n-          nextWriteIndex === buffer.length &&\n-          (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-          nextWriteIndex < buffer.length;\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length &&\n+                (buffer[nextWriteIndex] = new ReactPromise(\n+                  \"pending\",\n+                  null,\n+                  null\n+                ));\n+            nextWriteIndex < buffer.length;\n \n-        )\n-          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+          )\n+            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n       }\n     }\n   );"
        },
        {
            "sha": "c8d915ff6ff6532e866fce5cffcca52037e70ab0",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-client.node.development.js",
            "status": "modified",
            "additions": 180,
            "deletions": 146,
            "changes": 326,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -516,13 +516,23 @@\n                 pendingParts--;\n               }\n           }\n+          parentReference = writtenObjects.get(value);\n           if (\"function\" === typeof value.then) {\n+            if (void 0 !== parentReference)\n+              if (modelRoot === value) modelRoot = null;\n+              else return parentReference;\n             null === formData && (formData = new FormData());\n             pendingParts++;\n             var promiseId = nextPartId++;\n+            key = \"$@\" + promiseId.toString(16);\n+            writtenObjects.set(value, key);\n             value.then(function (partValue) {\n               try {\n-                var _partJSON3 = serializeModel(partValue, promiseId);\n+                var previousReference = writtenObjects.get(partValue);\n+                var _partJSON3 =\n+                  void 0 !== previousReference\n+                    ? JSON.stringify(previousReference)\n+                    : serializeModel(partValue, promiseId);\n                 partValue = formData;\n                 partValue.append(formFieldPrefix + promiseId, _partJSON3);\n                 pendingParts--;\n@@ -531,9 +541,8 @@\n                 reject(reason);\n               }\n             }, reject);\n-            return \"$@\" + promiseId.toString(16);\n+            return key;\n           }\n-          parentReference = writtenObjects.get(value);\n           if (void 0 !== parentReference)\n             if (modelRoot === value) modelRoot = null;\n             else return parentReference;\n@@ -691,7 +700,7 @@\n               null === formData && (formData = new FormData()),\n               (parentReference = nextPartId++),\n               formData.set(formFieldPrefix + parentReference, key),\n-              \"$F\" + parentReference.toString(16)\n+              \"$h\" + parentReference.toString(16)\n             );\n           if (\n             void 0 !== temporaryReferences &&\n@@ -1883,6 +1892,7 @@\n           rejectListeners = chunk.reason;\n         chunk.status = \"resolved_module\";\n         chunk.value = value;\n+        chunk.reason = null;\n         value = [];\n         null !== value && chunk._debugInfo.push.apply(chunk._debugInfo, value);\n         null !== resolveListeners &&\n@@ -2012,8 +2022,11 @@\n         response._closed = !0;\n         response._closedReason = error;\n         response._chunks.forEach(function (chunk) {\n-          \"pending\" === chunk.status &&\n-            triggerErrorOnChunk(response, chunk, error);\n+          \"pending\" === chunk.status\n+            ? triggerErrorOnChunk(response, chunk, error)\n+            : \"fulfilled\" === chunk.status &&\n+              null !== chunk.reason &&\n+              chunk.reason.error(error);\n         });\n         weakResponse = response._debugChannel;\n         void 0 !== weakResponse &&\n@@ -2118,125 +2131,136 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value, fulfilledChunk) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          for (\n+            ;\n+            \"object\" === typeof value &&\n+            null !== value &&\n+            value.$$typeof === REACT_LAZY_TYPE;\n+\n+          ) {\n+            var referencedChunk = value._payload;\n+            if (referencedChunk === handler.chunk) value = handler.value;\n+            else {\n+              switch (referencedChunk.status) {\n+                case \"resolved_model\":\n+                  initializeModelChunk(referencedChunk);\n+                  break;\n+                case \"resolved_module\":\n+                  initializeModuleChunk(referencedChunk);\n+              }\n+              switch (referencedChunk.status) {\n+                case \"fulfilled\":\n+                  value = referencedChunk.value;\n+                  continue;\n+                case \"blocked\":\n+                  var cyclicHandler = resolveBlockedCycle(\n+                    referencedChunk,\n+                    reference\n+                  );\n+                  if (null !== cyclicHandler) {\n+                    value = cyclicHandler.value;\n+                    continue;\n+                  }\n+                case \"pending\":\n+                  path.splice(0, i - 1);\n+                  null === referencedChunk.value\n+                    ? (referencedChunk.value = [reference])\n+                    : referencedChunk.value.push(reference);\n+                  null === referencedChunk.reason\n+                    ? (referencedChunk.reason = [reference])\n+                    : referencedChunk.reason.push(reference);\n+                  return;\n+                case \"halted\":\n+                  return;\n+                default:\n+                  rejectReference(\n+                    response,\n+                    reference.handler,\n+                    referencedChunk.reason\n+                  );\n+                  return;\n+              }\n+            }\n+          }\n+          value = value[path[i]];\n+        }\n         for (\n           ;\n           \"object\" === typeof value &&\n           null !== value &&\n           value.$$typeof === REACT_LAZY_TYPE;\n \n-        )\n-          if (((value = value._payload), value === handler.chunk))\n-            value = handler.value;\n+        ) {\n+          var _referencedChunk = value._payload;\n+          if (_referencedChunk === handler.chunk) value = handler.value;\n           else {\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"resolved_model\":\n-                initializeModelChunk(value);\n+                initializeModelChunk(_referencedChunk);\n                 break;\n               case \"resolved_module\":\n-                initializeModuleChunk(value);\n+                initializeModuleChunk(_referencedChunk);\n             }\n-            switch (value.status) {\n+            switch (_referencedChunk.status) {\n               case \"fulfilled\":\n-                value = value.value;\n+                value = _referencedChunk.value;\n                 continue;\n-              case \"blocked\":\n-                var cyclicHandler = resolveBlockedCycle(value, reference);\n-                if (null !== cyclicHandler) {\n-                  value = cyclicHandler.value;\n-                  continue;\n-                }\n-              case \"pending\":\n-                path.splice(0, i - 1);\n-                null === value.value\n-                  ? (value.value = [reference])\n-                  : value.value.push(reference);\n-                null === value.reason\n-                  ? (value.reason = [reference])\n-                  : value.reason.push(reference);\n-                return;\n-              case \"halted\":\n-                return;\n-              default:\n-                rejectReference(response, reference.handler, value.reason);\n-                return;\n             }\n+            break;\n           }\n-        value = value[path[i]];\n-      }\n-      for (\n-        ;\n-        \"object\" === typeof value &&\n-        null !== value &&\n-        value.$$typeof === REACT_LAZY_TYPE;\n-\n-      )\n-        if (((path = value._payload), path === handler.chunk))\n-          value = handler.value;\n-        else {\n-          switch (path.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(path);\n+        }\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+        if (\n+          parentObject[0] === REACT_ELEMENT_TYPE &&\n+          \"object\" === typeof handler.value &&\n+          null !== handler.value &&\n+          handler.value.$$typeof === REACT_ELEMENT_TYPE\n+        ) {\n+          var element = handler.value;\n+          switch (key) {\n+            case \"3\":\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+              element.props = mappedValue;\n               break;\n-            case \"resolved_module\":\n-              initializeModuleChunk(path);\n-          }\n-          switch (path.status) {\n-            case \"fulfilled\":\n-              value = path.value;\n-              continue;\n+            case \"4\":\n+              element._owner = mappedValue;\n+              break;\n+            case \"5\":\n+              element._debugStack = mappedValue;\n+              break;\n+            default:\n+              transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n           }\n-          break;\n-        }\n-      map = map(response, value, parentObject, key);\n-      parentObject[key] = map;\n-      \"\" === key && null === handler.value && (handler.value = map);\n-      if (\n-        parentObject[0] === REACT_ELEMENT_TYPE &&\n-        \"object\" === typeof handler.value &&\n-        null !== handler.value &&\n-        handler.value.$$typeof === REACT_ELEMENT_TYPE\n-      )\n-        switch (((reference = handler.value), key)) {\n-          case \"3\":\n-            transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-            reference.props = map;\n-            break;\n-          case \"4\":\n-            reference._owner = map;\n-            break;\n-          case \"5\":\n-            reference._debugStack = map;\n-            break;\n-          default:\n+        } else\n+          reference.isDebug ||\n             transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n-        }\n-      else\n-        reference.isDebug ||\n-          transferReferencedDebugInfo(handler.chunk, fulfilledChunk);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n+      }\n       handler.deps--;\n       0 === handler.deps &&\n-        ((fulfilledChunk = handler.chunk),\n-        null !== fulfilledChunk &&\n-          \"blocked\" === fulfilledChunk.status &&\n-          ((key = fulfilledChunk.value),\n-          (fulfilledChunk.status = \"fulfilled\"),\n-          (fulfilledChunk.value = handler.value),\n-          (fulfilledChunk.reason = handler.reason),\n-          null !== key\n-            ? wakeChunk(response, key, handler.value, fulfilledChunk)\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value\n+            ? wakeChunk(response, value, handler.value, reference)\n             : ((handler = handler.value),\n-              filterDebugInfo(response, fulfilledChunk),\n-              moveDebugInfoFromChunkToInnerValue(fulfilledChunk, handler))));\n+              filterDebugInfo(response, reference),\n+              moveDebugInfoFromChunkToInnerValue(reference, handler))));\n     }\n     function rejectReference(response, handler, error) {\n       if (!handler.errored) {\n@@ -2388,6 +2412,7 @@\n               ((boundArgs = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== boundArgs\n                 ? wakeChunk(response, boundArgs, handler.value, resolvedValue)\n                 : ((boundArgs = handler.value),\n@@ -2713,7 +2738,7 @@\n             );\n           case \"S\":\n             return Symbol.for(value.slice(2));\n-          case \"F\":\n+          case \"h\":\n             var ref = value.slice(2);\n             return getOutlinedModel(\n               response,\n@@ -3096,7 +3121,8 @@\n           chunks.set(id, stream);\n     }\n     function startReadableStream(response, id, type, streamState) {\n-      var controller = null;\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -3151,24 +3177,28 @@\n             }\n           },\n           close: function () {\n-            if (null === previousBlockedChunk) controller.close();\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.close();\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.close();\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.close();\n+                });\n+              }\n           },\n           error: function (error) {\n-            if (null === previousBlockedChunk) controller.error(error);\n-            else {\n-              var blockedChunk = previousBlockedChunk;\n-              previousBlockedChunk = null;\n-              blockedChunk.then(function () {\n-                return controller.error(error);\n-              });\n-            }\n+            if (!closed)\n+              if (((closed = !0), null === previousBlockedChunk))\n+                controller.error(error);\n+              else {\n+                var blockedChunk = previousBlockedChunk;\n+                previousBlockedChunk = null;\n+                blockedChunk.then(function () {\n+                  return controller.error(error);\n+                });\n+              }\n           }\n         },\n         streamState\n@@ -3224,6 +3254,7 @@\n                 rejectListeners = chunk.reason;\n               chunk.status = \"fulfilled\";\n               chunk.value = { done: !1, value: value };\n+              chunk.reason = null;\n               null !== resolveListeners &&\n                 wakeChunkIfInitialized(\n                   response,\n@@ -3250,36 +3281,39 @@\n             nextWriteIndex++;\n           },\n           close: function (value) {\n-            closed = !0;\n-            nextWriteIndex === buffer.length\n-              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                  response,\n-                  value,\n-                  !0\n-                ))\n-              : resolveIteratorResultChunk(\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length\n+                    ? (buffer[nextWriteIndex] =\n+                        createResolvedIteratorResultChunk(response, value, !0))\n+                    : resolveIteratorResultChunk(\n+                        response,\n+                        buffer[nextWriteIndex],\n+                        value,\n+                        !0\n+                      ),\n+                  nextWriteIndex++;\n+                nextWriteIndex < buffer.length;\n+\n+              )\n+                resolveIteratorResultChunk(\n                   response,\n-                  buffer[nextWriteIndex],\n-                  value,\n+                  buffer[nextWriteIndex++],\n+                  '\"$undefined\"',\n                   !0\n                 );\n-            for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-              resolveIteratorResultChunk(\n-                response,\n-                buffer[nextWriteIndex++],\n-                '\"$undefined\"',\n-                !0\n-              );\n           },\n           error: function (error) {\n-            closed = !0;\n-            for (\n-              nextWriteIndex === buffer.length &&\n-              (buffer[nextWriteIndex] = createPendingChunk(response));\n-              nextWriteIndex < buffer.length;\n+            if (!closed)\n+              for (\n+                closed = !0,\n+                  nextWriteIndex === buffer.length &&\n+                    (buffer[nextWriteIndex] = createPendingChunk(response));\n+                nextWriteIndex < buffer.length;\n \n-            )\n-              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+              )\n+                triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n           }\n         },\n         streamState"
        },
        {
            "sha": "4b2cc78580ea12070d4387d890c97ea7abe62549",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-client.node.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-client.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -316,13 +316,23 @@ function processReply(\n             pendingParts--;\n           }\n       }\n+      parentReference = writtenObjects.get(value);\n       if (\"function\" === typeof value.then) {\n+        if (void 0 !== parentReference)\n+          if (modelRoot === value) modelRoot = null;\n+          else return parentReference;\n         null === formData && (formData = new FormData());\n         pendingParts++;\n         var promiseId = nextPartId++;\n+        key = \"$@\" + promiseId.toString(16);\n+        writtenObjects.set(value, key);\n         value.then(function (partValue) {\n           try {\n-            var partJSON$27 = serializeModel(partValue, promiseId);\n+            var previousReference = writtenObjects.get(partValue);\n+            var partJSON$27 =\n+              void 0 !== previousReference\n+                ? JSON.stringify(previousReference)\n+                : serializeModel(partValue, promiseId);\n             partValue = formData;\n             partValue.append(formFieldPrefix + promiseId, partJSON$27);\n             pendingParts--;\n@@ -331,9 +341,8 @@ function processReply(\n             reject(reason);\n           }\n         }, reject);\n-        return \"$@\" + promiseId.toString(16);\n+        return key;\n       }\n-      parentReference = writtenObjects.get(value);\n       if (void 0 !== parentReference)\n         if (modelRoot === value) modelRoot = null;\n         else return parentReference;\n@@ -457,7 +466,7 @@ function processReply(\n           null === formData && (formData = new FormData()),\n           (parentReference = nextPartId++),\n           formData.set(formFieldPrefix + parentReference, key),\n-          \"$F\" + parentReference.toString(16)\n+          \"$h\" + parentReference.toString(16)\n         );\n       if (\n         void 0 !== temporaryReferences &&\n@@ -741,12 +750,12 @@ function readChunk(chunk) {\n       throw chunk.reason;\n   }\n }\n-function wakeChunk(response, listeners, value) {\n+function wakeChunk(response, listeners, value, chunk) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n     \"function\" === typeof listener\n       ? listener(value)\n-      : fulfillReference(response, listener, value);\n+      : fulfillReference(response, listener, value, chunk);\n   }\n }\n function rejectChunk(response, listeners, error) {\n@@ -786,7 +795,7 @@ function wakeChunkIfInitialized(\n ) {\n   switch (chunk.status) {\n     case \"fulfilled\":\n-      wakeChunk(response, resolveListeners, chunk.value);\n+      wakeChunk(response, resolveListeners, chunk.value, chunk);\n       break;\n     case \"blocked\":\n       for (var i = 0; i < resolveListeners.length; i++) {\n@@ -795,7 +804,7 @@ function wakeChunkIfInitialized(\n           var cyclicHandler = resolveBlockedCycle(chunk, listener);\n           if (null !== cyclicHandler)\n             switch (\n-              (fulfillReference(response, listener, cyclicHandler.value),\n+              (fulfillReference(response, listener, cyclicHandler.value, chunk),\n               resolveListeners.splice(i, 1),\n               i--,\n               null !== rejectListeners &&\n@@ -804,7 +813,7 @@ function wakeChunkIfInitialized(\n               chunk.status)\n             ) {\n               case \"fulfilled\":\n-                wakeChunk(response, resolveListeners, chunk.value);\n+                wakeChunk(response, resolveListeners, chunk.value, chunk);\n                 return;\n               case \"rejected\":\n                 null !== rejectListeners &&\n@@ -880,6 +889,7 @@ function resolveModuleChunk(response, chunk, value) {\n       rejectListeners = chunk.reason;\n     chunk.status = \"resolved_module\";\n     chunk.value = value;\n+    chunk.reason = null;\n     null !== resolveListeners &&\n       (initializeModuleChunk(chunk),\n       wakeChunkIfInitialized(\n@@ -942,8 +952,11 @@ function reportGlobalError(weakResponse, error) {\n   weakResponse._closed = !0;\n   weakResponse._closedReason = error;\n   weakResponse._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status &&\n-      triggerErrorOnChunk(weakResponse, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(weakResponse, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function createLazyChunkWrapper(chunk) {\n@@ -960,109 +973,120 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      for (\n+        ;\n+        \"object\" === typeof value &&\n+        null !== value &&\n+        value.$$typeof === REACT_LAZY_TYPE;\n+\n+      ) {\n+        var referencedChunk = value._payload;\n+        if (referencedChunk === handler.chunk) value = handler.value;\n+        else {\n+          switch (referencedChunk.status) {\n+            case \"resolved_model\":\n+              initializeModelChunk(referencedChunk);\n+              break;\n+            case \"resolved_module\":\n+              initializeModuleChunk(referencedChunk);\n+          }\n+          switch (referencedChunk.status) {\n+            case \"fulfilled\":\n+              value = referencedChunk.value;\n+              continue;\n+            case \"blocked\":\n+              var cyclicHandler = resolveBlockedCycle(\n+                referencedChunk,\n+                reference\n+              );\n+              if (null !== cyclicHandler) {\n+                value = cyclicHandler.value;\n+                continue;\n+              }\n+            case \"pending\":\n+              path.splice(0, i - 1);\n+              null === referencedChunk.value\n+                ? (referencedChunk.value = [reference])\n+                : referencedChunk.value.push(reference);\n+              null === referencedChunk.reason\n+                ? (referencedChunk.reason = [reference])\n+                : referencedChunk.reason.push(reference);\n+              return;\n+            case \"halted\":\n+              return;\n+            default:\n+              rejectReference(\n+                response,\n+                reference.handler,\n+                referencedChunk.reason\n+              );\n+              return;\n+          }\n+        }\n+      }\n+      value = value[path[i]];\n+    }\n     for (\n       ;\n       \"object\" === typeof value &&\n       null !== value &&\n       value.$$typeof === REACT_LAZY_TYPE;\n \n-    )\n-      if (((value = value._payload), value === handler.chunk))\n-        value = handler.value;\n+    ) {\n+      var referencedChunk$43 = value._payload;\n+      if (referencedChunk$43 === handler.chunk) value = handler.value;\n       else {\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"resolved_model\":\n-            initializeModelChunk(value);\n+            initializeModelChunk(referencedChunk$43);\n             break;\n           case \"resolved_module\":\n-            initializeModuleChunk(value);\n+            initializeModuleChunk(referencedChunk$43);\n         }\n-        switch (value.status) {\n+        switch (referencedChunk$43.status) {\n           case \"fulfilled\":\n-            value = value.value;\n+            value = referencedChunk$43.value;\n             continue;\n-          case \"blocked\":\n-            var cyclicHandler = resolveBlockedCycle(value, reference);\n-            if (null !== cyclicHandler) {\n-              value = cyclicHandler.value;\n-              continue;\n-            }\n-          case \"pending\":\n-            path.splice(0, i - 1);\n-            null === value.value\n-              ? (value.value = [reference])\n-              : value.value.push(reference);\n-            null === value.reason\n-              ? (value.reason = [reference])\n-              : value.reason.push(reference);\n-            return;\n-          case \"halted\":\n-            return;\n-          default:\n-            rejectReference(response, reference.handler, value.reason);\n-            return;\n         }\n+        break;\n       }\n-    value = value[path[i]];\n-  }\n-  for (\n-    ;\n-    \"object\" === typeof value &&\n-    null !== value &&\n-    value.$$typeof === REACT_LAZY_TYPE;\n-\n-  )\n-    if (((reference = value._payload), reference === handler.chunk))\n-      value = handler.value;\n-    else {\n-      switch (reference.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(reference);\n-          break;\n-        case \"resolved_module\":\n-          initializeModuleChunk(reference);\n-      }\n-      switch (reference.status) {\n-        case \"fulfilled\":\n-          value = reference.value;\n-          continue;\n-      }\n-      break;\n     }\n-  map = map(response, value, parentObject, key);\n-  parentObject[key] = map;\n-  \"\" === key && null === handler.value && (handler.value = map);\n-  if (\n-    parentObject[0] === REACT_ELEMENT_TYPE &&\n-    \"object\" === typeof handler.value &&\n-    null !== handler.value &&\n-    handler.value.$$typeof === REACT_ELEMENT_TYPE\n-  )\n-    switch (((parentObject = handler.value), key)) {\n-      case \"3\":\n-        parentObject.props = map;\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+    if (\n+      parentObject[0] === REACT_ELEMENT_TYPE &&\n+      \"object\" === typeof handler.value &&\n+      null !== handler.value &&\n+      handler.value.$$typeof === REACT_ELEMENT_TYPE\n+    ) {\n+      var element = handler.value;\n+      switch (key) {\n+        case \"3\":\n+          element.props = mappedValue;\n+      }\n     }\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n+  }\n   handler.deps--;\n   0 === handler.deps &&\n-    ((key = handler.chunk),\n-    null !== key &&\n-      \"blocked\" === key.status &&\n-      ((parentObject = key.value),\n-      (key.status = \"fulfilled\"),\n-      (key.value = handler.value),\n-      (key.reason = handler.reason),\n-      null !== parentObject &&\n-        wakeChunk(response, parentObject, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value, reference)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -1180,7 +1204,9 @@ function loadServerReference(response, metaData, parentObject, key) {\n           ((boundArgs = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n-          null !== boundArgs && wakeChunk(response, boundArgs, handler.value)));\n+          (resolvedValue.reason = null),\n+          null !== boundArgs &&\n+            wakeChunk(response, boundArgs, handler.value, resolvedValue)));\n     },\n     function (error) {\n       if (!handler.errored) {\n@@ -1385,7 +1411,7 @@ function parseModelString(response, parentObject, key, value) {\n         );\n       case \"S\":\n         return Symbol.for(value.slice(2));\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(\n@@ -1532,12 +1558,13 @@ function resolveStream(response, id, stream, controller) {\n       (chunk.status = \"fulfilled\"),\n       (chunk.value = stream),\n       (chunk.reason = controller),\n-      null !== id && wakeChunk(response, id, chunk.value))\n+      null !== id && wakeChunk(response, id, chunk.value, chunk))\n     : ((response = new ReactPromise(\"fulfilled\", stream, controller)),\n       chunks.set(id, response));\n }\n function startReadableStream(response, id, type) {\n-  var controller = null;\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -1587,24 +1614,27 @@ function startReadableStream(response, id, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n }\n@@ -1658,6 +1688,7 @@ function startAsyncIterable(response, id, iterator) {\n             rejectListeners = chunk.reason;\n           chunk.status = \"fulfilled\";\n           chunk.value = { done: !1, value: value };\n+          chunk.reason = null;\n           null !== resolveListeners &&\n             wakeChunkIfInitialized(\n               response,\n@@ -1684,36 +1715,46 @@ function startAsyncIterable(response, id, iterator) {\n         nextWriteIndex++;\n       },\n       close: function (value) {\n-        closed = !0;\n-        nextWriteIndex === buffer.length\n-          ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-              response,\n-              value,\n-              !0\n-            ))\n-          : resolveIteratorResultChunk(\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length\n+                ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                    response,\n+                    value,\n+                    !0\n+                  ))\n+                : resolveIteratorResultChunk(\n+                    response,\n+                    buffer[nextWriteIndex],\n+                    value,\n+                    !0\n+                  ),\n+              nextWriteIndex++;\n+            nextWriteIndex < buffer.length;\n+\n+          )\n+            resolveIteratorResultChunk(\n               response,\n-              buffer[nextWriteIndex],\n-              value,\n+              buffer[nextWriteIndex++],\n+              '\"$undefined\"',\n               !0\n             );\n-        for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-          resolveIteratorResultChunk(\n-            response,\n-            buffer[nextWriteIndex++],\n-            '\"$undefined\"',\n-            !0\n-          );\n       },\n       error: function (error) {\n-        closed = !0;\n-        for (\n-          nextWriteIndex === buffer.length &&\n-          (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-          nextWriteIndex < buffer.length;\n+        if (!closed)\n+          for (\n+            closed = !0,\n+              nextWriteIndex === buffer.length &&\n+                (buffer[nextWriteIndex] = new ReactPromise(\n+                  \"pending\",\n+                  null,\n+                  null\n+                ));\n+            nextWriteIndex < buffer.length;\n \n-        )\n-          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+          )\n+            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n       }\n     }\n   );"
        },
        {
            "sha": "7043d9eb0772bad266bffea86c4a88ad448ae5d7",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-server.browser.development.js",
            "status": "modified",
            "additions": 176,
            "deletions": 180,
            "changes": 356,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -2150,7 +2150,7 @@\n     function serializeServerReference(request, serverReference) {\n       var writtenServerReferences = request.writtenServerReferences,\n         existingId = writtenServerReferences.get(serverReference);\n-      if (void 0 !== existingId) return \"$F\" + existingId.toString(16);\n+      if (void 0 !== existingId) return \"$h\" + existingId.toString(16);\n       existingId = serverReference.$$bound;\n       existingId = null === existingId ? null : Promise.resolve(existingId);\n       var id = serverReference.$$id,\n@@ -2176,7 +2176,7 @@\n           : { id: id, bound: existingId };\n       request = outlineModel(request, existingId);\n       writtenServerReferences.set(serverReference, request);\n-      return \"$F\" + request.toString(16);\n+      return \"$h\" + request.toString(16);\n     }\n     function serializeLargeTextString(request, text) {\n       request.pendingChunks++;\n@@ -2572,7 +2572,7 @@\n         if (value instanceof Date) return \"$D\" + value.toJSON();\n         elementReference = getPrototypeOf(value);\n         if (\n-          elementReference !== ObjectPrototype &&\n+          elementReference !== ObjectPrototype$1 &&\n           (null === elementReference ||\n             null !== getPrototypeOf(elementReference))\n         )\n@@ -3173,7 +3173,7 @@\n           return serializeDebugBlob(request, value);\n         if (getIteratorFn(value)) return Array.from(value);\n         request = getPrototypeOf(value);\n-        if (request !== ObjectPrototype && null !== request) {\n+        if (request !== ObjectPrototype$1 && null !== request) {\n           counter = Object.create(null);\n           for (env in value)\n             if (hasOwnProperty.call(value, env) || isGetter(request, env))\n@@ -4142,6 +4142,7 @@\n               ((promiseValue = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== promiseValue &&\n                 wakeChunk(response, promiseValue, handler.value)));\n         },\n@@ -4245,6 +4246,7 @@\n         }\n         chunk.status = \"fulfilled\";\n         chunk.value = value;\n+        chunk.reason = null;\n       } catch (error) {\n         (chunk.status = \"rejected\"), (chunk.reason = error);\n       } finally {\n@@ -4255,8 +4257,11 @@\n       response._closed = !0;\n       response._closedReason = error;\n       response._chunks.forEach(function (chunk) {\n-        \"pending\" === chunk.status &&\n-          triggerErrorOnChunk(response, chunk, error);\n+        \"pending\" === chunk.status\n+          ? triggerErrorOnChunk(response, chunk, error)\n+          : \"fulfilled\" === chunk.status &&\n+            null !== chunk.reason &&\n+            chunk.reason.error(error);\n       });\n     }\n     function getChunk(response, id) {\n@@ -4278,58 +4283,41 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              continue;\n-            case \"blocked\":\n-            case \"pending\":\n-              path.splice(0, i - 1);\n-              null === value.value\n-                ? (value.value = [reference])\n-                : value.value.push(reference);\n-              null === value.reason\n-                ? (value.reason = [reference])\n-                : value.reason.push(reference);\n-              return;\n-            default:\n-              rejectReference(response, reference.handler, value.reason);\n-              return;\n-          }\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          var name = path[i];\n+          if (\n+            \"object\" !== typeof value ||\n+            null === value ||\n+            (getPrototypeOf(value) !== ObjectPrototype &&\n+              getPrototypeOf(value) !== ArrayPrototype) ||\n+            !hasOwnProperty.call(value, name)\n+          )\n+            throw Error(\"Invalid reference.\");\n+          value = value[name];\n         }\n-        var name = path[i];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n       }\n-      reference = map(response, value, parentObject, key);\n-      parentObject[key] = reference;\n-      \"\" === key && null === handler.value && (handler.value = reference);\n       handler.deps--;\n       0 === handler.deps &&\n-        ((parentObject = handler.chunk),\n-        null !== parentObject &&\n-          \"blocked\" === parentObject.status &&\n-          ((key = parentObject.value),\n-          (parentObject.status = \"fulfilled\"),\n-          (parentObject.value = handler.value),\n-          (parentObject.reason = handler.reason),\n-          null !== key && wakeChunk(response, key, handler.value)));\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value && wakeChunk(response, value, handler.value)));\n     }\n     function rejectReference(response, handler, error) {\n       handler.errored ||\n@@ -4341,33 +4329,6 @@\n           \"blocked\" === handler.status &&\n           triggerErrorOnChunk(response, handler, error));\n     }\n-    function waitForReference(\n-      referencedChunk,\n-      parentObject,\n-      key,\n-      response,\n-      map,\n-      path\n-    ) {\n-      initializingHandler\n-        ? ((response = initializingHandler), response.deps++)\n-        : (response = initializingHandler =\n-            { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-      parentObject = {\n-        handler: response,\n-        parentObject: parentObject,\n-        key: key,\n-        map: map,\n-        path: path\n-      };\n-      null === referencedChunk.value\n-        ? (referencedChunk.value = [parentObject])\n-        : referencedChunk.value.push(parentObject);\n-      null === referencedChunk.reason\n-        ? (referencedChunk.reason = [parentObject])\n-        : referencedChunk.reason.push(parentObject);\n-      return null;\n-    }\n     function getOutlinedModel(response, reference, parentObject, key, map) {\n       reference = reference.split(\":\");\n       var id = parseInt(reference[0], 16);\n@@ -4378,59 +4339,47 @@\n       }\n       switch (id.status) {\n         case \"fulfilled\":\n-          var value = id.value;\n-          for (id = 1; id < reference.length; id++) {\n-            for (; value instanceof ReactPromise; ) {\n-              switch (value.status) {\n-                case \"resolved_model\":\n-                  initializeModelChunk(value);\n-              }\n-              switch (value.status) {\n-                case \"fulfilled\":\n-                  value = value.value;\n-                  break;\n-                case \"blocked\":\n-                case \"pending\":\n-                  return waitForReference(\n-                    value,\n-                    parentObject,\n-                    key,\n-                    response,\n-                    map,\n-                    reference.slice(id - 1)\n-                  );\n-                default:\n-                  return (\n-                    initializingHandler\n-                      ? ((initializingHandler.errored = !0),\n-                        (initializingHandler.value = null),\n-                        (initializingHandler.reason = value.reason))\n-                      : (initializingHandler = {\n-                          chunk: null,\n-                          value: null,\n-                          reason: value.reason,\n-                          deps: 0,\n-                          errored: !0\n-                        }),\n-                    null\n-                  );\n-              }\n-            }\n-            var name = reference[id];\n-            \"object\" === typeof value &&\n-              hasOwnProperty.call(value, name) &&\n-              (value = value[name]);\n+          id = id.value;\n+          for (var i = 1; i < reference.length; i++) {\n+            var name = reference[i];\n+            if (\n+              \"object\" !== typeof id ||\n+              null === id ||\n+              (getPrototypeOf(id) !== ObjectPrototype &&\n+                getPrototypeOf(id) !== ArrayPrototype) ||\n+              !hasOwnProperty.call(id, name)\n+            )\n+              throw Error(\"Invalid reference.\");\n+            id = id[name];\n           }\n-          return map(response, value, parentObject, key);\n+          return map(response, id, parentObject, key);\n         case \"pending\":\n         case \"blocked\":\n-          return waitForReference(\n-            id,\n-            parentObject,\n-            key,\n-            response,\n-            map,\n-            reference\n+          return (\n+            initializingHandler\n+              ? ((response = initializingHandler), response.deps++)\n+              : (response = initializingHandler =\n+                  {\n+                    chunk: null,\n+                    value: null,\n+                    reason: null,\n+                    deps: 1,\n+                    errored: !1\n+                  }),\n+            (parentObject = {\n+              handler: response,\n+              parentObject: parentObject,\n+              key: key,\n+              map: map,\n+              path: reference\n+            }),\n+            null === id.value\n+              ? (id.value = [parentObject])\n+              : id.value.push(parentObject),\n+            null === id.reason\n+              ? (id.reason = [parentObject])\n+              : id.reason.push(parentObject),\n+            null\n           );\n         default:\n           return (\n@@ -4470,9 +4419,10 @@\n       parentKey\n     ) {\n       reference = parseInt(reference.slice(2), 16);\n-      reference = response._formData\n-        .get(response._prefix + reference)\n-        .arrayBuffer();\n+      bytesPerElement = response._prefix + reference;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized typed array.\");\n+      reference = response._formData.get(bytesPerElement).arrayBuffer();\n       if (initializingHandler) {\n         var handler = initializingHandler;\n         handler.deps++;\n@@ -4501,6 +4451,7 @@\n             var resolveListeners = buffer.value;\n             buffer.status = \"fulfilled\";\n             buffer.value = handler.value;\n+            buffer.reason = null;\n             null !== resolveListeners &&\n               wakeChunk(response, resolveListeners, handler.value);\n           }\n@@ -4535,7 +4486,10 @@\n     }\n     function parseReadableStream(response, reference, type) {\n       reference = parseInt(reference.slice(2), 16);\n-      var controller = null;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -4582,24 +4536,28 @@\n           }\n         },\n         close: function () {\n-          if (null === previousBlockedChunk) controller.close();\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.close();\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.close();\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.close();\n+              });\n+            }\n         },\n         error: function (error) {\n-          if (null === previousBlockedChunk) controller.error(error);\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.error(error);\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.error(error);\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.error(error);\n+              });\n+            }\n         }\n       });\n       return type;\n@@ -4614,6 +4572,8 @@\n     }\n     function parseAsyncIterable(response, reference, iterator) {\n       reference = parseInt(reference.slice(2), 16);\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n       var buffer = [],\n         closed = !1,\n         nextWriteIndex = 0,\n@@ -4654,36 +4614,46 @@\n           nextWriteIndex++;\n         },\n         close: function (value) {\n-          closed = !0;\n-          nextWriteIndex === buffer.length\n-            ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                response,\n-                value,\n-                !0\n-              ))\n-            : resolveIteratorResultChunk(\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length\n+                  ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                      response,\n+                      value,\n+                      !0\n+                    ))\n+                  : resolveIteratorResultChunk(\n+                      response,\n+                      buffer[nextWriteIndex],\n+                      value,\n+                      !0\n+                    ),\n+                nextWriteIndex++;\n+              nextWriteIndex < buffer.length;\n+\n+            )\n+              resolveIteratorResultChunk(\n                 response,\n-                buffer[nextWriteIndex],\n-                value,\n+                buffer[nextWriteIndex++],\n+                '\"$undefined\"',\n                 !0\n               );\n-          for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-            resolveIteratorResultChunk(\n-              response,\n-              buffer[nextWriteIndex++],\n-              '\"$undefined\"',\n-              !0\n-            );\n         },\n         error: function (error) {\n-          closed = !0;\n-          for (\n-            nextWriteIndex === buffer.length &&\n-            (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-            nextWriteIndex < buffer.length;\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length &&\n+                  (buffer[nextWriteIndex] = new ReactPromise(\n+                    \"pending\",\n+                    null,\n+                    null\n+                  ));\n+              nextWriteIndex < buffer.length;\n \n-          )\n-            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+            )\n+              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n         }\n       });\n       return iterator;\n@@ -4697,7 +4667,7 @@\n             return (\n               (obj = parseInt(value.slice(2), 16)), getChunk(response, obj)\n             );\n-          case \"F\":\n+          case \"h\":\n             return (\n               (value = value.slice(2)),\n               getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -4971,6 +4941,13 @@\n       SERVER_REFERENCE_TAG = Symbol.for(\"react.server.reference\"),\n       FunctionBind = Function.prototype.bind,\n       ArraySlice = Array.prototype.slice,\n+      serverReferenceToString = {\n+        value: function () {\n+          return \"function () { [omitted code] }\";\n+        },\n+        configurable: !0,\n+        writable: !0\n+      },\n       PROMISE_PROTOTYPE = Promise.prototype,\n       deepProxyHandlers = {\n         get: function (target, name) {\n@@ -5356,7 +5333,7 @@\n       patchConsole(console, \"table\"),\n       patchConsole(console, \"trace\"),\n       patchConsole(console, \"warn\"));\n-    var ObjectPrototype = Object.prototype,\n+    var ObjectPrototype$1 = Object.prototype,\n       stringify = JSON.stringify,\n       ABORTING = 12,\n       CLOSED = 14,\n@@ -5394,7 +5371,23 @@\n       }\n       switch (this.status) {\n         case \"fulfilled\":\n-          \"function\" === typeof resolve && resolve(this.value);\n+          if (\"function\" === typeof resolve) {\n+            for (\n+              var inspectedValue = this.value;\n+              inspectedValue instanceof ReactPromise;\n+\n+            ) {\n+              if (inspectedValue === this) {\n+                \"function\" === typeof reject &&\n+                  reject(Error(\"Cannot have cyclic thenables.\"));\n+                return;\n+              }\n+              if (\"fulfilled\" === inspectedValue.status)\n+                inspectedValue = inspectedValue.value;\n+              else break;\n+            }\n+            resolve(this.value);\n+          }\n           break;\n         case \"pending\":\n         case \"blocked\":\n@@ -5409,7 +5402,9 @@\n           \"function\" === typeof reject && reject(this.reason);\n       }\n     };\n-    var initializingHandler = null;\n+    var ObjectPrototype = Object.prototype,\n+      ArrayPrototype = Array.prototype,\n+      initializingHandler = null;\n     exports.createClientModuleProxy = function (moduleId) {\n       moduleId = registerClientReferenceImpl({}, moduleId, !1);\n       return new Proxy(moduleId, proxyHandlers$1);\n@@ -5537,7 +5532,8 @@\n         },\n         $$bound: { value: null, configurable: !0 },\n         $$location: { value: Error(\"react-stack-top-frame\"), configurable: !0 },\n-        bind: { value: bind, configurable: !0 }\n+        bind: { value: bind, configurable: !0 },\n+        toString: serverReferenceToString\n       });\n     };\n     exports.renderToReadableStream = function (model, webpackMap, options) {"
        },
        {
            "sha": "01b2017f80944cda9b8c3da426df91dba280d9d2",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-server.browser.production.js",
            "status": "modified",
            "additions": 169,
            "deletions": 172,
            "changes": 341,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -101,7 +101,14 @@ function bind() {\n   }\n   return newFn;\n }\n-var PROMISE_PROTOTYPE = Promise.prototype,\n+var serverReferenceToString = {\n+    value: function () {\n+      return \"function () { [omitted code] }\";\n+    },\n+    configurable: !0,\n+    writable: !0\n+  },\n+  PROMISE_PROTOTYPE = Promise.prototype,\n   deepProxyHandlers = {\n     get: function (target, name) {\n       switch (name) {\n@@ -820,7 +827,7 @@ function describeObjectForErrorMessage(objectOrArray, expandedName) {\n       : \"\\n  \" + str;\n }\n var hasOwnProperty = Object.prototype.hasOwnProperty,\n-  ObjectPrototype = Object.prototype,\n+  ObjectPrototype$1 = Object.prototype,\n   stringify = JSON.stringify,\n   TaintRegistryObjects = ReactSharedInternalsServer.TaintRegistryObjects,\n   TaintRegistryValues = ReactSharedInternalsServer.TaintRegistryValues,\n@@ -1726,7 +1733,7 @@ function renderModelDestructive(\n     if (value instanceof Date) return \"$D\" + value.toJSON();\n     request = getPrototypeOf(value);\n     if (\n-      request !== ObjectPrototype &&\n+      request !== ObjectPrototype$1 &&\n       (null === request || null !== getPrototypeOf(request))\n     )\n       throw Error(\n@@ -1779,7 +1786,7 @@ function renderModelDestructive(\n         (task = request.writtenServerReferences),\n         (parentPropertyName = task.get(value)),\n         void 0 !== parentPropertyName\n-          ? (value = \"$F\" + parentPropertyName.toString(16))\n+          ? (value = \"$h\" + parentPropertyName.toString(16))\n           : ((parentPropertyName = value.$$bound),\n             (parentPropertyName =\n               null === parentPropertyName\n@@ -1791,7 +1798,7 @@ function renderModelDestructive(\n               0\n             )),\n             task.set(value, request),\n-            (value = \"$F\" + request.toString(16))),\n+            (value = \"$h\" + request.toString(16))),\n         value\n       );\n     if (\n@@ -2330,7 +2337,23 @@ ReactPromise.prototype.then = function (resolve, reject) {\n   }\n   switch (this.status) {\n     case \"fulfilled\":\n-      \"function\" === typeof resolve && resolve(this.value);\n+      if (\"function\" === typeof resolve) {\n+        for (\n+          var inspectedValue = this.value;\n+          inspectedValue instanceof ReactPromise;\n+\n+        ) {\n+          if (inspectedValue === this) {\n+            \"function\" === typeof reject &&\n+              reject(Error(\"Cannot have cyclic thenables.\"));\n+            return;\n+          }\n+          if (\"fulfilled\" === inspectedValue.status)\n+            inspectedValue = inspectedValue.value;\n+          else break;\n+        }\n+        resolve(this.value);\n+      }\n       break;\n     case \"pending\":\n     case \"blocked\":\n@@ -2343,6 +2366,8 @@ ReactPromise.prototype.then = function (resolve, reject) {\n       \"function\" === typeof reject && reject(this.reason);\n   }\n };\n+var ObjectPrototype = Object.prototype,\n+  ArrayPrototype = Array.prototype;\n function wakeChunk(response, listeners, value) {\n   for (var i = 0; i < listeners.length; i++) {\n     var listener = listeners[i];\n@@ -2520,6 +2545,7 @@ function loadServerReference$1(response, metaData, parentObject, key) {\n           ((promiseValue = resolvedValue.value),\n           (resolvedValue.status = \"fulfilled\"),\n           (resolvedValue.value = handler.value),\n+          (resolvedValue.reason = null),\n           null !== promiseValue &&\n             wakeChunk(response, promiseValue, handler.value)));\n     },\n@@ -2611,6 +2637,7 @@ function initializeModelChunk(chunk) {\n     }\n     chunk.status = \"fulfilled\";\n     chunk.value = value;\n+    chunk.reason = null;\n   } catch (error) {\n     (chunk.status = \"rejected\"), (chunk.reason = error);\n   } finally {\n@@ -2621,7 +2648,11 @@ function reportGlobalError(response, error) {\n   response._closed = !0;\n   response._closedReason = error;\n   response._chunks.forEach(function (chunk) {\n-    \"pending\" === chunk.status && triggerErrorOnChunk(response, chunk, error);\n+    \"pending\" === chunk.status\n+      ? triggerErrorOnChunk(response, chunk, error)\n+      : \"fulfilled\" === chunk.status &&\n+        null !== chunk.reason &&\n+        chunk.reason.error(error);\n   });\n }\n function getChunk(response, id) {\n@@ -2639,58 +2670,41 @@ function getChunk(response, id) {\n   return chunk;\n }\n function fulfillReference(response, reference, value) {\n-  for (\n-    var handler = reference.handler,\n-      parentObject = reference.parentObject,\n-      key = reference.key,\n-      map = reference.map,\n-      path = reference.path,\n-      i = 1;\n-    i < path.length;\n-    i++\n-  ) {\n-    for (; value instanceof ReactPromise; ) {\n-      switch (value.status) {\n-        case \"resolved_model\":\n-          initializeModelChunk(value);\n-      }\n-      switch (value.status) {\n-        case \"fulfilled\":\n-          value = value.value;\n-          continue;\n-        case \"blocked\":\n-        case \"pending\":\n-          path.splice(0, i - 1);\n-          null === value.value\n-            ? (value.value = [reference])\n-            : value.value.push(reference);\n-          null === value.reason\n-            ? (value.reason = [reference])\n-            : value.reason.push(reference);\n-          return;\n-        default:\n-          rejectReference(response, reference.handler, value.reason);\n-          return;\n-      }\n+  var handler = reference.handler,\n+    parentObject = reference.parentObject,\n+    key = reference.key,\n+    map = reference.map,\n+    path = reference.path;\n+  try {\n+    for (var i = 1; i < path.length; i++) {\n+      var name = path[i];\n+      if (\n+        \"object\" !== typeof value ||\n+        null === value ||\n+        (getPrototypeOf(value) !== ObjectPrototype &&\n+          getPrototypeOf(value) !== ArrayPrototype) ||\n+        !hasOwnProperty.call(value, name)\n+      )\n+        throw Error(\"Invalid reference.\");\n+      value = value[name];\n     }\n-    var name = path[i];\n-    \"object\" === typeof value &&\n-      hasOwnProperty.call(value, name) &&\n-      (value = value[name]);\n+    var mappedValue = map(response, value, parentObject, key);\n+    parentObject[key] = mappedValue;\n+    \"\" === key && null === handler.value && (handler.value = mappedValue);\n+  } catch (error) {\n+    rejectReference(response, reference.handler, error);\n+    return;\n   }\n-  reference = map(response, value, parentObject, key);\n-  parentObject[key] = reference;\n-  \"\" === key && null === handler.value && (handler.value = reference);\n   handler.deps--;\n   0 === handler.deps &&\n-    ((parentObject = handler.chunk),\n-    null !== parentObject &&\n-      \"blocked\" === parentObject.status &&\n-      ((key = parentObject.value),\n-      (parentObject.status = \"fulfilled\"),\n-      (parentObject.value = handler.value),\n-      (parentObject.reason = handler.reason),\n-      null !== key && wakeChunk(response, key, handler.value)));\n+    ((reference = handler.chunk),\n+    null !== reference &&\n+      \"blocked\" === reference.status &&\n+      ((value = reference.value),\n+      (reference.status = \"fulfilled\"),\n+      (reference.value = handler.value),\n+      (reference.reason = handler.reason),\n+      null !== value && wakeChunk(response, value, handler.value)));\n }\n function rejectReference(response, handler, error) {\n   handler.errored ||\n@@ -2702,33 +2716,6 @@ function rejectReference(response, handler, error) {\n       \"blocked\" === handler.status &&\n       triggerErrorOnChunk(response, handler, error));\n }\n-function waitForReference(\n-  referencedChunk,\n-  parentObject,\n-  key,\n-  response,\n-  map,\n-  path\n-) {\n-  initializingHandler\n-    ? ((response = initializingHandler), response.deps++)\n-    : (response = initializingHandler =\n-        { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-  parentObject = {\n-    handler: response,\n-    parentObject: parentObject,\n-    key: key,\n-    map: map,\n-    path: path\n-  };\n-  null === referencedChunk.value\n-    ? (referencedChunk.value = [parentObject])\n-    : referencedChunk.value.push(parentObject);\n-  null === referencedChunk.reason\n-    ? (referencedChunk.reason = [parentObject])\n-    : referencedChunk.reason.push(parentObject);\n-  return null;\n-}\n function getOutlinedModel(response, reference, parentObject, key, map) {\n   reference = reference.split(\":\");\n   var id = parseInt(reference[0], 16);\n@@ -2739,53 +2726,42 @@ function getOutlinedModel(response, reference, parentObject, key, map) {\n   }\n   switch (id.status) {\n     case \"fulfilled\":\n-      var value = id.value;\n-      for (id = 1; id < reference.length; id++) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              break;\n-            case \"blocked\":\n-            case \"pending\":\n-              return waitForReference(\n-                value,\n-                parentObject,\n-                key,\n-                response,\n-                map,\n-                reference.slice(id - 1)\n-              );\n-            default:\n-              return (\n-                initializingHandler\n-                  ? ((initializingHandler.errored = !0),\n-                    (initializingHandler.value = null),\n-                    (initializingHandler.reason = value.reason))\n-                  : (initializingHandler = {\n-                      chunk: null,\n-                      value: null,\n-                      reason: value.reason,\n-                      deps: 0,\n-                      errored: !0\n-                    }),\n-                null\n-              );\n-          }\n-        }\n-        var name = reference[id];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+      id = id.value;\n+      for (var i = 1; i < reference.length; i++) {\n+        var name = reference[i];\n+        if (\n+          \"object\" !== typeof id ||\n+          null === id ||\n+          (getPrototypeOf(id) !== ObjectPrototype &&\n+            getPrototypeOf(id) !== ArrayPrototype) ||\n+          !hasOwnProperty.call(id, name)\n+        )\n+          throw Error(\"Invalid reference.\");\n+        id = id[name];\n       }\n-      return map(response, value, parentObject, key);\n+      return map(response, id, parentObject, key);\n     case \"pending\":\n     case \"blocked\":\n-      return waitForReference(id, parentObject, key, response, map, reference);\n+      return (\n+        initializingHandler\n+          ? ((response = initializingHandler), response.deps++)\n+          : (response = initializingHandler =\n+              { chunk: null, value: null, reason: null, deps: 1, errored: !1 }),\n+        (parentObject = {\n+          handler: response,\n+          parentObject: parentObject,\n+          key: key,\n+          map: map,\n+          path: reference\n+        }),\n+        null === id.value\n+          ? (id.value = [parentObject])\n+          : id.value.push(parentObject),\n+        null === id.reason\n+          ? (id.reason = [parentObject])\n+          : id.reason.push(parentObject),\n+        null\n+      );\n     default:\n       return (\n         initializingHandler\n@@ -2824,9 +2800,10 @@ function parseTypedArray(\n   parentKey\n ) {\n   reference = parseInt(reference.slice(2), 16);\n-  reference = response._formData\n-    .get(response._prefix + reference)\n-    .arrayBuffer();\n+  bytesPerElement = response._prefix + reference;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized typed array.\");\n+  reference = response._formData.get(bytesPerElement).arrayBuffer();\n   if (initializingHandler) {\n     var handler = initializingHandler;\n     handler.deps++;\n@@ -2852,6 +2829,7 @@ function parseTypedArray(\n         var resolveListeners = buffer.value;\n         buffer.status = \"fulfilled\";\n         buffer.value = handler.value;\n+        buffer.reason = null;\n         null !== resolveListeners &&\n           wakeChunk(response, resolveListeners, handler.value);\n       }\n@@ -2884,7 +2862,10 @@ function resolveStream(response, id, stream, controller) {\n }\n function parseReadableStream(response, reference, type) {\n   reference = parseInt(reference.slice(2), 16);\n-  var controller = null;\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n+  var controller = null,\n+    closed = !1;\n   type = new ReadableStream({\n     type: type,\n     start: function (c) {\n@@ -2927,24 +2908,27 @@ function parseReadableStream(response, reference, type) {\n       }\n     },\n     close: function () {\n-      if (null === previousBlockedChunk) controller.close();\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.close();\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk)) controller.close();\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.close();\n+          });\n+        }\n     },\n     error: function (error) {\n-      if (null === previousBlockedChunk) controller.error(error);\n-      else {\n-        var blockedChunk = previousBlockedChunk;\n-        previousBlockedChunk = null;\n-        blockedChunk.then(function () {\n-          return controller.error(error);\n-        });\n-      }\n+      if (!closed)\n+        if (((closed = !0), null === previousBlockedChunk))\n+          controller.error(error);\n+        else {\n+          var blockedChunk = previousBlockedChunk;\n+          previousBlockedChunk = null;\n+          blockedChunk.then(function () {\n+            return controller.error(error);\n+          });\n+        }\n     }\n   });\n   return type;\n@@ -2959,6 +2943,8 @@ function createIterator(next) {\n }\n function parseAsyncIterable(response, reference, iterator) {\n   reference = parseInt(reference.slice(2), 16);\n+  if (response._chunks.has(reference))\n+    throw Error(\"Already initialized stream.\");\n   var buffer = [],\n     closed = !1,\n     nextWriteIndex = 0,\n@@ -3002,36 +2988,46 @@ function parseAsyncIterable(response, reference, iterator) {\n       nextWriteIndex++;\n     },\n     close: function (value) {\n-      closed = !0;\n-      nextWriteIndex === buffer.length\n-        ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-            response,\n-            value,\n-            !0\n-          ))\n-        : resolveIteratorResultChunk(\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length\n+              ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                  response,\n+                  value,\n+                  !0\n+                ))\n+              : resolveIteratorResultChunk(\n+                  response,\n+                  buffer[nextWriteIndex],\n+                  value,\n+                  !0\n+                ),\n+            nextWriteIndex++;\n+          nextWriteIndex < buffer.length;\n+\n+        )\n+          resolveIteratorResultChunk(\n             response,\n-            buffer[nextWriteIndex],\n-            value,\n+            buffer[nextWriteIndex++],\n+            '\"$undefined\"',\n             !0\n           );\n-      for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-        resolveIteratorResultChunk(\n-          response,\n-          buffer[nextWriteIndex++],\n-          '\"$undefined\"',\n-          !0\n-        );\n     },\n     error: function (error) {\n-      closed = !0;\n-      for (\n-        nextWriteIndex === buffer.length &&\n-        (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-        nextWriteIndex < buffer.length;\n+      if (!closed)\n+        for (\n+          closed = !0,\n+            nextWriteIndex === buffer.length &&\n+              (buffer[nextWriteIndex] = new ReactPromise(\n+                \"pending\",\n+                null,\n+                null\n+              ));\n+          nextWriteIndex < buffer.length;\n \n-      )\n-        triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+        )\n+          triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n     }\n   });\n   return iterator;\n@@ -3043,7 +3039,7 @@ function parseModelString(response, obj, key, value, reference) {\n         return value.slice(1);\n       case \"@\":\n         return (obj = parseInt(value.slice(2), 16)), getChunk(response, obj);\n-      case \"F\":\n+      case \"h\":\n         return (\n           (value = value.slice(2)),\n           getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -3304,7 +3300,8 @@ exports.registerServerReference = function (reference, id, exportName) {\n       configurable: !0\n     },\n     $$bound: { value: null, configurable: !0 },\n-    bind: { value: bind, configurable: !0 }\n+    bind: { value: bind, configurable: !0 },\n+    toString: serverReferenceToString\n   });\n };\n exports.renderToReadableStream = function (model, webpackMap, options) {"
        },
        {
            "sha": "ba7c2afd99c93ede3209ded147ea65f25aff2ec4",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-server.edge.development.js",
            "status": "modified",
            "additions": 176,
            "deletions": 180,
            "changes": 356,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073",
            "patch": "@@ -2210,7 +2210,7 @@\n     function serializeServerReference(request, serverReference) {\n       var writtenServerReferences = request.writtenServerReferences,\n         existingId = writtenServerReferences.get(serverReference);\n-      if (void 0 !== existingId) return \"$F\" + existingId.toString(16);\n+      if (void 0 !== existingId) return \"$h\" + existingId.toString(16);\n       existingId = serverReference.$$bound;\n       existingId = null === existingId ? null : Promise.resolve(existingId);\n       var id = serverReference.$$id,\n@@ -2236,7 +2236,7 @@\n           : { id: id, bound: existingId };\n       request = outlineModel(request, existingId);\n       writtenServerReferences.set(serverReference, request);\n-      return \"$F\" + request.toString(16);\n+      return \"$h\" + request.toString(16);\n     }\n     function serializeLargeTextString(request, text) {\n       request.pendingChunks++;\n@@ -2632,7 +2632,7 @@\n         if (value instanceof Date) return \"$D\" + value.toJSON();\n         elementReference = getPrototypeOf(value);\n         if (\n-          elementReference !== ObjectPrototype &&\n+          elementReference !== ObjectPrototype$1 &&\n           (null === elementReference ||\n             null !== getPrototypeOf(elementReference))\n         )\n@@ -3243,7 +3243,7 @@\n           return serializeDebugBlob(request, value);\n         if (getIteratorFn(value)) return Array.from(value);\n         request = getPrototypeOf(value);\n-        if (request !== ObjectPrototype && null !== request) {\n+        if (request !== ObjectPrototype$1 && null !== request) {\n           counter = Object.create(null);\n           for (env in value)\n             if (hasOwnProperty.call(value, env) || isGetter(request, env))\n@@ -4212,6 +4212,7 @@\n               ((promiseValue = resolvedValue.value),\n               (resolvedValue.status = \"fulfilled\"),\n               (resolvedValue.value = handler.value),\n+              (resolvedValue.reason = null),\n               null !== promiseValue &&\n                 wakeChunk(response, promiseValue, handler.value)));\n         },\n@@ -4315,6 +4316,7 @@\n         }\n         chunk.status = \"fulfilled\";\n         chunk.value = value;\n+        chunk.reason = null;\n       } catch (error) {\n         (chunk.status = \"rejected\"), (chunk.reason = error);\n       } finally {\n@@ -4325,8 +4327,11 @@\n       response._closed = !0;\n       response._closedReason = error;\n       response._chunks.forEach(function (chunk) {\n-        \"pending\" === chunk.status &&\n-          triggerErrorOnChunk(response, chunk, error);\n+        \"pending\" === chunk.status\n+          ? triggerErrorOnChunk(response, chunk, error)\n+          : \"fulfilled\" === chunk.status &&\n+            null !== chunk.reason &&\n+            chunk.reason.error(error);\n       });\n     }\n     function getChunk(response, id) {\n@@ -4348,58 +4353,41 @@\n       return chunk;\n     }\n     function fulfillReference(response, reference, value) {\n-      for (\n-        var handler = reference.handler,\n-          parentObject = reference.parentObject,\n-          key = reference.key,\n-          map = reference.map,\n-          path = reference.path,\n-          i = 1;\n-        i < path.length;\n-        i++\n-      ) {\n-        for (; value instanceof ReactPromise; ) {\n-          switch (value.status) {\n-            case \"resolved_model\":\n-              initializeModelChunk(value);\n-          }\n-          switch (value.status) {\n-            case \"fulfilled\":\n-              value = value.value;\n-              continue;\n-            case \"blocked\":\n-            case \"pending\":\n-              path.splice(0, i - 1);\n-              null === value.value\n-                ? (value.value = [reference])\n-                : value.value.push(reference);\n-              null === value.reason\n-                ? (value.reason = [reference])\n-                : value.reason.push(reference);\n-              return;\n-            default:\n-              rejectReference(response, reference.handler, value.reason);\n-              return;\n-          }\n+      var handler = reference.handler,\n+        parentObject = reference.parentObject,\n+        key = reference.key,\n+        map = reference.map,\n+        path = reference.path;\n+      try {\n+        for (var i = 1; i < path.length; i++) {\n+          var name = path[i];\n+          if (\n+            \"object\" !== typeof value ||\n+            null === value ||\n+            (getPrototypeOf(value) !== ObjectPrototype &&\n+              getPrototypeOf(value) !== ArrayPrototype) ||\n+            !hasOwnProperty.call(value, name)\n+          )\n+            throw Error(\"Invalid reference.\");\n+          value = value[name];\n         }\n-        var name = path[i];\n-        \"object\" === typeof value &&\n-          hasOwnProperty.call(value, name) &&\n-          (value = value[name]);\n+        var mappedValue = map(response, value, parentObject, key);\n+        parentObject[key] = mappedValue;\n+        \"\" === key && null === handler.value && (handler.value = mappedValue);\n+      } catch (error) {\n+        rejectReference(response, reference.handler, error);\n+        return;\n       }\n-      reference = map(response, value, parentObject, key);\n-      parentObject[key] = reference;\n-      \"\" === key && null === handler.value && (handler.value = reference);\n       handler.deps--;\n       0 === handler.deps &&\n-        ((parentObject = handler.chunk),\n-        null !== parentObject &&\n-          \"blocked\" === parentObject.status &&\n-          ((key = parentObject.value),\n-          (parentObject.status = \"fulfilled\"),\n-          (parentObject.value = handler.value),\n-          (parentObject.reason = handler.reason),\n-          null !== key && wakeChunk(response, key, handler.value)));\n+        ((reference = handler.chunk),\n+        null !== reference &&\n+          \"blocked\" === reference.status &&\n+          ((value = reference.value),\n+          (reference.status = \"fulfilled\"),\n+          (reference.value = handler.value),\n+          (reference.reason = handler.reason),\n+          null !== value && wakeChunk(response, value, handler.value)));\n     }\n     function rejectReference(response, handler, error) {\n       handler.errored ||\n@@ -4411,33 +4399,6 @@\n           \"blocked\" === handler.status &&\n           triggerErrorOnChunk(response, handler, error));\n     }\n-    function waitForReference(\n-      referencedChunk,\n-      parentObject,\n-      key,\n-      response,\n-      map,\n-      path\n-    ) {\n-      initializingHandler\n-        ? ((response = initializingHandler), response.deps++)\n-        : (response = initializingHandler =\n-            { chunk: null, value: null, reason: null, deps: 1, errored: !1 });\n-      parentObject = {\n-        handler: response,\n-        parentObject: parentObject,\n-        key: key,\n-        map: map,\n-        path: path\n-      };\n-      null === referencedChunk.value\n-        ? (referencedChunk.value = [parentObject])\n-        : referencedChunk.value.push(parentObject);\n-      null === referencedChunk.reason\n-        ? (referencedChunk.reason = [parentObject])\n-        : referencedChunk.reason.push(parentObject);\n-      return null;\n-    }\n     function getOutlinedModel(response, reference, parentObject, key, map) {\n       reference = reference.split(\":\");\n       var id = parseInt(reference[0], 16);\n@@ -4448,59 +4409,47 @@\n       }\n       switch (id.status) {\n         case \"fulfilled\":\n-          var value = id.value;\n-          for (id = 1; id < reference.length; id++) {\n-            for (; value instanceof ReactPromise; ) {\n-              switch (value.status) {\n-                case \"resolved_model\":\n-                  initializeModelChunk(value);\n-              }\n-              switch (value.status) {\n-                case \"fulfilled\":\n-                  value = value.value;\n-                  break;\n-                case \"blocked\":\n-                case \"pending\":\n-                  return waitForReference(\n-                    value,\n-                    parentObject,\n-                    key,\n-                    response,\n-                    map,\n-                    reference.slice(id - 1)\n-                  );\n-                default:\n-                  return (\n-                    initializingHandler\n-                      ? ((initializingHandler.errored = !0),\n-                        (initializingHandler.value = null),\n-                        (initializingHandler.reason = value.reason))\n-                      : (initializingHandler = {\n-                          chunk: null,\n-                          value: null,\n-                          reason: value.reason,\n-                          deps: 0,\n-                          errored: !0\n-                        }),\n-                    null\n-                  );\n-              }\n-            }\n-            var name = reference[id];\n-            \"object\" === typeof value &&\n-              hasOwnProperty.call(value, name) &&\n-              (value = value[name]);\n+          id = id.value;\n+          for (var i = 1; i < reference.length; i++) {\n+            var name = reference[i];\n+            if (\n+              \"object\" !== typeof id ||\n+              null === id ||\n+              (getPrototypeOf(id) !== ObjectPrototype &&\n+                getPrototypeOf(id) !== ArrayPrototype) ||\n+              !hasOwnProperty.call(id, name)\n+            )\n+              throw Error(\"Invalid reference.\");\n+            id = id[name];\n           }\n-          return map(response, value, parentObject, key);\n+          return map(response, id, parentObject, key);\n         case \"pending\":\n         case \"blocked\":\n-          return waitForReference(\n-            id,\n-            parentObject,\n-            key,\n-            response,\n-            map,\n-            reference\n+          return (\n+            initializingHandler\n+              ? ((response = initializingHandler), response.deps++)\n+              : (response = initializingHandler =\n+                  {\n+                    chunk: null,\n+                    value: null,\n+                    reason: null,\n+                    deps: 1,\n+                    errored: !1\n+                  }),\n+            (parentObject = {\n+              handler: response,\n+              parentObject: parentObject,\n+              key: key,\n+              map: map,\n+              path: reference\n+            }),\n+            null === id.value\n+              ? (id.value = [parentObject])\n+              : id.value.push(parentObject),\n+            null === id.reason\n+              ? (id.reason = [parentObject])\n+              : id.reason.push(parentObject),\n+            null\n           );\n         default:\n           return (\n@@ -4540,9 +4489,10 @@\n       parentKey\n     ) {\n       reference = parseInt(reference.slice(2), 16);\n-      reference = response._formData\n-        .get(response._prefix + reference)\n-        .arrayBuffer();\n+      bytesPerElement = response._prefix + reference;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized typed array.\");\n+      reference = response._formData.get(bytesPerElement).arrayBuffer();\n       if (initializingHandler) {\n         var handler = initializingHandler;\n         handler.deps++;\n@@ -4571,6 +4521,7 @@\n             var resolveListeners = buffer.value;\n             buffer.status = \"fulfilled\";\n             buffer.value = handler.value;\n+            buffer.reason = null;\n             null !== resolveListeners &&\n               wakeChunk(response, resolveListeners, handler.value);\n           }\n@@ -4605,7 +4556,10 @@\n     }\n     function parseReadableStream(response, reference, type) {\n       reference = parseInt(reference.slice(2), 16);\n-      var controller = null;\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n+      var controller = null,\n+        closed = !1;\n       type = new ReadableStream({\n         type: type,\n         start: function (c) {\n@@ -4652,24 +4606,28 @@\n           }\n         },\n         close: function () {\n-          if (null === previousBlockedChunk) controller.close();\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.close();\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.close();\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.close();\n+              });\n+            }\n         },\n         error: function (error) {\n-          if (null === previousBlockedChunk) controller.error(error);\n-          else {\n-            var blockedChunk = previousBlockedChunk;\n-            previousBlockedChunk = null;\n-            blockedChunk.then(function () {\n-              return controller.error(error);\n-            });\n-          }\n+          if (!closed)\n+            if (((closed = !0), null === previousBlockedChunk))\n+              controller.error(error);\n+            else {\n+              var blockedChunk = previousBlockedChunk;\n+              previousBlockedChunk = null;\n+              blockedChunk.then(function () {\n+                return controller.error(error);\n+              });\n+            }\n         }\n       });\n       return type;\n@@ -4684,6 +4642,8 @@\n     }\n     function parseAsyncIterable(response, reference, iterator) {\n       reference = parseInt(reference.slice(2), 16);\n+      if (response._chunks.has(reference))\n+        throw Error(\"Already initialized stream.\");\n       var buffer = [],\n         closed = !1,\n         nextWriteIndex = 0,\n@@ -4724,36 +4684,46 @@\n           nextWriteIndex++;\n         },\n         close: function (value) {\n-          closed = !0;\n-          nextWriteIndex === buffer.length\n-            ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n-                response,\n-                value,\n-                !0\n-              ))\n-            : resolveIteratorResultChunk(\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length\n+                  ? (buffer[nextWriteIndex] = createResolvedIteratorResultChunk(\n+                      response,\n+                      value,\n+                      !0\n+                    ))\n+                  : resolveIteratorResultChunk(\n+                      response,\n+                      buffer[nextWriteIndex],\n+                      value,\n+                      !0\n+                    ),\n+                nextWriteIndex++;\n+              nextWriteIndex < buffer.length;\n+\n+            )\n+              resolveIteratorResultChunk(\n                 response,\n-                buffer[nextWriteIndex],\n-                value,\n+                buffer[nextWriteIndex++],\n+                '\"$undefined\"',\n                 !0\n               );\n-          for (nextWriteIndex++; nextWriteIndex < buffer.length; )\n-            resolveIteratorResultChunk(\n-              response,\n-              buffer[nextWriteIndex++],\n-              '\"$undefined\"',\n-              !0\n-            );\n         },\n         error: function (error) {\n-          closed = !0;\n-          for (\n-            nextWriteIndex === buffer.length &&\n-            (buffer[nextWriteIndex] = new ReactPromise(\"pending\", null, null));\n-            nextWriteIndex < buffer.length;\n+          if (!closed)\n+            for (\n+              closed = !0,\n+                nextWriteIndex === buffer.length &&\n+                  (buffer[nextWriteIndex] = new ReactPromise(\n+                    \"pending\",\n+                    null,\n+                    null\n+                  ));\n+              nextWriteIndex < buffer.length;\n \n-          )\n-            triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n+            )\n+              triggerErrorOnChunk(response, buffer[nextWriteIndex++], error);\n         }\n       });\n       return iterator;\n@@ -4767,7 +4737,7 @@\n             return (\n               (obj = parseInt(value.slice(2), 16)), getChunk(response, obj)\n             );\n-          case \"F\":\n+          case \"h\":\n             return (\n               (value = value.slice(2)),\n               getOutlinedModel(response, value, obj, key, loadServerReference$1)\n@@ -5049,6 +5019,13 @@\n       SERVER_REFERENCE_TAG = Symbol.for(\"react.server.reference\"),\n       FunctionBind = Function.prototype.bind,\n       ArraySlice = Array.prototype.slice,\n+      serverReferenceToString = {\n+        value: function () {\n+          return \"function () { [omitted code] }\";\n+        },\n+        configurable: !0,\n+        writable: !0\n+      },\n       PROMISE_PROTOTYPE = Promise.prototype,\n       deepProxyHandlers = {\n         get: function (target, name) {\n@@ -5426,7 +5403,7 @@\n       patchConsole(console, \"table\"),\n       patchConsole(console, \"trace\"),\n       patchConsole(console, \"warn\"));\n-    var ObjectPrototype = Object.prototype,\n+    var ObjectPrototype$1 = Object.prototype,\n       stringify = JSON.stringify,\n       ABORTING = 12,\n       CLOSED = 14,\n@@ -5456,7 +5433,23 @@\n       }\n       switch (this.status) {\n         case \"fulfilled\":\n-          \"function\" === typeof resolve && resolve(this.value);\n+          if (\"function\" === typeof resolve) {\n+            for (\n+              var inspectedValue = this.value;\n+              inspectedValue instanceof ReactPromise;\n+\n+            ) {\n+              if (inspectedValue === this) {\n+                \"function\" === typeof reject &&\n+                  reject(Error(\"Cannot have cyclic thenables.\"));\n+                return;\n+              }\n+              if (\"fulfilled\" === inspectedValue.status)\n+                inspectedValue = inspectedValue.value;\n+              else break;\n+            }\n+            resolve(this.value);\n+          }\n           break;\n         case \"pending\":\n         case \"blocked\":\n@@ -5471,7 +5464,9 @@\n           \"function\" === typeof reject && reject(this.reason);\n       }\n     };\n-    var initializingHandler = null;\n+    var ObjectPrototype = Object.prototype,\n+      ArrayPrototype = Array.prototype,\n+      initializingHandler = null;\n     exports.createClientModuleProxy = function (moduleId) {\n       moduleId = registerClientReferenceImpl({}, moduleId, !1);\n       return new Proxy(moduleId, proxyHandlers$1);\n@@ -5638,7 +5633,8 @@\n         },\n         $$bound: { value: null, configurable: !0 },\n         $$location: { value: Error(\"react-stack-top-frame\"), configurable: !0 },\n-        bind: { value: bind, configurable: !0 }\n+        bind: { value: bind, configurable: !0 },\n+        toString: serverReferenceToString\n       });\n     };\n     exports.renderToReadableStream = function (model, webpackMap, options) {"
        },
        {
            "sha": "34db42e8208f411aac4f48c63bfd39f926069336",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-server.edge.production.js",
            "status": "modified",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "a5fd073dd2fd7d329100855218b06b9139a059ce",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-server.node.development.js",
            "status": "modified",
            "additions": 179,
            "deletions": 183,
            "changes": 362,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "d4c11f02e8ddcaee01d9b81e3ceaba4a15b90a99",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/cjs/react-server-dom-webpack-server.node.production.js",
            "status": "modified",
            "additions": 172,
            "deletions": 175,
            "changes": 347,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fcjs%2Freact-server-dom-webpack-server.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "eea9597937a3b23f82452e88977cfce5a2686029",
            "filename": "packages/next/src/compiled/react-server-dom-webpack-experimental/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack-experimental%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "4c9e7f2018533c6aef37ec987a093d4f568756b2",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-client.browser.development.js",
            "status": "modified",
            "additions": 182,
            "deletions": 148,
            "changes": 330,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "4fe0afc4934c833877a6ea2419d4c3a4904f08b3",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-client.browser.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "f16b2625fbc7294a8dd720ef6289438f2133a1a8",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-client.edge.development.js",
            "status": "modified",
            "additions": 180,
            "deletions": 146,
            "changes": 326,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "1fed366e75cc04b85dad9d43f90ffdcbe526e2be",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-client.edge.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "c8d915ff6ff6532e866fce5cffcca52037e70ab0",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-client.node.development.js",
            "status": "modified",
            "additions": 180,
            "deletions": 146,
            "changes": 326,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "4b2cc78580ea12070d4387d890c97ea7abe62549",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-client.node.production.js",
            "status": "modified",
            "additions": 180,
            "deletions": 139,
            "changes": 319,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-client.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "78a5759d19f32541f114a166880716325e8f4bd9",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-server.browser.development.js",
            "status": "modified",
            "additions": 176,
            "deletions": 180,
            "changes": 356,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.browser.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.browser.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.browser.development.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "7d67ffcb7fed17cff37c88bd5c557e3a1a7d9546",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-server.browser.production.js",
            "status": "modified",
            "additions": 169,
            "deletions": 172,
            "changes": 341,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.browser.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.browser.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.browser.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "d72ee1229843b57192ece0efd9dcfc9c29f14c13",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-server.edge.development.js",
            "status": "modified",
            "additions": 176,
            "deletions": 180,
            "changes": 356,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.edge.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.edge.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.edge.development.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "eed2085d59306d2ea037be7e98231c948bfacd09",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-server.edge.production.js",
            "status": "modified",
            "additions": 169,
            "deletions": 172,
            "changes": 341,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.edge.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.edge.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.edge.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "012357a2bb67602ea8c457bbe02288b2d6591d45",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-server.node.development.js",
            "status": "modified",
            "additions": 179,
            "deletions": 183,
            "changes": 362,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.node.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.node.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.node.development.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "ca72129c7453fdca66faad7267a9b36a3b2232b9",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/cjs/react-server-dom-webpack-server.node.production.js",
            "status": "modified",
            "additions": 172,
            "deletions": 175,
            "changes": 347,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.node.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.node.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fcjs%2Freact-server-dom-webpack-server.node.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "b27806f16c611295f96dfc7230b2897204fd0607",
            "filename": "packages/next/src/compiled/react-server-dom-webpack/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact-server-dom-webpack%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "bad9ca990c05b62ff581ef52228bfe8bd1b4f961",
            "filename": "packages/next/src/compiled/react/cjs/react.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.development.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "d827fc133c80fa7d96972ed68286527a65deed87",
            "filename": "packages/next/src/compiled/react/cjs/react.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "1ed2037858ae72449690a442948ae965cc9f8cb3",
            "filename": "packages/next/src/compiled/react/cjs/react.react-server.development.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.react-server.development.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.react-server.development.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.react-server.development.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "a2cb1a2976276b58dd5944c5c32085579c6bbbb0",
            "filename": "packages/next/src/compiled/react/cjs/react.react-server.production.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.react-server.production.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.react-server.production.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Freact%2Fcjs%2Freact.react-server.production.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "d687b6d24b904fb66e73c8c07a555f0607faa8e0",
            "filename": "packages/next/src/compiled/unistore/unistore.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Funistore%2Funistore.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/packages%2Fnext%2Fsrc%2Fcompiled%2Funistore%2Funistore.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Funistore%2Funistore.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "265802cfb544b2dba6e7e2152db10e5d6303a8b0",
            "filename": "pnpm-lock.yaml",
            "status": "modified",
            "additions": 784,
            "deletions": 790,
            "changes": 1574,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/pnpm-lock.yaml",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/pnpm-lock.yaml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/pnpm-lock.yaml?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "2d2b3c3c753ada9a3b4513f07c0d3913ad536f48",
            "filename": "run-tests.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/run-tests.js",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/run-tests.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/run-tests.js?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "8f2e702c1875b35abc76e439873bbbbb6bb4dd01",
            "filename": "test/.stats-app/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/test%2F.stats-app%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/test%2F.stats-app%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2F.stats-app%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "2d6a268e7145520c56d169cf1249a809f01e18b2",
            "filename": "test/e2e/next-test/first-time-setup-js/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/test%2Fe2e%2Fnext-test%2Ffirst-time-setup-js%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/test%2Fe2e%2Fnext-test%2Ffirst-time-setup-js%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fnext-test%2Ffirst-time-setup-js%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "990158fa1f6c769e60855147b700f79ba9b0a8c7",
            "filename": "test/e2e/next-test/first-time-setup-ts/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/test%2Fe2e%2Fnext-test%2Ffirst-time-setup-ts%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/test%2Fe2e%2Fnext-test%2Ffirst-time-setup-ts%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fnext-test%2Ffirst-time-setup-ts%2Fpackage.json?ref=435000f40762ba472eca24345d085a20557f1073"
        },
        {
            "sha": "d82a8ddadcfac8190d1a50f3be5fb625272558c1",
            "filename": "test/lib/next-modes/base.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/435000f40762ba472eca24345d085a20557f1073/test%2Flib%2Fnext-modes%2Fbase.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/435000f40762ba472eca24345d085a20557f1073/test%2Flib%2Fnext-modes%2Fbase.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Flib%2Fnext-modes%2Fbase.ts?ref=435000f40762ba472eca24345d085a20557f1073"
        }
    ],
    "stats": {
        "total": 19359,
        "additions": 10033,
        "deletions": 9326
    }
}