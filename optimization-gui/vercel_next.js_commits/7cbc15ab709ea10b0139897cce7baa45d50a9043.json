{
    "author": "timneutkens",
    "message": "Turbopack Build: Fix conflicting page error (#79634)\n\n## What?\n\nImplements the missing part of the error to make the test pass.\n\nSmall difference between webpack/Turbopack is that Turbopack will spot\nthe conflict earlier and because of that errors earlier too, making the\npath still correct but shorter, not a problem in my opinion.\n\n---------\n\nCo-authored-by: Niklas Mischkulnig <4586894+mischnic@users.noreply.github.com>",
    "sha": "7cbc15ab709ea10b0139897cce7baa45d50a9043",
    "files": [
        {
            "sha": "4ed4de913c103a74a89baec3eca9dbeb4267af4c",
            "filename": "crates/next-core/src/app_structure.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/7cbc15ab709ea10b0139897cce7baa45d50a9043/crates%2Fnext-core%2Fsrc%2Fapp_structure.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7cbc15ab709ea10b0139897cce7baa45d50a9043/crates%2Fnext-core%2Fsrc%2Fapp_structure.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fapp_structure.rs?ref=7cbc15ab709ea10b0139897cce7baa45d50a9043",
            "patch": "@@ -767,6 +767,7 @@ fn directory_tree_to_entrypoints(\n #[turbo_tasks::value]\n struct DuplicateParallelRouteIssue {\n     app_dir: ResolvedVc<FileSystemPath>,\n+    previously_inserted_page: AppPage,\n     page: AppPage,\n }\n \n@@ -783,11 +784,17 @@ impl Issue for DuplicateParallelRouteIssue {\n     }\n \n     #[turbo_tasks::function]\n-    fn title(self: Vc<Self>) -> Vc<StyledString> {\n-        StyledString::Text(\n-            \"You cannot have two parallel pages that resolve to the same path.\".into(),\n+    async fn title(self: Vc<Self>) -> Result<Vc<StyledString>> {\n+        let this = self.await?;\n+        Ok(StyledString::Text(\n+            format!(\n+                \"You cannot have two parallel pages that resolve to the same path. Please check \\\n+                 {} and {}.\",\n+                this.previously_inserted_page, this.page\n+            )\n+            .into(),\n         )\n-        .cell()\n+        .cell())\n     }\n }\n \n@@ -826,6 +833,7 @@ async fn check_duplicate(\n             if prev != page_path {\n                 DuplicateParallelRouteIssue {\n                     app_dir: app_dir.to_resolved().await?,\n+                    previously_inserted_page: prev.clone(),\n                     page: loader_tree.page.clone(),\n                 }\n                 .resolved_cell()"
        },
        {
            "sha": "06f934b307270fa9b408fba37d1735c3923f8d79",
            "filename": "test/e2e/app-dir/conflicting-page-segments/conflicting-page-segments.test.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/7cbc15ab709ea10b0139897cce7baa45d50a9043/test%2Fe2e%2Fapp-dir%2Fconflicting-page-segments%2Fconflicting-page-segments.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7cbc15ab709ea10b0139897cce7baa45d50a9043/test%2Fe2e%2Fapp-dir%2Fconflicting-page-segments%2Fconflicting-page-segments.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fconflicting-page-segments%2Fconflicting-page-segments.test.ts?ref=7cbc15ab709ea10b0139897cce7baa45d50a9043",
            "patch": "@@ -1,5 +1,5 @@\n import { nextTestSetup } from 'e2e-utils'\n-import { check } from 'next-test-utils'\n+import { retry } from 'next-test-utils'\n \n describe('conflicting-page-segments', () => {\n   const { next, isNextDev, skipped } = nextTestSetup({\n@@ -25,10 +25,11 @@ describe('conflicting-page-segments', () => {\n     } else {\n       await expect(next.start()).rejects.toThrow('next build failed')\n \n-      await check(\n-        () => next.cliOutput,\n-        /You cannot have two parallel pages that resolve to the same path\\. Please check \\/\\(group-a\\)\\/page and \\/\\(group-b\\)\\/page\\./i\n-      )\n+      await retry(() => {\n+        expect(next.cliOutput).toMatch(\n+          /You cannot have two parallel pages that resolve to the same path\\. Please check \\/\\(group-a\\)(\\/page)? and \\/\\(group-b\\)(\\/page)?\\./i\n+        )\n+      })\n     }\n   })\n })"
        },
        {
            "sha": "db0ad69e42daa41ecc1f363d3686be1092ea5755",
            "filename": "test/turbopack-build-tests-manifest.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/7cbc15ab709ea10b0139897cce7baa45d50a9043/test%2Fturbopack-build-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/7cbc15ab709ea10b0139897cce7baa45d50a9043/test%2Fturbopack-build-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fturbopack-build-tests-manifest.json?ref=7cbc15ab709ea10b0139897cce7baa45d50a9043",
            "patch": "@@ -1641,10 +1641,10 @@\n     \"runtimeError\": false\n   },\n   \"test/e2e/app-dir/conflicting-page-segments/conflicting-page-segments.test.ts\": {\n-    \"passed\": [],\n-    \"failed\": [\n+    \"passed\": [\n       \"conflicting-page-segments should throw an error when a route groups causes a conflict with a parallel segment\"\n     ],\n+    \"failed\": [],\n     \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 20,
        "deletions": 11
    }
}