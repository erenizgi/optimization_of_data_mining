{
    "author": "lubieowoce",
    "message": "test: attempt to unflake useLinkStatus interrupted navigation test (#77969)\n\nThis test flaked for me here:\nhttps://github.com/vercel/next.js/actions/runs/14353556171/job/40239845657#step:33:678\n\nI suspect this is because \\[the assertion that the pending state should\ndisappear\\] sometimes runs too soon. I made it wait until the\nside-effect of clicking the \"debug mode\" button becomes visible before\nchecking if the pending state is gone. If this fix doesn't improve the\nsituation, it indicates a bug in `useLinkStatus`, because the pending\nstate is still hanging around for some reason.\n\n(i chose not to just wrap the assertion in a `retry()`, because we want\nto ensure that the indicator disappears immediately, not at some\nunspecified point in the future)",
    "sha": "cd5d0058ad3a52803a35636c644da1a230f0b016",
    "files": [
        {
            "sha": "893978e2b8a30f6e0a6b56c48f5869c929e49425",
            "filename": "test/e2e/use-link-status/index.test.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/cd5d0058ad3a52803a35636c644da1a230f0b016/test%2Fe2e%2Fuse-link-status%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/cd5d0058ad3a52803a35636c644da1a230f0b016/test%2Fe2e%2Fuse-link-status%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fuse-link-status%2Findex.test.ts?ref=cd5d0058ad3a52803a35636c644da1a230f0b016",
            "patch": "@@ -1,5 +1,5 @@\n import { nextTestSetup } from 'e2e-utils'\n-import { waitFor } from 'next-test-utils'\n+import { retry, waitFor } from 'next-test-utils'\n \n describe('useLinkStatus', () => {\n   const { next } = nextTestSetup({\n@@ -39,6 +39,13 @@ describe('useLinkStatus', () => {\n     // Trigger shallow routing by clicking debug mode button\n     await browser.elementById('enable-debug-btn').click()\n \n+    // Wait for the new render to commit to make sure that the navigation transition is interrupted\n+    await retry(async () => {\n+      expect(\n+        await browser.elementByCss('[data-testid=\"debug-mode\"]').text()\n+      ).toBe('Debug Mode Enabled')\n+    })\n+\n     // Pending state should be gone\n     const post1LoadingElements = await browser.elementsByCss('#post-1-loading')\n     expect(post1LoadingElements.length).toBe(0)"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 8,
        "deletions": 1
    }
}