{
    "author": "kdy1",
    "message": "fix(turbopack): Use comments instead of AST nodes for unreachables (#79703)\n\n### What?\n\nUse unreachable comments instead of AST nodes for statically analyzable unreachable AST nodes.\n\n### Why?\n\nIt causes fewer problems for Firefox and potentially reduces RSS.\n\n### How?\n\n - Closes PACK-3843\n - Closes #74185",
    "sha": "0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
    "files": [
        {
            "sha": "bd77f1da1c9d4889a2948494e9b506fe66673c64",
            "filename": "turbopack/crates/turbopack-ecmascript/src/code_gen.rs",
            "status": "modified",
            "additions": 21,
            "deletions": 5,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fcode_gen.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fcode_gen.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fcode_gen.rs?ref=0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
            "patch": "@@ -1,11 +1,14 @@\n use anyhow::Result;\n use serde::{Deserialize, Serialize};\n-use swc_core::ecma::{\n-    ast::{\n-        BlockStmt, CallExpr, Expr, Lit, MemberExpr, ModuleDecl, ModuleItem, Pat, Program, Prop,\n-        SimpleAssignTarget, Stmt, Str, SwitchCase,\n+use swc_core::{\n+    base::SwcComments,\n+    ecma::{\n+        ast::{\n+            BlockStmt, CallExpr, Expr, Lit, MemberExpr, ModuleDecl, ModuleItem, Pat, Program, Prop,\n+            SimpleAssignTarget, Stmt, Str, SwitchCase,\n+        },\n+        visit::AstParentKind,\n     },\n-    visit::AstParentKind,\n };\n use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, ResolvedVc, Vc, debug::ValueDebugFormat, trace::TraceRawVcs};\n@@ -41,6 +44,7 @@ pub struct CodeGeneration {\n     pub visitors: Vec<(Vec<AstParentKind>, Box<dyn AstModifier>)>,\n     pub hoisted_stmts: Vec<CodeGenerationHoistedStmt>,\n     pub early_hoisted_stmts: Vec<CodeGenerationHoistedStmt>,\n+    pub comments: Option<SwcComments>,\n }\n \n impl CodeGeneration {\n@@ -59,6 +63,18 @@ impl CodeGeneration {\n             visitors,\n             hoisted_stmts,\n             early_hoisted_stmts,\n+            ..Default::default()\n+        }\n+    }\n+\n+    pub fn visitors_with_comments(\n+        visitors: Vec<(Vec<AstParentKind>, Box<dyn AstModifier>)>,\n+        comments: SwcComments,\n+    ) -> Self {\n+        CodeGeneration {\n+            visitors,\n+            comments: Some(comments),\n+            ..Default::default()\n         }\n     }\n "
        },
        {
            "sha": "797219c0a07466234179833a4903958b15ed1752",
            "filename": "turbopack/crates/turbopack-ecmascript/src/lib.rs",
            "status": "modified",
            "additions": 142,
            "deletions": 6,
            "changes": 148,
            "blob_url": "https://github.com/vercel/next.js/blob/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs?ref=0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
            "patch": "@@ -50,7 +50,12 @@ pub use references::{AnalyzeEcmascriptModuleResult, TURBOPACK_HELPER};\n use serde::{Deserialize, Serialize};\n pub use static_code::StaticEcmascriptCode;\n use swc_core::{\n-    common::{DUMMY_SP, GLOBALS, Globals, Mark, SourceMap, comments::Comments, util::take::Take},\n+    base::SwcComments,\n+    common::{\n+        BytePos, DUMMY_SP, GLOBALS, Globals, Mark, SourceMap,\n+        comments::{Comment, Comments},\n+        util::take::Take,\n+    },\n     ecma::{\n         ast::{self, Expr, ModuleItem, Program, Script},\n         codegen::{Emitter, text_writer::JsWriter},\n@@ -956,6 +961,7 @@ struct CodeGenResult {\n     program: Program,\n     source_map: Arc<SourceMap>,\n     comments: Either<ImmutableComments, Arc<ImmutableComments>>,\n+    extra_comments: SwcComments,\n     is_esm: bool,\n     generate_source_map: bool,\n     original_source_map: Option<ResolvedVc<Box<dyn GenerateSourceMap>>>,\n@@ -965,14 +971,19 @@ async fn process_parse_result(\n     parsed: ResolvedVc<ParseResult>,\n     ident: Vc<AssetIdent>,\n     specified_module_type: SpecifiedModuleType,\n-    code_gens: Vec<CodeGeneration>,\n+    mut code_gens: Vec<CodeGeneration>,\n     generate_source_map: bool,\n     original_source_map: Option<ResolvedVc<Box<dyn GenerateSourceMap>>>,\n ) -> Result<CodeGenResult> {\n     let parsed = parsed.final_read_hint().await?;\n \n     Ok(match &*parsed {\n         ParseResult::Ok { .. } => {\n+            let extra_comments = SwcComments {\n+                leading: Default::default(),\n+                trailing: Default::default(),\n+            };\n+\n             // We need a mutable version of the AST. We try to avoid cloning it by unwrapping the\n             // ReadRef.\n             let mut parsed = ReadRef::try_unwrap(parsed);\n@@ -1017,12 +1028,31 @@ async fn process_parse_result(\n             let top_level_mark = eval_context.top_level_mark;\n             let is_esm = eval_context.is_esm(specified_module_type);\n \n-            process_content_with_code_gens(&mut program, globals, Some(top_level_mark), code_gens);\n+            process_content_with_code_gens(\n+                &mut program,\n+                globals,\n+                Some(top_level_mark),\n+                &mut code_gens,\n+            );\n+\n+            for comments in code_gens.iter_mut().flat_map(|cg| cg.comments.as_mut()) {\n+                let leading = Arc::unwrap_or_clone(take(&mut comments.leading));\n+                let trailing = Arc::unwrap_or_clone(take(&mut comments.trailing));\n+\n+                for (pos, v) in leading {\n+                    extra_comments.leading.entry(pos).or_default().extend(v);\n+                }\n+\n+                for (pos, v) in trailing {\n+                    extra_comments.trailing.entry(pos).or_default().extend(v);\n+                }\n+            }\n \n             CodeGenResult {\n                 program,\n                 source_map: source_map.clone(),\n                 comments,\n+                extra_comments,\n                 is_esm,\n                 generate_source_map,\n                 original_source_map,\n@@ -1052,6 +1082,7 @@ async fn process_parse_result(\n                 }),\n                 source_map: Arc::new(SourceMap::default()),\n                 comments: Either::Left(Default::default()),\n+                extra_comments: Default::default(),\n                 is_esm: false,\n                 generate_source_map: false,\n                 original_source_map: None,\n@@ -1076,6 +1107,7 @@ async fn process_parse_result(\n                 }),\n                 source_map: Arc::new(SourceMap::default()),\n                 comments: Either::Left(Default::default()),\n+                extra_comments: Default::default(),\n                 is_esm: false,\n                 generate_source_map: false,\n                 original_source_map: None,\n@@ -1089,6 +1121,7 @@ async fn emit_content(content: CodeGenResult) -> Result<Vc<EcmascriptModuleConte\n         program,\n         source_map,\n         comments,\n+        extra_comments,\n         is_esm,\n         generate_source_map,\n         original_source_map,\n@@ -1110,6 +1143,11 @@ async fn emit_content(content: CodeGenResult) -> Result<Vc<EcmascriptModuleConte\n             Either::Right(comments) => comments,\n         };\n \n+        let comments = MergedComments {\n+            baseline: comments,\n+            mutable: extra_comments,\n+        };\n+\n         let mut wr = JsWriter::new(\n             source_map.clone(),\n             \"\\n\",\n@@ -1121,7 +1159,7 @@ async fn emit_content(content: CodeGenResult) -> Result<Vc<EcmascriptModuleConte\n         let mut emitter = Emitter {\n             cfg: swc_core::ecma::codegen::Config::default(),\n             cm: source_map.clone(),\n-            comments: Some(&comments),\n+            comments: Some(&comments as &dyn Comments),\n             wr,\n         };\n \n@@ -1162,13 +1200,13 @@ fn process_content_with_code_gens(\n     program: &mut Program,\n     globals: &Globals,\n     top_level_mark: Option<Mark>,\n-    mut code_gens: Vec<CodeGeneration>,\n+    code_gens: &mut Vec<CodeGeneration>,\n ) {\n     let mut visitors = Vec::new();\n     let mut root_visitors = Vec::new();\n     let mut early_hoisted_stmts = FxIndexMap::default();\n     let mut hoisted_stmts = FxIndexMap::default();\n-    for code_gen in &mut code_gens {\n+    for code_gen in code_gens {\n         for CodeGenerationHoistedStmt { key, stmt } in code_gen.hoisted_stmts.drain(..) {\n             hoisted_stmts.entry(key).or_insert(stmt);\n         }\n@@ -1231,6 +1269,104 @@ fn process_content_with_code_gens(\n     };\n }\n \n+struct MergedComments<A, B>\n+where\n+    A: Comments,\n+    B: Comments,\n+{\n+    baseline: A,\n+    mutable: B,\n+}\n+\n+impl<A, B> Comments for MergedComments<A, B>\n+where\n+    A: Comments,\n+    B: Comments,\n+{\n+    fn add_leading(&self, pos: BytePos, cmt: Comment) {\n+        self.mutable.add_leading(pos, cmt);\n+    }\n+\n+    fn add_leading_comments(&self, pos: BytePos, comments: Vec<Comment>) {\n+        self.mutable.add_leading_comments(pos, comments);\n+    }\n+\n+    fn has_leading(&self, pos: BytePos) -> bool {\n+        self.baseline.has_leading(pos) || self.mutable.has_leading(pos)\n+    }\n+\n+    fn move_leading(&self, from: BytePos, to: BytePos) {\n+        self.baseline.move_leading(from, to);\n+        self.mutable.move_leading(from, to);\n+    }\n+\n+    fn take_leading(&self, pos: BytePos) -> Option<Vec<Comment>> {\n+        let (v1, v2) = (\n+            self.baseline.take_leading(pos),\n+            self.mutable.take_leading(pos),\n+        );\n+\n+        merge_option_vec(v1, v2)\n+    }\n+\n+    fn get_leading(&self, pos: BytePos) -> Option<Vec<Comment>> {\n+        let (v1, v2) = (\n+            self.baseline.get_leading(pos),\n+            self.mutable.get_leading(pos),\n+        );\n+\n+        merge_option_vec(v1, v2)\n+    }\n+\n+    fn add_trailing(&self, pos: BytePos, cmt: Comment) {\n+        self.mutable.add_trailing(pos, cmt);\n+    }\n+\n+    fn add_trailing_comments(&self, pos: BytePos, comments: Vec<Comment>) {\n+        self.mutable.add_trailing_comments(pos, comments);\n+    }\n+\n+    fn has_trailing(&self, pos: BytePos) -> bool {\n+        self.baseline.has_trailing(pos) || self.mutable.has_trailing(pos)\n+    }\n+\n+    fn move_trailing(&self, from: BytePos, to: BytePos) {\n+        self.baseline.move_trailing(from, to);\n+        self.mutable.move_trailing(from, to);\n+    }\n+\n+    fn take_trailing(&self, pos: BytePos) -> Option<Vec<Comment>> {\n+        let (v1, v2) = (\n+            self.baseline.take_trailing(pos),\n+            self.mutable.take_trailing(pos),\n+        );\n+\n+        merge_option_vec(v1, v2)\n+    }\n+\n+    fn get_trailing(&self, pos: BytePos) -> Option<Vec<Comment>> {\n+        let (v1, v2) = (\n+            self.baseline.get_trailing(pos),\n+            self.mutable.get_trailing(pos),\n+        );\n+\n+        merge_option_vec(v1, v2)\n+    }\n+\n+    fn add_pure_comment(&self, pos: BytePos) {\n+        self.mutable.add_pure_comment(pos);\n+    }\n+}\n+\n+fn merge_option_vec<T>(a: Option<Vec<T>>, b: Option<Vec<T>>) -> Option<Vec<T>> {\n+    match (a, b) {\n+        (Some(a), Some(b)) => Some(a.into_iter().chain(b).collect()),\n+        (Some(a), None) => Some(a),\n+        (None, Some(b)) => Some(b),\n+        (None, None) => None,\n+    }\n+}\n+\n pub fn register() {\n     turbo_tasks::register();\n     turbo_tasks_fs::register();"
        },
        {
            "sha": "081b60f769bc4e7738b7666e03e4eb0698cd3f2c",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/unreachable.rs",
            "status": "modified",
            "additions": 130,
            "deletions": 59,
            "changes": 189,
            "blob_url": "https://github.com/vercel/next.js/blob/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Funreachable.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Funreachable.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Funreachable.rs?ref=0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
            "patch": "@@ -1,14 +1,20 @@\n-use std::mem::take;\n+use std::{mem::take, sync::LazyLock};\n \n use anyhow::Result;\n use serde::{Deserialize, Serialize};\n use swc_core::{\n-    common::{Spanned, util::take::Take},\n+    atoms::Atom,\n+    base::SwcComments,\n+    common::{\n+        DUMMY_SP, Span, Spanned,\n+        comments::{Comment, CommentKind, Comments},\n+        util::take::Take,\n+    },\n     ecma::{\n         ast::{\n             ArrayPat, ArrowExpr, AssignPat, AssignPatProp, BindingIdent, BlockStmt, ClassDecl,\n-            Decl, FnDecl, Ident, KeyValuePatProp, ObjectPat, ObjectPatProp, Pat, RestPat, Stmt,\n-            VarDecl, VarDeclKind, VarDeclarator,\n+            Decl, EmptyStmt, Expr, FnDecl, Ident, KeyValuePatProp, Lit, ObjectPat, ObjectPatProp,\n+            Pat, RestPat, Stmt, Str, SwitchCase, VarDecl, VarDeclKind, VarDeclarator,\n         },\n         visit::{\n             AstParentKind, VisitMut, VisitMutWith,\n@@ -21,8 +27,7 @@ use turbo_tasks::{NonLocalValue, Vc, debug::ValueDebugFormat, trace::TraceRawVcs\n use turbopack_core::{chunk::ChunkingContext, module_graph::ModuleGraph};\n \n use crate::{\n-    code_gen::{CodeGen, CodeGeneration},\n-    create_visitor,\n+    code_gen::{AstModifier, CodeGen, CodeGeneration},\n     utils::AstPathRange,\n };\n \n@@ -32,6 +37,101 @@ pub struct Unreachable {\n     range: AstPathRange,\n }\n \n+static UNREACHABLE_ATOM: LazyLock<Atom> = LazyLock::new(|| \"TURBOPACK unreachable\".into());\n+\n+struct UnreachableModifier {\n+    comments: SwcComments,\n+}\n+\n+impl AstModifier for UnreachableModifier {\n+    fn visit_mut_expr(&self, node: &mut Expr) {\n+        // We use an AST node instead of a comment here because we need to replace it with a valid\n+        // JS expression anyway.\n+        let span = node.span();\n+\n+        *node = Expr::Lit(Lit::Str(Str {\n+            span,\n+            value: UNREACHABLE_ATOM.clone(),\n+            raw: None,\n+        }));\n+    }\n+\n+    fn visit_mut_stmt(&self, stmt: &mut Stmt) {\n+        let mut replacement = Vec::new();\n+\n+        let span = Span::dummy_with_cmt();\n+\n+        self.comments.add_leading(\n+            span.lo,\n+            Comment {\n+                kind: CommentKind::Line,\n+                span: DUMMY_SP,\n+                text: UNREACHABLE_ATOM.clone(),\n+            },\n+        );\n+\n+        stmt.visit_mut_with(&mut ExtractDeclarations {\n+            stmts: &mut replacement,\n+            in_nested_block_scope: false,\n+        });\n+\n+        if replacement.is_empty() {\n+            *stmt = Stmt::Empty(EmptyStmt { span });\n+            return;\n+        }\n+\n+        *stmt = Stmt::Block(BlockStmt {\n+            span,\n+            stmts: replacement,\n+            ..Default::default()\n+        });\n+    }\n+}\n+\n+struct UnreachableRangeModifier {\n+    comments: SwcComments,\n+    start_index: usize,\n+}\n+\n+impl AstModifier for UnreachableRangeModifier {\n+    fn visit_mut_block_stmt(&self, block: &mut BlockStmt) {\n+        self.replace(&mut block.stmts, self.start_index);\n+    }\n+\n+    fn visit_mut_switch_case(&self, case: &mut SwitchCase) {\n+        self.replace(&mut case.cons, self.start_index);\n+    }\n+}\n+\n+impl UnreachableRangeModifier {\n+    fn replace(&self, stmts: &mut Vec<Stmt>, start_index: usize) {\n+        if stmts.len() > start_index + 1 {\n+            let span = Span::dummy_with_cmt();\n+\n+            self.comments.add_leading(\n+                span.lo,\n+                Comment {\n+                    kind: CommentKind::Line,\n+                    span: DUMMY_SP,\n+                    text: UNREACHABLE_ATOM.clone(),\n+                },\n+            );\n+\n+            let unreachable_stmt = Stmt::Empty(EmptyStmt { span });\n+\n+            let unreachable = stmts\n+                .splice(start_index + 1.., [unreachable_stmt])\n+                .collect::<Vec<_>>();\n+            for mut stmt in unreachable {\n+                stmt.visit_mut_with(&mut ExtractDeclarations {\n+                    stmts,\n+                    in_nested_block_scope: false,\n+                });\n+            }\n+        }\n+    }\n+}\n+\n impl Unreachable {\n     pub fn new(range: AstPathRange) -> Self {\n         Unreachable { range }\n@@ -42,31 +142,15 @@ impl Unreachable {\n         _module_graph: Vc<ModuleGraph>,\n         _chunking_context: Vc<Box<dyn ChunkingContext>>,\n     ) -> Result<CodeGeneration> {\n+        let comments = SwcComments::default();\n+\n         let visitors = match &self.range {\n-            AstPathRange::Exact(path) => {\n-                [\n-                    // Unreachable might be used on Stmt or Expr\n-                    create_visitor!(exact path, visit_mut_expr(expr: &mut Expr) {\n-                        *expr = quote!(\"(\\\"TURBOPACK unreachable\\\", undefined)\" as Expr);\n-                    }),\n-                    create_visitor!(exact path, visit_mut_stmt(stmt: &mut Stmt) {\n-                        // TODO(WEB-553) walk ast to find all `var` declarations and keep them\n-                        // since they hoist out of the scope\n-                        let mut replacement = Vec::new();\n-                        replacement.push(quote!(\"\\\"TURBOPACK unreachable\\\";\" as Stmt));\n-                        stmt.visit_mut_with(&mut ExtractDeclarations {\n-                            stmts: &mut replacement,\n-                            in_nested_block_scope: false,\n-                        });\n-                        *stmt = Stmt::Block(BlockStmt {\n-                            span: stmt.span(),\n-                            stmts: replacement,\n-                            ..Default::default()\n-                        });\n-                    }),\n-                ]\n-                .into()\n-            }\n+            AstPathRange::Exact(path) => vec![(\n+                path.clone(),\n+                Box::new(UnreachableModifier {\n+                    comments: comments.clone(),\n+                }) as Box<dyn AstModifier>,\n+            )],\n             AstPathRange::StartAfter(path) => {\n                 let mut parent = &path[..];\n                 while !parent.is_empty()\n@@ -76,41 +160,28 @@ impl Unreachable {\n                 }\n                 if !parent.is_empty() {\n                     parent = &parent[0..parent.len() - 1];\n-                    fn replace(stmts: &mut Vec<Stmt>, start_index: usize) {\n-                        if stmts.len() > start_index + 1 {\n-                            let unreachable = stmts\n-                                .splice(\n-                                    start_index + 1..,\n-                                    [quote!(\"\\\"TURBOPACK unreachable\\\";\" as Stmt)].into_iter(),\n-                                )\n-                                .collect::<Vec<_>>();\n-                            for mut stmt in unreachable {\n-                                stmt.visit_mut_with(&mut ExtractDeclarations {\n-                                    stmts,\n-                                    in_nested_block_scope: false,\n-                                });\n-                            }\n-                        }\n-                    }\n+\n                     let (parent, [last]) = parent.split_at(parent.len() - 1) else {\n                         unreachable!();\n                     };\n                     if let &AstParentKind::BlockStmt(BlockStmtField::Stmts(start_index)) = last {\n-                        [\n-                            create_visitor!(exact parent, visit_mut_block_stmt(block: &mut BlockStmt) {\n-                                replace(&mut block.stmts, start_index);\n-                            }),\n-                        ]\n-                        .into()\n+                        vec![(\n+                            parent.to_vec(),\n+                            Box::new(UnreachableRangeModifier {\n+                                comments: comments.clone(),\n+                                start_index,\n+                            }) as Box<dyn AstModifier>,\n+                        )]\n                     } else if let &AstParentKind::SwitchCase(SwitchCaseField::Cons(start_index)) =\n                         last\n                     {\n-                        [\n-                            create_visitor!(exact parent, visit_mut_switch_case(case: &mut SwitchCase) {\n-                                replace(&mut case.cons, start_index);\n-                            }),\n-                        ]\n-                        .into()\n+                        vec![(\n+                            parent.to_vec(),\n+                            Box::new(UnreachableRangeModifier {\n+                                comments: comments.clone(),\n+                                start_index,\n+                            }) as Box<dyn AstModifier>,\n+                        )]\n                     } else {\n                         Vec::new()\n                     }\n@@ -120,7 +191,7 @@ impl Unreachable {\n             }\n         };\n \n-        Ok(CodeGeneration::visitors(visitors))\n+        Ok(CodeGeneration::visitors_with_comments(visitors, comments))\n     }\n }\n "
        },
        {
            "sha": "1c8fe0bb0cb22fd3e4cee29049b49ee8b27efc4c",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/output/4e721_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_4d74c0a3.js",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_4d74c0a3.js",
            "raw_url": "https://github.com/vercel/next.js/raw/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_4d74c0a3.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_4d74c0a3.js?ref=0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
            "patch": "@@ -16,17 +16,15 @@ console.log('A.VERY.LONG.DEFINED.VALUE');\n if (\"TURBOPACK compile-time truthy\", 1) {\n console.log('something');\n }\n-if (\"TURBOPACK compile-time falsy\", 0) {\n-\"TURBOPACK unreachable\";\n-}\n+if (\"TURBOPACK compile-time falsy\", 0) //TURBOPACK unreachable\n+;\n var p = process;\n console.log((\"TURBOPACK compile-time value\", JSON.parse('{\"test\":true}')));\n console.log((\"TURBOPACK compile-time value\", \"value\"));\n console.log((\"TURBOPACK compile-time value\", \"development\"));\n-if (\"TURBOPACK compile-time falsy\", 0) {\n-\"TURBOPACK unreachable\";\n-}\n-(\"TURBOPACK compile-time falsy\", 0) ? (\"TURBOPACK unreachable\", undefined) : console.log('development');\n+if (\"TURBOPACK compile-time falsy\", 0) //TURBOPACK unreachable\n+;\n+(\"TURBOPACK compile-time falsy\", 0) ? \"TURBOPACK unreachable\" : console.log('development');\n // TODO short-circuit is not implemented yet\n (\"TURBOPACK compile-time value\", \"development\") != 'production' && console.log('development');\n (\"TURBOPACK compile-time value\", \"development\") == 'production' && console.log('production');"
        },
        {
            "sha": "1d18f8bff548a76dec326c9e830cd3c1fed55c3e",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/output/4e721_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_4d74c0a3.js.map",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_4d74c0a3.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_4d74c0a3.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_4d74c0a3.js.map?ref=0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
            "patch": "@@ -2,5 +2,5 @@\n   \"version\": 3,\n   \"sources\": [],\n   \"sections\": [\n-    {\"offset\": {\"line\": 6, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/input/index.js\"],\"sourcesContent\":[\"if (DEFINED_VALUE) {\\n  console.log('DEFINED_VALUE')\\n}\\n\\nif (DEFINED_TRUE) {\\n  console.log('DEFINED_VALUE')\\n}\\n\\nif (A.VERY.LONG.DEFINED.VALUE) {\\n  console.log('A.VERY.LONG.DEFINED.VALUE')\\n}\\n\\nif (process.env.NODE_ENV) {\\n  console.log('something')\\n}\\n\\nif (process.env.NODE_ENV === 'production') {\\n  console.log('production')\\n}\\n\\nvar p = process\\n\\nconsole.log(A.VERY.LONG.DEFINED.VALUE)\\nconsole.log(DEFINED_VALUE)\\nconsole.log(p.env.NODE_ENV)\\n\\nif (p.env.NODE_ENV === 'production') {\\n  console.log('production')\\n}\\n\\np.env.NODE_ENV == 'production'\\n  ? console.log('production')\\n  : console.log('development')\\n\\n// TODO short-circuit is not implemented yet\\np.env.NODE_ENV != 'production' && console.log('development')\\np.env.NODE_ENV == 'production' && console.log('production')\\n\\nconsole.log(__dirname)\\n\"],\"names\":[],\"mappings\":\"AAAA,wCAAmB;AACjB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAkB;AAChB,QAAQ,GAAG,CAAC;AACd;AAEA,iEAA+B;AAC7B,QAAQ,GAAG,CAAC;AACd;AAEA,wCAA0B;AACxB,QAAQ,GAAG,CAAC;AACd;AAEA,uCAA2C;;AAE3C;AAEA,IAAI,IAAI;AAER,QAAQ,GAAG;AACX,QAAQ,GAAG;AACX,QAAQ,GAAG;AAEX,uCAAqC;;AAErC;AAEA,6EAEI,QAAQ,GAAG,CAAC;AAEhB,4CAA4C;AAC5C,mDAAkB,gBAAgB,QAAQ,GAAG,CAAC;AAC9C,mDAAkB,gBAAgB,QAAQ,GAAG,CAAC;AAE9C,QAAQ,GAAG\"}}]\n+    {\"offset\": {\"line\": 6, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/input/index.js\"],\"sourcesContent\":[\"if (DEFINED_VALUE) {\\n  console.log('DEFINED_VALUE')\\n}\\n\\nif (DEFINED_TRUE) {\\n  console.log('DEFINED_VALUE')\\n}\\n\\nif (A.VERY.LONG.DEFINED.VALUE) {\\n  console.log('A.VERY.LONG.DEFINED.VALUE')\\n}\\n\\nif (process.env.NODE_ENV) {\\n  console.log('something')\\n}\\n\\nif (process.env.NODE_ENV === 'production') {\\n  console.log('production')\\n}\\n\\nvar p = process\\n\\nconsole.log(A.VERY.LONG.DEFINED.VALUE)\\nconsole.log(DEFINED_VALUE)\\nconsole.log(p.env.NODE_ENV)\\n\\nif (p.env.NODE_ENV === 'production') {\\n  console.log('production')\\n}\\n\\np.env.NODE_ENV == 'production'\\n  ? console.log('production')\\n  : console.log('development')\\n\\n// TODO short-circuit is not implemented yet\\np.env.NODE_ENV != 'production' && console.log('development')\\np.env.NODE_ENV == 'production' && console.log('production')\\n\\nconsole.log(__dirname)\\n\"],\"names\":[],\"mappings\":\"AAAA,wCAAmB;AACjB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAkB;AAChB,QAAQ,GAAG,CAAC;AACd;AAEA,iEAA+B;AAC7B,QAAQ,GAAG,CAAC;AACd;AAEA,wCAA0B;AACxB,QAAQ,GAAG,CAAC;AACd;AAEA;;AAIA,IAAI,IAAI;AAER,QAAQ,GAAG;AACX,QAAQ,GAAG;AACX,QAAQ,GAAG;AAEX;;AAIA,sCACI,0BACA,QAAQ,GAAG,CAAC;AAEhB,4CAA4C;AAC5C,mDAAkB,gBAAgB,QAAQ,GAAG,CAAC;AAC9C,mDAAkB,gBAAgB,QAAQ,GAAG,CAAC;AAE9C,QAAQ,GAAG\"}}]\n }\n\\ No newline at end of file"
        },
        {
            "sha": "9277e570f439d71502c868375ed6818b4238ca75",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/output/4e721_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_82bbae08._.js",
            "status": "modified",
            "additions": 44,
            "deletions": 29,
            "changes": 73,
            "blob_url": "https://github.com/vercel/next.js/blob/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_82bbae08._.js",
            "raw_url": "https://github.com/vercel/next.js/raw/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_82bbae08._.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_82bbae08._.js?ref=0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
            "patch": "@@ -20,7 +20,8 @@ if (\"TURBOPACK compile-time truthy\", 1) {\n a1();\n return;\n }\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n var a3;\n function a4() {\n var a5;\n@@ -31,62 +32,68 @@ let a11;\n let a12, a15, a17, a18, a19;\n function a20() {\n return;\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n var a28;\n }\n function b() {\n if (\"TURBOPACK compile-time truthy\", 1) {\n b1();\n return;\n-} else {\n-\"TURBOPACK unreachable\";\n-}\n-\"TURBOPACK unreachable\";\n+} else //TURBOPACK unreachable\n+;\n+//TURBOPACK unreachable\n+;\n }\n function c() {\n if (\"TURBOPACK compile-time truthy\", 1) {\n return;\n }\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n function d() {\n if (\"TURBOPACK compile-time truthy\", 1) {\n return;\n-} else {\n-\"TURBOPACK unreachable\";\n-}\n-\"TURBOPACK unreachable\";\n+} else //TURBOPACK unreachable\n+;\n+//TURBOPACK unreachable\n+;\n }\n function e() {\n-if (\"TURBOPACK compile-time falsy\", 0) {\n-\"TURBOPACK unreachable\";\n-} else {\n+if (\"TURBOPACK compile-time falsy\", 0) //TURBOPACK unreachable\n+;\n+else {\n return;\n }\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n function f() {\n if (\"TURBOPACK compile-time falsy\", 0) {} else {\n return;\n }\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n function g() {\n-if (\"TURBOPACK compile-time falsy\", 0) {\n-\"TURBOPACK unreachable\";\n-} else {\n+if (\"TURBOPACK compile-time falsy\", 0) //TURBOPACK unreachable\n+;\n+else {\n g2();\n return;\n }\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n function h() {\n if (\"TURBOPACK compile-time falsy\", 0) {} else {\n h1();\n return;\n }\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n function i(j) {\n if (j < 1) return i1();\n@@ -105,7 +112,8 @@ k1();\n } catch (e) {\n k2();\n return;\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n } finally{\n k4();\n }\n@@ -119,28 +127,33 @@ l2();\n } finally{\n l3();\n return;\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n get m() {\n if (\"TURBOPACK compile-time truthy\", 1) {\n m1();\n return;\n }\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n set m(value) {\n m1();\n return m2();\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n n = ()=>{\n switch(42){\n case 1:\n n1();\n return;\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n case 2:\n n3();\n break;\n@@ -164,12 +177,14 @@ class C {\n constructor(){\n p1();\n return;\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n }\n p3();\n return;\n-\"TURBOPACK unreachable\";\n+//TURBOPACK unreachable\n+;\n }\n z1();\n return;"
        },
        {
            "sha": "4dd7f3dba02e3f3c45c177fc908fd7843c69f7a1",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/output/4e721_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_82bbae08._.js.map",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_82bbae08._.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_82bbae08._.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_82bbae08._.js.map?ref=0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
            "patch": "@@ -2,6 +2,6 @@\n   \"version\": 3,\n   \"sources\": [],\n   \"sections\": [\n-    {\"offset\": {\"line\": 5, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/input/module.js\"],\"sourcesContent\":[\"export function a() {\\n  if (true) {\\n    a1()\\n    return\\n  }\\n  a2()\\n  var a3 = 3\\n  function a4() {\\n    var a5\\n  }\\n  ;(function a6() {\\n    var a7\\n  })\\n  const a8 = () => {\\n    var a9\\n  }\\n  class a10 {}\\n  let a11 = 11\\n  let {\\n    a12 = 12,\\n    a14: {\\n      a15,\\n      a16: [a17, ...a18],\\n    },\\n    ...a19\\n  } = {}\\n  function a20() {\\n    return\\n    a21()\\n  }\\n  ;({\\n    get a22() {\\n      var a23\\n    },\\n    set a22(value) {\\n      var a24\\n    },\\n    a25() {\\n      var a26\\n    },\\n  })\\n  {\\n    let a27\\n    var a28\\n  }\\n}\\n\\nexport function b() {\\n  if (true) {\\n    b1()\\n    return\\n  } else {\\n    b2()\\n  }\\n  b3()\\n}\\n\\nexport function c() {\\n  if (true) {\\n    return\\n  }\\n  c1()\\n}\\n\\nexport function d() {\\n  if (true) {\\n    return\\n  } else {\\n    d1()\\n  }\\n  d2()\\n}\\n\\nexport function e() {\\n  if (false) {\\n    e1()\\n  } else {\\n    return\\n  }\\n  e2()\\n}\\n\\nexport function f() {\\n  if (false) {\\n  } else {\\n    return\\n  }\\n  f1()\\n}\\n\\nexport function g() {\\n  if (false) {\\n    g1()\\n  } else {\\n    g2()\\n    return\\n  }\\n  g3()\\n}\\n\\nexport function h() {\\n  if (false) {\\n  } else {\\n    h1()\\n    return\\n  }\\n  h2()\\n}\\n\\nexport function i(j) {\\n  if (j < 1) return i1()\\n  return i2()\\n}\\n\\nexport function j(j) {\\n  if (j < 1) {\\n    return i1()\\n  }\\n  return i2()\\n}\\n\\nclass K {\\n  constructor() {\\n    try {\\n      k1()\\n    } catch (e) {\\n      k2()\\n      return\\n      k3()\\n    } finally {\\n      k4()\\n    }\\n    k5()\\n  }\\n\\n  l() {\\n    try {\\n      l1()\\n    } catch (e) {\\n      l2()\\n    } finally {\\n      l3()\\n      return\\n      l4()\\n    }\\n    l5()\\n  }\\n\\n  get m() {\\n    if (true) {\\n      m1()\\n      return\\n    }\\n    m2()\\n  }\\n\\n  set m(value) {\\n    m1()\\n    return m2()\\n    m3()\\n  }\\n\\n  n = () => {\\n    switch (42) {\\n      case 1:\\n        n1()\\n        return\\n        n2()\\n      case 2:\\n        n3()\\n        break\\n      default:\\n        n4()\\n    }\\n    n5()\\n  }\\n\\n  o() {\\n    if (something) {\\n      require('./module')\\n      return\\n    } else {\\n      require('./module')\\n      return\\n    }\\n  }\\n}\\n\\nfunction p() {\\n  class C {\\n    constructor() {\\n      p1()\\n      return\\n      p2()\\n    }\\n  }\\n\\n  p3()\\n  return\\n  p4()\\n}\\n\\nz1()\\n\\nreturn\\n\\nz2()\\n\"],\"names\":[],\"mappings\":\";;;;;;;;;;;;AAAO,SAAS;AACd,wCAAU;AACR;AACA;AACF;;AAEA,IAAI;AACJ,SAAS;AACP,IAAI;AACN;AAIA,MAAM;AAGA,IAAA;AACN,IAAI;AACJ,IACE,KAEE,KACM,KAAQ,KAEb;AAEL,SAAS;AACP;;AAEF;AAcE,IAAI;AAER;AAEO,SAAS;AACd,wCAAU;AACR;AACA;AACF,OAAO;;AAEP;;AAEF;AAEO,SAAS;AACd,wCAAU;AACR;AACF;;AAEF;AAEO,SAAS;AACd,wCAAU;AACR;AACF,OAAO;;AAEP;;AAEF;AAEO,SAAS;AACd,uCAAW;;AAEX,OAAO;AACL;AACF;;AAEF;AAEO,SAAS;AACd,uCAAW,CACX,OAAO;AACL;AACF;;AAEF;AAEO,SAAS;AACd,uCAAW;;AAEX,OAAO;AACL;AACA;AACF;;AAEF;AAEO,SAAS;AACd,uCAAW,CACX,OAAO;AACL;AACA;AACF;;AAEF;AAEO,SAAS,EAAE,CAAC;AACjB,IAAI,IAAI,GAAG,OAAO;AAClB,OAAO;AACT;AAEO,SAAS,EAAE,CAAC;AACjB,IAAI,IAAI,GAAG;AACT,OAAO;AACT;AACA,OAAO;AACT;AAEA,MAAM;AACJ,aAAc;AACZ,IAAI;AACF;AACF,EAAE,OAAO,GAAG;AACV;AACA;;AAEF,SAAU;AACR;AACF;AACA;AACF;AAEA,IAAI;AACF,IAAI;AACF;AACF,EAAE,OAAO,GAAG;AACV;AACF,SAAU;AACR;AACA;;AAEF;;AAEF;AAEA,IAAI,IAAI;AACN,wCAAU;AACR;AACA;AACF;;AAEF;AAEA,IAAI,EAAE,KAAK,EAAE;AACX;AACA,OAAO;;AAET;AAEA,IAAI;AACF,OAAQ;AACN,KAAK;AACH;AACA;;AAEF,KAAK;AACH;AACA;AACF;AACE;AACJ;AACA;AACF,EAAC;AAED,IAAI;AACF,IAAI,WAAW;;AAEb;AACF,OAAO;;AAEL;AACF;AACF;AACF;AAEA,SAAS;AACP,MAAM;AACJ,aAAc;AACZ;AACA;;AAEF;AACF;AAEA;AACA;;AAEF;AAEA;AAEA;AAEA\"}},\n-    {\"offset\": {\"line\": 180, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/input/index.js\"],\"sourcesContent\":[\"import * as module from './module'\\nconsole.log(module)\\n\"],\"names\":[],\"mappings\":\";AAAA;;AACA,QAAQ,GAAG,CAAC\"}}]\n+    {\"offset\": {\"line\": 5, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/input/module.js\"],\"sourcesContent\":[\"export function a() {\\n  if (true) {\\n    a1()\\n    return\\n  }\\n  a2()\\n  var a3 = 3\\n  function a4() {\\n    var a5\\n  }\\n  ;(function a6() {\\n    var a7\\n  })\\n  const a8 = () => {\\n    var a9\\n  }\\n  class a10 {}\\n  let a11 = 11\\n  let {\\n    a12 = 12,\\n    a14: {\\n      a15,\\n      a16: [a17, ...a18],\\n    },\\n    ...a19\\n  } = {}\\n  function a20() {\\n    return\\n    a21()\\n  }\\n  ;({\\n    get a22() {\\n      var a23\\n    },\\n    set a22(value) {\\n      var a24\\n    },\\n    a25() {\\n      var a26\\n    },\\n  })\\n  {\\n    let a27\\n    var a28\\n  }\\n}\\n\\nexport function b() {\\n  if (true) {\\n    b1()\\n    return\\n  } else {\\n    b2()\\n  }\\n  b3()\\n}\\n\\nexport function c() {\\n  if (true) {\\n    return\\n  }\\n  c1()\\n}\\n\\nexport function d() {\\n  if (true) {\\n    return\\n  } else {\\n    d1()\\n  }\\n  d2()\\n}\\n\\nexport function e() {\\n  if (false) {\\n    e1()\\n  } else {\\n    return\\n  }\\n  e2()\\n}\\n\\nexport function f() {\\n  if (false) {\\n  } else {\\n    return\\n  }\\n  f1()\\n}\\n\\nexport function g() {\\n  if (false) {\\n    g1()\\n  } else {\\n    g2()\\n    return\\n  }\\n  g3()\\n}\\n\\nexport function h() {\\n  if (false) {\\n  } else {\\n    h1()\\n    return\\n  }\\n  h2()\\n}\\n\\nexport function i(j) {\\n  if (j < 1) return i1()\\n  return i2()\\n}\\n\\nexport function j(j) {\\n  if (j < 1) {\\n    return i1()\\n  }\\n  return i2()\\n}\\n\\nclass K {\\n  constructor() {\\n    try {\\n      k1()\\n    } catch (e) {\\n      k2()\\n      return\\n      k3()\\n    } finally {\\n      k4()\\n    }\\n    k5()\\n  }\\n\\n  l() {\\n    try {\\n      l1()\\n    } catch (e) {\\n      l2()\\n    } finally {\\n      l3()\\n      return\\n      l4()\\n    }\\n    l5()\\n  }\\n\\n  get m() {\\n    if (true) {\\n      m1()\\n      return\\n    }\\n    m2()\\n  }\\n\\n  set m(value) {\\n    m1()\\n    return m2()\\n    m3()\\n  }\\n\\n  n = () => {\\n    switch (42) {\\n      case 1:\\n        n1()\\n        return\\n        n2()\\n      case 2:\\n        n3()\\n        break\\n      default:\\n        n4()\\n    }\\n    n5()\\n  }\\n\\n  o() {\\n    if (something) {\\n      require('./module')\\n      return\\n    } else {\\n      require('./module')\\n      return\\n    }\\n  }\\n}\\n\\nfunction p() {\\n  class C {\\n    constructor() {\\n      p1()\\n      return\\n      p2()\\n    }\\n  }\\n\\n  p3()\\n  return\\n  p4()\\n}\\n\\nz1()\\n\\nreturn\\n\\nz2()\\n\"],\"names\":[],\"mappings\":\";;;;;;;;;;;;AAAO,SAAS;AACd,wCAAU;AACR;AACA;AACF;;;AAEA,IAAI;AACJ,SAAS;AACP,IAAI;AACN;AAIA,MAAM;AAGA,IAAA;AACN,IAAI;AACJ,IACE,KAEE,KACM,KAAQ,KAEb;AAEL,SAAS;AACP;;;AAEF;AAcE,IAAI;AAER;AAEO,SAAS;AACd,wCAAU;AACR;AACA;AACF;;;;AAIF;AAEO,SAAS;AACd,wCAAU;AACR;AACF;;;AAEF;AAEO,SAAS;AACd,wCAAU;AACR;AACF;;;;AAIF;AAEO,SAAS;AACd;;KAEO;AACL;AACF;;;AAEF;AAEO,SAAS;AACd,uCAAW,CACX,OAAO;AACL;AACF;;;AAEF;AAEO,SAAS;AACd;;KAEO;AACL;AACA;AACF;;;AAEF;AAEO,SAAS;AACd,uCAAW,CACX,OAAO;AACL;AACA;AACF;;;AAEF;AAEO,SAAS,EAAE,CAAC;AACjB,IAAI,IAAI,GAAG,OAAO;AAClB,OAAO;AACT;AAEO,SAAS,EAAE,CAAC;AACjB,IAAI,IAAI,GAAG;AACT,OAAO;AACT;AACA,OAAO;AACT;AAEA,MAAM;AACJ,aAAc;AACZ,IAAI;AACF;AACF,EAAE,OAAO,GAAG;AACV;AACA;;;AAEF,SAAU;AACR;AACF;AACA;AACF;AAEA,IAAI;AACF,IAAI;AACF;AACF,EAAE,OAAO,GAAG;AACV;AACF,SAAU;AACR;AACA;;;AAEF;;;AAEF;AAEA,IAAI,IAAI;AACN,wCAAU;AACR;AACA;AACF;;;AAEF;AAEA,IAAI,EAAE,KAAK,EAAE;AACX;AACA,OAAO;;;AAET;AAEA,IAAI;AACF,OAAQ;AACN,KAAK;AACH;AACA;;;AAEF,KAAK;AACH;AACA;AACF;AACE;AACJ;AACA;AACF,EAAC;AAED,IAAI;AACF,IAAI,WAAW;;AAEb;AACF,OAAO;;AAEL;AACF;AACF;AACF;AAEA,SAAS;AACP,MAAM;AACJ,aAAc;AACZ;AACA;;;AAEF;AACF;AAEA;AACA;;;AAEF;AAEA;AAEA;AAEA\"}},\n+    {\"offset\": {\"line\": 195, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/input/index.js\"],\"sourcesContent\":[\"import * as module from './module'\\nconsole.log(module)\\n\"],\"names\":[],\"mappings\":\";AAAA;;AACA,QAAQ,GAAG,CAAC\"}}]\n }\n\\ No newline at end of file"
        },
        {
            "sha": "779018553114ea6e93639f35f795e7713fb12fbf",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/tree-shaking/dce/output/turbopack_crates_turbopack-tests_tests_snapshot_tree-shaking_dce_input_d299a335._.js",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Ftree-shaking%2Fdce%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_tree-shaking_dce_input_d299a335._.js",
            "raw_url": "https://github.com/vercel/next.js/raw/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Ftree-shaking%2Fdce%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_tree-shaking_dce_input_d299a335._.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Ftree-shaking%2Fdce%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_tree-shaking_dce_input_d299a335._.js?ref=0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
            "patch": "@@ -12,9 +12,8 @@ __turbopack_context__.s({});\n __turbopack_context__.s({});\n var __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$tree$2d$shaking$2f$dce$2f$input$2f$module$2e$js__$5b$test$5d$__$28$ecmascript$29$__$3c$internal__part__3$3e$__ = __turbopack_context__.i(\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/tree-shaking/dce/input/module.js [test] (ecmascript) <internal part 3>\");\n ;\n-if (\"TURBOPACK compile-time falsy\", 0) {\n-\"TURBOPACK unreachable\";\n-}\n+if (\"TURBOPACK compile-time falsy\", 0) //TURBOPACK unreachable\n+;\n }),\n }]);\n "
        },
        {
            "sha": "68289b49ea016e183aa9080eb29fbf5f4b5b784a",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/tree-shaking/dce/output/turbopack_crates_turbopack-tests_tests_snapshot_tree-shaking_dce_input_d299a335._.js.map",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Ftree-shaking%2Fdce%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_tree-shaking_dce_input_d299a335._.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/0ee8d5c7a8210e802314a766b6f2115f4b3e80b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Ftree-shaking%2Fdce%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_tree-shaking_dce_input_d299a335._.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Ftree-shaking%2Fdce%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_tree-shaking_dce_input_d299a335._.js.map?ref=0ee8d5c7a8210e802314a766b6f2115f4b3e80b2",
            "patch": "@@ -3,5 +3,5 @@\n   \"sources\": [],\n   \"sections\": [\n     {\"offset\": {\"line\": 5, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\"}},\n-    {\"offset\": {\"line\": 11, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/tree-shaking/dce/input/index.js\"],\"sourcesContent\":[\"import { baz } from './module'\\n\\nif (1 + 1 == 3) {\\n  baz()\\n}\\n\"],\"names\":[],\"mappings\":\";AAAA;;AAEA,uCAAgB;;AAEhB\"}}]\n+    {\"offset\": {\"line\": 11, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/tree-shaking/dce/input/index.js\"],\"sourcesContent\":[\"import { baz } from './module'\\n\\nif (1 + 1 == 3) {\\n  baz()\\n}\\n\"],\"names\":[],\"mappings\":\";AAAA;;AAEA\"}}]\n }\n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 461,
        "additions": 348,
        "deletions": 113
    }
}