{
    "author": "mischnic",
    "message": "Turbopack: fix unused export removal with mixed reexport and locals (#81422)\n\nWe had this reference which caused all locals to be used:\r\n```\r\nnode_modules/@react-spring/core/dist/react-spring-core.esm.js [app-client] (ecmascript) <module evaluation>\r\n->\r\nnode_modules/@react-spring/core/dist/react-spring-core.esm.js [app-client] (ecmascript) <locals>\r\nwith\r\nexport_usage=all\r\n```\r\n\r\nSo for\r\n```js\r\nimport {config, useSpring} from \"@react-spring/core\";\r\n```\r\nthe output was\r\n```js\r\n\"[project]/node_modules/.pnpm/@react-spring+core@9.4.5_react@19.2.0-canary-fa3feba6-20250623/node_modules/@react-spring/core/dist/react-spring-core.esm.js [app-client] (ecmascript) <locals>\": ((__turbopack_context__) => {\r\n__turbopack_context__.s({\r\n    \"BailSignal\": ()=>BailSignal,\r\n    \"Controller\": ()=>Controller,\r\n    \"FrameValue\": ()=>FrameValue,\r\n    \"Interpolation\": ()=>Interpolation,\r\n    \"Spring\": ()=>Spring,\r\n    \"SpringContext\": ()=>SpringContext,\r\n    \"SpringRef\": ()=>SpringRef,\r\n    \"SpringValue\": ()=>SpringValue,\r\n    \"Trail\": ()=>Trail,\r\n    \"Transition\": ()=>Transition,\r\n    \"config\": ()=>config,\r\n    \"easings\": ()=>easings,\r\n    \"inferTo\": ()=>inferTo,\r\n    \"interpolate\": ()=>interpolate,\r\n    \"to\": ()=>to,\r\n    \"update\": ()=>update,\r\n    \"useChain\": ()=>useChain,\r\n    \"useSpring\": ()=>useSpring,\r\n    \"useSpringRef\": ()=>useSpringRef,\r\n    \"useSprings\": ()=>useSprings,\r\n    \"useTrail\": ()=>useTrail,\r\n    \"useTransition\": ()=>useTransition\r\n});\r\n```\r\ninstead of only listing the used exports\r\n```js\r\n\"[project]/node_modules/.pnpm/@react-spring+core@9.4.5_react@19.2.0-canary-fa3feba6-20250623/node_modules/@react-spring/core/dist/react-spring-core.esm.js [app-client] (ecmascript) <locals>\": ((__turbopack_context__) => {\r\n\"use strict\";\r\n\r\n__turbopack_context__.s({\r\n    \"config\": ()=>config,\r\n    \"useSpring\": ()=>useSpring\r\n});\r\n```",
    "sha": "6560ec279aaca9734df0f430800489319e1684b2",
    "files": [
        {
            "sha": "77051980b028a0c1377d03f174925588c1bc0bab",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/base.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbase.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbase.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbase.rs?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -559,8 +559,12 @@ impl EsmAssetReference {\n                         ));\n                     }\n \n-                    if merged_index.is_some() && this.export_name == Some(ModulePart::Evaluation) {\n-                        // No need to import to execution, the module was already inlined.\n+                    if merged_index.is_some()\n+                        && matches!(*self.export_usage().await?, ExportUsage::Evaluation)\n+                    {\n+                        // No need to import, the module was already executed and is available in\n+                        // the same scope hoisting group (unless it's a\n+                        // namespace import)\n                     } else {\n                         let ident = referenced_asset\n                             .get_ident("
        },
        {
            "sha": "c6e23fb4f4c34cb4e00bae6aee664a9c04a7a1e8",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/facade/module.rs",
            "status": "modified",
            "additions": 63,
            "deletions": 26,
            "changes": 89,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fmodule.rs?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -14,7 +14,7 @@ use turbopack_core::{\n     module::Module,\n     module_graph::ModuleGraph,\n     reference::ModuleReferences,\n-    resolve::ModulePart,\n+    resolve::{ExportUsage, ModulePart},\n };\n \n use super::chunk_item::EcmascriptModuleFacadeChunkItem;\n@@ -90,9 +90,13 @@ impl EcmascriptModuleFacadeModule {\n                 (\n                     result.esm_evaluation_references,\n                     vec![\n-                        EcmascriptModulePartReference::new_part(*self.module, ModulePart::locals())\n-                            .to_resolved()\n-                            .await?,\n+                        EcmascriptModulePartReference::new_part(\n+                            *self.module,\n+                            ModulePart::locals(),\n+                            ExportUsage::evaluation(),\n+                        )\n+                        .to_resolved()\n+                        .await?,\n                     ],\n                 )\n             }\n@@ -109,37 +113,59 @@ impl EcmascriptModuleFacadeModule {\n                 (\n                     result.esm_reexport_references,\n                     vec![\n-                        EcmascriptModulePartReference::new_part(*self.module, ModulePart::locals())\n-                            .to_resolved()\n-                            .await?,\n+                        EcmascriptModulePartReference::new_part(\n+                            *self.module,\n+                            ModulePart::locals(),\n+                            ExportUsage::all(),\n+                        )\n+                        .to_resolved()\n+                        .await?,\n                     ],\n                 )\n             }\n             ModulePart::Facade => (\n                 EsmAssetReferences::empty().to_resolved().await?,\n                 vec![\n-                    EcmascriptModulePartReference::new_part(*self.module, ModulePart::evaluation())\n-                        .to_resolved()\n-                        .await?,\n-                    EcmascriptModulePartReference::new_part(*self.module, ModulePart::exports())\n-                        .to_resolved()\n-                        .await?,\n+                    EcmascriptModulePartReference::new_part(\n+                        *self.module,\n+                        ModulePart::evaluation(),\n+                        ExportUsage::evaluation(),\n+                    )\n+                    .to_resolved()\n+                    .await?,\n+                    EcmascriptModulePartReference::new_part(\n+                        *self.module,\n+                        ModulePart::exports(),\n+                        ExportUsage::all(),\n+                    )\n+                    .to_resolved()\n+                    .await?,\n                 ],\n             ),\n             ModulePart::RenamedNamespace { .. } => (\n                 EsmAssetReferences::empty().to_resolved().await?,\n                 vec![\n-                    EcmascriptModulePartReference::new_normal(*self.module, self.part.clone())\n-                        .to_resolved()\n-                        .await?,\n+                    EcmascriptModulePartReference::new_normal(\n+                        *self.module,\n+                        self.part.clone(),\n+                        ExportUsage::all(),\n+                    )\n+                    .to_resolved()\n+                    .await?,\n                 ],\n             ),\n-            ModulePart::RenamedExport { .. } => (\n+            ModulePart::RenamedExport {\n+                original_export, ..\n+            } => (\n                 EsmAssetReferences::empty().to_resolved().await?,\n                 vec![\n-                    EcmascriptModulePartReference::new_normal(*self.module, self.part.clone())\n-                        .to_resolved()\n-                        .await?,\n+                    EcmascriptModulePartReference::new_normal(\n+                        *self.module,\n+                        self.part.clone(),\n+                        ExportUsage::named(original_export.clone()),\n+                    )\n+                    .to_resolved()\n+                    .await?,\n                 ],\n             ),\n             _ => {\n@@ -264,6 +290,7 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                                         EcmascriptModulePartReference::new_part(\n                                             *self.module,\n                                             ModulePart::locals(),\n+                                            ExportUsage::all(),\n                                         )\n                                         .to_resolved()\n                                         .await?,\n@@ -311,6 +338,7 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                                 EcmascriptModulePartReference::new_part(\n                                     *self.module,\n                                     ModulePart::exports(),\n+                                    ExportUsage::all(),\n                                 )\n                                 .to_resolved()\n                                 .await?,\n@@ -321,9 +349,13 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                     );\n                 }\n                 star_exports.push(ResolvedVc::upcast(\n-                    EcmascriptModulePartReference::new_part(*self.module, ModulePart::exports())\n-                        .to_resolved()\n-                        .await?,\n+                    EcmascriptModulePartReference::new_part(\n+                        *self.module,\n+                        ModulePart::exports(),\n+                        ExportUsage::all(),\n+                    )\n+                    .to_resolved()\n+                    .await?,\n                 ));\n             }\n             ModulePart::RenamedExport {\n@@ -337,6 +369,7 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                             EcmascriptModulePartReference::new_normal(\n                                 *self.module,\n                                 self.part.clone(),\n+                                ExportUsage::named(original_export.clone()),\n                             )\n                             .to_resolved()\n                             .await?,\n@@ -350,9 +383,13 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                 exports.insert(\n                     export.clone(),\n                     EsmExport::ImportedNamespace(ResolvedVc::upcast(\n-                        EcmascriptModulePartReference::new_normal(*self.module, self.part.clone())\n-                            .to_resolved()\n-                            .await?,\n+                        EcmascriptModulePartReference::new_normal(\n+                            *self.module,\n+                            self.part.clone(),\n+                            ExportUsage::all(),\n+                        )\n+                        .to_resolved()\n+                        .await?,\n                     )),\n                 );\n             }"
        },
        {
            "sha": "1f03534a5ecc373ed43f4dfe9fd435d51a8c7603",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/reference.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 11,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -41,6 +41,7 @@ enum EcmascriptModulePartReferenceMode {\n pub struct EcmascriptModulePartReference {\n     module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>,\n     part: ModulePart,\n+    export_usage: ResolvedVc<ExportUsage>,\n     mode: EcmascriptModulePartReferenceMode,\n }\n \n@@ -51,10 +52,12 @@ impl EcmascriptModulePartReference {\n     pub fn new_part(\n         module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>,\n         part: ModulePart,\n+        export_usage: ResolvedVc<ExportUsage>,\n     ) -> Vc<Self> {\n         EcmascriptModulePartReference {\n             module,\n             part,\n+            export_usage,\n             mode: EcmascriptModulePartReferenceMode::Synthesize,\n         }\n         .cell()\n@@ -65,10 +68,12 @@ impl EcmascriptModulePartReference {\n     pub fn new_normal(\n         module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>,\n         part: ModulePart,\n+        export_usage: ResolvedVc<ExportUsage>,\n     ) -> Vc<Self> {\n         EcmascriptModulePartReference {\n             module,\n             part,\n+            export_usage,\n             mode: EcmascriptModulePartReferenceMode::Normal,\n         }\n         .cell()\n@@ -135,14 +140,7 @@ impl ChunkableModuleReference for EcmascriptModulePartReference {\n \n     #[turbo_tasks::function]\n     fn export_usage(&self) -> Vc<ExportUsage> {\n-        match &self.part {\n-            ModulePart::Export(export) => ExportUsage::named(export.clone()),\n-            ModulePart::RenamedExport {\n-                original_export, ..\n-            } => ExportUsage::named(original_export.clone()),\n-            ModulePart::Evaluation => ExportUsage::evaluation(),\n-            _ => ExportUsage::all(),\n-        }\n+        *self.export_usage\n     }\n }\n \n@@ -152,9 +150,9 @@ impl EcmascriptModulePartReference {\n         chunking_context: Vc<Box<dyn ChunkingContext>>,\n         scope_hoisting_context: ScopeHoistingContext<'_>,\n     ) -> Result<CodeGeneration> {\n+        let this = self.await?;\n         let referenced_asset = ReferencedAsset::from_resolve_result(self.resolve_reference());\n         let referenced_asset = referenced_asset.await?;\n-        let part = &self.await?.part;\n \n         let ReferencedAsset::Some(module) = *referenced_asset else {\n             bail!(\"part module reference should have an module reference\");\n@@ -175,14 +173,14 @@ impl EcmascriptModulePartReference {\n             ));\n         }\n \n-        if merged_index.is_some() && part == &ModulePart::Evaluation {\n+        if merged_index.is_some() && matches!(*this.export_usage.await?, ExportUsage::Evaluation) {\n             // No need to import, the module was already executed and is available in the same scope\n             // hoisting group (unless it's a namespace import)\n         } else {\n             let ident = referenced_asset\n                 .get_ident(\n                     chunking_context,\n-                    match part {\n+                    match &this.part {\n                         ModulePart::Export(export)\n                         | ModulePart::RenamedExport {\n                             original_export: export,"
        },
        {
            "sha": "42785ac4d44451eb9187eeb3707e5d5aeeafdad2",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/index.js",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Findex.js?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -0,0 +1,3 @@\n+import { local } from 'lib'\n+\n+local()"
        },
        {
            "sha": "24ae290a860ea5644d511e07db56633240248b90",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Findex.js?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -0,0 +1,11 @@\n+export { unused } from './unused.js'\n+export * from './unused-star.js'\n+\n+function local() {\n+  console.log('This is a local function')\n+}\n+function localUnused() {\n+  console.log('This is a local unused function')\n+}\n+\n+export { local, localUnused }"
        },
        {
            "sha": "ca762dc5aee5524fa7650bb3e38e96f672e29ed8",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused-star.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Funused-star.js",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Funused-star.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Funused-star.js?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -0,0 +1 @@\n+export function unused() {}"
        },
        {
            "sha": "52dd3394848f42a4f2ee4738bed4a192d911b804",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Funused.js",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Funused.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Funused.js?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -0,0 +1 @@\n+export function unusedStar() {}"
        },
        {
            "sha": "d999101a4811c7a3ac2b5874bdbe48f10f31951d",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/options.json",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foptions.json",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foptions.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foptions.json?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -0,0 +1,4 @@\n+{\n+  \"treeShakingMode\": \"reexports-only\",\n+  \"removeUnusedExports\": true\n+}"
        },
        {
            "sha": "1d84e1fc2548704c9fafd56c566fe092ebc67f65",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/output/457d9_snapshot_intermediate-tree-shake_reexport-with-locals_input_index_ed1bdf14.js",
            "status": "added",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F457d9_snapshot_intermediate-tree-shake_reexport-with-locals_input_index_ed1bdf14.js",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F457d9_snapshot_intermediate-tree-shake_reexport-with-locals_input_index_ed1bdf14.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F457d9_snapshot_intermediate-tree-shake_reexport-with-locals_input_index_ed1bdf14.js?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -0,0 +1,6 @@\n+(globalThis.TURBOPACK = globalThis.TURBOPACK || []).push([\n+    \"output/457d9_snapshot_intermediate-tree-shake_reexport-with-locals_input_index_ed1bdf14.js\",\n+    {},\n+    {\"otherChunks\":[\"output/4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js\"],\"runtimeModuleIds\":[\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/index.js [test] (ecmascript)\"]}\n+]);\n+// Dummy runtime\n\\ No newline at end of file"
        },
        {
            "sha": "c15d7ec00382d3604310ddb8b53cbdb90d9e1942",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/output/457d9_snapshot_intermediate-tree-shake_reexport-with-locals_input_index_ed1bdf14.js.map",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F457d9_snapshot_intermediate-tree-shake_reexport-with-locals_input_index_ed1bdf14.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F457d9_snapshot_intermediate-tree-shake_reexport-with-locals_input_index_ed1bdf14.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F457d9_snapshot_intermediate-tree-shake_reexport-with-locals_input_index_ed1bdf14.js.map?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -0,0 +1,5 @@\n+{\n+  \"version\": 3,\n+  \"sources\": [],\n+  \"sections\": []\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "80f9ecb9692f47d95b7e44c7120eeb830364d773",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/output/4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js",
            "status": "added",
            "additions": 52,
            "deletions": 0,
            "changes": 52,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -0,0 +1,52 @@\n+(globalThis.TURBOPACK = globalThis.TURBOPACK || []).push([\"output/4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js\", {\n+\n+\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/index.js [test] (ecmascript)\": ((__turbopack_context__) => {\n+\"use strict\";\n+\n+__turbopack_context__.s({});\n+var __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$index$2e$js__$5b$test$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i(\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js [test] (ecmascript) <module evaluation>\");\n+var __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$index$2e$js__$5b$test$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i(\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js [test] (ecmascript) <locals>\");\n+;\n+(0, __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$index$2e$js__$5b$test$5d$__$28$ecmascript$29$__$3c$locals$3e$__[\"local\"])();\n+}),\n+\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused.js [test] (ecmascript)\": ((__turbopack_context__) => {\n+\"use strict\";\n+\n+__turbopack_context__.s({});\n+function unusedStar() {}\n+}),\n+\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused-star.js [test] (ecmascript)\": ((__turbopack_context__) => {\n+\"use strict\";\n+\n+__turbopack_context__.s({});\n+function unused() {}\n+}),\n+\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js [test] (ecmascript) <locals>\": ((__turbopack_context__) => {\n+\"use strict\";\n+\n+__turbopack_context__.s({\n+    \"local\": ()=>local\n+});\n+var __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$unused$2e$js__$5b$test$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused.js [test] (ecmascript)\");\n+var __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$unused$2d$star$2e$js__$5b$test$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused-star.js [test] (ecmascript)\");\n+;\n+;\n+function local() {\n+    console.log('This is a local function');\n+}\n+function localUnused() {\n+    console.log('This is a local unused function');\n+}\n+;\n+}),\n+\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js [test] (ecmascript) <module evaluation>\": ((__turbopack_context__) => {\n+\"use strict\";\n+\n+__turbopack_context__.s({});\n+var __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$unused$2e$js__$5b$test$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused.js [test] (ecmascript)\");\n+var __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$unused$2d$star$2e$js__$5b$test$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused-star.js [test] (ecmascript)\");\n+var __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$index$2e$js__$5b$test$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i(\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js [test] (ecmascript) <locals>\");\n+}),\n+}]);\n+\n+//# sourceMappingURL=4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js.map\n\\ No newline at end of file"
        },
        {
            "sha": "04c99ccca1ea1e1abd60cd14732b89afffe341e0",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/output/4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js.map",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/6560ec279aaca9734df0f430800489319e1684b2/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2F4c35f_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_6ca4cc64._.js.map?ref=6560ec279aaca9734df0f430800489319e1684b2",
            "patch": "@@ -0,0 +1,9 @@\n+{\n+  \"version\": 3,\n+  \"sources\": [],\n+  \"sections\": [\n+    {\"offset\": {\"line\": 5, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/index.js\"],\"sourcesContent\":[\"import { local } from 'lib'\\n\\nlocal()\\n\"],\"names\":[],\"mappings\":\";AAAA;AAAA;;AAEA,CAAA,GAAA,gRAAA,CAAA,QAAK,AAAD\"}},\n+    {\"offset\": {\"line\": 14, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused.js\"],\"sourcesContent\":[\"export function unusedStar() {}\\n\"],\"names\":[],\"mappings\":\";AAAO,SAAS,cAAc\",\"ignoreList\":[0]}},\n+    {\"offset\": {\"line\": 20, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused-star.js\"],\"sourcesContent\":[\"export function unused() {}\\n\"],\"names\":[],\"mappings\":\";AAAO,SAAS,UAAU\",\"ignoreList\":[0]}},\n+    {\"offset\": {\"line\": 26, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js\"],\"sourcesContent\":[\"export { unused } from './unused.js'\\nexport * from './unused-star.js'\\n\\nfunction local() {\\n  console.log('This is a local function')\\n}\\nfunction localUnused() {\\n  console.log('This is a local unused function')\\n}\\n\\nexport { local, localUnused }\\n\"],\"names\":[],\"mappings\":\";;;AAAA;AACA;;;AAEA,SAAS;IACP,QAAQ,GAAG,CAAC;AACd;AACA,SAAS;IACP,QAAQ,GAAG,CAAC;AACd\",\"ignoreList\":[0]}}]\n+}\n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 209,
        "additions": 170,
        "deletions": 39
    }
}