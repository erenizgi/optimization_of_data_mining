{
    "author": "timneutkens",
    "message": "Turbopack Build: Fix metadata dynamic force-dynamic (#80167)\n\n## What?\n\n`export const dynamic` was not being re-exported when creating the route\nhandler wrapper so it wasn't picked up during builds, causing the tests\nto fail. Added the re-exports.",
    "sha": "5736391cf6b697cf37cb5f72354389525eb7b851",
    "files": [
        {
            "sha": "62b10c509af5464e1b1486846f8449430c905eef",
            "filename": "crates/next-core/src/next_app/metadata/route.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/5736391cf6b697cf37cb5f72354389525eb7b851/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fmetadata%2Froute.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/5736391cf6b697cf37cb5f72354389525eb7b851/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fmetadata%2Froute.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fmetadata%2Froute.rs?ref=5736391cf6b697cf37cb5f72354389525eb7b851",
            "patch": "@@ -239,6 +239,8 @@ async fn dynamic_text_route_source(path: Vc<FileSystemPath>) -> Result<Vc<Box<dy\n                 }},\n               }})\n             }}\n+\n+            export * from {resource_path}\n         \"#,\n         resource_path = StringifyJs(&format!(\"./{stem}.{ext}\")),\n         content_type = StringifyJs(&content_type),\n@@ -330,6 +332,8 @@ async fn dynamic_site_map_route_source(\n                 }})\n             }}\n \n+            export * from {resource_path}\n+\n             {static_generation_code}\n         \"#,\n         resource_path = StringifyJs(&format!(\"./{stem}.{ext}\")),\n@@ -395,6 +399,8 @@ async fn dynamic_image_route_source(path: Vc<FileSystemPath>) -> Result<Vc<Box<d\n \n                 return handler({{ params: restParams, id }})\n             }}\n+\n+            export * from {resource_path}\n         \"#,\n         resource_path = StringifyJs(&format!(\"./{stem}.{ext}\")),\n     };"
        },
        {
            "sha": "547983dbf9a22f0eaf9c2d41d3d8bd0a3cd37a60",
            "filename": "test/turbopack-build-tests-manifest.json",
            "status": "modified",
            "additions": 6,
            "deletions": 8,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/5736391cf6b697cf37cb5f72354389525eb7b851/test%2Fturbopack-build-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/5736391cf6b697cf37cb5f72354389525eb7b851/test%2Fturbopack-build-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fturbopack-build-tests-manifest.json?ref=5736391cf6b697cf37cb5f72354389525eb7b851",
            "patch": "@@ -1949,11 +1949,10 @@\n   \"test/e2e/app-dir/dynamic-in-generate-params/index.test.ts\": {\n     \"passed\": [\n       \"app-dir - dynamic in generate params should be able to call fetch while generating multiple dynamic pages\",\n-      \"app-dir - dynamic in generate params should be able to call while generating multiple dynamic sitemaps\"\n-    ],\n-    \"failed\": [\n+      \"app-dir - dynamic in generate params should be able to call while generating multiple dynamic sitemaps\",\n       \"app-dir - dynamic in generate params should render sitemap with generateSitemaps in force-dynamic config dynamically\"\n     ],\n+    \"failed\": [],\n     \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false\n@@ -2974,11 +2973,10 @@\n       \"app dir - metadata dynamic routes social image routes should render og image with opengraph-image dynamic routes\",\n       \"app dir - metadata dynamic routes social image routes should render og image with twitter-image dynamic routes\",\n       \"app dir - metadata dynamic routes social image routes should support generate multi images with generateImageMetadata\",\n-      \"app dir - metadata dynamic routes social image routes should support params as argument in dynamic routes\"\n-    ],\n-    \"failed\": [\n+      \"app dir - metadata dynamic routes social image routes should support params as argument in dynamic routes\",\n       \"app dir - metadata dynamic routes route segment config should generate dynamic route if dynamic config is force-dynamic\"\n     ],\n+    \"failed\": [],\n     \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false\n@@ -18500,10 +18498,10 @@\n     \"runtimeError\": false\n   },\n   \"test/production/app-dir/metadata-revalidate/metadata-revalidate.test.ts\": {\n-    \"passed\": [],\n-    \"failed\": [\n+    \"passed\": [\n       \"app-dir - metadata-revalidate should contain the routes in prerender manifest\"\n     ],\n+    \"failed\": [],\n     \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 12,
        "deletions": 8
    }
}