{
    "author": "lukesandberg",
    "message": "[turbopack] Enable filesystem cache by default for development (#85975)\n\nEnable Turbopack filesystem cache for dev by default\n\nRemove the canary block on the option for builds, but that remains false by default",
    "sha": "de57f78924d7fd8c98bba84aa52c44b2d99cc5a5",
    "files": [
        {
            "sha": "69619b1ad7569b5d52a711c0a26ae5d90aed1d66",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/turbopackFileSystemCache.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FturbopackFileSystemCache.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FturbopackFileSystemCache.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FturbopackFileSystemCache.mdx?ref=de57f78924d7fd8c98bba84aa52c44b2d99cc5a5",
            "patch": "@@ -8,7 +8,7 @@ description: Learn how to enable FileSystem Caching for Turbopack builds\n \n Turbopack FileSystem Cache enables Turbopack to reduce work across `next dev` or `next build` commands. When enabled, Turbopack will save and restore data to the `.next` folder between builds, which can greatly speed up subsequent builds and dev sessions.\n \n-> **Good to know:** The FileSystem Cache feature is Beta and is still under development. Users adopting should expect some stability issues. We recommend first adopting it for development.\n+> **Good to know:** The FileSystem Cache feature is considered stable for development and experimental for production builds\n \n ```ts filename=\"next.config.ts\" switcher\n import type { NextConfig } from 'next'\n@@ -43,5 +43,6 @@ module.exports = nextConfig\n \n | Version   | Changes                                                        |\n | --------- | -------------------------------------------------------------- |\n+| `v16.1.0` | FileSystem caching is enabled by default for development       |\n | `v16.0.0` | Beta release with separate flags for build and dev             |\n | `v15.5.0` | Persistent caching released as experimental on canary releases |"
        },
        {
            "sha": "c6b03d2b67058f145cbcfc2617a52fb7bc12a951",
            "filename": "docs/01-app/03-api-reference/08-turbopack.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/docs%2F01-app%2F03-api-reference%2F08-turbopack.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/docs%2F01-app%2F03-api-reference%2F08-turbopack.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F08-turbopack.mdx?ref=de57f78924d7fd8c98bba84aa52c44b2d99cc5a5",
            "patch": "@@ -190,12 +190,12 @@ We are planning to offer an equivalent to the Inner Graph Optimization in Turbop\n \n ### Build Caching\n \n-Webpack supports [disk build caching](https://webpack.js.org/configuration/cache/#cache) to improve build performance. Turbopack provides a similar opt-in feature, currently in beta. Starting with Next 16, you can enable Turbopack’s filesystem cache by setting the following experimental flags:\n+Webpack supports [disk build caching](https://webpack.js.org/configuration/cache/#cache) to improve build performance. Turbopack provides a similar feature, currently in beta. Starting with Next 16, you can enable Turbopack’s filesystem cache by setting the following experimental flags:\n \n-- [`experimental.turbopackFileSystemCacheForDev`](/docs/app/api-reference/config/next-config-js/turbopackFileSystemCache)\n-- [`experimental.turbopackFileSystemCacheForBuild`](/docs/app/api-reference/config/next-config-js/turbopackFileSystemCache)\n+- [`experimental.turbopackFileSystemCacheForDev`](/docs/app/api-reference/config/next-config-js/turbopackFileSystemCache) is enabled by default\n+- [`experimental.turbopackFileSystemCacheForBuild`](/docs/app/api-reference/config/next-config-js/turbopackFileSystemCache) is currently opt-in\n \n-> **Good to know:** For this reason, when comparing webpack and Turbopack performance, make sure to delete the `.next` folder between builds to see a fair comparison or enable the turbopack filesystem cache feature.\n+> **Good to know:** For this reason, when comparing webpack and Turbopack performance, make sure to delete the `.next` folder between builds to see a fair cold build comparison or enable the turbopack filesystem cache feature to compare warm builds.\n \n ### Webpack plugins\n "
        },
        {
            "sha": "2ab022534090ee1975362ba8b18fe11c46b0658a",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=de57f78924d7fd8c98bba84aa52c44b2d99cc5a5",
            "patch": "@@ -428,12 +428,14 @@ export interface ExperimentalConfig {\n   /**\n    * Enable filesystem cache for the turbopack dev server.\n    *\n-   * Defaults to `true` in canary releases.\n+   * Defaults to `true`.\n    */\n   turbopackFileSystemCacheForDev?: boolean\n \n   /**\n    * Enable filesystem cache for the turbopack build.\n+   *\n+   * Defaults to `false`.\n    */\n   turbopackFileSystemCacheForBuild?: boolean\n \n@@ -1555,7 +1557,7 @@ export const defaultConfig = Object.freeze({\n     proxyClientMaxBodySize: 10_485_760, // 10MB\n     hideLogsAfterAbort: false,\n     mcpServer: true,\n-    turbopackFileSystemCacheForDev: !isStableBuild(),\n+    turbopackFileSystemCacheForDev: true,\n     turbopackFileSystemCacheForBuild: false,\n   },\n   htmlLimitedBots: undefined,"
        },
        {
            "sha": "6ba5362ceb5fa55f162252de8df24595855e7733",
            "filename": "packages/next/src/server/config.test.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 15,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.test.ts?ref=de57f78924d7fd8c98bba84aa52c44b2d99cc5a5",
            "patch": "@@ -95,22 +95,7 @@ describe('loadConfig', () => {\n         /`experimental\\.ppr` has been merged into `cacheComponents`/\n       )\n     })\n-\n-    it('errors when using persistentCachingForBuild if not in canary', async () => {\n-      await expect(\n-        loadConfig(PHASE_PRODUCTION_BUILD, __dirname, {\n-          customConfig: {\n-            experimental: {\n-              turbopackFileSystemCacheForBuild: true,\n-            },\n-          },\n-        })\n-      ).rejects.toThrow(\n-        /The experimental feature \"experimental.turbopackFileSystemCacheForBuild\" can only be enabled when using the latest canary version of Next.js./\n-      )\n-    })\n   })\n-\n   describe('with a canary version', () => {\n     beforeAll(() => {\n       process.env.__NEXT_VERSION = '15.4.0-canary.35'"
        },
        {
            "sha": "3aeefcc89b83e73717b4692198c6465bab1bd789",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 13,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de57f78924d7fd8c98bba84aa52c44b2d99cc5a5/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=de57f78924d7fd8c98bba84aa52c44b2d99cc5a5",
            "patch": "@@ -38,10 +38,6 @@ import { dset } from '../shared/lib/dset'\n import { normalizeZodErrors } from '../shared/lib/zod'\n import { HTML_LIMITED_BOT_UA_RE_STRING } from '../shared/lib/router/utils/is-bot'\n import { findDir } from '../lib/find-pages-dir'\n-import {\n-  CanaryOnlyConfigError,\n-  isStableBuild,\n-} from '../shared/lib/errors/canary-only-config-error'\n import { interopDefault } from '../lib/interop-default'\n import { djb2Hash } from '../shared/lib/hash'\n import type { NextAdapter } from '../build/adapter/build-complete'\n@@ -398,15 +394,6 @@ function assignDefaultsAndValidate(\n     )\n   }\n \n-  if (isStableBuild()) {\n-    // Prevents usage of certain experimental features outside of canary\n-    if (result.experimental.turbopackFileSystemCacheForBuild) {\n-      throw new CanaryOnlyConfigError({\n-        feature: 'experimental.turbopackFileSystemCacheForBuild',\n-      })\n-    }\n-  }\n-\n   if (result.experimental.ppr) {\n     throw new HardDeprecatedConfigError(\n       `\\`experimental.ppr\\` has been merged into \\`cacheComponents\\`. The Partial Prerendering feature is still available, but is now enabled via \\`cacheComponents\\`. Please update your ${configFileName} accordingly.`"
        }
    ],
    "stats": {
        "total": 45,
        "additions": 10,
        "deletions": 35
    }
}