{
    "author": "sokra",
    "message": "Turbopack: create smaller initial files to reduce memory usage (#78778)\n\n### What?\n\nLarge SST files lead to bigger memory usage as it accumulate entries for the SST file in memory. Creating smaller SST files flushes them more frequent and reduces in flight memory. Compaction will merge these smaller files to larger SST files during compaction.",
    "sha": "32893c7c802c2c2a64c4dd094fb1f6b65fa611f4",
    "files": [
        {
            "sha": "701b11918a265f4cbdd5266fa6afadd4c7f57a76",
            "filename": "turbopack/crates/turbo-persistence/src/constants.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/32893c7c802c2c2a64c4dd094fb1f6b65fa611f4/turbopack%2Fcrates%2Fturbo-persistence%2Fsrc%2Fconstants.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/32893c7c802c2c2a64c4dd094fb1f6b65fa611f4/turbopack%2Fcrates%2Fturbo-persistence%2Fsrc%2Fconstants.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-persistence%2Fsrc%2Fconstants.rs?ref=32893c7c802c2c2a64c4dd094fb1f6b65fa611f4",
            "patch": "@@ -6,13 +6,13 @@ pub const MAX_MEDIUM_VALUE_SIZE: usize = 64 * 1024 * 1024;\n pub const MAX_SMALL_VALUE_SIZE: usize = 64 * 1024 - 1;\n \n /// Maximum number of entries per SST file\n-pub const MAX_ENTRIES_PER_INITIAL_FILE: usize = 1024 * 1024;\n+pub const MAX_ENTRIES_PER_INITIAL_FILE: usize = 256 * 1024;\n \n /// Maximum number of entries per SST file\n pub const MAX_ENTRIES_PER_COMPACTED_FILE: usize = 1024 * 1024;\n \n /// Finish file when total amount of data exceeds this\n-pub const DATA_THRESHOLD_PER_INITIAL_FILE: usize = 256 * 1024 * 1024;\n+pub const DATA_THRESHOLD_PER_INITIAL_FILE: usize = 64 * 1024 * 1024;\n \n /// Finish file when total amount of data exceeds this\n pub const DATA_THRESHOLD_PER_COMPACTED_FILE: usize = 256 * 1024 * 1024;"
        },
        {
            "sha": "5e650b8ea1e04c2ab1375b37ebaa6a8d4e2b07da",
            "filename": "turbopack/crates/turbo-tasks-backend/src/database/turbo.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/32893c7c802c2c2a64c4dd094fb1f6b65fa611f4/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fdatabase%2Fturbo.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/32893c7c802c2c2a64c4dd094fb1f6b65fa611f4/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fdatabase%2Fturbo.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fdatabase%2Fturbo.rs?ref=32893c7c802c2c2a64c4dd094fb1f6b65fa611f4",
            "patch": "@@ -13,8 +13,8 @@ use crate::database::{\n     write_batch::{BaseWriteBatch, ConcurrentWriteBatch, WriteBatch, WriteBuffer},\n };\n \n-const COMPACT_MAX_COVERAGE: f32 = 10.0;\n-const COMPACT_MAX_MERGE_SEQUENCE: usize = 16;\n+const COMPACT_MAX_COVERAGE: f32 = 20.0;\n+const COMPACT_MAX_MERGE_SEQUENCE: usize = 64;\n const COMPACT_MAX_MERGE_SIZE: usize = 512 * 1024 * 1024; // 512 MiB\n \n pub struct TurboKeyValueDatabase {"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
    }
}