{
    "author": "eps1lon",
    "message": "[dev-overlay] Move app/pages related features closers together (#80280)\n\npages/ and app/ now have a designated \"setup\" file. Makes it easier to spot their differences.\r\n\r\nThe error handling would ideally be the same between App and Pages router but it's unlikely we'll have time porting the new App Router goodies with regards to error reporting to Pages Router.",
    "sha": "81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
    "files": [
        {
            "sha": "a0dd2ff58a0b4ca78e84cbee89eea6e964545d4e",
            "filename": "packages/next/src/client/app-index.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -1,8 +1,7 @@\n // imports polyfill from `@next/polyfill-module` after build.\n import '../build/polyfills/polyfill-module'\n \n-import './components/globals/patch-console'\n-import './components/globals/handle-global-errors'\n+import './components/react-dev-overlay/app/app-dev-overlay-setup'\n \n import ReactDOMClient from 'react-dom/client'\n import React, { use } from 'react'"
        },
        {
            "sha": "3c860184d6ca80554b2edefcc6b7749a17c4a716",
            "filename": "packages/next/src/client/app-next-dev.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fapp-next-dev.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fapp-next-dev.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fapp-next-dev.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -7,7 +7,7 @@ import { appBootstrap } from './app-bootstrap'\n import {\n   getComponentStack,\n   getOwnerStack,\n-} from './components/errors/stitched-error'\n+} from './components/react-dev-overlay/app/errors/stitched-error'\n import { isRecoverableError } from './react-client-callbacks/on-recoverable-error'\n \n // eslint-disable-next-line @next/internal/typechecked-require"
        },
        {
            "sha": "ca0956d52a5f968e30ec2c0a1b946fb7f50b33e4",
            "filename": "packages/next/src/client/app-next-turbopack.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fapp-next-turbopack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fapp-next-turbopack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fapp-next-turbopack.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -2,7 +2,7 @@ import { appBootstrap } from './app-bootstrap'\n import {\n   getComponentStack,\n   getOwnerStack,\n-} from './components/errors/stitched-error'\n+} from './components/react-dev-overlay/app/errors/stitched-error'\n import { isRecoverableError } from './react-client-callbacks/on-recoverable-error'\n \n window.next.version += '-turbo'"
        },
        {
            "sha": "691bd7674871006cd1390cec2429dc3e39846c68",
            "filename": "packages/next/src/client/components/globals/handle-global-errors.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/ea691aa555db0eeff30f2269fbcf45db4a1715a6/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fglobals%2Fhandle-global-errors.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ea691aa555db0eeff30f2269fbcf45db4a1715a6/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fglobals%2Fhandle-global-errors.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fglobals%2Fhandle-global-errors.ts?ref=ea691aa555db0eeff30f2269fbcf45db4a1715a6",
            "patch": "@@ -1,3 +0,0 @@\n-import { handleGlobalErrors } from '../errors/use-error-handler'\n-\n-handleGlobalErrors()"
        },
        {
            "sha": "c8f2ba7dca3270ecf568cb53581fc498d55085f9",
            "filename": "packages/next/src/client/components/globals/patch-console.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/ea691aa555db0eeff30f2269fbcf45db4a1715a6/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fglobals%2Fpatch-console.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ea691aa555db0eeff30f2269fbcf45db4a1715a6/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fglobals%2Fpatch-console.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fglobals%2Fpatch-console.ts?ref=ea691aa555db0eeff30f2269fbcf45db4a1715a6",
            "patch": "@@ -1,3 +0,0 @@\n-import { patchConsoleError } from './intercept-console-error'\n-\n-patchConsoleError()"
        },
        {
            "sha": "49e832601c20dd5dfa41625a2c4b7cdd7daf0d66",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/app-dev-overlay-error-boundary.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fapp-dev-overlay-error-boundary.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fapp-dev-overlay-error-boundary.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fapp-dev-overlay-error-boundary.tsx?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -1,6 +1,6 @@\n import { PureComponent } from 'react'\n import { dispatcher } from 'next/dist/compiled/next-devtools'\n-import { RuntimeErrorHandler } from '../../errors/runtime-error-handler'\n+import { RuntimeErrorHandler } from '../runtime-error-handler'\n import { ErrorBoundary } from '../../error-boundary'\n import DefaultGlobalError, {\n   type GlobalErrorComponent,"
        },
        {
            "sha": "a654770cb342c8066682587952376c9eaf2c04e7",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/app-dev-overlay-setup.ts",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fapp-dev-overlay-setup.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fapp-dev-overlay-setup.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fapp-dev-overlay-setup.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -0,0 +1,5 @@\n+import { patchConsoleError } from './errors/intercept-console-error'\n+import { handleGlobalErrors } from './errors/use-error-handler'\n+\n+handleGlobalErrors()\n+patchConsoleError()"
        },
        {
            "sha": "639d68c4394aee1da0d9de3da952e303e65c6515",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/errors/console-error.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fconsole-error.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fconsole-error.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fconsole-error.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "previous_filename": "packages/next/src/client/components/errors/console-error.ts"
        },
        {
            "sha": "67c888e8cb4219331c4292c75e2ebbc4826529c3",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/errors/intercept-console-error.ts",
            "status": "renamed",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fintercept-console-error.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fintercept-console-error.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fintercept-console-error.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -1,7 +1,7 @@\n-import isError from '../../../lib/is-error'\n-import { isNextRouterError } from '../is-next-router-error'\n-import { handleConsoleError } from '../errors/use-error-handler'\n-import { parseConsoleArgs } from '../../lib/console'\n+import isError from '../../../../../lib/is-error'\n+import { isNextRouterError } from '../../../is-next-router-error'\n+import { handleConsoleError } from './use-error-handler'\n+import { parseConsoleArgs } from '../../../../lib/console'\n \n export const originConsoleError = globalThis.console.error\n ",
            "previous_filename": "packages/next/src/client/components/globals/intercept-console-error.ts"
        },
        {
            "sha": "3dc7dea3f7fa9c3ee50976c0f0e3b03679ce4e25",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/errors/replay-ssr-only-errors.tsx",
            "status": "renamed",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Freplay-ssr-only-errors.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Freplay-ssr-only-errors.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Freplay-ssr-only-errors.tsx?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -1,7 +1,7 @@\n import { useEffect } from 'react'\n-import { handleClientError } from '../../errors/use-error-handler'\n-import { isNextRouterError } from '../../is-next-router-error'\n-import { MISSING_ROOT_TAGS_ERROR } from '../../../../shared/lib/errors/constants'\n+import { handleClientError } from './use-error-handler'\n+import { isNextRouterError } from '../../../is-next-router-error'\n+import { MISSING_ROOT_TAGS_ERROR } from '../../../../../shared/lib/errors/constants'\n \n function readSsrError(): (Error & { digest?: string }) | null {\n   if (typeof document === 'undefined') {",
            "previous_filename": "packages/next/src/client/components/react-dev-overlay/app/replay-ssr-only-errors.tsx"
        },
        {
            "sha": "53dac47ad7b23981dd1b2f46df96cda9b63350d2",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/errors/stitched-error.ts",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fstitched-error.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fstitched-error.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fstitched-error.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -1,5 +1,5 @@\n import React from 'react'\n-import isError from '../../../lib/is-error'\n+import isError from '../../../../../lib/is-error'\n \n const ownerStacks = new WeakMap<Error, string | null>()\n const componentStacks = new WeakMap<Error, string>()",
            "previous_filename": "packages/next/src/client/components/errors/stitched-error.ts"
        },
        {
            "sha": "2c82127bca0678baa195dfde9d6a08a31452cbcc",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/errors/use-error-handler.ts",
            "status": "renamed",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fuse-error-handler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fuse-error-handler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Ferrors%2Fuse-error-handler.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -1,9 +1,9 @@\n import { useEffect } from 'react'\n-import { isNextRouterError } from '../is-next-router-error'\n-import { formatConsoleArgs, parseConsoleArgs } from '../../lib/console'\n-import isError from '../../../lib/is-error'\n+import { isNextRouterError } from '../../../is-next-router-error'\n+import { formatConsoleArgs, parseConsoleArgs } from '../../../../lib/console'\n+import isError from '../../../../../lib/is-error'\n import { createConsoleError } from './console-error'\n-import { coerceError, setOwnerStackIfAvailable } from '../errors/stitched-error'\n+import { coerceError, setOwnerStackIfAvailable } from './stitched-error'\n \n const queueMicroTask =\n   globalThis.queueMicrotask || ((cb: () => void) => Promise.resolve().then(cb))",
            "previous_filename": "packages/next/src/client/components/errors/use-error-handler.ts"
        },
        {
            "sha": "6ead23620a061f1791874776f27d1f8119b99337",
            "filename": "packages/next/src/client/components/react-dev-overlay/pages/hooks.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 30,
            "changes": 30,
            "blob_url": "https://github.com/vercel/next.js/blob/ea691aa555db0eeff30f2269fbcf45db4a1715a6/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fhooks.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ea691aa555db0eeff30f2269fbcf45db4a1715a6/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fhooks.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fhooks.ts?ref=ea691aa555db0eeff30f2269fbcf45db4a1715a6",
            "patch": "@@ -1,30 +0,0 @@\n-import React from 'react'\n-import { Router } from '../../../router'\n-import { renderPagesDevOverlay } from 'next/dist/compiled/next-devtools'\n-import { getComponentStack, getOwnerStack } from '../../errors/stitched-error'\n-import { isRecoverableError } from '../../../react-client-callbacks/on-recoverable-error'\n-import { getSquashedHydrationErrorDetails } from './hydration-error-state'\n-\n-export const usePagesDevOverlayBridge = () => {\n-  React.useInsertionEffect(() => {\n-    // NDT uses a different React instance so it's not technically a state update\n-    // scheduled from useInsertionEffect.\n-    renderPagesDevOverlay(\n-      getComponentStack,\n-      getOwnerStack,\n-      getSquashedHydrationErrorDetails,\n-      isRecoverableError\n-    )\n-  }, [])\n-\n-  React.useEffect(() => {\n-    const { handleStaticIndicator } =\n-      require('../../../dev/hot-reloader/pages/hot-reloader-pages') as typeof import('../../../dev/hot-reloader/pages/hot-reloader-pages')\n-\n-    Router.events.on('routeChangeComplete', handleStaticIndicator)\n-\n-    return function () {\n-      Router.events.off('routeChangeComplete', handleStaticIndicator)\n-    }\n-  }, [])\n-}"
        },
        {
            "sha": "7882f0b6bdd645bbd3553c501a687df75cf108e0",
            "filename": "packages/next/src/client/components/react-dev-overlay/pages/pages-dev-overlay-bridge.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 18,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/ea691aa555db0eeff30f2269fbcf45db4a1715a6/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fpages-dev-overlay-bridge.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/ea691aa555db0eeff30f2269fbcf45db4a1715a6/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fpages-dev-overlay-bridge.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fpages-dev-overlay-bridge.tsx?ref=ea691aa555db0eeff30f2269fbcf45db4a1715a6",
            "patch": "@@ -1,18 +0,0 @@\n-import { PagesDevOverlayErrorBoundary } from './pages-dev-overlay-error-boundary'\n-import { usePagesDevOverlayBridge } from './hooks'\n-\n-export type ErrorType = 'runtime' | 'build'\n-\n-export type PagesDevOverlayBridgeType = typeof PagesDevOverlayBridge\n-\n-interface PagesDevOverlayBridgeProps {\n-  children?: React.ReactNode\n-}\n-\n-export function PagesDevOverlayBridge({\n-  children,\n-}: PagesDevOverlayBridgeProps) {\n-  usePagesDevOverlayBridge()\n-\n-  return <PagesDevOverlayErrorBoundary>{children}</PagesDevOverlayErrorBoundary>\n-}"
        },
        {
            "sha": "63475661aaef47b47eca6f54ecbc4a6349da2323",
            "filename": "packages/next/src/client/components/react-dev-overlay/pages/pages-dev-overlay-setup.tsx",
            "status": "renamed",
            "additions": 45,
            "deletions": 41,
            "changes": 86,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fpages-dev-overlay-setup.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fpages-dev-overlay-setup.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fpages-dev-overlay-setup.tsx?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -1,10 +1,53 @@\n+import React from 'react'\n+import { renderPagesDevOverlay } from 'next/dist/compiled/next-devtools'\n import { dispatcher } from 'next/dist/compiled/next-devtools'\n import {\n   attachHydrationErrorState,\n   storeHydrationErrorStateFromConsoleArgs,\n } from './hydration-error-state'\n-import type { VersionInfo } from '../../../../server/dev/parse-version-info'\n-import type { DevIndicatorServerState } from '../../../../server/dev/dev-indicator-server-state'\n+import { Router } from '../../../router'\n+import { getComponentStack, getOwnerStack } from '../app/errors/stitched-error'\n+import { isRecoverableError } from '../../../react-client-callbacks/on-recoverable-error'\n+import { getSquashedHydrationErrorDetails } from './hydration-error-state'\n+import { PagesDevOverlayErrorBoundary } from './pages-dev-overlay-error-boundary'\n+\n+const usePagesDevOverlayBridge = () => {\n+  React.useInsertionEffect(() => {\n+    // NDT uses a different React instance so it's not technically a state update\n+    // scheduled from useInsertionEffect.\n+    renderPagesDevOverlay(\n+      getComponentStack,\n+      getOwnerStack,\n+      getSquashedHydrationErrorDetails,\n+      isRecoverableError\n+    )\n+  }, [])\n+\n+  React.useEffect(() => {\n+    const { handleStaticIndicator } =\n+      require('../../../dev/hot-reloader/pages/hot-reloader-pages') as typeof import('../../../dev/hot-reloader/pages/hot-reloader-pages')\n+\n+    Router.events.on('routeChangeComplete', handleStaticIndicator)\n+\n+    return function () {\n+      Router.events.off('routeChangeComplete', handleStaticIndicator)\n+    }\n+  }, [])\n+}\n+\n+export type PagesDevOverlayBridgeType = typeof PagesDevOverlayBridge\n+\n+interface PagesDevOverlayBridgeProps {\n+  children?: React.ReactNode\n+}\n+\n+export function PagesDevOverlayBridge({\n+  children,\n+}: PagesDevOverlayBridgeProps) {\n+  usePagesDevOverlayBridge()\n+\n+  return <PagesDevOverlayErrorBoundary>{children}</PagesDevOverlayErrorBoundary>\n+}\n \n let isRegistered = false\n \n@@ -69,42 +112,3 @@ export function register() {\n   window.addEventListener('unhandledrejection', onUnhandledRejection)\n   window.console.error = nextJsHandleConsoleError\n }\n-\n-export function onBuildOk() {\n-  dispatcher.onBuildOk()\n-}\n-\n-export function onBuildError(message: string) {\n-  dispatcher.onBuildError(message)\n-}\n-\n-export function onRefresh() {\n-  dispatcher.onRefresh()\n-}\n-\n-export function onBeforeRefresh() {\n-  dispatcher.onBeforeRefresh()\n-}\n-\n-export function onVersionInfo(versionInfo: VersionInfo) {\n-  dispatcher.onVersionInfo(versionInfo)\n-}\n-\n-export function onStaticIndicator(isStatic: boolean) {\n-  dispatcher.onStaticIndicator(isStatic)\n-}\n-\n-export function onDevIndicator(devIndicatorsState: DevIndicatorServerState) {\n-  dispatcher.onDevIndicator(devIndicatorsState)\n-}\n-\n-export function buildingIndicatorShow() {\n-  dispatcher.buildingIndicatorShow()\n-}\n-\n-export function buildingIndicatorHide() {\n-  dispatcher.buildingIndicatorHide()\n-}\n-\n-export { getErrorByType } from '../utils/get-error-by-type'\n-export { getServerError } from '../utils/node-stack-frames'",
            "previous_filename": "packages/next/src/client/components/react-dev-overlay/pages/client.ts"
        },
        {
            "sha": "36622efd1cb136460c3b23094a7aaa4f2e5414ec",
            "filename": "packages/next/src/client/components/react-dev-overlay/runtime-error-handler.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fruntime-error-handler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fruntime-error-handler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fruntime-error-handler.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "previous_filename": "packages/next/src/client/components/errors/runtime-error-handler.ts"
        },
        {
            "sha": "905218a3d804b83ae1ba8240b1566eebb3dd1118",
            "filename": "packages/next/src/client/components/react-dev-overlay/server/middleware-webpack.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fserver%2Fmiddleware-webpack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fserver%2Fmiddleware-webpack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fserver%2Fmiddleware-webpack.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -16,7 +16,6 @@ import {\n   type OriginalStackFramesResponse,\n } from './shared'\n import { middlewareResponse } from './middleware-response'\n-export { getServerError } from '../utils/node-stack-frames'\n export { parseStack } from '../utils/parse-stack'\n export { getSourceMapFromFile }\n "
        },
        {
            "sha": "90629a69fa6b4578dc1b93cf342bcf02de895ad2",
            "filename": "packages/next/src/client/components/react-dev-overlay/shared.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fshared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fshared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fshared.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -6,7 +6,7 @@ import { parseComponentStack } from './utils/parse-component-stack'\n import type { DebugInfo } from './types'\n import type { DevIndicatorServerState } from '../../../server/dev/dev-indicator-server-state'\n import { parseStack } from './utils/parse-stack'\n-import { isConsoleError } from '../errors/console-error'\n+import { isConsoleError } from './app/errors/console-error'\n \n type FastRefreshState =\n   /** No refresh in progress. */"
        },
        {
            "sha": "8be87c80f78808a319d935a9ca8aa2a0397c4a66",
            "filename": "packages/next/src/client/components/react-dev-overlay/utils/node-stack-frames.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Futils%2Fnode-stack-frames.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Futils%2Fnode-stack-frames.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Futils%2Fnode-stack-frames.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -5,7 +5,7 @@ import {\n   type ErrorSourceType,\n } from '../../../../shared/lib/error-source'\n \n-export function getFilesystemFrame(frame: StackFrame): StackFrame {\n+function getFilesystemFrame(frame: StackFrame): StackFrame {\n   const f: StackFrame = { ...frame }\n \n   if (typeof f.file === 'string') {"
        },
        {
            "sha": "0b59f10408d3bd4199dfb65fdeb7ad45531fc62d",
            "filename": "packages/next/src/client/dev/hot-reloader/app/hot-reloader-app.tsx",
            "status": "modified",
            "additions": 8,
            "deletions": 6,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fapp%2Fhot-reloader-app.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fapp%2Fhot-reloader-app.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fapp%2Fhot-reloader-app.tsx?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -5,13 +5,16 @@ import { useEffect, startTransition, useRef } from 'react'\n import stripAnsi from 'next/dist/compiled/strip-ansi'\n import formatWebpackMessages from '../../../components/react-dev-overlay/utils/format-webpack-messages'\n import { useRouter } from '../../../components/navigation'\n-import { REACT_REFRESH_FULL_RELOAD } from '../shared'\n-import { reportInvalidHmrMessage } from '../shared'\n+import {\n+  REACT_REFRESH_FULL_RELOAD,\n+  REACT_REFRESH_FULL_RELOAD_FROM_ERROR,\n+  reportInvalidHmrMessage,\n+} from '../shared'\n import { dispatcher } from 'next/dist/compiled/next-devtools'\n-import { ReplaySsrOnlyErrors } from '../../../components/react-dev-overlay/app/replay-ssr-only-errors'\n+import { ReplaySsrOnlyErrors } from '../../../components/react-dev-overlay/app/errors/replay-ssr-only-errors'\n import { AppDevOverlayErrorBoundary } from '../../../components/react-dev-overlay/app/app-dev-overlay-error-boundary'\n-import { useErrorHandler } from '../../../components/errors/use-error-handler'\n-import { RuntimeErrorHandler } from '../../../components/errors/runtime-error-handler'\n+import { useErrorHandler } from '../../../components/react-dev-overlay/app/errors/use-error-handler'\n+import { RuntimeErrorHandler } from '../../../components/react-dev-overlay/runtime-error-handler'\n import {\n   useSendMessage,\n   useTurbopack,\n@@ -23,7 +26,6 @@ import type {\n   HMR_ACTION_TYPES,\n   TurbopackMsgToBrowser,\n } from '../../../../server/dev/hot-reloader-types'\n-import { REACT_REFRESH_FULL_RELOAD_FROM_ERROR } from '../shared'\n import { useUntrackedPathname } from '../../../components/navigation-untracked'\n import type { GlobalErrorComponent } from '../../../components/global-error'\n import reportHmrLatency from '../../../components/react-dev-overlay/utils/report-hmr-latency'"
        },
        {
            "sha": "b2b014ccaf790ba98c9a50e094cc0538aab53424",
            "filename": "packages/next/src/client/dev/hot-reloader/pages/hot-reloader-pages.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 29,
            "changes": 50,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fpages%2Fhot-reloader-pages.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fpages%2Fhot-reloader-pages.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fpages%2Fhot-reloader-pages.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -32,18 +32,8 @@\n \n /// <reference types=\"webpack/module.d.ts\" />\n \n-import {\n-  register,\n-  onBuildError,\n-  onBuildOk,\n-  onBeforeRefresh,\n-  onRefresh,\n-  onVersionInfo,\n-  onStaticIndicator,\n-  onDevIndicator,\n-  buildingIndicatorHide,\n-  buildingIndicatorShow,\n-} from '../../../components/react-dev-overlay/pages/client'\n+import { dispatcher } from 'next/dist/compiled/next-devtools'\n+import { register } from '../../../components/react-dev-overlay/pages/pages-dev-overlay-setup'\n import stripAnsi from 'next/dist/compiled/strip-ansi'\n import { addMessageListener, sendMessage } from './websocket'\n import formatWebpackMessages from '../../../components/react-dev-overlay/utils/format-webpack-messages'\n@@ -52,10 +42,12 @@ import type {\n   HMR_ACTION_TYPES,\n   TurbopackMsgToBrowser,\n } from '../../../../server/dev/hot-reloader-types'\n-import { REACT_REFRESH_FULL_RELOAD } from '../shared'\n-import { REACT_REFRESH_FULL_RELOAD_FROM_ERROR } from '../shared'\n-import { reportInvalidHmrMessage } from '../shared'\n-import { RuntimeErrorHandler } from '../../../components/errors/runtime-error-handler'\n+import {\n+  REACT_REFRESH_FULL_RELOAD,\n+  REACT_REFRESH_FULL_RELOAD_FROM_ERROR,\n+  reportInvalidHmrMessage,\n+} from '../shared'\n+import { RuntimeErrorHandler } from '../../../components/react-dev-overlay/runtime-error-handler'\n import reportHmrLatency from '../../../components/react-dev-overlay/utils/report-hmr-latency'\n import { TurbopackHmr } from '../../../components/react-dev-overlay/utils/turbopack-hot-reloader-common'\n \n@@ -142,7 +134,7 @@ function handleSuccess() {\n         hmrUpdate.hasUpdates\n       )\n     }\n-    onBuildOk()\n+    dispatcher.onBuildOk()\n   } else {\n     const isHotUpdate =\n       !isFirstCompilation ||\n@@ -209,7 +201,7 @@ function handleErrors(errors: any) {\n \n   // Only show the first error.\n \n-  onBuildError(formatted.errors[0])\n+  dispatcher.onBuildError(formatted.errors[0])\n \n   // Also log them to the console.\n   if (typeof console !== 'undefined' && typeof console.error === 'function') {\n@@ -255,7 +247,7 @@ export function handleStaticIndicator() {\n       window.location.pathname in isrManifest ||\n       (!isDynamicPage && !hasAppGetInitialProps)\n \n-    onStaticIndicator(isPageStatic)\n+    dispatcher.onStaticIndicator(isPageStatic)\n   }\n }\n \n@@ -272,7 +264,7 @@ function processMessage(obj: HMR_ACTION_TYPES) {\n       break\n     }\n     case HMR_ACTIONS_SENT_TO_BROWSER.BUILDING: {\n-      buildingIndicatorShow()\n+      dispatcher.buildingIndicatorShow()\n \n       if (process.env.TURBOPACK) {\n         turbopackHmr!.onBuilding()\n@@ -284,15 +276,15 @@ function processMessage(obj: HMR_ACTION_TYPES) {\n     }\n     case HMR_ACTIONS_SENT_TO_BROWSER.BUILT:\n     case HMR_ACTIONS_SENT_TO_BROWSER.SYNC: {\n-      buildingIndicatorHide()\n+      dispatcher.buildingIndicatorHide()\n \n       if (obj.hash) handleAvailableHash(obj.hash)\n \n       const { errors, warnings } = obj\n \n       // Is undefined when it's a 'built' event\n-      if ('versionInfo' in obj) onVersionInfo(obj.versionInfo)\n-      if ('devIndicator' in obj) onDevIndicator(obj.devIndicator)\n+      if ('versionInfo' in obj) dispatcher.onVersionInfo(obj.versionInfo)\n+      if ('devIndicator' in obj) dispatcher.onDevIndicator(obj.devIndicator)\n \n       const hasErrors = Boolean(errors && errors.length)\n       if (hasErrors) {\n@@ -355,7 +347,7 @@ function processMessage(obj: HMR_ACTION_TYPES) {\n     }\n     case HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE: {\n       turbopackHmr!.onTurbopackMessage(obj)\n-      onBeforeRefresh()\n+      dispatcher.onBeforeRefresh()\n       for (const listener of turbopackMessageListeners) {\n         listener({\n           type: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE,\n@@ -366,7 +358,7 @@ function processMessage(obj: HMR_ACTION_TYPES) {\n         console.warn(REACT_REFRESH_FULL_RELOAD_FROM_ERROR)\n         performFullReload(null)\n       }\n-      onRefresh()\n+      dispatcher.onRefresh()\n       break\n     }\n     default: {\n@@ -415,7 +407,7 @@ function tryApplyUpdatesWebpack() {\n   }\n \n   if (!isUpdateAvailable() || !canApplyUpdates()) {\n-    onBuildOk()\n+    dispatcher.onBuildOk()\n     return\n   }\n \n@@ -433,15 +425,15 @@ function tryApplyUpdatesWebpack() {\n       return\n     }\n \n-    onBuildOk()\n+    dispatcher.onBuildOk()\n \n     if (isUpdateAvailable()) {\n       // While we were updating, there was a new update! Do it again.\n       tryApplyUpdatesWebpack()\n       return\n     }\n \n-    onRefresh()\n+    dispatcher.onRefresh()\n     reportHmrLatency(\n       sendMessage,\n       updatedModules,\n@@ -470,7 +462,7 @@ function tryApplyUpdatesWebpack() {\n       // We should always handle an update, even if updatedModules is empty (but\n       // non-null) for any reason. That's what webpack would normally do:\n       // https://github.com/webpack/webpack/blob/3aa6b6bc3a64/lib/hmr/HotModuleReplacement.runtime.js#L296-L298\n-      onBeforeRefresh()\n+      dispatcher.onBeforeRefresh()\n       // https://webpack.js.org/api/hot-module-replacement/#apply\n       return module.hot.apply()\n     })"
        },
        {
            "sha": "fabfbb05e5906a476f881b747f191c2abc386eeb",
            "filename": "packages/next/src/client/index.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Findex.tsx?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -180,7 +180,7 @@ class Container extends React.Component<{\n       return this.props.children\n     } else {\n       const { PagesDevOverlayBridge } =\n-        require('./components/react-dev-overlay/pages/pages-dev-overlay-bridge') as typeof import('./components/react-dev-overlay/pages/pages-dev-overlay-bridge')\n+        require('./components/react-dev-overlay/pages/pages-dev-overlay-setup') as typeof import('./components/react-dev-overlay/pages/pages-dev-overlay-setup')\n       return (\n         <PagesDevOverlayBridge>{this.props.children}</PagesDevOverlayBridge>\n       )\n@@ -917,10 +917,9 @@ export async function hydrate(opts?: { beforeRender?: () => Promise<void> }) {\n   }\n \n   if (process.env.NODE_ENV === 'development') {\n-    const getServerError: typeof import('./components/react-dev-overlay/pages/client').getServerError =\n-      (\n-        require('./components/react-dev-overlay/pages/client') as typeof import('./components/react-dev-overlay/pages/client')\n-      ).getServerError\n+    const getServerError = (\n+      require('./components/react-dev-overlay/utils/node-stack-frames') as typeof import('./components/react-dev-overlay/utils/node-stack-frames')\n+    ).getServerError\n     // Server-side runtime errors need to be re-thrown on the client-side so\n     // that the overlay is rendered.\n     if (initialErr) {"
        },
        {
            "sha": "bdf7a054f9e783491afde7066327d80b6a4a9e57",
            "filename": "packages/next/src/client/page-bootstrap.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 7,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fpage-bootstrap.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Fpage-bootstrap.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fpage-bootstrap.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -11,13 +11,10 @@ import {\n   urlQueryToSearchParams,\n } from '../shared/lib/router/utils/querystring'\n import { HMR_ACTIONS_SENT_TO_BROWSER } from '../server/dev/hot-reloader-types'\n-import { RuntimeErrorHandler } from './components/errors/runtime-error-handler'\n+import { RuntimeErrorHandler } from './components/react-dev-overlay/runtime-error-handler'\n import { REACT_REFRESH_FULL_RELOAD_FROM_ERROR } from './dev/hot-reloader/shared'\n import { performFullReload } from './dev/hot-reloader/pages/hot-reloader-pages'\n-import {\n-  buildingIndicatorHide,\n-  buildingIndicatorShow,\n-} from './components/react-dev-overlay/pages/client'\n+import { dispatcher } from 'next/dist/compiled/next-devtools'\n \n export function pageBootstrap(assetPrefix: string) {\n   connectHMR({ assetPrefix, path: '/_next/webpack-hmr' })\n@@ -93,8 +90,8 @@ export function pageBootstrap(assetPrefix: string) {\n \n             if (!router.clc && pages.includes(router.pathname)) {\n               console.log('Refreshing page data due to server-side change')\n-              buildingIndicatorShow()\n-              const clearIndicator = buildingIndicatorHide\n+              dispatcher.buildingIndicatorShow()\n+              const clearIndicator = dispatcher.buildingIndicatorHide\n \n               router\n                 .replace("
        },
        {
            "sha": "f19445d5a4d146852b46aa2209eeef1fa759358c",
            "filename": "packages/next/src/client/react-client-callbacks/error-boundary-callbacks.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Freact-client-callbacks%2Ferror-boundary-callbacks.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Freact-client-callbacks%2Ferror-boundary-callbacks.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Freact-client-callbacks%2Ferror-boundary-callbacks.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -5,12 +5,12 @@ import {\n   setOwnerStackIfAvailable,\n   setComponentStack,\n   coerceError,\n-} from '../components/errors/stitched-error'\n-import { handleClientError } from '../components/errors/use-error-handler'\n+} from '../components/react-dev-overlay/app/errors/stitched-error'\n+import { handleClientError } from '../components/react-dev-overlay/app/errors/use-error-handler'\n import { isNextRouterError } from '../components/is-next-router-error'\n import { isBailoutToCSRError } from '../../shared/lib/lazy-dynamic/bailout-to-csr'\n import { reportGlobalError } from './report-global-error'\n-import { originConsoleError } from '../components/globals/intercept-console-error'\n+import { originConsoleError } from '../components/react-dev-overlay/app/errors/intercept-console-error'\n import { ErrorBoundaryHandler } from '../components/error-boundary'\n import DefaultErrorBoundary from '../components/global-error'\n "
        },
        {
            "sha": "e358ad16d6398b300c9185349ef077ac164309b1",
            "filename": "packages/next/src/client/react-client-callbacks/on-recoverable-error.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Freact-client-callbacks%2Fon-recoverable-error.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fclient%2Freact-client-callbacks%2Fon-recoverable-error.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Freact-client-callbacks%2Fon-recoverable-error.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -6,7 +6,7 @@ import {\n   setOwnerStackIfAvailable,\n   setComponentStack,\n   coerceError,\n-} from '../components/errors/stitched-error'\n+} from '../components/react-dev-overlay/app/errors/stitched-error'\n import isError from '../../lib/is-error'\n import { reportGlobalError } from './report-global-error'\n "
        },
        {
            "sha": "b71934b1864742f150855f71b5438d5a83f8389b",
            "filename": "packages/next/src/server/dev/next-dev-server.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fnext-dev-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fnext-dev-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fnext-dev-server.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -68,7 +68,7 @@ import type { ServerOnInstrumentationRequestError } from '../app-render/types'\n import type { ServerComponentsHmrCache } from '../response-cache'\n import { logRequests } from './log-requests'\n import { FallbackMode } from '../../lib/fallback'\n-import type { PagesDevOverlayBridgeType } from '../../client/components/react-dev-overlay/pages/pages-dev-overlay-bridge'\n+import type { PagesDevOverlayBridgeType } from '../../client/components/react-dev-overlay/pages/pages-dev-overlay-setup'\n import {\n   ensureInstrumentationRegistered,\n   getInstrumentationModule,\n@@ -79,7 +79,7 @@ let PagesDevOverlayBridgeImpl: PagesDevOverlayBridgeType\n const ReactDevOverlay: PagesDevOverlayBridgeType = (props) => {\n   if (PagesDevOverlayBridgeImpl === undefined) {\n     PagesDevOverlayBridgeImpl = (\n-      require('../../client/components/react-dev-overlay/pages/pages-dev-overlay-bridge') as typeof import('../../client/components/react-dev-overlay/pages/pages-dev-overlay-bridge')\n+      require('../../client/components/react-dev-overlay/pages/pages-dev-overlay-setup') as typeof import('../../client/components/react-dev-overlay/pages/pages-dev-overlay-setup')\n     ).PagesDevOverlayBridge\n   }\n   return React.createElement(PagesDevOverlayBridgeImpl, props)"
        },
        {
            "sha": "a2c231da051e56a294d5a737a9dfb8621edd67f7",
            "filename": "packages/next/src/server/render.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Frender.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Frender.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Frender.tsx?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -103,7 +103,7 @@ import { ReflectAdapter } from './web/spec-extension/adapters/reflect'\n import { getCacheControlHeader } from './lib/cache-control'\n import { getErrorSource } from '../shared/lib/error-source'\n import type { DeepReadonly } from '../shared/lib/deep-readonly'\n-import type { PagesDevOverlayBridgeType } from '../client/components/react-dev-overlay/pages/pages-dev-overlay-bridge'\n+import type { PagesDevOverlayBridgeType } from '../client/components/react-dev-overlay/pages/pages-dev-overlay-setup'\n import { getScriptNonceFromHeader } from './app-render/get-script-nonce-from-header'\n \n let tryGetPreviewData: typeof import('./api-utils/node/try-get-preview-data').tryGetPreviewData"
        },
        {
            "sha": "1dcb22374ada723183096212091a0506f190ca3b",
            "filename": "packages/next/src/server/request-meta.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Frequest-meta.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Frequest-meta.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Frequest-meta.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -7,7 +7,7 @@ import type { CloneableBody } from './body-streams'\n import type { RouteMatch } from './route-matches/route-match'\n import type { NEXT_RSC_UNION_QUERY } from '../client/components/app-router-headers'\n import type { ServerComponentsHmrCache } from './response-cache'\n-import type { PagesDevOverlayBridgeType } from '../client/components/react-dev-overlay/pages/pages-dev-overlay-bridge'\n+import type { PagesDevOverlayBridgeType } from '../client/components/react-dev-overlay/pages/pages-dev-overlay-setup'\n \n // FIXME: (wyattjoh) this is a temporary solution to allow us to pass data between bundled modules\n export const NEXT_REQUEST_META = Symbol.for('NextInternalRequestMeta')"
        },
        {
            "sha": "81d90a4e24921bab2bf21510efa5e93b569dea0b",
            "filename": "packages/next/src/server/web/sandbox/context.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fsandbox%2Fcontext.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fsandbox%2Fcontext.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fsandbox%2Fcontext.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -33,19 +33,19 @@ interface ModuleContext {\n   warnedEvals: Set<string>\n }\n \n-let getServerError: typeof import('../../../client/components/react-dev-overlay/server/middleware-webpack').getServerError\n+let getServerError: typeof import('../../../client/components/react-dev-overlay/utils/node-stack-frames').getServerError\n let decorateServerError: typeof import('../../../shared/lib/error-source').decorateServerError\n \n if (process.env.NODE_ENV === 'development') {\n-  const middleware =\n-    require('../../../client/components/react-dev-overlay/server/middleware-webpack') as typeof import('../../../client/components/react-dev-overlay/server/middleware-webpack')\n-  getServerError = middleware.getServerError\n+  getServerError = (\n+    require('../../../client/components/react-dev-overlay/utils/node-stack-frames') as typeof import('../../../client/components/react-dev-overlay/utils/node-stack-frames') as typeof import('../../../client/components/react-dev-overlay/utils/node-stack-frames')\n+  ).getServerError\n   decorateServerError = (\n     require('../../../shared/lib/error-source') as typeof import('../../../shared/lib/error-source')\n   ).decorateServerError\n } else {\n-  getServerError = (error: Error, _: string) => error\n-  decorateServerError = (_: Error, __: string) => {}\n+  getServerError = (error) => error\n+  decorateServerError = () => {}\n }\n \n /**"
        },
        {
            "sha": "921039fcfefc53c425ed86e235ada52e6f9b4e1b",
            "filename": "packages/next/src/server/web/sandbox/sandbox.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fsandbox%2Fsandbox.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fsandbox%2Fsandbox.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fsandbox%2Fsandbox.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -44,7 +44,7 @@ type RunnerFn = (params: RunnerFnParams) => Promise<FetchEventResult>\n function withTaggedErrors(fn: RunnerFn): RunnerFn {\n   if (process.env.NODE_ENV === 'development') {\n     const { getServerError } =\n-      require('../../../client/components/react-dev-overlay/server/middleware-webpack') as typeof import('../../../client/components/react-dev-overlay/server/middleware-webpack')\n+      require('../../../client/components/react-dev-overlay/utils/node-stack-frames') as typeof import('../../../client/components/react-dev-overlay/utils/node-stack-frames')\n \n     return (params) =>\n       fn(params)"
        },
        {
            "sha": "d020a4a4cc366c06167706c7ca2316cb770c3262",
            "filename": "test/production/app-dir/browser-chunks/browser-chunks.test.ts",
            "status": "modified",
            "additions": 25,
            "deletions": 2,
            "changes": 27,
            "blob_url": "https://github.com/vercel/next.js/blob/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/test%2Fproduction%2Fapp-dir%2Fbrowser-chunks%2Fbrowser-chunks.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81d4a8bd5ca5ad451c7f831bcd50167aee8835f2/test%2Fproduction%2Fapp-dir%2Fbrowser-chunks%2Fbrowser-chunks.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbrowser-chunks%2Fbrowser-chunks.test.ts?ref=81d4a8bd5ca5ad451c7f831bcd50167aee8835f2",
            "patch": "@@ -37,10 +37,33 @@ describe('browser-chunks', () => {\n   it('must not bundle any dev overlay into browser chunks', () => {\n     const devOverlaySources = sources.filter((source) => {\n       return (\n-        /webpack:\\/\\/_N_E\\/(\\.\\.\\/)*src\\/client\\/components\\/react-dev-overlay\\//.test(\n+        (/webpack:\\/\\/_N_E\\/(\\.\\.\\/)*src\\/client\\/components\\/react-dev-overlay\\//.test(\n           source\n         ) ||\n-        /next\\/dist\\/(esm\\/)?client\\/components\\/react-dev-overlay/.test(source)\n+          /next\\/dist\\/(esm\\/)?client\\/components\\/react-dev-overlay/.test(\n+            source\n+          )) &&\n+        !(\n+          // This is not dev-overlay frontend code.\n+          // TODO: Move code into dedicated folder to make distinction clearer.\n+          (\n+            source.endsWith(\n+              'client/components/react-dev-overlay/app/errors/use-error-handler.ts'\n+            ) ||\n+            source.endsWith(\n+              'client/components/react-dev-overlay/app/errors/stitched-error.ts'\n+            ) ||\n+            source.endsWith(\n+              'client/components/react-dev-overlay/app/app-dev-overlay-setup.ts'\n+            ) ||\n+            source.endsWith(\n+              'client/components/react-dev-overlay/app/errors/console-error.ts'\n+            ) ||\n+            source.endsWith(\n+              'client/components/react-dev-overlay/app/errors/intercept-console-error.ts'\n+            )\n+          )\n+        )\n       )\n     })\n "
        }
    ],
    "stats": {
        "total": 324,
        "additions": 145,
        "deletions": 179
    }
}