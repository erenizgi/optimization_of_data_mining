{
    "author": "sokra",
    "message": "Turbopack: improve errors/warnings for turbopack messages (#84552)\n\n### What?\n\n* make the turbopack error not a really long line, which is annoying in the deployment build log\n\n * Show a `(invalid experimental key)` info in the list of experimental options when they are not supported.",
    "sha": "6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
    "files": [
        {
            "sha": "b0fe5cd592f8806ca5b10ffaa83c37bfcd56c97d",
            "filename": "packages/next/src/lib/turbopack-warning.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 5,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/packages%2Fnext%2Fsrc%2Flib%2Fturbopack-warning.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/packages%2Fnext%2Fsrc%2Flib%2Fturbopack-warning.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fturbopack-warning.ts?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -152,15 +152,20 @@ export async function validateTurboNextConfig({\n   if (process.env.TURBOPACK === 'auto' && hasWebpackConfig && !hasTurboConfig) {\n     const configFile = rawNextConfig.configFileName ?? 'your Next config file'\n     Log.error(\n-      `ERROR: This build is using Turbopack, with a \\`webpack\\` config and no \\`turbopack\\` config. This may be a mistake.\n+      `ERROR: This build is using Turbopack, with a \\`webpack\\` config and no \\`turbopack\\` config.\n+   This may be a mistake.\n \n-  As of Next.js 16 turbopack is enabled by default and custom webpack configurations may need to be migrated to Turbopack.\n+   As of Next.js 16 Turbopack is enabled by default and\n+   custom webpack configurations may need to be migrated to Turbopack.\n \n-  NOTE: your \\`webpack\\` config may have been added by a configuration plugin.\n+   NOTE: your \\`webpack\\` config may have been added by a configuration plugin.\n \n-  To configure Turbopack, see https://nextjs.org/docs/app/api-reference/next-config-js/turbopack\n+   To configure Turbopack, see https://nextjs.org/docs/app/api-reference/next-config-js/turbopack\n \n-  TIP: Many applications work fine under Turbopack with no configuration, if that is the case for you, you can silence this error by passing the \\`--turbopack\\` or \\`--webpack\\` flag explicitly or simply setting an empty turbopack config in ${configFile} (e.g. \\`turbopack: {}\\`).`\n+   TIP: Many applications work fine under Turbopack with no configuration,\n+   if that is the case for you, you can silence this error by passing the\n+   \\`--turbopack\\` or \\`--webpack\\` flag explicitly or simply setting an \n+   empty turbopack config in ${configFile} (e.g. \\`turbopack: {}\\`).`\n     )\n \n     process.exit(1)"
        },
        {
            "sha": "d563690e9a826dcfbe12559d9fcf211a3fba88d7",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 184,
            "deletions": 185,
            "changes": 369,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -162,6 +162,189 @@ const zTurbopackConfig: zod.ZodType<TurbopackOptions> = z.strictObject({\n   debugIds: z.boolean().optional(),\n })\n \n+export const experimentalSchema = {\n+  adapterPath: z.string().optional(),\n+  useSkewCookie: z.boolean().optional(),\n+  after: z.boolean().optional(),\n+  appNavFailHandling: z.boolean().optional(),\n+  preloadEntriesOnStart: z.boolean().optional(),\n+  allowedRevalidateHeaderKeys: z.array(z.string()).optional(),\n+  staleTimes: z\n+    .object({\n+      dynamic: z.number().optional(),\n+      static: z.number().optional(),\n+    })\n+    .optional(),\n+  cacheLife: z\n+    .record(\n+      z.object({\n+        stale: z.number().optional(),\n+        revalidate: z.number().optional(),\n+        expire: z.number().optional(),\n+      })\n+    )\n+    .optional(),\n+  cacheHandlers: z.record(z.string(), z.string().optional()).optional(),\n+  clientRouterFilter: z.boolean().optional(),\n+  clientRouterFilterRedirects: z.boolean().optional(),\n+  clientRouterFilterAllowedRate: z.number().optional(),\n+  cpus: z.number().optional(),\n+  memoryBasedWorkersCount: z.boolean().optional(),\n+  craCompat: z.boolean().optional(),\n+  caseSensitiveRoutes: z.boolean().optional(),\n+  clientSegmentCache: z\n+    .union([z.boolean(), z.literal('client-only')])\n+    .optional(),\n+  rdcForNavigations: z.boolean().optional(),\n+  clientParamParsing: z.boolean().optional(),\n+  clientParamParsingOrigins: z.array(z.string()).optional(),\n+  dynamicOnHover: z.boolean().optional(),\n+  disableOptimizedLoading: z.boolean().optional(),\n+  disablePostcssPresetEnv: z.boolean().optional(),\n+  cacheComponents: z.boolean().optional(),\n+  dynamicIO: z.boolean().optional(),\n+  inlineCss: z.boolean().optional(),\n+  esmExternals: z.union([z.boolean(), z.literal('loose')]).optional(),\n+  serverActions: z\n+    .object({\n+      bodySizeLimit: zSizeLimit.optional(),\n+      allowedOrigins: z.array(z.string()).optional(),\n+    })\n+    .optional(),\n+  // The original type was Record<string, any>\n+  extensionAlias: z.record(z.string(), z.any()).optional(),\n+  externalDir: z.boolean().optional(),\n+  externalMiddlewareRewritesResolve: z.boolean().optional(),\n+  fallbackNodePolyfills: z.literal(false).optional(),\n+  fetchCacheKeyPrefix: z.string().optional(),\n+  forceSwcTransforms: z.boolean().optional(),\n+  fullySpecified: z.boolean().optional(),\n+  gzipSize: z.boolean().optional(),\n+  imgOptConcurrency: z.number().int().optional().nullable(),\n+  imgOptTimeoutInSeconds: z.number().int().optional(),\n+  imgOptMaxInputPixels: z.number().int().optional(),\n+  imgOptSequentialRead: z.boolean().optional().nullable(),\n+  imgOptSkipMetadata: z.boolean().optional().nullable(),\n+  isrFlushToDisk: z.boolean().optional(),\n+  largePageDataBytes: z.number().optional(),\n+  linkNoTouchStart: z.boolean().optional(),\n+  manualClientBasePath: z.boolean().optional(),\n+  middlewarePrefetch: z.enum(['strict', 'flexible']).optional(),\n+  multiZoneDraftMode: z.boolean().optional(),\n+  cssChunking: z.union([z.boolean(), z.literal('strict')]).optional(),\n+  nextScriptWorkers: z.boolean().optional(),\n+  // The critter option is unknown, use z.any() here\n+  optimizeCss: z.union([z.boolean(), z.any()]).optional(),\n+  optimisticClientCache: z.boolean().optional(),\n+  parallelServerCompiles: z.boolean().optional(),\n+  parallelServerBuildTraces: z.boolean().optional(),\n+  ppr: z\n+    .union([z.boolean(), z.literal('incremental')])\n+    .readonly()\n+    .optional(),\n+  taint: z.boolean().optional(),\n+  prerenderEarlyExit: z.boolean().optional(),\n+  proxyTimeout: z.number().gte(0).optional(),\n+  rootParams: z.boolean().optional(),\n+  isolatedDevBuild: z.boolean().optional(),\n+  mcpServer: z.boolean().optional(),\n+  routerBFCache: z.boolean().optional(),\n+  removeUncaughtErrorAndRejectionListeners: z.boolean().optional(),\n+  validateRSCRequestHeaders: z.boolean().optional(),\n+  scrollRestoration: z.boolean().optional(),\n+  sri: z\n+    .object({\n+      algorithm: z.enum(['sha256', 'sha384', 'sha512']).optional(),\n+    })\n+    .optional(),\n+  swcPlugins: z\n+    // The specific swc plugin's option is unknown, use z.any() here\n+    .array(z.tuple([z.string(), z.record(z.string(), z.any())]))\n+    .optional(),\n+  swcTraceProfiling: z.boolean().optional(),\n+  // NonNullable<webpack.Configuration['experiments']>['buildHttp']\n+  urlImports: z.any().optional(),\n+  viewTransition: z.boolean().optional(),\n+  workerThreads: z.boolean().optional(),\n+  webVitalsAttribution: z\n+    .array(\n+      z.union([\n+        z.literal('CLS'),\n+        z.literal('FCP'),\n+        z.literal('FID'),\n+        z.literal('INP'),\n+        z.literal('LCP'),\n+        z.literal('TTFB'),\n+      ])\n+    )\n+    .optional(),\n+  // This is partial set of mdx-rs transform options we support, aligned\n+  // with next_core::next_config::MdxRsOptions. Ensure both types are kept in sync.\n+  mdxRs: z\n+    .union([\n+      z.boolean(),\n+      z.object({\n+        development: z.boolean().optional(),\n+        jsxRuntime: z.string().optional(),\n+        jsxImportSource: z.string().optional(),\n+        providerImportSource: z.string().optional(),\n+        mdxType: z.enum(['gfm', 'commonmark']).optional(),\n+      }),\n+    ])\n+    .optional(),\n+  typedRoutes: z.boolean().optional(),\n+  webpackBuildWorker: z.boolean().optional(),\n+  webpackMemoryOptimizations: z.boolean().optional(),\n+  turbopackMemoryLimit: z.number().optional(),\n+  turbopackMinify: z.boolean().optional(),\n+  turbopackPersistentCachingForDev: z.boolean().optional(),\n+  turbopackPersistentCachingForBuild: z.boolean().optional(),\n+  turbopackSourceMaps: z.boolean().optional(),\n+  turbopackTreeShaking: z.boolean().optional(),\n+  turbopackRemoveUnusedExports: z.boolean().optional(),\n+  turbopackScopeHoisting: z.boolean().optional(),\n+  turbopackImportTypeBytes: z.boolean().optional(),\n+  turbopackUseSystemTlsCerts: z.boolean().optional(),\n+  turbopackUseBuiltinBabel: z.boolean().optional(),\n+  turbopackUseBuiltinSass: z.boolean().optional(),\n+  turbopackModuleIds: z.enum(['named', 'deterministic']).optional(),\n+  optimizePackageImports: z.array(z.string()).optional(),\n+  optimizeServerReact: z.boolean().optional(),\n+  clientTraceMetadata: z.array(z.string()).optional(),\n+  serverMinification: z.boolean().optional(),\n+  enablePrerenderSourceMaps: z.boolean().optional(),\n+  serverSourceMaps: z.boolean().optional(),\n+  useWasmBinary: z.boolean().optional(),\n+  useLightningcss: z.boolean().optional(),\n+  testProxy: z.boolean().optional(),\n+  defaultTestRunner: z.enum(SUPPORTED_TEST_RUNNERS_LIST).optional(),\n+  allowDevelopmentBuild: z.literal(true).optional(),\n+\n+  reactDebugChannel: z.boolean().optional(),\n+  staticGenerationRetryCount: z.number().int().optional(),\n+  staticGenerationMaxConcurrency: z.number().int().optional(),\n+  staticGenerationMinPagesPerWorker: z.number().int().optional(),\n+  typedEnv: z.boolean().optional(),\n+  serverComponentsHmrCache: z.boolean().optional(),\n+  authInterrupts: z.boolean().optional(),\n+  useCache: z.boolean().optional(),\n+  slowModuleDetection: z\n+    .object({\n+      buildTimeThresholdMs: z.number().int(),\n+    })\n+    .optional(),\n+  globalNotFound: z.boolean().optional(),\n+  browserDebugInfoInTerminal: z\n+    .union([\n+      z.boolean(),\n+      z.object({\n+        depthLimit: z.number().int().positive().optional(),\n+        edgeLimit: z.number().int().positive().optional(),\n+        showSourceLocation: z.boolean().optional(),\n+      }),\n+    ])\n+    .optional(),\n+}\n export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n   z.strictObject({\n     allowedDevOrigins: z.array(z.string()).optional(),\n@@ -288,191 +471,7 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n       })\n       .optional(),\n     excludeDefaultMomentLocales: z.boolean().optional(),\n-    experimental: z\n-      .strictObject({\n-        adapterPath: z.string().optional(),\n-        useSkewCookie: z.boolean().optional(),\n-        after: z.boolean().optional(),\n-        appNavFailHandling: z.boolean().optional(),\n-        preloadEntriesOnStart: z.boolean().optional(),\n-        allowedRevalidateHeaderKeys: z.array(z.string()).optional(),\n-        staleTimes: z\n-          .object({\n-            dynamic: z.number().optional(),\n-            static: z.number().optional(),\n-          })\n-          .optional(),\n-        cacheLife: z\n-          .record(\n-            z.object({\n-              stale: z.number().optional(),\n-              revalidate: z.number().optional(),\n-              expire: z.number().optional(),\n-            })\n-          )\n-          .optional(),\n-        cacheHandlers: z.record(z.string(), z.string().optional()).optional(),\n-        clientRouterFilter: z.boolean().optional(),\n-        clientRouterFilterRedirects: z.boolean().optional(),\n-        clientRouterFilterAllowedRate: z.number().optional(),\n-        cpus: z.number().optional(),\n-        memoryBasedWorkersCount: z.boolean().optional(),\n-        craCompat: z.boolean().optional(),\n-        caseSensitiveRoutes: z.boolean().optional(),\n-        clientSegmentCache: z\n-          .union([z.boolean(), z.literal('client-only')])\n-          .optional(),\n-        rdcForNavigations: z.boolean().optional(),\n-        clientParamParsing: z.boolean().optional(),\n-        clientParamParsingOrigins: z.array(z.string()).optional(),\n-        dynamicOnHover: z.boolean().optional(),\n-        disableOptimizedLoading: z.boolean().optional(),\n-        disablePostcssPresetEnv: z.boolean().optional(),\n-        cacheComponents: z.boolean().optional(),\n-        dynamicIO: z.boolean().optional(),\n-        inlineCss: z.boolean().optional(),\n-        esmExternals: z.union([z.boolean(), z.literal('loose')]).optional(),\n-        serverActions: z\n-          .object({\n-            bodySizeLimit: zSizeLimit.optional(),\n-            allowedOrigins: z.array(z.string()).optional(),\n-          })\n-          .optional(),\n-        // The original type was Record<string, any>\n-        extensionAlias: z.record(z.string(), z.any()).optional(),\n-        externalDir: z.boolean().optional(),\n-        externalMiddlewareRewritesResolve: z.boolean().optional(),\n-        fallbackNodePolyfills: z.literal(false).optional(),\n-        fetchCacheKeyPrefix: z.string().optional(),\n-        forceSwcTransforms: z.boolean().optional(),\n-        fullySpecified: z.boolean().optional(),\n-        gzipSize: z.boolean().optional(),\n-        imgOptConcurrency: z.number().int().optional().nullable(),\n-        imgOptTimeoutInSeconds: z.number().int().optional(),\n-        imgOptMaxInputPixels: z.number().int().optional(),\n-        imgOptSequentialRead: z.boolean().optional().nullable(),\n-        imgOptSkipMetadata: z.boolean().optional().nullable(),\n-        isrFlushToDisk: z.boolean().optional(),\n-        largePageDataBytes: z.number().optional(),\n-        linkNoTouchStart: z.boolean().optional(),\n-        manualClientBasePath: z.boolean().optional(),\n-        middlewarePrefetch: z.enum(['strict', 'flexible']).optional(),\n-        multiZoneDraftMode: z.boolean().optional(),\n-        cssChunking: z.union([z.boolean(), z.literal('strict')]).optional(),\n-        nextScriptWorkers: z.boolean().optional(),\n-        // The critter option is unknown, use z.any() here\n-        optimizeCss: z.union([z.boolean(), z.any()]).optional(),\n-        optimisticClientCache: z.boolean().optional(),\n-        parallelServerCompiles: z.boolean().optional(),\n-        parallelServerBuildTraces: z.boolean().optional(),\n-        ppr: z\n-          .union([z.boolean(), z.literal('incremental')])\n-          .readonly()\n-          .optional(),\n-        taint: z.boolean().optional(),\n-        prerenderEarlyExit: z.boolean().optional(),\n-        proxyTimeout: z.number().gte(0).optional(),\n-        rootParams: z.boolean().optional(),\n-        isolatedDevBuild: z.boolean().optional(),\n-        mcpServer: z.boolean().optional(),\n-        routerBFCache: z.boolean().optional(),\n-        removeUncaughtErrorAndRejectionListeners: z.boolean().optional(),\n-        validateRSCRequestHeaders: z.boolean().optional(),\n-        scrollRestoration: z.boolean().optional(),\n-        sri: z\n-          .object({\n-            algorithm: z.enum(['sha256', 'sha384', 'sha512']).optional(),\n-          })\n-          .optional(),\n-        swcPlugins: z\n-          // The specific swc plugin's option is unknown, use z.any() here\n-          .array(z.tuple([z.string(), z.record(z.string(), z.any())]))\n-          .optional(),\n-        swcTraceProfiling: z.boolean().optional(),\n-        // NonNullable<webpack.Configuration['experiments']>['buildHttp']\n-        urlImports: z.any().optional(),\n-        viewTransition: z.boolean().optional(),\n-        workerThreads: z.boolean().optional(),\n-        webVitalsAttribution: z\n-          .array(\n-            z.union([\n-              z.literal('CLS'),\n-              z.literal('FCP'),\n-              z.literal('FID'),\n-              z.literal('INP'),\n-              z.literal('LCP'),\n-              z.literal('TTFB'),\n-            ])\n-          )\n-          .optional(),\n-        // This is partial set of mdx-rs transform options we support, aligned\n-        // with next_core::next_config::MdxRsOptions. Ensure both types are kept in sync.\n-        mdxRs: z\n-          .union([\n-            z.boolean(),\n-            z.object({\n-              development: z.boolean().optional(),\n-              jsxRuntime: z.string().optional(),\n-              jsxImportSource: z.string().optional(),\n-              providerImportSource: z.string().optional(),\n-              mdxType: z.enum(['gfm', 'commonmark']).optional(),\n-            }),\n-          ])\n-          .optional(),\n-        typedRoutes: z.boolean().optional(),\n-        webpackBuildWorker: z.boolean().optional(),\n-        webpackMemoryOptimizations: z.boolean().optional(),\n-        turbopackMemoryLimit: z.number().optional(),\n-        turbopackMinify: z.boolean().optional(),\n-        turbopackPersistentCachingForDev: z.boolean().optional(),\n-        turbopackPersistentCachingForBuild: z.boolean().optional(),\n-        turbopackSourceMaps: z.boolean().optional(),\n-        turbopackTreeShaking: z.boolean().optional(),\n-        turbopackRemoveUnusedExports: z.boolean().optional(),\n-        turbopackScopeHoisting: z.boolean().optional(),\n-        turbopackImportTypeBytes: z.boolean().optional(),\n-        turbopackUseSystemTlsCerts: z.boolean().optional(),\n-        turbopackUseBuiltinBabel: z.boolean().optional(),\n-        turbopackUseBuiltinSass: z.boolean().optional(),\n-        turbopackModuleIds: z.enum(['named', 'deterministic']).optional(),\n-        optimizePackageImports: z.array(z.string()).optional(),\n-        optimizeServerReact: z.boolean().optional(),\n-        clientTraceMetadata: z.array(z.string()).optional(),\n-        serverMinification: z.boolean().optional(),\n-        enablePrerenderSourceMaps: z.boolean().optional(),\n-        serverSourceMaps: z.boolean().optional(),\n-        useWasmBinary: z.boolean().optional(),\n-        useLightningcss: z.boolean().optional(),\n-        testProxy: z.boolean().optional(),\n-        defaultTestRunner: z.enum(SUPPORTED_TEST_RUNNERS_LIST).optional(),\n-        allowDevelopmentBuild: z.literal(true).optional(),\n-\n-        reactDebugChannel: z.boolean().optional(),\n-        staticGenerationRetryCount: z.number().int().optional(),\n-        staticGenerationMaxConcurrency: z.number().int().optional(),\n-        staticGenerationMinPagesPerWorker: z.number().int().optional(),\n-        typedEnv: z.boolean().optional(),\n-        serverComponentsHmrCache: z.boolean().optional(),\n-        authInterrupts: z.boolean().optional(),\n-        useCache: z.boolean().optional(),\n-        slowModuleDetection: z\n-          .object({\n-            buildTimeThresholdMs: z.number().int(),\n-          })\n-          .optional(),\n-        globalNotFound: z.boolean().optional(),\n-        browserDebugInfoInTerminal: z\n-          .union([\n-            z.boolean(),\n-            z.object({\n-              depthLimit: z.number().int().positive().optional(),\n-              edgeLimit: z.number().int().positive().optional(),\n-              showSourceLocation: z.boolean().optional(),\n-            }),\n-          ])\n-          .optional(),\n-      })\n-      .optional(),\n+    experimental: z.strictObject(experimentalSchema).optional(),\n     exportPathMap: z\n       .function()\n       .args("
        },
        {
            "sha": "d5d50db2ee95d0890b5c9b01e980b6daae7620a4",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -57,6 +57,18 @@ function normalizeNextConfigZodErrors(\n         // We exit the build when encountering an error in the images config\n         shouldExit = true\n       }\n+      if (\n+        issue.code === 'unrecognized_keys' &&\n+        issue.path[0] === 'experimental' &&\n+        message.includes('turbopackPersistentCaching')\n+      ) {\n+        // We exit the build when encountering an error in the turbopackPersistentCaching config\n+        shouldExit = true\n+        message +=\n+          \"\\nUse 'experimental.turbopackPersistentCachingForDev' instead.\"\n+        message +=\n+          '\\nLearn more: https://nextjs.org/docs/app/api-reference/config/next-config-js/turbopackPersistentCaching'\n+      }\n \n       return message\n     }),\n@@ -1974,7 +1986,7 @@ async function validateConfigSchema(\n     )\n     // ident list item\n     for (const error of errorMessages) {\n-      messages.push(`    ${error}`)\n+      messages.push(`    ${error.split('\\n').join('\\n    ')}`)\n     }\n \n     // error message footer"
        },
        {
            "sha": "3eb505d136372f39fd05a399fd8602fc0fde15ec",
            "filename": "packages/next/src/server/lib/app-info-log.ts",
            "status": "modified",
            "additions": 24,
            "deletions": 13,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fapp-info-log.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fapp-info-log.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fapp-info-log.ts?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -1,11 +1,12 @@\n import { loadEnvConfig } from '@next/env'\n import * as Log from '../../build/output/log'\n-import { bold, purple } from '../../lib/picocolors'\n+import { bold, purple, strikethrough } from '../../lib/picocolors'\n import {\n   PHASE_DEVELOPMENT_SERVER,\n   PHASE_PRODUCTION_BUILD,\n } from '../../shared/lib/constants'\n import loadConfig, { type ConfiguredExperimentalFeature } from '../config'\n+import { experimentalSchema } from '../config-schema'\n \n export function logStartInfo({\n   networkUrl,\n@@ -47,21 +48,31 @@ export function logStartInfo({\n   if (experimentalFeatures?.length) {\n     Log.bootstrap(`- Experiments (use with caution):`)\n     for (const exp of experimentalFeatures) {\n-      const symbol =\n-        typeof exp.value === 'boolean'\n-          ? exp.value === true\n-            ? bold('✓')\n-            : bold('⨯')\n-          : '·'\n+      const isValid = Object.prototype.hasOwnProperty.call(\n+        experimentalSchema,\n+        exp.key\n+      )\n+      if (isValid) {\n+        const symbol =\n+          typeof exp.value === 'boolean'\n+            ? exp.value === true\n+              ? bold('✓')\n+              : bold('⨯')\n+            : '·'\n \n-      const suffix =\n-        typeof exp.value === 'number' || typeof exp.value === 'string'\n-          ? `: ${JSON.stringify(exp.value)}`\n-          : ''\n+        const suffix =\n+          typeof exp.value === 'number' || typeof exp.value === 'string'\n+            ? `: ${JSON.stringify(exp.value)}`\n+            : ''\n \n-      const reason = exp.reason ? ` (${exp.reason})` : ''\n+        const reason = exp.reason ? ` (${exp.reason})` : ''\n \n-      Log.bootstrap(`  ${symbol} ${exp.key}${suffix}${reason}`)\n+        Log.bootstrap(`  ${symbol} ${exp.key}${suffix}${reason}`)\n+      } else {\n+        Log.bootstrap(\n+          `  ? ${strikethrough(exp.key)} (invalid experimental key)`\n+        )\n+      }\n     }\n   }\n "
        },
        {
            "sha": "9e94b29a9b682181dc690cf4af64a281bd78b6f8",
            "filename": "test/e2e/config-turbopack/index.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fconfig-turbopack%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fconfig-turbopack%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fconfig-turbopack%2Findex.test.ts?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -1,8 +1,7 @@\n /* eslint-disable jest/no-standalone-expect */\n import { nextTestSetup } from 'e2e-utils'\n \n-const WARNING_MESSAGE =\n-  'ERROR: This build is using Turbopack, with a `webpack` config and no `turbopack` config. This may be a mistake'\n+const WARNING_MESSAGE = `ERROR: This build is using Turbopack, with a \\`webpack\\` config and no \\`turbopack\\` config.`\n \n const itif = (condition: boolean) => (condition ? it : it.skip)\n "
        },
        {
            "sha": "888614deda3ba5d744d1a7e5dac131038dba2b12",
            "filename": "test/e2e/persistent-caching-migration/app/layout.tsx",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fpersistent-caching-migration%2Fapp%2Flayout.tsx?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -0,0 +1,8 @@\n+import { ReactNode } from 'react'\n+export default function Root({ children }: { children: ReactNode }) {\n+  return (\n+    <html>\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "e2615742ecad2b7af9c8703094cb6aafacd68579",
            "filename": "test/e2e/persistent-caching-migration/app/page.tsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fpersistent-caching-migration%2Fapp%2Fpage.tsx?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -0,0 +1,7 @@\n+export default function Page() {\n+  return (\n+    <>\n+      <p>hello world</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "0e4b5723e5b7796dd341ade05fc54003bb7c91dd",
            "filename": "test/e2e/persistent-caching-migration/next.config.js",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fpersistent-caching-migration%2Fnext.config.js?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -0,0 +1,10 @@\n+/**\n+ * @type {import('next').NextConfig}\n+ */\n+const nextConfig = {\n+  experimental: {\n+    turbopackPersistentCaching: true,\n+  },\n+}\n+\n+module.exports = nextConfig"
        },
        {
            "sha": "e2615742ecad2b7af9c8703094cb6aafacd68579",
            "filename": "test/e2e/persistent-caching-migration/pages/pages.tsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fpages%2Fpages.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fpages%2Fpages.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fpersistent-caching-migration%2Fpages%2Fpages.tsx?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -0,0 +1,7 @@\n+export default function Page() {\n+  return (\n+    <>\n+      <p>hello world</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "4b7c457d1df7aa728ddb33bfb447096d5e7c1ca1",
            "filename": "test/e2e/persistent-caching-migration/persistent-caching-migration.test.ts",
            "status": "added",
            "additions": 35,
            "deletions": 0,
            "changes": 35,
            "blob_url": "https://github.com/vercel/next.js/blob/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fpersistent-caching-migration.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/6d536ed25bf9325710bf6ad158ce0c35e98ce3ed/test%2Fe2e%2Fpersistent-caching-migration%2Fpersistent-caching-migration.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fpersistent-caching-migration%2Fpersistent-caching-migration.test.ts?ref=6d536ed25bf9325710bf6ad158ce0c35e98ce3ed",
            "patch": "@@ -0,0 +1,35 @@\n+import { nextTestSetup } from 'e2e-utils'\n+\n+describe('persistent-caching-migration', () => {\n+  const { skipped, next, isTurbopack, isNextStart } = nextTestSetup({\n+    files: __dirname,\n+    skipDeployment: true,\n+    skipStart: true,\n+  })\n+\n+  if (skipped) {\n+    return\n+  }\n+\n+  if (!isTurbopack) {\n+    it.skip('only for turbopack', () => {})\n+    return\n+  }\n+\n+  if (isNextStart) {\n+    it('error on old option', async () => {\n+      let { exitCode, cliOutput } = await next.build()\n+      expect(exitCode).toBe(1)\n+      expect(cliOutput).toContain(\n+        \"Use 'experimental.turbopackPersistentCachingForDev' instead.\"\n+      )\n+    })\n+  } else {\n+    it('success on new option', async () => {\n+      await expect(next.start()).toReject()\n+      expect(next.cliOutput).toContain(\n+        \"Use 'experimental.turbopackPersistentCachingForDev' instead.\"\n+      )\n+    })\n+  }\n+})"
        }
    ],
    "stats": {
        "total": 505,
        "additions": 299,
        "deletions": 206
    }
}