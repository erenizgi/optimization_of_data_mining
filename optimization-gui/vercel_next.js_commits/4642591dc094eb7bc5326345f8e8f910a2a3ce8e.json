{
    "author": "eps1lon",
    "message": "Mark React Compiler integration as stable (#84220)",
    "sha": "4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
    "files": [
        {
            "sha": "9353d418d8ac678de6cb513cb0f2393e616defba",
            "filename": "crates/next-core/src/next_config.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_config.rs?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -91,6 +91,7 @@ pub struct NextConfig {\n     pub experimental: ExperimentalConfig,\n     pub images: ImageConfig,\n     pub page_extensions: Vec<RcStr>,\n+    pub react_compiler: Option<ReactCompilerOptionsOrBoolean>,\n     pub react_production_profiling: Option<bool>,\n     pub react_strict_mode: Option<bool>,\n     pub transpile_packages: Option<Vec<RcStr>>,\n@@ -816,7 +817,6 @@ pub struct ExperimentalConfig {\n     web_vitals_attribution: Option<Vec<RcStr>>,\n     server_actions: Option<ServerActionsOrLegacyBool>,\n     sri: Option<SubResourceIntegrity>,\n-    react_compiler: Option<ReactCompilerOptionsOrBoolean>,\n     cache_components: Option<bool>,\n     use_cache: Option<bool>,\n     root_params: Option<bool>,\n@@ -1634,7 +1634,7 @@ impl NextConfig {\n \n     #[turbo_tasks::function]\n     pub fn react_compiler_options(&self) -> Vc<OptionalReactCompilerOptions> {\n-        let options = &self.experimental.react_compiler;\n+        let options = &self.react_compiler;\n \n         let options = match options {\n             Some(ReactCompilerOptionsOrBoolean::Boolean(true)) => {"
        },
        {
            "sha": "a0a0743ff83f5b7d15ebdd5d188fb45df4c1b385",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/reactCompiler.mdx",
            "status": "modified",
            "additions": 8,
            "deletions": 17,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FreactCompiler.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FreactCompiler.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FreactCompiler.mdx?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -1,10 +1,9 @@\n ---\n title: reactCompiler\n description: Enable the React Compiler to automatically optimize component rendering.\n-version: experimental\n ---\n \n-Next.js includes support for the [React Compiler](https://react.dev/learn/react-compiler), a tool designed to improve performance by automatically optimizing component rendering. This reduces the need for manual memoization using `useMemo` and `useCallback`.\n+Next.js includes support for the [React Compiler](https://react.dev/learn/react-compiler/introduction), a tool designed to improve performance by automatically optimizing component rendering. This reduces the need for manual memoization using `useMemo` and `useCallback`.\n \n Next.js includes a custom performance optimization written in SWC that makes the React Compiler more efficient. Instead of running the compiler on every file, Next.js analyzes your project and only applies the React Compiler to relevant files. This avoids unnecessary work and leads to faster builds compared to using the Babel plugin on its own.\n \n@@ -20,15 +19,13 @@ To use it, install the `babel-plugin-react-compiler`:\n npm install babel-plugin-react-compiler\n ```\n \n-Then, add `experimental.reactCompiler` option in `next.config.js`:\n+Then, add `reactCompiler` option in `next.config.js`:\n \n ```ts filename=\"next.config.ts\" switcher\n import type { NextConfig } from 'next'\n \n const nextConfig: NextConfig = {\n-  experimental: {\n-    reactCompiler: true,\n-  },\n+  reactCompiler: true,\n }\n \n export default nextConfig\n@@ -37,9 +34,7 @@ export default nextConfig\n ```js filename=\"next.config.js\" switcher\n /** @type {import('next').NextConfig} */\n const nextConfig = {\n-  experimental: {\n-    reactCompiler: true,\n-  },\n+  reactCompiler: true,\n }\n \n module.exports = nextConfig\n@@ -53,10 +48,8 @@ You can configure the compiler to run in \"opt-in\" mode as follows:\n import type { NextConfig } from 'next'\n \n const nextConfig: NextConfig = {\n-  experimental: {\n-    reactCompiler: {\n-      compilationMode: 'annotation',\n-    },\n+  reactCompiler: {\n+    compilationMode: 'annotation',\n   },\n }\n \n@@ -66,10 +59,8 @@ export default nextConfig\n ```js filename=\"next.config.js\" switcher\n /** @type {import('next').NextConfig} */\n const nextConfig = {\n-  experimental: {\n-    reactCompiler: {\n-      compilationMode: 'annotation',\n-    },\n+  reactCompiler: {\n+    compilationMode: 'annotation',\n   },\n }\n "
        },
        {
            "sha": "0d6363c08d503c8e53fae0d61471a45b47e70dad",
            "filename": "packages/next/src/build/webpack-config.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -482,14 +482,14 @@ export default async function getBaseWebpackConfig(\n     (appDir || pagesDir)!,\n     dev,\n     isClient,\n-    config.experimental?.reactCompiler,\n+    config.reactCompiler,\n     codeCondition.exclude\n   )\n \n   const reactCompilerLoader = babelLoader\n     ? undefined\n     : getReactCompilerLoader(\n-        config.experimental?.reactCompiler,\n+        config.reactCompiler,\n         dir,\n         isNodeOrEdgeCompilation,\n         codeCondition.exclude,"
        },
        {
            "sha": "c0788ad6a834b2beeffbf83c3fe207117ad935cb",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 13,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -458,19 +458,7 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n         testProxy: z.boolean().optional(),\n         defaultTestRunner: z.enum(SUPPORTED_TEST_RUNNERS_LIST).optional(),\n         allowDevelopmentBuild: z.literal(true).optional(),\n-        reactCompiler: z.union([\n-          z.boolean(),\n-          z\n-            .object({\n-              compilationMode: z\n-                .enum(['infer', 'annotation', 'all'])\n-                .optional(),\n-              panicThreshold: z\n-                .enum(['none', 'critical_errors', 'all_errors'])\n-                .optional(),\n-            })\n-            .optional(),\n-        ]),\n+\n         reactDebugChannel: z.boolean().optional(),\n         staticGenerationRetryCount: z.number().int().optional(),\n         staticGenerationMaxConcurrency: z.number().int().optional(),\n@@ -655,6 +643,17 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n     poweredByHeader: z.boolean().optional(),\n     productionBrowserSourceMaps: z.boolean().optional(),\n     publicRuntimeConfig: z.record(z.string(), z.any()).optional(),\n+    reactCompiler: z.union([\n+      z.boolean(),\n+      z\n+        .object({\n+          compilationMode: z.enum(['infer', 'annotation', 'all']).optional(),\n+          panicThreshold: z\n+            .enum(['none', 'critical_errors', 'all_errors'])\n+            .optional(),\n+        })\n+        .optional(),\n+    ]),\n     reactProductionProfiling: z.boolean().optional(),\n     reactStrictMode: z.boolean().nullable().optional(),\n     reactMaxHeadersLength: z.number().nonnegative().int().optional(),"
        },
        {
            "sha": "c46254c20c6f320ed8b626a7ee82f05c3616be0e",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 9,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -476,10 +476,10 @@ export interface ExperimentalConfig {\n    * Set this to `false` to disable the automatic configuration of the babel loader when a Babel\n    * configuration file is present. This option is enabled by default.\n    *\n-   * If this is set to `false`, but `experimental.reactCompiler` is `true`, the built-in Babel will\n+   * If this is set to `false`, but `reactCompiler` is `true`, the built-in Babel will\n    * still be configured, but any Babel configuration files on disk will be ignored. If you wish to\n    * use React Compiler with a different manually-configured `babel-loader`, you should disable both\n-   * this and `experimental.reactCompiler`.\n+   * this and `reactCompiler`.\n    */\n   turbopackUseBuiltinBabel?: boolean\n \n@@ -678,12 +678,6 @@ export interface ExperimentalConfig {\n    *\n    */\n   serverComponentsExternalPackages?: string[]\n-  /**\n-   * Enable experimental React compiler optimization.\n-   * Configuration accepts partial config object to the compiler, if provided\n-   * compiler will be enabled.\n-   */\n-  reactCompiler?: boolean | ReactCompilerOptions\n \n   /**\n    * When enabled, in dev mode, Next.js will send React's debug info through the\n@@ -1099,6 +1093,13 @@ export interface NextConfig {\n    */\n   productionBrowserSourceMaps?: boolean\n \n+  /**\n+   * Enable {@link https://nextjs.org/docs/app/api-reference/config/next-config-js/reactCompiler React Compiler in Next.js}.\n+   * Configuration accepts partial config object of the Compiler.\n+   * If provided, the Compiler will be enabled.\n+   */\n+  reactCompiler?: boolean | ReactCompilerOptions\n+\n   /**\n    * Enable react profiling in production\n    *\n@@ -1374,6 +1375,7 @@ export const defaultConfig = Object.freeze({\n   excludeDefaultMomentLocales: true,\n   serverRuntimeConfig: {},\n   publicRuntimeConfig: {},\n+  reactCompiler: undefined,\n   reactProductionProfiling: false,\n   reactStrictMode: null,\n   reactMaxHeadersLength: 6000,\n@@ -1507,7 +1509,6 @@ export const defaultConfig = Object.freeze({\n       static: 300,\n     },\n     allowDevelopmentBuild: undefined,\n-    reactCompiler: undefined,\n     reactDebugChannel: false,\n     staticGenerationRetryCount: undefined,\n     serverComponentsHmrCache: true,"
        },
        {
            "sha": "9d628c202ccb18f0b6d837b30b69f9a3ececc5ae",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 12,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -664,6 +664,13 @@ function assignDefaultsAndValidate(\n     configFileName,\n     silent\n   )\n+  warnOptionHasBeenMovedOutOfExperimental(\n+    result,\n+    'reactCompiler',\n+    'reactCompiler',\n+    configFileName,\n+    silent\n+  )\n \n   if ((result.experimental as any).outputStandalone) {\n     if (!silent) {\n@@ -1812,19 +1819,11 @@ function enforceExperimentalFeatures(\n   if (\n     process.env.__NEXT_ENABLE_REACT_COMPILER === 'true' &&\n     // We do respect an explicit value in the user config.\n-    (config.experimental.reactCompiler === undefined ||\n-      (isDefaultConfig && !config.experimental.reactCompiler))\n+    (config.reactCompiler === undefined ||\n+      (isDefaultConfig && !config.reactCompiler))\n   ) {\n-    config.experimental.reactCompiler = true\n-\n-    if (configuredExperimentalFeatures) {\n-      addConfiguredExperimentalFeature(\n-        configuredExperimentalFeatures,\n-        'reactCompiler',\n-        true,\n-        'enabled by `__NEXT_ENABLE_REACT_COMPILER`'\n-      )\n-    }\n+    config.reactCompiler = true\n+    // TODO: Report if we enable non-experimental features via env\n   }\n \n   if ("
        },
        {
            "sha": "83068eda784613a3dda7d528313e6f21939ecc1b",
            "filename": "packages/next/src/telemetry/events/version.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fversion.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fversion.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fversion.ts?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -123,14 +123,14 @@ export function eventCliSession(\n     pagesDir: event.pagesDir,\n     staticStaleTime: nextConfig.experimental.staleTimes?.static ?? null,\n     dynamicStaleTime: nextConfig.experimental.staleTimes?.dynamic ?? null,\n-    reactCompiler: Boolean(nextConfig.experimental.reactCompiler),\n+    reactCompiler: Boolean(nextConfig.reactCompiler),\n     reactCompilerCompilationMode:\n-      typeof nextConfig.experimental.reactCompiler !== 'boolean'\n-        ? (nextConfig.experimental.reactCompiler?.compilationMode ?? null)\n+      typeof nextConfig.reactCompiler !== 'boolean'\n+        ? (nextConfig.reactCompiler?.compilationMode ?? null)\n         : null,\n     reactCompilerPanicThreshold:\n-      typeof nextConfig.experimental.reactCompiler !== 'boolean'\n-        ? (nextConfig.experimental.reactCompiler?.panicThreshold ?? null)\n+      typeof nextConfig.reactCompiler !== 'boolean'\n+        ? (nextConfig.reactCompiler?.panicThreshold ?? null)\n         : null,\n   }\n   return [{ eventName: EVENT_VERSION, payload }]"
        },
        {
            "sha": "c32caeb66fa3c78425bf0104c15547dc22e646ac",
            "filename": "test/e2e/react-compiler/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/test%2Fe2e%2Freact-compiler%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/test%2Fe2e%2Freact-compiler%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Freact-compiler%2Fnext.config.js?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -2,9 +2,7 @@\n  * @type {import('next').NextConfig}\n  */\n const nextConfig = {\n-  experimental: {\n-    reactCompiler: true,\n-  },\n+  reactCompiler: true,\n   reactProductionProfiling: true,\n }\n "
        },
        {
            "sha": "0e4d3580c0d8201af64b612bf8768b2bc4ea278c",
            "filename": "test/e2e/react-compiler/react-compiler.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 8,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/test%2Fe2e%2Freact-compiler%2Freact-compiler.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/test%2Fe2e%2Freact-compiler%2Freact-compiler.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Freact-compiler%2Freact-compiler.test.ts?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -1,5 +1,5 @@\n import { nextTestSetup, FileRef } from 'e2e-utils'\n-import { assertHasRedbox, retry } from 'next-test-utils'\n+import { assertHasRedbox } from 'next-test-utils'\n import { join } from 'path'\n import stripAnsi from 'strip-ansi'\n \n@@ -46,13 +46,6 @@ describe.each(['default', 'babelrc'] as const)(\n       },\n     })\n \n-    it('should show an experimental warning', async () => {\n-      await retry(() => {\n-        expect(next.cliOutput).toContain('Experiments (use with caution)')\n-        expect(stripAnsi(next.cliOutput)).toContain('âœ“ reactCompiler')\n-      })\n-    })\n-\n     it('should memoize Components', async () => {\n       const browser = await next.browser('/')\n "
        },
        {
            "sha": "336f026d83652d4f5745b41be99c47bcd9389275",
            "filename": "test/integration/telemetry/next.config.reactCompiler-base",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/test%2Fintegration%2Ftelemetry%2Fnext.config.reactCompiler-base",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/test%2Fintegration%2Ftelemetry%2Fnext.config.reactCompiler-base",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Ftelemetry%2Fnext.config.reactCompiler-base?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -1,5 +1,3 @@\n module.exports = {\n-  experimental: {\n-    reactCompiler: true\n-  }\n+  reactCompiler: true\n }\n\\ No newline at end of file"
        },
        {
            "sha": "9d051d1e78ddd7bfb7bd40b5bc9f5f477f013fab",
            "filename": "test/integration/telemetry/next.config.reactCompiler-options",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/test%2Fintegration%2Ftelemetry%2Fnext.config.reactCompiler-options",
            "raw_url": "https://github.com/vercel/next.js/raw/4642591dc094eb7bc5326345f8e8f910a2a3ce8e/test%2Fintegration%2Ftelemetry%2Fnext.config.reactCompiler-options",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Ftelemetry%2Fnext.config.reactCompiler-options?ref=4642591dc094eb7bc5326345f8e8f910a2a3ce8e",
            "patch": "@@ -1,8 +1,6 @@\n module.exports = {\n-  experimental: {\n-    reactCompiler: {\n-      compilationMode: 'annotation',\n-      panicThreshold: 'critical_errors'\n-    }\n+  reactCompiler: {\n+    compilationMode: 'annotation',\n+    panicThreshold: 'critical_errors'\n   }\n }"
        }
    ],
    "stats": {
        "total": 135,
        "additions": 56,
        "deletions": 79
    }
}