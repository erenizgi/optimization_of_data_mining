{
    "author": "acdlite",
    "message": "[Segment Cache] Fix: Skew during dynamic prefetch (#79416)\n\nFixes a bug that occurred when prefetching a Link to a dynamic page on a\ndifferent deployment. I didn't catch this earlier during dogfooding\nbecause the app we were testing it on was using skew protection. It also\nonly applies to non-PPR/static routes.\n\nThis particular case happens when an app is redeployed on the server,\nbut it can also happen when linking to a completely different Next app.",
    "sha": "646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
    "files": [
        {
            "sha": "ed992f47cb2f3e60cc48a52eb79cedb6b20f7a2d",
            "filename": ".gitignore",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/.gitignore",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/.gitignore",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.gitignore?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -33,6 +33,7 @@ coverage\n # test output\n test/**/out/*\n test/**/next-env.d.ts\n+test/**/.next*\n .DS_Store\n /e2e-tests\n test/tmp/**"
        },
        {
            "sha": "cda058b6c834f84c0b105d027d4002eb3403b9cf",
            "filename": "packages/next/src/client/components/segment-cache-impl/cache.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 9,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fsegment-cache-impl%2Fcache.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fsegment-cache-impl%2Fcache.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fsegment-cache-impl%2Fcache.ts?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -1079,6 +1079,7 @@ export async function fetchRouteOnCacheMiss(\n         // TODO: Consider moving the build ID to a response header so we can check\n         // it before decoding the response, and so there's one way of checking\n         // across all response types.\n+        // TODO: We should cache the fact that this is an MPA navigation.\n         rejectRouteCacheEntry(entry, Date.now() + 10 * 1000)\n         return null\n       }\n@@ -1110,6 +1111,16 @@ export async function fetchRouteOnCacheMiss(\n       const serverData = await (createFromNextReadableStream(\n         prefetchStream\n       ) as Promise<NavigationFlightResponse>)\n+      if (serverData.b !== getAppBuildId()) {\n+        // The server build does not match the client. Treat as a 404. During\n+        // an actual navigation, the router will trigger an MPA navigation.\n+        // TODO: Consider moving the build ID to a response header so we can check\n+        // it before decoding the response, and so there's one way of checking\n+        // across all response types.\n+        // TODO: We should cache the fact that this is an MPA navigation.\n+        rejectRouteCacheEntry(entry, Date.now() + 10 * 1000)\n+        return null\n+      }\n \n       writeDynamicTreeResponseIntoCache(\n         Date.now(),\n@@ -1368,15 +1379,6 @@ function writeDynamicTreeResponseIntoCache(\n   canonicalUrl: string,\n   routeIsPPREnabled: boolean\n ) {\n-  if (serverData.b !== getAppBuildId()) {\n-    // The server build does not match the client. Treat as a 404. During\n-    // an actual navigation, the router will trigger an MPA navigation.\n-    // TODO: Consider moving the build ID to a response header so we can check\n-    // it before decoding the response, and so there's one way of checking\n-    // across all response types.\n-    rejectRouteCacheEntry(entry, now + 10 * 1000)\n-    return\n-  }\n   const normalizedFlightDataResult = normalizeFlightData(serverData.f)\n   if (\n     // A string result means navigating to this route will result in an"
        },
        {
            "sha": "013dff933ca3435e34a5821bc4460b3ffb535103",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/app/dynamic-page/page.jsx",
            "status": "added",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Fdynamic-page%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Fdynamic-page%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Fdynamic-page%2Fpage.jsx?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,6 @@\n+import { connection } from 'next/server'\n+\n+export default async function TargetPage() {\n+  await connection()\n+  return <div id=\"build-id\">Build ID: {process.env.NEXT_PUBLIC_BUILD_ID}</div>\n+}"
        },
        {
            "sha": "484952a22bcbe94c317fbc1aacc0fd5b60ea42b6",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/app/layout.jsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Flayout.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Flayout.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Flayout.jsx?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,7 @@\n+export default function RootLayout({ children, params }) {\n+  return (\n+    <html lang=\"en\">\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "04d6fd10b9f98123b49637bc5d9ad36f270c56bc",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/app/page.jsx",
            "status": "added",
            "additions": 28,
            "deletions": 0,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Fpage.jsx?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,28 @@\n+import { LinkAccordion } from '../components/link-accordion'\n+\n+export default function Page() {\n+  return (\n+    <ul>\n+      <li>\n+        <LinkAccordion href=\"/dynamic-page\">\n+          Dynamic page, same deployment\n+        </LinkAccordion>\n+      </li>\n+      <li>\n+        <LinkAccordion href=\"/dynamic-page?deployment=2\">\n+          Dynamic page, different deployment\n+        </LinkAccordion>\n+      </li>\n+      <li>\n+        <LinkAccordion href=\"/static-page\">\n+          Static page, same deployment\n+        </LinkAccordion>\n+      </li>\n+      <li>\n+        <LinkAccordion href=\"/static-page?deployment=2\">\n+          Static page, different deployment\n+        </LinkAccordion>\n+      </li>\n+    </ul>\n+  )\n+}"
        },
        {
            "sha": "b92db96571130e487dfa48c6d723291c166bfdfd",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/app/static-page/page.jsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Fstatic-page%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Fstatic-page%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fapp%2Fstatic-page%2Fpage.jsx?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,3 @@\n+export default function TargetPage() {\n+  return <div id=\"build-id\">Build ID: {process.env.NEXT_PUBLIC_BUILD_ID}</div>\n+}"
        },
        {
            "sha": "6ac062fd77d8588025a9a4e3b77299cc3cdd61bf",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/build.mjs",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fbuild.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fbuild.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fbuild.mjs?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,3 @@\n+import { build } from './servers.mjs'\n+\n+build()"
        },
        {
            "sha": "c735a55918b5489458940dcdd29daa6f2ec50315",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/components/link-accordion.tsx",
            "status": "added",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fcomponents%2Flink-accordion.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fcomponents%2Flink-accordion.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fcomponents%2Flink-accordion.tsx?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,33 @@\n+'use client'\n+\n+import Link from 'next/link'\n+import { useState } from 'react'\n+\n+export function LinkAccordion({\n+  href,\n+  children,\n+  prefetch,\n+}: {\n+  href: string\n+  children: React.ReactNode\n+  prefetch?: boolean\n+}) {\n+  const [isVisible, setIsVisible] = useState(false)\n+  return (\n+    <>\n+      <input\n+        type=\"checkbox\"\n+        checked={isVisible}\n+        onChange={() => setIsVisible(!isVisible)}\n+        data-link-accordion={href}\n+      />\n+      {isVisible ? (\n+        <Link href={href} prefetch={prefetch}>\n+          {children}\n+        </Link>\n+      ) : (\n+        <>{children} (link is hidden)</>\n+      )}\n+    </>\n+  )\n+}"
        },
        {
            "sha": "881e122d4e27836512f67411959b4ef5d7cb68bd",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/deployment-skew.test.ts",
            "status": "added",
            "additions": 105,
            "deletions": 0,
            "changes": 105,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fdeployment-skew.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fdeployment-skew.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fdeployment-skew.test.ts?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,105 @@\n+import type * as Playwright from 'playwright'\n+import webdriver from 'next-webdriver'\n+import { createRouterAct } from '../router-act'\n+import { findPort } from 'next-test-utils'\n+import { isNextDeploy, isNextDev } from 'e2e-utils'\n+import { build, start } from './servers.mjs'\n+\n+describe('segment cache (deployment skew)', () => {\n+  if (isNextDev || isNextDeploy) {\n+    test('should not run during dev or deploy test runs', () => {})\n+    return\n+  }\n+\n+  // To debug these tests locally, first build the app:\n+  //   node build.mjs\n+  //\n+  // Then start:\n+  //   node start.mjs\n+  //\n+  // This will build two versions of the same app on different ports, then\n+  // start a proxy server that rewrites incoming requests to one or the other\n+  // based on the request information.\n+\n+  let cleanup: () => Promise<void>\n+  let port: number\n+\n+  beforeAll(async () => {\n+    build()\n+    const proxyPort = (port = await findPort())\n+    const nextPort1 = await findPort()\n+    const nextPort2 = await findPort()\n+    cleanup = await start(proxyPort, nextPort1, nextPort2)\n+  })\n+\n+  afterAll(async () => {\n+    await cleanup()\n+  })\n+\n+  it(\n+    'does not crash when prefetching a dynamic, non-PPR page ' +\n+      'on a different deployment',\n+    async () => {\n+      // Reproduces a bug that occurred when prefetching a dynamic page\n+      // from a different deployment, when PPR is disabled. Once PPR is the\n+      // default, it's OK to rewrite this to use the latest APIs.\n+      let act\n+      const browser = await webdriver(port, '/', {\n+        beforePageLoad(p: Playwright.Page) {\n+          act = createRouterAct(p)\n+        },\n+      })\n+\n+      // Initiate a prefetch of link to a different deployment\n+      await act(async () => {\n+        const checkbox = await browser.elementByCss(\n+          '[data-link-accordion=\"/dynamic-page?deployment=2\"]'\n+        )\n+        await checkbox.click()\n+      })\n+\n+      // Navigate to the target page\n+      const link = await browser.elementByCss(\n+        'a[href=\"/dynamic-page?deployment=2\"]'\n+      )\n+      await link.click()\n+\n+      // Should have performed a full-page navigation to the new deployment.\n+      const buildId = await browser.elementById('build-id')\n+      expect(await buildId.text()).toBe('Build ID: 2')\n+    },\n+    60 * 1000\n+  )\n+\n+  it(\n+    'does not crash when prefetching a static page on a different deployment',\n+    async () => {\n+      // Same as the previous test, but for a static page\n+      let act\n+      const browser = await webdriver(port, '/', {\n+        beforePageLoad(p: Playwright.Page) {\n+          act = createRouterAct(p)\n+        },\n+      })\n+\n+      // Initiate a prefetch of link to a different deployment\n+      await act(async () => {\n+        const checkbox = await browser.elementByCss(\n+          '[data-link-accordion=\"/static-page?deployment=2\"]'\n+        )\n+        await checkbox.click()\n+      })\n+\n+      // Navigate to the target page\n+      const link = await browser.elementByCss(\n+        'a[href=\"/static-page?deployment=2\"]'\n+      )\n+      await link.click()\n+\n+      // Should have performed a full-page navigation to the new deployment.\n+      const buildId = await browser.elementById('build-id')\n+      expect(await buildId.text()).toBe('Build ID: 2')\n+    },\n+    60 * 1000\n+  )\n+})"
        },
        {
            "sha": "447c8eb02a9fb97895e881a4dcb19df69718e40d",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/next.config.js",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fnext.config.js?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,21 @@\n+const BUILD_ID = process.env.BUILD_ID\n+if (!BUILD_ID) {\n+  throw new Error('BUILD_ID is not set')\n+}\n+\n+/**\n+ * @type {import('next').NextConfig}\n+ */\n+const nextConfig = {\n+  experimental: {\n+    clientSegmentCache: true,\n+  },\n+\n+  distDir: '.next.' + BUILD_ID,\n+\n+  async generateBuildId() {\n+    return BUILD_ID\n+  },\n+}\n+\n+module.exports = nextConfig"
        },
        {
            "sha": "fea9847c81f45029ca7a110f1aac4fc6985979f3",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/servers.mjs",
            "status": "added",
            "additions": 102,
            "deletions": 0,
            "changes": 102,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fservers.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fservers.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fservers.mjs?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,102 @@\n+import { fileURLToPath } from 'url'\n+import { dirname } from 'path'\n+import { spawn, spawnSync } from 'child_process'\n+import { createServer } from 'node:http'\n+import httpProxy from 'http-proxy'\n+import process from 'node:process'\n+\n+const dir = dirname(fileURLToPath(import.meta.url))\n+\n+async function spawnNext(buildId, port) {\n+  const child = spawn('pnpm', ['next', 'start', '-p', port, dir], {\n+    env: {\n+      ...process.env,\n+      BUILD_ID: buildId,\n+      NEXT_PUBLIC_BUILD_ID: buildId,\n+    },\n+    stdio: ['inherit', 'pipe', 'inherit'],\n+  })\n+\n+  child.stdout.pipe(process.stdout)\n+\n+  // Wait until the server is listening.\n+  return new Promise((resolve, reject) => {\n+    child.stdout.on('data', (data) => {\n+      if (data.toString().includes('Ready')) {\n+        resolve(child)\n+      }\n+    })\n+    child.on('exit', (code) => {\n+      if (code === 0) {\n+        resolve(child)\n+      } else {\n+        reject(new Error(`Next.js server exited with code ${code}`))\n+      }\n+    })\n+  })\n+}\n+\n+export function buildNext(buildId) {\n+  spawnSync('pnpm', ['next', 'build', dir], {\n+    env: {\n+      ...process.env,\n+      BUILD_ID: buildId,\n+      NEXT_PUBLIC_BUILD_ID: buildId,\n+    },\n+    stdio: 'inherit',\n+  })\n+}\n+\n+export function build() {\n+  buildNext('1')\n+  buildNext('2')\n+}\n+\n+export async function start(\n+  mainPort = 3000,\n+  nextPort1 = mainPort + 1,\n+  nextPort2 = mainPort + 2\n+) {\n+  // Start two different Next.js servers, one with BUILD_ID=1 and one\n+  // with BUILD_ID=2\n+  const [next1, next2] = await Promise.all([\n+    spawnNext('1', nextPort1),\n+    spawnNext('2', nextPort2),\n+  ])\n+\n+  // Create a proxy server. If search params include `deployment=2`, proxy to\n+  // to the second next server. Otherwise, proxy to the first.\n+  const proxy = httpProxy.createProxyServer()\n+  const server = createServer((req, res) => {\n+    let port = nextPort1\n+    if (req.url) {\n+      const searchParams = new URL(req.url, 'http://localhost').searchParams\n+      if (searchParams.get('deployment') === '2') {\n+        port = nextPort2\n+      }\n+    }\n+    proxy.web(req, res, { target: `http://localhost:${port}` })\n+  })\n+\n+  const onTerminate = () => {\n+    server.close()\n+    next1.kill()\n+    next2.kill()\n+    process.exit(0)\n+  }\n+  process.on('SIGINT', onTerminate)\n+  process.on('SIGTERM', onTerminate)\n+\n+  const cleanup = async () => {\n+    next1.kill()\n+    next2.kill()\n+    await new Promise((resolve) => server.close(resolve))\n+  }\n+\n+  return new Promise((resolve, reject) => {\n+    server.on('error', reject)\n+    server.listen(mainPort, () => {\n+      resolve(cleanup)\n+    })\n+  })\n+}"
        },
        {
            "sha": "d66f164978dcc14b75df56d9646c8058580dcbd1",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/start.mjs",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fstart.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fstart.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fstart.mjs?ref=646b4c3c60695c16aa47f2e1b3688fb0df7dbeb8",
            "patch": "@@ -0,0 +1,3 @@\n+import { start } from './servers.mjs'\n+\n+await start()"
        }
    ],
    "stats": {
        "total": 332,
        "additions": 323,
        "deletions": 9
    }
}