{
    "author": "JakobKlotz",
    "message": "Docker example using bun (#83040)\n\n### What?\n\nExpanded the `with-docker` example for usage with `bun` and added build\ninstructions to the README.\n\n### Why?\n\nThe existing example supports npm, yarn and pnpm, but not bun. \n\n### How?\n\n- Add a separate Dockerfile.bun placed next to the existing Dockerfile,\nwhich is more sensible for the existing solution.\n- Dockerfile.bun uses the official oven/bun base image (different\nruntime/tooling than node:18-alpine), so a separate file should be\nclearer.\n- Existing Docker commands in the README remain unchanged, because\nDocker still uses the existing Dockerfile by default.\n- The bun example can be built with: `docker build -f Dockerfile.bun -t\nnextjs-docker .`\n\nRelated to #78465, #82998\n\n---------\n\nCo-authored-by: Joseph <joseph.chamochumbi@vercel.com>\nCo-authored-by: vercel[bot] <35613825+vercel[bot]@users.noreply.github.com>\nCo-authored-by: Joseph <sephxd1234@gmail.com>",
    "sha": "f41c80935323ad2021c2b1ef97a47ce8d9408093",
    "files": [
        {
            "sha": "a7cdafaf9c7e480b5deb43bc50d16ab03fa24464",
            "filename": "examples/with-docker/Dockerfile.bun",
            "status": "added",
            "additions": 54,
            "deletions": 0,
            "changes": 54,
            "blob_url": "https://github.com/vercel/next.js/blob/f41c80935323ad2021c2b1ef97a47ce8d9408093/examples%2Fwith-docker%2FDockerfile.bun",
            "raw_url": "https://github.com/vercel/next.js/raw/f41c80935323ad2021c2b1ef97a47ce8d9408093/examples%2Fwith-docker%2FDockerfile.bun",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/examples%2Fwith-docker%2FDockerfile.bun?ref=f41c80935323ad2021c2b1ef97a47ce8d9408093",
            "patch": "@@ -0,0 +1,54 @@\n+# -----------------------------------------------------------------------------\n+# This Dockerfile.bun is specifically configured for projects using Bun\n+# For npm/pnpm or yarn, refer to the Dockerfile instead\n+# -----------------------------------------------------------------------------\n+\n+# Use Bun's official image\n+FROM oven/bun:1 AS base\n+\n+WORKDIR /app\n+\n+# Install dependencies with bun\n+FROM base AS deps\n+COPY package.json bun.lock* ./\n+RUN bun install --no-save --frozen-lockfile\n+\n+# Rebuild the source code only when needed\n+FROM base AS builder\n+WORKDIR /app\n+COPY --from=deps /app/node_modules ./node_modules\n+COPY . .\n+\n+# Next.js collects completely anonymous telemetry data about general usage.\n+# Learn more here: https://nextjs.org/telemetry\n+# Uncomment the following line in case you want to disable telemetry during the build.\n+# ENV NEXT_TELEMETRY_DISABLED=1\n+\n+RUN bun run build\n+\n+# Production image, copy all the files and run next\n+FROM base AS runner\n+WORKDIR /app\n+\n+# Uncomment the following line in case you want to disable telemetry during runtime.\n+# ENV NEXT_TELEMETRY_DISABLED=1\n+\n+ENV NODE_ENV=production \\\n+    PORT=3000 \\\n+    HOSTNAME=\"0.0.0.0\"\n+\n+RUN addgroup --system --gid 1001 nodejs && \\\n+    adduser --system --uid 1001 nextjs\n+\n+COPY --from=builder /app/public ./public\n+\n+# Automatically leverage output traces to reduce image size\n+# https://nextjs.org/docs/advanced-features/output-file-tracing\n+COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./\n+COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static\n+\n+USER nextjs\n+\n+EXPOSE 3000\n+\n+CMD [\"bun\", \"./server.js\"]"
        },
        {
            "sha": "592b41773b4dd4a99d412eef54461a388b70e2d7",
            "filename": "examples/with-docker/README.md",
            "status": "modified",
            "additions": 16,
            "deletions": 3,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/f41c80935323ad2021c2b1ef97a47ce8d9408093/examples%2Fwith-docker%2FREADME.md",
            "raw_url": "https://github.com/vercel/next.js/raw/f41c80935323ad2021c2b1ef97a47ce8d9408093/examples%2Fwith-docker%2FREADME.md",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/examples%2Fwith-docker%2FREADME.md?ref=f41c80935323ad2021c2b1ef97a47ce8d9408093",
            "patch": "@@ -4,7 +4,7 @@ This examples shows how to use Docker with Next.js based on the [deployment docu\n \n ## How to use\n \n-Execute [`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app) with [npm](https://docs.npmjs.com/cli/init), [Yarn](https://yarnpkg.com/lang/en/docs/cli/create/), or [pnpm](https://pnpm.io) to bootstrap the example:\n+Execute [`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app) with [npm](https://docs.npmjs.com/cli/init), [Yarn](https://yarnpkg.com/lang/en/docs/cli/create/), [pnpm](https://pnpm.io) or [bun](https://bun.sh/docs/cli/bun-create) to bootstrap the example:\n \n ```bash\n npx create-next-app --example with-docker nextjs-docker\n@@ -18,17 +18,28 @@ yarn create next-app --example with-docker nextjs-docker\n pnpm create next-app --example with-docker nextjs-docker\n ```\n \n+```bash\n+bun create next-app --example with-docker nextjs-docker\n+```\n+\n ## Using Docker\n \n 1. [Install Docker](https://docs.docker.com/get-docker/) on your machine.\n-1. Build your container: `docker build -t nextjs-docker .`.\n+1. Build your container: \n+    ```bash\n+    # For npm, pnpm or yarn\n+    docker build -t nextjs-docker .\n+    \n+    # For bun\n+    docker build -f Dockerfile.bun -t nextjs-docker .\n+    ```\n 1. Run your container: `docker run -p 3000:3000 nextjs-docker`.\n \n You can view your images created with `docker images`.\n \n ### In existing projects\n \n-To add support for Docker to an existing project, just copy the [`Dockerfile`](https://github.com/vercel/next.js/blob/canary/examples/with-docker/Dockerfile) into the root of the project and add the following to the `next.config.js` file:\n+To add Docker support, copy [`Dockerfile`](https://github.com/vercel/next.js/blob/canary/examples/with-docker/Dockerfile) to the project root. If using Bun, copy [`Dockerfile.bun`](https://github.com/vercel/next.js/blob/canary/examples/with-docker/Dockerfile.bun) instead. Then add the following to next.config.js:\n \n ```js\n // next.config.js\n@@ -59,6 +70,8 @@ First, run the development server:\n npm run dev\n # or\n yarn dev\n+# or\n+bun run dev\n ```\n \n Open [http://localhost:3000](http://localhost:3000) with your browser to see the result."
        }
    ],
    "stats": {
        "total": 73,
        "additions": 70,
        "deletions": 3
    }
}