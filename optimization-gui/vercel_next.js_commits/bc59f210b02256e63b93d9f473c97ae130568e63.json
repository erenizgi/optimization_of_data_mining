{
    "author": "devjiwonchoi",
    "message": "docs: Deprecation of Middleware (#84710)\n\nThis PR removes middleware docs and adds a \"Migration to Proxy\" section\nto the Proxy docs, which explains the rationale for the renaming to\nProxy and provides a migration guide.\n\nDid not remove `middleware-upgrade-docs` as it's an upgrade doc from the\nlegacy middleware.\n\nBelow are untouched as they need codebase changes:\n\n- `instrumentation` docs - `onRequestError` has `context.routeType` as\n`'middleware'`\n- `adapterPath` docs - has `MiddlewareMatcher` type example\n- `ProxyConfig` - has a user-facing `MiddlewareMatcher` type\n\n---------\n\nCo-authored-by: Joseph Chamochumbi <joseph.chamochumbi@vercel.com>",
    "sha": "bc59f210b02256e63b93d9f473c97ae130568e63",
    "files": [
        {
            "sha": "7d2246b5dbf1f03d74c7e90e88f7b9235bbcf948",
            "filename": "docs/01-app/01-getting-started/02-project-structure.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F01-getting-started%2F02-project-structure.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F01-getting-started%2F02-project-structure.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F01-getting-started%2F02-project-structure.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -29,15 +29,15 @@ Top-level folders are used to organize your application's code and static assets\n \n ### Top-level files\n \n-Top-level files are used to configure your application, manage dependencies, run middleware, integrate monitoring tools, and define environment variables.\n+Top-level files are used to configure your application, manage dependencies, run proxy, integrate monitoring tools, and define environment variables.\n \n |                                                                              |                                         |\n | ---------------------------------------------------------------------------- | --------------------------------------- |\n | **Next.js**                                                                  |                                         |\n | [`next.config.js`](/docs/app/api-reference/config/next-config-js)            | Configuration file for Next.js          |\n | [`package.json`](/docs/app/getting-started/installation#manual-installation) | Project dependencies and scripts        |\n | [`instrumentation.ts`](/docs/app/guides/instrumentation)                     | OpenTelemetry and Instrumentation file  |\n-| [`middleware.ts`](/docs/app/api-reference/file-conventions/middleware)       | Next.js request middleware              |\n+| [`proxy.ts`](/docs/app/api-reference/file-conventions/proxy)                 | Next.js request proxy                   |\n | [`.env`](/docs/app/guides/environment-variables)                             | Environment variables                   |\n | [`.env.local`](/docs/app/guides/environment-variables)                       | Local environment variables             |\n | [`.env.production`](/docs/app/guides/environment-variables)                  | Production environment variables        |"
        },
        {
            "sha": "66c912345a7538660247ead57bcf5565f1772cfc",
            "filename": "docs/01-app/01-getting-started/16-proxy.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F01-getting-started%2F16-proxy.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F01-getting-started%2F16-proxy.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F01-getting-started%2F16-proxy.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -6,8 +6,7 @@ related:\n   title: API Reference\n   description: Learn more about Proxy\n   links:\n-    # TODO: Update to proxy docs\n-    - app/api-reference/file-conventions/middleware\n+    - app/api-reference/file-conventions/proxy\n     - app/guides/backend-for-frontend\n ---\n \n@@ -67,6 +66,4 @@ export const config = {\n }\n ```\n \n-{/* TODO: Update to proxy docs */}\n-\n-Read more about [using `proxy`](/docs/app/guides/backend-for-frontend#middleware), or refer to the `proxy` [API reference](/docs/app/api-reference/file-conventions/middleware).\n+Read more about [using `proxy`](/docs/app/guides/backend-for-frontend#proxy), or refer to the `proxy` [API reference](/docs/app/api-reference/file-conventions/proxy)."
        },
        {
            "sha": "8bb01cde930215d0b1faa275af62294ce626d735",
            "filename": "docs/01-app/02-guides/authentication.mdx",
            "status": "modified",
            "additions": 17,
            "deletions": 17,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fauthentication.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fauthentication.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fauthentication.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -871,7 +871,7 @@ To create and manage database sessions, you'll need to follow these steps:\n \n 1. Create a table in your database to store session and data (or check if your Auth Library handles this).\n 2. Implement functionality to insert, update, and delete sessions\n-3. Encrypt the session ID before storing it in the user's browser, and ensure the database and cookie stay in sync (this is optional, but recommended for optimistic auth checks in [Middleware](#optimistic-checks-with-middleware-optional)).\n+3. Encrypt the session ID before storing it in the user's browser, and ensure the database and cookie stay in sync (this is optional, but recommended for optimistic auth checks in [Proxy](#optimistic-checks-with-proxy-optional)).\n \n <AppOnly>\n \n@@ -1019,20 +1019,20 @@ For both cases, we recommend:\n \n - Creating a [Data Access Layer](#creating-a-data-access-layer-dal) to centralize your authorization logic\n - Using [Data Transfer Objects (DTO)](#using-data-transfer-objects-dto) to only return the necessary data\n-- Optionally use [Middleware](#optimistic-checks-with-middleware-optional) to perform optimistic checks.\n+- Optionally use [Proxy](#optimistic-checks-with-proxy-optional) to perform optimistic checks.\n \n-### Optimistic checks with Middleware (Optional)\n+### Optimistic checks with Proxy (Optional)\n \n-There are some cases where you may want to use [Middleware](/docs/app/api-reference/file-conventions/middleware) and redirect users based on permissions:\n+There are some cases where you may want to use [Proxy](/docs/app/api-reference/file-conventions/proxy) and redirect users based on permissions:\n \n-- To perform optimistic checks. Since Middleware runs on every route, it's a good way to centralize redirect logic and pre-filter unauthorized users.\n+- To perform optimistic checks. Since Proxy runs on every route, it's a good way to centralize redirect logic and pre-filter unauthorized users.\n - To protect static routes that share data between users (e.g. content behind a paywall).\n \n-However, since Middleware runs on every route, including [prefetched](/docs/app/getting-started/linking-and-navigating#prefetching) routes, it's important to only read the session from the cookie (optimistic checks), and avoid database checks to prevent performance issues.\n+However, since Proxy runs on every route, including [prefetched](/docs/app/getting-started/linking-and-navigating#prefetching) routes, it's important to only read the session from the cookie (optimistic checks), and avoid database checks to prevent performance issues.\n \n For example:\n \n-```tsx filename=\"middleware.ts\" switcher\n+```tsx filename=\"proxy.ts\" switcher\n import { NextRequest, NextResponse } from 'next/server'\n import { decrypt } from '@/app/lib/session'\n import { cookies } from 'next/headers'\n@@ -1041,7 +1041,7 @@ import { cookies } from 'next/headers'\n const protectedRoutes = ['/dashboard']\n const publicRoutes = ['/login', '/signup', '/']\n \n-export default async function middleware(req: NextRequest) {\n+export default async function proxy(req: NextRequest) {\n   // 2. Check if the current route is protected or public\n   const path = req.nextUrl.pathname\n   const isProtectedRoute = protectedRoutes.includes(path)\n@@ -1068,13 +1068,13 @@ export default async function middleware(req: NextRequest) {\n   return NextResponse.next()\n }\n \n-// Routes Middleware should not run on\n+// Routes Proxy should not run on\n export const config = {\n   matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)'],\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { NextResponse } from 'next/server'\n import { decrypt } from '@/app/lib/session'\n import { cookies } from 'next/headers'\n@@ -1083,7 +1083,7 @@ import { cookies } from 'next/headers'\n const protectedRoutes = ['/dashboard']\n const publicRoutes = ['/login', '/signup', '/']\n \n-export default async function middleware(req) {\n+export default async function proxy(req) {\n   // 2. Check if the current route is protected or public\n   const path = req.nextUrl.pathname\n   const isProtectedRoute = protectedRoutes.includes(path)\n@@ -1110,19 +1110,19 @@ export default async function middleware(req) {\n   return NextResponse.next()\n }\n \n-// Routes Middleware should not run on\n+// Routes Proxy should not run on\n export const config = {\n   matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)'],\n }\n ```\n \n-While Middleware can be useful for initial checks, it should not be your only line of defense in protecting your data. The majority of security checks should be performed as close as possible to your data source, see [Data Access Layer](#creating-a-data-access-layer-dal) for more information.\n+While Proxy can be useful for initial checks, it should not be your only line of defense in protecting your data. The majority of security checks should be performed as close as possible to your data source, see [Data Access Layer](#creating-a-data-access-layer-dal) for more information.\n \n > **Tips**:\n >\n-> - In Middleware, you can also read cookies using `req.cookies.get('session').value`.\n-> - Middleware uses the [Edge Runtime](/docs/app/api-reference/edge), check if your Auth library and session management library are compatible.\n-> - You can use the `matcher` property in the Middleware to specify which routes Middleware should run on. Although, for auth, it's recommended Middleware runs on all routes.\n+> - In Proxy, you can also read cookies using `req.cookies.get('session').value`.\n+> - Proxy uses the [Edge Runtime](/docs/app/api-reference/edge), check if your Auth library and session management library are compatible.\n+> - You can use the `matcher` property in the Proxy to specify which routes Proxy should run on. Although, for auth, it's recommended Proxy runs on all routes.\n \n <AppOnly>\n \n@@ -1226,7 +1226,7 @@ export const getUser = cache(async () => {\n \n > **Tip**:\n >\n-> - A DAL can be used to protect data fetched at request time. However, for static routes that share data between users, data will be fetched at build time and not at request time. Use [Middleware](#optimistic-checks-with-middleware-optional) to protect static routes.\n+> - A DAL can be used to protect data fetched at request time. However, for static routes that share data between users, data will be fetched at build time and not at request time. Use [Proxy](#optimistic-checks-with-proxy-optional) to protect static routes.\n > - For secure checks, you can check if the session is valid by comparing the session ID with your database. Use React's [cache](https://react.dev/reference/react/cache) function to avoid unnecessary duplicate requests to the database during a render pass.\n > - You may wish to consolidate related data requests in a JavaScript class that runs `verifySession()` before any methods.\n "
        },
        {
            "sha": "9c3c16f1525b361edf227102cd1e1d85889b17c8",
            "filename": "docs/01-app/02-guides/backend-for-frontend.mdx",
            "status": "modified",
            "additions": 32,
            "deletions": 30,
            "changes": 62,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fbackend-for-frontend.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fbackend-for-frontend.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fbackend-for-frontend.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -4,10 +4,10 @@ nav_title: Backend for Frontend\n description: Learn how to use Next.js as a backend framework\n related:\n   title: API Reference\n-  description: Learn more about Route Handlers and Middleware\n+  description: Learn more about Route Handlers and Proxy\n   links:\n     - app/api-reference/file-conventions/route\n-    - app/api-reference/file-conventions/middleware\n+    - app/api-reference/file-conventions/proxy\n ---\n \n Next.js supports the \"Backend for Frontend\" pattern. This lets you create public endpoints to handle HTTP requests and return any content type—not just HTML. You can also access data sources and perform side effects like updating remote data.\n@@ -27,7 +27,7 @@ npx create-next-app@latest --api\n To implement this pattern, use:\n \n - [Route Handlers](/docs/app/api-reference/file-conventions/route)\n-- [`middleware`](/docs/app/api-reference/file-conventions/middleware)\n+- [`proxy`](/docs/app/api-reference/file-conventions/proxy)\n - In Pages Router, [API Routes](/docs/pages/building-your-application/routing/api-routes)\n \n ## Public Endpoints\n@@ -330,7 +330,7 @@ export async function POST(request) {\n \n ## Proxying to a backend\n \n-You can use a Route Handler as a proxy to another backend. Add validation logic before forwarding the request.\n+You can use a Route Handler as a `proxy` to another backend. Add validation logic before forwarding the request.\n \n ```ts filename=\"/app/api/[...slug]/route.ts\" switcher\n import { isValidRequest } from '@/lib/utils'\n@@ -388,12 +388,12 @@ export async function POST(request, { params }) {\n \n Or use:\n \n-- `middleware` [rewrites](#middleware)\n+- `proxy` [rewrites](#proxy)\n - [`rewrites`](/docs/app/api-reference/config/next-config-js/rewrites) in `next.config.js`.\n \n ## NextRequest and NextResponse\n \n-Next.js extends the [`Request`](https://developer.mozilla.org/en-US/docs/Web/API/Request) and [`Response`](https://developer.mozilla.org/en-US/docs/Web/API/Response) Web APIs with methods that simplify common operations. These extensions are available in both Route Handlers and Middleware.\n+Next.js extends the [`Request`](https://developer.mozilla.org/en-US/docs/Web/API/Request) and [`Response`](https://developer.mozilla.org/en-US/docs/Web/API/Response) Web APIs with methods that simplify common operations. These extensions are available in both Route Handlers and Proxy.\n \n Both provide methods for reading and manipulating cookies.\n \n@@ -557,20 +557,20 @@ export async function GET(request) {\n \n Learn more about redirects in [`redirect`](/docs/app/api-reference/functions/redirect) and [`permanentRedirect`](/docs/app/api-reference/functions/permanentRedirect)\n \n-## Middleware\n+## Proxy\n \n-Only one middleware file is allowed per project. Use `config.matcher` to target specific paths. Learn more about [middleware](/docs/app/api-reference/file-conventions/middleware).\n+Only one `proxy` file is allowed per project. Use `config.matcher` to target specific paths. Learn more about [`proxy`](/docs/app/api-reference/file-conventions/proxy).\n \n-Use `middleware` to generate a response before the request reaches a route path.\n+Use `proxy` to generate a response before the request reaches a route path.\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n import { isAuthenticated } from '@lib/auth'\n \n export const config = {\n   matcher: '/api/:function*',\n }\n \n-export function middleware(request: Request) {\n+export function proxy(request: Request) {\n   if (!isAuthenticated(request)) {\n     return Response.json(\n       { success: false, message: 'authentication failed' },\n@@ -580,14 +580,14 @@ export function middleware(request: Request) {\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { isAuthenticated } from '@lib/auth'\n \n export const config = {\n   matcher: '/api/:function*',\n }\n \n-export function middleware(request) {\n+export function proxy(request) {\n   if (!isAuthenticated(request)) {\n     return Response.json(\n       { success: false, message: 'authentication failed' },\n@@ -597,47 +597,47 @@ export function middleware(request) {\n }\n ```\n \n-You can also proxy requests using `middleware`:\n+You can also proxy requests using `proxy`:\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n import { NextResponse } from 'next/server'\n \n-export function middleware(request: Request) {\n+export function proxy(request: Request) {\n   if (request.nextUrl.pathname === '/proxy-this-path') {\n     const rewriteUrl = new URL('https://nextjs.org')\n     return NextResponse.rewrite(rewriteUrl)\n   }\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { NextResponse } from 'next/server'\n \n-export function middleware(request) {\n+export function proxy(request) {\n   if (request.nextUrl.pathname === '/proxy-this-path') {\n     const rewriteUrl = new URL('https://nextjs.org')\n     return NextResponse.rewrite(rewriteUrl)\n   }\n }\n ```\n \n-Another type of response `middleware` can produce are redirects:\n+Another type of response `proxy` can produce are redirects:\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n import { NextResponse } from 'next/server'\n \n-export function middleware(request: Request) {\n+export function proxy(request: Request) {\n   if (request.nextUrl.pathname === '/v1/docs') {\n     request.nextUrl.pathname = '/v2/docs'\n     return NextResponse.redirect(request.nextUrl)\n   }\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { NextResponse } from 'next/server'\n \n-export function middleware(request) {\n+export function proxy(request) {\n   if (request.nextUrl.pathname === '/v1/docs') {\n     request.nextUrl.pathname = '/v2/docs'\n     return NextResponse.redirect(request.nextUrl)\n@@ -651,10 +651,10 @@ export function middleware(request) {\n \n Be deliberate about where headers go, and avoid directly passing incoming request headers to the outgoing response.\n \n-- **Upstream request headers**: In Middleware, `NextResponse.next({ request: { headers } })` modifies the headers your server receives and does not expose them to the client.\n+- **Upstream request headers**: In Proxy, `NextResponse.next({ request: { headers } })` modifies the headers your server receives and does not expose them to the client.\n - **Response headers**: `new Response(..., { headers })`, `NextResponse.json(..., { headers })`, `NextResponse.next({ headers })`, or `response.headers.set(...)` send headers back to the client. If sensitive values were appended to these headers, they will be visible to clients.\n \n-Learn more in [NextResponse headers in Middleware](/docs/app/api-reference/functions/next-response#next).\n+Learn more in [NextResponse headers in Proxy](/docs/app/api-reference/functions/next-response#next).\n \n ### Rate limiting\n \n@@ -700,7 +700,7 @@ Store user-generated static assets in dedicated services. When possible, upload\n \n ### Access to protected resources\n \n-Always verify credentials before granting access. Do not rely on middleware alone for authentication and authorization.\n+Always verify credentials before granting access. Do not rely on proxy alone for authentication and authorization.\n \n Remove sensitive or unnecessary data from responses and backend logs.\n \n@@ -732,19 +732,21 @@ export { handler as POST }\n \n This creates a shared handler for `GET` and `POST` requests. The library customizes behavior based on the `method` and `pathname` in the request.\n \n-Libraries can also provide a `middleware` factory.\n+Libraries can also provide a `proxy` factory.\n \n-```ts filename=\"middleware.ts\"\n+```ts filename=\"proxy.ts\"\n import { createMiddleware } from 'third-party-library'\n \n export default createMiddleware()\n ```\n \n+> **Good to know**: Third-party libraries may still refer to `proxy` as `middleware`.\n+\n ## More examples\n \n-See more examples on using [Router Handlers](/docs/app/api-reference/file-conventions/route#examples) and the [`middleware`](/docs/app/api-reference/file-conventions/middleware#examples) API references.\n+See more examples on using [Router Handlers](/docs/app/api-reference/file-conventions/route#examples) and the [`proxy`](/docs/app/api-reference/file-conventions/proxy#examples) API references.\n \n-These examples include, working with [Cookies](/docs/app/api-reference/file-conventions/route#cookies), [Headers](/docs/app/api-reference/file-conventions/route#headers), [Streaming](/docs/app/api-reference/file-conventions/route#streaming), Middleware [negative matching](/docs/app/api-reference/file-conventions/middleware#negative-matching), and other useful code snippets.\n+These examples include, working with [Cookies](/docs/app/api-reference/file-conventions/route#cookies), [Headers](/docs/app/api-reference/file-conventions/route#headers), [Streaming](/docs/app/api-reference/file-conventions/route#streaming), Proxy [negative matching](/docs/app/api-reference/file-conventions/proxy#negative-matching), and other useful code snippets.\n \n ## Caveats\n "
        },
        {
            "sha": "2510f46b336b76081c761f1b901ac12716f2495d",
            "filename": "docs/01-app/02-guides/caching.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fcaching.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fcaching.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fcaching.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -31,7 +31,7 @@ By default, Next.js will cache as much as possible to improve performance and re\n \n Caching behavior changes depending on whether the route is statically or dynamically rendered, data is cached or uncached, and whether a request is part of an initial visit or a subsequent navigation. Depending on your use case, you can configure the caching behavior for individual routes and data requests.\n \n-Fetch caching is **not** supported in `middleware`. Any fetches done inside of your `middleware` will be uncached.\n+Fetch caching is **not** supported in `proxy`. Any fetches done inside of your `proxy` will be uncached.\n \n ## Request Memoization\n "
        },
        {
            "sha": "5028a5867a59f0c202dbba9a00de738f15822f96",
            "filename": "docs/01-app/02-guides/content-security-policy.mdx",
            "status": "modified",
            "additions": 21,
            "deletions": 21,
            "changes": 42,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fcontent-security-policy.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fcontent-security-policy.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fcontent-security-policy.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -4,7 +4,7 @@ nav_title: Content Security Policy\n description: Learn how to set a Content Security Policy (CSP) for your Next.js application.\n related:\n   links:\n-    - app/api-reference/file-conventions/middleware\n+    - app/api-reference/file-conventions/proxy\n     - app/api-reference/functions/headers\n ---\n \n@@ -31,18 +31,18 @@ CSP can block both inline and external scripts to prevent attacks. A nonce lets\n \n If an attacker wanted to load a script into your page, they'd need to guess the nonce value. That's why the nonce must be unpredictable and unique for every request.\n \n-### Adding a nonce with Middleware\n+### Adding a nonce with Proxy\n \n-[Middleware](/docs/app/api-reference/file-conventions/middleware) enables you to add headers and generate nonces before the page renders.\n+[Proxy](/docs/app/api-reference/file-conventions/proxy) enables you to add headers and generate nonces before the page renders.\n \n Every time a page is viewed, a fresh nonce should be generated. This means that you **must use [dynamic rendering](/docs/app/getting-started/partial-prerendering#dynamic-rendering) to add nonces**.\n \n For example:\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n import { NextRequest, NextResponse } from 'next/server'\n \n-export function middleware(request: NextRequest) {\n+export function proxy(request: NextRequest) {\n   const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n   const cspHeader = `\n     default-src 'self';\n@@ -83,10 +83,10 @@ export function middleware(request: NextRequest) {\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { NextResponse } from 'next/server'\n \n-export function middleware(request) {\n+export function proxy(request) {\n   const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n   const cspHeader = `\n     default-src 'self';\n@@ -126,11 +126,11 @@ export function middleware(request) {\n }\n ```\n \n-By default, Middleware runs on all requests. You can filter Middleware to run on specific paths using a [`matcher`](/docs/app/api-reference/file-conventions/middleware#matcher).\n+By default, Proxy runs on all requests. You can filter Proxy to run on specific paths using a [`matcher`](/docs/app/api-reference/file-conventions/proxy#matcher).\n \n We recommend ignoring matching prefetches (from `next/link`) and static assets that don't need the CSP header.\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n export const config = {\n   matcher: [\n     /*\n@@ -151,7 +151,7 @@ export const config = {\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n export const config = {\n   matcher: [\n     /*\n@@ -178,7 +178,7 @@ To use a nonce, your page must be **dynamically rendered**. This is because Next\n \n Here’s how nonce support works in a dynamically rendered page:\n \n-1. **Middleware generates a nonce**: Your middleware creates a unique nonce for the request, adds it to your `Content-Security-Policy` header, and also sets it in a custom `x-nonce` header.\n+1. **Proxy generates a nonce**: Your proxy creates a unique nonce for the request, adds it to your `Content-Security-Policy` header, and also sets it in a custom `x-nonce` header.\n 2. **Next.js extracts the nonce**: During rendering, Next.js parses the `Content-Security-Policy` header and extracts the nonce using the `'nonce-{value}'` pattern.\n 3. **Nonce is applied automatically**: Next.js attaches the nonce to:\n    - Framework scripts (React, Next.js runtime)\n@@ -478,7 +478,7 @@ module.exports = nextConfig\n \n When SRI is enabled, you can continue using your existing CSP policies. SRI works independently by adding `integrity` attributes to your assets:\n \n-> **Good to know**: For dynamic rendering scenarios, you can still generate nonces with middleware if needed, combining both SRI integrity attributes and nonce-based CSP approaches.\n+> **Good to know**: For dynamic rendering scenarios, you can still generate nonces with proxy if needed, combining both SRI integrity attributes and nonce-based CSP approaches.\n \n ```js filename=\"next.config.js\"\n const cspHeader = `\n@@ -540,8 +540,8 @@ CSP implementation differs between development and production environments:\n \n In development, you will need to enable `'unsafe-eval'` to support APIs that provide additional debugging information:\n \n-```ts filename=\"middleware.ts\" switcher\n-export function middleware(request: NextRequest) {\n+```ts filename=\"proxy.ts\" switcher\n+export function proxy(request: NextRequest) {\n   const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n   const isDev = process.env.NODE_ENV === 'development'\n \n@@ -558,12 +558,12 @@ export function middleware(request: NextRequest) {\n     upgrade-insecure-requests;\n `\n \n-  // Rest of middleware implementation\n+  // Rest of proxy implementation\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n-export function middleware(request) {\n+```js filename=\"proxy.js\" switcher\n+export function proxy(request) {\n   const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n   const isDev = process.env.NODE_ENV === 'development'\n \n@@ -580,15 +580,15 @@ export function middleware(request) {\n     upgrade-insecure-requests;\n `\n \n-  // Rest of middleware implementation\n+  // Rest of proxy implementation\n }\n ```\n \n ### Production Deployment\n \n Common issues in production:\n \n-- **Nonce not applied**: Ensure your middleware runs on all necessary routes\n+- **Nonce not applied**: Ensure your proxy runs on all necessary routes\n - **Static assets blocked**: Verify your CSP allows Next.js static assets\n - **Third-party scripts**: Add necessary domains to your CSP policy\n \n@@ -689,7 +689,7 @@ export default function App({ Component, pageProps }) {\n \n Update your CSP to allow third-party domains:\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n const cspHeader = `\n   default-src 'self';\n   script-src 'self' 'nonce-${nonce}' 'strict-dynamic' https://www.googletagmanager.com;\n@@ -698,7 +698,7 @@ const cspHeader = `\n `\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n const cspHeader = `\n   default-src 'self';\n   script-src 'self' 'nonce-${nonce}' 'strict-dynamic' https://www.googletagmanager.com;"
        },
        {
            "sha": "db656cf0e315265dded49cece3a801329a6db723",
            "filename": "docs/01-app/02-guides/data-security.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fdata-security.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fdata-security.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fdata-security.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -471,4 +471,4 @@ If you're doing an audit of a Next.js project, here are a few things we recommen\n - **`\"use client\"` files:** Are the Component props expecting private data? Are the type signatures overly broad?\n - **`\"use server\"` files:** Are the Action arguments validated in the action or inside the Data Access Layer? Is the user re-authorized inside the action?\n - **`/[param]/.`** Folders with brackets are user input. Are params validated?\n-- **`middleware.ts` and `route.ts`:** Have a lot of power. Spend extra time auditing these using traditional techniques. Perform Penetration Testing or Vulnerability Scanning regularly or in alignment with your team's software development lifecycle.\n+- **`proxy.ts` and `route.ts`:** Have a lot of power. Spend extra time auditing these using traditional techniques. Perform Penetration Testing or Vulnerability Scanning regularly or in alignment with your team's software development lifecycle."
        },
        {
            "sha": "28328e5ee3c0c6acef9af64f323d2b07ed844ed3",
            "filename": "docs/01-app/02-guides/incremental-static-regeneration.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fincremental-static-regeneration.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fincremental-static-regeneration.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fincremental-static-regeneration.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -574,15 +574,15 @@ This will make the Next.js server console log ISR cache hits and misses. You can\n - ISR is not supported when creating a [Static Export](/docs/app/guides/static-exports).\n - If you have multiple `fetch` requests in a statically rendered route, and each has a different `revalidate` frequency, the lowest time will be used for ISR. However, those revalidate frequencies will still be respected by the [Data Cache](/docs/app/guides/caching#data-cache).\n - If any of the `fetch` requests used on a route have a `revalidate` time of `0`, or an explicit `no-store`, the route will be [dynamically rendered](/docs/app/getting-started/partial-prerendering#dynamic-rendering).\n-- Middleware won't be executed for on-demand ISR requests, meaning any path rewrites or logic in Middleware will not be applied. Ensure you are revalidating the exact path. For example, `/post/1` instead of a rewritten `/post-1`.\n+- Proxy won't be executed for on-demand ISR requests, meaning any path rewrites or logic in Proxy will not be applied. Ensure you are revalidating the exact path. For example, `/post/1` instead of a rewritten `/post-1`.\n \n </AppOnly>\n \n <PagesOnly>\n \n - ISR is only supported when using the Node.js runtime (default).\n - ISR is not supported when creating a [Static Export](/docs/app/guides/static-exports).\n-- Middleware won't be executed for on-demand ISR requests, meaning any path rewrites or logic in Middleware will not be applied. Ensure you are revalidating the exact path. For example, `/post/1` instead of a rewritten `/post-1`.\n+- Proxy won't be executed for on-demand ISR requests, meaning any path rewrites or logic in Proxy will not be applied. Ensure you are revalidating the exact path. For example, `/post/1` instead of a rewritten `/post-1`.\n \n </PagesOnly>\n "
        },
        {
            "sha": "ce0c678889a652884b3dedf516586047d7bd943c",
            "filename": "docs/01-app/02-guides/internationalization.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Finternationalization.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Finternationalization.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Finternationalization.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -18,7 +18,7 @@ It’s recommended to use the user’s language preferences in the browser to se\n \n For example, using the following libraries, you can look at an incoming `Request` to determine which locale to select, based on the `Headers`, locales you plan to support, and the default locale.\n \n-```js filename=\"middleware.js\"\n+```js filename=\"proxy.js\"\n import { match } from '@formatjs/intl-localematcher'\n import Negotiator from 'negotiator'\n \n@@ -30,17 +30,17 @@ let defaultLocale = 'en-US'\n match(languages, locales, defaultLocale) // -> 'en-US'\n ```\n \n-Routing can be internationalized by either the sub-path (`/fr/products`) or domain (`my-site.fr/products`). With this information, you can now redirect the user based on the locale inside [Middleware](/docs/app/api-reference/file-conventions/middleware).\n+Routing can be internationalized by either the sub-path (`/fr/products`) or domain (`my-site.fr/products`). With this information, you can now redirect the user based on the locale inside [Proxy](/docs/app/api-reference/file-conventions/proxy).\n \n-```js filename=\"middleware.js\"\n+```js filename=\"proxy.js\"\n import { NextResponse } from \"next/server\";\n \n let locales = ['en-US', 'nl-NL', 'nl']\n \n // Get the preferred locale, similar to the above or using a library\n function getLocale(request) { ... }\n \n-export function middleware(request) {\n+export function proxy(request) {\n   // Check if there is any supported locale in the pathname\n   const { pathname } = request.nextUrl\n   const pathnameHasLocale = locales.some("
        },
        {
            "sha": "3a9e2873ef8cd01f1fa886b30e7cf0fba9767f6e",
            "filename": "docs/01-app/02-guides/migrating/from-create-react-app.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-create-react-app.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-create-react-app.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-create-react-app.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -37,9 +37,9 @@ This enables you to build pages that are faster to load and eliminate [layout sh\n \n Depending on your needs, Next.js allows you to choose your data fetching strategy on a page or component-level basis. For example, you could fetch data from your CMS and render blog posts at build time (SSG) for quick load speeds, or fetch data at request time (SSR) when necessary.\n \n-### Middleware\n+### Proxy\n \n-[Next.js Middleware](/docs/app/api-reference/file-conventions/middleware) allows you to run code on the server before a request is completed. For instance, you can avoid a flash of unauthenticated content by redirecting a user to a login page in the middleware for authenticated-only pages. You can also use it for features like A/B testing, experimentation, and [internationalization](/docs/app/guides/internationalization).\n+[Next.js Proxy](/docs/app/api-reference/file-conventions/proxy) allows you to run code on the server before a request is completed. For instance, you can avoid a flash of unauthenticated content by redirecting a user to a login page in the proxy for authenticated-only pages. You can also use it for features like A/B testing, experimentation, and [internationalization](/docs/app/guides/internationalization).\n \n ### Built-in Optimizations\n "
        },
        {
            "sha": "4873a2ead2a28e3909bf4fe0c738e0696adb4c5d",
            "filename": "docs/01-app/02-guides/migrating/from-vite.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-vite.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-vite.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-vite.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -37,9 +37,9 @@ This enables you to build pages that are faster to load and eliminate [layout sh\n \n Depending on your needs, Next.js allows you to choose your data fetching strategy on a page and component basis. You can decide to fetch at build time, at request time on the server, or on the client. For example, you can fetch data from your CMS and render your blog posts at build time, which can then be efficiently cached on a CDN.\n \n-### Middleware\n+### Proxy\n \n-[Next.js Middleware](/docs/app/api-reference/file-conventions/middleware) allows you to run code on the server before a request is completed. This is especially useful to avoid having a flash of unauthenticated content when the user visits an authenticated-only page by redirecting the user to a login page. The middleware is also useful for experimentation and [internationalization](/docs/app/guides/internationalization).\n+[Next.js Proxy](/docs/app/api-reference/file-conventions/proxy) allows you to run code on the server before a request is completed. This is especially useful to avoid having a flash of unauthenticated content when the user visits an authenticated-only page by redirecting the user to a login page. The proxy is also useful for experimentation and [internationalization](/docs/app/guides/internationalization).\n \n ### Built-in Optimizations\n "
        },
        {
            "sha": "b663b4b26a6a3ffb7704a3d39ff177d99d4a5bfb",
            "filename": "docs/01-app/02-guides/multi-zones.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fmulti-zones.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fmulti-zones.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fmulti-zones.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -98,12 +98,12 @@ async rewrites() {\n \n > **Good to know**: URL paths should be unique to a zone. For example, two zones trying to serve `/blog` would create a routing conflict.\n \n-### Routing requests using middleware\n+### Routing requests using proxy\n \n-Routing requests through [`rewrites`](/docs/app/api-reference/config/next-config-js/rewrites) is recommended to minimize latency overhead for the requests, but middleware can also be used when there is a need for a dynamic decision when routing. For example, if you are using a feature flag to decide where a path should be routed such as during a migration, you can use middleware.\n+Routing requests through [`rewrites`](/docs/app/api-reference/config/next-config-js/rewrites) is recommended to minimize latency overhead for the requests, but proxy can also be used when there is a need for a dynamic decision when routing. For example, if you are using a feature flag to decide where a path should be routed such as during a migration, you can use proxy.\n \n-```js filename=\"middleware.js\"\n-export async function middleware(request) {\n+```js filename=\"proxy.js\"\n+export async function proxy(request) {\n   const { pathname, search } = req.nextUrl;\n   if (pathname === '/your-path' && myFeatureFlag.isEnabled()) {\n     return NextResponse.rewrite(`${rewriteDomain}${pathname}${search});"
        },
        {
            "sha": "a2e2b326e5b9bf6af19ecda4c108c1e9bc218a02",
            "filename": "docs/01-app/02-guides/redirecting.mdx",
            "status": "modified",
            "additions": 38,
            "deletions": 38,
            "changes": 76,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fredirecting.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fredirecting.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fredirecting.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -6,31 +6,31 @@ related:\n   links:\n     - app/api-reference/functions/redirect\n     - app/api-reference/functions/permanentRedirect\n-    - app/api-reference/file-conventions/middleware\n+    - app/api-reference/file-conventions/proxy\n     - app/api-reference/config/next-config-js/redirects\n ---\n \n There are a few ways you can handle redirects in Next.js. This page will go through each available option, use cases, and how to manage large numbers of redirects.\n \n <AppOnly>\n \n-| API                                                            | Purpose                                           | Where                                             | Status Code                            |\n-| -------------------------------------------------------------- | ------------------------------------------------- | ------------------------------------------------- | -------------------------------------- |\n-| [`redirect`](#redirect-function)                               | Redirect user after a mutation or event           | Server Components, Server Actions, Route Handlers | 307 (Temporary) or 303 (Server Action) |\n-| [`permanentRedirect`](#permanentredirect-function)             | Redirect user after a mutation or event           | Server Components, Server Actions, Route Handlers | 308 (Permanent)                        |\n-| [`useRouter`](#userouter-hook)                                 | Perform a client-side navigation                  | Event Handlers in Client Components               | N/A                                    |\n-| [`redirects` in `next.config.js`](#redirects-in-nextconfigjs)  | Redirect an incoming request based on a path      | `next.config.js` file                             | 307 (Temporary) or 308 (Permanent)     |\n-| [`NextResponse.redirect`](#nextresponseredirect-in-middleware) | Redirect an incoming request based on a condition | Middleware                                        | Any                                    |\n+| API                                                           | Purpose                                           | Where                                             | Status Code                            |\n+| ------------------------------------------------------------- | ------------------------------------------------- | ------------------------------------------------- | -------------------------------------- |\n+| [`redirect`](#redirect-function)                              | Redirect user after a mutation or event           | Server Components, Server Actions, Route Handlers | 307 (Temporary) or 303 (Server Action) |\n+| [`permanentRedirect`](#permanentredirect-function)            | Redirect user after a mutation or event           | Server Components, Server Actions, Route Handlers | 308 (Permanent)                        |\n+| [`useRouter`](#userouter-hook)                                | Perform a client-side navigation                  | Event Handlers in Client Components               | N/A                                    |\n+| [`redirects` in `next.config.js`](#redirects-in-nextconfigjs) | Redirect an incoming request based on a path      | `next.config.js` file                             | 307 (Temporary) or 308 (Permanent)     |\n+| [`NextResponse.redirect`](#nextresponseredirect-in-proxy)     | Redirect an incoming request based on a condition | Proxy                                             | Any                                    |\n \n </AppOnly>\n \n <PagesOnly>\n \n-| API                                                            | Purpose                                           | Where                 | Status Code                        |\n-| -------------------------------------------------------------- | ------------------------------------------------- | --------------------- | ---------------------------------- |\n-| [`useRouter`](#userouter-hook)                                 | Perform a client-side navigation                  | Components            | N/A                                |\n-| [`redirects` in `next.config.js`](#redirects-in-nextconfigjs)  | Redirect an incoming request based on a path      | `next.config.js` file | 307 (Temporary) or 308 (Permanent) |\n-| [`NextResponse.redirect`](#nextresponseredirect-in-middleware) | Redirect an incoming request based on a condition | Middleware            | Any                                |\n+| API                                                           | Purpose                                           | Where                 | Status Code                        |\n+| ------------------------------------------------------------- | ------------------------------------------------- | --------------------- | ---------------------------------- |\n+| [`useRouter`](#userouter-hook)                                | Perform a client-side navigation                  | Components            | N/A                                |\n+| [`redirects` in `next.config.js`](#redirects-in-nextconfigjs) | Redirect an incoming request based on a path      | `next.config.js` file | 307 (Temporary) or 308 (Permanent) |\n+| [`NextResponse.redirect`](#nextresponseredirect-in-proxy)     | Redirect an incoming request based on a condition | Proxy                 | Any                                |\n \n </PagesOnly>\n \n@@ -84,7 +84,7 @@ export async function createPost(id) {\n > - `redirect` throws an error so it should be called **outside** the `try` block when using `try/catch` statements.\n > - `redirect` can be called in Client Components during the rendering process but not in event handlers. You can use the [`useRouter` hook](#userouter-hook) instead.\n > - `redirect` also accepts absolute URLs and can be used to redirect to external links.\n-> - If you'd like to redirect before the render process, use [`next.config.js`](#redirects-in-nextconfigjs) or [Middleware](#nextresponseredirect-in-middleware).\n+> - If you'd like to redirect before the render process, use [`next.config.js`](#redirects-in-nextconfigjs) or [Proxy](#nextresponseredirect-in-proxy).\n \n See the [`redirect` API reference](/docs/app/api-reference/functions/redirect) for more information.\n \n@@ -134,7 +134,7 @@ export async function updateUsername(username, formData) {\n >\n > - `permanentRedirect` returns a 308 (permanent redirect) status code by default.\n > - `permanentRedirect` also accepts absolute URLs and can be used to redirect to external links.\n-> - If you'd like to redirect before the render process, use [`next.config.js`](#redirects-in-nextconfigjs) or [Middleware](#nextresponseredirect-in-middleware).\n+> - If you'd like to redirect before the render process, use [`next.config.js`](#redirects-in-nextconfigjs) or [Proxy](#nextresponseredirect-in-proxy).\n \n See the [`permanentRedirect` API reference](/docs/app/api-reference/functions/permanentRedirect) for more information.\n \n@@ -289,20 +289,20 @@ See the [`redirects` API reference](/docs/app/api-reference/config/next-config-j\n > **Good to know**:\n >\n > - `redirects` can return a 307 (Temporary Redirect) or 308 (Permanent Redirect) status code with the `permanent` option.\n-> - `redirects` may have a limit on platforms. For example, on Vercel, there's a limit of 1,024 redirects. To manage a large number of redirects (1000+), consider creating a custom solution using [Middleware](/docs/app/api-reference/file-conventions/middleware). See [managing redirects at scale](#managing-redirects-at-scale-advanced) for more.\n-> - `redirects` runs **before** Middleware.\n+> - `redirects` may have a limit on platforms. For example, on Vercel, there's a limit of 1,024 redirects. To manage a large number of redirects (1000+), consider creating a custom solution using [Proxy](/docs/app/api-reference/file-conventions/proxy). See [managing redirects at scale](#managing-redirects-at-scale-advanced) for more.\n+> - `redirects` runs **before** Proxy.\n \n-## `NextResponse.redirect` in Middleware\n+## `NextResponse.redirect` in Proxy\n \n-Middleware allows you to run code before a request is completed. Then, based on the incoming request, redirect to a different URL using `NextResponse.redirect`. This is useful if you want to redirect users based on a condition (e.g. authentication, session management, etc) or have [a large number of redirects](#managing-redirects-at-scale-advanced).\n+Proxy allows you to run code before a request is completed. Then, based on the incoming request, redirect to a different URL using `NextResponse.redirect`. This is useful if you want to redirect users based on a condition (e.g. authentication, session management, etc) or have [a large number of redirects](#managing-redirects-at-scale-advanced).\n \n For example, to redirect the user to a `/login` page if they are not authenticated:\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n import { NextResponse, NextRequest } from 'next/server'\n import { authenticate } from 'auth-provider'\n \n-export function middleware(request: NextRequest) {\n+export function proxy(request: NextRequest) {\n   const isAuthenticated = authenticate(request)\n \n   // If the user is authenticated, continue as normal\n@@ -319,11 +319,11 @@ export const config = {\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { NextResponse } from 'next/server'\n import { authenticate } from 'auth-provider'\n \n-export function middleware(request) {\n+export function proxy(request) {\n   const isAuthenticated = authenticate(request)\n \n   // If the user is authenticated, continue as normal\n@@ -342,20 +342,20 @@ export const config = {\n \n > **Good to know**:\n >\n-> - Middleware runs **after** `redirects` in `next.config.js` and **before** rendering.\n+> - Proxy runs **after** `redirects` in `next.config.js` and **before** rendering.\n \n-See the [Middleware](/docs/app/api-reference/file-conventions/middleware) documentation for more information.\n+See the [Proxy](/docs/app/api-reference/file-conventions/proxy) documentation for more information.\n \n ## Managing redirects at scale (advanced)\n \n-To manage a large number of redirects (1000+), you may consider creating a custom solution using Middleware. This allows you to handle redirects programmatically without having to redeploy your application.\n+To manage a large number of redirects (1000+), you may consider creating a custom solution using Proxy. This allows you to handle redirects programmatically without having to redeploy your application.\n \n To do this, you'll need to consider:\n \n 1. Creating and storing a redirect map.\n 2. Optimizing data lookup performance.\n \n-> **Next.js Example**: See our [Middleware with Bloom filter](https://redirects-bloom-filter.vercel.app/) example for an implementation of the recommendations below.\n+> **Next.js Example**: See our [Proxy with Bloom filter](https://redirects-bloom-filter.vercel.app/) example for an implementation of the recommendations below.\n \n ### 1. Creating and storing a redirect map\n \n@@ -376,9 +376,9 @@ Consider the following data structure:\n }\n ```\n \n-In [Middleware](/docs/app/api-reference/file-conventions/middleware), you can read from a database such as Vercel's [Edge Config](https://vercel.com/docs/edge-config/get-started) or [Redis](https://vercel.com/docs/redis), and redirect the user based on the incoming request:\n+In [Proxy](/docs/app/api-reference/file-conventions/proxy), you can read from a database such as Vercel's [Edge Config](https://vercel.com/docs/edge-config/get-started) or [Redis](https://vercel.com/docs/redis), and redirect the user based on the incoming request:\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n import { NextResponse, NextRequest } from 'next/server'\n import { get } from '@vercel/edge-config'\n \n@@ -387,7 +387,7 @@ type RedirectEntry = {\n   permanent: boolean\n }\n \n-export async function middleware(request: NextRequest) {\n+export async function proxy(request: NextRequest) {\n   const pathname = request.nextUrl.pathname\n   const redirectData = await get(pathname)\n \n@@ -402,11 +402,11 @@ export async function middleware(request: NextRequest) {\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { NextResponse } from 'next/server'\n import { get } from '@vercel/edge-config'\n \n-export async function middleware(request) {\n+export async function proxy(request) {\n   const pathname = request.nextUrl.pathname\n   const redirectData = await get(pathname)\n \n@@ -428,11 +428,11 @@ Reading a large dataset for every incoming request can be slow and expensive. Th\n - Use a database that is optimized for fast reads\n - Use a data lookup strategy such as a [Bloom filter](https://en.wikipedia.org/wiki/Bloom_filter) to efficiently check if a redirect exists **before** reading the larger redirects file or database.\n \n-Considering the previous example, you can import a generated bloom filter file into Middleware, then, check if the incoming request pathname exists in the bloom filter.\n+Considering the previous example, you can import a generated bloom filter file into Proxy, then, check if the incoming request pathname exists in the bloom filter.\n \n-If it does, forward the request to a <AppOnly>[Route Handler](/docs/app/api-reference/file-conventions/route)</AppOnly> <PagesOnly>[API Routes](/docs/pages/building-your-application/routing/api-routes)</PagesOnly> which will check the actual file and redirect the user to the appropriate URL. This avoids importing a large redirects file into Middleware, which can slow down every incoming request.\n+If it does, forward the request to a <AppOnly>[Route Handler](/docs/app/api-reference/file-conventions/route)</AppOnly> <PagesOnly>[API Routes](/docs/pages/building-your-application/routing/api-routes)</PagesOnly> which will check the actual file and redirect the user to the appropriate URL. This avoids importing a large redirects file into Proxy, which can slow down every incoming request.\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n import { NextResponse, NextRequest } from 'next/server'\n import { ScalableBloomFilter } from 'bloom-filters'\n import GeneratedBloomFilter from './redirects/bloom-filter.json'\n@@ -445,7 +445,7 @@ type RedirectEntry = {\n // Initialize bloom filter from a generated JSON file\n const bloomFilter = ScalableBloomFilter.fromJSON(GeneratedBloomFilter as any)\n \n-export async function middleware(request: NextRequest) {\n+export async function proxy(request: NextRequest) {\n   // Get the path for the incoming request\n   const pathname = request.nextUrl.pathname\n \n@@ -483,15 +483,15 @@ export async function middleware(request: NextRequest) {\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { NextResponse } from 'next/server'\n import { ScalableBloomFilter } from 'bloom-filters'\n import GeneratedBloomFilter from './redirects/bloom-filter.json'\n \n // Initialize bloom filter from a generated JSON file\n const bloomFilter = ScalableBloomFilter.fromJSON(GeneratedBloomFilter)\n \n-export async function middleware(request) {\n+export async function proxy(request) {\n   // Get the path for the incoming request\n   const pathname = request.nextUrl.pathname\n "
        },
        {
            "sha": "c17666d68675e86dd28bb2e2dec8e79f2a959116",
            "filename": "docs/01-app/02-guides/self-hosting.mdx",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fself-hosting.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fself-hosting.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fself-hosting.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -22,11 +22,11 @@ Image Optimization can be used with a [static export](/docs/app/guides/static-ex\n > - Learn more about the [caching behavior of optimized images](/docs/app/api-reference/components/image#minimumcachettl) and how to configure the TTL.\n > - You can also [disable Image Optimization](/docs/app/api-reference/components/image#unoptimized) and still retain other benefits of using `next/image` if you prefer. For example, if you are optimizing images yourself separately.\n \n-## Middleware\n+## Proxy\n \n-[Middleware](/docs/app/api-reference/file-conventions/middleware) works self-hosted with zero configuration when deploying using `next start`. Since it requires access to the incoming request, it is not supported when using a [static export](/docs/app/guides/static-exports).\n+[Proxy](/docs/app/api-reference/file-conventions/proxy) works self-hosted with zero configuration when deploying using `next start`. Since it requires access to the incoming request, it is not supported when using a [static export](/docs/app/guides/static-exports).\n \n-Middleware uses the [Edge runtime](/docs/app/api-reference/edge), a subset of all available Node.js APIs to help ensure low latency, since it may run in front of every route or asset in your application. If you do not want this, you can use the [full Node.js runtime](/blog/next-15-2#nodejs-middleware-experimental) to run Middleware.\n+Proxy uses the [Edge runtime](/docs/app/api-reference/edge), a subset of all available Node.js APIs to help ensure low latency, since it may run in front of every route or asset in your application. If you do not want this, you can use the [full Node.js runtime](/blog/next-15-2#nodejs-middleware-experimental) to run Proxy.\n \n If you are looking to add logic (or use an external package) that requires all Node.js APIs, you might be able to move this logic to a [layout](/docs/app/api-reference/file-conventions/layout) as a [Server Component](/docs/app/getting-started/server-and-client-components). For example, checking [headers](/docs/app/api-reference/functions/headers) and [redirecting](/docs/app/api-reference/functions/redirect). You can also use headers, cookies, or query parameters to [redirect](/docs/app/api-reference/config/next-config-js/redirects#header-cookie-and-query-matching) or [rewrite](/docs/app/api-reference/config/next-config-js/rewrites#header-cookie-and-query-matching) through `next.config.js`. If that does not work, you can also use a [custom server](/docs/pages/guides/custom-server).\n "
        },
        {
            "sha": "7073ec1a28fda643c638aaa6e7b48f7fbc202d7c",
            "filename": "docs/01-app/02-guides/static-exports.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fstatic-exports.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F02-guides%2Fstatic-exports.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fstatic-exports.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -284,7 +284,7 @@ Features that require a Node.js server, or dynamic logic that cannot be computed\n - [Rewrites](/docs/app/api-reference/config/next-config-js/rewrites)\n - [Redirects](/docs/app/api-reference/config/next-config-js/redirects)\n - [Headers](/docs/app/api-reference/config/next-config-js/headers)\n-- [Middleware](/docs/app/api-reference/file-conventions/middleware)\n+- [Proxy](/docs/app/api-reference/file-conventions/proxy)\n - [Incremental Static Regeneration](/docs/app/guides/incremental-static-regeneration)\n - [Image Optimization](/docs/app/api-reference/components/image) with the default `loader`\n - [Draft Mode](/docs/app/guides/draft-mode)\n@@ -306,7 +306,7 @@ export const dynamic = 'error'\n - [Rewrites](/docs/pages/api-reference/config/next-config-js/rewrites)\n - [Redirects](/docs/pages/api-reference/config/next-config-js/redirects)\n - [Headers](/docs/pages/api-reference/config/next-config-js/headers)\n-- [Middleware](/docs/pages/api-reference/file-conventions/middleware)\n+- [Proxy](/docs/pages/api-reference/file-conventions/proxy)\n - [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration)\n - [Image Optimization](/docs/pages/api-reference/components/image) with the default `loader`\n - [Draft Mode](/docs/pages/guides/draft-mode)"
        },
        {
            "sha": "3a0cca73aeb1a4614d58dc9eb3f2ecb25ab1e3f5",
            "filename": "docs/01-app/03-api-reference/02-components/link.mdx",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F02-components%2Flink.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F02-components%2Flink.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F02-components%2Flink.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -884,16 +884,16 @@ export default function Home() {\n \n </PagesOnly>\n \n-### Prefetching links in Middleware\n+### Prefetching links in Proxy\n \n-It's common to use [Middleware](/docs/app/api-reference/file-conventions/middleware) for authentication or other purposes that involve rewriting the user to a different page. In order for the `<Link />` component to properly prefetch links with rewrites via Middleware, you need to tell Next.js both the URL to display and the URL to prefetch. This is required to avoid un-necessary fetches to middleware to know the correct route to prefetch.\n+It's common to use [Proxy](/docs/app/api-reference/file-conventions/proxy) for authentication or other purposes that involve rewriting the user to a different page. In order for the `<Link />` component to properly prefetch links with rewrites via Proxy, you need to tell Next.js both the URL to display and the URL to prefetch. This is required to avoid un-necessary fetches to proxy to know the correct route to prefetch.\n \n-For example, if you want to serve a `/dashboard` route that has authenticated and visitor views, you can add the following in your Middleware to redirect the user to the correct page:\n+For example, if you want to serve a `/dashboard` route that has authenticated and visitor views, you can add the following in your Proxy to redirect the user to the correct page:\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n import { NextResponse } from 'next/server'\n \n-export function middleware(request: Request) {\n+export function proxy(request: Request) {\n   const nextUrl = request.nextUrl\n   if (nextUrl.pathname === '/dashboard') {\n     if (request.cookies.authToken) {\n@@ -905,10 +905,10 @@ export function middleware(request: Request) {\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { NextResponse } from 'next/server'\n \n-export function middleware(request) {\n+export function proxy(request) {\n   const nextUrl = request.nextUrl\n   if (nextUrl.pathname === '/dashboard') {\n     if (request.cookies.authToken) {\n@@ -996,7 +996,7 @@ export default function Home() {\n }\n ```\n \n-> **Good to know**: If you're using [Dynamic Routes](/docs/pages/building-your-application/routing/dynamic-routes#convention), you'll need to adapt your `as` and `href` props. For example, if you have a Dynamic Route like `/dashboard/authed/[user]` that you want to present differently via middleware, you would write: `<Link href={{ pathname: '/dashboard/authed/[user]', query: { user: username } }} as=\"/dashboard/[user]\">Profile</Link>`.\n+> **Good to know**: If you're using [Dynamic Routes](/docs/pages/building-your-application/routing/dynamic-routes#convention), you'll need to adapt your `as` and `href` props. For example, if you have a Dynamic Route like `/dashboard/authed/[user]` that you want to present differently via proxy, you would write: `<Link href={{ pathname: '/dashboard/authed/[user]', query: { user: username } }} as=\"/dashboard/[user]\">Profile</Link>`.\n \n </PagesOnly>\n "
        },
        {
            "sha": "e955c448ddadedc2ac9a7dd1f0ce41024489c0ea",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/01-metadata/index.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Findex.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Findex.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Findex.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -13,4 +13,4 @@ Once a file is defined, Next.js will automatically serve the file (with hashes i\n > **Good to know**:\n >\n > - Special Route Handlers like [`sitemap.ts`](/docs/app/api-reference/file-conventions/metadata/sitemap), [`opengraph-image.tsx`](/docs/app/api-reference/file-conventions/metadata/opengraph-image), and [`icon.tsx`](/docs/app/api-reference/file-conventions/metadata/app-icons), and other [metadata files](/docs/app/api-reference/file-conventions/metadata) are cached by default.\n-> - If using along with [`middleware.ts`](/docs/app/api-reference/file-conventions/middleware), [configure the matcher](/docs/app/api-reference/file-conventions/middleware#matcher) to exclude the metadata files.\n+> - If using along with [`proxy.ts`](/docs/app/api-reference/file-conventions/proxy), [configure the matcher](/docs/app/api-reference/file-conventions/proxy#matcher) to exclude the metadata files."
        },
        {
            "sha": "139709db7b9e06302e40caa737faa30845448061",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/loading.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Floading.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Floading.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Floading.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -101,7 +101,7 @@ Some crawlers may label these responses as “soft 404s”. In the streaming cas\n \n If you need a 404 status, for compliance or analytics, ensure the resource exists before the response body is streamed, so that the server can set the HTTP status code.\n \n-You can run this check in [`middleware`](/docs/app/api-reference/file-conventions/middleware) to rewrite missing slugs to a not-found route, or [produce a 404 response](/docs/app/api-reference/file-conventions/middleware#producing-a-response). Keep middleware checks fast, and avoid fetching full content there.\n+You can run this check in [`proxy`](/docs/app/api-reference/file-conventions/proxy) to rewrite missing slugs to a not-found route, or [produce a 404 response](/docs/app/api-reference/file-conventions/proxy#producing-a-response). Keep proxy checks fast, and avoid fetching full content there.\n \n <details>\n <summary>When is the response body streamed?</summary>"
        },
        {
            "sha": "c6f114ac2a446c3729fac35234a44ca3c00f3e79",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/middleware.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 697,
            "changes": 697,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Fmiddleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Fmiddleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Fmiddleware.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,697 +0,0 @@\n----\n-title: middleware.js\n-description: API reference for the middleware.js file.\n-related:\n-  title: Learn more about Middleware\n-  links:\n-    - app/api-reference/functions/next-request\n-    - app/api-reference/functions/next-response\n----\n-\n-The `middleware.js|ts` file is used to write [Middleware](/docs/app/getting-started/#middleware) and run code on the server before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.\n-\n-Middleware executes before routes are rendered. It's particularly useful for implementing custom server-side logic like authentication, logging, or handling redirects.\n-\n-> **Good to know**:\n->\n-> Middleware is meant to be invoked separately of your render code and in optimized cases deployed to your CDN for fast redirect/rewrite handling, you should not attempt relying on shared modules or globals.\n->\n-> To pass information from Middleware to your application, use [headers](#setting-headers), [cookies](#using-cookies), [rewrites](/docs/app/api-reference/functions/next-response#rewrite), [redirects](/docs/app/api-reference/functions/next-response#redirect), or the URL.\n-\n-Create a `middleware.ts` (or `.js`) file in the project root, or inside `src` if applicable, so that it is located at the same level as `pages` or `app`.\n-\n-If you’ve customized [`pageExtensions`](/docs/app/api-reference/config/next-config-js/pageExtensions), for example to `.page.ts` or `.page.js`, name your file `middleware.page.ts` or `middleware.page.js` accordingly.\n-\n-```tsx filename=\"middleware.ts\" switcher\n-import { NextResponse, NextRequest } from 'next/server'\n-\n-// This function can be marked `async` if using `await` inside\n-export function middleware(request: NextRequest) {\n-  return NextResponse.redirect(new URL('/home', request.url))\n-}\n-\n-export const config = {\n-  matcher: '/about/:path*',\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-import { NextResponse } from 'next/server'\n-\n-// This function can be marked `async` if using `await` inside\n-export function middleware(request) {\n-  return NextResponse.redirect(new URL('/home', request.url))\n-}\n-\n-export const config = {\n-  matcher: '/about/:path*',\n-}\n-```\n-\n-## Exports\n-\n-### Middleware function\n-\n-The file must export a single function, either as a default export or named `middleware`. Note that multiple middleware from the same file are not supported.\n-\n-```js filename=\"middleware.js\"\n-// Example of default export\n-export default function middleware(request) {\n-  // Middleware logic\n-}\n-```\n-\n-### Config object (optional)\n-\n-Optionally, a config object can be exported alongside the Middleware function. This object includes the [matcher](#matcher) to specify paths where the Middleware applies.\n-\n-### Matcher\n-\n-The `matcher` option allows you to target specific paths for the Middleware to run on. You can specify these paths in several ways:\n-\n-- For a single path: Directly use a string to define the path, like `'/about'`.\n-- For multiple paths: Use an array to list multiple paths, such as `matcher: ['/about', '/contact']`, which applies the Middleware to both `/about` and `/contact`.\n-\n-```js filename=\"middleware.js\"\n-export const config = {\n-  matcher: ['/about/:path*', '/dashboard/:path*'],\n-}\n-```\n-\n-Additionally, the `matcher` option supports complex path specifications through regular expressions, such as `matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)']`, enabling precise control over which paths to include or exclude.\n-\n-The `matcher` option accepts an array of objects with the following keys:\n-\n-- `source`: The path or pattern used to match the request paths. It can be a string for direct path matching or a pattern for more complex matching.\n-- `regexp` (optional): A regular expression string that fine-tunes the matching based on the source. It provides additional control over which paths are included or excluded.\n-- `locale` (optional): A boolean that, when set to `false`, ignores locale-based routing in path matching.\n-- `has` (optional): Specifies conditions based on the presence of specific request elements such as headers, query parameters, or cookies.\n-- `missing` (optional): Focuses on conditions where certain request elements are absent, like missing headers or cookies.\n-\n-```js filename=\"middleware.js\"\n-export const config = {\n-  matcher: [\n-    {\n-      source: '/api/*',\n-      regexp: '^/api/(.*)',\n-      locale: false,\n-      has: [\n-        { type: 'header', key: 'Authorization', value: 'Bearer Token' },\n-        { type: 'query', key: 'userId', value: '123' },\n-      ],\n-      missing: [{ type: 'cookie', key: 'session', value: 'active' }],\n-    },\n-  ],\n-}\n-```\n-\n-Configured matchers:\n-\n-1. MUST start with `/`\n-2. Can include named parameters: `/about/:path` matches `/about/a` and `/about/b` but not `/about/a/c`\n-3. Can have modifiers on named parameters (starting with `:`): `/about/:path*` matches `/about/a/b/c` because `*` is _zero or more_. `?` is _zero or one_ and `+` _one or more_\n-4. Can use regular expression enclosed in parenthesis: `/about/(.*)` is the same as `/about/:path*`\n-\n-Read more details on [path-to-regexp](https://github.com/pillarjs/path-to-regexp#path-to-regexp-1) documentation.\n-\n-> **Good to know**:\n->\n-> - The `matcher` values need to be constants so they can be statically analyzed at build-time. Dynamic values such as variables will be ignored.\n-> - For backward compatibility, Next.js always considers `/public` as `/public/index`. Therefore, a matcher of `/public/:path` will match.\n-\n-## Params\n-\n-### `request`\n-\n-When defining Middleware, the default export function accepts a single parameter, `request`. This parameter is an instance of `NextRequest`, which represents the incoming HTTP request.\n-\n-```tsx filename=\"middleware.ts\" switcher\n-import type { NextRequest } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  // Middleware logic goes here\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-export function middleware(request) {\n-  // Middleware logic goes here\n-}\n-```\n-\n-> **Good to know**:\n->\n-> - `NextRequest` is a type that represents incoming HTTP requests in Next.js Middleware, whereas [`NextResponse`](#nextresponse) is a class used to manipulate and send back HTTP responses.\n-\n-## NextResponse\n-\n-The `NextResponse` API allows you to:\n-\n-- `redirect` the incoming request to a different URL\n-- `rewrite` the response by displaying a given URL\n-- Set request headers for API Routes, `getServerSideProps`, and `rewrite` destinations\n-- Set response cookies\n-- Set response headers\n-\n-<AppOnly>\n-\n-To produce a response from Middleware, you can:\n-\n-1. `rewrite` to a route ([Page](/docs/app/api-reference/file-conventions/page) or [Route Handler](/docs/app/api-reference/file-conventions/route)) that produces a response\n-2. return a `NextResponse` directly. See [Producing a Response](#producing-a-response)\n-\n-> **Good to know**: For redirects, you can also use `Response.redirect` instead of `NextResponse.redirect`.\n-\n-</AppOnly>\n-\n-<PagesOnly>\n-\n-To produce a response from Middleware, you can:\n-\n-1. `rewrite` to a route ([Page](/docs/pages/building-your-application/routing/pages-and-layouts) or [Edge API Route](/docs/pages/building-your-application/routing/api-routes)) that produces a response\n-2. return a `NextResponse` directly. See [Producing a Response](#producing-a-response)\n-\n-</PagesOnly>\n-\n-## Execution order\n-\n-Middleware will be invoked for **every route in your project**. Given this, it's crucial to use [matchers](#matcher) to precisely target or exclude specific routes. The following is the execution order:\n-\n-1. `headers` from `next.config.js`\n-2. `redirects` from `next.config.js`\n-3. Middleware (`rewrites`, `redirects`, etc.)\n-4. `beforeFiles` (`rewrites`) from `next.config.js`\n-5. Filesystem routes (`public/`, `_next/static/`, `pages/`, `app/`, etc.)\n-6. `afterFiles` (`rewrites`) from `next.config.js`\n-7. Dynamic Routes (`/blog/[slug]`)\n-8. `fallback` (`rewrites`) from `next.config.js`\n-\n-## Runtime\n-\n-Middleware defaults to using the Edge runtime. As of v15.5, we have support for using the Node.js runtime. To enable, in your middleware file, set the runtime to `nodejs` in the `config` object:\n-\n-```js highlight={2} filename=\"middleware.js\" switcher\n-export const config = {\n-  runtime: 'nodejs',\n-}\n-```\n-\n-```ts highlight={2} filename=\"middleware.ts\" switcher\n-export const config = {\n-  runtime: 'nodejs',\n-}\n-```\n-\n-## Advanced Middleware flags\n-\n-In `v13.1` of Next.js two additional flags were introduced for middleware, `skipMiddlewareUrlNormalize` and `skipTrailingSlashRedirect` to handle advanced use cases.\n-\n-`skipTrailingSlashRedirect` disables Next.js redirects for adding or removing trailing slashes. This allows custom handling inside middleware to maintain the trailing slash for some paths but not others, which can make incremental migrations easier.\n-\n-```js filename=\"next.config.js\"\n-module.exports = {\n-  skipTrailingSlashRedirect: true,\n-}\n-```\n-\n-```js filename=\"middleware.js\"\n-const legacyPrefixes = ['/docs', '/blog']\n-\n-export default async function middleware(req) {\n-  const { pathname } = req.nextUrl\n-\n-  if (legacyPrefixes.some((prefix) => pathname.startsWith(prefix))) {\n-    return NextResponse.next()\n-  }\n-\n-  // apply trailing slash handling\n-  if (\n-    !pathname.endsWith('/') &&\n-    !pathname.match(/((?!\\.well-known(?:\\/.*)?)(?:[^/]+\\/)*[^/]+\\.\\w+)/)\n-  ) {\n-    return NextResponse.redirect(\n-      new URL(`${req.nextUrl.pathname}/`, req.nextUrl)\n-    )\n-  }\n-}\n-```\n-\n-`skipMiddlewareUrlNormalize` allows for disabling the URL normalization in Next.js to make handling direct visits and client-transitions the same. In some advanced cases, this option provides full control by using the original URL.\n-\n-```js filename=\"next.config.js\"\n-module.exports = {\n-  skipMiddlewareUrlNormalize: true,\n-}\n-```\n-\n-```js filename=\"middleware.js\"\n-export default async function middleware(req) {\n-  const { pathname } = req.nextUrl\n-\n-  // GET /_next/data/build-id/hello.json\n-\n-  console.log(pathname)\n-  // with the flag this now /_next/data/build-id/hello.json\n-  // without the flag this would be normalized to /hello\n-}\n-```\n-\n-## Examples\n-\n-### Conditional Statements\n-\n-```ts filename=\"middleware.ts\" switcher\n-import { NextResponse } from 'next/server'\n-import type { NextRequest } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  if (request.nextUrl.pathname.startsWith('/about')) {\n-    return NextResponse.rewrite(new URL('/about-2', request.url))\n-  }\n-\n-  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n-    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n-  }\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(request) {\n-  if (request.nextUrl.pathname.startsWith('/about')) {\n-    return NextResponse.rewrite(new URL('/about-2', request.url))\n-  }\n-\n-  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n-    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n-  }\n-}\n-```\n-\n-### Using Cookies\n-\n-Cookies are regular headers. On a `Request`, they are stored in the `Cookie` header. On a `Response` they are in the `Set-Cookie` header. Next.js provides a convenient way to access and manipulate these cookies through the `cookies` extension on `NextRequest` and `NextResponse`.\n-\n-1. For incoming requests, `cookies` comes with the following methods: `get`, `getAll`, `set`, and `delete` cookies. You can check for the existence of a cookie with `has` or remove all cookies with `clear`.\n-2. For outgoing responses, `cookies` have the following methods `get`, `getAll`, `set`, and `delete`.\n-\n-```ts filename=\"middleware.ts\" switcher\n-import { NextResponse } from 'next/server'\n-import type { NextRequest } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n-  // Getting cookies from the request using the `RequestCookies` API\n-  let cookie = request.cookies.get('nextjs')\n-  console.log(cookie) // => { name: 'nextjs', value: 'fast', Path: '/' }\n-  const allCookies = request.cookies.getAll()\n-  console.log(allCookies) // => [{ name: 'nextjs', value: 'fast' }]\n-\n-  request.cookies.has('nextjs') // => true\n-  request.cookies.delete('nextjs')\n-  request.cookies.has('nextjs') // => false\n-\n-  // Setting cookies on the response using the `ResponseCookies` API\n-  const response = NextResponse.next()\n-  response.cookies.set('vercel', 'fast')\n-  response.cookies.set({\n-    name: 'vercel',\n-    value: 'fast',\n-    path: '/',\n-  })\n-  cookie = response.cookies.get('vercel')\n-  console.log(cookie) // => { name: 'vercel', value: 'fast', Path: '/' }\n-  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/` header.\n-\n-  return response\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(request) {\n-  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n-  // Getting cookies from the request using the `RequestCookies` API\n-  let cookie = request.cookies.get('nextjs')\n-  console.log(cookie) // => { name: 'nextjs', value: 'fast', Path: '/' }\n-  const allCookies = request.cookies.getAll()\n-  console.log(allCookies) // => [{ name: 'nextjs', value: 'fast' }]\n-\n-  request.cookies.has('nextjs') // => true\n-  request.cookies.delete('nextjs')\n-  request.cookies.has('nextjs') // => false\n-\n-  // Setting cookies on the response using the `ResponseCookies` API\n-  const response = NextResponse.next()\n-  response.cookies.set('vercel', 'fast')\n-  response.cookies.set({\n-    name: 'vercel',\n-    value: 'fast',\n-    path: '/',\n-  })\n-  cookie = response.cookies.get('vercel')\n-  console.log(cookie) // => { name: 'vercel', value: 'fast', Path: '/' }\n-  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/` header.\n-\n-  return response\n-}\n-```\n-\n-### Setting Headers\n-\n-You can set request and response headers using the `NextResponse` API (setting _request_ headers is available since Next.js v13.0.0).\n-\n-```ts filename=\"middleware.ts\" switcher\n-import { NextResponse } from 'next/server'\n-import type { NextRequest } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  // Clone the request headers and set a new header `x-hello-from-middleware1`\n-  const requestHeaders = new Headers(request.headers)\n-  requestHeaders.set('x-hello-from-middleware1', 'hello')\n-\n-  // You can also set request headers in NextResponse.next\n-  const response = NextResponse.next({\n-    request: {\n-      // New request headers\n-      headers: requestHeaders,\n-    },\n-  })\n-\n-  // Set a new response header `x-hello-from-middleware2`\n-  response.headers.set('x-hello-from-middleware2', 'hello')\n-  return response\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(request) {\n-  // Clone the request headers and set a new header `x-hello-from-middleware1`\n-  const requestHeaders = new Headers(request.headers)\n-  requestHeaders.set('x-hello-from-middleware1', 'hello')\n-\n-  // You can also set request headers in NextResponse.next\n-  const response = NextResponse.next({\n-    request: {\n-      // New request headers\n-      headers: requestHeaders,\n-    },\n-  })\n-\n-  // Set a new response header `x-hello-from-middleware2`\n-  response.headers.set('x-hello-from-middleware2', 'hello')\n-  return response\n-}\n-```\n-\n-Note that the snippet uses:\n-\n-- `NextResponse.next({ request: { headers: requestHeaders } })` to make `requestHeaders` available upstream\n-- **NOT** `NextResponse.next({ headers: requestHeaders })` which makes `requestHeaders` available to clients\n-\n-Learn more in [NextResponse headers in Middleware](/docs/app/api-reference/functions/next-response#next).\n-\n-> **Good to know**: Avoid setting large headers as it might cause [431 Request Header Fields Too Large](https://developer.mozilla.org/docs/Web/HTTP/Status/431) error depending on your backend web server configuration.\n-\n-### CORS\n-\n-You can set CORS headers in Middleware to allow cross-origin requests, including [simple](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests) and [preflighted](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests) requests.\n-\n-```tsx filename=\"middleware.ts\" switcher\n-import { NextRequest, NextResponse } from 'next/server'\n-\n-const allowedOrigins = ['https://acme.com', 'https://my-app.org']\n-\n-const corsOptions = {\n-  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n-  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n-}\n-\n-export function middleware(request: NextRequest) {\n-  // Check the origin from the request\n-  const origin = request.headers.get('origin') ?? ''\n-  const isAllowedOrigin = allowedOrigins.includes(origin)\n-\n-  // Handle preflighted requests\n-  const isPreflight = request.method === 'OPTIONS'\n-\n-  if (isPreflight) {\n-    const preflightHeaders = {\n-      ...(isAllowedOrigin && { 'Access-Control-Allow-Origin': origin }),\n-      ...corsOptions,\n-    }\n-    return NextResponse.json({}, { headers: preflightHeaders })\n-  }\n-\n-  // Handle simple requests\n-  const response = NextResponse.next()\n-\n-  if (isAllowedOrigin) {\n-    response.headers.set('Access-Control-Allow-Origin', origin)\n-  }\n-\n-  Object.entries(corsOptions).forEach(([key, value]) => {\n-    response.headers.set(key, value)\n-  })\n-\n-  return response\n-}\n-\n-export const config = {\n-  matcher: '/api/:path*',\n-}\n-```\n-\n-```jsx filename=\"middleware.js\" switcher\n-import { NextResponse } from 'next/server'\n-\n-const allowedOrigins = ['https://acme.com', 'https://my-app.org']\n-\n-const corsOptions = {\n-  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n-  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n-}\n-\n-export function middleware(request) {\n-  // Check the origin from the request\n-  const origin = request.headers.get('origin') ?? ''\n-  const isAllowedOrigin = allowedOrigins.includes(origin)\n-\n-  // Handle preflighted requests\n-  const isPreflight = request.method === 'OPTIONS'\n-\n-  if (isPreflight) {\n-    const preflightHeaders = {\n-      ...(isAllowedOrigin && { 'Access-Control-Allow-Origin': origin }),\n-      ...corsOptions,\n-    }\n-    return NextResponse.json({}, { headers: preflightHeaders })\n-  }\n-\n-  // Handle simple requests\n-  const response = NextResponse.next()\n-\n-  if (isAllowedOrigin) {\n-    response.headers.set('Access-Control-Allow-Origin', origin)\n-  }\n-\n-  Object.entries(corsOptions).forEach(([key, value]) => {\n-    response.headers.set(key, value)\n-  })\n-\n-  return response\n-}\n-\n-export const config = {\n-  matcher: '/api/:path*',\n-}\n-```\n-\n-<AppOnly>\n-\n-> **Good to know:** You can configure CORS headers for individual routes in [Route Handlers](/docs/app/api-reference/file-conventions/route#cors).\n-\n-</AppOnly>\n-\n-### Producing a response\n-\n-You can respond from Middleware directly by returning a `Response` or `NextResponse` instance. (This is available since [Next.js v13.1.0](https://nextjs.org/blog/next-13-1#nextjs-advanced-middleware))\n-\n-```ts filename=\"middleware.ts\" switcher\n-import type { NextRequest } from 'next/server'\n-import { isAuthenticated } from '@lib/auth'\n-\n-// Limit the middleware to paths starting with `/api/`\n-export const config = {\n-  matcher: '/api/:function*',\n-}\n-\n-export function middleware(request: NextRequest) {\n-  // Call our authentication function to check the request\n-  if (!isAuthenticated(request)) {\n-    // Respond with JSON indicating an error message\n-    return Response.json(\n-      { success: false, message: 'authentication failed' },\n-      { status: 401 }\n-    )\n-  }\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-import { isAuthenticated } from '@lib/auth'\n-\n-// Limit the middleware to paths starting with `/api/`\n-export const config = {\n-  matcher: '/api/:function*',\n-}\n-\n-export function middleware(request) {\n-  // Call our authentication function to check the request\n-  if (!isAuthenticated(request)) {\n-    // Respond with JSON indicating an error message\n-    return Response.json(\n-      { success: false, message: 'authentication failed' },\n-      { status: 401 }\n-    )\n-  }\n-}\n-```\n-\n-### Negative matching\n-\n-The `matcher` config allows full regex so matching like negative lookaheads or character matching is supported. An example of a negative lookahead to match all except specific paths can be seen here:\n-\n-```js filename=\"middleware.js\"\n-export const config = {\n-  matcher: [\n-    /*\n-     * Match all request paths except for the ones starting with:\n-     * - api (API routes)\n-     * - _next/static (static files)\n-     * - _next/image (image optimization files)\n-     * - favicon.ico, sitemap.xml, robots.txt (metadata files)\n-     */\n-    '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n-  ],\n-}\n-```\n-\n-You can also bypass Middleware for certain requests by using the `missing` or `has` arrays, or a combination of both:\n-\n-```js filename=\"middleware.js\"\n-export const config = {\n-  matcher: [\n-    /*\n-     * Match all request paths except for the ones starting with:\n-     * - api (API routes)\n-     * - _next/static (static files)\n-     * - _next/image (image optimization files)\n-     * - favicon.ico, sitemap.xml, robots.txt (metadata files)\n-     */\n-    {\n-      source:\n-        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n-      missing: [\n-        { type: 'header', key: 'next-router-prefetch' },\n-        { type: 'header', key: 'purpose', value: 'prefetch' },\n-      ],\n-    },\n-\n-    {\n-      source:\n-        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n-      has: [\n-        { type: 'header', key: 'next-router-prefetch' },\n-        { type: 'header', key: 'purpose', value: 'prefetch' },\n-      ],\n-    },\n-\n-    {\n-      source:\n-        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n-      has: [{ type: 'header', key: 'x-present' }],\n-      missing: [{ type: 'header', key: 'x-missing', value: 'prefetch' }],\n-    },\n-  ],\n-}\n-```\n-\n-### `waitUntil` and `NextFetchEvent`\n-\n-The `NextFetchEvent` object extends the native [`FetchEvent`](https://developer.mozilla.org/docs/Web/API/FetchEvent) object, and includes the [`waitUntil()`](https://developer.mozilla.org/docs/Web/API/ExtendableEvent/waitUntil) method.\n-\n-The `waitUntil()` method takes a promise as an argument, and extends the lifetime of the Middleware until the promise settles. This is useful for performing work in the background.\n-\n-```ts filename=\"middleware.ts\"\n-import { NextResponse } from 'next/server'\n-import type { NextFetchEvent, NextRequest } from 'next/server'\n-\n-export function middleware(req: NextRequest, event: NextFetchEvent) {\n-  event.waitUntil(\n-    fetch('https://my-analytics-platform.com', {\n-      method: 'POST',\n-      body: JSON.stringify({ pathname: req.nextUrl.pathname }),\n-    })\n-  )\n-\n-  return NextResponse.next()\n-}\n-```\n-\n-### Unit testing (experimental)\n-\n-Starting in Next.js 15.1, the `next/experimental/testing/server` package contains utilities to help unit test middleware files. Unit testing middleware can help ensure that it's only run on desired paths and that custom routing logic works as intended before code reaches production.\n-\n-The `unstable_doesMiddlewareMatch` function can be used to assert whether middleware will run for the provided URL, headers, and cookies.\n-\n-```js\n-import { unstable_doesMiddlewareMatch } from 'next/experimental/testing/server'\n-\n-expect(\n-  unstable_doesMiddlewareMatch({\n-    config,\n-    nextConfig,\n-    url: '/test',\n-  })\n-).toEqual(false)\n-```\n-\n-The entire middleware function can also be tested.\n-\n-```js\n-import { isRewrite, getRewrittenUrl } from 'next/experimental/testing/server'\n-\n-const request = new NextRequest('https://nextjs.org/docs')\n-const response = await middleware(request)\n-expect(isRewrite(response)).toEqual(true)\n-expect(getRewrittenUrl(response)).toEqual('https://other-domain.com/docs')\n-// getRedirectUrl could also be used if the response were a redirect\n-```\n-\n-## Platform support\n-\n-| Deployment Option                                                   | Supported         |\n-| ------------------------------------------------------------------- | ----------------- |\n-| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n-| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n-| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n-| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n-\n-Learn how to [configure Middleware](/docs/app/guides/self-hosting#middleware) when self-hosting Next.js.\n-\n-## Version history\n-\n-| Version   | Changes                                                                                       |\n-| --------- | --------------------------------------------------------------------------------------------- |\n-| `v15.5.0` | Middleware can now use the Node.js runtime (stable)                                           |\n-| `v15.2.0` | Middleware can now use the Node.js runtime (experimental)                                     |\n-| `v13.1.0` | Advanced Middleware flags added                                                               |\n-| `v13.0.0` | Middleware can modify request headers, response headers, and send responses                   |\n-| `v12.2.0` | Middleware is stable, please see the [upgrade guide](/docs/messages/middleware-upgrade-guide) |\n-| `v12.0.9` | Enforce absolute URLs in Edge Runtime ([PR](https://github.com/vercel/next.js/pull/33410))    |\n-| `v12.0.0` | Middleware (Beta) added                                                                       |"
        },
        {
            "sha": "a53d63867bdbd72f1b5ae409118d281bed2e0fee",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/proxy.mdx",
            "status": "modified",
            "additions": 35,
            "deletions": 0,
            "changes": 35,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Fproxy.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Fproxy.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Fproxy.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -8,6 +8,8 @@ related:\n     - app/api-reference/functions/next-response\n ---\n \n+> **Note**: The `middleware` file convention is deprecated and has been renamed to `proxy`. See [Migration to Proxy](#migration-to-proxy) for more details.\n+\n The `proxy.js|ts` file is used to write [Proxy](/docs/app/getting-started/proxy) and run code on the server before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.\n \n Proxy executes before routes are rendered. It's particularly useful for implementing custom server-side logic like authentication, logging, or handling redirects.\n@@ -684,6 +686,39 @@ expect(getRewrittenUrl(response)).toEqual('https://other-domain.com/docs')\n \n Learn how to [configure Proxy](/docs/app/guides/self-hosting#proxy) when self-hosting Next.js.\n \n+## Migration to Proxy\n+\n+### Why the Change\n+\n+The reason behind the renaming of `middleware` is that the term \"middleware can often be confused with Express.js middleware, leading to a misinterpretation of its purpose. Also, Middleware is highly capable, so it may encourage the usage; however, this feature is recommended to be used as a last resort.\n+\n+Next.js is moving forward to provide better APIs with better ergonomics so that developers can achieve their goals without Middleware. This is the reason behind the renaming of `middleware`.\n+\n+### Why \"Proxy\"\n+\n+The name Proxy clarifies what Middleware is capable of. The term \"proxy\" implies that it has a network boundary in front of the app, which is the behavior of Middleware. Also, Middleware defaults to run at the [Edge Runtime](/docs/app/api-reference/edge), which can run closer to the client, separated from the app's region. These behaviors align better with the term \"proxy\" and provide a clearer purpose of the feature.\n+\n+### How to Migrate\n+\n+We recommend users avoid relying on Middleware unless no other options exist. Our goal is to give them APIs with better ergonomics so they can achieve their goals without Middleware.\n+\n+The term “middleware” often confuses users with Express.js middleware, which can encourage misuse. To clarify our direction, we are renaming the file convention to “proxy.” This highlights that we are moving away from Middleware, breaking down its overloaded features, and making the Proxy clear in its purpose.\n+\n+Next.js provides a codemod to migrate from `middleware.ts` to `proxy.ts`. You can run the following command to migrate:\n+\n+```bash\n+npx @next/codemod@canary middleware-to-proxy .\n+```\n+\n+The codemod will rename the file and the function name from `middleware` to `proxy`.\n+\n+```diff\n+// middleware.ts -> proxy.ts\n+\n+- export function middleware() {\n++ export function proxy() {\n+```\n+\n ## Version history\n \n | Version   | Changes                                                                                       |"
        },
        {
            "sha": "5866c0a7143fb515138b32bfbbb636eb76108af1",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/route-segment-config.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Froute-segment-config.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Froute-segment-config.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Froute-segment-config.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -162,7 +162,7 @@ export const fetchCache = 'auto'\n \n ### `runtime`\n \n-We recommend using the Node.js runtime for rendering your application, and the Edge runtime for Middleware.\n+We recommend using the Node.js runtime for rendering your application, and the Edge runtime for Proxy.\n \n ```tsx filename=\"layout.tsx | page.tsx | route.ts\" switcher\n export const runtime = 'nodejs'"
        },
        {
            "sha": "7f3076134dec361e4f9ed8decc3677e36175a14c",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/route.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Froute.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Froute.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Froute.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -546,7 +546,7 @@ export async function GET(request) {\n \n > **Good to know**:\n >\n-> - To add CORS headers to multiple Route Handlers, you can use [Middleware](/docs/app/api-reference/file-conventions/middleware#cors) or the [`next.config.js` file](/docs/app/api-reference/config/next-config-js/headers#cors).\n+> - To add CORS headers to multiple Route Handlers, you can use [Proxy](/docs/app/api-reference/file-conventions/proxy#cors) or the [`next.config.js` file](/docs/app/api-reference/config/next-config-js/headers#cors).\n \n ### Webhooks\n "
        },
        {
            "sha": "4f53d1f9bce9bac448711d945ff8fa392bb9e8db",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/src-folder.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Fsrc-folder.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Fsrc-folder.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2Fsrc-folder.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -30,6 +30,6 @@ To use the `src` folder, move the `app` Router folder or `pages` Router folder t\n > - `.env.*` files should remain in the root of your project.\n > - `src/app` or `src/pages` will be ignored if `app` or `pages` are present in the root directory.\n > - If you're using `src`, you'll probably also move other application folders such as `/components` or `/lib`.\n-> - If you're using Middleware, ensure it is placed inside the `src` folder.\n+> - If you're using Proxy, ensure it is placed inside the `src` folder.\n > - If you're using Tailwind CSS, you'll need to add the `/src` prefix to the `tailwind.config.js` file in the [content section](https://tailwindcss.com/docs/content-configuration).\n > - If you are using TypeScript paths for imports such as `@/*`, you should update the `paths` object in `tsconfig.json` to include `src/`."
        },
        {
            "sha": "b64d652adf158f8963e81e7f43eda7d517de72ff",
            "filename": "docs/01-app/03-api-reference/04-functions/after.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fafter.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fafter.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2Fafter.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -5,7 +5,7 @@ description: API Reference for the after function.\n \n `after` allows you to schedule work to be executed after a response (or prerender) is finished. This is useful for tasks and other side effects that should not block the response, such as logging and analytics.\n \n-It can be used in [Server Components](/docs/app/getting-started/server-and-client-components) (including [`generateMetadata`](/docs/app/api-reference/functions/generate-metadata)), [Server Actions](/docs/app/getting-started/updating-data), [Route Handlers](/docs/app/api-reference/file-conventions/route), and [Middleware](/docs/app/api-reference/file-conventions/middleware).\n+It can be used in [Server Components](/docs/app/getting-started/server-and-client-components) (including [`generateMetadata`](/docs/app/api-reference/functions/generate-metadata)), [Server Actions](/docs/app/getting-started/updating-data), [Route Handlers](/docs/app/api-reference/file-conventions/route), and [Proxy](/docs/app/api-reference/file-conventions/proxy).\n \n The function accepts a callback that will be executed after the response (or prerender) is finished:\n "
        },
        {
            "sha": "8f101f95e513a5d4640ced3a2aea93d93cfe4598",
            "filename": "docs/01-app/03-api-reference/04-functions/generate-metadata.mdx",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fgenerate-metadata.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fgenerate-metadata.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2Fgenerate-metadata.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -1067,17 +1067,17 @@ export const metadata = {\n \n The following metadata types do not currently have built-in support. However, they can still be rendered in the layout or page itself.\n \n-| Metadata                      | Recommendation                                                                                                                                                                                                                                         |\n-| ----------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n-| `<meta http-equiv=\"...\">`     | Use appropriate HTTP Headers via [`redirect()`](/docs/app/api-reference/functions/redirect), [Middleware](/docs/app/api-reference/file-conventions/middleware#nextresponse), [Security Headers](/docs/app/api-reference/config/next-config-js/headers) |\n-| `<base>`                      | Render the tag in the layout or page itself.                                                                                                                                                                                                           |\n-| `<noscript>`                  | Render the tag in the layout or page itself.                                                                                                                                                                                                           |\n-| `<style>`                     | Learn more about [styling in Next.js](/docs/app/getting-started/css).                                                                                                                                                                                  |\n-| `<script>`                    | Learn more about [using scripts](/docs/app/guides/scripts).                                                                                                                                                                                            |\n-| `<link rel=\"stylesheet\" />`   | `import` stylesheets directly in the layout or page itself.                                                                                                                                                                                            |\n-| `<link rel=\"preload />`       | Use [ReactDOM preload method](#link-relpreload)                                                                                                                                                                                                        |\n-| `<link rel=\"preconnect\" />`   | Use [ReactDOM preconnect method](#link-relpreconnect)                                                                                                                                                                                                  |\n-| `<link rel=\"dns-prefetch\" />` | Use [ReactDOM prefetchDNS method](#link-reldns-prefetch)                                                                                                                                                                                               |\n+| Metadata                      | Recommendation                                                                                                                                                                                                                               |\n+| ----------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n+| `<meta http-equiv=\"...\">`     | Use appropriate HTTP Headers via [`redirect()`](/docs/app/api-reference/functions/redirect), [Proxy](/docs/app/api-reference/file-conventions/proxy#nextresponse), [Security Headers](/docs/app/api-reference/config/next-config-js/headers) |\n+| `<base>`                      | Render the tag in the layout or page itself.                                                                                                                                                                                                 |\n+| `<noscript>`                  | Render the tag in the layout or page itself.                                                                                                                                                                                                 |\n+| `<style>`                     | Learn more about [styling in Next.js](/docs/app/getting-started/css).                                                                                                                                                                        |\n+| `<script>`                    | Learn more about [using scripts](/docs/app/guides/scripts).                                                                                                                                                                                  |\n+| `<link rel=\"stylesheet\" />`   | `import` stylesheets directly in the layout or page itself.                                                                                                                                                                                  |\n+| `<link rel=\"preload />`       | Use [ReactDOM preload method](#link-relpreload)                                                                                                                                                                                              |\n+| `<link rel=\"preconnect\" />`   | Use [ReactDOM preconnect method](#link-relpreconnect)                                                                                                                                                                                        |\n+| `<link rel=\"dns-prefetch\" />` | Use [ReactDOM prefetchDNS method](#link-reldns-prefetch)                                                                                                                                                                                     |\n \n ### Resource hints\n "
        },
        {
            "sha": "8d7bad00e2a7bfc0f3a13166d231ccd49c86f4fe",
            "filename": "docs/01-app/03-api-reference/04-functions/next-response.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fnext-response.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fnext-response.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2Fnext-response.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -119,7 +119,7 @@ return NextResponse.rewrite(new URL('/proxy', request.url))\n \n ## `next()`\n \n-The `next()` method is useful for Middleware, as it allows you to return early and continue routing.\n+The `next()` method is useful for Proxy, as it allows you to return early and continue routing.\n \n ```ts\n import { NextResponse } from 'next/server'\n@@ -147,12 +147,12 @@ return NextResponse.next({\n \n This forwards `newHeaders` upstream to the target page, route, or server action, and does not expose them to the client. While this pattern is useful for passing data upstream, it should be used with caution because the headers containing this data may be forwarded to external services.\n \n-In contrast, `NextResponse.next({ headers })` is a shorthand for sending headers from middleware to the client. This is **NOT** good practice and should be avoided. Among other reasons because setting response headers like `Content-Type`, can override framework expectations (for example, the `Content-Type` used by Server Actions), leading to failed submissions or broken streaming responses.\n+In contrast, `NextResponse.next({ headers })` is a shorthand for sending headers from proxy to the client. This is **NOT** good practice and should be avoided. Among other reasons because setting response headers like `Content-Type`, can override framework expectations (for example, the `Content-Type` used by Server Actions), leading to failed submissions or broken streaming responses.\n \n ```ts\n import { type NextRequest, NextResponse } from 'next/server'\n \n-async function middleware(request: NextRequest) {\n+async function proxy(request: NextRequest) {\n   const headers = await injectAuth(request.headers)\n   // DO NOT forward headers like this\n   return NextResponse.next({ headers })\n@@ -166,7 +166,7 @@ Prefer a defensive approach by creating a subset of incoming request headers usi\n ```ts\n import { type NextRequest, NextResponse } from 'next/server'\n \n-function middleware(request: NextRequest) {\n+function proxy(request: NextRequest) {\n   const incoming = new Headers(request.headers)\n   const forwarded = new Headers()\n "
        },
        {
            "sha": "e161f5b1cc5881186d232f8f9b7606bac3595044",
            "filename": "docs/01-app/03-api-reference/04-functions/redirect.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fredirect.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fredirect.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2Fredirect.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -52,7 +52,7 @@ The `type` parameter has no effect when used in Server Components.\n - `redirect` throws an error so it should be called **outside** the `try` block when using `try/catch` statements.\n - `redirect` can be called in Client Components during the rendering process but not in event handlers. You can use the [`useRouter` hook](/docs/app/api-reference/functions/use-router) instead.\n - `redirect` also accepts absolute URLs and can be used to redirect to external links.\n-- If you'd like to redirect before the render process, use [`next.config.js`](/docs/app/guides/redirecting#redirects-in-nextconfigjs) or [Middleware](/docs/app/guides/redirecting#nextresponseredirect-in-middleware).\n+- If you'd like to redirect before the render process, use [`next.config.js`](/docs/app/guides/redirecting#redirects-in-nextconfigjs) or [Proxy](/docs/app/guides/redirecting#nextresponseredirect-in-proxy).\n \n ## Example\n "
        },
        {
            "sha": "c25f4a238f7bc95d46529ecbbd81caf3298212c6",
            "filename": "docs/01-app/03-api-reference/04-functions/revalidatePath.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2FrevalidatePath.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2FrevalidatePath.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2FrevalidatePath.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -9,7 +9,7 @@ description: API Reference for the revalidatePath function.\n \n `revalidatePath` can be called in Server Functions and Route Handlers.\n \n-`revalidatePath` cannot be called in Client Components or Middleware, as it only works in server environments.\n+`revalidatePath` cannot be called in Client Components or Proxy, as it only works in server environments.\n \n > **Good to know**:\n >"
        },
        {
            "sha": "0fcbcc0f2e8570d8d4666a5ab739c1c285465f8e",
            "filename": "docs/01-app/03-api-reference/04-functions/revalidateTag.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2FrevalidateTag.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2FrevalidateTag.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2FrevalidateTag.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -11,7 +11,7 @@ This function is ideal for content where a slight delay in updates is acceptable\n \n `revalidateTag` can be called in Server Functions and Route Handlers.\n \n-`revalidateTag` cannot be called in Client Components or Middleware, as it only works in server environments.\n+`revalidateTag` cannot be called in Client Components or Proxy, as it only works in server environments.\n \n ### Revalidation Behavior\n "
        },
        {
            "sha": "d04a0ca12907f6f8167987dde2da3aec49f78cc6",
            "filename": "docs/01-app/03-api-reference/04-functions/use-pathname.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-pathname.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-pathname.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-pathname.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -36,7 +36,7 @@ For example, a Client Component with `usePathname` will be rendered into HTML on\n > - Reading the current URL from a [Server Component](/docs/app/getting-started/server-and-client-components) is not supported. This design is intentional to support layout state being preserved across page navigations.\n > - Compatibility mode:\n >   - `usePathname` can return `null` when a [fallback route](/docs/pages/api-reference/functions/get-static-paths#fallback-true) is being rendered or when a `pages` directory page has been [automatically statically optimized](/docs/pages/building-your-application/rendering/automatic-static-optimization) by Next.js and the router is not ready.\n->   - When using `usePathname` with rewrites in [`next.config`](/docs/app/api-reference/config/next-config-js/rewrites) or [`Middleware`](/docs/app/api-reference/file-conventions/middleware), `useState` and `useEffect` must also be used in order to avoid hydration mismatch errors.\n+>   - When using `usePathname` with rewrites in [`next.config`](/docs/app/api-reference/config/next-config-js/rewrites) or [`Proxy`](/docs/app/api-reference/file-conventions/proxy), `useState` and `useEffect` must also be used in order to avoid hydration mismatch errors.\n >   - Next.js will automatically update your types if it detects both an `app` and `pages` directory in your project.\n \n ## Parameters\n@@ -94,7 +94,7 @@ function ExampleClientComponent() {\n \n ### Avoid hydration mismatch with rewrites\n \n-When a page is pre-rendered, the HTML is generated for the source pathname. If the page is then reached through a rewrite using `next.config` or `Middleware`, the browser URL may differ, and `usePathname()` will read the rewritten pathname on the client.\n+When a page is pre-rendered, the HTML is generated for the source pathname. If the page is then reached through a rewrite using `next.config` or `Proxy`, the browser URL may differ, and `usePathname()` will read the rewritten pathname on the client.\n \n To avoid hydration mismatches, design the UI so that only a small, isolated part depends on the client pathname. Render a stable fallback on the server and update that part after mount.\n "
        },
        {
            "sha": "0a51909270a592960e06c01d40508ab56fe6eb2d",
            "filename": "docs/01-app/03-api-reference/04-functions/userAgent.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2FuserAgent.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F04-functions%2FuserAgent.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2FuserAgent.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -7,10 +7,10 @@ description: The userAgent helper extends the Web Request API with additional pr\n \n The `userAgent` helper extends the [Web Request API](https://developer.mozilla.org/docs/Web/API/Request) with additional properties and methods to interact with the user agent object from the request.\n \n-```ts filename=\"middleware.ts\" switcher\n+```ts filename=\"proxy.ts\" switcher\n import { NextRequest, NextResponse, userAgent } from 'next/server'\n \n-export function middleware(request: NextRequest) {\n+export function proxy(request: NextRequest) {\n   const url = request.nextUrl\n   const { device } = userAgent(request)\n \n@@ -23,10 +23,10 @@ export function middleware(request: NextRequest) {\n }\n ```\n \n-```js filename=\"middleware.js\" switcher\n+```js filename=\"proxy.js\" switcher\n import { NextResponse, userAgent } from 'next/server'\n \n-export function middleware(request) {\n+export function proxy(request) {\n   const url = request.nextUrl\n   const { device } = userAgent(request)\n "
        },
        {
            "sha": "dd4472b2a62dd3caecc13cdb5ddbdfd76e548a2e",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/index.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Findex.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Findex.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Findex.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -125,7 +125,7 @@ Starting in Next.js 15.1, the `next/experimental/testing/server` package contain\n \n The `unstable_getResponseFromNextConfig` function runs the [`headers`](/docs/app/api-reference/config/next-config-js/headers), [`redirects`](/docs/app/api-reference/config/next-config-js/redirects), and [`rewrites`](/docs/app/api-reference/config/next-config-js/rewrites) functions from `next.config.js` with the provided request information and returns `NextResponse` with the results of the routing.\n \n-> The response from `unstable_getResponseFromNextConfig` only considers `next.config.js` fields and does not consider middleware or filesystem routes, so the result in production may be different than the unit test.\n+> The response from `unstable_getResponseFromNextConfig` only considers `next.config.js` fields and does not consider proxy or filesystem routes, so the result in production may be different than the unit test.\n \n ```js\n import {"
        },
        {
            "sha": "703331919d0a99320d22614a06c27420b576693b",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/pageExtensions.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FpageExtensions.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FpageExtensions.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FpageExtensions.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -34,13 +34,13 @@ module.exports = {\n \n Changing these values affects _all_ Next.js pages, including the following:\n \n-- [`middleware.js`](/docs/pages/api-reference/file-conventions/middleware)\n+- [`proxy.js`](/docs/pages/api-reference/file-conventions/proxy)\n - [`instrumentation.js`](/docs/pages/guides/instrumentation)\n - `pages/_document.js`\n - `pages/_app.js`\n - `pages/api/`\n \n-For example, if you reconfigure `.ts` page extensions to `.page.ts`, you would need to rename pages like `middleware.page.ts`, `instrumentation.page.ts`, `_app.page.ts`.\n+For example, if you reconfigure `.ts` page extensions to `.page.ts`, you would need to rename pages like `proxy.page.ts`, `instrumentation.page.ts`, `_app.page.ts`.\n \n ## Including non-page files in the `pages` directory\n "
        },
        {
            "sha": "52b1285f8b8db092d9595c609a2e50e991c2e741",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/proxyClientMaxBodySize.mdx",
            "status": "renamed",
            "additions": 12,
            "deletions": 12,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FproxyClientMaxBodySize.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FproxyClientMaxBodySize.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FproxyClientMaxBodySize.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -1,10 +1,10 @@\n ---\n-title: experimental.middlewareClientMaxBodySize\n-description: Configure the maximum request body size when using middleware.\n+title: experimental.proxyClientMaxBodySize\n+description: Configure the maximum request body size when using proxy.\n version: experimental\n ---\n \n-When middleware is used, Next.js automatically clones the request body and buffers it in memory to enable multiple reads - both in middleware and the underlying route handler. To prevent excessive memory usage, this configuration option sets a size limit on the buffered body.\n+When proxy is used, Next.js automatically clones the request body and buffers it in memory to enable multiple reads - both in proxy and the underlying route handler. To prevent excessive memory usage, this configuration option sets a size limit on the buffered body.\n \n By default, the maximum body size is **10MB**. If a request body exceeds this limit, the body will only be buffered up to the limit, and a warning will be logged indicating which route exceeded the limit.\n \n@@ -19,7 +19,7 @@ import type { NextConfig } from 'next'\n \n const nextConfig: NextConfig = {\n   experimental: {\n-    middlewareClientMaxBodySize: '1mb',\n+    proxyClientMaxBodySize: '1mb',\n   },\n }\n \n@@ -30,7 +30,7 @@ export default nextConfig\n /** @type {import('next').NextConfig} */\n const nextConfig = {\n   experimental: {\n-    middlewareClientMaxBodySize: '1mb',\n+    proxyClientMaxBodySize: '1mb',\n   },\n }\n \n@@ -48,7 +48,7 @@ import type { NextConfig } from 'next'\n \n const nextConfig: NextConfig = {\n   experimental: {\n-    middlewareClientMaxBodySize: 1048576, // 1MB in bytes\n+    proxyClientMaxBodySize: 1048576, // 1MB in bytes\n   },\n }\n \n@@ -59,7 +59,7 @@ export default nextConfig\n /** @type {import('next').NextConfig} */\n const nextConfig = {\n   experimental: {\n-    middlewareClientMaxBodySize: 1048576, // 1MB in bytes\n+    proxyClientMaxBodySize: 1048576, // 1MB in bytes\n   },\n }\n \n@@ -77,17 +77,17 @@ When a request body exceeds the configured limit:\n \n If your application needs to process the full request body, you should either:\n \n-- Increase the `middlewareClientMaxBodySize` limit\n+- Increase the `proxyClientMaxBodySize` limit\n - Handle the partial body gracefully in your application logic\n \n ## Example\n \n-```ts filename=\"middleware.ts\"\n+```ts filename=\"proxy.ts\"\n import { NextRequest, NextResponse } from 'next/server'\n \n-export async function middleware(request: NextRequest) {\n+export async function proxy(request: NextRequest) {\n   // Next.js automatically buffers the body with the configured size limit\n-  // You can read the body in middleware...\n+  // You can read the body in proxy...\n   const body = await request.text()\n \n   // If the body exceeded the limit, only partial data will be available\n@@ -112,7 +112,7 @@ export async function POST(request: NextRequest) {\n \n ## Good to know\n \n-- This setting only applies when middleware is used in your application\n+- This setting only applies when proxy is used in your application\n - The default limit of 10MB is designed to balance memory usage and typical use cases\n - The limit applies per-request, not globally across all concurrent requests\n - For applications handling large file uploads, consider increasing the limit accordingly",
            "previous_filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/middlewareClientMaxBodySize.mdx"
        },
        {
            "sha": "0c167ff43afade9ff8eb3c504724c704a7c90eb0",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/redirects.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Fredirects.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Fredirects.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Fredirects.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -38,7 +38,7 @@ module.exports = {\n \n Redirects are checked before the filesystem which includes pages and `/public` files.\n \n-When using the Pages Router, redirects are not applied to client-side routing (`Link`, `router.push`) unless [Middleware](/docs/app/api-reference/file-conventions/middleware) is present and matches the path.\n+When using the Pages Router, redirects are not applied to client-side routing (`Link`, `router.push`) unless [Proxy](/docs/app/api-reference/file-conventions/proxy) is present and matches the path.\n \n When a redirect is applied, any query values provided in the request will be passed through to the redirect destination. For example, see the following redirect configuration:\n \n@@ -252,7 +252,7 @@ module.exports = {\n \n When implementing redirects with internationalization in the App Router, you can include locales in `next.config.js` redirects, but only as hardcoded paths.\n \n-For dynamic or per-request locale handling, use [dynamic route segments and middleware](/docs/app/guides/internationalization), which can redirect based on the user's preferred language.\n+For dynamic or per-request locale handling, use [dynamic route segments and proxy](/docs/app/guides/internationalization), which can redirect based on the user's preferred language.\n \n ```js filename=\"next.config.js\"\n module.exports = {"
        },
        {
            "sha": "981db9b70174595445cab8a97b81631def0a9137",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/rewrites.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Frewrites.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Frewrites.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Frewrites.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -90,7 +90,7 @@ The order Next.js routes are checked is:\n \n 1. [headers](/docs/app/api-reference/config/next-config-js/headers) are checked/applied\n 2. [redirects](/docs/app/api-reference/config/next-config-js/redirects) are checked/applied\n-3. [middleware](/docs/app/api-reference/file-conventions/middleware)\n+3. [proxy](/docs/app/api-reference/file-conventions/proxy)\n 4. `beforeFiles` rewrites are checked/applied\n 5. static files from the [public directory](/docs/app/api-reference/file-conventions/public-folder), `_next/static` files, and non-dynamic pages are checked/served\n 6. `afterFiles` rewrites are checked/applied, if one of these rewrites is matched we check dynamic routes/static files after each match"
        },
        {
            "sha": "e243bdaed5ff8f68ba2835a0cddcb9439233814b",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/webpack.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Fwebpack.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Fwebpack.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2Fwebpack.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -85,4 +85,4 @@ module.exports = {\n \n #### `nextRuntime`\n \n-Notice that `isServer` is `true` when `nextRuntime` is `\"edge\"` or `\"nodejs\"`, `nextRuntime` `\"edge\"` is currently for middleware and Server Components in edge runtime only.\n+Notice that `isServer` is `true` when `nextRuntime` is `\"edge\"` or `\"nodejs\"`, `nextRuntime` `\"edge\"` is currently for proxy and Server Components in edge runtime only."
        },
        {
            "sha": "4253729a16ead9e5e38c49da6b6c7d465d53e8e6",
            "filename": "docs/01-app/03-api-reference/05-config/02-typescript.mdx",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F02-typescript.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F05-config%2F02-typescript.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F02-typescript.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -226,13 +226,13 @@ export default function Example() {\n }\n ```\n \n-The same applies for redirecting routes defined by middleware:\n+The same applies for redirecting routes defined by proxy:\n \n-```ts filename=\"middleware.ts\"\n+```ts filename=\"proxy.ts\"\n import { NextRequest, NextResponse } from 'next/server'\n \n-export function middleware(request: NextRequest) {\n-  if (request.nextUrl.pathname === '/middleware-redirect') {\n+export function proxy(request: NextRequest) {\n+  if (request.nextUrl.pathname === '/proxy-redirect') {\n     return NextResponse.redirect(new URL('/', request.url))\n   }\n \n@@ -244,7 +244,7 @@ export function middleware(request: NextRequest) {\n import type { Route } from 'next'\n \n export default function Page() {\n-  return <Link href={'/middleware-redirect' as Route}>Link Text</Link>\n+  return <Link href={'/proxy-redirect' as Route}>Link Text</Link>\n }\n ```\n "
        },
        {
            "sha": "ef6fffb56b3a329b0351b929562365845dd47fa3",
            "filename": "docs/01-app/03-api-reference/07-edge.mdx",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F07-edge.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F01-app%2F03-api-reference%2F07-edge.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F07-edge.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -8,7 +8,7 @@ description: API Reference for the Edge Runtime.\n Next.js has two server runtimes you can use in your application:\n \n - The **Node.js Runtime** (default), which has access to all Node.js APIs and is used for rendering your application.\n-- The **Edge Runtime** which contains a more limited [set of APIs](#reference), used in [Middleware](/docs/app/api-reference/file-conventions/middleware).\n+- The **Edge Runtime** which contains a more limited [set of APIs](#reference), used in [Proxy](/docs/app/api-reference/file-conventions/proxy).\n \n ## Caveats\n \n@@ -159,9 +159,9 @@ The following JavaScript language features are disabled, and **will not work:**\n | [`WebAssembly.instantiate`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/instantiate) | Compiles and instantiates a WebAssembly module from a buffer source |\n \n In rare cases, your code could contain (or import) some dynamic code evaluation statements which _can not be reached at runtime_ and which can not be removed by treeshaking.\n-You can relax the check to allow specific files with your Middleware configuration:\n+You can relax the check to allow specific files with your Proxy configuration:\n \n-```javascript filename=\"middleware.ts\"\n+```javascript filename=\"proxy.ts\"\n export const config = {\n   unstable_allowDynamic: [\n     // allows a single file"
        },
        {
            "sha": "22af6bfc5d1c06b12ab80a36206768709e5bd30e",
            "filename": "docs/02-pages/02-guides/internationalization.mdx",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F02-guides%2Finternationalization.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F02-guides%2Finternationalization.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F02-guides%2Finternationalization.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -144,7 +144,7 @@ When using Sub-path Routing, the user would be redirected to `/fr`.\n \n ### Prefixing the Default Locale\n \n-With Next.js 12 and [Middleware](/docs/pages/api-reference/file-conventions/middleware), we can add a prefix to the default locale with a [workaround](https://github.com/vercel/next.js/discussions/18419).\n+With Next.js 12 and [Proxy](/docs/pages/api-reference/file-conventions/proxy), we can add a prefix to the default locale with a [workaround](https://github.com/vercel/next.js/discussions/18419).\n \n For example, here's a `next.config.js` file with support for a few languages. Note the `\"default\"` locale has been added intentionally.\n \n@@ -159,14 +159,14 @@ module.exports = {\n }\n ```\n \n-Next, we can use [Middleware](/docs/pages/api-reference/file-conventions/middleware) to add custom routing rules:\n+Next, we can use [Proxy](/docs/pages/api-reference/file-conventions/proxy) to add custom routing rules:\n \n-```ts filename=\"middleware.ts\"\n+```ts filename=\"proxy.ts\"\n import { NextRequest, NextResponse } from 'next/server'\n \n const PUBLIC_FILE = /\\.(.*)$/\n \n-export async function middleware(req: NextRequest) {\n+export async function proxy(req: NextRequest) {\n   if (\n     req.nextUrl.pathname.startsWith('/_next') ||\n     req.nextUrl.pathname.includes('/api/') ||\n@@ -185,7 +185,7 @@ export async function middleware(req: NextRequest) {\n }\n ```\n \n-This [Middleware](/docs/pages/api-reference/file-conventions/middleware) skips adding the default prefix to [API Routes](/docs/pages/building-your-application/routing/api-routes) and [public](/docs/pages/api-reference/file-conventions/public-folder) files like fonts or images. If a request is made to the default locale, we redirect to our prefix `/en`.\n+This [Proxy](/docs/pages/api-reference/file-conventions/proxy) skips adding the default prefix to [API Routes](/docs/pages/building-your-application/routing/api-routes) and [public](/docs/pages/api-reference/file-conventions/public-folder) files like fonts or images. If a request is made to the default locale, we redirect to our prefix `/en`.\n \n ### Disabling Automatic Locale Detection\n \n@@ -352,4 +352,4 @@ export async function getStaticProps({ locale }) {\n - `locales`: 100 total locales\n - `domains`: 100 total locale domain items\n \n-> **Good to know**: These limits have been added initially to prevent potential [performance issues at build time](#dynamic-routes-and-getstaticprops-pages). You can workaround these limits with custom routing using [Middleware](/docs/pages/api-reference/file-conventions/middleware) in Next.js 12.\n+> **Good to know**: These limits have been added initially to prevent potential [performance issues at build time](#dynamic-routes-and-getstaticprops-pages). You can workaround these limits with custom routing using [Proxy](/docs/pages/api-reference/file-conventions/proxy) in Next.js 12."
        },
        {
            "sha": "55fa9caa2d6f26b8e1a4c635e8bd494324919d64",
            "filename": "docs/02-pages/03-building-your-application/01-routing/03-linking-and-navigating.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F03-building-your-application%2F01-routing%2F03-linking-and-navigating.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F03-building-your-application%2F01-routing%2F03-linking-and-navigating.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F03-building-your-application%2F01-routing%2F03-linking-and-navigating.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -181,4 +181,4 @@ router.push('/?counter=10', '/about?counter=10', { shallow: true })\n \n Since that's a new page, it'll unload the current page, load the new one and wait for data fetching even though we asked to do shallow routing.\n \n-When shallow routing is used with middleware it will not ensure the new page matches the current page like previously done without middleware. This is due to middleware being able to rewrite dynamically and can't be verified client-side without a data fetch which is skipped with shallow, so a shallow route change must always be treated as shallow.\n+When shallow routing is used with proxy it will not ensure the new page matches the current page like previously done without proxy. This is due to proxy being able to rewrite dynamically and can't be verified client-side without a data fetch which is skipped with shallow, so a shallow route change must always be treated as shallow."
        },
        {
            "sha": "afa135c2f39e0ada0d6255b930b7215d55ce0f98",
            "filename": "docs/02-pages/03-building-your-application/01-routing/07-api-routes.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F03-building-your-application%2F01-routing%2F07-api-routes.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F03-building-your-application%2F01-routing%2F07-api-routes.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F03-building-your-application%2F01-routing%2F07-api-routes.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -6,7 +6,7 @@ description: Next.js supports API Routes, which allow you to build your API with\n <details>\n   <summary>Examples</summary>\n \n-- [API Routes Request Helpers](https://github.com/vercel/next.js/tree/canary/examples/api-routes-middleware)\n+- [API Routes Request Helpers](https://github.com/vercel/next.js/tree/canary/examples/api-routes-proxy)\n - [API Routes with GraphQL](https://github.com/vercel/next.js/tree/canary/examples/api-routes-graphql)\n - [API Routes with REST](https://github.com/vercel/next.js/tree/canary/examples/api-routes-rest)\n - [API Routes with CORS](https://github.com/vercel/next.js/tree/canary/examples/api-routes-cors)"
        },
        {
            "sha": "82ca9b6e41fe0024db46ff256fd9e2a50d2d56fb",
            "filename": "docs/02-pages/03-building-your-application/03-data-fetching/01-get-static-props.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F03-building-your-application%2F03-data-fetching%2F01-get-static-props.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F03-building-your-application%2F03-data-fetching%2F01-get-static-props.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F03-building-your-application%2F03-data-fetching%2F01-get-static-props.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -51,7 +51,7 @@ You should use `getStaticProps` if:\n - The data required to render the page is available at build time ahead of a user’s request\n - The data comes from a headless CMS\n - The page must be pre-rendered (for SEO) and be very fast — `getStaticProps` generates `HTML` and `JSON` files, both of which can be cached by a CDN for performance\n-- The data can be publicly cached (not user-specific). This condition can be bypassed in certain specific situation by using a Middleware to rewrite the path.\n+- The data can be publicly cached (not user-specific). This condition can be bypassed in certain specific situation by using a Proxy to rewrite the path.\n \n ## When does getStaticProps run\n \n@@ -65,7 +65,7 @@ You should use `getStaticProps` if:\n \n When combined with [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration), `getStaticProps` will run in the background while the stale page is being revalidated, and the fresh page served to the browser.\n \n-`getStaticProps` does not have access to the incoming request (such as query parameters or HTTP headers) as it generates static HTML. If you need access to the request for your page, consider using [Middleware](/docs/pages/api-reference/file-conventions/middleware) in addition to `getStaticProps`.\n+`getStaticProps` does not have access to the incoming request (such as query parameters or HTTP headers) as it generates static HTML. If you need access to the request for your page, consider using [Proxy](/docs/pages/api-reference/file-conventions/proxy) in addition to `getStaticProps`.\n \n ## Using getStaticProps to fetch data from a CMS\n "
        },
        {
            "sha": "77f664583b3c85d2200dc2c7f5bd2c2c17670c11",
            "filename": "docs/02-pages/04-api-reference/02-file-conventions/middleware.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/docs%2F02-pages%2F04-api-reference%2F02-file-conventions%2Fmiddleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/docs%2F02-pages%2F04-api-reference%2F02-file-conventions%2Fmiddleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F04-api-reference%2F02-file-conventions%2Fmiddleware.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,7 +0,0 @@\n----\n-title: Middleware\n-description: Learn how to use Middleware to run code before a request is completed.\n-source: app/api-reference/file-conventions/middleware\n----\n-\n-{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
        },
        {
            "sha": "99d233f39b06712fae36b537fe1cd20c253e7c4a",
            "filename": "docs/02-pages/04-api-reference/04-config/01-next-config-js/proxyClientMaxBodySize.mdx",
            "status": "renamed",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F04-api-reference%2F04-config%2F01-next-config-js%2FproxyClientMaxBodySize.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/docs%2F02-pages%2F04-api-reference%2F04-config%2F01-next-config-js%2FproxyClientMaxBodySize.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F04-api-reference%2F04-config%2F01-next-config-js%2FproxyClientMaxBodySize.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -1,7 +1,7 @@\n ---\n-title: experimental.middlewareClientMaxBodySize\n-description: Configure the maximum request body size when using middleware.\n-source: app/api-reference/config/next-config-js/middlewareClientMaxBodySize\n+title: experimental.proxyClientMaxBodySize\n+description: Configure the maximum request body size when using proxy.\n+source: app/api-reference/config/next-config-js/proxyClientMaxBodySize\n ---\n \n {/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}",
            "previous_filename": "docs/02-pages/04-api-reference/04-config/01-next-config-js/middlewareClientMaxBodySize.mdx"
        },
        {
            "sha": "647ce243248e1f78eb7e9b4c0cc695f21b80d816",
            "filename": "errors/beta-middleware.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 18,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fbeta-middleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fbeta-middleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fbeta-middleware.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,18 +0,0 @@\n----\n-title: Addressing \"Beta Middleware Used\" Error in Next.js\n-description: This document clarifies the \"Beta Middleware Used\" error in Next.js and provides a potential solution to fix it.\n----\n-\n-## Why This Error Occurred\n-\n-The \"Beta Middleware Used\" error occurs if you are using [Middleware](/docs/pages/api-reference/file-conventions/middleware) in a version of Next.js prior to `v12.2`. The Middleware feature was still in beta in those versions and not yet covered by [semver](https://semver.org/) or Semantic Versioning rules.\n-\n-## Possible Ways to Fix It\n-\n-Despite this error, you can continue using Middleware in versions prior to `v12.2`. Be aware that **upgrading to newer versions of Next.js will require changes to your application to accommodate updates in Middleware handling**.\n-\n-If you're using Next.js on Vercel, your existing deployments using Middleware will remain functional, and you can keep deploying your site with Middleware. However, when you decide to upgrade your site to Next.js `v12.2` or later, you'll need to follow the provided [upgrade guide](/docs/messages/middleware-upgrade-guide) to ensure compatibility.\n-\n-## Useful Links\n-\n-- [Middleware Upgrade Guide](/docs/messages/middleware-upgrade-guide) - Learn more about the necessary steps to upgrade your application to a version of Next.js that includes the official version of Middleware."
        },
        {
            "sha": "45ad279f5ea547ee879cc4ea890f8a7097bbb9ec",
            "filename": "errors/deleting-query-params-in-middlewares.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 37,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fdeleting-query-params-in-middlewares.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fdeleting-query-params-in-middlewares.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fdeleting-query-params-in-middlewares.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,37 +0,0 @@\n----\n-title: Deleting Query Parameters In Middlewares\n----\n-\n-## Why This Error Occurred\n-\n-In previous versions of Next.js, we were merging query parameters with the incoming request for rewrites happening in middlewares, to match the behavior of static rewrites declared in the config. This forced Next.js users to use empty query parameters values to delete keys.\n-\n-We are changing this behavior to allow extra flexibility and a more streamlined experience for users. So from now on, query parameters will not be merged and thus the warning.\n-\n-```ts filename=\"middleware.ts\"\n-import type { NextRequest } from 'next/server'\n-import { NextResponse } from 'next/server'\n-\n-export default function middleware(request: NextRequest) {\n-  const nextUrl = request.nextUrl\n-  nextUrl.searchParams.delete('key') // <-- this is now possible!\n-  return NextResponse.rewrite(nextUrl)\n-}\n-```\n-\n-## Possible Ways to Fix It\n-\n-If you are relying on the old behavior, please add the query parameters manually to the rewritten URL. Using `request.nextUrl` would do that automatically for you.\n-\n-```ts filename=\"middleware.ts\"\n-import type { NextRequest } from 'next/server'\n-import { NextResponse } from 'next/server'\n-\n-export default function middleware(request: NextRequest) {\n-  const nextUrl = request.nextUrl\n-  nextUrl.pathname = '/dest'\n-  return NextResponse.rewrite(nextUrl)\n-}\n-```\n-\n-This warning will be removed in the next version of Next.js."
        },
        {
            "sha": "f0f11d73331f3bccd51fabc5199fbd78897fb4d5",
            "filename": "errors/edge-dynamic-code-evaluation.mdx",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fedge-dynamic-code-evaluation.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fedge-dynamic-code-evaluation.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fedge-dynamic-code-evaluation.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -1,10 +1,10 @@\n ---\n-title: Dynamic code evaluation is not available in Middleware\n+title: Dynamic code evaluation is not available in Proxy\n ---\n \n ## Why This Error Occurred\n \n-`eval()`, `new Function()` or compiling WASM binaries dynamically is not allowed in Middleware.\n+`eval()`, `new Function()` or compiling WASM binaries dynamically is not allowed in Proxy.\n Specifically, the following APIs are not supported:\n \n - `eval()`\n@@ -16,11 +16,11 @@ Specifically, the following APIs are not supported:\n \n You can bundle your WASM binaries using `import`:\n \n-```ts filename=\"middleware.ts\"\n+```ts filename=\"proxy.ts\"\n import { NextResponse } from 'next/server'\n import squareWasm from './square.wasm?module'\n \n-export default async function middleware() {\n+export default async function proxy() {\n   const m = await WebAssembly.instantiate(squareWasm)\n   const answer = m.exports.square(9)\n \n@@ -31,7 +31,7 @@ export default async function middleware() {\n ```\n \n In rare cases, your code could contain (or import) some dynamic code evaluation statements which _can not be reached at runtime_ and which can not be removed by tree-shaking.\n-You can relax the check to allow specific files with your Middleware [configuration](/docs/pages/api-reference/edge#unsupported-apis):\n+You can relax the check to allow specific files with your Proxy [configuration](/docs/pages/api-reference/edge#unsupported-apis):\n \n ```ts filename=\"pages/api/example.ts\"\n export const config = {"
        },
        {
            "sha": "7370606108e77a9dfd8e06b24de12b58a49b641c",
            "filename": "errors/gssp-no-mutating-res.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fgssp-no-mutating-res.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fgssp-no-mutating-res.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fgssp-no-mutating-res.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -14,7 +14,7 @@ For this reason, accessing the object after this time is disallowed.\n \n You can fix this error by moving any access of the `res` object into `getServerSideProps()` itself or any functions that run before `getServerSideProps()` returns.\n \n-If you’re using a custom server and running into this problem due to session middleware like `next-session` or `express-session`, try installing the middleware in the server instead of `getServerSideProps()`.\n+If you’re using a custom server and running into this problem due to session proxy like `next-session` or `express-session`, try installing the proxy in the server instead of `getServerSideProps()`.\n \n ## Useful Links\n "
        },
        {
            "sha": "b0fcef8fd40fbeae2ac7d60e7ad75ca5bab3a1a1",
            "filename": "errors/invalid-route-source.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Finvalid-route-source.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Finvalid-route-source.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Finvalid-route-source.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -4,7 +4,7 @@ title: 'Invalid Custom Route `source`'\n \n ## Why This Error Occurred\n \n-A pattern could not be parsed when defining custom routes or a middleware `matcher`.\n+A pattern could not be parsed when defining custom routes or a proxy `matcher`.\n \n This could have been due to trying to use normal `RegExp` syntax like negative lookaheads (`?!exclude`) without following [`path-to-regexp`](https://github.com/pillarjs/path-to-regexp)'s syntax.\n \n@@ -32,19 +32,19 @@ Wrap the `RegExp` part of your `source` as an un-named parameter.\n }\n ```\n \n-### Middleware\n+### Proxy\n \n **Before**\n \n-```ts filename=\"middleware.ts\"\n+```ts filename=\"proxy.ts\"\n const config = {\n   matcher: '/feedback/(?!general)',\n }\n ```\n \n **After**\n \n-```ts filename=\"middleware.ts\"\n+```ts filename=\"proxy.ts\"\n const config = {\n   matcher: '/feedback/((?!general).*)',\n }"
        },
        {
            "sha": "72d9dcdc873f449ddcbfbc46e99022b17f454eab",
            "filename": "errors/middleware-dynamic-wasm-compilation.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 29,
            "changes": 29,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-dynamic-wasm-compilation.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-dynamic-wasm-compilation.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fmiddleware-dynamic-wasm-compilation.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,29 +0,0 @@\n----\n-title: Dynamic WASM compilation is not available in Middlewares\n----\n-\n-## Why This Error Occurred\n-\n-Compiling WASM binaries dynamically is not allowed in Middlewares. Specifically,\n-the following APIs are not supported:\n-\n-- `WebAssembly.compile`\n-- `WebAssembly.instantiate` with [a buffer parameter](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/instantiate#primary_overload_%E2%80%94_taking_wasm_binary_code)\n-\n-## Possible Ways to Fix It\n-\n-Bundle your WASM binaries using `import`:\n-\n-```ts filename=\"middleware.ts\"\n-import { NextResponse } from 'next/server'\n-import squareWasm from './square.wasm?module'\n-\n-export default async function middleware() {\n-  const m = await WebAssembly.instantiate(squareWasm)\n-  const answer = m.exports.square(9)\n-  const response = NextResponse.next()\n-\n-  response.headers.set('x-square', answer.toString())\n-  return response\n-}\n-```"
        },
        {
            "sha": "ea9aa89d427860cf1a5d4bff3783ecb744c18c9f",
            "filename": "errors/middleware-new-signature.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 37,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-new-signature.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-new-signature.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fmiddleware-new-signature.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,37 +0,0 @@\n----\n-title: Deprecated Middleware API Signature\n----\n-\n-## Why This Error Occurred\n-\n-Your application is using a Middleware function that is using parameters from the deprecated API.\n-\n-```ts filename=\"middleware.ts\"\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(event) {\n-  if (event.request.nextUrl.pathname === '/blocked') {\n-    event.respondWith(\n-      new NextResponse(null, {\n-        status: 403,\n-      })\n-    )\n-  }\n-}\n-```\n-\n-## Possible Ways to Fix It\n-\n-Update to use the new API for Middleware:\n-\n-```ts filename=\"middleware.ts\"\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(request) {\n-  if (request.nextUrl.pathname === '/blocked') {\n-    return new NextResponse(null, {\n-      status: 403,\n-    })\n-  }\n-}\n-```"
        },
        {
            "sha": "13b79dca22b3912f505bef52da025bb98ddea633",
            "filename": "errors/middleware-parse-user-agent.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 34,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-parse-user-agent.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-parse-user-agent.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fmiddleware-parse-user-agent.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,34 +0,0 @@\n----\n-title: Removed parsed User Agent from Middleware API\n----\n-\n-## Why This Error Occurred\n-\n-Your application is interacting with `req.ua` which has been deprecated.\n-\n-```ts filename=\"middleware.ts\"\n-import { NextRequest, NextResponse } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  const viewport = request.ua.device.type === 'mobile' ? 'mobile' : 'desktop'\n-\n-  request.nextUrl.searchParams.set('viewport', viewport)\n-  return NextResponse.rewrite(request.nextUrl)\n-}\n-```\n-\n-## Possible Ways to Fix It\n-\n-The internal logic has been moved into a separate `userAgent` function that you can import from `next/server` and wrap your request instead.\n-\n-```ts filename=\"middleware.ts\"\n-import { NextRequest, NextResponse, userAgent } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  const { device } = userAgent(request)\n-  const viewport = device.type === 'mobile' ? 'mobile' : 'desktop'\n-\n-  request.nextUrl.searchParams.set('viewport', viewport)\n-  return NextResponse.rewrite(request.nextUrl)\n-}\n-```"
        },
        {
            "sha": "8912217f5679b3437094ac0479d28294d9375665",
            "filename": "errors/middleware-relative-urls.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 40,
            "changes": 40,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-relative-urls.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-relative-urls.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fmiddleware-relative-urls.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,40 +0,0 @@\n----\n-title: Middleware Relative URLs\n----\n-\n-## Why This Error Occurred\n-\n-You are using a Middleware function that uses `Response.redirect(url)`, `NextResponse.redirect(url)` or `NextResponse.rewrite(url)` where `url` is a relative or an invalid URL. Prior to Next.js 12.1, we allowed passing relative URLs. However, constructing a request with `new Request(url)` or running `fetch(url)` when `url` is a relative URL **does not** work. For this reason and to bring consistency to Next.js Middleware, this behavior has been deprecated and now removed.\n-\n-## Possible Ways to Fix It\n-\n-To fix this error you must always pass absolute URL for redirecting and rewriting. There are several ways to get the absolute URL but the recommended way is to clone `NextURL` and mutate it:\n-\n-```ts filename=\"middleware.ts\"\n-import type { NextRequest } from 'next/server'\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  const url = request.nextUrl.clone()\n-  url.pathname = '/dest'\n-  return NextResponse.rewrite(url)\n-}\n-```\n-\n-Another way to fix this error could be to use the original URL as the base but this will not consider configuration like `basePath` or `locale`:\n-\n-```ts filename=\"middleware.ts\"\n-import type { NextRequest } from 'next/server'\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  return NextResponse.rewrite(new URL('/dest', request.url))\n-}\n-```\n-\n-You can also pass directly a string containing a valid absolute URL.\n-\n-## Useful Links\n-\n-- [URL Documentation](https://developer.mozilla.org/docs/Web/API/URL)\n-- [Response Documentation](https://developer.mozilla.org/docs/Web/API/Response)"
        },
        {
            "sha": "f281156be399b763ef94d14d796f408de7f249c6",
            "filename": "errors/middleware-request-page.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 61,
            "changes": 61,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-request-page.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-request-page.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fmiddleware-request-page.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,61 +0,0 @@\n----\n-title: Removed page from Middleware API\n----\n-\n-## Why This Error Occurred\n-\n-Your application is interacting with `request.page` which has been deprecated.\n-\n-```ts filename=\"middleware.ts\"\n-import { NextRequest, NextResponse } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  const { params } = request.page\n-  const { locale, slug } = params\n-\n-  if (locale && slug) {\n-    const { search, protocol, host } = request.nextUrl\n-    const url = new URL(`${protocol}//${locale}.${host}/${slug}${search}`)\n-    return NextResponse.redirect(url)\n-  }\n-}\n-```\n-\n-## Possible Ways to Fix It\n-\n-You can use [URLPattern](https://developer.mozilla.org/docs/Web/API/URLPattern) instead to have the same behavior:\n-\n-```ts filename=\"middleware.ts\"\n-import { NextRequest, NextResponse } from 'next/server'\n-\n-const PATTERNS = [\n-  [\n-    new URLPattern({ pathname: '/:locale/:slug' }),\n-    ({ pathname }) => pathname.groups,\n-  ],\n-]\n-\n-const params = (url) => {\n-  const input = url.split('?')[0]\n-  let result = {}\n-\n-  for (const [pattern, handler] of PATTERNS) {\n-    const patternResult = pattern.exec(input)\n-    if (patternResult !== null && 'pathname' in patternResult) {\n-      result = handler(patternResult)\n-      break\n-    }\n-  }\n-  return result\n-}\n-\n-export function middleware(request: NextRequest) {\n-  const { locale, slug } = params(request.url)\n-\n-  if (locale && slug) {\n-    const { search, protocol, host } = request.nextUrl\n-    const url = new URL(`${protocol}//${locale}.${host}/${slug}${search}`)\n-    return NextResponse.redirect(url)\n-  }\n-}\n-```"
        },
        {
            "sha": "ec77b8ef395dd8e5b07a2e326599a96d582f7cd7",
            "filename": "errors/middleware-user-agent.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 34,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-user-agent.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fmiddleware-user-agent.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fmiddleware-user-agent.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,34 +0,0 @@\n----\n-title: Removed req.ua from Middleware API\n----\n-\n-## Why This Error Occurred\n-\n-Your middleware is interacting with `req.ua` and this feature needs to opt-in.\n-\n-```ts filename=\"middleware.ts\"\n-import { NextRequest, NextResponse } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  const url = request.nextUrl\n-  const viewport = request.ua.device.type === 'mobile' ? 'mobile' : 'desktop'\n-  url.searchParams.set('viewport', viewport)\n-  return NextResponse.rewrite(url)\n-}\n-```\n-\n-## Possible Ways to Fix It\n-\n-To parse the user agent, import `userAgent` function from `next/server` and give it your request:\n-\n-```ts filename=\"middleware.ts\"\n-import { NextRequest, NextResponse, userAgent } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  const url = request.nextUrl\n-  const { device } = userAgent(request)\n-  const viewport = device.type === 'mobile' ? 'mobile' : 'desktop'\n-  url.searchParams.set('viewport', viewport)\n-  return NextResponse.rewrite(url)\n-}\n-```"
        },
        {
            "sha": "f28d96d899db67ac8d6887dd76296cc7bcd11512",
            "filename": "errors/nested-middleware.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 31,
            "changes": 31,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fnested-middleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Fnested-middleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fnested-middleware.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,31 +0,0 @@\n----\n-title: Nested Middleware\n----\n-\n-## Why This Error Occurred\n-\n-You are defining a Middleware file in a location different from `<root>/middleware`, which is not allowed.\n-\n-While in beta, a Middleware file under specific pages would _only_ be executed when pages below its declaration were matched, allowing nesting Middleware files. Based on customer feedback, we have replaced this API with a single root Middleware.\n-\n-## Possible Ways to Fix It\n-\n-Declare your Middleware in the root folder and use `NextRequest` parsed URL to define which path the Middleware should be executed for.\n-\n-For example, a Middleware at `pages/about/_middleware.ts` can move the logic to `<root>/middleware.ts` in the root of your repository. Then, a conditional statement can be used to only run the Middleware when it matches the `about/*` path:\n-\n-```ts filename=\"middleware.ts\"\n-import type { NextRequest } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  if (request.nextUrl.pathname.startsWith('/about')) {\n-    // This logic is only applied to /about\n-  }\n-\n-  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n-    // This logic is only applied to /dashboard\n-  }\n-}\n-```\n-\n-If you have more than one Middleware, you should combine them into a single file and model their execution depending on the incoming request."
        },
        {
            "sha": "e34633cd4768bb52d2f73cca54f3decae9e83187",
            "filename": "errors/next-response-next-in-app-route-handler.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fnext-response-next-in-app-route-handler.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fnext-response-next-in-app-route-handler.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fnext-response-next-in-app-route-handler.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -4,9 +4,9 @@ title: '`NextResponse.next()` used in a Route Handler in the App Router'\n \n ## Why This Error Occurred\n \n-Route Handlers in the Next.js App Router do not support using the `NextResponse.next()` method to forward to the next Middleware.\n+Route Handlers in the Next.js App Router do not support using the `NextResponse.next()` method to forward to the next Proxy.\n \n-The Route Handler is considered the end of the middleware \"chain\". Handlers must always return a `Response` object instead.\n+The Route Handler is considered the end of the proxy \"chain\". Handlers must always return a `Response` object instead.\n \n ## Possible Ways to Fix It\n "
        },
        {
            "sha": "75366da42ef301c9cc513f81e01ba42230821775",
            "filename": "errors/no-server-import-in-page.mdx",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fno-server-import-in-page.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fno-server-import-in-page.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fno-server-import-in-page.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -2,24 +2,24 @@\n title: No Server Import In Page\n ---\n \n-> Prevent usage of `next/server` outside of `middleware.js`.\n+> Prevent usage of `next/server` outside of `proxy.js`.\n \n ## Why This Error Occurred\n \n-`next/server` was imported outside of `middleware.{js,ts}`.\n+`next/server` was imported outside of `proxy.{js,ts}`.\n \n ## Possible Ways to Fix It\n \n-Only import and use `next/server` in a file located within the project root directory: `middleware.{js,ts}`.\n+Only import and use `next/server` in a file located within the project root directory: `proxy.{js,ts}`.\n \n-```ts filename=\"middleware.ts\"\n+```ts filename=\"proxy.ts\"\n import type { NextFetchEvent, NextRequest } from 'next/server'\n \n-export function middleware(req: NextRequest, ev: NextFetchEvent) {\n+export function proxy(req: NextRequest, ev: NextFetchEvent) {\n   return new Response('Hello, world!')\n }\n ```\n \n ## Useful Links\n \n-- [Middleware](/docs/pages/api-reference/file-conventions/middleware)\n+- [Proxy](/docs/pages/api-reference/file-conventions/proxy)"
        },
        {
            "sha": "7c17fb56c4559cf514d65302ac1104d85fb3e511",
            "filename": "errors/node-module-in-edge-runtime.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fnode-module-in-edge-runtime.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/errors%2Fnode-module-in-edge-runtime.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fnode-module-in-edge-runtime.mdx?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -4,7 +4,7 @@ title: Using Node.js Modules in Edge Runtime\n \n ## Why This Error Occurred\n \n-The code in your [Middleware](/docs/pages/api-reference/file-conventions/middleware) or your [Edge API Routes](/docs/pages/building-your-application/routing/api-routes) is using a feature from Node.js runtime.\n+The code in your [Proxy](/docs/pages/api-reference/file-conventions/proxy) or your [Edge API Routes](/docs/pages/building-your-application/routing/api-routes) is using a feature from Node.js runtime.\n \n However, the Edge Runtime does not support [Node.js APIs and globals](/docs/pages/api-reference/edge#unsupported-apis).\n \n@@ -17,5 +17,5 @@ For example, you might replace the Node.js `crypto` module with the [Web Crypto\n ## Useful Links\n \n - [Edge Runtime Supported APIs](/docs/pages/api-reference/edge)\n-- [Next.js Middleware](/docs/pages/api-reference/file-conventions/middleware)\n+- [Next.js Proxy](/docs/pages/api-reference/file-conventions/proxy)\n - [JWT Example](https://vercel.com/templates/next.js/jwt-authentication)"
        },
        {
            "sha": "c0cfb174c3d49ccba92c358d68aca567fe3da09e",
            "filename": "errors/returning-response-body-in-middleware.mdx",
            "status": "removed",
            "additions": 0,
            "deletions": 67,
            "changes": 67,
            "blob_url": "https://github.com/vercel/next.js/blob/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Freturning-response-body-in-middleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3129db08ad4ebc3221a0aff1965ea7330d9553ae/errors%2Freturning-response-body-in-middleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Freturning-response-body-in-middleware.mdx?ref=3129db08ad4ebc3221a0aff1965ea7330d9553ae",
            "patch": "@@ -1,67 +0,0 @@\n----\n-title: Returning response body in Middleware\n----\n-\n-> **Note**: In Next.js v13.0.0 you can now respond to Middleware directly by returning a `NextResponse`. For more information, see [Producing a Response](/docs/pages/api-reference/file-conventions/middleware#producing-a-response).\n-\n-## Why This Error Occurred\n-\n-[Middleware](/docs/pages/api-reference/file-conventions/middleware) can no longer produce a response body as of `v12.2+`.\n-\n-## Possible Ways to Fix It\n-\n-Migrate to using `rewrite`/`redirect` to Pages/API Routes handling a response.\n-\n-### Explanation\n-\n-To respect the differences in client-side and server-side navigation, and to help ensure that developers do not build insecure Middleware, Middleware can no longer produce a response body. This ensures that Middleware is only used to `rewrite`, `redirect`, or modify the incoming request (e.g. [setting cookies](/docs/pages/api-reference/file-conventions/middleware#using-cookies)).\n-\n-The following patterns will no longer work:\n-\n-```js\n-new Response('a text value')\n-new Response(streamOrBuffer)\n-new Response(JSON.stringify(obj), { headers: 'application/json' })\n-NextResponse.json()\n-```\n-\n-### How to upgrade\n-\n-For cases where Middleware is used to respond (such as authorization), you should migrate to use `rewrite`/`redirect` to pages that show an authorization error, login forms, or to an API Route.\n-\n-#### Before\n-\n-```ts filename=\"pages/_middleware.ts\"\n-import { NextResponse } from 'next/server'\n-import type { NextRequest } from 'next/server'\n-import { isAuthValid } from './lib/auth'\n-\n-export function middleware(request: NextRequest) {\n-  // Example function to validate auth\n-  if (isAuthValid(request)) {\n-    return NextResponse.next()\n-  }\n-\n-  return NextResponse.json({ message: 'Auth required' }, { status: 401 })\n-}\n-```\n-\n-#### After\n-\n-```ts filename=\"middleware.ts\"\n-import { NextResponse } from 'next/server'\n-import type { NextRequest } from 'next/server'\n-import { isAuthValid } from './lib/auth'\n-\n-export function middleware(request: NextRequest) {\n-  // Example function to validate auth\n-  if (isAuthValid(request)) {\n-    return NextResponse.next()\n-  }\n-\n-  request.nextUrl.searchParams.set('from', request.nextUrl.pathname)\n-  request.nextUrl.pathname = '/login'\n-\n-  return NextResponse.redirect(request.nextUrl)\n-}\n-```"
        },
        {
            "sha": "f25dc45d0047be43f74d96dae846be9b8d19b14f",
            "filename": "packages/next/src/build/analysis/get-page-static-info.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bc59f210b02256e63b93d9f473c97ae130568e63/packages%2Fnext%2Fsrc%2Fbuild%2Fanalysis%2Fget-page-static-info.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/bc59f210b02256e63b93d9f473c97ae130568e63/packages%2Fnext%2Fsrc%2Fbuild%2Fanalysis%2Fget-page-static-info.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fanalysis%2Fget-page-static-info.ts?ref=bc59f210b02256e63b93d9f473c97ae130568e63",
            "patch": "@@ -54,7 +54,7 @@ export type MiddlewareMatcher = {\n \n export type ProxyConfig = {\n   /**\n-   * The matcher for the middleware. Read more: [Next.js Docs: Middleware `matcher`](https://nextjs.org/docs/app/api-reference/file-conventions/middleware#matcher),\n+   * The matcher for the middleware. Read more: [Next.js Docs: Middleware `matcher`](https://nextjs.org/docs/app/api-reference/file-conventions/proxy#matcher),\n    * [Next.js Docs: Middleware matching paths](https://nextjs.org/docs/app/building-your-application/routing/middleware#matching-paths)\n    */\n   matchers?: MiddlewareMatcher[]"
        }
    ],
    "stats": {
        "total": 1592,
        "additions": 267,
        "deletions": 1325
    }
}