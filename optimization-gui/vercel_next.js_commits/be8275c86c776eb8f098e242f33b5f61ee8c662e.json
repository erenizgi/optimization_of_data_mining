{
    "author": "wbinnssmith",
    "message": "`@next/codemod`: Add `experimental.turbo` to `turbopack` codemod for Next.js configs (#82134)\n\nThis adds a new transform to `@next/codemod` that updates\n`next.config.{js,ts}` that updates the deprecated `experimental.turbo`\nproperty to the new top-level `turbopack` property.\n\nDetails:\n- Only operates on files called next.config.js or next.config.ts, in the\ncase the codemod tool is run on a large codebase.\n- Updates _any_ object literal with a `experimental.turbo` property to\nuse `turbopack`. Since this transform is constrained to Next.js configs,\nthere shouldnâ€™t be many false positives.\n- Much of this change was written by Copilot. I simplified it, and\nrefactored it to make it more readable and safe.\n\nTest Plan:\n- `pnpm run build && pnpm test -- -t\nnext-experimental-turbo-to-turbopack` in the codemod directory\n- Tested on several publicly available next configs that used the\ndeprecated property",
    "sha": "be8275c86c776eb8f098e242f33b5f61ee8c662e",
    "files": [
        {
            "sha": "e2096e53390ce213d689a33a7aa469a809459da0",
            "filename": "packages/next-codemod/bin/transform.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Fbin%2Ftransform.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Fbin%2Ftransform.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Fbin%2Ftransform.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -129,7 +129,7 @@ export async function runTransform(\n   if (verbose) {\n     args.push('--verbose=2')\n   }\n-  args.push('--no-babel')\n+  args.push('--parser=tsx')\n \n   args.push('--ignore-pattern=**/node_modules/**')\n   args.push('--ignore-pattern=**/.next/**')"
        },
        {
            "sha": "d0923ffe1c277fe482fb626cd778ee6cf032316a",
            "filename": "packages/next-codemod/lib/utils.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Flib%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Flib%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Flib%2Futils.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -116,4 +116,9 @@ export const TRANSFORMER_INQUIRER_CHOICES = [\n     value: 'app-dir-runtime-config-experimental-edge',\n     version: '15.0.0-canary.179',\n   },\n+  {\n+    title: 'Updates `next.config.js` to use the new `turbopack` configuration',\n+    value: 'next-experimental-turbo-to-turbopack',\n+    version: '10.0.0',\n+  },\n ]"
        },
        {
            "sha": "a61082de15c88434cf5bafcce9aa717486d09fa8",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/commonjs-var.input.js",
            "status": "added",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fcommonjs-var.input.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fcommonjs-var.input.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fcommonjs-var.input.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,22 @@\n+// CommonJS configuration with variable declaration first\n+const config = {\n+  experimental: {\n+    turbo: {\n+      resolveAlias: {\n+        underscore: 'lodash',\n+        mocha: { browser: 'mocha/browser-entry.js' },\n+      },\n+      memoryLimit: 4096,\n+      minify: true,\n+      treeShaking: false,\n+      sourceMaps: true\n+    },\n+    serverActions: true,\n+    typedRoutes: false\n+  },\n+  images: {\n+    formats: ['image/avif', 'image/webp']\n+  }\n+};\n+\n+module.exports = config;"
        },
        {
            "sha": "39c9d19708d4e275f25c69df2f0fa5e61fd5817e",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/commonjs-var.output.js",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fcommonjs-var.output.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fcommonjs-var.output.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fcommonjs-var.output.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,24 @@\n+// CommonJS configuration with variable declaration first\n+const config = {\n+  experimental: {\n+    serverActions: true,\n+    typedRoutes: false,\n+    turbopackMemoryLimit: 4096,\n+    turbopackMinify: true,\n+    turbopackTreeShaking: false,\n+    turbopackSourceMaps: true\n+  },\n+\n+  images: {\n+    formats: ['image/avif', 'image/webp']\n+  },\n+\n+  turbopack: {\n+    resolveAlias: {\n+      underscore: 'lodash',\n+      mocha: { browser: 'mocha/browser-entry.js' },\n+    }\n+  }\n+};\n+\n+module.exports = config;"
        },
        {
            "sha": "1f443eca873c43bcc3d4d0fe8fc9e722e899e955",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/esm.input.js",
            "status": "added",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fesm.input.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fesm.input.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fesm.input.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,19 @@\n+export default {\n+  experimental: {\n+    turbo: {\n+      resolveAlias: {\n+        underscore: 'lodash',\n+        mocha: { browser: 'mocha/browser-entry.js' },\n+      },\n+      memoryLimit: 4096,\n+      minify: true,\n+      treeShaking: false,\n+      sourceMaps: true\n+    },\n+    serverActions: true,\n+    typedRoutes: false,\n+  },\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+}"
        },
        {
            "sha": "bfeb635c9d5d81a3bb1e63cc4ed6166bf755a5db",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/esm.output.js",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fesm.output.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fesm.output.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fesm.output.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,21 @@\n+export default {\n+  experimental: {\n+    serverActions: true,\n+    typedRoutes: false,\n+    turbopackMemoryLimit: 4096,\n+    turbopackMinify: true,\n+    turbopackTreeShaking: false,\n+    turbopackSourceMaps: true\n+  },\n+\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+\n+  turbopack: {\n+    resolveAlias: {\n+      underscore: 'lodash',\n+      mocha: { browser: 'mocha/browser-entry.js' },\n+    }\n+  }\n+};"
        },
        {
            "sha": "a02f2e77f1c4434364e9a6054992b8dde70e1ae8",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/mixed-config.input.js",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmixed-config.input.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmixed-config.input.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmixed-config.input.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,23 @@\n+module.exports = {\n+  experimental: {\n+    turbo: {\n+      resolveAlias: {\n+        underscore: 'lodash',\n+        mocha: { browser: 'mocha/browser-entry.js' },\n+      },\n+      memoryLimit: 4096,\n+      minify: true,\n+      treeShaking: false,\n+      sourceMaps: true\n+    },\n+    serverActions: true,\n+    typedRoutes: false,\n+  },\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+}\n+\n+module.exports.turbopack.resolveAlias.chai = {\n+  browser: 'chai/chai.js',\n+};"
        },
        {
            "sha": "2a6fed08e5ff45c21e6ef3e92a5ac0e90f33e9a7",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/mixed-config.output.js",
            "status": "added",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmixed-config.output.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmixed-config.output.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmixed-config.output.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,25 @@\n+module.exports = {\n+  experimental: {\n+    serverActions: true,\n+    typedRoutes: false,\n+    turbopackMemoryLimit: 4096,\n+    turbopackMinify: true,\n+    turbopackTreeShaking: false,\n+    turbopackSourceMaps: true\n+  },\n+\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+\n+  turbopack: {\n+    resolveAlias: {\n+      underscore: 'lodash',\n+      mocha: { browser: 'mocha/browser-entry.js' },\n+    }\n+  }\n+}\n+\n+module.exports.turbopack.resolveAlias.chai = {\n+  browser: 'chai/chai.js',\n+};"
        },
        {
            "sha": "7fbf84b1ff7ba48bfcd573c27bf8af9e5b66e050",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/modified-var.input.js",
            "status": "added",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmodified-var.input.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmodified-var.input.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmodified-var.input.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,22 @@\n+// CommonJS configuration with variable declaration and modification\n+const config = {\n+  experimental: {\n+    turbo: {\n+      resolveAlias: {\n+        underscore: 'lodash',\n+      },\n+      memoryLimit: 4096,\n+    },\n+    typedRoutes: true,\n+  },\n+};\n+\n+// Add additional configuration before export\n+config.images = {\n+  formats: ['image/avif', 'image/webp']\n+};\n+\n+// Add more to turbo config\n+config.experimental.turbo.sourceMaps = true;\n+\n+module.exports = config;"
        },
        {
            "sha": "6ebf9accb451ddb5664f2f1eab399cfc7be90aa3",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/modified-var.output.js",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmodified-var.output.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmodified-var.output.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fmodified-var.output.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,23 @@\n+// CommonJS configuration with variable declaration and modification\n+const config = {\n+  experimental: {\n+    typedRoutes: true,\n+    turbopackMemoryLimit: 4096,\n+  },\n+\n+  turbopack: {\n+    resolveAlias: {\n+      underscore: 'lodash',\n+    }\n+  }\n+};\n+\n+// Add additional configuration before export\n+config.images = {\n+  formats: ['image/avif', 'image/webp']\n+};\n+\n+// Add more to turbo config\n+config.experimental.turbopackSourceMaps = true;\n+\n+module.exports = config;"
        },
        {
            "sha": "fe01c7d76f0de3a8b5524e8b189ca63b8cc07e56",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/no-change.input.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fno-change.input.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fno-change.input.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fno-change.input.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1 @@\n+export const x = 3;"
        },
        {
            "sha": "fe01c7d76f0de3a8b5524e8b189ca63b8cc07e56",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/no-change.output.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fno-change.output.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fno-change.output.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fno-change.output.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1 @@\n+export const x = 3;"
        },
        {
            "sha": "9086395bbde333cdc72ee89ffc01915fb2005096",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/property-assignment.input.js",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fproperty-assignment.input.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fproperty-assignment.input.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fproperty-assignment.input.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,23 @@\n+// CommonJS with object property assignment\n+const config = {\n+  experimental: {\n+    turbo: {\n+      resolveAlias: {\n+        underscore: 'lodash',\n+      }\n+    },\n+    typedRoutes: true,\n+  },\n+};\n+\n+// Add properties to the turbo object\n+config.experimental.turbo.resolveAlias.foo = 'bar';\n+config.experimental.turbo.minify = true;\n+config.experimental.turbo.memoryLimit = 4096;\n+\n+// Add regular property\n+config.images = {\n+  formats: ['image/avif', 'image/webp'],\n+};\n+\n+module.exports = config;"
        },
        {
            "sha": "7300d481707cb8fe2022681c25a56d6f3eb3248e",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/property-assignment.output.js",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fproperty-assignment.output.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fproperty-assignment.output.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fproperty-assignment.output.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,24 @@\n+// CommonJS with object property assignment\n+const config = {\n+  experimental: {\n+    typedRoutes: true\n+  },\n+\n+  turbopack: {\n+    resolveAlias: {\n+      underscore: 'lodash',\n+    }\n+  }\n+};\n+\n+// Add properties to the turbo object\n+config.turbopack.resolveAlias.foo = 'bar';\n+config.experimental.turbopackMinify = true;\n+config.experimental.turbopackMemoryLimit = 4096;\n+\n+// Add regular property\n+config.images = {\n+  formats: ['image/avif', 'image/webp'],\n+};\n+\n+module.exports = config;"
        },
        {
            "sha": "e8f0de3e338d83f7f8a357f5f11e5cf483a3ad95",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/typescript-as-const.input.ts",
            "status": "added",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-as-const.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-as-const.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-as-const.input.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,22 @@\n+import type { NextConfig } from 'next';\n+\n+const config = {\n+  experimental: {\n+    turbo: {\n+      resolveAlias: {\n+        underscore: 'lodash',\n+        mocha: { browser: 'mocha/browser-entry.js' },\n+      },\n+      memoryLimit: 4096,\n+      minify: true,\n+      treeShaking: false,\n+      sourceMaps: true,\n+    },\n+    typedRoutes: true,\n+  },\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+} as const;\n+\n+export default config;"
        },
        {
            "sha": "26ae648d434a8185889a8539a0200e670366762b",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/typescript-as-const.output.ts",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-as-const.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-as-const.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-as-const.output.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,24 @@\n+import type { NextConfig } from 'next';\n+\n+const config = {\n+  experimental: {\n+    typedRoutes: true,\n+    turbopackMemoryLimit: 4096,\n+    turbopackMinify: true,\n+    turbopackTreeShaking: false,\n+    turbopackSourceMaps: true\n+  },\n+\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+\n+  turbopack: {\n+    resolveAlias: {\n+      underscore: 'lodash',\n+      mocha: { browser: 'mocha/browser-entry.js' },\n+    }\n+  }\n+} as const;\n+\n+export default config;"
        },
        {
            "sha": "690edc74b3a54c77a2804fb44a328561e96e33fb",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/typescript-satisfies-wrapped.input.ts",
            "status": "added",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies-wrapped.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies-wrapped.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies-wrapped.input.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,22 @@\n+import type { NextConfig } from \"next\";\n+\n+const nextConfig = {\n+  experimental: {\n+    mdxRs: true,\n+    turbo: {\n+      rules: {\n+        \"*.react.svg\": {\n+          loaders: [\"@svgr/webpack\"],\n+          as: \"*.js\",\n+        },\n+      },\n+    },\n+  },\n+  // Other config properties\n+  webpack(config) {\n+    return config;\n+  },\n+} satisfies NextConfig;\n+\n+const withMDX = require(\"@next/mdx\")();\n+export default withMDX(nextConfig);"
        },
        {
            "sha": "9d0fc56f2dd8c2f8fb7bd86c566947cdf79d9cce",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/typescript-satisfies-wrapped.output.ts",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies-wrapped.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies-wrapped.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies-wrapped.output.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,24 @@\n+import type { NextConfig } from \"next\";\n+\n+const nextConfig = {\n+  experimental: {\n+    mdxRs: true\n+  },\n+\n+  // Other config properties\n+  webpack(config) {\n+    return config;\n+  },\n+\n+  turbopack: {\n+    rules: {\n+      \"*.react.svg\": {\n+        loaders: [\"@svgr/webpack\"],\n+        as: \"*.js\",\n+      },\n+    }\n+  }\n+} satisfies NextConfig;\n+\n+const withMDX = require(\"@next/mdx\")();\n+export default withMDX(nextConfig);"
        },
        {
            "sha": "4ff0c0a40d3cd617abf29ff109d853a27efdf7aa",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/typescript-satisfies.input.ts",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies.input.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,21 @@\n+import type { NextConfig } from \"next\";\n+\n+const nextConfig = {\n+  experimental: {\n+    mdxRs: true,\n+    turbo: {\n+      rules: {\n+        \"*.react.svg\": {\n+          loaders: [\"@svgr/webpack\"],\n+          as: \"*.js\",\n+        },\n+      },\n+    },\n+  },\n+  // Other config properties\n+  webpack(config) {\n+    return config;\n+  },\n+} satisfies NextConfig;\n+\n+export default nextConfig;"
        },
        {
            "sha": "387333024b246a431f18ebc818cd47f3558f0e59",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/typescript-satisfies.output.ts",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript-satisfies.output.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,23 @@\n+import type { NextConfig } from \"next\";\n+\n+const nextConfig = {\n+  experimental: {\n+    mdxRs: true\n+  },\n+\n+  // Other config properties\n+  webpack(config) {\n+    return config;\n+  },\n+\n+  turbopack: {\n+    rules: {\n+      \"*.react.svg\": {\n+        loaders: [\"@svgr/webpack\"],\n+        as: \"*.js\",\n+      },\n+    }\n+  }\n+} satisfies NextConfig;\n+\n+export default nextConfig;"
        },
        {
            "sha": "d46f592bc2e286226da19e4c2421ff82d3aefe4f",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/typescript.input.ts",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript.input.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,23 @@\n+import type { NextConfig } from 'next';\n+\n+const config: NextConfig = {\n+  experimental: {\n+    turbo: {\n+      resolveAlias: {\n+        underscore: 'lodash',\n+        mocha: { browser: 'mocha/browser-entry.js' },\n+      },\n+      memoryLimit: 4096,\n+      minify: true,\n+      treeShaking: false,\n+      sourceMaps: true,\n+    },\n+    // Removed serverActions due to TypeScript compatibility\n+    typedRoutes: true,\n+  },\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+};\n+\n+export default config;"
        },
        {
            "sha": "60c8ef09095e70aaca33d5b7d23cd75c60ecb786",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/typescript.output.ts",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Ftypescript.output.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,26 @@\n+import type { NextConfig } from 'next';\n+\n+const config: NextConfig = {\n+  experimental: {\n+    // Removed serverActions due to TypeScript compatibility\n+    typedRoutes: true,\n+\n+    turbopackMemoryLimit: 4096,\n+    turbopackMinify: true,\n+    turbopackTreeShaking: false,\n+    turbopackSourceMaps: true\n+  },\n+\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+\n+  turbopack: {\n+    resolveAlias: {\n+      underscore: 'lodash',\n+      mocha: { browser: 'mocha/browser-entry.js' },\n+    }\n+  }\n+};\n+\n+export default config;"
        },
        {
            "sha": "02a8b119907cff16e2294bb82361a4641c7163b6",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/wrapped-function.input.js",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fwrapped-function.input.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fwrapped-function.input.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fwrapped-function.input.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,23 @@\n+// Next.js config with wrapper function\n+const nextConfig = {\n+  experimental: {\n+    turbo: {\n+      resolveAlias: {\n+        underscore: 'lodash',\n+        mocha: { browser: 'mocha/browser-entry.js' },\n+      },\n+      memoryLimit: 4096,\n+      minify: true,\n+      treeShaking: false,\n+      sourceMaps: true\n+    },\n+    typedRoutes: true,\n+  },\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+};\n+\n+// Wrapper function\n+const withMDX = require(\"@next/mdx\")();\n+module.exports = withMDX(nextConfig);"
        },
        {
            "sha": "ee55b38d2bfaedc91dc6723f301a34c616dc3d16",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-experimental-turbo-to-turbopack/wrapped-function.output.js",
            "status": "added",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fwrapped-function.output.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fwrapped-function.output.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-experimental-turbo-to-turbopack%2Fwrapped-function.output.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,25 @@\n+// Next.js config with wrapper function\n+const nextConfig = {\n+  experimental: {\n+    typedRoutes: true,\n+    turbopackMemoryLimit: 4096,\n+    turbopackMinify: true,\n+    turbopackTreeShaking: false,\n+    turbopackSourceMaps: true\n+  },\n+\n+  images: {\n+    formats: ['image/avif', 'image/webp'],\n+  },\n+\n+  turbopack: {\n+    resolveAlias: {\n+      underscore: 'lodash',\n+      mocha: { browser: 'mocha/browser-entry.js' },\n+    }\n+  }\n+};\n+\n+// Wrapper function\n+const withMDX = require(\"@next/mdx\")();\n+module.exports = withMDX(nextConfig);"
        },
        {
            "sha": "2ad7196db82c46c3a8f8b0371101db866549665f",
            "filename": "packages/next-codemod/transforms/__tests__/next-experimental-turbo-to-turbopack.test.js",
            "status": "added",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__tests__%2Fnext-experimental-turbo-to-turbopack.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2F__tests__%2Fnext-experimental-turbo-to-turbopack.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__tests__%2Fnext-experimental-turbo-to-turbopack.test.js?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,17 @@\n+/* global jest */\n+jest.autoMockOff()\n+const defineTest = require('jscodeshift/dist/testUtils').defineTest\n+\n+const fixtureDir = 'next-experimental-turbo-to-turbopack'\n+\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/commonjs-var`, { parser: 'js' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/esm`, { parser: 'js' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/mixed-config`, { parser: 'js' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/modified-var`, { parser: 'js' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/wrapped-function`, { parser: 'js' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/no-change`, { parser: 'js' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/property-assignment`, { parser: 'js' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/typescript-as-const`, { parser: 'ts' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/typescript`, { parser: 'ts' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/typescript-satisfies`, { parser: 'ts' })\n+defineTest(__dirname, fixtureDir, null, `${fixtureDir}/typescript-satisfies-wrapped`, { parser: 'ts' })"
        },
        {
            "sha": "79d8b11c5ea859919456c8519f7a20429c274798",
            "filename": "packages/next-codemod/transforms/lib/utils.ts",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2Flib%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2Flib%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2Flib%2Futils.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,12 @@\n+import type { FileInfo } from 'jscodeshift'\n+import path from 'node:path'\n+\n+export function isNextConfigFile(file: FileInfo): boolean {\n+  const parsed = path.parse(file.path || '/')\n+  return (\n+    parsed.base === 'next.config.js' ||\n+    parsed.base === 'next.config.ts' ||\n+    parsed.base === 'next.config.mjs' ||\n+    parsed.base === 'next.config.cjs'\n+  )\n+}"
        },
        {
            "sha": "8469f28dbc1d116dd18e442ab891e9b8eaa111fd",
            "filename": "packages/next-codemod/transforms/next-experimental-turbo-to-turbopack.ts",
            "status": "added",
            "additions": 314,
            "deletions": 0,
            "changes": 314,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2Fnext-experimental-turbo-to-turbopack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2Fnext-experimental-turbo-to-turbopack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2Fnext-experimental-turbo-to-turbopack.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -0,0 +1,314 @@\n+/*\n+ * This codemod transforms the experimental turbo configuration in Next.js config to\n+ * the new top-level `turbopack` configuration.\n+ *\n+ * It moves most properties from experimental.turbo to the top-level turbopack\n+ * property, with special handling for certain properties like memoryLimit, minify,\n+ * treeShaking, and sourceMaps which become experimental.turbopack* properties instead.\n+ */\n+\n+import type {\n+  API as JSCodeShiftAPI,\n+  Options as JSCodeShiftOptions,\n+  FileInfo,\n+  ObjectExpression,\n+  Property,\n+  ObjectProperty,\n+  SpreadElement,\n+  SpreadProperty,\n+  ObjectMethod,\n+} from 'jscodeshift'\n+import { createParserFromPath } from '../lib/parser'\n+import { isNextConfigFile } from './lib/utils'\n+\n+// Properties that need to be moved to experimental.turbopack*\n+const RENAMED_EXPERIMENTAL_PROPERTIES = {\n+  memoryLimit: 'turbopackMemoryLimit',\n+  minify: 'turbopackMinify',\n+  treeShaking: 'turbopackTreeShaking',\n+  sourceMaps: 'turbopackSourceMaps',\n+}\n+\n+export default function transformer(\n+  file: FileInfo,\n+  _api: JSCodeShiftAPI,\n+  options: JSCodeShiftOptions\n+): string {\n+  const j = createParserFromPath(file.path)\n+  const root = j(file.source)\n+  let hasChanges = false\n+\n+  if (\n+    !isNextConfigFile(file) &&\n+    process.env.NODE_ENV !== 'test' // fixtures have unique basenames in test\n+  ) {\n+    return file.source\n+  }\n+\n+  // Process a config object once we find it\n+  function processConfigObject(configObj: ObjectExpression): boolean {\n+    // Check for `experimental` property in the config\n+    const experimentalProp = configObj.properties.find(\n+      (prop) =>\n+        isStaticProperty(prop) &&\n+        prop.key &&\n+        prop.key.type === 'Identifier' &&\n+        prop.key.name === 'experimental'\n+    )\n+\n+    if (!experimentalProp || !isStaticProperty(experimentalProp)) {\n+      return false\n+    }\n+\n+    const experimentalObj = experimentalProp.value\n+    if (experimentalObj.type !== 'ObjectExpression') {\n+      return false\n+    }\n+\n+    // Check for `experimental.turbo` property in the config\n+    const turboProp = experimentalObj.properties.find(\n+      (prop) =>\n+        isStaticProperty(prop) &&\n+        prop.key &&\n+        prop.key.type === 'Identifier' &&\n+        prop.key.name === 'turbo'\n+    )\n+\n+    if (!turboProp || !isStaticProperty(turboProp)) {\n+      return false\n+    }\n+\n+    const turboObj = turboProp.value\n+    if (turboObj.type !== 'ObjectExpression') {\n+      return false\n+    }\n+\n+    const regularProps = []\n+    const specialProps = []\n+\n+    turboObj.properties.forEach((prop) => {\n+      if (\n+        isStaticProperty(prop) &&\n+        prop.key &&\n+        prop.key.type === 'Identifier' &&\n+        RENAMED_EXPERIMENTAL_PROPERTIES[prop.key.name]\n+      ) {\n+        // Create a new property with the renamed key\n+        specialProps.push(\n+          j.objectProperty(\n+            j.identifier(RENAMED_EXPERIMENTAL_PROPERTIES[prop.key.name]),\n+            prop.value\n+          )\n+        )\n+      } else {\n+        // Keep the property for turbopack\n+        regularProps.push(prop)\n+      }\n+    })\n+\n+    const existingProps = experimentalObj.properties.filter(\n+      (prop) =>\n+        !(\n+          isStaticProperty(prop) &&\n+          prop.key &&\n+          prop.key.type === 'Identifier' &&\n+          prop.key.name === 'turbo'\n+        )\n+    )\n+\n+    experimentalObj.properties = [...existingProps, ...specialProps]\n+\n+    // If experimental has no properties, remove it\n+    if (experimentalObj.properties.length === 0) {\n+      configObj.properties = configObj.properties.filter(\n+        (prop) =>\n+          !(\n+            isStaticProperty(prop) &&\n+            prop.key &&\n+            prop.key.type === 'Identifier' &&\n+            prop.key.name === 'experimental'\n+          )\n+      )\n+    }\n+\n+    // Add turbopack property at top level if there are regular props\n+    if (regularProps.length > 0) {\n+      // Create the turbopack property\n+      const turbopackProp = j.objectProperty(\n+        j.identifier('turbopack'),\n+        j.objectExpression(regularProps)\n+      )\n+\n+      configObj.properties.push(turbopackProp)\n+    }\n+\n+    return true\n+  }\n+\n+  root.find(j.ObjectExpression).forEach((path) => {\n+    if (processConfigObject(path.value)) {\n+      hasChanges = true\n+    }\n+  })\n+\n+  // Transform config.experimental.turbo.X = value to config.turbopack.X = value\n+  // or config.experimental.turbopackX = value for special properties\n+  root\n+    .find(j.AssignmentExpression, {\n+      left: {\n+        type: 'MemberExpression',\n+        object: {\n+          type: 'MemberExpression',\n+          object: {\n+            type: 'MemberExpression',\n+            property: { type: 'Identifier', name: 'experimental' },\n+          },\n+          property: { type: 'Identifier', name: 'turbo' },\n+        },\n+      },\n+    })\n+    .forEach((path) => {\n+      if (path.node.left.type !== 'MemberExpression') return\n+\n+      // Get the variable name (e.g., config in config.experimental.turbo.sourceMaps)\n+      let varName = null\n+      let currentPath = path.node.left.object\n+      while (currentPath?.type === 'MemberExpression') {\n+        currentPath = currentPath.object\n+      }\n+      if (currentPath?.type === 'Identifier') {\n+        varName = currentPath.name\n+      }\n+\n+      if (!varName) return\n+\n+      // Get the property name being assigned (e.g., sourceMaps)\n+      let propName: string | undefined = undefined\n+      if (\n+        path.node.left.property &&\n+        path.node.left.property.type === 'Identifier'\n+      ) {\n+        propName = path.node.left.property.name\n+      } else {\n+        return\n+      }\n+\n+      // For special properties like memoryLimit, minify, etc.\n+      if (propName && RENAMED_EXPERIMENTAL_PROPERTIES[propName]) {\n+        const newAssignment = j.assignmentExpression(\n+          '=',\n+          j.memberExpression(\n+            j.memberExpression(\n+              j.identifier(varName),\n+              j.identifier('experimental')\n+            ),\n+            j.identifier(RENAMED_EXPERIMENTAL_PROPERTIES[propName])\n+          ),\n+          path.node.right\n+        )\n+\n+        j(path).replaceWith(newAssignment)\n+        hasChanges = true\n+      } else if (propName) {\n+        // Create new assignment: config.turbopack.propName = value\n+        const newAssignment = j.assignmentExpression(\n+          '=',\n+          j.memberExpression(\n+            j.memberExpression(\n+              j.identifier(varName),\n+              j.identifier('turbopack')\n+            ),\n+            j.identifier(propName)\n+          ),\n+          path.node.right\n+        )\n+\n+        j(path).replaceWith(newAssignment)\n+        hasChanges = true\n+      }\n+    })\n+\n+  // For nested property assignments like config.experimental.turbo.resolveAlias.foo = 'bar';\n+  root.find(j.AssignmentExpression).forEach((path) => {\n+    if (path.node.left.type !== 'MemberExpression') return\n+\n+    // Build a path to check if this is like `experimental.turbo.resolveAlias.foo`\n+    let obj = path.node.left.object\n+    let props = []\n+\n+    // Collect the property chain\n+    while (obj && obj.type === 'MemberExpression') {\n+      if (obj.property && obj.property.type === 'Identifier') {\n+        props.unshift(obj.property.name)\n+      }\n+      obj = obj.object\n+    }\n+\n+    // Get the root variable name (e.g., 'config')\n+    let varName = null\n+    if (obj && obj.type === 'Identifier') {\n+      varName = obj.name\n+    }\n+\n+    if (!varName) return\n+\n+    // Check if this matches the pattern: config.experimental.turbo.resolveAlias.foo\n+    if (\n+      props.length >= 3 &&\n+      props[0] === 'experimental' &&\n+      props[1] === 'turbo'\n+    ) {\n+      // Get the final property name, only if it's an Identifier\n+      let finalProp: string | undefined = undefined\n+      if (\n+        path.node.left.property &&\n+        path.node.left.property.type === 'Identifier'\n+      ) {\n+        finalProp = path.node.left.property.name\n+      } else {\n+        // If not an Identifier, skip this assignment\n+        return\n+      }\n+\n+      // The properties after 'turbo'\n+      const middleProps = props.slice(2) // e.g. ['resolveAlias']\n+\n+      // Start building the new left side: config.turbopack\n+      let newLeft = j.memberExpression(\n+        j.identifier(varName),\n+        j.identifier('turbopack')\n+      )\n+\n+      // Add the middle properties\n+      for (const prop of middleProps) {\n+        newLeft = j.memberExpression(newLeft, j.identifier(prop))\n+      }\n+\n+      // Add the final property\n+      newLeft = j.memberExpression(newLeft, j.identifier(finalProp))\n+\n+      const newAssignment = j.assignmentExpression(\n+        '=',\n+        newLeft,\n+        path.node.right\n+      )\n+\n+      j(path).replaceWith(newAssignment)\n+      hasChanges = true\n+    }\n+  })\n+\n+  // Only return a string if we changed the AST, otherwise return the original source\n+  return hasChanges ? root.toSource(options) : file.source\n+}\n+\n+function isStaticProperty(\n+  prop:\n+    | Property\n+    | ObjectProperty\n+    | SpreadElement\n+    | SpreadProperty\n+    | ObjectMethod\n+): prop is Property | ObjectProperty {\n+  return prop.type === 'Property' || prop.type === 'ObjectProperty'\n+}"
        },
        {
            "sha": "a0d63a63a99140a5630889fa53ef3c38e6034a07",
            "filename": "packages/next-codemod/transforms/next-image-experimental.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 8,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2Fnext-image-experimental.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext-codemod%2Ftransforms%2Fnext-image-experimental.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2Fnext-image-experimental.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -10,6 +10,7 @@ import type {\n   Options,\n } from 'jscodeshift'\n import { createParserFromPath } from '../lib/parser'\n+import { isNextConfigFile } from './lib/utils'\n \n function findAndReplaceProps(\n   j: JSCodeshift,\n@@ -262,16 +263,12 @@ export default function transformer(\n   const j = createParserFromPath(file.path)\n   const root = j(file.source)\n \n-  const parsed = parse(file.path || '/')\n-  const isConfig =\n-    parsed.base === 'next.config.js' ||\n-    parsed.base === 'next.config.ts' ||\n-    parsed.base === 'next.config.mjs' ||\n-    parsed.base === 'next.config.cjs'\n+  const isConfig = isNextConfigFile(file)\n \n   if (isConfig) {\n-    const result = nextConfigTransformer(j, root, parsed.dir)\n-    return result.toSource()\n+    const fileDir = parse(file.path).dir\n+    const result = nextConfigTransformer(j, root, fileDir)\n+    return result.toSource(options)\n   }\n \n   // Before: import Image from \"next/legacy/image\""
        },
        {
            "sha": "79d68a78e1fe04e7ff18283dc9521496d11d9767",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/be8275c86c776eb8f098e242f33b5f61ee8c662e/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=be8275c86c776eb8f098e242f33b5f61ee8c662e",
            "patch": "@@ -1480,7 +1480,7 @@ export default async function loadConfig(\n \n     if (userConfig.experimental?.turbo) {\n       curLog.warn(\n-        'The config property `experimental.turbo` is deprecated. Move this setting to `config.turbopack` as Turbopack is now stable.'\n+        'The config property `experimental.turbo` is deprecated. Move this setting to `config.turbopack` or run `npx @next/codemod@latest next-experimental-turbo-to-turbopack .`'\n       )\n \n       // Merge the two configs, preferring values in `config.turbopack`."
        }
    ],
    "stats": {
        "total": 826,
        "additions": 816,
        "deletions": 10
    }
}