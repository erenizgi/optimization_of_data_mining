{
    "author": "icyJoseph",
    "message": "[cna] For pnpm ignore postinstall from `sharp` and `unrs-resolver` (#83168)\n\nFixes: https://github.com/vercel/next.js/issues/83158\n\nThere's still two other postinstall that are ignored if you use tw and\neslint's next config (?):\n\n```\n╭ Warning ───────────────────────────────────────────────────────────────────────────────────╮\n│                                                                                            │\n│   Ignored build scripts: @tailwindcss/oxide, unrs-resolver.                                │\n│   Run \"pnpm approve-builds\" to pick which dependencies should be allowed to run scripts.   │\n│                                                                                            │\n╰────────────────────────────────────────────────────────────────────────────────────────────╯\n```\n\n---------\n\nCo-authored-by: Sebastian Sebbie Silbermann <sebastian.silbermann@vercel.com>",
    "sha": "41c1f8700de71dd40f3a2395845906fe0354ac9b",
    "files": [
        {
            "sha": "2080efeab826768cfce5552f098516895abb0512",
            "filename": "packages/create-next-app/templates/index.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/41c1f8700de71dd40f3a2395845906fe0354ac9b/packages%2Fcreate-next-app%2Ftemplates%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/41c1f8700de71dd40f3a2395845906fe0354ac9b/packages%2Fcreate-next-app%2Ftemplates%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Findex.ts?ref=41c1f8700de71dd40f3a2395845906fe0354ac9b",
            "patch": "@@ -319,6 +319,27 @@ export const installTemplate = async ({\n     packageJson.devDependencies = sorted(packageJson.devDependencies);\n   }\n \n+  if (packageManager === \"pnpm\") {\n+    const pnpmWorkspaceYaml = [\n+      // required for v9, v10 doesn't need it anymore\n+      \"packages:\",\n+      \"  - .\",\n+      // v10 setting without counterpart in v9\n+      \"ignoredBuiltDependencies:\",\n+      // Sharp has prebuilt binaries for the platforms next-swc has binaries.\n+      // If it needs to build binaries from source, next-swc wouldn't work either.\n+      // See https://sharp.pixelplumbing.com/install/#:~:text=When%20using%20pnpm%2C%20add%20sharp%20to%20ignoredBuiltDependencies%20to%20silence%20warnings\n+      \"  - sharp\",\n+      // Not needed for pnpm: https://github.com/unrs/unrs-resolver/issues/193#issuecomment-3295510146\n+      \"  - unrs-resolver\",\n+      \"\",\n+    ].join(os.EOL);\n+    await fs.writeFile(\n+      path.join(root, \"pnpm-workspace.yaml\"),\n+      pnpmWorkspaceYaml,\n+    );\n+  }\n+\n   await fs.writeFile(\n     path.join(root, \"package.json\"),\n     JSON.stringify(packageJson, null, 2) + os.EOL,"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 21,
        "deletions": 0
    }
}