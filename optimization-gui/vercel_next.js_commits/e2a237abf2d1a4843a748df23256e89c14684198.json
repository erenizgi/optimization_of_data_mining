{
    "author": "acdlite",
    "message": "Turn on clientSegmentCache during PPR CI runs (#80581)\n\nThis sets the `clientSegmentCache` flag to `true` during PPR CI runs, so\nwe can test the entire test suite with the feature enabled.\n\nThere are a few tests that are coupled to the old implementation details\nthat I'll need to either rewrite or (temporarily) disable.",
    "sha": "e2a237abf2d1a4843a748df23256e89c14684198",
    "files": [
        {
            "sha": "48c434baf8e7da6cfde780b79003dbe008818e51",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/e2a237abf2d1a4843a748df23256e89c14684198/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e2a237abf2d1a4843a748df23256e89c14684198/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=e2a237abf2d1a4843a748df23256e89c14684198",
            "patch": "@@ -1323,7 +1323,19 @@ export const defaultConfig = {\n     serverSourceMaps: false,\n     linkNoTouchStart: false,\n     caseSensitiveRoutes: false,\n-    clientSegmentCache: false,\n+    clientSegmentCache:\n+      // TODO: Remove once we've made clientSegmentCache the default. We're\n+      // piggybacking on the PPR test flag, instead of introducing a separate\n+      // CI run.\n+      //\n+      // If we're testing, and the `__NEXT_EXPERIMENTAL_PPR` environment\n+      // variable has been set to `true`, enable the experimental\n+      // clientSegmentCache feature so long as it wasn't explicitly disabled in\n+      // the config.\n+      !!(\n+        process.env.__NEXT_TEST_MODE &&\n+        process.env.__NEXT_EXPERIMENTAL_PPR === 'true'\n+      ),\n     dynamicOnHover: false,\n     appDocumentPreloading: undefined,\n     preloadEntriesOnStart: true,"
        },
        {
            "sha": "32d34ee70e6089e11a5a03cedcd56e124afa2ee0",
            "filename": "test/ppr-tests-manifest.json",
            "status": "modified",
            "additions": 62,
            "deletions": 0,
            "changes": 62,
            "blob_url": "https://github.com/vercel/next.js/blob/e2a237abf2d1a4843a748df23256e89c14684198/test%2Fppr-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/e2a237abf2d1a4843a748df23256e89c14684198/test%2Fppr-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fppr-tests-manifest.json?ref=e2a237abf2d1a4843a748df23256e89c14684198",
            "patch": "@@ -72,6 +72,68 @@\n         \"unexpected-error should set response status to 500 for unexpected errors in ssr app route\",\n         \"unexpected-error should set response status to 500 for unexpected errors in isr app route\"\n       ]\n+    },\n+    \"test/e2e/next-form/default/app-dir.test.ts\": {\n+      \"failed\": [\n+        \"next-form - app dir should soft-navigate on submit and show the prefetched loading state\"\n+      ]\n+    },\n+    \"test/e2e/app-dir/parallel-routes-revalidation/parallel-routes-revalidation.test.ts\": {\n+      \"failed\": [\n+        \"parallel-routes-revalidation router.refresh (dynamic) - searchParams: false should correctly refresh data for previously intercepted modal and active page slot\",\n+        \"parallel-routes-revalidation router.refresh (dynamic) - searchParams: false should correctly refresh data for the intercepted route and previously active page slot\",\n+        \"parallel-routes-revalidation router.refresh (dynamic) - searchParams: true should correctly refresh data for previously intercepted modal and active page slot\",\n+        \"parallel-routes-revalidation router.refresh (dynamic) - searchParams: true should correctly refresh data for the intercepted route and previously active page slot\",\n+        \"parallel-routes-revalidation router.refresh (regular) - searchParams: false should correctly refresh data for previously intercepted modal and active page slot\",\n+        \"parallel-routes-revalidation router.refresh (regular) - searchParams: false should correctly refresh data for the intercepted route and previously active page slot\",\n+        \"parallel-routes-revalidation router.refresh (regular) - searchParams: true should correctly refresh data for previously intercepted modal and active page slot\",\n+        \"parallel-routes-revalidation router.refresh (regular) - searchParams: true should correctly refresh data for the intercepted route and previously active page slot\",\n+        \"parallel-routes-revalidation server action revalidation should not trigger a refresh for the page that is being redirected to\"\n+      ]\n+    },\n+    \"test/e2e/app-dir/router-autoscroll/router-autoscroll.test.ts\": {\n+      \"failed\": [\n+        \"router autoscrolling on navigation bugs Should apply scroll when loading.js is used\"\n+      ]\n+    },\n+    \"test/e2e/app-dir/actions/app-action-node-middleware.test.ts\": {\n+      \"failed\": [\n+        \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n+        \"app-dir action handling fetch actions should store revalidation data in the prefetch cache\",\n+        \"app-dir action handling should only submit action once when resubmitting an action after navigation\",\n+        \"app-dir action handling should reset the form state when the action redirects to itself\"\n+      ]\n+    },\n+    \"test/e2e/app-dir/searchparams-reuse-loading/searchparams-reuse-loading.test.ts\": {\n+      \"failed\": [\n+        \"searchparams-reuse-loading should re-use loading from \\\"full\\\" prefetch for param-full URL when navigating to param-full route\",\n+        \"searchparams-reuse-loading should re-use loading from \\\"full\\\" prefetch for param-full URL when navigating to param-less route\",\n+        \"searchparams-reuse-loading should re-use loading from \\\"full\\\" prefetch for param-less URL when navigating to param-full route\"\n+      ]\n+    },\n+    \"test/production/app-dir/browser-chunks/browser-chunks.test.ts\": {\n+      \"failed\": [\n+        \"browser-chunks must not bundle any server modules into browser chunks\"\n+      ]\n+    },\n+    \"test/e2e/next-form/default/next-form-prefetch.test.ts\": {\n+      \"failed\": [\n+        \"app dir - form prefetching should not prefetch when prefetch is set to false`\",\n+        \"app dir - form prefetching should prefetch a loading state for the form's target\"\n+      ]\n+    },\n+    \"test/e2e/app-dir/actions/app-action.test.ts\": {\n+      \"failed\": [\n+        \"app-dir action handling fetch actions should store revalidation data in the prefetch cache\",\n+        \"app-dir action handling should only submit action once when resubmitting an action after navigation\",\n+        \"app-dir action handling should reset the form state when the action redirects to itself\"\n+      ]\n+    },\n+    \"test/e2e/app-dir/parallel-routes-and-interception/parallel-routes-and-interception.test.ts\": {\n+      \"failed\": [\n+        \"parallel-routes-and-interception route intercepting should support intercepting local dynamic sibling routes\",\n+        \"parallel-routes-and-interception parallel routes should handle a loading state\"\n+      ]\n     }\n   },\n   \"rules\": {"
        }
    ],
    "stats": {
        "total": 76,
        "additions": 75,
        "deletions": 1
    }
}