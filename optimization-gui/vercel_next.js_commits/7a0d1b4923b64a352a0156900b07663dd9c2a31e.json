{
    "author": "huozhi",
    "message": "[test] fix client navigation error count in react 18 (#76442)",
    "sha": "7a0d1b4923b64a352a0156900b07663dd9c2a31e",
    "files": [
        {
            "sha": "b2269d697a6eec656836b98c96f3ad9913bbef1e",
            "filename": "test/development/pages-dir/client-navigation/index.test.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 8,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/7a0d1b4923b64a352a0156900b07663dd9c2a31e/test%2Fdevelopment%2Fpages-dir%2Fclient-navigation%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7a0d1b4923b64a352a0156900b07663dd9c2a31e/test%2Fdevelopment%2Fpages-dir%2Fclient-navigation%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fpages-dir%2Fclient-navigation%2Findex.test.ts?ref=7a0d1b4923b64a352a0156900b07663dd9c2a31e",
            "patch": "@@ -1,6 +1,12 @@\n /* eslint-env jest */\n \n-import { assertNoRedbox, fetchViaHTTP, waitFor, check } from 'next-test-utils'\n+import {\n+  assertNoRedbox,\n+  fetchViaHTTP,\n+  waitFor,\n+  check,\n+  retry,\n+} from 'next-test-utils'\n import webdriver, { BrowserInterface } from 'next-webdriver'\n import path from 'path'\n import { nextTestSetup } from 'e2e-utils'\n@@ -331,13 +337,11 @@ describe('Client Navigation', () => {\n       const defaultCount = await browser.elementByCss('p').text()\n       expect(defaultCount).toBe('COUNT: 0')\n \n-      const countAfterClicked = await browser\n-        .elementByCss('#self-reload-link')\n-        .click()\n-        .elementByCss('p')\n-        .text()\n+      await browser.elementByCss('#self-reload-link').click()\n \n-      expect(countAfterClicked).toBe('COUNT: 1')\n+      await retry(async () => {\n+        expect(await browser.elementByCss('p').text()).toBe('COUNT: 1')\n+      })\n       await browser.close()\n     })\n \n@@ -1393,7 +1397,7 @@ describe('Client Navigation', () => {\n         })\n         await expect(browser).toDisplayRedbox(`\n          {\n-           \"count\": 1,\n+           \"count\": ${isReact18 ? 3 : 1},\n            \"description\": \"Error: An Expected error occurred\",\n            \"environmentLabel\": null,\n            \"label\": \"Unhandled Runtime Error\","
        }
    ],
    "stats": {
        "total": 20,
        "additions": 12,
        "deletions": 8
    }
}