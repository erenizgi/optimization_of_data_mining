{
    "author": "eps1lon",
    "message": "[test] Robuster extraction off CSS sources in Flight chunks (#80243)",
    "sha": "ecf970a7e01d1cf748f076025da73b2138425357",
    "files": [
        {
            "sha": "eac39704e9168a9814c56f2115da6c34bbf82718",
            "filename": "test/e2e/app-dir/app-css/index.test.ts",
            "status": "modified",
            "additions": 17,
            "deletions": 35,
            "changes": 52,
            "blob_url": "https://github.com/vercel/next.js/blob/ecf970a7e01d1cf748f076025da73b2138425357/test%2Fe2e%2Fapp-dir%2Fapp-css%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ecf970a7e01d1cf748f076025da73b2138425357/test%2Fe2e%2Fapp-dir%2Fapp-css%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-css%2Findex.test.ts?ref=ecf970a7e01d1cf748f076025da73b2138425357",
            "patch": "@@ -1,8 +1,6 @@\n import { nextTestSetup } from 'e2e-utils'\n import { check } from 'next-test-utils'\n \n-const isPPREnabledByDefault = process.env.__NEXT_EXPERIMENTAL_PPR === 'true'\n-\n describe('app dir - css', () => {\n   const { next, isNextDev, skipped } = nextTestSetup({\n     files: __dirname,\n@@ -490,47 +488,31 @@ describe('app dir - css', () => {\n             // Even if it's deduped by Float, it should still only be included once in the payload.\n \n             const matches = initialHtml\n-              .match(/\\/_next\\/static\\/css\\/.+?\\.css/g)\n               // The same css chunk could be split into 2 RSC script\n-              // normalize \"/_next/static/css/app/\\\"])</script><script>self.__next_f.push([1,\\\"not-found.css\"\n+              // e.g.\n+              // \"/_next/static/css/app/\"])</script><script>self.__next_f.push([1,\"not-found.css\"\n+              // \"/_next/stati\"])</script><script>self.__next_f.push([1,\"c/css/app/not-found.css?v=1749205445967\"\n               // to \"/_next/static/css/app/not-found.css\"\n-              .map((href) =>\n-                href.replace('\"])</script><script>self.__next_f.push([1,\"', '')\n-              )\n+              .replaceAll('\"])</script><script>self.__next_f.push([1,\"', '')\n+              .match(/\\/_next\\/static\\/css\\/.+?\\.css/g)\n               .sort()\n \n             // Heavy on testing React implementation details.\n             // Assertions may change often but what needs to be checked on change is if styles are needlessly duplicated in Flight data\n             // There are 3 matches, one for the rendered <link> (HTML), one for Float preload (Flight) and one for the <link> inside Flight payload.\n             // And there is one match for the not found style\n-            if (isPPREnabledByDefault) {\n-              expect(matches).toEqual([\n-                // may be split across chunks when we bump React\n-                '/_next/static/css/app/css/css-duplicate-2/layout.css',\n-                '/_next/static/css/app/css/css-duplicate-2/layout.css',\n-                '/_next/static/css/app/css/css-duplicate-2/layout.css',\n-                '/_next/static/css/app/css/layout.css',\n-                '/_next/static/css/app/css/layout.css',\n-                '/_next/static/css/app/css/layout.css',\n-                '/_next/static/css/app/layout.css',\n-                '/_next/static/css/app/layout.css',\n-                '/_next/static/css/app/layout.css',\n-                '/_next/static/css/app/not-found.css',\n-              ])\n-            } else {\n-              expect(matches).toEqual([\n-                '/_next/static/css/app/css/css-duplicate-2/layout.css',\n-                '/_next/static/css/app/css/css-duplicate-2/layout.css',\n-                '/_next/static/css/app/css/css-duplicate-2/layout.css',\n-                '/_next/static/css/app/css/layout.css',\n-                '/_next/static/css/app/css/layout.css',\n-                '/_next/static/css/app/css/layout.css',\n-                '/_next/static/css/app/layout.css',\n-                '/_next/static/css/app/layout.css',\n-                '/_next/static/css/app/layout.css',\n-                '/_next/static/css/app/not-found.css',\n-              ])\n-            }\n+            expect(matches).toEqual([\n+              '/_next/static/css/app/css/css-duplicate-2/layout.css',\n+              '/_next/static/css/app/css/css-duplicate-2/layout.css',\n+              '/_next/static/css/app/css/css-duplicate-2/layout.css',\n+              '/_next/static/css/app/css/layout.css',\n+              '/_next/static/css/app/css/layout.css',\n+              '/_next/static/css/app/css/layout.css',\n+              '/_next/static/css/app/layout.css',\n+              '/_next/static/css/app/layout.css',\n+              '/_next/static/css/app/layout.css',\n+              '/_next/static/css/app/not-found.css',\n+            ])\n           }\n         })\n "
        }
    ],
    "stats": {
        "total": 52,
        "additions": 17,
        "deletions": 35
    }
}