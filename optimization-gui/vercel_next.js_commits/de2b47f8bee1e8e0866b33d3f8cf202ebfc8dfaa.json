{
    "author": "ztanner",
    "message": "[ci]: set NEXT_TEST_VERSION to release tag for deploy tests (#84840)\n\nWhen deploy tests run on release branches, they end up using \"canary\"\nrather than the version associated with the release. This means that the\ntest files might be misaligned with the underlying versions they are\ntesting.\n\nWe are already doing the work of collecting the next version, we just\nweren't plumbing it into `NEXT_TEST_VERSION`.",
    "sha": "de2b47f8bee1e8e0866b33d3f8cf202ebfc8dfaa",
    "files": [
        {
            "sha": "025037ebae24b8eeeade2f377024448f1e494b73",
            "filename": ".github/workflows/test_e2e_deploy_release.yml",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/de2b47f8bee1e8e0866b33d3f8cf202ebfc8dfaa/.github%2Fworkflows%2Ftest_e2e_deploy_release.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/de2b47f8bee1e8e0866b33d3f8cf202ebfc8dfaa/.github%2Fworkflows%2Ftest_e2e_deploy_release.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Fworkflows%2Ftest_e2e_deploy_release.yml?ref=de2b47f8bee1e8e0866b33d3f8cf202ebfc8dfaa",
            "patch": "@@ -30,7 +30,7 @@ env:\n   TURBO_TOKEN: ${{ secrets.HOSTED_TURBO_TOKEN }}\n   DD_ENV: 'ci'\n \n-run-name: test-e2e-deploy ${{ inputs.nextVersion || 'canary' }}\n+run-name: test-e2e-deploy ${{ inputs.nextVersion || (github.event_name == 'release' && github.event.release.tag_name) || 'canary' }}\n \n jobs:\n   setup:\n@@ -84,7 +84,7 @@ jobs:\n         NEXT_TEST_MODE=deploy \\\n         IS_WEBPACK_TEST=1 \\\n         NEXT_EXTERNAL_TESTS_FILTERS=\"test/deploy-tests-manifest.json\" \\\n-        NEXT_TEST_VERSION=\"${{ github.event.inputs.nextVersion || 'canary' }}\" \\\n+        NEXT_TEST_VERSION=\"${{ github.event.inputs.nextVersion || needs.setup.outputs.next-version || 'canary' }}\" \\\n         VERCEL_CLI_VERSION=\"${{ github.event.inputs.vercelCliVersion || 'vercel@latest' }}\" \\\n         node run-tests.js --timings -g ${{ matrix.group }} -c 2 --type e2e\n       skipNativeBuild: 'yes'"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    }
}