{
    "author": "eps1lon",
    "message": "[test] Deflake prerender suite (#85563)\n\nCo-authored-by: Zack Tanner <1939140+ztanner@users.noreply.github.com>",
    "sha": "1db1762a67771d6b247a46a83396abcac13939e8",
    "files": [
        {
            "sha": "d4be9c3a4c0be0b0cbc6e9f5b02dd1b1e1cc18e5",
            "filename": "test/e2e/prerender.test.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/1db1762a67771d6b247a46a83396abcac13939e8/test%2Fe2e%2Fprerender.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1db1762a67771d6b247a46a83396abcac13939e8/test%2Fe2e%2Fprerender.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fprerender.test.ts?ref=1db1762a67771d6b247a46a83396abcac13939e8",
            "patch": "@@ -371,19 +371,19 @@ describe('Prerender', () => {\n \n   const navigateTest = (isDev = false) => {\n     it('should navigate between pages successfully', async () => {\n-      const toBuild = [\n-        '/',\n-        '/another',\n-        '/something',\n-        '/normal',\n-        '/blog/post-1',\n-        '/blog/post-1/comment-1',\n-        '/catchall/first',\n+      // TODO: Compiling this many pages in parallel hits some race condition\n+      // causing \"SyntaxError: Unexpected non-whitespace character after JSON at position 614\"\n+      // which persists throughout Next.js Server instance lifetime.\n+      // Compiling in batches to avoid that unknown bug.\n+      const toBuildBatches = [\n+        ['/', '/another', '/something', '/normal'],\n+        ['/blog/post-1', '/blog/post-1/comment-1', '/catchall/first'],\n       ]\n \n-      await waitFor(2500)\n-\n-      await Promise.all(toBuild.map((pg) => renderViaHTTP(next.url, pg)))\n+      for (const toBuild of toBuildBatches) {\n+        // eslint-disable-next-line no-loop-func -- we're not accessing `next` after the loop was exited.\n+        await Promise.all(toBuild.map((pg) => renderViaHTTP(next.url, pg)))\n+      }\n \n       const browser = await webdriver(next.url, '/')\n       let text = await browser.elementByCss('p').text()"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 11,
        "deletions": 11
    }
}