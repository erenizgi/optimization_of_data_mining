{
    "author": "lukesandberg",
    "message": "[turbopack] Replace uses of `Value<ContentSourceData>` with just `ContentSourceData` (#80140)\n\nRemove Value<ContentSourceData> instead just use ContentSourceData\n\n### Why?\nThe Value<> type is confusing and error prone, lets destroy it!\n\nAs discussed over slack, turbo_tasks::Value type always implements is_resolved as true and is_transient as false which is incorrect and can enable smuggling transient vcs into turbo tasks.\n\n• https://vercel.slack.com/archives/C03EWR7LGEN/p1743456121241529\n• https://vercel.slack.com/archives/C04NGV98TPS/p1743455453764879",
    "sha": "b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
    "files": [
        {
            "sha": "114145d7fe71bfa24716ce35999dc8a1a5d044ad",
            "filename": "turbopack/crates/turbo-tasks/src/task/task_input.rs",
            "status": "modified",
            "additions": 32,
            "deletions": 2,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask%2Ftask_input.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask%2Ftask_input.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask%2Ftask_input.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,4 +1,7 @@\n-use std::{any::Any, fmt::Debug, future::Future, hash::Hash, sync::Arc, time::Duration};\n+use std::{\n+    any::Any, collections::BTreeMap, fmt::Debug, future::Future, hash::Hash, sync::Arc,\n+    time::Duration,\n+};\n \n use anyhow::Result;\n use either::Either;\n@@ -46,7 +49,8 @@ impl_task_input! {\n     RcStr,\n     TaskId,\n     ValueTypeId,\n-    Duration\n+    Duration,\n+    String\n }\n \n impl<T> TaskInput for Vec<T>\n@@ -280,6 +284,32 @@ where\n     }\n }\n \n+impl<K, V> TaskInput for BTreeMap<K, V>\n+where\n+    K: TaskInput + Ord,\n+    V: TaskInput,\n+{\n+    async fn resolve_input(&self) -> Result<Self> {\n+        let mut new_map = BTreeMap::new();\n+        for (k, v) in self {\n+            new_map.insert(\n+                TaskInput::resolve_input(k).await?,\n+                TaskInput::resolve_input(v).await?,\n+            );\n+        }\n+        Ok(new_map)\n+    }\n+\n+    fn is_resolved(&self) -> bool {\n+        self.iter()\n+            .all(|(k, v)| TaskInput::is_resolved(k) || TaskInput::is_resolved(v))\n+    }\n+\n+    fn is_transient(&self) -> bool {\n+        self.iter()\n+            .any(|(k, v)| TaskInput::is_transient(k) || TaskInput::is_transient(v))\n+    }\n+}\n macro_rules! tuple_impls {\n     ( $( $name:ident )+ ) => {\n         impl<$($name: TaskInput),+> TaskInput for ($($name,)+)"
        },
        {
            "sha": "8bdf3bf0092df494a5039efa56be4f405e4e18f2",
            "filename": "turbopack/crates/turbopack-dev-server/src/introspect/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fintrospect%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fintrospect%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fintrospect%2Fmod.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -104,7 +104,7 @@ impl GetContentSourceContent for IntrospectionSource {\n     async fn get(\n         self: ResolvedVc<Self>,\n         path: RcStr,\n-        _data: turbo_tasks::Value<ContentSourceData>,\n+        _data: ContentSourceData,\n     ) -> Result<Vc<ContentSourceContent>> {\n         // get last segment\n         let path = &path[path.rfind('/').unwrap_or(0) + 1..];"
        },
        {
            "sha": "74f93044e70a886c0d4ff1913fec63e81f5f5f8f",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/asset_graph.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fasset_graph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fasset_graph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fasset_graph.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -4,8 +4,8 @@ use anyhow::Result;\n use rustc_hash::FxHashSet;\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{\n-    Completion, FxIndexMap, FxIndexSet, ResolvedVc, State, TryJoinIterExt, Value, ValueToString,\n-    Vc, fxindexset,\n+    Completion, FxIndexMap, FxIndexSet, ResolvedVc, State, TryJoinIterExt, ValueToString, Vc,\n+    fxindexset,\n };\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::{\n@@ -270,7 +270,7 @@ impl GetContentSourceContent for AssetGraphGetContentSourceContent {\n     async fn get(\n         self: ResolvedVc<Self>,\n         _path: RcStr,\n-        _data: Value<ContentSourceData>,\n+        _data: ContentSourceData,\n     ) -> Result<Vc<ContentSourceContent>> {\n         let this = self.await?;\n         turbo_tasks::emit(ResolvedVc::upcast::<Box<dyn ContentSourceSideEffect>>(self));"
        },
        {
            "sha": "0c4caf9b8251f7f5bd763096476032169e628c75",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/conditional.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fconditional.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fconditional.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fconditional.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,6 +1,6 @@\n use anyhow::Result;\n use turbo_rcstr::{RcStr, rcstr};\n-use turbo_tasks::{Completion, ResolvedVc, State, Value, Vc};\n+use turbo_tasks::{Completion, ResolvedVc, State, Vc};\n use turbopack_core::introspect::{Introspectable, IntrospectableChildren};\n \n use super::{\n@@ -149,7 +149,7 @@ impl GetContentSourceContent for ActivateOnGetContentSource {\n     async fn get(\n         self: ResolvedVc<Self>,\n         path: RcStr,\n-        data: Value<ContentSourceData>,\n+        data: ContentSourceData,\n     ) -> Result<Vc<ContentSourceContent>> {\n         turbo_tasks::emit(ResolvedVc::upcast::<Box<dyn ContentSourceSideEffect>>(self));\n         Ok(self.await?.get_content.get(path, data))"
        },
        {
            "sha": "769c48b650134a18f13ebad09bd69ee0df3228d9",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/headers.rs",
            "status": "modified",
            "additions": 15,
            "deletions": 3,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fheaders.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fheaders.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fheaders.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,18 +1,30 @@\n use std::{collections::BTreeMap, hash::Hash, mem::replace, ops::DerefMut};\n \n use serde::{Deserialize, Serialize};\n-use turbo_tasks::{NonLocalValue, trace::TraceRawVcs};\n+use turbo_tasks::{NonLocalValue, TaskInput, trace::TraceRawVcs};\n \n /// A parsed query string from a http request\n #[derive(\n-    Clone, Debug, PartialEq, Eq, Default, Hash, TraceRawVcs, Serialize, Deserialize, NonLocalValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Default,\n+    Hash,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    TaskInput,\n )]\n #[serde(transparent)]\n pub struct Headers(BTreeMap<String, HeaderValue>);\n \n /// The value of an http header. HTTP headers might contain non-utf-8 bytes. An\n /// header might also occur multiple times.\n-#[derive(Clone, Debug, PartialEq, Eq, Hash, TraceRawVcs, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    Clone, Debug, PartialEq, Eq, Hash, TraceRawVcs, Serialize, Deserialize, NonLocalValue, TaskInput,\n+)]\n #[serde(untagged)]\n pub enum HeaderValue {\n     SingleString(String),"
        },
        {
            "sha": "575025ad0f359e1050fdaf222c86d54b1e1379b9",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/issue_context.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fissue_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fissue_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fissue_context.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,6 +1,6 @@\n use anyhow::Result;\n use turbo_rcstr::{RcStr, rcstr};\n-use turbo_tasks::{ResolvedVc, Value, Vc};\n+use turbo_tasks::{ResolvedVc, Vc};\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::{\n     introspect::{Introspectable, IntrospectableChildren},\n@@ -117,11 +117,7 @@ impl GetContentSourceContent for IssueContextGetContentSourceContent {\n     }\n \n     #[turbo_tasks::function]\n-    async fn get(\n-        &self,\n-        path: RcStr,\n-        data: Value<ContentSourceData>,\n-    ) -> Result<Vc<ContentSourceContent>> {\n+    async fn get(&self, path: RcStr, data: ContentSourceData) -> Result<Vc<ContentSourceContent>> {\n         let source = self.source.await?;\n         Ok(\n             get_content_source_get_operation(self.get_content, path, data)\n@@ -143,7 +139,7 @@ fn get_content_source_vary_operation(\n fn get_content_source_get_operation(\n     get_content: ResolvedVc<Box<dyn GetContentSourceContent>>,\n     path: RcStr,\n-    data: Value<ContentSourceData>,\n+    data: ContentSourceData,\n ) -> Vc<ContentSourceContent> {\n     get_content.get(path, data)\n }"
        },
        {
            "sha": "28b557af3768d4fdd572f24bb86d0e56183dbcb3",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/mod.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 10,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fmod.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -19,7 +19,7 @@ use futures::{TryStreamExt, stream::Stream as StreamTrait};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n-    Completion, NonLocalValue, OperationVc, ResolvedVc, Upcast, Value, ValueDefault, Vc,\n+    Completion, NonLocalValue, OperationVc, ResolvedVc, TaskInput, Upcast, ValueDefault, Vc,\n     trace::TraceRawVcs, util::SharedError,\n };\n use turbo_tasks_bytes::{Bytes, Stream, StreamRead};\n@@ -72,8 +72,7 @@ pub trait GetContentSourceContent {\n     }\n \n     /// Get the content\n-    fn get(self: Vc<Self>, path: RcStr, data: Value<ContentSourceData>)\n-    -> Vc<ContentSourceContent>;\n+    fn get(self: Vc<Self>, path: RcStr, data: ContentSourceData) -> Vc<ContentSourceContent>;\n }\n \n #[turbo_tasks::value(transparent)]\n@@ -109,11 +108,7 @@ pub trait ContentSourceSideEffect {\n #[turbo_tasks::value_impl]\n impl GetContentSourceContent for ContentSourceContent {\n     #[turbo_tasks::function]\n-    fn get(\n-        self: Vc<Self>,\n-        _path: RcStr,\n-        _data: Value<ContentSourceData>,\n-    ) -> Vc<ContentSourceContent> {\n+    fn get(self: Vc<Self>, _path: RcStr, _data: ContentSourceData) -> Vc<ContentSourceContent> {\n         self\n     }\n }\n@@ -181,8 +176,19 @@ impl HeaderList {\n /// Note that you might not receive information that has not been requested via\n /// `ContentSource::vary()`. So make sure to request all information that's\n /// needed.\n-#[turbo_tasks::value(shared, serialization = \"auto_for_input\")]\n-#[derive(Clone, Debug, Hash, Default)]\n+#[derive(\n+    PartialEq,\n+    Eq,\n+    NonLocalValue,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    Clone,\n+    Debug,\n+    Hash,\n+    Default,\n+    TaskInput,\n+)]\n pub struct ContentSourceData {\n     /// HTTP method, if requested.\n     pub method: Option<RcStr>,"
        },
        {
            "sha": "1d243758cd4e5f58ffe11e62b4e9597cb4f6124a",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/query.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 1,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fquery.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fquery.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fquery.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,7 +1,7 @@\n use std::{collections::BTreeMap, hash::Hash, ops::DerefMut};\n \n use serde::{Deserialize, Serialize};\n-use turbo_tasks::{NonLocalValue, trace::TraceRawVcs};\n+use turbo_tasks::{NonLocalValue, TaskInput, trace::TraceRawVcs};\n \n use super::ContentSourceDataFilter;\n \n@@ -12,6 +12,14 @@ use super::ContentSourceDataFilter;\n #[serde(transparent)]\n pub struct Query(BTreeMap<String, QueryValue>);\n \n+// This type contains no VCs so the default implementation works.\n+// Query is also recursive through QueryValue so the derive macro doesnt work\n+impl TaskInput for Query {\n+    fn is_transient(&self) -> bool {\n+        false\n+    }\n+}\n+\n impl Query {\n     pub fn filter_with(&mut self, filter: &ContentSourceDataFilter) {\n         match filter {"
        },
        {
            "sha": "cd0c3e7b12e809c0996fb1606b64e569ae832725",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/resolve.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fresolve.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fresolve.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fresolve.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -9,7 +9,7 @@ use hyper::{\n     header::{HeaderName as HyperHeaderName, HeaderValue as HyperHeaderValue},\n };\n use turbo_rcstr::RcStr;\n-use turbo_tasks::{OperationVc, ResolvedVc, TransientInstance, Value, Vc};\n+use turbo_tasks::{OperationVc, ResolvedVc, TransientInstance, Vc};\n \n use super::{\n     ContentSource, ContentSourceContent, ContentSourceData, ContentSourceDataVary,\n@@ -57,7 +57,7 @@ fn get_content_source_content_vary_operation(\n fn get_content_source_content_get_operation(\n     get_content: ResolvedVc<Box<dyn GetContentSourceContent>>,\n     path: RcStr,\n-    data: Value<ContentSourceData>,\n+    data: ContentSourceData,\n ) -> Vc<ContentSourceContent> {\n     get_content.get(path, data)\n }\n@@ -95,7 +95,7 @@ pub async fn resolve_source_request(\n                 let content_op = get_content_source_content_get_operation(\n                     get_content,\n                     current_asset_path.clone(),\n-                    Value::new(content_data),\n+                    content_data,\n                 );\n                 match &*content_op.read_strongly_consistent().await? {\n                     ContentSourceContent::Rewrite(rewrite) => {"
        },
        {
            "sha": "6e89565d75e183a07f299931b76df4b26199085e",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/router.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 6,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Frouter.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Frouter.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Frouter.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -2,7 +2,7 @@ use std::iter::once;\n \n use anyhow::Result;\n use turbo_rcstr::{RcStr, rcstr};\n-use turbo_tasks::{ResolvedVc, TryJoinIterExt, Value, Vc};\n+use turbo_tasks::{ResolvedVc, TryJoinIterExt, Vc};\n use turbopack_core::introspect::{Introspectable, IntrospectableChildren};\n \n use super::{\n@@ -156,11 +156,7 @@ impl GetContentSourceContent for PrefixedRouterGetContentSourceContent {\n     }\n \n     #[turbo_tasks::function]\n-    async fn get(\n-        &self,\n-        path: RcStr,\n-        data: Value<ContentSourceData>,\n-    ) -> Result<Vc<ContentSourceContent>> {\n+    async fn get(&self, path: RcStr, data: ContentSourceData) -> Result<Vc<ContentSourceContent>> {\n         let prefix = self.mapper.await?.prefix.await?;\n         if let Some(path) = path.strip_prefix(&**prefix) {\n             if path.is_empty() {"
        },
        {
            "sha": "c64ba14c33183a92736c86bba6b43fb6cbbbfbfa",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/static_assets.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fstatic_assets.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fstatic_assets.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fstatic_assets.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,6 +1,6 @@\n use anyhow::Result;\n use turbo_rcstr::{RcStr, rcstr};\n-use turbo_tasks::{ResolvedVc, TryJoinIterExt, Value, Vc};\n+use turbo_tasks::{ResolvedVc, TryJoinIterExt, Vc};\n use turbo_tasks_fs::{DirectoryContent, DirectoryEntry, FileSystemPath};\n use turbopack_core::{\n     asset::Asset,\n@@ -98,7 +98,7 @@ impl StaticAssetsContentSourceItem {\n #[turbo_tasks::value_impl]\n impl GetContentSourceContent for StaticAssetsContentSourceItem {\n     #[turbo_tasks::function]\n-    fn get(&self, _path: RcStr, _data: Value<ContentSourceData>) -> Vc<ContentSourceContent> {\n+    fn get(&self, _path: RcStr, _data: ContentSourceData) -> Vc<ContentSourceContent> {\n         let content = Vc::upcast::<Box<dyn Asset>>(FileSource::new(*self.path)).content();\n         ContentSourceContent::static_content(content.versioned())\n     }"
        },
        {
            "sha": "c42c3bbe235c2565d3072b6200ec8507147724fb",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/wrapping_source.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 6,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fwrapping_source.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fwrapping_source.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fwrapping_source.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,6 +1,6 @@\n use anyhow::Result;\n use turbo_rcstr::RcStr;\n-use turbo_tasks::{OperationVc, ResolvedVc, TryJoinIterExt, Value, Vc};\n+use turbo_tasks::{OperationVc, ResolvedVc, TryJoinIterExt, Vc};\n \n use super::{\n     ContentSourceContent, ContentSourceData, ContentSourceDataVary, GetContentSourceContent,\n@@ -69,11 +69,7 @@ impl GetContentSourceContent for WrappedGetContentSourceContent {\n     }\n \n     #[turbo_tasks::function]\n-    async fn get(\n-        &self,\n-        path: RcStr,\n-        data: Value<ContentSourceData>,\n-    ) -> Result<Vc<ContentSourceContent>> {\n+    async fn get(&self, path: RcStr, data: ContentSourceData) -> Result<Vc<ContentSourceContent>> {\n         let res = self.inner.get(path, data);\n         if let ContentSourceContent::Rewrite(rewrite) = &*res.await? {\n             let rewrite = rewrite.await?;"
        },
        {
            "sha": "dc34bf3b2d76808c01ec4c08a08f47887d7f9046",
            "filename": "turbopack/crates/turbopack-node/src/node_entry.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fnode_entry.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fnode_entry.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fnode_entry.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,5 +1,5 @@\n use anyhow::Result;\n-use turbo_tasks::{ResolvedVc, Value, Vc};\n+use turbo_tasks::{ResolvedVc, Vc};\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::chunk::{ChunkingContext, EvaluatableAsset, EvaluatableAssets};\n use turbopack_dev_server::source::ContentSourceData;\n@@ -20,12 +20,10 @@ pub struct NodeRenderingEntries(Vec<ResolvedVc<NodeRenderingEntry>>);\n /// Trait that allows to get the entry module for rendering something in Node.js\n #[turbo_tasks::value_trait]\n pub trait NodeEntry {\n-    fn entry(self: Vc<Self>, data: Value<ContentSourceData>) -> Vc<NodeRenderingEntry>;\n+    fn entry(self: Vc<Self>, data: ContentSourceData) -> Vc<NodeRenderingEntry>;\n     async fn entries(self: Vc<Self>) -> Result<Vc<NodeRenderingEntries>> {\n         Ok(Vc::cell(vec![\n-            self.entry(Value::new(Default::default()))\n-                .to_resolved()\n-                .await?,\n+            self.entry(Default::default()).to_resolved().await?,\n         ]))\n     }\n }"
        },
        {
            "sha": "4785b5e4f8bb0ffcb1968d6596fe024944156caf",
            "filename": "turbopack/crates/turbopack-node/src/render/node_api_source.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Frender%2Fnode_api_source.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Frender%2Fnode_api_source.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Frender%2Fnode_api_source.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,7 +1,7 @@\n use anyhow::Result;\n use serde_json::Value as JsonValue;\n use turbo_rcstr::{RcStr, rcstr};\n-use turbo_tasks::{FxIndexSet, ResolvedVc, Value, Vc};\n+use turbo_tasks::{FxIndexSet, ResolvedVc, Vc};\n use turbo_tasks_env::ProcessEnv;\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::introspect::{\n@@ -107,11 +107,7 @@ impl GetContentSourceContent for NodeApiContentSource {\n     }\n \n     #[turbo_tasks::function]\n-    async fn get(\n-        &self,\n-        path: RcStr,\n-        data: Value<ContentSourceData>,\n-    ) -> Result<Vc<ContentSourceContent>> {\n+    async fn get(&self, path: RcStr, data: ContentSourceData) -> Result<Vc<ContentSourceContent>> {\n         let Some(params) = &*self.route_match.params(path.clone()).await? else {\n             anyhow::bail!(\"Non matching path provided\")\n         };\n@@ -123,7 +119,7 @@ impl GetContentSourceContent for NodeApiContentSource {\n             raw_query: Some(raw_query),\n             body: Some(body),\n             ..\n-        } = &*data\n+        } = &data\n         else {\n             anyhow::bail!(\"Missing request data\")\n         };"
        },
        {
            "sha": "0bb19bd406c2cc9e2b14c47b6c970d5ad58ce8d3",
            "filename": "turbopack/crates/turbopack-node/src/render/rendered_source.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Frender%2Frendered_source.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b8b85c6739848284ea6d7472b58fd6f1685d4d3f/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Frender%2Frendered_source.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Frender%2Frendered_source.rs?ref=b8b85c6739848284ea6d7472b58fd6f1685d4d3f",
            "patch": "@@ -1,7 +1,7 @@\n use anyhow::Result;\n use serde_json::Value as JsonValue;\n use turbo_rcstr::{RcStr, rcstr};\n-use turbo_tasks::{FxIndexSet, OperationVc, ResolvedVc, Value, Vc};\n+use turbo_tasks::{FxIndexSet, OperationVc, ResolvedVc, Vc};\n use turbo_tasks_env::ProcessEnv;\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::{\n@@ -165,11 +165,7 @@ impl GetContentSourceContent for NodeRenderContentSource {\n     }\n \n     #[turbo_tasks::function]\n-    async fn get(\n-        &self,\n-        path: RcStr,\n-        data: Value<ContentSourceData>,\n-    ) -> Result<Vc<ContentSourceContent>> {\n+    async fn get(&self, path: RcStr, data: ContentSourceData) -> Result<Vc<ContentSourceContent>> {\n         let pathname = self.pathname.await?;\n         let Some(params) = &*self.route_match.params(path.clone()).await? else {\n             anyhow::bail!(\"Non matching path ({}) provided for {}\", path, pathname)\n@@ -181,7 +177,7 @@ impl GetContentSourceContent for NodeRenderContentSource {\n             raw_headers: Some(raw_headers),\n             raw_query: Some(raw_query),\n             ..\n-        } = &*data\n+        } = &data\n         else {\n             anyhow::bail!(\"Missing request data\")\n         };"
        }
    ],
    "stats": {
        "total": 164,
        "additions": 99,
        "deletions": 65
    }
}