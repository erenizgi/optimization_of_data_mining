{
    "author": "kdy1",
    "message": "fix(turbopack): Fix pure span check in advanced tree shaking (#76406)",
    "sha": "0f47638fff8142c9b6b2b837e8106498cb8c0426",
    "files": [
        {
            "sha": "86a25da21e7493322b718b311f228d04d03e6a4c",
            "filename": "turbopack/crates/turbopack-ecmascript/src/tree_shake/graph.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/0f47638fff8142c9b6b2b837e8106498cb8c0426/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fgraph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/0f47638fff8142c9b6b2b837e8106498cb8c0426/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fgraph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fgraph.rs?ref=0f47638fff8142c9b6b2b837e8106498cb8c0426",
            "patch": "@@ -10,7 +10,7 @@ use petgraph::{\n };\n use rustc_hash::{FxHashMap, FxHashSet};\n use swc_core::{\n-    common::{comments::Comments, util::take::Take, Spanned, SyntaxContext, DUMMY_SP},\n+    common::{comments::Comments, util::take::Take, BytePos, Spanned, SyntaxContext, DUMMY_SP},\n     ecma::{\n         ast::{\n             op, ClassDecl, Decl, DefaultDecl, EsReserved, ExportAll, ExportDecl,\n@@ -1222,7 +1222,10 @@ impl DepGraph {\n                         ids.push(id.clone());\n \n                         let has_explicit_pure = match &decl.init {\n-                            Some(e) => comments.has_flag(e.span().lo, \"PURE\"),\n+                            Some(e) => {\n+                                e.span().lo == BytePos::PURE\n+                                    || comments.has_flag(e.span().lo, \"PURE\")\n+                            }\n                             _ => false,\n                         };\n "
        }
    ],
    "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
    }
}