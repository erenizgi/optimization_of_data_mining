{
    "author": "gnoff",
    "message": "Implement the updated prerender API shape (#84254)\n\nThis does not add any validation but it makes the interface for\nprerender match out intended API shape when validation is landed\n\n---------\n\nCo-authored-by: Janka Uryga <lolzatu2@gmail.com>",
    "sha": "4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
    "files": [
        {
            "sha": "7544e1d0342a24803b4749bf0fcd85f920acdd48",
            "filename": "errors/invalid-prefetch-configuration.mdx",
            "status": "added",
            "additions": 31,
            "deletions": 0,
            "changes": 31,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/errors%2Finvalid-prefetch-configuration.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/errors%2Finvalid-prefetch-configuration.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Finvalid-prefetch-configuration.mdx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -0,0 +1,31 @@\n+---\n+title: Invalid Prefetch Configuration\n+---\n+\n+## Why This Message Occurred\n+\n+You provided an invalid configuration for `export const unstable_prefetch` in a Layout or Page file.\n+\n+### Example of Correct Usage\n+\n+#### Static Prefetching\n+\n+```tsx filename=\"app/.../layout.tsx\"\n+export const unstable_prefetch = {\n+  mode: 'static',\n+}\n+```\n+\n+#### Runtime Prefetching\n+\n+```tsx filename=\"app/[slug]/page.tsx\"\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [\n+    {\n+      cookies: [{ name: 'experiment', value: 'A' }],\n+      params: { slug: 'example' },\n+    },\n+  ],\n+}\n+```"
        },
        {
            "sha": "7fb6c661cd17bfa1a7237953ea55df16da1d7444",
            "filename": "packages/next/src/build/segment-config/app/app-segment-config.ts",
            "status": "modified",
            "additions": 103,
            "deletions": 7,
            "changes": 110,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/packages%2Fnext%2Fsrc%2Fbuild%2Fsegment-config%2Fapp%2Fapp-segment-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/packages%2Fnext%2Fsrc%2Fbuild%2Fsegment-config%2Fapp%2Fapp-segment-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fsegment-config%2Fapp%2Fapp-segment-config.ts?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -1,6 +1,91 @@\n import { z } from 'next/dist/compiled/zod'\n import { formatZodError } from '../../../shared/lib/zod'\n \n+const CookieSchema = z\n+  .object({\n+    name: z.string(),\n+    value: z.string(),\n+    httpOnly: z.boolean().optional(),\n+    path: z.string().optional(),\n+  })\n+  .strict()\n+\n+const RuntimeSampleSchema = z\n+  .object({\n+    cookies: z.array(CookieSchema).optional(),\n+    headers: z.array(z.tuple([z.string(), z.string()])).optional(),\n+    params: z.record(z.union([z.string(), z.array(z.string())])).optional(),\n+    searchParams: z\n+      .record(z.union([z.string(), z.array(z.string()), z.undefined()]))\n+      .optional(),\n+  })\n+  .strict()\n+\n+const StaticPrefetchSchema = z\n+  .object({\n+    mode: z.literal('static'),\n+    from: z.array(z.string()).optional(),\n+    expectUnableToVerify: z.boolean().optional(),\n+  })\n+  .strict()\n+\n+const RuntimePrefetchSchema = z\n+  .object({\n+    mode: z.literal('runtime'),\n+    samples: z.array(RuntimeSampleSchema).min(1),\n+    from: z.array(z.string()).optional(),\n+    expectUnableToVerify: z.boolean().optional(),\n+  })\n+  .strict()\n+\n+const PrefetchSchema = z.discriminatedUnion('mode', [\n+  StaticPrefetchSchema,\n+  RuntimePrefetchSchema,\n+])\n+\n+export type Prefetch = StaticPrefetch | RuntimePrefetch\n+export type PrefetchForTypeCheckInternal = __GenericPrefetch | Prefetch\n+// the __GenericPrefetch type is used to avoid type widening issues with\n+// our choice to make exports the medium for programming a Next.js application\n+// With exports the type is controlled by the module and all we can do is assert on it\n+// from a consumer. However with string literals in objects these are by default typed widely\n+// and thus cannot match the discriminated union type. If we figure out a better way we should\n+// delete the __GenericPrefetch member.\n+interface __GenericPrefetch {\n+  mode: string\n+  samples?: Array<WideRuntimeSample>\n+  from?: string[]\n+  expectUnableToVerify?: boolean\n+}\n+interface StaticPrefetch {\n+  mode: 'static'\n+  from?: string[]\n+  expectUnableToVerify?: boolean\n+}\n+interface RuntimePrefetch {\n+  mode: 'runtime'\n+  samples: Array<RuntimeSample>\n+  from?: string[]\n+  expectUnableToVerify?: boolean\n+}\n+type WideRuntimeSample = {\n+  cookies?: RuntimeSample['cookies']\n+  headers?: Array<string[]>\n+  params?: RuntimeSample['params']\n+  searchParams?: RuntimeSample['searchParams']\n+}\n+type RuntimeSample = {\n+  cookies?: Array<{\n+    name: string\n+    value: string\n+    httpOnly?: boolean\n+    path?: string\n+  }>\n+  headers?: Array<[string, string]>\n+  params?: { [key: string]: string | string[] }\n+  searchParams?: { [key: string]: string | string[] | undefined }\n+}\n+\n /**\n  * The schema for configuration for a page.\n  */\n@@ -43,7 +128,7 @@ const AppSegmentConfigSchema = z.object({\n    * How this segment should be prefetched.\n    * (only applicable when `clientSegmentCache` is enabled)\n    */\n-  unstable_prefetch: z.enum(['unstable_static', 'unstable_runtime']).optional(),\n+  unstable_prefetch: PrefetchSchema.optional(),\n \n   /**\n    * The preferred region for the page.\n@@ -80,11 +165,22 @@ export function parseAppSegmentConfig(\n ): AppSegmentConfig {\n   const parsed = AppSegmentConfigSchema.safeParse(data, {\n     errorMap: (issue, ctx) => {\n-      if (issue.path.length === 1 && issue.path[0] === 'revalidate') {\n-        return {\n-          message: `Invalid revalidate value ${JSON.stringify(\n-            ctx.data\n-          )} on \"${route}\", must be a non-negative number or false`,\n+      if (issue.path.length === 1) {\n+        switch (issue.path[0]) {\n+          case 'revalidate': {\n+            return {\n+              message: `Invalid revalidate value ${JSON.stringify(\n+                ctx.data\n+              )} on \"${route}\", must be a non-negative number or false`,\n+            }\n+          }\n+          case 'unstable_prefetch': {\n+            return {\n+              // @TODO replace this link with a link to the docs when they are written\n+              message: `Invalid unstable_prefetch value ${JSON.stringify(ctx.data)} on \"${route}\", must be an object with a mode of \"static\" or \"runtime\". Read more at https://nextjs.org/docs/messages/invalid-prefetch-configuration`,\n+            }\n+          }\n+          default:\n         }\n       }\n \n@@ -137,7 +233,7 @@ export type AppSegmentConfig = {\n    * How this segment should be prefetched.\n    * (only applicable when `clientSegmentCache` is enabled)\n    */\n-  unstable_prefetch?: 'unstable_static' | 'unstable_runtime'\n+  unstable_prefetch?: Prefetch\n \n   /**\n    * The preferred region for the page."
        },
        {
            "sha": "87a386db6961bc85ae6ea5f4207beb8d81a44513",
            "filename": "packages/next/src/build/webpack/plugins/next-types-plugin/index.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fnext-types-plugin%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fnext-types-plugin%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fnext-types-plugin%2Findex.ts?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -52,6 +52,8 @@ ${\n     : `import type { ResolvingMetadata, ResolvingViewport } from 'next/dist/lib/metadata/types/metadata-interface.js'`\n }\n \n+import type { PrefetchForTypeCheckInternal } from 'next/dist/build/segment-config/app/app-segment-config.js'\n+\n type TEntry = typeof import('${relativePath}.js')\n \n type SegmentParams<T extends Object = any> = T extends Record<string, any>\n@@ -67,7 +69,7 @@ checkFields<Diff<{\n   }\n   config?: {}\n   generateStaticParams?: Function\n-  unstable_prefetch?: 'unstable_static' | 'unstable_runtime'\n+  unstable_prefetch?: PrefetchForTypeCheckInternal\n   revalidate?: RevalidateRange<TEntry> | false\n   dynamic?: 'auto' | 'force-dynamic' | 'error' | 'force-static'\n   dynamicParams?: boolean"
        },
        {
            "sha": "dd62dacaf5c5a08f7f06811024905062e12c1610",
            "filename": "packages/next/src/server/app-render/create-component-tree.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -221,7 +221,7 @@ async function createComponentTreeInternal(\n     ? (layoutOrPageMod as AppSegmentConfig).unstable_prefetch\n     : undefined\n   /** Whether this segment should use a runtime prefetch instead of a static prefetch. */\n-  const hasRuntimePrefetch = prefetchConfig === 'unstable_runtime'\n+  const hasRuntimePrefetch = prefetchConfig?.mode === 'runtime'\n \n   const [Forbidden, forbiddenStyles] =\n     authInterrupts && forbidden"
        },
        {
            "sha": "ef9f76aa0a12efe6b16fecbb8f6ee06e07311f86",
            "filename": "packages/next/src/server/typescript/rules/config.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/packages%2Fnext%2Fsrc%2Fserver%2Ftypescript%2Frules%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/packages%2Fnext%2Fsrc%2Fserver%2Ftypescript%2Frules%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Ftypescript%2Frules%2Fconfig.ts?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -159,12 +159,12 @@ const API_DOCS: Record<\n   unstable_prefetch: {\n     description: `Specifies the default prefetching behavior for this segment. This configuration is currently under development and will change.`,\n     link: '(docs coming soon)',\n-    options: {\n-      '\"unstable_static\"':\n-        'Only static and cached parts of the page will be prefetched. (default)',\n-      '\"unstable_runtime\"':\n-        'Parts of the page that use route params, search params, or cookies will also be prefetched.',\n-    } satisfies DocsOptionsObject<FullAppSegmentConfig['unstable_prefetch']>,\n+    type: 'object',\n+    // TODO: ideally, we'd validate the config object somehow, but this is difficult to do\n+    // with the way this plugin is currently structured.\n+    // For now, since we don't provide an `options` here, we won't do any validation in\n+    // `getSemanticDiagnosticsForExportVariableStatement` below, and only provide hover a tooltip + autocomplete.\n+    insertText: 'unstable_prefetch = { mode: \"static\" };',\n   },\n }\n "
        },
        {
            "sha": "6752f9b9b10dce27be62a989b3e63463bf04a031",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-layout-sharing/app/segment-config/runtime-prefetchable/configured-as-runtime/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fapp%2Fsegment-config%2Fruntime-prefetchable%2Fconfigured-as-runtime%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fapp%2Fsegment-config%2Fruntime-prefetchable%2Fconfigured-as-runtime%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fapp%2Fsegment-config%2Fruntime-prefetchable%2Fconfigured-as-runtime%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -1,7 +1,10 @@\n import { cookies } from 'next/headers'\n import { Suspense } from 'react'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n \n export default function Page() {\n   return ("
        },
        {
            "sha": "9d68ccffa6cec72724d8701aa822126dd6d2f74c",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-layout-sharing/app/segment-config/runtime-prefetchable/configured-as-static/page.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fapp%2Fsegment-config%2Fruntime-prefetchable%2Fconfigured-as-static%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fapp%2Fsegment-config%2Fruntime-prefetchable%2Fconfigured-as-static%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fapp%2Fsegment-config%2Fruntime-prefetchable%2Fconfigured-as-static%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -4,8 +4,9 @@ import { Suspense } from 'react'\n \n // Technically, no `export const unstable_prefetch = ...` is needed, because we default to static,\n // this is just to make sure that we excercise the codepaths for it\n-export const unstable_prefetch = 'unstable_static'\n-\n+export const unstable_prefetch = {\n+  mode: 'static',\n+}\n export default function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "3059382d37bde6c418a3588636100f421a7d2441",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-layout-sharing/app/segment-config/runtime-prefetchable/layout.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fapp%2Fsegment-config%2Fruntime-prefetchable%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fapp%2Fsegment-config%2Fruntime-prefetchable%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fapp%2Fsegment-config%2Fruntime-prefetchable%2Flayout.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -2,8 +2,10 @@ import { cookies } from 'next/headers'\n import { Suspense } from 'react'\n import { DebugRenderKind } from '../../shared'\n \n-export const unstable_prefetch = 'unstable_runtime'\n-\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n export default async function Layout({ children }) {\n   return (\n     <main>"
        },
        {
            "sha": "044639c08e6c1bdf803ef14d047695a8ad777dac",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/fully-static/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ffully-static%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ffully-static%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ffully-static%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@\n // but it's useful to exercise this codepath.\n // In the future, this test can be used to check whether we correctly\n // *skip* a runtime prefetch if a page was prerendered as static.\n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "1fc1c0c962a2cd129a2cd3e88e4d766491a661f2",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-page/cookies-only/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fcookies-only%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fcookies-only%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fcookies-only%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -2,7 +2,10 @@ import { cookies } from 'next/headers'\n import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [{ name: 'testCookie', value: 'testValue' }] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "e1f0f59481af7aa9568cd3be6ec2151adee418ee",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-page/cookies/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fcookies%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fcookies%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fcookies%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [{ name: 'testCookie', value: 'testValue' }] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "fc84578c5670d456dc6fcf301f27987f4bc2f30c",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-page/dynamic-params/[id]/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -2,7 +2,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ params: { id: 'test' } }],\n+}\n \n type Params = { id: string }\n "
        },
        {
            "sha": "493fd063d155ef9d6a776e41579c2fbe5e255de6",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-page/headers/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fheaders%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fheaders%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fheaders%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ headers: [['host', 'test-host']] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "4120a51872323a22f5ac08238004a25dc181977b",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-page/search-params/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fsearch-params%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fsearch-params%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-page%2Fsearch-params%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -2,7 +2,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ searchParams: { key: 'value' } }],\n+}\n \n type AnySearchParams = { [key: string]: string | string[] | undefined }\n "
        },
        {
            "sha": "f24e896e1b04ff7810b918ffe60bcf03073a41fb",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-private-cache/cookies-only/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fcookies-only%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fcookies-only%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fcookies-only%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -2,7 +2,10 @@ import { cookies } from 'next/headers'\n import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [{ name: 'testCookie', value: 'testValue' }] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "894d2ac58b50fa16a1dfcae8c6623e9aa7222336",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-private-cache/cookies/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fcookies%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fcookies%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fcookies%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [{ name: 'testCookie', value: 'testValue' }] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "bfc7e51390bb2c7a8f2b0acfc4fb79e5c668b868",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-private-cache/date-now/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fdate-now%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fdate-now%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fdate-now%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -2,7 +2,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "93f27b3201878bab2e75a8ed022bc828e0958682",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-private-cache/dynamic-params/[id]/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -2,7 +2,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ params: { id: 'test' } }],\n+}\n \n type Params = { id: string }\n "
        },
        {
            "sha": "33a22c7f93438b4d446b33b9444786088bbd47ed",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-private-cache/headers/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fheaders%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fheaders%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fheaders%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ headers: [['host', 'test-host']] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "697fdf2b8d90721c3e7670a902e355ac3eb142da",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/in-private-cache/search-params/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fsearch-params%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fsearch-params%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fin-private-cache%2Fsearch-params%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -2,7 +2,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ searchParams: { key: 'value' } }],\n+}\n \n type AnySearchParams = { [key: string]: string | string[] | undefined }\n "
        },
        {
            "sha": "a4bbabe982f139b50fe7ac30b106df71dcbf9bad",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/passed-to-public-cache/cookies-only/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fcookies-only%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fcookies-only%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fcookies-only%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -2,7 +2,10 @@ import { cookies } from 'next/headers'\n import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [{ name: 'testCookie', value: 'testValue' }] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "1d74d8fdaa49beb469b06dba5798c4231eb5bbee",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/passed-to-public-cache/cookies/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fcookies%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fcookies%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fcookies%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [{ name: 'testCookie', value: 'testValue' }] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "2c898be41c0ce07b544d1da80c2c0431ff2d16d1",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/passed-to-public-cache/dynamic-params/[id]/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { cachedDelay, DebugRenderKind } from '../../../../shared'\n import { connection } from 'next/server'\n import { cookies } from 'next/headers'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ params: { id: 'test' } }],\n+}\n \n type Params = { id: string }\n "
        },
        {
            "sha": "95c14f7f3bdb5946e0b134b026993ed180be0fcf",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/passed-to-public-cache/headers/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fheaders%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fheaders%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fheaders%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n import { connection } from 'next/server'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ headers: [['host', 'test-host']] }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "e419f49986288884c8cfdd77223990e05ae72415",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/passed-to-public-cache/search-params/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fsearch-params%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fsearch-params%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpassed-to-public-cache%2Fsearch-params%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { cachedDelay, DebugRenderKind } from '../../../shared'\n import { connection } from 'next/server'\n import { cookies } from 'next/headers'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ searchParams: { key: 'value' } }],\n+}\n \n type AnySearchParams = { [key: string]: string | string[] | undefined }\n "
        },
        {
            "sha": "5d8bdf9733f7ffbf13d9d0c38ef9b7e84f4d2372",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/with-root-param/[lang]/in-page/root-params/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2Fwith-root-param%2F%5Blang%5D%2Fin-page%2Froot-params%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2Fwith-root-param%2F%5Blang%5D%2Fin-page%2Froot-params%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2Fwith-root-param%2F%5Blang%5D%2Fin-page%2Froot-params%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -4,7 +4,10 @@ import { connection } from 'next/server'\n import { lang } from 'next/root-params'\n import { cookies } from 'next/headers'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ params: { lang: 'en' } }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "17aab1cf8bc953e91807d88f2069a1e0f4c79f4e",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/with-root-param/[lang]/in-private-cache/root-params/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2Fwith-root-param%2F%5Blang%5D%2Fin-private-cache%2Froot-params%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2Fwith-root-param%2F%5Blang%5D%2Fin-private-cache%2Froot-params%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2Fwith-root-param%2F%5Blang%5D%2Fin-private-cache%2Froot-params%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../../shared'\n import { connection } from 'next/server'\n import { lang } from 'next/root-params'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ params: { lang: 'en' } }],\n+}\n \n export default async function Page() {\n   return ("
        },
        {
            "sha": "d9572056e41b3644879e165dbab558ecc4e512c5",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/with-root-param/[lang]/passed-to-public-cache/root-params/page.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2Fwith-root-param%2F%5Blang%5D%2Fpassed-to-public-cache%2Froot-params%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4c4a5bc83f690a7248068f05e4d285a4d42e07a0/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2Fwith-root-param%2F%5Blang%5D%2Fpassed-to-public-cache%2Froot-params%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2Fwith-root-param%2F%5Blang%5D%2Fpassed-to-public-cache%2Froot-params%2Fpage.tsx?ref=4c4a5bc83f690a7248068f05e4d285a4d42e07a0",
            "patch": "@@ -3,7 +3,10 @@ import { cachedDelay, DebugRenderKind, uncachedIO } from '../../../../shared'\n import { connection } from 'next/server'\n import { lang } from 'next/root-params'\n \n-export const unstable_prefetch = 'unstable_runtime'\n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ params: { lang: 'en' } }],\n+}\n \n export default async function Page() {\n   return ("
        }
    ],
    "stats": {
        "total": 275,
        "additions": 235,
        "deletions": 40
    }
}