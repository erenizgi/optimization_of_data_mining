{
    "author": "delbaoliveira",
    "message": "Docs IA 2.0: Move examples to middleware.js API reference (#80363)\n\nPart of:\nhttps://linear.app/vercel/issue/DOC-4686/clean-up-routing-section",
    "sha": "bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
    "files": [
        {
            "sha": "b72f755e06295132df6daa5dd0d66c4cc7c95e9c",
            "filename": "docs/01-app/01-getting-started/02-project-structure.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F01-getting-started%2F02-project-structure.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F01-getting-started%2F02-project-structure.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F01-getting-started%2F02-project-structure.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -37,7 +37,7 @@ Top-level files are used to configure your application, manage dependencies, run\n | [`next.config.js`](/docs/app/api-reference/config/next-config-js)            | Configuration file for Next.js          |\n | [`package.json`](/docs/app/getting-started/installation#manual-installation) | Project dependencies and scripts        |\n | [`instrumentation.ts`](/docs/app/guides/instrumentation)                     | OpenTelemetry and Instrumentation file  |\n-| [`middleware.ts`](/docs/app/building-your-application/routing/middleware)    | Next.js request middleware              |\n+| [`middleware.ts`](/docs/app/api-reference/file-conventions/middleware)       | Next.js request middleware              |\n | [`.env`](/docs/app/guides/environment-variables)                             | Environment variables                   |\n | [`.env.local`](/docs/app/guides/environment-variables)                       | Local environment variables             |\n | [`.env.production`](/docs/app/guides/environment-variables)                  | Production environment variables        |"
        },
        {
            "sha": "b9d3babecc7072bc3afc53ee6fca9e4b8ee15152",
            "filename": "docs/01-app/02-guides/authentication.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fauthentication.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fauthentication.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fauthentication.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -1023,7 +1023,7 @@ For both cases, we recommend:\n \n ### Optimistic checks with Middleware (Optional)\n \n-There are some cases where you may want to use [Middleware](/docs/app/building-your-application/routing/middleware) and redirect users based on permissions:\n+There are some cases where you may want to use [Middleware](/docs/app/api-reference/file-conventions/middleware) and redirect users based on permissions:\n \n - To perform optimistic checks. Since Middleware runs on every route, it's a good way to centralize redirect logic and pre-filter unauthorized users.\n - To protect static routes that share data between users (e.g. content behind a paywall)."
        },
        {
            "sha": "5fd9fb28d6e8fac150ea2bf55ba999cf9a1311ed",
            "filename": "docs/01-app/02-guides/content-security-policy.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fcontent-security-policy.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fcontent-security-policy.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fcontent-security-policy.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -31,7 +31,7 @@ Even though CSPs are designed to block malicious scripts, there are legitimate s\n \n ### Adding a nonce with Middleware\n \n-[Middleware](/docs/app/building-your-application/routing/middleware) enables you to add headers and generate nonces before the page renders.\n+[Middleware](/docs/app/api-reference/file-conventions/middleware) enables you to add headers and generate nonces before the page renders.\n \n Every time a page is viewed, a fresh nonce should be generated. This means that you **must use dynamic rendering to add nonces**.\n \n@@ -124,7 +124,7 @@ export function middleware(request) {\n }\n ```\n \n-By default, Middleware runs on all requests. You can filter Middleware to run on specific paths using a [`matcher`](/docs/app/building-your-application/routing/middleware#matcher).\n+By default, Middleware runs on all requests. You can filter Middleware to run on specific paths using a [`matcher`](/docs/app/api-reference/file-conventions/middleware#matcher).\n \n We recommend ignoring matching prefetches (from `next/link`) and static assets that don't need the CSP header.\n "
        },
        {
            "sha": "a0f73fcc8cedbdc5fb7d9938e87de29eaf323924",
            "filename": "docs/01-app/02-guides/internationalization.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Finternationalization.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Finternationalization.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Finternationalization.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -30,7 +30,7 @@ let defaultLocale = 'en-US'\n match(languages, locales, defaultLocale) // -> 'en-US'\n ```\n \n-Routing can be internationalized by either the sub-path (`/fr/products`) or domain (`my-site.fr/products`). With this information, you can now redirect the user based on the locale inside [Middleware](/docs/app/building-your-application/routing/middleware).\n+Routing can be internationalized by either the sub-path (`/fr/products`) or domain (`my-site.fr/products`). With this information, you can now redirect the user based on the locale inside [Middleware](/docs/app/api-reference/file-conventions/middleware).\n \n ```js filename=\"middleware.js\"\n import { NextResponse } from \"next/server\";"
        },
        {
            "sha": "5dea3e9b14a4c85069c1e9f2c7e7a1d7f56ddb62",
            "filename": "docs/01-app/02-guides/migrating/from-create-react-app.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-create-react-app.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-create-react-app.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-create-react-app.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -39,7 +39,7 @@ Depending on your needs, Next.js allows you to choose your data fetching strateg\n \n ### Middleware\n \n-[Next.js Middleware](/docs/app/building-your-application/routing/middleware) allows you to run code on the server before a request is completed. For instance, you can avoid a flash of unauthenticated content by redirecting a user to a login page in the middleware for authenticated-only pages. You can also use it for features like A/B testing, experimentation, and [internationalization](/docs/app/guides/internationalization).\n+[Next.js Middleware](/docs/app/api-reference/file-conventions/middleware) allows you to run code on the server before a request is completed. For instance, you can avoid a flash of unauthenticated content by redirecting a user to a login page in the middleware for authenticated-only pages. You can also use it for features like A/B testing, experimentation, and [internationalization](/docs/app/guides/internationalization).\n \n ### Built-in Optimizations\n "
        },
        {
            "sha": "4580fdf94e388a91754165c3f3c26ea59ac6392d",
            "filename": "docs/01-app/02-guides/migrating/from-vite.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-vite.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-vite.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fmigrating%2Ffrom-vite.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -39,7 +39,7 @@ Depending on your needs, Next.js allows you to choose your data fetching strateg\n \n ### Middleware\n \n-[Next.js Middleware](/docs/app/building-your-application/routing/middleware) allows you to run code on the server before a request is completed. This is especially useful to avoid having a flash of unauthenticated content when the user visits an authenticated-only page by redirecting the user to a login page. The middleware is also useful for experimentation and [internationalization](/docs/app/guides/internationalization).\n+[Next.js Middleware](/docs/app/api-reference/file-conventions/middleware) allows you to run code on the server before a request is completed. This is especially useful to avoid having a flash of unauthenticated content when the user visits an authenticated-only page by redirecting the user to a login page. The middleware is also useful for experimentation and [internationalization](/docs/app/guides/internationalization).\n \n ### Built-in Optimizations\n "
        },
        {
            "sha": "a3c0721f6d983130f7f3ef7a171ca084779bac0d",
            "filename": "docs/01-app/02-guides/redirecting.mdx",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fredirecting.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fredirecting.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fredirecting.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -289,7 +289,7 @@ See the [`redirects` API reference](/docs/app/api-reference/config/next-config-j\n > **Good to know**:\n >\n > - `redirects` can return a 307 (Temporary Redirect) or 308 (Permanent Redirect) status code with the `permanent` option.\n-> - `redirects` may have a limit on platforms. For example, on Vercel, there's a limit of 1,024 redirects. To manage a large number of redirects (1000+), consider creating a custom solution using [Middleware](/docs/app/building-your-application/routing/middleware). See [managing redirects at scale](#managing-redirects-at-scale-advanced) for more.\n+> - `redirects` may have a limit on platforms. For example, on Vercel, there's a limit of 1,024 redirects. To manage a large number of redirects (1000+), consider creating a custom solution using [Middleware](/docs/app/api-reference/file-conventions/middleware). See [managing redirects at scale](#managing-redirects-at-scale-advanced) for more.\n > - `redirects` runs **before** Middleware.\n \n ## `NextResponse.redirect` in Middleware\n@@ -344,7 +344,7 @@ export const config = {\n >\n > - Middleware runs **after** `redirects` in `next.config.js` and **before** rendering.\n \n-See the [Middleware](/docs/app/building-your-application/routing/middleware) documentation for more information.\n+See the [Middleware](/docs/app/api-reference/file-conventions/middleware) documentation for more information.\n \n ## Managing redirects at scale (advanced)\n \n@@ -376,7 +376,7 @@ Consider the following data structure:\n }\n ```\n \n-In [Middleware](/docs/app/building-your-application/routing/middleware), you can read from a database such as Vercel's [Edge Config](https://vercel.com/docs/edge-config/get-started) or [Redis](https://vercel.com/docs/redis), and redirect the user based on the incoming request:\n+In [Middleware](/docs/app/api-reference/file-conventions/middleware), you can read from a database such as Vercel's [Edge Config](https://vercel.com/docs/edge-config/get-started) or [Redis](https://vercel.com/docs/redis), and redirect the user based on the incoming request:\n \n ```ts filename=\"middleware.ts\" switcher\n import { NextResponse, NextRequest } from 'next/server'"
        },
        {
            "sha": "d1795dd526a9e41cda042a6313efb86b7f4955e2",
            "filename": "docs/01-app/02-guides/self-hosting.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fself-hosting.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fself-hosting.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fself-hosting.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -24,7 +24,7 @@ Image Optimization can be used with a [static export](/docs/app/guides/static-ex\n \n ## Middleware\n \n-[Middleware](/docs/app/building-your-application/routing/middleware) works self-hosted with zero configuration when deploying using `next start`. Since it requires access to the incoming request, it is not supported when using a [static export](/docs/app/guides/static-exports).\n+[Middleware](/docs/app/api-reference/file-conventions/middleware) works self-hosted with zero configuration when deploying using `next start`. Since it requires access to the incoming request, it is not supported when using a [static export](/docs/app/guides/static-exports).\n \n Middleware uses the [Edge runtime](/docs/app/api-reference/edge), a subset of all available Node.js APIs to help ensure low latency, since it may run in front of every route or asset in your application. If you do not want this, you can use the [full Node.js runtime](/blog/next-15-2#nodejs-middleware-experimental) to run Middleware.\n "
        },
        {
            "sha": "5e909fe5e267e36ae1416ceacbdaa942ca8f27d7",
            "filename": "docs/01-app/02-guides/static-exports.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fstatic-exports.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F02-guides%2Fstatic-exports.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fstatic-exports.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -284,7 +284,7 @@ Features that require a Node.js server, or dynamic logic that cannot be computed\n - [Rewrites](/docs/app/api-reference/config/next-config-js/rewrites)\n - [Redirects](/docs/app/api-reference/config/next-config-js/redirects)\n - [Headers](/docs/app/api-reference/config/next-config-js/headers)\n-- [Middleware](/docs/app/building-your-application/routing/middleware)\n+- [Middleware](/docs/app/api-reference/file-conventions/middleware)\n - [Incremental Static Regeneration](/docs/app/guides/incremental-static-regeneration)\n - [Image Optimization](/docs/app/api-reference/components/image) with the default `loader`\n - [Draft Mode](/docs/app/guides/draft-mode)\n@@ -306,7 +306,7 @@ export const dynamic = 'error'\n - [Rewrites](/docs/pages/api-reference/config/next-config-js/rewrites)\n - [Redirects](/docs/pages/api-reference/config/next-config-js/redirects)\n - [Headers](/docs/pages/api-reference/config/next-config-js/headers)\n-- [Middleware](/docs/pages/building-your-application/routing/middleware)\n+- [Middleware](/docs/pages/api-reference/file-conventions/middleware)\n - [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration)\n - [Image Optimization](/docs/pages/api-reference/components/image) with the default `loader`\n - [Draft Mode](/docs/pages/guides/draft-mode)"
        },
        {
            "sha": "fdc0984f1ef7c4ed8733cce05208f119d9c61081",
            "filename": "docs/01-app/03-building-your-application/01-routing/14-middleware.mdx",
            "status": "modified",
            "additions": 0,
            "deletions": 603,
            "changes": 603,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F03-building-your-application%2F01-routing%2F14-middleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F03-building-your-application%2F01-routing%2F14-middleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-building-your-application%2F01-routing%2F14-middleware.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -7,8 +7,6 @@ description: Learn how to use Middleware to run code before a request is complet\n \n Middleware allows you to run code before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.\n \n-Middleware runs before cached content and routes are matched. See [Matching Paths](#matching-paths) for more details.\n-\n ## Use Cases\n \n Some common scenarios where Middleware is effective include:\n@@ -58,604 +56,3 @@ export const config = {\n   matcher: '/about/:path*',\n }\n ```\n-\n-## Matching Paths\n-\n-Middleware will be invoked for **every route in your project**. Given this, it's crucial to use matchers to precisely target or exclude specific routes. The following is the execution order:\n-\n-1. `headers` from `next.config.js`\n-2. `redirects` from `next.config.js`\n-3. Middleware (`rewrites`, `redirects`, etc.)\n-4. `beforeFiles` (`rewrites`) from `next.config.js`\n-5. Filesystem routes (`public/`, `_next/static/`, `pages/`, `app/`, etc.)\n-6. `afterFiles` (`rewrites`) from `next.config.js`\n-7. Dynamic Routes (`/blog/[slug]`)\n-8. `fallback` (`rewrites`) from `next.config.js`\n-\n-There are two ways to define which paths Middleware will run on:\n-\n-1. [Custom matcher config](#matcher)\n-2. [Conditional statements](#conditional-statements)\n-\n-### Matcher\n-\n-`matcher` allows you to filter Middleware to run on specific paths.\n-\n-```js filename=\"middleware.js\"\n-export const config = {\n-  matcher: '/about/:path*',\n-}\n-```\n-\n-You can match a single path or multiple paths with an array syntax:\n-\n-```js filename=\"middleware.js\"\n-export const config = {\n-  matcher: ['/about/:path*', '/dashboard/:path*'],\n-}\n-```\n-\n-The `matcher` config allows full regex so matching like negative lookaheads or character matching is supported. An example of a negative lookahead to match all except specific paths can be seen here:\n-\n-```js filename=\"middleware.js\"\n-export const config = {\n-  matcher: [\n-    /*\n-     * Match all request paths except for the ones starting with:\n-     * - api (API routes)\n-     * - _next/static (static files)\n-     * - _next/image (image optimization files)\n-     * - favicon.ico, sitemap.xml, robots.txt (metadata files)\n-     */\n-    '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n-  ],\n-}\n-```\n-\n-You can also bypass Middleware for certain requests by using the `missing` or `has` arrays, or a combination of both:\n-\n-```js filename=\"middleware.js\"\n-export const config = {\n-  matcher: [\n-    /*\n-     * Match all request paths except for the ones starting with:\n-     * - api (API routes)\n-     * - _next/static (static files)\n-     * - _next/image (image optimization files)\n-     * - favicon.ico, sitemap.xml, robots.txt (metadata files)\n-     */\n-    {\n-      source:\n-        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n-      missing: [\n-        { type: 'header', key: 'next-router-prefetch' },\n-        { type: 'header', key: 'purpose', value: 'prefetch' },\n-      ],\n-    },\n-\n-    {\n-      source:\n-        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n-      has: [\n-        { type: 'header', key: 'next-router-prefetch' },\n-        { type: 'header', key: 'purpose', value: 'prefetch' },\n-      ],\n-    },\n-\n-    {\n-      source:\n-        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n-      has: [{ type: 'header', key: 'x-present' }],\n-      missing: [{ type: 'header', key: 'x-missing', value: 'prefetch' }],\n-    },\n-  ],\n-}\n-```\n-\n-> **Good to know**: The `matcher` values need to be constants so they can be statically analyzed at build-time. Dynamic values such as variables will be ignored.\n-\n-Configured matchers:\n-\n-1. MUST start with `/`\n-2. Can include named parameters: `/about/:path` matches `/about/a` and `/about/b` but not `/about/a/c`\n-3. Can have modifiers on named parameters (starting with `:`): `/about/:path*` matches `/about/a/b/c` because `*` is _zero or more_. `?` is _zero or one_ and `+` _one or more_\n-4. Can use regular expression enclosed in parenthesis: `/about/(.*)` is the same as `/about/:path*`\n-\n-Read more details on [path-to-regexp](https://github.com/pillarjs/path-to-regexp#path-to-regexp-1) documentation.\n-\n-> **Good to know**: For backward compatibility, Next.js always considers `/public` as `/public/index`. Therefore, a matcher of `/public/:path` will match.\n-\n-### Conditional Statements\n-\n-```ts filename=\"middleware.ts\" switcher\n-import { NextResponse } from 'next/server'\n-import type { NextRequest } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  if (request.nextUrl.pathname.startsWith('/about')) {\n-    return NextResponse.rewrite(new URL('/about-2', request.url))\n-  }\n-\n-  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n-    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n-  }\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(request) {\n-  if (request.nextUrl.pathname.startsWith('/about')) {\n-    return NextResponse.rewrite(new URL('/about-2', request.url))\n-  }\n-\n-  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n-    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n-  }\n-}\n-```\n-\n-## NextResponse\n-\n-The `NextResponse` API allows you to:\n-\n-- `redirect` the incoming request to a different URL\n-- `rewrite` the response by displaying a given URL\n-- Set request headers for API Routes, `getServerSideProps`, and `rewrite` destinations\n-- Set response cookies\n-- Set response headers\n-\n-<AppOnly>\n-\n-To produce a response from Middleware, you can:\n-\n-1. `rewrite` to a route ([Page](/docs/app/api-reference/file-conventions/page) or [Route Handler](/docs/app/building-your-application/routing/route-handlers)) that produces a response\n-2. return a `NextResponse` directly. See [Producing a Response](#producing-a-response)\n-\n-</AppOnly>\n-\n-<PagesOnly>\n-\n-To produce a response from Middleware, you can:\n-\n-1. `rewrite` to a route ([Page](/docs/pages/building-your-application/routing/pages-and-layouts) or [Edge API Route](/docs/pages/building-your-application/routing/api-routes)) that produces a response\n-2. return a `NextResponse` directly. See [Producing a Response](#producing-a-response)\n-\n-</PagesOnly>\n-\n-## Using Cookies\n-\n-Cookies are regular headers. On a `Request`, they are stored in the `Cookie` header. On a `Response` they are in the `Set-Cookie` header. Next.js provides a convenient way to access and manipulate these cookies through the `cookies` extension on `NextRequest` and `NextResponse`.\n-\n-1. For incoming requests, `cookies` comes with the following methods: `get`, `getAll`, `set`, and `delete` cookies. You can check for the existence of a cookie with `has` or remove all cookies with `clear`.\n-2. For outgoing responses, `cookies` have the following methods `get`, `getAll`, `set`, and `delete`.\n-\n-```ts filename=\"middleware.ts\" switcher\n-import { NextResponse } from 'next/server'\n-import type { NextRequest } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n-  // Getting cookies from the request using the `RequestCookies` API\n-  let cookie = request.cookies.get('nextjs')\n-  console.log(cookie) // => { name: 'nextjs', value: 'fast', Path: '/' }\n-  const allCookies = request.cookies.getAll()\n-  console.log(allCookies) // => [{ name: 'nextjs', value: 'fast' }]\n-\n-  request.cookies.has('nextjs') // => true\n-  request.cookies.delete('nextjs')\n-  request.cookies.has('nextjs') // => false\n-\n-  // Setting cookies on the response using the `ResponseCookies` API\n-  const response = NextResponse.next()\n-  response.cookies.set('vercel', 'fast')\n-  response.cookies.set({\n-    name: 'vercel',\n-    value: 'fast',\n-    path: '/',\n-  })\n-  cookie = response.cookies.get('vercel')\n-  console.log(cookie) // => { name: 'vercel', value: 'fast', Path: '/' }\n-  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/` header.\n-\n-  return response\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(request) {\n-  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n-  // Getting cookies from the request using the `RequestCookies` API\n-  let cookie = request.cookies.get('nextjs')\n-  console.log(cookie) // => { name: 'nextjs', value: 'fast', Path: '/' }\n-  const allCookies = request.cookies.getAll()\n-  console.log(allCookies) // => [{ name: 'nextjs', value: 'fast' }]\n-\n-  request.cookies.has('nextjs') // => true\n-  request.cookies.delete('nextjs')\n-  request.cookies.has('nextjs') // => false\n-\n-  // Setting cookies on the response using the `ResponseCookies` API\n-  const response = NextResponse.next()\n-  response.cookies.set('vercel', 'fast')\n-  response.cookies.set({\n-    name: 'vercel',\n-    value: 'fast',\n-    path: '/',\n-  })\n-  cookie = response.cookies.get('vercel')\n-  console.log(cookie) // => { name: 'vercel', value: 'fast', Path: '/' }\n-  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/test` header.\n-\n-  return response\n-}\n-```\n-\n-## Setting Headers\n-\n-You can set request and response headers using the `NextResponse` API (setting _request_ headers is available since Next.js v13.0.0).\n-\n-```ts filename=\"middleware.ts\" switcher\n-import { NextResponse } from 'next/server'\n-import type { NextRequest } from 'next/server'\n-\n-export function middleware(request: NextRequest) {\n-  // Clone the request headers and set a new header `x-hello-from-middleware1`\n-  const requestHeaders = new Headers(request.headers)\n-  requestHeaders.set('x-hello-from-middleware1', 'hello')\n-\n-  // You can also set request headers in NextResponse.next\n-  const response = NextResponse.next({\n-    request: {\n-      // New request headers\n-      headers: requestHeaders,\n-    },\n-  })\n-\n-  // Set a new response header `x-hello-from-middleware2`\n-  response.headers.set('x-hello-from-middleware2', 'hello')\n-  return response\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-import { NextResponse } from 'next/server'\n-\n-export function middleware(request) {\n-  // Clone the request headers and set a new header `x-hello-from-middleware1`\n-  const requestHeaders = new Headers(request.headers)\n-  requestHeaders.set('x-hello-from-middleware1', 'hello')\n-\n-  // You can also set request headers in NextResponse.next\n-  const response = NextResponse.next({\n-    request: {\n-      // New request headers\n-      headers: requestHeaders,\n-    },\n-  })\n-\n-  // Set a new response header `x-hello-from-middleware2`\n-  response.headers.set('x-hello-from-middleware2', 'hello')\n-  return response\n-}\n-```\n-\n-> **Good to know**: Avoid setting large headers as it might cause [431 Request Header Fields Too Large](https://developer.mozilla.org/docs/Web/HTTP/Status/431) error depending on your backend web server configuration.\n-\n-### CORS\n-\n-You can set CORS headers in Middleware to allow cross-origin requests, including [simple](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests) and [preflighted](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests) requests.\n-\n-```tsx filename=\"middleware.ts\" switcher\n-import { NextRequest, NextResponse } from 'next/server'\n-\n-const allowedOrigins = ['https://acme.com', 'https://my-app.org']\n-\n-const corsOptions = {\n-  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n-  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n-}\n-\n-export function middleware(request: NextRequest) {\n-  // Check the origin from the request\n-  const origin = request.headers.get('origin') ?? ''\n-  const isAllowedOrigin = allowedOrigins.includes(origin)\n-\n-  // Handle preflighted requests\n-  const isPreflight = request.method === 'OPTIONS'\n-\n-  if (isPreflight) {\n-    const preflightHeaders = {\n-      ...(isAllowedOrigin && { 'Access-Control-Allow-Origin': origin }),\n-      ...corsOptions,\n-    }\n-    return NextResponse.json({}, { headers: preflightHeaders })\n-  }\n-\n-  // Handle simple requests\n-  const response = NextResponse.next()\n-\n-  if (isAllowedOrigin) {\n-    response.headers.set('Access-Control-Allow-Origin', origin)\n-  }\n-\n-  Object.entries(corsOptions).forEach(([key, value]) => {\n-    response.headers.set(key, value)\n-  })\n-\n-  return response\n-}\n-\n-export const config = {\n-  matcher: '/api/:path*',\n-}\n-```\n-\n-```jsx filename=\"middleware.js\" switcher\n-import { NextResponse } from 'next/server'\n-\n-const allowedOrigins = ['https://acme.com', 'https://my-app.org']\n-\n-const corsOptions = {\n-  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n-  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n-}\n-\n-export function middleware(request) {\n-  // Check the origin from the request\n-  const origin = request.headers.get('origin') ?? ''\n-  const isAllowedOrigin = allowedOrigins.includes(origin)\n-\n-  // Handle preflighted requests\n-  const isPreflight = request.method === 'OPTIONS'\n-\n-  if (isPreflight) {\n-    const preflightHeaders = {\n-      ...(isAllowedOrigin && { 'Access-Control-Allow-Origin': origin }),\n-      ...corsOptions,\n-    }\n-    return NextResponse.json({}, { headers: preflightHeaders })\n-  }\n-\n-  // Handle simple requests\n-  const response = NextResponse.next()\n-\n-  if (isAllowedOrigin) {\n-    response.headers.set('Access-Control-Allow-Origin', origin)\n-  }\n-\n-  Object.entries(corsOptions).forEach(([key, value]) => {\n-    response.headers.set(key, value)\n-  })\n-\n-  return response\n-}\n-\n-export const config = {\n-  matcher: '/api/:path*',\n-}\n-```\n-\n-<AppOnly>\n-\n-> **Good to know:** You can configure CORS headers for individual routes in [Route Handlers](/docs/app/api-reference/file-conventions/route#cors).\n-\n-</AppOnly>\n-\n-## Producing a Response\n-\n-You can respond from Middleware directly by returning a `Response` or `NextResponse` instance. (This is available since [Next.js v13.1.0](https://nextjs.org/blog/next-13-1#nextjs-advanced-middleware))\n-\n-```ts filename=\"middleware.ts\" switcher\n-import type { NextRequest } from 'next/server'\n-import { isAuthenticated } from '@lib/auth'\n-\n-// Limit the middleware to paths starting with `/api/`\n-export const config = {\n-  matcher: '/api/:function*',\n-}\n-\n-export function middleware(request: NextRequest) {\n-  // Call our authentication function to check the request\n-  if (!isAuthenticated(request)) {\n-    // Respond with JSON indicating an error message\n-    return Response.json(\n-      { success: false, message: 'authentication failed' },\n-      { status: 401 }\n-    )\n-  }\n-}\n-```\n-\n-```js filename=\"middleware.js\" switcher\n-import { isAuthenticated } from '@lib/auth'\n-\n-// Limit the middleware to paths starting with `/api/`\n-export const config = {\n-  matcher: '/api/:function*',\n-}\n-\n-export function middleware(request) {\n-  // Call our authentication function to check the request\n-  if (!isAuthenticated(request)) {\n-    // Respond with JSON indicating an error message\n-    return Response.json(\n-      { success: false, message: 'authentication failed' },\n-      { status: 401 }\n-    )\n-  }\n-}\n-```\n-\n-### `waitUntil` and `NextFetchEvent`\n-\n-The `NextFetchEvent` object extends the native [`FetchEvent`](https://developer.mozilla.org/docs/Web/API/FetchEvent) object, and includes the [`waitUntil()`](https://developer.mozilla.org/docs/Web/API/ExtendableEvent/waitUntil) method.\n-\n-The `waitUntil()` method takes a promise as an argument, and extends the lifetime of the Middleware until the promise settles. This is useful for performing work in the background.\n-\n-```ts filename=\"middleware.ts\"\n-import { NextResponse } from 'next/server'\n-import type { NextFetchEvent, NextRequest } from 'next/server'\n-\n-export function middleware(req: NextRequest, event: NextFetchEvent) {\n-  event.waitUntil(\n-    fetch('https://my-analytics-platform.com', {\n-      method: 'POST',\n-      body: JSON.stringify({ pathname: req.nextUrl.pathname }),\n-    })\n-  )\n-\n-  return NextResponse.next()\n-}\n-```\n-\n-## Advanced Middleware Flags\n-\n-In `v13.1` of Next.js two additional flags were introduced for middleware, `skipMiddlewareUrlNormalize` and `skipTrailingSlashRedirect` to handle advanced use cases.\n-\n-`skipTrailingSlashRedirect` disables Next.js redirects for adding or removing trailing slashes. This allows custom handling inside middleware to maintain the trailing slash for some paths but not others, which can make incremental migrations easier.\n-\n-```js filename=\"next.config.js\"\n-module.exports = {\n-  skipTrailingSlashRedirect: true,\n-}\n-```\n-\n-```js filename=\"middleware.js\"\n-const legacyPrefixes = ['/docs', '/blog']\n-\n-export default async function middleware(req) {\n-  const { pathname } = req.nextUrl\n-\n-  if (legacyPrefixes.some((prefix) => pathname.startsWith(prefix))) {\n-    return NextResponse.next()\n-  }\n-\n-  // apply trailing slash handling\n-  if (\n-    !pathname.endsWith('/') &&\n-    !pathname.match(/((?!\\.well-known(?:\\/.*)?)(?:[^/]+\\/)*[^/]+\\.\\w+)/)\n-  ) {\n-    return NextResponse.redirect(\n-      new URL(`${req.nextUrl.pathname}/`, req.nextUrl)\n-    )\n-  }\n-}\n-```\n-\n-`skipMiddlewareUrlNormalize` allows for disabling the URL normalization in Next.js to make handling direct visits and client-transitions the same. In some advanced cases, this option provides full control by using the original URL.\n-\n-```js filename=\"next.config.js\"\n-module.exports = {\n-  skipMiddlewareUrlNormalize: true,\n-}\n-```\n-\n-```js filename=\"middleware.js\"\n-export default async function middleware(req) {\n-  const { pathname } = req.nextUrl\n-\n-  // GET /_next/data/build-id/hello.json\n-\n-  console.log(pathname)\n-  // with the flag this now /_next/data/build-id/hello.json\n-  // without the flag this would be normalized to /hello\n-}\n-```\n-\n-## Unit Testing (experimental)\n-\n-Starting in Next.js 15.1, the `next/experimental/testing/server` package contains utilities to help unit test middleware files. Unit testing middleware can help ensure that it's only run on desired paths and that custom routing logic works as intended before code reaches production.\n-\n-The `unstable_doesMiddlewareMatch` function can be used to assert whether middleware will run for the provided URL, headers, and cookies.\n-\n-```js\n-import { unstable_doesMiddlewareMatch } from 'next/experimental/testing/server'\n-\n-expect(\n-  unstable_doesMiddlewareMatch({\n-    config,\n-    nextConfig,\n-    url: '/test',\n-  })\n-).toEqual(false)\n-```\n-\n-The entire middleware function can also be tested.\n-\n-```js\n-import { isRewrite, getRewrittenUrl } from 'next/experimental/testing/server'\n-\n-const request = new NextRequest('https://nextjs.org/docs')\n-const response = await middleware(request)\n-expect(isRewrite(response)).toEqual(true)\n-expect(getRewrittenUrl(response)).toEqual('https://other-domain.com/docs')\n-// getRedirectUrl could also be used if the response were a redirect\n-```\n-\n-## Runtime\n-\n-Middleware defaults to using the Edge runtime. As of v15.2 (canary), we have experimental support for using the Node.js runtime. To enable, add the flag to your `next.config` file:\n-\n-```ts filename=\"next.config.ts\" switcher\n-import type { NextConfig } from 'next'\n-\n-const nextConfig: NextConfig = {\n-  experimental: {\n-    nodeMiddleware: true,\n-  },\n-}\n-\n-export default nextConfig\n-```\n-\n-```js filename=\"next.config.js\" switcher\n-const nextConfig = {\n-  experimental: {\n-    nodeMiddleware: true,\n-  },\n-}\n-\n-export default nextConfig\n-```\n-\n-Then in your middleware file, set the runtime to `nodejs` in the `config` object:\n-\n-```js highlight={2} filename=\"middleware.js\" switcher\n-export const config = {\n-  runtime: 'nodejs',\n-}\n-```\n-\n-```ts highlight={2} filename=\"middleware.ts\" switcher\n-export const config = {\n-  runtime: 'nodejs',\n-}\n-```\n-\n-> **Note**: This feature is not yet recommended for production use. Therefore, Next.js will throw an error unless you are using the next@canary release instead of the stable release.\n-\n-## Platform Support\n-\n-| Deployment Option                                                   | Supported         |\n-| ------------------------------------------------------------------- | ----------------- |\n-| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n-| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n-| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n-| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n-\n-Learn how to [configure Middleware](/docs/app/guides/self-hosting#middleware) when self-hosting Next.js.\n-\n-## Version History\n-\n-| Version   | Changes                                                                                       |\n-| --------- | --------------------------------------------------------------------------------------------- |\n-| `v15.2.0` | Middleware can now use the Node.js runtime (experimental)                                     |\n-| `v13.1.0` | Advanced Middleware flags added                                                               |\n-| `v13.0.0` | Middleware can modify request headers, response headers, and send responses                   |\n-| `v12.2.0` | Middleware is stable, please see the [upgrade guide](/docs/messages/middleware-upgrade-guide) |\n-| `v12.0.9` | Enforce absolute URLs in Edge Runtime ([PR](https://github.com/vercel/next.js/pull/33410))    |\n-| `v12.0.0` | Middleware (Beta) added                                                                       |"
        },
        {
            "sha": "206cc8060f734da51bff93c1aa395d8238e574dd",
            "filename": "docs/01-app/05-api-reference/02-components/link.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F02-components%2Flink.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F02-components%2Flink.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F02-components%2Flink.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -1116,7 +1116,7 @@ export default function Home() {\n \n ### Prefetching links in Middleware\n \n-It's common to use [Middleware](/docs/app/building-your-application/routing/middleware) for authentication or other purposes that involve rewriting the user to a different page. In order for the `<Link />` component to properly prefetch links with rewrites via Middleware, you need to tell Next.js both the URL to display and the URL to prefetch. This is required to avoid un-necessary fetches to middleware to know the correct route to prefetch.\n+It's common to use [Middleware](/docs/app/api-reference/file-conventions/middleware) for authentication or other purposes that involve rewriting the user to a different page. In order for the `<Link />` component to properly prefetch links with rewrites via Middleware, you need to tell Next.js both the URL to display and the URL to prefetch. This is required to avoid un-necessary fetches to middleware to know the correct route to prefetch.\n \n For example, if you want to serve a `/dashboard` route that has authenticated and visitor views, you can add the following in your Middleware to redirect the user to the correct page:\n "
        },
        {
            "sha": "398195d7cb8642040ea84426385139d89a139f5e",
            "filename": "docs/01-app/05-api-reference/03-file-conventions/01-metadata/index.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F03-file-conventions%2F01-metadata%2Findex.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F03-file-conventions%2F01-metadata%2Findex.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F03-file-conventions%2F01-metadata%2Findex.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -13,4 +13,4 @@ Once a file is defined, Next.js will automatically serve the file (with hashes i\n > **Good to know**:\n >\n > - Special Route Handlers like [`sitemap.ts`](/docs/app/api-reference/file-conventions/metadata/sitemap), [`opengraph-image.tsx`](/docs/app/api-reference/file-conventions/metadata/opengraph-image), and [`icon.tsx`](/docs/app/api-reference/file-conventions/metadata/app-icons), and other [metadata files](/docs/app/api-reference/file-conventions/metadata) are cached by default.\n-> - If using along with [`middleware.ts`](/docs/app/api-reference/file-conventions/middleware), [configure the matcher](/docs/app/building-your-application/routing/middleware#matcher) to exclude the metadata files.\n+> - If using along with [`middleware.ts`](/docs/app/api-reference/file-conventions/middleware), [configure the matcher](/docs/app/api-reference/file-conventions/middleware#matcher) to exclude the metadata files."
        },
        {
            "sha": "70fa5d85daf93dd87250f03e2294ac6c3212c1e4",
            "filename": "docs/01-app/05-api-reference/03-file-conventions/middleware.mdx",
            "status": "modified",
            "additions": 580,
            "deletions": 8,
            "changes": 588,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F03-file-conventions%2Fmiddleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F03-file-conventions%2Fmiddleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F03-file-conventions%2Fmiddleware.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -4,10 +4,11 @@ description: API reference for the middleware.js file.\n related:\n   title: Learn more about Middleware\n   links:\n-    - app/building-your-application/routing/middleware\n+    - app/api-reference/functions/next-request\n+    - app/api-reference/functions/next-response\n ---\n \n-The `middleware.js|ts` file is used to write [Middleware](/docs/app/building-your-application/routing/middleware) and run code on the server before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.\n+The `middleware.js|ts` file is used to write [Middleware](/docs/app/api-reference/file-conventions/middleware) and run code on the server before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.\n \n Middleware executes before routes are rendered. It's particularly useful for implementing custom server-side logic like authentication, logging, or handling redirects.\n \n@@ -56,16 +57,22 @@ export default function middleware(request) {\n \n Optionally, a config object can be exported alongside the Middleware function. This object includes the [matcher](#matcher) to specify paths where the Middleware applies.\n \n-#### Matcher\n+### Matcher\n \n The `matcher` option allows you to target specific paths for the Middleware to run on. You can specify these paths in several ways:\n \n - For a single path: Directly use a string to define the path, like `'/about'`.\n - For multiple paths: Use an array to list multiple paths, such as `matcher: ['/about', '/contact']`, which applies the Middleware to both `/about` and `/contact`.\n \n-Additionally, `matcher` supports complex path specifications through regular expressions, such as `matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)']`, enabling precise control over which paths to include or exclude.\n+```js filename=\"middleware.js\"\n+export const config = {\n+  matcher: ['/about/:path*', '/dashboard/:path*'],\n+}\n+```\n \n-The `matcher` option also accepts an array of objects with the following keys:\n+Additionally, the `matcher` option supports complex path specifications through regular expressions, such as `matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)']`, enabling precise control over which paths to include or exclude.\n+\n+The `matcher` option accepts an array of objects with the following keys:\n \n - `source`: The path or pattern used to match the request paths. It can be a string for direct path matching or a pattern for more complex matching.\n - `regexp` (optional): A regular expression string that fine-tunes the matching based on the source. It provides additional control over which paths are included or excluded.\n@@ -90,6 +97,20 @@ export const config = {\n }\n ```\n \n+Configured matchers:\n+\n+1. MUST start with `/`\n+2. Can include named parameters: `/about/:path` matches `/about/a` and `/about/b` but not `/about/a/c`\n+3. Can have modifiers on named parameters (starting with `:`): `/about/:path*` matches `/about/a/b/c` because `*` is _zero or more_. `?` is _zero or one_ and `+` _one or more_\n+4. Can use regular expression enclosed in parenthesis: `/about/(.*)` is the same as `/about/:path*`\n+\n+Read more details on [path-to-regexp](https://github.com/pillarjs/path-to-regexp#path-to-regexp-1) documentation.\n+\n+> **Good to know**:\n+>\n+> - The `matcher` values need to be constants so they can be statically analyzed at build-time. Dynamic values such as variables will be ignored.\n+> - For backward compatibility, Next.js always considers `/public` as `/public/index`. Therefore, a matcher of `/public/:path` will match.\n+\n ## Params\n \n ### `request`\n@@ -116,18 +137,569 @@ export function middleware(request) {\n \n ## NextResponse\n \n-Middleware can use the [`NextResponse`](/docs/app/building-your-application/routing/middleware#nextresponse) object which extends the [Web Response API](https://developer.mozilla.org/en-US/docs/Web/API/Response). By returning a `NextResponse` object, you can directly manipulate cookies, set headers, implement redirects, and rewrite paths.\n+The `NextResponse` API allows you to:\n+\n+- `redirect` the incoming request to a different URL\n+- `rewrite` the response by displaying a given URL\n+- Set request headers for API Routes, `getServerSideProps`, and `rewrite` destinations\n+- Set response cookies\n+- Set response headers\n+\n+<AppOnly>\n+\n+To produce a response from Middleware, you can:\n+\n+1. `rewrite` to a route ([Page](/docs/app/api-reference/file-conventions/page) or [Route Handler](/docs/app/building-your-application/routing/route-handlers)) that produces a response\n+2. return a `NextResponse` directly. See [Producing a Response](#producing-a-response)\n \n > **Good to know**: For redirects, you can also use `Response.redirect` instead of `NextResponse.redirect`.\n \n+</AppOnly>\n+\n+<PagesOnly>\n+\n+To produce a response from Middleware, you can:\n+\n+1. `rewrite` to a route ([Page](/docs/pages/building-your-application/routing/pages-and-layouts) or [Edge API Route](/docs/pages/building-your-application/routing/api-routes)) that produces a response\n+2. return a `NextResponse` directly. See [Producing a Response](#producing-a-response)\n+\n+</PagesOnly>\n+\n+## Execution order\n+\n+Middleware will be invoked for **every route in your project**. Given this, it's crucial to use [matchers](#matcher) to precisely target or exclude specific routes. The following is the execution order:\n+\n+1. `headers` from `next.config.js`\n+2. `redirects` from `next.config.js`\n+3. Middleware (`rewrites`, `redirects`, etc.)\n+4. `beforeFiles` (`rewrites`) from `next.config.js`\n+5. Filesystem routes (`public/`, `_next/static/`, `pages/`, `app/`, etc.)\n+6. `afterFiles` (`rewrites`) from `next.config.js`\n+7. Dynamic Routes (`/blog/[slug]`)\n+8. `fallback` (`rewrites`) from `next.config.js`\n+\n ## Runtime\n \n-Middleware uses [Edge runtime](/docs/app/api-reference/edge) by default. If you do not want this, you can use the [full Node.js runtime](/blog/next-15-2#nodejs-middleware-experimental) to run Middleware.\n+Middleware defaults to using the Edge runtime. As of v15.2 (canary), we have experimental support for using the Node.js runtime. To enable, add the flag to your `next.config` file:\n+\n+```ts filename=\"next.config.ts\" switcher\n+import type { NextConfig } from 'next'\n+\n+const nextConfig: NextConfig = {\n+  experimental: {\n+    nodeMiddleware: true,\n+  },\n+}\n+\n+export default nextConfig\n+```\n+\n+```js filename=\"next.config.js\" switcher\n+const nextConfig = {\n+  experimental: {\n+    nodeMiddleware: true,\n+  },\n+}\n+\n+export default nextConfig\n+```\n+\n+Then in your middleware file, set the runtime to `nodejs` in the `config` object:\n+\n+```js highlight={2} filename=\"middleware.js\" switcher\n+export const config = {\n+  runtime: 'nodejs',\n+}\n+```\n+\n+```ts highlight={2} filename=\"middleware.ts\" switcher\n+export const config = {\n+  runtime: 'nodejs',\n+}\n+```\n+\n+> **Note**: This feature is not yet recommended for production use. Therefore, Next.js will throw an error unless you are using the next@canary release instead of the stable release.\n+\n+## Advanced Middleware flags\n+\n+In `v13.1` of Next.js two additional flags were introduced for middleware, `skipMiddlewareUrlNormalize` and `skipTrailingSlashRedirect` to handle advanced use cases.\n+\n+`skipTrailingSlashRedirect` disables Next.js redirects for adding or removing trailing slashes. This allows custom handling inside middleware to maintain the trailing slash for some paths but not others, which can make incremental migrations easier.\n+\n+```js filename=\"next.config.js\"\n+module.exports = {\n+  skipTrailingSlashRedirect: true,\n+}\n+```\n+\n+```js filename=\"middleware.js\"\n+const legacyPrefixes = ['/docs', '/blog']\n+\n+export default async function middleware(req) {\n+  const { pathname } = req.nextUrl\n+\n+  if (legacyPrefixes.some((prefix) => pathname.startsWith(prefix))) {\n+    return NextResponse.next()\n+  }\n+\n+  // apply trailing slash handling\n+  if (\n+    !pathname.endsWith('/') &&\n+    !pathname.match(/((?!\\.well-known(?:\\/.*)?)(?:[^/]+\\/)*[^/]+\\.\\w+)/)\n+  ) {\n+    return NextResponse.redirect(\n+      new URL(`${req.nextUrl.pathname}/`, req.nextUrl)\n+    )\n+  }\n+}\n+```\n+\n+`skipMiddlewareUrlNormalize` allows for disabling the URL normalization in Next.js to make handling direct visits and client-transitions the same. In some advanced cases, this option provides full control by using the original URL.\n+\n+```js filename=\"next.config.js\"\n+module.exports = {\n+  skipMiddlewareUrlNormalize: true,\n+}\n+```\n+\n+```js filename=\"middleware.js\"\n+export default async function middleware(req) {\n+  const { pathname } = req.nextUrl\n+\n+  // GET /_next/data/build-id/hello.json\n+\n+  console.log(pathname)\n+  // with the flag this now /_next/data/build-id/hello.json\n+  // without the flag this would be normalized to /hello\n+}\n+```\n+\n+## Examples\n+\n+### Conditional Statements\n+\n+```ts filename=\"middleware.ts\" switcher\n+import { NextResponse } from 'next/server'\n+import type { NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  if (request.nextUrl.pathname.startsWith('/about')) {\n+    return NextResponse.rewrite(new URL('/about-2', request.url))\n+  }\n+\n+  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n+    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n+  }\n+}\n+```\n+\n+```js filename=\"middleware.js\" switcher\n+import { NextResponse } from 'next/server'\n+\n+export function middleware(request) {\n+  if (request.nextUrl.pathname.startsWith('/about')) {\n+    return NextResponse.rewrite(new URL('/about-2', request.url))\n+  }\n+\n+  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n+    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n+  }\n+}\n+```\n+\n+## Using Cookies\n+\n+Cookies are regular headers. On a `Request`, they are stored in the `Cookie` header. On a `Response` they are in the `Set-Cookie` header. Next.js provides a convenient way to access and manipulate these cookies through the `cookies` extension on `NextRequest` and `NextResponse`.\n+\n+1. For incoming requests, `cookies` comes with the following methods: `get`, `getAll`, `set`, and `delete` cookies. You can check for the existence of a cookie with `has` or remove all cookies with `clear`.\n+2. For outgoing responses, `cookies` have the following methods `get`, `getAll`, `set`, and `delete`.\n+\n+```ts filename=\"middleware.ts\" switcher\n+import { NextResponse } from 'next/server'\n+import type { NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n+  // Getting cookies from the request using the `RequestCookies` API\n+  let cookie = request.cookies.get('nextjs')\n+  console.log(cookie) // => { name: 'nextjs', value: 'fast', Path: '/' }\n+  const allCookies = request.cookies.getAll()\n+  console.log(allCookies) // => [{ name: 'nextjs', value: 'fast' }]\n+\n+  request.cookies.has('nextjs') // => true\n+  request.cookies.delete('nextjs')\n+  request.cookies.has('nextjs') // => false\n+\n+  // Setting cookies on the response using the `ResponseCookies` API\n+  const response = NextResponse.next()\n+  response.cookies.set('vercel', 'fast')\n+  response.cookies.set({\n+    name: 'vercel',\n+    value: 'fast',\n+    path: '/',\n+  })\n+  cookie = response.cookies.get('vercel')\n+  console.log(cookie) // => { name: 'vercel', value: 'fast', Path: '/' }\n+  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/` header.\n+\n+  return response\n+}\n+```\n+\n+```js filename=\"middleware.js\" switcher\n+import { NextResponse } from 'next/server'\n+\n+export function middleware(request) {\n+  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n+  // Getting cookies from the request using the `RequestCookies` API\n+  let cookie = request.cookies.get('nextjs')\n+  console.log(cookie) // => { name: 'nextjs', value: 'fast', Path: '/' }\n+  const allCookies = request.cookies.getAll()\n+  console.log(allCookies) // => [{ name: 'nextjs', value: 'fast' }]\n+\n+  request.cookies.has('nextjs') // => true\n+  request.cookies.delete('nextjs')\n+  request.cookies.has('nextjs') // => false\n+\n+  // Setting cookies on the response using the `ResponseCookies` API\n+  const response = NextResponse.next()\n+  response.cookies.set('vercel', 'fast')\n+  response.cookies.set({\n+    name: 'vercel',\n+    value: 'fast',\n+    path: '/',\n+  })\n+  cookie = response.cookies.get('vercel')\n+  console.log(cookie) // => { name: 'vercel', value: 'fast', Path: '/' }\n+  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/test` header.\n+\n+  return response\n+}\n+```\n+\n+### Setting Headers\n+\n+You can set request and response headers using the `NextResponse` API (setting _request_ headers is available since Next.js v13.0.0).\n+\n+```ts filename=\"middleware.ts\" switcher\n+import { NextResponse } from 'next/server'\n+import type { NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  // Clone the request headers and set a new header `x-hello-from-middleware1`\n+  const requestHeaders = new Headers(request.headers)\n+  requestHeaders.set('x-hello-from-middleware1', 'hello')\n+\n+  // You can also set request headers in NextResponse.next\n+  const response = NextResponse.next({\n+    request: {\n+      // New request headers\n+      headers: requestHeaders,\n+    },\n+  })\n+\n+  // Set a new response header `x-hello-from-middleware2`\n+  response.headers.set('x-hello-from-middleware2', 'hello')\n+  return response\n+}\n+```\n+\n+```js filename=\"middleware.js\" switcher\n+import { NextResponse } from 'next/server'\n+\n+export function middleware(request) {\n+  // Clone the request headers and set a new header `x-hello-from-middleware1`\n+  const requestHeaders = new Headers(request.headers)\n+  requestHeaders.set('x-hello-from-middleware1', 'hello')\n+\n+  // You can also set request headers in NextResponse.next\n+  const response = NextResponse.next({\n+    request: {\n+      // New request headers\n+      headers: requestHeaders,\n+    },\n+  })\n+\n+  // Set a new response header `x-hello-from-middleware2`\n+  response.headers.set('x-hello-from-middleware2', 'hello')\n+  return response\n+}\n+```\n+\n+> **Good to know**: Avoid setting large headers as it might cause [431 Request Header Fields Too Large](https://developer.mozilla.org/docs/Web/HTTP/Status/431) error depending on your backend web server configuration.\n+\n+### CORS\n+\n+You can set CORS headers in Middleware to allow cross-origin requests, including [simple](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests) and [preflighted](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests) requests.\n+\n+```tsx filename=\"middleware.ts\" switcher\n+import { NextRequest, NextResponse } from 'next/server'\n+\n+const allowedOrigins = ['https://acme.com', 'https://my-app.org']\n+\n+const corsOptions = {\n+  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n+  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n+}\n+\n+export function middleware(request: NextRequest) {\n+  // Check the origin from the request\n+  const origin = request.headers.get('origin') ?? ''\n+  const isAllowedOrigin = allowedOrigins.includes(origin)\n+\n+  // Handle preflighted requests\n+  const isPreflight = request.method === 'OPTIONS'\n+\n+  if (isPreflight) {\n+    const preflightHeaders = {\n+      ...(isAllowedOrigin && { 'Access-Control-Allow-Origin': origin }),\n+      ...corsOptions,\n+    }\n+    return NextResponse.json({}, { headers: preflightHeaders })\n+  }\n+\n+  // Handle simple requests\n+  const response = NextResponse.next()\n+\n+  if (isAllowedOrigin) {\n+    response.headers.set('Access-Control-Allow-Origin', origin)\n+  }\n+\n+  Object.entries(corsOptions).forEach(([key, value]) => {\n+    response.headers.set(key, value)\n+  })\n+\n+  return response\n+}\n+\n+export const config = {\n+  matcher: '/api/:path*',\n+}\n+```\n+\n+```jsx filename=\"middleware.js\" switcher\n+import { NextResponse } from 'next/server'\n+\n+const allowedOrigins = ['https://acme.com', 'https://my-app.org']\n+\n+const corsOptions = {\n+  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n+  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n+}\n+\n+export function middleware(request) {\n+  // Check the origin from the request\n+  const origin = request.headers.get('origin') ?? ''\n+  const isAllowedOrigin = allowedOrigins.includes(origin)\n+\n+  // Handle preflighted requests\n+  const isPreflight = request.method === 'OPTIONS'\n+\n+  if (isPreflight) {\n+    const preflightHeaders = {\n+      ...(isAllowedOrigin && { 'Access-Control-Allow-Origin': origin }),\n+      ...corsOptions,\n+    }\n+    return NextResponse.json({}, { headers: preflightHeaders })\n+  }\n+\n+  // Handle simple requests\n+  const response = NextResponse.next()\n+\n+  if (isAllowedOrigin) {\n+    response.headers.set('Access-Control-Allow-Origin', origin)\n+  }\n+\n+  Object.entries(corsOptions).forEach(([key, value]) => {\n+    response.headers.set(key, value)\n+  })\n+\n+  return response\n+}\n+\n+export const config = {\n+  matcher: '/api/:path*',\n+}\n+```\n+\n+<AppOnly>\n+\n+> **Good to know:** You can configure CORS headers for individual routes in [Route Handlers](/docs/app/api-reference/file-conventions/route#cors).\n+\n+</AppOnly>\n+\n+### Producing a response\n+\n+You can respond from Middleware directly by returning a `Response` or `NextResponse` instance. (This is available since [Next.js v13.1.0](https://nextjs.org/blog/next-13-1#nextjs-advanced-middleware))\n+\n+```ts filename=\"middleware.ts\" switcher\n+import type { NextRequest } from 'next/server'\n+import { isAuthenticated } from '@lib/auth'\n+\n+// Limit the middleware to paths starting with `/api/`\n+export const config = {\n+  matcher: '/api/:function*',\n+}\n+\n+export function middleware(request: NextRequest) {\n+  // Call our authentication function to check the request\n+  if (!isAuthenticated(request)) {\n+    // Respond with JSON indicating an error message\n+    return Response.json(\n+      { success: false, message: 'authentication failed' },\n+      { status: 401 }\n+    )\n+  }\n+}\n+```\n+\n+```js filename=\"middleware.js\" switcher\n+import { isAuthenticated } from '@lib/auth'\n+\n+// Limit the middleware to paths starting with `/api/`\n+export const config = {\n+  matcher: '/api/:function*',\n+}\n+\n+export function middleware(request) {\n+  // Call our authentication function to check the request\n+  if (!isAuthenticated(request)) {\n+    // Respond with JSON indicating an error message\n+    return Response.json(\n+      { success: false, message: 'authentication failed' },\n+      { status: 401 }\n+    )\n+  }\n+}\n+```\n+\n+### Negative matching\n+\n+The `matcher` config allows full regex so matching like negative lookaheads or character matching is supported. An example of a negative lookahead to match all except specific paths can be seen here:\n+\n+```js filename=\"middleware.js\"\n+export const config = {\n+  matcher: [\n+    /*\n+     * Match all request paths except for the ones starting with:\n+     * - api (API routes)\n+     * - _next/static (static files)\n+     * - _next/image (image optimization files)\n+     * - favicon.ico, sitemap.xml, robots.txt (metadata files)\n+     */\n+    '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n+  ],\n+}\n+```\n+\n+You can also bypass Middleware for certain requests by using the `missing` or `has` arrays, or a combination of both:\n+\n+```js filename=\"middleware.js\"\n+export const config = {\n+  matcher: [\n+    /*\n+     * Match all request paths except for the ones starting with:\n+     * - api (API routes)\n+     * - _next/static (static files)\n+     * - _next/image (image optimization files)\n+     * - favicon.ico, sitemap.xml, robots.txt (metadata files)\n+     */\n+    {\n+      source:\n+        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n+      missing: [\n+        { type: 'header', key: 'next-router-prefetch' },\n+        { type: 'header', key: 'purpose', value: 'prefetch' },\n+      ],\n+    },\n+\n+    {\n+      source:\n+        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n+      has: [\n+        { type: 'header', key: 'next-router-prefetch' },\n+        { type: 'header', key: 'purpose', value: 'prefetch' },\n+      ],\n+    },\n+\n+    {\n+      source:\n+        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n+      has: [{ type: 'header', key: 'x-present' }],\n+      missing: [{ type: 'header', key: 'x-missing', value: 'prefetch' }],\n+    },\n+  ],\n+}\n+```\n+\n+### `waitUntil` and `NextFetchEvent`\n+\n+The `NextFetchEvent` object extends the native [`FetchEvent`](https://developer.mozilla.org/docs/Web/API/FetchEvent) object, and includes the [`waitUntil()`](https://developer.mozilla.org/docs/Web/API/ExtendableEvent/waitUntil) method.\n+\n+The `waitUntil()` method takes a promise as an argument, and extends the lifetime of the Middleware until the promise settles. This is useful for performing work in the background.\n+\n+```ts filename=\"middleware.ts\"\n+import { NextResponse } from 'next/server'\n+import type { NextFetchEvent, NextRequest } from 'next/server'\n+\n+export function middleware(req: NextRequest, event: NextFetchEvent) {\n+  event.waitUntil(\n+    fetch('https://my-analytics-platform.com', {\n+      method: 'POST',\n+      body: JSON.stringify({ pathname: req.nextUrl.pathname }),\n+    })\n+  )\n+\n+  return NextResponse.next()\n+}\n+```\n+\n+### Unit testing (experimental)\n+\n+Starting in Next.js 15.1, the `next/experimental/testing/server` package contains utilities to help unit test middleware files. Unit testing middleware can help ensure that it's only run on desired paths and that custom routing logic works as intended before code reaches production.\n+\n+The `unstable_doesMiddlewareMatch` function can be used to assert whether middleware will run for the provided URL, headers, and cookies.\n+\n+```js\n+import { unstable_doesMiddlewareMatch } from 'next/experimental/testing/server'\n+\n+expect(\n+  unstable_doesMiddlewareMatch({\n+    config,\n+    nextConfig,\n+    url: '/test',\n+  })\n+).toEqual(false)\n+```\n+\n+The entire middleware function can also be tested.\n+\n+```js\n+import { isRewrite, getRewrittenUrl } from 'next/experimental/testing/server'\n+\n+const request = new NextRequest('https://nextjs.org/docs')\n+const response = await middleware(request)\n+expect(isRewrite(response)).toEqual(true)\n+expect(getRewrittenUrl(response)).toEqual('https://other-domain.com/docs')\n+// getRedirectUrl could also be used if the response were a redirect\n+```\n+\n+## Platform support\n+\n+| Deployment Option                                                   | Supported         |\n+| ------------------------------------------------------------------- | ----------------- |\n+| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n+| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n+| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n+| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n+\n+Learn how to [configure Middleware](/docs/app/guides/self-hosting#middleware) when self-hosting Next.js.\n \n-## Version History\n+## Version history\n \n | Version   | Changes                                                                                       |\n | --------- | --------------------------------------------------------------------------------------------- |\n+| `v15.2.0` | Middleware can now use the Node.js runtime (experimental)                                     |\n | `v13.1.0` | Advanced Middleware flags added                                                               |\n | `v13.0.0` | Middleware can modify request headers, response headers, and send responses                   |\n | `v12.2.0` | Middleware is stable, please see the [upgrade guide](/docs/messages/middleware-upgrade-guide) |"
        },
        {
            "sha": "54728758f84652cb5d6b6bec0ec11049da11fac5",
            "filename": "docs/01-app/05-api-reference/03-file-conventions/route.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F03-file-conventions%2Froute.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F03-file-conventions%2Froute.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F03-file-conventions%2Froute.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -528,7 +528,7 @@ export async function GET(request) {\n \n > **Good to know**:\n >\n-> - To add CORS headers to multiple Route Handlers, you can use [Middleware](/docs/app/building-your-application/routing/middleware#cors) or the [`next.config.js` file](/docs/app/api-reference/config/next-config-js/headers#cors).\n+> - To add CORS headers to multiple Route Handlers, you can use [Middleware](/docs/app/api-reference/file-conventions/middleware#cors) or the [`next.config.js` file](/docs/app/api-reference/config/next-config-js/headers#cors).\n > - Alternatively, see our [CORS example](https://github.com/vercel/examples/blob/main/edge-functions/cors/lib/cors.ts) package.\n \n ### Webhooks"
        },
        {
            "sha": "00deeb09ecb69f1727ff09ff948f464ada7d5464",
            "filename": "docs/01-app/05-api-reference/04-functions/after.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F04-functions%2Fafter.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F04-functions%2Fafter.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F04-functions%2Fafter.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -5,7 +5,7 @@ description: API Reference for the after function.\n \n `after` allows you to schedule work to be executed after a response (or prerender) is finished. This is useful for tasks and other side effects that should not block the response, such as logging and analytics.\n \n-It can be used in [Server Components](/docs/app/getting-started/server-and-client-components) (including [`generateMetadata`](https://nextjs.org/docs/app/api-reference/functions/generate-metadata)), [Server Actions](/docs/app/getting-started/updating-data), [Route Handlers](/docs/app/building-your-application/routing/route-handlers), and [Middleware](/docs/app/building-your-application/routing/middleware).\n+It can be used in [Server Components](/docs/app/getting-started/server-and-client-components) (including [`generateMetadata`](https://nextjs.org/docs/app/api-reference/functions/generate-metadata)), [Server Actions](/docs/app/getting-started/updating-data), [Route Handlers](/docs/app/building-your-application/routing/route-handlers), and [Middleware](/docs/app/api-reference/file-conventions/middleware).\n \n The function accepts a callback that will be executed after the response (or prerender) is finished:\n "
        },
        {
            "sha": "bb7d746fdb6079808df5e42d2f03cb8a94c40b58",
            "filename": "docs/01-app/05-api-reference/04-functions/generate-metadata.mdx",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F04-functions%2Fgenerate-metadata.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F04-functions%2Fgenerate-metadata.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F04-functions%2Fgenerate-metadata.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -1065,17 +1065,17 @@ export const metadata = {\n }\n ```\n \n-| Metadata                      | Recommendation                                                                                                                                                                                                                                            |\n-| ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n-| `<meta http-equiv=\"...\">`     | Use appropriate HTTP Headers via [`redirect()`](/docs/app/api-reference/functions/redirect), [Middleware](/docs/app/building-your-application/routing/middleware#nextresponse), [Security Headers](/docs/app/api-reference/config/next-config-js/headers) |\n-| `<base>`                      | Render the tag in the layout or page itself.                                                                                                                                                                                                              |\n-| `<noscript>`                  | Render the tag in the layout or page itself.                                                                                                                                                                                                              |\n-| `<style>`                     | Learn more about [styling in Next.js](/docs/app/getting-started/css).                                                                                                                                                                                     |\n-| `<script>`                    | Learn more about [using scripts](/docs/app/guides/scripts).                                                                                                                                                                                               |\n-| `<link rel=\"stylesheet\" />`   | `import` stylesheets directly in the layout or page itself.                                                                                                                                                                                               |\n-| `<link rel=\"preload />`       | Use [ReactDOM preload method](#link-relpreload)                                                                                                                                                                                                           |\n-| `<link rel=\"preconnect\" />`   | Use [ReactDOM preconnect method](#link-relpreconnect)                                                                                                                                                                                                     |\n-| `<link rel=\"dns-prefetch\" />` | Use [ReactDOM prefetchDNS method](#link-reldns-prefetch)                                                                                                                                                                                                  |\n+| Metadata                      | Recommendation                                                                                                                                                                                                                                         |\n+| ----------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n+| `<meta http-equiv=\"...\">`     | Use appropriate HTTP Headers via [`redirect()`](/docs/app/api-reference/functions/redirect), [Middleware](/docs/app/api-reference/file-conventions/middleware#nextresponse), [Security Headers](/docs/app/api-reference/config/next-config-js/headers) |\n+| `<base>`                      | Render the tag in the layout or page itself.                                                                                                                                                                                                           |\n+| `<noscript>`                  | Render the tag in the layout or page itself.                                                                                                                                                                                                           |\n+| `<style>`                     | Learn more about [styling in Next.js](/docs/app/getting-started/css).                                                                                                                                                                                  |\n+| `<script>`                    | Learn more about [using scripts](/docs/app/guides/scripts).                                                                                                                                                                                            |\n+| `<link rel=\"stylesheet\" />`   | `import` stylesheets directly in the layout or page itself.                                                                                                                                                                                            |\n+| `<link rel=\"preload />`       | Use [ReactDOM preload method](#link-relpreload)                                                                                                                                                                                                        |\n+| `<link rel=\"preconnect\" />`   | Use [ReactDOM preconnect method](#link-relpreconnect)                                                                                                                                                                                                  |\n+| `<link rel=\"dns-prefetch\" />` | Use [ReactDOM prefetchDNS method](#link-reldns-prefetch)                                                                                                                                                                                               |\n \n ### Resource hints\n "
        },
        {
            "sha": "a4ae628fc785d6d41c71a676f1aeca2b10779a5b",
            "filename": "docs/01-app/05-api-reference/04-functions/use-pathname.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F04-functions%2Fuse-pathname.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F04-functions%2Fuse-pathname.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F04-functions%2Fuse-pathname.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -36,7 +36,7 @@ For example, a Client Component with `usePathname` will be rendered into HTML on\n > - Reading the current URL from a [Server Component](/docs/app/getting-started/server-and-client-components) is not supported. This design is intentional to support layout state being preserved across page navigations.\n > - Compatibility mode:\n >   - `usePathname` can return `null` when a [fallback route](/docs/pages/api-reference/functions/get-static-paths#fallback-true) is being rendered or when a `pages` directory page has been [automatically statically optimized](/docs/pages/building-your-application/rendering/automatic-static-optimization) by Next.js and the router is not ready.\n->   - When using `usePathname` with rewrites in [`next.config`](/docs/app/api-reference/config/next-config-js/rewrites) or [`Middleware`](/docs/app/building-your-application/routing/middleware), `useState` and `useEffect` must also be used in order to avoid hydration mismatch errors.\n+>   - When using `usePathname` with rewrites in [`next.config`](/docs/app/api-reference/config/next-config-js/rewrites) or [`Middleware`](/docs/app/api-reference/file-conventions/middleware), `useState` and `useEffect` must also be used in order to avoid hydration mismatch errors.\n >   - Next.js will automatically update your types if it detects both an `app` and `pages` directory in your project.\n \n ## Parameters"
        },
        {
            "sha": "1ee50ad19971dac80724473b2d8a024eb7dd3329",
            "filename": "docs/01-app/05-api-reference/05-config/01-next-config-js/pageExtensions.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F05-config%2F01-next-config-js%2FpageExtensions.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F05-config%2F01-next-config-js%2FpageExtensions.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F05-config%2F01-next-config-js%2FpageExtensions.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -34,7 +34,7 @@ module.exports = {\n \n Changing these values affects _all_ Next.js pages, including the following:\n \n-- [`middleware.js`](/docs/pages/building-your-application/routing/middleware)\n+- [`middleware.js`](/docs/pages/api-reference/file-conventions/middleware)\n - [`instrumentation.js`](/docs/pages/guides/instrumentation)\n - `pages/_document.js`\n - `pages/_app.js`"
        },
        {
            "sha": "23659c39704ff334fd8e2e00f5299b5848f94fd9",
            "filename": "docs/01-app/05-api-reference/05-config/01-next-config-js/redirects.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F05-config%2F01-next-config-js%2Fredirects.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F01-app%2F05-api-reference%2F05-config%2F01-next-config-js%2Fredirects.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F05-config%2F01-next-config-js%2Fredirects.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -38,7 +38,7 @@ module.exports = {\n \n Redirects are checked before the filesystem which includes pages and `/public` files.\n \n-When using the Pages Router, redirects are not applied to client-side routing (`Link`, `router.push`) unless [Middleware](/docs/app/building-your-application/routing/middleware) is present and matches the path.\n+When using the Pages Router, redirects are not applied to client-side routing (`Link`, `router.push`) unless [Middleware](/docs/app/api-reference/file-conventions/middleware) is present and matches the path.\n \n When a redirect is applied, any query values provided in the request will be passed through to the redirect destination. For example, see the following redirect configuration:\n "
        },
        {
            "sha": "145183f7eba471028e03c42413b3613114421156",
            "filename": "docs/02-pages/02-guides/internationalization.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F02-pages%2F02-guides%2Finternationalization.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F02-pages%2F02-guides%2Finternationalization.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F02-guides%2Finternationalization.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -144,7 +144,7 @@ When using Sub-path Routing, the user would be redirected to `/fr`.\n \n ### Prefixing the Default Locale\n \n-With Next.js 12 and [Middleware](/docs/pages/building-your-application/routing/middleware), we can add a prefix to the default locale with a [workaround](https://github.com/vercel/next.js/discussions/18419).\n+With Next.js 12 and [Middleware](/docs/pages/api-reference/file-conventions/middleware), we can add a prefix to the default locale with a [workaround](https://github.com/vercel/next.js/discussions/18419).\n \n For example, here's a `next.config.js` file with support for a few languages. Note the `\"default\"` locale has been added intentionally.\n \n@@ -159,7 +159,7 @@ module.exports = {\n }\n ```\n \n-Next, we can use [Middleware](/docs/pages/building-your-application/routing/middleware) to add custom routing rules:\n+Next, we can use [Middleware](/docs/pages/api-reference/file-conventions/middleware) to add custom routing rules:\n \n ```ts filename=\"middleware.ts\"\n import { NextRequest, NextResponse } from 'next/server'\n@@ -185,7 +185,7 @@ export async function middleware(req: NextRequest) {\n }\n ```\n \n-This [Middleware](/docs/pages/building-your-application/routing/middleware) skips adding the default prefix to [API Routes](/docs/pages/building-your-application/routing/api-routes) and [public](/docs/pages/api-reference/file-conventions/public-folder) files like fonts or images. If a request is made to the default locale, we redirect to our prefix `/en`.\n+This [Middleware](/docs/pages/api-reference/file-conventions/middleware) skips adding the default prefix to [API Routes](/docs/pages/building-your-application/routing/api-routes) and [public](/docs/pages/api-reference/file-conventions/public-folder) files like fonts or images. If a request is made to the default locale, we redirect to our prefix `/en`.\n \n ### Disabling Automatic Locale Detection\n \n@@ -352,4 +352,4 @@ export async function getStaticProps({ locale }) {\n - `locales`: 100 total locales\n - `domains`: 100 total locale domain items\n \n-> **Good to know**: These limits have been added initially to prevent potential [performance issues at build time](#dynamic-routes-and-getstaticprops-pages). You can workaround these limits with custom routing using [Middleware](/docs/pages/building-your-application/routing/middleware) in Next.js 12.\n+> **Good to know**: These limits have been added initially to prevent potential [performance issues at build time](#dynamic-routes-and-getstaticprops-pages). You can workaround these limits with custom routing using [Middleware](/docs/pages/api-reference/file-conventions/middleware) in Next.js 12."
        },
        {
            "sha": "8fb640be23dc1a432e83e0def0aeb9f60c2f2317",
            "filename": "docs/02-pages/03-building-your-application/03-data-fetching/01-get-static-props.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F02-pages%2F03-building-your-application%2F03-data-fetching%2F01-get-static-props.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F02-pages%2F03-building-your-application%2F03-data-fetching%2F01-get-static-props.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F03-building-your-application%2F03-data-fetching%2F01-get-static-props.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -65,7 +65,7 @@ You should use `getStaticProps` if:\n \n When combined with [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration), `getStaticProps` will run in the background while the stale page is being revalidated, and the fresh page served to the browser.\n \n-`getStaticProps` does not have access to the incoming request (such as query parameters or HTTP headers) as it generates static HTML. If you need access to the request for your page, consider using [Middleware](/docs/pages/building-your-application/routing/middleware) in addition to `getStaticProps`.\n+`getStaticProps` does not have access to the incoming request (such as query parameters or HTTP headers) as it generates static HTML. If you need access to the request for your page, consider using [Middleware](/docs/pages/api-reference/file-conventions/middleware) in addition to `getStaticProps`.\n \n ## Using getStaticProps to fetch data from a CMS\n "
        },
        {
            "sha": "77f664583b3c85d2200dc2c7f5bd2c2c17670c11",
            "filename": "docs/02-pages/04-api-reference/02-file-conventions/middleware.mdx",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F02-pages%2F04-api-reference%2F02-file-conventions%2Fmiddleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/docs%2F02-pages%2F04-api-reference%2F02-file-conventions%2Fmiddleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F04-api-reference%2F02-file-conventions%2Fmiddleware.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -1,7 +1,7 @@\n ---\n title: Middleware\n description: Learn how to use Middleware to run code before a request is completed.\n-source: app/building-your-application/routing/middleware\n+source: app/api-reference/file-conventions/middleware\n ---\n \n {/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}",
            "previous_filename": "docs/02-pages/03-building-your-application/01-routing/11-middleware.mdx"
        },
        {
            "sha": "647ce243248e1f78eb7e9b4c0cc695f21b80d816",
            "filename": "errors/beta-middleware.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/errors%2Fbeta-middleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/errors%2Fbeta-middleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fbeta-middleware.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -5,7 +5,7 @@ description: This document clarifies the \"Beta Middleware Used\" error in Next.js\n \n ## Why This Error Occurred\n \n-The \"Beta Middleware Used\" error occurs if you are using [Middleware](/docs/pages/building-your-application/routing/middleware) in a version of Next.js prior to `v12.2`. The Middleware feature was still in beta in those versions and not yet covered by [semver](https://semver.org/) or Semantic Versioning rules.\n+The \"Beta Middleware Used\" error occurs if you are using [Middleware](/docs/pages/api-reference/file-conventions/middleware) in a version of Next.js prior to `v12.2`. The Middleware feature was still in beta in those versions and not yet covered by [semver](https://semver.org/) or Semantic Versioning rules.\n \n ## Possible Ways to Fix It\n "
        },
        {
            "sha": "a72e9929f0c7af2ab07729812bf303058c14e28c",
            "filename": "errors/no-server-import-in-page.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/errors%2Fno-server-import-in-page.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/errors%2Fno-server-import-in-page.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fno-server-import-in-page.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -22,4 +22,4 @@ export function middleware(req: NextRequest, ev: NextFetchEvent) {\n \n ## Useful Links\n \n-- [Middleware](/docs/pages/building-your-application/routing/middleware)\n+- [Middleware](/docs/pages/api-reference/file-conventions/middleware)"
        },
        {
            "sha": "a2f5e45267eb8c7bacbfbef8ba81aed64abdc370",
            "filename": "errors/node-module-in-edge-runtime.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/errors%2Fnode-module-in-edge-runtime.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/errors%2Fnode-module-in-edge-runtime.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fnode-module-in-edge-runtime.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -4,7 +4,7 @@ title: Using Node.js Modules in Edge Runtime\n \n ## Why This Error Occurred\n \n-The code in your [Middleware](/docs/pages/building-your-application/routing/middleware) or your [Edge API Routes](/docs/pages/building-your-application/routing/api-routes) is using a feature from Node.js runtime.\n+The code in your [Middleware](/docs/pages/api-reference/file-conventions/middleware) or your [Edge API Routes](/docs/pages/building-your-application/routing/api-routes) is using a feature from Node.js runtime.\n \n However, the Edge Runtime does not support [Node.js APIs and globals](/docs/pages/api-reference/edge#unsupported-apis).\n \n@@ -17,5 +17,5 @@ For example, you might replace the Node.js `crypto` module with the [Web Crypto\n ## Useful Links\n \n - [Edge Runtime Supported APIs](/docs/pages/api-reference/edge)\n-- [Next.js Middleware](/docs/pages/building-your-application/routing/middleware)\n+- [Next.js Middleware](/docs/pages/api-reference/file-conventions/middleware)\n - [JWT Example](https://vercel.com/templates/next.js/jwt-authentication)"
        },
        {
            "sha": "c0cfb174c3d49ccba92c358d68aca567fe3da09e",
            "filename": "errors/returning-response-body-in-middleware.mdx",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/errors%2Freturning-response-body-in-middleware.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32/errors%2Freturning-response-body-in-middleware.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Freturning-response-body-in-middleware.mdx?ref=bbaa16473723f3f2de8c97e0ad0dd4b0fab52e32",
            "patch": "@@ -2,19 +2,19 @@\n title: Returning response body in Middleware\n ---\n \n-> **Note**: In Next.js v13.0.0 you can now respond to Middleware directly by returning a `NextResponse`. For more information, see [Producing a Response](/docs/pages/building-your-application/routing/middleware#producing-a-response).\n+> **Note**: In Next.js v13.0.0 you can now respond to Middleware directly by returning a `NextResponse`. For more information, see [Producing a Response](/docs/pages/api-reference/file-conventions/middleware#producing-a-response).\n \n ## Why This Error Occurred\n \n-[Middleware](/docs/pages/building-your-application/routing/middleware) can no longer produce a response body as of `v12.2+`.\n+[Middleware](/docs/pages/api-reference/file-conventions/middleware) can no longer produce a response body as of `v12.2+`.\n \n ## Possible Ways to Fix It\n \n Migrate to using `rewrite`/`redirect` to Pages/API Routes handling a response.\n \n ### Explanation\n \n-To respect the differences in client-side and server-side navigation, and to help ensure that developers do not build insecure Middleware, Middleware can no longer produce a response body. This ensures that Middleware is only used to `rewrite`, `redirect`, or modify the incoming request (e.g. [setting cookies](/docs/pages/building-your-application/routing/middleware#using-cookies)).\n+To respect the differences in client-side and server-side navigation, and to help ensure that developers do not build insecure Middleware, Middleware can no longer produce a response body. This ensures that Middleware is only used to `rewrite`, `redirect`, or modify the incoming request (e.g. [setting cookies](/docs/pages/api-reference/file-conventions/middleware#using-cookies)).\n \n The following patterns will no longer work:\n "
        }
    ],
    "stats": {
        "total": 1279,
        "additions": 624,
        "deletions": 655
    }
}