{
    "author": "lubieowoce",
    "message": "cleanup: remove unused NEXT_RSC_ERR_* error parsing code (#75982)\n\nseems like we're not emitting any errors tagged with a `NEXT_RSC_ERR_`\r\ncode anywhere, so this is dead code now",
    "sha": "ac2b8ebfb2068661e91ae0fce5039a2e528eb25e",
    "files": [
        {
            "sha": "4914f2d73aaaf8af22efb989f952161367acf4b4",
            "filename": "crates/next-custom-transforms/src/transforms/react_server_components.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/ac2b8ebfb2068661e91ae0fce5039a2e528eb25e/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Freact_server_components.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/ac2b8ebfb2068661e91ae0fce5039a2e528eb25e/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Freact_server_components.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Freact_server_components.rs?ref=ac2b8ebfb2068661e91ae0fce5039a2e528eb25e",
            "patch": "@@ -333,7 +333,6 @@ fn report_error(app_dir: &Option<PathBuf>, filepath: &str, error_kind: RSCErrorK\n             \"\\\"metadata\\\" and \\\"generateMetadata\\\" cannot be exported at the same time, please keep one of them. Read more: https://nextjs.org/docs/app/api-reference/file-conventions/metadata\\n\\n\".to_string(),\n             vec![span1, span2]\n         ),\n-        //NEXT_RSC_ERR_INVALID_API\n         RSCErrorKind::NextRscErrInvalidApi((source, span)) => (\n             format!(\"\\\"{source}\\\" is not supported in app/. Read more: https://nextjs.org/docs/app/building-your-application/data-fetching\\n\\n\"), vec![span]\n         ),"
        },
        {
            "sha": "f563a68b38a6d37456cf2b17e2270d6b392cba9c",
            "filename": "packages/next/src/build/webpack/plugins/wellknown-errors-plugin/parseRSC.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 163,
            "changes": 163,
            "blob_url": "https://github.com/vercel/next.js/blob/57c8d04b944f55e66173ede967f8a5b32966ddd9/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fwellknown-errors-plugin%2FparseRSC.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/57c8d04b944f55e66173ede967f8a5b32966ddd9/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fwellknown-errors-plugin%2FparseRSC.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fwellknown-errors-plugin%2FparseRSC.ts?ref=57c8d04b944f55e66173ede967f8a5b32966ddd9",
            "patch": "@@ -1,163 +0,0 @@\n-import type { webpack } from 'next/dist/compiled/webpack/webpack'\n-\n-import { getModuleTrace, formatModuleTrace } from './getModuleTrace'\n-import { SimpleWebpackError } from './simpleWebpackError'\n-\n-function formatRSCErrorMessage(\n-  message: string,\n-  isPagesDir: boolean,\n-  fileName: string\n-): [string, string] {\n-  let formattedMessage = message\n-  let formattedVerboseMessage = ''\n-\n-  // Comes from the \"React Server Components\" transform in SWC, always\n-  // attach the module trace.\n-  const NEXT_RSC_ERR_REACT_API = /.+NEXT_RSC_ERR_REACT_API: (.*?)\\n/s\n-  const NEXT_RSC_ERR_SERVER_IMPORT = /.+NEXT_RSC_ERR_SERVER_IMPORT: (.*?)\\n/s\n-  const NEXT_RSC_ERR_CLIENT_IMPORT = /.+NEXT_RSC_ERR_CLIENT_IMPORT: (.*?)\\n/s\n-  const NEXT_RSC_ERR_CLIENT_METADATA_EXPORT =\n-    /.+NEXT_RSC_ERR_CLIENT_METADATA_EXPORT: (.*?)\\n/s\n-  const NEXT_RSC_ERR_CONFLICT_METADATA_EXPORT =\n-    /NEXT_RSC_ERR_CONFLICT_METADATA_EXPORT/s\n-  const NEXT_RSC_ERR_CLIENT_DIRECTIVE = /.+NEXT_RSC_ERR_CLIENT_DIRECTIVE\\n/s\n-  const NEXT_RSC_ERR_CLIENT_DIRECTIVE_PAREN =\n-    /.+NEXT_RSC_ERR_CLIENT_DIRECTIVE_PAREN\\n/s\n-  const NEXT_RSC_ERR_INVALID_API = /.+NEXT_RSC_ERR_INVALID_API: (.*?)\\n/s\n-  const NEXT_RSC_ERR_ERROR_FILE_SERVER_COMPONENT =\n-    /.+NEXT_RSC_ERR_ERROR_FILE_SERVER_COMPONENT/\n-\n-  if (NEXT_RSC_ERR_REACT_API.test(message)) {\n-    const matches = message.match(NEXT_RSC_ERR_REACT_API)\n-    if (matches && matches[1] === 'Component') {\n-      formattedMessage = `\\n\\nYouâ€™re importing a class component. It only works in a Client Component but none of its parents are marked with \"use client\", so they're Server Components by default.\\nLearn more: https://nextjs.org/docs/app/building-your-application/rendering/client-components\\n\\n`\n-    } else {\n-      formattedMessage = message.replace(\n-        NEXT_RSC_ERR_REACT_API,\n-        `\\n\\nYou're importing a component that needs $1. This React hook only works in a client component. To fix, mark the file (or its parent) with the \\`\"use client\"\\` directive. \\n\\nLearn more: https://nextjs.org/docs/app/api-reference/directives/use-client\\n\\n`\n-      )\n-    }\n-    formattedVerboseMessage =\n-      '\\n\\nMaybe one of these should be marked as a client entry with \"use client\":\\n'\n-  } else if (NEXT_RSC_ERR_SERVER_IMPORT.test(message)) {\n-    let shouldAddUseClient = true\n-    const matches = message.match(NEXT_RSC_ERR_SERVER_IMPORT)\n-    switch (matches && matches[1]) {\n-      case 'react-dom/server':\n-        // If importing \"react-dom/server\", we should show a different error.\n-        formattedMessage = `\\n\\nYou're importing a component that imports react-dom/server. To fix it, render or return the content directly as a Server Component instead for perf and security.\\nLearn more: https://nextjs.org/docs/app/building-your-application/rendering`\n-        break\n-      case 'next/router':\n-        // If importing \"next/router\", we should tell them to use \"next/navigation\".\n-        formattedMessage = `\\n\\nYou have a Server Component that imports next/router. Use next/navigation instead.\\nLearn more: https://nextjs.org/docs/app/api-reference/functions/use-router`\n-        shouldAddUseClient = false\n-        break\n-      default:\n-        formattedMessage = message.replace(\n-          NEXT_RSC_ERR_SERVER_IMPORT,\n-          `\\n\\nYou're importing a component that imports $1. It only works in a Client Component but none of its parents are marked with \"use client\", so they're Server Components by default.\\nLearn more: https://nextjs.org/docs/app/building-your-application/rendering\\n\\n`\n-        )\n-    }\n-    formattedVerboseMessage = shouldAddUseClient\n-      ? '\\n\\nMaybe one of these should be marked as a client entry \"use client\":\\n'\n-      : '\\n\\nImport trace:\\n'\n-  } else if (NEXT_RSC_ERR_CLIENT_IMPORT.test(message)) {\n-    if (isPagesDir) {\n-      formattedMessage = message.replace(\n-        NEXT_RSC_ERR_CLIENT_IMPORT,\n-        `\\n\\nYou're importing a component that needs $1. That only works in a Server Component which is not supported in the pages/ directory. Read more: https://nextjs.org/docs/app/building-your-application/rendering/server-components\\n\\n`\n-      )\n-      formattedVerboseMessage = '\\n\\nImport trace for requested module:\\n'\n-    } else {\n-      formattedMessage = message.replace(\n-        NEXT_RSC_ERR_CLIENT_IMPORT,\n-        `\\n\\nYou're importing a component that needs $1. That only works in a Server Component but one of its parents is marked with \"use client\", so it's a Client Component.\\nLearn more: https://nextjs.org/docs/app/building-your-application/rendering\\n\\n`\n-      )\n-      formattedVerboseMessage =\n-        '\\n\\nOne of these is marked as a client entry with \"use client\":\\n'\n-    }\n-  } else if (NEXT_RSC_ERR_CLIENT_DIRECTIVE.test(message)) {\n-    formattedMessage = message.replace(\n-      NEXT_RSC_ERR_CLIENT_DIRECTIVE,\n-      `\\n\\nThe \"use client\" directive must be placed before other expressions. Move it to the top of the file to resolve this issue.\\n\\n`\n-    )\n-    formattedVerboseMessage = '\\n\\nImport path:\\n'\n-  } else if (NEXT_RSC_ERR_CLIENT_DIRECTIVE_PAREN.test(message)) {\n-    formattedMessage = message.replace(\n-      NEXT_RSC_ERR_CLIENT_DIRECTIVE_PAREN,\n-      `\\n\\n\"use client\" must be a directive, and placed before other expressions. Remove the parentheses and move it to the top of the file to resolve this issue.\\nLearn more: https://nextjs.org/docs/app/api-reference/directives/use-client\\n\\n`\n-    )\n-    formattedVerboseMessage = '\\n\\nImport path:\\n'\n-  } else if (NEXT_RSC_ERR_INVALID_API.test(message)) {\n-    formattedMessage = message.replace(\n-      NEXT_RSC_ERR_INVALID_API,\n-      `\\n\\n\"$1\" is not supported in app/. Read more: https://nextjs.org/docs/app/building-your-application/data-fetching\\n\\n`\n-    )\n-    formattedVerboseMessage = '\\n\\nFile path:\\n'\n-  } else if (NEXT_RSC_ERR_ERROR_FILE_SERVER_COMPONENT.test(message)) {\n-    formattedMessage = message.replace(\n-      NEXT_RSC_ERR_ERROR_FILE_SERVER_COMPONENT,\n-      `\\n\\n${fileName} must be a Client Component. Add the \"use client\" directive the top of the file to resolve this issue.\\nLearn more: https://nextjs.org/docs/app/api-reference/directives/use-client\\n\\n`\n-    )\n-    formattedVerboseMessage = '\\n\\nImport path:\\n'\n-  } else if (NEXT_RSC_ERR_CLIENT_METADATA_EXPORT.test(message)) {\n-    formattedMessage = message.replace(\n-      NEXT_RSC_ERR_CLIENT_METADATA_EXPORT,\n-      `\\n\\nYou are attempting to export \"$1\" from a component marked with \"use client\", which is disallowed. Either remove the export, or the \"use client\" directive. Read more: https://nextjs.org/docs/app/api-reference/directives/use-client\\n\\n`\n-    )\n-\n-    formattedVerboseMessage = '\\n\\nFile path:\\n'\n-  } else if (NEXT_RSC_ERR_CONFLICT_METADATA_EXPORT.test(message)) {\n-    formattedMessage = message.replace(\n-      NEXT_RSC_ERR_CONFLICT_METADATA_EXPORT,\n-      `\\n\\n\"metadata\" and \"generateMetadata\" cannot be exported at the same time, please keep one of them. Read more: https://nextjs.org/docs/app/api-reference/file-conventions/metadata\\n\\n`\n-    )\n-\n-    formattedVerboseMessage = '\\n\\nFile path:\\n'\n-  }\n-\n-  return [formattedMessage, formattedVerboseMessage]\n-}\n-\n-// Check if the error is specifically related to React Server Components.\n-// If so, we'll format the error message to be more helpful.\n-export function getRscError(\n-  fileName: string,\n-  err: Error,\n-  module: any,\n-  compilation: webpack.Compilation,\n-  compiler: webpack.Compiler\n-): SimpleWebpackError | false {\n-  if (!err.message || !/NEXT_RSC_ERR_/.test(err.message)) {\n-    return false\n-  }\n-\n-  const { isPagesDir, moduleTrace } = getModuleTrace(\n-    module,\n-    compilation,\n-    compiler\n-  )\n-\n-  const formattedError = formatRSCErrorMessage(\n-    err.message,\n-    isPagesDir,\n-    fileName\n-  )\n-\n-  const { formattedModuleTrace, lastInternalFileName, invalidImportMessage } =\n-    formatModuleTrace(compiler, moduleTrace)\n-\n-  const error = new SimpleWebpackError(\n-    lastInternalFileName,\n-    'ReactServerComponentsError:\\n' +\n-      formattedError[0] +\n-      invalidImportMessage +\n-      formattedError[1] +\n-      formattedModuleTrace\n-  )\n-\n-  // Delete the stack because it's created here.\n-  error.stack = ''\n-\n-  return error\n-}"
        },
        {
            "sha": "8b5706a0ced820d8add0ed12c07c638f8003376f",
            "filename": "packages/next/src/build/webpack/plugins/wellknown-errors-plugin/webpackModuleError.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 12,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/ac2b8ebfb2068661e91ae0fce5039a2e528eb25e/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fwellknown-errors-plugin%2FwebpackModuleError.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ac2b8ebfb2068661e91ae0fce5039a2e528eb25e/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fwellknown-errors-plugin%2FwebpackModuleError.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fwellknown-errors-plugin%2FwebpackModuleError.ts?ref=ac2b8ebfb2068661e91ae0fce5039a2e528eb25e",
            "patch": "@@ -8,7 +8,6 @@ import { getScssError } from './parseScss'\n import { getNotFoundError, getImageError } from './parseNotFoundError'\n import type { SimpleWebpackError } from './simpleWebpackError'\n import isError from '../../../../lib/is-error'\n-import { getRscError } from './parseRSC'\n import { getNextFontError } from './parseNextFontError'\n import { getNextAppLoaderError } from './parseNextAppLoaderError'\n import { getNextInvalidImportError } from './parseNextInvalidImportError'\n@@ -95,17 +94,6 @@ export async function getModuleBuildError(\n     return scss\n   }\n \n-  const rsc = getRscError(\n-    sourceFilename,\n-    err,\n-    input.module,\n-    compilation,\n-    compiler\n-  )\n-  if (rsc !== false) {\n-    return rsc\n-  }\n-\n   const nextFont = getNextFontError(err, input.module)\n   if (nextFont !== false) {\n     return nextFont"
        }
    ],
    "stats": {
        "total": 176,
        "additions": 0,
        "deletions": 176
    }
}