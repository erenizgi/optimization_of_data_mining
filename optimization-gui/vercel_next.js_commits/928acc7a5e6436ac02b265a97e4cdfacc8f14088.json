{
    "author": "raunofreiberg",
    "message": "[dev-overlay] Consider scrollbar width for drag positioning (#78865)\n\nThis PR fixes a small bug with the dragging logic established in #78716\n\nNamely, I didn't take into account the scrollbar width when calculating\n`translate` for each corner. So if the page was scrollable the drag end\nwould be a bit janky:\n\n\n\nhttps://github.com/user-attachments/assets/17e227e9-7af1-4ab8-91b2-b7cc4d363793\n\nAfter this PR, the snapping is much smoother with no jank:\n\n\n\nhttps://github.com/user-attachments/assets/06021fae-da61-46b3-b224-11f319835fa3",
    "sha": "928acc7a5e6436ac02b265a97e4cdfacc8f14088",
    "files": [
        {
            "sha": "292186b91179ae663484b384a2d7bf3333bb4f3f",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/dev-tools-indicator/draggable.tsx",
            "status": "modified",
            "additions": 17,
            "deletions": 3,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/928acc7a5e6436ac02b265a97e4cdfacc8f14088/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdraggable.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/928acc7a5e6436ac02b265a97e4cdfacc8f14088/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdraggable.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdraggable.tsx?ref=928acc7a5e6436ac02b265a97e4cdfacc8f14088",
            "patch": "@@ -73,13 +73,17 @@ export function Draggable({\n     const offset = padding * 2\n     const triggerWidth = ref.current?.offsetWidth || 0\n     const triggerHeight = ref.current?.offsetHeight || 0\n+    const scrollbarWidth =\n+      window.innerWidth - document.documentElement.clientWidth\n \n     function getAbsolutePosition(corner: Corners) {\n       const isRight = corner.includes('right')\n       const isBottom = corner.includes('bottom')\n \n       return {\n-        x: isRight ? window.innerWidth - offset - triggerWidth : 0,\n+        x: isRight\n+          ? window.innerWidth - scrollbarWidth - offset - triggerWidth\n+          : 0,\n         y: isBottom ? window.innerHeight - offset - triggerHeight : 0,\n       }\n     }\n@@ -93,15 +97,25 @@ export function Draggable({\n         y: 0 - basePosition.y,\n       },\n       'top-right': {\n-        x: window.innerWidth - offset - triggerWidth - basePosition.x,\n+        x:\n+          window.innerWidth -\n+          scrollbarWidth -\n+          offset -\n+          triggerWidth -\n+          basePosition.x,\n         y: 0 - basePosition.y,\n       },\n       'bottom-left': {\n         x: 0 - basePosition.x,\n         y: window.innerHeight - offset - triggerHeight - basePosition.y,\n       },\n       'bottom-right': {\n-        x: window.innerWidth - offset - triggerWidth - basePosition.x,\n+        x:\n+          window.innerWidth -\n+          scrollbarWidth -\n+          offset -\n+          triggerWidth -\n+          basePosition.x,\n         y: window.innerHeight - offset - triggerHeight - basePosition.y,\n       },\n     }"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 17,
        "deletions": 3
    }
}