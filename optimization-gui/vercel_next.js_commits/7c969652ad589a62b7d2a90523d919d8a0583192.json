{
    "author": "mischnic",
    "message": "Include nextConfig in edge runtime via separate manifest (#86769)\n\nA separate manifest (`required-server-files.js`, like `_buildManifest.js`) so that we the bundler doesn't have to inline the whole config.\r\n\r\nThe Node.js runtime routes already get their nextConfig at runtime by reading `required-server-files.js`.\r\n\r\nCloses https://github.com/vercel/next.js/pull/86630\r\n\r\nContext for `initializeCacheHandlers`: https://github.com/vercel/next.js/pull/76130",
    "sha": "7c969652ad589a62b7d2a90523d919d8a0583192",
    "files": [
        {
            "sha": "c0639362a579d6fd390b8fd220863f1dc898007d",
            "filename": "crates/next-api/src/app.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-api%2Fsrc%2Fapp.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-api%2Fsrc%2Fapp.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fapp.rs?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -1543,6 +1543,9 @@ impl AppEndpoint {\n                     rcstr!(\"server/middleware-build-manifest.js\"),\n                     rcstr!(\"server/interception-route-rewrite-manifest.js\"),\n                 ];\n+                if project.next_mode().await?.is_production() {\n+                    file_paths_from_root.insert(rcstr!(\"required-server-files.js\"));\n+                }\n                 if emit_manifests == EmitManifests::Full {\n                     file_paths_from_root.insert(rcstr!(\"server/next-font-manifest.js\"));\n                 };"
        },
        {
            "sha": "7efbdef0e11f428e19c4f409928f6def412a54f4",
            "filename": "crates/next-api/src/pages.rs",
            "status": "modified",
            "additions": 10,
            "deletions": 1,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fpages.rs?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -904,7 +904,6 @@ impl PageEndpoint {\n                     this.original_name.clone(),\n                     *this.pages_structure,\n                     runtime,\n-                    this.pages_project.project().next_config(),\n                 )\n                 .await?;\n \n@@ -1441,6 +1440,16 @@ impl PageEndpoint {\n                         fxindexset![]\n                     };\n \n+                    if this\n+                        .pages_project\n+                        .project()\n+                        .next_mode()\n+                        .await?\n+                        .is_production()\n+                    {\n+                        file_paths_from_root.insert(rcstr!(\"required-server-files.js\"));\n+                    }\n+\n                     let all_assets = assets.concatenate(*referenced_assets);\n                     let assets_ref = assets.await?;\n "
        },
        {
            "sha": "6cb9c42c12d0f3e38a49dd202711d25f4cdbfc68",
            "filename": "crates/next-core/src/next_app/app_page_entry.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 9,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fapp_page_entry.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fapp_page_entry.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fapp_page_entry.rs?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -122,7 +122,6 @@ pub async fn get_app_page_entry(\n             project_root.clone(),\n             rsc_entry,\n             page,\n-            next_config,\n         );\n     };\n \n@@ -141,21 +140,14 @@ async fn wrap_edge_page(\n     project_root: FileSystemPath,\n     entry: ResolvedVc<Box<dyn Module>>,\n     page: AppPage,\n-    next_config: Vc<NextConfig>,\n ) -> Result<Vc<Box<dyn Module>>> {\n     const INNER: &str = \"INNER_PAGE_ENTRY\";\n \n-    let next_config_val = &*next_config.await?;\n-\n     let source = load_next_js_template(\n         \"edge-ssr-app.js\",\n         project_root.clone(),\n         [(\"VAR_USERLAND\", INNER), (\"VAR_PAGE\", &page.to_string())],\n-        [\n-            // TODO do we really need to pass the entire next config here?\n-            // This is bad for invalidation as any config change will invalidate this\n-            (\"nextConfig\", &*serde_json::to_string(next_config_val)?),\n-        ],\n+        [],\n         [(\"incrementalCacheHandler\", None)],\n     )\n     .await?;"
        },
        {
            "sha": "1df164f9622da4e64fa8ed1906ea1025be45649b",
            "filename": "crates/next-core/src/next_app/app_route_entry.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fapp_route_entry.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fapp_route_entry.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fapp_route_entry.rs?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -113,7 +113,6 @@ pub async fn get_app_route_entry(\n             project_root,\n             rsc_entry,\n             page,\n-            next_config,\n         );\n     }\n \n@@ -132,17 +131,14 @@ async fn wrap_edge_route(\n     project_root: FileSystemPath,\n     entry: ResolvedVc<Box<dyn Module>>,\n     page: AppPage,\n-    next_config: Vc<NextConfig>,\n ) -> Result<Vc<Box<dyn Module>>> {\n     let inner = rcstr!(\"INNER_ROUTE_ENTRY\");\n \n-    let next_config = &*next_config.await?;\n-\n     let source = load_next_js_template(\n         \"edge-app-route.js\",\n         project_root.clone(),\n         [(\"VAR_USERLAND\", &*inner), (\"VAR_PAGE\", &page.to_string())],\n-        [(\"nextConfig\", &*serde_json::to_string(next_config)?)],\n+        [],\n         [],\n     )\n     .await?;"
        },
        {
            "sha": "c1ee2386ca9f7b4cddacc97d6780d09e762d67a7",
            "filename": "crates/next-core/src/next_pages/page_entry.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-core%2Fsrc%2Fnext_pages%2Fpage_entry.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/crates%2Fnext-core%2Fsrc%2Fnext_pages%2Fpage_entry.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_pages%2Fpage_entry.rs?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -16,7 +16,6 @@ use turbopack_core::{\n };\n \n use crate::{\n-    next_config::NextConfig,\n     next_edge::entry::wrap_edge_entry,\n     pages_structure::{PagesStructure, PagesStructureItem},\n     util::{NextRuntime, file_content_rope, load_next_js_template, pages_function_name},\n@@ -39,7 +38,6 @@ pub async fn create_page_ssr_entry_module(\n     next_original_name: RcStr,\n     pages_structure: Vc<PagesStructure>,\n     runtime: NextRuntime,\n-    next_config: Vc<NextConfig>,\n ) -> Result<Vc<PageSsrEntryModule>> {\n     let definition_page = next_original_name;\n     let definition_pathname = pathname;\n@@ -99,11 +97,7 @@ pub async fn create_page_ssr_entry_module(\n     let pages_structure_ref = pages_structure.await?;\n \n     let (injections, imports) = if is_page && runtime == NextRuntime::Edge {\n-        let next_config_val = &*next_config.await?;\n         let injections = vec![\n-            // TODO do we really need to pass the entire next config here?\n-            // This is bad for invalidation as any config change will invalidate this\n-            (\"nextConfig\", serde_json::to_string(next_config_val)?),\n             (\n                 \"pageRouteModuleOptions\",\n                 serde_json::to_string(&get_route_module_options("
        },
        {
            "sha": "493d95d7d4423d7035d8ce03c4732217932ebf3e",
            "filename": "packages/next/errors.json",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Ferrors.json",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Ferrors.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ferrors.json?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -965,5 +965,7 @@\n   \"964\": \"An unexpected error occurred while starting to capture immediates\",\n   \"965\": \"Expected setImmediate to reject invalid arguments\",\n   \"966\": \"Expected process.nextTick to reject invalid arguments\",\n-  \"967\": \"The key \\\"%s\\\" under \\\"env\\\" in %sconfig is not allowed. https://nextjs.org/docs/messages/env-key-not-allowed\"\n+  \"967\": \"The key \\\"%s\\\" under \\\"env\\\" in %sconfig is not allowed. https://nextjs.org/docs/messages/env-key-not-allowed\",\n+  \"968\": \"Invariant: getNextConfigEdge must only be called in edge runtime\",\n+  \"969\": \"Invariant: nextConfig couldn't be loaded\"\n }"
        },
        {
            "sha": "1c60e0b006a7df496135418eb4feffedec43e416",
            "filename": "packages/next/src/build/define-env.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -296,7 +296,7 @@ export function getDefineEnv({\n       config.experimental.trustHostHeader ?? false,\n     'process.env.__NEXT_ALLOWED_REVALIDATE_HEADERS':\n       config.experimental.allowedRevalidateHeaderKeys ?? [],\n-    ...(isNodeServer\n+    ...(isNodeServer || isEdgeServer\n       ? {\n           'process.env.__NEXT_RELATIVE_DIST_DIR': config.distDir,\n           'process.env.__NEXT_RELATIVE_PROJECT_DIR': path.relative("
        },
        {
            "sha": "25258e16bd7ab40795f7bf63b0345d3940d2be28",
            "filename": "packages/next/src/build/entries.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fentries.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fentries.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fentries.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -621,7 +621,6 @@ export function getEdgeServerEntry(opts: {\n       absolutePagePath: opts.absolutePagePath,\n       page: opts.page,\n       appDirLoader: Buffer.from(opts.appDirLoader || '').toString('base64'),\n-      nextConfig: Buffer.from(JSON.stringify(opts.config)).toString('base64'),\n       preferredRegion: opts.preferredRegion,\n       middlewareConfig: Buffer.from(\n         JSON.stringify(opts.middlewareConfig || {})\n@@ -682,9 +681,6 @@ export function getEdgeServerEntry(opts: {\n     dev: opts.isDev,\n     isServerComponent: opts.isServerComponent,\n     page: opts.page,\n-    stringifiedConfig: Buffer.from(JSON.stringify(opts.config)).toString(\n-      'base64'\n-    ),\n     pagesType: opts.pagesType,\n     appDirLoader: Buffer.from(opts.appDirLoader || '').toString('base64'),\n     sriEnabled: !opts.isDev && !!opts.config.experimental.sri?.algorithm,"
        },
        {
            "sha": "fe5ce8848dd53c1a5d0c0de0670ab63606f1d130",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 3,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -621,9 +621,13 @@ async function writeRequiredServerFilesManifest(\n   requiredServerFiles: RequiredServerFilesManifest\n ) {\n   await writeManifest(\n-    path.join(distDir, SERVER_FILES_MANIFEST),\n+    path.join(distDir, SERVER_FILES_MANIFEST + '.json'),\n     requiredServerFiles\n   )\n+  await writeFileUtf8(\n+    path.join(distDir, SERVER_FILES_MANIFEST + '.js'),\n+    `self.__SERVER_FILES_MANIFEST=${formatManifest(requiredServerFiles)}`\n+  )\n }\n \n async function writeImagesManifest(\n@@ -693,7 +697,10 @@ async function writeStandaloneDirectory(\n \n       for (const file of [\n         ...requiredServerFiles.files,\n-        path.join(requiredServerFiles.config.distDir, SERVER_FILES_MANIFEST),\n+        path.join(\n+          requiredServerFiles.config.distDir,\n+          SERVER_FILES_MANIFEST + '.json'\n+        ),\n         ...loadedEnvFiles.reduce<string[]>((acc, envFile) => {\n           if (['.env', '.env.production'].includes(envFile.path)) {\n             acc.push(envFile.path)\n@@ -1915,7 +1922,7 @@ export default async function build(\n               BUILD_ID_FILE,\n               path.join(SERVER_DIRECTORY, NEXT_FONT_MANIFEST + '.js'),\n               path.join(SERVER_DIRECTORY, NEXT_FONT_MANIFEST + '.json'),\n-              SERVER_FILES_MANIFEST,\n+              SERVER_FILES_MANIFEST + '.json',\n             ]\n               .filter(nonNullable)\n               .map((file) => path.join(config.distDir, file)),"
        },
        {
            "sha": "439ae20cbd5a60087630309e7acc9c296493bef8",
            "filename": "packages/next/src/build/templates/edge-app-route.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-app-route.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-app-route.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-app-route.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -1,14 +1,11 @@\n import { setManifestsSingleton } from '../../server/app-render/manifests-singleton'\n-import type { NextConfigRuntime } from '../../server/config-shared'\n import type { EdgeHandler } from '../../server/web/adapter'\n import { EdgeRouteModuleWrapper } from '../../server/web/edge-route-module-wrapper'\n \n // Import the userland code.\n import * as module from 'VAR_USERLAND'\n \n // injected by the loader afterwards.\n-declare const nextConfig: NextConfigRuntime\n-// INJECT:nextConfig\n \n const maybeJSONParse = (str?: string) => (str ? JSON.parse(str) : undefined)\n \n@@ -26,7 +23,6 @@ if (rscManifest && rscServerManifest) {\n export const ComponentMod = module\n \n const handler: EdgeHandler = EdgeRouteModuleWrapper.wrap(module.routeModule, {\n-  nextConfig,\n   page: 'VAR_PAGE',\n })\n export default handler"
        },
        {
            "sha": "b694a72f4eee0c3d8c04617451bdbfc4eb2eb66f",
            "filename": "packages/next/src/build/templates/edge-ssr-app.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -8,7 +8,6 @@ import { IncrementalCache } from '../../server/lib/incremental-cache'\n \n import * as pageMod from 'VAR_USERLAND'\n \n-import type { NextConfigRuntime } from '../../server/config-shared'\n import { setManifestsSingleton } from '../../server/app-render/manifests-singleton'\n import { initializeCacheHandlers } from '../../server/use-cache/handlers'\n import { BaseServerSpan } from '../../server/lib/trace/constants'\n@@ -29,12 +28,7 @@ import { checkIsOnDemandRevalidate } from '../../server/api-utils'\n import { CloseController } from '../../server/web/web-on-close'\n \n declare const incrementalCacheHandler: any\n-declare const nextConfig: NextConfigRuntime\n // OPTIONAL_IMPORT:incrementalCacheHandler\n-// INJECT:nextConfig\n-\n-// Initialize the cache handlers interface.\n-initializeCacheHandlers(nextConfig.cacheMaxMemorySize)\n \n const maybeJSONParse = (str?: string) => (str ? JSON.parse(str) : undefined)\n \n@@ -77,6 +71,7 @@ async function requestHandler(\n     query,\n     params,\n     buildId,\n+    nextConfig,\n     buildManifest,\n     prerenderManifest,\n     reactLoadableManifest,\n@@ -88,6 +83,9 @@ async function requestHandler(\n     routerServerContext,\n   } = prepareResult\n \n+  // Initialize the cache handlers interface.\n+  initializeCacheHandlers(nextConfig.cacheMaxMemorySize)\n+\n   const isPossibleServerAction = getIsPossibleServerAction(req)\n   const botType = getBotType(req.headers.get('User-Agent') || '')\n   const { isOnDemandRevalidate } = checkIsOnDemandRevalidate("
        },
        {
            "sha": "ca4f2040e3712f66a0a250d9494146243ea2f0e5",
            "filename": "packages/next/src/build/templates/edge-ssr.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -22,7 +22,6 @@ import RouteModule, {\n } from '../../server/route-modules/pages/module'\n import { WebNextRequest, WebNextResponse } from '../../server/base-http/web'\n \n-import type { NextConfigRuntime } from '../../server/config-shared'\n import type { NextFetchEvent } from '../../server/web/spec-extension/fetch-event'\n import type RenderResult from '../../server/render-result'\n import type { RenderResultMetadata } from '../../server/render-result'\n@@ -31,21 +30,13 @@ import { BaseServerSpan } from '../../server/lib/trace/constants'\n import { HTML_CONTENT_TYPE_HEADER } from '../../lib/constants'\n \n // injected by the loader afterwards.\n-declare const nextConfig: NextConfigRuntime\n declare const pageRouteModuleOptions: any\n declare const errorRouteModuleOptions: any\n declare const user500RouteModuleOptions: any\n-// INJECT:nextConfig\n // INJECT:pageRouteModuleOptions\n // INJECT:errorRouteModuleOptions\n // INJECT:user500RouteModuleOptions\n \n-// Initialize the cache handlers interface.\n-initializeCacheHandlers(nextConfig.cacheMaxMemorySize)\n-\n-// expose this for the route-module\n-;(globalThis as any).nextConfig = nextConfig\n-\n const pageMod = {\n   ...userlandPage,\n   routeModule: new RouteModule({\n@@ -55,6 +46,8 @@ const pageMod = {\n       Document,\n     },\n     userland: userlandPage,\n+    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n+    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n   }),\n }\n \n@@ -67,6 +60,8 @@ const errorMod = {\n       Document,\n     },\n     userland: userlandErrorPage,\n+    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n+    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n   }),\n }\n \n@@ -81,6 +76,8 @@ const error500Mod = userland500Page\n           Document,\n         },\n         userland: userland500Page,\n+        distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n+        relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n       }),\n     }\n   : null\n@@ -110,6 +107,7 @@ async function requestHandler(\n     query,\n     params,\n     buildId,\n+    nextConfig,\n     isNextDataRequest,\n     buildManifest,\n     prerenderManifest,\n@@ -119,6 +117,8 @@ async function requestHandler(\n     dynamicCssManifest,\n   } = prepareResult\n \n+  initializeCacheHandlers(nextConfig.cacheMaxMemorySize)\n+\n   const renderContext: PagesRouteHandlerContext = {\n     page: srcPage,\n     query,"
        },
        {
            "sha": "4c692766378d44514b135b6e41021de6cec7aac1",
            "filename": "packages/next/src/build/webpack/loaders/next-edge-app-route-loader/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 10,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-edge-app-route-loader%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-edge-app-route-loader%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-edge-app-route-loader%2Findex.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -11,7 +11,6 @@ export type EdgeAppRouteLoaderQuery = {\n   page: string\n   appDirLoader: string\n   preferredRegion: string | string[] | undefined\n-  nextConfig: string\n   middlewareConfig: string\n   cacheHandlers: string\n }\n@@ -24,7 +23,6 @@ const EdgeAppRouteLoader: webpack.LoaderDefinitionFunction<EdgeAppRouteLoaderQue\n       preferredRegion,\n       appDirLoader: appDirLoaderBase64 = '',\n       middlewareConfig: middlewareConfigBase64 = '',\n-      nextConfig: nextConfigBase64,\n       cacheHandlers: cacheHandlersStringified,\n     } = this.getOptions()\n \n@@ -64,20 +62,13 @@ const EdgeAppRouteLoader: webpack.LoaderDefinitionFunction<EdgeAppRouteLoaderQue\n       stringifiedPagePath.length - 1\n     )}?${WEBPACK_RESOURCE_QUERIES.edgeSSREntry}`\n \n-    const stringifiedConfig = Buffer.from(\n-      nextConfigBase64 || '',\n-      'base64'\n-    ).toString()\n-\n     return await loadEntrypoint(\n       'edge-app-route',\n       {\n         VAR_USERLAND: modulePath,\n         VAR_PAGE: page,\n       },\n-      {\n-        nextConfig: stringifiedConfig,\n-      }\n+      {}\n     )\n   }\n "
        },
        {
            "sha": "56cfcc8671ff4aa6ea44d1821ab726a8bb91caf9",
            "filename": "packages/next/src/build/webpack/loaders/next-edge-ssr-loader/index.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 14,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-edge-ssr-loader%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-edge-ssr-loader%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-edge-ssr-loader%2Findex.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -19,7 +19,6 @@ export type EdgeSSRLoaderQuery = {\n   dev: boolean\n   isServerComponent: boolean\n   page: string\n-  stringifiedConfig: string\n   appDirLoader?: string\n   pagesType: PAGE_TYPES\n   sriEnabled: boolean\n@@ -46,7 +45,10 @@ function swapDistFolderWithEsmDistFolder(path: string) {\n }\n \n function getRouteModuleOptions(page: string) {\n-  const options: Omit<PagesRouteModuleOptions, 'userland' | 'components'> = {\n+  const options: Omit<\n+    PagesRouteModuleOptions,\n+    'userland' | 'components' | 'distDir' | 'relativeProjectDir'\n+  > = {\n     definition: {\n       kind: RouteKind.PAGES,\n       page: normalizePagePath(page),\n@@ -55,9 +57,6 @@ function getRouteModuleOptions(page: string) {\n       bundlePath: '',\n       filename: '',\n     },\n-    // edge runtime doesn't read from distDir or projectDir\n-    distDir: '',\n-    relativeProjectDir: '',\n   }\n \n   return options\n@@ -73,7 +72,6 @@ const edgeSSRLoader: webpack.LoaderDefinitionFunction<EdgeSSRLoaderQuery> =\n       absolute500Path,\n       absoluteErrorPath,\n       isServerComponent,\n-      stringifiedConfig: stringifiedConfigBase64,\n       appDirLoader: appDirLoaderBase64,\n       pagesType,\n       cacheHandler,\n@@ -94,10 +92,6 @@ const edgeSSRLoader: webpack.LoaderDefinitionFunction<EdgeSSRLoaderQuery> =\n       Buffer.from(middlewareConfigBase64, 'base64').toString()\n     )\n \n-    const stringifiedConfig = Buffer.from(\n-      stringifiedConfigBase64 || '',\n-      'base64'\n-    ).toString()\n     const appDirLoader = Buffer.from(\n       appDirLoaderBase64 || '',\n       'base64'\n@@ -160,9 +154,7 @@ const edgeSSRLoader: webpack.LoaderDefinitionFunction<EdgeSSRLoaderQuery> =\n           VAR_USERLAND: pageModPath,\n           VAR_PAGE: page,\n         },\n-        {\n-          nextConfig: stringifiedConfig,\n-        },\n+        {},\n         {\n           incrementalCacheHandler: cacheHandler ?? null,\n         }\n@@ -178,7 +170,6 @@ const edgeSSRLoader: webpack.LoaderDefinitionFunction<EdgeSSRLoaderQuery> =\n           VAR_MODULE_GLOBAL_ERROR: errorPath,\n         },\n         {\n-          nextConfig: stringifiedConfig,\n           pageRouteModuleOptions: JSON.stringify(getRouteModuleOptions(page)),\n           errorRouteModuleOptions: JSON.stringify(\n             getRouteModuleOptions('/_error')"
        },
        {
            "sha": "43425a5c6ae37e4adc665fd4a7c11f0abcd3a87c",
            "filename": "packages/next/src/build/webpack/plugins/middleware-plugin.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fmiddleware-plugin.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fmiddleware-plugin.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fmiddleware-plugin.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -22,6 +22,7 @@ import {\n   SERVER_REFERENCE_MANIFEST,\n   INTERCEPTION_ROUTE_REWRITE_MANIFEST,\n   DYNAMIC_CSS_MANIFEST,\n+  SERVER_FILES_MANIFEST,\n } from '../../../shared/lib/constants'\n import type { ProxyConfig } from '../../analysis/get-page-static-info'\n import type { Telemetry } from '../../../telemetry/storage'\n@@ -133,6 +134,10 @@ function getEntryFiles(\n       `server/${NEXT_FONT_MANIFEST}.js`,\n       `server/${INTERCEPTION_ROUTE_REWRITE_MANIFEST}.js`\n     )\n+\n+    if (!opts.dev) {\n+      files.push(`${SERVER_FILES_MANIFEST}.js`)\n+    }\n   }\n \n   if (hasInstrumentationHook) {"
        },
        {
            "sha": "39ce7694cfc168382c0ff4f7163da977d9c8f57c",
            "filename": "packages/next/src/client/route-loader.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fclient%2Froute-loader.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fclient%2Froute-loader.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Froute-loader.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -1,5 +1,6 @@\n import type { ComponentType } from 'react'\n import type { ProxyMatcher } from '../build/analysis/get-page-static-info'\n+import type { RequiredServerFilesManifest } from '../build'\n import getAssetPathFromRoute from '../shared/lib/router/utils/get-asset-path-from-route'\n import { __unsafeCreateTrustedScriptURL } from './trusted-types'\n import { requestIdleCallback } from './request-idle-callback'\n@@ -16,6 +17,7 @@ declare global {\n   interface Window {\n     __BUILD_MANIFEST?: Record<string, string[]>\n     __BUILD_MANIFEST_CB?: Function\n+    __SERVER_FILES_MANIFEST?: RequiredServerFilesManifest\n     __MIDDLEWARE_MATCHERS?: ProxyMatcher[]\n     __MIDDLEWARE_MANIFEST_CB?: Function\n     __REACT_LOADABLE_MANIFEST?: any"
        },
        {
            "sha": "e2274aaa8eaafac1fe562050c4354dd9cedb5907",
            "filename": "packages/next/src/server/next.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fserver%2Fnext.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fserver%2Fnext.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fnext.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -298,7 +298,7 @@ export class NextServer implements NextWrapperServer {\n           path.join(\n             /* turbopackIgnore: true */ dir,\n             config.distDir,\n-            SERVER_FILES_MANIFEST\n+            SERVER_FILES_MANIFEST + '.json'\n           )\n         ).config\n "
        },
        {
            "sha": "25617a653c80e5950c52e6151e3b078f7a38361a",
            "filename": "packages/next/src/server/route-modules/route-module.ts",
            "status": "modified",
            "additions": 44,
            "deletions": 12,
            "changes": 56,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fserver%2Froute-modules%2Froute-module.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fserver%2Froute-modules%2Froute-module.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Froute-modules%2Froute-module.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -42,7 +42,11 @@ import type { ReactLoadableManifest } from '../load-components'\n import type { NextFontManifest } from '../../build/webpack/plugins/next-font-manifest-plugin'\n import { normalizeDataPath } from '../../shared/lib/page-path/normalize-data-path'\n import { pathHasPrefix } from '../../shared/lib/router/utils/path-has-prefix'\n-import { addRequestMeta, getRequestMeta } from '../request-meta'\n+import {\n+  addRequestMeta,\n+  getRequestMeta,\n+  type NextIncomingMessage,\n+} from '../request-meta'\n import { normalizePagePath } from '../../shared/lib/page-path/normalize-page-path'\n import { isStaticMetadataRoute } from '../../lib/metadata/is-metadata-route'\n import { IncrementalCache } from '../lib/incremental-cache'\n@@ -178,7 +182,7 @@ export abstract class RouteModule<\n     routesManifest: DeepReadonly<DevRoutesManifest>\n     nextFontManifest: DeepReadonly<NextFontManifest>\n     prerenderManifest: DeepReadonly<PrerenderManifest>\n-    serverFilesManifest: RequiredServerFilesManifest\n+    serverFilesManifest: RequiredServerFilesManifest | undefined\n     reactLoadableManifest: DeepReadonly<ReactLoadableManifest>\n     subresourceIntegrityManifest: any\n     clientReferenceManifest: any\n@@ -223,9 +227,7 @@ export abstract class RouteModule<\n             process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE\n           ),\n         },\n-        serverFilesManifest: {\n-          config: (globalThis as any).nextConfig || {},\n-        } as any,\n+        serverFilesManifest: self.__SERVER_FILES_MANIFEST,\n         clientReferenceManifest: self.__RSC_MANIFEST?.[srcPage],\n         serverActionsManifest: maybeJSONParse(self.__RSC_SERVER_MANIFEST),\n         subresourceIntegrityManifest: maybeJSONParse(\n@@ -333,12 +335,12 @@ export abstract class RouteModule<\n           shouldCache: !this.isDev,\n         }),\n         this.isDev\n-          ? ({} as any)\n-          : loadManifestFromRelativePath<RequiredServerFilesManifest>({\n+          ? undefined\n+          : (loadManifestFromRelativePath<RequiredServerFilesManifest>({\n               projectDir,\n               distDir: this.distDir,\n-              manifest: SERVER_FILES_MANIFEST,\n-            }),\n+              manifest: `${SERVER_FILES_MANIFEST}.json`,\n+            }) as RequiredServerFilesManifest),\n         this.isDev\n           ? 'development'\n           : loadManifestFromRelativePath<any>({\n@@ -500,6 +502,31 @@ export abstract class RouteModule<\n     )\n   }\n \n+  /** A more lightweight version of `prepare()` for only retrieving the config on edge */\n+  public getNextConfigEdge(req: NextIncomingMessage): NextConfigRuntime {\n+    if (process.env.NEXT_RUNTIME !== 'edge') {\n+      throw new Error(\n+        'Invariant: getNextConfigEdge must only be called in edge runtime'\n+      )\n+    }\n+\n+    let serverFilesManifest = self.__SERVER_FILES_MANIFEST as any as\n+      | RequiredServerFilesManifest\n+      | undefined\n+    const relativeProjectDir =\n+      getRequestMeta(req, 'relativeProjectDir') || this.relativeProjectDir\n+    const routerServerContext =\n+      routerServerGlobal[RouterServerContextSymbol]?.[relativeProjectDir]\n+    const nextConfig =\n+      routerServerContext?.nextConfig || serverFilesManifest?.config\n+\n+    if (!nextConfig) {\n+      throw new Error(\"Invariant: nextConfig couldn't be loaded\")\n+    }\n+\n+    return nextConfig\n+  }\n+\n   public async prepare(\n     req: IncomingMessage | BaseNextRequest,\n     res: ServerResponse | null,\n@@ -530,7 +557,9 @@ export abstract class RouteModule<\n         buildManifest: DeepReadonly<BuildManifest>\n         fallbackBuildManifest: DeepReadonly<BuildManifest>\n         nextFontManifest: DeepReadonly<NextFontManifest>\n-        serverFilesManifest: DeepReadonly<RequiredServerFilesManifest>\n+        serverFilesManifest:\n+          | DeepReadonly<RequiredServerFilesManifest>\n+          | undefined\n         reactLoadableManifest: DeepReadonly<ReactLoadableManifest>\n         routesManifest: DeepReadonly<DevRoutesManifest>\n         prerenderManifest: DeepReadonly<PrerenderManifest>\n@@ -849,7 +878,11 @@ export abstract class RouteModule<\n     const routerServerContext =\n       routerServerGlobal[RouterServerContextSymbol]?.[relativeProjectDir]\n     const nextConfig =\n-      routerServerContext?.nextConfig || serverFilesManifest.config\n+      routerServerContext?.nextConfig || serverFilesManifest?.config\n+\n+    if (!nextConfig) {\n+      throw new Error(\"Invariant: nextConfig couldn't be loaded\")\n+    }\n \n     let resolvedPathname = normalizedSrcPage\n     if (isDynamicRoute(resolvedPathname) && params) {\n@@ -890,7 +923,6 @@ export abstract class RouteModule<\n       isOnDemandRevalidate,\n       revalidateOnlyGenerated,\n       ...manifests,\n-      serverActionsManifest: manifests.serverActionsManifest,\n       clientReferenceManifest: manifests.clientReferenceManifest,\n       nextConfig,\n       routerServerContext,"
        },
        {
            "sha": "f53b6bb3de32f21cb5b1b0f7757adfa19956b8b7",
            "filename": "packages/next/src/server/web/edge-route-module-wrapper.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 11,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fedge-route-module-wrapper.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fedge-route-module-wrapper.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fedge-route-module-wrapper.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -1,12 +1,11 @@\n-import type { NextRequest } from './spec-extension/request'\n import type {\n   AppRouteRouteHandlerContext,\n   AppRouteRouteModule,\n } from '../route-modules/app-route/module'\n \n import './globals'\n \n-import { adapter, type EdgeHandler } from './adapter'\n+import { adapter, type NextRequestHint, type EdgeHandler } from './adapter'\n import { IncrementalCache } from '../lib/incremental-cache'\n import { RouteMatcher } from '../route-matchers/route-matcher'\n import type { NextFetchEvent } from './spec-extension/fetch-event'\n@@ -15,10 +14,9 @@ import { getServerUtils } from '../server-utils'\n import { searchParamsToUrlQuery } from '../../shared/lib/router/utils/querystring'\n import { CloseController, trackStreamConsumed } from './web-on-close'\n import { getEdgePreviewProps } from './get-edge-preview-props'\n-import type { NextConfigRuntime } from '../config-shared'\n+import { WebNextRequest } from '../../server/base-http/web'\n \n export interface WrapOptions {\n-  nextConfig: NextConfigRuntime\n   page: string\n }\n \n@@ -36,10 +34,7 @@ export class EdgeRouteModuleWrapper {\n    *\n    * @param routeModule the route module to wrap\n    */\n-  private constructor(\n-    private readonly routeModule: AppRouteRouteModule,\n-    private readonly nextConfig: NextConfigRuntime\n-  ) {\n+  private constructor(private readonly routeModule: AppRouteRouteModule) {\n     // TODO: (wyattjoh) possibly allow the module to define it's own matcher\n     this.matcher = new RouteMatcher(routeModule.definition)\n   }\n@@ -58,7 +53,7 @@ export class EdgeRouteModuleWrapper {\n     options: WrapOptions\n   ): EdgeHandler {\n     // Create the module wrapper.\n-    const wrapper = new EdgeRouteModuleWrapper(routeModule, options.nextConfig)\n+    const wrapper = new EdgeRouteModuleWrapper(routeModule)\n \n     // Return the wrapping function.\n     return (opts) => {\n@@ -73,7 +68,7 @@ export class EdgeRouteModuleWrapper {\n   }\n \n   private async handler(\n-    request: NextRequest,\n+    request: NextRequestHint,\n     evt: NextFetchEvent\n   ): Promise<Response> {\n     const utils = getServerUtils({\n@@ -86,6 +81,10 @@ export class EdgeRouteModuleWrapper {\n       caseSensitive: false,\n     })\n \n+    const nextConfig = this.routeModule.getNextConfigEdge(\n+      new WebNextRequest(request)\n+    )\n+\n     const { params } = utils.normalizeDynamicRouteParams(\n       searchParamsToUrlQuery(request.nextUrl.searchParams),\n       false\n@@ -116,7 +115,7 @@ export class EdgeRouteModuleWrapper {\n         experimental: {\n           authInterrupts: !!process.env.__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS,\n         },\n-        cacheLifeProfiles: this.nextConfig.cacheLife,\n+        cacheLifeProfiles: nextConfig.cacheLife,\n       },\n       sharedContext: {\n         buildId: '', // TODO: Populate this properly."
        },
        {
            "sha": "431505ae5165b6811707e29b84c89f5912317556",
            "filename": "packages/next/src/server/web/sandbox/context.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fsandbox%2Fcontext.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fsandbox%2Fcontext.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fsandbox%2Fcontext.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -118,12 +118,11 @@ async function loadWasm(\n function buildEnvironmentVariablesFrom(\n   injectedEnvironments: Record<string, string>\n ): Record<string, string | undefined> {\n-  const pairs = Object.keys(process.env).map((key) => [key, process.env[key]])\n-  const env = Object.fromEntries(pairs)\n-  for (const key of Object.keys(injectedEnvironments)) {\n-    env[key] = injectedEnvironments[key]\n-  }\n-  env.NEXT_RUNTIME = 'edge'\n+  let env = Object.fromEntries([\n+    ...Object.entries(process.env),\n+    ...Object.entries(injectedEnvironments),\n+    ['NEXT_RUNTIME', 'edge'],\n+  ])\n   return env\n }\n "
        },
        {
            "sha": "6840785b651221cbe702d2bbb202aba988c24351",
            "filename": "packages/next/src/shared/lib/constants.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fconstants.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7c969652ad589a62b7d2a90523d919d8a0583192/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fconstants.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fconstants.ts?ref=7c969652ad589a62b7d2a90523d919d8a0583192",
            "patch": "@@ -97,7 +97,7 @@ export const EXPORT_DETAIL = 'export-detail.json'\n export const PRERENDER_MANIFEST = 'prerender-manifest.json'\n export const ROUTES_MANIFEST = 'routes-manifest.json'\n export const IMAGES_MANIFEST = 'images-manifest.json'\n-export const SERVER_FILES_MANIFEST = 'required-server-files.json'\n+export const SERVER_FILES_MANIFEST = 'required-server-files'\n export const DEV_CLIENT_PAGES_MANIFEST = '_devPagesManifest.json'\n export const MIDDLEWARE_MANIFEST = 'middleware-manifest.json'\n export const TURBOPACK_CLIENT_MIDDLEWARE_MANIFEST ="
        }
    ],
    "stats": {
        "total": 220,
        "additions": 116,
        "deletions": 104
    }
}