{
    "author": "timneutkens",
    "message": "Turbopack Build: Fix dynamic-missing-gsp test (#79472)\n\n## What?\n\nFixes the test by changing the path it checks, both webpack and\nturbopack versions are okay, the Turbopack version is better though\nholding the full path root to page.js file.\n\nAlso fixed the test to not add `export const dynamic = undefined` as\nthat is checked in Turbopack as it's not a valid string. This is also a\nbetter error.",
    "sha": "7ccdad985d9ceea9eb13c31f9af1137be810df78",
    "files": [
        {
            "sha": "4af8b928504ce09697b9a8ea54a72b8009cd8881",
            "filename": "test/integration/app-dir-export/test/dynamic-missing-gsp-prod.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/7ccdad985d9ceea9eb13c31f9af1137be810df78/test%2Fintegration%2Fapp-dir-export%2Ftest%2Fdynamic-missing-gsp-prod.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7ccdad985d9ceea9eb13c31f9af1137be810df78/test%2Fintegration%2Fapp-dir-export%2Ftest%2Fdynamic-missing-gsp-prod.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fapp-dir-export%2Ftest%2Fdynamic-missing-gsp-prod.test.ts?ref=7ccdad985d9ceea9eb13c31f9af1137be810df78",
            "patch": "@@ -10,7 +10,7 @@ describe('app dir - with output export - dynamic missing gsp prod', () => {\n           dynamicPage: 'undefined',\n           generateStaticParamsOpt: 'set noop',\n           expectedErrMsg:\n-            'Page \"/another/[slug]\" is missing \"generateStaticParams()\" so it cannot be used with \"output: export\" config.',\n+            /Page \".*\\/another\\/\\[slug\\].*\" is missing \"generateStaticParams\\(\\)\" so it cannot be used with \"output: export\" config\\./,\n         })\n       })\n \n@@ -20,7 +20,7 @@ describe('app dir - with output export - dynamic missing gsp prod', () => {\n           dynamicPage: 'undefined',\n           generateStaticParamsOpt: 'set client',\n           expectedErrMsg:\n-            'Page \"/another/[slug]/page\" cannot use both \"use client\" and export function \"generateStaticParams()\".',\n+            /Page \".*\\/another\\/\\[slug\\]\\/page.*\" cannot use both \"use client\" and export function \"generateStaticParams\\(\\)\"\\./,\n         })\n       })\n     }"
        },
        {
            "sha": "9e4769245b70f9b9fba8a0d1dd47d154385c94f0",
            "filename": "test/integration/app-dir-export/test/utils.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 6,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/7ccdad985d9ceea9eb13c31f9af1137be810df78/test%2Fintegration%2Fapp-dir-export%2Ftest%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7ccdad985d9ceea9eb13c31f9af1137be810df78/test%2Fintegration%2Fapp-dir-export%2Ftest%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fapp-dir-export%2Ftest%2Futils.ts?ref=7ccdad985d9ceea9eb13c31f9af1137be810df78",
            "patch": "@@ -117,25 +117,26 @@ export async function runTests({\n   dynamicParams?: string\n   dynamicApiRoute?: string\n   generateStaticParamsOpt?: 'set noop' | 'set client'\n-  expectedErrMsg?: string\n+  expectedErrMsg?: string | RegExp\n }) {\n   if (trailingSlash !== undefined) {\n     nextConfig.replace(\n       'trailingSlash: true,',\n       `trailingSlash: ${trailingSlash},`\n     )\n   }\n+\n   if (dynamicPage !== undefined) {\n     slugPage.replace(\n-      `const dynamic = 'force-static'`,\n-      `const dynamic = ${dynamicPage}`\n+      `export const dynamic = 'force-static'`,\n+      dynamicPage === 'undefined' ? '' : `export const dynamic = ${dynamicPage}`\n     )\n   }\n \n   if (dynamicApiRoute !== undefined) {\n     apiJson.replace(\n-      `const dynamic = 'force-static'`,\n-      `const dynamic = ${dynamicApiRoute}`\n+      `export const dynamic = 'force-static'`,\n+      `export const dynamic = ${dynamicApiRoute}`\n     )\n   }\n \n@@ -179,7 +180,11 @@ export async function runTests({\n         await assertHasRedbox(browser)\n         const header = await getRedboxHeader(browser)\n         const source = await getRedboxSource(browser)\n-        expect(`${header}\\n${source}`).toContain(expectedErrMsg)\n+        if (expectedErrMsg instanceof RegExp) {\n+          expect(`${header}\\n${source}`).toContain(expectedErrMsg)\n+        } else {\n+          expect(`${header}\\n${source}`).toContain(expectedErrMsg)\n+        }\n       } else {\n         await check(() => result.stderr, /error/i)\n       }"
        },
        {
            "sha": "21ab1105a84d64498052af2c155d0b14eebbbf0f",
            "filename": "test/turbopack-build-tests-manifest.json",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7ccdad985d9ceea9eb13c31f9af1137be810df78/test%2Fturbopack-build-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/7ccdad985d9ceea9eb13c31f9af1137be810df78/test%2Fturbopack-build-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fturbopack-build-tests-manifest.json?ref=7ccdad985d9ceea9eb13c31f9af1137be810df78",
            "patch": "@@ -9305,11 +9305,10 @@\n   },\n   \"test/integration/app-dir-export/test/dynamic-missing-gsp-prod.test.ts\": {\n     \"passed\": [\n-      \"app dir - with output export - dynamic missing gsp prod production mode should error when dynamic route is missing generateStaticParams\"\n-    ],\n-    \"failed\": [\n+      \"app dir - with output export - dynamic missing gsp prod production mode should error when dynamic route is missing generateStaticParams\",\n       \"app dir - with output export - dynamic missing gsp prod production mode should error when client component has generateStaticParams\"\n     ],\n+    \"failed\": [],\n     \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 15,
        "deletions": 11
    }
}