{
    "author": "icyJoseph",
    "message": "docs: rewrite+usePathname+prerender hydration error mitigation (#83462)\n\nCloses:\nhttps://linear.app/vercel/issue/DOC-5040/usepathname-and-rewrites",
    "sha": "7a76e9fa68e0dfad4070177a25e300bd9dc230ee",
    "files": [
        {
            "sha": "139bcb1ccc2a6633e3b601b108b7bc1feaac5fc4",
            "filename": "docs/01-app/03-api-reference/04-functions/use-pathname.mdx",
            "status": "modified",
            "additions": 52,
            "deletions": 0,
            "changes": 52,
            "blob_url": "https://github.com/vercel/next.js/blob/7a76e9fa68e0dfad4070177a25e300bd9dc230ee/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-pathname.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/7a76e9fa68e0dfad4070177a25e300bd9dc230ee/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-pathname.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-pathname.mdx?ref=7a76e9fa68e0dfad4070177a25e300bd9dc230ee",
            "patch": "@@ -65,6 +65,7 @@ const pathname = usePathname()\n ```tsx filename=\"app/example-client-component.tsx\" switcher\n 'use client'\n \n+import { useEffect } from 'react'\n import { usePathname, useSearchParams } from 'next/navigation'\n \n function ExampleClientComponent() {\n@@ -79,6 +80,7 @@ function ExampleClientComponent() {\n ```jsx filename=\"app/example-client-component.js\" switcher\n 'use client'\n \n+import { useEffect } from 'react'\n import { usePathname, useSearchParams } from 'next/navigation'\n \n function ExampleClientComponent() {\n@@ -90,6 +92,56 @@ function ExampleClientComponent() {\n }\n ```\n \n+### Avoid hydration mismatch with rewrites\n+\n+When a page is pre-rendered, the HTML is generated for the source pathname. If the page is then reached through a rewrite using `next.config` or `Middleware`, the browser URL may differ, and `usePathname()` will read the rewritten pathname on the client.\n+\n+To avoid hydration mismatches, design the UI so that only a small, isolated part depends on the client pathname. Render a stable fallback on the server and update that part after mount.\n+\n+```tsx filename=\"app/example-client-component.tsx\" switcher\n+'use client'\n+\n+import { useEffect, useState } from 'react'\n+import { usePathname } from 'next/navigation'\n+\n+export default function PathnameBadge() {\n+  const pathname = usePathname()\n+  const [clientPathname, setClientPathname] = useState('')\n+\n+  useEffect(() => {\n+    setClientPathname(pathname)\n+  }, [pathname])\n+\n+  return (\n+    <p>\n+      Current pathname: <span>{clientPathname}</span>\n+    </p>\n+  )\n+}\n+```\n+\n+```jsx filename=\"app/example-client-component.js\" switcher\n+'use client'\n+\n+import { useEffect, useState } from 'react'\n+import { usePathname } from 'next/navigation'\n+\n+export default function PathnameBadge() {\n+  const pathname = usePathname()\n+  const [clientPathname, setClientPathname] = useState('')\n+\n+  useEffect(() => {\n+    setClientPathname(pathname)\n+  }, [pathname])\n+\n+  return (\n+    <p>\n+      Current pathname: <span>{clientPathname}</span>\n+    </p>\n+  )\n+}\n+```\n+\n | Version   | Changes                   |\n | --------- | ------------------------- |\n | `v13.0.0` | `usePathname` introduced. |"
        }
    ],
    "stats": {
        "total": 52,
        "additions": 52,
        "deletions": 0
    }
}