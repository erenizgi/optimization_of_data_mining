{
    "author": "bgw",
    "message": "Turbopack: bincode: Implement bincode Encode/Decode traits on all turbo task values (#85580)\n\nIt looks like bincode should reduce the filesystem cache size by ~10% versus pot, because its not a self-describing format. This attempts to add the `bincode::Encode`/`bincode::Decode` traits everywhere, so that we can use those instead of serde.\n\n## Why not use bincode's serde compatibility feature?\n\n- Unfortunately, serde has some bugs/incompatibilities/footguns with non-self-describing formats. `bincode`'s traits avoid this by not exposing features that would be incompatible with a self-describing format. https://docs.rs/bincode/latest/bincode/serde/index.html#known-issues\n- `bincode::Encode`/`Decode` are much simpler traits than serde's equivalents, so we'll probably get some rustc build performance and turbopack binary size benefits from using the bincode versions. In cases where we do have to implement these traits by hand, it's much easier than implementing the serde equivalents.\n- I'd like to kill `erased-serde` anyways because we're probably paying some performance cost from the large amounts of dynamic dispatch it performs, and we're not getting any benefits from it if we only ever serialize to a single format.\n\n## Forks of Upstream Crates\n\n- I've forked `bincode` here: https://github.com/bgw/bincode/commits/bgw/patches/\n  - I submitted a patch via email to the maintainer via sourcehut\n    - Upstream: https://git.sr.ht/~stygianentity/bincode\n    - Fork: https://git.sr.ht/~bgw/bincode\n  - This adds a few extra derive features and fixes type bounds on `PhantomData`.\n  - The type bounds on `PhantomData` aren't very important, and we could work around it in our code.\n  - We could just fork the derive crate if upstream doesn't want to accept the patches.\n- And `virtue` here: https://github.com/bgw/virtue/commit/e386f35cf7f22d04a4db32231904cbe5dc52c01d\n  - I've submitted a PR to `virtue` here: https://github.com/bincode-org/virtue/pull/94\n  - This fixes a bug in the parsing of const enums and generics with defaults.\n  - We don't hit this very often as most of our types are not generics, so we could work around it in our code if upstream doesn't want to accept the patch.\n\n## Other Notes\n\n- Depends on a patched version of the `bincode` and `virtue` crates to fix a few bugs and add a few new features. I'll work on upstreaming these changes.\n- This implements `BorrowDecode` everywhere because the `bincode::Decode` derive macro requires it. I plan to add an attribute in my bincode fork to allow disabling this, and then we can get rid of all of the `BorrowDecode` impls. We don't want/need `BorrowDecode` for turbo task values because everything needs to be owned anyways.",
    "sha": "2931550ebbf8b547304d3bccebcb5606700460fc",
    "files": [
        {
            "sha": "3063273609c6cdb898971efbe56a286fe8cc3958",
            "filename": "Cargo.lock",
            "status": "modified",
            "additions": 39,
            "deletions": 2,
            "changes": 41,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/Cargo.lock",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/Cargo.lock",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.lock?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -394,6 +394,7 @@ checksum = \"1505bd5d3d116872e7271a6d4e16d81d0c8570876c8de68093a09ac269d8aac0\"\n name = \"auto-hash-map\"\n version = \"0.1.0\"\n dependencies = [\n+ \"bincode 2.0.1\",\n  \"hashbrown 0.14.5\",\n  \"rustc-hash 2.1.1\",\n  \"serde\",\n@@ -4261,6 +4262,7 @@ name = \"next-api\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"byteorder\",\n  \"either\",\n  \"futures\",\n@@ -4275,6 +4277,7 @@ dependencies = [\n  \"tempfile\",\n  \"tokio\",\n  \"tracing\",\n+ \"turbo-bincode\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-backend\",\n@@ -4337,6 +4340,7 @@ dependencies = [\n  \"anyhow\",\n  \"async-trait\",\n  \"base64 0.21.4\",\n+ \"bincode 2.0.1\",\n  \"either\",\n  \"futures\",\n  \"indexmap 2.9.0\",\n@@ -4361,6 +4365,7 @@ dependencies = [\n  \"swc_sourcemap\",\n  \"thiserror 1.0.69\",\n  \"tracing\",\n+ \"turbo-bincode\",\n  \"turbo-esregex\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n@@ -4425,6 +4430,7 @@ name = \"next-swc-napi\"\n version = \"0.0.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"console-subscriber\",\n  \"dhat\",\n  \"either\",\n@@ -6762,7 +6768,9 @@ version = \"1.15.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"67b1b7a3b5fe4f1376887184045fcf45c69e92af734b7aaddc05fb777b6fbd03\"\n dependencies = [\n+ \"bincode 2.0.1\",\n  \"serde\",\n+ \"unty\",\n ]\n \n [[package]]\n@@ -9108,6 +9116,7 @@ name = \"turbo-esregex\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"regex\",\n  \"regress\",\n  \"serde\",\n@@ -9156,6 +9165,7 @@ version = \"0.1.0\"\n name = \"turbo-rcstr\"\n version = \"0.1.0\"\n dependencies = [\n+ \"bincode 2.0.1\",\n  \"bytes-str\",\n  \"codspeed-criterion-compat\",\n  \"napi\",\n@@ -9195,6 +9205,7 @@ dependencies = [\n  \"anyhow\",\n  \"async-trait\",\n  \"auto-hash-map\",\n+ \"bincode 2.0.1\",\n  \"codspeed-criterion-compat\",\n  \"concurrent-queue\",\n  \"dashmap 6.1.0\",\n@@ -9234,6 +9245,7 @@ dependencies = [\n  \"anyhow\",\n  \"arc-swap\",\n  \"auto-hash-map\",\n+ \"bincode 2.0.1\",\n  \"bitfield\",\n  \"byteorder\",\n  \"codspeed-criterion-compat\",\n@@ -9287,6 +9299,7 @@ name = \"turbo-tasks-bytes\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"bytes\",\n  \"futures\",\n  \"serde\",\n@@ -9301,6 +9314,7 @@ version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n  \"dotenvs\",\n+ \"turbo-bincode\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-fs\",\n@@ -9331,6 +9345,7 @@ version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n  \"auto-hash-map\",\n+ \"bincode 2.0.1\",\n  \"bitflags 1.3.2\",\n  \"bytes\",\n  \"codspeed-criterion-compat\",\n@@ -9356,6 +9371,7 @@ dependencies = [\n  \"tokio\",\n  \"tracing\",\n  \"triomphe 0.1.12\",\n+ \"turbo-bincode\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-backend\",\n@@ -9446,6 +9462,7 @@ name = \"turbopack\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"either\",\n  \"regex\",\n  \"rustc-hash 2.1.1\",\n@@ -9478,6 +9495,7 @@ name = \"turbopack-analyze\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"rustc-hash 2.1.1\",\n  \"serde\",\n  \"serde_json\",\n@@ -9521,12 +9539,14 @@ name = \"turbopack-browser\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"either\",\n  \"indoc\",\n  \"serde\",\n  \"serde_json\",\n  \"serde_qs\",\n  \"tracing\",\n+ \"turbo-bincode\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-fs\",\n@@ -9604,6 +9624,7 @@ dependencies = [\n  \"anyhow\",\n  \"async-trait\",\n  \"auto-hash-map\",\n+ \"bincode 2.0.1\",\n  \"bitfield\",\n  \"browserslist-rs\",\n  \"bytes-str\",\n@@ -9627,6 +9648,7 @@ dependencies = [\n  \"swc_sourcemap\",\n  \"tokio\",\n  \"tracing\",\n+ \"turbo-bincode\",\n  \"turbo-prehash\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n@@ -9659,6 +9681,7 @@ name = \"turbopack-css\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"indoc\",\n  \"lightningcss\",\n  \"parcel_selectors\",\n@@ -9669,6 +9692,7 @@ dependencies = [\n  \"swc_core\",\n  \"tokio\",\n  \"tracing\",\n+ \"turbo-bincode\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-fs\",\n@@ -9683,6 +9707,7 @@ version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n  \"auto-hash-map\",\n+ \"bincode 2.0.1\",\n  \"flate2\",\n  \"futures\",\n  \"hyper 0.14.32\",\n@@ -9700,6 +9725,7 @@ dependencies = [\n  \"tokio-stream\",\n  \"tokio-util\",\n  \"tracing\",\n+ \"turbo-bincode\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-backend\",\n@@ -9720,6 +9746,7 @@ dependencies = [\n  \"anyhow\",\n  \"async-trait\",\n  \"auto-hash-map\",\n+ \"bincode 2.0.1\",\n  \"bytes-str\",\n  \"codspeed-criterion-compat\",\n  \"dashmap 6.1.0\",\n@@ -9743,6 +9770,7 @@ dependencies = [\n  \"swc_sourcemap\",\n  \"tokio\",\n  \"tracing\",\n+ \"turbo-bincode\",\n  \"turbo-esregex\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n@@ -9775,6 +9803,7 @@ version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n  \"async-trait\",\n+ \"bincode 2.0.1\",\n  \"indexmap 2.9.0\",\n  \"rustc-hash 2.1.1\",\n  \"serde\",\n@@ -9827,13 +9856,15 @@ version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n  \"base64 0.21.4\",\n+ \"bincode 2.0.1\",\n  \"image\",\n  \"mime\",\n  \"once_cell\",\n  \"regex\",\n  \"rustc-hash 2.1.1\",\n  \"serde\",\n  \"serde_with\",\n+ \"turbo-bincode\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-fs\",\n@@ -9902,6 +9933,7 @@ dependencies = [\n  \"async-stream\",\n  \"async-trait\",\n  \"base64 0.21.4\",\n+ \"bincode 2.0.1\",\n  \"const_format\",\n  \"either\",\n  \"futures\",\n@@ -9917,6 +9949,7 @@ dependencies = [\n  \"serde_with\",\n  \"tokio\",\n  \"tracing\",\n+ \"turbo-bincode\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-bytes\",\n@@ -9933,8 +9966,10 @@ name = \"turbopack-nodejs\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"indoc\",\n  \"tracing\",\n+ \"turbo-bincode\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-fs\",\n@@ -9992,6 +10027,7 @@ name = \"turbopack-test-utils\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"once_cell\",\n  \"regex\",\n  \"rustc-hash 2.1.1\",\n@@ -10010,6 +10046,7 @@ name = \"turbopack-tests\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"dunce\",\n  \"once_cell\",\n  \"rustc-hash 2.1.1\",\n@@ -10109,6 +10146,7 @@ name = \"turbopack-wasm\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"bincode 2.0.1\",\n  \"indoc\",\n  \"serde\",\n  \"turbo-rcstr\",\n@@ -10465,8 +10503,7 @@ dependencies = [\n [[package]]\n name = \"virtue\"\n version = \"0.0.18\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"051eb1abcf10076295e815102942cc58f9d5e3b4560e46e53c21e8ff6f3af7b1\"\n+source = \"git+https://github.com/bgw/virtue.git?branch=bgw%2Ffix-generic-default-parsing#e386f35cf7f22d04a4db32231904cbe5dc52c01d\"\n \n [[package]]\n name = \"vlq\""
        },
        {
            "sha": "c2b800457f2f89f09bfc8147665adab877d9f520",
            "filename": "Cargo.toml",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/Cargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/Cargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -451,11 +451,12 @@ serde_bytes = \"0.11.15\"\n serde_path_to_error = \"0.1.16\"\n serde_qs = \"0.13.0\"\n serde_with = \"3.12.0\"\n-smallvec = { version = \"1.13.1\", features = [\n+smallvec = { version = \"1.15.1\", features = [\n   \"serde\",\n   \"const_generics\",\n   \"union\",\n   \"const_new\",\n+  \"impl_bincode\",\n ] }\n swc_sourcemap = \"9.3.4\"\n strsim = \"0.11.1\"\n@@ -481,4 +482,5 @@ inventory = \"0.3.21\"\n \n [patch.crates-io]\n bincode = { git = \"https://github.com/bgw/bincode.git\", branch = \"bgw/patches\" }\n+virtue = { git = \"https://github.com/bgw/virtue.git\", branch = \"bgw/fix-generic-default-parsing\" }\n mdxjs = { git = \"https://github.com/mischnic/mdxjs-rs.git\", branch = \"swc-core-32\" }"
        },
        {
            "sha": "f754b9ab80b847ea5b34c4e422997ee62511b410",
            "filename": "crates/napi/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnapi%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnapi%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnapi%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -56,6 +56,7 @@ ignored = [\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n console-subscriber = { workspace = true, optional = true }\n dhat = { workspace = true, optional = true }\n either = { workspace = true }"
        },
        {
            "sha": "8072d62ebebebe2d572ad9c5670dbd45c627b84b",
            "filename": "crates/napi/src/next_api/project.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{borrow::Cow, io::Write, path::PathBuf, sync::Arc, thread, time::Duration};\n \n use anyhow::{Context, Result, anyhow, bail};\n+use bincode::{Decode, Encode};\n use flate2::write::GzEncoder;\n use futures_util::TryFutureExt;\n use napi::{\n@@ -1528,6 +1529,8 @@ pub fn project_compilation_events_subscribe(\n     Serialize,\n     TaskInput,\n     TraceRawVcs,\n+    Encode,\n+    Decode,\n )]\n pub struct StackFrame {\n     pub is_server: bool,"
        },
        {
            "sha": "c5f733031a0bf42f5a53bc25ac9075dc744921f7",
            "filename": "crates/next-api/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -14,6 +14,7 @@ workspace = true\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n byteorder = { workspace = true }\n either = { workspace = true }\n futures = { workspace = true }\n@@ -26,6 +27,7 @@ serde = { workspace = true }\n serde_json = { workspace = true }\n swc_core = { workspace = true }\n tracing = { workspace = true }\n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-hash = { workspace = true }"
        },
        {
            "sha": "28176108990e755ebaeebf2523de54fe8b493aa2",
            "filename": "crates/next-api/src/app.rs",
            "status": "modified",
            "additions": 17,
            "deletions": 2,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fapp.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fapp.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fapp.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use next_core::{\n     app_structure::{\n         AppPageLoaderTree, CollectedRootParams, Entrypoint as AppEntrypoint,\n@@ -1068,13 +1069,27 @@ pub fn app_entry_point_to_route(\n #[turbo_tasks::value(transparent)]\n struct OutputAssetsWithAvailability((ResolvedVc<OutputAssets>, AvailabilityInfo));\n \n-#[derive(Copy, Clone, Serialize, Deserialize, PartialEq, Eq, Debug, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Copy,\n+    Clone,\n+    Serialize,\n+    Deserialize,\n+    PartialEq,\n+    Eq,\n+    Debug,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n enum AppPageEndpointType {\n     Html,\n     Rsc,\n }\n \n-#[derive(Clone, Serialize, Deserialize, PartialEq, Eq, Debug, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Clone, Serialize, Deserialize, PartialEq, Eq, Debug, TraceRawVcs, NonLocalValue, Encode, Decode,\n+)]\n enum AppEndpointType {\n     Page {\n         ty: AppPageEndpointType,"
        },
        {
            "sha": "1d1f5dc84bd7a82925508ab491eb861d8e119e2f",
            "filename": "crates/next-api/src/client_references.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fclient_references.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fclient_references.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fclient_references.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use next_core::{\n     next_client_reference::{CssClientReferenceModule, EcmascriptClientReferenceModule},\n     next_server_component::server_component_module::NextServerComponentModule,\n@@ -12,7 +13,17 @@ use turbopack_core::{module::Module, module_graph::SingleModuleGraph};\n use turbopack_css::chunk::CssChunkPlaceable;\n \n #[derive(\n-    Copy, Clone, Serialize, Deserialize, Eq, PartialEq, TraceRawVcs, ValueDebugFormat, NonLocalValue,\n+    Copy,\n+    Clone,\n+    Serialize,\n+    Deserialize,\n+    Eq,\n+    PartialEq,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ClientManifestEntryType {\n     EcmascriptClientReference {"
        },
        {
            "sha": "42cc6be791f24d573f30338703d031249a90374c",
            "filename": "crates/next-api/src/dynamic_imports.rs",
            "status": "modified",
            "additions": 14,
            "deletions": 2,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fdynamic_imports.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fdynamic_imports.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fdynamic_imports.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -20,6 +20,7 @@\n //!      won't occur\n \n use anyhow::{Context, Result};\n+use bincode::{Decode, Encode};\n use next_core::{\n     next_app::ClientReferencesChunks, next_client_reference::EcmascriptClientReferenceModule,\n     next_dynamic::NextDynamicEntryModule,\n@@ -102,14 +103,24 @@ pub(crate) async fn collect_next_dynamic_chunks(\n #[turbo_tasks::value(transparent)]\n #[derive(Default)]\n pub struct DynamicImportedChunks(\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub  FxIndexMap<\n         ResolvedVc<NextDynamicEntryModule>,\n         (ResolvedVc<ModuleId>, ResolvedVc<OutputAssetsWithReferenced>),\n     >,\n );\n \n #[derive(\n-    Clone, PartialEq, Eq, ValueDebugFormat, Serialize, Deserialize, TraceRawVcs, NonLocalValue,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    ValueDebugFormat,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum DynamicImportEntriesMapType {\n     DynamicEntry(ResolvedVc<NextDynamicEntryModule>),\n@@ -118,7 +129,8 @@ pub enum DynamicImportEntriesMapType {\n \n #[turbo_tasks::value(transparent)]\n pub struct DynamicImportEntries(\n-    pub FxIndexMap<ResolvedVc<Box<dyn Module>>, DynamicImportEntriesMapType>,\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    pub  FxIndexMap<ResolvedVc<Box<dyn Module>>, DynamicImportEntriesMapType>,\n );\n \n #[turbo_tasks::function]"
        },
        {
            "sha": "732e82d60bfc9ef6c7c7d1d86cd5e7b6741cbc53",
            "filename": "crates/next-api/src/entrypoints.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fentrypoints.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fentrypoints.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fentrypoints.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -8,6 +8,7 @@ use crate::{\n \n #[turbo_tasks::value(shared)]\n pub struct Entrypoints {\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub routes: FxIndexMap<RcStr, Route>,\n     pub middleware: Option<Middleware>,\n     pub instrumentation: Option<Instrumentation>,"
        },
        {
            "sha": "4c17ec4b0d63ffd0f60ec74b07d255d36203ff26",
            "filename": "crates/next-api/src/module_graph.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fmodule_graph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fmodule_graph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fmodule_graph.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -761,7 +761,7 @@ impl Issue for CssGlobalImportIssue {\n type FxModuleNameMap = FxIndexMap<ResolvedVc<Box<dyn Module>>, RcStr>;\n \n #[turbo_tasks::value(transparent)]\n-struct ModuleNameMap(pub FxModuleNameMap);\n+struct ModuleNameMap(#[bincode(with = \"turbo_bincode::indexmap\")] pub FxModuleNameMap);\n \n #[tracing::instrument(level = \"info\", name = \"validate pages css imports\", skip_all)]\n #[turbo_tasks::function]"
        },
        {
            "sha": "f201bf4d7a3cb9c735cfde8ac552176f3d32662b",
            "filename": "crates/next-api/src/next_server_nft.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fnext_server_nft.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fnext_server_nft.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fnext_server_nft.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::collections::BTreeSet;\n \n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use either::Either;\n use next_core::{get_next_package, next_server::get_tracing_compile_time_info};\n use serde::{Deserialize, Serialize};\n@@ -31,7 +32,18 @@ use crate::{\n };\n \n #[derive(\n-    PartialEq, Eq, TraceRawVcs, NonLocalValue, Deserialize, Serialize, Debug, Clone, Hash, TaskInput,\n+    PartialEq,\n+    Eq,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Deserialize,\n+    Serialize,\n+    Debug,\n+    Clone,\n+    Hash,\n+    TaskInput,\n+    Encode,\n+    Decode,\n )]\n enum ServerNftType {\n     Minimal,"
        },
        {
            "sha": "316939bf1a46f0060cf4553ab6a26317034afda7",
            "filename": "crates/next-api/src/operation.rs",
            "status": "modified",
            "additions": 26,
            "deletions": 2,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Foperation.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Foperation.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Foperation.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n@@ -22,6 +23,7 @@ use crate::{\n /// This is needed to call `write_to_disk` which expects an `OperationVc<Endpoint>`.\n #[turbo_tasks::value(shared)]\n pub struct EntrypointsOperation {\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub routes: FxIndexMap<RcStr, RouteOperation>,\n     pub middleware: Option<MiddlewareOperation>,\n     pub instrumentation: Option<InstrumentationOperation>,\n@@ -204,13 +206,33 @@ async fn pick_endpoint(\n     Ok(Vc::cell(endpoint))\n }\n \n-#[derive(Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, ValueDebugFormat, NonLocalValue)]\n+#[derive(\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    PartialEq,\n+    Eq,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub struct InstrumentationOperation {\n     pub node_js: OperationVc<OptionEndpoint>,\n     pub edge: OperationVc<OptionEndpoint>,\n }\n \n-#[derive(Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, ValueDebugFormat, NonLocalValue)]\n+#[derive(\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    PartialEq,\n+    Eq,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub struct MiddlewareOperation {\n     pub endpoint: OperationVc<OptionEndpoint>,\n     pub is_proxy: bool,\n@@ -244,6 +266,8 @@ pub enum RouteOperation {\n     Clone,\n     Debug,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct AppPageRouteOperation {\n     pub original_name: RcStr,"
        },
        {
            "sha": "5ff3a9b596a1ff0791e24e0badd39d278fe50405",
            "filename": "crates/next-api/src/pages.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fpages.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use futures::future::BoxFuture;\n use next_core::{\n     PageLoaderAsset, create_page_loader_entry_module, get_asset_path_from_pathname,\n@@ -597,6 +598,8 @@ struct PageEndpoint {\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n enum PageEndpointType {\n     Api,"
        },
        {
            "sha": "5c4737815b562896cb7fc792fd742ca0896692d4",
            "filename": "crates/next-api/src/project.rs",
            "status": "modified",
            "additions": 31,
            "deletions": 2,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fproject.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fproject.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fproject.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::time::Duration;\n \n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use indexmap::map::Entry;\n use next_core::{\n     app_structure::find_app_dir,\n@@ -105,6 +106,8 @@ use crate::{\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct DraftModeOptions {\n@@ -127,6 +130,8 @@ pub struct DraftModeOptions {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct WatchOptions {\n@@ -150,6 +155,8 @@ pub struct WatchOptions {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct ProjectOptions {\n@@ -263,6 +270,8 @@ pub struct PartialProjectOptions {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct DefineEnv {\n@@ -271,13 +280,33 @@ pub struct DefineEnv {\n     pub nodejs: Vec<(RcStr, Option<RcStr>)>,\n }\n \n-#[derive(Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, ValueDebugFormat, NonLocalValue)]\n+#[derive(\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    PartialEq,\n+    Eq,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub struct Middleware {\n     pub endpoint: ResolvedVc<Box<dyn Endpoint>>,\n     pub is_proxy: bool,\n }\n \n-#[derive(Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, ValueDebugFormat, NonLocalValue)]\n+#[derive(\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    PartialEq,\n+    Eq,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub struct Instrumentation {\n     pub node_js: ResolvedVc<Box<dyn Endpoint>>,\n     pub edge: ResolvedVc<Box<dyn Endpoint>>,"
        },
        {
            "sha": "3fcebe19f5f9a97db2b34e7a6fdf4f9ba694b54f",
            "filename": "crates/next-api/src/route.rs",
            "status": "modified",
            "additions": 10,
            "deletions": 1,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Froute.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Froute.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Froute.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::fmt::Display;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n@@ -24,6 +25,8 @@ use crate::{operation::OptionEndpoint, paths::ServerPath, project::Project};\n     Clone,\n     Debug,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct AppPageRoute {\n     pub original_name: RcStr,\n@@ -84,6 +87,8 @@ pub trait Endpoint {\n     Clone,\n     Debug,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum EndpointGroupKey {\n     Instrumentation,\n@@ -133,6 +138,8 @@ impl Display for EndpointGroupKey {\n     Clone,\n     Debug,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct EndpointGroupEntry {\n     pub endpoint: ResolvedVc<Box<dyn Endpoint>>,\n@@ -149,6 +156,8 @@ pub struct EndpointGroupEntry {\n     Clone,\n     Debug,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct EndpointGroup {\n     pub primary: Vec<EndpointGroupEntry>,\n@@ -309,4 +318,4 @@ pub enum EndpointOutputPaths {\n /// The routes as map from pathname to route. (pathname includes the leading\n /// slash)\n #[turbo_tasks::value(transparent)]\n-pub struct Routes(FxIndexMap<RcStr, Route>);\n+pub struct Routes(#[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<RcStr, Route>);"
        },
        {
            "sha": "189c8a2fd05cd8ec99d76e67e0bd22148d5e41d0",
            "filename": "crates/next-api/src/server_actions.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fserver_actions.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fserver_actions.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fserver_actions.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -434,6 +434,7 @@ impl AllActions {\n #[turbo_tasks::value]\n #[derive(Debug)]\n pub struct ActionMap {\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub actions: FxIndexMap<String, String>,\n     pub entry_path: String,\n     pub entry_query: String,\n@@ -446,7 +447,10 @@ struct OptionActionMap(Option<ResolvedVc<ActionMap>>);\n type LayerAndActions = (ActionLayer, ResolvedVc<ActionMap>);\n /// A mapping of every module module containing Server Actions, mapping to its layer and actions.\n #[turbo_tasks::value(transparent)]\n-pub struct AllModuleActions(FxIndexMap<ResolvedVc<Box<dyn Module>>, LayerAndActions>);\n+pub struct AllModuleActions(\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    FxIndexMap<ResolvedVc<Box<dyn Module>>, LayerAndActions>,\n+);\n \n #[turbo_tasks::function]\n pub async fn map_server_actions(graph: Vc<SingleModuleGraph>) -> Result<Vc<AllModuleActions>> {"
        },
        {
            "sha": "0c9538149d387cbb9848bce38c9614ab20b21a7a",
            "filename": "crates/next-api/src/versioned_content_map.rs",
            "status": "modified",
            "additions": 46,
            "deletions": 8,
            "changes": 54,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fversioned_content_map.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-api%2Fsrc%2Fversioned_content_map.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fversioned_content_map.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use next_core::emit_assets;\n use rustc_hash::{FxHashMap, FxHashSet};\n use serde::{Deserialize, Serialize};\n@@ -25,6 +26,8 @@ use turbopack_core::{\n     Deserialize,\n     Debug,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n struct MapEntry {\n     assets_operation: OperationVc<ExpandedOutputAssets>,\n@@ -38,19 +41,48 @@ unsafe impl OperationValue for MapEntry {}\n #[turbo_tasks::value(transparent, operation)]\n struct OptionMapEntry(Option<MapEntry>);\n \n-#[turbo_tasks::value]\n-#[derive(Debug)]\n+#[derive(\n+    Clone,\n+    TraceRawVcs,\n+    PartialEq,\n+    Eq,\n+    ValueDebugFormat,\n+    Serialize,\n+    Deserialize,\n+    Debug,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub struct PathToOutputOperation(\n     /// We need to use an operation for outputs as it's stored for later usage and we want to\n     /// reconnect this operation when it's received from the map again.\n     ///\n-    /// It may not be 100% correct for the key (`FileSystemPath`) to be in a `ResolvedVc` here, but\n-    /// it's impractical to make it an `OperationVc`/`OperationValue`, and it's unlikely to\n+    /// It may not be 100% correct for the key (`FileSystemPath`) to contain a `ResolvedVc` here,\n+    /// but it's impractical to make it an `OperationVc`/`OperationValue`, and it's unlikely to\n     /// change/break?\n-    FxHashMap<FileSystemPath, FxIndexSet<OperationVc<ExpandedOutputAssets>>>,\n+    FxHashMap<FileSystemPath, ExpandedOutputAssetsOperationSet>,\n );\n \n-// HACK: This is technically incorrect because the map's key is a `ResolvedVc`...\n+#[derive(\n+    Clone,\n+    Default,\n+    TraceRawVcs,\n+    PartialEq,\n+    Eq,\n+    ValueDebugFormat,\n+    Serialize,\n+    Deserialize,\n+    Debug,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n+struct ExpandedOutputAssetsOperationSet(\n+    #[bincode(with = \"turbo_bincode::indexset\")] FxIndexSet<OperationVc<ExpandedOutputAssets>>,\n+);\n+\n+// HACK: This is technically incorrect because the map's key contains a `ResolvedVc`...\n unsafe impl OperationValue for PathToOutputOperation {}\n \n // A precomputed map for quick access to output asset by filepath\n@@ -133,7 +165,12 @@ impl VersionedContentMap {\n             let mut stale_assets = map.0.keys().cloned().collect::<FxHashSet<_>>();\n \n             for (k, _) in entries.iter().flatten() {\n-                let res = map.0.entry(k.clone()).or_default().insert(assets_operation);\n+                let res = map\n+                    .0\n+                    .entry(k.clone())\n+                    .or_default()\n+                    .0\n+                    .insert(assets_operation);\n                 stale_assets.remove(k);\n                 changed = changed || res;\n             }\n@@ -145,6 +182,7 @@ impl VersionedContentMap {\n                     .get_mut(k)\n                     // guaranteed\n                     .unwrap()\n+                    .0\n                     .swap_remove(&assets_operation);\n                 changed = changed || res\n             }\n@@ -235,7 +273,7 @@ impl VersionedContentMap {\n     fn raw_get(&self, path: FileSystemPath) -> Vc<OptionMapEntry> {\n         let assets = {\n             let map = &self.map_path_to_op.get().0;\n-            map.get(&path).and_then(|m| m.iter().next().copied())\n+            map.get(&path).and_then(|m| m.0.iter().next().copied())\n         };\n         let Some(assets) = assets else {\n             return Vc::cell(None);"
        },
        {
            "sha": "a02c6bdae134eeccd31fb7aa13a8b6cb0c28df26",
            "filename": "crates/next-core/Cargo.toml",
            "status": "modified",
            "additions": 15,
            "deletions": 13,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -15,27 +15,28 @@ workspace = true\n anyhow = { workspace = true }\n async-trait = { workspace = true }\n base64 = \"0.21.0\"\n+allsorts = { workspace = true }\n+bincode = { workspace = true }\n either = { workspace = true, features = [\"serde\"] }\n+futures = { workspace = true }\n+indexmap = { workspace = true, features = [\"serde\"] }\n+indoc = { workspace = true }\n+itertools = { workspace = true }\n+mime_guess = \"2.0.4\"\n once_cell = { workspace = true }\n+percent-encoding = \"2.3.1\"\n qstring = { workspace = true }\n+react_remove_properties = { workspace = true }\n regex = { workspace = true }\n-serde = { workspace = true }\n-serde_json = { workspace = true }\n-indexmap = { workspace = true, features = [\"serde\"] }\n-mime_guess = \"2.0.4\"\n-indoc = { workspace = true }\n-allsorts = { workspace = true }\n-futures = { workspace = true }\n-thiserror = { workspace = true }\n-tracing = { workspace = true }\n regress = { workspace = true }\n-rustc-hash = { workspace = true }\n-react_remove_properties = { workspace = true }\n remove_console = { workspace = true }\n-itertools = { workspace = true }\n-percent-encoding = \"2.3.1\"\n+rustc-hash = { workspace = true }\n+serde = { workspace = true }\n+serde_json = { workspace = true }\n serde_path_to_error = { workspace = true }\n swc_sourcemap = { workspace = true }\n+thiserror = { workspace = true }\n+tracing = { workspace = true }\n \n swc_core = { workspace = true, features = [\n   \"base\",\n@@ -59,6 +60,7 @@ modularize_imports = { workspace = true }\n next-custom-transforms = { workspace = true }\n next-taskless = { workspace = true }\n \n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-esregex = { workspace = true }\n turbo-tasks = { workspace = true }"
        },
        {
            "sha": "0e39928fd58e1fa15711ecdc0f6ed8a7f2adcf34",
            "filename": "crates/next-core/src/app_structure.rs",
            "status": "modified",
            "additions": 34,
            "deletions": 5,
            "changes": 39,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fapp_structure.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fapp_structure.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fapp_structure.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::collections::BTreeMap;\n \n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use indexmap::map::{Entry, OccupiedEntry};\n use rustc_hash::FxHashMap;\n use serde::{Deserialize, Serialize};\n@@ -86,7 +87,9 @@ impl AppDirModules {\n }\n \n /// A single metadata file plus an optional \"alt\" text file.\n-#[derive(Clone, Debug, Serialize, Deserialize, PartialEq, Eq, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Clone, Debug, Serialize, Deserialize, PartialEq, Eq, TraceRawVcs, NonLocalValue, Encode, Decode,\n+)]\n pub enum MetadataWithAltItem {\n     Static {\n         path: FileSystemPath,\n@@ -99,7 +102,18 @@ pub enum MetadataWithAltItem {\n \n /// A single metadata file.\n #[derive(\n-    Clone, Debug, Hash, Serialize, Deserialize, PartialEq, Eq, TaskInput, TraceRawVcs, NonLocalValue,\n+    Clone,\n+    Debug,\n+    Hash,\n+    Serialize,\n+    Deserialize,\n+    PartialEq,\n+    Eq,\n+    TaskInput,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum MetadataItem {\n     Static { path: FileSystemPath },\n@@ -146,7 +160,17 @@ impl From<MetadataWithAltItem> for MetadataItem {\n \n /// Metadata file that can be placed in any segment of the app directory.\n #[derive(\n-    Default, Clone, Debug, Serialize, Deserialize, PartialEq, Eq, TraceRawVcs, NonLocalValue,\n+    Default,\n+    Clone,\n+    Debug,\n+    Serialize,\n+    Deserialize,\n+    PartialEq,\n+    Eq,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct Metadata {\n     #[serde(skip_serializing_if = \"Vec::is_empty\", default)]\n@@ -412,6 +436,7 @@ async fn get_directory_tree_internal(\n pub struct AppPageLoaderTree {\n     pub page: AppPage,\n     pub segment: RcStr,\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub parallel_routes: FxIndexMap<RcStr, AppPageLoaderTree>,\n     pub modules: AppDirModules,\n     pub global_metadata: ResolvedVc<GlobalMetadata>,\n@@ -516,6 +541,8 @@ impl ValueDefault for FileSystemPathVec {\n     Debug,\n     TaskInput,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum Entrypoint {\n     AppPage {\n@@ -554,7 +581,9 @@ impl Entrypoint {\n }\n \n #[turbo_tasks::value(transparent)]\n-pub struct Entrypoints(FxIndexMap<AppPath, Entrypoint>);\n+pub struct Entrypoints(\n+    #[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<AppPath, Entrypoint>,\n+);\n \n fn is_parallel_route(name: &str) -> bool {\n     name.starts_with('@')\n@@ -768,7 +797,7 @@ pub fn get_entrypoints(\n }\n \n #[turbo_tasks::value(transparent)]\n-pub struct CollectedRootParams(FxIndexSet<RcStr>);\n+pub struct CollectedRootParams(#[bincode(with = \"turbo_bincode::indexset\")] FxIndexSet<RcStr>);\n \n #[turbo_tasks::function]\n pub async fn collect_root_params("
        },
        {
            "sha": "b5f04dae8db0c094e54e69f71a33dccc5667fc1f",
            "filename": "crates/next-core/src/bootstrap.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fbootstrap.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fbootstrap.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fbootstrap.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -32,7 +32,7 @@ pub fn route_bootstrap(\n }\n \n #[turbo_tasks::value(transparent)]\n-pub struct BootstrapConfig(FxIndexMap<String, String>);\n+pub struct BootstrapConfig(#[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<String, String>);\n \n #[turbo_tasks::value_impl]\n impl BootstrapConfig {"
        },
        {
            "sha": "21b2e04dfffd9353ad6823f0817a44f47292f56f",
            "filename": "crates/next-core/src/next_app/app_client_references_chunks.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fapp_client_references_chunks.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fapp_client_references_chunks.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fapp_client_references_chunks.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -22,10 +22,13 @@ use crate::{\n \n #[turbo_tasks::value]\n pub struct ClientReferencesChunks {\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub client_component_client_chunks:\n         FxIndexMap<ClientReferenceType, ResolvedVc<ChunkGroupResult>>,\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub client_component_ssr_chunks:\n         FxIndexMap<ClientReferenceType, ResolvedVc<OutputAssetsWithReferenced>>,\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub layout_segment_client_chunks:\n         FxIndexMap<ResolvedVc<NextServerComponentModule>, ResolvedVc<OutputAssetsWithReferenced>>,\n }"
        },
        {
            "sha": "b804fe2e78e92e58ac1d45439b37b5a34b1ddf9e",
            "filename": "crates/next-core/src/next_app/mod.rs",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_app%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -12,6 +12,7 @@ use std::{\n };\n \n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, TaskInput, trace::TraceRawVcs};\n@@ -38,6 +39,8 @@ pub use crate::next_app::{\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum PageSegment {\n     /// e.g. `/dashboard`\n@@ -143,6 +146,8 @@ impl Display for PageSegment {\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum PageType {\n     Page,\n@@ -173,6 +178,8 @@ impl Display for PageType {\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct AppPage(pub Vec<PageSegment>);\n \n@@ -357,6 +364,8 @@ impl PartialOrd for AppPage {\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum PathSegment {\n     /// e.g. `/dashboard`\n@@ -409,6 +418,8 @@ impl Display for PathSegment {\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct AppPath(pub Vec<PathSegment>);\n "
        },
        {
            "sha": "f73113024209dd996c26c451c63513fbbfe20aea",
            "filename": "crates/next-core/src/next_client_reference/visit_client_reference.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_client_reference%2Fvisit_client_reference.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_client_reference%2Fvisit_client_reference.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_client_reference%2Fvisit_client_reference.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::future::Future;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use tracing::{Instrument, Level, Span};\n use turbo_rcstr::RcStr;\n@@ -36,6 +37,8 @@ use crate::{\n     ValueDebugFormat,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct ClientReference {\n     pub server_component: Option<ResolvedVc<NextServerComponentModule>>,\n@@ -54,6 +57,8 @@ pub struct ClientReference {\n     ValueDebugFormat,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ClientReferenceType {\n     EcmascriptClientReference(ResolvedVc<EcmascriptClientReferenceModule>),"
        },
        {
            "sha": "0c0c5d8a79cd42687d2e94954cc330b572ee600f",
            "filename": "crates/next-core/src/next_config.rs",
            "status": "modified",
            "additions": 270,
            "deletions": 28,
            "changes": 298,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_config.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use either::Either;\n use rustc_hash::FxHashSet;\n use serde::{Deserialize, Deserializer, Serialize};\n@@ -49,7 +50,9 @@ struct CustomRoutes {\n }\n \n #[turbo_tasks::value(transparent)]\n-pub struct ModularizeImports(FxIndexMap<String, ModularizeImportPackageConfig>);\n+pub struct ModularizeImports(\n+    #[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<String, ModularizeImportPackageConfig>,\n+);\n \n #[turbo_tasks::value(transparent)]\n #[derive(Clone, Debug)]\n@@ -87,7 +90,9 @@ pub struct NextConfig {\n     cache_max_memory_size: Option<f64>,\n     /// custom path to a cache handler to use\n     cache_handler: Option<RcStr>,\n+    #[bincode(with_serde)]\n     cache_handlers: Option<FxIndexMap<RcStr, RcStr>>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     env: FxIndexMap<String, JsonValue>,\n     experimental: ExperimentalConfig,\n     images: ImageConfig,\n@@ -96,10 +101,12 @@ pub struct NextConfig {\n     react_production_profiling: Option<bool>,\n     react_strict_mode: Option<bool>,\n     transpile_packages: Option<Vec<RcStr>>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     modularize_imports: Option<FxIndexMap<String, ModularizeImportPackageConfig>>,\n     dist_dir: RcStr,\n     dist_dir_root: RcStr,\n     deployment_id: Option<RcStr>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     sass_options: Option<serde_json::Value>,\n     trailing_slash: Option<bool>,\n     asset_prefix: Option<RcStr>,\n@@ -112,7 +119,9 @@ pub struct NextConfig {\n     output: Option<OutputType>,\n     turbopack: Option<TurbopackConfig>,\n     production_browser_source_maps: bool,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     output_file_tracing_includes: Option<serde_json::Value>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     output_file_tracing_excludes: Option<serde_json::Value>,\n     // TODO: This option is not respected, it uses Turbopack's root instead.\n     output_file_tracing_root: Option<RcStr>,\n@@ -145,7 +154,9 @@ pub struct NextConfig {\n     http_agent_options: HttpAgentConfig,\n     on_demand_entries: OnDemandEntriesConfig,\n     powered_by_header: bool,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     public_runtime_config: FxIndexMap<String, serde_json::Value>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     server_runtime_config: FxIndexMap<String, serde_json::Value>,\n     static_page_generation_timeout: f64,\n     target: Option<String>,\n@@ -171,7 +182,17 @@ impl NextConfig {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum CrossOriginConfig {\n@@ -192,6 +213,8 @@ pub struct OptionCrossOriginConfig(Option<CrossOriginConfig>);\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n struct EslintConfig {\n@@ -209,6 +232,8 @@ struct EslintConfig {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum BuildActivityPositions {\n@@ -229,6 +254,8 @@ pub enum BuildActivityPositions {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct DevIndicatorsOptions {\n@@ -237,7 +264,16 @@ pub struct DevIndicatorsOptions {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged)]\n pub enum DevIndicatorsConfig {\n@@ -255,6 +291,8 @@ pub enum DevIndicatorsConfig {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n struct OnDemandEntriesConfig {\n@@ -272,14 +310,26 @@ struct OnDemandEntriesConfig {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n struct HttpAgentConfig {\n     keep_alive: bool,\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct DomainLocale {\n@@ -290,7 +340,17 @@ pub struct DomainLocale {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct I18NConfig {\n@@ -304,7 +364,17 @@ pub struct I18NConfig {\n pub struct OptionI18NConfig(Option<I18NConfig>);\n \n #[derive(\n-    Clone, Debug, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum OutputType {\n@@ -329,6 +399,8 @@ pub struct OptionOutputType(Option<OutputType>);\n     Deserialize,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(tag = \"type\", rename_all = \"kebab-case\")]\n pub enum RouteHas {\n@@ -375,7 +447,16 @@ pub struct Header {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub enum RedirectStatus {\n@@ -384,7 +465,16 @@ pub enum RedirectStatus {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct Redirect {\n@@ -403,7 +493,9 @@ pub struct Redirect {\n     pub status: RedirectStatus,\n }\n \n-#[derive(Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, Encode, Decode,\n+)]\n #[serde(rename_all = \"camelCase\")]\n pub struct Rewrite {\n     pub source: String,\n@@ -437,6 +529,8 @@ pub struct Rewrites {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct TypeScriptConfig {\n@@ -496,7 +590,16 @@ impl Default for ImageConfig {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum ImageLoader {\n@@ -508,7 +611,16 @@ pub enum ImageLoader {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ImageFormat {\n     #[serde(rename = \"image/webp\")]\n@@ -527,6 +639,8 @@ pub enum ImageFormat {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct RemotePattern {\n@@ -540,7 +654,16 @@ pub struct RemotePattern {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum RemotePatternProtocol {\n@@ -558,12 +681,14 @@ pub enum RemotePatternProtocol {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct TurbopackConfig {\n-    /// This option has been replaced by `rules`.\n-    pub loaders: Option<JsonValue>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     pub rules: Option<FxIndexMap<RcStr, RuleConfigCollection>>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     pub resolve_alias: Option<FxIndexMap<RcStr, JsonValue>>,\n     pub resolve_extensions: Option<Vec<RcStr>>,\n     pub debug_ids: Option<bool>,\n@@ -731,7 +856,16 @@ pub enum ModuleIds {\n pub struct OptionModuleIds(pub Option<ModuleIds>);\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged)]\n pub enum MdxRsOptions {\n@@ -771,7 +905,16 @@ pub struct ReactCompilerOptions {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged)]\n pub enum ReactCompilerOptionsOrBoolean {\n@@ -793,6 +936,8 @@ pub struct OptionalReactCompilerOptions(Option<ResolvedVc<ReactCompilerOptions>>\n     ValueDebugFormat,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct ExperimentalConfig {\n@@ -810,6 +955,7 @@ pub struct ExperimentalConfig {\n     /// @see [api reference](https://nextjs.org/docs/app/api-reference/next-config-js/mdxRs)\n     mdx_rs: Option<MdxRsOptions>,\n     strict_next_head: Option<bool>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     swc_plugins: Option<Vec<(RcStr, serde_json::Value)>>,\n     external_middleware_rewrites_resolve: Option<bool>,\n     scroll_restoration: Option<bool>,\n@@ -818,6 +964,7 @@ pub struct ExperimentalConfig {\n     middleware_prefetch: Option<MiddlewarePrefetchType>,\n     /// optimizeCss can be boolean or critters' option object\n     /// Use Record<string, unknown> as critters doesn't export its Option type ([link](https://github.com/GoogleChromeLabs/critters/blob/a590c05f9197b656d2aeaae9369df2483c26b072/packages/critters/src/index.d.ts))\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     optimize_css: Option<serde_json::Value>,\n     next_script_workers: Option<bool>,\n     web_vitals_attribution: Option<Vec<RcStr>>,\n@@ -835,13 +982,15 @@ pub struct ExperimentalConfig {\n     adjust_font_fallbacks_with_size_adjust: Option<bool>,\n     after: Option<bool>,\n     app_document_preloading: Option<bool>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     cache_life: Option<FxIndexMap<String, CacheLifeProfile>>,\n     case_sensitive_routes: Option<bool>,\n     cpus: Option<f64>,\n     cra_compat: Option<bool>,\n     disable_optimized_loading: Option<bool>,\n     disable_postcss_preset_env: Option<bool>,\n     esm_externals: Option<EsmExternals>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     extension_alias: Option<serde_json::Value>,\n     external_dir: Option<bool>,\n     /// If set to `false`, webpack won't fall back to polyfill Node.js modules\n@@ -856,6 +1005,7 @@ pub struct ExperimentalConfig {\n     instrumentation_hook: Option<bool>,\n     client_trace_metadata: Option<Vec<String>>,\n     large_page_data_bytes: Option<f64>,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     logging: Option<serde_json::Value>,\n     memory_based_workers_count: Option<bool>,\n     /// Optimize React APIs for server builds.\n@@ -874,6 +1024,7 @@ pub struct ExperimentalConfig {\n     /// @internal Used by the Next.js internals only.\n     trust_host_header: Option<bool>,\n \n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     url_imports: Option<serde_json::Value>,\n     /// This option is to enable running the Webpack build in a worker thread\n     /// (doesn't apply to Turbopack).\n@@ -966,15 +1117,34 @@ fn test_cache_life_profiles_invalid() {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct SubResourceIntegrity {\n     pub algorithm: Option<RcStr>,\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Deserialize, Serialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Deserialize,\n+    Serialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged)]\n pub enum ServerActionsOrLegacyBool {\n@@ -987,15 +1157,33 @@ pub enum ServerActionsOrLegacyBool {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Deserialize, Serialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Deserialize,\n+    Serialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum EsmExternalsValue {\n     Loose,\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Deserialize, Serialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Deserialize,\n+    Serialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged)]\n pub enum EsmExternals {\n@@ -1033,14 +1221,18 @@ fn test_esm_externals_deserialization() {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct ServerActions {\n     /// Allows adjusting body parser size limit for server actions.\n     pub body_size_limit: Option<SizeLimit>,\n }\n \n-#[derive(Clone, Debug, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue)]\n+#[derive(\n+    Clone, Debug, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue, Encode, Decode,\n+)]\n #[serde(untagged)]\n pub enum SizeLimit {\n     Number(f64),\n@@ -1062,7 +1254,16 @@ impl PartialEq for SizeLimit {\n impl Eq for SizeLimit {}\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum MiddlewarePrefetchType {\n@@ -1071,7 +1272,16 @@ pub enum MiddlewarePrefetchType {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged)]\n pub enum EmotionTransformOptionsOrBoolean {\n@@ -1089,7 +1299,16 @@ impl EmotionTransformOptionsOrBoolean {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged)]\n pub enum StyledComponentsTransformOptionsOrBoolean {\n@@ -1118,7 +1337,16 @@ pub struct CompilerConfig {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged, rename_all = \"camelCase\")]\n pub enum ReactRemoveProperties {\n@@ -1136,7 +1364,16 @@ impl ReactRemoveProperties {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged)]\n pub enum RemoveConsoleConfig {\n@@ -1157,7 +1394,9 @@ impl RemoveConsoleConfig {\n pub struct ResolveExtensions(Option<Vec<RcStr>>);\n \n #[turbo_tasks::value(transparent)]\n-pub struct SwcPlugins(Vec<(RcStr, serde_json::Value)>);\n+pub struct SwcPlugins(\n+    #[bincode(with = \"turbo_bincode::serde_json\")] Vec<(RcStr, serde_json::Value)>,\n+);\n \n #[turbo_tasks::value(transparent)]\n pub struct OptionalMdxTransformOptions(Option<ResolvedVc<MdxTransformOptions>>);\n@@ -1173,7 +1412,9 @@ pub struct OptionFileSystemPath(Option<FileSystemPath>);\n pub struct OptionServerActions(Option<ServerActions>);\n \n #[turbo_tasks::value(transparent)]\n-pub struct OptionJsonValue(pub Option<serde_json::Value>);\n+pub struct OptionJsonValue(\n+    #[bincode(with = \"turbo_bincode::serde_json\")] pub Option<serde_json::Value>,\n+);\n \n fn turbopack_config_documentation_link() -> RcStr {\n     rcstr!(\"https://nextjs.org/docs/app/api-reference/config/next-config-js/turbopack#configuring-webpack-loaders\")\n@@ -1225,6 +1466,7 @@ impl Issue for InvalidLoaderRuleRenameAsIssue {\n \n #[turbo_tasks::value(shared)]\n struct InvalidLoaderRuleConditionIssue {\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     condition: ConfigConditionItem,\n     config_file_path: FileSystemPath,\n }"
        },
        {
            "sha": "ffa52a079db46b70bab854caf225c0fc3adf89ce",
            "filename": "crates/next-core/src/next_font/font_fallback.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Ffont_fallback.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Ffont_fallback.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_font%2Ffont_fallback.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use once_cell::sync::Lazy;\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n@@ -79,7 +80,7 @@ impl FontFallbacks {\n /// An adjustment to be made to a fallback font to approximate the geometry of\n /// the main webfont. Rendered as e.g. `ascent-override: 56.8%;` in the\n /// stylesheet\n-#[derive(Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n+#[derive(Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, Encode, Decode)]\n pub(crate) struct FontAdjustment {\n     pub ascent: f64,\n     pub descent: f64,"
        },
        {
            "sha": "a830d3f63892e1c7ad03248c2c9f180f5d2622fa",
            "filename": "crates/next-core/src/next_font/google/font_fallback.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 3,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Fgoogle%2Ffont_fallback.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Fgoogle%2Ffont_fallback.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_font%2Fgoogle%2Ffont_fallback.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Context, Result};\n+use bincode::{Decode, Encode};\n use once_cell::sync::Lazy;\n use regex::Regex;\n use serde::{Deserialize, Serialize};\n@@ -7,21 +8,23 @@ use turbo_tasks::{FxIndexMap, NonLocalValue, Vc, trace::TraceRawVcs};\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::issue::{IssueExt, IssueSeverity, StyledString};\n \n-use super::options::NextFontGoogleOptions;\n use crate::{\n     next_font::{\n         font_fallback::{\n             AutomaticFontFallback, DEFAULT_SANS_SERIF_FONT, DEFAULT_SERIF_FONT, FontAdjustment,\n             FontFallback,\n         },\n+        google::options::NextFontGoogleOptions,\n         issue::NextFontIssue,\n         util::{FontFamilyType, get_scoped_font_family},\n     },\n     util::load_next_js_json_file,\n };\n \n /// An entry in the Google fonts metrics map\n-#[derive(Deserialize, Serialize, Debug, PartialEq, Eq, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Deserialize, Serialize, Debug, PartialEq, Eq, TraceRawVcs, NonLocalValue, Encode, Decode,\n+)]\n #[serde(rename_all = \"camelCase\")]\n pub(super) struct FontMetricsMapEntry {\n     category: RcStr,\n@@ -34,7 +37,9 @@ pub(super) struct FontMetricsMapEntry {\n \n #[derive(Debug)]\n #[turbo_tasks::value]\n-pub(super) struct FontMetricsMap(pub FxIndexMap<RcStr, FontMetricsMapEntry>);\n+pub(super) struct FontMetricsMap(\n+    #[bincode(with = \"turbo_bincode::indexmap\")] pub FxIndexMap<RcStr, FontMetricsMapEntry>,\n+);\n \n #[derive(Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n struct Fallback {"
        },
        {
            "sha": "ad8d4eb68e3eec868d06cb752f3da890a10e7f1e",
            "filename": "crates/next-core/src/next_font/google/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Fgoogle%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Fgoogle%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_font%2Fgoogle%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -74,7 +74,7 @@ pub const USER_AGENT_FOR_GOOGLE_FONTS: &str = \"Mozilla/5.0 (Macintosh; Intel Mac\n pub const GOOGLE_FONTS_INTERNAL_PREFIX: &str = \"@vercel/turbopack-next/internal/font/google/font\";\n \n #[turbo_tasks::value(transparent)]\n-struct FontData(FxIndexMap<RcStr, FontDataEntry>);\n+struct FontData(#[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<RcStr, FontDataEntry>);\n \n #[turbo_tasks::value(shared)]\n pub(crate) struct NextFontGoogleReplacer {"
        },
        {
            "sha": "ecb1ebbe2e307be68980c43f15d7bd94a2a18705",
            "filename": "crates/next-core/src/next_font/google/options.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Fgoogle%2Foptions.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Fgoogle%2Foptions.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_font%2Fgoogle%2Foptions.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Context, Result};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{\n@@ -56,20 +57,24 @@ impl NextFontGoogleOptions {\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub(super) enum FontWeights {\n     Variable,\n     Fixed(Vec<u16>),\n }\n \n-#[derive(Debug, PartialEq, Eq, Deserialize, Serialize, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Debug, PartialEq, Eq, Deserialize, Serialize, TraceRawVcs, NonLocalValue, Encode, Decode,\n+)]\n pub(super) struct FontDataEntry {\n     pub weights: Vec<RcStr>,\n     pub styles: Vec<RcStr>,\n     pub axes: Option<Vec<Axis>>,\n }\n \n-#[derive(Debug, PartialEq, Deserialize, Serialize, TraceRawVcs, NonLocalValue)]\n+#[derive(Debug, PartialEq, Deserialize, Serialize, TraceRawVcs, NonLocalValue, Encode, Decode)]\n #[serde(rename_all = \"camelCase\")]\n pub(super) struct Axis {\n     pub tag: RcStr,"
        },
        {
            "sha": "97e85013e4554ee577c99d3c7751d4100d2f6a00",
            "filename": "crates/next-core/src/next_font/local/errors.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Ferrors.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Ferrors.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Ferrors.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,5 +1,6 @@\n use std::fmt::Display;\n \n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, trace::TraceRawVcs};\n@@ -9,7 +10,9 @@ pub(crate) enum FontResult<T> {\n     FontFileNotFound(FontFileNotFound),\n }\n \n-#[derive(Debug, Eq, PartialEq, Serialize, Deserialize, NonLocalValue, TraceRawVcs)]\n+#[derive(\n+    Debug, Eq, PartialEq, Serialize, Deserialize, NonLocalValue, TraceRawVcs, Encode, Decode,\n+)]\n pub(crate) struct FontFileNotFound(pub RcStr);\n \n impl Display for FontFileNotFound {"
        },
        {
            "sha": "1b5c31e17868229576c44c79cc16453d6f6bda70",
            "filename": "crates/next-core/src/next_font/local/font_fallback.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Ffont_fallback.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Ffont_fallback.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Ffont_fallback.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -7,16 +7,16 @@ use turbo_rcstr::rcstr;\n use turbo_tasks::{ResolvedVc, Vc};\n use turbo_tasks_fs::{FileContent, FileSystemPath};\n \n-use super::{\n-    errors::{FontFileNotFound, FontResult},\n-    options::{FontDescriptor, FontDescriptors, FontWeight, NextFontLocalOptions},\n-    request::AdjustFontFallback,\n-};\n use crate::next_font::{\n     font_fallback::{\n         AutomaticFontFallback, DEFAULT_SANS_SERIF_FONT, DEFAULT_SERIF_FONT, DefaultFallbackFont,\n         FontAdjustment, FontFallback, FontFallbacks,\n     },\n+    local::{\n+        errors::{FontFileNotFound, FontResult},\n+        options::{FontDescriptor, FontDescriptors, FontWeight, NextFontLocalOptions},\n+        request::AdjustFontFallback,\n+    },\n     util::{FontFamilyType, get_scoped_font_family},\n };\n "
        },
        {
            "sha": "95f66e07425e83a697fb3a27dd31820cc4792d22",
            "filename": "crates/next-core/src/next_font/local/options.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Foptions.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Foptions.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Foptions.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{fmt::Display, str::FromStr};\n \n use anyhow::{Context, Result};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, TaskInput, Vc, trace::TraceRawVcs};\n@@ -66,6 +67,8 @@ impl NextFontLocalOptions {\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub(super) struct FontDescriptor {\n     pub weight: Option<FontWeight>,\n@@ -108,6 +111,8 @@ impl FontDescriptor {\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub(super) enum FontDescriptors {\n     /// `One` is a special case when the user did not provide a `src` field and\n@@ -131,6 +136,8 @@ pub(super) enum FontDescriptors {\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub(super) enum FontWeight {\n     Variable(RcStr, RcStr),\n@@ -141,7 +148,7 @@ pub struct ParseFontWeightErr;\n impl FromStr for FontWeight {\n     type Err = ParseFontWeightErr;\n \n-    fn from_str(weight_str: &str) -> std::result::Result<Self, Self::Err> {\n+    fn from_str(weight_str: &str) -> Result<Self, Self::Err> {\n         if let Some((start, end)) = weight_str.split_once(' ') {\n             Ok(FontWeight::Variable(start.into(), end.into()))\n         } else {"
        },
        {
            "sha": "193c4ac797190a64ad17172627ab7ca26dfaf4a0",
            "filename": "crates/next-core/src/next_font/local/request.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Frequest.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Frequest.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_font%2Flocal%2Frequest.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,3 +1,4 @@\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{NonLocalValue, TaskInput, trace::TraceRawVcs};\n@@ -25,6 +26,8 @@ pub(super) struct NextFontLocalRequest {\n     Deserialize,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub(super) struct NextFontLocalDeclaration {\n     pub prop: RcStr,\n@@ -79,6 +82,8 @@ pub(super) struct SrcDescriptor {\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub(super) enum AdjustFontFallback {\n     Arial,"
        },
        {
            "sha": "bf867b01e63422c2caa2fd1862337692c172c03e",
            "filename": "crates/next-core/src/next_image/module.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_image%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_image%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_image%2Fmodule.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::rcstr;\n use turbo_tasks::{NonLocalValue, ResolvedVc, TaskInput, Vc, fxindexmap, trace::TraceRawVcs};\n@@ -26,6 +27,8 @@ use super::source_asset::StructuredImageFileSource;\n     NonLocalValue,\n     Serialize,\n     Deserialize,\n+    Encode,\n+    Decode,\n )]\n pub enum BlurPlaceholderMode {\n     /// Do not generate a blur placeholder at all."
        },
        {
            "sha": "48567b5e2173e44cb5febd1e0c6fa7888828ae3c",
            "filename": "crates/next-core/src/next_manifests/mod.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_manifests%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_manifests%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_manifests%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -4,6 +4,7 @@ pub mod client_reference_manifest;\n mod encode_uri_component;\n \n use anyhow::{Context, Result};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n@@ -32,6 +33,7 @@ pub struct BuildManifest {\n \n     pub polyfill_files: Vec<ResolvedVc<Box<dyn OutputAsset>>>,\n     pub root_main_files: Vec<ResolvedVc<Box<dyn OutputAsset>>>,\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub pages: FxIndexMap<RcStr, ResolvedVc<OutputAssets>>,\n }\n \n@@ -164,6 +166,7 @@ pub struct ClientBuildManifest {\n     pub output_path: FileSystemPath,\n     pub client_relative_path: FileSystemPath,\n \n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub pages: FxIndexMap<RcStr, ResolvedVc<Box<dyn OutputAsset>>>,\n }\n \n@@ -244,6 +247,8 @@ impl Default for MiddlewaresManifest {\n     Serialize,\n     Deserialize,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\", default)]\n pub struct ProxyMatcher {\n@@ -419,6 +424,8 @@ pub enum ActionManifestModuleId<'a> {\n     Serialize,\n     Deserialize,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum ActionLayer {"
        },
        {
            "sha": "667ab2dc15fcb2ef9c220f1211d47c41873da9bb",
            "filename": "crates/next-core/src/next_root_params/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_root_params%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_root_params%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_root_params%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -67,6 +67,7 @@ async fn get_next_root_params_mapping(\n #[turbo_tasks::value]\n struct NextRootParamsMapper {\n     is_root_params_enabled: ResolvedVc<bool>,\n+    #[bincode(with = \"turbo_bincode::either\")]\n     context_type: Either<ServerContextType, ClientContextType>,\n     collected_root_params: Option<ResolvedVc<CollectedRootParams>>,\n }"
        },
        {
            "sha": "ff399dd6e85ccbb9ccd29b5938b1593a774366bc",
            "filename": "crates/next-core/src/next_server/resolve.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fresolve.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fresolve.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fresolve.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use next_taskless::NEVER_EXTERNAL_RE;\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n@@ -333,7 +334,9 @@ impl AfterResolvePlugin for ExternalCjsModulesResolvePlugin {\n     }\n }\n \n-#[derive(Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, Debug, NonLocalValue)]\n+#[derive(\n+    Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, Debug, NonLocalValue, Encode, Decode,\n+)]\n pub struct PackagesGlobs {\n     path_glob: ResolvedVc<Glob>,\n     request_glob: ResolvedVc<Glob>,"
        },
        {
            "sha": "8a4b4999def4325803030a590f682af50255498a",
            "filename": "crates/next-core/src/next_shared/transforms/modularize_imports.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fmodularize_imports.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fmodularize_imports.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fmodularize_imports.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -2,6 +2,7 @@ use std::sync::Arc;\n \n use anyhow::Result;\n use async_trait::async_trait;\n+use bincode::{Decode, Encode};\n use modularize_imports::{Config, PackageConfig, modularize_imports};\n use serde::{Deserialize, Serialize};\n use swc_core::ecma::ast::Program;\n@@ -22,6 +23,8 @@ use super::module_rule_match_js_no_url;\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct ModularizeImportPackageConfig {\n@@ -43,6 +46,8 @@ pub struct ModularizeImportPackageConfig {\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(untagged)]\n pub enum Transform {"
        },
        {
            "sha": "48e112221d95beacc22a4bfaac383c22e32e86ac",
            "filename": "crates/next-core/src/next_shared/webpack_rules/mod.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Fwebpack_rules%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Fwebpack_rules%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Fwebpack_rules%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{collections::BTreeSet, str::FromStr};\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{NonLocalValue, OperationValue, ResolvedVc, TaskInput, Vc, trace::TraceRawVcs};\n@@ -46,6 +47,8 @@ pub(crate) mod sass;\n     TraceRawVcs,\n     NonLocalValue,\n     OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum WebpackLoaderBuiltinCondition {"
        },
        {
            "sha": "9cee3d657966c8df6af8bcb7b0b339aca564f556",
            "filename": "crates/next-core/src/raw_ecmascript_module.rs",
            "status": "modified",
            "additions": 10,
            "deletions": 9,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fraw_ecmascript_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fraw_ecmascript_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fraw_ecmascript_module.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -223,15 +223,16 @@ impl EcmascriptChunkItem for RawEcmascriptChunkItem {\n                                     name,\n                                     if let Some(value) =\n                                         replacements.get(&DefinableNameSegment::Name(name.into()))\n-                                        && let Some((_, value)) = value.iter().find(|(path, _)| {\n-                                            matches!(\n-                                                path.as_slice(),\n-                                                [\n-                                                    DefinableNameSegment::Name(a),\n-                                                    DefinableNameSegment::Name(b)\n-                                                ] if a == \"process\" && b == \"env\"\n-                                            )\n-                                        })\n+                                        && let Some((_, value)) =\n+                                            value.0.iter().find(|(path, _)| {\n+                                                matches!(\n+                                                    path.as_slice(),\n+                                                    [\n+                                                        DefinableNameSegment::Name(a),\n+                                                        DefinableNameSegment::Name(b)\n+                                                    ] if a == \"process\" && b == \"env\"\n+                                                )\n+                                            })\n                                     {\n                                         let value = value.await?;\n                                         let value = match &*value {"
        },
        {
            "sha": "a194e87e9d7fac68efdc63faef7f6c4469a7685e",
            "filename": "crates/next-core/src/segment_config.rs",
            "status": "modified",
            "additions": 40,
            "deletions": 3,
            "changes": 43,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fsegment_config.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Fsegment_config.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fsegment_config.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{borrow::Cow, future::Future};\n \n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use serde_json::Value;\n use swc_core::{\n@@ -42,7 +43,18 @@ use crate::{\n };\n \n #[derive(\n-    Default, PartialEq, Eq, Clone, Copy, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue,\n+    Default,\n+    PartialEq,\n+    Eq,\n+    Clone,\n+    Copy,\n+    Debug,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum NextSegmentDynamic {\n@@ -54,7 +66,18 @@ pub enum NextSegmentDynamic {\n }\n \n #[derive(\n-    Default, PartialEq, Eq, Clone, Copy, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue,\n+    Default,\n+    PartialEq,\n+    Eq,\n+    Clone,\n+    Copy,\n+    Debug,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum NextSegmentFetchCache {\n@@ -69,7 +92,18 @@ pub enum NextSegmentFetchCache {\n }\n \n #[derive(\n-    Default, PartialEq, Eq, Clone, Copy, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue,\n+    Default,\n+    PartialEq,\n+    Eq,\n+    Clone,\n+    Copy,\n+    Debug,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum NextRevalidate {\n     #[default]\n@@ -95,6 +129,7 @@ pub struct NextSegmentConfig {\n     pub generate_image_metadata: bool,\n     pub generate_sitemaps: bool,\n     #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n     pub generate_static_params: Option<Span>,\n }\n \n@@ -284,6 +319,8 @@ impl Issue for NextSegmentConfigParsingIssue {\n     TaskInput,\n     NonLocalValue,\n     TraceRawVcs,\n+    Encode,\n+    Decode,\n )]\n pub enum ParseSegmentMode {\n     Base,"
        },
        {
            "sha": "8ac122bb46007e00f1469d0229bb3218185577d8",
            "filename": "crates/next-core/src/util.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 5,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Futil.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/crates%2Fnext-core%2Fsrc%2Futil.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Futil.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,13 +1,12 @@\n use std::{fmt::Display, str::FromStr};\n \n use anyhow::{Result, anyhow, bail};\n+use bincode::{Decode, Encode};\n use next_taskless::{expand_next_js_template, expand_next_js_template_no_imports};\n use serde::{Deserialize, Serialize, de::DeserializeOwned};\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{FxIndexMap, NonLocalValue, TaskInput, Vc, trace::TraceRawVcs};\n-use turbo_tasks_fs::{\n-    self, File, FileContent, FileJsonContent, FileSystem, FileSystemPath, rope::Rope,\n-};\n+use turbo_tasks_fs::{File, FileContent, FileJsonContent, FileSystem, FileSystemPath, rope::Rope};\n use turbopack::module_options::RuleCondition;\n use turbopack_core::{\n     asset::AssetContent,\n@@ -27,7 +26,11 @@ const NEXT_TEMPLATE_PATH: &str = \"dist/esm/build/templates\";\n /// As opposed to [`EnvMap`], this map allows for `None` values, which means that the variables\n /// should be replace with undefined.\n #[turbo_tasks::value(transparent)]\n-pub struct OptionEnvMap(#[turbo_tasks(trace_ignore)] FxIndexMap<RcStr, Option<RcStr>>);\n+pub struct OptionEnvMap(\n+    #[turbo_tasks(trace_ignore)]\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    FxIndexMap<RcStr, Option<RcStr>>,\n+);\n \n pub fn defines(define_env: &FxIndexMap<RcStr, Option<RcStr>>) -> CompileTimeDefines {\n     let mut defines = FxIndexMap::default();\n@@ -198,6 +201,8 @@ pub fn pages_function_name(page: impl Display) -> String {\n     Ord,\n     TaskInput,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"lowercase\")]\n pub enum NextRuntime {\n@@ -228,7 +233,9 @@ impl NextRuntime {\n     }\n }\n \n-#[derive(PartialEq, Eq, Clone, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    PartialEq, Eq, Clone, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue, Encode, Decode,\n+)]\n pub enum MiddlewareMatcherKind {\n     Str(String),\n     Matcher(ProxyMatcher),"
        },
        {
            "sha": "78e7aa28cc7fcf07b554fdb3040fcd8a0b555f42",
            "filename": "turbopack/crates/turbo-esregex/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-esregex%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-esregex%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-esregex%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -6,6 +6,7 @@ license = \"MIT\"\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n regex = { workspace = true }\n regress = { workspace = true }\n serde = { workspace = true }"
        },
        {
            "sha": "02dadca4bbecb4da7a5aa12cc4a4a3427eabd9d1",
            "filename": "turbopack/crates/turbo-esregex/src/lib.rs",
            "status": "modified",
            "additions": 29,
            "deletions": 2,
            "changes": 31,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-esregex%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-esregex%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-esregex%2Fsrc%2Flib.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -3,12 +3,20 @@\n use std::vec;\n \n use anyhow::{Result, bail};\n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode,\n+};\n+use serde::{Deserialize, Serialize};\n \n /// A simple regular expression implementation following ecmascript semantics\n ///\n /// Delegates to the `regex` crate when possible and `regress` otherwise.\n-#[derive(Debug, Clone)]\n-#[turbo_tasks::value(eq = \"manual\", shared)]\n+#[derive(Debug, Clone, Serialize, Deserialize)]\n+#[turbo_tasks::value(eq = \"manual\", shared, serialization = \"custom\")]\n #[serde(into = \"RegexForm\", try_from = \"RegexForm\")]\n pub struct EsRegex {\n     #[turbo_tasks(trace_ignore)]\n@@ -60,6 +68,25 @@ impl From<EsRegex> for RegexForm {\n     }\n }\n \n+impl Encode for EsRegex {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        self.pattern.encode(encoder)?;\n+        self.flags.encode(encoder)?;\n+        Ok(())\n+    }\n+}\n+\n+impl<Context> Decode<Context> for EsRegex {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        let pattern: String = Decode::decode(decoder)?;\n+        let flags: String = Decode::decode(decoder)?;\n+        // TODO: perf: there's cloning happening here, we should be able to just move the `String`\n+        EsRegex::new(&pattern, &flags).map_err(|err| DecodeError::OtherString(err.to_string()))\n+    }\n+}\n+\n+impl_borrow_decode!(EsRegex);\n+\n impl EsRegex {\n     /// Support ecmascript style regular expressions by selecting the `regex` crate when possible\n     /// and using regress when not."
        },
        {
            "sha": "9e726a405f51f65d4592a32bdd18a1bb7a327477",
            "filename": "turbopack/crates/turbo-rcstr/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-rcstr%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-rcstr%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-rcstr%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -10,6 +10,7 @@ atom_size_128 = []\n napi = [\"dep:napi\"]\n \n [dependencies]\n+bincode = { workspace = true }\n triomphe = { workspace = true }\n turbo-tasks-hash = { workspace = true }\n serde = { workspace = true }"
        },
        {
            "sha": "e6c32e5639e18b55c90c6e6bb7b18bed6136f7cc",
            "filename": "turbopack/crates/turbo-rcstr/src/lib.rs",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-rcstr%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-rcstr%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-rcstr%2Fsrc%2Flib.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -9,6 +9,13 @@ use std::{\n     path::{Path, PathBuf},\n };\n \n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode,\n+};\n use bytes_str::BytesStr;\n use debug_unreachable::debug_unreachable;\n use serde::{Deserialize, Deserializer, Serialize, Serializer};\n@@ -369,6 +376,20 @@ impl<'de> Deserialize<'de> for RcStr {\n     }\n }\n \n+impl Encode for RcStr {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        self.as_str().encode(encoder)\n+    }\n+}\n+\n+impl<Context> Decode<Context> for RcStr {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        Ok(RcStr::from(String::decode(decoder)?))\n+    }\n+}\n+\n+impl_borrow_decode!(RcStr);\n+\n impl Drop for RcStr {\n     fn drop(&mut self) {\n         match self.tag() {"
        },
        {
            "sha": "caa7430c0bcefe950721b7d7828fdb48b13decf1",
            "filename": "turbopack/crates/turbo-tasks-auto-hash-map/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-auto-hash-map%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-auto-hash-map%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-auto-hash-map%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -9,6 +9,7 @@ edition = \"2024\"\n workspace = true\n \n [dependencies]\n+bincode = { workspace = true }\n hashbrown = { workspace = true, features = [\"serde\"]}\n rustc-hash = { workspace = true }\n serde = { workspace = true, features = [\"derive\"] }"
        },
        {
            "sha": "92d599b459235a8890112b219322a3af2901ea37",
            "filename": "turbopack/crates/turbo-tasks-auto-hash-map/src/map.rs",
            "status": "modified",
            "additions": 58,
            "deletions": 1,
            "changes": 59,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-auto-hash-map%2Fsrc%2Fmap.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-auto-hash-map%2Fsrc%2Fmap.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-auto-hash-map%2Fsrc%2Fmap.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -5,6 +5,13 @@ use std::{\n     marker::PhantomData,\n };\n \n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode,\n+};\n use hashbrown::hash_map::HashMap;\n use rustc_hash::FxHasher;\n use serde::{\n@@ -54,7 +61,7 @@ impl<K, V> AutoMap<K, V, BuildHasherDefault<FxHasher>, 0> {\n     }\n }\n \n-impl<K, V, H: BuildHasher, const I: usize> AutoMap<K, V, H, I> {\n+impl<K, V, H, const I: usize> AutoMap<K, V, H, I> {\n     /// see [HashMap::with_hasher](https://doc.rust-lang.org/std/collections/hash_map/struct.HashMap.html#method.with_hasher)\n     pub const fn with_hasher() -> Self {\n         AutoMap::List(SmallVec::new_const())\n@@ -813,6 +820,56 @@ where\n     }\n }\n \n+impl<K, V, H, const I: usize> Encode for AutoMap<K, V, H, I>\n+where\n+    K: Encode,\n+    V: Encode,\n+{\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        // Encode the length first\n+        self.len().encode(encoder)?;\n+        // Then encode each key-value tuple\n+        for entry in self.iter() {\n+            entry.encode(encoder)?;\n+        }\n+        Ok(())\n+    }\n+}\n+\n+impl<Context, K, V, H, const I: usize> Decode<Context> for AutoMap<K, V, H, I>\n+where\n+    K: Decode<Context> + Eq + Hash,\n+    V: Decode<Context>,\n+    H: BuildHasher + Default,\n+{\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        let len = usize::decode(decoder)?;\n+        if len <= MAX_LIST_SIZE {\n+            let mut list = SmallVec::with_capacity(len);\n+            for _ in 0..len {\n+                let entry = <(K, V)>::decode(decoder)?;\n+                list.push(entry);\n+            }\n+            Ok(AutoMap::List(list))\n+        } else {\n+            let mut map = HashMap::with_capacity_and_hasher(len, H::default());\n+            for _ in 0..len {\n+                let (key, value) = <(K, V)>::decode(decoder)?;\n+                map.insert(key, value);\n+            }\n+            Ok(AutoMap::Map(Box::new(map)))\n+        }\n+    }\n+}\n+\n+impl_borrow_decode!(\n+    AutoMap<K, V, H, I>,\n+    K: Decode<__Context> + Eq + Hash,\n+    V: Decode<__Context>,\n+    H: BuildHasher + Default,\n+    const I: usize,\n+);\n+\n impl<K: Eq + Hash, V: Eq, H: BuildHasher, const I: usize> PartialEq for AutoMap<K, V, H, I> {\n     fn eq(&self, other: &Self) -> bool {\n         match (self, other) {"
        },
        {
            "sha": "2231b50a395ab4a069a7d3b54fa9949e8be78035",
            "filename": "turbopack/crates/turbo-tasks-auto-hash-map/src/set.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-auto-hash-map%2Fsrc%2Fset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-auto-hash-map%2Fsrc%2Fset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-auto-hash-map%2Fsrc%2Fset.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -4,13 +4,19 @@ use std::{\n     marker::PhantomData,\n };\n \n+use bincode::{Decode, Encode};\n use rustc_hash::FxHasher;\n use serde::{Deserialize, Serialize};\n use shrink_to_fit::ShrinkToFit;\n \n use crate::AutoMap;\n \n-#[derive(Clone)]\n+#[derive(Clone, Encode, Decode)]\n+#[bincode(\n+    encode_bounds = \"K: Encode + Hash + Eq, H: BuildHasher + Default\",\n+    decode_bounds = \"K: Decode<__Context> + Hash + Eq, H: BuildHasher + Default\",\n+    borrow_decode_bounds = \"K: Decode<__Context> + Hash + Eq, H: BuildHasher + Default\"\n+)]\n pub struct AutoSet<K, H = BuildHasherDefault<FxHasher>, const I: usize = 0> {\n     map: AutoMap<K, (), H, I>,\n }"
        },
        {
            "sha": "1aee93cb86c548cff966964a8915230dc3d15c7f",
            "filename": "turbopack/crates/turbo-tasks-backend/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-backend%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-backend%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -30,6 +30,7 @@ lmdb = [\"dep:lmdb-rkv\"]\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n arc-swap = { version = \"1.7.1\" }\n auto-hash-map = { workspace = true }\n bitfield = { workspace = true }"
        },
        {
            "sha": "b0c0c537a88f4729d9bba9e16217f9d795805bdd",
            "filename": "turbopack/crates/turbo-tasks-backend/tests/bug.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-backend%2Ftests%2Fbug.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-backend%2Ftests%2Fbug.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Ftests%2Fbug.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -3,20 +3,25 @@\n #![allow(clippy::needless_return)] // tokio macro-generated code doesn't respect this\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, Vc, trace::TraceRawVcs};\n use turbo_tasks_testing::{Registration, register, run_once};\n \n static REGISTRATION: Registration = register!();\n \n-#[derive(Debug, Clone, PartialEq, Eq, NonLocalValue, Serialize, Deserialize, TraceRawVcs)]\n+#[derive(\n+    Debug, Clone, PartialEq, Eq, NonLocalValue, Serialize, Deserialize, TraceRawVcs, Encode, Decode,\n+)]\n struct TaskReferenceSpec {\n     task: u16,\n     read: bool,\n     read_strongly_consistent: bool,\n }\n \n-#[derive(Debug, Clone, PartialEq, Eq, NonLocalValue, Serialize, Deserialize, TraceRawVcs)]\n+#[derive(\n+    Debug, Clone, PartialEq, Eq, NonLocalValue, Serialize, Deserialize, TraceRawVcs, Encode, Decode,\n+)]\n struct TaskSpec {\n     references: Vec<TaskReferenceSpec>,\n }"
        },
        {
            "sha": "041dd6e7f52eee7545a0a5777285bd89e34625c5",
            "filename": "turbopack/crates/turbo-tasks-backend/tests/bug2.rs",
            "status": "modified",
            "additions": 25,
            "deletions": 2,
            "changes": 27,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-backend%2Ftests%2Fbug2.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-backend%2Ftests%2Fbug2.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Ftests%2Fbug2.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -5,14 +5,26 @@\n use std::sync::Arc;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, State, TaskInput, Vc, trace::TraceRawVcs};\n use turbo_tasks_testing::{Registration, register, run_once};\n \n static REGISTRATION: Registration = register!();\n \n #[derive(\n-    Clone, Debug, PartialEq, Eq, Hash, NonLocalValue, Serialize, Deserialize, TraceRawVcs, TaskInput,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    NonLocalValue,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub struct TaskReferenceSpec {\n     task: u16,\n@@ -22,7 +34,18 @@ pub struct TaskReferenceSpec {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Eq, Hash, NonLocalValue, Serialize, Deserialize, TraceRawVcs, TaskInput,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    NonLocalValue,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub struct TaskSpec {\n     references: Vec<TaskReferenceSpec>,"
        },
        {
            "sha": "d4fe5390a1981b42dd8ff0fd55729f642b0b5255",
            "filename": "turbopack/crates/turbo-tasks-bytes/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-bytes%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-bytes%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-bytes%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -13,6 +13,7 @@ workspace = true\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n bytes = { workspace = true }\n futures = { workspace = true }\n serde = { workspace = true }"
        },
        {
            "sha": "4f2ff83b613a6fcc035e47f9ec0843374651440b",
            "filename": "turbopack/crates/turbo-tasks-bytes/src/bytes.rs",
            "status": "modified",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-bytes%2Fsrc%2Fbytes.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-bytes%2Fsrc%2Fbytes.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-bytes%2Fsrc%2Fbytes.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -4,6 +4,13 @@ use std::{\n };\n \n use anyhow::Result;\n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode,\n+};\n use bytes::Bytes as CBytes;\n use serde::{Deserialize, Deserializer, Serialize, Serializer};\n \n@@ -32,6 +39,22 @@ impl<'de> Deserialize<'de> for Bytes {\n     }\n }\n \n+impl Encode for Bytes {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        self[..].encode(encoder)\n+    }\n+}\n+\n+impl<Context> Decode<Context> for Bytes {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        // bincode uses the same encoding for slices and vecs\n+        // https://docs.rs/bincode/latest/bincode/spec/index.html#linear-collections-vec-arrays-etc\n+        Ok(Bytes(CBytes::from(Vec::<u8>::decode(decoder)?)))\n+    }\n+}\n+\n+impl_borrow_decode!(Bytes);\n+\n impl Deref for Bytes {\n     type Target = CBytes;\n     fn deref(&self) -> &Self::Target {\n@@ -95,6 +118,16 @@ mod tests {\n         assert_tokens(&s, &[Token::Bytes(b\"test\")])\n     }\n \n+    #[test]\n+    fn bincode() {\n+        let s = Bytes::from(\"test\");\n+        let c = bincode::config::standard();\n+        let decoded: Bytes = bincode::decode_from_slice(&bincode::encode_to_vec(&s, c).unwrap(), c)\n+            .unwrap()\n+            .0;\n+        assert_eq!(decoded, s);\n+    }\n+\n     #[test]\n     fn from_into() {\n         let b = Bytes::from(\"foo\");"
        },
        {
            "sha": "cd7ace8bb25232bc3a4a52ff13863fd1bd04e3b2",
            "filename": "turbopack/crates/turbo-tasks-bytes/src/stream.rs",
            "status": "modified",
            "additions": 40,
            "deletions": 0,
            "changes": 40,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-bytes%2Fsrc%2Fstream.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-bytes%2Fsrc%2Fstream.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-bytes%2Fsrc%2Fstream.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -6,6 +6,12 @@ use std::{\n };\n \n use anyhow::Result;\n+use bincode::{\n+    BorrowDecode, Decode, Encode,\n+    de::{BorrowDecoder, Decoder},\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+};\n use futures::{Stream as StreamTrait, StreamExt, TryStreamExt};\n use serde::{Deserialize, Deserializer, Serialize, Serializer};\n \n@@ -168,6 +174,40 @@ impl<'de, T: Clone + Send + Deserialize<'de>> Deserialize<'de> for Stream<T> {\n     }\n }\n \n+impl<T: Clone + Encode + Send> Encode for Stream<T> {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        let lock = self\n+            .inner\n+            .lock()\n+            .map_err(|_| EncodeError::Other(\"failed to lock stream, lock is poisoned?\"))?;\n+        match &*lock {\n+            StreamState {\n+                pulled,\n+                source: None,\n+            } => Encode::encode(pulled, encoder),\n+            _ => Err(EncodeError::Other(\"cannot encode open stream\")),\n+        }\n+    }\n+}\n+\n+impl<Context, T: Clone + Send + Decode<Context>> Decode<Context> for Stream<T> {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        let data = <Vec<T>>::decode(decoder)?;\n+        Ok(Stream::new_closed(data))\n+    }\n+}\n+\n+impl<'de, Context, T: Clone + Send + BorrowDecode<'de, Context>> BorrowDecode<'de, Context>\n+    for Stream<T>\n+{\n+    fn borrow_decode<D: BorrowDecoder<'de, Context = Context>>(\n+        decoder: &mut D,\n+    ) -> Result<Self, DecodeError> {\n+        let data = <Vec<T>>::borrow_decode(decoder)?;\n+        Ok(Stream::new_closed(data))\n+    }\n+}\n+\n impl<T: Clone + fmt::Debug> fmt::Debug for StreamState<T> {\n     fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {\n         f.debug_struct(\"StreamState\")"
        },
        {
            "sha": "9d1ea1d677bf303585bf2bf55f5dd875f3b3832d",
            "filename": "turbopack/crates/turbo-tasks-env/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-env%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-env%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-env%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -14,6 +14,7 @@ workspace = true\n [dependencies]\n anyhow = { workspace = true }\n dotenvs = \"0.1.0\"\n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-fs = { workspace = true }"
        },
        {
            "sha": "ac3e2f9a2109f7343b4c852860c8f52160f4f685",
            "filename": "turbopack/crates/turbo-tasks-env/src/lib.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-env%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-env%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-env%2Fsrc%2Flib.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -18,7 +18,11 @@ pub use self::{\n };\n \n #[turbo_tasks::value(transparent)]\n-pub struct EnvMap(#[turbo_tasks(trace_ignore)] FxIndexMap<RcStr, RcStr>);\n+pub struct EnvMap(\n+    #[turbo_tasks(trace_ignore)]\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    FxIndexMap<RcStr, RcStr>,\n+);\n \n #[turbo_tasks::value_impl]\n impl EnvMap {"
        },
        {
            "sha": "1d42455d80fbdf61127b7e64d381b0a6a795f2de",
            "filename": "turbopack/crates/turbo-tasks-fs/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -25,6 +25,7 @@ workspace = true\n [dependencies]\n anyhow = { workspace = true }\n auto-hash-map = { workspace = true }\n+bincode = { workspace = true }\n bitflags = \"1.3.2\"\n bytes = { workspace = true }\n concurrent-queue = { workspace = true }\n@@ -46,6 +47,7 @@ serde_path_to_error = { workspace = true }\n tokio = { workspace = true }\n tracing = { workspace = true }\n triomphe = { workspace = true }\n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-hash = { workspace = true }"
        },
        {
            "sha": "7504c43be3bd787f2b399693588389a05a0dcdd7",
            "filename": "turbopack/crates/turbo-tasks-fs/src/glob.rs",
            "status": "modified",
            "additions": 38,
            "deletions": 3,
            "changes": 41,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Fglob.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Fglob.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Fglob.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,12 @@\n use std::fmt::Display;\n \n use anyhow::{Result, bail};\n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+};\n use regex::bytes::{Regex, RegexBuilder};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n@@ -20,8 +26,8 @@ use crate::globset::parse;\n // Note: a/**/b does match a/b, so we need some special logic about path\n // separators\n \n-#[turbo_tasks::value(eq = \"manual\")]\n-#[derive(Debug, Clone)]\n+#[turbo_tasks::value(eq = \"manual\", serialization = \"custom\")]\n+#[derive(Debug, Clone, Serialize, Deserialize)]\n #[serde(into = \"GlobForm\", try_from = \"GlobForm\")]\n pub struct Glob {\n     glob: RcStr,\n@@ -46,8 +52,37 @@ impl Display for Glob {\n         write!(f, \"Glob({})\", self.glob)\n     }\n }\n+\n+impl Encode for Glob {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        self.glob.encode(encoder)?;\n+        self.opts.encode(encoder)?;\n+        Ok(())\n+    }\n+}\n+\n+impl<Context> Decode<Context> for Glob {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        let glob = RcStr::decode(decoder)?;\n+        let opts = GlobOptions::decode(decoder)?;\n+        Glob::parse(glob, opts).map_err(|err| DecodeError::OtherString(err.to_string()))\n+    }\n+}\n+\n #[derive(\n-    Serialize, Deserialize, Copy, Clone, PartialEq, Eq, Hash, Default, TaskInput, TraceRawVcs, Debug,\n+    Serialize,\n+    Deserialize,\n+    Copy,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    Default,\n+    TaskInput,\n+    TraceRawVcs,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n \n pub struct GlobOptions {"
        },
        {
            "sha": "95dc56351604e42099fce980000596372f77b983",
            "filename": "turbopack/crates/turbo-tasks-fs/src/lib.rs",
            "status": "modified",
            "additions": 59,
            "deletions": 5,
            "changes": 64,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -44,6 +44,7 @@ use std::{\n \n use anyhow::{Context, Result, anyhow, bail};\n use auto_hash_map::{AutoMap, AutoSet};\n+use bincode::{Decode, Encode};\n use bitflags::bitflags;\n use dunce::simplified;\n use indexmap::IndexSet;\n@@ -252,31 +253,37 @@ struct DiskFileSystemApplyContext {\n     created_directories: FxHashSet<PathBuf>,\n }\n \n-#[derive(Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue)]\n+#[derive(Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Encode, Decode)]\n struct DiskFileSystemInner {\n     pub name: RcStr,\n     pub root: RcStr,\n     #[turbo_tasks(debug_ignore, trace_ignore)]\n     #[serde(skip)]\n+    #[bincode(skip)]\n     mutex_map: MutexMap<PathBuf>,\n     #[turbo_tasks(debug_ignore, trace_ignore)]\n     #[serde(skip)]\n+    #[bincode(skip)]\n     invalidator_map: InvalidatorMap,\n     #[turbo_tasks(debug_ignore, trace_ignore)]\n     #[serde(skip)]\n+    #[bincode(skip)]\n     dir_invalidator_map: InvalidatorMap,\n     /// Lock that makes invalidation atomic. It will keep a write lock during\n     /// watcher invalidation and a read lock during other operations.\n     #[turbo_tasks(debug_ignore, trace_ignore)]\n     #[serde(skip)]\n+    #[bincode(skip)]\n     invalidation_lock: RwLock<()>,\n     /// Semaphore to limit the maximum number of concurrent file operations.\n     #[turbo_tasks(debug_ignore, trace_ignore)]\n     #[serde(skip, default = \"create_read_semaphore\")]\n+    #[bincode(skip, default = \"create_read_semaphore\")]\n     read_semaphore: tokio::sync::Semaphore,\n     /// Semaphore to limit the maximum number of concurrent file operations.\n     #[turbo_tasks(debug_ignore, trace_ignore)]\n     #[serde(skip, default = \"create_write_semaphore\")]\n+    #[bincode(skip, default = \"create_write_semaphore\")]\n     write_semaphore: tokio::sync::Semaphore,\n \n     #[turbo_tasks(debug_ignore, trace_ignore)]\n@@ -1675,13 +1682,26 @@ pub struct RealPathResult {\n \n /// Errors that can occur when resolving a path with symlinks.\n /// Many of these can be transient conditions that might happen when package managers are running.\n-#[derive(Debug, Clone, Hash, Eq, PartialEq, Serialize, Deserialize, NonLocalValue, TraceRawVcs)]\n+#[derive(\n+    Debug,\n+    Clone,\n+    Hash,\n+    Eq,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    TraceRawVcs,\n+    Encode,\n+    Decode,\n+)]\n pub enum RealPathResultError {\n     TooManySymlinks,\n     CycleDetected,\n     Invalid,\n     NotFound,\n }\n+\n impl RealPathResultError {\n     /// Formats the error message\n     pub fn as_error_message(&self, orig: &FileSystemPath, result: &RealPathResult) -> String {\n@@ -1838,7 +1858,16 @@ impl FileContent {\n }\n \n bitflags! {\n-  #[derive(Default, Serialize, Deserialize, TraceRawVcs, NonLocalValue, DeterministicHash)]\n+  #[derive(\n+    Default,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    DeterministicHash,\n+    Encode,\n+    Decode,\n+  )]\n   pub struct LinkType: u8 {\n       const DIRECTORY = 0b00000001;\n       const ABSOLUTE = 0b00000010;\n@@ -2048,6 +2077,7 @@ pub struct FileMeta {\n     // len: u64,\n     permissions: Permissions,\n     #[serde(with = \"mime_option_serde\")]\n+    #[bincode(with = \"turbo_bincode::mime_option\")]\n     #[turbo_tasks(trace_ignore)]\n     content_type: Option<Mime>,\n }\n@@ -2316,7 +2346,19 @@ pub enum FileLinesContent {\n     NotFound,\n }\n \n-#[derive(Hash, Clone, Debug, PartialEq, Eq, TraceRawVcs, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    Hash,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub enum RawDirectoryEntry {\n     File,\n     Directory,\n@@ -2325,7 +2367,19 @@ pub enum RawDirectoryEntry {\n     Other,\n }\n \n-#[derive(Hash, Clone, Debug, PartialEq, Eq, TraceRawVcs, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    Hash,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub enum DirectoryEntry {\n     File(FileSystemPath),\n     Directory(FileSystemPath),"
        },
        {
            "sha": "9f7ed41401523a6711b9138249b2fe193fd1ccb3",
            "filename": "turbopack/crates/turbo-tasks-fs/src/rope.rs",
            "status": "modified",
            "additions": 48,
            "deletions": 0,
            "changes": 48,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Frope.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Frope.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Frope.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -11,6 +11,13 @@ use std::{\n \n use RopeElem::{Local, Shared};\n use anyhow::{Context, Result};\n+use bincode::{\n+    Decode, Encode,\n+    de::{Decoder, read::Reader as _},\n+    enc::{Encoder, write::Writer as _},\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode,\n+};\n use bytes::Bytes;\n use futures::Stream;\n use serde::{Deserialize, Deserializer, Serialize, Serializer};\n@@ -407,6 +414,47 @@ impl<'de> Deserialize<'de> for Rope {\n     }\n }\n \n+/// Encode as a len + raw bytes format using the encoder's [`bincode::enc::write::Writer`]. Encoding\n+/// [`Rope::to_bytes`] instead would be easier, but would require copying to an intermediate buffer.\n+///\n+/// This len + bytes format is similar to how bincode would normally encode a `&[u8]`:\n+/// https://docs.rs/bincode/latest/bincode/spec/index.html#collections\n+impl Encode for Rope {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        self.length.encode(encoder)?;\n+        let mut reader = self.read();\n+        for chunk in &mut reader {\n+            encoder.writer().write(chunk)?;\n+        }\n+\n+        Ok(())\n+    }\n+}\n+\n+impl<Context> Decode<Context> for Rope {\n+    #[allow(clippy::uninit_vec)]\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        let length = usize::decode(decoder)?;\n+        let mut bytes = Vec::with_capacity(length);\n+\n+        // SAFETY:\n+        // - `bytes` has capacity of `length` already\n+        // - `read` writes to (does not read) `bytes` and will return an error if exactly `length`\n+        //   bytes is not written, so no uninitialized memory ever escapes this function.\n+        // We can't use `MaybeUninit` here because `read` doesn't support it.\n+        unsafe {\n+            bytes.set_len(length);\n+        }\n+        // the decoder API requires that we claim a length *before* reading (not after)\n+        decoder.claim_bytes_read(length)?;\n+        decoder.reader().read(&mut bytes)?;\n+\n+        Ok(Rope::from(bytes))\n+    }\n+}\n+\n+impl_borrow_decode!(Rope);\n+\n pub mod ser_as_string {\n     use serde::{Serializer, ser::Error};\n "
        },
        {
            "sha": "7172b80dd414d630be8c74a6fc1c7f1e231868fd",
            "filename": "turbopack/crates/turbo-tasks-fs/src/watcher.rs",
            "status": "modified",
            "additions": 10,
            "deletions": 2,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Fwatcher.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Fwatcher.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Fwatcher.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -12,6 +12,7 @@ use std::{\n };\n \n use anyhow::{Context, Result};\n+use bincode::{Decode, Encode};\n use notify::{\n     Config, EventKind, PollWatcher, RecommendedWatcher, RecursiveMode, Watcher,\n     event::{MetadataKind, ModifyKind, RenameMode},\n@@ -60,9 +61,10 @@ static WATCH_RECURSIVE_MODE: LazyLock<RecursiveMode> = LazyLock::new(|| {\n     }\n });\n \n-#[derive(Serialize, Deserialize)]\n+#[derive(Serialize, Deserialize, Encode, Decode)]\n pub(crate) struct DiskWatcher {\n-    #[serde(skip, default = \"State::new_stopped\")]\n+    #[serde(skip)]\n+    #[bincode(skip)]\n     state: State,\n }\n \n@@ -73,6 +75,12 @@ enum State {\n     NonRecursive(RwLock<NonRecursiveState>),\n }\n \n+impl Default for State {\n+    fn default() -> Self {\n+        State::new_stopped()\n+    }\n+}\n+\n enum StateWriteGuard<'a> {\n     Recursive(RwLockWriteGuard<'a, RecursiveState>),\n     NonRecursive(RwLockWriteGuard<'a, NonRecursiveState>),"
        },
        {
            "sha": "3792881043e25c45ef7b013acf5eb4fcc8b3bbae",
            "filename": "turbopack/crates/turbo-tasks-macros/src/value_macro.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Fvalue_macro.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Fvalue_macro.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Fvalue_macro.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -302,8 +302,11 @@ pub fn value(args: TokenStream, input: TokenStream) -> TokenStream {\n                 #[derive(\n                     turbo_tasks::macro_helpers::serde::Serialize,\n                     turbo_tasks::macro_helpers::serde::Deserialize,\n+                    turbo_tasks::macro_helpers::bincode::Encode,\n+                    turbo_tasks::macro_helpers::bincode::Decode,\n                 )]\n                 #[serde(crate = \"turbo_tasks::macro_helpers::serde\")]\n+                #[bincode(crate = \"turbo_tasks::macro_helpers::bincode\")]\n             });\n             if transparent {\n                 struct_attributes.push(quote! {"
        },
        {
            "sha": "71aeb02d79bd7a7598d17c02ed87b5d705038516",
            "filename": "turbopack/crates/turbo-tasks/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -25,6 +25,7 @@ workspace = true\n anyhow = { workspace = true }\n async-trait = { workspace = true }\n auto-hash-map = { workspace = true }\n+bincode = { workspace = true }\n concurrent-queue = { workspace = true }\n dashmap = { workspace = true }\n either = { workspace = true }"
        },
        {
            "sha": "c2510ca98d017ca225a75af1f9cf32eae1b34f39",
            "filename": "turbopack/crates/turbo-tasks/src/id.rs",
            "status": "modified",
            "additions": 60,
            "deletions": 33,
            "changes": 93,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fid.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fid.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fid.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -5,6 +5,13 @@ use std::{\n     ops::Deref,\n };\n \n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode,\n+};\n use serde::{Deserialize, Serialize, de::Visitor};\n \n use crate::{\n@@ -118,19 +125,19 @@ macro_rules! define_id {\n     };\n }\n \n-define_id!(TaskId: u32, derive(Serialize, Deserialize), serde(transparent));\n+define_id!(TaskId: u32, derive(Serialize, Deserialize, Encode, Decode), serde(transparent));\n define_id!(FunctionId: u16);\n define_id!(ValueTypeId: u16);\n define_id!(TraitTypeId: u16);\n define_id!(\n     LocalTaskId: u32,\n-    derive(Debug, Serialize, Deserialize),\n+    derive(Debug, Serialize, Deserialize, Encode, Decode),\n     serde(transparent),\n     doc = \"Represents the nth `local` function call inside a task.\",\n );\n define_id!(\n     ExecutionId: u16,\n-    derive(Debug, Serialize, Deserialize),\n+    derive(Debug, Serialize, Deserialize, Encode, Decode),\n     serde(transparent),\n     doc = \"An identifier for a specific task execution. Used to assert that local `Vc`s don't \\\n         leak. This value may overflow and re-use old values.\",\n@@ -158,8 +165,8 @@ impl TaskId {\n     }\n }\n \n-macro_rules! make_serializable {\n-    ($ty:ty, $get_object:path, $validate_type_id:path, $visitor_name:ident) => {\n+macro_rules! make_registered_serializable {\n+    ($ty:ty, $primitive:ty, $get_object:path, $validate_type_id:path $(,)?) => {\n         impl Serialize for $ty {\n             fn serialize<S>(&self, serializer: S) -> Result<S::Ok, S::Error>\n             where\n@@ -174,33 +181,32 @@ macro_rules! make_serializable {\n             where\n                 D: serde::Deserializer<'de>,\n             {\n-                deserializer.deserialize_u16($visitor_name)\n-            }\n-        }\n-\n-        struct $visitor_name;\n-\n-        impl<'de> Visitor<'de> for $visitor_name {\n-            type Value = $ty;\n+                struct DeserializeVisitor;\n+                impl<'de> Visitor<'de> for DeserializeVisitor {\n+                    type Value = $ty;\n \n-            fn expecting(&self, formatter: &mut std::fmt::Formatter) -> std::fmt::Result {\n-                formatter.write_str(concat!(\"an id of a registered \", stringify!($ty)))\n-            }\n+                    fn expecting(&self, formatter: &mut std::fmt::Formatter) -> std::fmt::Result {\n+                        formatter.write_str(concat!(\"an id of a registered \", stringify!($ty)))\n+                    }\n \n-            fn visit_u16<E>(self, v: u16) -> Result<Self::Value, E>\n-            where\n-                E: serde::de::Error,\n-            {\n-                match Self::Value::new(v) {\n-                    Some(value) => {\n-                        if let Some(error) = $validate_type_id(value) {\n-                            Err(E::custom(error))\n-                        } else {\n-                            Ok(value)\n+                    fn visit_u16<E>(self, v: u16) -> Result<Self::Value, E>\n+                    where\n+                        E: serde::de::Error,\n+                    {\n+                        match Self::Value::new(v) {\n+                            Some(value) => {\n+                                if let Some(error) = $validate_type_id(value) {\n+                                    Err(E::custom(error))\n+                                } else {\n+                                    Ok(value)\n+                                }\n+                            }\n+                            None => Err(E::unknown_variant(&format!(\"{v}\"), &[\"a non zero u16\"])),\n                         }\n                     }\n-                    None => Err(E::unknown_variant(&format!(\"{v}\"), &[\"a non zero u16\"])),\n                 }\n+\n+                deserializer.deserialize_u16(DeserializeVisitor)\n             }\n         }\n \n@@ -212,24 +218,45 @@ macro_rules! make_serializable {\n                     .finish()\n             }\n         }\n+\n+        impl Encode for $ty {\n+            fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+                <NonZero<$primitive> as Encode>::encode(&self.id, encoder)\n+            }\n+        }\n+\n+        impl<Context> Decode<Context> for $ty {\n+            fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+                let value = Self {\n+                    id: NonZero::<$primitive>::decode(decoder)?,\n+                };\n+                if let Some(error) = $validate_type_id(value) {\n+                    Err(DecodeError::OtherString(error.to_string()))\n+                } else {\n+                    Ok(value)\n+                }\n+            }\n+        }\n+\n+        impl_borrow_decode!($ty);\n     };\n }\n \n-make_serializable!(\n+make_registered_serializable!(\n     ValueTypeId,\n+    u16,\n     registry::get_value_type,\n     registry::validate_value_type_id,\n-    ValueTypeVisitor\n );\n-make_serializable!(\n+make_registered_serializable!(\n     TraitTypeId,\n+    u16,\n     registry::get_trait,\n     registry::validate_trait_type_id,\n-    TraitTypeVisitor\n );\n-make_serializable!(\n+make_registered_serializable!(\n     FunctionId,\n+    u16,\n     registry::get_native_function,\n     registry::validate_function_id,\n-    FunctionTypeVisitor\n );"
        },
        {
            "sha": "7b1ee82d01e47099685434115dd73e481df2066f",
            "filename": "turbopack/crates/turbo-tasks/src/invalidation.rs",
            "status": "modified",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Finvalidation.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Finvalidation.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Finvalidation.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -6,6 +6,13 @@ use std::{\n };\n \n use anyhow::Result;\n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode,\n+};\n use indexmap::map::Entry;\n use serde::{Deserialize, Serialize, de::Visitor};\n use tokio::runtime::Handle;\n@@ -144,6 +151,24 @@ impl<'de> Deserialize<'de> for Invalidator {\n     }\n }\n \n+impl Encode for Invalidator {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        Encode::encode(&self.task, encoder)\n+    }\n+}\n+\n+impl<Context> Decode<Context> for Invalidator {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        Ok(Invalidator {\n+            task: Decode::decode(decoder)?,\n+            turbo_tasks: with_turbo_tasks(Arc::downgrade),\n+            handle: tokio::runtime::Handle::current(),\n+        })\n+    }\n+}\n+\n+impl_borrow_decode!(Invalidator);\n+\n /// A user-facing reason why a task was invalidated. This should only be used\n /// for invalidation that were triggered by the user.\n ///"
        },
        {
            "sha": "a6f0bef9db73460b8d58c947fcc4caee1ce4dd0e",
            "filename": "turbopack/crates/turbo-tasks/src/macro_helpers.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fmacro_helpers.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fmacro_helpers.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fmacro_helpers.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n //! Runtime helpers for [turbo-tasks-macro].\n \n pub use async_trait::async_trait;\n+pub use bincode;\n pub use once_cell::sync::{Lazy, OnceCell};\n use rustc_hash::FxHashMap;\n pub use serde;"
        },
        {
            "sha": "9e3614cfbca0d3691ff23b9c9ae687106f3629ef",
            "filename": "turbopack/crates/turbo-tasks/src/manager.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fmanager.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fmanager.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fmanager.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -13,6 +13,7 @@ use std::{\n \n use anyhow::{Result, anyhow};\n use auto_hash_map::AutoMap;\n+use bincode::{Decode, Encode};\n use rustc_hash::FxHasher;\n use serde::{Deserialize, Serialize};\n use tokio::{select, sync::mpsc::Receiver, task_local};\n@@ -268,7 +269,7 @@ pub struct UpdateInfo {\n     placeholder_for_future_fields: (),\n }\n \n-#[derive(Clone, Copy, Debug, Eq, PartialEq, Hash, Serialize, Deserialize)]\n+#[derive(Clone, Copy, Debug, Eq, PartialEq, Hash, Serialize, Deserialize, Encode, Decode)]\n pub enum TaskPersistence {\n     /// Tasks that may be persisted across sessions using serialization.\n     Persistent,"
        },
        {
            "sha": "b97e08b2e5da9bdffe3d30ac37d65c070b9f6315",
            "filename": "turbopack/crates/turbo-tasks/src/raw_vc.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fraw_vc.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fraw_vc.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fraw_vc.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -7,6 +7,7 @@ use std::{\n \n use anyhow::Result;\n use auto_hash_map::AutoSet;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use thiserror::Error;\n \n@@ -35,7 +36,7 @@ pub enum ResolveTypeError {\n     ReadError { source: anyhow::Error },\n }\n \n-#[derive(Debug, Clone, Copy, PartialEq, Eq, Hash, Serialize, Deserialize)]\n+#[derive(Debug, Clone, Copy, PartialEq, Eq, Hash, Serialize, Deserialize, Encode, Decode)]\n pub struct CellId {\n     pub type_id: ValueTypeId,\n     pub index: u32,\n@@ -61,7 +62,7 @@ impl Display for CellId {\n /// otherwise be treated as an internal implementation detail of `turbo-tasks`.\n ///\n /// [monomorphization]: https://doc.rust-lang.org/book/ch10-01-syntax.html#performance-of-code-using-generics\n-#[derive(Clone, Copy, PartialEq, Eq, Hash, Serialize, Deserialize)]\n+#[derive(Clone, Copy, PartialEq, Eq, Hash, Serialize, Deserialize, Encode, Decode)]\n pub enum RawVc {\n     /// The synchronous return value of a task (after argument resolution). This is the\n     /// representation used by [`OperationVc`][crate::OperationVc]."
        },
        {
            "sha": "0478fd6a10623f998a68efb85fea22ec23f935bf",
            "filename": "turbopack/crates/turbo-tasks/src/read_ref.rs",
            "status": "modified",
            "additions": 28,
            "deletions": 0,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fread_ref.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fread_ref.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fread_ref.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -7,6 +7,13 @@ use std::{\n     ops::Deref,\n };\n \n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode_with_context,\n+};\n use serde::{Deserialize, Serialize};\n use turbo_tasks_hash::DeterministicHash;\n \n@@ -212,6 +219,27 @@ where\n     }\n }\n \n+impl<T> Encode for ReadRef<T>\n+where\n+    T: Encode,\n+{\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        Self::as_raw_ref(self).encode(encoder)\n+    }\n+}\n+\n+impl<Context, T> Decode<Context> for ReadRef<T>\n+where\n+    T: Decode<Context>,\n+{\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        let value = T::decode(decoder)?;\n+        Ok(Self(triomphe::Arc::new(value)))\n+    }\n+}\n+\n+impl_borrow_decode_with_context!(ReadRef<T>, Context, Context, T: Decode<Context>);\n+\n impl<T> ReadRef<T> {\n     pub fn new_owned(value: T) -> Self {\n         Self(triomphe::Arc::new(value))"
        },
        {
            "sha": "b33871a64fa714c30198b9fbf931541076cc76cc",
            "filename": "turbopack/crates/turbo-tasks/src/serialization_invalidation.rs",
            "status": "modified",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fserialization_invalidation.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fserialization_invalidation.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fserialization_invalidation.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -3,6 +3,13 @@ use std::{\n     sync::{Arc, Weak},\n };\n \n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode,\n+};\n use serde::{Deserialize, Serialize, de::Visitor};\n use tokio::runtime::Handle;\n \n@@ -94,3 +101,21 @@ impl<'de> Deserialize<'de> for SerializationInvalidator {\n         deserializer.deserialize_newtype_struct(\"SerializationInvalidator\", V)\n     }\n }\n+\n+impl Encode for SerializationInvalidator {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        Encode::encode(&self.task, encoder)\n+    }\n+}\n+\n+impl<Context> Decode<Context> for SerializationInvalidator {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        Ok(SerializationInvalidator {\n+            task: Decode::decode(decoder)?,\n+            turbo_tasks: with_turbo_tasks(Arc::downgrade),\n+            handle: tokio::runtime::Handle::current(),\n+        })\n+    }\n+}\n+\n+impl_borrow_decode!(SerializationInvalidator);"
        },
        {
            "sha": "ca498c121ed9ba71550a73ecf50afd959588305e",
            "filename": "turbopack/crates/turbo-tasks/src/state.rs",
            "status": "modified",
            "additions": 45,
            "deletions": 21,
            "changes": 66,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fstate.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fstate.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fstate.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -6,6 +6,7 @@ use std::{\n };\n \n use auto_hash_map::AutoSet;\n+use bincode::{Decode, Encode};\n use parking_lot::{Mutex, MutexGuard};\n use serde::{Deserialize, Serialize};\n use tracing::trace_span;\n@@ -15,7 +16,7 @@ use crate::{\n     mark_stateful, trace::TraceRawVcs,\n };\n \n-#[derive(Serialize, Deserialize)]\n+#[derive(Serialize, Deserialize, Encode, Decode)]\n struct StateInner<T> {\n     value: T,\n     invalidators: AutoSet<Invalidator>,\n@@ -102,6 +103,41 @@ impl<T> Drop for StateRef<'_, T> {\n     }\n }\n \n+mod parking_lot_mutex_bincode {\n+    use bincode::{\n+        BorrowDecode,\n+        de::{BorrowDecoder, Decoder},\n+        enc::Encoder,\n+        error::{DecodeError, EncodeError},\n+    };\n+\n+    use super::*;\n+\n+    pub fn encode<T: Encode, E: Encoder>(\n+        mutex: &Mutex<T>,\n+        encoder: &mut E,\n+    ) -> Result<(), EncodeError> {\n+        mutex.lock().encode(encoder)\n+    }\n+\n+    pub fn decode<Context, T: Decode<Context>, D: Decoder<Context = Context>>(\n+        decoder: &mut D,\n+    ) -> Result<Mutex<T>, DecodeError> {\n+        Ok(Mutex::new(T::decode(decoder)?))\n+    }\n+\n+    pub fn borrow_decode<\n+        'de,\n+        Context,\n+        T: BorrowDecode<'de, Context>,\n+        D: BorrowDecoder<'de, Context = Context>,\n+    >(\n+        decoder: &mut D,\n+    ) -> Result<Mutex<T>, DecodeError> {\n+        Ok(Mutex::new(T::borrow_decode(decoder)?))\n+    }\n+}\n+\n /// **This API violates core assumption of turbo-tasks, is believed to be unsound, and there's no\n /// plan fix it.** You should prefer to use [collectibles][crate::CollectiblesSource] instead of\n /// state where at all possible. This API may be removed in the future.\n@@ -125,9 +161,10 @@ impl<T> Drop for StateRef<'_, T> {\n /// [strong consistency]: crate::OperationVc::read_strongly_consistent\n /// [`OperationVc`]: crate::OperationVc\n /// [`OperationValue`]: crate::OperationValue\n-#[derive(Serialize, Deserialize)]\n+#[derive(Serialize, Deserialize, Encode, Decode)]\n pub struct State<T> {\n     serialization_invalidator: SerializationInvalidator,\n+    #[bincode(with = \"parking_lot_mutex_bincode\")]\n     inner: Mutex<StateInner<T>>,\n }\n \n@@ -235,29 +272,16 @@ impl<T: PartialEq> State<T> {\n     }\n }\n \n+#[derive(Serialize, Deserialize, Encode, Decode)]\n+#[bincode(bounds = \"\")]\n pub struct TransientState<T> {\n+    #[serde(skip, default = \"default_transient_state_inner\")]\n+    #[bincode(skip, default = \"default_transient_state_inner\")]\n     inner: Mutex<StateInner<Option<T>>>,\n }\n \n-impl<T> Serialize for TransientState<T> {\n-    fn serialize<S>(&self, serializer: S) -> Result<S::Ok, S::Error>\n-    where\n-        S: serde::Serializer,\n-    {\n-        Serialize::serialize(&(), serializer)\n-    }\n-}\n-\n-impl<'de, T> Deserialize<'de> for TransientState<T> {\n-    fn deserialize<D>(deserializer: D) -> Result<TransientState<T>, D::Error>\n-    where\n-        D: serde::Deserializer<'de>,\n-    {\n-        let () = Deserialize::deserialize(deserializer)?;\n-        Ok(TransientState {\n-            inner: Mutex::new(StateInner::new(Default::default())),\n-        })\n-    }\n+fn default_transient_state_inner<T>() -> Mutex<StateInner<Option<T>>> {\n+    Mutex::new(StateInner::new(None))\n }\n \n impl<T: Debug> Debug for TransientState<T> {"
        },
        {
            "sha": "260a8797f8e7ed7ffc01fa200c8207cbda0ed0c8",
            "filename": "turbopack/crates/turbo-tasks/src/util.rs",
            "status": "modified",
            "additions": 39,
            "deletions": 5,
            "changes": 44,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Futil.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Futil.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Futil.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -14,10 +14,16 @@ use std::{\n };\n \n use anyhow::{Error, anyhow};\n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+};\n use pin_project_lite::pin_project;\n use serde::{Deserialize, Deserializer, Serialize, Serializer};\n \n-pub use super::{\n+pub use crate::{\n     id_factory::{IdFactory, IdFactoryWithReuse},\n     once_map::*,\n };\n@@ -89,17 +95,45 @@ impl<'de> Deserialize<'de> for SharedError {\n     fn deserialize<D: Deserializer<'de>>(deserializer: D) -> Result<Self, D::Error> {\n         use serde::de::Error;\n         let mut messages = <Vec<String>>::deserialize(deserializer)?;\n-        let mut e = match messages.pop() {\n-            Some(e) => anyhow!(e),\n-            None => return Err(Error::custom(\"expected at least 1 error message\")),\n-        };\n+        let msg = messages\n+            .pop()\n+            .ok_or_else(|| Error::custom(\"expected at least 1 error message\"))?;\n+        let mut e = anyhow!(msg);\n+        while let Some(message) = messages.pop() {\n+            e = e.context(message);\n+        }\n+        Ok(SharedError::new(e))\n+    }\n+}\n+\n+impl Encode for SharedError {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        let mut v = vec![self.to_string()];\n+        let mut source = self.source();\n+        while let Some(s) = source {\n+            v.push(s.to_string());\n+            source = s.source();\n+        }\n+        Encode::encode(&v, encoder)\n+    }\n+}\n+\n+impl<Context> Decode<Context> for SharedError {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        let mut messages = <Vec<String>>::decode(decoder)?;\n+        let msg = messages\n+            .pop()\n+            .ok_or(DecodeError::Other(\"expected at least 1 error message\"))?;\n+        let mut e = anyhow!(msg);\n         while let Some(message) = messages.pop() {\n             e = e.context(message);\n         }\n         Ok(SharedError::new(e))\n     }\n }\n \n+bincode::impl_borrow_decode!(SharedError);\n+\n impl Deref for SharedError {\n     type Target = Arc<Error>;\n     fn deref(&self) -> &Self::Target {"
        },
        {
            "sha": "2fd35bdefdbb037cfcc5c046302a7a87ced44a6d",
            "filename": "turbopack/crates/turbo-tasks/src/vc/mod.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -17,6 +17,7 @@ use std::{\n };\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use shrink_to_fit::ShrinkToFit;\n \n@@ -161,8 +162,9 @@ type VcReadTarget<T> = <<T as VcValueType>::Read as VcRead<T>>::Target;\n /// [book-cells]: https://turbopack-rust-docs.vercel.sh/turbo-engine/cells.html\n /// [collectibles]: crate::CollectiblesSource\n #[must_use]\n-#[derive(Serialize, Deserialize)]\n+#[derive(Serialize, Deserialize, Encode, Decode)]\n #[serde(transparent, bound = \"\")]\n+#[bincode(bounds = \"T: ?Sized\")]\n #[repr(transparent)]\n pub struct Vc<T>\n where"
        },
        {
            "sha": "2858042155b007b1f28dc2e2700e01bdbf29b467",
            "filename": "turbopack/crates/turbo-tasks/src/vc/operation.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 20,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Foperation.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Foperation.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Foperation.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -2,6 +2,7 @@ use std::{fmt::Debug, hash::Hash, marker::PhantomData};\n \n use anyhow::Result;\n use auto_hash_map::AutoSet;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n pub use turbo_tasks_macros::OperationValue;\n \n@@ -48,6 +49,9 @@ use crate::{\n /// [`State`]: crate::State\n /// [`ReadRef`]: crate::ReadRef\n #[must_use]\n+#[derive(Serialize, Deserialize, Encode, Decode)]\n+#[serde(transparent, bound = \"\")]\n+#[bincode(bounds = \"T: ?Sized\")]\n #[repr(transparent)]\n pub struct OperationVc<T>\n where\n@@ -207,26 +211,6 @@ where\n     }\n }\n \n-impl<T> Serialize for OperationVc<T>\n-where\n-    T: ?Sized,\n-{\n-    fn serialize<S: serde::Serializer>(&self, serializer: S) -> Result<S::Ok, S::Error> {\n-        self.node.serialize(serializer)\n-    }\n-}\n-\n-impl<'de, T> Deserialize<'de> for OperationVc<T>\n-where\n-    T: ?Sized,\n-{\n-    fn deserialize<D: serde::Deserializer<'de>>(deserializer: D) -> Result<Self, D::Error> {\n-        Ok(OperationVc {\n-            node: Vc::deserialize(deserializer)?,\n-        })\n-    }\n-}\n-\n impl<T> TraceRawVcs for OperationVc<T>\n where\n     T: ?Sized,"
        },
        {
            "sha": "a0aa4b442d5354f8aba0031b6b7d289609a8245c",
            "filename": "turbopack/crates/turbo-tasks/src/vc/resolved.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Fresolved.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Fresolved.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Fresolved.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -9,6 +9,7 @@ use std::{\n };\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n \n use crate::{\n@@ -64,8 +65,9 @@ use crate::{\n /// [`NonLocalValue`]: crate::NonLocalValue\n /// [rewritten external signature]: https://turbopack-rust-docs.vercel.sh/turbo-engine/tasks.html#external-signature-rewriting\n /// [`ReadRef`]: crate::ReadRef\n-#[derive(Serialize, Deserialize)]\n+#[derive(Serialize, Deserialize, Encode, Decode)]\n #[serde(transparent, bound = \"\")]\n+#[bincode(bounds = \"T: ?Sized\")]\n #[repr(transparent)]\n pub struct ResolvedVc<T>\n where"
        },
        {
            "sha": "c70b422816b69da142491fffafdbea9867964179",
            "filename": "turbopack/crates/turbopack-analyze/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-analyze%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-analyze%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-analyze%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -10,6 +10,7 @@ bench = false\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n rustc-hash = { workspace = true }\n serde = { workspace = true, features = [\"derive\"] }\n turbo-rcstr = { workspace = true }"
        },
        {
            "sha": "da706a7bdc8c1ad20aaa42c42077b5f4d22904a4",
            "filename": "turbopack/crates/turbopack-analyze/src/split_chunk.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-analyze%2Fsrc%2Fsplit_chunk.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-analyze%2Fsrc%2Fsplit_chunk.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-analyze%2Fsrc%2Fsplit_chunk.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::mem::replace;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{FxIndexMap, NonLocalValue, ValueToString, Vc, trace::TraceRawVcs};\n@@ -11,14 +12,18 @@ use turbopack_core::{\n     source_map::{GenerateSourceMap, OriginalToken, SourceMap, SyntheticToken, Token},\n };\n \n-#[derive(Clone, Debug, Deserialize, Eq, NonLocalValue, PartialEq, Serialize, TraceRawVcs)]\n+#[derive(\n+    Clone, Debug, Deserialize, Eq, NonLocalValue, PartialEq, Serialize, TraceRawVcs, Encode, Decode,\n+)]\n pub struct ChunkPartRange {\n     pub line: u32,\n     pub start_column: u32,\n     pub end_column: u32,\n }\n \n-#[derive(Clone, Debug, Deserialize, Eq, NonLocalValue, PartialEq, Serialize, TraceRawVcs)]\n+#[derive(\n+    Clone, Debug, Deserialize, Eq, NonLocalValue, PartialEq, Serialize, TraceRawVcs, Encode, Decode,\n+)]\n pub struct ChunkPart {\n     pub source: RcStr,\n     pub real_size: u32,"
        },
        {
            "sha": "fd634233594b7e918bd0c6cd44d018532973d959",
            "filename": "turbopack/crates/turbopack-browser/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-browser%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -20,6 +20,7 @@ workspace = true\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n either = { workspace = true }\n indoc = { workspace = true }\n serde = { workspace = true }\n@@ -28,6 +29,7 @@ serde_qs = { workspace = true }\n tracing = { workspace = true }\n urlencoding = { workspace = true }\n \n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-fs = { workspace = true }"
        },
        {
            "sha": "1f8f2d9a9d879fb6977fc3d08d4c6855cc776f9d",
            "filename": "turbopack/crates/turbopack-browser/src/chunking_context.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fchunking_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fchunking_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fchunking_context.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use tracing::Instrument;\n use turbo_rcstr::{RcStr, rcstr};\n@@ -65,6 +66,8 @@ pub const CURRENT_CHUNK_METHOD_DOCUMENT_CURRENT_SCRIPT_EXPR: &str =\n     TraceRawVcs,\n     DeterministicHash,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ContentHashing {\n     /// Direct content hashing: Embeds the chunk content hash directly into the referencing chunk.\n@@ -252,12 +255,14 @@ pub struct BrowserChunkingContext {\n     /// This path is used to compute the url to request assets from\n     client_root: FileSystemPath,\n     /// This path is used to compute the url to request chunks or assets from\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     client_roots: FxIndexMap<RcStr, FileSystemPath>,\n     /// Chunks are placed at this path\n     chunk_root_path: FileSystemPath,\n     /// Static assets are placed at this path\n     asset_root_path: FileSystemPath,\n     /// Static assets are placed at this path\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     asset_root_paths: FxIndexMap<RcStr, FileSystemPath>,\n     /// Base path that will be prepended to all chunk URLs when loading them.\n     /// This path will not appear in chunk paths or chunk data.\n@@ -270,6 +275,7 @@ pub struct BrowserChunkingContext {\n     asset_base_path: Option<RcStr>,\n     /// URL prefix that will be prepended to all static asset URLs when loading\n     /// them.\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     asset_base_paths: FxIndexMap<RcStr, RcStr>,\n     /// Enable HMR for this chunking\n     enable_hot_module_replacement: bool,"
        },
        {
            "sha": "a9c0ed7a6fe4c4caf7b4be25e23dc72162087969",
            "filename": "turbopack/crates/turbopack-browser/src/ecmascript/content_entry.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Fcontent_entry.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Fcontent_entry.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Fcontent_entry.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -38,6 +38,7 @@ impl EcmascriptDevChunkContentEntry {\n \n #[turbo_tasks::value(transparent)]\n pub struct EcmascriptBrowserChunkContentEntries(\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     FxIndexMap<ReadRef<ModuleId>, EcmascriptDevChunkContentEntry>,\n );\n "
        },
        {
            "sha": "626f6b7f953f82d1adc9765368d62be7c8873560",
            "filename": "turbopack/crates/turbopack-browser/src/ecmascript/list/asset.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Flist%2Fasset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Flist%2Fasset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Flist%2Fasset.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{NonLocalValue, ResolvedVc, TaskInput, ValueToString, Vc, trace::TraceRawVcs};\n@@ -128,6 +129,8 @@ impl Asset for EcmascriptDevChunkList {\n     TraceRawVcs,\n     Serialize,\n     Deserialize,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub enum EcmascriptDevChunkListSource {"
        },
        {
            "sha": "39dba810834859beff051186739aeb4a48365b0c",
            "filename": "turbopack/crates/turbopack-browser/src/ecmascript/list/content.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Flist%2Fcontent.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Flist%2Fcontent.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Flist%2Fcontent.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::io::Write;\n \n use anyhow::{Context, Result};\n+use bincode::{Decode, Encode};\n use either::Either;\n use indoc::writedoc;\n use serde::{Deserialize, Serialize};\n@@ -29,7 +30,9 @@ use crate::chunking_context::{\n     CURRENT_CHUNK_METHOD_DOCUMENT_CURRENT_SCRIPT_EXPR, CurrentChunkMethod,\n };\n \n-#[derive(Clone, Debug, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue)]\n+#[derive(\n+    Clone, Debug, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue, Encode, Decode,\n+)]\n enum CurrentChunkMethodWithData {\n     StringLiteral(RcStr),\n     DocumentCurrentScript,\n@@ -39,6 +42,7 @@ enum CurrentChunkMethodWithData {\n #[turbo_tasks::value]\n pub(super) struct EcmascriptDevChunkListContent {\n     current_chunk_method: CurrentChunkMethodWithData,\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub(super) chunks_contents: FxIndexMap<String, ResolvedVc<Box<dyn VersionedContent>>>,\n     source: EcmascriptDevChunkListSource,\n }"
        },
        {
            "sha": "ff4adad7218815add487f1be557c7fd8fdd69cbe",
            "filename": "turbopack/crates/turbopack-core/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -16,6 +16,7 @@ workspace = true\n anyhow = { workspace = true }\n async-trait = { workspace = true }\n auto-hash-map = { workspace = true }\n+bincode = { workspace = true }\n bitfield = { workspace = true }\n browserslist-rs = { workspace = true }\n bytes-str = { workspace = true }\n@@ -37,6 +38,7 @@ smallvec = { workspace = true }\n swc_sourcemap = { workspace = true }\n swc_core = { workspace = true, features = [\"ecma_preset_env\", \"common\"] }\n tracing = { workspace = true }\n+turbo-bincode = { workspace = true }\n turbo-prehash = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }"
        },
        {
            "sha": "56d151d5687c1bb72d3e21338d2263d5444d2b0f",
            "filename": "turbopack/crates/turbopack-core/src/chunk/availability_info.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Favailability_info.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Favailability_info.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Favailability_info.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,13 +1,14 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use bitfield::bitfield;\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, ResolvedVc, TaskInput, Vc, trace::TraceRawVcs};\n \n-use super::available_modules::{AvailableModules, AvailableModulesSet};\n+use crate::chunk::available_modules::{AvailableModules, AvailableModulesSet};\n \n bitfield! {\n-    #[derive(Clone, Copy, Default, TaskInput, TraceRawVcs, NonLocalValue, Serialize, Deserialize, PartialEq, Eq, Hash)]\n+    #[derive(Clone, Copy, Default, TaskInput, TraceRawVcs, NonLocalValue, Serialize, Deserialize, PartialEq, Eq, Hash, Encode, Decode)]\n     pub struct AvailabilityFlags(u8);\n     impl Debug;\n     pub is_in_async_module, set_is_in_async_module: 0;\n@@ -25,6 +26,8 @@ bitfield! {\n     NonLocalValue,\n     Serialize,\n     Deserialize,\n+    Encode,\n+    Decode,\n )]\n pub struct AvailabilityInfo {\n     flags: AvailabilityFlags,"
        },
        {
            "sha": "da3e6b7ab8535b40dbb54528f7fb8e71d89d349d",
            "filename": "turbopack/crates/turbopack-core/src/chunk/available_modules.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Favailable_modules.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Favailable_modules.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Favailable_modules.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{\n     FxIndexSet, NonLocalValue, ReadRef, ResolvedVc, TaskInput, TryJoinIterExt, ValueToString, Vc,\n@@ -24,6 +25,8 @@ use crate::{\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum AvailableModuleItem {\n     Module(ResolvedVc<Box<dyn ChunkableModule>>),\n@@ -61,7 +64,9 @@ impl From<ChunkableModuleOrBatch> for AvailableModuleItem {\n \n #[turbo_tasks::value(transparent)]\n #[derive(Debug, Clone)]\n-pub struct AvailableModulesSet(FxIndexSet<AvailableModuleItem>);\n+pub struct AvailableModulesSet(\n+    #[bincode(with = \"turbo_bincode::indexset\")] FxIndexSet<AvailableModuleItem>,\n+);\n \n /// Allows to gather information about which assets are already available.\n /// Adding more roots will form a linked list like structure to allow caching"
        },
        {
            "sha": "e8f7a7aface8211165980f6a5c2b276575f88b63",
            "filename": "turbopack/crates/turbopack-core/src/chunk/chunk_item_batch.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunk_item_batch.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunk_item_batch.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunk_item_batch.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{future::Future, hash::Hash, ops::Deref};\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use either::Either;\n use rustc_hash::FxHashMap;\n use serde::{Deserialize, Serialize};\n@@ -49,7 +50,18 @@ pub async fn attach_async_info_to_chunkable_module(\n }\n \n #[derive(\n-    Debug, Clone, PartialEq, Eq, Hash, Serialize, Deserialize, TraceRawVcs, NonLocalValue, TaskInput,\n+    Debug,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum ChunkItemOrBatchWithAsyncModuleInfo {\n     ChunkItem(ChunkItemWithAsyncModuleInfo),"
        },
        {
            "sha": "5d0621cd43348ebf7432a88c5bacf8ff620391a9",
            "filename": "turbopack/crates/turbopack-core/src/chunk/chunking/mod.rs",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::future::IntoFuture;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use rustc_hash::FxHashMap;\n use serde::{Deserialize, Serialize};\n use smallvec::{SmallVec, smallvec};\n@@ -50,7 +51,16 @@ struct BatchChunkItemsWithInfo(\n );\n \n #[derive(\n-    Clone, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, ValueDebugFormat,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    ValueDebugFormat,\n+    Encode,\n+    Decode,\n )]\n enum ChunkItemOrBatchWithInfo {\n     ChunkItem {"
        },
        {
            "sha": "b60ce14c6df1c2200483f8af8815715ea79bebe5",
            "filename": "turbopack/crates/turbopack-core/src/chunk/chunking_context.rs",
            "status": "modified",
            "additions": 11,
            "deletions": 2,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking_context.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,15 +1,18 @@\n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use rustc_hash::FxHashMap;\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, ResolvedVc, TaskInput, Upcast, Vc, trace::TraceRawVcs};\n use turbo_tasks_fs::FileSystemPath;\n use turbo_tasks_hash::DeterministicHash;\n \n-use super::{ChunkableModule, EvaluatableAssets, availability_info::AvailabilityInfo};\n use crate::{\n     asset::Asset,\n-    chunk::{ChunkItem, ChunkType, ModuleId},\n+    chunk::{\n+        ChunkItem, ChunkType, ChunkableModule, EvaluatableAssets, ModuleId,\n+        availability_info::AvailabilityInfo,\n+    },\n     environment::Environment,\n     ident::AssetIdent,\n     module::Module,\n@@ -37,6 +40,8 @@ use crate::{\n     TraceRawVcs,\n     DeterministicHash,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum MangleType {\n@@ -86,6 +91,8 @@ pub enum SourceMapsType {\n     TraceRawVcs,\n     DeterministicHash,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ChunkGroupType {\n     Entry,\n@@ -226,6 +233,8 @@ pub struct EntryChunkGroupResult {\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub struct ChunkingConfig {\n     /// Try to avoid creating more than 1 chunk smaller than this size."
        },
        {
            "sha": "1d8871ea0d2397d89042f8e112188316dfef7126",
            "filename": "turbopack/crates/turbopack-core/src/chunk/mod.rs",
            "status": "modified",
            "additions": 17,
            "deletions": 1,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -14,6 +14,7 @@ use std::fmt::Display;\n \n use anyhow::Result;\n use auto_hash_map::AutoSet;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n@@ -159,6 +160,8 @@ impl MergeableModules {\n     NonLocalValue,\n     TaskInput,\n     Hash,\n+    Encode,\n+    Decode,\n )]\n pub enum MergeableModuleExposure {\n     // This module is only used from within the current group, and only individual exports are\n@@ -265,6 +268,8 @@ pub trait OutputChunk: Asset {\n     PartialEq,\n     ValueDebugFormat,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ChunkingType {\n     /// The referenced module is placed in the same chunk group and is loaded in parallel.\n@@ -508,7 +513,18 @@ impl AsyncModuleInfo {\n }\n \n #[derive(\n-    Serialize, Deserialize, Debug, Clone, PartialEq, Eq, Hash, TraceRawVcs, TaskInput, NonLocalValue,\n+    Serialize,\n+    Deserialize,\n+    Debug,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    TraceRawVcs,\n+    TaskInput,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct ChunkItemWithAsyncModuleInfo {\n     pub chunk_item: ResolvedVc<Box<dyn ChunkItem>>,"
        },
        {
            "sha": "ee0afc764dec511591a2cfea6c14264f80da4a0c",
            "filename": "turbopack/crates/turbopack-core/src/compile_time_info.rs",
            "status": "modified",
            "additions": 48,
            "deletions": 13,
            "changes": 61,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fcompile_time_info.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fcompile_time_info.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fcompile_time_info.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{FxIndexMap, NonLocalValue, ResolvedVc, Vc, trace::TraceRawVcs};\n@@ -180,12 +181,16 @@ impl From<String> for DefinableNameSegment {\n \n #[turbo_tasks::value(transparent)]\n #[derive(Debug, Clone)]\n-pub struct CompileTimeDefines(pub FxIndexMap<Vec<DefinableNameSegment>, CompileTimeDefineValue>);\n+pub struct CompileTimeDefines(\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    pub  FxIndexMap<Vec<DefinableNameSegment>, CompileTimeDefineValue>,\n+);\n \n #[turbo_tasks::value(transparent)]\n #[derive(Debug, Clone)]\n pub struct CompileTimeDefinesIndividual(\n-    pub FxIndexMap<Vec<DefinableNameSegment>, ResolvedVc<CompileTimeDefineValue>>,\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    pub  FxIndexMap<Vec<DefinableNameSegment>, ResolvedVc<CompileTimeDefineValue>>,\n );\n \n impl IntoIterator for CompileTimeDefines {\n@@ -219,7 +224,19 @@ impl CompileTimeDefines {\n     }\n }\n \n-#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Debug,\n+    Clone,\n+    Copy,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub enum InputRelativeConstant {\n     // The project relative directory name of the source file\n     DirName,\n@@ -273,16 +290,35 @@ impl From<CompileTimeDefineValue> for FreeVarReference {\n \n #[turbo_tasks::value(transparent)]\n #[derive(Debug, Clone)]\n-pub struct FreeVarReferences(pub FxIndexMap<Vec<DefinableNameSegment>, FreeVarReference>);\n+pub struct FreeVarReferences(\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    pub  FxIndexMap<Vec<DefinableNameSegment>, FreeVarReference>,\n+);\n+\n+#[derive(\n+    Debug,\n+    Default,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n+pub struct FreeVarReferenceVcs(\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    pub  FxIndexMap<Vec<DefinableNameSegment>, ResolvedVc<FreeVarReference>>,\n+);\n \n /// A map from the last element (the member prop) to a map of the rest of the name to the value.\n #[turbo_tasks::value(transparent)]\n #[derive(Debug, Clone)]\n pub struct FreeVarReferencesIndividual(\n-    pub  FxIndexMap<\n-        DefinableNameSegment,\n-        FxIndexMap<Vec<DefinableNameSegment>, ResolvedVc<FreeVarReference>>,\n-    >,\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    pub  FxIndexMap<DefinableNameSegment, FreeVarReferenceVcs>,\n );\n \n #[turbo_tasks::value_impl]\n@@ -294,22 +330,21 @@ impl FreeVarReferences {\n \n     #[turbo_tasks::function]\n     pub fn individual(&self) -> Vc<FreeVarReferencesIndividual> {\n-        let mut result: FxIndexMap<\n-            DefinableNameSegment,\n-            FxIndexMap<Vec<DefinableNameSegment>, ResolvedVc<FreeVarReference>>,\n-        > = FxIndexMap::default();\n+        let mut result: FxIndexMap<DefinableNameSegment, FreeVarReferenceVcs> =\n+            FxIndexMap::default();\n \n         for (key, value) in &self.0 {\n             let (last_key, key) = key.split_last().unwrap();\n             result\n                 .entry(last_key.clone())\n                 .or_default()\n+                .0\n                 .insert(key.to_vec(), value.clone().resolved_cell());\n         }\n \n         // Sort keys to make order as deterministic as possible\n         result.sort_keys();\n-        result.iter_mut().for_each(|(_, inner)| inner.sort_keys());\n+        result.iter_mut().for_each(|(_, inner)| inner.0.sort_keys());\n \n         Vc::cell(result)\n     }"
        },
        {
            "sha": "bc2d3af2f66992a83ccc9f66cc6cca538684a685",
            "filename": "turbopack/crates/turbopack-core/src/condition.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fcondition.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fcondition.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fcondition.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,8 +1,11 @@\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, trace::TraceRawVcs};\n use turbo_tasks_fs::FileSystemPath;\n \n-#[derive(Debug, Clone, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue)]\n+#[derive(\n+    Debug, Clone, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue, Encode, Decode,\n+)]\n pub enum ContextCondition {\n     All(Vec<ContextCondition>),\n     Any(Vec<ContextCondition>),"
        },
        {
            "sha": "ccc695dd50359c1797d1dd7de21e494e3f309c0e",
            "filename": "turbopack/crates/turbopack-core/src/diagnostics/mod.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fdiagnostics%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fdiagnostics%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fdiagnostics%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -45,7 +45,9 @@ impl PartialOrd for PlainDiagnostic {\n }\n \n #[turbo_tasks::value(transparent)]\n-pub struct DiagnosticPayload(pub FxIndexMap<RcStr, RcStr>);\n+pub struct DiagnosticPayload(\n+    #[bincode(with = \"turbo_bincode::indexmap\")] pub FxIndexMap<RcStr, RcStr>,\n+);\n \n /// An arbitrary payload can be used to analyze, diagnose\n /// Turbopack's behavior."
        },
        {
            "sha": "91eca4b7710e91673a8fc162386ac6d0cdf7c2c7",
            "filename": "turbopack/crates/turbopack-core/src/ident.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fident.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fident.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fident.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::fmt::Write;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use once_cell::sync::Lazy;\n use regex::Regex;\n use serde::{Deserialize, Serialize};\n@@ -26,6 +27,8 @@ use crate::resolve::ModulePart;\n     Serialize,\n     Deserialize,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct Layer {\n     name: RcStr,"
        },
        {
            "sha": "cf06178c05597c24a78de335c16a60536b2d946d",
            "filename": "turbopack/crates/turbopack-core/src/introspect/mod.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fintrospect%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fintrospect%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fintrospect%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -6,10 +6,11 @@ pub mod utils;\n use turbo_rcstr::RcStr;\n use turbo_tasks::{FxIndexSet, ResolvedVc, Vc};\n \n-type VcDynIntrospectable = ResolvedVc<Box<dyn Introspectable>>;\n-\n #[turbo_tasks::value(transparent)]\n-pub struct IntrospectableChildren(FxIndexSet<(RcStr, VcDynIntrospectable)>);\n+pub struct IntrospectableChildren(\n+    #[bincode(with = \"turbo_bincode::indexset\")]\n+    FxIndexSet<(RcStr, ResolvedVc<Box<dyn Introspectable>>)>,\n+);\n \n #[turbo_tasks::value_trait]\n pub trait Introspectable {"
        },
        {
            "sha": "6cd2a462ef8f031f36ce682fb4feb465f2d1f0f6",
            "filename": "turbopack/crates/turbopack-core/src/issue/mod.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fissue%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fissue%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fissue%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -10,6 +10,7 @@ use std::{\n \n use anyhow::{Result, anyhow};\n use auto_hash_map::AutoSet;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n@@ -290,6 +291,8 @@ impl CapturedIssues {\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct IssueSource {\n     source: ResolvedVc<Box<dyn Source>>,\n@@ -309,6 +312,8 @@ pub struct IssueSource {\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n enum SourceRange {\n     LineColumn(SourcePos, SourcePos),"
        },
        {
            "sha": "05ab22e01e0fec61671a10bb6c6f54bfbdefd85c",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/chunk_group_info.rs",
            "status": "modified",
            "additions": 45,
            "deletions": 6,
            "changes": 51,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fchunk_group_info.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fchunk_group_info.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fchunk_group_info.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -4,6 +4,7 @@ use std::{\n };\n \n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use either::Either;\n use indexmap::map::Entry;\n use roaring::RoaringBitmap;\n@@ -23,10 +24,23 @@ use crate::{\n };\n \n #[derive(\n-    Clone, Debug, Default, PartialEq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat,\n+    Clone,\n+    Debug,\n+    Default,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    Encode,\n+    Decode,\n )]\n #[repr(transparent)]\n-pub struct RoaringBitmapWrapper(#[turbo_tasks(trace_ignore)] pub RoaringBitmap);\n+pub struct RoaringBitmapWrapper(\n+    #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n+    pub RoaringBitmap,\n+);\n \n impl TaskInput for RoaringBitmapWrapper {\n     fn is_transient(&self) -> bool {\n@@ -84,8 +98,10 @@ impl Hash for RoaringBitmapWrapper {\n pub struct ChunkGroupInfo {\n     pub module_chunk_groups: FxHashMap<ResolvedVc<Box<dyn Module>>, RoaringBitmapWrapper>,\n     #[turbo_tasks(trace_ignore)]\n+    #[bincode(with = \"turbo_bincode::indexset\")]\n     pub chunk_groups: FxIndexSet<ChunkGroup>,\n     #[turbo_tasks(trace_ignore)]\n+    #[bincode(with = \"turbo_bincode::indexset\")]\n     pub chunk_group_keys: FxIndexSet<ChunkGroupKey>,\n }\n \n@@ -111,7 +127,18 @@ impl ChunkGroupInfo {\n }\n \n #[derive(\n-    Debug, Clone, Hash, TaskInput, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue,\n+    Debug,\n+    Clone,\n+    Hash,\n+    TaskInput,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ChunkGroupEntry {\n     /// e.g. a page\n@@ -148,7 +175,19 @@ impl ChunkGroupEntry {\n     }\n }\n \n-#[derive(Debug, Clone, Hash, TaskInput, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs)]\n+#[derive(\n+    Debug,\n+    Clone,\n+    Hash,\n+    TaskInput,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    Encode,\n+    Decode,\n+)]\n pub enum ChunkGroup {\n     /// e.g. a page\n     Entry(Vec<ResolvedVc<Box<dyn Module>>>),\n@@ -266,7 +305,7 @@ impl ChunkGroup {\n     }\n }\n \n-#[derive(Debug, Clone, Hash, PartialEq, Eq, Serialize, Deserialize)]\n+#[derive(Debug, Clone, Hash, PartialEq, Eq, Serialize, Deserialize, Encode, Decode)]\n pub enum ChunkGroupKey {\n     /// e.g. a page\n     Entry(Vec<ResolvedVc<Box<dyn Module>>>),\n@@ -329,7 +368,7 @@ impl ChunkGroupKey {\n     }\n }\n \n-#[derive(Debug, Copy, Clone, PartialEq, Eq, Hash, Serialize, Deserialize)]\n+#[derive(Debug, Copy, Clone, PartialEq, Eq, Hash, Serialize, Deserialize, Encode, Decode)]\n pub struct ChunkGroupId(u32);\n \n impl From<usize> for ChunkGroupId {"
        },
        {
            "sha": "deb7711a1044bfd14a564c37de3ffabc3f26c3ab",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/mod.rs",
            "status": "modified",
            "additions": 46,
            "deletions": 7,
            "changes": 53,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -6,6 +6,7 @@ use std::{\n \n use anyhow::{Context, Result, bail};\n use auto_hash_map::AutoSet;\n+use bincode::{Decode, Encode};\n use petgraph::{\n     Direction,\n     graph::{DiGraph, EdgeIndex, NodeIndex},\n@@ -53,12 +54,25 @@ mod traced_di_graph;\n pub use self::module_batches::BatchingConfig;\n \n #[derive(\n-    Debug, Copy, Clone, Eq, PartialOrd, Ord, Hash, PartialEq, Serialize, Deserialize, TraceRawVcs,\n+    Debug,\n+    Copy,\n+    Clone,\n+    Eq,\n+    PartialOrd,\n+    Ord,\n+    Hash,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    Encode,\n+    Decode,\n )]\n pub struct GraphNodeIndex {\n     #[turbo_tasks(trace_ignore)]\n     graph_idx: u32,\n     #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n     node_idx: NodeIndex,\n }\n impl GraphNodeIndex {\n@@ -73,14 +87,28 @@ impl GraphNodeIndex {\n unsafe impl NonLocalValue for GraphNodeIndex {}\n \n #[derive(\n-    Debug, Copy, Clone, Eq, PartialOrd, Ord, Hash, PartialEq, Serialize, Deserialize, TraceRawVcs,\n+    Debug,\n+    Copy,\n+    Clone,\n+    Eq,\n+    PartialOrd,\n+    Ord,\n+    Hash,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct GraphEdgeIndex {\n-    #[turbo_tasks(trace_ignore)]\n     graph_idx: u32,\n     #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n     edge_idx: EdgeIndex,\n }\n+\n impl GraphEdgeIndex {\n     fn new(graph_idx: u32, edge_idx: EdgeIndex) -> Self {\n         Self {\n@@ -90,11 +118,10 @@ impl GraphEdgeIndex {\n     }\n }\n \n-unsafe impl NonLocalValue for GraphEdgeIndex {}\n-\n #[turbo_tasks::value]\n #[derive(Clone, Debug)]\n pub struct VisitedModules {\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub modules: FxIndexMap<ResolvedVc<Box<dyn Module>>, GraphNodeIndex>,\n     next_graph_idx: u32,\n }\n@@ -208,6 +235,7 @@ pub struct SingleModuleGraph {\n     //\n     // This contains Vcs, but they are already contained in the graph, so no need to trace this.\n     #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n     modules: FxHashMap<ResolvedVc<Box<dyn Module>>, NodeIndex>,\n \n     #[turbo_tasks(trace_ignore)]\n@@ -924,7 +952,18 @@ impl ModuleGraph {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Eq, Hash, Serialize, Deserialize, TaskInput, TraceRawVcs, NonLocalValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    Serialize,\n+    Deserialize,\n+    TaskInput,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct SingleModuleGraphWithBindingUsage {\n     pub graph: ResolvedVc<SingleModuleGraph>,\n@@ -1591,7 +1630,7 @@ impl SingleModuleGraph {\n     }\n }\n \n-#[derive(Clone, Debug, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n+#[derive(Clone, Debug, Serialize, Deserialize, TraceRawVcs, NonLocalValue, Encode, Decode)]\n pub enum SingleModuleGraphNode {\n     Module(ResolvedVc<Box<dyn Module>>),\n     // Models a module that is referenced but has already been visited by an earlier graph."
        },
        {
            "sha": "20fe9a3fda2166c5502799454870e4598d283111",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/module_batch.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmodule_batch.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmodule_batch.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmodule_batch.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::fmt::Debug;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n@@ -24,6 +25,8 @@ use crate::{\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum ModuleOrBatch {\n     Module(ResolvedVc<Box<dyn Module>>),\n@@ -55,6 +58,8 @@ impl ModuleOrBatch {\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum ChunkableModuleOrBatch {\n     Module(ResolvedVc<Box<dyn ChunkableModule>>),"
        },
        {
            "sha": "2655947f6365d1350b49c0e6181174c4282f4398",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/module_batches.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 4,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmodule_batches.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmodule_batches.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmodule_batches.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -5,6 +5,7 @@ use std::{\n };\n \n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use either::Either;\n use petgraph::graph::{DiGraph, EdgeIndex, NodeIndex};\n use rustc_hash::{FxHashMap, FxHashSet, FxHasher};\n@@ -48,7 +49,10 @@ pub struct ModuleBatchesGraphEdge {\n     pub module: Option<ResolvedVc<Box<dyn Module>>>,\n }\n \n-type EntriesList = FxIndexSet<ResolvedVc<Box<dyn Module>>>;\n+#[derive(Debug, Clone, Serialize, Deserialize, TraceRawVcs, NonLocalValue, Encode, Decode)]\n+struct EntriesList(\n+    #[bincode(with = \"turbo_bincode::indexset\")] pub FxIndexSet<ResolvedVc<Box<dyn Module>>>,\n+);\n \n #[turbo_tasks::value(cell = \"new\", eq = \"manual\")]\n pub struct ModuleBatchesGraph {\n@@ -61,6 +65,7 @@ pub struct ModuleBatchesGraph {\n     //\n     // This contains Vcs, but they are already contained in the graph, so no need to trace this.\n     #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n     entries: FxHashMap<ResolvedVc<Box<dyn Module>>, NodeIndex>,\n     batch_groups: FxHashMap<ModuleOrBatch, ResolvedVc<ModuleBatchGroup>>,\n \n@@ -92,7 +97,7 @@ impl ModuleBatchesGraph {\n         chunk_group_info: &'l ChunkGroupInfo,\n         idx: usize,\n     ) -> impl Iterator<Item = ResolvedVc<Box<dyn Module>>> + 'l {\n-        if let Some(ordered_entries) = self\n+        if let Some(EntriesList(ordered_entries)) = self\n             .ordered_entries\n             .get(idx)\n             .as_ref()\n@@ -446,7 +451,7 @@ pub async fn compute_module_batches(\n                 .as_ref()\n                 .map_or_else(\n                     || Either::Left(chunk_group.entries()),\n-                    |v| Either::Right(v.iter().copied()),\n+                    |v| Either::Right(v.0.iter().copied()),\n                 )\n                 .map(|module| {\n                     let idx = *pre_batches\n@@ -505,7 +510,7 @@ pub async fn compute_module_batches(\n                         .chunk_group_keys\n                         .get_index_of(&chunk_group_key)\n                         .context(\"could not find chunk group key for merged chunk group\")?;\n-                    ordered_entries[idx] = Some(merged_modules);\n+                    ordered_entries[idx] = Some(EntriesList(merged_modules));\n                 }\n             }\n         }"
        },
        {
            "sha": "f9c750723ad08957f541f64712621b52f8e74f9b",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/style_groups.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fstyle_groups.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fstyle_groups.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fstyle_groups.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -37,6 +37,7 @@ pub struct StyleGroupsConfig {\n pub struct StyleGroups {\n     /// The key chunk item is contained in the value chunk item batch. All chunk items that are not\n     /// contained in this map are placed in a separate chunk per chunk item.\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub shared_chunk_items:\n         FxIndexMap<ChunkItemWithAsyncModuleInfo, ResolvedVc<ChunkItemBatchWithAsyncModuleInfo>>,\n }"
        },
        {
            "sha": "2e2918dda2eebeba05490e60d8bcece74e068e6c",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/traced_di_graph.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Ftraced_di_graph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Ftraced_di_graph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Ftraced_di_graph.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,15 +1,21 @@\n use std::ops::Deref;\n \n+use bincode::{Decode, Encode};\n use petgraph::graph::{DiGraph, EdgeIndex, NodeIndex};\n-use serde::{Deserialize, Serialize};\n+use serde::{Deserialize, Serialize, de::DeserializeOwned};\n use turbo_tasks::{\n     NonLocalValue,\n     debug::ValueDebugFormat,\n     trace::{TraceRawVcs, TraceRawVcsContext},\n };\n \n-#[derive(Clone, Debug, ValueDebugFormat, Serialize, Deserialize)]\n-pub struct TracedDiGraph<N, E>(pub DiGraph<N, E>);\n+#[derive(Clone, Debug, ValueDebugFormat, Serialize, Deserialize, Encode, Decode)]\n+#[bincode(\n+    encode_bounds = \"N: Serialize, E: Serialize\",\n+    decode_bounds = \"N: DeserializeOwned, E: DeserializeOwned\",\n+    borrow_decode_bounds = \"N: Deserialize<'__de>, E: Deserialize<'__de>\"\n+)]\n+pub struct TracedDiGraph<N, E>(#[bincode(with_serde)] pub DiGraph<N, E>);\n impl<N, E> Default for TracedDiGraph<N, E> {\n     fn default() -> Self {\n         Self(Default::default())"
        },
        {
            "sha": "4bbc0ffd09f4562972236bcf36b5ae305d1028bb",
            "filename": "turbopack/crates/turbopack-core/src/output.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Foutput.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Foutput.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Foutput.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -107,7 +107,9 @@ pub struct ExpandedOutputAssets(Vec<ResolvedVc<Box<dyn OutputAsset>>>);\n \n /// A set of [OutputAsset]s\n #[turbo_tasks::value(transparent)]\n-pub struct OutputAssetsSet(FxIndexSet<ResolvedVc<Box<dyn OutputAsset>>>);\n+pub struct OutputAssetsSet(\n+    #[bincode(with = \"turbo_bincode::indexset\")] FxIndexSet<ResolvedVc<Box<dyn OutputAsset>>>,\n+);\n \n #[turbo_tasks::value(shared)]\n #[derive(Clone)]"
        },
        {
            "sha": "66ddf80478e423582ae4e3351bda8b3303609fa4",
            "filename": "turbopack/crates/turbopack-core/src/reference/mod.rs",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::collections::HashSet;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n@@ -294,7 +295,16 @@ pub async fn primary_referenced_modules(module: Vc<Box<dyn Module>>) -> Result<V\n }\n \n #[derive(\n-    Clone, Serialize, Deserialize, Eq, PartialEq, ValueDebugFormat, TraceRawVcs, NonLocalValue,\n+    Clone,\n+    Serialize,\n+    Deserialize,\n+    Eq,\n+    PartialEq,\n+    ValueDebugFormat,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct ResolvedReference {\n     pub chunking_type: ChunkingType,"
        },
        {
            "sha": "f3d9c1d7a331365068af4dadc887f7c0de3f51db",
            "filename": "turbopack/crates/turbopack-core/src/reference_type.rs",
            "status": "modified",
            "additions": 41,
            "deletions": 19,
            "changes": 60,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference_type.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference_type.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference_type.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,8 @@\n use std::fmt::Display;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n+use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{FxIndexMap, NonLocalValue, ResolvedVc, TaskInput, Vc, trace::TraceRawVcs};\n \n@@ -11,7 +13,9 @@ use crate::{module::Module, resolve::ModulePart};\n ///\n /// Name is usually in UPPER_CASE to make it clear that this is an inner asset.\n #[turbo_tasks::value(transparent)]\n-pub struct InnerAssets(FxIndexMap<RcStr, ResolvedVc<Box<dyn Module>>>);\n+pub struct InnerAssets(\n+    #[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<RcStr, ResolvedVc<Box<dyn Module>>>,\n+);\n \n #[turbo_tasks::value_impl]\n impl InnerAssets {\n@@ -32,14 +36,16 @@ impl InnerAssets {\n     Eq,\n     TraceRawVcs,\n     NonLocalValue,\n-    serde::Serialize,\n-    serde::Deserialize,\n+    Serialize,\n+    Deserialize,\n     Debug,\n     Default,\n     Clone,\n     Copy,\n     Hash,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum CommonJsReferenceSubType {\n     Custom(u8),\n@@ -52,13 +58,15 @@ pub enum CommonJsReferenceSubType {\n     Eq,\n     TraceRawVcs,\n     NonLocalValue,\n-    serde::Serialize,\n-    serde::Deserialize,\n+    Serialize,\n+    Deserialize,\n     Debug,\n     Clone,\n     Copy,\n     Hash,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum ImportWithType {\n     Json,\n@@ -70,13 +78,15 @@ pub enum ImportWithType {\n     Eq,\n     TraceRawVcs,\n     NonLocalValue,\n-    serde::Serialize,\n-    serde::Deserialize,\n+    Serialize,\n+    Deserialize,\n     Debug,\n     Default,\n     Clone,\n     Hash,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum EcmaScriptModulesReferenceSubType {\n     ImportPart(ModulePart),\n@@ -210,14 +220,16 @@ impl ImportContext {\n     Eq,\n     TraceRawVcs,\n     NonLocalValue,\n-    serde::Serialize,\n-    serde::Deserialize,\n+    Serialize,\n+    Deserialize,\n     Debug,\n     Default,\n     Clone,\n     Copy,\n     Hash,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum CssReferenceSubType {\n     AtImport(Option<ResolvedVc<ImportContext>>),\n@@ -238,14 +250,16 @@ pub enum CssReferenceSubType {\n     Eq,\n     TraceRawVcs,\n     NonLocalValue,\n-    serde::Serialize,\n-    serde::Deserialize,\n+    Serialize,\n+    Deserialize,\n     Debug,\n     Default,\n     Clone,\n     Copy,\n     Hash,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum UrlReferenceSubType {\n     EcmaScriptNewUrl,\n@@ -260,13 +274,15 @@ pub enum UrlReferenceSubType {\n     Eq,\n     TraceRawVcs,\n     NonLocalValue,\n-    serde::Serialize,\n-    serde::Deserialize,\n+    Serialize,\n+    Deserialize,\n     Debug,\n     Clone,\n     Copy,\n     Hash,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum TypeScriptReferenceSubType {\n     Custom(u8),\n@@ -278,13 +294,15 @@ pub enum TypeScriptReferenceSubType {\n     Eq,\n     TraceRawVcs,\n     NonLocalValue,\n-    serde::Serialize,\n-    serde::Deserialize,\n+    Serialize,\n+    Deserialize,\n     Debug,\n     Clone,\n     Copy,\n     Hash,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum WorkerReferenceSubType {\n     WebWorker,\n@@ -302,13 +320,15 @@ pub enum WorkerReferenceSubType {\n     Eq,\n     TraceRawVcs,\n     NonLocalValue,\n-    serde::Serialize,\n-    serde::Deserialize,\n+    Serialize,\n+    Deserialize,\n     Debug,\n     Clone,\n     Copy,\n     Hash,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum EntryReferenceSubType {\n     Web,\n@@ -332,13 +352,15 @@ pub enum EntryReferenceSubType {\n     Eq,\n     TraceRawVcs,\n     NonLocalValue,\n-    serde::Serialize,\n-    serde::Deserialize,\n+    Serialize,\n+    Deserialize,\n     Debug,\n     Default,\n     Clone,\n     Hash,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum ReferenceType {\n     CommonJs(CommonJsReferenceSubType),"
        },
        {
            "sha": "dfa9f569bd58c16672cd8f6dc89e9b15e6401f32",
            "filename": "turbopack/crates/turbopack-core/src/resolve/alias_map.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Falias_map.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Falias_map.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Falias_map.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -5,8 +5,9 @@ use std::{\n };\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use patricia_tree::PatriciaMap;\n-use serde::{Deserialize, Serialize};\n+use serde::{Deserialize, Serialize, de::DeserializeOwned};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n     NonLocalValue,\n@@ -24,9 +25,15 @@ use super::pattern::Pattern;\n ///\n /// If the pattern does not have a wildcard character, it will only match the\n /// exact string, and return the template as-is.\n-#[derive(Clone, Serialize, Deserialize)]\n+#[derive(Clone, Serialize, Deserialize, Encode, Decode)]\n #[serde(transparent)]\n+#[bincode(\n+    encode_bounds = \"T: Serialize\",\n+    decode_bounds = \"T: DeserializeOwned\",\n+    borrow_decode_bounds = \"T: Deserialize<'__de>\"\n+)]\n pub struct AliasMap<T> {\n+    #[bincode(with_serde)]\n     map: PatriciaMap<BTreeMap<AliasKey, T>>,\n }\n "
        },
        {
            "sha": "800f62e6245c8a0172e61d35a8b7130cb4d1c103",
            "filename": "turbopack/crates/turbopack-core/src/resolve/mod.rs",
            "status": "modified",
            "additions": 29,
            "deletions": 17,
            "changes": 46,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -8,6 +8,7 @@ use std::{\n \n use anyhow::{Result, bail};\n use auto_hash_map::AutoSet;\n+use bincode::{Decode, Encode};\n use rustc_hash::{FxHashMap, FxHashSet};\n use serde::{Deserialize, Serialize};\n use tracing::{Instrument, Level};\n@@ -19,17 +20,6 @@ use turbo_tasks::{\n use turbo_tasks_fs::{FileSystemEntryType, FileSystemPath};\n use turbo_unix_path::normalize_request;\n \n-use self::{\n-    options::{\n-        ConditionValue, ImportMapResult, ResolveInPackage, ResolveIntoPackage, ResolveModules,\n-        ResolveModulesOptions, ResolveOptions, resolve_modules_options,\n-    },\n-    origin::ResolveOrigin,\n-    parse::Request,\n-    pattern::Pattern,\n-    plugin::BeforeResolvePlugin,\n-    remap::{ExportsField, ImportsField},\n-};\n use crate::{\n     context::AssetContext,\n     data_uri_source::DataUriSource,\n@@ -45,10 +35,15 @@ use crate::{\n     resolve::{\n         alias_map::AliasKey,\n         node::{node_cjs_resolve_options, node_esm_resolve_options},\n-        parse::stringify_data_uri,\n-        pattern::{PatternMatch, read_matches},\n-        plugin::AfterResolvePlugin,\n-        remap::ReplacedSubpathValueResult,\n+        options::{\n+            ConditionValue, ImportMapResult, ResolveInPackage, ResolveIntoPackage, ResolveModules,\n+            ResolveModulesOptions, ResolveOptions, resolve_modules_options,\n+        },\n+        origin::ResolveOrigin,\n+        parse::{Request, stringify_data_uri},\n+        pattern::{Pattern, PatternMatch, read_matches},\n+        plugin::{AfterResolvePlugin, BeforeResolvePlugin},\n+        remap::{ExportsField, ImportsField, ReplacedSubpathValueResult},\n     },\n     source::{OptionSource, Source, Sources},\n };\n@@ -398,6 +393,8 @@ impl ModuleResolveResult {\n     TraceRawVcs,\n     Serialize,\n     Deserialize,\n+    Encode,\n+    Decode,\n )]\n pub enum ExternalTraced {\n     Untraced,\n@@ -425,6 +422,8 @@ impl Display for ExternalTraced {\n     TraceRawVcs,\n     TaskInput,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ExternalType {\n     Url,\n@@ -1289,7 +1288,9 @@ pub async fn find_context_file_or_package_key(\n     Ok(find_context_file(lookup_path.parent(), names, false))\n }\n \n-#[derive(Clone, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, Debug, NonLocalValue)]\n+#[derive(\n+    Clone, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, Debug, NonLocalValue, Encode, Decode,\n+)]\n enum FindPackageItem {\n     PackageDirectory { name: RcStr, dir: FileSystemPath },\n     PackageFile { name: RcStr, file: FileSystemPath },\n@@ -3241,7 +3242,18 @@ async fn error_severity(resolve_options: Vc<ResolveOptions>) -> Result<IssueSeve\n ///\n /// Currently this is used only for ESMs.\n #[derive(\n-    Serialize, Deserialize, Debug, Clone, PartialEq, Eq, Hash, TraceRawVcs, TaskInput, NonLocalValue,\n+    Serialize,\n+    Deserialize,\n+    Debug,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    TraceRawVcs,\n+    TaskInput,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ModulePart {\n     /// Represents the side effects of a module. This part is evaluated even if"
        },
        {
            "sha": "de19510b87564848227e1cfa879ef4b5f2006362",
            "filename": "turbopack/crates/turbopack-core/src/resolve/options.rs",
            "status": "modified",
            "additions": 42,
            "deletions": 4,
            "changes": 46,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Foptions.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Foptions.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Foptions.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{collections::BTreeMap, future::Future, pin::Pin};\n \n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{\n@@ -23,7 +24,7 @@ pub struct LockedVersions {}\n \n #[turbo_tasks::value(transparent)]\n #[derive(Debug)]\n-pub struct ExcludedExtensions(pub FxIndexSet<RcStr>);\n+pub struct ExcludedExtensions(#[bincode(with = \"turbo_bincode::indexset\")] pub FxIndexSet<RcStr>);\n \n /// A location where to resolve modules.\n #[derive(\n@@ -37,6 +38,8 @@ pub struct ExcludedExtensions(pub FxIndexSet<RcStr>);\n     Deserialize,\n     ValueDebugFormat,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ResolveModules {\n     /// when inside of path, use the list of directories to\n@@ -50,7 +53,18 @@ pub enum ResolveModules {\n }\n \n #[derive(\n-    TraceRawVcs, Hash, PartialEq, Eq, Clone, Copy, Debug, Serialize, Deserialize, NonLocalValue,\n+    TraceRawVcs,\n+    Hash,\n+    PartialEq,\n+    Eq,\n+    Clone,\n+    Copy,\n+    Debug,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ConditionValue {\n     Set,\n@@ -71,7 +85,19 @@ impl From<bool> for ConditionValue {\n pub type ResolutionConditions = BTreeMap<RcStr, ConditionValue>;\n \n /// The different ways to resolve a package, as described in package.json.\n-#[derive(TraceRawVcs, Hash, PartialEq, Eq, Clone, Debug, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    TraceRawVcs,\n+    Hash,\n+    PartialEq,\n+    Eq,\n+    Clone,\n+    Debug,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub enum ResolveIntoPackage {\n     /// Using the [exports] field.\n     ///\n@@ -89,7 +115,19 @@ pub enum ResolveIntoPackage {\n }\n \n // The different ways to resolve a request within a package\n-#[derive(TraceRawVcs, Hash, PartialEq, Eq, Clone, Debug, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    TraceRawVcs,\n+    Hash,\n+    PartialEq,\n+    Eq,\n+    Clone,\n+    Debug,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub enum ResolveInPackage {\n     /// Using a alias field which allows to map requests\n     AliasField(RcStr),"
        },
        {
            "sha": "1d0985091a354b25a5823a8935c4d9362df0d8db",
            "filename": "turbopack/crates/turbopack-core/src/resolve/pattern.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fpattern.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fpattern.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fpattern.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -5,6 +5,7 @@ use std::{\n };\n \n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use regex::Regex;\n use rustc_hash::{FxHashMap, FxHashSet};\n use serde::{Deserialize, Serialize};\n@@ -1498,6 +1499,8 @@ impl ValueToString for Pattern {\n     Deserialize,\n     ValueDebugFormat,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum PatternMatch {\n     File(RcStr, FileSystemPath),"
        },
        {
            "sha": "8c5c86c4e2ceeebefb428014c511c2a30dc911d5",
            "filename": "turbopack/crates/turbopack-core/src/resolve/remap.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fremap.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fremap.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fremap.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{borrow::Cow, collections::BTreeMap, fmt::Display, ops::Deref};\n \n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use rustc_hash::FxHashMap;\n use serde::{Deserialize, Serialize};\n use serde_json::Value;\n@@ -363,7 +364,7 @@ impl<'a> Iterator for ResultsIterMut<'a> {\n }\n \n /// Content of an \"exports\" field in a package.json\n-#[derive(PartialEq, Eq, Serialize, Deserialize)]\n+#[derive(PartialEq, Eq, Serialize, Deserialize, Encode, Decode)]\n pub struct ExportsField(AliasMap<SubpathValue>);\n \n impl TryFrom<&Value> for ExportsField {\n@@ -457,7 +458,7 @@ impl Deref for ExportsField {\n }\n \n /// Content of an \"imports\" field in a package.json\n-#[derive(PartialEq, Eq, Serialize, Deserialize)]\n+#[derive(PartialEq, Eq, Serialize, Deserialize, Encode, Decode)]\n pub struct ImportsField(AliasMap<SubpathValue>);\n \n impl TryFrom<&Value> for ImportsField {"
        },
        {
            "sha": "b041b40e3d809b9c05610d50dc288f088b1d4f7f",
            "filename": "turbopack/crates/turbopack-core/src/source_map/mod.rs",
            "status": "modified",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,12 @@\n use std::{borrow::Cow, io::Write, ops::Deref, sync::Arc};\n \n use anyhow::Result;\n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+};\n use bytes_str::BytesStr;\n use either::Either;\n use once_cell::sync::Lazy;\n@@ -693,3 +699,24 @@ impl<'de> Deserialize<'de> for CrateMapWrapper {\n         Ok(CrateMapWrapper(map))\n     }\n }\n+\n+impl Encode for CrateMapWrapper {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        let mut bytes = Vec::new();\n+        self.0\n+            .to_writer(&mut bytes)\n+            .map_err(|e| EncodeError::OtherString(e.to_string()))?;\n+        bytes.encode(encoder)\n+    }\n+}\n+\n+impl<Context> Decode<Context> for CrateMapWrapper {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        let bytes = Vec::<u8>::decode(decoder)?;\n+        let map = DecodedMap::from_reader(&*bytes)\n+            .map_err(|e| DecodeError::OtherString(e.to_string()))?;\n+        Ok(CrateMapWrapper(map))\n+    }\n+}\n+\n+bincode::impl_borrow_decode!(CrateMapWrapper);"
        },
        {
            "sha": "1496f50e5b9de0166f379da9ef4983bcd1766468",
            "filename": "turbopack/crates/turbopack-core/src/source_map/source_map_asset.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fsource_map_asset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fsource_map_asset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fsource_map_asset.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{\n@@ -16,7 +17,17 @@ use crate::{\n     source_map::{GenerateSourceMap, SourceMap},\n };\n \n-#[derive(PartialEq, Eq, Serialize, Deserialize, NonLocalValue, TraceRawVcs, ValueDebugFormat)]\n+#[derive(\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    Encode,\n+    Decode,\n+)]\n enum PathType {\n     Fixed {\n         path: FileSystemPath,"
        },
        {
            "sha": "321ddee8d563abdd4a5ae1f4d107ce74ca303caa",
            "filename": "turbopack/crates/turbopack-core/src/source_pos.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_pos.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_pos.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_pos.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,3 +1,4 @@\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, TaskInput, trace::TraceRawVcs};\n use turbo_tasks_hash::DeterministicHash;\n@@ -23,6 +24,8 @@ const U8_CR: u8 = 0x0D;\n     Deserialize,\n     DeterministicHash,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct SourcePos {\n     /// The line, 0-indexed."
        },
        {
            "sha": "6d2274e09b9752ae1f814d8ca269fd017c383530",
            "filename": "turbopack/crates/turbopack-core/src/target.rs",
            "status": "modified",
            "additions": 49,
            "deletions": 4,
            "changes": 53,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Ftarget.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Ftarget.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Ftarget.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,5 +1,6 @@\n use std::fmt::Display;\n \n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, Vc, trace::TraceRawVcs};\n \n@@ -174,7 +175,18 @@ impl CompileTarget {\n }\n \n #[derive(\n-    PartialEq, Eq, Hash, Debug, Copy, Clone, TraceRawVcs, Serialize, Deserialize, NonLocalValue,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    Debug,\n+    Copy,\n+    Clone,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[repr(u8)]\n #[non_exhaustive]\n@@ -217,7 +229,18 @@ impl Display for Arch {\n }\n \n #[derive(\n-    PartialEq, Eq, Hash, Debug, Copy, Clone, TraceRawVcs, Serialize, Deserialize, NonLocalValue,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    Debug,\n+    Copy,\n+    Clone,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[repr(u8)]\n #[non_exhaustive]\n@@ -256,7 +279,18 @@ impl Display for Platform {\n }\n \n #[derive(\n-    PartialEq, Eq, Hash, Debug, Copy, Clone, TraceRawVcs, Serialize, Deserialize, NonLocalValue,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    Debug,\n+    Copy,\n+    Clone,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[repr(u8)]\n pub enum Endianness {\n@@ -280,7 +314,18 @@ impl Display for Endianness {\n }\n \n #[derive(\n-    PartialEq, Eq, Hash, Debug, Copy, Clone, TraceRawVcs, Serialize, Deserialize, NonLocalValue,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    Debug,\n+    Copy,\n+    Clone,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[repr(u8)]\n pub enum Libc {"
        },
        {
            "sha": "6368a4aba208f9b7d1516702030c47d750b93acc",
            "filename": "turbopack/crates/turbopack-css/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-css%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-css%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -14,6 +14,7 @@ workspace = true\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n indoc = { workspace = true }\n lightningcss = { workspace = true }\n parcel_selectors = { workspace = true }\n@@ -28,6 +29,7 @@ swc_core = { workspace = true, features = [\n ] }\n tokio = { workspace = true }\n tracing = { workspace = true }\n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-fs = { workspace = true }"
        },
        {
            "sha": "7c1cdf0dc0dced718703d2adfced3aebcece5173",
            "filename": "turbopack/crates/turbopack-css/src/lib.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Flib.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -16,6 +16,7 @@ pub(crate) mod references;\n pub(crate) mod util;\n \n pub use asset::CssModuleAsset;\n+use bincode::{Decode, Encode};\n pub use module_asset::ModuleCssAsset;\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, TaskInput, trace::TraceRawVcs};\n@@ -38,6 +39,8 @@ use crate::references::import::ImportAssetReference;\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum CssModuleAssetType {\n     /// Default parsing mode."
        },
        {
            "sha": "f0804dfe186092d320404e3ffab86dc34e59db8b",
            "filename": "turbopack/crates/turbopack-css/src/module_asset.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fmodule_asset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fmodule_asset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fmodule_asset.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -163,7 +163,9 @@ enum ModuleCssClass {\n /// 3. class3: [Local(\"exported_class3), Import(\"class4\", \"./other.module.css\")]\n #[turbo_tasks::value(transparent)]\n #[derive(Debug, Clone)]\n-struct ModuleCssClasses(FxIndexMap<String, Vec<ModuleCssClass>>);\n+struct ModuleCssClasses(\n+    #[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<String, Vec<ModuleCssClass>>,\n+);\n \n #[turbo_tasks::value_impl]\n impl ModuleCssAsset {"
        },
        {
            "sha": "eb06ce40943ebd550063da942f8d90e041cff921",
            "filename": "turbopack/crates/turbopack-css/src/process.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fprocess.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fprocess.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fprocess.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -46,7 +46,11 @@ use crate::{\n pub type CssOutput = (ToCssResult, Option<Rope>);\n \n #[turbo_tasks::value(transparent)]\n-struct LightningCssTargets(#[turbo_tasks(trace_ignore)] pub Targets);\n+struct LightningCssTargets(\n+    #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n+    pub Targets,\n+);\n \n /// Returns the LightningCSS targets for the given browserslist query.\n #[turbo_tasks::function]"
        },
        {
            "sha": "bbe1b58a04c90cc134cec725885648d4ebe5187a",
            "filename": "turbopack/crates/turbopack-dev-server/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -18,6 +18,7 @@ workspace = true\n [dependencies]\n anyhow = { workspace = true }\n auto-hash-map = { workspace = true }\n+bincode = { workspace = true }\n flate2 = { workspace = true }\n futures = { workspace = true }\n hyper = { version = \"0.14\", features = [\"full\"] }\n@@ -35,6 +36,7 @@ tokio = { workspace = true }\n tokio-stream = \"0.1.9\"\n tokio-util = { workspace = true }\n tracing = { workspace = true }\n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-bytes = { workspace = true }"
        },
        {
            "sha": "502e151073efc5c35aa06579dbcd7be84a0b61c6",
            "filename": "turbopack/crates/turbopack-dev-server/src/html.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fhtml.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fhtml.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fhtml.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use mime_guess::mime::TEXT_HTML_UTF_8;\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n@@ -20,7 +21,18 @@ use turbopack_core::{\n };\n \n #[derive(\n-    Clone, Debug, Deserialize, Eq, Hash, NonLocalValue, PartialEq, Serialize, TaskInput, TraceRawVcs,\n+    Clone,\n+    Debug,\n+    Deserialize,\n+    Eq,\n+    Hash,\n+    NonLocalValue,\n+    PartialEq,\n+    Serialize,\n+    TaskInput,\n+    TraceRawVcs,\n+    Encode,\n+    Decode,\n )]\n pub struct DevHtmlEntry {\n     pub chunkable_module: ResolvedVc<Box<dyn ChunkableModule>>,"
        },
        {
            "sha": "3a5475705b2d7fb8034d9f1d0884c50a2c481d5e",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/asset_graph.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fasset_graph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fasset_graph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fasset_graph.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -20,7 +20,10 @@ use super::{\n };\n \n #[turbo_tasks::value(transparent)]\n-struct OutputAssetsMap(FxIndexMap<RcStr, ResolvedVc<Box<dyn OutputAsset>>>);\n+struct OutputAssetsMap(\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n+    FxIndexMap<RcStr, ResolvedVc<Box<dyn OutputAsset>>>,\n+);\n \n type ExpandedState = State<FxHashSet<RcStr>>;\n "
        },
        {
            "sha": "fb9aef416706be55e45b82e59de0d0e31eb0be38",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/mod.rs",
            "status": "modified",
            "additions": 17,
            "deletions": 2,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -15,6 +15,7 @@ pub mod wrapping_source;\n use std::collections::BTreeSet;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use futures::{TryStreamExt, stream::Stream as StreamTrait};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n@@ -261,7 +262,19 @@ impl ValueDefault for Body {\n }\n \n /// Filter function that describes which information is required.\n-#[derive(Debug, Clone, PartialEq, Eq, TraceRawVcs, Hash, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    Debug,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    TraceRawVcs,\n+    Hash,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub enum ContentSourceDataFilter {\n     All,\n     Subset(BTreeSet<String>),\n@@ -486,7 +499,9 @@ impl ContentSource for NoContentSource {\n     }\n }\n \n-#[derive(Debug, Clone, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Debug, Clone, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, Encode, Decode,\n+)]\n pub enum RewriteType {\n     Location {\n         /// The new path and query used to lookup content. This _does not_ need to be the original"
        },
        {
            "sha": "70bc99d530d70ab2a50a4c3a98a91f0b4f413aa9",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/route_tree.rs",
            "status": "modified",
            "additions": 15,
            "deletions": 2,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Froute_tree.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Froute_tree.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Froute_tree.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,14 +1,15 @@\n use std::{fmt::Write, mem::replace};\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n     FxIndexMap, NonLocalValue, ReadRef, ResolvedVc, TaskInput, TryJoinIterExt, ValueToString, Vc,\n     fxindexmap, trace::TraceRawVcs,\n };\n \n-use super::{GetContentSourceContent, GetContentSourceContents};\n+use crate::source::{GetContentSourceContent, GetContentSourceContents};\n \n /// The type of the route. This will decide about the remaining segments of the\n /// route after the base.\n@@ -24,7 +25,18 @@ pub enum RouteType {\n \n /// Some normal segment of a route.\n #[derive(\n-    TaskInput, Clone, Debug, PartialEq, Eq, Hash, Serialize, Deserialize, TraceRawVcs, NonLocalValue,\n+    TaskInput,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum BaseSegment {\n     Static(RcStr),\n@@ -106,6 +118,7 @@ impl RouteTrees {\n pub struct RouteTree {\n     base: Vec<BaseSegment>,\n     sources: Vec<ResolvedVc<Box<dyn GetContentSourceContent>>>,\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     static_segments: FxIndexMap<RcStr, ResolvedVc<RouteTree>>,\n     dynamic_segments: Vec<ResolvedVc<RouteTree>>,\n     catch_all_sources: Vec<ResolvedVc<Box<dyn GetContentSourceContent>>>,"
        },
        {
            "sha": "4114e7ce426ed284dae18a39b2cfbbe30ec64f4d",
            "filename": "turbopack/crates/turbopack-ecmascript-plugins/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -25,6 +25,7 @@ workspace = true\n [dependencies]\n anyhow = { workspace = true }\n async-trait = { workspace = true }\n+bincode = { workspace = true }\n indexmap = { workspace = true }\n serde = { workspace = true }\n serde_json = { workspace = true }"
        },
        {
            "sha": "ef1ec7ee980815656bba6b8d917338ea5ed3b4ba",
            "filename": "turbopack/crates/turbopack-ecmascript-plugins/src/transform/emotion.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Femotion.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Femotion.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Femotion.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -6,6 +6,7 @@ use std::{\n \n use anyhow::Result;\n use async_trait::async_trait;\n+use bincode::{Decode, Encode};\n use indexmap::IndexMap;\n use rustc_hash::{FxBuildHasher, FxHasher};\n use serde::{Deserialize, Serialize};\n@@ -23,7 +24,17 @@ use turbo_tasks::{NonLocalValue, OperationValue, ValueDefault, Vc, trace::TraceR\n use turbopack_ecmascript::{CustomTransformer, TransformContext};\n \n #[derive(\n-    Clone, PartialEq, Eq, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue, OperationValue,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Debug,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum EmotionLabelKind {\n@@ -70,6 +81,7 @@ pub struct EmotionTransformConfig {\n     pub sourcemap: Option<bool>,\n     pub label_format: Option<String>,\n     pub auto_label: Option<EmotionLabelKind>,\n+    #[bincode(with_serde)]\n     pub import_map: Option<IndexMap<RcStr, EmotionImportMapValue, FxBuildHasher>>,\n }\n "
        },
        {
            "sha": "2154802db3cb64d89f68d191b932da59962b31e4",
            "filename": "turbopack/crates/turbopack-ecmascript-plugins/src/transform/relay.rs",
            "status": "modified",
            "additions": 21,
            "deletions": 2,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Frelay.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Frelay.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Frelay.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -2,6 +2,7 @@ use std::{path::PathBuf, sync::Arc};\n \n use anyhow::{Context, Result};\n use async_trait::async_trait;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{common::FileName, ecma::ast::Program};\n use swc_relay::RelayLanguageConfig;\n@@ -10,7 +11,16 @@ use turbo_tasks_fs::FileSystemPath;\n use turbopack_ecmascript::{CustomTransformer, TransformContext};\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\")]\n pub struct RelayConfig {\n@@ -20,7 +30,16 @@ pub struct RelayConfig {\n }\n \n #[derive(\n-    Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"lowercase\")]\n pub enum RelayLanguage {"
        },
        {
            "sha": "cfcf8149c977019d8b924702f7b91aca718d3e7b",
            "filename": "turbopack/crates/turbopack-ecmascript/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -24,6 +24,7 @@ workspace = true\n anyhow = { workspace = true }\n async-trait = { workspace = true }\n auto-hash-map = { workspace = true }\n+bincode = { workspace = true }\n bytes-str = { workspace = true }\n data-encoding = { workspace = true }\n either = { workspace = true }\n@@ -45,6 +46,7 @@ smallvec = { workspace = true }\n strsim = { workspace = true }\n tokio = { workspace = true }\n tracing = { workspace = true }\n+turbo-bincode = { workspace = true }\n turbo-esregex = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }"
        },
        {
            "sha": "f4d573d17d1a53018b436ed8cf5ed8fa77ce36ff",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/imports.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fimports.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fimports.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fimports.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -29,6 +29,7 @@ use crate::{\n pub struct ImportAnnotations {\n     // TODO store this in more structured way\n     #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n     map: BTreeMap<Wtf8Atom, Wtf8Atom>,\n }\n "
        },
        {
            "sha": "b98e087c13ee0d4029c41d007e1741fd1cf41b87",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/mod.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 10,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -25,9 +25,9 @@ use swc_core::{\n };\n use turbo_esregex::EsRegex;\n use turbo_rcstr::RcStr;\n-use turbo_tasks::{FxIndexMap, FxIndexSet, Vc};\n+use turbo_tasks::{FxIndexMap, FxIndexSet, ResolvedVc, Vc};\n use turbopack_core::compile_time_info::{\n-    CompileTimeDefineValue, DefinableNameSegment, FreeVarReference,\n+    CompileTimeDefineValue, DefinableNameSegment, FreeVarReference, FreeVarReferenceVcs,\n };\n \n use self::imports::ImportAnnotations;\n@@ -2097,19 +2097,16 @@ impl JsValue {\n     ///\n     /// Uses the `VarGraph` to verify that the first segment is not a local\n     /// variable/was not reassigned.\n-    pub fn match_free_var_reference<'a, T>(\n+    pub fn match_free_var_reference(\n         &self,\n         var_graph: &VarGraph,\n-        free_var_references: &'a FxIndexMap<\n-            DefinableNameSegment,\n-            FxIndexMap<Vec<DefinableNameSegment>, T>,\n-        >,\n+        free_var_references: &FxIndexMap<DefinableNameSegment, FreeVarReferenceVcs>,\n         prop: &DefinableNameSegment,\n-    ) -> Option<&'a T> {\n+    ) -> Option<ResolvedVc<FreeVarReference>> {\n         if let Some(def_name_len) = self.get_definable_name_len()\n             && let Some(references) = free_var_references.get(prop)\n         {\n-            for (name, value) in references {\n+            for (name, value) in &references.0 {\n                 if name.len() != def_name_len {\n                     continue;\n                 }\n@@ -2128,7 +2125,7 @@ impl JsValue {\n                         }\n                     }\n \n-                    return Some(value);\n+                    return Some(*value);\n                 }\n             }\n         }"
        },
        {
            "sha": "c2c06c08b3aeb8416f086c58d6019ee306620411",
            "filename": "turbopack/crates/turbopack-ecmascript/src/chunk/batch.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fbatch.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fbatch.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fbatch.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, ResolvedVc, TaskInput, TryJoinIterExt, Vc, trace::TraceRawVcs};\n use turbopack_core::{\n@@ -11,7 +12,18 @@ use turbopack_core::{\n use crate::chunk::EcmascriptChunkItemWithAsyncInfo;\n \n #[derive(\n-    Debug, Clone, Hash, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, TaskInput,\n+    Debug,\n+    Clone,\n+    Hash,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum EcmascriptChunkItemOrBatchWithAsyncInfo {\n     ChunkItem(EcmascriptChunkItemWithAsyncInfo),"
        },
        {
            "sha": "6311b29bf58da987f746bada380a5e08a5de3027",
            "filename": "turbopack/crates/turbopack-ecmascript/src/chunk/item.rs",
            "status": "modified",
            "additions": 26,
            "deletions": 2,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fitem.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fitem.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fitem.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::io::Write;\n \n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use smallvec::SmallVec;\n use turbo_rcstr::{RcStr, rcstr};\n@@ -40,6 +41,8 @@ use crate::{\n     TaskInput,\n     NonLocalValue,\n     Default,\n+    Encode,\n+    Decode,\n )]\n pub enum RewriteSourcePath {\n     AbsoluteFilePath(FileSystemPath),\n@@ -177,7 +180,17 @@ impl EcmascriptChunkItemContent {\n }\n \n #[derive(\n-    PartialEq, Eq, Default, Debug, Clone, Serialize, Deserialize, TraceRawVcs, NonLocalValue,\n+    PartialEq,\n+    Eq,\n+    Default,\n+    Debug,\n+    Clone,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct EcmascriptChunkItemOptions {\n     /// Whether this chunk item should be in \"use strict\" mode.\n@@ -195,7 +208,18 @@ pub struct EcmascriptChunkItemOptions {\n }\n \n #[derive(\n-    Serialize, Deserialize, Debug, Clone, PartialEq, Eq, Hash, TraceRawVcs, TaskInput, NonLocalValue,\n+    Serialize,\n+    Deserialize,\n+    Debug,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Hash,\n+    TraceRawVcs,\n+    TaskInput,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct EcmascriptChunkItemWithAsyncInfo {\n     pub chunk_item: ResolvedVc<Box<dyn EcmascriptChunkItem>>,"
        },
        {
            "sha": "7536b1a13380d3f627dd65893c3587f0b2fcf55e",
            "filename": "turbopack/crates/turbopack-ecmascript/src/code_gen.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fcode_gen.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fcode_gen.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fcode_gen.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     base::SwcComments,\n@@ -174,7 +175,17 @@ impl_modify!(visit_mut_switch_case, SwitchCase);\n impl_modify!(visit_mut_program, Program);\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub enum CodeGen {\n     // AMD occurs very rarely and makes the enum much bigger"
        },
        {
            "sha": "76626e0387928fffda72ebb66c121eb4b3d41712",
            "filename": "turbopack/crates/turbopack-ecmascript/src/lib.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -45,6 +45,7 @@ use std::{\n };\n \n use anyhow::{Context, Result, anyhow, bail};\n+use bincode::{Decode, Encode};\n use chunk::EcmascriptChunkItem;\n use code_gen::{CodeGeneration, CodeGenerationHoistedStmt};\n use either::Either;\n@@ -144,6 +145,8 @@ use crate::{\n     NonLocalValue,\n     Serialize,\n     Deserialize,\n+    Encode,\n+    Decode,\n )]\n pub enum SpecifiedModuleType {\n     #[default]\n@@ -167,6 +170,8 @@ pub enum SpecifiedModuleType {\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"kebab-case\")]\n pub enum TreeShakingMode {\n@@ -190,6 +195,8 @@ pub enum TreeShakingMode {\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum AnalyzeMode {\n     /// For bundling only, no tracing of referenced files.\n@@ -233,6 +240,8 @@ pub struct OptionTreeShaking(pub Option<TreeShakingMode>);\n     TraceRawVcs,\n     NonLocalValue,\n     TaskInput,\n+    Encode,\n+    Decode,\n )]\n pub enum TypeofWindow {\n     Object,"
        },
        {
            "sha": "931835b37825ba04dc49b93def06ee602275eca6",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/amd.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 1,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Famd.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Famd.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Famd.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::mem::take;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::DUMMY_SP,\n@@ -99,6 +100,8 @@ impl ChunkableModuleReference for AmdDefineAssetReference {}\n     Clone,\n     NonLocalValue,\n     Hash,\n+    Encode,\n+    Decode,\n )]\n pub enum AmdDefineDependencyElement {\n     Request {\n@@ -122,6 +125,8 @@ pub enum AmdDefineDependencyElement {\n     Clone,\n     NonLocalValue,\n     Hash,\n+    Encode,\n+    Decode,\n )]\n pub enum AmdDefineFactoryType {\n     Unknown,\n@@ -130,7 +135,17 @@ pub enum AmdDefineFactoryType {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct AmdDefineWithDependenciesCodeGen {\n     dependencies_requests: Vec<AmdDefineDependencyElement>,"
        },
        {
            "sha": "ea789b9bbab947e547da4976b120d9f681077375",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/async_module.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 3,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fasync_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fasync_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fasync_module.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::DUMMY_SP,\n@@ -16,17 +17,27 @@ use turbopack_core::{\n     resolve::ExternalType,\n };\n \n-use super::esm::base::ReferencedAsset;\n use crate::{\n     ScopeHoistingContext,\n     code_gen::{CodeGeneration, CodeGenerationHoistedStmt},\n+    references::esm::base::ReferencedAsset,\n     utils::AstSyntaxContext,\n };\n \n /// Information needed for generating the async module wrapper for\n /// [EcmascriptChunkItem](crate::chunk::EcmascriptChunkItem)s.\n #[derive(\n-    PartialEq, Eq, Default, Debug, Clone, Serialize, Deserialize, TraceRawVcs, NonLocalValue,\n+    PartialEq,\n+    Eq,\n+    Default,\n+    Debug,\n+    Clone,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct AsyncModuleOptions {\n     pub has_top_level_await: bool,\n@@ -83,7 +94,9 @@ impl OptionAsyncModule {\n /// The identifiers (and their corresponding syntax context) of all async modules referenced by the\n /// current module.\n #[turbo_tasks::value(transparent)]\n-struct AsyncModuleIdents(FxIndexSet<(String, AstSyntaxContext)>);\n+struct AsyncModuleIdents(\n+    #[bincode(with = \"turbo_bincode::indexset\")] FxIndexSet<(String, AstSyntaxContext)>,\n+);\n \n async fn get_inherit_async_referenced_asset(\n     r: ResolvedVc<Box<dyn ModuleReference>>,"
        },
        {
            "sha": "236a4518293652c694d96799ca378866327ea1d6",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/cjs.rs",
            "status": "modified",
            "additions": 34,
            "deletions": 3,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fcjs.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fcjs.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fcjs.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::util::take::Take,\n@@ -151,7 +152,17 @@ impl IntoCodeGenReference for CjsRequireAssetReference {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct CjsRequireAssetReferenceCodeGen {\n     reference: ResolvedVc<CjsRequireAssetReference>,\n@@ -277,7 +288,17 @@ impl IntoCodeGenReference for CjsRequireResolveAssetReference {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct CjsRequireResolveAssetReferenceCodeGen {\n     reference: ResolvedVc<CjsRequireResolveAssetReference>,\n@@ -339,7 +360,17 @@ impl CjsRequireResolveAssetReferenceCodeGen {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Debug, Hash,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Debug,\n+    Hash,\n+    Encode,\n+    Decode,\n )]\n pub struct CjsRequireCacheAccess {\n     pub path: AstPath,"
        },
        {
            "sha": "b55c1708c24bdc01504f251219b0bbc650bdc9f4",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/constant_condition.rs",
            "status": "modified",
            "additions": 25,
            "deletions": 3,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_condition.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_condition.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_condition.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,17 +1,29 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::quote;\n use turbo_tasks::{NonLocalValue, Vc, debug::ValueDebugFormat, trace::TraceRawVcs};\n use turbopack_core::chunk::ChunkingContext;\n \n-use super::AstPath;\n use crate::{\n     code_gen::{CodeGen, CodeGeneration},\n     create_visitor,\n+    references::AstPath,\n };\n \n #[derive(\n-    Copy, Clone, Hash, PartialEq, Eq, Debug, Serialize, Deserialize, TraceRawVcs, NonLocalValue,\n+    Copy,\n+    Clone,\n+    Hash,\n+    PartialEq,\n+    Eq,\n+    Debug,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum ConstantConditionValue {\n     Truthy,\n@@ -20,7 +32,17 @@ pub enum ConstantConditionValue {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Debug, Hash,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Debug,\n+    Hash,\n+    Encode,\n+    Decode,\n )]\n pub struct ConstantConditionCodeGen {\n     value: ConstantConditionValue,"
        },
        {
            "sha": "524eafd3c36109c63e81b17098b4eb874a1601e2",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/constant_value.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_value.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_value.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_value.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::{DUMMY_SP, FileName, SourceMap, sync::Lrc},\n@@ -12,10 +13,10 @@ use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, Vc, debug::ValueDebugFormat, trace::TraceRawVcs};\n use turbopack_core::{chunk::ChunkingContext, compile_time_info::CompileTimeDefineValue};\n \n-use super::AstPath;\n use crate::{\n     code_gen::{CodeGen, CodeGeneration},\n     create_visitor,\n+    references::AstPath,\n };\n \n #[derive(\n@@ -29,6 +30,8 @@ use crate::{\n     TraceRawVcs,\n     ValueDebugFormat,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub struct ConstantValueCodeGen {\n     value: CompileTimeDefineValue,"
        },
        {
            "sha": "ac3e27e761741b0237d0192ca987cadfae5e72f8",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/dynamic_expression.rs",
            "status": "modified",
            "additions": 24,
            "deletions": 3,
            "changes": 27,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fdynamic_expression.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fdynamic_expression.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fdynamic_expression.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,25 +1,46 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::quote;\n use turbo_tasks::{NonLocalValue, Vc, debug::ValueDebugFormat, trace::TraceRawVcs};\n use turbopack_core::chunk::ChunkingContext;\n \n-use super::AstPath;\n use crate::{\n     code_gen::{CodeGen, CodeGeneration},\n     create_visitor,\n+    references::AstPath,\n };\n \n #[derive(\n-    PartialEq, Eq, TraceRawVcs, Serialize, Deserialize, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n enum DynamicExpressionType {\n     Promise,\n     Normal,\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Debug, Hash,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Debug,\n+    Hash,\n+    Encode,\n+    Decode,\n )]\n pub struct DynamicExpression {\n     path: AstPath,"
        },
        {
            "sha": "7d4fdbd1d4af74aded8b82964c344b309e218f3b",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/base.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbase.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbase.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbase.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -35,15 +35,20 @@ use turbopack_core::{\n };\n use turbopack_resolve::ecmascript::esm_resolve;\n \n-use super::export::{all_known_export_names, is_export_missing};\n use crate::{\n     EcmascriptModuleAsset, ScopeHoistingContext, TreeShakingMode,\n     analyzer::imports::ImportAnnotations,\n     chunk::{EcmascriptChunkPlaceable, EcmascriptExports},\n     code_gen::{CodeGeneration, CodeGenerationHoistedStmt},\n     export::Liveness,\n     magic_identifier,\n-    references::{esm::EsmExport, util::throw_module_not_found_expr},\n+    references::{\n+        esm::{\n+            EsmExport,\n+            export::{all_known_export_names, is_export_missing},\n+        },\n+        util::throw_module_not_found_expr,\n+    },\n     runtime_functions::{TURBOPACK_EXTERNAL_IMPORT, TURBOPACK_EXTERNAL_REQUIRE, TURBOPACK_IMPORT},\n     tree_shake::{TURBOPACK_PART_IMPORT_SOURCE, asset::EcmascriptModulePartAsset},\n     utils::module_id_to_lit,"
        },
        {
            "sha": "3b60b50157abeaef2553be82fecc852d401ab899",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/binding.rs",
            "status": "modified",
            "additions": 18,
            "deletions": 3,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbinding.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbinding.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbinding.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::ecma::{\n     ast::{Expr, KeyValueProp, Prop, PropName, SimpleAssignTarget},\n@@ -8,18 +9,32 @@ use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, ResolvedVc, Vc, trace::TraceRawVcs};\n use turbopack_core::chunk::ChunkingContext;\n \n-use super::EsmAssetReference;\n use crate::{\n     ScopeHoistingContext,\n     code_gen::{CodeGen, CodeGeneration},\n     create_visitor,\n     references::{\n         AstPath,\n-        esm::base::{ReferencedAsset, ReferencedAssetIdent},\n+        esm::{\n+            EsmAssetReference,\n+            base::{ReferencedAsset, ReferencedAssetIdent},\n+        },\n     },\n };\n \n-#[derive(Hash, Clone, Debug, Serialize, Deserialize, PartialEq, Eq, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Hash,\n+    Clone,\n+    Debug,\n+    Serialize,\n+    Deserialize,\n+    PartialEq,\n+    Eq,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub struct EsmBinding {\n     reference: ResolvedVc<EsmAssetReference>,\n     export: Option<RcStr>,"
        },
        {
            "sha": "597fcbf409df1afc95c750f9d140019a9b925363",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/dynamic.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 3,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fdynamic.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fdynamic.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fdynamic.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::{DUMMY_SP, util::take::Take},\n@@ -23,12 +24,14 @@ use turbopack_core::{\n };\n use turbopack_resolve::ecmascript::esm_resolve;\n \n-use super::super::pattern_mapping::{PatternMapping, ResolveType};\n use crate::{\n     analyzer::imports::ImportAnnotations,\n     code_gen::{CodeGen, CodeGeneration, IntoCodeGenReference},\n     create_visitor,\n-    references::AstPath,\n+    references::{\n+        AstPath,\n+        pattern_mapping::{PatternMapping, ResolveType},\n+    },\n };\n \n #[turbo_tasks::value]\n@@ -122,7 +125,17 @@ impl IntoCodeGenReference for EsmAsyncAssetReference {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct EsmAsyncAssetReferenceCodeGen {\n     path: AstPath,"
        },
        {
            "sha": "a4aa6fbd57444c29056614882ee38890d063bcc3",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/export.rs",
            "status": "modified",
            "additions": 42,
            "deletions": 4,
            "changes": 46,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fexport.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fexport.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fexport.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{borrow::Cow, collections::BTreeMap, ops::ControlFlow};\n \n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use rustc_hash::FxHashSet;\n use serde::{Deserialize, Serialize};\n use swc_core::{\n@@ -26,13 +27,13 @@ use turbopack_core::{\n     resolve::ModulePart,\n };\n \n-use super::base::ReferencedAsset;\n use crate::{\n     EcmascriptModuleAsset, ScopeHoistingContext,\n     analyzer::graph::EvalContext,\n     chunk::{EcmascriptChunkPlaceable, EcmascriptExports},\n     code_gen::{CodeGeneration, CodeGenerationHoistedStmt},\n     magic_identifier,\n+    references::esm::base::ReferencedAsset,\n     runtime_functions::{TURBOPACK_DYNAMIC, TURBOPACK_ESM},\n     tree_shake::asset::EcmascriptModulePartAsset,\n     utils::module_id_to_lit,\n@@ -42,7 +43,18 @@ use crate::{\n /// All ESM exports are technically live but many never change and we can optimize representation to\n /// support that, this enum tracks the actual behavior of the export binding.\n #[derive(\n-    Copy, Clone, Hash, Debug, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue,\n+    Copy,\n+    Clone,\n+    Hash,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum Liveness {\n     // The binding never changes after module evaluation\n@@ -55,7 +67,19 @@ pub enum Liveness {\n     Mutable,\n }\n \n-#[derive(Clone, Hash, Debug, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Clone,\n+    Hash,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub enum EsmExport {\n     /// A local binding that is exported (export { a } or export const a = 1)\n     ///\n@@ -134,7 +158,19 @@ pub async fn all_known_export_names(\n     Ok(Vc::cell(export_names.esm_exports.keys().cloned().collect()))\n }\n \n-#[derive(Copy, Clone, Debug, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Copy,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub enum FoundExportType {\n     Found,\n     Dynamic,\n@@ -323,6 +359,7 @@ async fn find_export_from_reexports(\n \n #[turbo_tasks::value]\n struct AllExportNamesResult {\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     esm_exports: FxIndexMap<RcStr, ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>>,\n     dynamic_exporting_modules: Vec<ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>>,\n }\n@@ -381,6 +418,7 @@ async fn get_all_export_names(\n \n #[turbo_tasks::value]\n pub struct ExpandStarResult {\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     pub esm_exports: FxIndexMap<RcStr, ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>>,\n     pub dynamic_exporting_modules: Vec<ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>>,\n }"
        },
        {
            "sha": "97e6df63af99abe99cb5b291de8035af6561ccef",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/meta.rs",
            "status": "modified",
            "additions": 23,
            "deletions": 2,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fmeta.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fmeta.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fmeta.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::borrow::Cow;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::DUMMY_SP,\n@@ -27,7 +28,17 @@ use crate::{\n ///\n /// This singleton behavior must be enforced by the caller!\n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Debug, Hash,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Debug,\n+    Hash,\n+    Encode,\n+    Decode,\n )]\n pub struct ImportMetaBinding {\n     path: FileSystemPath,\n@@ -88,7 +99,17 @@ impl From<ImportMetaBinding> for CodeGen {\n /// There can be many references to import.meta, and they appear at any nesting\n /// in the file. But all references refer to the same mutable object.\n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct ImportMetaRef {\n     ast_path: AstPath,"
        },
        {
            "sha": "80a970e486624f73379f744afde59357734f81f2",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/module_id.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 3,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fmodule_id.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fmodule_id.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fmodule_id.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::quote;\n use turbo_rcstr::RcStr;\n@@ -11,11 +12,13 @@ use turbopack_core::{\n     resolve::ModuleResolveResult,\n };\n \n-use super::{EsmAssetReference, base::ReferencedAsset};\n use crate::{\n     code_gen::{CodeGen, CodeGeneration, IntoCodeGenReference},\n     create_visitor,\n-    references::AstPath,\n+    references::{\n+        AstPath,\n+        esm::{EsmAssetReference, base::ReferencedAsset},\n+    },\n     utils::module_id_to_lit,\n };\n \n@@ -74,7 +77,17 @@ impl IntoCodeGenReference for EsmModuleIdAssetReference {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct EsmModuleIdAssetReferenceCodeGen {\n     path: AstPath,"
        },
        {
            "sha": "fb99c51faa3b4b828dabfd735ead34f72df86992",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/module_item.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fmodule_item.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fmodule_item.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fmodule_item.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::mem::replace;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::DUMMY_SP,\n@@ -23,7 +24,17 @@ use crate::{\n /// expr/decl in a normal statement. Unnamed expr/decl will be named with the\n /// magic identifier \"export default\"\n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Debug, Hash,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Debug,\n+    Hash,\n+    Encode,\n+    Decode,\n )]\n pub struct EsmModuleItem {\n     pub path: AstPath,"
        },
        {
            "sha": "a4fc63ec15956850f6ab9425f69022bba3293158",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/url.rs",
            "status": "modified",
            "additions": 15,
            "deletions": 3,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Furl.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Furl.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Furl.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     ecma::ast::{Expr, ExprOrSpread, NewExpr},\n@@ -23,11 +24,10 @@ use turbopack_core::{\n     },\n };\n \n-use super::base::ReferencedAsset;\n use crate::{\n     code_gen::{CodeGen, CodeGeneration, IntoCodeGenReference},\n     create_visitor,\n-    references::AstPath,\n+    references::{AstPath, esm::base::ReferencedAsset},\n     runtime_functions::{\n         TURBOPACK_RELATIVE_URL, TURBOPACK_REQUIRE, TURBOPACK_RESOLVE_MODULE_ID_PATH,\n     },\n@@ -49,6 +49,8 @@ use crate::{\n     TraceRawVcs,\n     TaskInput,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum UrlRewriteBehavior {\n     /// Omits base, resulting in a relative URL.\n@@ -147,7 +149,17 @@ impl IntoCodeGenReference for UrlAssetReference {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct UrlAssetReferenceCodeGen {\n     reference: ResolvedVc<UrlAssetReference>,"
        },
        {
            "sha": "2f9fafe9e9334ebb242f32885e962f6186e8755d",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/exports_info.rs",
            "status": "modified",
            "additions": 23,
            "deletions": 2,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fexports_info.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fexports_info.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fexports_info.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::DUMMY_SP,\n@@ -24,7 +25,17 @@ use crate::{\n ///\n /// This singleton behavior must be enforced by the caller!\n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct ExportsInfoBinding {}\n \n@@ -92,7 +103,17 @@ impl From<ExportsInfoBinding> for CodeGen {\n /// There can be many references, and they appear at any nesting in the file. But all references\n /// refer to the same mutable object.\n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct ExportsInfoRef {\n     ast_path: AstPath,"
        },
        {
            "sha": "144074a5830e9514edfcb90b180464ab5a5364bf",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/external_module.rs",
            "status": "modified",
            "additions": 15,
            "deletions": 1,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fexternal_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fexternal_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fexternal_module.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{borrow::Cow, fmt::Display, io::Write};\n \n use anyhow::{Context, Result};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{NonLocalValue, ResolvedVc, TaskInput, TryJoinIterExt, Vc, trace::TraceRawVcs};\n@@ -55,6 +56,8 @@ use crate::{\n     TaskInput,\n     Hash,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum CachedExternalType {\n     CommonJs,\n@@ -65,7 +68,18 @@ pub enum CachedExternalType {\n }\n \n #[derive(\n-    Clone, Debug, Eq, PartialEq, Serialize, Deserialize, TraceRawVcs, TaskInput, Hash, NonLocalValue,\n+    Clone,\n+    Debug,\n+    Eq,\n+    PartialEq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    TaskInput,\n+    Hash,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n /// Whether to add a traced reference to the external module using the given context and resolve\n /// origin."
        },
        {
            "sha": "d3d75dbbaff1a645d77ca6862e06bf0bf67edce4",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/ident.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 2,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fident.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fident.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fident.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,18 +1,29 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{ecma::ast::Expr, quote};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, Vc, debug::ValueDebugFormat, trace::TraceRawVcs};\n use turbopack_core::chunk::ChunkingContext;\n \n-use super::AstPath;\n use crate::{\n     code_gen::{CodeGen, CodeGeneration},\n     create_visitor,\n+    references::AstPath,\n };\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Debug, Hash,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Debug,\n+    Hash,\n+    Encode,\n+    Decode,\n )]\n pub struct IdentReplacement {\n     value: RcStr,"
        },
        {
            "sha": "d27d0617285de3471f2c8af458e8640faa2f8015",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/member.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 2,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmember.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmember.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmember.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     atoms::atom,\n@@ -14,14 +15,24 @@ use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, Vc, debug::ValueDebugFormat, trace::TraceRawVcs};\n use turbopack_core::chunk::ChunkingContext;\n \n-use super::AstPath;\n use crate::{\n     code_gen::{CodeGen, CodeGeneration},\n     create_visitor,\n+    references::AstPath,\n };\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct MemberReplacement {\n     key: RcStr,"
        },
        {
            "sha": "1aa4365af94f97961c5d052c765ce89de4671b3c",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/mod.rs",
            "status": "modified",
            "additions": 48,
            "deletions": 54,
            "changes": 102,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -29,6 +29,7 @@ use std::{\n };\n \n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use constant_condition::{ConstantConditionCodeGen, ConstantConditionValue};\n use constant_value::ConstantValueCodeGen;\n use either::Either;\n@@ -70,7 +71,8 @@ use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::{\n     compile_time_info::{\n         CompileTimeDefineValue, CompileTimeDefines, CompileTimeInfo, DefinableNameSegment,\n-        FreeVarReference, FreeVarReferences, FreeVarReferencesIndividual, InputRelativeConstant,\n+        FreeVarReference, FreeVarReferenceVcs, FreeVarReferences, FreeVarReferencesIndividual,\n+        InputRelativeConstant,\n     },\n     environment::Rendering,\n     error::PrettyPrintError,\n@@ -96,75 +98,67 @@ use turbopack_swc_utils::emitter::IssueEmitter;\n use unreachable::Unreachable;\n use worker::WorkerAssetReference;\n \n-use self::{\n-    amd::{\n-        AmdDefineAssetReference, AmdDefineDependencyElement, AmdDefineFactoryType,\n-        AmdDefineWithDependenciesCodeGen,\n-    },\n-    cjs::CjsAssetReference,\n-    esm::{\n-        EsmAssetReference, EsmAsyncAssetReference, EsmExports, EsmModuleItem, ImportMetaBinding,\n-        ImportMetaRef, UrlAssetReference, export::EsmExport,\n-    },\n-    raw::{DirAssetReference, FileSourceReference},\n-    typescript::{TsConfigReference, TsReferencePathAssetReference, TsReferenceTypeAssetReference},\n-};\n-use super::{\n-    EcmascriptModuleAssetType, ModuleTypeResult,\n-    analyzer::{\n-        ConstantValue as JsConstantValue, JsValue, ObjectPart, WellKnownFunctionKind,\n-        WellKnownObjectKind,\n-        builtin::replace_builtin,\n-        graph::{Effect, create_graph},\n-        linker::link,\n-        well_known::replace_well_known,\n-    },\n-    errors,\n-    parse::ParseResult,\n-    utils::js_value_to_pattern,\n-    webpack::{\n-        WebpackChunkAssetReference, WebpackEntryAssetReference, WebpackRuntimeAssetReference,\n-        parse::{WebpackRuntime, webpack_runtime},\n-    },\n-};\n pub use crate::references::esm::export::{FollowExportsResult, follow_reexports};\n use crate::{\n-    AnalyzeMode, EcmascriptInputTransforms, EcmascriptModuleAsset, EcmascriptParsable,\n-    SpecifiedModuleType, TreeShakingMode, TypeofWindow,\n+    AnalyzeMode, EcmascriptInputTransforms, EcmascriptModuleAsset, EcmascriptModuleAssetType,\n+    EcmascriptParsable, ModuleTypeResult, SpecifiedModuleType, TreeShakingMode, TypeofWindow,\n     analyzer::{\n-        ConstantNumber, ConstantString, JsValueUrlKind, RequireContextValue,\n-        builtin::early_replace_builtin,\n-        graph::{ConditionalKind, DeclUsage, EffectArg, EvalContext, VarGraph},\n+        ConstantNumber, ConstantString, ConstantValue as JsConstantValue, JsValue, JsValueUrlKind,\n+        ObjectPart, RequireContextValue, WellKnownFunctionKind, WellKnownObjectKind,\n+        builtin::{early_replace_builtin, replace_builtin},\n+        graph::{\n+            ConditionalKind, DeclUsage, Effect, EffectArg, EvalContext, VarGraph, create_graph,\n+        },\n         imports::{ImportAnnotations, ImportAttributes, ImportedSymbol, Reexport},\n+        linker::link,\n         parse_require_context,\n         top_level_await::has_top_level_await,\n+        well_known::replace_well_known,\n     },\n     chunk::EcmascriptExports,\n     code_gen::{CodeGen, CodeGens, IntoCodeGenReference},\n+    errors,\n     export::Liveness,\n     magic_identifier,\n+    parse::ParseResult,\n     references::{\n+        amd::{\n+            AmdDefineAssetReference, AmdDefineDependencyElement, AmdDefineFactoryType,\n+            AmdDefineWithDependenciesCodeGen,\n+        },\n         async_module::{AsyncModule, OptionAsyncModule},\n-        cjs::{CjsRequireAssetReference, CjsRequireCacheAccess, CjsRequireResolveAssetReference},\n+        cjs::{\n+            CjsAssetReference, CjsRequireAssetReference, CjsRequireCacheAccess,\n+            CjsRequireResolveAssetReference,\n+        },\n         dynamic_expression::DynamicExpression,\n         esm::{\n-            EsmBinding, UrlRewriteBehavior, base::EsmAssetReferences,\n-            module_id::EsmModuleIdAssetReference,\n+            EsmAssetReference, EsmAsyncAssetReference, EsmBinding, EsmExports, EsmModuleItem,\n+            ImportMetaBinding, ImportMetaRef, UrlAssetReference, UrlRewriteBehavior,\n+            base::EsmAssetReferences, export::EsmExport, module_id::EsmModuleIdAssetReference,\n         },\n         exports_info::{ExportsInfoBinding, ExportsInfoRef},\n         ident::IdentReplacement,\n         member::MemberReplacement,\n         node::{FilePathModuleReference, PackageJsonReference},\n+        raw::{DirAssetReference, FileSourceReference},\n         require_context::{RequireContextAssetReference, RequireContextMap},\n         type_issue::SpecifiedModuleTypeIssue,\n+        typescript::{\n+            TsConfigReference, TsReferencePathAssetReference, TsReferenceTypeAssetReference,\n+        },\n     },\n     runtime_functions::{\n         TURBOPACK_EXPORT_NAMESPACE, TURBOPACK_EXPORT_VALUE, TURBOPACK_EXPORTS, TURBOPACK_GLOBAL,\n         TURBOPACK_REQUIRE_REAL, TURBOPACK_REQUIRE_STUB, TURBOPACK_RUNTIME_FUNCTION_SHORTCUTS,\n     },\n     source_map::parse_source_map_comment,\n     tree_shake::{find_turbopack_part_id_in_asserts, part_of_module, split_module},\n-    utils::{AstPathRange, module_value_to_well_known_object},\n+    utils::{AstPathRange, js_value_to_pattern, module_value_to_well_known_object},\n+    webpack::{\n+        WebpackChunkAssetReference, WebpackEntryAssetReference, WebpackRuntimeAssetReference,\n+        parse::{WebpackRuntime, webpack_runtime},\n+    },\n };\n \n #[turbo_tasks::value(shared)]\n@@ -2761,7 +2755,7 @@ async fn handle_member(\n         if let Some(references) = references {\n             let obj = obj.as_ref().unwrap();\n             if let Some(def_name_len) = obj.get_definable_name_len() {\n-                for (name, value) in references {\n+                for (name, value) in &references.0 {\n                     if name.len() != def_name_len {\n                         continue;\n                     }\n@@ -2803,7 +2797,7 @@ async fn handle_typeof(\n ) -> Result<()> {\n     if let Some(value) = arg.match_free_var_reference(\n         state.var_graph,\n-        &*state.free_var_references,\n+        &state.free_var_references,\n         &DefinableNameSegment::TypeOf,\n     ) {\n         handle_free_var_reference(ast_path, &*value.await?, span, state, analysis).await?;\n@@ -2822,7 +2816,7 @@ async fn handle_free_var(\n     if let Some(def_name_len) = var.get_definable_name_len() {\n         let first = var.iter_definable_name_rev().next().unwrap();\n         if let Some(references) = state.free_var_references.get(&*first) {\n-            for (name, value) in references {\n+            for (name, value) in &references.0 {\n                 if name.len() + 1 != def_name_len {\n                     continue;\n                 }\n@@ -3179,10 +3173,7 @@ async fn value_visitor(\n     origin: Vc<Box<dyn ResolveOrigin>>,\n     v: JsValue,\n     compile_time_info: Vc<CompileTimeInfo>,\n-    free_var_references: &FxIndexMap<\n-        DefinableNameSegment,\n-        FxIndexMap<Vec<DefinableNameSegment>, ResolvedVc<FreeVarReference>>,\n-    >,\n+    free_var_references: &FxIndexMap<DefinableNameSegment, FreeVarReferenceVcs>,\n     var_graph: &VarGraph,\n     attributes: &ImportAttributes,\n     allow_project_root_tracing: bool,\n@@ -3205,10 +3196,7 @@ async fn value_visitor_inner(\n     origin: Vc<Box<dyn ResolveOrigin>>,\n     v: JsValue,\n     compile_time_info: Vc<CompileTimeInfo>,\n-    free_var_references: &FxIndexMap<\n-        DefinableNameSegment,\n-        FxIndexMap<Vec<DefinableNameSegment>, ResolvedVc<FreeVarReference>>,\n-    >,\n+    free_var_references: &FxIndexMap<DefinableNameSegment, FreeVarReferenceVcs>,\n     var_graph: &VarGraph,\n     attributes: &ImportAttributes,\n     allow_project_root_tracing: bool,\n@@ -3932,8 +3920,14 @@ async fn resolve_as_webpack_runtime(\n     }\n }\n \n-#[derive(Hash, Debug, Clone, Eq, Serialize, Deserialize, PartialEq, TraceRawVcs)]\n-pub struct AstPath(#[turbo_tasks(trace_ignore)] Vec<AstParentKind>);\n+#[derive(\n+    Hash, Debug, Clone, Eq, Serialize, Deserialize, PartialEq, TraceRawVcs, Encode, Decode,\n+)]\n+pub struct AstPath(\n+    #[bincode(with_serde)]\n+    #[turbo_tasks(trace_ignore)]\n+    Vec<AstParentKind>,\n+);\n \n impl TaskInput for AstPath {\n     fn is_transient(&self) -> bool {"
        },
        {
            "sha": "28059c1741a78a7edcc370dc4ea4e82f763c623f",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/pattern_mapping.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 2,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fpattern_mapping.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fpattern_mapping.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fpattern_mapping.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{borrow::Cow, collections::HashSet};\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::DUMMY_SP,\n@@ -37,7 +38,17 @@ use crate::{\n     utils::module_id_to_lit,\n };\n \n-#[derive(PartialEq, Eq, ValueDebugFormat, TraceRawVcs, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    PartialEq,\n+    Eq,\n+    ValueDebugFormat,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub(crate) enum SinglePatternMapping {\n     /// Invalid request.\n     Invalid,\n@@ -83,7 +94,7 @@ pub(crate) enum PatternMapping {\n     /// ```js\n     /// require(`./images/${name}.png`)\n     /// ```\n-    Map(FxIndexMap<String, SinglePatternMapping>),\n+    Map(#[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<String, SinglePatternMapping>),\n }\n \n #[derive("
        },
        {
            "sha": "4220effb0e3cf81f6ca35d42f2af5f66070d0aad",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/require_context.rs",
            "status": "modified",
            "additions": 21,
            "deletions": 4,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::{borrow::Cow, collections::VecDeque, sync::Arc};\n \n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::DUMMY_SP,\n@@ -61,7 +62,9 @@ pub(crate) enum DirListEntry {\n }\n \n #[turbo_tasks::value(transparent)]\n-pub(crate) struct DirList(FxIndexMap<RcStr, DirListEntry>);\n+pub(crate) struct DirList(\n+    #[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<RcStr, DirListEntry>,\n+);\n \n #[turbo_tasks::value_impl]\n impl DirList {\n@@ -151,7 +154,9 @@ impl DirList {\n }\n \n #[turbo_tasks::value(transparent)]\n-pub(crate) struct FlatDirList(FxIndexMap<RcStr, FileSystemPath>);\n+pub(crate) struct FlatDirList(\n+    #[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<RcStr, FileSystemPath>,\n+);\n \n #[turbo_tasks::value_impl]\n impl FlatDirList {\n@@ -171,7 +176,9 @@ pub struct RequireContextMapEntry {\n \n /// The resolved context map for a `require.context(..)` call.\n #[turbo_tasks::value(transparent)]\n-pub struct RequireContextMap(FxIndexMap<RcStr, RequireContextMapEntry>);\n+pub struct RequireContextMap(\n+    #[bincode(with = \"turbo_bincode::indexmap\")] FxIndexMap<RcStr, RequireContextMapEntry>,\n+);\n \n #[turbo_tasks::value_impl]\n impl RequireContextMap {\n@@ -318,7 +325,17 @@ impl IntoCodeGenReference for RequireContextAssetReference {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct RequireContextAssetReferenceCodeGen {\n     path: AstPath,"
        },
        {
            "sha": "6106e481bfff7168e1dd3ee69a1b987238b23b6b",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/unreachable.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 2,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Funreachable.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Funreachable.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Funreachable.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::mem::take;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     atoms::{Atom, atom},\n@@ -32,9 +33,18 @@ use crate::{\n };\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Debug, Hash,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Debug,\n+    Hash,\n+    Encode,\n+    Decode,\n )]\n-\n pub struct Unreachable {\n     range: AstPathRange,\n }"
        },
        {
            "sha": "95f5fa839533e1769c5340fad6765f7fcbd162a4",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/worker.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fworker.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fworker.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fworker.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::util::take::Take,\n@@ -126,7 +127,17 @@ impl IntoCodeGenReference for WorkerAssetReference {\n }\n \n #[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Hash, Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Hash,\n+    Debug,\n+    Encode,\n+    Decode,\n )]\n pub struct WorkerAssetReferenceCodeGen {\n     reference: ResolvedVc<WorkerAssetReference>,"
        },
        {
            "sha": "9c3ec219f80829075c1410e92096e71acb461076",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/locals/chunk_item.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Flocals%2Fchunk_item.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Flocals%2Fchunk_item.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Flocals%2Fchunk_item.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -7,10 +7,10 @@ use turbopack_core::{\n     output::OutputAssetsReference,\n };\n \n-use super::module::EcmascriptModuleLocalsModule;\n use crate::{\n     EcmascriptAnalyzableExt,\n     chunk::{EcmascriptChunkItem, EcmascriptChunkItemContent, EcmascriptChunkType},\n+    side_effect_optimization::locals::module::EcmascriptModuleLocalsModule,\n };\n \n /// The chunk item for [EcmascriptModuleLocalsModule]."
        },
        {
            "sha": "2872c1911153f14b09a8956e64971e0afc48711c",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/reference.rs",
            "status": "modified",
            "additions": 17,
            "deletions": 4,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::DUMMY_SP,\n@@ -17,19 +18,31 @@ use turbopack_core::{\n     resolve::{BindingUsage, ExportUsage, ImportUsage, ModulePart, ModuleResolveResult},\n };\n \n-use super::{\n-    facade::module::EcmascriptModuleFacadeModule, locals::module::EcmascriptModuleLocalsModule,\n-};\n use crate::{\n     ScopeHoistingContext,\n     chunk::EcmascriptChunkPlaceable,\n     code_gen::{CodeGeneration, CodeGenerationHoistedStmt},\n     references::esm::base::{ReferencedAsset, ReferencedAssetIdent},\n     runtime_functions::TURBOPACK_IMPORT,\n+    side_effect_optimization::{\n+        facade::module::EcmascriptModuleFacadeModule, locals::module::EcmascriptModuleLocalsModule,\n+    },\n     utils::module_id_to_lit,\n };\n \n-#[derive(Debug, Clone, Eq, PartialEq, Hash, Serialize, Deserialize, NonLocalValue, TraceRawVcs)]\n+#[derive(\n+    Debug,\n+    Clone,\n+    Eq,\n+    PartialEq,\n+    Hash,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    TraceRawVcs,\n+    Encode,\n+    Decode,\n+)]\n enum EcmascriptModulePartReferenceMode {\n     Synthesize,\n     Normal,"
        },
        {
            "sha": "eee825e35183d0f84df85bbd0ad2e3029630d5a9",
            "filename": "turbopack/crates/turbopack-ecmascript/src/utils.rs",
            "status": "modified",
            "additions": 32,
            "deletions": 5,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Futils.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Futils.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Futils.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,5 +1,6 @@\n use std::ops::Deref;\n \n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use swc_core::{\n     common::{DUMMY_SP, SyntaxContext},\n@@ -178,13 +179,33 @@ format_iter!(std::fmt::Pointer);\n format_iter!(std::fmt::UpperExp);\n format_iter!(std::fmt::UpperHex);\n \n-#[derive(Clone, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, Debug, NonLocalValue, Hash)]\n+#[derive(\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    Debug,\n+    NonLocalValue,\n+    Hash,\n+    Encode,\n+    Decode,\n+)]\n pub enum AstPathRange {\n     /// The ast path to the block or expression.\n-    Exact(#[turbo_tasks(trace_ignore)] Vec<AstParentKind>),\n+    Exact(\n+        #[bincode(with_serde)]\n+        #[turbo_tasks(trace_ignore)]\n+        Vec<AstParentKind>,\n+    ),\n     /// The ast path to a expression just before the range in the parent of the\n     /// specific ast path.\n-    StartAfter(#[turbo_tasks(trace_ignore)] Vec<AstParentKind>),\n+    StartAfter(\n+        #[bincode(with_serde)]\n+        #[turbo_tasks(trace_ignore)]\n+        Vec<AstParentKind>,\n+    ),\n }\n \n /// Converts a module value (ie an import) to a well known object,\n@@ -226,8 +247,14 @@ pub fn module_value_to_well_known_object(module_value: &ModuleValue) -> Option<J\n     })\n }\n \n-#[derive(Hash, Debug, Clone, Copy, Eq, Serialize, Deserialize, PartialEq, TraceRawVcs)]\n-pub struct AstSyntaxContext(#[turbo_tasks(trace_ignore)] SyntaxContext);\n+#[derive(\n+    Hash, Debug, Clone, Copy, Eq, Serialize, Deserialize, PartialEq, TraceRawVcs, Encode, Decode,\n+)]\n+pub struct AstSyntaxContext(\n+    #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n+    SyntaxContext,\n+);\n \n impl TaskInput for AstSyntaxContext {\n     fn is_transient(&self) -> bool {"
        },
        {
            "sha": "63fbeaf96593aadf46f79cd9cf127a340f9bed88",
            "filename": "turbopack/crates/turbopack-ecmascript/src/webpack/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fwebpack%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fwebpack%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fwebpack%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -75,6 +75,7 @@ impl Asset for WebpackModuleAsset {\n #[turbo_tasks::value(shared)]\n pub struct WebpackChunkAssetReference {\n     #[turbo_tasks(trace_ignore)]\n+    #[bincode(with_serde)]\n     pub chunk_id: Lit,\n     pub runtime: ResolvedVc<WebpackRuntime>,\n     pub transforms: ResolvedVc<EcmascriptInputTransforms>,"
        },
        {
            "sha": "94f27b73982882aafad0a887bca12e3379510fc9",
            "filename": "turbopack/crates/turbopack-image/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-image%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-image%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-image%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -21,6 +21,7 @@ workspace = true\n [dependencies]\n anyhow = { workspace = true }\n base64 = \"0.21.0\"\n+bincode = { workspace = true }\n image = { workspace = true, default-features = false, features = [\n   \"gif\",\n   \"png\",\n@@ -35,6 +36,7 @@ regex = { workspace = true }\n rustc-hash = { workspace = true }\n serde = { workspace = true }\n serde_with = { workspace = true }\n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-fs = { workspace = true }"
        },
        {
            "sha": "2935f6a37c373b1eaa313e7e806caf3de5f6a724",
            "filename": "turbopack/crates/turbopack-image/src/process/mod.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-image%2Fsrc%2Fprocess%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-image%2Fsrc%2Fprocess%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-image%2Fsrc%2Fprocess%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -4,6 +4,7 @@ use std::{io::Cursor, str::FromStr};\n \n use anyhow::{Context, Result, bail};\n use base64::{display::Base64Display, engine::general_purpose::STANDARD};\n+use bincode::{Decode, Encode};\n use image::{\n     DynamicImage, GenericImageView, ImageEncoder, ImageFormat,\n     codecs::{\n@@ -32,7 +33,17 @@ use turbopack_core::{\n use self::svg::calculate;\n \n /// Small placeholder version of the image.\n-#[derive(PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue)]\n+#[derive(\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub struct BlurPlaceholder {\n     pub data_url: String,\n     pub width: u32,\n@@ -62,6 +73,7 @@ pub struct ImageMetaData {\n     pub height: u32,\n     #[turbo_tasks(trace_ignore, debug_ignore)]\n     #[serde_as(as = \"Option<DisplayFromStr>\")]\n+    #[bincode(with = \"turbo_bincode::mime_option\")]\n     pub mime_type: Option<Mime>,\n     pub blur_placeholder: Option<BlurPlaceholder>,\n }"
        },
        {
            "sha": "ad8ec886484cb03949303f7e29cafcea76f85ce1",
            "filename": "turbopack/crates/turbopack-node/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -21,6 +21,7 @@ anyhow = { workspace = true }\n async-stream = \"0.3.4\"\n async-trait = { workspace = true }\n base64 = \"0.21.0\"\n+bincode = { workspace = true }\n const_format = { workspace = true }\n either = { workspace = true, features = [\"serde\"] }\n futures = { workspace = true }\n@@ -36,6 +37,7 @@ serde_json = { workspace = true }\n serde_with = { workspace = true, features = [\"base64\"] }\n tokio = { workspace = true, features = [\"full\"] }\n tracing = { workspace = true }\n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-bytes = { workspace = true }"
        },
        {
            "sha": "78d67cb8f59920b916f05f353bf30f3462322f69",
            "filename": "turbopack/crates/turbopack-node/src/source_map/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fsource_map%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fsource_map%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fsource_map%2Fmod.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -8,7 +8,6 @@ use anyhow::Result;\n use const_format::concatcp;\n use once_cell::sync::Lazy;\n use regex::Regex;\n-pub use trace::{StackFrame, TraceResult, trace_source_map};\n use turbo_tasks::{ReadRef, Vc};\n use turbo_tasks_fs::{\n     FileLinesContent, FileSystemPath, source_context::get_source_context, to_sys_path,\n@@ -20,6 +19,7 @@ use turbopack_core::{\n };\n use turbopack_ecmascript::magic_identifier::unmangle_identifiers;\n \n+pub use crate::source_map::trace::{StackFrame, TraceResult, trace_source_map};\n use crate::{AssetsForSourceMapping, pool::FormattingMode};\n \n pub mod trace;"
        },
        {
            "sha": "e4064f956b92ddddb5a6a88a28ec7ebfc84741de",
            "filename": "turbopack/crates/turbopack-node/src/source_map/trace.rs",
            "status": "modified",
            "additions": 31,
            "deletions": 0,
            "changes": 31,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fsource_map%2Ftrace.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fsource_map%2Ftrace.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fsource_map%2Ftrace.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,5 +1,12 @@\n use std::{borrow::Cow, fmt::Display};\n \n+use bincode::{\n+    Decode, Encode,\n+    de::Decoder,\n+    enc::Encoder,\n+    error::{DecodeError, EncodeError},\n+    impl_borrow_decode,\n+};\n use serde::{Deserialize, Serialize};\n use turbopack_core::source_map::{SourceMap, Token};\n use turbopack_ecmascript::magic_identifier::unmangle_identifiers;\n@@ -73,6 +80,30 @@ impl Display for StackFrame<'_> {\n     }\n }\n \n+impl Encode for StackFrame<'_> {\n+    fn encode<E: Encoder>(&self, encoder: &mut E) -> Result<(), EncodeError> {\n+        self.file.encode(encoder)?;\n+        self.line.encode(encoder)?;\n+        self.column.encode(encoder)?;\n+        self.name.encode(encoder)?;\n+        Ok(())\n+    }\n+}\n+\n+// needs a manual implementation because the derive macro doesn't handle the lifetime correctly\n+impl<Context> Decode<Context> for StackFrame<'_> {\n+    fn decode<D: Decoder<Context = Context>>(decoder: &mut D) -> Result<Self, DecodeError> {\n+        Ok(Self {\n+            file: Decode::decode(decoder)?,\n+            line: Decode::decode(decoder)?,\n+            column: Decode::decode(decoder)?,\n+            name: Decode::decode(decoder)?,\n+        })\n+    }\n+}\n+\n+impl_borrow_decode!(StackFrame<'_>);\n+\n /// The result of performing a source map trace.\n #[derive(Debug)]\n pub enum TraceResult {"
        },
        {
            "sha": "82b096068288f367b6edfd9b9d8ecacfa5f39f7a",
            "filename": "turbopack/crates/turbopack-node/src/transforms/postcss.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 8,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Ftransforms%2Fpostcss.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Ftransforms%2Fpostcss.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Ftransforms%2Fpostcss.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::{Context, Result, bail};\n+use bincode::{Decode, Encode};\n use indoc::formatdoc;\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::{RcStr, rcstr};\n@@ -25,18 +26,19 @@ use turbopack_core::{\n };\n use turbopack_ecmascript::runtime_functions::TURBOPACK_EXTERNAL_IMPORT;\n \n-use super::{\n-    util::{EmittedAsset, emitted_assets_to_virtual_sources},\n-    webpack::WebpackLoaderContext,\n-};\n use crate::{\n-    embed_js::embed_file_path, evaluate::get_evaluate_entries, execution_context::ExecutionContext,\n-    transforms::webpack::evaluate_webpack_loader,\n+    embed_js::embed_file_path,\n+    evaluate::get_evaluate_entries,\n+    execution_context::ExecutionContext,\n+    transforms::{\n+        util::{EmittedAsset, emitted_assets_to_virtual_sources},\n+        webpack::{WebpackLoaderContext, evaluate_webpack_loader},\n+    },\n };\n \n-#[derive(Debug, Serialize, Deserialize, Clone)]\n+#[derive(Debug, Clone)]\n+#[turbo_tasks::value]\n #[serde(rename_all = \"camelCase\")]\n-#[turbo_tasks::value(serialization = \"custom\")]\n struct PostCssProcessingResult {\n     css: String,\n     map: Option<String>,\n@@ -56,6 +58,8 @@ struct PostCssProcessingResult {\n     Deserialize,\n     TaskInput,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum PostCssConfigLocation {\n     #[default]"
        },
        {
            "sha": "c6e555a8789c1ac2e308d6e5d4fa17089701b5ca",
            "filename": "turbopack/crates/turbopack-node/src/transforms/util.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Ftransforms%2Futil.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Ftransforms%2Futil.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Ftransforms%2Futil.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,6 +1,7 @@\n use std::collections::BTreeMap;\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use serde_json::Value as JsonValue;\n use turbo_rcstr::RcStr;\n@@ -10,11 +11,14 @@ use turbopack_core::{\n     asset::AssetContent, server_fs::ServerFileSystem, virtual_source::VirtualSource,\n };\n \n-#[derive(Debug, PartialEq, Eq, Serialize, Deserialize, Clone, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Debug, PartialEq, Eq, Serialize, Deserialize, Clone, TraceRawVcs, NonLocalValue, Encode, Decode,\n+)]\n #[serde(rename_all = \"camelCase\")]\n pub struct EmittedAsset {\n     file: RcStr,\n     content: RcStr,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     source_map: Option<JsonValue>,\n }\n "
        },
        {
            "sha": "d1576e0fd8160c8e072f647d4dfb591fd438cccf",
            "filename": "turbopack/crates/turbopack-node/src/transforms/webpack.rs",
            "status": "modified",
            "additions": 21,
            "deletions": 7,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Ftransforms%2Fwebpack.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Ftransforms%2Fwebpack.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Ftransforms%2Fwebpack.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -2,6 +2,7 @@ use std::mem::take;\n \n use anyhow::{Context, Result, bail};\n use base64::Engine;\n+use bincode::{Decode, Encode};\n use either::Either;\n use futures::try_join;\n use serde::{Deserialize, Serialize};\n@@ -47,7 +48,6 @@ use turbopack_resolve::{\n     resolve_options_context::ResolveOptionsContext,\n };\n \n-use super::util::{EmittedAsset, emitted_assets_to_virtual_sources};\n use crate::{\n     AssetsForSourceMapping,\n     debug::should_debug,\n@@ -59,20 +59,22 @@ use crate::{\n     execution_context::ExecutionContext,\n     pool::{FormattingMode, NodeJsPool},\n     source_map::{StackFrame, StructuredError},\n+    transforms::util::{EmittedAsset, emitted_assets_to_virtual_sources},\n };\n \n #[serde_as]\n-#[derive(Clone, Debug, PartialEq, Eq, PartialOrd, Ord, Serialize, Deserialize)]\n+#[derive(Clone, Debug, PartialEq, Eq, PartialOrd, Ord, Serialize, Deserialize, Encode, Decode)]\n struct BytesBase64 {\n     #[serde_as(as = \"serde_with::base64::Base64\")]\n     binary: Vec<u8>,\n }\n \n-#[derive(Debug, Serialize, Deserialize, Clone)]\n+#[derive(Debug, Clone)]\n+#[turbo_tasks::value]\n #[serde(rename_all = \"camelCase\")]\n-#[turbo_tasks::value(serialization = \"custom\")]\n struct WebpackLoadersProcessingResult {\n     #[serde(with = \"either::serde_untagged\")]\n+    #[bincode(with = \"turbo_bincode::either\")]\n     #[turbo_tasks(debug_ignore, trace_ignore)]\n     source: Either<RcStr, BytesBase64>,\n     map: Option<RcStr>,\n@@ -81,11 +83,22 @@ struct WebpackLoadersProcessingResult {\n }\n \n #[derive(\n-    Clone, PartialEq, Eq, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue, OperationValue,\n+    Clone,\n+    PartialEq,\n+    Eq,\n+    Debug,\n+    TraceRawVcs,\n+    Serialize,\n+    Deserialize,\n+    NonLocalValue,\n+    OperationValue,\n+    Encode,\n+    Decode,\n )]\n pub struct WebpackLoaderItem {\n     pub loader: RcStr,\n     #[serde(default)]\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     pub options: serde_json::Map<String, serde_json::Value>,\n }\n \n@@ -327,7 +340,7 @@ pub(crate) async fn evaluate_webpack_loader(\n     custom_evaluate(webpack_loader_context).await\n }\n \n-#[derive(Serialize, Deserialize, Debug, PartialEq, Eq)]\n+#[derive(Serialize, Deserialize, Debug, PartialEq, Eq, Encode, Decode)]\n #[serde(rename_all = \"camelCase\")]\n enum LogType {\n     Error,\n@@ -346,11 +359,12 @@ enum LogType {\n     Status,\n }\n \n-#[derive(Serialize, Deserialize, Debug, PartialEq, Eq)]\n+#[derive(Serialize, Deserialize, Debug, PartialEq, Eq, Encode, Decode)]\n #[serde(rename_all = \"camelCase\")]\n pub struct LogInfo {\n     time: u64,\n     log_type: LogType,\n+    #[bincode(with = \"turbo_bincode::serde_json\")]\n     args: Vec<JsonValue>,\n     trace: Option<Vec<StackFrame<'static>>>,\n }"
        },
        {
            "sha": "d9fce0535a52453772339f47de321df3316a450a",
            "filename": "turbopack/crates/turbopack-nodejs/Cargo.toml",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-nodejs%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-nodejs%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-nodejs%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -20,10 +20,12 @@ workspace = true\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n indoc = { workspace = true }\n tracing = { workspace = true }\n urlencoding = { workspace = true }\n \n+turbo-bincode = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-fs = { workspace = true }"
        },
        {
            "sha": "c0195eceaf9c34c3f25d05442c1cea10867a3f2b",
            "filename": "turbopack/crates/turbopack-nodejs/src/chunking_context.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fchunking_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fchunking_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fchunking_context.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -165,16 +165,19 @@ pub struct NodeJsChunkingContext {\n     /// This path is used to compute the url to request chunks or assets from\n     client_root: FileSystemPath,\n     /// This path is used to compute the url to request chunks or assets from\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     client_roots: FxIndexMap<RcStr, FileSystemPath>,\n     /// Chunks are placed at this path\n     chunk_root_path: FileSystemPath,\n     /// Static assets are placed at this path\n     asset_root_path: FileSystemPath,\n     /// Static assets are placed at this path\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     asset_root_paths: FxIndexMap<RcStr, FileSystemPath>,\n     /// Static assets requested from this url base\n     asset_prefix: Option<RcStr>,\n     /// Static assets requested from this url base\n+    #[bincode(with = \"turbo_bincode::indexmap\")]\n     asset_prefixes: FxIndexMap<RcStr, RcStr>,\n     /// The environment chunks will be evaluated in.\n     environment: ResolvedVc<Environment>,"
        },
        {
            "sha": "7d5ff3ec60d6f212a9317d93579f5db298f92887",
            "filename": "turbopack/crates/turbopack-test-utils/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-test-utils%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-test-utils%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-test-utils%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -14,6 +14,7 @@ workspace = true\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n once_cell = { workspace = true }\n regex = { workspace = true, features = [\"pattern\"] }\n serde = { workspace = true }"
        },
        {
            "sha": "aa78b8c70027f0e7179ad5991e1eef16c5f52936",
            "filename": "turbopack/crates/turbopack-test-utils/src/jest.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-test-utils%2Fsrc%2Fjest.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-test-utils%2Fsrc%2Fjest.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-test-utils%2Fsrc%2Fjest.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,17 +1,18 @@\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n \n // Defines common structures returned by jest/jest-circus. Shared across turbo\n // and next.js repos.\n \n /// The serialized form of the JS object returned from jest.run()\n /// describing results.\n-#[derive(Clone, Debug, Serialize, Deserialize, Eq, PartialEq)]\n+#[derive(Clone, Debug, Serialize, Deserialize, Eq, PartialEq, Encode, Decode)]\n #[serde(rename_all = \"camelCase\")]\n pub struct JestRunResult {\n     pub test_results: Vec<JestTestResult>,\n }\n \n-#[derive(Clone, Debug, Serialize, Deserialize, Eq, PartialEq)]\n+#[derive(Clone, Debug, Serialize, Deserialize, Eq, PartialEq, Encode, Decode)]\n #[serde(rename_all = \"camelCase\")]\n pub struct JestTestResult {\n     pub test_path: Vec<String>,"
        },
        {
            "sha": "f7f3c66292d2021b2765cbce9e719c4700fa6405",
            "filename": "turbopack/crates/turbopack-tests/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-tests%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-tests%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -17,6 +17,7 @@ turbopack = { workspace = true }\n \n [dev-dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n dunce = { workspace = true }\n once_cell = { workspace = true }\n rustc-hash = { workspace = true }"
        },
        {
            "sha": "a2c3f458188e5cd94a1541f8dd4b28e1461d8313",
            "filename": "turbopack/crates/turbopack-tests/tests/execution.rs",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -8,6 +8,7 @@ mod util;\n use std::{env, path::PathBuf};\n \n use anyhow::{Context, Result};\n+use bincode::{Decode, Encode};\n use dunce::canonicalize;\n use serde::{Deserialize, Serialize};\n use tracing_subscriber::{Registry, layer::SubscriberExt, util::SubscriberInitExt};\n@@ -233,7 +234,16 @@ async fn run_inner_operation(\n }\n \n #[derive(\n-    PartialEq, Eq, Debug, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue,\n+    PartialEq,\n+    Eq,\n+    Debug,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    ValueDebugFormat,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n #[serde(rename_all = \"camelCase\", deny_unknown_fields)]\n struct TestOptions {"
        },
        {
            "sha": "5156042b7689a83d2f17d064d778a416620d7ad2",
            "filename": "turbopack/crates/turbopack-wasm/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-wasm%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-wasm%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-wasm%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -14,6 +14,7 @@ workspace = true\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n indoc = { workspace = true }\n serde = { workspace = true }\n turbo-rcstr = { workspace = true }"
        },
        {
            "sha": "85507454a3b54aead8fa4a0f063eec4c98597d34",
            "filename": "turbopack/crates/turbopack-wasm/src/source.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Fsource.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Fsource.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Fsource.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, ResolvedVc, TaskInput, Vc, trace::TraceRawVcs};\n use turbo_tasks_fs::{File, FileContent};\n@@ -22,6 +23,8 @@ use turbopack_core::{\n     TaskInput,\n     TraceRawVcs,\n     NonLocalValue,\n+    Encode,\n+    Decode,\n )]\n pub enum WebAssemblySourceType {\n     /// Binary WebAssembly files (.wasm)."
        },
        {
            "sha": "a806180a409f791350ee2402483814e0fcb34396",
            "filename": "turbopack/crates/turbopack/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2FCargo.toml?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -14,6 +14,7 @@ workspace = true\n \n [dependencies]\n anyhow = { workspace = true }\n+bincode = { workspace = true }\n either = { workspace = true }\n regex = { workspace = true }\n rustc-hash = { workspace = true }"
        },
        {
            "sha": "861e2505e49a5f24b687ca59e7d3ed6c3e4827f1",
            "filename": "turbopack/crates/turbopack/src/module_options/match_mode.rs",
            "status": "modified",
            "additions": 14,
            "deletions": 1,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fmatch_mode.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fmatch_mode.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fmatch_mode.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,8 +1,21 @@\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, trace::TraceRawVcs};\n use turbopack_core::reference_type::ReferenceType;\n \n-#[derive(Copy, Clone, Debug, PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n+#[derive(\n+    Copy,\n+    Clone,\n+    Debug,\n+    PartialEq,\n+    Eq,\n+    Serialize,\n+    Deserialize,\n+    TraceRawVcs,\n+    NonLocalValue,\n+    Encode,\n+    Decode,\n+)]\n pub enum MatchMode {\n     // Match all but internal references.\n     NonInternal,"
        },
        {
            "sha": "4e0385628793cbc7fbb3ed7f512e14d308ed8bd5",
            "filename": "turbopack/crates/turbopack/src/module_options/module_options_context.rs",
            "status": "modified",
            "additions": 10,
            "deletions": 3,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fmodule_options_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fmodule_options_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fmodule_options_context.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,5 +1,6 @@\n use std::fmt::Debug;\n \n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_esregex::EsRegex;\n use turbo_rcstr::RcStr;\n@@ -21,7 +22,9 @@ use turbopack_node::{\n use super::ModuleRule;\n use crate::module_options::RuleCondition;\n \n-#[derive(Clone, PartialEq, Eq, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    Clone, PartialEq, Eq, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue, Encode, Decode,\n+)]\n pub struct LoaderRuleItem {\n     pub loaders: ResolvedVc<WebpackLoaderItems>,\n     pub rename_as: Option<RcStr>,\n@@ -37,7 +40,9 @@ pub struct LoaderRuleItem {\n #[turbo_tasks::value(transparent)]\n pub struct WebpackRules(Vec<(RcStr, LoaderRuleItem)>);\n \n-#[derive(Clone, PartialEq, Eq, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    Clone, PartialEq, Eq, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue, Encode, Decode,\n+)]\n pub enum ConditionPath {\n     Glob(RcStr),\n     Regex(ResolvedVc<EsRegex>),\n@@ -104,7 +109,9 @@ impl WebpackLoaderBuiltinConditionSet for EmptyWebpackLoaderBuiltinConditionSet\n \n /// The kind of decorators transform to use.\n /// [TODO]: might need bikeshed for the name (Ecma)\n-#[derive(Clone, PartialEq, Eq, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue)]\n+#[derive(\n+    Clone, PartialEq, Eq, Debug, TraceRawVcs, Serialize, Deserialize, NonLocalValue, Encode, Decode,\n+)]\n pub enum DecoratorsKind {\n     Legacy,\n     Ecma,"
        },
        {
            "sha": "2711e2dde367c66818e9485c12ede8f10df8eb33",
            "filename": "turbopack/crates/turbopack/src/module_options/module_rule.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fmodule_rule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fmodule_rule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fmodule_rule.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,4 +1,5 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{NonLocalValue, ResolvedVc, trace::TraceRawVcs};\n@@ -13,7 +14,9 @@ use turbopack_wasm::source::WebAssemblySourceType;\n \n use super::{CustomModuleType, RuleCondition, match_mode::MatchMode};\n \n-#[derive(Debug, Clone, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue)]\n+#[derive(\n+    Debug, Clone, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue, Encode, Decode,\n+)]\n pub struct ModuleRule {\n     condition: RuleCondition,\n     effects: Vec<ModuleRuleEffect>,"
        },
        {
            "sha": "51471faa444f8dac0009085f98017d51da9d9107",
            "filename": "turbopack/crates/turbopack/src/module_options/rule_condition.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Frule_condition.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Frule_condition.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Frule_condition.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -4,6 +4,7 @@ use std::{\n };\n \n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use either::Either;\n use serde::{Deserialize, Serialize};\n use smallvec::SmallVec;\n@@ -14,7 +15,9 @@ use turbopack_core::{\n     asset::Asset, reference_type::ReferenceType, source::Source, virtual_source::VirtualSource,\n };\n \n-#[derive(Debug, Clone, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue)]\n+#[derive(\n+    Debug, Clone, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue, Encode, Decode,\n+)]\n pub enum RuleCondition {\n     All(Vec<RuleCondition>),\n     Any(Vec<RuleCondition>),"
        },
        {
            "sha": "0de49e4da394ed5ca8339dc45a577d6e81ddc683",
            "filename": "turbopack/crates/turbopack/src/module_options/transition_rule.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 3,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Ftransition_rule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2931550ebbf8b547304d3bccebcb5606700460fc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Ftransition_rule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Ftransition_rule.rs?ref=2931550ebbf8b547304d3bccebcb5606700460fc",
            "patch": "@@ -1,13 +1,18 @@\n use anyhow::Result;\n+use bincode::{Decode, Encode};\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{NonLocalValue, ResolvedVc, trace::TraceRawVcs};\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::{reference_type::ReferenceType, source::Source};\n \n-use super::{RuleCondition, match_mode::MatchMode};\n-use crate::transition::Transition;\n+use crate::{\n+    module_options::{RuleCondition, match_mode::MatchMode},\n+    transition::Transition,\n+};\n \n-#[derive(Debug, Clone, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue)]\n+#[derive(\n+    Debug, Clone, Serialize, Deserialize, TraceRawVcs, PartialEq, Eq, NonLocalValue, Encode, Decode,\n+)]\n pub struct TransitionRule {\n     condition: RuleCondition,\n     transition: ResolvedVc<Box<dyn Transition>>,"
        }
    ],
    "stats": {
        "total": 3112,
        "additions": 2636,
        "deletions": 476
    }
}