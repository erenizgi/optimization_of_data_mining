{
    "author": "ztanner",
    "message": "fully remove clientSegmentCache flag (#85541)\n\nTurning this flag off would have already caused client-side invariants\nbecause we deleted all the old codepaths. This fully removes the\nremaining plumbing that supported the flag.",
    "sha": "2f052b16f64ccf68d749b8ca8b07325d338db3a4",
    "files": [
        {
            "sha": "06c09e6a473780718e00a3380044715f08c56923",
            "filename": "docs/01-app/02-guides/prefetching.mdx",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/docs%2F01-app%2F02-guides%2Fprefetching.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/docs%2F01-app%2F02-guides%2Fprefetching.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fprefetching.mdx?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -188,8 +188,6 @@ For example, you may still want to have consistent usage of `<Link>` in your app\n \n ## Prefetching optimizations\n \n-> **Good to know:** Layout deduplication and prefetch scheduling are part of upcoming optimizations. Currently available in Next.js canary via the `experimental.clientSegmentCache` flag.\n-\n ### Client cache\n \n Next.js stores prefetched React Server Component payloads in memory, keyed by route segments. When navigating between sibling routes (e.g. `/dashboard/settings` â†’ `/dashboard/analytics`), it reuses the parent layout and only fetches the updated leaf page. This reduces network traffic and improves navigation speed."
        },
        {
            "sha": "8ef0f033634fa8ceff0870e1577588cec074046b",
            "filename": "packages/next/errors.json",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Ferrors.json",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Ferrors.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ferrors.json?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -902,5 +902,6 @@\n   \"901\": \"Invalid \\\"cacheHandlers\\\" provided, expected an object e.g. { default: '/my-handler.js' }, received %s\",\n   \"902\": \"Invalid handler fields configured for \\\"cacheHandlers\\\":\\\\n%s\",\n   \"903\": \"The file \\\"%s\\\" must export a function, either as a default export or as a named \\\"%s\\\" export.\\\\nThis function is what Next.js runs for every request handled by this %s.\\\\n\\\\nWhy this happens:\\\\n%s- The file exists but doesn't export a function.\\\\n- The export is not a function (e.g., an object or constant).\\\\n- There's a syntax error preventing the export from being recognized.\\\\n\\\\nTo fix it:\\\\n- Ensure this file has either a default or \\\"%s\\\" function export.\\\\n\\\\nLearn more: https://nextjs.org/docs/messages/middleware-to-proxy\",\n-  \"904\": \"The file \\\"%s\\\" must export a function, either as a default export or as a named \\\"%s\\\" export.\"\n+  \"904\": \"The file \\\"%s\\\" must export a function, either as a default export or as a named \\\"%s\\\" export.\",\n+  \"905\": \"Page \\\"%s\\\" cannot use \\\\`export const unstable_prefetch = ...\\\\` without enabling \\\\`cacheComponents\\\\`.\"\n }"
        },
        {
            "sha": "ecd2987ed379387c7edbb5dc2ebcc7eb95a7cce8",
            "filename": "packages/next/src/build/adapter/build-complete.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 6,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Fadapter%2Fbuild-complete.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Fadapter%2Fbuild-complete.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fadapter%2Fbuild-complete.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -1514,12 +1514,7 @@ export async function handleBuildComplete({\n           route.page\n         ) + getDestinationQuery(route.routeKeys)\n \n-      if (\n-        appPageKeys &&\n-        appPageKeys.length > 0 &&\n-        (config.experimental.cacheComponents ||\n-          config.experimental.clientSegmentCache)\n-      ) {\n+      if (appPageKeys && appPageKeys.length > 0 && config.cacheComponents) {\n         // If we have fallback root params (implying we've already\n         // emitted a rewrite for the /_tree request), or if the route\n         // has PPR enabled and client param parsing is enabled, then"
        },
        {
            "sha": "afafdda505cf34418882dd89991582b189cadb9f",
            "filename": "packages/next/src/build/analysis/get-page-static-info.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 7,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Fanalysis%2Fget-page-static-info.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Fanalysis%2Fget-page-static-info.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fanalysis%2Fget-page-static-info.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -681,14 +681,9 @@ export async function getAppPageStaticInfo({\n     )\n   }\n \n-  if (\n-    'unstable_prefetch' in config &&\n-    (!nextConfig.cacheComponents ||\n-      // don't allow in `clientSegmentCache: 'client-only'` mode\n-      nextConfig.experimental?.clientSegmentCache !== true)\n-  ) {\n+  if ('unstable_prefetch' in config && !nextConfig.cacheComponents) {\n     throw new Error(\n-      `Page \"${page}\" cannot use \\`export const unstable_prefetch = ...\\` without enabling \\`cacheComponents\\` and \\`experimental.clientSegmentCache\\`.`\n+      `Page \"${page}\" cannot use \\`export const unstable_prefetch = ...\\` without enabling \\`cacheComponents\\`.`\n     )\n   }\n "
        },
        {
            "sha": "b80abe664eddb69babb232c82071a2bf5c5bf5f5",
            "filename": "packages/next/src/build/define-env.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -198,9 +198,6 @@ export function getDefineEnv({\n       clientRouterFilters?.staticFilter ?? false,\n     'process.env.__NEXT_CLIENT_ROUTER_D_FILTER':\n       clientRouterFilters?.dynamicFilter ?? false,\n-    'process.env.__NEXT_CLIENT_SEGMENT_CACHE': Boolean(\n-      config.experimental.clientSegmentCache\n-    ),\n     'process.env.__NEXT_CLIENT_VALIDATE_RSC_REQUEST_HEADERS': Boolean(\n       config.experimental.validateRSCRequestHeaders\n     ),"
        },
        {
            "sha": "0906b1a951fb2a1cb45f1cf9c41d85d05a5ff2aa",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 14,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3000,10 +3000,7 @@ export default async function build(\n                     // following enabled. This is because the flight data now\n                     // does not contain any of the route params and is instead\n                     // completely static.\n-                    !(\n-                      config.experimental.clientSegmentCache &&\n-                      config.cacheComponents\n-                    )\n+                    !config.cacheComponents\n                   ) {\n                     return\n                   }\n@@ -3311,16 +3308,12 @@ export default async function build(\n                 if (\n                   !isAppRouteHandler &&\n                   isAppPPREnabled &&\n-                  // Don't add a prefetch data route if we have both\n-                  // clientSegmentCache and clientParamParsing enabled. This is\n+                  // Don't add a prefetch data route if we have\n+                  // cacheComponents enabled. This is\n                   // because we don't actually use the prefetch data route in\n                   // this case. This only applies if we have PPR enabled for\n                   // this route.\n-                  !(\n-                    config.experimental.clientSegmentCache &&\n-                    config.cacheComponents &&\n-                    isRoutePPREnabled\n-                  )\n+                  !(config.cacheComponents && isRoutePPREnabled)\n                 ) {\n                   prefetchDataRoute = path.posix.join(\n                     `${normalizedRoute}${RSC_PREFETCH_SUFFIX}`\n@@ -3422,12 +3415,11 @@ export default async function build(\n                 )\n                 if (!isAppRouteHandler && isAppPPREnabled) {\n                   if (\n-                    // Don't add a prefetch data route if we have both\n-                    // clientSegmentCache and clientParamParsing enabled. This is\n+                    // Don't add a prefetch data route if we have\n+                    // cacheComponents enabled. This is\n                     // because we don't actually use the prefetch data route in\n                     // this case. This only applies if we have PPR enabled for\n                     // this route.\n-                    !config.experimental.clientSegmentCache ||\n                     !config.cacheComponents ||\n                     !isRoutePPREnabled\n                   ) {"
        },
        {
            "sha": "8de3401d607c3b8874ad468fa7dd632786cbb787",
            "filename": "packages/next/src/build/segment-config/app/app-segment-config.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Fsegment-config%2Fapp%2Fapp-segment-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Fsegment-config%2Fapp%2Fapp-segment-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fsegment-config%2Fapp%2Fapp-segment-config.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -126,7 +126,6 @@ const AppSegmentConfigSchema = z.object({\n \n   /**\n    * How this segment should be prefetched.\n-   * (only applicable when `clientSegmentCache` is enabled)\n    */\n   unstable_prefetch: PrefetchSchema.optional(),\n \n@@ -224,7 +223,6 @@ export type AppSegmentConfig = {\n \n   /**\n    * How this segment should be prefetched.\n-   * (only applicable when `clientSegmentCache` is enabled)\n    */\n   unstable_prefetch?: Prefetch\n "
        },
        {
            "sha": "6c7b36eaf6fe06e227fcf3df1222b36473762680",
            "filename": "packages/next/src/build/templates/app-page.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -563,9 +563,6 @@ export async function handler(\n             isRoutePPREnabled,\n             expireTime: nextConfig.expireTime,\n             staleTimes: nextConfig.experimental.staleTimes,\n-            clientSegmentCache: Boolean(\n-              nextConfig.experimental.clientSegmentCache\n-            ),\n             dynamicOnHover: Boolean(nextConfig.experimental.dynamicOnHover),\n             inlineCss: Boolean(nextConfig.experimental.inlineCss),\n             authInterrupts: Boolean(nextConfig.experimental.authInterrupts),"
        },
        {
            "sha": "91de090ee745a0465bdf9c23fc3ca7ef458f939e",
            "filename": "packages/next/src/build/templates/edge-ssr-app.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fedge-ssr-app.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -158,7 +158,6 @@ async function requestHandler(\n         isRoutePPREnabled: false,\n         expireTime: nextConfig.expireTime,\n         staleTimes: nextConfig.experimental.staleTimes,\n-        clientSegmentCache: Boolean(nextConfig.experimental.clientSegmentCache),\n         dynamicOnHover: Boolean(nextConfig.experimental.dynamicOnHover),\n         inlineCss: Boolean(nextConfig.experimental.inlineCss),\n         authInterrupts: Boolean(nextConfig.experimental.authInterrupts),"
        },
        {
            "sha": "a20a2e6261ebbc7a0e5c0308d5ab0934810e870a",
            "filename": "packages/next/src/client/app-dir/link.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 8,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fclient%2Fapp-dir%2Flink.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fclient%2Fapp-dir%2Flink.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fapp-dir%2Flink.tsx?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -746,10 +746,7 @@ export const useLinkStatus = () => {\n function getFetchStrategyFromPrefetchProp(\n   prefetchProp: Exclude<LinkProps['prefetch'], undefined | false>\n ): PrefetchTaskFetchStrategy {\n-  if (\n-    process.env.__NEXT_CACHE_COMPONENTS &&\n-    process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-  ) {\n+  if (process.env.__NEXT_CACHE_COMPONENTS) {\n     if (prefetchProp === true) {\n       return FetchStrategy.Full\n     }\n@@ -758,13 +755,10 @@ function getFetchStrategyFromPrefetchProp(\n     // This will also include invalid prop values that don't match the types specified here.\n     // (although those should've been filtered out by prop validation in dev)\n     prefetchProp satisfies null | 'auto'\n-    // In `clientSegmentCache`, we default to PPR, and we'll discover whether or not the route supports it with the initial prefetch.\n-    // If we're not using `clientSegmentCache`, this will be converted into a `PrefetchKind.AUTO`.\n     return FetchStrategy.PPR\n   } else {\n     return prefetchProp === null || prefetchProp === 'auto'\n-      ? // In `clientSegmentCache`, we default to PPR, and we'll discover whether or not the route supports it with the initial prefetch.\n-        // If we're not using `clientSegmentCache`, this will be converted into a `PrefetchKind.AUTO`.\n+      ? // We default to PPR, and we'll discover whether or not the route supports it with the initial prefetch.\n         FetchStrategy.PPR\n       : // In the old implementation without runtime prefetches, `prefetch={true}` forces all dynamic data to be prefetched.\n         // To preserve backwards-compatibility, anything other than `false`, `null`, or `\"auto\"` results in a full prefetch."
        },
        {
            "sha": "d46fb0c621ae8e1c965c8e6e95dcb6b564851d4c",
            "filename": "packages/next/src/client/components/app-router.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fapp-router.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fapp-router.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fapp-router.tsx?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -97,9 +97,7 @@ function HistoryUpdater({\n     // task. Re-prefetch all visible links with the updated values. In most\n     // cases, this will not result in any new network requests, only if\n     // the prefetch result actually varies on one of these inputs.\n-    if (process.env.__NEXT_CLIENT_SEGMENT_CACHE) {\n-      pingVisibleLinks(appRouterState.nextUrl, appRouterState.tree)\n-    }\n+    pingVisibleLinks(appRouterState.nextUrl, appRouterState.tree)\n   }, [appRouterState.nextUrl, appRouterState.tree])\n \n   return null"
        },
        {
            "sha": "4d281baa8da464882a3a081fd7ddf53e006f07f0",
            "filename": "packages/next/src/client/components/links.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 60,
            "changes": 60,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Flinks.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Flinks.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Flinks.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -14,8 +14,6 @@ import {\n   reschedulePrefetchTask,\n } from './segment-cache'\n import { startTransition } from 'react'\n-import { PrefetchKind } from './router-reducer/router-reducer-types'\n-import { InvariantError } from '../../shared/lib/invariant-error'\n \n type LinkElement = HTMLAnchorElement | SVGAElement\n \n@@ -298,13 +296,6 @@ function rescheduleLinkPrefetch(\n       return\n     }\n \n-    if (!process.env.__NEXT_CLIENT_SEGMENT_CACHE) {\n-      // The old prefetch implementation does not have different priority levels.\n-      // Just schedule a new prefetch task.\n-      prefetchWithOldCacheImplementation(instance)\n-      return\n-    }\n-\n     const { getCurrentAppRouterState } =\n       require('./app-router-instance') as typeof import('./app-router-instance')\n \n@@ -369,54 +360,3 @@ export function pingVisibleLinks(\n     )\n   }\n }\n-\n-function prefetchWithOldCacheImplementation(instance: PrefetchableInstance) {\n-  // This is the path used when the Segment Cache is not enabled.\n-  if (typeof window === 'undefined') {\n-    return\n-  }\n-\n-  const doPrefetch = async () => {\n-    // note that `appRouter.prefetch()` is currently sync,\n-    // so we have to wrap this call in an async function to be able to catch() errors below.\n-\n-    let prefetchKind: PrefetchKind\n-    switch (instance.fetchStrategy) {\n-      case FetchStrategy.PPR: {\n-        prefetchKind = PrefetchKind.AUTO\n-        break\n-      }\n-      case FetchStrategy.Full: {\n-        prefetchKind = PrefetchKind.FULL\n-        break\n-      }\n-      case FetchStrategy.PPRRuntime: {\n-        // We can only get here if Client Segment Cache is off, and in that case\n-        // it shouldn't be possible for a link to request a runtime prefetch.\n-        throw new InvariantError(\n-          'FetchStrategy.PPRRuntime should never be used when `experimental.clientSegmentCache` is disabled'\n-        )\n-      }\n-      default: {\n-        instance.fetchStrategy satisfies never\n-        // Unreachable, but otherwise typescript will consider the variable unassigned\n-        prefetchKind = undefined!\n-      }\n-    }\n-\n-    return instance.router.prefetch(instance.prefetchHref, {\n-      kind: prefetchKind,\n-    })\n-  }\n-\n-  // Prefetch the page if asked (only in the client)\n-  // We need to handle a prefetch error here since we may be\n-  // loading with priority which can reject but we don't\n-  // want to force navigation since this is only a prefetch\n-  doPrefetch().catch((err) => {\n-    if (process.env.NODE_ENV !== 'production') {\n-      // rethrow to show invalid URL errors\n-      throw err\n-    }\n-  })\n-}"
        },
        {
            "sha": "0047b69f5123bbe009cdcb4a3eb143dfb2a944cd",
            "filename": "packages/next/src/client/components/segment-cache.ts",
            "status": "modified",
            "additions": 45,
            "deletions": 69,
            "changes": 114,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fsegment-cache.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fsegment-cache.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fsegment-cache.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -24,92 +24,68 @@ export type {\n   NormalizedSearch,\n } from './segment-cache-impl/cache-key'\n \n-const notEnabled: any = () => {\n-  throw new Error(\n-    'Segment Cache experiment is not enabled. This is a bug in Next.js.'\n-  )\n-}\n-\n export const prefetch: typeof import('./segment-cache-impl/prefetch').prefetch =\n-  process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-    ? function (...args) {\n-        return (\n-          require('./segment-cache-impl/prefetch') as typeof import('./segment-cache-impl/prefetch')\n-        ).prefetch(...args)\n-      }\n-    : notEnabled\n+  function (...args) {\n+    return (\n+      require('./segment-cache-impl/prefetch') as typeof import('./segment-cache-impl/prefetch')\n+    ).prefetch(...args)\n+  }\n \n export const navigate: typeof import('./segment-cache-impl/navigation').navigate =\n-  process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-    ? function (...args) {\n-        return (\n-          require('./segment-cache-impl/navigation') as typeof import('./segment-cache-impl/navigation')\n-        ).navigate(...args)\n-      }\n-    : notEnabled\n+  function (...args) {\n+    return (\n+      require('./segment-cache-impl/navigation') as typeof import('./segment-cache-impl/navigation')\n+    ).navigate(...args)\n+  }\n \n export const revalidateEntireCache: typeof import('./segment-cache-impl/cache').revalidateEntireCache =\n-  process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-    ? function (...args) {\n-        return (\n-          require('./segment-cache-impl/cache') as typeof import('./segment-cache-impl/cache')\n-        ).revalidateEntireCache(...args)\n-      }\n-    : notEnabled\n+  function (...args) {\n+    return (\n+      require('./segment-cache-impl/cache') as typeof import('./segment-cache-impl/cache')\n+    ).revalidateEntireCache(...args)\n+  }\n \n export const getCurrentCacheVersion: typeof import('./segment-cache-impl/cache').getCurrentCacheVersion =\n-  process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-    ? function (...args) {\n-        return (\n-          require('./segment-cache-impl/cache') as typeof import('./segment-cache-impl/cache')\n-        ).getCurrentCacheVersion(...args)\n-      }\n-    : notEnabled\n+  function (...args) {\n+    return (\n+      require('./segment-cache-impl/cache') as typeof import('./segment-cache-impl/cache')\n+    ).getCurrentCacheVersion(...args)\n+  }\n \n export const schedulePrefetchTask: typeof import('./segment-cache-impl/scheduler').schedulePrefetchTask =\n-  process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-    ? function (...args) {\n-        return (\n-          require('./segment-cache-impl/scheduler') as typeof import('./segment-cache-impl/scheduler')\n-        ).schedulePrefetchTask(...args)\n-      }\n-    : notEnabled\n+  function (...args) {\n+    return (\n+      require('./segment-cache-impl/scheduler') as typeof import('./segment-cache-impl/scheduler')\n+    ).schedulePrefetchTask(...args)\n+  }\n \n export const cancelPrefetchTask: typeof import('./segment-cache-impl/scheduler').cancelPrefetchTask =\n-  process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-    ? function (...args) {\n-        return (\n-          require('./segment-cache-impl/scheduler') as typeof import('./segment-cache-impl/scheduler')\n-        ).cancelPrefetchTask(...args)\n-      }\n-    : notEnabled\n+  function (...args) {\n+    return (\n+      require('./segment-cache-impl/scheduler') as typeof import('./segment-cache-impl/scheduler')\n+    ).cancelPrefetchTask(...args)\n+  }\n \n export const reschedulePrefetchTask: typeof import('./segment-cache-impl/scheduler').reschedulePrefetchTask =\n-  process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-    ? function (...args) {\n-        return (\n-          require('./segment-cache-impl/scheduler') as typeof import('./segment-cache-impl/scheduler')\n-        ).reschedulePrefetchTask(...args)\n-      }\n-    : notEnabled\n+  function (...args) {\n+    return (\n+      require('./segment-cache-impl/scheduler') as typeof import('./segment-cache-impl/scheduler')\n+    ).reschedulePrefetchTask(...args)\n+  }\n \n export const isPrefetchTaskDirty: typeof import('./segment-cache-impl/scheduler').isPrefetchTaskDirty =\n-  process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-    ? function (...args) {\n-        return (\n-          require('./segment-cache-impl/scheduler') as typeof import('./segment-cache-impl/scheduler')\n-        ).isPrefetchTaskDirty(...args)\n-      }\n-    : notEnabled\n+  function (...args) {\n+    return (\n+      require('./segment-cache-impl/scheduler') as typeof import('./segment-cache-impl/scheduler')\n+    ).isPrefetchTaskDirty(...args)\n+  }\n \n export const createCacheKey: typeof import('./segment-cache-impl/cache-key').createCacheKey =\n-  process.env.__NEXT_CLIENT_SEGMENT_CACHE\n-    ? function (...args) {\n-        return (\n-          require('./segment-cache-impl/cache-key') as typeof import('./segment-cache-impl/cache-key')\n-        ).createCacheKey(...args)\n-      }\n-    : notEnabled\n+  function (...args) {\n+    return (\n+      require('./segment-cache-impl/cache-key') as typeof import('./segment-cache-impl/cache-key')\n+    ).createCacheKey(...args)\n+  }\n \n /**\n  * Below are public constants. They're small enough that we don't need to"
        },
        {
            "sha": "d3d7e686c4891f78339fedbbafe1efcf9c539e0d",
            "filename": "packages/next/src/export/index.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -395,10 +395,6 @@ async function exportAppImpl(\n       clientTraceMetadata: nextConfig.experimental.clientTraceMetadata,\n       expireTime: nextConfig.expireTime,\n       staleTimes: nextConfig.experimental.staleTimes,\n-      clientSegmentCache:\n-        nextConfig.experimental.clientSegmentCache === 'client-only'\n-          ? 'client-only'\n-          : Boolean(nextConfig.experimental.clientSegmentCache),\n       clientParamParsingOrigins:\n         nextConfig.experimental.clientParamParsingOrigins,\n       dynamicOnHover: nextConfig.experimental.dynamicOnHover ?? false,"
        },
        {
            "sha": "90dcc034e65c2d16fa5dcb5eb432349cb216cbfb",
            "filename": "packages/next/src/server/app-render/app-render.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 11,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -5381,17 +5381,7 @@ async function collectSegmentData(\n   // decomposed into a separate stream per segment.\n \n   const clientReferenceManifest = renderOpts.clientReferenceManifest\n-  if (\n-    !clientReferenceManifest ||\n-    // Do not generate per-segment data unless the experimental Segment Cache\n-    // flag is enabled.\n-    //\n-    // We also skip generating segment data if flag is set to \"client-only\",\n-    // rather than true. (The \"client-only\" option only affects the behavior of\n-    // the client-side implementation; per-segment prefetches are intentionally\n-    // disabled in that configuration).\n-    renderOpts.experimental.clientSegmentCache !== true\n-  ) {\n+  if (!clientReferenceManifest) {\n     return\n   }\n "
        },
        {
            "sha": "4517c8b960ba9488b08431d51cd9c621ede3256b",
            "filename": "packages/next/src/server/app-render/types.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -137,7 +137,6 @@ export interface RenderOptsPartial {\n     expireTime: number | undefined\n     staleTimes: ExperimentalConfig['staleTimes'] | undefined\n     clientTraceMetadata: string[] | undefined\n-    clientSegmentCache: boolean | 'client-only'\n \n     /**\n      * The origins that are allowed to write the rewritten headers when"
        },
        {
            "sha": "b5c9b746fbb765c1c91cbf76fd06b38d64095c62",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 13,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -421,7 +421,6 @@ export default abstract class Server<\n   }\n \n   private readonly isAppPPREnabled: boolean\n-  private readonly isAppSegmentPrefetchEnabled: boolean\n \n   /**\n    * This is used to persist cache scopes across\n@@ -489,10 +488,6 @@ export default abstract class Server<\n       this.enabledDirectories.app &&\n       checkIsAppPPREnabled(this.nextConfig.experimental.ppr)\n \n-    this.isAppSegmentPrefetchEnabled =\n-      this.enabledDirectories.app &&\n-      this.nextConfig.experimental.clientSegmentCache === true\n-\n     this.normalizers = {\n       // We should normalize the pathname from the RSC prefix only in minimal\n       // mode as otherwise that route is not exposed external to the server as\n@@ -505,10 +500,9 @@ export default abstract class Server<\n         this.isAppPPREnabled && this.minimalMode\n           ? new PrefetchRSCPathnameNormalizer()\n           : undefined,\n-      segmentPrefetchRSC:\n-        this.isAppSegmentPrefetchEnabled && this.minimalMode\n-          ? new SegmentPrefixRSCPathnameNormalizer()\n-          : undefined,\n+      segmentPrefetchRSC: this.minimalMode\n+        ? new SegmentPrefixRSCPathnameNormalizer()\n+        : undefined,\n       data: this.enabledDirectories.pages\n         ? new NextDataPathnameNormalizer(this.buildId)\n         : undefined,\n@@ -550,10 +544,6 @@ export default abstract class Server<\n         expireTime: this.nextConfig.expireTime,\n         staleTimes: this.nextConfig.experimental.staleTimes,\n         clientTraceMetadata: this.nextConfig.experimental.clientTraceMetadata,\n-        clientSegmentCache:\n-          this.nextConfig.experimental.clientSegmentCache === 'client-only'\n-            ? 'client-only'\n-            : Boolean(this.nextConfig.experimental.clientSegmentCache),\n         clientParamParsingOrigins:\n           this.nextConfig.experimental.clientParamParsingOrigins,\n         dynamicOnHover: this.nextConfig.experimental.dynamicOnHover ?? false,"
        },
        {
            "sha": "2315010ca28b6a8f046c01a26352be2218aa8167",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -192,9 +192,6 @@ export const experimentalSchema = {\n   memoryBasedWorkersCount: z.boolean().optional(),\n   craCompat: z.boolean().optional(),\n   caseSensitiveRoutes: z.boolean().optional(),\n-  clientSegmentCache: z\n-    .union([z.boolean(), z.literal('client-only')])\n-    .optional(),\n   clientParamParsingOrigins: z.array(z.string()).optional(),\n   dynamicOnHover: z.boolean().optional(),\n   disableOptimizedLoading: z.boolean().optional(),"
        },
        {
            "sha": "ec5310c6dd57a2133f079e58f438e4a457b99eee",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -279,8 +279,6 @@ export interface ExperimentalConfig {\n   prerenderEarlyExit?: boolean\n   linkNoTouchStart?: boolean\n   caseSensitiveRoutes?: boolean\n-  clientSegmentCache?: boolean | 'client-only'\n-\n   /**\n    * The origins that are allowed to write the rewritten headers when\n    * performing a non-relative rewrite. When undefined, no non-relative\n@@ -1455,7 +1453,6 @@ export const defaultConfig = Object.freeze({\n     serverSourceMaps: false,\n     linkNoTouchStart: false,\n     caseSensitiveRoutes: false,\n-    clientSegmentCache: true,\n     clientParamParsingOrigins: undefined,\n     dynamicOnHover: false,\n     preloadEntriesOnStart: true,"
        },
        {
            "sha": "e64bae22d658030ef118a8b53c925258ae17563f",
            "filename": "test/e2e/app-dir/resuming-head-runtime-search-param/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fresuming-head-runtime-search-param%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fresuming-head-runtime-search-param%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fresuming-head-runtime-search-param%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n }\n \n module.exports = nextConfig"
        },
        {
            "sha": "088ffe3c7a14529a69a02347773e4e454f7e2425",
            "filename": "test/e2e/app-dir/rsc-redirect/rsc-redirect.test.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Frsc-redirect%2Frsc-redirect.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Frsc-redirect%2Frsc-redirect.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frsc-redirect%2Frsc-redirect.test.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -37,18 +37,16 @@ describe('rsc-redirect', () => {\n // TODO: these tests aren't currently run at all during testing\n if (process.env.NODE_ENV === 'production') {\n   describe.each([\n-    { cacheComponents: true, segmentCache: true },\n-    { cacheComponents: true, segmentCache: false },\n-    { cacheComponents: false, segmentCache: true },\n-    { cacheComponents: false, segmentCache: false },\n+    { cacheComponents: true },\n+    { cacheComponents: false },\n   ] as const)(\n-    'rsc-redirect /old-about -> /about (cacheComponents: $cacheComponents, segmentCache: $segmentCache)',\n-    ({ cacheComponents, segmentCache }) => {\n+    'rsc-redirect /old-about -> /about (cacheComponents: $cacheComponents)',\n+    ({ cacheComponents }) => {\n       beforeAll(() => {\n         // Write next.config.js with the current flags\n         fs.writeFileSync(\n           configPath,\n-          `module.exports = { experimental: { cacheComponents: ${cacheComponents}, clientSegmentCache: ${segmentCache} } }\\n`\n+          `module.exports = { experimental: { cacheComponents: ${cacheComponents}} }\\n`\n         )\n       })\n "
        },
        {
            "sha": "eea5b256ec7c0368948a1b27d677dbd932048132",
            "filename": "test/e2e/app-dir/segment-cache/cdn-cache-busting/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fcdn-cache-busting%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fcdn-cache-busting%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fcdn-cache-busting%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   experimental: {\n-    clientSegmentCache: true,\n     validateRSCRequestHeaders: true,\n   },\n }"
        },
        {
            "sha": "18291aa0a1b0afaa7c603adfeb09250f0604adfa",
            "filename": "test/e2e/app-dir/segment-cache/deployment-skew/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdeployment-skew%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -7,10 +7,6 @@ if (!BUILD_ID) {\n  * @type {import('next').NextConfig}\n  */\n const nextConfig = {\n-  experimental: {\n-    clientSegmentCache: true,\n-  },\n-\n   distDir: '.next.' + BUILD_ID,\n \n   async generateBuildId() {"
        },
        {
            "sha": "bc9cad8664e886c77c2091037f47761b0c9dd6d0",
            "filename": "test/e2e/app-dir/segment-cache/dynamic-on-hover/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdynamic-on-hover%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdynamic-on-hover%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fdynamic-on-hover%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -4,7 +4,6 @@\n const nextConfig = {\n   cacheComponents: true,\n   experimental: {\n-    clientSegmentCache: true,\n     dynamicOnHover: true,\n   },\n }"
        },
        {
            "sha": "fecf9218a39dcda3ee2954164a004fefb4469d6e",
            "filename": "test/e2e/app-dir/segment-cache/export/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fexport%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fexport%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fexport%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,9 +3,6 @@\n  */\n const nextConfig = {\n   output: 'export',\n-  experimental: {\n-    clientSegmentCache: true,\n-  },\n }\n \n module.exports = nextConfig"
        },
        {
            "sha": "e64bae22d658030ef118a8b53c925258ae17563f",
            "filename": "test/e2e/app-dir/segment-cache/memory-pressure/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fmemory-pressure%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fmemory-pressure%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fmemory-pressure%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n }\n \n module.exports = nextConfig"
        },
        {
            "sha": "9fbd9a9ddd3b1232d92bb6adc9c3197879934f40",
            "filename": "test/e2e/app-dir/segment-cache/metadata/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fmetadata%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fmetadata%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fmetadata%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n   async rewrites() {\n     return [\n       {"
        },
        {
            "sha": "e64bae22d658030ef118a8b53c925258ae17563f",
            "filename": "test/e2e/app-dir/segment-cache/mpa-navigations/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fmpa-navigations%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fmpa-navigations%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fmpa-navigations%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n }\n \n module.exports = nextConfig"
        },
        {
            "sha": "8e488e3b5f96cae3f08e3616af6cf54ebef0db05",
            "filename": "test/e2e/app-dir/segment-cache/no-prefetch/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fno-prefetch%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fno-prefetch%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fno-prefetch%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -1,7 +1,4 @@\n /** @type {import('next').NextConfig} */\n module.exports = {\n-  experimental: {\n-    clientSegmentCache: true,\n-  },\n   productionBrowserSourceMaps: true,\n }"
        },
        {
            "sha": "01981da4f8221a70cf09c41ad35e5920bb0447b4",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-layout-sharing/next.config.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fnext.config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fnext.config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-layout-sharing%2Fnext.config.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -2,7 +2,6 @@ import type { NextConfig } from 'next'\n \n const nextConfig: NextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n   productionBrowserSourceMaps: true,\n }\n "
        },
        {
            "sha": "01981da4f8221a70cf09c41ad35e5920bb0447b4",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/next.config.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fnext.config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fnext.config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fnext.config.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -2,7 +2,6 @@ import type { NextConfig } from 'next'\n \n const nextConfig: NextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n   productionBrowserSourceMaps: true,\n }\n "
        },
        {
            "sha": "e64bae22d658030ef118a8b53c925258ae17563f",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-scheduling/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-scheduling%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-scheduling%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-scheduling%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n }\n \n module.exports = nextConfig"
        },
        {
            "sha": "e64bae22d658030ef118a8b53c925258ae17563f",
            "filename": "test/e2e/app-dir/segment-cache/revalidation/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Frevalidation%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Frevalidation%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Frevalidation%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n }\n \n module.exports = nextConfig"
        },
        {
            "sha": "e64bae22d658030ef118a8b53c925258ae17563f",
            "filename": "test/e2e/app-dir/segment-cache/search-params/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fsearch-params%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fsearch-params%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fsearch-params%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n }\n \n module.exports = nextConfig"
        },
        {
            "sha": "81e37cfaf4bd1c46bbfc62f1c106921c6117c60a",
            "filename": "test/e2e/app-dir/segment-cache/staleness/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fstaleness%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fstaleness%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fstaleness%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -4,7 +4,6 @@\n const nextConfig = {\n   cacheComponents: true,\n   experimental: {\n-    clientSegmentCache: true,\n     staleTimes: {\n       dynamic: 30,\n     },"
        },
        {
            "sha": "e64bae22d658030ef118a8b53c925258ae17563f",
            "filename": "test/production/app-dir/resume-data-cache/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fproduction%2Fapp-dir%2Fresume-data-cache%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fproduction%2Fapp-dir%2Fresume-data-cache%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fresume-data-cache%2Fnext.config.js?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -3,7 +3,6 @@\n  */\n const nextConfig = {\n   cacheComponents: true,\n-  experimental: { clientSegmentCache: true },\n }\n \n module.exports = nextConfig"
        },
        {
            "sha": "64dc292c7a34e2c20bd26cf2d8dd88309760591a",
            "filename": "test/production/standalone-mode/required-server-files/required-server-files-ppr.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fproduction%2Fstandalone-mode%2Frequired-server-files%2Frequired-server-files-ppr.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2f052b16f64ccf68d749b8ca8b07325d338db3a4/test%2Fproduction%2Fstandalone-mode%2Frequired-server-files%2Frequired-server-files-ppr.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fstandalone-mode%2Frequired-server-files%2Frequired-server-files-ppr.test.ts?ref=2f052b16f64ccf68d749b8ca8b07325d338db3a4",
            "patch": "@@ -55,10 +55,7 @@ describe.skip('required server files app router', () => {\n       },\n       nextConfig: {\n         cacheHandler: './cache-handler.js',\n-        experimental: {\n-          cacheComponents: true,\n-          clientSegmentCache: true,\n-        },\n+        cacheComponents: true,\n         output: 'standalone',\n       },\n     })"
        }
    ],
    "stats": {
        "total": 317,
        "additions": 69,
        "deletions": 248
    }
}