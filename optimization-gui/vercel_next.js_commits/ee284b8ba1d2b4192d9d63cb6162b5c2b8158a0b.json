{
    "author": "lubieowoce",
    "message": "refactor: lowercase app router header values (#82169)\n\nwe define most of the app router headers with capital letters, like\nthis:\n```ts\nexport const NEXT_ROUTER_PREFETCH_HEADER = 'Next-Router-Prefetch' as const\n```\nwhich means we have to keep lowercasing the header everywhere when\nchecking for its presence, because node and other intermediate layers\nnormalize all headers to lowercase:\n```ts\nif (req.headers[NEXT_ROUTER_PREFETCH_HEADER.toLowerCase()]) { ... }\n```\nthis seems pretty pointless -- we can just define the headers in\nlowercase form, and skip all those `toLowerCase()` calls.\n\n(all the above sentences have been normalized to lowercase to match the\nspirit of this pr)",
    "sha": "ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
    "files": [
        {
            "sha": "7ad7e6c9434be82aba8a13939583305d685af32b",
            "filename": "packages/next/src/client/components/app-router-headers.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fapp-router-headers.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fapp-router-headers.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fapp-router-headers.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -1,19 +1,19 @@\n-export const RSC_HEADER = 'RSC' as const\n-export const ACTION_HEADER = 'Next-Action' as const\n+export const RSC_HEADER = 'rsc' as const\n+export const ACTION_HEADER = 'next-action' as const\n // TODO: Instead of sending the full router state, we only need to send the\n // segment path. Saves bytes. Then we could also use this field for segment\n // prefetches, which also need to specify a particular segment.\n-export const NEXT_ROUTER_STATE_TREE_HEADER = 'Next-Router-State-Tree' as const\n-export const NEXT_ROUTER_PREFETCH_HEADER = 'Next-Router-Prefetch' as const\n+export const NEXT_ROUTER_STATE_TREE_HEADER = 'next-router-state-tree' as const\n+export const NEXT_ROUTER_PREFETCH_HEADER = 'next-router-prefetch' as const\n // This contains the path to the segment being prefetched.\n-// TODO: If we change Next-Router-State-Tree to be a segment path, we can use\n-// that instead. Then Next-Router-Prefetch and Next-Router-Segment-Prefetch can\n+// TODO: If we change next-router-state-tree to be a segment path, we can use\n+// that instead. Then next-router-prefetch and next-router-segment-prefetch can\n // be merged into a single enum.\n export const NEXT_ROUTER_SEGMENT_PREFETCH_HEADER =\n-  'Next-Router-Segment-Prefetch' as const\n-export const NEXT_HMR_REFRESH_HEADER = 'Next-HMR-Refresh' as const\n+  'next-router-segment-prefetch' as const\n+export const NEXT_HMR_REFRESH_HEADER = 'next-hmr-refresh' as const\n export const NEXT_HMR_REFRESH_HASH_COOKIE = '__next_hmr_refresh_hash__' as const\n-export const NEXT_URL = 'Next-Url' as const\n+export const NEXT_URL = 'next-url' as const\n export const RSC_CONTENT_TYPE_HEADER = 'text/x-component' as const\n \n export const FLIGHT_HEADERS = ["
        },
        {
            "sha": "49ce866422c52d2f456b568f333776752dd02546",
            "filename": "packages/next/src/server/app-render/app-render.tsx",
            "status": "modified",
            "additions": 6,
            "deletions": 11,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -282,28 +282,23 @@ function parseRequestHeaders(\n \n   // dev warmup requests are treated as prefetch RSC requests\n   const isPrefetchRequest =\n-    isDevWarmupRequest ||\n-    headers[NEXT_ROUTER_PREFETCH_HEADER.toLowerCase()] !== undefined\n+    isDevWarmupRequest || headers[NEXT_ROUTER_PREFETCH_HEADER] !== undefined\n \n-  const isHmrRefresh =\n-    headers[NEXT_HMR_REFRESH_HEADER.toLowerCase()] !== undefined\n+  const isHmrRefresh = headers[NEXT_HMR_REFRESH_HEADER] !== undefined\n \n   // dev warmup requests are treated as prefetch RSC requests\n-  const isRSCRequest =\n-    isDevWarmupRequest || headers[RSC_HEADER.toLowerCase()] !== undefined\n+  const isRSCRequest = isDevWarmupRequest || headers[RSC_HEADER] !== undefined\n \n   const shouldProvideFlightRouterState =\n     isRSCRequest && (!isPrefetchRequest || !options.isRoutePPREnabled)\n \n   const flightRouterState = shouldProvideFlightRouterState\n-    ? parseAndValidateFlightRouterState(\n-        headers[NEXT_ROUTER_STATE_TREE_HEADER.toLowerCase()]\n-      )\n+    ? parseAndValidateFlightRouterState(headers[NEXT_ROUTER_STATE_TREE_HEADER])\n     : undefined\n \n   // Checks if this is a prefetch of the Route Tree by the Segment Cache\n   const isRouteTreePrefetchRequest =\n-    headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER.toLowerCase()] === '/_tree'\n+    headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER] === '/_tree'\n \n   const csp =\n     headers['content-security-policy'] ||\n@@ -399,7 +394,7 @@ function NonIndex({\n /**\n  * This is used by server actions & client-side navigations to generate RSC data from a client-side request.\n  * This function is only called on \"dynamic\" requests (ie, there wasn't already a static response).\n- * It uses request headers (namely `Next-Router-State-Tree`) to determine where to start rendering.\n+ * It uses request headers (namely `next-router-state-tree`) to determine where to start rendering.\n  */\n async function generateDynamicRSCPayload(\n   ctx: AppRenderContext,"
        },
        {
            "sha": "c2df1132dcb6d492830b11801371ddcbe3abc481",
            "filename": "packages/next/src/server/app-render/strip-flight-headers.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fstrip-flight-headers.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fstrip-flight-headers.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fstrip-flight-headers.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -9,6 +9,6 @@ import { FLIGHT_HEADERS } from '../../client/components/app-router-headers'\n  */\n export function stripFlightHeaders(headers: IncomingHttpHeaders) {\n   for (const header of FLIGHT_HEADERS) {\n-    delete headers[header.toLowerCase()]\n+    delete headers[header]\n   }\n }"
        },
        {
            "sha": "3104dc0cfc5af6d42a2e26365fa6cdffdc3dbe96",
            "filename": "packages/next/src/server/async-storage/request-store.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fasync-storage%2Frequest-store.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fasync-storage%2Frequest-store.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fasync-storage%2Frequest-store.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -28,7 +28,7 @@ import type { ImplicitTags } from '../lib/implicit-tags'\n function getHeaders(headers: Headers | IncomingHttpHeaders): ReadonlyHeaders {\n   const cleaned = HeadersAdapter.from(headers)\n   for (const header of FLIGHT_HEADERS) {\n-    cleaned.delete(header.toLowerCase())\n+    cleaned.delete(header)\n   }\n \n   return HeadersAdapter.seal(cleaned)"
        },
        {
            "sha": "c4cc9c7f6eba5a5b81ae85c337e6557e4c121f85",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 15,
            "changes": 29,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -614,10 +614,9 @@ export default abstract class Server<\n       parsedUrl.pathname = originalPathname\n \n       // Mark the request as a router prefetch request.\n-      req.headers[RSC_HEADER.toLowerCase()] = '1'\n-      req.headers[NEXT_ROUTER_PREFETCH_HEADER.toLowerCase()] = '1'\n-      req.headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER.toLowerCase()] =\n-        segmentPath\n+      req.headers[RSC_HEADER] = '1'\n+      req.headers[NEXT_ROUTER_PREFETCH_HEADER] = '1'\n+      req.headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER] = segmentPath\n \n       addRequestMeta(req, 'isRSCRequest', true)\n       addRequestMeta(req, 'isPrefetchRSCRequest', true)\n@@ -629,8 +628,8 @@ export default abstract class Server<\n       )\n \n       // Mark the request as a router prefetch request.\n-      req.headers[RSC_HEADER.toLowerCase()] = '1'\n-      req.headers[NEXT_ROUTER_PREFETCH_HEADER.toLowerCase()] = '1'\n+      req.headers[RSC_HEADER] = '1'\n+      req.headers[NEXT_ROUTER_PREFETCH_HEADER] = '1'\n       addRequestMeta(req, 'isRSCRequest', true)\n       addRequestMeta(req, 'isPrefetchRSCRequest', true)\n     } else if (this.normalizers.rsc?.match(parsedUrl.pathname)) {\n@@ -640,7 +639,7 @@ export default abstract class Server<\n       )\n \n       // Mark the request as a RSC request.\n-      req.headers[RSC_HEADER.toLowerCase()] = '1'\n+      req.headers[RSC_HEADER] = '1'\n       addRequestMeta(req, 'isRSCRequest', true)\n     } else if (req.headers['x-now-route-matches']) {\n       // If we didn't match, return with the flight headers stripped. If in\n@@ -651,14 +650,14 @@ export default abstract class Server<\n       stripFlightHeaders(req.headers)\n \n       return false\n-    } else if (req.headers[RSC_HEADER.toLowerCase()] === '1') {\n+    } else if (req.headers[RSC_HEADER] === '1') {\n       addRequestMeta(req, 'isRSCRequest', true)\n \n-      if (req.headers[NEXT_ROUTER_PREFETCH_HEADER.toLowerCase()] === '1') {\n+      if (req.headers[NEXT_ROUTER_PREFETCH_HEADER] === '1') {\n         addRequestMeta(req, 'isPrefetchRSCRequest', true)\n \n         const segmentPrefetchRSCRequest =\n-          req.headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER.toLowerCase()]\n+          req.headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER]\n         if (typeof segmentPrefetchRSCRequest === 'string') {\n           addRequestMeta(\n             req,\n@@ -1333,7 +1332,7 @@ export default abstract class Server<\n                   params\n                 )\n \n-                req.headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER.toLowerCase()] =\n+                req.headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER] =\n                   segmentPrefetchRSCRequest\n                 addRequestMeta(\n                   req,\n@@ -2017,18 +2016,18 @@ export default abstract class Server<\n       const headers = req.headers\n \n       const isPrefetchRSCRequest =\n-        headers[NEXT_ROUTER_PREFETCH_HEADER.toLowerCase()] ||\n+        headers[NEXT_ROUTER_PREFETCH_HEADER] ||\n         getRequestMeta(req, 'isPrefetchRSCRequest')\n \n       const segmentPrefetchRSCRequest =\n-        headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER.toLowerCase()] ||\n+        headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER] ||\n         getRequestMeta(req, 'segmentPrefetchRSCRequest')\n \n       const expectedHash = computeCacheBustingSearchParam(\n         isPrefetchRSCRequest ? '1' : '0',\n         segmentPrefetchRSCRequest,\n-        headers[NEXT_ROUTER_STATE_TREE_HEADER.toLowerCase()],\n-        headers[NEXT_URL.toLowerCase()]\n+        headers[NEXT_ROUTER_STATE_TREE_HEADER],\n+        headers[NEXT_URL]\n       )\n       const actualHash =\n         getRequestMeta(req, 'cacheBustingSearchParam') ??"
        },
        {
            "sha": "f4bc247c9ed5cfb868b3ca751b004b5e67a9f9e0",
            "filename": "packages/next/src/server/lib/router-utils/resolve-routes.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fresolve-routes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fresolve-routes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fresolve-routes.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -743,8 +743,7 @@ export function getResolveRoutes(\n             // is currently on, which wouldn't be extractable from the matched route params.\n             // This attempts to extract the dynamic params from the provided router state.\n             if (isInterceptionRouteRewrite(route as Rewrite)) {\n-              const stateHeader =\n-                req.headers[NEXT_ROUTER_STATE_TREE_HEADER.toLowerCase()]\n+              const stateHeader = req.headers[NEXT_ROUTER_STATE_TREE_HEADER]\n \n               if (stateHeader) {\n                 rewriteParams = {\n@@ -776,7 +775,7 @@ export function getResolveRoutes(\n           }\n \n           // Set the rewrite headers only if this is a RSC request.\n-          if (req.headers[RSC_HEADER.toLowerCase()] === '1') {\n+          if (req.headers[RSC_HEADER] === '1') {\n             // We set the rewritten path and query headers on the response now\n             // that we know that the it's not an external rewrite.\n             if (parsedUrl.pathname !== parsedDestination.pathname) {"
        },
        {
            "sha": "d38e8a65542345dcb07b877231b980f72b06d7f3",
            "filename": "packages/next/src/server/lib/server-action-request-meta.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fserver-action-request-meta.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fserver-action-request-meta.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fserver-action-request-meta.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -16,10 +16,10 @@ export function getServerActionRequestMetadata(\n   let contentType: string | null\n \n   if (req.headers instanceof Headers) {\n-    actionId = req.headers.get(ACTION_HEADER.toLowerCase()) ?? null\n+    actionId = req.headers.get(ACTION_HEADER) ?? null\n     contentType = req.headers.get('content-type')\n   } else {\n-    actionId = (req.headers[ACTION_HEADER.toLowerCase()] as string) ?? null\n+    actionId = (req.headers[ACTION_HEADER] as string) ?? null\n     contentType = req.headers['content-type'] ?? null\n   }\n "
        },
        {
            "sha": "c27e5b653bdfaa75edbefe04562e0cd851858c65",
            "filename": "packages/next/src/server/server-utils.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fserver-utils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fserver-utils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fserver-utils.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -268,8 +268,7 @@ export function getServerUtils({\n           // is currently on, which wouldn't be extractable from the matched route params.\n           // This attempts to extract the dynamic params from the provided router state.\n           if (isInterceptionRouteRewrite(rewrite as Rewrite)) {\n-            const stateHeader =\n-              req.headers[NEXT_ROUTER_STATE_TREE_HEADER.toLowerCase()]\n+            const stateHeader = req.headers[NEXT_ROUTER_STATE_TREE_HEADER]\n \n             if (stateHeader) {\n               params = {"
        },
        {
            "sha": "a2c9e014466f8708b88c694b63275a81749d2a6a",
            "filename": "packages/next/src/server/web/adapter.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fadapter.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fadapter.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fadapter.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -154,11 +154,10 @@ export async function adapter(\n   // Headers should only be stripped for middleware\n   if (!isEdgeRendering) {\n     for (const header of FLIGHT_HEADERS) {\n-      const key = header.toLowerCase()\n-      const value = requestHeaders.get(key)\n+      const value = requestHeaders.get(header)\n       if (value !== null) {\n-        flightHeaders.set(key, value)\n-        requestHeaders.delete(key)\n+        flightHeaders.set(header, value)\n+        requestHeaders.delete(header)\n       }\n     }\n   }"
        },
        {
            "sha": "f2b157950b4b26d1a186ee87736be80d275c14ad",
            "filename": "test/e2e/app-dir/app-basepath/index.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp-basepath%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp-basepath%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-basepath%2Findex.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -78,9 +78,9 @@ describe('app dir - basepath', () => {\n           page.on('request', (request) => {\n             return request.allHeaders().then((headers) => {\n               if (\n-                headers['RSC'.toLowerCase()] === '1' &&\n-                // Prefetches also include `RSC`\n-                headers['Next-Router-Prefetch'.toLowerCase()] !== '1'\n+                headers['rsc'] === '1' &&\n+                // Prefetches also include `rsc`\n+                headers['next-router-prefetch'] !== '1'\n               ) {\n                 rscRequests.push(request.url())\n               }"
        },
        {
            "sha": "1173f325cca8042cc5e5e43e932645472b3a3a45",
            "filename": "test/e2e/app-dir/app-prefetch/prefetching.test.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp-prefetch%2Fprefetching.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp-prefetch%2Fprefetching.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-prefetch%2Fprefetching.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -262,10 +262,10 @@ describe('app dir - prefetching', () => {\n     )\n     const response = await next.fetch(`/prefetch-auto/justputit?_rsc=dcqtr`, {\n       headers: {\n-        RSC: '1',\n-        'Next-Router-Prefetch': '1',\n-        'Next-Router-State-Tree': stateTree,\n-        'Next-Url': '/prefetch-auto/justputit',\n+        rsc: '1',\n+        'next-router-prefetch': '1',\n+        'next-router-state-tree': stateTree,\n+        'next-url': '/prefetch-auto/justputit',\n       },\n     })\n \n@@ -297,18 +297,18 @@ describe('app dir - prefetching', () => {\n     )\n \n     const headers = {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n-      'Next-Router-State-Tree': stateTree,\n-      'Next-Url': '/prefetch-auto/vercel',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n+      'next-router-state-tree': stateTree,\n+      'next-url': '/prefetch-auto/vercel',\n     }\n \n     const url = new URL('/prefetch-auto/justputit', 'http://localhost')\n     const cacheBustingParam = computeCacheBustingSearchParam(\n-      headers['Next-Router-Prefetch'] ? '1' : '0',\n+      headers['next-router-prefetch'] ? '1' : '0',\n       undefined,\n-      headers['Next-Router-State-Tree'],\n-      headers['Next-Url']\n+      headers['next-router-state-tree'],\n+      headers['next-url']\n     )\n     if (cacheBustingParam) {\n       url.searchParams.set('_rsc', cacheBustingParam)"
        },
        {
            "sha": "09034c8b51cbdd314eb3de8e3e4a04ab08db4b8b",
            "filename": "test/e2e/app-dir/app-static/app-static.test.ts",
            "status": "modified",
            "additions": 72,
            "deletions": 72,
            "changes": 144,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp-static.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp-static.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp-static.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -975,7 +975,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/index.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -999,7 +999,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": null,\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1027,7 +1027,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/articles/works.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1052,7 +1052,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/blog/seb.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1077,7 +1077,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/blog/seb/second-post.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1101,7 +1101,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/blog/styfle.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1126,7 +1126,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/blog/styfle/first-post.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1150,7 +1150,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/blog/styfle/second-post.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1174,7 +1174,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/blog/tim.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1199,7 +1199,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/blog/tim/first-post.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1223,7 +1223,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/default-config-fetch.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1247,7 +1247,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/force-cache.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1272,7 +1272,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/force-static-fetch-no-store.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1296,7 +1296,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/force-static/first.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1320,7 +1320,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/force-static/second.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1344,7 +1344,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/gen-params-catch-all-unique/foo/bar.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1368,7 +1368,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/gen-params-catch-all-unique/foo/foo.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1392,7 +1392,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/gen-params-dynamic-revalidate/one.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1417,7 +1417,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/hooks/use-pathname/slug.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1441,7 +1441,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/hooks/use-search-params/force-static.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1465,7 +1465,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/hooks/use-search-params/with-suspense.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1489,7 +1489,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/isr-error-handling.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1514,7 +1514,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/no-config-fetch.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1538,7 +1538,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/no-store/static.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1562,7 +1562,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-lang/en/RAND.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1586,7 +1586,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-lang/en/first.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1610,7 +1610,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-lang/en/second.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1634,7 +1634,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-lang/fr/RAND.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1658,7 +1658,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-lang/fr/first.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1682,7 +1682,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-lang/fr/second.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1706,7 +1706,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-slug/en/RAND.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1730,7 +1730,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-slug/en/first.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1754,7 +1754,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-slug/en/second.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1778,7 +1778,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-slug/fr/RAND.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1802,7 +1802,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-slug/fr/first.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1826,7 +1826,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-gen-params-no-additional-slug/fr/second.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1850,7 +1850,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-params-false/en/static.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1874,7 +1874,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/partial-params-false/fr/static.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1898,7 +1898,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/prerendered-not-found/first.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1922,7 +1922,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/prerendered-not-found/second.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1946,7 +1946,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/prerendered-not-found/segment-revalidate.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -1971,7 +1971,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": null,\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2000,7 +2000,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": null,\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2029,7 +2029,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": null,\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2057,7 +2057,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/ssg-draft-mode.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2081,7 +2081,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/ssg-draft-mode/test.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2105,7 +2105,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/ssg-draft-mode/test-2.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2129,7 +2129,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/strip-w3c-trace-context-headers.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2154,7 +2154,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/unstable-cache/fetch/no-cache.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2178,7 +2178,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/unstable-cache/fetch/no-store.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2202,7 +2202,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/variable-config-revalidate/revalidate-3.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2227,7 +2227,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/variable-revalidate-stable/revalidate-3.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2252,7 +2252,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/variable-revalidate/authorization.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2277,7 +2277,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/variable-revalidate/cookie.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2302,7 +2302,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/variable-revalidate/encoding.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2327,7 +2327,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/variable-revalidate/headers-instance.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2352,7 +2352,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/variable-revalidate/revalidate-3.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2377,7 +2377,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRoute\": \"/variable-revalidate/revalidate-360-isr.rsc\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2407,7 +2407,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/articles\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2432,7 +2432,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/blog\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2457,7 +2457,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/blog\\\\/([^\\\\/]+?)\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2482,7 +2482,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/dynamic\\\\-error\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2507,7 +2507,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/force\\\\-static\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2532,7 +2532,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/gen\\\\-params\\\\-catch\\\\-all\\\\-unique\\\\/(.+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2557,7 +2557,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/gen\\\\-params\\\\-dynamic\\\\-revalidate\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2582,7 +2582,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/hooks\\\\/use\\\\-pathname\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2607,7 +2607,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/partial\\\\-gen\\\\-params\\\\-no\\\\-additional\\\\-lang\\\\/([^\\\\/]+?)\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2632,7 +2632,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/partial\\\\-gen\\\\-params\\\\-no\\\\-additional\\\\-slug\\\\/([^\\\\/]+?)\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2657,7 +2657,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/partial\\\\-params\\\\-false\\\\/([^\\\\/]+?)\\\\/static\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2682,7 +2682,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/prerendered\\\\-not\\\\-found\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2707,7 +2707,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/ssg\\\\-draft\\\\-mode(?:\\\\/(.+?))?\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {\n@@ -2732,7 +2732,7 @@ describe('app-dir static/dynamic handling', () => {\n            \"dataRouteRegex\": \"^\\\\/static\\\\-to\\\\-dynamic\\\\-error\\\\-forced\\\\/([^\\\\/]+?)\\\\.rsc$\",\n            \"experimentalBypassFor\": [\n              {\n-               \"key\": \"Next-Action\",\n+               \"key\": \"next-action\",\n                \"type\": \"header\",\n              },\n              {"
        },
        {
            "sha": "89d1a9978c3f4e913d60ebf5a1868c38a6315b1d",
            "filename": "test/e2e/app-dir/app-validation/validation.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp-validation%2Fvalidation.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp-validation%2Fvalidation.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-validation%2Fvalidation.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -16,13 +16,13 @@ describe('app dir - validation', () => {\n     const stateTree2 = JSON.stringify(['', {}])\n \n     const headers1 = {\n-      RSC: '1',\n-      'Next-Router-State-Tree': stateTree1,\n+      rsc: '1',\n+      'next-router-state-tree': stateTree1,\n     }\n \n     const headers2 = {\n-      RSC: '1',\n-      'Next-Router-State-Tree': stateTree2,\n+      rsc: '1',\n+      'next-router-state-tree': stateTree2,\n     }\n \n     const url1 = new URL('/', 'http://localhost')"
        },
        {
            "sha": "b649fce64262c52b9d544dbaa8f5aa8fefb3fd33",
            "filename": "test/e2e/app-dir/app/index.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp%2Findex.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -334,7 +334,7 @@ describe('app dir - basic', () => {\n     const res = await next.fetch('/dashboard')\n     expect(res.headers.get('x-edge-runtime')).toBe('1')\n     expect(res.headers.get('vary')).toBe(\n-      'RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch'\n+      'rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch'\n     )\n   })\n \n@@ -346,8 +346,8 @@ describe('app dir - basic', () => {\n     })\n     expect(res.headers.get('vary')).toBe(\n       isNextDeploy\n-        ? 'RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch'\n-        : 'RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch, Accept-Encoding'\n+        ? 'rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch'\n+        : 'rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch, Accept-Encoding'\n     )\n   })\n "
        },
        {
            "sha": "67a21a520ca73241c63f621c8cd1ebf84bf71147",
            "filename": "test/e2e/app-dir/app/middleware.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp%2Fmiddleware.js",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fapp%2Fmiddleware.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp%2Fmiddleware.js?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -41,8 +41,8 @@ export async function middleware(request) {\n       ? 'rewrite'\n       : 'redirect'\n \n-    const internal = ['RSC', 'Next-Router-State-Tree']\n-    if (internal.some((name) => request.headers.has(name.toLowerCase()))) {\n+    const internal = ['rsc', 'next-router-state-tree']\n+    if (internal.some((name) => request.headers.has(name))) {\n       return NextResponse[method](new URL('/internal/failure', request.url))\n     }\n "
        },
        {
            "sha": "4dceff51feeba656a29ea360b5686aae568804a2",
            "filename": "test/e2e/app-dir/ppr-full/ppr-full.test.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fppr-full%2Fppr-full.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fppr-full%2Fppr-full.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fppr-full%2Fppr-full.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -52,10 +52,10 @@ const addCacheBustingSearchParam = (\n   headers: Record<string, string | string[] | undefined>\n ) => {\n   const cacheKey = computeCacheBustingSearchParam(\n-    headers['Next-Router-Prefetch'] ? '1' : '0',\n-    headers['Next-Router-Segment-Prefetch'],\n-    headers['Next-Router-State-Tree'],\n-    headers['Next-URL']\n+    headers['next-router-prefetch'] ? '1' : '0',\n+    headers['next-router-segment-prefetch'],\n+    headers['next-router-state-tree'],\n+    headers['next-url']\n   )\n \n   if (cacheKey === null) {\n@@ -535,8 +535,8 @@ describe('ppr-full', () => {\n         it('should have correct headers', async () => {\n           await retry(async () => {\n             const headers = {\n-              RSC: '1',\n-              'Next-Router-Prefetch': '1',\n+              rsc: '1',\n+              'next-router-prefetch': '1',\n             }\n             const urlWithCacheBusting = addCacheBustingSearchParam(\n               pathname,\n@@ -573,8 +573,8 @@ describe('ppr-full', () => {\n         it('should not contain dynamic content', async () => {\n           const unexpected = `${Date.now()}:${Math.random()}`\n           const headers = {\n-            RSC: '1',\n-            'Next-Router-Prefetch': '1',\n+            rsc: '1',\n+            'next-router-prefetch': '1',\n             'X-Test-Input': unexpected,\n           }\n           const urlWithCacheBusting = addCacheBustingSearchParam(\n@@ -596,7 +596,7 @@ describe('ppr-full', () => {\n     describe('Dynamic RSC Response', () => {\n       describe.each(pages)('for $pathname', ({ pathname, dynamic }) => {\n         it('should have correct headers', async () => {\n-          const headers = { RSC: '1' }\n+          const headers = { rsc: '1' }\n           const urlWithCacheBusting = addCacheBustingSearchParam(\n             pathname,\n             headers\n@@ -621,7 +621,7 @@ describe('ppr-full', () => {\n           it('should contain dynamic content', async () => {\n             const expected = `${Date.now()}:${Math.random()}`\n             const headers = {\n-              RSC: '1',\n+              rsc: '1',\n               'X-Test-Input': expected,\n             }\n             const urlWithCacheBusting = addCacheBustingSearchParam(\n@@ -641,7 +641,7 @@ describe('ppr-full', () => {\n           it('should not contain dynamic content', async () => {\n             const unexpected = `${Date.now()}:${Math.random()}`\n             const headers = {\n-              RSC: '1',\n+              rsc: '1',\n               'X-Test-Input': unexpected,\n             }\n             const urlWithCacheBusting = addCacheBustingSearchParam("
        },
        {
            "sha": "e66c1539c7d0470aef9196f2931cb696adf62891",
            "filename": "test/e2e/app-dir/rewrite-headers/rewrite-headers.test.ts",
            "status": "modified",
            "additions": 39,
            "deletions": 39,
            "changes": 78,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Frewrite-headers%2Frewrite-headers.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Frewrite-headers%2Frewrite-headers.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frewrite-headers%2Frewrite-headers.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -25,7 +25,7 @@ const cases: {\n     name: 'static RSC',\n     pathname: '/',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -36,8 +36,8 @@ const cases: {\n     name: 'static Prefetch RSC',\n     pathname: '/',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -56,7 +56,7 @@ const cases: {\n     name: 'prerendered RSC',\n     pathname: '/hello/world',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -67,8 +67,8 @@ const cases: {\n     name: 'prerendered Prefetch RSC',\n     pathname: '/hello/world',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -87,7 +87,7 @@ const cases: {\n     name: 'middleware rewrite RSC',\n     pathname: '/hello/wyatt',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/hello/admin',\n@@ -98,8 +98,8 @@ const cases: {\n     name: 'middleware rewrite Prefetch RSC',\n     pathname: '/hello/wyatt',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     // only: true,\n     expected: {\n@@ -119,7 +119,7 @@ const cases: {\n     name: 'middleware rewrite dynamic RSC',\n     pathname: '/hello/bob',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/hello/bobby',\n@@ -130,8 +130,8 @@ const cases: {\n     name: 'middleware rewrite dynamic Prefetch RSC',\n     pathname: '/hello/bob',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/hello/bobby',\n@@ -150,7 +150,7 @@ const cases: {\n     name: 'dynamic RSC',\n     pathname: '/hello/mary',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -161,8 +161,8 @@ const cases: {\n     name: 'dynamic Prefetch RSC',\n     pathname: '/hello/mary',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -181,7 +181,7 @@ const cases: {\n     name: 'dynamic RSC with query',\n     pathname: '/hello/mary?key=value',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -192,8 +192,8 @@ const cases: {\n     name: 'dynamic Prefetch RSC with query',\n     pathname: '/hello/mary?key=value',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -212,7 +212,7 @@ const cases: {\n     name: 'next.config.js rewrites RSC',\n     pathname: '/hello/sam',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/hello/samantha',\n@@ -223,8 +223,8 @@ const cases: {\n     name: 'next.config.js rewrites Prefetch RSC',\n     pathname: '/hello/sam',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/hello/samantha',\n@@ -243,7 +243,7 @@ const cases: {\n     name: 'next.config.js rewrites static RSC',\n     pathname: '/hello/other',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/other',\n@@ -254,8 +254,8 @@ const cases: {\n     name: 'next.config.js rewrites static Prefetch RSC',\n     pathname: '/hello/other',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/other',\n@@ -282,7 +282,7 @@ const cases: {\n     name: 'middleware rewrite query RSC',\n     pathname: '/hello/john',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -293,8 +293,8 @@ const cases: {\n     name: 'middleware rewrite query Prefetch RSC',\n     pathname: '/hello/john',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': null,\n@@ -316,7 +316,7 @@ const cases: {\n   //   name: 'middleware rewrite external RSC',\n   //   pathname: '/hello/vercel',\n   //   headers: {\n-  //     RSC: '1',\n+  //     rsc: '1',\n   //   },\n   //   expected: {\n   //     // Vercel matches `/` to `/home`\n@@ -328,8 +328,8 @@ const cases: {\n   //   name: 'middleware rewrite external Prefetch RSC',\n   //   pathname: '/hello/vercel',\n   //   headers: {\n-  //     RSC: '1',\n-  //     'Next-Router-Prefetch': '1',\n+  //     rsc: '1',\n+  //     'next-router-prefetch': '1',\n   //   },\n   //   expected: {\n   //     // Vercel matches `/` to `/home`\n@@ -349,7 +349,7 @@ const cases: {\n     name: 'next.config.js rewrites with query RSC',\n     pathname: '/hello/fred',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/other',\n@@ -360,8 +360,8 @@ const cases: {\n     name: 'next.config.js rewrites with query Prefetch RSC',\n     pathname: '/hello/fred',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/other',\n@@ -380,7 +380,7 @@ const cases: {\n     name: 'next.config.js rewrites with path-matched query RSC',\n     pathname: '/rewrites-to-query/andrew',\n     headers: {\n-      RSC: '1',\n+      rsc: '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/other',\n@@ -391,8 +391,8 @@ const cases: {\n     name: 'next.config.js rewrites with path-matched query Prefetch RSC',\n     pathname: '/rewrites-to-query/andrew',\n     headers: {\n-      RSC: '1',\n-      'Next-Router-Prefetch': '1',\n+      rsc: '1',\n+      'next-router-prefetch': '1',\n     },\n     expected: {\n       'x-nextjs-rewritten-path': '/other',\n@@ -416,11 +416,11 @@ describe('rewrite-headers', () => {\n         const url = new URL(pathname, 'http://localhost')\n \n         // Add cache busting param for RSC requests\n-        if (headers.RSC === '1') {\n+        if (headers.rsc === '1') {\n           const cacheBustingParam = computeCacheBustingSearchParam(\n-            headers['Next-Router-Prefetch'] ? '1' : '0',\n+            headers['next-router-prefetch'] ? '1' : '0',\n             undefined,\n-            headers['Next-Router-State-Tree'],\n+            headers['next-router-state-tree'],\n             undefined\n           )\n           if (cacheBustingParam) {"
        },
        {
            "sha": "7aec90c21c947d2e571dc5d2f017bbe4c5fd35a1",
            "filename": "test/e2e/app-dir/rsc-basic/rsc-basic.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Frsc-basic%2Frsc-basic.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Frsc-basic%2Frsc-basic.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frsc-basic%2Frsc-basic.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -169,9 +169,9 @@ describe('app dir - rsc basics', () => {\n           requestsCount++\n           const headers = request.headers()\n           if (\n-            headers['RSC'.toLowerCase()] === '1' &&\n-            // Prefetches also include `RSC`\n-            headers['Next-Router-Prefetch'.toLowerCase()] !== '1'\n+            headers['rsc'] === '1' &&\n+            // Prefetches also include `rsc`\n+            headers['next-router-prefetch'] !== '1'\n           ) {\n             flightRequests.push(request.url())\n           }"
        },
        {
            "sha": "6e91da53b1b103b5ffec7a617fbeaa47b2ac81d5",
            "filename": "test/e2e/app-dir/rsc-redirect/rsc-redirect.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Frsc-redirect%2Frsc-redirect.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Frsc-redirect%2Frsc-redirect.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frsc-redirect%2Frsc-redirect.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -26,7 +26,7 @@ describe('rsc-redirect', () => {\n       {\n         redirect: 'manual',\n         headers: {\n-          RSC: '1',\n+          rsc: '1',\n         },\n       }\n     )"
        },
        {
            "sha": "aca58a6dee531499e3653ef46a7d7b2bef1a946b",
            "filename": "test/e2e/app-dir/segment-cache/cdn-cache-busting/cdn-cache-busting.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fcdn-cache-busting%2Fcdn-cache-busting.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fcdn-cache-busting%2Fcdn-cache-busting.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fcdn-cache-busting%2Fcdn-cache-busting.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -83,9 +83,9 @@ describe('segment cache (CDN cache busting)', () => {\n         async () => {\n           const res = await fetch('/target-page', {\n             headers: {\n-              RSC: '1',\n-              'Next-Router-Prefetch': '1',\n-              'Next-Router-Segment-Prefetch': '/_tree',\n+              rsc: '1',\n+              'next-router-prefetch': '1',\n+              'next-router-segment-prefetch': '/_tree',\n             },\n           })\n           return {"
        },
        {
            "sha": "01752a09b2ddcaadad385ce4c4fd6cb98058d135",
            "filename": "test/e2e/app-dir/segment-cache/conflicting-routes/conflicting-routes.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fconflicting-routes%2Fconflicting-routes.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fconflicting-routes%2Fconflicting-routes.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fconflicting-routes%2Fconflicting-routes.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -25,9 +25,9 @@ describe('conflicting routes', () => {\n     fetchUrl.search = searchParams.toString()\n     return await next.fetch(fetchUrl.pathname + fetchUrl.search, {\n       headers: {\n-        RSC: '1',\n-        'Next-Router-Prefetch': '1',\n-        'Next-Router-Segment-Prefetch': segmentPath,\n+        rsc: '1',\n+        'next-router-prefetch': '1',\n+        'next-router-segment-prefetch': segmentPath,\n       },\n     })\n   }"
        },
        {
            "sha": "f83f01096de4584236b49a18cff1544e67fa97f5",
            "filename": "test/e2e/app-dir/segment-cache/incremental-opt-in/segment-cache-incremental-opt-in.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fincremental-opt-in%2Fsegment-cache-incremental-opt-in.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fincremental-opt-in%2Fsegment-cache-incremental-opt-in.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fincremental-opt-in%2Fsegment-cache-incremental-opt-in.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -37,8 +37,8 @@ describe('segment cache (incremental opt in)', () => {\n             const url = request.url()\n             const prefetchInfo = {\n               href: new URL(url).pathname,\n-              segment: headers['Next-Router-Segment-Prefetch'.toLowerCase()],\n-              base: headers['Next-Router-State-Tree'.toLowerCase()] ?? null,\n+              segment: headers['next-router-segment-prefetch'],\n+              base: headers['next-router-state-tree'] ?? null,\n             }\n             const key = JSON.stringify(prefetchInfo)\n             if (prefetches.has(key)) {"
        },
        {
            "sha": "6f78f8bc797e8e899c4562daa1c7ed4dc1c7b901",
            "filename": "test/e2e/next-form/default/next-form-prefetch.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fnext-form%2Fdefault%2Fnext-form-prefetch.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fnext-form%2Fdefault%2Fnext-form-prefetch.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fnext-form%2Fdefault%2Fnext-form-prefetch.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -28,8 +28,8 @@ _describe('app dir - form prefetching', () => {\n       requestFilter: async (request) => {\n         // only capture RSC requests that *aren't* prefetches\n         const headers = await request.allHeaders()\n-        const isRSC = headers[RSC_HEADER.toLowerCase()] === '1'\n-        const isPrefetch = !!headers[NEXT_ROUTER_PREFETCH_HEADER.toLowerCase()]\n+        const isRSC = headers[RSC_HEADER] === '1'\n+        const isPrefetch = !!headers[NEXT_ROUTER_PREFETCH_HEADER]\n         return isRSC && !isPrefetch\n       },\n       log: true,\n@@ -74,7 +74,7 @@ _describe('app dir - form prefetching', () => {\n       requestFilter: async (request) => {\n         // capture all RSC requests, prefetch or not\n         const headers = await request.allHeaders()\n-        const isRSC = headers[RSC_HEADER.toLowerCase()] === '1'\n+        const isRSC = headers[RSC_HEADER] === '1'\n         return isRSC\n       },\n       log: true,"
        },
        {
            "sha": "2257552bd0d79dfd1b5a3aa09ee16c0df0bd743e",
            "filename": "test/e2e/switchable-runtime/index.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fswitchable-runtime%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fswitchable-runtime%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fswitchable-runtime%2Findex.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -108,7 +108,7 @@ describe('Switchable runtime', () => {\n           beforePageLoad(page) {\n             page.on('request', (request) => {\n               return request.allHeaders().then((headers) => {\n-                if (headers['RSC'.toLowerCase()] === '1') {\n+                if (headers['rsc'] === '1') {\n                   flightRequest = request.url()\n                 }\n               })\n@@ -640,7 +640,7 @@ describe('Switchable runtime', () => {\n           beforePageLoad(page) {\n             page.on('request', (request) => {\n               request.allHeaders().then((headers) => {\n-                if (headers['RSC'.toLowerCase()] === '1') {\n+                if (headers['rsc'] === '1') {\n                   flightRequest = request.url()\n                 }\n               })"
        },
        {
            "sha": "0ec32068cba2087277476d5f45e4b62fe65b7a3c",
            "filename": "test/e2e/vary-header/test/index.test.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fvary-header%2Ftest%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fe2e%2Fvary-header%2Ftest%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fvary-header%2Ftest%2Findex.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -21,9 +21,9 @@ describe('Vary Header Tests', () => {\n     expect(res.headers.get('cache-control')).toBe('s-maxage=3600')\n \n     // Next.js internal headers are appended\n-    expect(varyHeader).toContain('RSC')\n-    expect(varyHeader).toContain('Next-Router-State-Tree')\n-    expect(varyHeader).toContain('Next-Router-Prefetch')\n+    expect(varyHeader).toContain('rsc')\n+    expect(varyHeader).toContain('next-router-state-tree')\n+    expect(varyHeader).toContain('next-router-prefetch')\n   })\n \n   it('should preserve middleware vary header in combination with route handlers', async () => {\n@@ -39,8 +39,8 @@ describe('Vary Header Tests', () => {\n     expect(varyHeader).toContain('User-Agent')\n \n     // Next.js internal headers are still present\n-    expect(varyHeader).toContain('RSC')\n-    expect(varyHeader).toContain('Next-Router-State-Tree')\n-    expect(varyHeader).toContain('Next-Router-Prefetch')\n+    expect(varyHeader).toContain('rsc')\n+    expect(varyHeader).toContain('next-router-state-tree')\n+    expect(varyHeader).toContain('next-router-prefetch')\n   })\n })"
        },
        {
            "sha": "892603f3ae80e165f20c12a21816c5ff941e0076",
            "filename": "test/integration/custom-routes/test/index.test.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fintegration%2Fcustom-routes%2Ftest%2Findex.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fintegration%2Fcustom-routes%2Ftest%2Findex.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fcustom-routes%2Ftest%2Findex.test.js?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -2559,14 +2559,14 @@ const runTests = (isDev = false) => {\n           },\n         ],\n         rsc: {\n-          header: 'RSC',\n+          header: 'rsc',\n           contentTypeHeader: 'text/x-component',\n           didPostponeHeader: 'x-nextjs-postponed',\n           varyHeader:\n-            'RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch',\n-          prefetchHeader: 'Next-Router-Prefetch',\n+            'rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch',\n+          prefetchHeader: 'next-router-prefetch',\n           prefetchSegmentDirSuffix: '.segments',\n-          prefetchSegmentHeader: 'Next-Router-Segment-Prefetch',\n+          prefetchSegmentHeader: 'next-router-segment-prefetch',\n           prefetchSegmentSuffix: '.segment.rsc',\n           prefetchSuffix: '.prefetch.rsc',\n           suffix: '.rsc',"
        },
        {
            "sha": "07f51bb623df4a45f7c8198f22a8b20a4187de81",
            "filename": "test/integration/dynamic-routing/test/index.test.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fintegration%2Fdynamic-routing%2Ftest%2Findex.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fintegration%2Fdynamic-routing%2Ftest%2Findex.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fdynamic-routing%2Ftest%2Findex.test.js?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -1518,14 +1518,14 @@ function runTests({ dev }) {\n           queryHeader: 'x-nextjs-rewritten-query',\n         },\n         rsc: {\n-          header: 'RSC',\n+          header: 'rsc',\n           contentTypeHeader: 'text/x-component',\n           didPostponeHeader: 'x-nextjs-postponed',\n           varyHeader:\n-            'RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch',\n-          prefetchHeader: 'Next-Router-Prefetch',\n+            'rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch',\n+          prefetchHeader: 'next-router-prefetch',\n           prefetchSegmentDirSuffix: '.segments',\n-          prefetchSegmentHeader: 'Next-Router-Segment-Prefetch',\n+          prefetchSegmentHeader: 'next-router-segment-prefetch',\n           prefetchSegmentSuffix: '.segment.rsc',\n           prefetchSuffix: '.prefetch.rsc',\n           suffix: '.rsc',"
        },
        {
            "sha": "527e1e0f0a994a017b0ce88c432ad37df10019ae",
            "filename": "test/production/standalone-mode/response-cache/index.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fproduction%2Fstandalone-mode%2Fresponse-cache%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b/test%2Fproduction%2Fstandalone-mode%2Fresponse-cache%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fstandalone-mode%2Fresponse-cache%2Findex.test.ts?ref=ee284b8ba1d2b4192d9d63cb6162b5c2b8158a0b",
            "patch": "@@ -92,7 +92,7 @@ describe('minimal-mode-response-cache', () => {\n \n   it('app router revalidate should work with previous response cache dynamic', async () => {\n     const headers = {\n-      vary: 'RSC, Next-Router-State-Tree, Next-Router-Prefetch',\n+      vary: 'rsc, next-router-state-tree, next-router-prefetch',\n       'x-now-route-matches': '1=compare&rsc=1',\n       'x-matched-path': '/app-blog/compare.rsc',\n       'x-vercel-id': '1',\n@@ -122,7 +122,7 @@ describe('minimal-mode-response-cache', () => {\n \n   it('app router revalidate should work with previous response cache', async () => {\n     const headers = {\n-      vary: 'RSC, Next-Router-State-Tree, Next-Router-Prefetch',\n+      vary: 'rsc, next-router-state-tree, next-router-prefetch',\n       'x-now-route-matches': '1=app-another&rsc=1',\n       'x-matched-path': '/app-another.rsc',\n       'x-vercel-id': '1',"
        }
    ],
    "stats": {
        "total": 443,
        "additions": 217,
        "deletions": 226
    }
}