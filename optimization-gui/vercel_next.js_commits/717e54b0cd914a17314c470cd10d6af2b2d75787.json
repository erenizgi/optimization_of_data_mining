{
    "author": "eps1lon",
    "message": "[dev-overlay] Unify error deduplication logic (#78017)",
    "sha": "717e54b0cd914a17314c470cd10d6af2b2d75787",
    "files": [
        {
            "sha": "c58c4dd5b8acd46f05dfdb18f2f451225d1827a8",
            "filename": "packages/next/src/client/components/errors/enqueue-client-error.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 12,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2a594945b60abb3b6e3e46d08163acb8b3f5f989/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Ferrors%2Fenqueue-client-error.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2a594945b60abb3b6e3e46d08163acb8b3f5f989/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Ferrors%2Fenqueue-client-error.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Ferrors%2Fenqueue-client-error.ts?ref=2a594945b60abb3b6e3e46d08163acb8b3f5f989",
            "patch": "@@ -1,12 +0,0 @@\n-// Dedupe the two consecutive errors: If the previous one is same as current one, ignore the current one.\n-export function enqueueConsecutiveDedupedError(\n-  queue: Array<Error>,\n-  error: Error\n-) {\n-  const previousError = queue[queue.length - 1]\n-  // Compare the error stack to dedupe the consecutive errors\n-  if (previousError && previousError.stack === error.stack) {\n-    return\n-  }\n-  queue.push(error)\n-}"
        },
        {
            "sha": "55bab56e724d1c6aae44228bbb21ddf4fa63710d",
            "filename": "packages/next/src/client/components/errors/use-error-handler.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/717e54b0cd914a17314c470cd10d6af2b2d75787/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Ferrors%2Fuse-error-handler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/717e54b0cd914a17314c470cd10d6af2b2d75787/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Ferrors%2Fuse-error-handler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Ferrors%2Fuse-error-handler.ts?ref=717e54b0cd914a17314c470cd10d6af2b2d75787",
            "patch": "@@ -5,7 +5,6 @@ import { storeHydrationErrorStateFromConsoleArgs } from './hydration-error-info'\n import { formatConsoleArgs, parseConsoleArgs } from '../../lib/console'\n import isError from '../../../lib/is-error'\n import { createConsoleError } from './console-error'\n-import { enqueueConsecutiveDedupedError } from './enqueue-client-error'\n import { getReactStitchedError } from '../errors/stitched-error'\n \n const queueMicroTask =\n@@ -37,7 +36,7 @@ export function handleConsoleError(\n   storeHydrationErrorStateFromConsoleArgs(...consoleErrorArgs)\n   attachHydrationErrorState(error)\n \n-  enqueueConsecutiveDedupedError(errorQueue, error)\n+  errorQueue.push(error)\n   for (const handler of errorHandlers) {\n     // Delayed the error being passed to React Dev Overlay,\n     // avoid the state being synchronously updated in the component.\n@@ -60,7 +59,7 @@ export function handleClientError(originError: unknown) {\n \n   attachHydrationErrorState(error)\n \n-  enqueueConsecutiveDedupedError(errorQueue, error)\n+  errorQueue.push(error)\n   for (const handler of errorHandlers) {\n     // Delayed the error being passed to React Dev Overlay,\n     // avoid the state being synchronously updated in the component."
        },
        {
            "sha": "5fc0abb8eed7cea49099f87eb1584d561cf2f1ec",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/container/runtime-error/render-error.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 29,
            "changes": 30,
            "blob_url": "https://github.com/vercel/next.js/blob/717e54b0cd914a17314c470cd10d6af2b2d75787/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Fruntime-error%2Frender-error.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/717e54b0cd914a17314c470cd10d6af2b2d75787/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Fruntime-error%2Frender-error.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Fruntime-error%2Frender-error.tsx?ref=717e54b0cd914a17314c470cd10d6af2b2d75787",
            "patch": "@@ -5,10 +5,6 @@ import type {\n } from '../../../shared'\n \n import { useMemo, useState, useEffect } from 'react'\n-import {\n-  ACTION_UNHANDLED_ERROR,\n-  ACTION_UNHANDLED_REJECTION,\n-} from '../../../shared'\n import {\n   getErrorByType,\n   type ReadyRuntimeError,\n@@ -19,17 +15,6 @@ export type SupportedErrorEvent = {\n   event: UnhandledErrorAction | UnhandledRejectionAction\n }\n \n-function getErrorSignature(ev: SupportedErrorEvent): string {\n-  const { event } = ev\n-  // eslint-disable-next-line default-case -- TypeScript checks this\n-  switch (event.type) {\n-    case ACTION_UNHANDLED_ERROR:\n-    case ACTION_UNHANDLED_REJECTION: {\n-      return `${event.reason.name}::${event.reason.message}::${event.reason.stack}`\n-    }\n-  }\n-}\n-\n type Props = {\n   children: (params: {\n     runtimeErrors: ReadyRuntimeError[]\n@@ -72,14 +57,6 @@ const RenderRuntimeError = ({ children, state, isAppDir }: Props) => {\n         continue\n       }\n \n-      // Check for duplicate errors\n-      if (idx > 0) {\n-        const prev = errors[idx - 1]\n-        if (getErrorSignature(prev) === getErrorSignature(e)) {\n-          continue\n-        }\n-      }\n-\n       next = e\n       break\n     }\n@@ -108,12 +85,7 @@ const RenderRuntimeError = ({ children, state, isAppDir }: Props) => {\n     }\n   }, [nextError, isAppDir])\n \n-  const totalErrorCount = errors.filter((err, idx) => {\n-    const prev = errors[idx - 1]\n-    // Check for duplicates\n-    if (idx > 0) return getErrorSignature(prev) !== getErrorSignature(err)\n-    return true\n-  }).length\n+  const totalErrorCount = errors.length\n \n   return children({ runtimeErrors, totalErrorCount })\n }"
        }
    ],
    "stats": {
        "total": 47,
        "additions": 3,
        "deletions": 44
    }
}