{
    "author": "wyattjoh",
    "message": "feat(cache-components): require non-empty generateStaticParams for validation (#85135)\n\n### What?\n\nThis PR adds build-time validation that requires `generateStaticParams`\nto return at least one result when Cache Components (experimental\n`cacheComponents` feature) is enabled.\n\n### Why?\n\nPreviously, users could return an empty array (`[]`) from\n`generateStaticParams` to indicate a route should be treated statically\nwithout providing specific parameter values. This pattern has a critical\nissue with Cache Components:\n\n**The Problem:**\n- With Cache Components enabled, accessing `params` is treated as a\ndynamic API usage\n- When `generateStaticParams` returns empty results, Next.js cannot\nperform build-time validation to detect if the route accesses other\ndynamic APIs (like `await cookies()`, `await headers()`, or `await\nsearchParams`)\n- This means users could successfully build routes that would fail at\nruntime with dynamic API errors\n\n**The Solution:**\n- By requiring at least one parameter value, we can execute the route\nduring build time with real params\n- This allows us to validate that the route doesn't make additional\ndynamic API calls that would cause runtime failures\n- Build-time validation catches configuration errors early, before\ndeployment\n\n### How?\n\n- Modified `buildAppStaticPaths` in\n`packages/next/src/build/static-paths/app.ts` to check if PPR is enabled\nand throw error when `generateStaticParams` returns empty array with\nCache Components enabled\n- Added comprehensive error documentation at\n`errors/empty-generate-static-params.mdx` with migration options\n\nMigration paths provided in error documentation:\n1. Return at least one real param (recommended)\n2. Use placeholder params (not recommended, bypasses validation)\n\nThe breaking change is acceptable because `cacheComponents` is still\nexperimental and only available in canary releases.\n\n### Related\n\n- Addresses discrepancy discovered with\nhttps://github.com/vercel/next.js/discussions/84925.\n- Fixes https://github.com/vercel/next.js/issues/84801",
    "sha": "3cd8a234464f761f26c45a955da3cbd373e0f198",
    "files": [
        {
            "sha": "f4537cb17f52eadb0e08d4d1217f763eb324303b",
            "filename": "errors/empty-generate-static-params.mdx",
            "status": "added",
            "additions": 69,
            "deletions": 0,
            "changes": 69,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/errors%2Fempty-generate-static-params.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/errors%2Fempty-generate-static-params.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fempty-generate-static-params.mdx?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -0,0 +1,69 @@\n+---\n+title: Empty generateStaticParams with Cache Components\n+---\n+\n+## Why This Error Occurred\n+\n+You're using [Cache Components](https://nextjs.org/docs/beta/app/api-reference/config/next-config-js/cacheComponents) in your Next.js application, and one of your `generateStaticParams` functions returned an empty array, which causes a build error.\n+\n+When Cache Components is enabled, Next.js performs build-time validation to ensure your routes can be properly prerendered without runtime dynamic access errors. If `generateStaticParams` returns an empty array, Next.js cannot validate that your route won't access dynamic values (like `await cookies()`, `await headers()`, or `await searchParams`) at runtime, which would cause errors.\n+\n+This strict requirement ensures:\n+\n+- Build-time validation catches potential runtime errors early\n+- All routes using Cache Components have at least one static variant to validate against\n+- You don't accidentally deploy routes that will fail at runtime\n+\n+## Possible Ways to Fix It\n+\n+### Option 1: Return at least one static param\n+\n+Modify your `generateStaticParams` function to return at least one set of parameters. This is the most common fix and allows build-time validation to work properly.\n+\n+```tsx filename=\"app/blog/[slug]/page.tsx\"\n+// ❌ This will cause an error with Cache Components\n+export async function generateStaticParams() {\n+  return [] // Empty array not allowed\n+}\n+\n+// ✅ Return at least one param\n+export async function generateStaticParams() {\n+  return [{ slug: 'hello-world' }, { slug: 'getting-started' }]\n+}\n+```\n+\n+### Option 2: Use a placeholder param for validation\n+\n+If you don't know the actual values at build time but still want Cache Components, you can return a placeholder param for build-time validation:\n+\n+> This is not recommended and should only be used if you absolutely need to as it prevents build-time validation from working which will likely cause runtime errors.\n+\n+```tsx filename=\"app/blog/[slug]/page.tsx\"\n+export async function generateStaticParams() {\n+  // Return a placeholder for build-time validation\n+  // Real params will be generated at runtime via ISR\n+  return [{ slug: '__placeholder__' }]\n+}\n+\n+export default async function Page({\n+  params,\n+}: {\n+  params: Promise<{ slug: string }>\n+}) {\n+  const { slug } = await params\n+\n+  // Handle placeholder case\n+  if (slug === '__placeholder__') {\n+    notFound()\n+  }\n+\n+  // Your actual page logic\n+  const post = await getPost(slug)\n+  return <div>{post.title}</div>\n+}\n+```\n+\n+## Useful Links\n+\n+- [Cache Components Documentation](https://nextjs.org/docs/beta/app/api-reference/config/next-config-js/cacheComponents)\n+- [generateStaticParams API Reference](https://nextjs.org/docs/app/api-reference/functions/generate-static-params)"
        },
        {
            "sha": "d5fbefdd461881c96e41c43a82795ee2a2d84a47",
            "filename": "packages/next/errors.json",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Ferrors.json",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Ferrors.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ferrors.json?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -895,5 +895,6 @@\n   \"894\": \"Param %s not found in childrenRouteParamSegments %s\",\n   \"895\": \"Invalid React HTML document. Should start with doctype prefix.\",\n   \"896\": \"oops\",\n-  \"897\": \"Expected HTML document to start with doctype prefix\"\n+  \"897\": \"Expected HTML document to start with doctype prefix\",\n+  \"898\": \"When using Cache Components, all `generateStaticParams` functions must return at least one result. This is to ensure that we can perform build-time validation that there is no other dynamic accesses that would cause a runtime error.\\n\\nLearn more: https://nextjs.org/docs/messages/empty-generate-static-params\"\n }"
        },
        {
            "sha": "204fde8f4c632b33ac49bd9e0d94f915dbe1eb47",
            "filename": "packages/next/src/build/static-paths/app.test.ts",
            "status": "modified",
            "additions": 72,
            "deletions": 28,
            "changes": 100,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fbuild%2Fstatic-paths%2Fapp.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fbuild%2Fstatic-paths%2Fapp.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fstatic-paths%2Fapp.test.ts?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -834,7 +834,7 @@ describe('generateRouteStaticParams', () => {\n   describe('Basic functionality', () => {\n     it('should return empty array for empty segments', async () => {\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams([], store)\n+      const result = await generateRouteStaticParams([], store, false)\n       expect(result).toEqual([])\n     })\n \n@@ -844,7 +844,7 @@ describe('generateRouteStaticParams', () => {\n         createMockSegment(),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([])\n     })\n \n@@ -853,7 +853,7 @@ describe('generateRouteStaticParams', () => {\n         createMockSegment(async () => [{ id: '1' }, { id: '2' }]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([{ id: '1' }, { id: '2' }])\n     })\n \n@@ -869,7 +869,7 @@ describe('generateRouteStaticParams', () => {\n         ]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([\n         { category: 'tech', slug: 'tech-post-1' },\n         { category: 'tech', slug: 'tech-post-2' },\n@@ -888,7 +888,7 @@ describe('generateRouteStaticParams', () => {\n         ]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([\n         { lang: 'en', category: 'en-tech' },\n         { lang: 'fr', category: 'fr-tech' },\n@@ -904,7 +904,7 @@ describe('generateRouteStaticParams', () => {\n         ]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([{ lang: 'en', slug: 'en-slug' }])\n     })\n   })\n@@ -913,7 +913,7 @@ describe('generateRouteStaticParams', () => {\n     it('should handle empty generateStaticParams results', async () => {\n       const segments: TestAppSegment[] = [createMockSegment(async () => [])]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([])\n     })\n \n@@ -923,7 +923,7 @@ describe('generateRouteStaticParams', () => {\n         createMockSegment(async () => []), // Empty result\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([{ lang: 'en' }])\n     })\n \n@@ -935,7 +935,7 @@ describe('generateRouteStaticParams', () => {\n         ]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([\n         { lang: 'en', category: 'en-tech' },\n         { category: 'default-tech' },\n@@ -951,7 +951,7 @@ describe('generateRouteStaticParams', () => {\n         }),\n       ]\n       const store = createMockWorkStore()\n-      await generateRouteStaticParams(segments, store)\n+      await generateRouteStaticParams(segments, store, false)\n       expect(store.fetchCache).toBe('force-cache')\n     })\n \n@@ -960,7 +960,7 @@ describe('generateRouteStaticParams', () => {\n         createMockSegment(async () => [{ id: '1' }]),\n       ]\n       const store = createMockWorkStore('force-cache')\n-      await generateRouteStaticParams(segments, store)\n+      await generateRouteStaticParams(segments, store, false)\n       expect(store.fetchCache).toBe('force-cache')\n     })\n \n@@ -974,7 +974,7 @@ describe('generateRouteStaticParams', () => {\n         }),\n       ]\n       const store = createMockWorkStore()\n-      await generateRouteStaticParams(segments, store)\n+      await generateRouteStaticParams(segments, store, false)\n       // Should have the last fetchCache value\n       expect(store.fetchCache).toBe('default-cache')\n     })\n@@ -989,7 +989,7 @@ describe('generateRouteStaticParams', () => {\n         ]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([{ slug: ['a', 'b'] }, { slug: ['c', 'd', 'e'] }])\n     })\n \n@@ -1001,7 +1001,7 @@ describe('generateRouteStaticParams', () => {\n         ]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([{ lang: 'en', slug: ['en', 'post'] }])\n     })\n   })\n@@ -1015,7 +1015,7 @@ describe('generateRouteStaticParams', () => {\n         createMockSegment(async ({ params }) => [{ d: `${params?.c}-4` }]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([{ a: '1', b: '1-2', c: '1-2-3', d: '1-2-3-4' }])\n     })\n \n@@ -1026,7 +1026,7 @@ describe('generateRouteStaticParams', () => {\n         createMockSegment(async () => [{ z: 'i' }, { z: 'ii' }]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([\n         { x: '1', y: 'a', z: 'i' },\n         { x: '1', y: 'a', z: 'ii' },\n@@ -1048,9 +1048,9 @@ describe('generateRouteStaticParams', () => {\n         }),\n       ]\n       const store = createMockWorkStore()\n-      await expect(generateRouteStaticParams(segments, store)).rejects.toThrow(\n-        'Test error'\n-      )\n+      await expect(\n+        generateRouteStaticParams(segments, store, false)\n+      ).rejects.toThrow('Test error')\n     })\n \n     it('should handle generateStaticParams returning a rejected promise', async () => {\n@@ -1060,9 +1060,9 @@ describe('generateRouteStaticParams', () => {\n         }),\n       ]\n       const store = createMockWorkStore()\n-      await expect(generateRouteStaticParams(segments, store)).rejects.toThrow(\n-        'Async error'\n-      )\n+      await expect(\n+        generateRouteStaticParams(segments, store, false)\n+      ).rejects.toThrow('Async error')\n     })\n \n     it('should handle partially failing generateStaticParams', async () => {\n@@ -1076,10 +1076,54 @@ describe('generateRouteStaticParams', () => {\n         }),\n       ]\n       const store = createMockWorkStore()\n-      await expect(generateRouteStaticParams(segments, store)).rejects.toThrow(\n-        'Tech not allowed'\n+      await expect(\n+        generateRouteStaticParams(segments, store, false)\n+      ).rejects.toThrow('Tech not allowed')\n+    })\n+\n+    it('should throw error when generateStaticParams returns empty array with isRoutePPREnabled=true', async () => {\n+      const segments: TestAppSegment[] = [\n+        createMockSegment(async () => [{ lang: 'en' }]),\n+        createMockSegment(async () => []), // Empty result\n+      ]\n+      const store = createMockWorkStore()\n+      await expect(\n+        generateRouteStaticParams(segments, store, true)\n+      ).rejects.toThrow(\n+        'When using Cache Components, all `generateStaticParams` functions must return at least one result'\n+      )\n+    })\n+\n+    it('should throw error when first segment returns empty array with isRoutePPREnabled=true', async () => {\n+      const segments: TestAppSegment[] = [\n+        createMockSegment(async () => []), // Empty result at root level\n+      ]\n+      const store = createMockWorkStore()\n+      await expect(\n+        generateRouteStaticParams(segments, store, true)\n+      ).rejects.toThrow(\n+        'When using Cache Components, all `generateStaticParams` functions must return at least one result'\n       )\n     })\n+\n+    it('should NOT throw error when generateStaticParams returns empty array with isRoutePPREnabled=false', async () => {\n+      const segments: TestAppSegment[] = [\n+        createMockSegment(async () => [{ lang: 'en' }]),\n+        createMockSegment(async () => []), // Empty result\n+      ]\n+      const store = createMockWorkStore()\n+      const result = await generateRouteStaticParams(segments, store, false)\n+      expect(result).toEqual([{ lang: 'en' }])\n+    })\n+\n+    it('should NOT throw error when first segment returns empty array with isRoutePPREnabled=false', async () => {\n+      const segments: TestAppSegment[] = [\n+        createMockSegment(async () => []), // Empty result at root level\n+      ]\n+      const store = createMockWorkStore()\n+      const result = await generateRouteStaticParams(segments, store, false)\n+      expect(result).toEqual([])\n+    })\n   })\n \n   describe('Complex real-world scenarios', () => {\n@@ -1100,7 +1144,7 @@ describe('generateRouteStaticParams', () => {\n         ]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toHaveLength(12) // 3 langs × 2 categories × 2 slugs\n       expect(result).toContainEqual({\n         lang: 'en',\n@@ -1132,7 +1176,7 @@ describe('generateRouteStaticParams', () => {\n         ]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toEqual([\n         {\n           category: 'electronics',\n@@ -1167,7 +1211,7 @@ describe('generateRouteStaticParams', () => {\n         ]),\n       ]\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toHaveLength(8) // 2 years × 2 months × 2 slug variations\n       expect(result).toContainEqual({\n         year: '2023',\n@@ -1187,7 +1231,7 @@ describe('generateRouteStaticParams', () => {\n         )\n       }\n       const store = createMockWorkStore()\n-      const result = await generateRouteStaticParams(segments, store)\n+      const result = await generateRouteStaticParams(segments, store, false)\n       expect(result).toHaveLength(1)\n       expect(Object.keys(result[0])).toHaveLength(5000)\n     })"
        },
        {
            "sha": "bdac62c1968fa71cc1c5a3c56bc2f8c4992f9012",
            "filename": "packages/next/src/build/static-paths/app.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 3,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fbuild%2Fstatic-paths%2Fapp.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fbuild%2Fstatic-paths%2Fapp.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fstatic-paths%2Fapp.ts?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -24,6 +24,7 @@ import type { WorkStore } from '../../server/app-render/work-async-storage.exter\n import type { DynamicParamTypes } from '../../shared/lib/app-router-types'\n import { InvariantError } from '../../shared/lib/invariant-error'\n import { getParamProperties } from '../../shared/lib/router/utils/get-segment-param'\n+import { throwEmptyGenerateStaticParamsError } from '../../shared/lib/errors/empty-generate-static-params-error'\n \n /**\n  * Filters out duplicate parameters from a list of parameters.\n@@ -635,7 +636,8 @@ export async function generateRouteStaticParams(\n   segments: ReadonlyArray<\n     Readonly<Pick<AppSegment, 'config' | 'generateStaticParams'>>\n   >,\n-  store: Pick<WorkStore, 'fetchCache'>\n+  store: Pick<WorkStore, 'fetchCache'>,\n+  isRoutePPREnabled: boolean\n ): Promise<Params[]> {\n   // Early return if no segments to process\n   if (segments.length === 0) return []\n@@ -686,6 +688,8 @@ export async function generateRouteStaticParams(\n           for (const item of result) {\n             nextParams.push({ ...parentParams, ...item })\n           }\n+        } else if (isRoutePPREnabled) {\n+          throwEmptyGenerateStaticParamsError()\n         } else {\n           // No results, just pass through parent params\n           nextParams.push(parentParams)\n@@ -694,6 +698,10 @@ export async function generateRouteStaticParams(\n     } else {\n       // No parent params, call generateStaticParams with empty object\n       const result = await current.generateStaticParams({ params: {} })\n+      if (result.length === 0 && isRoutePPREnabled) {\n+        throwEmptyGenerateStaticParamsError()\n+      }\n+\n       nextParams.push(...result)\n     }\n \n@@ -852,8 +860,12 @@ export async function buildAppStaticPaths({\n     previouslyRevalidatedTags: [],\n   })\n \n-  const routeParams = await ComponentMod.workAsyncStorage.run(store, () =>\n-    generateRouteStaticParams(segments, store)\n+  const routeParams = await ComponentMod.workAsyncStorage.run(\n+    store,\n+    generateRouteStaticParams,\n+    segments,\n+    store,\n+    isRoutePPREnabled\n   )\n \n   await afterRunner.executeAfter()"
        },
        {
            "sha": "cef5abe8a839322f11b0b3e5e17d98740a429e87",
            "filename": "packages/next/src/shared/lib/errors/empty-generate-static-params-error.ts",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Ferrors%2Fempty-generate-static-params-error.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Ferrors%2Fempty-generate-static-params-error.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Ferrors%2Fempty-generate-static-params-error.ts?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -0,0 +1,13 @@\n+export function throwEmptyGenerateStaticParamsError(): never {\n+  const error = new Error(\n+    'When using Cache Components, all `generateStaticParams` functions must return at least one result. ' +\n+      'This is to ensure that we can perform build-time validation that there is no other dynamic accesses that would cause a runtime error.\\n\\n' +\n+      'Learn more: https://nextjs.org/docs/messages/empty-generate-static-params'\n+  )\n+  error.name = 'EmptyGenerateStaticParamsError'\n+  // This error is meant to interrupt the server start/build process\n+  // but the stack trace isn't meaningful, as it points to internal code.\n+  error.stack = undefined\n+\n+  throw error\n+}"
        },
        {
            "sha": "de7997b5fcfc4154f63ca70e2914d7f0b4a6d44f",
            "filename": "packages/next/src/shared/lib/errors/missing-default-parallel-route-error.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Ferrors%2Fmissing-default-parallel-route-error.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Ferrors%2Fmissing-default-parallel-route-error.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Ferrors%2Fmissing-default-parallel-route-error.ts?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -1,16 +1,14 @@\n-export class MissingDefaultParallelRouteError extends Error {\n+import { UsageError } from './usage-error'\n+\n+export class MissingDefaultParallelRouteError extends UsageError {\n   constructor(fullSegmentPath: string, slotName: string) {\n     super(\n       `Missing required default.js file for parallel route at ${fullSegmentPath}\\n` +\n         `The parallel route slot \"${slotName}\" is missing a default.js file. When using parallel routes, each slot must have a default.js file to serve as a fallback.\\n\\n` +\n-        `Create a default.js file at: ${fullSegmentPath}/default.js\\n\\n` +\n-        `https://nextjs.org/docs/messages/slot-missing-default`\n+        `Create a default.js file at: ${fullSegmentPath}/default.js`,\n+      'https://nextjs.org/docs/messages/slot-missing-default'\n     )\n \n     this.name = 'MissingDefaultParallelRouteError'\n-\n-    // This error is meant to interrupt the server start/build process\n-    // but the stack trace isn't meaningful, as it points to internal code.\n-    this.stack = undefined\n   }\n }"
        },
        {
            "sha": "d67c9931236483a01fa246cd22b5eb642bbe3a25",
            "filename": "packages/next/src/shared/lib/errors/usage-error.ts",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Ferrors%2Fusage-error.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Ferrors%2Fusage-error.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Ferrors%2Fusage-error.ts?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -0,0 +1,10 @@\n+export class UsageError extends Error {\n+  constructor(message: string, docUrl: string) {\n+    super(`${message}\\n\\nLearn more: ${docUrl}`)\n+    this.name = 'UsageError'\n+\n+    // This error is meant to interrupt the server start/build process\n+    // but the stack trace isn't meaningful, as it points to internal code.\n+    this.stack = undefined\n+  }\n+}"
        },
        {
            "sha": "54f75aca9897a2c59bfdfa83ca23851277e19f01",
            "filename": "test/e2e/app-dir/app-alias/src/app/typing/[slug]/page.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fapp-alias%2Fsrc%2Fapp%2Ftyping%2F%5Bslug%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fapp-alias%2Fsrc%2Fapp%2Ftyping%2F%5Bslug%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-alias%2Fsrc%2Fapp%2Ftyping%2F%5Bslug%5D%2Fpage.tsx?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -8,5 +8,5 @@ export async function generateStaticParams({\n   params: { slug: string }\n }) {\n   console.log(params)\n-  return []\n+  return [{ slug: 'foo' }]\n }"
        },
        {
            "sha": "51f870382ee9a60662ef32cc4b94ed15e9a49a0a",
            "filename": "test/e2e/app-dir/app-catch-all-optional/app/[lang]/[flags]/[[...rest]]/page.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fapp-catch-all-optional%2Fapp%2F%5Blang%5D%2F%5Bflags%5D%2F%5B%5B...rest%5D%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fapp-catch-all-optional%2Fapp%2F%5Blang%5D%2F%5Bflags%5D%2F%5B%5B...rest%5D%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-catch-all-optional%2Fapp%2F%5Blang%5D%2F%5Bflags%5D%2F%5B%5B...rest%5D%5D%2Fpage.tsx?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -1,5 +1,5 @@\n export async function generateStaticParams() {\n-  return []\n+  return [{ lang: 'en', flags: 'us', rest: ['home'] }]\n }\n \n export default async function Page(props) {"
        },
        {
            "sha": "cbca7c233d95c49b64f5ac2bc0ea4d146d604e85",
            "filename": "test/e2e/app-dir/not-found-with-pages-i18n/app/app-dir/[[...slug]]/page.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fnot-found-with-pages-i18n%2Fapp%2Fapp-dir%2F%5B%5B...slug%5D%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fnot-found-with-pages-i18n%2Fapp%2Fapp-dir%2F%5B%5B...slug%5D%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnot-found-with-pages-i18n%2Fapp%2Fapp-dir%2F%5B%5B...slug%5D%5D%2Fpage.tsx?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -1,7 +1,7 @@\n import { notFound } from 'next/navigation'\n \n export async function generateStaticParams() {\n-  return []\n+  return [{ slug: ['about'] }]\n }\n \n async function validateSlug(slug: string[]) {"
        },
        {
            "sha": "dc55ab4a4e54154678ecb049e5a609be73db291b",
            "filename": "test/e2e/app-dir/sub-shell-generation-middleware/app/rewrite/[slug]/page.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fsub-shell-generation-middleware%2Fapp%2Frewrite%2F%5Bslug%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fsub-shell-generation-middleware%2Fapp%2Frewrite%2F%5Bslug%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsub-shell-generation-middleware%2Fapp%2Frewrite%2F%5Bslug%5D%2Fpage.tsx?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -8,5 +8,5 @@ export default async function RewritePage({\n }\n \n export async function generateStaticParams() {\n-  return []\n+  return [{ slug: 'foo' }]\n }"
        },
        {
            "sha": "dfdc54600ed0242a508af17427e6a65bcfbd5a33",
            "filename": "test/e2e/app-dir/sub-shell-generation/app/[lang]/[slug]/page.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fsub-shell-generation%2Fapp%2F%5Blang%5D%2F%5Bslug%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fe2e%2Fapp-dir%2Fsub-shell-generation%2Fapp%2F%5Blang%5D%2F%5Bslug%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsub-shell-generation%2Fapp%2F%5Blang%5D%2F%5Bslug%5D%2Fpage.tsx?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -16,5 +16,5 @@ export default async function Page({\n }\n \n export function generateStaticParams({ params }: { params: { lang: string } }) {\n-  return params.lang === 'fr' ? [{ slug: '1' }] : []\n+  return params.lang === 'fr' ? [{ slug: '1' }] : [{ slug: 'foo' }]\n }"
        },
        {
            "sha": "b4200ed564f985366912a1ce2679a38509308527",
            "filename": "test/production/app-dir/empty-generate-static-params/empty-generate-static-params.test.ts",
            "status": "modified",
            "additions": 33,
            "deletions": 17,
            "changes": 50,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fproduction%2Fapp-dir%2Fempty-generate-static-params%2Fempty-generate-static-params.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fproduction%2Fapp-dir%2Fempty-generate-static-params%2Fempty-generate-static-params.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fempty-generate-static-params%2Fempty-generate-static-params.test.ts?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -4,31 +4,47 @@ import { retry } from 'next-test-utils'\n describe('empty-generate-static-params', () => {\n   const { next, skipped } = nextTestSetup({\n     files: __dirname,\n+    skipStart: true,\n     skipDeployment: true,\n   })\n \n   if (skipped) return\n \n-  it('should mark the page with empty generateStaticParams as SSG in build output', async () => {\n-    const isPPREnabled = process.env.__NEXT_CACHE_COMPONENTS === 'true'\n-    expect(next.cliOutput).toContain(`${isPPREnabled ? '◐' : '●'} /[slug]`)\n-  })\n+  // If we're not using cache components, there shouldn't be any build errors!\n+  if (process.env.__NEXT_CACHE_COMPONENTS !== 'true') {\n+    beforeAll(async () => {\n+      await next.start()\n+    })\n+\n+    it('should mark the page with empty generateStaticParams as SSG in build output', async () => {\n+      const isPPREnabled = process.env.__NEXT_CACHE_COMPONENTS === 'true'\n+      expect(next.cliOutput).toContain(`${isPPREnabled ? '◐' : '●'} /[slug]`)\n+    })\n \n-  it('should be a cache miss on the initial render followed by a HIT after being generated', async () => {\n-    const firstResponse = await next.fetch('/foo')\n-    expect(firstResponse.status).toBe(200)\n+    it('should be a cache miss on the initial render followed by a HIT after being generated', async () => {\n+      const firstResponse = await next.fetch('/foo')\n+      expect(firstResponse.status).toBe(200)\n \n-    // With PPR enabled, the initial request doesn't send back a cache header\n-    const isPPREnabled = process.env.__NEXT_CACHE_COMPONENTS === 'true'\n+      // With PPR enabled, the initial request doesn't send back a cache header\n+      const isPPREnabled = process.env.__NEXT_CACHE_COMPONENTS === 'true'\n \n-    expect(firstResponse.headers.get('x-nextjs-cache')).toBe(\n-      isPPREnabled ? null : 'MISS'\n-    )\n+      expect(firstResponse.headers.get('x-nextjs-cache')).toBe(\n+        isPPREnabled ? null : 'MISS'\n+      )\n \n-    retry(async () => {\n-      const secondResponse = await next.fetch('/foo')\n-      expect(secondResponse.status).toBe(200)\n-      expect(secondResponse.headers.get('x-nextjs-cache')).toBe('HIT')\n+      retry(async () => {\n+        const secondResponse = await next.fetch('/foo')\n+        expect(secondResponse.status).toBe(200)\n+        expect(secondResponse.headers.get('x-nextjs-cache')).toBe('HIT')\n+      })\n     })\n-  })\n+  } else {\n+    it('should throw an error when generateStaticParams returns an empty array', async () => {\n+      await expect(() => next.start()).rejects.toThrow()\n+\n+      expect(next.cliOutput).toContain(\n+        'https://nextjs.org/docs/messages/empty-generate-static-params'\n+      )\n+    })\n+  }\n })"
        },
        {
            "sha": "c87cb2cb19b482481f5f9577e2c605e2e7a71dfd",
            "filename": "test/production/standalone-mode/required-server-files/app/optional-catchall/[lang]/[flags]/[[...slug]]/page.jsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fproduction%2Fstandalone-mode%2Frequired-server-files%2Fapp%2Foptional-catchall%2F%5Blang%5D%2F%5Bflags%5D%2F%5B%5B...slug%5D%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3cd8a234464f761f26c45a955da3cbd373e0f198/test%2Fproduction%2Fstandalone-mode%2Frequired-server-files%2Fapp%2Foptional-catchall%2F%5Blang%5D%2F%5Bflags%5D%2F%5B%5B...slug%5D%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fstandalone-mode%2Frequired-server-files%2Fapp%2Foptional-catchall%2F%5Blang%5D%2F%5Bflags%5D%2F%5B%5B...slug%5D%5D%2Fpage.jsx?ref=3cd8a234464f761f26c45a955da3cbd373e0f198",
            "patch": "@@ -1,5 +1,5 @@\n export async function generateStaticParams() {\n-  return []\n+  return [{ lang: 'en', flags: 'us', slug: ['home'] }]\n }\n \n export default async function Page(props) {"
        }
    ],
    "stats": {
        "total": 287,
        "additions": 225,
        "deletions": 62
    }
}