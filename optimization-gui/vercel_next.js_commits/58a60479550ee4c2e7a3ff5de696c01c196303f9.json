{
    "author": "gaojude",
    "message": "Feat: Add Model Context Protocol (MCP) server to Next.js dev server (#84100)\n\nThis PR integrates an MCP server into the Next.js development server at\n`/_next/mcp`, enabling AI agents to programmatically interact with\nNext.js projects. We're including an initial `get_project_path.` tool as\nan example that returns the project's absolute path - this serves as a\nstarting point to demonstrate how tools can expose project information\nto MCP clients, with plans to expand the available tools for richer\nAI-assisted development experiences.",
    "sha": "58a60479550ee4c2e7a3ff5de696c01c196303f9",
    "files": [
        {
            "sha": "4757cc63855f520263d8a59ac5861eedb5b9b2ce",
            "filename": "packages/next/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fpackage.json?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -164,6 +164,7 @@\n     \"@hapi/accept\": \"5.0.2\",\n     \"@jest/transform\": \"29.5.0\",\n     \"@jest/types\": \"29.5.0\",\n+    \"@modelcontextprotocol/sdk\": \"1.18.1\",\n     \"@mswjs/interceptors\": \"0.23.0\",\n     \"@napi-rs/triples\": \"1.2.0\",\n     \"@next/font\": \"15.6.0-canary.23\","
        },
        {
            "sha": "e9d3f92484ce68092596c7db1bb165ff64088ed1",
            "filename": "packages/next/src/compiled/@modelcontextprotocol/sdk/server/mcp.js",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fcompiled%2F%40modelcontextprotocol%2Fsdk%2Fserver%2Fmcp.js",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fcompiled%2F%40modelcontextprotocol%2Fsdk%2Fserver%2Fmcp.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2F%40modelcontextprotocol%2Fsdk%2Fserver%2Fmcp.js?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9"
        },
        {
            "sha": "a4a6667cdfda789c091fff95af5bc72a4f47a362",
            "filename": "packages/next/src/compiled/@modelcontextprotocol/sdk/server/streamableHttp.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fcompiled%2F%40modelcontextprotocol%2Fsdk%2Fserver%2FstreamableHttp.js",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fcompiled%2F%40modelcontextprotocol%2Fsdk%2Fserver%2FstreamableHttp.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2F%40modelcontextprotocol%2Fsdk%2Fserver%2FstreamableHttp.js?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -0,0 +1 @@\n+(()=>{\"use strict\";var e={142:e=>{e.exports=require(\"next/dist/compiled/content-type\")},238:e=>{e.exports=require(\"next/dist/compiled/raw-body\")},788:e=>{e.exports=require(\"next/dist/compiled/zod\")},5:e=>{e.exports=require(\"node:crypto\")},685:function(e,t,s){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,\"__esModule\",{value:true});t.StreamableHTTPServerTransport=void 0;const a=s(383);const i=o(s(238));const n=o(s(142));const r=s(5);const c=\"4mb\";class StreamableHTTPServerTransport{constructor(e){var t,s;this._started=false;this._streamMapping=new Map;this._requestToStreamMapping=new Map;this._requestResponseMap=new Map;this._initialized=false;this._enableJsonResponse=false;this._standaloneSseStreamId=\"_GET_stream\";this.sessionIdGenerator=e.sessionIdGenerator;this._enableJsonResponse=(t=e.enableJsonResponse)!==null&&t!==void 0?t:false;this._eventStore=e.eventStore;this._onsessioninitialized=e.onsessioninitialized;this._onsessionclosed=e.onsessionclosed;this._allowedHosts=e.allowedHosts;this._allowedOrigins=e.allowedOrigins;this._enableDnsRebindingProtection=(s=e.enableDnsRebindingProtection)!==null&&s!==void 0?s:false}async start(){if(this._started){throw new Error(\"Transport already started\")}this._started=true}validateRequestHeaders(e){if(!this._enableDnsRebindingProtection){return undefined}if(this._allowedHosts&&this._allowedHosts.length>0){const t=e.headers.host;if(!t||!this._allowedHosts.includes(t)){return`Invalid Host header: ${t}`}}if(this._allowedOrigins&&this._allowedOrigins.length>0){const t=e.headers.origin;if(!t||!this._allowedOrigins.includes(t)){return`Invalid Origin header: ${t}`}}return undefined}async handleRequest(e,t,s){var o;const a=this.validateRequestHeaders(e);if(a){t.writeHead(403).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:a},id:null}));(o=this.onerror)===null||o===void 0?void 0:o.call(this,new Error(a));return}if(e.method===\"POST\"){await this.handlePostRequest(e,t,s)}else if(e.method===\"GET\"){await this.handleGetRequest(e,t)}else if(e.method===\"DELETE\"){await this.handleDeleteRequest(e,t)}else{await this.handleUnsupportedRequest(t)}}async handleGetRequest(e,t){const s=e.headers.accept;if(!(s===null||s===void 0?void 0:s.includes(\"text/event-stream\"))){t.writeHead(406).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:\"Not Acceptable: Client must accept text/event-stream\"},id:null}));return}if(!this.validateSession(e,t)){return}if(!this.validateProtocolVersion(e,t)){return}if(this._eventStore){const s=e.headers[\"last-event-id\"];if(s){await this.replayEvents(s,t);return}}const o={\"Content-Type\":\"text/event-stream\",\"Cache-Control\":\"no-cache, no-transform\",Connection:\"keep-alive\"};if(this.sessionId!==undefined){o[\"mcp-session-id\"]=this.sessionId}if(this._streamMapping.get(this._standaloneSseStreamId)!==undefined){t.writeHead(409).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:\"Conflict: Only one SSE stream is allowed per session\"},id:null}));return}t.writeHead(200,o).flushHeaders();this._streamMapping.set(this._standaloneSseStreamId,t);t.on(\"close\",(()=>{this._streamMapping.delete(this._standaloneSseStreamId)}));t.on(\"error\",(e=>{var t;(t=this.onerror)===null||t===void 0?void 0:t.call(this,e)}))}async replayEvents(e,t){var s,o;if(!this._eventStore){return}try{const o={\"Content-Type\":\"text/event-stream\",\"Cache-Control\":\"no-cache, no-transform\",Connection:\"keep-alive\"};if(this.sessionId!==undefined){o[\"mcp-session-id\"]=this.sessionId}t.writeHead(200,o).flushHeaders();const a=await((s=this._eventStore)===null||s===void 0?void 0:s.replayEventsAfter(e,{send:async(e,s)=>{var o;if(!this.writeSSEEvent(t,s,e)){(o=this.onerror)===null||o===void 0?void 0:o.call(this,new Error(\"Failed replay events\"));t.end()}}}));this._streamMapping.set(a,t);t.on(\"error\",(e=>{var t;(t=this.onerror)===null||t===void 0?void 0:t.call(this,e)}))}catch(e){(o=this.onerror)===null||o===void 0?void 0:o.call(this,e)}}writeSSEEvent(e,t,s){let o=`event: message\\n`;if(s){o+=`id: ${s}\\n`}o+=`data: ${JSON.stringify(t)}\\n\\n`;return e.write(o)}async handleUnsupportedRequest(e){e.writeHead(405,{Allow:\"GET, POST, DELETE\"}).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:\"Method not allowed.\"},id:null}))}async handlePostRequest(e,t,s){var o,l,h,m,u;try{const u=e.headers.accept;if(!(u===null||u===void 0?void 0:u.includes(\"application/json\"))||!u.includes(\"text/event-stream\")){t.writeHead(406).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:\"Not Acceptable: Client must accept both application/json and text/event-stream\"},id:null}));return}const d=e.headers[\"content-type\"];if(!d||!d.includes(\"application/json\")){t.writeHead(415).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:\"Unsupported Media Type: Content-Type must be application/json\"},id:null}));return}const S=e.auth;const p={headers:e.headers};let z;if(s!==undefined){z=s}else{const t=n.default.parse(d);const s=await(0,i.default)(e,{limit:c,encoding:(o=t.parameters.charset)!==null&&o!==void 0?o:\"utf-8\"});z=JSON.parse(s.toString())}let R;if(Array.isArray(z)){R=z.map((e=>a.JSONRPCMessageSchema.parse(e)))}else{R=[a.JSONRPCMessageSchema.parse(z)]}const g=R.some(a.isInitializeRequest);if(g){if(this._initialized&&this.sessionId!==undefined){t.writeHead(400).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32600,message:\"Invalid Request: Server already initialized\"},id:null}));return}if(R.length>1){t.writeHead(400).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32600,message:\"Invalid Request: Only one initialization request is allowed\"},id:null}));return}this.sessionId=(l=this.sessionIdGenerator)===null||l===void 0?void 0:l.call(this);this._initialized=true;if(this.sessionId&&this._onsessioninitialized){await Promise.resolve(this._onsessioninitialized(this.sessionId))}}if(!g){if(!this.validateSession(e,t)){return}if(!this.validateProtocolVersion(e,t)){return}}const f=R.some(a.isJSONRPCRequest);if(!f){t.writeHead(202).end();for(const e of R){(h=this.onmessage)===null||h===void 0?void 0:h.call(this,e,{authInfo:S,requestInfo:p})}}else if(f){const e=(0,r.randomUUID)();if(!this._enableJsonResponse){const e={\"Content-Type\":\"text/event-stream\",\"Cache-Control\":\"no-cache\",Connection:\"keep-alive\"};if(this.sessionId!==undefined){e[\"mcp-session-id\"]=this.sessionId}t.writeHead(200,e)}for(const s of R){if((0,a.isJSONRPCRequest)(s)){this._streamMapping.set(e,t);this._requestToStreamMapping.set(s.id,e)}}t.on(\"close\",(()=>{this._streamMapping.delete(e)}));t.on(\"error\",(e=>{var t;(t=this.onerror)===null||t===void 0?void 0:t.call(this,e)}));for(const e of R){(m=this.onmessage)===null||m===void 0?void 0:m.call(this,e,{authInfo:S,requestInfo:p})}}}catch(e){t.writeHead(400).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32700,message:\"Parse error\",data:String(e)},id:null}));(u=this.onerror)===null||u===void 0?void 0:u.call(this,e)}}async handleDeleteRequest(e,t){var s;if(!this.validateSession(e,t)){return}if(!this.validateProtocolVersion(e,t)){return}await Promise.resolve((s=this._onsessionclosed)===null||s===void 0?void 0:s.call(this,this.sessionId));await this.close();t.writeHead(200).end()}validateSession(e,t){if(this.sessionIdGenerator===undefined){return true}if(!this._initialized){t.writeHead(400).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:\"Bad Request: Server not initialized\"},id:null}));return false}const s=e.headers[\"mcp-session-id\"];if(!s){t.writeHead(400).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:\"Bad Request: Mcp-Session-Id header is required\"},id:null}));return false}else if(Array.isArray(s)){t.writeHead(400).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:\"Bad Request: Mcp-Session-Id header must be a single value\"},id:null}));return false}else if(s!==this.sessionId){t.writeHead(404).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32001,message:\"Session not found\"},id:null}));return false}return true}validateProtocolVersion(e,t){var s;let o=(s=e.headers[\"mcp-protocol-version\"])!==null&&s!==void 0?s:a.DEFAULT_NEGOTIATED_PROTOCOL_VERSION;if(Array.isArray(o)){o=o[o.length-1]}if(!a.SUPPORTED_PROTOCOL_VERSIONS.includes(o)){t.writeHead(400).end(JSON.stringify({jsonrpc:\"2.0\",error:{code:-32e3,message:`Bad Request: Unsupported protocol version (supported versions: ${a.SUPPORTED_PROTOCOL_VERSIONS.join(\", \")})`},id:null}));return false}return true}async close(){var e;this._streamMapping.forEach((e=>{e.end()}));this._streamMapping.clear();this._requestResponseMap.clear();(e=this.onclose)===null||e===void 0?void 0:e.call(this)}async send(e,t){let s=t===null||t===void 0?void 0:t.relatedRequestId;if((0,a.isJSONRPCResponse)(e)||(0,a.isJSONRPCError)(e)){s=e.id}if(s===undefined){if((0,a.isJSONRPCResponse)(e)||(0,a.isJSONRPCError)(e)){throw new Error(\"Cannot send a response on a standalone SSE stream unless resuming a previous client request\")}const t=this._streamMapping.get(this._standaloneSseStreamId);if(t===undefined){return}let s;if(this._eventStore){s=await this._eventStore.storeEvent(this._standaloneSseStreamId,e)}this.writeSSEEvent(t,e,s);return}const o=this._requestToStreamMapping.get(s);const i=this._streamMapping.get(o);if(!o){throw new Error(`No connection established for request ID: ${String(s)}`)}if(!this._enableJsonResponse){let t;if(this._eventStore){t=await this._eventStore.storeEvent(o,e)}if(i){this.writeSSEEvent(i,e,t)}}if((0,a.isJSONRPCResponse)(e)||(0,a.isJSONRPCError)(e)){this._requestResponseMap.set(s,e);const t=Array.from(this._requestToStreamMapping.entries()).filter((([e,t])=>this._streamMapping.get(t)===i)).map((([e])=>e));const o=t.every((e=>this._requestResponseMap.has(e)));if(o){if(!i){throw new Error(`No connection established for request ID: ${String(s)}`)}if(this._enableJsonResponse){const e={\"Content-Type\":\"application/json\"};if(this.sessionId!==undefined){e[\"mcp-session-id\"]=this.sessionId}const s=t.map((e=>this._requestResponseMap.get(e)));i.writeHead(200,e);if(s.length===1){i.end(JSON.stringify(s[0]))}else{i.end(JSON.stringify(s))}}else{i.end()}for(const e of t){this._requestResponseMap.delete(e);this._requestToStreamMapping.delete(e)}}}}}t.StreamableHTTPServerTransport=StreamableHTTPServerTransport},383:(e,t,s)=>{Object.defineProperty(t,\"__esModule\",{value:true});t.SubscribeRequestSchema=t.ResourceListChangedNotificationSchema=t.ReadResourceResultSchema=t.ReadResourceRequestSchema=t.ListResourceTemplatesResultSchema=t.ListResourceTemplatesRequestSchema=t.ListResourcesResultSchema=t.ListResourcesRequestSchema=t.ResourceTemplateSchema=t.ResourceSchema=t.BlobResourceContentsSchema=t.TextResourceContentsSchema=t.ResourceContentsSchema=t.PaginatedResultSchema=t.PaginatedRequestSchema=t.ProgressNotificationSchema=t.ProgressSchema=t.PingRequestSchema=t.isInitializedNotification=t.InitializedNotificationSchema=t.InitializeResultSchema=t.ServerCapabilitiesSchema=t.isInitializeRequest=t.InitializeRequestSchema=t.ClientCapabilitiesSchema=t.ImplementationSchema=t.BaseMetadataSchema=t.IconSchema=t.CancelledNotificationSchema=t.EmptyResultSchema=t.JSONRPCMessageSchema=t.isJSONRPCError=t.JSONRPCErrorSchema=t.ErrorCode=t.isJSONRPCResponse=t.JSONRPCResponseSchema=t.isJSONRPCNotification=t.JSONRPCNotificationSchema=t.isJSONRPCRequest=t.JSONRPCRequestSchema=t.RequestIdSchema=t.ResultSchema=t.NotificationSchema=t.RequestSchema=t.CursorSchema=t.ProgressTokenSchema=t.JSONRPC_VERSION=t.SUPPORTED_PROTOCOL_VERSIONS=t.DEFAULT_NEGOTIATED_PROTOCOL_VERSION=t.LATEST_PROTOCOL_VERSION=void 0;t.ClientNotificationSchema=t.ClientRequestSchema=t.RootsListChangedNotificationSchema=t.ListRootsResultSchema=t.ListRootsRequestSchema=t.RootSchema=t.CompleteResultSchema=t.CompleteRequestSchema=t.PromptReferenceSchema=t.ResourceReferenceSchema=t.ResourceTemplateReferenceSchema=t.ElicitResultSchema=t.ElicitRequestSchema=t.PrimitiveSchemaDefinitionSchema=t.EnumSchemaSchema=t.NumberSchemaSchema=t.StringSchemaSchema=t.BooleanSchemaSchema=t.CreateMessageResultSchema=t.CreateMessageRequestSchema=t.SamplingMessageSchema=t.ModelPreferencesSchema=t.ModelHintSchema=t.LoggingMessageNotificationSchema=t.SetLevelRequestSchema=t.LoggingLevelSchema=t.ToolListChangedNotificationSchema=t.CallToolRequestSchema=t.CompatibilityCallToolResultSchema=t.CallToolResultSchema=t.ListToolsResultSchema=t.ListToolsRequestSchema=t.ToolSchema=t.ToolAnnotationsSchema=t.PromptListChangedNotificationSchema=t.GetPromptResultSchema=t.PromptMessageSchema=t.ContentBlockSchema=t.ResourceLinkSchema=t.EmbeddedResourceSchema=t.AudioContentSchema=t.ImageContentSchema=t.TextContentSchema=t.GetPromptRequestSchema=t.ListPromptsResultSchema=t.ListPromptsRequestSchema=t.PromptSchema=t.PromptArgumentSchema=t.ResourceUpdatedNotificationSchema=t.UnsubscribeRequestSchema=void 0;t.McpError=t.ServerResultSchema=t.ServerNotificationSchema=t.ServerRequestSchema=t.ClientResultSchema=void 0;const o=s(788);t.LATEST_PROTOCOL_VERSION=\"2025-06-18\";t.DEFAULT_NEGOTIATED_PROTOCOL_VERSION=\"2025-03-26\";t.SUPPORTED_PROTOCOL_VERSIONS=[t.LATEST_PROTOCOL_VERSION,\"2025-03-26\",\"2024-11-05\",\"2024-10-07\"];t.JSONRPC_VERSION=\"2.0\";t.ProgressTokenSchema=o.z.union([o.z.string(),o.z.number().int()]);t.CursorSchema=o.z.string();const a=o.z.object({progressToken:o.z.optional(t.ProgressTokenSchema)}).passthrough();const i=o.z.object({_meta:o.z.optional(a)}).passthrough();t.RequestSchema=o.z.object({method:o.z.string(),params:o.z.optional(i)});const n=o.z.object({_meta:o.z.optional(o.z.object({}).passthrough())}).passthrough();t.NotificationSchema=o.z.object({method:o.z.string(),params:o.z.optional(n)});t.ResultSchema=o.z.object({_meta:o.z.optional(o.z.object({}).passthrough())}).passthrough();t.RequestIdSchema=o.z.union([o.z.string(),o.z.number().int()]);t.JSONRPCRequestSchema=o.z.object({jsonrpc:o.z.literal(t.JSONRPC_VERSION),id:t.RequestIdSchema}).merge(t.RequestSchema).strict();const isJSONRPCRequest=e=>t.JSONRPCRequestSchema.safeParse(e).success;t.isJSONRPCRequest=isJSONRPCRequest;t.JSONRPCNotificationSchema=o.z.object({jsonrpc:o.z.literal(t.JSONRPC_VERSION)}).merge(t.NotificationSchema).strict();const isJSONRPCNotification=e=>t.JSONRPCNotificationSchema.safeParse(e).success;t.isJSONRPCNotification=isJSONRPCNotification;t.JSONRPCResponseSchema=o.z.object({jsonrpc:o.z.literal(t.JSONRPC_VERSION),id:t.RequestIdSchema,result:t.ResultSchema}).strict();const isJSONRPCResponse=e=>t.JSONRPCResponseSchema.safeParse(e).success;t.isJSONRPCResponse=isJSONRPCResponse;var r;(function(e){e[e[\"ConnectionClosed\"]=-32e3]=\"ConnectionClosed\";e[e[\"RequestTimeout\"]=-32001]=\"RequestTimeout\";e[e[\"ParseError\"]=-32700]=\"ParseError\";e[e[\"InvalidRequest\"]=-32600]=\"InvalidRequest\";e[e[\"MethodNotFound\"]=-32601]=\"MethodNotFound\";e[e[\"InvalidParams\"]=-32602]=\"InvalidParams\";e[e[\"InternalError\"]=-32603]=\"InternalError\"})(r||(t.ErrorCode=r={}));t.JSONRPCErrorSchema=o.z.object({jsonrpc:o.z.literal(t.JSONRPC_VERSION),id:t.RequestIdSchema,error:o.z.object({code:o.z.number().int(),message:o.z.string(),data:o.z.optional(o.z.unknown())})}).strict();const isJSONRPCError=e=>t.JSONRPCErrorSchema.safeParse(e).success;t.isJSONRPCError=isJSONRPCError;t.JSONRPCMessageSchema=o.z.union([t.JSONRPCRequestSchema,t.JSONRPCNotificationSchema,t.JSONRPCResponseSchema,t.JSONRPCErrorSchema]);t.EmptyResultSchema=t.ResultSchema.strict();t.CancelledNotificationSchema=t.NotificationSchema.extend({method:o.z.literal(\"notifications/cancelled\"),params:n.extend({requestId:t.RequestIdSchema,reason:o.z.string().optional()})});t.IconSchema=o.z.object({src:o.z.string(),mimeType:o.z.optional(o.z.string()),sizes:o.z.optional(o.z.string())}).passthrough();t.BaseMetadataSchema=o.z.object({name:o.z.string(),title:o.z.optional(o.z.string())}).passthrough();t.ImplementationSchema=t.BaseMetadataSchema.extend({version:o.z.string(),websiteUrl:o.z.optional(o.z.string()),icons:o.z.optional(o.z.array(t.IconSchema))});t.ClientCapabilitiesSchema=o.z.object({experimental:o.z.optional(o.z.object({}).passthrough()),sampling:o.z.optional(o.z.object({}).passthrough()),elicitation:o.z.optional(o.z.object({}).passthrough()),roots:o.z.optional(o.z.object({listChanged:o.z.optional(o.z.boolean())}).passthrough())}).passthrough();t.InitializeRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"initialize\"),params:i.extend({protocolVersion:o.z.string(),capabilities:t.ClientCapabilitiesSchema,clientInfo:t.ImplementationSchema})});const isInitializeRequest=e=>t.InitializeRequestSchema.safeParse(e).success;t.isInitializeRequest=isInitializeRequest;t.ServerCapabilitiesSchema=o.z.object({experimental:o.z.optional(o.z.object({}).passthrough()),logging:o.z.optional(o.z.object({}).passthrough()),completions:o.z.optional(o.z.object({}).passthrough()),prompts:o.z.optional(o.z.object({listChanged:o.z.optional(o.z.boolean())}).passthrough()),resources:o.z.optional(o.z.object({subscribe:o.z.optional(o.z.boolean()),listChanged:o.z.optional(o.z.boolean())}).passthrough()),tools:o.z.optional(o.z.object({listChanged:o.z.optional(o.z.boolean())}).passthrough())}).passthrough();t.InitializeResultSchema=t.ResultSchema.extend({protocolVersion:o.z.string(),capabilities:t.ServerCapabilitiesSchema,serverInfo:t.ImplementationSchema,instructions:o.z.optional(o.z.string())});t.InitializedNotificationSchema=t.NotificationSchema.extend({method:o.z.literal(\"notifications/initialized\")});const isInitializedNotification=e=>t.InitializedNotificationSchema.safeParse(e).success;t.isInitializedNotification=isInitializedNotification;t.PingRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"ping\")});t.ProgressSchema=o.z.object({progress:o.z.number(),total:o.z.optional(o.z.number()),message:o.z.optional(o.z.string())}).passthrough();t.ProgressNotificationSchema=t.NotificationSchema.extend({method:o.z.literal(\"notifications/progress\"),params:n.merge(t.ProgressSchema).extend({progressToken:t.ProgressTokenSchema})});t.PaginatedRequestSchema=t.RequestSchema.extend({params:i.extend({cursor:o.z.optional(t.CursorSchema)}).optional()});t.PaginatedResultSchema=t.ResultSchema.extend({nextCursor:o.z.optional(t.CursorSchema)});t.ResourceContentsSchema=o.z.object({uri:o.z.string(),mimeType:o.z.optional(o.z.string()),_meta:o.z.optional(o.z.object({}).passthrough())}).passthrough();t.TextResourceContentsSchema=t.ResourceContentsSchema.extend({text:o.z.string()});const c=o.z.string().refine((e=>{try{atob(e);return true}catch(e){return false}}),{message:\"Invalid Base64 string\"});t.BlobResourceContentsSchema=t.ResourceContentsSchema.extend({blob:c});t.ResourceSchema=t.BaseMetadataSchema.extend({uri:o.z.string(),description:o.z.optional(o.z.string()),mimeType:o.z.optional(o.z.string()),icons:o.z.optional(o.z.array(t.IconSchema)),_meta:o.z.optional(o.z.object({}).passthrough())});t.ResourceTemplateSchema=t.BaseMetadataSchema.extend({uriTemplate:o.z.string(),description:o.z.optional(o.z.string()),mimeType:o.z.optional(o.z.string()),_meta:o.z.optional(o.z.object({}).passthrough())});t.ListResourcesRequestSchema=t.PaginatedRequestSchema.extend({method:o.z.literal(\"resources/list\")});t.ListResourcesResultSchema=t.PaginatedResultSchema.extend({resources:o.z.array(t.ResourceSchema)});t.ListResourceTemplatesRequestSchema=t.PaginatedRequestSchema.extend({method:o.z.literal(\"resources/templates/list\")});t.ListResourceTemplatesResultSchema=t.PaginatedResultSchema.extend({resourceTemplates:o.z.array(t.ResourceTemplateSchema)});t.ReadResourceRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"resources/read\"),params:i.extend({uri:o.z.string()})});t.ReadResourceResultSchema=t.ResultSchema.extend({contents:o.z.array(o.z.union([t.TextResourceContentsSchema,t.BlobResourceContentsSchema]))});t.ResourceListChangedNotificationSchema=t.NotificationSchema.extend({method:o.z.literal(\"notifications/resources/list_changed\")});t.SubscribeRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"resources/subscribe\"),params:i.extend({uri:o.z.string()})});t.UnsubscribeRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"resources/unsubscribe\"),params:i.extend({uri:o.z.string()})});t.ResourceUpdatedNotificationSchema=t.NotificationSchema.extend({method:o.z.literal(\"notifications/resources/updated\"),params:n.extend({uri:o.z.string()})});t.PromptArgumentSchema=o.z.object({name:o.z.string(),description:o.z.optional(o.z.string()),required:o.z.optional(o.z.boolean())}).passthrough();t.PromptSchema=t.BaseMetadataSchema.extend({description:o.z.optional(o.z.string()),arguments:o.z.optional(o.z.array(t.PromptArgumentSchema)),icons:o.z.optional(o.z.array(t.IconSchema)),_meta:o.z.optional(o.z.object({}).passthrough())});t.ListPromptsRequestSchema=t.PaginatedRequestSchema.extend({method:o.z.literal(\"prompts/list\")});t.ListPromptsResultSchema=t.PaginatedResultSchema.extend({prompts:o.z.array(t.PromptSchema)});t.GetPromptRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"prompts/get\"),params:i.extend({name:o.z.string(),arguments:o.z.optional(o.z.record(o.z.string()))})});t.TextContentSchema=o.z.object({type:o.z.literal(\"text\"),text:o.z.string(),_meta:o.z.optional(o.z.object({}).passthrough())}).passthrough();t.ImageContentSchema=o.z.object({type:o.z.literal(\"image\"),data:c,mimeType:o.z.string(),_meta:o.z.optional(o.z.object({}).passthrough())}).passthrough();t.AudioContentSchema=o.z.object({type:o.z.literal(\"audio\"),data:c,mimeType:o.z.string(),_meta:o.z.optional(o.z.object({}).passthrough())}).passthrough();t.EmbeddedResourceSchema=o.z.object({type:o.z.literal(\"resource\"),resource:o.z.union([t.TextResourceContentsSchema,t.BlobResourceContentsSchema]),_meta:o.z.optional(o.z.object({}).passthrough())}).passthrough();t.ResourceLinkSchema=t.ResourceSchema.extend({type:o.z.literal(\"resource_link\")});t.ContentBlockSchema=o.z.union([t.TextContentSchema,t.ImageContentSchema,t.AudioContentSchema,t.ResourceLinkSchema,t.EmbeddedResourceSchema]);t.PromptMessageSchema=o.z.object({role:o.z.enum([\"user\",\"assistant\"]),content:t.ContentBlockSchema}).passthrough();t.GetPromptResultSchema=t.ResultSchema.extend({description:o.z.optional(o.z.string()),messages:o.z.array(t.PromptMessageSchema)});t.PromptListChangedNotificationSchema=t.NotificationSchema.extend({method:o.z.literal(\"notifications/prompts/list_changed\")});t.ToolAnnotationsSchema=o.z.object({title:o.z.optional(o.z.string()),readOnlyHint:o.z.optional(o.z.boolean()),destructiveHint:o.z.optional(o.z.boolean()),idempotentHint:o.z.optional(o.z.boolean()),openWorldHint:o.z.optional(o.z.boolean())}).passthrough();t.ToolSchema=t.BaseMetadataSchema.extend({description:o.z.optional(o.z.string()),inputSchema:o.z.object({type:o.z.literal(\"object\"),properties:o.z.optional(o.z.object({}).passthrough()),required:o.z.optional(o.z.array(o.z.string()))}).passthrough(),outputSchema:o.z.optional(o.z.object({type:o.z.literal(\"object\"),properties:o.z.optional(o.z.object({}).passthrough()),required:o.z.optional(o.z.array(o.z.string()))}).passthrough()),annotations:o.z.optional(t.ToolAnnotationsSchema),icons:o.z.optional(o.z.array(t.IconSchema)),_meta:o.z.optional(o.z.object({}).passthrough())});t.ListToolsRequestSchema=t.PaginatedRequestSchema.extend({method:o.z.literal(\"tools/list\")});t.ListToolsResultSchema=t.PaginatedResultSchema.extend({tools:o.z.array(t.ToolSchema)});t.CallToolResultSchema=t.ResultSchema.extend({content:o.z.array(t.ContentBlockSchema).default([]),structuredContent:o.z.object({}).passthrough().optional(),isError:o.z.optional(o.z.boolean())});t.CompatibilityCallToolResultSchema=t.CallToolResultSchema.or(t.ResultSchema.extend({toolResult:o.z.unknown()}));t.CallToolRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"tools/call\"),params:i.extend({name:o.z.string(),arguments:o.z.optional(o.z.record(o.z.unknown()))})});t.ToolListChangedNotificationSchema=t.NotificationSchema.extend({method:o.z.literal(\"notifications/tools/list_changed\")});t.LoggingLevelSchema=o.z.enum([\"debug\",\"info\",\"notice\",\"warning\",\"error\",\"critical\",\"alert\",\"emergency\"]);t.SetLevelRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"logging/setLevel\"),params:i.extend({level:t.LoggingLevelSchema})});t.LoggingMessageNotificationSchema=t.NotificationSchema.extend({method:o.z.literal(\"notifications/message\"),params:n.extend({level:t.LoggingLevelSchema,logger:o.z.optional(o.z.string()),data:o.z.unknown()})});t.ModelHintSchema=o.z.object({name:o.z.string().optional()}).passthrough();t.ModelPreferencesSchema=o.z.object({hints:o.z.optional(o.z.array(t.ModelHintSchema)),costPriority:o.z.optional(o.z.number().min(0).max(1)),speedPriority:o.z.optional(o.z.number().min(0).max(1)),intelligencePriority:o.z.optional(o.z.number().min(0).max(1))}).passthrough();t.SamplingMessageSchema=o.z.object({role:o.z.enum([\"user\",\"assistant\"]),content:o.z.union([t.TextContentSchema,t.ImageContentSchema,t.AudioContentSchema])}).passthrough();t.CreateMessageRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"sampling/createMessage\"),params:i.extend({messages:o.z.array(t.SamplingMessageSchema),systemPrompt:o.z.optional(o.z.string()),includeContext:o.z.optional(o.z.enum([\"none\",\"thisServer\",\"allServers\"])),temperature:o.z.optional(o.z.number()),maxTokens:o.z.number().int(),stopSequences:o.z.optional(o.z.array(o.z.string())),metadata:o.z.optional(o.z.object({}).passthrough()),modelPreferences:o.z.optional(t.ModelPreferencesSchema)})});t.CreateMessageResultSchema=t.ResultSchema.extend({model:o.z.string(),stopReason:o.z.optional(o.z.enum([\"endTurn\",\"stopSequence\",\"maxTokens\"]).or(o.z.string())),role:o.z.enum([\"user\",\"assistant\"]),content:o.z.discriminatedUnion(\"type\",[t.TextContentSchema,t.ImageContentSchema,t.AudioContentSchema])});t.BooleanSchemaSchema=o.z.object({type:o.z.literal(\"boolean\"),title:o.z.optional(o.z.string()),description:o.z.optional(o.z.string()),default:o.z.optional(o.z.boolean())}).passthrough();t.StringSchemaSchema=o.z.object({type:o.z.literal(\"string\"),title:o.z.optional(o.z.string()),description:o.z.optional(o.z.string()),minLength:o.z.optional(o.z.number()),maxLength:o.z.optional(o.z.number()),format:o.z.optional(o.z.enum([\"email\",\"uri\",\"date\",\"date-time\"]))}).passthrough();t.NumberSchemaSchema=o.z.object({type:o.z.enum([\"number\",\"integer\"]),title:o.z.optional(o.z.string()),description:o.z.optional(o.z.string()),minimum:o.z.optional(o.z.number()),maximum:o.z.optional(o.z.number())}).passthrough();t.EnumSchemaSchema=o.z.object({type:o.z.literal(\"string\"),title:o.z.optional(o.z.string()),description:o.z.optional(o.z.string()),enum:o.z.array(o.z.string()),enumNames:o.z.optional(o.z.array(o.z.string()))}).passthrough();t.PrimitiveSchemaDefinitionSchema=o.z.union([t.BooleanSchemaSchema,t.StringSchemaSchema,t.NumberSchemaSchema,t.EnumSchemaSchema]);t.ElicitRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"elicitation/create\"),params:i.extend({message:o.z.string(),requestedSchema:o.z.object({type:o.z.literal(\"object\"),properties:o.z.record(o.z.string(),t.PrimitiveSchemaDefinitionSchema),required:o.z.optional(o.z.array(o.z.string()))}).passthrough()})});t.ElicitResultSchema=t.ResultSchema.extend({action:o.z.enum([\"accept\",\"decline\",\"cancel\"]),content:o.z.optional(o.z.record(o.z.string(),o.z.unknown()))});t.ResourceTemplateReferenceSchema=o.z.object({type:o.z.literal(\"ref/resource\"),uri:o.z.string()}).passthrough();t.ResourceReferenceSchema=t.ResourceTemplateReferenceSchema;t.PromptReferenceSchema=o.z.object({type:o.z.literal(\"ref/prompt\"),name:o.z.string()}).passthrough();t.CompleteRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"completion/complete\"),params:i.extend({ref:o.z.union([t.PromptReferenceSchema,t.ResourceTemplateReferenceSchema]),argument:o.z.object({name:o.z.string(),value:o.z.string()}).passthrough(),context:o.z.optional(o.z.object({arguments:o.z.optional(o.z.record(o.z.string(),o.z.string()))}))})});t.CompleteResultSchema=t.ResultSchema.extend({completion:o.z.object({values:o.z.array(o.z.string()).max(100),total:o.z.optional(o.z.number().int()),hasMore:o.z.optional(o.z.boolean())}).passthrough()});t.RootSchema=o.z.object({uri:o.z.string().startsWith(\"file://\"),name:o.z.optional(o.z.string()),_meta:o.z.optional(o.z.object({}).passthrough())}).passthrough();t.ListRootsRequestSchema=t.RequestSchema.extend({method:o.z.literal(\"roots/list\")});t.ListRootsResultSchema=t.ResultSchema.extend({roots:o.z.array(t.RootSchema)});t.RootsListChangedNotificationSchema=t.NotificationSchema.extend({method:o.z.literal(\"notifications/roots/list_changed\")});t.ClientRequestSchema=o.z.union([t.PingRequestSchema,t.InitializeRequestSchema,t.CompleteRequestSchema,t.SetLevelRequestSchema,t.GetPromptRequestSchema,t.ListPromptsRequestSchema,t.ListResourcesRequestSchema,t.ListResourceTemplatesRequestSchema,t.ReadResourceRequestSchema,t.SubscribeRequestSchema,t.UnsubscribeRequestSchema,t.CallToolRequestSchema,t.ListToolsRequestSchema]);t.ClientNotificationSchema=o.z.union([t.CancelledNotificationSchema,t.ProgressNotificationSchema,t.InitializedNotificationSchema,t.RootsListChangedNotificationSchema]);t.ClientResultSchema=o.z.union([t.EmptyResultSchema,t.CreateMessageResultSchema,t.ElicitResultSchema,t.ListRootsResultSchema]);t.ServerRequestSchema=o.z.union([t.PingRequestSchema,t.CreateMessageRequestSchema,t.ElicitRequestSchema,t.ListRootsRequestSchema]);t.ServerNotificationSchema=o.z.union([t.CancelledNotificationSchema,t.ProgressNotificationSchema,t.LoggingMessageNotificationSchema,t.ResourceUpdatedNotificationSchema,t.ResourceListChangedNotificationSchema,t.ToolListChangedNotificationSchema,t.PromptListChangedNotificationSchema]);t.ServerResultSchema=o.z.union([t.EmptyResultSchema,t.InitializeResultSchema,t.CompleteResultSchema,t.GetPromptResultSchema,t.ListPromptsResultSchema,t.ListResourcesResultSchema,t.ListResourceTemplatesResultSchema,t.ReadResourceResultSchema,t.CallToolResultSchema,t.ListToolsResultSchema]);class McpError extends Error{constructor(e,t,s){super(`MCP error ${e}: ${t}`);this.code=e;this.data=s;this.name=\"McpError\"}}t.McpError=McpError}};var t={};function __nccwpck_require__(s){var o=t[s];if(o!==undefined){return o.exports}var a=t[s]={exports:{}};var i=true;try{e[s].call(a.exports,a,a.exports,__nccwpck_require__);i=false}finally{if(i)delete t[s]}return a.exports}if(typeof __nccwpck_require__!==\"undefined\")__nccwpck_require__.ab=__dirname+\"/\";var s=__nccwpck_require__(685);module.exports=s})();\n\\ No newline at end of file"
        },
        {
            "sha": "3de2e83d0f2193540378e846fb8c5403fed13249",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -414,6 +414,7 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n         proxyTimeout: z.number().gte(0).optional(),\n         rootParams: z.boolean().optional(),\n         isolatedDevBuild: z.boolean().optional(),\n+        mcpServer: z.boolean().optional(),\n         routerBFCache: z.boolean().optional(),\n         removeUncaughtErrorAndRejectionListeners: z.boolean().optional(),\n         validateRSCRequestHeaders: z.boolean().optional(),"
        },
        {
            "sha": "5b0425c1601be969a8aeaa4af256981d4a5be14f",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -836,6 +836,15 @@ export interface ExperimentalConfig {\n    * instead of `{distDir}`.\n    */\n   isolatedDevBuild?: boolean\n+\n+  /**\n+   * Enable the Model Context Protocol (MCP) server for AI-assisted development.\n+   * When enabled, Next.js will expose an MCP server at `/_next/mcp` that provides\n+   * code intelligence and project context to AI assistants.\n+   *\n+   * @default false\n+   */\n+  mcpServer?: boolean\n }\n \n export type ExportPathMap = {"
        },
        {
            "sha": "dddc7c6b1b8108d5d76914d1abed4f069b2ee207",
            "filename": "packages/next/src/server/dev/hot-reloader-turbopack.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -111,6 +111,7 @@ import {\n   getVersionInfo,\n   matchNextPageBundleRequest,\n } from './hot-reloader-shared-utils'\n+import { getMcpMiddleware } from '../mcp/get-mcp-middleware'\n \n const wsServer = new ws.Server({ noServer: true })\n const isTestMode = !!(\n@@ -732,6 +733,9 @@ export async function createHotReloaderTurbopack(\n         })\n       },\n     }),\n+    ...(nextConfig.experimental.mcpServer\n+      ? [getMcpMiddleware(projectPath)]\n+      : []),\n   ]\n \n   let versionInfoCached: ReturnType<typeof getVersionInfo> | undefined"
        },
        {
            "sha": "6c3afb5551f2af1979dc912eadd31e1be365e214",
            "filename": "packages/next/src/server/dev/hot-reloader-webpack.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-webpack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-webpack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-webpack.ts?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -104,6 +104,7 @@ import {\n   getVersionInfo,\n   matchNextPageBundleRequest,\n } from './hot-reloader-shared-utils'\n+import { getMcpMiddleware } from '../mcp/get-mcp-middleware'\n \n const MILLISECONDS_IN_NANOSECOND = BigInt(1_000_000)\n \n@@ -1620,6 +1621,9 @@ export default class HotReloaderWebpack implements NextJsHotReloaderInterface {\n           })\n         },\n       }),\n+      ...(this.config.experimental.mcpServer\n+        ? [getMcpMiddleware(this.dir)]\n+        : []),\n     ]\n   }\n "
        },
        {
            "sha": "d9c6daad4bb8b83e72ad927d8c61f31127b3eaf2",
            "filename": "packages/next/src/server/mcp/get-mcp-middleware.ts",
            "status": "added",
            "additions": 41,
            "deletions": 0,
            "changes": 41,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fmcp%2Fget-mcp-middleware.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fmcp%2Fget-mcp-middleware.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fmcp%2Fget-mcp-middleware.ts?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -0,0 +1,41 @@\n+import type { ServerResponse, IncomingMessage } from 'http'\n+import { getOrCreateMcpServer } from './get-or-create-mcp-server'\n+import { parseBody } from '../api-utils/node/parse-body'\n+import { StreamableHTTPServerTransport } from 'next/dist/compiled/@modelcontextprotocol/sdk/server/streamableHttp'\n+\n+export function getMcpMiddleware(projectPath: string) {\n+  return async function (\n+    req: IncomingMessage,\n+    res: ServerResponse,\n+    next: () => void\n+  ): Promise<void> {\n+    const { pathname } = new URL(req.url || '', 'http://n')\n+    if (!pathname.startsWith('/_next/mcp')) {\n+      return next()\n+    }\n+    const mcpServer = getOrCreateMcpServer(projectPath)\n+    const transport = new StreamableHTTPServerTransport({\n+      sessionIdGenerator: undefined,\n+    })\n+    try {\n+      res.on('close', () => {\n+        transport.close()\n+      })\n+      await mcpServer.connect(transport)\n+      const parsedBody = await parseBody(req, 1024 * 1024) // 1MB limit\n+      await transport.handleRequest(req, res, parsedBody)\n+    } catch (error) {\n+      if (!res.headersSent) {\n+        res.statusCode = 500\n+        res.setHeader('Content-Type', 'application/json; charset=utf-8')\n+        res.end(\n+          JSON.stringify({\n+            jsonrpc: '2.0',\n+            error: { code: -32000, message: 'Internal server error' },\n+            id: null,\n+          })\n+        )\n+      }\n+    }\n+  }\n+}"
        },
        {
            "sha": "0281d93280c4e12d146db57b8c88208117b52164",
            "filename": "packages/next/src/server/mcp/get-or-create-mcp-server.ts",
            "status": "added",
            "additions": 57,
            "deletions": 0,
            "changes": 57,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fmcp%2Fget-or-create-mcp-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Fsrc%2Fserver%2Fmcp%2Fget-or-create-mcp-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fmcp%2Fget-or-create-mcp-server.ts?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -0,0 +1,57 @@\n+import { McpServer } from 'next/dist/compiled/@modelcontextprotocol/sdk/server/mcp'\n+\n+let mcpServer: McpServer | undefined\n+\n+export const getOrCreateMcpServer = (projectPath: string) => {\n+  if (mcpServer) {\n+    return mcpServer\n+  }\n+\n+  mcpServer = new McpServer({\n+    name: 'Next.js MCP Server',\n+    version: '0.1.0',\n+  })\n+\n+  mcpServer.registerTool(\n+    'get_project_path',\n+    {\n+      description:\n+        'Returns the absolute path of the root directory for this Next.js project.',\n+      inputSchema: {},\n+    },\n+    async (_request) => {\n+      try {\n+        if (!projectPath) {\n+          return {\n+            content: [\n+              {\n+                type: 'text',\n+                text: 'Unable to determine the absolute path of the Next.js project.',\n+              },\n+            ],\n+          }\n+        }\n+\n+        return {\n+          content: [\n+            {\n+              type: 'text',\n+              text: projectPath,\n+            },\n+          ],\n+        }\n+      } catch (error) {\n+        return {\n+          content: [\n+            {\n+              type: 'text',\n+              text: `Error: ${error instanceof Error ? error.message : String(error)}`,\n+            },\n+          ],\n+        }\n+      }\n+    }\n+  )\n+\n+  return mcpServer\n+}"
        },
        {
            "sha": "83741316dbebbe67f7ed45a90c2b5d504f3a7334",
            "filename": "packages/next/taskfile.js",
            "status": "modified",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Ftaskfile.js",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Ftaskfile.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ftaskfile.js?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -2216,6 +2216,32 @@ export async function ncc_ws(task, opts) {\n     .target('src/compiled/ws')\n }\n \n+// eslint-disable-next-line camelcase\n+export async function ncc_modelcontextprotocol_sdk(task, opts) {\n+  await task\n+    .source(\n+      relative(\n+        __dirname,\n+        require.resolve('@modelcontextprotocol/sdk/server/mcp.js')\n+      )\n+    )\n+    .ncc({\n+      externals,\n+    })\n+    .target('src/compiled/@modelcontextprotocol/sdk/server')\n+  await task\n+    .source(\n+      relative(\n+        __dirname,\n+        require.resolve('@modelcontextprotocol/sdk/server/streamableHttp.js')\n+      )\n+    )\n+    .ncc({\n+      externals,\n+    })\n+    .target('src/compiled/@modelcontextprotocol/sdk/server')\n+}\n+\n externals['path-to-regexp'] = 'next/dist/compiled/path-to-regexp'\n export async function ncc_path_to_regexp(task, opts) {\n   await task\n@@ -2421,6 +2447,7 @@ export async function ncc(task, opts) {\n       'ncc_busboy',\n       'ncc_mswjs_interceptors',\n       'ncc_rsc_poison_packages',\n+      'ncc_modelcontextprotocol_sdk',\n     ],\n     opts\n   )"
        },
        {
            "sha": "6bb9705b6bb51f399a3a019b6b5d70560d0e1fa7",
            "filename": "packages/next/types/$$compiled.internal.d.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Ftypes%2F%24%24compiled.internal.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/packages%2Fnext%2Ftypes%2F%24%24compiled.internal.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ftypes%2F%24%24compiled.internal.d.ts?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -746,6 +746,14 @@ declare module 'next/dist/compiled/ws' {\n   export = m\n }\n \n+declare module 'next/dist/compiled/@modelcontextprotocol/sdk/server/mcp' {\n+  export * from '@modelcontextprotocol/sdk/server/mcp'\n+}\n+\n+declare module 'next/dist/compiled/@modelcontextprotocol/sdk/server/streamableHttp' {\n+  export * from '@modelcontextprotocol/sdk/server/streamableHttp'\n+}\n+\n declare module 'next/dist/compiled/comment-json' {\n   import m from 'comment-json'\n   export = m"
        },
        {
            "sha": "22f9187220784bcf4d2a40c04145589b746195d7",
            "filename": "pnpm-lock.yaml",
            "status": "modified",
            "additions": 419,
            "deletions": 0,
            "changes": 419,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/pnpm-lock.yaml",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/pnpm-lock.yaml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/pnpm-lock.yaml?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -1093,6 +1093,9 @@ importers:\n       '@jest/types':\n         specifier: 29.5.0\n         version: 29.5.0\n+      '@modelcontextprotocol/sdk':\n+        specifier: 1.18.1\n+        version: 1.18.1\n       '@mswjs/interceptors':\n         specifier: 0.23.0\n         version: 0.23.0\n@@ -4357,6 +4360,10 @@ packages:\n       '@types/react': 19.1.13\n       react: 19.2.0-canary-d415fd3e-20250919\n \n+  '@modelcontextprotocol/sdk@1.18.1':\n+    resolution: {integrity: sha512-d//GE8/Yh7aC3e7p+kZG8JqqEAwwDUmAfvH1quogtbk+ksS6E0RR6toKKESPYYZVre0meqkJb27zb+dhqE9Sgw==}\n+    engines: {node: '>=18'}\n+\n   '@module-federation/error-codes@0.18.0':\n     resolution: {integrity: sha512-Woonm8ehyVIUPXChmbu80Zj6uJkC0dD9SJUZ/wOPtO8iiz/m+dkrOugAuKgoiR6qH4F+yorWila954tBz4uKsQ==}\n \n@@ -6611,6 +6618,10 @@ packages:\n     resolution: {integrity: sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==}\n     engines: {node: '>= 0.6'}\n \n+  accepts@2.0.0:\n+    resolution: {integrity: sha512-5cvg6CtKwfgdmVqY1WIiXKc3Q1bkRqGLi+2W/6ao+6Y7gu/RCwRuAhGEzh5B4KlszSuTLgZYuqFqo5bImjNKng==}\n+    engines: {node: '>= 0.6'}\n+\n   acorn-globals@7.0.1:\n     resolution: {integrity: sha512-umOSDSDrfHbTNPuNpC2NSnnA3LUrqpevPb4T9jRx4MagXNS0rs+gwiTcAvqCRmsD6utzsrzNt+ebm00SNWiC3Q==}\n \n@@ -7227,6 +7238,10 @@ packages:\n     resolution: {integrity: sha512-7rAxByjUMqQ3/bHJy7D6OGXvx/MMc4IqBn/X0fcM1QUcAItpZrBEYhWGem+tzXH90c+G01ypMcYJBO9Y30203g==}\n     engines: {node: '>= 0.8', npm: 1.2.8000 || >= 1.4.16}\n \n+  body-parser@2.2.0:\n+    resolution: {integrity: sha512-02qvAaxv8tp7fBa/mw1ga98OGm+eCbqzJOKoRt70sLmfEEi+jyBYVTDGfCL/k06/4EMk/z01gCe7HoCH/f2LTg==}\n+    engines: {node: '>=18'}\n+\n   bonjour-service@1.3.0:\n     resolution: {integrity: sha512-3YuAUiSkWykd+2Azjgyxei8OWf8thdn8AITIog2M4UICzoqfjlqr64WIjEXZllf/W6vK1goqleSR6brGomxQqA==}\n \n@@ -7378,13 +7393,21 @@ packages:\n     resolution: {integrity: sha512-kpqOvwXnjjN44D89K5ccQC+RUrsy7jB/XLlRrx0D7/2HNcTPqzsb6XgYoErwko6QsV184CA2YgS1fxDiiDZMWA==}\n     engines: {node: '>=8'}\n \n+  call-bind-apply-helpers@1.0.2:\n+    resolution: {integrity: sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==}\n+    engines: {node: '>= 0.4'}\n+\n   call-bind@1.0.2:\n     resolution: {integrity: sha512-7O+FbCihrB5WGbFYesctwmTKae6rOiIzmz1icreWJ+0aA7LJfuqhEso2T9ncpcFtzMQtzXf2QGGueWJGTYsqrA==}\n \n   call-bind@1.0.7:\n     resolution: {integrity: sha512-GHTSNSYICQ7scH7sZ+M2rFopRoLh8t2bLSW6BbgrtLsahOIB5iyAVJf9GjWK3cYTDaMj4XdBpM1cA6pIS0Kv2w==}\n     engines: {node: '>= 0.4'}\n \n+  call-bound@1.0.4:\n+    resolution: {integrity: sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==}\n+    engines: {node: '>= 0.4'}\n+\n   caller-callsite@2.0.0:\n     resolution: {integrity: sha512-JuG3qI4QOftFsZyOn1qq87fq5grLIyk1JYd5lJmdA+fG7aQ9pA/i3JIJGcO3q0MrRcHlOt1U+ZeHW8Dq9axALQ==}\n     engines: {node: '>=4'}\n@@ -7891,6 +7914,10 @@ packages:\n     resolution: {integrity: sha512-FveZTNuGw04cxlAiWbzi6zTAL/lhehaWbTtgluJh4/E95DqMwTmha3KZN1aAWA8cFIhHzMZUvLevkw5Rqk+tSQ==}\n     engines: {node: '>= 0.6'}\n \n+  content-disposition@1.0.0:\n+    resolution: {integrity: sha512-Au9nRL8VNUut/XSzbQA38+M78dzP4D+eqg3gfJHMIHHYa3bg067xj1KxMUWj+VULbiZMowKngFFbKczUrNJ1mg==}\n+    engines: {node: '>= 0.6'}\n+\n   content-type@1.0.4:\n     resolution: {integrity: sha512-hIP3EEPs8tB9AT1L+NUqtwOAps4mk2Zob89MWXMHjHWg9milF/j4osnnQLXBCBFBk/tvIG/tUc9mOUJiPBhPXA==}\n     engines: {node: '>= 0.6'}\n@@ -7943,6 +7970,10 @@ packages:\n   cookie-signature@1.0.6:\n     resolution: {integrity: sha512-QADzlaHc8icV8I7vbaJXJwod9HWYp8uCqf1xa4OfNu1T7JVxQIrUgOWtHdNDtPiywmFbiS12VjotIXLrKM3orQ==}\n \n+  cookie-signature@1.2.2:\n+    resolution: {integrity: sha512-D76uU73ulSXrD1UXF4KE2TMxVVwhsnCgfAyTg9k8P6KGZjlXKrOLe4dJQKI3Bxi5wjesZoFXJWElNWBjPZMbhg==}\n+    engines: {node: '>=6.6.0'}\n+\n   cookie@0.4.0:\n     resolution: {integrity: sha512-+Hp8fLp57wnUSt0tY0tHEXh4voZRDnoIrZPqlo3DPiI4y9lwg/jqx+1Om94/W6ZaPDOUbnjOt/99w66zk+l1Xg==}\n     engines: {node: '>= 0.6'}\n@@ -8951,6 +8982,10 @@ packages:\n   downsample-lttb@0.0.1:\n     resolution: {integrity: sha512-Olebo5gyh44OAXTd2BKdcbN5VaZOIKFzoeo9JUFwxDlGt6Sd8fUo6SKaLcafy8aP2UrsKmWDpsscsFEghMjeZA==}\n \n+  dunder-proto@1.0.1:\n+    resolution: {integrity: sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==}\n+    engines: {node: '>= 0.4'}\n+\n   duplexer3@0.1.4:\n     resolution: {integrity: sha512-CEj8FwwNA4cVH2uFCoHUrmojhYh1vmCdOaneKJXwkeY1i9jnlslVo9dx+hQ5Hl9GnH/Bwy/IjxAyOePyPKYnzA==}\n \n@@ -9099,6 +9134,10 @@ packages:\n     resolution: {integrity: sha512-jxayLKShrEqqzJ0eumQbVhTYQM27CfT1T35+gCgDFoL82JLsXqTJ76zv6A0YLOgEnLUMvLzsDsGIrl8NFpT2gQ==}\n     engines: {node: '>= 0.4'}\n \n+  es-define-property@1.0.1:\n+    resolution: {integrity: sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==}\n+    engines: {node: '>= 0.4'}\n+\n   es-errors@1.3.0:\n     resolution: {integrity: sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==}\n     engines: {node: '>= 0.4'}\n@@ -9117,6 +9156,10 @@ packages:\n     resolution: {integrity: sha512-MZ4iQ6JwHOBQjahnjwaC1ZtIBH+2ohjamzAO3oaHcXYup7qxjF2fixyH+Q71voWHeOkI2q/TnJao/KfXYIZWbw==}\n     engines: {node: '>= 0.4'}\n \n+  es-object-atoms@1.1.1:\n+    resolution: {integrity: sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==}\n+    engines: {node: '>= 0.4'}\n+\n   es-set-tostringtag@2.0.3:\n     resolution: {integrity: sha512-3T8uNMC3OQTHkFUsFq8r/BwAXLHvU/9O9mE0fBc/MY5iq/8H7ncvO947LmYA6ldWw9Uh8Yhf25zu6n7nML5QWQ==}\n     engines: {node: '>= 0.4'}\n@@ -9530,6 +9573,14 @@ packages:\n     resolution: {integrity: sha512-mQw+2fkQbALzQ7V0MY0IqdnXNOeTtP4r0lN9z7AAawCXgqea7bDii20AYrIBrFd/Hx0M2Ocz6S111CaFkUcb0Q==}\n     engines: {node: '>=0.8.x'}\n \n+  eventsource-parser@3.0.6:\n+    resolution: {integrity: sha512-Vo1ab+QXPzZ4tCa8SwIHJFaSzy4R6SHf7BY79rFBDf0idraZWAkYrDjDj8uWaSm3S2TK+hJ7/t1CEmZ7jXw+pg==}\n+    engines: {node: '>=18.0.0'}\n+\n+  eventsource@3.0.7:\n+    resolution: {integrity: sha512-CRT1WTyuQoD771GW56XEZFQ/ZoSfWid1alKGDYMmkt2yl8UXrVR4pspqWNEcqKvVIzg6PAltWjxcSSPrboA4iA==}\n+    engines: {node: '>=18.0.0'}\n+\n   evp_bytestokey@1.0.3:\n     resolution: {integrity: sha512-/f2Go4TognH/KvCISP7OUsHn85hT9nUkxxA9BEWxFn+Oj9o8ZNLm/40hdlgSLyuOimsrTKLUMEorQexp/aPQeA==}\n \n@@ -9583,6 +9634,12 @@ packages:\n     resolution: {integrity: sha512-WVi2V4iHKw/vHEyye00Q9CSZz7KHDbJkJyteUI8kTih9jiyMl3bIk7wLYFcY9D1Blnadlyb5w5NBuNjQBow99g==}\n     engines: {node: ^16.10.0 || ^18.12.0 || >=20.0.0}\n \n+  express-rate-limit@7.5.1:\n+    resolution: {integrity: sha512-7iN8iPMDzOMHPUYllBEsQdWVB6fPDMPqwjBaFrgr4Jgr/+okjvzAy+UHlYYL/Vs0OsOrMkwS6PJDkFlJwoxUnw==}\n+    engines: {node: '>= 16'}\n+    peerDependencies:\n+      express: '>= 4.11'\n+\n   express@4.17.0:\n     resolution: {integrity: sha512-1Z7/t3Z5ZnBG252gKUPyItc4xdeaA0X934ca2ewckAsVsw9EG71i++ZHZPYnus8g/s5Bty8IMpSVEuRkmwwPRQ==}\n     engines: {node: '>= 0.10.0'}\n@@ -9591,6 +9648,10 @@ packages:\n     resolution: {integrity: sha512-28HqgMZAmih1Czt9ny7qr6ek2qddF4FclbMzwhCREB6OFfH+rXAnuNCwo1/wFvrtbgsQDb4kSbX9de9lFbrXnA==}\n     engines: {node: '>= 0.10.0'}\n \n+  express@5.1.0:\n+    resolution: {integrity: sha512-DT9ck5YIRU+8GYzzU5kT3eHGA5iL+1Zd0EutOmTE9Dtk+Tvuzd23VBU+ec7HPNSTxXYO55gPV/hq4pSBJDjFpA==}\n+    engines: {node: '>= 18'}\n+\n   ext@1.6.0:\n     resolution: {integrity: sha512-sdBImtzkq2HpkdRLtlLWDa6w4DX22ijZLKx8BMPUuKe1c5lbN6xwQDQCxSfxBQnHZ13ls/FH0MQZx/q/gr6FQg==}\n \n@@ -9735,6 +9796,10 @@ packages:\n     resolution: {integrity: sha512-6BN9trH7bp3qvnrRyzsBz+g3lZxTNZTbVO2EV1CS0WIcDbawYVdYvGflME/9QP0h0pYlCDBCTjYa9nZzMDpyxQ==}\n     engines: {node: '>= 0.8'}\n \n+  finalhandler@2.1.0:\n+    resolution: {integrity: sha512-/t88Ty3d5JWQbWYgaOGCCYfXRwV1+be02WqYYlL6h0lEiUAMPM8o8qKGO01YIkOHzka2up08wvgYD0mDiI+q3Q==}\n+    engines: {node: '>= 0.8'}\n+\n   find-cache-dir@2.1.0:\n     resolution: {integrity: sha512-Tq6PixE0w/VMFfCgbONnkiQIVol/JJL7nRMi20fqzA4NRs9AfeqMGeRdPi3wIhYkxjeBaWh2rxwapn5Tu3IqOQ==}\n     engines: {node: '>=6'}\n@@ -9884,6 +9949,10 @@ packages:\n     resolution: {integrity: sha512-zJ2mQYM18rEFOudeV4GShTGIQ7RbzA7ozbU9I/XBpm7kqgMywgmylMwXHxZJmkVoYkna9d2pVXVXPdYTP9ej8Q==}\n     engines: {node: '>= 0.6'}\n \n+  fresh@2.0.0:\n+    resolution: {integrity: sha512-Rx/WycZ60HOaqLKAi6cHRKKI7zxWbJ31MhntmtwMoaTeF7XFH9hhBp8vITaMidfljRQ6eYWCKkaTK+ykVJHP2A==}\n+    engines: {node: '>= 0.8'}\n+\n   from@0.1.7:\n     resolution: {integrity: sha512-twe20eF1OxVxp/ML/kq2p1uc6KvFK/+vs8WjEbeKmV2He22MKm7YF2ANIt+EOqhJ5L3K/SuuPhk0hWQDjOM23g==}\n \n@@ -10056,6 +10125,10 @@ packages:\n     resolution: {integrity: sha512-5uYhsJH8VJBTv7oslg4BznJYhDoRI6waYCxMmCdnTrcCrHA/fCFKoTFz2JKKE0HdDFUF7/oQuhzumXJK7paBRQ==}\n     engines: {node: '>= 0.4'}\n \n+  get-intrinsic@1.3.0:\n+    resolution: {integrity: sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==}\n+    engines: {node: '>= 0.4'}\n+\n   get-nonce@1.0.1:\n     resolution: {integrity: sha512-FJhYRoDaiatfEkUK8HKlicmu/3SGFD51q3itKDGoSTysQJBnfOcxU5GxnhE1E6soB76MbT0MBtnKJuXyAx+96Q==}\n     engines: {node: '>=6'}\n@@ -10075,6 +10148,10 @@ packages:\n     resolution: {integrity: sha512-g/Q1aTSDOxFpchXC4i8ZWvxA1lnPqx/JHqcpIw0/LX9T8x/GBbi6YnlN5nhaKIFkT8oFsscUKgDJYxfwfS6QsQ==}\n     engines: {node: '>=8'}\n \n+  get-proto@1.0.1:\n+    resolution: {integrity: sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==}\n+    engines: {node: '>= 0.4'}\n+\n   get-stdin@4.0.1:\n     resolution: {integrity: sha512-F5aQMywwJ2n85s4hJPTT9RPxGmubonuB10MNYo17/xph174n2MIR33HRguhzVag10O/npM7SPk73LMZNP+FaWw==}\n     engines: {node: '>=0.10.0'}\n@@ -10260,6 +10337,10 @@ packages:\n   gopd@1.0.1:\n     resolution: {integrity: sha512-d65bNlIadxvpb/A2abVdlqKqV563juRnZ1Wtk6s1sIR8uNsXR70xqIzVqxVf1eTqDunwT2MkczEeaezCKTZhwA==}\n \n+  gopd@1.2.0:\n+    resolution: {integrity: sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==}\n+    engines: {node: '>= 0.4'}\n+\n   got@7.1.0:\n     resolution: {integrity: sha512-Y5WMo7xKKq1muPsxD+KmrR8DH5auG7fBdDVueZwETwV6VytKyU9OX/ddpq2/1hp1vIPvVb4T81dKQz3BivkNLw==}\n     engines: {node: '>=4'}\n@@ -10359,6 +10440,10 @@ packages:\n     resolution: {integrity: sha512-l3LCuF6MgDNwTDKkdYGEihYjt5pRPbEg46rtlmnSPlUbgmB8LOIrKJbYYFBSbnPaJexMKtiPO8hmeRjRz2Td+A==}\n     engines: {node: '>= 0.4'}\n \n+  has-symbols@1.1.0:\n+    resolution: {integrity: sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==}\n+    engines: {node: '>= 0.4'}\n+\n   has-to-string-tag-x@1.4.1:\n     resolution: {integrity: sha512-vdbKfmw+3LoOYVr+mtxHaX5a96+0f3DljYd8JOqvOLsf5mw2Otda2qCDT9qRqLAhrjyQ0h7ual5nOiASpsGNFw==}\n \n@@ -10658,6 +10743,10 @@ packages:\n     resolution: {integrity: sha512-4fCk79wshMdzMp2rH06qWrJE4iolqLhCUH+OiuIgU++RB0+94NlDL81atO7GX55uUKueo0txHNtvEyI6D7WdMw==}\n     engines: {node: '>=0.10.0'}\n \n+  iconv-lite@0.7.0:\n+    resolution: {integrity: sha512-cf6L2Ds3h57VVmkZe+Pn+5APsT7FpqJtEhhieDCvrE2MK5Qk9MyffgQyuxQTm6BChfeZNtcOLHp9IcWRVcIcBQ==}\n+    engines: {node: '>=0.10.0'}\n+\n   icss-replace-symbols@1.1.0:\n     resolution: {integrity: sha512-chIaY3Vh2mh2Q3RGXttaDIzeiPvaVXJ+C4DAh/w3c37SKZ/U6PGMmuicR2EQQp9bKG8zLMCl7I+PtIoOOPp8Gg==}\n \n@@ -11151,6 +11240,9 @@ packages:\n   is-potential-custom-element-name@1.0.1:\n     resolution: {integrity: sha512-bCYeRA2rVibKZd+s2625gGnGF/t7DSqDs4dP7CrLA1m7jKWz6pps0LpYLJN8Q64HtmPKJ1hrN3nzPNKFEKOUiQ==}\n \n+  is-promise@4.0.0:\n+    resolution: {integrity: sha512-hvpoI6korhJMnej285dSg6nu1+e6uxs7zG3BYAm5byqDsgJNWwxzM6z6iZiAgQR4TJ30JmBTOwqZUw3WlyH3AQ==}\n+\n   is-reference@1.2.1:\n     resolution: {integrity: sha512-U82MsXXiFIrjCK4otLT+o2NA2Cd2g5MLoOVXUZjIOhLurrRxpEXzI8O0KZHr3IjLvlAH1kTPYSuqer5T9ZVBKQ==}\n \n@@ -12274,6 +12366,10 @@ packages:\n   markdown-table@3.0.4:\n     resolution: {integrity: sha512-wiYz4+JrLyb/DqW2hkFJxP7Vd7JuTDm77fvbM8VfEQdmSMqcImWeeRbHwZjBjIFki/VaMK2BhFi7oUUZeM5bqw==}\n \n+  math-intrinsics@1.1.0:\n+    resolution: {integrity: sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==}\n+    engines: {node: '>= 0.4'}\n+\n   maximatch@0.1.0:\n     resolution: {integrity: sha512-9ORVtDUFk4u/NFfo0vG/ND/z7UQCVZBL539YW0+U1I7H1BkZwizcPx5foFv7LCPcBnm2U6RjFnQOsIvN4/Vm2A==}\n     engines: {node: '>=0.10.0'}\n@@ -12403,6 +12499,10 @@ packages:\n     resolution: {integrity: sha512-dq+qelQ9akHpcOl/gUVRTxVIOkAJ1wR3QAvb4RsVjS8oVoFjDGTc679wJYmUmknUF5HwMLOgb5O+a3KxfWapPQ==}\n     engines: {node: '>= 0.6'}\n \n+  media-typer@1.1.0:\n+    resolution: {integrity: sha512-aisnrDP4GNe06UcKFnV5bfMNPBUw4jsLGaWwWfnH3v02GnBuXX2MCVn5RbrWo0j3pczUilYblq7fQ7Nw2t5XKw==}\n+    engines: {node: '>= 0.8'}\n+\n   memfs@3.5.3:\n     resolution: {integrity: sha512-UERzLsxzllchadvbPs5aolHh65ISpKpM+ccLbOJ8/vvpBKmAWf+la7dXFy7Mr0ySHbdHrFv5kGFCUHHe6GFEmw==}\n     engines: {node: '>= 4.0.0'}\n@@ -12436,6 +12536,10 @@ packages:\n   merge-descriptors@1.0.3:\n     resolution: {integrity: sha512-gaNvAS7TZ897/rVaZ0nMtAyxNyi/pdbjbAwUpFQpN70GqnVfOiXpeUUMKRBmzXaSQ8DdTX4/0ms62r2K+hE6mQ==}\n \n+  merge-descriptors@2.0.0:\n+    resolution: {integrity: sha512-Snk314V5ayFLhp3fkUREub6WtjBfPdCPY1Ln8/8munuLuiYhsABgBVWsozAG+MWMbVEvcdcpbi9R7ww22l9Q3g==}\n+    engines: {node: '>=18'}\n+\n   merge-stream@2.0.0:\n     resolution: {integrity: sha512-abv/qOcuPfk3URPfDzmZU1LKmuw8kT+0nIHvKrKgFrwifol/doWcdA4ZqsWQ8ENrFKkd67Mfpo/LovbIUsbt3w==}\n \n@@ -12692,6 +12796,10 @@ packages:\n     resolution: {integrity: sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==}\n     engines: {node: '>= 0.6'}\n \n+  mime-db@1.54.0:\n+    resolution: {integrity: sha512-aU5EJuIN2WDemCcAp2vFBfp/m4EAhWJnUNSSw0ixs7/kXbd6Pg64EmwJkNdFhB8aWt1sH2CTXrLxo/iAGV3oPQ==}\n+    engines: {node: '>= 0.6'}\n+\n   mime-types@2.1.18:\n     resolution: {integrity: sha512-lc/aahn+t4/SWV/qcmumYjymLsWfN3ELhpmVuUFjgsORruuZPVSwAQryq+HHGvO/SI2KVX26bx+En+zhM8g8hQ==}\n     engines: {node: '>= 0.6'}\n@@ -12700,6 +12808,10 @@ packages:\n     resolution: {integrity: sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==}\n     engines: {node: '>= 0.6'}\n \n+  mime-types@3.0.1:\n+    resolution: {integrity: sha512-xRc4oEhT6eaBpU1XF7AjpOFD+xQmXNB5OVKwp4tqCuBpHLS/ZbBDrc07mYTDqVMg6PfxUjjNp85O6Cd2Z/5HWA==}\n+    engines: {node: '>= 0.6'}\n+\n   mime@1.6.0:\n     resolution: {integrity: sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==}\n     engines: {node: '>=4'}\n@@ -13252,6 +13364,10 @@ packages:\n     resolution: {integrity: sha512-IRZSRuzJiynemAXPYtPe5BoI/RESNYR7TYm50MC5Mqbd3Jmw5y790sErYw3V6SryFJD64b74qQQs9wn5Bg/k3g==}\n     engines: {node: '>= 0.4'}\n \n+  object-inspect@1.13.4:\n+    resolution: {integrity: sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew==}\n+    engines: {node: '>= 0.4'}\n+\n   object-is@1.0.2:\n     resolution: {integrity: sha512-Epah+btZd5wrrfjkJZq1AOB9O6OxUQto45hzFd7lXGrpHPGE0W1k+426yrZV+k6NJOzLNNW/nVsmZdIWsAqoOQ==}\n     engines: {node: '>= 0.4'}\n@@ -13696,6 +13812,9 @@ packages:\n   path-to-regexp@6.3.0:\n     resolution: {integrity: sha512-Yhpw4T9C6hPpgPeA28us07OJeqZ5EzQTkbfwuhsUg0c237RomFoETJgmp2sa3F/41gfLE6G5cqcYwznmeEeOlQ==}\n \n+  path-to-regexp@8.3.0:\n+    resolution: {integrity: sha512-7jdwVIRtsP8MYpdXSwOS0YdD0Du+qOoF/AEPIt88PcCFrZCzx41oxku1jD88hZBwbNUIEfpqvuhjFaMAqMTWnA==}\n+\n   path-type@1.1.0:\n     resolution: {integrity: sha512-S4eENJz1pkiQn9Znv33Q+deTOKmbl+jj1Fl+qiP/vYezj+S8x+J3Uo0ISrx/QoEvIlOaDWJhPaRd1flJ9HXZqg==}\n     engines: {node: '>=0.10.0'}\n@@ -13805,6 +13924,10 @@ packages:\n     resolution: {integrity: sha512-ugJ4Imy92u55zeznaN/5d7iqOBIZjZ7q10/T+dcd0IuFtbLlsGDvAUabFu1cafER+G9f0T1WtTqvzm4KAdcDgQ==}\n     engines: {node: '>=4.0.0', npm: '>=1.2.10'}\n \n+  pkce-challenge@5.0.0:\n+    resolution: {integrity: sha512-ueGLflrrnvwB3xuo/uGob5pd5FN7l0MsLf0Z87o/UQmRtwjvfylfc9MurIxRAWywCYTgrvpXBcqjV4OfCYGCIQ==}\n+    engines: {node: '>=16.20.0'}\n+\n   pkg-dir@3.0.0:\n     resolution: {integrity: sha512-/E57AYkoeQ25qkxMj5PBOVgF8Kiu/h7cYS30Z5+R7WaiCCBfLq58ZI/dSeaEKb9WVJV5n/03QwrN3IeWIFllvw==}\n     engines: {node: '>=6'}\n@@ -14736,6 +14859,7 @@ packages:\n     engines: {node: '>=0.6.0', teleport: '>=0.2.0'}\n     deprecated: |-\n       You or someone you depend on is using Q, the JavaScript Promise library that gave JavaScript developers strong feelings about promises. They can almost certainly migrate to the native JavaScript promise now. Thank you literally everyone for joining me in this bet against the odds. Be excellent to each other.\n+\n       (For a CapTP with native promises, see @endo/eventual-send and @endo/captp)\n \n   qs@6.11.0:\n@@ -14750,6 +14874,10 @@ packages:\n     resolution: {integrity: sha512-EJPeIn0CYrGu+hli1xilKAPXODtJ12T0sP63Ijx2/khC2JtuaN3JyNIpvmnkmaEtha9ocbG4A4cMcr+TvqvwQg==}\n     engines: {node: '>=0.6'}\n \n+  qs@6.14.0:\n+    resolution: {integrity: sha512-YWWTjgABSKcvs/nWBi9PycY/JiPJqOD4JA6o9Sej2AtvSGarXxKC3OQSk4pAarbdQlKAh5D4FCQkJNkW+GAn3w==}\n+    engines: {node: '>=0.6'}\n+\n   qs@6.5.2:\n     resolution: {integrity: sha512-N5ZAX4/LxJmF+7wN74pUD6qAh9/wnvdQcjq9TZjevvXzSUo7bfmw91saqMjzGS2xq91/odN2dW/WOl7qQHNDGA==}\n     engines: {node: '>=0.6'}\n@@ -14824,6 +14952,10 @@ packages:\n     resolution: {integrity: sha512-8zGqypfENjCIqGhgXToC8aB2r7YrBX+AQAfIPs/Mlk+BtPTztOvTS01NRW/3Eh60J+a48lt8qsCzirQ6loCVfA==}\n     engines: {node: '>= 0.8'}\n \n+  raw-body@3.0.1:\n+    resolution: {integrity: sha512-9G8cA+tuMS75+6G/TzW8OtLzmBDMo8p1JRxN5AZ+LAp8uxGA8V8GZm4GQ4/N5QNQEnLmg6SS7wyuSmbKepiKqA==}\n+    engines: {node: '>= 0.10'}\n+\n   rc@1.2.8:\n     resolution: {integrity: sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw==}\n     hasBin: true\n@@ -15502,6 +15634,10 @@ packages:\n     engines: {node: '>=18.0.0', npm: '>=8.0.0'}\n     hasBin: true\n \n+  router@2.2.0:\n+    resolution: {integrity: sha512-nLTrUKm2UyiL7rlhapu/Zl45FwNgkZGaCpZbIHajDYgwlJCOzLSk+cIPAnsEqV955GjILJnKbdQC1nVPz+gAYQ==}\n+    engines: {node: '>= 18'}\n+\n   run-applescript@7.0.0:\n     resolution: {integrity: sha512-9by4Ij99JUr/MCFBUkDKLWK3G9HVXmabKz9U5MlIAIuvuzkiOicRYs8XJLxX+xahD+mLiiCYDqF9dKAgtzKP1A==}\n     engines: {node: '>=18'}\n@@ -15691,6 +15827,10 @@ packages:\n     resolution: {integrity: sha512-dW41u5VfLXu8SJh5bwRmyYUbAoSB3c9uQh6L8h/KtsFREPWpbX1lrljJo186Jc4nmci/sGUZ9a0a0J2zgfq2hw==}\n     engines: {node: '>= 0.8.0'}\n \n+  send@1.2.0:\n+    resolution: {integrity: sha512-uaW0WwXKpL9blXE2o0bRhoL2EGXIrZxQ2ZQ4mgcfoBxdFmQold+qWsD2jLrfZ0trjKL6vOw0j//eAwcALFjKSw==}\n+    engines: {node: '>= 18'}\n+\n   sentence-case@3.0.4:\n     resolution: {integrity: sha512-8LS0JInaQMCRoQ7YUytAo/xUu5W2XnQxV2HI/6uM6U7CITS1RqPElr30V6uIqyMKM9lJGRVFy5/4CuzcixNYSg==}\n \n@@ -15718,6 +15858,10 @@ packages:\n     resolution: {integrity: sha512-VqpjJZKadQB/PEbEwvFdO43Ax5dFBZ2UECszz8bQ7pi7wt//PWe1P6MN7eCnjsatYtBT6EuiClbjSWP2WrIoTw==}\n     engines: {node: '>= 0.8.0'}\n \n+  serve-static@2.2.0:\n+    resolution: {integrity: sha512-61g9pCh0Vnh7IutZjtLGGpTA355+OPn2TyDv/6ivP2h/AdAVX9azsoxmg2/M6nZeQZNYBEwIcsne1mJd9oQItQ==}\n+    engines: {node: '>= 18'}\n+\n   server-only@0.0.1:\n     resolution: {integrity: sha512-qepMx2JxAa5jjfzxG79yPPq+8BuFToHd1hm7kI+Z4zAq1ftQiP7HcxMhDDItrbtwVeLg/cY2JnKnrcFkmiswNA==}\n \n@@ -15787,10 +15931,26 @@ packages:\n   shiki@3.12.2:\n     resolution: {integrity: sha512-uIrKI+f9IPz1zDT+GMz+0RjzKJiijVr6WDWm9Pe3NNY6QigKCfifCEv9v9R2mDASKKjzjQ2QpFLcxaR3iHSnMA==}\n \n+  side-channel-list@1.0.0:\n+    resolution: {integrity: sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA==}\n+    engines: {node: '>= 0.4'}\n+\n+  side-channel-map@1.0.1:\n+    resolution: {integrity: sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA==}\n+    engines: {node: '>= 0.4'}\n+\n+  side-channel-weakmap@1.0.2:\n+    resolution: {integrity: sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A==}\n+    engines: {node: '>= 0.4'}\n+\n   side-channel@1.0.6:\n     resolution: {integrity: sha512-fDW/EZ6Q9RiO8eFG8Hj+7u/oW+XrPTIChwCOM2+th2A6OblDtYYIpve9m+KvI9Z4C9qSEXlaGR6bTEYHReuglA==}\n     engines: {node: '>= 0.4'}\n \n+  side-channel@1.1.0:\n+    resolution: {integrity: sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw==}\n+    engines: {node: '>= 0.4'}\n+\n   siginfo@2.0.0:\n     resolution: {integrity: sha512-ybx0WO1/8bSBLEWXZvEd7gMW3Sn3JFlW3TvX1nREbDLRNQNaeNN8WK0meBwPdAaOI7TtRRRJn/Es1zhrrCHu7g==}\n \n@@ -16847,6 +17007,10 @@ packages:\n     resolution: {integrity: sha512-TkRKr9sUTxEH8MdfuCSP7VizJyzRNMjj2J2do2Jr3Kym598JVdEksuzPQCnlFPW4ky9Q+iA+ma9BGm06XQBy8g==}\n     engines: {node: '>= 0.6'}\n \n+  type-is@2.0.1:\n+    resolution: {integrity: sha512-OZs6gsjF4vMp32qrCbiVSkrFmXtG/AZhY3t0iAMrMBiAZyV9oALtXO8hsrHbMXF9x6L3grlFuwW2oAz7cav+Gw==}\n+    engines: {node: '>= 0.6'}\n+\n   type@1.2.0:\n     resolution: {integrity: sha512-+5nt5AAniqsCnu2cEQQdpzCAh33kVx8n0VoFidKpB1dVVLAN/F+bgVOqOJqOnEnrhp222clB5p3vUlD+1QAnfg==}\n \n@@ -16892,6 +17056,7 @@ packages:\n \n   ua-parser-js@0.7.31:\n     resolution: {integrity: sha512-qLK/Xe9E2uzmYI3qLeOmI0tEOt+TBBQyUIAh4aAgU05FVYzeZrKUdkAZfBNVGRaHVgV0TDkdEngJSw/SyQchkQ==}\n+    deprecated: You are using an outdated version of ua-parser-js. Please update to ua-parser-js v0.7.33 / v1.0.33 / v2.0.0 (or later) to avoid ReDoS vulnerability [CVE-2022-25927](https://github.com/advisories/GHSA-fhg7-m89q-25r3)\n \n   ua-parser-js@1.0.35:\n     resolution: {integrity: sha512-fKnGuqmTBnIE+/KXSzCn4db8RTigUzw1AN0DmdU6hJovUTbYJKyqj+8Mt1c4VfRDnOVJnENmfYkIPZ946UrSAA==}\n@@ -17860,6 +18025,11 @@ packages:\n   yoga-wasm-web@0.3.3:\n     resolution: {integrity: sha512-N+d4UJSJbt/R3wqY7Coqs5pcV0aUj2j9IaQ3rNj9bVCLld8tTGKRa2USARjnvZJWVx1NDmQev8EknoczaOQDOA==}\n \n+  zod-to-json-schema@3.24.6:\n+    resolution: {integrity: sha512-h/z3PKvcTcTetyjl1fkj79MHNEjm+HpD6NXheWjzOekY7kV+lwDYnHw+ivHkijnCSMz1yJaWBD9vu/Fcmk+vEg==}\n+    peerDependencies:\n+      zod: ^3.24.1\n+\n   zod-validation-error@3.4.0:\n     resolution: {integrity: sha512-ZOPR9SVY6Pb2qqO5XHt+MkkTRxGXb4EVtnjc9JpXUOtUB1T9Ru7mZOT361AN3MsetVe7R0a1KZshJDZdgp9miQ==}\n     engines: {node: '>=18.0.0'}\n@@ -20990,6 +21160,23 @@ snapshots:\n       '@types/react': 19.1.13\n       react: 19.2.0-canary-d415fd3e-20250919\n \n+  '@modelcontextprotocol/sdk@1.18.1':\n+    dependencies:\n+      ajv: 6.12.6\n+      content-type: 1.0.5\n+      cors: 2.8.5\n+      cross-spawn: 7.0.6\n+      eventsource: 3.0.7\n+      eventsource-parser: 3.0.6\n+      express: 5.1.0\n+      express-rate-limit: 7.5.1(express@5.1.0)\n+      pkce-challenge: 5.0.0\n+      raw-body: 3.0.1\n+      zod: 3.25.76\n+      zod-to-json-schema: 3.24.6(zod@3.25.76)\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   '@module-federation/error-codes@0.18.0': {}\n \n   '@module-federation/runtime-core@0.18.0':\n@@ -23671,6 +23858,11 @@ snapshots:\n       mime-types: 2.1.35\n       negotiator: 0.6.3\n \n+  accepts@2.0.0:\n+    dependencies:\n+      mime-types: 3.0.1\n+      negotiator: 1.0.0\n+\n   acorn-globals@7.0.1:\n     dependencies:\n       acorn: 8.14.0\n@@ -24354,6 +24546,20 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  body-parser@2.2.0:\n+    dependencies:\n+      bytes: 3.1.2\n+      content-type: 1.0.5\n+      debug: 4.4.0\n+      http-errors: 2.0.0\n+      iconv-lite: 0.6.3\n+      on-finished: 2.4.1\n+      qs: 6.14.0\n+      raw-body: 3.0.1\n+      type-is: 2.0.1\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   bonjour-service@1.3.0:\n     dependencies:\n       fast-deep-equal: 3.1.3\n@@ -24548,6 +24754,11 @@ snapshots:\n       package-hash: 4.0.0\n       write-file-atomic: 3.0.3\n \n+  call-bind-apply-helpers@1.0.2:\n+    dependencies:\n+      es-errors: 1.3.0\n+      function-bind: 1.1.2\n+\n   call-bind@1.0.2:\n     dependencies:\n       function-bind: 1.1.2\n@@ -24561,6 +24772,11 @@ snapshots:\n       get-intrinsic: 1.2.4\n       set-function-length: 1.2.2\n \n+  call-bound@1.0.4:\n+    dependencies:\n+      call-bind-apply-helpers: 1.0.2\n+      get-intrinsic: 1.3.0\n+\n   caller-callsite@2.0.0:\n     dependencies:\n       callsites: 2.0.0\n@@ -25111,6 +25327,10 @@ snapshots:\n     dependencies:\n       safe-buffer: 5.2.1\n \n+  content-disposition@1.0.0:\n+    dependencies:\n+      safe-buffer: 5.2.1\n+\n   content-type@1.0.4: {}\n \n   content-type@1.0.5: {}\n@@ -25187,6 +25407,8 @@ snapshots:\n \n   cookie-signature@1.0.6: {}\n \n+  cookie-signature@1.2.2: {}\n+\n   cookie@0.4.0: {}\n \n   cookie@0.4.1: {}\n@@ -26314,6 +26536,12 @@ snapshots:\n \n   downsample-lttb@0.0.1: {}\n \n+  dunder-proto@1.0.1:\n+    dependencies:\n+      call-bind-apply-helpers: 1.0.2\n+      es-errors: 1.3.0\n+      gopd: 1.2.0\n+\n   duplexer3@0.1.4: {}\n \n   duplexer@0.1.1: {}\n@@ -26517,6 +26745,8 @@ snapshots:\n     dependencies:\n       get-intrinsic: 1.2.4\n \n+  es-define-property@1.0.1: {}\n+\n   es-errors@1.3.0: {}\n \n   es-get-iterator@1.1.3:\n@@ -26554,6 +26784,10 @@ snapshots:\n     dependencies:\n       es-errors: 1.3.0\n \n+  es-object-atoms@1.1.1:\n+    dependencies:\n+      es-errors: 1.3.0\n+\n   es-set-tostringtag@2.0.3:\n     dependencies:\n       get-intrinsic: 1.2.4\n@@ -27328,6 +27562,12 @@ snapshots:\n \n   events@3.3.0: {}\n \n+  eventsource-parser@3.0.6: {}\n+\n+  eventsource@3.0.7:\n+    dependencies:\n+      eventsource-parser: 3.0.6\n+\n   evp_bytestokey@1.0.3:\n     dependencies:\n       md5.js: 1.3.5\n@@ -27428,6 +27668,10 @@ snapshots:\n       jest-mock: 30.0.0-alpha.6\n       jest-util: 30.0.0-alpha.6\n \n+  express-rate-limit@7.5.1(express@5.1.0):\n+    dependencies:\n+      express: 5.1.0\n+\n   express@4.17.0:\n     dependencies:\n       accepts: 1.3.7\n@@ -27499,6 +27743,38 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  express@5.1.0:\n+    dependencies:\n+      accepts: 2.0.0\n+      body-parser: 2.2.0\n+      content-disposition: 1.0.0\n+      content-type: 1.0.5\n+      cookie: 0.7.1\n+      cookie-signature: 1.2.2\n+      debug: 4.4.0\n+      encodeurl: 2.0.0\n+      escape-html: 1.0.3\n+      etag: 1.8.1\n+      finalhandler: 2.1.0\n+      fresh: 2.0.0\n+      http-errors: 2.0.0\n+      merge-descriptors: 2.0.0\n+      mime-types: 3.0.1\n+      on-finished: 2.4.1\n+      once: 1.4.0\n+      parseurl: 1.3.3\n+      proxy-addr: 2.0.7\n+      qs: 6.14.0\n+      range-parser: 1.2.1\n+      router: 2.2.0\n+      send: 1.2.0\n+      serve-static: 2.2.0\n+      statuses: 2.0.1\n+      type-is: 2.0.1\n+      vary: 1.1.2\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   ext@1.6.0:\n     dependencies:\n       type: 2.5.0\n@@ -27670,6 +27946,17 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  finalhandler@2.1.0:\n+    dependencies:\n+      debug: 4.4.0\n+      encodeurl: 2.0.0\n+      escape-html: 1.0.3\n+      on-finished: 2.4.1\n+      parseurl: 1.3.3\n+      statuses: 2.0.1\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   find-cache-dir@2.1.0:\n     dependencies:\n       commondir: 1.0.1\n@@ -27851,6 +28138,8 @@ snapshots:\n \n   fresh@0.5.2: {}\n \n+  fresh@2.0.0: {}\n+\n   from@0.1.7: {}\n \n   fromentries@1.3.2: {}\n@@ -28053,6 +28342,19 @@ snapshots:\n       has-symbols: 1.0.3\n       hasown: 2.0.2\n \n+  get-intrinsic@1.3.0:\n+    dependencies:\n+      call-bind-apply-helpers: 1.0.2\n+      es-define-property: 1.0.1\n+      es-errors: 1.3.0\n+      es-object-atoms: 1.1.1\n+      function-bind: 1.1.2\n+      get-proto: 1.0.1\n+      gopd: 1.2.0\n+      has-symbols: 1.1.0\n+      hasown: 2.0.2\n+      math-intrinsics: 1.1.0\n+\n   get-nonce@1.0.1: {}\n \n   get-package-type@0.1.0: {}\n@@ -28069,6 +28371,11 @@ snapshots:\n \n   get-port@5.1.1: {}\n \n+  get-proto@1.0.1:\n+    dependencies:\n+      dunder-proto: 1.0.1\n+      es-object-atoms: 1.1.1\n+\n   get-stdin@4.0.1: {}\n \n   get-stream@3.0.0: {}\n@@ -28323,6 +28630,8 @@ snapshots:\n     dependencies:\n       get-intrinsic: 1.2.4\n \n+  gopd@1.2.0: {}\n+\n   got@7.1.0:\n     dependencies:\n       '@types/keyv': 3.1.1\n@@ -28427,6 +28736,8 @@ snapshots:\n \n   has-symbols@1.0.3: {}\n \n+  has-symbols@1.1.0: {}\n+\n   has-to-string-tag-x@1.4.1:\n     dependencies:\n       has-symbol-support-x: 1.4.2\n@@ -28872,6 +29183,10 @@ snapshots:\n     dependencies:\n       safer-buffer: 2.1.2\n \n+  iconv-lite@0.7.0:\n+    dependencies:\n+      safer-buffer: 2.1.2\n+\n   icss-replace-symbols@1.1.0: {}\n \n   icss-utils@5.1.0(postcss@8.4.31):\n@@ -29318,6 +29633,8 @@ snapshots:\n \n   is-potential-custom-element-name@1.0.1: {}\n \n+  is-promise@4.0.0: {}\n+\n   is-reference@1.2.1:\n     dependencies:\n       '@types/estree': 1.0.7\n@@ -30783,6 +31100,8 @@ snapshots:\n \n   markdown-table@3.0.4: {}\n \n+  math-intrinsics@1.1.0: {}\n+\n   maximatch@0.1.0:\n     dependencies:\n       array-differ: 1.0.0\n@@ -31126,6 +31445,8 @@ snapshots:\n \n   media-typer@0.3.0: {}\n \n+  media-typer@1.1.0: {}\n+\n   memfs@3.5.3:\n     dependencies:\n       fs-monkey: 1.0.6\n@@ -31188,6 +31509,8 @@ snapshots:\n \n   merge-descriptors@1.0.3: {}\n \n+  merge-descriptors@2.0.0: {}\n+\n   merge-stream@2.0.0: {}\n \n   merge2@1.4.1: {}\n@@ -31817,6 +32140,8 @@ snapshots:\n \n   mime-db@1.52.0: {}\n \n+  mime-db@1.54.0: {}\n+\n   mime-types@2.1.18:\n     dependencies:\n       mime-db: 1.33.0\n@@ -31825,6 +32150,10 @@ snapshots:\n     dependencies:\n       mime-db: 1.52.0\n \n+  mime-types@3.0.1:\n+    dependencies:\n+      mime-db: 1.54.0\n+\n   mime@1.6.0: {}\n \n   mime@2.5.2: {}\n@@ -32413,6 +32742,8 @@ snapshots:\n \n   object-inspect@1.13.2: {}\n \n+  object-inspect@1.13.4: {}\n+\n   object-is@1.0.2: {}\n \n   object-is@1.1.6:\n@@ -32933,6 +33264,8 @@ snapshots:\n \n   path-to-regexp@6.3.0: {}\n \n+  path-to-regexp@8.3.0: {}\n+\n   path-type@1.1.0:\n     dependencies:\n       graceful-fs: 4.2.11\n@@ -33021,6 +33354,8 @@ snapshots:\n       postcss: 7.0.32\n       reduce-css-calc: 2.1.7\n \n+  pkce-challenge@5.0.0: {}\n+\n   pkg-dir@3.0.0:\n     dependencies:\n       find-up: 3.0.0\n@@ -34020,6 +34355,10 @@ snapshots:\n     dependencies:\n       side-channel: 1.0.6\n \n+  qs@6.14.0:\n+    dependencies:\n+      side-channel: 1.1.0\n+\n   qs@6.5.2: {}\n \n   qs@6.7.0: {}\n@@ -34084,6 +34423,13 @@ snapshots:\n       iconv-lite: 0.4.24\n       unpipe: 1.0.0\n \n+  raw-body@3.0.1:\n+    dependencies:\n+      bytes: 3.1.2\n+      http-errors: 2.0.0\n+      iconv-lite: 0.7.0\n+      unpipe: 1.0.0\n+\n   rc@1.2.8:\n     dependencies:\n       deep-extend: 0.6.0\n@@ -35041,6 +35387,16 @@ snapshots:\n       fsevents: 2.3.3\n     optional: true\n \n+  router@2.2.0:\n+    dependencies:\n+      debug: 4.4.0\n+      depd: 2.0.0\n+      is-promise: 4.0.0\n+      parseurl: 1.3.3\n+      path-to-regexp: 8.3.0\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   run-applescript@7.0.0: {}\n \n   run-async@2.4.1: {}\n@@ -35253,6 +35609,22 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  send@1.2.0:\n+    dependencies:\n+      debug: 4.4.0\n+      encodeurl: 2.0.0\n+      escape-html: 1.0.3\n+      etag: 1.8.1\n+      fresh: 2.0.0\n+      http-errors: 2.0.0\n+      mime-types: 3.0.1\n+      ms: 2.1.3\n+      on-finished: 2.4.1\n+      range-parser: 1.2.1\n+      statuses: 2.0.1\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   sentence-case@3.0.4:\n     dependencies:\n       no-case: 3.0.4\n@@ -35311,6 +35683,15 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  serve-static@2.2.0:\n+    dependencies:\n+      encodeurl: 2.0.0\n+      escape-html: 1.0.3\n+      parseurl: 1.3.3\n+      send: 1.2.0\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   server-only@0.0.1: {}\n \n   set-blocking@2.0.0: {}\n@@ -35411,13 +35792,41 @@ snapshots:\n       '@shikijs/vscode-textmate': 10.0.2\n       '@types/hast': 3.0.4\n \n+  side-channel-list@1.0.0:\n+    dependencies:\n+      es-errors: 1.3.0\n+      object-inspect: 1.13.4\n+\n+  side-channel-map@1.0.1:\n+    dependencies:\n+      call-bound: 1.0.4\n+      es-errors: 1.3.0\n+      get-intrinsic: 1.3.0\n+      object-inspect: 1.13.4\n+\n+  side-channel-weakmap@1.0.2:\n+    dependencies:\n+      call-bound: 1.0.4\n+      es-errors: 1.3.0\n+      get-intrinsic: 1.3.0\n+      object-inspect: 1.13.4\n+      side-channel-map: 1.0.1\n+\n   side-channel@1.0.6:\n     dependencies:\n       call-bind: 1.0.7\n       es-errors: 1.3.0\n       get-intrinsic: 1.2.4\n       object-inspect: 1.13.2\n \n+  side-channel@1.1.0:\n+    dependencies:\n+      es-errors: 1.3.0\n+      object-inspect: 1.13.4\n+      side-channel-list: 1.0.0\n+      side-channel-map: 1.0.1\n+      side-channel-weakmap: 1.0.2\n+\n   siginfo@2.0.0:\n     optional: true\n \n@@ -36558,6 +36967,12 @@ snapshots:\n       media-typer: 0.3.0\n       mime-types: 2.1.35\n \n+  type-is@2.0.1:\n+    dependencies:\n+      content-type: 1.0.5\n+      media-typer: 1.1.0\n+      mime-types: 3.0.1\n+\n   type@1.2.0: {}\n \n   type@2.5.0: {}\n@@ -37846,6 +38261,10 @@ snapshots:\n \n   yoga-wasm-web@0.3.3: {}\n \n+  zod-to-json-schema@3.24.6(zod@3.25.76):\n+    dependencies:\n+      zod: 3.25.76\n+\n   zod-validation-error@3.4.0(zod@3.25.76):\n     dependencies:\n       zod: 3.25.76"
        },
        {
            "sha": "dbce4ea8e3aeb6cb61b81712b62288d5abaf776b",
            "filename": "test/development/mcp-server/fixtures/default-template/app/layout.tsx",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/test%2Fdevelopment%2Fmcp-server%2Ffixtures%2Fdefault-template%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/test%2Fdevelopment%2Fmcp-server%2Ffixtures%2Fdefault-template%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fmcp-server%2Ffixtures%2Fdefault-template%2Fapp%2Flayout.tsx?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -0,0 +1,11 @@\n+export default function RootLayout({\n+  children,\n+}: {\n+  children: React.ReactNode\n+}) {\n+  return (\n+    <html lang=\"en\">\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "e6b54d1ccd8984d7db865818acec20e83f05c9c9",
            "filename": "test/development/mcp-server/fixtures/default-template/app/page.tsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/test%2Fdevelopment%2Fmcp-server%2Ffixtures%2Fdefault-template%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/test%2Fdevelopment%2Fmcp-server%2Ffixtures%2Fdefault-template%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fmcp-server%2Ffixtures%2Fdefault-template%2Fapp%2Fpage.tsx?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -0,0 +1,3 @@\n+export default function Page() {\n+  return <h1>Test MCP Server Page</h1>\n+}"
        },
        {
            "sha": "af294f9d05ca22846065e1fe7afc67cfe9020e0e",
            "filename": "test/development/mcp-server/fixtures/default-template/next.config.js",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/test%2Fdevelopment%2Fmcp-server%2Ffixtures%2Fdefault-template%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/test%2Fdevelopment%2Fmcp-server%2Ffixtures%2Fdefault-template%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fmcp-server%2Ffixtures%2Fdefault-template%2Fnext.config.js?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -0,0 +1,5 @@\n+module.exports = {\n+  experimental: {\n+    mcpServer: true,\n+  },\n+}"
        },
        {
            "sha": "2d21a3c93f598cd74c11805f4a823b2f5cb66100",
            "filename": "test/development/mcp-server/mcp-server.test.ts",
            "status": "added",
            "additions": 135,
            "deletions": 0,
            "changes": 135,
            "blob_url": "https://github.com/vercel/next.js/blob/58a60479550ee4c2e7a3ff5de696c01c196303f9/test%2Fdevelopment%2Fmcp-server%2Fmcp-server.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/58a60479550ee4c2e7a3ff5de696c01c196303f9/test%2Fdevelopment%2Fmcp-server%2Fmcp-server.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fmcp-server%2Fmcp-server.test.ts?ref=58a60479550ee4c2e7a3ff5de696c01c196303f9",
            "patch": "@@ -0,0 +1,135 @@\n+import { FileRef, nextTestSetup } from 'e2e-utils'\n+import path from 'path'\n+\n+describe('mcp-server', () => {\n+  const { next } = nextTestSetup({\n+    files: new FileRef(path.join(__dirname, 'fixtures', 'default-template')),\n+  })\n+\n+  async function initializeMCPSession(\n+    mcpEndpoint: string,\n+    id: string\n+  ): Promise<any> {\n+    const initResponse = await fetch(mcpEndpoint, {\n+      method: 'POST',\n+      headers: {\n+        'Content-Type': 'application/json',\n+        Accept: 'application/json, text/event-stream',\n+      },\n+      body: JSON.stringify({\n+        jsonrpc: '2.0',\n+        id,\n+        method: 'initialize',\n+        params: {\n+          protocolVersion: '1.0.0',\n+          capabilities: {},\n+          clientInfo: {\n+            name: 'test-client',\n+            version: '1.0.0',\n+          },\n+        },\n+      }),\n+    })\n+\n+    const initText = await initResponse.text()\n+    const dataMatch = initText.match(/data: ({.*})/s)\n+    if (!dataMatch) {\n+      throw new Error(`Unexpected response format: ${initText}`)\n+    }\n+\n+    const initResult = JSON.parse(dataMatch[1])\n+    if (initResult.error) {\n+      throw new Error(`MCP error: ${JSON.stringify(initResult.error)}`)\n+    }\n+\n+    return initResult\n+  }\n+\n+  it('should initialize MCP server and list available tools', async () => {\n+    const mcpEndpoint = `${next.url}/_next/mcp`\n+\n+    // Initialize MCP session\n+    const initResult = await initializeMCPSession(mcpEndpoint, 'init-1')\n+\n+    expect(initResult.jsonrpc).toBe('2.0')\n+    expect(initResult.id).toBe('init-1')\n+    expect(initResult.result?.serverInfo?.name).toBe('Next.js MCP Server')\n+\n+    // List available tools\n+    const listToolsResponse = await fetch(mcpEndpoint, {\n+      method: 'POST',\n+      headers: {\n+        'Content-Type': 'application/json',\n+        Accept: 'application/json, text/event-stream',\n+      },\n+      body: JSON.stringify({\n+        jsonrpc: '2.0',\n+        id: 'list-tools-1',\n+        method: 'tools/list',\n+        params: {},\n+      }),\n+    })\n+\n+    const listToolsText = await listToolsResponse.text()\n+    const listToolsDataMatch = listToolsText.match(/data: ({.*})/s)\n+    if (!listToolsDataMatch) {\n+      throw new Error(`Unexpected response format: ${listToolsText}`)\n+    }\n+    const listToolsResult = JSON.parse(listToolsDataMatch[1])\n+\n+    expect(listToolsResult.result?.tools).toBeInstanceOf(Array)\n+\n+    const projectDirTool = listToolsResult.result?.tools?.find(\n+      (tool: { name: string }) => tool.name === 'get_project_path'\n+    )\n+    expect(projectDirTool).toBeDefined()\n+    expect(projectDirTool?.description).toBe(\n+      'Returns the absolute path of the root directory for this Next.js project.'\n+    )\n+  })\n+\n+  it('should return exact absolute path for get_project_path tool', async () => {\n+    const mcpEndpoint = `${next.url}/_next/mcp`\n+\n+    // Initialize MCP session (required before calling tools)\n+    await initializeMCPSession(mcpEndpoint, 'init-2')\n+\n+    // Call get_project_path tool and verify response\n+    const callToolResponse = await fetch(mcpEndpoint, {\n+      method: 'POST',\n+      headers: {\n+        'Content-Type': 'application/json',\n+        Accept: 'application/json, text/event-stream',\n+      },\n+      body: JSON.stringify({\n+        jsonrpc: '2.0',\n+        id: 'call-tool-1',\n+        method: 'tools/call',\n+        params: {\n+          name: 'get_project_path',\n+          arguments: {},\n+        },\n+      }),\n+    })\n+\n+    const callToolText = await callToolResponse.text()\n+    const callToolDataMatch = callToolText.match(/data: ({.*})/s)\n+    if (!callToolDataMatch) {\n+      throw new Error(`Unexpected response format: ${callToolText}`)\n+    }\n+    const callToolResult = JSON.parse(callToolDataMatch[1])\n+\n+    expect(callToolResult.jsonrpc).toBe('2.0')\n+    expect(callToolResult.id).toBe('call-tool-1')\n+\n+    const content = callToolResult.result?.content\n+    expect(content).toBeInstanceOf(Array)\n+    expect(content?.[0]?.type).toBe('text')\n+\n+    // Get the actual project path from the response\n+    const actualProjectPath = content?.[0]?.text\n+\n+    // Project directory should match the test directory from the test harness\n+    expect(actualProjectPath).toBe(next.testDir)\n+  })\n+})"
        }
    ],
    "stats": {
        "total": 729,
        "additions": 729,
        "deletions": 0
    }
}