{
    "author": "mischnic",
    "message": "Turbopack: prevent hanging due to content hashing (#78545)\n\nIf you enable content hashing, you need to use `CurrentChunkMethod::DocumentCurrentScript`, otherwise there's an infinite loop of `getting the current chunk's name for including it in the content <--> building the content of the chunk`\n\nThis was already being done here for next-client: https://github.com/vercel/next.js/blob/fb0abb44bf21ca98848d0b9c7ff45a291cc05e46/crates/next-core/src/next_client/context.rs#L465",
    "sha": "f15416d2c83c106edd13580ffca9fa1299535a8b",
    "files": [
        {
            "sha": "ef7a472301e717e270c0d9863832857689e4ca8a",
            "filename": "turbopack/crates/turbopack-cli/src/build/mod.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/f15416d2c83c106edd13580ffca9fa1299535a8b/turbopack%2Fcrates%2Fturbopack-cli%2Fsrc%2Fbuild%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f15416d2c83c106edd13580ffca9fa1299535a8b/turbopack%2Fcrates%2Fturbopack-cli%2Fsrc%2Fbuild%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-cli%2Fsrc%2Fbuild%2Fmod.rs?ref=f15416d2c83c106edd13580ffca9fa1299535a8b",
            "patch": "@@ -21,7 +21,7 @@ use turbopack::{\n     css::chunk::CssChunkType, ecmascript::chunk::EcmascriptChunkType,\n     global_module_ids::get_global_module_id_strategy,\n };\n-use turbopack_browser::{BrowserChunkingContext, ContentHashing};\n+use turbopack_browser::{BrowserChunkingContext, ContentHashing, CurrentChunkMethod};\n use turbopack_cli_utils::issue::{ConsoleUi, LogOptions};\n use turbopack_core::{\n     asset::Asset,\n@@ -335,6 +335,7 @@ async fn build_internal(\n             )\n             .source_maps(source_maps_type)\n             .module_id_strategy(module_id_strategy)\n+            .current_chunk_method(CurrentChunkMethod::DocumentCurrentScript)\n             .minify_type(minify_type);\n \n             match *node_env.await? {"
        }
    ],
    "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
    }
}