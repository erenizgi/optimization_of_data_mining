{
    "author": "huozhi",
    "message": "[devtool] highlight all link in error message (#86084)",
    "sha": "3f239eea13dec92e55ab65ef641cb52e5abc111c",
    "files": [
        {
            "sha": "752212c0111c72f1fd5ea9c2dc7190afd0f1c8c2",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/hot-linked-text/index.tsx",
            "status": "modified",
            "additions": 19,
            "deletions": 9,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/3f239eea13dec92e55ab65ef641cb52e5abc111c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fhot-linked-text%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3f239eea13dec92e55ab65ef641cb52e5abc111c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fhot-linked-text%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fhot-linked-text%2Findex.tsx?ref=3f239eea13dec92e55ab65ef641cb52e5abc111c",
            "patch": "@@ -5,7 +5,7 @@ const linkRegex = /https?:\\/\\/[^\\s/$.?#].[^\\s)'\"]*/i\n \n export const HotlinkedText: React.FC<{\n   text: string\n-  matcher?: (text: string) => boolean\n+  matcher?: (text: string) => string | null\n }> = function HotlinkedText(props) {\n   const { text, matcher } = props\n \n@@ -24,17 +24,27 @@ export const HotlinkedText: React.FC<{\n                 if (linkRegex.test(rawPart)) {\n                   const link = linkRegex.exec(rawPart)!\n                   const href = link[0]\n-                  // If link matcher is present but the link doesn't match, don't turn it into a link\n-                  if (typeof matcher === 'function' && !matcher(href)) {\n-                    return (\n-                      <React.Fragment key={`link-${outerIndex}-${index}`}>\n-                        {rawPart}\n-                      </React.Fragment>\n-                    )\n+                  // If link matcher is present, check if it returns a className\n+                  let linkClassName: string | null = null\n+                  if (typeof matcher === 'function') {\n+                    linkClassName = matcher(href)\n+                    // If matcher returns null, don't turn it into a link\n+                    if (linkClassName === null) {\n+                      return (\n+                        <React.Fragment key={`link-${outerIndex}-${index}`}>\n+                          {rawPart}\n+                        </React.Fragment>\n+                      )\n+                    }\n                   }\n                   return (\n                     <React.Fragment key={`link-${outerIndex}-${index}`}>\n-                      <a href={href} target=\"_blank\" rel=\"noreferrer noopener\">\n+                      <a\n+                        href={href}\n+                        target=\"_blank\"\n+                        rel=\"noreferrer noopener\"\n+                        className={linkClassName || undefined}\n+                      >\n                         {rawPart}\n                       </a>\n                     </React.Fragment>"
        },
        {
            "sha": "963a984220cb44568937245c28513808787bf14c",
            "filename": "packages/next/src/next-devtools/dev-overlay/container/errors.tsx",
            "status": "modified",
            "additions": 13,
            "deletions": 4,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/3f239eea13dec92e55ab65ef641cb52e5abc111c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcontainer%2Ferrors.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3f239eea13dec92e55ab65ef641cb52e5abc111c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcontainer%2Ferrors.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcontainer%2Ferrors.tsx?ref=3f239eea13dec92e55ab65ef641cb52e5abc111c",
            "patch": "@@ -29,12 +29,18 @@ interface ErrorsProps extends ErrorBaseProps {\n   onClose: () => void\n }\n \n-function isNextjsLink(text: string): boolean {\n-  return text.startsWith('https://nextjs.org')\n+function matchLinkType(text: string): string | null {\n+  if (text.startsWith('https://nextjs.org')) {\n+    return 'nextjs-link'\n+  }\n+  if (text.startsWith('https://') || text.startsWith('http://')) {\n+    return 'external-link'\n+  }\n+  return null\n }\n \n function HydrationErrorDescription({ message }: { message: string }) {\n-  return <HotlinkedText text={message} matcher={isNextjsLink} />\n+  return <HotlinkedText text={message} matcher={matchLinkType} />\n }\n \n function GenericErrorDescription({ error }: { error: Error }) {\n@@ -51,7 +57,7 @@ function GenericErrorDescription({ error }: { error: Error }) {\n \n   return (\n     <>\n-      <HotlinkedText text={message} matcher={isNextjsLink} />\n+      <HotlinkedText text={message} matcher={matchLinkType} />\n     </>\n   )\n }\n@@ -412,4 +418,7 @@ export const styles = `\n     border-radius: var(--rounded-md-2);\n     border: 1px solid var(--color-gray-alpha-400);\n   }\n+  .external-link, .external-link:hover {\n+    color:inherit;\n+  }\n `"
        },
        {
            "sha": "e7e03945032d07740dbdda16e9da51ebd3f8961a",
            "filename": "test/development/acceptance-app/ReactRefreshLogBox.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/3f239eea13dec92e55ab65ef641cb52e5abc111c/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBox.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3f239eea13dec92e55ab65ef641cb52e5abc111c/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBox.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBox.test.ts?ref=3f239eea13dec92e55ab65ef641cb52e5abc111c",
            "patch": "@@ -889,7 +889,6 @@ describe('ReactRefreshLogBox app', () => {\n        }\n       `)\n     }\n-    // Do not highlight example.com but do highlight nextjs.org\n     expect(\n       await session.evaluate(\n         () =>\n@@ -898,7 +897,7 @@ describe('ReactRefreshLogBox app', () => {\n             .shadowRoot.querySelectorAll('#nextjs__container_errors_desc a')\n             .length\n       )\n-    ).toBe(1)\n+    ).toBe(2)\n     expect(\n       await session.evaluate(\n         () =>\n@@ -922,7 +921,7 @@ describe('ReactRefreshLogBox app', () => {\n               ) as any\n           ).href\n       )\n-    ).toBe(null)\n+    ).toBe('http://example.com/')\n   })\n \n   // TODO-APP: Catch errors that happen before useEffect"
        }
    ],
    "stats": {
        "total": 50,
        "additions": 34,
        "deletions": 16
    }
}