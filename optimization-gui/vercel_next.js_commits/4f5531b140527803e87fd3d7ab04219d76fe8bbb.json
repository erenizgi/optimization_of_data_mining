{
    "author": "wbinnssmith",
    "message": "Turbopack: support `config.turbopack` and deprecate `config.experimental.turbopack`. (#77850)\n\nCloses PACK-4263\r\n\r\nThis:\r\n- Adds support for using `config.turbopack` for Turbopack. The accepted value for this option is identical to the previous experimental one without the deprecated field `loaders`.\r\n- Deprecates `config.experimental.turbo`. Warns on its use, but will continue to accept it, merging it with `config.turbopack` while preferring fields on `config.turbopack`.\r\n- also see https://github.com/vercel/next.js/pull/77850#pullrequestreview-2749738760\r\n\r\nTest Plan:\r\n- [x] Convert use of `config.experimental.turbo` in tests to `config.turbopack`\r\n- [x] Automated test for accepting the experimental option for compatibility, as well as the config merging",
    "sha": "4f5531b140527803e87fd3d7ab04219d76fe8bbb",
    "files": [
        {
            "sha": "debb2fb54b1ce6352284da9c9eabb9852d92624d",
            "filename": "bench/heavy-npm-deps/next.config.mjs",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/bench%2Fheavy-npm-deps%2Fnext.config.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/bench%2Fheavy-npm-deps%2Fnext.config.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/bench%2Fheavy-npm-deps%2Fnext.config.mjs?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -7,9 +7,7 @@ const nextConfig = {\n     ignoreBuildErrors: true,\n   },\n   experimental: {\n-    turbo: {\n-      unstablePersistentCaching: process.env.TURBO_CACHE === '1',\n-    },\n+    turbopackPersistentCaching: process.env.TURBO_CACHE === '1',\n   },\n }\n "
        },
        {
            "sha": "6afb9e449684f3e05132e6df324bf9b833cfa721",
            "filename": "crates/next-api/src/project.rs",
            "status": "modified",
            "additions": 22,
            "deletions": 23,
            "changes": 45,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/crates%2Fnext-api%2Fsrc%2Fproject.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/crates%2Fnext-api%2Fsrc%2Fproject.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fproject.rs?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -11,7 +11,7 @@ use next_core::{\n     middleware::middleware_files,\n     mode::NextMode,\n     next_client::{get_client_chunking_context, get_client_compile_time_info},\n-    next_config::{JsConfig, ModuleIdStrategy as ModuleIdStrategyConfig, NextConfig},\n+    next_config::{JsConfig, ModuleIds as ModuleIdStrategyConfig, NextConfig},\n     next_server::{\n         get_server_chunking_context, get_server_chunking_context_with_client_assets,\n         get_server_compile_time_info, get_server_module_options_context,\n@@ -773,7 +773,7 @@ impl Project {\n                 node_build_environment().to_resolved().await?,\n                 next_mode.runtime_type(),\n             )\n-            .source_maps(if *self.next_config().turbo_source_maps().await? {\n+            .source_maps(if *self.next_config().server_source_maps().await? {\n                 SourceMapsType::Full\n             } else {\n                 SourceMapsType::None\n@@ -987,9 +987,9 @@ impl Project {\n             self.next_config().chunk_suffix_path(),\n             self.client_compile_time_info().environment(),\n             self.next_mode(),\n-            self.module_id_strategy(),\n+            self.module_ids(),\n             self.next_config().turbo_minify(self.next_mode()),\n-            self.next_config().turbo_source_maps(),\n+            self.next_config().client_source_maps(self.next_mode()),\n             self.no_mangling(),\n         )\n     }\n@@ -1008,9 +1008,9 @@ impl Project {\n                 self.client_relative_path(),\n                 self.next_config().computed_asset_prefix(),\n                 self.server_compile_time_info().environment(),\n-                self.module_id_strategy(),\n+                self.module_ids(),\n                 self.next_config().turbo_minify(self.next_mode()),\n-                self.next_config().turbo_source_maps(),\n+                self.next_config().server_source_maps(),\n                 self.no_mangling(),\n             )\n         } else {\n@@ -1020,9 +1020,9 @@ impl Project {\n                 self.node_root(),\n                 self.node_root_to_root_path(),\n                 self.server_compile_time_info().environment(),\n-                self.module_id_strategy(),\n+                self.module_ids(),\n                 self.next_config().turbo_minify(self.next_mode()),\n-                self.next_config().turbo_source_maps(),\n+                self.next_config().server_source_maps(),\n                 self.no_mangling(),\n             )\n         }\n@@ -1042,9 +1042,9 @@ impl Project {\n                 self.client_relative_path(),\n                 self.next_config().computed_asset_prefix(),\n                 self.edge_compile_time_info().environment(),\n-                self.module_id_strategy(),\n+                self.module_ids(),\n                 self.next_config().turbo_minify(self.next_mode()),\n-                self.next_config().turbo_source_maps(),\n+                self.next_config().server_source_maps(),\n                 self.no_mangling(),\n             )\n         } else {\n@@ -1054,9 +1054,9 @@ impl Project {\n                 self.node_root(),\n                 self.node_root_to_root_path(),\n                 self.edge_compile_time_info().environment(),\n-                self.module_id_strategy(),\n+                self.module_ids(),\n                 self.next_config().turbo_minify(self.next_mode()),\n-                self.next_config().turbo_source_maps(),\n+                self.next_config().server_source_maps(),\n                 self.no_mangling(),\n             )\n         }\n@@ -1709,17 +1709,16 @@ impl Project {\n \n     /// Gets the module id strategy for the project.\n     #[turbo_tasks::function]\n-    pub async fn module_id_strategy(self: Vc<Self>) -> Result<Vc<Box<dyn ModuleIdStrategy>>> {\n-        let module_id_strategy = if let Some(module_id_strategy) =\n-            &*self.next_config().module_id_strategy_config().await?\n-        {\n-            *module_id_strategy\n-        } else {\n-            match *self.next_mode().await? {\n-                NextMode::Development => ModuleIdStrategyConfig::Named,\n-                NextMode::Build => ModuleIdStrategyConfig::Deterministic,\n-            }\n-        };\n+    pub async fn module_ids(self: Vc<Self>) -> Result<Vc<Box<dyn ModuleIdStrategy>>> {\n+        let module_id_strategy =\n+            if let Some(module_id_strategy) = &*self.next_config().module_ids().await? {\n+                *module_id_strategy\n+            } else {\n+                match *self.next_mode().await? {\n+                    NextMode::Development => ModuleIdStrategyConfig::Named,\n+                    NextMode::Build => ModuleIdStrategyConfig::Deterministic,\n+                }\n+            };\n \n         match module_id_strategy {\n             ModuleIdStrategyConfig::Named => Ok(Vc::upcast(DevModuleIdStrategy::new())),"
        },
        {
            "sha": "9e152fefc049761c64a7668f369a03065143c33d",
            "filename": "crates/next-core/src/next_client/context.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 10,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/crates%2Fnext-core%2Fsrc%2Fnext_client%2Fcontext.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/crates%2Fnext-core%2Fsrc%2Fnext_client%2Fcontext.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_client%2Fcontext.rs?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -329,22 +329,19 @@ pub async fn get_client_module_options_context(\n     let enable_postcss_transform = Some(postcss_transform_options.resolved_cell());\n     let enable_foreign_postcss_transform = Some(postcss_foreign_transform_options.resolved_cell());\n \n+    let source_maps = if *next_config.client_source_maps(mode).await? {\n+        SourceMapsType::Full\n+    } else {\n+        SourceMapsType::None\n+    };\n     let module_options_context = ModuleOptionsContext {\n         ecmascript: EcmascriptOptionsContext {\n             enable_typeof_window_inlining: Some(TypeofWindow::Object),\n-            source_maps: if *next_config.turbo_source_maps().await? {\n-                SourceMapsType::Full\n-            } else {\n-                SourceMapsType::None\n-            },\n+            source_maps,\n             ..Default::default()\n         },\n         css: CssOptionsContext {\n-            source_maps: if *next_config.turbo_source_maps().await? {\n-                SourceMapsType::Full\n-            } else {\n-                SourceMapsType::None\n-            },\n+            source_maps,\n             ..Default::default()\n         },\n         preset_env_versions: Some(env),"
        },
        {
            "sha": "25f50ff6e6c7ad93b1f0f7ea8696656c87328e09",
            "filename": "crates/next-core/src/next_config.rs",
            "status": "modified",
            "additions": 31,
            "deletions": 49,
            "changes": 80,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_config.rs?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -94,6 +94,8 @@ pub struct NextConfig {\n     pub cross_origin: Option<CrossOriginConfig>,\n     pub dev_indicators: Option<DevIndicatorsConfig>,\n     pub output: Option<OutputType>,\n+    pub turbopack: Option<TurbopackConfig>,\n+    production_browser_source_maps: bool,\n \n     /// Enables the bundling of node_modules packages (externals) for pages\n     /// server-side bundles.\n@@ -129,7 +131,6 @@ pub struct NextConfig {\n     http_agent_options: HttpAgentConfig,\n     on_demand_entries: OnDemandEntriesConfig,\n     powered_by_header: bool,\n-    production_browser_source_maps: bool,\n     public_runtime_config: FxIndexMap<String, serde_json::Value>,\n     server_runtime_config: FxIndexMap<String, serde_json::Value>,\n     static_page_generation_timeout: f64,\n@@ -536,17 +537,13 @@ pub enum RemotePatternProtocal {\n     OperationValue,\n )]\n #[serde(rename_all = \"camelCase\")]\n-pub struct ExperimentalTurboConfig {\n+pub struct TurbopackConfig {\n     /// This option has been replaced by `rules`.\n     pub loaders: Option<JsonValue>,\n     pub rules: Option<FxIndexMap<RcStr, RuleConfigItemOrShortcut>>,\n     pub resolve_alias: Option<FxIndexMap<RcStr, JsonValue>>,\n     pub resolve_extensions: Option<Vec<RcStr>>,\n-    pub tree_shaking: Option<bool>,\n-    pub module_id_strategy: Option<ModuleIdStrategy>,\n-    pub minify: Option<bool>,\n-    pub source_maps: Option<bool>,\n-    pub unstable_persistent_caching: Option<bool>,\n+    pub module_ids: Option<ModuleIds>,\n }\n \n #[derive(\n@@ -590,13 +587,13 @@ pub enum LoaderItem {\n #[turbo_tasks::value(operation)]\n #[derive(Copy, Clone, Debug)]\n #[serde(rename_all = \"camelCase\")]\n-pub enum ModuleIdStrategy {\n+pub enum ModuleIds {\n     Named,\n     Deterministic,\n }\n \n #[turbo_tasks::value(transparent)]\n-pub struct OptionModuleIdStrategy(pub Option<ModuleIdStrategy>);\n+pub struct OptionModuleIds(pub Option<ModuleIds>);\n \n #[derive(\n     Clone, Debug, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue, OperationValue,\n@@ -668,7 +665,6 @@ pub struct ExperimentalConfig {\n     mdx_rs: Option<MdxRsOptions>,\n     strict_next_head: Option<bool>,\n     swc_plugins: Option<Vec<(RcStr, serde_json::Value)>>,\n-    turbo: Option<ExperimentalTurboConfig>,\n     external_middleware_rewrites_resolve: Option<bool>,\n     scroll_restoration: Option<bool>,\n     manual_client_base_path: Option<bool>,\n@@ -748,6 +744,11 @@ pub struct ExperimentalConfig {\n     /// (doesn't apply to Turbopack).\n     webpack_build_worker: Option<bool>,\n     worker_threads: Option<bool>,\n+\n+    turbopack_minify: Option<bool>,\n+    turbopack_persistent_caching: Option<bool>,\n+    turbopack_source_maps: Option<bool>,\n+    turbopack_tree_shaking: Option<bool>,\n }\n \n #[derive(\n@@ -1144,12 +1145,7 @@ impl NextConfig {\n \n     #[turbo_tasks::function]\n     pub fn webpack_rules(&self, active_conditions: Vec<RcStr>) -> Vc<OptionWebpackRules> {\n-        let Some(turbo_rules) = self\n-            .experimental\n-            .turbo\n-            .as_ref()\n-            .and_then(|t| t.rules.as_ref())\n-        else {\n+        let Some(turbo_rules) = self.turbopack.as_ref().and_then(|t| t.rules.as_ref()) else {\n             return Vc::cell(None);\n         };\n         if turbo_rules.is_empty() {\n@@ -1234,18 +1230,15 @@ impl NextConfig {\n     pub fn persistent_caching_enabled(&self) -> Result<Vc<bool>> {\n         Ok(Vc::cell(\n             self.experimental\n-                .turbo\n-                .as_ref()\n-                .and_then(|t| t.unstable_persistent_caching)\n+                .turbopack_persistent_caching\n                 .unwrap_or_default(),\n         ))\n     }\n \n     #[turbo_tasks::function]\n     pub fn resolve_alias_options(&self) -> Result<Vc<ResolveAliasMap>> {\n         let Some(resolve_alias) = self\n-            .experimental\n-            .turbo\n+            .turbopack\n             .as_ref()\n             .and_then(|t| t.resolve_alias.as_ref())\n         else {\n@@ -1258,8 +1251,7 @@ impl NextConfig {\n     #[turbo_tasks::function]\n     pub fn resolve_extension(&self) -> Vc<ResolveExtensions> {\n         let Some(resolve_extensions) = self\n-            .experimental\n-            .turbo\n+            .turbopack\n             .as_ref()\n             .and_then(|t| t.resolve_extensions.as_ref())\n         else {\n@@ -1476,13 +1468,7 @@ impl NextConfig {\n         &self,\n         _is_development: bool,\n     ) -> Vc<OptionTreeShaking> {\n-        let tree_shaking = self\n-            .experimental\n-            .turbo\n-            .as_ref()\n-            .and_then(|v| v.tree_shaking);\n-\n-        OptionTreeShaking(match tree_shaking {\n+        OptionTreeShaking(match self.experimental.turbopack_tree_shaking {\n             Some(false) => Some(TreeShakingMode::ReexportsOnly),\n             Some(true) => Some(TreeShakingMode::ModuleFragments),\n             None => Some(TreeShakingMode::ReexportsOnly),\n@@ -1492,13 +1478,7 @@ impl NextConfig {\n \n     #[turbo_tasks::function]\n     pub fn tree_shaking_mode_for_user_code(&self, _is_development: bool) -> Vc<OptionTreeShaking> {\n-        let tree_shaking = self\n-            .experimental\n-            .turbo\n-            .as_ref()\n-            .and_then(|v| v.tree_shaking);\n-\n-        OptionTreeShaking(match tree_shaking {\n+        OptionTreeShaking(match self.experimental.turbopack_tree_shaking {\n             Some(false) => Some(TreeShakingMode::ReexportsOnly),\n             Some(true) => Some(TreeShakingMode::ModuleFragments),\n             None => Some(TreeShakingMode::ReexportsOnly),\n@@ -1507,31 +1487,33 @@ impl NextConfig {\n     }\n \n     #[turbo_tasks::function]\n-    pub fn module_id_strategy_config(&self) -> Vc<OptionModuleIdStrategy> {\n-        let Some(module_id_strategy) = self\n-            .experimental\n-            .turbo\n-            .as_ref()\n-            .and_then(|t| t.module_id_strategy)\n-        else {\n+    pub fn module_ids(&self) -> Vc<OptionModuleIds> {\n+        let Some(module_ids) = self.turbopack.as_ref().and_then(|t| t.module_ids) else {\n             return Vc::cell(None);\n         };\n-        Vc::cell(Some(module_id_strategy))\n+        Vc::cell(Some(module_ids))\n     }\n \n     #[turbo_tasks::function]\n     pub async fn turbo_minify(&self, mode: Vc<NextMode>) -> Result<Vc<bool>> {\n-        let minify = self.experimental.turbo.as_ref().and_then(|t| t.minify);\n-\n+        let minify = self.experimental.turbopack_minify;\n         Ok(Vc::cell(\n             minify.unwrap_or(matches!(*mode.await?, NextMode::Build)),\n         ))\n     }\n \n     #[turbo_tasks::function]\n-    pub async fn turbo_source_maps(&self) -> Result<Vc<bool>> {\n-        let source_maps = self.experimental.turbo.as_ref().and_then(|t| t.source_maps);\n+    pub async fn client_source_maps(&self, _mode: Vc<NextMode>) -> Result<Vc<bool>> {\n+        // Temporarily always enable client source maps as tests regress.\n+        // TODO: Respect both `self.experimental.turbopack_source_maps` and\n+        //       `self.production_browser_source_maps`\n+        let source_maps = self.experimental.turbopack_source_maps;\n+        Ok(Vc::cell(source_maps.unwrap_or(true)))\n+    }\n \n+    #[turbo_tasks::function]\n+    pub async fn server_source_maps(&self) -> Result<Vc<bool>> {\n+        let source_maps = self.experimental.turbopack_source_maps;\n         Ok(Vc::cell(source_maps.unwrap_or(true)))\n     }\n "
        },
        {
            "sha": "4d5758b2637a2e1a2d18b936c619bb2453df0092",
            "filename": "crates/next-core/src/next_server/context.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 10,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fcontext.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fcontext.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fcontext.rs?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -536,25 +536,22 @@ pub async fn get_server_module_options_context(\n         get_styled_components_transform_rule(next_config).await?;\n     let styled_jsx_transform_rule = get_styled_jsx_transform_rule(next_config, versions).await?;\n \n+    let source_maps = if *next_config.server_source_maps().await? {\n+        SourceMapsType::Full\n+    } else {\n+        SourceMapsType::None\n+    };\n     let module_options_context = ModuleOptionsContext {\n         ecmascript: EcmascriptOptionsContext {\n             enable_typeof_window_inlining: Some(TypeofWindow::Undefined),\n             import_externals: *next_config.import_externals().await?,\n             ignore_dynamic_requests: true,\n-            source_maps: if *next_config.turbo_source_maps().await? {\n-                SourceMapsType::Full\n-            } else {\n-                SourceMapsType::None\n-            },\n+            source_maps,\n             ..Default::default()\n         },\n         execution_context: Some(execution_context),\n         css: CssOptionsContext {\n-            source_maps: if *next_config.turbo_source_maps().await? {\n-                SourceMapsType::Full\n-            } else {\n-                SourceMapsType::None\n-            },\n+            source_maps,\n             ..Default::default()\n         },\n         tree_shaking_mode: tree_shaking_mode_for_user_code,"
        },
        {
            "sha": "a5bc7801825ff939291980cdbd17595310afaf82",
            "filename": "docs/01-app/05-api-reference/05-config/01-next-config-js/turbo.mdx",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/docs%2F01-app%2F05-api-reference%2F05-config%2F01-next-config-js%2Fturbo.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/docs%2F01-app%2F05-api-reference%2F05-config%2F01-next-config-js%2Fturbo.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F05-config%2F01-next-config-js%2Fturbo.mdx?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -50,7 +50,7 @@ The following options are available for the `turbo` configuration:\n | `rules`             | List of supported webpack loaders to apply when running with Turbopack. |\n | `resolveAlias`      | Map aliased imports to modules to load in their place.                  |\n | `resolveExtensions` | List of extensions to resolve when importing files.                     |\n-| `moduleIdStrategy`  | Assign module IDs                                                       |\n+| `moduleIds`         | Assign module IDs                                                       |\n | `treeShaking`       | Enable tree shaking for the turbopack dev server and build.             |\n | `memoryLimit`       | A target memory limit for turbo, in bytes.                              |\n \n@@ -157,14 +157,12 @@ Turbopack currently supports two strategies for assigning module IDs:\n \n If not set, Turbopack will use `'named'` for development builds and `'deterministic'` for production builds.\n \n-To configure the module IDs strategy, use the `moduleIdStrategy` field in `next.config.js`:\n+To configure the module IDs strategy, use the `moduleIds` field in `next.config.js`:\n \n ```js filename=\"next.config.js\"\n module.exports = {\n-  experimental: {\n-    turbo: {\n-      moduleIdStrategy: 'deterministic',\n-    },\n+  turbo: {\n+    moduleIds: 'deterministic',\n   },\n }\n ```"
        },
        {
            "sha": "9f26346e65b21e652d24799a24bd016cd246bd60",
            "filename": "docs/01-app/05-api-reference/08-turbopack.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/docs%2F01-app%2F05-api-reference%2F08-turbopack.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/docs%2F01-app%2F05-api-reference%2F08-turbopack.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F05-api-reference%2F08-turbopack.mdx?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -130,7 +130,7 @@ Turbopack can be configured via `next.config.js` (or `next.config.ts`) under the\n   Create manual aliases (like `resolve.alias` in webpack).\n - **`resolveExtensions`**\n   Change or extend file extensions for module resolution.\n-- **`moduleIdStrategy`**\n+- **`moduleIds`**\n   Set how module IDs are generated (`'named'` vs `'deterministic'`).\n - **`treeShaking`**\n   Enable or disable tree shaking in dev and future production builds."
        },
        {
            "sha": "02723cdcc9ef6ad9c7632067139d8bc2b4b8e377",
            "filename": "examples/with-react-native-web/next.config.js",
            "status": "modified",
            "additions": 16,
            "deletions": 18,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/examples%2Fwith-react-native-web%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/examples%2Fwith-react-native-web%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/examples%2Fwith-react-native-web%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -1,24 +1,22 @@\n /** @type {import('next').NextConfig} */\n module.exports = {\n-  experimental: {\n-    turbo: {\n-      resolveAlias: {\n-        \"react-native\": \"react-native-web\",\n-      },\n-      resolveExtensions: [\n-        \".web.js\",\n-        \".web.jsx\",\n-        \".web.ts\",\n-        \".web.tsx\",\n-        \".mdx\",\n-        \".tsx\",\n-        \".ts\",\n-        \".jsx\",\n-        \".js\",\n-        \".mjs\",\n-        \".json\",\n-      ],\n+  turbopack: {\n+    resolveAlias: {\n+      \"react-native\": \"react-native-web\",\n     },\n+    resolveExtensions: [\n+      \".web.js\",\n+      \".web.jsx\",\n+      \".web.ts\",\n+      \".web.tsx\",\n+      \".mdx\",\n+      \".tsx\",\n+      \".ts\",\n+      \".jsx\",\n+      \".js\",\n+      \".mjs\",\n+      \".json\",\n+    ],\n   },\n   webpack: (config) => {\n     config.resolve.alias = {"
        },
        {
            "sha": "fe3e34ad458dbdb75505fb0e39373c5b47ccfb51",
            "filename": "examples/with-turbopack-loaders/next.config.js",
            "status": "modified",
            "additions": 9,
            "deletions": 11,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/examples%2Fwith-turbopack-loaders%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/examples%2Fwith-turbopack-loaders%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/examples%2Fwith-turbopack-loaders%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -1,15 +1,13 @@\n module.exports = {\n-  experimental: {\n-    turbo: {\n-      rules: {\n-        \"*.react.svg\": {\n-          loaders: [\"@svgr/webpack\"],\n-          as: \"*.js\",\n-        },\n-        \"*.styl\": {\n-          loaders: [\"stylus-loader\"],\n-          as: \"*.css\",\n-        },\n+  turbopack: {\n+    rules: {\n+      \"*.react.svg\": {\n+        loaders: [\"@svgr/webpack\"],\n+        as: \"*.js\",\n+      },\n+      \"*.styl\": {\n+        loaders: [\"stylus-loader\"],\n+        as: \"*.css\",\n       },\n     },\n   },"
        },
        {
            "sha": "2abd408f87c4bc4203197a0a9e699066466297d1",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -3756,9 +3756,14 @@ function warnAboutTurbopackBuilds(config?: NextConfigComplete) {\n       `We don't recommend deploying mission-critical applications to production.`\n     )\n   warningStr +=\n-    '\\n\\n- It is expected that your bundle size might be different from `next build` with webpack. This will be improved as we work towards stability.'\n+    '\\n\\n- ' +\n+    bold(\n+      'Turbopack currently always builds production sourcemaps for the browser. This will include project sourcecode if deployed to production.'\n+    )\n+  warningStr +=\n+    '\\n- It is expected that your bundle size might be different from `next build` with webpack. This will be improved as we work towards stability.'\n \n-  if (!config?.experimental.turbo?.unstablePersistentCaching) {\n+  if (!config?.experimental.turbopackPersistentCaching) {\n     warningStr +=\n       '\\n- This build is without disk caching; subsequent builds will become faster when disk caching becomes available.'\n   }"
        },
        {
            "sha": "f868b6a994b603b104c694fd0310f0f060bf43a0",
            "filename": "packages/next/src/build/swc/index.ts",
            "status": "modified",
            "additions": 19,
            "deletions": 16,
            "changes": 35,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Findex.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -10,10 +10,10 @@ import { patchIncorrectLockfile } from '../../lib/patch-incorrect-lockfile'\n import { downloadNativeNextSwc, downloadWasmSwc } from '../../lib/download-swc'\n import type {\n   NextConfigComplete,\n-  TurboLoaderItem,\n-  TurboRuleConfigItem,\n-  TurboRuleConfigItemOptions,\n-  TurboRuleConfigItemOrShortcut,\n+  TurbopackLoaderItem,\n+  TurbopackRuleConfigItem,\n+  TurbopackRuleConfigItemOptions,\n+  TurbopackRuleConfigItemOrShortcut,\n } from '../../server/config-shared'\n import { isDeepStrictEqual } from 'util'\n import {\n@@ -786,24 +786,24 @@ function bindingToApi(\n     if (reactCompilerOptions) {\n       const ruleKeys = ['*.ts', '*.js', '*.jsx', '*.tsx']\n       if (\n-        Object.keys(nextConfig?.experimental?.turbo?.rules ?? []).some((key) =>\n+        Object.keys(nextConfig?.turbopack?.rules ?? []).some((key) =>\n           ruleKeys.includes(key)\n         )\n       ) {\n         Log.warn(\n-          `The React Compiler cannot be enabled automatically because 'experimental.turbo' contains a rule for '*.ts', '*.js', '*.jsx', and '*.tsx'. Remove this rule, or add 'babel-loader' and 'babel-plugin-react-compiler' to the Turbopack configuration manually.`\n+          `The React Compiler cannot be enabled automatically because 'turbopack.rules' contains a rule for '*.ts', '*.js', '*.jsx', and '*.tsx'. Remove this rule, or add 'babel-loader' and 'babel-plugin-react-compiler' to the Turbopack configuration manually.`\n         )\n       } else {\n-        if (!nextConfig.experimental.turbo) {\n-          nextConfig.experimental.turbo = {}\n+        if (!nextConfig.turbopack) {\n+          nextConfig.turbopack = {}\n         }\n \n-        if (!nextConfig.experimental.turbo.rules) {\n-          nextConfig.experimental.turbo.rules = {}\n+        if (!nextConfig.turbopack.rules) {\n+          nextConfig.turbopack.rules = {}\n         }\n \n         for (const key of ['*.ts', '*.js', '*.jsx', '*.tsx']) {\n-          nextConfig.experimental.turbo.rules[key] = {\n+          nextConfig.turbopack.rules[key] = {\n             browser: {\n               foreign: false,\n               loaders: [\n@@ -840,7 +840,7 @@ function bindingToApi(\n \n     if (nextConfigSerializable.experimental?.turbo?.rules) {\n       ensureLoadersHaveSerializableOptions(\n-        nextConfigSerializable.experimental.turbo?.rules\n+        nextConfigSerializable.turbopack?.rules\n       )\n     }\n \n@@ -878,7 +878,7 @@ function bindingToApi(\n   }\n \n   function ensureLoadersHaveSerializableOptions(\n-    turbopackRules: Record<string, TurboRuleConfigItemOrShortcut>\n+    turbopackRules: Record<string, TurbopackRuleConfigItemOrShortcut>\n   ) {\n     for (const [glob, rule] of Object.entries(turbopackRules)) {\n       if (Array.isArray(rule)) {\n@@ -888,10 +888,10 @@ function bindingToApi(\n       }\n     }\n \n-    function checkConfigItem(rule: TurboRuleConfigItem, glob: string) {\n+    function checkConfigItem(rule: TurbopackRuleConfigItem, glob: string) {\n       if (!rule) return\n       if ('loaders' in rule) {\n-        checkLoaderItems((rule as TurboRuleConfigItemOptions).loaders, glob)\n+        checkLoaderItems((rule as TurbopackRuleConfigItemOptions).loaders, glob)\n       } else {\n         for (const key in rule) {\n           const inner = rule[key]\n@@ -902,7 +902,10 @@ function bindingToApi(\n       }\n     }\n \n-    function checkLoaderItems(loaderItems: TurboLoaderItem[], glob: string) {\n+    function checkLoaderItems(\n+      loaderItems: TurbopackLoaderItem[],\n+      glob: string\n+    ) {\n       for (const loaderItem of loaderItems) {\n         if (\n           typeof loaderItem !== 'string' &&"
        },
        {
            "sha": "d36347e85432811ab6f15b32d9c78eb759df1a14",
            "filename": "packages/next/src/build/turbopack-build/impl.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-build%2Fimpl.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-build%2Fimpl.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-build%2Fimpl.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -54,8 +54,7 @@ export async function turbopackBuild(): Promise<{\n   const project = await bindings.turbo.createProject(\n     {\n       projectPath: dir,\n-      rootPath:\n-        config.experimental?.turbo?.root || config.outputFileTracingRoot || dir,\n+      rootPath: config.turbopack?.root || config.outputFileTracingRoot || dir,\n       distDir,\n       nextConfig: config,\n       jsConfig: await getTurbopackJsConfig(dir, config),\n@@ -83,7 +82,7 @@ export async function turbopackBuild(): Promise<{\n     },\n     {\n       persistentCaching,\n-      memoryLimit: config.experimental.turbo?.memoryLimit,\n+      memoryLimit: config.experimental?.turbopackMemoryLimit,\n       dependencyTracking: persistentCaching,\n     }\n   )"
        },
        {
            "sha": "981ade96cc3cb679cec61dd7d0f2fa6a647d16fe",
            "filename": "packages/next/src/lib/turbopack-warning.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Flib%2Fturbopack-warning.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Flib%2Fturbopack-warning.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fturbopack-warning.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -144,7 +144,7 @@ export async function validateTurboNextConfig({\n       if (key.startsWith('webpack') && rawNextConfig.webpack) {\n         hasWebpackConfig = true\n       }\n-      if (key.startsWith('experimental.turbo')) {\n+      if (key.startsWith('turbopack')) {\n         hasTurboConfig = true\n       }\n "
        },
        {
            "sha": "1c241725af04c8c4ee160da00ddfd5aa48d16824",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 61,
            "deletions": 39,
            "changes": 100,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -7,10 +7,12 @@ import type zod from 'next/dist/compiled/zod'\n import type { SizeLimit } from '../types'\n import type {\n   ExportPathMap,\n-  TurboLoaderItem,\n-  TurboRuleConfigItem,\n-  TurboRuleConfigItemOptions,\n-  TurboRuleConfigItemOrShortcut,\n+  TurbopackLoaderItem,\n+  DeprecatedExperimentalTurboOptions,\n+  TurbopackOptions,\n+  TurbopackRuleConfigItem,\n+  TurbopackRuleConfigItemOptions,\n+  TurbopackRuleConfigItemOrShortcut,\n } from './config-shared'\n import type {\n   Header,\n@@ -99,7 +101,7 @@ const zHeader: zod.ZodType<Header> = z.object({\n   internal: z.boolean().optional(),\n })\n \n-const zTurboLoaderItem: zod.ZodType<TurboLoaderItem> = z.union([\n+const zTurboLoaderItem: zod.ZodType<TurbopackLoaderItem> = z.union([\n   z.string(),\n   z.object({\n     loader: z.string(),\n@@ -108,24 +110,64 @@ const zTurboLoaderItem: zod.ZodType<TurboLoaderItem> = z.union([\n   }),\n ])\n \n-const zTurboRuleConfigItemOptions: zod.ZodType<TurboRuleConfigItemOptions> =\n+const zTurboRuleConfigItemOptions: zod.ZodType<TurbopackRuleConfigItemOptions> =\n   z.object({\n     loaders: z.array(zTurboLoaderItem),\n     as: z.string().optional(),\n   })\n \n-const zTurboRuleConfigItem: zod.ZodType<TurboRuleConfigItem> = z.union([\n+const zTurboRuleConfigItem: zod.ZodType<TurbopackRuleConfigItem> = z.union([\n   z.literal(false),\n   z.record(\n     z.string(),\n     z.lazy(() => zTurboRuleConfigItem)\n   ),\n   zTurboRuleConfigItemOptions,\n ])\n-\n-const zTurboRuleConfigItemOrShortcut: zod.ZodType<TurboRuleConfigItemOrShortcut> =\n+const zTurboRuleConfigItemOrShortcut: zod.ZodType<TurbopackRuleConfigItemOrShortcut> =\n   z.union([z.array(zTurboLoaderItem), zTurboRuleConfigItem])\n \n+const zTurbopackConfig: zod.ZodType<TurbopackOptions> = z.strictObject({\n+  rules: z.record(z.string(), zTurboRuleConfigItemOrShortcut).optional(),\n+  resolveAlias: z\n+    .record(\n+      z.string(),\n+      z.union([\n+        z.string(),\n+        z.array(z.string()),\n+        z.record(z.string(), z.union([z.string(), z.array(z.string())])),\n+      ])\n+    )\n+    .optional(),\n+  resolveExtensions: z.array(z.string()).optional(),\n+  moduleIds: z.enum(['named', 'deterministic']).optional(),\n+})\n+\n+// Same as zTurbopackConfig but with deprecated properties. Unfortunately, base\n+// properties are duplicated here as `ZodType`s do not export `extend()`.\n+const zDeprecatedExperimentalTurboConfig: zod.ZodType<DeprecatedExperimentalTurboOptions> =\n+  z.strictObject({\n+    loaders: z.record(z.string(), z.array(zTurboLoaderItem)).optional(),\n+    rules: z.record(z.string(), zTurboRuleConfigItemOrShortcut).optional(),\n+    resolveAlias: z\n+      .record(\n+        z.string(),\n+        z.union([\n+          z.string(),\n+          z.array(z.string()),\n+          z.record(z.string(), z.union([z.string(), z.array(z.string())])),\n+        ])\n+      )\n+      .optional(),\n+    resolveExtensions: z.array(z.string()).optional(),\n+    treeShaking: z.boolean().optional(),\n+    persistentCaching: z.union([z.number(), z.literal(false)]).optional(),\n+    memoryLimit: z.number().optional(),\n+    moduleIds: z.enum(['named', 'deterministic']).optional(),\n+    minify: z.boolean().optional(),\n+    sourceMaps: z.boolean().optional(),\n+  })\n+\n export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n   z.strictObject({\n     allowedDevOrigins: z.array(z.string()).optional(),\n@@ -392,36 +434,15 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n         typedRoutes: z.boolean().optional(),\n         webpackBuildWorker: z.boolean().optional(),\n         webpackMemoryOptimizations: z.boolean().optional(),\n-        turbo: z\n-          .object({\n-            loaders: z.record(z.string(), z.array(zTurboLoaderItem)).optional(),\n-            rules: z\n-              .record(z.string(), zTurboRuleConfigItemOrShortcut)\n-              .optional(),\n-            resolveAlias: z\n-              .record(\n-                z.string(),\n-                z.union([\n-                  z.string(),\n-                  z.array(z.string()),\n-                  z.record(\n-                    z.string(),\n-                    z.union([z.string(), z.array(z.string())])\n-                  ),\n-                ])\n-              )\n-              .optional(),\n-            resolveExtensions: z.array(z.string()).optional(),\n-            treeShaking: z.boolean().optional(),\n-            persistentCaching: z\n-              .union([z.number(), z.literal(false)])\n-              .optional(),\n-            memoryLimit: z.number().optional(),\n-            moduleIdStrategy: z.enum(['named', 'deterministic']).optional(),\n-            minify: z.boolean().optional(),\n-            sourceMaps: z.boolean().optional(),\n-          })\n-          .optional(),\n+        /**\n+         * @deprecated Use `config.turbopack` instead.\n+         */\n+        turbo: zDeprecatedExperimentalTurboConfig.optional(),\n+        turbopackMemoryLimit: z.number().optional(),\n+        turbopackMinify: z.boolean().optional(),\n+        turbopackPersistentCaching: z.boolean().optional(),\n+        turbopackSourceMaps: z.boolean().optional(),\n+        turbopackTreeShaking: z.boolean().optional(),\n         optimizePackageImports: z.array(z.string()).optional(),\n         optimizeServerReact: z.boolean().optional(),\n         clientTraceMetadata: z.array(z.string()).optional(),\n@@ -658,6 +679,7 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n     target: z.string().optional(),\n     trailingSlash: z.boolean().optional(),\n     transpilePackages: z.array(z.string()).optional(),\n+    turbopack: zTurbopackConfig.optional(),\n     typescript: z\n       .strictObject({\n         ignoreBuildErrors: z.boolean().optional(),"
        },
        {
            "sha": "58ef34ec596853e1b6f25470e7e1f0ff9e13add5",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 72,
            "deletions": 34,
            "changes": 106,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -23,7 +23,7 @@ export type NextConfigComplete = Required<NextConfig> & {\n   // override NextConfigComplete.experimental.htmlLimitedBots to string\n   // because it's not defined in NextConfigComplete.experimental\n   htmlLimitedBots: string | undefined\n-  experimental: ExperimentalConfig\n+  experimental: Omit<ExperimentalConfig, 'turbo'>\n }\n \n export type I18NDomains = readonly DomainLocale[]\n@@ -94,29 +94,32 @@ type JSONValue =\n   | JSONValue[]\n   | { [k: string]: JSONValue }\n \n-export type TurboLoaderItem =\n+/**\n+ * @deprecated Use `TurbopackRuleConfigItem` instead.\n+ */\n+export type TurbopackLoaderItem =\n   | string\n   | {\n       loader: string\n       // At the moment, Turbopack options must be JSON-serializable, so restrict values.\n       options: Record<string, JSONValue>\n     }\n \n-export type TurboRuleConfigItemOrShortcut =\n-  | TurboLoaderItem[]\n-  | TurboRuleConfigItem\n+export type TurbopackRuleConfigItemOrShortcut =\n+  | TurbopackLoaderItem[]\n+  | TurbopackRuleConfigItem\n \n-export type TurboRuleConfigItemOptions = {\n-  loaders: TurboLoaderItem[]\n+export type TurbopackRuleConfigItemOptions = {\n+  loaders: TurbopackLoaderItem[]\n   as?: string\n }\n \n-export type TurboRuleConfigItem =\n-  | TurboRuleConfigItemOptions\n-  | { [condition: string]: TurboRuleConfigItem }\n+export type TurbopackRuleConfigItem =\n+  | TurbopackRuleConfigItemOptions\n+  | { [condition: string]: TurbopackRuleConfigItem }\n   | false\n \n-export interface ExperimentalTurboOptions {\n+export interface TurbopackOptions {\n   /**\n    * (`next --turbopack` only) A mapping of aliased imports to modules to load in their place.\n    *\n@@ -139,50 +142,52 @@ export interface ExperimentalTurboOptions {\n    *\n    * @see [Turbopack Loaders](https://nextjs.org/docs/app/api-reference/next-config-js/turbo#webpack-loaders)\n    */\n-  loaders?: Record<string, TurboLoaderItem[]>\n+  rules?: Record<string, TurbopackRuleConfigItemOrShortcut>\n+\n+  /**\n+   * The module ID strategy to use for Turbopack.\n+   * If not set, the default is `'named'` for development and `'deterministic'`\n+   * for production.\n+   */\n+  moduleIds?: 'named' | 'deterministic'\n+\n+  /**\n+   * This is the repo root usually and only files above this\n+   * directory can be resolved by turbopack.\n+   */\n+  root?: string\n+}\n \n+export interface DeprecatedExperimentalTurboOptions extends TurbopackOptions {\n   /**\n    * (`next --turbopack` only) A list of webpack loaders to apply when running with Turbopack.\n    *\n+   * @deprecated Use `rules` instead.\n    * @see [Turbopack Loaders](https://nextjs.org/docs/app/api-reference/next-config-js/turbo#webpack-loaders)\n    */\n-  rules?: Record<string, TurboRuleConfigItemOrShortcut>\n+  loaders?: Record<string, TurbopackLoaderItem[]>\n \n   /**\n    * A target memory limit for turbo, in bytes.\n+   * @deprecated Use `experimental.turbopackMemoryLimit` instead.\n    */\n   memoryLimit?: number\n \n   /**\n-   * Enable persistent caching for the turbopack dev server and build.\n+   * Enable minification. Defaults to true in build mode and false in dev mode.\n+   * @deprecated Use `experimental.turbopackMinify` instead.\n    */\n-  unstablePersistentCaching?: boolean\n+  minify?: boolean\n \n   /**\n    * Enable tree shaking for the turbopack dev server and build.\n+   * @deprecated Use `experimental.turbopackTreeShaking` instead.\n    */\n   treeShaking?: boolean\n \n-  /**\n-   * The module ID strategy to use for Turbopack.\n-   * If not set, the default is `'named'` for development and `'deterministic'`\n-   * for production.\n-   */\n-  moduleIdStrategy?: 'named' | 'deterministic'\n-\n-  /**\n-   * This is the repo root usually and only files above this\n-   * directory can be resolved by turbopack.\n-   */\n-  root?: string\n-\n-  /**\n-   * Enable minification. Defaults to true in build mode and false in dev mode.\n-   */\n-  minify?: boolean\n-\n   /**\n    * Enable source maps. Defaults to true.\n+   * @deprecated Use `experimental.turbopackSourceMaps` instead.\n    */\n   sourceMaps?: boolean\n }\n@@ -377,7 +382,35 @@ export interface ExperimentalConfig {\n    */\n   optimizeServerReact?: boolean\n \n-  turbo?: ExperimentalTurboOptions\n+  /**\n+   * @deprecated Use `config.turbopack` instead.\n+   */\n+  turbo?: DeprecatedExperimentalTurboOptions\n+\n+  /**\n+   * A target memory limit for turbo, in bytes.\n+   */\n+  turbopackMemoryLimit?: number\n+\n+  /**\n+   * Enable minification. Defaults to true in build mode and false in dev mode.\n+   */\n+  turbopackMinify?: boolean\n+\n+  /**\n+   * Enable persistent caching for the turbopack dev server and build.\n+   */\n+  turbopackPersistentCaching?: boolean\n+\n+  /**\n+   * Enable source maps. Defaults to true.\n+   */\n+  turbopackSourceMaps?: boolean\n+\n+  /**\n+   * Enable tree shaking for the turbopack dev server and build.\n+   */\n+  turbopackTreeShaking?: boolean\n \n   /**\n    * For use with `@next/mdx`. Compile MDX files using the new Rust compiler.\n@@ -1017,6 +1050,11 @@ export interface NextConfig extends Record<string, any> {\n    */\n   transpilePackages?: string[]\n \n+  /**\n+   * Options for Turbopack. Temporarily also available as `experimental.turbo` for compatibility.\n+   */\n+  turbopack?: TurbopackOptions\n+\n   skipMiddlewareUrlNormalize?: boolean\n \n   skipTrailingSlashRedirect?: boolean"
        },
        {
            "sha": "4ec04e82f896e5959831b72bac66bcd06360faaa",
            "filename": "packages/next/src/server/config.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.test.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -127,14 +127,12 @@ describe('loadConfig', () => {\n         loadConfig('', __dirname, {\n           customConfig: {\n             experimental: {\n-              turbo: {\n-                unstablePersistentCaching: true,\n-              },\n+              turbopackPersistentCaching: true,\n             },\n           },\n         })\n       ).rejects.toThrow(\n-        /The experimental feature \"experimental.turbo.unstablePersistentCaching\" can only be enabled when using the latest canary version of Next.js./\n+        /The experimental feature \"experimental.turbopackPersistentCaching\" can only be enabled when using the latest canary version of Next.js./\n       )\n     })\n   })"
        },
        {
            "sha": "408de088c3e64c0eacb5b8eaa00ae3d679d95e78",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 33,
            "deletions": 22,
            "changes": 55,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -9,7 +9,7 @@ import type {\n   ExperimentalConfig,\n   NextConfigComplete,\n   NextConfig,\n-  TurboLoaderItem,\n+  TurbopackLoaderItem,\n } from './config-shared'\n \n import { loadWebpackHook } from './config-utils'\n@@ -251,9 +251,9 @@ function assignDefaults(\n       throw new CanaryOnlyError({ feature: 'experimental.ppr' })\n     } else if (result.experimental?.dynamicIO) {\n       throw new CanaryOnlyError({ feature: 'experimental.dynamicIO' })\n-    } else if (result.experimental?.turbo?.unstablePersistentCaching) {\n+    } else if (result.experimental?.turbopackPersistentCaching) {\n       throw new CanaryOnlyError({\n-        feature: 'experimental.turbo.unstablePersistentCaching',\n+        feature: 'experimental.turbopackPersistentCaching',\n       })\n     } else if (result.experimental?.nodeMiddleware) {\n       throw new CanaryOnlyError({ feature: 'experimental.nodeMiddleware' })\n@@ -655,14 +655,11 @@ function assignDefaults(\n     }\n   }\n \n-  if (\n-    result?.experimental?.turbo?.root &&\n-    !isAbsolute(result.experimental.turbo.root)\n-  ) {\n-    result.experimental.turbo.root = resolve(result.experimental.turbo.root)\n+  if (result?.turbopack?.root && !isAbsolute(result.turbopack.root)) {\n+    result.turbopack.root = resolve(result.turbopack.root)\n     if (!silent) {\n       Log.warn(\n-        `experimental.turbo.root should be absolute, using: ${result.experimental.turbo.root}`\n+        `turbopack.root should be absolute, using: ${result.turbopack.root}`\n       )\n     }\n   }\n@@ -672,27 +669,21 @@ function assignDefaults(\n     result.deploymentId = process.env.NEXT_DEPLOYMENT_ID\n   }\n \n-  if (result?.outputFileTracingRoot && !result?.experimental?.turbo?.root) {\n-    dset(\n-      result,\n-      ['experimental', 'turbo', 'root'],\n-      result.outputFileTracingRoot\n-    )\n+  if (result?.outputFileTracingRoot && !result?.turbopack?.root) {\n+    dset(result, ['turbopack', 'root'], result.outputFileTracingRoot)\n   }\n \n   // use the closest lockfile as tracing root\n-  if (!result?.outputFileTracingRoot || !result?.experimental?.turbo?.root) {\n+  if (!result?.outputFileTracingRoot || !result?.turbopack?.root) {\n     let rootDir = findRootDir(dir)\n \n     if (rootDir) {\n       if (!result?.outputFileTracingRoot) {\n         result.outputFileTracingRoot = rootDir\n-        defaultConfig.outputFileTracingRoot = result.outputFileTracingRoot\n       }\n \n-      if (!result?.experimental?.turbo?.root) {\n-        dset(result, ['experimental', 'turbo', 'root'], rootDir)\n-        dset(defaultConfig, ['experimental', 'turbo', 'root'], rootDir)\n+      if (!result?.turbopack?.root) {\n+        dset(result, ['turbopack', 'root'], rootDir)\n       }\n     }\n   }\n@@ -1273,16 +1264,36 @@ export default async function loadConfig(\n           'See more info here https://nextjs.org/docs/app/api-reference/next-config-js/turbo'\n       )\n \n-      const rules: Record<string, TurboLoaderItem[]> = {}\n+      const rules: Record<string, TurbopackLoaderItem[]> = {}\n       for (const [ext, loaders] of Object.entries(\n         userConfig.experimental.turbo.loaders\n       )) {\n-        rules['*' + ext] = loaders as TurboLoaderItem[]\n+        rules['*' + ext] = loaders as TurbopackLoaderItem[]\n       }\n \n       userConfig.experimental.turbo.rules = rules\n     }\n \n+    if (userConfig.experimental?.turbo) {\n+      curLog.warn(\n+        'The config property `experimental.turbo` is deprecated. Move this setting to `config.turbopack` as Turbopack is now stable.'\n+      )\n+\n+      // Merge the two configs, preferring values in `config.turbopack`.\n+      userConfig.turbopack = {\n+        ...userConfig.experimental.turbo,\n+        ...userConfig.turbopack,\n+      }\n+      userConfig.experimental.turbopackMemoryLimit ??=\n+        userConfig.experimental.turbo.memoryLimit\n+      userConfig.experimental.turbopackMinify ??=\n+        userConfig.experimental.turbo.minify\n+      userConfig.experimental.turbopackTreeShaking ??=\n+        userConfig.experimental.turbo.treeShaking\n+      userConfig.experimental.turbopackSourceMaps ??=\n+        userConfig.experimental.turbo.sourceMaps\n+    }\n+\n     if (userConfig.experimental?.useLightningcss) {\n       const { loadBindings } = require('next/dist/build/swc')\n       const isLightningSupported = (await loadBindings())?.css?.lightning"
        },
        {
            "sha": "33471bc56fa28591f785433999f1a9ba021c15ab",
            "filename": "packages/next/src/server/dev/hot-reloader-turbopack.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -209,7 +209,7 @@ export async function createHotReloaderTurbopack(\n     {\n       projectPath: projectPath,\n       rootPath:\n-        opts.nextConfig.experimental.turbo?.root ||\n+        opts.nextConfig.turbopack?.root ||\n         opts.nextConfig.outputFileTracingRoot ||\n         projectPath,\n       distDir,\n@@ -240,7 +240,7 @@ export async function createHotReloaderTurbopack(\n     },\n     {\n       persistentCaching: isPersistentCachingEnabled(opts.nextConfig),\n-      memoryLimit: opts.nextConfig.experimental.turbo?.memoryLimit,\n+      memoryLimit: opts.nextConfig.experimental?.turbopackMemoryLimit,\n     }\n   )\n   setBundlerFindSourceMapImplementation("
        },
        {
            "sha": "a27e0805fd1701a773f652f6dd9a4ff82fed1e20",
            "filename": "packages/next/src/shared/lib/turbopack/utils.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fturbopack%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fturbopack%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fturbopack%2Futils.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -262,5 +262,5 @@ export function renderStyledStringToErrorAnsi(string: StyledString): string {\n export function isPersistentCachingEnabled(\n   config: NextConfigComplete\n ): boolean {\n-  return config.experimental.turbo?.unstablePersistentCaching || false\n+  return config.experimental?.turbopackPersistentCaching || false\n }"
        },
        {
            "sha": "dcae192243b050dbe9b58db561ac56ab076818cd",
            "filename": "test/e2e/app-dir/react-owner-stacks-svgr/next.config.js",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Freact-owner-stacks-svgr%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Freact-owner-stacks-svgr%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Freact-owner-stacks-svgr%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -2,13 +2,11 @@\n  * @type {import('next').NextConfig}\n  */\n const nextConfig = {\n-  experimental: {\n-    turbo: {\n-      rules: {\n-        '*.svg': {\n-          loaders: ['@svgr/webpack'],\n-          as: '*.js',\n-        },\n+  turbopack: {\n+    rules: {\n+      '*.svg': {\n+        loaders: ['@svgr/webpack'],\n+        as: '*.js',\n       },\n     },\n   },"
        },
        {
            "sha": "86973b6a8ec43ab1c1b01528989c1f1807d4cd7e",
            "filename": "test/e2e/app-dir/resolve-extensions/next.config.js",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fresolve-extensions%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fresolve-extensions%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fresolve-extensions%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -4,10 +4,8 @@ const extensions = ['', '.png', '.tsx', '.ts', '.jsx', '.js', '.json']\n  * @type {import('next').NextConfig}\n  */\n const nextConfig = {\n-  experimental: {\n-    turbo: {\n-      resolveExtensions: [...extensions],\n-    },\n+  turbopack: {\n+    resolveExtensions: [...extensions],\n   },\n   webpack(config) {\n     config.resolve.extensions = [...extensions]"
        },
        {
            "sha": "78f6df4b5d7fd8e67f90e8d7c0d3157d7f57a5af",
            "filename": "test/e2e/app-dir/scss/npm-import-tilde/npm-import-tilde.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fscss%2Fnpm-import-tilde%2Fnpm-import-tilde.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fscss%2Fnpm-import-tilde%2Fnpm-import-tilde.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Fnpm-import-tilde%2Fnpm-import-tilde.test.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -3,12 +3,10 @@\n import { nextTestSetup } from 'e2e-utils'\n \n const nextConfig = {\n-  experimental: {\n-    turbo: {\n-      resolveAlias: {\n-        '/*': './*',\n-        '~*': '*',\n-      },\n+  turbopack: {\n+    resolveAlias: {\n+      '/*': './*',\n+      '~*': '*',\n     },\n   },\n }"
        },
        {
            "sha": "4692bd3a5bea808e528397d1c5e49126b5debf63",
            "filename": "test/e2e/app-dir/turbopack-loader-resource-query/next.config.js",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fturbopack-loader-resource-query%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fturbopack-loader-resource-query%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fturbopack-loader-resource-query%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -1,12 +1,10 @@\n /** @type {import('next').NextConfig} */\n const nextConfig = {\n-  experimental: {\n-    turbo: {\n-      rules: {\n-        '*.mdx': {\n-          loaders: ['test-loader.js'],\n-          as: '*.js',\n-        },\n+  turbopack: {\n+    rules: {\n+      '*.mdx': {\n+        loaders: ['test-loader.js'],\n+        as: '*.js',\n       },\n     },\n   },"
        },
        {
            "sha": "fc11041f27a7ec8e0020d0ef3f6d98e74393c5ac",
            "filename": "test/e2e/app-dir/webpack-loader-conditions/next.config.js",
            "status": "modified",
            "additions": 21,
            "deletions": 23,
            "changes": 44,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fwebpack-loader-conditions%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fwebpack-loader-conditions%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fwebpack-loader-conditions%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -2,38 +2,36 @@\n  * @type {import('next').NextConfig}\n  */\n const nextConfig = {\n-  experimental: {\n-    turbo: {\n-      rules: {\n-        '*.test-file.js': {\n-          browser: {\n-            foreign: {\n-              loaders: [\n-                {\n-                  loader: require.resolve('./test-file-loader.js'),\n-                  options: { browser: true, foreign: true },\n-                },\n-              ],\n-            },\n-            default: {\n-              loaders: [\n-                {\n-                  loader: require.resolve('./test-file-loader.js'),\n-                  options: { browser: true },\n-                },\n-              ],\n-            },\n+  turbopack: {\n+    rules: {\n+      '*.test-file.js': {\n+        browser: {\n+          foreign: {\n+            loaders: [\n+              {\n+                loader: require.resolve('./test-file-loader.js'),\n+                options: { browser: true, foreign: true },\n+              },\n+            ],\n           },\n-          foreign: false,\n           default: {\n             loaders: [\n               {\n                 loader: require.resolve('./test-file-loader.js'),\n-                options: { default: true },\n+                options: { browser: true },\n               },\n             ],\n           },\n         },\n+        foreign: false,\n+        default: {\n+          loaders: [\n+            {\n+              loader: require.resolve('./test-file-loader.js'),\n+              options: { default: true },\n+            },\n+          ],\n+        },\n       },\n     },\n   },"
        },
        {
            "sha": "aefc88dcf14f4680ae0573c6ece0240b93f7e388",
            "filename": "test/e2e/app-dir/webpack-loader-ts-transform/next.config.js",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fwebpack-loader-ts-transform%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fapp-dir%2Fwebpack-loader-ts-transform%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fwebpack-loader-ts-transform%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -2,11 +2,9 @@\n  * @type {import('next').NextConfig}\n  */\n const nextConfig = {\n-  experimental: {\n-    turbo: {\n-      rules: {\n-        '*.test-file.ts': [require.resolve('./test-file-loader.js')],\n-      },\n+  turbopack: {\n+    rules: {\n+      '*.test-file.ts': [require.resolve('./test-file-loader.js')],\n     },\n   },\n }"
        },
        {
            "sha": "65375c5839713ddeb6bf0f22a0d0055169ba36d6",
            "filename": "test/e2e/esm-externals/next.config.js",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fesm-externals%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fesm-externals%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fesm-externals%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -1,9 +1,7 @@\n module.exports = {\n-  experimental: {\n-    turbo: {\n-      resolveAlias: {\n-        'preact/compat': 'react',\n-      },\n+  turbopack: {\n+    resolveAlias: {\n+      'preact/compat': 'react',\n     },\n   },\n   serverExternalPackages: ["
        },
        {
            "sha": "3e1c29259800516737d1d11108420d27ebda01f0",
            "filename": "test/e2e/persistent-caching/next.config.js",
            "status": "modified",
            "additions": 10,
            "deletions": 10,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fpersistent-caching%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fpersistent-caching%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fpersistent-caching%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -2,19 +2,19 @@\n  * @type {import('next').NextConfig}\n  */\n const nextConfig = {\n-  experimental: {\n-    turbo: {\n-      unstablePersistentCaching: true,\n-      rules: {\n-        'app/page.tsx': {\n-          loaders: ['./my-loader.js'],\n-        },\n-        'pages/pages.tsx': {\n-          loaders: ['./my-loader.js'],\n-        },\n+  turbopack: {\n+    rules: {\n+      'app/page.tsx': {\n+        loaders: ['./my-loader.js'],\n+      },\n+      'pages/pages.tsx': {\n+        loaders: ['./my-loader.js'],\n       },\n     },\n   },\n+  experimental: {\n+    turbopackPersistentCaching: true,\n+  },\n   webpack(config) {\n     config.module.rules.push({\n       test: /app\\/page\\.tsx|pages\\/pages.tsx/,"
        },
        {
            "sha": "4ee00a218505ac95ed8f4b2cb12779643277286d",
            "filename": "test/e2e/turbopack-turbo-config-compatibility/app/layout.js",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fapp%2Flayout.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fapp%2Flayout.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fapp%2Flayout.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -0,0 +1,7 @@\n+export default function RootLayout({ children }) {\n+  return (\n+    <html lang=\"en\">\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "c5a59e9f9b32bd693bd54750a8359e1f897328b2",
            "filename": "test/e2e/turbopack-turbo-config-compatibility/app/page.js",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fapp%2Fpage.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fapp%2Fpage.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fapp%2Fpage.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -0,0 +1,5 @@\n+import foo from 'foo'\n+\n+export default function Page() {\n+  return <div id=\"result\">Hello {foo}</div>\n+}"
        },
        {
            "sha": "3d58d1c65d7ba7400474ff89c509f3884ec70f87",
            "filename": "test/e2e/turbopack-turbo-config-compatibility/index.test.ts",
            "status": "added",
            "additions": 39,
            "deletions": 0,
            "changes": 39,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Findex.test.ts?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -0,0 +1,39 @@\n+/* eslint-disable jest/no-standalone-expect */\n+import { nextTestSetup } from 'e2e-utils'\n+;(process.env.IS_TURBOPACK_TEST ? describe : describe.skip)(\n+  'turbopack-turbo-config-compatibility',\n+  () => {\n+    describe('including both turbopack and deprecated experimental turbo config', () => {\n+      const { next } = nextTestSetup({\n+        files: __dirname,\n+      })\n+\n+      it('prefers turbopack config over deprecated experimental turbo config', async () => {\n+        const $ = await next.render$('/')\n+        expect($('#result').text()).toEqual('Hello turbopack')\n+      })\n+    })\n+\n+    describe('only including deprecated experimental turbo config', () => {\n+      const { next } = nextTestSetup({\n+        files: __dirname,\n+        overrideFiles: {\n+          'next.config.js': `module.exports = {\n+          experimental: {\n+            turbo: {\n+              resolveAlias: {\n+                foo: './turbo.js',\n+              },\n+            },\n+          },\n+        }`,\n+        },\n+      })\n+\n+      it('still uses the deprecated experimental turbo config', async () => {\n+        const $ = await next.render$('/')\n+        expect($('#result').text()).toEqual('Hello turbo')\n+      })\n+    })\n+  }\n+)"
        },
        {
            "sha": "8c1bfc417fd7fca2472192f257e68baeb0079bb4",
            "filename": "test/e2e/turbopack-turbo-config-compatibility/next.config.js",
            "status": "added",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -0,0 +1,14 @@\n+module.exports = {\n+  turbopack: {\n+    resolveAlias: {\n+      foo: './turbopack.js',\n+    },\n+  },\n+  experimental: {\n+    turbo: {\n+      resolveAlias: {\n+        foo: './turbo.js',\n+      },\n+    },\n+  },\n+}"
        },
        {
            "sha": "7554597e94c274c2527606f99f1e14d135609543",
            "filename": "test/e2e/turbopack-turbo-config-compatibility/turbo.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fturbo.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fturbo.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fturbo.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -0,0 +1 @@\n+export default 'turbo'"
        },
        {
            "sha": "4f7ddaeb011a7e78e252b8a3d9a337dda4a71cc0",
            "filename": "test/e2e/turbopack-turbo-config-compatibility/turbopack.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fturbopack.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fturbopack.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fturbopack-turbo-config-compatibility%2Fturbopack.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -0,0 +1 @@\n+export default 'turbopack'"
        },
        {
            "sha": "c535948b13b6ffc4a38da27d87432ec4fbc3ee0c",
            "filename": "test/integration/module-id-strategies/next.config.js",
            "status": "removed",
            "additions": 0,
            "deletions": 10,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/9d3b56337230b1cd2868f31b12077cb6ab6c3eed/test%2Fintegration%2Fmodule-id-strategies%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/9d3b56337230b1cd2868f31b12077cb6ab6c3eed/test%2Fintegration%2Fmodule-id-strategies%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fmodule-id-strategies%2Fnext.config.js?ref=9d3b56337230b1cd2868f31b12077cb6ab6c3eed",
            "patch": "@@ -1,10 +0,0 @@\n-module.exports = {\n-  bundlePagesRouterDependencies: true,\n-  serverExternalPackages: ['opted-out-external-package'],\n-  experimental: {\n-    turbo: {\n-      moduleIdStrategy:\n-        process.env.NODE_ENV === 'production' ? 'deterministic' : undefined,\n-    },\n-  },\n-}"
        },
        {
            "sha": "3396ee90bbeeb8c1ad3275ea222142af5003bc0d",
            "filename": "test/integration/module-ids/components/CustomComponent.tsx",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fcomponents%2FCustomComponent.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fcomponents%2FCustomComponent.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fmodule-ids%2Fcomponents%2FCustomComponent.tsx?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "previous_filename": "test/integration/module-id-strategies/components/CustomComponent.tsx"
        },
        {
            "sha": "ece22b30c245a6ca74526596f47be14fb41b42ca",
            "filename": "test/integration/module-ids/module-with-long-name.js",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fmodule-with-long-name.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fmodule-with-long-name.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fmodule-ids%2Fmodule-with-long-name.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "previous_filename": "test/integration/module-id-strategies/module-with-long-name.js"
        },
        {
            "sha": "40c2e5b7e65a1ccb886bf3cfe4e5a630cd48cf28",
            "filename": "test/integration/module-ids/next.config.js",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fmodule-ids%2Fnext.config.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  bundlePagesRouterDependencies: true,\n+  serverExternalPackages: ['opted-out-external-package'],\n+}"
        },
        {
            "sha": "8bb699844c52a230bdf058d7c232f50119a7e443",
            "filename": "test/integration/module-ids/node_modules/external-module-with-long-name.js",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fnode_modules%2Fexternal-module-with-long-name.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fnode_modules%2Fexternal-module-with-long-name.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fmodule-ids%2Fnode_modules%2Fexternal-module-with-long-name.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "previous_filename": "test/integration/module-id-strategies/node_modules/external-module-with-long-name.js"
        },
        {
            "sha": "5764ac78f6744bdfa89295c8395199ba31b0b845",
            "filename": "test/integration/module-ids/pages/index.js",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fpages%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Fpages%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fmodule-ids%2Fpages%2Findex.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "previous_filename": "test/integration/module-id-strategies/pages/index.js"
        },
        {
            "sha": "ba2754b891f98cb29135986d86a5e7043fe415c1",
            "filename": "test/integration/module-ids/test/index.test.js",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Ftest%2Findex.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fmodule-ids%2Ftest%2Findex.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fmodule-ids%2Ftest%2Findex.test.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "previous_filename": "test/integration/module-id-strategies/test/index.test.js"
        },
        {
            "sha": "5dc43b69c029b6d883615d40c6c0b4bf2975d7e3",
            "filename": "test/integration/production-browser-sourcemaps/test/index.test.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fproduction-browser-sourcemaps%2Ftest%2Findex.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Fproduction-browser-sourcemaps%2Ftest%2Findex.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fproduction-browser-sourcemaps%2Ftest%2Findex.test.js?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -12,6 +12,7 @@ function runTests() {\n     const jsFiles = browserFiles.filter(\n       (file) => file.endsWith('.js') && file.includes('/pages/')\n     )\n+    expect(jsFiles).not.toBeEmpty()\n \n     jsFiles.forEach((file) => {\n       expect(browserFiles.includes(`${file}.map`)).toBe(true)"
        },
        {
            "sha": "bca7301e9495fb0d06db8f60a69d9f6c914186b3",
            "filename": "test/integration/telemetry/next.config.persistent-cache",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Ftelemetry%2Fnext.config.persistent-cache",
            "raw_url": "https://github.com/vercel/next.js/raw/4f5531b140527803e87fd3d7ab04219d76fe8bbb/test%2Fintegration%2Ftelemetry%2Fnext.config.persistent-cache",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Ftelemetry%2Fnext.config.persistent-cache?ref=4f5531b140527803e87fd3d7ab04219d76fe8bbb",
            "patch": "@@ -1,7 +1,5 @@\n module.exports = {\n   experimental: {\n-    turbo: {\n-      unstablePersistentCaching: true\n-    }\n+    turbopackPersistentCaching: true\n   }\n-} \n\\ No newline at end of file\n+}"
        }
    ],
    "stats": {
        "total": 761,
        "additions": 425,
        "deletions": 336
    }
}