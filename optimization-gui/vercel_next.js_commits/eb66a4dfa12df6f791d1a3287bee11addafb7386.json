{
    "author": "devjiwonchoi",
    "message": "[dev-overlay] fix: terminal symbols are longer than text (#76059)\n\n### Why?\n\nThere's a width mismatch for symbols used in Geist Mono font font-weight\nover 600.\n\n| Before | After |\n|--------|--------|\n| ![CleanShot 2025-02-15 at 01 42\n01](https://github.com/user-attachments/assets/534bacd9-8d0a-4980-8db4-024b1fd93a3f)\n| ![CleanShot 2025-02-15 at 01 42\n16](https://github.com/user-attachments/assets/008418a9-0c1b-4fbe-8226-5d4fbaa8b312)\n|\n\n### How?\n\nUse font-weight `500` for bold for now.\n\nCloses NDX-821",
    "sha": "eb66a4dfa12df6f791d1a3287bee11addafb7386",
    "files": [
        {
            "sha": "3e3c140f7bbd7c120ccc761a4bda7c4ba8360095",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/code-frame/code-frame.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/eb66a4dfa12df6f791d1a3287bee11addafb7386/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fcode-frame%2Fcode-frame.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/eb66a4dfa12df6f791d1a3287bee11addafb7386/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fcode-frame%2Fcode-frame.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fcode-frame%2Fcode-frame.tsx?ref=eb66a4dfa12df6f791d1a3287bee11addafb7386",
            "patch": "@@ -84,7 +84,10 @@ export function CodeFrame({ stackFrame, codeFrame }: CodeFrameProps) {\n             style={{\n               color: entry.fg ? `var(--color-${entry.fg})` : undefined,\n               ...(entry.decoration === 'bold'\n-                ? { fontWeight: 800 }\n+                ? // TODO(jiwon): This used to be 800, but the symbols like `─┬─` are\n+                  // having longer width than expected on Geist Mono font-weight\n+                  // above 600, hence a temporary fix is to use 500 for bold.\n+                  { fontWeight: 500 }\n                 : entry.decoration === 'italic'\n                   ? { fontStyle: 'italic' }\n                   : undefined),"
        },
        {
            "sha": "6c73bc8c3a7b26297732d3d9168beb95008ac367",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/terminal/terminal.stories.tsx",
            "status": "modified",
            "additions": 24,
            "deletions": 18,
            "changes": 42,
            "blob_url": "https://github.com/vercel/next.js/blob/eb66a4dfa12df6f791d1a3287bee11addafb7386/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fterminal%2Fterminal.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/eb66a4dfa12df6f791d1a3287bee11addafb7386/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fterminal%2Fterminal.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fterminal%2Fterminal.stories.tsx?ref=eb66a4dfa12df6f791d1a3287bee11addafb7386",
            "patch": "@@ -13,30 +13,36 @@ const meta: Meta<typeof Terminal> = {\n export default meta\n type Story = StoryObj<typeof Terminal>\n \n-export const SimpleTerminal: Story = {\n+export const Default: Story = {\n   args: {\n-    content:\n-      './app/page.tsx:10:5\\n\\u001b[31mError:\\u001b[39m Something went wrong\\n  at Home (./app/page.tsx:10:5)',\n+    content: `./app/page.tsx:1:1\n+\\x1B[31m\\x1B[1mModule not found\\x1B[22m\\x1B[39m: Can't resolve '\\x1B[32mnot-existing-module\\x1B[39m'\n+\\x1B[0m\\x1B[31m\\x1B[1m>\\x1B[22m\\x1B[39m\\x1B[90m 1 |\\x1B[39m \\x1B[36mimport\\x1B[39m \\x1B[32m'not-existing-module'\\x1B[39m\\x1B[0m\n+\\x1B[0m \\x1B[90m   |\\x1B[39m \\x1B[31m\\x1B[1m^\\x1B[22m\\x1B[39m\\x1B[0m\n+\\x1B[0m \\x1B[90m 2 |\\x1B[39m\\x1B[0m\n+\\x1B[0m \\x1B[90m 3 |\\x1B[39m \\x1B[36mexport\\x1B[39m \\x1B[36mdefault\\x1B[39m \\x1B[36mfunction\\x1B[39m \\x1B[33mPage\\x1B[39m() {\\x1B[0m\n+\\x1B[0m \\x1B[90m 4 |\\x1B[39m   \\x1B[36mreturn\\x1B[39m \\x1B[33m<\\x1B[39m\\x1B[33mp\\x1B[39m\\x1B[33m>\\x1B[39mhello world\\x1B[33m<\\x1B[39m\\x1B[33m/\\x1B[39m\\x1B[33mp\\x1B[39m\\x1B[33m>\\x1B[39m\\x1B[0m\n+\n+https://nextjs.org/docs/messages/module-not-found`,\n   },\n }\n \n export const WithImportTrace: Story = {\n   args: {\n-    content: `./components/Button.tsx:15:3\n-ReactServerComponentsError: Failed to load component\n-Import trace for requested module:\n-./pages/index.tsx\n-./components/Layout.tsx\n-./components/Button.tsx`,\n-  },\n-}\n+    content: `./app/page.tsx\n+Error:   \\x1B[31m×\\x1B[0m Expected ';', '}' or <eof>\n+   ╭─[\\x1B[36;1;4m/hello-world/app/page.tsx\\x1B[0m:2:1]\n+ \\x1B[2m1\\x1B[0m │ export default function Page() {\n+ \\x1B[2m2\\x1B[0m │   ret urn <p>hello world</p>\n+   · \\x1B[35;1m  ─┬─\\x1B[0m\\x1B[33;1m ───\\x1B[0m\n+   ·    \\x1B[35;1m╰── \\x1B[35;1mThis is the expression part of an expression statement\\x1B[0m\\x1B[0m\n+ \\x1B[2m3\\x1B[0m │ }\n+   ╰────\n \n-export const WithAnsiColors: Story = {\n-  args: {\n-    content: `./app/error.tsx:5:10\n-\\u001b[31m\\u001b[1mError:\\u001b[22m\\u001b[39m Failed to compile\n-\\u001b[36m  console\\u001b[39m.\\u001b[33mlog\\u001b[39m('Debug message')\n-\\u001b[32m✓\\u001b[39m Success message\n-\\u001b[31m✕\\u001b[39m Error message`,\n+Caused by:\n+    Syntax Error\n+\n+Import trace for requested module:\n+./app/page.tsx`,\n   },\n }"
        },
        {
            "sha": "1dcf7e34eb6ac25a49a799c80b08b77bc4987e18",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/terminal/terminal.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/eb66a4dfa12df6f791d1a3287bee11addafb7386/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fterminal%2Fterminal.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/eb66a4dfa12df6f791d1a3287bee11addafb7386/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fterminal%2Fterminal.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Fterminal%2Fterminal.tsx?ref=eb66a4dfa12df6f791d1a3287bee11addafb7386",
            "patch": "@@ -115,7 +115,10 @@ export const Terminal: React.FC<TerminalProps> = function Terminal({\n             style={{\n               color: entry.fg ? `var(--color-${entry.fg})` : undefined,\n               ...(entry.decoration === 'bold'\n-                ? { fontWeight: 800 }\n+                ? // TODO(jiwon): This used to be 800, but the symbols like `─┬─` are\n+                  // having longer width than expected on Geist Mono font-weight\n+                  // above 600, hence a temporary fix is to use 500 for bold.\n+                  { fontWeight: 500 }\n                 : entry.decoration === 'italic'\n                   ? { fontStyle: 'italic' }\n                   : undefined),"
        }
    ],
    "stats": {
        "total": 52,
        "additions": 32,
        "deletions": 20
    }
}