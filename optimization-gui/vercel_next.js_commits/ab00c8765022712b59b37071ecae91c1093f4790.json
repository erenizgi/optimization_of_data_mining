{
    "author": "eps1lon",
    "message": "[test] Use new Redbox matchers in app/ undefined-default-export (#76781)\n\nMissing stack tracked in https://linear.app/vercel/issue/NDX-920/",
    "sha": "ab00c8765022712b59b37071ecae91c1093f4790",
    "files": [
        {
            "sha": "94c0e6d390b2bc03a40ba4a765d23031adc1fccc",
            "filename": "test/development/acceptance-app/undefined-default-export.test.ts",
            "status": "modified",
            "additions": 59,
            "deletions": 25,
            "changes": 84,
            "blob_url": "https://github.com/vercel/next.js/blob/ab00c8765022712b59b37071ecae91c1093f4790/test%2Fdevelopment%2Facceptance-app%2Fundefined-default-export.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ab00c8765022712b59b37071ecae91c1093f4790/test%2Fdevelopment%2Facceptance-app%2Fundefined-default-export.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Fundefined-default-export.test.ts?ref=ab00c8765022712b59b37071ecae91c1093f4790",
            "patch": "@@ -16,11 +16,18 @@ describe('Undefined default export', () => {\n       ]),\n       '/specific-path/server'\n     )\n-    const { session } = sandbox\n-    await session.assertHasRedbox()\n-    expect(await session.getRedboxDescription()).toInclude(\n-      'The default export is not a React Component in \"/specific-path/server/page\"'\n-    )\n+    const { browser } = sandbox\n+\n+    await expect(browser).toDisplayRedbox(`\n+     {\n+       \"count\": 1,\n+       \"description\": \"Error: The default export is not a React Component in \"/specific-path/server/page\"\",\n+       \"environmentLabel\": null,\n+       \"label\": \"Runtime Error\",\n+       \"source\": null,\n+       \"stack\": [],\n+     }\n+    `)\n   })\n \n   it('should error if layout component does not have default export', async () => {\n@@ -35,11 +42,18 @@ describe('Undefined default export', () => {\n       ]),\n       '/specific-path/server'\n     )\n-    const { session } = sandbox\n-    await session.assertHasRedbox()\n-    expect(await session.getRedboxDescription()).toInclude(\n-      'The default export is not a React Component in \"/specific-path/server/layout\"'\n-    )\n+    const { browser } = sandbox\n+\n+    await expect(browser).toDisplayRedbox(`\n+     {\n+       \"count\": 1,\n+       \"description\": \"Error: The default export is not a React Component in \"/specific-path/server/layout\"\",\n+       \"environmentLabel\": null,\n+       \"label\": \"Runtime Error\",\n+       \"source\": null,\n+       \"stack\": [],\n+     }\n+    `)\n   })\n \n   it('should error if not-found component does not have default export when trigger not-found boundary', async () => {\n@@ -57,27 +71,40 @@ describe('Undefined default export', () => {\n       ]),\n       '/will-not-found'\n     )\n-    const { session } = sandbox\n-    await session.assertHasRedbox()\n-    expect(await session.getRedboxDescription()).toInclude(\n-      'The default export is not a React Component in \"/will-not-found/not-found\"'\n-    )\n+    const { browser } = sandbox\n+\n+    await expect(browser).toDisplayRedbox(`\n+     {\n+       \"count\": 1,\n+       \"description\": \"Error: The default export is not a React Component in \"/will-not-found/not-found\"\",\n+       \"environmentLabel\": null,\n+       \"label\": \"Runtime Error\",\n+       \"source\": null,\n+       \"stack\": [],\n+     }\n+    `)\n   })\n \n   it('should error when page component export is not valid', async () => {\n     await using sandbox = await createSandbox(next, undefined, '/')\n-    const { session, browser } = sandbox\n+    const { browser } = sandbox\n \n     await next.patchFile('app/page.js', 'const a = 123')\n \n     // The page will fail build and navigate to /_error route of pages router.\n     // Wait for the DOM node #__next to be present\n     await browser.waitForElementByCss('#__next')\n \n-    await session.assertHasRedbox()\n-    expect(await session.getRedboxDescription()).toInclude(\n-      'The default export is not a React Component in \"/page\"'\n-    )\n+    await expect(browser).toDisplayRedbox(`\n+     {\n+       \"count\": 1,\n+       \"description\": \"Error: The default export is not a React Component in \"/page\"\",\n+       \"environmentLabel\": null,\n+       \"label\": \"Runtime Error\",\n+       \"source\": null,\n+       \"stack\": [],\n+     }\n+    `)\n   })\n \n   it('should error when page component export is not valid on initial load', async () => {\n@@ -91,10 +118,17 @@ describe('Undefined default export', () => {\n       ]),\n       '/server-with-errors/page-export-initial-error'\n     )\n-    const { session } = sandbox\n-    await session.assertHasRedbox()\n-    expect(await session.getRedboxDescription()).toInclude(\n-      'The default export is not a React Component in \"/server-with-errors/page-export-initial-error/page\"'\n-    )\n+    const { browser } = sandbox\n+\n+    await expect(browser).toDisplayRedbox(`\n+     {\n+       \"count\": 1,\n+       \"description\": \"Error: The default export is not a React Component in \"/server-with-errors/page-export-initial-error/page\"\",\n+       \"environmentLabel\": null,\n+       \"label\": \"Runtime Error\",\n+       \"source\": null,\n+       \"stack\": [],\n+     }\n+    `)\n   })\n })"
        }
    ],
    "stats": {
        "total": 84,
        "additions": 59,
        "deletions": 25
    }
}