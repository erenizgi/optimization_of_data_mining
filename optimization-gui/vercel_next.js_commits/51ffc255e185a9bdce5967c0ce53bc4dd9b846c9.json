{
    "author": "huozhi",
    "message": "[metadata] remove the duplicate metadata in the error boundary (#76791)\n\n### What \r\n\r\nThose metadata were added into error boundaries but they're actually duplicated, we already have the actual metadata in the page and the metadata outlet can trigger the error boundary. The metadata element in the error boundary is not necessary.",
    "sha": "51ffc255e185a9bdce5967c0ce53bc4dd9b846c9",
    "files": [
        {
            "sha": "0a330d00ec1023bd257db44ee8e20ae807dba38f",
            "filename": "packages/next/src/server/app-render/create-component-tree.tsx",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx?ref=51ffc255e185a9bdce5967c0ce53bc4dd9b846c9",
            "patch": "@@ -411,23 +411,20 @@ async function createComponentTreeInternal({\n   const notFoundElement = NotFound ? (\n     <>\n       <NotFound />\n-      {metadata}\n       {notFoundStyles}\n     </>\n   ) : undefined\n \n   const forbiddenElement = Forbidden ? (\n     <>\n       <Forbidden />\n-      {metadata}\n       {forbiddenStyles}\n     </>\n   ) : undefined\n \n   const unauthorizedElement = Unauthorized ? (\n     <>\n       <Unauthorized />\n-      {metadata}\n       {unauthorizedStyles}\n     </>\n   ) : undefined\n@@ -858,7 +855,6 @@ async function createComponentTreeInternal({\n                     {notFoundStyles}\n                     <NotFound />\n                   </SegmentComponent>\n-                  {metadata}\n                 </>\n               ) : undefined\n             }"
        },
        {
            "sha": "1e2a530ec2273dadf136df8814f0ab26d5a72808",
            "filename": "test/e2e/app-dir/parallel-routes-not-found/app/layout.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Fapp%2Flayout.tsx?ref=51ffc255e185a9bdce5967c0ce53bc4dd9b846c9",
            "patch": "@@ -6,11 +6,15 @@ export default function Layout({\n   slot: React.ReactNode\n }) {\n   return (\n-    <html>\n+    <html lang=\"en\" className=\"layout\">\n       <body>\n         {children}\n         {slot}\n       </body>\n     </html>\n   )\n }\n+\n+export const metadata = {\n+  title: 'layout title',\n+}"
        },
        {
            "sha": "807126e4cf0bf5b1c8c917e6e0148a27331587d1",
            "filename": "test/e2e/app-dir/parallel-routes-not-found/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Fnext.config.js?ref=51ffc255e185a9bdce5967c0ce53bc4dd9b846c9",
            "patch": "@@ -1,8 +1,6 @@\n /**\n  * @type {import('next').NextConfig}\n  */\n-const nextConfig = {\n-  pageExtensions: ['tsx', 'ts'],\n-}\n+const nextConfig = {}\n \n module.exports = nextConfig"
        },
        {
            "sha": "ba41f3c28283f93ea6147f4cda21e57adb8f2014",
            "filename": "test/e2e/app-dir/parallel-routes-not-found/parallel-routes-not-found.test.ts",
            "status": "modified",
            "additions": 26,
            "deletions": 1,
            "changes": 27,
            "blob_url": "https://github.com/vercel/next.js/blob/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Fparallel-routes-not-found.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Fparallel-routes-not-found.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Fparallel-routes-not-found.test.ts?ref=51ffc255e185a9bdce5967c0ce53bc4dd9b846c9",
            "patch": "@@ -1,7 +1,9 @@\n import { nextTestSetup } from 'e2e-utils'\n \n+const isPPR = process.env.__NEXT_EXPERIMENTAL_PPR === 'true'\n+\n describe('parallel-routes-and-interception', () => {\n-  const { next, skipped } = nextTestSetup({\n+  const { next, isNextDev, skipped } = nextTestSetup({\n     files: __dirname,\n     // TODO: remove after deployment handling is updated\n     skipDeployment: true,\n@@ -21,5 +23,28 @@ describe('parallel-routes-and-interception', () => {\n \n     // we also check that the #children-slot id is not present\n     expect(await browser.hasElementByCssSelector('#children-slot')).toBe(false)\n+\n+    if (isPPR && !isNextDev) {\n+      let $ = await next.render$('/')\n+      expect($('title').text()).toBe('')\n+\n+      $ = await next.render$('/', null, {\n+        headers: {\n+          'User-Agent': 'Discordbot',\n+        },\n+      })\n+      expect($('title').text()).toBe('layout title')\n+    } else {\n+      const $ = await next.render$('/')\n+      expect($('title').text()).toBe('layout title')\n+    }\n+  })\n+\n+  it('should render the title once for the non-existed route', async () => {\n+    const browser = await next.browser('/non-existed')\n+    const titles = await browser.elementsByCss('title')\n+\n+    // FIXME: (metadata), the title should only be rendered once and using the not-found title\n+    expect(titles).toHaveLength(3)\n   })\n })"
        },
        {
            "sha": "140aa2eecad4830ffa56fe8726cedaa352d931c1",
            "filename": "test/e2e/app-dir/parallel-routes-not-found/tsconfig.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Ftsconfig.json",
            "raw_url": "https://github.com/vercel/next.js/raw/51ffc255e185a9bdce5967c0ce53bc4dd9b846c9/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Ftsconfig.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fparallel-routes-not-found%2Ftsconfig.json?ref=51ffc255e185a9bdce5967c0ce53bc4dd9b846c9",
            "patch": "@@ -21,5 +21,5 @@\n     \"target\": \"ES2017\"\n   },\n   \"include\": [\"next-env.d.ts\", \".next/types/**/*.ts\", \"**/*.ts\", \"**/*.tsx\"],\n-  \"exclude\": [\"node_modules\"]\n+  \"exclude\": [\"node_modules\", \"**/*.test.ts\", \"**/*.test.tsx\"]\n }"
        }
    ],
    "stats": {
        "total": 43,
        "additions": 33,
        "deletions": 10
    }
}