{
    "author": "gnoff",
    "message": "Add nextjs condition when cacheComponents is enabled (#84843)\n\nLibraries that want to support Next.js without specific public adaptors\nmust use dynamic requires and other non-standard tricks to conditionally\nload Next.js specific behavior. To simplify this we are adding a\ncondition to Next.js so that package authors can load Next.js specific\nversions of code publicly (through export maps) and privately (through\nimport maps).\n\nThe condition is added when cacheComponents is enabled. This will allow\nlibraries to target modern Next.js conditionally without publishing new\nmajors with a new floor version for optional peer dependencies on\nNext.js. In the future this will be the only mode for Next.js and the\ncondition will always be present\n\nThe condition is currently only implemented for bundled code. We want to\nsupport this for externals too but it is tricky because determining the\nright condition requires running Node.js first and I want to be careful\nabout adding any process indirection that slows down cold start. This\nwill be addressed in a future update.\n\n---------\n\nCo-authored-by: Sebastian Sebbie Silbermann <sebastian.silbermann@vercel.com>",
    "sha": "2ae9f1a3a51214547cebed2b39daea5f5f58310d",
    "files": [
        {
            "sha": "4099a7344cfda53aa6fea6e293a5b6f7a9ae6c35",
            "filename": "crates/next-core/src/next_client/context.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/crates%2Fnext-core%2Fsrc%2Fnext_client%2Fcontext.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/crates%2Fnext-core%2Fsrc%2Fnext_client%2Fcontext.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_client%2Fcontext.rs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -150,7 +150,12 @@ pub async fn get_client_resolve_options_context(\n         get_next_client_resolved_map(project_path.clone(), project_path.clone(), *mode.await?)\n             .to_resolved()\n             .await?;\n-    let custom_conditions = mode.await?.custom_resolve_conditions().collect();\n+    let mut custom_conditions: Vec<_> = mode.await?.custom_resolve_conditions().collect();\n+\n+    if *next_config.enable_cache_components().await? {\n+        custom_conditions.push(rcstr!(\"next-js\"));\n+    };\n+\n     let resolve_options_context = ResolveOptionsContext {\n         enable_node_modules: Some(project_path.root().owned().await?),\n         custom_conditions,"
        },
        {
            "sha": "20856b85d8a13dcbc62f2343a86ca2977fcfac29",
            "filename": "crates/next-core/src/next_edge/context.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/crates%2Fnext-core%2Fsrc%2Fnext_edge%2Fcontext.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/crates%2Fnext-core%2Fsrc%2Fnext_edge%2Fcontext.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_edge%2Fcontext.rs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -153,6 +153,10 @@ pub async fn get_edge_resolve_options_context(\n         custom_conditions.push(rcstr!(\"react-server\"));\n     };\n \n+    if *next_config.enable_cache_components().await? {\n+        custom_conditions.push(rcstr!(\"next-js\"));\n+    };\n+\n     let resolve_options_context = ResolveOptionsContext {\n         enable_node_modules: Some(project_path.root().owned().await?),\n         enable_edge_node_externals: true,"
        },
        {
            "sha": "78234b8f8fc89e9f12e48e64d851e69acff97541",
            "filename": "crates/next-core/src/next_server/context.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fcontext.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fcontext.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fcontext.rs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -214,6 +214,10 @@ pub async fn get_server_resolve_options_context(\n         custom_conditions.push(rcstr!(\"react-server\"));\n     };\n \n+    if *next_config.enable_cache_components().await? {\n+        custom_conditions.push(rcstr!(\"next-js\"));\n+    };\n+\n     let external_cjs_modules_plugin = if *next_config.bundle_pages_router_dependencies().await? {\n         server_external_packages_plugin\n     } else {"
        },
        {
            "sha": "9f13e9918e6d912028952eac9f3f0d02db573105",
            "filename": "packages/next/src/build/swc/generated-native.d.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Fgenerated-native.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Fgenerated-native.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Fgenerated-native.d.ts?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -34,6 +34,12 @@ export declare class ExternalObject<T> {\n     [K: symbol]: T\n   }\n }\n+export interface TransformOutput {\n+  code: string\n+  map?: string\n+  output?: string\n+  diagnostics: Array<string>\n+}\n export declare function lockfileTryAcquireSync(\n   path: string\n ): { __napiType: 'Lockfile' } | null\n@@ -52,12 +58,6 @@ export declare function mdxCompile(\n   signal?: AbortSignal | undefined | null\n ): Promise<unknown>\n export declare function mdxCompileSync(value: string, option: Buffer): string\n-export interface TransformOutput {\n-  code: string\n-  map?: string\n-  output?: string\n-  diagnostics: Array<string>\n-}\n export declare function minify(\n   input: Buffer,\n   opts: Buffer,"
        },
        {
            "sha": "ef88d8296e9594e95c5ae1c7a5aae8b4b80c89e7",
            "filename": "packages/next/src/build/webpack-config-rules/resolve.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 7,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config-rules%2Fresolve.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config-rules%2Fresolve.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config-rules%2Fresolve.ts?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -3,12 +3,7 @@ import {\n   type CompilerNameValues,\n } from '../../shared/lib/constants'\n \n-// exports.<conditionName>\n-export const edgeConditionNames = [\n-  'edge-light',\n-  // inherits the default conditions\n-  '...',\n-]\n+export const edgeConditionName = 'edge-light'\n \n const mainFieldsPerCompiler = {\n   // For default case, prefer CJS over ESM on server side. e.g. pages dir SSR\n@@ -23,7 +18,7 @@ export function getMainField(\n   preferEsm: boolean\n ) {\n   if (compilerType === COMPILER_NAMES.edgeServer) {\n-    return edgeConditionNames\n+    return ['edge-light', '...']\n   } else if (compilerType === COMPILER_NAMES.client) {\n     return mainFieldsPerCompiler[COMPILER_NAMES.client]\n   }"
        },
        {
            "sha": "a9561d3cc2f8cdadabee18973be12710b67a86ac",
            "filename": "packages/next/src/build/webpack-config.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 14,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -69,10 +69,7 @@ import { getBabelConfigFile } from './get-babel-config-file'\n import { needsExperimentalReact } from '../lib/needs-experimental-react'\n import type { SWCLoaderOptions } from './webpack/loaders/next-swc-loader'\n import { isResourceInPackages, makeExternalHandler } from './handle-externals'\n-import {\n-  getMainField,\n-  edgeConditionNames,\n-} from './webpack-config-rules/resolve'\n+import { getMainField, edgeConditionName } from './webpack-config-rules/resolve'\n import { OptionalPeerDependencyResolverPlugin } from './webpack/plugins/optional-peer-dependency-resolve-plugin'\n import {\n   createWebpackAliases,\n@@ -688,12 +685,17 @@ export default async function getBaseWebpackConfig(\n     ? path.join(distDir, SERVER_DIRECTORY)\n     : distDir\n \n-  const reactServerCondition = [\n-    'react-server',\n-    ...(isEdgeServer ? edgeConditionNames : []),\n-    // inherits the default conditions\n+  const conditionNames = [\n+    ...(config.experimental?.cacheComponents === true ? ['next-js'] : []),\n+    ...(isEdgeServer ? [edgeConditionName] : []),\n+    // inherits Webpack's default conditions\n     '...',\n   ]\n+  const reactServerConditionNames = [\n+    'react-server',\n+    // We could just use `'...'`. Explicit spread makes it more obvious.\n+    ...conditionNames,\n+  ]\n \n   const reactRefreshEntry = isRspack\n     ? require.resolve(\n@@ -757,6 +759,7 @@ export default async function getBaseWebpackConfig(\n     : undefined\n \n   const resolveConfig: webpack.Configuration['resolve'] = {\n+    conditionNames,\n     // Disable .mjs for node_modules bundling\n     extensions: ['.js', '.mjs', '.tsx', '.ts', '.jsx', '.json', '.wasm'],\n     extensionAlias: config.experimental.extensionAlias,\n@@ -784,9 +787,6 @@ export default async function getBaseWebpackConfig(\n       : undefined),\n     // default main fields use pages dir ones, and customize app router ones in loaders.\n     mainFields: getMainField(compilerType, false),\n-    ...(isEdgeServer && {\n-      conditionNames: edgeConditionNames,\n-    }),\n     plugins: [\n       isNodeServer ? new OptionalPeerDependencyResolverPlugin() : undefined,\n     ].filter(Boolean) as webpack.ResolvePluginInstance[],\n@@ -1534,7 +1534,7 @@ export default async function getBaseWebpackConfig(\n                 },\n                 resolve: {\n                   mainFields: getMainField(compilerType, true),\n-                  conditionNames: reactServerCondition,\n+                  conditionNames: reactServerConditionNames,\n                   // If missing the alias override here, the default alias will be used which aliases\n                   // react to the direct file path, not the package name. In that case the condition\n                   // will be ignored completely.\n@@ -1688,7 +1688,7 @@ export default async function getBaseWebpackConfig(\n               use: middlewareLayerLoaders,\n               resolve: {\n                 mainFields: getMainField(compilerType, true),\n-                conditionNames: reactServerCondition,\n+                conditionNames: reactServerConditionNames,\n                 alias: createVendoredReactAliases(bundledReactChannel, {\n                   reactProductionProfiling,\n                   layer: WEBPACK_LAYERS.middleware,\n@@ -1703,7 +1703,7 @@ export default async function getBaseWebpackConfig(\n               use: instrumentLayerLoaders,\n               resolve: {\n                 mainFields: getMainField(compilerType, true),\n-                conditionNames: reactServerCondition,\n+                conditionNames: reactServerConditionNames,\n                 alias: createVendoredReactAliases(bundledReactChannel, {\n                   reactProductionProfiling,\n                   layer: WEBPACK_LAYERS.instrument,"
        },
        {
            "sha": "033548cd005178edb8df00cec41ada0864bc5088",
            "filename": "scripts/next-with-deps.sh",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/scripts%2Fnext-with-deps.sh",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/scripts%2Fnext-with-deps.sh",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/scripts%2Fnext-with-deps.sh?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -29,7 +29,7 @@ done\n \n if [ ! -z $HAS_CONFLICTING_DEP ] || [ ! -d \"$PROJECT_DIR/node_modules\" ];then\n   cd $PROJECT_DIR\n-  pnpm i --ignore-workspace\n+  pnpm i --ignore-workspace --no-lockfile\n   for dep in ${CONFLICTING_DEPS[@]};do \n     rm -rf node_modules/$dep\n   done"
        },
        {
            "sha": "b512c09d476623ff4bf8d0d63c29b784925dbdf8",
            "filename": "test/e2e/app-dir/next-condition/.gitignore",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2F.gitignore",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2F.gitignore",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2F.gitignore?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1 @@\n+node_modules\n\\ No newline at end of file"
        },
        {
            "sha": "5bfbea03e08483203f3a245bf2f46bd9f6b5db56",
            "filename": "test/e2e/app-dir/next-condition/app/cjs/client.tsx",
            "status": "added",
            "additions": 61,
            "deletions": 0,
            "changes": 61,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fcjs%2Fclient.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fcjs%2Fclient.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fcjs%2Fclient.tsx?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,61 @@\n+'use client'\n+\n+// For this to work locally you need to use `pnpm next-with-deps dev|build`\n+// Make sure you delete node_modules if you are editing the package otherwise it won't\n+// reinstall and reflect your changes.\n+\n+import ExportsDefault from 'my-cjs-package/exports'\n+import * as ExportsNamed from 'my-cjs-package/exports'\n+import { named as namedExports } from 'my-cjs-package/exports'\n+\n+import ImportsDefault from 'my-cjs-package/imports'\n+import * as ImportsNamed from 'my-cjs-package/imports'\n+import { named as namedImports } from 'my-cjs-package/imports'\n+\n+const pendingDynamicExports = import('my-cjs-package/exports').then((mod) =>\n+  JSON.stringify(mod)\n+)\n+\n+const pendingDynamicImports = import('my-cjs-package/imports').then((mod) =>\n+  JSON.stringify(mod)\n+)\n+\n+export default function Client() {\n+  return (\n+    <section>\n+      <h2>Client</h2>\n+      <section>\n+        <h3>Exports</h3>\n+        <section>\n+          <h4>Static</h4>\n+          <label>Default:</label>\n+          <div>{JSON.stringify(ExportsDefault)}</div>\n+          <label>Namespace:</label>\n+          <div>{JSON.stringify(ExportsNamed)}</div>\n+          <label>named:</label>\n+          <div>{JSON.stringify(namedExports)}</div>\n+        </section>\n+        <section>\n+          <h4>Dynamic</h4>\n+          <div>{pendingDynamicExports}</div>\n+        </section>\n+      </section>\n+      <section>\n+        <h3>Imports</h3>\n+        <section>\n+          <h4>Static</h4>\n+          <label>Default:</label>\n+          <div>{JSON.stringify(ImportsDefault)}</div>\n+          <label>Namespace:</label>\n+          <div>{JSON.stringify(ImportsNamed)}</div>\n+          <label>named:</label>\n+          <div>{JSON.stringify(namedImports)}</div>\n+        </section>\n+        <section>\n+          <h4>Dynamic</h4>\n+          <div>{pendingDynamicImports}</div>\n+        </section>\n+      </section>\n+    </section>\n+  )\n+}"
        },
        {
            "sha": "d393b69f1704b4a72202476e56642a7a52924f8b",
            "filename": "test/e2e/app-dir/next-condition/app/cjs/page.tsx",
            "status": "added",
            "additions": 64,
            "deletions": 0,
            "changes": 64,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fcjs%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fcjs%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fcjs%2Fpage.tsx?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,64 @@\n+// For this to work locally you need to use `pnpm next-with-deps dev|build`\n+// Make sure you delete node_modules if you are editing the package otherwise it won't\n+// reinstall and reflect your changes.\n+\n+import ExportsDefault from 'my-cjs-package/exports'\n+import * as ExportsNamed from 'my-cjs-package/exports'\n+import { named as namedExports } from 'my-cjs-package/exports'\n+\n+import ImportsDefault from 'my-cjs-package/imports'\n+import * as ImportsNamed from 'my-cjs-package/imports'\n+import { named as namedImports } from 'my-cjs-package/imports'\n+\n+const pendingDynamicExports = import('my-cjs-package/exports').then((mod) =>\n+  JSON.stringify(mod)\n+)\n+\n+const pendingDynamicImports = import('my-cjs-package/imports').then((mod) =>\n+  JSON.stringify(mod)\n+)\n+\n+import Client from './client'\n+\n+export default function Page() {\n+  return (\n+    <>\n+      <section>\n+        <h2>Server</h2>\n+        <section>\n+          <h3>Exports</h3>\n+          <section>\n+            <h4>Static</h4>\n+            <label>Default:</label>\n+            <div>{JSON.stringify(ExportsDefault)}</div>\n+            <label>Namespace:</label>\n+            <div>{JSON.stringify(ExportsNamed)}</div>\n+            <label>named:</label>\n+            <div>{JSON.stringify(namedExports)}</div>\n+          </section>\n+          <section>\n+            <h4>Dynamic</h4>\n+            <div>{pendingDynamicExports}</div>\n+          </section>\n+        </section>\n+        <section>\n+          <h3>Imports</h3>\n+          <section>\n+            <h4>Static</h4>\n+            <label>Default:</label>\n+            <div>{JSON.stringify(ImportsDefault)}</div>\n+            <label>Namespace:</label>\n+            <div>{JSON.stringify(ImportsNamed)}</div>\n+            <label>named:</label>\n+            <div>{JSON.stringify(namedImports)}</div>\n+          </section>\n+          <section>\n+            <h4>Dynamic</h4>\n+            <div>{pendingDynamicImports}</div>\n+          </section>\n+        </section>\n+      </section>\n+      <Client />\n+    </>\n+  )\n+}"
        },
        {
            "sha": "39372a63dae2015bd0036bc5668bd11af06f097a",
            "filename": "test/e2e/app-dir/next-condition/app/esm/client.tsx",
            "status": "added",
            "additions": 61,
            "deletions": 0,
            "changes": 61,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fesm%2Fclient.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fesm%2Fclient.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fesm%2Fclient.tsx?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,61 @@\n+'use client'\n+\n+// For this to work locally you need to use `pnpm next-with-deps dev|build`\n+// Make sure you delete node_modules if you are editing the package otherwise it won't\n+// reinstall and reflect your changes.\n+\n+import ExportsDefault from 'my-esm-package/exports'\n+import * as ExportsNamed from 'my-esm-package/exports'\n+import { named as namedExports } from 'my-esm-package/exports'\n+\n+import ImportsDefault from 'my-esm-package/imports'\n+import * as ImportsNamed from 'my-esm-package/imports'\n+import { named as namedImports } from 'my-esm-package/imports'\n+\n+const pendingDynamicExports = import('my-esm-package/exports').then((mod) =>\n+  JSON.stringify(mod)\n+)\n+\n+const pendingDynamicImports = import('my-esm-package/imports').then((mod) =>\n+  JSON.stringify(mod)\n+)\n+\n+export default function Client() {\n+  return (\n+    <section>\n+      <h2>Client</h2>\n+      <section>\n+        <h3>Exports</h3>\n+        <section>\n+          <h4>Static</h4>\n+          <label>Default:</label>\n+          <div>{JSON.stringify(ExportsDefault)}</div>\n+          <label>Namespace:</label>\n+          <div>{JSON.stringify(ExportsNamed)}</div>\n+          <label>named:</label>\n+          <div>{JSON.stringify(namedExports)}</div>\n+        </section>\n+        <section>\n+          <h4>Dynamic</h4>\n+          <div>{pendingDynamicExports}</div>\n+        </section>\n+      </section>\n+      <section>\n+        <h3>Imports</h3>\n+        <section>\n+          <h4>Static</h4>\n+          <label>Default:</label>\n+          <div>{JSON.stringify(ImportsDefault)}</div>\n+          <label>Namespace:</label>\n+          <div>{JSON.stringify(ImportsNamed)}</div>\n+          <label>named:</label>\n+          <div>{JSON.stringify(namedImports)}</div>\n+        </section>\n+        <section>\n+          <h4>Dynamic</h4>\n+          <div>{pendingDynamicImports}</div>\n+        </section>\n+      </section>\n+    </section>\n+  )\n+}"
        },
        {
            "sha": "9f731e1f5c9da943011a40b149560289bf1693ba",
            "filename": "test/e2e/app-dir/next-condition/app/esm/page.tsx",
            "status": "added",
            "additions": 64,
            "deletions": 0,
            "changes": 64,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fesm%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fesm%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fesm%2Fpage.tsx?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,64 @@\n+// For this to work locally you need to use `pnpm next-with-deps dev|build`\n+// Make sure you delete node_modules if you are editing the package otherwise it won't\n+// reinstall and reflect your changes.\n+\n+import ExportsDefault from 'my-esm-package/exports'\n+import * as ExportsNamed from 'my-esm-package/exports'\n+import { named as namedExports } from 'my-esm-package/exports'\n+\n+import ImportsDefault from 'my-esm-package/imports'\n+import * as ImportsNamed from 'my-esm-package/imports'\n+import { named as namedImports } from 'my-esm-package/imports'\n+\n+const pendingDynamicExports = import('my-esm-package/exports').then((mod) =>\n+  JSON.stringify(mod)\n+)\n+\n+const pendingDynamicImports = import('my-esm-package/imports').then((mod) =>\n+  JSON.stringify(mod)\n+)\n+\n+import Client from './client'\n+\n+export default function Page() {\n+  return (\n+    <>\n+      <section>\n+        <h2>Server</h2>\n+        <section>\n+          <h3>Exports</h3>\n+          <section>\n+            <h4>Static</h4>\n+            <label>Default:</label>\n+            <div>{JSON.stringify(ExportsDefault)}</div>\n+            <label>Namespace:</label>\n+            <div>{JSON.stringify(ExportsNamed)}</div>\n+            <label>named:</label>\n+            <div>{JSON.stringify(namedExports)}</div>\n+          </section>\n+          <section>\n+            <h4>Dynamic</h4>\n+            <div>{pendingDynamicExports}</div>\n+          </section>\n+        </section>\n+        <section>\n+          <h3>Imports</h3>\n+          <section>\n+            <h4>Static</h4>\n+            <label>Default:</label>\n+            <div>{JSON.stringify(ImportsDefault)}</div>\n+            <label>Namespace:</label>\n+            <div>{JSON.stringify(ImportsNamed)}</div>\n+            <label>named:</label>\n+            <div>{JSON.stringify(namedImports)}</div>\n+          </section>\n+          <section>\n+            <h4>Dynamic</h4>\n+            <div>{pendingDynamicImports}</div>\n+          </section>\n+        </section>\n+      </section>\n+      <Client />\n+    </>\n+  )\n+}"
        },
        {
            "sha": "fcc5f4e7a7e30c331761b23b40a25fb4bd513428",
            "filename": "test/e2e/app-dir/next-condition/app/external-cjs/client.tsx",
            "status": "added",
            "additions": 61,
            "deletions": 0,
            "changes": 61,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-cjs%2Fclient.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-cjs%2Fclient.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-cjs%2Fclient.tsx?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,61 @@\n+'use client'\n+\n+// For this to work locally you need to use `pnpm next-with-deps dev|build`\n+// Make sure you delete node_modules if you are editing the package otherwise it won't\n+// reinstall and reflect your changes.\n+\n+import ExportsDefault from 'my-external-cjs-package/exports'\n+import * as ExportsNamed from 'my-external-cjs-package/exports'\n+import { named as namedExports } from 'my-external-cjs-package/exports'\n+\n+import ImportsDefault from 'my-external-cjs-package/imports'\n+import * as ImportsNamed from 'my-external-cjs-package/imports'\n+import { named as namedImports } from 'my-external-cjs-package/imports'\n+\n+const pendingDynamicExports = import('my-external-cjs-package/exports').then(\n+  (mod) => JSON.stringify(mod)\n+)\n+\n+const pendingDynamicImports = import('my-external-cjs-package/imports').then(\n+  (mod) => JSON.stringify(mod)\n+)\n+\n+export default function Client() {\n+  return (\n+    <section>\n+      <h2>Client</h2>\n+      <section>\n+        <h3>Exports</h3>\n+        <section>\n+          <h4>Static</h4>\n+          <label>Default:</label>\n+          <div>{JSON.stringify(ExportsDefault)}</div>\n+          <label>Namespace:</label>\n+          <div>{JSON.stringify(ExportsNamed)}</div>\n+          <label>named:</label>\n+          <div>{JSON.stringify(namedExports)}</div>\n+        </section>\n+        <section>\n+          <h4>Dynamic</h4>\n+          <div>{pendingDynamicExports}</div>\n+        </section>\n+      </section>\n+      <section>\n+        <h3>Imports</h3>\n+        <section>\n+          <h4>Static</h4>\n+          <label>Default:</label>\n+          <div>{JSON.stringify(ImportsDefault)}</div>\n+          <label>Namespace:</label>\n+          <div>{JSON.stringify(ImportsNamed)}</div>\n+          <label>named:</label>\n+          <div>{JSON.stringify(namedImports)}</div>\n+        </section>\n+        <section>\n+          <h4>Dynamic</h4>\n+          <div>{pendingDynamicImports}</div>\n+        </section>\n+      </section>\n+    </section>\n+  )\n+}"
        },
        {
            "sha": "f144dfa78e1a7e92c9c49293e672be47ca85f823",
            "filename": "test/e2e/app-dir/next-condition/app/external-cjs/page.tsx",
            "status": "added",
            "additions": 64,
            "deletions": 0,
            "changes": 64,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-cjs%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-cjs%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-cjs%2Fpage.tsx?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,64 @@\n+// For this to work locally you need to use `pnpm next-with-deps dev|build`\n+// Make sure you delete node_modules if you are editing the package otherwise it won't\n+// reinstall and reflect your changes.\n+\n+import ExportsDefault from 'my-external-cjs-package/exports'\n+import * as ExportsNamed from 'my-external-cjs-package/exports'\n+import { named as namedExports } from 'my-external-cjs-package/exports'\n+\n+import ImportsDefault from 'my-external-cjs-package/imports'\n+import * as ImportsNamed from 'my-external-cjs-package/imports'\n+import { named as namedImports } from 'my-external-cjs-package/imports'\n+\n+const pendingDynamicExports = import('my-external-cjs-package/exports').then(\n+  (mod) => JSON.stringify(mod)\n+)\n+\n+const pendingDynamicImports = import('my-external-cjs-package/imports').then(\n+  (mod) => JSON.stringify(mod)\n+)\n+\n+import Client from './client'\n+\n+export default function Page() {\n+  return (\n+    <>\n+      <section>\n+        <h2>Server</h2>\n+        <section>\n+          <h3>Exports</h3>\n+          <section>\n+            <h4>Static</h4>\n+            <label>Default:</label>\n+            <div>{JSON.stringify(ExportsDefault)}</div>\n+            <label>Namespace:</label>\n+            <div>{JSON.stringify(ExportsNamed)}</div>\n+            <label>named:</label>\n+            <div>{JSON.stringify(namedExports)}</div>\n+          </section>\n+          <section>\n+            <h4>Dynamic</h4>\n+            <div>{pendingDynamicExports}</div>\n+          </section>\n+        </section>\n+        <section>\n+          <h3>Imports</h3>\n+          <section>\n+            <h4>Static</h4>\n+            <label>Default:</label>\n+            <div>{JSON.stringify(ImportsDefault)}</div>\n+            <label>Namespace:</label>\n+            <div>{JSON.stringify(ImportsNamed)}</div>\n+            <label>named:</label>\n+            <div>{JSON.stringify(namedImports)}</div>\n+          </section>\n+          <section>\n+            <h4>Dynamic</h4>\n+            <div>{pendingDynamicImports}</div>\n+          </section>\n+        </section>\n+      </section>\n+      <Client />\n+    </>\n+  )\n+}"
        },
        {
            "sha": "1c3adb999e18d8cd440734e1529ab95d724fba6e",
            "filename": "test/e2e/app-dir/next-condition/app/external-esm/client.tsx",
            "status": "added",
            "additions": 61,
            "deletions": 0,
            "changes": 61,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-esm%2Fclient.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-esm%2Fclient.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-esm%2Fclient.tsx?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,61 @@\n+'use client'\n+\n+// For this to work locally you need to use `pnpm next-with-deps dev|build`\n+// Make sure you delete node_modules if you are editing the package otherwise it won't\n+// reinstall and reflect your changes.\n+\n+import ExportsDefault from 'my-external-esm-package/exports'\n+import * as ExportsNamed from 'my-external-esm-package/exports'\n+import { named as namedExports } from 'my-external-esm-package/exports'\n+\n+import ImportsDefault from 'my-external-esm-package/imports'\n+import * as ImportsNamed from 'my-external-esm-package/imports'\n+import { named as namedImports } from 'my-external-esm-package/imports'\n+\n+const pendingDynamicExports = import('my-external-esm-package/exports').then(\n+  (mod) => JSON.stringify(mod)\n+)\n+\n+const pendingDynamicImports = import('my-external-esm-package/imports').then(\n+  (mod) => JSON.stringify(mod)\n+)\n+\n+export default function Client() {\n+  return (\n+    <section>\n+      <h2>Client</h2>\n+      <section>\n+        <h3>Exports</h3>\n+        <section>\n+          <h4>Static</h4>\n+          <label>Default:</label>\n+          <div>{JSON.stringify(ExportsDefault)}</div>\n+          <label>Namespace:</label>\n+          <div>{JSON.stringify(ExportsNamed)}</div>\n+          <label>named:</label>\n+          <div>{JSON.stringify(namedExports)}</div>\n+        </section>\n+        <section>\n+          <h4>Dynamic</h4>\n+          <div>{pendingDynamicExports}</div>\n+        </section>\n+      </section>\n+      <section>\n+        <h3>Imports</h3>\n+        <section>\n+          <h4>Static</h4>\n+          <label>Default:</label>\n+          <div>{JSON.stringify(ImportsDefault)}</div>\n+          <label>Namespace:</label>\n+          <div>{JSON.stringify(ImportsNamed)}</div>\n+          <label>named:</label>\n+          <div>{JSON.stringify(namedImports)}</div>\n+        </section>\n+        <section>\n+          <h4>Dynamic</h4>\n+          <div>{pendingDynamicImports}</div>\n+        </section>\n+      </section>\n+    </section>\n+  )\n+}"
        },
        {
            "sha": "d59675f38d6656b2c95d114ab63e28632205f4b5",
            "filename": "test/e2e/app-dir/next-condition/app/external-esm/page.tsx",
            "status": "added",
            "additions": 64,
            "deletions": 0,
            "changes": 64,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-esm%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-esm%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Fexternal-esm%2Fpage.tsx?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,64 @@\n+// For this to work locally you need to use `pnpm next-with-deps dev|build`\n+// Make sure you delete node_modules if you are editing the package otherwise it won't\n+// reinstall and reflect your changes.\n+\n+import ExportsDefault from 'my-external-esm-package/exports'\n+import * as ExportsNamed from 'my-external-esm-package/exports'\n+import { named as namedExports } from 'my-external-esm-package/exports'\n+\n+import ImportsDefault from 'my-external-esm-package/imports'\n+import * as ImportsNamed from 'my-external-esm-package/imports'\n+import { named as namedImports } from 'my-external-esm-package/imports'\n+\n+const pendingDynamicExports = import('my-external-esm-package/exports').then(\n+  (mod) => JSON.stringify(mod)\n+)\n+\n+const pendingDynamicImports = import('my-external-esm-package/imports').then(\n+  (mod) => JSON.stringify(mod)\n+)\n+\n+import Client from './client'\n+\n+export default function Page() {\n+  return (\n+    <>\n+      <section>\n+        <h2>Server</h2>\n+        <section>\n+          <h3>Exports</h3>\n+          <section>\n+            <h4>Static</h4>\n+            <label>Default:</label>\n+            <div>{JSON.stringify(ExportsDefault)}</div>\n+            <label>Namespace:</label>\n+            <div>{JSON.stringify(ExportsNamed)}</div>\n+            <label>named:</label>\n+            <div>{JSON.stringify(namedExports)}</div>\n+          </section>\n+          <section>\n+            <h4>Dynamic</h4>\n+            <div>{pendingDynamicExports}</div>\n+          </section>\n+        </section>\n+        <section>\n+          <h3>Imports</h3>\n+          <section>\n+            <h4>Static</h4>\n+            <label>Default:</label>\n+            <div>{JSON.stringify(ImportsDefault)}</div>\n+            <label>Namespace:</label>\n+            <div>{JSON.stringify(ImportsNamed)}</div>\n+            <label>named:</label>\n+            <div>{JSON.stringify(namedImports)}</div>\n+          </section>\n+          <section>\n+            <h4>Dynamic</h4>\n+            <div>{pendingDynamicImports}</div>\n+          </section>\n+        </section>\n+      </section>\n+      <Client />\n+    </>\n+  )\n+}"
        },
        {
            "sha": "745e32b8a8d235ef098d1a265f57c0254df40b5d",
            "filename": "test/e2e/app-dir/next-condition/app/layout.tsx",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fapp%2Flayout.tsx?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,9 @@\n+export default function Root({ children }: { children: React.ReactNode }) {\n+  return (\n+    <html>\n+      <body>\n+        <main>{children}</main>\n+      </body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "3932d4aaa042ca7ee29b53e704b466dfbe9334be",
            "filename": "test/e2e/app-dir/next-condition/next-condition.test.ts",
            "status": "added",
            "additions": 648,
            "deletions": 0,
            "changes": 648,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fnext-condition.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fnext-condition.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fnext-condition.test.ts?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,648 @@\n+import { nextTestSetup } from 'e2e-utils'\n+\n+describe('`next-js` Condition', () => {\n+  const { next, isTurbopack, skipped } = nextTestSetup({\n+    files: __dirname,\n+    dependencies: require('./package.json').dependencies,\n+    // Deploy tests are broken with `config.serverExternalPackages`\n+    skipDeployment: true,\n+  })\n+\n+  if (skipped) {\n+    return\n+  }\n+\n+  // TODO I should be able to access the complete config from a Next.js Server or Build\n+  // So I don't have to coordinate using process env variables\n+  const isUsingCacheComponents =\n+    process.env.__NEXT_EXPERIMENTAL_CACHE_COMPONENTS === 'true'\n+\n+  // Recommended for tests that check HTML. Cheerio is a HTML parser that has a jQuery like API.\n+  if (isUsingCacheComponents) {\n+    describe('When Cache Components is enabled', () => {\n+      it('should follow the next-js condition from a bundled commonjs package', async () => {\n+        const $ = await next.render$('/cjs')\n+\n+        const text = formatHtmlText($('main').html())\n+        if (isTurbopack) {\n+          expect(text).toMatchInlineSnapshot(`\n+           \"  Server\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS NEXT SERVER - Default Export\",\"named\":\"EXPORTS NEXT SERVER - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"EXPORTS NEXT SERVER - Default Export\",\"named\":\"EXPORTS NEXT SERVER - Named Export\"},\"named\":\"EXPORTS NEXT SERVER - Named Export\"}\n+                 named:\n+                 \"EXPORTS NEXT SERVER - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS NEXT SERVER - Default Export\",\"named\":\"EXPORTS NEXT SERVER - Named Export\"},\"named\":\"EXPORTS NEXT SERVER - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS NEXT SERVER - Default Export\",\"named\":\"IMPORTS NEXT SERVER - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"IMPORTS NEXT SERVER - Default Export\",\"named\":\"IMPORTS NEXT SERVER - Named Export\"},\"named\":\"IMPORTS NEXT SERVER - Named Export\"}\n+                 named:\n+                 \"IMPORTS NEXT SERVER - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS NEXT SERVER - Default Export\",\"named\":\"IMPORTS NEXT SERVER - Named Export\"},\"named\":\"IMPORTS NEXT SERVER - Named Export\"}\n+             Client\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS NEXT CLIENT - Default Export\",\"named\":\"EXPORTS NEXT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"EXPORTS NEXT CLIENT - Default Export\",\"named\":\"EXPORTS NEXT CLIENT - Named Export\"},\"named\":\"EXPORTS NEXT CLIENT - Named Export\"}\n+                 named:\n+                 \"EXPORTS NEXT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS NEXT CLIENT - Default Export\",\"named\":\"EXPORTS NEXT CLIENT - Named Export\"},\"named\":\"EXPORTS NEXT CLIENT - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS NEXT CLIENT - Default Export\",\"named\":\"IMPORTS NEXT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"IMPORTS NEXT CLIENT - Default Export\",\"named\":\"IMPORTS NEXT CLIENT - Named Export\"},\"named\":\"IMPORTS NEXT CLIENT - Named Export\"}\n+                 named:\n+                 \"IMPORTS NEXT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS NEXT CLIENT - Default Export\",\"named\":\"IMPORTS NEXT CLIENT - Named Export\"},\"named\":\"IMPORTS NEXT CLIENT - Named Export\"}\"\n+          `)\n+        } else {\n+          expect(text).toMatchInlineSnapshot(`\n+           \"  Server\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS NEXT SERVER - Default Export\",\"named\":\"EXPORTS NEXT SERVER - Named Export\"}\n+                 Namespace:\n+                 {\"default\":\"EXPORTS NEXT SERVER - Default Export\",\"named\":\"EXPORTS NEXT SERVER - Named Export\"}\n+                 named:\n+                 \"EXPORTS NEXT SERVER - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS NEXT SERVER - Default Export\",\"named\":\"EXPORTS NEXT SERVER - Named Export\"},\"named\":\"EXPORTS NEXT SERVER - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS NEXT SERVER - Default Export\",\"named\":\"IMPORTS NEXT SERVER - Named Export\"}\n+                 Namespace:\n+                 {\"default\":\"IMPORTS NEXT SERVER - Default Export\",\"named\":\"IMPORTS NEXT SERVER - Named Export\"}\n+                 named:\n+                 \"IMPORTS NEXT SERVER - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS NEXT SERVER - Default Export\",\"named\":\"IMPORTS NEXT SERVER - Named Export\"},\"named\":\"IMPORTS NEXT SERVER - Named Export\"}\n+             Client\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS NEXT CLIENT - Default Export\",\"named\":\"EXPORTS NEXT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":\"EXPORTS NEXT CLIENT - Default Export\",\"named\":\"EXPORTS NEXT CLIENT - Named Export\"}\n+                 named:\n+                 \"EXPORTS NEXT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS NEXT CLIENT - Default Export\",\"named\":\"EXPORTS NEXT CLIENT - Named Export\"},\"named\":\"EXPORTS NEXT CLIENT - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS NEXT CLIENT - Default Export\",\"named\":\"IMPORTS NEXT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":\"IMPORTS NEXT CLIENT - Default Export\",\"named\":\"IMPORTS NEXT CLIENT - Named Export\"}\n+                 named:\n+                 \"IMPORTS NEXT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS NEXT CLIENT - Default Export\",\"named\":\"IMPORTS NEXT CLIENT - Named Export\"},\"named\":\"IMPORTS NEXT CLIENT - Named Export\"}\"\n+          `)\n+        }\n+      })\n+      it('should follow the next-js condition from a bundled esm package', async () => {\n+        const $ = await next.render$('/esm')\n+\n+        const text = formatHtmlText($('main').html())\n+        expect(text).toMatchInlineSnapshot(`\n+         \"  Server\n+             Exports\n+               Static\n+               Default:\n+               \"EXPORTS NEXT SERVER - Default Export\"\n+               Namespace:\n+               {\"default\":\"EXPORTS NEXT SERVER - Default Export\",\"named\":\"EXPORTS NEXT SERVER - Named Export\"}\n+               named:\n+               \"EXPORTS NEXT SERVER - Named Export\"\n+               Dynamic\n+               {\"default\":\"EXPORTS NEXT SERVER - Default Export\",\"named\":\"EXPORTS NEXT SERVER - Named Export\"}\n+             Imports\n+               Static\n+               Default:\n+               \"IMPORTS NEXT SERVER - Default Export\"\n+               Namespace:\n+               {\"default\":\"IMPORTS NEXT SERVER - Default Export\",\"named\":\"IMPORTS NEXT SERVER - Named Export\"}\n+               named:\n+               \"IMPORTS NEXT SERVER - Named Export\"\n+               Dynamic\n+               {\"default\":\"IMPORTS NEXT SERVER - Default Export\",\"named\":\"IMPORTS NEXT SERVER - Named Export\"}\n+           Client\n+             Exports\n+               Static\n+               Default:\n+               \"EXPORTS NEXT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"EXPORTS NEXT CLIENT - Default Export\",\"named\":\"EXPORTS NEXT CLIENT - Named Export\"}\n+               named:\n+               \"EXPORTS NEXT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"EXPORTS NEXT CLIENT - Default Export\",\"named\":\"EXPORTS NEXT CLIENT - Named Export\"}\n+             Imports\n+               Static\n+               Default:\n+               \"IMPORTS NEXT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"IMPORTS NEXT CLIENT - Default Export\",\"named\":\"IMPORTS NEXT CLIENT - Named Export\"}\n+               named:\n+               \"IMPORTS NEXT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"IMPORTS NEXT CLIENT - Default Export\",\"named\":\"IMPORTS NEXT CLIENT - Named Export\"}\"\n+        `)\n+      })\n+      /**\n+       * We actually want this condition to be followed even for externals but it is tricky to ensure\n+       * we are running Node.js with the appropriate condition since the right condition depends on information\n+       * we derive while running Node.js. We will follow up with a change that enables the condition\n+       * for externals as well but for now we assert the current behavior.\n+       */\n+      it('should not follow the next-js condition from an external commonjs package', async () => {\n+        const $ = await next.render$('/external-cjs')\n+\n+        const text = formatHtmlText($('main').html())\n+        if (isTurbopack) {\n+          expect(text).toMatchInlineSnapshot(`\n+           \"  Server\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+             Client\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\"\n+          `)\n+        } else {\n+          expect(text).toMatchInlineSnapshot(`\n+           \"  Server\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+             Client\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\"\n+          `)\n+        }\n+      })\n+      /**\n+       * We actually want this condition to be followed even for externals but it is tricky to ensure\n+       * we are running Node.js with the appropriate condition since the right condition depends on information\n+       * we derive while running Node.js. We will follow up with a change that enables the condition\n+       * for externals as well but for now we assert the current behavior.\n+       */\n+      it('should follow the next-js condition from an external esm package', async () => {\n+        const $ = await next.render$('/external-esm')\n+\n+        const text = formatHtmlText($('main').html())\n+        expect(text).toMatchInlineSnapshot(`\n+         \"  Server\n+             Exports\n+               Static\n+               Default:\n+               \"EXPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"EXPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+             Imports\n+               Static\n+               Default:\n+               \"IMPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"IMPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+           Client\n+             Exports\n+               Static\n+               Default:\n+               \"EXPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"EXPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+             Imports\n+               Static\n+               Default:\n+               \"IMPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"IMPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\"\n+        `)\n+      })\n+    })\n+  } else {\n+    describe('When Cache Components is disabled', () => {\n+      it('should not follow the next-js condition from a bundled commonjs package', async () => {\n+        const $ = await next.render$('/cjs')\n+\n+        const text = formatHtmlText($('main').html())\n+        if (isTurbopack) {\n+          expect(text).toMatchInlineSnapshot(`\n+           \"  Server\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS DEFAULT SERVER - Default Export\",\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT SERVER - Default Export\",\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"},\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"}\n+                 named:\n+                 \"EXPORTS DEFAULT SERVER - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT SERVER - Default Export\",\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"},\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS DEFAULT SERVER - Default Export\",\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT SERVER - Default Export\",\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"},\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"}\n+                 named:\n+                 \"IMPORTS DEFAULT SERVER - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT SERVER - Default Export\",\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"},\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"}\n+             Client\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\"\n+          `)\n+        } else {\n+          expect(text).toMatchInlineSnapshot(`\n+                    \"  Server\n+                        Exports\n+                          Static\n+                          Default:\n+                          {\"default\":\"EXPORTS DEFAULT SERVER - Default Export\",\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"}\n+                          Namespace:\n+                          {\"default\":\"EXPORTS DEFAULT SERVER - Default Export\",\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"}\n+                          named:\n+                          \"EXPORTS DEFAULT SERVER - Named Export\"\n+                          Dynamic\n+                          {\"default\":{\"default\":\"EXPORTS DEFAULT SERVER - Default Export\",\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"},\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"}\n+                        Imports\n+                          Static\n+                          Default:\n+                          {\"default\":\"IMPORTS DEFAULT SERVER - Default Export\",\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"}\n+                          Namespace:\n+                          {\"default\":\"IMPORTS DEFAULT SERVER - Default Export\",\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"}\n+                          named:\n+                          \"IMPORTS DEFAULT SERVER - Named Export\"\n+                          Dynamic\n+                          {\"default\":{\"default\":\"IMPORTS DEFAULT SERVER - Default Export\",\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"},\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"}\n+                      Client\n+                        Exports\n+                          Static\n+                          Default:\n+                          {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                          Namespace:\n+                          {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                          named:\n+                          \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                          Dynamic\n+                          {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                        Imports\n+                          Static\n+                          Default:\n+                          {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                          Namespace:\n+                          {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                          named:\n+                          \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                          Dynamic\n+                          {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\"\n+                  `)\n+        }\n+      })\n+      it('should not follow the next-js condition from a bundled esm package', async () => {\n+        const $ = await next.render$('/esm')\n+\n+        const text = formatHtmlText($('main').html())\n+        expect(text).toMatchInlineSnapshot(`\n+         \"  Server\n+             Exports\n+               Static\n+               Default:\n+               \"EXPORTS DEFAULT SERVER - Default Export\"\n+               Namespace:\n+               {\"default\":\"EXPORTS DEFAULT SERVER - Default Export\",\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"}\n+               named:\n+               \"EXPORTS DEFAULT SERVER - Named Export\"\n+               Dynamic\n+               {\"default\":\"EXPORTS DEFAULT SERVER - Default Export\",\"named\":\"EXPORTS DEFAULT SERVER - Named Export\"}\n+             Imports\n+               Static\n+               Default:\n+               \"IMPORTS DEFAULT SERVER - Default Export\"\n+               Namespace:\n+               {\"default\":\"IMPORTS DEFAULT SERVER - Default Export\",\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"}\n+               named:\n+               \"IMPORTS DEFAULT SERVER - Named Export\"\n+               Dynamic\n+               {\"default\":\"IMPORTS DEFAULT SERVER - Default Export\",\"named\":\"IMPORTS DEFAULT SERVER - Named Export\"}\n+           Client\n+             Exports\n+               Static\n+               Default:\n+               \"EXPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"EXPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+             Imports\n+               Static\n+               Default:\n+               \"IMPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"IMPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\"\n+        `)\n+      })\n+      it('should not follow the next-js condition from an external commonjs package', async () => {\n+        const $ = await next.render$('/external-cjs')\n+\n+        const text = formatHtmlText($('main').html())\n+        if (isTurbopack) {\n+          expect(text).toMatchInlineSnapshot(`\n+           \"  Server\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+             Client\n+               Exports\n+                 Static\n+                 Default:\n+                 {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               Imports\n+                 Static\n+                 Default:\n+                 {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 Namespace:\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                 named:\n+                 \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                 Dynamic\n+                 {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\"\n+          `)\n+        } else {\n+          expect(text).toMatchInlineSnapshot(`\n+                    \"  Server\n+                        Exports\n+                          Static\n+                          Default:\n+                          {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                          Namespace:\n+                          {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                          named:\n+                          \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                          Dynamic\n+                          {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                        Imports\n+                          Static\n+                          Default:\n+                          {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                          Namespace:\n+                          {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                          named:\n+                          \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                          Dynamic\n+                          {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                      Client\n+                        Exports\n+                          Static\n+                          Default:\n+                          {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                          Namespace:\n+                          {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                          named:\n+                          \"EXPORTS DEFAULT CLIENT - Named Export\"\n+                          Dynamic\n+                          {\"default\":{\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+                        Imports\n+                          Static\n+                          Default:\n+                          {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                          Namespace:\n+                          {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+                          named:\n+                          \"IMPORTS DEFAULT CLIENT - Named Export\"\n+                          Dynamic\n+                          {\"default\":{\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"},\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\"\n+                  `)\n+        }\n+      })\n+      it('should not follow the next-js condition from an external esm package', async () => {\n+        const $ = await next.render$('/external-esm')\n+\n+        const text = formatHtmlText($('main').html())\n+        expect(text).toMatchInlineSnapshot(`\n+         \"  Server\n+             Exports\n+               Static\n+               Default:\n+               \"EXPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"EXPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+             Imports\n+               Static\n+               Default:\n+               \"IMPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"IMPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+           Client\n+             Exports\n+               Static\n+               Default:\n+               \"EXPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"EXPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"EXPORTS DEFAULT CLIENT - Default Export\",\"named\":\"EXPORTS DEFAULT CLIENT - Named Export\"}\n+             Imports\n+               Static\n+               Default:\n+               \"IMPORTS DEFAULT CLIENT - Default Export\"\n+               Namespace:\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\n+               named:\n+               \"IMPORTS DEFAULT CLIENT - Named Export\"\n+               Dynamic\n+               {\"default\":\"IMPORTS DEFAULT CLIENT - Default Export\",\"named\":\"IMPORTS DEFAULT CLIENT - Named Export\"}\"\n+        `)\n+      })\n+    })\n+  }\n+})\n+\n+/**\n+ * produces more readable snapshots by stripping tags and auto formatting\n+ */\n+function formatHtmlText(html) {\n+  let depth = 0\n+  return html\n+    .replace(/<!--[\\s\\S]*?-->/g, '') // strip comments\n+    .replace(/>\\s*</g, '><')\n+    .replace(/</g, '\\n<')\n+    .split('\\n')\n+    .map((line) => {\n+      if (/^<\\//.test(line)) depth--\n+      let txt = line.replace(/<[^>]+>/g, '').trim()\n+      if (txt) {\n+        txt = txt\n+          .replace(/&quot;/g, '\"')\n+          .replace(/&lt;/g, '<')\n+          .replace(/&gt;/g, '>')\n+          .replace(/&amp;/g, '&')\n+      }\n+      const out = txt ? '  '.repeat(Math.max(depth, 0)) + txt : ''\n+      if (/^<[^/!][^>]*[^/]?>/.test(line)) depth++\n+      return out\n+    })\n+    .filter(Boolean)\n+    .join('\\n')\n+}"
        },
        {
            "sha": "63e32c68184d3fcbd7dd448da681c0a2047bd279",
            "filename": "test/e2e/app-dir/next-condition/next.config.js",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fnext.config.js?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,12 @@\n+/**\n+ * @type {import('next').NextConfig}\n+ */\n+\n+const nextConfig = {\n+  serverExternalPackages: [\n+    'my-external-esm-package',\n+    'my-external-cjs-package',\n+  ],\n+}\n+\n+module.exports = nextConfig"
        },
        {
            "sha": "6f22894553f326898a7118dff26f43db280a6fc4",
            "filename": "test/e2e/app-dir/next-condition/package.json",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackage.json?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,8 @@\n+{\n+  \"dependencies\": {\n+    \"my-cjs-package\": \"file:./packages/my-cjs-package\",\n+    \"my-esm-package\": \"file:./packages/my-esm-package\",\n+    \"my-external-cjs-package\": \"file:./packages/my-external-cjs-package\",\n+    \"my-external-esm-package\": \"file:./packages/my-external-esm-package\"\n+  }\n+}"
        },
        {
            "sha": "bca310dbe9feeaf730e9c3168fa641878f326448",
            "filename": "test/e2e/app-dir/next-condition/packages.d.ts",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages.d.ts?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,8 @@\n+declare module 'my-cjs-package/exports'\n+declare module 'my-cjs-package/imports'\n+declare module 'my-esm-package/exports'\n+declare module 'my-esm-package/imports'\n+declare module 'my-external-cjs-package/exports'\n+declare module 'my-external-cjs-package/imports'\n+declare module 'my-external-esm-package/exports'\n+declare module 'my-external-esm-package/imports'"
        },
        {
            "sha": "59ae7f848094b0cd7f035d1ef15dd8ca03b18b9f",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/package.json",
            "status": "added",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fpackage.json?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,33 @@\n+{\n+  \"name\": \"my-cjs-package\",\n+  \"version\": \"0.0.0\",\n+  \"type\": \"commonjs\",\n+  \"files\": [\n+    \"src\"\n+  ],\n+  \"exports\": {\n+    \"./exports\": {\n+      \"next-js\": {\n+        \"react-server\": \"./src/exports.next.server.cjs\",\n+        \"default\": \"./src/exports.next.default.cjs\"\n+      },\n+      \"default\": {\n+        \"react-server\": \"./src/exports.default.server.cjs\",\n+        \"default\": \"./src/exports.default.default.cjs\"\n+      }\n+    },\n+    \"./imports\": \"./src/imports.cjs\"\n+  },\n+  \"imports\": {\n+    \"#imports\": {\n+      \"next-js\": {\n+        \"react-server\": \"./src/imports/imports.next.server.cjs\",\n+        \"default\": \"./src/imports/imports.next.default.cjs\"\n+      },\n+      \"default\": {\n+        \"react-server\": \"./src/imports/imports.default.server.cjs\",\n+        \"default\": \"./src/imports/imports.default.default.cjs\"\n+      }\n+    }\n+  }\n+}"
        },
        {
            "sha": "45a58cd83380107d157707e4eaeee1611b85cbad",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/src/exports.default.default.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.default.default.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.default.default.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.default.default.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'EXPORTS DEFAULT CLIENT - Default Export',\n+  named: 'EXPORTS DEFAULT CLIENT - Named Export',\n+}"
        },
        {
            "sha": "2d6f59ebbb89479cebd0c54203a3cc9a047c76f9",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/src/exports.default.server.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.default.server.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.default.server.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.default.server.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'EXPORTS DEFAULT SERVER - Default Export',\n+  named: 'EXPORTS DEFAULT SERVER - Named Export',\n+}"
        },
        {
            "sha": "fc69523910f805be8c4c8b627cc817e68b03f334",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/src/exports.next.default.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.next.default.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.next.default.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.next.default.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'EXPORTS NEXT CLIENT - Default Export',\n+  named: 'EXPORTS NEXT CLIENT - Named Export',\n+}"
        },
        {
            "sha": "4ad43ae403c565e86258bc732d091c847c8b11a8",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/src/exports.next.server.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.next.server.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.next.server.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fexports.next.server.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'EXPORTS NEXT SERVER - Default Export',\n+  named: 'EXPORTS NEXT SERVER - Named Export',\n+}"
        },
        {
            "sha": "191d7e5b51959e5f8de8cef762321abf56783593",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/src/imports.cjs",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,3 @@\n+const Imports = require('#imports')\n+\n+module.exports = Imports"
        },
        {
            "sha": "62f7ceed930146fa8b45a508a5544b1570773350",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/src/imports/imports.default.default.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.default.default.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.default.default.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.default.default.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'IMPORTS DEFAULT CLIENT - Default Export',\n+  named: 'IMPORTS DEFAULT CLIENT - Named Export',\n+}"
        },
        {
            "sha": "4261b3410330b682ae01d2423dbc87ac163a074a",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/src/imports/imports.default.server.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.default.server.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.default.server.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.default.server.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'IMPORTS DEFAULT SERVER - Default Export',\n+  named: 'IMPORTS DEFAULT SERVER - Named Export',\n+}"
        },
        {
            "sha": "815998eff98c4fc11dd2f5fe40854b9adb529181",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/src/imports/imports.next.default.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.next.default.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.next.default.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.next.default.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'IMPORTS NEXT CLIENT - Default Export',\n+  named: 'IMPORTS NEXT CLIENT - Named Export',\n+}"
        },
        {
            "sha": "6c33abbb3947881748b656e5b77bfe383515df9a",
            "filename": "test/e2e/app-dir/next-condition/packages/my-cjs-package/src/imports/imports.next.server.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.next.server.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.next.server.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-cjs-package%2Fsrc%2Fimports%2Fimports.next.server.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'IMPORTS NEXT SERVER - Default Export',\n+  named: 'IMPORTS NEXT SERVER - Named Export',\n+}"
        },
        {
            "sha": "20304f95451d7b78cd7c3ecf839a2264b75d56f0",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/package.json",
            "status": "added",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fpackage.json?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,33 @@\n+{\n+  \"name\": \"my-esm-package\",\n+  \"version\": \"0.0.0\",\n+  \"type\": \"module\",\n+  \"files\": [\n+    \"src\"\n+  ],\n+  \"exports\": {\n+    \"./exports\": {\n+      \"next-js\": {\n+        \"react-server\": \"./src/exports.next.server.mjs\",\n+        \"default\": \"./src/exports.next.default.mjs\"\n+      },\n+      \"default\": {\n+        \"react-server\": \"./src/exports.default.server.mjs\",\n+        \"default\": \"./src/exports.default.default.mjs\"\n+      }\n+    },\n+    \"./imports\": \"./src/imports.mjs\"\n+  },\n+  \"imports\": {\n+    \"#imports\": {\n+      \"next-js\": {\n+        \"react-server\": \"./src/imports/imports.next.server.mjs\",\n+        \"default\": \"./src/imports/imports.next.default.mjs\"\n+      },\n+      \"default\": {\n+        \"react-server\": \"./src/imports/imports.default.server.mjs\",\n+        \"default\": \"./src/imports/imports.default.default.mjs\"\n+      }\n+    }\n+  }\n+}"
        },
        {
            "sha": "ec909bf9dc15a43c767a5314ec1f195c4fc5983d",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/src/exports.default.default.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.default.default.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.default.default.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.default.default.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'EXPORTS DEFAULT CLIENT - Default Export'\n+export const named = 'EXPORTS DEFAULT CLIENT - Named Export'"
        },
        {
            "sha": "ad00e9c4e124d32e647ef4b50fbf7a1bc11e2fc2",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/src/exports.default.server.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.default.server.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.default.server.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.default.server.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'EXPORTS DEFAULT SERVER - Default Export'\n+export const named = 'EXPORTS DEFAULT SERVER - Named Export'"
        },
        {
            "sha": "34fc7f153825182a27d65e99b9a3c13fdd860c4c",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/src/exports.next.default.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.next.default.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.next.default.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.next.default.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'EXPORTS NEXT CLIENT - Default Export'\n+export const named = 'EXPORTS NEXT CLIENT - Named Export'"
        },
        {
            "sha": "ca015bd5f5e8b4d9434f41414db438b94d1481a7",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/src/exports.next.server.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.next.server.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.next.server.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fexports.next.server.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'EXPORTS NEXT SERVER - Default Export'\n+export const named = 'EXPORTS NEXT SERVER - Named Export'"
        },
        {
            "sha": "e825df4e2a363fb738549d384ae896a627612d9f",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/src/imports.mjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+import Imports from '#imports'\n+\n+export * from '#imports'\n+export default Imports"
        },
        {
            "sha": "d0fa994de0f953f315a80a947cd69e5f11eaa8d2",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/src/imports/imports.default.default.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.default.default.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.default.default.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.default.default.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'IMPORTS DEFAULT CLIENT - Default Export'\n+export const named = 'IMPORTS DEFAULT CLIENT - Named Export'"
        },
        {
            "sha": "76dc2fcb78270f344f1c3c0109a4c7bc2e80a503",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/src/imports/imports.default.server.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.default.server.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.default.server.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.default.server.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'IMPORTS DEFAULT SERVER - Default Export'\n+export const named = 'IMPORTS DEFAULT SERVER - Named Export'"
        },
        {
            "sha": "6eded42f2bbc7bce856e7390e91e1d94c440dd82",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/src/imports/imports.next.default.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.next.default.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.next.default.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.next.default.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'IMPORTS NEXT CLIENT - Default Export'\n+export const named = 'IMPORTS NEXT CLIENT - Named Export'"
        },
        {
            "sha": "1c90eea9ed645bf83687001e8bc6ef91a12641bc",
            "filename": "test/e2e/app-dir/next-condition/packages/my-esm-package/src/imports/imports.next.server.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.next.server.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.next.server.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-esm-package%2Fsrc%2Fimports%2Fimports.next.server.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'IMPORTS NEXT SERVER - Default Export'\n+export const named = 'IMPORTS NEXT SERVER - Named Export'"
        },
        {
            "sha": "7d9c81a5e6b30b2415844628d57046e75e51a542",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/package.json",
            "status": "added",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fpackage.json?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,33 @@\n+{\n+  \"name\": \"my-external-cjs-package\",\n+  \"version\": \"0.0.0\",\n+  \"type\": \"commonjs\",\n+  \"files\": [\n+    \"src\"\n+  ],\n+  \"exports\": {\n+    \"./exports\": {\n+      \"next-js\": {\n+        \"react-server\": \"./src/exports.next.server.cjs\",\n+        \"default\": \"./src/exports.next.default.cjs\"\n+      },\n+      \"default\": {\n+        \"react-server\": \"./src/exports.default.server.cjs\",\n+        \"default\": \"./src/exports.default.default.cjs\"\n+      }\n+    },\n+    \"./imports\": \"./src/imports.cjs\"\n+  },\n+  \"imports\": {\n+    \"#imports\": {\n+      \"next-js\": {\n+        \"react-server\": \"./src/imports/imports.next.server.cjs\",\n+        \"default\": \"./src/imports/imports.next.default.cjs\"\n+      },\n+      \"default\": {\n+        \"react-server\": \"./src/imports/imports.default.server.cjs\",\n+        \"default\": \"./src/imports/imports.default.default.cjs\"\n+      }\n+    }\n+  }\n+}"
        },
        {
            "sha": "45a58cd83380107d157707e4eaeee1611b85cbad",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/src/exports.default.default.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.default.default.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.default.default.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.default.default.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'EXPORTS DEFAULT CLIENT - Default Export',\n+  named: 'EXPORTS DEFAULT CLIENT - Named Export',\n+}"
        },
        {
            "sha": "2d6f59ebbb89479cebd0c54203a3cc9a047c76f9",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/src/exports.default.server.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.default.server.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.default.server.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.default.server.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'EXPORTS DEFAULT SERVER - Default Export',\n+  named: 'EXPORTS DEFAULT SERVER - Named Export',\n+}"
        },
        {
            "sha": "fc69523910f805be8c4c8b627cc817e68b03f334",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/src/exports.next.default.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.next.default.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.next.default.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.next.default.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'EXPORTS NEXT CLIENT - Default Export',\n+  named: 'EXPORTS NEXT CLIENT - Named Export',\n+}"
        },
        {
            "sha": "4ad43ae403c565e86258bc732d091c847c8b11a8",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/src/exports.next.server.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.next.server.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.next.server.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fexports.next.server.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'EXPORTS NEXT SERVER - Default Export',\n+  named: 'EXPORTS NEXT SERVER - Named Export',\n+}"
        },
        {
            "sha": "191d7e5b51959e5f8de8cef762321abf56783593",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/src/imports.cjs",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,3 @@\n+const Imports = require('#imports')\n+\n+module.exports = Imports"
        },
        {
            "sha": "62f7ceed930146fa8b45a508a5544b1570773350",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/src/imports/imports.default.default.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.default.default.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.default.default.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.default.default.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'IMPORTS DEFAULT CLIENT - Default Export',\n+  named: 'IMPORTS DEFAULT CLIENT - Named Export',\n+}"
        },
        {
            "sha": "4261b3410330b682ae01d2423dbc87ac163a074a",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/src/imports/imports.default.server.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.default.server.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.default.server.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.default.server.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'IMPORTS DEFAULT SERVER - Default Export',\n+  named: 'IMPORTS DEFAULT SERVER - Named Export',\n+}"
        },
        {
            "sha": "815998eff98c4fc11dd2f5fe40854b9adb529181",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/src/imports/imports.next.default.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.next.default.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.next.default.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.next.default.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'IMPORTS NEXT CLIENT - Default Export',\n+  named: 'IMPORTS NEXT CLIENT - Named Export',\n+}"
        },
        {
            "sha": "6c33abbb3947881748b656e5b77bfe383515df9a",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-cjs-package/src/imports/imports.next.server.cjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.next.server.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.next.server.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-cjs-package%2Fsrc%2Fimports%2Fimports.next.server.cjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  default: 'IMPORTS NEXT SERVER - Default Export',\n+  named: 'IMPORTS NEXT SERVER - Named Export',\n+}"
        },
        {
            "sha": "f9c597fefb9850bfa97f50ad6595f184f93ec9d6",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/package.json",
            "status": "added",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fpackage.json?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,33 @@\n+{\n+  \"name\": \"my-external-esm-package\",\n+  \"version\": \"0.0.0\",\n+  \"type\": \"module\",\n+  \"files\": [\n+    \"src\"\n+  ],\n+  \"exports\": {\n+    \"./exports\": {\n+      \"next-js\": {\n+        \"react-server\": \"./src/exports.next.server.mjs\",\n+        \"default\": \"./src/exports.next.default.mjs\"\n+      },\n+      \"default\": {\n+        \"react-server\": \"./src/exports.default.server.mjs\",\n+        \"default\": \"./src/exports.default.default.mjs\"\n+      }\n+    },\n+    \"./imports\": \"./src/imports.mjs\"\n+  },\n+  \"imports\": {\n+    \"#imports\": {\n+      \"next-js\": {\n+        \"react-server\": \"./src/imports/imports.next.server.mjs\",\n+        \"default\": \"./src/imports/imports.next.default.mjs\"\n+      },\n+      \"default\": {\n+        \"react-server\": \"./src/imports/imports.default.server.mjs\",\n+        \"default\": \"./src/imports/imports.default.default.mjs\"\n+      }\n+    }\n+  }\n+}"
        },
        {
            "sha": "ec909bf9dc15a43c767a5314ec1f195c4fc5983d",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/src/exports.default.default.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.default.default.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.default.default.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.default.default.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'EXPORTS DEFAULT CLIENT - Default Export'\n+export const named = 'EXPORTS DEFAULT CLIENT - Named Export'"
        },
        {
            "sha": "ad00e9c4e124d32e647ef4b50fbf7a1bc11e2fc2",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/src/exports.default.server.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.default.server.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.default.server.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.default.server.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'EXPORTS DEFAULT SERVER - Default Export'\n+export const named = 'EXPORTS DEFAULT SERVER - Named Export'"
        },
        {
            "sha": "34fc7f153825182a27d65e99b9a3c13fdd860c4c",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/src/exports.next.default.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.next.default.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.next.default.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.next.default.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'EXPORTS NEXT CLIENT - Default Export'\n+export const named = 'EXPORTS NEXT CLIENT - Named Export'"
        },
        {
            "sha": "ca015bd5f5e8b4d9434f41414db438b94d1481a7",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/src/exports.next.server.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.next.server.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.next.server.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fexports.next.server.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'EXPORTS NEXT SERVER - Default Export'\n+export const named = 'EXPORTS NEXT SERVER - Named Export'"
        },
        {
            "sha": "e825df4e2a363fb738549d384ae896a627612d9f",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/src/imports.mjs",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,4 @@\n+import Imports from '#imports'\n+\n+export * from '#imports'\n+export default Imports"
        },
        {
            "sha": "d0fa994de0f953f315a80a947cd69e5f11eaa8d2",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/src/imports/imports.default.default.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.default.default.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.default.default.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.default.default.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'IMPORTS DEFAULT CLIENT - Default Export'\n+export const named = 'IMPORTS DEFAULT CLIENT - Named Export'"
        },
        {
            "sha": "76dc2fcb78270f344f1c3c0109a4c7bc2e80a503",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/src/imports/imports.default.server.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.default.server.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.default.server.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.default.server.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'IMPORTS DEFAULT SERVER - Default Export'\n+export const named = 'IMPORTS DEFAULT SERVER - Named Export'"
        },
        {
            "sha": "6eded42f2bbc7bce856e7390e91e1d94c440dd82",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/src/imports/imports.next.default.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.next.default.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.next.default.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.next.default.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'IMPORTS NEXT CLIENT - Default Export'\n+export const named = 'IMPORTS NEXT CLIENT - Named Export'"
        },
        {
            "sha": "1c90eea9ed645bf83687001e8bc6ef91a12641bc",
            "filename": "test/e2e/app-dir/next-condition/packages/my-external-esm-package/src/imports/imports.next.server.mjs",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.next.server.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/2ae9f1a3a51214547cebed2b39daea5f5f58310d/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.next.server.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-condition%2Fpackages%2Fmy-external-esm-package%2Fsrc%2Fimports%2Fimports.next.server.mjs?ref=2ae9f1a3a51214547cebed2b39daea5f5f58310d",
            "patch": "@@ -0,0 +1,2 @@\n+export default 'IMPORTS NEXT SERVER - Default Export'\n+export const named = 'IMPORTS NEXT SERVER - Named Export'"
        }
    ],
    "stats": {
        "total": 1494,
        "additions": 1465,
        "deletions": 29
    }
}