{
    "author": "timneutkens",
    "message": "Webpack build: Add compiled in x seconds in missing places (#77751)\n\n### What?\n\nAdded duration of the webpack build in a few missing places. This was\nalready added earlier but it seems we missed 2 cases where it logs\n`compiled successfully` but did not include a timing. E.g. shadcn-ui's\napps/v4 did not show the webpack compile time.\n\n### How?\n- Moved the `durationToString` function from `build/index.ts` to a\ndedicated file\n- Added duration information to successful compilation messages in\nwebpack build\n- Updated log messages to show compilation time in appropriate units\n(ms, s, min)\n\nFixes #",
    "sha": "15a9619180beadb73cf22320c77d62718b1c51e4",
    "files": [
        {
            "sha": "daf7a314e2d3f8fc8f3394b7680943169ca906a8",
            "filename": "packages/next/src/build/duration-to-string.ts",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/15a9619180beadb73cf22320c77d62718b1c51e4/packages%2Fnext%2Fsrc%2Fbuild%2Fduration-to-string.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/15a9619180beadb73cf22320c77d62718b1c51e4/packages%2Fnext%2Fsrc%2Fbuild%2Fduration-to-string.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fduration-to-string.ts?ref=15a9619180beadb73cf22320c77d62718b1c51e4",
            "patch": "@@ -0,0 +1,13 @@\n+export function durationToString(compilerDuration: number) {\n+  let durationString\n+  if (compilerDuration > 120) {\n+    durationString = `${(compilerDuration / 60).toFixed(1)}min`\n+  } else if (compilerDuration > 40) {\n+    durationString = `${compilerDuration.toFixed(0)}s`\n+  } else if (compilerDuration > 2) {\n+    durationString = `${compilerDuration.toFixed(1)}s`\n+  } else {\n+    durationString = `${(compilerDuration * 1000).toFixed(0)}ms`\n+  }\n+  return durationString\n+}"
        },
        {
            "sha": "0fa2351c967492a04908258d84c0ca3c53cc464e",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 14,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/15a9619180beadb73cf22320c77d62718b1c51e4/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/15a9619180beadb73cf22320c77d62718b1c51e4/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=15a9619180beadb73cf22320c77d62718b1c51e4",
            "patch": "@@ -209,6 +209,7 @@ import { turbopackBuild } from './turbopack-build'\n import { isPersistentCachingEnabled } from '../shared/lib/turbopack/utils'\n import { inlineStaticEnv } from '../lib/inline-static-env'\n import { populateStaticEnv } from '../lib/static-env'\n+import { durationToString } from './duration-to-string'\n \n type Fallback = null | boolean | string\n \n@@ -3725,17 +3726,3 @@ export default async function build(\n     }\n   }\n }\n-\n-function durationToString(compilerDuration: number) {\n-  let durationString\n-  if (compilerDuration > 120) {\n-    durationString = `${(compilerDuration / 60).toFixed(1)}min`\n-  } else if (compilerDuration > 40) {\n-    durationString = `${compilerDuration.toFixed(0)}s`\n-  } else if (compilerDuration > 2) {\n-    durationString = `${compilerDuration.toFixed(1)}s`\n-  } else {\n-    durationString = `${(compilerDuration * 1000).toFixed(0)}ms`\n-  }\n-  return durationString\n-}"
        },
        {
            "sha": "ce490e024bb1a8dbb4a56115074a2e1f43551b3d",
            "filename": "packages/next/src/build/webpack-build/impl.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/15a9619180beadb73cf22320c77d62718b1c51e4/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Fimpl.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/15a9619180beadb73cf22320c77d62718b1c51e4/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Fimpl.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Fimpl.ts?ref=15a9619180beadb73cf22320c77d62718b1c51e4",
            "patch": "@@ -40,6 +40,7 @@ import type { UnwrapPromise } from '../../lib/coalesced-function'\n \n import origDebug from 'next/dist/compiled/debug'\n import { Telemetry } from '../../telemetry/storage'\n+import { durationToString } from '../duration-to-string'\n \n const debug = origDebug('next:build:webpack-build')\n \n@@ -340,12 +341,15 @@ export async function webpackBuildImpl(\n     err.code = 'WEBPACK_ERRORS'\n     throw err\n   } else {\n+    const duration = webpackBuildEnd[0]\n+    const durationString = durationToString(duration)\n+\n     if (result.warnings.length > 0) {\n-      Log.warn('Compiled with warnings\\n')\n+      Log.warn(`Compiled with warnings in ${durationString}\\n`)\n       console.warn(result.warnings.filter(Boolean).join('\\n\\n'))\n       console.warn()\n     } else if (!compilerName) {\n-      Log.event('Compiled successfully')\n+      Log.event(`Compiled successfully in ${durationString}`)\n     }\n \n     return {"
        },
        {
            "sha": "ce8e3fb07f6cdc16f1a5abae770ee3eea43db60b",
            "filename": "packages/next/src/build/webpack-build/index.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/15a9619180beadb73cf22320c77d62718b1c51e4/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/15a9619180beadb73cf22320c77d62718b1c51e4/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Findex.ts?ref=15a9619180beadb73cf22320c77d62718b1c51e4",
            "patch": "@@ -11,6 +11,7 @@ import {\n   getParsedNodeOptionsWithoutInspect,\n } from '../../server/lib/utils'\n import { mergeUseCacheTrackers } from '../webpack/plugins/telemetry-plugin/use-cache-tracker-utils'\n+import { durationToString } from '../duration-to-string'\n \n const debug = origDebug('next:build:webpack-build')\n \n@@ -119,7 +120,8 @@ async function webpackBuildWithWorker(\n   }\n \n   if (compilerNames.length === 3) {\n-    Log.event('Compiled successfully')\n+    const durationString = durationToString(combinedResult.duration)\n+    Log.event(`Compiled successfully in ${durationString}`)\n   }\n \n   return combinedResult"
        }
    ],
    "stats": {
        "total": 40,
        "additions": 23,
        "deletions": 17
    }
}