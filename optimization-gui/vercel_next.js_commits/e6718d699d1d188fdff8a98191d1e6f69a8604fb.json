{
    "author": "EAzZY-1wnL",
    "message": "docs: fix TS error in Node.js runtime local assets example (#82672)\n\n## What?  \nUpdated the documentation for `opengraph-image` / `twitter-image` to fix\nthe **Node.js runtime with local assets** example.\n\n## Why?  \nThe existing snippet did not type-check cleanly with Next.js 15+ and\ncould confuse developers.\nThis update improves developer experience by ensuring the snippet is\nimmediately usable and accurate.\n\n## How?  \n- Reproduced the example in a fresh Next.js 15+ project.  \n- Updated the docs example to:  \n  - Use `readFile` + Base64 encoding instead of invalid file URLs.  \n  - Clarify that assets should be placed relative to the project root.  \n- Added an entry to **Version History** noting the update in v15.x.  \n\n## Checklist  \n- [x] Ran `pnpm prettier-fix`  \n- [x] Verified formatting & linting (`pnpm build && pnpm lint`)  \n- [x] Documentation guidelines followed  \n- [x] Example verified in a real Next.js 15 project  \n\nFixes #75583 & #75625 (if considered same class of issue)\n\n---------\n\nCo-authored-by: Joseph <sephxd1234@gmail.com>\nCo-authored-by: Joseph <joseph.chamochumbi@vercel.com>",
    "sha": "e6718d699d1d188fdff8a98191d1e6f69a8604fb",
    "files": [
        {
            "sha": "bbaad8eb43dc4cf3d7bdb9c8b4eecea5bca53dbd",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/01-metadata/opengraph-image.mdx",
            "status": "modified",
            "additions": 54,
            "deletions": 1,
            "changes": 55,
            "blob_url": "https://github.com/vercel/next.js/blob/e6718d699d1d188fdff8a98191d1e6f69a8604fb/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Fopengraph-image.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/e6718d699d1d188fdff8a98191d1e6f69a8604fb/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Fopengraph-image.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Fopengraph-image.mdx?ref=e6718d699d1d188fdff8a98191d1e6f69a8604fb",
            "patch": "@@ -402,7 +402,59 @@ export default async function Image({ params }) {\n \n #### Using Node.js runtime with local assets\n \n-This example uses the Node.js runtime to fetch a local image on the file system and passes it as an `ArrayBuffer` to the `src` attribute of an `<img>` element. The local asset should be placed relative to the root of your project, rather than the location of the example source file.\n+These examples use the Node.js runtime to fetch a local image from the file system and pass it to the `<img>` `src` attribute, either as a base64 string or an `ArrayBuffer`. Place the local asset relative to the project root, not the example source file.\n+\n+```tsx filename=\"app/opengraph-image.tsx\" switcher\n+import { ImageResponse } from 'next/og'\n+import { join } from 'node:path'\n+import { readFile } from 'node:fs/promises'\n+\n+export default async function Image() {\n+  const logoData = await readFile(join(process.cwd(), 'logo.png'), 'base64')\n+  const logoSrc = `data:image/png;base64,${logoData}`\n+\n+  return new ImageResponse(\n+    (\n+      <div\n+        style={{\n+          display: 'flex',\n+          alignItems: 'center',\n+          justifyContent: 'center',\n+        }}\n+      >\n+        <img src={logoSrc} height=\"100\" />\n+      </div>\n+    )\n+  )\n+}\n+```\n+\n+```jsx filename=\"app/opengraph-image.js\" switcher\n+import { ImageResponse } from 'next/og'\n+import { join } from 'node:path'\n+import { readFile } from 'node:fs/promises'\n+\n+export default async function Image() {\n+  const logoData = await readFile(join(process.cwd(), 'logo.png'), 'base64')\n+  const logoSrc = `data:image/png;base64,${logoData}`\n+\n+  return new ImageResponse(\n+    (\n+      <div\n+        style={{\n+          display: 'flex',\n+          alignItems: 'center',\n+          justifyContent: 'center',\n+        }}\n+      >\n+        <img src={logoSrc} height=\"100\" />\n+      </div>\n+    )\n+  )\n+}\n+```\n+\n+Passing an `ArrayBuffer` to the `src` attribute of an `<img>` element is not part of the HTML spec. The rendering engine used by `next/og` supports it, but because TypeScript definitions follow the spec, you need a `@ts-expect-error` directive or similar to use this [feature](https://github.com/vercel/satori/issues/606#issuecomment-2144000453).\n \n ```tsx filename=\"app/opengraph-image.tsx\" switcher\n import { ImageResponse } from 'next/og'\n@@ -422,6 +474,7 @@ export default async function Image() {\n           justifyContent: 'center',\n         }}\n       >\n+        {/* @ts-expect-error Satori accepts ArrayBuffer/typed arrays for <img src> at runtime */}\n         <img src={logoSrc} height=\"100\" />\n       </div>\n     )"
        }
    ],
    "stats": {
        "total": 55,
        "additions": 54,
        "deletions": 1
    }
}