{
    "author": "huozhi",
    "message": "[metadata] use https protocol for schema urls (#80356)",
    "sha": "2725973823b8b750e688cd6092dd77fdef57e71d",
    "files": [
        {
            "sha": "c30180b6a53882fc52e12e3945af42576e25f6a8",
            "filename": "packages/next/src/build/webpack/loaders/metadata/resolve-route-data.test.ts",
            "status": "modified",
            "additions": 62,
            "deletions": 62,
            "changes": 124,
            "blob_url": "https://github.com/vercel/next.js/blob/2725973823b8b750e688cd6092dd77fdef57e71d/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fmetadata%2Fresolve-route-data.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2725973823b8b750e688cd6092dd77fdef57e71d/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fmetadata%2Fresolve-route-data.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fmetadata%2Fresolve-route-data.test.ts?ref=2725973823b8b750e688cd6092dd77fdef57e71d",
            "patch": "@@ -87,16 +87,16 @@ describe('resolveRouteData', () => {\n           },\n         ])\n       ).toMatchInlineSnapshot(`\n-        \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-        <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n-        <url>\n-        <loc>https://example.com</loc>\n-        <lastmod>2021-01-01</lastmod>\n-        <changefreq>weekly</changefreq>\n-        <priority>0.5</priority>\n-        </url>\n-        </urlset>\n-        \"\n+       \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+       <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\">\n+       <url>\n+       <loc>https://example.com</loc>\n+       <lastmod>2021-01-01</lastmod>\n+       <changefreq>weekly</changefreq>\n+       <priority>0.5</priority>\n+       </url>\n+       </urlset>\n+       \"\n       `)\n     })\n     it('should resolve sitemap.xml with alternates', () => {\n@@ -114,16 +114,16 @@ describe('resolveRouteData', () => {\n           },\n         ])\n       ).toMatchInlineSnapshot(`\n-        \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-        <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\">\n-        <url>\n-        <loc>https://example.com</loc>\n-        <xhtml:link rel=\"alternate\" hreflang=\"es\" href=\"https://example.com/es\" />\n-        <xhtml:link rel=\"alternate\" hreflang=\"de\" href=\"https://example.com/de\" />\n-        <lastmod>2021-01-01</lastmod>\n-        </url>\n-        </urlset>\n-        \"\n+       \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+       <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:xhtml=\"https://www.w3.org/1999/xhtml\">\n+       <url>\n+       <loc>https://example.com</loc>\n+       <xhtml:link rel=\"alternate\" hreflang=\"es\" href=\"https://example.com/es\" />\n+       <xhtml:link rel=\"alternate\" hreflang=\"de\" href=\"https://example.com/de\" />\n+       <lastmod>2021-01-01</lastmod>\n+       </url>\n+       </urlset>\n+       \"\n       `)\n     })\n     it('should resolve sitemap.xml with images', () => {\n@@ -138,19 +138,19 @@ describe('resolveRouteData', () => {\n           },\n         ])\n       ).toMatchInlineSnapshot(`\n-        \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-        <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:image=\"http://www.google.com/schemas/sitemap-image/1.1\">\n-        <url>\n-        <loc>https://example.com</loc>\n-        <image:image>\n-        <image:loc>https://example.com/image.jpg</image:loc>\n-        </image:image>\n-        <lastmod>2021-01-01</lastmod>\n-        <changefreq>weekly</changefreq>\n-        <priority>0.5</priority>\n-        </url>\n-        </urlset>\n-        \"\n+       \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+       <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:image=\"https://www.google.com/schemas/sitemap-image/1.1\">\n+       <url>\n+       <loc>https://example.com</loc>\n+       <image:image>\n+       <image:loc>https://example.com/image.jpg</image:loc>\n+       </image:image>\n+       <lastmod>2021-01-01</lastmod>\n+       <changefreq>weekly</changefreq>\n+       <priority>0.5</priority>\n+       </url>\n+       </urlset>\n+       \"\n       `)\n     })\n     it('should resolve sitemap.xml with videos', () => {\n@@ -194,35 +194,35 @@ describe('resolveRouteData', () => {\n           },\n         ])\n       ).toMatchInlineSnapshot(`\n-        \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-        <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:video=\"http://www.google.com/schemas/sitemap-video/1.1\">\n-        <url>\n-        <loc>https://example.com</loc>\n-        <video:video>\n-        <video:title>example</video:title>\n-        <video:thumbnail_loc>https://example.com/image.jpg</video:thumbnail_loc>\n-        <video:description>this is the description</video:description>\n-        <video:content_loc>http://streamserver.example.com/video123.mp4</video:content_loc>\n-        <video:player_loc>https://www.example.com/videoplayer.php?video=123</video:player_loc>\n-        <video:duration>2</video:duration>\n-        <video:view_count>50</video:view_count>\n-        <video:tag>summer</video:tag>\n-        <video:rating>4</video:rating>\n-        <video:expiration_date>2025-09-16</video:expiration_date>\n-        <video:publication_date>2024-09-16</video:publication_date>\n-        <video:family_friendly>yes</video:family_friendly>\n-        <video:requires_subscription>no</video:requires_subscription>\n-        <video:live>no</video:live>\n-        <video:restriction relationship=\"allow\">IE GB US CA</video:restriction>\n-        <video:platform relationship=\"allow\">web</video:platform>\n-        <video:uploader info=\"https://www.example.com/users/grillymcgrillerson\">GrillyMcGrillerson</video:uploader>\n-        </video:video>\n-        <lastmod>2021-01-01</lastmod>\n-        <changefreq>weekly</changefreq>\n-        <priority>0.5</priority>\n-        </url>\n-        </urlset>\n-        \"\n+       \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+       <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:video=\"https://www.google.com/schemas/sitemap-video/1.1\">\n+       <url>\n+       <loc>https://example.com</loc>\n+       <video:video>\n+       <video:title>example</video:title>\n+       <video:thumbnail_loc>https://example.com/image.jpg</video:thumbnail_loc>\n+       <video:description>this is the description</video:description>\n+       <video:content_loc>http://streamserver.example.com/video123.mp4</video:content_loc>\n+       <video:player_loc>https://www.example.com/videoplayer.php?video=123</video:player_loc>\n+       <video:duration>2</video:duration>\n+       <video:view_count>50</video:view_count>\n+       <video:tag>summer</video:tag>\n+       <video:rating>4</video:rating>\n+       <video:expiration_date>2025-09-16</video:expiration_date>\n+       <video:publication_date>2024-09-16</video:publication_date>\n+       <video:family_friendly>yes</video:family_friendly>\n+       <video:requires_subscription>no</video:requires_subscription>\n+       <video:live>no</video:live>\n+       <video:restriction relationship=\"allow\">IE GB US CA</video:restriction>\n+       <video:platform relationship=\"allow\">web</video:platform>\n+       <video:uploader info=\"https://www.example.com/users/grillymcgrillerson\">GrillyMcGrillerson</video:uploader>\n+       </video:video>\n+       <lastmod>2021-01-01</lastmod>\n+       <changefreq>weekly</changefreq>\n+       <priority>0.5</priority>\n+       </url>\n+       </urlset>\n+       \"\n       `)\n     })\n   })"
        },
        {
            "sha": "ceffad78d1007dcd4c995ce6008337e589db3739",
            "filename": "packages/next/src/build/webpack/loaders/metadata/resolve-route-data.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2725973823b8b750e688cd6092dd77fdef57e71d/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fmetadata%2Fresolve-route-data.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2725973823b8b750e688cd6092dd77fdef57e71d/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fmetadata%2Fresolve-route-data.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fmetadata%2Fresolve-route-data.ts?ref=2725973823b8b750e688cd6092dd77fdef57e71d",
            "patch": "@@ -52,15 +52,15 @@ export function resolveSitemap(data: MetadataRoute.Sitemap): string {\n \n   let content = ''\n   content += '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n'\n-  content += '<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"'\n+  content += '<urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\"'\n   if (hasImages) {\n-    content += ' xmlns:image=\"http://www.google.com/schemas/sitemap-image/1.1\"'\n+    content += ' xmlns:image=\"https://www.google.com/schemas/sitemap-image/1.1\"'\n   }\n   if (hasVideos) {\n-    content += ' xmlns:video=\"http://www.google.com/schemas/sitemap-video/1.1\"'\n+    content += ' xmlns:video=\"https://www.google.com/schemas/sitemap-video/1.1\"'\n   }\n   if (hasAlternates) {\n-    content += ' xmlns:xhtml=\"http://www.w3.org/1999/xhtml\">\\n'\n+    content += ' xmlns:xhtml=\"https://www.w3.org/1999/xhtml\">\\n'\n   } else {\n     content += '>\\n'\n   }"
        },
        {
            "sha": "f4f3e4a78ee919a4d00fdd3b2465a447a4c21d4c",
            "filename": "test/e2e/app-dir/metadata-dynamic-routes/index.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fmetadata-dynamic-routes%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fmetadata-dynamic-routes%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fmetadata-dynamic-routes%2Findex.test.ts?ref=2725973823b8b750e688cd6092dd77fdef57e71d",
            "patch": "@@ -52,7 +52,7 @@ describe('app dir - metadata dynamic routes', () => {\n \n       expect(text).toMatchInlineSnapshot(`\n       \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-      <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n+      <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\">\n       <url>\n       <loc>https://example.com</loc>\n       <lastmod>2021-01-01</lastmod>\n@@ -95,7 +95,7 @@ describe('app dir - metadata dynamic routes', () => {\n     it('should support alternate.languages in sitemap', async () => {\n       const xml = await (await next.fetch('/lang/sitemap.xml')).text()\n \n-      expect(xml).toContain('xmlns:xhtml=\"http://www.w3.org/1999/xhtml')\n+      expect(xml).toContain('xmlns:xhtml=\"https://www.w3.org/1999/xhtml')\n       expect(xml).toContain(\n         `<xhtml:link rel=\"alternate\" hreflang=\"es\" href=\"https://example.com/es/about\" />`\n       )\n@@ -119,7 +119,7 @@ describe('app dir - metadata dynamic routes', () => {\n       const xml = await (await next.fetch('/sitemap-video/sitemap.xml')).text()\n       expect(xml).toMatchInlineSnapshot(`\n         \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-        <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:video=\"http://www.google.com/schemas/sitemap-video/1.1\">\n+        <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:video=\"https://www.google.com/schemas/sitemap-video/1.1\">\n         <url>\n         <loc>https://example.com/about</loc>\n         <video:video>"
        },
        {
            "sha": "ba4d76d99cc8e40eb758cb6b57f99b76f60bb4ce",
            "filename": "test/e2e/app-dir/middleware-sitemap/matcher-exclude-sitemap/app/sitemap.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fmiddleware-sitemap%2Fmatcher-exclude-sitemap%2Fapp%2Fsitemap.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fmiddleware-sitemap%2Fmatcher-exclude-sitemap%2Fapp%2Fsitemap.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fmiddleware-sitemap%2Fmatcher-exclude-sitemap%2Fapp%2Fsitemap.ts?ref=2725973823b8b750e688cd6092dd77fdef57e71d",
            "patch": "@@ -4,7 +4,7 @@ export default function sitemap(): MetadataRoute.Sitemap {\n   return [\n     {\n       url: 'https://vercel.com',\n-      lastModified: new Date(),\n+      lastModified: '2023-10-01',\n       changeFrequency: 'yearly',\n       priority: 1,\n     },"
        },
        {
            "sha": "0073def60c1260e8acd752b8ae3757c354284955",
            "filename": "test/e2e/app-dir/middleware-sitemap/matcher-exclude-sitemap/index.test.ts",
            "status": "modified",
            "additions": 13,
            "deletions": 6,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fmiddleware-sitemap%2Fmatcher-exclude-sitemap%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fmiddleware-sitemap%2Fmatcher-exclude-sitemap%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fmiddleware-sitemap%2Fmatcher-exclude-sitemap%2Findex.test.ts?ref=2725973823b8b750e688cd6092dd77fdef57e71d",
            "patch": "@@ -9,11 +9,18 @@ describe('middleware-sitemap', () => {\n     let html = await next.render('/')\n     expect(html).toContain('redirected')\n \n-    html = await next.render('/sitemap.xml')\n-    expect(html).not.toContain('redirected')\n-    expect(html).toContain('<?xml version=\"1.0\" encoding=\"UTF-8\"?>')\n-    expect(html).toContain(\n-      '<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">'\n-    )\n+    const xml = await next.render('/sitemap.xml')\n+    expect(xml).toMatchInlineSnapshot(`\n+     \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+     <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\">\n+     <url>\n+     <loc>https://vercel.com</loc>\n+     <lastmod>2023-10-01</lastmod>\n+     <changefreq>yearly</changefreq>\n+     <priority>1</priority>\n+     </url>\n+     </urlset>\n+     \"\n+    `)\n   })\n })"
        },
        {
            "sha": "2389da3724ed672d3059dc7fd931ed51d06c25ee",
            "filename": "test/e2e/app-dir/sitemap-group/sitemap-group.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fsitemap-group%2Fsitemap-group.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fsitemap-group%2Fsitemap-group.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsitemap-group%2Fsitemap-group.test.ts?ref=2725973823b8b750e688cd6092dd77fdef57e71d",
            "patch": "@@ -12,7 +12,7 @@ describe('sitemap-group', () => {\n     const text = await res.text()\n     expect(text).toMatchInlineSnapshot(`\n       \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-      <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n+      <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\">\n       <url>\n       <loc>https://www.vercel.com</loc>\n       <lastmod>2024-12-05T23:45:13.405Z</lastmod>"
        },
        {
            "sha": "849d68fe2754cb1b243022dd594ab6901428c12f",
            "filename": "test/e2e/app-dir/use-cache-metadata-route-handler/use-cache-metadata-route-handler.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fuse-cache-metadata-route-handler%2Fuse-cache-metadata-route-handler.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2725973823b8b750e688cd6092dd77fdef57e71d/test%2Fe2e%2Fapp-dir%2Fuse-cache-metadata-route-handler%2Fuse-cache-metadata-route-handler.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-metadata-route-handler%2Fuse-cache-metadata-route-handler.test.ts?ref=2725973823b8b750e688cd6092dd77fdef57e71d",
            "patch": "@@ -44,7 +44,7 @@ describe('use-cache-metadata-route-handler', () => {\n     if (isNextDev) {\n       expect(body).toMatchInlineSnapshot(`\n        \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-       <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n+       <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\">\n        <url>\n        <loc>https://acme.com?sentinel=runtime</loc>\n        </url>\n@@ -54,7 +54,7 @@ describe('use-cache-metadata-route-handler', () => {\n     } else {\n       expect(body).toMatchInlineSnapshot(`\n        \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-       <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n+       <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\">\n        <url>\n        <loc>https://acme.com?sentinel=buildtime</loc>\n        </url>\n@@ -74,7 +74,7 @@ describe('use-cache-metadata-route-handler', () => {\n     if (isNextDev) {\n       expect(body).toMatchInlineSnapshot(`\n        \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-       <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n+       <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\">\n        <url>\n        <loc>https://acme.com/1?sentinel=runtime</loc>\n        </url>\n@@ -84,7 +84,7 @@ describe('use-cache-metadata-route-handler', () => {\n     } else {\n       expect(body).toMatchInlineSnapshot(`\n        \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-       <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n+       <urlset xmlns=\"https://www.sitemaps.org/schemas/sitemap/0.9\">\n        <url>\n        <loc>https://acme.com/1?sentinel=buildtime</loc>\n        </url>"
        }
    ],
    "stats": {
        "total": 169,
        "additions": 88,
        "deletions": 81
    }
}