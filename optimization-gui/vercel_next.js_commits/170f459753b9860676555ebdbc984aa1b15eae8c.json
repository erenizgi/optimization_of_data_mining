{
    "author": "huozhi",
    "message": "[metadata] clean up redudant options (#76712)\n\n### What\n\nstreaming meatdata is fully enabled now, we don't need to pass down an extra flag through render options",
    "sha": "170f459753b9860676555ebdbc984aa1b15eae8c",
    "files": [
        {
            "sha": "15e6641f6b2013b1e25a31919a63f16959ab0601",
            "filename": "packages/next/src/export/index.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fexport%2Findex.ts?ref=170f459753b9860676555ebdbc984aa1b15eae8c",
            "patch": "@@ -387,7 +387,6 @@ async function exportAppImpl(\n     strictNextHead: nextConfig.experimental.strictNextHead ?? true,\n     deploymentId: nextConfig.deploymentId,\n     htmlLimitedBots: nextConfig.htmlLimitedBots.source,\n-    streamingMetadata: true,\n     experimental: {\n       clientTraceMetadata: nextConfig.experimental.clientTraceMetadata,\n       expireTime: nextConfig.expireTime,"
        },
        {
            "sha": "a69a5ad0a5e7ffd474b5f46e64fb78de48016629",
            "filename": "packages/next/src/export/types.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fexport%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fexport%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fexport%2Ftypes.ts?ref=170f459753b9860676555ebdbc984aa1b15eae8c",
            "patch": "@@ -62,7 +62,6 @@ export interface ExportPageInput {\n   nextConfigOutput?: NextConfigComplete['output']\n   enableExperimentalReact?: boolean\n   sriEnabled: boolean\n-  streamingMetadata: boolean | undefined\n }\n \n export type ExportRouteResult ="
        },
        {
            "sha": "ebf6ce6fc87f9fcd2724f58a14e77e44b110c058",
            "filename": "packages/next/src/export/worker.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fexport%2Fworker.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fexport%2Fworker.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fexport%2Fworker.ts?ref=170f459753b9860676555ebdbc984aa1b15eae8c",
            "patch": "@@ -256,9 +256,7 @@ async function exportPageImpl(\n   // During the export phase in next build, if it's using PPR we can serve streaming metadata\n   // when it's available. When we're building the PPR rendering result, we don't need to rely\n   // on the user agent. The result can be determined to serve streaming on infrastructure level.\n-  const serveStreamingMetadata = Boolean(\n-    isRoutePPREnabled && input.streamingMetadata\n-  )\n+  const serveStreamingMetadata = !!isRoutePPREnabled\n \n   const renderOpts: WorkerRenderOpts = {\n     ...components,\n@@ -425,7 +423,6 @@ export async function exportPages(\n             enableExperimentalReact: needsExperimentalReact(nextConfig),\n             sriEnabled: Boolean(nextConfig.experimental.sri?.algorithm),\n             buildId: input.buildId,\n-            streamingMetadata: true,\n           }),\n           // If exporting the page takes longer than the timeout, reject the promise.\n           new Promise((_, reject) => {"
        },
        {
            "sha": "a0eedc928558e1ff5a0f710b1efbec7a571c6579",
            "filename": "packages/next/src/server/app-render/types.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts?ref=170f459753b9860676555ebdbc984aa1b15eae8c",
            "patch": "@@ -204,7 +204,6 @@ export interface RenderOptsPartial {\n   params?: ParsedUrlQuery\n   isPrefetch?: boolean\n   htmlLimitedBots: string | undefined\n-  streamingMetadata: boolean\n   experimental: {\n     /**\n      * When true, it indicates that the current page supports partial"
        },
        {
            "sha": "eeda65e57555591d8e363b98a3798ac1d4232d97",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=170f459753b9860676555ebdbc984aa1b15eae8c",
            "patch": "@@ -600,7 +600,6 @@ export default abstract class Server<\n       isExperimentalCompile: this.nextConfig.experimental.isExperimentalCompile,\n       // `htmlLimitedBots` is passed to server as serialized config in string format\n       htmlLimitedBots: this.nextConfig.htmlLimitedBots,\n-      streamingMetadata: true,\n       experimental: {\n         expireTime: this.nextConfig.expireTime,\n         clientTraceMetadata: this.nextConfig.experimental.clientTraceMetadata,\n@@ -1761,10 +1760,10 @@ export default abstract class Server<\n         ...this.renderOpts,\n         supportsDynamicResponse: !isBotRequest,\n         botType: getBotType(ua),\n-        serveStreamingMetadata: shouldServeStreamingMetadata(ua, {\n-          streamingMetadata: !!this.renderOpts.streamingMetadata,\n-          htmlLimitedBots: this.nextConfig.htmlLimitedBots,\n-        }),\n+        serveStreamingMetadata: shouldServeStreamingMetadata(\n+          ua,\n+          this.nextConfig.htmlLimitedBots\n+        ),\n       },\n     }\n "
        },
        {
            "sha": "09fed6642f2e4c6c978f26996d1372cc115586af",
            "filename": "packages/next/src/server/lib/streaming-metadata.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 11,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fstreaming-metadata.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/170f459753b9860676555ebdbc984aa1b15eae8c/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fstreaming-metadata.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fstreaming-metadata.ts?ref=170f459753b9860676555ebdbc984aa1b15eae8c",
            "patch": "@@ -6,18 +6,8 @@ import type { BaseNextRequest } from '../base-http'\n \n export function shouldServeStreamingMetadata(\n   userAgent: string,\n-  {\n-    streamingMetadata,\n-    htmlLimitedBots,\n-  }: {\n-    streamingMetadata: boolean\n-    htmlLimitedBots: string | undefined\n-  }\n+  htmlLimitedBots: string | undefined\n ): boolean {\n-  if (!streamingMetadata) {\n-    return false\n-  }\n-\n   const blockingMetadataUARegex = new RegExp(\n     htmlLimitedBots || HTML_LIMITED_BOT_UA_RE_STRING,\n     'i'"
        }
    ],
    "stats": {
        "total": 29,
        "additions": 6,
        "deletions": 23
    }
}