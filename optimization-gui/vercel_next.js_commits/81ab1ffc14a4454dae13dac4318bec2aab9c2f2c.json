{
    "author": "eps1lon",
    "message": "[dev-overlay] Inject `isRecoverableError` implementation (#80003)\n\nSame as with `get*Stack` implementation",
    "sha": "81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
    "files": [
        {
            "sha": "f8d2de191e1f6f64494ac9f3d7d92e1c4a26881f",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/hot-reloader-client.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fhot-reloader-client.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fhot-reloader-client.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fhot-reloader-client.tsx?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -45,6 +45,7 @@ import reportHmrLatency from '../utils/report-hmr-latency'\n import { TurbopackHmr } from '../utils/turbopack-hot-reloader-common'\n import { NEXT_HMR_REFRESH_HASH_COOKIE } from '../../app-router-headers'\n import { getComponentStack, getOwnerStack } from '../../errors/stitched-error'\n+import { isRecoverableError } from '../../../react-client-callbacks/on-recoverable-error'\n \n export interface Dispatcher {\n   onBuildOk(): void\n@@ -483,7 +484,8 @@ export default function HotReload({\n   const [state, dispatch] = useErrorOverlayReducer(\n     'app',\n     getComponentStack,\n-    getOwnerStack\n+    getOwnerStack,\n+    isRecoverableError\n   )\n \n   const dispatcher = useMemo<Dispatcher>(() => {"
        },
        {
            "sha": "d222fea6b60939357359287d2c6a5727cc0c8afd",
            "filename": "packages/next/src/client/components/react-dev-overlay/pages/hooks.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fhooks.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fhooks.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fpages%2Fhooks.ts?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -3,12 +3,14 @@ import * as Bus from './bus'\n import { useErrorOverlayReducer } from '../shared'\n import { Router } from '../../../router'\n import { getComponentStack, getOwnerStack } from '../../errors/stitched-error'\n+import { isRecoverableError } from '../../../react-client-callbacks/on-recoverable-error'\n \n export const usePagesDevOverlay = () => {\n   const [state, dispatch] = useErrorOverlayReducer(\n     'pages',\n     getComponentStack,\n-    getOwnerStack\n+    getOwnerStack,\n+    isRecoverableError\n   )\n \n   React.useEffect(() => {"
        },
        {
            "sha": "f03ca92ffe067336c9b26c4ced5abd4f2dc45ee9",
            "filename": "packages/next/src/client/components/react-dev-overlay/shared.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fshared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fshared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fshared.ts?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -7,6 +7,7 @@ import type { DebugInfo } from './types'\n import type { DevIndicatorServerState } from '../../../server/dev/dev-indicator-server-state'\n import type { HMR_ACTION_TYPES } from '../../../server/dev/hot-reloader-types'\n import { parseStack } from './utils/parse-stack'\n+import { isConsoleError } from '../errors/console-error'\n \n type FastRefreshState =\n   /** No refresh in progress. */\n@@ -169,7 +170,8 @@ function getInitialState(\n export function useErrorOverlayReducer(\n   routerType: 'pages' | 'app',\n   getComponentStack: (error: Error) => string | undefined,\n-  getOwnerStack: (error: Error) => string | null | undefined\n+  getOwnerStack: (error: Error) => string | null | undefined,\n+  isRecoverableError: (error: Error) => boolean\n ) {\n   function pushErrorFilterDuplicates(\n     events: SupportedErrorEvent[],\n@@ -188,6 +190,11 @@ export function useErrorOverlayReducer(\n       error,\n       frames,\n       componentStackFrames,\n+      type: isRecoverableError(error)\n+        ? 'recoverable'\n+        : isConsoleError(error)\n+          ? 'console'\n+          : 'runtime',\n     }\n     const pendingEvents = events.filter((event) => {\n       // Filter out duplicate errors"
        },
        {
            "sha": "8f5db5b4edcc4cb308f8ec8c9237b76fc1cfbbe5",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay-nav/error-overlay-nav.stories.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.stories.tsx?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -21,18 +21,21 @@ export const Default: Story = {\n         runtime: true,\n         error: new Error('First error message'),\n         frames: () => Promise.resolve([]),\n+        type: 'runtime',\n       },\n       {\n         id: 1,\n         runtime: true,\n         error: new Error('Second error message'),\n         frames: () => Promise.resolve([]),\n+        type: 'runtime',\n       },\n       {\n         id: 2,\n         runtime: true,\n         error: new Error('Third error message'),\n         frames: () => Promise.resolve([]),\n+        type: 'runtime',\n       },\n     ],\n     activeIdx: 1,"
        },
        {
            "sha": "423e0ee2e62a9d9e4d4674ea739dacd41427154e",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay-pagination/error-overlay-pagination.stories.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-pagination%2Ferror-overlay-pagination.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-pagination%2Ferror-overlay-pagination.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-pagination%2Ferror-overlay-pagination.stories.tsx?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -2,6 +2,7 @@ import type { Meta, StoryObj } from '@storybook/react'\n import { ErrorOverlayPagination } from './error-overlay-pagination'\n import { withShadowPortal } from '../../../storybook/with-shadow-portal'\n import { useState } from 'react'\n+import type { ReadyRuntimeError } from '../../../../utils/get-error-by-type'\n \n const meta: Meta<typeof ErrorOverlayPagination> = {\n   component: ErrorOverlayPagination,\n@@ -15,24 +16,27 @@ export default meta\n type Story = StoryObj<typeof ErrorOverlayPagination>\n \n // Mock errors for stories\n-const mockErrors = [\n+const mockErrors: ReadyRuntimeError[] = [\n   {\n     id: 1,\n     runtime: true as const,\n     error: new Error('First error'),\n     frames: () => Promise.resolve([]),\n+    type: 'runtime',\n   },\n   {\n     id: 2,\n     runtime: true as const,\n     error: new Error('Second error'),\n     frames: () => Promise.resolve([]),\n+    type: 'runtime',\n   },\n   {\n     id: 3,\n     runtime: true as const,\n     error: new Error('Third error'),\n     frames: () => Promise.resolve([]),\n+    type: 'runtime',\n   },\n ]\n "
        },
        {
            "sha": "0d7301874e06019f19758c770dd2840f90351d70",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/container/errors.stories.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.stories.tsx?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -96,6 +96,7 @@ const runtimeErrors: ReadyRuntimeError[] = [\n         },\n         ...Array(20).fill(ignoredFrame),\n       ]),\n+    type: 'runtime',\n   },\n   {\n     id: 2,\n@@ -113,6 +114,7 @@ const runtimeErrors: ReadyRuntimeError[] = [\n           originalCodeFrame: originalCodeFrame('Second error message'),\n         },\n       ]),\n+    type: 'runtime',\n   },\n   {\n     id: 3,\n@@ -130,6 +132,7 @@ const runtimeErrors: ReadyRuntimeError[] = [\n           originalCodeFrame: originalCodeFrame('Third error message'),\n         },\n       ]),\n+    type: 'runtime',\n   },\n   {\n     id: 4,\n@@ -147,6 +150,7 @@ const runtimeErrors: ReadyRuntimeError[] = [\n           originalCodeFrame: originalCodeFrame('typeof window !== undefined'),\n         },\n       ]),\n+    type: 'runtime',\n   },\n ]\n \n@@ -232,6 +236,7 @@ export const WithHydrationWarning: Story = {\n               },\n             },\n           ]),\n+        type: 'runtime',\n       },\n     ],\n     debugInfo: { devtoolsFrontendUrl: undefined },"
        },
        {
            "sha": "3b8257e9b39db265a4c772fbf45ebaa876483cb5",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/container/errors.tsx",
            "status": "modified",
            "additions": 7,
            "deletions": 6,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.tsx?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -5,7 +5,6 @@ import { RuntimeError } from './runtime-error'\n import { getErrorSource } from '../../../../../shared/lib/error-source'\n import { HotlinkedText } from '../components/hot-linked-text'\n import { PseudoHtmlDiff } from './runtime-error/component-stack-pseudo-html'\n-import { isConsoleError } from '../../../errors/console-error'\n import { extractNextErrorCode } from '../../../../../lib/error-telemetry-utils'\n import {\n   ErrorOverlayLayout,\n@@ -19,7 +18,6 @@ import {\n import type { ReadyRuntimeError } from '../../utils/get-error-by-type'\n import type { ErrorBaseProps } from '../components/errors/error-overlay/error-overlay'\n import { getSquashedHydrationErrorDetails } from '../../pages/hydration-error-state'\n-import { isRecoverableError } from '../../../../react-client-callbacks/on-recoverable-error'\n \n export interface ErrorsProps extends ErrorBaseProps {\n   runtimeErrors: ReadyRuntimeError[]\n@@ -56,11 +54,14 @@ function GenericErrorDescription({ error }: { error: Error }) {\n   )\n }\n \n-function getErrorType(error: Error): ErrorOverlayLayoutProps['errorType'] {\n-  if (isRecoverableError(error)) {\n+function getErrorTypeLabel(\n+  error: Error,\n+  type: ReadyRuntimeError['type']\n+): ErrorOverlayLayoutProps['errorType'] {\n+  if (type === 'recoverable') {\n     return `Recoverable ${error.name}`\n   }\n-  if (isConsoleError(error)) {\n+  if (type === 'console') {\n     return `Console ${error.name}`\n   }\n   return `Runtime ${error.name}`\n@@ -141,7 +142,7 @@ export function Errors({\n   const isServerError = ['server', 'edge-server'].includes(\n     getErrorSource(error) || ''\n   )\n-  const errorType = getErrorType(error)\n+  const errorType = getErrorTypeLabel(error, activeError.type)\n   // TOOD: May be better to always treat everything past the first blank line as notes\n   // We're currently only special casing hydration error messages.\n   const notes = errorDetails.notes"
        },
        {
            "sha": "0531b66e4c4d90b6fa938eff49b50c6a4940c12f",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/container/runtime-error/render-error.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Fruntime-error%2Frender-error.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Fruntime-error%2Frender-error.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Fruntime-error%2Frender-error.tsx?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -13,6 +13,7 @@ export type SupportedErrorEvent = {\n   error: Error\n   frames: StackFrame[]\n   componentStackFrames?: ComponentStackFrame[]\n+  type: 'runtime' | 'recoverable' | 'console'\n }\n \n type Props = {"
        },
        {
            "sha": "b3dababe5a5144c6597dd0138c54d097c0a9ad14",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/dev-overlay.stories.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fdev-overlay.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fdev-overlay.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fdev-overlay.stories.tsx?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -52,20 +52,23 @@ const initialState: OverlayState = {\n           column: 5,\n         },\n       ],\n+      type: 'runtime',\n     },\n     {\n       id: 2,\n       error: Object.assign(new Error('Second error message'), {\n         __NEXT_ERROR_CODE: 'E002',\n       }),\n       frames: [],\n+      type: 'runtime',\n     },\n     {\n       id: 3,\n       error: Object.assign(new Error('Third error message'), {\n         __NEXT_ERROR_CODE: 'E003',\n       }),\n       frames: [],\n+      type: 'runtime',\n     },\n   ],\n   refreshState: { type: 'idle' },"
        },
        {
            "sha": "5ad9b345338bf526e43e4d7de55090b64e92309e",
            "filename": "packages/next/src/client/components/react-dev-overlay/utils/get-error-by-type.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Futils%2Fget-error-by-type.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/81ab1ffc14a4454dae13dac4318bec2aab9c2f2c/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Futils%2Fget-error-by-type.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Futils%2Fget-error-by-type.ts?ref=81ab1ffc14a4454dae13dac4318bec2aab9c2f2c",
            "patch": "@@ -11,6 +11,7 @@ export type ReadyRuntimeError = {\n   error: Error & { environmentName?: string }\n   frames: OriginalStackFrame[] | (() => Promise<OriginalStackFrame[]>)\n   componentStackFrames?: ComponentStackFrame[]\n+  type: 'runtime' | 'console' | 'recoverable'\n }\n \n export const useFrames = (error: ReadyRuntimeError): OriginalStackFrame[] => {\n@@ -43,6 +44,7 @@ export async function getErrorByType(\n     id: event.id,\n     runtime: true,\n     error: event.error,\n+    type: event.type,\n   } as const\n \n   if ('use' in React) {"
        }
    ],
    "stats": {
        "total": 50,
        "additions": 40,
        "deletions": 10
    }
}