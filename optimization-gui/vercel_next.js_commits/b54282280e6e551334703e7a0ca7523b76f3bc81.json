{
    "author": "mischnic",
    "message": "Turbopack: fix scope hoisting variable renaming bug (#81640)",
    "sha": "b54282280e6e551334703e7a0ca7523b76f3bc81",
    "files": [
        {
            "sha": "33f6c48a2d95a3e7de9eafbb5395505c5570b023",
            "filename": "turbopack/crates/turbopack-ecmascript/src/lib.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs?ref=b54282280e6e551334703e7a0ca7523b76f3bc81",
            "patch": "@@ -2062,7 +2062,7 @@ fn hygiene_rename_only(\n     }\n     // Copied from `hygiene_with_config`'s HygieneRenamer, but added an `preserved_exports`\n     impl swc_core::ecma::transforms::base::rename::Renamer for HygieneRenamer<'_> {\n-        type Target = Atom;\n+        type Target = Id;\n \n         const MANGLE: bool = false;\n         const RESET_N: bool = true;\n@@ -2081,7 +2081,7 @@ fn hygiene_rename_only(\n             self.preserved_exports.contains(orig) || orig.1.has_mark(self.is_import_mark)\n         }\n     }\n-    swc_core::ecma::transforms::base::rename::renamer(\n+    swc_core::ecma::transforms::base::rename::renamer_keep_contexts(\n         swc_core::ecma::transforms::base::hygiene::Config {\n             top_level_mark: top_level_mark.unwrap_or_default(),\n             ..Default::default()"
        },
        {
            "sha": "d7c47eeef4c3e70e36e12a7381ecbb70a229b97a",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/scope-hoisting/renaming-2/input/index.js",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Findex.js?ref=b54282280e6e551334703e7a0ca7523b76f3bc81",
            "patch": "@@ -0,0 +1,5 @@\n+import { foo } from './internal/index.js'\n+\n+it('should correctly rename imports', () => {\n+  expect(foo({})).toBe(true)\n+})"
        },
        {
            "sha": "abe4f1ea37d90c80f7ec01314dec182c487eab46",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/scope-hoisting/renaming-2/input/internal/index.js",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Finternal%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Finternal%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Finternal%2Findex.js?ref=b54282280e6e551334703e7a0ca7523b76f3bc81",
            "patch": "@@ -0,0 +1,5 @@\n+import './patch-other.js'\n+import { patch as patch2 } from './patch.js'\n+\n+export const bar = (patch) => patch + 1\n+export const foo = (patch) => patch !== patch2"
        },
        {
            "sha": "b2c5e06e70e8a96036d84f51ade92d65b9658299",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/scope-hoisting/renaming-2/input/internal/patch-other.js",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Finternal%2Fpatch-other.js",
            "raw_url": "https://github.com/vercel/next.js/raw/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Finternal%2Fpatch-other.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Finternal%2Fpatch-other.js?ref=b54282280e6e551334703e7a0ca7523b76f3bc81",
            "patch": "@@ -0,0 +1,3 @@\n+export function patch() {\n+  return 2\n+}"
        },
        {
            "sha": "a30e800b7f5ce49104c96c7137284b81d4bfb2ac",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/scope-hoisting/renaming-2/input/internal/patch.js",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Finternal%2Fpatch.js",
            "raw_url": "https://github.com/vercel/next.js/raw/b54282280e6e551334703e7a0ca7523b76f3bc81/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Finternal%2Fpatch.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fscope-hoisting%2Frenaming-2%2Finput%2Finternal%2Fpatch.js?ref=b54282280e6e551334703e7a0ca7523b76f3bc81",
            "patch": "@@ -0,0 +1,3 @@\n+export function patch() {\n+  return 1\n+}"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 18,
        "deletions": 2
    }
}