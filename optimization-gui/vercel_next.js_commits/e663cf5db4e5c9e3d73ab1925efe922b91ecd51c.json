{
    "author": "unstubbable",
    "message": "Add test cases without `generateStaticParams` to `fallback-shells` suite (#80462)\n\nCopy&pasting some of the existing test cases for\n`with-cached-io/with-static-params/with-suspense` to\n`with-cached-io/without-static-params`. We expect the same results.\n\nWe do not copy `with-cached-io/with-static-params/without-suspense`.\nThose cases are expected to yield build errors, because when there are\nno static params defined, we don't allow an empty shell.",
    "sha": "e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
    "files": [
        {
            "sha": "d259729ba75d376455f81b83c6a871dd1ed6861f",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/layout.jsx",
            "status": "renamed",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Flayout.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Flayout.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Flayout.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -9,6 +9,7 @@ export default async function Layout({ children }) {\n         <div id=\"root-layout\">\n           Root Layout: {new Date().toISOString()} ({getSentinelValue()})\n         </div>\n+        <p>This page does define some static params.</p>\n         {children}\n       </body>\n     </html>",
            "previous_filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/without-suspense/layout.jsx"
        },
        {
            "sha": "2a992da56d5fbe477304baa035eea6e138708d68",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/with-suspense/layout.jsx",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Flayout.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Flayout.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Flayout.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -0,0 +1,5 @@\n+import { Suspense } from 'react'\n+\n+export default function Layout({ children }) {\n+  return <Suspense fallback={<p>Loading...</p>}>{children}</Suspense>\n+}"
        },
        {
            "sha": "f06c9eae38ef2778073391dc35d7f3b2c56b451b",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/with-suspense/params-in-page/[slug]/layout.tsx",
            "status": "added",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-in-page%2F%5Bslug%5D%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-in-page%2F%5Bslug%5D%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-in-page%2F%5Bslug%5D%2Flayout.tsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -0,0 +1,19 @@\n+'use cache'\n+\n+import { getSentinelValue } from '../../../../sentinel'\n+\n+export default async function Layout({\n+  children,\n+}: {\n+  children: React.ReactNode\n+}) {\n+  return (\n+    <div>\n+      <p>This layout is explicitly not reading params.</p>\n+      <div id=\"layout\">\n+        Layout: {new Date().toISOString()} ({getSentinelValue()})\n+      </div>\n+      <div>{children}</div>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "0e4fdc15010bf33016ab0cc83bdbb9899b84ffa1",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/with-suspense/params-in-page/[slug]/page.jsx",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-in-page%2F%5Bslug%5D%2Fpage.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -1,6 +1,6 @@\n 'use cache'\n \n-import { LastModified } from '../../../last-modified'\n+import { LastModified } from '../../../../last-modified'\n \n export default async function Page({ params }) {\n   return <LastModified params={params} />",
            "previous_filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/without-suspense/params-in-page/[slug]/page.jsx"
        },
        {
            "sha": "370cce833dc996af1c99e0ae458a77f8fc34ffe4",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/with-suspense/params-not-in-page/[slug]/page.jsx",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-not-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-not-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-not-in-page%2F%5Bslug%5D%2Fpage.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -1,4 +1,4 @@\n-import { CachedLastModified } from '../../../last-modified'\n+import { CachedLastModified } from '../../../../last-modified'\n \n export default async function Page({ params }) {\n   return <CachedLastModified params={params} />",
            "previous_filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-suspense/params-not-in-page/[slug]/page.jsx"
        },
        {
            "sha": "909fca03deaf75420d5327de7b921f84cbc9f1a9",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/with-suspense/params-then-in-page/[slug]/page.jsx",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-then-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-then-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwith-suspense%2Fparams-then-in-page%2F%5Bslug%5D%2Fpage.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -1,4 +1,4 @@\n-import { CachedLastModified } from '../../../last-modified'\n+import { CachedLastModified } from '../../../../last-modified'\n \n export default async function Page({ params }) {\n   return (",
            "previous_filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/without-suspense/params-then-in-page/[slug]/page.jsx"
        },
        {
            "sha": "0e4fdc15010bf33016ab0cc83bdbb9899b84ffa1",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/without-suspense/params-in-page/[slug]/page.jsx",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-in-page%2F%5Bslug%5D%2Fpage.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -1,6 +1,6 @@\n 'use cache'\n \n-import { LastModified } from '../../../last-modified'\n+import { LastModified } from '../../../../last-modified'\n \n export default async function Page({ params }) {\n   return <LastModified params={params} />",
            "previous_filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-suspense/params-in-page/[slug]/page.jsx"
        },
        {
            "sha": "370cce833dc996af1c99e0ae458a77f8fc34ffe4",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/without-suspense/params-not-in-page/[slug]/page.jsx",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-not-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-not-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-not-in-page%2F%5Bslug%5D%2Fpage.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -1,4 +1,4 @@\n-import { CachedLastModified } from '../../../last-modified'\n+import { CachedLastModified } from '../../../../last-modified'\n \n export default async function Page({ params }) {\n   return <CachedLastModified params={params} />",
            "previous_filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/without-suspense/params-not-in-page/[slug]/page.jsx"
        },
        {
            "sha": "909fca03deaf75420d5327de7b921f84cbc9f1a9",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-static-params/without-suspense/params-then-in-page/[slug]/page.jsx",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-then-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-then-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwith-static-params%2Fwithout-suspense%2Fparams-then-in-page%2F%5Bslug%5D%2Fpage.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -1,4 +1,4 @@\n-import { CachedLastModified } from '../../../last-modified'\n+import { CachedLastModified } from '../../../../last-modified'\n \n export default async function Page({ params }) {\n   return (",
            "previous_filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-suspense/params-then-in-page/[slug]/page.jsx"
        },
        {
            "sha": "24175856d196a1a74b83d5372c453dc338fecc80",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/without-static-params/layout.jsx",
            "status": "renamed",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Flayout.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Flayout.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Flayout.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -10,6 +10,9 @@ export default async function Layout({ children }) {\n         <div id=\"root-layout\">\n           Root Layout: {new Date().toISOString()} ({getSentinelValue()})\n         </div>\n+        <p>\n+          This page does <em>not</em> define any static params.\n+        </p>\n         <Suspense fallback={<p>Loading...</p>}>{children}</Suspense>\n       </body>\n     </html>",
            "previous_filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-suspense/layout.jsx"
        },
        {
            "sha": "77515816b1c27f7fb04da274b043841fd4985fb4",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/without-static-params/params-in-page/[slug]/layout.tsx",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-in-page%2F%5Bslug%5D%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-in-page%2F%5Bslug%5D%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-in-page%2F%5Bslug%5D%2Flayout.tsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "previous_filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/with-suspense/params-in-page/[slug]/layout.tsx"
        },
        {
            "sha": "0def4c2f5c40cec17ef91deab8c8f941d0742d13",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/without-static-params/params-in-page/[slug]/page.jsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-in-page%2F%5Bslug%5D%2Fpage.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -0,0 +1,7 @@\n+'use cache'\n+\n+import { LastModified } from '../../../last-modified'\n+\n+export default async function Page({ params }) {\n+  return <LastModified params={params} />\n+}"
        },
        {
            "sha": "fe2f1b7b11ca5a552410ec88336328b152d4e1b4",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/without-static-params/params-not-in-page/[slug]/page.jsx",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-not-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-not-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-not-in-page%2F%5Bslug%5D%2Fpage.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -0,0 +1,5 @@\n+import { CachedLastModified } from '../../../last-modified'\n+\n+export default async function Page({ params }) {\n+  return <CachedLastModified params={params} />\n+}"
        },
        {
            "sha": "20c1810c95efdf0ed16fb23d07538de2d6c7f317",
            "filename": "test/e2e/app-dir/fallback-shells/app/with-cached-io/without-static-params/params-then-in-page/[slug]/page.jsx",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-then-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-then-in-page%2F%5Bslug%5D%2Fpage.jsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Fapp%2Fwith-cached-io%2Fwithout-static-params%2Fparams-then-in-page%2F%5Bslug%5D%2Fpage.jsx?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -0,0 +1,12 @@\n+import { CachedLastModified } from '../../../last-modified'\n+\n+export default async function Page({ params }) {\n+  return (\n+    <>\n+      <CachedLastModified params={params.then((p) => ({ slug: p.slug }))} />\n+      <CachedLastModified params={params.catch(() => {})} />\n+      <CachedLastModified params={params.finally(() => {})} />\n+      <CachedLastModified params={params.finally().catch()} />\n+    </>\n+  )\n+}"
        },
        {
            "sha": "61f09ae3edd06fd93a41445062612851d4ef803d",
            "filename": "test/e2e/app-dir/fallback-shells/fallback-shells.test.ts",
            "status": "modified",
            "additions": 251,
            "deletions": 157,
            "changes": 408,
            "blob_url": "https://github.com/vercel/next.js/blob/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Ffallback-shells.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e663cf5db4e5c9e3d73ab1925efe922b91ecd51c/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Ffallback-shells.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ffallback-shells%2Ffallback-shells.test.ts?ref=e663cf5db4e5c9e3d73ab1925efe922b91ecd51c",
            "patch": "@@ -25,263 +25,357 @@ describe('fallback-shells', () => {\n   })\n \n   describe('with cached IO', () => {\n-    describe('and the page wrapped in Suspense', () => {\n-      describe('and the params accessed in the cached page', () => {\n-        it('resumes a postponed fallback shell', async () => {\n-          const { browser, response } = await next.browserWithResponse(\n-            '/with-cached-io/with-suspense/params-in-page/bar',\n-            { pushErrorAsConsoleLog: true }\n-          )\n+    describe('with generateStaticParams', () => {\n+      describe('and the page wrapped in Suspense', () => {\n+        describe('and the params accessed in the cached page', () => {\n+          it('resumes a postponed fallback shell', async () => {\n+            const { browser, response } = await next.browserWithResponse(\n+              '/with-cached-io/with-static-params/with-suspense/params-in-page/bar',\n+              { pushErrorAsConsoleLog: true }\n+            )\n \n-          const lastModified = await browser.elementById('last-modified').text()\n-          expect(lastModified).toInclude('Page /bar')\n-          expect(lastModified).toInclude('runtime')\n+            const lastModified = await browser\n+              .elementById('last-modified')\n+              .text()\n+            expect(lastModified).toInclude('Page /bar')\n+            expect(lastModified).toInclude('runtime')\n \n-          const layout = await browser.elementById('root-layout').text()\n-          expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n+            const layout = await browser.elementById('root-layout').text()\n+            expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n \n-          const headers = response.headers()\n+            const headers = response.headers()\n \n-          if (isNextDeploy) {\n-            expect(headers['x-matched-path']).toBe(\n-              '/with-cached-io/with-suspense/params-in-page/[slug]'\n+            if (isNextDeploy) {\n+              expect(headers['x-matched-path']).toBe(\n+                '/with-cached-io/with-static-params/with-suspense/params-in-page/[slug]'\n+              )\n+            } else if (isNextStart) {\n+              expect(headers['x-nextjs-postponed']).toBe('1')\n+            }\n+          })\n+\n+          // TODO: To be implemented in NAR-136.\n+          it.skip('does not produce hydration errors when resuming a fallback shell containing a layout with unused params', async () => {\n+            const browser = await next.browser(\n+              '/with-cached-io/with-static-params/with-suspense/params-in-page/bar',\n+              { pushErrorAsConsoleLog: true }\n             )\n-          } else if (isNextStart) {\n-            expect(headers['x-nextjs-postponed']).toBe('1')\n-          }\n-        })\n \n-        // TODO: To be implemented in NAR-136.\n-        it.skip('does not produce hydration errors when resuming a fallback shell containing a layout with unused params', async () => {\n-          const browser = await next.browser(\n-            '/with-cached-io/with-suspense/params-in-page/bar',\n-            { pushErrorAsConsoleLog: true }\n-          )\n+            const layout = await browser.elementById('layout').text()\n \n-          const layout = await browser.elementById('layout').text()\n+            // When prerendered, this should be restored from the RDC during the\n+            // resume of the fallback shell, so it should be \"buildtime\". If the\n+            // layout is unexpectedly a cache miss, then it will be \"runtime\".\n+            expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n \n-          // When prerendered, this should be restored from the RDC during the\n-          // resume of the fallback shell, so it should be \"buildtime\". If the\n-          // layout is unexpectedly a cache miss, then it will be \"runtime\".\n-          expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n+            // There should also be no hydration errors due to a buildtime date\n+            // being replaced by a new runtime date.\n+            await assertNoConsoleErrors(browser)\n+          })\n \n-          // There should also be no hydration errors due to a buildtime date\n-          // being replaced by a new runtime date.\n-          await assertNoConsoleErrors(browser)\n+          // TODO: Activate for deploy tests once background revalidation for\n+          // prerendered pages is not triggered anymore on the first visit.\n+          if (!isNextDeploy) {\n+            it('shares a cached parent layout between a prerendered route shell and the fallback shell', async () => {\n+              // `/foo` was prerendered\n+              const browser = await next.browser(\n+                '/with-cached-io/with-static-params/with-suspense/params-in-page/foo'\n+              )\n+\n+              const layoutDateRouteShell = await browser\n+                .elementById('root-layout')\n+                .text()\n+\n+              expect(layoutDateRouteShell).toInclude(\n+                isNextDev ? 'runtime' : 'buildtime'\n+              )\n+\n+              // `/bar` was not prerendered, and thus resumes the fallback shell.\n+              await browser.loadPage(\n+                new URL(\n+                  '/with-cached-io/with-static-params/with-suspense/params-in-page/bar',\n+                  next.url\n+                ).href\n+              )\n+\n+              const layoutDateFallbackShell = await browser\n+                .elementById('root-layout')\n+                .text()\n+\n+              expect(layoutDateRouteShell).toInclude(\n+                isNextDev ? 'runtime' : 'buildtime'\n+              )\n+\n+              expect(layoutDateFallbackShell).toBe(layoutDateRouteShell)\n+            })\n+\n+            // TODO: To be implemented in NAR-136.\n+            it.skip('shares a cached layout with unused params between a prerendered route shell and the fallback shell', async () => {\n+              // `/foo` was prerendered\n+              const browser = await next.browser(\n+                '/with-cached-io/with-static-params/with-suspense/params-in-page/foo'\n+              )\n+\n+              const layoutDateRouteShell = await browser\n+                .elementById('layout')\n+                .text()\n+\n+              expect(layoutDateRouteShell).toInclude(\n+                isNextDev ? 'runtime' : 'buildtime'\n+              )\n+\n+              // `/bar` was not prerendered, and thus resumes the fallback shell.\n+              await browser.loadPage(\n+                new URL(\n+                  '/with-cached-io/with-static-params/with-suspense/params-in-page/bar',\n+                  next.url\n+                ).href\n+              )\n+\n+              const layoutDateFallbackShell = await browser\n+                .elementById('layout')\n+                .text()\n+\n+              expect(layoutDateRouteShell).toInclude(\n+                isNextDev ? 'runtime' : 'buildtime'\n+              )\n+\n+              expect(layoutDateFallbackShell).toBe(layoutDateRouteShell)\n+            })\n+          }\n         })\n \n-        // TODO: Activate for deploy tests once background revalidation for\n-        // prerendered pages is not triggered anymore on the first visit.\n-        if (!isNextDeploy) {\n-          it('shares a cached parent layout between a prerendered route shell and the fallback shell', async () => {\n-            // `/foo` was prerendered\n-            const browser = await next.browser(\n-              '/with-cached-io/with-suspense/params-in-page/foo'\n+        describe('and the params accessed in cached non-page function', () => {\n+          it('resumes a postponed fallback shell', async () => {\n+            const { browser, response } = await next.browserWithResponse(\n+              '/with-cached-io/with-static-params/with-suspense/params-not-in-page/bar'\n             )\n \n-            const layoutDateRouteShell = await browser\n-              .elementById('root-layout')\n+            const lastModified = await browser\n+              .elementById('last-modified')\n               .text()\n+            expect(lastModified).toInclude('Page /bar')\n+            expect(lastModified).toInclude('runtime')\n \n-            expect(layoutDateRouteShell).toInclude(\n-              isNextDev ? 'runtime' : 'buildtime'\n-            )\n+            const layout = await browser.elementById('root-layout').text()\n+            expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n+\n+            const headers = response.headers()\n+\n+            if (isNextDeploy) {\n+              expect(headers['x-matched-path']).toBe(\n+                '/with-cached-io/with-static-params/with-suspense/params-not-in-page/[slug]'\n+              )\n+            } else if (isNextStart) {\n+              expect(headers['x-nextjs-postponed']).toBe('1')\n+            }\n+          })\n+        })\n \n-            // `/bar` was not prerendered, and thus resumes the fallback shell.\n-            await browser.loadPage(\n-              new URL(\n-                '/with-cached-io/with-suspense/params-in-page/bar',\n-                next.url\n-              ).href\n+        describe('and params.then/catch/finally passed to a cached function', () => {\n+          it('resumes a postponed fallback shell', async () => {\n+            const { browser, response } = await next.browserWithResponse(\n+              '/with-cached-io/with-static-params/with-suspense/params-then-in-page/bar'\n             )\n \n-            const layoutDateFallbackShell = await browser\n-              .elementById('root-layout')\n+            const lastModified = await browser\n+              .elementById('last-modified')\n               .text()\n+            expect(lastModified).toInclude('Page /bar')\n+            expect(lastModified).toInclude('runtime')\n \n-            expect(layoutDateRouteShell).toInclude(\n-              isNextDev ? 'runtime' : 'buildtime'\n-            )\n+            const layout = await browser.elementById('root-layout').text()\n+            expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n+\n+            const headers = response.headers()\n \n-            expect(layoutDateFallbackShell).toBe(layoutDateRouteShell)\n+            if (isNextDeploy) {\n+              expect(headers['x-matched-path']).toBe(\n+                '/with-cached-io/with-static-params/with-suspense/params-then-in-page/[slug]'\n+              )\n+            } else if (isNextStart) {\n+              expect(headers['x-nextjs-postponed']).toBe('1')\n+            }\n           })\n+        })\n+      })\n \n-          // TODO: To be implemented in NAR-136.\n-          it.skip('shares a cached layout with unused params between a prerendered route shell and the fallback shell', async () => {\n-            // `/foo` was prerendered\n-            const browser = await next.browser(\n-              '/with-cached-io/with-suspense/params-in-page/foo'\n+      describe('and the page not wrapped in Suspense', () => {\n+        describe('and the params accessed in the cached page', () => {\n+          it('does not resume a postponed fallback shell', async () => {\n+            const { browser, response } = await next.browserWithResponse(\n+              '/with-cached-io/with-static-params/without-suspense/params-in-page/bar'\n             )\n \n-            const layoutDateRouteShell = await browser\n-              .elementById('layout')\n+            const lastModified = await browser\n+              .elementById('last-modified')\n               .text()\n+            expect(lastModified).toInclude('Page /bar')\n+            expect(lastModified).toInclude('runtime')\n \n-            expect(layoutDateRouteShell).toInclude(\n-              isNextDev ? 'runtime' : 'buildtime'\n-            )\n+            const layout = await browser.elementById('root-layout').text()\n+            expect(layout).toInclude('runtime')\n \n-            // `/bar` was not prerendered, and thus resumes the fallback shell.\n-            await browser.loadPage(\n-              new URL(\n-                '/with-cached-io/with-suspense/params-in-page/bar',\n-                next.url\n-              ).href\n-            )\n+            const headers = response.headers()\n \n-            const layoutDateFallbackShell = await browser\n-              .elementById('layout')\n-              .text()\n+            if (isNextDeploy) {\n+              expect(headers['x-matched-path']).toBe(\n+                '/with-cached-io/with-static-params/without-suspense/params-in-page/[slug]'\n+              )\n+            } else if (isNextStart) {\n+              expect(headers['x-nextjs-postponed']).not.toBe('1')\n+            }\n+          })\n \n-            expect(layoutDateRouteShell).toInclude(\n-              isNextDev ? 'runtime' : 'buildtime'\n+          it('does not render a fallback shell when using a params placeholder', async () => {\n+            // This should trigger a blocking prerender of the route shell.\n+            const { browser, response } = await next.browserWithResponse(\n+              '/with-cached-io/with-static-params/without-suspense/params-in-page/[slug]'\n             )\n \n-            expect(layoutDateFallbackShell).toBe(layoutDateRouteShell)\n+            expect(response.status()).toBe(200)\n+\n+            // This should render the encoded param in the route shell, and not\n+            // interpret the param as a fallback param, and subsequently try to\n+            // render the fallback shell instead, which would fail because of the\n+            // missing parent suspense boundary.\n+            const lastModified = await browser\n+              .elementById('last-modified')\n+              .text()\n+            expect(lastModified).toInclude('Page /%5Bslug%5D')\n+            expect(lastModified).toInclude('runtime')\n           })\n-        }\n-      })\n+        })\n \n-      describe('and the params accessed in cached non-page function', () => {\n-        it('resumes a postponed fallback shell', async () => {\n-          const { browser, response } = await next.browserWithResponse(\n-            '/with-cached-io/with-suspense/params-not-in-page/bar'\n-          )\n+        describe('and the params accessed in a cached non-page function', () => {\n+          it('does not resume a postponed fallback shell', async () => {\n+            const { browser, response } = await next.browserWithResponse(\n+              '/with-cached-io/with-static-params/without-suspense/params-not-in-page/bar'\n+            )\n \n-          const lastModified = await browser.elementById('last-modified').text()\n-          expect(lastModified).toInclude('Page /bar')\n-          expect(lastModified).toInclude('runtime')\n+            const lastModified = await browser\n+              .elementById('last-modified')\n+              .text()\n+            expect(lastModified).toInclude('Page /bar')\n+            expect(lastModified).toInclude('runtime')\n \n-          const layout = await browser.elementById('root-layout').text()\n-          expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n+            const layout = await browser.elementById('root-layout').text()\n+            expect(layout).toInclude('runtime')\n \n-          const headers = response.headers()\n+            const headers = response.headers()\n \n-          if (isNextDeploy) {\n-            expect(headers['x-matched-path']).toBe(\n-              '/with-cached-io/with-suspense/params-not-in-page/[slug]'\n-            )\n-          } else if (isNextStart) {\n-            expect(headers['x-nextjs-postponed']).toBe('1')\n-          }\n+            if (isNextDeploy) {\n+              expect(headers['x-matched-path']).toBe(\n+                '/with-cached-io/with-static-params/without-suspense/params-not-in-page/[slug]'\n+              )\n+            } else if (isNextStart) {\n+              expect(headers['x-nextjs-postponed']).not.toBe('1')\n+            }\n+          })\n         })\n-      })\n \n-      describe('and params.then/catch/finally passed to a cached function', () => {\n-        it('resumes a postponed fallback shell', async () => {\n-          const { browser, response } = await next.browserWithResponse(\n-            '/with-cached-io/with-suspense/params-then-in-page/bar'\n-          )\n+        describe('and params.then/catch/finally passed to a cached function', () => {\n+          it('does not resume a postponed fallback shell', async () => {\n+            const { browser, response } = await next.browserWithResponse(\n+              '/with-cached-io/with-static-params/without-suspense/params-then-in-page/bar'\n+            )\n \n-          const lastModified = await browser.elementById('last-modified').text()\n-          expect(lastModified).toInclude('Page /bar')\n-          expect(lastModified).toInclude('runtime')\n+            const lastModified = await browser\n+              .elementById('last-modified')\n+              .text()\n+            expect(lastModified).toInclude('Page /bar')\n+            expect(lastModified).toInclude('runtime')\n \n-          const layout = await browser.elementById('root-layout').text()\n-          expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n+            const layout = await browser.elementById('root-layout').text()\n+            expect(layout).toInclude('runtime')\n \n-          const headers = response.headers()\n+            const headers = response.headers()\n \n-          if (isNextDeploy) {\n-            expect(headers['x-matched-path']).toBe(\n-              '/with-cached-io/with-suspense/params-then-in-page/[slug]'\n-            )\n-          } else if (isNextStart) {\n-            expect(headers['x-nextjs-postponed']).toBe('1')\n-          }\n+            if (isNextDeploy) {\n+              expect(headers['x-matched-path']).toBe(\n+                '/with-cached-io/with-static-params/without-suspense/params-then-in-page/[slug]'\n+              )\n+            } else if (isNextStart) {\n+              expect(headers['x-nextjs-postponed']).not.toBe('1')\n+            }\n+          })\n         })\n       })\n     })\n \n-    describe('and the page not wrapped in Suspense', () => {\n+    describe('without generateStaticParams', () => {\n       describe('and the params accessed in the cached page', () => {\n-        it('does not resume a postponed fallback shell', async () => {\n+        it('resumes a postponed fallback shell', async () => {\n           const { browser, response } = await next.browserWithResponse(\n-            '/with-cached-io/without-suspense/params-in-page/bar'\n+            '/with-cached-io/without-static-params/params-in-page/foo',\n+            { pushErrorAsConsoleLog: true }\n           )\n \n           const lastModified = await browser.elementById('last-modified').text()\n-          expect(lastModified).toInclude('Page /bar')\n+          expect(lastModified).toInclude('Page /foo')\n           expect(lastModified).toInclude('runtime')\n \n           const layout = await browser.elementById('root-layout').text()\n-          expect(layout).toInclude('runtime')\n+          expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n \n           const headers = response.headers()\n \n           if (isNextDeploy) {\n             expect(headers['x-matched-path']).toBe(\n-              '/with-cached-io/without-suspense/params-in-page/[slug]'\n+              '/with-cached-io/without-static-params/params-in-page/[slug]'\n             )\n           } else if (isNextStart) {\n-            expect(headers['x-nextjs-postponed']).not.toBe('1')\n+            expect(headers['x-nextjs-postponed']).toBe('1')\n           }\n         })\n-\n-        it('does not render a fallback shell when using a params placeholder', async () => {\n-          // This should trigger a blocking prerender of the route shell.\n-          const { browser, response } = await next.browserWithResponse(\n-            '/with-cached-io/without-suspense/params-in-page/[slug]'\n-          )\n-\n-          expect(response.status()).toBe(200)\n-\n-          // This should render the encoded param in the route shell, and not\n-          // interpret the param as a fallback param, and subsequently try to\n-          // render the fallback shell instead, which would fail because of the\n-          // missing parent suspense boundary.\n-          const lastModified = await browser.elementById('last-modified').text()\n-          expect(lastModified).toInclude('Page /%5Bslug%5D')\n-          expect(lastModified).toInclude('runtime')\n-        })\n       })\n \n-      describe('and the params accessed in a cached non-page function', () => {\n-        it('does not resume a postponed fallback shell', async () => {\n+      describe('and the params accessed in cached non-page function', () => {\n+        it('resumes a postponed fallback shell', async () => {\n           const { browser, response } = await next.browserWithResponse(\n-            '/with-cached-io/without-suspense/params-not-in-page/bar'\n+            '/with-cached-io/without-static-params/params-not-in-page/foo'\n           )\n \n           const lastModified = await browser.elementById('last-modified').text()\n-          expect(lastModified).toInclude('Page /bar')\n+          expect(lastModified).toInclude('Page /foo')\n           expect(lastModified).toInclude('runtime')\n \n           const layout = await browser.elementById('root-layout').text()\n-          expect(layout).toInclude('runtime')\n+          expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n \n           const headers = response.headers()\n \n           if (isNextDeploy) {\n             expect(headers['x-matched-path']).toBe(\n-              '/with-cached-io/without-suspense/params-not-in-page/[slug]'\n+              '/with-cached-io/without-static-params/params-not-in-page/[slug]'\n             )\n           } else if (isNextStart) {\n-            expect(headers['x-nextjs-postponed']).not.toBe('1')\n+            expect(headers['x-nextjs-postponed']).toBe('1')\n           }\n         })\n       })\n \n       describe('and params.then/catch/finally passed to a cached function', () => {\n-        it('does not resume a postponed fallback shell', async () => {\n+        it('resumes a postponed fallback shell', async () => {\n           const { browser, response } = await next.browserWithResponse(\n-            '/with-cached-io/without-suspense/params-then-in-page/bar'\n+            '/with-cached-io/without-static-params/params-then-in-page/foo'\n           )\n \n           const lastModified = await browser.elementById('last-modified').text()\n-          expect(lastModified).toInclude('Page /bar')\n+          expect(lastModified).toInclude('Page /foo')\n           expect(lastModified).toInclude('runtime')\n \n           const layout = await browser.elementById('root-layout').text()\n-          expect(layout).toInclude('runtime')\n+          expect(layout).toInclude(isNextDev ? 'runtime' : 'buildtime')\n \n           const headers = response.headers()\n \n           if (isNextDeploy) {\n             expect(headers['x-matched-path']).toBe(\n-              '/with-cached-io/without-suspense/params-then-in-page/[slug]'\n+              '/with-cached-io/without-static-params/params-then-in-page/[slug]'\n             )\n           } else if (isNextStart) {\n-            expect(headers['x-nextjs-postponed']).not.toBe('1')\n+            expect(headers['x-nextjs-postponed']).toBe('1')\n           }\n         })\n       })"
        }
    ],
    "stats": {
        "total": 472,
        "additions": 309,
        "deletions": 163
    }
}