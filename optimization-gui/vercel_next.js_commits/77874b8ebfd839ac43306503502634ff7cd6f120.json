{
    "author": "bgw",
    "message": "refactor(CI): Assign tests to groups round-robin instead of sequentially when we don't have timings (#76462)\n\nOur CI runs tests in parallel across multiple groups. We want test groups to all take similar amounts of time to decrease overall latency, and to reduce the chance of test group timeouts in CI.\n\nThere's logic here to assign intelligently to groups based on previous test timing information, but if there's no timing information for whatever reason (e.g. we don't currently use timings for rspack/turbopack integration tests), then we were assigning them to groups sequentially.\n\nBecause tests with similar paths tend to have similar performance characteristics, it's better to assign every nth test to each group, similar to round-robin assignment.",
    "sha": "77874b8ebfd839ac43306503502634ff7cd6f120",
    "files": [
        {
            "sha": "c4cd08b2516c7d0e26ef3c7b825307112cf7db8e",
            "filename": "run-tests.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/77874b8ebfd839ac43306503502634ff7cd6f120/run-tests.js",
            "raw_url": "https://github.com/vercel/next.js/raw/77874b8ebfd839ac43306503502634ff7cd6f120/run-tests.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/run-tests.js?ref=77874b8ebfd839ac43306503502634ff7cd6f120",
            "patch": "@@ -381,9 +381,9 @@ async function main() {\n         Math.round(groupTimes[curGroupIdx]) + 's'\n       )\n     } else {\n-      const numPerGroup = Math.ceil(tests.length / groupTotal)\n-      let offset = (groupPos - 1) * numPerGroup\n-      tests = tests.slice(offset, offset + numPerGroup)\n+      // assign every nth test \"round-robin\" to the group, so that similar slow\n+      // tests tend not to get clustered together\n+      tests = tests.filter((_value, idx) => idx % groupTotal === groupPos - 1)\n       console.log('Splitting without timings')\n     }\n   }"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
    }
}