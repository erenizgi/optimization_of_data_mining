{
    "author": "raunofreiberg",
    "message": "[dev-overlay] Fix error dialog resizing logic (#78144)",
    "sha": "fe6ff11796951de4f4c0441385df6c8cc96e4956",
    "files": [
        {
            "sha": "a63c2878c6b3a417b24aed583a9b7ecf08b187d4",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/dialog/dialog.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 17,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fdialog.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fdialog.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fdialog.tsx?ref=fe6ff11796951de4f4c0441385df6c8cc96e4956",
            "patch": "@@ -1,6 +1,5 @@\n import * as React from 'react'\n import { useOnClickOutside } from '../../hooks/use-on-click-outside'\n-import { useMeasureHeight } from '../../hooks/use-measure-height'\n \n export type DialogProps = {\n   children?: React.ReactNode\n@@ -35,9 +34,6 @@ const Dialog: React.FC<DialogProps> = function Dialog({\n       : undefined\n   )\n \n-  const ref = React.useRef<HTMLDivElement | null>(null)\n-  const [height, pristine] = useMeasureHeight(ref)\n-\n   useOnClickOutside(\n     dialogRef.current,\n     CSS_SELECTORS_TO_EXCLUDE_ON_CLICK_OUTSIDE,\n@@ -100,19 +96,7 @@ const Dialog: React.FC<DialogProps> = function Dialog({\n       }}\n       {...props}\n     >\n-      <div\n-        ref={dialogResizerRef}\n-        data-nextjs-dialog-sizer\n-        // [x] Don't animate on initial load\n-        // [x] No duplicate elements\n-        // [x] Responds to content growth\n-        style={{\n-          height,\n-          transition: pristine ? undefined : 'height 250ms var(--timing-swift)',\n-        }}\n-      >\n-        <div ref={ref}>{children}</div>\n-      </div>\n+      {children}\n     </div>\n   )\n }"
        },
        {
            "sha": "1838017af812c7542048b7ea29a6babf5a50fba5",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/dialog/styles.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fstyles.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fstyles.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fstyles.ts?ref=fe6ff11796951de4f4c0441385df6c8cc96e4956",
            "patch": "@@ -3,7 +3,7 @@ const styles = `\n     --next-dialog-radius: var(--rounded-xl);\n     --next-dialog-max-width: 960px;\n     --next-dialog-row-padding: 16px;\n-    --next-dialog-padding-x: 12px;\n+    --next-dialog-padding: 12px;\n     --next-dialog-notch-height: 42px;\n     --next-dialog-border-width: 1px;\n \n@@ -14,7 +14,7 @@ const styles = `\n     max-width: var(--next-dialog-max-width);\n     margin-right: auto;\n     margin-left: auto;\n-    scale: 0.98;\n+    scale: 0.97;\n     opacity: 0;\n     transition-property: scale, opacity;\n     transition-duration: var(--transition-duration);\n@@ -28,7 +28,7 @@ const styles = `\n     [data-nextjs-scroll-fader][data-side=\"top\"] {\n       left: 1px;\n       top: calc(var(--next-dialog-notch-height) + var(--next-dialog-border-width));\n-      width: calc(100% - var(--next-dialog-padding-x));\n+      width: calc(100% - var(--next-dialog-padding));\n       opacity: 0;\n     }\n   }\n@@ -82,7 +82,7 @@ const styles = `\n     display: flex;\n     flex-direction: column;\n     position: relative;\n-    padding: 16px var(--next-dialog-padding-x);\n+    padding: var(--next-dialog-padding);\n   }\n \n   [data-nextjs-dialog-content] > [data-nextjs-dialog-header] {"
        },
        {
            "sha": "8587fb6fcd8247900498b64393c8e3630a98e1ba",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay-layout/error-overlay-layout.test.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.test.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.test.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.test.tsx?ref=fe6ff11796951de4f4c0441385df6c8cc96e4956",
            "patch": "@@ -24,6 +24,7 @@ const renderTestComponent = () => {\n       rendered={true}\n       transitionDurationMs={200}\n       isTurbopack={false}\n+      errorCount={1}\n       versionInfo={{\n         installed: '15.0.0',\n         staleness: 'fresh',"
        },
        {
            "sha": "2d752d6b87b945ea7a39322a90b9f366b668a249",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay-layout/error-overlay-layout.tsx",
            "status": "modified",
            "additions": 50,
            "deletions": 23,
            "changes": 73,
            "blob_url": "https://github.com/vercel/next.js/blob/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.tsx?ref=fe6ff11796951de4f4c0441385df6c8cc96e4956",
            "patch": "@@ -36,6 +36,7 @@ import type { ReadyRuntimeError } from '../../../../utils/get-error-by-type'\n import { EnvironmentNameLabel } from '../environment-name-label/environment-name-label'\n import { useFocusTrap } from '../dev-tools-indicator/utils'\n import { Fader } from '../../fader'\n+import { Resizer } from '../../resizer'\n \n export interface ErrorOverlayLayoutProps extends ErrorBaseProps {\n   errorMessage: ErrorMessageType\n@@ -59,6 +60,7 @@ export function ErrorOverlayLayout({\n   errorType,\n   children,\n   errorCode,\n+  errorCount,\n   error,\n   debugInfo,\n   isBuildError,\n@@ -83,6 +85,10 @@ export function ErrorOverlayLayout({\n     } as React.CSSProperties,\n   }\n \n+  const [animating, setAnimating] = React.useState(\n+    Boolean(transitionDurationMs)\n+  )\n+\n   const faderRef = React.useRef<HTMLDivElement | null>(null)\n   const hasFooter = Boolean(footerMessage || errorCode)\n   const dialogRef = React.useRef<HTMLDivElement | null>(null)\n@@ -95,9 +101,23 @@ export function ErrorOverlayLayout({\n     }\n   }\n \n+  function onTransitionEnd({ propertyName, target }: React.TransitionEvent) {\n+    // We can only measure height after the `scale` transition ends,\n+    // otherwise we will measure height as a multiple of the animating value\n+    // which will give us an incorrect value.\n+    if (propertyName === 'scale' && target === dialogRef.current) {\n+      setAnimating(false)\n+    }\n+  }\n+\n   return (\n     <ErrorOverlayOverlay fixed={isBuildError} {...animationProps}>\n-      <div data-nextjs-dialog-root ref={dialogRef} {...animationProps}>\n+      <div\n+        data-nextjs-dialog-root\n+        onTransitionEnd={onTransitionEnd}\n+        ref={dialogRef}\n+        {...animationProps}\n+      >\n         <ErrorOverlayNav\n           runtimeErrors={runtimeErrors}\n           activeIdx={activeIdx}\n@@ -119,30 +139,37 @@ export function ErrorOverlayLayout({\n             )\n           }\n         >\n-          <DialogContent>\n-            <ErrorOverlayDialogHeader>\n-              <div\n-                className=\"nextjs__container_errors__error_title\"\n-                // allow assertion in tests before error rating is implemented\n-                data-nextjs-error-code={errorCode}\n-              >\n-                <span data-nextjs-error-label-group>\n-                  <ErrorTypeLabel errorType={errorType} />\n-                  {error.environmentName && (\n-                    <EnvironmentNameLabel\n-                      environmentName={error.environmentName}\n-                    />\n-                  )}\n-                </span>\n-                <ErrorOverlayToolbar error={error} debugInfo={debugInfo} />\n-              </div>\n-              <ErrorMessage errorMessage={errorMessage} />\n-            </ErrorOverlayDialogHeader>\n+          <Resizer\n+            ref={dialogResizerRef}\n+            measure={!animating}\n+            data-nextjs-dialog-sizer\n+          >\n+            <DialogContent>\n+              <ErrorOverlayDialogHeader>\n+                <div\n+                  className=\"nextjs__container_errors__error_title\"\n+                  // allow assertion in tests before error rating is implemented\n+                  data-nextjs-error-code={errorCode}\n+                >\n+                  <span data-nextjs-error-label-group>\n+                    <ErrorTypeLabel errorType={errorType} />\n+                    {error.environmentName && (\n+                      <EnvironmentNameLabel\n+                        environmentName={error.environmentName}\n+                      />\n+                    )}\n+                  </span>\n+                  <ErrorOverlayToolbar error={error} debugInfo={debugInfo} />\n+                </div>\n+                <ErrorMessage errorMessage={errorMessage} />\n+              </ErrorOverlayDialogHeader>\n+\n+              <ErrorOverlayDialogBody>{children}</ErrorOverlayDialogBody>\n+            </DialogContent>\n+          </Resizer>\n \n-            <ErrorOverlayDialogBody>{children}</ErrorOverlayDialogBody>\n-          </DialogContent>\n           <ErrorOverlayBottomStack\n-            errorCount={runtimeErrors?.length ?? 0}\n+            errorCount={errorCount}\n             activeIdx={activeIdx ?? 0}\n           />\n         </ErrorOverlayDialog>"
        },
        {
            "sha": "468f8a014ca573671fa6f17abf752cc5f5af5317",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay/error-overlay.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay%2Ferror-overlay.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay%2Ferror-overlay.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay%2Ferror-overlay.tsx?ref=fe6ff11796951de4f4c0441385df6c8cc96e4956",
            "patch": "@@ -13,18 +13,21 @@ export interface ErrorBaseProps {\n   transitionDurationMs: number\n   isTurbopack: boolean\n   versionInfo: OverlayState['versionInfo']\n+  errorCount: number\n }\n \n export function ErrorOverlay({\n   state,\n   runtimeErrors,\n   isErrorOverlayOpen,\n   setIsErrorOverlayOpen,\n+  errorCount,\n }: {\n   state: OverlayState\n   runtimeErrors: ReadyRuntimeError[]\n   isErrorOverlayOpen: boolean\n   setIsErrorOverlayOpen: (value: boolean) => void\n+  errorCount: number\n }) {\n   const isTurbopack = !!process.env.TURBOPACK\n \n@@ -38,6 +41,7 @@ export function ErrorOverlay({\n     transitionDurationMs,\n     isTurbopack,\n     versionInfo: state.versionInfo,\n+    errorCount,\n   }\n \n   if (state.buildError !== null) {"
        },
        {
            "sha": "a5c6ee95d7301fca2dbc6ade228c2683777a4553",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/resizer/index.tsx",
            "status": "added",
            "additions": 69,
            "deletions": 0,
            "changes": 69,
            "blob_url": "https://github.com/vercel/next.js/blob/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fresizer%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fresizer%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fresizer%2Findex.tsx?ref=fe6ff11796951de4f4c0441385df6c8cc96e4956",
            "patch": "@@ -0,0 +1,69 @@\n+import { useEffect, useRef, useState, forwardRef } from 'react'\n+\n+export const Resizer = forwardRef(function Resizer(\n+  {\n+    children,\n+    measure,\n+    ...props\n+  }: {\n+    children: React.ReactNode\n+    measure: boolean\n+  } & React.HTMLProps<HTMLDivElement>,\n+  resizerRef: React.Ref<HTMLDivElement | null>\n+) {\n+  const ref = useRef<HTMLDivElement | null>(null)\n+  const [height, measuring] = useMeasureHeight(ref, measure)\n+\n+  return (\n+    <div\n+      {...props}\n+      ref={resizerRef}\n+      // [x] Don't animate on initial load\n+      // [x] No duplicate elements\n+      // [x] Responds to content growth\n+      style={{\n+        height: measuring ? 'auto' : height,\n+        transition: 'height 250ms var(--timing-swift)',\n+      }}\n+    >\n+      <div ref={ref}>{children}</div>\n+    </div>\n+  )\n+})\n+\n+function useMeasureHeight(\n+  ref: React.RefObject<HTMLDivElement | null>,\n+  measure: boolean\n+): [number, boolean] {\n+  const [height, setHeight] = useState<number>(0)\n+  const [measuring, setMeasuring] = useState<boolean>(true)\n+\n+  useEffect(() => {\n+    if (!measure) {\n+      return\n+    }\n+\n+    let timerId: number\n+    const el = ref.current\n+\n+    if (!el) {\n+      return\n+    }\n+\n+    const observer = new ResizeObserver(([{ contentRect }]) => {\n+      clearTimeout(timerId)\n+\n+      timerId = window.setTimeout(() => {\n+        setMeasuring(false)\n+      }, 100)\n+\n+      setHeight(contentRect.height)\n+    })\n+\n+    observer.observe(el)\n+    return () => observer.disconnect()\n+    // eslint-disable-next-line react-hooks/exhaustive-deps\n+  }, [measure])\n+\n+  return [height, measuring]\n+}"
        },
        {
            "sha": "d06b37eb452600b26f4720e7d8e28616edb898fa",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/container/errors.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 13,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.tsx?ref=fe6ff11796951de4f4c0441385df6c8cc96e4956",
            "patch": "@@ -1,4 +1,4 @@\n-import { useState, useMemo, useEffect, useRef, Suspense } from 'react'\n+import { useState, useMemo, useRef, Suspense } from 'react'\n import type { DebugInfo } from '../../types'\n import { Overlay } from '../components/overlay'\n import { RuntimeError } from './runtime-error'\n@@ -124,18 +124,6 @@ export function Errors({\n }: ErrorsProps) {\n   const dialogResizerRef = useRef<HTMLDivElement | null>(null)\n \n-  useEffect(() => {\n-    // Close the error overlay when pressing escape\n-    function handleKeyDown(event: KeyboardEvent) {\n-      if (event.key === 'Escape') {\n-        onClose()\n-      }\n-    }\n-\n-    document.addEventListener('keydown', handleKeyDown)\n-    return () => document.removeEventListener('keydown', handleKeyDown)\n-  }, [onClose])\n-\n   const isLoading = useMemo<boolean>(() => {\n     return runtimeErrors.length < 1\n   }, [runtimeErrors.length])"
        },
        {
            "sha": "735cb06313fd6c9687cbca4475e9d42f811e14cf",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/dev-overlay.stories.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fdev-overlay.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fdev-overlay.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fdev-overlay.stories.tsx?ref=fe6ff11796951de4f4c0441385df6c8cc96e4956",
            "patch": "@@ -92,9 +92,8 @@ export const Default: Story = {\n           src={imgApp}\n           style={{\n             width: '100%',\n-            height: '100%',\n+            height: '100vh',\n             objectFit: 'contain',\n-            filter: 'invert(1)',\n           }}\n         />\n         <DevOverlay"
        },
        {
            "sha": "7b18b0b57f5da1ce1ee02f22634a67f5d3f97709",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/dev-overlay.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fdev-overlay.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fe6ff11796951de4f4c0441385df6c8cc96e4956/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fdev-overlay.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fdev-overlay.tsx?ref=fe6ff11796951de4f4c0441385df6c8cc96e4956",
            "patch": "@@ -50,6 +50,7 @@ export function DevOverlay({\n               <ErrorOverlay\n                 state={state}\n                 runtimeErrors={runtimeErrors}\n+                errorCount={totalErrorCount}\n                 isErrorOverlayOpen={isErrorOverlayOpen}\n                 setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n               />"
        },
        {
            "sha": "54097e8bd4d6cd3537b2870ba5f05051fa66e76b",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/hooks/use-measure-height.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 35,
            "changes": 35,
            "blob_url": "https://github.com/vercel/next.js/blob/986e392b086a7cca3c274a0d27386b12f1ac0e0a/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fhooks%2Fuse-measure-height.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/986e392b086a7cca3c274a0d27386b12f1ac0e0a/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fhooks%2Fuse-measure-height.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fhooks%2Fuse-measure-height.ts?ref=986e392b086a7cca3c274a0d27386b12f1ac0e0a",
            "patch": "@@ -1,35 +0,0 @@\n-import { useEffect, useState } from 'react'\n-\n-export function useMeasureHeight(\n-  ref: React.RefObject<HTMLDivElement | null>\n-): [number, boolean] {\n-  const [pristine, setPristine] = useState<boolean>(true)\n-  const [height, setHeight] = useState<number>(0)\n-\n-  useEffect(() => {\n-    const el = ref.current\n-\n-    if (!el) {\n-      return\n-    }\n-\n-    const observer = new ResizeObserver(() => {\n-      const { height: h } = el.getBoundingClientRect()\n-      setHeight((prevHeight) => {\n-        if (prevHeight !== 0) {\n-          setPristine(false)\n-        }\n-        return h\n-      })\n-    })\n-\n-    observer.observe(el)\n-    return () => {\n-      observer.disconnect()\n-      setPristine(true)\n-    }\n-    // eslint-disable-next-line react-hooks/exhaustive-deps\n-  }, [])\n-\n-  return [height, pristine]\n-}"
        }
    ],
    "stats": {
        "total": 226,
        "additions": 132,
        "deletions": 94
    }
}