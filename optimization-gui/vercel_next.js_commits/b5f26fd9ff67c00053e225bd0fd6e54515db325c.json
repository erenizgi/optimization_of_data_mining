{
    "author": "devjiwonchoi",
    "message": "[devtools] apply draggable to panel ui (#80517)\n\nhttps://github.com/user-attachments/assets/b726d417-972d-44f7-aab0-aab86059b1b4",
    "sha": "b5f26fd9ff67c00053e225bd0fd6e54515db325c",
    "files": [
        {
            "sha": "baa5dbd774c384f24e599ff840867e26fe2425d0",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/devtools-indicator.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx?ref=b5f26fd9ff67c00053e225bd0fd6e54515db325c",
            "patch": "@@ -19,7 +19,7 @@ import {\n } from '../../shared'\n import { Draggable } from '../errors/dev-tools-indicator/draggable'\n \n-const INDICATOR_PADDING = 20\n+export const INDICATOR_PADDING = 20\n \n export function DevToolsIndicator({\n   state,\n@@ -59,6 +59,7 @@ export function DevToolsIndicator({\n           zIndex: 2147483647,\n           [vertical]: `${INDICATOR_PADDING}px`,\n           [horizontal]: `${INDICATOR_PADDING}px`,\n+          visibility: state.isDevToolsPanelOpen ? 'hidden' : 'visible',\n         } as CSSProperties\n       }\n     >"
        },
        {
            "sha": "fe0499a6cc670d55775b41771f4cbaf66209830b",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-panel/devtools-panel.tsx",
            "status": "modified",
            "additions": 56,
            "deletions": 15,
            "changes": 71,
            "blob_url": "https://github.com/vercel/next.js/blob/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx?ref=b5f26fd9ff67c00053e225bd0fd6e54515db325c",
            "patch": "@@ -2,42 +2,83 @@ import type { OverlayDispatch, OverlayState } from '../../shared'\n \n import { Dialog, DialogContent, DialogHeader, DialogBody } from '../dialog'\n import { Overlay } from '../overlay/overlay'\n-import { ACTION_DEVTOOLS_PANEL_TOGGLE } from '../../shared'\n+import {\n+  ACTION_DEVTOOLS_PANEL_CLOSE,\n+  ACTION_DEVTOOLS_POSITION,\n+  STORAGE_KEY_POSITION,\n+} from '../../shared'\n import { css } from '../../utils/css'\n+import { OverlayBackdrop } from '../overlay'\n+import { Draggable } from '../errors/dev-tools-indicator/draggable'\n+import { INDICATOR_PADDING } from '../devtools-indicator/devtools-indicator'\n \n export function DevToolsPanel({\n-  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n   state,\n   dispatch,\n }: {\n   state: OverlayState\n   dispatch: OverlayDispatch\n }) {\n+  const [vertical, horizontal] = state.devToolsPosition.split('-', 2)\n+\n   const onClose = () => {\n-    dispatch({ type: ACTION_DEVTOOLS_PANEL_TOGGLE })\n+    dispatch({ type: ACTION_DEVTOOLS_PANEL_CLOSE })\n   }\n \n   return (\n-    <Overlay data-nextjs-devtools-panel-overlay>\n-      <Dialog\n-        data-nextjs-devtools-panel-dialog\n-        aria-labelledby=\"nextjs__container_dev_tools_panel_label\"\n-        aria-describedby=\"nextjs__container_dev_tools_panel_desc\"\n-        onClose={onClose}\n+    <Overlay\n+      data-nextjs-devtools-panel-overlay\n+      style={{\n+        [vertical]: `${INDICATOR_PADDING}px`,\n+        [horizontal]: `${INDICATOR_PADDING}px`,\n+        [vertical === 'top' ? 'bottom' : 'top']: 'auto',\n+        [horizontal === 'left' ? 'right' : 'left']: 'auto',\n+      }}\n+    >\n+      {/* TODO: Investigate why onClose on Dialog doesn't close when clicked outside. */}\n+      <OverlayBackdrop\n+        data-nextjs-devtools-panel-overlay-backdrop\n+        onClick={onClose}\n+      />\n+      <Draggable\n+        padding={INDICATOR_PADDING}\n+        onDragStart={() => {}}\n+        position={state.devToolsPosition}\n+        setPosition={(p) => {\n+          localStorage.setItem(STORAGE_KEY_POSITION, p)\n+          dispatch({\n+            type: ACTION_DEVTOOLS_POSITION,\n+            devToolsPosition: p,\n+          })\n+        }}\n       >\n-        <DialogContent>\n-          <DialogHeader></DialogHeader>\n-          <DialogBody></DialogBody>\n-        </DialogContent>\n-      </Dialog>\n+        <Dialog\n+          data-nextjs-devtools-panel-dialog\n+          aria-labelledby=\"nextjs__container_dev_tools_panel_label\"\n+          aria-describedby=\"nextjs__container_dev_tools_panel_desc\"\n+          onClose={onClose}\n+        >\n+          <DialogContent>\n+            <DialogHeader></DialogHeader>\n+            <DialogBody></DialogBody>\n+          </DialogContent>\n+        </Dialog>\n+      </Draggable>\n     </Overlay>\n   )\n }\n \n export const DEVTOOLS_PANEL_STYLES = css`\n   [data-nextjs-devtools-panel-overlay] {\n     padding: initial;\n-    top: 10vh;\n+    margin: auto;\n+    /* TODO: This is for fullscreen mode. */\n+    /* top: 10vh; */\n+  }\n+\n+  [data-nextjs-devtools-panel-overlay-backdrop] {\n+    /* TODO: Blur on fullscreen mode. */\n+    opacity: 0;\n   }\n \n   [data-nextjs-devtools-panel-dialog] {"
        },
        {
            "sha": "13d0968a544be022b784b1270c490abfc9a47198",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/dialog/dialog.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdialog%2Fdialog.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdialog%2Fdialog.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdialog%2Fdialog.tsx?ref=b5f26fd9ff67c00053e225bd0fd6e54515db325c",
            "patch": "@@ -16,6 +16,7 @@ const CSS_SELECTORS_TO_EXCLUDE_ON_CLICK_OUTSIDE = [\n   '#nextjs-dev-tools-menu',\n   '[data-nextjs-error-overlay-nav]',\n   '[data-info-popover]',\n+  '[data-nextjs-devtools-panel-overlay]',\n ]\n \n const Dialog: React.FC<DialogProps> = function Dialog({"
        },
        {
            "sha": "c2d1253d93ffe2ae4a79a27b440bcf3a0052849d",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/draggable.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdraggable.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdraggable.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdraggable.tsx?ref=b5f26fd9ff67c00053e225bd0fd6e54515db325c",
            "patch": "@@ -1,12 +1,11 @@\n+import type { Corners } from '../../../shared'\n import { useRef } from 'react'\n \n interface Point {\n   x: number\n   y: number\n }\n \n-type Corners = 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right'\n-\n interface Corner {\n   corner: Corners\n   translation: Point"
        },
        {
            "sha": "da11c680e8b9f26d717a5df03eeed12dace49a4f",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/overlay/overlay.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverlay%2Foverlay.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b5f26fd9ff67c00053e225bd0fd6e54515db325c/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverlay%2Foverlay.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverlay%2Foverlay.tsx?ref=b5f26fd9ff67c00053e225bd0fd6e54515db325c",
            "patch": "@@ -1,9 +1,7 @@\n import * as React from 'react'\n import { lock, unlock } from './body-locker'\n \n-export type OverlayProps = {\n-  children?: React.ReactNode\n-  className?: string\n+export type OverlayProps = React.HTMLAttributes<HTMLDivElement> & {\n   fixed?: boolean\n }\n "
        }
    ],
    "stats": {
        "total": 82,
        "additions": 61,
        "deletions": 21
    }
}