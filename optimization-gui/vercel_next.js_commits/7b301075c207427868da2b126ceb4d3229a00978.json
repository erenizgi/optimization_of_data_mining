{
    "author": "sokra",
    "message": "Turbopack: refactor CssEmbed to avoid creating a chunk item (#77303)\n\n### What?\n\nrefactor CssEmbed to avoid creating a chunk item which writes only a comment to a output file\n\nTo do that we export references from css where static assets are embedded into",
    "sha": "7b301075c207427868da2b126ceb4d3229a00978",
    "files": [
        {
            "sha": "f5f4454e982c2cf3c0f6592c111cd708857cb902",
            "filename": "test/integration/css/test/basic-global-support.test.js",
            "status": "modified",
            "additions": 210,
            "deletions": 153,
            "changes": 363,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/test%2Fintegration%2Fcss%2Ftest%2Fbasic-global-support.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/test%2Fintegration%2Fcss%2Ftest%2Fbasic-global-support.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fcss%2Ftest%2Fbasic-global-support.test.js?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -57,23 +57,36 @@ module.exports = {\n           const $ = cheerio.load(content)\n \n           const cssSheet = $('link[rel=\"stylesheet\"]')\n-          expect(cssSheet.length).toBe(1)\n-          const stylesheet = cssSheet.attr('href')\n-\n-          const cssContent = (\n-            await fetchViaHTTP(appPort, stylesheet).then((res) => res.text())\n-          )\n-            .replace(/\\/\\*.*?\\*\\//g, '')\n-            .trim()\n+          const cssContent = await getStylesheetContents($, appPort, cssSheet)\n \n           if (process.env.TURBOPACK && useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_single-global_styles_global_04ffe231.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           } else if (process.env.TURBOPACK && !useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_single-global_styles_global_04ffe231.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           } else if (useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/e6f86e82ed770205.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           } else {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/e6f86e82ed770205.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           }\n         })\n       })\n@@ -128,23 +141,36 @@ module.exports = {\n           const $ = cheerio.load(content)\n \n           const cssSheet = $('link[rel=\"stylesheet\"]')\n-          expect(cssSheet.length).toBe(1)\n-          const stylesheet = cssSheet.attr('href')\n-\n-          const cssContent = (\n-            await fetchViaHTTP(appPort, stylesheet).then((res) => res.text())\n-          )\n-            .replace(/\\/\\*.*?\\*\\//g, '')\n-            .trim()\n+          const cssContent = await getStylesheetContents($, appPort, cssSheet)\n \n           if (process.env.TURBOPACK && useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/chunks/aa64a_css-fixtures_single-global-special-characters_a%2Bb_styles_global_238bffda.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           } else if (process.env.TURBOPACK && !useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/chunks/aa64a_css-fixtures_single-global-special-characters_a%2Bb_styles_global_238bffda.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           } else if (useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/e6f86e82ed770205.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           } else {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/e6f86e82ed770205.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           }\n         })\n       })\n@@ -194,23 +220,36 @@ module.exports = {\n           const $ = cheerio.load(content)\n \n           const cssSheet = $('link[rel=\"stylesheet\"]')\n-          expect(cssSheet.length).toBe(1)\n-          const stylesheet = cssSheet.attr('href')\n-\n-          const cssContent = (\n-            await fetchViaHTTP(appPort, stylesheet).then((res) => res.text())\n-          )\n-            .replace(/\\/\\*.*?\\*\\//g, '')\n-            .trim()\n+          const cssContent = await getStylesheetContents($, appPort, cssSheet)\n \n           if (process.env.TURBOPACK && useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_single-global-src_styles_global_3de272ac.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           } else if (process.env.TURBOPACK && !useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_single-global-src_styles_global_3de272ac.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           } else if (useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/e6f86e82ed770205.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           } else {\n-            expect(cssContent).toMatchInlineSnapshot(`\".red-text{color:red}\"`)\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/e6f86e82ed770205.css:\n+             .red-text{color:red}\",\n+             ]\n+            `)\n           }\n         })\n       })\n@@ -261,37 +300,42 @@ module.exports = {\n           const $ = cheerio.load(content)\n \n           const cssSheet = $('link[rel=\"stylesheet\"]')\n-          expect(cssSheet.length).toBe(1)\n-          const stylesheet = cssSheet.attr('href')\n-\n-          const cssContent = (\n-            await fetchViaHTTP(appPort, stylesheet).then((res) => res.text())\n-          )\n-            .replace(/\\/\\*.*?\\*\\//g, '')\n-            .trim()\n+          const cssContent = await getStylesheetContents($, appPort, cssSheet)\n \n           if (process.env.TURBOPACK && useLightningcss) {\n             expect(cssContent).toMatchInlineSnapshot(`\n-             \".red-text{color:red}\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_multi-global_styles_e0f6ec64._.css:\n+             .red-text{color:red}\n \n \n-             .blue-text{color:#00f}\"\n+             .blue-text{color:#00f}\",\n+             ]\n             `)\n           } else if (process.env.TURBOPACK && !useLightningcss) {\n             expect(cssContent).toMatchInlineSnapshot(`\n-             \".red-text{color:red}\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_multi-global_styles_e0f6ec64._.css:\n+             .red-text{color:red}\n \n \n-             .blue-text{color:#00f}\"\n+             .blue-text{color:#00f}\",\n+             ]\n             `)\n           } else if (useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(\n-              `\".red-text{color:red}.blue-text{color:#00f}\"`\n-            )\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/5e3a80a101f2afdd.css:\n+             .red-text{color:red}.blue-text{color:#00f}\",\n+             ]\n+            `)\n           } else {\n-            expect(cssContent).toMatchInlineSnapshot(\n-              `\".red-text{color:red}.blue-text{color:blue}\"`\n-            )\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/52172921917299d1.css:\n+             .red-text{color:red}.blue-text{color:blue}\",\n+             ]\n+            `)\n           }\n         })\n       })\n@@ -342,18 +386,13 @@ module.exports = {\n           const $ = cheerio.load(content)\n \n           const cssSheet = $('link[rel=\"stylesheet\"]')\n-          expect(cssSheet.length).toBe(1)\n-          const stylesheet = cssSheet.attr('href')\n-\n-          const cssContent = (\n-            await fetchViaHTTP(appPort, stylesheet).then((res) => res.text())\n-          )\n-            .replace(/\\/\\*.*?\\*\\//g, '')\n-            .trim()\n+          const cssContent = await getStylesheetContents($, appPort, cssSheet)\n \n           if (process.env.TURBOPACK && useLightningcss) {\n             expect(cssContent).toMatchInlineSnapshot(`\n-             \".red-text{color:purple;font-weight:bolder}\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_nested-global_styles_613f73a3._.css:\n+             .red-text{color:purple;font-weight:bolder}\n \n \n              .red-text{color:red}\n@@ -362,11 +401,14 @@ module.exports = {\n              .blue-text{color:orange;font-weight:bolder}\n \n \n-             .blue-text{color:#00f}\"\n+             .blue-text{color:#00f}\",\n+             ]\n             `)\n           } else if (process.env.TURBOPACK && !useLightningcss) {\n             expect(cssContent).toMatchInlineSnapshot(`\n-             \".red-text{color:purple;font-weight:bolder}\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_nested-global_styles_613f73a3._.css:\n+             .red-text{color:purple;font-weight:bolder}\n \n \n              .red-text{color:red}\n@@ -375,16 +417,23 @@ module.exports = {\n              .blue-text{color:orange;font-weight:bolder}\n \n \n-             .blue-text{color:#00f}\"\n+             .blue-text{color:#00f}\",\n+             ]\n             `)\n           } else if (useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(\n-              `\".red-text{color:purple;font-weight:bolder;color:red}.blue-text{color:orange;font-weight:bolder;color:#00f}\"`\n-            )\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/197173a06644483f.css:\n+             .red-text{color:purple;font-weight:bolder;color:red}.blue-text{color:orange;font-weight:bolder;color:#00f}\",\n+             ]\n+            `)\n           } else {\n-            expect(cssContent).toMatchInlineSnapshot(\n-              `\".red-text{color:purple;font-weight:bolder;color:red}.blue-text{color:orange;font-weight:bolder;color:blue}\"`\n-            )\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/5fd4808215677a0f.css:\n+             .red-text{color:purple;font-weight:bolder;color:red}.blue-text{color:orange;font-weight:bolder;color:blue}\",\n+             ]\n+            `)\n           }\n         })\n       })\n@@ -436,37 +485,42 @@ module.exports = {\n           const $ = cheerio.load(content)\n \n           const cssSheet = $('link[rel=\"stylesheet\"]')\n-          expect(cssSheet.length).toBe(1)\n-          const stylesheet = cssSheet.attr('href')\n-\n-          const cssContent = (\n-            await fetchViaHTTP(appPort, stylesheet).then((res) => res.text())\n-          )\n-            .replace(/\\/\\*.*?\\*\\//g, '')\n-            .trim()\n+          const cssContent = await getStylesheetContents($, appPort, cssSheet)\n \n           if (process.env.TURBOPACK && useLightningcss) {\n             expect(cssContent).toMatchInlineSnapshot(`\n-             \".blue-text{color:#00f}\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_multi-global-reversed_styles_9924990c._.css:\n+             .blue-text{color:#00f}\n \n \n-             .red-text{color:red}\"\n+             .red-text{color:red}\",\n+             ]\n             `)\n           } else if (process.env.TURBOPACK && !useLightningcss) {\n             expect(cssContent).toMatchInlineSnapshot(`\n-             \".blue-text{color:#00f}\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_multi-global-reversed_styles_9924990c._.css:\n+             .blue-text{color:#00f}\n \n \n-             .red-text{color:red}\"\n+             .red-text{color:red}\",\n+             ]\n             `)\n           } else if (useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(\n-              `\".blue-text{color:#00f}.red-text{color:red}\"`\n-            )\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/67c5003fc41fdadb.css:\n+             .blue-text{color:#00f}.red-text{color:red}\",\n+             ]\n+            `)\n           } else {\n-            expect(cssContent).toMatchInlineSnapshot(\n-              `\".blue-text{color:blue}.red-text{color:red}\"`\n-            )\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/f06b052da7bb0328.css:\n+             .blue-text{color:blue}.red-text{color:red}\",\n+             ]\n+            `)\n           }\n         })\n       })\n@@ -517,49 +571,46 @@ module.exports = {\n           const $ = cheerio.load(content)\n \n           const cssSheet = $('link[rel=\"stylesheet\"]')\n-          expect(cssSheet.length).toBe(1)\n-          const stylesheet = cssSheet.attr('href')\n-\n-          const cssContent = (\n-            await fetchViaHTTP(appPort, stylesheet).then((res) => res.text())\n-          )\n-            .replace(/\\/\\*.*?\\*\\//g, '')\n-            .trim()\n+          const cssContent = await getStylesheetContents($, appPort, cssSheet)\n \n           if (process.env.TURBOPACK && useLightningcss) {\n             expect(cssContent).toMatchInlineSnapshot(`\n-             \".red-text{color:red;background-image:url(../media/dark.993bedd3.svg) url(../media/dark2.993bedd3.svg)}\n-\n-\n-\n-\n-\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_url-global_styles_global1_69590c47.css:\n+             .red-text{color:red;background-image:url(../media/dark.993bedd3.svg) url(../media/dark2.993bedd3.svg)}\",\n+               \"/_next/static/chunks/test_integration_css-fixtures_url-global_styles_3a258468._.css:\n              .blue-text{color:orange;background-image:url(../media/light.180573e4.svg);font-weight:bolder}\n \n \n-             .blue-text{color:#00f}\"\n+             .blue-text{color:#00f}\",\n+             ]\n             `)\n           } else if (process.env.TURBOPACK && !useLightningcss) {\n             expect(cssContent).toMatchInlineSnapshot(`\n-             \".red-text{color:red;background-image:url(../media/dark.993bedd3.svg) url(../media/dark2.993bedd3.svg)}\n-\n-\n-\n-\n-\n+             [\n+               \"/_next/static/chunks/test_integration_css-fixtures_url-global_styles_global1_69590c47.css:\n+             .red-text{color:red;background-image:url(../media/dark.993bedd3.svg) url(../media/dark2.993bedd3.svg)}\",\n+               \"/_next/static/chunks/test_integration_css-fixtures_url-global_styles_3a258468._.css:\n              .blue-text{color:orange;background-image:url(../media/light.180573e4.svg);font-weight:bolder}\n \n \n-             .blue-text{color:#00f}\"\n+             .blue-text{color:#00f}\",\n+             ]\n             `)\n           } else if (useLightningcss) {\n-            expect(cssContent).toMatchInlineSnapshot(\n-              `\".red-text{color:red;background-image:url(/_next/static/media/dark.6b01655b.svg) url(/_next/static/media/dark2.6b01655b.svg)}.blue-text{color:orange;background-image:url(/_next/static/media/light.2da1d3d6.svg);font-weight:bolder;color:#00f}\"`\n-            )\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/b52d68d7050c7314.css:\n+             .red-text{color:red;background-image:url(/_next/static/media/dark.6b01655b.svg) url(/_next/static/media/dark2.6b01655b.svg)}.blue-text{color:orange;background-image:url(/_next/static/media/light.2da1d3d6.svg);font-weight:bolder;color:#00f}\",\n+             ]\n+            `)\n           } else {\n-            expect(cssContent).toMatchInlineSnapshot(\n-              `\".red-text{color:red;background-image:url(/_next/static/media/dark.6b01655b.svg) url(/_next/static/media/dark2.6b01655b.svg)}.blue-text{color:orange;font-weight:bolder;background-image:url(/_next/static/media/light.2da1d3d6.svg);color:blue}\"`\n-            )\n+            expect(cssContent).toMatchInlineSnapshot(`\n+             [\n+               \"/_next/static/css/766d42b9536ee6bb.css:\n+             .red-text{color:red;background-image:url(/_next/static/media/dark.6b01655b.svg) url(/_next/static/media/dark2.6b01655b.svg)}.blue-text{color:orange;font-weight:bolder;background-image:url(/_next/static/media/light.2da1d3d6.svg);color:blue}\",\n+             ]\n+            `)\n           }\n         })\n       })\n@@ -595,30 +646,27 @@ describe('CSS URL via `file-loader` and asset prefix (1)', () => {\n         const $ = cheerio.load(content)\n \n         const cssSheet = $('link[rel=\"stylesheet\"]')\n-        expect(cssSheet.length).toBe(1)\n-        const stylesheet = cssSheet.attr('href')\n-\n-        const cssContent = (\n-          await fetchViaHTTP(appPort, stylesheet.replace('/foo/', '/')).then(\n-            (res) => res.text()\n-          )\n-        )\n-          .replace(/\\/\\*.*?\\*\\/\\n?/g, '')\n-          .trim()\n+        const cssContent = await getStylesheetContents($, appPort, cssSheet)\n \n         if (process.env.TURBOPACK) {\n           expect(cssContent).toMatchInlineSnapshot(`\n-           \".red-text{color:red;background-image:url(../media/dark.993bedd3.svg) url(../media/dark2.993bedd3.svg)}\n-\n-\n+           [\n+             \"/_next/static/chunks/test_integration_css-fixtures_url-global-asset-prefix-1_styles_global1_64764808.css:\n+           .red-text{color:red;background-image:url(../media/dark.993bedd3.svg) url(../media/dark2.993bedd3.svg)}\",\n+             \"/_next/static/chunks/test_integration_css-fixtures_url-global-asset-prefix-1_styles_0a127993._.css:\n            .blue-text{color:orange;background-image:url(../media/light.180573e4.svg);font-weight:bolder}\n \n-           .blue-text{color:#00f}\"\n+\n+           .blue-text{color:#00f}\",\n+           ]\n           `)\n         } else {\n-          expect(cssContent).toMatchInlineSnapshot(\n-            `\".red-text{color:red;background-image:url(/foo/_next/static/media/dark.6b01655b.svg) url(/foo/_next/static/media/dark2.6b01655b.svg)}.blue-text{color:orange;font-weight:bolder;background-image:url(/foo/_next/static/media/light.2da1d3d6.svg);color:blue}\"`\n-          )\n+          expect(cssContent).toMatchInlineSnapshot(`\n+           [\n+             \"/_next/static/css/18198e5ba4d54f6f.css:\n+           .red-text{color:red;background-image:url(/foo/_next/static/media/dark.6b01655b.svg) url(/foo/_next/static/media/dark2.6b01655b.svg)}.blue-text{color:orange;font-weight:bolder;background-image:url(/foo/_next/static/media/light.2da1d3d6.svg);color:blue}\",\n+           ]\n+          `)\n         }\n       })\n     }\n@@ -653,34 +701,43 @@ describe('CSS URL via `file-loader` and asset prefix (2)', () => {\n         const $ = cheerio.load(content)\n \n         const cssSheet = $('link[rel=\"stylesheet\"]')\n-        expect(cssSheet.length).toBe(1)\n-        const stylesheet = cssSheet.attr('href')\n-\n-        const cssContent = (\n-          await fetchViaHTTP(appPort, stylesheet).then((res) => res.text())\n-        )\n-          .replace(/\\/\\*.*?\\*\\//g, '')\n-          .trim()\n+        const cssContent = await getStylesheetContents($, appPort, cssSheet)\n \n         if (process.env.TURBOPACK) {\n           expect(cssContent).toMatchInlineSnapshot(`\n-           \".red-text{color:red;background-image:url(../media/dark.993bedd3.svg) url(../media/dark2.993bedd3.svg)}\n-\n-\n-\n-\n-\n+           [\n+             \"/_next/static/chunks/test_integration_css-fixtures_url-global-asset-prefix-2_styles_global1_cfbf8de3.css:\n+           .red-text{color:red;background-image:url(../media/dark.993bedd3.svg) url(../media/dark2.993bedd3.svg)}\",\n+             \"/_next/static/chunks/test_integration_css-fixtures_url-global-asset-prefix-2_styles_764eafae._.css:\n            .blue-text{color:orange;background-image:url(../media/light.180573e4.svg);font-weight:bolder}\n \n \n-           .blue-text{color:#00f}\"\n+           .blue-text{color:#00f}\",\n+           ]\n           `)\n         } else {\n-          expect(cssContent).toMatchInlineSnapshot(\n-            `\".red-text{color:red;background-image:url(/foo/_next/static/media/dark.6b01655b.svg) url(/foo/_next/static/media/dark2.6b01655b.svg)}.blue-text{color:orange;font-weight:bolder;background-image:url(/foo/_next/static/media/light.2da1d3d6.svg);color:blue}\"`\n-          )\n+          expect(cssContent).toMatchInlineSnapshot(`\n+           [\n+             \"/_next/static/css/18198e5ba4d54f6f.css:\n+           .red-text{color:red;background-image:url(/foo/_next/static/media/dark.6b01655b.svg) url(/foo/_next/static/media/dark2.6b01655b.svg)}.blue-text{color:orange;font-weight:bolder;background-image:url(/foo/_next/static/media/light.2da1d3d6.svg);color:blue}\",\n+           ]\n+          `)\n         }\n       })\n     }\n   )\n })\n+\n+async function getStylesheetContents($, appPort, items) {\n+  const results = []\n+  for (let i = 0; i < items.length; i++) {\n+    const item = $(items[i])\n+    const href = item.attr('href').replace(/^\\/foo\\//, '/')\n+    const res = await fetchViaHTTP(appPort, href)\n+    if (res.status !== 200)\n+      throw new Error(`Failed to load stylesheet: ${href}`)\n+    const text = await res.text()\n+    results.push(`${href}:\\n${text.replace(/\\/\\*.*?\\*\\//g, '').trim()}`)\n+  }\n+  return results\n+}"
        },
        {
            "sha": "555813ab91f111cadc7f43c52e2ccf9b6ed2b10a",
            "filename": "turbopack/crates/turbopack-css/src/asset.rs",
            "status": "modified",
            "additions": 22,
            "deletions": 8,
            "changes": 30,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fasset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fasset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fasset.rs?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -9,6 +9,7 @@ use turbopack_core::{\n     ident::AssetIdent,\n     module::Module,\n     module_graph::ModuleGraph,\n+    output::OutputAssets,\n     reference::{ModuleReference, ModuleReferences},\n     reference_type::ImportContext,\n     resolve::origin::ResolveOrigin,\n@@ -22,7 +23,9 @@ use crate::{\n         finalize_css, parse_css, process_css_with_placeholder, CssWithPlaceholderResult,\n         FinalCssResult, ParseCss, ParseCssResult, ProcessCss,\n     },\n-    references::{compose::CssModuleComposeReference, import::ImportAssetReference},\n+    references::{\n+        compose::CssModuleComposeReference, import::ImportAssetReference, url::ReferencedAsset,\n+    },\n     CssModuleAssetType,\n };\n \n@@ -95,13 +98,12 @@ impl ProcessCss for CssModuleAsset {\n     #[turbo_tasks::function]\n     fn finalize_css(\n         self: Vc<Self>,\n-        module_graph: Vc<ModuleGraph>,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,\n         minify_type: MinifyType,\n     ) -> Vc<FinalCssResult> {\n         let process_result = self.get_css_with_placeholder();\n \n-        finalize_css(process_result, module_graph, chunking_context, minify_type)\n+        finalize_css(process_result, chunking_context, minify_type)\n     }\n }\n \n@@ -201,6 +203,22 @@ impl ChunkItem for CssModuleChunkItem {\n     fn module(&self) -> Vc<Box<dyn Module>> {\n         Vc::upcast(*self.module)\n     }\n+\n+    #[turbo_tasks::function]\n+    async fn references(&self) -> Result<Vc<OutputAssets>> {\n+        let mut references = Vec::new();\n+        if let ParseCssResult::Ok { url_references, .. } = &*self.module.parse_css().await? {\n+            for (_, reference) in url_references.await? {\n+                if let ReferencedAsset::Some(asset) = *reference\n+                    .get_referenced_asset(*self.chunking_context)\n+                    .await?\n+                {\n+                    references.push(asset);\n+                }\n+            }\n+        }\n+        Ok(Vc::cell(references))\n+    }\n }\n \n #[turbo_tasks::value_impl]\n@@ -280,11 +298,7 @@ impl CssChunkItem for CssModuleChunkItem {\n \n         let result = self\n             .module\n-            .finalize_css(\n-                *self.module_graph,\n-                *chunking_context,\n-                self.module.await?.minify_type,\n-            )\n+            .finalize_css(*chunking_context, self.module.await?.minify_type)\n             .await?;\n \n         if let FinalCssResult::Ok {"
        },
        {
            "sha": "7f422cafe8093dfae2573cda7393cb521136f820",
            "filename": "turbopack/crates/turbopack-css/src/embed.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fembed.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fembed.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fembed.rs?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -1,7 +1,10 @@\n use turbo_tasks::Vc;\n-use turbopack_core::{chunk::ChunkItem, output::OutputAsset};\n+use turbopack_core::{asset::Asset, chunk::ChunkingContext, module::Module, output::OutputAsset};\n \n #[turbo_tasks::value_trait]\n-pub trait CssEmbed: ChunkItem {\n-    fn embedded_asset(self: Vc<Self>) -> Vc<Box<dyn OutputAsset>>;\n+pub trait CssEmbed: Module + Asset {\n+    fn embedded_asset(\n+        self: Vc<Self>,\n+        chunking_context: Vc<Box<dyn ChunkingContext>>,\n+    ) -> Vc<Box<dyn OutputAsset>>;\n }"
        },
        {
            "sha": "441c21dc20154a57f315417a3b3f20c2af8dffcd",
            "filename": "turbopack/crates/turbopack-css/src/process.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fprocess.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fprocess.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fprocess.rs?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -23,7 +23,6 @@ use turbopack_core::{\n         Issue, IssueExt, IssueSource, IssueStage, OptionIssueSource, OptionStyledString,\n         StyledString,\n     },\n-    module_graph::ModuleGraph,\n     reference::ModuleReferences,\n     reference_type::ImportContext,\n     resolve::origin::ResolveOrigin,\n@@ -220,7 +219,6 @@ pub async fn process_css_with_placeholder(\n #[turbo_tasks::function]\n pub async fn finalize_css(\n     result: Vc<CssWithPlaceholderResult>,\n-    module_graph: Vc<ModuleGraph>,\n     chunking_context: Vc<Box<dyn ChunkingContext>>,\n     minify_type: MinifyType,\n ) -> Result<Vc<FinalCssResult>> {\n@@ -247,8 +245,7 @@ pub async fn finalize_css(\n             let mut url_map = FxHashMap::default();\n \n             for (src, reference) in (*url_references.await?).iter() {\n-                let resolved =\n-                    resolve_url_reference(**reference, module_graph, chunking_context).await?;\n+                let resolved = resolve_url_reference(**reference, chunking_context).await?;\n                 if let Some(v) = resolved.as_ref().cloned() {\n                     url_map.insert(RcStr::from(src.as_str()), v);\n                 }\n@@ -286,7 +283,6 @@ pub trait ProcessCss: ParseCss {\n \n     async fn finalize_css(\n         self: Vc<Self>,\n-        module_graph: Vc<ModuleGraph>,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,\n         minify_type: MinifyType,\n     ) -> Result<Vc<FinalCssResult>>;"
        },
        {
            "sha": "decc1fff57836f035f5c5e83bcb3dc8d68aa3f96",
            "filename": "turbopack/crates/turbopack-css/src/references/url.rs",
            "status": "modified",
            "additions": 14,
            "deletions": 26,
            "changes": 40,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Freferences%2Furl.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Freferences%2Furl.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Freferences%2Furl.rs?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -1,19 +1,18 @@\n use std::convert::Infallible;\n \n-use anyhow::{bail, Result};\n+use anyhow::Result;\n use lightningcss::{\n     values::url::Url,\n     visit_types,\n     visitor::{Visit, Visitor},\n };\n use rustc_hash::FxHashMap;\n use turbo_rcstr::RcStr;\n-use turbo_tasks::{debug::ValueDebug, ResolvedVc, Value, ValueToString, Vc};\n+use turbo_tasks::{ResolvedVc, Value, ValueToString, Vc};\n use turbopack_core::{\n-    chunk::{ChunkableModule, ChunkableModuleReference, ChunkingContext},\n+    chunk::{ChunkableModuleReference, ChunkingContext},\n     ident::AssetIdent,\n     issue::IssueSource,\n-    module_graph::ModuleGraph,\n     output::OutputAsset,\n     reference::ModuleReference,\n     reference_type::{ReferenceType, UrlReferenceSubType},\n@@ -52,28 +51,21 @@ impl UrlAssetReference {\n     }\n \n     #[turbo_tasks::function]\n-    async fn get_referenced_asset(\n+    pub async fn get_referenced_asset(\n         self: Vc<Self>,\n-        module_graph: Vc<ModuleGraph>,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,\n     ) -> Result<Vc<ReferencedAsset>> {\n         if let Some(module) = *self.resolve_reference().first_module().await? {\n-            if let Some(chunkable) = ResolvedVc::try_downcast::<Box<dyn ChunkableModule>>(module) {\n-                let chunk_item = chunkable.as_chunk_item(module_graph, chunking_context);\n-                if let Some(embeddable) =\n-                    Vc::try_resolve_downcast::<Box<dyn CssEmbed>>(chunk_item).await?\n-                {\n-                    return Ok(ReferencedAsset::Some(\n-                        embeddable.embedded_asset().to_resolved().await?,\n-                    )\n-                    .into());\n-                }\n+            if let Some(embeddable) = Vc::try_resolve_downcast::<Box<dyn CssEmbed>>(*module).await?\n+            {\n+                return Ok(ReferencedAsset::Some(\n+                    embeddable\n+                        .embedded_asset(chunking_context)\n+                        .to_resolved()\n+                        .await?,\n+                )\n+                .into());\n             }\n-            bail!(\n-                \"A module referenced by a url() reference must be chunkable and the chunk item \\\n-                 must be css embeddable\\nreferenced module: {:?}\",\n-                module.dbg_depth(1).await?\n-            )\n         }\n         Ok(ReferencedAsset::cell(ReferencedAsset::None))\n     }\n@@ -109,7 +101,6 @@ impl ValueToString for UrlAssetReference {\n #[turbo_tasks::function]\n pub async fn resolve_url_reference(\n     url: Vc<UrlAssetReference>,\n-    module_graph: Vc<ModuleGraph>,\n     chunking_context: Vc<Box<dyn ChunkingContext>>,\n ) -> Result<Vc<Option<RcStr>>> {\n     let this = url.await?;\n@@ -121,10 +112,7 @@ pub async fn resolve_url_reference(\n     );\n     let context_path = chunk_path.parent().await?;\n \n-    if let ReferencedAsset::Some(asset) = &*url\n-        .get_referenced_asset(module_graph, chunking_context)\n-        .await?\n-    {\n+    if let ReferencedAsset::Some(asset) = &*url.get_referenced_asset(chunking_context).await? {\n         // TODO(WEB-662) This is not the correct way to get the path of the asset.\n         // `asset` is on module-level, but we need the output-level asset instead.\n         let path = asset.path().await?;"
        },
        {
            "sha": "16f687909c1a833e38b2d373ac8fc57b9c1e836d",
            "filename": "turbopack/crates/turbopack-static/src/css.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 107,
            "changes": 116,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-static%2Fsrc%2Fcss.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-static%2Fsrc%2Fcss.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-static%2Fsrc%2Fcss.rs?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -1,23 +1,14 @@\n-use anyhow::Result;\n use turbo_rcstr::RcStr;\n use turbo_tasks::{ResolvedVc, Vc};\n use turbopack_core::{\n     asset::{Asset, AssetContent},\n-    chunk::{ChunkItem, ChunkType, ChunkableModule, ChunkingContext},\n+    chunk::ChunkingContext,\n     ident::AssetIdent,\n     module::Module,\n-    module_graph::ModuleGraph,\n-    output::{OutputAsset, OutputAssets},\n+    output::OutputAsset,\n     source::Source,\n };\n-use turbopack_css::{\n-    chunk::{CssChunkItem, CssChunkItemContent, CssChunkType},\n-    embed::CssEmbed,\n-};\n-use turbopack_ecmascript::{\n-    chunk::{EcmascriptChunkPlaceable, EcmascriptExports},\n-    utils::StringifyJs,\n-};\n+use turbopack_css::embed::CssEmbed;\n \n use crate::output_asset::StaticOutputAsset;\n \n@@ -65,102 +56,13 @@ impl Asset for StaticUrlCssModule {\n }\n \n #[turbo_tasks::value_impl]\n-impl ChunkableModule for StaticUrlCssModule {\n-    #[turbo_tasks::function]\n-    async fn as_chunk_item(\n-        self: ResolvedVc<Self>,\n-        _module_graph: Vc<ModuleGraph>,\n-        chunking_context: ResolvedVc<Box<dyn ChunkingContext>>,\n-    ) -> Result<Vc<Box<dyn turbopack_core::chunk::ChunkItem>>> {\n-        Ok(Vc::upcast(StaticUrlCssChunkItem::cell(\n-            StaticUrlCssChunkItem {\n-                module: self,\n-                chunking_context,\n-                static_asset: self\n-                    .static_output_asset(*ResolvedVc::upcast(chunking_context))\n-                    .to_resolved()\n-                    .await?,\n-            },\n-        )))\n-    }\n-}\n-\n-#[turbo_tasks::value_impl]\n-impl EcmascriptChunkPlaceable for StaticUrlCssModule {\n-    #[turbo_tasks::function]\n-    fn get_exports(&self) -> Vc<EcmascriptExports> {\n-        EcmascriptExports::Value.into()\n-    }\n-}\n-\n-#[turbo_tasks::value]\n-struct StaticUrlCssChunkItem {\n-    module: ResolvedVc<StaticUrlCssModule>,\n-    chunking_context: ResolvedVc<Box<dyn ChunkingContext>>,\n-    static_asset: ResolvedVc<StaticOutputAsset>,\n-}\n-\n-#[turbo_tasks::value_impl]\n-impl ChunkItem for StaticUrlCssChunkItem {\n-    #[turbo_tasks::function]\n-    fn asset_ident(&self) -> Vc<AssetIdent> {\n-        self.module.ident()\n-    }\n-\n-    #[turbo_tasks::function]\n-    fn references(&self) -> Vc<OutputAssets> {\n-        Vc::cell(vec![ResolvedVc::upcast(self.static_asset)])\n-    }\n-\n-    #[turbo_tasks::function]\n-    fn chunking_context(&self) -> Vc<Box<dyn ChunkingContext>> {\n-        *ResolvedVc::upcast(self.chunking_context)\n-    }\n-\n-    #[turbo_tasks::function]\n-    async fn ty(&self) -> Result<Vc<Box<dyn ChunkType>>> {\n-        Ok(Vc::upcast(Vc::<CssChunkType>::default().resolve().await?))\n-    }\n-\n-    #[turbo_tasks::function]\n-    fn module(&self) -> Vc<Box<dyn Module>> {\n-        *ResolvedVc::upcast(self.module)\n-    }\n-}\n-\n-#[turbo_tasks::value_impl]\n-impl CssChunkItem for StaticUrlCssChunkItem {\n-    #[turbo_tasks::function]\n-    fn chunking_context(&self) -> Vc<Box<dyn ChunkingContext>> {\n-        *self.chunking_context\n-    }\n-\n-    #[turbo_tasks::function]\n-    async fn content(&self) -> Result<Vc<CssChunkItemContent>> {\n-        Ok(CssChunkItemContent {\n-            import_context: None,\n-            imports: Vec::new(),\n-            source_map: None,\n-            inner_code: format!(\n-                \"/* embedded static asset {path} */\",\n-                path = StringifyJs(\n-                    &self\n-                        .chunking_context\n-                        .asset_url(self.static_asset.path())\n-                        .await?\n-                )\n-            )\n-            .into(),\n-        }\n-        .into())\n-    }\n-}\n-\n-#[turbo_tasks::value_impl]\n-impl CssEmbed for StaticUrlCssChunkItem {\n+impl CssEmbed for StaticUrlCssModule {\n     #[turbo_tasks::function]\n-    fn embedded_asset(&self) -> Vc<Box<dyn OutputAsset>> {\n-        *ResolvedVc::upcast(self.static_asset)\n+    fn embedded_asset(\n+        self: Vc<Self>,\n+        chunking_context: Vc<Box<dyn ChunkingContext>>,\n+    ) -> Vc<Box<dyn OutputAsset>> {\n+        Vc::upcast(self.static_output_asset(chunking_context))\n     }\n }\n "
        },
        {
            "sha": "d22048308bc2db6c38ad2d854e2591b15d8d4cea",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_image_png_ba3284f5._.single.css",
            "status": "removed",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/fc03ca7dbf588a72753e37e81d6065bb6e97b8c5/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_image_png_ba3284f5._.single.css",
            "raw_url": "https://github.com/vercel/next.js/raw/fc03ca7dbf588a72753e37e81d6065bb6e97b8c5/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_image_png_ba3284f5._.single.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_image_png_ba3284f5._.single.css?ref=fc03ca7dbf588a72753e37e81d6065bb6e97b8c5",
            "patch": "@@ -1,2 +0,0 @@\n-/* [project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/image.png (static in css) */\n-/* embedded static asset \"/static/image.b151aca5.png\" */\n\\ No newline at end of file"
        },
        {
            "sha": "f6b70bda726195bddc7e2de07fe777c409f6bc57",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_a007acd1.js",
            "status": "added",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_a007acd1.js",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_a007acd1.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_a007acd1.js?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -0,0 +1,6 @@\n+(globalThis.TURBOPACK = globalThis.TURBOPACK || []).push([\n+    \"output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_a007acd1.js\",\n+    {},\n+    {\"otherChunks\":[{\"path\":\"output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css\",\"included\":[\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.module.css [test] (css)\",\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.css [test] (css)\"],\"moduleChunks\":[\"output/b1abf_turbopack-tests_tests_snapshot_css_embed-url_input_style_module_css_b7298ed4._.single.css\",\"output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_style_css_b7298ed4._.single.css\"]},\"output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js\",\"output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_4242144a._.js\"],\"runtimeModuleIds\":[\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/index.js [test] (ecmascript)\"]}\n+]);\n+// Dummy runtime\n\\ No newline at end of file"
        },
        {
            "sha": "c15d7ec00382d3604310ddb8b53cbdb90d9e1942",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_a007acd1.js.map",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_a007acd1.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_a007acd1.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_a007acd1.js.map?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "previous_filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_image_png_ba3284f5._.single.css.map"
        },
        {
            "sha": "eff430fa017c3bd5b579d8c8b552769d9e781345",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_effff57f.js",
            "status": "removed",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/fc03ca7dbf588a72753e37e81d6065bb6e97b8c5/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_effff57f.js",
            "raw_url": "https://github.com/vercel/next.js/raw/fc03ca7dbf588a72753e37e81d6065bb6e97b8c5/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_effff57f.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2F4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_effff57f.js?ref=fc03ca7dbf588a72753e37e81d6065bb6e97b8c5",
            "patch": "@@ -1,6 +0,0 @@\n-(globalThis.TURBOPACK = globalThis.TURBOPACK || []).push([\n-    \"output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_effff57f.js\",\n-    {},\n-    {\"otherChunks\":[{\"path\":\"output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_14a7ded7._.css\",\"included\":[\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/image.png (static in css)\",\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.module.css [test] (css)\",\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.css [test] (css)\"],\"moduleChunks\":[\"output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_image_png_ba3284f5._.single.css\",\"output/b1abf_turbopack-tests_tests_snapshot_css_embed-url_input_style_module_css_b7298ed4._.single.css\",\"output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_style_css_b7298ed4._.single.css\"]},\"output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_39fdb40e._.js\",\"output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_4242144a._.js\"],\"runtimeModuleIds\":[\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/index.js [test] (ecmascript)\"]}\n-]);\n-// Dummy runtime\n\\ No newline at end of file"
        },
        {
            "sha": "29c96001a0c574bfa6afef350f6244be4afd358f",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css",
            "status": "renamed",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -1,10 +1,7 @@\n-/* [project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/image.png (static in css) */\n-/* embedded static asset \"/static/image.b151aca5.png\" */\n-\n /* [project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.module.css [test] (css) */\n .style-module__3oVw9q__module-style{cursor:url(../static/image.b151aca5.png);background-image:url(../static/image.b151aca5.png);list-style-image:url(../static/image.b151aca5.png)}\n \n /* [project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.css [test] (css) */\n .style{cursor:url(../static/image.b151aca5.png);background-image:url(../static/image.b151aca5.png);list-style-image:url(../static/image.b151aca5.png)}\n \n-/*# sourceMappingURL=turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_14a7ded7._.css.map*/\n\\ No newline at end of file\n+/*# sourceMappingURL=turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css.map*/\n\\ No newline at end of file",
            "previous_filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_14a7ded7._.css"
        },
        {
            "sha": "3bec2a24d6cab9c03dc16370a4e1876d4362b589",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css.map",
            "status": "renamed",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css.map",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_00f6db8e._.css.map?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -2,8 +2,8 @@\n   \"version\": 3,\n   \"sources\": [],\n   \"sections\": [\n-    {\"offset\": {\"line\": 4, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.module.css\"],\"sourcesContent\":[\".module-style {\\n  cursor: url(./image.png);\\n  list-style-image: url(image.png);\\n  background-image: url(\\\"./image.png\\\");\\n}\\n\\n\"],\"names\":[],\"mappings\":\"AAAA\"}},\n-    {\"offset\": {\"line\": 4, \"column\": 179}, \"map\": {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"A\"}},\n-    {\"offset\": {\"line\": 7, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.css\"],\"sourcesContent\":[\".style {\\n  cursor: url(./image.png);\\n  list-style-image: url(image.png);\\n  background-image: url(\\\"image.png\\\");\\n}\\n\\n\"],\"names\":[],\"mappings\":\"AAAA\"}},\n-    {\"offset\": {\"line\": 7, \"column\": 150}, \"map\": {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"A\"}}]\n+    {\"offset\": {\"line\": 1, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.module.css\"],\"sourcesContent\":[\".module-style {\\n  cursor: url(./image.png);\\n  list-style-image: url(image.png);\\n  background-image: url(\\\"./image.png\\\");\\n}\\n\\n\"],\"names\":[],\"mappings\":\"AAAA\"}},\n+    {\"offset\": {\"line\": 1, \"column\": 179}, \"map\": {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"A\"}},\n+    {\"offset\": {\"line\": 4, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.css\"],\"sourcesContent\":[\".style {\\n  cursor: url(./image.png);\\n  list-style-image: url(image.png);\\n  background-image: url(\\\"image.png\\\");\\n}\\n\\n\"],\"names\":[],\"mappings\":\"AAAA\"}},\n+    {\"offset\": {\"line\": 4, \"column\": 150}, \"map\": {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"A\"}}]\n }\n\\ No newline at end of file",
            "previous_filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_14a7ded7._.css.map"
        },
        {
            "sha": "c15d7ec00382d3604310ddb8b53cbdb90d9e1942",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_39fdb40e._.js.map",
            "status": "removed",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/fc03ca7dbf588a72753e37e81d6065bb6e97b8c5/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_39fdb40e._.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/fc03ca7dbf588a72753e37e81d6065bb6e97b8c5/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_39fdb40e._.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_39fdb40e._.js.map?ref=fc03ca7dbf588a72753e37e81d6065bb6e97b8c5",
            "patch": "@@ -1,5 +0,0 @@\n-{\n-  \"version\": 3,\n-  \"sources\": [],\n-  \"sections\": []\n-}\n\\ No newline at end of file"
        },
        {
            "sha": "d600adcb5b19587cf6c82e1fb54f9fec0b224a61",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "patch": "@@ -1,4 +1,4 @@\n-(globalThis.TURBOPACK = globalThis.TURBOPACK || []).push([\"output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_39fdb40e._.js\", {\n+(globalThis.TURBOPACK = globalThis.TURBOPACK || []).push([\"output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js\", {\n \n \"[project]/turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/input/style.module.css [test] (css module, async loader)\": ((__turbopack_context__) => {\n ",
            "previous_filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_39fdb40e._.js"
        },
        {
            "sha": "c15d7ec00382d3604310ddb8b53cbdb90d9e1942",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/turbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js.map",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/7b301075c207427868da2b126ceb4d3229a00978/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcss%2Fembed-url%2Foutput%2Fturbopack_crates_turbopack-tests_tests_snapshot_css_embed-url_input_e139c187._.js.map?ref=7b301075c207427868da2b126ceb4d3229a00978",
            "previous_filename": "turbopack/crates/turbopack-tests/tests/snapshot/css/embed-url/output/4e721_crates_turbopack-tests_tests_snapshot_css_embed-url_input_index_effff57f.js.map"
        }
    ],
    "stats": {
        "total": 598,
        "additions": 274,
        "deletions": 324
    }
}