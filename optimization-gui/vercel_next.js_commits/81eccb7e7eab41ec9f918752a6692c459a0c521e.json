{
    "author": "shuding",
    "message": "Release unnecessary memory on hydration finish (#84967)\n\nClear global data array to release memory after server data is flushed.\n\nFor large apps we found that up to megabytes of data only used by\nhydration can be held by `window.__next_f` for the entire session.",
    "sha": "81eccb7e7eab41ec9f918752a6692c459a0c521e",
    "files": [
        {
            "sha": "aeef8bda32587020a69d7eb4fba4b6c5507a6fe6",
            "filename": "packages/next/src/client/app-index.tsx",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/81eccb7e7eab41ec9f918752a6692c459a0c521e/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/81eccb7e7eab41ec9f918752a6692c459a0c521e/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx?ref=81eccb7e7eab41ec9f918752a6692c459a0c521e",
            "patch": "@@ -155,7 +155,13 @@ if (document.readyState === 'loading') {\n }\n \n const nextServerDataLoadingGlobal = (self.__next_f = self.__next_f || [])\n+\n+// Consume all buffered chunks and clear the global data array right after to release memory.\n+// Otherwise it will be retained indefinitely.\n nextServerDataLoadingGlobal.forEach(nextServerDataCallback)\n+nextServerDataLoadingGlobal.length = 0\n+\n+// Patch its push method so subsequent chunks are handled (but not actually pushed to the array).\n nextServerDataLoadingGlobal.push = nextServerDataCallback\n \n const readable = new ReadableStream({"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
    }
}