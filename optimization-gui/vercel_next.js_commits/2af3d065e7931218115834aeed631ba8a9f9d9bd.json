{
    "author": "mischnic",
    "message": "Turbopack: split up server actions modules for better treeshaking (#76877)\n\nCloses PACK-4074\r\n\r\nWe really need to look into getting e2e tests for correct sourcemaps: PACK-4142\r\n\r\nFix Turbopack server action tree shaking by explicitly splitting up that module\r\n\r\n```js\r\n/* __next_internal_action_entry_do_not_use__ {\"00c18c215a6b7cdc64bf709f3a714ffdef1bf9651d\":\"default\",\"70e10665baac148856374b2789aceb970f66fec33e\":\"myAction\"} */ import { createServerReference, callServer, findSourceMapURL } from \"private-next-rsc-action-client-wrapper\";\r\nexport var foo = /*#__PURE__*/ createServerReference(\"70e10665baac148856374b2789aceb970f66fec33e\", callServer, void 0, findSourceMapURL, \"myAction\");\r\nexport var bar = /*#__PURE__*/ createServerReference(\"00c18c215a6b7cdc64bf709f3a714ffdef1bf9651d\", callServer, void 0, findSourceMapURL, \"default\");\r\n```\r\n->\r\n```js\r\n\"use turbopack no side effects\";\r\nexport { foo } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%7B%2200ab21efdafbe611287bc25c0462b1e0510d13e48b%22%3A%22foo%22%7D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20foo%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%2200ab21efdafbe611287bc25c0462b1e0510d13e48b%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22foo%22%29%3B\";\r\nexport { bar } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%7B%2200ac840dcaf5e8197cb02b7f3a43c119b7a770b272%22%3A%22bar%22%7D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20bar%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%2200ac840dcaf5e8197cb02b7f3a43c119b7a770b272%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22bar%22%29%3B\";\r\n````\r\n\r\n- [x] Keep [sourcemaps](https://github.com/vercel/next.js/blob/canary/test/development/app-dir/source-mapping/README.md#server-actions)",
    "sha": "2af3d065e7931218115834aeed631ba8a9f9d9bd",
    "files": [
        {
            "sha": "abc0c60236436c7868a4a951622b3015f14c7d66",
            "filename": "Cargo.lock",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/Cargo.lock",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/Cargo.lock",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.lock?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -4529,6 +4529,7 @@ name = \"next-custom-transforms\"\n version = \"0.0.0\"\n dependencies = [\n  \"anyhow\",\n+ \"base64 0.21.4\",\n  \"chrono\",\n  \"dashmap 6.1.0\",\n  \"easy-error\",\n@@ -4558,6 +4559,7 @@ dependencies = [\n  \"tracing\",\n  \"turbo-rcstr\",\n  \"turbopack-ecmascript-plugins\",\n+ \"urlencoding\",\n  \"walkdir\",\n ]\n "
        },
        {
            "sha": "b8b2083eb79d74bbada81a853f8348eb9c6bd944",
            "filename": "crates/napi/src/next_api/project.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -1287,7 +1287,7 @@ pub async fn get_source_map_rope(\n     }\n \n     if map.await?.is_none() {\n-        bail!(\"chunk/module is missing a sourcemap\");\n+        bail!(\"chunk/module '{}' is missing a sourcemap\", file_path);\n     }\n \n     Ok(Some(map))"
        },
        {
            "sha": "81766e38d3e62e403e07d9f37a40fc281cc305b2",
            "filename": "crates/next-api/src/module_graph.rs",
            "status": "modified",
            "additions": 10,
            "deletions": 3,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-api%2Fsrc%2Fmodule_graph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-api%2Fsrc%2Fmodule_graph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fmodule_graph.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -225,10 +225,11 @@ impl ServerActionsGraph {\n             let actions = data\n                 .iter()\n                 .map(|(module, (layer, actions))| async move {\n+                    let actions = actions.await?;\n                     actions\n-                        .await?\n+                        .actions\n                         .iter()\n-                        .map(|(hash, name)| async move {\n+                        .map(async |(hash, name)| {\n                             Ok((\n                                 hash.to_string(),\n                                 (\n@@ -237,7 +238,13 @@ impl ServerActionsGraph {\n                                     if *layer == ActionLayer::Rsc {\n                                         *module\n                                     } else {\n-                                        to_rsc_context(**module, rsc_asset_context).await?\n+                                        to_rsc_context(\n+                                            **module,\n+                                            &actions.entry_path,\n+                                            &actions.entry_query,\n+                                            rsc_asset_context,\n+                                        )\n+                                        .await?\n                                     },\n                                 ),\n                             ))"
        },
        {
            "sha": "60762702402a790fb3391a800993eb68b40f37f4",
            "filename": "crates/next-api/src/server_actions.rs",
            "status": "modified",
            "additions": 28,
            "deletions": 7,
            "changes": 35,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-api%2Fsrc%2Fserver_actions.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-api%2Fsrc%2Fserver_actions.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fserver_actions.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -203,10 +203,18 @@ async fn build_manifest(\n /// The ActionBrowser layer's module is in the Client context, and we need to\n /// bring it into the RSC context.\n pub async fn to_rsc_context(\n-    module: Vc<Box<dyn Module>>,\n+    client_module: Vc<Box<dyn Module>>,\n+    entry_path: &str,\n+    entry_query: &str,\n     asset_context: Vc<Box<dyn AssetContext>>,\n ) -> Result<ResolvedVc<Box<dyn Module>>> {\n-    let source = FileSource::new_with_query(module.ident().path(), module.ident().query());\n+    // TODO a cleaner solution would something similar to the EcmascriptClientReferenceModule, as\n+    // opposed to the following hack to construct the RSC module corresponding to this client\n+    // module.\n+    let source = FileSource::new_with_query(\n+        client_module.ident().path().root().join(entry_path.into()),\n+        Vc::cell(entry_query.into()),\n+    );\n     let module = asset_context\n         .process(\n             Vc::upcast(source),\n@@ -227,7 +235,7 @@ pub async fn to_rsc_context(\n pub fn parse_server_actions(\n     program: &Program,\n     comments: &dyn Comments,\n-) -> Option<BTreeMap<String, String>> {\n+) -> Option<(BTreeMap<String, String>, String, String)> {\n     let byte_pos = match program {\n         Program::Module(m) => m.span.lo,\n         Program::Script(s) => s.span.lo,\n@@ -273,7 +281,8 @@ async fn parse_actions(module: Vc<Box<dyn Module>>) -> Result<Vc<OptionActionMap\n         return Ok(Vc::cell(None));\n     };\n \n-    let Some(mut actions) = parse_server_actions(original, comments) else {\n+    let Some((mut actions, entry_path, entry_query)) = parse_server_actions(original, comments)\n+    else {\n         return Ok(Vc::cell(None));\n     };\n \n@@ -294,7 +303,14 @@ async fn parse_actions(module: Vc<Box<dyn Module>>) -> Result<Vc<OptionActionMap\n \n     let mut actions = FxIndexMap::from_iter(actions.into_iter());\n     actions.sort_keys();\n-    Ok(Vc::cell(Some(ResolvedVc::cell(actions))))\n+    Ok(Vc::cell(Some(\n+        ActionMap {\n+            actions,\n+            entry_path,\n+            entry_query,\n+        }\n+        .resolved_cell(),\n+    )))\n }\n \n fn all_export_names(program: &Program) -> Vec<Atom> {\n@@ -395,8 +411,13 @@ impl AllActions {\n }\n \n /// Maps the hashed action id to the action's exported function name.\n-#[turbo_tasks::value(transparent)]\n-pub struct ActionMap(FxIndexMap<String, String>);\n+#[turbo_tasks::value]\n+#[derive(Debug)]\n+pub struct ActionMap {\n+    pub actions: FxIndexMap<String, String>,\n+    pub entry_path: String,\n+    pub entry_query: String,\n+}\n \n /// An Option wrapper around [ActionMap].\n #[turbo_tasks::value(transparent)]"
        },
        {
            "sha": "b4f085dec56a14398c0c6cb6d168742fde60f29f",
            "filename": "crates/next-core/src/next_shared/transforms/mod.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fmod.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -86,13 +86,16 @@ fn match_js_extension(enable_mdx_rs: bool) -> Vec<RuleCondition> {\n         RuleCondition::ResourcePathEndsWith(\".tsx\".to_string()),\n         RuleCondition::ResourcePathEndsWith(\".mjs\".to_string()),\n         RuleCondition::ResourcePathEndsWith(\".cjs\".to_string()),\n+        RuleCondition::ContentTypeStartsWith(\"application/javascript\".to_string()),\n+        RuleCondition::ContentTypeStartsWith(\"text/javascript\".to_string()),\n     ];\n \n     if enable_mdx_rs {\n         conditions.append(\n             vec![\n                 RuleCondition::ResourcePathEndsWith(\".md\".to_string()),\n                 RuleCondition::ResourcePathEndsWith(\".mdx\".to_string()),\n+                RuleCondition::ContentTypeStartsWith(\"text/markdown\".to_string()),\n             ]\n             .as_mut(),\n         );"
        },
        {
            "sha": "40453845d617feedb6d56844040ec954f7ed857a",
            "filename": "crates/next-core/src/next_shared/transforms/server_actions.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fserver_actions.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fserver_actions.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fserver_actions.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -1,6 +1,8 @@\n use anyhow::Result;\n use async_trait::async_trait;\n-use next_custom_transforms::transforms::server_actions::{server_actions, Config};\n+use next_custom_transforms::transforms::server_actions::{\n+    server_actions, Config, ServerActionsMode,\n+};\n use swc_core::{common::FileName, ecma::ast::Program};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{ResolvedVc, Vc};\n@@ -12,7 +14,9 @@ use crate::{mode::NextMode, next_config::CacheKinds};\n \n #[derive(Debug)]\n pub enum ActionsTransform {\n+    /// Browser and SSR\n     Client,\n+    /// RSC Server\n     Server,\n }\n \n@@ -57,6 +61,7 @@ impl CustomTransformer for NextServerActions {\n     async fn transform(&self, program: &mut Program, ctx: &TransformContext<'_>) -> Result<()> {\n         let actions = server_actions(\n             &FileName::Real(ctx.file_path_str.into()),\n+            Some(ctx.query_str.clone()),\n             Config {\n                 is_react_server_layer: matches!(self.transform, ActionsTransform::Server),\n                 is_development: self.mode.is_development(),\n@@ -65,7 +70,9 @@ impl CustomTransformer for NextServerActions {\n                 cache_kinds: self.cache_kinds.owned().await?,\n             },\n             ctx.comments.clone(),\n+            ctx.source_map.clone(),\n             Default::default(),\n+            ServerActionsMode::Turbopack,\n         );\n         program.mutate(actions);\n         Ok(())"
        },
        {
            "sha": "d4101188c9982ad0d2796d19d7d9e8fdacbb0f48",
            "filename": "crates/next-custom-transforms/Cargo.toml",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2FCargo.toml?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -14,6 +14,7 @@ plugin = [\n workspace = true\n \n [dependencies]\n+base64 = \"0.21.0\"\n chrono = \"0.4\"\n easy-error = \"1.0.0\"\n either = \"1\"\n@@ -38,6 +39,7 @@ swc_core = { workspace = true, features = [\n   \"cached\",\n   \"common_concurrent\",\n   \"ecma_ast\",\n+  \"ecma_codegen\",\n   \"ecma_loader_lru\",\n   \"ecma_loader_node\",\n   \"ecma_minifier\",\n@@ -59,6 +61,7 @@ swc_emotion = { workspace = true }\n swc_relay = { workspace = true }\n turbopack-ecmascript-plugins = { workspace = true, optional = true }\n turbo-rcstr = { workspace = true }\n+urlencoding = { workspace = true }\n \n react_remove_properties = \"0.33.0\"\n remove_console = \"0.34.0\""
        },
        {
            "sha": "7424596f5f66eebcc18204c9f07da87adcfebff1",
            "filename": "crates/next-custom-transforms/src/chain_transforms.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Fsrc%2Fchain_transforms.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Fsrc%2Fchain_transforms.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Fsrc%2Fchain_transforms.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -27,6 +27,7 @@ use crate::{\n         fonts::next_font_loaders,\n         lint_codemod_comments::lint_codemod_comments,\n         react_server_components,\n+        server_actions::ServerActionsMode,\n     },\n };\n \n@@ -323,9 +324,12 @@ where\n             match &opts.server_actions {\n                 Some(config) => Either::Left(crate::transforms::server_actions::server_actions(\n                     &file.name,\n+                    None,\n                     config.clone(),\n                     comments.clone(),\n+                    cm.clone(),\n                     use_cache_telemetry_tracker,\n+                    ServerActionsMode::Webpack,\n                 )),\n                 None => Either::Right(noop_pass()),\n             },"
        },
        {
            "sha": "5dabf880215f50db6ba2739683b748c33b7b3a4a",
            "filename": "crates/next-custom-transforms/src/transforms/server_actions.rs",
            "status": "modified",
            "additions": 264,
            "deletions": 58,
            "changes": 322,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Fserver_actions.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Fserver_actions.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Fserver_actions.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -3,32 +3,45 @@ use std::{\n     collections::{hash_map, BTreeMap},\n     convert::{TryFrom, TryInto},\n     mem::{replace, take},\n+    path::{Path, PathBuf},\n     rc::Rc,\n+    sync::Arc,\n };\n \n+use base64::{display::Base64Display, prelude::BASE64_STANDARD};\n use hex::encode as hex_encode;\n use indoc::formatdoc;\n+use pathdiff::diff_paths;\n use rustc_hash::{FxHashMap, FxHashSet};\n use serde::Deserialize;\n use sha1::{Digest, Sha1};\n use swc_core::{\n-    atoms::Atom,\n+    atoms::{atom, Atom},\n     common::{\n-        comments::{Comment, CommentKind, Comments},\n+        comments::{Comment, CommentKind, Comments, SingleThreadedComments},\n         errors::HANDLER,\n-        source_map::PURE_SP,\n+        source_map::{SourceMapGenConfig, PURE_SP},\n         util::take::Take,\n-        BytePos, FileName, Mark, Span, SyntaxContext, DUMMY_SP,\n+        BytePos, FileName, Mark, SourceMap, Span, SyntaxContext, DUMMY_SP,\n     },\n     ecma::{\n         ast::*,\n+        codegen::{self, text_writer::JsWriter, Emitter},\n         utils::{private_ident, quote_ident, ExprFactory},\n         visit::{noop_visit_mut_type, visit_mut_pass, VisitMut, VisitMutWith},\n     },\n     quote,\n };\n use turbo_rcstr::RcStr;\n \n+use crate::FxIndexMap;\n+\n+#[derive(Clone, Copy, Debug, Deserialize)]\n+pub enum ServerActionsMode {\n+    Webpack,\n+    Turbopack,\n+}\n+\n #[derive(Clone, Debug, Deserialize)]\n #[serde(deny_unknown_fields, rename_all = \"camelCase\")]\n pub struct Config {\n@@ -124,14 +137,20 @@ pub type ActionsMap = BTreeMap<Atom, Atom>;\n #[tracing::instrument(level = tracing::Level::TRACE, skip_all)]\n pub fn server_actions<C: Comments>(\n     file_name: &FileName,\n+    file_query: Option<RcStr>,\n     config: Config,\n     comments: C,\n+    cm: Arc<SourceMap>,\n     use_cache_telemetry_tracker: Rc<RefCell<FxHashMap<String, usize>>>,\n+    mode: ServerActionsMode,\n ) -> impl Pass {\n     visit_mut_pass(ServerActions {\n         config,\n+        mode,\n         comments,\n+        cm,\n         file_name: file_name.to_string(),\n+        file_query,\n         start_pos: BytePos(0),\n         file_directive: None,\n         in_exported_expr: false,\n@@ -172,18 +191,29 @@ pub fn server_actions<C: Comments>(\n \n /// Serializes the Server Actions into a magic comment prefixed by\n /// `__next_internal_action_entry_do_not_use__`.\n-fn generate_server_actions_comment(actions: ActionsMap) -> String {\n+fn generate_server_actions_comment(\n+    actions: &ActionsMap,\n+    entry_path_query: Option<(&str, &str)>,\n+) -> String {\n     format!(\n         \" __next_internal_action_entry_do_not_use__ {} \",\n-        serde_json::to_string(&actions).unwrap()\n+        if let Some(entry_path_query) = entry_path_query {\n+            serde_json::to_string(&(actions, entry_path_query.0, entry_path_query.1))\n+        } else {\n+            serde_json::to_string(&actions)\n+        }\n+        .unwrap()\n     )\n }\n \n struct ServerActions<C: Comments> {\n     #[allow(unused)]\n     config: Config,\n     file_name: String,\n+    file_query: Option<RcStr>,\n     comments: C,\n+    cm: Arc<SourceMap>,\n+    mode: ServerActionsMode,\n \n     start_pos: BytePos,\n     file_directive: Option<Directive>,\n@@ -1805,46 +1835,49 @@ impl<C: Comments> VisitMut for ServerActions<C> {\n         let call_server_ident = private_ident!(\"callServer\");\n         let find_source_map_url_ident = private_ident!(\"findSourceMapURL\");\n \n-        if (self.has_action || self.has_cache) && !self.config.is_react_server_layer {\n-            // import {\n-            //   createServerReference,\n-            //   callServer,\n-            //   findSourceMapURL\n-            // } from 'private-next-rsc-action-client-wrapper'\n-            // createServerReference(\"action_id\")\n-            new.push(ModuleItem::ModuleDecl(ModuleDecl::Import(ImportDecl {\n-                span: DUMMY_SP,\n-                specifiers: vec![\n-                    ImportSpecifier::Named(ImportNamedSpecifier {\n-                        span: DUMMY_SP,\n-                        local: create_ref_ident.clone(),\n-                        imported: None,\n-                        is_type_only: false,\n-                    }),\n-                    ImportSpecifier::Named(ImportNamedSpecifier {\n-                        span: DUMMY_SP,\n-                        local: call_server_ident.clone(),\n-                        imported: None,\n-                        is_type_only: false,\n-                    }),\n-                    ImportSpecifier::Named(ImportNamedSpecifier {\n+        let client_layer_import = ((self.has_action || self.has_cache)\n+            && !self.config.is_react_server_layer)\n+            .then(|| {\n+                // import {\n+                //   createServerReference,\n+                //   callServer,\n+                //   findSourceMapURL\n+                // } from 'private-next-rsc-action-client-wrapper'\n+                // createServerReference(\"action_id\")\n+                ModuleItem::ModuleDecl(ModuleDecl::Import(ImportDecl {\n+                    span: DUMMY_SP,\n+                    specifiers: vec![\n+                        ImportSpecifier::Named(ImportNamedSpecifier {\n+                            span: DUMMY_SP,\n+                            local: create_ref_ident.clone(),\n+                            imported: None,\n+                            is_type_only: false,\n+                        }),\n+                        ImportSpecifier::Named(ImportNamedSpecifier {\n+                            span: DUMMY_SP,\n+                            local: call_server_ident.clone(),\n+                            imported: None,\n+                            is_type_only: false,\n+                        }),\n+                        ImportSpecifier::Named(ImportNamedSpecifier {\n+                            span: DUMMY_SP,\n+                            local: find_source_map_url_ident.clone(),\n+                            imported: None,\n+                            is_type_only: false,\n+                        }),\n+                    ],\n+                    src: Box::new(Str {\n                         span: DUMMY_SP,\n-                        local: find_source_map_url_ident.clone(),\n-                        imported: None,\n-                        is_type_only: false,\n+                        value: \"private-next-rsc-action-client-wrapper\".into(),\n+                        raw: None,\n                     }),\n-                ],\n-                src: Box::new(Str {\n-                    span: DUMMY_SP,\n-                    value: \"private-next-rsc-action-client-wrapper\".into(),\n-                    raw: None,\n-                }),\n-                type_only: false,\n-                with: None,\n-                phase: Default::default(),\n-            })));\n-            new.rotate_right(1);\n-        }\n+                    type_only: false,\n+                    with: None,\n+                    phase: Default::default(),\n+                }))\n+            });\n+\n+        let mut client_layer_exports = FxIndexMap::default();\n \n         // If it's a \"use server\" or a \"use cache\" file, all exports need to be annotated.\n         if should_track_exports {\n@@ -1881,7 +1914,8 @@ impl<C: Comments> VisitMut for ServerActions<C> {\n                                 })),\n                             },\n                         ));\n-                        new.push(export_expr);\n+                        client_layer_exports\n+                            .insert(atom!(\"default\"), (export_expr, ref_id.clone()));\n                     } else {\n                         let export_expr =\n                             ModuleItem::ModuleDecl(ModuleDecl::ExportDecl(ExportDecl {\n@@ -1928,7 +1962,8 @@ impl<C: Comments> VisitMut for ServerActions<C> {\n                                     ..Default::default()\n                                 })),\n                             }));\n-                        new.push(export_expr);\n+                        client_layer_exports\n+                            .insert(export_name.clone(), (export_expr, ref_id.clone()));\n                     }\n                 } else if !in_cache_file {\n                     self.annotations.push(Stmt::Expr(ExprStmt {\n@@ -2003,18 +2038,6 @@ impl<C: Comments> VisitMut for ServerActions<C> {\n             }\n         }\n \n-        if self.has_action || self.has_cache {\n-            // Prepend a special comment to the top of the file.\n-            self.comments.add_leading(\n-                self.start_pos,\n-                Comment {\n-                    span: DUMMY_SP,\n-                    kind: CommentKind::Block,\n-                    text: generate_server_actions_comment(actions).into(),\n-                },\n-            );\n-        }\n-\n         // import { cache as $$cache__ } from \"private-next-rsc-cache-wrapper\";\n         if self.has_cache && self.config.is_react_server_layer {\n             new.push(ModuleItem::ModuleDecl(ModuleDecl::Import(ImportDecl {\n@@ -2093,6 +2116,98 @@ impl<C: Comments> VisitMut for ServerActions<C> {\n             new.rotate_right(2);\n         }\n \n+        if self.has_action || self.has_cache {\n+            if self.config.is_react_server_layer {\n+                // Prepend a special comment to the top of the file.\n+                self.comments.add_leading(\n+                    self.start_pos,\n+                    Comment {\n+                        span: DUMMY_SP,\n+                        kind: CommentKind::Block,\n+                        text: generate_server_actions_comment(\n+                            &actions,\n+                            match self.mode {\n+                                ServerActionsMode::Webpack => None,\n+                                ServerActionsMode::Turbopack => Some((\"\", \"\")),\n+                            },\n+                        )\n+                        .into(),\n+                    },\n+                );\n+            } else {\n+                match self.mode {\n+                    ServerActionsMode::Webpack => {\n+                        self.comments.add_leading(\n+                            self.start_pos,\n+                            Comment {\n+                                span: DUMMY_SP,\n+                                kind: CommentKind::Block,\n+                                text: generate_server_actions_comment(&actions, None).into(),\n+                            },\n+                        );\n+                        new.push(client_layer_import.unwrap());\n+                        new.rotate_right(1);\n+                        new.extend(client_layer_exports.into_iter().map(|(_, (v, _))| v));\n+                    }\n+                    ServerActionsMode::Turbopack => {\n+                        new.push(ModuleItem::Stmt(Stmt::Expr(ExprStmt {\n+                            expr: Box::new(Expr::Lit(Lit::Str(\n+                                \"use turbopack no side effects\".into(),\n+                            ))),\n+                            span: DUMMY_SP,\n+                        })));\n+                        new.rotate_right(1);\n+                        for (export, (stmt, ref_id)) in client_layer_exports {\n+                            new.push(ModuleItem::ModuleDecl(ModuleDecl::ExportNamed(\n+                                NamedExport {\n+                                    specifiers: vec![ExportSpecifier::Named(\n+                                        ExportNamedSpecifier {\n+                                            span: DUMMY_SP,\n+                                            orig: ModuleExportName::Ident(export.clone().into()),\n+                                            exported: None,\n+                                            is_type_only: false,\n+                                        },\n+                                    )],\n+                                    src: Some(Box::new(\n+                                        program_to_data_url(\n+                                            &self.file_name,\n+                                            &self.cm,\n+                                            vec![\n+                                                ModuleItem::Stmt(Stmt::Expr(ExprStmt {\n+                                                    expr: Box::new(Expr::Lit(Lit::Str(\n+                                                        \"use turbopack no side effects\".into(),\n+                                                    ))),\n+                                                    span: DUMMY_SP,\n+                                                })),\n+                                                client_layer_import.clone().unwrap(),\n+                                                stmt,\n+                                            ],\n+                                            Comment {\n+                                                span: DUMMY_SP,\n+                                                kind: CommentKind::Block,\n+                                                text: generate_server_actions_comment(\n+                                                    &std::iter::once((ref_id, export)).collect(),\n+                                                    Some((\n+                                                        &self.file_name,\n+                                                        self.file_query.as_ref().map_or(\"\", |v| v),\n+                                                    )),\n+                                                )\n+                                                .into(),\n+                                            },\n+                                        )\n+                                        .into(),\n+                                    )),\n+                                    span: DUMMY_SP,\n+                                    type_only: false,\n+                                    with: None,\n+                                },\n+                            )));\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+\n         *stmts = new;\n \n         self.annotations = old_annotations;\n@@ -3081,3 +3196,94 @@ fn emit_error(error_kind: ServerActionsErrorKind) {\n \n     HANDLER.with(|handler| handler.struct_span_err(span, &msg).emit());\n }\n+\n+fn program_to_data_url(\n+    file_name: &str,\n+    cm: &Arc<SourceMap>,\n+    body: Vec<ModuleItem>,\n+    prepend_comment: Comment,\n+) -> String {\n+    let module_span = Span::dummy_with_cmt();\n+    let comments = SingleThreadedComments::default();\n+    comments.add_leading(module_span.lo, prepend_comment);\n+\n+    let program = &Program::Module(Module {\n+        span: module_span,\n+        body,\n+        shebang: None,\n+    });\n+\n+    let mut output = vec![];\n+    let mut mappings = vec![];\n+    let mut emitter = Emitter {\n+        cfg: codegen::Config::default().with_minify(true),\n+        cm: cm.clone(),\n+        wr: Box::new(JsWriter::new(\n+            cm.clone(),\n+            \" \",\n+            &mut output,\n+            Some(&mut mappings),\n+        )),\n+        comments: Some(&comments),\n+    };\n+\n+    emitter.emit_program(program).unwrap();\n+    drop(emitter);\n+\n+    pub struct InlineSourcesContentConfig<'a> {\n+        folder_path: Option<&'a Path>,\n+    }\n+    // This module will be placed at `some/path/to/data:28a9d2` where the original input file lives\n+    // at `some/path/to/actions.js`. So we need to generate a relative path, usually `./actions.js`\n+    impl SourceMapGenConfig for InlineSourcesContentConfig<'_> {\n+        fn file_name_to_source(&self, file: &FileName) -> String {\n+            let FileName::Custom(file) = file else {\n+                // Turbopack uses FileName::Custom for the `[project]/...` paths\n+                return file.to_string();\n+            };\n+            let Some(folder_path) = &self.folder_path else {\n+                return file.to_string();\n+            };\n+\n+            if let Some(rel_path) = diff_paths(file, folder_path) {\n+                format!(\"./{}\", rel_path.display())\n+            } else {\n+                file.to_string()\n+            }\n+        }\n+\n+        fn inline_sources_content(&self, _f: &FileName) -> bool {\n+            true\n+        }\n+    }\n+\n+    let map = cm.build_source_map_with_config(\n+        &mappings,\n+        None,\n+        InlineSourcesContentConfig {\n+            folder_path: PathBuf::from(format!(\"[project]/{file_name}\")).parent(),\n+        },\n+    );\n+    let map = {\n+        if map.get_token_count() > 0 {\n+            let mut buf = vec![];\n+            map.to_writer(&mut buf)\n+                .expect(\"failed to generate sourcemap\");\n+            Some(buf)\n+        } else {\n+            None\n+        }\n+    };\n+\n+    let mut output = String::from_utf8(output).expect(\"codegen generated non-utf8 output\");\n+    if let Some(map) = map {\n+        output.extend(\n+            format!(\n+                \"\\n//# sourceMappingURL=data:application/json;base64,{}\",\n+                Base64Display::new(&map, &BASE64_STANDARD)\n+            )\n+            .chars(),\n+        );\n+    }\n+    format!(\"data:text/javascript,{}\", urlencoding::encode(&output))\n+}"
        },
        {
            "sha": "cdad83cd70b2653ba3ac231382dc18159f3ee076",
            "filename": "crates/next-custom-transforms/tests/errors.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ferrors.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ferrors.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ferrors.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -6,9 +6,7 @@ use next_custom_transforms::transforms::{\n     fonts::{next_font_loaders, Config as FontLoaderConfig},\n     next_ssg::next_ssg,\n     react_server_components::server_components,\n-    server_actions::{\n-        server_actions, {self},\n-    },\n+    server_actions::{self, server_actions, ServerActionsMode},\n     strip_page_exports::{next_transform_strip_page_exports, ExportFilter},\n };\n use rustc_hash::FxHashSet;\n@@ -163,6 +161,7 @@ fn react_server_actions_errors(input: PathBuf) {\n                 ),\n                 server_actions(\n                     &FileName::Real(\"/app/item.js\".into()),\n+                    None,\n                     server_actions::Config {\n                         is_react_server_layer,\n                         is_development: true,\n@@ -171,7 +170,9 @@ fn react_server_actions_errors(input: PathBuf) {\n                         cache_kinds: FxHashSet::default(),\n                     },\n                     tr.comments.as_ref().clone(),\n+                    tr.cm.clone(),\n                     Default::default(),\n+                    ServerActionsMode::Webpack,\n                 ),\n             )\n         },\n@@ -224,6 +225,7 @@ fn use_cache_not_allowed(input: PathBuf) {\n                 ),\n                 server_actions(\n                     &FileName::Real(\"/app/item.js\".into()),\n+                    None,\n                     server_actions::Config {\n                         is_react_server_layer: true,\n                         is_development: true,\n@@ -232,7 +234,9 @@ fn use_cache_not_allowed(input: PathBuf) {\n                         cache_kinds: FxHashSet::from_iter([\"x\".into()]),\n                     },\n                     tr.comments.as_ref().clone(),\n+                    tr.cm.clone(),\n                     Default::default(),\n+                    ServerActionsMode::Webpack,\n                 ),\n             )\n         },"
        },
        {
            "sha": "4463df7d3053adfc9045b4f61d73b69e087ee847",
            "filename": "crates/next-custom-transforms/tests/fixture.rs",
            "status": "modified",
            "additions": 26,
            "deletions": 7,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ffixture.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -18,7 +18,7 @@ use next_custom_transforms::transforms::{\n     page_config::page_config_test,\n     pure::pure_magic,\n     react_server_components::server_components,\n-    server_actions::{self, server_actions},\n+    server_actions::{self, server_actions, ServerActionsMode},\n     shake_exports::{shake_exports, Config as ShakeExportsConfig},\n     strip_page_exports::{next_transform_strip_page_exports, ExportFilter},\n     warn_for_edge_runtime::warn_for_edge_runtime,\n@@ -542,22 +542,30 @@ fn server_actions_fixture(input: PathBuf) {\n     let output = input.parent().unwrap().join(\"output.js\");\n     let is_react_server_layer = input.iter().any(|s| s.to_str() == Some(\"server-graph\"));\n     let is_development = input.iter().any(|s| s.to_str() == Some(\"development\"));\n+    let mode = if input.iter().any(|s| s.to_str() == Some(\"turbopack\")) {\n+        ServerActionsMode::Turbopack\n+    } else {\n+        ServerActionsMode::Webpack\n+    };\n     test_fixture(\n         syntax(),\n-        &|_tr| {\n+        &|tr| {\n             (\n                 resolver(Mark::new(), Mark::new(), false),\n                 server_actions(\n                     &FileName::Real(\"/app/item.js\".into()),\n+                    None,\n                     server_actions::Config {\n                         is_react_server_layer,\n                         is_development,\n                         use_cache_enabled: true,\n                         hash_salt: \"\".into(),\n                         cache_kinds: FxHashSet::from_iter([\"x\".into()]),\n                     },\n-                    _tr.comments.as_ref().clone(),\n+                    tr.comments.as_ref().clone(),\n+                    tr.cm.clone(),\n                     Default::default(),\n+                    mode,\n                 ),\n             )\n         },\n@@ -575,7 +583,7 @@ fn next_font_with_directive_fixture(input: PathBuf) {\n     let output = input.parent().unwrap().join(\"output.js\");\n     test_fixture(\n         syntax(),\n-        &|_tr| {\n+        &|tr| {\n             (\n                 resolver(Mark::new(), Mark::new(), false),\n                 next_font_loaders(FontLoaderConfig {\n@@ -584,15 +592,18 @@ fn next_font_with_directive_fixture(input: PathBuf) {\n                 }),\n                 server_actions(\n                     &FileName::Real(\"/app/test.tsx\".into()),\n+                    None,\n                     server_actions::Config {\n                         is_react_server_layer: true,\n                         is_development: true,\n                         use_cache_enabled: true,\n                         hash_salt: \"\".into(),\n                         cache_kinds: FxHashSet::default(),\n                     },\n-                    _tr.comments.as_ref().clone(),\n+                    tr.comments.as_ref().clone(),\n+                    tr.cm.clone(),\n                     Default::default(),\n+                    ServerActionsMode::Webpack,\n                 ),\n             )\n         },\n@@ -881,23 +892,31 @@ fn test_source_maps(input: PathBuf) {\n     let output: PathBuf = input.parent().unwrap().join(\"output.js\");\n     let is_react_server_layer = input.iter().any(|s| s.to_str() == Some(\"server-graph\"));\n     let is_development = input.iter().any(|s| s.to_str() == Some(\"development\"));\n+    let mode = if input.iter().any(|s| s.to_str() == Some(\"turbopack\")) {\n+        ServerActionsMode::Turbopack\n+    } else {\n+        ServerActionsMode::Webpack\n+    };\n \n     test_fixture(\n         syntax(),\n-        &|_tr| {\n+        &|tr| {\n             (\n                 resolver(Mark::new(), Mark::new(), false),\n                 server_actions(\n                     &FileName::Real(\"/app/item.js\".into()),\n+                    None,\n                     server_actions::Config {\n                         is_react_server_layer,\n                         is_development,\n                         use_cache_enabled: true,\n                         hash_salt: \"\".into(),\n                         cache_kinds: FxHashSet::from_iter([]),\n                     },\n-                    _tr.comments.as_ref().clone(),\n+                    tr.comments.as_ref().clone(),\n+                    tr.cm.clone(),\n                     Default::default(),\n+                    mode,\n                 ),\n             )\n         },"
        },
        {
            "sha": "82c9563876abc9701e1a50935703a9a9ae29b7b8",
            "filename": "crates/next-custom-transforms/tests/fixture/server-actions/client-graph/turbopack/1/input.js",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fserver-actions%2Fclient-graph%2Fturbopack%2F1%2Finput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fserver-actions%2Fclient-graph%2Fturbopack%2F1%2Finput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fserver-actions%2Fclient-graph%2Fturbopack%2F1%2Finput.js?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -0,0 +1,9 @@\n+'use server'\n+\n+export async function foo() {\n+  console.log('action foo')\n+}\n+\n+export async function bar() {\n+  console.log('action bar')\n+}"
        },
        {
            "sha": "d6064545a195013469041bac658c9be9c9350b08",
            "filename": "crates/next-custom-transforms/tests/fixture/server-actions/client-graph/turbopack/1/output.js",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fserver-actions%2Fclient-graph%2Fturbopack%2F1%2Foutput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fserver-actions%2Fclient-graph%2Fturbopack%2F1%2Foutput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fserver-actions%2Fclient-graph%2Fturbopack%2F1%2Foutput.js?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -0,0 +1,3 @@\n+\"use turbopack no side effects\";\n+export { foo } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%2200ab21efdafbe611287bc25c0462b1e0510d13e48b%22%3A%22foo%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20foo%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%2200ab21efdafbe611287bc25c0462b1e0510d13e48b%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22foo%22%29%3B\";\n+export { bar } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%2200ac840dcaf5e8197cb02b7f3a43c119b7a770b272%22%3A%22bar%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20bar%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%2200ac840dcaf5e8197cb02b7f3a43c119b7a770b272%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22bar%22%29%3B\";"
        },
        {
            "sha": "0da3fc36e220fbc5240e9470a82ed36813c84b1b",
            "filename": "crates/next-custom-transforms/tests/fixture/source-maps/turbopack/client-graph/development/server-actions/1/input.js",
            "status": "added",
            "additions": 38,
            "deletions": 0,
            "changes": 38,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fdevelopment%2Fserver-actions%2F1%2Finput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fdevelopment%2Fserver-actions%2F1%2Finput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fdevelopment%2Fserver-actions%2F1%2Finput.js?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -0,0 +1,38 @@\n+'use server'\n+\n+import 'server-only'\n+\n+import { redirect } from 'next/navigation'\n+import { headers, cookies } from 'next/headers'\n+\n+export async function getHeaders() {\n+  console.log('accept header:', (await headers()).get('accept'))\n+  ;(await cookies()).set('test-cookie', Date.now())\n+}\n+\n+export async function inc(value) {\n+  return value + 1\n+}\n+\n+export async function slowInc(value) {\n+  await new Promise((resolve) => setTimeout(resolve, 10000))\n+  return value + 1\n+}\n+\n+export async function dec(value) {\n+  return value - 1\n+}\n+\n+export default async function (value) {\n+  console.log('this_is_sensitive_info')\n+  return value * 2\n+}\n+\n+export async function redirectAction(path) {\n+  redirect(path)\n+}\n+\n+const original = async () => {\n+  console.log('action')\n+}\n+export { original as renamed }"
        },
        {
            "sha": "0d47f485ae451581ec76515dc60171e21e2ed083",
            "filename": "crates/next-custom-transforms/tests/fixture/source-maps/turbopack/client-graph/development/server-actions/1/output.js",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fdevelopment%2Fserver-actions%2F1%2Foutput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fdevelopment%2Fserver-actions%2F1%2Foutput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fdevelopment%2Fserver-actions%2F1%2Foutput.js?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -0,0 +1,8 @@\n+\"use turbopack no side effects\";\n+export { getHeaders } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%22006c24672f968b0713dae406536f7dd6fe7d9a7fa0%22%3A%22getHeaders%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20getHeaders%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%22006c24672f968b0713dae406536f7dd6fe7d9a7fa0%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22getHeaders%22%29%3B%0A%2F%2F%23%20sourceMappingURL%3Ddata%3Aapplication%2Fjson%3Bbase64%2CeyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJ1xuXG5pbXBvcnQgJ3NlcnZlci1vbmx5J1xuXG5pbXBvcnQgeyByZWRpcmVjdCB9IGZyb20gJ25leHQvbmF2aWdhdGlvbidcbmltcG9ydCB7IGhlYWRlcnMsIGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRIZWFkZXJzKCkge1xuICBjb25zb2xlLmxvZygnYWNjZXB0IGhlYWRlcjonLCAoYXdhaXQgaGVhZGVycygpKS5nZXQoJ2FjY2VwdCcpKVxuICA7KGF3YWl0IGNvb2tpZXMoKSkuc2V0KCd0ZXN0LWNvb2tpZScsIERhdGUubm93KCkpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmModmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICsgMVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xvd0luYyh2YWx1ZSkge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwMCkpXG4gIHJldHVybiB2YWx1ZSArIDFcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlYyh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgLSAxXG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSkge1xuICBjb25zb2xlLmxvZygndGhpc19pc19zZW5zaXRpdmVfaW5mbycpXG4gIHJldHVybiB2YWx1ZSAqIDJcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZGlyZWN0QWN0aW9uKHBhdGgpIHtcbiAgcmVkaXJlY3QocGF0aClcbn1cblxuY29uc3Qgb3JpZ2luYWwgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdhY3Rpb24nKVxufVxuZXhwb3J0IHsgb3JpZ2luYWwgYXMgcmVuYW1lZCB9XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6ImdSQU9zQiJ9\";\n+export { inc } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%2240e44b877cc9d02556f56639c94229621ab0af0f5f%22%3A%22inc%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20inc%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%2240e44b877cc9d02556f56639c94229621ab0af0f5f%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22inc%22%29%3B%0A%2F%2F%23%20sourceMappingURL%3Ddata%3Aapplication%2Fjson%3Bbase64%2CeyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJ1xuXG5pbXBvcnQgJ3NlcnZlci1vbmx5J1xuXG5pbXBvcnQgeyByZWRpcmVjdCB9IGZyb20gJ25leHQvbmF2aWdhdGlvbidcbmltcG9ydCB7IGhlYWRlcnMsIGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRIZWFkZXJzKCkge1xuICBjb25zb2xlLmxvZygnYWNjZXB0IGhlYWRlcjonLCAoYXdhaXQgaGVhZGVycygpKS5nZXQoJ2FjY2VwdCcpKVxuICA7KGF3YWl0IGNvb2tpZXMoKSkuc2V0KCd0ZXN0LWNvb2tpZScsIERhdGUubm93KCkpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmModmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICsgMVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xvd0luYyh2YWx1ZSkge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwMCkpXG4gIHJldHVybiB2YWx1ZSArIDFcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlYyh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgLSAxXG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSkge1xuICBjb25zb2xlLmxvZygndGhpc19pc19zZW5zaXRpdmVfaW5mbycpXG4gIHJldHVybiB2YWx1ZSAqIDJcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZGlyZWN0QWN0aW9uKHBhdGgpIHtcbiAgcmVkaXJlY3QocGF0aClcbn1cblxuY29uc3Qgb3JpZ2luYWwgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdhY3Rpb24nKVxufVxuZXhwb3J0IHsgb3JpZ2luYWwgYXMgcmVuYW1lZCB9XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6InlRQVlzQiJ9\";\n+export { slowInc } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%2240f4ad91903d1bf66bfd4e0788888852badc924261%22%3A%22slowInc%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20slowInc%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%2240f4ad91903d1bf66bfd4e0788888852badc924261%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22slowInc%22%29%3B%0A%2F%2F%23%20sourceMappingURL%3Ddata%3Aapplication%2Fjson%3Bbase64%2CeyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJ1xuXG5pbXBvcnQgJ3NlcnZlci1vbmx5J1xuXG5pbXBvcnQgeyByZWRpcmVjdCB9IGZyb20gJ25leHQvbmF2aWdhdGlvbidcbmltcG9ydCB7IGhlYWRlcnMsIGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRIZWFkZXJzKCkge1xuICBjb25zb2xlLmxvZygnYWNjZXB0IGhlYWRlcjonLCAoYXdhaXQgaGVhZGVycygpKS5nZXQoJ2FjY2VwdCcpKVxuICA7KGF3YWl0IGNvb2tpZXMoKSkuc2V0KCd0ZXN0LWNvb2tpZScsIERhdGUubm93KCkpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmModmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICsgMVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xvd0luYyh2YWx1ZSkge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwMCkpXG4gIHJldHVybiB2YWx1ZSArIDFcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlYyh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgLSAxXG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSkge1xuICBjb25zb2xlLmxvZygndGhpc19pc19zZW5zaXRpdmVfaW5mbycpXG4gIHJldHVybiB2YWx1ZSAqIDJcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZGlyZWN0QWN0aW9uKHBhdGgpIHtcbiAgcmVkaXJlY3QocGF0aClcbn1cblxuY29uc3Qgb3JpZ2luYWwgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdhY3Rpb24nKVxufVxuZXhwb3J0IHsgb3JpZ2luYWwgYXMgcmVuYW1lZCB9XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjZRQWdCc0IifQ%3D%3D\";\n+export { dec } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%224028baf972d345b86b747ad0df73d75a0088a42214%22%3A%22dec%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20dec%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%224028baf972d345b86b747ad0df73d75a0088a42214%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22dec%22%29%3B%0A%2F%2F%23%20sourceMappingURL%3Ddata%3Aapplication%2Fjson%3Bbase64%2CeyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJ1xuXG5pbXBvcnQgJ3NlcnZlci1vbmx5J1xuXG5pbXBvcnQgeyByZWRpcmVjdCB9IGZyb20gJ25leHQvbmF2aWdhdGlvbidcbmltcG9ydCB7IGhlYWRlcnMsIGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRIZWFkZXJzKCkge1xuICBjb25zb2xlLmxvZygnYWNjZXB0IGhlYWRlcjonLCAoYXdhaXQgaGVhZGVycygpKS5nZXQoJ2FjY2VwdCcpKVxuICA7KGF3YWl0IGNvb2tpZXMoKSkuc2V0KCd0ZXN0LWNvb2tpZScsIERhdGUubm93KCkpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmModmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICsgMVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xvd0luYyh2YWx1ZSkge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwMCkpXG4gIHJldHVybiB2YWx1ZSArIDFcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlYyh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgLSAxXG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSkge1xuICBjb25zb2xlLmxvZygndGhpc19pc19zZW5zaXRpdmVfaW5mbycpXG4gIHJldHVybiB2YWx1ZSAqIDJcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZGlyZWN0QWN0aW9uKHBhdGgpIHtcbiAgcmVkaXJlY3QocGF0aClcbn1cblxuY29uc3Qgb3JpZ2luYWwgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdhY3Rpb24nKVxufVxuZXhwb3J0IHsgb3JpZ2luYWwgYXMgcmVuYW1lZCB9XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6InlRQXFCc0IifQ%3D%3D\";\n+export { default } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%2240c18c215a6b7cdc64bf709f3a714ffdef1bf9651d%22%3A%22default%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20default%20createServerReference%28%2240c18c215a6b7cdc64bf709f3a714ffdef1bf9651d%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22default%22%29%3B%0A%2F%2F%23%20sourceMappingURL%3Ddata%3Aapplication%2Fjson%3Bbase64%2CeyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJ1xuXG5pbXBvcnQgJ3NlcnZlci1vbmx5J1xuXG5pbXBvcnQgeyByZWRpcmVjdCB9IGZyb20gJ25leHQvbmF2aWdhdGlvbidcbmltcG9ydCB7IGhlYWRlcnMsIGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRIZWFkZXJzKCkge1xuICBjb25zb2xlLmxvZygnYWNjZXB0IGhlYWRlcjonLCAoYXdhaXQgaGVhZGVycygpKS5nZXQoJ2FjY2VwdCcpKVxuICA7KGF3YWl0IGNvb2tpZXMoKSkuc2V0KCd0ZXN0LWNvb2tpZScsIERhdGUubm93KCkpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmModmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICsgMVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xvd0luYyh2YWx1ZSkge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwMCkpXG4gIHJldHVybiB2YWx1ZSArIDFcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlYyh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgLSAxXG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSkge1xuICBjb25zb2xlLmxvZygndGhpc19pc19zZW5zaXRpdmVfaW5mbycpXG4gIHJldHVybiB2YWx1ZSAqIDJcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZGlyZWN0QWN0aW9uKHBhdGgpIHtcbiAgcmVkaXJlY3QocGF0aClcbn1cblxuY29uc3Qgb3JpZ2luYWwgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdhY3Rpb24nKVxufVxuZXhwb3J0IHsgb3JpZ2luYWwgYXMgcmVuYW1lZCB9XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6ImlSQXlCZSJ9\";\n+export { redirectAction } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%22403724e93433a7e950ef2f8479f31225e4b0dd0cc5%22%3A%22redirectAction%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20redirectAction%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%22403724e93433a7e950ef2f8479f31225e4b0dd0cc5%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22redirectAction%22%29%3B%0A%2F%2F%23%20sourceMappingURL%3Ddata%3Aapplication%2Fjson%3Bbase64%2CeyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJ1xuXG5pbXBvcnQgJ3NlcnZlci1vbmx5J1xuXG5pbXBvcnQgeyByZWRpcmVjdCB9IGZyb20gJ25leHQvbmF2aWdhdGlvbidcbmltcG9ydCB7IGhlYWRlcnMsIGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRIZWFkZXJzKCkge1xuICBjb25zb2xlLmxvZygnYWNjZXB0IGhlYWRlcjonLCAoYXdhaXQgaGVhZGVycygpKS5nZXQoJ2FjY2VwdCcpKVxuICA7KGF3YWl0IGNvb2tpZXMoKSkuc2V0KCd0ZXN0LWNvb2tpZScsIERhdGUubm93KCkpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmModmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICsgMVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xvd0luYyh2YWx1ZSkge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwMCkpXG4gIHJldHVybiB2YWx1ZSArIDFcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlYyh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgLSAxXG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSkge1xuICBjb25zb2xlLmxvZygndGhpc19pc19zZW5zaXRpdmVfaW5mbycpXG4gIHJldHVybiB2YWx1ZSAqIDJcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZGlyZWN0QWN0aW9uKHBhdGgpIHtcbiAgcmVkaXJlY3QocGF0aClcbn1cblxuY29uc3Qgb3JpZ2luYWwgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdhY3Rpb24nKVxufVxuZXhwb3J0IHsgb3JpZ2luYWwgYXMgcmVuYW1lZCB9XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Im9SQThCc0IifQ%3D%3D\";\n+export { renamed } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%227f1e1a741f85a589443b50c4863618893572cfb178%22%3A%22renamed%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20renamed%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%227f1e1a741f85a589443b50c4863618893572cfb178%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22renamed%22%29%3B%0A%2F%2F%23%20sourceMappingURL%3Ddata%3Aapplication%2Fjson%3Bbase64%2CeyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJ1xuXG5pbXBvcnQgJ3NlcnZlci1vbmx5J1xuXG5pbXBvcnQgeyByZWRpcmVjdCB9IGZyb20gJ25leHQvbmF2aWdhdGlvbidcbmltcG9ydCB7IGhlYWRlcnMsIGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRIZWFkZXJzKCkge1xuICBjb25zb2xlLmxvZygnYWNjZXB0IGhlYWRlcjonLCAoYXdhaXQgaGVhZGVycygpKS5nZXQoJ2FjY2VwdCcpKVxuICA7KGF3YWl0IGNvb2tpZXMoKSkuc2V0KCd0ZXN0LWNvb2tpZScsIERhdGUubm93KCkpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmModmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICsgMVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xvd0luYyh2YWx1ZSkge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwMCkpXG4gIHJldHVybiB2YWx1ZSArIDFcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlYyh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgLSAxXG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSkge1xuICBjb25zb2xlLmxvZygndGhpc19pc19zZW5zaXRpdmVfaW5mbycpXG4gIHJldHVybiB2YWx1ZSAqIDJcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZGlyZWN0QWN0aW9uKHBhdGgpIHtcbiAgcmVkaXJlY3QocGF0aClcbn1cblxuY29uc3Qgb3JpZ2luYWwgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdhY3Rpb24nKVxufVxuZXhwb3J0IHsgb3JpZ2luYWwgYXMgcmVuYW1lZCB9XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjZRQXFDUyJ9\";"
        },
        {
            "sha": "2adb393ce458c9ea03653dc179ad5285b0aac33c",
            "filename": "crates/next-custom-transforms/tests/fixture/source-maps/turbopack/client-graph/development/server-actions/1/output.map",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fdevelopment%2Fserver-actions%2F1%2Foutput.map",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fdevelopment%2Fserver-actions%2F1%2Foutput.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fdevelopment%2Fserver-actions%2F1%2Foutput.map?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -0,0 +1 @@\n+{\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\"}"
        },
        {
            "sha": "0da3fc36e220fbc5240e9470a82ed36813c84b1b",
            "filename": "crates/next-custom-transforms/tests/fixture/source-maps/turbopack/client-graph/production/server-actions/1/input.js",
            "status": "added",
            "additions": 38,
            "deletions": 0,
            "changes": 38,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fproduction%2Fserver-actions%2F1%2Finput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fproduction%2Fserver-actions%2F1%2Finput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fproduction%2Fserver-actions%2F1%2Finput.js?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -0,0 +1,38 @@\n+'use server'\n+\n+import 'server-only'\n+\n+import { redirect } from 'next/navigation'\n+import { headers, cookies } from 'next/headers'\n+\n+export async function getHeaders() {\n+  console.log('accept header:', (await headers()).get('accept'))\n+  ;(await cookies()).set('test-cookie', Date.now())\n+}\n+\n+export async function inc(value) {\n+  return value + 1\n+}\n+\n+export async function slowInc(value) {\n+  await new Promise((resolve) => setTimeout(resolve, 10000))\n+  return value + 1\n+}\n+\n+export async function dec(value) {\n+  return value - 1\n+}\n+\n+export default async function (value) {\n+  console.log('this_is_sensitive_info')\n+  return value * 2\n+}\n+\n+export async function redirectAction(path) {\n+  redirect(path)\n+}\n+\n+const original = async () => {\n+  console.log('action')\n+}\n+export { original as renamed }"
        },
        {
            "sha": "e560564a77a8715bf23370f95923031085ab4198",
            "filename": "crates/next-custom-transforms/tests/fixture/source-maps/turbopack/client-graph/production/server-actions/1/output.js",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fproduction%2Fserver-actions%2F1%2Foutput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fproduction%2Fserver-actions%2F1%2Foutput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fproduction%2Fserver-actions%2F1%2Foutput.js?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -0,0 +1,8 @@\n+\"use turbopack no side effects\";\n+export { getHeaders } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%22006c24672f968b0713dae406536f7dd6fe7d9a7fa0%22%3A%22getHeaders%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20getHeaders%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%22006c24672f968b0713dae406536f7dd6fe7d9a7fa0%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22getHeaders%22%29%3B\";\n+export { inc } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%2240e44b877cc9d02556f56639c94229621ab0af0f5f%22%3A%22inc%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20inc%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%2240e44b877cc9d02556f56639c94229621ab0af0f5f%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22inc%22%29%3B\";\n+export { slowInc } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%2240f4ad91903d1bf66bfd4e0788888852badc924261%22%3A%22slowInc%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20slowInc%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%2240f4ad91903d1bf66bfd4e0788888852badc924261%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22slowInc%22%29%3B\";\n+export { dec } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%224028baf972d345b86b747ad0df73d75a0088a42214%22%3A%22dec%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20dec%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%224028baf972d345b86b747ad0df73d75a0088a42214%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22dec%22%29%3B\";\n+export { default } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%2240c18c215a6b7cdc64bf709f3a714ffdef1bf9651d%22%3A%22default%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20default%20%2F%2A%23__PURE__%2A%2FcreateServerReference%28%2240c18c215a6b7cdc64bf709f3a714ffdef1bf9651d%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22default%22%29%3B\";\n+export { redirectAction } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%22403724e93433a7e950ef2f8479f31225e4b0dd0cc5%22%3A%22redirectAction%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20redirectAction%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%22403724e93433a7e950ef2f8479f31225e4b0dd0cc5%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22redirectAction%22%29%3B\";\n+export { renamed } from \"data:text/javascript,%2F%2A%20__next_internal_action_entry_do_not_use__%20%5B%7B%227f1e1a741f85a589443b50c4863618893572cfb178%22%3A%22renamed%22%7D%2C%22%2Fapp%2Fitem.js%22%2C%22%22%5D%20%2A%2F%22use%20turbopack%20no%20side%20effects%22%3Bimport%7BcreateServerReference%2CcallServer%2CfindSourceMapURL%7Dfrom%22private-next-rsc-action-client-wrapper%22%3Bexport%20var%20renamed%3D%2F%2A%23__PURE__%2A%2FcreateServerReference%28%227f1e1a741f85a589443b50c4863618893572cfb178%22%2CcallServer%2Cvoid%200%2CfindSourceMapURL%2C%22renamed%22%29%3B\";"
        },
        {
            "sha": "2adb393ce458c9ea03653dc179ad5285b0aac33c",
            "filename": "crates/next-custom-transforms/tests/fixture/source-maps/turbopack/client-graph/production/server-actions/1/output.map",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fproduction%2Fserver-actions%2F1%2Foutput.map",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fproduction%2Fserver-actions%2F1%2Foutput.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ffixture%2Fsource-maps%2Fturbopack%2Fclient-graph%2Fproduction%2Fserver-actions%2F1%2Foutput.map?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -0,0 +1 @@\n+{\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\"}"
        },
        {
            "sha": "380fd66706a6229e4e9842ee3c026e6def45cfc9",
            "filename": "test/production/app-dir/actions-tree-shaking/basic/basic.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fbasic%2Fbasic.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fbasic%2Fbasic.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fbasic%2Fbasic.test.ts?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -22,7 +22,7 @@ import {\n       expect(actionsRoutesState).toMatchObject({\n         // only one server layer action\n         'app/server/page': {\n-          rsc: 1,\n+          rsc: 3,\n         },\n         // only one browser layer action\n         'app/client/page': {"
        },
        {
            "sha": "b62ba48102681c54c3235637baedc6ba4ee71e42",
            "filename": "test/production/app-dir/actions-tree-shaking/basic/next.config.js",
            "status": "removed",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fbasic%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fbasic%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fbasic%2Fnext.config.js?ref=d3a2971b6065972a02f81543e76317434bd9471f",
            "patch": "@@ -1,7 +0,0 @@\n-module.exports = {\n-  experimental: {\n-    turbo: {\n-      treeShaking: true,\n-    },\n-  },\n-}"
        },
        {
            "sha": "b62ba48102681c54c3235637baedc6ba4ee71e42",
            "filename": "test/production/app-dir/actions-tree-shaking/client-actions-tree-shaking/next.config.js",
            "status": "removed",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fclient-actions-tree-shaking%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fclient-actions-tree-shaking%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fclient-actions-tree-shaking%2Fnext.config.js?ref=d3a2971b6065972a02f81543e76317434bd9471f",
            "patch": "@@ -1,7 +0,0 @@\n-module.exports = {\n-  experimental: {\n-    turbo: {\n-      treeShaking: true,\n-    },\n-  },\n-}"
        },
        {
            "sha": "ff96f6aa3956de29ea3e97a58251292c47e4bcd5",
            "filename": "test/production/app-dir/actions-tree-shaking/mixed-module-actions/mixed-module-actions.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fmixed-module-actions%2Fmixed-module-actions.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fmixed-module-actions%2Fmixed-module-actions.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fmixed-module-actions%2Fmixed-module-actions.test.ts?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -21,7 +21,7 @@ import {\n \n       expect(actionsRoutesState).toMatchObject({\n         'app/mixed-module/esm/page': {\n-          rsc: 1,\n+          rsc: 3,\n         },\n         // CJS import is not able to tree shake, so it will include all actions\n         'app/mixed-module/cjs/page': {"
        },
        {
            "sha": "b62ba48102681c54c3235637baedc6ba4ee71e42",
            "filename": "test/production/app-dir/actions-tree-shaking/mixed-module-actions/next.config.js",
            "status": "removed",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fmixed-module-actions%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fmixed-module-actions%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fmixed-module-actions%2Fnext.config.js?ref=d3a2971b6065972a02f81543e76317434bd9471f",
            "patch": "@@ -1,7 +0,0 @@\n-module.exports = {\n-  experimental: {\n-    turbo: {\n-      treeShaking: true,\n-    },\n-  },\n-}"
        },
        {
            "sha": "b62ba48102681c54c3235637baedc6ba4ee71e42",
            "filename": "test/production/app-dir/actions-tree-shaking/reexport/next.config.js",
            "status": "removed",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Freexport%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Freexport%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Freexport%2Fnext.config.js?ref=d3a2971b6065972a02f81543e76317434bd9471f",
            "patch": "@@ -1,7 +0,0 @@\n-module.exports = {\n-  experimental: {\n-    turbo: {\n-      treeShaking: true,\n-    },\n-  },\n-}"
        },
        {
            "sha": "6519876420abd47914491568797dd35a602429db",
            "filename": "test/production/app-dir/actions-tree-shaking/reexport/reexport.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Freexport%2Freexport.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Freexport%2Freexport.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Freexport%2Freexport.test.ts?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -27,13 +27,12 @@ import { retry } from 'next-test-utils'\n           rsc: process.env.TURBOPACK ? 3 : 1,\n         },\n         'app/namespace-reexport/client/page': {\n-          // Turbopack does not support tree-shaking export * as we don't have global information\n-          'action-browser': process.env.TURBOPACK ? 3 : 1,\n+          'action-browser': 1,\n         },\n         // We're not able to tree-shake these re-exports here in webpack mode\n         'app/named-reexport/server/page': {\n           // Turbopack supports tree-shaking these re-exports\n-          rsc: process.env.TURBOPACK ? 1 : 3,\n+          rsc: 3,\n         },\n         'app/named-reexport/client/page': {\n           // Turbopack supports tree-shaking these re-exports"
        },
        {
            "sha": "b62ba48102681c54c3235637baedc6ba4ee71e42",
            "filename": "test/production/app-dir/actions-tree-shaking/shared-module-actions/next.config.js",
            "status": "removed",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fshared-module-actions%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fshared-module-actions%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fshared-module-actions%2Fnext.config.js?ref=d3a2971b6065972a02f81543e76317434bd9471f",
            "patch": "@@ -1,7 +0,0 @@\n-module.exports = {\n-  experimental: {\n-    turbo: {\n-      treeShaking: true,\n-    },\n-  },\n-}"
        },
        {
            "sha": "a7693e5a08447d75b51a5f7383419a7b303dc9f1",
            "filename": "test/production/app-dir/actions-tree-shaking/shared-module-actions/shared-module-actions.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fshared-module-actions%2Fshared-module-actions.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fshared-module-actions%2Fshared-module-actions.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fshared-module-actions%2Fshared-module-actions.test.ts?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -21,10 +21,10 @@ import {\n \n       expect(actionsRoutesState).toMatchObject({\n         'app/server/one/page': {\n-          rsc: 1,\n+          rsc: 3,\n         },\n         'app/server/two/page': {\n-          rsc: 1,\n+          rsc: 3,\n         },\n         'app/client/one/page': {\n           'action-browser': 1,"
        },
        {
            "sha": "b62ba48102681c54c3235637baedc6ba4ee71e42",
            "filename": "test/production/app-dir/actions-tree-shaking/use-effect-actions/next.config.js",
            "status": "removed",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fuse-effect-actions%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/d3a2971b6065972a02f81543e76317434bd9471f/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fuse-effect-actions%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Factions-tree-shaking%2Fuse-effect-actions%2Fnext.config.js?ref=d3a2971b6065972a02f81543e76317434bd9471f",
            "patch": "@@ -1,7 +0,0 @@\n-module.exports = {\n-  experimental: {\n-    turbo: {\n-      treeShaking: true,\n-    },\n-  },\n-}"
        },
        {
            "sha": "00f54c3bb125f17971a03d529041d173904d9433",
            "filename": "turbopack/crates/turbopack-ecmascript/src/lib.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -1011,7 +1011,7 @@ async fn gen_content_with_code_gens(\n             is_esm: false,\n         }\n         .cell()),\n-        _ => Ok(EcmascriptModuleContent {\n+        ParseResult::NotFound => Ok(EcmascriptModuleContent {\n             inner_code: format!(\n                 \"const e = new Error(\\\"Could not parse module '{path}'\\\");\\ne.code = \\\n                  'MODULE_UNPARSEABLE';\\nthrow e;\","
        },
        {
            "sha": "6a6b35f353c127efa11225fc44cd95333b29eb57",
            "filename": "turbopack/crates/turbopack-ecmascript/src/parse.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fparse.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fparse.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fparse.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -182,6 +182,7 @@ async fn parse_internal(\n                         fs_path_vc,\n                         fs_path,\n                         ident,\n+                        source.ident().query().owned().await?,\n                         file_path_hash,\n                         source,\n                         ty,\n@@ -222,6 +223,7 @@ async fn parse_file_content(\n     fs_path_vc: Vc<FileSystemPath>,\n     fs_path: &FileSystemPath,\n     ident: &str,\n+    query: RcStr,\n     file_path_hash: u128,\n     source: ResolvedVc<Box<dyn Source>>,\n     ty: EcmascriptModuleAssetType,\n@@ -371,6 +373,7 @@ async fn parse_file_content(\n                 file_path_str: &fs_path.path,\n                 file_name_str: fs_path.file_name(),\n                 file_name_hash: file_path_hash,\n+                query_str: query,\n                 file_path: fs_path_vc.to_resolved().await?,\n             };\n             let span = tracing::trace_span!(\"transforms\");"
        },
        {
            "sha": "643957b009d1f811782e613157b00b97fa584cf4",
            "filename": "turbopack/crates/turbopack-ecmascript/src/transform/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/2af3d065e7931218115834aeed631ba8a9f9d9bd/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftransform%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2af3d065e7931218115834aeed631ba8a9f9d9bd/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftransform%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftransform%2Fmod.rs?ref=2af3d065e7931218115834aeed631ba8a9f9d9bd",
            "patch": "@@ -116,6 +116,7 @@ pub struct TransformContext<'a> {\n     pub file_path_str: &'a str,\n     pub file_name_str: &'a str,\n     pub file_name_hash: u128,\n+    pub query_str: RcStr,\n     pub file_path: ResolvedVc<FileSystemPath>,\n }\n "
        }
    ],
    "stats": {
        "total": 603,
        "additions": 473,
        "deletions": 130
    }
}