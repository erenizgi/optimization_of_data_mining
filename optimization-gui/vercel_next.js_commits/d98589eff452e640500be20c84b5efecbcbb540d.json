{
    "author": "lukesandberg",
    "message": "[turbopack] change server source maps in production to use relative paths (#85576)\n\n\nCo-authored-by: Sebastian Sebbie Silbermann <sebastian.silbermann@vercel.com>",
    "sha": "d98589eff452e640500be20c84b5efecbcbb540d",
    "files": [
        {
            "sha": "63a2fa9f23af0cfb10bf5471d73d33479fb666ad",
            "filename": "crates/next-core/src/next_server/context.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/d98589eff452e640500be20c84b5efecbcbb540d/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fcontext.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d98589eff452e640500be20c84b5efecbcbb540d/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fcontext.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_server%2Fcontext.rs?ref=d98589eff452e640500be20c84b5efecbcbb540d",
            "patch": "@@ -1063,8 +1063,7 @@ pub async fn get_server_chunking_context_with_client_assets(\n     builder = builder.source_map_source_type(if next_mode.is_development() {\n         SourceMapSourceType::AbsoluteFileUri\n     } else {\n-        // TODO(lukesandberg): switch to relative once next is compatible.\n-        SourceMapSourceType::TurbopackUri\n+        SourceMapSourceType::RelativeUri\n     });\n     if next_mode.is_production() {\n         builder = builder\n@@ -1149,8 +1148,7 @@ pub async fn get_server_chunking_context(\n         builder = builder.source_map_source_type(SourceMapSourceType::AbsoluteFileUri);\n     } else {\n         builder = builder\n-            // TODO(lukesandberg): switch to relative once next is compatible.\n-            .source_map_source_type(SourceMapSourceType::TurbopackUri)\n+            .source_map_source_type(SourceMapSourceType::RelativeUri)\n             .chunking_config(\n                 Vc::<EcmascriptChunkType>::default().to_resolved().await?,\n                 ChunkingConfig {"
        },
        {
            "sha": "e3a107a6a4aba76e5316cbd4af7ac1aff888e77c",
            "filename": "packages/next/src/server/patch-error-inspect.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/d98589eff452e640500be20c84b5efecbcbb540d/packages%2Fnext%2Fsrc%2Fserver%2Fpatch-error-inspect.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/d98589eff452e640500be20c84b5efecbcbb540d/packages%2Fnext%2Fsrc%2Fserver%2Fpatch-error-inspect.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fpatch-error-inspect.ts?ref=d98589eff452e640500be20c84b5efecbcbb540d",
            "patch": "@@ -196,9 +196,16 @@ function getSourcemappedFrameIfPossible(\n     }\n     sourceMapPayload = maybeSourceMapPayload\n     try {\n+      // Pass the source map URL as the second parameter so that the consumer\n+      // can resolve relative paths in the source map's `sources` array.\n+      // This is a guess!  Turbopack places .map files as siblings to the chunks so this is sufficient to compute\n+      // relative paths but is actually wrong (the chunk and sourcemap have different content hashes).\n+      // We are using the node API to read the sourcemap and it doesn't give us access to the URI.\n+      const sourceMapURL = sourceURL + '.map'\n       sourceMapConsumer = new SyncSourceMapConsumer(\n-        // @ts-expect-error -- Module.SourceMap['version'] is number but SyncSourceMapConsumer wants a string\n-        sourceMapPayload\n+        sourceMapPayload,\n+        // @ts-expect-error: our typings don't include this parameter but it is here.\n+        sourceMapURL\n       )\n     } catch (cause) {\n       // We should not log an actual error instance here because that will re-enter"
        },
        {
            "sha": "0305be76a372b9203541cc3f3621c666580e5d65",
            "filename": "test/e2e/app-dir/cache-components-errors/cache-components-errors.test.ts",
            "status": "modified",
            "additions": 384,
            "deletions": 88,
            "changes": 472,
            "blob_url": "https://github.com/vercel/next.js/blob/d98589eff452e640500be20c84b5efecbcbb540d/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/d98589eff452e640500be20c84b5efecbcbb540d/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts?ref=d98589eff452e640500be20c84b5efecbcbb540d",
            "patch": "@@ -538,7 +538,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/dynamic-root\": Uncached data was accessed outside of <Suspense>. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/blocking-route\n-                   at IndirectionTwo (bundler:///app/dynamic-root/indirection.tsx:7:34)\n+                   at IndirectionTwo (app/dynamic-root/indirection.tsx:7:34)\n                    at main (<anonymous>)\n                    at body (<anonymous>)\n                    at html (<anonymous>)\n@@ -563,7 +563,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/dynamic-root\": Uncached data was accessed outside of <Suspense>. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/blocking-route\n-                   at a (bundler:///app/dynamic-root/indirection.tsx:7:34)\n+                   at a (app/dynamic-root/indirection.tsx:7:34)\n                    at main (<anonymous>)\n                    at body (<anonymous>)\n                    at html (<anonymous>)\n@@ -592,7 +592,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/dynamic-root\": Uncached data was accessed outside of <Suspense>. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/blocking-route\n-                   at IndirectionTwo (bundler:///app/dynamic-root/indirection.tsx:7:34)\n+                   at IndirectionTwo (webpack:///app/dynamic-root/indirection.tsx:7:34)\n                    at <FIXME-library-internal>\n                   5 | }\n                   6 |\n@@ -744,9 +744,27 @@ describe('Cache Components Errors', () => {\n             )\n \n             if (isDebugPrerender) {\n-              expect(output).toMatchInlineSnapshot(`\n+              if (isTurbopack) {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: Route \"/sync-random-with-fallback\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n+                     at RandomReadingComponent (app/sync-random-with-fallback/page.tsx:37:23)\n+                   35 |     use(new Promise((r) => process.nextTick(r)))\n+                   36 |   }\n+                 > 37 |   const random = Math.random()\n+                      |                       ^\n+                   38 |   return (\n+                   39 |     <div>\n+                   40 |       <span id=\"rand\">{random}</span>\n+                 To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-random-with-fallback\" in your browser to investigate the error.\n+                 Error occurred prerendering page \"/sync-random-with-fallback\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+                 > Export encountered errors on following paths:\n+                 \t/sync-random-with-fallback/page: /sync-random-with-fallback\"\n+                `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-random-with-fallback\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                     at RandomReadingComponent (bundler:///app/sync-random-with-fallback/page.tsx:37:23)\n+                     at RandomReadingComponent (webpack:///app/sync-random-with-fallback/page.tsx:37:23)\n                    35 |     use(new Promise((r) => process.nextTick(r)))\n                    36 |   }\n                  > 37 |   const random = Math.random()\n@@ -760,11 +778,12 @@ describe('Cache Components Errors', () => {\n                  > Export encountered errors on following paths:\n                  \t/sync-random-with-fallback/page: /sync-random-with-fallback\"\n                 `)\n+              }\n             } else {\n               if (isTurbopack) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-random-with-fallback\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                     at a (bundler:///app/sync-random-with-fallback/page.tsx:37:23)\n+                     at a (app/sync-random-with-fallback/page.tsx:37:23)\n                    35 |     use(new Promise((r) => process.nextTick(r)))\n                    36 |   }\n                  > 37 |   const random = Math.random()\n@@ -836,10 +855,29 @@ describe('Cache Components Errors', () => {\n             )\n \n             if (isDebugPrerender) {\n-              expect(output).toMatchInlineSnapshot(`\n+              if (isTurbopack) {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: Route \"/sync-random-without-fallback\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n+                     at getRandomNumber (app/sync-random-without-fallback/page.tsx:32:15)\n+                     at RandomReadingComponent (app/sync-random-without-fallback/page.tsx:40:18)\n+                   30 |\n+                   31 | function getRandomNumber() {\n+                 > 32 |   return Math.random()\n+                      |               ^\n+                   33 | }\n+                   34 |\n+                   35 | function RandomReadingComponent() {\n+                 To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-random-without-fallback\" in your browser to investigate the error.\n+                 Error occurred prerendering page \"/sync-random-without-fallback\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+                 > Export encountered errors on following paths:\n+                 \t/sync-random-without-fallback/page: /sync-random-without-fallback\"\n+                `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-random-without-fallback\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                     at getRandomNumber (bundler:///app/sync-random-without-fallback/page.tsx:32:15)\n-                     at RandomReadingComponent (bundler:///app/sync-random-without-fallback/page.tsx:40:18)\n+                     at getRandomNumber (webpack:///app/sync-random-without-fallback/page.tsx:32:15)\n+                     at RandomReadingComponent (webpack:///app/sync-random-without-fallback/page.tsx:40:18)\n                    30 |\n                    31 | function getRandomNumber() {\n                  > 32 |   return Math.random()\n@@ -853,11 +891,12 @@ describe('Cache Components Errors', () => {\n                  > Export encountered errors on following paths:\n                  \t/sync-random-without-fallback/page: /sync-random-without-fallback\"\n                 `)\n+              }\n             } else {\n               if (isTurbopack) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-random-without-fallback\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                     at a (bundler:///app/sync-random-without-fallback/page.tsx:32:15)\n+                     at a (app/sync-random-without-fallback/page.tsx:32:15)\n                    30 |\n                    31 | function getRandomNumber() {\n                  > 32 |   return Math.random()\n@@ -1074,10 +1113,30 @@ describe('Cache Components Errors', () => {\n             )\n \n             if (isDebugPrerender) {\n-              expect(output).toMatchInlineSnapshot(`\n+              if (isTurbopack) {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error occurred prerendering page \"/sync-cookies\". Read more: https://nextjs.org/docs/messages/prerender-error\n+                 TypeError: <module-function>().get is not a function\n+                     at CookiesReadingComponent (app/sync-cookies/page.tsx:18:36)\n+                     at stringify (<anonymous>)\n+                   16 | async function CookiesReadingComponent() {\n+                   17 |   // Cast to any as we removed UnsafeUnwrapped types, but still need to test with the sync access\n+                 > 18 |   const token = (cookies() as any).get('token')\n+                      |                                    ^\n+                   19 |\n+                   20 |   return (\n+                   21 |     <div> {\n+                   digest: '<error-digest>'\n+                 }\n+\n+                 > Export encountered errors on following paths:\n+                 \t/sync-cookies/page: /sync-cookies\"\n+                `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n                  \"Error occurred prerendering page \"/sync-cookies\". Read more: https://nextjs.org/docs/messages/prerender-error\n                  TypeError: <module-function>().get is not a function\n-                     at CookiesReadingComponent (bundler:///app/sync-cookies/page.tsx:18:36)\n+                     at CookiesReadingComponent (webpack:///app/sync-cookies/page.tsx:18:36)\n                      at stringify (<anonymous>)\n                    16 | async function CookiesReadingComponent() {\n                    17 |   // Cast to any as we removed UnsafeUnwrapped types, but still need to test with the sync access\n@@ -1092,12 +1151,13 @@ describe('Cache Components Errors', () => {\n                  > Export encountered errors on following paths:\n                  \t/sync-cookies/page: /sync-cookies\"\n                 `)\n+              }\n             } else {\n               if (isTurbopack) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error occurred prerendering page \"/sync-cookies\". Read more: https://nextjs.org/docs/messages/prerender-error\n                  TypeError: <module-function>().get is not a function\n-                     at a (bundler:///app/sync-cookies/page.tsx:18:36)\n+                     at a (app/sync-cookies/page.tsx:18:36)\n                      at b (<anonymous>)\n                    16 | async function CookiesReadingComponent() {\n                    17 |   // Cast to any as we removed UnsafeUnwrapped types, but still need to test with the sync access\n@@ -1389,10 +1449,30 @@ describe('Cache Components Errors', () => {\n             )\n \n             if (isDebugPrerender) {\n-              expect(output).toMatchInlineSnapshot(`\n+              if (isTurbopack) {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error occurred prerendering page \"/sync-headers\". Read more: https://nextjs.org/docs/messages/prerender-error\n+                 TypeError: <module-function>().get is not a function\n+                     at HeadersReadingComponent (app/sync-headers/page.tsx:18:40)\n+                     at stringify (<anonymous>)\n+                   16 | async function HeadersReadingComponent() {\n+                   17 |   // Cast to any as we removed UnsafeUnwrapped types, but still need to test with the sync access\n+                 > 18 |   const userAgent = (headers() as any).get('user-agent')\n+                      |                                        ^\n+                   19 |   return (\n+                   20 |     <div>\n+                   21 |       this component reads the \\`user-agent\\` header synchronously: {userAgent} {\n+                   digest: '<error-digest>'\n+                 }\n+\n+                 > Export encountered errors on following paths:\n+                 \t/sync-headers/page: /sync-headers\"\n+                `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n                  \"Error occurred prerendering page \"/sync-headers\". Read more: https://nextjs.org/docs/messages/prerender-error\n                  TypeError: <module-function>().get is not a function\n-                     at HeadersReadingComponent (bundler:///app/sync-headers/page.tsx:18:40)\n+                     at HeadersReadingComponent (webpack:///app/sync-headers/page.tsx:18:40)\n                      at stringify (<anonymous>)\n                    16 | async function HeadersReadingComponent() {\n                    17 |   // Cast to any as we removed UnsafeUnwrapped types, but still need to test with the sync access\n@@ -1407,12 +1487,13 @@ describe('Cache Components Errors', () => {\n                  > Export encountered errors on following paths:\n                  \t/sync-headers/page: /sync-headers\"\n                 `)\n+              }\n             } else {\n               if (isTurbopack) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error occurred prerendering page \"/sync-headers\". Read more: https://nextjs.org/docs/messages/prerender-error\n                  TypeError: <module-function>().get is not a function\n-                     at a (bundler:///app/sync-headers/page.tsx:18:40)\n+                     at a (app/sync-headers/page.tsx:18:40)\n                      at b (<anonymous>)\n                    16 | async function HeadersReadingComponent() {\n                    17 |   // Cast to any as we removed UnsafeUnwrapped types, but still need to test with the sync access\n@@ -1677,9 +1758,10 @@ describe('Cache Components Errors', () => {\n             )\n \n             if (isDebugPrerender) {\n-              expect(output).toMatchInlineSnapshot(`\n+              if (isTurbopack) {\n+                expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-attribution/guarded-async-unguarded-clientsync\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n-                     at SyncIO (bundler:///app/sync-attribution/guarded-async-unguarded-clientsync/client.tsx:5:16)\n+                     at SyncIO (app/sync-attribution/guarded-async-unguarded-clientsync/client.tsx:5:16)\n                    3 | export function SyncIO() {\n                    4 |   // This is a sync IO access that should not cause an error\n                  > 5 |   const data = new Date().toISOString()\n@@ -1693,11 +1775,29 @@ describe('Cache Components Errors', () => {\n                  > Export encountered errors on following paths:\n                  \t/sync-attribution/guarded-async-unguarded-clientsync/page: /sync-attribution/guarded-async-unguarded-clientsync\"\n                 `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: Route \"/sync-attribution/guarded-async-unguarded-clientsync\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n+                     at SyncIO (webpack:///app/sync-attribution/guarded-async-unguarded-clientsync/client.tsx:5:16)\n+                   3 | export function SyncIO() {\n+                   4 |   // This is a sync IO access that should not cause an error\n+                 > 5 |   const data = new Date().toISOString()\n+                     |                ^\n+                   6 |\n+                   7 |   return (\n+                   8 |     <main>\n+                 To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-attribution/guarded-async-unguarded-clientsync\" in your browser to investigate the error.\n+                 Error occurred prerendering page \"/sync-attribution/guarded-async-unguarded-clientsync\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+                 > Export encountered errors on following paths:\n+                 \t/sync-attribution/guarded-async-unguarded-clientsync/page: /sync-attribution/guarded-async-unguarded-clientsync\"\n+                `)\n+              }\n             } else {\n               if (isTurbopack) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-attribution/guarded-async-unguarded-clientsync\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n-                     at a (bundler:///app/sync-attribution/guarded-async-unguarded-clientsync/client.tsx:5:16)\n+                     at a (app/sync-attribution/guarded-async-unguarded-clientsync/client.tsx:5:16)\n                    3 | export function SyncIO() {\n                    4 |   // This is a sync IO access that should not cause an error\n                  > 5 |   const data = new Date().toISOString()\n@@ -1923,9 +2023,10 @@ describe('Cache Components Errors', () => {\n             )\n \n             if (isDebugPrerender) {\n-              expect(output).toMatchInlineSnapshot(`\n+              if (isTurbopack) {\n+                expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-attribution/unguarded-async-unguarded-clientsync\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n-                     at SyncIO (bundler:///app/sync-attribution/unguarded-async-unguarded-clientsync/client.tsx:5:16)\n+                     at SyncIO (app/sync-attribution/unguarded-async-unguarded-clientsync/client.tsx:5:16)\n                    3 | export function SyncIO() {\n                    4 |   // This is a sync IO access that should not cause an error\n                  > 5 |   const data = new Date().toISOString()\n@@ -1939,11 +2040,29 @@ describe('Cache Components Errors', () => {\n                  > Export encountered errors on following paths:\n                  \t/sync-attribution/unguarded-async-unguarded-clientsync/page: /sync-attribution/unguarded-async-unguarded-clientsync\"\n                 `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: Route \"/sync-attribution/unguarded-async-unguarded-clientsync\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n+                     at SyncIO (webpack:///app/sync-attribution/unguarded-async-unguarded-clientsync/client.tsx:5:16)\n+                   3 | export function SyncIO() {\n+                   4 |   // This is a sync IO access that should not cause an error\n+                 > 5 |   const data = new Date().toISOString()\n+                     |                ^\n+                   6 |\n+                   7 |   return (\n+                   8 |     <main>\n+                 To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-attribution/unguarded-async-unguarded-clientsync\" in your browser to investigate the error.\n+                 Error occurred prerendering page \"/sync-attribution/unguarded-async-unguarded-clientsync\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+                 > Export encountered errors on following paths:\n+                 \t/sync-attribution/unguarded-async-unguarded-clientsync/page: /sync-attribution/unguarded-async-unguarded-clientsync\"\n+                `)\n+              }\n             } else {\n               if (isTurbopack) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-attribution/unguarded-async-unguarded-clientsync\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n-                     at a (bundler:///app/sync-attribution/unguarded-async-unguarded-clientsync/client.tsx:5:16)\n+                     at a (app/sync-attribution/unguarded-async-unguarded-clientsync/client.tsx:5:16)\n                    3 | export function SyncIO() {\n                    4 |   // This is a sync IO access that should not cause an error\n                  > 5 |   const data = new Date().toISOString()\n@@ -2013,7 +2132,7 @@ describe('Cache Components Errors', () => {\n               if (isDebugPrerender) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-cookies used \\`cookies()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`cookies()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n-                     at CookiesReadingComponent (bundler:///app/use-cache-cookies/page.tsx:22:18)\n+                     at CookiesReadingComponent (app/use-cache-cookies/page.tsx:22:18)\n                    20 |   // in userland.\n                    21 |   try {\n                  > 22 |     await cookies()\n@@ -2030,7 +2149,7 @@ describe('Cache Components Errors', () => {\n               } else {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-cookies used \\`cookies()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`cookies()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n-                     at <unknown> (bundler:///app/use-cache-cookies/page.tsx:22:11)\n+                     at <unknown> (app/use-cache-cookies/page.tsx:22:11)\n                    20 |   // in userland.\n                    21 |   try {\n                  > 22 |     await cookies()\n@@ -2049,8 +2168,8 @@ describe('Cache Components Errors', () => {\n               if (isDebugPrerender) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-cookies used \\`cookies()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`cookies()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n-                     at CookiesReadingComponent (bundler:///app/use-cache-cookies/page.tsx:22:18)\n-                     at <unknown> (bundler:///<next-src>)\n+                     at CookiesReadingComponent (webpack:///app/use-cache-cookies/page.tsx:22:18)\n+                     at <unknown> (webpack:///<next-src>)\n                    20 |   // in userland.\n                    21 |   try {\n                  > 22 |     await cookies()\n@@ -2117,9 +2236,27 @@ describe('Cache Components Errors', () => {\n             )\n \n             if (isDebugPrerender) {\n-              expect(output).toMatchInlineSnapshot(`\n+              if (isTurbopack) {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: Route /use-cache-draft-mode used \"draftMode().enable()\" inside \"use cache\". The enabled status of \\`draftMode()\\` can be read in caches but you must not enable or disable \\`draftMode()\\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n+                     at DraftModeEnablingComponent (app/use-cache-draft-mode/page.tsx:20:26)\n+                   18 |   // here to ensure that this error is shown even when it's caught in userland.\n+                   19 |   try {\n+                 > 20 |     ;(await draftMode()).enable()\n+                      |                          ^\n+                   21 |   } catch {}\n+                   22 |\n+                   23 |   return null\n+                 To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/use-cache-draft-mode\" in your browser to investigate the error.\n+                 Error occurred prerendering page \"/use-cache-draft-mode\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+                 > Export encountered errors on following paths:\n+                 \t/use-cache-draft-mode/page: /use-cache-draft-mode\"\n+                `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-draft-mode used \"draftMode().enable()\" inside \"use cache\". The enabled status of \\`draftMode()\\` can be read in caches but you must not enable or disable \\`draftMode()\\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n-                     at DraftModeEnablingComponent (bundler:///app/use-cache-draft-mode/page.tsx:20:26)\n+                     at DraftModeEnablingComponent (webpack:///app/use-cache-draft-mode/page.tsx:20:26)\n                    18 |   // here to ensure that this error is shown even when it's caught in userland.\n                    19 |   try {\n                  > 20 |     ;(await draftMode()).enable()\n@@ -2133,11 +2270,12 @@ describe('Cache Components Errors', () => {\n                  > Export encountered errors on following paths:\n                  \t/use-cache-draft-mode/page: /use-cache-draft-mode\"\n                 `)\n+              }\n             } else {\n               if (isTurbopack) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-draft-mode used \"draftMode().enable()\" inside \"use cache\". The enabled status of \\`draftMode()\\` can be read in caches but you must not enable or disable \\`draftMode()\\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n-                     at <unknown> (bundler:///app/use-cache-draft-mode/page.tsx:20:26)\n+                     at <unknown> (app/use-cache-draft-mode/page.tsx:20:26)\n                    18 |   // here to ensure that this error is shown even when it's caught in userland.\n                    19 |   try {\n                  > 20 |     ;(await draftMode()).enable()\n@@ -2205,7 +2343,7 @@ describe('Cache Components Errors', () => {\n               if (isDebugPrerender) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-headers used \\`headers()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`headers()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n-                     at HeadersReadingComponent (bundler:///app/use-cache-headers/page.tsx:21:18)\n+                     at HeadersReadingComponent (app/use-cache-headers/page.tsx:21:18)\n                    19 |   // to ensure that this error is shown even when it's caught in userland.\n                    20 |   try {\n                  > 21 |     await headers()\n@@ -2222,7 +2360,7 @@ describe('Cache Components Errors', () => {\n               } else {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-headers used \\`headers()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`headers()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n-                     at <unknown> (bundler:///app/use-cache-headers/page.tsx:21:11)\n+                     at <unknown> (app/use-cache-headers/page.tsx:21:11)\n                    19 |   // to ensure that this error is shown even when it's caught in userland.\n                    20 |   try {\n                  > 21 |     await headers()\n@@ -2241,8 +2379,8 @@ describe('Cache Components Errors', () => {\n               if (isDebugPrerender) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-headers used \\`headers()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`headers()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n-                     at HeadersReadingComponent (bundler:///app/use-cache-headers/page.tsx:21:18)\n-                     at <unknown> (bundler:///<next-src>)\n+                     at HeadersReadingComponent (webpack:///app/use-cache-headers/page.tsx:21:18)\n+                     at <unknown> (webpack:///<next-src>)\n                    19 |   // to ensure that this error is shown even when it's caught in userland.\n                    20 |   try {\n                  > 21 |     await headers()\n@@ -2684,10 +2822,11 @@ describe('Cache Components Errors', () => {\n             )\n \n             if (isDebugPrerender) {\n-              expect(output).toMatchInlineSnapshot(`\n+              if (isTurbopack) {\n+                expect(output).toMatchInlineSnapshot(`\n                  \"Error: \"use cache: private\" must not be used within \\`unstable_cache()\\`.\n-                     at <unknown> (bundler:///app/use-cache-private-in-unstable-cache/page.tsx:21:38)\n-                     at async ComponentWithCachedData (bundler:///app/use-cache-private-in-unstable-cache/page.tsx:16:16)\n+                     at <unknown> (app/use-cache-private-in-unstable-cache/page.tsx:21:38)\n+                     at async ComponentWithCachedData (app/use-cache-private-in-unstable-cache/page.tsx:16:16)\n                    19 | }\n                    20 |\n                  > 21 | const getCachedData = unstable_cache(async () => {\n@@ -2701,12 +2840,31 @@ describe('Cache Components Errors', () => {\n                  > Export encountered errors on following paths:\n                  \t/use-cache-private-in-unstable-cache/page: /use-cache-private-in-unstable-cache\"\n                 `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: \"use cache: private\" must not be used within \\`unstable_cache()\\`.\n+                     at <unknown> (webpack:///app/use-cache-private-in-unstable-cache/page.tsx:21:38)\n+                     at async ComponentWithCachedData (webpack:///app/use-cache-private-in-unstable-cache/page.tsx:16:16)\n+                   19 | }\n+                   20 |\n+                 > 21 | const getCachedData = unstable_cache(async () => {\n+                      |                                      ^\n+                   22 |   'use cache: private'\n+                   23 |\n+                   24 |   return fetch('https://next-data-api-endpoint.vercel.app/api/random').then(\n+                 To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/use-cache-private-in-unstable-cache\" in your browser to investigate the error.\n+                 Error occurred prerendering page \"/use-cache-private-in-unstable-cache\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+                 > Export encountered errors on following paths:\n+                 \t/use-cache-private-in-unstable-cache/page: /use-cache-private-in-unstable-cache\"\n+                `)\n+              }\n             } else {\n               if (isTurbopack) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: \"use cache: private\" must not be used within \\`unstable_cache()\\`.\n-                     at <unknown> (bundler:///app/use-cache-private-in-unstable-cache/page.tsx:21:38)\n-                     at async h (bundler:///app/use-cache-private-in-unstable-cache/page.tsx:16:16)\n+                     at <unknown> (app/use-cache-private-in-unstable-cache/page.tsx:21:38)\n+                     at async h (app/use-cache-private-in-unstable-cache/page.tsx:16:16)\n                    19 | }\n                    20 |\n                  > 21 | const getCachedData = unstable_cache(async () => {\n@@ -2775,9 +2933,10 @@ describe('Cache Components Errors', () => {\n \n             // TODO: Ideally, the error should only be shown once.\n             if (isDebugPrerender) {\n-              expect(output).toMatchInlineSnapshot(`\n+              if (isTurbopack) {\n+                expect(output).toMatchInlineSnapshot(`\n                  \"Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n-                     at Private (bundler:///app/use-cache-private-in-use-cache/page.tsx:15:1)\n+                     at Private (app/use-cache-private-in-use-cache/page.tsx:15:1)\n                      at stringify (<anonymous>)\n                    13 | }\n                    14 |\n@@ -2787,7 +2946,35 @@ describe('Cache Components Errors', () => {\n                    17 |\n                    18 |   return <p>Private</p>\n                  Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n-                     at Private (bundler:///app/use-cache-private-in-use-cache/page.tsx:15:1)\n+                     at Private (app/use-cache-private-in-use-cache/page.tsx:15:1)\n+                     at stringify (<anonymous>)\n+                   13 | }\n+                   14 |\n+                 > 15 | async function Private() {\n+                      | ^\n+                   16 |   'use cache: private'\n+                   17 |\n+                   18 |   return <p>Private</p>\n+                 To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/use-cache-private-in-use-cache\" in your browser to investigate the error.\n+                 Error occurred prerendering page \"/use-cache-private-in-use-cache\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+                 > Export encountered errors on following paths:\n+                 \t/use-cache-private-in-use-cache/page: /use-cache-private-in-use-cache\"\n+                `)\n+              } else\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n+                     at Private (webpack:///app/use-cache-private-in-use-cache/page.tsx:15:1)\n+                     at stringify (<anonymous>)\n+                   13 | }\n+                   14 |\n+                 > 15 | async function Private() {\n+                      | ^\n+                   16 |   'use cache: private'\n+                   17 |\n+                   18 |   return <p>Private</p>\n+                 Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n+                     at Private (webpack:///app/use-cache-private-in-use-cache/page.tsx:15:1)\n                      at stringify (<anonymous>)\n                    13 | }\n                    14 |\n@@ -2806,7 +2993,7 @@ describe('Cache Components Errors', () => {\n               if (isTurbopack) {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n-                     at <unknown> (bundler:///app/use-cache-private-in-use-cache/page.tsx:15:1)\n+                     at <unknown> (app/use-cache-private-in-use-cache/page.tsx:15:1)\n                      at a (<anonymous>)\n                    13 | }\n                    14 |\n@@ -2816,7 +3003,7 @@ describe('Cache Components Errors', () => {\n                    17 |\n                    18 |   return <p>Private</p>\n                  Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n-                     at <unknown> (bundler:///app/use-cache-private-in-use-cache/page.tsx:15:1)\n+                     at <unknown> (app/use-cache-private-in-use-cache/page.tsx:15:1)\n                      at b (<anonymous>)\n                    13 | }\n                    14 |\n@@ -3062,9 +3249,10 @@ describe('Cache Components Errors', () => {\n           )\n \n           if (isDebugPrerender) {\n-            expect(output).toMatchInlineSnapshot(`\n+            if (isTurbopack) {\n+              expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-current-time/date\" used \\`Date()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing the current time in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time\n-                   at DateReadingComponent (bundler:///app/sync-io-current-time/date/page.tsx:19:16)\n+                   at DateReadingComponent (app/sync-io-current-time/date/page.tsx:19:16)\n                  17 | async function DateReadingComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{Date()}</div>\n@@ -3077,11 +3265,28 @@ describe('Cache Components Errors', () => {\n                > Export encountered errors on following paths:\n                \t/sync-io-current-time/date/page: /sync-io-current-time/date\"\n               `)\n+            } else {\n+              expect(output).toMatchInlineSnapshot(`\n+               \"Error: Route \"/sync-io-current-time/date\" used \\`Date()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing the current time in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time\n+                   at DateReadingComponent (webpack:///app/sync-io-current-time/date/page.tsx:19:16)\n+                 17 | async function DateReadingComponent() {\n+                 18 |   await new Promise((r) => process.nextTick(r))\n+               > 19 |   return <div>{Date()}</div>\n+                    |                ^\n+                 20 | }\n+                 21 |\n+               To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-io-current-time/date\" in your browser to investigate the error.\n+               Error occurred prerendering page \"/sync-io-current-time/date\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+               > Export encountered errors on following paths:\n+               \t/sync-io-current-time/date/page: /sync-io-current-time/date\"\n+              `)\n+            }\n           } else {\n             if (isTurbopack) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-current-time/date\" used \\`Date()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing the current time in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time\n-                   at a (bundler:///app/sync-io-current-time/date/page.tsx:19:16)\n+                   at a (app/sync-io-current-time/date/page.tsx:19:16)\n                  17 | async function DateReadingComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{Date()}</div>\n@@ -3147,9 +3352,10 @@ describe('Cache Components Errors', () => {\n           )\n \n           if (isDebugPrerender) {\n-            expect(output).toMatchInlineSnapshot(`\n+            if (isTurbopack) {\n+              expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-current-time/date-now\" used \\`Date.now()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing the current time in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time\n-                   at DateReadingComponent (bundler:///app/sync-io-current-time/date-now/page.tsx:19:21)\n+                   at DateReadingComponent (app/sync-io-current-time/date-now/page.tsx:19:21)\n                  17 | async function DateReadingComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{Date.now()}</div>\n@@ -3162,11 +3368,28 @@ describe('Cache Components Errors', () => {\n                > Export encountered errors on following paths:\n                \t/sync-io-current-time/date-now/page: /sync-io-current-time/date-now\"\n               `)\n+            } else {\n+              expect(output).toMatchInlineSnapshot(`\n+               \"Error: Route \"/sync-io-current-time/date-now\" used \\`Date.now()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing the current time in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time\n+                   at DateReadingComponent (webpack:///app/sync-io-current-time/date-now/page.tsx:19:21)\n+                 17 | async function DateReadingComponent() {\n+                 18 |   await new Promise((r) => process.nextTick(r))\n+               > 19 |   return <div>{Date.now()}</div>\n+                    |                     ^\n+                 20 | }\n+                 21 |\n+               To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-io-current-time/date-now\" in your browser to investigate the error.\n+               Error occurred prerendering page \"/sync-io-current-time/date-now\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+               > Export encountered errors on following paths:\n+               \t/sync-io-current-time/date-now/page: /sync-io-current-time/date-now\"\n+              `)\n+            }\n           } else {\n             if (isTurbopack) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-current-time/date-now\" used \\`Date.now()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing the current time in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time\n-                   at a (bundler:///app/sync-io-current-time/date-now/page.tsx:19:21)\n+                   at a (app/sync-io-current-time/date-now/page.tsx:19:21)\n                  17 | async function DateReadingComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{Date.now()}</div>\n@@ -3232,9 +3455,10 @@ describe('Cache Components Errors', () => {\n           )\n \n           if (isDebugPrerender) {\n-            expect(output).toMatchInlineSnapshot(`\n+            if (isTurbopack) {\n+              expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-current-time/new-date\" used \\`new Date()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing the current time in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time\n-                   at DateReadingComponent (bundler:///app/sync-io-current-time/new-date/page.tsx:19:16)\n+                   at DateReadingComponent (app/sync-io-current-time/new-date/page.tsx:19:16)\n                  17 | async function DateReadingComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{new Date().toString()}</div>\n@@ -3247,11 +3471,28 @@ describe('Cache Components Errors', () => {\n                > Export encountered errors on following paths:\n                \t/sync-io-current-time/new-date/page: /sync-io-current-time/new-date\"\n               `)\n+            } else {\n+              expect(output).toMatchInlineSnapshot(`\n+               \"Error: Route \"/sync-io-current-time/new-date\" used \\`new Date()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing the current time in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time\n+                   at DateReadingComponent (webpack:///app/sync-io-current-time/new-date/page.tsx:19:16)\n+                 17 | async function DateReadingComponent() {\n+                 18 |   await new Promise((r) => process.nextTick(r))\n+               > 19 |   return <div>{new Date().toString()}</div>\n+                    |                ^\n+                 20 | }\n+                 21 |\n+               To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-io-current-time/new-date\" in your browser to investigate the error.\n+               Error occurred prerendering page \"/sync-io-current-time/new-date\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+               > Export encountered errors on following paths:\n+               \t/sync-io-current-time/new-date/page: /sync-io-current-time/new-date\"\n+              `)\n+            }\n           } else {\n             if (isTurbopack) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-current-time/new-date\" used \\`new Date()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing the current time in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time\n-                   at a (bundler:///app/sync-io-current-time/new-date/page.tsx:19:16)\n+                   at a (app/sync-io-current-time/new-date/page.tsx:19:16)\n                  17 | async function DateReadingComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{new Date().toString()}</div>\n@@ -3317,9 +3558,10 @@ describe('Cache Components Errors', () => {\n           )\n \n           if (isDebugPrerender) {\n-            expect(output).toMatchInlineSnapshot(`\n+            if (isTurbopack) {\n+              expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-random/math-random\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-random/math-random/page.tsx:19:21)\n+                   at SyncIOComponent (app/sync-io-random/math-random/page.tsx:19:21)\n                  17 | async function SyncIOComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{Math.random()}</div>\n@@ -3332,11 +3574,28 @@ describe('Cache Components Errors', () => {\n                > Export encountered errors on following paths:\n                \t/sync-io-random/math-random/page: /sync-io-random/math-random\"\n               `)\n+            } else {\n+              expect(output).toMatchInlineSnapshot(`\n+               \"Error: Route \"/sync-io-random/math-random\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n+                   at SyncIOComponent (webpack:///app/sync-io-random/math-random/page.tsx:19:21)\n+                 17 | async function SyncIOComponent() {\n+                 18 |   await new Promise((r) => process.nextTick(r))\n+               > 19 |   return <div>{Math.random()}</div>\n+                    |                     ^\n+                 20 | }\n+                 21 |\n+               To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-io-random/math-random\" in your browser to investigate the error.\n+               Error occurred prerendering page \"/sync-io-random/math-random\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+               > Export encountered errors on following paths:\n+               \t/sync-io-random/math-random/page: /sync-io-random/math-random\"\n+              `)\n+            }\n           } else {\n             if (isTurbopack) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-random/math-random\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at a (bundler:///app/sync-io-random/math-random/page.tsx:19:21)\n+                   at a (app/sync-io-random/math-random/page.tsx:19:21)\n                  17 | async function SyncIOComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{Math.random()}</div>\n@@ -3402,9 +3661,10 @@ describe('Cache Components Errors', () => {\n           )\n \n           if (isDebugPrerender) {\n-            expect(output).toMatchInlineSnapshot(`\n+            if (isTurbopack) {\n+              expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-web-crypto/get-random-value\" used \\`crypto.getRandomValues()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random cryptographic values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-crypto\n-                   at SyncIOComponent (bundler:///app/sync-io-web-crypto/get-random-value/page.tsx:20:10)\n+                   at SyncIOComponent (app/sync-io-web-crypto/get-random-value/page.tsx:20:10)\n                  18 |   await new Promise((r) => process.nextTick(r))\n                  19 |   const buffer = new Uint8Array(8)\n                > 20 |   crypto.getRandomValues(buffer)\n@@ -3418,11 +3678,29 @@ describe('Cache Components Errors', () => {\n                > Export encountered errors on following paths:\n                \t/sync-io-web-crypto/get-random-value/page: /sync-io-web-crypto/get-random-value\"\n               `)\n+            } else {\n+              expect(output).toMatchInlineSnapshot(`\n+               \"Error: Route \"/sync-io-web-crypto/get-random-value\" used \\`crypto.getRandomValues()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random cryptographic values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-crypto\n+                   at SyncIOComponent (webpack:///app/sync-io-web-crypto/get-random-value/page.tsx:20:10)\n+                 18 |   await new Promise((r) => process.nextTick(r))\n+                 19 |   const buffer = new Uint8Array(8)\n+               > 20 |   crypto.getRandomValues(buffer)\n+                    |          ^\n+                 21 |   return <div>{buffer.toString()}</div>\n+                 22 | }\n+                 23 |\n+               To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-io-web-crypto/get-random-value\" in your browser to investigate the error.\n+               Error occurred prerendering page \"/sync-io-web-crypto/get-random-value\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+               > Export encountered errors on following paths:\n+               \t/sync-io-web-crypto/get-random-value/page: /sync-io-web-crypto/get-random-value\"\n+              `)\n+            }\n           } else {\n             if (isTurbopack) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-web-crypto/get-random-value\" used \\`crypto.getRandomValues()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random cryptographic values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-crypto\n-                   at a (bundler:///app/sync-io-web-crypto/get-random-value/page.tsx:20:10)\n+                   at a (app/sync-io-web-crypto/get-random-value/page.tsx:20:10)\n                  18 |   await new Promise((r) => process.nextTick(r))\n                  19 |   const buffer = new Uint8Array(8)\n                > 20 |   crypto.getRandomValues(buffer)\n@@ -3489,9 +3767,10 @@ describe('Cache Components Errors', () => {\n           )\n \n           if (isDebugPrerender) {\n-            expect(output).toMatchInlineSnapshot(`\n+            if (isTurbopack) {\n+              expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-web-crypto/random-uuid\" used \\`crypto.randomUUID()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random cryptographic values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-crypto\n-                   at SyncIOComponent (bundler:///app/sync-io-web-crypto/random-uuid/page.tsx:19:23)\n+                   at SyncIOComponent (app/sync-io-web-crypto/random-uuid/page.tsx:19:23)\n                  17 | async function SyncIOComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{crypto.randomUUID()}</div>\n@@ -3504,11 +3783,28 @@ describe('Cache Components Errors', () => {\n                > Export encountered errors on following paths:\n                \t/sync-io-web-crypto/random-uuid/page: /sync-io-web-crypto/random-uuid\"\n               `)\n+            } else {\n+              expect(output).toMatchInlineSnapshot(`\n+               \"Error: Route \"/sync-io-web-crypto/random-uuid\" used \\`crypto.randomUUID()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random cryptographic values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-crypto\n+                   at SyncIOComponent (webpack:///app/sync-io-web-crypto/random-uuid/page.tsx:19:23)\n+                 17 | async function SyncIOComponent() {\n+                 18 |   await new Promise((r) => process.nextTick(r))\n+               > 19 |   return <div>{crypto.randomUUID()}</div>\n+                    |                       ^\n+                 20 | }\n+                 21 |\n+               To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-io-web-crypto/random-uuid\" in your browser to investigate the error.\n+               Error occurred prerendering page \"/sync-io-web-crypto/random-uuid\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+               > Export encountered errors on following paths:\n+               \t/sync-io-web-crypto/random-uuid/page: /sync-io-web-crypto/random-uuid\"\n+              `)\n+            }\n           } else {\n             if (isTurbopack) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-web-crypto/random-uuid\" used \\`crypto.randomUUID()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random cryptographic values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-crypto\n-                   at a (bundler:///app/sync-io-web-crypto/random-uuid/page.tsx:19:23)\n+                   at a (app/sync-io-web-crypto/random-uuid/page.tsx:19:23)\n                  17 | async function SyncIOComponent() {\n                  18 |   await new Promise((r) => process.nextTick(r))\n                > 19 |   return <div>{crypto.randomUUID()}</div>\n@@ -3595,7 +3891,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/generate-key-pair-sync\" used \\`require('node:crypto').generateKeyPairSync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/generate-key-pair-sync/page.tsx:20:24)\n+                   at SyncIOComponent (app/sync-io-node-crypto/generate-key-pair-sync/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.generateKeyPairSync('rsa', keyGenOptions)\n@@ -3612,7 +3908,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/generate-key-pair-sync\" used \\`require('node:crypto').generateKeyPairSync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at a (bundler:///app/sync-io-node-crypto/generate-key-pair-sync/page.tsx:20:24)\n+                   at a (app/sync-io-node-crypto/generate-key-pair-sync/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.generateKeyPairSync('rsa', keyGenOptions)\n@@ -3631,7 +3927,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/generate-key-pair-sync\" used \\`require('node:crypto').generateKeyPairSync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/generate-key-pair-sync/page.tsx:20:17)\n+                   at SyncIOComponent (webpack:///app/sync-io-node-crypto/generate-key-pair-sync/page.tsx:20:17)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.generateKeyPairSync('rsa', keyGenOptions)\n@@ -3719,7 +4015,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/generate-key-sync\" used \\`require('node:crypto').generateKeySync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/generate-key-sync/page.tsx:21:6)\n+                   at SyncIOComponent (app/sync-io-node-crypto/generate-key-sync/page.tsx:21:6)\n                  19 |   await new Promise((r) => process.nextTick(r))\n                  20 |   const first = crypto\n                > 21 |     .generateKeySync('hmac', {\n@@ -3736,7 +4032,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/generate-key-sync\" used \\`require('node:crypto').generateKeySync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at a (bundler:///app/sync-io-node-crypto/generate-key-sync/page.tsx:21:6)\n+                   at a (app/sync-io-node-crypto/generate-key-sync/page.tsx:21:6)\n                  19 |   await new Promise((r) => process.nextTick(r))\n                  20 |   const first = crypto\n                > 21 |     .generateKeySync('hmac', {\n@@ -3755,7 +4051,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/generate-key-sync\" used \\`require('node:crypto').generateKeySync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/generate-key-sync/page.tsx:20:17)\n+                   at SyncIOComponent (webpack:///app/sync-io-node-crypto/generate-key-sync/page.tsx:20:17)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto\n@@ -3843,7 +4139,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/generate-prime-sync\" used \\`require('node:crypto').generatePrimeSync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/generate-prime-sync/page.tsx:20:39)\n+                   at SyncIOComponent (app/sync-io-node-crypto/generate-prime-sync/page.tsx:20:39)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = new Uint8Array(crypto.generatePrimeSync(128))\n@@ -3860,7 +4156,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/generate-prime-sync\" used \\`require('node:crypto').generatePrimeSync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at a (bundler:///app/sync-io-node-crypto/generate-prime-sync/page.tsx:20:39)\n+                   at a (app/sync-io-node-crypto/generate-prime-sync/page.tsx:20:39)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = new Uint8Array(crypto.generatePrimeSync(128))\n@@ -3879,7 +4175,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/generate-prime-sync\" used \\`require('node:crypto').generatePrimeSync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/generate-prime-sync/page.tsx:20:32)\n+                   at SyncIOComponent (webpack:///app/sync-io-node-crypto/generate-prime-sync/page.tsx:20:32)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = new Uint8Array(crypto.generatePrimeSync(128))\n@@ -3967,7 +4263,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/get-random-values\" used \\`crypto.getRandomValues()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random cryptographic values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-crypto\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/get-random-values/page.tsx:21:10)\n+                   at SyncIOComponent (app/sync-io-node-crypto/get-random-values/page.tsx:21:10)\n                  19 |   await new Promise((r) => process.nextTick(r))\n                  20 |   const first = new Uint8Array(8)\n                > 21 |   crypto.getRandomValues(first)\n@@ -3984,7 +4280,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/get-random-values\" used \\`crypto.getRandomValues()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random cryptographic values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-crypto\n-                   at a (bundler:///app/sync-io-node-crypto/get-random-values/page.tsx:21:10)\n+                   at a (app/sync-io-node-crypto/get-random-values/page.tsx:21:10)\n                  19 |   await new Promise((r) => process.nextTick(r))\n                  20 |   const first = new Uint8Array(8)\n                > 21 |   crypto.getRandomValues(first)\n@@ -4003,7 +4299,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/get-random-values\" used \\`crypto.getRandomValues()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random cryptographic values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-crypto\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/get-random-values/page.tsx:21:3)\n+                   at SyncIOComponent (webpack:///app/sync-io-node-crypto/get-random-values/page.tsx:21:3)\n                  19 |   await new Promise((r) => process.nextTick(r))\n                  20 |   const first = new Uint8Array(8)\n                > 21 |   crypto.getRandomValues(first)\n@@ -4091,7 +4387,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-bytes\" used \\`require('node:crypto').randomBytes(size)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-bytes/page.tsx:20:24)\n+                   at SyncIOComponent (app/sync-io-node-crypto/random-bytes/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomBytes(8)\n@@ -4108,7 +4404,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-bytes\" used \\`require('node:crypto').randomBytes(size)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at a (bundler:///app/sync-io-node-crypto/random-bytes/page.tsx:20:24)\n+                   at a (app/sync-io-node-crypto/random-bytes/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomBytes(8)\n@@ -4127,7 +4423,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-bytes\" used \\`require('node:crypto').randomBytes(size)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-bytes/page.tsx:20:17)\n+                   at SyncIOComponent (webpack:///app/sync-io-node-crypto/random-bytes/page.tsx:20:17)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomBytes(8)\n@@ -4215,7 +4511,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-fill-sync\" used \\`require('node:crypto').randomFillSync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-fill-sync/page.tsx:21:10)\n+                   at SyncIOComponent (app/sync-io-node-crypto/random-fill-sync/page.tsx:21:10)\n                  19 |   await new Promise((r) => process.nextTick(r))\n                  20 |   const first = new Uint8Array(16)\n                > 21 |   crypto.randomFillSync(first, 4, 8)\n@@ -4232,7 +4528,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-fill-sync\" used \\`require('node:crypto').randomFillSync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at a (bundler:///app/sync-io-node-crypto/random-fill-sync/page.tsx:21:10)\n+                   at a (app/sync-io-node-crypto/random-fill-sync/page.tsx:21:10)\n                  19 |   await new Promise((r) => process.nextTick(r))\n                  20 |   const first = new Uint8Array(16)\n                > 21 |   crypto.randomFillSync(first, 4, 8)\n@@ -4251,7 +4547,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-fill-sync\" used \\`require('node:crypto').randomFillSync(...)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-fill-sync/page.tsx:21:3)\n+                   at SyncIOComponent (webpack:///app/sync-io-node-crypto/random-fill-sync/page.tsx:21:3)\n                  19 |   await new Promise((r) => process.nextTick(r))\n                  20 |   const first = new Uint8Array(16)\n                > 21 |   crypto.randomFillSync(first, 4, 8)\n@@ -4339,7 +4635,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-int-between\" used \\`require('node:crypto').randomInt(min, max)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-int-between/page.tsx:20:24)\n+                   at SyncIOComponent (app/sync-io-node-crypto/random-int-between/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomInt(128, 256)\n@@ -4356,7 +4652,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-int-between\" used \\`require('node:crypto').randomInt(min, max)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at a (bundler:///app/sync-io-node-crypto/random-int-between/page.tsx:20:24)\n+                   at a (app/sync-io-node-crypto/random-int-between/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomInt(128, 256)\n@@ -4375,7 +4671,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-int-between\" used \\`require('node:crypto').randomInt(min, max)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-int-between/page.tsx:20:17)\n+                   at SyncIOComponent (webpack:///app/sync-io-node-crypto/random-int-between/page.tsx:20:17)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomInt(128, 256)\n@@ -4463,7 +4759,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-int-up-to\" used \\`require('node:crypto').randomInt(min, max)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-int-up-to/page.tsx:20:24)\n+                   at SyncIOComponent (app/sync-io-node-crypto/random-int-up-to/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomInt(128)\n@@ -4480,7 +4776,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-int-up-to\" used \\`require('node:crypto').randomInt(min, max)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at a (bundler:///app/sync-io-node-crypto/random-int-up-to/page.tsx:20:24)\n+                   at a (app/sync-io-node-crypto/random-int-up-to/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomInt(128)\n@@ -4499,7 +4795,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-int-up-to\" used \\`require('node:crypto').randomInt(min, max)\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-int-up-to/page.tsx:20:17)\n+                   at SyncIOComponent (webpack:///app/sync-io-node-crypto/random-int-up-to/page.tsx:20:17)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomInt(128)\n@@ -4587,7 +4883,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-uuid\" used \\`require('node:crypto').randomUUID()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-uuid/page.tsx:20:24)\n+                   at SyncIOComponent (app/sync-io-node-crypto/random-uuid/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomUUID()\n@@ -4604,7 +4900,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-uuid\" used \\`require('node:crypto').randomUUID()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at a (bundler:///app/sync-io-node-crypto/random-uuid/page.tsx:20:24)\n+                   at a (app/sync-io-node-crypto/random-uuid/page.tsx:20:24)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomUUID()\n@@ -4623,7 +4919,7 @@ describe('Cache Components Errors', () => {\n             if (isDebugPrerender) {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/sync-io-node-crypto/random-uuid\" used \\`require('node:crypto').randomUUID()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-                   at SyncIOComponent (bundler:///app/sync-io-node-crypto/random-uuid/page.tsx:20:17)\n+                   at SyncIOComponent (webpack:///app/sync-io-node-crypto/random-uuid/page.tsx:20:17)\n                  18 | async function SyncIOComponent() {\n                  19 |   await new Promise((r) => process.nextTick(r))\n                > 20 |   const first = crypto.randomUUID()"
        },
        {
            "sha": "01d8cb406c1286c5688a003a0e52b1566eed6537",
            "filename": "test/e2e/app-dir/cache-components-errors/utils.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/d98589eff452e640500be20c84b5efecbcbb540d/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/d98589eff452e640500be20c84b5efecbcbb540d/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Futils.ts?ref=d98589eff452e640500be20c84b5efecbcbb540d",
            "patch": "@@ -111,9 +111,6 @@ export function getPrerenderOutput(\n         )\n         .replace(/at \\d+ \\(/, replaceNumericModuleId)\n         .replace(/digest: '\\d+'/, \"digest: '<error-digest>'\")\n-        // TODO(veil): Bundler protocols should not appear in stack frames.\n-        .replace('webpack:///', 'bundler:///')\n-        .replace('turbopack:///[project]/', 'bundler:///')\n \n       lines.push(convertModuleFunctionSequenceExpression(line))\n     }"
        },
        {
            "sha": "edc0a365bd35e2a04b10fb776a7a5124f14e9ab4",
            "filename": "test/e2e/app-dir/server-source-maps/server-source-maps.test.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 8,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/d98589eff452e640500be20c84b5efecbcbb540d/test%2Fe2e%2Fapp-dir%2Fserver-source-maps%2Fserver-source-maps.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/d98589eff452e640500be20c84b5efecbcbb540d/test%2Fe2e%2Fapp-dir%2Fserver-source-maps%2Fserver-source-maps.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fserver-source-maps%2Fserver-source-maps.test.ts?ref=d98589eff452e640500be20c84b5efecbcbb540d",
            "patch": "@@ -8,7 +8,6 @@ function normalizeCliOutput(output: string) {\n     stripAnsi(output)\n       // TODO(veil): Should not appear in sourcemapped stackframes.\n       .replaceAll('webpack:///', 'bundler:///')\n-      .replaceAll('turbopack:///[project]/', 'bundler:///')\n       .replaceAll(/at [a-zA-Z] \\(/g, 'at <mangled> (')\n   )\n }\n@@ -55,9 +54,9 @@ describe('app-dir - server source maps', () => {\n     } else {\n       if (isTurbopack) {\n         // TODO(veil): Sourcemap names\n-        // TODO(veil): relative paths\n+        // TODO(veil): relative paths in webpack\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n-          '(bundler:///app/rsc-error-log/page.js:4:17)'\n+          '(app/rsc-error-log/page.js:4:17)'\n         )\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n           '' +\n@@ -106,10 +105,10 @@ describe('app-dir - server source maps', () => {\n         // TODO(veil): Sourcemap names\n         // TODO(veil): relative paths\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n-          '(bundler:///app/rsc-error-log-cause/page.js:2:17)'\n+          '(app/rsc-error-log-cause/page.js:2:17)'\n         )\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n-          '(bundler:///app/rsc-error-log-cause/page.js:7:17)'\n+          '(app/rsc-error-log-cause/page.js:7:17)'\n         )\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n           '' +\n@@ -230,7 +229,7 @@ describe('app-dir - server source maps', () => {\n         // TODO(veil): Sourcemap names\n         // TODO(veil): relative paths\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n-          '(bundler:///app/ssr-error-log-ignore-listed/page.js:9:17)'\n+          '(app/ssr-error-log-ignore-listed/page.js:9:17)'\n         )\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n           '\\n' +\n@@ -295,7 +294,7 @@ describe('app-dir - server source maps', () => {\n         // TODO(veil): Sourcemap names\n         // TODO(veil): relative paths\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n-          'at <unknown> (bundler:///app/rsc-error-log-ignore-listed/page.js:8:17)'\n+          'at <unknown> (app/rsc-error-log-ignore-listed/page.js:8:17)'\n         )\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n           '' +\n@@ -528,7 +527,7 @@ describe('app-dir - server source maps', () => {\n           '' +\n             '\\nError: module-evaluation' +\n             // TODO(veil): Turbopack internals. Feel free to update. Tracked in https://linear.app/vercel/issue/NEXT-4362\n-            '\\n    at module evaluation (bundler:///app/module-evaluation/module.js:1:22)'\n+            '\\n    at module evaluation (app/module-evaluation/module.js:1:22)'\n         )\n         expect(normalizeCliOutput(next.cliOutput)).toContain(\n           '' +"
        },
        {
            "sha": "0655bb1b905947db6ac0b5bccf680abfefb2760a",
            "filename": "test/production/app-dir/build-output-prerender/build-output-prerender.test.ts",
            "status": "modified",
            "additions": 57,
            "deletions": 31,
            "changes": 88,
            "blob_url": "https://github.com/vercel/next.js/blob/d98589eff452e640500be20c84b5efecbcbb540d/test%2Fproduction%2Fapp-dir%2Fbuild-output-prerender%2Fbuild-output-prerender.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/d98589eff452e640500be20c84b5efecbcbb540d/test%2Fproduction%2Fapp-dir%2Fbuild-output-prerender%2Fbuild-output-prerender.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-prerender%2Fbuild-output-prerender.test.ts?ref=d98589eff452e640500be20c84b5efecbcbb540d",
            "patch": "@@ -67,7 +67,7 @@ describe('build-output-prerender', () => {\n           // TODO(veil): Why is the location incomplete unless we enable --no-mangling?\n           expect(getPrerenderOutput(next.cliOutput)).toMatchInlineSnapshot(`\n            \"Error: Route \"/client\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n-               at c (bundler:///app/client/page.tsx:4:28)\n+               at c (app/client/page.tsx:4:28)\n              2 |\n              3 | export default function Page() {\n            > 4 |   return <p>Current time: {new Date().toISOString()}</p>\n@@ -181,32 +181,62 @@ describe('build-output-prerender', () => {\n       })\n \n       it('shows all prerender errors with readable stacks and code frames', async () => {\n-        expect(getPrerenderOutput(next.cliOutput)).toMatchInlineSnapshot(`\n-         \"Error: Route \"/client\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n-             at Page (bundler:///app/client/page.tsx:4:28)\n-           2 |\n-           3 | export default function Page() {\n-         > 4 |   return <p>Current time: {new Date().toISOString()}</p>\n-             |                            ^\n-           5 | }\n-           6 |\n-         To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/client\" in your browser to investigate the error.\n-         Error occurred prerendering page \"/client\". Read more: https://nextjs.org/docs/messages/prerender-error\n-         Error: Route \"/server\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n-             at Page (bundler:///app/server/page.tsx:13:27)\n-           11 |   await cachedDelay()\n-           12 |\n-         > 13 |   return <p>Random: {Math.random()}</p>\n-              |                           ^\n-           14 | }\n-           15 |\n-         To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/server\" in your browser to investigate the error.\n-         Error occurred prerendering page \"/server\". Read more: https://nextjs.org/docs/messages/prerender-error\n+        if (isTurbopack) {\n+          expect(getPrerenderOutput(next.cliOutput)).toMatchInlineSnapshot(`\n+           \"Error: Route \"/client\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n+               at Page (app/client/page.tsx:4:28)\n+             2 |\n+             3 | export default function Page() {\n+           > 4 |   return <p>Current time: {new Date().toISOString()}</p>\n+               |                            ^\n+             5 | }\n+             6 |\n+           To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/client\" in your browser to investigate the error.\n+           Error occurred prerendering page \"/client\". Read more: https://nextjs.org/docs/messages/prerender-error\n+           Error: Route \"/server\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n+               at Page (app/server/page.tsx:13:27)\n+             11 |   await cachedDelay()\n+             12 |\n+           > 13 |   return <p>Random: {Math.random()}</p>\n+                |                           ^\n+             14 | }\n+             15 |\n+           To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/server\" in your browser to investigate the error.\n+           Error occurred prerendering page \"/server\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+           > Export encountered errors on following paths:\n+           \t/client/page: /client\n+           \t/server/page: /server\"\n+          `)\n+        } else {\n+          // TODO(veil): Bundler protocols should not appear in stackframes.\n+          expect(getPrerenderOutput(next.cliOutput)).toMatchInlineSnapshot(`\n+           \"Error: Route \"/client\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n+               at Page (webpack:///app/client/page.tsx:4:28)\n+             2 |\n+             3 | export default function Page() {\n+           > 4 |   return <p>Current time: {new Date().toISOString()}</p>\n+               |                            ^\n+             5 | }\n+             6 |\n+           To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/client\" in your browser to investigate the error.\n+           Error occurred prerendering page \"/client\". Read more: https://nextjs.org/docs/messages/prerender-error\n+           Error: Route \"/server\" used \\`Math.random()\\` before accessing either uncached data (e.g. \\`fetch()\\`) or Request data (e.g. \\`cookies()\\`, \\`headers()\\`, \\`connection()\\`, and \\`searchParams\\`). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: https://nextjs.org/docs/messages/next-prerender-random\n+               at Page (webpack:///app/server/page.tsx:13:27)\n+             11 |   await cachedDelay()\n+             12 |\n+           > 13 |   return <p>Random: {Math.random()}</p>\n+                |                           ^\n+             14 | }\n+             15 |\n+           To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/server\" in your browser to investigate the error.\n+           Error occurred prerendering page \"/server\". Read more: https://nextjs.org/docs/messages/prerender-error\n \n-         > Export encountered errors on following paths:\n-         \t/client/page: /client\n-         \t/server/page: /server\"\n-        `)\n+           > Export encountered errors on following paths:\n+           \t/client/page: /client\n+           \t/server/page: /server\"\n+          `)\n+        }\n       })\n     })\n   })\n@@ -386,11 +416,7 @@ function getPrerenderOutput(cliOutput: string): string {\n \n     if (foundPrerenderingLine && !line.includes('Generating static pages')) {\n       lines.push(\n-        line\n-          .replace(/at \\w+ \\(.next[^)]+\\)/, 'at x (<next-dist-dir>)')\n-          // TODO(veil): Bundler protocols should not appear in stackframes.\n-          .replace('webpack:///', 'bundler:///')\n-          .replace('turbopack:///[project]/', 'bundler:///')\n+        line.replace(/at \\w+ \\(.next[^)]+\\)/, 'at x (<next-dist-dir>)')\n       )\n     }\n   }"
        }
    ],
    "stats": {
        "total": 595,
        "additions": 459,
        "deletions": 136
    }
}