{
    "author": "mischnic",
    "message": "Turbopack: add ffmpeg-static NFT test (#82985)\n\nInclude test added by https://github.com/vercel/nft/pull/539",
    "sha": "e818e64c2db1e9a7870a82b5a148899746ae4df7",
    "files": [
        {
            "sha": "39a9f8127cf23a0023f32b1090c4bdf82fbc2e4b",
            "filename": "turbopack/crates/turbopack/tests/node-file-trace.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/e818e64c2db1e9a7870a82b5a148899746ae4df7/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/e818e64c2db1e9a7870a82b5a148899746ae4df7/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace.rs?ref=e818e64c2db1e9a7870a82b5a148899746ae4df7",
            "patch": "@@ -100,8 +100,9 @@ static ALLOC: turbo_tasks_malloc::TurboMalloc = turbo_tasks_malloc::TurboMalloc;\n #[case::express(\"integration/express.js\")]\n #[case::fast_glob(\"integration/fast-glob.js\")]\n #[case::fetch_h2(\"integration/fetch-h2.js\")]\n-#[cfg_attr(target_arch = \"x86_64\", case::ffmpeg_js(\"integration/ffmpeg.js\"))]\n // Could not find ffmpeg executable\n+#[cfg_attr(target_arch = \"x86_64\", case::ffmpeg_js(\"integration/ffmpeg.js\"))]\n+#[case::ffmpeg_static(\"integration/ffmpeg-static.js\")]\n #[case::firebase_admin(\"integration/firebase-admin.js\")]\n #[case::firebase(\"integration/firebase.js\")]\n #[case::firestore(\"integration/firestore.js\")]"
        },
        {
            "sha": "eeaa211673b33e82637734a15f1bb78690401517",
            "filename": "turbopack/crates/turbopack/tests/node-file-trace/integration/ffmpeg-static.js",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/e818e64c2db1e9a7870a82b5a148899746ae4df7/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace%2Fintegration%2Fffmpeg-static.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e818e64c2db1e9a7870a82b5a148899746ae4df7/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace%2Fintegration%2Fffmpeg-static.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace%2Fintegration%2Fffmpeg-static.js?ref=e818e64c2db1e9a7870a82b5a148899746ae4df7",
            "patch": "@@ -0,0 +1,9 @@\n+const { execFile } = require('child_process')\n+const ffmpeg = require('ffmpeg-static')\n+\n+execFile(ffmpeg, ['-version'], (error, _stdout, stderr) => {\n+  if (error || stderr) {\n+    console.error('Error executing ffmpeg:', error || stderr)\n+    process.exit(1)\n+  }\n+})"
        },
        {
            "sha": "b18641e6eeaa3e5746207454ac953ea593c6eeee",
            "filename": "turbopack/crates/turbopack/tests/node-file-trace/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/e818e64c2db1e9a7870a82b5a148899746ae4df7/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace%2Fpackage.json",
            "raw_url": "https://github.com/vercel/next.js/raw/e818e64c2db1e9a7870a82b5a148899746ae4df7/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace%2Fpackage.json?ref=e818e64c2db1e9a7870a82b5a148899746ae4df7",
            "patch": "@@ -51,8 +51,9 @@\n     \"express\": \"^4.17.1\",\n     \"fast-glob\": \"^3.1.1\",\n     \"fetch-h2\": \"^2.2.0\",\n-    \"firebase\": \"^7\",\n+    \"ffmpeg-static\": \"^5.2.0\",\n     \"firebase-admin\": \"^9.7.0\",\n+    \"firebase\": \"^7\",\n     \"fluent-ffmpeg\": \"^2.1.2\",\n     \"geo-tz\": \"^7.0.1\",\n     \"geoip-lite\": \"^1.4.10\","
        },
        {
            "sha": "7a1f6fe1cb27639af1ebe90d67f4fd6d751dabba",
            "filename": "turbopack/crates/turbopack/tests/node-file-trace/pnpm-lock.yaml",
            "status": "modified",
            "additions": 35,
            "deletions": 2,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/e818e64c2db1e9a7870a82b5a148899746ae4df7/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace%2Fpnpm-lock.yaml",
            "raw_url": "https://github.com/vercel/next.js/raw/e818e64c2db1e9a7870a82b5a148899746ae4df7/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace%2Fpnpm-lock.yaml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Ftests%2Fnode-file-trace%2Fpnpm-lock.yaml?ref=e818e64c2db1e9a7870a82b5a148899746ae4df7",
            "patch": "@@ -156,6 +156,9 @@ importers:\n       fetch-h2:\n         specifier: ^2.2.0\n         version: 2.5.1\n+      ffmpeg-static:\n+        specifier: ^5.2.0\n+        version: 5.2.0\n       firebase:\n         specifier: ^7\n         version: 7.24.0\n@@ -766,6 +769,10 @@ packages:\n     resolution: {integrity: sha512-7KretVkHUANWe31u9cGJpxmUkyrXsCD+fmlZQUz/zk9mtQNC4uBIKX53VUFfrVj/bxAhEEIPw5XTYiMc5RJLsw==}\n     engines: {node: '>=16'}\n \n+  '@derhuerst/http-basic@8.2.4':\n+    resolution: {integrity: sha512-F9rL9k9Xjf5blCz8HsJRO4diy111cayL2vkY2XE4r4t3n0yPXVYy3KD3nJ1qbrSn9743UWSXH4IwuCa/HWlGFw==}\n+    engines: {node: '>=6.0.0'}\n+\n   '@emnapi/runtime@1.4.5':\n     resolution: {integrity: sha512-++LApOtY0pEEz1zrd9vy1/zXVaVJJ/EbAF3u0fXIzPJEDtnITsBGbbK0EkM72amhl/R5b+5xx0Y/QhcVOpuulg==}\n \n@@ -5160,6 +5167,10 @@ packages:\n     resolution: {integrity: sha512-U+LQ+fHwF6TMg82A88wjljC5L174eoJfrc+0g4e7JWqL7U0w0QAoOkPDCGkO9KGH9BY55s4n45gLGOtlTAoqmw==}\n     engines: {node: '>=10.4'}\n \n+  ffmpeg-static@5.2.0:\n+    resolution: {integrity: sha512-WrM7kLW+do9HLr+H6tk7LzQ7kPqbAgLjdzNE32+u3Ff11gXt9Kkkd2nusGFrlWMIe+XaA97t+I8JS7sZIrvRgA==}\n+    engines: {node: '>=16'}\n+\n   file-contents@0.2.4:\n     resolution: {integrity: sha512-PEz7U6YlXr+dvWCtW63DUY1LUTHOVs1rv4s1/I/39dpvvidQqMSTY6JklazQS60MMoI/ztpo5kMlpdvGagvLbA==}\n     engines: {node: '>=0.10.0'}\n@@ -5745,6 +5756,9 @@ packages:\n     resolution: {integrity: sha512-T1gkAiYYDWYx3V5Bmyu7HcfcvL7mUrTWiM6yOfa3PIphViJ/gFPbvidQ+veqSOHci/PxBcDabeUNCzpOODJZig==}\n     engines: {node: '>= 14'}\n \n+  http-response-object@3.0.2:\n+    resolution: {integrity: sha512-bqX0XTF6fnXSQcEJ2Iuyr75yVakyjIDCqroJQ/aHfSdlM743Cwqoi2nDYMzLGWUcuTWGWy8AAvOKXTfiv6q9RA==}\n+\n   http-signature@1.2.0:\n     resolution: {integrity: sha512-CAbnr6Rz4CYQkLYUtSNXxQPUH2gK8f3iWexVlsnMeD+GjlsQ0Xsy1cOX+mN3dtxYomRy21CiOzU8Uhw6OwncEQ==}\n     engines: {node: '>=0.8', npm: '>=1.3.7'}\n@@ -11105,6 +11119,13 @@ snapshots:\n       pprof-format: 2.1.0\n       source-map: 0.7.4\n \n+  '@derhuerst/http-basic@8.2.4':\n+    dependencies:\n+      caseless: 0.12.0\n+      concat-stream: 2.0.0\n+      http-response-object: 3.0.2\n+      parse-cache-control: 1.0.1\n+\n   '@emnapi/runtime@1.4.5':\n     dependencies:\n       tslib: 2.8.1\n@@ -16349,8 +16370,7 @@ snapshots:\n \n   entities@4.5.0: {}\n \n-  env-paths@2.2.1:\n-    optional: true\n+  env-paths@2.2.1: {}\n \n   err-code@2.0.3:\n     optional: true\n@@ -16880,6 +16900,15 @@ snapshots:\n       to-arraybuffer: 1.0.1\n       tough-cookie: 4.1.2\n \n+  ffmpeg-static@5.2.0:\n+    dependencies:\n+      '@derhuerst/http-basic': 8.2.4\n+      env-paths: 2.2.1\n+      https-proxy-agent: 5.0.1\n+      progress: 2.0.3\n+    transitivePeerDependencies:\n+      - supports-color\n+\n   file-contents@0.2.4:\n     dependencies:\n       extend-shallow: 2.0.1\n@@ -17725,6 +17754,10 @@ snapshots:\n     transitivePeerDependencies:\n       - supports-color\n \n+  http-response-object@3.0.2:\n+    dependencies:\n+      '@types/node': 10.17.60\n+\n   http-signature@1.2.0:\n     dependencies:\n       assert-plus: 1.0.0"
        }
    ],
    "stats": {
        "total": 52,
        "additions": 48,
        "deletions": 4
    }
}