{
    "author": "acdlite",
    "message": "Un-skip tests in prefetch-runtime.test.ts (#86097)\n\nThese were temporarily disabled when removed the Link level opt-in for\nruntime prefetching. I fixed the tests by switching to the file-based\nAPI.\n\nprefetch-layout-sharing.test.ts still needs to be updated, in a similar\nway.",
    "sha": "7dedd622748bde8863ab10d7c171a8215bfefee9",
    "files": [
        {
            "sha": "cc630de91a326b87d748f7cf6cf29e46738524ca",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/caches/private-seconds/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fprivate-seconds%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fprivate-seconds%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fprivate-seconds%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -2,6 +2,11 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n import { cacheLife } from 'next/cache'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "dcacfa761c472b837432a48b80bc645a4b448208",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/caches/private-short-stale/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fprivate-short-stale%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fprivate-short-stale%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fprivate-short-stale%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -2,6 +2,11 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n import { cacheLife } from 'next/cache'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "71626b718963bc2a635bd422d132f6b40aef52dc",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/caches/public-seconds/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fpublic-seconds%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fpublic-seconds%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fpublic-seconds%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -2,6 +2,11 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n import { cacheLife } from 'next/cache'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "c2f80ed5f03f44ebd8ca748892964cedb63e270d",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/caches/public-short-expire-long-stale/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fpublic-short-expire-long-stale%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fpublic-short-expire-long-stale%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fpublic-short-expire-long-stale%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -2,6 +2,11 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n import { cacheLife } from 'next/cache'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "4f4a2c307601a6afe1fd539ff1eb933bdce3b1d8",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/caches/public-short-expire-short-stale/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fpublic-short-expire-short-stale%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fpublic-short-expire-short-stale%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fcaches%2Fpublic-short-expire-short-stale%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -2,6 +2,11 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n import { cacheLife } from 'next/cache'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "2ce171332a9c6b407704bd05d0a7a76e3797b60d",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/errors/error-after-cookies/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Ferror-after-cookies%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Ferror-after-cookies%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Ferror-after-cookies%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -3,6 +3,11 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../shared'\n import { ErrorBoundary } from '../../../../components/error-boundary'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "e135666b539407e9b706422f019735316bce8f30",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/errors/page.tsx",
            "status": "modified",
            "additions": 7,
            "deletions": 28,
            "changes": 35,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -8,50 +8,29 @@ export default async function Page() {\n       <h2>thrown errors</h2>\n       <ul>\n         <li>\n-          <DebugLinkAccordion\n-            href=\"/errors/error-after-cookies\"\n-            prefetch={true}\n-          />\n+          <DebugLinkAccordion href=\"/errors/error-after-cookies\" />\n         </li>\n       </ul>\n \n       <h2>sync IO</h2>\n       <ul>\n         <li>\n-          <DebugLinkAccordion\n-            href=\"/errors/sync-io-after-runtime-api/cookies\"\n-            prefetch={true}\n-          />\n+          <DebugLinkAccordion href=\"/errors/sync-io-after-runtime-api/cookies\" />\n         </li>\n         <li>\n-          <DebugLinkAccordion\n-            href=\"/errors/sync-io-after-runtime-api/headers\"\n-            prefetch={true}\n-          />\n+          <DebugLinkAccordion href=\"/errors/sync-io-after-runtime-api/headers\" />\n         </li>\n         <li>\n-          <DebugLinkAccordion\n-            href=\"/errors/sync-io-after-runtime-api/dynamic-params/123\"\n-            prefetch={true}\n-          />\n+          <DebugLinkAccordion href=\"/errors/sync-io-after-runtime-api/dynamic-params/123\" />\n         </li>\n         <li>\n-          <DebugLinkAccordion\n-            href=\"/errors/sync-io-after-runtime-api/search-params?foo=bar\"\n-            prefetch={true}\n-          />\n+          <DebugLinkAccordion href=\"/errors/sync-io-after-runtime-api/search-params?foo=bar\" />\n         </li>\n         <li>\n-          <DebugLinkAccordion\n-            href=\"/errors/sync-io-after-runtime-api/private-cache\"\n-            prefetch={true}\n-          />\n+          <DebugLinkAccordion href=\"/errors/sync-io-after-runtime-api/private-cache\" />\n         </li>\n         <li>\n-          <DebugLinkAccordion\n-            href=\"/errors/sync-io-after-runtime-api/quickly-expiring-public-cache\"\n-            prefetch={true}\n-          />\n+          <DebugLinkAccordion href=\"/errors/sync-io-after-runtime-api/quickly-expiring-public-cache\" />\n         </li>\n       </ul>\n     </main>"
        },
        {
            "sha": "c2169898ec0d52018cb7b1679f4ef477d7a961ef",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/errors/sync-io-after-runtime-api/cookies/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fcookies%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fcookies%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fcookies%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -2,6 +2,11 @@ import { cookies } from 'next/headers'\n import { Suspense } from 'react'\n import { DebugRenderKind } from '../../../../shared'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "99246d30d7624ab9df737f18a37194c0586aa56c",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/errors/sync-io-after-runtime-api/dynamic-params/[id]/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fdynamic-params%2F%5Bid%5D%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -4,6 +4,11 @@ import { workUnitAsyncStorage } from 'next/dist/server/app-render/work-unit-asyn\n \n type Params = { id: string }\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page({ params }: { params: Promise<Params> }) {\n   return (\n     <main>"
        },
        {
            "sha": "74bcc65c2480b68704ce85230b822a45d68fa60b",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/errors/sync-io-after-runtime-api/headers/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fheaders%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fheaders%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fheaders%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -2,6 +2,11 @@ import { headers } from 'next/headers'\n import { Suspense } from 'react'\n import { DebugRenderKind } from '../../../../shared'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "a0f3ab1365c5427bc1dff4bb6fd993c66a66481d",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/errors/sync-io-after-runtime-api/private-cache/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fprivate-cache%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fprivate-cache%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fprivate-cache%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -1,6 +1,11 @@\n import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../../shared'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "56229967db05d661d23238ebdc2b54a739ba972f",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/errors/sync-io-after-runtime-api/quickly-expiring-public-cache/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fquickly-expiring-public-cache%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fquickly-expiring-public-cache%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fquickly-expiring-public-cache%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -2,6 +2,11 @@ import { Suspense } from 'react'\n import { cachedDelay, DebugRenderKind } from '../../../../shared'\n import { cacheLife } from 'next/cache'\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page() {\n   return (\n     <main>"
        },
        {
            "sha": "a2a5314196b07a4c17acc416030fe2d52bf996a8",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/errors/sync-io-after-runtime-api/search-params/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fsearch-params%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fsearch-params%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Ferrors%2Fsync-io-after-runtime-api%2Fsearch-params%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -3,6 +3,11 @@ import { DebugRenderKind } from '../../../../shared'\n \n type AnySearchParams = { [key: string]: string | string[] | undefined }\n \n+export const unstable_prefetch = {\n+  mode: 'runtime',\n+  samples: [{ cookies: [] }],\n+}\n+\n export default async function Page({\n   searchParams,\n }: {"
        },
        {
            "sha": "97d760c21176d9bc54784c5d39d54e33cd5673e4",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/app/(default)/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 50,
            "changes": 55,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fapp%2F(default)%2Fpage.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -175,84 +175,39 @@ export default async function Page() {\n           private, short stale\n           <ul>\n             <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/private-short-stale\"\n-                prefetch={'auto'}\n-              />\n-            </li>\n-            <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/private-short-stale\"\n-                prefetch={true}\n-              />\n+              <DebugLinkAccordion href=\"/caches/private-short-stale\" />\n             </li>\n           </ul>\n         </li>\n         <li>\n           public, short expire, long enough stale\n           <ul>\n             <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/public-short-expire-long-stale\"\n-                prefetch={'auto'}\n-              />\n-            </li>\n-            <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/public-short-expire-long-stale\"\n-                prefetch={true}\n-              />\n+              <DebugLinkAccordion href=\"/caches/public-short-expire-long-stale\" />\n             </li>\n           </ul>\n         </li>\n         <li>\n           public, short expire, short stale\n           <ul>\n             <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/public-short-expire-short-stale\"\n-                prefetch={'auto'}\n-              />\n-            </li>\n-            <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/public-short-expire-short-stale\"\n-                prefetch={true}\n-              />\n+              <DebugLinkAccordion href=\"/caches/public-short-expire-short-stale\" />\n             </li>\n           </ul>\n         </li>\n         <li>\n           public, cacheLife(\"seconds\")\n           <ul>\n             <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/public-seconds\"\n-                prefetch={'auto'}\n-              />\n-            </li>\n-            <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/public-seconds\"\n-                prefetch={true}\n-              />\n+              <DebugLinkAccordion href=\"/caches/public-seconds\" />\n             </li>\n           </ul>\n         </li>\n         <li>\n           private, cacheLife(\"seconds\")\n           <ul>\n             <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/private-seconds\"\n-                prefetch={'auto'}\n-              />\n-            </li>\n-            <li>\n-              <DebugLinkAccordion\n-                href=\"/caches/private-seconds\"\n-                prefetch={true}\n-              />\n+              <DebugLinkAccordion href=\"/caches/private-seconds\" />\n             </li>\n           </ul>\n         </li>"
        },
        {
            "sha": "25227d4e6c75080aa308c484eb2d7bb8f8f25fa7",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/components/link-accordion.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fcomponents%2Flink-accordion.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fcomponents%2Flink-accordion.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fcomponents%2Flink-accordion.tsx?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -54,7 +54,7 @@ function getPrefetchKind(prefetch: LinkProps['prefetch']) {\n     case 'auto':\n       return 'auto'\n     case true:\n-      return 'full'\n+      return 'true'\n     default:\n       prefetch satisfies never\n   }"
        },
        {
            "sha": "5f3f709e4bf54a9803570275cfdf50691c2fa9d5",
            "filename": "test/e2e/app-dir/segment-cache/prefetch-runtime/prefetch-runtime.test.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 79,
            "changes": 93,
            "blob_url": "https://github.com/vercel/next.js/blob/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fprefetch-runtime.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dedd622748bde8863ab10d7c171a8215bfefee9/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fprefetch-runtime.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Fprefetch-runtime%2Fprefetch-runtime.test.ts?ref=7dedd622748bde8863ab10d7c171a8215bfefee9",
            "patch": "@@ -712,8 +712,7 @@ describe('runtime prefetching', () => {\n     )\n   })\n \n-  // TODO (runtime-prefetching): link-level opt-in has been removed. These tests need to be updated to use the segment configuration.\n-  describe.skip('cache stale time handling', () => {\n+  describe('cache stale time handling', () => {\n     it.each([\n       {\n         // If a cache has an expiration time under 5min (DYNAMIC_EXPIRE), we omit it from static prerenders.\n@@ -750,31 +749,16 @@ describe('runtime prefetching', () => {\n \n       const DYNAMICALLY_PREFETCHABLE_CONTENT = 'Short-lived cached content'\n \n-      // Reveal the link to trigger a static prefetch\n+      // Reveal the link to trigger a runtime prefetch\n       await act(async () => {\n         const linkToggle = await browser.elementByCss(\n-          `input[data-prefetch=\"auto\"][data-link-accordion=\"${path}\"]`\n+          `input[data-link-accordion=\"${path}\"]`\n         )\n         await linkToggle.click()\n       }, [\n-        // Should include the static shell\n         {\n           includes: staticContent,\n         },\n-        // Should not include the short-lived cache\n-        {\n-          includes: DYNAMICALLY_PREFETCHABLE_CONTENT,\n-          block: 'reject',\n-        },\n-      ])\n-\n-      // Reveal the link to trigger a runtime prefetch\n-      await act(async () => {\n-        const linkToggle = await browser.elementByCss(\n-          `input[data-prefetch=\"runtime\"][data-link-accordion=\"${path}\"]`\n-        )\n-        await linkToggle.click()\n-      }, [\n         // Should include the short-lived cache\n         {\n           includes: DYNAMICALLY_PREFETCHABLE_CONTENT,\n@@ -806,32 +790,10 @@ describe('runtime prefetching', () => {\n       const STATIC_CONTENT = 'This page uses a short-lived public cache'\n       const DYNAMIC_CONTENT = 'Short-lived cached content'\n \n-      // Reveal the link to trigger a static prefetch\n-      await act(async () => {\n-        const linkToggle = await browser.elementByCss(\n-          `input[data-prefetch=\"auto\"][data-link-accordion=\"/caches/public-short-expire-short-stale\"]`\n-        )\n-        await linkToggle.click()\n-      }, [\n-        // Should include the static shell\n-        {\n-          includes: STATIC_CONTENT,\n-        },\n-        // Should not include the short-lived cache\n-        // (We set the `expire` value to be under 5min, so it will be excluded from prerenders)\n-        {\n-          includes: DYNAMIC_CONTENT,\n-          block: 'reject',\n-        },\n-      ])\n-\n       // Reveal the link to trigger a runtime prefetch.\n-      // It'll essentially be the same as the static prefetch, because the only dynamic hole\n-      // will be omitted from both.\n-      // (NOTE: in the future, we might prevent scenarios like this via `generatePrefetch`)\n       await act(async () => {\n         const linkToggle = await browser.elementByCss(\n-          `input[data-prefetch=\"runtime\"][data-link-accordion=\"/caches/public-short-expire-short-stale\"]`\n+          `input[data-link-accordion=\"/caches/public-short-expire-short-stale\"]`\n         )\n         await linkToggle.click()\n       }, [\n@@ -888,29 +850,10 @@ describe('runtime prefetching', () => {\n       const STATIC_CONTENT = 'This page uses a short-lived private cache'\n       const DYNAMIC_CONTENT = 'Short-lived cached content'\n \n-      // Reveal the link to trigger a static prefetch\n-      await act(async () => {\n-        const linkToggle = await browser.elementByCss(\n-          `input[data-prefetch=\"auto\"][data-link-accordion=\"/caches/private-short-stale\"]`\n-        )\n-        await linkToggle.click()\n-      }, [\n-        // Should include the static shell\n-        {\n-          includes: STATIC_CONTENT,\n-        },\n-        // Should not include the short-lived cache\n-        // (We set the `expire` value to be under 5min, so it will be excluded from prerenders)\n-        {\n-          includes: DYNAMIC_CONTENT,\n-          block: 'reject',\n-        },\n-      ])\n-\n       // Reveal the link to trigger a runtime prefetch\n       await act(async () => {\n         const linkToggle = await browser.elementByCss(\n-          `input[data-prefetch=\"runtime\"][data-link-accordion=\"/caches/private-short-stale\"]`\n+          `input[data-link-accordion=\"/caches/private-short-stale\"]`\n         )\n         await linkToggle.click()\n       }, [\n@@ -956,12 +899,12 @@ describe('runtime prefetching', () => {\n       // Try navigating again. The cache is private, so we should see a different timestamp\n       await browser.back()\n \n-      // Reveal the link again. The prefetch should be cached, so we shouldn't see any requests\n+      // Hover the link again. The prefetch should be cached, so we shouldn't see any requests\n       await act(async () => {\n         const linkToggle = await browser.elementByCss(\n           `input[data-link-accordion=\"/caches/private-short-stale\"]`\n         )\n-        await linkToggle.click()\n+        await linkToggle.hover()\n       }, 'no-requests')\n \n       // Navigate to the page again\n@@ -994,8 +937,7 @@ describe('runtime prefetching', () => {\n     })\n   })\n \n-  // TODO (runtime-prefetching): link-level opt-in has been removed. These tests need to be updated to use the segment configuration.\n-  describe.skip('errors', () => {\n+  describe('errors', () => {\n     it.each([\n       {\n         description: 'when sync IO is used after awaiting cookies()',\n@@ -1005,17 +947,10 @@ describe('runtime prefetching', () => {\n         description: 'when sync IO is used after awaiting headers()',\n         path: '/errors/sync-io-after-runtime-api/headers',\n       },\n-      // TODO(dynamic-ppr):\n-      // A tree prefetch for \"/dynamic-params/123\" currently causes it to be prerendered on demand,\n-      // meaning that we end up statically prerendering it with all the params included.\n-      // Because of this, `await params` doesn't hang in the static prerender, so we hit the sync IO error behind it.\n-      // This error somehow causes an infinite redirect loop between two different `?_rsc` URLs.\n-      // Investigate this separately or wait until we start always using fallback params for route trees.\n-      //\n-      // {\n-      //   description: 'when sync IO is used after awaiting dynamic params',\n-      //   path: '/errors/sync-io-after-runtime-api/dynamic-params/123',\n-      // },\n+      {\n+        description: 'when sync IO is used after awaiting dynamic params',\n+        path: '/errors/sync-io-after-runtime-api/dynamic-params/123',\n+      },\n       {\n         description: 'when sync IO is used after awaiting searchParams',\n         path: '/errors/sync-io-after-runtime-api/search-params?foo=bar',\n@@ -1052,7 +987,7 @@ describe('runtime prefetching', () => {\n         // Reveal the link to trigger a runtime prefetch\n         await act(async () => {\n           const linkToggle = await browser.elementByCss(\n-            `input[data-prefetch=\"runtime\"][data-link-accordion=\"${path}\"]`\n+            `input[data-link-accordion=\"${path}\"]`\n           )\n           await linkToggle.click()\n         }, [\n@@ -1119,7 +1054,7 @@ describe('runtime prefetching', () => {\n       // Reveal the link to trigger a runtime prefetch\n       await act(async () => {\n         const linkToggle = await browser.elementByCss(\n-          `input[data-prefetch=\"runtime\"][data-link-accordion=\"/errors/error-after-cookies\"]`\n+          `input[data-link-accordion=\"/errors/error-after-cookies\"]`\n         )\n         await linkToggle.click()\n       }, ["
        }
    ],
    "stats": {
        "total": 245,
        "additions": 87,
        "deletions": 158
    }
}