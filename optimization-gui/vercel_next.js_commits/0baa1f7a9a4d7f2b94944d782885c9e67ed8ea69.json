{
    "author": "unstubbable",
    "message": "Remove one stack frame from `'use cache'` call stacks (#85966)",
    "sha": "0baa1f7a9a4d7f2b94944d782885c9e67ed8ea69",
    "files": [
        {
            "sha": "b6df3397774b02f9274c9c12873da35d4f405ed3",
            "filename": "packages/next/src/server/use-cache/use-cache-wrapper.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0baa1f7a9a4d7f2b94944d782885c9e67ed8ea69/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fuse-cache-wrapper.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0baa1f7a9a4d7f2b94944d782885c9e67ed8ea69/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fuse-cache-wrapper.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fuse-cache-wrapper.ts?ref=0baa1f7a9a4d7f2b94944d782885c9e67ed8ea69",
            "patch": "@@ -588,7 +588,7 @@ async function generateCacheEntryImpl(\n   // though, until React awaits the promise so that React's request store (ALS)\n   // is available when the function is invoked. This allows us, for example, to\n   // capture logs so that we can later replay them.\n-  const resultPromise = createLazyResult(() => fn.apply(null, args))\n+  const resultPromise = createLazyResult(fn.bind(null, ...args))\n \n   let errors: Array<unknown> = []\n "
        },
        {
            "sha": "e5224959a40fa04c73c94560fdc6f4262cf6101e",
            "filename": "test/e2e/app-dir/cache-components-errors/cache-components-errors.test.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/0baa1f7a9a4d7f2b94944d782885c9e67ed8ea69/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0baa1f7a9a4d7f2b94944d782885c9e67ed8ea69/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts?ref=0baa1f7a9a4d7f2b94944d782885c9e67ed8ea69",
            "patch": "@@ -2169,7 +2169,6 @@ describe('Cache Components Errors', () => {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-cookies used \\`cookies()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`cookies()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n                      at CookiesReadingComponent (webpack:///app/use-cache-cookies/page.tsx:22:18)\n-                     at <unknown> (webpack:///<next-src>)\n                    20 |   // in userland.\n                    21 |   try {\n                  > 22 |     await cookies()\n@@ -2188,7 +2187,6 @@ describe('Cache Components Errors', () => {\n                  \"Error: Route /use-cache-cookies used \\`cookies()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`cookies()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n                      at a (<next-dist-dir>)\n                      at b (<next-dist-dir>)\n-                     at c (<next-dist-dir>)\n                  To get a more detailed stack trace and pinpoint the issue, try one of the following:\n                    - Start the app in development mode by running \\`next dev\\`, then open \"/use-cache-cookies\" in your browser to investigate the error.\n                    - Rerun the production build with \\`next build --debug-prerender\\` to generate better stack traces.\n@@ -2380,7 +2378,6 @@ describe('Cache Components Errors', () => {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route /use-cache-headers used \\`headers()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`headers()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n                      at HeadersReadingComponent (webpack:///app/use-cache-headers/page.tsx:21:18)\n-                     at <unknown> (webpack:///<next-src>)\n                    19 |   // to ensure that this error is shown even when it's caught in userland.\n                    20 |   try {\n                  > 21 |     await headers()\n@@ -2399,7 +2396,6 @@ describe('Cache Components Errors', () => {\n                  \"Error: Route /use-cache-headers used \\`headers()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`headers()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache\n                      at a (<next-dist-dir>)\n                      at b (<next-dist-dir>)\n-                     at c (<next-dist-dir>)\n                  To get a more detailed stack trace and pinpoint the issue, try one of the following:\n                    - Start the app in development mode by running \\`next dev\\`, then open \"/use-cache-headers\" in your browser to investigate the error.\n                    - Rerun the production build with \\`next build --debug-prerender\\` to generate better stack traces."
        }
    ],
    "stats": {
        "total": 6,
        "additions": 1,
        "deletions": 5
    }
}