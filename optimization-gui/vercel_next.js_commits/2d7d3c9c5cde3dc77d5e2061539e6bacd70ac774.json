{
    "author": "mischnic",
    "message": "Turbopack: don't use HashMap in manifests (#76833)\n\nShould make the output more deterministic.\nWe could change these to instead use our own `SliceMap`, but these\naren't stored anywhere.",
    "sha": "2d7d3c9c5cde3dc77d5e2061539e6bacd70ac774",
    "files": [
        {
            "sha": "79899553f95feb4679921d8e148df117b62b5f09",
            "filename": "crates/next-core/src/next_manifests/mod.rs",
            "status": "modified",
            "additions": 18,
            "deletions": 19,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/2d7d3c9c5cde3dc77d5e2061539e6bacd70ac774/crates%2Fnext-core%2Fsrc%2Fnext_manifests%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2d7d3c9c5cde3dc77d5e2061539e6bacd70ac774/crates%2Fnext-core%2Fsrc%2Fnext_manifests%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_manifests%2Fmod.rs?ref=2d7d3c9c5cde3dc77d5e2061539e6bacd70ac774",
            "patch": "@@ -3,7 +3,6 @@\n pub mod client_reference_manifest;\n \n use anyhow::{Context, Result};\n-use rustc_hash::FxHashMap;\n use serde::{Deserialize, Serialize};\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n@@ -22,7 +21,7 @@ use crate::next_config::{CrossOriginConfig, Rewrites, RouteHas};\n #[derive(Serialize, Default, Debug)]\n pub struct PagesManifest {\n     #[serde(flatten)]\n-    pub pages: FxHashMap<RcStr, RcStr>,\n+    pub pages: FxIndexMap<RcStr, RcStr>,\n }\n \n #[derive(Debug, Default)]\n@@ -233,16 +232,16 @@ pub enum Regions {\n #[derive(Serialize, Default, Debug)]\n pub struct MiddlewaresManifestV2 {\n     pub sorted_middleware: Vec<RcStr>,\n-    pub middleware: FxHashMap<RcStr, EdgeFunctionDefinition>,\n+    pub middleware: FxIndexMap<RcStr, EdgeFunctionDefinition>,\n     pub instrumentation: Option<InstrumentationDefinition>,\n-    pub functions: FxHashMap<RcStr, EdgeFunctionDefinition>,\n+    pub functions: FxIndexMap<RcStr, EdgeFunctionDefinition>,\n }\n \n #[derive(Serialize, Default, Debug)]\n #[serde(rename_all = \"camelCase\")]\n pub struct ReactLoadableManifest {\n     #[serde(flatten)]\n-    pub manifest: FxHashMap<RcStr, ReactLoadableManifestEntry>,\n+    pub manifest: FxIndexMap<RcStr, ReactLoadableManifestEntry>,\n }\n \n #[derive(Serialize, Default, Debug)]\n@@ -255,8 +254,8 @@ pub struct ReactLoadableManifestEntry {\n #[derive(Serialize, Default, Debug)]\n #[serde(rename_all = \"camelCase\")]\n pub struct NextFontManifest {\n-    pub pages: FxHashMap<RcStr, Vec<RcStr>>,\n-    pub app: FxHashMap<RcStr, Vec<RcStr>>,\n+    pub pages: FxIndexMap<RcStr, Vec<RcStr>>,\n+    pub app: FxIndexMap<RcStr, Vec<RcStr>>,\n     pub app_using_size_adjust: bool,\n     pub pages_using_size_adjust: bool,\n }\n@@ -285,19 +284,19 @@ pub struct LoadableManifest {\n #[serde(rename_all = \"camelCase\")]\n pub struct ServerReferenceManifest<'a> {\n     /// A map from hashed action name to the runtime module we that exports it.\n-    pub node: FxHashMap<&'a str, ActionManifestEntry<'a>>,\n+    pub node: FxIndexMap<&'a str, ActionManifestEntry<'a>>,\n     /// A map from hashed action name to the runtime module we that exports it.\n-    pub edge: FxHashMap<&'a str, ActionManifestEntry<'a>>,\n+    pub edge: FxIndexMap<&'a str, ActionManifestEntry<'a>>,\n }\n \n #[derive(Serialize, Default, Debug)]\n #[serde(rename_all = \"camelCase\")]\n pub struct ActionManifestEntry<'a> {\n     /// A mapping from the page that uses the server action to the runtime\n     /// module that exports it.\n-    pub workers: FxHashMap<&'a str, ActionManifestWorkerEntry<'a>>,\n+    pub workers: FxIndexMap<&'a str, ActionManifestWorkerEntry<'a>>,\n \n-    pub layer: FxHashMap<&'a str, ActionLayer>,\n+    pub layer: FxIndexMap<&'a str, ActionLayer>,\n }\n \n #[derive(Serialize, Debug)]\n@@ -345,22 +344,22 @@ pub struct ClientReferenceManifest {\n     pub client_modules: ManifestNode,\n     /// Mapping of client module ID to corresponding SSR module ID and required\n     /// SSR chunks.\n-    pub ssr_module_mapping: FxHashMap<ModuleId, ManifestNode>,\n+    pub ssr_module_mapping: FxIndexMap<ModuleId, ManifestNode>,\n     /// Same as `ssr_module_mapping`, but for Edge SSR.\n     #[serde(rename = \"edgeSSRModuleMapping\")]\n-    pub edge_ssr_module_mapping: FxHashMap<ModuleId, ManifestNode>,\n+    pub edge_ssr_module_mapping: FxIndexMap<ModuleId, ManifestNode>,\n     /// Mapping of client module ID to corresponding RSC module ID and required\n     /// RSC chunks.\n-    pub rsc_module_mapping: FxHashMap<ModuleId, ManifestNode>,\n+    pub rsc_module_mapping: FxIndexMap<ModuleId, ManifestNode>,\n     /// Same as `rsc_module_mapping`, but for Edge RSC.\n     #[serde(rename = \"edgeRscModuleMapping\")]\n-    pub edge_rsc_module_mapping: FxHashMap<ModuleId, ManifestNode>,\n+    pub edge_rsc_module_mapping: FxIndexMap<ModuleId, ManifestNode>,\n     /// Mapping of server component path to required CSS client chunks.\n     #[serde(rename = \"entryCSSFiles\")]\n-    pub entry_css_files: FxHashMap<RcStr, FxIndexSet<CssResource>>,\n+    pub entry_css_files: FxIndexMap<RcStr, FxIndexSet<CssResource>>,\n     /// Mapping of server component path to required JS client chunks.\n     #[serde(rename = \"entryJSFiles\")]\n-    pub entry_js_files: FxHashMap<RcStr, FxIndexSet<RcStr>>,\n+    pub entry_js_files: FxIndexMap<RcStr, FxIndexSet<RcStr>>,\n }\n \n #[derive(Serialize, Debug, Clone, Eq, Hash, PartialEq)]\n@@ -383,7 +382,7 @@ pub struct ModuleLoading {\n pub struct ManifestNode {\n     /// Mapping of export name to manifest node entry.\n     #[serde(flatten)]\n-    pub module_exports: FxHashMap<RcStr, ManifestNodeEntry>,\n+    pub module_exports: FxIndexMap<RcStr, ManifestNodeEntry>,\n }\n \n #[derive(Serialize, Debug, Clone)]\n@@ -490,7 +489,7 @@ pub struct ClientBuildManifest<'a> {\n     pub sorted_pages: &'a [RcStr],\n \n     #[serde(flatten)]\n-    pub pages: FxHashMap<RcStr, Vec<&'a str>>,\n+    pub pages: FxIndexMap<RcStr, Vec<&'a str>>,\n }\n \n #[cfg(test)]"
        }
    ],
    "stats": {
        "total": 37,
        "additions": 18,
        "deletions": 19
    }
}