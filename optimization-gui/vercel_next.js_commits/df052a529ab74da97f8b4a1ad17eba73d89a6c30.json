{
    "author": "sokra",
    "message": "Turbopack: pass asset to chunk_path to allow to use content hash later (#77772)\n\n### What?\n\nChange the signuture of `ChunkingContext::chunk_path` to take an `Asset` argument. The `content()` of the `Asset` might be used in future generate a content hash for the chunk path",
    "sha": "df052a529ab74da97f8b4a1ad17eba73d89a6c30",
    "files": [
        {
            "sha": "6b5a7aba55e0d8e91e41d7818d2abc0d20f705e5",
            "filename": "crates/next-api/src/app.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/crates%2Fnext-api%2Fsrc%2Fapp.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/crates%2Fnext-api%2Fsrc%2Fapp.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fapp.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -1293,8 +1293,11 @@ impl AppEndpoint {\n         let next_package = get_next_package(project.project_path());\n         let polyfill_source =\n             FileSource::new(next_package.join(\"dist/build/polyfills/polyfill-nomodule.js\".into()));\n-        let polyfill_output_path =\n-            client_chunking_context.chunk_path(polyfill_source.ident(), \".js\".into());\n+        let polyfill_output_path = client_chunking_context.chunk_path(\n+            Some(Vc::upcast(polyfill_source)),\n+            polyfill_source.ident(),\n+            \".js\".into(),\n+        );\n         let polyfill_output_asset = ResolvedVc::upcast(\n             RawOutput::new(polyfill_output_path, Vc::upcast(polyfill_source))\n                 .to_resolved()"
        },
        {
            "sha": "3a6963cb5d16c6cbe817007c9bf1b98bb3495f48",
            "filename": "turbopack/crates/turbopack-browser/src/chunking_context.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fchunking_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fchunking_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fchunking_context.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -4,6 +4,7 @@ use turbo_rcstr::RcStr;\n use turbo_tasks::{ResolvedVc, TryJoinIterExt, Upcast, Value, ValueToString, Vc};\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::{\n+    asset::Asset,\n     chunk::{\n         availability_info::AvailabilityInfo,\n         chunk_group::{make_chunk_group, MakeChunkGroupResult},\n@@ -337,6 +338,7 @@ impl ChunkingContext for BrowserChunkingContext {\n     #[turbo_tasks::function]\n     async fn chunk_path(\n         &self,\n+        _asset: Option<Vc<Box<dyn Asset>>>,\n         ident: Vc<AssetIdent>,\n         extension: RcStr,\n     ) -> Result<Vc<FileSystemPath>> {"
        },
        {
            "sha": "4ab6ba4747f176f18cbbac5bafb52b4bcb3afec2",
            "filename": "turbopack/crates/turbopack-browser/src/ecmascript/chunk.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Fchunk.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Fchunk.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Fchunk.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -101,9 +101,12 @@ impl EcmascriptBrowserChunk {\n #[turbo_tasks::value_impl]\n impl OutputAsset for EcmascriptBrowserChunk {\n     #[turbo_tasks::function]\n-    fn path(&self) -> Vc<FileSystemPath> {\n-        let ident = self.ident_for_path();\n-        self.chunking_context.chunk_path(ident, \".js\".into())\n+    async fn path(self: Vc<Self>) -> Result<Vc<FileSystemPath>> {\n+        let this = self.await?;\n+        let ident = this.ident_for_path();\n+        Ok(this\n+            .chunking_context\n+            .chunk_path(Some(Vc::upcast(self)), ident, \".js\".into()))\n     }\n \n     #[turbo_tasks::function]"
        },
        {
            "sha": "0cd8b8d5cd5fa15281556efd630c3472b5d865f0",
            "filename": "turbopack/crates/turbopack-browser/src/ecmascript/evaluate/chunk.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Fevaluate%2Fchunk.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Fevaluate%2Fchunk.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Fevaluate%2Fchunk.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -244,7 +244,9 @@ impl OutputAsset for EcmascriptBrowserEvaluateChunk {\n     async fn path(self: Vc<Self>) -> Result<Vc<FileSystemPath>> {\n         let this = self.await?;\n         let ident = self.ident_for_path();\n-        Ok(this.chunking_context.chunk_path(ident, \".js\".into()))\n+        Ok(this\n+            .chunking_context\n+            .chunk_path(Some(Vc::upcast(self)), ident, \".js\".into()))\n     }\n \n     #[turbo_tasks::function]"
        },
        {
            "sha": "8c8134c76e71bb5476b2dcea30034ff713db6bb7",
            "filename": "turbopack/crates/turbopack-browser/src/ecmascript/list/asset.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Flist%2Fasset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Flist%2Fasset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-browser%2Fsrc%2Fecmascript%2Flist%2Fasset.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -91,11 +91,12 @@ fn chunk_key() -> Vc<RcStr> {\n #[turbo_tasks::value_impl]\n impl OutputAsset for EcmascriptDevChunkList {\n     #[turbo_tasks::function]\n-    async fn path(&self) -> Result<Vc<FileSystemPath>> {\n-        let mut ident = self.ident.owned().await?;\n+    async fn path(self: Vc<Self>) -> Result<Vc<FileSystemPath>> {\n+        let this = self.await?;\n+        let mut ident = this.ident.owned().await?;\n         ident.add_modifier(modifier().to_resolved().await?);\n \n-        match self.source {\n+        match this.source {\n             EcmascriptDevChunkListSource::Entry => {}\n             EcmascriptDevChunkListSource::Dynamic => {\n                 ident.add_modifier(dynamic_modifier().to_resolved().await?);\n@@ -107,7 +108,9 @@ impl OutputAsset for EcmascriptDevChunkList {\n         // removed from the list.\n \n         let ident = AssetIdent::new(Value::new(ident));\n-        Ok(self.chunking_context.chunk_path(ident, \".js\".into()))\n+        Ok(this\n+            .chunking_context\n+            .chunk_path(Some(Vc::upcast(self)), ident, \".js\".into()))\n     }\n \n     #[turbo_tasks::function]"
        },
        {
            "sha": "d184b339032376cb6658a5b139c2aa421cad6049",
            "filename": "turbopack/crates/turbopack-core/src/chunk/chunking_context.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking_context.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -8,6 +8,7 @@ use turbo_tasks_hash::DeterministicHash;\n \n use super::{availability_info::AvailabilityInfo, ChunkableModule, EvaluatableAssets};\n use crate::{\n+    asset::Asset,\n     chunk::{ChunkItem, ChunkType, ModuleId},\n     environment::Environment,\n     ident::AssetIdent,\n@@ -143,7 +144,12 @@ pub trait ChunkingContext {\n     // discretion of chunking context implementors. However, we currently use this\n     // in a couple of places in `turbopack-css`, so we need to remove that\n     // dependency first.\n-    fn chunk_path(self: Vc<Self>, ident: Vc<AssetIdent>, extension: RcStr) -> Vc<FileSystemPath>;\n+    fn chunk_path(\n+        self: Vc<Self>,\n+        asset: Option<Vc<Box<dyn Asset>>>,\n+        ident: Vc<AssetIdent>,\n+        extension: RcStr,\n+    ) -> Vc<FileSystemPath>;\n \n     /// Reference Source Map Assets for chunks\n     fn reference_chunk_source_maps(self: Vc<Self>, chunk: Vc<Box<dyn OutputAsset>>) -> Vc<bool>;"
        },
        {
            "sha": "3d7b87841d4fc2ebb050acecf59bbecb9a22ab13",
            "filename": "turbopack/crates/turbopack-core/src/source_map/source_map_asset.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fsource_map_asset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fsource_map_asset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fsource_map_asset.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -77,7 +77,7 @@ impl OutputAsset for SourceMapAsset {\n                 chunking_context,\n                 ident_for_path,\n             } => chunking_context\n-                .chunk_path(*ident_for_path, \".js\".into())\n+                .chunk_path(Some(Vc::upcast(self)), *ident_for_path, \".js\".into())\n                 .append(\".map\".into()),\n             PathType::Fixed { path } => path.append(\".map\".into()),\n         })"
        },
        {
            "sha": "a260b9f341a67a49a23e5f08ae7ebbcd73df4539",
            "filename": "turbopack/crates/turbopack-css/src/chunk/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fmod.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -323,7 +323,7 @@ impl OutputAsset for CssChunk {\n         Ok(self\n             .await?\n             .chunking_context\n-            .chunk_path(ident, \".css\".into()))\n+            .chunk_path(Some(Vc::upcast(self)), ident, \".css\".into()))\n     }\n \n     #[turbo_tasks::function]"
        },
        {
            "sha": "d0f12c3d5ffd3d4f125c8037366f62228ff35bcd",
            "filename": "turbopack/crates/turbopack-css/src/chunk/single_item_chunk/chunk.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 4,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fsingle_item_chunk%2Fchunk.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fsingle_item_chunk%2Fchunk.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fsingle_item_chunk%2Fchunk.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -98,10 +98,11 @@ fn single_item_modifier() -> Vc<RcStr> {\n impl OutputAsset for SingleItemCssChunk {\n     #[turbo_tasks::function]\n     async fn path(self: Vc<Self>) -> Result<Vc<FileSystemPath>> {\n-        Ok(self\n-            .await?\n-            .chunking_context\n-            .chunk_path(self.ident_for_path(), \".single.css\".into()))\n+        Ok(self.await?.chunking_context.chunk_path(\n+            Some(Vc::upcast(self)),\n+            self.ident_for_path(),\n+            \".single.css\".into(),\n+        ))\n     }\n \n     #[turbo_tasks::function]"
        },
        {
            "sha": "bda94f56facd1256a1d5da4054b9d0f6f8359727",
            "filename": "turbopack/crates/turbopack-css/src/chunk/single_item_chunk/source_map.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fsingle_item_chunk%2Fsource_map.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fsingle_item_chunk%2Fsource_map.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fsingle_item_chunk%2Fsource_map.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -33,7 +33,11 @@ impl OutputAsset for SingleItemCssChunkSourceMapAsset {\n             .chunk\n             .await?\n             .chunking_context\n-            .chunk_path(this.chunk.ident_for_path(), \".single.css\".into())\n+            .chunk_path(\n+                Some(Vc::upcast(self)),\n+                this.chunk.ident_for_path(),\n+                \".single.css\".into(),\n+            )\n             .append(\".map\".into()))\n     }\n }"
        },
        {
            "sha": "561b3e43117fba94910d9461ae8312f751dbe901",
            "filename": "turbopack/crates/turbopack-css/src/chunk/source_map.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fsource_map.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fsource_map.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fsource_map.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -34,7 +34,7 @@ impl OutputAsset for CssChunkSourceMapAsset {\n             .chunk\n             .await?\n             .chunking_context\n-            .chunk_path(ident, \".css\".into())\n+            .chunk_path(Some(Vc::upcast(self)), ident, \".css\".into())\n             .append(\".map\".into()))\n     }\n }"
        },
        {
            "sha": "672736fca9388d137f223f5a24a939ad1077b03b",
            "filename": "turbopack/crates/turbopack-node/src/lib.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Flib.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -256,7 +256,7 @@ pub async fn get_intermediate_asset(\n     other_entries: Vc<EvaluatableAssets>,\n ) -> Result<Vc<Box<dyn OutputAsset>>> {\n     Ok(Vc::upcast(chunking_context.root_entry_chunk_group_asset(\n-        chunking_context.chunk_path(main_entry.ident(), \".js\".into()),\n+        chunking_context.chunk_path(None, main_entry.ident(), \".js\".into()),\n         other_entries.with_entry(*main_entry),\n         ModuleGraph::from_modules(Vc::cell(vec![ChunkGroupEntry::Entry(\n                 other_entries"
        },
        {
            "sha": "eb93155d755a8cf58a50191a8ae72b03cdef910e",
            "filename": "turbopack/crates/turbopack-nodejs/src/chunking_context.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fchunking_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fchunking_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fchunking_context.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -4,6 +4,7 @@ use turbo_rcstr::RcStr;\n use turbo_tasks::{ResolvedVc, TryJoinIterExt, Upcast, Value, ValueToString, Vc};\n use turbo_tasks_fs::FileSystemPath;\n use turbopack_core::{\n+    asset::Asset,\n     chunk::{\n         availability_info::AvailabilityInfo,\n         chunk_group::{make_chunk_group, MakeChunkGroupResult},\n@@ -276,6 +277,7 @@ impl ChunkingContext for NodeJsChunkingContext {\n     #[turbo_tasks::function]\n     async fn chunk_path(\n         &self,\n+        _asset: Option<Vc<Box<dyn Asset>>>,\n         ident: Vc<AssetIdent>,\n         extension: RcStr,\n     ) -> Result<Vc<FileSystemPath>> {"
        },
        {
            "sha": "dc4dae5f5b4c0d6a6207ccbeaa7e9bfe75501240",
            "filename": "turbopack/crates/turbopack-nodejs/src/ecmascript/node/chunk.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fecmascript%2Fnode%2Fchunk.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fecmascript%2Fnode%2Fchunk.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fecmascript%2Fnode%2Fchunk.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -78,9 +78,12 @@ impl EcmascriptBuildNodeChunk {\n #[turbo_tasks::value_impl]\n impl OutputAsset for EcmascriptBuildNodeChunk {\n     #[turbo_tasks::function]\n-    fn path(&self) -> Vc<FileSystemPath> {\n-        let ident = self.chunk.ident().with_modifier(modifier());\n-        self.chunking_context.chunk_path(ident, \".js\".into())\n+    async fn path(self: Vc<Self>) -> Result<Vc<FileSystemPath>> {\n+        let this = self.await?;\n+        let ident = this.chunk.ident().with_modifier(modifier());\n+        Ok(this\n+            .chunking_context\n+            .chunk_path(Some(Vc::upcast(self)), ident, \".js\".into()))\n     }\n \n     #[turbo_tasks::function]"
        },
        {
            "sha": "ff25f5d694b554cf8ff92096f9808989742e5af1",
            "filename": "turbopack/crates/turbopack-nodejs/src/ecmascript/node/entry/runtime.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fecmascript%2Fnode%2Fentry%2Fruntime.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fecmascript%2Fnode%2Fentry%2Fruntime.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-nodejs%2Fsrc%2Fecmascript%2Fnode%2Fentry%2Fruntime.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -129,7 +129,9 @@ impl OutputAsset for EcmascriptBuildNodeRuntimeChunk {\n         let this = self.await?;\n         let ident = self.ident_for_path();\n \n-        Ok(this.chunking_context.chunk_path(ident, \".js\".into()))\n+        Ok(this\n+            .chunking_context\n+            .chunk_path(Some(Vc::upcast(self)), ident, \".js\".into()))\n     }\n \n     #[turbo_tasks::function]"
        },
        {
            "sha": "818d5a37893593b99decc8b2082ee38770aa9dd9",
            "filename": "turbopack/crates/turbopack-wasm/src/output_asset.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Foutput_asset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/df052a529ab74da97f8b4a1ad17eba73d89a6c30/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Foutput_asset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Foutput_asset.rs?ref=df052a529ab74da97f8b4a1ad17eba73d89a6c30",
            "patch": "@@ -1,3 +1,4 @@\n+use anyhow::Result;\n use turbo_rcstr::RcStr;\n use turbo_tasks::{ResolvedVc, Vc};\n use turbo_tasks_fs::FileSystemPath;\n@@ -40,9 +41,12 @@ impl WebAssemblyAsset {\n #[turbo_tasks::value_impl]\n impl OutputAsset for WebAssemblyAsset {\n     #[turbo_tasks::function]\n-    fn path(&self) -> Vc<FileSystemPath> {\n-        let ident = self.source.ident().with_modifier(modifier());\n-        self.chunking_context.chunk_path(ident, \".wasm\".into())\n+    async fn path(self: Vc<Self>) -> Result<Vc<FileSystemPath>> {\n+        let this = self.await?;\n+        let ident = this.source.ident().with_modifier(modifier());\n+        Ok(this\n+            .chunking_context\n+            .chunk_path(Some(Vc::upcast(self)), ident, \".wasm\".into()))\n     }\n }\n "
        }
    ],
    "stats": {
        "total": 89,
        "additions": 62,
        "deletions": 27
    }
}