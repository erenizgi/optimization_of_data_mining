{
    "author": "wbinnssmith",
    "message": "bundle analyzer: remove uncompressed toggle, stabilize top bar ui (#87325)\n\nThis:\n\n- Removes the uncompressed/compressed toggle in favor of just using\ncompressed sizes when sizing treemap nodes\n- Fixes the width of the client/server and file type triggers so that\nthey don't reflow horizontally when their content changes\n\nFixes PACK-6295\nFixes PACK-6298",
    "sha": "71f9a8c65c00d048f0592ae764c0fb6e1d7d8354",
    "files": [
        {
            "sha": "4811c03ba4fc3e0ec7ca6def7d376ca0b28dad86",
            "filename": "apps/bundle-analyzer/app/page.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 36,
            "changes": 41,
            "blob_url": "https://github.com/vercel/next.js/blob/71f9a8c65c00d048f0592ae764c0fb6e1d7d8354/apps%2Fbundle-analyzer%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/71f9a8c65c00d048f0592ae764c0fb6e1d7d8354/apps%2Fbundle-analyzer%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/apps%2Fbundle-analyzer%2Fapp%2Fpage.tsx?ref=71f9a8c65c00d048f0592ae764c0fb6e1d7d8354",
            "patch": "@@ -1,7 +1,6 @@\n 'use client'\n \n import type React from 'react'\n-import { SizeMode } from '@/lib/treemap-layout'\n \n import { useEffect, useMemo, useState } from 'react'\n import useSWR from 'swr'\n@@ -25,9 +24,8 @@ import { AnalyzeData, ModulesData } from '@/lib/analyze-data'\n import { computeActiveEntries, computeModuleDepthMap } from '@/lib/module-graph'\n import { fetchStrict } from '@/lib/utils'\n import { formatBytes } from '@/lib/utils'\n+import { SizeMode } from '@/lib/treemap-layout'\n import {\n-  File,\n-  FileArchive,\n   Monitor,\n   Server,\n   FileCode,\n@@ -93,7 +91,6 @@ export default function Home() {\n     client?: boolean\n   } | null>(null)\n   const [searchQuery, setSearchQuery] = useState('')\n-  const [sizeMode, setSizeMode] = useState(SizeMode.Compressed)\n \n   useEffect(() => {\n     const handleKeyDown = (e: KeyboardEvent) => {\n@@ -174,8 +171,6 @@ export default function Home() {\n         analyzeData={analyzeData}\n         selectedRoute={selectedRoute}\n         setSelectedRoute={setSelectedRoute}\n-        sizeMode={sizeMode}\n-        setSizeMode={setSizeMode}\n         environmentFilter={environmentFilter}\n         setEnvironmentFilter={setEnvironmentFilter}\n         setSelectedSourceIndex={setSelectedSourceIndex}\n@@ -227,7 +222,7 @@ export default function Home() {\n                 onHoveredNodeChange={setHoveredNodeInfo}\n                 searchQuery={searchQuery}\n                 filterSource={filterSource}\n-                sizeMode={sizeMode}\n+                sizeMode={SizeMode.Compressed}\n               />\n             </div>\n \n@@ -260,7 +255,7 @@ export default function Home() {\n                   {hoveredNodeInfo.name}\n                 </span>\n                 <span className=\"ml-2 text-muted-foreground\">\n-                  {`${formatBytes(hoveredNodeInfo.size)} ${sizeMode}`}\n+                  {`${formatBytes(hoveredNodeInfo.size)} compressed`}\n                 </span>\n                 {(hoveredNodeInfo.server || hoveredNodeInfo.client) && (\n                   <span className=\"ml-2 inline-flex gap-1\">\n@@ -306,8 +301,6 @@ function TopBar({\n   analyzeData,\n   selectedRoute,\n   setSelectedRoute,\n-  sizeMode,\n-  setSizeMode,\n   environmentFilter,\n   setEnvironmentFilter,\n   setSelectedSourceIndex,\n@@ -320,8 +313,6 @@ function TopBar({\n   analyzeData: AnalyzeData | undefined\n   selectedRoute: string | null\n   setSelectedRoute: (route: string | null) => void\n-  sizeMode: SizeMode\n-  setSizeMode: (mode: SizeMode) => void\n   environmentFilter: Environment\n   setEnvironmentFilter: (env: Environment) => void\n   setSelectedSourceIndex: (index: number | null) => void\n@@ -347,36 +338,13 @@ function TopBar({\n       <div className=\"flex items-center gap-2\">\n         {analyzeData && (\n           <>\n-            <Select\n-              value={sizeMode}\n-              onValueChange={(value: SizeMode) => setSizeMode(value)}\n-            >\n-              <SelectTrigger className=\"w-fit min-w-[120px] h-8 text-xs\">\n-                <SelectValue />\n-              </SelectTrigger>\n-              <SelectContent>\n-                <SelectItem value={SizeMode.Uncompressed} className=\"text-xs\">\n-                  <div className=\"flex items-center gap-1.5\">\n-                    <File className=\"h-3.5 w-3.5\" />\n-                    <span className=\"text-xs\">Uncompressed</span>\n-                  </div>\n-                </SelectItem>\n-                <SelectItem value={SizeMode.Compressed} className=\"text-xs\">\n-                  <div className=\"flex items-center gap-1.5\">\n-                    <FileArchive className=\"h-3.5 w-3.5\" />\n-                    <span className=\"text-xs\">Compressed</span>\n-                  </div>\n-                </SelectItem>\n-              </SelectContent>\n-            </Select>\n-\n             <Select\n               value={environmentFilter}\n               onValueChange={(value: Environment) =>\n                 setEnvironmentFilter(value)\n               }\n             >\n-              <SelectTrigger className=\"w-fit min-w-[100px]\">\n+              <SelectTrigger className=\"w-28\">\n                 <SelectValue />\n               </SelectTrigger>\n               <SelectContent>\n@@ -401,6 +369,7 @@ function TopBar({\n               onValueChange={setTypeFilter}\n               selectionName={{ singular: 'file type', plural: 'file types' }}\n               triggerIcon={<FileCode className=\"h-3.5 w-3.5\" />}\n+              triggerClassName=\"w-36\"\n               aria-label=\"Filter by file type\"\n             />\n "
        },
        {
            "sha": "52a7dc7206b885037333b9ad3ddfb489701af0d4",
            "filename": "apps/bundle-analyzer/components/sidebar.tsx",
            "status": "modified",
            "additions": 10,
            "deletions": 11,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/71f9a8c65c00d048f0592ae764c0fb6e1d7d8354/apps%2Fbundle-analyzer%2Fcomponents%2Fsidebar.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/71f9a8c65c00d048f0592ae764c0fb6e1d7d8354/apps%2Fbundle-analyzer%2Fcomponents%2Fsidebar.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/apps%2Fbundle-analyzer%2Fcomponents%2Fsidebar.tsx?ref=71f9a8c65c00d048f0592ae764c0fb6e1d7d8354",
            "patch": "@@ -139,6 +139,16 @@ function SelectionDetails({\n         {selectedSourceIndex != null &&\n         analyzeData.source(selectedSourceIndex) ? (\n           <div className=\"text-xs\">\n+            <div>\n+              <span>{formatBytes(compressedSize)}</span>\n+              <span className=\"text-muted-foreground ml-1\">\n+                compressed (estimated)\n+              </span>\n+              <InlineHelpTooltip>\n+                Estimated compressed size. Modules are compressed in isolation\n+                which may differ from their size in the final chunk.\n+              </InlineHelpTooltip>\n+            </div>\n             <div>\n               <span>{formatBytes(size)}</span>{' '}\n               <span className=\"text-muted-foreground\">uncompressed</span>\n@@ -148,17 +158,6 @@ function SelectionDetails({\n                 compression like gzip.\n               </InlineHelpTooltip>\n             </div>\n-            <>\n-              <div>\n-                <span className=\"text-muted-foreground\">About </span>\n-                <span>{formatBytes(compressedSize)}</span>\n-                <span className=\"text-muted-foreground ml-1\">compressed</span>\n-                <InlineHelpTooltip>\n-                  Estimated compressed size. Modules are compressed in isolation\n-                  which may differ from their size in the final chunk.\n-                </InlineHelpTooltip>\n-              </div>\n-            </>\n             {hasChildModules && childModuleCount != null ? (\n               <div>\n                 <span>{childModuleCount} </span>"
        }
    ],
    "stats": {
        "total": 62,
        "additions": 15,
        "deletions": 47
    }
}