{
    "author": "lukesandberg",
    "message": "[turbopack] defer a `value_to_string` operation until we need it (#84188)\n\nDon't stringify the lookup_dir unless we actually need to print it, which should be very rare.",
    "sha": "9bd5a76df7c5bcf02d1de4507353a46191424898",
    "files": [
        {
            "sha": "ee081ed535b383291a617be6aaf97f2bd5566bd3",
            "filename": "turbopack/crates/turbopack-core/src/resolve/mod.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/9bd5a76df7c5bcf02d1de4507353a46191424898/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/9bd5a76df7c5bcf02d1de4507353a46191424898/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs?ref=9bd5a76df7c5bcf02d1de4507353a46191424898",
            "patch": "@@ -1464,7 +1464,6 @@ pub async fn resolve_raw(\n \n     let mut results = Vec::new();\n \n-    let lookup_dir_str = lookup_dir.value_to_string().await?;\n     let pat = path.await?;\n     if let Some(pat) = pat\n         .filter_could_match(\"/ROOT/\")\n@@ -1483,7 +1482,7 @@ pub async fn resolve_raw(\n             println!(\n                 \"WARN: resolving abs pattern {} in {} leads to {} results\",\n                 path_str,\n-                lookup_dir_str,\n+                lookup_dir.value_to_string().await?,\n                 matches.len()\n             );\n         } else {\n@@ -1496,12 +1495,13 @@ pub async fn resolve_raw(\n     }\n \n     {\n-        let matches = read_matches(lookup_dir, rcstr!(\"\"), force_in_lookup_dir, path).await?;\n+        let matches =\n+            read_matches(lookup_dir.clone(), rcstr!(\"\"), force_in_lookup_dir, path).await?;\n         if matches.len() > 10000 {\n             println!(\n                 \"WARN: resolving pattern {} in {} leads to {} results\",\n                 pat.describe_as_string(),\n-                lookup_dir_str,\n+                lookup_dir.value_to_string().await?,\n                 matches.len()\n             );\n         }"
        },
        {
            "sha": "6b2df7b08f4c94d1ccaab931bbcf5d0e8eee2c52",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/raw.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/9bd5a76df7c5bcf02d1de4507353a46191424898/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fraw.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/9bd5a76df7c5bcf02d1de4507353a46191424898/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fraw.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fraw.rs?ref=9bd5a76df7c5bcf02d1de4507353a46191424898",
            "patch": "@@ -48,7 +48,7 @@ impl ModuleReference for FileSourceReference {\n                 context_dir,\n                 *self.path,\n                 self.collect_affecting_sources,\n-                false,\n+                /* force_in_lookup_dir */ false,\n             )\n             .as_raw_module_result()\n             .resolve()"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
    }
}