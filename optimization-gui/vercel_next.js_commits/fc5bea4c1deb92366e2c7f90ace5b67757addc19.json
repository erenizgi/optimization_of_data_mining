{
    "author": "devjiwonchoi",
    "message": "[dev-overlay] always display bundler name on version info (#77739)\n\n### Why?\n\nPreviously, we indicated the bundler name only for Turbopack. To better\nindicate the user which bundler the app is running (especially when\nsharing errors via screenshot), always display bundler name on version\ninfo.\n\n| Webpack | Rspack |\n|--------|--------|\n| ![CleanShot 2025-04-02 at 19 04\n34@2x](https://github.com/user-attachments/assets/621a1057-f05f-4dc4-98d9-beaa7dc2eba1)\n| ![CleanShot 2025-04-02 at 19 04\n04@2x](https://github.com/user-attachments/assets/1529a189-65c9-4c02-9c71-8a4f95b2ef05)\n|\n\nCloses NDX-986\n\n---------\n\nCo-authored-by: Jiachi Liu <inbox@huozhi.im>",
    "sha": "fc5bea4c1deb92366e2c7f90ace5b67757addc19",
    "files": [
        {
            "sha": "035c8a623dfe7d0a105c831372dc741bfe486b39",
            "filename": "packages/next/src/build/webpack/plugins/define-env-plugin.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/fc5bea4c1deb92366e2c7f90ace5b67757addc19/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fdefine-env-plugin.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/fc5bea4c1deb92366e2c7f90ace5b67757addc19/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fdefine-env-plugin.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fdefine-env-plugin.ts?ref=fc5bea4c1deb92366e2c7f90ace5b67757addc19",
            "patch": "@@ -133,6 +133,11 @@ export function getDefineEnv({\n         }),\n     'process.turbopack': isTurbopack,\n     'process.env.TURBOPACK': isTurbopack,\n+    'process.env.__NEXT_BUNDLER': isTurbopack\n+      ? 'Turbopack'\n+      : process.env.NEXT_RSPACK\n+        ? 'Rspack'\n+        : 'Webpack',\n     // TODO: enforce `NODE_ENV` on `process.env`, and add a test:\n     'process.env.NODE_ENV':\n       dev || config.experimental.allowDevelopmentBuild"
        },
        {
            "sha": "533c1168717b1cfbb2f14d2f9d27800ff6a65a78",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay-nav/error-overlay-nav.tsx",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/fc5bea4c1deb92366e2c7f90ace5b67757addc19/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fc5bea4c1deb92366e2c7f90ace5b67757addc19/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.tsx?ref=fc5bea4c1deb92366e2c7f90ace5b67757addc19",
            "patch": "@@ -17,8 +17,12 @@ export function ErrorOverlayNav({\n   activeIdx,\n   setActiveIndex,\n   versionInfo,\n-  isTurbopack,\n }: ErrorOverlayNavProps) {\n+  const bundlerName = (process.env.__NEXT_BUNDLER || 'Webpack') as\n+    | 'Webpack'\n+    | 'Turbopack'\n+    | 'Rspack'\n+\n   return (\n     <div data-nextjs-error-overlay-nav>\n       <Notch side=\"left\">\n@@ -33,7 +37,7 @@ export function ErrorOverlayNav({\n         <Notch side=\"right\">\n           <VersionStalenessInfo\n             versionInfo={versionInfo}\n-            isTurbopack={isTurbopack}\n+            bundlerName={bundlerName}\n           />\n         </Notch>\n       )}"
        },
        {
            "sha": "60a284bbd3796eec31161d12a226849604efa935",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/version-staleness-info/version-staleness-info.stories.tsx",
            "status": "modified",
            "additions": 10,
            "deletions": 1,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/fc5bea4c1deb92366e2c7f90ace5b67757addc19/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fversion-staleness-info%2Fversion-staleness-info.stories.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fc5bea4c1deb92366e2c7f90ace5b67757addc19/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fversion-staleness-info%2Fversion-staleness-info.stories.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fversion-staleness-info%2Fversion-staleness-info.stories.tsx?ref=fc5bea4c1deb92366e2c7f90ace5b67757addc19",
            "patch": "@@ -88,6 +88,15 @@ export const Turbopack: Story = {\n     versionInfo: {\n       ...mockVersionInfo.fresh,\n     },\n-    isTurbopack: true,\n+    bundlerName: 'Turbopack',\n+  },\n+}\n+\n+export const Rspack: Story = {\n+  args: {\n+    versionInfo: {\n+      ...mockVersionInfo.fresh,\n+    },\n+    bundlerName: 'Rspack',\n   },\n }"
        },
        {
            "sha": "0636e322a48ab6f64447aff90311c8aa1e65532c",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/version-staleness-info/version-staleness-info.tsx",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/fc5bea4c1deb92366e2c7f90ace5b67757addc19/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fversion-staleness-info%2Fversion-staleness-info.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/fc5bea4c1deb92366e2c7f90ace5b67757addc19/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fversion-staleness-info%2Fversion-staleness-info.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fversion-staleness-info%2Fversion-staleness-info.tsx?ref=fc5bea4c1deb92366e2c7f90ace5b67757addc19",
            "patch": "@@ -3,23 +3,21 @@ import { cx } from '../../utils/cx'\n \n export function VersionStalenessInfo({\n   versionInfo,\n-  isTurbopack,\n+  bundlerName,\n }: {\n   versionInfo: VersionInfo\n-  isTurbopack?: boolean\n+  // Passed from parent for easier handling in Storybook.\n+  bundlerName: 'Webpack' | 'Turbopack' | 'Rspack'\n }) {\n   const { staleness } = versionInfo\n   let { text, indicatorClass, title } = getStaleness(versionInfo)\n \n+  const isTurbopack = bundlerName === 'Turbopack'\n   const shouldBeLink = staleness.startsWith('stale')\n   if (shouldBeLink) {\n     return (\n       <a\n-        className={cx(\n-          'nextjs-container-build-error-version-status',\n-          'dialog-exclude-closing-from-outside-click',\n-          isTurbopack && 'turbopack-border'\n-        )}\n+        className=\"nextjs-container-build-error-version-status dialog-exclude-closing-from-outside-click\"\n         target=\"_blank\"\n         rel=\"noopener noreferrer\"\n         href=\"https://nextjs.org/docs/messages/version-staleness\"\n@@ -30,7 +28,9 @@ export function VersionStalenessInfo({\n         <span data-nextjs-version-checker title={title}>\n           {text}\n         </span>\n-        {isTurbopack && <span className=\"turbopack-text\">Turbopack</span>}\n+        <span className={cx(isTurbopack && 'turbopack-text')}>\n+          {bundlerName}\n+        </span>\n       </a>\n     )\n   }\n@@ -41,7 +41,7 @@ export function VersionStalenessInfo({\n       <span data-nextjs-version-checker title={title}>\n         {text}\n       </span>\n-      {isTurbopack && <span className=\"turbopack-text\">Turbopack</span>}\n+      <span className={cx(isTurbopack && 'turbopack-text')}>{bundlerName}</span>\n     </span>\n   )\n }"
        },
        {
            "sha": "e42639e46080185f484b5e2e3bbb09f093b3f956",
            "filename": "test/development/acceptance-app/version-staleness.test.ts",
            "status": "modified",
            "additions": 33,
            "deletions": 15,
            "changes": 48,
            "blob_url": "https://github.com/vercel/next.js/blob/fc5bea4c1deb92366e2c7f90ace5b67757addc19/test%2Fdevelopment%2Facceptance-app%2Fversion-staleness.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/fc5bea4c1deb92366e2c7f90ace5b67757addc19/test%2Fdevelopment%2Facceptance-app%2Fversion-staleness.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Fversion-staleness.test.ts?ref=fc5bea4c1deb92366e2c7f90ace5b67757addc19",
            "patch": "@@ -52,10 +52,16 @@ describe('Error Overlay version staleness', () => {\n          \"Next.js 1.0.0 (outdated)\n          Turbopack\"\n         `)\n+    } else if (process.env.NEXT_RSPACK) {\n+      expect(await getStaleness(browser)).toMatchInlineSnapshot(`\n+         \"Next.js 1.0.0 (outdated)\n+         Rspack\"\n+        `)\n     } else {\n-      expect(await getStaleness(browser)).toMatchInlineSnapshot(\n-        `\"Next.js 1.0.0 (outdated)\"`\n-      )\n+      expect(await getStaleness(browser)).toMatchInlineSnapshot(`\n+         \"Next.js 1.0.0 (outdated)\n+         Webpack\"\n+        `)\n     }\n   })\n \n@@ -85,13 +91,19 @@ describe('Error Overlay version staleness', () => {\n \n     if (process.env.TURBOPACK) {\n       expect(await getStaleness(browser)).toMatchInlineSnapshot(`\n-       \"Next.js 2.0.0 (outdated)\n-       Turbopack\"\n-      `)\n+         \"Next.js 2.0.0 (outdated)\n+         Turbopack\"\n+        `)\n+    } else if (process.env.NEXT_RSPACK) {\n+      expect(await getStaleness(browser)).toMatchInlineSnapshot(`\n+         \"Next.js 2.0.0 (outdated)\n+         Rspack\"\n+        `)\n     } else {\n-      expect(await getStaleness(browser)).toMatchInlineSnapshot(\n-        `\"Next.js 2.0.0 (outdated)\"`\n-      )\n+      expect(await getStaleness(browser)).toMatchInlineSnapshot(`\n+         \"Next.js 2.0.0 (outdated)\n+         Webpack\"\n+        `)\n     }\n   })\n \n@@ -118,13 +130,19 @@ describe('Error Overlay version staleness', () => {\n \n     if (process.env.TURBOPACK) {\n       expect(await getStaleness(browser)).toMatchInlineSnapshot(`\n-       \"Next.js 3.0.0 (outdated)\n-       Turbopack\"\n-      `)\n+         \"Next.js 3.0.0 (outdated)\n+         Turbopack\"\n+        `)\n+    } else if (process.env.NEXT_RSPACK) {\n+      expect(await getStaleness(browser)).toMatchInlineSnapshot(`\n+         \"Next.js 3.0.0 (outdated)\n+         Rspack\"\n+        `)\n     } else {\n-      expect(await getStaleness(browser)).toMatchInlineSnapshot(\n-        `\"Next.js 3.0.0 (outdated)\"`\n-      )\n+      expect(await getStaleness(browser)).toMatchInlineSnapshot(`\n+         \"Next.js 3.0.0 (outdated)\n+         Webpack\"\n+        `)\n     }\n   })\n })"
        }
    ],
    "stats": {
        "total": 90,
        "additions": 63,
        "deletions": 27
    }
}