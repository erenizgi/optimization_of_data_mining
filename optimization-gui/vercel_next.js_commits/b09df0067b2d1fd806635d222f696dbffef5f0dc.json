{
    "author": "sokra",
    "message": "Turbopack: add family to database read span (#88323)\n\n### What?\n\nThis makes database read spans being grouped per family",
    "sha": "b09df0067b2d1fd806635d222f696dbffef5f0dc",
    "files": [
        {
            "sha": "1b35b79aafd9826840d3f7e053691ef890678b90",
            "filename": "turbopack/crates/turbo-persistence/src/db.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/b09df0067b2d1fd806635d222f696dbffef5f0dc/turbopack%2Fcrates%2Fturbo-persistence%2Fsrc%2Fdb.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/b09df0067b2d1fd806635d222f696dbffef5f0dc/turbopack%2Fcrates%2Fturbo-persistence%2Fsrc%2Fdb.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-persistence%2Fsrc%2Fdb.rs?ref=b09df0067b2d1fd806635d222f696dbffef5f0dc",
            "patch": "@@ -1338,9 +1338,12 @@ impl<S: ParallelScheduler, const FAMILIES: usize> TurboPersistence<S, FAMILIES>\n     /// might hold onto a block of the database and it should not be hold long-term.\n     pub fn get<K: QueryKey>(&self, family: usize, key: &K) -> Result<Option<ArcSlice<u8>>> {\n         debug_assert!(family < FAMILIES, \"Family index out of bounds\");\n-        let span =\n-            tracing::trace_span!(\"database read\", family, result_size = tracing::field::Empty)\n-                .entered();\n+        let span = tracing::trace_span!(\n+            \"database read\",\n+            name = family,\n+            result_size = tracing::field::Empty\n+        )\n+        .entered();\n         let hash = hash_key(key);\n         let inner = self.inner.read();\n         for meta in inner.meta_files.iter().rev() {\n@@ -1410,7 +1413,7 @@ impl<S: ParallelScheduler, const FAMILIES: usize> TurboPersistence<S, FAMILIES>\n         debug_assert!(family < FAMILIES, \"Family index out of bounds\");\n         let span = tracing::trace_span!(\n             \"database batch read\",\n-            family,\n+            name = family,\n             keys = keys.len(),\n             not_found = tracing::field::Empty,\n             deleted = tracing::field::Empty,"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 7,
        "deletions": 4
    }
}