{
    "author": "bgub",
    "message": "feat: add a codemod to migrate from the deprecated \"next lint\" command (#82685)\n\n## Add codemod to migrate from `next lint` to ESLint CLI\n\nThis PR introduces a new codemod `next-lint-to-eslint-cli` that helps\nusers migrate away from the deprecated `next lint` command to using\nESLint directly, in preparation for Next.js 16 where `next lint` will be\nremoved.\n\n### What it does\n\nThe codemod automates the migration process by:\n\n1. **Updating package.json scripts** - Replaces all `next lint` commands\nwith `eslint` equivalents\n- Maps Next.js-specific flags (`--strict` → `--max-warnings 0`,\n`--dir`/`--file` → paths)\n   - Preserves other ESLint-compatible flags\n- Handles complex scripts with pipes, redirects, and multiple commands\n\n2. **Managing ESLint configuration**\n   - Creates a new flat config (`eslint.config.mjs`) if none exists\n   - Updates existing flat configs to include Next.js rules\n   - Provides guidance for legacy configs that need manual migration\n\n3. **Installing dependencies automatically**\n- Adds required packages: `eslint`, `eslint-config-next`,\n`@eslint/eslintrc`\n   - Detects and uses the project's package manager (npm/yarn/pnpm/bun)\n   - Falls back to manual instructions if installation fails\n\n### Usage\n\n```bash\nnpx @next/codemod@latest next-lint-to-eslint-cli .\n```\n\n### Example transformations\n\n```json\n// Before\n{\n  \"scripts\": {\n    \"lint\": \"next lint\",\n    \"lint:fix\": \"next lint --fix\",\n    \"lint:strict\": \"next lint --strict --dir src\"\n  }\n}\n\n// After\n{\n  \"scripts\": {\n    \"lint\": \"eslint .\",\n    \"lint:fix\": \"eslint --fix .\",\n    \"lint:strict\": \"eslint --max-warnings 0 src\"\n  }\n}\n```\n\n### Why this change?\n\n- `next lint` is being deprecated and will be removed in Next.js 16\n- ESLint v9+ flat config is becoming the standard\n- Direct ESLint usage provides more flexibility and better ecosystem\ncompatibility\n- Reduces Next.js maintenance burden of wrapping ESLint functionality\n\nThe codemod ensures a smooth transition path for existing Next.js\nprojects while following ESLint best practices.",
    "sha": "c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
    "files": [
        {
            "sha": "7b452bfa3744691a03c844ca389db9f7aff6a0e9",
            "filename": "docs/01-app/02-guides/upgrading/codemods.mdx",
            "status": "modified",
            "additions": 67,
            "deletions": 0,
            "changes": 67,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/docs%2F01-app%2F02-guides%2Fupgrading%2Fcodemods.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/docs%2F01-app%2F02-guides%2Fupgrading%2Fcodemods.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fupgrading%2Fcodemods.mdx?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -24,6 +24,73 @@ Replacing `<transform>` and `<path>` with appropriate values.\n \n ## Codemods\n \n+### 16.0\n+\n+#### Migrate from `next lint` to ESLint CLI\n+\n+##### `next-lint-to-eslint-cli`\n+\n+```bash filename=\"Terminal\"\n+npx @next/codemod@canary next-lint-to-eslint-cli .\n+```\n+\n+This codemod migrates projects from using `next lint` to using the ESLint CLI with your local ESLint config. It:\n+\n+- Creates an `eslint.config.mjs` file with Next.js recommended configurations\n+- Updates `package.json` scripts to use `eslint .` instead of `next lint`\n+- Adds necessary ESLint dependencies to `package.json`\n+- Preserves existing ESLint configurations when found\n+\n+For example:\n+\n+```json filename=\"package.json\"\n+{\n+  \"scripts\": {\n+    \"lint\": \"next lint\"\n+  }\n+}\n+```\n+\n+Becomes:\n+\n+```json filename=\"package.json\"\n+{\n+  \"scripts\": {\n+    \"lint\": \"eslint .\"\n+  }\n+}\n+```\n+\n+And creates:\n+\n+```js filename=\"eslint.config.mjs\"\n+import { dirname } from 'path'\n+import { fileURLToPath } from 'url'\n+import { FlatCompat } from '@eslint/eslintrc'\n+\n+const __filename = fileURLToPath(import.meta.url)\n+const __dirname = dirname(__filename)\n+\n+const compat = new FlatCompat({\n+  baseDirectory: __dirname,\n+})\n+\n+const eslintConfig = [\n+  ...compat.extends('next/core-web-vitals', 'next/typescript'),\n+  {\n+    ignores: [\n+      'node_modules/**',\n+      '.next/**',\n+      'out/**',\n+      'build/**',\n+      'next-env.d.ts',\n+    ],\n+  },\n+]\n+\n+export default eslintConfig\n+```\n+\n ### 15.0\n \n #### Transform App Router Route Segment Config `runtime` value from `experimental-edge` to `edge`"
        },
        {
            "sha": "c8efc5aa532b521945ff0617119bc6a9188eb662",
            "filename": "packages/next-codemod/bin/transform.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Fbin%2Ftransform.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Fbin%2Ftransform.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Fbin%2Ftransform.ts?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -113,6 +113,11 @@ export async function runTransform(\n     return require(transformerPath).default(filesExpanded, options)\n   }\n \n+  if (transformer === 'next-lint-to-eslint-cli') {\n+    // next-lint-to-eslint-cli transform doesn't use jscodeshift directly\n+    return require(transformerPath).default(filesExpanded, options)\n+  }\n+\n   let args = []\n \n   const { dry, print, runInBand, jscodeshift, verbose } = options"
        },
        {
            "sha": "4eb73d2d48facc89992e4b18b4ec5f04752cc5e6",
            "filename": "packages/next-codemod/lib/handle-package.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Flib%2Fhandle-package.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Flib%2Fhandle-package.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Flib%2Fhandle-package.ts?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -31,6 +31,8 @@ export function getPkgManager(baseDir: string): PackageManager {\n           return 'npm'\n       }\n     }\n+    // No lock file found, default to npm\n+    return 'npm'\n   } catch {\n     return 'npm'\n   }"
        },
        {
            "sha": "cb7587bd4d05036dd712e2dd95697d15dc7d5c16",
            "filename": "packages/next-codemod/lib/utils.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Flib%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Flib%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Flib%2Futils.ts?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -121,4 +121,9 @@ export const TRANSFORMER_INQUIRER_CHOICES = [\n     value: 'next-experimental-turbo-to-turbopack',\n     version: '10.0.0',\n   },\n+  {\n+    title: 'Migrate from `next lint` to the ESLint CLI',\n+    value: 'next-lint-to-eslint-cli',\n+    version: '16.0.0',\n+  },\n ]"
        },
        {
            "sha": "900a214d41ff2c011bf7b2d7c7e38e3ccb0f59de",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/basic.input.json",
            "status": "added",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fbasic.input.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fbasic.input.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fbasic.input.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,22 @@\n+{\n+  \"name\": \"my-app\",\n+  \"version\": \"0.1.0\",\n+  \"private\": true,\n+  \"scripts\": {\n+    \"dev\": \"next dev\",\n+    \"build\": \"next build\",\n+    \"start\": \"next start\",\n+    \"lint\": \"next lint\"\n+  },\n+  \"dependencies\": {\n+    \"react\": \"^18.3.0\",\n+    \"react-dom\": \"^18.3.0\",\n+    \"next\": \"15.0.0\"\n+  },\n+  \"devDependencies\": {\n+    \"typescript\": \"^5\",\n+    \"@types/node\": \"^20\",\n+    \"@types/react\": \"^19\",\n+    \"@types/react-dom\": \"^19\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "756e91e079a4d4a288f5cb12d53ffa36038cc0cb",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/basic.output.json",
            "status": "added",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fbasic.output.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fbasic.output.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fbasic.output.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,25 @@\n+{\n+  \"name\": \"my-app\",\n+  \"version\": \"0.1.0\",\n+  \"private\": true,\n+  \"scripts\": {\n+    \"dev\": \"next dev\",\n+    \"build\": \"next build\",\n+    \"start\": \"next start\",\n+    \"lint\": \"eslint .\"\n+  },\n+  \"dependencies\": {\n+    \"react\": \"^18.3.0\",\n+    \"react-dom\": \"^18.3.0\",\n+    \"next\": \"15.0.0\"\n+  },\n+  \"devDependencies\": {\n+    \"typescript\": \"^5\",\n+    \"@types/node\": \"^20\",\n+    \"@types/react\": \"^19\",\n+    \"@types/react-dom\": \"^19\",\n+    \"eslint\": \"^9\",\n+    \"eslint-config-next\": \"15.0.0\",\n+    \"@eslint/eslintrc\": \"^3\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "876834061d5fb3a4ad4f1d1942c8383ecea0b25a",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/cjs-flat-config.eslint.cjs",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fcjs-flat-config.eslint.cjs",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fcjs-flat-config.eslint.cjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fcjs-flat-config.eslint.cjs?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,8 @@\n+module.exports = [\n+  {\n+    rules: {\n+      \"quotes\": [\"error\", \"double\"],\n+      \"indent\": [\"error\", 2]\n+    }\n+  }\n+]\n\\ No newline at end of file"
        },
        {
            "sha": "fa134a8e4f89c310fc28906132ea337db5d5aeb0",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/complex-scripts.input.json",
            "status": "added",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fcomplex-scripts.input.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fcomplex-scripts.input.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fcomplex-scripts.input.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,18 @@\n+{\n+  \"name\": \"complex-scripts-app\",\n+  \"version\": \"1.0.0\",\n+  \"scripts\": {\n+    \"lint\": \"next lint --fix --dir src --dir pages\",\n+    \"lint:strict\": \"next lint --strict\",\n+    \"lint:ci\": \"next lint --quiet --output-file lint-results.json\",\n+    \"precommit\": \"next lint --fix && npm test\",\n+    \"test\": \"jest && next lint\",\n+    \"complex\": \"npm run build && next lint --dir . --ext .js,.jsx,.ts,.tsx 2>/dev/null\",\n+    \"pipe\": \"next lint | tee lint.log\",\n+    \"redirect\": \"next lint > output.txt 2>&1\",\n+    \"multi\": \"next lint; next build; next lint --fix\"\n+  },\n+  \"dependencies\": {\n+    \"next\": \"15.0.0\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "b9d89b51290241b6d7f0072dcf226010504f2a50",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/complex-scripts.output.json",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fcomplex-scripts.output.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fcomplex-scripts.output.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fcomplex-scripts.output.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,23 @@\n+{\n+  \"name\": \"complex-scripts-app\",\n+  \"version\": \"1.0.0\",\n+  \"scripts\": {\n+    \"lint\": \"eslint --fix src pages\",\n+    \"lint:strict\": \"eslint --max-warnings 0 .\",\n+    \"lint:ci\": \"eslint --quiet --output-file lint-results.json .\",\n+    \"precommit\": \"eslint --fix . && npm test\",\n+    \"test\": \"jest && eslint .\",\n+    \"complex\": \"npm run build && eslint . 2>/dev/null\",\n+    \"pipe\": \"eslint . | tee lint.log\",\n+    \"redirect\": \"eslint . > output.txt 2>&1\",\n+    \"multi\": \"eslint .; next build; eslint --fix .\"\n+  },\n+  \"dependencies\": {\n+    \"next\": \"15.0.0\"\n+  },\n+  \"devDependencies\": {\n+    \"eslint\": \"^9\",\n+    \"eslint-config-next\": \"15.0.0\",\n+    \"@eslint/eslintrc\": \"^3\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "6ded3a87ff84a2c1ef9399742da9ef4878f7397a",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/existing-eslint.input.json",
            "status": "added",
            "additions": 20,
            "deletions": 0,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-eslint.input.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-eslint.input.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-eslint.input.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,20 @@\n+{\n+  \"name\": \"my-app\",\n+  \"version\": \"0.1.0\",\n+  \"private\": true,\n+  \"scripts\": {\n+    \"dev\": \"next dev\",\n+    \"build\": \"next build\",\n+    \"start\": \"next start\",\n+    \"lint\": \"next lint\"\n+  },\n+  \"dependencies\": {\n+    \"react\": \"^18.3.0\",\n+    \"react-dom\": \"^18.3.0\",\n+    \"next\": \"15.0.0\"\n+  },\n+  \"devDependencies\": {\n+    \"eslint\": \"^8.0.0\",\n+    \"eslint-config-next\": \"15.0.0\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "a5b1d67f613c9d43748d43b4c6f339dcb3650e81",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/existing-eslint.output.json",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-eslint.output.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-eslint.output.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-eslint.output.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,21 @@\n+{\n+  \"name\": \"my-app\",\n+  \"version\": \"0.1.0\",\n+  \"private\": true,\n+  \"scripts\": {\n+    \"dev\": \"next dev\",\n+    \"build\": \"next build\",\n+    \"start\": \"next start\",\n+    \"lint\": \"eslint .\"\n+  },\n+  \"dependencies\": {\n+    \"react\": \"^18.3.0\",\n+    \"react-dom\": \"^18.3.0\",\n+    \"next\": \"15.0.0\"\n+  },\n+  \"devDependencies\": {\n+    \"eslint\": \"^8.0.0\",\n+    \"eslint-config-next\": \"15.0.0\",\n+    \"@eslint/eslintrc\": \"^3\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "61b68fdabe9ce136ff0277802525742f0444840b",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/existing-flat-config.eslint.js",
            "status": "added",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-flat-config.eslint.js",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-flat-config.eslint.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-flat-config.eslint.js?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,14 @@\n+export default [\n+  {\n+    rules: {\n+      \"no-console\": \"warn\",\n+      \"semi\": [\"error\", \"always\"]\n+    }\n+  },\n+  {\n+    files: [\"**/*.test.js\"],\n+    rules: {\n+      \"no-console\": \"off\"\n+    }\n+  }\n+]\n\\ No newline at end of file"
        },
        {
            "sha": "4e6cb6a0b2bd104429d2766a35e6287b42f130e0",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/existing-flat-config.input.json",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-flat-config.input.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-flat-config.input.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-flat-config.input.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,11 @@\n+{\n+  \"name\": \"app-with-flat-config\",\n+  \"version\": \"1.0.0\",\n+  \"scripts\": {\n+    \"lint\": \"next lint\",\n+    \"lint:fix\": \"next lint --fix\"\n+  },\n+  \"dependencies\": {\n+    \"next\": \"15.0.0\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "f0ec2aaf2708726155029db51ab508d51a9e2a41",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/existing-flat-config.output.json",
            "status": "added",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-flat-config.output.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-flat-config.output.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-flat-config.output.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,16 @@\n+{\n+  \"name\": \"app-with-flat-config\",\n+  \"version\": \"1.0.0\",\n+  \"scripts\": {\n+    \"lint\": \"eslint .\",\n+    \"lint:fix\": \"eslint --fix .\"\n+  },\n+  \"dependencies\": {\n+    \"next\": \"15.0.0\"\n+  },\n+  \"devDependencies\": {\n+    \"eslint\": \"^9\",\n+    \"eslint-config-next\": \"15.0.0\",\n+    \"@eslint/eslintrc\": \"^3\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "21c14eabaf6c89865455db0cafb261b6022b36be",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/existing-ignores.eslint.js",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-ignores.eslint.js",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-ignores.eslint.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fexisting-ignores.eslint.js?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,10 @@\n+export default [\n+  {\n+    ignores: [\"dist/**\", \"coverage/**\"]\n+  },\n+  {\n+    rules: {\n+      \"no-unused-vars\": \"warn\"\n+    }\n+  }\n+]\n\\ No newline at end of file"
        },
        {
            "sha": "b321d83ddd60e11266a13cdfbbc37284cf39fc3e",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/no-scripts.input.json",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fno-scripts.input.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fno-scripts.input.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fno-scripts.input.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,7 @@\n+{\n+  \"name\": \"app-without-scripts\",\n+  \"version\": \"1.0.0\",\n+  \"dependencies\": {\n+    \"next\": \"15.0.0\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "5debaf9f0228ef4d3ffe82829c5f2731114704d8",
            "filename": "packages/next-codemod/transforms/__testfixtures__/next-lint-to-eslint-cli/no-scripts.output.json",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fno-scripts.output.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fno-scripts.output.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fnext-lint-to-eslint-cli%2Fno-scripts.output.json?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,13 @@\n+{\n+  \"name\": \"app-without-scripts\",\n+  \"version\": \"1.0.0\",\n+  \"scripts\": {},\n+  \"dependencies\": {\n+    \"next\": \"15.0.0\"\n+  },\n+  \"devDependencies\": {\n+    \"eslint\": \"^9\",\n+    \"eslint-config-next\": \"15.0.0\",\n+    \"@eslint/eslintrc\": \"^3\"\n+  }\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "053d14b99e3f67300db7e9bfa52f51c05f633053",
            "filename": "packages/next-codemod/transforms/__tests__/next-lint-to-eslint-cli.test.js",
            "status": "added",
            "additions": 491,
            "deletions": 0,
            "changes": 491,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__tests__%2Fnext-lint-to-eslint-cli.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2F__tests__%2Fnext-lint-to-eslint-cli.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__tests__%2Fnext-lint-to-eslint-cli.test.js?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,491 @@\n+/* global jest */\n+jest.autoMockOff()\n+const fs = require('fs')\n+const path = require('path')\n+const { tmpdir } = require('os')\n+const transformer = require('../next-lint-to-eslint-cli').default\n+\n+describe('next-lint-to-eslint-cli', () => {\n+  let tempDir\n+\n+  beforeEach(() => {\n+    // Create a unique temp directory for each test\n+    tempDir = fs.mkdtempSync(path.join(tmpdir(), 'codemod-test-'))\n+  })\n+\n+  afterEach(() => {\n+    // Clean up temp directory\n+    if (tempDir && fs.existsSync(tempDir)) {\n+      fs.rmSync(tempDir, { recursive: true, force: true })\n+    }\n+  })\n+\n+  test('transforms correctly using basic data', () => {\n+    // Read input fixture\n+    const inputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/basic.input.json')\n+    const expectedOutputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/basic.output.json')\n+    \n+    const inputContent = fs.readFileSync(inputPath, 'utf8')\n+    const expectedOutput = fs.readFileSync(expectedOutputPath, 'utf8')\n+\n+    // Set up test project\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    const tsConfigPath = path.join(tempDir, 'tsconfig.json')\n+    \n+    fs.writeFileSync(packageJsonPath, inputContent)\n+    fs.writeFileSync(tsConfigPath, '{}') // Create tsconfig.json to indicate TypeScript project\n+\n+    // Run transformer\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    // Check package.json was updated correctly\n+    const actualPackageJson = fs.readFileSync(packageJsonPath, 'utf8')\n+    expect(JSON.parse(actualPackageJson)).toEqual(JSON.parse(expectedOutput))\n+\n+    // Check eslint.config.mjs was created\n+    const eslintConfigPath = path.join(tempDir, 'eslint.config.mjs')\n+    expect(fs.existsSync(eslintConfigPath)).toBe(true)\n+    \n+    const eslintConfig = fs.readFileSync(eslintConfigPath, 'utf8')\n+    expect(eslintConfig).toContain('next/core-web-vitals')\n+    expect(eslintConfig).toContain('next/typescript')\n+    expect(eslintConfig).toContain('ignores:')\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('transforms correctly using existing-eslint data', () => {\n+    // Read input fixture\n+    const inputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/existing-eslint.input.json')\n+    const expectedOutputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/existing-eslint.output.json')\n+    \n+    const inputContent = fs.readFileSync(inputPath, 'utf8')\n+    const expectedOutput = fs.readFileSync(expectedOutputPath, 'utf8')\n+\n+    // Set up test project\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    const existingEslintPath = path.join(tempDir, '.eslintrc.json')\n+    \n+    fs.writeFileSync(packageJsonPath, inputContent)\n+    fs.writeFileSync(existingEslintPath, '{\"extends\": [\"next\"]}') // Create existing ESLint config\n+\n+    // Run transformer\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    // Check package.json was updated correctly\n+    const actualPackageJson = fs.readFileSync(packageJsonPath, 'utf8')\n+    expect(JSON.parse(actualPackageJson)).toEqual(JSON.parse(expectedOutput))\n+\n+    // Check that no new eslint.config.mjs was created (existing config should be preserved)\n+    const eslintConfigPath = path.join(tempDir, 'eslint.config.mjs')\n+    expect(fs.existsSync(eslintConfigPath)).toBe(false)\n+\n+    // Check that existing config still exists\n+    expect(fs.existsSync(existingEslintPath)).toBe(true)\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('handles complex script patterns correctly', () => {\n+    const inputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/complex-scripts.input.json')\n+    const expectedOutputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/complex-scripts.output.json')\n+    \n+    const inputContent = fs.readFileSync(inputPath, 'utf8')\n+    const expectedOutput = fs.readFileSync(expectedOutputPath, 'utf8')\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    fs.writeFileSync(packageJsonPath, inputContent)\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    const actualPackageJson = fs.readFileSync(packageJsonPath, 'utf8')\n+    expect(JSON.parse(actualPackageJson)).toEqual(JSON.parse(expectedOutput))\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('updates existing ES module flat config with AST manipulation', () => {\n+    const inputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/existing-flat-config.input.json')\n+    const expectedOutputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/existing-flat-config.output.json')\n+    const eslintConfigFixture = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/existing-flat-config.eslint.js')\n+    \n+    const inputContent = fs.readFileSync(inputPath, 'utf8')\n+    const expectedOutput = fs.readFileSync(expectedOutputPath, 'utf8')\n+    const eslintConfigContent = fs.readFileSync(eslintConfigFixture, 'utf8')\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    const eslintConfigPath = path.join(tempDir, 'eslint.config.js')\n+    \n+    fs.writeFileSync(packageJsonPath, inputContent)\n+    fs.writeFileSync(eslintConfigPath, eslintConfigContent)\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    // Check package.json was updated\n+    const actualPackageJson = fs.readFileSync(packageJsonPath, 'utf8')\n+    expect(JSON.parse(actualPackageJson)).toEqual(JSON.parse(expectedOutput))\n+\n+    // Check that existing config was updated with Next.js configs\n+    const updatedConfig = fs.readFileSync(eslintConfigPath, 'utf8')\n+    expect(updatedConfig).toContain('FlatCompat')\n+    expect(updatedConfig).toContain('next/core-web-vitals')\n+    expect(updatedConfig).toContain('no-console') // Original rule should be preserved\n+    expect(updatedConfig).toContain('semi') // Original rule should be preserved\n+    expect(updatedConfig).toContain('ignores') // Should add ignores section\n+    expect(updatedConfig).toContain('.next/**') // Should include Next.js build directory\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('updates existing CommonJS flat config with AST manipulation', () => {\n+    const inputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/existing-flat-config.input.json')\n+    const expectedOutputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/existing-flat-config.output.json')\n+    const eslintConfigFixture = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/cjs-flat-config.eslint.cjs')\n+    \n+    const inputContent = fs.readFileSync(inputPath, 'utf8')\n+    const expectedOutput = fs.readFileSync(expectedOutputPath, 'utf8')\n+    const eslintConfigContent = fs.readFileSync(eslintConfigFixture, 'utf8')\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    const eslintConfigPath = path.join(tempDir, 'eslint.config.cjs')\n+    \n+    fs.writeFileSync(packageJsonPath, inputContent)\n+    fs.writeFileSync(eslintConfigPath, eslintConfigContent)\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    // Check package.json was updated\n+    const actualPackageJson = fs.readFileSync(packageJsonPath, 'utf8')\n+    expect(JSON.parse(actualPackageJson)).toEqual(JSON.parse(expectedOutput))\n+\n+    // Check that existing config was updated with Next.js configs\n+    const updatedConfig = fs.readFileSync(eslintConfigPath, 'utf8')\n+    expect(updatedConfig).toContain('FlatCompat')\n+    expect(updatedConfig).toContain('require')\n+    expect(updatedConfig).toContain('next/core-web-vitals')\n+    expect(updatedConfig).toContain('quotes') // Original rule should be preserved\n+    expect(updatedConfig).toContain('indent') // Original rule should be preserved\n+    expect(updatedConfig).toContain('ignores') // Should add ignores section\n+    expect(updatedConfig).toContain('node_modules/**') // Should include common ignores\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('handles package.json without scripts section', () => {\n+    const inputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/no-scripts.input.json')\n+    const expectedOutputPath = path.join(__dirname, '../__testfixtures__/next-lint-to-eslint-cli/no-scripts.output.json')\n+    \n+    const inputContent = fs.readFileSync(inputPath, 'utf8')\n+    const expectedOutput = fs.readFileSync(expectedOutputPath, 'utf8')\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    fs.writeFileSync(packageJsonPath, inputContent)\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    // Check package.json was updated with dependencies only\n+    const actualPackageJson = fs.readFileSync(packageJsonPath, 'utf8')\n+    expect(JSON.parse(actualPackageJson)).toEqual(JSON.parse(expectedOutput))\n+\n+    // Check that eslint.config.mjs was created\n+    const eslintConfigPath = path.join(tempDir, 'eslint.config.mjs')\n+    expect(fs.existsSync(eslintConfigPath)).toBe(true)\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('preserves existing eslint dependencies', () => {\n+    const packageJson = {\n+      name: 'app-with-eslint',\n+      scripts: {\n+        lint: 'next lint'\n+      },\n+      dependencies: {\n+        next: '15.0.0'\n+      },\n+      devDependencies: {\n+        eslint: '^8.57.0',\n+        'eslint-config-next': '14.2.0'\n+      }\n+    }\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    fs.writeFileSync(packageJsonPath, JSON.stringify(packageJson, null, 2))\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    const actualPackageJson = JSON.parse(fs.readFileSync(packageJsonPath, 'utf8'))\n+    \n+    // Should preserve existing eslint versions\n+    expect(actualPackageJson.devDependencies.eslint).toBe('^8.57.0')\n+    expect(actualPackageJson.devDependencies['eslint-config-next']).toBe('14.2.0')\n+    // Should add missing @eslint/eslintrc\n+    expect(actualPackageJson.devDependencies['@eslint/eslintrc']).toBe('^3')\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('handles TypeScript config files', () => {\n+    const packageJson = {\n+      name: 'app-with-ts-config',\n+      scripts: {\n+        lint: 'next lint'\n+      },\n+      dependencies: {\n+        next: '15.0.0'\n+      }\n+    }\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    const eslintConfigPath = path.join(tempDir, 'eslint.config.ts')\n+    \n+    fs.writeFileSync(packageJsonPath, JSON.stringify(packageJson, null, 2))\n+    fs.writeFileSync(eslintConfigPath, 'export default []')\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    const consoleWarnSpy = jest.spyOn(console, 'warn').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    // Should log that TypeScript configs require manual migration\n+    expect(consoleWarnSpy).toHaveBeenCalledWith(\n+      expect.anything(),\n+      expect.stringContaining('TypeScript config files require manual migration')\n+    )\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+    consoleWarnSpy.mockRestore()\n+  })\n+\n+  test('handles missing package.json gracefully', () => {\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    expect(consoleErrorSpy).toHaveBeenCalledWith('Error: package.json not found in the specified directory')\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('handles missing directory argument', () => {\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([], { skipInstall: true })\n+\n+    expect(consoleErrorSpy).toHaveBeenCalledWith('Error: Please specify a directory path')\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('creates JavaScript config for non-TypeScript projects', () => {\n+    const packageJson = {\n+      name: 'js-app',\n+      scripts: {\n+        lint: 'next lint'\n+      },\n+      dependencies: {\n+        next: '15.0.0',\n+        react: '^18.0.0'\n+      }\n+    }\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    fs.writeFileSync(packageJsonPath, JSON.stringify(packageJson, null, 2))\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    // Check that eslint.config.mjs was created without TypeScript config\n+    const eslintConfigPath = path.join(tempDir, 'eslint.config.mjs')\n+    const eslintConfig = fs.readFileSync(eslintConfigPath, 'utf8')\n+    \n+    expect(eslintConfig).toContain('next/core-web-vitals')\n+    expect(eslintConfig).not.toContain('next/typescript')\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('adds ignores even when Next.js configs are already present', () => {\n+    const existingConfig = `\n+import { FlatCompat } from \"@eslint/eslintrc\"\n+const compat = new FlatCompat({ baseDirectory: __dirname })\n+export default [\n+  ...compat.extends(\"next/core-web-vitals\"),\n+  { rules: { \"no-console\": \"warn\" } }\n+]`\n+\n+    const packageJson = {\n+      name: 'app-with-next-config',\n+      scripts: {\n+        lint: 'next lint'\n+      },\n+      dependencies: {\n+        next: '15.0.0'\n+      }\n+    }\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    const eslintConfigPath = path.join(tempDir, 'eslint.config.js')\n+    \n+    fs.writeFileSync(packageJsonPath, JSON.stringify(packageJson, null, 2))\n+    fs.writeFileSync(eslintConfigPath, existingConfig)\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    // Should still add ignores even though Next.js configs are present\n+    const updatedConfig = fs.readFileSync(eslintConfigPath, 'utf8')\n+    expect(updatedConfig).toContain('ignores')\n+    expect(updatedConfig).toContain('.next/**')\n+    expect(updatedConfig).toContain('node_modules/**')\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('handles scripts with paths containing spaces', () => {\n+    const packageJson = {\n+      name: 'app-with-spaces',\n+      scripts: {\n+        lint: 'next lint --dir \"src/my components\" --file \"test file.js\"'\n+      },\n+      dependencies: {\n+        next: '15.0.0'\n+      }\n+    }\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    fs.writeFileSync(packageJsonPath, JSON.stringify(packageJson, null, 2))\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    const actualPackageJson = JSON.parse(fs.readFileSync(packageJsonPath, 'utf8'))\n+    expect(actualPackageJson.scripts.lint).toBe('eslint \"src/my components\" \"test file.js\"')\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('does not duplicate ignores if already present', () => {\n+    const packageJson = {\n+      name: 'app-with-existing-ignores',\n+      scripts: {\n+        lint: 'next lint'\n+      },\n+      dependencies: {\n+        next: '15.0.0'\n+      }\n+    }\n+\n+    const existingConfig = `export default [\n+  {\n+    ignores: [\"dist/**\", \"coverage/**\"]\n+  },\n+  {\n+    rules: {\n+      \"no-unused-vars\": \"warn\"\n+    }\n+  }\n+]`\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    const eslintConfigPath = path.join(tempDir, 'eslint.config.js')\n+    \n+    fs.writeFileSync(packageJsonPath, JSON.stringify(packageJson, null, 2))\n+    fs.writeFileSync(eslintConfigPath, existingConfig)\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    const updatedConfig = fs.readFileSync(eslintConfigPath, 'utf8')\n+    \n+    // Should add Next.js extends\n+    expect(updatedConfig).toContain('next/core-web-vitals')\n+    \n+    // Should preserve existing ignores\n+    expect(updatedConfig).toContain('dist/**')\n+    expect(updatedConfig).toContain('coverage/**')\n+    \n+    // Check that Next.js ignores are added to existing ignores\n+    expect(updatedConfig).toContain('.next/**') // Next.js build dir added\n+    expect(updatedConfig).toContain('node_modules/**') // Common ignore added\n+    \n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+\n+  test('handles unsupported flags with warnings', () => {\n+    const packageJson = {\n+      name: 'app-with-unsupported-flags',\n+      scripts: {\n+        lint: 'next lint --rulesdir ./custom-rules --ext .js,.jsx'\n+      },\n+      dependencies: {\n+        next: '15.0.0'\n+      }\n+    }\n+\n+    const packageJsonPath = path.join(tempDir, 'package.json')\n+    fs.writeFileSync(packageJsonPath, JSON.stringify(packageJson, null, 2))\n+\n+    const consoleSpy = jest.spyOn(console, 'log').mockImplementation(() => {})\n+    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {})\n+    \n+    transformer([tempDir], { skipInstall: true })\n+\n+    // Should show warnings about unsupported flags\n+    expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('--rulesdir is not supported in ESLint v9'))\n+    expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('--ext is not needed in ESLint v9'))\n+\n+    // Script should be updated without the unsupported flags\n+    const actualPackageJson = JSON.parse(fs.readFileSync(packageJsonPath, 'utf8'))\n+    expect(actualPackageJson.scripts.lint).toBe('eslint .')\n+\n+    consoleSpy.mockRestore()\n+    consoleErrorSpy.mockRestore()\n+  })\n+})\n\\ No newline at end of file"
        },
        {
            "sha": "b1c09fcbe32219724e879d56fdc8f8d39c4dea7e",
            "filename": "packages/next-codemod/transforms/next-lint-to-eslint-cli.ts",
            "status": "added",
            "additions": 900,
            "deletions": 0,
            "changes": 900,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2Fnext-lint-to-eslint-cli.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext-codemod%2Ftransforms%2Fnext-lint-to-eslint-cli.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2Fnext-lint-to-eslint-cli.ts?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -0,0 +1,900 @@\n+import { existsSync, readFileSync, writeFileSync } from 'node:fs'\n+import path from 'node:path'\n+import { getPkgManager, installPackages } from '../lib/handle-package'\n+import { createParserFromPath } from '../lib/parser'\n+import { white, bold, red, yellow, green, magenta } from 'picocolors'\n+\n+export const prefixes = {\n+  wait: white(bold('○')),\n+  error: red(bold('⨯')),\n+  warn: yellow(bold('⚠')),\n+  ready: '▲', // no color\n+  info: white(bold(' ')),\n+  event: green(bold('✓')),\n+  trace: magenta(bold('»')),\n+} as const\n+\n+interface TransformerOptions {\n+  skipInstall?: boolean\n+  [key: string]: unknown\n+}\n+\n+const ESLINT_CONFIG_TEMPLATE_TYPESCRIPT = `\\\n+import { dirname } from \"path\";\n+import { fileURLToPath } from \"url\";\n+import { FlatCompat } from \"@eslint/eslintrc\";\n+\n+const __filename = fileURLToPath(import.meta.url);\n+const __dirname = dirname(__filename);\n+\n+const compat = new FlatCompat({\n+  baseDirectory: __dirname,\n+});\n+\n+const eslintConfig = [\n+  ...compat.extends(\"next/core-web-vitals\", \"next/typescript\"),\n+  {\n+    ignores: [\n+      \"node_modules/**\",\n+      \".next/**\",\n+      \"out/**\",\n+      \"build/**\",\n+      \"next-env.d.ts\",\n+    ],\n+  },\n+];\n+\n+export default eslintConfig;\n+`\n+\n+const ESLINT_CONFIG_TEMPLATE_JAVASCRIPT = `import { dirname } from \"path\";\n+import { fileURLToPath } from \"url\";\n+import { FlatCompat } from \"@eslint/eslintrc\";\n+\n+const __filename = fileURLToPath(import.meta.url);\n+const __dirname = dirname(__filename);\n+\n+const compat = new FlatCompat({\n+  baseDirectory: __dirname,\n+});\n+\n+const eslintConfig = [\n+  ...compat.extends(\"next/core-web-vitals\"),\n+  {\n+    ignores: [\n+      \"node_modules/**\",\n+      \".next/**\",\n+      \"out/**\",\n+      \"build/**\",\n+      \"next-env.d.ts\",\n+    ],\n+  },\n+];\n+\n+export default eslintConfig;\n+`\n+\n+function detectTypeScript(projectRoot: string): boolean {\n+  return existsSync(path.join(projectRoot, 'tsconfig.json'))\n+}\n+\n+function findExistingEslintConfig(projectRoot: string): {\n+  exists: boolean\n+  path?: string\n+  isFlat?: boolean\n+} {\n+  const flatConfigs = [\n+    'eslint.config.js',\n+    'eslint.config.mjs',\n+    'eslint.config.cjs',\n+    'eslint.config.ts',\n+    'eslint.config.mts',\n+    'eslint.config.cts',\n+  ]\n+\n+  const legacyConfigs = [\n+    '.eslintrc.js',\n+    '.eslintrc.cjs',\n+    '.eslintrc.yaml',\n+    '.eslintrc.yml',\n+    '.eslintrc.json',\n+    '.eslintrc',\n+  ]\n+\n+  // Check for flat configs first (preferred for v9+)\n+  for (const config of flatConfigs) {\n+    const configPath = path.join(projectRoot, config)\n+    if (existsSync(configPath)) {\n+      return { exists: true, path: configPath, isFlat: true }\n+    }\n+  }\n+\n+  // Check for legacy configs\n+  for (const config of legacyConfigs) {\n+    const configPath = path.join(projectRoot, config)\n+    if (existsSync(configPath)) {\n+      return { exists: true, path: configPath, isFlat: false }\n+    }\n+  }\n+\n+  return { exists: false }\n+}\n+\n+function updateExistingFlatConfig(\n+  configPath: string,\n+  isTypeScript: boolean\n+): boolean {\n+  let configContent: string\n+  try {\n+    configContent = readFileSync(configPath, 'utf8')\n+  } catch (error) {\n+    console.error(`   Error reading config file: ${error}`)\n+    return false\n+  }\n+\n+  // Check if Next.js configs are already imported\n+  const hasNextConfigs =\n+    configContent.includes('next/core-web-vitals') ||\n+    configContent.includes('next/typescript')\n+\n+  // TypeScript config files need special handling\n+  if (\n+    configPath.endsWith('.ts') ||\n+    configPath.endsWith('.mts') ||\n+    configPath.endsWith('.cts')\n+  ) {\n+    console.warn(\n+      prefixes.warn,\n+      '   TypeScript config files require manual migration'\n+    )\n+    console.log('   Please add the following to your config:')\n+    console.log('   - Import: import { FlatCompat } from \"@eslint/eslintrc\"')\n+    console.log(\n+      '   - Extend: ...compat.extends(\"next/core-web-vitals\"' +\n+        (isTypeScript ? ', \"next/typescript\"' : '') +\n+        ')'\n+    )\n+    return false\n+  }\n+\n+  // Parse the file using jscodeshift\n+  const j = createParserFromPath(configPath)\n+  const root = j(configContent)\n+\n+  // Determine if it's CommonJS or ES modules\n+  let isCommonJS = false\n+\n+  if (configPath.endsWith('.cjs')) {\n+    isCommonJS = true\n+  } else if (configPath.endsWith('.mjs')) {\n+    isCommonJS = false\n+  } else if (configPath.endsWith('.js')) {\n+    // For .js files, check package.json type field\n+    const projectRoot = path.dirname(configPath)\n+    const packageJsonPath = path.join(projectRoot, 'package.json')\n+\n+    try {\n+      if (existsSync(packageJsonPath)) {\n+        const packageJson = JSON.parse(readFileSync(packageJsonPath, 'utf8'))\n+        isCommonJS = packageJson.type !== 'module'\n+      } else {\n+        // Default to CommonJS if no package.json found\n+        isCommonJS = true\n+      }\n+    } catch {\n+      // Default to CommonJS if package.json can't be read\n+      isCommonJS = true\n+    }\n+\n+    // Always check file syntax to override package.json detection if needed\n+    // This handles cases where package.json doesn't specify type but file uses ES modules\n+    const hasESModuleSyntax =\n+      root.find(j.ExportDefaultDeclaration).size() > 0 ||\n+      root.find(j.ExportNamedDeclaration).size() > 0 ||\n+      root.find(j.ImportDeclaration).size() > 0\n+\n+    const hasCommonJSSyntax =\n+      root\n+        .find(j.AssignmentExpression, {\n+          left: {\n+            type: 'MemberExpression',\n+            object: { name: 'module' },\n+            property: { name: 'exports' },\n+          },\n+        })\n+        .size() > 0\n+\n+    // Override package.json detection based on actual syntax\n+    if (hasESModuleSyntax && !hasCommonJSSyntax) {\n+      isCommonJS = false\n+    } else if (hasCommonJSSyntax && !hasESModuleSyntax) {\n+      isCommonJS = true\n+    }\n+    // If both or neither are found, keep the package.json-based detection\n+  } else {\n+    // For other extensions (.ts, .mts, .cts), assume based on extension\n+    isCommonJS = configPath.endsWith('.cts')\n+  }\n+\n+  // Find the exported array\n+  let exportedArray = null\n+  let exportNode = null\n+\n+  if (isCommonJS) {\n+    // Look for module.exports = [...]\n+    const moduleExports = root.find(j.AssignmentExpression, {\n+      left: {\n+        type: 'MemberExpression',\n+        object: { name: 'module' },\n+        property: { name: 'exports' },\n+      },\n+      right: { type: 'ArrayExpression' },\n+    })\n+\n+    if (moduleExports.size() > 0) {\n+      exportNode = moduleExports.at(0)\n+      exportedArray = exportNode.get('right')\n+    }\n+  } else {\n+    // Look for export default [...]\n+    const defaultExports = root.find(j.ExportDefaultDeclaration, {\n+      declaration: { type: 'ArrayExpression' },\n+    })\n+\n+    if (defaultExports.size() > 0) {\n+      exportNode = defaultExports.at(0)\n+      exportedArray = exportNode.get('declaration')\n+    } else {\n+      // Look for const variable = [...]; export default variable\n+      const defaultExportIdentifier = root.find(j.ExportDefaultDeclaration, {\n+        declaration: { type: 'Identifier' },\n+      })\n+\n+      if (defaultExportIdentifier.size() > 0) {\n+        const declarationNode = defaultExportIdentifier.at(0).get('declaration')\n+        if (!declarationNode.value) {\n+          return false\n+        }\n+        const varName = declarationNode.value.name\n+        const varDeclaration = root.find(j.VariableDeclarator, {\n+          id: { name: varName },\n+          init: { type: 'ArrayExpression' },\n+        })\n+\n+        if (varDeclaration.size() > 0) {\n+          exportedArray = varDeclaration.at(0).get('init')\n+        }\n+      }\n+    }\n+  }\n+\n+  if (!exportedArray) {\n+    console.warn(\n+      prefixes.warn,\n+      '   Config does not export an array. Manual migration required.'\n+    )\n+    console.warn(\n+      prefixes.warn,\n+      '   ESLint flat configs must export an array of configuration objects.'\n+    )\n+    return false\n+  }\n+\n+  // Check if FlatCompat is already imported\n+  const hasFlatCompat = isCommonJS\n+    ? root\n+        .find(j.CallExpression, {\n+          callee: { name: 'require' },\n+          arguments: [{ value: '@eslint/eslintrc' }],\n+        })\n+        .size() > 0\n+    : root\n+        .find(j.ImportDeclaration, {\n+          source: { value: '@eslint/eslintrc' },\n+        })\n+        .size() > 0\n+\n+  // Add necessary imports if not present and if we're adding Next.js extends\n+  if (!hasFlatCompat && !hasNextConfigs) {\n+    if (isCommonJS) {\n+      // Add CommonJS requires at the top\n+      const firstNode = root.find(j.Program).get('body', 0)\n+      const compatRequire = j.variableDeclaration('const', [\n+        j.variableDeclarator(\n+          j.objectPattern([\n+            j.property(\n+              'init',\n+              j.identifier('FlatCompat'),\n+              j.identifier('FlatCompat')\n+            ),\n+          ]),\n+          j.callExpression(j.identifier('require'), [\n+            j.literal('@eslint/eslintrc'),\n+          ])\n+        ),\n+      ])\n+      const pathRequire = j.variableDeclaration('const', [\n+        j.variableDeclarator(\n+          j.identifier('path'),\n+          j.callExpression(j.identifier('require'), [j.literal('path')])\n+        ),\n+      ])\n+      const compatNew = j.variableDeclaration('const', [\n+        j.variableDeclarator(\n+          j.identifier('compat'),\n+          j.newExpression(j.identifier('FlatCompat'), [\n+            j.objectExpression([\n+              j.property(\n+                'init',\n+                j.identifier('baseDirectory'),\n+                j.identifier('__dirname')\n+              ),\n+            ]),\n+          ])\n+        ),\n+      ])\n+\n+      j(firstNode).insertBefore(compatRequire)\n+      j(firstNode).insertBefore(pathRequire)\n+      j(firstNode).insertBefore(compatNew)\n+    } else {\n+      // Add ES module imports\n+      const firstImport = root.find(j.ImportDeclaration).at(0)\n+      const insertPoint =\n+        firstImport.size() > 0\n+          ? firstImport\n+          : root.find(j.Program).get('body', 0)\n+\n+      const imports = [\n+        j.importDeclaration(\n+          [j.importSpecifier(j.identifier('dirname'))],\n+          j.literal('path')\n+        ),\n+        j.importDeclaration(\n+          [j.importSpecifier(j.identifier('fileURLToPath'))],\n+          j.literal('url')\n+        ),\n+        j.importDeclaration(\n+          [j.importSpecifier(j.identifier('FlatCompat'))],\n+          j.literal('@eslint/eslintrc')\n+        ),\n+      ]\n+\n+      const setupVars = [\n+        j.variableDeclaration('const', [\n+          j.variableDeclarator(\n+            j.identifier('__filename'),\n+            j.callExpression(j.identifier('fileURLToPath'), [\n+              j.memberExpression(\n+                j.memberExpression(\n+                  j.identifier('import'),\n+                  j.identifier('meta')\n+                ),\n+                j.identifier('url')\n+              ),\n+            ])\n+          ),\n+        ]),\n+        j.variableDeclaration('const', [\n+          j.variableDeclarator(\n+            j.identifier('__dirname'),\n+            j.callExpression(j.identifier('dirname'), [\n+              j.identifier('__filename'),\n+            ])\n+          ),\n+        ]),\n+        j.variableDeclaration('const', [\n+          j.variableDeclarator(\n+            j.identifier('compat'),\n+            j.newExpression(j.identifier('FlatCompat'), [\n+              j.objectExpression([\n+                j.property(\n+                  'init',\n+                  j.identifier('baseDirectory'),\n+                  j.identifier('__dirname')\n+                ),\n+              ]),\n+            ])\n+          ),\n+        ]),\n+      ]\n+\n+      if (firstImport.size() > 0) {\n+        // Insert after the last import\n+        const lastImportPath = root.find(j.ImportDeclaration).at(-1).get()\n+        if (!lastImportPath) {\n+          // Fallback to inserting at the beginning\n+          const fallbackInsertPoint = root.find(j.Program).get('body', 0)\n+          imports.forEach((imp) => j(fallbackInsertPoint).insertBefore(imp))\n+          setupVars.forEach((v) => j(fallbackInsertPoint).insertBefore(v))\n+        } else {\n+          imports.forEach((imp) => j(lastImportPath).insertAfter(imp))\n+          setupVars.forEach((v) => j(lastImportPath).insertAfter(v))\n+        }\n+      } else {\n+        // Insert at the beginning\n+        imports.forEach((imp) => j(insertPoint).insertBefore(imp))\n+        setupVars.forEach((v) => j(insertPoint).insertBefore(v))\n+      }\n+    }\n+  }\n+\n+  // Create ignores configuration object\n+  const ignoresConfig = j.objectExpression([\n+    j.property(\n+      'init',\n+      j.identifier('ignores'),\n+      j.arrayExpression([\n+        j.literal('node_modules/**'),\n+        j.literal('.next/**'),\n+        j.literal('out/**'),\n+        j.literal('build/**'),\n+        j.literal('next-env.d.ts'),\n+      ])\n+    ),\n+  ])\n+\n+  // Only add Next.js extends if they're not already present\n+  if (!hasNextConfigs) {\n+    // Add Next.js configs to the array\n+    const nextExtends = isTypeScript\n+      ? ['next/core-web-vitals', 'next/typescript']\n+      : ['next/core-web-vitals']\n+\n+    const spreadElement = j.spreadElement(\n+      j.callExpression(\n+        j.memberExpression(j.identifier('compat'), j.identifier('extends')),\n+        nextExtends.map((ext) => j.literal(ext))\n+      )\n+    )\n+\n+    // Insert Next.js extends at the beginning of the array\n+    if (!exportedArray.value.elements) {\n+      exportedArray.value.elements = []\n+    }\n+    exportedArray.value.elements.unshift(spreadElement)\n+  }\n+\n+  // Check if ignores already exist in the config and merge if needed\n+  let existingIgnoresIndex = -1\n+  if (exportedArray.value.elements) {\n+    for (let i = 0; i < exportedArray.value.elements.length; i++) {\n+      const element = exportedArray.value.elements[i]\n+      if (\n+        element &&\n+        element.type === 'ObjectExpression' &&\n+        element.properties &&\n+        element.properties.some(\n+          (prop) =>\n+            prop.type === 'Property' &&\n+            prop.key &&\n+            prop.key.type === 'Identifier' &&\n+            prop.key.name === 'ignores'\n+        )\n+      ) {\n+        existingIgnoresIndex = i\n+        break\n+      }\n+    }\n+  }\n+\n+  if (existingIgnoresIndex === -1) {\n+    // No existing ignores, add our own at appropriate position\n+    const insertIndex = hasNextConfigs ? 0 : 1\n+    exportedArray.value.elements.splice(insertIndex, 0, ignoresConfig)\n+  } else {\n+    // Merge with existing ignores\n+    const existingIgnoresObj =\n+      exportedArray.value.elements[existingIgnoresIndex]\n+    const ignoresProp = existingIgnoresObj.properties.find(\n+      (prop) =>\n+        prop.type === 'Property' &&\n+        prop.key &&\n+        prop.key.type === 'Identifier' &&\n+        prop.key.name === 'ignores'\n+    )\n+\n+    if (\n+      ignoresProp &&\n+      ignoresProp.value &&\n+      ignoresProp.value.type === 'ArrayExpression'\n+    ) {\n+      // Add our ignores to the existing array if they're not already there\n+      const nextIgnores = [\n+        'node_modules/**',\n+        '.next/**',\n+        'out/**',\n+        'build/**',\n+        'next-env.d.ts',\n+      ]\n+\n+      const existingIgnores = ignoresProp.value.elements\n+        .map((el) => (el.type === 'Literal' ? el.value : null))\n+        .filter(Boolean)\n+\n+      for (const ignore of nextIgnores) {\n+        if (!existingIgnores.includes(ignore)) {\n+          ignoresProp.value.elements.push(j.literal(ignore))\n+        }\n+      }\n+    }\n+  }\n+\n+  // Generate the updated code\n+  const updatedContent = root.toSource()\n+\n+  if (updatedContent !== configContent) {\n+    try {\n+      writeFileSync(configPath, updatedContent)\n+    } catch (error) {\n+      console.error(`   Error writing config file: ${error}`)\n+      return false\n+    }\n+\n+    if (hasNextConfigs) {\n+      console.log(\n+        `   Updated ${path.basename(configPath)} with Next.js ignores configuration`\n+      )\n+    } else {\n+      console.log(\n+        `   Updated ${path.basename(configPath)} with Next.js ESLint configs`\n+      )\n+    }\n+    return true\n+  }\n+\n+  // If nothing changed but Next.js configs were already present, that's still success\n+  if (hasNextConfigs) {\n+    console.log('   Next.js ESLint configs already present in flat config')\n+    return true\n+  }\n+\n+  return false\n+}\n+\n+function updatePackageJsonScripts(packageJsonContent: string): {\n+  updated: boolean\n+  content: string\n+} {\n+  try {\n+    const packageJson = JSON.parse(packageJsonContent)\n+    let needsUpdate = false\n+\n+    if (!packageJson.scripts) {\n+      packageJson.scripts = {}\n+    }\n+\n+    // Process all scripts that contain \"next lint\"\n+    for (const scriptName in packageJson.scripts) {\n+      const scriptValue = packageJson.scripts[scriptName]\n+      if (\n+        typeof scriptValue === 'string' &&\n+        scriptValue.includes('next lint')\n+      ) {\n+        // Replace \"next lint\" with \"eslint\" and handle special arguments\n+        const updatedScript = scriptValue.replace(\n+          /\\bnext\\s+lint\\b([^&|;]*)/gi,\n+          (_match, args = '') => {\n+            // Track whether we need a trailing space before operators\n+            let trailingSpace = ''\n+            if (args.endsWith(' ')) {\n+              trailingSpace = ' '\n+              args = args.trimEnd()\n+            }\n+\n+            // Check for redirects (2>, 1>, etc.) and preserve them\n+            let redirect = ''\n+            const redirectMatch = args.match(/\\s+(\\d*>[>&]?.*)$/)\n+            if (redirectMatch) {\n+              redirect = ` ${redirectMatch[1]}`\n+              args = args.substring(0, redirectMatch.index)\n+            }\n+\n+            // Parse arguments - handle quoted strings properly\n+            const argTokens = []\n+            let current = ''\n+            let inQuotes = false\n+            let quoteChar = ''\n+\n+            for (let j = 0; j < args.length; j++) {\n+              const char = args[j]\n+              if (\n+                (char === '\"' || char === \"'\") &&\n+                (j === 0 || args[j - 1] !== '\\\\')\n+              ) {\n+                if (!inQuotes) {\n+                  inQuotes = true\n+                  quoteChar = char\n+                  current += char\n+                } else if (char === quoteChar) {\n+                  inQuotes = false\n+                  quoteChar = ''\n+                  current += char\n+                } else {\n+                  current += char\n+                }\n+              } else if (char === ' ' && !inQuotes) {\n+                if (current) {\n+                  argTokens.push(current)\n+                  current = ''\n+                }\n+              } else {\n+                current += char\n+              }\n+            }\n+            if (current) {\n+              argTokens.push(current)\n+            }\n+\n+            const eslintArgs = []\n+            const paths = []\n+\n+            for (let i = 0; i < argTokens.length; i++) {\n+              const token = argTokens[i]\n+\n+              if (token === '--strict') {\n+                eslintArgs.push('--max-warnings', '0')\n+              } else if (token === '--dir' && i + 1 < argTokens.length) {\n+                paths.push(argTokens[++i])\n+              } else if (token === '--file' && i + 1 < argTokens.length) {\n+                paths.push(argTokens[++i])\n+              } else if (token === '--rulesdir' && i + 1 < argTokens.length) {\n+                // Skip rulesdir and its value\n+                i++\n+              } else if (token === '--ext' && i + 1 < argTokens.length) {\n+                // Skip ext and its value\n+                i++\n+              } else if (token.startsWith('--')) {\n+                // Keep other flags and their values\n+                eslintArgs.push(token)\n+                if (\n+                  i + 1 < argTokens.length &&\n+                  !argTokens[i + 1].startsWith('--')\n+                ) {\n+                  eslintArgs.push(argTokens[++i])\n+                }\n+              } else {\n+                // Positional arguments (paths)\n+                paths.push(token)\n+              }\n+            }\n+\n+            // Build the result\n+            let result = 'eslint'\n+            if (eslintArgs.length > 0) {\n+              result += ` ${eslintArgs.join(' ')}`\n+            }\n+\n+            // Add paths or default to .\n+            if (paths.length > 0) {\n+              result += ` ${paths.join(' ')}`\n+            } else {\n+              result += ' .'\n+            }\n+\n+            // Add redirect if present\n+            result += redirect\n+\n+            // Add back trailing space if we had one\n+            result += trailingSpace\n+\n+            return result\n+          }\n+        )\n+\n+        if (updatedScript !== scriptValue) {\n+          packageJson.scripts[scriptName] = updatedScript\n+          needsUpdate = true\n+          console.log(\n+            `   Updated script \"${scriptName}\": \"${scriptValue}\" → \"${updatedScript}\"`\n+          )\n+\n+          // Note about unsupported flags\n+          if (scriptValue.includes('--rulesdir')) {\n+            console.log(`   Note: --rulesdir is not supported in ESLint v9`)\n+          }\n+          if (scriptValue.includes('--ext')) {\n+            console.log(`   Note: --ext is not needed in ESLint v9 flat config`)\n+          }\n+        }\n+      }\n+    }\n+\n+    // Ensure required devDependencies exist\n+    if (!packageJson.devDependencies) {\n+      packageJson.devDependencies = {}\n+    }\n+\n+    // Check if eslint exists in either dependencies or devDependencies\n+    if (\n+      !packageJson.devDependencies.eslint &&\n+      !packageJson.dependencies?.eslint\n+    ) {\n+      packageJson.devDependencies.eslint = '^9'\n+      needsUpdate = true\n+    }\n+\n+    // Check if eslint-config-next exists in either dependencies or devDependencies\n+    if (\n+      !packageJson.devDependencies['eslint-config-next'] &&\n+      !packageJson.dependencies?.['eslint-config-next']\n+    ) {\n+      // Use the same version as next if available\n+      const nextVersion =\n+        packageJson.dependencies?.next || packageJson.devDependencies?.next\n+      packageJson.devDependencies['eslint-config-next'] =\n+        nextVersion || 'latest'\n+      needsUpdate = true\n+    }\n+\n+    // Check if @eslint/eslintrc exists in either dependencies or devDependencies\n+    if (\n+      !packageJson.devDependencies['@eslint/eslintrc'] &&\n+      !packageJson.dependencies?.['@eslint/eslintrc']\n+    ) {\n+      packageJson.devDependencies['@eslint/eslintrc'] = '^3'\n+      needsUpdate = true\n+    }\n+\n+    const updatedContent = `${JSON.stringify(packageJson, null, 2)}\\n`\n+    return { updated: needsUpdate, content: updatedContent }\n+  } catch (error) {\n+    console.error('Error updating package.json:', error)\n+    return { updated: false, content: packageJsonContent }\n+  }\n+}\n+\n+export default function transformer(\n+  files: string[],\n+  options: TransformerOptions = {}\n+): void {\n+  // The codemod CLI passes arguments as an array for consistency with file-based transforms,\n+  // but project-level transforms like this one only process a single directory.\n+  // Usage: npx @next/codemod next-lint-to-eslint-cli <project-directory>\n+  const dir = files[0]\n+  if (!dir) {\n+    console.error('Error: Please specify a directory path')\n+    return\n+  }\n+\n+  // Allow skipping installation via option\n+  const skipInstall = options.skipInstall === true\n+\n+  const projectRoot = path.resolve(dir)\n+  const packageJsonPath = path.join(projectRoot, 'package.json')\n+\n+  if (!existsSync(packageJsonPath)) {\n+    console.error('Error: package.json not found in the specified directory')\n+    return\n+  }\n+\n+  const isTypeScript = detectTypeScript(projectRoot)\n+\n+  console.log('Migrating from next lint to the ESLint CLI...')\n+\n+  // Check for existing ESLint config\n+  const existingConfig = findExistingEslintConfig(projectRoot)\n+\n+  if (existingConfig.exists) {\n+    if (existingConfig.isFlat) {\n+      // Try to update existing flat config\n+      if (existingConfig.path) {\n+        console.log(\n+          `   Found existing flat config: ${path.basename(existingConfig.path)}`\n+        )\n+        const updated = updateExistingFlatConfig(\n+          existingConfig.path,\n+          isTypeScript\n+        )\n+\n+        if (!updated) {\n+          console.log(\n+            '   Could not automatically update the existing flat config.'\n+          )\n+          console.log(\n+            '   Please manually ensure your ESLint config extends \"next/core-web-vitals\"'\n+          )\n+          if (isTypeScript) {\n+            console.log('   and \"next/typescript\" for TypeScript projects.')\n+          }\n+        }\n+      }\n+    } else {\n+      // Legacy config exists\n+      if (existingConfig.path) {\n+        console.log(\n+          `   Found legacy ESLint config: ${path.basename(existingConfig.path)}`\n+        )\n+        console.log(\n+          '   Legacy .eslintrc configs are not automatically migrated.'\n+        )\n+        console.log(\n+          '   Please migrate to flat config format (eslint.config.js) and ensure it extends:'\n+        )\n+        console.log('   - \"next/core-web-vitals\"')\n+        if (isTypeScript) {\n+          console.log('   - \"next/typescript\"')\n+        }\n+        console.log(\n+          '   Learn more: https://eslint.org/docs/latest/use/configure/migration-guide'\n+        )\n+      }\n+    }\n+  } else {\n+    // Create new ESLint flat config\n+    const eslintConfigPath = path.join(projectRoot, 'eslint.config.mjs')\n+    const template = isTypeScript\n+      ? ESLINT_CONFIG_TEMPLATE_TYPESCRIPT\n+      : ESLINT_CONFIG_TEMPLATE_JAVASCRIPT\n+\n+    try {\n+      writeFileSync(eslintConfigPath, template)\n+      console.log(`   Created ${path.basename(eslintConfigPath)}`)\n+    } catch (error) {\n+      console.error('   Error creating ESLint config:', error)\n+    }\n+  }\n+\n+  // Update package.json\n+  const packageJsonContent = readFileSync(packageJsonPath, 'utf8')\n+  const result = updatePackageJsonScripts(packageJsonContent)\n+\n+  if (result.updated) {\n+    try {\n+      writeFileSync(packageJsonPath, result.content)\n+      console.log('Updated package.json scripts and dependencies')\n+\n+      // Parse the updated package.json to find new dependencies\n+      const updatedPackageJson = JSON.parse(result.content)\n+      const originalPackageJson = JSON.parse(packageJsonContent)\n+\n+      const newDependencies: string[] = []\n+\n+      // Check for new devDependencies\n+      if (updatedPackageJson.devDependencies) {\n+        for (const [pkg, version] of Object.entries(\n+          updatedPackageJson.devDependencies\n+        )) {\n+          if (\n+            !originalPackageJson.devDependencies?.[pkg] &&\n+            !originalPackageJson.dependencies?.[pkg]\n+          ) {\n+            newDependencies.push(`${pkg}@${version}`)\n+          }\n+        }\n+      }\n+\n+      // Install new dependencies if any were added\n+      if (newDependencies.length > 0) {\n+        if (skipInstall) {\n+          console.log('\\nNew dependencies added to package.json:')\n+          newDependencies.forEach((dep) => console.log(`   - ${dep}`))\n+          console.log(`Please run: ${getPkgManager(projectRoot)} install`)\n+        } else {\n+          console.log('\\nInstalling new dependencies...')\n+          try {\n+            const packageManager = getPkgManager(projectRoot)\n+            console.log(`   Using ${packageManager}...`)\n+\n+            installPackages(newDependencies, {\n+              packageManager,\n+              dev: true,\n+              silent: false,\n+            })\n+\n+            console.log('   Dependencies installed successfully!')\n+          } catch (_error) {\n+            console.error('   Failed to install dependencies automatically.')\n+            console.error(\n+              `   Please run: ${getPkgManager(projectRoot)} install`\n+            )\n+          }\n+        }\n+      }\n+    } catch (error) {\n+      console.error('Error writing package.json:', error)\n+    }\n+  }\n+\n+  console.log('\\nMigration complete! Your project now uses the ESLint CLI.')\n+}"
        },
        {
            "sha": "7db95a7167d883077516ce54c21e5461d671bfe3",
            "filename": "packages/next/src/cli/next-lint.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext%2Fsrc%2Fcli%2Fnext-lint.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c57fe2561cda36f8a5abb41a94ea1a3f0a094226/packages%2Fnext%2Fsrc%2Fcli%2Fnext-lint.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcli%2Fnext-lint.ts?ref=c57fe2561cda36f8a5abb41a94ea1a3f0a094226",
            "patch": "@@ -70,9 +70,9 @@ const nextLint = async (options: NextLintOptions, directory?: string) => {\n       'For new projects, use ' +\n       bold('create-next-app') +\n       ' to choose your preferred linter.\\n' +\n-      'For existing projects, migrate to explicit ESLint configuration and update your package.json scripts to use ' +\n-      bold('\"eslint\"') +\n-      ' instead.\\n'\n+      'For existing projects, migrate to the ESLint CLI:\\n' +\n+      bold('npx @next/codemod@canary next-lint-to-eslint-cli .') +\n+      '\\n'\n   )\n \n   const baseDir = getProjectDir(directory)"
        }
    ],
    "stats": {
        "total": 1684,
        "additions": 1681,
        "deletions": 3
    }
}