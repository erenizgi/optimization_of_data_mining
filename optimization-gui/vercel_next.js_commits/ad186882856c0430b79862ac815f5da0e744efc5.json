{
    "author": "devjiwonchoi",
    "message": "[codemod] Remove runtime config when running `middleware-to-proxy` (#85075)\n\nStacked on https://github.com/vercel/next.js/pull/85139\n\nCloses NEXT-4746",
    "sha": "ad186882856c0430b79862ac815f5da0e744efc5",
    "files": [
        {
            "sha": "38e6598bc6e95ab61421c0733e97668084d3d801",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-direct-export.input.ts",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-direct-export.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-direct-export.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-direct-export.input.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,11 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+export const runtime = 'edge'\n+\n+export const config = {\n+  matcher: '/about/:path*',\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "416cb9b6465de5974681b6431ff318227ddc9926",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-direct-export.output.ts",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-direct-export.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-direct-export.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-direct-export.output.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,9 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function proxy(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+export const config = {\n+  matcher: '/about/:path*',\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "8de9f17521f840eb491c49cab8ee5a2dc4386dd9",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-in-config.input.ts",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-in-config.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-in-config.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-in-config.input.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,10 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+export const config = {\n+  runtime: 'edge',\n+  matcher: '/about/:path*',\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "bc2bfca58c23db1898c8188c32e6353e6587bf9d",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-in-config.output.ts",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-in-config.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-in-config.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-in-config.output.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,9 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function proxy(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+export const config = {\n+  matcher: '/about/:path*'\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "1e8865eecb756171461dd084ee17cf76dc2550c7",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-multi-declarator.input.ts",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multi-declarator.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multi-declarator.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multi-declarator.input.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,8 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+const runtime = 'edge', config = { matcher: '/test/*' }\n+export { runtime, config }\n\\ No newline at end of file"
        },
        {
            "sha": "9297c5e034b045e5efae880b49e492e114e3b4ee",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-multi-declarator.output.ts",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multi-declarator.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multi-declarator.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multi-declarator.output.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,8 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function proxy(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+const config = { matcher: '/test/*' };\n+export { config };\n\\ No newline at end of file"
        },
        {
            "sha": "301dec57af372687bf73740c3bb9e9590fa68012",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-multiple-exports.input.ts",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multiple-exports.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multiple-exports.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multiple-exports.input.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,12 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+export const runtime = 'edge'\n+\n+export const config = {\n+  runtime: 'nodejs',\n+  matcher: '/about/:path*',\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "bc2bfca58c23db1898c8188c32e6353e6587bf9d",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-multiple-exports.output.ts",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multiple-exports.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multiple-exports.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-multiple-exports.output.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,9 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function proxy(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+export const config = {\n+  matcher: '/about/:path*'\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "e118cd09ca6a05b7923d2590958e2226e466e0e1",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-only-config.input.ts",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-only-config.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-only-config.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-only-config.input.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,9 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+export const config = {\n+  runtime: 'edge',\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "6a2ba877d31be36eedc02679a00c79c776a8b284",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-only-config.output.ts",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-only-config.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-only-config.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-only-config.output.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,5 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function proxy(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "c5a604248f8bf56624a9628fbf1564020ebc85ef",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-separate-export-mixed.input.ts",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export-mixed.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export-mixed.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export-mixed.input.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,12 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+const runtime = 'edge'\n+const config = {\n+  matcher: '/api/:path*',\n+}\n+\n+export { runtime, config }\n\\ No newline at end of file"
        },
        {
            "sha": "b8dd5882da038a48acd03aecef14b5cb82de0473",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-separate-export-mixed.output.ts",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export-mixed.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export-mixed.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export-mixed.output.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,11 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function proxy(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+const config = {\n+  matcher: '/api/:path*',\n+}\n+\n+export { config };\n\\ No newline at end of file"
        },
        {
            "sha": "1838bf8f40a14d3895fc631cdd91a72c9ec6e128",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-separate-export.input.ts",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export.input.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export.input.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export.input.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,9 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function middleware(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n+\n+const runtime = 'edge'\n+\n+export { runtime }\n\\ No newline at end of file"
        },
        {
            "sha": "6a2ba877d31be36eedc02679a00c79c776a8b284",
            "filename": "packages/next-codemod/transforms/__testfixtures__/middleware-to-proxy/runtime-separate-export.output.ts",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export.output.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export.output.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2F__testfixtures__%2Fmiddleware-to-proxy%2Fruntime-separate-export.output.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -0,0 +1,5 @@\n+import { NextResponse, NextRequest } from 'next/server'\n+\n+export function proxy(request: NextRequest) {\n+  return NextResponse.redirect(new URL('/home', request.url))\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "b8461f02238a81d8b8c7bc8eb698fb236dfce7a3",
            "filename": "packages/next-codemod/transforms/middleware-to-proxy.ts",
            "status": "modified",
            "additions": 143,
            "deletions": 0,
            "changes": 143,
            "blob_url": "https://github.com/vercel/next.js/blob/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2Fmiddleware-to-proxy.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ad186882856c0430b79862ac815f5da0e744efc5/packages%2Fnext-codemod%2Ftransforms%2Fmiddleware-to-proxy.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-codemod%2Ftransforms%2Fmiddleware-to-proxy.ts?ref=ad186882856c0430b79862ac815f5da0e744efc5",
            "patch": "@@ -63,6 +63,10 @@ export default function transformer(file: FileInfo) {\n   if (isMiddlewareFile) {\n     const middlewareChanges = transformMiddlewareFunction(root, j)\n     hasChanges = hasChanges || middlewareChanges.hasChanges\n+\n+    // Remove runtime segment config\n+    const runtimeChanges = removeRuntimeConfig(root, j)\n+    hasChanges = hasChanges || runtimeChanges\n   }\n \n   if (isNextConfig) {\n@@ -795,3 +799,142 @@ function extractObjectsFromCallExpression(\n     })\n   }\n }\n+\n+function removeRuntimeConfig(root: Collection<any>, j: API['j']): boolean {\n+  let hasChanges = false\n+\n+  // Remove export const runtime = 'string'\n+  const directRuntimeExports = root.find(j.ExportNamedDeclaration, {\n+    declaration: {\n+      type: 'VariableDeclaration',\n+      declarations: [\n+        {\n+          id: { name: 'runtime' },\n+        },\n+      ],\n+    },\n+  })\n+\n+  if (directRuntimeExports.size() > 0) {\n+    directRuntimeExports.remove()\n+    hasChanges = true\n+  }\n+\n+  // Remove const runtime = 'string' declarations\n+  const runtimeVariableDeclarations = root\n+    .find(j.VariableDeclaration)\n+    .filter((path) =>\n+      path.node.declarations.some((decl) => {\n+        if (j.VariableDeclarator.check(decl) && j.Identifier.check(decl.id)) {\n+          return decl.id.name === 'runtime'\n+        }\n+        return false\n+      })\n+    )\n+\n+  if (runtimeVariableDeclarations.size() > 0) {\n+    runtimeVariableDeclarations.forEach((path) => {\n+      const originalDeclarations = path.node.declarations\n+      const filteredDeclarations = originalDeclarations.filter((decl) => {\n+        if (j.VariableDeclarator.check(decl) && j.Identifier.check(decl.id)) {\n+          return decl.id.name !== 'runtime'\n+        }\n+        return true\n+      })\n+\n+      // If we filtered out some declarations, update the node\n+      if (filteredDeclarations.length !== originalDeclarations.length) {\n+        // Remove the entire declaration only if no declarators left\n+        if (filteredDeclarations.length === 0) {\n+          j(path).remove()\n+        } else {\n+          path.node.declarations = filteredDeclarations\n+        }\n+      }\n+    })\n+    hasChanges = true\n+  }\n+\n+  // Handle export { runtime } and export { runtime, other }\n+  const namedExports = root\n+    .find(j.ExportNamedDeclaration)\n+    .filter((path) => path.node.specifiers && path.node.specifiers.length > 0)\n+\n+  namedExports.forEach((path) => {\n+    const specifiers = path.node.specifiers\n+    if (!specifiers) return\n+\n+    const filteredSpecifiers = specifiers.filter((spec) => {\n+      if (j.ExportSpecifier.check(spec) && j.Identifier.check(spec.local)) {\n+        return spec.local.name !== 'runtime'\n+      }\n+      return true\n+    })\n+\n+    // If we removed any specifiers\n+    if (filteredSpecifiers.length !== specifiers.length) {\n+      hasChanges = true\n+\n+      // If no specifiers left, remove the entire export statement\n+      if (filteredSpecifiers.length === 0) {\n+        j(path).remove()\n+      } else {\n+        // Update the specifiers array\n+        path.node.specifiers = filteredSpecifiers\n+      }\n+    }\n+  })\n+\n+  // Handle runtime property in config objects\n+  const configExports = root.find(j.ExportNamedDeclaration, {\n+    declaration: {\n+      type: 'VariableDeclaration',\n+      declarations: [\n+        {\n+          id: { name: 'config' },\n+        },\n+      ],\n+    },\n+  })\n+\n+  configExports.forEach((path) => {\n+    const declaration = path.node.declaration\n+    if (j.VariableDeclaration.check(declaration)) {\n+      declaration.declarations.forEach((decl) => {\n+        if (\n+          j.VariableDeclarator.check(decl) &&\n+          j.Identifier.check(decl.id) &&\n+          decl.id.name === 'config' &&\n+          j.ObjectExpression.check(decl.init)\n+        ) {\n+          const objExpr = decl.init\n+          const initialLength = objExpr.properties.length\n+\n+          // Filter out runtime property\n+          objExpr.properties = objExpr.properties.filter((prop) => {\n+            if (\n+              isStaticProperty(prop) &&\n+              prop.key &&\n+              prop.key.type === 'Identifier'\n+            ) {\n+              return prop.key.name !== 'runtime'\n+            }\n+            return true\n+          })\n+\n+          // If we removed any properties\n+          if (objExpr.properties.length !== initialLength) {\n+            hasChanges = true\n+\n+            // If no properties left, remove the entire config export\n+            if (objExpr.properties.length === 0) {\n+              j(path).remove()\n+            }\n+          }\n+        }\n+      })\n+    }\n+  })\n+\n+  return hasChanges\n+}"
        }
    ],
    "stats": {
        "total": 270,
        "additions": 270,
        "deletions": 0
    }
}