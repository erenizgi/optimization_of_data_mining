{
    "author": "lukesandberg",
    "message": "[turbopack] Refactor the analyzer to fix a few issues and prepare to split it up (#86265)\n\n# Refactor Analyzer State Management in Turbopack\n\nThis PR refactors the state management in the Turbopack ECMAScript analyzer to improve code organization and maintainability. The changes include:\n\n- Introduced a `LexicalContext` enum to track the current execution context (function, module, control flow) and remove most dependencies on AstPath\n- Moved early return stack and variable declaration kind into the `AnalyzerState` struct\n- Added helper methods for entering and exiting different block types\n- Improved handling of nested blocks and control flow\n- Fixed unreachable code detection in anonymous blocks which allows us to drop some redundant unreachable effects from loops\n - Handle more cases for nested `var` declarations\n\nThese refactorings are all either fixing minor issues or regularizing state management.  This is preparation for splitting this AST traversal into two pieces.",
    "sha": "e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
    "files": [
        {
            "sha": "9c0ea18622159fc97e6f73c306f8f0317cd8f82a",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/graph.rs",
            "status": "modified",
            "additions": 422,
            "deletions": 297,
            "changes": 719,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fgraph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fgraph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fgraph.rs?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -357,8 +357,6 @@ pub fn create_graph(\n             eval_context,\n             effects: Default::default(),\n             hoisted_effects: Default::default(),\n-            early_return_stack: Default::default(),\n-            var_decl_kind: Default::default(),\n         },\n         &mut Default::default(),\n     );\n@@ -885,11 +883,8 @@ struct Analyzer<'a> {\n     // Tracked separately so we can preserve effects from hoisted declarations even when we don't\n     // collect effects from the declaring context.\n     hoisted_effects: Vec<Effect>,\n-    early_return_stack: Vec<EarlyReturn>,\n \n     eval_context: &'a EvalContext,\n-\n-    var_decl_kind: Option<VarDeclKind>,\n }\n \n trait FunctionLike {\n@@ -900,6 +895,9 @@ trait FunctionLike {\n         false\n     }\n     fn span(&self) -> Span;\n+    fn binds_this(&self) -> bool {\n+        true\n+    }\n }\n \n impl FunctionLike for Function {\n@@ -923,6 +921,9 @@ impl FunctionLike for ArrowExpr {\n     fn span(&self) -> Span {\n         self.span\n     }\n+    fn binds_this(&self) -> bool {\n+        false\n+    }\n }\n \n impl FunctionLike for Constructor {\n@@ -941,44 +942,117 @@ impl FunctionLike for SetterProp {\n     }\n }\n \n+#[derive(PartialEq, Eq, Debug, Copy, Clone)]\n+enum LexicalContext {\n+    // In the root of a function scope\n+    Function { id: u32, binds_this: bool },\n+    // A placeholder for identify anonymous blocks\n+    // If we have Block->Block then we are in an anonymous block\n+    // If we have Function->Block or ControlFlow->Block then we are just in a function root\n+    Block,\n+    // In some kind of control flow\n+    ControlFlow { is_try: bool },\n+\n+    // Class bodies do rebind `this` and are in many ways like a function\n+    ClassBody,\n+}\n+\n mod analyzer_state {\n     use super::*;\n \n     /// Contains fields of `Analyzer` that should only be modified using helper methods. These are\n     /// intentionally private to the rest of the `Analyzer` implementation.\n     pub struct AnalyzerState {\n         pat_value: Option<JsValue>,\n-        /// A unique identifier for the current function, based on the span of the function\n-        /// declaration. [`None`] if we are in the root scope.  These are only used as opaque\n-        /// identifiers to distinguish function arguments.\n-        cur_fn_id: Option<u32>,\n         /// Return values of the current function.\n         ///\n         /// This is configured to [Some] by function handlers and filled by the\n         /// return statement handler.\n         cur_fn_return_values: Option<Vec<JsValue>>,\n+        /// Stack of early returns for control flow analysis.\n+        early_return_stack: Vec<EarlyReturn>,\n+        lexical_stack: Vec<LexicalContext>,\n+        var_decl_kind: Option<VarDeclKind>,\n     }\n \n     impl AnalyzerState {\n         pub fn new() -> AnalyzerState {\n             AnalyzerState {\n                 pat_value: None,\n-                cur_fn_id: None,\n                 cur_fn_return_values: None,\n+                early_return_stack: Default::default(),\n+                lexical_stack: Default::default(),\n+                var_decl_kind: None,\n             }\n         }\n     }\n \n     impl Analyzer<'_> {\n         /// Returns true if we are in a function. False if we are in the root scope.\n         pub(super) fn is_in_fn(&self) -> bool {\n-            self.state.cur_fn_id.is_some()\n+            self.state\n+                .lexical_stack\n+                .iter()\n+                .any(|b| matches!(b, LexicalContext::Function { .. }))\n+        }\n+\n+        pub(super) fn is_in_try(&self) -> bool {\n+            self.state\n+                .lexical_stack\n+                .iter()\n+                .rev()\n+                .take_while(|b| !matches!(b, LexicalContext::Function { .. }))\n+                .any(|b| *b == LexicalContext::ControlFlow { is_try: true })\n+        }\n+\n+        /// Returns true if we are currently in a block scope that isn't at the root of a function\n+        /// or a module.\n+        pub(super) fn is_in_nested_block_scope(&self) -> bool {\n+            match &self.state.lexical_stack[self.state.lexical_stack.len().saturating_sub(2)..] {\n+                [LexicalContext::Block]\n+                | [LexicalContext::Function { .. }, LexicalContext::Block] => false,\n+                [] => {\n+                    unreachable!()\n+                }\n+\n+                _ => true,\n+            }\n+        }\n+\n+        pub(super) fn cur_lexical_context(&self) -> LexicalContext {\n+            *self.state.lexical_stack.last().unwrap()\n         }\n \n         /// Returns the identifier of the current function.\n         /// must be called only if `is_in_fn` is true\n         pub(super) fn cur_fn_ident(&self) -> u32 {\n-            self.state.cur_fn_id.expect(\"not in a function\")\n+            *self\n+                .state\n+                .lexical_stack\n+                .iter()\n+                .rev()\n+                .filter_map(|b| {\n+                    if let LexicalContext::Function { id, .. } = b {\n+                        Some(id)\n+                    } else {\n+                        None\n+                    }\n+                })\n+                .next()\n+                .expect(\"not in a function\")\n+        }\n+\n+        /// Returns true if `this` is bound in any active scope\n+        pub(super) fn is_this_bound(&self) -> bool {\n+            self.state.lexical_stack.iter().rev().any(|b| {\n+                matches!(\n+                    b,\n+                    LexicalContext::Function {\n+                        id: _,\n+                        binds_this: true\n+                    } | LexicalContext::ClassBody\n+                )\n+            })\n         }\n \n         /// Adds a return value to the current function.\n@@ -1015,6 +1089,24 @@ mod analyzer_state {\n             out\n         }\n \n+        /// Runs `func` with the given variable declaration kind, restoring the previous kind\n+        /// afterwards.\n+        pub(super) fn with_decl_kind<T>(\n+            &mut self,\n+            kind: Option<VarDeclKind>,\n+            func: impl FnOnce(&mut Self) -> T,\n+        ) -> T {\n+            let prev_kind = replace(&mut self.state.var_decl_kind, kind);\n+            let out = func(self);\n+            self.state.var_decl_kind = prev_kind;\n+            out\n+        }\n+\n+        /// Returns the current variable declaration kind.\n+        pub(super) fn var_decl_kind(&self) -> Option<VarDeclKind> {\n+            self.state.var_decl_kind\n+        }\n+\n         /// Runs `func` with the current function identifier and return values initialized for the\n         /// block.\n         pub(super) fn enter_fn(\n@@ -1023,14 +1115,18 @@ mod analyzer_state {\n             visitor: impl FnOnce(&mut Self),\n         ) -> JsValue {\n             let fn_id = function.span().lo.0;\n-            let prev_fn_id = self.state.cur_fn_id.replace(fn_id);\n             let prev_return_values = self.state.cur_fn_return_values.replace(vec![]);\n \n-            visitor(self);\n+            self.with_block(\n+                LexicalContext::Function {\n+                    id: fn_id,\n+                    binds_this: function.binds_this(),\n+                },\n+                |this| visitor(this),\n+            );\n             let return_values = self.state.cur_fn_return_values.take().unwrap();\n-\n-            self.state.cur_fn_id = prev_fn_id;\n             self.state.cur_fn_return_values = prev_return_values;\n+\n             JsValue::function(\n                 fn_id,\n                 function.is_async(),\n@@ -1042,6 +1138,147 @@ mod analyzer_state {\n                 },\n             )\n         }\n+\n+        /// Helper to access the early_return_stack mutably (for push operations)\n+        pub(super) fn early_return_stack_mut(&mut self) -> &mut Vec<EarlyReturn> {\n+            &mut self.state.early_return_stack\n+        }\n+\n+        /// Records an unconditional early return (return, throw, or finally block that always\n+        /// returns). Takes ownership of current effects and pushes them onto the early return\n+        /// stack.\n+        pub(super) fn add_early_return_always(\n+            &mut self,\n+            ast_path: &AstNodePath<AstParentNodeRef<'_>>,\n+        ) {\n+            let early_return = EarlyReturn::Always {\n+                prev_effects: take(&mut self.effects),\n+                start_ast_path: as_parent_path(ast_path),\n+            };\n+            self.early_return_stack_mut().push(early_return);\n+        }\n+\n+        /// Runs `func` with a fresh early return stack, restoring the previous stack afterwards.\n+        /// Returns the result of `func` and whether the block always returns (from\n+        /// `end_early_return_block`).\n+        pub(super) fn enter_control_flow<T>(\n+            &mut self,\n+            func: impl FnOnce(&mut Self) -> T,\n+        ) -> (T, bool) {\n+            self.enter_block(LexicalContext::ControlFlow { is_try: false }, |this| {\n+                func(this)\n+            })\n+        }\n+        /// Runs `func` with a fresh early return stack, restoring the previous stack afterwards.\n+        /// Returns the result of `func` and whether the block always returns (from\n+        /// `end_early_return_block`).\n+        pub(super) fn enter_try<T>(&mut self, func: impl FnOnce(&mut Self) -> T) -> (T, bool) {\n+            self.enter_block(LexicalContext::ControlFlow { is_try: true }, |this| {\n+                func(this)\n+            })\n+        }\n+\n+        /// Runs `func` with a fresh early return stack, restoring the previous stack afterwards.\n+        /// Returns the result of `func` and whether the block always returns (from\n+        /// `end_early_return_block`).\n+        pub(super) fn enter_block<T>(\n+            &mut self,\n+            block_kind: LexicalContext,\n+            func: impl FnOnce(&mut Self) -> T,\n+        ) -> (T, bool) {\n+            let prev_early_return_stack = take(&mut self.state.early_return_stack);\n+            let result = self.with_block(block_kind, func);\n+            let always_returns = self.end_early_return_block();\n+            self.state.early_return_stack = prev_early_return_stack;\n+            (result, always_returns)\n+        }\n+\n+        /// Pushes a block onto the stack without performing early return logic.\n+        pub(super) fn with_block<T>(\n+            &mut self,\n+            block_kind: LexicalContext,\n+            func: impl FnOnce(&mut Self) -> T,\n+        ) -> T {\n+            self.state.lexical_stack.push(block_kind);\n+            let result = func(self);\n+            let old = self.state.lexical_stack.pop();\n+            debug_assert_eq!(old, Some(block_kind));\n+            result\n+        }\n+\n+        /// Ends a conditional block. All early returns are integrated into the\n+        /// effects. Returns true if the whole block always early returns.\n+        fn end_early_return_block(&mut self) -> bool {\n+            let mut always_returns = false;\n+            while let Some(early_return) = self.state.early_return_stack.pop() {\n+                match early_return {\n+                    EarlyReturn::Always {\n+                        prev_effects,\n+                        start_ast_path,\n+                    } => {\n+                        self.effects = prev_effects;\n+                        if self.analyze_mode.is_code_gen() {\n+                            self.effects.push(Effect::Unreachable { start_ast_path });\n+                        }\n+                        always_returns = true;\n+                    }\n+                    EarlyReturn::Conditional {\n+                        prev_effects,\n+                        start_ast_path,\n+                        condition,\n+                        then,\n+                        r#else,\n+                        condition_ast_path,\n+                        span,\n+                        early_return_condition_value,\n+                    } => {\n+                        let block = Box::new(EffectsBlock {\n+                            effects: take(&mut self.effects),\n+                            range: AstPathRange::StartAfter(start_ast_path),\n+                        });\n+                        self.effects = prev_effects;\n+                        let kind = match (then, r#else, early_return_condition_value) {\n+                            (None, None, false) => ConditionalKind::If { then: block },\n+                            (None, None, true) => ConditionalKind::IfElseMultiple {\n+                                then: vec![block],\n+                                r#else: vec![],\n+                            },\n+                            (Some(then), None, false) => ConditionalKind::IfElseMultiple {\n+                                then: vec![then, block],\n+                                r#else: vec![],\n+                            },\n+                            (Some(then), None, true) => ConditionalKind::IfElse {\n+                                then,\n+                                r#else: block,\n+                            },\n+                            (Some(then), Some(r#else), false) => ConditionalKind::IfElseMultiple {\n+                                then: vec![then, block],\n+                                r#else: vec![r#else],\n+                            },\n+                            (Some(then), Some(r#else), true) => ConditionalKind::IfElseMultiple {\n+                                then: vec![then],\n+                                r#else: vec![r#else, block],\n+                            },\n+                            (None, Some(r#else), false) => ConditionalKind::IfElse {\n+                                then: block,\n+                                r#else,\n+                            },\n+                            (None, Some(r#else), true) => ConditionalKind::IfElseMultiple {\n+                                then: vec![],\n+                                r#else: vec![r#else, block],\n+                            },\n+                        };\n+                        self.effects.push(Effect::Conditional {\n+                            condition,\n+                            kind: Box::new(kind),\n+                            ast_path: condition_ast_path,\n+                            span,\n+                        })\n+                    }\n+                }\n+            }\n+            always_returns\n+        }\n     }\n }\n \n@@ -1060,24 +1297,6 @@ pub fn as_parent_path_with(\n         .collect()\n }\n \n-fn is_in_try(ast_path: &AstNodePath<AstParentNodeRef<'_>>) -> bool {\n-    ast_path\n-        .iter()\n-        .rev()\n-        .find_map(|ast_ref| match ast_ref.kind() {\n-            AstParentKind::ArrowExpr(ArrowExprField::Body)\n-            | AstParentKind::Function(FunctionField::Body)\n-            | AstParentKind::Constructor(ConstructorField::Body)\n-            | AstParentKind::ClassMethod(ClassMethodField::Function)\n-            | AstParentKind::GetterProp(GetterPropField::Body)\n-            | AstParentKind::SetterProp(SetterPropField::Body)\n-            | AstParentKind::MethodProp(MethodPropField::Function) => Some(false),\n-            AstParentKind::TryStmt(TryStmtField::Block) => Some(true),\n-            _ => None,\n-        })\n-        .unwrap_or(false)\n-}\n-\n enum CallOrNewExpr<'ast> {\n     Call(&'ast CallExpr),\n     New(&'ast NewExpr),\n@@ -1423,7 +1642,7 @@ impl Analyzer<'_> {\n                     args,\n                     ast_path: as_parent_path(ast_path),\n                     span,\n-                    in_try: is_in_try(ast_path),\n+                    in_try: self.is_in_try(),\n                     new,\n                 });\n             }\n@@ -1447,7 +1666,7 @@ impl Analyzer<'_> {\n                         args,\n                         ast_path: as_parent_path(ast_path),\n                         span,\n-                        in_try: is_in_try(ast_path),\n+                        in_try: self.is_in_try(),\n                         new,\n                     });\n                 } else {\n@@ -1457,7 +1676,7 @@ impl Analyzer<'_> {\n                         args,\n                         ast_path: as_parent_path(ast_path),\n                         span,\n-                        in_try: is_in_try(ast_path),\n+                        in_try: self.is_in_try(),\n                         new,\n                     });\n                 }\n@@ -1471,7 +1690,7 @@ impl Analyzer<'_> {\n                 args,\n                 ast_path: as_parent_path(ast_path),\n                 span,\n-                in_try: is_in_try(ast_path),\n+                in_try: self.is_in_try(),\n                 new,\n             }),\n         }\n@@ -1504,80 +1723,6 @@ impl Analyzer<'_> {\n             span: member_expr.span(),\n         });\n     }\n-\n-    /// Ends a conditional block. All early returns are integrated into the\n-    /// effects. Returns true if the whole block always early returns.\n-    fn end_early_return_block(&mut self) -> bool {\n-        let mut always_returns = false;\n-        while let Some(early_return) = self.early_return_stack.pop() {\n-            match early_return {\n-                EarlyReturn::Always {\n-                    prev_effects,\n-                    start_ast_path,\n-                } => {\n-                    self.effects = prev_effects;\n-                    if self.analyze_mode.is_code_gen() {\n-                        self.effects.push(Effect::Unreachable { start_ast_path });\n-                    }\n-                    always_returns = true;\n-                }\n-                EarlyReturn::Conditional {\n-                    prev_effects,\n-                    start_ast_path,\n-                    condition,\n-                    then,\n-                    r#else,\n-                    condition_ast_path,\n-                    span,\n-                    early_return_condition_value,\n-                } => {\n-                    let block = Box::new(EffectsBlock {\n-                        effects: take(&mut self.effects),\n-                        range: AstPathRange::StartAfter(start_ast_path),\n-                    });\n-                    self.effects = prev_effects;\n-                    let kind = match (then, r#else, early_return_condition_value) {\n-                        (None, None, false) => ConditionalKind::If { then: block },\n-                        (None, None, true) => ConditionalKind::IfElseMultiple {\n-                            then: vec![block],\n-                            r#else: vec![],\n-                        },\n-                        (Some(then), None, false) => ConditionalKind::IfElseMultiple {\n-                            then: vec![then, block],\n-                            r#else: vec![],\n-                        },\n-                        (Some(then), None, true) => ConditionalKind::IfElse {\n-                            then,\n-                            r#else: block,\n-                        },\n-                        (Some(then), Some(r#else), false) => ConditionalKind::IfElseMultiple {\n-                            then: vec![then, block],\n-                            r#else: vec![r#else],\n-                        },\n-                        (Some(then), Some(r#else), true) => ConditionalKind::IfElseMultiple {\n-                            then: vec![then],\n-                            r#else: vec![r#else, block],\n-                        },\n-                        (None, Some(r#else), false) => ConditionalKind::IfElse {\n-                            then: block,\n-                            r#else,\n-                        },\n-                        (None, Some(r#else), true) => ConditionalKind::IfElseMultiple {\n-                            then: vec![],\n-                            r#else: vec![r#else, block],\n-                        },\n-                    };\n-                    self.effects.push(Effect::Conditional {\n-                        condition,\n-                        kind: Box::new(kind),\n-                        ast_path: condition_ast_path,\n-                        span,\n-                    })\n-                }\n-            }\n-        }\n-        always_returns\n-    }\n }\n \n impl VisitAstPath for Analyzer<'_> {\n@@ -1720,10 +1865,9 @@ impl VisitAstPath for Analyzer<'_> {\n         n: &'ast Expr,\n         ast_path: &mut AstNodePath<AstParentNodeRef<'r>>,\n     ) {\n-        let old = self.var_decl_kind;\n-        self.var_decl_kind = None;\n-        n.visit_children_with_ast_path(self, ast_path);\n-        self.var_decl_kind = old;\n+        self.with_decl_kind(None, |this| {\n+            n.visit_children_with_ast_path(this, ast_path);\n+        });\n     }\n \n     fn visit_params<'ast: 'r, 'r>(\n@@ -1745,25 +1889,25 @@ impl VisitAstPath for Analyzer<'_> {\n         n: &'ast Param,\n         ast_path: &mut AstNodePath<AstParentNodeRef<'r>>,\n     ) {\n-        let old = self.var_decl_kind;\n         let Param {\n             decorators,\n             pat,\n             span: _,\n         } = n;\n-        self.var_decl_kind = None;\n-        self.with_pat_value(None, |this| {\n-            let mut ast_path = ast_path.with_guard(AstParentNodeRef::Param(\n-                n,\n-                ParamField::Decorators(usize::MAX),\n-            ));\n-            this.visit_decorators(decorators, &mut ast_path);\n+        self.with_decl_kind(None, |this| {\n+            // Decorators don't have access to the parameter values, so omit them\n+            this.with_pat_value(None, |this| {\n+                let mut ast_path = ast_path.with_guard(AstParentNodeRef::Param(\n+                    n,\n+                    ParamField::Decorators(usize::MAX),\n+                ));\n+                this.visit_decorators(decorators, &mut ast_path);\n+            });\n+            {\n+                let mut ast_path = ast_path.with_guard(AstParentNodeRef::Param(n, ParamField::Pat));\n+                this.visit_pat(pat, &mut ast_path);\n+            }\n         });\n-        {\n-            let mut ast_path = ast_path.with_guard(AstParentNodeRef::Param(n, ParamField::Pat));\n-            self.visit_pat(pat, &mut ast_path);\n-        }\n-        self.var_decl_kind = old;\n     }\n \n     fn visit_fn_decl<'ast: 'r, 'r>(\n@@ -1776,8 +1920,8 @@ impl VisitAstPath for Analyzer<'_> {\n         });\n         // Take all effects produced by the function and move them to hoisted effects since\n         // function declarations are hoisted.\n-        // This accounts for the fact that even with `if (false) { function f() {} }` `f` is\n-        // hoisted out of the condition. so we still need to process effects for it.\n+        // This accounts for the fact that even with `if (true) { return f} function f() {} ` `f` is\n+        // hoisted earlier of the condition. so we still need to process effects for it.\n         // TODO(lukesandberg): shouldn't this just be the effects associated with the function.\n         self.hoisted_effects.append(&mut self.effects);\n \n@@ -1849,7 +1993,6 @@ impl VisitAstPath for Analyzer<'_> {\n     ) {\n         self.add_value_from_expr(\n             decl.ident.to_id(),\n-            // TODO avoid clone\n             &Expr::Class(ClassExpr {\n                 ident: Some(decl.ident.clone()),\n                 class: decl.class.clone(),\n@@ -1858,6 +2001,16 @@ impl VisitAstPath for Analyzer<'_> {\n         decl.visit_children_with_ast_path(self, ast_path);\n     }\n \n+    fn visit_class<'ast: 'r, 'r>(\n+        &mut self,\n+        node: &'ast Class,\n+        ast_path: &mut AstNodePath<AstParentNodeRef<'r>>,\n+    ) {\n+        self.enter_block(LexicalContext::ClassBody, |this| {\n+            node.visit_children_with_ast_path(this, ast_path);\n+        });\n+    }\n+\n     fn visit_getter_prop<'ast: 'r, 'r>(\n         &mut self,\n         node: &'ast GetterProp,\n@@ -1923,10 +2076,9 @@ impl VisitAstPath for Analyzer<'_> {\n         n: &'ast VarDecl,\n         ast_path: &mut AstNodePath<AstParentNodeRef<'r>>,\n     ) {\n-        let old = self.var_decl_kind;\n-        self.var_decl_kind = Some(n.kind);\n-        n.visit_children_with_ast_path(self, ast_path);\n-        self.var_decl_kind = old;\n+        self.with_decl_kind(Some(n.kind), |this| {\n+            n.visit_children_with_ast_path(this, ast_path);\n+        });\n     }\n \n     fn visit_var_declarator<'ast: 'r, 'r>(\n@@ -1939,7 +2091,7 @@ impl VisitAstPath for Analyzer<'_> {\n             let mut ast_path =\n                 ast_path.with_guard(AstParentNodeRef::VarDeclarator(n, VarDeclaratorField::Name));\n \n-            if self.var_decl_kind.is_some()\n+            if let Some(var_decl_kind) = self.var_decl_kind()\n                 && let Some(init) = &n.init\n             {\n                 // For case like\n@@ -1952,8 +2104,8 @@ impl VisitAstPath for Analyzer<'_> {\n                 //\n                 // The variable `x` is undefined\n \n-                let should_include_undefined = matches!(self.var_decl_kind, Some(VarDeclKind::Var))\n-                    && is_lexically_block_scope(&mut ast_path);\n+                let should_include_undefined =\n+                    var_decl_kind == VarDeclKind::Var && self.is_in_nested_block_scope();\n                 let init_value = self.eval_context.eval(init);\n                 let pat_value = Some(if should_include_undefined {\n                     JsValue::alternatives(vec![\n@@ -2013,10 +2165,9 @@ impl VisitAstPath for Analyzer<'_> {\n         let mut ast_path =\n             ast_path.with_guard(AstParentNodeRef::ForInStmt(n, ForInStmtField::Body));\n \n-        let prev_early_return_stack = take(&mut self.early_return_stack);\n-        n.body.visit_with_ast_path(self, &mut ast_path);\n-        self.end_early_return_block();\n-        self.early_return_stack = prev_early_return_stack;\n+        self.enter_control_flow(|this| {\n+            n.body.visit_with_ast_path(this, &mut ast_path);\n+        });\n     }\n \n     fn visit_for_of_stmt<'ast: 'r, 'r>(\n@@ -2042,43 +2193,78 @@ impl VisitAstPath for Analyzer<'_> {\n         let mut ast_path =\n             ast_path.with_guard(AstParentNodeRef::ForOfStmt(n, ForOfStmtField::Body));\n \n-        let prev_early_return_stack = take(&mut self.early_return_stack);\n-        n.body.visit_with_ast_path(self, &mut ast_path);\n-        self.end_early_return_block();\n-        self.early_return_stack = prev_early_return_stack;\n+        self.enter_control_flow(|this| {\n+            n.body.visit_with_ast_path(this, &mut ast_path);\n+        });\n     }\n \n     fn visit_for_stmt<'ast: 'r, 'r>(\n         &mut self,\n         n: &'ast ForStmt,\n         ast_path: &mut swc_core::ecma::visit::AstNodePath<'r>,\n     ) {\n-        let prev_early_return_stack = take(&mut self.early_return_stack);\n-        n.visit_children_with_ast_path(self, ast_path);\n-        self.end_early_return_block();\n-        self.early_return_stack = prev_early_return_stack;\n+        {\n+            let mut ast_path =\n+                ast_path.with_guard(AstParentNodeRef::ForStmt(n, ForStmtField::Init));\n+            n.init.visit_with_ast_path(self, &mut ast_path);\n+        }\n+        self.enter_control_flow(|this| {\n+            {\n+                let mut ast_path =\n+                    ast_path.with_guard(AstParentNodeRef::ForStmt(n, ForStmtField::Test));\n+                n.test.visit_with_ast_path(this, &mut ast_path);\n+            }\n+            {\n+                let mut ast_path =\n+                    ast_path.with_guard(AstParentNodeRef::ForStmt(n, ForStmtField::Body));\n+                n.body.visit_with_ast_path(this, &mut ast_path);\n+            }\n+            {\n+                let mut ast_path =\n+                    ast_path.with_guard(AstParentNodeRef::ForStmt(n, ForStmtField::Update));\n+                n.update.visit_with_ast_path(this, &mut ast_path);\n+            }\n+        });\n     }\n \n     fn visit_while_stmt<'ast: 'r, 'r>(\n         &mut self,\n         n: &'ast WhileStmt,\n         ast_path: &mut swc_core::ecma::visit::AstNodePath<'r>,\n     ) {\n-        let prev_early_return_stack = take(&mut self.early_return_stack);\n-        n.visit_children_with_ast_path(self, ast_path);\n-        self.end_early_return_block();\n-        self.early_return_stack = prev_early_return_stack;\n+        // Enter control flow for everything (test and body both repeat in loop iterations)\n+        self.enter_control_flow(|this| {\n+            {\n+                let mut ast_path =\n+                    ast_path.with_guard(AstParentNodeRef::WhileStmt(n, WhileStmtField::Test));\n+                n.test.visit_with_ast_path(this, &mut ast_path);\n+            }\n+            {\n+                let mut ast_path =\n+                    ast_path.with_guard(AstParentNodeRef::WhileStmt(n, WhileStmtField::Body));\n+                n.body.visit_with_ast_path(this, &mut ast_path);\n+            }\n+        });\n     }\n \n     fn visit_do_while_stmt<'ast: 'r, 'r>(\n         &mut self,\n         n: &'ast DoWhileStmt,\n         ast_path: &mut swc_core::ecma::visit::AstNodePath<'r>,\n     ) {\n-        let prev_early_return_stack = take(&mut self.early_return_stack);\n-        n.visit_children_with_ast_path(self, ast_path);\n-        self.end_early_return_block();\n-        self.early_return_stack = prev_early_return_stack;\n+        // Enter control flow for everything (body and test both are part of loop iterations)\n+        self.enter_control_flow(|this| {\n+            {\n+                let mut ast_path =\n+                    ast_path.with_guard(AstParentNodeRef::DoWhileStmt(n, DoWhileStmtField::Body));\n+                n.body.visit_with_ast_path(this, &mut ast_path);\n+            }\n+            {\n+                let mut ast_path =\n+                    ast_path.with_guard(AstParentNodeRef::DoWhileStmt(n, DoWhileStmtField::Test));\n+                n.test.visit_with_ast_path(this, &mut ast_path);\n+            }\n+        });\n     }\n \n     fn visit_simple_assign_target<'ast: 'r, 'r>(\n@@ -2187,10 +2373,7 @@ impl VisitAstPath for Analyzer<'_> {\n             self.add_return_value(return_value);\n         }\n \n-        self.early_return_stack.push(EarlyReturn::Always {\n-            prev_effects: take(&mut self.effects),\n-            start_ast_path: as_parent_path(ast_path),\n-        });\n+        self.add_early_return_always(ast_path);\n     }\n \n     fn visit_ident<'ast: 'r, 'r>(\n@@ -2262,27 +2445,7 @@ impl VisitAstPath for Analyzer<'_> {\n         node: &'ast ThisExpr,\n         ast_path: &mut swc_core::ecma::visit::AstNodePath<'r>,\n     ) {\n-        // TODO: would it be better to compute this while traversing?\n-        // `this` is rebound within functions and class method members\n-        if ast_path.iter().rev().any(|node| {\n-            matches!(\n-                node.kind(),\n-                AstParentKind::MethodProp(MethodPropField::Function)\n-                    | AstParentKind::GetterProp(GetterPropField::Body)\n-                    | AstParentKind::SetterProp(SetterPropField::Body)\n-                    | AstParentKind::Constructor(ConstructorField::Body)\n-                    | AstParentKind::ClassMethod(ClassMethodField::Function)\n-                    | AstParentKind::ClassDecl(ClassDeclField::Class)\n-                    | AstParentKind::ClassExpr(ClassExprField::Class)\n-                    | AstParentKind::Function(FunctionField::Body)\n-                    | AstParentKind::Function(FunctionField::Params(_))\n-            )\n-        }) {\n-            // We are in some scope that will rebind this\n-            return;\n-        }\n-\n-        if self.analyze_mode.is_code_gen() {\n+        if self.analyze_mode.is_code_gen() && !self.is_this_bound() {\n             // Otherwise 'this' is free\n             self.add_effect(Effect::FreeVar {\n                 var: atom!(\"this\"),\n@@ -2313,8 +2476,9 @@ impl VisitAstPath for Analyzer<'_> {\n         ast_path: &mut AstNodePath<AstParentNodeRef<'r>>,\n     ) {\n         self.effects = take(&mut self.data.effects);\n-        program.visit_children_with_ast_path(self, ast_path);\n-        self.end_early_return_block();\n+        self.enter_block(LexicalContext::Block, |this| {\n+            program.visit_children_with_ast_path(this, ast_path);\n+        });\n         self.effects.append(&mut self.hoisted_effects);\n         self.data.effects = take(&mut self.effects);\n     }\n@@ -2414,13 +2578,16 @@ impl VisitAstPath for Analyzer<'_> {\n             stmt.test.visit_with_ast_path(self, &mut ast_path);\n         }\n         let prev_effects = take(&mut self.effects);\n-        let prev_early_return_stack = take(&mut self.early_return_stack);\n         let then_returning;\n         let then = {\n             let mut ast_path =\n                 ast_path.with_guard(AstParentNodeRef::IfStmt(stmt, IfStmtField::Cons));\n-            stmt.cons.visit_with_ast_path(self, &mut ast_path);\n-            then_returning = self.end_early_return_block();\n+            then_returning = self\n+                .enter_control_flow(|this| {\n+                    stmt.cons.visit_with_ast_path(this, &mut ast_path);\n+                })\n+                .1;\n+\n             Box::new(EffectsBlock {\n                 effects: take(&mut self.effects),\n                 range: AstPathRange::Exact(as_parent_path(&ast_path)),\n@@ -2430,14 +2597,17 @@ impl VisitAstPath for Analyzer<'_> {\n         let r#else = stmt.alt.as_ref().map(|alt| {\n             let mut ast_path =\n                 ast_path.with_guard(AstParentNodeRef::IfStmt(stmt, IfStmtField::Alt));\n-            alt.visit_with_ast_path(self, &mut ast_path);\n-            else_returning = self.end_early_return_block();\n+            else_returning = self\n+                .enter_control_flow(|this| {\n+                    alt.visit_with_ast_path(this, &mut ast_path);\n+                })\n+                .1;\n+\n             Box::new(EffectsBlock {\n                 effects: take(&mut self.effects),\n                 range: AstPathRange::Exact(as_parent_path(&ast_path)),\n             })\n         });\n-        self.early_return_stack = prev_early_return_stack;\n         self.effects = prev_effects;\n         self.add_conditional_if_effect_with_early_return(\n             &stmt.test,\n@@ -2456,40 +2626,43 @@ impl VisitAstPath for Analyzer<'_> {\n         stmt: &'ast TryStmt,\n         ast_path: &mut swc_core::ecma::visit::AstNodePath<'r>,\n     ) {\n+        // TODO: if both try and catch return unconditionally, then so does the whole try statement\n         let prev_effects = take(&mut self.effects);\n-        let prev_early_return_stack = take(&mut self.early_return_stack);\n+\n         let mut block = {\n             let mut ast_path =\n                 ast_path.with_guard(AstParentNodeRef::TryStmt(stmt, TryStmtField::Block));\n-            stmt.block.visit_with_ast_path(self, &mut ast_path);\n-            self.end_early_return_block();\n+            self.enter_try(|this| {\n+                stmt.block.visit_with_ast_path(this, &mut ast_path);\n+            });\n+\n             take(&mut self.effects)\n         };\n         let mut handler = if let Some(handler) = stmt.handler.as_ref() {\n             let mut ast_path =\n                 ast_path.with_guard(AstParentNodeRef::TryStmt(stmt, TryStmtField::Handler));\n-            handler.visit_with_ast_path(self, &mut ast_path);\n-            self.end_early_return_block();\n+            self.enter_control_flow(|this| {\n+                handler.visit_with_ast_path(this, &mut ast_path);\n+            });\n             take(&mut self.effects)\n         } else {\n             vec![]\n         };\n-        self.early_return_stack = prev_early_return_stack;\n         self.effects = prev_effects;\n         self.effects.append(&mut block);\n         self.effects.append(&mut handler);\n         if let Some(finalizer) = stmt.finalizer.as_ref() {\n-            {\n+            let finally_returns_unconditionally = {\n                 let mut ast_path =\n                     ast_path.with_guard(AstParentNodeRef::TryStmt(stmt, TryStmtField::Finalizer));\n-                finalizer.visit_with_ast_path(self, &mut ast_path);\n-            }\n+                self.enter_control_flow(|this| {\n+                    finalizer.visit_with_ast_path(this, &mut ast_path);\n+                })\n+                .1\n+            };\n             // If a finally block early returns the parent block does too.\n-            if self.end_early_return_block() {\n-                self.early_return_stack.push(EarlyReturn::Always {\n-                    prev_effects: take(&mut self.effects),\n-                    start_ast_path: as_parent_path(ast_path),\n-                });\n+            if finally_returns_unconditionally {\n+                self.add_early_return_always(ast_path);\n             }\n         };\n     }\n@@ -2500,11 +2673,10 @@ impl VisitAstPath for Analyzer<'_> {\n         ast_path: &mut swc_core::ecma::visit::AstNodePath<'r>,\n     ) {\n         let prev_effects = take(&mut self.effects);\n-        let prev_early_return_stack = take(&mut self.early_return_stack);\n-        case.visit_children_with_ast_path(self, ast_path);\n-        self.end_early_return_block();\n+        self.enter_control_flow(|this| {\n+            case.visit_children_with_ast_path(this, ast_path);\n+        });\n         let mut effects = take(&mut self.effects);\n-        self.early_return_stack = prev_early_return_stack;\n         self.effects = prev_effects;\n         self.effects.append(&mut effects);\n     }\n@@ -2514,75 +2686,45 @@ impl VisitAstPath for Analyzer<'_> {\n         n: &'ast BlockStmt,\n         ast_path: &mut swc_core::ecma::visit::AstNodePath<'r>,\n     ) {\n-        enum ScopeType {\n-            Function,\n-            Block,\n-            ControlFlow,\n-        }\n-        let block_type = if ast_path.len() < 2 {\n-            ScopeType::Block\n-        } else if matches!(\n-            &ast_path[ast_path.len() - 2..],\n-            [\n-                AstParentNodeRef::IfStmt(_, IfStmtField::Cons),\n-                AstParentNodeRef::Stmt(_, StmtField::Block)\n-            ] | [\n-                AstParentNodeRef::IfStmt(_, IfStmtField::Alt),\n-                AstParentNodeRef::Stmt(_, StmtField::Block)\n-            ] | [_, AstParentNodeRef::TryStmt(_, TryStmtField::Block,)]\n-                | [\n-                    AstParentNodeRef::TryStmt(_, TryStmtField::Handler),\n-                    AstParentNodeRef::CatchClause(_, CatchClauseField::Body)\n-                ]\n-                | [\n-                    AstParentNodeRef::LabeledStmt(_, LabeledStmtField::Body),\n-                    AstParentNodeRef::Stmt(_, StmtField::Block)\n-                ]\n-        ) {\n-            ScopeType::ControlFlow\n-        } else if matches!(\n-            &ast_path[ast_path.len() - 2..],\n-            [_, AstParentNodeRef::Function(_, FunctionField::Body)]\n-                | [\n-                    AstParentNodeRef::ArrowExpr(_, ArrowExprField::Body),\n-                    AstParentNodeRef::BlockStmtOrExpr(_, BlockStmtOrExprField::BlockStmt)\n-                ]\n-                | [_, AstParentNodeRef::GetterProp(_, GetterPropField::Body)]\n-                | [_, AstParentNodeRef::SetterProp(_, SetterPropField::Body)]\n-                | [_, AstParentNodeRef::Constructor(_, ConstructorField::Body)]\n-        ) {\n-            ScopeType::Function\n-        } else {\n-            ScopeType::Block\n-        };\n-        match block_type {\n-            ScopeType::Function => {\n-                let early_return_stack = take(&mut self.early_return_stack);\n+        match self.cur_lexical_context() {\n+            LexicalContext::Function { .. } => {\n                 let mut effects = take(&mut self.effects);\n                 let hoisted_effects = take(&mut self.hoisted_effects);\n-                n.visit_children_with_ast_path(self, ast_path);\n-                if !self.end_early_return_block() {\n-                    // NOTE: this only occurs if the function has a return statement on one branch\n-                    // but not another. if there are no return statements,\n-                    // `end_early_return_block` will return false.\n+\n+                let (_, returns_unconditionally) =\n+                    self.enter_block(LexicalContext::Block, |this| {\n+                        n.visit_children_with_ast_path(this, ast_path);\n+                    });\n+                // By handling this logic here instead of in enter_fn, we naturally skip it\n+                // for arrow functions with single expression bodies, since they just don't hit this\n+                // path.\n+                if !returns_unconditionally {\n                     self.add_return_value(JsValue::Constant(ConstantValue::Undefined));\n                 }\n                 self.effects.append(&mut self.hoisted_effects);\n                 effects.append(&mut self.effects);\n                 self.hoisted_effects = hoisted_effects;\n                 self.effects = effects;\n-                self.early_return_stack = early_return_stack;\n             }\n-            ScopeType::Block => {\n-                n.visit_children_with_ast_path(self, ast_path);\n-                if self.end_early_return_block() {\n-                    self.early_return_stack.push(EarlyReturn::Always {\n-                        prev_effects: take(&mut self.effects),\n-                        start_ast_path: as_parent_path(ast_path),\n-                    });\n+            LexicalContext::ControlFlow { .. } => {\n+                self.with_block(LexicalContext::Block, |this| {\n+                    n.visit_children_with_ast_path(this, ast_path)\n+                });\n+            }\n+            LexicalContext::Block => {\n+                // Handle anonymous block statement\n+                // e.g., enter a new control flow context and because it is 'unconditiona' we\n+                // need to propagate early returns\n+                let (_, returns_early) = self.enter_control_flow(|this| {\n+                    n.visit_children_with_ast_path(this, ast_path);\n+                });\n+                if returns_early {\n+                    self.add_early_return_always(ast_path);\n                 }\n             }\n-            ScopeType::ControlFlow => {\n+            LexicalContext::ClassBody => {\n+                // this would be something like a `static` initialization block\n+                // there is no early return logic required here so just visit children\n                 n.visit_children_with_ast_path(self, ast_path);\n             }\n         }\n@@ -2612,11 +2754,9 @@ impl VisitAstPath for Analyzer<'_> {\n         ast_path: &mut AstNodePath<AstParentNodeRef<'r>>,\n     ) {\n         let mut prev_effects = take(&mut self.effects);\n-        let prev_early_return_stack = take(&mut self.early_return_stack);\n-\n-        stmt.visit_children_with_ast_path(self, ast_path);\n-\n-        self.end_early_return_block();\n+        self.enter_control_flow(|this| {\n+            stmt.visit_children_with_ast_path(this, ast_path);\n+        });\n \n         let effects = take(&mut self.effects);\n \n@@ -2636,27 +2776,9 @@ impl VisitAstPath for Analyzer<'_> {\n         });\n \n         self.effects = prev_effects;\n-        self.early_return_stack = prev_early_return_stack;\n     }\n }\n \n-fn is_lexically_block_scope(ast_path: &mut AstNodePath<AstParentNodeRef>) -> bool {\n-    let mut iter = ast_path.iter().rev().peekable();\n-\n-    while let Some(cur) = iter.next() {\n-        // If it's a block statement, we need to check if it's Function#body\n-        if matches!(cur.kind(), AstParentKind::BlockStmt(..)) {\n-            if let Some(next) = iter.peek() {\n-                return !matches!(next.kind(), AstParentKind::Function(FunctionField::Body));\n-            }\n-            return false;\n-        }\n-    }\n-\n-    // This `var` is not in a block scope\n-    false\n-}\n-\n impl Analyzer<'_> {\n     fn add_conditional_if_effect_with_early_return(\n         &mut self,\n@@ -2686,7 +2808,7 @@ impl Analyzer<'_> {\n         let condition = Box::new(condition);\n         match (early_return_when_true, early_return_when_false) {\n             (true, false) => {\n-                self.early_return_stack.push(EarlyReturn::Conditional {\n+                let early_return = EarlyReturn::Conditional {\n                     prev_effects: take(&mut self.effects),\n                     start_ast_path: as_parent_path(ast_path),\n                     condition,\n@@ -2695,10 +2817,11 @@ impl Analyzer<'_> {\n                     condition_ast_path: as_parent_path_with(ast_path, condition_ast_kind),\n                     span,\n                     early_return_condition_value: true,\n-                });\n+                };\n+                self.early_return_stack_mut().push(early_return);\n             }\n             (false, true) => {\n-                self.early_return_stack.push(EarlyReturn::Conditional {\n+                let early_return = EarlyReturn::Conditional {\n                     prev_effects: take(&mut self.effects),\n                     start_ast_path: as_parent_path(ast_path),\n                     condition,\n@@ -2707,7 +2830,8 @@ impl Analyzer<'_> {\n                     condition_ast_path: as_parent_path_with(ast_path, condition_ast_kind),\n                     span,\n                     early_return_condition_value: false,\n-                });\n+                };\n+                self.early_return_stack_mut().push(early_return);\n             }\n             (false, false) | (true, true) => {\n                 let kind = match (then, r#else) {\n@@ -2727,10 +2851,11 @@ impl Analyzer<'_> {\n                     });\n                 }\n                 if early_return_when_false && early_return_when_true {\n-                    self.early_return_stack.push(EarlyReturn::Always {\n+                    let early_return = EarlyReturn::Always {\n                         prev_effects: take(&mut self.effects),\n                         start_ast_path: as_parent_path(ast_path),\n-                    });\n+                    };\n+                    self.early_return_stack_mut().push(early_return);\n                 }\n             }\n         }"
        },
        {
            "sha": "ce45b23a67c0729284ccbb2321c12f0acbe1843a",
            "filename": "turbopack/crates/turbopack-ecmascript/src/path_visitor.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fpath_visitor.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fpath_visitor.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fpath_visitor.rs?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -113,7 +113,7 @@ impl<'a> ApplyVisitors<'a, '_> {\n                     }\n                     return;\n                 } else {\n-                    // `current_visitors` has the invariant that is must not be empty.\n+                    // `current_visitors` has the invariant that it must not be empty.\n                     // When it becomes empty, we must early exit\n                     current_visitors = &visitors[nested_visitors_start..];\n                     if current_visitors.is_empty() {"
        },
        {
            "sha": "e4fc3cf6fdaa0d1cf8554a38df988273e146428f",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/react-dom-production/graph-explained.snapshot",
            "status": "modified",
            "additions": 19,
            "deletions": 14,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fgraph-explained.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fgraph-explained.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fgraph-explained.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -2843,7 +2843,7 @@ b#494 = di()\n \n b#5 = arguments[1]\n \n-b#50 = (a[\"render\"] | (a[\"displayName\"] || null) | a[\"_payload\"])\n+b#50 = (a[\"render\"] | undefined | (a[\"displayName\"] || null) | a[\"_payload\"])\n \n b#501 = di()\n \n@@ -3230,7 +3230,7 @@ b#979 = arguments[1]\n \n b#986 = arguments[1]\n \n-b#990 = a[\"stateNode\"]\n+b#990 = (a[\"stateNode\"] | undefined)\n \n b#992 = Zg(a, 1)\n \n@@ -3454,6 +3454,7 @@ c#361 = Bg(5, null, null, 0)\n \n c#362 = (\n   | a[\"type\"]\n+  | undefined\n   | ((null !== qg) ? {\"id\": rg, \"overflow\": sg} : null)\n   | Bg(18, null, null, 0)\n )\n@@ -3687,7 +3688,7 @@ c#64 = b[\"getValue\"]()\n \n c#644 = arguments[2]\n \n-c#645 = (null | b | a[\"tail\"] | c[\"sibling\"])\n+c#645 = (null | undefined | b | a[\"tail\"] | c[\"sibling\"])\n \n c#646 = (0 | ???*0*)\n - *0* unsupported assign operation\n@@ -4228,7 +4229,7 @@ d#621 = (b[\"pendingProps\"] | M[\"current\"] | ???*0* | ???*1*)\n - *1* unsupported assign operation\n     This value might have side effects\n \n-d#631 = (b[\"type\"][\"_context\"] | b[\"memoizedState\"] | (0 !== ???*0*))\n+d#631 = (b[\"type\"][\"_context\"] | undefined | b[\"memoizedState\"] | (0 !== ???*0*))\n - *0* unsupported expression\n     This value might have side effects\n \n@@ -4241,7 +4242,7 @@ d#64 = (\n \n d#644 = arguments[3]\n \n-d#645 = (null | c)\n+d#645 = (null | undefined | c)\n \n d#646 = (0 | ???*0*)\n - *0* unsupported assign operation\n@@ -4287,13 +4288,13 @@ d#703 = a[\"tag\"]\n \n d#704 = a[\"tag\"]\n \n-d#706 = (X | c[\"updateQueue\"] | d[\"lastEffect\"] | d[\"next\"] | c[\"stateNode\"] | U)\n+d#706 = (X | undefined | c[\"updateQueue\"] | d[\"lastEffect\"] | d[\"next\"] | c[\"stateNode\"] | U)\n \n d#71 = b[\"type\"]\n \n d#715 = ck[\"bind\"](null, a, b)\n \n-d#716 = (0 | ???*0*)\n+d#716 = (0 | undefined | ???*0*)\n - *0* updated with update expression\n     This value might have side effects\n \n@@ -4357,10 +4358,11 @@ d#910 = (b[\"stateNode\"] | undefined)\n \n d#915 = a[\"pingCache\"]\n \n-d#918 = a[\"stateNode\"]\n+d#918 = (a[\"stateNode\"] | undefined)\n \n d#919 = (\n   | b[\"type\"]\n+  | undefined\n   | b[\"elementType\"]\n   | e(d[\"_payload\"])\n   | b[\"pendingProps\"]\n@@ -4491,7 +4493,7 @@ e#266 = (c[\"textContent\"][\"length\"] | undefined | d | Ke(c, f))\n \n e#275 = (d[\"event\"] | undefined)\n \n-e#285 = (ed | gd | fd | undefined | !(0))\n+e#285 = (ed | undefined | gd | fd | !(0))\n \n e#286 = arguments[4]\n \n@@ -4619,14 +4621,15 @@ e#620 = arguments[4]\n \n e#621 = (d[\"revealOrder\"] | null | c | b[\"child\"] | c[\"sibling\"] | a)\n \n-e#631 = (b[\"memoizedProps\"][\"value\"] | b[\"memoizedState\"])\n+e#631 = (b[\"memoizedProps\"][\"value\"] | undefined | b[\"memoizedState\"])\n \n e#639 = (a[\"memoizedProps\"] | Ya(a, e) | A({}, e, {\"value\": undefined}) | gb(a, e))\n \n-e#646 = (a[\"child\"] | e[\"sibling\"])\n+e#646 = (a[\"child\"] | undefined | e[\"sibling\"])\n \n e#647 = (\n   | Hh(Gh[\"current\"])\n+  | undefined\n   | 0\n   | ???*0*\n   | null\n@@ -4644,7 +4647,7 @@ e#673 = (d[\"anchorOffset\"] | undefined)\n \n e#687 = (d[\"next\"] | undefined | e[\"next\"])\n \n-e#706 = (Yj | d[\"next\"] | e[\"next\"])\n+e#706 = (Yj | undefined | d[\"next\"] | e[\"next\"])\n \n e#716 = (c[d] | undefined)\n \n@@ -4687,10 +4690,11 @@ e#883 = (K | undefined)\n \n e#9 = arguments[4]\n \n-e#918 = a[\"memoizedState\"]\n+e#918 = (a[\"memoizedState\"] | undefined)\n \n e#919 = (\n   | Yf(b, H[\"current\"])\n+  | undefined\n   | Xh(null, b, d, a, e, c)\n   | d[\"_init\"]\n   | $k(d)\n@@ -4776,7 +4780,7 @@ f#169 = (???*0* | undefined)\n \n f#175 = arguments[5]\n \n-f#176 = e[\"pointerId\"]\n+f#176 = (e[\"pointerId\"] | undefined)\n \n f#193 = cd[\"transition\"]\n \n@@ -4959,6 +4963,7 @@ f#9 = arguments[5]\n \n f#919 = (\n   | bi()\n+  | undefined\n   | !(0)\n   | !(1)\n   | b[\"memoizedState\"]"
        },
        {
            "sha": "860b3b8677cdcaeb32ff40b4dea78705ec878492",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/react-dom-production/resolved-effects.snapshot",
            "status": "modified",
            "additions": 175,
            "deletions": 72,
            "changes": 247,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fresolved-effects.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -1,4 +1,7 @@\n-0 -> 6 conditional = ???*0*\n+0 -> 6 conditional = (\n+  | ???*0*\n+  | undefined[\"current\"][\"memoizedState\"][\"isDehydrated\"]\n+)\n - *0* ???*1*[\"isDehydrated\"]\n     unknown object\n - *1* ???*2*[\"memoizedState\"]\n@@ -10,7 +13,7 @@\n - *4* arguments[0]\n     function calls are not analyzed yet\n \n-6 -> 8 call = (...) => (1 | 2 | 4 | 8 | 16 | 32 | ???*0* | 134217728 | 268435456 | 536870912 | 1073741824 | a | undefined)(???*1*)\n+6 -> 8 call = (...) => (1 | 2 | 4 | 8 | 16 | 32 | ???*0* | 134217728 | 268435456 | 536870912 | 1073741824 | a | undefined)((???*1* | undefined[\"pendingLanes\"]))\n - *0* unsupported expression\n     This value might have side effects\n - *1* ???*2*[\"pendingLanes\"]\n@@ -33,6 +36,7 @@\n   | 536870912\n   | 1073741824\n   | ???*1*\n+  | undefined[\"pendingLanes\"]\n   | undefined\n ))\n - *0* unsupported expression\n@@ -44,7 +48,7 @@\n - *3* arguments[0]\n     function calls are not analyzed yet\n \n-9 -> 10 call = (...) => undefined(???*0*, ???*2*)\n+9 -> 10 call = (...) => undefined((???*0* | undefined), ???*2*)\n - *0* ???*1*[\"stateNode\"]\n     unknown object\n - *1* arguments[0]\n@@ -54,7 +58,7 @@\n \n 9 -> 11 call = module<scheduler, {}>[\"unstable_now\"]()\n \n-9 -> 12 call = (...) => undefined(???*0*, module<scheduler, {}>[\"unstable_now\"]())\n+9 -> 12 call = (...) => undefined((???*0* | undefined), module<scheduler, {}>[\"unstable_now\"]())\n - *0* ???*1*[\"stateNode\"]\n     unknown object\n - *1* arguments[0]\n@@ -4188,7 +4192,7 @@ ${(???*0* | ???*7*)}`\n \n 552 -> 620 free var = FreeVar(Error)\n \n-0 -> 621 conditional = (???*0* | (???*1* ? ???*2* : \"\"))\n+552 -> 621 conditional = (???*0* | (???*1* ? ???*2* : \"\"))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* a\n@@ -4210,7 +4214,7 @@ ${(???*0* | ???*7*)}`\n - *4* a\n     circular variable reference\n \n-0 -> 625 conditional = ((???*0* | ???*1*) ? ???*5* : \"\")\n+552 -> 625 conditional = ((???*0* | ???*1*) ? ???*5* : \"\")\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* (???*2* ? ???*3* : \"\")\n@@ -4237,7 +4241,7 @@ ${La}${a}`((???*0* | (???*1* ? ???*2* : \"\")))\n - *3* a\n     circular variable reference\n \n-0 -> 627 unreachable = ???*0*\n+552 -> 627 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n@@ -4326,7 +4330,16 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 649 conditional = (null == (???*0* | ???*1* | null[\"displayName\"] | null[\"name\"] | \"\" | ???*3*))\n+0 -> 649 conditional = (null == (\n+  | ???*0*\n+  | ???*1*\n+  | undefined[\"displayName\"]\n+  | null[\"displayName\"]\n+  | undefined[\"name\"]\n+  | null[\"name\"]\n+  | \"\"\n+  | ???*3*\n+))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* ???*2*[\"displayName\"]\n@@ -4348,7 +4361,16 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-649 -> 651 typeof = typeof((???*0* | ???*1* | null[\"displayName\"] | null[\"name\"] | \"\" | (???*3* ? ???*5* : \"ForwardRef\")))\n+649 -> 651 typeof = typeof((\n+  | ???*0*\n+  | ???*1*\n+  | undefined[\"displayName\"]\n+  | null[\"displayName\"]\n+  | undefined[\"name\"]\n+  | null[\"name\"]\n+  | \"\"\n+  | (???*3* ? ???*5* : \"ForwardRef\")\n+))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* ???*2*[\"displayName\"]\n@@ -4365,7 +4387,16 @@ ${La}${a}`(\"SuspenseList\")\n     circular variable reference\n \n 649 -> 652 conditional = (\"function\" === ???*0*)\n-- *0* typeof((???*1* | ???*2* | null[\"displayName\"] | null[\"name\"] | \"\" | ???*4*))\n+- *0* typeof((\n+      | ???*1*\n+      | ???*2*\n+      | undefined[\"displayName\"]\n+      | null[\"displayName\"]\n+      | undefined[\"name\"]\n+      | null[\"name\"]\n+      | \"\"\n+      | ???*4*\n+    ))\n     nested operation\n - *1* arguments[0]\n     function calls are not analyzed yet\n@@ -4386,7 +4417,9 @@ ${La}${a}`(\"SuspenseList\")\n \n 652 -> 654 conditional = (\n   | ???*0*\n+  | undefined[\"displayName\"][\"displayName\"]\n   | null[\"displayName\"][\"displayName\"]\n+  | undefined[\"name\"][\"displayName\"]\n   | null[\"name\"][\"displayName\"]\n   | \"\"[\"displayName\"]\n   | (???*2* ? ???*4* : \"ForwardRef\")[\"displayName\"]\n@@ -4408,7 +4441,16 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-652 -> 657 typeof = typeof((???*0* | ???*1* | null[\"displayName\"] | null[\"name\"] | \"\" | (???*3* ? ???*5* : \"ForwardRef\")))\n+652 -> 657 typeof = typeof((\n+  | ???*0*\n+  | ???*1*\n+  | undefined[\"displayName\"]\n+  | null[\"displayName\"]\n+  | undefined[\"name\"]\n+  | null[\"name\"]\n+  | \"\"\n+  | (???*3* ? ???*5* : \"ForwardRef\")\n+))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* ???*2*[\"displayName\"]\n@@ -4425,7 +4467,16 @@ ${La}${a}`(\"SuspenseList\")\n     circular variable reference\n \n 652 -> 658 conditional = (\"string\" === ???*0*)\n-- *0* typeof((???*1* | ???*2* | null[\"displayName\"] | null[\"name\"] | \"\" | ???*4*))\n+- *0* typeof((\n+      | ???*1*\n+      | ???*2*\n+      | undefined[\"displayName\"]\n+      | null[\"displayName\"]\n+      | undefined[\"name\"]\n+      | null[\"name\"]\n+      | \"\"\n+      | ???*4*\n+    ))\n     nested operation\n - *1* arguments[0]\n     function calls are not analyzed yet\n@@ -4472,7 +4523,16 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-658 -> 666 typeof = typeof((???*0* | ???*1* | null[\"displayName\"] | null[\"name\"] | \"\" | (???*3* ? ???*5* : \"ForwardRef\")))\n+658 -> 666 typeof = typeof((\n+  | ???*0*\n+  | ???*1*\n+  | undefined[\"displayName\"]\n+  | null[\"displayName\"]\n+  | undefined[\"name\"]\n+  | null[\"name\"]\n+  | \"\"\n+  | (???*3* ? ???*5* : \"ForwardRef\")\n+))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* ???*2*[\"displayName\"]\n@@ -4489,7 +4549,16 @@ ${La}${a}`(\"SuspenseList\")\n     circular variable reference\n \n 658 -> 667 conditional = (\"object\" === ???*0*)\n-- *0* typeof((???*1* | ???*2* | null[\"displayName\"] | null[\"name\"] | \"\" | ???*4*))\n+- *0* typeof((\n+      | ???*1*\n+      | ???*2*\n+      | undefined[\"displayName\"]\n+      | null[\"displayName\"]\n+      | undefined[\"name\"]\n+      | null[\"name\"]\n+      | \"\"\n+      | ???*4*\n+    ))\n     nested operation\n - *1* arguments[0]\n     function calls are not analyzed yet\n@@ -4516,7 +4585,16 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-667 -> 676 conditional = (???*0* | ???*1* | null[\"displayName\"] | null[\"name\"] | \"\" | (???*3* ? ???*5* : \"ForwardRef\"))\n+667 -> 676 conditional = (\n+  | ???*0*\n+  | ???*1*\n+  | undefined[\"displayName\"]\n+  | null[\"displayName\"]\n+  | undefined[\"name\"]\n+  | null[\"name\"]\n+  | \"\"\n+  | (???*3* ? ???*5* : \"ForwardRef\")\n+)\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* ???*2*[\"displayName\"]\n@@ -4536,6 +4614,7 @@ ${La}${a}`(\"SuspenseList\")\n   | ???*0*\n   | \"\"[\"render\"][\"displayName\"]\n   | (???*3* ? ???*5* : \"ForwardRef\")[\"render\"][\"displayName\"]\n+  | undefined[\"displayName\"]\n   | \"\"[\"displayName\"][\"displayName\"]\n   | (???*7* ? ???*9* : \"ForwardRef\")[\"displayName\"][\"displayName\"]\n   | null[\"displayName\"]\n@@ -4577,7 +4656,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-667 -> 682 conditional = (null !== (???*0* | \"\"[\"render\"] | \"\"[\"displayName\"] | null | \"\"[\"_payload\"]))\n+667 -> 682 conditional = (null !== (???*0* | \"\"[\"render\"] | undefined | \"\"[\"displayName\"] | null | \"\"[\"_payload\"]))\n - *0* ???*1*[\"render\"]\n     unknown object\n - *1* arguments[0]\n@@ -4600,7 +4679,9 @@ ${La}${a}`(\"SuspenseList\")\n )(\n     (\n       | ???*0*\n+      | undefined[\"displayName\"][\"type\"]\n       | null[\"displayName\"][\"type\"]\n+      | undefined[\"name\"][\"type\"]\n       | null[\"name\"][\"type\"]\n       | \"\"[\"type\"]\n       | (???*2* ? ???*4* : \"ForwardRef\")[\"type\"]\n@@ -4623,11 +4704,21 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-667 -> 688 call = (???*0* | ???*1* | null[\"displayName\"] | null[\"name\"] | \"\" | (???*3* ? ???*5* : \"ForwardRef\"))(\n+667 -> 688 call = (\n+  | ???*0*\n+  | ???*1*\n+  | undefined[\"displayName\"]\n+  | null[\"displayName\"]\n+  | undefined[\"name\"]\n+  | null[\"name\"]\n+  | \"\"\n+  | (???*3* ? ???*5* : \"ForwardRef\")\n+)(\n     (\n       | ???*7*\n       | \"\"[\"render\"]\n       | (???*9* ? ???*11* : \"ForwardRef\")[\"render\"]\n+      | undefined\n       | \"\"[\"displayName\"]\n       | (???*13* ? ???*15* : \"ForwardRef\")[\"displayName\"]\n       | null\n@@ -4693,7 +4784,16 @@ ${La}${a}`(\"SuspenseList\")\n   | ((null !== b) ? b : (Qa(a[\"type\"]) || \"Memo\"))\n   | Qa(a(b))\n )(???*0*)\n-- *0* (???*1* | ???*2* | null[\"displayName\"] | null[\"name\"] | \"\" | (???*4* ? ???*6* : \"ForwardRef\"))(b)\n+- *0* (\n+      | ???*1*\n+      | ???*2*\n+      | undefined[\"displayName\"]\n+      | null[\"displayName\"]\n+      | undefined[\"name\"]\n+      | null[\"name\"]\n+      | \"\"\n+      | (???*4* ? ???*6* : \"ForwardRef\")\n+    )(b)\n     non-function callee\n - *1* arguments[0]\n     function calls are not analyzed yet\n@@ -10000,7 +10100,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 1475 member call = new ???*0*()[\"get\"](???*1*)\n+0 -> 1475 member call = new ???*0*()[\"get\"]((???*1* | undefined))\n - *0* FreeVar(Map)\n     unknown global\n     This value might have side effects\n@@ -10013,7 +10113,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* a\n     sequence with side effects\n     This value might have side effects\n-- *1* ???*2*(???*5*)\n+- *1* ???*2*((???*5* | undefined))\n     unknown callee\n - *2* ???*3*[\"get\"]\n     unknown object\n@@ -10038,7 +10138,7 @@ ${La}${a}`(\"SuspenseList\")\n     function calls are not analyzed yet\n \n 0 -> 1477 member call = new ???*0*()[\"set\"](\n-    ???*1*,\n+    (???*1* | undefined),\n     (\n       | ???*3*\n       | ???*4*\n@@ -10062,7 +10162,7 @@ ${La}${a}`(\"SuspenseList\")\n - *3* a\n     sequence with side effects\n     This value might have side effects\n-- *4* ???*5*(???*8*)\n+- *4* ???*5*((???*8* | undefined))\n     unknown callee\n - *5* ???*6*[\"get\"]\n     unknown object\n@@ -10108,7 +10208,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 1482 member call = new ???*0*()[\"get\"](???*1*)\n+0 -> 1482 member call = new ???*0*()[\"get\"]((???*1* | undefined))\n - *0* FreeVar(Map)\n     unknown global\n     This value might have side effects\n@@ -10121,7 +10221,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* a\n     sequence with side effects\n     This value might have side effects\n-- *1* ???*2*(???*5*)\n+- *1* ???*2*((???*5* | undefined))\n     unknown callee\n - *2* ???*3*[\"get\"]\n     unknown object\n@@ -10146,7 +10246,7 @@ ${La}${a}`(\"SuspenseList\")\n     function calls are not analyzed yet\n \n 0 -> 1484 member call = new ???*0*()[\"set\"](\n-    ???*1*,\n+    (???*1* | undefined),\n     (\n       | ???*3*\n       | ???*4*\n@@ -10170,7 +10270,7 @@ ${La}${a}`(\"SuspenseList\")\n - *3* a\n     sequence with side effects\n     This value might have side effects\n-- *4* ???*5*(???*8*)\n+- *4* ???*5*((???*8* | undefined))\n     unknown callee\n - *5* ???*6*[\"get\"]\n     unknown object\n@@ -19696,7 +19796,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-2604 -> 2606 conditional = (???*0* | ???*1*)\n+2604 -> 2607 conditional = (???*0* | ???*1*)\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* ???*2*[\"return\"]\n@@ -20461,19 +20561,19 @@ ${La}${a}`(\"SuspenseList\")\n - *0* arguments[1]\n     function calls are not analyzed yet\n \n-0 -> 2702 conditional = (8 === (???*0* | undefined))\n+0 -> 2701 conditional = (8 === (???*0* | undefined))\n - *0* ???*1*[\"nodeType\"]\n     unknown object\n - *1* arguments[0]\n     function calls are not analyzed yet\n \n-2702 -> 2704 conditional = (\"/$\" === (???*0* | undefined))\n+2701 -> 2703 conditional = (\"/$\" === (???*0* | undefined))\n - *0* ???*1*[\"nodeType\"]\n     unknown object\n - *1* arguments[0]\n     function calls are not analyzed yet\n \n-2704 -> 2705 unreachable = ???*0*\n+2703 -> 2704 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n@@ -29695,11 +29795,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* max number of linking steps reached\n     This value might have side effects\n \n-0 -> 3780 member call = ???*0*[\"next\"]()\n-- *0* max number of linking steps reached\n-    This value might have side effects\n-\n-0 -> 3784 call = (...) => (\n+0 -> 3782 call = (...) => (\n   | ((null !== e) ? null : h(a, b, `${c}`, d))\n   | ((c[\"key\"] === e) ? k(a, b, c, d) : null)\n   | ((c[\"key\"] === e) ? l(a, b, c, d) : null)\n@@ -29719,13 +29815,13 @@ ${La}${a}`(\"SuspenseList\")\n - *4* arguments[3]\n     function calls are not analyzed yet\n \n-0 -> 3785 conditional = (???*0* | ???*1*)\n+0 -> 3783 conditional = (???*0* | ???*1*)\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* max number of linking steps reached\n     This value might have side effects\n \n-0 -> 3787 conditional = (???*0* | ???*1* | (null === ???*2*))\n+0 -> 3785 conditional = (???*0* | ???*1* | (null === ???*2*))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* max number of linking steps reached\n@@ -29736,13 +29832,13 @@ ${La}${a}`(\"SuspenseList\")\n - *3* max number of linking steps reached\n     This value might have side effects\n \n-3787 -> 3788 call = (...) => undefined(???*0*, ???*1*)\n+3785 -> 3786 call = (...) => undefined(???*0*, ???*1*)\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* max number of linking steps reached\n     This value might have side effects\n \n-0 -> 3789 call = (...) => (???*0* | (???*1* ? ???*2* : d) | c)(???*3*, ???*4*, (0 | ???*5*))\n+0 -> 3787 call = (...) => (???*0* | (???*1* ? ???*2* : d) | c)(???*3*, ???*4*, (0 | ???*5*))\n - *0* c\n     sequence with side effects\n     This value might have side effects\n@@ -29758,7 +29854,11 @@ ${La}${a}`(\"SuspenseList\")\n - *5* updated with update expression\n     This value might have side effects\n \n-0 -> 3790 conditional = (null === ???*0*)\n+0 -> 3788 conditional = (null === ???*0*)\n+- *0* max number of linking steps reached\n+    This value might have side effects\n+\n+0 -> 3791 member call = ???*0*[\"next\"]()\n - *0* max number of linking steps reached\n     This value might have side effects\n \n@@ -29791,11 +29891,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* max number of linking steps reached\n     This value might have side effects\n \n-3798 -> 3801 member call = ???*0*[\"next\"]()\n-- *0* max number of linking steps reached\n-    This value might have side effects\n-\n-3798 -> 3803 call = (...) => (???*0* | q(a, d(b[\"_payload\"]), c) | null)(???*1*, ???*2*, ???*4*)\n+3798 -> 3801 call = (...) => (???*0* | q(a, d(b[\"_payload\"]), c) | null)(???*1*, ???*2*, ???*4*)\n - *0* b\n     sequence with side effects\n     This value might have side effects\n@@ -29809,11 +29905,11 @@ ${La}${a}`(\"SuspenseList\")\n - *4* arguments[3]\n     function calls are not analyzed yet\n \n-3798 -> 3804 conditional = (null !== ???*0*)\n+3798 -> 3802 conditional = (null !== ???*0*)\n - *0* max number of linking steps reached\n     This value might have side effects\n \n-3804 -> 3805 call = (...) => (???*0* | (???*1* ? ???*2* : d) | c)(???*3*, ???*4*, (0 | ???*5*))\n+3802 -> 3803 call = (...) => (???*0* | (???*1* ? ???*2* : d) | c)(???*3*, ???*4*, (0 | ???*5*))\n - *0* c\n     sequence with side effects\n     This value might have side effects\n@@ -29829,7 +29925,11 @@ ${La}${a}`(\"SuspenseList\")\n - *5* updated with update expression\n     This value might have side effects\n \n-3804 -> 3806 conditional = (null === ???*0*)\n+3802 -> 3804 conditional = (null === ???*0*)\n+- *0* max number of linking steps reached\n+    This value might have side effects\n+\n+3798 -> 3807 member call = ???*0*[\"next\"]()\n - *0* max number of linking steps reached\n     This value might have side effects\n \n@@ -29851,11 +29951,7 @@ ${La}${a}`(\"SuspenseList\")\n - *1* max number of linking steps reached\n     This value might have side effects\n \n-3798 -> 3814 member call = ???*0*[\"next\"]()\n-- *0* max number of linking steps reached\n-    This value might have side effects\n-\n-3798 -> 3816 call = (...) => (???*0* | y(a, b, c, f(d[\"_payload\"]), e) | null)(???*1*, ???*2*, (0 | ???*3*), ???*4*, ???*6*)\n+3798 -> 3814 call = (...) => (???*0* | y(a, b, c, f(d[\"_payload\"]), e) | null)(???*1*, ???*2*, (0 | ???*3*), ???*4*, ???*6*)\n - *0* h(b, a, (\"\" + d), e)\n     sequence with side effects\n     This value might have side effects\n@@ -29873,15 +29969,15 @@ ${La}${a}`(\"SuspenseList\")\n - *6* arguments[3]\n     function calls are not analyzed yet\n \n-3798 -> 3817 conditional = (null !== ???*0*)\n+3798 -> 3815 conditional = (null !== ???*0*)\n - *0* max number of linking steps reached\n     This value might have side effects\n \n-3817 -> 3818 conditional = ???*0*\n+3815 -> 3816 conditional = ???*0*\n - *0* arguments[0]\n     function calls are not analyzed yet\n \n-3817 -> 3820 conditional = (???*0* | (null !== ???*1*))\n+3815 -> 3818 conditional = (???*0* | (null !== ???*1*))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* ???*2*[\"alternate\"]\n@@ -29890,14 +29986,14 @@ ${La}${a}`(\"SuspenseList\")\n - *2* max number of linking steps reached\n     This value might have side effects\n \n-3820 -> 3823 conditional = (null === ???*0*)\n+3818 -> 3821 conditional = (null === ???*0*)\n - *0* ???*1*[\"key\"]\n     unknown object\n     This value might have side effects\n - *1* max number of linking steps reached\n     This value might have side effects\n \n-3820 -> 3825 member call = ???*0*[\"delete\"]((???*1* ? (0 | ???*4*) : ???*5*))\n+3818 -> 3823 member call = ???*0*[\"delete\"]((???*1* ? (0 | ???*4*) : ???*5*))\n - *0* max number of linking steps reached\n     This value might have side effects\n - *1* (null === ???*2*)\n@@ -29915,7 +30011,7 @@ ${La}${a}`(\"SuspenseList\")\n - *6* max number of linking steps reached\n     This value might have side effects\n \n-3817 -> 3826 call = (...) => (???*0* | (???*1* ? ???*2* : d) | c)(???*3*, ???*4*, (0 | ???*5*))\n+3815 -> 3824 call = (...) => (???*0* | (???*1* ? ???*2* : d) | c)(???*3*, ???*4*, (0 | ???*5*))\n - *0* c\n     sequence with side effects\n     This value might have side effects\n@@ -29931,7 +30027,11 @@ ${La}${a}`(\"SuspenseList\")\n - *5* updated with update expression\n     This value might have side effects\n \n-3817 -> 3827 conditional = (null === ???*0*)\n+3815 -> 3825 conditional = (null === ???*0*)\n+- *0* max number of linking steps reached\n+    This value might have side effects\n+\n+3798 -> 3828 member call = ???*0*[\"next\"]()\n - *0* max number of linking steps reached\n     This value might have side effects\n \n@@ -43666,7 +43766,10 @@ ${La}${a}`(\"SuspenseList\")\n - *3* arguments[1]\n     function calls are not analyzed yet\n \n-0 -> 5351 call = (...) => undefined({\"current\": null}, (???*0* | (0 !== ???*4*)[\"_currentValue\"]))\n+0 -> 5351 call = (...) => undefined(\n+    {\"current\": null},\n+    (???*0* | undefined[\"_currentValue\"] | (0 !== ???*4*)[\"_currentValue\"])\n+)\n - *0* ???*1*[\"_currentValue\"]\n     unknown object\n - *1* ???*2*[\"_context\"]\n@@ -43678,7 +43781,7 @@ ${La}${a}`(\"SuspenseList\")\n - *4* unsupported expression\n     This value might have side effects\n \n-0 -> 5354 conditional = (null !== (???*0* | ???*3*))\n+0 -> 5354 conditional = (null !== (???*0* | undefined | ???*3*))\n - *0* ???*1*[\"_context\"]\n     unknown object\n - *1* ???*2*[\"type\"]\n@@ -43690,7 +43793,7 @@ ${La}${a}`(\"SuspenseList\")\n - *4* unsupported expression\n     This value might have side effects\n \n-5354 -> 5356 conditional = (null !== ???*0*)\n+5354 -> 5356 conditional = (null !== (???*0* | undefined[\"dehydrated\"]))\n - *0* ???*1*[\"dehydrated\"]\n     unknown object\n - *1* ???*2*[\"_context\"]\n@@ -43770,7 +43873,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unsupported expression\n     This value might have side effects\n \n-5376 -> 5377 conditional = (???*0* | (0 !== ???*3*))\n+5376 -> 5377 conditional = (???*0* | undefined | (0 !== ???*3*))\n - *0* ???*1*[\"_context\"]\n     unknown object\n - *1* ???*2*[\"type\"]\n@@ -43796,7 +43899,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 5382 conditional = (null !== ???*0*)\n+0 -> 5382 conditional = (null !== (???*0* | undefined))\n - *0* ???*1*[\"value\"]\n     unknown object\n - *1* ???*2*[\"memoizedProps\"]\n@@ -43808,7 +43911,7 @@ ${La}${a}`(\"SuspenseList\")\n - *0* unknown mutation\n     This value might have side effects\n \n-0 -> 5388 conditional = (???*0* | (0 !== ???*3*))\n+0 -> 5388 conditional = (???*0* | undefined | (0 !== ???*3*))\n - *0* ???*1*[\"_context\"]\n     unknown object\n - *1* ???*2*[\"type\"]\n@@ -47866,15 +47969,15 @@ ${La}${a}`(\"SuspenseList\")\n \n 0 -> 5518 conditional = !((false | true))\n \n-5518 -> 5523 conditional = (null === (null | ???*0* | ???*1*))\n+5518 -> 5523 conditional = (null === (null | undefined | ???*0* | ???*1*))\n - *0* arguments[1]\n     function calls are not analyzed yet\n - *1* ???*2*[\"tail\"]\n     unknown object\n - *2* arguments[0]\n     function calls are not analyzed yet\n \n-5518 -> 5529 conditional = (null === (null | ???*0* | ???*1*))\n+5518 -> 5529 conditional = (null === (null | undefined | ???*0* | ???*1*))\n - *0* arguments[1]\n     function calls are not analyzed yet\n - *1* ???*2*[\"tail\"]\n@@ -56116,7 +56219,7 @@ ${La}${a}`(\"SuspenseList\")\n - *3* arguments[0]\n     function calls are not analyzed yet\n \n-0 -> 7504 conditional = (null !== ???*0*)\n+0 -> 7504 conditional = (null !== (???*0* | undefined))\n - *0* ???*1*[\"memoizedState\"]\n     unknown object\n - *1* arguments[0]\n@@ -56135,21 +56238,21 @@ ${La}${a}`(\"SuspenseList\")\n - *1* `https://reactjs.org/docs/error-decoder.html?invariant=${314}`\n     nested operation\n \n-0 -> 7510 conditional = (null !== ???*0*)\n+0 -> 7510 conditional = (null !== (???*0* | undefined))\n - *0* ???*1*[\"stateNode\"]\n     unknown object\n - *1* arguments[0]\n     function calls are not analyzed yet\n \n-7510 -> 7512 member call = ???*0*[\"delete\"](???*2*)\n+7510 -> 7512 member call = (???*0* | undefined)[\"delete\"](???*2*)\n - *0* ???*1*[\"stateNode\"]\n     unknown object\n - *1* arguments[0]\n     function calls are not analyzed yet\n - *2* arguments[1]\n     function calls are not analyzed yet\n \n-0 -> 7513 call = (...) => undefined(???*0*, (0 | ???*1*))\n+0 -> 7513 call = (...) => undefined(???*0*, (0 | ???*1* | undefined[\"retryLane\"]))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* ???*2*[\"retryLane\"]"
        },
        {
            "sha": "90216f8d3c9a6f9e393d4529ce0d7c41f51ab2ec",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/react-dom-production/resolved-explained.snapshot",
            "status": "modified",
            "additions": 23,
            "deletions": 12,
            "changes": 35,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fresolved-explained.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fresolved-explained.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fresolved-explained.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -4060,7 +4060,16 @@ a#5 = (???*0* | 0 | ???*1*)\n - *1* updated with update expression\n     This value might have side effects\n \n-a#50 = (???*0* | ???*1* | null[\"displayName\"] | null[\"name\"] | \"\" | (???*3* ? ???*5* : \"ForwardRef\"))\n+a#50 = (\n+  | ???*0*\n+  | ???*1*\n+  | undefined[\"displayName\"]\n+  | null[\"displayName\"]\n+  | undefined[\"name\"]\n+  | null[\"name\"]\n+  | \"\"\n+  | (???*3* ? ???*5* : \"ForwardRef\")\n+)\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* ???*2*[\"displayName\"]\n@@ -7563,6 +7572,7 @@ b#50 = (\n   | ???*0*\n   | \"\"[\"render\"]\n   | (???*2* ? ???*4* : \"ForwardRef\")[\"render\"]\n+  | undefined\n   | \"\"[\"displayName\"]\n   | (???*6* ? ???*8* : \"ForwardRef\")[\"displayName\"]\n   | null\n@@ -9282,7 +9292,7 @@ b#986 = ???*0*\n - *0* arguments[1]\n     function calls are not analyzed yet\n \n-b#990 = ???*0*\n+b#990 = (???*0* | undefined)\n - *0* ???*1*[\"stateNode\"]\n     unknown object\n - *1* arguments[0]\n@@ -11486,7 +11496,7 @@ c#644 = ???*0*\n - *0* arguments[2]\n     function calls are not analyzed yet\n \n-c#645 = (null | ???*0* | ???*1*)\n+c#645 = (null | undefined | ???*0* | ???*1*)\n - *0* arguments[1]\n     function calls are not analyzed yet\n - *1* ???*2*[\"tail\"]\n@@ -11884,7 +11894,7 @@ c#917 = (0 | ???*0*)\n - *2* arguments[0]\n     function calls are not analyzed yet\n \n-c#918 = (0 | ???*0*)\n+c#918 = (0 | ???*0* | undefined[\"retryLane\"])\n - *0* ???*1*[\"retryLane\"]\n     unknown object\n - *1* ???*2*[\"memoizedState\"]\n@@ -12051,6 +12061,7 @@ c#990 = (\n   | 536870912\n   | 1073741824\n   | ???*1*\n+  | undefined[\"pendingLanes\"]\n   | undefined\n )\n - *0* unsupported expression\n@@ -13878,7 +13889,7 @@ d#621 = (???*0* | 0 | ???*2* | ???*3* | ???*4*)\n - *4* unsupported assign operation\n     This value might have side effects\n \n-d#631 = (???*0* | (0 !== ???*3*))\n+d#631 = (???*0* | undefined | (0 !== ???*3*))\n - *0* ???*1*[\"_context\"]\n     unknown object\n - *1* ???*2*[\"type\"]\n@@ -13951,7 +13962,7 @@ d#644 = ???*0*\n - *0* arguments[3]\n     function calls are not analyzed yet\n \n-d#645 = (null | ???*0* | ???*1*)\n+d#645 = (null | undefined | ???*0* | ???*1*)\n - *0* arguments[1]\n     function calls are not analyzed yet\n - *1* ???*2*[\"tail\"]\n@@ -14057,7 +14068,7 @@ d#715 = (...) => undefined[\"bind\"](null, ???*0*, ???*1*)\n - *1* arguments[0]\n     function calls are not analyzed yet\n \n-d#716 = (0 | ???*0*)\n+d#716 = (0 | undefined | ???*0*)\n - *0* updated with update expression\n     This value might have side effects\n \n@@ -14407,7 +14418,7 @@ d#915 = ???*0*\n - *1* arguments[0]\n     function calls are not analyzed yet\n \n-d#918 = ???*0*\n+d#918 = (???*0* | undefined)\n - *0* ???*1*[\"stateNode\"]\n     unknown object\n - *1* arguments[0]\n@@ -16298,7 +16309,7 @@ e#621 = (???*0* | 0[\"revealOrder\"] | ???*3* | null | ???*5* | ???*6* | null[\"sib\n - *6* e\n     circular variable reference\n \n-e#631 = ???*0*\n+e#631 = (???*0* | undefined)\n - *0* ???*1*[\"value\"]\n     unknown object\n - *1* ???*2*[\"memoizedProps\"]\n@@ -16343,7 +16354,7 @@ e#639 = (???*0* | ???*2*)\n - *12* arguments[0]\n     function calls are not analyzed yet\n \n-e#646 = ???*0*\n+e#646 = (???*0* | undefined)\n - *0* ???*1*[\"child\"]\n     unknown object\n - *1* arguments[0]\n@@ -16577,7 +16588,7 @@ e#9 = ???*0*\n - *0* arguments[4]\n     function calls are not analyzed yet\n \n-e#918 = ???*0*\n+e#918 = (???*0* | undefined)\n - *0* ???*1*[\"memoizedState\"]\n     unknown object\n - *1* arguments[0]\n@@ -16891,7 +16902,7 @@ f#175 = ???*0*\n - *0* arguments[5]\n     function calls are not analyzed yet\n \n-f#176 = ???*0*\n+f#176 = (???*0* | undefined)\n - *0* ???*1*[\"pointerId\"]\n     unknown object\n - *1* arguments[4]"
        },
        {
            "sha": "b0f4b7667743cccb9e6c144c267f51bc7604ab4e",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/this-binding/graph-effects.snapshot",
            "status": "added",
            "additions": 81,
            "deletions": 0,
            "changes": 81,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fgraph-effects.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -0,0 +1,81 @@\n+[\n+    Member {\n+        obj: Unknown {\n+            original_value: None,\n+            reason: \"unsupported expression\",\n+            has_side_effects: true,\n+        },\n+        prop: Constant(\n+            Str(\n+                Atom(\n+                    \"name\",\n+                ),\n+            ),\n+        ),\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Class,\n+            ),\n+            ClassDecl(\n+                Class,\n+            ),\n+            Class(\n+                Body(\n+                    0,\n+                ),\n+            ),\n+            ClassMember(\n+                ClassProp,\n+            ),\n+            ClassProp(\n+                Value,\n+            ),\n+            Expr(\n+                Member,\n+            ),\n+        ],\n+        span: 39..48,\n+    },\n+    FreeVar {\n+        var: \"this\",\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    1,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                This,\n+            ),\n+        ],\n+        span: 243..247,\n+    },\n+]"
        },
        {
            "sha": "22194a535e9d9971453941348b84e48a0519f83a",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/this-binding/graph-explained.snapshot",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fgraph-explained.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fgraph-explained.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fgraph-explained.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -0,0 +1,15 @@\n+X (const after eval) = ???*0*\n+- *0* unsupported expression\n+    This value might have side effects\n+\n+bound_this_ctor = ???*0*\n+- *0* unsupported expression\n+    This value might have side effects\n+\n+bound_this_static (const after eval) = ???*0*\n+- *0* unsupported expression\n+    This value might have side effects\n+\n+free_this_root (const after eval) = ???*0*\n+- *0* unsupported expression\n+    This value might have side effects"
        },
        {
            "sha": "8ce2072da48a667156ece71a30e5007f041331e7",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/this-binding/graph.snapshot",
            "status": "added",
            "additions": 34,
            "deletions": 0,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fgraph.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fgraph.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fgraph.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -0,0 +1,34 @@\n+[\n+    (\n+        \"X\",\n+        Unknown {\n+            original_value: None,\n+            reason: \"unsupported expression\",\n+            has_side_effects: true,\n+        },\n+    ),\n+    (\n+        \"bound_this_ctor\",\n+        Unknown {\n+            original_value: None,\n+            reason: \"unsupported expression\",\n+            has_side_effects: true,\n+        },\n+    ),\n+    (\n+        \"bound_this_static\",\n+        Unknown {\n+            original_value: None,\n+            reason: \"unsupported expression\",\n+            has_side_effects: true,\n+        },\n+    ),\n+    (\n+        \"free_this_root\",\n+        Unknown {\n+            original_value: None,\n+            reason: \"unsupported expression\",\n+            has_side_effects: true,\n+        },\n+    ),\n+]"
        },
        {
            "sha": "5268ad7beb8c91dd5edcea5b8833d8e1d826aeac",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/this-binding/input.js",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Finput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Finput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Finput.js?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -0,0 +1,11 @@\n+class X {\n+  static bound_this_field = this.name\n+  static {\n+    const bound_this_static = this;\n+  }\n+  constructor() {\n+    const bound_this_ctor = this;\n+  }\n+}\n+// We should generate a freevar effect for this and only this\n+const free_this_root = this;"
        },
        {
            "sha": "cce00043071642d29e1dc9e4bdb8d262c3a9d730",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/this-binding/resolved-effects.snapshot",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fresolved-effects.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -0,0 +1 @@\n+0 -> 2 free var = FreeVar(this)"
        },
        {
            "sha": "5df4c930d0c0db7e6565578444ad32c41a6ebd4f",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/this-binding/resolved-explained.snapshot",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fresolved-explained.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fresolved-explained.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fthis-binding%2Fresolved-explained.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -0,0 +1,15 @@\n+X = ???*0*\n+- *0* unsupported expression\n+    This value might have side effects\n+\n+bound_this_ctor = ???*0*\n+- *0* unsupported expression\n+    This value might have side effects\n+\n+bound_this_static = ???*0*\n+- *0* unsupported expression\n+    This value might have side effects\n+\n+free_this_root = ???*0*\n+- *0* unsupported expression\n+    This value might have side effects"
        },
        {
            "sha": "c35800cb9f5f9297145bec46051d7203a673eb13",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/unreachable-break/graph-effects.snapshot",
            "status": "modified",
            "additions": 0,
            "deletions": 123,
            "changes": 123,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable-break%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable-break%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable-break%2Fgraph-effects.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -166,47 +166,6 @@\n             ),\n         ],\n     },\n-    Unreachable {\n-        start_ast_path: [\n-            Program(\n-                Module,\n-            ),\n-            Module(\n-                Body(\n-                    1,\n-                ),\n-            ),\n-            ModuleItem(\n-                Stmt,\n-            ),\n-            Stmt(\n-                Decl,\n-            ),\n-            Decl(\n-                Fn,\n-            ),\n-            FnDecl(\n-                Function,\n-            ),\n-            Function(\n-                Body,\n-            ),\n-            BlockStmt(\n-                Stmts(\n-                    1,\n-                ),\n-            ),\n-            Stmt(\n-                While,\n-            ),\n-            WhileStmt(\n-                Body,\n-            ),\n-            Stmt(\n-                Block,\n-            ),\n-        ],\n-    },\n     ImportedBinding {\n         esm_reference_index: 7,\n         export: Some(\n@@ -520,47 +479,6 @@\n             ),\n         ],\n     },\n-    Unreachable {\n-        start_ast_path: [\n-            Program(\n-                Module,\n-            ),\n-            Module(\n-                Body(\n-                    2,\n-                ),\n-            ),\n-            ModuleItem(\n-                Stmt,\n-            ),\n-            Stmt(\n-                Decl,\n-            ),\n-            Decl(\n-                Fn,\n-            ),\n-            FnDecl(\n-                Function,\n-            ),\n-            Function(\n-                Body,\n-            ),\n-            BlockStmt(\n-                Stmts(\n-                    0,\n-                ),\n-            ),\n-            Stmt(\n-                While,\n-            ),\n-            WhileStmt(\n-                Body,\n-            ),\n-            Stmt(\n-                Block,\n-            ),\n-        ],\n-    },\n     ImportedBinding {\n         esm_reference_index: 2,\n         export: Some(\n@@ -874,47 +792,6 @@\n             ),\n         ],\n     },\n-    Unreachable {\n-        start_ast_path: [\n-            Program(\n-                Module,\n-            ),\n-            Module(\n-                Body(\n-                    3,\n-                ),\n-            ),\n-            ModuleItem(\n-                Stmt,\n-            ),\n-            Stmt(\n-                Decl,\n-            ),\n-            Decl(\n-                Fn,\n-            ),\n-            FnDecl(\n-                Function,\n-            ),\n-            Function(\n-                Body,\n-            ),\n-            BlockStmt(\n-                Stmts(\n-                    0,\n-                ),\n-            ),\n-            Stmt(\n-                While,\n-            ),\n-            WhileStmt(\n-                Body,\n-            ),\n-            Stmt(\n-                Block,\n-            ),\n-        ],\n-    },\n     ImportedBinding {\n         esm_reference_index: 4,\n         export: Some("
        },
        {
            "sha": "ddb14bba93f375e6b25e576d232c1f4f8a8826b3",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/unreachable-break/resolved-effects.snapshot",
            "status": "modified",
            "additions": 7,
            "deletions": 19,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable-break%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable-break%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable-break%2Fresolved-effects.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -4,32 +4,20 @@\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 4 unreachable = ???*0*\n-- *0* unreachable\n-    This value might have side effects\n-\n-0 -> 6 call = module<foo, {}>[\"unreachableA3\"]()\n+0 -> 5 call = module<foo, {}>[\"unreachableA3\"]()\n \n-0 -> 8 call = module<foo, {}>[\"unreachableB1\"]()\n+0 -> 7 call = module<foo, {}>[\"unreachableB1\"]()\n \n-0 -> 9 unreachable = ???*0*\n+0 -> 8 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 10 unreachable = ???*0*\n-- *0* unreachable\n-    This value might have side effects\n+0 -> 10 call = module<foo, {}>[\"calledB1\"]()\n \n-0 -> 12 call = module<foo, {}>[\"calledB1\"]()\n-\n-0 -> 14 call = module<foo, {}>[\"calledC1\"]()\n-\n-0 -> 15 unreachable = ???*0*\n-- *0* unreachable\n-    This value might have side effects\n+0 -> 12 call = module<foo, {}>[\"calledC1\"]()\n \n-0 -> 16 unreachable = ???*0*\n+0 -> 13 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 18 call = module<foo, {}>[\"calledC2\"]()\n+0 -> 15 call = module<foo, {}>[\"calledC2\"]()"
        },
        {
            "sha": "f8295c3a8a7fd34d7aff005bc9ecb1bcd2acb293",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/unreachable/graph-effects.snapshot",
            "status": "modified",
            "additions": 182,
            "deletions": 190,
            "changes": 372,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fgraph-effects.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -293,44 +293,6 @@\n             ),\n         ],\n     },\n-    Unreachable {\n-        start_ast_path: [\n-            Program(\n-                Script,\n-            ),\n-            Script(\n-                Body(\n-                    1,\n-                ),\n-            ),\n-            Stmt(\n-                Decl,\n-            ),\n-            Decl(\n-                Fn,\n-            ),\n-            FnDecl(\n-                Function,\n-            ),\n-            Function(\n-                Body,\n-            ),\n-            BlockStmt(\n-                Stmts(\n-                    0,\n-                ),\n-            ),\n-            Stmt(\n-                While,\n-            ),\n-            WhileStmt(\n-                Body,\n-            ),\n-            Stmt(\n-                Block,\n-            ),\n-        ],\n-    },\n     FreeVar {\n         var: \"b3\",\n         ast_path: [\n@@ -593,44 +555,6 @@\n             ),\n         ],\n     },\n-    Unreachable {\n-        start_ast_path: [\n-            Program(\n-                Script,\n-            ),\n-            Script(\n-                Body(\n-                    2,\n-                ),\n-            ),\n-            Stmt(\n-                Decl,\n-            ),\n-            Decl(\n-                Fn,\n-            ),\n-            FnDecl(\n-                Function,\n-            ),\n-            Function(\n-                Body,\n-            ),\n-            BlockStmt(\n-                Stmts(\n-                    0,\n-                ),\n-            ),\n-            Stmt(\n-                DoWhile,\n-            ),\n-            DoWhileStmt(\n-                Body,\n-            ),\n-            Stmt(\n-                Block,\n-            ),\n-        ],\n-    },\n     FreeVar {\n         var: \"c3\",\n         ast_path: [\n@@ -893,44 +817,6 @@\n             ),\n         ],\n     },\n-    Unreachable {\n-        start_ast_path: [\n-            Program(\n-                Script,\n-            ),\n-            Script(\n-                Body(\n-                    3,\n-                ),\n-            ),\n-            Stmt(\n-                Decl,\n-            ),\n-            Decl(\n-                Fn,\n-            ),\n-            FnDecl(\n-                Function,\n-            ),\n-            Function(\n-                Body,\n-            ),\n-            BlockStmt(\n-                Stmts(\n-                    0,\n-                ),\n-            ),\n-            Stmt(\n-                For,\n-            ),\n-            ForStmt(\n-                Body,\n-            ),\n-            Stmt(\n-                Block,\n-            ),\n-        ],\n-    },\n     FreeVar {\n         var: \"d3\",\n         ast_path: [\n@@ -1193,44 +1079,6 @@\n             ),\n         ],\n     },\n-    Unreachable {\n-        start_ast_path: [\n-            Program(\n-                Script,\n-            ),\n-            Script(\n-                Body(\n-                    4,\n-                ),\n-            ),\n-            Stmt(\n-                Decl,\n-            ),\n-            Decl(\n-                Fn,\n-            ),\n-            FnDecl(\n-                Function,\n-            ),\n-            Function(\n-                Body,\n-            ),\n-            BlockStmt(\n-                Stmts(\n-                    0,\n-                ),\n-            ),\n-            Stmt(\n-                ForIn,\n-            ),\n-            ForInStmt(\n-                Body,\n-            ),\n-            Stmt(\n-                Block,\n-            ),\n-        ],\n-    },\n     FreeVar {\n         var: \"e3\",\n         ast_path: [\n@@ -1493,44 +1341,6 @@\n             ),\n         ],\n     },\n-    Unreachable {\n-        start_ast_path: [\n-            Program(\n-                Script,\n-            ),\n-            Script(\n-                Body(\n-                    5,\n-                ),\n-            ),\n-            Stmt(\n-                Decl,\n-            ),\n-            Decl(\n-                Fn,\n-            ),\n-            FnDecl(\n-                Function,\n-            ),\n-            Function(\n-                Body,\n-            ),\n-            BlockStmt(\n-                Stmts(\n-                    0,\n-                ),\n-            ),\n-            Stmt(\n-                ForOf,\n-            ),\n-            ForOfStmt(\n-                Body,\n-            ),\n-            Stmt(\n-                Block,\n-            ),\n-        ],\n-    },\n     FreeVar {\n         var: \"f3\",\n         ast_path: [\n@@ -2210,4 +2020,186 @@\n         in_try: false,\n         new: false,\n     },\n+    FreeVar {\n+        var: \"i1\",\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    8,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Fn,\n+            ),\n+            FnDecl(\n+                Function,\n+            ),\n+            Function(\n+                Body,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                Block,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                Expr,\n+            ),\n+            ExprStmt(\n+                Expr,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Callee,\n+            ),\n+            Callee(\n+                Expr,\n+            ),\n+            Expr(\n+                Ident,\n+            ),\n+        ],\n+        span: 645..647,\n+    },\n+    Call {\n+        func: FreeVar(\n+            \"i1\",\n+        ),\n+        args: [],\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    8,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Fn,\n+            ),\n+            FnDecl(\n+                Function,\n+            ),\n+            Function(\n+                Body,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                Block,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                Expr,\n+            ),\n+            ExprStmt(\n+                Expr,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+        ],\n+        span: 645..649,\n+        in_try: false,\n+        new: false,\n+    },\n+    Unreachable {\n+        start_ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    8,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Fn,\n+            ),\n+            FnDecl(\n+                Function,\n+            ),\n+            Function(\n+                Body,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                Block,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    1,\n+                ),\n+            ),\n+            Stmt(\n+                Return,\n+            ),\n+        ],\n+    },\n+    Unreachable {\n+        start_ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    8,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Fn,\n+            ),\n+            FnDecl(\n+                Function,\n+            ),\n+            Function(\n+                Body,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                Block,\n+            ),\n+        ],\n+    },\n ]"
        },
        {
            "sha": "5bc89d2b2e22b813f0c5ffa859c3da5ea50dc73b",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/unreachable/graph-explained.snapshot",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fgraph-explained.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fgraph-explained.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fgraph-explained.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -20,6 +20,8 @@ g (const after eval) = (...) => undefined\n \n h (const after eval) = (...) => undefined\n \n+i (const after eval) = (...) => undefined\n+\n x#10 = ???*0*\n - *0* for-in variable currently not analyzed\n "
        },
        {
            "sha": "10d56e31fc62d6cea33ebb0b039876adffafac8b",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/unreachable/graph.snapshot",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fgraph.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fgraph.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fgraph.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -104,6 +104,16 @@\n             ),\n         ),\n     ),\n+    (\n+        \"i\",\n+        Function(\n+            2,\n+            622,\n+            Constant(\n+                Undefined,\n+            ),\n+        ),\n+    ),\n     (\n         \"x#10\",\n         Unknown {"
        },
        {
            "sha": "8a694245f4c7a63d29acfac3a1069602f364025a",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/unreachable/input.js",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Finput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Finput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Finput.js?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -67,3 +67,11 @@ function h() {\n   };\n   h3();\n }\n+function i() {\n+  {\n+    i1();\n+    return;\n+    i2();\n+  }\n+  i3();\n+}"
        },
        {
            "sha": "ddcf2187ef3136a86e49cf4d1feb1827e45a7862",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/unreachable/resolved-effects.snapshot",
            "status": "modified",
            "additions": 44,
            "deletions": 49,
            "changes": 93,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fresolved-effects.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -20,137 +20,132 @@\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 7 unreachable = ???*0*\n-- *0* unreachable\n-    This value might have side effects\n-\n-0 -> 8 free var = FreeVar(b3)\n+0 -> 7 free var = FreeVar(b3)\n \n-0 -> 9 call = ???*0*()\n+0 -> 8 call = ???*0*()\n - *0* FreeVar(b3)\n     unknown global\n     This value might have side effects\n \n-0 -> 10 free var = FreeVar(c1)\n+0 -> 9 free var = FreeVar(c1)\n \n-0 -> 11 call = ???*0*()\n+0 -> 10 call = ???*0*()\n - *0* FreeVar(c1)\n     unknown global\n     This value might have side effects\n \n-0 -> 12 unreachable = ???*0*\n-- *0* unreachable\n-    This value might have side effects\n-\n-0 -> 13 unreachable = ???*0*\n+0 -> 11 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 14 free var = FreeVar(c3)\n+0 -> 12 free var = FreeVar(c3)\n \n-0 -> 15 call = ???*0*()\n+0 -> 13 call = ???*0*()\n - *0* FreeVar(c3)\n     unknown global\n     This value might have side effects\n \n-0 -> 16 free var = FreeVar(d1)\n+0 -> 14 free var = FreeVar(d1)\n \n-0 -> 17 call = ???*0*()\n+0 -> 15 call = ???*0*()\n - *0* FreeVar(d1)\n     unknown global\n     This value might have side effects\n \n-0 -> 18 unreachable = ???*0*\n+0 -> 16 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 19 unreachable = ???*0*\n-- *0* unreachable\n-    This value might have side effects\n+0 -> 17 free var = FreeVar(d3)\n \n-0 -> 20 free var = FreeVar(d3)\n-\n-0 -> 21 call = ???*0*()\n+0 -> 18 call = ???*0*()\n - *0* FreeVar(d3)\n     unknown global\n     This value might have side effects\n \n-0 -> 22 free var = FreeVar(e1)\n+0 -> 19 free var = FreeVar(e1)\n \n-0 -> 23 call = ???*0*()\n+0 -> 20 call = ???*0*()\n - *0* FreeVar(e1)\n     unknown global\n     This value might have side effects\n \n-0 -> 24 unreachable = ???*0*\n-- *0* unreachable\n-    This value might have side effects\n-\n-0 -> 25 unreachable = ???*0*\n+0 -> 21 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 26 free var = FreeVar(e3)\n+0 -> 22 free var = FreeVar(e3)\n \n-0 -> 27 call = ???*0*()\n+0 -> 23 call = ???*0*()\n - *0* FreeVar(e3)\n     unknown global\n     This value might have side effects\n \n-0 -> 28 free var = FreeVar(f1)\n+0 -> 24 free var = FreeVar(f1)\n \n-0 -> 29 call = ???*0*()\n+0 -> 25 call = ???*0*()\n - *0* FreeVar(f1)\n     unknown global\n     This value might have side effects\n \n-0 -> 30 unreachable = ???*0*\n+0 -> 26 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n+0 -> 27 free var = FreeVar(f3)\n+\n+0 -> 28 call = ???*0*()\n+- *0* FreeVar(f3)\n+    unknown global\n+    This value might have side effects\n+\n+0 -> 29 free var = FreeVar(g1)\n+\n+0 -> 30 call = ???*0*()\n+- *0* FreeVar(g1)\n+    unknown global\n+    This value might have side effects\n+\n 0 -> 31 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 32 free var = FreeVar(f3)\n+0 -> 32 free var = FreeVar(g3)\n \n 0 -> 33 call = ???*0*()\n-- *0* FreeVar(f3)\n+- *0* FreeVar(g3)\n     unknown global\n     This value might have side effects\n \n-0 -> 34 free var = FreeVar(g1)\n+0 -> 34 free var = FreeVar(h1)\n \n 0 -> 35 call = ???*0*()\n-- *0* FreeVar(g1)\n+- *0* FreeVar(h1)\n     unknown global\n     This value might have side effects\n \n 0 -> 36 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 37 free var = FreeVar(g3)\n+0 -> 37 free var = FreeVar(h3)\n \n 0 -> 38 call = ???*0*()\n-- *0* FreeVar(g3)\n+- *0* FreeVar(h3)\n     unknown global\n     This value might have side effects\n \n-0 -> 39 free var = FreeVar(h1)\n+0 -> 39 free var = FreeVar(i1)\n \n 0 -> 40 call = ???*0*()\n-- *0* FreeVar(h1)\n+- *0* FreeVar(i1)\n     unknown global\n     This value might have side effects\n \n 0 -> 41 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 42 free var = FreeVar(h3)\n-\n-0 -> 43 call = ???*0*()\n-- *0* FreeVar(h3)\n-    unknown global\n+0 -> 42 unreachable = ???*0*\n+- *0* unreachable\n     This value might have side effects"
        },
        {
            "sha": "bf53673346112deea94fa6e749b003f4c52c3648",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/unreachable/resolved-explained.snapshot",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fresolved-explained.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fresolved-explained.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Funreachable%2Fresolved-explained.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -20,6 +20,8 @@ g = (...) => undefined\n \n h = (...) => undefined\n \n+i = (...) => undefined\n+\n x#10 = ???*0*\n - *0* for-in variable currently not analyzed\n "
        },
        {
            "sha": "5440276abc611c1712b18858fc46bc63c09f2aa4",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/webpack-target-node/graph-explained.snapshot",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fgraph-explained.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fgraph-explained.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fgraph-explained.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -6,19 +6,19 @@\n \n __unused_webpack_module = arguments[0]\n \n-__webpack_exec__ = (*arrow function 1213* | undefined)\n+__webpack_exec__ = *arrow function 1213*\n \n-__webpack_exports__#3 = (__webpack_exec__(5166) | undefined)\n+__webpack_exports__#3 = __webpack_exec__(5166)\n \n __webpack_exports__#4 = arguments[1]\n \n-__webpack_require__#3 = (FreeVar(require)(\"../../webpack-api-runtime.js\") | undefined)\n+__webpack_require__#3 = FreeVar(require)(\"../../webpack-api-runtime.js\")\n \n __webpack_require__#4 = arguments[2]\n \n _req = arguments[0]\n \n-exports = ({} | undefined)\n+exports = {}\n \n handler = (...) => Promise<undefined>\n "
        },
        {
            "sha": "c5db7eb80083d31042b9c308a4b1f7e58f0b1508",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/webpack-target-node/graph.snapshot",
            "status": "modified",
            "additions": 36,
            "deletions": 72,
            "changes": 108,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fgraph.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fgraph.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fgraph.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -55,51 +55,33 @@\n     ),\n     (\n         \"__webpack_exec__\",\n-        Alternatives {\n-            total_nodes: 3,\n-            values: [\n-                Variable(\n-                    (\n-                        \"*arrow function 1213*\",\n-                        #0,\n-                    ),\n-                ),\n-                Constant(\n-                    Undefined,\n-                ),\n-            ],\n-            logical_property: None,\n-        },\n+        Variable(\n+            (\n+                \"*arrow function 1213*\",\n+                #0,\n+            ),\n+        ),\n     ),\n     (\n         \"__webpack_exports__#3\",\n-        Alternatives {\n-            total_nodes: 5,\n-            values: [\n-                Call(\n-                    3,\n-                    Variable(\n-                        (\n-                            \"__webpack_exec__\",\n-                            #3,\n-                        ),\n-                    ),\n-                    [\n-                        Constant(\n-                            Num(\n-                                ConstantNumber(\n-                                    5166.0,\n-                                ),\n-                            ),\n-                        ),\n-                    ],\n+        Call(\n+            3,\n+            Variable(\n+                (\n+                    \"__webpack_exec__\",\n+                    #3,\n                 ),\n+            ),\n+            [\n                 Constant(\n-                    Undefined,\n+                    Num(\n+                        ConstantNumber(\n+                            5166.0,\n+                        ),\n+                    ),\n                 ),\n             ],\n-            logical_property: None,\n-        },\n+        ),\n     ),\n     (\n         \"__webpack_exports__#4\",\n@@ -110,30 +92,21 @@\n     ),\n     (\n         \"__webpack_require__#3\",\n-        Alternatives {\n-            total_nodes: 5,\n-            values: [\n-                Call(\n-                    3,\n-                    FreeVar(\n-                        \"require\",\n-                    ),\n-                    [\n-                        Constant(\n-                            Str(\n-                                Atom(\n-                                    \"../../webpack-api-runtime.js\",\n-                                ),\n-                            ),\n-                        ),\n-                    ],\n-                ),\n+        Call(\n+            3,\n+            FreeVar(\n+                \"require\",\n+            ),\n+            [\n                 Constant(\n-                    Undefined,\n+                    Str(\n+                        Atom(\n+                            \"../../webpack-api-runtime.js\",\n+                        ),\n+                    ),\n                 ),\n             ],\n-            logical_property: None,\n-        },\n+        ),\n     ),\n     (\n         \"__webpack_require__#4\",\n@@ -151,19 +124,10 @@\n     ),\n     (\n         \"exports\",\n-        Alternatives {\n-            total_nodes: 3,\n-            values: [\n-                Object {\n-                    total_nodes: 1,\n-                    parts: [],\n-                    mutable: true,\n-                },\n-                Constant(\n-                    Undefined,\n-                ),\n-            ],\n-            logical_property: None,\n+        Object {\n+            total_nodes: 1,\n+            parts: [],\n+            mutable: true,\n         },\n     ),\n     ("
        },
        {
            "sha": "a8b83592bbd8dec16586d4ecd8d96f2c15501c93",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/webpack-target-node/resolved-effects.snapshot",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fresolved-effects.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -39,12 +39,12 @@\n 0 -> 17 call = require*0*(\"../../webpack-api-runtime.js\")\n - *0* require: The require method from CommonJS\n \n-0 -> 19 member call = (module<../../webpack-api-runtime.js, {}> | undefined)[\"C\"](({} | undefined))\n+0 -> 19 member call = module<../../webpack-api-runtime.js, {}>[\"C\"]({})\n \n-0 -> 21 call = (module<../../webpack-api-runtime.js, {}> | undefined)(???*0*)\n+0 -> 21 call = module<../../webpack-api-runtime.js, {}>(???*0*)\n - *0* arguments[0]\n     function calls are not analyzed yet\n \n-0 -> 22 call = ((...) => __webpack_require__(moduleId) | undefined)(5166)\n+0 -> 22 call = (...) => __webpack_require__(moduleId)(5166)\n \n 0 -> 24 free var = FreeVar(module)"
        },
        {
            "sha": "dc2ff73c54bc232f6a57e0082423153f89fba534",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/webpack-target-node/resolved-explained.snapshot",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fresolved-explained.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fresolved-explained.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fwebpack-target-node%2Fresolved-explained.snapshot?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -8,17 +8,15 @@ __unused_webpack_module = ???*0*\n - *0* arguments[0]\n     function calls are not analyzed yet\n \n-__webpack_exec__ = ((...) => __webpack_require__(moduleId) | undefined)\n+__webpack_exec__ = (...) => __webpack_require__(moduleId)\n \n-__webpack_exports__#3 = (???*0* | undefined)\n-- *0* ((...) => __webpack_require__(moduleId) | undefined)(5166)\n-    non-function callee\n+__webpack_exports__#3 = module<../../webpack-api-runtime.js, {}>(5166)\n \n __webpack_exports__#4 = ???*0*\n - *0* arguments[1]\n     function calls are not analyzed yet\n \n-__webpack_require__#3 = (module<../../webpack-api-runtime.js, {}> | undefined)\n+__webpack_require__#3 = module<../../webpack-api-runtime.js, {}>\n \n __webpack_require__#4 = ???*0*\n - *0* arguments[2]\n@@ -28,7 +26,7 @@ _req = ???*0*\n - *0* arguments[0]\n     function calls are not analyzed yet\n \n-exports = ({} | undefined)\n+exports = {}\n \n handler = (...) => Promise<undefined>\n "
        },
        {
            "sha": "9de12b02e747a72ac3b77e42210c71bacceee7da",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/input/module.js",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Finput%2Fmodule.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Finput%2Fmodule.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Finput%2Fmodule.js?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -200,6 +200,24 @@ function p() {\n   p4()\n }\n \n+function q() {\n+  while (false) {\n+    q1()\n+    return\n+    q2()\n+  }\n+  q3()\n+}\n+\n+function r() {\n+  {\n+    r1()\n+    return\n+    r2()\n+  }\n+  r3()\n+}\n+\n z1()\n \n return"
        },
        {
            "sha": "b97218e0fc60bea476d027043fdb220530528b4a",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/output/aaf3a_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_022ddac5._.js",
            "status": "modified",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_022ddac5._.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_022ddac5._.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_022ddac5._.js?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -195,6 +195,25 @@ function p() {\n     //TURBOPACK unreachable\n     ;\n }\n+function q() {\n+    while(false){\n+        q1();\n+        return;\n+        //TURBOPACK unreachable\n+        ;\n+    }\n+    q3();\n+}\n+function r() {\n+    {\n+        r1();\n+        return;\n+        //TURBOPACK unreachable\n+        ;\n+    }\n+    //TURBOPACK unreachable\n+    ;\n+}\n z1();\n return;\n z2();"
        },
        {
            "sha": "f223d4bc24fc688e4be6c9d8a30a190f037cf90b",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/output/aaf3a_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_022ddac5._.js.map",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_022ddac5._.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_022ddac5._.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fearly-return%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_early-return_input_022ddac5._.js.map?ref=e07cc5cc51a8e3b18a74b7ee7bf1999ae910043b",
            "patch": "@@ -2,6 +2,6 @@\n   \"version\": 3,\n   \"sources\": [],\n   \"sections\": [\n-    {\"offset\": {\"line\": 4, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/input/module.js\"],\"sourcesContent\":[\"export function a() {\\n  if (true) {\\n    a1()\\n    return\\n  }\\n  a2()\\n  var a3 = 3\\n  function a4() {\\n    var a5\\n  }\\n  ;(function a6() {\\n    var a7\\n  })\\n  const a8 = () => {\\n    var a9\\n  }\\n  class a10 {}\\n  let a11 = 11\\n  let {\\n    a12 = 12,\\n    a14: {\\n      a15,\\n      a16: [a17, ...a18],\\n    },\\n    ...a19\\n  } = {}\\n  function a20() {\\n    return\\n    a21()\\n  }\\n  ;({\\n    get a22() {\\n      var a23\\n    },\\n    set a22(value) {\\n      var a24\\n    },\\n    a25() {\\n      var a26\\n    },\\n  })\\n  {\\n    let a27\\n    var a28\\n  }\\n}\\n\\nexport function b() {\\n  if (true) {\\n    b1()\\n    return\\n  } else {\\n    b2()\\n  }\\n  b3()\\n}\\n\\nexport function c() {\\n  if (true) {\\n    return\\n  }\\n  c1()\\n}\\n\\nexport function d() {\\n  if (true) {\\n    return\\n  } else {\\n    d1()\\n  }\\n  d2()\\n}\\n\\nexport function e() {\\n  if (false) {\\n    e1()\\n  } else {\\n    return\\n  }\\n  e2()\\n}\\n\\nexport function f() {\\n  if (false) {\\n  } else {\\n    return\\n  }\\n  f1()\\n}\\n\\nexport function g() {\\n  if (false) {\\n    g1()\\n  } else {\\n    g2()\\n    return\\n  }\\n  g3()\\n}\\n\\nexport function h() {\\n  if (false) {\\n  } else {\\n    h1()\\n    return\\n  }\\n  h2()\\n}\\n\\nexport function i(j) {\\n  if (j < 1) return i1()\\n  return i2()\\n}\\n\\nexport function j(j) {\\n  if (j < 1) {\\n    return i1()\\n  }\\n  return i2()\\n}\\n\\nclass K {\\n  constructor() {\\n    try {\\n      k1()\\n    } catch (e) {\\n      k2()\\n      return\\n      k3()\\n    } finally {\\n      k4()\\n    }\\n    k5()\\n  }\\n\\n  l() {\\n    try {\\n      l1()\\n    } catch (e) {\\n      l2()\\n    } finally {\\n      l3()\\n      return\\n      l4()\\n    }\\n    l5()\\n  }\\n\\n  get m() {\\n    if (true) {\\n      m1()\\n      return\\n    }\\n    m2()\\n  }\\n\\n  set m(value) {\\n    m1()\\n    return m2()\\n    m3()\\n  }\\n\\n  n = () => {\\n    switch (42) {\\n      case 1:\\n        n1()\\n        return\\n        n2()\\n      case 2:\\n        n3()\\n        break\\n      default:\\n        n4()\\n    }\\n    n5()\\n  }\\n\\n  o() {\\n    if (something) {\\n      require('./module')\\n      return\\n    } else {\\n      require('./module')\\n      return\\n    }\\n  }\\n}\\n\\nfunction p() {\\n  class C {\\n    constructor() {\\n      p1()\\n      return\\n      p2()\\n    }\\n  }\\n\\n  p3()\\n  return\\n  p4()\\n}\\n\\nz1()\\n\\nreturn\\n\\nz2()\\n\"],\"names\":[],\"mappings\":\";;;;;;;;;;;;;;;;;;;;;;AAAO,SAAS;IACd,wCAAU;QACR;QACA;IACF;;;IAEA,IAAI;IACJ,SAAS;QACP,IAAI;IACN;IAIA,MAAM;IAGA,IAAA;IACN,IAAI;IACJ,IACE,KAEE,KACM,KAAQ,KAEb;IAEL,SAAS;QACP;;;IAEF;IAcE,IAAI;AAER;AAEO,SAAS;IACd,wCAAU;QACR;QACA;IACF;;;;AAIF;AAEO,SAAS;IACd,wCAAU;QACR;IACF;;;AAEF;AAEO,SAAS;IACd,wCAAU;QACR;IACF;;;;AAIF;AAEO,SAAS;IACd;;SAEO;QACL;IACF;;;AAEF;AAEO,SAAS;IACd,uCAAW,CACX,OAAO;QACL;IACF;;;AAEF;AAEO,SAAS;IACd;;SAEO;QACL;QACA;IACF;;;AAEF;AAEO,SAAS;IACd,uCAAW,CACX,OAAO;QACL;QACA;IACF;;;AAEF;AAEO,SAAS,EAAE,CAAC;IACjB,IAAI,IAAI,GAAG,OAAO;IAClB,OAAO;AACT;AAEO,SAAS,EAAE,CAAC;IACjB,IAAI,IAAI,GAAG;QACT,OAAO;IACT;IACA,OAAO;AACT;AAEA,MAAM;IACJ,aAAc;QACZ,IAAI;YACF;QACF,EAAE,OAAO,GAAG;YACV;YACA;;;QAEF,SAAU;YACR;QACF;QACA;IACF;IAEA,IAAI;QACF,IAAI;YACF;QACF,EAAE,OAAO,GAAG;YACV;QACF,SAAU;YACR;YACA;;;QAEF;;;IAEF;IAEA,IAAI,IAAI;QACN,wCAAU;YACR;YACA;QACF;;;IAEF;IAEA,IAAI,EAAE,KAAK,EAAE;QACX;QACA,OAAO;;;IAET;IAEA,IAAI;QACF,OAAQ;YACN,KAAK;gBACH;gBACA;;;YAEF,KAAK;gBACH;gBACA;YACF;gBACE;QACJ;QACA;IACF,EAAC;IAED,IAAI;QACF,IAAI,WAAW;;YAEb;QACF,OAAO;;YAEL;QACF;IACF;AACF;AAEA,SAAS;IACP,MAAM;QACJ,aAAc;YACZ;YACA;;;QAEF;IACF;IAEA;IACA;;;AAEF;AAEA;AAEA;AAEA\"}},\n-    {\"offset\": {\"line\": 204, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/input/index.js\"],\"sourcesContent\":[\"import * as module from './module'\\nconsole.log(module)\\n\"],\"names\":[],\"mappings\":\";AAAA;;AACA,QAAQ,GAAG,CAAC\"}}]\n+    {\"offset\": {\"line\": 4, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/input/module.js\"],\"sourcesContent\":[\"export function a() {\\n  if (true) {\\n    a1()\\n    return\\n  }\\n  a2()\\n  var a3 = 3\\n  function a4() {\\n    var a5\\n  }\\n  ;(function a6() {\\n    var a7\\n  })\\n  const a8 = () => {\\n    var a9\\n  }\\n  class a10 {}\\n  let a11 = 11\\n  let {\\n    a12 = 12,\\n    a14: {\\n      a15,\\n      a16: [a17, ...a18],\\n    },\\n    ...a19\\n  } = {}\\n  function a20() {\\n    return\\n    a21()\\n  }\\n  ;({\\n    get a22() {\\n      var a23\\n    },\\n    set a22(value) {\\n      var a24\\n    },\\n    a25() {\\n      var a26\\n    },\\n  })\\n  {\\n    let a27\\n    var a28\\n  }\\n}\\n\\nexport function b() {\\n  if (true) {\\n    b1()\\n    return\\n  } else {\\n    b2()\\n  }\\n  b3()\\n}\\n\\nexport function c() {\\n  if (true) {\\n    return\\n  }\\n  c1()\\n}\\n\\nexport function d() {\\n  if (true) {\\n    return\\n  } else {\\n    d1()\\n  }\\n  d2()\\n}\\n\\nexport function e() {\\n  if (false) {\\n    e1()\\n  } else {\\n    return\\n  }\\n  e2()\\n}\\n\\nexport function f() {\\n  if (false) {\\n  } else {\\n    return\\n  }\\n  f1()\\n}\\n\\nexport function g() {\\n  if (false) {\\n    g1()\\n  } else {\\n    g2()\\n    return\\n  }\\n  g3()\\n}\\n\\nexport function h() {\\n  if (false) {\\n  } else {\\n    h1()\\n    return\\n  }\\n  h2()\\n}\\n\\nexport function i(j) {\\n  if (j < 1) return i1()\\n  return i2()\\n}\\n\\nexport function j(j) {\\n  if (j < 1) {\\n    return i1()\\n  }\\n  return i2()\\n}\\n\\nclass K {\\n  constructor() {\\n    try {\\n      k1()\\n    } catch (e) {\\n      k2()\\n      return\\n      k3()\\n    } finally {\\n      k4()\\n    }\\n    k5()\\n  }\\n\\n  l() {\\n    try {\\n      l1()\\n    } catch (e) {\\n      l2()\\n    } finally {\\n      l3()\\n      return\\n      l4()\\n    }\\n    l5()\\n  }\\n\\n  get m() {\\n    if (true) {\\n      m1()\\n      return\\n    }\\n    m2()\\n  }\\n\\n  set m(value) {\\n    m1()\\n    return m2()\\n    m3()\\n  }\\n\\n  n = () => {\\n    switch (42) {\\n      case 1:\\n        n1()\\n        return\\n        n2()\\n      case 2:\\n        n3()\\n        break\\n      default:\\n        n4()\\n    }\\n    n5()\\n  }\\n\\n  o() {\\n    if (something) {\\n      require('./module')\\n      return\\n    } else {\\n      require('./module')\\n      return\\n    }\\n  }\\n}\\n\\nfunction p() {\\n  class C {\\n    constructor() {\\n      p1()\\n      return\\n      p2()\\n    }\\n  }\\n\\n  p3()\\n  return\\n  p4()\\n}\\n\\nfunction q() {\\n  while (false) {\\n    q1()\\n    return\\n    q2()\\n  }\\n  q3()\\n}\\n\\nfunction r() {\\n  {\\n    r1()\\n    return\\n    r2()\\n  }\\n  r3()\\n}\\n\\nz1()\\n\\nreturn\\n\\nz2()\\n\"],\"names\":[],\"mappings\":\";;;;;;;;;;;;;;;;;;;;;;AAAO,SAAS;IACd,wCAAU;QACR;QACA;IACF;;;IAEA,IAAI;IACJ,SAAS;QACP,IAAI;IACN;IAIA,MAAM;IAGA,IAAA;IACN,IAAI;IACJ,IACE,KAEE,KACM,KAAQ,KAEb;IAEL,SAAS;QACP;;;IAEF;IAcE,IAAI;AAER;AAEO,SAAS;IACd,wCAAU;QACR;QACA;IACF;;;;AAIF;AAEO,SAAS;IACd,wCAAU;QACR;IACF;;;AAEF;AAEO,SAAS;IACd,wCAAU;QACR;IACF;;;;AAIF;AAEO,SAAS;IACd;;SAEO;QACL;IACF;;;AAEF;AAEO,SAAS;IACd,uCAAW,CACX,OAAO;QACL;IACF;;;AAEF;AAEO,SAAS;IACd;;SAEO;QACL;QACA;IACF;;;AAEF;AAEO,SAAS;IACd,uCAAW,CACX,OAAO;QACL;QACA;IACF;;;AAEF;AAEO,SAAS,EAAE,CAAC;IACjB,IAAI,IAAI,GAAG,OAAO;IAClB,OAAO;AACT;AAEO,SAAS,EAAE,CAAC;IACjB,IAAI,IAAI,GAAG;QACT,OAAO;IACT;IACA,OAAO;AACT;AAEA,MAAM;IACJ,aAAc;QACZ,IAAI;YACF;QACF,EAAE,OAAO,GAAG;YACV;YACA;;;QAEF,SAAU;YACR;QACF;QACA;IACF;IAEA,IAAI;QACF,IAAI;YACF;QACF,EAAE,OAAO,GAAG;YACV;QACF,SAAU;YACR;YACA;;;QAEF;;;IAEF;IAEA,IAAI,IAAI;QACN,wCAAU;YACR;YACA;QACF;;;IAEF;IAEA,IAAI,EAAE,KAAK,EAAE;QACX;QACA,OAAO;;;IAET;IAEA,IAAI;QACF,OAAQ;YACN,KAAK;gBACH;gBACA;;;YAEF,KAAK;gBACH;gBACA;YACF;gBACE;QACJ;QACA;IACF,EAAC;IAED,IAAI;QACF,IAAI,WAAW;;YAEb;QACF,OAAO;;YAEL;QACF;IACF;AACF;AAEA,SAAS;IACP,MAAM;QACJ,aAAc;YACZ;YACA;;;QAEF;IACF;IAEA;IACA;;;AAEF;AAEA,SAAS;IACP,MAAO,MAAO;QACZ;QACA;;;IAEF;IACA;AACF;AAEA,SAAS;IACP;QACE;QACA;;;IAEF;;;AAEF;AAEA;AAEA;AAEA\"}},\n+    {\"offset\": {\"line\": 223, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/early-return/input/index.js\"],\"sourcesContent\":[\"import * as module from './module'\\nconsole.log(module)\\n\"],\"names\":[],\"mappings\":\";AAAA;;AACA,QAAQ,GAAG,CAAC\"}}]\n }\n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 2002,
        "additions": 1138,
        "deletions": 864
    }
}