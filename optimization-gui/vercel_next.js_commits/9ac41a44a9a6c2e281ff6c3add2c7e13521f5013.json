{
    "author": "bgw",
    "message": "refactor(CI): Extend areweturboyet integration test jobs for all bundlers (#76361)\n\nUse the reusable configs defined in #76251 for rspack.\n\nDevelopment tests:\nhttps://github.com/vercel/next.js/actions/runs/13514384329\nProduction tests:\nhttps://github.com/vercel/next.js/actions/runs/13514385828\n\nPatch the `build-rspack-dev-tests-manifest.js` script:\n\n```\ndiff --git a/test/build-rspack-dev-tests-manifest.js b/test/build-rspack-dev-tests-manifest.js\nindex 22f8401ef7..8cc5ed4af6 100644\n--- a/test/build-rspack-dev-tests-manifest.js\n+++ b/test/build-rspack-dev-tests-manifest.js\n@@ -91,7 +91,10 @@ async function fetchLatestTestArtifact() {\n   const res = JSON.parse(stdout)\n\n   for (const artifact of res.artifacts) {\n-    if (artifact.expired || artifact.workflow_run.head_branch !== 'canary') {\n+    if (\n+      artifact.expired ||\n+      artifact.workflow_run.head_branch !== 'bgw/round-robin-tests'\n+    ) {\n       continue\n     }\n```\n\n```\nnode test/build-turbopack-dev-tests-manifest.js\n```\n\nInspect the generated JSON:\nhttps://gist.github.com/bgw/35b7f9d09cd95f64087a69ff5c7f8972",
    "sha": "9ac41a44a9a6c2e281ff6c3add2c7e13521f5013",
    "files": [
        {
            "sha": "686ad442a7b19b30c727f45a5bae34e15d7db69f",
            "filename": ".github/workflows/integration_tests_reusable.yml",
            "status": "modified",
            "additions": 9,
            "deletions": 4,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Fintegration_tests_reusable.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Fintegration_tests_reusable.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Fworkflows%2Fintegration_tests_reusable.yml?ref=9ac41a44a9a6c2e281ff6c3add2c7e13521f5013",
            "patch": "@@ -33,6 +33,9 @@ on:\n       integration_timeout_minutes:\n         type: number\n         default: 30\n+      num_retries:\n+        type: number\n+        default: 2\n \n jobs:\n   # First, build Next.js to execute across tests.\n@@ -97,8 +100,9 @@ jobs:\n         ${{ inputs.run_before_test }}\n \n         node run-tests.js \\\n-          -g ${{ matrix.group }}/${{ inputs.e2e_groups }} \\\n-          -c $TEST_CONCURRENCY \\\n+          --group ${{ matrix.group }}/${{ inputs.e2e_groups }} \\\n+          --concurrency $TEST_CONCURRENCY \\\n+          --retries ${{ inputs.num_retries }} \\\n           --type ${{ inputs.test_type }}\n       stepName: test-${{ inputs.name }}-${{ matrix.group }}\n       timeout_minutes: ${{ inputs.e2e_timeout_minutes }}\n@@ -135,8 +139,9 @@ jobs:\n         ${{ inputs.run_before_test }}\n \n         node run-tests.js \\\n-          -g ${{ matrix.group }}/${{ inputs.integration_groups }} \\\n-          -c $TEST_CONCURRENCY \\\n+          --group ${{ matrix.group }}/${{ inputs.integration_groups }} \\\n+          --concurrency $TEST_CONCURRENCY \\\n+          --retries ${{ inputs.num_retries }} \\\n           --type integration\n       stepName: test-${{ inputs.name }}-integration-${{ matrix.group }}\n       timeout_minutes: ${{ inputs.integration_timeout_minutes }}"
        },
        {
            "sha": "7ed8333442fa9c51a9d2b161d54d8b3e05960516",
            "filename": ".github/workflows/rspack-nextjs-build-integration-tests.yml",
            "status": "modified",
            "additions": 25,
            "deletions": 205,
            "changes": 230,
            "blob_url": "https://github.com/vercel/next.js/blob/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Frspack-nextjs-build-integration-tests.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Frspack-nextjs-build-integration-tests.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Fworkflows%2Frspack-nextjs-build-integration-tests.yml?ref=9ac41a44a9a6c2e281ff6c3add2c7e13521f5013",
            "patch": "@@ -1,212 +1,32 @@\n-# Reusable workflow to execute certain version of Next.js integration tests\n-# with Rspack.\n-#\n-# Refer test.yml for how this workflow is being initialized\n-# - Workflow can specify `inputs.version` to specify which version of next.js to use, otherwise will use latest release version.\n name: Rspack Next.js production integration tests\n \n on:\n   schedule:\n-    - cron: '0 6 * * *'\n-  workflow_dispatch:\n-    inputs:\n-      # Allow to specify Next.js version to run integration test against.\n-      # If not specified, will use latest release version including canary.\n-      version:\n-        description: Next.js version, sha, branch to test\n-        type: string\n-        default: 'canary'\n-      # The base of the test results to compare against. If not specified, will try to compare with latest main branch's test results.\n-      diff_base:\n-        type: string\n-        default: 'none'\n-\n-# Workflow-common env variables\n-env:\n-  # Enabling backtrace will makes snapshot tests fail\n-  RUST_BACKTRACE: 0\n-  NEXT_TELEMETRY_DISABLED: 1\n-  TEST_CONCURRENCY: 6\n-  NEXT_JUNIT_TEST_REPORT: 'true'\n-  __INTERNAL_CUSTOM_TURBOPACK_BINDINGS: ${{ github.workspace }}/packages/next-swc/native/next-swc.linux-x64-gnu.node\n-  NEXT_TEST_SKIP_RETRY_MANIFEST: ${{ github.workspace }}/integration-test-data/test-results/main/failed-test-path-list.json\n-  NEXT_TEST_CONTINUE_ON_ERROR: TRUE\n-  NEXT_E2E_TEST_TIMEOUT: 240000\n-  NEXT_TEST_JOB: 1\n+    # Run an hour earlier than the turbopack tests, so we don't overwhelm the CI\n+    - cron: '0 5 * * *'\n+  workflow_dispatch: {}\n \n jobs:\n-  # First, build Next.js to execute across tests.\n-  setup_nextjs:\n-    name: Setup Next.js build\n-    uses: ./.github/workflows/setup-nextjs-build.yml\n+  test-dev:\n+    name: Rspack integration tests\n+    uses: ./.github/workflows/integration_tests_reusable.yml\n     with:\n-      nodeVersion: 18.18.2\n-      version: ${{ inputs.version || 'canary' }}\n-\n-  # Actual test scheduling. These jobs mimic the same jobs in Next.js repo,\n-  # which we do allow some of duplications to make it easier to update if upstream changes.\n-  # Refer build_and_test.yml in the Next.js repo for more details.\n-  test-production:\n-    # This job name is being used in github action to collect test results. Do not change it, or should update\n-    # ./.github/actions/next-integration-stat to match the new name.\n-    name: Next.js integration test (Production)\n-    # Currently it is possible test grouping puts large number of failing tests suites in a single group,\n-    # which ends up job timeouts. Temporarily relieve the timeout until we make progresses on the failing suites.\n-    # ref: https://github.com/vercel/turbo/pull/5668\n-    # timeout-minutes: 180\n-    runs-on:\n-      - 'self-hosted'\n-      - 'linux'\n-      - 'x64'\n-      - 'metal'\n-\n-    needs: [setup_nextjs]\n-    strategy:\n-      fail-fast: false\n-      matrix:\n-        group: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]\n-\n-    steps:\n-      - name: Setup Node.js\n-        uses: actions/setup-node@v4\n-        with:\n-          node-version: 18.18.2\n-          check-latest: true\n-      - uses: actions/cache/restore@v3\n-        id: restore-build\n-        with:\n-          path: ./*\n-          key: ${{ inputs.version || 'canary' }}-${{ github.sha }}-${{ github.run_id }}-${{ github.run_attempt}}-${{ github.run_number }}\n-          fail-on-cache-miss: true\n-\n-      - name: Enable corepack and install yarn\n-        run: |\n-          corepack enable\n-          corepack prepare --activate yarn@1.22.19\n-\n-      - name: Setup playwright\n-        run: |\n-          pnpm playwright install\n-\n-      - name: Run test/production\n-        run: |\n-          NEXT_TEST_MODE=start NEXT_RSPACK=1 NEXT_E2E_TEST_TIMEOUT=240000 node run-tests.js -g ${{ matrix.group }}/12 -c ${TEST_CONCURRENCY} --type production\n-        # It is currently expected to fail some of next.js integration test, do not fail CI check.\n-        continue-on-error: true\n-\n-      - name: Upload test report artifacts\n-        uses: actions/upload-artifact@v4\n-        with:\n-          name: test-reports-start-${{ matrix.group }}\n-          if-no-files-found: 'error'\n-          path: |\n-            test/rspack-test-junit-report\n-\n-  test-integration-production:\n-    name: Next.js integration test (Integration)\n-    needs: [setup_nextjs]\n-    runs-on:\n-      - 'self-hosted'\n-      - 'linux'\n-      - 'x64'\n-      - 'metal'\n-\n-    timeout-minutes: 180\n-    strategy:\n-      fail-fast: false\n-      matrix:\n-        group: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]\n-\n-    steps:\n-      - name: Setup Node.js\n-        uses: actions/setup-node@v4\n-        with:\n-          node-version: 18.18.2\n-          check-latest: true\n-      - uses: actions/cache/restore@v3\n-        id: restore-build\n-        with:\n-          path: ./*\n-          key: ${{ inputs.version || 'canary' }}-${{ github.sha }}\n-          fail-on-cache-miss: true\n-\n-      - name: Enable corepack and install yarn\n-        run: |\n-          corepack enable\n-          corepack prepare --activate yarn@1.22.19\n-\n-      - name: Setup playwright\n-        run: |\n-          pnpm playwright install\n-\n-      - name: Run test/integration\n-        run: |\n-          NEXT_RSPACK=1 NEXT_E2E_TEST_TIMEOUT=240000 node run-tests.js -g ${{ matrix.group }}/12 -c ${TEST_CONCURRENCY} --type integration\n-        continue-on-error: true\n-\n-      - name: Upload test report artifacts\n-        uses: actions/upload-artifact@v4\n-        with:\n-          name: test-reports-build-integration-${{ matrix.group }}\n-          if-no-files-found: 'error'\n-          path: |\n-            test/rspack-test-junit-report\n-\n-  # Collect integration test results from execute_tests,\n-  # Store it as github artifact for next step to consume.\n-  collect_nextjs_production_integration_stat:\n-    needs: [test-production, test-integration-production]\n-    name: Next.js integration test production status report\n-    runs-on:\n-      - 'self-hosted'\n-      - 'linux'\n-      - 'x64'\n-      - 'metal'\n-\n-    if: always()\n-    permissions:\n-      pull-requests: write\n-    steps:\n-      - name: Checkout\n-        uses: actions/checkout@v4\n-\n-      - name: Collect integration test stat\n-        uses: ./.github/actions/next-integration-stat\n-        with:\n-          diff_base: ${{ inputs.diff_base || 'none' }}\n-\n-      - name: Store artifacts\n-        uses: actions/upload-artifact@v4\n-        with:\n-          name: test-results-rspack-production\n-          path: |\n-            nextjs-test-results.json\n-            failed-test-path-list.json\n-            passed-test-path-list.json\n-\n-  upload_test_report:\n-    needs: [test-production, test-integration-production]\n-    name: Upload test report to datadog\n-    runs-on:\n-      - 'self-hosted'\n-      - 'linux'\n-      - 'x64'\n-      - 'metal'\n-\n-    if: ${{ !cancelled() }}\n-    steps:\n-      - name: Download test report artifacts\n-        id: download-test-reports\n-        uses: actions/download-artifact@v4\n-        with:\n-          pattern: test-reports-*\n-          path: test/reports\n-          merge-multiple: true\n-\n-      - name: Upload to datadog\n-        env:\n-          DATADOG_API_KEY: ${{ secrets.DATA_DOG_API_KEY }}\n-          DD_ENV: 'ci'\n-        run: |\n-          # We'll tag this to the \"rspack\" datadog service, not \"nextjs\"\n-          npx @datadog/datadog-ci@2.23.1 junit upload --tags test.type:rspack-build.daily --service rspack-build ./test/reports\n+      name: rspack-production\n+      test_type: production\n+      run_before_test: |\n+        export NEXT_RSPACK=1 \\\n+          NEXT_TEST_USE_RSPACK=1 \\\n+          BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN=1 \\\n+          BUILTIN_APP_LOADER=1 \\\n+          BUILTIN_SWC_LOADER=1\n+      # Failing tests take longer (due to timeouts and retries). Since we have\n+      # many failing tests, we need smaller groups and longer timeouts, in case\n+      # a group gets stuck with a cluster of failing tests.\n+      e2e_groups: 12\n+      integration_groups: 12\n+      e2e_timeout_minutes: 90\n+      integration_timeout_minutes: 90\n+      # Don't retry, instead of the default of twice, many of these tests are\n+      # currently failing, and it's wasteful to keep retrying them.\n+      num_retries: 0\n+    secrets: inherit"
        },
        {
            "sha": "956495d2e625f6e4539499c9e1cf63495c283df2",
            "filename": ".github/workflows/rspack-nextjs-dev-integration-tests.yml",
            "status": "modified",
            "additions": 25,
            "deletions": 205,
            "changes": 230,
            "blob_url": "https://github.com/vercel/next.js/blob/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Frspack-nextjs-dev-integration-tests.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Frspack-nextjs-dev-integration-tests.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Fworkflows%2Frspack-nextjs-dev-integration-tests.yml?ref=9ac41a44a9a6c2e281ff6c3add2c7e13521f5013",
            "patch": "@@ -1,212 +1,32 @@\n-# Reusable workflow to execute certain version of Next.js integration tests\n-# with Rspack.\n-#\n-# Refer test.yml for how this workflow is being initialized\n-# - Workflow can specify `inputs.version` to specify which version of next.js to use, otherwise will use latest release version.\n name: Rspack Next.js development integration tests\n \n on:\n   schedule:\n-    - cron: '0 6 * * *'\n-  workflow_dispatch:\n-    inputs:\n-      # Allow to specify Next.js version to run integration test against.\n-      # If not specified, will use latest release version including canary.\n-      version:\n-        description: Next.js version, sha, branch to test\n-        type: string\n-        default: 'canary'\n-      # The base of the test results to compare against. If not specified, will try to compare with latest main branch's test results.\n-      diff_base:\n-        type: string\n-        default: 'none'\n-\n-# Workflow-common env variables\n-env:\n-  # Enabling backtrace will makes snapshot tests fail\n-  RUST_BACKTRACE: 0\n-  NEXT_TELEMETRY_DISABLED: 1\n-  TEST_CONCURRENCY: 6\n-  NEXT_JUNIT_TEST_REPORT: 'true'\n-  __INTERNAL_CUSTOM_TURBOPACK_BINDINGS: ${{ github.workspace }}/packages/next-swc/native/next-swc.linux-x64-gnu.node\n-  NEXT_TEST_SKIP_RETRY_MANIFEST: ${{ github.workspace }}/integration-test-data/test-results/main/failed-test-path-list.json\n-  NEXT_TEST_CONTINUE_ON_ERROR: TRUE\n-  NEXT_E2E_TEST_TIMEOUT: 240000\n-  NEXT_TEST_JOB: 1\n+    # Run an hour earlier than the turbopack tests, so we don't overwhelm the CI\n+    - cron: '0 5 * * *'\n+  workflow_dispatch: {}\n \n jobs:\n-  # First, build next-dev and Next.js both to execute across tests.\n-  setup_nextjs:\n-    name: Setup Next.js build\n-    uses: ./.github/workflows/setup-nextjs-build.yml\n-    with:\n-      nodeVersion: 18.18.2\n-      version: ${{ inputs.version || 'canary' }}\n-\n-  # Actual test scheduling. These jobs mimic the same jobs in Next.js repo,\n-  # which we do allow some of duplications to make it easier to update if upstream changes.\n-  # Refer build_and_test.yml in the Next.js repo for more details.\n   test-dev:\n-    # This job name is being used in github action to collect test results. Do not change it, or should update\n-    # ./.github/actions/next-integration-stat to match the new name.\n-    name: Next.js integration test (Development)\n-    # Currently it is possible test grouping puts large number of failing tests suites in a single group,\n-    # which ends up job timeouts. Temporarily relieve the timeout until we make progresses on the failing suites.\n-    # ref: https://github.com/vercel/turbo/pull/5668\n-    # timeout-minutes: 180\n-    runs-on:\n-      - 'self-hosted'\n-      - 'linux'\n-      - 'x64'\n-      - 'metal'\n-\n-    needs: [setup_nextjs]\n-    strategy:\n-      fail-fast: false\n-      matrix:\n-        group: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]\n-\n-    steps:\n-      - name: Setup Node.js\n-        uses: actions/setup-node@v4\n-        with:\n-          node-version: 18.18.2\n-          check-latest: true\n-      - uses: actions/cache/restore@v3\n-        id: restore-build\n-        with:\n-          path: ./*\n-          key: ${{ inputs.version || 'canary' }}-${{ github.sha }}-${{ github.run_id }}-${{ github.run_attempt}}-${{ github.run_number }}\n-          fail-on-cache-miss: true\n-\n-      - name: Enable corepack and install yarn\n-        run: |\n-          corepack enable\n-          corepack prepare --activate yarn@1.22.19\n-\n-      - name: Setup playwright\n-        run: |\n-          pnpm playwright install\n-\n-      - name: Run test/development\n-        run: |\n-          NEXT_TEST_MODE=dev NEXT_RSPACK=1 NEXT_E2E_TEST_TIMEOUT=240000 node run-tests.js -g ${{ matrix.group }}/12 -c ${TEST_CONCURRENCY} --type development\n-        # It is currently expected to fail some of next.js integration test, do not fail CI check.\n-        continue-on-error: true\n-\n-      - name: Upload test report artifacts\n-        uses: actions/upload-artifact@v4\n-        with:\n-          name: test-reports-dev-${{ matrix.group }}\n-          if-no-files-found: 'error'\n-          path: |\n-            test/rspack-test-junit-report\n-\n-  test-integration-development:\n-    name: Next.js integration test (Integration)\n-    needs: [setup_nextjs]\n-    runs-on:\n-      - 'self-hosted'\n-      - 'linux'\n-      - 'x64'\n-      - 'metal'\n-\n-    timeout-minutes: 180\n-    strategy:\n-      fail-fast: false\n-      matrix:\n-        group: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]\n-\n-    steps:\n-      - name: Setup Node.js\n-        uses: actions/setup-node@v4\n-        with:\n-          node-version: 18.18.2\n-          check-latest: true\n-      - uses: actions/cache/restore@v3\n-        id: restore-build\n-        with:\n-          path: ./*\n-          key: ${{ inputs.version || 'canary' }}-${{ github.sha }}\n-          fail-on-cache-miss: true\n-\n-      - name: Enable corepack and install yarn\n-        run: |\n-          corepack enable\n-          corepack prepare --activate yarn@1.22.19\n-\n-      - name: Setup playwright\n-        run: |\n-          pnpm playwright install\n-\n-      - name: Run test/integration\n-        run: |\n-          NEXT_RSPACK=1 NEXT_E2E_TEST_TIMEOUT=240000 node run-tests.js -g ${{ matrix.group }}/12 -c ${TEST_CONCURRENCY} --type integration\n-        continue-on-error: true\n-\n-      - name: Upload test report artifacts\n-        uses: actions/upload-artifact@v4\n-        with:\n-          name: test-reports-dev-integration-${{ matrix.group }}\n-          if-no-files-found: 'error'\n-          path: |\n-            test/rspack-test-junit-report\n-\n-  # Collect integration test results from execute_tests,\n-  # Store it as github artifact for next step to consume.\n-  collect_nextjs_development_integration_stat:\n-    needs: [test-dev, test-integration-development]\n-    name: Next.js integration test development status report\n-    runs-on:\n-      - 'self-hosted'\n-      - 'linux'\n-      - 'x64'\n-      - 'metal'\n-\n-    if: always()\n-    permissions:\n-      pull-requests: write\n-    steps:\n-      - name: Checkout\n-        uses: actions/checkout@v4\n-\n-      - name: Collect integration test stat\n-        uses: ./.github/actions/next-integration-stat\n-        with:\n-          diff_base: ${{ inputs.diff_base || 'none' }}\n-\n-      - name: Store artifacts\n-        uses: actions/upload-artifact@v4\n-        with:\n-          name: test-results-rspack-development\n-          path: |\n-            nextjs-test-results.json\n-            failed-test-path-list.json\n-            passed-test-path-list.json\n-\n-  upload_test_report:\n-    needs: [test-dev, test-integration-development]\n-    name: Upload test report to datadog\n-    runs-on:\n-      - 'self-hosted'\n-      - 'linux'\n-      - 'x64'\n-      - 'metal'\n-\n-    if: ${{ !cancelled() }}\n-    steps:\n-      - name: Download test report artifacts\n-        id: download-test-reports\n-        uses: actions/download-artifact@v4\n-        with:\n-          pattern: test-reports-*\n-          path: test/reports\n-          merge-multiple: true\n-\n-      - name: Upload to datadog\n-        env:\n-          DATADOG_API_KEY: ${{ secrets.DATA_DOG_API_KEY }}\n-          DD_ENV: 'ci'\n-        run: |\n-          # We'll tag this to the \"rspack\" datadog service, not \"nextjs\"\n-          npx @datadog/datadog-ci@2.23.1 junit upload --tags test.type:rspack.daily --service rspack ./test/reports\n+    name: Rspack integration tests\n+    uses: ./.github/workflows/integration_tests_reusable.yml\n+    with:\n+      name: rspack-development\n+      test_type: development\n+      run_before_test: |\n+        export NEXT_RSPACK=1 \\\n+          NEXT_TEST_USE_RSPACK=1 \\\n+          BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN=1 \\\n+          BUILTIN_APP_LOADER=1 \\\n+          BUILTIN_SWC_LOADER=1\n+      # Failing tests take longer (due to timeouts and retries). Since we have\n+      # many failing tests, we need smaller groups and longer timeouts, in case\n+      # a group gets stuck with a cluster of failing tests.\n+      e2e_groups: 16\n+      integration_groups: 16\n+      e2e_timeout_minutes: 90\n+      integration_timeout_minutes: 90\n+      # Don't retry, instead of the default of twice, many of these tests are\n+      # currently failing, and it's wasteful to keep retrying them.\n+      num_retries: 0\n+    secrets: inherit"
        },
        {
            "sha": "37b67856ab469a63d661240ec3d26237e4d7ddbd",
            "filename": ".github/workflows/rspack-update-tests-manifest.yml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Frspack-update-tests-manifest.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Frspack-update-tests-manifest.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Fworkflows%2Frspack-update-tests-manifest.yml?ref=9ac41a44a9a6c2e281ff6c3add2c7e13521f5013",
            "patch": "@@ -3,7 +3,7 @@ name: Update Rspack test manifest\n \n on:\n   schedule:\n-    # Every day at 9AM https://crontab.guru/#0_9_*_*_*\n+    # Every day at 7AM https://crontab.guru/#0_7_*_*_*\n     - cron: '0 7 * * *'\n   workflow_dispatch:\n "
        },
        {
            "sha": "9495b2b3a4e50f6c4c6bdf0044505a69c19afb74",
            "filename": ".github/workflows/turbopack-update-tests-manifest.yml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Fturbopack-update-tests-manifest.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/.github%2Fworkflows%2Fturbopack-update-tests-manifest.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Fworkflows%2Fturbopack-update-tests-manifest.yml?ref=9ac41a44a9a6c2e281ff6c3add2c7e13521f5013",
            "patch": "@@ -3,7 +3,7 @@ name: Update Turbopack test manifest\n \n on:\n   schedule:\n-    # Every day at 9AM https://crontab.guru/#0_9_*_*_*\n+    # Every day at 7AM UTC https://crontab.guru/#0_7_*_*_*\n     - cron: '0 7 * * *'\n   workflow_dispatch:\n "
        },
        {
            "sha": "dc0f4672da42a44b0b7e153cd3897d61e3b4f067",
            "filename": "package.json",
            "status": "modified",
            "additions": 7,
            "deletions": 6,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/package.json",
            "raw_url": "https://github.com/vercel/next.js/raw/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/package.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/package.json?ref=9ac41a44a9a6c2e281ff6c3add2c7e13521f5013",
            "patch": "@@ -16,21 +16,21 @@\n     \"test-types\": \"tsc\",\n     \"test-unit\": \"jest test/unit/ packages/next/ packages/font\",\n     \"test-dev\": \"cross-env NEXT_TEST_MODE=dev pnpm testheadless\",\n-    \"test-dev-rspack\": \"cross-env NEXT_TEST_MODE=dev NEXT_TEST_USE_RSPACK=1 BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN=1 BUILTIN_APP_LOADER=1 BUILTIN_SWC_LOADER=1 pnpm testheadless\",\n+    \"test-dev-rspack\": \"pnpm run with-rspack pnpm run test-dev\",\n     \"test-dev-turbo\": \"cross-env NEXT_TEST_MODE=dev TURBOPACK=1 TURBOPACK_DEV=1 pnpm testheadless\",\n     \"test-start\": \"cross-env NEXT_TEST_MODE=start pnpm testheadless\",\n-    \"test-start-rspack\": \"cross-env NEXT_TEST_MODE=start NEXT_RSPACK=1 BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN=1 BUILTIN_APP_LOADER=1 BUILTIN_SWC_LOADER=1 pnpm testheadless\",\n+    \"test-start-rspack\": \"pnpm run with-rspack pnpm run test-start\",\n     \"test-start-turbo\": \"cross-env NEXT_TEST_MODE=start TURBOPACK=1 TURBOPACK_BUILD=1 pnpm testheadless\",\n     \"test-deploy\": \"cross-env NEXT_TEST_MODE=deploy pnpm testheadless\",\n     \"testonly-dev\": \"cross-env NEXT_TEST_MODE=dev pnpm testonly\",\n-    \"testonly-dev-rspack\": \"cross-env NEXT_TEST_MODE=dev  NEXT_RSPACK=1 pnpm testonly\",\n+    \"testonly-dev-rspack\": \"pnpm run with-rspack pnpm run testonly-dev\",\n     \"testonly-dev-turbo\": \"cross-env NEXT_TEST_MODE=dev TURBOPACK=1 TURBOPACK_DEV=1 pnpm testonly\",\n     \"testonly-start\": \"cross-env NEXT_TEST_MODE=start pnpm testonly\",\n-    \"testonly-start-rspack\": \"cross-env NEXT_TEST_MODE=start NEXT_RSPACK=1 pnpm testonly\",\n+    \"testonly-start-rspack\": \"pnpm run with-rspack pnpm run testonly-start\",\n     \"testonly-start-turbo\": \"cross-env NEXT_TEST_MODE=start TURBOPACK=1 TURBOPACK_BUILD=1 pnpm testonly\",\n     \"testonly-deploy\": \"cross-env NEXT_TEST_MODE=deploy pnpm testonly\",\n     \"test\": \"pnpm testheadless\",\n-    \"test-rspack\": \"cross-env NEXT_RSPACK=1 pnpm testheadless\",\n+    \"test-rspack\": \"pnpm run with-rspack pnpm run test\",\n     \"test-turbo\": \"cross-env TURBOPACK=1 TURBOPACK_DEV=1 TURBOPACK_BUILD=1 pnpm testheadless\",\n     \"testonly\": \"jest --runInBand\",\n     \"testheadless\": \"cross-env HEADLESS=true pnpm testonly\",\n@@ -76,7 +76,8 @@\n     \"update-error-codes\": \"cd packages/next && pnpm taskr compile check_error_codes\",\n     \"storybook\": \"turbo run storybook\",\n     \"build-storybook\": \"turbo run build-storybook\",\n-    \"test-storybook\": \"turbo run test-storybook\"\n+    \"test-storybook\": \"turbo run test-storybook\",\n+    \"with-rspack\": \"cross-env NEXT_RSPACK=1 NEXT_TEST_USE_RSPACK=1 BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN=1 BUILTIN_APP_LOADER=1 BUILTIN_SWC_LOADER=1\"\n   },\n   \"devDependencies\": {\n     \"@actions/core\": \"1.10.1\","
        },
        {
            "sha": "7b528d7480ff11928d05f4d655a3cc49b72ed648",
            "filename": "test/lib/create-next-install.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/test%2Flib%2Fcreate-next-install.js",
            "raw_url": "https://github.com/vercel/next.js/raw/9ac41a44a9a6c2e281ff6c3add2c7e13521f5013/test%2Flib%2Fcreate-next-install.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Flib%2Fcreate-next-install.js?ref=9ac41a44a9a6c2e281ff6c3add2c7e13521f5013",
            "patch": "@@ -134,7 +134,7 @@ async function createNextInstall({\n       }\n \n       if (useRspack) {\n-        combinedDependencies['@next/plugin-rspack'] = pkgPaths = pkgPaths.get(\n+        combinedDependencies['@next/plugin-rspack'] = pkgPaths.get(\n           '@next/plugin-rspack'\n         )\n       }"
        }
    ],
    "stats": {
        "total": 492,
        "additions": 69,
        "deletions": 423
    }
}