{
    "author": "devjiwonchoi",
    "message": "[dev-overlay] remove hide dev tools shortcut (#76066)\n\n### Why?\n\nSince it may conflict with other utils or the app's shortcuts, we\ndisable it until we find a good way to solve the issue.\n\n| Light | Dark |\n|--------|--------|\n| ![CleanShot 2025-02-15 at 06 31\n07](https://github.com/user-attachments/assets/8660d87b-8d21-47c5-b313-7a11f5ef195c)\n| ![CleanShot 2025-02-15 at 06 30\n05](https://github.com/user-attachments/assets/7d6c2e44-de8b-4d21-b567-2a2bc2aefb2f)\n|\n\nCloses NDX-835",
    "sha": "798f4ce8ced373a850ba201f35028b3f27d0d9df",
    "files": [
        {
            "sha": "a09c9aa77e2d31545f2e75c45f81f814bcf54aac",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/errors/dev-tools-indicator/dev-tools-indicator.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 41,
            "changes": 43,
            "blob_url": "https://github.com/vercel/next.js/blob/798f4ce8ced373a850ba201f35028b3f27d0d9df/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/798f4ce8ced373a850ba201f35028b3f27d0d9df/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx?ref=798f4ce8ced373a850ba201f35028b3f27d0d9df",
            "patch": "@@ -3,11 +3,9 @@ import type { OverlayState } from '../../../../../shared'\n \n import { useState, useEffect, useRef, createContext, useContext } from 'react'\n import { Toast } from '../../toast'\n-import { NextLogo } from './internal/next-logo'\n+import { Cross, NextLogo } from './internal/next-logo'\n import { useIsDevBuilding } from '../../../../../../../dev/dev-build-indicator/internal/initialize-for-new-overlay'\n import { useIsDevRendering } from './internal/dev-render-indicator'\n-import { useKeyboardShortcut } from '../../../hooks/use-keyboard-shortcut'\n-import { MODIFIERS } from '../../../hooks/use-keyboard-shortcut'\n import { useDelayedRender } from '../../../hooks/use-delayed-render'\n \n // TODO: add E2E tests to cover different scenarios\n@@ -22,15 +20,6 @@ export function DevToolsIndicator({\n   setIsErrorOverlayOpen: Dispatch<SetStateAction<boolean>>\n }) {\n   const [isDevToolsIndicatorOpen, setIsDevToolsIndicatorOpen] = useState(true)\n-  // Register `(cmd|ctrl) + .` to show/hide the error indicator.\n-  useKeyboardShortcut({\n-    key: '.',\n-    modifiers: [MODIFIERS.CTRL_CMD],\n-    callback: () => {\n-      setIsDevToolsIndicatorOpen(!isDevToolsIndicatorOpen)\n-      setIsErrorOverlayOpen(!isDevToolsIndicatorOpen)\n-    },\n-  })\n \n   return (\n     isDevToolsIndicatorOpen && (\n@@ -264,7 +253,7 @@ function DevToolsPopover({\n               <MenuItem\n                 data-hide-dev-tools\n                 label=\"Hide Dev Tools\"\n-                value={<HideShortcut />}\n+                value={<Cross color=\"var(--color-gray-900)\" />}\n                 onClick={hide}\n                 index={isTurbopack ? 1 : 2}\n               />\n@@ -343,34 +332,6 @@ function IssueCount({ children }: { children: number }) {\n   )\n }\n \n-function HideShortcut() {\n-  const isMac =\n-    // Feature detect for `navigator.userAgentData` which is experimental:\n-    // https://developer.mozilla.org/en-US/docs/Web/API/NavigatorUAData/platform\n-    'userAgentData' in navigator\n-      ? (navigator.userAgentData as any).platform === 'macOS'\n-      : // This is the least-bad option to detect the modifier key when using `navigator.platform`:\n-        // https://developer.mozilla.org/en-US/docs/Web/API/Navigator/platform#examples\n-        navigator.platform.indexOf('Mac') === 0 ||\n-        navigator.platform === 'iPhone'\n-\n-  return (\n-    <span className=\"shortcut\">\n-      {isMac ? (\n-        <kbd aria-label=\"Command\">âŒ˜</kbd>\n-      ) : (\n-        <kbd\n-          aria-label=\"Control\"\n-          style={{ width: 'fit-content', padding: '0 4px' }}\n-        >\n-          Ctrl\n-        </kbd>\n-      )}\n-      <kbd>.</kbd>\n-    </span>\n-  )\n-}\n-\n //////////////////////////////////////////////////////////////////////////////////////\n \n function useFocusTrap("
        },
        {
            "sha": "f920fb2c1ae1e5a67ccb1e5e882feb69c2f3ef37",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/errors/dev-tools-indicator/internal/next-logo.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/798f4ce8ced373a850ba201f35028b3f27d0d9df/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Finternal%2Fnext-logo.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/798f4ce8ced373a850ba201f35028b3f27d0d9df/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Finternal%2Fnext-logo.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Finternal%2Fnext-logo.tsx?ref=798f4ce8ced373a850ba201f35028b3f27d0d9df",
            "patch": "@@ -454,7 +454,7 @@ export const NextLogo = forwardRef(function NextLogo(\n                   triggerRef.current?.focus()\n                 }}\n               >\n-                <Cross />\n+                <Cross data-cross />\n               </button>\n             </div>\n           )}\n@@ -569,15 +569,15 @@ function NextMark({ isLoading }: { isLoading?: boolean }) {\n   )\n }\n \n-function Cross() {\n+export function Cross(props: React.SVGProps<SVGSVGElement>) {\n   return (\n     <svg\n-      data-cross\n       width=\"12\"\n       height=\"12\"\n       viewBox=\"0 0 14 14\"\n       fill=\"none\"\n       xmlns=\"http://www.w3.org/2000/svg\"\n+      {...props}\n     >\n       <path\n         fillRule=\"evenodd\""
        },
        {
            "sha": "37d8215e6b4ba9bcdd6563a9eac7cbb797faf50f",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/hooks/use-keyboard-shortcut.test.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 133,
            "changes": 133,
            "blob_url": "https://github.com/vercel/next.js/blob/a79950dc8c3b543fbc40a8e9e90d840b59e435cd/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fhooks%2Fuse-keyboard-shortcut.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/a79950dc8c3b543fbc40a8e9e90d840b59e435cd/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fhooks%2Fuse-keyboard-shortcut.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fhooks%2Fuse-keyboard-shortcut.test.ts?ref=a79950dc8c3b543fbc40a8e9e90d840b59e435cd",
            "patch": "@@ -1,133 +0,0 @@\n-/**\n- * @jest-environment jsdom\n- */\n-/* eslint-disable import/no-extraneous-dependencies */\n-import { renderHook } from '@testing-library/react'\n-import { useKeyboardShortcut } from './use-keyboard-shortcut'\n-import { MODIFIERS } from './use-keyboard-shortcut'\n-\n-describe('useKeyboardShortcut', () => {\n-  let addEventListenerSpy: jest.SpyInstance\n-  let removeEventListenerSpy: jest.SpyInstance\n-\n-  beforeEach(() => {\n-    addEventListenerSpy = jest.spyOn(window, 'addEventListener')\n-    removeEventListenerSpy = jest.spyOn(window, 'removeEventListener')\n-  })\n-\n-  afterEach(() => {\n-    jest.clearAllMocks()\n-  })\n-\n-  it('should add and remove event listener', () => {\n-    const callback = jest.fn()\n-    const { unmount } = renderHook(() =>\n-      useKeyboardShortcut({\n-        key: 'k',\n-        callback,\n-        modifiers: [MODIFIERS.CTRL_CMD],\n-      })\n-    )\n-\n-    // When used `expect.any(Function)`, received:\n-    // error TS21228: [ban-function-calls] Constructing functions from strings can lead to XSS.\n-    const eventListener = addEventListenerSpy.mock.calls[0][1]\n-    expect(typeof eventListener).toBe('function')\n-    expect(addEventListenerSpy).toHaveBeenCalledWith('keydown', eventListener)\n-\n-    unmount()\n-    expect(removeEventListenerSpy).toHaveBeenCalled()\n-  })\n-\n-  it('should trigger callback when correct key and modifier are pressed', () => {\n-    const callback = jest.fn()\n-    renderHook(() =>\n-      useKeyboardShortcut({\n-        key: 'k',\n-        callback,\n-        modifiers: [MODIFIERS.CTRL_CMD],\n-      })\n-    )\n-\n-    // Simulate keydown event with Cmd/Ctrl + K\n-    window.dispatchEvent(\n-      new KeyboardEvent('keydown', {\n-        key: 'k',\n-        metaKey: true,\n-      })\n-    )\n-\n-    expect(callback).toHaveBeenCalledTimes(1)\n-  })\n-\n-  it('should work with multiple modifiers', () => {\n-    const callback = jest.fn()\n-    renderHook(() =>\n-      useKeyboardShortcut({\n-        key: 'k',\n-        callback,\n-        modifiers: [MODIFIERS.CTRL_CMD, MODIFIERS.SHIFT],\n-      })\n-    )\n-\n-    // Should not trigger with just Cmd/Ctrl\n-    window.dispatchEvent(\n-      new KeyboardEvent('keydown', {\n-        key: 'k',\n-        metaKey: true,\n-      })\n-    )\n-    expect(callback).not.toHaveBeenCalled()\n-\n-    // Should trigger with Cmd/Ctrl + Shift\n-    window.dispatchEvent(\n-      new KeyboardEvent('keydown', {\n-        key: 'k',\n-        metaKey: true,\n-        shiftKey: true,\n-      })\n-    )\n-    expect(callback).toHaveBeenCalledTimes(1)\n-  })\n-\n-  it('should be case insensitive', () => {\n-    const callback = jest.fn()\n-    renderHook(() =>\n-      useKeyboardShortcut({\n-        key: 'k',\n-        callback,\n-        modifiers: [MODIFIERS.CTRL_CMD],\n-      })\n-    )\n-\n-    window.dispatchEvent(\n-      new KeyboardEvent('keydown', {\n-        key: 'K', // uppercase\n-        metaKey: true,\n-      })\n-    )\n-\n-    expect(callback).toHaveBeenCalledTimes(1)\n-  })\n-\n-  it('should prevent default event behavior', () => {\n-    const callback = jest.fn()\n-    renderHook(() =>\n-      useKeyboardShortcut({\n-        key: 'k',\n-        callback,\n-        modifiers: [MODIFIERS.CTRL_CMD],\n-      })\n-    )\n-\n-    const event = new KeyboardEvent('keydown', {\n-      key: 'k',\n-      metaKey: true,\n-    })\n-    const preventDefaultSpy = jest.spyOn(event, 'preventDefault')\n-\n-    window.dispatchEvent(event)\n-\n-    expect(preventDefaultSpy).toHaveBeenCalled()\n-  })\n-})"
        },
        {
            "sha": "56ce335029325922407ddb6ff0a417a69a64246e",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/hooks/use-keyboard-shortcut.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 44,
            "changes": 44,
            "blob_url": "https://github.com/vercel/next.js/blob/a79950dc8c3b543fbc40a8e9e90d840b59e435cd/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fhooks%2Fuse-keyboard-shortcut.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/a79950dc8c3b543fbc40a8e9e90d840b59e435cd/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fhooks%2Fuse-keyboard-shortcut.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fhooks%2Fuse-keyboard-shortcut.ts?ref=a79950dc8c3b543fbc40a8e9e90d840b59e435cd",
            "patch": "@@ -1,44 +0,0 @@\n-import { useEffect } from 'react'\n-\n-export const MODIFIERS = {\n-  CTRL_CMD: 'CTRL_CMD',\n-  ALT: 'ALT',\n-  SHIFT: 'SHIFT',\n-} as const\n-\n-type KeyboardShortcutProps = {\n-  key: string\n-  callback: () => void\n-  modifiers: (typeof MODIFIERS)[keyof typeof MODIFIERS][]\n-}\n-\n-export function useKeyboardShortcut({\n-  key,\n-  callback,\n-  modifiers,\n-}: KeyboardShortcutProps) {\n-  useEffect(() => {\n-    const handleKeyDown = (e: KeyboardEvent) => {\n-      const modifiersPressed = modifiers.every((modifier) => {\n-        switch (modifier) {\n-          case MODIFIERS.CTRL_CMD:\n-            return e.metaKey || e.ctrlKey\n-          case MODIFIERS.ALT:\n-            return e.altKey\n-          case MODIFIERS.SHIFT:\n-            return e.shiftKey\n-          default:\n-            return false\n-        }\n-      })\n-\n-      if (modifiersPressed && e.key.toLowerCase() === key.toLowerCase()) {\n-        e.preventDefault()\n-        callback()\n-      }\n-    }\n-\n-    window.addEventListener('keydown', handleKeyDown)\n-    return () => window.removeEventListener('keydown', handleKeyDown)\n-  }, [key, callback, modifiers])\n-}"
        }
    ],
    "stats": {
        "total": 226,
        "additions": 5,
        "deletions": 221
    }
}