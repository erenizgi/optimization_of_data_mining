{
    "author": "eps1lon",
    "message": "Reflect runtime type of `resHeaders` in static types (#87145)",
    "sha": "f754a00c1ec00c95e531474aa25e1c1070dc3df0",
    "files": [
        {
            "sha": "18e1c4223fdb95e63ee2f5a09cd622ea726f7662",
            "filename": "packages/next/src/server/lib/router-server.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/f754a00c1ec00c95e531474aa25e1c1070dc3df0/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/f754a00c1ec00c95e531474aa25e1c1070dc3df0/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-server.ts?ref=f754a00c1ec00c95e531474aa25e1c1070dc3df0",
            "patch": "@@ -414,7 +414,7 @@ export async function initialize(opts: {\n           req.url = removePathPrefix(origUrl, config.assetPrefix)\n         }\n \n-        if (resHeaders) {\n+        if (resHeaders !== null) {\n           for (const key of Object.keys(resHeaders)) {\n             res.setHeader(key, resHeaders[key])\n           }\n@@ -441,8 +441,10 @@ export async function initialize(opts: {\n       })\n \n       // apply any response headers from routing\n-      for (const key of Object.keys(resHeaders || {})) {\n-        res.setHeader(key, resHeaders[key])\n+      if (resHeaders !== null) {\n+        for (const key of Object.keys(resHeaders)) {\n+          res.setHeader(key, resHeaders[key])\n+        }\n       }\n \n       // handle redirect"
        },
        {
            "sha": "3bf3ff5653d47d0690f4486a8b73587f20de56d1",
            "filename": "packages/next/src/server/lib/router-utils/resolve-routes.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/f754a00c1ec00c95e531474aa25e1c1070dc3df0/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fresolve-routes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/f754a00c1ec00c95e531474aa25e1c1070dc3df0/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fresolve-routes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fresolve-routes.ts?ref=f754a00c1ec00c95e531474aa25e1c1070dc3df0",
            "patch": "@@ -117,7 +117,7 @@ export function getResolveRoutes(\n     finished: boolean\n     statusCode?: number\n     bodyStream?: ReadableStream | null\n-    resHeaders: Record<string, string | string[]>\n+    resHeaders: Record<string, string | string[]> | null\n     parsedUrl: NextUrlWithParsedQuery\n     matchedOutput?: FsOutput | null\n   }> {\n@@ -752,10 +752,12 @@ export function getResolveRoutes(\n             parsedDestination.pathname\n           )\n \n+          // @ts-expect-error // custom ParsedUrl\n+          const unsafeParsedUrl: NextUrlWithParsedQuery = parsedDestination\n           return {\n             finished: true,\n-            // @ts-expect-error custom ParsedUrl\n-            parsedUrl: parsedDestination,\n+            parsedUrl: unsafeParsedUrl,\n+            resHeaders: null,\n             statusCode: getRedirectStatus(route),\n           }\n         }\n@@ -826,9 +828,11 @@ export function getResolveRoutes(\n           }\n \n           if (parsedDestination.protocol) {\n+            // @ts-expect-error // custom ParsedUrl\n+            const unsafeParsedUrl: NextUrlWithParsedQuery = parsedDestination\n             return {\n-              // @ts-expect-error custom ParsedUrl\n-              parsedUrl: parsedDestination,\n+              parsedUrl: unsafeParsedUrl,\n+              resHeaders: null,\n               finished: true,\n             }\n           }"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 14,
        "deletions": 8
    }
}