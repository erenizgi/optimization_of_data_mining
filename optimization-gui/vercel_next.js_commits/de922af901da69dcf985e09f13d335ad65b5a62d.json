{
    "author": "ztanner",
    "message": "[dev-overlay]: generalize ISR status functions for pages/app (#76457)\n\nThis renames the functions associated with setting the ISR status (used for the static indicator in the error overlay) to be more generic, in preparation for it being used by pages router.",
    "sha": "de922af901da69dcf985e09f13d335ad65b5a62d",
    "files": [
        {
            "sha": "1670cca42e6cfdbf375b3ed8c46584b187d73ff7",
            "filename": "packages/next/src/client/components/react-dev-overlay/app/hot-reloader-client.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fhot-reloader-client.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fhot-reloader-client.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fapp%2Fhot-reloader-client.tsx?ref=de922af901da69dcf985e09f13d335ad65b5a62d",
            "patch": "@@ -340,7 +340,7 @@ function processMessage(\n   }\n \n   switch (obj.action) {\n-    case HMR_ACTIONS_SENT_TO_BROWSER.APP_ISR_MANIFEST: {\n+    case HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST: {\n       if (process.env.__NEXT_DEV_INDICATOR) {\n         if (appIsrManifestRef) {\n           appIsrManifestRef.current = obj.data"
        },
        {
            "sha": "377330a38d42e56a196694bcf9c6908dccb20bca",
            "filename": "packages/next/src/client/dev/hot-middleware-client.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-middleware-client.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-middleware-client.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-middleware-client.ts?ref=de922af901da69dcf985e09f13d335ad65b5a62d",
            "patch": "@@ -90,7 +90,7 @@ export default (mode: 'webpack' | 'turbopack') => {\n       }\n       case 'serverError':\n       case 'devPagesManifestUpdate':\n-      case 'appIsrManifest':\n+      case 'isrManifest':\n       case 'building':\n       case 'finishBuilding': {\n         return"
        },
        {
            "sha": "ffd8b82037eec6be98cbcdf00bb532f5b02ae4e6",
            "filename": "packages/next/src/server/app-render/app-render.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx?ref=de922af901da69dcf985e09f13d335ad65b5a62d",
            "patch": "@@ -1211,7 +1211,7 @@ async function renderToHTMLOrFlightImpl(\n   if (process.env.NODE_ENV === 'development') {\n     // reset isr status at start of request\n     const { pathname } = new URL(req.url || '/', 'http://n')\n-    renderOpts.setAppIsrStatus?.(pathname, null)\n+    renderOpts.setIsrStatus?.(pathname, null)\n   }\n \n   if (\n@@ -1473,19 +1473,19 @@ async function renderToHTMLOrFlightImpl(\n \n     if (\n       process.env.NODE_ENV === 'development' &&\n-      renderOpts.setAppIsrStatus &&\n+      renderOpts.setIsrStatus &&\n       // The type check here ensures that `req` is correctly typed, and the\n       // environment variable check provides dead code elimination.\n       process.env.NEXT_RUNTIME !== 'edge' &&\n       isNodeNextRequest(req) &&\n       !isDevWarmupRequest\n     ) {\n-      const setAppIsrStatus = renderOpts.setAppIsrStatus\n+      const setIsrStatus = renderOpts.setIsrStatus\n       req.originalRequest.on('end', () => {\n         if (!requestStore.usedDynamic && !workStore.forceDynamic) {\n           // only node can be ISR so we only need to update the status here\n           const { pathname } = new URL(req.url || '/', 'http://n')\n-          setAppIsrStatus(pathname, true)\n+          setIsrStatus(pathname, true)\n         }\n       })\n     }"
        },
        {
            "sha": "05a82d1e69fd1675a92232d7512d81be9ae759c8",
            "filename": "packages/next/src/server/app-render/types.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts?ref=de922af901da69dcf985e09f13d335ad65b5a62d",
            "patch": "@@ -183,7 +183,7 @@ export interface RenderOptsPartial {\n   cacheLifeProfiles?: {\n     [profile: string]: import('../use-cache/cache-life').CacheLife\n   }\n-  setAppIsrStatus?: (key: string, value: boolean | null) => void\n+  setIsrStatus?: (key: string, value: boolean | null) => void\n   isRevalidate?: boolean\n   nextExport?: boolean\n   nextConfigOutput?: 'standalone' | 'export'"
        },
        {
            "sha": "f4a75b63dce1255a84116c707de0d7181ec45c67",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=de922af901da69dcf985e09f13d335ad65b5a62d",
            "patch": "@@ -2535,7 +2535,7 @@ export default abstract class Server<\n         onClose: res.onClose.bind(res),\n         onAfterTaskError: undefined,\n         // only available in dev\n-        setAppIsrStatus: (this as any).setAppIsrStatus,\n+        setIsrStatus: (this as any).setIsrStatus,\n       }\n \n       if (isDebugStaticShell || isDebugDynamicAccesses) {"
        },
        {
            "sha": "4899b7251be40e158fd8ab4c827b497903ad592f",
            "filename": "packages/next/src/server/dev/hot-reloader-types.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-types.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-types.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-types.ts?ref=de922af901da69dcf985e09f13d335ad65b5a62d",
            "patch": "@@ -23,7 +23,7 @@ export const enum HMR_ACTIONS_SENT_TO_BROWSER {\n   TURBOPACK_MESSAGE = 'turbopack-message',\n   SERVER_ERROR = 'serverError',\n   TURBOPACK_CONNECTED = 'turbopack-connected',\n-  APP_ISR_MANIFEST = 'appIsrManifest',\n+  ISR_MANIFEST = 'isrManifest',\n }\n \n interface ServerErrorAction {\n@@ -112,7 +112,7 @@ export interface TurbopackConnectedAction {\n }\n \n export interface AppIsrManifestAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.APP_ISR_MANIFEST\n+  action: HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST\n   data: Record<string, boolean>\n }\n "
        },
        {
            "sha": "e3ef7174b2a0bbcd1f5f1f0534bc3f2470710728",
            "filename": "packages/next/src/server/lib/dev-bundler-service.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fdev-bundler-service.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fdev-bundler-service.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fdev-bundler-service.ts?ref=de922af901da69dcf985e09f13d335ad65b5a62d",
            "patch": "@@ -93,14 +93,14 @@ export class DevBundlerService {\n     return serializableManifest\n   }\n \n-  public setAppIsrStatus(key: string, value: boolean | null) {\n+  public setIsrStatus(key: string, value: boolean | null) {\n     if (value === null) {\n       this.appIsrManifestInner.remove(key)\n     } else {\n       this.appIsrManifestInner.set(key, value)\n     }\n     this.bundler?.hotReloader?.send({\n-      action: HMR_ACTIONS_SENT_TO_BROWSER.APP_ISR_MANIFEST,\n+      action: HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST,\n       data: this.appIsrManifest,\n     })\n   }"
        },
        {
            "sha": "bb6710dbe6bc0fb04810df5935bc315b76dd1bfa",
            "filename": "packages/next/src/server/lib/router-server.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-server.ts?ref=de922af901da69dcf985e09f13d335ad65b5a62d",
            "patch": "@@ -625,8 +625,7 @@ export async function initialize(opts: {\n     server: opts.server,\n     serverFields: {\n       ...(developmentBundler?.serverFields || {}),\n-      setAppIsrStatus:\n-        devBundlerService?.setAppIsrStatus.bind(devBundlerService),\n+      setIsrStatus: devBundlerService?.setIsrStatus.bind(devBundlerService),\n     } satisfies ServerFields,\n     experimentalTestProxy: !!config.experimental.testProxy,\n     experimentalHttpsServer: !!opts.experimentalHttpsServer,\n@@ -710,7 +709,7 @@ export async function initialize(opts: {\n             (client) => {\n               client.send(\n                 JSON.stringify({\n-                  action: HMR_ACTIONS_SENT_TO_BROWSER.APP_ISR_MANIFEST,\n+                  action: HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST,\n                   data: devBundlerService?.appIsrManifest || {},\n                 } satisfies AppIsrManifestAction)\n               )"
        },
        {
            "sha": "7ee30336222e8b3f7efb4178c6a5d6b48fb1ef04",
            "filename": "packages/next/src/server/lib/router-utils/setup-dev-bundler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/de922af901da69dcf985e09f13d335ad65b5a62d/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts?ref=de922af901da69dcf985e09f13d335ad65b5a62d",
            "patch": "@@ -109,7 +109,7 @@ export type ServerFields = {\n   interceptionRoutes?: ReturnType<\n     typeof import('./filesystem').buildCustomRoute\n   >[]\n-  setAppIsrStatus?: (key: string, value: boolean) => void\n+  setIsrStatus?: (key: string, value: boolean) => void\n   resetFetch?: () => void\n }\n "
        }
    ],
    "stats": {
        "total": 31,
        "additions": 15,
        "deletions": 16
    }
}