{
    "author": "mischnic",
    "message": "Turbopack: remove unused transforms (#83567)\n\n- `next_shared/transforms/next_shake_exports.rs`: dead code\n- `turbopack-ecmascript-plugins/src/transform/modularize_imports.rs`: dead code\n- `next_shared/transforms/next_page_config.rs`: amp, unsupported anyway\n- `next_shared/transforms/next_amp_attributes.rs`: amp, unsupported anyway\n\nSee also https://nextjs.org/blog/next-15-5#amp-support",
    "sha": "ae2e3e25bf250fb00d2a51c6d9b1477063518c37",
    "files": [
        {
            "sha": "e25185a6beb76702fd31b7935790e60975563c29",
            "filename": "Cargo.lock",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/Cargo.lock",
            "raw_url": "https://github.com/vercel/next.js/raw/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/Cargo.lock",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.lock?ref=ae2e3e25bf250fb00d2a51c6d9b1477063518c37",
            "patch": "@@ -9778,7 +9778,6 @@ dependencies = [\n  \"anyhow\",\n  \"async-trait\",\n  \"indexmap 2.9.0\",\n- \"modularize_imports\",\n  \"rustc-hash 2.1.1\",\n  \"serde\",\n  \"serde_json\","
        },
        {
            "sha": "b7bf6ec59c7575d1bab5903df2c24ecb08a0d918",
            "filename": "crates/next-core/src/next_client/transforms.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 10,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/crates%2Fnext-core%2Fsrc%2Fnext_client%2Ftransforms.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/crates%2Fnext-core%2Fsrc%2Fnext_client%2Ftransforms.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_client%2Ftransforms.rs?ref=ae2e3e25bf250fb00d2a51c6d9b1477063518c37",
            "patch": "@@ -12,11 +12,9 @@ use crate::{\n         debug_fn_name::get_debug_fn_name_rule, get_next_dynamic_transform_rule,\n         get_next_font_transform_rule, get_next_image_rule, get_next_lint_transform_rule,\n         get_next_modularize_imports_rule, get_next_pages_transforms_rule,\n-        get_server_actions_transform_rule, next_amp_attributes::get_next_amp_attr_rule,\n-        next_cjs_optimizer::get_next_cjs_optimizer_rule,\n+        get_server_actions_transform_rule, next_cjs_optimizer::get_next_cjs_optimizer_rule,\n         next_disallow_re_export_all_in_page::get_next_disallow_export_all_in_page_rule,\n-        next_page_config::get_next_page_config_rule, next_pure::get_next_pure_rule,\n-        server_actions::ActionsTransform,\n+        next_pure::get_next_pure_rule, server_actions::ActionsTransform,\n     },\n };\n \n@@ -68,11 +66,6 @@ pub async fn get_next_client_transforms_rules(\n                     enable_mdx_rs,\n                     pages_dir.clone(),\n                 ));\n-                rules.push(get_next_page_config_rule(\n-                    is_development,\n-                    enable_mdx_rs,\n-                    pages_dir.clone(),\n-                ));\n             }\n         }\n         ClientContextType::App { .. } => {\n@@ -93,7 +86,6 @@ pub async fn get_next_client_transforms_rules(\n     };\n \n     if !foreign_code {\n-        rules.push(get_next_amp_attr_rule(enable_mdx_rs));\n         rules.push(get_next_cjs_optimizer_rule(enable_mdx_rs));\n         rules.push(get_next_pure_rule(enable_mdx_rs));\n "
        },
        {
            "sha": "aafc57b504828c7497b4edea93f994928b0393aa",
            "filename": "crates/next-core/src/next_server/transforms.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/crates%2Fnext-core%2Fsrc%2Fnext_server%2Ftransforms.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/crates%2Fnext-core%2Fsrc%2Fnext_server%2Ftransforms.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_server%2Ftransforms.rs?ref=ae2e3e25bf250fb00d2a51c6d9b1477063518c37",
            "patch": "@@ -13,8 +13,7 @@ use crate::{\n         get_next_dynamic_transform_rule, get_next_font_transform_rule, get_next_image_rule,\n         get_next_lint_transform_rule, get_next_modularize_imports_rule,\n         get_next_pages_transforms_rule, get_next_track_dynamic_imports_transform_rule,\n-        get_server_actions_transform_rule, next_amp_attributes::get_next_amp_attr_rule,\n-        next_cjs_optimizer::get_next_cjs_optimizer_rule,\n+        get_server_actions_transform_rule, next_cjs_optimizer::get_next_cjs_optimizer_rule,\n         next_disallow_re_export_all_in_page::get_next_disallow_export_all_in_page_rule,\n         next_edge_node_api_assert::next_edge_node_api_assert,\n         next_middleware_dynamic_assert::get_middleware_dynamic_assert_rule,\n@@ -167,7 +166,6 @@ pub async fn get_next_server_transforms_rules(\n                 .await?,\n         );\n \n-        rules.push(get_next_amp_attr_rule(mdx_rs));\n         rules.push(get_next_cjs_optimizer_rule(mdx_rs));\n         rules.push(get_next_pure_rule(mdx_rs));\n "
        },
        {
            "sha": "66c8dcb6fc354e93250a70808dad1b0367b91ea2",
            "filename": "crates/next-core/src/next_shared/transforms/mod.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fmod.rs?ref=ae2e3e25bf250fb00d2a51c6d9b1477063518c37",
            "patch": "@@ -1,7 +1,6 @@\n pub(crate) mod debug_fn_name;\n pub(crate) mod emotion;\n pub(crate) mod modularize_imports;\n-pub(crate) mod next_amp_attributes;\n pub(crate) mod next_cjs_optimizer;\n pub(crate) mod next_disallow_re_export_all_in_page;\n pub(crate) mod next_dynamic;\n@@ -10,10 +9,8 @@ pub(crate) mod next_font;\n pub(crate) mod next_lint;\n pub(crate) mod next_middleware_dynamic_assert;\n pub(crate) mod next_optimize_server_react;\n-pub(crate) mod next_page_config;\n pub(crate) mod next_pure;\n pub(crate) mod next_react_server_components;\n-pub(crate) mod next_shake_exports;\n pub(crate) mod next_strip_page_exports;\n pub(crate) mod next_track_dynamic_imports;\n pub(crate) mod react_remove_properties;"
        },
        {
            "sha": "3d0128750d4ff61c4aa51d2584ae303f22756a70",
            "filename": "crates/next-core/src/next_shared/transforms/next_amp_attributes.rs",
            "status": "removed",
            "additions": 0,
            "deletions": 34,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/2d37f0702c7ce8d5b21035dd48597d835e521f83/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fnext_amp_attributes.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2d37f0702c7ce8d5b21035dd48597d835e521f83/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fnext_amp_attributes.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fnext_amp_attributes.rs?ref=2d37f0702c7ce8d5b21035dd48597d835e521f83",
            "patch": "@@ -1,34 +0,0 @@\n-use anyhow::Result;\n-use async_trait::async_trait;\n-use next_custom_transforms::transforms::amp_attributes::amp_attributes;\n-use swc_core::ecma::ast::*;\n-use turbo_tasks::ResolvedVc;\n-use turbopack::module_options::{ModuleRule, ModuleRuleEffect};\n-use turbopack_ecmascript::{CustomTransformer, EcmascriptInputTransform, TransformContext};\n-\n-use super::module_rule_match_js_no_url;\n-\n-pub fn get_next_amp_attr_rule(enable_mdx_rs: bool) -> ModuleRule {\n-    let transformer =\n-        EcmascriptInputTransform::Plugin(ResolvedVc::cell(Box::new(NextAmpAttributes {}) as _));\n-    ModuleRule::new(\n-        module_rule_match_js_no_url(enable_mdx_rs),\n-        vec![ModuleRuleEffect::ExtendEcmascriptTransforms {\n-            preprocess: ResolvedVc::cell(vec![]),\n-            main: ResolvedVc::cell(vec![transformer]),\n-            postprocess: ResolvedVc::cell(vec![]),\n-        }],\n-    )\n-}\n-\n-#[derive(Debug)]\n-struct NextAmpAttributes {}\n-\n-#[async_trait]\n-impl CustomTransformer for NextAmpAttributes {\n-    #[tracing::instrument(level = tracing::Level::TRACE, name = \"next_amp\", skip_all)]\n-    async fn transform(&self, program: &mut Program, _ctx: &TransformContext<'_>) -> Result<()> {\n-        program.mutate(amp_attributes());\n-        Ok(())\n-    }\n-}"
        },
        {
            "sha": "69c0c9f77d1e474eef36f8d8d7e6b29db3a80fa3",
            "filename": "crates/next-core/src/next_shared/transforms/next_page_config.rs",
            "status": "removed",
            "additions": 0,
            "deletions": 42,
            "changes": 42,
            "blob_url": "https://github.com/vercel/next.js/blob/2d37f0702c7ce8d5b21035dd48597d835e521f83/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fnext_page_config.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2d37f0702c7ce8d5b21035dd48597d835e521f83/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fnext_page_config.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fnext_page_config.rs?ref=2d37f0702c7ce8d5b21035dd48597d835e521f83",
            "patch": "@@ -1,42 +0,0 @@\n-use anyhow::Result;\n-use async_trait::async_trait;\n-use next_custom_transforms::transforms::page_config::page_config;\n-use swc_core::ecma::ast::*;\n-use turbo_tasks::ResolvedVc;\n-use turbo_tasks_fs::FileSystemPath;\n-use turbopack::module_options::{ModuleRule, ModuleRuleEffect};\n-use turbopack_ecmascript::{CustomTransformer, EcmascriptInputTransform, TransformContext};\n-\n-use super::module_rule_match_pages_page_file;\n-\n-pub fn get_next_page_config_rule(\n-    is_development: bool,\n-    enable_mdx_rs: bool,\n-    pages_dir: FileSystemPath,\n-) -> ModuleRule {\n-    let transformer = EcmascriptInputTransform::Plugin(ResolvedVc::cell(Box::new(NextPageConfig {\n-        is_development,\n-    }) as _));\n-    ModuleRule::new(\n-        module_rule_match_pages_page_file(enable_mdx_rs, pages_dir),\n-        vec![ModuleRuleEffect::ExtendEcmascriptTransforms {\n-            preprocess: ResolvedVc::cell(vec![]),\n-            main: ResolvedVc::cell(vec![]),\n-            postprocess: ResolvedVc::cell(vec![transformer]),\n-        }],\n-    )\n-}\n-\n-#[derive(Debug)]\n-struct NextPageConfig {\n-    is_development: bool,\n-}\n-\n-#[async_trait]\n-impl CustomTransformer for NextPageConfig {\n-    #[tracing::instrument(level = tracing::Level::TRACE, name = \"next_page_config\", skip_all)]\n-    async fn transform(&self, program: &mut Program, _ctx: &TransformContext<'_>) -> Result<()> {\n-        program.mutate(page_config(self.is_development, true));\n-        Ok(())\n-    }\n-}"
        },
        {
            "sha": "9a1bc958bfb94feffaa99e69f292d6e5d306dc28",
            "filename": "crates/next-core/src/next_shared/transforms/next_shake_exports.rs",
            "status": "removed",
            "additions": 0,
            "deletions": 40,
            "changes": 40,
            "blob_url": "https://github.com/vercel/next.js/blob/2d37f0702c7ce8d5b21035dd48597d835e521f83/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fnext_shake_exports.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2d37f0702c7ce8d5b21035dd48597d835e521f83/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fnext_shake_exports.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_shared%2Ftransforms%2Fnext_shake_exports.rs?ref=2d37f0702c7ce8d5b21035dd48597d835e521f83",
            "patch": "@@ -1,40 +0,0 @@\n-use anyhow::Result;\n-use async_trait::async_trait;\n-use next_custom_transforms::transforms::shake_exports::{Config, shake_exports};\n-use swc_core::ecma::ast::*;\n-use turbo_tasks::ResolvedVc;\n-use turbopack::module_options::{ModuleRule, ModuleRuleEffect};\n-use turbopack_ecmascript::{CustomTransformer, EcmascriptInputTransform, TransformContext};\n-\n-use super::module_rule_match_js_no_url;\n-\n-#[allow(dead_code)]\n-pub fn get_next_shake_exports_rule(enable_mdx_rs: bool, ignore: Vec<String>) -> ModuleRule {\n-    let transformer = EcmascriptInputTransform::Plugin(ResolvedVc::cell(\n-        Box::new(NextShakeExports { ignore }) as _,\n-    ));\n-    ModuleRule::new(\n-        module_rule_match_js_no_url(enable_mdx_rs),\n-        vec![ModuleRuleEffect::ExtendEcmascriptTransforms {\n-            preprocess: ResolvedVc::cell(vec![]),\n-            main: ResolvedVc::cell(vec![]),\n-            postprocess: ResolvedVc::cell(vec![transformer]),\n-        }],\n-    )\n-}\n-\n-#[derive(Debug)]\n-struct NextShakeExports {\n-    ignore: Vec<String>,\n-}\n-\n-#[async_trait]\n-impl CustomTransformer for NextShakeExports {\n-    #[tracing::instrument(level = tracing::Level::TRACE, name = \"next_shake_exports\", skip_all)]\n-    async fn transform(&self, program: &mut Program, _ctx: &TransformContext<'_>) -> Result<()> {\n-        program.mutate(shake_exports(Config {\n-            ignore: self.ignore.iter().map(|s| s.clone().into()).collect(),\n-        }));\n-        Ok(())\n-    }\n-}"
        },
        {
            "sha": "3434f08220124b0bb23db89d8549f7ff1258c8b0",
            "filename": "test/integration/page-config/test/index.test.js",
            "status": "modified",
            "additions": 36,
            "deletions": 17,
            "changes": 53,
            "blob_url": "https://github.com/vercel/next.js/blob/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/test%2Fintegration%2Fpage-config%2Ftest%2Findex.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/test%2Fintegration%2Fpage-config%2Ftest%2Findex.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fpage-config%2Ftest%2Findex.test.js?ref=ae2e3e25bf250fb00d2a51c6d9b1477063518c37",
            "patch": "@@ -32,7 +32,9 @@ describe('Page Config', () => {\n           const { stderr } = await nextBuild(appDir, undefined, {\n             stderr: true,\n           })\n-          expect(stderr).toMatch(/\\/invalid-page-config/)\n+          expect(stderr).toContain(\n+            \"Next.js can't recognize the exported `config`\"\n+          )\n         } finally {\n           await reset()\n         }\n@@ -45,7 +47,9 @@ describe('Page Config', () => {\n           const { stderr } = await nextBuild(appDir, undefined, {\n             stderr: true,\n           })\n-          expect(stderr).toMatch(/\\/invalid-page-config/)\n+          expect(stderr).toContain(\n+            \"Next.js can't recognize the exported `config`\"\n+          )\n         } finally {\n           await reset()\n         }\n@@ -58,7 +62,9 @@ describe('Page Config', () => {\n           const { stderr } = await nextBuild(appDir, undefined, {\n             stderr: true,\n           })\n-          expect(stderr).toMatch(/\\/invalid-page-config/)\n+          expect(stderr).toContain(\n+            \"Next.js can't recognize the exported `config`\"\n+          )\n         } finally {\n           await reset()\n         }\n@@ -71,24 +77,33 @@ describe('Page Config', () => {\n           const { stderr } = await nextBuild(appDir, undefined, {\n             stderr: true,\n           })\n-          expect(stderr).toMatch(/\\/invalid-page-config/)\n+          expect(stderr).toContain(\n+            \"Next.js can't recognize the exported `config`\"\n+          )\n         } finally {\n           await reset()\n         }\n       })\n \n-      it('shows error when page config has invalid property value', async () => {\n-        const reset = await uncommentExport('invalid/invalid-value.js')\n-\n-        try {\n-          const { stderr } = await nextBuild(appDir, undefined, {\n-            stderr: true,\n-          })\n-          expect(stderr).toMatch(/\\/invalid-page-config/)\n-        } finally {\n-          await reset()\n+      // Turbopack ignores the config.amp property\n+      ;(process.env.IS_TURBOPACK_TEST ? it.skip : it)(\n+        'shows error when page config has invalid property value',\n+        async () => {\n+          const reset = await uncommentExport('invalid/invalid-value.js')\n+\n+          try {\n+            const { stderr } = await nextBuild(appDir, undefined, {\n+              stderr: true,\n+            })\n+            // eslint-disable-next-line jest/no-standalone-expect\n+            expect(stderr).toContain(\n+              \"Next.js can't recognize the exported `config`\"\n+            )\n+          } finally {\n+            await reset()\n+          }\n         }\n-      })\n+      )\n \n       it('shows error when page config is export from', async () => {\n         const reset = await uncommentExport('invalid/export-from.js')\n@@ -97,7 +112,9 @@ describe('Page Config', () => {\n           const { stderr } = await nextBuild(appDir, undefined, {\n             stderr: true,\n           })\n-          expect(stderr).toMatch(/\\/invalid-page-config/)\n+          expect(stderr).toContain(\n+            \"Next.js can't recognize the exported `config`\"\n+          )\n         } finally {\n           await reset()\n         }\n@@ -110,7 +127,9 @@ describe('Page Config', () => {\n           const { stderr } = await nextBuild(appDir, undefined, {\n             stderr: true,\n           })\n-          expect(stderr).toMatch(/\\/invalid-page-config/)\n+          expect(stderr).toContain(\n+            \"Next.js can't recognize the exported `config`\"\n+          )\n         } finally {\n           await reset()\n         }"
        },
        {
            "sha": "c468b577c6218d66b852e3d155ba18d449b79c74",
            "filename": "turbopack/crates/turbopack-ecmascript-plugins/Cargo.toml",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2FCargo.toml?ref=ae2e3e25bf250fb00d2a51c6d9b1477063518c37",
            "patch": "@@ -37,7 +37,6 @@ turbo-tasks-fs = { workspace = true }\n turbopack-core = { workspace = true }\n turbopack-ecmascript = { workspace = true }\n \n-modularize_imports = { workspace = true }\n styled_components = { workspace = true }\n styled_jsx = { workspace = true }\n swc_core = { workspace = true, features = [\"ecma_ast\", \"ecma_visit\", \"common\"] }"
        },
        {
            "sha": "3df041f4a816b43ffbc520f6d4dbdf0c80a2433c",
            "filename": "turbopack/crates/turbopack-ecmascript-plugins/src/transform/mod.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/ae2e3e25bf250fb00d2a51c6d9b1477063518c37/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Fmod.rs?ref=ae2e3e25bf250fb00d2a51c6d9b1477063518c37",
            "patch": "@@ -1,6 +1,5 @@\n pub mod directives;\n pub mod emotion;\n-pub mod modularize_imports;\n pub mod relay;\n pub mod styled_components;\n pub mod styled_jsx;"
        },
        {
            "sha": "4763f57831a123c90163eab333667dda3f51ba06",
            "filename": "turbopack/crates/turbopack-ecmascript-plugins/src/transform/modularize_imports.rs",
            "status": "removed",
            "additions": 0,
            "deletions": 61,
            "changes": 61,
            "blob_url": "https://github.com/vercel/next.js/blob/2d37f0702c7ce8d5b21035dd48597d835e521f83/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Fmodularize_imports.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2d37f0702c7ce8d5b21035dd48597d835e521f83/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Fmodularize_imports.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript-plugins%2Fsrc%2Ftransform%2Fmodularize_imports.rs?ref=2d37f0702c7ce8d5b21035dd48597d835e521f83",
            "patch": "@@ -1,61 +0,0 @@\n-use std::sync::Arc;\n-\n-use anyhow::Result;\n-use async_trait::async_trait;\n-use modularize_imports::{Config, PackageConfig, modularize_imports};\n-use serde::{Deserialize, Serialize};\n-use swc_core::ecma::ast::Program;\n-use turbo_tasks::{FxIndexMap, NonLocalValue, trace::TraceRawVcs};\n-use turbopack_ecmascript::{CustomTransformer, TransformContext};\n-\n-#[derive(Clone, Debug, Default, PartialEq, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n-#[serde(rename_all = \"camelCase\")]\n-pub struct ModularizeImportPackageConfig {\n-    pub transform: String,\n-    #[serde(default)]\n-    pub prevent_full_import: bool,\n-    #[serde(default)]\n-    pub skip_default_conversion: bool,\n-}\n-\n-#[derive(Debug)]\n-pub struct ModularizeImportsTransformer {\n-    config: Config,\n-}\n-\n-impl ModularizeImportsTransformer {\n-    pub fn new(packages: &FxIndexMap<String, ModularizeImportPackageConfig>) -> Self {\n-        Self {\n-            config: Config {\n-                packages: packages\n-                    .iter()\n-                    .map(|(k, v)| {\n-                        (\n-                            k.clone(),\n-                            Arc::new(PackageConfig {\n-                                transform: modularize_imports::Transform::String(\n-                                    v.transform.clone(),\n-                                ),\n-                                prevent_full_import: v.prevent_full_import,\n-                                skip_default_conversion: v.skip_default_conversion,\n-                                handle_default_import: false,\n-                                handle_namespace_import: false,\n-                                style: None,\n-                            }),\n-                        )\n-                    })\n-                    .collect(),\n-            },\n-        }\n-    }\n-}\n-\n-#[async_trait]\n-impl CustomTransformer for ModularizeImportsTransformer {\n-    #[tracing::instrument(level = tracing::Level::TRACE, name = \"modularize_imports\", skip_all)]\n-    async fn transform(&self, program: &mut Program, _ctx: &TransformContext<'_>) -> Result<()> {\n-        program.mutate(modularize_imports(&self.config));\n-\n-        Ok(())\n-    }\n-}"
        }
    ],
    "stats": {
        "total": 252,
        "additions": 39,
        "deletions": 213
    }
}