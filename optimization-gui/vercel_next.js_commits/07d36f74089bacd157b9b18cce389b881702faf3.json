{
    "author": "sokra",
    "message": "Turbopack: add task execution reason to tracing (#80861)\n\n### What?\r\n\r\nThis adds more information about the reason why a task was executed to tracing. This allows to figure out when new task are created and when tasks are only invalidated.",
    "sha": "07d36f74089bacd157b9b18cce389b881702faf3",
    "files": [
        {
            "sha": "1cbf9b2476697586dca324d4635f9c27fa3dffe7",
            "filename": "turbopack/crates/turbo-tasks-backend/src/backend/mod.rs",
            "status": "modified",
            "additions": 35,
            "deletions": 13,
            "changes": 48,
            "blob_url": "https://github.com/vercel/next.js/blob/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Fmod.rs?ref=07d36f74089bacd157b9b18cce389b881702faf3",
            "patch": "@@ -25,7 +25,8 @@ use smallvec::{SmallVec, smallvec};\n use tokio::time::{Duration, Instant};\n use turbo_tasks::{\n     CellId, FxDashMap, KeyValuePair, RawVc, ReadCellOptions, ReadConsistency, SessionId,\n-    TRANSIENT_TASK_BIT, TaskId, TraitTypeId, TurboTasksBackendApi, ValueTypeId,\n+    TRANSIENT_TASK_BIT, TaskExecutionReason, TaskId, TraitTypeId, TurboTasksBackendApi,\n+    ValueTypeId,\n     backend::{\n         Backend, BackendJobId, CachedTaskType, CellContent, TaskExecutionSpec, TransientTaskRoot,\n         TransientTaskType, TurboTasksExecutionError, TypedCellContent,\n@@ -617,8 +618,11 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n         };\n \n         // Output doesn't exist. We need to schedule the task to compute it.\n-        let (item, listener) =\n-            CachedDataItem::new_scheduled_with_listener(self.get_task_desc_fn(task_id), note);\n+        let (item, listener) = CachedDataItem::new_scheduled_with_listener(\n+            TaskExecutionReason::OutputNotAvailable,\n+            self.get_task_desc_fn(task_id),\n+            note,\n+        );\n         // It's not possible that the task is InProgress at this point. If it is InProgress {\n         // done: true } it must have Output and would early return.\n         task.add_new(item);\n@@ -749,6 +753,7 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n             bail!(\"{} was canceled\", ctx.get_task_description(task_id));\n         } else if !is_scheduled\n             && task.add(CachedDataItem::new_scheduled(\n+                TaskExecutionReason::CellNotAvailable,\n                 self.get_task_desc_fn(task_id),\n             ))\n         {\n@@ -1400,7 +1405,10 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n         let mut task = ctx.task(task_id, TaskDataCategory::Data);\n         if let Some(in_progress) = remove!(task, InProgress) {\n             match in_progress {\n-                InProgressState::Scheduled { done_event } => done_event.notify(usize::MAX),\n+                InProgressState::Scheduled {\n+                    done_event,\n+                    reason: _,\n+                } => done_event.notify(usize::MAX),\n                 InProgressState::InProgress(box InProgressStateInner { done_event, .. }) => {\n                     done_event.notify(usize::MAX)\n                 }\n@@ -1431,14 +1439,16 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n         } else {\n             return None;\n         };\n+        let execution_reason;\n         {\n             let mut ctx = self.execute_context(turbo_tasks);\n             let mut task = ctx.task(task_id, TaskDataCategory::All);\n             let in_progress = remove!(task, InProgress)?;\n-            let InProgressState::Scheduled { done_event } = in_progress else {\n+            let InProgressState::Scheduled { done_event, reason } = in_progress else {\n                 task.add_new(CachedDataItem::InProgress { value: in_progress });\n                 return None;\n             };\n+            execution_reason = reason;\n             task.add_new(CachedDataItem::InProgress {\n                 value: InProgressState::InProgress(Box::new(InProgressStateInner {\n                     stale: false,\n@@ -1533,7 +1543,7 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n                     arg,\n                 } = &*task_type;\n                 (\n-                    native_fn.span(task_id.persistence()),\n+                    native_fn.span(task_id.persistence(), execution_reason),\n                     native_fn.execute(*this, &**arg),\n                 )\n             }\n@@ -1613,7 +1623,10 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n                 unreachable!();\n             };\n             task.add_new(CachedDataItem::InProgress {\n-                value: InProgressState::Scheduled { done_event },\n+                value: InProgressState::Scheduled {\n+                    done_event,\n+                    reason: TaskExecutionReason::Stale,\n+                },\n             });\n             // Remove old children from new_children to leave only the children that had their\n             // active count increased\n@@ -1781,7 +1794,10 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n                 unreachable!();\n             };\n             task.add_new(CachedDataItem::InProgress {\n-                value: InProgressState::Scheduled { done_event },\n+                value: InProgressState::Scheduled {\n+                    done_event,\n+                    reason: TaskExecutionReason::Stale,\n+                },\n             });\n             drop(task);\n \n@@ -1842,7 +1858,10 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n         // If the task is stale, reschedule it\n         if stale {\n             task.add_new(CachedDataItem::InProgress {\n-                value: InProgressState::Scheduled { done_event },\n+                value: InProgressState::Scheduled {\n+                    done_event,\n+                    reason: TaskExecutionReason::Stale,\n+                },\n             });\n             return true;\n         }\n@@ -2300,10 +2319,13 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n                     value: ActivenessState::new_root(root_type, task_id),\n                 });\n             }\n-            task.add(CachedDataItem::new_scheduled(move || match root_type {\n-                RootType::RootTask => \"Root Task\".to_string(),\n-                RootType::OnceTask => \"Once Task\".to_string(),\n-            }));\n+            task.add(CachedDataItem::new_scheduled(\n+                TaskExecutionReason::Initial,\n+                move || match root_type {\n+                    RootType::RootTask => \"Root Task\".to_string(),\n+                    RootType::OnceTask => \"Once Task\".to_string(),\n+                },\n+            ));\n         }\n         #[cfg(feature = \"verify_aggregation_graph\")]\n         self.root_tasks.lock().insert(task_id);"
        },
        {
            "sha": "1f78691c14cdd98527b8dc400edea3d45311dbed",
            "filename": "turbopack/crates/turbo-tasks-backend/src/backend/operation/aggregation_update.rs",
            "status": "modified",
            "additions": 10,
            "deletions": 4,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Faggregation_update.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Faggregation_update.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Faggregation_update.rs?ref=07d36f74089bacd157b9b18cce389b881702faf3",
            "patch": "@@ -19,7 +19,7 @@ use smallvec::{SmallVec, smallvec};\n     feature = \"trace_find_and_schedule\"\n ))]\n use tracing::{span::Span, trace_span};\n-use turbo_tasks::{FxIndexMap, SessionId, TaskId};\n+use turbo_tasks::{FxIndexMap, SessionId, TaskExecutionReason, TaskId};\n \n #[cfg(feature = \"trace_task_dirty\")]\n use crate::backend::operation::invalidate::TaskDirtyCause;\n@@ -1217,10 +1217,16 @@ impl AggregationUpdateQueue {\n         let session_id = ctx.session_id();\n         // Task need to be scheduled if it's dirty or doesn't have output\n         let dirty = get!(task, Dirty).map_or(false, |d| d.get(session_id));\n-        let should_schedule = dirty || !task.has_key(&CachedDataItemKey::Output {});\n-        if should_schedule {\n+        let should_schedule = if dirty {\n+            Some(TaskExecutionReason::ActivateDirty)\n+        } else if !task.has_key(&CachedDataItemKey::Output {}) {\n+            Some(TaskExecutionReason::ActivateInitial)\n+        } else {\n+            None\n+        };\n+        if let Some(reason) = should_schedule {\n             let description = ctx.get_task_desc_fn(task_id);\n-            if task.add(CachedDataItem::new_scheduled(description)) {\n+            if task.add(CachedDataItem::new_scheduled(reason, description)) {\n                 ctx.schedule(task_id);\n             }\n         }"
        },
        {
            "sha": "24528dff16ad596e2e3cca4e772a2dbd91d7a5aa",
            "filename": "turbopack/crates/turbo-tasks-backend/src/backend/operation/connect_child.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Fconnect_child.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Fconnect_child.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Fconnect_child.rs?ref=07d36f74089bacd157b9b18cce389b881702faf3",
            "patch": "@@ -1,5 +1,5 @@\n use serde::{Deserialize, Serialize};\n-use turbo_tasks::TaskId;\n+use turbo_tasks::{TaskExecutionReason, TaskId};\n \n use crate::{\n     backend::{\n@@ -36,7 +36,10 @@ impl ConnectChildOperation {\n             }\n             if !task.has_key(&CachedDataItemKey::Output {}) {\n                 let description = ctx.get_task_desc_fn(child_task_id);\n-                let should_schedule = task.add(CachedDataItem::new_scheduled(description));\n+                let should_schedule = task.add(CachedDataItem::new_scheduled(\n+                    TaskExecutionReason::Connect,\n+                    description,\n+                ));\n                 drop(task);\n                 if should_schedule {\n                     ctx.schedule(child_task_id);\n@@ -97,7 +100,10 @@ impl ConnectChildOperation {\n \n             if !task.has_key(&CachedDataItemKey::Output {}) {\n                 let description = ctx.get_task_desc_fn(child_task_id);\n-                let should_schedule = task.add(CachedDataItem::new_scheduled(description));\n+                let should_schedule = task.add(CachedDataItem::new_scheduled(\n+                    TaskExecutionReason::Connect,\n+                    description,\n+                ));\n                 drop(task);\n                 if should_schedule {\n                     ctx.schedule(child_task_id);"
        },
        {
            "sha": "9a73455196abcbaf2726cbd86265b3a37f94a80b",
            "filename": "turbopack/crates/turbo-tasks-backend/src/backend/operation/invalidate.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Finvalidate.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Finvalidate.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Finvalidate.rs?ref=07d36f74089bacd157b9b18cce389b881702faf3",
            "patch": "@@ -1,6 +1,6 @@\n use serde::{Deserialize, Serialize};\n use smallvec::SmallVec;\n-use turbo_tasks::TaskId;\n+use turbo_tasks::{TaskExecutionReason, TaskId};\n \n use crate::{\n     backend::{\n@@ -278,7 +278,10 @@ pub fn make_task_dirty_internal(\n \n     if should_schedule {\n         let description = ctx.get_task_desc_fn(task_id);\n-        if task.add(CachedDataItem::new_scheduled(description)) {\n+        if task.add(CachedDataItem::new_scheduled(\n+            TaskExecutionReason::Invalidated,\n+            description,\n+        )) {\n             ctx.schedule(task_id);\n         }\n     }"
        },
        {
            "sha": "69b941c7a174a2d470f16eac9f8e28bbf078ea47",
            "filename": "turbopack/crates/turbo-tasks-backend/src/data.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 4,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fdata.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fdata.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fdata.rs?ref=07d36f74089bacd157b9b18cce389b881702faf3",
            "patch": "@@ -3,7 +3,8 @@ use std::cmp::Ordering;\n use rustc_hash::FxHashMap;\n use serde::{Deserialize, Serialize};\n use turbo_tasks::{\n-    CellId, KeyValuePair, SessionId, TaskId, TraitTypeId, TypedSharedReference, ValueTypeId,\n+    CellId, KeyValuePair, SessionId, TaskExecutionReason, TaskId, TraitTypeId,\n+    TypedSharedReference, ValueTypeId,\n     backend::TurboTasksExecutionError,\n     event::{Event, EventListener},\n     registry,\n@@ -322,7 +323,13 @@ pub struct InProgressStateInner {\n \n #[derive(Debug)]\n pub enum InProgressState {\n-    Scheduled { done_event: Event },\n+    Scheduled {\n+        /// Event that is triggered when the task output is available (completed flag set).\n+        /// This is used to wait for completion when reading the task output before it's available.\n+        done_event: Event,\n+        /// Reason for scheduling the task.\n+        reason: TaskExecutionReason,\n+    },\n     InProgress(Box<InProgressStateInner>),\n     Canceled,\n }\n@@ -522,23 +529,28 @@ impl CachedDataItem {\n         }\n     }\n \n-    pub fn new_scheduled(description: impl Fn() -> String + Sync + Send + 'static) -> Self {\n+    pub fn new_scheduled(\n+        reason: TaskExecutionReason,\n+        description: impl Fn() -> String + Sync + Send + 'static,\n+    ) -> Self {\n         CachedDataItem::InProgress {\n             value: InProgressState::Scheduled {\n                 done_event: Event::new(move || format!(\"{} done_event\", description())),\n+                reason,\n             },\n         }\n     }\n \n     pub fn new_scheduled_with_listener(\n+        reason: TaskExecutionReason,\n         description: impl Fn() -> String + Sync + Send + 'static,\n         note: impl Fn() -> String + Sync + Send + 'static,\n     ) -> (Self, EventListener) {\n         let done_event = Event::new(move || format!(\"{} done_event\", description()));\n         let listener = done_event.listen_with_note(note);\n         (\n             CachedDataItem::InProgress {\n-                value: InProgressState::Scheduled { done_event },\n+                value: InProgressState::Scheduled { done_event, reason },\n             },\n             listener,\n         )"
        },
        {
            "sha": "99b0c99d6d8bd682d851698d5f0a0e110f5e1f7e",
            "filename": "turbopack/crates/turbo-tasks/src/lib.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Flib.rs?ref=07d36f74089bacd157b9b18cce389b881702faf3",
            "patch": "@@ -75,6 +75,7 @@ mod serialization_invalidation;\n pub mod small_duration;\n mod state;\n pub mod task;\n+mod task_execution_reason;\n pub mod task_statistics;\n pub mod trace;\n mod trait_ref;\n@@ -120,6 +121,7 @@ pub use serialization_invalidation::SerializationInvalidator;\n pub use shrink_to_fit::ShrinkToFit;\n pub use state::{State, TransientState};\n pub use task::{SharedReference, TypedSharedReference, task_input::TaskInput};\n+pub use task_execution_reason::TaskExecutionReason;\n pub use trait_ref::{IntoTraitRef, TraitRef};\n pub use turbo_tasks_macros::{TaskInput, function, value_impl};\n pub use value::{TransientInstance, TransientValue};"
        },
        {
            "sha": "9d530aeb94c9f0ff6e0b53d434c638b0e518c66a",
            "filename": "turbopack/crates/turbo-tasks/src/native_function.rs",
            "status": "modified",
            "additions": 19,
            "deletions": 28,
            "changes": 47,
            "blob_url": "https://github.com/vercel/next.js/blob/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fnative_function.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fnative_function.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fnative_function.rs?ref=07d36f74089bacd157b9b18cce389b881702faf3",
            "patch": "@@ -6,7 +6,7 @@ use serde::{Deserialize, Serialize};\n use tracing::Span;\n \n use crate::{\n-    RawVc, TaskInput, TaskPersistence,\n+    RawVc, TaskExecutionReason, TaskInput, TaskPersistence,\n     magic_any::{MagicAny, MagicAnyDeserializeSeed, MagicAnySerializeSeed},\n     registry::register_function,\n     task::{\n@@ -253,36 +253,27 @@ impl NativeFunction {\n         }\n     }\n \n-    pub fn span(&'static self, persistence: TaskPersistence) -> Span {\n-        match persistence {\n-            TaskPersistence::Persistent => {\n-                tracing::trace_span!(\"turbo_tasks::function\", name = self.name)\n-            }\n-            TaskPersistence::Transient => {\n-                tracing::trace_span!(\"turbo_tasks::function\", name = self.name, transient = true,)\n-            }\n-            TaskPersistence::Local => {\n-                tracing::trace_span!(\"turbo_tasks::function\", name = self.name, local = true,)\n-            }\n-        }\n+    pub fn span(&'static self, persistence: TaskPersistence, reason: TaskExecutionReason) -> Span {\n+        let flags = match persistence {\n+            TaskPersistence::Persistent => \"\",\n+            TaskPersistence::Transient => \"transient\",\n+            TaskPersistence::Local => \"local\",\n+        };\n+        tracing::trace_span!(\n+            \"turbo_tasks::function\",\n+            name = self.name,\n+            flags = flags,\n+            reason = reason.as_str()\n+        )\n     }\n \n     pub fn resolve_span(&'static self, persistence: TaskPersistence) -> Span {\n-        match persistence {\n-            TaskPersistence::Persistent => {\n-                tracing::trace_span!(\"turbo_tasks::resolve_call\", name = self.name)\n-            }\n-            TaskPersistence::Transient => {\n-                tracing::trace_span!(\n-                    \"turbo_tasks::resolve_call\",\n-                    name = self.name,\n-                    transient = true,\n-                )\n-            }\n-            TaskPersistence::Local => {\n-                tracing::trace_span!(\"turbo_tasks::resolve_call\", name = self.name, local = true,)\n-            }\n-        }\n+        let flags = match persistence {\n+            TaskPersistence::Persistent => \"\",\n+            TaskPersistence::Transient => \"transient\",\n+            TaskPersistence::Local => \"local\",\n+        };\n+        tracing::trace_span!(\"turbo_tasks::resolve_call\", name = self.name, flags = flags)\n     }\n \n     pub fn register(&'static self, global_name: &'static str) {"
        },
        {
            "sha": "d686e2e7fb7ed0cb1d26b5e0d559cd94eae785a8",
            "filename": "turbopack/crates/turbo-tasks/src/task/local_task.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask%2Flocal_task.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask%2Flocal_task.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask%2Flocal_task.rs?ref=07d36f74089bacd157b9b18cce389b881702faf3",
            "patch": "@@ -3,8 +3,8 @@ use std::{fmt, sync::Arc};\n use anyhow::{Result, anyhow};\n \n use crate::{\n-    MagicAny, OutputContent, RawVc, TaskPersistence, TraitMethod, TurboTasksBackendApi,\n-    ValueTypeId,\n+    MagicAny, OutputContent, RawVc, TaskExecutionReason, TaskPersistence, TraitMethod,\n+    TurboTasksBackendApi, ValueTypeId,\n     backend::{Backend, TaskExecutionSpec, TypedCellContent},\n     event::Event,\n     macro_helpers::NativeFunction,\n@@ -26,7 +26,7 @@ pub fn get_local_task_execution_spec<'a>(\n ) -> TaskExecutionSpec<'a> {\n     match ty.task_type {\n         LocalTaskType::Native { native_fn } => {\n-            let span = native_fn.span(TaskPersistence::Local);\n+            let span = native_fn.span(TaskPersistence::Local, TaskExecutionReason::Local);\n             let entered = span.enter();\n             let future = native_fn.execute(ty.this, &*ty.arg);\n             drop(entered);"
        },
        {
            "sha": "ffab24d2fcb7f9bbec923ab683373c00ba28f70d",
            "filename": "turbopack/crates/turbo-tasks/src/task_execution_reason.rs",
            "status": "added",
            "additions": 28,
            "deletions": 0,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask_execution_reason.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/07d36f74089bacd157b9b18cce389b881702faf3/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask_execution_reason.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask_execution_reason.rs?ref=07d36f74089bacd157b9b18cce389b881702faf3",
            "patch": "@@ -0,0 +1,28 @@\n+#[derive(Debug)]\n+pub enum TaskExecutionReason {\n+    Initial,\n+    Local,\n+    OutputNotAvailable,\n+    CellNotAvailable,\n+    Invalidated,\n+    ActivateDirty,\n+    ActivateInitial,\n+    Connect,\n+    Stale,\n+}\n+\n+impl TaskExecutionReason {\n+    pub fn as_str(&self) -> &'static str {\n+        match self {\n+            TaskExecutionReason::Initial => \"initial\",\n+            TaskExecutionReason::Local => \"local\",\n+            TaskExecutionReason::OutputNotAvailable => \"output_not_available\",\n+            TaskExecutionReason::CellNotAvailable => \"cell_not_available\",\n+            TaskExecutionReason::Invalidated => \"invalidated\",\n+            TaskExecutionReason::ActivateDirty => \"activate_dirty\",\n+            TaskExecutionReason::ActivateInitial => \"activate_initial\",\n+            TaskExecutionReason::Connect => \"connect\",\n+            TaskExecutionReason::Stale => \"stale\",\n+        }\n+    }\n+}"
        }
    ],
    "stats": {
        "total": 184,
        "additions": 127,
        "deletions": 57
    }
}