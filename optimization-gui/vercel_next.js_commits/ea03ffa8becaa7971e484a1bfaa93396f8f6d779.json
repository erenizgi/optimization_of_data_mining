{
    "author": "Cy-Tek",
    "message": "Turbopack: CSS Global Import Validation for Pages (#80585)\n\n## Implement CSS Global Import Validation for Pages\n\nThis PR adds validation for CSS imports in the Pages Router to prevent\nglobal CSS imports in invalid modules.\n\nFixes #\n\n---------\n\nCo-authored-by: Niklas Mischkulnig <4586894+mischnic@users.noreply.github.com>",
    "sha": "ea03ffa8becaa7971e484a1bfaa93396f8f6d779",
    "files": [
        {
            "sha": "7c46dee1baa59b2016b76e58a72a90fe528f2e82",
            "filename": "crates/next-api/src/module_graph.rs",
            "status": "modified",
            "additions": 214,
            "deletions": 6,
            "changes": 220,
            "blob_url": "https://github.com/vercel/next.js/blob/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/crates%2Fnext-api%2Fsrc%2Fmodule_graph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/crates%2Fnext-api%2Fsrc%2Fmodule_graph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fmodule_graph.rs?ref=ea03ffa8becaa7971e484a1bfaa93396f8f6d779",
            "patch": "@@ -12,13 +12,16 @@ use next_core::{\n };\n use rustc_hash::FxHashMap;\n use tracing::Instrument;\n+use turbo_rcstr::RcStr;\n use turbo_tasks::{\n     CollectiblesSource, FxIndexMap, FxIndexSet, ReadRef, ResolvedVc, TryFlatJoinIterExt,\n-    TryJoinIterExt, Vc,\n+    TryJoinIterExt, ValueToString, Vc,\n };\n+use turbo_tasks_fs::FileSystemPath;\n+use turbopack::css::{CssModuleAsset, ModuleCssAsset};\n use turbopack_core::{\n     context::AssetContext,\n-    issue::Issue,\n+    issue::{Issue, IssueExt, IssueSeverity, IssueStage, OptionStyledString, StyledString},\n     module::Module,\n     module_graph::{GraphTraversalAction, ModuleGraph, SingleModuleGraph},\n };\n@@ -399,6 +402,157 @@ impl ClientReferencesGraph {\n     }\n }\n \n+#[turbo_tasks::value(shared)]\n+struct CssGlobalImportIssue {\n+    parent_module: ResolvedVc<Box<dyn Module>>,\n+    module: ResolvedVc<Box<dyn Module>>,\n+}\n+\n+impl CssGlobalImportIssue {\n+    fn new(\n+        parent_module: ResolvedVc<Box<dyn Module>>,\n+        module: ResolvedVc<Box<dyn Module>>,\n+    ) -> Self {\n+        Self {\n+            parent_module,\n+            module,\n+        }\n+    }\n+}\n+\n+#[turbo_tasks::value_impl]\n+impl Issue for CssGlobalImportIssue {\n+    #[turbo_tasks::function]\n+    async fn title(&self) -> Vc<StyledString> {\n+        StyledString::Stack(vec![\n+            StyledString::Text(\"Failed to compile\".into()),\n+            StyledString::Text(\n+                \"Global CSS cannot be imported from files other than your Custom <App>. Due to \\\n+                 the Global nature of stylesheets, and to avoid conflicts, Please move all \\\n+                 first-party global CSS imports to pages/_app.js. Or convert the import to \\\n+                 Component-Level CSS (CSS Modules).\"\n+                    .into(),\n+            ),\n+            StyledString::Text(\"Read more: https://nextjs.org/docs/messages/css-global\".into()),\n+        ])\n+        .cell()\n+    }\n+\n+    #[turbo_tasks::function]\n+    async fn description(&self) -> Result<Vc<OptionStyledString>> {\n+        let parent_path = &self.parent_module.ident().path();\n+        let module_path = &self.module.ident().path();\n+        let relative_import_location = parent_path.parent().await?;\n+\n+        let import_path = match relative_import_location.get_relative_path_to(&*module_path.await?)\n+        {\n+            Some(path) => path,\n+            None => module_path.await?.path.clone(),\n+        };\n+        let cleaned_import_path =\n+            if import_path.ends_with(\".scss.css\") || import_path.ends_with(\".sass.css\") {\n+                RcStr::from(import_path.trim_end_matches(\".css\"))\n+            } else {\n+                import_path\n+            };\n+\n+        Ok(Vc::cell(Some(\n+            StyledString::Stack(vec![\n+                StyledString::Text(format!(\"Location: {}\", parent_path.await?.path).into()),\n+                StyledString::Text(format!(\"Import path: {cleaned_import_path}\",).into()),\n+            ])\n+            .resolved_cell(),\n+        )))\n+    }\n+\n+    fn severity(&self) -> IssueSeverity {\n+        IssueSeverity::Error\n+    }\n+\n+    #[turbo_tasks::function]\n+    fn file_path(&self) -> Vc<FileSystemPath> {\n+        self.parent_module.ident().path()\n+    }\n+\n+    #[turbo_tasks::function]\n+    fn stage(&self) -> Vc<IssueStage> {\n+        IssueStage::ProcessModule.into()\n+    }\n+}\n+\n+type FxModuleNameMap = FxIndexMap<ResolvedVc<Box<dyn Module>>, RcStr>;\n+\n+#[turbo_tasks::value(transparent)]\n+struct ModuleNameMap(pub FxModuleNameMap);\n+\n+#[turbo_tasks::function]\n+async fn validate_pages_css_imports(\n+    graph: Vc<SingleModuleGraph>,\n+    is_single_page: bool,\n+    entry: Vc<Box<dyn Module>>,\n+    app_module: ResolvedVc<Box<dyn Module>>,\n+    module_name_map: ResolvedVc<ModuleNameMap>,\n+) -> Result<()> {\n+    let graph = &*graph.await?;\n+    let entry = entry.to_resolved().await?;\n+    let module_name_map = module_name_map.await?;\n+\n+    let entries = if !is_single_page {\n+        // TODO: Optimize this code by checking if the node is an entry using `get_module` and then\n+        // checking if the node is an entry in the graph by looking for the reverse edges.\n+        if !graph.entry_modules().any(|m| m == entry) {\n+            // the graph doesn't contain the entry, e.g. for the additional module graph\n+            return Ok(());\n+        }\n+        Either::Left(std::iter::once(entry))\n+    } else {\n+        Either::Right(graph.entry_modules())\n+    };\n+\n+    graph.traverse_edges_from_entries(entries, |parent_info, node| {\n+        let module = node.module;\n+\n+        let module_name_contains_node_modules = module_name_map\n+            .get(&module)\n+            .is_some_and(|s| s.contains(\"node_modules\"));\n+\n+        if module_name_contains_node_modules {\n+            return GraphTraversalAction::Continue;\n+        }\n+\n+        let Some((parent_node, _)) = parent_info else {\n+            // root node, no parent\n+            return GraphTraversalAction::Continue;\n+        };\n+\n+        let parent_module = parent_node.module;\n+        let parent_is_css_module = ResolvedVc::try_downcast_type::<ModuleCssAsset>(parent_module)\n+            .is_some()\n+            || ResolvedVc::try_downcast_type::<CssModuleAsset>(parent_module).is_some();\n+\n+        if parent_is_css_module {\n+            return GraphTraversalAction::Continue;\n+        }\n+\n+        let module_is_global_css =\n+            ResolvedVc::try_downcast_type::<CssModuleAsset>(module).is_some();\n+\n+        if !module_is_global_css {\n+            return GraphTraversalAction::Continue;\n+        }\n+\n+        if parent_module != app_module {\n+            CssGlobalImportIssue::new(parent_module, module)\n+                .resolved_cell()\n+                .emit();\n+        }\n+\n+        GraphTraversalAction::Continue\n+    })?;\n+\n+    Ok(())\n+}\n+\n /// The consumers of this shouldn't need to care about the exact contents since it's abstracted away\n /// by the accessor functions, but\n /// - In dev, contains information about the modules of the current endpoint only\n@@ -408,16 +562,19 @@ pub struct ReducedGraphs {\n     next_dynamic: Vec<ResolvedVc<NextDynamicGraph>>,\n     server_actions: Vec<ResolvedVc<ServerActionsGraph>>,\n     client_references: Vec<ResolvedVc<ClientReferencesGraph>>,\n+    // Data for some more ad-hoc operations\n+    bare_graphs: ResolvedVc<ModuleGraph>,\n+    is_single_page: bool,\n     // TODO add other graphs\n }\n \n #[turbo_tasks::value_impl]\n impl ReducedGraphs {\n     #[turbo_tasks::function]\n     pub async fn new(graphs: Vc<ModuleGraph>, is_single_page: bool) -> Result<Vc<Self>> {\n-        let graphs = &graphs.await?.graphs;\n+        let graphs_ref = &graphs.await?.graphs;\n         let next_dynamic = async {\n-            graphs\n+            graphs_ref\n                 .iter()\n                 .map(|graph| {\n                     NextDynamicGraph::new_with_entries(**graph, is_single_page).to_resolved()\n@@ -428,7 +585,7 @@ impl ReducedGraphs {\n         .instrument(tracing::info_span!(\"generating next/dynamic graphs\"));\n \n         let server_actions = async {\n-            graphs\n+            graphs_ref\n                 .iter()\n                 .map(|graph| {\n                     ServerActionsGraph::new_with_entries(**graph, is_single_page).to_resolved()\n@@ -439,7 +596,7 @@ impl ReducedGraphs {\n         .instrument(tracing::info_span!(\"generating server actions graphs\"));\n \n         let client_references = async {\n-            graphs\n+            graphs_ref\n                 .iter()\n                 .map(|graph| {\n                     ClientReferencesGraph::new_with_entries(**graph, is_single_page).to_resolved()\n@@ -456,6 +613,8 @@ impl ReducedGraphs {\n             next_dynamic: next_dynamic?,\n             server_actions: server_actions?,\n             client_references: client_references?,\n+            bare_graphs: graphs.to_resolved().await?,\n+            is_single_page,\n         }\n         .cell())\n     }\n@@ -579,6 +738,55 @@ impl ReducedGraphs {\n         .instrument(span)\n         .await\n     }\n+\n+    #[turbo_tasks::function]\n+    pub async fn validate_pages_css_imports(\n+        &self,\n+        entry: Vc<Box<dyn Module>>,\n+        app_module: Vc<Box<dyn Module>>,\n+    ) -> Result<()> {\n+        let span = tracing::info_span!(\"validate pages css imports\");\n+        async move {\n+            let mut ident_vec = Vec::new();\n+            for graph in self.bare_graphs.await?.graphs.iter() {\n+                let inputs = graph\n+                    .await?\n+                    .graph\n+                    .node_weights()\n+                    .map(async |n| {\n+                        Ok((\n+                            n.module(),\n+                            RcStr::from(n.module().ident().to_string().await?.as_str()),\n+                        ))\n+                    })\n+                    .try_join()\n+                    .await?;\n+                ident_vec.extend(inputs);\n+            }\n+            let idents = ModuleNameMap(ident_vec.into_iter().collect::<FxIndexMap<_, _>>()).cell();\n+\n+            let _ = self\n+                .bare_graphs\n+                .await?\n+                .graphs\n+                .iter()\n+                .map(|graph| {\n+                    validate_pages_css_imports(\n+                        **graph,\n+                        self.is_single_page,\n+                        entry,\n+                        app_module,\n+                        idents,\n+                    )\n+                })\n+                .try_join()\n+                .await?;\n+\n+            Ok(())\n+        }\n+        .instrument(span)\n+        .await\n+    }\n }\n \n #[turbo_tasks::function(operation)]"
        },
        {
            "sha": "ba60b272af07cb0aa37b3320bcd198714d4884cb",
            "filename": "crates/next-api/src/pages.rs",
            "status": "modified",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fpages.rs?ref=ea03ffa8becaa7971e484a1bfaa93396f8f6d779",
            "patch": "@@ -1001,6 +1001,28 @@ impl PageEndpoint {\n                     client_module_graph,\n                     *project.per_page_module_graph().await?,\n                 );\n+\n+                // We only validate the global css imports when there is not a `app` folder at the\n+                // root of the project.\n+                if project.app_project().await?.is_none() {\n+                    let app_module = project\n+                        .pages_project()\n+                        .client_module_context()\n+                        .process(\n+                            Vc::upcast(FileSource::new(\n+                                this.pages_structure.await?.app.file_path(),\n+                            )),\n+                            ReferenceType::Entry(EntryReferenceSubType::Page),\n+                        )\n+                        .to_resolved()\n+                        .await?\n+                        .module();\n+\n+                    reduced_graphs\n+                        .validate_pages_css_imports(self.client_module(), app_module)\n+                        .await?;\n+                }\n+\n                 let next_dynamic_imports = reduced_graphs\n                     .get_next_dynamic_imports_for_endpoint(self.client_module())\n                     .await?;"
        },
        {
            "sha": "ec4a914cdd4edfcddffc4fbb74602ce5284b0ef5",
            "filename": "test/e2e/app-dir/scss/invalid-global-with-app/invalid-global-with-app.test.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 23,
            "changes": 39,
            "blob_url": "https://github.com/vercel/next.js/blob/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global-with-app%2Finvalid-global-with-app.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global-with-app%2Finvalid-global-with-app.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global-with-app%2Finvalid-global-with-app.test.ts?ref=ea03ffa8becaa7971e484a1bfaa93396f8f6d779",
            "patch": "@@ -3,31 +3,24 @@\n import { remove } from 'fs-extra'\n import { nextBuild } from 'next-test-utils'\n import { join } from 'path'\n-// In order for the global isNextStart to be set\n-import 'e2e-utils'\n \n describe('Invalid Global CSS with Custom App', () => {\n-  ;(Boolean((global as any).isNextStart) ? describe : describe.skip)(\n-    'production only',\n-    () => {\n-      const appDir = __dirname\n+  const appDir = __dirname\n \n-      beforeAll(async () => {\n-        await remove(join(appDir, '.next'))\n-      })\n+  beforeAll(async () => {\n+    await remove(join(appDir, '.next'))\n+  })\n \n-      it('should fail to build', async () => {\n-        const { code, stderr } = await nextBuild(appDir, [], {\n-          stderr: true,\n-        })\n-        expect(code).not.toBe(0)\n-        expect(stderr).toContain('Failed to compile')\n-        expect(stderr).toContain('styles/global.scss')\n-        expect(stderr).toMatch(\n-          /Please move all first-party global CSS imports.*?pages(\\/|\\\\)_app/\n-        )\n-        expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n-      })\n-    }\n-  )\n+  it('should fail to build', async () => {\n+    const { code, stderr } = await nextBuild(appDir, [], {\n+      stderr: true,\n+    })\n+    expect(code).not.toBe(0)\n+    expect(stderr).toContain('Failed to compile')\n+    expect(stderr).toContain('styles/global.scss')\n+    expect(stderr).toMatch(\n+      /Please move all first-party global CSS imports.*?pages(\\/|\\\\)_app/\n+    )\n+    expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+  })\n })"
        },
        {
            "sha": "0324c7c2704077f726d8dc2e075c9953dd3fc9f3",
            "filename": "test/e2e/app-dir/scss/invalid-global/invalid-global.test.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 23,
            "changes": 39,
            "blob_url": "https://github.com/vercel/next.js/blob/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global%2Finvalid-global.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global%2Finvalid-global.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global%2Finvalid-global.test.ts?ref=ea03ffa8becaa7971e484a1bfaa93396f8f6d779",
            "patch": "@@ -3,31 +3,24 @@\n import { remove } from 'fs-extra'\n import { nextBuild } from 'next-test-utils'\n import { join } from 'path'\n-// In order for the global isNextStart to be set\n-import 'e2e-utils'\n \n describe('Invalid Global CSS', () => {\n-  ;(Boolean((global as any).isNextStart) ? describe : describe.skip)(\n-    'production only',\n-    () => {\n-      const appDir = __dirname\n+  const appDir = __dirname\n \n-      beforeAll(async () => {\n-        await remove(join(appDir, '.next'))\n-      })\n+  beforeAll(async () => {\n+    await remove(join(appDir, '.next'))\n+  })\n \n-      it('should fail to build', async () => {\n-        const { code, stderr } = await nextBuild(appDir, [], {\n-          stderr: true,\n-        })\n-        expect(code).not.toBe(0)\n-        expect(stderr).toContain('Failed to compile')\n-        expect(stderr).toContain('styles/global.scss')\n-        expect(stderr).toMatch(\n-          /Please move all first-party global CSS imports.*?pages(\\/|\\\\)_app/\n-        )\n-        expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n-      })\n-    }\n-  )\n+  it('should fail to build', async () => {\n+    const { code, stderr } = await nextBuild(appDir, [], {\n+      stderr: true,\n+    })\n+    expect(code).not.toBe(0)\n+    expect(stderr).toContain('Failed to compile')\n+    expect(stderr).toContain('styles/global.scss')\n+    expect(stderr).toMatch(\n+      /Please move all first-party global CSS imports.*?pages(\\/|\\\\)_app/\n+    )\n+    expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+  })\n })"
        },
        {
            "sha": "9d814705d50965d4baa3207634bf65140605b9c6",
            "filename": "test/e2e/app-dir/scss/valid-and-invalid-global/valid-and-invalid-global.test.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 23,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/test%2Fe2e%2Fapp-dir%2Fscss%2Fvalid-and-invalid-global%2Fvalid-and-invalid-global.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/test%2Fe2e%2Fapp-dir%2Fscss%2Fvalid-and-invalid-global%2Fvalid-and-invalid-global.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Fvalid-and-invalid-global%2Fvalid-and-invalid-global.test.ts?ref=ea03ffa8becaa7971e484a1bfaa93396f8f6d779",
            "patch": "@@ -3,31 +3,22 @@\n import { remove } from 'fs-extra'\n import { nextBuild } from 'next-test-utils'\n import { join } from 'path'\n-// In order for the global isNextStart to be set\n-import 'e2e-utils'\n \n describe('Valid and Invalid Global CSS with Custom App', () => {\n-  ;(Boolean((global as any).isNextStart) ? describe : describe.skip)(\n-    'production only',\n-    () => {\n-      const appDir = __dirname\n+  const appDir = __dirname\n \n-      beforeAll(async () => {\n-        await remove(join(appDir, '.next'))\n-      })\n+  beforeAll(async () => {\n+    await remove(join(appDir, '.next'))\n+  })\n \n-      it('should fail to build', async () => {\n-        const { code, stderr } = await nextBuild(appDir, [], {\n-          stderr: true,\n-        })\n-        expect(code).not.toBe(0)\n-        expect(stderr).toContain('Failed to compile')\n-        expect(stderr).toContain('styles/global.scss')\n-        expect(stderr).toContain(\n-          'Please move all first-party global CSS imports'\n-        )\n-        expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n-      })\n-    }\n-  )\n+  it('should fail to build', async () => {\n+    const { code, stderr } = await nextBuild(appDir, [], {\n+      stderr: true,\n+    })\n+    expect(code).not.toBe(0)\n+    expect(stderr).toContain('Failed to compile')\n+    expect(stderr).toContain('styles/global.scss')\n+    expect(stderr).toContain('Please move all first-party global CSS imports')\n+    expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+  })\n })"
        },
        {
            "sha": "4199d97bfab139743dcefa40c48dc2a5d871c8e3",
            "filename": "test/turbopack-build-tests-manifest.json",
            "status": "modified",
            "additions": 7,
            "deletions": 9,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/test%2Fturbopack-build-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/test%2Fturbopack-build-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fturbopack-build-tests-manifest.json?ref=ea03ffa8becaa7971e484a1bfaa93396f8f6d779",
            "patch": "@@ -5178,17 +5178,15 @@\n     \"runtimeError\": false\n   },\n   \"test/e2e/app-dir/scss/invalid-global-with-app/invalid-global-with-app.test.ts\": {\n-    \"passed\": [],\n-    \"failed\": [\n-      \"Invalid Global CSS with Custom App production only should fail to build\"\n-    ],\n+    \"passed\": [\"Invalid Global CSS with Custom App should fail to build\"],\n+    \"failed\": [],\n     \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false\n   },\n   \"test/e2e/app-dir/scss/invalid-global/invalid-global.test.ts\": {\n-    \"passed\": [],\n-    \"failed\": [\"Invalid Global CSS production only should fail to build\"],\n+    \"passed\": [\"Invalid Global CSS should fail to build\"],\n+    \"failed\": [],\n     \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false\n@@ -5410,10 +5408,10 @@\n     \"runtimeError\": false\n   },\n   \"test/e2e/app-dir/scss/valid-and-invalid-global/valid-and-invalid-global.test.ts\": {\n-    \"passed\": [],\n-    \"failed\": [\n-      \"Valid and Invalid Global CSS with Custom App production only should fail to build\"\n+    \"passed\": [\n+      \"Valid and Invalid Global CSS with Custom App should fail to build\"\n     ],\n+    \"failed\": [],\n     \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false"
        },
        {
            "sha": "c0ed6e96ee4b65fe7e1912b171a3e6b104aafb60",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/ea03ffa8becaa7971e484a1bfaa93396f8f6d779/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs?ref=ea03ffa8becaa7971e484a1bfaa93396f8f6d779",
            "patch": "@@ -178,7 +178,7 @@ impl GraphEntries {\n #[turbo_tasks::value(cell = \"new\", eq = \"manual\", into = \"new\")]\n #[derive(Clone, Default)]\n pub struct SingleModuleGraph {\n-    graph: TracedDiGraph<SingleModuleGraphNode, RefData>,\n+    pub graph: TracedDiGraph<SingleModuleGraphNode, RefData>,\n \n     /// The number of modules in the graph (excluding VisitedModule nodes)\n     pub number_of_modules: usize,"
        }
    ],
    "stats": {
        "total": 375,
        "additions": 290,
        "deletions": 85
    }
}