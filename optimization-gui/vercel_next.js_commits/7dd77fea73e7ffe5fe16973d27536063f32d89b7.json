{
    "author": "ijjk",
    "message": "Update build-complete for adapter API (#82452)\n\nThis adds some additional API surface for `build-complete` adapter hook.\nWiring up prerenders and additional configs.",
    "sha": "7dd77fea73e7ffe5fe16973d27536063f32d89b7",
    "files": [
        {
            "sha": "96100a7fea929e0ea7ef59ea58ede79235a1ad72",
            "filename": "packages/next/errors.json",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Ferrors.json",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Ferrors.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ferrors.json?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -774,5 +774,6 @@\n   \"773\": \"Missing workStore in createPrerenderParamsForClientSegment\",\n   \"774\": \"Route %s used %s outside of a Server Component. This is not allowed.\",\n   \"775\": \"Node.js instrumentation extensions should not be loaded in the Edge runtime.\",\n-  \"776\": \"`unstable_isUnrecognizedActionError` can only be used on the client.\"\n+  \"776\": \"`unstable_isUnrecognizedActionError` can only be used on the client.\",\n+  \"777\": \"Invariant: failed to find source route %s for prerender %s\"\n }"
        },
        {
            "sha": "0cbab6c3ea6f29825c9b7ecf4d25e87f9ea97cd8",
            "filename": "packages/next/src/build/adapter/build-complete.ts",
            "status": "modified",
            "additions": 204,
            "deletions": 21,
            "changes": 225,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Fsrc%2Fbuild%2Fadapter%2Fbuild-complete.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Fsrc%2Fbuild%2Fadapter%2Fbuild-complete.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fadapter%2Fbuild-complete.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -6,11 +6,10 @@ import * as Log from '../output/log'\n import globOriginal from 'next/dist/compiled/glob'\n import { interopDefault } from '../../lib/interop-default'\n import type { AdapterOutputs, NextAdapter } from '../../server/config-shared'\n-import {\n-  RouteType,\n-  type FunctionsConfigManifest,\n-  type PrerenderManifest,\n-  type RoutesManifest,\n+import type {\n+  FunctionsConfigManifest,\n+  PrerenderManifest,\n+  RoutesManifest,\n } from '..'\n import type {\n   EdgeFunctionDefinition,\n@@ -19,6 +18,8 @@ import type {\n import { isMiddlewareFilename } from '../utils'\n import { normalizePagePath } from '../../shared/lib/page-path/normalize-page-path'\n import { normalizeAppPath } from '../../shared/lib/router/utils/app-paths'\n+import { AdapterOutputType } from '../../shared/lib/constants'\n+import { RenderingMode } from '../rendering-mode'\n \n const glob = promisify(globOriginal)\n \n@@ -33,8 +34,9 @@ export async function handleBuildComplete({\n   hasInstrumentationHook,\n   requiredServerFiles,\n   routesManifest,\n-  // prerenderManifest,\n+  prerenderManifest,\n   middlewareManifest,\n+  functionsConfigManifest,\n }: {\n   dir: string\n   distDir: string\n@@ -68,7 +70,7 @@ export async function handleBuildComplete({\n         const pathname = path.posix.join('/_next/static', file)\n         const filePath = path.join(distDir, 'static', file)\n         outputs.push({\n-          type: RouteType.STATIC_FILE,\n+          type: AdapterOutputType.STATIC_FILE,\n           id: path.join('static', file),\n           pathname,\n           filePath,\n@@ -126,19 +128,19 @@ export async function handleBuildComplete({\n         page: EdgeFunctionDefinition,\n         isMiddleware: boolean = false\n       ) {\n-        let type = RouteType.PAGES\n+        let type = AdapterOutputType.PAGES\n         const isAppPrefix = page.page.startsWith('app/')\n         const isAppPage = isAppPrefix && page.page.endsWith('/page')\n         const isAppRoute = isAppPrefix && page.page.endsWith('/route')\n \n         if (isMiddleware) {\n-          type = RouteType.MIDDLEWARE\n+          type = AdapterOutputType.MIDDLEWARE\n         } else if (isAppPage) {\n-          type = RouteType.APP_PAGE\n+          type = AdapterOutputType.APP_PAGE\n         } else if (isAppRoute) {\n-          type = RouteType.APP_ROUTE\n+          type = AdapterOutputType.APP_ROUTE\n         } else if (page.page.startsWith('/api')) {\n-          type = RouteType.PAGES_API\n+          type = AdapterOutputType.PAGES_API\n         }\n \n         const output: AdapterOutputs[0] = {\n@@ -155,6 +157,12 @@ export async function handleBuildComplete({\n           ),\n           assets: {},\n           type,\n+          config:\n+            type === AdapterOutputType.MIDDLEWARE\n+              ? {\n+                  matchers: page.matchers,\n+                }\n+              : {},\n         }\n \n         function handleFile(file: string) {\n@@ -188,6 +196,7 @@ export async function handleBuildComplete({\n       for (const page of Object.values(middlewareManifest.functions)) {\n         edgeFunctionHandlers.push(handleEdgeFunction(page))\n       }\n+      const pageOutputMap: Record<string, AdapterOutputs[0]> = {}\n \n       for (const page of pageKeys) {\n         if (middlewareManifest.functions.hasOwnProperty(page)) {\n@@ -204,35 +213,50 @@ export async function handleBuildComplete({\n         const pageTraceFile = `${pageFile}.nft.json`\n         const assets = await handleTraceFiles(pageTraceFile).catch((err) => {\n           if (err.code !== 'ENOENT' || (page !== '/404' && page !== '/500')) {\n-            Log.warn(`Failed to copy traced files for ${pageFile}`, err)\n+            Log.warn(`Failed to locate traced assets for ${pageFile}`, err)\n           }\n           return {} as Record<string, string>\n         })\n+        const functionConfig = functionsConfigManifest.functions[route] || {}\n \n-        outputs.push({\n+        const output: AdapterOutputs[0] = {\n           id: route,\n-          type: page.startsWith('/api') ? RouteType.PAGES_API : RouteType.PAGES,\n+          type: page.startsWith('/api')\n+            ? AdapterOutputType.PAGES_API\n+            : AdapterOutputType.PAGES,\n           filePath: pageTraceFile.replace(/\\.nft\\.json$/, ''),\n           pathname: route,\n           assets,\n           runtime: 'nodejs',\n-        })\n+          config: {\n+            maxDuration: functionConfig.maxDuration,\n+            preferredRegion: functionConfig.regions,\n+          },\n+        }\n+        pageOutputMap[page] = output\n+        outputs.push(output)\n       }\n \n       if (hasNodeMiddleware) {\n         const middlewareFile = path.join(distDir, 'server', 'middleware.js')\n         const middlewareTrace = `${middlewareFile}.nft.json`\n         const assets = await handleTraceFiles(middlewareTrace)\n+        const functionConfig =\n+          functionsConfigManifest.functions['/_middleware'] || {}\n \n         outputs.push({\n           pathname: '/_middleware',\n           id: '/_middleware',\n           assets,\n-          type: RouteType.MIDDLEWARE,\n+          type: AdapterOutputType.MIDDLEWARE,\n           runtime: 'nodejs',\n           filePath: middlewareFile,\n+          config: {\n+            matchers: functionConfig.matchers,\n+          },\n         })\n       }\n+      const appOutputMap: Record<string, AdapterOutputs[0]> = {}\n \n       if (appPageKeys) {\n         for (const page of appPageKeys) {\n@@ -246,21 +270,180 @@ export async function handleBuildComplete({\n             Log.warn(`Failed to copy traced files for ${pageFile}`, err)\n             return {} as Record<string, string>\n           })\n+          const functionConfig =\n+            functionsConfigManifest.functions[normalizedPage] || {}\n \n-          outputs.push({\n+          const output: AdapterOutputs[0] = {\n             pathname: normalizedPage,\n             id: normalizedPage,\n             assets,\n             type: page.endsWith('/route')\n-              ? RouteType.APP_ROUTE\n-              : RouteType.APP_PAGE,\n+              ? AdapterOutputType.APP_ROUTE\n+              : AdapterOutputType.APP_PAGE,\n             runtime: 'nodejs',\n             filePath: pageFile,\n+            config: {\n+              maxDuration: functionConfig.maxDuration,\n+              preferredRegion: functionConfig.regions,\n+            },\n+          }\n+          appOutputMap[normalizedPage] = output\n+          outputs.push(output)\n+        }\n+      }\n+\n+      const getParentOutput = (srcRoute: string, childRoute: string) => {\n+        const parentOutput = pageOutputMap[srcRoute] || appOutputMap[srcRoute]\n+\n+        if (!parentOutput) {\n+          console.error({\n+            appOutputs: Object.keys(appOutputMap),\n+            pageOutputs: Object.keys(pageOutputMap),\n+          })\n+          throw new Error(\n+            `Invariant: failed to find source route ${srcRoute} for prerender ${childRoute}`\n+          )\n+        }\n+        return parentOutput\n+      }\n+\n+      for (const route in prerenderManifest.routes) {\n+        const {\n+          initialExpireSeconds: initialExpiration,\n+          initialRevalidateSeconds: initialRevalidate,\n+          initialHeaders,\n+          initialStatus,\n+          prefetchDataRoute,\n+          dataRoute,\n+          renderingMode,\n+        } = prerenderManifest.routes[route]\n+\n+        const srcRoute = prerenderManifest.routes[route].srcRoute || route\n+        const isAppPage = dataRoute?.endsWith('.rsc')\n+\n+        const filePath = path.join(\n+          distDir,\n+          'server',\n+          isAppPage ? 'app' : 'pages',\n+          `${route}.html`\n+        )\n+        const initialOutput = {\n+          id: route,\n+          type: AdapterOutputType.PRERENDER,\n+          pathname: route,\n+          parentOutputId: getParentOutput(srcRoute, route).id,\n+          fallback: {\n+            filePath,\n+            initialStatus,\n+            initialHeaders,\n+            initialExpiration,\n+            initialRevalidate,\n+          },\n+          config: {\n+            renderingMode,\n+          },\n+        }\n+        outputs.push(initialOutput)\n+\n+        if (dataRoute) {\n+          let dataFilePath = path.join(\n+            distDir,\n+            'server',\n+            'pages',\n+            `${route}.json`\n+          )\n+\n+          if (isAppPage) {\n+            // When experimental PPR is enabled, we expect that the data\n+            // that should be served as a part of the prerender should\n+            // be from the prefetch data route. If this isn't enabled\n+            // for ppr, the only way to get the data is from the data\n+            // route.\n+            dataFilePath = path.join(\n+              distDir,\n+              'server',\n+              'app',\n+              prefetchDataRoute &&\n+                renderingMode === RenderingMode.PARTIALLY_STATIC\n+                ? prefetchDataRoute\n+                : dataRoute\n+            )\n+          }\n+\n+          outputs.push({\n+            ...initialOutput,\n+            id: dataRoute,\n+            pathname: dataRoute,\n+            fallback: {\n+              ...initialOutput.fallback,\n+              filePath: dataFilePath,\n+            },\n           })\n         }\n       }\n \n-      // TODO: prerender assets\n+      for (const dynamicRoute in prerenderManifest.dynamicRoutes) {\n+        const {\n+          fallback,\n+          fallbackExpire,\n+          fallbackRevalidate,\n+          fallbackHeaders,\n+          fallbackStatus,\n+          dataRoute,\n+        } = prerenderManifest.dynamicRoutes[dynamicRoute]\n+\n+        const isAppPage = dataRoute?.endsWith('.rsc')\n+\n+        const initialOutput = {\n+          id: dynamicRoute,\n+          type: AdapterOutputType.PRERENDER,\n+          pathname: dynamicRoute,\n+          parentOutputId: getParentOutput(dynamicRoute, dynamicRoute).id,\n+          fallback:\n+            typeof fallback === 'string'\n+              ? {\n+                  filePath: path.join(\n+                    distDir,\n+                    'server',\n+                    isAppPage ? 'app' : 'pages',\n+                    fallback\n+                  ),\n+                  initialStatus: fallbackStatus,\n+                  initialHeaders: fallbackHeaders,\n+                  initialExpiration: fallbackExpire,\n+                  initialRevalidate: fallbackRevalidate,\n+                }\n+              : undefined,\n+        }\n+        outputs.push(initialOutput)\n+\n+        if (dataRoute) {\n+          outputs.push({\n+            ...initialOutput,\n+            id: dataRoute,\n+            pathname: dataRoute,\n+          })\n+        }\n+      }\n+\n+      // TODO: should these be normal outputs or meta on associated routes?\n+      // for (const route of prerenderManifest.notFoundRoutes) {\n+      //   // The fallback here is the 404 page if statically generated\n+      //   // if it is not then the fallback is empty and it is generated\n+      //   // at runtime\n+\n+      //   outputs.push({\n+      //     id: route,\n+      //     type: OutputType.PRERENDER,\n+      //     pathname: route,\n+      //     runtime: 'nodejs',\n+      //     fallback: {\n+      //       filePath: '',\n+      //       initialStatus: 404,\n+      //       initialHeaders: {},\n+      //     },\n+      //   })\n+      // }\n \n       await adapterMod.onBuildComplete({\n         routes: {"
        },
        {
            "sha": "b934157b42e65bbe2d31f387690d840182ad0899",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 33,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -372,39 +372,6 @@ type ManifestBuiltRoute = {\n   regex: string\n }\n \n-export enum RouteType {\n-  /**\n-   * `PAGES` represents all the React pages that are under `pages/`.\n-   */\n-  PAGES = 'PAGES',\n-  /**\n-   * `PAGES_API` represents all the API routes under `pages/api/`.\n-   */\n-  PAGES_API = 'PAGES_API',\n-  /**\n-   * `APP_PAGE` represents all the React pages that are under `app/` with the\n-   * filename of `page.{j,t}s{,x}`.\n-   */\n-  APP_PAGE = 'APP_PAGE',\n-  /**\n-   * `APP_ROUTE` represents all the API routes and metadata routes that are under `app/` with the\n-   * filename of `route.{j,t}s{,x}`.\n-   */\n-  APP_ROUTE = 'APP_ROUTE',\n-\n-  /**\n-   * `IMAGE` represents all the images that are generated by `next/image`.\n-   */\n-  // IMAGE = 'IMAGE',\n-\n-  /**\n-   * `STATIC_FILE` represents a static file (ie /_next/static)\n-   */\n-  STATIC_FILE = 'STATIC_FILE',\n-\n-  MIDDLEWARE = 'MIDDLEWARE',\n-}\n-\n export type ManifestRewriteRoute = ManifestBuiltRoute & Rewrite\n export type ManifestRedirectRoute = ManifestBuiltRoute & Redirect\n export type ManifestHeaderRoute = ManifestBuiltRoute & Header"
        },
        {
            "sha": "be4b0211edbfea05fb8546fa5878a2adea48888f",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 110,
            "deletions": 9,
            "changes": 119,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -1,6 +1,11 @@\n import os from 'os'\n import type { webpack } from 'next/dist/compiled/webpack/webpack'\n-import type { Header, Redirect, Rewrite } from '../lib/load-custom-routes'\n+import type {\n+  Header,\n+  Redirect,\n+  Rewrite,\n+  RouteHas,\n+} from '../lib/load-custom-routes'\n import { imageConfigDefault } from '../shared/lib/image-config'\n import type {\n   ImageConfig,\n@@ -17,10 +22,13 @@ import type {\n   ManifestRewriteRoute,\n   ManifestHeaderRoute,\n   ManifestRedirectRoute,\n-  RouteType,\n   ManifestRoute,\n } from '../build'\n import { isStableBuild } from '../shared/lib/canary-only'\n+import type { RenderingMode } from '../build/rendering-mode'\n+import type { Revalidate } from './lib/cache-control'\n+import type { AdapterOutputType } from '../shared/lib/constants'\n+import type { MiddlewareMatcher } from '../build/analysis/get-page-static-info'\n \n export type NextConfigComplete = Required<NextConfig> & {\n   images: Required<ImageConfigComplete>\n@@ -35,19 +43,112 @@ export type NextConfigComplete = Required<NextConfig> & {\n }\n \n export type AdapterOutputs = Array<{\n+  /**\n+   * id is a unique identifier for the output\n+   */\n   id: string\n-  fallbackID?: string\n-  runtime?: 'nodejs' | 'edge'\n+  /**\n+   * pathname is the URL path that the output is meant to\n+   * be routable to at e.g. /blog/[slug] or /_next/static/chunks/chunk.js\n+   */\n   pathname: string\n-  allowQuery?: string[]\n+  /**\n+   * runtime for the route, this doesn't apply for prerender or static\n+   */\n+  runtime?: 'nodejs' | 'edge'\n+  /**\n+   * config related to the route\n+   */\n   config?: {\n+    /**\n+     * maxDuration is a segment config to signal the max\n+     * execution duration a route should be allowed before\n+     * it's timed out\n+     */\n     maxDuration?: number\n-    expiration?: number\n-    revalidate?: number\n+    /**\n+     * preferredRegion is a segment config to signal deployment\n+     * region preferences to the provider being used\n+     */\n+    preferredRegion?: string | string[]\n+\n+    /**\n+     * allowQuery is the allowed query values to be passed\n+     * to an ISR function and what should be considered for the cacheKey\n+     * e.g. for /blog/[slug], \"slug\" is the only allowQuery\n+     */\n+    allowQuery?: string[]\n+    /**\n+     * allowHeader is the allowed headers to be passed to an\n+     * ISR function to prevent accidentally poisoning the cache\n+     * from leaking additional information that can impact the render\n+     */\n+    allowHeader?: string[]\n+    /**\n+     * bypass for is a list of has conditions the cache\n+     * should be bypassed and invoked directly e.g. action header\n+     */\n+    bypassFor?: RouteHas[]\n+    /**\n+     * renderingMode signals PPR or not for a prerender\n+     */\n+    renderingMode?: RenderingMode\n+\n+    /**\n+     * matchers are the configured matchers for middleware\n+     */\n+    matchers?: MiddlewareMatcher[]\n+  }\n+  /**\n+   * For prerenders the parent output is the originating\n+   * page that the prerender is created from\n+   */\n+  parentOutputId?: string\n+  /**\n+   * fallback is initial cache data generated during build for a prerender\n+   */\n+  fallback?: {\n+    /**\n+     * path to the fallback file can be HTML/JSON/RSC\n+     */\n+    filePath: string\n+    /**\n+     * initialStatus is the status code that should be applied\n+     * when serving the fallback\n+     */\n+    initialStatus?: number\n+    /**\n+     * initialHeaders are the headers that should be sent when\n+     * serving the fallback\n+     */\n+    initialHeaders?: Record<string, string | string[]>\n+    /**\n+     * initial expiration is how long until the fallback entry\n+     * is considered expired and no longer valid to serve\n+     */\n+    initialExpiration?: number\n+    /**\n+     * initial revalidate is how long until the fallback is\n+     * considered stale and should be revalidated\n+     */\n+    initialRevalidate?: Revalidate\n   }\n+  /**\n+   * assets are all necessary traced assets that could be\n+   * loaded by the output to handle a request e.g. traced\n+   * node_modules or necessary manifests for Next.js\n+   */\n   assets?: Record<string, string>\n-  filePath: string\n-  type: RouteType\n+  /**\n+   * filePath is present for all cases except a Prerender\n+   * which may or may not have a fallback (initial cache entry).\n+   * The parent output will have a filePath for a prerender though\n+   */\n+  filePath?: string\n+  /**\n+   * type of output\n+   */\n+  type: AdapterOutputType\n }>\n \n export interface NextAdapter {"
        },
        {
            "sha": "bf4c84bb770e83b0db7c65c99a0bff6db0d854ab",
            "filename": "packages/next/src/shared/lib/constants.ts",
            "status": "modified",
            "additions": 39,
            "deletions": 0,
            "changes": 39,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fconstants.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fconstants.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fconstants.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -12,6 +12,45 @@ export const COMPILER_NAMES = {\n \n export type CompilerNameValues = ValueOf<typeof COMPILER_NAMES>\n \n+export enum AdapterOutputType {\n+  /**\n+   * `PAGES` represents all the React pages that are under `pages/`.\n+   */\n+  PAGES = 'PAGES',\n+\n+  /**\n+   * `PAGES_API` represents all the API routes under `pages/api/`.\n+   */\n+  PAGES_API = 'PAGES_API',\n+  /**\n+   * `APP_PAGE` represents all the React pages that are under `app/` with the\n+   * filename of `page.{j,t}s{,x}`.\n+   */\n+  APP_PAGE = 'APP_PAGE',\n+\n+  /**\n+   * `APP_ROUTE` represents all the API routes and metadata routes that are under `app/` with the\n+   * filename of `route.{j,t}s{,x}`.\n+   */\n+  APP_ROUTE = 'APP_ROUTE',\n+\n+  /**\n+   * `PRERENDER` represents an ISR enabled route that might\n+   * have a seeded cache entry or fallback generated during build\n+   */\n+  PRERENDER = 'PRERENDER',\n+\n+  /**\n+   * `STATIC_FILE` represents a static file (ie /_next/static)\n+   */\n+  STATIC_FILE = 'STATIC_FILE',\n+\n+  /**\n+   * `MIDDLEWARE` represents the middleware output if present\n+   */\n+  MIDDLEWARE = 'MIDDLEWARE',\n+}\n+\n export const COMPILER_INDEXES: {\n   [compilerKey in CompilerNameValues]: number\n } = {"
        },
        {
            "sha": "4f9f5412b0a17a68fc08fb492391bb979b7e7b2e",
            "filename": "test/production/adapter-config/adapter-config.test.ts",
            "status": "modified",
            "additions": 80,
            "deletions": 2,
            "changes": 82,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fadapter-config.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fadapter-config.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fadapter-config.test.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -1,19 +1,97 @@\n+import fs from 'fs'\n import { nextTestSetup } from 'e2e-utils'\n+import type { NextAdapter } from 'next'\n+import { AdapterOutputType } from 'next/constants'\n \n describe('adapter-config', () => {\n   const { next } = nextTestSetup({\n     files: __dirname,\n   })\n \n   it('should apply modifyConfig from adapter', async () => {\n-    // we apply basePath /docs so ensure that applied\n+    // we apply basePath of \"/docs\" to ensure modify was called\n     const res = await next.fetch('/')\n     expect(res.status).toBe(404)\n \n-    const res2 = await next.fetch('/docs')\n+    const res2 = await next.fetch('/docs/node-pages')\n     expect(res2.status).toBe(200)\n     expect(await res2.text()).toContain('hello world')\n \n     expect(next.cliOutput).toContain('called modify config in adapter')\n   })\n+\n+  it('should call onBuildComplete with correct context', async () => {\n+    expect(next.cliOutput).toContain('onBuildComplete called')\n+\n+    const buildContext: Parameters<NextAdapter['onBuildComplete']>[0] =\n+      await next.readJSON('build-complete.json')\n+\n+    const outputMap = new Map<string, (typeof buildContext.outputs)[0]>()\n+    const prerenderOutputs: typeof buildContext.outputs = []\n+    const staticOutputs: typeof buildContext.outputs = []\n+    const nodeOutputs: typeof buildContext.outputs = []\n+    const edgeOutputs: typeof buildContext.outputs = []\n+\n+    for (const output of buildContext.outputs) {\n+      if (outputMap.has(output.id)) {\n+        throw new Error(\n+          `multiple outputs with same ID ${JSON.stringify(\n+            {\n+              first: outputMap.get(output.id),\n+              second: output,\n+            },\n+            null,\n+            2\n+          )}`\n+        )\n+      }\n+\n+      switch (output.type) {\n+        case AdapterOutputType.PRERENDER: {\n+          prerenderOutputs.push(output)\n+          break\n+        }\n+        case AdapterOutputType.STATIC_FILE: {\n+          staticOutputs.push(output)\n+          break\n+        }\n+        case AdapterOutputType.APP_PAGE:\n+        case AdapterOutputType.APP_ROUTE:\n+        case AdapterOutputType.PAGES:\n+        case AdapterOutputType.PAGES_API: {\n+          if (output.runtime === 'nodejs') {\n+            nodeOutputs.push(output)\n+          } else if (output.runtime === 'edge') {\n+            edgeOutputs.push(output)\n+          } else {\n+            throw new Error(\n+              `unrecognized runtime on ${JSON.stringify(output, null, 2)}`\n+            )\n+          }\n+          break\n+        }\n+        default: {\n+          throw new Error(`unrecognized output type ${output.type}`)\n+        }\n+      }\n+    }\n+\n+    expect(nodeOutputs.length).toBeGreaterThan(0)\n+    expect(edgeOutputs.length).toBeGreaterThan(0)\n+    expect(staticOutputs.length).toBeGreaterThan(0)\n+    expect(prerenderOutputs.length).toBeGreaterThan(0)\n+\n+    for (const output of staticOutputs) {\n+      expect(output.id).toBeTruthy()\n+      expect(output.pathname).toStartWith('/_next/static')\n+      expect(fs.existsSync(output.filePath)).toBe(true)\n+    }\n+\n+    expect(buildContext.routes).toEqual({\n+      dynamicRoutes: expect.toBeArray(),\n+      rewrites: expect.toBeObject(),\n+      redirects: expect.toBeArray(),\n+      headers: expect.toBeArray(),\n+    })\n+  })\n })"
        },
        {
            "sha": "39ffff2461109359fac8e6391960a7d3c294aecf",
            "filename": "test/production/adapter-config/app/edge-app/page.tsx",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fedge-app%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fedge-app%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fapp%2Fedge-app%2Fpage.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,10 @@\n+export const runtime = 'edge'\n+\n+export default function Page() {\n+  return (\n+    <>\n+      <p>/edge-app</p>\n+      <p>now: {Date.now()}</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "1dfcbd410aa8462abf3d050d2bd8e7d437bf6c95",
            "filename": "test/production/adapter-config/app/edge-route/route.ts",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fedge-route%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fedge-route%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fapp%2Fedge-route%2Froute.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,10 @@\n+import { NextRequest, NextResponse } from 'next/server'\n+\n+export const runtime = 'edge'\n+\n+export function GET(req: NextRequest) {\n+  console.log(req.url.toString())\n+  return NextResponse.json({\n+    now: Date.now(),\n+  })\n+}"
        },
        {
            "sha": "27732850d6bac1a48c7aee540c5f5cb3cacb2713",
            "filename": "test/production/adapter-config/app/isr-app/[slug]/page.tsx",
            "status": "added",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-app%2F%5Bslug%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-app%2F%5Bslug%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-app%2F%5Bslug%5D%2Fpage.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,16 @@\n+export const dynamic = 'force-static'\n+\n+export function generateStaticParams() {\n+  return [{ slug: 'first' }]\n+}\n+\n+export default async function Page({ params }) {\n+  const { slug } = await params\n+  return (\n+    <>\n+      <p>/isr-app/[slug]</p>\n+      <p>now: {Date.now()}</p>\n+      <p>slug: {slug}</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "f905dc551e407b339b8941186a18397abe179243",
            "filename": "test/production/adapter-config/app/isr-app/page.tsx",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-app%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-app%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-app%2Fpage.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,8 @@\n+export default function Page() {\n+  return (\n+    <>\n+      <p>/isr-app</p>\n+      <p>now: {Date.now()}</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "ee02caa3883eccdf2688ea8d762b279639dd0d88",
            "filename": "test/production/adapter-config/app/isr-route/[slug]/route.ts",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-route%2F%5Bslug%5D%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-route%2F%5Bslug%5D%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-route%2F%5Bslug%5D%2Froute.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,15 @@\n+import { NextRequest, NextResponse } from 'next/server'\n+\n+export const dynamic = 'force-static'\n+\n+export function generateStaticParams() {\n+  return [{ slug: 'first' }]\n+}\n+\n+export async function GET(req: NextRequest, { params }) {\n+  console.log(req.url.toString(), await params)\n+\n+  return NextResponse.json({\n+    now: Date.now(),\n+  })\n+}"
        },
        {
            "sha": "b032880f3d0f194af9872c25e0ed94fd0d2c9149",
            "filename": "test/production/adapter-config/app/isr-route/route.ts",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-route%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-route%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fapp%2Fisr-route%2Froute.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,11 @@\n+import { NextRequest, NextResponse } from 'next/server'\n+\n+export const dynamic = 'force-static'\n+\n+export async function GET(req: NextRequest, { params }) {\n+  console.log(req.url.toString(), await params)\n+\n+  return NextResponse.json({\n+    now: Date.now(),\n+  })\n+}"
        },
        {
            "sha": "9e313094feba978c3bb997c40a7d0c2ebe4a6deb",
            "filename": "test/production/adapter-config/app/layout.tsx",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fapp%2Flayout.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,8 @@\n+export default function Layout({ children }) {\n+  return (\n+    <html lang=\"en\">\n+      <head />\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "2be40dc0fd883e8b6cb1121a5d3b763ebf577d3d",
            "filename": "test/production/adapter-config/app/node-app/page.tsx",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fnode-app%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fnode-app%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fapp%2Fnode-app%2Fpage.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,10 @@\n+export const dynamic = 'force-dynamic'\n+\n+export default function Page() {\n+  return (\n+    <>\n+      <p>/node-app</p>\n+      <p>now: {Date.now()}</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "e805f38976b0d4133752f86f42cfd0bd1a2e725d",
            "filename": "test/production/adapter-config/app/node-route/route.ts",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fnode-route%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fapp%2Fnode-route%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fapp%2Fnode-route%2Froute.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,8 @@\n+import { NextRequest, NextResponse } from 'next/server'\n+\n+export function GET(req: NextRequest) {\n+  console.log(req.url.toString())\n+  return NextResponse.json({\n+    now: Date.now(),\n+  })\n+}"
        },
        {
            "sha": "d86fc39f3c85e75e1e0d4f0af758b7ea19201334",
            "filename": "test/production/adapter-config/my-adapter.mjs",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fmy-adapter.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fmy-adapter.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fmy-adapter.mjs?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -1,3 +1,5 @@\n+import fs from 'fs'\n+\n // @ts-check\n /** @type {import('next').NextAdapter } */\n const myAdapter = {\n@@ -7,6 +9,14 @@ const myAdapter = {\n     config.basePath = '/docs'\n     return config\n   },\n+  onBuildComplete: async (ctx) => {\n+    console.log('onBuildComplete called')\n+\n+    await fs.promises.writeFile(\n+      'build-complete.json',\n+      JSON.stringify(ctx, null, 2)\n+    )\n+  },\n }\n \n export default myAdapter"
        },
        {
            "sha": "a27c0be952e5ca1066a1e511cf04e3e837bf9f02",
            "filename": "test/production/adapter-config/pages/api/edge-pages.ts",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fapi%2Fedge-pages.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fapi%2Fedge-pages.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fpages%2Fapi%2Fedge-pages.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,9 @@\n+import { NextRequest, NextResponse } from 'next/server'\n+\n+export const config = {\n+  runtime: 'edge',\n+}\n+\n+export default function handler(req: NextRequest) {\n+  return NextResponse.json({ now: Date.now() })\n+}"
        },
        {
            "sha": "dff00723dc8353f3ab4632148aaefe9d4638c8a2",
            "filename": "test/production/adapter-config/pages/api/node-pages.ts",
            "status": "added",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fapi%2Fnode-pages.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fapi%2Fnode-pages.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fpages%2Fapi%2Fnode-pages.ts?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,6 @@\n+import { NextApiRequest, NextApiResponse } from 'next/dist/types'\n+\n+export default function handler(req: NextApiRequest, res: NextApiResponse) {\n+  console.log(req.url)\n+  res.json({ now: Date.now() })\n+}"
        },
        {
            "sha": "07479b7d4b22f616d14627ac4c120a0801da46bd",
            "filename": "test/production/adapter-config/pages/edge-pages/index.tsx",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fedge-pages%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fedge-pages%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fpages%2Fedge-pages%2Findex.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,12 @@\n+export const config = {\n+  runtime: 'experimental-edge',\n+}\n+\n+export default function Page() {\n+  return (\n+    <>\n+      <p>/edge-pages</p>\n+      <p>now: {Date.now()}</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "ff7159d9149feeb1eb8f4b7bbeadb2e26c20b053",
            "filename": "test/production/adapter-config/pages/index.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/46709a2a0eb9d3fd92320e1bd4889006c90c5293/test%2Fproduction%2Fadapter-config%2Fpages%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/46709a2a0eb9d3fd92320e1bd4889006c90c5293/test%2Fproduction%2Fadapter-config%2Fpages%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fpages%2Findex.tsx?ref=46709a2a0eb9d3fd92320e1bd4889006c90c5293",
            "patch": "@@ -1,3 +0,0 @@\n-export default function Page() {\n-  return <p>hello world</p>\n-}"
        },
        {
            "sha": "441696ae61871e969a059f27dabc5f8dcffffc78",
            "filename": "test/production/adapter-config/pages/isr-pages-fallback-false/[slug]/index.tsx",
            "status": "added",
            "additions": 42,
            "deletions": 0,
            "changes": 42,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages-fallback-false%2F%5Bslug%5D%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages-fallback-false%2F%5Bslug%5D%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages-fallback-false%2F%5Bslug%5D%2Findex.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,42 @@\n+export function getStaticPaths() {\n+  return {\n+    paths: [\n+      {\n+        params: { slug: 'first' },\n+      },\n+      {\n+        params: { slug: 'second' },\n+      },\n+      {\n+        params: { slug: 'not-found' },\n+      },\n+    ],\n+    fallback: false,\n+  }\n+}\n+\n+export function getStaticProps({ params }) {\n+  if (params.slug === 'not-found') {\n+    return {\n+      notFound: true,\n+    }\n+  }\n+\n+  return {\n+    props: {\n+      params,\n+      now: Date.now(),\n+    },\n+    revalidate: params.slug === 'first' ? 60 : undefined,\n+  }\n+}\n+\n+export default function Page(props) {\n+  return (\n+    <>\n+      <p>/isr-pages-fallback-false</p>\n+      <p>now: {Date.now()}</p>\n+      <p>{JSON.stringify(props)}</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "4015a8f4d591940fbc9efd3c96e8be5e450af564",
            "filename": "test/production/adapter-config/pages/isr-pages-fallback-true/[slug]/index.tsx",
            "status": "added",
            "additions": 39,
            "deletions": 0,
            "changes": 39,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages-fallback-true%2F%5Bslug%5D%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages-fallback-true%2F%5Bslug%5D%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages-fallback-true%2F%5Bslug%5D%2Findex.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,39 @@\n+export function getStaticPaths() {\n+  return {\n+    paths: [\n+      {\n+        params: { slug: 'first' },\n+      },\n+      {\n+        params: { slug: 'second' },\n+      },\n+    ],\n+    fallback: true,\n+  }\n+}\n+\n+export function getStaticProps({ params }) {\n+  if (params.slug === 'not-found') {\n+    return {\n+      notFound: true,\n+    }\n+  }\n+\n+  return {\n+    props: {\n+      params,\n+      now: Date.now(),\n+    },\n+    revalidate: params.slug === 'first' ? 60 : undefined,\n+  }\n+}\n+\n+export default function Page(props) {\n+  return (\n+    <>\n+      <p>/isr-pages-fallback-true</p>\n+      <p>now: {Date.now()}</p>\n+      <p>{JSON.stringify(props)}</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "0fcf4314f82066906591f71aae6009f46d12eb26",
            "filename": "test/production/adapter-config/pages/isr-pages/[slug]/index.tsx",
            "status": "added",
            "additions": 35,
            "deletions": 0,
            "changes": 35,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages%2F%5Bslug%5D%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages%2F%5Bslug%5D%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages%2F%5Bslug%5D%2Findex.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,35 @@\n+export function getStaticPaths() {\n+  return {\n+    paths: [\n+      {\n+        params: { slug: 'first' },\n+      },\n+      {\n+        params: { slug: 'second' },\n+      },\n+      {\n+        params: { slug: 'not-found' },\n+      },\n+    ],\n+    fallback: 'blocking',\n+  }\n+}\n+\n+export function getStaticProps({ params }) {\n+  return {\n+    props: {\n+      params,\n+      now: Date.now(),\n+    },\n+    revalidate: params.slug === 'first' ? 60 : undefined,\n+  }\n+}\n+\n+export default function Page() {\n+  return (\n+    <>\n+      <p>/isr-pages/[slug]</p>\n+      <p>now: {Date.now()}</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "0c0e8a3158d2816f2198fd914f4cde1c7e350f5a",
            "filename": "test/production/adapter-config/pages/isr-pages/index.tsx",
            "status": "added",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fpages%2Fisr-pages%2Findex.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,16 @@\n+export function getStaticProps() {\n+  return {\n+    props: {\n+      now: Date.now(),\n+    },\n+  }\n+}\n+\n+export default function Page() {\n+  return (\n+    <>\n+      <p>/edge-pages</p>\n+      <p>now: {Date.now()}</p>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "d65ae83cccddc079b13cfb673418677fb9a4c97c",
            "filename": "test/production/adapter-config/pages/node-pages/index.tsx",
            "status": "added",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fnode-pages%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/7dd77fea73e7ffe5fe16973d27536063f32d89b7/test%2Fproduction%2Fadapter-config%2Fpages%2Fnode-pages%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fadapter-config%2Fpages%2Fnode-pages%2Findex.tsx?ref=7dd77fea73e7ffe5fe16973d27536063f32d89b7",
            "patch": "@@ -0,0 +1,18 @@\n+export function getServerSideProps() {\n+  return {\n+    props: {\n+      now: Date.now(),\n+    },\n+  }\n+}\n+\n+export default function Page(props) {\n+  return (\n+    <>\n+      <p>/node-pages</p>\n+      <p>hello world</p>\n+      <p>now: {Date.now()}</p>\n+      <p>{JSON.stringify(props)}</p>\n+    </>\n+  )\n+}"
        }
    ],
    "stats": {
        "total": 787,
        "additions": 718,
        "deletions": 69
    }
}