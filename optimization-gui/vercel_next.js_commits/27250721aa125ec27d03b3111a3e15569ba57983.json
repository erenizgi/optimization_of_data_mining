{
    "author": "huozhi",
    "message": "[segment explorer] redesign file pills and boundary trigger (#81302)",
    "sha": "27250721aa125ec27d03b3111a3e15569ba57983",
    "files": [
        {
            "sha": "73203461ade5494b473d388a64c63809d3368fe3",
            "filename": "packages/next/src/next-devtools/components/tooltip.css",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fcomponents%2Ftooltip.css",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fcomponents%2Ftooltip.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fcomponents%2Ftooltip.css?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -10,7 +10,6 @@\n   border-radius: 8px;\n   font-size: 14px;\n   line-height: 1.4;\n-  min-width: 200px;\n   pointer-events: none;\n }\n "
        },
        {
            "sha": "d46b3c52fc9837a7f57c56fa930ea42605d7f4f1",
            "filename": "packages/next/src/next-devtools/components/tooltip.tsx",
            "status": "modified",
            "additions": 18,
            "deletions": 7,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fcomponents%2Ftooltip.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fcomponents%2Ftooltip.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fcomponents%2Ftooltip.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -1,4 +1,4 @@\n-import { forwardRef } from 'react'\n+import { forwardRef, useRef, useState } from 'react'\n import { Tooltip as BaseTooltip } from '@base-ui-components/react/tooltip'\n import { cx } from '../dev-overlay/utils/cx'\n import './tooltip.css'\n@@ -7,40 +7,51 @@ type TooltipDirection = 'top' | 'bottom' | 'left' | 'right'\n \n interface TooltipProps {\n   children: React.ReactNode\n-  title: string\n+  title: string | null\n   direction?: TooltipDirection\n-  container?: HTMLElement | React.RefObject<HTMLElement>\n   arrowSize?: number\n   offset?: number\n   bgcolor?: string\n   color?: string\n+  className?: string\n }\n \n export const Tooltip = forwardRef<HTMLDivElement, TooltipProps>(\n   function Tooltip(\n     {\n+      className,\n       children,\n       title,\n       direction = 'top',\n-      container,\n       arrowSize = 6,\n       offset = 8,\n       bgcolor = '#000',\n       color = '#fff',\n     },\n     ref\n   ) {\n+    const [shadowRoot] = useState<ShadowRoot>(() => {\n+      const ownerDocument = document\n+      const portalNode = ownerDocument.querySelector('nextjs-portal')!\n+      return portalNode.shadowRoot! as ShadowRoot\n+    })\n+    const shadowRootRef = useRef<ShadowRoot>(shadowRoot)\n+    if (!title) {\n+      return children\n+    }\n     return (\n       <BaseTooltip.Provider>\n-        <BaseTooltip.Root delay={0}>\n+        <BaseTooltip.Root delay={400}>\n           <BaseTooltip.Trigger\n             ref={ref}\n             render={(triggerProps) => {\n               return <span {...triggerProps}>{children}</span>\n             }}\n           />\n \n-          <BaseTooltip.Portal {...(container && { container })}>\n+          {/* x-ref: https://github.com/mui/base-ui/issues/2224 */}\n+          {/* @ts-expect-error remove this expect-error once shadowRoot is supported as container */}\n+          <BaseTooltip.Portal container={shadowRootRef}>\n             <BaseTooltip.Positioner\n               side={direction}\n               sideOffset={offset + arrowSize}\n@@ -53,7 +64,7 @@ export const Tooltip = forwardRef<HTMLDivElement, TooltipProps>(\n               }\n             >\n               <BaseTooltip.Popup\n-                className=\"tooltip\"\n+                className={cx('tooltip', className)}\n                 style={\n                   {\n                     backgroundColor: bgcolor,"
        },
        {
            "sha": "37e57424fc179f6d1d32582780e87647c879fc45",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/utils.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 7,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Futils.ts?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -84,14 +84,15 @@ export function useClickOutside(\n   rootRef: React.RefObject<HTMLElement | null>,\n   triggerRef: React.RefObject<HTMLButtonElement | null>,\n   active: boolean,\n-  close: () => void\n+  close: () => void,\n+  ownerDocument?: Document\n ) {\n   useEffect(() => {\n     if (!active) {\n       return\n     }\n \n-    const ownerDocument = rootRef.current?.ownerDocument\n+    const ownerDocumentEl = ownerDocument || rootRef.current?.ownerDocument\n \n     function handleClickOutside(event: MouseEvent) {\n       const target = event.target as HTMLElement\n@@ -124,15 +125,15 @@ export function useClickOutside(\n       }\n     }\n \n-    ownerDocument?.addEventListener('mousedown', handleClickOutside)\n-    ownerDocument?.addEventListener('keydown', handleKeyDown)\n+    ownerDocumentEl?.addEventListener('mousedown', handleClickOutside)\n+    ownerDocumentEl?.addEventListener('keydown', handleKeyDown)\n \n     return () => {\n-      ownerDocument?.removeEventListener('mousedown', handleClickOutside)\n-      ownerDocument?.removeEventListener('keydown', handleKeyDown)\n+      ownerDocumentEl?.removeEventListener('mousedown', handleClickOutside)\n+      ownerDocumentEl?.removeEventListener('keydown', handleKeyDown)\n     }\n     // eslint-disable-next-line react-hooks/exhaustive-deps\n-  }, [active])\n+  }, [active, rootRef, triggerRef])\n }\n \n //////////////////////////////////////////////////////////////////////////////////////"
        },
        {
            "sha": "1ff78f923ab11049e8ee965b32b8ff4eef786060",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/overview/segment-boundary-trigger.css",
            "status": "modified",
            "additions": 58,
            "deletions": 24,
            "changes": 82,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-boundary-trigger.css",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-boundary-trigger.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-boundary-trigger.css?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -1,48 +1,80 @@\n .segment-boundary-trigger {\n-  margin-left: auto;\n-  gap: 8px;\n-}\n-\n-.segment-boundary-trigger-button {\n-  width: 24px;\n-  height: 24px;\n   display: flex;\n   align-items: center;\n-  justify-content: center;\n+  gap: 4px;\n+  padding: 4px 6px;\n+  line-height: 16px;\n   font-weight: 500;\n   color: var(--color-gray-1000);\n-  border-radius: 6px;\n-  background: transparent;\n+  border-radius: 999px;\n   border: none;\n+  font-size: var(--size-12);\n+  cursor: pointer;\n+  transition: background-color 0.15s ease;\n+}\n+\n+.segment-boundary-trigger-text {\n+  font-size: var(--size-12);\n+  font-weight: 500;\n+  user-select: none;\n+  display: inline-flex;\n+  align-items: center;\n+  justify-content: center;\n }\n \n-.segment-boundary-trigger-button svg {\n-  width: 20px;\n-  height: 20px;\n+.segment-boundary-trigger-text .plus-icon {\n+  transition: transform 0.25s ease;\n }\n \n-.segment-boundary-trigger-button:hover {\n-  background: var(--color-gray-400);\n-  color: var(--color-gray-1000);\n+.segment-boundary-trigger-text:hover .plus-icon {\n+  color: var(--color-gray-800);\n+}\n+\n+.segment-boundary-trigger svg {\n+  width: 14px;\n+  height: 14px;\n+  flex-shrink: 0;\n+  vertical-align: middle;\n+}\n+\n+.segment-boundary-trigger:hover svg {\n+  color: var(--color-gray-700);\n+}\n+\n+.segment-boundary-trigger[disabled] svg,\n+.segment-boundary-trigger[disabled]:hover svg {\n+  color: var(--color-gray-400);\n+  cursor: not-allowed;\n+}\n+\n+.segment-boundary-trigger--boundary {\n+  background: var(--color-background-100);\n+  box-shadow: inset 0 0 0 1px var(--color-gray-400);\n+}\n+\n+.segment-boundary-trigger--boundary:hover {\n+  background: var(--color-gray-200);\n }\n \n .segment-boundary-dropdown {\n   padding: 8px;\n   background: var(--color-background-100);\n   border: 1px solid var(--color-gray-400);\n-  border-radius: 6px;\n-  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n+  border-radius: 16px;\n   min-width: 120px;\n+  user-select: none;\n+  cursor: default;\n+  box-shadow: 0px 4px 8px -4px color-mix(in srgb, var(--color-gray-900) 4%, transparent);\n }\n \n .segment-boundary-dropdown-positioner {\n-  z-index: 2147483648;\n+  z-index: var(--top-z-index);\n }\n \n .segment-boundary-dropdown-item {\n   display: flex;\n   align-items: center;\n-  padding: 10px 8px;\n+  padding: 8px;\n   line-height: 20px;\n   font-size: 14px;\n   border-radius: 6px;\n@@ -78,8 +110,10 @@\n   border-bottom-right-radius: 4px;\n }\n \n-.segment-boundary-dropdown-divider {\n-  height: 1px;\n-  background: var(--color-gray-400);\n-  margin: 8px 0;\n+.segment-boundary-group-label {\n+  padding: 8px;\n+  font-size: 13px;\n+  line-height: 16px;\n+  font-weight: 400;\n+  color: var(--color-gray-900);\n }"
        },
        {
            "sha": "9ee4c8bd1ab3e8027017218dff1a2b50eedf14dc",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/overview/segment-boundary-trigger.tsx",
            "status": "modified",
            "additions": 183,
            "deletions": 75,
            "changes": 258,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-boundary-trigger.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-boundary-trigger.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-boundary-trigger.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -1,51 +1,131 @@\n import './segment-boundary-trigger.css'\n-import { useCallback, useState, useRef } from 'react'\n+import { useCallback, useState, useRef, useMemo } from 'react'\n import { Menu } from '@base-ui-components/react/menu'\n import type { SegmentNodeState } from '../../../userspace/app/segment-explorer-node'\n+import {\n+  isBoundaryFile,\n+  normalizeBoundaryFilename,\n+} from '../../../../server/app-render/segment-explorer-path'\n+import { cx } from '../../utils/cx'\n+import { useClickOutside } from '../errors/dev-tools-indicator/utils'\n+\n+const composeRefs = (...refs: (React.Ref<HTMLButtonElement> | undefined)[]) => {\n+  return (node: HTMLButtonElement | null) => {\n+    refs.forEach((ref) => {\n+      if (typeof ref === 'function') {\n+        ref(node)\n+      } else if (ref) {\n+        ref.current = node\n+      }\n+    })\n+  }\n+}\n \n export function SegmentBoundaryTrigger({\n-  onSelectBoundary,\n-  offset,\n+  nodeState,\n   boundaries,\n }: {\n-  onSelectBoundary: SegmentNodeState['setBoundaryType']\n-  offset: number\n+  nodeState: SegmentNodeState\n   boundaries: Record<'not-found' | 'loading' | 'error', string | null>\n }) {\n+  const currNode = nodeState\n+  const {\n+    pagePath,\n+    boundaryType,\n+    type,\n+    setBoundaryType: onSelectBoundary,\n+  } = currNode\n+  const fileType = type\n+\n+  const [isOpen, setIsOpen] = useState(false)\n+  // TODO: move this shadowRoot ref util to a shared hook or into context\n   const [shadowRoot] = useState<ShadowRoot>(() => {\n     const ownerDocument = document\n     const portalNode = ownerDocument.querySelector('nextjs-portal')!\n     return portalNode.shadowRoot! as ShadowRoot\n   })\n   const shadowRootRef = useRef<ShadowRoot>(shadowRoot)\n+  const triggerRef = useRef<HTMLButtonElement>(null)\n+  const popupRef = useRef<HTMLDivElement>(null)\n+\n+  // Click outside of popup should close the menu\n+  useClickOutside(\n+    popupRef,\n+    triggerRef,\n+    isOpen,\n+    () => {\n+      setIsOpen(false)\n+    },\n+    triggerRef.current?.ownerDocument\n+  )\n+\n+  const firstDefinedBoundary = Object.values(boundaries).find((v) => v !== null)\n+  const possibleExtension = firstDefinedBoundary\n+    ? firstDefinedBoundary.split('.')?.pop()\n+    : 'js'\n+\n+  const fileNames = useMemo(() => {\n+    return Object.fromEntries(\n+      Object.entries(boundaries).map(([key, filePath]) => {\n+        const fileName = normalizeBoundaryFilename(\n+          (filePath || '').split('/').pop() || `${key}.${possibleExtension}`\n+        )\n+        return [key, fileName]\n+      })\n+    ) as Record<keyof typeof boundaries, string>\n+  }, [boundaries, possibleExtension])\n+\n+  const fileName = (pagePath || '').split('/').pop() || ''\n+  const isBoundary = isBoundaryFile(fileType)\n+  const pageFileName = normalizeBoundaryFilename(\n+    boundaryType\n+      ? `page.${possibleExtension}`\n+      : fileName || `page.${possibleExtension}`\n+  )\n+\n+  const isPageOrBoundary = fileType && !isBoundary\n \n   const triggerOptions = [\n     {\n-      label: 'Trigger Loading',\n+      label: fileNames.loading,\n       value: 'loading',\n       icon: <LoadingIcon />,\n       disabled: !boundaries.loading,\n     },\n     {\n-      label: 'Trigger Error',\n+      label: fileNames.error,\n       value: 'error',\n       icon: <ErrorIcon />,\n       disabled: !boundaries.error,\n     },\n     {\n-      label: 'Trigger Not Found',\n+      label: fileNames['not-found'],\n       value: 'not-found',\n       icon: <NotFoundIcon />,\n       disabled: !boundaries['not-found'],\n     },\n   ]\n \n   const resetOption = {\n-    label: 'Reset',\n+    label: boundaryType ? 'Reset' : pageFileName,\n     value: 'reset',\n     icon: <ResetIcon />,\n+    disabled: boundaryType === null,\n   }\n \n+  const openInEditor = useCallback(({ filePath }: { filePath: string }) => {\n+    const params = new URLSearchParams({\n+      file: filePath,\n+      isAppRelativePath: '1',\n+    })\n+    fetch(\n+      `${\n+        process.env.__NEXT_ROUTER_BASEPATH || ''\n+      }/__nextjs_launch-editor?${params.toString()}`\n+      // Log the failures to console, not track them as console errors in error overlay\n+    ).catch(console.warn)\n+  }, [])\n+\n   const handleSelect = useCallback(\n     (value: string) => {\n       switch (value) {\n@@ -57,84 +137,85 @@ export function SegmentBoundaryTrigger({\n         case 'reset':\n           onSelectBoundary(null)\n           break\n+        case 'open-editor':\n+          if (pagePath) {\n+            openInEditor({ filePath: pagePath })\n+          }\n+          break\n         default:\n           break\n       }\n     },\n-    [onSelectBoundary]\n+    [onSelectBoundary, pagePath, openInEditor]\n   )\n \n+  const MergedRefTrigger = (\n+    triggerProps: React.ComponentProps<'button'> & {\n+      ref?: React.Ref<HTMLButtonElement>\n+    }\n+  ) => {\n+    const mergedRef = composeRefs(triggerProps.ref, triggerRef)\n+    return <Trigger {...triggerProps} ref={mergedRef} />\n+  }\n+\n   return (\n-    <div className=\"segment-boundary-trigger\">\n-      <Menu.Root delay={0}>\n-        <Menu.Trigger\n-          className=\"segment-boundary-trigger-button\"\n-          data-nextjs-dev-overlay-segment-boundary-trigger-button\n-          render={(triggerProps) => (\n-            <button {...triggerProps} type=\"button\">\n-              <DropdownIcon />\n-            </button>\n-          )}\n-        />\n+    <Menu.Root delay={0} modal={false} open={isOpen} onOpenChange={setIsOpen}>\n+      <Menu.Trigger\n+        className={cx(\n+          'segment-boundary-trigger',\n+          !isPageOrBoundary && 'segment-boundary-trigger--boundary'\n+        )}\n+        data-nextjs-dev-overlay-segment-boundary-trigger-button\n+        render={MergedRefTrigger}\n+      />\n+\n+      {/* @ts-expect-error remove this expect-error once shadowRoot is supported as container */}\n+      <Menu.Portal container={shadowRootRef}>\n+        <Menu.Positioner\n+          className=\"segment-boundary-dropdown-positioner\"\n+          side=\"bottom\"\n+          align=\"center\"\n+          sideOffset={6}\n+          arrowPadding={8}\n+          ref={popupRef}\n+        >\n+          <Menu.Popup className=\"segment-boundary-dropdown\">\n+            {\n+              <Menu.Group>\n+                <Menu.GroupLabel className=\"segment-boundary-group-label\">\n+                  Toggle Overrides\n+                </Menu.GroupLabel>\n+                {triggerOptions.map((option) => (\n+                  <Menu.Item\n+                    key={option.value}\n+                    className=\"segment-boundary-dropdown-item\"\n+                    onClick={() => handleSelect(option.value)}\n+                    disabled={option.disabled}\n+                  >\n+                    {option.icon}\n+                    {option.label}\n+                  </Menu.Item>\n+                ))}\n+              </Menu.Group>\n+            }\n \n-        {/* @ts-expect-error remove this expect-error once shadowRoot is supported as container */}\n-        <Menu.Portal container={shadowRootRef}>\n-          <Menu.Positioner\n-            className=\"segment-boundary-dropdown-positioner\"\n-            side=\"bottom\"\n-            align=\"center\"\n-            sideOffset={offset}\n-            arrowPadding={8}\n-          >\n-            <Menu.Popup className=\"segment-boundary-dropdown\">\n-              {triggerOptions.map((option) => (\n+            <Menu.Group>\n+              {\n                 <Menu.Item\n-                  key={option.value}\n+                  key={resetOption.value}\n                   className=\"segment-boundary-dropdown-item\"\n-                  onClick={() => handleSelect(option.value)}\n-                  disabled={option.disabled}\n+                  onClick={() => handleSelect(resetOption.value)}\n+                  disabled={resetOption.disabled}\n                 >\n-                  {option.icon}\n-                  {option.label}\n+                  {resetOption.icon}\n+                  {resetOption.label}\n                 </Menu.Item>\n-              ))}\n-\n-              <div className=\"segment-boundary-dropdown-divider\" />\n-\n-              <Menu.Item\n-                key={resetOption.value}\n-                className=\"segment-boundary-dropdown-item\"\n-                onClick={() => handleSelect(resetOption.value)}\n-              >\n-                {resetOption.icon}\n-                {resetOption.label}\n-              </Menu.Item>\n-            </Menu.Popup>\n-          </Menu.Positioner>\n-        </Menu.Portal>\n-      </Menu.Root>\n-    </div>\n-  )\n-}\n-\n-/**\n- * Inline svg icons for the dropdown trigger.\n- * The child svg icons like `rect` are fixed size, so they can be used as shared scalable icons.\n- */\n-function DropdownIcon() {\n-  return (\n-    <svg\n-      width=\"20px\"\n-      height=\"20px\"\n-      viewBox=\"0 0 16 16\"\n-      fill=\"none\"\n-      xmlns=\"http://www.w3.org/2000/svg\"\n-    >\n-      <path\n-        d=\"M2.5 6.5C3.32843 6.5 4 7.17157 4 8C4 8.82843 3.32843 9.5 2.5 9.5C1.67157 9.5 1 8.82843 1 8C1 7.17157 1.67157 6.5 2.5 6.5ZM8 6.5C8.82843 6.5 9.5 7.17157 9.5 8C9.5 8.82843 8.82843 9.5 8 9.5C7.17157 9.5 6.5 8.82843 6.5 8C6.5 7.17157 7.17157 6.5 8 6.5ZM13.5 6.5C14.3284 6.5 15 7.17157 15 8C15 8.82843 14.3284 9.5 13.5 9.5C12.6716 9.5 12 8.82843 12 8C12 7.17157 12.6716 6.5 13.5 6.5Z\"\n-        fill=\"currentColor\"\n-      />\n-    </svg>\n+              }\n+            </Menu.Group>\n+          </Menu.Popup>\n+        </Menu.Positioner>\n+      </Menu.Portal>\n+    </Menu.Root>\n   )\n }\n \n@@ -235,3 +316,30 @@ function ResetIcon() {\n     </svg>\n   )\n }\n+\n+function SwitchIcon(props: React.SVGProps<SVGSVGElement>) {\n+  return (\n+    <svg strokeLinejoin=\"round\" viewBox=\"0 0 16 16\" {...props}>\n+      <path\n+        fillRule=\"evenodd\"\n+        clipRule=\"evenodd\"\n+        d=\"M8.7071 2.39644C8.31658 2.00592 7.68341 2.00592 7.29289 2.39644L4.46966 5.21966L3.93933 5.74999L4.99999 6.81065L5.53032 6.28032L7.99999 3.81065L10.4697 6.28032L11 6.81065L12.0607 5.74999L11.5303 5.21966L8.7071 2.39644ZM5.53032 9.71966L4.99999 9.18933L3.93933 10.25L4.46966 10.7803L7.29289 13.6035C7.68341 13.9941 8.31658 13.9941 8.7071 13.6035L11.5303 10.7803L12.0607 10.25L11 9.18933L10.4697 9.71966L7.99999 12.1893L5.53032 9.71966Z\"\n+        fill=\"currentColor\"\n+      ></path>\n+    </svg>\n+  )\n+}\n+\n+export function Trigger(props: React.ComponentProps<'button'>) {\n+  return (\n+    <button\n+      {...props}\n+      className={cx('segment-boundary-trigger', props.className)}\n+      role=\"button\"\n+    >\n+      <span className=\"segment-boundary-trigger-text\">\n+        <SwitchIcon className=\"plus-icon\" />\n+      </span>\n+    </button>\n+  )\n+}"
        },
        {
            "sha": "34de2a2b0c0eef791fedd40786611bfa5711968f",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/overview/segment-explorer.css",
            "status": "modified",
            "additions": 92,
            "deletions": 26,
            "changes": 118,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-explorer.css",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-explorer.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-explorer.css?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -1,6 +1,10 @@\n .segment-explorer-content {\n   font-size: var(--size-14);\n   padding: 0 8px;\n+  width: 700px;\n+  height: 400px;\n+  max-width: calc(100vw - 40px);\n+  max-height: calc(100vh - 240px);\n }\n \n .segment-explorer-page-route-bar {\n@@ -17,6 +21,7 @@\n   color: var(--color-gray-1000);\n   font-family: var(--font-mono);\n   white-space: nowrap;\n+  line-height: 20px;\n }\n \n .segment-explorer-item {\n@@ -54,7 +59,7 @@\n }\n \n .segment-explorer-filename--path {\n-  margin-right: 8px;\n+  margin-right: auto;\n }\n .segment-explorer-filename--path small {\n   display: inline-block;\n@@ -68,57 +73,118 @@\n .segment-explorer-files {\n   display: inline-flex;\n   gap: 8px;\n+  margin-left: auto;\n+}\n+\n+.segment-explorer-files + .segment-boundary-trigger {\n+  margin-left: 8px;\n }\n \n .segment-explorer-file-label {\n   display: inline-flex;\n   align-items: center;\n   justify-content: center;\n-  height: 20px;\n-  padding: 2px 6px;\n+  padding: 4px 6px;\n   border-radius: 16px;\n+  line-height: 16px;\n   font-size: var(--size-12);\n   font-weight: 500;\n   user-select: none;\n   cursor: pointer;\n-}\n-\n-.segment-explorer-file-label:hover {\n-  filter: brightness(1.05);\n-}\n-\n-.segment-explorer-file-label--layout,\n-.segment-explorer-file-label--template,\n-.segment-explorer-file-label--default {\n   background-color: var(--color-gray-300);\n   color: var(--color-gray-1000);\n }\n-.segment-explorer-file-label--page {\n-  background-color: var(--color-blue-300);\n-  color: var(--color-blue-900);\n-}\n-.segment-explorer-file-label--not-found,\n-.segment-explorer-file-label--forbidden,\n-.segment-explorer-file-label--unauthorized {\n+\n+.segment-explorer-file-label--overridden {\n   background-color: var(--color-amber-300);\n   color: var(--color-amber-900);\n }\n-.segment-explorer-file-label--loading {\n-  background-color: var(--color-green-300);\n-  color: var(--color-green-900);\n+\n+.segment-explorer-file-label .code-icon {\n+  opacity: 0;\n+  margin-left: 0;\n+  width: 0;\n+  transition: all 0.15s ease-in-out;\n }\n-.segment-explorer-file-label--error,\n-.segment-explorer-file-label--global-error {\n-  background-color: var(--color-red-300);\n-  color: var(--color-red-900);\n+.segment-explorer-file-label:hover .code-icon {\n+  opacity: 1;\n+  width: 12px;\n+  margin-left: 4px;\n+}\n+\n+.segment-explorer-file-label:hover {\n+  filter: brightness(0.95);\n }\n+\n .segment-explorer-file-label--builtin {\n   background-color: transparent;\n   color: var(--color-gray-900);\n   border: 1px dashed var(--color-gray-500);\n+  height: 24px;\n   cursor: default;\n }\n .segment-explorer-file-label--builtin svg {\n   margin-left: 4px;\n   margin-right: -4px;\n }\n+\n+/* Footer styles */\n+.segment-explorer-footer {\n+  padding: 8px;\n+  border-top: 1px solid var(--color-gray-400);\n+  background-color: var(--color-background-100);\n+  user-select: none;\n+}\n+\n+.segment-explorer-footer-button {\n+  display: flex;\n+  align-items: center;\n+  justify-content: center;\n+  gap: 8px;\n+  width: 100%;\n+  padding: 6px;\n+  background: var(--color-background-100);\n+  border: 1px solid var(--color-gray-400);\n+  border-radius: 6px;\n+  color: var(--color-gray-1000);\n+  font-size: var(--size-14);\n+  font-weight: 500;\n+  cursor: pointer;\n+  transition: background-color 0.15s ease;\n+}\n+\n+.segment-explorer-footer-button:hover:not(:disabled) {\n+  background: var(--color-gray-200);\n+}\n+\n+.segment-explorer-footer-button--disabled {\n+  opacity: 0.5;\n+  cursor: not-allowed;\n+}\n+\n+.segment-explorer-footer-text {\n+  text-align: center;\n+}\n+\n+.segment-explorer-footer-badge {\n+  display: inline-flex;\n+  align-items: center;\n+  justify-content: center;\n+  min-width: 20px;\n+  height: 20px;\n+  padding: 0 6px;\n+  background: var(--color-amber-300);\n+  color: var(--color-amber-900);\n+  border-radius: 10px;\n+  font-size: var(--size-12);\n+  font-weight: 600;\n+  line-height: 1;\n+}\n+\n+.segment-explorer-file-label-tooltip--sm {\n+  white-space: nowrap;\n+}\n+\n+.segment-explorer-file-label-tooltip--lg {\n+  min-width: 200px;\n+}"
        },
        {
            "sha": "bb93c081fcea111907fb1c4b27c65256f8ecc73c",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/overview/segment-explorer.tsx",
            "status": "modified",
            "additions": 229,
            "deletions": 78,
            "changes": 307,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-explorer.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-explorer.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Foverview%2Fsegment-explorer.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -4,9 +4,9 @@ import {\n   type SegmentTrieNode,\n } from '../../segment-explorer-trie'\n import { cx } from '../../utils/cx'\n-import { SegmentBoundaryTrigger } from './segment-boundary-trigger'\n+import { SegmentBoundaryTrigger, Trigger } from './segment-boundary-trigger'\n import { Tooltip } from '../../../components/tooltip'\n-import { useRef, useState } from 'react'\n+import { useCallback, useMemo } from 'react'\n import {\n   BUILTIN_PREFIX,\n   getBoundaryOriginFileType,\n@@ -18,6 +18,45 @@ const isFileNode = (node: SegmentTrieNode) => {\n   return !!node.value?.type && !!node.value?.pagePath\n }\n \n+// Utility functions for global boundary management\n+function traverseTreeAndResetBoundaries(node: SegmentTrieNode) {\n+  // Reset this node's boundary if it has setBoundaryType function\n+  if (node.value?.setBoundaryType) {\n+    node.value.setBoundaryType(null)\n+  }\n+\n+  // Recursively traverse children\n+  Object.values(node.children).forEach((child) => {\n+    if (child) {\n+      traverseTreeAndResetBoundaries(child)\n+    }\n+  })\n+}\n+\n+function countActiveBoundaries(node: SegmentTrieNode): number {\n+  let count = 0\n+\n+  // Count this node's boundary override if it's active\n+  // Only count when there's a non \":boundary\" type and it has an active override (boundaryType is not null)\n+  // This means the file is showing an overridden boundary instead of its original file\n+  if (\n+    node.value?.setBoundaryType &&\n+    node.value.boundaryType !== null &&\n+    !isBoundaryFile(node.value.type)\n+  ) {\n+    count++\n+  }\n+\n+  // Recursively count children\n+  Object.values(node.children).forEach((child) => {\n+    if (child) {\n+      count += countActiveBoundaries(child)\n+    }\n+  })\n+\n+  return count\n+}\n+\n function PageRouteBar({ page }: { page: string }) {\n   return (\n     <div className=\"segment-explorer-page-route-bar\">\n@@ -27,6 +66,36 @@ function PageRouteBar({ page }: { page: string }) {\n   )\n }\n \n+function SegmentExplorerFooter({\n+  activeBoundariesCount,\n+  onGlobalReset,\n+}: {\n+  activeBoundariesCount: number\n+  onGlobalReset: () => void\n+}) {\n+  const hasActiveOverrides = activeBoundariesCount > 0\n+\n+  return (\n+    <div className=\"segment-explorer-footer\">\n+      <button\n+        className={`segment-explorer-footer-button ${!hasActiveOverrides ? 'segment-explorer-footer-button--disabled' : ''}`}\n+        onClick={hasActiveOverrides ? onGlobalReset : undefined}\n+        disabled={!hasActiveOverrides}\n+        type=\"button\"\n+      >\n+        <span className=\"segment-explorer-footer-text\">\n+          Clear Segment Overrides\n+        </span>\n+        {hasActiveOverrides && (\n+          <span className=\"segment-explorer-footer-badge\">\n+            {activeBoundariesCount}\n+          </span>\n+        )}\n+      </button>\n+    </div>\n+  )\n+}\n+\n export function PageSegmentTree({\n   isAppRouter,\n   page,\n@@ -35,6 +104,19 @@ export function PageSegmentTree({\n   page: string\n }) {\n   const tree = useSegmentTree()\n+\n+  // Count active boundaries for the badge\n+  const activeBoundariesCount = useMemo(() => {\n+    return isAppRouter ? countActiveBoundaries(tree) : 0\n+  }, [tree, isAppRouter])\n+\n+  // Global reset handler\n+  const handleGlobalReset = useCallback(() => {\n+    if (isAppRouter) {\n+      traverseTreeAndResetBoundaries(tree)\n+    }\n+  }, [tree, isAppRouter])\n+\n   return (\n     <div data-nextjs-devtools-panel-segments-explorer>\n       {isAppRouter && <PageRouteBar page={page} />}\n@@ -48,6 +130,12 @@ export function PageSegmentTree({\n           <p>Route Info currently is only available for the App Router.</p>\n         )}\n       </div>\n+      {isAppRouter && (\n+        <SegmentExplorerFooter\n+          activeBoundariesCount={activeBoundariesCount}\n+          onGlobalReset={handleGlobalReset}\n+        />\n+      )}\n     </div>\n   )\n }\n@@ -61,40 +149,45 @@ function PageSegmentTreeLayerPresentation({\n   node: SegmentTrieNode\n   level: number\n }) {\n-  const [shadowRoot] = useState<ShadowRoot | null>(() => {\n-    const portal = document.querySelector('nextjs-portal')\n-    if (!portal) return null\n-    return portal.shadowRoot as ShadowRoot\n-  })\n-  // This is a workaround as base-ui popup container only accepts shadowRoot when it's in a ref.\n-  const shadowRootRef = useRef<ShadowRoot>(shadowRoot)\n   const childrenKeys = Object.keys(node.children)\n \n   const sortedChildrenKeys = childrenKeys.sort((a, b) => {\n-    // Prioritize if it's a file convention like layout or page,\n-    // then the rest parallel routes.\n+    // Prioritize files with extensions over directories\n     const aHasExt = a.includes('.')\n     const bHasExt = b.includes('.')\n     if (aHasExt && !bHasExt) return -1\n     if (!aHasExt && bHasExt) return 1\n-    // Otherwise sort alphabetically\n \n-    // If it's file, sort by order: layout > template > page\n+    // For files, sort by priority: layout > template > page > boundaries > others\n     if (aHasExt && bHasExt) {\n       const aType = node.children[a]?.value?.type\n       const bType = node.children[b]?.value?.type\n \n-      if (aType === 'layout' && bType !== 'layout') return -1\n-      if (aType !== 'layout' && bType === 'layout') return 1\n-      if (aType === 'template' && bType !== 'template') return -1\n-      if (aType !== 'template' && bType === 'template') return 1\n+      // Define priority order\n+      const getTypePriority = (type: string | undefined): number => {\n+        if (!type) return 5\n+        if (type === 'layout') return 1\n+        if (type === 'template') return 2\n+        if (type === 'page') return 3\n+        if (isBoundaryFile(type)) return 4\n+        return 5\n+      }\n \n-      // If both are the same type, sort by pagePath\n+      const aPriority = getTypePriority(aType)\n+      const bPriority = getTypePriority(bType)\n+\n+      // Sort by priority first\n+      if (aPriority !== bPriority) {\n+        return aPriority - bPriority\n+      }\n+\n+      // If same priority, sort by file path\n       const aFilePath = node.children[a]?.value?.pagePath || ''\n       const bFilePath = node.children[b]?.value?.pagePath || ''\n       return aFilePath.localeCompare(bFilePath)\n     }\n \n+    // For directories, sort alphabetically\n     return a.localeCompare(b)\n   })\n \n@@ -103,7 +196,6 @@ function PageSegmentTreeLayerPresentation({\n \n   const folderChildrenKeys: string[] = []\n   const filesChildrenKeys: string[] = []\n-  let pageChild = null\n \n   for (const childKey of sortedChildrenKeys) {\n     const childNode = node.children[childKey]\n@@ -119,19 +211,29 @@ function PageSegmentTreeLayerPresentation({\n     folderChildrenKeys.push(childKey)\n   }\n \n-  for (const fileChildSegment of filesChildrenKeys) {\n-    const childNode = node.children[fileChildSegment]\n+  let firstChild = null\n+\n+  for (let i = sortedChildrenKeys.length - 1; i >= 0; i--) {\n+    const childNode = node.children[sortedChildrenKeys[i]]\n     if (!childNode || !childNode.value) continue\n \n-    // If it's a page node, we can use it as the page child\n-    if (\n-      childNode.value.type !== 'layout' &&\n-      childNode.value.type !== 'template'\n-    ) {\n-      pageChild = childNode\n-      break // We only need one page child\n+    const isBoundary = isBoundaryFile(childNode.value.type)\n+\n+    if (!firstChild && !isBoundary) {\n+      firstChild = childNode\n+      break\n     }\n   }\n+  let firstBoundaryChild = null\n+  for (const childKey of sortedChildrenKeys) {\n+    const childNode = node.children[childKey]\n+    if (!childNode || !childNode.value) continue\n+    if (isBoundaryFile(childNode.value.type)) {\n+      firstBoundaryChild = childNode\n+      break\n+    }\n+  }\n+  firstChild = firstChild || firstBoundaryChild\n \n   const hasFilesChildren = filesChildrenKeys.length > 0\n   const boundaries: Record<'not-found' | 'loading' | 'error', string | null> = {\n@@ -153,6 +255,14 @@ function PageSegmentTreeLayerPresentation({\n     }\n   })\n \n+  const filesChildrenKeysBesidesSelectedBoundary = filesChildrenKeys\n+\n+  const isChildPageOrBoundary =\n+    firstChild &&\n+    firstChild.value &&\n+    firstChild.value.type !== 'layout' &&\n+    firstChild.value.type !== 'template'\n+\n   return (\n     <>\n       {hasFilesChildren && (\n@@ -177,64 +287,85 @@ function PageSegmentTreeLayerPresentation({\n                 </span>\n               )}\n               {/* display all the file segments in this level */}\n-              {filesChildrenKeys.length > 0 && (\n+              {filesChildrenKeysBesidesSelectedBoundary.length > 0 && (\n                 <span className=\"segment-explorer-files\">\n-                  {filesChildrenKeys.map((fileChildSegment) => {\n-                    const childNode = node.children[fileChildSegment]\n-                    if (!childNode || !childNode.value) {\n-                      return null\n-                    }\n-                    // If it's boundary node, which marks the existence of the boundary not the rendered status,\n-                    // we don't need to present in the rendered files.\n-                    if (isBoundaryFile(childNode.value.type)) {\n-                      return null\n-                    }\n-                    const filePath = childNode.value.pagePath\n-                    const lastSegment = filePath.split('/').pop() || ''\n-                    const isBuiltin = filePath.startsWith(BUILTIN_PREFIX)\n-                    const fileName = normalizeBoundaryFilename(lastSegment)\n-\n-                    return (\n-                      <span\n-                        key={fileChildSegment}\n-                        onClick={() => {\n-                          if (isBuiltin) return\n-                          openInEditor({ filePath })\n-                        }}\n-                        className={cx(\n-                          'segment-explorer-file-label',\n-                          `segment-explorer-file-label--${childNode.value.type}`,\n-                          isBuiltin && 'segment-explorer-file-label--builtin'\n-                        )}\n-                      >\n-                        {fileName}\n-                        {isBuiltin && (\n-                          <Tooltip\n-                            direction=\"right\"\n-                            title={`The default Next.js not found is being shown. You can customize this page by adding your own ${fileName} file to the app/ directory.`}\n-                            // x-ref: https://github.com/mui/base-ui/issues/2224\n-                            // @ts-expect-error remove this expect-error once shadowRoot is supported as container\n-                            container={shadowRootRef}\n-                            offset={12}\n-                            bgcolor=\"var(--color-gray-1000)\"\n-                            color=\"var(--color-gray-100)\"\n+                  {filesChildrenKeysBesidesSelectedBoundary.map(\n+                    (fileChildSegment) => {\n+                      const childNode = node.children[fileChildSegment]\n+                      if (!childNode || !childNode.value) {\n+                        return null\n+                      }\n+                      // If it's boundary node, which marks the existence of the boundary not the rendered status,\n+                      // we don't need to present in the rendered files.\n+                      if (isBoundaryFile(childNode.value.type)) {\n+                        return null\n+                      }\n+                      // If it's a page/default file, don't show it as a separate label since it's represented by the dropdown button\n+                      // if (\n+                      //   childNode.value.type === 'page' ||\n+                      //   childNode.value.type === 'default'\n+                      // ) {\n+                      //   return null\n+                      // }\n+                      const filePath = childNode.value.pagePath\n+                      const lastSegment = filePath.split('/').pop() || ''\n+                      const isBuiltin = filePath.startsWith(BUILTIN_PREFIX)\n+                      const fileName = normalizeBoundaryFilename(lastSegment)\n+\n+                      const tooltipMessage = isBuiltin\n+                        ? `The default Next.js ${childNode.value.type} is being shown. You can customize this page by adding your own ${fileName} file to the app/ directory.`\n+                        : null\n+\n+                      const isOverridden = childNode.value.boundaryType !== null\n+\n+                      return (\n+                        <Tooltip\n+                          key={fileChildSegment}\n+                          className={\n+                            'segment-explorer-file-label-tooltip--' +\n+                            (isBuiltin ? 'lg' : 'sm')\n+                          }\n+                          direction={isBuiltin ? 'right' : 'top'}\n+                          title={tooltipMessage}\n+                          offset={12}\n+                          bgcolor=\"var(--color-gray-1000)\"\n+                          color=\"var(--color-gray-100)\"\n+                        >\n+                          <span\n+                            className={cx(\n+                              'segment-explorer-file-label',\n+                              `segment-explorer-file-label--${childNode.value.type}`,\n+                              isBuiltin &&\n+                                'segment-explorer-file-label--builtin',\n+                              isOverridden &&\n+                                'segment-explorer-file-label--overridden'\n+                            )}\n+                            onClick={() => {\n+                              openInEditor({ filePath })\n+                            }}\n                           >\n-                            <InfoIcon />\n-                          </Tooltip>\n-                        )}\n-                      </span>\n-                    )\n-                  })}\n+                            <span className=\"segment-explorer-file-label-text\">\n+                              {fileName}\n+                            </span>\n+                            {isBuiltin ? (\n+                              <InfoIcon />\n+                            ) : (\n+                              <CodeIcon className=\"code-icon\" />\n+                            )}\n+                          </span>\n+                        </Tooltip>\n+                      )\n+                    }\n+                  )}\n                 </span>\n               )}\n-              {/* TODO: only show triggers in dev panel remove this once the new panel UI is stable */}\n-              {pageChild && pageChild.value && (\n+              {firstChild && firstChild.value && isChildPageOrBoundary && (\n                 <SegmentBoundaryTrigger\n-                  offset={6}\n-                  onSelectBoundary={pageChild.value.setBoundaryType}\n+                  nodeState={firstChild.value}\n                   boundaries={boundaries}\n                 />\n               )}\n+              {!isChildPageOrBoundary && <Trigger disabled />}\n             </div>\n           </div>\n         </div>\n@@ -313,3 +444,23 @@ function BackArrowIcon() {\n     </svg>\n   )\n }\n+\n+function CodeIcon(props: React.SVGProps<SVGSVGElement>) {\n+  return (\n+    <svg\n+      width=\"12\"\n+      height=\"12\"\n+      strokeLinejoin=\"round\"\n+      viewBox=\"0 0 16 16\"\n+      fill=\"currentColor\"\n+      {...props}\n+    >\n+      <path\n+        fillRule=\"evenodd\"\n+        clipRule=\"evenodd\"\n+        d=\"M7.22763 14.1819L10.2276 2.18193L10.4095 1.45432L8.95432 1.09052L8.77242 1.81812L5.77242 13.8181L5.59051 14.5457L7.04573 14.9095L7.22763 14.1819ZM3.75002 12.0607L3.21969 11.5304L0.39647 8.70713C0.00594559 8.31661 0.00594559 7.68344 0.39647 7.29292L3.21969 4.46969L3.75002 3.93936L4.81068 5.00002L4.28035 5.53035L1.81068 8.00003L4.28035 10.4697L4.81068 11L3.75002 12.0607ZM12.25 12.0607L12.7804 11.5304L15.6036 8.70713C15.9941 8.31661 15.9941 7.68344 15.6036 7.29292L12.7804 4.46969L12.25 3.93936L11.1894 5.00002L11.7197 5.53035L14.1894 8.00003L11.7197 10.4697L11.1894 11L12.25 12.0607Z\"\n+        fill=\"currentColor\"\n+      />\n+    </svg>\n+  )\n+}"
        },
        {
            "sha": "cd6d265c182343c7bcbcb6e9460119a53d986baf",
            "filename": "packages/next/src/server/app-render/create-component-tree.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -28,6 +28,7 @@ import type {\n import { DEFAULT_SEGMENT_KEY } from '../../shared/lib/segment'\n import {\n   BOUNDARY_PREFIX,\n+  BOUNDARY_SUFFIX,\n   getConventionPathByType,\n } from './segment-explorer-path'\n \n@@ -565,7 +566,7 @@ async function createComponentTreeInternal({\n         // Add a suffix to avoid conflict with the segment view node representing rendered file.\n         // existence: not-found.tsx@boundary\n         // rendered: not-found.tsx\n-        const fileNameSuffix = '@boundary'\n+        const fileNameSuffix = BOUNDARY_SUFFIX\n         const segmentViewBoundaries = isSegmentViewEnabled ? (\n           <>\n             {notFoundFilePath && ("
        },
        {
            "sha": "965de0bc3c4a64d2a2b391bd2834ea8fd43f95ce",
            "filename": "test/development/app-dir/segment-explorer/app/no-layout/framework/blog/layout.tsx",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Fblog%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Fblog%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Fblog%2Flayout.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -0,0 +1,11 @@\n+import Link from 'next/link'\n+\n+export default function Layout({ children }: { children: React.ReactNode }) {\n+  return (\n+    <div>\n+      <h2>Layout - /no-layout/framework/blog</h2>\n+      {children}\n+      <Link href=\"/no-layout/framework\">To /no-layout/framework</Link>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "29362b2e4333c2392db9b07eac0909c6b7942e11",
            "filename": "test/development/app-dir/segment-explorer/app/no-layout/framework/blog/not-found.tsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Fblog%2Fnot-found.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Fblog%2Fnot-found.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Fblog%2Fnot-found.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -0,0 +1,3 @@\n+export default function NotFound() {\n+  return <div>Not Found - /no-layout/framework/blog/not-found</div>\n+}"
        },
        {
            "sha": "3cae8d5f3835b36e68c073b3383df8d937d681e4",
            "filename": "test/development/app-dir/segment-explorer/app/no-layout/framework/blog/page.tsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Fblog%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Fblog%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Fblog%2Fpage.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -0,0 +1,3 @@\n+export default function Page() {\n+  return <div>Page - /no-layout/framework/blog</div>\n+}"
        },
        {
            "sha": "b44d654a4b980cff0d0ee778ba33dea7f55cecdf",
            "filename": "test/development/app-dir/segment-explorer/app/no-layout/framework/layout.tsx",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fframework%2Flayout.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -0,0 +1,11 @@\n+import Link from 'next/link'\n+\n+export default function Layout({ children }: { children: React.ReactNode }) {\n+  return (\n+    <div>\n+      <h1>Layout - /no-layout/framework</h1>\n+      {children}\n+      <Link href=\"/no-layout\">To /no-layout</Link>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "03d587bcc1eb5c21b02a5733de21a7fd24f1f9ce",
            "filename": "test/development/app-dir/segment-explorer/app/no-layout/not-found.tsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fnot-found.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fnot-found.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fno-layout%2Fnot-found.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -0,0 +1,3 @@\n+export default function NotFound() {\n+  return <div>Not Found - /no-layout</div>\n+}"
        },
        {
            "sha": "e9a28ff7fd25f842e4f212f5167214332fe2f2eb",
            "filename": "test/development/app-dir/segment-explorer/app/parallel-routes/@bar/error.tsx",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fparallel-routes%2F%40bar%2Ferror.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fparallel-routes%2F%40bar%2Ferror.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Fparallel-routes%2F%40bar%2Ferror.tsx?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -0,0 +1,5 @@\n+'use client'\n+\n+export default function Error() {\n+  return <div>Error @bar</div>\n+}"
        },
        {
            "sha": "cd2a51678c32e2be03d24146fe06144ff5c71618",
            "filename": "test/development/app-dir/segment-explorer/segment-explorer.test.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/27250721aa125ec27d03b3111a3e15569ba57983/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts?ref=27250721aa125ec27d03b3111a3e15569ba57983",
            "patch": "@@ -206,4 +206,18 @@ describe('segment-explorer', () => {\n      default.tsx\"\n     `)\n   })\n+\n+  it('should display boundary selector when a segment has only boundary files', async () => {\n+    const browser = await next.browser('/no-layout/framework/blog')\n+    expect(await getSegmentExplorerContent(browser)).toMatchInlineSnapshot(`\n+     \"app/\n+     layout.tsx\n+     no-layout/\n+     framework/\n+     layout.tsx\n+     blog/\n+     layout.tsx\n+     page.tsx\"\n+    `)\n+  })\n })"
        }
    ],
    "stats": {
        "total": 859,
        "additions": 640,
        "deletions": 219
    }
}