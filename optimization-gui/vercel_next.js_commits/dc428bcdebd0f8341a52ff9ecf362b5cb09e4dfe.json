{
    "author": "mischnic",
    "message": "Turbopack: fix duplicate facade module (#78191)\n\nPreviously, the `[project]/turbopack/crates/turbopack-tests/tests/execution/turbopack/side-effects-optimization/basic/input/node_modules/tla/tla-reexported.js [test] (ecmascript) <export tlaReexported as tlaReexported2>` module was duplicated.\n\nA regression from https://github.com/vercel/next.js/pull/73544\nIn all of these synthetic modules reexporting modules, the AST isn't actually needed.",
    "sha": "dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe",
    "files": [
        {
            "sha": "fc73bef43871e7ab99b0dab99a523d3d35e4636d",
            "filename": "turbopack/crates/turbopack-core/src/resolve/mod.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs?ref=dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe",
            "patch": "@@ -3144,7 +3144,6 @@ async fn error_severity(resolve_options: Vc<ResolveOptions>) -> Result<ResolvedV\n     })\n }\n \n-// TODO this should become a TaskInput instead of a Vc\n /// ModulePart represents a part of a module.\n ///\n /// Currently this is used only for ESMs."
        },
        {
            "sha": "a05018c414418ce4663abf334c4551452d17aa4a",
            "filename": "turbopack/crates/turbopack-ecmascript/src/lib.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs?ref=dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe",
            "patch": "@@ -828,7 +828,7 @@ impl EcmascriptModuleContent {\n                 if let EcmascriptExports::EsmExports(exports) = *exports.await? {\n                     Some(\n                         exports\n-                            .code_generation(*module_graph, *chunking_context, *parsed)\n+                            .code_generation(*module_graph, *chunking_context, Some(*parsed))\n                             .await?,\n                     )\n                 } else {"
        },
        {
            "sha": "b8bf69ff6b8d854fe67e71249f581234e6059439",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/export.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 8,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fexport.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fexport.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fexport.rs?ref=dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe",
            "patch": "@@ -495,13 +495,13 @@ impl EsmExports {\n         self: Vc<Self>,\n         _module_graph: Vc<ModuleGraph>,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,\n-        parsed: Vc<ParseResult>,\n+        parsed: Option<Vc<ParseResult>>,\n     ) -> Result<CodeGeneration> {\n         let expanded = self.expand_exports().await?;\n-        let parsed = parsed.await?;\n-        let eval_context = match &*parsed {\n-            ParseResult::Ok { eval_context, .. } => Some(eval_context),\n-            _ => None,\n+        let parsed = if let Some(parsed) = parsed {\n+            Some(parsed.await?)\n+        } else {\n+            None\n         };\n \n         let mut dynamic_exports = Vec::<Box<Expr>>::new();\n@@ -529,9 +529,14 @@ impl EsmExports {\n                     } else {\n                         Cow::Borrowed(name.as_str())\n                     };\n-                    let ctxt = eval_context\n-                        .and_then(|eval_context| {\n-                            eval_context.imports.exports.get(name).map(|id| id.1)\n+                    let ctxt = parsed\n+                        .as_ref()\n+                        .and_then(|parsed| {\n+                            if let ParseResult::Ok { eval_context, .. } = &**parsed {\n+                                eval_context.imports.exports.get(name).map(|id| id.1)\n+                            } else {\n+                                None\n+                            }\n                         })\n                         .unwrap_or_default();\n "
        },
        {
            "sha": "2491de5b445e890de1c917eb0fce081a0b5268b1",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/facade/chunk_item.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 10,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fchunk_item.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fchunk_item.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fchunk_item.rs?ref=dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe",
            "patch": "@@ -68,11 +68,7 @@ impl EcmascriptChunkItem for EcmascriptModuleFacadeChunkItem {\n \n         let esm_code_gens = self\n             .module\n-            .code_generation(\n-                *self.module_graph,\n-                *chunking_context,\n-                *self.module.await?.parsed,\n-            )\n+            .code_generation(*self.module_graph, *chunking_context)\n             .await?;\n         let additional_code_gens = [\n             self.module\n@@ -84,11 +80,7 @@ impl EcmascriptChunkItem for EcmascriptModuleFacadeChunkItem {\n                 )\n                 .await?,\n             exports\n-                .code_generation(\n-                    *self.module_graph,\n-                    *chunking_context,\n-                    *self.module.await?.parsed,\n-                )\n+                .code_generation(*self.module_graph, *chunking_context, None)\n                 .await?,\n         ];\n         let code_gens = esm_code_gens.iter().chain(additional_code_gens.iter());"
        },
        {
            "sha": "9bf3107f1dbe44bac60c473313de04641037ff1b",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/facade/module.rs",
            "status": "modified",
            "additions": 29,
            "deletions": 68,
            "changes": 97,
            "blob_url": "https://github.com/vercel/next.js/blob/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fmodule.rs?ref=dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe",
            "patch": "@@ -17,7 +17,6 @@ use super::chunk_item::EcmascriptModuleFacadeChunkItem;\n use crate::{\n     chunk::{EcmascriptChunkPlaceable, EcmascriptExports},\n     code_gen::CodeGeneration,\n-    parse::ParseResult,\n     references::{\n         async_module::{AsyncModule, OptionAsyncModule},\n         esm::{EsmExport, EsmExports},\n@@ -32,19 +31,14 @@ use crate::{\n #[turbo_tasks::value]\n pub struct EcmascriptModuleFacadeModule {\n     pub module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>,\n-    pub parsed: ResolvedVc<ParseResult>,\n     pub ty: ModulePart,\n }\n \n #[turbo_tasks::value_impl]\n impl EcmascriptModuleFacadeModule {\n     #[turbo_tasks::function]\n-    pub fn new(\n-        module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>,\n-        parsed: ResolvedVc<ParseResult>,\n-        ty: ModulePart,\n-    ) -> Vc<Self> {\n-        EcmascriptModuleFacadeModule { module, parsed, ty }.cell()\n+    pub fn new(module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>, ty: ModulePart) -> Vc<Self> {\n+        EcmascriptModuleFacadeModule { module, ty }.cell()\n     }\n \n     #[turbo_tasks::function]\n@@ -71,7 +65,6 @@ impl EcmascriptModuleFacadeModule {\n         self: Vc<Self>,\n         module_graph: Vc<ModuleGraph>,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,\n-        parsed: Vc<ParseResult>,\n     ) -> Result<Vec<CodeGeneration>> {\n         let this = self.await?;\n         Ok(match &this.ty {\n@@ -93,13 +86,9 @@ impl EcmascriptModuleFacadeModule {\n                     .try_join()\n                     .await?;\n                 code_gens.push(\n-                    EcmascriptModulePartReference::new_part(\n-                        *this.module,\n-                        parsed,\n-                        ModulePart::locals(),\n-                    )\n-                    .code_generation(module_graph, chunking_context)\n-                    .await?,\n+                    EcmascriptModulePartReference::new_part(*this.module, ModulePart::locals())\n+                        .code_generation(module_graph, chunking_context)\n+                        .await?,\n                 );\n                 code_gens\n             }\n@@ -121,41 +110,29 @@ impl EcmascriptModuleFacadeModule {\n                     .try_join()\n                     .await?;\n                 code_gens.push(\n-                    EcmascriptModulePartReference::new_part(\n-                        *this.module,\n-                        parsed,\n-                        ModulePart::locals(),\n-                    )\n-                    .code_generation(module_graph, chunking_context)\n-                    .await?,\n+                    EcmascriptModulePartReference::new_part(*this.module, ModulePart::locals())\n+                        .code_generation(module_graph, chunking_context)\n+                        .await?,\n                 );\n                 code_gens\n             }\n             ModulePart::Facade => {\n                 vec![\n-                    EcmascriptModulePartReference::new_part(\n-                        *this.module,\n-                        parsed,\n-                        ModulePart::evaluation(),\n-                    )\n-                    .code_generation(module_graph, chunking_context)\n-                    .await?,\n-                    EcmascriptModulePartReference::new_part(\n-                        *this.module,\n-                        parsed,\n-                        ModulePart::exports(),\n-                    )\n-                    .code_generation(module_graph, chunking_context)\n-                    .await?,\n+                    EcmascriptModulePartReference::new_part(*this.module, ModulePart::evaluation())\n+                        .code_generation(module_graph, chunking_context)\n+                        .await?,\n+                    EcmascriptModulePartReference::new_part(*this.module, ModulePart::exports())\n+                        .code_generation(module_graph, chunking_context)\n+                        .await?,\n                 ]\n             }\n             ModulePart::RenamedNamespace { .. } => vec![\n-                EcmascriptModulePartReference::new(*this.module, parsed)\n+                EcmascriptModulePartReference::new(*this.module)\n                     .code_generation(module_graph, chunking_context)\n                     .await?,\n             ],\n             ModulePart::RenamedExport { .. } => vec![\n-                EcmascriptModulePartReference::new(*this.module, parsed)\n+                EcmascriptModulePartReference::new(*this.module)\n                     .code_generation(module_graph, chunking_context)\n                     .await?,\n             ],\n@@ -194,13 +171,9 @@ impl Module for EcmascriptModuleFacadeModule {\n                     .iter()\n                     .map(|r| ResolvedVc::upcast(*r))\n                     .chain(std::iter::once(ResolvedVc::upcast(\n-                        EcmascriptModulePartReference::new_part(\n-                            *self.module,\n-                            *self.parsed,\n-                            ModulePart::locals(),\n-                        )\n-                        .to_resolved()\n-                        .await?,\n+                        EcmascriptModulePartReference::new_part(*self.module, ModulePart::locals())\n+                            .to_resolved()\n+                            .await?,\n                     )))\n                     .collect()\n             }\n@@ -220,13 +193,9 @@ impl Module for EcmascriptModuleFacadeModule {\n                     .iter()\n                     .map(|r| ResolvedVc::upcast(*r))\n                     .chain(std::iter::once(ResolvedVc::upcast(\n-                        EcmascriptModulePartReference::new_part(\n-                            *self.module,\n-                            *self.parsed,\n-                            ModulePart::locals(),\n-                        )\n-                        .to_resolved()\n-                        .await?,\n+                        EcmascriptModulePartReference::new_part(*self.module, ModulePart::locals())\n+                            .to_resolved()\n+                            .await?,\n                     )))\n                     .collect()\n             }\n@@ -235,7 +204,6 @@ impl Module for EcmascriptModuleFacadeModule {\n                     ResolvedVc::upcast(\n                         EcmascriptModulePartReference::new_part(\n                             *self.module,\n-                            *self.parsed,\n                             ModulePart::evaluation(),\n                         )\n                         .to_resolved()\n@@ -244,7 +212,6 @@ impl Module for EcmascriptModuleFacadeModule {\n                     ResolvedVc::upcast(\n                         EcmascriptModulePartReference::new_part(\n                             *self.module,\n-                            *self.parsed,\n                             ModulePart::exports(),\n                         )\n                         .to_resolved()\n@@ -254,14 +221,14 @@ impl Module for EcmascriptModuleFacadeModule {\n             }\n             ModulePart::RenamedNamespace { .. } => {\n                 vec![ResolvedVc::upcast(\n-                    EcmascriptModulePartReference::new(*self.module, *self.parsed)\n+                    EcmascriptModulePartReference::new(*self.module)\n                         .to_resolved()\n                         .await?,\n                 )]\n             }\n             ModulePart::RenamedExport { .. } => {\n                 vec![ResolvedVc::upcast(\n-                    EcmascriptModulePartReference::new(*self.module, *self.parsed)\n+                    EcmascriptModulePartReference::new(*self.module)\n                         .to_resolved()\n                         .await?,\n                 )]\n@@ -323,7 +290,6 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                                     ResolvedVc::upcast(\n                                         EcmascriptModulePartReference::new_part(\n                                             *self.module,\n-                                            *self.parsed,\n                                             ModulePart::locals(),\n                                         )\n                                         .to_resolved()\n@@ -371,7 +337,6 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                             ResolvedVc::upcast(\n                                 EcmascriptModulePartReference::new_part(\n                                     *self.module,\n-                                    *self.parsed,\n                                     ModulePart::exports(),\n                                 )\n                                 .to_resolved()\n@@ -383,13 +348,9 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                     );\n                 }\n                 star_exports.push(ResolvedVc::upcast(\n-                    EcmascriptModulePartReference::new_part(\n-                        *self.module,\n-                        *self.parsed,\n-                        ModulePart::exports(),\n-                    )\n-                    .to_resolved()\n-                    .await?,\n+                    EcmascriptModulePartReference::new_part(*self.module, ModulePart::exports())\n+                        .to_resolved()\n+                        .await?,\n                 ));\n             }\n             ModulePart::RenamedExport {\n@@ -400,7 +361,7 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                     export.clone(),\n                     EsmExport::ImportedBinding(\n                         ResolvedVc::upcast(\n-                            EcmascriptModulePartReference::new(*self.module, *self.parsed)\n+                            EcmascriptModulePartReference::new(*self.module)\n                                 .to_resolved()\n                                 .await?,\n                         ),\n@@ -413,7 +374,7 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleFacadeModule {\n                 exports.insert(\n                     export.clone(),\n                     EsmExport::ImportedNamespace(ResolvedVc::upcast(\n-                        EcmascriptModulePartReference::new(*self.module, *self.parsed)\n+                        EcmascriptModulePartReference::new(*self.module)\n                             .to_resolved()\n                             .await?,\n                     )),"
        },
        {
            "sha": "b0224dac351d2efdb97a36fb939d40e9b67c1305",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/reference.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 15,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs?ref=dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe",
            "patch": "@@ -17,7 +17,7 @@ use super::{\n     facade::module::EcmascriptModuleFacadeModule, locals::module::EcmascriptModuleLocalsModule,\n };\n use crate::{\n-    chunk::EcmascriptChunkPlaceable, code_gen::CodeGeneration, parse::ParseResult,\n+    chunk::EcmascriptChunkPlaceable, code_gen::CodeGeneration,\n     references::esm::base::ReferencedAsset, runtime_functions::TURBOPACK_IMPORT,\n     utils::module_id_to_lit,\n };\n@@ -27,7 +27,6 @@ use crate::{\n #[turbo_tasks::value]\n pub struct EcmascriptModulePartReference {\n     pub module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>,\n-    pub parsed: ResolvedVc<ParseResult>,\n     pub part: Option<ModulePart>,\n }\n \n@@ -36,28 +35,18 @@ impl EcmascriptModulePartReference {\n     #[turbo_tasks::function]\n     pub fn new_part(\n         module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>,\n-        parsed: ResolvedVc<ParseResult>,\n         part: ModulePart,\n     ) -> Vc<Self> {\n         EcmascriptModulePartReference {\n             module,\n-            parsed,\n             part: Some(part),\n         }\n         .cell()\n     }\n \n     #[turbo_tasks::function]\n-    pub fn new(\n-        module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>,\n-        parsed: ResolvedVc<ParseResult>,\n-    ) -> Vc<Self> {\n-        EcmascriptModulePartReference {\n-            module,\n-            parsed,\n-            part: None,\n-        }\n-        .cell()\n+    pub fn new(module: ResolvedVc<Box<dyn EcmascriptChunkPlaceable>>) -> Vc<Self> {\n+        EcmascriptModulePartReference { module, part: None }.cell()\n     }\n }\n \n@@ -92,7 +81,7 @@ impl ModuleReference for EcmascriptModulePartReference {\n                 | ModulePart::Facade\n                 | ModulePart::RenamedExport { .. }\n                 | ModulePart::RenamedNamespace { .. } => Vc::upcast(\n-                    EcmascriptModuleFacadeModule::new(*self.module, *self.parsed, part.clone()),\n+                    EcmascriptModuleFacadeModule::new(*self.module, part.clone()),\n                 ),\n                 ModulePart::Export(..)\n                 | ModulePart::Internal(..)"
        },
        {
            "sha": "09b491a43d87b09eee05d53ae175734d7bb9a58e",
            "filename": "turbopack/crates/turbopack-ecmascript/src/tree_shake/asset.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fasset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fasset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fasset.rs?ref=dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe",
            "patch": "@@ -162,15 +162,13 @@ impl EcmascriptModulePartAsset {\n                     export_name: new_export,\n                     ..\n                 } = &*result.await?;\n-                let parsed = module.parse();\n                 let final_module = if let Some(new_export) = new_export {\n                     if *new_export == export {\n                         *final_module\n                     } else {\n                         ResolvedVc::upcast(\n                             EcmascriptModuleFacadeModule::new(\n                                 **final_module,\n-                                parsed,\n                                 ModulePart::renamed_export(new_export.clone(), export.clone()),\n                             )\n                             .to_resolved()\n@@ -181,7 +179,6 @@ impl EcmascriptModulePartAsset {\n                     ResolvedVc::upcast(\n                         EcmascriptModuleFacadeModule::new(\n                             **final_module,\n-                            parsed,\n                             ModulePart::renamed_namespace(export.clone()),\n                         )\n                         .to_resolved()"
        },
        {
            "sha": "e530e98f2c7a625fb88dd4bfa645e214657ffa7e",
            "filename": "turbopack/crates/turbopack/src/lib.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 10,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Flib.rs?ref=dc428bcdebd0f8341a52ff9ecf362b5cb09e4dfe",
            "patch": "@@ -54,7 +54,6 @@ use turbopack_core::{\n pub use turbopack_css as css;\n pub use turbopack_ecmascript as ecmascript;\n use turbopack_ecmascript::{\n-    parse::ParseResult,\n     references::external_module::{CachedExternalModule, CachedExternalType},\n     tree_shake::asset::EcmascriptModulePartAsset,\n };\n@@ -167,14 +166,12 @@ async fn apply_module_type(\n                         ))\n                     }\n                     Some(TreeShakingMode::ReexportsOnly) => {\n-                        let parsed = module.parse();\n                         if let Some(part) = part {\n                             match part {\n                                 ModulePart::Evaluation => {\n                                     if *module.get_exports().needs_facade().await? {\n                                         Vc::upcast(EcmascriptModuleFacadeModule::new(\n                                             Vc::upcast(module),\n-                                            parsed,\n                                             part,\n                                         ))\n                                     } else {\n@@ -192,20 +189,17 @@ async fn apply_module_type(\n                                             Vc::upcast(\n                                                 EcmascriptModuleFacadeModule::new(\n                                                     Vc::upcast(module),\n-                                                    parsed,\n                                                     ModulePart::exports(),\n                                                 )\n                                                 .resolve()\n                                                 .await?,\n                                             ),\n-                                            parsed,\n                                             part,\n                                             side_effect_free_packages,\n                                         )\n                                     } else {\n                                         apply_reexport_tree_shaking(\n                                             Vc::upcast(module.resolve().await?),\n-                                            parsed,\n                                             part,\n                                             side_effect_free_packages,\n                                         )\n@@ -220,7 +214,6 @@ async fn apply_module_type(\n                         } else if *module.get_exports().needs_facade().await? {\n                             Vc::upcast(EcmascriptModuleFacadeModule::new(\n                                 Vc::upcast(module),\n-                                parsed,\n                                 ModulePart::facade(),\n                             ))\n                         } else {\n@@ -283,7 +276,6 @@ async fn apply_module_type(\n #[turbo_tasks::function]\n async fn apply_reexport_tree_shaking(\n     module: Vc<Box<dyn EcmascriptChunkPlaceable>>,\n-    parsed: Vc<ParseResult>,\n     part: ModulePart,\n     side_effect_free_packages: Vc<Glob>,\n ) -> Result<Vc<Box<dyn Module>>> {\n@@ -299,14 +291,12 @@ async fn apply_reexport_tree_shaking(\n             } else {\n                 Vc::upcast(EcmascriptModuleFacadeModule::new(\n                     **final_module,\n-                    parsed,\n                     ModulePart::renamed_export(new_export.clone(), export.clone()),\n                 ))\n             }\n         } else {\n             Vc::upcast(EcmascriptModuleFacadeModule::new(\n                 **final_module,\n-                parsed,\n                 ModulePart::renamed_namespace(export.clone()),\n             ))\n         };"
        }
    ],
    "stats": {
        "total": 165,
        "additions": 49,
        "deletions": 116
    }
}