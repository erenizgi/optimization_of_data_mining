{
    "author": "bgw",
    "message": "chore(CI): Split i18n-data-fetching-redirect test suite into smaller and more parallel test suites (#78893)\n\nSame basic idea as https://github.com/vercel/next.js/pull/78787\n\nThis test suite has a lot of timeouts with rspack, which causes it to take a long time to run (though not quite long enough that it breaks the job).\n\nIn general, large test suites are good to break up, because they benefit from parallelism.",
    "sha": "97ffe87e2b66f306adfc6d8008b620864da897b1",
    "files": [
        {
            "sha": "d81e415f29ea23eb7fb141d5a60b34b6dcc2008c",
            "filename": "test/e2e/i18n-data-fetching-redirect/redirect-from-context.test.ts",
            "status": "added",
            "additions": 77,
            "deletions": 0,
            "changes": 77,
            "blob_url": "https://github.com/vercel/next.js/blob/97ffe87e2b66f306adfc6d8008b620864da897b1/test%2Fe2e%2Fi18n-data-fetching-redirect%2Fredirect-from-context.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/97ffe87e2b66f306adfc6d8008b620864da897b1/test%2Fe2e%2Fi18n-data-fetching-redirect%2Fredirect-from-context.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fi18n-data-fetching-redirect%2Fredirect-from-context.test.ts?ref=97ffe87e2b66f306adfc6d8008b620864da897b1",
            "patch": "@@ -0,0 +1,77 @@\n+import { join } from 'path'\n+import { createNext, FileRef } from 'e2e-utils'\n+import { NextInstance } from 'e2e-utils'\n+import { check } from 'next-test-utils'\n+import webdriver from 'next-webdriver'\n+\n+describe('i18n-data-fetching-redirect', () => {\n+  let next: NextInstance\n+\n+  // TODO: investigate tests failures on deploy\n+  if ((global as any).isNextDeploy) {\n+    it('should skip temporarily', () => {})\n+    return\n+  }\n+\n+  beforeAll(async () => {\n+    next = await createNext({\n+      files: {\n+        pages: new FileRef(join(__dirname, 'app/pages')),\n+        'next.config.js': new FileRef(join(__dirname, 'app/next.config.js')),\n+      },\n+      dependencies: {},\n+    })\n+  })\n+  afterAll(() => next.destroy())\n+\n+  describe('Redirect to locale from context', () => {\n+    test.each`\n+      path                       | locale\n+      ${'gssp-redirect'}         | ${'en'}\n+      ${'gssp-redirect'}         | ${'sv'}\n+      ${'gsp-blocking-redirect'} | ${'en'}\n+      ${'gsp-blocking-redirect'} | ${'sv'}\n+      ${'gsp-fallback-redirect'} | ${'en'}\n+      ${'gsp-fallback-redirect'} | ${'sv'}\n+    `('$path $locale', async ({ path, locale }) => {\n+      const browser = await webdriver(next.url, `/${locale}/${path}/from-ctx`)\n+\n+      await check(\n+        () => browser.eval('window.location.pathname'),\n+        `/${locale}/home`\n+      )\n+      expect(await browser.elementByCss('#router-locale').text()).toBe(locale)\n+      expect(await browser.elementByCss('#router-pathname').text()).toBe(\n+        '/home'\n+      )\n+      expect(await browser.elementByCss('#router-as-path').text()).toBe('/home')\n+    })\n+\n+    test.each`\n+      path                       | locale\n+      ${'gssp-redirect'}         | ${'en'}\n+      ${'gssp-redirect'}         | ${'sv'}\n+      ${'gsp-blocking-redirect'} | ${'en'}\n+      ${'gsp-blocking-redirect'} | ${'sv'}\n+      ${'gsp-fallback-redirect'} | ${'en'}\n+      ${'gsp-fallback-redirect'} | ${'sv'}\n+    `('next/link $path $locale', async ({ path, locale }) => {\n+      const browser = await webdriver(next.url, `/${locale}`)\n+      await browser.eval('window.beforeNav = 1')\n+\n+      await browser.elementByCss(`#to-${path}-from-ctx`).click()\n+\n+      await check(\n+        () => browser.eval('window.location.pathname'),\n+        `/${locale}/home`\n+      )\n+\n+      expect(await browser.eval('window.beforeNav')).toBe(1)\n+      expect(await browser.elementByCss('#router-locale').text()).toBe(locale)\n+      expect(await browser.elementByCss('#router-pathname').text()).toBe(\n+        '/home'\n+      )\n+      expect(await browser.elementByCss('#router-as-path').text()).toBe('/home')\n+    })\n+  })\n+})"
        },
        {
            "sha": "dc7074d94835353f2db7f5c275062280367ac7f6",
            "filename": "test/e2e/i18n-data-fetching-redirect/redirect.test.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 51,
            "changes": 51,
            "blob_url": "https://github.com/vercel/next.js/blob/97ffe87e2b66f306adfc6d8008b620864da897b1/test%2Fe2e%2Fi18n-data-fetching-redirect%2Fredirect.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/97ffe87e2b66f306adfc6d8008b620864da897b1/test%2Fe2e%2Fi18n-data-fetching-redirect%2Fredirect.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fi18n-data-fetching-redirect%2Fredirect.test.ts?ref=97ffe87e2b66f306adfc6d8008b620864da897b1",
            "patch": "@@ -91,55 +91,4 @@ describe('i18n-data-fetching-redirect', () => {\n       }\n     )\n   })\n-\n-  describe('Redirect to locale from context', () => {\n-    test.each`\n-      path                       | locale\n-      ${'gssp-redirect'}         | ${'en'}\n-      ${'gssp-redirect'}         | ${'sv'}\n-      ${'gsp-blocking-redirect'} | ${'en'}\n-      ${'gsp-blocking-redirect'} | ${'sv'}\n-      ${'gsp-fallback-redirect'} | ${'en'}\n-      ${'gsp-fallback-redirect'} | ${'sv'}\n-    `('$path $locale', async ({ path, locale }) => {\n-      const browser = await webdriver(next.url, `/${locale}/${path}/from-ctx`)\n-\n-      await check(\n-        () => browser.eval('window.location.pathname'),\n-        `/${locale}/home`\n-      )\n-      expect(await browser.elementByCss('#router-locale').text()).toBe(locale)\n-      expect(await browser.elementByCss('#router-pathname').text()).toBe(\n-        '/home'\n-      )\n-      expect(await browser.elementByCss('#router-as-path').text()).toBe('/home')\n-    })\n-\n-    test.each`\n-      path                       | locale\n-      ${'gssp-redirect'}         | ${'en'}\n-      ${'gssp-redirect'}         | ${'sv'}\n-      ${'gsp-blocking-redirect'} | ${'en'}\n-      ${'gsp-blocking-redirect'} | ${'sv'}\n-      ${'gsp-fallback-redirect'} | ${'en'}\n-      ${'gsp-fallback-redirect'} | ${'sv'}\n-    `('next/link $path $locale', async ({ path, locale }) => {\n-      const browser = await webdriver(next.url, `/${locale}`)\n-      await browser.eval('window.beforeNav = 1')\n-\n-      await browser.elementByCss(`#to-${path}-from-ctx`).click()\n-\n-      await check(\n-        () => browser.eval('window.location.pathname'),\n-        `/${locale}/home`\n-      )\n-\n-      expect(await browser.eval('window.beforeNav')).toBe(1)\n-      expect(await browser.elementByCss('#router-locale').text()).toBe(locale)\n-      expect(await browser.elementByCss('#router-pathname').text()).toBe(\n-        '/home'\n-      )\n-      expect(await browser.elementByCss('#router-as-path').text()).toBe('/home')\n-    })\n-  })\n })",
            "previous_filename": "test/e2e/i18n-data-fetching-redirect/index.test.ts"
        }
    ],
    "stats": {
        "total": 128,
        "additions": 77,
        "deletions": 51
    }
}