{
    "author": "mischnic",
    "message": "Turbopack: `ChunkingType::Parallel` with `hoisted` bool (#78922)\n\nAdd a `hoisted: bool` to `ChunkingType::Parallel` in preparation for scope hoisting (we can only merge modules if they are importing each other with ESM-import-style references (i.e. `hoisted: true`).\n\nPart of PACK-2960",
    "sha": "d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
    "files": [
        {
            "sha": "6a3375f4021309ef3c98c83937318282825b9c1f",
            "filename": "turbopack/crates/turbopack-core/src/chunk/chunk_group.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunk_group.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunk_group.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunk_group.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -264,9 +264,7 @@ pub async fn chunk_group_content(\n             };\n \n             Ok(match edge.ty {\n-                ChunkingType::Parallel\n-                | ChunkingType::ParallelInheritAsync\n-                | ChunkingType::Shared { .. } => {\n+                ChunkingType::Parallel { .. } | ChunkingType::Shared { .. } => {\n                     if is_available {\n                         GraphTraversalAction::Exclude\n                     } else if state"
        },
        {
            "sha": "58ed1a891f17963124120c8babb261d73848f46a",
            "filename": "turbopack/crates/turbopack-core/src/chunk/mod.rs",
            "status": "modified",
            "additions": 25,
            "deletions": 20,
            "changes": 45,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmod.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -162,7 +162,6 @@ pub trait OutputChunk: Asset {\n /// group\n #[derive(\n     Debug,\n-    Default,\n     Clone,\n     Hash,\n     TraceRawVcs,\n@@ -174,14 +173,15 @@ pub trait OutputChunk: Asset {\n     NonLocalValue,\n )]\n pub enum ChunkingType {\n-    /// Module is placed in the same chunk group and is loaded in parallel. It\n-    /// doesn't become an async module when the referenced module is async.\n-    #[default]\n-    Parallel,\n-    /// Module is placed in the same chunk group and is loaded in parallel. It\n-    /// becomes an async module when the referenced module is async.\n-    // TODO make inherit_async a separate field\n-    ParallelInheritAsync,\n+    /// The referenced module is placed in the same chunk group and is loaded in parallel.\n+    Parallel {\n+        /// Whether the parent module becomes an async module when the referenced module is async.\n+        /// This should happen for e.g. ESM imports, but not for CommonJS requires.\n+        inherit_async: bool,\n+        /// Whether the referenced module is executed always immediately before the parent module\n+        /// (corresponding to ESM import semantics).\n+        hoisted: bool,\n+    },\n     /// An async loader is placed into the referencing chunk and loads the\n     /// separate chunk group in which the module is placed.\n     Async,\n@@ -207,19 +207,18 @@ impl ChunkingType {\n     pub fn is_inherit_async(&self) -> bool {\n         matches!(\n             self,\n-            ChunkingType::ParallelInheritAsync\n-                | ChunkingType::Shared {\n-                    inherit_async: true,\n-                    ..\n-                }\n+            ChunkingType::Parallel {\n+                inherit_async: true,\n+                ..\n+            } | ChunkingType::Shared {\n+                inherit_async: true,\n+                ..\n+            }\n         )\n     }\n \n     pub fn is_parallel(&self) -> bool {\n-        matches!(\n-            self,\n-            ChunkingType::Parallel | ChunkingType::ParallelInheritAsync\n-        )\n+        matches!(self, ChunkingType::Parallel { .. })\n     }\n \n     pub fn is_merged(&self) -> bool {\n@@ -237,7 +236,10 @@ impl ChunkingType {\n \n     pub fn without_inherit_async(&self) -> Self {\n         match self {\n-            ChunkingType::Parallel | ChunkingType::ParallelInheritAsync => ChunkingType::Parallel,\n+            ChunkingType::Parallel { hoisted, .. } => ChunkingType::Parallel {\n+                hoisted: *hoisted,\n+                inherit_async: false,\n+            },\n             ChunkingType::Async => ChunkingType::Async,\n             ChunkingType::Isolated { _ty, merge_tag } => ChunkingType::Isolated {\n                 _ty: *_ty,\n@@ -267,7 +269,10 @@ pub struct ChunkingTypeOption(Option<ChunkingType>);\n #[turbo_tasks::value_trait]\n pub trait ChunkableModuleReference: ModuleReference + ValueToString {\n     fn chunking_type(self: Vc<Self>) -> Vc<ChunkingTypeOption> {\n-        Vc::cell(Some(ChunkingType::default()))\n+        Vc::cell(Some(ChunkingType::Parallel {\n+            inherit_async: false,\n+            hoisted: false,\n+        }))\n     }\n }\n "
        },
        {
            "sha": "e4c46d26ba6388dcf9f52639425c46f8ddd5afb8",
            "filename": "turbopack/crates/turbopack-core/src/introspect/utils.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fintrospect%2Futils.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fintrospect%2Futils.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fintrospect%2Futils.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -81,10 +81,7 @@ pub async fn children_from_module_references(\n         {\n             match &*chunkable.chunking_type().await? {\n                 None => {}\n-                Some(ChunkingType::Parallel) => key = parallel_reference_ty(),\n-                Some(ChunkingType::ParallelInheritAsync) => {\n-                    key = parallel_inherit_async_reference_ty()\n-                }\n+                Some(ChunkingType::Parallel { .. }) => key = parallel_reference_ty(),\n                 Some(ChunkingType::Async) => key = async_reference_ty(),\n                 Some(ChunkingType::Isolated { .. }) => key = isolated_reference_ty(),\n                 Some(ChunkingType::Shared { .. }) => key = shared_reference_ty(),"
        },
        {
            "sha": "a24d88da7e74bf027c00a45f4c8fe5269ded7ecf",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/async_module_info.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 22,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fasync_module_info.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fasync_module_info.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fasync_module_info.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -3,7 +3,6 @@ use rustc_hash::FxHashSet;\n use turbo_tasks::{ResolvedVc, TryJoinIterExt, Vc};\n \n use crate::{\n-    chunk::ChunkingType,\n     module::{Module, Modules},\n     module_graph::{GraphTraversalAction, ModuleGraph, SingleModuleGraph},\n };\n@@ -86,27 +85,8 @@ async fn compute_async_module_info_single(\n             let module = module.module();\n             let parent_module = parent_module.module;\n \n-            // edges.push((parent_module, module, async_modules.contains(&module)));\n-            match chunking_type {\n-                ChunkingType::ParallelInheritAsync\n-                | ChunkingType::Shared {\n-                    inherit_async: true,\n-                    ..\n-                } => {\n-                    if async_modules.contains(&module) {\n-                        async_modules.insert(parent_module);\n-                    }\n-                }\n-                ChunkingType::Parallel\n-                | ChunkingType::Async\n-                | ChunkingType::Isolated { .. }\n-                | ChunkingType::Traced\n-                | ChunkingType::Shared {\n-                    inherit_async: false,\n-                    ..\n-                } => {\n-                    // Nothing to propagate\n-                }\n+            if chunking_type.is_inherit_async() && async_modules.contains(&module) {\n+                async_modules.insert(parent_module);\n             }\n         },\n     )?;"
        },
        {
            "sha": "2f44a1733800571b6c93cc9e75a3bfac8fee7a0d",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/chunk_group_info.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fchunk_group_info.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fchunk_group_info.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fchunk_group_info.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -460,7 +460,7 @@ pub async fn compute_chunk_group_info(graph: &ModuleGraph) -> Result<Vc<ChunkGro\n                 }\n                 let chunk_groups = if let Some((parent, chunking_type)) = parent_info {\n                     match chunking_type {\n-                        ChunkingType::Parallel | ChunkingType::ParallelInheritAsync => {\n+                        ChunkingType::Parallel { .. } => {\n                             ChunkGroupInheritance::Inherit(parent.module)\n                         }\n                         ChunkingType::Async => ChunkGroupInheritance::ChunkGroup(Either::Left("
        },
        {
            "sha": "3cce653e213fef24142b9c1e327cb1f3308ef3b3",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/mod.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 2,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -1317,7 +1317,10 @@ struct SingleModuleGraphBuilderEdge {\n \n /// The chunking type that occurs most often, is handled more efficiently by not creating\n /// intermediate SingleModuleGraphBuilderNode::ChunkableReference nodes.\n-const COMMON_CHUNKING_TYPE: ChunkingType = ChunkingType::ParallelInheritAsync;\n+const COMMON_CHUNKING_TYPE: ChunkingType = ChunkingType::Parallel {\n+    inherit_async: true,\n+    hoisted: true,\n+};\n \n struct SingleModuleGraphBuilder<'a> {\n     visited_modules: &'a FxIndexMap<ResolvedVc<Box<dyn Module>>, GraphNodeIndex>,\n@@ -1425,7 +1428,10 @@ impl Visit<SingleModuleGraphBuilderNode> for SingleModuleGraphBuilder<'_> {\n                 target_ident,\n                 ..\n             } => match chunking_type {\n-                ChunkingType::Parallel => Span::current(),\n+                ChunkingType::Parallel {\n+                    inherit_async: false,\n+                    ..\n+                } => Span::current(),\n                 _ => {\n                     tracing::info_span!(\n                         \"chunkable reference\","
        },
        {
            "sha": "a897d417c1c792349aa98c7fdd26a8904cda0f89",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/module_batches.rs",
            "status": "modified",
            "additions": 18,
            "deletions": 3,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmodule_batches.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmodule_batches.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmodule_batches.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -297,7 +297,13 @@ impl PreBatches {\n                 std::iter::once(ResolvedVc::upcast(entry)),\n                 &mut state,\n                 |parent_info, node, state| {\n-                    let ty = parent_info.map_or(&ChunkingType::Parallel, |(_, ty)| ty);\n+                    let ty = parent_info.map_or(\n+                        &ChunkingType::Parallel {\n+                            inherit_async: false,\n+                            hoisted: false,\n+                        },\n+                        |(_, ty)| ty,\n+                    );\n                     let module = node.module;\n                     if !ty.is_parallel() {\n                         state.items.push(PreBatchItem::NonParallelEdge(\n@@ -688,7 +694,13 @@ pub async fn compute_module_batches(\n                         PreBatchItem::ParallelModule(module)\n                     } else {\n                         pre_batches.single_module_entries.insert(module);\n-                        PreBatchItem::NonParallelEdge(ChunkingType::Parallel, module)\n+                        PreBatchItem::NonParallelEdge(\n+                            ChunkingType::Parallel {\n+                                inherit_async: false,\n+                                hoisted: false,\n+                            },\n+                            module,\n+                        )\n                     }\n                 } else {\n                     item\n@@ -846,7 +858,10 @@ pub async fn compute_module_batches(\n                             index,\n                             batch_indicies[idx],\n                             ModuleBatchesGraphEdge {\n-                                ty: ChunkingType::Parallel,\n+                                ty: ChunkingType::Parallel {\n+                                    inherit_async: false,\n+                                    hoisted: false,\n+                                },\n                                 module: None,\n                             },\n                         );"
        },
        {
            "sha": "241d912bb7894089edfab6ee9480bea4f0804142",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/style_groups.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 9,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fstyle_groups.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fstyle_groups.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fstyle_groups.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -14,7 +14,7 @@ use crate::{\n     chunk::{\n         chunk_item_batch::attach_async_info_to_chunkable_module, ChunkItem,\n         ChunkItemBatchWithAsyncModuleInfo, ChunkItemWithAsyncModuleInfo, ChunkType,\n-        ChunkableModule, ChunkingContext, ChunkingType,\n+        ChunkableModule, ChunkingContext,\n     },\n     module::{Module, StyleType},\n     module_graph::{\n@@ -99,10 +99,7 @@ pub async fn compute_style_groups(\n             &mut (),\n             |parent_info, module, _| {\n                 if let Some((_, ModuleBatchesGraphEdge { ty, .. })) = parent_info {\n-                    if !matches!(\n-                        ty,\n-                        ChunkingType::Parallel | ChunkingType::ParallelInheritAsync\n-                    ) {\n+                    if !ty.is_parallel() {\n                         return Ok(GraphTraversalAction::Exclude);\n                     }\n                 }\n@@ -114,10 +111,7 @@ pub async fn compute_style_groups(\n             },\n             |parent_info, item, _| {\n                 if let Some((_, ModuleBatchesGraphEdge { ty, .. })) = parent_info {\n-                    if !matches!(\n-                        ty,\n-                        ChunkingType::Parallel | ChunkingType::ParallelInheritAsync\n-                    ) {\n+                    if !ty.is_parallel() {\n                         return;\n                     }\n                 }"
        },
        {
            "sha": "fa3b2604838d9a69e83001c3d4b94d4536397db2",
            "filename": "turbopack/crates/turbopack-core/src/reference/mod.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference%2Fmod.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -102,7 +102,10 @@ impl SingleChunkableModuleReference {\n impl ChunkableModuleReference for SingleChunkableModuleReference {\n     #[turbo_tasks::function]\n     fn chunking_type(self: Vc<Self>) -> Vc<ChunkingTypeOption> {\n-        Vc::cell(Some(ChunkingType::ParallelInheritAsync))\n+        Vc::cell(Some(ChunkingType::Parallel {\n+            inherit_async: true,\n+            hoisted: false,\n+        }))\n     }\n }\n "
        },
        {
            "sha": "0b98d5aeb949bd77c3f4c3335cbad05474a8631b",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/async_module.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fasync_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fasync_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fasync_module.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -87,7 +87,13 @@ async fn get_inherit_async_referenced_asset(\n     let Some(ty) = &*r.chunking_type().await? else {\n         return Ok(None);\n     };\n-    if !matches!(ty, ChunkingType::ParallelInheritAsync) {\n+    if !matches!(\n+        ty,\n+        ChunkingType::Parallel {\n+            inherit_async: true,\n+            ..\n+        }\n+    ) {\n         return Ok(None);\n     };\n     let referenced_asset: turbo_tasks::ReadRef<ReferencedAsset> ="
        },
        {
            "sha": "fe5d19989d71e47cd42c5f1e61748a7cf0c8724f",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/base.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 2,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbase.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbase.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fbase.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -273,12 +273,18 @@ impl ChunkableModuleReference for EsmAssetReference {\n         Ok(Vc::cell(\n             if let Some(chunking_type) = self.annotations.chunking_type() {\n                 match chunking_type {\n-                    \"parallel\" => Some(ChunkingType::ParallelInheritAsync),\n+                    \"parallel\" => Some(ChunkingType::Parallel {\n+                        inherit_async: true,\n+                        hoisted: true,\n+                    }),\n                     \"none\" => None,\n                     _ => return Err(anyhow!(\"unknown chunking_type: {}\", chunking_type)),\n                 }\n             } else {\n-                Some(ChunkingType::ParallelInheritAsync)\n+                Some(ChunkingType::Parallel {\n+                    inherit_async: true,\n+                    hoisted: true,\n+                })\n             },\n         ))\n     }"
        },
        {
            "sha": "d52115e788954a9cb0c55c6ebc613e6ac75f8f87",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/url.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Furl.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Furl.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Furl.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -127,7 +127,10 @@ impl ValueToString for UrlAssetReference {\n impl ChunkableModuleReference for UrlAssetReference {\n     #[turbo_tasks::function]\n     fn chunking_type(&self) -> Vc<ChunkingTypeOption> {\n-        Vc::cell(Some(ChunkingType::Parallel))\n+        Vc::cell(Some(ChunkingType::Parallel {\n+            inherit_async: false,\n+            hoisted: false,\n+        }))\n     }\n }\n "
        },
        {
            "sha": "2253998b6cd5c24669b06a580dd6a69729b3024b",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/reference.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/d9f491ef4a63cd168d7de91d6144f5a4ddf09112/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Freference.rs?ref=d9f491ef4a63cd168d7de91d6144f5a4ddf09112",
            "patch": "@@ -102,7 +102,10 @@ impl ModuleReference for EcmascriptModulePartReference {\n impl ChunkableModuleReference for EcmascriptModulePartReference {\n     #[turbo_tasks::function]\n     fn chunking_type(self: Vc<Self>) -> Vc<ChunkingTypeOption> {\n-        Vc::cell(Some(ChunkingType::ParallelInheritAsync))\n+        Vc::cell(Some(ChunkingType::Parallel {\n+            inherit_async: true,\n+            hoisted: true,\n+        }))\n     }\n }\n "
        }
    ],
    "stats": {
        "total": 156,
        "additions": 86,
        "deletions": 70
    }
}