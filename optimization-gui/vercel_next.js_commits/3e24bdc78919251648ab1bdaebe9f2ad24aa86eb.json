{
    "author": "huozhi",
    "message": "[test] separate rsc-basic tests (#78038)",
    "sha": "3e24bdc78919251648ab1bdaebe9f2ad24aa86eb",
    "files": [
        {
            "sha": "4826f9ebc34e0f52cdeecab5228b6e148b73f174",
            "filename": "test/e2e/app-dir/rsc-basic/rsc-basic-react-experimental.test.ts",
            "status": "added",
            "additions": 76,
            "deletions": 0,
            "changes": 76,
            "blob_url": "https://github.com/vercel/next.js/blob/3e24bdc78919251648ab1bdaebe9f2ad24aa86eb/test%2Fe2e%2Fapp-dir%2Frsc-basic%2Frsc-basic-react-experimental.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3e24bdc78919251648ab1bdaebe9f2ad24aa86eb/test%2Fe2e%2Fapp-dir%2Frsc-basic%2Frsc-basic-react-experimental.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frsc-basic%2Frsc-basic-react-experimental.test.ts?ref=3e24bdc78919251648ab1bdaebe9f2ad24aa86eb",
            "patch": "@@ -0,0 +1,76 @@\n+import { nextTestSetup } from 'e2e-utils'\n+\n+describe('react@experimental', () => {\n+  const { next } = nextTestSetup({\n+    files: __dirname,\n+    overrideFiles: {\n+      'next.config.js': `\n+        module.exports = {\n+          experimental: {\n+            taint: true,\n+          }\n+        }\n+      `,\n+    },\n+  })\n+\n+  it('should opt into the react@experimental when enabling $flag', async () => {\n+    const resPages$ = await next.render$('/app-react')\n+    const [\n+      ssrReact,\n+      ssrReactDOM,\n+      ssrClientReact,\n+      ssrClientReactDOM,\n+      ssrClientReactDOMServer,\n+    ] = [\n+      resPages$('#react').text(),\n+      resPages$('#react-dom').text(),\n+      resPages$('#client-react').text(),\n+      resPages$('#client-react-dom').text(),\n+      resPages$('#client-react-dom-server').text(),\n+    ]\n+    expect({\n+      ssrReact,\n+      ssrReactDOM,\n+      ssrClientReact,\n+      ssrClientReactDOM,\n+      ssrClientReactDOMServer,\n+    }).toEqual({\n+      ssrReact: expect.stringMatching('-experimental-'),\n+      ssrReactDOM: expect.stringMatching('-experimental-'),\n+      ssrClientReact: expect.stringMatching('-experimental-'),\n+      ssrClientReactDOM: expect.stringMatching('-experimental-'),\n+      ssrClientReactDOMServer: expect.stringMatching('-experimental-'),\n+    })\n+\n+    const browser = await next.browser('/app-react')\n+    const [\n+      browserReact,\n+      browserReactDOM,\n+      browserClientReact,\n+      browserClientReactDOM,\n+      browserClientReactDOMServer,\n+    ] = await browser.eval(`\n+      [\n+        document.querySelector('#react').innerText,\n+        document.querySelector('#react-dom').innerText,\n+        document.querySelector('#client-react').innerText,\n+        document.querySelector('#client-react-dom').innerText,\n+        document.querySelector('#client-react-dom-server').innerText,\n+      ]\n+    `)\n+    expect({\n+      browserReact,\n+      browserReactDOM,\n+      browserClientReact,\n+      browserClientReactDOM,\n+      browserClientReactDOMServer,\n+    }).toEqual({\n+      browserReact: expect.stringMatching('-experimental-'),\n+      browserReactDOM: expect.stringMatching('-experimental-'),\n+      browserClientReact: expect.stringMatching('-experimental-'),\n+      browserClientReactDOM: expect.stringMatching('-experimental-'),\n+      browserClientReactDOMServer: expect.stringMatching('-experimental-'),\n+    })\n+  })\n+})"
        },
        {
            "sha": "46a52b0d180b3beacc0f2f0f1f8c91069f10bbcd",
            "filename": "test/e2e/app-dir/rsc-basic/rsc-basic.test.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 80,
            "changes": 80,
            "blob_url": "https://github.com/vercel/next.js/blob/3e24bdc78919251648ab1bdaebe9f2ad24aa86eb/test%2Fe2e%2Fapp-dir%2Frsc-basic%2Frsc-basic.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3e24bdc78919251648ab1bdaebe9f2ad24aa86eb/test%2Fe2e%2Fapp-dir%2Frsc-basic%2Frsc-basic.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frsc-basic%2Frsc-basic.test.ts?ref=3e24bdc78919251648ab1bdaebe9f2ad24aa86eb",
            "patch": "@@ -621,84 +621,4 @@ describe('app dir - rsc basics', () => {\n       await Promise.all(promises)\n     })\n   }\n-\n-  describe('react@experimental', () => {\n-    it.each([{ flag: 'ppr' }, { flag: 'taint' }])(\n-      'should opt into the react@experimental when enabling $flag',\n-      async ({ flag }) => {\n-        await next.stop()\n-        await next.patchFile(\n-          'next.config.js',\n-          `\n-          module.exports = {\n-            experimental: {\n-              ${flag}: true\n-            }\n-          }\n-          `,\n-          async () => {\n-            await next.start()\n-            const resPages$ = await next.render$('/app-react')\n-            const [\n-              ssrReact,\n-              ssrReactDOM,\n-              ssrClientReact,\n-              ssrClientReactDOM,\n-              ssrClientReactDOMServer,\n-            ] = [\n-              resPages$('#react').text(),\n-              resPages$('#react-dom').text(),\n-              resPages$('#client-react').text(),\n-              resPages$('#client-react-dom').text(),\n-              resPages$('#client-react-dom-server').text(),\n-            ]\n-            expect({\n-              ssrReact,\n-              ssrReactDOM,\n-              ssrClientReact,\n-              ssrClientReactDOM,\n-              ssrClientReactDOMServer,\n-            }).toEqual({\n-              ssrReact: expect.stringMatching('-experimental-'),\n-              ssrReactDOM: expect.stringMatching('-experimental-'),\n-              ssrClientReact: expect.stringMatching('-experimental-'),\n-              ssrClientReactDOM: expect.stringMatching('-experimental-'),\n-              ssrClientReactDOMServer: expect.stringMatching('-experimental-'),\n-            })\n-\n-            const browser = await next.browser('/app-react')\n-            const [\n-              browserReact,\n-              browserReactDOM,\n-              browserClientReact,\n-              browserClientReactDOM,\n-              browserClientReactDOMServer,\n-            ] = await browser.eval(`\n-              [\n-                document.querySelector('#react').innerText,\n-                document.querySelector('#react-dom').innerText,\n-                document.querySelector('#client-react').innerText,\n-                document.querySelector('#client-react-dom').innerText,\n-                document.querySelector('#client-react-dom-server').innerText,\n-              ]\n-            `)\n-            expect({\n-              browserReact,\n-              browserReactDOM,\n-              browserClientReact,\n-              browserClientReactDOM,\n-              browserClientReactDOMServer,\n-            }).toEqual({\n-              browserReact: expect.stringMatching('-experimental-'),\n-              browserReactDOM: expect.stringMatching('-experimental-'),\n-              browserClientReact: expect.stringMatching('-experimental-'),\n-              browserClientReactDOM: expect.stringMatching('-experimental-'),\n-              browserClientReactDOMServer:\n-                expect.stringMatching('-experimental-'),\n-            })\n-          }\n-        )\n-      }\n-    )\n-  })\n })"
        }
    ],
    "stats": {
        "total": 156,
        "additions": 76,
        "deletions": 80
    }
}