{
    "author": "sokra",
    "message": "Turbopack: remove unused code (#81411)\n\n### What?\n\nRemove unused code. Also improves performance by avoid unnecessary checks",
    "sha": "3e598fdbaaec331f8c1e89a2be6a0eefcea8d3b8",
    "files": [
        {
            "sha": "573874614335dec6e0af2ce5459b025339d7e33b",
            "filename": "turbopack/crates/turbo-tasks-backend/src/backend/operation/aggregation_update.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 14,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/3e598fdbaaec331f8c1e89a2be6a0eefcea8d3b8/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Faggregation_update.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/3e598fdbaaec331f8c1e89a2be6a0eefcea8d3b8/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Faggregation_update.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Faggregation_update.rs?ref=3e598fdbaaec331f8c1e89a2be6a0eefcea8d3b8",
            "patch": "@@ -12,7 +12,7 @@ use std::{\n use anyhow::Result;\n use indexmap::map::Entry;\n use ringmap::RingSet;\n-use rustc_hash::{FxBuildHasher, FxHashMap, FxHashSet};\n+use rustc_hash::{FxBuildHasher, FxHashMap};\n use serde::{Deserialize, Serialize, Serializer, ser::SerializeSeq};\n use smallvec::{SmallVec, smallvec};\n #[cfg(any(\n@@ -613,7 +613,6 @@ pub struct AggregationUpdateQueue {\n     number_updates: FxIndexMap<TaskId, AggregationNumberUpdate>,\n     done_number_updates: FxHashMap<TaskId, AggregationNumberUpdate>,\n     find_and_schedule: FxRingSet<FindAndScheduleJob>,\n-    done_find_and_schedule: FxHashSet<TaskId>,\n     balance_queue: FxRingSet<BalanceJob>,\n     optimize_queue: FxRingSet<OptimizeJob>,\n }\n@@ -626,7 +625,6 @@ impl AggregationUpdateQueue {\n             number_updates: FxIndexMap::default(),\n             done_number_updates: FxHashMap::default(),\n             find_and_schedule: FxRingSet::default(),\n-            done_find_and_schedule: FxHashSet::default(),\n             balance_queue: FxRingSet::default(),\n             optimize_queue: FxRingSet::default(),\n         }\n@@ -640,7 +638,6 @@ impl AggregationUpdateQueue {\n             find_and_schedule,\n             balance_queue,\n             optimize_queue,\n-            done_find_and_schedule: _,\n             done_number_updates: _,\n         } = self;\n         jobs.is_empty()\n@@ -718,20 +715,14 @@ impl AggregationUpdateQueue {\n \n     /// Pushes a job to find and schedule dirty tasks.\n     pub fn push_find_and_schedule_dirty(&mut self, task_id: TaskId) {\n-        if !self.done_find_and_schedule.contains(&task_id) {\n-            self.find_and_schedule\n-                .push_back(FindAndScheduleJob::new(task_id));\n-        }\n+        self.find_and_schedule\n+            .push_back(FindAndScheduleJob::new(task_id));\n     }\n \n     /// Extends the queue with multiple jobs to find and schedule dirty tasks.\n     pub fn extend_find_and_schedule_dirty(&mut self, task_ids: impl IntoIterator<Item = TaskId>) {\n-        self.find_and_schedule.extend(\n-            task_ids\n-                .into_iter()\n-                .filter(|task_id| !self.done_find_and_schedule.contains(task_id))\n-                .map(FindAndScheduleJob::new),\n-        );\n+        self.find_and_schedule\n+            .extend(task_ids.into_iter().map(FindAndScheduleJob::new));\n     }\n \n     /// Pushes a job to optimize a task."
        }
    ],
    "stats": {
        "total": 19,
        "additions": 5,
        "deletions": 14
    }
}