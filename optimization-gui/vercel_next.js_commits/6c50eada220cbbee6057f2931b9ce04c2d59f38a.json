{
    "author": "mischnic",
    "message": "Turbopack: improve unit tests (#80940)",
    "sha": "6c50eada220cbbee6057f2931b9ce04c2d59f38a",
    "files": [
        {
            "sha": "5be98d4b6e8dd792547ad9e679ec477fd5765704",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/side-effects-optimization/comptime/input/index.js",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/6c50eada220cbbee6057f2931b9ce04c2d59f38a/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fside-effects-optimization%2Fcomptime%2Finput%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/6c50eada220cbbee6057f2931b9ce04c2d59f38a/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fside-effects-optimization%2Fcomptime%2Finput%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fside-effects-optimization%2Fcomptime%2Finput%2Findex.js?ref=6c50eada220cbbee6057f2931b9ce04c2d59f38a",
            "patch": "@@ -1,10 +1,31 @@\n import { something } from 'package/dep.js'\n import { something2 } from 'package/dep2.js'\n+import { something3 } from 'package-directive/dep.js'\n \n it('should not include a module that is side effect free and exports are not used due to static analysis', () => {\n+  const modules = Object.keys(__turbopack_modules__)\n+  expect(modules).toContainEqual(\n+    expect.stringMatching(/input\\/node_modules\\/package\\/dep2\\.js/)\n+  )\n+  expect(modules).not.toContainEqual(\n+    expect.stringMatching(/input\\/node_modules\\/package\\/dep\\.js/)\n+  )\n+\n   if (true) {\n     something2()\n     return\n   }\n   something()\n })\n+\n+it('should not include a module that is side effect free via directive and exports are not used due to static analysis', () => {\n+  const modules = Object.keys(__turbopack_modules__)\n+  expect(modules).not.toContainEqual(\n+    expect.stringMatching(/input\\/node_modules\\/package-directive\\/dep\\.js/)\n+  )\n+\n+  if (true) {\n+  } else {\n+    something3()\n+  }\n+})"
        },
        {
            "sha": "1c0930c90ea326f73dd75d24aae37a9ebc6a4137",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/side-effects-optimization/comptime/input/node_modules/package-directive/dep.js",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/6c50eada220cbbee6057f2931b9ce04c2d59f38a/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fside-effects-optimization%2Fcomptime%2Finput%2Fnode_modules%2Fpackage-directive%2Fdep.js",
            "raw_url": "https://github.com/vercel/next.js/raw/6c50eada220cbbee6057f2931b9ce04c2d59f38a/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fside-effects-optimization%2Fcomptime%2Finput%2Fnode_modules%2Fpackage-directive%2Fdep.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fside-effects-optimization%2Fcomptime%2Finput%2Fnode_modules%2Fpackage-directive%2Fdep.js?ref=6c50eada220cbbee6057f2931b9ce04c2d59f38a",
            "patch": "@@ -0,0 +1,3 @@\n+'use turbopack no side effects'\n+\n+module.exports = 123"
        },
        {
            "sha": "d9a24fe8177a63c9d5bbdfaa75c2e5a52217dabb",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/side-effects-optimization/comptime/options.json",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/6c50eada220cbbee6057f2931b9ce04c2d59f38a/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fside-effects-optimization%2Fcomptime%2Foptions.json",
            "raw_url": "https://github.com/vercel/next.js/raw/6c50eada220cbbee6057f2931b9ce04c2d59f38a/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fside-effects-optimization%2Fcomptime%2Foptions.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fside-effects-optimization%2Fcomptime%2Foptions.json?ref=6c50eada220cbbee6057f2931b9ce04c2d59f38a",
            "patch": "@@ -1,3 +1,4 @@\n {\n-  \"treeShakingMode\": \"reexports-only\"\n+  \"treeShakingMode\": \"reexports-only\",\n+  \"scopeHoisting\": false\n }"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 26,
        "deletions": 1
    }
}