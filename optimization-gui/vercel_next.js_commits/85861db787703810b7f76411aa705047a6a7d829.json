{
    "author": "eps1lon",
    "message": "[strict-route-types] Add `experimental.strictRouteTypes` config (#87378)",
    "sha": "85861db787703810b7f76411aa705047a6a7d829",
    "files": [
        {
            "sha": "c03725aa3ae23d68d5e673c5bd4f85be767b5317",
            "filename": ".github/workflows/build_and_test.yml",
            "status": "modified",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/.github%2Fworkflows%2Fbuild_and_test.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/.github%2Fworkflows%2Fbuild_and_test.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Fworkflows%2Fbuild_and_test.yml?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -249,6 +249,7 @@ jobs:\n         export TURBOPACK_DEV=1\n         export NEXT_TEST_MODE=dev\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         node run-tests.js \\\n           --test-pattern '^(test\\/(development|e2e))/.*\\.test\\.(js|jsx|ts|tsx)$' \\\n@@ -279,6 +280,7 @@ jobs:\n         export IS_TURBOPACK_TEST=1\n         export TURBOPACK_DEV=1\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         node run-tests.js \\\n           --timings \\\n@@ -309,6 +311,7 @@ jobs:\n         export TURBOPACK_BUILD=1\n         export NEXT_TEST_MODE=start\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         node run-tests.js --timings -g ${{ matrix.group }} --type production\n       stepName: 'test-turbopack-production-react-${{ matrix.react }}-${{ matrix.group }}'\n@@ -336,6 +339,7 @@ jobs:\n         export IS_TURBOPACK_TEST=1\n         export TURBOPACK_BUILD=1\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         node run-tests.js \\\n           --timings \\\n@@ -363,6 +367,7 @@ jobs:\n         export NEXT_EXTERNAL_TESTS_FILTERS=\"$(pwd)/test/rspack-dev-tests-manifest.json\"\n         export NEXT_TEST_MODE=dev\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         # rspack flags\n         export NEXT_RSPACK=1\n@@ -399,6 +404,7 @@ jobs:\n       afterBuild: |\n         export NEXT_EXTERNAL_TESTS_FILTERS=\"$(pwd)/test/rspack-dev-tests-manifest.json\"\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         # rspack flags\n         export NEXT_RSPACK=1\n@@ -435,6 +441,7 @@ jobs:\n         export NEXT_EXTERNAL_TESTS_FILTERS=\"$(pwd)/test/rspack-build-tests-manifest.json\"\n         export NEXT_TEST_MODE=start\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         # rspack flags\n         export NEXT_RSPACK=1\n@@ -468,6 +475,7 @@ jobs:\n       afterBuild: |\n         export NEXT_EXTERNAL_TESTS_FILTERS=\"$(pwd)/test/rspack-build-tests-manifest.json\"\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         # rspack flags\n         export NEXT_RSPACK=1\n@@ -562,6 +570,7 @@ jobs:\n       nodeVersion: ${{ matrix.node }}\n       afterBuild: |\n         export __NEXT_NODE_NATIVE_TS_LOADER_ENABLED=true\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n         NEXT_TEST_MODE=dev NODE_OPTIONS=--experimental-transform-types node run-tests.js test/e2e/app-dir/next-config-ts-native-ts/**/*.test.ts test/e2e/app-dir/next-config-ts-native-mts/**/*.test.ts\n       stepName: 'test-next-config-ts-native-ts-dev-${{ matrix.node }}'\n \n@@ -583,6 +592,7 @@ jobs:\n       nodeVersion: ${{ matrix.node }}\n       afterBuild: |\n         export __NEXT_NODE_NATIVE_TS_LOADER_ENABLED=true\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n         NEXT_TEST_MODE=start NODE_OPTIONS=--experimental-transform-types node run-tests.js test/e2e/app-dir/next-config-ts-native-ts/**/*.test.ts test/e2e/app-dir/next-config-ts-native-mts/**/*.test.ts\n       stepName: 'test-next-config-ts-native-ts-prod-${{ matrix.node }}'\n \n@@ -623,6 +633,7 @@ jobs:\n     uses: ./.github/workflows/build_reusable.yml\n     with:\n       afterBuild: |\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n         node scripts/test-new-tests.mjs \\\n           --flake-detection \\\n           --mode dev \\\n@@ -647,6 +658,7 @@ jobs:\n     uses: ./.github/workflows/build_reusable.yml\n     with:\n       afterBuild: |\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n         node scripts/test-new-tests.mjs \\\n           --flake-detection \\\n           --mode start \\\n@@ -672,6 +684,7 @@ jobs:\n     with:\n       afterBuild: |\n         export NEXT_E2E_TEST_TIMEOUT=240000\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n         export GH_PR_NUMBER=${{ github.event.pull_request && github.event.pull_request.number || '' }}\n         node scripts/test-new-tests.mjs \\\n           --mode deploy \\\n@@ -733,6 +746,7 @@ jobs:\n         export IS_WEBPACK_TEST=1\n         export NEXT_TEST_MODE=dev\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         node run-tests.js \\\n           --timings \\\n@@ -759,6 +773,7 @@ jobs:\n       afterBuild: |\n         export NEXT_TEST_MODE=dev\n         export IS_WEBPACK_TEST=1\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         node run-tests.js \\\n           test/e2e/app-dir/app/index.test.ts \\\n@@ -787,6 +802,7 @@ jobs:\n       nodeVersion: 20.9.0\n       afterBuild: |\n         export IS_WEBPACK_TEST=1\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n         node run-tests.js \\\n           --concurrency 4 \\\n           test/production/pages-dir/production/test/index.test.ts \\\n@@ -816,6 +832,7 @@ jobs:\n       afterBuild: |\n         export NEXT_TEST_MODE=start\n         export IS_WEBPACK_TEST=1\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         node run-tests.js --type production \\\n           test/e2e/app-dir/app/index.test.ts \\\n@@ -848,6 +865,7 @@ jobs:\n         export IS_WEBPACK_TEST=1\n         export NEXT_TEST_MODE=start\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         node run-tests.js --timings -g ${{ matrix.group }} --type production\n       stepName: 'test-prod-react-${{ matrix.react }}-${{ matrix.group }}'\n@@ -887,6 +905,7 @@ jobs:\n       afterBuild: |\n         export IS_WEBPACK_TEST=1\n         export NEXT_TEST_REACT_VERSION=\"${{ matrix.react }}\"\n+        export __NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES=true\n \n         node run-tests.js \\\n           --timings \\"
        },
        {
            "sha": "ae9e29d8d4359d5c1511af4a65741d0160bff51a",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -1483,7 +1483,11 @@ export default async function build(\n             routeTypesFilePath,\n             config\n           )\n-          await writeValidatorFile(routeTypesManifest, validatorFilePath)\n+          await writeValidatorFile(\n+            routeTypesManifest,\n+            validatorFilePath,\n+            Boolean(config.experimental.strictRouteTypes)\n+          )\n         })\n \n       // Turbopack already handles conflicting app and page routes."
        },
        {
            "sha": "46db023f1e111b1a68ece4fc79b8cae9b9d53b92",
            "filename": "packages/next/src/cli/next-typegen.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fcli%2Fnext-typegen.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fcli%2Fnext-typegen.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcli%2Fnext-typegen.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -169,7 +169,11 @@ const nextTypegen = async (\n     nextConfig\n   )\n \n-  await writeValidatorFile(routeTypesManifest, validatorFilePath)\n+  await writeValidatorFile(\n+    routeTypesManifest,\n+    validatorFilePath,\n+    Boolean(nextConfig.experimental.strictRouteTypes)\n+  )\n \n   // Generate cache-life types if cacheLife config exists\n   const cacheLifeFilePath = join(distDir, 'types', 'cache-life.d.ts')"
        },
        {
            "sha": "9cd8dafdad61f4338fe228460050759421245855",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -313,6 +313,7 @@ export const experimentalSchema = {\n   turbopackInferModuleSideEffects: z.boolean().optional(),\n   optimizePackageImports: z.array(z.string()).optional(),\n   optimizeServerReact: z.boolean().optional(),\n+  strictRouteTypes: z.boolean().optional(),\n   clientTraceMetadata: z.array(z.string()).optional(),\n   serverMinification: z.boolean().optional(),\n   serverSourceMaps: z.boolean().optional(),"
        },
        {
            "sha": "7947c8023c304ef348b36d9afb7fb5014f50795f",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -387,6 +387,12 @@ export interface ExperimentalConfig {\n    */\n   optimizeServerReact?: boolean\n \n+  /**\n+   * Type-checks props and return values of pages.\n+   * Requires literal values for segment config (e.g. `export const dynamic = 'force-static' as const`).\n+   */\n+  strictRouteTypes?: boolean\n+\n   /**\n    * Displays an indicator when a React Transition has no other indicator rendered.\n    * This includes displaying an indicator on client-side navigations.\n@@ -1548,6 +1554,7 @@ export const defaultConfig = Object.freeze({\n     webpackBuildWorker: undefined,\n     webpackMemoryOptimizations: false,\n     optimizeServerReact: true,\n+    strictRouteTypes: false,\n     viewTransition: false,\n     removeUncaughtErrorAndRejectionListeners: false,\n     validateRSCRequestHeaders: !!("
        },
        {
            "sha": "83c7e69a03a81f818b51ed60bf0aa05a4e6deeb7",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -1888,6 +1888,25 @@ function enforceExperimentalFeatures(\n     }\n   }\n \n+  // TODO: Remove this once strictRouteTypes is the default.\n+  if (\n+    process.env.__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES === 'true' &&\n+    // We do respect an explicit value in the user config.\n+    (config.experimental.strictRouteTypes === undefined ||\n+      (isDefaultConfig && !config.experimental.strictRouteTypes))\n+  ) {\n+    config.experimental.strictRouteTypes = true\n+\n+    if (configuredExperimentalFeatures) {\n+      addConfiguredExperimentalFeature(\n+        configuredExperimentalFeatures,\n+        'strictRouteTypes',\n+        true,\n+        'enabled by `__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES`'\n+      )\n+    }\n+  }\n+\n   if (\n     process.env.__NEXT_EXPERIMENTAL_TRANSITION_INDICATOR === 'true' &&\n     // We do respect an explicit value in the user config."
        },
        {
            "sha": "6eb0733b2e6c30d29c877f310184236483302db1",
            "filename": "packages/next/src/server/lib/router-utils/route-types-utils.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 3,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Froute-types-utils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Froute-types-utils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Froute-types-utils.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -10,6 +10,8 @@ import {\n   generateRouteTypesFile,\n   generateLinkTypesFile,\n   generateValidatorFile,\n+  generateValidatorFileStrict,\n+  generateRouteTypesFileStrict,\n } from './typegen'\n import { tryToParsePath } from '../../../lib/try-to-parse-path'\n import {\n@@ -361,7 +363,12 @@ export async function writeRouteTypesManifest(\n   }\n \n   // Write the main routes.d.ts file\n-  await fs.promises.writeFile(filePath, generateRouteTypesFile(manifest))\n+  await fs.promises.writeFile(\n+    filePath,\n+    config.experimental.strictRouteTypes\n+      ? generateRouteTypesFileStrict(manifest)\n+      : generateRouteTypesFile(manifest)\n+  )\n \n   // Write the link.d.ts file if typedRoutes is enabled\n   if (config.typedRoutes === true) {\n@@ -372,13 +379,19 @@ export async function writeRouteTypesManifest(\n \n export async function writeValidatorFile(\n   manifest: RouteTypesManifest,\n-  filePath: string\n+  filePath: string,\n+  strict: boolean\n ) {\n   const dirname = path.dirname(filePath)\n \n   if (!fs.existsSync(dirname)) {\n     await fs.promises.mkdir(dirname, { recursive: true })\n   }\n \n-  await fs.promises.writeFile(filePath, generateValidatorFile(manifest))\n+  await fs.promises.writeFile(\n+    filePath,\n+    strict\n+      ? generateValidatorFileStrict(manifest)\n+      : generateValidatorFile(manifest)\n+  )\n }"
        },
        {
            "sha": "44e7005db137fe72dcd6db79bc91cb7168d4acf6",
            "filename": "packages/next/src/server/lib/router-utils/setup-dev-bundler.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -1179,7 +1179,11 @@ async function startWatcher(\n             routeTypesFilePath,\n             opts.nextConfig\n           )\n-          await writeValidatorFile(routeTypesManifest, validatorFilePath)\n+          await writeValidatorFile(\n+            routeTypesManifest,\n+            validatorFilePath,\n+            Boolean(nextConfig.experimental.strictRouteTypes)\n+          )\n \n           // Generate cache-life types if cacheLife config exists\n           const cacheLifeFilePath = path.join(distTypesDir, 'cache-life.d.ts')"
        },
        {
            "sha": "6e7a10d5f4b160b8e8571024e5e65ce9f3794f61",
            "filename": "packages/next/src/server/lib/router-utils/typegen.ts",
            "status": "modified",
            "additions": 332,
            "deletions": 0,
            "changes": 332,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Ftypegen.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Ftypegen.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Ftypegen.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -649,6 +649,247 @@ ${layoutValidations}\n `\n }\n \n+export function generateValidatorFileStrict(\n+  routesManifest: RouteTypesManifest\n+): string {\n+  const generateValidations = (\n+    paths: string[],\n+    type:\n+      | 'AppPageConfig'\n+      | 'PagesPageConfig'\n+      | 'LayoutConfig'\n+      | 'RouteHandlerConfig'\n+      | 'ApiRouteConfig',\n+    pathToRouteMap?: Map<string, string>\n+  ) =>\n+    paths\n+      .sort()\n+      // Only validate TypeScript files - JavaScript files have too many type inference limitations\n+      .filter(\n+        (filePath) => filePath.endsWith('.ts') || filePath.endsWith('.tsx')\n+      )\n+      .filter(\n+        // Don't include metadata routes or pages\n+        // (e.g. /manifest.webmanifest)\n+        (filePath) =>\n+          type !== 'AppPageConfig' ||\n+          filePath.endsWith('page.ts') ||\n+          filePath.endsWith('page.tsx')\n+      )\n+      .map((filePath) => {\n+        // Keep the file extension for TypeScript imports to support node16 module resolution\n+        const importPath = filePath\n+        const route = pathToRouteMap?.get(filePath)\n+        const typeWithRoute =\n+          route &&\n+          (type === 'AppPageConfig' ||\n+            type === 'LayoutConfig' ||\n+            type === 'RouteHandlerConfig')\n+            ? `${type}<${JSON.stringify(route)}>`\n+            : type\n+\n+        // NOTE: we previously used `satisfies` here, but it's not supported by TypeScript 4.8 and below.\n+        // If we ever raise the TS minimum version, we can switch back.\n+\n+        return `// Validate ${filePath}\n+{\n+  type __IsExpected<Specific extends ${typeWithRoute}> = Specific\n+  const handler = {} as typeof import(${JSON.stringify(\n+    importPath.replace(/\\.tsx?$/, '.js')\n+  )})\n+  type __Check = __IsExpected<typeof handler>\n+  // @ts-ignore\n+  type __Unused = __Check\n+}`\n+      })\n+      .join('\\n\\n')\n+\n+  // Use direct mappings from the manifest\n+\n+  // Generate validations for different route types\n+  const appPageValidations = generateValidations(\n+    Array.from(routesManifest.appPagePaths).sort(),\n+    'AppPageConfig',\n+    routesManifest.filePathToRoute\n+  )\n+  const appRouteHandlerValidations = generateValidations(\n+    Array.from(routesManifest.appRouteHandlers).sort(),\n+    'RouteHandlerConfig',\n+    routesManifest.filePathToRoute\n+  )\n+  const pagesRouterPageValidations = generateValidations(\n+    Array.from(routesManifest.pagesRouterPagePaths).sort(),\n+    'PagesPageConfig'\n+  )\n+  const pagesApiRouteValidations = generateValidations(\n+    Array.from(routesManifest.pageApiRoutes).sort(),\n+    'ApiRouteConfig'\n+  )\n+  const layoutValidations = generateValidations(\n+    Array.from(routesManifest.layoutPaths).sort(),\n+    'LayoutConfig',\n+    routesManifest.filePathToRoute\n+  )\n+\n+  const hasAppRouteHandlers =\n+    Object.keys(routesManifest.appRouteHandlerRoutes).length > 0\n+\n+  // Build type definitions based on what's actually used\n+  let typeDefinitions = ''\n+\n+  if (appPageValidations) {\n+    typeDefinitions += `type AppPageConfig<Route extends AppRoutes = AppRoutes> = {\n+  default: React.ComponentType<{ params: Promise<ParamMap[Route]> } & any> | ((props: { params: Promise<ParamMap[Route]> } & any) => React.ReactNode | Promise<React.ReactNode> | never | void | Promise<void>)\n+  generateStaticParams?: (props: { params: ParamMap[Route] }) => Promise<any[]> | any[]\n+  generateMetadata?: (\n+    props: { params: Promise<ParamMap[Route]> } & any,\n+    parent: ResolvingMetadata\n+  ) => Promise<any> | any\n+  generateViewport?: (\n+    props: { params: Promise<ParamMap[Route]> } & any,\n+    parent: ResolvingViewport\n+  ) => Promise<any> | any\n+  metadata?: any\n+  viewport?: any\n+}\n+\n+`\n+  }\n+\n+  if (pagesRouterPageValidations) {\n+    typeDefinitions += `type PagesPageConfig = {\n+  default: React.ComponentType<any> | ((props: any) => React.ReactNode | Promise<React.ReactNode> | never | void)\n+  getStaticProps?: (context: any) => Promise<any> | any\n+  getStaticPaths?: (context: any) => Promise<any> | any\n+  getServerSideProps?: (context: any) => Promise<any> | any\n+  getInitialProps?: (context: any) => Promise<any> | any\n+  /**\n+   * Segment configuration for legacy Pages Router pages.\n+   * Validated at build-time by parsePagesSegmentConfig.\n+   */\n+  config?: {\n+    maxDuration?: number\n+    runtime?: 'edge' | 'experimental-edge' | 'nodejs' | string // necessary unless config is exported as const\n+    regions?: string[]\n+  }\n+}\n+\n+`\n+  }\n+\n+  if (layoutValidations) {\n+    typeDefinitions += `type LayoutConfig<Route extends LayoutRoutes = LayoutRoutes> = {\n+  default: React.ComponentType<LayoutProps<Route>> | ((props: LayoutProps<Route>) => React.ReactNode | Promise<React.ReactNode> | never | void | Promise<void>)\n+  generateStaticParams?: (props: { params: ParamMap[Route] }) => Promise<any[]> | any[]\n+  generateMetadata?: (\n+    props: { params: Promise<ParamMap[Route]> } & any,\n+    parent: ResolvingMetadata\n+  ) => Promise<any> | any\n+  generateViewport?: (\n+    props: { params: Promise<ParamMap[Route]> } & any,\n+    parent: ResolvingViewport\n+  ) => Promise<any> | any\n+  metadata?: any\n+  viewport?: any\n+}\n+\n+`\n+  }\n+\n+  if (appRouteHandlerValidations) {\n+    typeDefinitions += `type RouteHandlerConfig<Route extends AppRouteHandlerRoutes = AppRouteHandlerRoutes> = {\n+  GET?: (request: NextRequest, context: { params: Promise<ParamMap[Route]> }) => Promise<Response | void> | Response | void\n+  POST?: (request: NextRequest, context: { params: Promise<ParamMap[Route]> }) => Promise<Response | void> | Response | void\n+  PUT?: (request: NextRequest, context: { params: Promise<ParamMap[Route]> }) => Promise<Response | void> | Response | void\n+  PATCH?: (request: NextRequest, context: { params: Promise<ParamMap[Route]> }) => Promise<Response | void> | Response | void\n+  DELETE?: (request: NextRequest, context: { params: Promise<ParamMap[Route]> }) => Promise<Response | void> | Response | void\n+  HEAD?: (request: NextRequest, context: { params: Promise<ParamMap[Route]> }) => Promise<Response | void> | Response | void\n+  OPTIONS?: (request: NextRequest, context: { params: Promise<ParamMap[Route]> }) => Promise<Response | void> | Response | void\n+}\n+\n+`\n+  }\n+\n+  if (pagesApiRouteValidations) {\n+    typeDefinitions += `type ApiRouteConfig = {\n+  default: (req: any, res: any) => ReturnType<NextApiHandler>\n+  config?: {\n+    api?: {\n+      bodyParser?: boolean | { sizeLimit?: string }\n+      responseLimit?: string | number | boolean\n+      externalResolver?: boolean\n+    }\n+    runtime?: 'edge' | 'experimental-edge' | 'nodejs' | string // necessary unless config is exported as const\n+    maxDuration?: number\n+  }\n+}\n+\n+`\n+  }\n+\n+  // Build import statement based on what's actually needed\n+  const routeImports = []\n+\n+  // Only import AppRoutes if there are app pages\n+  if (appPageValidations) {\n+    routeImports.push('AppRoutes')\n+  }\n+\n+  // Only import LayoutRoutes if there are layouts\n+  if (layoutValidations) {\n+    routeImports.push('LayoutRoutes')\n+  }\n+\n+  // Only import ParamMap if there are routes that use it\n+  if (appPageValidations || layoutValidations || appRouteHandlerValidations) {\n+    routeImports.push('ParamMap')\n+  }\n+\n+  if (hasAppRouteHandlers) {\n+    routeImports.push('AppRouteHandlerRoutes')\n+  }\n+\n+  const routeImportStatement =\n+    routeImports.length > 0\n+      ? `import type { ${routeImports.join(', ')} } from \"./routes.js\"`\n+      : ''\n+\n+  const nextRequestImport = hasAppRouteHandlers\n+    ? \"import type { NextRequest } from 'next/server.js'\\n\"\n+    : ''\n+\n+  // Conditionally import types from next/types, merged into a single statement\n+  const nextTypes: string[] = []\n+  if (pagesApiRouteValidations) {\n+    nextTypes.push('NextApiHandler')\n+  }\n+  if (appPageValidations || layoutValidations) {\n+    nextTypes.push('ResolvingMetadata', 'ResolvingViewport')\n+  }\n+  const nextTypesImport =\n+    nextTypes.length > 0\n+      ? `import type { ${nextTypes.join(', ')} } from \"next/types.js\"\\n`\n+      : ''\n+\n+  return `// This file is generated automatically by Next.js with experimental.strictRouteTypes\n+// Do not edit this file manually\n+// This file validates that all pages and layouts export the correct types\n+\n+${routeImportStatement}\n+${nextTypesImport}${nextRequestImport}\n+${typeDefinitions}\n+${appPageValidations}\n+\n+${appRouteHandlerValidations}\n+\n+${pagesRouterPageValidations}\n+\n+${pagesApiRouteValidations}\n+\n+${layoutValidations}\n+`\n+}\n+\n export function generateRouteTypesFile(\n   routesManifest: RouteTypesManifest\n ): string {\n@@ -739,3 +980,94 @@ declare global {\n }\n `\n }\n+\n+export function generateRouteTypesFileStrict(\n+  routesManifest: RouteTypesManifest\n+): string {\n+  const routeTypes = generateRouteTypes(routesManifest)\n+  const paramTypes = generateParamTypes(routesManifest)\n+  const layoutSlotMap = generateLayoutSlotMap(routesManifest)\n+\n+  const hasAppRouteHandlers =\n+    Object.keys(routesManifest.appRouteHandlerRoutes).length > 0\n+\n+  // Build export statement based on what's actually generated\n+  const routeExports = [\n+    'AppRoutes',\n+    'PageRoutes',\n+    'LayoutRoutes',\n+    'RedirectRoutes',\n+    'RewriteRoutes',\n+    'ParamMap',\n+  ]\n+  if (hasAppRouteHandlers) {\n+    routeExports.push('AppRouteHandlerRoutes')\n+  }\n+\n+  const exportStatement = `export type { ${routeExports.join(', ')} }`\n+\n+  const routeContextInterface = hasAppRouteHandlers\n+    ? `\n+\n+  /**\n+   * Context for Next.js App Router route handlers\n+   * @example\n+   * \\`\\`\\`tsx\n+   * export async function GET(request: NextRequest, context: RouteContext<'/api/users/[id]'>) {\n+   *   const { id } = await context.params\n+   *   return Response.json({ id })\n+   * }\n+   * \\`\\`\\`\n+   */\n+  interface RouteContext<AppRouteHandlerRoute extends AppRouteHandlerRoutes> {\n+    params: Promise<ParamMap[AppRouteHandlerRoute]>\n+  }`\n+    : ''\n+\n+  return `// This file is generated automatically by Next.js with experimental.strictRouteTypes\n+// Do not edit this file manually\n+\n+${routeTypes}\n+\n+${paramTypes}\n+\n+export type ParamsOf<Route extends Routes> = ParamMap[Route]\n+\n+${layoutSlotMap}\n+\n+${exportStatement}\n+\n+declare global {\n+  /**\n+   * Props for Next.js App Router page components\n+   * @example\n+   * \\`\\`\\`tsx\n+   * export default function Page(props: PageProps<'/blog/[slug]'>) {\n+   *   const { slug } = await props.params\n+   *   return <div>Blog post: {slug}</div>\n+   * }\n+   * \\`\\`\\`\n+   */\n+  interface PageProps<AppRoute extends AppRoutes> {\n+    params: Promise<ParamMap[AppRoute]>\n+    searchParams: Promise<Record<string, string | string[] | undefined>>\n+  }\n+\n+  /**\n+   * Props for Next.js App Router layout components\n+   * @example\n+   * \\`\\`\\`tsx\n+   * export default function Layout(props: LayoutProps<'/dashboard'>) {\n+   *   return <div>{props.children}</div>\n+   * }\n+   * \\`\\`\\`\n+   */\n+  type LayoutProps<LayoutRoute extends LayoutRoutes> = {\n+    params: Promise<ParamMap[LayoutRoute]>\n+    children: React.ReactNode\n+  } & {\n+    [K in LayoutSlotMap[LayoutRoute]]: React.ReactNode\n+  }${routeContextInterface}\n+}\n+`\n+}"
        },
        {
            "sha": "8e931c65429041f0bafecbd2c9378830068f1700",
            "filename": "test/integration/config-experimental-warning/test/index.test.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/test%2Fintegration%2Fconfig-experimental-warning%2Ftest%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/test%2Fintegration%2Fconfig-experimental-warning%2Ftest%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fconfig-experimental-warning%2Ftest%2Findex.test.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -54,6 +54,11 @@ describe('Config Experimental Warning', () => {\n       module.exports = (phase, { defaultConfig }) => {\n         return {\n           ...defaultConfig,\n+          experimental: {\n+            ...defaultConfig.experimental,\n+            // We enable this by default in CI\n+            strictRouteTypes: false,\n+          }\n         }\n       }\n     `)\n@@ -66,6 +71,10 @@ describe('Config Experimental Warning', () => {\n     configFile.write(`\n       module.exports = {\n         images: {},\n+        experimental: {\n+          // We enable this by default in CI\n+          strictRouteTypes: false,\n+        }\n       }\n     `)\n \n@@ -106,6 +115,8 @@ describe('Config Experimental Warning', () => {\n       module.exports = (phase) => ({\n         experimental: {\n           workerThreads: false\n+          // We enable this by default in CI\n+          strictRouteTypes: false,\n         }\n       })\n     `)"
        },
        {
            "sha": "4bdb783834fd78a9fdbc493a84bf209f9307197b",
            "filename": "test/production/app-dir/build-output-prerender/build-output-prerender.test.ts",
            "status": "modified",
            "additions": 26,
            "deletions": 14,
            "changes": 40,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/test%2Fproduction%2Fapp-dir%2Fbuild-output-prerender%2Fbuild-output-prerender.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/test%2Fproduction%2Fapp-dir%2Fbuild-output-prerender%2Fbuild-output-prerender.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-prerender%2Fbuild-output-prerender.test.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -47,17 +47,21 @@ describe('build-output-prerender', () => {\n           }\n         } else {\n           if (isTurbopack) {\n-            expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(\n-              `\"▲ Next.js x.y.z (Turbopack, Cache Components)\"`\n-            )\n+            expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(`\n+             \"▲ Next.js x.y.z (Turbopack, Cache Components)\n+             - Experiments (use with caution):\n+               ✓ strictRouteTypes (enabled by \\`__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES\\`)\"\n+            `)\n           } else if (isRspack) {\n             expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(`\n              \"▲ Next.js x.y.z (Rspack, Cache Components)\"\n             `)\n           } else {\n-            expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(\n-              `\"▲ Next.js x.y.z (webpack, Cache Components)\"`\n-            )\n+            expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(`\n+             \"▲ Next.js x.y.z (webpack, Cache Components)\n+             - Experiments (use with caution):\n+               ✓ strictRouteTypes (enabled by \\`__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES\\`)\"\n+            `)\n           }\n         }\n       })\n@@ -156,6 +160,7 @@ describe('build-output-prerender', () => {\n              - Experiments (use with caution):\n                ⨯ prerenderEarlyExit (disabled by \\`--debug-prerender\\`)\n                ✓ serverSourceMaps (enabled by \\`--debug-prerender\\`)\n+               ✓ strictRouteTypes (enabled by \\`__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES\\`)\n                ⨯ turbopackMinify (disabled by \\`--debug-prerender\\`)\"\n             `)\n           } else if (isRspack) {\n@@ -174,7 +179,8 @@ describe('build-output-prerender', () => {\n              - Experiments (use with caution):\n                ⨯ prerenderEarlyExit (disabled by \\`--debug-prerender\\`)\n                ⨯ serverMinification (disabled by \\`--debug-prerender\\`)\n-               ✓ serverSourceMaps (enabled by \\`--debug-prerender\\`)\"\n+               ✓ serverSourceMaps (enabled by \\`--debug-prerender\\`)\n+               ✓ strictRouteTypes (enabled by \\`__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES\\`)\"\n             `)\n           }\n         }\n@@ -281,17 +287,21 @@ describe('build-output-prerender', () => {\n           }\n         } else {\n           if (isTurbopack) {\n-            expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(\n-              `\"▲ Next.js x.y.z (Turbopack)\"`\n-            )\n+            expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(`\n+             \"▲ Next.js x.y.z (Turbopack)\n+             - Experiments (use with caution):\n+               ✓ strictRouteTypes (enabled by \\`__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES\\`)\"\n+            `)\n           } else if (isRspack) {\n             expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(\n               `\"▲ Next.js x.y.z (Rspack)\"`\n             )\n           } else {\n-            expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(\n-              `\"▲ Next.js x.y.z (webpack)\"`\n-            )\n+            expect(getPreambleOutput(next.cliOutput)).toMatchInlineSnapshot(`\n+             \"▲ Next.js x.y.z (webpack)\n+             - Experiments (use with caution):\n+               ✓ strictRouteTypes (enabled by \\`__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES\\`)\"\n+            `)\n           }\n         }\n       })\n@@ -359,6 +369,7 @@ describe('build-output-prerender', () => {\n              - Experiments (use with caution):\n                ⨯ prerenderEarlyExit (disabled by \\`--debug-prerender\\`)\n                ✓ serverSourceMaps (enabled by \\`--debug-prerender\\`)\n+               ✓ strictRouteTypes (enabled by \\`__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES\\`)\n                ⨯ turbopackMinify (disabled by \\`--debug-prerender\\`)\"\n             `)\n           } else if (isRspack) {\n@@ -377,7 +388,8 @@ describe('build-output-prerender', () => {\n              - Experiments (use with caution):\n                ⨯ prerenderEarlyExit (disabled by \\`--debug-prerender\\`)\n                ⨯ serverMinification (disabled by \\`--debug-prerender\\`)\n-               ✓ serverSourceMaps (enabled by \\`--debug-prerender\\`)\"\n+               ✓ serverSourceMaps (enabled by \\`--debug-prerender\\`)\n+               ✓ strictRouteTypes (enabled by \\`__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES\\`)\"\n             `)\n           }\n         }"
        },
        {
            "sha": "e70256403dfe9412bf31ab421add6db1990c2a6c",
            "filename": "test/production/app-dir/types-gen-nounuselocal/types-gen-nounuselocal.test.ts",
            "status": "modified",
            "additions": 114,
            "deletions": 48,
            "changes": 162,
            "blob_url": "https://github.com/vercel/next.js/blob/85861db787703810b7f76411aa705047a6a7d829/test%2Fproduction%2Fapp-dir%2Ftypes-gen-nounuselocal%2Ftypes-gen-nounuselocal.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/85861db787703810b7f76411aa705047a6a7d829/test%2Fproduction%2Fapp-dir%2Ftypes-gen-nounuselocal%2Ftypes-gen-nounuselocal.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Ftypes-gen-nounuselocal%2Ftypes-gen-nounuselocal.test.ts?ref=85861db787703810b7f76411aa705047a6a7d829",
            "patch": "@@ -2,6 +2,9 @@ import fsp from 'fs/promises'\n import path from 'path'\n import { nextTestSetup } from 'e2e-utils'\n \n+const strictRouteTypes =\n+  process.env.__NEXT_EXPERIMENTAL_STRICT_ROUTE_TYPES === 'true'\n+\n describe('types-gen-nounuselocal', () => {\n   const { next, skipped } = nextTestSetup({\n     files: __dirname,\n@@ -27,65 +30,128 @@ describe('types-gen-nounuselocal', () => {\n     expect(routeTypes).not.toContain('PagesPageConfig')\n     expect(routeTypes).not.toContain('ApiRouteConfig')\n \n-    expect(routeTypes).toMatchInlineSnapshot(`\n-     \"// This file is generated automatically by Next.js\n-     // Do not edit this file manually\n+    if (strictRouteTypes) {\n+      expect(routeTypes).toMatchInlineSnapshot(`\n+       \"// This file is generated automatically by Next.js with experimental.strictRouteTypes\n+       // Do not edit this file manually\n+\n+       type AppRoutes = \"/\"\n+       type PageRoutes = never\n+       type LayoutRoutes = \"/\"\n+       type RedirectRoutes = never\n+       type RewriteRoutes = never\n+       type Routes = AppRoutes | PageRoutes | LayoutRoutes | RedirectRoutes | RewriteRoutes\n \n-     type AppRoutes = \"/\"\n-     type PageRoutes = never\n-     type LayoutRoutes = \"/\"\n-     type RedirectRoutes = never\n-     type RewriteRoutes = never\n-     type Routes = AppRoutes | PageRoutes | LayoutRoutes | RedirectRoutes | RewriteRoutes\n+\n+       interface ParamMap {\n+         \"/\": {}\n+       }\n \n \n-     interface ParamMap {\n-       \"/\": {}\n-     }\n+       export type ParamsOf<Route extends Routes> = ParamMap[Route]\n \n+       interface LayoutSlotMap {\n+         \"/\": never\n+       }\n \n-     export type ParamsOf<Route extends Routes> = ParamMap[Route]\n \n-     interface LayoutSlotMap {\n-       \"/\": never\n-     }\n+       export type { AppRoutes, PageRoutes, LayoutRoutes, RedirectRoutes, RewriteRoutes, ParamMap }\n+\n+       declare global {\n+         /**\n+          * Props for Next.js App Router page components\n+          * @example\n+          * \\`\\`\\`tsx\n+          * export default function Page(props: PageProps<'/blog/[slug]'>) {\n+          *   const { slug } = await props.params\n+          *   return <div>Blog post: {slug}</div>\n+          * }\n+          * \\`\\`\\`\n+          */\n+         interface PageProps<AppRoute extends AppRoutes> {\n+           params: Promise<ParamMap[AppRoute]>\n+           searchParams: Promise<Record<string, string | string[] | undefined>>\n+         }\n+\n+         /**\n+          * Props for Next.js App Router layout components\n+          * @example\n+          * \\`\\`\\`tsx\n+          * export default function Layout(props: LayoutProps<'/dashboard'>) {\n+          *   return <div>{props.children}</div>\n+          * }\n+          * \\`\\`\\`\n+          */\n+         type LayoutProps<LayoutRoute extends LayoutRoutes> = {\n+           params: Promise<ParamMap[LayoutRoute]>\n+           children: React.ReactNode\n+         } & {\n+           [K in LayoutSlotMap[LayoutRoute]]: React.ReactNode\n+         }\n+       }\n+       \"\n+      `)\n+    } else {\n+      expect(routeTypes).toMatchInlineSnapshot(`\n+       \"// This file is generated automatically by Next.js\n+       // Do not edit this file manually\n+\n+       type AppRoutes = \"/\"\n+       type PageRoutes = never\n+       type LayoutRoutes = \"/\"\n+       type RedirectRoutes = never\n+       type RewriteRoutes = never\n+       type Routes = AppRoutes | PageRoutes | LayoutRoutes | RedirectRoutes | RewriteRoutes\n+\n+\n+       interface ParamMap {\n+         \"/\": {}\n+       }\n \n \n-     export type { AppRoutes, PageRoutes, LayoutRoutes, RedirectRoutes, RewriteRoutes, ParamMap }\n+       export type ParamsOf<Route extends Routes> = ParamMap[Route]\n \n-     declare global {\n-       /**\n-        * Props for Next.js App Router page components\n-        * @example\n-        * \\`\\`\\`tsx\n-        * export default function Page(props: PageProps<'/blog/[slug]'>) {\n-        *   const { slug } = await props.params\n-        *   return <div>Blog post: {slug}</div>\n-        * }\n-        * \\`\\`\\`\n-        */\n-       interface PageProps<AppRoute extends AppRoutes> {\n-         params: Promise<ParamMap[AppRoute]>\n-         searchParams: Promise<Record<string, string | string[] | undefined>>\n+       interface LayoutSlotMap {\n+         \"/\": never\n        }\n \n-       /**\n-        * Props for Next.js App Router layout components\n-        * @example\n-        * \\`\\`\\`tsx\n-        * export default function Layout(props: LayoutProps<'/dashboard'>) {\n-        *   return <div>{props.children}</div>\n-        * }\n-        * \\`\\`\\`\n-        */\n-       type LayoutProps<LayoutRoute extends LayoutRoutes> = {\n-         params: Promise<ParamMap[LayoutRoute]>\n-         children: React.ReactNode\n-       } & {\n-         [K in LayoutSlotMap[LayoutRoute]]: React.ReactNode\n+\n+       export type { AppRoutes, PageRoutes, LayoutRoutes, RedirectRoutes, RewriteRoutes, ParamMap }\n+\n+       declare global {\n+         /**\n+          * Props for Next.js App Router page components\n+          * @example\n+          * \\`\\`\\`tsx\n+          * export default function Page(props: PageProps<'/blog/[slug]'>) {\n+          *   const { slug } = await props.params\n+          *   return <div>Blog post: {slug}</div>\n+          * }\n+          * \\`\\`\\`\n+          */\n+         interface PageProps<AppRoute extends AppRoutes> {\n+           params: Promise<ParamMap[AppRoute]>\n+           searchParams: Promise<Record<string, string | string[] | undefined>>\n+         }\n+\n+         /**\n+          * Props for Next.js App Router layout components\n+          * @example\n+          * \\`\\`\\`tsx\n+          * export default function Layout(props: LayoutProps<'/dashboard'>) {\n+          *   return <div>{props.children}</div>\n+          * }\n+          * \\`\\`\\`\n+          */\n+         type LayoutProps<LayoutRoute extends LayoutRoutes> = {\n+           params: Promise<ParamMap[LayoutRoute]>\n+           children: React.ReactNode\n+         } & {\n+           [K in LayoutSlotMap[LayoutRoute]]: React.ReactNode\n+         }\n        }\n-     }\n-     \"\n-    `)\n+       \"\n+      `)\n+    }\n   })\n })"
        }
    ],
    "stats": {
        "total": 628,
        "additions": 560,
        "deletions": 68
    }
}