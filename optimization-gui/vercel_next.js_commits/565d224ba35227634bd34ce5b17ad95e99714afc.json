{
    "author": "lukesandberg",
    "message": "Turbopack: Support ECMAScript styleregex with negative lookahead in `require.context` calls (#78251)\n\nAdd support for more ECMASCRIPT style regular expressions via the `regress` regex engine in order to support `require.context` calls with complex filters.\n\nWe still prefer the `regex` crate when possible as it performs better but fall back to `regress` when the regular expression uses unsupported features.\n\nThis should improve webpack compatibility for `require.context` calls.\n\nCloses PACK-3895",
    "sha": "565d224ba35227634bd34ce5b17ad95e99714afc",
    "files": [
        {
            "sha": "c6725c00effeec6ec23ee3e2598c528b0f2494d1",
            "filename": "Cargo.lock",
            "status": "modified",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/Cargo.lock",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/Cargo.lock",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.lock?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -2365,6 +2365,12 @@ version = \"1.0.7\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"3f9eec918d3f24069decb9af1554cad7c880e2da24a9afd88aca000531ab82c1\"\n \n+[[package]]\n+name = \"foldhash\"\n+version = \"0.1.5\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"d9c4f5dac5e15c24eb999c26181a6ca40b39fe946cbe4c263c7209467bc83af2\"\n+\n [[package]]\n name = \"foreign-types\"\n version = \"0.3.2\"\n@@ -2772,6 +2778,11 @@ name = \"hashbrown\"\n version = \"0.15.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"bf151400ff0baff5465007dd2f3e717f3fe502074ca563069ce3a6629d07b289\"\n+dependencies = [\n+ \"allocator-api2\",\n+ \"equivalent\",\n+ \"foldhash\",\n+]\n \n [[package]]\n name = \"hdrhistogram\"\n@@ -5928,6 +5939,16 @@ dependencies = [\n  \"windows-sys 0.52.0\",\n ]\n \n+[[package]]\n+name = \"regress\"\n+version = \"0.10.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"78ef7fa9ed0256d64a688a3747d0fef7a88851c18a5e1d57f115f38ec2e09366\"\n+dependencies = [\n+ \"hashbrown 0.15.2\",\n+ \"memchr\",\n+]\n+\n [[package]]\n name = \"relative-path\"\n version = \"1.9.0\"\n@@ -9838,6 +9859,7 @@ dependencies = [\n  \"parking_lot\",\n  \"petgraph 0.6.3\",\n  \"regex\",\n+ \"regress\",\n  \"rustc-hash 2.1.0\",\n  \"serde\",\n  \"serde_json\","
        },
        {
            "sha": "0da74756526e635f0b4256a0a1f724f84f9f559f",
            "filename": "Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/Cargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/Cargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.toml?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -388,6 +388,7 @@ quote = \"1.0.23\"\n rand = \"0.9.0\"\n rayon = \"1.10.0\"\n regex = \"1.10.6\"\n+regress = \"0.10.3\"\n reqwest = { version = \"=0.11.17\", default-features = false }\n rstest = \"0.16.0\"\n rustc-hash = \"2.1.0\""
        },
        {
            "sha": "3645aa93c6ef892ce694215e3e6509acaf30eece",
            "filename": "turbopack/crates/turbopack-ecmascript/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2FCargo.toml?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -26,6 +26,7 @@ once_cell = { workspace = true }\n parking_lot = { workspace = true }\n petgraph = { workspace = true }\n regex = { workspace = true }\n+regress = { workspace = true }\n rustc-hash = { workspace = true }\n serde = { workspace = true }\n serde_json = { workspace = true }"
        },
        {
            "sha": "ecd60ada1b48017c2d173d2977002e80fecfec7c",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/es_regex.rs",
            "status": "added",
            "additions": 148,
            "deletions": 0,
            "changes": 148,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fes_regex.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fes_regex.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fes_regex.rs?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -0,0 +1,148 @@\n+use anyhow::{bail, Result};\n+\n+/// A simple regular expression implementation following ecmascript semantics\n+///\n+/// Delegates to the `regex` crate when possible and `regress` otherwise.\n+#[derive(Debug, Clone)]\n+#[turbo_tasks::value(eq = \"manual\", shared)]\n+#[serde(into = \"RegexForm\", try_from = \"RegexForm\")]\n+pub struct EsRegex {\n+    #[turbo_tasks(trace_ignore)]\n+    delegate: EsRegexImpl,\n+    // Store the original arguments used to construct\n+    // this regex to support equality and serialization.\n+    pattern: String,\n+    flags: String,\n+}\n+\n+#[derive(Debug, Clone)]\n+enum EsRegexImpl {\n+    Regex(regex::Regex),\n+    Regress(regress::Regex),\n+}\n+\n+/// Equality uses the source inputs since our delegate regex impls don't support\n+/// equality natively.\n+/// NOTE: there are multiple 'equivalent' ways to write a regex and this\n+/// approach does _not_ attempt to equate them.\n+impl PartialEq for EsRegex {\n+    fn eq(&self, other: &Self) -> bool {\n+        self.pattern == other.pattern && self.flags == other.flags\n+    }\n+}\n+impl Eq for EsRegex {}\n+\n+impl TryFrom<RegexForm> for EsRegex {\n+    type Error = anyhow::Error;\n+\n+    fn try_from(value: RegexForm) -> std::result::Result<Self, Self::Error> {\n+        EsRegex::new(&value.pattern, &value.pattern)\n+    }\n+}\n+\n+/// This is the serializable form for the `EsRegex` struct\n+#[derive(serde::Serialize, serde::Deserialize, Debug, Clone)]\n+struct RegexForm {\n+    pattern: String,\n+    flags: String,\n+}\n+\n+impl From<EsRegex> for RegexForm {\n+    fn from(value: EsRegex) -> Self {\n+        Self {\n+            pattern: value.pattern,\n+            flags: value.flags,\n+        }\n+    }\n+}\n+\n+impl EsRegex {\n+    /// Support ecmascript style regular expressions by selecting the `regex` crate when possible\n+    /// and using regress when not.\n+    pub fn new(pattern: &str, flags: &str) -> Result<Self> {\n+        // rust regex doesn't allow escaped slashes, but they are necessary in js\n+        let pattern = pattern.replace(\"\\\\/\", \"/\");\n+\n+        let mut applied_flags = String::new();\n+        for flag in flags.chars() {\n+            match flag {\n+                // indices for substring matches: not relevant for the regex itself\n+                'd' => {}\n+                // global: default in rust, ignore\n+                'g' => {}\n+                // case-insensitive: letters match both upper and lower case\n+                'i' => applied_flags.push('i'),\n+                // multi-line mode: ^ and $ match begin/end of line\n+                'm' => applied_flags.push('m'),\n+                // allow . to match \\n\n+                's' => applied_flags.push('s'),\n+                // Unicode support (enabled by default)\n+                'u' => applied_flags.push('u'),\n+                // sticky search: not relevant for the regex itself\n+                'y' => {}\n+                _ => bail!(\"unsupported flag `{}` in regex\", flag),\n+            }\n+        }\n+\n+        let regex = if !applied_flags.is_empty() {\n+            regex::Regex::new(&format!(\"(?{}){}\", applied_flags, pattern))\n+        } else {\n+            regex::Regex::new(&pattern)\n+        };\n+\n+        let delegate = match regex {\n+            Ok(reg) => Ok(EsRegexImpl::Regex(reg)),\n+            Err(_e) => {\n+                // We failed to parse as an regex:Regex, try using regress. Regress uses the es\n+                // flags format so we can pass the original flags value.\n+                match regress::Regex::with_flags(&pattern, regress::Flags::from(flags)) {\n+                    Ok(reg) => Ok(EsRegexImpl::Regress(reg)),\n+                    // Propogate the error as is, regress has useful error messages.\n+                    Err(e) => Err(e),\n+                }\n+            }\n+        }?;\n+        Ok(Self {\n+            delegate,\n+            pattern,\n+            flags: flags.to_string(),\n+        })\n+    }\n+\n+    /// Returns true if there is any match for this regex in the `haystac`\n+    pub fn is_match(&self, haystack: &str) -> bool {\n+        match &self.delegate {\n+            EsRegexImpl::Regex(r) => r.is_match(haystack),\n+            EsRegexImpl::Regress(r) => r.find(haystack).is_some(),\n+        }\n+    }\n+}\n+\n+#[cfg(test)]\n+mod tests {\n+    use super::{EsRegex, EsRegexImpl};\n+\n+    #[test]\n+    fn es_regex_matches_simple() {\n+        let regex = EsRegex::new(\"a\", \"\").unwrap();\n+        assert!(matches!(regex.delegate, EsRegexImpl::Regex { .. }));\n+        assert!(regex.is_match(\"a\"));\n+    }\n+\n+    #[test]\n+    fn es_regex_matches_negative_lookahead() {\n+        // This feature is not supported by the regex crate\n+        let regex = EsRegex::new(\"a(?!b)\", \"\").unwrap();\n+        assert!(matches!(regex.delegate, EsRegexImpl::Regress { .. }));\n+        assert!(!regex.is_match(\"ab\"));\n+        assert!(regex.is_match(\"ac\"));\n+    }\n+\n+    #[test]\n+    fn invalid_regex() {\n+        // This is invalid since there is nothing being repeated\n+        // Don't bother asserting on the message since we delegate\n+        // that to the underlying implementations.\n+        assert!(matches!(EsRegex::new(\"*\", \"\"), Err { .. }))\n+    }\n+}"
        },
        {
            "sha": "6cef454f24274f654211c29689a3efcd3f200237",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/mod.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 41,
            "changes": 49,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -11,12 +11,11 @@ use std::{\n     sync::Arc,\n };\n \n-use anyhow::{bail, Context, Result};\n+use anyhow::{bail, Result};\n use graph::VarGraph;\n use num_bigint::BigInt;\n use num_traits::identities::Zero;\n use once_cell::sync::Lazy;\n-use regex::Regex;\n use rustc_hash::FxHasher;\n use swc_core::{\n     common::Mark,\n@@ -33,9 +32,12 @@ use turbopack_core::compile_time_info::{\n \n use self::imports::ImportAnnotations;\n pub(crate) use self::imports::ImportMap;\n-use crate::{references::require_context::RequireContextMap, utils::StringifyJs};\n+use crate::{\n+    analyzer::es_regex::EsRegex, references::require_context::RequireContextMap, utils::StringifyJs,\n+};\n \n pub mod builtin;\n+pub mod es_regex;\n pub mod graph;\n pub mod imports;\n pub mod linker;\n@@ -3722,42 +3724,7 @@ pub struct RequireContextOptions {\n     pub dir: RcStr,\n     pub include_subdirs: bool,\n     /// this is a regex (pattern, flags)\n-    pub filter: Regex,\n-}\n-\n-/// Convert an ECMAScript regex to a Rust regex.\n-fn regex_from_js(pattern: &str, flags: &str) -> Result<Regex> {\n-    // rust regex doesn't allow escaped slashes, but they are necessary in js\n-    let pattern = pattern.replace(\"\\\\/\", \"/\");\n-\n-    let mut applied_flags = String::new();\n-    for flag in flags.chars() {\n-        match flag {\n-            // indices for substring matches: not relevant for the regex itself\n-            'd' => {}\n-            // global: default in rust, ignore\n-            'g' => {}\n-            // case-insensitive: letters match both upper and lower case\n-            'i' => applied_flags.push('i'),\n-            // multi-line mode: ^ and $ match begin/end of line\n-            'm' => applied_flags.push('m'),\n-            // allow . to match \\n\n-            's' => applied_flags.push('s'),\n-            // Unicode support (enabled by default)\n-            'u' => applied_flags.push('u'),\n-            // sticky search: not relevant for the regex itself\n-            'y' => {}\n-            _ => bail!(\"unsupported flag `{}` in regex\", flag),\n-        }\n-    }\n-\n-    let regex = if !applied_flags.is_empty() {\n-        format!(\"(?{}){}\", applied_flags, pattern)\n-    } else {\n-        pattern\n-    };\n-\n-    Regex::new(&regex).context(\"could not convert ECMAScript regex to Rust regex\")\n+    pub filter: EsRegex,\n }\n \n /// Parse the arguments passed to a require.context invocation, validate them\n@@ -3787,14 +3754,14 @@ pub fn parse_require_context(args: &[JsValue]) -> Result<RequireContextOptions>\n \n     let filter = if let Some(filter) = args.get(2) {\n         if let JsValue::Constant(ConstantValue::Regex(box (pattern, flags))) = filter {\n-            regex_from_js(pattern, flags)?\n+            EsRegex::new(pattern, flags)?\n         } else {\n             bail!(\"require.context(..., ..., filter) requires filter to be a regex\");\n         }\n     } else {\n         // https://webpack.js.org/api/module-methods/#requirecontext\n         // > optional, default /^\\.\\/.*$/, any file\n-        static DEFAULT_REGEX: Lazy<Regex> = Lazy::new(|| Regex::new(r\"^\\\\./.*$\").unwrap());\n+        static DEFAULT_REGEX: Lazy<EsRegex> = Lazy::new(|| EsRegex::new(r\"^\\\\./.*$\", \"\").unwrap());\n \n         DEFAULT_REGEX.clone()\n     };"
        },
        {
            "sha": "5f137fa4b78f89f629198d6b033b3e55f0c01c45",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/mod.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -1857,7 +1857,7 @@ async fn handle_call<G: Fn(Vec<Effect>) + Send + Sync>(\n                     origin,\n                     options.dir,\n                     options.include_subdirs,\n-                    Vc::cell(options.filter),\n+                    options.filter.cell(),\n                     Some(issue_source(source, span)),\n                     in_try,\n                 )\n@@ -3025,7 +3025,7 @@ async fn require_context_visitor(\n         origin,\n         dir,\n         options.include_subdirs,\n-        Vc::cell(options.filter),\n+        options.filter.cell(),\n         None,\n         true,\n     );"
        },
        {
            "sha": "f9ab1dd2f812300f96000787f9ff3398527c71af",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/require_context.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 7,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -15,8 +15,8 @@ use swc_core::{\n };\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n-    debug::ValueDebugFormat, primitives::Regex, trace::TraceRawVcs, FxIndexMap, NonLocalValue,\n-    ResolvedVc, Value, ValueToString, Vc,\n+    debug::ValueDebugFormat, trace::TraceRawVcs, FxIndexMap, NonLocalValue, ResolvedVc, Value,\n+    ValueToString, Vc,\n };\n use turbo_tasks_fs::{DirectoryContent, DirectoryEntry, FileSystemPath};\n use turbopack_core::{\n@@ -36,6 +36,7 @@ use turbopack_core::{\n use turbopack_resolve::ecmascript::cjs_resolve;\n \n use crate::{\n+    analyzer::es_regex::EsRegex,\n     chunk::{\n         EcmascriptChunkItem, EcmascriptChunkItemContent, EcmascriptChunkType, EcmascriptExports,\n     },\n@@ -63,7 +64,7 @@ pub(crate) struct DirList(FxIndexMap<RcStr, DirListEntry>);\n #[turbo_tasks::value_impl]\n impl DirList {\n     #[turbo_tasks::function]\n-    pub(crate) fn read(dir: Vc<FileSystemPath>, recursive: bool, filter: Vc<Regex>) -> Vc<Self> {\n+    pub(crate) fn read(dir: Vc<FileSystemPath>, recursive: bool, filter: Vc<EsRegex>) -> Vc<Self> {\n         Self::read_internal(dir, dir, recursive, filter)\n     }\n \n@@ -72,7 +73,7 @@ impl DirList {\n         root: Vc<FileSystemPath>,\n         dir: Vc<FileSystemPath>,\n         recursive: bool,\n-        filter: Vc<Regex>,\n+        filter: Vc<EsRegex>,\n     ) -> Result<Vc<Self>> {\n         let root_val = &root.await?;\n         let dir_val = &dir.await?;\n@@ -148,7 +149,7 @@ pub(crate) struct FlatDirList(FxIndexMap<RcStr, ResolvedVc<FileSystemPath>>);\n #[turbo_tasks::value_impl]\n impl FlatDirList {\n     #[turbo_tasks::function]\n-    pub(crate) fn read(dir: Vc<FileSystemPath>, recursive: bool, filter: Vc<Regex>) -> Vc<Self> {\n+    pub(crate) fn read(dir: Vc<FileSystemPath>, recursive: bool, filter: Vc<EsRegex>) -> Vc<Self> {\n         DirList::read(dir, recursive, filter).flatten()\n     }\n }\n@@ -172,7 +173,7 @@ impl RequireContextMap {\n         origin: Vc<Box<dyn ResolveOrigin>>,\n         dir: Vc<FileSystemPath>,\n         recursive: bool,\n-        filter: Vc<Regex>,\n+        filter: Vc<EsRegex>,\n         issue_source: Option<IssueSource>,\n         is_optional: bool,\n     ) -> Result<Vc<Self>> {\n@@ -227,7 +228,7 @@ impl RequireContextAssetReference {\n         origin: ResolvedVc<Box<dyn ResolveOrigin>>,\n         dir: RcStr,\n         include_subdirs: bool,\n-        filter: Vc<Regex>,\n+        filter: Vc<EsRegex>,\n         issue_source: Option<IssueSource>,\n         in_try: bool,\n     ) -> Result<Self> {"
        },
        {
            "sha": "041dd0671485f3b6e41163d3f4a7f56f15dd6bdb",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/resolving/require-context/input/deps/foo.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fresolving%2Frequire-context%2Finput%2Fdeps%2Ffoo.js",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fresolving%2Frequire-context%2Finput%2Fdeps%2Ffoo.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fresolving%2Frequire-context%2Finput%2Fdeps%2Ffoo.js?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -0,0 +1 @@\n+exports.foo = \"You found me\";\n\\ No newline at end of file"
        },
        {
            "sha": "4665cc2be18fc440e4570e95dfdfd4d4aa664542",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/resolving/require-context/input/deps/foo_test.js",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fresolving%2Frequire-context%2Finput%2Fdeps%2Ffoo_test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fresolving%2Frequire-context%2Finput%2Fdeps%2Ffoo_test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fresolving%2Frequire-context%2Finput%2Fdeps%2Ffoo_test.js?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -0,0 +1,2 @@\n+\n+exports.foo = \"You should not find me\";\n\\ No newline at end of file"
        },
        {
            "sha": "cc0447c465d30e227e19a0415d9a9337bc16b72b",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/resolving/require-context/input/index.js",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fresolving%2Frequire-context%2Finput%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/565d224ba35227634bd34ce5b17ad95e99714afc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fresolving%2Frequire-context%2Finput%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fresolving%2Frequire-context%2Finput%2Findex.js?ref=565d224ba35227634bd34ce5b17ad95e99714afc",
            "patch": "@@ -0,0 +1,8 @@\n+\n+// PACK-3895: ensure that negative lookaround works.\n+it('ensure require.context respects filters with look-around assertions',  ()=> {\n+    let ctx = require.context(\"./deps\", true, /foo(?!_test)/);\n+    // import all the matches, should just get foo.js\n+    expect(ctx.keys().map(k => Object.values(ctx(k))).flat()).toEqual(['You found me']);\n+});\n+"
        }
    ],
    "stats": {
        "total": 251,
        "additions": 201,
        "deletions": 50
    }
}