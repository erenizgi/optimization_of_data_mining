{
    "author": "gaojude",
    "message": "[dev-overlay] fix Geist fonts (#76166)\n\n### What?\n\nTwo issues need to be solved:\n1. Font isn't working. Dev overlay uses Geist fonts. Currently does not\nwork if they are not installed in OS.\n2. Even if fonts worked, we would be downloading fonts from Google for\nthe dev overlay, which is not ideal for slow internet & users with\nrestricted access to Google.\n\n### Why?\n\n**Reason to (1):** Styles defined inside Shadow DOM cannot contain\n`@font-face`. Custom fonts should be defined in the main container and\ncan be accessed in Shadow DOM. Read this\n[post](https://robdodson.me/posts/at-font-face-doesnt-work-in-shadow-dom/).\n\n### How?\n\nTo solve (1), we simply lift the font styles outside the Shadow DOM.\nTo solve (2), we introduce a new dev middleware for the dev-server that\nserves the font assets & we modify the taskfile to move the woff2 fonts\nto the dist folder.\n\n\nCloses NDX-834",
    "sha": "9966e7e1b3a9e5541c870759787f99675b53a781",
    "files": [
        {
            "sha": "f54f7a5608976d9962164be0db4098695709d6e1",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/app/react-dev-overlay.tsx",
            "status": "modified",
            "additions": 31,
            "deletions": 25,
            "changes": 56,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fapp%2Freact-dev-overlay.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fapp%2Freact-dev-overlay.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fapp%2Freact-dev-overlay.tsx?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -12,6 +12,8 @@ import { ErrorOverlay } from '../internal/components/errors/error-overlay/error-\n import { DevToolsIndicator } from '../internal/components/errors/dev-tools-indicator/dev-tools-indicator'\n import { RenderError } from '../internal/container/runtime-error/render-error'\n \n+import { FontStyles } from '../font/font-styles'\n+\n export default function ReactDevOverlay({\n   state,\n   globalError,\n@@ -24,33 +26,37 @@ export default function ReactDevOverlay({\n   const [isErrorOverlayOpen, setIsErrorOverlayOpen] = useState(false)\n \n   const devOverlay = (\n-    <ShadowPortal>\n-      <CssReset />\n-      <Base />\n-      <Colors />\n-      <ComponentStyles />\n+    <>\n+      {/* Fonts can only be loaded outside the Shadow DOM. */}\n+      <FontStyles />\n+      <ShadowPortal>\n+        <CssReset />\n+        <Base />\n+        <Colors />\n+        <ComponentStyles />\n \n-      <RenderError state={state} isAppDir={true}>\n-        {({ readyErrors, totalErrorCount }) => {\n-          return (\n-            <>\n-              <DevToolsIndicator\n-                state={state}\n-                errorCount={totalErrorCount}\n-                setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n-              />\n+        <RenderError state={state} isAppDir={true}>\n+          {({ readyErrors, totalErrorCount }) => {\n+            return (\n+              <>\n+                <DevToolsIndicator\n+                  state={state}\n+                  errorCount={totalErrorCount}\n+                  setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n+                />\n \n-              <ErrorOverlay\n-                state={state}\n-                readyErrors={readyErrors}\n-                isErrorOverlayOpen={isErrorOverlayOpen}\n-                setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n-              />\n-            </>\n-          )\n-        }}\n-      </RenderError>\n-    </ShadowPortal>\n+                <ErrorOverlay\n+                  state={state}\n+                  readyErrors={readyErrors}\n+                  isErrorOverlayOpen={isErrorOverlayOpen}\n+                  setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n+                />\n+              </>\n+            )\n+          }}\n+        </RenderError>\n+      </ShadowPortal>\n+    </>\n   )\n \n   return ("
        },
        {
            "sha": "d6121d8f7b4cbcaf88693b40aa59f07cc85fb287",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/font/font-styles.tsx",
            "status": "added",
            "additions": 57,
            "deletions": 0,
            "changes": 57,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Ffont-styles.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Ffont-styles.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Ffont-styles.tsx?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -0,0 +1,57 @@\n+import { noop as css } from '../internal/helpers/noop-template'\n+\n+export const FontStyles = () => {\n+  return (\n+    // precedence & href are to satisfy React float's style hoisting\n+    <style precedence=\"default\" href=\"/__nextjs_font_styles\">\n+      {css`\n+        /* latin-ext */\n+        @font-face {\n+          font-family: 'Geist';\n+          font-style: normal;\n+          font-weight: 400 600;\n+          font-display: swap;\n+          src: url(__nextjs_font/geist-latin-ext.woff2) format('woff2');\n+          unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7,\n+            U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F,\n+            U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F,\n+            U+A720-A7FF;\n+        }\n+        /* latin-ext */\n+        @font-face {\n+          font-family: 'Geist Mono';\n+          font-style: normal;\n+          font-weight: 400 600;\n+          font-display: swap;\n+          src: url(__nextjs_font/geist-mono-latin-ext.woff2) format('woff2');\n+          unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7,\n+            U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F,\n+            U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F,\n+            U+A720-A7FF;\n+        }\n+        /* latin */\n+        @font-face {\n+          font-family: 'Geist';\n+          font-style: normal;\n+          font-weight: 400 600;\n+          font-display: swap;\n+          src: url(__nextjs_font/geist-latin.woff2) format('woff2');\n+          unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6,\n+            U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122,\n+            U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n+        }\n+        /* latin */\n+        @font-face {\n+          font-family: 'Geist Mono';\n+          font-style: normal;\n+          font-weight: 400 600;\n+          font-display: swap;\n+          src: url(__nextjs_font/geist-mono-latin.woff2) format('woff2');\n+          unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6,\n+            U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122,\n+            U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n+        }\n+      `}\n+    </style>\n+  )\n+}"
        },
        {
            "sha": "e36649933f3a206057fe1068cff2e5078f043c59",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/font/geist-latin-ext.woff2.woff2",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-latin-ext.woff2.woff2",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-latin-ext.woff2.woff2",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-latin-ext.woff2.woff2?ref=9966e7e1b3a9e5541c870759787f99675b53a781"
        },
        {
            "sha": "445e0e55cbb80e4a1fd7d429c4384b61b453da2b",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/font/geist-latin.woff2",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-latin.woff2",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-latin.woff2",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-latin.woff2?ref=9966e7e1b3a9e5541c870759787f99675b53a781"
        },
        {
            "sha": "944424f972b9f9c985163da8096a25b214fa1983",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/font/geist-mono-latin-ext.woff2",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-mono-latin-ext.woff2",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-mono-latin-ext.woff2",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-mono-latin-ext.woff2?ref=9966e7e1b3a9e5541c870759787f99675b53a781"
        },
        {
            "sha": "68eeb7f4bd4a789bc1600f76e6ebac0a0c170d46",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/font/geist-mono-latin.woff2",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-mono-latin.woff2",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-mono-latin.woff2",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fgeist-mono-latin.woff2?ref=9966e7e1b3a9e5541c870759787f99675b53a781"
        },
        {
            "sha": "5ad7e9705b87b7ff4645b1c6e7c47fa9d2036a73",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/font/get-dev-overlay-font-middleware.ts",
            "status": "added",
            "additions": 69,
            "deletions": 0,
            "changes": 69,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fget-dev-overlay-font-middleware.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fget-dev-overlay-font-middleware.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Ffont%2Fget-dev-overlay-font-middleware.ts?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -0,0 +1,69 @@\n+import { internalServerError } from '../../server/shared'\n+import { notFound } from '../../../not-found'\n+import type { ServerResponse, IncomingMessage } from 'http'\n+import path from 'path'\n+import * as fs from 'fs/promises'\n+import { constants } from 'fs'\n+\n+const FONT_PREFIX = '/__nextjs_font/'\n+\n+const VALID_FONTS = [\n+  'geist-latin-ext.woff2',\n+  'geist-mono-latin-ext.woff2',\n+  'geist-latin.woff2',\n+  'geist-mono-latin.woff2',\n+]\n+\n+const FONT_HEADERS = {\n+  'Content-Type': 'font/woff2',\n+  'Cache-Control': 'public, max-age=31536000, immutable',\n+} as const\n+\n+export function getDevOverlayFontMiddleware() {\n+  return async function devOverlayFontMiddleware(\n+    req: IncomingMessage,\n+    res: ServerResponse,\n+    next: () => void\n+  ): Promise<void> {\n+    try {\n+      const { pathname } = new URL(`http://n${req.url}`)\n+\n+      if (!pathname.startsWith(FONT_PREFIX)) {\n+        return next()\n+      }\n+\n+      const fontFile = pathname.replace(FONT_PREFIX, '')\n+      if (!VALID_FONTS.includes(fontFile)) {\n+        return notFound()\n+      }\n+\n+      const fontPath = path.resolve(__dirname, fontFile)\n+      const fileExists = await checkFileExists(fontPath)\n+\n+      if (!fileExists) {\n+        return notFound()\n+      }\n+\n+      const fontData = await fs.readFile(fontPath)\n+      Object.entries(FONT_HEADERS).forEach(([key, value]) => {\n+        res.setHeader(key, value)\n+      })\n+      res.end(fontData)\n+    } catch (err) {\n+      console.error(\n+        'Failed to serve font:',\n+        err instanceof Error ? err.message : err\n+      )\n+      return internalServerError(res)\n+    }\n+  }\n+}\n+\n+async function checkFileExists(filePath: string): Promise<boolean> {\n+  try {\n+    await fs.access(filePath, constants.F_OK)\n+    return true\n+  } catch {\n+    return false\n+  }\n+}"
        },
        {
            "sha": "b9c0ccff16a2bf5eff9133767477d323f2559507",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/styles/base.tsx",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fstyles%2Fbase.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fstyles%2Fbase.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fstyles%2Fbase.tsx?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -5,8 +5,6 @@ export function Base() {\n   return (\n     <style>\n       {css`\n-        @import url('https://fonts.googleapis.com/css2?family=Geist:wght@400;500;600&family=Geist+Mono:wght@400;500;600&display=swap');\n-\n         :host {\n           ${\n             // Although the style applied to the shadow host is isolated,"
        },
        {
            "sha": "22753f2e76ad1096e0880ee4489aa5bf4ab5173e",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/pages/react-dev-overlay.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fpages%2Freact-dev-overlay.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fpages%2Freact-dev-overlay.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fpages%2Freact-dev-overlay.tsx?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -12,6 +12,7 @@ import { Colors } from '../internal/styles/colors'\n import { ErrorOverlay } from '../internal/components/errors/error-overlay/error-overlay'\n import { DevToolsIndicator } from '../internal/components/errors/dev-tools-indicator/dev-tools-indicator'\n import { RenderError } from '../internal/container/runtime-error/render-error'\n+import { FontStyles } from '../font/font-styles'\n \n export type ErrorType = 'runtime' | 'build'\n \n@@ -31,6 +32,8 @@ export default function ReactDevOverlay({ children }: ReactDevOverlayProps) {\n         {children ?? null}\n       </DevOverlayErrorBoundary>\n \n+      {/* Fonts can only be loaded outside the Shadow DOM. */}\n+      <FontStyles />\n       <ShadowPortal>\n         <CssReset />\n         <Base />"
        },
        {
            "sha": "3dd572b571c7e21ed61da13d07dc79f018c333f8",
            "filename": "packages/next/src/server/dev/hot-reloader-turbopack.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -94,6 +94,7 @@ import {\n   type EntryIssuesMap,\n   type TopLevelIssuesMap,\n } from '../../shared/lib/turbopack/utils'\n+import { getDevOverlayFontMiddleware } from '../../client/components/react-dev-overlay/_experimental/font/get-dev-overlay-font-middleware'\n // import { getSupportedBrowsers } from '../../build/utils'\n \n const wsServer = new ws.Server({ noServer: true })\n@@ -634,6 +635,7 @@ export async function createHotReloaderTurbopack(\n     getOverlayMiddleware(project),\n     getSourceMapMiddleware(project),\n     getNextErrorFeedbackMiddleware(opts.telemetry),\n+    getDevOverlayFontMiddleware(),\n   ]\n \n   const versionInfoPromise = getVersionInfo()"
        },
        {
            "sha": "c4348e12387519c66c495815c955d45b546bfea4",
            "filename": "packages/next/src/server/dev/hot-reloader-webpack.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-webpack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-webpack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-webpack.ts?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -84,6 +84,7 @@ import { PAGE_TYPES } from '../../lib/page-types'\n import { FAST_REFRESH_RUNTIME_RELOAD } from './messages'\n import { getNodeDebugType } from '../lib/utils'\n import { getNextErrorFeedbackMiddleware } from '../../client/components/react-dev-overlay/server/get-next-error-feedback-middleware'\n+import { getDevOverlayFontMiddleware } from '../../client/components/react-dev-overlay/_experimental/font/get-dev-overlay-font-middleware'\n \n const MILLISECONDS_IN_NANOSECOND = BigInt(1_000_000)\n \n@@ -1547,6 +1548,7 @@ export default class HotReloaderWebpack implements NextJsHotReloaderInterface {\n         edgeServerStats: () => this.edgeServerStats,\n       }),\n       getNextErrorFeedbackMiddleware(this.telemetry),\n+      getDevOverlayFontMiddleware(),\n     ]\n   }\n "
        },
        {
            "sha": "07234dcb85f35f005acb8fbe9aec5ed6c658852f",
            "filename": "packages/next/taskfile-swc.js",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Ftaskfile-swc.js",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Ftaskfile-swc.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ftaskfile-swc.js?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -19,7 +19,12 @@ module.exports = function (task) {\n       { stripExtension, interopClientDefaultExport = false, esm = false } = {}\n     ) {\n       // Don't compile .d.ts\n-      if (file.base.endsWith('.d.ts') || file.base.endsWith('.json')) return\n+      if (\n+        file.base.endsWith('.d.ts') ||\n+        file.base.endsWith('.json') ||\n+        file.base.endsWith('.woff2')\n+      )\n+        return\n \n       const plugins = [\n         ...(file.base.includes('.test.') || file.base.includes('.stories.')"
        },
        {
            "sha": "cd183fc39fedc65441fcc76923a90a2b57fb80f3",
            "filename": "packages/next/taskfile.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Ftaskfile.js",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/packages%2Fnext%2Ftaskfile.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ftaskfile.js?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -2583,14 +2583,14 @@ export async function nextbuildjest(task, opts) {\n \n export async function client(task, opts) {\n   await task\n-    .source('src/client/**/!(*.test).+(js|ts|tsx)')\n+    .source('src/client/**/!(*.test).+(js|ts|tsx|woff2)')\n     .swc('client', { dev: opts.dev, interopClientDefaultExport: true })\n     .target('dist/client')\n }\n \n export async function client_esm(task, opts) {\n   await task\n-    .source('src/client/**/!(*.test).+(js|ts|tsx)')\n+    .source('src/client/**/!(*.test).+(js|ts|tsx|woff2)')\n     .swc('client', { dev: opts.dev, esm: true })\n     .target('dist/esm/client')\n }"
        },
        {
            "sha": "a4a4cc3cd42f83757fab76e45d94d287d95e2e16",
            "filename": "test/development/acceptance-app/hydration-error.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/9966e7e1b3a9e5541c870759787f99675b53a781/test%2Fdevelopment%2Facceptance-app%2Fhydration-error.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/9966e7e1b3a9e5541c870759787f99675b53a781/test%2Fdevelopment%2Facceptance-app%2Fhydration-error.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Fhydration-error.test.ts?ref=9966e7e1b3a9e5541c870759787f99675b53a781",
            "patch": "@@ -216,7 +216,7 @@ describe('Error overlay for hydration errors in App router', () => {\n        \"...\n            <HotReload assetPrefix=\"\" globalError={[...]}>\n              <ReactDevOverlay state={{nextId:1, ...}} dispatcher={{...}} globalError={[...]}>\n-               <DevOverlayErrorBoundary devOverlay={<ShadowPortal>} globalError={[...]} ...>\n+               <DevOverlayErrorBoundary devOverlay={<Fragment>} globalError={[...]} onError={function bound dispatchSetState}>\n                  <DevRootHTTPAccessFallbackBoundary>\n                    <HTTPAccessFallbackBoundary notFound={<NotAllowedRootHTTPFallbackError>}>\n                      <HTTPAccessFallbackErrorBoundary pathname=\"/\" notFound={<NotAllowedRootHTTPFallbackError>} ...>\n@@ -239,7 +239,7 @@ describe('Error overlay for hydration errors in App router', () => {\n        \"...\n            <HotReload assetPrefix=\"\" globalError={[...]}>\n              <ReactDevOverlay state={{nextId:1, ...}} dispatcher={{...}} globalError={[...]}>\n-               <DevOverlayErrorBoundary devOverlay={<ShadowPortal>} globalError={[...]} ...>\n+               <DevOverlayErrorBoundary devOverlay={<Fragment>} globalError={[...]} onError={function bound dispatchSetState}>\n                  <DevRootHTTPAccessFallbackBoundary>\n                    <HTTPAccessFallbackBoundary notFound={<NotAllowedRootHTTPFallbackError>}>\n                      <HTTPAccessFallbackErrorBoundary pathname=\"/\" notFound={<NotAllowedRootHTTPFallbackError>} ...>"
        }
    ],
    "stats": {
        "total": 206,
        "additions": 174,
        "deletions": 32
    }
}