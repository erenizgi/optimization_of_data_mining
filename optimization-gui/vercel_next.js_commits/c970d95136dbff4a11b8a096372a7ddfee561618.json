{
    "author": "bgub",
    "message": "feat: stabilize experimental.typedRoutes flag (#82762)\n\n- Rename `experimental.typedRoutes` to `typedRoutes` \n- Remove old references to `typedRoutes` not working with Turbopack\n- Remove unnecessary encoding of `typedRoutes` for bundlers",
    "sha": "c970d95136dbff4a11b8a096372a7ddfee561618",
    "files": [
        {
            "sha": "57aec5747db7f5971c1cbfc5ff6af1b23e858936",
            "filename": "crates/next-core/src/next_config.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_config.rs?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -795,10 +795,7 @@ pub struct ExperimentalConfig {\n     swc_trace_profiling: Option<bool>,\n     /// @internal Used by the Next.js internals only.\n     trust_host_header: Option<bool>,\n-    /// Generate Route types and enable type checking for Link and Router.push,\n-    /// etc. This option requires `appDir` to be enabled first.\n-    /// @see [api reference](https://nextjs.org/docs/app/api-reference/next-config-js/typedRoutes)\n-    typed_routes: Option<bool>,\n+\n     url_imports: Option<serde_json::Value>,\n     view_transition: Option<bool>,\n     /// This option is to enable running the Webpack build in a worker thread"
        },
        {
            "sha": "9f6019f7ed4a5739637de24c1e093e7628832193",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/typedRoutes.mdx",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FtypedRoutes.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FtypedRoutes.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FtypedRoutes.mdx?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -1,17 +1,16 @@\n ---\n title: typedRoutes\n-description: Enable experimental support for statically typed links.\n-version: experimental\n+description: Enable support for statically typed links.\n ---\n \n-Experimental support for [statically typed links](/docs/app/api-reference/config/typescript#statically-typed-links). This feature requires using the App Router as well as TypeScript in your project.\n+> **Note**: This option has been marked as stable, so you should use `typedRoutes` instead of `experimental.typedRoutes`.\n+\n+Support for [statically typed links](/docs/app/api-reference/config/typescript#statically-typed-links). This feature requires using TypeScript in your project.\n \n ```js filename=\"next.config.js\"\n /** @type {import('next').NextConfig} */\n const nextConfig = {\n-  experimental: {\n-    typedRoutes: true,\n-  },\n+  typedRoutes: true,\n }\n \n module.exports = nextConfig"
        },
        {
            "sha": "b7513067867ca84802d90786a179cd41f65380ac",
            "filename": "docs/01-app/03-api-reference/05-config/02-typescript.mdx",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/docs%2F01-app%2F03-api-reference%2F05-config%2F02-typescript.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/docs%2F01-app%2F03-api-reference%2F05-config%2F02-typescript.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F02-typescript.mdx?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -109,15 +109,13 @@ module.exports = nextConfig\n \n Next.js can statically type links to prevent typos and other errors when using `next/link`, improving type safety when navigating between pages.\n \n-To opt-into this feature, `experimental.typedRoutes` need to be enabled and the project needs to be using TypeScript.\n+To opt-into this feature, `typedRoutes` need to be enabled and the project needs to be using TypeScript.\n \n ```ts filename=\"next.config.ts\"\n import type { NextConfig } from 'next'\n \n const nextConfig: NextConfig = {\n-  experimental: {\n-    typedRoutes: true,\n-  },\n+  typedRoutes: true,\n }\n \n export default nextConfig"
        },
        {
            "sha": "401d26108391d37bfc9d47f7dddc1ee11a3d24fe",
            "filename": "packages/next/src/build/webpack-config.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -2310,7 +2310,6 @@ export default async function getBaseWebpackConfig(\n     optimizeCss: config.experimental.optimizeCss,\n     nextScriptWorkers: config.experimental.nextScriptWorkers,\n     scrollRestoration: config.experimental.scrollRestoration,\n-    typedRoutes: config.experimental.typedRoutes,\n     basePath: config.basePath,\n     excludeDefaultMomentLocales: config.excludeDefaultMomentLocales,\n     assetPrefix: config.assetPrefix,"
        },
        {
            "sha": "b5098b8ec774e4d996dcf12b1ed1c41a8c41a653",
            "filename": "packages/next/src/client/app-dir/link.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fclient%2Fapp-dir%2Flink.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fclient%2Fapp-dir%2Flink.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fapp-dir%2Flink.tsx?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -219,7 +219,7 @@ type InternalLinkProps = {\n // adding this to the publicly exported type currently breaks existing apps\n \n // `RouteInferType` is a stub here to avoid breaking `typedRoutes` when the type\n-// isn't generated yet. It will be replaced when the webpack plugin runs.\n+// isn't generated yet. It will be replaced when type generation runs.\n // eslint-disable-next-line @typescript-eslint/no-unused-vars\n export type LinkProps<RouteInferType = any> = InternalLinkProps\n type LinkPropsRequired = RequiredKeys<LinkProps>"
        },
        {
            "sha": "0608f7887931fba40dfcb457645d0848095f6f51",
            "filename": "packages/next/src/client/form-shared.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fclient%2Fform-shared.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fclient%2Fform-shared.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fform-shared.tsx?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -44,7 +44,7 @@ type InternalFormProps = {\n } & Omit<HTMLFormProps, 'action' | DisallowedFormProps>\n \n // `RouteInferType` is a stub here to avoid breaking `typedRoutes` when the type\n-// isn't generated yet. It will be replaced when the webpack plugin runs.\n+// isn't generated yet. It will be replaced when type generation runs.\n // eslint-disable-next-line @typescript-eslint/no-unused-vars\n export type FormProps<RouteInferType = any> = InternalFormProps\n "
        },
        {
            "sha": "f76d87914b0120aec1c4bb02493ae239354b1742",
            "filename": "packages/next/src/client/link.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fclient%2Flink.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fclient%2Flink.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Flink.tsx?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -118,7 +118,7 @@ type InternalLinkProps = {\n // adding this to the publicly exported type currently breaks existing apps\n \n // `RouteInferType` is a stub here to avoid breaking `typedRoutes` when the type\n-// isn't generated yet. It will be replaced when the webpack plugin runs.\n+// isn't generated yet. It will be replaced when type generation runs.\n // WARNING: This should be an interface to prevent TypeScript from inlining it\n // in declarations of libraries dependending on Next.js.\n // Not trivial to reproduce so only convert to an interface when needed."
        },
        {
            "sha": "78cf7add6cd862cd6678cd44654fcdfc2020b60c",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -746,6 +746,7 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n         tsconfigPath: z.string().min(1).optional(),\n       })\n       .optional(),\n+    typedRoutes: z.boolean().optional(),\n     useFileSystemPublicRoutes: z.boolean().optional(),\n     // The webpack config type is unknown, use z.any() here\n     webpack: z.any().nullable().optional(),"
        },
        {
            "sha": "5a0eccb8fa7c7f390890547a6f0a80be68ab2ea2",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 3,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -608,8 +608,9 @@ export interface ExperimentalConfig {\n       }\n \n   /**\n-   * Generate Route types and enable type checking for Link and Router.push, etc.\n-   * @see https://nextjs.org/docs/app/api-reference/next-config-js/typedRoutes\n+   * Enable type checking for Link and Router.push, etc.\n+   * @deprecated Use `typedRoutes` instead â€” this feature is now stable.\n+   * @see https://nextjs.org/docs/app/api-reference/config/typescript#statically-typed-links\n    */\n   typedRoutes?: boolean\n \n@@ -999,6 +1000,14 @@ export interface NextConfig extends Record<string, any> {\n    */\n   typescript?: TypeScriptConfig\n \n+  /**\n+   * Enable type checking for Link and Router.push, etc.\n+   * This feature requires TypeScript in your project.\n+   *\n+   * @see [Typed Links documentation](https://nextjs.org/docs/app/api-reference/config/typescript#statically-typed-links)\n+   */\n+  typedRoutes?: boolean\n+\n   /**\n    * Headers allow you to set custom HTTP headers for an incoming request path.\n    *\n@@ -1415,6 +1424,7 @@ export const defaultConfig = Object.freeze({\n     ignoreBuildErrors: false,\n     tsconfigPath: 'tsconfig.json',\n   },\n+  typedRoutes: false,\n   distDir: '.next',\n   cleanDistDir: true,\n   assetPrefix: '',\n@@ -1560,7 +1570,6 @@ export const defaultConfig = Object.freeze({\n     amp: undefined,\n     urlImports: undefined,\n     turbo: undefined,\n-    typedRoutes: false,\n     typedEnv: false,\n     clientTraceMetadata: undefined,\n     parallelServerCompiles: false,"
        },
        {
            "sha": "3ed2e3439882984f40310da31d0ccb282f184f0f",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -654,6 +654,13 @@ function assignDefaults(\n     configFileName,\n     silent\n   )\n+  warnOptionHasBeenMovedOutOfExperimental(\n+    result,\n+    'typedRoutes',\n+    'typedRoutes',\n+    configFileName,\n+    silent\n+  )\n   warnOptionHasBeenMovedOutOfExperimental(\n     result,\n     'outputFileTracingRoot',"
        },
        {
            "sha": "f2f374a14a342093cfccdd8f1aa949d0ac4334a6",
            "filename": "packages/next/src/server/lib/router-utils/route-types-utils.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Froute-types-utils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Froute-types-utils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Froute-types-utils.ts?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -348,7 +348,7 @@ export async function writeRouteTypesManifest(\n   await fs.promises.writeFile(filePath, generateRouteTypesFile(manifest))\n \n   // Write the link.d.ts file if typedRoutes is enabled\n-  if (config.experimental?.typedRoutes === true) {\n+  if (config.typedRoutes === true) {\n     const linkTypesPath = path.join(dirname, 'link.d.ts')\n     await fs.promises.writeFile(linkTypesPath, generateLinkTypesFile(manifest))\n   }"
        },
        {
            "sha": "1799a84dcee02b6a65fce58468d9bea4f7175878",
            "filename": "packages/next/src/types.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/packages%2Fnext%2Fsrc%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Ftypes.ts?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -55,7 +55,7 @@ export type { Instrumentation } from './server/instrumentation/types'\n  */\n \n // `RouteInferType` is a stub here to avoid breaking `typedRoutes` when the type\n-// isn't generated yet. It will be replaced when the webpack plugin runs.\n+// isn't generated yet. It will be replaced when type generation runs.\n // eslint-disable-next-line @typescript-eslint/no-unused-vars\n export type Route<RouteInferType = any> = string & {}\n "
        },
        {
            "sha": "d4e974530f365a2596bed5f79e85316f5f9778a1",
            "filename": "test/e2e/app-dir/typed-routes/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/test%2Fe2e%2Fapp-dir%2Ftyped-routes%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/test%2Fe2e%2Fapp-dir%2Ftyped-routes%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ftyped-routes%2Fnext.config.js?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -2,9 +2,7 @@\n  * @type {import('next').NextConfig}\n  */\n const nextConfig = {\n-  experimental: {\n-    typedRoutes: true,\n-  },\n+  typedRoutes: true,\n   async redirects() {\n     return [\n       {"
        },
        {
            "sha": "b0b1601f3ed14d3a8143dfd5b283a1f8c12cf92a",
            "filename": "test/integration/app-types/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/test%2Fintegration%2Fapp-types%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/test%2Fintegration%2Fapp-types%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fapp-types%2Fnext.config.js?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -3,9 +3,7 @@ import createMdx from '@next/mdx'\n const withMdx = createMdx()\n \n export default withMdx({\n-  experimental: {\n-    typedRoutes: true,\n-  },\n+  typedRoutes: true,\n \n   pageExtensions: ['js', 'jsx', 'ts', 'tsx', 'mdx'],\n "
        },
        {
            "sha": "df081b8d3c82e2215e9c61f18b5680de919006b0",
            "filename": "test/production/app-dir/typed-routes-with-webpack-worker/bad-routes/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/test%2Fproduction%2Fapp-dir%2Ftyped-routes-with-webpack-worker%2Fbad-routes%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/test%2Fproduction%2Fapp-dir%2Ftyped-routes-with-webpack-worker%2Fbad-routes%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Ftyped-routes-with-webpack-worker%2Fbad-routes%2Fnext.config.js?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -1,7 +1,7 @@\n /** @type {import('next').NextConfig} */\n module.exports = {\n+  typedRoutes: true,\n   experimental: {\n-    typedRoutes: true,\n     webpackBuildWorker: true,\n   },\n }"
        },
        {
            "sha": "f4ded8054d077e885a34ec07217d6d4c6cacf2e9",
            "filename": "test/production/app-dir/typed-routes-with-webpack-worker/good-routes/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c970d95136dbff4a11b8a096372a7ddfee561618/test%2Fproduction%2Fapp-dir%2Ftyped-routes-with-webpack-worker%2Fgood-routes%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/c970d95136dbff4a11b8a096372a7ddfee561618/test%2Fproduction%2Fapp-dir%2Ftyped-routes-with-webpack-worker%2Fgood-routes%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Ftyped-routes-with-webpack-worker%2Fgood-routes%2Fnext.config.js?ref=c970d95136dbff4a11b8a096372a7ddfee561618",
            "patch": "@@ -1,7 +1,7 @@\n /** @type {import('next').NextConfig} */\n module.exports = {\n+  typedRoutes: true,\n   experimental: {\n-    typedRoutes: true,\n     parallelServerBuildTraces: true,\n     webpackBuildWorker: true,\n   },"
        }
    ],
    "stats": {
        "total": 68,
        "additions": 37,
        "deletions": 31
    }
}