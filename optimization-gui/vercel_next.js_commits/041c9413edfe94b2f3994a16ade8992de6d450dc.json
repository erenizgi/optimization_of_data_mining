{
    "author": "lukesandberg",
    "message": "Require that `turbo_tasks::value_trait` items be annotated with `turbo-tasks::function` (#79178)\n\nOn its own this is just adding pure overhead.  The next step will be to make it _optional_ for a value_trait item to be a turbo-tasks function.\n\nPart of PACK-4560",
    "sha": "041c9413edfe94b2f3994a16ade8992de6d450dc",
    "files": [
        {
            "sha": "dc55fa95066e5e925581cc6cd367a508b9eabb28",
            "filename": "crates/next-api/src/route.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/crates%2Fnext-api%2Fsrc%2Froute.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/crates%2Fnext-api%2Fsrc%2Froute.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Froute.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -49,14 +49,19 @@ pub enum Route {\n \n #[turbo_tasks::value_trait]\n pub trait Endpoint {\n+    #[turbo_tasks::function]\n     fn output(self: Vc<Self>) -> Vc<EndpointOutput>;\n     // fn write_to_disk(self: Vc<Self>) -> Vc<EndpointOutputPaths>;\n+    #[turbo_tasks::function]\n     fn server_changed(self: Vc<Self>) -> Vc<Completion>;\n+    #[turbo_tasks::function]\n     fn client_changed(self: Vc<Self>) -> Vc<Completion>;\n     /// The entry modules for the modules graph.\n+    #[turbo_tasks::function]\n     fn entries(self: Vc<Self>) -> Vc<GraphEntries>;\n     /// Additional entry modules for the module graph.\n     /// This may read the module graph and return additional modules.\n+    #[turbo_tasks::function]\n     fn additional_entries(self: Vc<Self>, _graph: Vc<ModuleGraph>) -> Vc<GraphEntries> {\n         GraphEntries::empty()\n     }"
        },
        {
            "sha": "224f02fc75f80a468da64bff4056822b8bf98094",
            "filename": "turbopack/crates/turbo-tasks-env/src/lib.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-env%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-env%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-env%2Fsrc%2Flib.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -49,9 +49,11 @@ pub trait ProcessEnv {\n     // Instead we should use only `read_prefix` to read all env vars with a specific\n     // prefix.\n     /// Reads all env variables into a Map\n+    #[turbo_tasks::function]\n     fn read_all(self: Vc<Self>) -> Vc<EnvMap>;\n \n     /// Reads a single env variable. Ignores casing.\n+    #[turbo_tasks::function]\n     fn read(self: Vc<Self>, name: RcStr) -> Vc<Option<RcStr>> {\n         case_insensitive_read(self.read_all(), name)\n     }"
        },
        {
            "sha": "f08a9e2e09fc0c3dd1687ead8dd31186aefec964",
            "filename": "turbopack/crates/turbo-tasks-fs/src/lib.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -195,14 +195,21 @@ fn create_semaphore() -> tokio::sync::Semaphore {\n #[turbo_tasks::value_trait]\n pub trait FileSystem: ValueToString {\n     /// Returns the path to the root of the file system.\n+    #[turbo_tasks::function]\n     fn root(self: Vc<Self>) -> Vc<FileSystemPath> {\n         FileSystemPath::new_normalized(self, RcStr::default())\n     }\n+    #[turbo_tasks::function]\n     fn read(self: Vc<Self>, fs_path: Vc<FileSystemPath>) -> Vc<FileContent>;\n+    #[turbo_tasks::function]\n     fn read_link(self: Vc<Self>, fs_path: Vc<FileSystemPath>) -> Vc<LinkContent>;\n+    #[turbo_tasks::function]\n     fn raw_read_dir(self: Vc<Self>, fs_path: Vc<FileSystemPath>) -> Vc<RawDirectoryContent>;\n+    #[turbo_tasks::function]\n     fn write(self: Vc<Self>, fs_path: Vc<FileSystemPath>, content: Vc<FileContent>) -> Vc<()>;\n+    #[turbo_tasks::function]\n     fn write_link(self: Vc<Self>, fs_path: Vc<FileSystemPath>, target: Vc<LinkContent>) -> Vc<()>;\n+    #[turbo_tasks::function]\n     fn metadata(self: Vc<Self>, fs_path: Vc<FileSystemPath>) -> Vc<FileMeta>;\n }\n "
        },
        {
            "sha": "1522fe8676a2681c35d223e65e075691efd6096f",
            "filename": "turbopack/crates/turbo-tasks-macros-tests/tests/function/fail_attribute_invalid_args_inherent_impl.stderr",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Ffunction%2Ffail_attribute_invalid_args_inherent_impl.stderr",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Ffunction%2Ffail_attribute_invalid_args_inherent_impl.stderr",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Ffunction%2Ffail_attribute_invalid_args_inherent_impl.stderr?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -3,3 +3,17 @@ error: unexpected token, expected one of: \"fs\", \"network\", \"operation\", \"local\"\n    |\n 14 |     #[turbo_tasks::function(invalid_argument)]\n    |                             ^^^^^^^^^^^^^^^^\n+\n+warning: unused import: `Vc`\n+ --> tests/function/fail_attribute_invalid_args_inherent_impl.rs:4:31\n+  |\n+4 | use turbo_tasks::{ResolvedVc, Vc};\n+  |                               ^^\n+  |\n+  = note: `#[warn(unused_imports)]` on by default\n+\n+error[E0599]: no method named `return_contains_resolved_vc` found for struct `Vc<ExampleStruct>` in the current scope\n+  --> tests/function/fail_attribute_invalid_args_inherent_impl.rs:23:34\n+   |\n+23 |     let _ = ExampleStruct.cell().return_contains_resolved_vc();\n+   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^ method not found in `Vc<ExampleStruct>`"
        },
        {
            "sha": "17f2aaef980cfd0b1365a797791a1167d9bf5bca",
            "filename": "turbopack/crates/turbo-tasks-macros-tests/tests/value_trait/fail_missing_function_annotation.rs",
            "status": "added",
            "additions": 41,
            "deletions": 0,
            "changes": 41,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Fvalue_trait%2Ffail_missing_function_annotation.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Fvalue_trait%2Ffail_missing_function_annotation.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Fvalue_trait%2Ffail_missing_function_annotation.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -0,0 +1,41 @@\n+#![feature(arbitrary_self_types)]\n+#![feature(arbitrary_self_types_pointers)]\n+\n+use turbo_tasks::Vc;\n+\n+#[turbo_tasks::value_trait]\n+trait MyTrait {\n+    fn item(&self) -> bool;\n+\n+    #[turbo_tasks::function]\n+    fn item2(&self) -> Vc<bool>;\n+\n+    #[turbo_tasks::function(operation)]\n+    fn item3(&self) -> Vc<bool>;\n+}\n+\n+#[turbo_tasks::value]\n+struct MyStruct;\n+\n+#[turbo_tasks::value_impl]\n+impl MyTrait for MyStruct {\n+    fn item(&self) -> bool {\n+        true\n+    }\n+\n+    #[turbo_tasks::function]\n+    fn item2(&self) -> Vc<bool> {\n+        Vc::cell(true)\n+    }\n+\n+    #[turbo_tasks::function]\n+    fn item3(&self) -> Vc<bool> {\n+        Vc::cell(true)\n+    }\n+}\n+\n+fn expects_my_trait(_x: impl MyTrait) {}\n+\n+fn main() {\n+    expects_my_trait(MyStruct {});\n+}"
        },
        {
            "sha": "e4c1f682bdf02b4f4948f7f70acb7b253565e60b",
            "filename": "turbopack/crates/turbo-tasks-macros-tests/tests/value_trait/fail_missing_function_annotation.stderr",
            "status": "added",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Fvalue_trait%2Ffail_missing_function_annotation.stderr",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Fvalue_trait%2Ffail_missing_function_annotation.stderr",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Fvalue_trait%2Ffail_missing_function_annotation.stderr?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -0,0 +1,19 @@\n+error: trait items cannot be operations\n+  --> tests/value_trait/fail_missing_function_annotation.rs:13:29\n+   |\n+13 |     #[turbo_tasks::function(operation)]\n+   |                             ^^^^^^^^^\n+\n+error: #[turbo_tasks::function] attribute missing\n+ --> tests/value_trait/fail_missing_function_annotation.rs:8:5\n+  |\n+8 |     fn item(&self) -> bool;\n+  |     ^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: #[turbo_tasks::function] attribute missing\n+  --> tests/value_trait/fail_missing_function_annotation.rs:22:5\n+   |\n+22 | /     fn item(&self) -> bool {\n+23 | |         true\n+24 | |     }\n+   | |_____^"
        },
        {
            "sha": "8278cca48506c154297b5fcf68335786a5224af1",
            "filename": "turbopack/crates/turbo-tasks-macros-tests/tests/value_trait/pass_trait_items.rs",
            "status": "added",
            "additions": 43,
            "deletions": 0,
            "changes": 43,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Fvalue_trait%2Fpass_trait_items.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Fvalue_trait%2Fpass_trait_items.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-macros-tests%2Ftests%2Fvalue_trait%2Fpass_trait_items.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -0,0 +1,43 @@\n+#![feature(arbitrary_self_types)]\n+#![feature(arbitrary_self_types_pointers)]\n+\n+use turbo_tasks::Vc;\n+\n+#[turbo_tasks::value_trait]\n+trait MyTrait {\n+    #[turbo_tasks::function]\n+    fn item(&self) -> Vc<bool>;\n+\n+    #[turbo_tasks::function]\n+    fn item2(&self) -> Vc<bool>;\n+\n+    #[turbo_tasks::function]\n+    fn item3(&self) -> Vc<bool>;\n+}\n+\n+#[turbo_tasks::value]\n+struct MyStruct;\n+\n+#[turbo_tasks::value_impl]\n+impl MyTrait for MyStruct {\n+    #[turbo_tasks::function]\n+    fn item(&self) -> Vc<bool> {\n+        Vc::cell(true)\n+    }\n+\n+    #[turbo_tasks::function]\n+    fn item2(&self) -> Vc<bool> {\n+        Vc::cell(true)\n+    }\n+\n+    #[turbo_tasks::function]\n+    fn item3(&self) -> Vc<bool> {\n+        Vc::cell(true)\n+    }\n+}\n+\n+fn expects_my_trait(_x: impl MyTrait) {}\n+\n+fn main() {\n+    expects_my_trait(MyStruct {});\n+}"
        },
        {
            "sha": "e6e5edb68aca3102919a29c38beee0d3659262cc",
            "filename": "turbopack/crates/turbo-tasks-macros/src/func.rs",
            "status": "modified",
            "additions": 45,
            "deletions": 0,
            "changes": 45,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Ffunc.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Ffunc.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Ffunc.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -1195,3 +1195,48 @@ pub fn inline_inputs_identifier_filter(arg_ident: &Ident) -> bool {\n     // filter out underscore-prefixed (unused) arguments, we don't need to cache these\n     !arg_ident.to_string().starts_with('_')\n }\n+\n+/// Returns true if this attribute is a turbo_tasks attribute with the given name.\n+fn is_attribute(attr: &Attribute, name: &str) -> bool {\n+    let path = &attr.path();\n+    if path.leading_colon.is_some() {\n+        return false;\n+    }\n+    let mut iter = path.segments.iter();\n+    match iter.next() {\n+        Some(seg) if seg.arguments.is_empty() && seg.ident == \"turbo_tasks\" => match iter.next() {\n+            Some(seg) if seg.arguments.is_empty() && seg.ident == name => iter.next().is_none(),\n+            _ => false,\n+        },\n+        _ => false,\n+    }\n+}\n+\n+/// Parses a `turbo_tasks::function` attribute out of the given attributes and then returns the\n+/// remaining attributes.\n+pub fn split_function_attributes<'a>(\n+    item: &'a impl Spanned,\n+    attrs: &'a [Attribute],\n+) -> (syn::Result<FunctionArguments>, Vec<&'a Attribute>) {\n+    let (func_attrs_vec, attrs): (Vec<_>, Vec<_>) = attrs\n+        .iter()\n+        // TODO(alexkirsz) Replace this with function\n+        .partition(|attr| is_attribute(attr, \"function\"));\n+    let func_args = if let Some(func_attr) = func_attrs_vec.first() {\n+        if func_attrs_vec.len() == 1 {\n+            parse_with_optional_parens::<FunctionArguments>(func_attr)\n+        } else {\n+            Err(syn::Error::new(\n+                // Report the error on the second annotation.\n+                func_attrs_vec[1].span(),\n+                \"Only one #[turbo_tasks::function] attribute is allowed per method\",\n+            ))\n+        }\n+    } else {\n+        Err(syn::Error::new(\n+            item.span(),\n+            \"#[turbo_tasks::function] attribute missing\",\n+        ))\n+    };\n+    (func_args, attrs)\n+}"
        },
        {
            "sha": "a4742ca42db2b853c3a4ee6d87c88efa776a9264",
            "filename": "turbopack/crates/turbo-tasks-macros/src/value_impl_macro.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 51,
            "changes": 64,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Fvalue_impl_macro.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Fvalue_impl_macro.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Fvalue_impl_macro.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -2,11 +2,10 @@ use proc_macro::TokenStream;\n use proc_macro2::{Ident, TokenStream as TokenStream2};\n use quote::{ToTokens, quote};\n use syn::{\n-    Attribute, Error, Expr, ExprLit, Generics, ImplItem, ImplItemFn, ItemImpl, Lit, LitStr, Meta,\n+    Error, Expr, ExprLit, Generics, ImplItem, ImplItemFn, ItemImpl, Lit, LitStr, Meta,\n     MetaNameValue, Path, Token, Type,\n     parse::{Parse, ParseStream},\n     parse_macro_input, parse_quote,\n-    spanned::Spanned,\n };\n use turbo_tasks_macros_shared::{\n     get_inherent_impl_function_id_ident, get_inherent_impl_function_ident, get_path_ident,\n@@ -15,51 +14,9 @@ use turbo_tasks_macros_shared::{\n };\n \n use crate::func::{\n-    DefinitionContext, FunctionArguments, NativeFn, TurboFn, filter_inline_attributes,\n-    parse_with_optional_parens,\n+    DefinitionContext, NativeFn, TurboFn, filter_inline_attributes, split_function_attributes,\n };\n \n-fn is_attribute(attr: &Attribute, name: &str) -> bool {\n-    let path = &attr.path();\n-    if path.leading_colon.is_some() {\n-        return false;\n-    }\n-    let mut iter = path.segments.iter();\n-    match iter.next() {\n-        Some(seg) if seg.arguments.is_empty() && seg.ident == \"turbo_tasks\" => match iter.next() {\n-            Some(seg) if seg.arguments.is_empty() && seg.ident == name => iter.next().is_none(),\n-            _ => false,\n-        },\n-        _ => false,\n-    }\n-}\n-\n-fn split_function_attributes<'a>(\n-    item: &'a ImplItem,\n-    attrs: &'a [Attribute],\n-) -> (syn::Result<FunctionArguments>, Vec<&'a Attribute>) {\n-    let (func_attrs_vec, attrs): (Vec<_>, Vec<_>) = attrs\n-        .iter()\n-        // TODO(alexkirsz) Replace this with function\n-        .partition(|attr| is_attribute(attr, \"function\"));\n-    let func_args = if let Some(func_attr) = func_attrs_vec.first() {\n-        if func_attrs_vec.len() == 1 {\n-            parse_with_optional_parens::<FunctionArguments>(func_attr)\n-        } else {\n-            Err(syn::Error::new(\n-                func_attr.span(),\n-                \"Only one #[turbo_tasks::function] attribute is allowed per method\",\n-            ))\n-        }\n-    } else {\n-        Err(syn::Error::new(\n-            item.span(),\n-            \"#[turbo_tasks::function] attribute missing\",\n-        ))\n-    };\n-    (func_args, attrs)\n-}\n-\n struct ValueImplArguments {\n     ident: Option<LitStr>,\n }\n@@ -121,9 +78,11 @@ pub fn value_impl(args: TokenStream, input: TokenStream) -> TokenStream {\n             {\n                 let ident = &sig.ident;\n                 let (func_args, attrs) = split_function_attributes(item, attrs);\n-                let func_args = func_args\n-                    .inspect_err(|err| errors.push(err.to_compile_error()))\n-                    .unwrap_or_default();\n+                let Ok(func_args) =\n+                    func_args.inspect_err(|err| errors.push(err.to_compile_error()))\n+                else {\n+                    continue;\n+                };\n                 let local = func_args.local.is_some();\n                 let is_self_used = func_args.operation.is_some() || is_self_used(block);\n \n@@ -225,9 +184,12 @@ pub fn value_impl(args: TokenStream, input: TokenStream) -> TokenStream {\n                 let ident = &sig.ident;\n \n                 let (func_args, attrs) = split_function_attributes(item, attrs);\n-                let func_args = func_args\n-                    .inspect_err(|err| errors.push(err.to_compile_error()))\n-                    .unwrap_or_default();\n+                let Ok(func_args) =\n+                    func_args.inspect_err(|err| errors.push(err.to_compile_error()))\n+                else {\n+                    continue;\n+                };\n+\n                 let local = func_args.local.is_some();\n                 let is_self_used = func_args.operation.is_some() || is_self_used(block);\n "
        },
        {
            "sha": "589800b4ef1c51f2c88ab469f75490c6b3bc3434",
            "filename": "turbopack/crates/turbo-tasks-macros/src/value_trait_macro.rs",
            "status": "modified",
            "additions": 17,
            "deletions": 5,
            "changes": 22,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Fvalue_trait_macro.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Fvalue_trait_macro.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-macros%2Fsrc%2Fvalue_trait_macro.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -10,6 +10,7 @@ use turbo_tasks_macros_shared::{\n \n use crate::func::{\n     DefinitionContext, FunctionArguments, NativeFn, TurboFn, filter_inline_attributes,\n+    split_function_attributes,\n };\n \n pub fn value_trait(args: TokenStream, input: TokenStream) -> TokenStream {\n@@ -68,6 +69,7 @@ pub fn value_trait(args: TokenStream, input: TokenStream) -> TokenStream {\n     let mut trait_methods: Vec<TokenStream2> = Vec::new();\n     let mut native_functions = Vec::new();\n     let mut items = Vec::with_capacity(raw_items.len());\n+    let mut errors = Vec::new();\n \n     for item in raw_items.iter() {\n         let TraitItem::Fn(TraitItemFn {\n@@ -85,10 +87,18 @@ pub fn value_trait(args: TokenStream, input: TokenStream) -> TokenStream {\n         };\n \n         let ident = &sig.ident;\n+        // This effectively parses and removes the function annotation ensuring that that macro\n+        // doesn't run after us.\n+        let (func_args, attrs) = split_function_attributes(item, attrs);\n+        let Ok(func_args) = func_args.inspect_err(|err| errors.push(err.to_compile_error())) else {\n+            continue;\n+        };\n+        if let Some(span) = func_args.operation {\n+            span.unwrap()\n+                .error(\"trait items cannot be operations\")\n+                .emit();\n+        }\n \n-        // Value trait method declarations don't have `#[turbo_tasks::function]`\n-        // annotations on them, though their `impl`s do. It may make sense to require it\n-        // in the future when defining a default implementation.\n         let Some(turbo_fn) = TurboFn::new(\n             sig,\n             DefinitionContext::ValueTrait,\n@@ -114,7 +124,7 @@ pub fn value_trait(args: TokenStream, input: TokenStream) -> TokenStream {\n                 Ident::new(&format!(\"{trait_ident}_{ident}_inline\"), ident.span());\n             let (inline_signature, inline_block) =\n                 turbo_fn.inline_signature_and_block(default, is_self_used);\n-            let inline_attrs = filter_inline_attributes(&attrs[..]);\n+            let inline_attrs = filter_inline_attributes(attrs.iter().copied());\n \n             let native_function = NativeFn {\n                 function_path_string: format!(\"{trait_ident}::{ident}\"),\n@@ -183,7 +193,7 @@ pub fn value_trait(args: TokenStream, input: TokenStream) -> TokenStream {\n         items.push(TraitItem::Fn(TraitItemFn {\n             sig: turbo_fn.trait_signature(),\n             default,\n-            attrs: attrs.clone(),\n+            attrs: attrs.iter().map(|a| (*a).clone()).collect(),\n             semi_token: Default::default(),\n         }));\n     }\n@@ -258,6 +268,8 @@ pub fn value_trait(args: TokenStream, input: TokenStream) -> TokenStream {\n         )*\n \n         #value_debug_impl\n+\n+        #(#errors)*\n     };\n     expanded.into()\n }"
        },
        {
            "sha": "4ed212e1a51a684e399e5ce0422ac90f523e817e",
            "filename": "turbopack/crates/turbo-tasks-testing/tests/all_in_one.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Fall_in_one.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Fall_in_one.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Fall_in_one.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -141,7 +141,7 @@ impl MyTrait for MyStructValue {\n \n #[turbo_tasks::value_trait]\n trait MyTrait: ValueToString {\n-    // TODO #[turbo_tasks::function]\n+    #[turbo_tasks::function]\n     async fn my_trait_function(self: Vc<Self>) -> Result<Vc<RcStr>> {\n         if *self.to_string().await? != \"42\" {\n             bail!(\"my_trait_function must only be called with 42 as value\")\n@@ -150,7 +150,9 @@ trait MyTrait: ValueToString {\n         Ok(self.to_string())\n     }\n \n+    #[turbo_tasks::function]\n     fn my_trait_function2(self: Vc<Self>) -> Vc<RcStr>;\n+    #[turbo_tasks::function]\n     fn my_trait_function3(self: Vc<Self>) -> Vc<RcStr>;\n }\n \n@@ -170,6 +172,7 @@ async fn my_function(\n \n #[turbo_tasks::value_trait]\n trait Add {\n+    #[turbo_tasks::function]\n     fn add(self: Vc<Self>, other: Vc<Box<dyn Add>>) -> Vc<Self>;\n }\n "
        },
        {
            "sha": "ab3b0577c715d82be133627c9e2167c5b5418b02",
            "filename": "turbopack/crates/turbo-tasks-testing/tests/call_types.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Fcall_types.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Fcall_types.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Fcall_types.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -153,19 +153,27 @@ fn wrap_trait_value(v: Vc<Box<dyn ValueTrait>>) -> Vc<Box<dyn ValueTrait>> {\n \n #[turbo_tasks::value_trait]\n trait ValueTrait {\n+    #[turbo_tasks::function]\n     fn static_trait_method() -> Vc<u32>;\n+    #[turbo_tasks::function]\n     async fn async_static_trait_method() -> Result<Vc<u32>>;\n+    #[turbo_tasks::function]\n     fn default_static_trait_method() -> Vc<u32> {\n         Vc::cell(42)\n     }\n+    #[turbo_tasks::function]\n     async fn default_async_static_trait_method() -> Result<Vc<u32>> {\n         Ok(Vc::cell(42))\n     }\n+    #[turbo_tasks::function]\n     fn trait_method(&self) -> Vc<u32>;\n+    #[turbo_tasks::function]\n     fn async_trait_method(&self) -> Result<Vc<u32>>;\n+    #[turbo_tasks::function]\n     fn default_trait_method(self: Vc<Self>) -> Vc<u32> {\n         Vc::cell(42)\n     }\n+    #[turbo_tasks::function]\n     async fn default_async_trait_method(self: Vc<Self>) -> Result<Vc<u32>> {\n         Ok(Vc::cell(42))\n     }"
        },
        {
            "sha": "b7081174940c6c94de9bd441dcc55c477b04ca63",
            "filename": "turbopack/crates/turbo-tasks-testing/tests/filter_unused_args.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ffilter_unused_args.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ffilter_unused_args.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ffilter_unused_args.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -37,6 +37,7 @@ async fn filtered_trait_method_args() -> Result<()> {\n \n #[turbo_tasks::value_trait]\n trait ExampleTrait {\n+    #[turbo_tasks::function]\n     fn method_with_arg(&self, number: i32) -> Vc<()>;\n }\n "
        },
        {
            "sha": "e2a6a7abdfa740fc73a61ffe790d6ef1f986650e",
            "filename": "turbopack/crates/turbo-tasks-testing/tests/local_tasks.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Flocal_tasks.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Flocal_tasks.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Flocal_tasks.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -47,7 +47,9 @@ fn get_non_local_task_id() -> Vc<u32> {\n \n #[turbo_tasks::value_trait]\n trait SomeTrait {\n+    #[turbo_tasks::function]\n     fn get_local_task_id(self: Vc<Self>) -> Vc<u32>;\n+    #[turbo_tasks::function]\n     fn get_non_local_task_id(self: Vc<Self>) -> Vc<u32>;\n }\n #[turbo_tasks::value(shared)]"
        },
        {
            "sha": "948f99dd36ffe18ecc86202bc56cd04951602846",
            "filename": "turbopack/crates/turbo-tasks-testing/tests/task_statistics.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ftask_statistics.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ftask_statistics.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ftask_statistics.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -222,7 +222,9 @@ async fn wrap_vc(val: Vc<u64>) -> Result<Vc<WrappedU64>> {\n \n #[turbo_tasks::value_trait]\n pub trait Doublable {\n+    #[turbo_tasks::function]\n     fn double(&self) -> Vc<Self>;\n+    #[turbo_tasks::function]\n     fn double_vc(self: Vc<Self>) -> Vc<Self>;\n }\n "
        },
        {
            "sha": "d06727332a8072d09fbec9157c63bb604d6c0b62",
            "filename": "turbopack/crates/turbo-tasks-testing/tests/trait_ref_cell.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ftrait_ref_cell.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ftrait_ref_cell.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ftrait_ref_cell.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -79,6 +79,7 @@ impl Counter {\n \n #[turbo_tasks::value_trait]\n trait CounterTrait {\n+    #[turbo_tasks::function]\n     fn get_value(&self) -> Vc<CounterValue>;\n }\n \n@@ -94,6 +95,7 @@ impl CounterTrait for Counter {\n \n #[turbo_tasks::value_trait]\n trait CounterValueTrait {\n+    #[turbo_tasks::function]\n     fn get_value(&self) -> Vc<CounterValue>;\n }\n "
        },
        {
            "sha": "93798e60410f97b0e2a388626a90daae0dd534ea",
            "filename": "turbopack/crates/turbo-tasks-testing/tests/trait_ref_cell_mode.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ftrait_ref_cell_mode.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ftrait_ref_cell_mode.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-testing%2Ftests%2Ftrait_ref_cell_mode.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -3,7 +3,7 @@\n \n use anyhow::Result;\n use turbo_tasks::{IntoTraitRef, State, TraitRef, Upcast, Vc};\n-use turbo_tasks_testing::{register, run, Registration};\n+use turbo_tasks_testing::{Registration, register, run};\n \n static REGISTRATION: Registration = register!();\n \n@@ -79,6 +79,7 @@ async fn test_trait_ref_new_cell_mode() {\n \n #[turbo_tasks::value_trait]\n trait ValueTrait {\n+    #[turbo_tasks::function]\n     fn get_value(&self) -> Vc<usize>;\n }\n "
        },
        {
            "sha": "93e1e488de093f247486e52ba62af448ae672dca",
            "filename": "turbopack/crates/turbo-tasks/src/debug/mod.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fdebug%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fdebug%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fdebug%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -57,9 +57,11 @@ impl ValueDebugString {\n /// ```\n #[turbo_tasks::value_trait(no_debug)]\n pub trait ValueDebug {\n+    #[turbo_tasks::function]\n     fn dbg(self: Vc<Self>) -> Vc<ValueDebugString>;\n \n     /// Like `dbg`, but with a depth limit.\n+    #[turbo_tasks::function]\n     fn dbg_depth(self: Vc<Self>, depth: usize) -> Vc<ValueDebugString>;\n }\n "
        },
        {
            "sha": "2deea4f05d8014494d2a1a81f1328c212d645365",
            "filename": "turbopack/crates/turbo-tasks/src/display.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fdisplay.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fdisplay.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fdisplay.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -5,5 +5,6 @@ use crate::{self as turbo_tasks};\n \n #[turbo_tasks::value_trait]\n pub trait ValueToString {\n+    #[turbo_tasks::function]\n     fn to_string(self: Vc<Self>) -> Vc<RcStr>;\n }"
        },
        {
            "sha": "ba4d3b555128d3ed3a7ecccd7e3281434c5193ef",
            "filename": "turbopack/crates/turbo-tasks/src/task/local_task.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask%2Flocal_task.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask%2Flocal_task.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Ftask%2Flocal_task.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -220,6 +220,7 @@ pub(crate) mod tests {\n \n     #[turbo_tasks::value_trait]\n     trait MockTrait {\n+        #[turbo_tasks::function]\n         fn mock_method_task() -> Vc<()>;\n     }\n "
        },
        {
            "sha": "6fe5d17fc030cd7005f414ccf4ee935b11756388",
            "filename": "turbopack/crates/turbo-tasks/src/vc/default.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Fdefault.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Fdefault.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fvc%2Fdefault.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -13,5 +13,6 @@ use crate::{self as turbo_tasks};\n /// 2. No annotations: this will make `Vc::default()` always return a different value.\n #[turbo_tasks::value_trait]\n pub trait ValueDefault {\n+    #[turbo_tasks::function]\n     fn value_default() -> Vc<Self>;\n }"
        },
        {
            "sha": "090b8ae9652336972622a1bc433613112b876d20",
            "filename": "turbopack/crates/turbopack-core/src/asset.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fasset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fasset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fasset.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -11,9 +11,11 @@ use crate::version::{VersionedAssetContent, VersionedContent};\n #[turbo_tasks::value_trait]\n pub trait Asset {\n     /// The content of the [Asset].\n+    #[turbo_tasks::function]\n     fn content(self: Vc<Self>) -> Vc<AssetContent>;\n \n     /// The content of the [Asset] alongside its version.\n+    #[turbo_tasks::function]\n     async fn versioned_content(self: Vc<Self>) -> Result<Vc<Box<dyn VersionedContent>>> {\n         Ok(Vc::upcast(VersionedAssetContent::new(self.content())))\n     }"
        },
        {
            "sha": "31307a43c73af5420aa26de154c1638fec6a86c3",
            "filename": "turbopack/crates/turbopack-core/src/chunk/chunking_context.rs",
            "status": "modified",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fchunking_context.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -144,28 +144,36 @@ pub struct ChunkingConfigs(FxHashMap<ResolvedVc<Box<dyn ChunkType>>, ChunkingCon\n /// A context for the chunking that influences the way chunks are created\n #[turbo_tasks::value_trait]\n pub trait ChunkingContext {\n+    #[turbo_tasks::function]\n     fn name(self: Vc<Self>) -> Vc<RcStr>;\n+    #[turbo_tasks::function]\n     fn should_use_file_source_map_uris(self: Vc<Self>) -> Vc<bool>;\n     /// The root path of the project\n+    #[turbo_tasks::function]\n     fn root_path(self: Vc<Self>) -> Vc<FileSystemPath>;\n     /// The output root path in the output filesystem\n+    #[turbo_tasks::function]\n     fn output_root(self: Vc<Self>) -> Vc<FileSystemPath>;\n     /// A relative path how to reach the root path from the output root. This is used to compute\n     /// original paths at runtime relative to the output files. e. g. import.meta.url needs that.\n+    #[turbo_tasks::function]\n     fn output_root_to_root_path(self: Vc<Self>) -> Vc<RcStr>;\n \n     // TODO remove this, a chunking context should not be bound to a specific\n     // environment since this can change due to transitions in the module graph\n+    #[turbo_tasks::function]\n     fn environment(self: Vc<Self>) -> Vc<Environment>;\n \n     /// The path to the folder where all chunks are placed. This can be used to compute relative\n     /// paths.\n+    #[turbo_tasks::function]\n     fn chunk_root_path(self: Vc<Self>) -> Vc<FileSystemPath>;\n \n     // TODO(alexkirsz) Remove this from the chunking context. This should be at the\n     // discretion of chunking context implementors. However, we currently use this\n     // in a couple of places in `turbopack-css`, so we need to remove that\n     // dependency first.\n+    #[turbo_tasks::function]\n     fn chunk_path(\n         self: Vc<Self>,\n         asset: Option<Vc<Box<dyn Asset>>>,\n@@ -174,51 +182,63 @@ pub trait ChunkingContext {\n     ) -> Vc<FileSystemPath>;\n \n     /// Reference Source Map Assets for chunks\n+    #[turbo_tasks::function]\n     fn reference_chunk_source_maps(self: Vc<Self>, chunk: Vc<Box<dyn OutputAsset>>) -> Vc<bool>;\n \n     /// Include Source Maps for modules\n+    #[turbo_tasks::function]\n     fn reference_module_source_maps(self: Vc<Self>, module: Vc<Box<dyn Module>>) -> Vc<bool>;\n \n     /// Returns a URL (relative or absolute, depending on the asset prefix) to\n     /// the static asset based on its `ident`.\n+    #[turbo_tasks::function]\n     fn asset_url(self: Vc<Self>, ident: Vc<FileSystemPath>) -> Result<Vc<RcStr>>;\n \n+    #[turbo_tasks::function]\n     fn asset_path(\n         self: Vc<Self>,\n         content_hash: RcStr,\n         original_asset_ident: Vc<AssetIdent>,\n     ) -> Vc<FileSystemPath>;\n \n+    #[turbo_tasks::function]\n     fn is_hot_module_replacement_enabled(self: Vc<Self>) -> Vc<bool> {\n         Vc::cell(false)\n     }\n \n+    #[turbo_tasks::function]\n     fn chunking_configs(self: Vc<Self>) -> Vc<ChunkingConfigs> {\n         Vc::cell(Default::default())\n     }\n \n+    #[turbo_tasks::function]\n     fn batching_config(self: Vc<Self>) -> Vc<BatchingConfig> {\n         BatchingConfig::new(BatchingConfig {\n             ..Default::default()\n         })\n     }\n \n+    #[turbo_tasks::function]\n     fn is_tracing_enabled(self: Vc<Self>) -> Vc<bool> {\n         Vc::cell(false)\n     }\n \n+    #[turbo_tasks::function]\n     fn minify_type(self: Vc<Self>) -> Vc<MinifyType> {\n         MinifyType::NoMinify.cell()\n     }\n \n+    #[turbo_tasks::function]\n     fn async_loader_chunk_item(\n         &self,\n         module: Vc<Box<dyn ChunkableModule>>,\n         module_graph: Vc<ModuleGraph>,\n         availability_info: AvailabilityInfo,\n     ) -> Vc<Box<dyn ChunkItem>>;\n+    #[turbo_tasks::function]\n     fn async_loader_chunk_item_id(&self, module: Vc<Box<dyn ChunkableModule>>) -> Vc<ModuleId>;\n \n+    #[turbo_tasks::function]\n     fn chunk_group(\n         self: Vc<Self>,\n         ident: Vc<AssetIdent>,\n@@ -227,6 +247,7 @@ pub trait ChunkingContext {\n         availability_info: AvailabilityInfo,\n     ) -> Vc<ChunkGroupResult>;\n \n+    #[turbo_tasks::function]\n     fn evaluated_chunk_group(\n         self: Vc<Self>,\n         ident: Vc<AssetIdent>,\n@@ -239,6 +260,7 @@ pub trait ChunkingContext {\n     /// * loads the given extra_chunks in addition to the generated chunks; and\n     /// * evaluates the given assets; and\n     /// * exports the result of evaluating the last module as a CommonJS default export.\n+    #[turbo_tasks::function]\n     fn entry_chunk_group(\n         self: Vc<Self>,\n         path: Vc<FileSystemPath>,\n@@ -248,14 +270,17 @@ pub trait ChunkingContext {\n         availability_info: AvailabilityInfo,\n     ) -> Result<Vc<EntryChunkGroupResult>>;\n \n+    #[turbo_tasks::function]\n     async fn chunk_item_id_from_ident(\n         self: Vc<Self>,\n         ident: Vc<AssetIdent>,\n     ) -> Result<Vc<ModuleId>>;\n \n+    #[turbo_tasks::function]\n     fn chunk_item_id(self: Vc<Self>, module: Vc<Box<dyn ChunkItem>>) -> Vc<ModuleId> {\n         self.chunk_item_id_from_ident(module.asset_ident())\n     }\n+    #[turbo_tasks::function]\n     fn chunk_item_id_from_module(self: Vc<Self>, module: Vc<Box<dyn Module>>) -> Vc<ModuleId> {\n         self.chunk_item_id_from_ident(module.ident())\n     }"
        },
        {
            "sha": "ea217ce0dc839db2f64f43da2b733bbb26ca06dd",
            "filename": "turbopack/crates/turbopack-core/src/chunk/mod.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -88,6 +88,7 @@ pub struct ModuleIds(Vec<ResolvedVc<ModuleId>>);\n /// A [Module] that can be converted into a [Chunk].\n #[turbo_tasks::value_trait]\n pub trait ChunkableModule: Module + Asset {\n+    #[turbo_tasks::function]\n     fn as_chunk_item(\n         self: Vc<Self>,\n         module_graph: Vc<ModuleGraph>,\n@@ -123,17 +124,21 @@ impl Chunks {\n // TODO This could be simplified to and merged with [OutputChunk]\n #[turbo_tasks::value_trait]\n pub trait Chunk {\n+    #[turbo_tasks::function]\n     fn ident(self: Vc<Self>) -> Vc<AssetIdent>;\n+    #[turbo_tasks::function]\n     fn chunking_context(self: Vc<Self>) -> Vc<Box<dyn ChunkingContext>>;\n     // fn path(self: Vc<Self>) -> Vc<FileSystemPath> {\n     //     self.ident().path()\n     // }\n \n     /// Other [OutputAsset]s referenced from this [Chunk].\n+    #[turbo_tasks::function]\n     fn references(self: Vc<Self>) -> Vc<OutputAssets> {\n         OutputAssets::empty()\n     }\n \n+    #[turbo_tasks::function]\n     fn chunk_items(self: Vc<Self>) -> Vc<ChunkItems> {\n         ChunkItems(vec![]).cell()\n     }\n@@ -155,6 +160,7 @@ pub struct OutputChunkRuntimeInfo {\n \n #[turbo_tasks::value_trait]\n pub trait OutputChunk: Asset {\n+    #[turbo_tasks::function]\n     fn runtime_info(self: Vc<Self>) -> Vc<OutputChunkRuntimeInfo>;\n }\n \n@@ -268,6 +274,7 @@ pub struct ChunkingTypeOption(Option<ChunkingType>);\n /// specific interface is implemented.\n #[turbo_tasks::value_trait]\n pub trait ChunkableModuleReference: ModuleReference + ValueToString {\n+    #[turbo_tasks::function]\n     fn chunking_type(self: Vc<Self>) -> Vc<ChunkingTypeOption> {\n         Vc::cell(Some(ChunkingType::Parallel {\n             inherit_async: false,\n@@ -289,35 +296,43 @@ pub trait ChunkItem {\n     /// The [AssetIdent] of the [Module] that this [ChunkItem] was created from.\n     /// For most chunk types this must uniquely identify the chunk item at\n     /// runtime as it's the source of the module id used at runtime.\n+    #[turbo_tasks::function]\n     fn asset_ident(self: Vc<Self>) -> Vc<AssetIdent>;\n     /// A [AssetIdent] that uniquely identifies the content of this [ChunkItem].\n     /// It is unusally identical to [ChunkItem::asset_ident] but can be\n     /// different when the chunk item content depends on available modules e. g.\n     /// for chunk loaders.\n+    #[turbo_tasks::function]\n     fn content_ident(self: Vc<Self>) -> Vc<AssetIdent> {\n         self.asset_ident()\n     }\n     /// A [ChunkItem] can reference OutputAssets, unlike [Module]s referencing other [Module]s.\n+    #[turbo_tasks::function]\n     fn references(self: Vc<Self>) -> Vc<OutputAssets> {\n         OutputAssets::empty()\n     }\n \n     /// The type of chunk this item should be assembled into.\n+    #[turbo_tasks::function]\n     fn ty(self: Vc<Self>) -> Vc<Box<dyn ChunkType>>;\n \n     /// A temporary method to retrieve the module associated with this\n     /// ChunkItem. TODO: Remove this as part of the chunk refactoring.\n+    #[turbo_tasks::function]\n     fn module(self: Vc<Self>) -> Vc<Box<dyn Module>>;\n \n+    #[turbo_tasks::function]\n     fn chunking_context(self: Vc<Self>) -> Vc<Box<dyn ChunkingContext>>;\n }\n \n #[turbo_tasks::value_trait]\n pub trait ChunkType: ValueToString {\n     /// Whether the source (reference) order of items needs to be retained during chunking.\n+    #[turbo_tasks::function]\n     fn is_style(self: Vc<Self>) -> Vc<bool>;\n \n     /// Create a new chunk for the given chunk items\n+    #[turbo_tasks::function]\n     fn chunk(\n         &self,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,\n@@ -326,6 +341,7 @@ pub trait ChunkType: ValueToString {\n         referenced_output_assets: Vc<OutputAssets>,\n     ) -> Vc<Box<dyn Chunk>>;\n \n+    #[turbo_tasks::function]\n     fn chunk_item_size(\n         &self,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,"
        },
        {
            "sha": "4eca9047758a02f6f37025180dd2133965ec63d1",
            "filename": "turbopack/crates/turbopack-core/src/chunk/module_id_strategies.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmodule_id_strategies.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmodule_id_strategies.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fchunk%2Fmodule_id_strategies.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -11,6 +11,7 @@ use crate::{\n \n #[turbo_tasks::value_trait]\n pub trait ModuleIdStrategy {\n+    #[turbo_tasks::function]\n     fn get_module_id(self: Vc<Self>, ident: Vc<AssetIdent>) -> Vc<ModuleId>;\n }\n "
        },
        {
            "sha": "b9667016a3623ac80f83a236ba2c27cfe5b3198a",
            "filename": "turbopack/crates/turbopack-core/src/context.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fcontext.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fcontext.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fcontext.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -60,19 +60,23 @@ impl ProcessResult {\n #[turbo_tasks::value_trait]\n pub trait AssetContext {\n     /// Gets the compile time info of the asset context.\n+    #[turbo_tasks::function]\n     fn compile_time_info(self: Vc<Self>) -> Vc<CompileTimeInfo>;\n \n     /// Gets the layer of the asset context.\n+    #[turbo_tasks::function]\n     fn layer(self: Vc<Self>) -> Vc<RcStr>;\n \n     /// Gets the resolve options for a given path.\n+    #[turbo_tasks::function]\n     fn resolve_options(\n         self: Vc<Self>,\n         origin_path: Vc<FileSystemPath>,\n         reference_type: ReferenceType,\n     ) -> Vc<ResolveOptions>;\n \n     /// Resolves an request to an [ModuleResolveResult].\n+    #[turbo_tasks::function]\n     fn resolve_asset(\n         self: Vc<Self>,\n         origin_path: Vc<FileSystemPath>,\n@@ -82,21 +86,25 @@ pub trait AssetContext {\n     ) -> Vc<ModuleResolveResult>;\n \n     /// Process a source into a module.\n+    #[turbo_tasks::function]\n     fn process(\n         self: Vc<Self>,\n         asset: Vc<Box<dyn Source>>,\n         reference_type: ReferenceType,\n     ) -> Vc<ProcessResult>;\n \n     /// Process an [ResolveResult] into an [ModuleResolveResult].\n+    #[turbo_tasks::function]\n     fn process_resolve_result(\n         self: Vc<Self>,\n         result: Vc<ResolveResult>,\n         reference_type: ReferenceType,\n     ) -> Vc<ModuleResolveResult>;\n \n     /// Gets a new AssetContext with the transition applied.\n+    #[turbo_tasks::function]\n     fn with_transition(self: Vc<Self>, transition: RcStr) -> Vc<Box<dyn AssetContext>>;\n \n+    #[turbo_tasks::function]\n     fn side_effect_free_packages(self: Vc<Self>) -> Vc<Glob>;\n }"
        },
        {
            "sha": "16c1ddc505f182c58c5db4b85362a98ebf017087",
            "filename": "turbopack/crates/turbopack-core/src/diagnostics/mod.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fdiagnostics%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fdiagnostics%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fdiagnostics%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -57,12 +57,16 @@ pub trait Diagnostic {\n     /// `slow_perf_event`, or something else. This is not strongly typed\n     /// though; since consumer or implementation may need to define own\n     /// category.\n+    #[turbo_tasks::function]\n     fn category(&self) -> Vc<RcStr>;\n     /// Name of the specific diagnostic event.\n+    #[turbo_tasks::function]\n     fn name(&self) -> Vc<RcStr>;\n     /// Arbitarary payload included in the diagnostic event.\n+    #[turbo_tasks::function]\n     fn payload(&self) -> Vc<DiagnosticPayload>;\n \n+    #[turbo_tasks::function]\n     async fn into_plain(self: Vc<Self>) -> Result<Vc<PlainDiagnostic>> {\n         Ok(PlainDiagnostic {\n             category: self.category().owned().await?,"
        },
        {
            "sha": "9a0b63a12b37485bdb667ca8fbf17c4767247f92",
            "filename": "turbopack/crates/turbopack-core/src/introspect/mod.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fintrospect%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fintrospect%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fintrospect%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -13,13 +13,17 @@ pub struct IntrospectableChildren(FxIndexSet<(RcStr, VcDynIntrospectable)>);\n \n #[turbo_tasks::value_trait]\n pub trait Introspectable {\n+    #[turbo_tasks::function]\n     fn ty(self: Vc<Self>) -> Vc<RcStr>;\n+    #[turbo_tasks::function]\n     fn title(self: Vc<Self>) -> Vc<RcStr> {\n         Vc::<RcStr>::default()\n     }\n+    #[turbo_tasks::function]\n     fn details(self: Vc<Self>) -> Vc<RcStr> {\n         Vc::<RcStr>::default()\n     }\n+    #[turbo_tasks::function]\n     fn children(self: Vc<Self>) -> Vc<IntrospectableChildren> {\n         Vc::cell(FxIndexSet::default())\n     }"
        },
        {
            "sha": "172145b372ff9712d768e67451487e6e64c916d8",
            "filename": "turbopack/crates/turbopack-core/src/issue/mod.rs",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fissue%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fissue%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fissue%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -104,47 +104,55 @@ pub enum StyledString {\n pub trait Issue {\n     /// Severity allows the user to filter out unimportant issues, with Bug\n     /// being the highest priority and Info being the lowest.\n+    #[turbo_tasks::function]\n     fn severity(self: Vc<Self>) -> Vc<IssueSeverity> {\n         IssueSeverity::Error.into()\n     }\n \n     /// The file path that generated the issue, displayed to the user as message\n     /// header.\n+    #[turbo_tasks::function]\n     fn file_path(self: Vc<Self>) -> Vc<FileSystemPath>;\n \n     /// The stage of the compilation process at which the issue occurred. This\n     /// is used to sort issues.\n+    #[turbo_tasks::function]\n     fn stage(self: Vc<Self>) -> Vc<IssueStage>;\n \n     /// The issue title should be descriptive of the issue, but should be a\n     /// single line. This is displayed to the user directly under the issue\n     /// header.\n     // TODO add Vc<StyledString>\n+    #[turbo_tasks::function]\n     fn title(self: Vc<Self>) -> Vc<StyledString>;\n \n     /// A more verbose message of the issue, appropriate for providing multiline\n     /// information of the issue.\n     // TODO add Vc<StyledString>\n+    #[turbo_tasks::function]\n     fn description(self: Vc<Self>) -> Vc<OptionStyledString> {\n         Vc::cell(None)\n     }\n \n     /// Full details of the issue, appropriate for providing debug level\n     /// information. Only displayed if the user explicitly asks for detailed\n     /// messages (not to be confused with severity).\n+    #[turbo_tasks::function]\n     fn detail(self: Vc<Self>) -> Vc<OptionStyledString> {\n         Vc::cell(None)\n     }\n \n     /// A link to relevant documentation of the issue. Only displayed in console\n     /// if the user explicitly asks for detailed messages.\n+    #[turbo_tasks::function]\n     fn documentation_link(self: Vc<Self>) -> Vc<RcStr> {\n         Vc::<RcStr>::default()\n     }\n \n     /// The source location that caused the issue. Eg, for a parsing error it\n     /// should point at the offending character. Displayed to the user alongside\n     /// the title/description.\n+    #[turbo_tasks::function]\n     fn source(self: Vc<Self>) -> Vc<OptionIssueSource> {\n         Vc::cell(None)\n     }\n@@ -153,6 +161,7 @@ pub trait Issue {\n // A collectible trait that allows traces to be computed for a given module.\n #[turbo_tasks::value_trait]\n pub trait ImportTracer {\n+    #[turbo_tasks::function]\n     fn get_traces(self: Vc<Self>, path: ResolvedVc<FileSystemPath>) -> Vc<ImportTraces>;\n }\n \n@@ -191,6 +200,7 @@ impl ValueDefault for ImportTraces {\n \n #[turbo_tasks::value_trait]\n trait IssueProcessingPath {\n+    #[turbo_tasks::function]\n     fn shortest_path(\n         self: Vc<Self>,\n         issue: Vc<Box<dyn Issue>>,\n@@ -959,6 +969,7 @@ pub trait IssueReporter {\n     ///   determine which issues are new.\n     /// * `min_failing_severity` - The minimum Vc<[IssueSeverity]>\n     ///  The minimum issue severity level considered to fatally end the program.\n+    #[turbo_tasks::function]\n     fn report_issues(\n         self: Vc<Self>,\n         issues: TransientInstance<CapturedIssues>,"
        },
        {
            "sha": "164da20184c944a6287b54c91284f4cd4c17caf6",
            "filename": "turbopack/crates/turbopack-core/src/module.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -18,20 +18,24 @@ pub struct OptionStyleType(Option<StyleType>);\n pub trait Module: Asset {\n     /// The identifier of the [Module]. It's expected to be unique and capture\n     /// all properties of the [Module].\n+    #[turbo_tasks::function]\n     fn ident(&self) -> Vc<AssetIdent>;\n \n     /// Other [Module]s or [OutputAsset]s referenced from this [Module].\n     // TODO refactor to avoid returning [OutputAsset]s here\n+    #[turbo_tasks::function]\n     fn references(self: Vc<Self>) -> Vc<ModuleReferences> {\n         ModuleReferences::empty()\n     }\n \n     /// Signifies the module itself is async, e.g. it uses top-level await, is a wasm module, etc.\n+    #[turbo_tasks::function]\n     fn is_self_async(self: Vc<Self>) -> Vc<bool> {\n         Vc::cell(false)\n     }\n \n     /// The style type of the module.\n+    #[turbo_tasks::function]\n     fn style_type(self: Vc<Self>) -> Vc<OptionStyleType> {\n         Vc::cell(None)\n     }"
        },
        {
            "sha": "7b808e1335b5161acaf8c6f6fb39a88db400f183",
            "filename": "turbopack/crates/turbopack-core/src/output.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Foutput.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Foutput.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Foutput.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -13,13 +13,16 @@ pub struct OptionOutputAsset(Option<ResolvedVc<Box<dyn OutputAsset>>>);\n pub trait OutputAsset: Asset {\n     /// The identifier of the [OutputAsset]. It's expected to be unique and\n     /// capture all properties of the [OutputAsset].\n+    #[turbo_tasks::function]\n     fn path(&self) -> Vc<FileSystemPath>;\n \n     /// Other references [OutputAsset]s from this [OutputAsset].\n+    #[turbo_tasks::function]\n     fn references(self: Vc<Self>) -> Vc<OutputAssets> {\n         OutputAssets::empty()\n     }\n \n+    #[turbo_tasks::function]\n     fn size_bytes(self: Vc<Self>) -> Vc<Option<u64>> {\n         Vc::cell(None)\n     }"
        },
        {
            "sha": "3b35339e39a063545137b695e90818fb1a5a23fa",
            "filename": "turbopack/crates/turbopack-core/src/reference/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Freference%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -27,6 +27,7 @@ pub use source_map::SourceMapReference;\n /// [ChunkableModuleReference]: crate::chunk::ChunkableModuleReference\n #[turbo_tasks::value_trait]\n pub trait ModuleReference: ValueToString {\n+    #[turbo_tasks::function]\n     fn resolve_reference(self: Vc<Self>) -> Vc<ModuleResolveResult>;\n     // TODO think about different types\n     // fn kind(&self) -> Vc<AssetReferenceType>;"
        },
        {
            "sha": "824195012c167aded3a13b2089f4d807605f9a8b",
            "filename": "turbopack/crates/turbopack-core/src/resolve/options.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Foptions.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Foptions.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Foptions.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -690,7 +690,9 @@ pub async fn resolve_modules_options(\n \n #[turbo_tasks::value_trait]\n pub trait ImportMappingReplacement {\n+    #[turbo_tasks::function]\n     fn replace(self: Vc<Self>, capture: Vc<Pattern>) -> Vc<ReplacedImportMapping>;\n+    #[turbo_tasks::function]\n     fn result(\n         self: Vc<Self>,\n         lookup_path: Vc<FileSystemPath>,"
        },
        {
            "sha": "e5ae1263876b08b0cbe6e51273a6f237ce62e023",
            "filename": "turbopack/crates/turbopack-core/src/resolve/origin.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Forigin.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Forigin.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Forigin.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -16,14 +16,17 @@ pub trait ResolveOrigin {\n     /// since that might be needed to infer custom resolving options for that\n     /// specific file. But usually only the directory is relevant for the real\n     /// resolving.\n+    #[turbo_tasks::function]\n     fn origin_path(self: Vc<Self>) -> Vc<FileSystemPath>;\n \n     /// The AssetContext that carries the configuration for building that\n     /// subgraph.\n+    #[turbo_tasks::function]\n     fn asset_context(self: Vc<Self>) -> Vc<Box<dyn AssetContext>>;\n \n     /// Get an inner asset form this origin that doesn't require resolving but\n     /// is directly attached\n+    #[turbo_tasks::function]\n     fn get_inner_asset(self: Vc<Self>, request: Vc<Request>) -> Vc<OptionModule> {\n         let _ = request;\n         Vc::cell(None)"
        },
        {
            "sha": "50c6299096a3ee7138bb214031fb01555b71050c",
            "filename": "turbopack/crates/turbopack-core/src/resolve/plugin.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fplugin.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fplugin.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fplugin.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -82,8 +82,10 @@ impl BeforeResolvePluginCondition {\n \n #[turbo_tasks::value_trait]\n pub trait BeforeResolvePlugin {\n+    #[turbo_tasks::function]\n     fn before_resolve_condition(self: Vc<Self>) -> Vc<BeforeResolvePluginCondition>;\n \n+    #[turbo_tasks::function]\n     fn before_resolve(\n         self: Vc<Self>,\n         lookup_path: Vc<FileSystemPath>,\n@@ -95,11 +97,13 @@ pub trait BeforeResolvePlugin {\n #[turbo_tasks::value_trait]\n pub trait AfterResolvePlugin {\n     /// A condition which determines if the hooks gets called.\n+    #[turbo_tasks::function]\n     fn after_resolve_condition(self: Vc<Self>) -> Vc<AfterResolvePluginCondition>;\n \n     /// This hook gets called when a full filepath has been resolved and the\n     /// condition matches. If a value is returned it replaces the resolve\n     /// result.\n+    #[turbo_tasks::function]\n     fn after_resolve(\n         self: Vc<Self>,\n         fs_path: Vc<FileSystemPath>,"
        },
        {
            "sha": "2d0e8a131107bf5b220b232d861ce002a69da84a",
            "filename": "turbopack/crates/turbopack-core/src/source.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -8,6 +8,7 @@ use crate::{asset::Asset, ident::AssetIdent};\n pub trait Source: Asset {\n     /// The identifier of the [Source]. It's expected to be unique and capture\n     /// all properties of the [Source].\n+    #[turbo_tasks::function]\n     fn ident(&self) -> Vc<AssetIdent>;\n }\n "
        },
        {
            "sha": "40a4e6211af18cda21531a4aaa2be061739fdd3b",
            "filename": "turbopack/crates/turbopack-core/src/source_map/mod.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -43,9 +43,11 @@ impl OptionStringifiedSourceMap {\n #[turbo_tasks::value_trait]\n pub trait GenerateSourceMap {\n     /// Generates a usable source map, capable of both tracing and stringifying.\n+    #[turbo_tasks::function]\n     fn generate_source_map(self: Vc<Self>) -> Vc<OptionStringifiedSourceMap>;\n \n     /// Returns an individual section of the larger source map, if found.\n+    #[turbo_tasks::function]\n     fn by_section(self: Vc<Self>, _section: RcStr) -> Vc<OptionStringifiedSourceMap> {\n         Vc::cell(None)\n     }"
        },
        {
            "sha": "9c42103a3c277faad32862751acdba3b76b4443e",
            "filename": "turbopack/crates/turbopack-core/src/source_transform.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_transform.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_transform.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_transform.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -4,6 +4,7 @@ use crate::source::Source;\n \n #[turbo_tasks::value_trait]\n pub trait SourceTransform {\n+    #[turbo_tasks::function]\n     fn transform(self: Vc<Self>, source: Vc<Box<dyn Source>>) -> Vc<Box<dyn Source>>;\n }\n "
        },
        {
            "sha": "ac6983ac6db4e9e24f5d13b02ea949662745177f",
            "filename": "turbopack/crates/turbopack-core/src/version.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fversion.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fversion.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fversion.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -18,14 +18,17 @@ pub struct OptionVersionedContent(Option<ResolvedVc<Box<dyn VersionedContent>>>)\n #[turbo_tasks::value_trait]\n pub trait VersionedContent {\n     /// The content of the [Asset].\n+    #[turbo_tasks::function]\n     fn content(self: Vc<Self>) -> Vc<AssetContent>;\n \n     /// Get a [`Version`] implementor that contains enough information to\n     /// identify and diff a future [`VersionedContent`] against it.\n+    #[turbo_tasks::function]\n     fn version(self: Vc<Self>) -> Vc<Box<dyn Version>>;\n \n     /// Describes how to update the content from an earlier version to the\n     /// latest available one.\n+    #[turbo_tasks::function]\n     async fn update(self: Vc<Self>, from: Vc<Box<dyn Version>>) -> Result<Vc<Update>> {\n         // By default, since we can't make any assumptions about the versioning\n         // scheme of the content, we ask for a full invalidation, except in the\n@@ -128,6 +131,7 @@ pub trait Version {\n     /// Get a unique identifier of the version as a string. There is no way\n     /// to convert an id back to its original `Version`, so the original object\n     /// needs to be stored somewhere.\n+    #[turbo_tasks::function]\n     fn id(self: Vc<Self>) -> Vc<RcStr>;\n }\n \n@@ -138,13 +142,15 @@ pub trait Version {\n /// together.\n #[turbo_tasks::value_trait]\n pub trait MergeableVersionedContent: VersionedContent {\n+    #[turbo_tasks::function]\n     fn get_merger(self: Vc<Self>) -> Vc<Box<dyn VersionedContentMerger>>;\n }\n \n /// A [`VersionedContentMerger`] merges multiple [`VersionedContent`] into a\n /// single one.\n #[turbo_tasks::value_trait]\n pub trait VersionedContentMerger {\n+    #[turbo_tasks::function]\n     fn merge(self: Vc<Self>, contents: Vc<VersionedContents>) -> Vc<Box<dyn VersionedContent>>;\n }\n "
        },
        {
            "sha": "7757d12234885b09a1ab6df3f6f5aff34cd198f9",
            "filename": "turbopack/crates/turbopack-css/src/chunk/mod.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fchunk%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -407,6 +407,7 @@ pub struct CssChunkItemContent {\n \n #[turbo_tasks::value_trait]\n pub trait CssChunkItem: ChunkItem {\n+    #[turbo_tasks::function]\n     fn content(self: Vc<Self>) -> Vc<CssChunkItemContent>;\n }\n "
        },
        {
            "sha": "f92ff7b329eb410a4e45e28e0211f83d764f60e7",
            "filename": "turbopack/crates/turbopack-css/src/code_gen.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fcode_gen.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fcode_gen.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fcode_gen.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -19,6 +19,7 @@ pub struct CodeGeneration {\n \n #[turbo_tasks::value_trait]\n pub trait CodeGenerateable {\n+    #[turbo_tasks::function]\n     fn code_generation(\n         self: Vc<Self>,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,"
        },
        {
            "sha": "a3552ca2f5a86cbbd26935a3d7bfa409d348e6a6",
            "filename": "turbopack/crates/turbopack-css/src/embed.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fembed.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fembed.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fembed.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -3,6 +3,7 @@ use turbopack_core::{asset::Asset, chunk::ChunkingContext, module::Module, outpu\n \n #[turbo_tasks::value_trait]\n pub trait CssEmbed: Module + Asset {\n+    #[turbo_tasks::function]\n     fn embedded_asset(\n         self: Vc<Self>,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,"
        },
        {
            "sha": "6d131d07316e522096e665f61e2ccf6ae8011734",
            "filename": "turbopack/crates/turbopack-css/src/process.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fprocess.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fprocess.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fprocess.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -289,13 +289,16 @@ pub async fn finalize_css(\n \n #[turbo_tasks::value_trait]\n pub trait ParseCss {\n+    #[turbo_tasks::function]\n     async fn parse_css(self: Vc<Self>) -> Result<Vc<ParseCssResult>>;\n }\n \n #[turbo_tasks::value_trait]\n pub trait ProcessCss: ParseCss {\n+    #[turbo_tasks::function]\n     async fn get_css_with_placeholder(self: Vc<Self>) -> Result<Vc<CssWithPlaceholderResult>>;\n \n+    #[turbo_tasks::function]\n     async fn finalize_css(\n         self: Vc<Self>,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,"
        },
        {
            "sha": "45e04d3949c253cfa5a9116f7d8cac0f96e8a864",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/lazy_instantiated.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Flazy_instantiated.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Flazy_instantiated.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Flazy_instantiated.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -10,6 +10,7 @@ use super::{ContentSource, route_tree::RouteTree};\n #[turbo_tasks::value_trait]\n pub trait GetContentSource {\n     /// Returns the [ContentSource]\n+    #[turbo_tasks::function]\n     fn content_source(self: Vc<Self>) -> Vc<Box<dyn ContentSource>>;\n }\n "
        },
        {
            "sha": "f3bb0dcf03e81120eff562aa59b63994c448da8b",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/mod.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -67,11 +67,13 @@ impl Version for ProxyResult {\n pub trait GetContentSourceContent {\n     /// Specifies data requirements for the get function. Restricting data\n     /// passed allows to cache the get method.\n+    #[turbo_tasks::function]\n     fn vary(self: Vc<Self>) -> Vc<ContentSourceDataVary> {\n         ContentSourceDataVary::default().cell()\n     }\n \n     /// Get the content\n+    #[turbo_tasks::function]\n     fn get(self: Vc<Self>, path: RcStr, data: ContentSourceData) -> Vc<ContentSourceContent>;\n }\n \n@@ -102,6 +104,7 @@ pub enum ContentSourceContent {\n /// is handled.\n #[turbo_tasks::value_trait]\n pub trait ContentSourceSideEffect {\n+    #[turbo_tasks::function]\n     fn apply(self: Vc<Self>) -> Vc<Completion>;\n }\n \n@@ -417,9 +420,11 @@ impl ContentSourceDataVary {\n /// A source of content that the dev server uses to respond to http requests.\n #[turbo_tasks::value_trait]\n pub trait ContentSource {\n+    #[turbo_tasks::function]\n     fn get_routes(self: Vc<Self>) -> Vc<RouteTree>;\n \n     /// Gets any content sources wrapped in this content source.\n+    #[turbo_tasks::function]\n     fn get_children(self: Vc<Self>) -> Vc<ContentSources> {\n         ContentSources::empty()\n     }"
        },
        {
            "sha": "5fc8c497ae802ed2c284cea0cf8ac9070d996a18",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/route_tree.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Froute_tree.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Froute_tree.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Froute_tree.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -399,6 +399,7 @@ impl RouteTree {\n /// Transformation functor\n #[turbo_tasks::value_trait]\n pub trait MapGetContentSourceContent {\n+    #[turbo_tasks::function]\n     fn map_get_content(\n         self: Vc<Self>,\n         get_content: Vc<Box<dyn GetContentSourceContent>>,"
        },
        {
            "sha": "e175b246ae685939b7146c221a8ae5128ce5db40",
            "filename": "turbopack/crates/turbopack-dev-server/src/source/wrapping_source.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fwrapping_source.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fwrapping_source.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-dev-server%2Fsrc%2Fsource%2Fwrapping_source.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -16,6 +16,7 @@ use super::{\n /// [ContentSourceContent].\n #[turbo_tasks::value_trait]\n pub trait ContentSourceProcessor {\n+    #[turbo_tasks::function]\n     fn process(self: Vc<Self>, content: Vc<ContentSourceContent>) -> Vc<ContentSourceContent>;\n }\n "
        },
        {
            "sha": "ae45e2055924f7035b82a3973da97d388e1d9ec8",
            "filename": "turbopack/crates/turbopack-ecmascript/src/chunk/item.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fitem.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fitem.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fitem.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -214,7 +214,9 @@ impl EcmascriptChunkItemWithAsyncInfo {\n \n #[turbo_tasks::value_trait]\n pub trait EcmascriptChunkItem: ChunkItem {\n+    #[turbo_tasks::function]\n     fn content(self: Vc<Self>) -> Vc<EcmascriptChunkItemContent>;\n+    #[turbo_tasks::function]\n     fn content_with_async_module_info(\n         self: Vc<Self>,\n         _async_module_info: Option<Vc<AsyncModuleInfo>>,\n@@ -224,6 +226,7 @@ pub trait EcmascriptChunkItem: ChunkItem {\n \n     /// Specifies which availablility information the chunk item needs for code\n     /// generation\n+    #[turbo_tasks::function]\n     fn need_async_module_info(self: Vc<Self>) -> Vc<bool> {\n         Vc::cell(false)\n     }"
        },
        {
            "sha": "f7dbe303817c65b6a7d7c5a4dac7394e8ea30868",
            "filename": "turbopack/crates/turbopack-ecmascript/src/chunk/placeable.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fplaceable.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fplaceable.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fchunk%2Fplaceable.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -18,10 +18,13 @@ use crate::references::{\n \n #[turbo_tasks::value_trait]\n pub trait EcmascriptChunkPlaceable: ChunkableModule + Module + Asset {\n+    #[turbo_tasks::function]\n     fn get_exports(self: Vc<Self>) -> Vc<EcmascriptExports>;\n+    #[turbo_tasks::function]\n     fn get_async_module(self: Vc<Self>) -> Vc<OptionAsyncModule> {\n         Vc::cell(None)\n     }\n+    #[turbo_tasks::function]\n     fn is_marked_as_side_effect_free(\n         self: Vc<Self>,\n         side_effect_free_packages: Vc<Glob>,"
        },
        {
            "sha": "42f817e5d12cd25ca79b326e08bd097ffd510d74",
            "filename": "turbopack/crates/turbopack-ecmascript/src/lib.rs",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -294,31 +294,38 @@ impl core::fmt::Debug for EcmascriptModuleAsset {\n \n #[turbo_tasks::value_trait]\n pub trait EcmascriptParsable {\n+    #[turbo_tasks::function]\n     fn failsafe_parse(self: Vc<Self>) -> Result<Vc<ParseResult>>;\n \n+    #[turbo_tasks::function]\n     fn parse_original(self: Vc<Self>) -> Result<Vc<ParseResult>>;\n \n+    #[turbo_tasks::function]\n     fn ty(self: Vc<Self>) -> Result<Vc<EcmascriptModuleAssetType>>;\n }\n \n #[turbo_tasks::value_trait]\n pub trait EcmascriptAnalyzable: Module + Asset {\n+    #[turbo_tasks::function]\n     fn analyze(self: Vc<Self>) -> Vc<AnalyzeEcmascriptModuleResult>;\n \n     /// Generates module contents without an analysis pass. This is useful for\n     /// transforming code that is not a module, e.g. runtime code.\n+    #[turbo_tasks::function]\n     async fn module_content_without_analysis(\n         self: Vc<Self>,\n         generate_source_map: bool,\n     ) -> Result<Vc<EcmascriptModuleContent>>;\n \n+    #[turbo_tasks::function]\n     async fn module_content_options(\n         self: Vc<Self>,\n         module_graph: Vc<ModuleGraph>,\n         chunking_context: Vc<Box<dyn ChunkingContext>>,\n         async_module_info: Option<Vc<AsyncModuleInfo>>,\n     ) -> Result<Vc<EcmascriptModuleContentOptions>>;\n \n+    #[turbo_tasks::function]\n     async fn module_content(\n         self: Vc<Self>,\n         module_graph: Vc<ModuleGraph>,"
        },
        {
            "sha": "79ce37485e1849e8d5c13cac642da2806346782b",
            "filename": "turbopack/crates/turbopack-node/src/node_entry.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fnode_entry.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fnode_entry.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Fnode_entry.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -20,7 +20,10 @@ pub struct NodeRenderingEntries(Vec<ResolvedVc<NodeRenderingEntry>>);\n /// Trait that allows to get the entry module for rendering something in Node.js\n #[turbo_tasks::value_trait]\n pub trait NodeEntry {\n+    #[turbo_tasks::function]\n     fn entry(self: Vc<Self>, data: ContentSourceData) -> Vc<NodeRenderingEntry>;\n+\n+    #[turbo_tasks::function]\n     async fn entries(self: Vc<Self>) -> Result<Vc<NodeRenderingEntries>> {\n         Ok(Vc::cell(vec![\n             self.entry(Default::default()).to_resolved().await?,"
        },
        {
            "sha": "e8807097b1d96e7ed84048a64fb30b35ecef539c",
            "filename": "turbopack/crates/turbopack-node/src/route_matcher.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Froute_matcher.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Froute_matcher.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fsrc%2Froute_matcher.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -26,8 +26,10 @@ pub trait RouteMatcherRef {\n #[turbo_tasks::value_trait]\n pub trait RouteMatcher {\n     /// Returns whether the given path is a match for the route.\n+    #[turbo_tasks::function]\n     fn matches(self: Vc<Self>, path: RcStr) -> Vc<bool>;\n \n     /// Returns the parameters extracted from the given path.\n+    #[turbo_tasks::function]\n     fn params(self: Vc<Self>, path: RcStr) -> Vc<Params>;\n }"
        },
        {
            "sha": "fbdfbb3f6b570e2f59dbccbdf632ea4381e95ef9",
            "filename": "turbopack/crates/turbopack/src/module_options/custom_module_type.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fcustom_module_type.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fcustom_module_type.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Fcustom_module_type.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -5,6 +5,7 @@ use crate::ModuleAssetContext;\n \n #[turbo_tasks::value_trait]\n pub trait CustomModuleType {\n+    #[turbo_tasks::function]\n     fn create_module(\n         self: Vc<Self>,\n         source: Vc<Box<dyn Source>>,"
        },
        {
            "sha": "a6bfc46616faae8f64786b2efa93fdde3c7e9d96",
            "filename": "turbopack/crates/turbopack/src/transition/mod.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Ftransition%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/041c9413edfe94b2f3994a16ade8992de6d450dc/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Ftransition%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Ftransition%2Fmod.rs?ref=041c9413edfe94b2f3994a16ade8992de6d450dc",
            "patch": "@@ -22,11 +22,13 @@ use crate::{\n #[turbo_tasks::value_trait]\n pub trait Transition {\n     /// Apply modifications/wrapping to the source asset\n+    #[turbo_tasks::function]\n     fn process_source(self: Vc<Self>, asset: Vc<Box<dyn Source>>) -> Vc<Box<dyn Source>> {\n         asset\n     }\n \n     /// Apply modifications to the compile-time information\n+    #[turbo_tasks::function]\n     fn process_compile_time_info(\n         self: Vc<Self>,\n         compile_time_info: Vc<CompileTimeInfo>,\n@@ -35,6 +37,7 @@ pub trait Transition {\n     }\n \n     /// Apply modifications/wrapping to the module options context\n+    #[turbo_tasks::function]\n     fn process_module_options_context(\n         self: Vc<Self>,\n         module_options_context: Vc<ModuleOptionsContext>,\n@@ -43,6 +46,7 @@ pub trait Transition {\n     }\n \n     /// Apply modifications/wrapping to the resolve options context\n+    #[turbo_tasks::function]\n     fn process_resolve_options_context(\n         self: Vc<Self>,\n         resolve_options_context: Vc<ResolveOptionsContext>,\n@@ -51,6 +55,7 @@ pub trait Transition {\n     }\n \n     /// Apply modifications/wrapping to the transition options\n+    #[turbo_tasks::function]\n     fn process_transition_options(\n         self: Vc<Self>,\n         transition_options: Vc<TransitionOptions>,\n@@ -59,6 +64,7 @@ pub trait Transition {\n     }\n \n     /// Apply modifications/wrapping to the final asset\n+    #[turbo_tasks::function]\n     fn process_module(\n         self: Vc<Self>,\n         module: Vc<Box<dyn Module>>,\n@@ -68,6 +74,7 @@ pub trait Transition {\n     }\n \n     /// Apply modifications to the context\n+    #[turbo_tasks::function]\n     async fn process_context(\n         self: Vc<Self>,\n         module_asset_context: Vc<ModuleAssetContext>,\n@@ -92,6 +99,7 @@ pub trait Transition {\n     }\n \n     /// Apply modification on the processing of the asset\n+    #[turbo_tasks::function]\n     async fn process(\n         self: Vc<Self>,\n         asset: Vc<Box<dyn Source>>,"
        }
    ],
    "stats": {
        "total": 429,
        "additions": 371,
        "deletions": 58
    }
}