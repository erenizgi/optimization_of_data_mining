{
    "author": "icyJoseph",
    "message": "docs: onInvalidate router.prefetch (#81609)\n\nCloses:\n[DOC-4741](https://linear.app/vercel/issue/DOC-4741/document-oninvalidate-for-userouter-hook)",
    "sha": "1758c3c4427480274211f9dd769cec305b274f62",
    "files": [
        {
            "sha": "e06482ca2e1a0a3dd92a839844ee90ef41f003be",
            "filename": "docs/01-app/02-guides/prefetching.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1758c3c4427480274211f9dd769cec305b274f62/docs%2F01-app%2F02-guides%2Fprefetching.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/1758c3c4427480274211f9dd769cec305b274f62/docs%2F01-app%2F02-guides%2Fprefetching.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F02-guides%2Fprefetching.mdx?ref=1758c3c4427480274211f9dd769cec305b274f62",
            "patch": "@@ -152,7 +152,7 @@ function ManualPrefetchLink({\n }\n ```\n \n-`onInvalidate` is invoked when Next.js suspects cached data is stale, allowing you to refresh the prefetch.\n+[`onInvalidate`](/docs/app/api-reference/functions/use-router#userouter) is invoked when Next.js suspects cached data is stale, allowing you to refresh the prefetch.\n \n > **Good to know:** Using an `a` tag will cause a full page navigation to the destination route, you can use `onClick` to prevent the full page navigation, and then invoke `router.push` to navigate to the destination.\n "
        },
        {
            "sha": "53674a6e9d14ec109c5f2f45f4205f7a125fc489",
            "filename": "docs/01-app/03-api-reference/04-functions/use-router.mdx",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/1758c3c4427480274211f9dd769cec305b274f62/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-router.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/1758c3c4427480274211f9dd769cec305b274f62/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-router.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2Fuse-router.mdx?ref=1758c3c4427480274211f9dd769cec305b274f62",
            "patch": "@@ -44,7 +44,7 @@ export default function Page() {\n - `router.push(href: string, { scroll: boolean })`: Perform a client-side navigation to the provided route. Adds a new entry into the [browser’s history](https://developer.mozilla.org/docs/Web/API/History_API) stack.\n - `router.replace(href: string, { scroll: boolean })`: Perform a client-side navigation to the provided route without adding a new entry into the [browser’s history stack](https://developer.mozilla.org/docs/Web/API/History_API).\n - `router.refresh()`: Refresh the current route. Making a new request to the server, re-fetching data requests, and re-rendering Server Components. The client will merge the updated React Server Component payload without losing unaffected client-side React (e.g. `useState`) or browser state (e.g. scroll position).\n-- `router.prefetch(href: string)`: [Prefetch](/docs/app/getting-started/linking-and-navigating#prefetching) the provided route for faster client-side transitions.\n+- `router.prefetch(href: string, options?: { onInvalidate?: () => void })`: [Prefetch](/docs/app/getting-started/linking-and-navigating#prefetching) the provided route for faster client-side transitions. The optional `onInvalidate` callback is called when the [prefetched data becomes stale](/docs/app/guides/prefetching#extending-or-ejecting-link).\n - `router.back()`: Navigate back to the previous route in the browser’s history stack.\n - `router.forward()`: Navigate forwards to the next page in the browser’s history stack.\n \n@@ -53,6 +53,7 @@ export default function Page() {\n > - You must not send untrusted or unsanitized URLs to `router.push` or `router.replace`, as this can open your site to cross-site scripting (XSS) vulnerabilities. For example, `javascript:` URLs sent to `router.push` or `router.replace` will be executed in the context of your page.\n > - The `<Link>` component automatically prefetch routes as they become visible in the viewport.\n > - `refresh()` could re-produce the same result if fetch requests are cached. Other Dynamic APIs like `cookies` and `headers` could also change the response.\n+> - The `onInvalidate` callback is called at most once per prefetch request. It signals when you may want to trigger a new prefetch for updated route data.\n \n ### Migrating from `next/router`\n \n@@ -157,6 +158,7 @@ export default function Page() {\n \n ## Version History\n \n-| Version   | Changes                                        |\n-| --------- | ---------------------------------------------- |\n-| `v13.0.0` | `useRouter` from `next/navigation` introduced. |\n+| Version   | Changes                                                           |\n+| --------- | ----------------------------------------------------------------- |\n+| `v15.4.0` | Optional `onInvalidate` callback for `router.prefetch` introduced |\n+| `v13.0.0` | `useRouter` from `next/navigation` introduced.                    |"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 7,
        "deletions": 5
    }
}