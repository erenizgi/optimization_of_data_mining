{
    "author": "wyattjoh",
    "message": "refactor: skip the prospective render when there's a more specific route to be rendered (#78555)\n\nWhen there's a more specific route available to render, when PPR is\ndisabled but Dynamic IO is enabled, we should skip the prospective\ndiagnostic render because it would have been skipped as a part of the\nPPR render anyways.",
    "sha": "df3ef84adc335103e1435f4ea087855385c95ac2",
    "files": [
        {
            "sha": "62f492451b6f63b29d96901a95674e0775f6e1f3",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 17,
            "deletions": 4,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/df3ef84adc335103e1435f4ea087855385c95ac2/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/df3ef84adc335103e1435f4ea087855385c95ac2/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=df3ef84adc335103e1435f4ea087855385c95ac2",
            "patch": "@@ -1981,10 +1981,23 @@ export default async function build(\n                           // check that dynamic pages won't error when they\n                           // enable PPR.\n                           else if (config.experimental.dynamicIO && isDynamic) {\n-                            prospectiveRenders.set(originalAppPath, {\n-                              page,\n-                              originalAppPath,\n-                            })\n+                            // If there's a page with a more specific render\n+                            // available, then we should skip the prospective\n+                            // render because it'll be done as a part of the\n+                            // that render to validate the dynamic state.\n+                            if (\n+                              // The existence of any prerendered routes when\n+                              // PPR is disabled means that the route has more\n+                              // specific prerendered routes that should be\n+                              // used for the diagnostic render anyways.\n+                              !workerResult.prerenderedRoutes ||\n+                              workerResult.prerenderedRoutes.length === 0\n+                            ) {\n+                              prospectiveRenders.set(originalAppPath, {\n+                                page,\n+                                originalAppPath,\n+                              })\n+                            }\n                           }\n \n                           if (workerResult.prerenderedRoutes) {"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 17,
        "deletions": 4
    }
}