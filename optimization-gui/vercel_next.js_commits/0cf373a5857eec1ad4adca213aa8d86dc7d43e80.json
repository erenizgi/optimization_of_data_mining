{
    "author": "ztanner",
    "message": "add flag to opt into smooth scroll detection & add warning (#81563)\n\n**What:**\r\n`layout-router` currently forces style recalculation on every navigation by manipulating the `scroll-behavior` CSS property on the `<html>` element. This would impact most navigations, even though most don't use smooth scrolling\r\n\r\n**Why:**\r\nTo prevent smooth scrolling during router navigation (which can feel janky), Next.js temporarily resets `scroll-behavior` to `auto`, then restores the original value (#40642). While this solves the UX issue, it causes performance overhead for the vast majority of users who don't have smooth scrolling configured.\r\n\r\n**How:**\r\nThis PR introduces an optimization that checks for a `data-scroll-behavior=\"smooth\"` attribute before manipulating styles. Only users who explicitly opt into smooth scrolling will experience the style recalculation.\r\n\r\n- The existing behavior is preserved by default\r\n- Opt-in to the new behavior by setting `experimental.optimizeRouterScrolling: true` in Next.js config\r\n- When smooth-scroll is detected on the document, a development warning is logged to notify that the default behavior will be changing in an upcoming major.",
    "sha": "0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
    "files": [
        {
            "sha": "ae73ac61ee751349dcbd9e41c2390d509f631b19",
            "filename": "errors/missing-data-scroll-behavior.mdx",
            "status": "added",
            "additions": 62,
            "deletions": 0,
            "changes": 62,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/errors%2Fmissing-data-scroll-behavior.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/errors%2Fmissing-data-scroll-behavior.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fmissing-data-scroll-behavior.mdx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,62 @@\n+---\n+title: 'Missing data-scroll-behavior Attribute for Smooth Scroll'\n+---\n+\n+## Why This Warning Occurred\n+\n+Your application has smooth scrolling enabled via CSS (`scroll-behavior: smooth`), but you haven't added the `data-scroll-behavior=\"smooth\"` attribute to your `<html>` element.\n+\n+Next.js automatically attempts to detect the smooth scrolling configuration to ensure that navigating back/forward through the router doesn't also trigger the smooth scrolling behavior, as this is often not desired.\n+\n+In a future version of Next.js, this behavior will no longer be automatically detected, and you will need to add the `data-scroll-behavior` attribute to your `<html>` element to opt-in to having Next.js disable smooth scrolling during route transitions.\n+\n+## Possible Ways to Fix It\n+\n+Add `data-scroll-behavior=\"smooth\"` to your `<html>` element to prepare for the upcoming optimization:\n+\n+```html filename=\"app/layout.tsx\"\n+export default function RootLayout({ children, }: { children: React.ReactNode })\n+{ return (\n+<html lang=\"en\" data-scroll-behavior=\"smooth\">\n+  <body>\n+    {children}\n+  </body>\n+</html>\n+) }\n+```\n+\n+Or if you're using the Pages Router:\n+\n+```html filename=\"pages/_document.tsx\"\n+import { Html, Head, Main, NextScript } from 'next/document' export default\n+function Document() { return (\n+<html lang=\"en\" data-scroll-behavior=\"smooth\">\n+  <head />\n+  <body>\n+    <main />\n+    <NextScript />\n+  </body>\n+</html>\n+) }\n+```\n+\n+## Why This Optimization Matters\n+\n+Without the data attribute, Next.js must modify the `scroll-behavior` style on the `<html>` element on every navigation to ensure smooth scrolling isn't triggered. This can cause unnecessary style recalculation and impact performance.\n+\n+With the data attribute, Next.js can instantly detect smooth scrolling configuration without triggering style recalculation, resulting in faster navigation and making this behavior opt-in.\n+\n+## Enabling the Optimization Early\n+\n+You can enable this optimization early by adding the experimental flag to your `next.config.js`:\n+\n+```js filename=\"next.config.js\"\n+/** @type {import('next').NextConfig} */\n+const nextConfig = {\n+  experimental: {\n+    optimizeRouterScrolling: true,\n+  },\n+}\n+\n+module.exports = nextConfig\n+```"
        },
        {
            "sha": "cabf95fb29d0fd2ddb2cd052d47433f5a08975a6",
            "filename": "packages/next/src/build/define-env.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -339,6 +339,8 @@ export function getDefineEnv({\n     // no-op that just restarts the development server.\n     'process.env.__NEXT_BUNDLER_HAS_PERSISTENT_CACHE':\n       !isTurbopack || (config.experimental.turbopackPersistentCaching ?? false),\n+    'process.env.__NEXT_OPTIMIZE_ROUTER_SCROLL':\n+      config.experimental.optimizeRouterScrolling ?? false,\n   }\n \n   const userDefines = config.compiler?.define ?? {}"
        },
        {
            "sha": "43360ce4deed2869bd7d929129562d190b1f76b7",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -512,6 +512,7 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n             }),\n           ])\n           .optional(),\n+        optimizeRouterScrolling: z.boolean().optional(),\n       })\n       .optional(),\n     exportPathMap: z"
        },
        {
            "sha": "81f02fab95131b982d6937d6da637b70e14cd97d",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -768,6 +768,15 @@ export interface ExperimentalConfig {\n          */\n         showSourceLocation?: boolean\n       }\n+\n+  /**\n+   * When enabled, will only opt-in to special smooth scroll handling when\n+   * data-scroll-behavior=\"smooth\" is present on the <html> element.\n+   * This will be the default, non-configurable behavior in the next major version.\n+   *\n+   * @default false\n+   */\n+  optimizeRouterScrolling?: boolean\n }\n \n export type ExportPathMap = {\n@@ -1490,6 +1499,7 @@ export const defaultConfig = {\n     devtoolNewPanelUI: process.env.__NEXT_DEVTOOL_NEW_PANEL_UI === 'true',\n     devtoolSegmentExplorer: process.env.__NEXT_DEVTOOL_NEW_PANEL_UI === 'true',\n     browserDebugInfoInTerminal: false,\n+    optimizeRouterScrolling: false,\n   },\n   htmlLimitedBots: undefined,\n   bundlePagesRouterDependencies: false,"
        },
        {
            "sha": "0118822e55e914ff15e267f3657f378d58ab9d1d",
            "filename": "packages/next/src/shared/lib/router/utils/disable-smooth-scroll.ts",
            "status": "modified",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Frouter%2Futils%2Fdisable-smooth-scroll.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Frouter%2Futils%2Fdisable-smooth-scroll.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Frouter%2Futils%2Fdisable-smooth-scroll.ts?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -1,3 +1,5 @@\n+import { warnOnce } from '../../utils/warn-once'\n+\n /**\n  * Run function with `scroll-behavior: auto` applied to `<html/>`.\n  * This css change will be reverted after the function finishes.\n@@ -12,7 +14,38 @@ export function disableSmoothScrollDuringRouteTransition(\n     fn()\n     return\n   }\n+\n   const htmlElement = document.documentElement\n+  const hasDataAttribute = htmlElement.dataset.scrollBehavior === 'smooth'\n+\n+  // Since this is a breaking change, this is temporarily flagged\n+  // and will be false by default.\n+  // In the next major (v16), this will be automatically enabled\n+  if (process.env.__NEXT_OPTIMIZE_ROUTER_SCROLL) {\n+    if (!hasDataAttribute) {\n+      // No smooth scrolling configured, run directly without style manipulation\n+      fn()\n+      return\n+    }\n+  } else {\n+    // Old behavior: always manipulate styles, but warn about upcoming change\n+\n+    // Warn if smooth scrolling is detected but no data attribute is present\n+    if (\n+      process.env.NODE_ENV === 'development' &&\n+      !hasDataAttribute &&\n+      getComputedStyle(htmlElement).scrollBehavior === 'smooth'\n+    ) {\n+      warnOnce(\n+        'Detected `scroll-behavior: smooth` on the `<html>` element. In a future version, ' +\n+          'Next.js will no longer automatically disable smooth scrolling during route transitions. ' +\n+          'To prepare for this change, add `data-scroll-behavior=\"smooth\"` to your <html> element. ' +\n+          'Learn more: https://nextjs.org/docs/messages/missing-data-scroll-behavior'\n+      )\n+    }\n+  }\n+\n+  // Proceed with temporarily disabling smooth scrolling\n   const existing = htmlElement.style.scrollBehavior\n   htmlElement.style.scrollBehavior = 'auto'\n   if (!options.dontForceLayout) {"
        },
        {
            "sha": "0301f26fb19a9dc921bc687f65fa7b6f81cd9964",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy-with-data/app/global.css",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fglobal.css",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fglobal.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fglobal.css?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,9 @@\n+html {\n+  scroll-behavior: smooth;\n+}\n+\n+body {\n+  margin: 0;\n+  height: 300vh; /* Make it very scrollable */\n+  min-height: 2000px; /* Ensure minimum height for scrolling */\n+}"
        },
        {
            "sha": "997d52bec3c93d573f1116daf114c29b05d01d68",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy-with-data/app/layout.tsx",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Flayout.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,15 @@\n+import React from 'react'\n+import './global.css'\n+\n+export default function RootLayout({\n+  children,\n+}: {\n+  children: React.ReactNode\n+}) {\n+  return (\n+    <html data-scroll-behavior=\"smooth\">\n+      <head></head>\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "37e6930cc51d872cc44d58d653f1148a8177d38a",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy-with-data/app/page.tsx",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,21 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function HomePage() {\n+  return (\n+    <div>\n+      <h1>Smooth Scroll Optimization Tests</h1>\n+      <div style={{ marginBottom: '20px' }}>\n+        <Link\n+          href=\"/optimized/page1\"\n+          style={{ display: 'block', marginBottom: '10px' }}\n+        >\n+          Test Optimized Smooth Scroll (with data attribute)\n+        </Link>\n+        <Link href=\"/legacy/page1\" style={{ display: 'block' }}>\n+          Test Legacy Smooth Scroll (no data attribute)\n+        </Link>\n+      </div>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "a53ad67a6d2410009d17387f2f36c994c805f762",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy-with-data/app/page1/page.tsx",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fpage1%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fpage1%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fpage1%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,24 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function Page1() {\n+  return (\n+    <div>\n+      <h1>Legacy Page 1</h1>\n+      <p>This page has smooth scroll without data attribute optimization.</p>\n+      <Link\n+        href=\"/page2\"\n+        id=\"to-page2\"\n+        style={{ display: 'block', marginBottom: '20px' }}\n+      >\n+        Go to Page 2\n+      </Link>\n+      <div style={{ height: '150vh', backgroundColor: '#f0f0f0' }}>\n+        <p>Scroll content...</p>\n+        <div style={{ height: '1000px' }} />\n+        <p>More content...</p>\n+      </div>\n+      <p>Bottom of page 1</p>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "0f0fc3ab6686561ddd4aebf314ab30e8d4a15bc4",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy-with-data/app/page2/page.tsx",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fpage2%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fpage2%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy-with-data%2Fapp%2Fpage2%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,24 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function Page2() {\n+  return (\n+    <div>\n+      <h1>Legacy Page 2</h1>\n+      <p>This is the second page with legacy smooth scroll behavior.</p>\n+      <Link\n+        href=\"/page1\"\n+        id=\"to-page1\"\n+        style={{ display: 'block', marginBottom: '20px' }}\n+      >\n+        Go to Page 1\n+      </Link>\n+      <div style={{ height: '150vh', backgroundColor: '#e0e0e0' }}>\n+        <p>Scroll content...</p>\n+        <div style={{ height: '1000px' }} />\n+        <p>More content...</p>\n+      </div>\n+      <p>Bottom of page 2</p>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "0301f26fb19a9dc921bc687f65fa7b6f81cd9964",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy/app/global.css",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fglobal.css",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fglobal.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fglobal.css?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,9 @@\n+html {\n+  scroll-behavior: smooth;\n+}\n+\n+body {\n+  margin: 0;\n+  height: 300vh; /* Make it very scrollable */\n+  min-height: 2000px; /* Ensure minimum height for scrolling */\n+}"
        },
        {
            "sha": "156f35cc2b05380b70a2433da7b98c3159c0d8da",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy/app/layout.tsx",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Flayout.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,15 @@\n+import React from 'react'\n+import './global.css'\n+\n+export default function RootLayout({\n+  children,\n+}: {\n+  children: React.ReactNode\n+}) {\n+  return (\n+    <html>\n+      <head></head>\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "37e6930cc51d872cc44d58d653f1148a8177d38a",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy/app/page.tsx",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,21 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function HomePage() {\n+  return (\n+    <div>\n+      <h1>Smooth Scroll Optimization Tests</h1>\n+      <div style={{ marginBottom: '20px' }}>\n+        <Link\n+          href=\"/optimized/page1\"\n+          style={{ display: 'block', marginBottom: '10px' }}\n+        >\n+          Test Optimized Smooth Scroll (with data attribute)\n+        </Link>\n+        <Link href=\"/legacy/page1\" style={{ display: 'block' }}>\n+          Test Legacy Smooth Scroll (no data attribute)\n+        </Link>\n+      </div>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "a53ad67a6d2410009d17387f2f36c994c805f762",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy/app/page1/page.tsx",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fpage1%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fpage1%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fpage1%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,24 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function Page1() {\n+  return (\n+    <div>\n+      <h1>Legacy Page 1</h1>\n+      <p>This page has smooth scroll without data attribute optimization.</p>\n+      <Link\n+        href=\"/page2\"\n+        id=\"to-page2\"\n+        style={{ display: 'block', marginBottom: '20px' }}\n+      >\n+        Go to Page 2\n+      </Link>\n+      <div style={{ height: '150vh', backgroundColor: '#f0f0f0' }}>\n+        <p>Scroll content...</p>\n+        <div style={{ height: '1000px' }} />\n+        <p>More content...</p>\n+      </div>\n+      <p>Bottom of page 1</p>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "0f0fc3ab6686561ddd4aebf314ab30e8d4a15bc4",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/legacy/app/page2/page.tsx",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fpage2%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fpage2%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Flegacy%2Fapp%2Fpage2%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,24 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function Page2() {\n+  return (\n+    <div>\n+      <h1>Legacy Page 2</h1>\n+      <p>This is the second page with legacy smooth scroll behavior.</p>\n+      <Link\n+        href=\"/page1\"\n+        id=\"to-page1\"\n+        style={{ display: 'block', marginBottom: '20px' }}\n+      >\n+        Go to Page 1\n+      </Link>\n+      <div style={{ height: '150vh', backgroundColor: '#e0e0e0' }}>\n+        <p>Scroll content...</p>\n+        <div style={{ height: '1000px' }} />\n+        <p>More content...</p>\n+      </div>\n+      <p>Bottom of page 2</p>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "0301f26fb19a9dc921bc687f65fa7b6f81cd9964",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized-no-data/app/global.css",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fglobal.css",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fglobal.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fglobal.css?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,9 @@\n+html {\n+  scroll-behavior: smooth;\n+}\n+\n+body {\n+  margin: 0;\n+  height: 300vh; /* Make it very scrollable */\n+  min-height: 2000px; /* Ensure minimum height for scrolling */\n+}"
        },
        {
            "sha": "156f35cc2b05380b70a2433da7b98c3159c0d8da",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized-no-data/app/layout.tsx",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Flayout.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,15 @@\n+import React from 'react'\n+import './global.css'\n+\n+export default function RootLayout({\n+  children,\n+}: {\n+  children: React.ReactNode\n+}) {\n+  return (\n+    <html>\n+      <head></head>\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "37e6930cc51d872cc44d58d653f1148a8177d38a",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized-no-data/app/page.tsx",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,21 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function HomePage() {\n+  return (\n+    <div>\n+      <h1>Smooth Scroll Optimization Tests</h1>\n+      <div style={{ marginBottom: '20px' }}>\n+        <Link\n+          href=\"/optimized/page1\"\n+          style={{ display: 'block', marginBottom: '10px' }}\n+        >\n+          Test Optimized Smooth Scroll (with data attribute)\n+        </Link>\n+        <Link href=\"/legacy/page1\" style={{ display: 'block' }}>\n+          Test Legacy Smooth Scroll (no data attribute)\n+        </Link>\n+      </div>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "3640e3b5783d627ab48096409b5ca174861d5cc6",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized-no-data/app/page1/page.tsx",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fpage1%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fpage1%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fpage1%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,24 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function Page1() {\n+  return (\n+    <div>\n+      <h1>Optimized Page 1</h1>\n+      <p>This page has smooth scroll with data attribute optimization.</p>\n+      <Link\n+        href=\"/page2\"\n+        id=\"to-page2\"\n+        style={{ display: 'block', marginBottom: '20px' }}\n+      >\n+        Go to Page 2\n+      </Link>\n+      <div style={{ height: '150vh', backgroundColor: '#f0f0f0' }}>\n+        <p>Scroll content...</p>\n+        <div style={{ height: '1000px' }} />\n+        <p>More content...</p>\n+      </div>\n+      <p>Bottom of page 1</p>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "ba1362cf30bee10f45db67d3453479f583a09c54",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized-no-data/app/page2/page.tsx",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fpage2%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fpage2%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized-no-data%2Fapp%2Fpage2%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,24 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function Page2() {\n+  return (\n+    <div>\n+      <h1>Optimized Page 2</h1>\n+      <p>This is the second page with smooth scroll optimization.</p>\n+      <Link\n+        href=\"/page1\"\n+        id=\"to-page1\"\n+        style={{ display: 'block', marginBottom: '20px' }}\n+      >\n+        Go to Page 1\n+      </Link>\n+      <div style={{ height: '150vh', backgroundColor: '#e0e0e0' }}>\n+        <p>Scroll content...</p>\n+        <div style={{ height: '1000px' }} />\n+        <p>More content...</p>\n+      </div>\n+      <p>Bottom of page 2</p>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "0301f26fb19a9dc921bc687f65fa7b6f81cd9964",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized/app/global.css",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fglobal.css",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fglobal.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fglobal.css?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,9 @@\n+html {\n+  scroll-behavior: smooth;\n+}\n+\n+body {\n+  margin: 0;\n+  height: 300vh; /* Make it very scrollable */\n+  min-height: 2000px; /* Ensure minimum height for scrolling */\n+}"
        },
        {
            "sha": "997d52bec3c93d573f1116daf114c29b05d01d68",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized/app/layout.tsx",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Flayout.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,15 @@\n+import React from 'react'\n+import './global.css'\n+\n+export default function RootLayout({\n+  children,\n+}: {\n+  children: React.ReactNode\n+}) {\n+  return (\n+    <html data-scroll-behavior=\"smooth\">\n+      <head></head>\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "37e6930cc51d872cc44d58d653f1148a8177d38a",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized/app/page.tsx",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,21 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function HomePage() {\n+  return (\n+    <div>\n+      <h1>Smooth Scroll Optimization Tests</h1>\n+      <div style={{ marginBottom: '20px' }}>\n+        <Link\n+          href=\"/optimized/page1\"\n+          style={{ display: 'block', marginBottom: '10px' }}\n+        >\n+          Test Optimized Smooth Scroll (with data attribute)\n+        </Link>\n+        <Link href=\"/legacy/page1\" style={{ display: 'block' }}>\n+          Test Legacy Smooth Scroll (no data attribute)\n+        </Link>\n+      </div>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "3640e3b5783d627ab48096409b5ca174861d5cc6",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized/app/page1/page.tsx",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fpage1%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fpage1%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fpage1%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,24 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function Page1() {\n+  return (\n+    <div>\n+      <h1>Optimized Page 1</h1>\n+      <p>This page has smooth scroll with data attribute optimization.</p>\n+      <Link\n+        href=\"/page2\"\n+        id=\"to-page2\"\n+        style={{ display: 'block', marginBottom: '20px' }}\n+      >\n+        Go to Page 2\n+      </Link>\n+      <div style={{ height: '150vh', backgroundColor: '#f0f0f0' }}>\n+        <p>Scroll content...</p>\n+        <div style={{ height: '1000px' }} />\n+        <p>More content...</p>\n+      </div>\n+      <p>Bottom of page 1</p>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "ba1362cf30bee10f45db67d3453479f583a09c54",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/fixtures/optimized/app/page2/page.tsx",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fpage2%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fpage2%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Ffixtures%2Foptimized%2Fapp%2Fpage2%2Fpage.tsx?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,24 @@\n+import React from 'react'\n+import Link from 'next/link'\n+\n+export default function Page2() {\n+  return (\n+    <div>\n+      <h1>Optimized Page 2</h1>\n+      <p>This is the second page with smooth scroll optimization.</p>\n+      <Link\n+        href=\"/page1\"\n+        id=\"to-page1\"\n+        style={{ display: 'block', marginBottom: '20px' }}\n+      >\n+        Go to Page 1\n+      </Link>\n+      <div style={{ height: '150vh', backgroundColor: '#e0e0e0' }}>\n+        <p>Scroll content...</p>\n+        <div style={{ height: '1000px' }} />\n+        <p>More content...</p>\n+      </div>\n+      <p>Bottom of page 2</p>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "3e663f0b339c3e9bd53eca378204716994c2dbe7",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/router-disable-smooth-scroll.legacy.test.ts",
            "status": "added",
            "additions": 143,
            "deletions": 0,
            "changes": 143,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Frouter-disable-smooth-scroll.legacy.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Frouter-disable-smooth-scroll.legacy.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Frouter-disable-smooth-scroll.legacy.test.ts?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,143 @@\n+import { nextTestSetup } from 'e2e-utils'\n+import { retry } from 'next-test-utils'\n+\n+describe('router smooth scroll optimization (legacy)', () => {\n+  const { next, isNextDev } = nextTestSetup({\n+    files: __dirname + '/fixtures/legacy',\n+    nextConfig: {\n+      experimental: {\n+        optimizeRouterScrolling: false,\n+      },\n+    },\n+  })\n+\n+  const getTopScroll = async (browser: any) =>\n+    await browser.eval('document.documentElement.scrollTop')\n+\n+  const waitForScrollToComplete = async (browser: any, expectedY: number) => {\n+    await retry(async () => {\n+      const top = await getTopScroll(browser)\n+      expect(top).toBe(expectedY)\n+    })\n+  }\n+\n+  const scrollTo = async (browser: any, y: number) => {\n+    await browser.eval(`window.scrollTo(0, ${y})`)\n+    // Add a small delay for scroll to complete\n+    await browser.eval('new Promise(resolve => setTimeout(resolve, 100))')\n+    await waitForScrollToComplete(browser, y)\n+  }\n+\n+  it('should work with smooth scroll CSS and warn in development', async () => {\n+    const browser = await next.browser('/page1')\n+\n+    await scrollTo(browser, 1000)\n+    expect(await getTopScroll(browser)).toBe(1000)\n+\n+    // Wait for page to be rendered\n+    await browser.waitForElementByCss('#to-page2')\n+\n+    // Click navigation and wait for new page to load\n+    await browser.elementByCss('#to-page2').click()\n+\n+    // Wait for the new page to load completely\n+    await browser.waitForElementByCss('h1')\n+    await retry(async () => {\n+      const text = await browser.elementByCss('h1').text()\n+      expect(text).toBe('Legacy Page 2')\n+    })\n+\n+    await waitForScrollToComplete(browser, 0)\n+\n+    // In legacy mode, all smooth scroll usage should warn in dev mode\n+    await retry(async () => {\n+      const logs = await browser.log()\n+      const hasWarning = logs.some((log) =>\n+        log.message.includes(\n+          'Detected `scroll-behavior: smooth` on the `<html>` element. In a future version'\n+        )\n+      )\n+\n+      if (isNextDev) {\n+        expect(hasWarning).toBe(true)\n+      } else {\n+        expect(hasWarning).toBe(false)\n+      }\n+    })\n+  })\n+})\n+\n+describe('router smooth scroll optimization (legacy with data attribute)', () => {\n+  const { next, isNextDev: _isNextDev } = nextTestSetup({\n+    files: __dirname + '/fixtures/legacy-with-data',\n+    nextConfig: {\n+      experimental: {\n+        optimizeRouterScrolling: false,\n+      },\n+    },\n+  })\n+\n+  const getTopScroll = async (browser: any) =>\n+    await browser.eval('document.documentElement.scrollTop')\n+\n+  const waitForScrollToComplete = async (browser: any, expectedY: number) => {\n+    await retry(async () => {\n+      const top = await getTopScroll(browser)\n+      expect(top).toBe(expectedY)\n+    })\n+  }\n+\n+  const scrollTo = async (browser: any, y: number) => {\n+    await browser.eval(`window.scrollTo(0, ${y})`)\n+    // Add a small delay for scroll to complete\n+    await browser.eval('new Promise(resolve => setTimeout(resolve, 100))')\n+    await waitForScrollToComplete(browser, y)\n+  }\n+\n+  it('should not warn when data attribute is present even in legacy mode', async () => {\n+    const browser = await next.browser('/page1')\n+\n+    // Verify both CSS and data attribute are present\n+    const scrollBehavior = await browser.eval(\n+      'getComputedStyle(document.documentElement).scrollBehavior'\n+    )\n+    expect(scrollBehavior).toBe('smooth')\n+\n+    const hasDataAttribute = await browser.eval(\n+      'document.documentElement.dataset.scrollBehavior === \"smooth\"'\n+    )\n+    expect(hasDataAttribute).toBe(true)\n+\n+    await scrollTo(browser, 1000)\n+    expect(await getTopScroll(browser)).toBe(1000)\n+\n+    // Wait for page to be rendered\n+    await browser.waitForElementByCss('#to-page2')\n+\n+    // Click navigation and wait for new page to load\n+    await browser.elementByCss('#to-page2').click()\n+\n+    // Wait for the new page to load completely\n+    await browser.waitForElementByCss('h1')\n+    await retry(async () => {\n+      const text = await browser.elementByCss('h1').text()\n+      expect(text).toBe('Legacy Page 2')\n+    })\n+\n+    await waitForScrollToComplete(browser, 0)\n+\n+    // Both legacy and optimized modes respect the data attribute for warnings\n+    // The difference is in when style manipulation occurs, not when warnings appear\n+    await retry(async () => {\n+      const logs = await browser.log()\n+      const hasWarning = logs.some((log) =>\n+        log.message.includes(\n+          'Detected `scroll-behavior: smooth` on the `<html>` element. In a future version'\n+        )\n+      )\n+\n+      // No warning should appear when data attribute is present\n+      expect(hasWarning).toBe(false)\n+    })\n+  })\n+})"
        },
        {
            "sha": "e5fb1f1ceb787c3fc612dc84c6cdf646087f44a5",
            "filename": "test/e2e/app-dir/router-disable-smooth-scroll/router-disable-smooth-scroll.optimized.test.ts",
            "status": "added",
            "additions": 139,
            "deletions": 0,
            "changes": 139,
            "blob_url": "https://github.com/vercel/next.js/blob/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Frouter-disable-smooth-scroll.optimized.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0cf373a5857eec1ad4adca213aa8d86dc7d43e80/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Frouter-disable-smooth-scroll.optimized.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frouter-disable-smooth-scroll%2Frouter-disable-smooth-scroll.optimized.test.ts?ref=0cf373a5857eec1ad4adca213aa8d86dc7d43e80",
            "patch": "@@ -0,0 +1,139 @@\n+import { nextTestSetup } from 'e2e-utils'\n+import { retry } from 'next-test-utils'\n+\n+describe('router smooth scroll optimization (optimized)', () => {\n+  const { next } = nextTestSetup({\n+    files: __dirname + '/fixtures/optimized',\n+    nextConfig: {\n+      experimental: {\n+        optimizeRouterScrolling: true,\n+      },\n+    },\n+  })\n+\n+  const getTopScroll = async (browser: any) =>\n+    await browser.eval('document.documentElement.scrollTop')\n+\n+  const waitForScrollToComplete = async (browser: any, expectedY: number) => {\n+    await retry(async () => {\n+      const top = await getTopScroll(browser)\n+      expect(top).toBe(expectedY)\n+    })\n+  }\n+\n+  const scrollTo = async (browser: any, y: number) => {\n+    await browser.eval(`window.scrollTo(0, ${y})`)\n+    // Add a small delay for scroll to complete\n+    await browser.eval('new Promise(resolve => setTimeout(resolve, 100))')\n+    await waitForScrollToComplete(browser, y)\n+  }\n+\n+  it('should work with smooth scroll CSS and data attribute without warning', async () => {\n+    const browser = await next.browser('/page1')\n+\n+    await scrollTo(browser, 1000)\n+    expect(await getTopScroll(browser)).toBe(1000)\n+\n+    // Wait for page to be rendered\n+    await browser.waitForElementByCss('#to-page2')\n+\n+    // Click navigation and wait for new page to load\n+    await browser.elementByCss('#to-page2').click()\n+\n+    // Wait for the new page to load completely\n+    await browser.waitForElementByCss('h1')\n+    await retry(async () => {\n+      const text = await browser.elementByCss('h1').text()\n+      expect(text).toBe('Optimized Page 2')\n+    })\n+\n+    await waitForScrollToComplete(browser, 0)\n+\n+    // Assert no warning appears in optimized case\n+    await retry(async () => {\n+      const logs = await browser.log()\n+      expect(\n+        logs.some((log) =>\n+          log.message.includes(\n+            'Detected `scroll-behavior: smooth` on the `<html>` element. In a future version'\n+          )\n+        )\n+      ).toBe(false)\n+    })\n+  })\n+})\n+\n+describe('router smooth scroll optimization (optimized early exit)', () => {\n+  const { next } = nextTestSetup({\n+    files: __dirname + '/fixtures/optimized-no-data',\n+    nextConfig: {\n+      experimental: {\n+        optimizeRouterScrolling: true,\n+      },\n+    },\n+  })\n+\n+  const getTopScroll = async (browser: any) =>\n+    await browser.eval('document.documentElement.scrollTop')\n+\n+  const waitForScrollToComplete = async (browser: any, expectedY: number) => {\n+    await retry(async () => {\n+      const top = await getTopScroll(browser)\n+      expect(top).toBe(expectedY)\n+    })\n+  }\n+\n+  const scrollTo = async (browser: any, y: number) => {\n+    await browser.eval(`window.scrollTo(0, ${y})`)\n+    // Add a small delay for scroll to complete\n+    await browser.eval('new Promise(resolve => setTimeout(resolve, 100))')\n+    await waitForScrollToComplete(browser, y)\n+  }\n+\n+  it('should exit early when CSS smooth scroll detected but no data attribute', async () => {\n+    const browser = await next.browser('/page1')\n+\n+    // Verify CSS smooth scrolling is present\n+    const scrollBehavior = await browser.eval(\n+      'getComputedStyle(document.documentElement).scrollBehavior'\n+    )\n+    expect(scrollBehavior).toBe('smooth')\n+\n+    // Verify no data attribute\n+    const hasDataAttribute = await browser.eval(\n+      'document.documentElement.dataset.scrollBehavior === \"smooth\"'\n+    )\n+    expect(hasDataAttribute).toBe(false)\n+\n+    await scrollTo(browser, 1000)\n+    expect(await getTopScroll(browser)).toBe(1000)\n+\n+    // Wait for page to be rendered\n+    await browser.waitForElementByCss('#to-page2')\n+\n+    // Click navigation and wait for new page to load\n+    await browser.elementByCss('#to-page2').click()\n+\n+    // Wait for the new page to load completely\n+    await browser.waitForElementByCss('h1')\n+    await retry(async () => {\n+      const text = await browser.elementByCss('h1').text()\n+      expect(text).toBe('Optimized Page 2')\n+    })\n+\n+    await waitForScrollToComplete(browser, 0)\n+\n+    // No warning should appear in optimized mode even with CSS smooth scroll\n+    // because the function exits early when no data attribute is present\n+    await retry(async () => {\n+      const logs = await browser.log()\n+      expect(\n+        logs.some((log) =>\n+          log.message.includes(\n+            'Detected `scroll-behavior: smooth` on the `<html>` element. In a future version'\n+          )\n+        )\n+      ).toBe(false)\n+    })\n+  })\n+})"
        }
    ],
    "stats": {
        "total": 762,
        "additions": 762,
        "deletions": 0
    }
}