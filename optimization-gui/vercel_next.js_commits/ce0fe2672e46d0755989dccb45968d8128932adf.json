{
    "author": "wbinnssmith",
    "message": "Rename `define-env-plugin.ts` to `define-env.ts` (#79224)",
    "sha": "ce0fe2672e46d0755989dccb45968d8128932adf",
    "files": [
        {
            "sha": "14593dba7343ad499a168c3dbc3198aabf599c72",
            "filename": "packages/next/src/build/define-env.ts",
            "status": "renamed",
            "additions": 8,
            "deletions": 16,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/ce0fe2672e46d0755989dccb45968d8128932adf/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ce0fe2672e46d0755989dccb45968d8128932adf/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts?ref=ce0fe2672e46d0755989dccb45968d8128932adf",
            "patch": "@@ -1,21 +1,17 @@\n-import type {\n-  I18NDomains,\n-  NextConfigComplete,\n-} from '../../../server/config-shared'\n-import type { MiddlewareMatcher } from '../../analysis/get-page-static-info'\n-import { needsExperimentalReact } from '../../../lib/needs-experimental-react'\n-import { checkIsAppPPREnabled } from '../../../server/lib/experimental/ppr'\n+import type { I18NDomains, NextConfigComplete } from '../server/config-shared'\n+import type { MiddlewareMatcher } from './analysis/get-page-static-info'\n+import { needsExperimentalReact } from '../lib/needs-experimental-react'\n+import { checkIsAppPPREnabled } from '../server/lib/experimental/ppr'\n import {\n   getNextConfigEnv,\n   getNextPublicEnvironmentVariables,\n-} from '../../../lib/static-env'\n-import getWebpackBundler from '../../../shared/lib/get-webpack-bundler'\n+} from '../lib/static-env'\n \n type BloomFilter = ReturnType<\n-  import('../../../shared/lib/bloom-filter').BloomFilter['export']\n+  import('../shared/lib/bloom-filter').BloomFilter['export']\n >\n \n-export interface DefineEnvPluginOptions {\n+export interface DefineEnvOptions {\n   isTurbopack: boolean\n   clientRouterFilters?: {\n     staticFilter: BloomFilter\n@@ -102,7 +98,7 @@ export function getDefineEnv({\n   isNodeServer,\n   middlewareMatchers,\n   omitNonDeterministic,\n-}: DefineEnvPluginOptions): SerializedDefineEnv {\n+}: DefineEnvOptions): SerializedDefineEnv {\n   const nextPublicEnv = getNextPublicEnvironmentVariables()\n   const nextConfigEnv = getNextConfigEnv(config)\n \n@@ -320,7 +316,3 @@ export function getDefineEnv({\n \n   return serializedDefineEnv\n }\n-\n-export function getDefineEnvPlugin(options: DefineEnvPluginOptions) {\n-  return new (getWebpackBundler().DefinePlugin)(getDefineEnv(options))\n-}",
            "previous_filename": "packages/next/src/build/webpack/plugins/define-env-plugin.ts"
        },
        {
            "sha": "d26cda1464d3ebe4c5c0e7886fbfba4a1580ceae",
            "filename": "packages/next/src/build/swc/index.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/ce0fe2672e46d0755989dccb45968d8128932adf/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ce0fe2672e46d0755989dccb45968d8128932adf/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Findex.ts?ref=ce0fe2672e46d0755989dccb45968d8128932adf",
            "patch": "@@ -16,10 +16,7 @@ import type {\n   TurbopackRuleConfigItemOrShortcut,\n } from '../../server/config-shared'\n import { isDeepStrictEqual } from 'util'\n-import {\n-  type DefineEnvPluginOptions,\n-  getDefineEnv,\n-} from '../webpack/plugins/define-env-plugin'\n+import { type DefineEnvOptions, getDefineEnv } from '../define-env'\n import { getReactCompilerLoader } from '../get-babel-loader-config'\n import type {\n   NapiPartialProjectOptions,\n@@ -393,7 +390,7 @@ export function createDefineEnv({\n   hasRewrites,\n   middlewareMatchers,\n }: Omit<\n-  DefineEnvPluginOptions,\n+  DefineEnvOptions,\n   'isClient' | 'isNodeOrEdgeCompilation' | 'isEdgeServer' | 'isNodeServer'\n >): DefineEnv {\n   let defineEnv: DefineEnv = {"
        },
        {
            "sha": "4e1a667b4c58d935d9a2cc95c6efe4232e90c723",
            "filename": "packages/next/src/build/webpack-config.ts",
            "status": "modified",
            "additions": 18,
            "deletions": 15,
            "changes": 33,
            "blob_url": "https://github.com/vercel/next.js/blob/ce0fe2672e46d0755989dccb45968d8128932adf/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ce0fe2672e46d0755989dccb45968d8128932adf/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts?ref=ce0fe2672e46d0755989dccb45968d8128932adf",
            "patch": "@@ -5,6 +5,7 @@ import crypto from 'crypto'\n import { webpack } from 'next/dist/compiled/webpack/webpack'\n import path from 'path'\n \n+import { getDefineEnv } from './define-env'\n import { escapeStringRegexp } from '../shared/lib/escape-regexp'\n import { WEBPACK_LAYERS, WEBPACK_RESOURCE_QUERIES } from '../lib/constants'\n import type { WebpackLayerName } from '../lib/constants'\n@@ -68,7 +69,6 @@ import { getSupportedBrowsers } from './utils'\n import { MemoryWithGcCachePlugin } from './webpack/plugins/memory-with-gc-cache-plugin'\n import { getBabelConfigFile } from './get-babel-config-file'\n import { needsExperimentalReact } from '../lib/needs-experimental-react'\n-import { getDefineEnvPlugin } from './webpack/plugins/define-env-plugin'\n import type { SWCLoaderOptions } from './webpack/loaders/next-swc-loader'\n import { isResourceInPackages, makeExternalHandler } from './handle-externals'\n import {\n@@ -1925,20 +1925,23 @@ export default async function getBaseWebpackConfig(\n           // Avoid process being overridden when in web run time\n           ...(isClient && { process: [require.resolve('process')] }),\n         }),\n-      getDefineEnvPlugin({\n-        isTurbopack: false,\n-        config,\n-        dev,\n-        distDir,\n-        fetchCacheKeyPrefix,\n-        hasRewrites,\n-        isClient,\n-        isEdgeServer,\n-        isNodeOrEdgeCompilation,\n-        isNodeServer,\n-        middlewareMatchers,\n-        omitNonDeterministic: isCompileMode,\n-      }),\n+\n+      new (getWebpackBundler().DefinePlugin)(\n+        getDefineEnv({\n+          isTurbopack: false,\n+          config,\n+          dev,\n+          distDir,\n+          fetchCacheKeyPrefix,\n+          hasRewrites,\n+          isClient,\n+          isEdgeServer,\n+          isNodeOrEdgeCompilation,\n+          isNodeServer,\n+          middlewareMatchers,\n+          omitNonDeterministic: isCompileMode,\n+        })\n+      ),\n       isClient &&\n         new ReactLoadablePlugin({\n           filename: REACT_LOADABLE_MANIFEST,"
        },
        {
            "sha": "3cf975e3bcc0b71967bc076e8df25e0cff0a3a89",
            "filename": "packages/next/src/server/lib/router-utils/setup-dev-bundler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/ce0fe2672e46d0755989dccb45968d8128932adf/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ce0fe2672e46d0755989dccb45968d8128932adf/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts?ref=ce0fe2672e46d0755989dccb45968d8128932adf",
            "patch": "@@ -31,7 +31,6 @@ import {\n   EVENT_BUILD_FEATURE_USAGE,\n   eventCliSession,\n } from '../../../telemetry/events'\n-import { getDefineEnv } from '../../../build/webpack/plugins/define-env-plugin'\n import { getSortedRoutes } from '../../../shared/lib/router/utils'\n import {\n   getStaticInfoIncludingLayouts,\n@@ -83,6 +82,7 @@ import {\n   ModuleBuildError,\n   TurbopackInternalError,\n } from '../../../shared/lib/turbopack/utils'\n+import { getDefineEnv } from '../../../build/define-env'\n \n export type SetupOpts = {\n   renderServer: LazyRenderServerInstance"
        }
    ],
    "stats": {
        "total": 66,
        "additions": 29,
        "deletions": 37
    }
}