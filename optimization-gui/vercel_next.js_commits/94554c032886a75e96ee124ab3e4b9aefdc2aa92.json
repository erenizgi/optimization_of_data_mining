{
    "author": "bgw",
    "message": "Turbopack: Use `RawValue` for `mappings` inside `SourceMapJson` (#84208)\n\nNormally `serde_json` has to handle JSON string escaping, which has some overhead. With `Box<RawValue>` it can just memcpy the raw string instead. More ideally we'd use `&RawValue`, but we'd need a `str` instead of a `Rope` to do that.\n\nhttps://docs.rs/serde_json/latest/serde_json/value/struct.RawValue.html\n\nThis works because we don't care about the value of `mappings` here, we just want to make sure it's passed through when the struct is re-serialized.\n\nWe use `RawValue` a lot in the `swc-sourcemap` crate: https://github.com/swc-project/swc-sourcemap/blob/main/src/lazy/mod.rs",
    "sha": "94554c032886a75e96ee124ab3e4b9aefdc2aa92",
    "files": [
        {
            "sha": "eea8b4c6d5edd921f3365d58c6737f3e40264bdc",
            "filename": "turbopack/crates/turbopack-core/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/94554c032886a75e96ee124ab3e4b9aefdc2aa92/turbopack%2Fcrates%2Fturbopack-core%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/94554c032886a75e96ee124ab3e4b9aefdc2aa92/turbopack%2Fcrates%2Fturbopack-core%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2FCargo.toml?ref=94554c032886a75e96ee124ab3e4b9aefdc2aa92",
            "patch": "@@ -30,7 +30,7 @@ rustc-hash = { workspace = true }\n regex = { workspace = true }\n serde = { workspace = true, features = [\"rc\"] }\n serde_bytes = { workspace = true }\n-serde_json = { workspace = true, features = [\"preserve_order\"] }\n+serde_json = { workspace = true, features = [\"preserve_order\", \"raw_value\"] }\n smallvec = { workspace = true }\n swc_sourcemap = { workspace = true }\n swc_core = { workspace = true, features = [\"ecma_preset_env\", \"common\"] }"
        },
        {
            "sha": "40e0b4fdea8b45a4e58e0dea4b6b9bd22d3ba0bc",
            "filename": "turbopack/crates/turbopack-core/src/source_map/utils.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/94554c032886a75e96ee124ab3e4b9aefdc2aa92/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Futils.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/94554c032886a75e96ee124ab3e4b9aefdc2aa92/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Futils.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fsource_map%2Futils.rs?ref=94554c032886a75e96ee124ab3e4b9aefdc2aa92",
            "patch": "@@ -60,7 +60,10 @@ struct SourceMapJson {\n     sources_content: Option<Vec<Option<String>>>,\n     #[serde(skip_serializing_if = \"Option::is_none\")]\n     names: Option<Vec<String>>,\n-    mappings: String,\n+    // We just need to hold onto `mappings` for serialization/deserialization, so there's no point\n+    // in decoding/encoding the string. Store it as a `RawValue`. Ideally this would be a reference\n+    // to the RawValue, but we deserialize using `from_reader`, which does not support that.\n+    mappings: Box<serde_json::value::RawValue>,\n     #[serde(skip_serializing_if = \"Option::is_none\")]\n     ignore_list: Option<Vec<u32>>,\n "
        }
    ],
    "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
    }
}