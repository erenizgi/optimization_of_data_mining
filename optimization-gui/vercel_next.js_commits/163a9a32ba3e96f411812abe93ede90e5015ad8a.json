{
    "author": "bgw",
    "message": "fix(CI): Wait for lock when running apt-get (#78979)\n\nSometimes this step can fail because something else has the lock (I'm\nnot sure what, as I thought these things run in isolated containers),\nbut we can mitigate this by waiting for the lock up to 60 seconds.\n\n![Screenshot 2025-05-08 at\n9.33.10â€¯PM.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/HAZVitxRNnZz8QMiPn4a/f12de549-6cf0-48f0-959f-cf7595994e15.png)\n\nWe also call `apt` instead of `apt-get` in some of our CI scripts, but\nuse of `apt` in scripts is discouraged as the CLI interface is unstable.\n`apt` does automatically wait for the lock, so those places don't have\nthis problem.\n\nMore details here:\nhttps://blog.sinjakli.co.uk/2021/10/25/waiting-for-apt-locks-without-the-hacky-bash-scripts/",
    "sha": "163a9a32ba3e96f411812abe93ede90e5015ad8a",
    "files": [
        {
            "sha": "f766dc3bea3c1367b4277aa023e8cf145b603c9d",
            "filename": ".github/actions/setup-rust/action.yml",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/163a9a32ba3e96f411812abe93ede90e5015ad8a/.github%2Factions%2Fsetup-rust%2Faction.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/163a9a32ba3e96f411812abe93ede90e5015ad8a/.github%2Factions%2Fsetup-rust%2Faction.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Factions%2Fsetup-rust%2Faction.yml?ref=163a9a32ba3e96f411812abe93ede90e5015ad8a",
            "patch": "@@ -19,7 +19,9 @@ runs:\n     - name: 'Install LLD (LLVM Linker) for Linux'\n       if: runner.os == 'Linux'\n       shell: bash\n-      run: sudo apt-get -y update && sudo apt-get install -y lld\n+      run: |\n+        sudo apt-get -y -o DPkg::Lock::Timeout=60 update\n+        sudo apt-get -o DPkg::Lock::Timeout=60 -y install lld\n \n     - name: 'Add cargo problem matchers'\n       shell: bash"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 3,
        "deletions": 1
    }
}