{
    "author": "devjiwonchoi",
    "message": "[next-dev] Set `TURBOPACK` env before loading config (#82162)\n\n### Why?\n\nIn `next dev`, `process.env.TURBOPACK` was set after `loadConfig`, which\ncaused the `process.env.TURBOPACK` conditions within the initial\n`loadConfig` calls to be skipped unexpectedly.",
    "sha": "0899283aee33271d9b1c9cf3c6c212922030100f",
    "files": [
        {
            "sha": "442e1ed5fa36dd9bdf9e725b7a7d6ce3f28ecb32",
            "filename": "packages/next/src/cli/next-dev.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/0899283aee33271d9b1c9cf3c6c212922030100f/packages%2Fnext%2Fsrc%2Fcli%2Fnext-dev.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0899283aee33271d9b1c9cf3c6c212922030100f/packages%2Fnext%2Fsrc%2Fcli%2Fnext-dev.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcli%2Fnext-dev.ts?ref=0899283aee33271d9b1c9cf3c6c212922030100f",
            "patch": "@@ -161,6 +161,15 @@ const nextDev = async (\n   portSource: PortSource,\n   directory?: string\n ) => {\n+  const isTurbopack = Boolean(\n+    options.turbo || options.turbopack || process.env.IS_TURBOPACK_TEST\n+  )\n+  if (isTurbopack) {\n+    process.env.TURBOPACK = '1'\n+  }\n+\n+  isTurboSession = isTurbopack\n+\n   dir = getProjectDir(process.env.NEXT_PRIVATE_DEV_DIR || directory)\n \n   // Check if pages dir exists and warn if not\n@@ -238,15 +247,6 @@ const nextDev = async (\n     hostname: host,\n   }\n \n-  const isTurbopack = Boolean(\n-    options.turbo || options.turbopack || process.env.IS_TURBOPACK_TEST\n-  )\n-  if (isTurbopack) {\n-    process.env.TURBOPACK = '1'\n-  }\n-\n-  isTurboSession = isTurbopack\n-\n   const distDir = path.join(dir, config.distDir ?? '.next')\n   setGlobal('phase', PHASE_DEVELOPMENT_SERVER)\n   setGlobal('distDir', distDir)"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 9,
        "deletions": 9
    }
}