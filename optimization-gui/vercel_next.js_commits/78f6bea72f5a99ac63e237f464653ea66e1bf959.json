{
    "author": "sokra",
    "message": "Revert \"[turbopack] Model `||`, `&&`, and `??` as control flow operators (#85837)\" (#86432)\n\nThis reverts commit 23b741a97c963b9ee76a74366c451b9a5228facc.\n\n<!-- Thanks for opening a PR! Your contribution is much appreciated.\nTo make sure your PR is handled as smoothly as possible we request that you follow the checklist sections below.\nChoose the right checklist for the change(s) that you're making:\n\n## For Contributors\n\n### Improving Documentation\n\n- Run `pnpm prettier-fix` to fix formatting issues before opening the PR.\n- Read the Docs Contribution Guide to ensure your contribution follows the docs guidelines: https://nextjs.org/docs/community/contribution-guide\n\n### Fixing a bug\n\n- Related issues linked using `fixes #number`\n- Tests added. See: https://github.com/vercel/next.js/blob/canary/contributing/core/testing.md#writing-tests-for-nextjs\n- Errors have a helpful link attached, see https://github.com/vercel/next.js/blob/canary/contributing.md\n\n### Adding a feature\n\n- Implements an existing feature request or RFC. Make sure the feature request has been accepted for implementation before opening a PR. (A discussion must be opened, see https://github.com/vercel/next.js/discussions/new?category=ideas)\n- Related issues/discussions are linked using `fixes #number`\n- e2e tests added (https://github.com/vercel/next.js/blob/canary/contributing/core/testing.md#writing-tests-for-nextjs)\n- Documentation added\n- Telemetry added. In case of a feature if it's used or not.\n- Errors have a helpful link attached, see https://github.com/vercel/next.js/blob/canary/contributing.md\n\n\n## For Maintainers\n\n- Minimal description (aim for explaining to someone not on the team to understand the PR)\n- When linking to a Slack thread, you might want to share details of the conclusion\n- Link both the Linear (Fixes NEXT-xxx) and the GitHub issues\n- Add review comments if necessary to explain to the reviewer the logic behind a change\n\n### What?\n\n### Why?\n\n### How?\n\nCloses NEXT-\nFixes #\n\n-->",
    "sha": "78f6bea72f5a99ac63e237f464653ea66e1bf959",
    "files": [
        {
            "sha": "4e90d3720506079de87b0d64ab41d6b850f83868",
            "filename": "turbopack/crates/turbopack-ecmascript/benches/analyzer.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fbenches%2Fanalyzer.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fbenches%2Fanalyzer.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fbenches%2Fanalyzer.rs?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -41,12 +41,9 @@ pub fn benchmark(c: &mut Criterion) {\n     for result in results {\n         let entry = result.unwrap();\n         if entry.file_type().unwrap().is_dir() {\n-            let input = entry.path().join(\"input.js\");\n-            if !input.exists() {\n-                eprintln!(\"Missing file: {input:?} skipping\");\n-                continue;\n-            }\n             let name = entry.file_name().into_string().unwrap();\n+            let input = entry.path().join(\"input.js\");\n+\n             let cm = Arc::new(SourceMap::new(FilePathMapping::empty()));\n             let fm = cm.load_file(&input).unwrap();\n             GLOBALS.set(&swc_core::common::Globals::new(), || {"
        },
        {
            "sha": "275cd5610f5c2e939ebef3d7b062f183de20af6b",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/graph.rs",
            "status": "modified",
            "additions": 45,
            "deletions": 101,
            "changes": 146,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fgraph.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fgraph.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fgraph.rs?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -45,11 +45,6 @@ impl EffectsBlock {\n     pub fn is_empty(&self) -> bool {\n         self.effects.is_empty()\n     }\n-    fn normalize(&mut self) {\n-        for e in self.effects.iter_mut() {\n-            e.normalize();\n-        }\n-    }\n }\n \n #[derive(Debug)]\n@@ -75,52 +70,47 @@ pub enum ConditionalKind {\n         r#else: Box<EffectsBlock>,\n     },\n     /// The expression on the right side of the `&&` operator.\n-    And { rhs_effects: Vec<Effect> },\n+    And { expr: Box<EffectsBlock> },\n     /// The expression on the right side of the `||` operator.\n-    Or { rhs_effects: Vec<Effect> },\n+    Or { expr: Box<EffectsBlock> },\n     /// The expression on the right side of the `??` operator.\n-    NullishCoalescing { rhs_effects: Vec<Effect> },\n+    NullishCoalescing { expr: Box<EffectsBlock> },\n     /// The expression on the right side of a labeled statement.\n     Labeled { body: Box<EffectsBlock> },\n }\n \n impl ConditionalKind {\n-    fn is_empty(&self) -> bool {\n-        match self {\n-            ConditionalKind::If { then: block }\n-            | ConditionalKind::Else { r#else: block }\n-            | ConditionalKind::Labeled { body: block } => block.effects.is_empty(),\n-            ConditionalKind::IfElse { then, r#else, .. }\n-            | ConditionalKind::Ternary { then, r#else, .. } => then.is_empty() && r#else.is_empty(),\n-            ConditionalKind::And { rhs_effects, .. }\n-            | ConditionalKind::Or { rhs_effects, .. }\n-            | ConditionalKind::NullishCoalescing { rhs_effects, .. } => rhs_effects.is_empty(),\n-            ConditionalKind::IfElseMultiple { then, r#else, .. } => {\n-                then.iter().chain(r#else.iter()).all(|b| b.is_empty())\n-            }\n-        }\n-    }\n     /// Normalizes all contained values.\n     pub fn normalize(&mut self) {\n         match self {\n             ConditionalKind::If { then: block }\n             | ConditionalKind::Else { r#else: block }\n-            | ConditionalKind::Labeled { body: block } => block.normalize(),\n+            | ConditionalKind::And { expr: block, .. }\n+            | ConditionalKind::Or { expr: block, .. }\n+            | ConditionalKind::NullishCoalescing { expr: block, .. } => {\n+                for effect in &mut block.effects {\n+                    effect.normalize();\n+                }\n+            }\n             ConditionalKind::IfElse { then, r#else, .. }\n             | ConditionalKind::Ternary { then, r#else, .. } => {\n-                then.normalize();\n-                r#else.normalize();\n-            }\n-            ConditionalKind::And { rhs_effects, .. }\n-            | ConditionalKind::Or { rhs_effects, .. }\n-            | ConditionalKind::NullishCoalescing { rhs_effects, .. } => {\n-                for effect in rhs_effects.iter_mut() {\n+                for effect in &mut then.effects {\n+                    effect.normalize();\n+                }\n+                for effect in &mut r#else.effects {\n                     effect.normalize();\n                 }\n             }\n             ConditionalKind::IfElseMultiple { then, r#else, .. } => {\n                 for block in then.iter_mut().chain(r#else.iter_mut()) {\n-                    block.normalize();\n+                    for effect in &mut block.effects {\n+                        effect.normalize();\n+                    }\n+                }\n+            }\n+            ConditionalKind::Labeled { body } => {\n+                for effect in &mut body.effects {\n+                    effect.normalize();\n                 }\n             }\n         }\n@@ -141,7 +131,9 @@ impl EffectArg {\n             EffectArg::Value(value) => value.normalize(),\n             EffectArg::Closure(value, effects) => {\n                 value.normalize();\n-                effects.normalize();\n+                for effect in &mut effects.effects {\n+                    effect.normalize();\n+                }\n             }\n             EffectArg::Spread => {}\n         }\n@@ -2524,49 +2516,6 @@ impl VisitAstPath for Analyzer<'_> {\n         );\n     }\n \n-    fn visit_bin_expr<'ast: 'r, 'r>(\n-        &mut self,\n-        expr: &'ast BinExpr,\n-        ast_path: &mut AstNodePath<AstParentNodeRef<'r>>,\n-    ) {\n-        // Some binary operators have control flow semantics.\n-        match expr.op {\n-            BinaryOp::LogicalAnd | BinaryOp::LogicalOr | BinaryOp::NullishCoalescing => {\n-                // Visit the left hand node\n-                {\n-                    let mut ast_path =\n-                        ast_path.with_guard(AstParentNodeRef::BinExpr(expr, BinExprField::Left));\n-                    expr.left.visit_with_ast_path(self, &mut ast_path);\n-                };\n-                let prev_effects = take(&mut self.effects);\n-                let rhs_effects = {\n-                    let mut ast_path =\n-                        ast_path.with_guard(AstParentNodeRef::BinExpr(expr, BinExprField::Right));\n-                    expr.right.visit_with_ast_path(self, &mut ast_path);\n-                    take(&mut self.effects)\n-                };\n-                self.effects = prev_effects;\n-                self.add_conditional_effect(\n-                    &expr.left,\n-                    ast_path,\n-                    AstParentKind::BinExpr(BinExprField::Left),\n-                    expr.span(),\n-                    match expr.op {\n-                        BinaryOp::LogicalAnd => ConditionalKind::And { rhs_effects },\n-                        BinaryOp::LogicalOr => ConditionalKind::Or { rhs_effects },\n-                        BinaryOp::NullishCoalescing => {\n-                            ConditionalKind::NullishCoalescing { rhs_effects }\n-                        }\n-                        _ => unreachable!(),\n-                    },\n-                );\n-            }\n-            _ => <BinExpr as VisitWithAstPath<Self>>::visit_children_with_ast_path(\n-                expr, self, ast_path,\n-            ),\n-        }\n-    }\n-\n     fn visit_if_stmt<'ast: 'r, 'r>(\n         &mut self,\n         stmt: &'ast IfStmt,\n@@ -2795,7 +2744,7 @@ impl Analyzer<'_> {\n         {\n             return;\n         }\n-        let condition = self.eval_context.eval(test);\n+        let condition = Box::new(self.eval_context.eval(test));\n         if condition.is_unknown() {\n             if let Some(mut then) = then {\n                 self.effects.append(&mut then.effects);\n@@ -2805,7 +2754,6 @@ impl Analyzer<'_> {\n             }\n             return;\n         }\n-        let condition = Box::new(condition);\n         match (early_return_when_true, early_return_when_false) {\n             (true, false) => {\n                 let early_return = EarlyReturn::Conditional {\n@@ -2835,21 +2783,20 @@ impl Analyzer<'_> {\n             }\n             (false, false) | (true, true) => {\n                 let kind = match (then, r#else) {\n-                    (Some(then), Some(r#else)) => Some(ConditionalKind::IfElse { then, r#else }),\n-                    (Some(then), None) => Some(ConditionalKind::If { then }),\n-                    (None, Some(r#else)) => Some(ConditionalKind::Else { r#else }),\n-                    (None, None) => None,\n+                    (Some(then), Some(r#else)) => ConditionalKind::IfElse { then, r#else },\n+                    (Some(then), None) => ConditionalKind::If { then },\n+                    (None, Some(r#else)) => ConditionalKind::Else { r#else },\n+                    (None, None) => {\n+                        // No effects, ignore\n+                        return;\n+                    }\n                 };\n-                if let Some(kind) = kind\n-                    && !kind.is_empty()\n-                {\n-                    self.add_effect(Effect::Conditional {\n-                        condition,\n-                        kind: Box::new(kind),\n-                        ast_path: as_parent_path_with(ast_path, condition_ast_kind),\n-                        span,\n-                    });\n-                }\n+                self.add_effect(Effect::Conditional {\n+                    condition,\n+                    kind: Box::new(kind),\n+                    ast_path: as_parent_path_with(ast_path, condition_ast_kind),\n+                    span,\n+                });\n                 if early_return_when_false && early_return_when_true {\n                     let early_return = EarlyReturn::Always {\n                         prev_effects: take(&mut self.effects),\n@@ -2869,10 +2816,7 @@ impl Analyzer<'_> {\n         span: Span,\n         mut cond_kind: ConditionalKind,\n     ) {\n-        if cond_kind.is_empty() {\n-            return;\n-        }\n-        let condition = self.eval_context.eval(test);\n+        let condition = Box::new(self.eval_context.eval(test));\n         if condition.is_unknown() {\n             match &mut cond_kind {\n                 ConditionalKind::If { then } => {\n@@ -2894,18 +2838,18 @@ impl Analyzer<'_> {\n                         self.effects.append(&mut block.effects);\n                     }\n                 }\n-                ConditionalKind::And { rhs_effects }\n-                | ConditionalKind::Or { rhs_effects }\n-                | ConditionalKind::NullishCoalescing { rhs_effects } => {\n-                    self.effects.append(rhs_effects);\n+                ConditionalKind::And { expr }\n+                | ConditionalKind::Or { expr }\n+                | ConditionalKind::NullishCoalescing { expr } => {\n+                    self.effects.append(&mut expr.effects);\n                 }\n                 ConditionalKind::Labeled { body } => {\n                     self.effects.append(&mut body.effects);\n                 }\n             }\n         } else {\n             self.add_effect(Effect::Conditional {\n-                condition: Box::new(condition),\n+                condition,\n                 kind: Box::new(cond_kind),\n                 ast_path: as_parent_path_with(ast_path, ast_kind),\n                 span,"
        },
        {
            "sha": "dfa2bd5f147354e242bf77befd613e76bb1d3699",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/mod.rs",
            "status": "modified",
            "additions": 12,
            "deletions": 9,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -4110,14 +4110,15 @@ mod tests {\n                                 .await;\n                                 resolved.push((format!(\"{parent} -> {i} conditional\"), condition));\n                                 match *kind {\n-                                    ConditionalKind::If { then: block }\n-                                    | ConditionalKind::Else { r#else: block }\n-                                    | ConditionalKind::Labeled { body: block } => {\n+                                    ConditionalKind::If { then } => {\n+                                        queue\n+                                            .extend(then.effects.into_iter().rev().map(|e| (i, e)));\n+                                    }\n+                                    ConditionalKind::Else { r#else } => {\n                                         queue.extend(\n-                                            block.effects.into_iter().rev().map(|e| (i, e)),\n+                                            r#else.effects.into_iter().rev().map(|e| (i, e)),\n                                         );\n                                     }\n-\n                                     ConditionalKind::IfElse { then, r#else }\n                                     | ConditionalKind::Ternary { then, r#else } => {\n                                         queue.extend(\n@@ -4138,10 +4139,12 @@ mod tests {\n                                             );\n                                         }\n                                     }\n-                                    ConditionalKind::And { rhs_effects }\n-                                    | ConditionalKind::Or { rhs_effects }\n-                                    | ConditionalKind::NullishCoalescing { rhs_effects } => {\n-                                        queue.extend(rhs_effects.into_iter().rev().map(|e| (i, e)));\n+                                    ConditionalKind::And { expr }\n+                                    | ConditionalKind::Or { expr }\n+                                    | ConditionalKind::NullishCoalescing { expr }\n+                                    | ConditionalKind::Labeled { body: expr } => {\n+                                        queue\n+                                            .extend(expr.effects.into_iter().rev().map(|e| (i, e)));\n                                     }\n                                 };\n                                 steps"
        },
        {
            "sha": "2af172fb6e00d15d193cda037491c3a08e44b76f",
            "filename": "turbopack/crates/turbopack-ecmascript/src/code_gen.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fcode_gen.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fcode_gen.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fcode_gen.rs?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -35,7 +35,6 @@ use crate::{\n         exports_info::{ExportsInfoBinding, ExportsInfoRef},\n         ident::IdentReplacement,\n         member::MemberReplacement,\n-        replace_parent_with_child::ReplaceParentWithChild,\n         require_context::RequireContextAssetReferenceCodeGen,\n         unreachable::Unreachable,\n         worker::WorkerAssetReferenceCodeGen,\n@@ -200,7 +199,6 @@ pub enum CodeGen {\n     RequireContextAssetReferenceCodeGen(RequireContextAssetReferenceCodeGen),\n     UrlAssetReferenceCodeGen(UrlAssetReferenceCodeGen),\n     WorkerAssetReferenceCodeGen(WorkerAssetReferenceCodeGen),\n-    ReplaceParentWithChild(ReplaceParentWithChild),\n }\n \n impl CodeGen {\n@@ -214,8 +212,8 @@ impl CodeGen {\n         match self {\n             Self::AmdDefineWithDependenciesCodeGen(v) => v.code_generation(ctx).await,\n             Self::CjsRequireCacheAccess(v) => v.code_generation(ctx).await,\n-            Self::ConstantConditionCodeGen(v) => v.code_generation(),\n-            Self::ConstantValueCodeGen(v) => v.code_generation(),\n+            Self::ConstantConditionCodeGen(v) => v.code_generation(ctx).await,\n+            Self::ConstantValueCodeGen(v) => v.code_generation(ctx).await,\n             Self::DynamicExpression(v) => v.code_generation(ctx).await,\n             Self::EsmBinding(v) => v.code_generation(ctx, scope_hoisting_context).await,\n             Self::EsmModuleItem(v) => v.code_generation(ctx).await,\n@@ -233,7 +231,6 @@ impl CodeGen {\n             Self::RequireContextAssetReferenceCodeGen(v) => v.code_generation(ctx).await,\n             Self::UrlAssetReferenceCodeGen(v) => v.code_generation(ctx).await,\n             Self::WorkerAssetReferenceCodeGen(v) => v.code_generation(ctx).await,\n-            Self::ReplaceParentWithChild(v) => v.code_generation(),\n         }\n     }\n }"
        },
        {
            "sha": "0437f4a1b4fc79e2dbc0410a6af09a41d6f610d2",
            "filename": "turbopack/crates/turbopack-ecmascript/src/path_visitor.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fpath_visitor.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fpath_visitor.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fpath_visitor.rs?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -88,7 +88,7 @@ impl<'a> ApplyVisitors<'a, '_> {\n             let kind = ast_path[index];\n             if let Some(visitors) = find_range(current_visitors, &kind, index) {\n                 // visitors contains all items that match kind at index. Some of them terminate\n-                // here, some need further visiting. The terminating items are at the start due to\n+                // here, some need furth visiting. The terminating items are at the start due to\n                 // sorting of the list.\n                 index += 1;\n "
        },
        {
            "sha": "dc6fd8b57faca3e41e7769ee160f3641e6a4a40a",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/constant_condition.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_condition.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_condition.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_condition.rs?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -1,7 +1,8 @@\n use anyhow::Result;\n use serde::{Deserialize, Serialize};\n use swc_core::quote;\n-use turbo_tasks::{NonLocalValue, debug::ValueDebugFormat, trace::TraceRawVcs};\n+use turbo_tasks::{NonLocalValue, Vc, debug::ValueDebugFormat, trace::TraceRawVcs};\n+use turbopack_core::chunk::ChunkingContext;\n \n use super::AstPath;\n use crate::{\n@@ -31,7 +32,10 @@ impl ConstantConditionCodeGen {\n         ConstantConditionCodeGen { value, path }\n     }\n \n-    pub fn code_generation(&self) -> Result<CodeGeneration> {\n+    pub async fn code_generation(\n+        &self,\n+        _chunking_context: Vc<Box<dyn ChunkingContext>>,\n+    ) -> Result<CodeGeneration> {\n         let value = self.value;\n         let visitors = [create_visitor!(\n             exact,"
        },
        {
            "sha": "2c589862f4adb688fbc6a3831411ff9b43451ebd",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/constant_value.rs",
            "status": "modified",
            "additions": 14,
            "deletions": 10,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_value.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_value.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fconstant_value.rs?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -9,8 +9,8 @@ use swc_core::{\n     quote,\n };\n use turbo_rcstr::RcStr;\n-use turbo_tasks::{NonLocalValue, debug::ValueDebugFormat, trace::TraceRawVcs};\n-use turbopack_core::compile_time_info::CompileTimeDefineValue;\n+use turbo_tasks::{NonLocalValue, Vc, debug::ValueDebugFormat, trace::TraceRawVcs};\n+use turbopack_core::{chunk::ChunkingContext, compile_time_info::CompileTimeDefineValue};\n \n use super::AstPath;\n use crate::{\n@@ -39,11 +39,15 @@ impl ConstantValueCodeGen {\n     pub fn new(value: CompileTimeDefineValue, path: AstPath) -> Self {\n         ConstantValueCodeGen { value, path }\n     }\n-    pub fn code_generation(&self) -> Result<CodeGeneration> {\n+    pub async fn code_generation(\n+        &self,\n+        _chunking_context: Vc<Box<dyn ChunkingContext>>,\n+    ) -> Result<CodeGeneration> {\n         let value = self.value.clone();\n \n         let visitor = create_visitor!(self.path, visit_mut_expr, |expr: &mut Expr| {\n-            *expr = define_env_to_expr(&value);\n+            // TODO: avoid this clone\n+            *expr = define_env_to_expr((value).clone());\n         });\n \n         Ok(CodeGeneration::visitors(vec![visitor]))\n@@ -56,7 +60,7 @@ impl From<ConstantValueCodeGen> for CodeGen {\n     }\n }\n \n-fn define_env_to_expr(value: &CompileTimeDefineValue) -> Expr {\n+fn define_env_to_expr(value: CompileTimeDefineValue) -> Expr {\n     match value {\n         CompileTimeDefineValue::Null => {\n             quote!(\"(\\\"TURBOPACK compile-time value\\\", null)\" as Expr)\n@@ -67,23 +71,23 @@ fn define_env_to_expr(value: &CompileTimeDefineValue) -> Expr {\n         CompileTimeDefineValue::Bool(false) => {\n             quote!(\"(\\\"TURBOPACK compile-time value\\\", false)\" as Expr)\n         }\n-        CompileTimeDefineValue::Number(n) => {\n+        CompileTimeDefineValue::Number(ref n) => {\n             quote!(\"(\\\"TURBOPACK compile-time value\\\", $e)\" as Expr, e: Expr = n.parse::<f64>().unwrap().into())\n         }\n-        CompileTimeDefineValue::String(s) => {\n+        CompileTimeDefineValue::String(ref s) => {\n             quote!(\"(\\\"TURBOPACK compile-time value\\\", $e)\" as Expr, e: Expr = s.to_string().into())\n         }\n         CompileTimeDefineValue::Array(a) => {\n             quote!(\"(\\\"TURBOPACK compile-time value\\\", $e)\" as Expr, e: Expr = Expr::Array(ArrayLit {\n                 span: DUMMY_SP,\n-                elems: a.iter().map(|i| Some(define_env_to_expr(i).into())).collect(),\n+                elems: a.into_iter().map(|i| Some(define_env_to_expr(i).into())).collect(),\n             }))\n         }\n         CompileTimeDefineValue::Object(m) => {\n             quote!(\"(\\\"TURBOPACK compile-time value\\\", $e)\" as Expr, e: Expr = Expr::Object(ObjectLit {\n                 span: DUMMY_SP,\n                 props: m\n-                    .iter()\n+                    .into_iter()\n                     .map(|(k, v)| {\n                         swc_core::ecma::ast::PropOrSpread::Prop(\n                             Prop::KeyValue(KeyValueProp {\n@@ -99,7 +103,7 @@ fn define_env_to_expr(value: &CompileTimeDefineValue) -> Expr {\n         CompileTimeDefineValue::Undefined => {\n             quote!(\"(\\\"TURBOPACK compile-time value\\\", void 0)\" as Expr)\n         }\n-        CompileTimeDefineValue::Evaluate(s) => parse_single_expr_lit(s.clone()),\n+        CompileTimeDefineValue::Evaluate(ref s) => parse_single_expr_lit(s.clone()),\n     }\n }\n "
        },
        {
            "sha": "89ddc31594c407c213f08e2989f81a2c50cb3665",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/mod.rs",
            "status": "modified",
            "additions": 39,
            "deletions": 64,
            "changes": 103,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -12,7 +12,6 @@ pub mod member;\n pub mod node;\n pub mod pattern_mapping;\n pub mod raw;\n-pub mod replace_parent_with_child;\n pub mod require_context;\n pub mod type_issue;\n pub mod typescript;\n@@ -55,8 +54,7 @@ use swc_core::{\n         visit::{\n             AstParentKind, AstParentNodeRef, VisitAstPath, VisitWithAstPath,\n             fields::{\n-                AssignExprField, AssignTargetField, BinExprField, BindingIdentField,\n-                SimpleAssignTargetField,\n+                AssignExprField, AssignTargetField, BindingIdentField, SimpleAssignTargetField,\n             },\n         },\n     },\n@@ -157,7 +155,6 @@ use crate::{\n         ident::IdentReplacement,\n         member::MemberReplacement,\n         node::{FilePathModuleReference, PackageJsonReference},\n-        replace_parent_with_child::ReplaceParentWithChild,\n         require_context::{RequireContextAssetReference, RequireContextMap},\n         type_issue::SpecifiedModuleTypeIssue,\n     },\n@@ -1076,7 +1073,7 @@ async fn analyze_ecmascript_module_internal(\n                 Effect::Conditional {\n                     condition,\n                     kind,\n-                    ast_path: mut condition_ast_path,\n+                    ast_path: condition_ast_path,\n                     span: _,\n                 } => {\n                     // Don't replace condition with it's truth-y value, if it has side effects\n@@ -1087,7 +1084,7 @@ async fn analyze_ecmascript_module_internal(\n                         .link_value(*condition, ImportAttributes::empty_ref())\n                         .await?;\n \n-                    macro_rules! inactive_block {\n+                    macro_rules! inactive {\n                         ($block:ident) => {\n                             if analyze_mode.is_code_gen() {\n                                 analysis.add_code_gen(Unreachable::new($block.range.clone()));\n@@ -1104,79 +1101,56 @@ async fn analyze_ecmascript_module_internal(\n                             }\n                         };\n                     }\n-                    macro_rules! active_block {\n+                    macro_rules! active {\n                         ($block:ident) => {\n                             queue_stack\n                                 .get_mut()\n                                 .extend($block.effects.into_iter().map(Action::Effect).rev())\n                         };\n                     }\n-                    macro_rules! active_effects {\n-                        ($effects:ident) => {\n-                            queue_stack\n-                                .get_mut()\n-                                .extend($effects.into_iter().map(Action::Effect).rev())\n-                        };\n-                    }\n-                    macro_rules! replace_with_condition {\n-                        ($path:ident) => {\n-                            if analyze_mode.is_code_gen() {\n-                                analysis.add_code_gen(ReplaceParentWithChild::new(AstPath($path)));\n-                            }\n-                        };\n-                    }\n-                    macro_rules! replace_with_right {\n-                        ($path:ident) => {\n-                            if analyze_mode.is_code_gen() && !condition_has_side_effects {\n-                                $path.pop();\n-                                $path.push(AstParentKind::BinExpr(BinExprField::Right));\n-                                analysis.add_code_gen(ReplaceParentWithChild::new(AstPath($path)));\n-                            }\n-                        };\n-                    }\n                     match *kind {\n                         ConditionalKind::If { then } => match condition.is_truthy() {\n                             Some(true) => {\n                                 condition!(ConstantConditionValue::Truthy);\n-                                active_block!(then);\n+                                active!(then);\n                             }\n                             Some(false) => {\n                                 condition!(ConstantConditionValue::Falsy);\n-                                inactive_block!(then);\n+                                inactive!(then);\n                             }\n                             None => {\n-                                active_block!(then);\n+                                active!(then);\n                             }\n                         },\n                         ConditionalKind::Else { r#else } => match condition.is_truthy() {\n                             Some(true) => {\n                                 condition!(ConstantConditionValue::Truthy);\n-                                inactive_block!(r#else);\n+                                inactive!(r#else);\n                             }\n                             Some(false) => {\n                                 condition!(ConstantConditionValue::Falsy);\n-                                active_block!(r#else);\n+                                active!(r#else);\n                             }\n                             None => {\n-                                active_block!(r#else);\n+                                active!(r#else);\n                             }\n                         },\n                         ConditionalKind::IfElse { then, r#else }\n                         | ConditionalKind::Ternary { then, r#else } => {\n                             match condition.is_truthy() {\n                                 Some(true) => {\n                                     condition!(ConstantConditionValue::Truthy);\n-                                    active_block!(then);\n-                                    inactive_block!(r#else);\n+                                    active!(then);\n+                                    inactive!(r#else);\n                                 }\n                                 Some(false) => {\n                                     condition!(ConstantConditionValue::Falsy);\n-                                    active_block!(r#else);\n-                                    inactive_block!(then);\n+                                    active!(r#else);\n+                                    inactive!(then);\n                                 }\n                                 None => {\n-                                    active_block!(then);\n-                                    active_block!(r#else);\n+                                    active!(then);\n+                                    active!(r#else);\n                                 }\n                             }\n                         }\n@@ -1185,72 +1159,73 @@ async fn analyze_ecmascript_module_internal(\n                                 Some(true) => {\n                                     condition!(ConstantConditionValue::Truthy);\n                                     for then in then {\n-                                        active_block!(then);\n+                                        active!(then);\n                                     }\n                                     for r#else in r#else {\n-                                        inactive_block!(r#else);\n+                                        inactive!(r#else);\n                                     }\n                                 }\n                                 Some(false) => {\n                                     condition!(ConstantConditionValue::Falsy);\n                                     for then in then {\n-                                        inactive_block!(then);\n+                                        inactive!(then);\n                                     }\n                                     for r#else in r#else {\n-                                        active_block!(r#else);\n+                                        active!(r#else);\n                                     }\n                                 }\n                                 None => {\n                                     for then in then {\n-                                        active_block!(then);\n+                                        active!(then);\n                                     }\n                                     for r#else in r#else {\n-                                        active_block!(r#else);\n+                                        active!(r#else);\n                                     }\n                                 }\n                             }\n                         }\n-                        ConditionalKind::And { rhs_effects } => match condition.is_truthy() {\n+                        ConditionalKind::And { expr } => match condition.is_truthy() {\n                             Some(true) => {\n-                                replace_with_right!(condition_ast_path);\n-                                active_effects!(rhs_effects);\n+                                condition!(ConstantConditionValue::Truthy);\n+                                active!(expr);\n                             }\n                             Some(false) => {\n                                 // The condition value needs to stay since it's used\n-                                replace_with_condition!(condition_ast_path);\n+                                inactive!(expr);\n                             }\n                             None => {\n-                                active_effects!(rhs_effects);\n+                                active!(expr);\n                             }\n                         },\n-                        ConditionalKind::Or { rhs_effects } => match condition.is_truthy() {\n+                        ConditionalKind::Or { expr } => match condition.is_truthy() {\n                             Some(true) => {\n-                                replace_with_condition!(condition_ast_path);\n+                                // The condition value needs to stay since it's used\n+                                inactive!(expr);\n                             }\n                             Some(false) => {\n-                                replace_with_right!(condition_ast_path);\n-                                active_effects!(rhs_effects);\n+                                condition!(ConstantConditionValue::Falsy);\n+                                active!(expr);\n                             }\n                             None => {\n-                                active_effects!(rhs_effects);\n+                                active!(expr);\n                             }\n                         },\n-                        ConditionalKind::NullishCoalescing { rhs_effects } => {\n+                        ConditionalKind::NullishCoalescing { expr } => {\n                             match condition.is_nullish() {\n                                 Some(true) => {\n-                                    replace_with_right!(condition_ast_path);\n-                                    active_effects!(rhs_effects);\n+                                    condition!(ConstantConditionValue::Nullish);\n+                                    active!(expr);\n                                 }\n                                 Some(false) => {\n-                                    replace_with_condition!(condition_ast_path);\n+                                    inactive!(expr);\n                                 }\n                                 None => {\n-                                    active_effects!(rhs_effects);\n+                                    active!(expr);\n                                 }\n                             }\n                         }\n                         ConditionalKind::Labeled { body } => {\n-                            active_block!(body);\n+                            active!(body);\n                         }\n                     }\n                 }"
        },
        {
            "sha": "d3972d5ba1b488000407b3d57944a1216cd4694a",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/replace_parent_with_child.rs",
            "status": "removed",
            "additions": 0,
            "deletions": 67,
            "changes": 67,
            "blob_url": "https://github.com/vercel/next.js/blob/eb8fea0fc311211b296ea925dbe74f7e2719a9f0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Freplace_parent_with_child.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/eb8fea0fc311211b296ea925dbe74f7e2719a9f0/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Freplace_parent_with_child.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Freplace_parent_with_child.rs?ref=eb8fea0fc311211b296ea925dbe74f7e2719a9f0",
            "patch": "@@ -1,67 +0,0 @@\n-use anyhow::Result;\n-use serde::{Deserialize, Serialize};\n-use swc_core::{\n-    common::util::take::Take,\n-    ecma::{\n-        ast::{BinExpr, Expr},\n-        visit::{AstParentKind, fields::BinExprField},\n-    },\n-    quote,\n-};\n-use turbo_tasks::{NonLocalValue, debug::ValueDebugFormat, trace::TraceRawVcs};\n-\n-use super::AstPath;\n-use crate::{\n-    code_gen::{CodeGen, CodeGeneration},\n-    create_visitor,\n-};\n-\n-/// Used to replace expressions like `<truthy> || <something>` with `<truthy>`\n-#[derive(\n-    PartialEq, Eq, Serialize, Deserialize, TraceRawVcs, ValueDebugFormat, NonLocalValue, Debug, Hash,\n-)]\n-\n-pub struct ReplaceParentWithChild {\n-    path: AstPath,\n-}\n-\n-impl ReplaceParentWithChild {\n-    pub fn new(path: AstPath) -> Self {\n-        Self { path }\n-    }\n-\n-    pub fn code_generation(&self) -> Result<CodeGeneration> {\n-        let parent_path = &self.path[0..(self.path.len() - 1)];\n-        let to_replace_with = *self.path.last().unwrap();\n-        let AstParentKind::BinExpr(field) = to_replace_with else {\n-            panic!(\"invalid path, must point at a BinExpr not a {to_replace_with:?}\");\n-        };\n-        let visitor = create_visitor!(parent_path, visit_mut_expr, |parent_expr: &mut Expr| {\n-            match parent_expr {\n-                Expr::Bin(BinExpr { left, right, .. }) => {\n-                    let child = match field {\n-                        BinExprField::Left => left.take(),\n-                        BinExprField::Right => right.take(),\n-                        _ => {\n-                            panic!(\"Can only replace with expression children, got {field:?}\");\n-                        }\n-                    };\n-                    *parent_expr = quote!(\"(\\\"TURBOPACK simplified expression\\\", $e)\" as Expr, e: Expr = *child);\n-                }\n-\n-                _ => {\n-                    // do nothing, the AST must have been modified and our operator or child\n-                    // removed.\n-                }\n-            };\n-        });\n-\n-        Ok(CodeGeneration::visitors(vec![visitor]))\n-    }\n-}\n-\n-impl From<ReplaceParentWithChild> for CodeGen {\n-    fn from(val: ReplaceParentWithChild) -> Self {\n-        CodeGen::ReplaceParentWithChild(val)\n-    }\n-}"
        },
        {
            "sha": "a85de0f51c238acaa61b02dcc4bc5971a4521af0",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/conditional-import/graph-effects.snapshot",
            "status": "modified",
            "additions": 331,
            "deletions": 0,
            "changes": 331,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fconditional-import%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fconditional-import%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fconditional-import%2Fgraph-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -1,4 +1,154 @@\n [\n+    Conditional {\n+        condition: Constant(\n+            True,\n+        ),\n+        kind: Ternary {\n+            then: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Module,\n+                        ),\n+                        Module(\n+                            Body(\n+                                0,\n+                            ),\n+                        ),\n+                        ModuleItem(\n+                            Stmt,\n+                        ),\n+                        Stmt(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Var,\n+                        ),\n+                        VarDecl(\n+                            Decls(\n+                                0,\n+                            ),\n+                        ),\n+                        VarDeclarator(\n+                            Init,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                0,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Cons,\n+                        ),\n+                    ],\n+                ),\n+            },\n+            else: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Module,\n+                        ),\n+                        Module(\n+                            Body(\n+                                0,\n+                            ),\n+                        ),\n+                        ModuleItem(\n+                            Stmt,\n+                        ),\n+                        Stmt(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Var,\n+                        ),\n+                        VarDecl(\n+                            Decls(\n+                                0,\n+                            ),\n+                        ),\n+                        VarDeclarator(\n+                            Init,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                0,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Alt,\n+                        ),\n+                    ],\n+                ),\n+            },\n+        },\n+        ast_path: [\n+            Program(\n+                Module,\n+            ),\n+            Module(\n+                Body(\n+                    0,\n+                ),\n+            ),\n+            ModuleItem(\n+                Stmt,\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Args(\n+                    0,\n+                ),\n+            ),\n+            ExprOrSpread(\n+                Expr,\n+            ),\n+            Expr(\n+                Cond,\n+            ),\n+            CondExpr(\n+                Test,\n+            ),\n+        ],\n+        span: 18..34,\n+    },\n     Call {\n         func: FreeVar(\n             \"import\",\n@@ -265,6 +415,187 @@\n         ],\n         span: 57..64,\n     },\n+    Conditional {\n+        condition: Binary(\n+            7,\n+            Member(\n+                5,\n+                Member(\n+                    3,\n+                    FreeVar(\n+                        \"process\",\n+                    ),\n+                    Constant(\n+                        Str(\n+                            Atom(\n+                                \"env\",\n+                            ),\n+                        ),\n+                    ),\n+                ),\n+                Constant(\n+                    Str(\n+                        Atom(\n+                            \"NEXT_RUNTIME\",\n+                        ),\n+                    ),\n+                ),\n+            ),\n+            StrictEqual,\n+            Constant(\n+                Str(\n+                    Atom(\n+                        \"edge\",\n+                    ),\n+                ),\n+            ),\n+        ),\n+        kind: Ternary {\n+            then: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Module,\n+                        ),\n+                        Module(\n+                            Body(\n+                                1,\n+                            ),\n+                        ),\n+                        ModuleItem(\n+                            Stmt,\n+                        ),\n+                        Stmt(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Var,\n+                        ),\n+                        VarDecl(\n+                            Decls(\n+                                0,\n+                            ),\n+                        ),\n+                        VarDeclarator(\n+                            Init,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                0,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Cons,\n+                        ),\n+                    ],\n+                ),\n+            },\n+            else: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Module,\n+                        ),\n+                        Module(\n+                            Body(\n+                                1,\n+                            ),\n+                        ),\n+                        ModuleItem(\n+                            Stmt,\n+                        ),\n+                        Stmt(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Var,\n+                        ),\n+                        VarDecl(\n+                            Decls(\n+                                0,\n+                            ),\n+                        ),\n+                        VarDeclarator(\n+                            Init,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                0,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Alt,\n+                        ),\n+                    ],\n+                ),\n+            },\n+        },\n+        ast_path: [\n+            Program(\n+                Module,\n+            ),\n+            Module(\n+                Body(\n+                    1,\n+                ),\n+            ),\n+            ModuleItem(\n+                Stmt,\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Args(\n+                    0,\n+                ),\n+            ),\n+            ExprOrSpread(\n+                Expr,\n+            ),\n+            Expr(\n+                Cond,\n+            ),\n+            CondExpr(\n+                Test,\n+            ),\n+        ],\n+        span: 57..196,\n+    },\n     Call {\n         func: FreeVar(\n             \"import\","
        },
        {
            "sha": "75dcd47daabcafa057c7a93ff619f7495a657608",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/conditional-import/resolved-effects.snapshot",
            "status": "modified",
            "additions": 15,
            "deletions": 10,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fconditional-import%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fconditional-import%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fconditional-import%2Fresolved-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -1,31 +1,36 @@\n-0 -> 1 call = import*0*(\"a\")\n+0 -> 1 conditional = true\n+\n+0 -> 2 call = import*0*(\"a\")\n - *0* import: The dynamic import() method from the ESM specification: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#dynamic_imports\n \n-0 -> 4 free var = FreeVar(process)\n+0 -> 5 free var = FreeVar(process)\n+\n+0 -> 6 conditional = (process.env*0*[\"NEXT_RUNTIME\"] === \"edge\")\n+- *0* process.env: The Node.js process.env property: https://nodejs.org/api/process.html#processenv\n \n-0 -> 5 call = import*0*(\n+0 -> 7 call = import*0*(\n     (???*1* ? \"next/dist/compiled/@vercel/og/index.edge.js\" : \"next/dist/compiled/@vercel/og/index.node.js\")\n )\n - *0* import: The dynamic import() method from the ESM specification: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#dynamic_imports\n - *1* (process.env*2*[\"NEXT_RUNTIME\"] === \"edge\")\n     nested operation\n - *2* process.env: The Node.js process.env property: https://nodejs.org/api/process.html#processenv\n \n-0 -> 6 conditional = true\n+0 -> 8 conditional = true\n \n-6 -> 7 call = import*0*(\"a\")\n+8 -> 9 call = import*0*(\"a\")\n - *0* import: The dynamic import() method from the ESM specification: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#dynamic_imports\n \n-6 -> 8 call = import*0*(\"b\")\n+8 -> 10 call = import*0*(\"b\")\n - *0* import: The dynamic import() method from the ESM specification: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#dynamic_imports\n \n-0 -> 9 conditional = true\n+0 -> 11 conditional = true\n \n-0 -> 12 conditional = true\n+0 -> 14 conditional = true\n \n-12 -> 13 unreachable = ???*0*\n+14 -> 15 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 14 call = import*0*(\"c\")\n+0 -> 16 call = import*0*(\"c\")\n - *0* import: The dynamic import() method from the ESM specification: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#dynamic_imports"
        },
        {
            "sha": "5ff35ec95c86b7a44f4f676360205e75c0a16816",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/esbuild/graph-effects.snapshot",
            "status": "modified",
            "additions": 502,
            "deletions": 675,
            "changes": 1177,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fesbuild%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fesbuild%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fesbuild%2Fgraph-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -74,683 +74,487 @@\n         ],\n         span: 2687..2706,\n     },\n-    Conditional {\n-        condition: Logical(\n-            4,\n-            Or,\n-            [\n-                Not(\n-                    2,\n-                    FreeVar(\n-                        \"ESBUILD_BINARY_PATH\",\n-                    ),\n+    Member {\n+        obj: Variable(\n+            (\n+                \"path2\",\n+                #2,\n+            ),\n+        ),\n+        prop: Constant(\n+            Str(\n+                Atom(\n+                    \"basename\",\n                 ),\n-                Constant(\n-                    False,\n+            ),\n+        ),\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    7,\n                 ),\n-            ],\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                Arrow,\n+            ),\n+            ArrowExpr(\n+                Body,\n+            ),\n+            BlockStmtOrExpr(\n+                BlockStmt,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                If,\n+            ),\n+            IfStmt(\n+                Test,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Paren,\n+            ),\n+            ParenExpr(\n+                Expr,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Left,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Left,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Callee,\n+            ),\n+            Callee(\n+                Expr,\n+            ),\n+            Expr(\n+                Member,\n+            ),\n+        ],\n+        span: 2725..2739,\n+    },\n+    FreeVar {\n+        var: \"__filename\",\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    7,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                Arrow,\n+            ),\n+            ArrowExpr(\n+                Body,\n+            ),\n+            BlockStmtOrExpr(\n+                BlockStmt,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                If,\n+            ),\n+            IfStmt(\n+                Test,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Paren,\n+            ),\n+            ParenExpr(\n+                Expr,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Left,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Left,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Args(\n+                    0,\n+                ),\n+            ),\n+            ExprOrSpread(\n+                Expr,\n+            ),\n+            Expr(\n+                Ident,\n+            ),\n+        ],\n+        span: 2740..2750,\n+    },\n+    MemberCall {\n+        obj: Variable(\n+            (\n+                \"path2\",\n+                #2,\n+            ),\n         ),\n-        kind: And {\n-            rhs_effects: [\n-                Member {\n-                    obj: Variable(\n-                        (\n-                            \"path2\",\n-                            #2,\n-                        ),\n-                    ),\n-                    prop: Constant(\n-                        Str(\n-                            Atom(\n-                                \"basename\",\n-                            ),\n-                        ),\n-                    ),\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                7,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Arrow,\n-                        ),\n-                        ArrowExpr(\n-                            Body,\n-                        ),\n-                        BlockStmtOrExpr(\n-                            BlockStmt,\n-                        ),\n-                        BlockStmt(\n-                            Stmts(\n-                                0,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            If,\n-                        ),\n-                        IfStmt(\n-                            Test,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Paren,\n-                        ),\n-                        ParenExpr(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Call,\n-                        ),\n-                        CallExpr(\n-                            Callee,\n-                        ),\n-                        Callee(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Member,\n-                        ),\n-                    ],\n-                    span: 2725..2739,\n-                },\n-                FreeVar {\n-                    var: \"__filename\",\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                7,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Arrow,\n-                        ),\n-                        ArrowExpr(\n-                            Body,\n-                        ),\n-                        BlockStmtOrExpr(\n-                            BlockStmt,\n-                        ),\n-                        BlockStmt(\n-                            Stmts(\n-                                0,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            If,\n-                        ),\n-                        IfStmt(\n-                            Test,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Paren,\n-                        ),\n-                        ParenExpr(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Call,\n-                        ),\n-                        CallExpr(\n-                            Args(\n-                                0,\n-                            ),\n-                        ),\n-                        ExprOrSpread(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Ident,\n-                        ),\n-                    ],\n-                    span: 2740..2750,\n-                },\n-                MemberCall {\n-                    obj: Variable(\n-                        (\n-                            \"path2\",\n-                            #2,\n-                        ),\n-                    ),\n-                    prop: Constant(\n-                        Str(\n-                            Atom(\n-                                \"basename\",\n-                            ),\n-                        ),\n-                    ),\n-                    args: [\n-                        Value(\n-                            FreeVar(\n-                                \"__filename\",\n-                            ),\n-                        ),\n-                    ],\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                7,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Arrow,\n-                        ),\n-                        ArrowExpr(\n-                            Body,\n-                        ),\n-                        BlockStmtOrExpr(\n-                            BlockStmt,\n-                        ),\n-                        BlockStmt(\n-                            Stmts(\n-                                0,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            If,\n-                        ),\n-                        IfStmt(\n-                            Test,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Paren,\n-                        ),\n-                        ParenExpr(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Call,\n-                        ),\n-                    ],\n-                    span: 2725..2751,\n-                    in_try: false,\n-                    new: false,\n-                },\n-                Conditional {\n-                    condition: Binary(\n-                        6,\n-                        MemberCall(\n-                            4,\n-                            Variable(\n-                                (\n-                                    \"path2\",\n-                                    #2,\n-                                ),\n-                            ),\n-                            Constant(\n-                                Str(\n-                                    Atom(\n-                                        \"basename\",\n-                                    ),\n-                                ),\n-                            ),\n-                            [\n-                                FreeVar(\n-                                    \"__filename\",\n-                                ),\n-                            ],\n-                        ),\n-                        StrictNotEqual,\n-                        Constant(\n-                            Str(\n-                                Atom(\n-                                    \"main.js\",\n-                                ),\n-                            ),\n-                        ),\n-                    ),\n-                    kind: Or {\n-                        rhs_effects: [\n-                            Member {\n-                                obj: Variable(\n-                                    (\n-                                        \"path2\",\n-                                        #2,\n-                                    ),\n-                                ),\n-                                prop: Constant(\n-                                    Str(\n-                                        Atom(\n-                                            \"basename\",\n-                                        ),\n-                                    ),\n-                                ),\n-                                ast_path: [\n-                                    Program(\n-                                        Script,\n-                                    ),\n-                                    Script(\n-                                        Body(\n-                                            7,\n-                                        ),\n-                                    ),\n-                                    Stmt(\n-                                        Decl,\n-                                    ),\n-                                    Decl(\n-                                        Var,\n-                                    ),\n-                                    VarDecl(\n-                                        Decls(\n-                                            0,\n-                                        ),\n-                                    ),\n-                                    VarDeclarator(\n-                                        Init,\n-                                    ),\n-                                    Expr(\n-                                        Arrow,\n-                                    ),\n-                                    ArrowExpr(\n-                                        Body,\n-                                    ),\n-                                    BlockStmtOrExpr(\n-                                        BlockStmt,\n-                                    ),\n-                                    BlockStmt(\n-                                        Stmts(\n-                                            0,\n-                                        ),\n-                                    ),\n-                                    Stmt(\n-                                        If,\n-                                    ),\n-                                    IfStmt(\n-                                        Test,\n-                                    ),\n-                                    Expr(\n-                                        Bin,\n-                                    ),\n-                                    BinExpr(\n-                                        Right,\n-                                    ),\n-                                    Expr(\n-                                        Paren,\n-                                    ),\n-                                    ParenExpr(\n-                                        Expr,\n-                                    ),\n-                                    Expr(\n-                                        Bin,\n-                                    ),\n-                                    BinExpr(\n-                                        Right,\n-                                    ),\n-                                    Expr(\n-                                        Bin,\n-                                    ),\n-                                    BinExpr(\n-                                        Left,\n-                                    ),\n-                                    Expr(\n-                                        Call,\n-                                    ),\n-                                    CallExpr(\n-                                        Callee,\n-                                    ),\n-                                    Callee(\n-                                        Expr,\n-                                    ),\n-                                    Expr(\n-                                        Member,\n-                                    ),\n-                                ],\n-                                span: 2775..2789,\n-                            },\n-                            FreeVar {\n-                                var: \"__dirname\",\n-                                ast_path: [\n-                                    Program(\n-                                        Script,\n-                                    ),\n-                                    Script(\n-                                        Body(\n-                                            7,\n-                                        ),\n-                                    ),\n-                                    Stmt(\n-                                        Decl,\n-                                    ),\n-                                    Decl(\n-                                        Var,\n-                                    ),\n-                                    VarDecl(\n-                                        Decls(\n-                                            0,\n-                                        ),\n-                                    ),\n-                                    VarDeclarator(\n-                                        Init,\n-                                    ),\n-                                    Expr(\n-                                        Arrow,\n-                                    ),\n-                                    ArrowExpr(\n-                                        Body,\n-                                    ),\n-                                    BlockStmtOrExpr(\n-                                        BlockStmt,\n-                                    ),\n-                                    BlockStmt(\n-                                        Stmts(\n-                                            0,\n-                                        ),\n-                                    ),\n-                                    Stmt(\n-                                        If,\n-                                    ),\n-                                    IfStmt(\n-                                        Test,\n-                                    ),\n-                                    Expr(\n-                                        Bin,\n-                                    ),\n-                                    BinExpr(\n-                                        Right,\n-                                    ),\n-                                    Expr(\n-                                        Paren,\n-                                    ),\n-                                    ParenExpr(\n-                                        Expr,\n-                                    ),\n-                                    Expr(\n-                                        Bin,\n-                                    ),\n-                                    BinExpr(\n-                                        Right,\n-                                    ),\n-                                    Expr(\n-                                        Bin,\n-                                    ),\n-                                    BinExpr(\n-                                        Left,\n-                                    ),\n-                                    Expr(\n-                                        Call,\n-                                    ),\n-                                    CallExpr(\n-                                        Args(\n-                                            0,\n-                                        ),\n-                                    ),\n-                                    ExprOrSpread(\n-                                        Expr,\n-                                    ),\n-                                    Expr(\n-                                        Ident,\n-                                    ),\n-                                ],\n-                                span: 2790..2799,\n-                            },\n-                            MemberCall {\n-                                obj: Variable(\n-                                    (\n-                                        \"path2\",\n-                                        #2,\n-                                    ),\n-                                ),\n-                                prop: Constant(\n-                                    Str(\n-                                        Atom(\n-                                            \"basename\",\n-                                        ),\n-                                    ),\n-                                ),\n-                                args: [\n-                                    Value(\n-                                        FreeVar(\n-                                            \"__dirname\",\n-                                        ),\n-                                    ),\n-                                ],\n-                                ast_path: [\n-                                    Program(\n-                                        Script,\n-                                    ),\n-                                    Script(\n-                                        Body(\n-                                            7,\n-                                        ),\n-                                    ),\n-                                    Stmt(\n-                                        Decl,\n-                                    ),\n-                                    Decl(\n-                                        Var,\n-                                    ),\n-                                    VarDecl(\n-                                        Decls(\n-                                            0,\n-                                        ),\n-                                    ),\n-                                    VarDeclarator(\n-                                        Init,\n-                                    ),\n-                                    Expr(\n-                                        Arrow,\n-                                    ),\n-                                    ArrowExpr(\n-                                        Body,\n-                                    ),\n-                                    BlockStmtOrExpr(\n-                                        BlockStmt,\n-                                    ),\n-                                    BlockStmt(\n-                                        Stmts(\n-                                            0,\n-                                        ),\n-                                    ),\n-                                    Stmt(\n-                                        If,\n-                                    ),\n-                                    IfStmt(\n-                                        Test,\n-                                    ),\n-                                    Expr(\n-                                        Bin,\n-                                    ),\n-                                    BinExpr(\n-                                        Right,\n-                                    ),\n-                                    Expr(\n-                                        Paren,\n-                                    ),\n-                                    ParenExpr(\n-                                        Expr,\n-                                    ),\n-                                    Expr(\n-                                        Bin,\n-                                    ),\n-                                    BinExpr(\n-                                        Right,\n-                                    ),\n-                                    Expr(\n-                                        Bin,\n-                                    ),\n-                                    BinExpr(\n-                                        Left,\n-                                    ),\n-                                    Expr(\n-                                        Call,\n-                                    ),\n-                                ],\n-                                span: 2775..2800,\n-                                in_try: false,\n-                                new: false,\n-                            },\n-                        ],\n-                    },\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                7,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Arrow,\n-                        ),\n-                        ArrowExpr(\n-                            Body,\n-                        ),\n-                        BlockStmtOrExpr(\n-                            BlockStmt,\n-                        ),\n-                        BlockStmt(\n-                            Stmts(\n-                                0,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            If,\n-                        ),\n-                        IfStmt(\n-                            Test,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Paren,\n-                        ),\n-                        ParenExpr(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                    ],\n-                    span: 2725..2810,\n-                },\n-            ],\n-        },\n+        prop: Constant(\n+            Str(\n+                Atom(\n+                    \"basename\",\n+                ),\n+            ),\n+        ),\n+        args: [\n+            Value(\n+                FreeVar(\n+                    \"__filename\",\n+                ),\n+            ),\n+        ],\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    7,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                Arrow,\n+            ),\n+            ArrowExpr(\n+                Body,\n+            ),\n+            BlockStmtOrExpr(\n+                BlockStmt,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                If,\n+            ),\n+            IfStmt(\n+                Test,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Paren,\n+            ),\n+            ParenExpr(\n+                Expr,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Left,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Left,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+        ],\n+        span: 2725..2751,\n+        in_try: false,\n+        new: false,\n+    },\n+    Member {\n+        obj: Variable(\n+            (\n+                \"path2\",\n+                #2,\n+            ),\n+        ),\n+        prop: Constant(\n+            Str(\n+                Atom(\n+                    \"basename\",\n+                ),\n+            ),\n+        ),\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    7,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                Arrow,\n+            ),\n+            ArrowExpr(\n+                Body,\n+            ),\n+            BlockStmtOrExpr(\n+                BlockStmt,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                If,\n+            ),\n+            IfStmt(\n+                Test,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Paren,\n+            ),\n+            ParenExpr(\n+                Expr,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Left,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Callee,\n+            ),\n+            Callee(\n+                Expr,\n+            ),\n+            Expr(\n+                Member,\n+            ),\n+        ],\n+        span: 2775..2789,\n+    },\n+    FreeVar {\n+        var: \"__dirname\",\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    7,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                Arrow,\n+            ),\n+            ArrowExpr(\n+                Body,\n+            ),\n+            BlockStmtOrExpr(\n+                BlockStmt,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                If,\n+            ),\n+            IfStmt(\n+                Test,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Paren,\n+            ),\n+            ParenExpr(\n+                Expr,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Left,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Args(\n+                    0,\n+                ),\n+            ),\n+            ExprOrSpread(\n+                Expr,\n+            ),\n+            Expr(\n+                Ident,\n+            ),\n+        ],\n+        span: 2790..2799,\n+    },\n+    MemberCall {\n+        obj: Variable(\n+            (\n+                \"path2\",\n+                #2,\n+            ),\n+        ),\n+        prop: Constant(\n+            Str(\n+                Atom(\n+                    \"basename\",\n+                ),\n+            ),\n+        ),\n+        args: [\n+            Value(\n+                FreeVar(\n+                    \"__dirname\",\n+                ),\n+            ),\n+        ],\n         ast_path: [\n             Program(\n                 Script,\n@@ -797,11 +601,34 @@\n             Expr(\n                 Bin,\n             ),\n+            BinExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Paren,\n+            ),\n+            ParenExpr(\n+                Expr,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n+            BinExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Bin,\n+            ),\n             BinExpr(\n                 Left,\n             ),\n+            Expr(\n+                Call,\n+            ),\n         ],\n-        span: 2685..2811,\n+        span: 2775..2800,\n+        in_try: false,\n+        new: false,\n     },\n     Conditional {\n         condition: Logical("
        },
        {
            "sha": "505fe979cf64ce2460ff4d70f188b331d73b3adb",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/esbuild/resolved-effects.snapshot",
            "status": "modified",
            "additions": 61,
            "deletions": 75,
            "changes": 136,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fesbuild%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fesbuild%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fesbuild%2Fresolved-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -1,30 +1,16 @@\n 0 -> 1 free var = FreeVar(ESBUILD_BINARY_PATH)\n \n-0 -> 2 conditional = (!(???*0*) | false)\n-- *0* FreeVar(ESBUILD_BINARY_PATH)\n-    unknown global\n-    This value might have side effects\n-\n-2 -> 4 free var = FreeVar(__filename)\n+0 -> 3 free var = FreeVar(__filename)\n \n-2 -> 5 member call = path*0*[\"basename\"](\"__filename\")\n+0 -> 4 member call = path*0*[\"basename\"](\"__filename\")\n - *0* path: The Node.js path module: https://nodejs.org/api/path.html\n \n-2 -> 6 conditional = (???*0* !== \"main.js\")\n-- *0* ???*1*(\"__filename\")\n-    unknown callee\n-    This value might have side effects\n-- *1* path*2*[\"basename\"]\n-    unsupported property on Node.js path module\n-    This value might have side effects\n-- *2* path: The Node.js path module: https://nodejs.org/api/path.html\n+0 -> 6 free var = FreeVar(__dirname)\n \n-6 -> 8 free var = FreeVar(__dirname)\n-\n-6 -> 9 member call = path*0*[\"basename\"](\"__dirname\")\n+0 -> 7 member call = path*0*[\"basename\"](\"__dirname\")\n - *0* path: The Node.js path module: https://nodejs.org/api/path.html\n \n-0 -> 10 conditional = (!(???*0*) | false | (???*1* !== \"main.js\") | (???*4* !== \"lib\"))\n+0 -> 8 conditional = (!(???*0*) | false | (???*1* !== \"main.js\") | (???*4* !== \"lib\"))\n - *0* FreeVar(ESBUILD_BINARY_PATH)\n     unknown global\n     This value might have side effects\n@@ -43,35 +29,35 @@\n     This value might have side effects\n - *6* path: The Node.js path module: https://nodejs.org/api/path.html\n \n-10 -> 11 free var = FreeVar(Error)\n+8 -> 9 free var = FreeVar(Error)\n \n-10 -> 12 free var = FreeVar(__filename)\n+8 -> 10 free var = FreeVar(__filename)\n \n-10 -> 13 call = new ???*0*(\n+8 -> 11 call = new ???*0*(\n     \"The esbuild JavaScript API cannot be bundled. Please mark the \\\"esbuild\\\" package as external so it's not included in the bundle.\\n\\nMore information: The file containing the code for esbuild's JavaScript API (__filename) does not appear to be inside the esbuild package on the file system, which usually means that the esbuild package was bundled into another file. This is problematic because the API needs to run a binary executable inside the esbuild package which is located using a relative path from the API code to the executable. If the esbuild package is bundled, the relative path will be incorrect and the executable won't be found.\"\n )\n - *0* FreeVar(Error)\n     unknown global\n     This value might have side effects\n \n-0 -> 14 conditional = false\n+0 -> 12 conditional = false\n \n-14 -> 16 free var = FreeVar(__dirname)\n+12 -> 14 free var = FreeVar(__dirname)\n \n-14 -> 17 member call = path*0*[\"join\"](\"__dirname\", \"..\", \"bin\", \"esbuild\")\n+12 -> 15 member call = path*0*[\"join\"](\"__dirname\", \"..\", \"bin\", \"esbuild\")\n - *0* path: The Node.js path module: https://nodejs.org/api/path.html\n \n-14 -> 18 unreachable = ???*0*\n+12 -> 16 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-14 -> 19 call = (...) => (FreeVar(ESBUILD_BINARY_PATH) | binTargetPath | binPath)()\n+12 -> 17 call = (...) => (FreeVar(ESBUILD_BINARY_PATH) | binTargetPath | binPath)()\n \n-14 -> 20 unreachable = ???*0*\n+12 -> 18 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 21 call = (...) => (\n+0 -> 19 call = (...) => (\n   | [\n         \"node\",\n         [\n@@ -81,62 +67,62 @@\n   | [generateBinPath(), []]\n )()\n \n-0 -> 23 member call = ([\"bin/esbuild\"] | ???*0* | [])[\"concat\"](\"--service=0.14.12\", \"--ping\")\n+0 -> 21 member call = ([\"bin/esbuild\"] | ???*0* | [])[\"concat\"](\"--service=0.14.12\", \"--ping\")\n - *0* unknown mutation\n     This value might have side effects\n \n-0 -> 24 free var = FreeVar(require)\n+0 -> 22 free var = FreeVar(require)\n \n-0 -> 25 call = require*0*(\"path\")\n+0 -> 23 call = require*0*(\"path\")\n - *0* require: The require method from CommonJS\n \n-0 -> 26 free var = FreeVar(require)\n+0 -> 24 free var = FreeVar(require)\n \n-0 -> 27 call = require*0*(\"path\")\n+0 -> 25 call = require*0*(\"path\")\n - *0* require: The require method from CommonJS\n \n-0 -> 28 free var = FreeVar(require)\n+0 -> 26 free var = FreeVar(require)\n \n-0 -> 29 call = require*0*(\"os\")\n+0 -> 27 call = require*0*(\"os\")\n - *0* require: The require method from CommonJS\n \n-0 -> 31 free var = FreeVar(process)\n+0 -> 29 free var = FreeVar(process)\n \n-0 -> 33 member call = os*0*[\"arch\"]()\n+0 -> 31 member call = os*0*[\"arch\"]()\n - *0* os: The Node.js os module: https://nodejs.org/api/os.html\n \n-0 -> 35 member call = os*0*[\"endianness\"]()\n+0 -> 33 member call = os*0*[\"endianness\"]()\n - *0* os: The Node.js os module: https://nodejs.org/api/os.html\n \n-0 -> 38 free var = FreeVar(Error)\n+0 -> 36 free var = FreeVar(Error)\n \n-0 -> 39 call = new ???*0*(\"Unsupported platform: linux x64 LE\")\n+0 -> 37 call = new ???*0*(\"Unsupported platform: linux x64 LE\")\n - *0* FreeVar(Error)\n     unknown global\n     This value might have side effects\n \n-0 -> 40 unreachable = ???*0*\n+0 -> 38 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 41 free var = FreeVar(ESBUILD_BINARY_PATH)\n+0 -> 39 free var = FreeVar(ESBUILD_BINARY_PATH)\n \n-0 -> 42 conditional = ???*0*\n+0 -> 40 conditional = ???*0*\n - *0* FreeVar(ESBUILD_BINARY_PATH)\n     unknown global\n     This value might have side effects\n \n-42 -> 43 free var = FreeVar(ESBUILD_BINARY_PATH)\n+40 -> 41 free var = FreeVar(ESBUILD_BINARY_PATH)\n \n-42 -> 44 unreachable = ???*0*\n+40 -> 42 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-42 -> 45 call = (...) => {\"pkg\": pkg, \"subpath\": subpath}()\n+40 -> 43 call = (...) => {\"pkg\": pkg, \"subpath\": subpath}()\n \n-42 -> 47 free var = FreeVar(require)\n+40 -> 45 free var = FreeVar(require)\n \n-42 -> 48 member call = require*0*[\"resolve\"](\n+40 -> 46 member call = require*0*[\"resolve\"](\n     `${(???*1* | undefined | ???*2* | \"esbuild-linux-64\")}/${(???*3* | \"esbuild.exe\" | \"bin/esbuild\" | ???*4*)}`\n )\n - *0* require: The require method from CommonJS\n@@ -149,9 +135,9 @@\n - *4* unknown mutation\n     This value might have side effects\n \n-42 -> 49 free var = FreeVar(downloadedBinPath)\n+40 -> 47 free var = FreeVar(downloadedBinPath)\n \n-42 -> 50 call = ???*0*(\n+40 -> 48 call = ???*0*(\n     (???*1* | undefined | ???*2* | \"esbuild-linux-64\"),\n     (???*3* | \"esbuild.exe\" | \"bin/esbuild\" | ???*4*)\n )\n@@ -167,9 +153,9 @@\n - *4* unknown mutation\n     This value might have side effects\n \n-42 -> 52 free var = FreeVar(fs)\n+40 -> 50 free var = FreeVar(fs)\n \n-42 -> 53 member call = ???*0*[\"existsSync\"]((???*1* | ???*2* | ???*8*))\n+40 -> 51 member call = ???*0*[\"existsSync\"]((???*1* | ???*2* | ???*8*))\n - *0* FreeVar(fs)\n     unknown global\n     This value might have side effects\n@@ -196,26 +182,26 @@\n     unknown global\n     This value might have side effects\n \n-42 -> 54 conditional = !(???*0*)\n+40 -> 52 conditional = !(???*0*)\n - *0* ???*1*[\"existsSync\"](binPath)\n     unknown callee object\n     This value might have side effects\n - *1* FreeVar(fs)\n     unknown global\n     This value might have side effects\n \n-54 -> 56 free var = FreeVar(require)\n+52 -> 54 free var = FreeVar(require)\n \n-54 -> 57 member call = require*0*[\"resolve\"]((???*1* | undefined | ???*2* | \"esbuild-linux-64\"))\n+52 -> 55 member call = require*0*[\"resolve\"]((???*1* | undefined | ???*2* | \"esbuild-linux-64\"))\n - *0* require: The require method from CommonJS\n - *1* pkg\n     pattern without value\n - *2* unknown mutation\n     This value might have side effects\n \n-54 -> 58 free var = FreeVar(Error)\n+52 -> 56 free var = FreeVar(Error)\n \n-54 -> 59 call = new ???*0*(\n+52 -> 57 call = new ???*0*(\n     `The package \"${(???*1* | undefined | ???*2* | \"esbuild-linux-64\")}\" could not be found, and is needed by esbuild.\n \n If you are installing esbuild with npm, make sure that you don't specify the\n@@ -230,29 +216,29 @@ by esbuild to install the correct binary executable for your current platform.`\n - *2* unknown mutation\n     This value might have side effects\n \n-42 -> 60 free var = FreeVar(require)\n+40 -> 58 free var = FreeVar(require)\n \n-42 -> 61 call = require*0*(\"pnpapi\")\n+40 -> 59 call = require*0*(\"pnpapi\")\n - *0* require: The require method from CommonJS\n \n-42 -> 62 conditional = (false | true)\n+40 -> 60 conditional = (false | true)\n \n-62 -> 65 free var = FreeVar(require)\n+60 -> 63 free var = FreeVar(require)\n \n-62 -> 66 member call = require*0*[\"resolve\"](\"esbuild\")\n+60 -> 64 member call = require*0*[\"resolve\"](\"esbuild\")\n - *0* require: The require method from CommonJS\n \n-62 -> 67 member call = path*0*[\"dirname\"](\"\\\"esbuild\\\"/resolved/lib/index.js\")\n+60 -> 65 member call = path*0*[\"dirname\"](\"\\\"esbuild\\\"/resolved/lib/index.js\")\n - *0* path: The Node.js path module: https://nodejs.org/api/path.html\n \n-62 -> 70 member call = path*0*[\"basename\"]((???*1* | \"esbuild.exe\" | \"bin/esbuild\" | ???*2*))\n+60 -> 68 member call = path*0*[\"basename\"]((???*1* | \"esbuild.exe\" | \"bin/esbuild\" | ???*2*))\n - *0* path: The Node.js path module: https://nodejs.org/api/path.html\n - *1* subpath\n     pattern without value\n - *2* unknown mutation\n     This value might have side effects\n \n-62 -> 71 member call = path*0*[\"join\"](\n+60 -> 69 member call = path*0*[\"join\"](\n     \"\\\"esbuild\\\"/resolved/lib\",\n     `pnpapi-${(???*1* | undefined | ???*2* | \"esbuild-linux-64\")}-${???*3*}`\n )\n@@ -273,9 +259,9 @@ by esbuild to install the correct binary executable for your current platform.`\n - *7* unknown mutation\n     This value might have side effects\n \n-62 -> 73 free var = FreeVar(fs)\n+60 -> 71 free var = FreeVar(fs)\n \n-62 -> 74 member call = ???*0*[\"existsSync\"](\n+60 -> 72 member call = ???*0*[\"existsSync\"](\n     `\"esbuild\"/resolved/lib${(\"/\" | \"\")}pnpapi-${(???*1* | undefined | ???*2* | \"esbuild-linux-64\")}-${???*3*}`\n )\n - *0* FreeVar(fs)\n@@ -297,17 +283,17 @@ by esbuild to install the correct binary executable for your current platform.`\n - *7* unknown mutation\n     This value might have side effects\n \n-62 -> 75 conditional = !(???*0*)\n+60 -> 73 conditional = !(???*0*)\n - *0* ???*1*[\"existsSync\"](binTargetPath)\n     unknown callee object\n     This value might have side effects\n - *1* FreeVar(fs)\n     unknown global\n     This value might have side effects\n \n-75 -> 77 free var = FreeVar(fs)\n+73 -> 75 free var = FreeVar(fs)\n \n-75 -> 78 member call = ???*0*[\"copyFileSync\"](\n+73 -> 76 member call = ???*0*[\"copyFileSync\"](\n     (???*1* | ???*2* | ???*8*),\n     `\"esbuild\"/resolved/lib${(\"/\" | \"\")}pnpapi-${(???*10* | undefined | ???*11* | \"esbuild-linux-64\")}-${???*12*}`\n )\n@@ -354,9 +340,9 @@ by esbuild to install the correct binary executable for your current platform.`\n - *16* unknown mutation\n     This value might have side effects\n \n-75 -> 80 free var = FreeVar(fs)\n+73 -> 78 free var = FreeVar(fs)\n \n-75 -> 81 member call = ???*0*[\"chmodSync\"](\n+73 -> 79 member call = ???*0*[\"chmodSync\"](\n     `\"esbuild\"/resolved/lib${(\"/\" | \"\")}pnpapi-${(???*1* | undefined | ???*2* | \"esbuild-linux-64\")}-${???*3*}`,\n     493\n )\n@@ -379,10 +365,10 @@ by esbuild to install the correct binary executable for your current platform.`\n - *7* unknown mutation\n     This value might have side effects\n \n-62 -> 82 unreachable = ???*0*\n+60 -> 80 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-62 -> 83 unreachable = ???*0*\n+60 -> 81 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects"
        },
        {
            "sha": "5780c5dc560c01d496b42b7f41b07ba1a0ecd0fc",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/iife-2/graph-effects.snapshot",
            "status": "modified",
            "additions": 552,
            "deletions": 0,
            "changes": 552,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fiife-2%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fiife-2%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fiife-2%2Fgraph-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -604,6 +604,273 @@\n         ],\n         span: 155..162,\n     },\n+    Conditional {\n+        condition: Variable(\n+            (\n+                \"path\",\n+                #4,\n+            ),\n+        ),\n+        kind: Ternary {\n+            then: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Script,\n+                        ),\n+                        Script(\n+                            Body(\n+                                1,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Expr,\n+                        ),\n+                        ExprStmt(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Callee,\n+                        ),\n+                        Callee(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Paren,\n+                        ),\n+                        ParenExpr(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Fn,\n+                        ),\n+                        FnExpr(\n+                            Function,\n+                        ),\n+                        Function(\n+                            Body,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                0,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            For,\n+                        ),\n+                        ForStmt(\n+                            Body,\n+                        ),\n+                        Stmt(\n+                            Block,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                1,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Expr,\n+                        ),\n+                        ExprStmt(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                2,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Cons,\n+                        ),\n+                    ],\n+                ),\n+            },\n+            else: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Script,\n+                        ),\n+                        Script(\n+                            Body(\n+                                1,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Expr,\n+                        ),\n+                        ExprStmt(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Callee,\n+                        ),\n+                        Callee(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Paren,\n+                        ),\n+                        ParenExpr(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Fn,\n+                        ),\n+                        FnExpr(\n+                            Function,\n+                        ),\n+                        Function(\n+                            Body,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                0,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            For,\n+                        ),\n+                        ForStmt(\n+                            Body,\n+                        ),\n+                        Stmt(\n+                            Block,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                1,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Expr,\n+                        ),\n+                        ExprStmt(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                2,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Alt,\n+                        ),\n+                    ],\n+                ),\n+            },\n+        },\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    1,\n+                ),\n+            ),\n+            Stmt(\n+                Expr,\n+            ),\n+            ExprStmt(\n+                Expr,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Callee,\n+            ),\n+            Callee(\n+                Expr,\n+            ),\n+            Expr(\n+                Paren,\n+            ),\n+            ParenExpr(\n+                Expr,\n+            ),\n+            Expr(\n+                Fn,\n+            ),\n+            FnExpr(\n+                Function,\n+            ),\n+            Function(\n+                Body,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                For,\n+            ),\n+            ForStmt(\n+                Body,\n+            ),\n+            Stmt(\n+                Block,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    1,\n+                ),\n+            ),\n+            Stmt(\n+                Expr,\n+            ),\n+            ExprStmt(\n+                Expr,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Args(\n+                    2,\n+                ),\n+            ),\n+            ExprOrSpread(\n+                Expr,\n+            ),\n+            Expr(\n+                Cond,\n+            ),\n+            CondExpr(\n+                Test,\n+            ),\n+        ],\n+        span: 183..202,\n+    },\n     MemberCall {\n         obj: FreeVar(\n             \"console\",\n@@ -915,6 +1182,291 @@\n         ],\n         span: 224..238,\n     },\n+    Conditional {\n+        condition: Variable(\n+            (\n+                \"path\",\n+                #4,\n+            ),\n+        ),\n+        kind: Ternary {\n+            then: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Script,\n+                        ),\n+                        Script(\n+                            Body(\n+                                1,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Expr,\n+                        ),\n+                        ExprStmt(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Callee,\n+                        ),\n+                        Callee(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Paren,\n+                        ),\n+                        ParenExpr(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Fn,\n+                        ),\n+                        FnExpr(\n+                            Function,\n+                        ),\n+                        Function(\n+                            Body,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                0,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            For,\n+                        ),\n+                        ForStmt(\n+                            Body,\n+                        ),\n+                        Stmt(\n+                            Block,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                2,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Expr,\n+                        ),\n+                        ExprStmt(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Assign,\n+                        ),\n+                        AssignExpr(\n+                            Right,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                1,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Cons,\n+                        ),\n+                    ],\n+                ),\n+            },\n+            else: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Script,\n+                        ),\n+                        Script(\n+                            Body(\n+                                1,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Expr,\n+                        ),\n+                        ExprStmt(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Callee,\n+                        ),\n+                        Callee(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Paren,\n+                        ),\n+                        ParenExpr(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Fn,\n+                        ),\n+                        FnExpr(\n+                            Function,\n+                        ),\n+                        Function(\n+                            Body,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                0,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            For,\n+                        ),\n+                        ForStmt(\n+                            Body,\n+                        ),\n+                        Stmt(\n+                            Block,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                2,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Expr,\n+                        ),\n+                        ExprStmt(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Assign,\n+                        ),\n+                        AssignExpr(\n+                            Right,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                1,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Alt,\n+                        ),\n+                    ],\n+                ),\n+            },\n+        },\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    1,\n+                ),\n+            ),\n+            Stmt(\n+                Expr,\n+            ),\n+            ExprStmt(\n+                Expr,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Callee,\n+            ),\n+            Callee(\n+                Expr,\n+            ),\n+            Expr(\n+                Paren,\n+            ),\n+            ParenExpr(\n+                Expr,\n+            ),\n+            Expr(\n+                Fn,\n+            ),\n+            FnExpr(\n+                Function,\n+            ),\n+            Function(\n+                Body,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                For,\n+            ),\n+            ForStmt(\n+                Body,\n+            ),\n+            Stmt(\n+                Block,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    2,\n+                ),\n+            ),\n+            Stmt(\n+                Expr,\n+            ),\n+            ExprStmt(\n+                Expr,\n+            ),\n+            Expr(\n+                Assign,\n+            ),\n+            AssignExpr(\n+                Right,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Args(\n+                    1,\n+                ),\n+            ),\n+            ExprOrSpread(\n+                Expr,\n+            ),\n+            Expr(\n+                Cond,\n+            ),\n+            CondExpr(\n+                Test,\n+            ),\n+        ],\n+        span: 240..269,\n+    },\n     Member {\n         obj: Variable(\n             ("
        },
        {
            "sha": "b6786b7ce404793dd3997bd00fd41816de20961f",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/iife-2/resolved-effects.snapshot",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fiife-2%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fiife-2%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fiife-2%2Fresolved-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -7,7 +7,11 @@\n \n 0 -> 7 free var = FreeVar(console)\n \n-0 -> 8 member call = ???*0*[\"debug\"](\"####\", ???*1*, (???*2* ? true : false))\n+0 -> 8 conditional = ???*0*\n+- *0* arguments[1]\n+    function calls are not analyzed yet\n+\n+0 -> 9 member call = ???*0*[\"debug\"](\"####\", ???*1*, (???*2* ? true : false))\n - *0* FreeVar(console)\n     unknown global\n     This value might have side effects\n@@ -16,7 +20,11 @@\n - *2* arguments[1]\n     function calls are not analyzed yet\n \n-0 -> 12 call = (...) => parent(???*0*, (???*2* ? ???*3* : (???*10* | undefined)), (???*15* | {}){truthy})\n+0 -> 12 conditional = ???*0*\n+- *0* arguments[1]\n+    function calls are not analyzed yet\n+\n+0 -> 14 call = (...) => parent(???*0*, (???*2* ? ???*3* : (???*10* | undefined)), (???*15* | {}){truthy})\n - *0* ???*1*[key]\n     unknown object\n - *1* arguments[0]\n@@ -56,8 +64,8 @@\n - *16* arguments[2]\n     function calls are not analyzed yet\n \n-0 -> 13 unreachable = ???*0*\n+0 -> 15 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 14 call = (...) => parent({\"wrapper\": {\"data\": {\"key\": {}}}}, \"\", {})\n+0 -> 16 call = (...) => parent({\"wrapper\": {\"data\": {\"key\": {}}}}, \"\", {})"
        },
        {
            "sha": "2f5ccb98c50f80e8e32341b23c4cb5a3fa131a34",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/logical/graph-effects.snapshot",
            "status": "modified",
            "additions": 42,
            "deletions": 400,
            "changes": 442,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Flogical%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Flogical%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Flogical%2Fgraph-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -1,73 +1,6 @@\n [\n-    Conditional {\n-        condition: Logical(\n-            4,\n-            And,\n-            [\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            1.0,\n-                        ),\n-                    ),\n-                ),\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            2.0,\n-                        ),\n-                    ),\n-                ),\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            3.0,\n-                        ),\n-                    ),\n-                ),\n-            ],\n-        ),\n-        kind: And {\n-            rhs_effects: [\n-                FreeVar {\n-                    var: \"global\",\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                7,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Ident,\n-                        ),\n-                    ],\n-                    span: 132..138,\n-                },\n-            ],\n-        },\n+    FreeVar {\n+        var: \"global\",\n         ast_path: [\n             Program(\n                 Script,\n@@ -95,91 +28,16 @@\n                 Bin,\n             ),\n             BinExpr(\n-                Left,\n+                Right,\n+            ),\n+            Expr(\n+                Ident,\n             ),\n         ],\n-        span: 117..138,\n+        span: 132..138,\n     },\n-    Conditional {\n-        condition: Logical(\n-            3,\n-            And,\n-            [\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            1.0,\n-                        ),\n-                    ),\n-                ),\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            2.0,\n-                        ),\n-                    ),\n-                ),\n-            ],\n-        ),\n-        kind: And {\n-            rhs_effects: [\n-                FreeVar {\n-                    var: \"global\",\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                8,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Paren,\n-                        ),\n-                        ParenExpr(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Ident,\n-                        ),\n-                    ],\n-                    span: 164..170,\n-                },\n-            ],\n-        },\n+    FreeVar {\n+        var: \"global\",\n         ast_path: [\n             Program(\n                 Script,\n@@ -225,85 +83,16 @@\n                 Bin,\n             ),\n             BinExpr(\n-                Left,\n+                Right,\n+            ),\n+            Expr(\n+                Ident,\n             ),\n         ],\n-        span: 154..170,\n+        span: 164..170,\n     },\n-    Conditional {\n-        condition: Logical(\n-            3,\n-            And,\n-            [\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            1.0,\n-                        ),\n-                    ),\n-                ),\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            2.0,\n-                        ),\n-                    ),\n-                ),\n-            ],\n-        ),\n-        kind: And {\n-            rhs_effects: [\n-                FreeVar {\n-                    var: \"global\",\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                9,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Ident,\n-                        ),\n-                    ],\n-                    span: 208..214,\n-                },\n-            ],\n-        },\n+    FreeVar {\n+        var: \"global\",\n         ast_path: [\n             Program(\n                 Script,\n@@ -343,86 +132,16 @@\n                 Bin,\n             ),\n             BinExpr(\n-                Left,\n+                Right,\n+            ),\n+            Expr(\n+                Ident,\n             ),\n         ],\n-        span: 198..214,\n+        span: 208..214,\n     },\n-    Conditional {\n-        condition: Logical(\n-            4,\n-            And,\n-            [\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            1.0,\n-                        ),\n-                    ),\n-                ),\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            2.0,\n-                        ),\n-                    ),\n-                ),\n-                Constant(\n-                    Num(\n-                        ConstantNumber(\n-                            0.0,\n-                        ),\n-                    ),\n-                ),\n-            ],\n-        ),\n-        kind: And {\n-            rhs_effects: [\n-                FreeVar {\n-                    var: \"global\",\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                10,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Left,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Ident,\n-                        ),\n-                    ],\n-                    span: 256..262,\n-                },\n-            ],\n-        },\n+    FreeVar {\n+        var: \"global\",\n         ast_path: [\n             Program(\n                 Script,\n@@ -456,10 +175,13 @@\n                 Bin,\n             ),\n             BinExpr(\n-                Left,\n+                Right,\n+            ),\n+            Expr(\n+                Ident,\n             ),\n         ],\n-        span: 241..262,\n+        span: 256..262,\n     },\n     FreeVar {\n         var: \"global\",\n@@ -498,51 +220,8 @@\n         ],\n         span: 284..290,\n     },\n-    Conditional {\n-        condition: Constant(\n-            True,\n-        ),\n-        kind: Or {\n-            rhs_effects: [\n-                FreeVar {\n-                    var: \"global\",\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                12,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Ident,\n-                        ),\n-                    ],\n-                    span: 323..329,\n-                },\n-            ],\n-        },\n+    FreeVar {\n+        var: \"global\",\n         ast_path: [\n             Program(\n                 Script,\n@@ -570,10 +249,13 @@\n                 Bin,\n             ),\n             BinExpr(\n-                Left,\n+                Right,\n+            ),\n+            Expr(\n+                Ident,\n             ),\n         ],\n-        span: 315..329,\n+        span: 323..329,\n     },\n     FreeVar {\n         var: \"global\",\n@@ -612,51 +294,8 @@\n         ],\n         span: 346..352,\n     },\n-    Conditional {\n-        condition: Constant(\n-            False,\n-        ),\n-        kind: And {\n-            rhs_effects: [\n-                FreeVar {\n-                    var: \"global\",\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                14,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Decl,\n-                        ),\n-                        Decl(\n-                            Var,\n-                        ),\n-                        VarDecl(\n-                            Decls(\n-                                0,\n-                            ),\n-                        ),\n-                        VarDeclarator(\n-                            Init,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Ident,\n-                        ),\n-                    ],\n-                    span: 387..393,\n-                },\n-            ],\n-        },\n+    FreeVar {\n+        var: \"global\",\n         ast_path: [\n             Program(\n                 Script,\n@@ -684,9 +323,12 @@\n                 Bin,\n             ),\n             BinExpr(\n-                Left,\n+                Right,\n+            ),\n+            Expr(\n+                Ident,\n             ),\n         ],\n-        span: 378..393,\n+        span: 387..393,\n     },\n ]"
        },
        {
            "sha": "77a4a1371f0d78c045d12e014c06c56ac002bc9b",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/logical/resolved-effects.snapshot",
            "status": "modified",
            "additions": 8,
            "deletions": 20,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Flogical%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Flogical%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Flogical%2Fresolved-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -1,27 +1,15 @@\n-0 -> 1 conditional = 3\n+0 -> 1 free var = FreeVar(global)\n \n-1 -> 2 free var = FreeVar(global)\n+0 -> 2 free var = FreeVar(global)\n \n-0 -> 3 conditional = 2\n+0 -> 3 free var = FreeVar(global)\n \n-3 -> 4 free var = FreeVar(global)\n+0 -> 4 free var = FreeVar(global)\n \n-0 -> 5 conditional = 2\n+0 -> 5 free var = FreeVar(global)\n \n-5 -> 6 free var = FreeVar(global)\n+0 -> 6 free var = FreeVar(global)\n \n-0 -> 7 conditional = 0\n+0 -> 7 free var = FreeVar(global)\n \n-7 -> 8 free var = FreeVar(global)\n-\n-0 -> 9 free var = FreeVar(global)\n-\n-0 -> 10 conditional = true\n-\n-10 -> 11 free var = FreeVar(global)\n-\n-0 -> 12 free var = FreeVar(global)\n-\n-0 -> 13 conditional = false\n-\n-13 -> 14 free var = FreeVar(global)\n+0 -> 8 free var = FreeVar(global)"
        },
        {
            "sha": "b672909aa6efb5698f3be6660ac77a5adcd04996",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/md5_2/graph-effects.snapshot",
            "status": "modified",
            "additions": 47,
            "deletions": 361,
            "changes": 408,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fmd5_2%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fmd5_2%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fmd5_2%2Fgraph-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -1044,133 +1044,20 @@\n         kind: IfElse {\n             then: EffectsBlock {\n                 effects: [\n-                    Conditional {\n-                        condition: Variable(\n+                    Member {\n+                        obj: Variable(\n                             (\n                                 \"options\",\n                                 #4,\n                             ),\n                         ),\n-                        kind: And {\n-                            rhs_effects: [\n-                                Member {\n-                                    obj: Variable(\n-                                        (\n-                                            \"options\",\n-                                            #4,\n-                                        ),\n-                                    ),\n-                                    prop: Constant(\n-                                        Str(\n-                                            Atom(\n-                                                \"encoding\",\n-                                            ),\n-                                        ),\n-                                    ),\n-                                    ast_path: [\n-                                        Program(\n-                                            Script,\n-                                        ),\n-                                        Script(\n-                                            Body(\n-                                                0,\n-                                            ),\n-                                        ),\n-                                        Stmt(\n-                                            Expr,\n-                                        ),\n-                                        ExprStmt(\n-                                            Expr,\n-                                        ),\n-                                        Expr(\n-                                            Call,\n-                                        ),\n-                                        CallExpr(\n-                                            Callee,\n-                                        ),\n-                                        Callee(\n-                                            Expr,\n-                                        ),\n-                                        Expr(\n-                                            Paren,\n-                                        ),\n-                                        ParenExpr(\n-                                            Expr,\n-                                        ),\n-                                        Expr(\n-                                            Fn,\n-                                        ),\n-                                        FnExpr(\n-                                            Function,\n-                                        ),\n-                                        Function(\n-                                            Body,\n-                                        ),\n-                                        BlockStmt(\n-                                            Stmts(\n-                                                0,\n-                                            ),\n-                                        ),\n-                                        Stmt(\n-                                            Decl,\n-                                        ),\n-                                        Decl(\n-                                            Var,\n-                                        ),\n-                                        VarDecl(\n-                                            Decls(\n-                                                4,\n-                                            ),\n-                                        ),\n-                                        VarDeclarator(\n-                                            Init,\n-                                        ),\n-                                        Expr(\n-                                            Fn,\n-                                        ),\n-                                        FnExpr(\n-                                            Function,\n-                                        ),\n-                                        Function(\n-                                            Body,\n-                                        ),\n-                                        BlockStmt(\n-                                            Stmts(\n-                                                0,\n-                                            ),\n-                                        ),\n-                                        Stmt(\n-                                            If,\n-                                        ),\n-                                        IfStmt(\n-                                            Cons,\n-                                        ),\n-                                        Stmt(\n-                                            If,\n-                                        ),\n-                                        IfStmt(\n-                                            Test,\n-                                        ),\n-                                        Expr(\n-                                            Bin,\n-                                        ),\n-                                        BinExpr(\n-                                            Right,\n-                                        ),\n-                                        Expr(\n-                                            Bin,\n-                                        ),\n-                                        BinExpr(\n-                                            Left,\n-                                        ),\n-                                        Expr(\n-                                            Member,\n-                                        ),\n-                                    ],\n-                                    span: 306..322,\n-                                },\n-                            ],\n-                        },\n+                        prop: Constant(\n+                            Str(\n+                                Atom(\n+                                    \"encoding\",\n+                                ),\n+                            ),\n+                        ),\n                         ast_path: [\n                             Program(\n                                 Script,\n@@ -1258,11 +1145,20 @@\n                             Expr(\n                                 Bin,\n                             ),\n+                            BinExpr(\n+                                Right,\n+                            ),\n+                            Expr(\n+                                Bin,\n+                            ),\n                             BinExpr(\n                                 Left,\n                             ),\n+                            Expr(\n+                                Member,\n+                            ),\n                         ],\n-                        span: 295..335,\n+                        span: 306..322,\n                     },\n                     Conditional {\n                         condition: Logical(\n@@ -29539,125 +29435,20 @@\n         in_try: false,\n         new: false,\n     },\n-    Conditional {\n-        condition: Variable(\n+    Member {\n+        obj: Variable(\n             (\n                 \"options\",\n                 #11,\n             ),\n         ),\n-        kind: And {\n-            rhs_effects: [\n-                Member {\n-                    obj: Variable(\n-                        (\n-                            \"options\",\n-                            #11,\n-                        ),\n-                    ),\n-                    prop: Constant(\n-                        Str(\n-                            Atom(\n-                                \"asBytes\",\n-                            ),\n-                        ),\n-                    ),\n-                    ast_path: [\n-                        Program(\n-                            Script,\n-                        ),\n-                        Script(\n-                            Body(\n-                                0,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Expr,\n-                        ),\n-                        ExprStmt(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Call,\n-                        ),\n-                        CallExpr(\n-                            Callee,\n-                        ),\n-                        Callee(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Paren,\n-                        ),\n-                        ParenExpr(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Fn,\n-                        ),\n-                        FnExpr(\n-                            Function,\n-                        ),\n-                        Function(\n-                            Body,\n-                        ),\n-                        BlockStmt(\n-                            Stmts(\n-                                7,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Expr,\n-                        ),\n-                        ExprStmt(\n-                            Expr,\n-                        ),\n-                        Expr(\n-                            Assign,\n-                        ),\n-                        AssignExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Fn,\n-                        ),\n-                        FnExpr(\n-                            Function,\n-                        ),\n-                        Function(\n-                            Body,\n-                        ),\n-                        BlockStmt(\n-                            Stmts(\n-                                2,\n-                            ),\n-                        ),\n-                        Stmt(\n-                            Return,\n-                        ),\n-                        ReturnStmt(\n-                            Arg,\n-                        ),\n-                        Expr(\n-                            Cond,\n-                        ),\n-                        CondExpr(\n-                            Test,\n-                        ),\n-                        Expr(\n-                            Bin,\n-                        ),\n-                        BinExpr(\n-                            Right,\n-                        ),\n-                        Expr(\n-                            Member,\n-                        ),\n-                    ],\n-                    span: 5908..5923,\n-                },\n-            ],\n-        },\n+        prop: Constant(\n+            Str(\n+                Atom(\n+                    \"asBytes\",\n+                ),\n+            ),\n+        ),\n         ast_path: [\n             Program(\n                 Script,\n@@ -29744,10 +29535,13 @@\n                 Bin,\n             ),\n             BinExpr(\n-                Left,\n+                Right,\n+            ),\n+            Expr(\n+                Member,\n             ),\n         ],\n-        span: 5897..5923,\n+        span: 5908..5923,\n     },\n     Conditional {\n         condition: Logical(\n@@ -29869,131 +29663,20 @@\n             },\n             else: EffectsBlock {\n                 effects: [\n-                    Conditional {\n-                        condition: Variable(\n+                    Member {\n+                        obj: Variable(\n                             (\n                                 \"options\",\n                                 #11,\n                             ),\n                         ),\n-                        kind: And {\n-                            rhs_effects: [\n-                                Member {\n-                                    obj: Variable(\n-                                        (\n-                                            \"options\",\n-                                            #11,\n-                                        ),\n-                                    ),\n-                                    prop: Constant(\n-                                        Str(\n-                                            Atom(\n-                                                \"asString\",\n-                                            ),\n-                                        ),\n-                                    ),\n-                                    ast_path: [\n-                                        Program(\n-                                            Script,\n-                                        ),\n-                                        Script(\n-                                            Body(\n-                                                0,\n-                                            ),\n-                                        ),\n-                                        Stmt(\n-                                            Expr,\n-                                        ),\n-                                        ExprStmt(\n-                                            Expr,\n-                                        ),\n-                                        Expr(\n-                                            Call,\n-                                        ),\n-                                        CallExpr(\n-                                            Callee,\n-                                        ),\n-                                        Callee(\n-                                            Expr,\n-                                        ),\n-                                        Expr(\n-                                            Paren,\n-                                        ),\n-                                        ParenExpr(\n-                                            Expr,\n-                                        ),\n-                                        Expr(\n-                                            Fn,\n-                                        ),\n-                                        FnExpr(\n-                                            Function,\n-                                        ),\n-                                        Function(\n-                                            Body,\n-                                        ),\n-                                        BlockStmt(\n-                                            Stmts(\n-                                                7,\n-                                            ),\n-                                        ),\n-                                        Stmt(\n-                                            Expr,\n-                                        ),\n-                                        ExprStmt(\n-                                            Expr,\n-                                        ),\n-                                        Expr(\n-                                            Assign,\n-                                        ),\n-                                        AssignExpr(\n-                                            Right,\n-                                        ),\n-                                        Expr(\n-                                            Fn,\n-                                        ),\n-                                        FnExpr(\n-                                            Function,\n-                                        ),\n-                                        Function(\n-                                            Body,\n-                                        ),\n-                                        BlockStmt(\n-                                            Stmts(\n-                                                2,\n-                                            ),\n-                                        ),\n-                                        Stmt(\n-                                            Return,\n-                                        ),\n-                                        ReturnStmt(\n-                                            Arg,\n-                                        ),\n-                                        Expr(\n-                                            Cond,\n-                                        ),\n-                                        CondExpr(\n-                                            Alt,\n-                                        ),\n-                                        Expr(\n-                                            Cond,\n-                                        ),\n-                                        CondExpr(\n-                                            Test,\n-                                        ),\n-                                        Expr(\n-                                            Bin,\n-                                        ),\n-                                        BinExpr(\n-                                            Right,\n-                                        ),\n-                                        Expr(\n-                                            Member,\n-                                        ),\n-                                    ],\n-                                    span: 5963..5979,\n-                                },\n-                            ],\n-                        },\n+                        prop: Constant(\n+                            Str(\n+                                Atom(\n+                                    \"asString\",\n+                                ),\n+                            ),\n+                        ),\n                         ast_path: [\n                             Program(\n                                 Script,\n@@ -30086,10 +29769,13 @@\n                                 Bin,\n                             ),\n                             BinExpr(\n-                                Left,\n+                                Right,\n+                            ),\n+                            Expr(\n+                                Member,\n                             ),\n                         ],\n-                        span: 5952..5979,\n+                        span: 5963..5979,\n                     },\n                     Conditional {\n                         condition: Logical("
        },
        {
            "sha": "87a788234b7d09b94adef364cc7e790adeb59f4d",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/md5_2/resolved-effects.snapshot",
            "status": "modified",
            "additions": 93,
            "deletions": 105,
            "changes": 198,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fmd5_2%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fmd5_2%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fmd5_2%2Fresolved-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -44,19 +44,15 @@\n     unknown global\n     This value might have side effects\n \n-13 -> 14 conditional = ???*0*\n-- *0* arguments[1]\n-    function calls are not analyzed yet\n-\n-13 -> 16 conditional = (???*0* | (???*1* === \"binary\"))\n+13 -> 15 conditional = (???*0* | (???*1* === \"binary\"))\n - *0* arguments[1]\n     function calls are not analyzed yet\n - *1* ???*2*[\"encoding\"]\n     unknown object\n - *2* arguments[1]\n     function calls are not analyzed yet\n \n-16 -> 18 member call = module<charenc, {}>[\"bin\"][\"stringToBytes\"](\n+15 -> 17 member call = module<charenc, {}>[\"bin\"][\"stringToBytes\"](\n     (\n       | ???*0*\n       | module<charenc, {}>[\"bin\"][\"stringToBytes\"](???*1*)\n@@ -88,7 +84,7 @@\n - *8* message\n     circular variable reference\n \n-16 -> 20 member call = module<charenc, {}>[\"utf8\"][\"stringToBytes\"](\n+15 -> 19 member call = module<charenc, {}>[\"utf8\"][\"stringToBytes\"](\n     (\n       | ???*0*\n       | module<charenc, {}>[\"bin\"][\"stringToBytes\"](???*1*)\n@@ -120,7 +116,7 @@\n - *8* message\n     circular variable reference\n \n-13 -> 21 call = module<is-buffer, {}>(\n+13 -> 20 call = module<is-buffer, {}>(\n     (\n       | ???*0*\n       | module<charenc, {}>[\"bin\"][\"stringToBytes\"](???*1*)\n@@ -152,7 +148,7 @@\n - *8* message\n     circular variable reference\n \n-13 -> 22 conditional = module<is-buffer, {}>((???*0* | ???*1* | ???*3*))\n+13 -> 21 conditional = module<is-buffer, {}>((???*0* | ???*1* | ???*3*))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* module<charenc, {}>[\"bin\"][\"stringToBytes\"](???*2*)\n@@ -172,9 +168,9 @@\n     unknown global\n     This value might have side effects\n \n-22 -> 26 free var = FreeVar(Array)\n+21 -> 25 free var = FreeVar(Array)\n \n-22 -> 27 member call = ???*0*[\"call\"](\n+21 -> 26 member call = ???*0*[\"call\"](\n     (\n       | ???*3*\n       | module<charenc, {}>[\"bin\"][\"stringToBytes\"](???*4*)\n@@ -216,9 +212,9 @@\n - *11* message\n     circular variable reference\n \n-22 -> 29 free var = FreeVar(Array)\n+21 -> 28 free var = FreeVar(Array)\n \n-22 -> 30 member call = ???*0*[\"isArray\"](\n+21 -> 29 member call = ???*0*[\"isArray\"](\n     (\n       | ???*1*\n       | module<charenc, {}>[\"bin\"][\"stringToBytes\"](???*2*)\n@@ -253,15 +249,15 @@\n - *9* message\n     circular variable reference\n \n-22 -> 31 conditional = !(???*0*)\n+21 -> 30 conditional = !(???*0*)\n - *0* ???*1*[\"isArray\"](message)\n     unknown callee object\n     This value might have side effects\n - *1* FreeVar(Array)\n     unknown global\n     This value might have side effects\n \n-31 -> 33 member call = (\n+30 -> 32 member call = (\n   | ???*0*\n   | module<charenc, {}>[\"bin\"][\"stringToBytes\"](???*1*)\n   | module<charenc, {}>[\"utf8\"][\"stringToBytes\"](???*2*)\n@@ -291,7 +287,7 @@\n - *8* message\n     circular variable reference\n \n-0 -> 35 member call = module<crypt, {}>[\"bytesToWords\"](\n+0 -> 34 member call = module<crypt, {}>[\"bytesToWords\"](\n     (\n       | ???*0*\n       | module<charenc, {}>[\"bin\"][\"stringToBytes\"](???*1*)\n@@ -323,7 +319,7 @@\n - *8* message\n     circular variable reference\n \n-0 -> 51 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 50 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -367,7 +363,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 53 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 52 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -411,7 +407,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 55 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 54 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -453,7 +449,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 57 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 56 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -497,7 +493,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 59 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 58 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -541,7 +537,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 61 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 60 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -583,7 +579,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 63 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 62 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -627,7 +623,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 65 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 64 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -671,7 +667,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 67 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 66 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -713,7 +709,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 69 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 68 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -757,7 +753,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 71 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 70 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -801,7 +797,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 73 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 72 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -845,7 +841,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 75 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 74 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -887,7 +883,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 77 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 76 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -931,7 +927,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 79 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 78 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -975,7 +971,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 81 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n+0 -> 80 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ff\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1017,7 +1013,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 83 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 82 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1061,7 +1057,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 85 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 84 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1105,7 +1101,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 87 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 86 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1147,7 +1143,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 89 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 88 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1191,7 +1187,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 91 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 90 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1235,7 +1231,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 93 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 92 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1277,7 +1273,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 95 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 94 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1321,7 +1317,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 97 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 96 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1365,7 +1361,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 99 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 98 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1407,7 +1403,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 101 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 100 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1451,7 +1447,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 103 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 102 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1495,7 +1491,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 105 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 104 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1537,7 +1533,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 107 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 106 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1581,7 +1577,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 109 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 108 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1625,7 +1621,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 111 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 110 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1667,7 +1663,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 113 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n+0 -> 112 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_gg\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1711,7 +1707,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 115 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 114 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1755,7 +1751,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 117 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 116 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1799,7 +1795,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 119 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 118 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1841,7 +1837,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 121 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 120 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1885,7 +1881,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 123 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 122 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1929,7 +1925,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 125 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 124 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -1971,7 +1967,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 127 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 126 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2015,7 +2011,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 129 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 128 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2059,7 +2055,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 131 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 130 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2101,7 +2097,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 133 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 132 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2145,7 +2141,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 135 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 134 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2189,7 +2185,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 137 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 136 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2231,7 +2227,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 139 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 138 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2275,7 +2271,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 141 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 140 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2319,7 +2315,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 143 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 142 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2361,7 +2357,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 145 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n+0 -> 144 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_hh\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2405,7 +2401,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 147 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 146 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2449,7 +2445,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 149 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 148 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2491,7 +2487,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 151 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 150 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2535,7 +2531,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 153 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 152 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2579,7 +2575,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 155 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 154 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2621,7 +2617,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 157 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 156 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2665,7 +2661,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 159 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 158 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2709,7 +2705,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 161 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 160 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2753,7 +2749,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 163 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 162 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2795,7 +2791,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 165 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 164 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2839,7 +2835,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 167 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 166 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2883,7 +2879,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 169 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 168 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2925,7 +2921,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 171 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 170 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -2969,7 +2965,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 173 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 172 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -3013,7 +3009,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 175 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 174 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -3055,7 +3051,7 @@\n - *13* i\n     circular variable reference\n \n-0 -> 177 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n+0 -> 176 call = (...) => crypt[\"endian\"]([a, b, c, d])[\"_ii\"](\n     ???*0*,\n     ???*1*,\n     ???*2*,\n@@ -3099,7 +3095,7 @@\n - *14* unsupported expression\n     This value might have side effects\n \n-0 -> 179 member call = module<crypt, {}>[\"endian\"]([???*0*, ???*1*, ???*2*, ???*3*])\n+0 -> 178 member call = module<crypt, {}>[\"endian\"]([???*0*, ???*1*, ???*2*, ???*3*])\n - *0* max number of linking steps reached\n     This value might have side effects\n - *1* max number of linking steps reached\n@@ -3109,85 +3105,77 @@\n - *3* max number of linking steps reached\n     This value might have side effects\n \n-0 -> 180 unreachable = ???*0*\n+0 -> 179 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 182 unreachable = ???*0*\n+0 -> 181 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 184 unreachable = ???*0*\n+0 -> 183 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 186 unreachable = ???*0*\n+0 -> 185 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 188 unreachable = ???*0*\n+0 -> 187 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 192 free var = FreeVar(module)\n+0 -> 191 free var = FreeVar(module)\n \n-0 -> 193 conditional = ((???*0* === undefined) | (???*1* === null))\n+0 -> 192 conditional = ((???*0* === undefined) | (???*1* === null))\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* arguments[0]\n     function calls are not analyzed yet\n \n-193 -> 194 free var = FreeVar(Error)\n+192 -> 193 free var = FreeVar(Error)\n \n-193 -> 195 call = new ???*0*(`Illegal argument ${???*1*}`)\n+192 -> 194 call = new ???*0*(`Illegal argument ${???*1*}`)\n - *0* FreeVar(Error)\n     unknown global\n     This value might have side effects\n - *1* arguments[0]\n     function calls are not analyzed yet\n \n-0 -> 197 call = (...) => crypt[\"endian\"]([a, b, c, d])(???*0*, ???*1*)\n+0 -> 196 call = (...) => crypt[\"endian\"]([a, b, c, d])(???*0*, ???*1*)\n - *0* arguments[0]\n     function calls are not analyzed yet\n - *1* arguments[1]\n     function calls are not analyzed yet\n \n-0 -> 198 member call = module<crypt, {}>[\"wordsToBytes\"](???*0*)\n+0 -> 197 member call = module<crypt, {}>[\"wordsToBytes\"](???*0*)\n - *0* max number of linking steps reached\n     This value might have side effects\n \n-0 -> 199 conditional = ???*0*\n-- *0* arguments[1]\n-    function calls are not analyzed yet\n-\n-0 -> 201 conditional = (???*0* | ???*1*)\n+0 -> 199 conditional = (???*0* | ???*1*)\n - *0* arguments[1]\n     function calls are not analyzed yet\n - *1* ???*2*[\"asBytes\"]\n     unknown object\n - *2* arguments[1]\n     function calls are not analyzed yet\n \n-201 -> 202 conditional = ???*0*\n-- *0* arguments[1]\n-    function calls are not analyzed yet\n-\n-201 -> 204 conditional = (???*0* | ???*1*)\n+199 -> 201 conditional = (???*0* | ???*1*)\n - *0* arguments[1]\n     function calls are not analyzed yet\n - *1* ???*2*[\"asString\"]\n     unknown object\n - *2* arguments[1]\n     function calls are not analyzed yet\n \n-204 -> 206 member call = module<charenc, {}>[\"bin\"][\"bytesToString\"](???*0*)\n+201 -> 203 member call = module<charenc, {}>[\"bin\"][\"bytesToString\"](???*0*)\n - *0* max number of linking steps reached\n     This value might have side effects\n \n-204 -> 208 member call = module<crypt, {}>[\"bytesToHex\"](???*0*)\n+201 -> 205 member call = module<crypt, {}>[\"bytesToHex\"](???*0*)\n - *0* max number of linking steps reached\n     This value might have side effects\n \n-0 -> 209 unreachable = ???*0*\n+0 -> 206 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects"
        },
        {
            "sha": "7762bc0ad4cb44c8af596365bffd6cdbc7d5b2f3",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/op-assign/graph-effects.snapshot",
            "status": "modified",
            "additions": 191,
            "deletions": 0,
            "changes": 191,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fop-assign%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fop-assign%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fop-assign%2Fgraph-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -1171,6 +1171,197 @@\n             ),\n         ],\n     },\n+    Conditional {\n+        condition: Binary(\n+            3,\n+            Variable(\n+                (\n+                    \"clientComponentLoadTimes\",\n+                    #2,\n+                ),\n+            ),\n+            StrictEqual,\n+            Constant(\n+                Num(\n+                    ConstantNumber(\n+                        0.0,\n+                    ),\n+                ),\n+            ),\n+        ),\n+        kind: Ternary {\n+            then: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Module,\n+                        ),\n+                        Module(\n+                            Body(\n+                                2,\n+                            ),\n+                        ),\n+                        ModuleItem(\n+                            ModuleDecl,\n+                        ),\n+                        ModuleDecl(\n+                            ExportDecl,\n+                        ),\n+                        ExportDecl(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Fn,\n+                        ),\n+                        FnDecl(\n+                            Function,\n+                        ),\n+                        Function(\n+                            Body,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                0,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Var,\n+                        ),\n+                        VarDecl(\n+                            Decls(\n+                                0,\n+                            ),\n+                        ),\n+                        VarDeclarator(\n+                            Init,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Cons,\n+                        ),\n+                    ],\n+                ),\n+            },\n+            else: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Module,\n+                        ),\n+                        Module(\n+                            Body(\n+                                2,\n+                            ),\n+                        ),\n+                        ModuleItem(\n+                            ModuleDecl,\n+                        ),\n+                        ModuleDecl(\n+                            ExportDecl,\n+                        ),\n+                        ExportDecl(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Fn,\n+                        ),\n+                        FnDecl(\n+                            Function,\n+                        ),\n+                        Function(\n+                            Body,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                0,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Var,\n+                        ),\n+                        VarDecl(\n+                            Decls(\n+                                0,\n+                            ),\n+                        ),\n+                        VarDeclarator(\n+                            Init,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Alt,\n+                        ),\n+                    ],\n+                ),\n+            },\n+        },\n+        ast_path: [\n+            Program(\n+                Module,\n+            ),\n+            Module(\n+                Body(\n+                    2,\n+                ),\n+            ),\n+            ModuleItem(\n+                ModuleDecl,\n+            ),\n+            ModuleDecl(\n+                ExportDecl,\n+            ),\n+            ExportDecl(\n+                Decl,\n+            ),\n+            Decl(\n+                Fn,\n+            ),\n+            FnDecl(\n+                Function,\n+            ),\n+            Function(\n+                Body,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                Cond,\n+            ),\n+            CondExpr(\n+                Test,\n+            ),\n+        ],\n+        span: 496..600,\n+    },\n     Member {\n         obj: Variable(\n             ("
        },
        {
            "sha": "a4c478756a2ebbba64e74e2860fae4a8ed7f7311",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/op-assign/resolved-effects.snapshot",
            "status": "modified",
            "additions": 9,
            "deletions": 1,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fop-assign%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fop-assign%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fop-assign%2Fresolved-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -28,6 +28,14 @@\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 13 unreachable = ???*0*\n+0 -> 12 conditional = ((0 | ???*0*) === 0)\n+- *0* (???*1* + ???*2*)\n+    nested operation\n+- *1* clientComponentLoadTimes\n+    circular variable reference\n+- *2* unsupported expression\n+    This value might have side effects\n+\n+0 -> 14 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects"
        },
        {
            "sha": "ca08c718a22a91b29b3e305af67c479c1c0b17e3",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/pack-2682/graph-effects.snapshot",
            "status": "modified",
            "additions": 266,
            "deletions": 0,
            "changes": 266,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fpack-2682%2Fgraph-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fpack-2682%2Fgraph-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fpack-2682%2Fgraph-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -350,6 +350,272 @@\n         ],\n         span: 273..277,\n     },\n+    Conditional {\n+        condition: Binary(\n+            3,\n+            Variable(\n+                (\n+                    \"variable\",\n+                    #3,\n+                ),\n+            ),\n+            StrictEqual,\n+            Constant(\n+                Str(\n+                    Atom(\n+                        \"true\",\n+                    ),\n+                ),\n+            ),\n+        ),\n+        kind: Ternary {\n+            then: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Script,\n+                        ),\n+                        Script(\n+                            Body(\n+                                0,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Var,\n+                        ),\n+                        VarDecl(\n+                            Decls(\n+                                0,\n+                            ),\n+                        ),\n+                        VarDeclarator(\n+                            Init,\n+                        ),\n+                        Expr(\n+                            Arrow,\n+                        ),\n+                        ArrowExpr(\n+                            Body,\n+                        ),\n+                        BlockStmtOrExpr(\n+                            BlockStmt,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                1,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Return,\n+                        ),\n+                        ReturnStmt(\n+                            Arg,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                0,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Object,\n+                        ),\n+                        ObjectLit(\n+                            Props(\n+                                1,\n+                            ),\n+                        ),\n+                        PropOrSpread(\n+                            Prop,\n+                        ),\n+                        Prop(\n+                            KeyValue,\n+                        ),\n+                        KeyValueProp(\n+                            Value,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Cons,\n+                        ),\n+                    ],\n+                ),\n+            },\n+            else: EffectsBlock {\n+                effects: [],\n+                range: Exact(\n+                    [\n+                        Program(\n+                            Script,\n+                        ),\n+                        Script(\n+                            Body(\n+                                0,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Decl,\n+                        ),\n+                        Decl(\n+                            Var,\n+                        ),\n+                        VarDecl(\n+                            Decls(\n+                                0,\n+                            ),\n+                        ),\n+                        VarDeclarator(\n+                            Init,\n+                        ),\n+                        Expr(\n+                            Arrow,\n+                        ),\n+                        ArrowExpr(\n+                            Body,\n+                        ),\n+                        BlockStmtOrExpr(\n+                            BlockStmt,\n+                        ),\n+                        BlockStmt(\n+                            Stmts(\n+                                1,\n+                            ),\n+                        ),\n+                        Stmt(\n+                            Return,\n+                        ),\n+                        ReturnStmt(\n+                            Arg,\n+                        ),\n+                        Expr(\n+                            Call,\n+                        ),\n+                        CallExpr(\n+                            Args(\n+                                0,\n+                            ),\n+                        ),\n+                        ExprOrSpread(\n+                            Expr,\n+                        ),\n+                        Expr(\n+                            Object,\n+                        ),\n+                        ObjectLit(\n+                            Props(\n+                                1,\n+                            ),\n+                        ),\n+                        PropOrSpread(\n+                            Prop,\n+                        ),\n+                        Prop(\n+                            KeyValue,\n+                        ),\n+                        KeyValueProp(\n+                            Value,\n+                        ),\n+                        Expr(\n+                            Cond,\n+                        ),\n+                        CondExpr(\n+                            Alt,\n+                        ),\n+                    ],\n+                ),\n+            },\n+        },\n+        ast_path: [\n+            Program(\n+                Script,\n+            ),\n+            Script(\n+                Body(\n+                    0,\n+                ),\n+            ),\n+            Stmt(\n+                Decl,\n+            ),\n+            Decl(\n+                Var,\n+            ),\n+            VarDecl(\n+                Decls(\n+                    0,\n+                ),\n+            ),\n+            VarDeclarator(\n+                Init,\n+            ),\n+            Expr(\n+                Arrow,\n+            ),\n+            ArrowExpr(\n+                Body,\n+            ),\n+            BlockStmtOrExpr(\n+                BlockStmt,\n+            ),\n+            BlockStmt(\n+                Stmts(\n+                    1,\n+                ),\n+            ),\n+            Stmt(\n+                Return,\n+            ),\n+            ReturnStmt(\n+                Arg,\n+            ),\n+            Expr(\n+                Call,\n+            ),\n+            CallExpr(\n+                Args(\n+                    0,\n+                ),\n+            ),\n+            ExprOrSpread(\n+                Expr,\n+            ),\n+            Expr(\n+                Object,\n+            ),\n+            ObjectLit(\n+                Props(\n+                    1,\n+                ),\n+            ),\n+            PropOrSpread(\n+                Prop,\n+            ),\n+            Prop(\n+                KeyValue,\n+            ),\n+            KeyValueProp(\n+                Value,\n+            ),\n+            Expr(\n+                Cond,\n+            ),\n+            CondExpr(\n+                Test,\n+            ),\n+        ],\n+        span: 354..392,\n+    },\n     MemberCall {\n         obj: FreeVar(\n             \"JSON\","
        },
        {
            "sha": "aa385a0d51645aaf49f8f7e6d81cd28d5f4e7e45",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/pack-2682/resolved-effects.snapshot",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fpack-2682%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fpack-2682%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fpack-2682%2Fresolved-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -7,7 +7,13 @@\n \n 0 -> 5 free var = FreeVar(JSON)\n \n-0 -> 6 member call = ???*0*[\"stringify\"](\n+0 -> 6 conditional = ((???*0* | \"true\") === \"true\")\n+- *0* ???*1*[\"variable\"]\n+    unknown object\n+- *1* arguments[0]\n+    function calls are not analyzed yet\n+\n+0 -> 7 member call = ???*0*[\"stringify\"](\n     {\n         \"condition\": ((???*1* | \"true\") === \"true\"),\n         \"buggedConditionalCheck\": (???*3* ? \"true\" : \"false\")\n@@ -27,11 +33,11 @@\n - *5* arguments[0]\n     function calls are not analyzed yet\n \n-0 -> 7 unreachable = ???*0*\n+0 -> 8 unreachable = ???*0*\n - *0* unreachable\n     This value might have side effects\n \n-0 -> 8 call = (...) => FreeVar(JSON)[\"stringify\"](\n+0 -> 9 call = (...) => FreeVar(JSON)[\"stringify\"](\n     {\n         \"condition\": (variable === \"true\"),\n         \"buggedConditionalCheck\": ((variable === \"true\") ? \"true\" : \"false\")"
        },
        {
            "sha": "99d659be9305adb5fae135b5b7a778a5cb9734c8",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/peg/resolved-effects.snapshot",
            "status": "modified",
            "additions": 2015,
            "deletions": 1997,
            "changes": 4012,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fpeg%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fpeg%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Fpeg%2Fresolved-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959"
        },
        {
            "sha": "5efea665bd5d91d9a73040bbc7c77d0029d94acb",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/analyzer/graph/react-dom-production/resolved-effects.snapshot",
            "status": "modified",
            "additions": 4931,
            "deletions": 14823,
            "changes": 19754,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fresolved-effects.snapshot",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fresolved-effects.snapshot",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Fanalyzer%2Fgraph%2Freact-dom-production%2Fresolved-effects.snapshot?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959"
        },
        {
            "sha": "ffa37ae63444da182d6d3efd3fa68cdfae0a0a3b",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/input/index.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Finput%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Finput%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Finput%2Findex.js?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -56,6 +56,7 @@ p.env.NODE_ENV == 'production'\n   ? console.log('production')\n   : console.log('development')\n \n+// TODO short-circuit is not implemented yet\n p.env.NODE_ENV != 'production' && console.log('development')\n p.env.NODE_ENV == 'production' && console.log('production')\n "
        },
        {
            "sha": "d07ae9dc35135a7784bec779ae2734aef261e33c",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/output/aaf3a_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_aec19b5a.js",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_aec19b5a.js",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_aec19b5a.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_aec19b5a.js?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -54,8 +54,9 @@ console.log((\"TURBOPACK compile-time value\", \"development\"));\n if (\"TURBOPACK compile-time falsy\", 0) //TURBOPACK unreachable\n ;\n (\"TURBOPACK compile-time falsy\", 0) ? \"TURBOPACK unreachable\" : console.log('development');\n-\"TURBOPACK simplified expression\", console.log('development');\n-\"TURBOPACK simplified expression\", (\"TURBOPACK compile-time value\", \"development\") == 'production';\n+// TODO short-circuit is not implemented yet\n+(\"TURBOPACK compile-time value\", \"development\") != 'production' && console.log('development');\n+(\"TURBOPACK compile-time value\", \"development\") == 'production' && console.log('production');\n console.log((\"TURBOPACK compile-time value\", \"/ROOT/turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/input\"));\n }),\n ]);"
        },
        {
            "sha": "1cca7f90cce6b53340ff3612d327160c207bdff0",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/output/aaf3a_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_aec19b5a.js.map",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_aec19b5a.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/78f6bea72f5a99ac63e237f464653ea66e1bf959/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_aec19b5a.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fcomptime%2Fdefine%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_comptime_define_input_index_aec19b5a.js.map?ref=78f6bea72f5a99ac63e237f464653ea66e1bf959",
            "patch": "@@ -2,5 +2,5 @@\n   \"version\": 3,\n   \"sources\": [],\n   \"sections\": [\n-    {\"offset\": {\"line\": 3, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/input/index.js\"],\"sourcesContent\":[\"if (DEFINED_VALUE) {\\n  console.log('DEFINED_VALUE')\\n}\\n\\nif (DEFINED_TRUE) {\\n  console.log('DEFINED_VALUE')\\n}\\n\\nif (!DEFINED_NULL) {\\n  console.log('DEFINED_NULL', DEFINED_NULL)\\n}\\n\\nif (DEFINED_INT) {\\n  console.log('DEFINED_INT', DEFINED_INT)\\n}\\n\\nif (DEFINED_FLOAT) {\\n  console.log('DEFINED_FLOAT', DEFINED_FLOAT)\\n}\\n\\nif (DEFINED_ARRAY) {\\n  console.log('DEFINED_ARRAY', DEFINED_ARRAY)\\n}\\n\\nif (DEFINED_EVALUATE) {\\n  console.log('DEFINED_EVALUATE', DEFINED_EVALUATE)\\n}\\n\\nif (DEFINED_EVALUATE_NESTED) {\\n  console.log('DEFINED_EVALUATE_NESTED', DEFINED_EVALUATE_NESTED)\\n}\\n\\nif (A.VERY.LONG.DEFINED.VALUE) {\\n  console.log('A.VERY.LONG.DEFINED.VALUE')\\n}\\n\\nif (process.env.NODE_ENV) {\\n  console.log('something')\\n}\\n\\nif (process.env.NODE_ENV === 'production') {\\n  console.log('production')\\n}\\n\\nvar p = process\\n\\nconsole.log(A.VERY.LONG.DEFINED.VALUE)\\nconsole.log(DEFINED_VALUE)\\nconsole.log(p.env.NODE_ENV)\\n\\nif (p.env.NODE_ENV === 'production') {\\n  console.log('production')\\n}\\n\\np.env.NODE_ENV == 'production'\\n  ? console.log('production')\\n  : console.log('development')\\n\\np.env.NODE_ENV != 'production' && console.log('development')\\np.env.NODE_ENV == 'production' && console.log('production')\\n\\nconsole.log(__dirname)\\n\"],\"names\":[],\"mappings\":\"AAAA,wCAAmB;IACjB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAkB;IAChB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAmB;IACjB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAiB;IACf,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAmB;IACjB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAmB;IACjB,QAAQ,GAAG,CAAC;;;;;;;;;AACd;AAEA,wCAAsB;IACpB,QAAQ,GAAG,CAAC,qDAzBd,IAAI;AA0BJ;AAEA,wCAA6B;IAC3B,QAAQ,GAAG,CAAC;;;yCA7Bd,IAAM;;AA8BN;AAEA,wCAA+B;IAC7B,QAAQ,GAAG,CAAC;AACd;AAEA,wCAA0B;IACxB,QAAQ,GAAG,CAAC;AACd;AAEA;;AAIA,IAAI,IAAI;AAER,QAAQ,GAAG;;;AACX,QAAQ,GAAG;AACX,QAAQ,GAAG;AAEX;;AAIA,sCACI,0BACA,QAAQ,GAAG,CAAC;mCAEkB,QAAQ,GAAG,CAAC;mCAC9C,mDAAkB;AAElB,QAAQ,GAAG\"}}]\n+    {\"offset\": {\"line\": 3, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/comptime/define/input/index.js\"],\"sourcesContent\":[\"if (DEFINED_VALUE) {\\n  console.log('DEFINED_VALUE')\\n}\\n\\nif (DEFINED_TRUE) {\\n  console.log('DEFINED_VALUE')\\n}\\n\\nif (!DEFINED_NULL) {\\n  console.log('DEFINED_NULL', DEFINED_NULL)\\n}\\n\\nif (DEFINED_INT) {\\n  console.log('DEFINED_INT', DEFINED_INT)\\n}\\n\\nif (DEFINED_FLOAT) {\\n  console.log('DEFINED_FLOAT', DEFINED_FLOAT)\\n}\\n\\nif (DEFINED_ARRAY) {\\n  console.log('DEFINED_ARRAY', DEFINED_ARRAY)\\n}\\n\\nif (DEFINED_EVALUATE) {\\n  console.log('DEFINED_EVALUATE', DEFINED_EVALUATE)\\n}\\n\\nif (DEFINED_EVALUATE_NESTED) {\\n  console.log('DEFINED_EVALUATE_NESTED', DEFINED_EVALUATE_NESTED)\\n}\\n\\nif (A.VERY.LONG.DEFINED.VALUE) {\\n  console.log('A.VERY.LONG.DEFINED.VALUE')\\n}\\n\\nif (process.env.NODE_ENV) {\\n  console.log('something')\\n}\\n\\nif (process.env.NODE_ENV === 'production') {\\n  console.log('production')\\n}\\n\\nvar p = process\\n\\nconsole.log(A.VERY.LONG.DEFINED.VALUE)\\nconsole.log(DEFINED_VALUE)\\nconsole.log(p.env.NODE_ENV)\\n\\nif (p.env.NODE_ENV === 'production') {\\n  console.log('production')\\n}\\n\\np.env.NODE_ENV == 'production'\\n  ? console.log('production')\\n  : console.log('development')\\n\\n// TODO short-circuit is not implemented yet\\np.env.NODE_ENV != 'production' && console.log('development')\\np.env.NODE_ENV == 'production' && console.log('production')\\n\\nconsole.log(__dirname)\\n\"],\"names\":[],\"mappings\":\"AAAA,wCAAmB;IACjB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAkB;IAChB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAmB;IACjB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAiB;IACf,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAmB;IACjB,QAAQ,GAAG,CAAC;AACd;AAEA,wCAAmB;IACjB,QAAQ,GAAG,CAAC;;;;;;;;;AACd;AAEA,wCAAsB;IACpB,QAAQ,GAAG,CAAC,qDAzBd,IAAI;AA0BJ;AAEA,wCAA6B;IAC3B,QAAQ,GAAG,CAAC;;;yCA7Bd,IAAM;;AA8BN;AAEA,wCAA+B;IAC7B,QAAQ,GAAG,CAAC;AACd;AAEA,wCAA0B;IACxB,QAAQ,GAAG,CAAC;AACd;AAEA;;AAIA,IAAI,IAAI;AAER,QAAQ,GAAG;;;AACX,QAAQ,GAAG;AACX,QAAQ,GAAG;AAEX;;AAIA,sCACI,0BACA,QAAQ,GAAG,CAAC;AAEhB,4CAA4C;AAC5C,mDAAkB,gBAAgB,QAAQ,GAAG,CAAC;AAC9C,mDAAkB,gBAAgB,QAAQ,GAAG,CAAC;AAE9C,QAAQ,GAAG\"}}]\n }\n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 27951,
        "additions": 9210,
        "deletions": 18741
    }
}