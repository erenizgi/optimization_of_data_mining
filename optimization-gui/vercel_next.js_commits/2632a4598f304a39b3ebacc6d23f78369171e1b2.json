{
    "author": "sokra",
    "message": "Turbopack: fix unhelpful error message when deleting folder fails (#81718)\n\n### What?\r\n\r\nFixes the unhelpful error message:\r\n\r\n```\r\n[Error: No such file or directory (os error 2)] {\r\n  code: 'GenericFailure'\r\n}\r\n```",
    "sha": "2632a4598f304a39b3ebacc6d23f78369171e1b2",
    "files": [
        {
            "sha": "79cf4b155047f505085db75d77daf7e2564c737b",
            "filename": "turbopack/crates/turbo-tasks-backend/src/database/db_versioning.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/2632a4598f304a39b3ebacc6d23f78369171e1b2/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fdatabase%2Fdb_versioning.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2632a4598f304a39b3ebacc6d23f78369171e1b2/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fdatabase%2Fdb_versioning.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fdatabase%2Fdb_versioning.rs?ref=2632a4598f304a39b3ebacc6d23f78369171e1b2",
            "patch": "@@ -143,8 +143,11 @@ pub fn handle_db_versioning(\n         }\n     } else {\n         path = base_path.join(\"temp\");\n-        // propagate errors: if this fails we may have stale files left over in the temp directory\n-        remove_dir_all(&path)?;\n+        if path.exists() {\n+            // propagate errors: if this fails we may have stale files left over in the temp\n+            // directory\n+            remove_dir_all(&path)?;\n+        }\n     }\n \n     Ok(path)"
        },
        {
            "sha": "c4b84310d651f525f39883a4a503fd0dcb8b2033",
            "filename": "turbopack/crates/turbo-tasks-backend/src/kv_backing_storage.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2632a4598f304a39b3ebacc6d23f78369171e1b2/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fkv_backing_storage.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/2632a4598f304a39b3ebacc6d23f78369171e1b2/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fkv_backing_storage.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fkv_backing_storage.rs?ref=2632a4598f304a39b3ebacc6d23f78369171e1b2",
            "patch": "@@ -166,9 +166,11 @@ impl<T: KeyValueDatabase> KeyValueDatabaseBackingStorage<T> {\n     where\n         T: Send + Sync + 'static,\n     {\n-        let startup_cache_state = check_db_invalidation_and_cleanup(&base_path)?;\n-        let versioned_path = handle_db_versioning(&base_path, version_info, is_ci)?;\n-        let database = (database)(versioned_path)?;\n+        let startup_cache_state = check_db_invalidation_and_cleanup(&base_path)\n+            .context(\"Failed to check database invalidation and cleanup\")?;\n+        let versioned_path = handle_db_versioning(&base_path, version_info, is_ci)\n+            .context(\"Failed to handle database versioning\")?;\n+        let database = (database)(versioned_path).context(\"Failed to open database\")?;\n         let backing_storage = Self {\n             inner: Arc::new_cyclic(\n                 move |weak_inner: &Weak<KeyValueDatabaseBackingStorageInner<T>>| {"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 10,
        "deletions": 5
    }
}