{
    "author": "kdy1",
    "message": "perf(turbopack): Drop AST node before generating source maps (#79219)\n\n### What?\n\nSource map generation uses lots of memory, so drop another memory hog before performing it.\n\nFor `minify()`, we were already doing it, although it seems unintentional.\n\n### Why?\n\nx-ref: Numbers in https://vercel.slack.com/archives/C06PPGZ0FD3/p1747245989125859?thread_ts=1746834549.272939&cid=C06PPGZ0FD3",
    "sha": "15942fcc72f442911a5cbb9b18070a16241a2709",
    "files": [
        {
            "sha": "d9fd9f86574ecbc297394f00c2e540a11699a024",
            "filename": "turbopack/crates/turbopack-ecmascript/src/lib.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/15942fcc72f442911a5cbb9b18070a16241a2709/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/15942fcc72f442911a5cbb9b18070a16241a2709/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs?ref=15942fcc72f442911a5cbb9b18070a16241a2709",
            "patch": "@@ -1123,6 +1123,8 @@ async fn emit_content(content: CodeGenResult) -> Result<Vc<EcmascriptModuleConte\n         };\n \n         emitter.emit_program(&program)?;\n+        // Drop the AST eagerly so we don't keep it in memory while generating source maps\n+        drop(program);\n     }\n \n     let source_map = if generate_source_map {"
        }
    ],
    "stats": {
        "total": 2,
        "additions": 2,
        "deletions": 0
    }
}