{
    "author": "huozhi",
    "message": "telemetry track mcp server usage (#84471)",
    "sha": "ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6",
    "files": [
        {
            "sha": "740f71cb7bda65bc24fac979dd4abd58dcbc9e55",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6",
            "patch": "@@ -1512,7 +1512,6 @@ export const defaultConfig = Object.freeze({\n     browserDebugInfoInTerminal: false,\n     isolatedDevBuild:\n       process.env.__NEXT_EXPERIMENTAL_ISOLATED_DEV_BUILD === 'true',\n-    mcpServer: !!process.env.__NEXT_EXPERIMENTAL_MCP_SERVER,\n   },\n   htmlLimitedBots: undefined,\n   bundlePagesRouterDependencies: false,"
        },
        {
            "sha": "ffb18d4bf414ac6eff30e1a83000f7cc9118ec92",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6",
            "patch": "@@ -1116,6 +1116,13 @@ function assignDefaultsAndValidate(\n     result.htmlLimitedBots = HTML_LIMITED_BOT_UA_RE_STRING\n   }\n \n+  if (\n+    typeof result.experimental.mcpServer === 'undefined' &&\n+    process.env.__NEXT_EXPERIMENTAL_MCP_SERVER === 'true'\n+  ) {\n+    result.experimental.mcpServer = true\n+  }\n+\n   // \"use cache\" was originally implicitly enabled with the cacheComponents flag, so\n   // we transfer the value for cacheComponents to the explicit useCache flag to ensure\n   // backwards compatibility."
        },
        {
            "sha": "ce4c0be6e981de2e6f652147e4023f2fb10d550a",
            "filename": "packages/next/src/telemetry/events/version.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fversion.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fversion.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fversion.ts?ref=ba5a0ca79944b4c8a59d80d677bfedaf0fef33d6",
            "patch": "@@ -40,6 +40,7 @@ type EventCliSessionStarted = {\n   reactCompiler: boolean\n   reactCompilerCompilationMode: string | null\n   reactCompilerPanicThreshold: string | null\n+  mcpServer: boolean | null\n }\n \n export function eventCliSession(\n@@ -74,6 +75,7 @@ export function eventCliSession(\n     | 'reactCompiler'\n     | 'reactCompilerCompilationMode'\n     | 'reactCompilerPanicThreshold'\n+    | 'mcpServer'\n     | 'isRspack'\n   >\n ): { eventName: string; payload: EventCliSessionStarted }[] {\n@@ -132,6 +134,10 @@ export function eventCliSession(\n       typeof nextConfig.reactCompiler !== 'boolean'\n         ? (nextConfig.reactCompiler?.panicThreshold ?? null)\n         : null,\n+    mcpServer:\n+      typeof nextConfig.experimental.mcpServer === 'boolean'\n+        ? nextConfig.experimental.mcpServer\n+        : null,\n   }\n   return [{ eventName: EVENT_VERSION, payload }]\n }"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 13,
        "deletions": 1
    }
}