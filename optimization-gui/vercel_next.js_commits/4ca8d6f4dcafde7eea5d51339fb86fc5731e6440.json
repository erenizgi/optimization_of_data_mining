{
    "author": "sokra",
    "message": "Turbopack: \"connect\" tasks in turbo_tasks::run too (#83975)\n\n### What?\n\nCalling turbo tasks functions in `turbo_tasks::run` leads to a minimal connect, which schedules the task when it has not yet been computed.\n\nConnecting OperationVc should lead to the same behavior.",
    "sha": "4ca8d6f4dcafde7eea5d51339fb86fc5731e6440",
    "files": [
        {
            "sha": "6250f58c3cccbd3d01ac5e76bc3963c873fbc995",
            "filename": "turbopack/crates/turbo-tasks-backend/src/backend/mod.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4ca8d6f4dcafde7eea5d51339fb86fc5731e6440/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4ca8d6f4dcafde7eea5d51339fb86fc5731e6440/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Fmod.rs?ref=4ca8d6f4dcafde7eea5d51339fb86fc5731e6440",
            "patch": "@@ -3044,10 +3044,10 @@ impl<B: BackingStorage> Backend for TurboTasksBackend<B> {\n     fn connect_task(\n         &self,\n         task: TaskId,\n-        parent_task: TaskId,\n+        parent_task: Option<TaskId>,\n         turbo_tasks: &dyn TurboTasksBackendApi<Self>,\n     ) {\n-        self.0.connect_task(task, Some(parent_task), turbo_tasks);\n+        self.0.connect_task(task, parent_task, turbo_tasks);\n     }\n \n     fn create_transient_task("
        },
        {
            "sha": "b5171d4f59db9cc009fcccf1bd610dc418c9af77",
            "filename": "turbopack/crates/turbo-tasks/src/backend.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/4ca8d6f4dcafde7eea5d51339fb86fc5731e6440/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fbackend.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4ca8d6f4dcafde7eea5d51339fb86fc5731e6440/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fbackend.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fbackend.rs?ref=4ca8d6f4dcafde7eea5d51339fb86fc5731e6440",
            "patch": "@@ -652,7 +652,7 @@ pub trait Backend: Sync + Send {\n     fn connect_task(\n         &self,\n         task: TaskId,\n-        parent_task: TaskId,\n+        parent_task: Option<TaskId>,\n         turbo_tasks: &dyn TurboTasksBackendApi<Self>,\n     );\n "
        },
        {
            "sha": "922f11e4c1268a1b5884314ba1e6dd313c14ee3d",
            "filename": "turbopack/crates/turbo-tasks/src/manager.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/4ca8d6f4dcafde7eea5d51339fb86fc5731e6440/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fmanager.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4ca8d6f4dcafde7eea5d51339fb86fc5731e6440/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fmanager.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fmanager.rs?ref=4ca8d6f4dcafde7eea5d51339fb86fc5731e6440",
            "patch": "@@ -1345,9 +1345,8 @@ impl<B: Backend + 'static> TurboTasksApi for TurboTasks<B> {\n     }\n \n     fn connect_task(&self, task: TaskId) {\n-        if let Some(current_task) = current_task_if_available(\"connecting task\") {\n-            self.backend.connect_task(task, current_task, self);\n-        }\n+        self.backend\n+            .connect_task(task, current_task_if_available(\"connecting task\"), self);\n     }\n \n     fn mark_own_task_as_finished(&self, task: TaskId) {"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 5,
        "deletions": 6
    }
}