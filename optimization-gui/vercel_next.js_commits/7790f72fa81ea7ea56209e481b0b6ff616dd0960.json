{
    "author": "eps1lon",
    "message": "Run export child process with runtime's default `max-old-space-size` (#78712)",
    "sha": "7790f72fa81ea7ea56209e481b0b6ff616dd0960",
    "files": [
        {
            "sha": "2b68b13f38c82facf7c5757ffa2f1e3b0dd1c7f8",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/7790f72fa81ea7ea56209e481b0b6ff616dd0960/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7790f72fa81ea7ea56209e481b0b6ff616dd0960/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=7790f72fa81ea7ea56209e481b0b6ff616dd0960",
            "patch": "@@ -764,7 +764,9 @@ export function createStaticWorker(\n       progress?.clear()\n     },\n     forkOptions: {\n-      env: { ...process.env, NODE_OPTIONS: formatNodeOptions(nodeOptions) },\n+      env: {\n+        NODE_OPTIONS: formatNodeOptions(nodeOptions),\n+      },\n     },\n     enableWorkerThreads: config.experimental.workerThreads,\n     exposedMethods: staticWorkerExposedMethods,"
        },
        {
            "sha": "02a2a54469040e98ae47f9430babe4f95f3eaaa7",
            "filename": "packages/next/src/build/turbopack-build/index.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/7790f72fa81ea7ea56209e481b0b6ff616dd0960/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-build%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7790f72fa81ea7ea56209e481b0b6ff616dd0960/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-build%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-build%2Findex.ts?ref=7790f72fa81ea7ea56209e481b0b6ff616dd0960",
            "patch": "@@ -16,7 +16,6 @@ async function turbopackBuildWithWorker() {\n       maxRetries: 0,\n       forkOptions: {\n         env: {\n-          ...process.env,\n           NEXT_PRIVATE_BUILD_WORKER: '1',\n           NODE_OPTIONS: formatNodeOptions(nodeOptions),\n         },"
        },
        {
            "sha": "2b59cfabd819cc5e43f0963ecd97569e12b0e173",
            "filename": "packages/next/src/build/webpack-build/index.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/7790f72fa81ea7ea56209e481b0b6ff616dd0960/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7790f72fa81ea7ea56209e481b0b6ff616dd0960/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Findex.ts?ref=7790f72fa81ea7ea56209e481b0b6ff616dd0960",
            "patch": "@@ -57,7 +57,6 @@ async function webpackBuildWithWorker(\n       maxRetries: 0,\n       forkOptions: {\n         env: {\n-          ...process.env,\n           NEXT_PRIVATE_BUILD_WORKER: '1',\n           NODE_OPTIONS: formatNodeOptions(nodeOptions),\n         },"
        },
        {
            "sha": "14acf76d42d5bffa68b9970e58d28f28f626f7c5",
            "filename": "packages/next/src/lib/worker.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 3,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/7790f72fa81ea7ea56209e481b0b6ff616dd0960/packages%2Fnext%2Fsrc%2Flib%2Fworker.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7790f72fa81ea7ea56209e481b0b6ff616dd0960/packages%2Fnext%2Fsrc%2Flib%2Fworker.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fworker.ts?ref=7790f72fa81ea7ea56209e481b0b6ff616dd0960",
            "patch": "@@ -2,7 +2,7 @@ import type { ChildProcess } from 'child_process'\n import { Worker as JestWorker } from 'next/dist/compiled/jest-worker'\n import { Transform } from 'stream'\n \n-type FarmOptions = ConstructorParameters<typeof JestWorker>[1]\n+type FarmOptions = NonNullable<ConstructorParameters<typeof JestWorker>[1]>\n \n const RESTARTED = Symbol('restarted')\n \n@@ -19,7 +19,12 @@ export class Worker {\n \n   constructor(\n     workerPath: string,\n-    options: FarmOptions & {\n+    options: Omit<FarmOptions, 'forkOptions'> & {\n+      forkOptions?:\n+        | (Omit<NonNullable<FarmOptions['forkOptions']>, 'env'> & {\n+            env?: Partial<NodeJS.ProcessEnv> | undefined\n+          })\n+        | undefined\n       timeout?: number\n       onActivity?: () => void\n       onActivityAbort?: () => void\n@@ -48,8 +53,8 @@ export class Worker {\n         forkOptions: {\n           ...farmOptions.forkOptions,\n           env: {\n-            ...((farmOptions.forkOptions?.env || {}) as any),\n             ...process.env,\n+            ...((farmOptions.forkOptions?.env || {}) as any),\n             IS_NEXT_WORKER: 'true',\n           } as any,\n         },"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 11,
        "deletions": 6
    }
}