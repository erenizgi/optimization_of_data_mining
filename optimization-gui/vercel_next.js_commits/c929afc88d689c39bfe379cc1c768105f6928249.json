{
    "author": "wbinnssmith",
    "message": "Don’t use native built-ins for additional bundler (#76577)\n\nThis opts us out of using the native built-in plugins for Rspack for now.\n\nThe existing swc plugin we use for webpack does additional work beyond just swc transformation, including validating RSC components to make sure they don’t use React APIs unavailable in that context.\n\nIn total, the native plugins result in a less than 20% performance gain which, while significant, isn’t necessary as we focus on correctness for now.\n\nIf we decide the maintenance cost of maintaining multiple plugins in parity is worth the performance gain in the future, we can selectively re-enable some or all of these plugins.\n\nTest Plan: `pnpm test-dev-rspack test/development/acceptance/server-component-compiler-errors-in-pages.test.ts` no longer fails by missing the invalid React api messages.",
    "sha": "c929afc88d689c39bfe379cc1c768105f6928249",
    "files": [
        {
            "sha": "b50c3b8ece9b72e0f7665ec230da79c5b1a0d8e8",
            "filename": ".github/workflows/rspack-nextjs-build-integration-tests.yml",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/c929afc88d689c39bfe379cc1c768105f6928249/.github%2Fworkflows%2Frspack-nextjs-build-integration-tests.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/c929afc88d689c39bfe379cc1c768105f6928249/.github%2Fworkflows%2Frspack-nextjs-build-integration-tests.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Fworkflows%2Frspack-nextjs-build-integration-tests.yml?ref=c929afc88d689c39bfe379cc1c768105f6928249",
            "patch": "@@ -14,11 +14,7 @@ jobs:\n       name: rspack-production\n       test_type: production\n       run_before_test: |\n-        export NEXT_RSPACK=1 \\\n-          NEXT_TEST_USE_RSPACK=1 \\\n-          BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN=1 \\\n-          BUILTIN_APP_LOADER=1 \\\n-          BUILTIN_SWC_LOADER=1\n+        export NEXT_RSPACK=1 NEXT_TEST_USE_RSPACK=1 \\\n       # Failing tests take longer (due to timeouts and retries). Since we have\n       # many failing tests, we need smaller groups and longer timeouts, in case\n       # a group gets stuck with a cluster of failing tests."
        },
        {
            "sha": "834424bddf66b3f169ecf180eab4bee526338d5e",
            "filename": ".github/workflows/rspack-nextjs-dev-integration-tests.yml",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/c929afc88d689c39bfe379cc1c768105f6928249/.github%2Fworkflows%2Frspack-nextjs-dev-integration-tests.yml",
            "raw_url": "https://github.com/vercel/next.js/raw/c929afc88d689c39bfe379cc1c768105f6928249/.github%2Fworkflows%2Frspack-nextjs-dev-integration-tests.yml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.github%2Fworkflows%2Frspack-nextjs-dev-integration-tests.yml?ref=c929afc88d689c39bfe379cc1c768105f6928249",
            "patch": "@@ -14,11 +14,7 @@ jobs:\n       name: rspack-development\n       test_type: development\n       run_before_test: |\n-        export NEXT_RSPACK=1 \\\n-          NEXT_TEST_USE_RSPACK=1 \\\n-          BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN=1 \\\n-          BUILTIN_APP_LOADER=1 \\\n-          BUILTIN_SWC_LOADER=1\n+        export NEXT_RSPACK=1 NEXT_TEST_USE_RSPACK=1\n       # Failing tests take longer (due to timeouts and retries). Since we have\n       # many failing tests, we need smaller groups and longer timeouts, in case\n       # a group gets stuck with a cluster of failing tests."
        },
        {
            "sha": "0db038255f9ca2ad48836b23cfb4905c5b7d6386",
            "filename": "package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c929afc88d689c39bfe379cc1c768105f6928249/package.json",
            "raw_url": "https://github.com/vercel/next.js/raw/c929afc88d689c39bfe379cc1c768105f6928249/package.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/package.json?ref=c929afc88d689c39bfe379cc1c768105f6928249",
            "patch": "@@ -77,7 +77,7 @@\n     \"storybook\": \"turbo run storybook\",\n     \"build-storybook\": \"turbo run build-storybook\",\n     \"test-storybook\": \"turbo run test-storybook\",\n-    \"with-rspack\": \"cross-env NEXT_RSPACK=1 NEXT_TEST_USE_RSPACK=1 BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN=1 BUILTIN_APP_LOADER=1 BUILTIN_SWC_LOADER=1\"\n+    \"with-rspack\": \"cross-env NEXT_RSPACK=1 NEXT_TEST_USE_RSPACK=1\"\n   },\n   \"devDependencies\": {\n     \"@actions/core\": \"1.10.1\","
        },
        {
            "sha": "e0ce02d637d847aa34678314996fbb8c90484826",
            "filename": "packages/next-plugin-rspack/index.js",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/c929afc88d689c39bfe379cc1c768105f6928249/packages%2Fnext-plugin-rspack%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/c929afc88d689c39bfe379cc1c768105f6928249/packages%2Fnext-plugin-rspack%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext-plugin-rspack%2Findex.js?ref=c929afc88d689c39bfe379cc1c768105f6928249",
            "patch": "@@ -1,7 +1,5 @@\n module.exports = function withRspack(config) {\n   process.env.NEXT_RSPACK = 'true'\n-  process.env.BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN = 'true'\n-  process.env.BUILTIN_APP_LOADER = 'true'\n-  process.env.BUILTIN_SWC_LOADER = 'true'\n+  process.env.RSPACK_CONFIG_VALIDATE = 'loose-silent'\n   return config\n }"
        },
        {
            "sha": "d226eba7015e79f0f3fd6ae7f6541490b3e4e350",
            "filename": "test/lib/create-next-install.js",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/c929afc88d689c39bfe379cc1c768105f6928249/test%2Flib%2Fcreate-next-install.js",
            "raw_url": "https://github.com/vercel/next.js/raw/c929afc88d689c39bfe379cc1c768105f6928249/test%2Flib%2Fcreate-next-install.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Flib%2Fcreate-next-install.js?ref=c929afc88d689c39bfe379cc1c768105f6928249",
            "patch": "@@ -195,9 +195,7 @@ async function createNextInstall({\n         // This is what the @next/plugin-rspack plugin does.\n         // TODO: Load the plugin properly during test\n         process.env.NEXT_RSPACK = 'true'\n-        process.env.BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN = 'true'\n-        process.env.BUILTIN_APP_LOADER = 'true'\n-        process.env.BUILTIN_SWC_LOADER = 'true'\n+        process.env.RSPACK_CONFIG_VALIDATE = 'loose-silent'\n       }\n \n       return {"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 5,
        "deletions": 17
    }
}