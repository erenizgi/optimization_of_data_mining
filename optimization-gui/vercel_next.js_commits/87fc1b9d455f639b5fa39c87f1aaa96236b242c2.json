{
    "author": "eps1lon",
    "message": "Fix duplicate .next/types `include` on Windows (#85400)",
    "sha": "87fc1b9d455f639b5fa39c87f1aaa96236b242c2",
    "files": [
        {
            "sha": "7a166c5b677914f038e903fe5ab595e93165a0ba",
            "filename": "packages/next/src/lib/typescript/writeConfigurationDefaults.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 3,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/87fc1b9d455f639b5fa39c87f1aaa96236b242c2/packages%2Fnext%2Fsrc%2Flib%2Ftypescript%2FwriteConfigurationDefaults.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/87fc1b9d455f639b5fa39c87f1aaa96236b242c2/packages%2Fnext%2Fsrc%2Flib%2Ftypescript%2FwriteConfigurationDefaults.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Ftypescript%2FwriteConfigurationDefaults.ts?ref=87fc1b9d455f639b5fa39c87f1aaa96236b242c2",
            "patch": "@@ -1,4 +1,5 @@\n import { readFileSync, writeFileSync } from 'fs'\n+import * as path from 'path'\n import { bold, cyan, white } from '../picocolors'\n import * as CommentJson from 'next/dist/compiled/comment-json'\n import semver from 'next/dist/compiled/semver'\n@@ -267,7 +268,11 @@ export async function writeConfigurationDefaults(\n     }\n   }\n \n-  const nextAppTypes: string[] = [`${distDir}/types/**/*.ts`]\n+  const distDirPosix =\n+    path.win32.sep === path.sep\n+      ? distDir.replaceAll(path.win32.sep, path.posix.sep)\n+      : distDir\n+  const nextAppTypes: string[] = [`${distDirPosix}/types/**/*.ts`]\n \n   // When isolatedDevBuild is enabled, Next.js uses different distDir paths:\n   // - Development: \"{distDir}/dev\"\n@@ -279,10 +284,10 @@ export async function writeConfigurationDefaults(\n       process.env.NODE_ENV === 'development'\n         ? // In dev, distDir is \"{distDir}/dev\", which is already in the array above, but we also need \"{distDir}/types\".\n           // Here we remove \"/dev\" at the end of distDir for consistency.\n-          `${distDir.replace(/\\/dev$/, '')}/types/**/*.ts`\n+          `${distDirPosix.replace(/\\/dev$/, '')}/types/**/*.ts`\n         : // In build, distDir is \"{distDir}\", which is already in the array above, but we also need \"{distDir}/dev/types\".\n           // Here we add \"/dev\" at the end of distDir for consistency.\n-          `${distDir}/dev/types/**/*.ts`\n+          `${distDirPosix}/dev/types/**/*.ts`\n     )\n     // Sort the array to ensure consistent order.\n     nextAppTypes.sort((a, b) => a.length - b.length)"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 8,
        "deletions": 3
    }
}