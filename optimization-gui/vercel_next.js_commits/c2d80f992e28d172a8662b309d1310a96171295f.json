{
    "author": "wbinnssmith",
    "message": "Turbopack: Extract `EsRegex` into `turbo-esregex` crate (#78639)",
    "sha": "c2d80f992e28d172a8662b309d1310a96171295f",
    "files": [
        {
            "sha": "6442d953220bb994233fd9c3252f4e90f5b4d684",
            "filename": "Cargo.lock",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/c2d80f992e28d172a8662b309d1310a96171295f/Cargo.lock",
            "raw_url": "https://github.com/vercel/next.js/raw/c2d80f992e28d172a8662b309d1310a96171295f/Cargo.lock",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.lock?ref=c2d80f992e28d172a8662b309d1310a96171295f",
            "patch": "@@ -9243,6 +9243,18 @@ dependencies = [\n  \"utf-8\",\n ]\n \n+[[package]]\n+name = \"turbo-esregex\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"anyhow\",\n+ \"regex\",\n+ \"regress\",\n+ \"serde\",\n+ \"turbo-tasks\",\n+ \"turbo-tasks-build\",\n+]\n+\n [[package]]\n name = \"turbo-persistence\"\n version = \"0.1.0\"\n@@ -9888,7 +9900,6 @@ dependencies = [\n  \"parking_lot\",\n  \"petgraph 0.6.3\",\n  \"regex\",\n- \"regress\",\n  \"rustc-hash 2.1.0\",\n  \"serde\",\n  \"serde_json\",\n@@ -9898,6 +9909,7 @@ dependencies = [\n  \"swc_core\",\n  \"tokio\",\n  \"tracing\",\n+ \"turbo-esregex\",\n  \"turbo-rcstr\",\n  \"turbo-tasks\",\n  \"turbo-tasks-build\","
        },
        {
            "sha": "fae0fc9233126dd527e4c93eaa7c220fd800cb24",
            "filename": "Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/c2d80f992e28d172a8662b309d1310a96171295f/Cargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/c2d80f992e28d172a8662b309d1310a96171295f/Cargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.toml?ref=c2d80f992e28d172a8662b309d1310a96171295f",
            "patch": "@@ -252,6 +252,7 @@ auto-hash-map = { path = \"turbopack/crates/turbo-tasks-auto-hash-map\" }\n swc-ast-explorer = { path = \"turbopack/crates/turbopack-swc-ast-explorer\" }\n turbo-prehash = { path = \"turbopack/crates/turbo-prehash\" }\n turbo-rcstr = { path = \"turbopack/crates/turbo-rcstr\" }\n+turbo-esregex = { path = \"turbopack/crates/turbo-esregex\" }\n turbo-persistence = { path = \"turbopack/crates/turbo-persistence\" }\n turbo-tasks-malloc = { path = \"turbopack/crates/turbo-tasks-malloc\", default-features = false }\n turbo-tasks = { path = \"turbopack/crates/turbo-tasks\" }"
        },
        {
            "sha": "79004d0042bc189037672aee184ead4b9e94d6fb",
            "filename": "turbopack/crates/turbo-esregex/Cargo.toml",
            "status": "added",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbo-esregex%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbo-esregex%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-esregex%2FCargo.toml?ref=c2d80f992e28d172a8662b309d1310a96171295f",
            "patch": "@@ -0,0 +1,18 @@\n+[package]\n+name = \"turbo-esregex\"\n+version = \"0.1.0\"\n+edition = \"2021\"\n+license = \"MIT\"\n+\n+[dependencies]\n+anyhow = { workspace = true }\n+regex = { workspace = true }\n+regress = { workspace = true }\n+serde = { workspace = true }\n+turbo-tasks = { workspace = true }\n+\n+[build-dependencies]\n+turbo-tasks-build = { workspace = true }\n+\n+[lints]\n+workspace = true"
        },
        {
            "sha": "1673efed59cce6379c6a83d17829dfc0687e253f",
            "filename": "turbopack/crates/turbo-esregex/build.rs",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbo-esregex%2Fbuild.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbo-esregex%2Fbuild.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-esregex%2Fbuild.rs?ref=c2d80f992e28d172a8662b309d1310a96171295f",
            "patch": "@@ -0,0 +1,5 @@\n+use turbo_tasks_build::generate_register;\n+\n+fn main() {\n+    generate_register();\n+}"
        },
        {
            "sha": "3c2ee137e4e9f33007c23e32ff019b35db1d3b3e",
            "filename": "turbopack/crates/turbo-esregex/src/lib.rs",
            "status": "renamed",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbo-esregex%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbo-esregex%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-esregex%2Fsrc%2Flib.rs?ref=c2d80f992e28d172a8662b309d1310a96171295f",
            "patch": "@@ -1,5 +1,12 @@\n+#![feature(arbitrary_self_types_pointers)]\n+\n use anyhow::{bail, Result};\n \n+pub fn register() {\n+    turbo_tasks::register();\n+    include!(concat!(env!(\"OUT_DIR\"), \"/register.rs\"));\n+}\n+\n /// A simple regular expression implementation following ecmascript semantics\n ///\n /// Delegates to the `regex` crate when possible and `regress` otherwise.",
            "previous_filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/es_regex.rs"
        },
        {
            "sha": "71e49992d40f1e37845e725508ccf197026af118",
            "filename": "turbopack/crates/turbopack-ecmascript/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbopack-ecmascript%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbopack-ecmascript%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2FCargo.toml?ref=c2d80f992e28d172a8662b309d1310a96171295f",
            "patch": "@@ -26,7 +26,6 @@ once_cell = { workspace = true }\n parking_lot = { workspace = true }\n petgraph = { workspace = true }\n regex = { workspace = true }\n-regress = { workspace = true }\n rustc-hash = { workspace = true }\n serde = { workspace = true }\n serde_json = { workspace = true }\n@@ -35,6 +34,7 @@ smallvec = { workspace = true }\n strsim = { workspace = true }\n tokio = { workspace = true }\n tracing = { workspace = true }\n+turbo-esregex = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n turbo-tasks-fs = { workspace = true }"
        },
        {
            "sha": "7b8a81df4b1c0e6f7f33d1101c9c8d5cab01f18b",
            "filename": "turbopack/crates/turbopack-ecmascript/src/analyzer/mod.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fanalyzer%2Fmod.rs?ref=c2d80f992e28d172a8662b309d1310a96171295f",
            "patch": "@@ -24,6 +24,7 @@ use swc_core::{\n         atoms::Atom,\n     },\n };\n+use turbo_esregex::EsRegex;\n use turbo_rcstr::RcStr;\n use turbo_tasks::{FxIndexMap, FxIndexSet, Vc};\n use turbopack_core::compile_time_info::{\n@@ -32,12 +33,9 @@ use turbopack_core::compile_time_info::{\n \n use self::imports::ImportAnnotations;\n pub(crate) use self::imports::ImportMap;\n-use crate::{\n-    analyzer::es_regex::EsRegex, references::require_context::RequireContextMap, utils::StringifyJs,\n-};\n+use crate::{references::require_context::RequireContextMap, utils::StringifyJs};\n \n pub mod builtin;\n-pub mod es_regex;\n pub mod graph;\n pub mod imports;\n pub mod linker;"
        },
        {
            "sha": "1b9a97bf4e8068c47e9d316658c7f371df4a1c47",
            "filename": "turbopack/crates/turbopack-ecmascript/src/lib.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs?ref=c2d80f992e28d172a8662b309d1310a96171295f",
            "patch": "@@ -1116,5 +1116,6 @@ pub fn register() {\n     turbo_tasks::register();\n     turbo_tasks_fs::register();\n     turbopack_core::register();\n+    turbo_esregex::register();\n     include!(concat!(env!(\"OUT_DIR\"), \"/register.rs\"));\n }"
        },
        {
            "sha": "b1728e087ea6ca372b42da147af91a9eb7cedbec",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/require_context.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/c2d80f992e28d172a8662b309d1310a96171295f/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs?ref=c2d80f992e28d172a8662b309d1310a96171295f",
            "patch": "@@ -13,6 +13,7 @@ use swc_core::{\n     },\n     quote, quote_expr,\n };\n+use turbo_esregex::EsRegex;\n use turbo_rcstr::RcStr;\n use turbo_tasks::{\n     debug::ValueDebugFormat, trace::TraceRawVcs, FxIndexMap, NonLocalValue, ResolvedVc, Value,\n@@ -36,7 +37,6 @@ use turbopack_core::{\n use turbopack_resolve::ecmascript::cjs_resolve;\n \n use crate::{\n-    analyzer::es_regex::EsRegex,\n     chunk::{\n         EcmascriptChunkItem, EcmascriptChunkItemContent, EcmascriptChunkType, EcmascriptExports,\n     },"
        }
    ],
    "stats": {
        "total": 56,
        "additions": 49,
        "deletions": 7
    }
}