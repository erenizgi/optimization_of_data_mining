{
    "author": "devjiwonchoi",
    "message": "[TypeScript Plugin] Match method signature (`someFunc(): void`) type for client boundary warnings (#79144)\n\nBest to be reviewed with \"Hide whitespace\".\n\n### Why?\n\nThe props marked `(): any` bypassed the warning for non-serializable\nprops.\n\n```tsx\n'use client'\n\nexport function Comp({ onClick }: { onClick(): any }) {\n  // ...\n}\n```\n\nAdded tests to prevent regression.\n\n---------\n\nCo-authored-by: Janka Uryga <lolzatu2@gmail.com>",
    "sha": "d16d9f46b647469fdc49e8408b0fd3b645ccce98",
    "files": [
        {
            "sha": "844d3ea79dcb24220daf8c456c14066970d722cb",
            "filename": ".changeset/seven-seas-run.md",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/d16d9f46b647469fdc49e8408b0fd3b645ccce98/.changeset%2Fseven-seas-run.md",
            "raw_url": "https://github.com/vercel/next.js/raw/d16d9f46b647469fdc49e8408b0fd3b645ccce98/.changeset%2Fseven-seas-run.md",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.changeset%2Fseven-seas-run.md?ref=d16d9f46b647469fdc49e8408b0fd3b645ccce98",
            "patch": "@@ -0,0 +1,5 @@\n+---\n+\"next\": patch\n+---\n+\n+[TypeScript Plugin] Match method signature (`someFunc(): void`) type for client boundary warnings."
        },
        {
            "sha": "fc6b9078b7351b60188102206187f20d0dba2473",
            "filename": "packages/next/src/server/typescript/rules/client-boundary.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/d16d9f46b647469fdc49e8408b0fd3b645ccce98/packages%2Fnext%2Fsrc%2Fserver%2Ftypescript%2Frules%2Fclient-boundary.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/d16d9f46b647469fdc49e8408b0fd3b645ccce98/packages%2Fnext%2Fsrc%2Fserver%2Ftypescript%2Frules%2Fclient-boundary.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Ftypescript%2Frules%2Fclient-boundary.ts?ref=d16d9f46b647469fdc49e8408b0fd3b645ccce98",
            "patch": "@@ -60,7 +60,11 @@ const clientBoundary = {\n                 propTypeInfo.symbol?.getDeclarations()?.[0]\n \n               if (typeDeclarationNode) {\n-                if (ts.isFunctionTypeNode(typeDeclarationNode)) {\n+                if (\n+                  ts.isFunctionTypeNode(typeDeclarationNode) ||\n+                  // someFunc(): void\n+                  ts.isMethodSignature(typeDeclarationNode)\n+                ) {\n                   // By convention, props named \"action\" can accept functions since we\n                   // assume these are Server Actions. Structurally, there's no\n                   // difference between a Server Action and a normal function until"
        },
        {
            "sha": "651e71f5c80413be4aad9e387c1e0a9a260b4288",
            "filename": "test/development/typescript-plugin/client-boundary/app/non-serializable-action-props.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/d16d9f46b647469fdc49e8408b0fd3b645ccce98/test%2Fdevelopment%2Ftypescript-plugin%2Fclient-boundary%2Fapp%2Fnon-serializable-action-props.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/d16d9f46b647469fdc49e8408b0fd3b645ccce98/test%2Fdevelopment%2Ftypescript-plugin%2Fclient-boundary%2Fapp%2Fnon-serializable-action-props.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Ftypescript-plugin%2Fclient-boundary%2Fapp%2Fnon-serializable-action-props.tsx?ref=d16d9f46b647469fdc49e8408b0fd3b645ccce98",
            "patch": "@@ -5,8 +5,10 @@ class Class {}\n type ArrowFunctionTypeAlias = () => void\n \n export default function ClientComponent(props: {\n+  _functionAction(): void\n   _arrowFunctionAction: () => void\n   _arrowFunctionTypeAliasAction: ArrowFunctionTypeAlias\n+  _arrowFunctionConditionalAction: (() => void) | null\n   // Doesn't make sense, but check for loophole\n   _classAction: Class\n   _constructorAction: new () => void"
        },
        {
            "sha": "2cc92bd99cc6c8ea9832e15888858dec64b4a3c2",
            "filename": "test/development/typescript-plugin/client-boundary/app/non-serializable-props.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/d16d9f46b647469fdc49e8408b0fd3b645ccce98/test%2Fdevelopment%2Ftypescript-plugin%2Fclient-boundary%2Fapp%2Fnon-serializable-props.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/d16d9f46b647469fdc49e8408b0fd3b645ccce98/test%2Fdevelopment%2Ftypescript-plugin%2Fclient-boundary%2Fapp%2Fnon-serializable-props.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Ftypescript-plugin%2Fclient-boundary%2Fapp%2Fnon-serializable-props.tsx?ref=d16d9f46b647469fdc49e8408b0fd3b645ccce98",
            "patch": "@@ -5,8 +5,10 @@ class Class {}\n type ArrowFunctionTypeAlias = () => void\n \n export default function ClientComponent(props: {\n+  _function(): void\n   _arrowFunction: () => void\n   _arrowFunctionTypeAlias: ArrowFunctionTypeAlias\n+  _arrowFunctionConditional: (() => void) | null\n   _class: Class\n   _constructor: new () => void\n }) {"
        },
        {
            "sha": "db4f1d8f1cb704a10c1d5cc1c5f8b703955e285c",
            "filename": "test/development/typescript-plugin/client-boundary/client-boundary.test.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 6,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/d16d9f46b647469fdc49e8408b0fd3b645ccce98/test%2Fdevelopment%2Ftypescript-plugin%2Fclient-boundary%2Fclient-boundary.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/d16d9f46b647469fdc49e8408b0fd3b645ccce98/test%2Fdevelopment%2Ftypescript-plugin%2Fclient-boundary%2Fclient-boundary.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Ftypescript-plugin%2Fclient-boundary%2Fclient-boundary.test.ts?ref=d16d9f46b647469fdc49e8408b0fd3b645ccce98",
            "patch": "@@ -60,13 +60,13 @@ describe('typescript-plugin - client-boundary', () => {\n            \"code\": 71007,\n            \"length\": 5,\n            \"messageText\": \"Props must be serializable for components in the \"use client\" entry file, \"_classAction\" is invalid.\",\n-           \"start\": 276,\n+           \"start\": 357,\n          },\n          {\n            \"code\": 71007,\n            \"length\": 14,\n            \"messageText\": \"Props must be serializable for components in the \"use client\" entry file, \"_constructorAction\" is invalid.\",\n-           \"start\": 304,\n+           \"start\": 385,\n          },\n        ],\n      }\n@@ -93,25 +93,31 @@ describe('typescript-plugin - client-boundary', () => {\n            \"code\": 71007,\n            \"length\": 10,\n            \"messageText\": \"Props must be serializable for components in the \"use client\" entry file. \"_arrowFunction\" is a function that's not a Server Action. Rename \"_arrowFunction\" either to \"action\" or have its name end with \"Action\" e.g. \"_arrowFunctionAction\" to indicate it is a Server Action.\",\n-           \"start\": 139,\n+           \"start\": 159,\n          },\n          {\n            \"code\": 71007,\n            \"length\": 22,\n            \"messageText\": \"Props must be serializable for components in the \"use client\" entry file. \"_arrowFunctionTypeAlias\" is a function that's not a Server Action. Rename \"_arrowFunctionTypeAlias\" either to \"action\" or have its name end with \"Action\" e.g. \"_arrowFunctionTypeAliasAction\" to indicate it is a Server Action.\",\n-           \"start\": 177,\n+           \"start\": 197,\n+         },\n+         {\n+           \"code\": 71007,\n+           \"length\": 19,\n+           \"messageText\": \"Props must be serializable for components in the \"use client\" entry file. \"_arrowFunctionConditional\" is a function that's not a Server Action. Rename \"_arrowFunctionConditional\" either to \"action\" or have its name end with \"Action\" e.g. \"_arrowFunctionConditionalAction\" to indicate it is a Server Action.\",\n+           \"start\": 249,\n          },\n          {\n            \"code\": 71007,\n            \"length\": 5,\n            \"messageText\": \"Props must be serializable for components in the \"use client\" entry file, \"_class\" is invalid.\",\n-           \"start\": 210,\n+           \"start\": 279,\n          },\n          {\n            \"code\": 71007,\n            \"length\": 14,\n            \"messageText\": \"Props must be serializable for components in the \"use client\" entry file, \"_constructor\" is invalid.\",\n-           \"start\": 232,\n+           \"start\": 301,\n          },\n        ],\n      }"
        }
    ],
    "stats": {
        "total": 33,
        "additions": 26,
        "deletions": 7
    }
}