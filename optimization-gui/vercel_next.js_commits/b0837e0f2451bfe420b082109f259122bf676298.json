{
    "author": "eps1lon",
    "message": "[test] Exclude likely Next.js internal Components from component stacks in Redbox assertions (#85420)",
    "sha": "b0837e0f2451bfe420b082109f259122bf676298",
    "files": [
        {
            "sha": "b53a4e2b12303ad1b394c9172d2245b20d15b238",
            "filename": "test/development/acceptance-app/fixtures/hydration-errors/app/(default)/layout.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Fhydration-errors%2Fapp%2F(default)%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Fhydration-errors%2Fapp%2F(default)%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Fhydration-errors%2Fapp%2F(default)%2Flayout.tsx?ref=b0837e0f2451bfe420b082109f259122bf676298",
            "patch": "@@ -1,5 +1,5 @@\n import { ReactNode } from 'react'\n-export default function Root({ children }: { children: ReactNode }) {\n+export default function RootLayout({ children }: { children: ReactNode }) {\n   return (\n     <html>\n       <body>{children}</body>"
        },
        {
            "sha": "6e45302ad70e236048b2e87dea480b10e1a7587d",
            "filename": "test/development/acceptance-app/fixtures/hydration-errors/app/(extra-attributes)/layout.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Fhydration-errors%2Fapp%2F(extra-attributes)%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Fhydration-errors%2Fapp%2F(extra-attributes)%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Fhydration-errors%2Fapp%2F(extra-attributes)%2Flayout.tsx?ref=b0837e0f2451bfe420b082109f259122bf676298",
            "patch": "@@ -4,7 +4,7 @@ import { ReactNode } from 'react'\n \n const isServer = typeof window === 'undefined'\n \n-export default function Root({ children }: { children: ReactNode }) {\n+export default function RootLayout({ children }: { children: ReactNode }) {\n   return (\n     <html {...(isServer ? { className: 'server-html' } : undefined)}>\n       <body>{children}</body>"
        },
        {
            "sha": "cd1f78929b808ad725f03d5ca333d286baeab85a",
            "filename": "test/development/acceptance-app/fixtures/hydration-errors/app/(script-under-html)/layout.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Fhydration-errors%2Fapp%2F(script-under-html)%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Fhydration-errors%2Fapp%2F(script-under-html)%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Fhydration-errors%2Fapp%2F(script-under-html)%2Flayout.tsx?ref=b0837e0f2451bfe420b082109f259122bf676298",
            "patch": "@@ -1,7 +1,7 @@\n import Script from 'next/script'\n import { ReactNode } from 'react'\n \n-export default function Root({ children }: { children: ReactNode }) {\n+export default function RootLayout({ children }: { children: ReactNode }) {\n   return (\n     <html>\n       <body>{children}</body>"
        },
        {
            "sha": "5c0fb7d5eef9da566511093486638375b0fa991a",
            "filename": "test/development/acceptance-app/hydration-error.test.ts",
            "status": "modified",
            "additions": 307,
            "deletions": 441,
            "changes": 748,
            "blob_url": "https://github.com/vercel/next.js/blob/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance-app%2Fhydration-error.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance-app%2Fhydration-error.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Fhydration-error.test.ts?ref=b0837e0f2451bfe420b082109f259122bf676298",
            "patch": "@@ -9,8 +9,6 @@ import {\n   retry,\n } from 'next-test-utils'\n \n-const pprEnabled = process.env.__NEXT_CACHE_COMPONENTS === 'true'\n-\n describe('Error overlay for hydration errors in App router', () => {\n   const { next, isTurbopack } = nextTestSetup({\n     files: new FileRef(path.join(__dirname, 'fixtures', 'hydration-errors')),\n@@ -41,18 +39,18 @@ describe('Error overlay for hydration errors in App router', () => {\n     await expect(browser).toDisplayCollapsedRedbox(`\n      {\n        \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"text-misma...\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/text-mism...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Mismatch} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Mismatch params={Promise} searchParams={Promise}>\n                                  <div className=\"parent\">\n                                    <main className=\"child\">\n@@ -103,18 +101,18 @@ describe('Error overlay for hydration errors in App router', () => {\n     await expect(browser).toDisplayCollapsedRedbox(`\n      {\n        \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"extra-elem...\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/extra-ele...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Mismatch} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Mismatch params={Promise} searchParams={Promise}>\n                                  <div className=\"parent\">\n      +                             <main className=\"only\">\n@@ -142,21 +140,21 @@ describe('Error overlay for hydration errors in App router', () => {\n       await expect(browser).toDisplayCollapsedRedbox(`\n        {\n          \"componentStack\": \"...\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"/\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={<SegmentViewNode>} forbidden={undefined} unauthorized={undefined}>\n-                     <HTTPAccessFallbackErrorBoundary pathname=\"/extra-att...\" notFound={<SegmentViewNode>} ...>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/extra-att...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"layout\" pagePath=\"(extra-att...\">\n-                               <SegmentTrieNode>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                <script>\n                                <script>\n-                               <ClientSegmentRoot Component={function Root} slots={{...}} ...>\n-                                 <Root params={Promise}>\n+                               <Next.js Internal Component>\n+                                 <RootLayout params={Promise}>\n                                    <html\n        -                             className=\"server-html\"\n                                    >\n@@ -165,32 +163,32 @@ describe('Error overlay for hydration errors in App router', () => {\n          \"description\": \"A tree hydrated but some attributes of the server rendered HTML didn't match the client properties. This won't be patched up. This can happen if a SSR-ed Client Component used:\",\n          \"environmentLabel\": null,\n          \"label\": \"Console Error\",\n-         \"source\": \"app/(extra-attributes)/layout.tsx (9:5) @ Root\n+         \"source\": \"app/(extra-attributes)/layout.tsx (9:5) @ RootLayout\n        >  9 |     <html {...(isServer ? { className: 'server-html' } : undefined)}>\n             |     ^\",\n          \"stack\": [\n            \"html <anonymous>\",\n-           \"Root app/(extra-attributes)/layout.tsx (9:5)\",\n+           \"RootLayout app/(extra-attributes)/layout.tsx (9:5)\",\n          ],\n        }\n       `)\n     } else {\n       await expect(browser).toDisplayCollapsedRedbox(`\n        {\n          \"componentStack\": \"...\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"/\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={<SegmentViewNode>} forbidden={undefined} unauthorized={undefined}>\n-                     <HTTPAccessFallbackErrorBoundary pathname=\"/extra-att...\" notFound={<SegmentViewNode>} ...>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/extra-att...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"layout\" pagePath=\"(extra-att...\">\n-                               <SegmentTrieNode>\n-                               <ClientSegmentRoot Component={function Root} slots={{...}} ...>\n-                                 <Root params={Promise}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                                 <RootLayout params={Promise}>\n                                    <html\n        -                             className=\"server-html\"\n                                    >\n@@ -199,12 +197,12 @@ describe('Error overlay for hydration errors in App router', () => {\n          \"description\": \"A tree hydrated but some attributes of the server rendered HTML didn't match the client properties. This won't be patched up. This can happen if a SSR-ed Client Component used:\",\n          \"environmentLabel\": null,\n          \"label\": \"Console Error\",\n-         \"source\": \"app/(extra-attributes)/layout.tsx (9:5) @ Root\n+         \"source\": \"app/(extra-attributes)/layout.tsx (9:5) @ RootLayout\n        >  9 |     <html {...(isServer ? { className: 'server-html' } : undefined)}>\n             |     ^\",\n          \"stack\": [\n            \"html <anonymous>\",\n-           \"Root app/(extra-attributes)/layout.tsx (9:5)\",\n+           \"RootLayout app/(extra-attributes)/layout.tsx (9:5)\",\n          ],\n        }\n       `)\n@@ -217,18 +215,18 @@ describe('Error overlay for hydration errors in App router', () => {\n     await expect(browser).toDisplayCollapsedRedbox(`\n      {\n        \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"extra-text...\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/extra-tex...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Mismatch} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Mismatch params={Promise} searchParams={Promise}>\n                                  <div className=\"parent\">\n                                    <header>\n@@ -258,18 +256,18 @@ describe('Error overlay for hydration errors in App router', () => {\n     await expect(browser).toDisplayCollapsedRedbox(`\n      {\n        \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"extra-elem...\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/extra-ele...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Mismatch} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Mismatch params={Promise} searchParams={Promise}>\n                                  <div className=\"parent\">\n      -                             <main className=\"only\">\n@@ -296,18 +294,18 @@ describe('Error overlay for hydration errors in App router', () => {\n     await expect(browser).toDisplayCollapsedRedbox(`\n      {\n        \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"extra-text...\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/extra-tex...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Mismatch} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Mismatch params={Promise} searchParams={Promise}>\n                                  <div className=\"parent\">\n      -                             only\n@@ -339,17 +337,17 @@ describe('Error overlay for hydration errors in App router', () => {\n      [\n        {\n          \"componentStack\": \"...\n-         <ScrollAndFocusHandler segmentPath={[...]}>\n-           <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-             <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-               <LoadingBoundary name=\"extra-text...\" loading={null}>\n-                 <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                   <RedirectBoundary>\n-                     <RedirectErrorBoundary router={{...}}>\n-                       <InnerLayoutRouter url=\"/extra-tex...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                         <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                           <SegmentTrieNode>\n-                           <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                           <Next.js Internal Component>\n                              <Page params={Promise} searchParams={Promise}>\n                                <table>\n                                  <tbody>\n@@ -372,18 +370,18 @@ describe('Error overlay for hydration errors in App router', () => {\n        },\n        {\n          \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"extra-text...\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/extra-tex...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Page params={Promise} searchParams={Promise}>\n      +                           <table>\n      -                           test\n@@ -411,18 +409,18 @@ describe('Error overlay for hydration errors in App router', () => {\n     await expect(browser).toDisplayCollapsedRedbox(`\n      {\n        \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"extra-whit...\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/extra-whi...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Page params={Promise} searchParams={Promise}>\n      >                           <table>\n      >                             {\" \"}\n@@ -451,16 +449,16 @@ describe('Error overlay for hydration errors in App router', () => {\n     await expect(browser).toDisplayCollapsedRedbox(`\n      {\n        \"componentStack\": \"...\n-         <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-           <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-             <LoadingBoundary name=\"extra-node...\" loading={null}>\n-               <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                 <RedirectBoundary>\n-                   <RedirectErrorBoundary router={{...}}>\n-                     <InnerLayoutRouter url=\"/extra-nod...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                       <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                         <SegmentTrieNode>\n-                         <ClientPageRoot Component={function Mismatch} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                         <Next.js Internal Component>\n                            <Mismatch params={Promise} searchParams={Promise}>\n                              <div className=\"parent\">\n                                <Suspense fallback={<p>}>\n@@ -506,18 +504,18 @@ describe('Error overlay for hydration errors in App router', () => {\n      [\n        {\n          \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"p-under-p/\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/p-under-p\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Page params={Promise} searchParams={Promise}>\n      >                           <p>\n      >                             <p>\n@@ -563,17 +561,17 @@ describe('Error overlay for hydration errors in App router', () => {\n      [\n        {\n          \"componentStack\": \"...\n-         <ScrollAndFocusHandler segmentPath={[...]}>\n-           <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-             <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-               <LoadingBoundary name=\"div-under-p/\" loading={null}>\n-                 <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                   <RedirectBoundary>\n-                     <RedirectErrorBoundary router={{...}}>\n-                       <InnerLayoutRouter url=\"/div-under-p\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                         <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                           <SegmentTrieNode>\n-                           <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                           <Next.js Internal Component>\n                              <Page params={Promise} searchParams={Promise}>\n                                <div>\n                                  <div>\n@@ -621,18 +619,18 @@ describe('Error overlay for hydration errors in App router', () => {\n      [\n        {\n          \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"tr-under-div/\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/tr-under-div\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Page params={Promise} searchParams={Promise}>\n      >                           <div>\n      >                             <tr>\n@@ -678,18 +676,18 @@ describe('Error overlay for hydration errors in App router', () => {\n      [\n        {\n          \"componentStack\": \"...\n-         <RenderFromTemplateContext>\n-           <ScrollAndFocusHandler segmentPath={[...]}>\n-             <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-               <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                 <LoadingBoundary name=\"bad-nesting/\" loading={null}>\n-                   <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                     <RedirectBoundary>\n-                       <RedirectErrorBoundary router={{...}}>\n-                         <InnerLayoutRouter url=\"/bad-nesting\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                           <SegmentViewNode type=\"page\" pagePath=\"(default)/...\">\n-                             <SegmentTrieNode>\n-                             <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+         <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                             <Next.js Internal Component>\n                                <Page params={Promise} searchParams={Promise}>\n      >                           <p>\n                                    <span>\n@@ -751,264 +749,132 @@ describe('Error overlay for hydration errors in App router', () => {\n       )\n     })\n \n-    if (pprEnabled) {\n-      if (isTurbopack) {\n-        await expect(browser).toDisplayCollapsedRedbox(`\n-         [\n-           {\n-             \"description\": \"Cannot render a sync or defer <script> outside the main document without knowing its order. Try adding async=\"\" or moving it into the root <head> tag.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ Root\n-         >  8 |       <Script\n-              |       ^\",\n-             \"stack\": [\n-               \"Root app/(script-under-html)/layout.tsx (8:7)\",\n-             ],\n-           },\n-           {\n-             \"componentStack\": \"...\n-             <RenderFromTemplateContext>\n-               <ScrollAndFocusHandler segmentPath={[...]}>\n-                 <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                   <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                     <LoadingBoundary loading={null}>\n-                       <HTTPAccessFallbackBoundary notFound={<SegmentViewNode>} forbidden={undefined} unauthorized={undefined}>\n-                         <HTTPAccessFallbackErrorBoundary pathname=\"/script-un...\" notFound={<SegmentViewNode>} ...>\n-                           <RedirectBoundary>\n-                             <RedirectErrorBoundary router={{...}}>\n-                               <InnerLayoutRouter url=\"/script-un...\" tree={[...]} cacheNode={{lazyData:null, ...}} ...>\n-                                 <SegmentViewNode type=\"layout\" pagePath=\"(script-un...\">\n-                                   <SegmentTrieNode>\n-                                   <script>\n-                                   <script>\n-                                   <Root>\n-         >                           <html>\n-                                       <body>\n-                                       <Script src=\"https://ex...\" strategy=\"beforeInte...\">\n-         >                               <script nonce={undefined} dangerouslySetInnerHTML={{__html:\"(self.__ne...\"}}>\n-                               ...\n-                   ...\n-             ...\",\n-             \"description\": \"In HTML, <script> cannot be a child of <html>.\n-         This will cause a hydration error.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ Root\n-         >  8 |       <Script\n-              |       ^\",\n-             \"stack\": [\n-               \"script <anonymous>\",\n-               \"Root app/(script-under-html)/layout.tsx (8:7)\",\n-             ],\n-           },\n-           {\n-             \"description\": \"<html> cannot contain a nested <script>.\n-         See this log for the ancestor stack trace.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (6:5) @ Root\n-         > 6 |     <html>\n-             |     ^\",\n-             \"stack\": [\n-               \"html <anonymous>\",\n-               \"Root app/(script-under-html)/layout.tsx (6:5)\",\n-             ],\n-           },\n-         ]\n-        `)\n-      } else {\n-        await expect(browser).toDisplayCollapsedRedbox(`\n-         [\n-           {\n-             \"description\": \"Cannot render a sync or defer <script> outside the main document without knowing its order. Try adding async=\"\" or moving it into the root <head> tag.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ Root\n-         >  8 |       <Script\n-              |       ^\",\n-             \"stack\": [\n-               \"Root app/(script-under-html)/layout.tsx (8:7)\",\n-             ],\n-           },\n-           {\n-             \"componentStack\": \"...\n-             <RenderFromTemplateContext>\n-               <ScrollAndFocusHandler segmentPath={[...]}>\n-                 <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                   <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                     <LoadingBoundary loading={null}>\n-                       <HTTPAccessFallbackBoundary notFound={<SegmentViewNode>} forbidden={undefined} unauthorized={undefined}>\n-                         <HTTPAccessFallbackErrorBoundary pathname=\"/script-un...\" notFound={<SegmentViewNode>} ...>\n-                           <RedirectBoundary>\n-                             <RedirectErrorBoundary router={{...}}>\n-                               <InnerLayoutRouter url=\"/script-un...\" tree={[...]} cacheNode={{lazyData:null, ...}} ...>\n-                                 <SegmentViewNode type=\"layout\" pagePath=\"(script-un...\">\n-                                   <SegmentTrieNode>\n-                                   <Root>\n-         >                           <html>\n-                                       <body>\n-                                       <Script src=\"https://ex...\" strategy=\"beforeInte...\">\n-         >                               <script nonce={undefined} dangerouslySetInnerHTML={{__html:\"(self.__ne...\"}}>\n-                               ...\n-                   ...\n-             ...\",\n-             \"description\": \"In HTML, <script> cannot be a child of <html>.\n-         This will cause a hydration error.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ Root\n-         >  8 |       <Script\n-              |       ^\",\n-             \"stack\": [\n-               \"script <anonymous>\",\n-               \"Root app/(script-under-html)/layout.tsx (8:7)\",\n-             ],\n-           },\n-           {\n-             \"description\": \"<html> cannot contain a nested <script>.\n-         See this log for the ancestor stack trace.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (6:5) @ Root\n-         > 6 |     <html>\n-             |     ^\",\n-             \"stack\": [\n-               \"html <anonymous>\",\n-               \"Root app/(script-under-html)/layout.tsx (6:5)\",\n-             ],\n-           },\n-         ]\n-        `)\n-      }\n+    if (isTurbopack) {\n+      await expect(browser).toDisplayCollapsedRedbox(`\n+       [\n+         {\n+           \"description\": \"Cannot render a sync or defer <script> outside the main document without knowing its order. Try adding async=\"\" or moving it into the root <head> tag.\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Console Error\",\n+           \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ RootLayout\n+       >  8 |       <Script\n+            |       ^\",\n+           \"stack\": [\n+             \"RootLayout app/(script-under-html)/layout.tsx (8:7)\",\n+           ],\n+         },\n+         {\n+           \"componentStack\": \"...\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                                 <Next.js Internal Component>\n+                                 <script>\n+                                 <script>\n+                                 <RootLayout>\n+       >                           <html>\n+                                     <body>\n+                                     <Script src=\"https://ex...\" strategy=\"beforeInte...\">\n+       >                               <script nonce={undefined} dangerouslySetInnerHTML={{__html:\"(self.__ne...\"}}>\n+                             ...\n+                 ...\",\n+           \"description\": \"In HTML, <script> cannot be a child of <html>.\n+       This will cause a hydration error.\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Console Error\",\n+           \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ RootLayout\n+       >  8 |       <Script\n+            |       ^\",\n+           \"stack\": [\n+             \"script <anonymous>\",\n+             \"RootLayout app/(script-under-html)/layout.tsx (8:7)\",\n+           ],\n+         },\n+         {\n+           \"description\": \"<html> cannot contain a nested <script>.\n+       See this log for the ancestor stack trace.\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Console Error\",\n+           \"source\": \"app/(script-under-html)/layout.tsx (6:5) @ RootLayout\n+       > 6 |     <html>\n+           |     ^\",\n+           \"stack\": [\n+             \"html <anonymous>\",\n+             \"RootLayout app/(script-under-html)/layout.tsx (6:5)\",\n+           ],\n+         },\n+       ]\n+      `)\n     } else {\n-      if (isTurbopack) {\n-        await expect(browser).toDisplayCollapsedRedbox(`\n-         [\n-           {\n-             \"description\": \"Cannot render a sync or defer <script> outside the main document without knowing its order. Try adding async=\"\" or moving it into the root <head> tag.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ Root\n-         >  8 |       <Script\n-              |       ^\",\n-             \"stack\": [\n-               \"Root app/(script-under-html)/layout.tsx (8:7)\",\n-             ],\n-           },\n-           {\n-             \"componentStack\": \"...\n-             <RenderFromTemplateContext>\n-               <ScrollAndFocusHandler segmentPath={[...]}>\n-                 <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                   <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                     <LoadingBoundary name=\"/\" loading={null}>\n-                       <HTTPAccessFallbackBoundary notFound={<SegmentViewNode>} forbidden={undefined} unauthorized={undefined}>\n-                         <HTTPAccessFallbackErrorBoundary pathname=\"/script-un...\" notFound={<SegmentViewNode>} ...>\n-                           <RedirectBoundary>\n-                             <RedirectErrorBoundary router={{...}}>\n-                               <InnerLayoutRouter url=\"/script-un...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                                 <SegmentViewNode type=\"layout\" pagePath=\"(script-un...\">\n-                                   <SegmentTrieNode>\n-                                   <script>\n-                                   <script>\n-                                   <Root>\n-         >                           <html>\n-                                       <body>\n-                                       <Script src=\"https://ex...\" strategy=\"beforeInte...\">\n-         >                               <script nonce={undefined} dangerouslySetInnerHTML={{__html:\"(self.__ne...\"}}>\n-                               ...\n-                   ...\",\n-             \"description\": \"In HTML, <script> cannot be a child of <html>.\n-         This will cause a hydration error.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ Root\n-         >  8 |       <Script\n-              |       ^\",\n-             \"stack\": [\n-               \"script <anonymous>\",\n-               \"Root app/(script-under-html)/layout.tsx (8:7)\",\n-             ],\n-           },\n-           {\n-             \"description\": \"<html> cannot contain a nested <script>.\n-         See this log for the ancestor stack trace.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (6:5) @ Root\n-         > 6 |     <html>\n-             |     ^\",\n-             \"stack\": [\n-               \"html <anonymous>\",\n-               \"Root app/(script-under-html)/layout.tsx (6:5)\",\n-             ],\n-           },\n-         ]\n-        `)\n-      } else {\n-        await expect(browser).toDisplayCollapsedRedbox(`\n-         [\n-           {\n-             \"description\": \"Cannot render a sync or defer <script> outside the main document without knowing its order. Try adding async=\"\" or moving it into the root <head> tag.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ Root\n-         >  8 |       <Script\n-              |       ^\",\n-             \"stack\": [\n-               \"Root app/(script-under-html)/layout.tsx (8:7)\",\n-             ],\n-           },\n-           {\n-             \"componentStack\": \"...\n-             <RenderFromTemplateContext>\n-               <ScrollAndFocusHandler segmentPath={[...]}>\n-                 <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                   <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                     <LoadingBoundary name=\"/\" loading={null}>\n-                       <HTTPAccessFallbackBoundary notFound={<SegmentViewNode>} forbidden={undefined} unauthorized={undefined}>\n-                         <HTTPAccessFallbackErrorBoundary pathname=\"/script-un...\" notFound={<SegmentViewNode>} ...>\n-                           <RedirectBoundary>\n-                             <RedirectErrorBoundary router={{...}}>\n-                               <InnerLayoutRouter url=\"/script-un...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                                 <SegmentViewNode type=\"layout\" pagePath=\"(script-un...\">\n-                                   <SegmentTrieNode>\n-                                   <Root>\n-         >                           <html>\n-                                       <body>\n-                                       <Script src=\"https://ex...\" strategy=\"beforeInte...\">\n-         >                               <script nonce={undefined} dangerouslySetInnerHTML={{__html:\"(self.__ne...\"}}>\n-                               ...\n-                   ...\",\n-             \"description\": \"In HTML, <script> cannot be a child of <html>.\n-         This will cause a hydration error.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ Root\n-         >  8 |       <Script\n-              |       ^\",\n-             \"stack\": [\n-               \"script <anonymous>\",\n-               \"Root app/(script-under-html)/layout.tsx (8:7)\",\n-             ],\n-           },\n-           {\n-             \"description\": \"<html> cannot contain a nested <script>.\n-         See this log for the ancestor stack trace.\",\n-             \"environmentLabel\": null,\n-             \"label\": \"Console Error\",\n-             \"source\": \"app/(script-under-html)/layout.tsx (6:5) @ Root\n-         > 6 |     <html>\n-             |     ^\",\n-             \"stack\": [\n-               \"html <anonymous>\",\n-               \"Root app/(script-under-html)/layout.tsx (6:5)\",\n-             ],\n-           },\n-         ]\n-        `)\n-      }\n+      await expect(browser).toDisplayCollapsedRedbox(`\n+       [\n+         {\n+           \"description\": \"Cannot render a sync or defer <script> outside the main document without knowing its order. Try adding async=\"\" or moving it into the root <head> tag.\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Console Error\",\n+           \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ RootLayout\n+       >  8 |       <Script\n+            |       ^\",\n+           \"stack\": [\n+             \"RootLayout app/(script-under-html)/layout.tsx (8:7)\",\n+           ],\n+         },\n+         {\n+           \"componentStack\": \"...\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                                 <Next.js Internal Component>\n+                                 <RootLayout>\n+       >                           <html>\n+                                     <body>\n+                                     <Script src=\"https://ex...\" strategy=\"beforeInte...\">\n+       >                               <script nonce={undefined} dangerouslySetInnerHTML={{__html:\"(self.__ne...\"}}>\n+                             ...\n+                 ...\",\n+           \"description\": \"In HTML, <script> cannot be a child of <html>.\n+       This will cause a hydration error.\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Console Error\",\n+           \"source\": \"app/(script-under-html)/layout.tsx (8:7) @ RootLayout\n+       >  8 |       <Script\n+            |       ^\",\n+           \"stack\": [\n+             \"script <anonymous>\",\n+             \"RootLayout app/(script-under-html)/layout.tsx (8:7)\",\n+           ],\n+         },\n+         {\n+           \"description\": \"<html> cannot contain a nested <script>.\n+       See this log for the ancestor stack trace.\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Console Error\",\n+           \"source\": \"app/(script-under-html)/layout.tsx (6:5) @ RootLayout\n+       > 6 |     <html>\n+           |     ^\",\n+           \"stack\": [\n+             \"html <anonymous>\",\n+             \"RootLayout app/(script-under-html)/layout.tsx (6:5)\",\n+           ],\n+         },\n+       ]\n+      `)\n     }\n   })\n })"
        },
        {
            "sha": "e6cd58f127587e80570c5387e0677adaf61ffaa7",
            "filename": "test/development/acceptance/hydration-error.test.ts",
            "status": "modified",
            "additions": 80,
            "deletions": 80,
            "changes": 160,
            "blob_url": "https://github.com/vercel/next.js/blob/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance%2Fhydration-error.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Facceptance%2Fhydration-error.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance%2Fhydration-error.test.ts?ref=b0837e0f2451bfe420b082109f259122bf676298",
            "patch": "@@ -102,12 +102,12 @@ describe('Error overlay for hydration errors in Pages router', () => {\n       await expect(browser).toDisplayRedbox(`\n        {\n          \"componentStack\": \"...\n-           <AppContainer>\n-             <Container fn={function fn}>\n-               <PagesDevOverlayBridge>\n-                 <PagesDevOverlayErrorBoundary>\n-                   <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                     <App pageProps={{}} Component={function Mismatch} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n                        <Mismatch>\n                          <div className=\"parent\">\n                            <main className=\"child\">\n@@ -207,12 +207,12 @@ describe('Error overlay for hydration errors in Pages router', () => {\n       await expect(browser).toDisplayRedbox(`\n        {\n          \"componentStack\": \"...\n-           <AppContainer>\n-             <Container fn={function fn}>\n-               <PagesDevOverlayBridge>\n-                 <PagesDevOverlayErrorBoundary>\n-                   <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                     <App pageProps={{}} Component={function Mismatch} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n                        <Mismatch>\n                          <div className=\"parent\">\n        +                   <main className=\"only\">\n@@ -297,12 +297,12 @@ describe('Error overlay for hydration errors in Pages router', () => {\n       await expect(browser).toDisplayRedbox(`\n        {\n          \"componentStack\": \"...\n-           <AppContainer>\n-             <Container fn={function fn}>\n-               <PagesDevOverlayBridge>\n-                 <PagesDevOverlayErrorBoundary>\n-                   <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                     <App pageProps={{}} Component={function Mismatch} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n                        <Mismatch>\n                          <div className=\"parent\">\n                            <header>\n@@ -370,14 +370,14 @@ describe('Error overlay for hydration errors in Pages router', () => {\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n-         \"componentStack\": \"<Root callbacks={[...]}>\n-           <Head>\n-           <AppContainer>\n-             <Container fn={function fn}>\n-               <PagesDevOverlayBridge>\n-                 <PagesDevOverlayErrorBoundary>\n-                   <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                     <App pageProps={{}} Component={function Mismatch} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+         \"componentStack\": \"<Next.js Internal Component>\n+           <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n                        <Mismatch>\n                          <div className=\"parent\">\n        -                   <main className=\"only\">\n@@ -440,14 +440,14 @@ describe('Error overlay for hydration errors in Pages router', () => {\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n-         \"componentStack\": \"<Root callbacks={[...]}>\n-           <Head>\n-           <AppContainer>\n-             <Container fn={function fn}>\n-               <PagesDevOverlayBridge>\n-                 <PagesDevOverlayErrorBoundary>\n-                   <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                     <App pageProps={{}} Component={function Mismatch} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+         \"componentStack\": \"<Next.js Internal Component>\n+           <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n                        <Mismatch>\n                          <div className=\"parent\">\n        -                   only\n@@ -532,11 +532,11 @@ describe('Error overlay for hydration errors in Pages router', () => {\n       await expect(browser).toDisplayRedbox(`\n        {\n          \"componentStack\": \"...\n-           <Container fn={function fn}>\n-             <PagesDevOverlayBridge>\n-               <PagesDevOverlayErrorBoundary>\n-                 <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                   <App pageProps={{}} Component={function Page} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n                      <Page>\n                        <table>\n                          <tbody>\n@@ -617,14 +617,14 @@ describe('Error overlay for hydration errors in Pages router', () => {\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n-         \"componentStack\": \"<Root callbacks={[...]}>\n-           <Head>\n-           <AppContainer>\n-             <Container fn={function fn}>\n-               <PagesDevOverlayBridge>\n-                 <PagesDevOverlayErrorBoundary>\n-                   <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                     <App pageProps={{}} Component={function Page} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+         \"componentStack\": \"<Next.js Internal Component>\n+           <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n                        <Page>\n        >                 <table>\n        >                   {\" 123\"}\n@@ -714,10 +714,10 @@ describe('Error overlay for hydration errors in Pages router', () => {\n       await expect(browser).toDisplayRedbox(`\n        {\n          \"componentStack\": \"...\n-           <PagesDevOverlayBridge>\n-             <PagesDevOverlayErrorBoundary>\n-               <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                 <App pageProps={{}} Component={function Mismatch} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n                    <Mismatch>\n                      <div className=\"parent\">\n                        <Suspense fallback={<p>}>\n@@ -833,14 +833,14 @@ describe('Error overlay for hydration errors in Pages router', () => {\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n-         \"componentStack\": \"<Root callbacks={[...]}>\n-           <Head>\n-           <AppContainer>\n-             <Container fn={function fn}>\n-               <PagesDevOverlayBridge>\n-                 <PagesDevOverlayErrorBoundary>\n-                   <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                     <App pageProps={{}} Component={function Page} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+         \"componentStack\": \"<Next.js Internal Component>\n+           <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n                        <Page>\n        >                 <p>\n        >                   <p>\n@@ -929,11 +929,11 @@ describe('Error overlay for hydration errors in Pages router', () => {\n       await expect(browser).toDisplayRedbox(`\n        {\n          \"componentStack\": \"...\n-           <Container fn={function fn}>\n-             <PagesDevOverlayBridge>\n-               <PagesDevOverlayErrorBoundary>\n-                 <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                   <App pageProps={{}} Component={function Page} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n                      <Page>\n                        <div>\n                          <div>\n@@ -1011,14 +1011,14 @@ describe('Error overlay for hydration errors in Pages router', () => {\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n-         \"componentStack\": \"<Root callbacks={[...]}>\n-           <Head>\n-           <AppContainer>\n-             <Container fn={function fn}>\n-               <PagesDevOverlayBridge>\n-                 <PagesDevOverlayErrorBoundary>\n-                   <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                     <App pageProps={{}} Component={function Page} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+         \"componentStack\": \"<Next.js Internal Component>\n+           <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n                        <Page>\n        >                 <div>\n        >                   <tr>\n@@ -1104,14 +1104,14 @@ describe('Error overlay for hydration errors in Pages router', () => {\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n-         \"componentStack\": \"<Root callbacks={[...]}>\n-           <Head>\n-           <AppContainer>\n-             <Container fn={function fn}>\n-               <PagesDevOverlayBridge>\n-                 <PagesDevOverlayErrorBoundary>\n-                   <PathnameContextProviderAdapter router={{sdc:{},sbc:{}, ...}} isAutoExport={true}>\n-                     <App pageProps={{}} Component={function Page} err={undefined} router={{sdc:{},sbc:{}, ...}}>\n+         \"componentStack\": \"<Next.js Internal Component>\n+           <Next.js Internal Component>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n                        <Page>\n        >                 <p>\n                            <span>"
        },
        {
            "sha": "e95d5029992112963b53c14019b3e0c24e2acc18",
            "filename": "test/development/app-dir/hydration-error-count/hydration-error-count.test.ts",
            "status": "modified",
            "additions": 108,
            "deletions": 108,
            "changes": 216,
            "blob_url": "https://github.com/vercel/next.js/blob/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Fapp-dir%2Fhydration-error-count%2Fhydration-error-count.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b0837e0f2451bfe420b082109f259122bf676298/test%2Fdevelopment%2Fapp-dir%2Fhydration-error-count%2Fhydration-error-count.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fhydration-error-count%2Fhydration-error-count.test.ts?ref=b0837e0f2451bfe420b082109f259122bf676298",
            "patch": "@@ -13,18 +13,18 @@ describe('hydration-error-count', () => {\n        [\n          {\n            \"componentStack\": \"...\n-           <RenderFromTemplateContext>\n-             <ScrollAndFocusHandler segmentPath={[...]}>\n-               <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                 <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                   <LoadingBoundary name=\"bad-nesting/\" loading={null}>\n-                     <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/bad-nesting\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"page\" pagePath=\"bad-nestin...\">\n-                               <SegmentTrieNode>\n-                               <ClientPageRoot Component={function Page} serverProvidedParams={null}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                  <Page params={Promise} searchParams={Promise}>\n        >                           <p>\n        >                             <p>\n@@ -62,18 +62,18 @@ describe('hydration-error-count', () => {\n        [\n          {\n            \"componentStack\": \"...\n-           <RenderFromTemplateContext>\n-             <ScrollAndFocusHandler segmentPath={[...]}>\n-               <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                 <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                   <LoadingBoundary name=\"bad-nesting/\" loading={null}>\n-                     <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/bad-nesting\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"page\" pagePath=\"bad-nestin...\">\n-                               <SegmentTrieNode>\n-                               <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                  <Page params={Promise} searchParams={Promise}>\n        >                           <p>\n        >                             <p>\n@@ -116,18 +116,18 @@ describe('hydration-error-count', () => {\n       await expect(browser).toDisplayCollapsedRedbox(`\n        {\n          \"componentStack\": \"...\n-           <RenderFromTemplateContext>\n-             <ScrollAndFocusHandler segmentPath={[...]}>\n-               <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                 <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                   <LoadingBoundary name=\"html-diff/\" loading={null}>\n-                     <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/html-diff\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"page\" pagePath=\"html-diff/...\">\n-                               <SegmentTrieNode>\n-                               <ClientPageRoot Component={function Page} serverProvidedParams={null}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                  <Page params={Promise} searchParams={Promise}>\n                                    <p>\n        +                             client\n@@ -151,18 +151,18 @@ describe('hydration-error-count', () => {\n       await expect(browser).toDisplayCollapsedRedbox(`\n        {\n          \"componentStack\": \"...\n-           <RenderFromTemplateContext>\n-             <ScrollAndFocusHandler segmentPath={[...]}>\n-               <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                 <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                   <LoadingBoundary name=\"html-diff/\" loading={null}>\n-                     <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/html-diff\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"page\" pagePath=\"html-diff/...\">\n-                               <SegmentTrieNode>\n-                               <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                  <Page params={Promise} searchParams={Promise}>\n                                    <p>\n        +                             client\n@@ -193,18 +193,18 @@ describe('hydration-error-count', () => {\n        [\n          {\n            \"componentStack\": \"...\n-           <RenderFromTemplateContext>\n-             <ScrollAndFocusHandler segmentPath={[...]}>\n-               <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                 <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                   <LoadingBoundary name=\"two-issues/\" loading={null}>\n-                     <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/two-issues\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"page\" pagePath=\"two-issues...\">\n-                               <SegmentTrieNode>\n-                               <ClientPageRoot Component={function Page} serverProvidedParams={null}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                  <Page params={Promise} searchParams={Promise}>\n        >                           <p className=\"client\">\n        >                             <p>\n@@ -225,18 +225,18 @@ describe('hydration-error-count', () => {\n          },\n          {\n            \"componentStack\": \"...\n-           <RenderFromTemplateContext>\n-             <ScrollAndFocusHandler segmentPath={[...]}>\n-               <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                 <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                   <LoadingBoundary name=\"two-issues/\" loading={null}>\n-                     <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/two-issues\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"page\" pagePath=\"two-issues...\">\n-                               <SegmentTrieNode>\n-                               <ClientPageRoot Component={function Page} serverProvidedParams={null}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                  <Page params={Promise} searchParams={Promise}>\n                                    <p\n        +                             className=\"client\"\n@@ -263,18 +263,18 @@ describe('hydration-error-count', () => {\n        [\n          {\n            \"componentStack\": \"...\n-           <RenderFromTemplateContext>\n-             <ScrollAndFocusHandler segmentPath={[...]}>\n-               <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                 <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                   <LoadingBoundary name=\"two-issues/\" loading={null}>\n-                     <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/two-issues\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"page\" pagePath=\"two-issues...\">\n-                               <SegmentTrieNode>\n-                               <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                  <Page params={Promise} searchParams={Promise}>\n        >                           <p className=\"client\">\n        >                             <p>\n@@ -295,18 +295,18 @@ describe('hydration-error-count', () => {\n          },\n          {\n            \"componentStack\": \"...\n-           <RenderFromTemplateContext>\n-             <ScrollAndFocusHandler segmentPath={[...]}>\n-               <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                 <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                   <LoadingBoundary name=\"two-issues/\" loading={null}>\n-                     <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/two-issues\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"page\" pagePath=\"two-issues...\">\n-                               <SegmentTrieNode>\n-                               <ClientPageRoot Component={function Page} serverProvidedParams={{...}}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                  <Page params={Promise} searchParams={Promise}>\n                                    <p\n        +                             className=\"client\"\n@@ -339,18 +339,18 @@ describe('hydration-error-count', () => {\n        [\n          {\n            \"componentStack\": \"...\n-           <RenderFromTemplateContext>\n-             <ScrollAndFocusHandler segmentPath={[...]}>\n-               <InnerScrollAndFocusHandler segmentPath={[...]} focusAndScrollRef={{apply:false, ...}}>\n-                 <ErrorBoundary errorComponent={undefined} errorStyles={undefined} errorScripts={undefined}>\n-                   <LoadingBoundary name=\"hydration-...\" loading={null}>\n-                     <HTTPAccessFallbackBoundary notFound={undefined} forbidden={undefined} unauthorized={undefined}>\n-                       <RedirectBoundary>\n-                         <RedirectErrorBoundary router={{...}}>\n-                           <InnerLayoutRouter url=\"/hydration...\" tree={[...]} params={{}} cacheNode={{lazyData:null, ...}} ...>\n-                             <SegmentViewNode type=\"page\" pagePath=\"hydration-...\">\n-                               <SegmentTrieNode>\n-                               <ClientPageRoot Component={function Page} serverProvidedParams={null}>\n+           <Next.js Internal Component>\n+             <Next.js Internal Component>\n+               <Next.js Internal Component>\n+                 <Next.js Internal Component>\n+                   <Next.js Internal Component>\n+                     <Next.js Internal Component>\n+                       <Next.js Internal Component>\n+                         <Next.js Internal Component>\n+                           <Next.js Internal Component>\n+                             <Next.js Internal Component>\n+                               <Next.js Internal Component>\n+                               <Next.js Internal Component>\n                                  <Page params={Promise} searchParams={Promise}>\n        >                           <p>\n        >                             <p>"
        },
        {
            "sha": "60faf0f8228c5fd26fd6f808e7878dd46ee087d9",
            "filename": "test/lib/next-test-utils.ts",
            "status": "modified",
            "additions": 58,
            "deletions": 7,
            "changes": 65,
            "blob_url": "https://github.com/vercel/next.js/blob/b0837e0f2451bfe420b082109f259122bf676298/test%2Flib%2Fnext-test-utils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/b0837e0f2451bfe420b082109f259122bf676298/test%2Flib%2Fnext-test-utils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Flib%2Fnext-test-utils.ts?ref=b0837e0f2451bfe420b082109f259122bf676298",
            "patch": "@@ -1446,24 +1446,75 @@ export function getSnapshotTestDescribe(variant: TestVariants) {\n   return shouldSkip ? describe.skip : describe\n }\n \n+const nextjsClientComponentNames = [\n+  // Pages Router\n+  'App',\n+  'AppContainer',\n+  'Container',\n+  'Head',\n+  'PagesDevOverlayBridge',\n+  'PagesDevOverlayErrorBoundary',\n+  'PathnameContextProviderAdapter',\n+  // App Router\n+  'ClientPageRoot',\n+  'ClientSegmentRoot',\n+  'HTTPAccessFallbackBoundary',\n+  'HTTPAccessFallbackErrorBoundary',\n+  'InnerLayoutRouter',\n+  'InnerScrollAndFocusHandler',\n+  'RedirectBoundary',\n+  'RedirectErrorBoundary',\n+  'RenderFromTemplateContext',\n+  'Root',\n+  'ScrollAndFocusHandler',\n+  'SegmentViewNode',\n+  'SegmentTrieNode',\n+  // These are added due to user actions e.g. loading.js -> LoadingBoundary\n+  // They may be relevant in some context in the future.\n+  // Consider including them in different assertions.\n+  'ErrorBoundary',\n+  'LoadingBoundary',\n+]\n+const nextjsClientComponentStackFrame = new RegExp(\n+  `^(\\\\s*)<(${nextjsClientComponentNames.join('|')})(>| )`\n+)\n+\n /**\n  * @returns `null` if there are no frames\n  */\n export async function getRedboxComponentStack(\n-  browser: Playwright\n+  browser: Playwright,\n+  includeNextjsInternalComponents = false\n ): Promise<string | null> {\n-  const componentStackFrameElements = await browser.elementsByCss(\n+  const componentStackTraceElements = await browser.elementsByCss(\n     '[data-nextjs-container-errors-pseudo-html] code'\n   )\n-  if (componentStackFrameElements.length === 0) {\n+  if (componentStackTraceElements.length === 0) {\n     return null\n   }\n \n-  const componentStackFrameTexts = await Promise.all(\n-    componentStackFrameElements.map((f) => f.innerText())\n-  )\n+  const componentStackTrace = await componentStackTraceElements[0].innerText()\n+  const componentStackFrames = componentStackTrace.split('\\n')\n+\n+  return componentStackFrames\n+    .map((componentStackFrame) => {\n+      if (!includeNextjsInternalComponents) {\n+        const componentStackFrameMatch = componentStackFrame.match(\n+          nextjsClientComponentStackFrame\n+        )\n+        // React component stack frames aren't subject to ignore-listing.\n+        // They're not relevant for our tests though.\n+        // If you need to assert on Next.js internal component frames,\n+        // use `getRedboxComponentStack(browser, true)` instead.\n+        if (componentStackFrameMatch) {\n+          return componentStackFrameMatch[1] + '<Next.js Internal Component>'\n+        }\n+      }\n \n-  return componentStackFrameTexts.join('\\n').trim()\n+      return componentStackFrame\n+    })\n+    .join('\\n')\n+    .trim()\n }\n \n export async function hasRedboxCallStack(browser: Playwright) {"
        }
    ],
    "stats": {
        "total": 1195,
        "additions": 556,
        "deletions": 639
    }
}