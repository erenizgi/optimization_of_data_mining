{
    "author": "huozhi",
    "message": "[docs] update other params type of metadata image routes (#84491)\n\nCo-authored-by: Joseph Chamochumbi <joseph.chamochumbi@vercel.com>",
    "sha": "c08e05f5c7b268ed41d024bc640390965894d091",
    "files": [
        {
            "sha": "4f958c39dc24c236f4b256b6c289b577eeb76a23",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/01-metadata/app-icons.mdx",
            "status": "modified",
            "additions": 20,
            "deletions": 11,
            "changes": 31,
            "blob_url": "https://github.com/vercel/next.js/blob/c08e05f5c7b268ed41d024bc640390965894d091/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Fapp-icons.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/c08e05f5c7b268ed41d024bc640390965894d091/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Fapp-icons.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Fapp-icons.mdx?ref=c08e05f5c7b268ed41d024bc640390965894d091",
            "patch": "@@ -177,25 +177,33 @@ The default export function receives the following props:\n \n #### `params` (optional)\n \n-An object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) object from the root segment down to the segment `icon` or `apple-icon` is colocated in.\n+A promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) object from the root segment down to the segment `icon` or `apple-icon` is colocated in.\n+\n+> **Good to know**: If you use [`generateImageMetadata`](/docs/app/api-reference/functions/generate-image-metadata), the function will also receive an `id` prop that is a promise resolving to the `id` value from one of the items returned by `generateImageMetadata`.\n \n ```tsx filename=\"app/shop/[slug]/icon.tsx\" switcher\n-export default function Icon({ params }: { params: { slug: string } }) {\n+export default async function Icon({\n+  params,\n+}: {\n+  params: Promise<{ slug: string }>\n+}) {\n+  const { slug } = await params\n   // ...\n }\n ```\n \n ```jsx filename=\"app/shop/[slug]/icon.js\" switcher\n-export default function Icon({ params }) {\n+export default async function Icon({ params }) {\n+  const { slug } = await params\n   // ...\n }\n ```\n \n-| Route                           | URL         | `params`                  |\n-| ------------------------------- | ----------- | ------------------------- |\n-| `app/shop/icon.js`              | `/shop`     | `undefined`               |\n-| `app/shop/[slug]/icon.js`       | `/shop/1`   | `{ slug: '1' }`           |\n-| `app/shop/[tag]/[item]/icon.js` | `/shop/1/2` | `{ tag: '1', item: '2' }` |\n+| Route                           | URL         | `params`                           |\n+| ------------------------------- | ----------- | ---------------------------------- |\n+| `app/shop/icon.js`              | `/shop`     | `undefined`                        |\n+| `app/shop/[slug]/icon.js`       | `/shop/1`   | `Promise<{ slug: '1' }>`           |\n+| `app/shop/[tag]/[item]/icon.js` | `/shop/1/2` | `Promise<{ tag: '1', item: '2' }>` |\n \n ### Returns\n \n@@ -254,6 +262,7 @@ export default function Icon() {}\n \n ## Version History\n \n-| Version   | Changes                                      |\n-| --------- | -------------------------------------------- |\n-| `v13.3.0` | `favicon` `icon` and `apple-icon` introduced |\n+| Version   | Changes                                              |\n+| --------- | ---------------------------------------------------- |\n+| `v16.0.0` | `params` is now a promise that resolves to an object |\n+| `v13.3.0` | `favicon` `icon` and `apple-icon` introduced         |"
        },
        {
            "sha": "2954008094e0205138187ca75be4ebf0677814ec",
            "filename": "docs/01-app/03-api-reference/03-file-conventions/01-metadata/opengraph-image.mdx",
            "status": "modified",
            "additions": 29,
            "deletions": 14,
            "changes": 43,
            "blob_url": "https://github.com/vercel/next.js/blob/c08e05f5c7b268ed41d024bc640390965894d091/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Fopengraph-image.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/c08e05f5c7b268ed41d024bc640390965894d091/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Fopengraph-image.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F03-file-conventions%2F01-metadata%2Fopengraph-image.mdx?ref=c08e05f5c7b268ed41d024bc640390965894d091",
            "patch": "@@ -220,25 +220,33 @@ The default export function receives the following props:\n \n #### `params` (optional)\n \n-An object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) object from the root segment down to the segment `opengraph-image` or `twitter-image` is colocated in.\n+A promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) object from the root segment down to the segment `opengraph-image` or `twitter-image` is colocated in.\n+\n+> **Good to know**: If you use [`generateImageMetadata`](/docs/app/api-reference/functions/generate-image-metadata), the function will also receive an `id` prop that is a promise resolving to the `id` value from one of the items returned by `generateImageMetadata`.\n \n ```tsx filename=\"app/shop/[slug]/opengraph-image.tsx\" switcher\n-export default function Image({ params }: { params: { slug: string } }) {\n+export default async function Image({\n+  params,\n+}: {\n+  params: Promise<{ slug: string }>\n+}) {\n+  const { slug } = await params\n   // ...\n }\n ```\n \n ```jsx filename=\"app/shop/[slug]/opengraph-image.js\" switcher\n-export default function Image({ params }) {\n+export default async function Image({ params }) {\n+  const { slug } = await params\n   // ...\n }\n ```\n \n-| Route                                      | URL         | `params`                  |\n-| ------------------------------------------ | ----------- | ------------------------- |\n-| `app/shop/opengraph-image.js`              | `/shop`     | `undefined`               |\n-| `app/shop/[slug]/opengraph-image.js`       | `/shop/1`   | `{ slug: '1' }`           |\n-| `app/shop/[tag]/[item]/opengraph-image.js` | `/shop/1/2` | `{ tag: '1', item: '2' }` |\n+| Route                                      | URL         | `params`                           |\n+| ------------------------------------------ | ----------- | ---------------------------------- |\n+| `app/shop/opengraph-image.js`              | `/shop`     | `undefined`                        |\n+| `app/shop/[slug]/opengraph-image.js`       | `/shop/1`   | `Promise<{ slug: '1' }>`           |\n+| `app/shop/[tag]/[item]/opengraph-image.js` | `/shop/1/2` | `Promise<{ tag: '1', item: '2' }>` |\n \n ### Returns\n \n@@ -334,8 +342,13 @@ export const size = {\n }\n export const contentType = 'image/png'\n \n-export default async function Image({ params }: { params: { slug: string } }) {\n-  const post = await fetch(`https://.../posts/${params.slug}`).then((res) =>\n+export default async function Image({\n+  params,\n+}: {\n+  params: Promise<{ slug: string }>\n+}) {\n+  const { slug } = await params\n+  const post = await fetch(`https://.../posts/${slug}`).then((res) =>\n     res.json()\n   )\n \n@@ -373,7 +386,8 @@ export const size = {\n export const contentType = 'image/png'\n \n export default async function Image({ params }) {\n-  const post = await fetch(`https://.../posts/${params.slug}`).then((res) =>\n+  const { slug } = await params\n+  const post = await fetch(`https://.../posts/${slug}`).then((res) =>\n     res.json()\n   )\n \n@@ -509,6 +523,7 @@ export default async function Image() {\n \n ## Version History\n \n-| Version   | Changes                                           |\n-| --------- | ------------------------------------------------- |\n-| `v13.3.0` | `opengraph-image` and `twitter-image` introduced. |\n+| Version   | Changes                                              |\n+| --------- | ---------------------------------------------------- |\n+| `v16.0.0` | `params` is now a promise that resolves to an object |\n+| `v13.3.0` | `opengraph-image` and `twitter-image` introduced.    |"
        },
        {
            "sha": "c0c4149342a2502d07bf7ceb0c7ec9c8f58dea39",
            "filename": "docs/01-app/03-api-reference/04-functions/generate-image-metadata.mdx",
            "status": "modified",
            "additions": 60,
            "deletions": 12,
            "changes": 72,
            "blob_url": "https://github.com/vercel/next.js/blob/c08e05f5c7b268ed41d024bc640390965894d091/docs%2F01-app%2F03-api-reference%2F04-functions%2Fgenerate-image-metadata.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/c08e05f5c7b268ed41d024bc640390965894d091/docs%2F01-app%2F03-api-reference%2F04-functions%2Fgenerate-image-metadata.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2Fgenerate-image-metadata.mdx?ref=c08e05f5c7b268ed41d024bc640390965894d091",
            "patch": "@@ -42,7 +42,7 @@ export function generateImageMetadata({ params }) {\n \n ## Returns\n \n-The `generateImageMetadata` function should return an `array` of objects containing the image's metadata such as `alt` and `size`. In addition, each item **must** include an `id` value which will be passed to the props of the image generating function.\n+The `generateImageMetadata` function should return an `array` of objects containing the image's metadata such as `alt` and `size`. In addition, each item **must** include an `id` value which will be passed as a promise to the props of the image generating function.\n \n | Image Metadata Object | Type                                |\n | --------------------- | ----------------------------------- |\n@@ -69,7 +69,8 @@ export function generateImageMetadata() {\n   ]\n }\n \n-export default function Icon({ id }: { id: string }) {\n+export default async function Icon({ id }: { id: Promise<string | number> }) {\n+  const iconId = await id\n   return new ImageResponse(\n     (\n       <div\n@@ -84,7 +85,7 @@ export default function Icon({ id }: { id: string }) {\n           color: '#fafafa',\n         }}\n       >\n-        Icon {id}\n+        Icon {iconId}\n       </div>\n     )\n   )\n@@ -109,7 +110,8 @@ export function generateImageMetadata() {\n   ]\n }\n \n-export default function Icon({ id }) {\n+export default async function Icon({ id }) {\n+  const iconId = await id\n   return new ImageResponse(\n     (\n       <div\n@@ -124,13 +126,57 @@ export default function Icon({ id }) {\n           color: '#fafafa',\n         }}\n       >\n-        Icon {id}\n+        Icon {iconId}\n       </div>\n     )\n   )\n }\n ```\n \n+## Image generation function props\n+\n+When using `generateImageMetadata`, the default export image generation function receives the following props:\n+\n+#### `id`\n+\n+A promise that resolves to the `id` value from one of the items returned by `generateImageMetadata`. The `id` will be a `string` or `number` depending on what was returned from `generateImageMetadata`.\n+\n+```tsx filename=\"icon.tsx\" switcher\n+export default async function Icon({ id }: { id: Promise<string | number> }) {\n+  const iconId = await id\n+  // Use iconId to generate the image\n+}\n+```\n+\n+```jsx filename=\"icon.js\" switcher\n+export default async function Icon({ id }) {\n+  const iconId = await id\n+  // Use iconId to generate the image\n+}\n+```\n+\n+#### `params` (optional)\n+\n+A promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) from the root segment down to the segment the image is colocated in.\n+\n+```tsx filename=\"icon.tsx\" switcher\n+export default async function Icon({\n+  params,\n+}: {\n+  params: Promise<{ slug: string }>\n+}) {\n+  const { slug } = await params\n+  // Use slug to generate the image\n+}\n+```\n+\n+```jsx filename=\"icon.js\" switcher\n+export default async function Icon({ params }) {\n+  const { slug } = await params\n+  // Use slug to generate the image\n+}\n+```\n+\n ### Examples\n \n #### Using external data\n@@ -160,11 +206,11 @@ export default async function Image({\n   params,\n   id,\n }: {\n-  params: { id: string }\n-  id: number\n+  params: Promise<{ id: string }>\n+  id: Promise<number>\n }) {\n   const productId = (await params).id\n-  const imageId = id\n+  const imageId = await id\n   const text = await getCaptionForImage(productId, imageId)\n \n   return new ImageResponse(\n@@ -200,7 +246,7 @@ export async function generateImageMetadata({ params }) {\n \n export default async function Image({ params, id }) {\n   const productId = (await params).id\n-  const imageId = id\n+  const imageId = await id\n   const text = await getCaptionForImage(productId, imageId)\n \n   return new ImageResponse(\n@@ -221,6 +267,8 @@ export default async function Image({ params, id }) {\n \n ## Version History\n \n-| Version   | Changes                             |\n-| --------- | ----------------------------------- |\n-| `v13.3.0` | `generateImageMetadata` introduced. |\n+| Version   | Changes                                                                                             |\n+| --------- | --------------------------------------------------------------------------------------------------- |\n+| `v16.0.0` | `id` passed to the Image generation function is now a promise that resolves to `string` or `number` |\n+| `v16.0.0` | `params` passed to the Image generation function is now a promise that resolves to an object        |\n+| `v13.3.0` | `generateImageMetadata` introduced.                                                                 |"
        }
    ],
    "stats": {
        "total": 146,
        "additions": 109,
        "deletions": 37
    }
}