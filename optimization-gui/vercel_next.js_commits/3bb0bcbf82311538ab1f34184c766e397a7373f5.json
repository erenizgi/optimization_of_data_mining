{
    "author": "mischnic",
    "message": "Add pino-related packages to server-external-packages (#86884)",
    "sha": "3bb0bcbf82311538ab1f34184c766e397a7373f5",
    "files": [
        {
            "sha": "e141d9986e399029247239332873d81d30c95add",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/serverExternalPackages.mdx",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/3bb0bcbf82311538ab1f34184c766e397a7373f5/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FserverExternalPackages.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3bb0bcbf82311538ab1f34184c766e397a7373f5/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FserverExternalPackages.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FserverExternalPackages.mdx?ref=3bb0bcbf82311538ab1f34184c766e397a7373f5",
            "patch": "@@ -73,6 +73,9 @@ Next.js includes a [short list of popular packages](https://github.com/vercel/ne\n - `onnxruntime-node`\n - `oslo`\n - `pg`\n+- `pino`\n+- `pino-pretty`\n+- `pino-roll`\n - `playwright`\n - `playwright-core`\n - `postcss`\n@@ -86,8 +89,9 @@ Next.js includes a [short list of popular packages](https://github.com/vercel/ne\n - `sharp`\n - `shiki`\n - `sqlite3`\n-- `ts-node`\n+- `thread-stream`\n - `ts-morph`\n+- `ts-node`\n - `typescript`\n - `vscode-oniguruma`\n - `webpack`"
        },
        {
            "sha": "72c32e37cf295316d8c521513149f4f7ece1149f",
            "filename": "docs/02-pages/04-api-reference/04-config/01-next-config-js/serverExternalPackages.mdx",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/3bb0bcbf82311538ab1f34184c766e397a7373f5/docs%2F02-pages%2F04-api-reference%2F04-config%2F01-next-config-js%2FserverExternalPackages.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/3bb0bcbf82311538ab1f34184c766e397a7373f5/docs%2F02-pages%2F04-api-reference%2F04-config%2F01-next-config-js%2FserverExternalPackages.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F04-api-reference%2F04-config%2F01-next-config-js%2FserverExternalPackages.mdx?ref=3bb0bcbf82311538ab1f34184c766e397a7373f5",
            "patch": "@@ -73,6 +73,9 @@ Next.js includes a [short list of popular packages](https://github.com/vercel/ne\n - `onnxruntime-node`\n - `oslo`\n - `pg`\n+- `pino`\n+- `pino-pretty`\n+- `pino-roll`\n - `playwright`\n - `playwright-core`\n - `postcss`\n@@ -86,8 +89,9 @@ Next.js includes a [short list of popular packages](https://github.com/vercel/ne\n - `sharp`\n - `shiki`\n - `sqlite3`\n-- `ts-node`\n+- `thread-stream`\n - `ts-morph`\n+- `ts-node`\n - `typescript`\n - `vscode-oniguruma`\n - `webpack`"
        },
        {
            "sha": "fd596ddcb21a7e95607a01ee770a7053208096bd",
            "filename": "packages/next/src/lib/server-external-packages.jsonc",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/3bb0bcbf82311538ab1f34184c766e397a7373f5/packages%2Fnext%2Fsrc%2Flib%2Fserver-external-packages.jsonc",
            "raw_url": "https://github.com/vercel/next.js/raw/3bb0bcbf82311538ab1f34184c766e397a7373f5/packages%2Fnext%2Fsrc%2Flib%2Fserver-external-packages.jsonc",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fserver-external-packages.jsonc?ref=3bb0bcbf82311538ab1f34184c766e397a7373f5",
            "patch": "@@ -65,6 +65,14 @@\n   \"onnxruntime-node\",\n   \"oslo\",\n   \"pg\",\n+  // pino@10.1.0/lib/transport.js passes `join(__dirname, 'worker.js')` to thread-stream which ends\n+  // up `require`ing that filepath, leading to\n+  // `Cannot find module '/ROOT/node_modules/.pnpm/pino@10.1.0/node_modules/pino/lib/worker.js'`\n+  \"pino\",\n+  // A \"plugin\" that is passed to pino as a string (and is then required in a worker)\n+  \"pino-pretty\",\n+  // A \"plugin\" that is passed to pino as a string (and is then required in a worker)\n+  \"pino-roll\",\n   \"playwright\",\n   \"playwright-core\",\n   \"postcss\",\n@@ -80,9 +88,12 @@\n   \"sharp\",\n   \"shiki\",\n   \"sqlite3\",\n-  \"ts-node\",\n+  // dynamic `new Worker` call in thread-stream@3.1.0/index.js which pulls in various non-code files\n+  // as well (trying to parse README and invalid test files)\n+  \"thread-stream\",\n   // Slow to compile because it pulls in typescript\n   \"ts-morph\",\n+  \"ts-node\",\n   \"typescript\",\n   \"vscode-oniguruma\",\n   \"webpack\","
        }
    ],
    "stats": {
        "total": 25,
        "additions": 22,
        "deletions": 3
    }
}