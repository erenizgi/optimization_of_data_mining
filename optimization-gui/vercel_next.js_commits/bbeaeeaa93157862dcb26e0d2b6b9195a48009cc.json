{
    "author": "ztanner",
    "message": "Revert \"[turbopack] Set `liveness` of exports based on assignment anaâ€¦ (#84207)\n\nWe believe this is causing an issue that was caught during internal\ndogfooding.\n\nThis reverts commit ba227046ef42a8080b1fbe274fe842c0c7067bff.\n\n<!-- Thanks for opening a PR! Your contribution is much appreciated.\nTo make sure your PR is handled as smoothly as possible we request that\nyou follow the checklist sections below.\nChoose the right checklist for the change(s) that you're making:\n\n## For Contributors\n\n### Improving Documentation\n\n- Run `pnpm prettier-fix` to fix formatting issues before opening the\nPR.\n- Read the Docs Contribution Guide to ensure your contribution follows\nthe docs guidelines:\nhttps://nextjs.org/docs/community/contribution-guide\n\n### Fixing a bug\n\n- Related issues linked using `fixes #number`\n- Tests added. See:\nhttps://github.com/vercel/next.js/blob/canary/contributing/core/testing.md#writing-tests-for-nextjs\n- Errors have a helpful link attached, see\nhttps://github.com/vercel/next.js/blob/canary/contributing.md\n\n### Adding a feature\n\n- Implements an existing feature request or RFC. Make sure the feature\nrequest has been accepted for implementation before opening a PR. (A\ndiscussion must be opened, see\nhttps://github.com/vercel/next.js/discussions/new?category=ideas)\n- Related issues/discussions are linked using `fixes #number`\n- e2e tests added\n(https://github.com/vercel/next.js/blob/canary/contributing/core/testing.md#writing-tests-for-nextjs)\n- Documentation added\n- Telemetry added. In case of a feature if it's used or not.\n- Errors have a helpful link attached, see\nhttps://github.com/vercel/next.js/blob/canary/contributing.md\n\n\n## For Maintainers\n\n- Minimal description (aim for explaining to someone not on the team to\nunderstand the PR)\n- When linking to a Slack thread, you might want to share details of the\nconclusion\n- Link both the Linear (Fixes NEXT-xxx) and the GitHub issues\n- Add review comments if necessary to explain to the reviewer the logic\nbehind a change\n\n### What?\n\n### Why?\n\n### How?\n\nCloses NEXT-\nFixes #\n\n-->",
    "sha": "bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
    "files": [
        {
            "sha": "f4bc493282f91c7fe8eeb6db1e4b5a6bd567609c",
            "filename": "test/e2e/app-dir/cache-components-errors/cache-components-errors.test.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -664,7 +664,7 @@ describe('Cache Components Errors', () => {\n             } else {\n               expect(output).toMatchInlineSnapshot(`\n                \"Error: Route \"/dynamic-root\": A component accessed data, headers, params, searchParams, or a short-lived cache without a Suspense boundary nor a \"use cache\" above it. See more info: https://nextjs.org/docs/messages/next-prerender-missing-suspense\n-                   at <unknown> (bundler:///app/dynamic-root/indirection.tsx:7:34)\n+                   at a (bundler:///app/dynamic-root/indirection.tsx:7:34)\n                    at main (<anonymous>)\n                    at body (<anonymous>)\n                    at html (<anonymous>)\n@@ -2080,7 +2080,7 @@ describe('Cache Components Errors', () => {\n               } else {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-attribution/guarded-async-unguarded-clientsync\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n-                     at <unknown> (bundler:///app/sync-attribution/guarded-async-unguarded-clientsync/client.tsx:5:16)\n+                     at a (bundler:///app/sync-attribution/guarded-async-unguarded-clientsync/client.tsx:5:16)\n                    3 | export function SyncIO() {\n                    4 |   // This is a sync IO access that should not cause an error\n                  > 5 |   const data = new Date().toISOString()\n@@ -2210,9 +2210,12 @@ describe('Cache Components Errors', () => {\n                  \"Error: Route \"/sync-attribution/unguarded-async-guarded-clientsync\": A component accessed data, headers, params, searchParams, or a short-lived cache without a Suspense boundary nor a \"use cache\" above it. See more info: https://nextjs.org/docs/messages/next-prerender-missing-suspense\n                      at a (<anonymous>)\n                      at main (<anonymous>)\n+                     at b (<anonymous>)\n                      at main (<anonymous>)\n                      at body (<anonymous>)\n                      at html (<anonymous>)\n+                     at c (<anonymous>)\n+                     at d (<anonymous>)\n                  To get a more detailed stack trace and pinpoint the issue, try one of the following:\n                    - Start the app in development mode by running \\`next dev\\`, then open \"/sync-attribution/unguarded-async-guarded-clientsync\" in your browser to investigate the error.\n                    - Rerun the production build with \\`next build --debug-prerender\\` to generate better stack traces.\n@@ -2386,7 +2389,7 @@ describe('Cache Components Errors', () => {\n               } else {\n                 expect(output).toMatchInlineSnapshot(`\n                  \"Error: Route \"/sync-attribution/unguarded-async-unguarded-clientsync\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n-                     at <unknown> (bundler:///app/sync-attribution/unguarded-async-unguarded-clientsync/client.tsx:5:16)\n+                     at a (bundler:///app/sync-attribution/unguarded-async-unguarded-clientsync/client.tsx:5:16)\n                    3 | export function SyncIO() {\n                    4 |   // This is a sync IO access that should not cause an error\n                  > 5 |   const data = new Date().toISOString()"
        },
        {
            "sha": "335377e9a9a53b6b776ab7ae0d32142b19e15efd",
            "filename": "test/production/app-dir/build-output-prerender/build-output-prerender.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/test%2Fproduction%2Fapp-dir%2Fbuild-output-prerender%2Fbuild-output-prerender.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/test%2Fproduction%2Fapp-dir%2Fbuild-output-prerender%2Fbuild-output-prerender.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-prerender%2Fbuild-output-prerender.test.ts?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -105,7 +105,7 @@ describe('build-output-prerender', () => {\n           // TODO(veil): Why is the location incomplete unless we enable --no-mangling?\n           expect(getPrerenderOutput(next.cliOutput)).toMatchInlineSnapshot(`\n            \"Error: Route \"/client\" used \\`new Date()\\` inside a Client Component without a Suspense boundary above it. See more info here: https://nextjs.org/docs/messages/next-prerender-current-time-client\n-               at <unknown> (bundler:///app/client/page.tsx:4:28)\n+               at c (bundler:///app/client/page.tsx:4:28)\n              2 |\n              3 | export default function Page() {\n            > 4 |   return <p>Current time: {new Date().toISOString()}</p>"
        },
        {
            "sha": "47aef131ff84cbcdad5f9f628158dfc337b9d969",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/esm/export.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fexport.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fexport.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fesm%2Fexport.rs?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -402,7 +402,7 @@ pub async fn expand_star_exports(\n                     if key == \"default\" {\n                         continue;\n                     }\n-                    esm_exports.entry(key.clone()).or_insert(asset);\n+                    esm_exports.entry(key.clone()).or_insert_with(|| asset);\n                 }\n                 for esm_ref in exports.star_exports.iter() {\n                     if let ReferencedAsset::Some(asset) ="
        },
        {
            "sha": "15dd3d86dab0781067cc31f924fc14388a41e892",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/mod.rs",
            "status": "modified",
            "additions": 33,
            "deletions": 67,
            "changes": 100,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fmod.rs?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -757,7 +757,6 @@ pub async fn analyze_ecmascript_module_internal(\n                     &import_references,\n                     &mut analysis,\n                     analyze_mode,\n-                    &var_graph,\n                 );\n                 // ModuleReferencesVisitor has already called analysis.add_esm_reexport_reference\n                 // for any references in esm_exports\n@@ -3261,7 +3260,6 @@ struct ModuleReferencesVisitor<'a> {\n     webpack_runtime: Option<(RcStr, Span)>,\n     webpack_entry: bool,\n     webpack_chunks: Vec<Lit>,\n-    var_graph: &'a VarGraph,\n }\n \n impl<'a> ModuleReferencesVisitor<'a> {\n@@ -3270,7 +3268,6 @@ impl<'a> ModuleReferencesVisitor<'a> {\n         import_references: &'a [ResolvedVc<EsmAssetReference>],\n         analysis: &'a mut AnalyzeEcmascriptModuleResultBuilder,\n         analyze_mode: AnalyzeMode,\n-        var_graph: &'a VarGraph,\n     ) -> Self {\n         Self {\n             analyze_mode,\n@@ -3282,28 +3279,6 @@ impl<'a> ModuleReferencesVisitor<'a> {\n             webpack_runtime: None,\n             webpack_entry: false,\n             webpack_chunks: Vec::new(),\n-            var_graph,\n-        }\n-    }\n-}\n-\n-impl<'a> ModuleReferencesVisitor<'a> {\n-    /// Returns true if the given export identifier is considered \"live\".  This means it might\n-    /// change values after module evaluation.\n-    fn is_export_ident_live(&self, id: &Ident) -> bool {\n-        if let Some(crate::analyzer::graph::VarMeta {\n-            value: _,\n-            assignment_scopes: assignment_kinds,\n-        }) = self.var_graph.values.get(&id.to_id())\n-        {\n-            // If all assignments are in module scope, the export is not live.\n-            *assignment_kinds != crate::analyzer::graph::AssignmentScopes::AllInModuleEvalScope\n-        } else {\n-            // If we haven't computed a value for it, that means it might be\n-            // A free variable\n-            // an imported variable\n-            // In those cases, we just assume that the value is live since we don't know anything\n-            true\n         }\n     }\n }\n@@ -3312,10 +3287,10 @@ fn as_parent_path(ast_path: &AstNodePath<AstParentNodeRef<'_>>) -> Vec<AstParent\n     ast_path.iter().map(|n| n.kind()).collect()\n }\n \n-fn for_each_ident_in_pat(pat: &Pat, f: &mut impl FnMut(&Ident)) {\n+fn for_each_ident_in_pat(pat: &Pat, f: &mut impl FnMut(RcStr)) {\n     match pat {\n         Pat::Ident(BindingIdent { id, .. }) => {\n-            f(id);\n+            f(id.sym.as_str().into());\n         }\n         Pat::Array(ArrayPat { elems, .. }) => elems.iter().for_each(|e| {\n             if let Some(e) = e {\n@@ -3331,7 +3306,7 @@ fn for_each_ident_in_pat(pat: &Pat, f: &mut impl FnMut(&Ident)) {\n                     for_each_ident_in_pat(value, f);\n                 }\n                 ObjectPatProp::Assign(AssignPatProp { key, .. }) => {\n-                    f(key);\n+                    f(key.sym.as_str().into());\n                 }\n                 ObjectPatProp::Rest(RestPat { arg, .. }) => {\n                     for_each_ident_in_pat(arg, f);\n@@ -3372,7 +3347,6 @@ impl VisitAstPath for ModuleReferencesVisitor<'_> {\n             .map(find_turbopack_part_id_in_asserts)\n             .is_some();\n \n-        // This is for a statement like `export {a, b as c}` with no `from` clause.\n         if export.src.is_none() {\n             for spec in export.specifiers.iter() {\n                 fn to_rcstr(name: &ModuleExportName) -> RcStr {\n@@ -3413,24 +3387,14 @@ impl VisitAstPath for ModuleReferencesVisitor<'_> {\n                                     EsmExport::ImportedNamespace(ResolvedVc::upcast(esm_ref))\n                                 }\n                             } else {\n-                                let liveness = match orig {\n-                                    ModuleExportName::Ident(ident) => {\n-                                        if self.is_export_ident_live(ident) {\n-                                            Liveness::Live\n-                                        } else {\n-                                            Liveness::Constant\n-                                        }\n-                                    }\n-                                    ModuleExportName::Str(_) => Liveness::Constant,\n-                                };\n-\n                                 EsmExport::LocalBinding(\n                                     binding_name,\n                                     if is_fake_esm {\n-                                        // it is likely that these are not always actually mutable.\n                                         Liveness::Mutable\n                                     } else {\n-                                        liveness\n+                                        // If this is `export {foo} from 'mod'` and `foo` is a const\n+                                        // in mod then we could export as Const here.\n+                                        Liveness::Live\n                                     },\n                                 )\n                             }\n@@ -3455,27 +3419,30 @@ impl VisitAstPath for ModuleReferencesVisitor<'_> {\n     ) {\n         {\n             let decl: &Decl = &export.decl;\n-            let insert_export_binding = &mut |id: &Ident| {\n-                let liveness = if self.is_export_ident_live(id) {\n-                    Liveness::Live\n-                } else {\n-                    Liveness::Constant\n-                };\n-                let name: RcStr = id.sym.as_str().into();\n+            let insert_export_binding = &mut |name: RcStr, liveness: Liveness| {\n                 self.esm_exports\n                     .insert(name.clone(), EsmExport::LocalBinding(name, liveness));\n             };\n             match decl {\n                 Decl::Class(ClassDecl { ident, .. }) | Decl::Fn(FnDecl { ident, .. }) => {\n-                    insert_export_binding(ident);\n+                    // TODO: examine whether the value is ever mutated rather than just checking\n+                    // 'const'\n+                    insert_export_binding(ident.sym.as_str().into(), Liveness::Live);\n                 }\n                 Decl::Var(var_decl) => {\n-                    var_decl\n-                        .decls\n-                        .iter()\n-                        .for_each(|VarDeclarator { name, .. }| {\n-                            for_each_ident_in_pat(name, insert_export_binding);\n-                        });\n+                    // TODO: examine whether the value is ever mutated rather than just checking\n+                    // 'const'\n+                    let liveness = match var_decl.kind {\n+                        VarDeclKind::Var => Liveness::Live,\n+                        VarDeclKind::Let => Liveness::Live,\n+                        VarDeclKind::Const => Liveness::Constant,\n+                    };\n+                    let decls = &*var_decl.decls;\n+                    decls.iter().for_each(|VarDeclarator { name, .. }| {\n+                        for_each_ident_in_pat(name, &mut |name| {\n+                            insert_export_binding(name, liveness)\n+                        })\n+                    });\n                 }\n                 Decl::Using(_) => {\n                     // See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export#:~:text=You%20cannot%20use%20export%20on%20a%20using%20or%20await%20using%20declaration\n@@ -3523,22 +3490,21 @@ impl VisitAstPath for ModuleReferencesVisitor<'_> {\n     ) {\n         match &export.decl {\n             DefaultDecl::Class(ClassExpr { ident, .. }) | DefaultDecl::Fn(FnExpr { ident, .. }) => {\n-                let export = match ident {\n-                    Some(ident) => EsmExport::LocalBinding(\n-                        ident.sym.as_str().into(),\n-                        if self.is_export_ident_live(ident) {\n+                self.esm_exports.insert(\n+                    rcstr!(\"default\"),\n+                    EsmExport::LocalBinding(\n+                        ident\n+                            .as_ref()\n+                            .map(|i| i.sym.as_str().into())\n+                            .unwrap_or_else(|| magic_identifier::mangle(\"default export\").into()),\n+                        // Default export declarations can only be mutated if they have a name.\n+                        if ident.is_some() {\n                             Liveness::Live\n                         } else {\n                             Liveness::Constant\n                         },\n                     ),\n-                    // If there is no name, like `export default function(){}` then it is not live.\n-                    None => EsmExport::LocalBinding(\n-                        magic_identifier::mangle(\"default export\").into(),\n-                        Liveness::Constant,\n-                    ),\n-                };\n-                self.esm_exports.insert(rcstr!(\"default\"), export);\n+                );\n             }\n             DefaultDecl::TsInterfaceDecl(..) => {\n                 // ignore"
        },
        {
            "sha": "0836407120917aaa3df14f656f4f95a8e0982425",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/locals/module.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Flocals%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Flocals%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Flocals%2Fmodule.rs?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -144,10 +144,10 @@ impl EcmascriptChunkPlaceable for EcmascriptModuleLocalsModule {\n                 EsmExport::ImportedBinding(..) | EsmExport::ImportedNamespace(..) => {\n                     // not included in locals module\n                 }\n-                EsmExport::LocalBinding(local_name, liveness) => {\n+                EsmExport::LocalBinding(local_name, mutable) => {\n                     exports.insert(\n                         name.clone(),\n-                        EsmExport::LocalBinding(local_name.clone(), *liveness),\n+                        EsmExport::LocalBinding(local_name.clone(), *mutable),\n                     );\n                 }\n                 EsmExport::Error => {"
        },
        {
            "sha": "d2926e3448177b38ce081c46348d8a826590e684",
            "filename": "turbopack/crates/turbopack-tests/tests/execution/turbopack/exports/live/input/index.js",
            "status": "modified",
            "additions": 11,
            "deletions": 26,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fexports%2Flive%2Finput%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fexports%2Flive%2Finput%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fexecution%2Fturbopack%2Fexports%2Flive%2Finput%2Findex.js?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -1,5 +1,8 @@\n-import * as liveDefaultClass from './live_default_class.js'\n import * as liveExports from './live_exports.js'\n+import {\n+  default as liveDefaultClass,\n+  setDefaultClass,\n+} from './live_default_class.js'\n import * as constDefaultExportFunction from './const_default_export_function.js'\n \n it('hoisted declarations are live', () => {\n@@ -9,15 +12,15 @@ it('hoisted declarations are live', () => {\n })\n \n it('default class export declarations are live', () => {\n-  expect(liveDefaultClass.default.default()).toBe('defaultClass')\n-  liveDefaultClass.setDefaultClass(\n+  expect(liveDefaultClass.default()).toBe('defaultClass')\n+  setDefaultClass(\n     class {\n       static default() {\n         return 'patched'\n       }\n     }\n   )\n-  expect(liveDefaultClass.default.default()).toBe('patched')\n+  expect(liveDefaultClass.default()).toBe('patched')\n })\n \n it('default function export declarations are live', () => {\n@@ -33,28 +36,10 @@ it('exported lets are live', () => {\n })\n \n it('exported bindings that are not mutated are not live', () => {\n-  expect(\n-    Object.getOwnPropertyDescriptor(liveExports, 'obviouslyneverMutated')\n-  ).toEqual({\n-    configurable: false,\n-    enumerable: true,\n-    value: 'obviouslyneverMutated',\n-    writable: false,\n-  })\n-  expect(Object.getOwnPropertyDescriptor(liveExports, 'neverMutated')).toEqual({\n-    configurable: false,\n-    enumerable: true,\n-    value: 'neverMutated',\n-    writable: false,\n-  })\n-  expect(\n-    Object.getOwnPropertyDescriptor(constDefaultExportFunction, 'default')\n-  ).toEqual({\n-    configurable: false,\n-    enumerable: true,\n-    value: constDefaultExportFunction.default,\n-    writable: false,\n-  })\n+  // These should be bound to values, but we don't have the analysis yet\n+  expectGetter(liveExports, 'obviouslyneverMutated')\n+  expectGetter(liveExports, 'neverMutated')\n+  expectGetter(constDefaultExportFunction, 'default')\n })\n \n it('exported bindings that are free vars are live', () => {"
        },
        {
            "sha": "42785ac4d44451eb9187eeb3707e5d5aeeafdad2",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/index.js",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Findex.js?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -1,6 +1,3 @@\n-import { local, namedFunction, default as defaultFunction } from 'lib'\n+import { local } from 'lib'\n \n local()\n-namedFunction()\n-\n-defaultFunction()"
        },
        {
            "sha": "24ae290a860ea5644d511e07db56633240248b90",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Findex.js",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Findex.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Finput%2Fnode_modules%2Flib%2Findex.js?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -9,7 +9,3 @@ function localUnused() {\n }\n \n export { local, localUnused }\n-\n-export function namedFunction() {}\n-\n-export default function defaultFunction() {}"
        },
        {
            "sha": "16d25049adf9c4af323ce0f59526079520edd21c",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/output/bf321_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_328b13f8._.js",
            "status": "modified",
            "additions": 1,
            "deletions": 12,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2Fbf321_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_328b13f8._.js",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2Fbf321_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_328b13f8._.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2Fbf321_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_328b13f8._.js?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -5,8 +5,6 @@\n var __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$index$2e$js__$5b$test$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i(\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js [test] (ecmascript) <locals>\");\n ;\n (0, __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$index$2e$js__$5b$test$5d$__$28$ecmascript$29$__$3c$locals$3e$__[\"local\"])();\n-(0, __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$index$2e$js__$5b$test$5d$__$28$ecmascript$29$__$3c$locals$3e$__[\"namedFunction\"])();\n-(0, __TURBOPACK__imported__module__$5b$project$5d2f$turbopack$2f$crates$2f$turbopack$2d$tests$2f$tests$2f$snapshot$2f$intermediate$2d$tree$2d$shake$2f$reexport$2d$with$2d$locals$2f$input$2f$node_modules$2f$lib$2f$index$2e$js__$5b$test$5d$__$28$ecmascript$29$__$3c$locals$3e$__[\"default\"])();\n __turbopack_context__.s([]);\n }),\n \"[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused.js [test] (ecmascript)\", ((__turbopack_context__) => {\n@@ -35,18 +33,9 @@ function localUnused() {\n     console.log('This is a local unused function');\n }\n ;\n-function namedFunction() {}\n-function defaultFunction() {}\n __turbopack_context__.s([\n-    \"default\",\n-    0,\n-    defaultFunction,\n     \"local\",\n-    0,\n-    local,\n-    \"namedFunction\",\n-    0,\n-    namedFunction\n+    ()=>local\n ]);\n }),\n ]);"
        },
        {
            "sha": "381f676f9355017cf481d7afd34f6e7ffb69611a",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/output/bf321_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_328b13f8._.js.map",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2Fbf321_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_328b13f8._.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2Fbf321_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_328b13f8._.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Freexport-with-locals%2Foutput%2Fbf321_tests_snapshot_intermediate-tree-shake_reexport-with-locals_input_328b13f8._.js.map?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -2,8 +2,8 @@\n   \"version\": 3,\n   \"sources\": [],\n   \"sections\": [\n-    {\"offset\": {\"line\": 4, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/index.js\"],\"sourcesContent\":[\"import { local, namedFunction, default as defaultFunction } from 'lib'\\n\\nlocal()\\nnamedFunction()\\n\\ndefaultFunction()\\n\"],\"names\":[],\"mappings\":\"AAAA;;AAEA,IAAA,yRAAK;AACL,IAAA,iSAAa;AAEb,IAAA,2RAAe\"}},\n-    {\"offset\": {\"line\": 14, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused.js\"],\"sourcesContent\":[\"export function unusedStar() {}\\n\"],\"names\":[],\"mappings\":\"AAAO,SAAS,cAAc\",\"ignoreList\":[0]}},\n-    {\"offset\": {\"line\": 20, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused-star.js\"],\"sourcesContent\":[\"export function unused() {}\\n\"],\"names\":[],\"mappings\":\"AAAO,SAAS,UAAU\",\"ignoreList\":[0]}},\n-    {\"offset\": {\"line\": 26, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js\"],\"sourcesContent\":[\"export { unused } from './unused.js'\\nexport * from './unused-star.js'\\n\\nfunction local() {\\n  console.log('This is a local function')\\n}\\nfunction localUnused() {\\n  console.log('This is a local unused function')\\n}\\n\\nexport { local, localUnused }\\n\\nexport function namedFunction() {}\\n\\nexport default function defaultFunction() {}\\n\"],\"names\":[],\"mappings\":\"AAAA;AACA;;;AAEA,SAAS;IACP,QAAQ,GAAG,CAAC;AACd;AACA,SAAS;IACP,QAAQ,GAAG,CAAC;AACd;;AAIO,SAAS,iBAAiB;AAElB,SAAS,mBAAmB\",\"ignoreList\":[0]}}]\n+    {\"offset\": {\"line\": 4, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/index.js\"],\"sourcesContent\":[\"import { local } from 'lib'\\n\\nlocal()\\n\"],\"names\":[],\"mappings\":\"AAAA;;AAEA,IAAA,yRAAK\"}},\n+    {\"offset\": {\"line\": 12, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused.js\"],\"sourcesContent\":[\"export function unusedStar() {}\\n\"],\"names\":[],\"mappings\":\"AAAO,SAAS,cAAc\",\"ignoreList\":[0]}},\n+    {\"offset\": {\"line\": 18, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/unused-star.js\"],\"sourcesContent\":[\"export function unused() {}\\n\"],\"names\":[],\"mappings\":\"AAAO,SAAS,UAAU\",\"ignoreList\":[0]}},\n+    {\"offset\": {\"line\": 24, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"turbopack:///[project]/turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/reexport-with-locals/input/node_modules/lib/index.js\"],\"sourcesContent\":[\"export { unused } from './unused.js'\\nexport * from './unused-star.js'\\n\\nfunction local() {\\n  console.log('This is a local function')\\n}\\nfunction localUnused() {\\n  console.log('This is a local unused function')\\n}\\n\\nexport { local, localUnused }\\n\"],\"names\":[],\"mappings\":\"AAAA;AACA;;;AAEA,SAAS;IACP,QAAQ,GAAG,CAAC;AACd;AACA,SAAS;IACP,QAAQ,GAAG,CAAC;AACd\",\"ignoreList\":[0]}}]\n }\n\\ No newline at end of file"
        },
        {
            "sha": "4aa0125365a51c4aa4b313645a9f2e907183398a",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/intermediate-tree-shake/tree-shake-test-1/output/bf321_tests_snapshot_intermediate-tree-shake_tree-shake-test-1_input_c88ec7da._.js",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Ftree-shake-test-1%2Foutput%2Fbf321_tests_snapshot_intermediate-tree-shake_tree-shake-test-1_input_c88ec7da._.js",
            "raw_url": "https://github.com/vercel/next.js/raw/bbeaeeaa93157862dcb26e0d2b6b9195a48009cc/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Ftree-shake-test-1%2Foutput%2Fbf321_tests_snapshot_intermediate-tree-shake_tree-shake-test-1_input_c88ec7da._.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fintermediate-tree-shake%2Ftree-shake-test-1%2Foutput%2Fbf321_tests_snapshot_intermediate-tree-shake_tree-shake-test-1_input_c88ec7da._.js?ref=bbeaeeaa93157862dcb26e0d2b6b9195a48009cc",
            "patch": "@@ -23,8 +23,7 @@ function getDog() {\n }\n __turbopack_context__.s([\n     \"getCat\",\n-    0,\n-    getCat\n+    ()=>getCat\n ]);\n }),\n ]);"
        }
    ],
    "stats": {
        "total": 187,
        "additions": 61,
        "deletions": 126
    }
}