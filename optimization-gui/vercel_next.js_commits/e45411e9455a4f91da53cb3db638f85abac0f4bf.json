{
    "author": "eps1lon",
    "message": "Fix flaky Bun test (#76763)",
    "sha": "e45411e9455a4f91da53cb3db638f85abac0f4bf",
    "files": [
        {
            "sha": "e4cb1ca296343ae20961c5badeb0c5ca1b7f1e40",
            "filename": "test/integration/create-next-app/package-manager/bun.test.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/e45411e9455a4f91da53cb3db638f85abac0f4bf/test%2Fintegration%2Fcreate-next-app%2Fpackage-manager%2Fbun.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e45411e9455a4f91da53cb3db638f85abac0f4bf/test%2Fintegration%2Fcreate-next-app%2Fpackage-manager%2Fbun.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fcreate-next-app%2Fpackage-manager%2Fbun.test.ts?ref=e45411e9455a4f91da53cb3db638f85abac0f4bf",
            "patch": "@@ -1,3 +1,5 @@\n+import execa from 'execa'\n+import * as semver from 'semver'\n import {\n   command,\n   DEFAULT_FILES,\n@@ -7,11 +9,9 @@ import {\n   useTempDir,\n } from '../utils'\n \n-const lockFile = 'bun.lockb'\n-const files = [...DEFAULT_FILES, lockFile]\n-\n describe('create-next-app with package manager bun', () => {\n   let nextTgzFilename: string\n+  let files: string[]\n \n   beforeAll(async () => {\n     if (!process.env.NEXT_TEST_PKG_PATHS) {\n@@ -27,6 +27,12 @@ describe('create-next-app with package manager bun', () => {\n     await command('bun', ['--version'])\n       // install bun if not available\n       .catch(() => command('npm', ['i', '-g', 'bun']))\n+\n+    const bunVersion = (await execa('bun', ['--version'])).stdout.trim()\n+    // Some CI runners pre-install Bun.\n+    // Locally, we don't pin Bun either.\n+    const lockFile = semver.gte(bunVersion, '1.2.0') ? 'bun.lock' : 'bun.lockb'\n+    files = [...DEFAULT_FILES, lockFile]\n   })\n \n   it('should use bun for --use-bun flag', async () => {"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 9,
        "deletions": 3
    }
}