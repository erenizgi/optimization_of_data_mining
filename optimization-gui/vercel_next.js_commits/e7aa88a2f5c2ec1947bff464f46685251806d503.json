{
    "author": "raunofreiberg",
    "message": "[dev-overlay] Make footer sticky without side effects (#77327)\n\nCloses NDX-988\n\n---\n\n\n\n\nhttps://github.com/user-attachments/assets/1e9dc54e-d247-4b6b-93e6-b926c69b2571",
    "sha": "e7aa88a2f5c2ec1947bff464f46685251806d503",
    "files": [
        {
            "sha": "97fbbbae39c66b5cc2b4daab0473a4b66a6765b1",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/dialog/dialog-footer.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 12,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/adad56e311a1428467e2ac6f7ddaea632f94f249/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fdialog-footer.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/adad56e311a1428467e2ac6f7ddaea632f94f249/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fdialog-footer.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fdialog-footer.tsx?ref=adad56e311a1428467e2ac6f7ddaea632f94f249",
            "patch": "@@ -1,12 +0,0 @@\n-export type DialogFooterProps = {\n-  children?: React.ReactNode\n-  className?: string\n-}\n-\n-export function DialogFooter({ children, className }: DialogFooterProps) {\n-  return (\n-    <div data-nextjs-dialog-footer className={className}>\n-      {children}\n-    </div>\n-  )\n-}"
        },
        {
            "sha": "ef049b64fabac513bd7c6dbe87dae61875206136",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/dialog/index.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Findex.ts?ref=e7aa88a2f5c2ec1947bff464f46685251806d503",
            "patch": "@@ -2,5 +2,4 @@ export { Dialog } from './dialog'\n export { DialogBody } from './dialog-body'\n export { DialogContent } from './dialog-content'\n export { DialogHeader } from './dialog-header'\n-export { DialogFooter } from './dialog-footer'\n export { styles } from './styles'"
        },
        {
            "sha": "c8320d5188e39345dbcf1fea73b8a4faad0b07a4",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/dialog/styles.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 29,
            "changes": 31,
            "blob_url": "https://github.com/vercel/next.js/blob/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fstyles.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fstyles.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fstyles.ts?ref=e7aa88a2f5c2ec1947bff464f46685251806d503",
            "patch": "@@ -1,15 +1,14 @@\n const styles = `\n   [data-nextjs-dialog-root] {\n     --next-dialog-radius: var(--rounded-xl);\n-    --next-dialog-footer-height: var(--size-48);\n     --next-dialog-max-width: 960px;\n     --next-dialog-row-padding: 16px;\n     --next-dialog-padding-x: 12px;\n     --next-dialog-notch-height: 42px;\n     --next-dialog-border-width: 1px;\n \n     display: flex;\n-    flex-direction: column-reverse;\n+    flex-direction: column;\n     width: 100%;\n     max-height: calc(100% - 56px);\n     max-width: var(--next-dialog-max-width);\n@@ -35,8 +34,7 @@ const styles = `\n   }\n \n   [data-nextjs-dialog] {\n-    outline: none;\n-    overflow: hidden;\n+    outline: 0;\n   }\n \n   [data-nextjs-dialog]::-webkit-scrollbar {\n@@ -78,7 +76,6 @@ const styles = `\n   }\n \n   [data-nextjs-dialog-content] {\n-    overflow-y: auto;\n     border: none;\n     margin: 0;\n     display: flex;\n@@ -87,11 +84,6 @@ const styles = `\n     padding: 16px var(--next-dialog-padding-x);\n   }\n \n-  /* Account for the footer height, when present */\n-  [data-nextjs-dialog][data-has-footer='true'] [data-nextjs-dialog-body] {\n-    margin-bottom: var(--next-dialog-footer-height);\n-  }\n-\n   [data-nextjs-dialog-content] > [data-nextjs-dialog-header] {\n     flex-shrink: 0;\n     margin-bottom: 8px;\n@@ -102,25 +94,6 @@ const styles = `\n     flex: 1 1 auto;\n   }\n \n-  [data-nextjs-dialog-footer] {\n-    /* Subtract border width */\n-    width: calc(100% - 2px);\n-    /* \n-      We make this element fixed to anchor it to the bottom during the height transition.\n-      If you make this relative it will jump during the transition and not collapse or expand smoothly.\n-      If you make this absolute it will remain stuck at its initial position when scrolling the dialog.\n-    */\n-    position: fixed;\n-    bottom: 1px;\n-    min-height: var(--next-dialog-footer-height);\n-    border-radius: 0 0 var(--next-dialog-radius) var(--next-dialog-radius);\n-    overflow: hidden;\n-\n-    > * {\n-      min-height: var(--next-dialog-footer-height);\n-    }\n-  }\n-\n   @media (max-height: 812px) {\n     [data-nextjs-dialog-overlay] {\n       max-height: calc(100% - 15px);"
        },
        {
            "sha": "a2f6868dcbf19909767635507731d0968359567b",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/dialog/dialog.tsx",
            "status": "modified",
            "additions": 24,
            "deletions": 25,
            "changes": 49,
            "blob_url": "https://github.com/vercel/next.js/blob/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdialog%2Fdialog.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdialog%2Fdialog.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdialog%2Fdialog.tsx?ref=e7aa88a2f5c2ec1947bff464f46685251806d503",
            "patch": "@@ -4,49 +4,48 @@ type ErrorOverlayDialogProps = {\n   children?: React.ReactNode\n   onClose?: () => void\n   dialogResizerRef?: React.RefObject<HTMLDivElement | null>\n+  footer?: React.ReactNode\n } & React.HTMLAttributes<HTMLDivElement>\n \n export function ErrorOverlayDialog({\n   children,\n   onClose,\n+  footer,\n   ...props\n }: ErrorOverlayDialogProps) {\n   return (\n-    <Dialog\n-      type=\"error\"\n-      aria-labelledby=\"nextjs__container_errors_label\"\n-      aria-describedby=\"nextjs__container_errors_desc\"\n-      onClose={onClose}\n-      className=\"error-overlay-dialog\"\n-      {...props}\n-    >\n-      {children}\n-    </Dialog>\n+    <div className=\"error-overlay-dialog-container\">\n+      <Dialog\n+        type=\"error\"\n+        aria-labelledby=\"nextjs__container_errors_label\"\n+        aria-describedby=\"nextjs__container_errors_desc\"\n+        className=\"error-overlay-dialog-scroll\"\n+        onClose={onClose}\n+        {...props}\n+      >\n+        {children}\n+      </Dialog>\n+      {footer}\n+    </div>\n   )\n }\n \n export const DIALOG_STYLES = `\n-  .error-overlay-dialog {\n-    overflow-y: auto;\n+  .error-overlay-dialog-container {\n     -webkit-font-smoothing: antialiased;\n+    display: flex;\n+    flex-direction: column;\n     background: var(--color-background-100);\n     background-clip: padding-box;\n     border: var(--next-dialog-border-width) solid var(--color-gray-400);\n-    border-radius: var(--rounded-xl);\n+    border-radius: 0 0 var(--next-dialog-radius) var(--next-dialog-radius);\n     box-shadow: var(--shadow-menu);\n     position: relative;\n+    overflow: hidden;\n+  }\n \n-    &:has(\n-        ~ [data-nextjs-error-overlay-nav] .error-overlay-notch[data-side='left']\n-      ) {\n-      border-top-left-radius: 0;\n-    }\n-\n-    &:has(\n-        ~ [data-nextjs-error-overlay-nav]\n-          .error-overlay-notch[data-side='right']\n-      ) {\n-      border-top-right-radius: 0;\n-    }\n+  .error-overlay-dialog-scroll {\n+    overflow-y: auto;\n+    height: 100%;\n   }\n `"
        },
        {
            "sha": "47a55b2775b5b6d7c1d53fa9727c19a8e61ccb98",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay-layout/error-overlay-layout.tsx",
            "status": "modified",
            "additions": 16,
            "deletions": 16,
            "changes": 32,
            "blob_url": "https://github.com/vercel/next.js/blob/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.tsx?ref=e7aa88a2f5c2ec1947bff464f46685251806d503",
            "patch": "@@ -3,7 +3,7 @@ import type { DebugInfo } from '../../../../types'\n import type { ErrorMessageType } from '../error-message/error-message'\n import type { ErrorType } from '../error-type-label/error-type-label'\n \n-import { DialogContent, DialogFooter } from '../../dialog'\n+import { DialogContent } from '../../dialog'\n import {\n   ErrorOverlayToolbar,\n   styles as toolbarStyles,\n@@ -98,11 +98,26 @@ export function ErrorOverlayLayout({\n   return (\n     <ErrorOverlayOverlay fixed={isBuildError} {...animationProps}>\n       <div data-nextjs-dialog-root ref={dialogRef} {...animationProps}>\n+        <ErrorOverlayNav\n+          runtimeErrors={runtimeErrors}\n+          activeIdx={activeIdx}\n+          setActiveIndex={setActiveIndex}\n+          versionInfo={versionInfo}\n+          isTurbopack={isTurbopack}\n+        />\n         <ErrorOverlayDialog\n           onClose={onClose}\n           dialogResizerRef={dialogResizerRef}\n           data-has-footer={hasFooter}\n           onScroll={onScroll}\n+          footer={\n+            hasFooter && (\n+              <ErrorOverlayFooter\n+                footerMessage={footerMessage}\n+                errorCode={errorCode}\n+              />\n+            )\n+          }\n         >\n           <DialogContent>\n             <ErrorOverlayDialogHeader>\n@@ -126,26 +141,11 @@ export function ErrorOverlayLayout({\n \n             <ErrorOverlayDialogBody>{children}</ErrorOverlayDialogBody>\n           </DialogContent>\n-          {hasFooter && (\n-            <DialogFooter>\n-              <ErrorOverlayFooter\n-                footerMessage={footerMessage}\n-                errorCode={errorCode}\n-              />\n-            </DialogFooter>\n-          )}\n           <ErrorOverlayBottomStack\n             errorCount={runtimeErrors?.length ?? 0}\n             activeIdx={activeIdx ?? 0}\n           />\n         </ErrorOverlayDialog>\n-        <ErrorOverlayNav\n-          runtimeErrors={runtimeErrors}\n-          activeIdx={activeIdx}\n-          setActiveIndex={setActiveIndex}\n-          versionInfo={versionInfo}\n-          isTurbopack={isTurbopack}\n-        />\n         <Fader ref={faderRef} side=\"top\" stop=\"50%\" blur=\"4px\" height={48} />\n       </div>\n     </ErrorOverlayOverlay>"
        },
        {
            "sha": "657fa9c89efa303c335dd6d82264cba4fca7b9e2",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay-nav/error-overlay-nav.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e7aa88a2f5c2ec1947bff464f46685251806d503/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.tsx?ref=e7aa88a2f5c2ec1947bff464f46685251806d503",
            "patch": "@@ -49,6 +49,8 @@ export const styles = `\n \n     width: 100%;\n \n+    position: relative;\n+    z-index: 2;\n     outline: none;\n     translate: 1px 1px;\n     max-width: var(--next-dialog-max-width);"
        }
    ],
    "stats": {
        "total": 127,
        "additions": 44,
        "deletions": 83
    }
}