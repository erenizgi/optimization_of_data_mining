{
    "author": "unstubbable",
    "message": "Add test to assert on current build output tree view (#76342)\n\nThis allows us to better track fixes and changes to the build output tree view.\r\n\r\nTo avoid flakiness, and needing to update the snapshots frequently, I've stubbed to file sizes and omitted the chunks from the snapshotted output. Because those details affect the column sizes, we can't just blank them out when reading the CLI output (which was [my first approach](https://github.com/vercel/next.js/pull/76342/commits/d7ee6b46f651aad61e4981936456e2f7558c2f7e)). So instead, we already stub them during the generation of the output if `__NEXT_PRIVATE_DETERMINISTIC_BUILD_OUTPUT` is defined.",
    "sha": "3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
    "files": [
        {
            "sha": "ea0d3a39e77ba6122318d2b0f125e663f800a228",
            "filename": "packages/next/src/build/utils.ts",
            "status": "modified",
            "additions": 31,
            "deletions": 12,
            "changes": 43,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/packages%2Fnext%2Fsrc%2Fbuild%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/packages%2Fnext%2Fsrc%2Fbuild%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Futils.ts?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -402,12 +402,22 @@ export async function printTreeView(\n     gzipSize?: boolean\n   }\n ) {\n-  const getPrettySize = (_size: number): string => {\n-    const size = prettyBytes(_size)\n-    return white(bold(size))\n+  const getPrettySize = (\n+    _size: number,\n+    { strong }: { strong?: boolean } = {}\n+  ): string => {\n+    const size = process.env.__NEXT_PRIVATE_DETERMINISTIC_BUILD_OUTPUT\n+      ? 'N/A kB'\n+      : prettyBytes(_size)\n+\n+    return strong ? white(bold(size)) : size\n   }\n \n-  const MIN_DURATION = 300\n+  // Can be overridden for test purposes to omit the build duration output.\n+  const MIN_DURATION = process.env.__NEXT_PRIVATE_DETERMINISTIC_BUILD_OUTPUT\n+    ? Infinity // Don't ever log build durations.\n+    : 300\n+\n   const getPrettyDuration = (_duration: number): string => {\n     const duration = `${_duration} ms`\n     // green for 300-1000ms\n@@ -526,14 +536,14 @@ export async function printTreeView(\n           ? ampFirst\n             ? cyan('AMP')\n             : pageInfo.size >= 0\n-              ? prettyBytes(pageInfo.size)\n+              ? getPrettySize(pageInfo.size)\n               : ''\n           : '',\n         pageInfo\n           ? ampFirst\n             ? cyan('AMP')\n             : pageInfo.size >= 0\n-              ? getPrettySize(pageInfo.totalSize)\n+              ? getPrettySize(pageInfo.totalSize, { strong: true })\n               : ''\n           : '',\n       ])\n@@ -553,7 +563,7 @@ export async function printTreeView(\n           const size = stats.sizes.get(file)\n           messages.push([\n             `${contSymbol}   ${innerSymbol} ${getCleanName(file)}`,\n-            typeof size === 'number' ? prettyBytes(size) : '',\n+            typeof size === 'number' ? getPrettySize(size) : '',\n             '',\n           ])\n         })\n@@ -628,11 +638,16 @@ export async function printTreeView(\n     })\n \n     const sharedFilesSize = stats.router[routerType]?.common.size.total\n-    const sharedFiles = stats.router[routerType]?.common.files ?? []\n+\n+    const sharedFiles = process.env.__NEXT_PRIVATE_DETERMINISTIC_BUILD_OUTPUT\n+      ? []\n+      : stats.router[routerType]?.common.files ?? []\n \n     messages.push([\n       '+ First Load JS shared by all',\n-      typeof sharedFilesSize === 'number' ? getPrettySize(sharedFilesSize) : '',\n+      typeof sharedFilesSize === 'number'\n+        ? getPrettySize(sharedFilesSize, { strong: true })\n+        : '',\n       '',\n     ])\n     const sharedCssFiles: string[] = []\n@@ -667,13 +682,13 @@ export async function printTreeView(\n         return\n       }\n \n-      messages.push([`  ${innerSymbol} ${cleanName}`, prettyBytes(size), ''])\n+      messages.push([`  ${innerSymbol} ${cleanName}`, getPrettySize(size), ''])\n     })\n \n     if (restChunkCount > 0) {\n       messages.push([\n         `  └ other shared chunks (total)`,\n-        prettyBytes(restChunkSize),\n+        getPrettySize(restChunkSize),\n         '',\n       ])\n     }\n@@ -717,7 +732,11 @@ export async function printTreeView(\n     )\n \n     messages.push(['', '', ''])\n-    messages.push(['ƒ Middleware', getPrettySize(sum(middlewareSizes)), ''])\n+    messages.push([\n+      'ƒ Middleware',\n+      getPrettySize(sum(middlewareSizes), { strong: true }),\n+      '',\n+    ])\n   }\n \n   print("
        },
        {
            "sha": "1cfe6303befce8c26672ce5c1243a157241c363b",
            "filename": "test/ppr-tests-manifest.json",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fppr-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fppr-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fppr-tests-manifest.json?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -100,7 +100,8 @@\n       \"test/e2e/app-dir/segment-cache/memory-pressure/segment-cache-memory-pressure.test.ts\",\n       \"test/e2e/app-dir/segment-cache/prefetch-scheduling/prefetch-scheduling.test.ts\",\n       \"test/e2e/app-dir/segment-cache/revalidation/segment-cache-revalidation.test.ts\",\n-      \"test/e2e/app-dir/segment-cache/staleness/segment-cache-stale-time.test.ts\"\n+      \"test/e2e/app-dir/segment-cache/staleness/segment-cache-stale-time.test.ts\",\n+      \"test/production/app-dir/build-output-tree-view/build-output-tree-view.test.ts\"\n     ]\n   }\n }"
        },
        {
            "sha": "53f8fe411952b21f4ed3b21f652f7966b88b6294",
            "filename": "test/production/app-dir/build-output-tree-view/build-output-tree-view.test.ts",
            "status": "added",
            "additions": 95,
            "deletions": 0,
            "changes": 95,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Fbuild-output-tree-view.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Fbuild-output-tree-view.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Fbuild-output-tree-view.test.ts?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,95 @@\n+import { nextTestSetup } from 'e2e-utils'\n+import path from 'path'\n+\n+describe('build-output-tree-view', () => {\n+  describe('with mixed static and dynamic pages and app router routes', () => {\n+    const { next } = nextTestSetup({\n+      files: path.join(__dirname, 'fixtures/mixed'),\n+      skipStart: true,\n+      env: {\n+        __NEXT_PRIVATE_DETERMINISTIC_BUILD_OUTPUT: '1',\n+      },\n+    })\n+\n+    beforeAll(() => next.build())\n+\n+    it('should show info about prerendered and dynamic routes in a tree view', async () => {\n+      // TODO: Show cache info (revalidate/expire) for app router, and use the\n+      // same for pages router instead of the ISR addendum.\n+\n+      // TODO: Fix double-listing of the /ppr/[slug] fallback.\n+\n+      expect(getTreeView(next.cliOutput)).toMatchInlineSnapshot(`\n+       \"Route (app)                             Size    First Load JS\n+       ┌ ○ /_not-found                         N/A kB         N/A kB\n+       ├ ƒ /api                                N/A kB         N/A kB\n+       ├ ○ /api/force-static                   N/A kB         N/A kB\n+       ├ ○ /app-static                         N/A kB         N/A kB\n+       ├ ○ /cache-life                         N/A kB         N/A kB\n+       ├ ƒ /dynamic                            N/A kB         N/A kB\n+       ├ ◐ /ppr/[slug]                         N/A kB         N/A kB\n+       ├   ├ /ppr/[slug]\n+       ├   ├ /ppr/[slug]\n+       ├   ├ /ppr/days\n+       ├   └ /ppr/weeks\n+       └ ○ /revalidate                         N/A kB         N/A kB\n+       + First Load JS shared by all           N/A kB\n+\n+       Route (pages)                           Size    First Load JS\n+       ┌ ƒ /api/hello                          N/A kB         N/A kB\n+       ├ ● /gsp-revalidate (ISR: 300 Seconds)  N/A kB         N/A kB\n+       ├ ƒ /gssp                               N/A kB         N/A kB\n+       └ ○ /static                             N/A kB         N/A kB\n+       + First Load JS shared by all           N/A kB\n+\n+       ○  (Static)             prerendered as static content\n+       ●  (SSG)                prerendered as static HTML (uses generateStaticParams)\n+          (ISR)                incremental static regeneration (uses revalidate in generateStaticParams)\n+       ◐  (Partial Prerender)  prerendered as static HTML with dynamic server-streamed content\n+       ƒ  (Dynamic)            server-rendered on demand\"\n+      `)\n+    })\n+  })\n+\n+  describe('with only a few static routes', () => {\n+    const { next } = nextTestSetup({\n+      files: path.join(__dirname, 'fixtures/minimal-static'),\n+      skipStart: true,\n+      env: {\n+        __NEXT_PRIVATE_DETERMINISTIC_BUILD_OUTPUT: '1',\n+      },\n+    })\n+\n+    beforeAll(() => next.build())\n+\n+    it('should show info about prerendered routes in a compact tree view', async () => {\n+      expect(getTreeView(next.cliOutput)).toMatchInlineSnapshot(`\n+       \"Route (app)                    Size    First Load JS\n+       ┌ ○ /                          N/A kB         N/A kB\n+       └ ○ /_not-found                N/A kB         N/A kB\n+       + First Load JS shared by all  N/A kB\n+\n+       Route (pages)                  Size    First Load JS\n+       ─ ○ /static                    N/A kB         N/A kB\n+       + First Load JS shared by all  N/A kB\n+\n+       ○  (Static)  prerendered as static content\"\n+      `)\n+    })\n+  })\n+})\n+\n+function getTreeView(cliOutput: string): string {\n+  let foundBuildTracesLine = false\n+  const lines: string[] = []\n+\n+  for (const line of cliOutput.split('\\n')) {\n+    if (foundBuildTracesLine) {\n+      lines.push(line)\n+    }\n+\n+    foundBuildTracesLine ||= line.includes('Collecting build traces')\n+  }\n+\n+  return lines.join('\\n').trim()\n+}"
        },
        {
            "sha": "888614deda3ba5d744d1a7e5dac131038dba2b12",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/minimal-static/app/layout.tsx",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fapp%2Flayout.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,8 @@\n+import { ReactNode } from 'react'\n+export default function Root({ children }: { children: ReactNode }) {\n+  return (\n+    <html>\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "ff7159d9149feeb1eb8f4b7bbeadb2e26c20b053",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/minimal-static/app/page.tsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fapp%2Fpage.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,3 @@\n+export default function Page() {\n+  return <p>hello world</p>\n+}"
        },
        {
            "sha": "807126e4cf0bf5b1c8c917e6e0148a27331587d1",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/minimal-static/next.config.js",
            "status": "added",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fnext.config.js?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,6 @@\n+/**\n+ * @type {import('next').NextConfig}\n+ */\n+const nextConfig = {}\n+\n+module.exports = nextConfig"
        },
        {
            "sha": "ff7159d9149feeb1eb8f4b7bbeadb2e26c20b053",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/minimal-static/pages/static.tsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fpages%2Fstatic.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fpages%2Fstatic.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fminimal-static%2Fpages%2Fstatic.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,3 @@\n+export default function Page() {\n+  return <p>hello world</p>\n+}"
        },
        {
            "sha": "68186e308f956ab2ecad7483475b604c92e788f9",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/app/api/force-static/route.ts",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fapi%2Fforce-static%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fapi%2Fforce-static%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fapi%2Fforce-static%2Froute.ts?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,5 @@\n+export const dynamic = 'force-static'\n+\n+export async function GET() {\n+  return Response.json({ message: 'hello world' })\n+}"
        },
        {
            "sha": "374b88f82fa0ae9009ad08024554bb9e8321fbe6",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/app/api/route.ts",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fapi%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fapi%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fapi%2Froute.ts?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,3 @@\n+export async function GET() {\n+  return Response.json({ message: 'hello world' })\n+}"
        },
        {
            "sha": "ff7159d9149feeb1eb8f4b7bbeadb2e26c20b053",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/app/app-static/page.tsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fapp-static%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fapp-static%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fapp-static%2Fpage.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,3 @@\n+export default function Page() {\n+  return <p>hello world</p>\n+}"
        },
        {
            "sha": "adc131c07ce15e59a9d637cf0a8f1b171dc40ddf",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/app/cache-life/page.tsx",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fcache-life%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fcache-life%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fcache-life%2Fpage.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,9 @@\n+'use cache'\n+\n+import { unstable_cacheLife } from 'next/cache'\n+\n+export default async function Page() {\n+  unstable_cacheLife('weeks')\n+\n+  return <p>hello world</p>\n+}"
        },
        {
            "sha": "5c72696e865224d22a6c29746606b8ae185c7691",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/app/dynamic/page.tsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fdynamic%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fdynamic%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fdynamic%2Fpage.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,7 @@\n+import { headers } from 'next/headers'\n+\n+export default async function Page() {\n+  await headers()\n+\n+  return <p>hello world</p>\n+}"
        },
        {
            "sha": "888614deda3ba5d744d1a7e5dac131038dba2b12",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/app/layout.tsx",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Flayout.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,8 @@\n+import { ReactNode } from 'react'\n+export default function Root({ children }: { children: ReactNode }) {\n+  return (\n+    <html>\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "7e2ff11182cbfc970ad2a0c9b270f1558f3e1c27",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/app/ppr/[slug]/page.tsx",
            "status": "added",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fppr%2F%5Bslug%5D%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fppr%2F%5Bslug%5D%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Fppr%2F%5Bslug%5D%2Fpage.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,25 @@\n+import { unstable_cacheLife } from 'next/cache'\n+\n+type CacheLife = Parameters<typeof unstable_cacheLife>[0]\n+\n+async function getCachedValue(cacheLife: CacheLife) {\n+  'use cache'\n+\n+  unstable_cacheLife(cacheLife)\n+\n+  return Math.random()\n+}\n+\n+export default async function Page({\n+  params,\n+}: {\n+  params: Promise<{ slug: CacheLife }>\n+}) {\n+  const { slug } = await params\n+\n+  return <p>hello world {await getCachedValue(slug)}</p>\n+}\n+\n+export function generateStaticParams() {\n+  return [{ slug: 'days' }, { slug: 'weeks' }]\n+}"
        },
        {
            "sha": "6207b3b12804bc4599465430ae4df74b6f7cef9d",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/app/revalidate/page.tsx",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Frevalidate%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Frevalidate%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fapp%2Frevalidate%2Fpage.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,5 @@\n+export const revalidate = 900\n+\n+export default function Page() {\n+  return <p>hello world</p>\n+}"
        },
        {
            "sha": "88b3464206ba2eca3f9d4e48211d40ea53311117",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/next.config.js",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fnext.config.js?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,11 @@\n+/**\n+ * @type {import('next').NextConfig}\n+ */\n+const nextConfig = {\n+  experimental: {\n+    useCache: true,\n+    ppr: true,\n+  },\n+}\n+\n+module.exports = nextConfig"
        },
        {
            "sha": "9d85f4ea932dcc5f0b4e4d2c4bdffd10ffa8c389",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/pages/api/hello.ts",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fapi%2Fhello.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fapi%2Fhello.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fapi%2Fhello.ts?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,5 @@\n+import type { NextApiRequest, NextApiResponse } from 'next'\n+\n+export default function handler(req: NextApiRequest, res: NextApiResponse) {\n+  res.status(200).json({ message: 'hello world' })\n+}"
        },
        {
            "sha": "f920e024b99ed75cea14a36815d3db26bfb32af4",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/pages/gsp-revalidate.tsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fgsp-revalidate.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fgsp-revalidate.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fgsp-revalidate.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,7 @@\n+export default function Page() {\n+  return <p>hello world</p>\n+}\n+\n+export async function getStaticProps() {\n+  return { props: {}, revalidate: 300 }\n+}"
        },
        {
            "sha": "166a96890949720468b392a775893fe7d86edb16",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/pages/gssp.tsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fgssp.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fgssp.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fgssp.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,7 @@\n+export default function Page() {\n+  return <p>hello world</p>\n+}\n+\n+export async function getServerSideProps() {\n+  return { props: {} }\n+}"
        },
        {
            "sha": "ff7159d9149feeb1eb8f4b7bbeadb2e26c20b053",
            "filename": "test/production/app-dir/build-output-tree-view/fixtures/mixed/pages/static.tsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fstatic.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/3d065cf58e7b4e24387f1daeff2cf22ab121fa02/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fstatic.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbuild-output-tree-view%2Ffixtures%2Fmixed%2Fpages%2Fstatic.tsx?ref=3d065cf58e7b4e24387f1daeff2cf22ab121fa02",
            "patch": "@@ -0,0 +1,3 @@\n+export default function Page() {\n+  return <p>hello world</p>\n+}"
        }
    ],
    "stats": {
        "total": 259,
        "additions": 246,
        "deletions": 13
    }
}