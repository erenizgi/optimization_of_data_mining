{
    "author": "devjiwonchoi",
    "message": "[dev-overlay] deprecate `devIndicators.buildActivityPosition` and rename to `position` (#76069)\n\n### Why?\r\n\r\nSince the `buildActivity` is deprecated at #76067, `buildActivityPosition` may also be deprecated. However, we are planning to preserve the option to position the dev indicator. Therefore, this PR adds a new option `position` and deprecates and aliases the `buildActivityPosition` to `position`.\r\n\r\n### Success Criteria\r\n\r\nDeprecation:\r\n\r\n- [x] Does using `buildActivityPosition` show a deprecation warning?\r\n- [x] Does `buildActivityPosition` have a deprecation in JSDoc?\r\n\r\nAlias:\r\n\r\n> Is it backward compatible with the old overlay?\r\n\r\n- [x] Does setting `buildActivityPosition` correctly set the build activity indicator position?\r\n- [x] Does it warn if `buildActivityPosition` is set instead of `position`?\r\n- [x] Does `buildActivityPosition` supersede `position` value to prevent breaking change?\r\n- [x] Does setting the `position` correctly set the build activity indicator position?\r\n\r\n### Follow Up\r\n\r\nIn the following PRs, we will add the behavior for `position` to adjust the dev indicator's position. After removing the old overlay's sources, we can remove any logic that `buildActivityPosition` was holding for the old overlay and make it fully an alias for backwards compatibility.\r\n\r\nCloses NDX-837",
    "sha": "4b8bf68609de2cb07b167ab3621e5ec5af7d2f47",
    "files": [
        {
            "sha": "b01aec2db4778fe702646769debf0a4c0ec164cf",
            "filename": "crates/next-core/src/next_config.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_config.rs?ref=4b8bf68609de2cb07b167ab3621e5ec5af7d2f47",
            "patch": "@@ -202,6 +202,7 @@ pub enum BuildActivityPositions {\n pub struct DevIndicatorsConfig {\n     pub build_activity: Option<bool>,\n     pub build_activity_position: Option<BuildActivityPositions>,\n+    pub position: Option<BuildActivityPositions>,\n }\n \n #[derive("
        },
        {
            "sha": "34aed07f71475c21d4ed1b85bc0bb7bfa37997e5",
            "filename": "packages/next/errors.json",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Ferrors.json",
            "raw_url": "https://github.com/vercel/next.js/raw/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Ferrors.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ferrors.json?ref=4b8bf68609de2cb07b167ab3621e5ec5af7d2f47",
            "patch": "@@ -640,5 +640,6 @@\n   \"639\": \"unstable_rootParams() can only be used within App Router.\",\n   \"640\": \"Route %s used \\\"unstable_rootParams\\\" inside \\\\`\\\"use cache\\\"\\\\` or \\\\`unstable_cache\\\\`. Support for this API inside cache scopes is planned for a future version of Next.js.\",\n   \"641\": \"Route %s used \\\\`unstable_rootParams()\\\\` in Pages Router. This API is only available within App Router.\",\n-  \"642\": \"Route %s used \\\\`unstable_rootParams()\\\\` inside \\\\`\\\"use cache\\\"\\\\` or \\\\`unstable_cache\\\\`. Support for this API inside cache scopes is planned for a future version of Next.js.\"\n+  \"642\": \"Route %s used \\\\`unstable_rootParams()\\\\` inside \\\\`\\\"use cache\\\"\\\\` or \\\\`unstable_cache\\\\`. Support for this API inside cache scopes is planned for a future version of Next.js.\",\n+  \"643\": \"Invalid \\\"devIndicator.position\\\" provided, expected one of %s, received %s\"\n }"
        },
        {
            "sha": "a7bcfb71b9a41d49594f3076540e3a30ca4c1066",
            "filename": "packages/next/src/build/webpack-config.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-config.ts?ref=4b8bf68609de2cb07b167ab3621e5ec5af7d2f47",
            "patch": "@@ -2131,7 +2131,7 @@ export default async function getBaseWebpackConfig(\n     pageExtensions: pageExtensions,\n     trailingSlash: config.trailingSlash,\n     buildActivity: config.devIndicators.buildActivity,\n-    buildActivityPosition: config.devIndicators.buildActivityPosition,\n+    buildActivityPosition: config.devIndicators.position,\n     productionBrowserSourceMaps: !!config.productionBrowserSourceMaps,\n     reactStrictMode: config.reactStrictMode,\n     optimizeCss: config.experimental.optimizeCss,"
        },
        {
            "sha": "c6e89d53f448afd125b666b9d3f01c71d98db16d",
            "filename": "packages/next/src/build/webpack/plugins/define-env-plugin.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fdefine-env-plugin.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fdefine-env-plugin.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fdefine-env-plugin.ts?ref=4b8bf68609de2cb07b167ab3621e5ec5af7d2f47",
            "patch": "@@ -240,7 +240,7 @@ export function getDefineEnv({\n     'process.env.__NEXT_BUILD_INDICATOR':\n       config.devIndicators.buildActivity ?? true,\n     'process.env.__NEXT_BUILD_INDICATOR_POSITION':\n-      config.devIndicators.buildActivityPosition ?? 'bottom-right',\n+      config.devIndicators.position ?? 'bottom-right',\n     'process.env.__NEXT_STRICT_MODE':\n       config.reactStrictMode === null ? false : config.reactStrictMode,\n     'process.env.__NEXT_STRICT_MODE_APP':"
        },
        {
            "sha": "33e63cfcf0a84d7c154511a4c294a63bafc8da79",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=4b8bf68609de2cb07b167ab3621e5ec5af7d2f47",
            "patch": "@@ -239,6 +239,14 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n             z.literal('top-right'),\n           ])\n           .optional(),\n+        position: z\n+          .union([\n+            z.literal('bottom-left'),\n+            z.literal('bottom-right'),\n+            z.literal('top-left'),\n+            z.literal('top-right'),\n+          ])\n+          .optional(),\n       })\n       .optional(),\n     distDir: z.string().min(1).optional(),"
        },
        {
            "sha": "6c8f6d94b7299b67bade5decd998ece5b488bc5d",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 5,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=4b8bf68609de2cb07b167ab3621e5ec5af7d2f47",
            "patch": "@@ -838,21 +838,32 @@ export interface NextConfig extends Record<string, any> {\n   /** Configure indicators in development environment */\n   devIndicators?: {\n     /**\n-     * Show \"building...\"\" indicator in development\n+     * @deprecated The dev tools indicator has it enabled by default.\n+     * */\n+    appIsrStatus?: boolean\n+\n+    /**\n+     * Show \"building...\" indicator in development\n      * @deprecated The dev tools indicator has it enabled by default.\n      */\n     buildActivity?: boolean\n-    /** Position of \"building...\" indicator in browser */\n+\n+    /**\n+     * Position of \"building...\" indicator in browser\n+     * @default \"bottom-right\"\n+     * @deprecated Renamed as `position`.\n+     */\n     buildActivityPosition?:\n       | 'bottom-right'\n       | 'bottom-left'\n       | 'top-right'\n       | 'top-left'\n \n     /**\n-     * @deprecated The dev tools indicator has it enabled by default.\n+     * Position of \"building...\" indicator in browser\n+     * @default \"bottom-right\"\n      * */\n-    appIsrStatus?: boolean\n+    position?: 'bottom-right' | 'bottom-left' | 'top-right' | 'top-left'\n   }\n \n   /**\n@@ -1098,7 +1109,7 @@ export const defaultConfig: NextConfig = {\n   compress: true,\n   images: imageConfigDefault,\n   devIndicators: {\n-    buildActivityPosition: 'bottom-right',\n+    position: 'bottom-right',\n   },\n   onDemandEntries: {\n     maxInactiveAge: 60 * 1000,"
        },
        {
            "sha": "ba46e80c947f5dadf2216d7c233b3d2bc12b9db9",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 27,
            "deletions": 7,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=4b8bf68609de2cb07b167ab3621e5ec5af7d2f47",
            "patch": "@@ -55,7 +55,8 @@ export function warnOptionHasBeenDeprecated(\n   nestedPropertyKey: string,\n   reason: string,\n   silent: boolean\n-) {\n+): boolean {\n+  let hasWarned = false\n   if (!silent) {\n     let current = config\n     let found = true\n@@ -69,9 +70,11 @@ export function warnOptionHasBeenDeprecated(\n       }\n     }\n     if (found) {\n-      Log.warn(reason)\n+      Log.warnOnce(reason)\n+      hasWarned = true\n     }\n   }\n+  return hasWarned\n }\n \n export function warnOptionHasBeenMovedOutOfExperimental(\n@@ -477,6 +480,23 @@ function assignDefaults(\n     silent\n   )\n \n+  const hasWarnedBuildActivityPosition = warnOptionHasBeenDeprecated(\n+    result,\n+    'devIndicators.buildActivityPosition',\n+    `\\`devIndicators.buildActivityPosition\\` has been renamed to \\`devIndicators.position\\`. Please update your ${configFileName} file accordingly.`,\n+    silent\n+  )\n+  if (\n+    hasWarnedBuildActivityPosition &&\n+    result.devIndicators?.buildActivityPosition &&\n+    result.devIndicators.buildActivityPosition !== result.devIndicators.position\n+  ) {\n+    Log.warnOnce(\n+      `The \\`devIndicators\\` option \\`buildActivityPosition\\` (\"${result.devIndicators.buildActivityPosition}\") conflicts with \\`position\\` (\"${result.devIndicators.position}\"). Using \\`buildActivityPosition\\` (\"${result.devIndicators.buildActivityPosition}\") for backward compatibility.`\n+    )\n+    result.devIndicators.position = result.devIndicators.buildActivityPosition\n+  }\n+\n   warnOptionHasBeenMovedOutOfExperimental(\n     result,\n     'bundlePagesExternals',\n@@ -815,20 +835,20 @@ function assignDefaults(\n     }\n   }\n \n-  if (result.devIndicators?.buildActivityPosition) {\n-    const { buildActivityPosition } = result.devIndicators\n+  if (result.devIndicators?.position) {\n+    const { position } = result.devIndicators\n     const allowedValues = [\n       'top-left',\n       'top-right',\n       'bottom-left',\n       'bottom-right',\n     ]\n \n-    if (!allowedValues.includes(buildActivityPosition)) {\n+    if (!allowedValues.includes(position)) {\n       throw new Error(\n-        `Invalid \"devIndicator.buildActivityPosition\" provided, expected one of ${allowedValues.join(\n+        `Invalid \"devIndicator.position\" provided, expected one of ${allowedValues.join(\n           ', '\n-        )}, received ${buildActivityPosition}`\n+        )}, received ${position}`\n       )\n     }\n   }"
        },
        {
            "sha": "f6be61e845965f751a4428e467dd539b83a86169",
            "filename": "test/integration/build-indicator/test/index.test.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/test%2Fintegration%2Fbuild-indicator%2Ftest%2Findex.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4b8bf68609de2cb07b167ab3621e5ec5af7d2f47/test%2Fintegration%2Fbuild-indicator%2Ftest%2Findex.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fbuild-indicator%2Ftest%2Findex.test.js?ref=4b8bf68609de2cb07b167ab3621e5ec5af7d2f47",
            "patch": "@@ -67,7 +67,7 @@ describe('Build Activity Indicator', () => {\n     await check(\n       () => stripAnsi(stderr),\n       new RegExp(\n-        `Invalid \"devIndicator.buildActivityPosition\" provided, expected one of top-left, top-right, bottom-left, bottom-right, received ttop-leff`\n+        `Invalid \"devIndicator.position\" provided, expected one of top-left, top-right, bottom-left, bottom-right, received ttop-leff`\n       )\n     )\n "
        }
    ],
    "stats": {
        "total": 73,
        "additions": 57,
        "deletions": 16
    }
}