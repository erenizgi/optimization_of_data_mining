{
    "author": "gnoff",
    "message": "disallow unstable_rootParams in client components (#79471)\n\nunstable_rootParams is a server component API and should not be allowed\nto be accessed from client components. This change adds a compiler error\nif this import is detected within the client module graph.",
    "sha": "7e44fe350e9c2e6b0c41e67e82e319a01e7ece97",
    "files": [
        {
            "sha": "1f0f25042950233a445a988d8d74c06bbf0c3df1",
            "filename": "crates/next-custom-transforms/src/transforms/react_server_components.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7e44fe350e9c2e6b0c41e67e82e319a01e7ece97/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Freact_server_components.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7e44fe350e9c2e6b0c41e67e82e319a01e7ece97/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Freact_server_components.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Freact_server_components.rs?ref=7e44fe350e9c2e6b0c41e67e82e319a01e7ece97",
            "patch": "@@ -640,7 +640,7 @@ impl ReactServerComponentValidator {\n             invalid_client_imports: vec![Atom::from(\"server-only\"), Atom::from(\"next/headers\")],\n \n             invalid_client_lib_apis_mapping: FxHashMap::from_iter([\n-                (\"next/server\", vec![\"after\"]),\n+                (\"next/server\", vec![\"after\", \"unstable_rootParams\"]),\n                 (\n                     \"next/cache\",\n                     vec!["
        },
        {
            "sha": "90bb710baa1d3dc5785293da43533c550b2aac43",
            "filename": "crates/next-custom-transforms/tests/errors/react-server-components/client-graph/root-params/input.js",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/7e44fe350e9c2e6b0c41e67e82e319a01e7ece97/crates%2Fnext-custom-transforms%2Ftests%2Ferrors%2Freact-server-components%2Fclient-graph%2Froot-params%2Finput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/7e44fe350e9c2e6b0c41e67e82e319a01e7ece97/crates%2Fnext-custom-transforms%2Ftests%2Ferrors%2Freact-server-components%2Fclient-graph%2Froot-params%2Finput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ferrors%2Freact-server-components%2Fclient-graph%2Froot-params%2Finput.js?ref=7e44fe350e9c2e6b0c41e67e82e319a01e7ece97",
            "patch": "@@ -0,0 +1,13 @@\n+// This is a comment.\n+\n+'use strict'\n+\n+/**\n+ * This is a comment.\n+ */\n+\n+import { unstable_rootParams } from 'next/server'\n+\n+export default function () {\n+  return null\n+}"
        },
        {
            "sha": "ce04f4969bcce6cdd85f5dc512c6d8eefd468e6e",
            "filename": "crates/next-custom-transforms/tests/errors/react-server-components/client-graph/root-params/output.js",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/7e44fe350e9c2e6b0c41e67e82e319a01e7ece97/crates%2Fnext-custom-transforms%2Ftests%2Ferrors%2Freact-server-components%2Fclient-graph%2Froot-params%2Foutput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/7e44fe350e9c2e6b0c41e67e82e319a01e7ece97/crates%2Fnext-custom-transforms%2Ftests%2Ferrors%2Freact-server-components%2Fclient-graph%2Froot-params%2Foutput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ferrors%2Freact-server-components%2Fclient-graph%2Froot-params%2Foutput.js?ref=7e44fe350e9c2e6b0c41e67e82e319a01e7ece97",
            "patch": "@@ -0,0 +1,8 @@\n+// This is a comment.\n+'use strict';\n+/**\n+ * This is a comment.\n+ */ import { unstable_rootParams } from 'next/server';\n+export default function() {\n+    return null;\n+}"
        },
        {
            "sha": "268d0f94149e5d409231d2645718c7cf64a04d2e",
            "filename": "crates/next-custom-transforms/tests/errors/react-server-components/client-graph/root-params/output.stderr",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/7e44fe350e9c2e6b0c41e67e82e319a01e7ece97/crates%2Fnext-custom-transforms%2Ftests%2Ferrors%2Freact-server-components%2Fclient-graph%2Froot-params%2Foutput.stderr",
            "raw_url": "https://github.com/vercel/next.js/raw/7e44fe350e9c2e6b0c41e67e82e319a01e7ece97/crates%2Fnext-custom-transforms%2Ftests%2Ferrors%2Freact-server-components%2Fclient-graph%2Froot-params%2Foutput.stderr",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Ftests%2Ferrors%2Freact-server-components%2Fclient-graph%2Froot-params%2Foutput.stderr?ref=7e44fe350e9c2e6b0c41e67e82e319a01e7ece97",
            "patch": "@@ -0,0 +1,9 @@\n+  x You're importing a component that needs \"unstable_rootParams\". That only works in a Server Component which is not supported in the pages/ directory. Read more: https://nextjs.org/docs/app/\n+  | building-your-application/rendering/server-components\n+  | \n+  | \n+   ,-[input.js:9:1]\n+ 8 | \n+ 9 | import { unstable_rootParams } from 'next/server'\n+   :          ^^^^^^^^^^^^^^^^^^^\n+   `----"
        }
    ],
    "stats": {
        "total": 32,
        "additions": 31,
        "deletions": 1
    }
}