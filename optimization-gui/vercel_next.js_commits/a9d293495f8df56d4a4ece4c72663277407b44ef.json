{
    "author": "ijjk",
    "message": "Fix dynamic route param encoding (#78326)\n\nOur encoding test in `vercel/vercel` started failing from\nhttps://github.com/vercel/next.js/pull/77994 this reverts part of the\nchange there to ensure we always normalize our dynamic route params.\nValidated in https://github.com/vercel/vercel/pull/13259\n\n<details>\n\n<summary>test failure</summary>\n\n![CleanShot 2025-04-12 at 11 10\n48@2x](https://github.com/user-attachments/assets/9696ae4a-8db1-420b-8bc6-ba3e43efb1b1)\n\n</details>\n\nx-ref: [slack\nthread](https://vercel.slack.com/archives/C02CDC2ALJH/p1744481510502349)",
    "sha": "a9d293495f8df56d4a4ece4c72663277407b44ef",
    "files": [
        {
            "sha": "2b0ca1a8d2c4762a37aff62aafde588e71c63989",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 8,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/a9d293495f8df56d4a4ece4c72663277407b44ef/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/a9d293495f8df56d4a4ece4c72663277407b44ef/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=a9d293495f8df56d4a4ece4c72663277407b44ef",
            "patch": "@@ -1249,14 +1249,9 @@ export default abstract class Server<\n           if (pageIsDynamic) {\n             let params: ParsedUrlQuery | false = {}\n \n-            // If we don't already have valid params, try to parse them from\n-            // the query params.\n-            if (!paramsResult.hasValidParams) {\n-              paramsResult = utils.normalizeDynamicRouteParams(\n-                queryParams,\n-                false\n-              )\n-            }\n+            // ensure we normalize the dynamic route params for encoding/\n+            // default values\n+            paramsResult = utils.normalizeDynamicRouteParams(queryParams, false)\n \n             // for prerendered ISR paths we attempt parsing the route\n             // params from the URL directly as route-matches may not"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 3,
        "deletions": 8
    }
}