{
    "author": "timneutkens",
    "message": "Turbopack Build: Implement helpful error for missing sass package (#80155)\n\n## What?\n\nImplements the same error message that we add to the webpack handling. I'm not super happy about this solution (though it matches what we do for webpack) ideally we improve the sass-loader error itself in the future but that requires upgrading sass-loader as well and introducing a breaking change. For now this unblocks the test passing.",
    "sha": "1a18884755973acb4d68ac3989971ef81e2876bb",
    "files": [
        {
            "sha": "aed09d6927d6945c63558a52a722c39a06bea5b4",
            "filename": "packages/next/src/shared/lib/turbopack/utils.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/1a18884755973acb4d68ac3989971ef81e2876bb/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fturbopack%2Futils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1a18884755973acb4d68ac3989971ef81e2876bb/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fturbopack%2Futils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fturbopack%2Futils.ts?ref=1a18884755973acb4d68ac3989971ef81e2876bb",
            "patch": "@@ -190,7 +190,17 @@ export function formatIssue(issue: Issue) {\n   }\n \n   if (description) {\n-    message += renderStyledStringToErrorAnsi(description) + '\\n\\n'\n+    if (\n+      description.type === 'text' &&\n+      description.value.includes(`Cannot find module 'sass'`)\n+    ) {\n+      message +=\n+        \"To use Next.js' built-in Sass support, you first need to install `sass`.\\n\"\n+      message += 'Run `npm i sass` or `yarn add sass` inside your workspace.\\n'\n+      message += '\\nLearn more: https://nextjs.org/docs/messages/install-sass'\n+    } else {\n+      message += renderStyledStringToErrorAnsi(description) + '\\n\\n'\n+    }\n   }\n \n   // TODO: make it possible to enable this for debugging, but not in tests."
        },
        {
            "sha": "4d920cd8a4d6dfda1c831fe8169ddc95b52b6f1a",
            "filename": "test/e2e/app-dir/scss/webpack-error/webpack-error.test.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/1a18884755973acb4d68ac3989971ef81e2876bb/test%2Fe2e%2Fapp-dir%2Fscss%2Fwebpack-error%2Fwebpack-error.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/1a18884755973acb4d68ac3989971ef81e2876bb/test%2Fe2e%2Fapp-dir%2Fscss%2Fwebpack-error%2Fwebpack-error.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Fwebpack-error%2Fwebpack-error.test.ts?ref=1a18884755973acb4d68ac3989971ef81e2876bb",
            "patch": "@@ -24,7 +24,6 @@ describe('SCSS Support', () => {\n         'Learn more: https://nextjs.org/docs/messages/install-sass'\n       )\n \n-      expect(cliOutput).toContain('Failed to compile.')\n       expect(cliOutput).not.toContain('css-loader')\n       expect(cliOutput).not.toContain('sass-loader')\n     })"
        },
        {
            "sha": "cb0e86f3b2051856e0f79610f6466ecb36b62c21",
            "filename": "test/turbopack-build-tests-manifest.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/1a18884755973acb4d68ac3989971ef81e2876bb/test%2Fturbopack-build-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/1a18884755973acb4d68ac3989971ef81e2876bb/test%2Fturbopack-build-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fturbopack-build-tests-manifest.json?ref=1a18884755973acb4d68ac3989971ef81e2876bb",
            "patch": "@@ -5320,10 +5320,10 @@\n     \"runtimeError\": false\n   },\n   \"test/e2e/app-dir/scss/webpack-error/webpack-error.test.ts\": {\n-    \"passed\": [],\n-    \"failed\": [\n+    \"passed\": [\n       \"SCSS Support Friendly Webpack Error should be a friendly error successfully\"\n     ],\n+    \"failed\": [],\n     \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 13,
        "deletions": 4
    }
}