{
    "author": "mischnic",
    "message": "Turbopack Build: Fix next/dynamic test (#79407)\n\nAlternative solution for #79406, see the extensive description over\nthere\n\nFixes PACK-4514\n\n---------\n\nCo-authored-by: Tim Neutkens <tim@timneutkens.nl>",
    "sha": "1ae1b9ba23ff5521ccc8991f3eea6d5c62695671",
    "files": [
        {
            "sha": "07f3740f7663c3ea3c27afe6a828215230e96152",
            "filename": "crates/next-api/src/loadable_manifest.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/1ae1b9ba23ff5521ccc8991f3eea6d5c62695671/crates%2Fnext-api%2Fsrc%2Floadable_manifest.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/1ae1b9ba23ff5521ccc8991f3eea6d5c62695671/crates%2Fnext-api%2Fsrc%2Floadable_manifest.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Floadable_manifest.rs?ref=1ae1b9ba23ff5521ccc8991f3eea6d5c62695671",
            "patch": "@@ -1,8 +1,7 @@\n use anyhow::Result;\n use next_core::{next_manifests::LoadableManifest, util::NextRuntime};\n use rustc_hash::FxHashMap;\n-use turbo_rcstr::RcStr;\n-use turbo_tasks::{ResolvedVc, TryFlatJoinIterExt, ValueToString, Vc};\n+use turbo_tasks::{ResolvedVc, TryFlatJoinIterExt, Vc};\n use turbo_tasks_fs::{File, FileContent, FileSystemPath};\n use turbopack_core::{\n     asset::AssetContent,\n@@ -22,12 +21,12 @@ pub async fn create_react_loadable_manifest(\n ) -> Result<Vc<OutputAssets>> {\n     let dynamic_import_entries = &*dynamic_import_entries.await?;\n \n-    let mut loadable_manifest: FxHashMap<RcStr, LoadableManifest> = FxHashMap::default();\n+    let mut loadable_manifest: FxHashMap<String, LoadableManifest> = FxHashMap::default();\n \n     for (_, (module_id, chunk_output)) in dynamic_import_entries.into_iter() {\n         let chunk_output = chunk_output.await?;\n \n-        let id = module_id.to_string().owned().await?;\n+        let id = &*module_id.await?;\n \n         let client_relative_path_value = client_relative_path.await?;\n         let files = chunk_output\n@@ -44,11 +43,11 @@ pub async fn create_react_loadable_manifest(\n             .await?;\n \n         let manifest_item = LoadableManifest {\n-            id: id.clone(),\n+            id: id.into(),\n             files,\n         };\n \n-        loadable_manifest.insert(id, manifest_item);\n+        loadable_manifest.insert(id.to_string(), manifest_item);\n     }\n \n     let manifest_json = serde_json::to_string_pretty(&loadable_manifest)?;"
        },
        {
            "sha": "bfad238c8f3f7b59ad5e33a537e38fe82aea8057",
            "filename": "crates/next-core/src/next_manifests/mod.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/1ae1b9ba23ff5521ccc8991f3eea6d5c62695671/crates%2Fnext-core%2Fsrc%2Fnext_manifests%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/1ae1b9ba23ff5521ccc8991f3eea6d5c62695671/crates%2Fnext-core%2Fsrc%2Fnext_manifests%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_manifests%2Fmod.rs?ref=1ae1b9ba23ff5521ccc8991f3eea6d5c62695671",
            "patch": "@@ -269,10 +269,10 @@ pub struct AppPathsManifest {\n // The manifest is in a format of:\n // { [`${origin} -> ${imported}`]: { id: `${origin} -> ${imported}`, files:\n // string[] } }\n-#[derive(Serialize, Default, Debug)]\n+#[derive(Serialize, Debug)]\n #[serde(rename_all = \"camelCase\")]\n pub struct LoadableManifest {\n-    pub id: RcStr,\n+    pub id: ModuleId,\n     pub files: Vec<RcStr>,\n }\n "
        },
        {
            "sha": "5cdbb2af8117fe83ec5ef3d47da39c829587fd41",
            "filename": "test/turbopack-build-tests-manifest.json",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/1ae1b9ba23ff5521ccc8991f3eea6d5c62695671/test%2Fturbopack-build-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/1ae1b9ba23ff5521ccc8991f3eea6d5c62695671/test%2Fturbopack-build-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fturbopack-build-tests-manifest.json?ref=1ae1b9ba23ff5521ccc8991f3eea6d5c62695671",
            "patch": "@@ -15648,10 +15648,11 @@\n     \"runtimeError\": false\n   },\n   \"test/integration/next-dynamic/test/index.test.js\": {\n-    \"passed\": [\"next/dynamic production mode should render server value\"],\n-    \"failed\": [\n+    \"passed\": [\n+      \"next/dynamic production mode should render server value\",\n       \"next/dynamic production mode should render dynamic server rendered values on client mount\"\n     ],\n+    \"failed\": [],\n     \"pending\": [\n       \"next/dynamic development mode should render dynamic server rendered values on client mount\",\n       \"next/dynamic development mode should render server value\""
        }
    ],
    "stats": {
        "total": 20,
        "additions": 10,
        "deletions": 10
    }
}