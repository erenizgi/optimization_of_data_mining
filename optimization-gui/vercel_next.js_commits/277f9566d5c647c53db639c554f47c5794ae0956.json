{
    "author": "ztanner",
    "message": "[cache components]: add 'bypass' cache indicator status (#85082)\n\nWhen caches are disabled (eg via browser devtools, or hard refresh),\nwe'll be rendering a special UI state in the dev indicator. This adds\nthe new state to the existing cache status plumbing and will be used in\nthe next PR.",
    "sha": "277f9566d5c647c53db639c554f47c5794ae0956",
    "files": [
        {
            "sha": "e1b0d9bfd6b7e0dd96c63ef3b0eec816ffd450d5",
            "filename": "packages/next/src/next-devtools/dev-overlay/cache-indicator.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/277f9566d5c647c53db639c554f47c5794ae0956/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcache-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/277f9566d5c647c53db639c554f47c5794ae0956/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcache-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcache-indicator.tsx?ref=277f9566d5c647c53db639c554f47c5794ae0956",
            "patch": "@@ -1,2 +1,2 @@\n-export type ServerCacheStatus = 'filling' | 'filled'\n-export type CacheIndicatorState = 'disabled' | 'ready' | ServerCacheStatus\n+export type ServerCacheStatus = 'filling' | 'filled' | 'bypass' | 'ready'\n+export type CacheIndicatorState = 'disabled' | ServerCacheStatus"
        },
        {
            "sha": "bc3e5cd59fe0d1a49a1a1fda39fd57642a4a8655",
            "filename": "packages/next/src/server/app-render/app-render.tsx",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/277f9566d5c647c53db639c554f47c5794ae0956/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/277f9566d5c647c53db639c554f47c5794ae0956/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx?ref=277f9566d5c647c53db639c554f47c5794ae0956",
            "patch": "@@ -666,8 +666,15 @@ async function generateDynamicFlightRenderResultWithCachesInDev(\n     dev = false,\n     onInstrumentationRequestError,\n     setReactDebugChannel,\n+    setCacheStatus,\n   } = renderOpts\n \n+  // Before we kick off the render, we set the cache status back to it's initial state\n+  // in case a previous render bypassed the cache.\n+  if (process.env.NODE_ENV === 'development') {\n+    setCacheStatus!('ready', htmlRequestId, requestId)\n+  }\n+\n   function onFlightDataRenderError(err: DigestedError) {\n     return onInstrumentationRequestError?.(\n       err,\n@@ -1891,6 +1898,11 @@ async function renderToHTMLOrFlightImpl(\n             createRequestStore\n           )\n         } else {\n+          // Set cache status to bypass when specifically bypassing caches in dev\n+          if (process.env.NODE_ENV === 'development' && bypassCachesInDev) {\n+            const { setCacheStatus } = renderOpts\n+            setCacheStatus!('bypass', htmlRequestId, requestId)\n+          }\n           return generateDynamicFlightRenderResult(req, ctx, requestStore)\n         }\n       }"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 14,
        "deletions": 2
    }
}