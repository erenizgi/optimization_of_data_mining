{
    "author": "wbinnssmith",
    "message": "Turbopack: Make `turbo-tasks-malloc` crate Rust 2024 (#79129)\n\nWrapped env setting in `unsafe` blocks. The calling functions were\nalready `unsafe`.",
    "sha": "7e9b55da8b0d72c22708ae08a71581858e802bef",
    "files": [
        {
            "sha": "b3331d12867983aee1ad0b0acf6d9d9053b5aed9",
            "filename": "turbopack/crates/turbo-tasks-malloc/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7e9b55da8b0d72c22708ae08a71581858e802bef/turbopack%2Fcrates%2Fturbo-tasks-malloc%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/7e9b55da8b0d72c22708ae08a71581858e802bef/turbopack%2Fcrates%2Fturbo-tasks-malloc%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-malloc%2FCargo.toml?ref=7e9b55da8b0d72c22708ae08a71581858e802bef",
            "patch": "@@ -3,7 +3,7 @@ name = \"turbo-tasks-malloc\"\n version = \"0.1.0\"\n description = \"A wrapper around mimalloc or the system allocator that tracks allocations\"\n license = \"MIT\"\n-edition = \"2021\"\n+edition = \"2024\"\n autobenches = false\n \n [lib]"
        },
        {
            "sha": "f8957c2fd3a627fb6f6f38530eea20179c1f9314",
            "filename": "turbopack/crates/turbo-tasks-malloc/src/lib.rs",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/7e9b55da8b0d72c22708ae08a71581858e802bef/turbopack%2Fcrates%2Fturbo-tasks-malloc%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/7e9b55da8b0d72c22708ae08a71581858e802bef/turbopack%2Fcrates%2Fturbo-tasks-malloc%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-malloc%2Fsrc%2Flib.rs?ref=7e9b55da8b0d72c22708ae08a71581858e802bef",
            "patch": "@@ -84,28 +84,28 @@ fn base_alloc() -> &'static impl GlobalAlloc {\n \n unsafe impl GlobalAlloc for TurboMalloc {\n     unsafe fn alloc(&self, layout: Layout) -> *mut u8 {\n-        let ret = base_alloc().alloc(layout);\n+        let ret = unsafe { base_alloc().alloc(layout) };\n         if !ret.is_null() {\n             add(layout.size());\n         }\n         ret\n     }\n \n     unsafe fn dealloc(&self, ptr: *mut u8, layout: Layout) {\n-        base_alloc().dealloc(ptr, layout);\n+        unsafe { base_alloc().dealloc(ptr, layout) };\n         remove(layout.size());\n     }\n \n     unsafe fn alloc_zeroed(&self, layout: Layout) -> *mut u8 {\n-        let ret = base_alloc().alloc_zeroed(layout);\n+        let ret = unsafe { base_alloc().alloc_zeroed(layout) };\n         if !ret.is_null() {\n             add(layout.size());\n         }\n         ret\n     }\n \n     unsafe fn realloc(&self, ptr: *mut u8, layout: Layout, new_size: usize) -> *mut u8 {\n-        let ret = base_alloc().realloc(ptr, layout, new_size);\n+        let ret = unsafe { base_alloc().realloc(ptr, layout, new_size) };\n         if !ret.is_null() {\n             let old_size = layout.size();\n             update(old_size, new_size);"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
    }
}