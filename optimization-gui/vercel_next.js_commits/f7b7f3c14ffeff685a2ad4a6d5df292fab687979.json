{
    "author": "sokra",
    "message": "Turbopack: add NEXT_TURBOPACK_WRITE_ROUTES_HASHES_MANIFEST to write hashes into manifest (#86257)\n\n### What?\n\nAdd an env var to write route hashes into a diagnostics file.",
    "sha": "f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
    "files": [
        {
            "sha": "353272390f7fd1caa6aa2c7be73c818f32123fc5",
            "filename": "Cargo.lock",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/Cargo.lock",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/Cargo.lock",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.lock?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -4269,6 +4269,7 @@ dependencies = [\n  \"turbo-tasks-backend\",\n  \"turbo-tasks-env\",\n  \"turbo-tasks-fs\",\n+ \"turbo-tasks-hash\",\n  \"turbo-tasks-malloc\",\n  \"turbo-unix-path\",\n  \"turbopack\","
        },
        {
            "sha": "3b82cb491e8fed75e3d3a50c22488bee54ea11a0",
            "filename": "crates/napi/src/next_api/project.rs",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnapi%2Fsrc%2Fnext_api%2Fproject.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -21,6 +21,7 @@ use next_api::{\n         ProjectOptions, WatchOptions,\n     },\n     route::Endpoint,\n+    routes_hashes_manifest::routes_hashes_manifest_asset_if_enabled,\n };\n use next_core::tracing_presets::{\n     TRACING_NEXT_OVERVIEW_TARGETS, TRACING_NEXT_TARGETS, TRACING_NEXT_TURBO_TASKS_TARGETS,\n@@ -175,6 +176,9 @@ pub struct NapiProjectOptions {\n     /// debugging/profiling purposes.\n     pub no_mangling: bool,\n \n+    /// Whether to write the route hashes manifest.\n+    pub write_routes_hashes_manifest: bool,\n+\n     /// The version of Node.js that is available/currently running.\n     pub current_node_js_version: RcStr,\n }\n@@ -220,6 +224,9 @@ pub struct NapiPartialProjectOptions {\n     /// The browserslist query to use for targeting browsers.\n     pub browserslist_query: Option<RcStr>,\n \n+    /// Whether to write the route hashes manifest.\n+    pub write_routes_hashes_manifest: Option<bool>,\n+\n     /// When the code is minified, this opts out of the default mangling of\n     /// local names for variables, functions etc., which can be useful for\n     /// debugging/profiling purposes.\n@@ -277,6 +284,7 @@ impl From<NapiProjectOptions> for ProjectOptions {\n             preview_props,\n             browserslist_query,\n             no_mangling,\n+            write_routes_hashes_manifest,\n             current_node_js_version,\n         } = val;\n         ProjectOptions {\n@@ -292,6 +300,7 @@ impl From<NapiProjectOptions> for ProjectOptions {\n             preview_props: preview_props.into(),\n             browserslist_query,\n             no_mangling,\n+            write_routes_hashes_manifest,\n             current_node_js_version,\n         }\n     }\n@@ -312,6 +321,7 @@ impl From<NapiPartialProjectOptions> for PartialProjectOptions {\n             preview_props,\n             browserslist_query,\n             no_mangling,\n+            write_routes_hashes_manifest,\n         } = val;\n         PartialProjectOptions {\n             root_path,\n@@ -326,6 +336,7 @@ impl From<NapiPartialProjectOptions> for PartialProjectOptions {\n             preview_props: preview_props.map(|props| props.into()),\n             browserslist_query,\n             no_mangling,\n+            write_routes_hashes_manifest,\n         }\n     }\n }\n@@ -1057,12 +1068,15 @@ async fn output_assets_operation(\n \n     let nft = next_server_nft_assets(project).await?;\n \n+    let routes_hashes_manifest = routes_hashes_manifest_asset_if_enabled(project).await?;\n+\n     whole_app_module_graphs.as_side_effect().await?;\n \n     Ok(Vc::cell(\n         output_assets\n             .into_iter()\n             .chain(nft.iter().copied())\n+            .chain(routes_hashes_manifest.iter().copied())\n             .collect(),\n     ))\n }"
        },
        {
            "sha": "4dd40d2437d23b7be9fc486eaf253d20aba581d6",
            "filename": "crates/next-api/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2FCargo.toml?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -28,6 +28,7 @@ swc_core = { workspace = true }\n tracing = { workspace = true }\n turbo-rcstr = { workspace = true }\n turbo-tasks = { workspace = true }\n+turbo-tasks-hash = { workspace = true }\n turbo-tasks-env = { workspace = true }\n turbo-tasks-fs = { workspace = true }\n turbo-unix-path = { workspace = true }"
        },
        {
            "sha": "a626c81254d42070c8b2d8ac72eea739ad9c96d4",
            "filename": "crates/next-api/src/lib.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Flib.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -21,6 +21,7 @@ mod pages;\n pub mod paths;\n pub mod project;\n pub mod route;\n+pub mod routes_hashes_manifest;\n mod server_actions;\n mod versioned_content_map;\n mod webpack_stats;"
        },
        {
            "sha": "96a7382219a5e52ff0184a3c9d8c887347951810",
            "filename": "crates/next-api/src/pages.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2Fsrc%2Fpages.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fpages.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -1713,7 +1713,11 @@ impl Endpoint for PageEndpoint {\n     async fn module_graphs(self: Vc<Self>) -> Result<Vc<ModuleGraphs>> {\n         let client_module_graph = self.client_module_graph().to_resolved().await?;\n         let ssr_module_graph = self.ssr_module_graph().to_resolved().await?;\n-        Ok(Vc::cell(vec![client_module_graph, ssr_module_graph]))\n+        Ok(Vc::cell(if client_module_graph != ssr_module_graph {\n+            vec![client_module_graph, ssr_module_graph]\n+        } else {\n+            vec![ssr_module_graph]\n+        }))\n     }\n }\n "
        },
        {
            "sha": "1a34b46902451eecead301271d6077391ffcc686",
            "filename": "crates/next-api/src/project.rs",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2Fsrc%2Fproject.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2Fsrc%2Fproject.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Fproject.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -189,6 +189,9 @@ pub struct ProjectOptions {\n     /// debugging/profiling purposes.\n     pub no_mangling: bool,\n \n+    /// Whether to write the route hashes manifest.\n+    pub write_routes_hashes_manifest: bool,\n+\n     /// The version of Node.js that is available/currently running.\n     pub current_node_js_version: RcStr,\n }\n@@ -237,6 +240,9 @@ pub struct PartialProjectOptions {\n     /// local names for variables, functions etc., which can be useful for\n     /// debugging/profiling purposes.\n     pub no_mangling: Option<bool>,\n+\n+    /// Whether to write the route hashes manifest.\n+    pub write_routes_hashes_manifest: Option<bool>,\n }\n \n #[derive(\n@@ -357,6 +363,7 @@ impl ProjectContainer {\n             preview_props,\n             browserslist_query,\n             no_mangling,\n+            write_routes_hashes_manifest,\n         } = options;\n \n         let resolved_self = self.to_resolved().await?;\n@@ -404,6 +411,9 @@ impl ProjectContainer {\n         if let Some(no_mangling) = no_mangling {\n             new_options.no_mangling = no_mangling;\n         }\n+        if let Some(write_routes_hashes_manifest) = write_routes_hashes_manifest {\n+            new_options.write_routes_hashes_manifest = write_routes_hashes_manifest;\n+        }\n \n         // TODO: Handle mode switch, should prevent mode being switched.\n         let watch = new_options.watch;\n@@ -468,6 +478,7 @@ impl ProjectContainer {\n         let preview_props;\n         let browserslist_query;\n         let no_mangling;\n+        let write_routes_hashes_manifest;\n         let current_node_js_version;\n         {\n             let options = self.options_state.get();\n@@ -491,6 +502,7 @@ impl ProjectContainer {\n             preview_props = options.preview_props.clone();\n             browserslist_query = options.browserslist_query.clone();\n             no_mangling = options.no_mangling;\n+            write_routes_hashes_manifest = options.write_routes_hashes_manifest;\n             current_node_js_version = options.current_node_js_version.clone();\n         }\n \n@@ -516,6 +528,7 @@ impl ProjectContainer {\n             encryption_key,\n             preview_props,\n             no_mangling,\n+            write_routes_hashes_manifest,\n             current_node_js_version,\n         }\n         .cell())\n@@ -603,6 +616,9 @@ pub struct Project {\n     /// debugging/profiling purposes.\n     no_mangling: bool,\n \n+    /// Whether to write the route hashes manifest.\n+    write_routes_hashes_manifest: bool,\n+\n     current_node_js_version: RcStr,\n }\n \n@@ -823,6 +839,11 @@ impl Project {\n         Ok(Vc::cell(self.watch.enable))\n     }\n \n+    #[turbo_tasks::function]\n+    pub(super) fn should_write_routes_hashes_manifest(&self) -> Result<Vc<bool>> {\n+        Ok(Vc::cell(self.write_routes_hashes_manifest))\n+    }\n+\n     #[turbo_tasks::function]\n     pub(super) async fn per_page_module_graph(&self) -> Result<Vc<bool>> {\n         Ok(Vc::cell(*self.mode.await? == NextMode::Development))"
        },
        {
            "sha": "ea3bbf37bdba8b7b46dc67bb17bebcba740362cb",
            "filename": "crates/next-api/src/routes_hashes_manifest.rs",
            "status": "added",
            "additions": 327,
            "deletions": 0,
            "changes": 327,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2Fsrc%2Froutes_hashes_manifest.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-api%2Fsrc%2Froutes_hashes_manifest.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-api%2Fsrc%2Froutes_hashes_manifest.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -0,0 +1,327 @@\n+use anyhow::Result;\n+use serde::Serialize;\n+use turbo_tasks::{FxIndexMap, FxIndexSet, ResolvedVc, TryFlatJoinIterExt, TryJoinIterExt, Vc};\n+use turbo_tasks_fs::{FileContent, FileSystemPath};\n+use turbo_tasks_hash::{DeterministicHash, Xxh3Hash64Hasher};\n+use turbopack_core::{\n+    asset::{Asset, AssetContent},\n+    module::Module,\n+    module_graph::{GraphTraversalAction, ModuleGraph},\n+    output::{\n+        ExpandOutputAssetsInput, OutputAsset, OutputAssets, OutputAssetsReference,\n+        expand_output_assets,\n+    },\n+};\n+\n+use crate::{\n+    project::Project,\n+    route::{AppPageRoute, Endpoint, Route},\n+};\n+\n+#[turbo_tasks::value(shared)]\n+pub struct EndpointHashes {\n+    pub sources_hash: u64,\n+    pub outputs_hash: u64,\n+}\n+\n+impl EndpointHashes {\n+    pub fn merge<'l>(iterator: impl Iterator<Item = (&'l str, &'l EndpointHashes)>) -> Self {\n+        let mut sources_hasher = Xxh3Hash64Hasher::new();\n+        let mut outputs_hasher = Xxh3Hash64Hasher::new();\n+\n+        for (key, hashes) in iterator {\n+            key.deterministic_hash(&mut sources_hasher);\n+            key.deterministic_hash(&mut outputs_hasher);\n+            hashes.sources_hash.deterministic_hash(&mut sources_hasher);\n+            hashes.outputs_hash.deterministic_hash(&mut outputs_hasher);\n+        }\n+\n+        Self {\n+            sources_hash: sources_hasher.finish(),\n+            outputs_hash: outputs_hasher.finish(),\n+        }\n+    }\n+}\n+\n+#[turbo_tasks::function]\n+pub async fn endpoint_hashes(\n+    base_module_graph: Vc<ModuleGraph>,\n+    module_graph: Vc<ModuleGraph>,\n+    endpoint: Vc<Box<dyn Endpoint>>,\n+) -> Result<Vc<EndpointHashes>> {\n+    let entries = endpoint.entries();\n+    let additional_entries = endpoint.additional_entries(base_module_graph);\n+    let modules = entries\n+        .await?\n+        .into_iter()\n+        .chain(additional_entries.await?.into_iter())\n+        .flat_map(|e| e.entries())\n+        .collect::<FxIndexSet<_>>();\n+    let outputs = endpoint.output();\n+\n+    let mut all_modules = FxIndexSet::default();\n+\n+    let module_graph = module_graph.read_graphs().await?;\n+\n+    module_graph.traverse_nodes_from_entries_dfs(\n+        modules,\n+        &mut all_modules,\n+        |module, all_modules| {\n+            all_modules.insert(*module);\n+            Ok(GraphTraversalAction::Continue)\n+        },\n+        |_, _| Ok(()),\n+    )?;\n+\n+    let sources = all_modules\n+        .iter()\n+        .map(|module| module.source())\n+        .try_flat_join()\n+        .await?\n+        .into_iter()\n+        .map(|source| source.content().hash())\n+        .try_join()\n+        .await?;\n+\n+    let output_assets = expand_output_assets(\n+        outputs\n+            .await?\n+            .output_assets\n+            .await?\n+            .into_iter()\n+            .map(|asset| ExpandOutputAssetsInput::Asset(*asset)),\n+        true,\n+    )\n+    .await?;\n+    let outputs_hashes = output_assets\n+        .iter()\n+        .map(|asset| asset.content().hash())\n+        .try_join()\n+        .await?;\n+\n+    let sources_hash = {\n+        let mut hasher = Xxh3Hash64Hasher::new();\n+        for source in sources.iter() {\n+            source.deterministic_hash(&mut hasher);\n+        }\n+        hasher.finish()\n+    };\n+    let outputs_hash = {\n+        let mut hasher = Xxh3Hash64Hasher::new();\n+        for hash in outputs_hashes.iter() {\n+            hash.deterministic_hash(&mut hasher);\n+        }\n+        hasher.finish()\n+    };\n+\n+    Ok(EndpointHashes {\n+        sources_hash,\n+        outputs_hash,\n+    }\n+    .cell())\n+}\n+\n+#[derive(Serialize)]\n+struct RoutesHashesManifest<'l> {\n+    pub routes: FxIndexMap<&'l str, EndpointHashStrings>,\n+}\n+\n+#[derive(Serialize)]\n+#[serde(rename_all = \"camelCase\")]\n+pub struct EndpointHashStrings {\n+    pub sources_hash: String,\n+    pub outputs_hash: String,\n+}\n+\n+#[turbo_tasks::value]\n+pub struct RoutesHashesManifestAsset {\n+    path: FileSystemPath,\n+    project: ResolvedVc<Project>,\n+}\n+\n+#[turbo_tasks::value_impl]\n+impl RoutesHashesManifestAsset {\n+    #[turbo_tasks::function]\n+    pub fn new(path: FileSystemPath, project: ResolvedVc<Project>) -> Vc<Self> {\n+        RoutesHashesManifestAsset { path, project }.cell()\n+    }\n+}\n+\n+#[turbo_tasks::value_impl]\n+impl Asset for RoutesHashesManifestAsset {\n+    #[turbo_tasks::function]\n+    async fn content(&self) -> Result<Vc<AssetContent>> {\n+        let entrypoints = self.project.entrypoints().await?;\n+        let module_graphs = self.project.whole_app_module_graphs().await?;\n+        let base_module_graph = *module_graphs.base;\n+        let full_module_graph = *module_graphs.full;\n+\n+        let mut entrypoint_hashes = FxIndexMap::default();\n+\n+        if let Some(instrumentation) = &entrypoints.instrumentation {\n+            entrypoint_hashes.insert(\n+                \"instrumentation\",\n+                endpoint_hashes(\n+                    base_module_graph,\n+                    full_module_graph,\n+                    *instrumentation.node_js,\n+                ),\n+            );\n+            entrypoint_hashes.insert(\n+                \"edgeInstrumentation\",\n+                endpoint_hashes(base_module_graph, full_module_graph, *instrumentation.edge),\n+            );\n+        }\n+        if let Some(middleware) = &entrypoints.middleware {\n+            entrypoint_hashes.insert(\n+                \"middleware\",\n+                endpoint_hashes(base_module_graph, full_module_graph, *middleware.endpoint),\n+            );\n+        }\n+        entrypoint_hashes.insert(\n+            \"_document\",\n+            endpoint_hashes(\n+                base_module_graph,\n+                full_module_graph,\n+                *entrypoints.pages_document_endpoint,\n+            ),\n+        );\n+        entrypoint_hashes.insert(\n+            \"_app\",\n+            endpoint_hashes(\n+                base_module_graph,\n+                full_module_graph,\n+                *entrypoints.pages_app_endpoint,\n+            ),\n+        );\n+        entrypoint_hashes.insert(\n+            \"_error\",\n+            endpoint_hashes(\n+                base_module_graph,\n+                full_module_graph,\n+                *entrypoints.pages_error_endpoint,\n+            ),\n+        );\n+\n+        for (key, route) in entrypoints.routes.iter() {\n+            match route {\n+                Route::Page {\n+                    html_endpoint,\n+                    // Only for dev\n+                    data_endpoint: _,\n+                } => {\n+                    entrypoint_hashes.insert(\n+                        key,\n+                        endpoint_hashes(base_module_graph, full_module_graph, **html_endpoint),\n+                    );\n+                }\n+                Route::PageApi { endpoint } => {\n+                    entrypoint_hashes.insert(\n+                        key,\n+                        endpoint_hashes(base_module_graph, full_module_graph, **endpoint),\n+                    );\n+                }\n+                Route::AppPage(pages) => {\n+                    if pages.len() == 1 {\n+                        entrypoint_hashes.insert(\n+                            key,\n+                            endpoint_hashes(\n+                                base_module_graph,\n+                                full_module_graph,\n+                                *pages[0].html_endpoint,\n+                            ),\n+                        );\n+                    } else {\n+                        let hashes = pages\n+                            .iter()\n+                            .map(\n+                                |&AppPageRoute {\n+                                     original_name: _,\n+                                     html_endpoint,\n+                                     // Only for dev\n+                                     rsc_endpoint: _,\n+                                 }| {\n+                                    endpoint_hashes(\n+                                        base_module_graph,\n+                                        full_module_graph,\n+                                        *html_endpoint,\n+                                    )\n+                                },\n+                            )\n+                            .try_join()\n+                            .await?;\n+                        let hashes = EndpointHashes::merge(\n+                            pages\n+                                .iter()\n+                                .map(|page| page.original_name.as_str())\n+                                .zip(hashes.iter())\n+                                .map(|(k, v)| (k, &**v)),\n+                        )\n+                        .cell();\n+                        entrypoint_hashes.insert(key, hashes);\n+                    }\n+                }\n+                Route::AppRoute {\n+                    original_name: _,\n+                    endpoint,\n+                } => {\n+                    entrypoint_hashes.insert(\n+                        key,\n+                        endpoint_hashes(base_module_graph, full_module_graph, **endpoint),\n+                    );\n+                }\n+                Route::Conflict => {}\n+            }\n+        }\n+\n+        let entrypoint_hashes_values = entrypoint_hashes.values().copied().try_join().await?;\n+\n+        let manifest = serde_json::to_string_pretty(&RoutesHashesManifest {\n+            routes: entrypoint_hashes\n+                .keys()\n+                .zip(entrypoint_hashes_values.iter())\n+                .map(|(k, v)| {\n+                    (\n+                        *k,\n+                        EndpointHashStrings {\n+                            sources_hash: format!(\"{:016x}\", v.sources_hash),\n+                            outputs_hash: format!(\"{:016x}\", v.outputs_hash),\n+                        },\n+                    )\n+                })\n+                .collect(),\n+        })?;\n+        Ok(AssetContent::File(FileContent::Content(manifest.into()).resolved_cell()).cell())\n+    }\n+}\n+\n+#[turbo_tasks::value_impl]\n+impl OutputAssetsReference for RoutesHashesManifestAsset {}\n+\n+#[turbo_tasks::value_impl]\n+impl OutputAsset for RoutesHashesManifestAsset {\n+    #[turbo_tasks::function]\n+    fn path(&self) -> Vc<FileSystemPath> {\n+        self.path.clone().cell()\n+    }\n+}\n+\n+#[turbo_tasks::function]\n+pub async fn routes_hashes_manifest_asset_if_enabled(\n+    project: ResolvedVc<Project>,\n+) -> Result<Vc<OutputAssets>> {\n+    let should_write = *project.should_write_routes_hashes_manifest().await?;\n+    let assets = if should_write {\n+        let path = project\n+            .node_root()\n+            .await?\n+            .join(\"diagnostics/routes-hashes-manifest.json\")?;\n+        let asset = RoutesHashesManifestAsset::new(path, *project)\n+            .to_resolved()\n+            .await?;\n+        vec![ResolvedVc::upcast(asset)]\n+    } else {\n+        vec![]\n+    };\n+    Ok(Vc::cell(assets))\n+}"
        },
        {
            "sha": "a4b03cde27fd444216910ea09988044c924ee00a",
            "filename": "crates/next-build-test/src/main.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-build-test%2Fsrc%2Fmain.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-build-test%2Fsrc%2Fmain.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-build-test%2Fsrc%2Fmain.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -182,6 +182,7 @@ fn main() {\n                                      Safari versions, last 1 Edge versions\"\n                     .into(),\n                 no_mangling: false,\n+                write_routes_hashes_manifest: false,\n                 current_node_js_version: rcstr!(\"18.0.0\"),\n             };\n "
        },
        {
            "sha": "8653c564bde51fd883004996dd916f382a03f5c0",
            "filename": "crates/next-core/src/hmr_entry.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fhmr_entry.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fhmr_entry.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fhmr_entry.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -16,6 +16,7 @@ use turbopack_core::{\n     output::OutputAssetsReference,\n     reference::{ModuleReference, ModuleReferences},\n     resolve::ModuleResolveResult,\n+    source::OptionSource,\n };\n use turbopack_ecmascript::{\n     chunk::{\n@@ -62,6 +63,11 @@ impl Module for HmrEntryModule {\n         hmr_entry_point_base_ident().with_asset(rcstr!(\"ENTRY\"), *self.ident)\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(&self) -> Result<Vc<ModuleReferences>> {\n         Ok(Vc::cell(vec![ResolvedVc::upcast("
        },
        {
            "sha": "8238907881e0309fd633f74994c4163b8dd10233",
            "filename": "crates/next-core/src/next_client_reference/css_client_reference/css_client_reference_module.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 4,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_client_reference%2Fcss_client_reference%2Fcss_client_reference_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_client_reference%2Fcss_client_reference%2Fcss_client_reference_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_client_reference%2Fcss_client_reference%2Fcss_client_reference_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -1,6 +1,7 @@\n-use anyhow::{Result, bail};\n+use anyhow::Result;\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{ResolvedVc, ValueToString, Vc};\n+use turbo_tasks_fs::FileContent;\n use turbopack::css::chunk::CssChunkPlaceable;\n use turbopack_core::{\n     asset::{Asset, AssetContent},\n@@ -9,6 +10,7 @@ use turbopack_core::{\n     module::Module,\n     reference::{ModuleReference, ModuleReferences},\n     resolve::ModuleResolveResult,\n+    source::OptionSource,\n };\n \n /// A [`CssClientReferenceModule`] is a marker module used to indicate which\n@@ -40,6 +42,11 @@ impl Module for CssClientReferenceModule {\n             .with_modifier(rcstr!(\"css client reference\"))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         let CssClientReferenceModule { client_module, .. } = &*self.await?;\n@@ -55,9 +62,14 @@ impl Module for CssClientReferenceModule {\n #[turbo_tasks::value_impl]\n impl Asset for CssClientReferenceModule {\n     #[turbo_tasks::function]\n-    fn content(&self) -> Result<Vc<AssetContent>> {\n-        // The client reference asset only serves as a marker asset.\n-        bail!(\"CssClientReferenceModule has no content\")\n+    fn content(&self) -> Vc<AssetContent> {\n+        AssetContent::File(\n+            FileContent::Content(\n+                \"// This is a marker module for Next.js client CSS references.\".into(),\n+            )\n+            .resolved_cell(),\n+        )\n+        .cell()\n     }\n }\n "
        },
        {
            "sha": "7b06a51284da620917b6aa39cc46e637f57a5593",
            "filename": "crates/next-core/src/next_client_reference/ecmascript_client_reference/ecmascript_client_reference_module.rs",
            "status": "modified",
            "additions": 13,
            "deletions": 3,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_client_reference%2Fecmascript_client_reference%2Fecmascript_client_reference_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_client_reference%2Fecmascript_client_reference%2Fecmascript_client_reference_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_client_reference%2Fecmascript_client_reference%2Fecmascript_client_reference_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -4,7 +4,7 @@ use anyhow::{Context, Result, bail};\n use indoc::writedoc;\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{IntoTraitRef, ResolvedVc, ValueToString, Vc};\n-use turbo_tasks_fs::File;\n+use turbo_tasks_fs::{File, FileContent};\n use turbopack_core::{\n     asset::{Asset, AssetContent},\n     chunk::{\n@@ -20,6 +20,7 @@ use turbopack_core::{\n     reference::{ModuleReference, ModuleReferences},\n     reference_type::ReferenceType,\n     resolve::ModuleResolveResult,\n+    source::OptionSource,\n     virtual_source::VirtualSource,\n };\n use turbopack_ecmascript::{\n@@ -197,6 +198,11 @@ impl Module for EcmascriptClientReferenceModule {\n             .with_layer(self.server_asset_context.into_trait_ref().await?.layer()))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         let EcmascriptClientReferenceModule {\n@@ -240,8 +246,12 @@ impl Module for EcmascriptClientReferenceModule {\n #[turbo_tasks::value_impl]\n impl Asset for EcmascriptClientReferenceModule {\n     #[turbo_tasks::function]\n-    fn content(&self) -> Result<Vc<AssetContent>> {\n-        bail!(\"client reference module asset has no content\")\n+    fn content(&self) -> Vc<AssetContent> {\n+        AssetContent::File(\n+            FileContent::Content(\"// This is a proxy module for Next.js client references.\".into())\n+                .resolved_cell(),\n+        )\n+        .cell()\n     }\n }\n "
        },
        {
            "sha": "a93cc9ff59ffa6181de1a3092c27506847a3074c",
            "filename": "crates/next-core/src/next_dynamic/dynamic_module.rs",
            "status": "modified",
            "additions": 14,
            "deletions": 3,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_dynamic%2Fdynamic_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_dynamic%2Fdynamic_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_dynamic%2Fdynamic_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -1,9 +1,10 @@\n use std::collections::BTreeMap;\n \n-use anyhow::{Result, bail};\n+use anyhow::Result;\n use indoc::formatdoc;\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{ResolvedVc, Vc};\n+use turbo_tasks_fs::FileContent;\n use turbopack_core::{\n     asset::{Asset, AssetContent},\n     chunk::{ChunkItem, ChunkType, ChunkableModule, ChunkingContext, ModuleChunkItemIdExt},\n@@ -13,6 +14,7 @@ use turbopack_core::{\n     output::OutputAssetsReference,\n     reference::{ModuleReferences, SingleChunkableModuleReference},\n     resolve::ExportUsage,\n+    source::OptionSource,\n };\n use turbopack_ecmascript::{\n     chunk::{\n@@ -52,6 +54,11 @@ impl Module for NextDynamicEntryModule {\n             .with_modifier(rcstr!(\"next/dynamic entry\"))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(&self) -> Result<Vc<ModuleReferences>> {\n         Ok(Vc::cell(vec![ResolvedVc::upcast(\n@@ -69,8 +76,12 @@ impl Module for NextDynamicEntryModule {\n #[turbo_tasks::value_impl]\n impl Asset for NextDynamicEntryModule {\n     #[turbo_tasks::function]\n-    fn content(&self) -> Result<Vc<AssetContent>> {\n-        bail!(\"Next.js Server Component module has no content\")\n+    fn content(&self) -> Vc<AssetContent> {\n+        AssetContent::File(\n+            FileContent::Content(\"// This is a marker module for Next.js dynamic.\".into())\n+                .resolved_cell(),\n+        )\n+        .cell()\n     }\n }\n "
        },
        {
            "sha": "996bdc7f91a5320c6feaf189d3a05efd62aa50e7",
            "filename": "crates/next-core/src/next_server_component/server_component_module.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 4,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_server_component%2Fserver_component_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_server_component%2Fserver_component_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_server_component%2Fserver_component_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -1,10 +1,10 @@\n use std::collections::BTreeMap;\n \n-use anyhow::{Result, bail};\n+use anyhow::Result;\n use indoc::formatdoc;\n use turbo_rcstr::rcstr;\n use turbo_tasks::{ResolvedVc, Vc};\n-use turbo_tasks_fs::FileSystemPath;\n+use turbo_tasks_fs::{FileContent, FileSystemPath};\n use turbopack_core::{\n     asset::{Asset, AssetContent},\n     chunk::{ChunkItem, ChunkType, ChunkableModule, ChunkingContext, ModuleChunkItemIdExt},\n@@ -13,6 +13,7 @@ use turbopack_core::{\n     module_graph::ModuleGraph,\n     output::OutputAssetsReference,\n     reference::ModuleReferences,\n+    source::OptionSource,\n };\n use turbopack_ecmascript::{\n     chunk::{\n@@ -53,6 +54,11 @@ impl Module for NextServerComponentModule {\n             .with_modifier(rcstr!(\"Next.js Server Component\"))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(&self) -> Result<Vc<ModuleReferences>> {\n         Ok(Vc::cell(vec![ResolvedVc::upcast(\n@@ -66,8 +72,14 @@ impl Module for NextServerComponentModule {\n #[turbo_tasks::value_impl]\n impl Asset for NextServerComponentModule {\n     #[turbo_tasks::function]\n-    fn content(&self) -> Result<Vc<AssetContent>> {\n-        bail!(\"Next.js Server Component module has no content\")\n+    fn content(&self) -> Vc<AssetContent> {\n+        AssetContent::File(\n+            FileContent::Content(\n+                \"// This is a marker module for Next.js server components.\".into(),\n+            )\n+            .resolved_cell(),\n+        )\n+        .cell()\n     }\n }\n "
        },
        {
            "sha": "e50548bd50d13df4ab59b8747151e31e928e8a4f",
            "filename": "crates/next-core/src/next_server_utility/server_utility_module.rs",
            "status": "modified",
            "additions": 14,
            "deletions": 4,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_server_utility%2Fserver_utility_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fnext_server_utility%2Fserver_utility_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_server_utility%2Fserver_utility_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -1,10 +1,10 @@\n use std::collections::BTreeMap;\n \n-use anyhow::{Result, bail};\n+use anyhow::Result;\n use indoc::formatdoc;\n use turbo_rcstr::rcstr;\n use turbo_tasks::{ResolvedVc, Vc};\n-use turbo_tasks_fs::FileSystemPath;\n+use turbo_tasks_fs::{FileContent, FileSystemPath};\n use turbopack_core::{\n     asset::{Asset, AssetContent},\n     chunk::{ChunkItem, ChunkType, ChunkableModule, ChunkingContext, ModuleChunkItemIdExt},\n@@ -13,6 +13,7 @@ use turbopack_core::{\n     module_graph::ModuleGraph,\n     output::OutputAssetsReference,\n     reference::ModuleReferences,\n+    source::OptionSource,\n };\n use turbopack_ecmascript::{\n     chunk::{\n@@ -53,6 +54,11 @@ impl Module for NextServerUtilityModule {\n             .with_modifier(rcstr!(\"Next.js server utility\"))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(&self) -> Result<Vc<ModuleReferences>> {\n         Ok(Vc::cell(vec![ResolvedVc::upcast(\n@@ -66,8 +72,12 @@ impl Module for NextServerUtilityModule {\n #[turbo_tasks::value_impl]\n impl Asset for NextServerUtilityModule {\n     #[turbo_tasks::function]\n-    fn content(&self) -> Result<Vc<AssetContent>> {\n-        bail!(\"Next.js server utility module has no content\")\n+    fn content(&self) -> Vc<AssetContent> {\n+        AssetContent::File(\n+            FileContent::Content(\"// This is a marker module for Next.js server utilities.\".into())\n+                .resolved_cell(),\n+        )\n+        .cell()\n     }\n }\n "
        },
        {
            "sha": "bf8b6fcf3f05f3ed91fa900507aa51cfb3d09bc8",
            "filename": "crates/next-core/src/raw_ecmascript_module.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fraw_ecmascript_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/crates%2Fnext-core%2Fsrc%2Fraw_ecmascript_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fraw_ecmascript_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -22,7 +22,7 @@ use turbopack_core::{\n     module_graph::ModuleGraph,\n     output::OutputAssetsReference,\n     resolve::ModulePart,\n-    source::Source,\n+    source::{OptionSource, Source},\n     source_map::GenerateSourceMap,\n };\n use turbopack_ecmascript::{\n@@ -93,6 +93,11 @@ impl Module for RawEcmascriptModule {\n         self.source.ident().with_modifier(rcstr!(\"raw\"))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     fn is_marked_as_side_effect_free(\n         self: Vc<Self>,"
        },
        {
            "sha": "83f2f1d87e2878c63d91d9d35817862d96e901fb",
            "filename": "packages/next/src/build/swc/generated-native.d.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Fgenerated-native.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Fgenerated-native.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fswc%2Fgenerated-native.d.ts?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -155,6 +155,8 @@ export interface NapiProjectOptions {\n    * debugging/profiling purposes.\n    */\n   noMangling: boolean\n+  /** Whether to write the route hashes manifest. */\n+  writeRoutesHashesManifest: boolean\n   /** The version of Node.js that is available/currently running. */\n   currentNodeJsVersion: RcStr\n }\n@@ -193,6 +195,8 @@ export interface NapiPartialProjectOptions {\n   previewProps?: NapiDraftModeOptions\n   /** The browserslist query to use for targeting browsers. */\n   browserslistQuery?: RcStr\n+  /** Whether to write the route hashes manifest. */\n+  writeRoutesHashesManifest?: boolean\n   /**\n    * When the code is minified, this opts out of the default mangling of\n    * local names for variables, functions etc., which can be useful for"
        },
        {
            "sha": "c57e199474057caafe6fbf6e445177d0376f251b",
            "filename": "packages/next/src/build/turbopack-analyze/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-analyze%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-analyze%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-analyze%2Findex.ts?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -75,6 +75,7 @@ export async function turbopackAnalyze(\n       },\n       browserslistQuery: supportedBrowsers.join(', '),\n       noMangling,\n+      writeRoutesHashesManifest: false,\n       currentNodeJsVersion,\n     },\n     {"
        },
        {
            "sha": "0ef8298023a173e95f2dff1eb73c899b9af70a85",
            "filename": "packages/next/src/build/turbopack-build/impl.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-build%2Fimpl.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-build%2Fimpl.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fturbopack-build%2Fimpl.ts?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -79,6 +79,8 @@ export async function turbopackBuild(): Promise<{\n       previewProps,\n       browserslistQuery: supportedBrowsers.join(', '),\n       noMangling,\n+      writeRoutesHashesManifest:\n+        !!process.env.NEXT_TURBOPACK_WRITE_ROUTES_HASHES_MANIFEST,\n       currentNodeJsVersion,\n     },\n     {"
        },
        {
            "sha": "4d292690b731e8743e67d7e76f6442517338cc3a",
            "filename": "packages/next/src/server/dev/hot-reloader-turbopack.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -274,6 +274,7 @@ export async function createHotReloaderTurbopack(\n       previewProps: opts.fsChecker.prerenderManifest.preview,\n       browserslistQuery: supportedBrowsers.join(', '),\n       noMangling: false,\n+      writeRoutesHashesManifest: false,\n       currentNodeJsVersion,\n     },\n     {"
        },
        {
            "sha": "27359588788d4e5e72535a52b07a283f985b0088",
            "filename": "test/development/basic/next-rs-api.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/test%2Fdevelopment%2Fbasic%2Fnext-rs-api.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/test%2Fdevelopment%2Fbasic%2Fnext-rs-api.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fbasic%2Fnext-rs-api.test.ts?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -229,6 +229,7 @@ async function main() {\n     },\n     browserslistQuery: 'last 2 versions',\n     noMangling: false,\n+    writeRoutesHashesManifest: false,\n     currentNodeJsVersion: '18.0.0',\n   });\n \n@@ -386,6 +387,7 @@ describe('next.rs api', () => {\n       },\n       browserslistQuery: 'last 2 versions',\n       noMangling: false,\n+      writeRoutesHashesManifest: false,\n       currentNodeJsVersion: '18.0.0',\n     })\n     projectUpdateSubscription = filterMapAsyncIterator("
        },
        {
            "sha": "8b585b9d61624c192316aba2eecf6a84df68a6dc",
            "filename": "turbopack/crates/turbo-tasks-fs/src/lib.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -1847,7 +1847,7 @@ impl FileContent {\n }\n \n bitflags! {\n-  #[derive(Default, Serialize, Deserialize, TraceRawVcs, NonLocalValue)]\n+  #[derive(Default, Serialize, Deserialize, TraceRawVcs, NonLocalValue, DeterministicHash)]\n   pub struct LinkType: u8 {\n       const DIRECTORY = 0b00000001;\n       const ABSOLUTE = 0b00000010;"
        },
        {
            "sha": "9e4921295ab2e6ae561d437fefd8916b2e277015",
            "filename": "turbopack/crates/turbopack-core/src/asset.rs",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fasset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fasset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fasset.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -4,6 +4,7 @@ use turbo_tasks::{ResolvedVc, Vc};\n use turbo_tasks_fs::{\n     FileContent, FileJsonContent, FileLinesContent, FileSystemPath, LinkContent, LinkType,\n };\n+use turbo_tasks_hash::Xxh3Hash64Hasher;\n \n use crate::version::{VersionedAssetContent, VersionedContent};\n \n@@ -110,4 +111,18 @@ impl AssetContent {\n         }\n         Ok(())\n     }\n+\n+    #[turbo_tasks::function]\n+    pub async fn hash(&self) -> Result<Vc<u64>> {\n+        match self {\n+            AssetContent::File(content) => Ok(content.hash()),\n+            AssetContent::Redirect { target, link_type } => {\n+                use turbo_tasks_hash::DeterministicHash;\n+                let mut hasher = Xxh3Hash64Hasher::new();\n+                target.deterministic_hash(&mut hasher);\n+                link_type.deterministic_hash(&mut hasher);\n+                Ok(Vc::cell(hasher.finish()))\n+            }\n+        }\n+    }\n }"
        },
        {
            "sha": "a7390e56ccbe0b2f68db5b8fb33cc82ca5bc5036",
            "filename": "turbopack/crates/turbopack-core/src/module.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -2,7 +2,7 @@ use turbo_rcstr::RcStr;\n use turbo_tasks::{ResolvedVc, TaskInput, ValueToString, Vc};\n use turbo_tasks_fs::glob::Glob;\n \n-use crate::{asset::Asset, ident::AssetIdent, reference::ModuleReferences};\n+use crate::{asset::Asset, ident::AssetIdent, reference::ModuleReferences, source::OptionSource};\n \n #[derive(Clone, Copy, Debug, TaskInput, Hash)]\n #[turbo_tasks::value(shared)]\n@@ -27,6 +27,10 @@ pub trait Module: Asset {\n         self.ident().to_string()\n     }\n \n+    /// The source of the [Module].\n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource>;\n+\n     /// Other [Module]s or [OutputAsset]s referenced from this [Module].\n     // TODO refactor to avoid returning [OutputAsset]s here\n     #[turbo_tasks::function]"
        },
        {
            "sha": "68544bc8d9f9b3f874cb12a4992f40bff238d891",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/mod.rs",
            "status": "modified",
            "additions": 10,
            "deletions": 1,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -859,11 +859,15 @@ impl ModuleGraphRef {\n                 })\n             })\n         else {\n-            bail!(\"Couldn't find entry module in module graph\");\n+            bail!(\"Couldn't find entry module {entry:?} in module graph\");\n         };\n         Ok(idx)\n     }\n \n+    pub fn entries(&self) -> impl Iterator<Item = ChunkGroupEntry> + '_ {\n+        self.graphs.iter().flat_map(|g| g.entries.iter().cloned())\n+    }\n+\n     fn get_node(&self, entry: GraphNodeIndex) -> Result<&SingleModuleGraphNode> {\n         let graph = &self.graphs[entry.graph_idx()];\n         graph\n@@ -1850,6 +1854,11 @@ pub mod tests {\n             AssetIdent::from_path(self.path.clone())\n         }\n \n+        #[turbo_tasks::function]\n+        fn source(&self) -> Vc<crate::source::OptionSource> {\n+            Vc::cell(None)\n+        }\n+\n         #[turbo_tasks::function]\n         async fn references(&self) -> Result<Vc<ModuleReferences>> {\n             let repo = self.repo.await?;"
        },
        {
            "sha": "ba1096f4c596878be97b2f4a6a119d8880426bed",
            "filename": "turbopack/crates/turbopack-core/src/node_addon_module.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fnode_addon_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fnode_addon_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fnode_addon_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -14,7 +14,7 @@ use crate::{\n     raw_module::RawModule,\n     reference::{ModuleReferences, TracedModuleReference},\n     resolve::pattern::{Pattern, PatternMatch, read_matches},\n-    source::Source,\n+    source::{OptionSource, Source},\n };\n \n /// A module corresponding to `.node` files.\n@@ -38,6 +38,11 @@ impl Module for NodeAddonModule {\n         self.source.ident().with_modifier(rcstr!(\"node addon\"))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(&self) -> Result<Vc<ModuleReferences>> {\n         static SHARP_BINARY_REGEX: LazyLock<Regex> ="
        },
        {
            "sha": "dc6fd947b4e9637aa28c71dc36581c3e2177f31d",
            "filename": "turbopack/crates/turbopack-core/src/raw_module.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fraw_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fraw_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fraw_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -4,7 +4,7 @@ use crate::{\n     asset::{Asset, AssetContent},\n     ident::AssetIdent,\n     module::Module,\n-    source::Source,\n+    source::{OptionSource, Source},\n };\n \n /// A module where source code doesn't need to be parsed but can be usd as is.\n@@ -20,6 +20,11 @@ impl Module for RawModule {\n     fn ident(&self) -> Vc<AssetIdent> {\n         self.source.ident()\n     }\n+\n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n }\n \n #[turbo_tasks::value_impl]"
        },
        {
            "sha": "a13d89aa7b36c1fff77f9600a5bc0bb73b41156d",
            "filename": "turbopack/crates/turbopack-css/src/asset.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fasset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fasset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fasset.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -14,7 +14,7 @@ use turbopack_core::{\n     reference::{ModuleReference, ModuleReferences},\n     reference_type::ImportContext,\n     resolve::origin::ResolveOrigin,\n-    source::Source,\n+    source::{OptionSource, Source},\n     source_map::GenerateSourceMap,\n };\n \n@@ -137,6 +137,11 @@ impl Module for CssModuleAsset {\n         Ok(ident)\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         let result = self.parse_css().await?;"
        },
        {
            "sha": "1918f45763120fe724731f554aefc00b3bf7b18c",
            "filename": "turbopack/crates/turbopack-css/src/module_asset.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 4,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fmodule_asset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fmodule_asset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-css%2Fsrc%2Fmodule_asset.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -1,6 +1,6 @@\n use std::{fmt::Write, sync::Arc};\n \n-use anyhow::{Context, Result, bail};\n+use anyhow::{Context, Result};\n use indoc::formatdoc;\n use lightningcss::css_modules::CssModuleReference;\n use swc_core::common::{BytePos, FileName, LineCol, SourceMap};\n@@ -22,7 +22,7 @@ use turbopack_core::{\n     reference::{ModuleReference, ModuleReferences},\n     reference_type::{CssReferenceSubType, ReferenceType},\n     resolve::{origin::ResolveOrigin, parse::Request},\n-    source::Source,\n+    source::{OptionSource, Source},\n };\n use turbopack_ecmascript::{\n     chunk::{\n@@ -72,6 +72,11 @@ impl Module for ModuleCssAsset {\n             .with_layer(self.asset_context.into_trait_ref().await?.layer()))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         // The inner reference must come last so it is loaded as the last in the\n@@ -111,8 +116,8 @@ impl Module for ModuleCssAsset {\n #[turbo_tasks::value_impl]\n impl Asset for ModuleCssAsset {\n     #[turbo_tasks::function]\n-    fn content(&self) -> Result<Vc<AssetContent>> {\n-        bail!(\"CSS module asset has no contents\")\n+    fn content(&self) -> Vc<AssetContent> {\n+        self.source.content()\n     }\n }\n "
        },
        {
            "sha": "d32a0551a236f973b0c7576ef1bcb86462364cda",
            "filename": "turbopack/crates/turbopack-ecmascript/src/async_chunk/module.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fasync_chunk%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fasync_chunk%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fasync_chunk%2Fmodule.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -50,6 +50,11 @@ impl Module for AsyncLoaderModule {\n         Self::asset_ident_for(*self.inner)\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         Ok(Vc::cell(vec![ResolvedVc::upcast("
        },
        {
            "sha": "106f45fc3c56d321695f251ed98f2aa9f04002d1",
            "filename": "turbopack/crates/turbopack-ecmascript/src/inlined_bytes_module.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Finlined_bytes_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Finlined_bytes_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Finlined_bytes_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -45,6 +45,11 @@ impl Module for InlinedBytesJsModule {\n             .with_modifier(rcstr!(\"static bytes in ecmascript\"))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     fn is_marked_as_side_effect_free(\n         self: Vc<Self>,"
        },
        {
            "sha": "0d3e5c79f42777473ff4d411725baaa7e7e7947d",
            "filename": "turbopack/crates/turbopack-ecmascript/src/lib.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Flib.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -737,6 +737,11 @@ impl Module for EcmascriptModuleAsset {\n         Ok(AssetIdent::new(ident))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         Ok(self.analyze().references())"
        },
        {
            "sha": "06f3276366ca254db7fff7ee37fa0a7fc5320368",
            "filename": "turbopack/crates/turbopack-ecmascript/src/manifest/chunk_asset.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fmanifest%2Fchunk_asset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fmanifest%2Fchunk_asset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fmanifest%2Fchunk_asset.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -125,6 +125,11 @@ impl Module for ManifestAsyncModule {\n             .with_modifier(manifest_chunk_reference_description())\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         let assets = self.chunk_group().expand_all_assets().await?;"
        },
        {
            "sha": "31b8729b9342111b80eff6ceb212c3ce195f0dcb",
            "filename": "turbopack/crates/turbopack-ecmascript/src/merged_module.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fmerged_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fmerged_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fmerged_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -77,6 +77,11 @@ impl Module for MergedEcmascriptModule {\n         self.entry_points.first().unwrap().ident()\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         panic!(\"references() should not be called\");"
        },
        {
            "sha": "72b2199fe7c1161592becef1dcabff10d3204eb7",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/external_module.rs",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fexternal_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fexternal_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fexternal_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -225,6 +225,11 @@ impl Module for CachedExternalModule {\n             .with_modifier(self.external_type.to_string().into()))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(&self) -> Result<Vc<ModuleReferences>> {\n         Ok(match &self.analyze_mode {\n@@ -455,6 +460,11 @@ impl Module for ModuleWithoutSelfAsync {\n         self.module.ident()\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     fn references(&self) -> Vc<ModuleReferences> {\n         self.module.references()"
        },
        {
            "sha": "3295e45cc49b3851f8f7a50d8b964d2c664c7c6c",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/require_context.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Frequire_context.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -409,6 +409,11 @@ impl Module for RequireContextAsset {\n             .with_modifier(modifier(&self.dir, self.include_subdirs))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(&self) -> Result<Vc<ModuleReferences>> {\n         let map = &*self.map.await?;"
        },
        {
            "sha": "7fa5eb6b9a587ca54eb6cdd42d62f71cfc6de6fd",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/facade/module.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Ffacade%2Fmodule.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -152,6 +152,11 @@ impl Module for EcmascriptModuleFacadeModule {\n         self.module.ident().with_part(self.part.clone())\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         let (part_references, esm_references) = self.await?.specific_references().await?;"
        },
        {
            "sha": "6f687d24f95182289fbce277363efb778f1022de",
            "filename": "turbopack/crates/turbopack-ecmascript/src/side_effect_optimization/locals/module.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Flocals%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Flocals%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fside_effect_optimization%2Flocals%2Fmodule.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -50,6 +50,11 @@ impl Module for EcmascriptModuleLocalsModule {\n         self.module.ident().with_part(ModulePart::locals())\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     fn references(&self) -> Result<Vc<ModuleReferences>> {\n         let result = self.module.analyze();"
        },
        {
            "sha": "b0ad370ff2ea06ef900d13195ad1675b3ade4247",
            "filename": "turbopack/crates/turbopack-ecmascript/src/tree_shake/asset.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fasset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fasset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fasset.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -310,6 +310,11 @@ impl Module for EcmascriptModulePartAsset {\n         self.full_module.ident().with_part(self.part.clone())\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     fn is_self_async(self: Vc<Self>) -> Vc<bool> {\n         self.is_async_module()"
        },
        {
            "sha": "5c6b2d9a9be6f9d60afc1c1e3841d2867bd23fa2",
            "filename": "turbopack/crates/turbopack-ecmascript/src/tree_shake/side_effect_module.rs",
            "status": "modified",
            "additions": 14,
            "deletions": 2,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fside_effect_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fside_effect_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftree_shake%2Fside_effect_module.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -1,7 +1,7 @@\n use anyhow::Result;\n use turbo_rcstr::{RcStr, rcstr};\n use turbo_tasks::{ResolvedVc, TryJoinIterExt, Vc};\n-use turbo_tasks_fs::glob::Glob;\n+use turbo_tasks_fs::{FileContent, glob::Glob};\n use turbopack_core::{\n     asset::{Asset, AssetContent},\n     chunk::{ChunkableModule, ChunkingContext, EvaluatableAsset},\n@@ -73,6 +73,11 @@ impl Module for SideEffectsModule {\n         Ok(AssetIdent::new(ident))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(&self) -> Result<Vc<ModuleReferences>> {\n         let mut references = vec![];\n@@ -118,7 +123,14 @@ impl Module for SideEffectsModule {\n impl Asset for SideEffectsModule {\n     #[turbo_tasks::function]\n     fn content(&self) -> Vc<AssetContent> {\n-        unreachable!(\"SideEffectsModule has no content\")\n+        AssetContent::File(\n+            FileContent::Content(\n+                \"// This is a proxy module for reexportings a module with additional side effects.\"\n+                    .into(),\n+            )\n+            .resolved_cell(),\n+        )\n+        .cell()\n     }\n }\n "
        },
        {
            "sha": "8e6314f96afd2a7ed70c4bec83e7460676ff34cb",
            "filename": "turbopack/crates/turbopack-ecmascript/src/typescript/mod.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftypescript%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftypescript%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Ftypescript%2Fmod.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -48,6 +48,11 @@ impl Module for TsConfigModuleAsset {\n         self.source.ident()\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(&self) -> Result<Vc<ModuleReferences>> {\n         let mut references = Vec::new();"
        },
        {
            "sha": "54a85f9de99a21796d64b5da8b363196df0f10a8",
            "filename": "turbopack/crates/turbopack-ecmascript/src/webpack/mod.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fwebpack%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fwebpack%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fwebpack%2Fmod.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -55,6 +55,11 @@ impl Module for WebpackModuleAsset {\n         self.source.ident().with_modifier(rcstr!(\"webpack\"))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     fn references(&self) -> Vc<ModuleReferences> {\n         module_references(*self.source, *self.runtime, *self.transforms)"
        },
        {
            "sha": "09dfb6110c9d73b7328a59fdd9154c28d4e394ec",
            "filename": "turbopack/crates/turbopack-ecmascript/src/worker_chunk/module.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fworker_chunk%2Fmodule.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fworker_chunk%2Fmodule.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Fworker_chunk%2Fmodule.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -44,6 +44,11 @@ impl Module for WorkerLoaderModule {\n         Self::asset_ident_for(*self.inner)\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(None)\n+    }\n+\n     #[turbo_tasks::function]\n     async fn references(self: Vc<Self>) -> Result<Vc<ModuleReferences>> {\n         Ok(Vc::cell(vec![ResolvedVc::upcast("
        },
        {
            "sha": "e77a9f7bbe3bc77e66b2f541048c294166495e23",
            "filename": "turbopack/crates/turbopack-json/src/lib.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-json%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-json%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-json%2Fsrc%2Flib.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -53,6 +53,11 @@ impl Module for JsonModuleAsset {\n         self.source.ident().with_modifier(rcstr!(\"json\"))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     fn is_marked_as_side_effect_free(\n         self: Vc<Self>,"
        },
        {
            "sha": "975318dc6cd2807f1166b0784ed12fbf30131c35",
            "filename": "turbopack/crates/turbopack-static/src/css.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-static%2Fsrc%2Fcss.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-static%2Fsrc%2Fcss.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-static%2Fsrc%2Fcss.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -47,6 +47,11 @@ impl Module for StaticUrlCssModule {\n         ident\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     fn is_marked_as_side_effect_free(\n         self: Vc<Self>,"
        },
        {
            "sha": "5898740e7b410120b846eb4e9866b313f13c4a20",
            "filename": "turbopack/crates/turbopack-static/src/ecma.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-static%2Fsrc%2Fecma.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-static%2Fsrc%2Fecma.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-static%2Fsrc%2Fecma.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -59,6 +59,11 @@ impl Module for StaticUrlJsModule {\n         ident\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<turbopack_core::source::OptionSource> {\n+        Vc::cell(Some(self.source))\n+    }\n+\n     #[turbo_tasks::function]\n     fn is_marked_as_side_effect_free(\n         self: Vc<Self>,"
        },
        {
            "sha": "3db28a19882fb6ea45e478ceaf31715915694cde",
            "filename": "turbopack/crates/turbopack-wasm/src/module_asset.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Fmodule_asset.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Fmodule_asset.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Fmodule_asset.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -16,7 +16,7 @@ use turbopack_core::{\n     reference::{ModuleReferences, SingleChunkableModuleReference},\n     reference_type::ReferenceType,\n     resolve::{ExportUsage, origin::ResolveOrigin, parse::Request},\n-    source::Source,\n+    source::{OptionSource, Source},\n };\n use turbopack_ecmascript::{\n     chunk::{\n@@ -130,6 +130,11 @@ impl Module for WebAssemblyModuleAsset {\n             .with_layer(self.asset_context.into_trait_ref().await?.layer()))\n     }\n \n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(Some(ResolvedVc::upcast(self.source)))\n+    }\n+\n     #[turbo_tasks::function]\n     fn references(self: Vc<Self>) -> Vc<ModuleReferences> {\n         self.loader().references()"
        },
        {
            "sha": "03661228b60b6adf96b38c12381777e8c0ea2f54",
            "filename": "turbopack/crates/turbopack-wasm/src/raw.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Fraw.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/f7b7f3c14ffeff685a2ad4a6d5df292fab687979/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Fraw.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-wasm%2Fsrc%2Fraw.rs?ref=f7b7f3c14ffeff685a2ad4a6d5df292fab687979",
            "patch": "@@ -9,7 +9,7 @@ use turbopack_core::{\n     module::Module,\n     module_graph::ModuleGraph,\n     output::{OutputAsset, OutputAssetsReference, OutputAssetsWithReferenced},\n-    source::Source,\n+    source::{OptionSource, Source},\n };\n use turbopack_ecmascript::{\n     chunk::{\n@@ -59,6 +59,11 @@ impl Module for RawWebAssemblyModuleAsset {\n             .with_modifier(rcstr!(\"wasm raw\"))\n             .with_layer(self.asset_context.into_trait_ref().await?.layer()))\n     }\n+\n+    #[turbo_tasks::function]\n+    fn source(&self) -> Vc<OptionSource> {\n+        Vc::cell(Some(ResolvedVc::upcast(self.source)))\n+    }\n }\n \n #[turbo_tasks::value_impl]"
        }
    ],
    "stats": {
        "total": 669,
        "additions": 635,
        "deletions": 34
    }
}