{
    "author": "huozhi",
    "message": "[dev-overlay] disable copy button when clipboard is not available (#78101)",
    "sha": "12f0e86083ad2055150688e8bcec136a85d6ad01",
    "files": [
        {
            "sha": "e967b2fca8e253a35ab75713f973cb2e3e8b5739",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/copy-button/index.tsx",
            "status": "modified",
            "additions": 14,
            "deletions": 11,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/12f0e86083ad2055150688e8bcec136a85d6ad01/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fcopy-button%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/12f0e86083ad2055150688e8bcec136a85d6ad01/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fcopy-button%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fcopy-button%2Findex.tsx?ref=12f0e86083ad2055150688e8bcec136a85d6ad01",
            "patch": "@@ -48,7 +48,7 @@ function useCopyLegacy(content: string) {\n     if (!navigator.clipboard) {\n       dispatch({\n         type: 'error',\n-        error: new Error('Copy to clipboard is not supported in this browser'),\n+        error: 'Copy to clipboard is not supported in this browser',\n       })\n     } else {\n       dispatch({ type: 'copying' })\n@@ -94,9 +94,7 @@ function useCopyModern(content: string) {\n         if (!navigator.clipboard) {\n           return {\n             state: 'error',\n-            error: new Error(\n-              'Copy to clipboard is not supported in this browser'\n-            ),\n+            error: 'Copy to clipboard is not supported in this browser',\n           }\n         }\n         return navigator.clipboard.writeText(content).then(\n@@ -153,8 +151,9 @@ export function CopyButton({\n   const error = copyState.state === 'error' ? copyState.error : null\n   React.useEffect(() => {\n     if (error !== null) {\n-      // Additional console.error to get the stack.\n-      console.error(error)\n+      // Only log warning in terminal to avoid showing in the error overlay.\n+      // When it's errored, the copy button will be disabled.\n+      console.warn(error)\n     }\n   }, [error])\n   React.useEffect(() => {\n@@ -168,7 +167,7 @@ export function CopyButton({\n       }\n     }\n   }, [isPending, copyState.state, reset])\n-  const isDisabled = isPending || disabled\n+  const isDisabled = !navigator.clipboard || isPending || disabled || !!error\n   const label = copyState.state === 'success' ? successLabel : actionLabel\n \n   // Assign default icon\n@@ -255,14 +254,18 @@ export const COPY_BUTTON_STYLES = `\n       height: var(--size-16);\n     }\n   }\n-  .nextjs-data-copy-button--initial:hover {\n+  .nextjs-data-copy-button:disabled {\n+    background-color: var(--color-gray-100);\n+    cursor: not-allowed;\n+  }\n+  .nextjs-data-copy-button--initial:hover:not(:disabled) {\n     cursor: pointer;\n   }\n-  .nextjs-data-copy-button--error,\n-  .nextjs-data-copy-button--error:hover {\n+  .nextjs-data-copy-button--error:not(:disabled),\n+  .nextjs-data-copy-button--error:hover:not(:disabled) {\n     color: var(--color-ansi-red);\n   }\n-  .nextjs-data-copy-button--success {\n+  .nextjs-data-copy-button--success:not(:disabled) {\n     color: var(--color-ansi-green);\n   }\n `"
        },
        {
            "sha": "bed905c61e892d1a20728086b7abfc7fb3c13143",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/container/errors.tsx",
            "status": "modified",
            "additions": 0,
            "deletions": 11,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/12f0e86083ad2055150688e8bcec136a85d6ad01/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/12f0e86083ad2055150688e8bcec136a85d6ad01/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcontainer%2Ferrors.tsx?ref=12f0e86083ad2055150688e8bcec136a85d6ad01",
            "patch": "@@ -250,17 +250,6 @@ export const styles = `\n   .nextjs-toast-hide-button:hover {\n     opacity: 1;\n   }\n-  .nextjs__container_errors_inspect_copy_button {\n-    cursor: pointer;\n-    background: none;\n-    border: none;\n-    color: var(--color-ansi-bright-white);\n-    font-size: var(--size-24);\n-    padding: 0;\n-    margin: 0;\n-    margin-left: 8px;\n-    transition: opacity 0.25s ease;\n-  }\n   .nextjs__container_errors__error_title {\n     display: flex;\n     align-items: center;"
        }
    ],
    "stats": {
        "total": 36,
        "additions": 14,
        "deletions": 22
    }
}