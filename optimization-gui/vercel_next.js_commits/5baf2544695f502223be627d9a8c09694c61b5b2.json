{
    "author": "ijjk",
    "message": "Add config for only generating static env (#77038)\n\nThis adds a config for more granular handling for\n`--experimental-build-mode=generate` to allow only inlining the env\nvariables since this was moved to the generate step and you might need\nthese inlined without also running prerendering e.g. when using the\nexperimental test mode server.",
    "sha": "5baf2544695f502223be627d9a8c09694c61b5b2",
    "files": [
        {
            "sha": "16e06e36e9113f2c3466e46c39fda938e987e015",
            "filename": "packages/next/src/build/index.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/5baf2544695f502223be627d9a8c09694c61b5b2/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/5baf2544695f502223be627d9a8c09694c61b5b2/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Findex.ts?ref=5baf2544695f502223be627d9a8c09694c61b5b2",
            "patch": "@@ -2509,6 +2509,17 @@ export default async function build(\n               buildId,\n             })\n           })\n+\n+        // users might only want to inline env during experimental generate\n+        // instead of also prerendering e.g. for testmode so exit after\n+        if (config.experimental.generateOnlyEnv) {\n+          Log.info(\n+            'Only inlining static env due to experimental.generateOnlyEnv'\n+          )\n+        }\n+        await flushAllTraces()\n+        teardownTraceSubscriber()\n+        process.exit(0)\n       }\n \n       const middlewareManifest: MiddlewareManifest = await readManifest("
        },
        {
            "sha": "4f7eb222568e1e9212d88093f6f06871d862a739",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/5baf2544695f502223be627d9a8c09694c61b5b2/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/5baf2544695f502223be627d9a8c09694c61b5b2/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=5baf2544695f502223be627d9a8c09694c61b5b2",
            "patch": "@@ -261,6 +261,7 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n     excludeDefaultMomentLocales: z.boolean().optional(),\n     experimental: z\n       .strictObject({\n+        generateOnlyEnv: z.boolean().optional(),\n         allowedDevOrigins: z.array(z.string()).optional(),\n         nodeMiddleware: z.boolean().optional(),\n         after: z.boolean().optional(),"
        },
        {
            "sha": "b8d5c533168b2775dcd603b4580d8d32cb830b5d",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/5baf2544695f502223be627d9a8c09694c61b5b2/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/5baf2544695f502223be627d9a8c09694c61b5b2/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=5baf2544695f502223be627d9a8c09694c61b5b2",
            "patch": "@@ -257,6 +257,7 @@ export interface LoggingConfig {\n }\n \n export interface ExperimentalConfig {\n+  generateOnlyEnv?: boolean\n   allowedDevOrigins?: string[]\n   nodeMiddleware?: boolean\n   cacheHandlers?: {\n@@ -1135,6 +1136,7 @@ export const defaultConfig: NextConfig = {\n   modularizeImports: undefined,\n   outputFileTracingRoot: process.env.NEXT_PRIVATE_OUTPUT_TRACE_ROOT || '',\n   experimental: {\n+    generateOnlyEnv: false,\n     allowedDevOrigins: [],\n     nodeMiddleware: false,\n     cacheLife: {"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 14,
        "deletions": 0
    }
}