{
    "author": "styfle",
    "message": "BREAKING CHANGE!: bump default `images.minimumCacheTTL` from 1 min to 4 hours (#84105)\n\nWe have found many Next.js users are confused why images keep\nrevalidating so frequently (increasing cpu and cost).\n\nThe reason is usually that their upstream source images are missing the\n`cache-control` header and thus fallback to the 60 second revalidation\ndefault. This its not a great default since most images don't change\nfrequently.\n\nThis PR is a breaking change to bump the `images.minimumCacheTTL` config\nfrom 60 (1 min) to 14400 (4 hours).\n\nWhy 4 hours? Because its long enough to take advantage of the durable\ncache, but short enough that changing or deleting the upstream src image\nwill take effect on the same day.\n\nFor advanced use cases where images are changing frequently, developers\ncan change this behavior back by reducing `images.minimumCacheTTL` to a\nlower value.",
    "sha": "0f14e5333f099222f370e6b00e9534ad33f8b022",
    "files": [
        {
            "sha": "9836ac6100417544e02e7b1f62f36565121960a7",
            "filename": "docs/01-app/03-api-reference/02-components/image.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/docs%2F01-app%2F03-api-reference%2F02-components%2Fimage.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/docs%2F01-app%2F03-api-reference%2F02-components%2Fimage.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F02-components%2Fimage.mdx?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -765,7 +765,7 @@ If no configuration is provided, the default below is used.\n ```js filename=\"next.config.js\"\n module.exports = {\n   images: {\n-    minimumCacheTTL: 60, // 1 minute\n+    minimumCacheTTL: 14400, // 4 hours\n   },\n }\n ```"
        },
        {
            "sha": "e32802268e1270a67ea5ee4b8aba033804e79b76",
            "filename": "docs/02-pages/04-api-reference/01-components/image-legacy.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/docs%2F02-pages%2F04-api-reference%2F01-components%2Fimage-legacy.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/docs%2F02-pages%2F04-api-reference%2F01-components%2Fimage-legacy.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F02-pages%2F04-api-reference%2F01-components%2Fimage-legacy.mdx?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -561,7 +561,7 @@ If no configuration is provided, the default below is used.\n ```js filename=\"next.config.js\"\n module.exports = {\n   images: {\n-    minimumCacheTTL: 60, // 1 minute\n+    minimumCacheTTL: 14400, // 4 hours\n   },\n }\n ```"
        },
        {
            "sha": "f54852d003b855c3e33e1ebe53a2575e0ad352f8",
            "filename": "errors/invalid-images-config.mdx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/errors%2Finvalid-images-config.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/errors%2Finvalid-images-config.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Finvalid-images-config.mdx?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -28,7 +28,7 @@ module.exports = {\n     // disable static imports for image files\n     disableStaticImages: false,\n     // minimumCacheTTL is in seconds, must be integer 0 or more\n-    minimumCacheTTL: 60,\n+    minimumCacheTTL: 14400, // 4 hours\n     // ordered list of acceptable optimized image formats (mime types)\n     formats: ['image/webp'],\n     // enable dangerous use of SVG images"
        },
        {
            "sha": "6d4c098ec67ec3e4aead1712a924fc0508f47e7a",
            "filename": "packages/next/src/server/image-optimizer.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/packages%2Fnext%2Fsrc%2Fserver%2Fimage-optimizer.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/packages%2Fnext%2Fsrc%2Fserver%2Fimage-optimizer.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fimage-optimizer.ts?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -323,7 +323,7 @@ export class ImageOptimizerCache {\n       deviceSizes = [],\n       imageSizes = [],\n       domains = [],\n-      minimumCacheTTL = 60,\n+      minimumCacheTTL = 14400,\n       formats = ['image/webp'],\n     } = imageData\n     const remotePatterns = nextConfig.images?.remotePatterns || []"
        },
        {
            "sha": "177f35decdc9ac7587d567bfd74de611857a2dc1",
            "filename": "packages/next/src/shared/lib/image-config.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fimage-config.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fimage-config.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fshared%2Flib%2Fimage-config.ts?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -135,7 +135,7 @@ export const imageConfigDefault: ImageConfigComplete = {\n   loaderFile: '',\n   domains: [],\n   disableStaticImages: false,\n-  minimumCacheTTL: 60,\n+  minimumCacheTTL: 14400, // 4 hours\n   formats: ['image/webp'],\n   dangerouslyAllowSVG: false,\n   contentSecurityPolicy: `script-src 'none'; frame-src 'none'; sandbox;`,"
        },
        {
            "sha": "266218f60b4e25c61bae4a372af3f49fdc6e4f44",
            "filename": "test/integration/image-optimizer/test/index.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fimage-optimizer%2Ftest%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fimage-optimizer%2Ftest%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fimage-optimizer%2Ftest%2Findex.test.ts?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -709,7 +709,7 @@ describe('Image Optimizer', () => {\n               headers: [\n                 {\n                   key: 'Cache-Control',\n-                  value: 'public, max-age=86400, must-revalidate',\n+                  value: 'public, max-age=14400, must-revalidate',\n                 },\n               ],\n             },\n@@ -733,7 +733,7 @@ describe('Image Optimizer', () => {\n           const res = await fetchViaHTTP(appPort, '/_next/image', query, opts)\n           expect(res.status).toBe(200)\n           expect(res.headers.get('Cache-Control')).toBe(\n-            `public, max-age=86400, must-revalidate`\n+            `public, max-age=14400, must-revalidate`\n           )\n           expect(res.headers.get('Content-Disposition')).toBe(\n             `attachment; filename=\"test.webp\"`\n@@ -743,7 +743,7 @@ describe('Image Optimizer', () => {\n             const files = await fsToJson(imagesDir)\n \n             let found = false\n-            const maxAge = '86400'\n+            const maxAge = '14400'\n \n             Object.keys(files).forEach((dir) => {\n               if (\n@@ -764,7 +764,7 @@ describe('Image Optimizer', () => {\n           const res = await fetchViaHTTP(appPort, '/_next/image', query, opts)\n           expect(res.status).toBe(200)\n           expect(res.headers.get('Cache-Control')).toBe(\n-            `public, max-age=60, must-revalidate`\n+            `public, max-age=14400, must-revalidate`\n           )\n           expect(res.headers.get('Content-Disposition')).toBe(\n             `attachment; filename=\"test.webp\"`"
        },
        {
            "sha": "5cb09689c3c02ca7afdea2326ee663e1d118b7b6",
            "filename": "test/integration/image-optimizer/test/util.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fimage-optimizer%2Ftest%2Futil.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fimage-optimizer%2Ftest%2Futil.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fimage-optimizer%2Ftest%2Futil.ts?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -161,7 +161,7 @@ export function runTests(ctx: RunTestsCtx) {\n     contentDispositionType = 'attachment',\n     domains = [],\n     formats = [],\n-    minimumCacheTTL = 60,\n+    minimumCacheTTL = 14400,\n   } = nextConfigImages || {}\n   const avifEnabled = formats[0] === 'image/avif'\n   let slowImageServer: Awaited<ReturnType<typeof serveSlowImage>>"
        },
        {
            "sha": "aa713be30cdabb0198646224da13bfa386add93e",
            "filename": "test/integration/next-image-new/app-dir-localpatterns/test/index.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Fapp-dir-localpatterns%2Ftest%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Fapp-dir-localpatterns%2Ftest%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fnext-image-new%2Fapp-dir-localpatterns%2Ftest%2Findex.test.ts?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -96,7 +96,7 @@ function runTests(mode: 'dev' | 'server') {\n               search: '',\n             },\n           ],\n-          minimumCacheTTL: 60,\n+          minimumCacheTTL: 14400,\n           path: '/_next/image',\n           qualities: [75],\n           sizes: ["
        },
        {
            "sha": "161771a1fe1ba413e66c4cd286668f05e2d7d3cc",
            "filename": "test/integration/next-image-new/app-dir-qualities/test/index.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Fapp-dir-qualities%2Ftest%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Fapp-dir-qualities%2Ftest%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fnext-image-new%2Fapp-dir-qualities%2Ftest%2Findex.test.ts?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -102,7 +102,7 @@ function runTests(mode: 'dev' | 'server') {\n           loaderFile: '',\n           remotePatterns: [],\n           localPatterns: undefined,\n-          minimumCacheTTL: 60,\n+          minimumCacheTTL: 14400,\n           path: '/_next/image',\n           qualities: [42, 69, 88],\n           sizes: ["
        },
        {
            "sha": "42d65e47345dfea956b9fad5a9fb28232e98e411",
            "filename": "test/integration/next-image-new/app-dir/test/index.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Fapp-dir%2Ftest%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Fapp-dir%2Ftest%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fnext-image-new%2Fapp-dir%2Ftest%2Findex.test.ts?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -1785,7 +1785,7 @@ function runTests(mode: 'dev' | 'server') {\n           loaderFile: '',\n           remotePatterns: [],\n           localPatterns: undefined,\n-          minimumCacheTTL: 60,\n+          minimumCacheTTL: 14400,\n           path: '/_next/image',\n           qualities: [75],\n           sizes: ["
        },
        {
            "sha": "29e722a3bea6216104332cc3c756a43e71676d2a",
            "filename": "test/integration/next-image-new/unicode/test/index.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Funicode%2Ftest%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Funicode%2Ftest%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fnext-image-new%2Funicode%2Ftest%2Findex.test.ts?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -94,7 +94,7 @@ function runTests(mode: 'server' | 'dev') {\n               search: '',\n             },\n           ],\n-          minimumCacheTTL: 60,\n+          minimumCacheTTL: 14400,\n           path: '/_next/image',\n           qualities: [75],\n           sizes: ["
        },
        {
            "sha": "6aa7049a9cf4d5d6d1f8df634ebd2ba9aeb892c8",
            "filename": "test/integration/next-image-new/unoptimized/test/index.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Funoptimized%2Ftest%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0f14e5333f099222f370e6b00e9534ad33f8b022/test%2Fintegration%2Fnext-image-new%2Funoptimized%2Ftest%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fnext-image-new%2Funoptimized%2Ftest%2Findex.test.ts?ref=0f14e5333f099222f370e6b00e9534ad33f8b022",
            "patch": "@@ -110,7 +110,7 @@ function runTests(url: string, mode: 'dev' | 'server') {\n           loaderFile: '',\n           remotePatterns: [],\n           localPatterns: undefined,\n-          minimumCacheTTL: 60,\n+          minimumCacheTTL: 14400,\n           path: '/_next/image',\n           qualities: [75],\n           sizes: ["
        }
    ],
    "stats": {
        "total": 30,
        "additions": 15,
        "deletions": 15
    }
}