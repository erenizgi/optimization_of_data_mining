{
    "author": "huozhi",
    "message": "[segment explorer] trigger the actual same level boundary (#81268)\n\nWhen you click trigger boundary is not triggering the upper layer boundary but the defined boundaries in the current layer.\r\n\r\nhttps://github.com/user-attachments/assets/6c24caa5-36fc-46db-9e0f-f8753391c541",
    "sha": "8c15302158a9fe219c0d81b373a774d243c9fc7e",
    "files": [
        {
            "sha": "104a18f8ffb57da4c49c87affc57d58d9617a3cf",
            "filename": "packages/next/src/client/components/layout-router.tsx",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/8c15302158a9fe219c0d81b373a774d243c9fc7e/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Flayout-router.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/8c15302158a9fe219c0d81b373a774d243c9fc7e/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Flayout-router.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Flayout-router.tsx?ref=8c15302158a9fe219c0d81b373a774d243c9fc7e",
            "patch": "@@ -615,6 +615,21 @@ export default function OuterLayoutRouter({\n       ? RenderChildren\n       : ErrorBoundary\n \n+    let segmentBoundaryTriggerNode: React.ReactNode = null\n+    if (\n+      process.env.NODE_ENV !== 'production' &&\n+      process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER\n+    ) {\n+      const { SegmentBoundaryTriggerNode } =\n+        require('../../next-devtools/userspace/app/segment-explorer-node') as typeof import('../../next-devtools/userspace/app/segment-explorer-node')\n+\n+      segmentBoundaryTriggerNode = (\n+        <>\n+          <SegmentBoundaryTriggerNode />\n+        </>\n+      )\n+    }\n+\n     // TODO: The loading module data for a segment is stored on the parent, then\n     // applied to each of that parent segment's parallel route slots. In the\n     // simple case where there's only one parallel route (the `children` slot),\n@@ -647,6 +662,7 @@ export default function OuterLayoutRouter({\n                       cacheNode={cacheNode}\n                       segmentPath={segmentPath}\n                     />\n+                    {segmentBoundaryTriggerNode}\n                   </RedirectBoundary>\n                 </HTTPAccessFallbackBoundary>\n               </LoadingBoundary>"
        },
        {
            "sha": "d6056f5b1fdc47cd49fd2dc5199a0161b32aea1f",
            "filename": "packages/next/src/next-devtools/userspace/app/segment-explorer-node.tsx",
            "status": "modified",
            "additions": 14,
            "deletions": 14,
            "changes": 28,
            "blob_url": "https://github.com/vercel/next.js/blob/8c15302158a9fe219c0d81b373a774d243c9fc7e/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fuserspace%2Fapp%2Fsegment-explorer-node.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/8c15302158a9fe219c0d81b373a774d243c9fc7e/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fuserspace%2Fapp%2Fsegment-explorer-node.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fuserspace%2Fapp%2Fsegment-explorer-node.tsx?ref=8c15302158a9fe219c0d81b373a774d243c9fc7e",
            "patch": "@@ -76,6 +76,19 @@ export function SegmentViewStateNode({ page }: { page: string }) {\n   return null\n }\n \n+export function SegmentBoundaryTriggerNode() {\n+  const { boundaryType } = useSegmentState()\n+  let segmentNode: React.ReactNode = null\n+  if (boundaryType === 'loading') {\n+    segmentNode = <LoadingSegmentNode />\n+  } else if (boundaryType === 'not-found') {\n+    segmentNode = <NotFoundSegmentNode />\n+  } else if (boundaryType === 'error') {\n+    segmentNode = <ErrorSegmentNode />\n+  }\n+  return segmentNode\n+}\n+\n export function SegmentViewNode({\n   type,\n   pagePath,\n@@ -85,22 +98,9 @@ export function SegmentViewNode({\n   pagePath: string\n   children?: ReactNode\n }): React.ReactNode {\n-  const { boundaryType } = useSegmentState()\n-\n-  const isChildBoundary = type !== 'layout' && type !== 'template'\n-\n-  let segmentNode = (\n+  const segmentNode = (\n     <SegmentTrieNode key={type} type={type} pagePath={pagePath} />\n   )\n-  if (boundaryType && boundaryType !== type && isChildBoundary) {\n-    if (boundaryType === 'loading') {\n-      segmentNode = <LoadingSegmentNode />\n-    } else if (boundaryType === 'not-found') {\n-      segmentNode = <NotFoundSegmentNode />\n-    } else if (boundaryType === 'error') {\n-      segmentNode = <ErrorSegmentNode />\n-    }\n-  }\n \n   return (\n     <>"
        }
    ],
    "stats": {
        "total": 44,
        "additions": 30,
        "deletions": 14
    }
}