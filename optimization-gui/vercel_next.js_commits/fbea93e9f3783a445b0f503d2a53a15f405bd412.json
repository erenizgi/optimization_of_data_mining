{
    "author": "eps1lon",
    "message": "Add internal environment variable for enabling React Compiler (#84176)\n\nWe'll use this in CI to enable it on certain shards or just temporarily.\r\nAlso allows quickly testing the Compiler in our tests.\r\nIt's not just about enabling the config flag but also declaring the dependency so an easy way to switch makes sense.",
    "sha": "fbea93e9f3783a445b0f503d2a53a15f405bd412",
    "files": [
        {
            "sha": "39340753f130916c7f214ab5621dcbd79b1b3db4",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/fbea93e9f3783a445b0f503d2a53a15f405bd412/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/fbea93e9f3783a445b0f503d2a53a15f405bd412/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=fbea93e9f3783a445b0f503d2a53a15f405bd412",
            "patch": "@@ -1805,6 +1805,24 @@ function enforceExperimentalFeatures(\n     }\n   }\n \n+  if (\n+    process.env.__NEXT_ENABLE_REACT_COMPILER === 'true' &&\n+    // We do respect an explicit value in the user config.\n+    (config.experimental.reactCompiler === undefined ||\n+      (isDefaultConfig && !config.experimental.reactCompiler))\n+  ) {\n+    config.experimental.reactCompiler = true\n+\n+    if (configuredExperimentalFeatures) {\n+      addConfiguredExperimentalFeature(\n+        configuredExperimentalFeatures,\n+        'reactCompiler',\n+        true,\n+        'enabled by `__NEXT_ENABLE_REACT_COMPILER`'\n+      )\n+    }\n+  }\n+\n   if (\n     config.experimental.enablePrerenderSourceMaps === undefined &&\n     config.experimental.cacheComponents === true"
        },
        {
            "sha": "900f767a1c180d75aebbe6af294c2307971b0d6a",
            "filename": "test/lib/next-modes/base.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/fbea93e9f3783a445b0f503d2a53a15f405bd412/test%2Flib%2Fnext-modes%2Fbase.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/fbea93e9f3783a445b0f503d2a53a15f405bd412/test%2Flib%2Fnext-modes%2Fbase.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Flib%2Fnext-modes%2Fbase.ts?ref=fbea93e9f3783a445b0f503d2a53a15f405bd412",
            "patch": "@@ -225,6 +225,14 @@ export class NextInstance {\n           ...this.packageJson?.dependencies,\n         }\n \n+        if (\n+          process.env.__NEXT_ENABLE_REACT_COMPILER === 'true' &&\n+          !finalDependencies['babel-plugin-react-compiler']\n+        ) {\n+          finalDependencies['babel-plugin-react-compiler'] =\n+            '0.0.0-experimental-3fde738-20250918'\n+        }\n+\n         if (skipInstall || skipIsolatedNext) {\n           const pkgScripts = (this.packageJson['scripts'] as {}) || {}\n           await fs.mkdir(this.testDir, { recursive: true })"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 26,
        "deletions": 0
    }
}