{
    "author": "shuakami",
    "message": "fix: use ESM import instead of triple-slash reference for routes.d.ts (#82867)\n\n## What?\n\nReplace `/// <reference path=\"./.next/types/routes.d.ts\" />` with\n`import type {} from './.next/types/routes.d.ts'` in generated\n`next-env.d.ts` files.\n\n## Why?\n\nThe current implementation uses triple-slash reference directives which\ntrigger ESLint errors when using the\n`@typescript-eslint/triple-slash-reference` rule. This rule is commonly\nenabled in TypeScript projects to encourage modern ES module imports\nover legacy triple-slash references.\n\n## How?\n\n- Modified `writeAppTypeDeclarations.ts` to generate ESM import\nstatements instead of triple-slash references\n- Updated all create-next-app templates to use the new format\n- Updated corresponding unit tests to reflect the new expected output\n\nThe change maintains identical TypeScript functionality while improving\nESLint compatibility. The `import type {}` syntax ensures type-only\nimports that are properly elided during compilation.\n\n**Testing:**\n- Existing unit tests pass with updated expectations\n- Verified ESLint `@typescript-eslint/triple-slash-reference` rule no\nlonger triggers errors\n- TypeScript functionality remains unchanged\n\nFixes [#82828](https://github.com/vercel/next.js/issues/82828)\n\n---------\n\nCo-authored-by: vercel[bot] <35613825+vercel[bot]@users.noreply.github.com>\nCo-authored-by: Ben Gubler <nebrelbug@gmail.com>",
    "sha": "2b5c714b577031840b1ecec6ea59c4ab591a169b",
    "files": [
        {
            "sha": "89e040a1acb8a4c7b419313576c13b76d2aba3a7",
            "filename": "packages/create-next-app/templates/app-api/ts/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp-api%2Fts%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp-api%2Fts%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Fapp-api%2Fts%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/basic-features/typescript for more information."
        },
        {
            "sha": "9edff1c7cacb3bfac9a1eadcf6f51eaa99565e38",
            "filename": "packages/create-next-app/templates/app-empty/ts/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp-empty%2Fts%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp-empty%2Fts%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Fapp-empty%2Fts%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/app/api-reference/config/typescript for more information."
        },
        {
            "sha": "9edff1c7cacb3bfac9a1eadcf6f51eaa99565e38",
            "filename": "packages/create-next-app/templates/app-tw-empty/ts/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp-tw-empty%2Fts%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp-tw-empty%2Fts%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Fapp-tw-empty%2Fts%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/app/api-reference/config/typescript for more information."
        },
        {
            "sha": "9edff1c7cacb3bfac9a1eadcf6f51eaa99565e38",
            "filename": "packages/create-next-app/templates/app-tw/ts/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp-tw%2Fts%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp-tw%2Fts%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Fapp-tw%2Fts%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/app/api-reference/config/typescript for more information."
        },
        {
            "sha": "9edff1c7cacb3bfac9a1eadcf6f51eaa99565e38",
            "filename": "packages/create-next-app/templates/app/ts/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp%2Fts%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fapp%2Fts%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Fapp%2Fts%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/app/api-reference/config/typescript for more information."
        },
        {
            "sha": "19709046afd624ff9177b3d2c2c31708d50c4a2b",
            "filename": "packages/create-next-app/templates/default-empty/ts/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fdefault-empty%2Fts%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fdefault-empty%2Fts%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Fdefault-empty%2Fts%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/pages/api-reference/config/typescript for more information."
        },
        {
            "sha": "19709046afd624ff9177b3d2c2c31708d50c4a2b",
            "filename": "packages/create-next-app/templates/default-tw-empty/ts/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fdefault-tw-empty%2Fts%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fdefault-tw-empty%2Fts%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Fdefault-tw-empty%2Fts%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/pages/api-reference/config/typescript for more information."
        },
        {
            "sha": "19709046afd624ff9177b3d2c2c31708d50c4a2b",
            "filename": "packages/create-next-app/templates/default-tw/ts/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fdefault-tw%2Fts%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fdefault-tw%2Fts%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Fdefault-tw%2Fts%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/pages/api-reference/config/typescript for more information."
        },
        {
            "sha": "19709046afd624ff9177b3d2c2c31708d50c4a2b",
            "filename": "packages/create-next-app/templates/default/ts/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fdefault%2Fts%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fcreate-next-app%2Ftemplates%2Fdefault%2Fts%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fcreate-next-app%2Ftemplates%2Fdefault%2Fts%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/pages/api-reference/config/typescript for more information."
        },
        {
            "sha": "8cd338f167200b767facac56daabde2fa6c4df6a",
            "filename": "packages/next/src/lib/typescript/writeAppTypeDeclarations.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fnext%2Fsrc%2Flib%2Ftypescript%2FwriteAppTypeDeclarations.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/packages%2Fnext%2Fsrc%2Flib%2Ftypescript%2FwriteAppTypeDeclarations.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Ftypescript%2FwriteAppTypeDeclarations.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -62,7 +62,13 @@ export async function writeAppTypeDeclarations({\n     'types/routes.d.ts'\n   )\n \n-  directives.push(`/// <reference path=\"./${routeTypesPath}\" />`)\n+  // Ensure the path is POSIX-compliant for imports.\n+  const routeTypesPathPosix = routeTypesPath\n+    .split(path.sep)\n+    .join(path.posix.sep)\n+\n+  // Use ESM import instead of triple-slash reference for better ESLint compatibility\n+  directives.push(`import \"./${routeTypesPathPosix}\";`)\n \n   // Push the notice in.\n   directives.push("
        },
        {
            "sha": "19709046afd624ff9177b3d2c2c31708d50c4a2b",
            "filename": "test/integration/typescript-app-type-declarations/next-env.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/test%2Fintegration%2Ftypescript-app-type-declarations%2Fnext-env.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/test%2Fintegration%2Ftypescript-app-type-declarations%2Fnext-env.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Ftypescript-app-type-declarations%2Fnext-env.d.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -1,6 +1,6 @@\n /// <reference types=\"next\" />\n /// <reference types=\"next/image-types/global\" />\n-/// <reference path=\"./.next/types/routes.d.ts\" />\n+import \"./.next/types/routes.d.ts\";\n \n // NOTE: This file should not be edited\n // see https://nextjs.org/docs/pages/api-reference/config/typescript for more information."
        },
        {
            "sha": "b0344052c25a18515354023f370c78716e3ab700",
            "filename": "test/unit/write-app-declarations.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/2b5c714b577031840b1ecec6ea59c4ab591a169b/test%2Funit%2Fwrite-app-declarations.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2b5c714b577031840b1ecec6ea59c4ab591a169b/test%2Funit%2Fwrite-app-declarations.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Funit%2Fwrite-app-declarations.test.ts?ref=2b5c714b577031840b1ecec6ea59c4ab591a169b",
            "patch": "@@ -22,7 +22,7 @@ describe('find config', () => {\n       (imageImportsEnabled\n         ? '/// <reference types=\"next/image-types/global\" />' + eol\n         : '') +\n-      '/// <reference path=\"./.next/types/routes.d.ts\" />' +\n+      `import \"./.next/types/routes.d.ts\";` +\n       eol +\n       eol +\n       '// NOTE: This file should not be edited' +\n@@ -50,7 +50,7 @@ describe('find config', () => {\n       (imageImportsEnabled\n         ? '/// <reference types=\"next/image-types/global\" />' + eol\n         : '') +\n-      '/// <reference path=\"./.next/types/routes.d.ts\" />' +\n+      `import \"./.next/types/routes.d.ts\";` +\n       eol +\n       eol +\n       '// NOTE: This file should not be edited' +\n@@ -78,7 +78,7 @@ describe('find config', () => {\n       (imageImportsEnabled\n         ? '/// <reference types=\"next/image-types/global\" />' + eol\n         : '') +\n-      '/// <reference path=\"./.next/types/routes.d.ts\" />' +\n+      `import \"./.next/types/routes.d.ts\";` +\n       eol +\n       eol +\n       '// NOTE: This file should not be edited' +"
        }
    ],
    "stats": {
        "total": 34,
        "additions": 20,
        "deletions": 14
    }
}