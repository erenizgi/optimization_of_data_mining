{
    "author": "gnoff",
    "message": "[Cache Components] When caches are disabled in dev skip the cache warmup (#85014)\n\nIn Dev, to ensure the component metadata that powers React DevTools\naccurately reflects the cached, prerendered, or dynamic nature of Server\nComponents, Next.js ensures that any caches encountered during the\nprerender are warm before streaming.\n\nHowever when users have chrome devtools open with \"disable caches\" or\nwhen a hard refresh is performed requests are made with a cache header\nthat instructs Next.js to bypass all server caches. In these cases every\nrequest will always have empty caches and thus the entire request will\nblock on the time it takes to fill all caches. It isn't reccomended to\ntypically disable cache while developing with Next.js because it is even\nmore aggressive than the cold cache scenario real users would encounter\nwith a production deployment. But there are some reasons why it is\nlegitimate, for instance when you want to force any latent caches in\nmemory to by skipped. When this happens Next.js will now skip cache\nwarming to ensure the render is streamed quickly. We will also warn in\nthe console that the request did not have caches warmed up and Component\nMetadata in React DevTools won't accurately reflect which components are\ncacheable and prefetchable.\n\nIn the future we will also show this state in the Next.js devtools UI so\nit is clearer you are operating in this mode without having to read a\nwarning log in the console",
    "sha": "49fcbd93f2c579d79f2005dccf82a93686d6919a",
    "files": [
        {
            "sha": "98f9baac6421e2e7cfbd67e665a6fc30830a216f",
            "filename": "errors/cache-bypass-in-dev.mdx",
            "status": "added",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/vercel/next.js/blob/49fcbd93f2c579d79f2005dccf82a93686d6919a/errors%2Fcache-bypass-in-dev.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/49fcbd93f2c579d79f2005dccf82a93686d6919a/errors%2Fcache-bypass-in-dev.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Fcache-bypass-in-dev.mdx?ref=49fcbd93f2c579d79f2005dccf82a93686d6919a",
            "patch": "@@ -0,0 +1,30 @@\n+---\n+title: Caches Bypassed in Development Mode\n+---\n+\n+## Disabling Caches in Development Mode\n+\n+While running Next.js in development mode with `next dev` an initial page load or client navigation was handled with a `cache-control: no-store` header. The most common reason for this is that you have your web browser's DevTools open with \"Disable Cache\" enabled. Another common reason is you performed a hard refresh (Cmd + Shift + R / Ctrl + Shift + R).\n+\n+Disabling caches while in development mode affects the debugging experience of Cache Components. Read on to understand more about how Next.js handles caches in development mode and what changes when they are intentionally disabled.\n+\n+## Understanding Cache handling in Development Mode\n+\n+In development mode, Next.js ensures that Cache Components render in the right environment to allow for React DevTools to highlight which components are part of the available for prerendering statically before any user request, which are available when prefetching segments at runtime before a navigation occurs, and finally which are dynamic and will only be fetched on user navigation.\n+\n+This behavior has a small cost when a cold cache is encountered. Rather than streaming immediately Next.js will wait to fill this cache before streaming the response. As you navigate around you App in development mode these caches will fill and most navigations to cached content should feel instant once warm.\n+\n+However if you instruct Next.js to skip all server caches using something like the \"Disable Cache\" option in your browser's DevTools, this behavior would be detrimental since every cache will be considered cold on every request leading to blocking navigations. Instead Next.js prints a warning that this particular request is not suitable for debugging Cache Components and then renders fresh results as fast as possible.\n+\n+## Should you use \"Disable Cache\"?\n+\n+Chrome, in particular, defaults all network request to \"Disable Cache\" when DevTools is open. For Next.js this is not recommended because it is overly aggressive in what is not cached and can provide a false impression of page performance that doesn't represent realistic usage of a web app.\n+\n+However there are times when disabling a server caches can be useful. For instance if you know some upstream data system has updated but these updates are not connected to your local dev environment through features like `revalidateTag`.\n+\n+If you must turn on \"Disable Cache\" to force a refresh we recommend that you disable the option once you've achieved your goal.\n+\n+## Useful Links\n+\n+- [`revalidateTag` function](/docs/app/api-reference/functions/revalidateTag)\n+- [`\"use cache\"` directive](/docs/app/api-reference/directives/use-cache)"
        },
        {
            "sha": "e8249108fea2b749bd0d225cf9aabc33232be9be",
            "filename": "packages/next/src/server/app-render/app-render.tsx",
            "status": "modified",
            "additions": 69,
            "deletions": 12,
            "changes": 81,
            "blob_url": "https://github.com/vercel/next.js/blob/49fcbd93f2c579d79f2005dccf82a93686d6919a/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/49fcbd93f2c579d79f2005dccf82a93686d6919a/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx?ref=49fcbd93f2c579d79f2005dccf82a93686d6919a",
            "patch": "@@ -578,7 +578,7 @@ async function generateDynamicFlightRenderResult(\n ): Promise<RenderResult> {\n   const {\n     clientReferenceManifest,\n-    componentMod,\n+    componentMod: { renderToReadableStream, createElement },\n     htmlRequestId,\n     renderOpts,\n     requestId,\n@@ -606,13 +606,23 @@ async function generateDynamicFlightRenderResult(\n   const RSCPayload: RSCPayload & {\n     /** Only available during cacheComponents development builds. Used for logging errors. */\n     _validation?: Promise<ReactNode>\n+    _bypassCachesInDev?: React.ReactNode\n   } = await workUnitAsyncStorage.run(\n     requestStore,\n     generateDynamicRSCPayload,\n     ctx,\n     options\n   )\n \n+  if (\n+    process.env.NODE_ENV === 'development' &&\n+    isBypassingCachesInDev(renderOpts, requestStore)\n+  ) {\n+    RSCPayload._bypassCachesInDev = createElement(WarnForBypassCachesInDev, {\n+      route: workStore.route,\n+    })\n+  }\n+\n   const debugChannel = setReactDebugChannel && createDebugChannel()\n \n   if (debugChannel) {\n@@ -623,7 +633,7 @@ async function generateDynamicFlightRenderResult(\n   // which contains the subset React.\n   const flightReadableStream = workUnitAsyncStorage.run(\n     requestStore,\n-    componentMod.renderToReadableStream,\n+    renderToReadableStream,\n     RSCPayload,\n     clientReferenceManifest.clientModules,\n     {\n@@ -1864,10 +1874,15 @@ async function renderToHTMLOrFlightImpl(\n       if (isRuntimePrefetchRequest) {\n         return generateRuntimePrefetchResult(req, res, ctx, requestStore)\n       } else {\n+        const bypassCachesInDev = isBypassingCachesInDev(\n+          renderOpts,\n+          requestStore\n+        )\n         if (\n           process.env.NODE_ENV === 'development' &&\n           process.env.NEXT_RUNTIME !== 'edge' &&\n-          cacheComponents\n+          cacheComponents &&\n+          !bypassCachesInDev\n         ) {\n           return generateDynamicFlightRenderResultWithCachesInDev(\n             req,\n@@ -2174,14 +2189,24 @@ async function renderToStream(\n   devValidatingFallbackParams: OpaqueFallbackRouteParams | null\n ): Promise<ReadableStream<Uint8Array>> {\n   /* eslint-disable @next/internal/no-ambiguous-jsx -- React Client */\n-  const { assetPrefix, htmlRequestId, nonce, pagePath, renderOpts, requestId } =\n-    ctx\n+  const {\n+    assetPrefix,\n+    htmlRequestId,\n+    nonce,\n+    pagePath,\n+    renderOpts,\n+    requestId,\n+    workStore,\n+  } = ctx\n \n   const {\n     basePath,\n     buildManifest,\n     clientReferenceManifest,\n-    ComponentMod,\n+    ComponentMod: {\n+      createElement,\n+      renderToReadableStream: serverRenderToReadableStream,\n+    },\n     crossOrigin,\n     dev = false,\n     experimental,\n@@ -2286,17 +2311,20 @@ async function renderToStream(\n \n   try {\n     if (\n-      // We only want this behavior when running `next dev`\n-      dev &&\n       // We only want this behavior when we have React's dev builds available\n       process.env.NODE_ENV === 'development' &&\n+      // We only want this behavior when running `next dev`\n+      dev &&\n       // Edge routes never prerender so we don't have a Prerender environment for anything in edge runtime\n       process.env.NEXT_RUNTIME !== 'edge' &&\n       // We only have a Prerender environment for projects opted into cacheComponents\n       cacheComponents &&\n       // We only do this flow if we can safely recreate the store from scratch\n       // (which is not the case for renders after an action)\n-      createRequestStore\n+      createRequestStore &&\n+      // We only do this flow if we're not bypassing caches in dev using\n+      // \"disable cache\" in devtools or a hard refresh (cache-control: \"no-store\")\n+      !isBypassingCachesInDev(renderOpts, requestStore)\n     ) {\n       type RSCPayloadWithValidation = InitialRSCPayload & {\n         /** Only available during cacheComponents development builds. Used for logging errors. */\n@@ -2369,14 +2397,25 @@ async function renderToStream(\n       )\n     } else {\n       // This is a dynamic render. We don't do dynamic tracking because we're not prerendering\n-      const RSCPayload = await workUnitAsyncStorage.run(\n+      const RSCPayload: RSCPayload & {\n+        _bypassCachesInDev?: React.ReactNode\n+      } = await workUnitAsyncStorage.run(\n         requestStore,\n         getRSCPayload,\n         tree,\n         ctx,\n         res.statusCode === 404\n       )\n \n+      if (isBypassingCachesInDev(renderOpts, requestStore)) {\n+        // Mark the RSC payload to indicate that caches were bypassed in dev.\n+        // This lets the client know not to cache anything based on this render.\n+        RSCPayload._bypassCachesInDev = createElement(\n+          WarnForBypassCachesInDev,\n+          { route: workStore.route }\n+        )\n+      }\n+\n       const debugChannel = setReactDebugChannel && createDebugChannel()\n \n       if (debugChannel) {\n@@ -2395,7 +2434,7 @@ async function renderToStream(\n       reactServerResult = new ReactServerResult(\n         workUnitAsyncStorage.run(\n           requestStore,\n-          ComponentMod.renderToReadableStream,\n+          serverRenderToReadableStream,\n           RSCPayload,\n           clientReferenceManifest.clientModules,\n           {\n@@ -2624,7 +2663,7 @@ async function renderToStream(\n \n     const errorServerStream = workUnitAsyncStorage.run(\n       requestStore,\n-      ComponentMod.renderToReadableStream,\n+      serverRenderToReadableStream,\n       errorRSCPayload,\n       clientReferenceManifest.clientModules,\n       {\n@@ -5123,3 +5162,21 @@ async function collectSegmentData(\n     serverConsumerManifest\n   )\n }\n+\n+function isBypassingCachesInDev(\n+  renderOpts: RenderOpts,\n+  requestStore: RequestStore\n+): boolean {\n+  return (\n+    process.env.NODE_ENV === 'development' &&\n+    !!renderOpts.dev &&\n+    requestStore.headers.get('cache-control') === 'no-cache'\n+  )\n+}\n+\n+function WarnForBypassCachesInDev({ route }: { route: string }) {\n+  console.warn(\n+    `Route ${route} is rendering with server caches disabled. For this navigation, Component Metadata in React DevTools will not accurately reflect what is statically prerenderable and runtime prefetchable. See more info here: https://nextjs.org/docs/messages/cache-bypass-in-dev`\n+  )\n+  return null\n+}"
        },
        {
            "sha": "3f188521240aef9943da7c31a4655ff06a89f3f9",
            "filename": "test/e2e/app-dir/cache-components-errors/cache-components-dev-cache-bypass.test.ts",
            "status": "added",
            "additions": 117,
            "deletions": 0,
            "changes": 117,
            "blob_url": "https://github.com/vercel/next.js/blob/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-dev-cache-bypass.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-dev-cache-bypass.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-dev-cache-bypass.test.ts?ref=49fcbd93f2c579d79f2005dccf82a93686d6919a",
            "patch": "@@ -0,0 +1,117 @@\n+import { isNextDev, nextTestSetup } from 'e2e-utils'\n+\n+describe('Cache Components Errors', () => {\n+  const { next, skipped } = nextTestSetup({\n+    files: __dirname + '/fixtures/dev-cache-bypass',\n+  })\n+\n+  if (skipped) {\n+    return\n+  }\n+\n+  describe('Warning for Bypassing Caches in Dev', () => {\n+    if (isNextDev) {\n+      it('warns if you render with cache-control: no-cache in dev on initial page load', async () => {\n+        const from = next.cliOutput.length\n+\n+        await next.fetch('/', {\n+          headers: { 'cache-control': 'no-cache' },\n+        })\n+\n+        expect(stripGetLines(next.cliOutput.slice(from)))\n+          .toMatchInlineSnapshot(`\n+         \"Route / is rendering with server caches disabled. For this navigation, Component Metadata in React DevTools will not accurately reflect what is statically prerenderable and runtime prefetchable. See more info here: https://nextjs.org/docs/messages/cache-bypass-in-dev\n+         \"\n+        `)\n+      })\n+\n+      it('warns if you render with cache-control: no-cache in dev on client navigation', async () => {\n+        const from = next.cliOutput.length\n+\n+        await next.fetch('/', {\n+          headers: { 'cache-control': 'no-cache', RSC: '1' },\n+        })\n+\n+        expect(stripGetLines(next.cliOutput.slice(from)))\n+          .toMatchInlineSnapshot(`\n+         \"Route / is rendering with server caches disabled. For this navigation, Component Metadata in React DevTools will not accurately reflect what is statically prerenderable and runtime prefetchable. See more info here: https://nextjs.org/docs/messages/cache-bypass-in-dev\n+         \"\n+        `)\n+      })\n+\n+      it('does not warn if you render without cache-control: no-cache in dev on initial page load', async () => {\n+        const from = next.cliOutput.length\n+\n+        await next.fetch('/')\n+\n+        expect(stripGetLines(next.cliOutput.slice(from))).toMatchInlineSnapshot(\n+          `\"\"`\n+        )\n+      })\n+\n+      it('does not warn if you render without cache-control: no-cache in dev on client navigation', async () => {\n+        const from = next.cliOutput.length\n+\n+        await next.fetch('/', {\n+          headers: { RSC: '1' },\n+        })\n+\n+        expect(stripGetLines(next.cliOutput.slice(from))).toMatchInlineSnapshot(\n+          `\"\"`\n+        )\n+      })\n+    } else {\n+      it('does not warn if you render with cache-control: no-cache in dev on initial page load', async () => {\n+        const from = next.cliOutput.length\n+\n+        await next.fetch('/', {\n+          headers: { 'cache-control': 'no-cache' },\n+        })\n+\n+        expect(stripGetLines(next.cliOutput.slice(from))).toMatchInlineSnapshot(\n+          `\"\"`\n+        )\n+      })\n+\n+      it('does not warn if you render with cache-control: no-cache in dev on client navigation', async () => {\n+        const from = next.cliOutput.length\n+\n+        await next.fetch('/', {\n+          headers: { 'cache-control': 'no-cache' },\n+        })\n+\n+        expect(stripGetLines(next.cliOutput.slice(from))).toMatchInlineSnapshot(\n+          `\"\"`\n+        )\n+      })\n+\n+      it('does not warn if you render without cache-control: no-cache in dev on initial page load in start', async () => {\n+        const from = next.cliOutput.length\n+\n+        await next.fetch('/')\n+\n+        expect(stripGetLines(next.cliOutput.slice(from))).toMatchInlineSnapshot(\n+          `\"\"`\n+        )\n+      })\n+\n+      it('does not warn if you render without cache-control: no-cache in dev on client navigation in start', async () => {\n+        const from = next.cliOutput.length\n+\n+        await next.fetch('/', {\n+          headers: { RSC: '1' },\n+        })\n+\n+        expect(stripGetLines(next.cliOutput.slice(from))).toMatchInlineSnapshot(\n+          `\"\"`\n+        )\n+      })\n+    }\n+  })\n+})\n+\n+function stripGetLines(input: string): string {\n+  return input\n+    .replace(/^\\s*GET.*(?:\\r?\\n|$)/gm, '')\n+    .replace(/^\\s*[○✓].*(?:\\r?\\n|$)/gm, '')\n+}"
        },
        {
            "sha": "040e23abcbc4b1ca0519dd1f31a0ebfcf6424da7",
            "filename": "test/e2e/app-dir/cache-components-errors/cache-components-errors.test.ts",
            "status": "modified",
            "additions": 24,
            "deletions": 24,
            "changes": 48,
            "blob_url": "https://github.com/vercel/next.js/blob/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts?ref=49fcbd93f2c579d79f2005dccf82a93686d6919a",
            "patch": "@@ -238,13 +238,13 @@ describe('Cache Components Errors', () => {\n                    at ScrollAndFocusHandler (bundler:///<next-src>)\n                    at RenderFromTemplateContext (bundler:///<next-src>)\n                    at OuterLayoutRouter (bundler:///<next-src>)\n-                 330 |  */\n-                 331 | function InnerLayoutRouter({\n-               > 332 |   tree,\n+                 331 |  */\n+                 332 | function InnerLayoutRouter({\n+               > 333 |   tree,\n                      |   ^\n-                 333 |   segmentPath,\n-                 334 |   cacheNode,\n-                 335 |   url,\n+                 334 |   segmentPath,\n+                 335 |   cacheNode,\n+                 336 |   url,\n                To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/dynamic-metadata-error-route\" in your browser to investigate the error.\n                Error occurred prerendering page \"/dynamic-metadata-error-route\". Read more: https://nextjs.org/docs/messages/prerender-error\n \n@@ -745,13 +745,13 @@ describe('Cache Components Errors', () => {\n                    at ScrollAndFocusHandler (bundler:///<next-src>)\n                    at RenderFromTemplateContext (bundler:///<next-src>)\n                    at OuterLayoutRouter (bundler:///<next-src>)\n-                 330 |  */\n-                 331 | function InnerLayoutRouter({\n-               > 332 |   tree,\n+                 331 |  */\n+                 332 | function InnerLayoutRouter({\n+               > 333 |   tree,\n                      |   ^\n-                 333 |   segmentPath,\n-                 334 |   cacheNode,\n-                 335 |   url,\n+                 334 |   segmentPath,\n+                 335 |   cacheNode,\n+                 336 |   url,\n                To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/dynamic-root\" in your browser to investigate the error.\n                Error occurred prerendering page \"/dynamic-root\". Read more: https://nextjs.org/docs/messages/prerender-error\n \n@@ -2141,13 +2141,13 @@ describe('Cache Components Errors', () => {\n                      at ScrollAndFocusHandler (bundler:///<next-src>)\n                      at RenderFromTemplateContext (<anonymous>)\n                      at OuterLayoutRouter (bundler:///<next-src>)\n-                   330 |  */\n-                   331 | function InnerLayoutRouter({\n-                 > 332 |   tree,\n+                   331 |  */\n+                   332 | function InnerLayoutRouter({\n+                 > 333 |   tree,\n                        |   ^\n-                   333 |   segmentPath,\n-                   334 |   cacheNode,\n-                   335 |   url,\n+                   334 |   segmentPath,\n+                   335 |   cacheNode,\n+                   336 |   url,\n                  To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/sync-attribution/unguarded-async-guarded-clientsync\" in your browser to investigate the error.\n                  Error occurred prerendering page \"/sync-attribution/unguarded-async-guarded-clientsync\". Read more: https://nextjs.org/docs/messages/prerender-error\n \n@@ -3157,13 +3157,13 @@ describe('Cache Components Errors', () => {\n                      at ScrollAndFocusHandler (bundler:///<next-src>)\n                      at RenderFromTemplateContext (bundler:///<next-src>)\n                      at OuterLayoutRouter (bundler:///<next-src>)\n-                   330 |  */\n-                   331 | function InnerLayoutRouter({\n-                 > 332 |   tree,\n+                   331 |  */\n+                   332 | function InnerLayoutRouter({\n+                 > 333 |   tree,\n                        |   ^\n-                   333 |   segmentPath,\n-                   334 |   cacheNode,\n-                   335 |   url,\n+                   334 |   segmentPath,\n+                   335 |   cacheNode,\n+                   336 |   url,\n                  To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/use-cache-private-without-suspense\" in your browser to investigate the error.\n                  Error occurred prerendering page \"/use-cache-private-without-suspense\". Read more: https://nextjs.org/docs/messages/prerender-error\n "
        },
        {
            "sha": "745e32b8a8d235ef098d1a265f57c0254df40b5d",
            "filename": "test/e2e/app-dir/cache-components-errors/fixtures/dev-cache-bypass/app/layout.tsx",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fapp%2Flayout.tsx?ref=49fcbd93f2c579d79f2005dccf82a93686d6919a",
            "patch": "@@ -0,0 +1,9 @@\n+export default function Root({ children }: { children: React.ReactNode }) {\n+  return (\n+    <html>\n+      <body>\n+        <main>{children}</main>\n+      </body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "49fd7bc00a0f6481376da99f8f581bd87d15e5cc",
            "filename": "test/e2e/app-dir/cache-components-errors/fixtures/dev-cache-bypass/app/other/page.tsx",
            "status": "added",
            "additions": 34,
            "deletions": 0,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fapp%2Fother%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fapp%2Fother%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fapp%2Fother%2Fpage.tsx?ref=49fcbd93f2c579d79f2005dccf82a93686d6919a",
            "patch": "@@ -0,0 +1,34 @@\n+import { Suspense } from 'react'\n+import Link from 'next/link'\n+\n+export default async function Page() {\n+  return (\n+    <main>\n+      <section>\n+        <p>\n+          This page has has a slow to fill cache. When not bypassing the dev\n+          cache the initial load should be slow while the cache warms up. You\n+          won't see the Suspense fallback because the entire response is blocked\n+          until the cache warms up. Subsequent loads should be fast because the\n+          cache is warm and nothing needs to Suspend When bypassing caches in\n+          dev with \"disable cache\" the request should instantly show a fallback\n+          UI and show the final content after the delay.\n+        </p>\n+      </section>\n+      <section>\n+        <Suspense fallback={<p>Loading from cache...</p>}>\n+          <CachedData />\n+        </Suspense>\n+      </section>\n+      <Link href=\"/\">Go back home</Link>\n+    </main>\n+  )\n+}\n+\n+async function CachedData() {\n+  'use cache'\n+\n+  await new Promise((r) => setTimeout(r, 2000))\n+\n+  return <p>{67}</p>\n+}"
        },
        {
            "sha": "9b733c2ef2f00a2decf1a98c5143567e09152a48",
            "filename": "test/e2e/app-dir/cache-components-errors/fixtures/dev-cache-bypass/app/page.tsx",
            "status": "added",
            "additions": 34,
            "deletions": 0,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fapp%2Fpage.tsx?ref=49fcbd93f2c579d79f2005dccf82a93686d6919a",
            "patch": "@@ -0,0 +1,34 @@\n+import { Suspense } from 'react'\n+import Link from 'next/link'\n+\n+export default async function Page() {\n+  return (\n+    <main>\n+      <section>\n+        <p>\n+          This page has has a slow to fill cache. When not bypassing the dev\n+          cache the initial load should be slow while the cache warms up. You\n+          won't see the Suspense fallback because the entire response is blocked\n+          until the cache warms up. Subsequent loads should be fast because the\n+          cache is warm and nothing needs to Suspend When bypassing caches in\n+          dev with \"disable cache\" the request should instantly show a fallback\n+          UI and show the final content after the delay.\n+        </p>\n+      </section>\n+      <section>\n+        <Suspense fallback={<p>Loading from cache...</p>}>\n+          <CachedData />\n+        </Suspense>\n+      </section>\n+      <Link href=\"/other\">/Other</Link>\n+    </main>\n+  )\n+}\n+\n+async function CachedData() {\n+  'use cache'\n+\n+  await new Promise((r) => setTimeout(r, 2000))\n+\n+  return <p>{42}</p>\n+}"
        },
        {
            "sha": "30a826fdacc568ffb8cd6641fe15330a3c9d618d",
            "filename": "test/e2e/app-dir/cache-components-errors/fixtures/dev-cache-bypass/next.config.js",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/49fcbd93f2c579d79f2005dccf82a93686d6919a/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Ffixtures%2Fdev-cache-bypass%2Fnext.config.js?ref=49fcbd93f2c579d79f2005dccf82a93686d6919a",
            "patch": "@@ -0,0 +1,10 @@\n+/**\n+ * @type {import('next').NextConfig}\n+ */\n+const nextConfig = {\n+  experimental: {\n+    cacheComponents: true,\n+  },\n+}\n+\n+module.exports = nextConfig"
        }
    ],
    "stats": {
        "total": 363,
        "additions": 327,
        "deletions": 36
    }
}