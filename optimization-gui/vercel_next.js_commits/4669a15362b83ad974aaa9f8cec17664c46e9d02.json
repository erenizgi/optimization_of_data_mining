{
    "author": "fireairforce",
    "message": "fix(turbopack): webpack-loaders failed to resolve relative path (#82720)\n\nfixed: #82106 \n\nThe error was cause by the follow reason, when pass:\n\n```ts\nconst nextConfig: NextConfig = {\n  /* config options here */\n  turbopack: {\n    rules: {\n      '*.txt': {\n        loaders: ['./test-file-loader.js'],\n        as: '*.js',\n      },\n    }\n  }\n};\n```\n\nand the project directory as follows:\n\n```bash\nsrc\n |_ app\n      |_ index.tsx\n      |_ text.txt\n```\n\nThe loader will deal the `text.txt` under `src/app`, then the loader\nwill resolve path like:\n\n```ts\nrequire.resolve('./test-file-loader.js', paths: ['/Users/next-app/src/app'])\n```\n\nBecause the resource dir the `dirname(resoucePath)`, and the\nresourcePath is `/Users/next-app/src/app/text.txt`, this will never\nresolve the right loader path here.\n\nSo I just add a more `path` param(which is `contextDir`) for the\nrequire.resolve function, it will help the loader to find the right path\nhere.",
    "sha": "4669a15362b83ad974aaa9f8cec17664c46e9d02",
    "files": [
        {
            "sha": "ea44028fee5f2c484c3576ad53c4c2c9b609b787",
            "filename": "test/e2e/app-dir/webpack-loader-binary/next.config.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/4669a15362b83ad974aaa9f8cec17664c46e9d02/test%2Fe2e%2Fapp-dir%2Fwebpack-loader-binary%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/4669a15362b83ad974aaa9f8cec17664c46e9d02/test%2Fe2e%2Fapp-dir%2Fwebpack-loader-binary%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fwebpack-loader-binary%2Fnext.config.js?ref=4669a15362b83ad974aaa9f8cec17664c46e9d02",
            "patch": "@@ -5,7 +5,7 @@ const nextConfig = {\n   turbopack: {\n     rules: {\n       '*.txt': {\n-        loaders: [require.resolve('./test-file-loader.js')],\n+        loaders: ['./test-file-loader.js'],\n         as: '*.js',\n       },\n       '*.mp4': {\n@@ -17,7 +17,7 @@ const nextConfig = {\n   webpack(config) {\n     config.module.rules.push({\n       test: /\\.txt/,\n-      use: require.resolve('./test-file-loader.js'),\n+      use: './test-file-loader.js',\n     })\n     config.module.rules.push({\n       test: /\\.mp4/,"
        },
        {
            "sha": "f478389941fa90a097e1c14d25d4337090c8a5a1",
            "filename": "turbopack/crates/turbopack-node/js/src/transforms/webpack-loaders.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/4669a15362b83ad974aaa9f8cec17664c46e9d02/turbopack%2Fcrates%2Fturbopack-node%2Fjs%2Fsrc%2Ftransforms%2Fwebpack-loaders.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/4669a15362b83ad974aaa9f8cec17664c46e9d02/turbopack%2Fcrates%2Fturbopack-node%2Fjs%2Fsrc%2Ftransforms%2Fwebpack-loaders.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-node%2Fjs%2Fsrc%2Ftransforms%2Fwebpack-loaders.ts?ref=4669a15362b83ad974aaa9f8cec17664c46e9d02",
            "patch": "@@ -428,7 +428,7 @@ const transform = (\n \n         loaders: loadersWithOptions.map((loader) => ({\n           loader: __turbopack_external_require__.resolve(loader.loader, {\n-            paths: [resourceDir],\n+            paths: [contextDir, resourceDir],\n           }),\n           options: loader.options,\n         })),"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
    }
}