{
    "author": "sokra",
    "message": "Turbopack: add debug assertion to check for duplicate modules (#78025)\n\n### What?\n\nQuick debug check to panic for duplicate modules",
    "sha": "03dc2558c47e73fd287dac1e3c6eb49d2321c885",
    "files": [
        {
            "sha": "4a89cc48d1f5bbe2f56ac7ca84b728195fdc4a07",
            "filename": "turbopack/crates/turbopack-core/src/module_graph/mod.rs",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/03dc2558c47e73fd287dac1e3c6eb49d2321c885/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/03dc2558c47e73fd287dac1e3c6eb49d2321c885/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fmodule_graph%2Fmod.rs?ref=03dc2558c47e73fd287dac1e3c6eb49d2321c885",
            "patch": "@@ -325,6 +325,21 @@ impl SingleModuleGraph {\n \n         graph.shrink_to_fit();\n \n+        #[cfg(debug_assertions)]\n+        {\n+            let mut duplicates = Vec::new();\n+            let mut set = FxHashSet::default();\n+            for &module in modules.keys() {\n+                let ident = module.ident().to_string().await?;\n+                if !set.insert(ident.clone()) {\n+                    duplicates.push(ident);\n+                }\n+            }\n+            if !duplicates.is_empty() {\n+                panic!(\"Duplicate module idents in graph: {:#?}\", duplicates);\n+            }\n+        }\n+\n         Ok(SingleModuleGraph {\n             graph: TracedDiGraph::new(graph),\n             number_of_modules,"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 15,
        "deletions": 0
    }
}