{
    "author": "lukesandberg",
    "message": "[turbopack] Update next docs with information about turbopack known adoption issues (#82560)\n\n- Document the experimental persistent caching flag\n- Document the gap with the `innerGraph` optimization\n- Document the css module ordering issue\n- Document the persistent caching gap\n\nWill wait to submit this until the when we publish the release.",
    "sha": "1766a1aba6a7c92a03c08073114652d61da1a388",
    "files": [
        {
            "sha": "c0bd7c437ef66b117ed365a6db7d0717f79c5c9d",
            "filename": "docs/01-app/03-api-reference/05-config/01-next-config-js/turbopackPersistentCaching.mdx",
            "status": "added",
            "additions": 42,
            "deletions": 0,
            "changes": 42,
            "blob_url": "https://github.com/vercel/next.js/blob/1766a1aba6a7c92a03c08073114652d61da1a388/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FturbopackPersistentCaching.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/1766a1aba6a7c92a03c08073114652d61da1a388/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FturbopackPersistentCaching.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F05-config%2F01-next-config-js%2FturbopackPersistentCaching.mdx?ref=1766a1aba6a7c92a03c08073114652d61da1a388",
            "patch": "@@ -0,0 +1,42 @@\n+---\n+title: turbopackPersistentCaching\n+description: Learn how to enable Persistent Caching for Turbopack builds\n+version: canary\n+---\n+\n+## Usage\n+\n+Turbopack Persistent Caching enables Turbopack to reduce work across `next dev` or `next build` commands. When enabled, Turbopack will save and restore data to the `.next` folder between builds, which can greatly speed up subsequent builds and dev sessions.\n+\n+> **Warning:** Persistent Caching is still under development and is not yet stable. Users adopting should expect some stability issues.\n+\n+> **Good to know**: Note that while `next dev` and `next build` can share cached data with each other, most cache entries are command-specific due to different configuration and environment variables.\n+\n+```ts filename=\"next.config.ts\" switcher\n+import type { NextConfig } from 'next'\n+\n+const nextConfig: NextConfig = {\n+  experimental: {\n+    turbopackPersistentCaching: true,\n+  },\n+}\n+\n+export default nextConfig\n+```\n+\n+```js filename=\"next.config.js\" switcher\n+/** @type {import('next').NextConfig} */\n+const nextConfig = {\n+  experimental: {\n+    turbopackPersistentCaching: true,\n+  },\n+}\n+\n+module.exports = nextConfig\n+```\n+\n+## Version Changes\n+\n+| Version   | Changes                                     |\n+| --------- | ------------------------------------------- |\n+| `v15.5.0` | Persistent caching released as experimental |"
        },
        {
            "sha": "2591a3b3f45944396bd771f0feaa6ab704f4a6a6",
            "filename": "docs/01-app/03-api-reference/08-turbopack.mdx",
            "status": "modified",
            "additions": 59,
            "deletions": 5,
            "changes": 64,
            "blob_url": "https://github.com/vercel/next.js/blob/1766a1aba6a7c92a03c08073114652d61da1a388/docs%2F01-app%2F03-api-reference%2F08-turbopack.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/1766a1aba6a7c92a03c08073114652d61da1a388/docs%2F01-app%2F03-api-reference%2F08-turbopack.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F08-turbopack.mdx?ref=1766a1aba6a7c92a03c08073114652d61da1a388",
            "patch": "@@ -91,6 +91,60 @@ Turbopack in Next.js has **zero-configuration** for the common use cases. Below\n | **Fast Refresh**         | **Supported** | Updates JavaScript, TypeScript, and CSS without a full refresh.                          |\n | **Incremental Bundling** | **Supported** | Turbopack lazily builds only whatâ€™s requested by the dev server, speeding up large apps. |\n \n+## Known gaps with webpack\n+\n+There are a number of non-trivial behavior differences between webpack and Turbopack that are important to be aware of when migrating an application. Generally, these are less of a concern for new applications.\n+\n+### CSS Module Ordering\n+\n+Turbopack will follow JS import order to order [CSS modules](/docs/app/getting-started/css#css-modules) which are not otherwise ordered. For example:\n+\n+```jsx filename=\"components/BlogPost.jsx\"\n+import utilStyles from './utils.module.css'\n+import buttonStyles from './button.module.css'\n+export default function BlogPost() {\n+  return (\n+    <div className={utilStyles.container}>\n+      <button className={buttonStyles.primary}>Click me</button>\n+    </div>\n+  )\n+}\n+```\n+\n+In this example, Turbopack will ensure that `utils.module.css` will appear before `button.module.css` in the produced CSS chunk, following the import order\n+\n+Webpack generally does this as well, but there are cases where it will ignore JS inferred ordering, for example if it infers the JS file is side-effect-free.\n+\n+This can lead to subtle rendering changes when adopting Turbopack, if applications have come to rely on an arbitrary ordering. Generally, the solution is easy, e.g. have `button.module.css` `@import utils.module.css` to force the ordering, or identify the conflicting rules and change them to not target the same properties.\n+\n+### Bundle Sizes\n+\n+Turbopack does not yet have an equivalent to the [Inner Graph Optimization](https://webpack.js.org/configuration/optimization/#optimizationinnergraph) in webpack. This optimization is useful to tree shake large modules. For example:\n+\n+```js filename=large.module.js\n+import heavy from 'some-heavy-dependency.js'\n+\n+export function usesHeavy() {\n+  return heavy.run()\n+}\n+\n+export const CONSTANT_VALUE = 3\n+```\n+\n+If an application only uses `CONSTANT_VALUE` Turbopack will detect this and delete the `usesHeavy` export but not the corresponding `import`. However, with the `optimization.innerGraph = true` option enabled, webpack can delete the `import` too.\n+\n+We are planning to offer an equivalent to the `innerGraph` optimization in Turbopack but it is still under development. If you are affected by this gap, consider manually splitting these modules.\n+\n+### Build Caching\n+\n+Webpack supports [disk build caching](https://webpack.js.org/configuration/cache/#cache) to speed up builds. We are planning to support an analogous feature in Turbopack but it is not ready yet. On the `next@canary` release you can experiment with our solution by enabling the [`experimental.turbopackPersistentCaching` flag](/docs/app/api-reference/config/next-config-js/turbopackPersistentCaching).\n+\n+> **Good to know:** For this reason, when comparing webpack and Turbopack performance, make sure to delete the `.next` folder between builds to see a fair comparison.\n+\n+### Webpack plugins\n+\n+Turbopack does not support webpack plugins. This affects third-party tools that rely on webpack's plugin system for integration. We do support [webpack loaders](/docs/app/api-reference/config/next-config-js/turbopack#configuring-webpack-loaders). If you depend on webpack plugins, you'll need to find Turbopack-compatible alternatives or continue using webpack until equivalent functionality is available.\n+\n ## Unsupported and unplanned features\n \n Some features are not yet implemented or not planned:\n@@ -112,7 +166,6 @@ Some features are not yet implemented or not planned:\n - **`experimental.esmExternals`**\n   Not planned. Turbopack does not support the legacy `esmExternals` configuration in Next.js.\n - **Some Next.js Experimental Flags**\n-  - `experimental.typedRoutes`\n   - `experimental.nextScriptWorkers`\n   - `experimental.sri.algorithm`\n   - `experimental.fallbackNodePolyfills`\n@@ -167,7 +220,8 @@ Stay tuned for more updates as we continue to improve Turbopack and add producti\n \n ## Version Changes\n \n-| Version   | Changes                          |\n-| --------- | -------------------------------- |\n-| `v15.3.0` | Experimental support for `build` |\n-| `v15.0.0` | Turbopack for `dev` stable       |\n+| Version   | Changes                            |\n+| --------- | ---------------------------------- |\n+| `v15.5.0` | Turbopack support for `build` beta |\n+| `v15.3.0` | Experimental support for `build`   |\n+| `v15.0.0` | Turbopack for `dev` stable         |"
        }
    ],
    "stats": {
        "total": 106,
        "additions": 101,
        "deletions": 5
    }
}