{
    "author": "timneutkens",
    "message": "Development: Only load webpack when used (#84123)\n\n## What?\n\nAvoid requiring webpack when using Turbopack. \n\nThis makes \"ready in\" roughly 50ms faster.",
    "sha": "02dc40e9a5f7722939811e5a76210b653c9c012c",
    "files": [
        {
            "sha": "015a58a58c6e2af70eb3673e92c3cc4ac498733f",
            "filename": "packages/next/src/bundles/webpack/packages/webpack.js",
            "status": "modified",
            "additions": 34,
            "deletions": 37,
            "changes": 71,
            "blob_url": "https://github.com/vercel/next.js/blob/02dc40e9a5f7722939811e5a76210b653c9c012c/packages%2Fnext%2Fsrc%2Fbundles%2Fwebpack%2Fpackages%2Fwebpack.js",
            "raw_url": "https://github.com/vercel/next.js/raw/02dc40e9a5f7722939811e5a76210b653c9c012c/packages%2Fnext%2Fsrc%2Fbundles%2Fwebpack%2Fpackages%2Fwebpack.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbundles%2Fwebpack%2Fpackages%2Fwebpack.js?ref=02dc40e9a5f7722939811e5a76210b653c9c012c",
            "patch": "@@ -2,43 +2,40 @@ exports.__esModule = true\n \n exports.default = undefined\n \n-exports.init = function () {\n-  if (process.env.NEXT_RSPACK) {\n-    // eslint-disable-next-line\n-    Object.assign(exports, getRspackCore())\n-    Object.assign(exports, {\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      StringXor: require('./bundle5')().StringXor,\n-    })\n-  } else if (process.env.NEXT_PRIVATE_LOCAL_WEBPACK) {\n-    Object.assign(exports, {\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      BasicEvaluatedExpression: require('webpack/lib/javascript/BasicEvaluatedExpression'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      ConcatenatedModule: require('webpack/lib/optimize/ConcatenatedModule'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      makePathsAbsolute: require('webpack/lib/util/identifier')\n-        .makePathsAbsolute,\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      ModuleFilenameHelpers: require('webpack/lib/ModuleFilenameHelpers'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      NodeTargetPlugin: require('webpack/lib/node/NodeTargetPlugin'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      RuntimeGlobals: require('webpack/lib/RuntimeGlobals'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      SourceMapDevToolModuleOptionsPlugin: require('webpack/lib/SourceMapDevToolModuleOptionsPlugin'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      StringXor: require('webpack/lib/util/StringXor'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      NormalModule: require('webpack/lib/NormalModule'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      sources: require('webpack').sources,\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      webpack: require('webpack'),\n-    })\n-  } else {\n-    Object.assign(exports, require('./bundle5')())\n-  }\n+if (process.env.NEXT_RSPACK) {\n+  // eslint-disable-next-line\n+  Object.assign(exports, getRspackCore())\n+  Object.assign(exports, {\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    StringXor: require('./bundle5')().StringXor,\n+  })\n+} else if (process.env.NEXT_PRIVATE_LOCAL_WEBPACK) {\n+  Object.assign(exports, {\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    BasicEvaluatedExpression: require('webpack/lib/javascript/BasicEvaluatedExpression'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    ConcatenatedModule: require('webpack/lib/optimize/ConcatenatedModule'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    makePathsAbsolute: require('webpack/lib/util/identifier').makePathsAbsolute,\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    ModuleFilenameHelpers: require('webpack/lib/ModuleFilenameHelpers'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    NodeTargetPlugin: require('webpack/lib/node/NodeTargetPlugin'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    RuntimeGlobals: require('webpack/lib/RuntimeGlobals'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    SourceMapDevToolModuleOptionsPlugin: require('webpack/lib/SourceMapDevToolModuleOptionsPlugin'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    StringXor: require('webpack/lib/util/StringXor'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    NormalModule: require('webpack/lib/NormalModule'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    sources: require('webpack').sources,\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    webpack: require('webpack'),\n+  })\n+} else {\n+  Object.assign(exports, require('./bundle5')())\n }\n \n function getRspackCore() {"
        },
        {
            "sha": "015a58a58c6e2af70eb3673e92c3cc4ac498733f",
            "filename": "packages/next/src/compiled/webpack/webpack.js",
            "status": "modified",
            "additions": 34,
            "deletions": 37,
            "changes": 71,
            "blob_url": "https://github.com/vercel/next.js/blob/02dc40e9a5f7722939811e5a76210b653c9c012c/packages%2Fnext%2Fsrc%2Fcompiled%2Fwebpack%2Fwebpack.js",
            "raw_url": "https://github.com/vercel/next.js/raw/02dc40e9a5f7722939811e5a76210b653c9c012c/packages%2Fnext%2Fsrc%2Fcompiled%2Fwebpack%2Fwebpack.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fcompiled%2Fwebpack%2Fwebpack.js?ref=02dc40e9a5f7722939811e5a76210b653c9c012c",
            "patch": "@@ -2,43 +2,40 @@ exports.__esModule = true\n \n exports.default = undefined\n \n-exports.init = function () {\n-  if (process.env.NEXT_RSPACK) {\n-    // eslint-disable-next-line\n-    Object.assign(exports, getRspackCore())\n-    Object.assign(exports, {\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      StringXor: require('./bundle5')().StringXor,\n-    })\n-  } else if (process.env.NEXT_PRIVATE_LOCAL_WEBPACK) {\n-    Object.assign(exports, {\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      BasicEvaluatedExpression: require('webpack/lib/javascript/BasicEvaluatedExpression'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      ConcatenatedModule: require('webpack/lib/optimize/ConcatenatedModule'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      makePathsAbsolute: require('webpack/lib/util/identifier')\n-        .makePathsAbsolute,\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      ModuleFilenameHelpers: require('webpack/lib/ModuleFilenameHelpers'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      NodeTargetPlugin: require('webpack/lib/node/NodeTargetPlugin'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      RuntimeGlobals: require('webpack/lib/RuntimeGlobals'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      SourceMapDevToolModuleOptionsPlugin: require('webpack/lib/SourceMapDevToolModuleOptionsPlugin'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      StringXor: require('webpack/lib/util/StringXor'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      NormalModule: require('webpack/lib/NormalModule'),\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      sources: require('webpack').sources,\n-      // eslint-disable-next-line import/no-extraneous-dependencies\n-      webpack: require('webpack'),\n-    })\n-  } else {\n-    Object.assign(exports, require('./bundle5')())\n-  }\n+if (process.env.NEXT_RSPACK) {\n+  // eslint-disable-next-line\n+  Object.assign(exports, getRspackCore())\n+  Object.assign(exports, {\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    StringXor: require('./bundle5')().StringXor,\n+  })\n+} else if (process.env.NEXT_PRIVATE_LOCAL_WEBPACK) {\n+  Object.assign(exports, {\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    BasicEvaluatedExpression: require('webpack/lib/javascript/BasicEvaluatedExpression'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    ConcatenatedModule: require('webpack/lib/optimize/ConcatenatedModule'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    makePathsAbsolute: require('webpack/lib/util/identifier').makePathsAbsolute,\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    ModuleFilenameHelpers: require('webpack/lib/ModuleFilenameHelpers'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    NodeTargetPlugin: require('webpack/lib/node/NodeTargetPlugin'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    RuntimeGlobals: require('webpack/lib/RuntimeGlobals'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    SourceMapDevToolModuleOptionsPlugin: require('webpack/lib/SourceMapDevToolModuleOptionsPlugin'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    StringXor: require('webpack/lib/util/StringXor'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    NormalModule: require('webpack/lib/NormalModule'),\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    sources: require('webpack').sources,\n+    // eslint-disable-next-line import/no-extraneous-dependencies\n+    webpack: require('webpack'),\n+  })\n+} else {\n+  Object.assign(exports, require('./bundle5')())\n }\n \n function getRspackCore() {"
        },
        {
            "sha": "bb3c80ecbaea045ecaf68842feef6dd0edb7a58c",
            "filename": "packages/next/src/server/config-utils.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/02dc40e9a5f7722939811e5a76210b653c9c012c/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-utils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/02dc40e9a5f7722939811e5a76210b653c9c012c/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-utils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-utils.ts?ref=02dc40e9a5f7722939811e5a76210b653c9c012c",
            "patch": "@@ -1,13 +1,10 @@\n let installed: boolean = false\n \n export function loadWebpackHook() {\n-  const { init: initWebpack } =\n-    require('next/dist/compiled/webpack/webpack') as typeof import('next/dist/compiled/webpack/webpack')\n   if (installed) {\n     return\n   }\n   installed = true\n-  initWebpack()\n \n   // hook the Node.js require so that webpack requires are\n   // routed to the bundled and now initialized webpack version"
        }
    ],
    "stats": {
        "total": 145,
        "additions": 68,
        "deletions": 77
    }
}