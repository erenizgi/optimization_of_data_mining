{
    "author": "devjiwonchoi",
    "message": "[devtools] proper draggable for header and footer only (#80792)\n\nPreviously, the entire dialog was draggable, which conflicted with the\ndefault user select. Therefore, only the header and the footer were\nspecified to be draggable, which does not include the children, e.g., a\nbutton inside the header.\n\n### Before\n\n\nhttps://github.com/user-attachments/assets/c5867462-5cdd-486e-b84c-e6bbd47a4c34\n\n### After\n\n\nhttps://github.com/user-attachments/assets/4906898a-5442-4526-b0ce-e31ac86c1322\n\nCloses NEXT-4547",
    "sha": "04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5",
    "files": [
        {
            "sha": "471a19a92df52522ef0446723c323372fdfe6d87",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-panel/devtools-panel-footer.tsx",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel-footer.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel-footer.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel-footer.tsx?ref=04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5",
            "patch": "@@ -51,6 +51,15 @@ export const DEVTOOLS_PANEL_FOOTER_STYLES = css`\n     align-items: center;\n     border-top: 1px solid var(--color-gray-400);\n     border-radius: 0 0 var(--rounded-xl) var(--rounded-xl);\n+\n+    /* For draggable */\n+    cursor: move;\n+    user-select: none;\n+    & > * {\n+      cursor: auto;\n+      /* user-select: auto; follows the parent (parent none -> child none), so reset the direct child to text */\n+      user-select: text;\n+    }\n   }\n \n   [data-nextjs-devtools-panel-footer-tab-group] {"
        },
        {
            "sha": "9630177a96b9a9113c545f05fe3fccd11d854ea6",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-panel/devtools-panel.tsx",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx?ref=04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5",
            "patch": "@@ -97,6 +97,7 @@ export function DevToolsPanel({\n             devToolsPosition: p,\n           })\n         }}\n+        dragHandleSelector=\"[data-nextjs-devtools-panel-header], [data-nextjs-devtools-panel-footer]\"\n       >\n         <>\n           <Dialog\n@@ -257,6 +258,15 @@ export const DEVTOOLS_PANEL_STYLES = css`\n     justify-content: space-between;\n     align-items: center;\n     border-bottom: 1px solid var(--color-gray-400);\n+\n+    /* For draggable */\n+    cursor: move;\n+    user-select: none;\n+    & > * {\n+      cursor: auto;\n+      /* user-select: auto; follows the parent (parent none -> child none), so reset the direct child to text */\n+      user-select: text;\n+    }\n   }\n \n   [data-nextjs-devtools-panel-header-tab-group] {"
        },
        {
            "sha": "906d823ead1f17b6ba6ef42e2217e88c965a06f9",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/draggable.tsx",
            "status": "modified",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdraggable.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdraggable.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdraggable.tsx?ref=04a900f74a77a9cc5aa3d1a6ecf6886b374fe0b5",
            "patch": "@@ -17,19 +17,22 @@ export function Draggable({\n   position: currentCorner,\n   setPosition: setCurrentCorner,\n   onDragStart,\n+  dragHandleSelector,\n   ...props\n }: {\n   children: React.ReactElement\n   position: Corners\n   padding: number\n   setPosition: (position: Corners) => void\n   onDragStart?: () => void\n+  dragHandleSelector?: string\n }) {\n   const { ref, animate, ...drag } = useDrag({\n     threshold: 5,\n     onDragStart,\n     onDragEnd,\n     onAnimationEnd,\n+    dragHandleSelector,\n   })\n \n   function onDragEnd(translation: Point, velocity: Point) {\n@@ -134,6 +137,7 @@ interface UseDragOptions {\n   onDragEnd?: (translation: Point, velocity: Point) => void\n   onAnimationEnd?: (corner: Corner) => void\n   threshold: number // Minimum movement before drag starts\n+  dragHandleSelector?: string\n }\n \n interface Velocity {\n@@ -185,10 +189,31 @@ export function useDrag(options: UseDragOptions) {\n     }\n   }\n \n+  function isValidDragHandle(target: EventTarget | null): boolean {\n+    if (!options.dragHandleSelector || !ref.current || !target) {\n+      return true // If no selector provided, entire element is draggable\n+    }\n+\n+    const element = target as Element\n+    if (!element.matches) {\n+      return false\n+    }\n+\n+    // Check if the target element directly matches the drag handle selector\n+    // This excludes children elements, only allowing drag from the exact element\n+    return element.matches(options.dragHandleSelector)\n+  }\n+\n   function onPointerDown(e: React.PointerEvent) {\n     if (e.button !== 0) {\n       return // ignore right click\n     }\n+\n+    // Check if the pointer down event is on a valid drag handle\n+    if (!isValidDragHandle(e.target)) {\n+      return\n+    }\n+\n     origin.current = { x: e.clientX, y: e.clientY }\n     state.current = 'press'\n     window.addEventListener('pointermove', onPointerMove)"
        }
    ],
    "stats": {
        "total": 44,
        "additions": 44,
        "deletions": 0
    }
}