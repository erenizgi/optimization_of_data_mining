{
    "author": "huozhi",
    "message": "fix: amp deprecation warning should assert on user config (#82572)",
    "sha": "a5317ed693cdfd2c97f4313bedf3cec895561074",
    "files": [
        {
            "sha": "f4f29a4fef6fd6c13f1847bfe78c139b2c9f502c",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 20,
            "deletions": 20,
            "changes": 40,
            "blob_url": "https://github.com/vercel/next.js/blob/a5317ed693cdfd2c97f4313bedf3cec895561074/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/a5317ed693cdfd2c97f4313bedf3cec895561074/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=a5317ed693cdfd2c97f4313bedf3cec895561074",
            "patch": "@@ -161,6 +161,26 @@ function assignDefaults(\n     delete userConfig.exportTrailingSlash\n   }\n \n+  // There are a good amount of test fixtures that have amp enabled\n+  // that also assert on stderr output being empty, so we're gating the\n+  // warning to be skipped when running in Next.js tests until we fully\n+  // remove the feature.\n+  if (!process.env.__NEXT_TEST_MODE) {\n+    warnOptionHasBeenDeprecated(\n+      userConfig,\n+      'amp',\n+      `Built-in amp support is deprecated and the \\`amp\\` configuration option will be removed in Next.js 16.`,\n+      silent\n+    )\n+\n+    warnOptionHasBeenDeprecated(\n+      userConfig,\n+      'experimental.amp',\n+      `Built-in amp support is deprecated and the \\`experimental.amp\\` configuration option will be removed in Next.js 16.`,\n+      silent\n+    )\n+  }\n+\n   // Handle deprecation of experimental.dynamicIO and migrate to experimental.cacheComponents\n   if (userConfig.experimental?.dynamicIO !== undefined) {\n     warnOptionHasBeenDeprecated(\n@@ -503,26 +523,6 @@ function assignDefaults(\n     }\n   }\n \n-  // There are a good amount of test fixtures that have amp enabled\n-  // that also assert on stderr output being empty, so we're gating the\n-  // warning to be skipped when running in Next.js tests until we fully\n-  // remove the feature.\n-  if (!process.env.__NEXT_TEST_MODE) {\n-    warnOptionHasBeenDeprecated(\n-      result,\n-      'amp',\n-      `Built-in amp support is deprecated and the \\`amp\\` configuration option will be removed in Next.js 16.`,\n-      silent\n-    )\n-\n-    warnOptionHasBeenDeprecated(\n-      result,\n-      'experimental.amp',\n-      `Built-in amp support is deprecated and the \\`experimental.amp\\` configuration option will be removed in Next.js 16.`,\n-      silent\n-    )\n-  }\n-\n   warnCustomizedOption(\n     result,\n     'experimental.esmExternals',"
        },
        {
            "sha": "9065785b0a4a364d7d9365c9174bd1237d48966b",
            "filename": "packages/next/src/types.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/a5317ed693cdfd2c97f4313bedf3cec895561074/packages%2Fnext%2Fsrc%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/a5317ed693cdfd2c97f4313bedf3cec895561074/packages%2Fnext%2Fsrc%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Ftypes.ts?ref=a5317ed693cdfd2c97f4313bedf3cec895561074",
            "patch": "@@ -114,6 +114,10 @@ export type ResponseLimit = SizeLimit | boolean\n  * `Config` type, use it for export const config\n  */\n export type PageConfig = {\n+  /**\n+   * @deprecated built-in amp support will be removed in Next 16\n+   * @see [`next/amp`](https://nextjs.org/docs/api-reference/next/amp)\n+   */\n   amp?: boolean | 'hybrid'\n   api?: {\n     /**"
        }
    ],
    "stats": {
        "total": 44,
        "additions": 24,
        "deletions": 20
    }
}