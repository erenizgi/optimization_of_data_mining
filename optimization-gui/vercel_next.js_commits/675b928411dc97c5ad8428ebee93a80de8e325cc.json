{
    "author": "devjiwonchoi",
    "message": "[dev-overlay] do not allow dismissing build error for dev indicator (#76209)\n\n### Why?\n\nSince the build error, including missing tags, cannot be dismissed until\nresolved, the \"Close Icon\" on the indicator does nothing but confuse the\nuser, so remove it.\n\n| Before | After |\n|--------|--------|\n| ![CleanShot 2025-02-19 at 22 33\n44](https://github.com/user-attachments/assets/b64d7a5e-7e8e-428e-a35f-21d49cac6425)\n| ![CleanShot 2025-02-19 at 22 34\n29](https://github.com/user-attachments/assets/8f2f754c-e24d-430e-86c0-edd21ab9c073)\n|\n\nCloses NDX-857",
    "sha": "675b928411dc97c5ad8428ebee93a80de8e325cc",
    "files": [
        {
            "sha": "e5b8ed77d792147d426f8e13082150a06f05e4fd",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/app/react-dev-overlay.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/675b928411dc97c5ad8428ebee93a80de8e325cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fapp%2Freact-dev-overlay.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/675b928411dc97c5ad8428ebee93a80de8e325cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fapp%2Freact-dev-overlay.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fapp%2Freact-dev-overlay.tsx?ref=675b928411dc97c5ad8428ebee93a80de8e325cc",
            "patch": "@@ -37,11 +37,13 @@ export default function ReactDevOverlay({\n \n         <RenderError state={state} isAppDir={true}>\n           {({ runtimeErrors, totalErrorCount }) => {\n+            const isBuildError = runtimeErrors.length === 0\n             return (\n               <>\n                 <DevToolsIndicator\n                   state={state}\n                   errorCount={totalErrorCount}\n+                  isBuildError={isBuildError}\n                   setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n                 />\n "
        },
        {
            "sha": "798cf7a640999f6d94e34955ae6c76c1c4b9066c",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/errors/dev-tools-indicator/dev-tools-indicator.tsx",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/675b928411dc97c5ad8428ebee93a80de8e325cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/675b928411dc97c5ad8428ebee93a80de8e325cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx?ref=675b928411dc97c5ad8428ebee93a80de8e325cc",
            "patch": "@@ -23,11 +23,13 @@ type DevToolsIndicatorPosition = typeof INDICATOR_POSITION\n export function DevToolsIndicator({\n   state,\n   errorCount,\n+  isBuildError,\n   setIsErrorOverlayOpen,\n   position = INDICATOR_POSITION,\n }: {\n   state: OverlayState\n   errorCount: number\n+  isBuildError: boolean\n   setIsErrorOverlayOpen: Dispatch<SetStateAction<boolean>>\n   // Technically this prop isn't needed, but useful for testing.\n   position?: DevToolsIndicatorPosition\n@@ -47,6 +49,7 @@ export function DevToolsIndicator({\n         isTurbopack={!!process.env.TURBOPACK}\n         position={position}\n         disabled={state.disableDevIndicator}\n+        isBuildError={isBuildError}\n       />\n     )\n   )\n@@ -71,6 +74,7 @@ function DevToolsPopover({\n   isStaticRoute,\n   isTurbopack,\n   position,\n+  isBuildError,\n   hide,\n   setIsErrorOverlayOpen,\n }: {\n@@ -80,6 +84,7 @@ function DevToolsPopover({\n   semver: string | undefined\n   isTurbopack: boolean\n   position: DevToolsIndicatorPosition\n+  isBuildError: boolean\n   hide: () => void\n   setIsErrorOverlayOpen: Dispatch<SetStateAction<boolean>>\n }) {\n@@ -263,6 +268,7 @@ function DevToolsPopover({\n         openErrorOverlay={openErrorOverlay}\n         isDevBuilding={useIsDevBuilding()}\n         isDevRendering={useIsDevRendering()}\n+        isBuildError={isBuildError}\n       />\n \n       {routeInfoMounted && ("
        },
        {
            "sha": "91ad664b3dbbe16f441066d7ed0afcd1ce6b6bdb",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/internal/components/errors/dev-tools-indicator/internal/next-logo.tsx",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/675b928411dc97c5ad8428ebee93a80de8e325cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Finternal%2Fnext-logo.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/675b928411dc97c5ad8428ebee93a80de8e325cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Finternal%2Fnext-logo.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Finternal%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Finternal%2Fnext-logo.tsx?ref=675b928411dc97c5ad8428ebee93a80de8e325cc",
            "patch": "@@ -7,6 +7,7 @@ interface Props extends React.ComponentProps<'button'> {\n   issueCount: number\n   isDevBuilding: boolean\n   isDevRendering: boolean\n+  isBuildError: boolean\n   onTriggerClick: () => void\n   openErrorOverlay: () => void\n }\n@@ -62,6 +63,7 @@ export const NextLogo = forwardRef(function NextLogo(\n     issueCount,\n     isDevBuilding,\n     isDevRendering,\n+    isBuildError,\n     onTriggerClick,\n     openErrorOverlay,\n     ...props\n@@ -224,7 +226,9 @@ export const NextLogo = forwardRef(function NextLogo(\n             gap: var(--padding);\n             align-items: center;\n             padding-left: 8px;\n-            padding-right: ${disabled ? '8px' : 'calc(var(--padding) * 2)'};\n+            padding-right: ${disabled || isBuildError\n+              ? '8px'\n+              : 'calc(var(--padding) * 2)'};\n             height: 32px;\n             margin: 0 var(--padding);\n             border-radius: 9999px;\n@@ -462,7 +466,7 @@ export const NextLogo = forwardRef(function NextLogo(\n                   )}\n                 </div>\n               </button>\n-              {!disabled && (\n+              {!disabled && !isBuildError && (\n                 <button\n                   data-issues-collapse\n                   aria-label=\"Collapse issues badge\""
        },
        {
            "sha": "317c236a2f5bf61502751bfa3466a41a8ee2a789",
            "filename": "packages/next/src/client/components/react-dev-overlay/_experimental/pages/react-dev-overlay.tsx",
            "status": "modified",
            "additions": 19,
            "deletions": 15,
            "changes": 34,
            "blob_url": "https://github.com/vercel/next.js/blob/675b928411dc97c5ad8428ebee93a80de8e325cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fpages%2Freact-dev-overlay.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/675b928411dc97c5ad8428ebee93a80de8e325cc/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fpages%2Freact-dev-overlay.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2F_experimental%2Fpages%2Freact-dev-overlay.tsx?ref=675b928411dc97c5ad8428ebee93a80de8e325cc",
            "patch": "@@ -41,24 +41,28 @@ export default function ReactDevOverlay({ children }: ReactDevOverlayProps) {\n         <ComponentStyles />\n \n         <RenderError state={state} isAppDir={false}>\n-          {({ runtimeErrors, totalErrorCount }) => (\n-            <>\n-              <DevToolsIndicator\n-                state={state}\n-                errorCount={totalErrorCount}\n-                setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n-              />\n-\n-              {(hasRuntimeErrors || hasBuildError) && (\n-                <ErrorOverlay\n+          {({ runtimeErrors, totalErrorCount }) => {\n+            const isBuildError = runtimeErrors.length === 0\n+            return (\n+              <>\n+                <DevToolsIndicator\n                   state={state}\n-                  runtimeErrors={runtimeErrors}\n-                  isErrorOverlayOpen={isErrorOverlayOpen}\n+                  errorCount={totalErrorCount}\n+                  isBuildError={isBuildError}\n                   setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n                 />\n-              )}\n-            </>\n-          )}\n+\n+                {(hasRuntimeErrors || hasBuildError) && (\n+                  <ErrorOverlay\n+                    state={state}\n+                    runtimeErrors={runtimeErrors}\n+                    isErrorOverlayOpen={isErrorOverlayOpen}\n+                    setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n+                  />\n+                )}\n+              </>\n+            )\n+          }}\n         </RenderError>\n       </ShadowPortal>\n     </>"
        }
    ],
    "stats": {
        "total": 50,
        "additions": 33,
        "deletions": 17
    }
}