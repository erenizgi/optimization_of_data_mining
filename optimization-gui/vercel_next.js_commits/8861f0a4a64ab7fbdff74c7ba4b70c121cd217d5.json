{
    "author": "wyattjoh",
    "message": "chore: add Conductor configuration for parallel development (#88116)\n\n## What?\n\nAdds [Conductor](https://www.conductor.build/) configuration to enable\nteam members to use parallel Claude Code agents for Next.js development.\n\n**Files added:**\n- `.conductor/conductor.json` - Main configuration with setup/run\nscripts\n- `.conductor/README.md` - Documentation for using Conductor with\nNext.js\n- `.gitignore` - Added entry to ignore Conductor worktree directories\n\n## Why?\n\nConductor is a Mac app that orchestrates multiple Claude Code agents in\nparallel, each with its own isolated git worktree. This enables:\n\n- **Parallel development** - Work on multiple features simultaneously\nwithout branch conflicts\n- **Isolated environments** - Each agent has its own clean working\ndirectory\n- **Faster iteration** - Multiple AI assistants can tackle different\naspects of a task concurrently\n\nSharing this configuration allows other team members to leverage the\nsame workflow for Next.js development.\n\n## How?\n\nThe configuration includes:\n\n1. **Setup script** that runs when creating a new workspace:\n   - Enables corepack for pnpm\n   - Validates Node.js version (18+)\n   - Installs dependencies with `--prefer-offline`\n   - Runs `pnpm build`\n\n2. **Run script** that starts watch mode (`pnpm --filter=next dev`) for\nfast iteration\n\n3. **Environment variables** to disable telemetry during development\n\n4. **Gitignore entry** (`.conductor/*/`) to prevent accidentally\ncommitting worktree contents",
    "sha": "8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5",
    "files": [
        {
            "sha": "ff7edbdfb965e48a9f38d422d4db914d4e192fd9",
            "filename": ".conductor/README.md",
            "status": "added",
            "additions": 125,
            "deletions": 0,
            "changes": 125,
            "blob_url": "https://github.com/vercel/next.js/blob/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.conductor%2FREADME.md",
            "raw_url": "https://github.com/vercel/next.js/raw/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.conductor%2FREADME.md",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.conductor%2FREADME.md?ref=8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5",
            "patch": "@@ -0,0 +1,125 @@\n+# Conductor Configuration for Next.js\n+\n+This directory contains [Conductor](https://www.conductor.build/) configuration for parallel Claude Code agent development.\n+\n+## What is Conductor?\n+\n+Conductor is a macOS application that orchestrates multiple Claude Code agents in parallel. Each agent gets its own isolated git worktree, enabling concurrent development on different features without branch conflicts.\n+\n+## Directory Structure\n+\n+```\n+.conductor/\n+‚îú‚îÄ‚îÄ conductor.json      # Main configuration (used for new workspaces)\n+‚îú‚îÄ‚îÄ README.md           # This file\n+‚îú‚îÄ‚îÄ scripts/\n+‚îÇ   ‚îú‚îÄ‚îÄ setup.sh        # Runs on workspace creation\n+‚îÇ   ‚îî‚îÄ‚îÄ run.sh          # Runs when starting work\n+‚îî‚îÄ‚îÄ <workspace>/        # Individual workspace directories (git worktrees, gitignored)\n+```\n+\n+## Configuration\n+\n+### Main Configuration (`conductor.json`)\n+\n+The root `conductor.json` defines:\n+\n+- **`scripts.setup`**: Runs when creating a new workspace\n+  - Enables corepack for pnpm\n+  - Validates Node.js version (18+)\n+  - Installs dependencies with `pnpm install`\n+  - Builds all packages with `pnpm build`\n+\n+- **`scripts.run`**: Runs when starting work in a workspace\n+  - Starts watch mode (`pnpm --filter=next dev`) for fast iteration\n+\n+- **`environment`**: Environment variables for all workspaces\n+  - Disables telemetry for cleaner development\n+\n+- **`worktree`**: Git worktree configuration\n+  - Default branch to create worktrees from\n+\n+## Usage\n+\n+### Creating a New Workspace\n+\n+In the Conductor app:\n+1. Add this repository\n+2. Create a new workspace with a descriptive name\n+3. The setup script will automatically install dependencies and build\n+\n+### Manual Worktree Setup\n+\n+If setting up worktrees manually (without Conductor app):\n+\n+```bash\n+# Create a new worktree from canary\n+git worktree add ../next.js-worktrees/my-feature -b my-feature-branch canary\n+\n+# Navigate to the worktree\n+cd ../next.js-worktrees/my-feature\n+\n+# Run the setup script (same script Conductor uses)\n+./.conductor/scripts/setup.sh\n+\n+# Or manually:\n+# pnpm install --prefer-offline\n+# pnpm build\n+```\n+\n+## Managing Worktrees\n+\n+View all worktrees:\n+```bash\n+git worktree list\n+```\n+\n+## Best Practices\n+\n+### Disk Space Management\n+- Each worktree uses ~500MB-1GB after build\n+- Run `pnpm sweep` periodically to clean Rust build artifacts\n+- Remove unused worktrees with `git worktree remove <path>`\n+\n+### Development Workflow\n+1. **Never run `pnpm build` while `pnpm dev` is active** (causes build corruption)\n+2. Use `pnpm test-dev-turbo` for fastest test iteration\n+3. Use `NEXT_SKIP_ISOLATE=1` for faster test runs during development\n+\n+### Parallel Agent Recommendations\n+- Limit to 3-4 concurrent agents to avoid:\n+  - GitHub API rate limits\n+  - Disk space exhaustion\n+  - System resource contention\n+\n+## Troubleshooting\n+\n+### Build Corruption\n+If builds become corrupted:\n+```bash\n+# Kill any running dev processes\n+pkill -f \"pnpm dev\"\n+\n+# Clean and rebuild\n+pnpm clean\n+pnpm install\n+pnpm build\n+```\n+\n+### Worktree Issues\n+```bash\n+# List worktrees with status\n+git worktree list\n+\n+# Prune stale worktree references\n+git worktree prune\n+\n+# Remove a worktree\n+git worktree remove <path>\n+```\n+\n+## Related Documentation\n+\n+- [Conductor App](https://www.conductor.build/)\n+- [Git Worktrees](https://git-scm.com/docs/git-worktree)\n+- [Next.js Contributing Guide](../contributing.md)"
        },
        {
            "sha": "0bbfa8c90302935f071cea55743763067040dc8c",
            "filename": ".conductor/conductor.json",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.conductor%2Fconductor.json",
            "raw_url": "https://github.com/vercel/next.js/raw/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.conductor%2Fconductor.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.conductor%2Fconductor.json?ref=8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5",
            "patch": "@@ -0,0 +1,24 @@\n+{\n+  \"name\": \"next.js\",\n+  \"description\": \"Next.js framework development workspace\",\n+  \"scripts\": {\n+    \"setup\": \"./scripts/setup.sh\",\n+    \"run\": \"./scripts/run.sh\"\n+  },\n+  \"worktree\": {\n+    \"default_branch\": \"canary\"\n+  },\n+  \"environment\": {\n+    \"NEXT_TELEMETRY_DISABLED\": \"1\",\n+    \"TURBO_TELEMETRY_DISABLED\": \"1\"\n+  },\n+  \"recommendations\": {\n+    \"parallel_agents\": 3,\n+    \"notes\": [\n+      \"Each worktree uses ~500MB-1GB disk space after build\",\n+      \"Run 'pnpm sweep' periodically to clean Rust build artifacts\",\n+      \"Use 'pnpm test-dev-turbo' for fastest test iteration\",\n+      \"Never run 'pnpm build' while 'pnpm dev' is active (causes corruption)\"\n+    ]\n+  }\n+}"
        },
        {
            "sha": "14f92dc26c877057561ec08451a3aefcd1dc7e72",
            "filename": ".conductor/scripts/run.sh",
            "status": "added",
            "additions": 20,
            "deletions": 0,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.conductor%2Fscripts%2Frun.sh",
            "raw_url": "https://github.com/vercel/next.js/raw/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.conductor%2Fscripts%2Frun.sh",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.conductor%2Fscripts%2Frun.sh?ref=8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5",
            "patch": "@@ -0,0 +1,20 @@\n+#!/bin/bash\n+#\n+# Conductor Run Script for Next.js\n+#\n+# This script runs when starting work in a Conductor workspace.\n+# It starts the watch mode build for fast iteration.\n+#\n+\n+set -e\n+\n+echo \"üöÄ Starting Next.js development environment...\"\n+echo \"\"\n+echo \"Starting watch mode (pnpm --filter=next dev)...\"\n+echo \"This will auto-rebuild on file changes.\"\n+echo \"\"\n+echo \"‚ö†Ô∏è  Remember: Never run 'pnpm build' while this is running!\"\n+echo \"\"\n+\n+# Start the watch mode build for the next package\n+pnpm --filter=next dev"
        },
        {
            "sha": "adf275a5a009d1de386ed720ddbaa13bd8be01cc",
            "filename": ".conductor/scripts/setup.sh",
            "status": "added",
            "additions": 41,
            "deletions": 0,
            "changes": 41,
            "blob_url": "https://github.com/vercel/next.js/blob/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.conductor%2Fscripts%2Fsetup.sh",
            "raw_url": "https://github.com/vercel/next.js/raw/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.conductor%2Fscripts%2Fsetup.sh",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.conductor%2Fscripts%2Fsetup.sh?ref=8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5",
            "patch": "@@ -0,0 +1,41 @@\n+#!/bin/bash\n+#\n+# Conductor Setup Script for Next.js\n+#\n+# This script runs when creating a new Conductor workspace.\n+# It ensures the development environment is properly configured.\n+#\n+\n+set -e\n+\n+echo \"üîß Setting up Next.js development environment...\"\n+\n+# Enable corepack for pnpm (requires pnpm 9.6.0)\n+if command -v corepack &> /dev/null; then\n+  echo \"üì¶ Enabling corepack for pnpm...\"\n+  corepack enable pnpm\n+fi\n+\n+# Validate Node.js version\n+NODE_VERSION=$(node -v | cut -d'v' -f2 | cut -d'.' -f1)\n+if [ \"$NODE_VERSION\" -lt 18 ]; then\n+  echo \"‚ùå Node.js 18+ required (found: $(node -v))\"\n+  exit 1\n+fi\n+echo \"‚úì Node.js $(node -v) detected\"\n+\n+# Install dependencies\n+echo \"üì¶ Installing dependencies...\"\n+pnpm install --prefer-offline\n+\n+# Build all packages\n+echo \"üèóÔ∏è Building packages...\"\n+pnpm build\n+\n+echo \"\"\n+echo \"‚úÖ Setup complete! Ready for development.\"\n+echo \"\"\n+echo \"Tips:\"\n+echo \"  ‚Ä¢ Run 'pnpm test-dev-turbo <path>' for fast test iteration\"\n+echo \"  ‚Ä¢ Run 'pnpm --filter=next dev' for watch mode\"\n+echo \"  ‚Ä¢ Run 'pnpm sweep' periodically to clean Rust build artifacts\""
        },
        {
            "sha": "ad9c1fd2ecd62b9ee99cd586f9e0d92a6731f8df",
            "filename": ".gitignore",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.gitignore",
            "raw_url": "https://github.com/vercel/next.js/raw/8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5/.gitignore",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.gitignore?ref=8861f0a4a64ab7fbdff74c7ba4b70c121cd217d5",
            "patch": "@@ -69,3 +69,7 @@ test-timings.json\n .claude/plans/\n .claude/todos.json\n CLAUDE.local.md\n+\n+# Conductor (worktrees created by Conductor app, but keep scripts/)\n+.conductor/*/\n+!.conductor/scripts/"
        }
    ],
    "stats": {
        "total": 214,
        "additions": 214,
        "deletions": 0
    }
}