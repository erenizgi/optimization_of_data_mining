{
    "author": "raunofreiberg",
    "message": "[dev-overlay] Blur fader for scrollable container (#77196)\n\nThe navigation items overlapping with content looks very bad on scroll:\n\n<img width=\"289\" alt=\"IMG_9601\"\nsrc=\"https://github.com/user-attachments/assets/85197dc6-eb7e-4919-be59-bc8b2b6a2e5f\"\n/>\n\n\nThis PR creates a masked fade area that will be visible only when\nscrolling:\n\n\n\nhttps://github.com/user-attachments/assets/99757916-8374-4d79-ac2d-762786608f91\n\n\n\n---\nCloses NDX-982",
    "sha": "0a8d687fe515a187516eba0d891e4f43de2cfd46",
    "files": [
        {
            "sha": "fa329e7965003c8df79c3be5602a93cdbeae38db",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/dialog/dialog.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fdialog.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fdialog.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fdialog.tsx?ref=0a8d687fe515a187516eba0d891e4f43de2cfd46",
            "patch": "@@ -10,7 +10,7 @@ export type DialogProps = {\n   className?: string\n   onClose?: () => void\n   dialogResizerRef?: React.RefObject<HTMLDivElement | null>\n-}\n+} & React.HTMLAttributes<HTMLDivElement>\n \n const CSS_SELECTORS_TO_EXCLUDE_ON_CLICK_OUTSIDE = [\n   '[data-next-mark]',"
        },
        {
            "sha": "252a08f8fb59a3a389a112179544646221e9c222",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/dialog/styles.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 2,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fstyles.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fstyles.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Fdialog%2Fstyles.ts?ref=0a8d687fe515a187516eba0d891e4f43de2cfd46",
            "patch": "@@ -4,7 +4,9 @@ const styles = `\n     --next-dialog-footer-height: var(--size-48);\n     --next-dialog-max-width: 960px;\n     --next-dialog-row-padding: 16px;\n-    --next-dialog-container-padding: 12px;\n+    --next-dialog-padding-x: 12px;\n+    --next-dialog-notch-height: 42px;\n+    --next-dialog-border-width: 1px;\n \n     display: flex;\n     flex-direction: column-reverse;\n@@ -23,24 +25,35 @@ const styles = `\n       opacity: 1;\n       scale: 1;\n     }\n+\n+    [data-nextjs-scroll-fader][data-side=\"top\"] {\n+      left: 1px;\n+      top: calc(var(--next-dialog-notch-height) + var(--next-dialog-border-width));\n+      width: calc(100% - var(--next-dialog-padding-x));\n+      opacity: 0;\n+    }\n   }\n \n   [data-nextjs-dialog] {\n     outline: none;\n     overflow: hidden;\n   }\n+\n   [data-nextjs-dialog]::-webkit-scrollbar {\n     width: 6px;\n     border-radius: 0 0 1rem 1rem;\n     margin-bottom: 1rem;\n   }\n+\n   [data-nextjs-dialog]::-webkit-scrollbar-button {\n     display: none;\n   }\n+\n   [data-nextjs-dialog]::-webkit-scrollbar-track {\n     border-radius: 0 0 1rem 1rem;\n     background-color: var(--color-background-100);\n   }\n+    \n   [data-nextjs-dialog]::-webkit-scrollbar-thumb {\n     border-radius: 1rem;\n     background-color: var(--color-gray-500);\n@@ -71,7 +84,7 @@ const styles = `\n     display: flex;\n     flex-direction: column;\n     position: relative;\n-    padding: 16px 12px;\n+    padding: 16px var(--next-dialog-padding-x);\n   }\n \n   /* Account for the footer height, when present */"
        },
        {
            "sha": "8f5841a385963b17d87782058ee8a015db1c6670",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/dialog/dialog.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdialog%2Fdialog.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdialog%2Fdialog.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Fdialog%2Fdialog.tsx?ref=0a8d687fe515a187516eba0d891e4f43de2cfd46",
            "patch": "@@ -4,7 +4,7 @@ type ErrorOverlayDialogProps = {\n   children?: React.ReactNode\n   onClose?: () => void\n   dialogResizerRef?: React.RefObject<HTMLDivElement | null>\n-}\n+} & React.HTMLAttributes<HTMLDivElement>\n \n export function ErrorOverlayDialog({\n   children,\n@@ -31,7 +31,7 @@ export const DIALOG_STYLES = `\n     -webkit-font-smoothing: antialiased;\n     background: var(--color-background-100);\n     background-clip: padding-box;\n-    border: 1px solid var(--color-gray-400);\n+    border: var(--next-dialog-border-width) solid var(--color-gray-400);\n     border-radius: var(--rounded-xl);\n     box-shadow: var(--shadow-menu);\n     position: relative;"
        },
        {
            "sha": "cea7bea87bb423dbb9bee78cc38c2f4e3f7fc12f",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay-layout/error-overlay-layout.tsx",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-layout%2Ferror-overlay-layout.tsx?ref=0a8d687fe515a187516eba0d891e4f43de2cfd46",
            "patch": "@@ -35,6 +35,7 @@ import type { ErrorBaseProps } from '../error-overlay/error-overlay'\n import type { ReadyRuntimeError } from '../../../../utils/get-error-by-type'\n import { EnvironmentNameLabel } from '../environment-name-label/environment-name-label'\n import { useFocusTrap } from '../dev-tools-indicator/utils'\n+import { Fader } from '../../fader'\n \n interface ErrorOverlayLayoutProps extends ErrorBaseProps {\n   errorMessage: ErrorMessageType\n@@ -82,17 +83,26 @@ export function ErrorOverlayLayout({\n     } as React.CSSProperties,\n   }\n \n+  const faderRef = React.useRef<HTMLDivElement | null>(null)\n   const hasFooter = Boolean(footerMessage || errorCode)\n   const dialogRef = React.useRef<HTMLDivElement | null>(null)\n   useFocusTrap(dialogRef, null, rendered)\n \n+  function onScroll(e: React.UIEvent<HTMLDivElement>) {\n+    if (faderRef.current) {\n+      const opacity = clamp(e.currentTarget.scrollTop / 17, [0, 1])\n+      faderRef.current.style.opacity = String(opacity)\n+    }\n+  }\n+\n   return (\n     <ErrorOverlayOverlay fixed={isBuildError} {...animationProps}>\n       <div data-nextjs-dialog-root ref={dialogRef} {...animationProps}>\n         <ErrorOverlayDialog\n           onClose={onClose}\n           dialogResizerRef={dialogResizerRef}\n           data-has-footer={hasFooter}\n+          onScroll={onScroll}\n         >\n           <DialogContent>\n             <ErrorOverlayDialogHeader>\n@@ -136,11 +146,16 @@ export function ErrorOverlayLayout({\n           versionInfo={versionInfo}\n           isTurbopack={isTurbopack}\n         />\n+        <Fader ref={faderRef} side=\"top\" stop=\"50%\" blur=\"4px\" height={48} />\n       </div>\n     </ErrorOverlayOverlay>\n   )\n }\n \n+function clamp(value: number, [min, max]: [number, number]) {\n+  return Math.min(Math.max(value, min), max)\n+}\n+\n export const styles = `\n   ${OVERLAY_STYLES}\n   ${DIALOG_STYLES}"
        },
        {
            "sha": "d340ea788d78287fba189107f93dc8cca1b1dc13",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/errors/error-overlay-nav/error-overlay-nav.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ferrors%2Ferror-overlay-nav%2Ferror-overlay-nav.tsx?ref=0a8d687fe515a187516eba0d891e4f43de2cfd46",
            "patch": "@@ -43,7 +43,6 @@ export function ErrorOverlayNav({\n \n export const styles = `\n   [data-nextjs-error-overlay-nav] {\n-    --notch-height: 42px;\n     display: flex;\n     justify-content: space-between;\n     align-items: center;\n@@ -60,7 +59,7 @@ export const styles = `\n \n       translate: -1px 0;\n       width: auto;\n-      height: var(--notch-height);\n+      height: var(--next-dialog-notch-height);\n       padding: 12px;\n       background: var(--background-color);\n       border: 1px solid var(--stroke-color);"
        },
        {
            "sha": "16c1a308efc022a134fd57dfaa4c97f7ccf5b121",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/components/fader/index.tsx",
            "status": "added",
            "additions": 59,
            "deletions": 0,
            "changes": 59,
            "blob_url": "https://github.com/vercel/next.js/blob/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ffader%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ffader%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fcomponents%2Ffader%2Findex.tsx?ref=0a8d687fe515a187516eba0d891e4f43de2cfd46",
            "patch": "@@ -0,0 +1,59 @@\n+import type { CSSProperties } from 'react'\n+\n+export function Fader({\n+  stop,\n+  blur,\n+  side,\n+  style,\n+  height,\n+  ref,\n+}: {\n+  stop?: string\n+  blur?: string\n+  height?: number\n+  side: 'top' | 'bottom' | 'left' | 'right'\n+  className?: string\n+  style?: CSSProperties\n+  ref?: React.Ref<HTMLDivElement>\n+}) {\n+  return (\n+    <div\n+      ref={ref}\n+      aria-hidden\n+      data-nextjs-scroll-fader\n+      className=\"nextjs-scroll-fader\"\n+      data-side={side}\n+      style={\n+        {\n+          '--stop': stop,\n+          '--blur': blur,\n+          '--height': `${height}px`,\n+          ...style,\n+        } as React.CSSProperties\n+      }\n+    />\n+  )\n+}\n+\n+export const FADER_STYLES = `\n+  .nextjs-scroll-fader {\n+    --blur: 1px;\n+    --stop: 25%;\n+    --height: 150px;\n+    --color-bg: var(--color-background-100);\n+    position: absolute;\n+    pointer-events: none;\n+    user-select: none;\n+    width: 100%;\n+    height: var(--height);\n+    left: 0;\n+    backdrop-filter: blur(var(--blur));\n+\n+    &[data-side=\"top\"] {\n+      top: 0;\n+      background: linear-gradient(to top, transparent, var(--color-bg));\n+      mask-image: linear-gradient(to bottom, var(--color-bg) var(--stop), transparent);\n+    }\n+  }\n+\n+`"
        },
        {
            "sha": "963a51395efeeb3e5fa6af0aff5c01415de19a41",
            "filename": "packages/next/src/client/components/react-dev-overlay/ui/styles/component-styles.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fstyles%2Fcomponent-styles.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/0a8d687fe515a187516eba0d891e4f43de2cfd46/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fstyles%2Fcomponent-styles.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Freact-dev-overlay%2Fui%2Fstyles%2Fcomponent-styles.tsx?ref=0a8d687fe515a187516eba0d891e4f43de2cfd46",
            "patch": "@@ -21,6 +21,7 @@ import { DEV_TOOLS_INFO_STYLES } from '../components/errors/dev-tools-indicator/\n import { DEV_TOOLS_INFO_TURBOPACK_INFO_STYLES } from '../components/errors/dev-tools-indicator/dev-tools-info/turbopack-info'\n import { DEV_TOOLS_INFO_ROUTE_INFO_STYLES } from '../components/errors/dev-tools-indicator/dev-tools-info/route-info'\n import { DEV_TOOLS_INFO_USER_PREFERENCES_STYLES } from '../components/errors/dev-tools-indicator/dev-tools-info/user-preferences'\n+import { FADER_STYLES } from '../components/fader'\n \n export function ComponentStyles() {\n   return (\n@@ -48,6 +49,7 @@ export function ComponentStyles() {\n         ${DEV_TOOLS_INFO_TURBOPACK_INFO_STYLES}\n         ${DEV_TOOLS_INFO_ROUTE_INFO_STYLES}\n         ${DEV_TOOLS_INFO_USER_PREFERENCES_STYLES}\n+        ${FADER_STYLES}\n       `}\n     </style>\n   )"
        }
    ],
    "stats": {
        "total": 102,
        "additions": 95,
        "deletions": 7
    }
}