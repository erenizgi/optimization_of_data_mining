{
    "author": "eps1lon",
    "message": "[test] Use new Redbox matchers in app/ owner-stack-invalid-element-type (#76786)",
    "sha": "235da189cad2a682d5f4e230111ecfe24cd1a4ca",
    "files": [
        {
            "sha": "4f6f652d7b1f94b45eee6d483073bfba76a3e7dc",
            "filename": "test/development/app-dir/owner-stack-invalid-element-type/owner-stack-invalid-element-type.test.ts",
            "status": "modified",
            "additions": 43,
            "deletions": 54,
            "changes": 97,
            "blob_url": "https://github.com/vercel/next.js/blob/235da189cad2a682d5f4e230111ecfe24cd1a4ca/test%2Fdevelopment%2Fapp-dir%2Fowner-stack-invalid-element-type%2Fowner-stack-invalid-element-type.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/235da189cad2a682d5f4e230111ecfe24cd1a4ca/test%2Fdevelopment%2Fapp-dir%2Fowner-stack-invalid-element-type%2Fowner-stack-invalid-element-type.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fowner-stack-invalid-element-type%2Fowner-stack-invalid-element-type.test.ts?ref=235da189cad2a682d5f4e230111ecfe24cd1a4ca",
            "patch": "@@ -1,9 +1,4 @@\n import { nextTestSetup } from 'e2e-utils'\n-import {\n-  assertHasRedbox,\n-  getRedboxSource,\n-  getStackFramesContent,\n-} from 'next-test-utils'\n \n describe('app-dir - owner-stack-invalid-element-type', () => {\n   const { next } = nextTestSetup({\n@@ -13,73 +8,67 @@ describe('app-dir - owner-stack-invalid-element-type', () => {\n   it('should catch invalid element from a browser only component', async () => {\n     const browser = await next.browser('/browser')\n \n-    await assertHasRedbox(browser)\n-    const source = await getRedboxSource(browser)\n+    await expect(browser).toDisplayRedbox(`\n+     {\n+       \"count\": 1,\n+       \"description\": \"Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: object. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\n \n-    const stackFramesContent = await getStackFramesContent(browser)\n-    expect(stackFramesContent).toMatchInlineSnapshot(`\n-     \"at BrowserOnly (app/browser/browser-only.js (8:7))\n-     at Inner (app/browser/page.js (11:10))\n-     at Page (app/browser/page.js (15:10))\"\n-    `)\n-    expect(source).toMatchInlineSnapshot(`\n-     \"app/browser/browser-only.js (8:7) @ BrowserOnly\n-\n-        6 |   return (\n-        7 |     <div>\n+     Check the render method of \\`BrowserOnly\\`.\",\n+       \"environmentLabel\": null,\n+       \"label\": \"Unhandled Runtime Error\",\n+       \"source\": \"app/browser/browser-only.js (8:7) @ BrowserOnly\n      >  8 |       <Foo />\n-          |       ^\n-        9 |     </div>\n-       10 |   )\n-       11 | }\"\n+          |       ^\",\n+       \"stack\": [\n+         \"BrowserOnly app/browser/browser-only.js (8:7)\",\n+         \"Inner app/browser/page.js (11:10)\",\n+         \"Page app/browser/page.js (15:10)\",\n+       ],\n+     }\n     `)\n   })\n \n   it('should catch invalid element from a rsc component', async () => {\n     const browser = await next.browser('/rsc')\n \n-    await assertHasRedbox(browser)\n-    const stackFramesContent = await getStackFramesContent(browser)\n-    const source = await getRedboxSource(browser)\n-\n-    expect(stackFramesContent).toMatchInlineSnapshot(`\n-     \"at Inner (app/rsc/page.js (5:10))\n-     at Page (app/rsc/page.js (11:7))\"\n-    `)\n-    expect(source).toMatchInlineSnapshot(`\n-     \"app/rsc/page.js (5:10) @ Inner\n+    await expect(browser).toDisplayRedbox(`\n+     {\n+       \"count\": 1,\n+       \"description\": \"Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: object. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\n \n-       3 | // Intermediate component for testing owner stack\n-       4 | function Inner() {\n+     Check the render method of \\`Inner\\`.\",\n+       \"environmentLabel\": null,\n+       \"label\": \"Unhandled Runtime Error\",\n+       \"source\": \"app/rsc/page.js (5:10) @ Inner\n      > 5 |   return <Foo />\n-         |          ^\n-       6 | }\n-       7 |\n-       8 | export default function Page() {\"\n+         |          ^\",\n+       \"stack\": [\n+         \"Inner app/rsc/page.js (5:10)\",\n+         \"Page app/rsc/page.js (11:7)\",\n+       ],\n+     }\n     `)\n   })\n \n   it('should catch invalid element from on ssr client component', async () => {\n     const browser = await next.browser('/ssr')\n \n-    await assertHasRedbox(browser)\n-\n-    const stackFramesContent = await getStackFramesContent(browser)\n-    const source = await getRedboxSource(browser)\n-    expect(stackFramesContent).toMatchInlineSnapshot(`\n-     \"at Inner (app/ssr/page.js (7:10))\n-     at Page (app/ssr/page.js (13:7))\"\n-    `)\n-    expect(source).toMatchInlineSnapshot(`\n-     \"app/ssr/page.js (7:10) @ Inner\n+    await expect(browser).toDisplayRedbox(`\n+     {\n+       \"count\": 1,\n+       \"description\": \"Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: object. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\n \n-        5 | // Intermediate component for testing owner stack\n-        6 | function Inner() {\n+     Check the render method of \\`Inner\\`.\",\n+       \"environmentLabel\": null,\n+       \"label\": \"Unhandled Runtime Error\",\n+       \"source\": \"app/ssr/page.js (7:10) @ Inner\n      >  7 |   return <Foo />\n-          |          ^\n-        8 | }\n-        9 |\n-       10 | export default function Page() {\"\n+          |          ^\",\n+       \"stack\": [\n+         \"Inner app/ssr/page.js (7:10)\",\n+         \"Page app/ssr/page.js (13:7)\",\n+       ],\n+     }\n     `)\n   })\n })"
        }
    ],
    "stats": {
        "total": 97,
        "additions": 43,
        "deletions": 54
    }
}