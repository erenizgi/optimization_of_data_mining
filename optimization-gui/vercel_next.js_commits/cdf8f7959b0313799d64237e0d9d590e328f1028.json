{
    "author": "eps1lon",
    "message": "Enable React's default Transition indicator behind a flag (#86000)",
    "sha": "cdf8f7959b0313799d64237e0d9d590e328f1028",
    "files": [
        {
            "sha": "ba44eb1cca54f3971621e5760a90adfdefd6a7bd",
            "filename": "crates/next-core/src/next_config.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_config.rs?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -870,6 +870,7 @@ pub struct ExperimentalConfig {\n     /// Enables source maps generation for the server production bundle.\n     server_source_maps: Option<bool>,\n     swc_trace_profiling: Option<bool>,\n+    transition_indicator: Option<bool>,\n     /// @internal Used by the Next.js internals only.\n     trust_host_header: Option<bool>,\n \n@@ -1674,6 +1675,11 @@ impl NextConfig {\n         Vc::cell(self.experimental.taint.unwrap_or(false))\n     }\n \n+    #[turbo_tasks::function]\n+    pub fn enable_transition_indicator(&self) -> Vc<bool> {\n+        Vc::cell(self.experimental.transition_indicator.unwrap_or(false))\n+    }\n+\n     #[turbo_tasks::function]\n     pub fn enable_cache_components(&self) -> Vc<bool> {\n         Vc::cell(self.cache_components.unwrap_or(false))"
        },
        {
            "sha": "1dfff0b01b34f33d6a0cfa7c5fbac9acd410b503",
            "filename": "crates/next-core/src/next_import_map.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 8,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/crates%2Fnext-core%2Fsrc%2Fnext_import_map.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/crates%2Fnext-core%2Fsrc%2Fnext_import_map.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_import_map.rs?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -128,7 +128,9 @@ pub async fn get_next_client_import_map(\n         ClientContextType::Pages { .. } => {}\n         ClientContextType::App { app_dir } => {\n             // Keep in sync with file:///./../../../packages/next/src/lib/needs-experimental-react.ts\n-            let react_flavor = if *next_config.enable_taint().await? {\n+            let taint = *next_config.enable_taint().await?;\n+            let transition_indicator = *next_config.enable_transition_indicator().await?;\n+            let react_channel = if taint || transition_indicator {\n                 \"-experimental\"\n             } else {\n                 \"\"\n@@ -138,21 +140,21 @@ pub async fn get_next_client_import_map(\n                 rcstr!(\"react\"),\n                 request_to_import_mapping(\n                     app_dir.clone(),\n-                    format!(\"next/dist/compiled/react{react_flavor}\").into(),\n+                    format!(\"next/dist/compiled/react{react_channel}\").into(),\n                 ),\n             );\n             import_map.insert_wildcard_alias(\n                 rcstr!(\"react/\"),\n                 request_to_import_mapping(\n                     app_dir.clone(),\n-                    format!(\"next/dist/compiled/react{react_flavor}/*\").into(),\n+                    format!(\"next/dist/compiled/react{react_channel}/*\").into(),\n                 ),\n             );\n             import_map.insert_exact_alias(\n                 rcstr!(\"react-dom\"),\n                 request_to_import_mapping(\n                     app_dir.clone(),\n-                    format!(\"next/dist/compiled/react-dom{react_flavor}\").into(),\n+                    format!(\"next/dist/compiled/react-dom{react_channel}\").into(),\n                 ),\n             );\n             import_map.insert_exact_alias(\n@@ -181,15 +183,15 @@ pub async fn get_next_client_import_map(\n                 rcstr!(\"react-dom/client\"),\n                 request_to_import_mapping(\n                     app_dir.clone(),\n-                    format!(\"next/dist/compiled/react-dom{react_flavor}/{react_client_package}\")\n+                    format!(\"next/dist/compiled/react-dom{react_channel}/{react_client_package}\")\n                         .into(),\n                 ),\n             );\n             import_map.insert_wildcard_alias(\n                 rcstr!(\"react-dom/\"),\n                 request_to_import_mapping(\n                     app_dir.clone(),\n-                    format!(\"next/dist/compiled/react-dom{react_flavor}/*\").into(),\n+                    format!(\"next/dist/compiled/react-dom{react_channel}/*\").into(),\n                 ),\n             );\n             import_map.insert_wildcard_alias(\n@@ -200,7 +202,8 @@ pub async fn get_next_client_import_map(\n                 rcstr!(\"react-server-dom-turbopack/\"),\n                 request_to_import_mapping(\n                     app_dir.clone(),\n-                    format!(\"next/dist/compiled/react-server-dom-turbopack{react_flavor}/*\").into(),\n+                    format!(\"next/dist/compiled/react-server-dom-turbopack{react_channel}/*\")\n+                        .into(),\n                 ),\n             );\n             insert_exact_alias_or_js(\n@@ -830,7 +833,12 @@ async fn apply_vendored_react_aliases_server(\n     next_config: Vc<NextConfig>,\n ) -> Result<()> {\n     let taint = *next_config.enable_taint().await?;\n-    let react_channel = if taint { \"-experimental\" } else { \"\" };\n+    let transition_indicator = *next_config.enable_transition_indicator().await?;\n+    let react_channel = if taint || transition_indicator {\n+        \"-experimental\"\n+    } else {\n+        \"\"\n+    };\n     let react_condition = if ty.should_use_react_server_condition() {\n         \"server\"\n     } else {"
        },
        {
            "sha": "3cb419e5bb26453c49fdc31fc38ebd4450f9297c",
            "filename": "packages/next/src/build/define-env.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -328,6 +328,8 @@ export function getDefineEnv({\n       (config.experimental.turbopackFileSystemCacheForDev ?? false),\n     'process.env.__NEXT_REACT_DEBUG_CHANNEL':\n       config.experimental.reactDebugChannel ?? false,\n+    'process.env.__NEXT_TRANSITION_INDICATOR':\n+      config.experimental.transitionIndicator ?? false,\n   }\n \n   const userDefines = config.compiler?.define ?? {}"
        },
        {
            "sha": "f3abd63f24c88c6cc700bcaaa87990871163b179",
            "filename": "packages/next/src/client/app-index.tsx",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -270,14 +270,17 @@ function Root({ children }: React.PropsWithChildren<{}>) {\n   return children\n }\n \n-function onDefaultTransitionIndicator() {\n-  // TODO: Compose default with user-configureable (e.g. nprogress)\n-  // TODO: Use React's default once we figure out hanging indicators: https://codesandbox.io/p/sandbox/charming-moon-hktkp6?file=%2Fsrc%2Findex.js%3A106%2C30\n+const enableTransitionIndicator = process.env.__NEXT_TRANSITION_INDICATOR\n+\n+function noDefaultTransitionIndicator() {\n   return () => {}\n }\n \n const reactRootOptions: ReactDOMClient.RootOptions = {\n-  onDefaultTransitionIndicator: onDefaultTransitionIndicator,\n+  onDefaultTransitionIndicator: enableTransitionIndicator\n+    ? // TODO: Compose default with user-configureable (e.g. nprogress)\n+      undefined\n+    : noDefaultTransitionIndicator,\n   onRecoverableError,\n   onCaughtError,\n   onUncaughtError,"
        },
        {
            "sha": "76ca008a2df19bb7045a118f7e76f1151d7412c9",
            "filename": "packages/next/src/client/components/app-router.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fapp-router.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fapp-router.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Fapp-router.tsx?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -70,6 +70,7 @@ function HistoryUpdater({\n       renderedSearch,\n     }\n \n+    // TODO: Use Navigation API if available\n     const historyState = {\n       ...(pushRef.preserveCustomHistoryState ? window.history.state : {}),\n       // Identifier is shortened intentionally.\n@@ -328,6 +329,7 @@ function Router({\n       _unused: string,\n       url?: string | URL | null\n     ): void {\n+      // TODO: Warn when Navigation API is available (navigation.navigate() should be used)\n       // Avoid a loop when Next.js internals trigger pushState/replaceState\n       if (data?.__NA || data?._N) {\n         return originalPushState(data, _unused, url)\n@@ -352,6 +354,7 @@ function Router({\n       _unused: string,\n       url?: string | URL | null\n     ): void {\n+      // TODO: Warn when Navigation API is available (navigation.navigate() should be used)\n       // Avoid a loop when Next.js internals trigger pushState/replaceState\n       if (data?.__NA || data?._N) {\n         return originalReplaceState(data, _unused, url)"
        },
        {
            "sha": "b687cf78771e124a6fd233e2f557f16782431b95",
            "filename": "packages/next/src/lib/needs-experimental-react.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Flib%2Fneeds-experimental-react.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Flib%2Fneeds-experimental-react.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fneeds-experimental-react.ts?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -2,6 +2,6 @@ import type { NextConfig } from '../server/config-shared'\n \n // Keep in sync with Turbopack's experimental React switch: file://./../../../../crates/next-core/src/next_import_map.rs\n export function needsExperimentalReact(config: NextConfig) {\n-  const { taint } = config.experimental || {}\n-  return Boolean(taint)\n+  const { taint, transitionIndicator } = config.experimental || {}\n+  return Boolean(taint || transitionIndicator)\n }"
        },
        {
            "sha": "03bfa8b4c0d148dd8d5b88e5e9c6681a290a476d",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -289,6 +289,7 @@ export const experimentalSchema = {\n       }),\n     ])\n     .optional(),\n+  transitionIndicator: z.boolean().optional(),\n   typedRoutes: z.boolean().optional(),\n   webpackBuildWorker: z.boolean().optional(),\n   webpackMemoryOptimizations: z.boolean().optional(),"
        },
        {
            "sha": "fa23ce95f64163c589595832dda7213b9933fff6",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -387,6 +387,12 @@ export interface ExperimentalConfig {\n    */\n   optimizeServerReact?: boolean\n \n+  /**\n+   * Displays an indicator when a React Transition has no other indicator rendered.\n+   * This includes displaying an indicator on client-side navigations.\n+   */\n+  transitionIndicator?: boolean\n+\n   /**\n    * A target memory limit for turbo, in bytes.\n    */\n@@ -1515,6 +1521,7 @@ export const defaultConfig = Object.freeze({\n     serverComponentsHmrCache: true,\n     staticGenerationMaxConcurrency: 8,\n     staticGenerationMinPagesPerWorker: 25,\n+    transitionIndicator: false,\n     inlineCss: false,\n     useCache: undefined,\n     slowModuleDetection: undefined,"
        },
        {
            "sha": "8c756a7d32a4846fc7d5fbad86cb8cf1b9f8d6b8",
            "filename": "packages/next/src/server/config.ts",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig.ts?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -1863,6 +1863,24 @@ function enforceExperimentalFeatures(\n     }\n   }\n \n+  if (\n+    process.env.__NEXT_EXPERIMENTAL_TRANSITION_INDICATOR === 'true' &&\n+    // We do respect an explicit value in the user config.\n+    (config.experimental.transitionIndicator === undefined ||\n+      (isDefaultConfig && !config.experimental.transitionIndicator))\n+  ) {\n+    config.experimental.transitionIndicator = true\n+\n+    if (configuredExperimentalFeatures) {\n+      addConfiguredExperimentalFeature(\n+        configuredExperimentalFeatures,\n+        'transitionIndicator',\n+        true,\n+        'enabled by `__NEXT_EXPERIMENTAL_TRANSITION_INDICATOR`'\n+      )\n+    }\n+  }\n+\n   if (\n     process.env.__NEXT_ENABLE_REACT_COMPILER === 'true' &&\n     // We do respect an explicit value in the user config."
        },
        {
            "sha": "2adcd343c93e3cd630d4610a44669bf2c2c3edb6",
            "filename": "test/e2e/app-dir/transition-indicator/app/layout.tsx",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Flayout.tsx?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -0,0 +1,26 @@\n+import Link from 'next/link'\n+import { ReactNode, Suspense } from 'react'\n+export default function Root({ children }: { children: ReactNode }) {\n+  return (\n+    <html>\n+      <body>\n+        <ul>\n+          <li>\n+            <Link href=\"/\">Home</Link>\n+          </li>\n+          <li>\n+            <Link href=\"/slow-without-fallback\">\n+              Slow Page without fallback\n+            </Link>\n+          </li>\n+          <li>\n+            <Link href=\"/slow-with-fallback\">Slow Page with fallback</Link>\n+          </li>\n+        </ul>\n+        <main>\n+          <Suspense>{children}</Suspense>\n+        </main>\n+      </body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "8b1588312bacee15ce61a21a815c98415e661766",
            "filename": "test/e2e/app-dir/transition-indicator/app/page.tsx",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fpage.tsx?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -0,0 +1,26 @@\n+'use client'\n+\n+import { startTransition, useReducer } from 'react'\n+\n+function sleep(ms: number) {\n+  return new Promise((resolve) => setTimeout(resolve, ms))\n+}\n+\n+export default function Page() {\n+  const [counter, increment] = useReducer((n) => n + 1, 0)\n+\n+  function handleClick() {\n+    startTransition(async () => {\n+      await sleep(1000)\n+      startTransition(() => {\n+        increment()\n+      })\n+    })\n+  }\n+  return (\n+    <>\n+      <p>Count: {counter}</p>\n+      <button onClick={handleClick}>Increment</button>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "d8e298d08dd5f1ed21083b365ba839270673ee6e",
            "filename": "test/e2e/app-dir/transition-indicator/app/slow-with-fallback/loading.tsx",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fslow-with-fallback%2Floading.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fslow-with-fallback%2Floading.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fslow-with-fallback%2Floading.tsx?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -0,0 +1,3 @@\n+export default function SlowFallback() {\n+  return <p>While waiting, enjoy Next.js' navigation indicator.</p>\n+}"
        },
        {
            "sha": "1fd7493e3c4c915d8e107f2883c7e434d8411a2b",
            "filename": "test/e2e/app-dir/transition-indicator/app/slow-with-fallback/page.tsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fslow-with-fallback%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fslow-with-fallback%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fslow-with-fallback%2Fpage.tsx?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -0,0 +1,7 @@\n+import { setTimeout } from 'timers/promises'\n+\n+export default async function SlowPage() {\n+  await setTimeout(2000)\n+\n+  return <p>Hello, Dave!</p>\n+}"
        },
        {
            "sha": "1fd7493e3c4c915d8e107f2883c7e434d8411a2b",
            "filename": "test/e2e/app-dir/transition-indicator/app/slow-without-fallback/page.tsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fslow-without-fallback%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fslow-without-fallback%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fapp%2Fslow-without-fallback%2Fpage.tsx?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -0,0 +1,7 @@\n+import { setTimeout } from 'timers/promises'\n+\n+export default async function SlowPage() {\n+  await setTimeout(2000)\n+\n+  return <p>Hello, Dave!</p>\n+}"
        },
        {
            "sha": "01741dba7a81a161d81956a2592a86e3f7ddc0ca",
            "filename": "test/e2e/app-dir/transition-indicator/next.config.js",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Fnext.config.js?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -0,0 +1,10 @@\n+/**\n+ * @type {import('next').NextConfig}\n+ */\n+const nextConfig = {\n+  experimental: {\n+    transitionIndicator: true,\n+  },\n+}\n+\n+module.exports = nextConfig"
        },
        {
            "sha": "a4ac69eb360770de1fefd7dd48faf96cbc581d44",
            "filename": "test/e2e/app-dir/transition-indicator/transition-indicator.test.ts",
            "status": "added",
            "additions": 36,
            "deletions": 0,
            "changes": 36,
            "blob_url": "https://github.com/vercel/next.js/blob/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Ftransition-indicator.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/cdf8f7959b0313799d64237e0d9d590e328f1028/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Ftransition-indicator.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ftransition-indicator%2Ftransition-indicator.test.ts?ref=cdf8f7959b0313799d64237e0d9d590e328f1028",
            "patch": "@@ -0,0 +1,36 @@\n+import { nextTestSetup } from 'e2e-utils'\n+\n+describe('transition-indicator', () => {\n+  const { next } = nextTestSetup({\n+    files: __dirname,\n+  })\n+\n+  // TODO: Find testing pattern to assert that the browser's pending indicator is shown\n+  // These tests are just instructions for manual testing\n+\n+  it('displays while loading content without fallback', async () => {\n+    const browser = await next.browser('/')\n+\n+    await browser.elementByCss('a[href=\"/slow-without-fallback\"]').click()\n+\n+    // shows pending indicator in browser tab while loading\n+    // Gets stuck due to usage of history.pushState\n+  })\n+\n+  it('does not display while loading content with fallback', async () => {\n+    const browser = await next.browser('/')\n+\n+    await browser.elementByCss('a[href=\"/slow-with-fallback\"]').click()\n+\n+    // fallback is shown, no pending indicator in browser tab\n+  })\n+\n+  it('displays during any Transition that does not commit a pending state', async () => {\n+    const browser = await next.browser('/')\n+\n+    const button = await browser.elementByCss('button')\n+    await button.click()\n+\n+    // shows pending indicator in browser tab until increment is committed\n+  })\n+})"
        }
    ],
    "stats": {
        "total": 191,
        "additions": 177,
        "deletions": 14
    }
}