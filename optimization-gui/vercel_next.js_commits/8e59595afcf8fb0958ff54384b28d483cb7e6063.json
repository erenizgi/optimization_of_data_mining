{
    "author": "huozhi",
    "message": "[metadata] remove dead code of metadata routes handling (#77336)\n\n### What\r\n\r\n- `[].[ext]` was temporary convention invented in a PR but we never decided to go that way. Remove the tests for it\r\n- `dynamicExtensions` can be either empty array or null, for both case it can skip adding the regex for it. This just saves some bytes for generated regex. Also added some test",
    "sha": "8e59595afcf8fb0958ff54384b28d483cb7e6063",
    "files": [
        {
            "sha": "3e72081d52cdc314dfbc30fb4c290a0fbe8df899",
            "filename": "packages/next/src/lib/metadata/is-metadata-route.test.ts",
            "status": "modified",
            "additions": 17,
            "deletions": 6,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/8e59595afcf8fb0958ff54384b28d483cb7e6063/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fis-metadata-route.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/8e59595afcf8fb0958ff54384b28d483cb7e6063/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fis-metadata-route.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fis-metadata-route.test.ts?ref=8e59595afcf8fb0958ff54384b28d483cb7e6063",
            "patch": "@@ -19,15 +19,26 @@ describe('getExtensionRegexString', () => {\n       expect(regex.test('.js')).toBe(false)\n     })\n \n-    it('should match dynamic multi-routes with dynamic extensions', () => {\n-      const regex = createExtensionMatchRegex(['png'], ['ts'])\n+    it('should not handle js extensions with empty dynamic extensions', () => {\n+      const regex = createExtensionMatchRegex(['png', 'jpg'], [])\n       expect(regex.test('.png')).toBe(true)\n-      expect(regex.test('[].png')).toBe(false)\n+      expect(regex.test('.jpg')).toBe(true)\n+      expect(regex.test('.webp')).toBe(false)\n \n-      expect(regex.test('.ts')).toBe(true)\n-      expect(regex.test('[].ts')).toBe(true)\n+      expect(regex.test('.ts')).toBe(false)\n       expect(regex.test('.tsx')).toBe(false)\n-      expect(regex.test('[].tsx')).toBe(false)\n+      expect(regex.test('.js')).toBe(false)\n+    })\n+\n+    it('should not handle js extensions with passing null for dynamic extensions', () => {\n+      const regex = createExtensionMatchRegex(['png', 'jpg'], null)\n+      expect(regex.test('.png')).toBe(true)\n+      expect(regex.test('.jpg')).toBe(true)\n+      expect(regex.test('.webp')).toBe(false)\n+\n+      expect(regex.test('.ts')).toBe(false)\n+      expect(regex.test('.tsx')).toBe(false)\n+      expect(regex.test('.js')).toBe(false)\n     })\n   })\n "
        },
        {
            "sha": "6cd6088092a627feb3e3951b2d7426f1a4e48e84",
            "filename": "packages/next/src/lib/metadata/is-metadata-route.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/8e59595afcf8fb0958ff54384b28d483cb7e6063/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fis-metadata-route.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/8e59595afcf8fb0958ff54384b28d483cb7e6063/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fis-metadata-route.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Flib%2Fmetadata%2Fis-metadata-route.ts?ref=8e59595afcf8fb0958ff54384b28d483cb7e6063",
            "patch": "@@ -31,13 +31,13 @@ const defaultExtensions = ['js', 'jsx', 'ts', 'tsx']\n \n // Match the file extension with the dynamic multi-routes extensions\n // e.g. ([xml, js], null) -> can match `/sitemap.xml/route`, `sitemap.js/route`\n-// e.g. ([png], [ts]) -> can match `/opengrapg-image.png/route`, `/opengraph-image.ts[]/route`\n+// e.g. ([png], [ts]) -> can match `/opengrapg-image.png`, `/opengraph-image.ts`\n export const getExtensionRegexString = (\n   staticExtensions: readonly string[],\n   dynamicExtensions: readonly string[] | null\n ) => {\n   // If there's no possible multi dynamic routes, will not match any <name>[].<ext> files\n-  if (!dynamicExtensions) {\n+  if (!dynamicExtensions || dynamicExtensions.length === 0) {\n     return `\\\\.(?:${staticExtensions.join('|')})`\n   }\n   return `(?:\\\\.(${staticExtensions.join('|')})|((\\\\[\\\\])?\\\\.(${dynamicExtensions.join('|')})))`"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 19,
        "deletions": 8
    }
}