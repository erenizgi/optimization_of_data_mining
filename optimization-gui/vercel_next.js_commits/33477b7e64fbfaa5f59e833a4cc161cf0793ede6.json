{
    "author": "huozhi",
    "message": "[segment-explorer] display the builtin conventions (#80961)\n\nTrack built-in conventions in segment explorer. The default `global-not-found.js` and `global-error.js` will be displayed.\r\nTheir style will be different to the others, we'll follow up in the later PRs.\r\n\r\nCloses NEXT-4576",
    "sha": "33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
    "files": [
        {
            "sha": "288606924a56b8e2fd00c0984682df248da73f10",
            "filename": "crates/next-core/src/app_structure.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/crates%2Fnext-core%2Fsrc%2Fapp_structure.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/crates%2Fnext-core%2Fsrc%2Fapp_structure.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fapp_structure.rs?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -931,6 +931,14 @@ async fn directory_tree_to_loader_tree_internal(\n                     .await?,\n             );\n         }\n+        if modules.global_error.is_none() {\n+            modules.global_error = Some(\n+                get_next_package(app_dir)\n+                    .join(rcstr!(\"dist/client/components/builtin/global-error.js\"))\n+                    .to_resolved()\n+                    .await?,\n+            );\n+        }\n     }\n \n     let mut tree = AppPageLoaderTree {"
        },
        {
            "sha": "3faeb7ce4068b2b2b9a385819bec8d1366d66380",
            "filename": "packages/next/src/build/webpack/loaders/next-app-loader/index.ts",
            "status": "modified",
            "additions": 31,
            "deletions": 23,
            "changes": 54,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-app-loader%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-app-loader%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-app-loader%2Findex.ts?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -159,8 +159,8 @@ async function createTreeCodeFromPath(\n   const pages: string[] = []\n \n   let rootLayout: string | undefined\n-  let globalError: string | undefined\n-  let globalNotFound: string | undefined\n+  let globalError: string = defaultGlobalErrorPath\n+  let globalNotFound: string = defaultNotFoundPath\n \n   async function resolveAdjacentParallelSegments(\n     segmentPath: string\n@@ -303,6 +303,33 @@ async function createTreeCodeFromPath(\n         })\n       )\n \n+      // Only resolve global-* convention files at the root layer\n+      if (isRootLayer) {\n+        const resolvedGlobalErrorPath = await resolver(\n+          `${appDirPrefix}/${GLOBAL_ERROR_FILE_TYPE}`\n+        )\n+        if (resolvedGlobalErrorPath) {\n+          globalError = resolvedGlobalErrorPath\n+        }\n+        // Add global-error to root layer's filePaths, so that it's always available,\n+        // by default it's the built-in global-error.js\n+        filePaths.push([GLOBAL_ERROR_FILE_TYPE, globalError])\n+\n+        // TODO(global-not-found): remove this flag assertion condition\n+        //  once global-not-found is stable\n+        if (isGlobalNotFoundEnabled) {\n+          const resolvedGlobalNotFoundPath = await resolver(\n+            `${appDirPrefix}/${GLOBAL_NOT_FOUND_FILE_TYPE}`\n+          )\n+          if (resolvedGlobalNotFoundPath) {\n+            globalNotFound = resolvedGlobalNotFoundPath\n+          }\n+          // Add global-not-found to root layer's filePaths, so that it's always available,\n+          // by default it's the built-in global-not-found.js\n+          filePaths.push([GLOBAL_NOT_FOUND_FILE_TYPE, globalNotFound])\n+        }\n+      }\n+\n       let definedFilePaths = filePaths.filter(\n         ([, filePath]) => filePath !== undefined\n       ) as [ValueOf<typeof FILE_TYPES>, string][]\n@@ -361,25 +388,6 @@ async function createTreeCodeFromPath(\n         }\n       }\n \n-      if (!globalError) {\n-        const resolvedGlobalErrorPath = await resolver(\n-          `${appDirPrefix}/${GLOBAL_ERROR_FILE_TYPE}`\n-        )\n-        if (resolvedGlobalErrorPath) {\n-          globalError = resolvedGlobalErrorPath\n-        }\n-      }\n-      // TODO(global-not-found): remove this flag assertion condition\n-      //  once global-not-found is stable\n-      if (isGlobalNotFoundEnabled && !globalNotFound) {\n-        const resolvedGlobalNotFoundPath = await resolver(\n-          `${appDirPrefix}/${GLOBAL_NOT_FOUND_FILE_TYPE}`\n-        )\n-        if (resolvedGlobalNotFoundPath) {\n-          globalNotFound = resolvedGlobalNotFoundPath\n-        }\n-      }\n-\n       let parallelSegmentKey = Array.isArray(parallelSegment)\n         ? parallelSegment[0]\n         : parallelSegment\n@@ -523,8 +531,8 @@ async function createTreeCodeFromPath(\n     treeCode: `${treeCode}.children;`,\n     pages: `${JSON.stringify(pages)};`,\n     rootLayout,\n-    globalError: globalError ?? defaultGlobalErrorPath,\n-    globalNotFound: globalNotFound ?? defaultNotFoundPath,\n+    globalError,\n+    globalNotFound,\n   }\n }\n "
        },
        {
            "sha": "8ae0b9c93d290f3428d4655042096e3852edee82",
            "filename": "packages/next/src/server/app-render/app-render.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -97,11 +97,7 @@ import { getRequiredScripts } from './required-scripts'\n import { addPathPrefix } from '../../shared/lib/router/utils/add-path-prefix'\n import { makeGetServerInsertedHTML } from './make-get-server-inserted-html'\n import { walkTreeWithFlightRouterState } from './walk-tree-with-flight-router-state'\n-import {\n-  createComponentTree,\n-  getRootParams,\n-  normalizeConventionFilePath,\n-} from './create-component-tree'\n+import { createComponentTree, getRootParams } from './create-component-tree'\n import { getAssetQueryString } from './get-asset-query-string'\n import {\n   getServerModuleMap,\n@@ -200,6 +196,7 @@ import {\n } from './module-loading/track-module-loading.external'\n import { isReactLargeShellError } from './react-large-shell-error'\n import type { GlobalErrorComponent } from '../../client/components/builtin/global-error'\n+import { normalizeConventionFilePath } from './segment-explorer-path'\n \n export type GetDynamicParamFromSegment = (\n   // [slug] / [[slug]] / [...slug]"
        },
        {
            "sha": "8635a02e473088f4d5870db45ec79ae946cb03b3",
            "filename": "packages/next/src/server/app-render/create-component-tree.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 50,
            "changes": 51,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -26,6 +26,7 @@ import type {\n   UseCachePageComponentProps,\n } from '../use-cache/use-cache-wrapper'\n import { DEFAULT_SEGMENT_KEY } from '../../shared/lib/segment'\n+import { getConventionPathByType } from './segment-explorer-path'\n \n /**\n  * Use the provided loader tree to create the React Component tree.\n@@ -1102,53 +1103,3 @@ async function createBoundaryConventionElement({\n \n   return wrappedElement\n }\n-\n-export function normalizeConventionFilePath(\n-  projectDir: string,\n-  conventionPath: string | undefined\n-) {\n-  const cwd = process.env.NEXT_RUNTIME === 'edge' ? '' : process.cwd()\n-  const nextInternalPrefixRegex =\n-    /^(.*[\\\\/])?next[\\\\/]dist[\\\\/]client[\\\\/]components[\\\\/]builtin[\\\\/]/\n-\n-  let relativePath = (conventionPath || '')\n-    // remove turbopack [project] prefix\n-    .replace(/^\\[project\\][\\\\/]/, '')\n-    // remove the project root from the path\n-    .replace(projectDir, '')\n-    // remove cwd prefix\n-    .replace(cwd, '')\n-    // remove /(src/)?app/ dir prefix\n-    .replace(/^([\\\\/])*(src[\\\\/])?app[\\\\/]/, '')\n-\n-  // If it's internal file only keep the filename, strip nextjs internal prefix\n-  if (nextInternalPrefixRegex.test(relativePath)) {\n-    relativePath = relativePath.replace(nextInternalPrefixRegex, '')\n-  }\n-\n-  return relativePath\n-}\n-\n-function getConventionPathByType(\n-  tree: LoaderTree,\n-  dir: string,\n-  conventionType:\n-    | 'layout'\n-    | 'template'\n-    | 'page'\n-    | 'not-found'\n-    | 'error'\n-    | 'loading'\n-    | 'forbidden'\n-    | 'unauthorized'\n-    | 'defaultPage'\n-) {\n-  const modules = tree[2]\n-  const conventionPath = modules[conventionType]\n-    ? modules[conventionType][1]\n-    : undefined\n-  if (conventionPath) {\n-    return normalizeConventionFilePath(dir, conventionPath)\n-  }\n-  return undefined\n-}"
        },
        {
            "sha": "64259634b7b0ea3a6dbe1993a7cfc89e227ee674",
            "filename": "packages/next/src/server/app-render/segment-explorer-path.ts",
            "status": "added",
            "additions": 51,
            "deletions": 0,
            "changes": 51,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fsegment-explorer-path.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fsegment-explorer-path.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fsegment-explorer-path.ts?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,51 @@\n+import type { LoaderTree } from '../lib/app-dir-module'\n+\n+export function normalizeConventionFilePath(\n+  projectDir: string,\n+  conventionPath: string | undefined\n+) {\n+  const cwd = process.env.NEXT_RUNTIME === 'edge' ? '' : process.cwd()\n+  const nextInternalPrefixRegex =\n+    /^(.*[\\\\/])?next[\\\\/]dist[\\\\/]client[\\\\/]components[\\\\/]builtin[\\\\/]/\n+\n+  let relativePath = (conventionPath || '')\n+    // remove turbopack [project] prefix\n+    .replace(/^\\[project\\][\\\\/]/, '')\n+    // remove the project root from the path\n+    .replace(projectDir, '')\n+    // remove cwd prefix\n+    .replace(cwd, '')\n+    // remove /(src/)?app/ dir prefix\n+    .replace(/^([\\\\/])*(src[\\\\/])?app[\\\\/]/, '')\n+\n+  // If it's internal file only keep the filename, strip nextjs internal prefix\n+  if (nextInternalPrefixRegex.test(relativePath)) {\n+    relativePath = relativePath.replace(nextInternalPrefixRegex, '')\n+  }\n+\n+  return relativePath\n+}\n+\n+export function getConventionPathByType(\n+  tree: LoaderTree,\n+  dir: string,\n+  conventionType:\n+    | 'layout'\n+    | 'template'\n+    | 'page'\n+    | 'not-found'\n+    | 'error'\n+    | 'loading'\n+    | 'forbidden'\n+    | 'unauthorized'\n+    | 'defaultPage'\n+) {\n+  const modules = tree[2]\n+  const conventionPath = modules[conventionType]\n+    ? modules[conventionType][1]\n+    : undefined\n+  if (conventionPath) {\n+    return normalizeConventionFilePath(dir, conventionPath)\n+  }\n+  return undefined\n+}"
        },
        {
            "sha": "6a9c128b350bd8121fe83c9e74708f6a41ce5d21",
            "filename": "test/development/app-dir/segment-explorer-globals/app/global-error.tsx",
            "status": "renamed",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fglobal-error.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fglobal-error.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fglobal-error.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -3,11 +3,9 @@\n export default function GlobalError() {\n   return (\n     <html>\n-      <head>\n-        <title>Global Error</title>\n-      </head>\n       <body>\n         <h1>Global Error</h1>\n+        <p>This is a global error</p>\n       </body>\n     </html>\n   )",
            "previous_filename": "test/development/app-dir/segment-explorer/app/global-error.tsx"
        },
        {
            "sha": "6f4391ef04c46d33a0c74c2afd0ef47ecc8509a8",
            "filename": "test/development/app-dir/segment-explorer-globals/app/global-not-found.tsx",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fglobal-not-found.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fglobal-not-found.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fglobal-not-found.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,10 @@\n+export default function GlobalNotFound() {\n+  return (\n+    <html>\n+      <body>\n+        <h1>404</h1>\n+        <p>Not Found Page</p>\n+      </body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "a14e64fcd5e33e9399d0e823434b0ab3095d5b75",
            "filename": "test/development/app-dir/segment-explorer-globals/app/layout.tsx",
            "status": "added",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Flayout.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,16 @@\n+export const metadata = {\n+  title: 'Next.js',\n+  description: 'Generated by Next.js',\n+}\n+\n+export default function RootLayout({\n+  children,\n+}: {\n+  children: React.ReactNode\n+}) {\n+  return (\n+    <html lang=\"en\">\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "cfabfcc499b4c294e7787ae7fc3daa2660092a1a",
            "filename": "test/development/app-dir/segment-explorer-globals/app/page.tsx",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fpage.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,26 @@\n+import Link from 'next/link'\n+\n+const hrefs = [\n+  '/parallel-routes',\n+  '/blog/~/grid',\n+  '/soft-navigation/a',\n+  '/file-segments',\n+  '/parallel-default',\n+  '/parallel-default/subroute',\n+]\n+\n+export default function Page() {\n+  return (\n+    <div>\n+      <h1>Segment Explorer</h1>\n+      <p>Examples</p>\n+      <div>\n+        {hrefs.map((href) => (\n+          <div key={href}>\n+            <Link href={href}>{href}</Link>\n+          </div>\n+        ))}\n+      </div>\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "4e2022b1f3f913619f2ac544e2d1d4a36900bdcd",
            "filename": "test/development/app-dir/segment-explorer-globals/app/runtime-error/boundary/error.css",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fboundary%2Ferror.css",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fboundary%2Ferror.css",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fboundary%2Ferror.css?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,5 @@\n+.error-title {\n+  color: red;\n+  font-size: 24px;\n+  font-weight: bold;\n+}"
        },
        {
            "sha": "bfd34c3e71c2c5ee079843be9709183955cdea8a",
            "filename": "test/development/app-dir/segment-explorer-globals/app/runtime-error/boundary/error.tsx",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fboundary%2Ferror.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fboundary%2Ferror.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fboundary%2Ferror.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,7 @@\n+'use client'\n+\n+import './error.css'\n+\n+export default function CustomError() {\n+  return <h2 className=\"error-title\">Custom Error</h2>\n+}"
        },
        {
            "sha": "22b2c3e4065c2a9d4bdf4f2f0bd0b6c6547470a6",
            "filename": "test/development/app-dir/segment-explorer-globals/app/runtime-error/boundary/page.tsx",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fboundary%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fboundary%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fboundary%2Fpage.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,8 @@\n+'use client'\n+\n+export default function Page() {\n+  if (typeof window !== 'undefined') {\n+    throw new Error('Error on client')\n+  }\n+  return <p>page</p>\n+}"
        },
        {
            "sha": "22b2c3e4065c2a9d4bdf4f2f0bd0b6c6547470a6",
            "filename": "test/development/app-dir/segment-explorer-globals/app/runtime-error/page.tsx",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fapp%2Fruntime-error%2Fpage.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,8 @@\n+'use client'\n+\n+export default function Page() {\n+  if (typeof window !== 'undefined') {\n+    throw new Error('Error on client')\n+  }\n+  return <p>page</p>\n+}"
        },
        {
            "sha": "8a5b5c187d4e41d783952059e7a8e6f2796c2632",
            "filename": "test/development/app-dir/segment-explorer-globals/next.config.js",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fnext.config.js?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,12 @@\n+/**\n+ * @type {import('next').NextConfig}\n+ */\n+const nextConfig = {\n+  experimental: {\n+    devtoolSegmentExplorer: true,\n+    authInterrupts: true,\n+    globalNotFound: true,\n+  },\n+}\n+\n+module.exports = nextConfig"
        },
        {
            "sha": "136a25cbc1ce97ed936d2c0744b4f3f367e0a0fe",
            "filename": "test/development/app-dir/segment-explorer-globals/segment-explorer-globals.test.ts",
            "status": "added",
            "additions": 41,
            "deletions": 0,
            "changes": 41,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fsegment-explorer-globals.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fsegment-explorer-globals.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fsegment-explorer-globals.test.ts?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -0,0 +1,41 @@\n+import { nextTestSetup } from 'e2e-utils'\n+import { openDevToolsIndicatorPopover } from 'next-test-utils'\n+import { Playwright } from 'next-webdriver'\n+\n+async function getSegmentExplorerContent(browser: Playwright) {\n+  // open the devtool button\n+  await openDevToolsIndicatorPopover(browser)\n+\n+  // open the segment explorer\n+  await browser.elementByCss('[data-segment-explorer]').click()\n+\n+  //  wait for the segment explorer to be visible\n+  await browser.waitForElementByCss('[data-nextjs-devtool-segment-explorer]')\n+\n+  const content = await browser.elementByCss(\n+    '[data-nextjs-devtool-segment-explorer]'\n+  )\n+  return content.text()\n+}\n+\n+describe('segment-explorer - globals', () => {\n+  const { next } = nextTestSetup({\n+    files: __dirname,\n+  })\n+\n+  it('should show global-error segment', async () => {\n+    const browser = await next.browser('/runtime-error')\n+    expect(await getSegmentExplorerContent(browser)).toMatchInlineSnapshot(`\n+     \"app/\n+     global-error.tsx\"\n+    `)\n+  })\n+\n+  it('should display parallel routes default page when present', async () => {\n+    const browser = await next.browser('/404-not-found')\n+    expect(await getSegmentExplorerContent(browser)).toMatchInlineSnapshot(`\n+     \"app/\n+     global-not-found.tsx\"\n+    `)\n+  })\n+})"
        },
        {
            "sha": "a14e64fcd5e33e9399d0e823434b0ab3095d5b75",
            "filename": "test/development/app-dir/segment-explorer/app/layout.tsx",
            "status": "modified",
            "additions": 10,
            "deletions": 3,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fapp%2Flayout.tsx?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -1,8 +1,15 @@\n-import { ReactNode } from 'react'\n+export const metadata = {\n+  title: 'Next.js',\n+  description: 'Generated by Next.js',\n+}\n \n-export default function Root({ children }: { children: ReactNode }) {\n+export default function RootLayout({\n+  children,\n+}: {\n+  children: React.ReactNode\n+}) {\n   return (\n-    <html>\n+    <html lang=\"en\">\n       <body>{children}</body>\n     </html>\n   )"
        },
        {
            "sha": "ce472236f543713e92224940cda59ba064bc6f2c",
            "filename": "test/development/app-dir/segment-explorer/segment-explorer.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/33477b7e64fbfaa5f59e833a4cc161cf0793ede6/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts?ref=33477b7e64fbfaa5f59e833a4cc161cf0793ede6",
            "patch": "@@ -128,7 +128,7 @@ describe('segment-explorer', () => {\n     const browser = await next.browser('/runtime-error')\n     expect(await getSegmentExplorerContent(browser)).toMatchInlineSnapshot(`\n      \"app/\n-     global-error.tsx\"\n+     global-error.js\"\n     `)\n   })\n "
        }
    ],
    "stats": {
        "total": 323,
        "additions": 238,
        "deletions": 85
    }
}