{
    "author": "unstubbable",
    "message": "Don't create client-side debug channel if the feature is disabled (#83699)\n\nCreating the client-side debug channel when\n`experimental.reactDebugChannel` is falsy went unnoticed in the\n[original PR](https://github.com/vercel/next.js/pull/82748), because\nthis doesn't provoke any obvious errors. The debug info is still\ncorrectly received through the main RSC stream. But it does create a\nmemory leak, because it prevents React from closing the Flight response.\n\nOn the server side, we were already guarding the feature properly using\nthe feature flag.",
    "sha": "5abb663b96493292031b04ef977686949f0a4445",
    "files": [
        {
            "sha": "38838f76b8675155b7d91788c7b9a96655c97827",
            "filename": "packages/next/src/build/define-env.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/5abb663b96493292031b04ef977686949f0a4445/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/5abb663b96493292031b04ef977686949f0a4445/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts?ref=5abb663b96493292031b04ef977686949f0a4445",
            "patch": "@@ -333,6 +333,8 @@ export function getDefineEnv({\n       !isTurbopack || (config.experimental.turbopackPersistentCaching ?? false),\n     'process.env.__NEXT_OPTIMIZE_ROUTER_SCROLL':\n       config.experimental.optimizeRouterScrolling ?? false,\n+    'process.env.__NEXT_REACT_DEBUG_CHANNEL':\n+      config.experimental.reactDebugChannel ?? false,\n   }\n \n   const userDefines = config.compiler?.define ?? {}"
        },
        {
            "sha": "abdf69f3217023171d66b8f48177b4a1ea92eaac",
            "filename": "packages/next/src/client/app-index.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/5abb663b96493292031b04ef977686949f0a4445/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/5abb663b96493292031b04ef977686949f0a4445/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fapp-index.tsx?ref=5abb663b96493292031b04ef977686949f0a4445",
            "patch": "@@ -162,7 +162,11 @@ let debugChannel:\n   | { readable?: ReadableStream; writable?: WritableStream }\n   | undefined\n \n-if (process.env.NODE_ENV !== 'production' && typeof window !== 'undefined') {\n+if (\n+  process.env.NODE_ENV !== 'production' &&\n+  process.env.__NEXT_REACT_DEBUG_CHANNEL &&\n+  typeof window !== 'undefined'\n+) {\n   const { createDebugChannel } =\n     require('./dev/debug-channel') as typeof import('./dev/debug-channel')\n "
        }
    ],
    "stats": {
        "total": 8,
        "additions": 7,
        "deletions": 1
    }
}