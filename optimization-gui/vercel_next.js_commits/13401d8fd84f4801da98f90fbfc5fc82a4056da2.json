{
    "author": "huozhi",
    "message": "[devtool] merge segment explorer flag into panel ui flag (#81085)",
    "sha": "13401d8fd84f4801da98f90fbfc5fc82a4056da2",
    "files": [
        {
            "sha": "690b0653dd41a80dc55e7eb6d487b17914042fac",
            "filename": "crates/next-core/src/next_config.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/crates%2Fnext-core%2Fsrc%2Fnext_config.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-core%2Fsrc%2Fnext_config.rs?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -801,8 +801,9 @@ pub struct ExperimentalConfig {\n     global_not_found: Option<bool>,\n     /// Defaults to false in development mode, true in production mode.\n     turbopack_remove_unused_exports: Option<bool>,\n-    /// Devtool option for the segment explorer.\n-    devtool_segment_explorer: Option<bool>,\n+    /// Devtool option for new panel UI.\n+    #[serde(rename = \"devtoolNewPanelUI\")]\n+    devtool_new_panel_ui: Option<bool>,\n }\n \n #[derive("
        },
        {
            "sha": "3a7b9a84373e934ea0d838dac9bc21579442092c",
            "filename": "packages/next/src/build/define-env.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fdefine-env.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -298,9 +298,6 @@ export function getDefineEnv({\n           ),\n         }\n       : {}),\n-    'process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER':\n-      // Enable segment explorer in devtools\n-      isDevToolPanelUIEnabled || !!config.experimental.devtoolSegmentExplorer,\n     'process.env.__NEXT_DEVTOOL_NEW_PANEL_UI': isDevToolPanelUIEnabled,\n \n     // The devtools need to know whether or not to show an option to clear the"
        },
        {
            "sha": "336c432ef604202dd5b4b244a7a518c622102542",
            "filename": "packages/next/src/build/templates/app-page.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Ftemplates%2Fapp-page.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -484,8 +484,7 @@ export async function handler(\n           deploymentId: nextConfig.deploymentId,\n           enableTainting: nextConfig.experimental.taint,\n           htmlLimitedBots: nextConfig.htmlLimitedBots,\n-          devtoolSegmentExplorer:\n-            nextConfig.experimental.devtoolSegmentExplorer,\n+          devtoolNewPanelUI: nextConfig.experimental.devtoolNewPanelUI,\n           reactMaxHeadersLength: nextConfig.reactMaxHeadersLength,\n \n           multiZoneDraftMode,"
        },
        {
            "sha": "b433dc304afdff89e1822eacdd2e143bf564eb0b",
            "filename": "packages/next/src/build/webpack/loaders/next-edge-ssr-loader/render.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-edge-ssr-loader%2Frender.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-edge-ssr-loader%2Frender.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-edge-ssr-loader%2Frender.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -100,7 +100,7 @@ export function getRender({\n         serverActionsManifest,\n         serverActions,\n         nextFontManifest,\n-        devtoolSegmentExplorer: config.experimental.devtoolSegmentExplorer,\n+        devtoolNewPanelUI: config.experimental.devtoolNewPanelUI,\n       },\n       renderToHTML,\n       incrementalCacheHandler,"
        },
        {
            "sha": "9e1abb07d8dbc489a6feefffae59d21b60e045f9",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-indicator/devtools-indicator.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-indicator%2Fdevtools-indicator.tsx?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -56,7 +56,7 @@ export function DevToolsIndicator({\n           [vertical]: `${INDICATOR_PADDING}px`,\n           [horizontal]: `${INDICATOR_PADDING}px`,\n           visibility:\n-            state.isDevToolsPanelOpen || state.isErrorOverlayOpen\n+            state.isDevToolsPanelOpen && !state.isErrorOverlayOpen\n               ? 'hidden'\n               : 'visible',\n         } as CSSProperties"
        },
        {
            "sha": "e9499199fa4ad537ddf64d78e1703cf1e68672dd",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/devtools-panel/devtools-panel.tsx",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Fdevtools-panel%2Fdevtools-panel.tsx?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -161,7 +161,8 @@ export function DevToolsPanel({\n                 >\n                   <div data-nextjs-devtools-panel-header-tab-group>\n                     <button\n-                      data-nextjs-devtools-panel-header-tab={\n+                      data-nextjs-devtools-panel-header-tab=\"issues\"\n+                      data-nextjs-devtools-panel-header-tab-active={\n                         activeTab === 'issues'\n                       }\n                       onClick={() => setActiveTab('issues')}\n@@ -176,15 +177,17 @@ export function DevToolsPanel({\n                       ) : null}\n                     </button>\n                     <button\n-                      data-nextjs-devtools-panel-header-tab={\n+                      data-nextjs-devtools-panel-header-tab=\"route\"\n+                      data-nextjs-devtools-panel-header-tab-active={\n                         activeTab === 'route'\n                       }\n                       onClick={() => setActiveTab('route')}\n                     >\n                       Route Info\n                     </button>\n                     <button\n-                      data-nextjs-devtools-panel-header-tab={\n+                      data-nextjs-devtools-panel-header-tab=\"settings\"\n+                      data-nextjs-devtools-panel-header-tab-active={\n                         activeTab === 'settings'\n                       }\n                       onClick={() => setActiveTab('settings')}\n@@ -352,7 +355,7 @@ export const DEVTOOLS_PANEL_STYLES = css`\n     }\n   }\n \n-  [data-nextjs-devtools-panel-header-tab='true'] {\n+  [data-nextjs-devtools-panel-header-tab-active='true'] {\n     color: var(--color-gray-1000);\n     background-color: var(--color-gray-100);\n   }"
        },
        {
            "sha": "b3ce1ead538480750402c4859f00d76faa4d4ae4",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/dev-tools-indicator.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 26,
            "changes": 29,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-indicator.tsx?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -26,7 +26,6 @@ import {\n   type DevToolsScale,\n } from './dev-tools-info/preferences'\n import { Draggable } from './draggable'\n-import { SegmentsExplorer } from './dev-tools-info/segments-explorer'\n \n // TODO: add E2E tests to cover different scenarios\n \n@@ -84,7 +83,6 @@ const OVERLAYS = {\n   Turbo: 'turbo',\n   Route: 'route',\n   Preferences: 'preferences',\n-  SegmentExplorer: 'segment-explorer',\n } as const\n \n export type Overlays = (typeof OVERLAYS)[keyof typeof OVERLAYS]\n@@ -130,7 +128,6 @@ function DevToolsPopover({\n   const isTurbopackInfoOpen = open === OVERLAYS.Turbo\n   const isRouteInfoOpen = open === OVERLAYS.Route\n   const isPreferencesOpen = open === OVERLAYS.Preferences\n-  const isSegmentExplorerOpen = open === OVERLAYS.SegmentExplorer\n \n   const { mounted: menuMounted, rendered: menuRendered } = useDelayedRender(\n     isMenuOpen,\n@@ -220,7 +217,9 @@ function DevToolsPopover({\n   }\n \n   function toggleErrorOverlay() {\n-    dispatch({ type: ACTION_ERROR_OVERLAY_TOGGLE })\n+    if (!process.env.__NEXT_DEVTOOL_NEW_PANEL_UI) {\n+      dispatch({ type: ACTION_ERROR_OVERLAY_TOGGLE })\n+    }\n   }\n \n   function closeToRootMenu() {\n@@ -336,19 +335,6 @@ function DevToolsPopover({\n         setScale={setScale}\n       />\n \n-      {/* Page Route Info */}\n-      {process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER ? (\n-        <SegmentsExplorer\n-          isOpen={isSegmentExplorerOpen}\n-          close={closeToRootMenu}\n-          triggerRef={triggerRef}\n-          style={popover}\n-          routerType={routerType}\n-          // dummy page for legacy segment explorer, will be removed in the future\n-          page={''}\n-        />\n-      ) : null}\n-\n       {/* Dropdown Menu */}\n       {menuMounted && (\n         <div\n@@ -414,15 +400,6 @@ function DevToolsPopover({\n                 onClick={() => setOpen(OVERLAYS.Preferences)}\n                 index={isTurbopack ? 2 : 3}\n               />\n-              {process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER ? (\n-                <MenuItem\n-                  data-segment-explorer\n-                  label=\"Route Info\"\n-                  value={<ChevronRight />}\n-                  onClick={() => setOpen(OVERLAYS.SegmentExplorer)}\n-                  index={isTurbopack ? 3 : 4}\n-                />\n-              ) : null}\n             </div>\n           </Context.Provider>\n         </div>"
        },
        {
            "sha": "526bb89ff93dd47cc70680a30c33f518ca2c8210",
            "filename": "packages/next/src/next-devtools/dev-overlay/components/errors/dev-tools-indicator/dev-tools-info/segments-explorer.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 27,
            "changes": 27,
            "blob_url": "https://github.com/vercel/next.js/blob/6f0225a09b27679310eddc0858172355fd875def/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-info%2Fsegments-explorer.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/6f0225a09b27679310eddc0858172355fd875def/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-info%2Fsegments-explorer.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fcomponents%2Ferrors%2Fdev-tools-indicator%2Fdev-tools-info%2Fsegments-explorer.tsx?ref=6f0225a09b27679310eddc0858172355fd875def",
            "patch": "@@ -1,27 +0,0 @@\n-import { PageSegmentTree } from '../../../overview/segment-explorer'\n-import { DevToolsInfo, type DevToolsInfoPropsCore } from './dev-tools-info'\n-\n-export function SegmentsExplorer({\n-  routerType,\n-  page,\n-  ...props\n-}: DevToolsInfoPropsCore &\n-  React.HTMLProps<HTMLDivElement> & {\n-    routerType: 'app' | 'pages'\n-    page: string\n-  }) {\n-  const isAppRouter = routerType === 'app'\n-  return (\n-    <DevToolsInfo title=\"Route Info\" {...props}>\n-      <div data-nextjs-segments-explorer>\n-        <PageSegmentTree isAppRouter={isAppRouter} page={page} />\n-      </div>\n-    </DevToolsInfo>\n-  )\n-}\n-\n-export const SEGMENTS_EXPLORER_STYLES = `\n-  [data-nextjs-segments-explorer] {\n-    margin: -12px -8px;\n-  }\n-`"
        },
        {
            "sha": "e66c2bd5a42ecae3542207159fe34bb53981e1b8",
            "filename": "packages/next/src/next-devtools/dev-overlay/styles/component-styles.tsx",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fstyles%2Fcomponent-styles.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fstyles%2Fcomponent-styles.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fnext-devtools%2Fdev-overlay%2Fstyles%2Fcomponent-styles.tsx?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -36,7 +36,6 @@ import { DEVTOOLS_PANEL_TAB_ISSUES_CONTENT_STYLES } from '../components/devtools\n import { ISSUE_FEEDBACK_BUTTON_STYLES } from '../components/errors/error-overlay-toolbar/issue-feedback-button'\n import { ERROR_CONTENT_SKELETON_STYLES } from '../container/runtime-error/error-content-skeleton'\n import { SEGMENTS_EXPLORER_TAB_STYLES } from '../components/devtools-panel/devtools-panel-tab/segments-explorer-tab'\n-import { SEGMENTS_EXPLORER_STYLES } from '../components/errors/dev-tools-indicator/dev-tools-info/segments-explorer'\n import { DEVTOOLS_PANEL_TAB_ISSUES_CONTENT_LAYOUT_STYLES } from '../components/devtools-panel/devtools-panel-tab/issues-tab/issues-tab-content-layout'\n import { DEVTOOLS_PANEL_TAB_ISSUES_EMPTY_CONTENT_STYLES } from '../components/devtools-panel/devtools-panel-tab/issues-tab/issues-tab-empty-content'\n \n@@ -68,7 +67,6 @@ export function ComponentStyles() {\n         ${DEV_TOOLS_INFO_TURBOPACK_INFO_STYLES}\n         ${DEV_TOOLS_INFO_ROUTE_INFO_STYLES}\n         ${DEV_TOOLS_INFO_USER_PREFERENCES_STYLES}\n-        ${SEGMENTS_EXPLORER_STYLES}\n         ${DEV_TOOLS_INFO_RENDER_FILES_STYLES}\n         ${FADER_STYLES}\n         ${DEVTOOLS_PANEL_STYLES}"
        },
        {
            "sha": "4641fd7546def9026978f4ac711379393ffb1597",
            "filename": "packages/next/src/server/app-render/app-render.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fapp-render.tsx?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -3977,7 +3977,7 @@ const getGlobalErrorStyles = async (\n       dir,\n       globalErrorModule?.[1]\n     )\n-    if (ctx.renderOpts.devtoolSegmentExplorer && globalErrorModulePath) {\n+    if (ctx.renderOpts.devtoolNewPanelUI && globalErrorModulePath) {\n       const SegmentViewNode = ctx.componentMod.SegmentViewNode\n       globalErrorStyles = (\n         // This will be rendered next to GlobalError component under ErrorBoundary,"
        },
        {
            "sha": "f071a4825fc3a2508fed19b86964800e8eb8adc9",
            "filename": "packages/next/src/server/app-render/create-component-tree.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -396,8 +396,7 @@ async function createComponentTreeInternal({\n   // Resolve the segment param\n   const actualSegment = segmentParam ? segmentParam.treeSegment : segment\n   const isSegmentViewEnabled =\n-    process.env.NODE_ENV === 'development' &&\n-    ctx.renderOpts.devtoolSegmentExplorer\n+    process.env.NODE_ENV === 'development' && ctx.renderOpts.devtoolNewPanelUI\n   const dir =\n     process.env.NEXT_RUNTIME === 'edge'\n       ? process.env.__NEXT_EDGE_PROJECT_DIR!\n@@ -1084,8 +1083,7 @@ async function createBoundaryConventionElement({\n   tree: LoaderTree\n }) {\n   const isSegmentViewEnabled =\n-    process.env.NODE_ENV === 'development' &&\n-    ctx.renderOpts.devtoolSegmentExplorer\n+    process.env.NODE_ENV === 'development' && ctx.renderOpts.devtoolNewPanelUI\n   const dir =\n     process.env.NEXT_RUNTIME === 'edge'\n       ? process.env.__NEXT_EDGE_PROJECT_DIR!"
        },
        {
            "sha": "a479f5f734c86c0b5ff47a14208a960dda189c7c",
            "filename": "packages/next/src/server/app-render/types.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Ftypes.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -280,9 +280,9 @@ export interface RenderOptsPartial {\n   allowEmptyStaticShell?: boolean\n \n   /**\n-   * next config experimental.devtoolSegmentExplorer\n+   * next config experimental.devtoolNewPanelUI\n    */\n-  devtoolSegmentExplorer?: boolean\n+  devtoolNewPanelUI?: boolean\n }\n \n export type RenderOpts = LoadComponentsReturnType<AppPageModule> &"
        },
        {
            "sha": "4edbfb80a6f09ef11bb56f5ec8cee50e26bed36b",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -612,8 +612,7 @@ export default abstract class Server<\n       onInstrumentationRequestError:\n         this.instrumentationOnRequestError.bind(this),\n       reactMaxHeadersLength: this.nextConfig.reactMaxHeadersLength,\n-      devtoolSegmentExplorer:\n-        this.nextConfig.experimental.devtoolSegmentExplorer,\n+      devtoolNewPanelUI: this.nextConfig.experimental.devtoolNewPanelUI,\n     }\n \n     // Initialize next/config with the environment configuration"
        },
        {
            "sha": "071d3eb42af3124a739dd6ae515fffbf064bbb0b",
            "filename": "packages/next/src/server/config-schema.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-schema.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -500,7 +500,6 @@ export const configSchema: zod.ZodType<NextConfig> = z.lazy(() =>\n           })\n           .optional(),\n         globalNotFound: z.boolean().optional(),\n-        devtoolSegmentExplorer: z.boolean().optional(),\n         devtoolNewPanelUI: z.boolean().optional(),\n       })\n       .optional(),"
        },
        {
            "sha": "dae848c4b34115069fc82b0f3a1ba0b6abbd6f9d",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -736,11 +736,6 @@ export interface ExperimentalConfig {\n    */\n   globalNotFound?: boolean\n \n-  /**\n-   * Enable segment viewer for the app directory in Next.js DevTools.\n-   */\n-  devtoolSegmentExplorer?: boolean\n-\n   /**\n    * Enable new panel UI for the Next.js DevTools.\n    */\n@@ -1456,7 +1451,6 @@ export const defaultConfig = {\n     useCache: undefined,\n     slowModuleDetection: undefined,\n     globalNotFound: false,\n-    devtoolSegmentExplorer: false,\n   },\n   htmlLimitedBots: undefined,\n   bundlePagesRouterDependencies: false,"
        },
        {
            "sha": "8000cd58afdf087cacf9814eefecb51365d7aa98",
            "filename": "test/development/app-dir/segment-explorer-globals/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fnext.config.js?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -3,7 +3,7 @@\n  */\n const nextConfig = {\n   experimental: {\n-    devtoolSegmentExplorer: true,\n+    devtoolNewPanelUI: true,\n     authInterrupts: true,\n     globalNotFound: true,\n   },"
        },
        {
            "sha": "ee2882eaf9408c0ae1bb9a32314dfb2d38e6e2e5",
            "filename": "test/development/app-dir/segment-explorer-globals/segment-explorer-globals.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fsegment-explorer-globals.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fsegment-explorer-globals.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer-globals%2Fsegment-explorer-globals.test.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -3,11 +3,12 @@ import { openDevToolsIndicatorPopover } from 'next-test-utils'\n import { Playwright } from 'next-webdriver'\n \n async function getSegmentExplorerContent(browser: Playwright) {\n-  // open the devtool button\n   await openDevToolsIndicatorPopover(browser)\n \n-  // open the segment explorer\n-  await browser.elementByCss('[data-segment-explorer]').click()\n+  // open segment explorer tab\n+  await browser\n+    .elementByCss('[data-nextjs-devtools-panel-header-tab=\"route\"]')\n+    .click()\n \n   //  wait for the segment explorer to be visible\n   await browser.waitForElementByCss('[data-nextjs-devtool-segment-explorer]')"
        },
        {
            "sha": "07b7054c79bca1a6fe5b70c5b3f1e720f312dc5d",
            "filename": "test/development/app-dir/segment-explorer/next.config.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fnext.config.js?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -3,7 +3,7 @@\n  */\n const nextConfig = {\n   experimental: {\n-    devtoolSegmentExplorer: true,\n+    devtoolNewPanelUI: true,\n     authInterrupts: true,\n   },\n }"
        },
        {
            "sha": "4ded56ff20d0d4fd51781f4f334706f3650d00ad",
            "filename": "test/development/app-dir/segment-explorer/segment-explorer.test.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fsegment-explorer%2Fsegment-explorer.test.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -6,8 +6,10 @@ async function getSegmentExplorerContent(browser: Playwright) {\n   // open the devtool button\n   await openDevToolsIndicatorPopover(browser)\n \n-  // open the segment explorer\n-  await browser.elementByCss('[data-segment-explorer]').click()\n+  // open segment explorer tab\n+  await browser\n+    .elementByCss('[data-nextjs-devtools-panel-header-tab=\"route\"]')\n+    .click()\n \n   //  wait for the segment explorer to be visible\n   await browser.waitForElementByCss('[data-nextjs-devtool-segment-explorer]')\n@@ -86,6 +88,7 @@ describe('segment-explorer', () => {\n     await browser.elementByCss('[href=\"/soft-navigation/b\"]').click()\n     await retry(async () => {\n       expect(await browser.elementByCss('body').text()).toContain('Page B')\n+      expect(await browser.url()).toBe(`${next.url}/soft-navigation/b`)\n     })\n \n     expect(await getSegmentExplorerContent(browser)).toMatchInlineSnapshot(`"
        },
        {
            "sha": "61141e3ae5f44d084cd1913d67c0a07daada7f95",
            "filename": "test/lib/next-test-utils.ts",
            "status": "modified",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Flib%2Fnext-test-utils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/13401d8fd84f4801da98f90fbfc5fc82a4056da2/test%2Flib%2Fnext-test-utils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Flib%2Fnext-test-utils.ts?ref=13401d8fd84f4801da98f90fbfc5fc82a4056da2",
            "patch": "@@ -951,6 +951,11 @@ export async function openRedbox(browser: Playwright): Promise<void> {\n export async function openDevToolsIndicatorPopover(\n   browser: Playwright\n ): Promise<void> {\n+  // If the devtools panel is already open, we don't assert the indicator,\n+  // and no need to open it again.\n+  if (await hasDevToolsPanel(browser)) {\n+    return\n+  }\n   const devToolsIndicator = await assertHasDevToolsIndicator(browser)\n \n   try {\n@@ -962,6 +967,18 @@ export async function openDevToolsIndicatorPopover(\n   }\n }\n \n+export async function hasDevToolsPanel(browser: Playwright) {\n+  const result = await browser.eval(() => {\n+    const portal = [].slice\n+      .call(document.querySelectorAll('nextjs-portal'))\n+      .find((p) => p.shadowRoot.querySelector('[data-nextjs-dialog-overlay]'))\n+\n+    const root = portal?.shadowRoot\n+    return root?.querySelector('[data-nextjs-dialog-overlay]') != null\n+  })\n+  return result\n+}\n+\n export async function assertHasDevToolsIndicator(browser: Playwright) {\n   const devToolsIndicator = browser.locateDevToolsIndicator()\n   try {"
        }
    ],
    "stats": {
        "total": 141,
        "additions": 50,
        "deletions": 91
    }
}