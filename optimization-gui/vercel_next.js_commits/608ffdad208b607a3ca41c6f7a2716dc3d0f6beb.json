{
    "author": "gaojude",
    "message": "feat: onNavigate for link (#77209)",
    "sha": "608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
    "files": [
        {
            "sha": "5ccecf256ca2d0ba227b3d1d4b51b6ae12105b5e",
            "filename": "packages/next/src/client/app-dir/link.tsx",
            "status": "modified",
            "additions": 45,
            "deletions": 4,
            "changes": 49,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/packages%2Fnext%2Fsrc%2Fclient%2Fapp-dir%2Flink.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/packages%2Fnext%2Fsrc%2Fclient%2Fapp-dir%2Flink.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fapp-dir%2Flink.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -17,6 +17,7 @@ import {\n   onNavigationIntent,\n   unmountLinkInstance,\n } from '../components/links'\n+import { isLocalURL } from '../../shared/lib/router/utils/is-local-url'\n \n type Url = string | UrlObject\n type RequiredKeys<T> = {\n@@ -26,6 +27,8 @@ type OptionalKeys<T> = {\n   [K in keyof T]-?: {} extends Pick<T, K> ? K : never\n }[keyof T]\n \n+type OnNavigateEventHandler = (event: { preventDefault: () => void }) => void\n+\n type InternalLinkProps = {\n   /**\n    * **Required**. The path or URL to navigate to. It can also be an object (similar to `URL`).\n@@ -192,6 +195,11 @@ type InternalLinkProps = {\n    * Optional event handler for when the `<Link>` is clicked.\n    */\n   onClick?: React.MouseEventHandler<HTMLAnchorElement>\n+\n+  /**\n+   * Optional event handler for when the `<Link>` is navigated.\n+   */\n+  onNavigate?: OnNavigateEventHandler\n }\n \n // TODO-APP: Include the full set of Anchor props\n@@ -224,21 +232,51 @@ function linkClicked(\n   as: string,\n   replace?: boolean,\n   shallow?: boolean,\n-  scroll?: boolean\n+  scroll?: boolean,\n+  onNavigate?: OnNavigateEventHandler\n ): void {\n   const { nodeName } = e.currentTarget\n \n   // anchors inside an svg have a lowercase nodeName\n   const isAnchorNodeName = nodeName.toUpperCase() === 'A'\n \n-  if (isAnchorNodeName && isModifiedEvent(e)) {\n+  if (\n+    (isAnchorNodeName && isModifiedEvent(e)) ||\n+    e.currentTarget.hasAttribute('download')\n+  ) {\n+    // ignore click for browser’s default behavior\n+    return\n+  }\n+\n+  if (!isLocalURL(href)) {\n+    if (replace) {\n+      // browser default behavior does not replace the history state\n+      // so we need to do it manually\n+      e.preventDefault()\n+      location.replace(href)\n+    }\n+\n     // ignore click for browser’s default behavior\n     return\n   }\n \n   e.preventDefault()\n \n   const navigate = () => {\n+    if (onNavigate) {\n+      let isDefaultPrevented = false\n+\n+      onNavigate({\n+        preventDefault: () => {\n+          isDefaultPrevented = true\n+        },\n+      })\n+\n+      if (isDefaultPrevented) {\n+        return\n+      }\n+    }\n+\n     // If the router is an NextRouter instance it will have `beforePopState`\n     const routerScroll = scroll ?? true\n     if ('beforePopState' in router) {\n@@ -296,6 +334,7 @@ const Link = React.forwardRef<HTMLAnchorElement, LinkPropsReal>(\n       onMouseEnter: onMouseEnterProp,\n       onTouchStart: onTouchStartProp,\n       legacyBehavior = false,\n+      onNavigate,\n       ...restProps\n     } = props\n \n@@ -372,6 +411,7 @@ const Link = React.forwardRef<HTMLAnchorElement, LinkPropsReal>(\n         onMouseEnter: true,\n         onTouchStart: true,\n         legacyBehavior: true,\n+        onNavigate: true,\n       } as const\n       const optionalProps: LinkPropsOptional[] = Object.keys(\n         optionalPropsGuard\n@@ -390,7 +430,8 @@ const Link = React.forwardRef<HTMLAnchorElement, LinkPropsReal>(\n         } else if (\n           key === 'onClick' ||\n           key === 'onMouseEnter' ||\n-          key === 'onTouchStart'\n+          key === 'onTouchStart' ||\n+          key === 'onNavigate'\n         ) {\n           if (props[key] && valType !== 'function') {\n             throw createPropError({\n@@ -562,7 +603,7 @@ const Link = React.forwardRef<HTMLAnchorElement, LinkPropsReal>(\n           return\n         }\n \n-        linkClicked(e, router, href, as, replace, shallow, scroll)\n+        linkClicked(e, router, href, as, replace, shallow, scroll, onNavigate)\n       },\n       onMouseEnter(e) {\n         if (!legacyBehavior && typeof onMouseEnterProp === 'function') {"
        },
        {
            "sha": "904adfee0d3cdbf73545af5fff8214221b598861",
            "filename": "packages/next/src/client/link.tsx",
            "status": "modified",
            "additions": 53,
            "deletions": 4,
            "changes": 57,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/packages%2Fnext%2Fsrc%2Fclient%2Flink.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/packages%2Fnext%2Fsrc%2Fclient%2Flink.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Flink.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -27,6 +27,8 @@ type OptionalKeys<T> = {\n   [K in keyof T]-?: {} extends Pick<T, K> ? K : never\n }[keyof T]\n \n+type OnNavigateEventHandler = (event: { preventDefault: () => void }) => void\n+\n type InternalLinkProps = {\n   /**\n    * The path or URL to navigate to. It can also be an object.\n@@ -104,6 +106,10 @@ type InternalLinkProps = {\n    * Optional event handler for when Link is clicked.\n    */\n   onClick?: React.MouseEventHandler<HTMLAnchorElement>\n+  /**\n+   * Optional event handler for when the `<Link>` is navigated.\n+   */\n+  onNavigate?: OnNavigateEventHandler\n }\n \n // TODO-APP: Include the full set of Anchor props\n@@ -196,21 +202,51 @@ function linkClicked(\n   replace?: boolean,\n   shallow?: boolean,\n   scroll?: boolean,\n-  locale?: string | false\n+  locale?: string | false,\n+  onNavigate?: OnNavigateEventHandler\n ): void {\n   const { nodeName } = e.currentTarget\n \n   // anchors inside an svg have a lowercase nodeName\n   const isAnchorNodeName = nodeName.toUpperCase() === 'A'\n \n-  if (isAnchorNodeName && (isModifiedEvent(e) || !isLocalURL(href))) {\n+  if (\n+    (isAnchorNodeName && isModifiedEvent(e)) ||\n+    e.currentTarget.hasAttribute('download')\n+  ) {\n+    // ignore click for browser’s default behavior\n+    return\n+  }\n+\n+  if (!isLocalURL(href)) {\n+    if (replace) {\n+      // browser default behavior does not replace the history state\n+      // so we need to do it manually\n+      e.preventDefault()\n+      location.replace(href)\n+    }\n+\n     // ignore click for browser’s default behavior\n     return\n   }\n \n   e.preventDefault()\n \n   const navigate = () => {\n+    if (onNavigate) {\n+      let isDefaultPrevented = false\n+\n+      onNavigate({\n+        preventDefault: () => {\n+          isDefaultPrevented = true\n+        },\n+      })\n+\n+      if (isDefaultPrevented) {\n+        return\n+      }\n+    }\n+\n     // If the router is an NextRouter instance it will have `beforePopState`\n     const routerScroll = scroll ?? true\n     if ('beforePopState' in router) {\n@@ -265,6 +301,7 @@ const Link = React.forwardRef<HTMLAnchorElement, LinkPropsReal>(\n       scroll,\n       locale,\n       onClick,\n+      onNavigate,\n       onMouseEnter: onMouseEnterProp,\n       onTouchStart: onTouchStartProp,\n       legacyBehavior = false,\n@@ -338,6 +375,7 @@ const Link = React.forwardRef<HTMLAnchorElement, LinkPropsReal>(\n         onMouseEnter: true,\n         onTouchStart: true,\n         legacyBehavior: true,\n+        onNavigate: true,\n       } as const\n       const optionalProps: LinkPropsOptional[] = Object.keys(\n         optionalPropsGuard\n@@ -364,7 +402,8 @@ const Link = React.forwardRef<HTMLAnchorElement, LinkPropsReal>(\n         } else if (\n           key === 'onClick' ||\n           key === 'onMouseEnter' ||\n-          key === 'onTouchStart'\n+          key === 'onTouchStart' ||\n+          key === 'onNavigate'\n         ) {\n           if (props[key] && valType !== 'function') {\n             throw createPropError({\n@@ -539,7 +578,17 @@ const Link = React.forwardRef<HTMLAnchorElement, LinkPropsReal>(\n           return\n         }\n \n-        linkClicked(e, router, href, as, replace, shallow, scroll, locale)\n+        linkClicked(\n+          e,\n+          router,\n+          href,\n+          as,\n+          replace,\n+          shallow,\n+          scroll,\n+          locale,\n+          onNavigate\n+        )\n       },\n       onMouseEnter(e) {\n         if (!legacyBehavior && typeof onMouseEnterProp === 'function') {"
        },
        {
            "sha": "bd40b7c2593dae967edc0bb95d7f7b733696fcb2",
            "filename": "test/e2e/link-on-navigate-prop/app/app-router/layout.tsx",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Fapp-router%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Fapp-router%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Fapp-router%2Flayout.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,8 @@\n+'use client'\n+\n+import React from 'react'\n+import OnNavigate from '../../shared/OnNavigate'\n+\n+export default function Layout({ children }: { children: React.ReactNode }) {\n+  return <OnNavigate rootPath=\"/app-router\">{children}</OnNavigate>\n+}"
        },
        {
            "sha": "c645ced835fd189b949ceebe0009f53ae07facce",
            "filename": "test/e2e/link-on-navigate-prop/app/app-router/page.tsx",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Fapp-router%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Fapp-router%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Fapp-router%2Fpage.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,5 @@\n+import React from 'react'\n+\n+export default function Home() {\n+  return <div>Home</div>\n+}"
        },
        {
            "sha": "9b1edff8e0e3d4441154bd98ebb5f81740ede392",
            "filename": "test/e2e/link-on-navigate-prop/app/app-router/subpage/page.tsx",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Fapp-router%2Fsubpage%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Fapp-router%2Fsubpage%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Fapp-router%2Fsubpage%2Fpage.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,5 @@\n+import React from 'react'\n+\n+export default function Subpage() {\n+  return <div>Subpage</div>\n+}"
        },
        {
            "sha": "e324d469a48136e421aaf270106aa8f53622c0bd",
            "filename": "test/e2e/link-on-navigate-prop/app/layout.tsx",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Flayout.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Flayout.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Fapp%2Flayout.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,13 @@\n+import React from 'react'\n+\n+export default function RootLayout({\n+  children,\n+}: {\n+  children: React.ReactNode\n+}) {\n+  return (\n+    <html>\n+      <body>{children}</body>\n+    </html>\n+  )\n+}"
        },
        {
            "sha": "9a2aa79da5cd001bf1062090cc57419dfe5a16b8",
            "filename": "test/e2e/link-on-navigate-prop/index.test.ts",
            "status": "added",
            "additions": 185,
            "deletions": 0,
            "changes": 185,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Findex.test.ts?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,185 @@\n+import { nextTestSetup } from 'e2e-utils'\n+\n+describe('<Link /> onNavigate prop', () => {\n+  const { next } = nextTestSetup({\n+    files: __dirname,\n+  })\n+\n+  const routers = [\n+    { name: 'App Router', path: '/app-router' },\n+    { name: 'Pages Router', path: '/pages-router' },\n+  ]\n+\n+  routers.forEach(({ name, path }) => {\n+    describe(name, () => {\n+      it('should trigger onClick but not onNavigate when using modifier key', async () => {\n+        const browser = await next.browser(path)\n+\n+        // Check initial state\n+        expect(await browser.elementById('is-clicked').text()).toBe(\n+          'isClicked: false'\n+        )\n+        expect(await browser.elementById('is-navigated').text()).toBe(\n+          'isNavigated: false'\n+        )\n+\n+        // Click with modifier key based on OS to open in new window\n+        const platform = process.platform\n+        const modifierKey = platform === 'darwin' ? 'Meta' : 'Control'\n+\n+        // First press down the modifier key\n+        await browser.keydown(modifierKey)\n+\n+        // Click the link while the modifier key is pressed\n+        await browser.elementById('link-to-subpage').click()\n+\n+        // Release the modifier key\n+        await browser.keyup(modifierKey)\n+\n+        await browser.waitForIdleNetwork()\n+\n+        // Should trigger onClick but not onNavigate\n+        expect(await browser.elementById('is-clicked').text()).toBe(\n+          'isClicked: true'\n+        )\n+        expect(await browser.elementById('is-navigated').text()).toBe(\n+          'isNavigated: false'\n+        )\n+      })\n+\n+      it('should trigger both onClick and onNavigate for internal navigation', async () => {\n+        const browser = await next.browser(path)\n+\n+        // Check initial state\n+        expect(await browser.elementById('is-clicked').text()).toBe(\n+          'isClicked: false'\n+        )\n+        expect(await browser.elementById('is-navigated').text()).toBe(\n+          'isNavigated: false'\n+        )\n+\n+        // Click internal link\n+        await browser.elementById('link-to-subpage').click()\n+        await browser.waitForIdleNetwork()\n+\n+        // Should trigger both onClick and onNavigate\n+        expect(await browser.elementById('is-clicked').text()).toBe(\n+          'isClicked: true'\n+        )\n+        expect(await browser.elementById('is-navigated').text()).toBe(\n+          'isNavigated: true'\n+        )\n+      })\n+\n+      it('should prevent navigation when onNavigate calls preventDefault', async () => {\n+        const browser = await next.browser(path)\n+\n+        // Check initial state\n+        expect(await browser.elementById('is-locked').text()).toBe(\n+          'isLocked: false'\n+        )\n+\n+        // Lock navigation\n+        await browser.elementById('toggle-lock').click()\n+        expect(await browser.elementById('is-locked').text()).toBe(\n+          'isLocked: true'\n+        )\n+\n+        // Try to navigate\n+        await browser.elementById('link-to-subpage').click()\n+        await browser.waitForIdleNetwork()\n+\n+        // Should trigger onClick but not navigate or trigger onNavigate\n+        expect(await browser.elementById('is-clicked').text()).toBe(\n+          'isClicked: true'\n+        )\n+        expect(await browser.elementById('is-navigated').text()).toBe(\n+          'isNavigated: false'\n+        )\n+\n+        // Verify we're still on the same page\n+        expect(await browser.url()).toContain(path)\n+      })\n+\n+      it('should only trigger onClick for external links with target=\"_blank\"', async () => {\n+        const browser = await next.browser(path)\n+\n+        // Check initial state\n+        expect(await browser.elementById('is-clicked').text()).toBe(\n+          'isClicked: false'\n+        )\n+        expect(await browser.elementById('is-navigated').text()).toBe(\n+          'isNavigated: false'\n+        )\n+\n+        // We can't fully test the new window, but we can verify the events are triggered\n+        await browser.elementById('external-link-with-target').click()\n+        await browser.waitForIdleNetwork()\n+\n+        // Should only trigger onClick for external links with target\n+        expect(await browser.elementById('is-clicked').text()).toBe(\n+          'isClicked: true'\n+        )\n+        expect(await browser.elementById('is-navigated').text()).toBe(\n+          'isNavigated: false'\n+        )\n+      })\n+\n+      it('should only trigger onClick for download links', async () => {\n+        const browser = await next.browser(path)\n+\n+        // Check initial state\n+        expect(await browser.elementById('is-clicked').text()).toBe(\n+          'isClicked: false'\n+        )\n+        expect(await browser.elementById('is-navigated').text()).toBe(\n+          'isNavigated: false'\n+        )\n+\n+        // Click download link\n+        await browser.elementById('download-link').click()\n+        await browser.waitForIdleNetwork()\n+\n+        // Should trigger both onClick and onNavigate for download links\n+        expect(await browser.elementById('is-clicked').text()).toBe(\n+          'isClicked: true'\n+        )\n+        expect(await browser.elementById('is-navigated').text()).toBe(\n+          'isNavigated: false'\n+        )\n+      })\n+\n+      it('should only trigger both onClick for external links', async () => {\n+        const alerts: string[] = []\n+        const browser = await next.browser(path, {\n+          beforePageLoad(page) {\n+            page.on('dialog', (dialog) => {\n+              alerts.push(dialog.message())\n+              dialog.dismiss()\n+            })\n+          },\n+        })\n+\n+        await browser.elementById('external-link').click()\n+        await browser.waitForIdleNetwork()\n+\n+        expect(alerts).toEqual(['onClick'])\n+      })\n+\n+      it('should replace history state for external links with replace prop', async () => {\n+        const browser = await next.browser(path)\n+\n+        // Get initial history length\n+        const initialLength = await browser.eval('history.length')\n+\n+        // Click external link with replace\n+        await browser.elementById('external-link-with-replace').click()\n+        await browser.waitForIdleNetwork()\n+\n+        // Verify history length hasn't changed (replace instead of push)\n+        const finalLength = await browser.eval('history.length')\n+        expect(finalLength).toBe(initialLength)\n+      })\n+    })\n+  })\n+})"
        },
        {
            "sha": "2af09e2ce1099800b2523b3f090226ea139c163f",
            "filename": "test/e2e/link-on-navigate-prop/pages/_app.tsx",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fpages%2F_app.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fpages%2F_app.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Fpages%2F_app.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,11 @@\n+import React from 'react'\n+import type { AppProps } from 'next/app'\n+import OnNavigate from '../shared/OnNavigate'\n+\n+export default function App({ Component, pageProps }: AppProps) {\n+  return (\n+    <OnNavigate rootPath=\"/pages-router\">\n+      <Component {...pageProps} />\n+    </OnNavigate>\n+  )\n+}"
        },
        {
            "sha": "c645ced835fd189b949ceebe0009f53ae07facce",
            "filename": "test/e2e/link-on-navigate-prop/pages/pages-router/index.tsx",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fpages%2Fpages-router%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fpages%2Fpages-router%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Fpages%2Fpages-router%2Findex.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,5 @@\n+import React from 'react'\n+\n+export default function Home() {\n+  return <div>Home</div>\n+}"
        },
        {
            "sha": "9b1edff8e0e3d4441154bd98ebb5f81740ede392",
            "filename": "test/e2e/link-on-navigate-prop/pages/pages-router/subpage/index.tsx",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fpages%2Fpages-router%2Fsubpage%2Findex.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fpages%2Fpages-router%2Fsubpage%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Fpages%2Fpages-router%2Fsubpage%2Findex.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,5 @@\n+import React from 'react'\n+\n+export default function Subpage() {\n+  return <div>Subpage</div>\n+}"
        },
        {
            "sha": "52e5dbe6b720076530cf2dee58a9fbb59675ac69",
            "filename": "test/e2e/link-on-navigate-prop/public/zip.zip",
            "status": "added",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fpublic%2Fzip.zip",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fpublic%2Fzip.zip",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Fpublic%2Fzip.zip?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,2 @@\n+// This is a stub file to simulate a downloadable zip file\n+// Used in download link tests to verify onClick/onNavigate behavior\n\\ No newline at end of file"
        },
        {
            "sha": "6c6ffc16e7990df9ee7497256f655a89988a49d8",
            "filename": "test/e2e/link-on-navigate-prop/shared/OnNavigate.tsx",
            "status": "added",
            "additions": 116,
            "deletions": 0,
            "changes": 116,
            "blob_url": "https://github.com/vercel/next.js/blob/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fshared%2FOnNavigate.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/608ffdad208b607a3ca41c6f7a2716dc3d0f6beb/test%2Fe2e%2Flink-on-navigate-prop%2Fshared%2FOnNavigate.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Flink-on-navigate-prop%2Fshared%2FOnNavigate.tsx?ref=608ffdad208b607a3ca41c6f7a2716dc3d0f6beb",
            "patch": "@@ -0,0 +1,116 @@\n+import Link from 'next/link'\n+import { useState } from 'react'\n+import React from 'react'\n+\n+interface OnNavigateProps {\n+  children: React.ReactNode\n+  rootPath: string\n+}\n+\n+export default function OnNavigate({ children, rootPath }: OnNavigateProps) {\n+  const [isClicked, setIsClicked] = useState(false)\n+  const [isNavigated, setIsNavigated] = useState(false)\n+  const [isLocked, setIsLocked] = useState(false)\n+\n+  return (\n+    <div>\n+      <nav>\n+        <div id=\"navigation-state\">\n+          <p id=\"is-clicked\">isClicked: {isClicked ? 'true' : 'false'}</p>\n+          <p id=\"is-navigated\">isNavigated: {isNavigated ? 'true' : 'false'}</p>\n+          <p id=\"is-locked\">isLocked: {isLocked ? 'true' : 'false'}</p>\n+        </div>\n+        <button id=\"toggle-lock\" onClick={() => setIsLocked(!isLocked)}>\n+          {isLocked ? 'Unlock' : 'Lock'}\n+        </button>\n+\n+        <div>\n+          <Link\n+            href={rootPath}\n+            id=\"link-to-main\"\n+            onClick={() => setIsClicked(true)}\n+            onNavigate={(e: any) => {\n+              if (isLocked) {\n+                e.preventDefault()\n+              } else {\n+                setIsNavigated(true)\n+              }\n+            }}\n+          >\n+            Client Side Navigation to Main Page\n+          </Link>\n+        </div>\n+\n+        <div>\n+          <Link\n+            href={`${rootPath}/subpage`}\n+            id=\"link-to-subpage\"\n+            onClick={() => setIsClicked(true)}\n+            onNavigate={(e: any) => {\n+              if (isLocked) {\n+                e.preventDefault()\n+              } else {\n+                setIsNavigated(true)\n+              }\n+            }}\n+          >\n+            Client Side Navigation to Subpage\n+          </Link>\n+        </div>\n+\n+        <div>\n+          <Link\n+            href=\"https://nextjs.org\"\n+            id=\"external-link-with-target\"\n+            onClick={() => setIsClicked(true)}\n+            onNavigate={() => setIsNavigated(true)}\n+            target=\"_blank\"\n+          >\n+            External Link with Target\n+          </Link>\n+        </div>\n+\n+        <div>\n+          <Link\n+            href=\"https://nextjs.org\"\n+            id=\"external-link\"\n+            onClick={() => alert('onClick')}\n+            onNavigate={() => alert('onNavigate')}\n+          >\n+            External Link\n+          </Link>\n+        </div>\n+\n+        <div>\n+          <Link\n+            href=\"https://nextjs.org\"\n+            id=\"external-link-with-replace\"\n+            onClick={() => alert('onClick')}\n+            onNavigate={() => alert('onNavigate')}\n+            replace\n+          >\n+            External Link with replace\n+          </Link>\n+        </div>\n+\n+        <div>\n+          <Link\n+            download\n+            href=\"/zip.zip\"\n+            id=\"download-link\"\n+            onClick={() => setIsClicked(true)}\n+            onNavigate={() => {\n+              setIsNavigated(true)\n+            }}\n+          >\n+            Download Link with download attribute\n+          </Link>\n+        </div>\n+      </nav>\n+\n+      <div id=\"content\" style={{ border: '1px solid red' }}>\n+        {children}\n+      </div>\n+    </div>\n+  )\n+}"
        }
    ],
    "stats": {
        "total": 461,
        "additions": 453,
        "deletions": 8
    }
}