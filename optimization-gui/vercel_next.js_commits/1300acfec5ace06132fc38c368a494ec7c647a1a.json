{
    "author": "mischnic",
    "message": "Turbopack: rename some fields in fs (#83808)\n\nApply suggestions from https://github.com/vercel/next.js/pull/83805",
    "sha": "1300acfec5ace06132fc38c368a494ec7c647a1a",
    "files": [
        {
            "sha": "8f25daa3a0b1c4bb8d181399503b66d5f109e2bf",
            "filename": "turbopack/crates/turbo-tasks-fs/src/lib.rs",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs?ref=1300acfec5ace06132fc38c368a494ec7c647a1a",
            "patch": "@@ -1387,7 +1387,7 @@ impl FileSystemPath {\n     // is invalid.\n     pub async fn realpath(&self) -> Result<FileSystemPath> {\n         let result = &(*self.realpath_with_links().await?);\n-        match &result.path_or_error {\n+        match &result.path_result {\n             Ok(path) => Ok(path.clone()),\n             Err(error) => Err(anyhow::anyhow!(error.as_error_message(self, result))),\n         }\n@@ -1449,7 +1449,7 @@ impl ValueToString for FileSystemPath {\n #[derive(Clone, Debug)]\n #[turbo_tasks::value(shared)]\n pub struct RealPathResult {\n-    pub path_or_error: Result<FileSystemPath, RealPathResultError>,\n+    pub path_result: Result<FileSystemPath, RealPathResultError>,\n     pub symlinks: Vec<FileSystemPath>,\n }\n \n@@ -2121,7 +2121,7 @@ impl DirectoryEntry {\n     pub async fn resolve_symlink(self) -> Result<Self> {\n         if let DirectoryEntry::Symlink(symlink) = &self {\n             let result = &*symlink.realpath_with_links().await?;\n-            let real_path = match &result.path_or_error {\n+            let real_path = match &result.path_result {\n                 Ok(path) => path,\n                 Err(error) => {\n                     return Ok(DirectoryEntry::Error(\n@@ -2136,9 +2136,9 @@ impl DirectoryEntry {\n                 FileSystemEntryType::NotFound => DirectoryEntry::Error(\n                     format!(\"Symlink {symlink} points at {real_path} which does not exist\").into(),\n                 ),\n+                // This is caused by eventual consistency\n                 FileSystemEntryType::Symlink => bail!(\n-                    \"Symlink {symlink} points at a symlink but realpath_with_links returned a \\\n-                     path, this is caused by eventual consistency.\"\n+                    \"Symlink {symlink} points at a symlink but realpath_with_links returned a path\"\n                 ),\n                 _ => self,\n             })\n@@ -2376,7 +2376,7 @@ async fn realpath_with_links(path: FileSystemPath) -> Result<Vc<RealPathResult>>\n         if current_path.is_root() {\n             // fast path\n             return Ok(RealPathResult {\n-                path_or_error: Ok(current_path),\n+                path_result: Ok(current_path),\n                 symlinks: symlinks.into_iter().collect(),\n             }\n             .cell());\n@@ -2395,7 +2395,7 @@ async fn realpath_with_links(path: FileSystemPath) -> Result<Vc<RealPathResult>>\n             .rsplit_once('/')\n             .map_or(current_path.path.as_str(), |(_, name)| name);\n         symlinks.extend(parent_result.symlinks);\n-        let parent_path = match parent_result.path_or_error {\n+        let parent_path = match parent_result.path_result {\n             Ok(path) => {\n                 if path != parent {\n                     current_path = path.join(basename)?;\n@@ -2415,7 +2415,7 @@ async fn realpath_with_links(path: FileSystemPath) -> Result<Vc<RealPathResult>>\n             FileSystemEntryType::Symlink\n         ) {\n             return Ok(RealPathResult {\n-                path_or_error: Ok(current_path),\n+                path_result: Ok(current_path),\n                 symlinks: symlinks.into_iter().collect(), // convert set to vec\n             }\n             .cell());\n@@ -2450,7 +2450,7 @@ async fn realpath_with_links(path: FileSystemPath) -> Result<Vc<RealPathResult>>\n     // Returning the followed symlinks is still important, even if there is an error! Otherwise\n     // we may never notice if the symlink loop is fixed.\n     Ok(RealPathResult {\n-        path_or_error: Err(error),\n+        path_result: Err(error),\n         symlinks: symlinks.into_iter().collect(),\n     }\n     .cell())"
        },
        {
            "sha": "a61043d6c6f128bf91392b3b2cd28338cbd08801",
            "filename": "turbopack/crates/turbopack-core/src/node_addon_module.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fnode_addon_module.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fnode_addon_module.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fnode_addon_module.rs?ref=1300acfec5ace06132fc38c368a494ec7c647a1a",
            "patch": "@@ -121,7 +121,7 @@ async fn dir_references(package_dir: FileSystemPath) -> Result<Vc<ModuleReferenc\n             PatternMatch::File(_, file) => {\n                 let realpath = file.realpath_with_links().await?;\n                 results.extend(realpath.symlinks.iter().cloned());\n-                match &realpath.path_or_error {\n+                match &realpath.path_result {\n                     Ok(path) => {\n                         results.insert(path.clone());\n                     }"
        },
        {
            "sha": "67cb84a438c46f6334e19c893a40c104b226d425",
            "filename": "turbopack/crates/turbopack-core/src/resolve/mod.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-core%2Fsrc%2Fresolve%2Fmod.rs?ref=1300acfec5ace06132fc38c368a494ec7c647a1a",
            "patch": "@@ -1185,7 +1185,7 @@ async fn realpath(\n             .try_join()\n             .await?,\n     );\n-    match &result.path_or_error {\n+    match &result.path_result {\n         Ok(path) => Ok(path.clone()),\n         Err(e) => bail!(e.as_error_message(fs_path, &result)),\n     }\n@@ -1520,7 +1520,7 @@ pub async fn resolve_raw(\n ) -> Result<Vc<ResolveResult>> {\n     async fn to_result(request: RcStr, path: FileSystemPath) -> Result<Vc<ResolveResult>> {\n         let result = &*path.realpath_with_links().await?;\n-        let path = match &result.path_or_error {\n+        let path = match &result.path_result {\n             Ok(path) => path,\n             Err(e) => bail!(e.as_error_message(&path, result)),\n         };\n@@ -2873,7 +2873,7 @@ async fn resolved(\n     fragment: RcStr,\n ) -> Result<Vc<ResolveResult>> {\n     let result = &*fs_path.realpath_with_links().await?;\n-    let path = match &result.path_or_error {\n+    let path = match &result.path_result {\n         Ok(path) => path,\n         Err(e) => bail!(e.as_error_message(&fs_path, result)),\n     };"
        },
        {
            "sha": "48a13b6083211dda4beaf77bf404bba55839b3d8",
            "filename": "turbopack/crates/turbopack-ecmascript/src/references/node.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fnode.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fnode.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Fsrc%2Freferences%2Fnode.rs?ref=1300acfec5ace06132fc38c368a494ec7c647a1a",
            "patch": "@@ -124,7 +124,7 @@ async fn resolve_reference_from_dir(\n                         FileSource::new(symlink.clone()).to_resolved().await?,\n                     ));\n                 }\n-                let path: FileSystemPath = match &realpath.path_or_error {\n+                let path: FileSystemPath = match &realpath.path_result {\n                     Ok(path) => path.clone(),\n                     Err(e) => bail!(e.as_error_message(file, &realpath)),\n                 };"
        },
        {
            "sha": "83d03698b2ab3799911546d7498b44c563f0f33d",
            "filename": "turbopack/crates/turbopack-resolve/src/node_native_binding.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbopack-resolve%2Fsrc%2Fnode_native_binding.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/1300acfec5ace06132fc38c368a494ec7c647a1a/turbopack%2Fcrates%2Fturbopack-resolve%2Fsrc%2Fnode_native_binding.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-resolve%2Fsrc%2Fnode_native_binding.rs?ref=1300acfec5ace06132fc38c368a494ec7c647a1a",
            "patch": "@@ -185,7 +185,7 @@ pub async fn resolve_node_pre_gyp_files(\n                         }\n                         sources.insert(\n                             format!(\"deps/lib/{key}\").into(),\n-                            Vc::upcast(FileSource::new(match &realpath_with_links.path_or_error {\n+                            Vc::upcast(FileSource::new(match &realpath_with_links.path_result {\n                                 Ok(path) => path.clone(),\n                                 Err(e) => bail!(e.as_error_message(dylib, &realpath_with_links)),\n                             })),"
        }
    ],
    "stats": {
        "total": 30,
        "additions": 15,
        "deletions": 15
    }
}