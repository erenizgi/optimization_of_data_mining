{
    "author": "mischnic",
    "message": "Upgrade to rustc 2026-01-04 (#88095)",
    "sha": "507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
    "files": [
        {
            "sha": "9674a6e7d731714d4dc48a0defff7b7232aa632f",
            "filename": ".devcontainer/rust/devcontainer-feature.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/.devcontainer%2Frust%2Fdevcontainer-feature.json",
            "raw_url": "https://github.com/vercel/next.js/raw/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/.devcontainer%2Frust%2Fdevcontainer-feature.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/.devcontainer%2Frust%2Fdevcontainer-feature.json?ref=507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
            "patch": "@@ -5,7 +5,7 @@\n   \"dependsOn\": {\n     \"ghcr.io/devcontainers/features/rust:1\": {\n       // this should match the `rust-toolchain.toml`\n-      \"version\": \"nightly-2025-09-21\",\n+      \"version\": \"nightly-2026-01-04\",\n       \"profile\": \"minimal\",\n       \"components\": \"rustfmt,clippy,rust-analyzer\"\n     }"
        },
        {
            "sha": "d5caa2c28d7dc5f63e86e292a8ceff068162f355",
            "filename": "Cargo.lock",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/Cargo.lock",
            "raw_url": "https://github.com/vercel/next.js/raw/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/Cargo.lock",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.lock?ref=507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
            "patch": "@@ -3208,18 +3208,16 @@ checksum = \"e7c5cedc30da3a610cac6b4ba17597bdf7152cf974e8aab3afb3d54455e371c8\"\n \n [[package]]\n name = \"include_dir\"\n-version = \"0.7.3\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"18762faeff7122e89e0857b02f7ce6fcc0d101d5e9ad2ad7846cc01d61b7f19e\"\n+version = \"0.7.4\"\n+source = \"git+https://github.com/vercel-labs/include_dir?branch=turbopack#0f23fcc20e37577a75a02d39ec55abfaf015faa3\"\n dependencies = [\n  \"include_dir_macros\",\n ]\n \n [[package]]\n name = \"include_dir_macros\"\n-version = \"0.7.3\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"b139284b5cf57ecfa712bcc66950bb635b31aff41c188e8a4cfc758eca374a3f\"\n+version = \"0.7.4\"\n+source = \"git+https://github.com/vercel-labs/include_dir?branch=turbopack#0f23fcc20e37577a75a02d39ec55abfaf015faa3\"\n dependencies = [\n  \"proc-macro2\",\n  \"quote\","
        },
        {
            "sha": "ef160d051f4e268c8948b624c2eaed9b45fbc11d",
            "filename": "Cargo.toml",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/Cargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/Cargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/Cargo.toml?ref=507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
            "patch": "@@ -484,4 +484,7 @@ webbrowser = \"1.0.6\"\n [patch.crates-io]\n bincode = { git = \"https://github.com/bgw/bincode.git\", branch = \"bgw/patches\" }\n virtue = { git = \"https://github.com/bgw/virtue.git\", branch = \"bgw/fix-generic-default-parsing\" }\n+# We have to very frequently bump the swc major version of mdxjs-rs\n mdxjs = { git = \"https://github.com/vercel-labs/mdxjs-rs-turbopack.git\", branch = \"turbopack\" }\n+# Doesn't compile on recent nightly versions because of https://github.com/Michael-F-Bryan/include_dir/pull/117\n+include_dir = { git = \"https://github.com/vercel-labs/include_dir\", branch = \"turbopack\" }"
        },
        {
            "sha": "a90764c7ed8cccbe423af175eaf8ad4b85e364c5",
            "filename": "rust-toolchain.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/rust-toolchain.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/rust-toolchain.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/rust-toolchain.toml?ref=507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
            "patch": "@@ -1,5 +1,5 @@\n # if you update this, also update `.devcontainer/rust/devcontainer-feature.json`\n [toolchain]\n-channel = \"nightly-2025-10-27\"\n+channel = \"nightly-2026-01-04\"\n components = [\"rustfmt\", \"clippy\", \"rust-analyzer\"]\n profile = \"minimal\""
        },
        {
            "sha": "57477aa9f4028d81e8d7aa50cffa318f4a3f9ed7",
            "filename": "turbopack/crates/turbo-tasks-fs/Cargo.toml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks-fs%2FCargo.toml",
            "raw_url": "https://github.com/vercel/next.js/raw/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks-fs%2FCargo.toml",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2FCargo.toml?ref=507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
            "patch": "@@ -32,7 +32,7 @@ concurrent-queue = { workspace = true }\n dashmap = { workspace = true }\n dunce = { workspace = true }\n futures = { workspace = true }\n-include_dir = { version = \"0.7.2\", features = [\"nightly\"] }\n+include_dir = { version = \"0.7.3\", features = [\"nightly\"] }\n indexmap = { workspace = true }\n jsonc-parser = { version = \"0.26.3\", features = [\"serde\"] }\n mime = { workspace = true }"
        },
        {
            "sha": "d10018fea65b7496cb06d6345adc336143af0897",
            "filename": "turbopack/crates/turbo-tasks-fs/src/lib.rs",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-fs%2Fsrc%2Flib.rs?ref=507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
            "patch": "@@ -8,6 +8,7 @@\n // stdlib into our source tree\n #![feature(normalize_lexically)]\n #![feature(trivial_bounds)]\n+#![feature(downcast_unchecked)]\n // Junction points are used on Windows. We could use a third-party crate for this if the junction\n // API isn't eventually stabilized.\n #![cfg_attr(windows, feature(junction_point))]"
        },
        {
            "sha": "bde25a6720f9c0c617de9dc1630855986cba86b3",
            "filename": "turbopack/crates/turbo-tasks/src/effect.rs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Feffect.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Feffect.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Feffect.rs?ref=507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
            "patch": "@@ -298,7 +298,7 @@ impl ApplyEffectsContext {\n                 .get_mut(&TypeId::of::<T>())\n                 .map(|value| {\n                     // Safety: the map is keyed by TypeId\n-                    unsafe { value.downcast_mut_unchecked() }\n+                    unsafe { value.downcast_unchecked_mut() }\n                 })\n                 .map(f)\n         })\n@@ -315,7 +315,7 @@ impl ApplyEffectsContext {\n             });\n             f(\n                 // Safety: the map is keyed by TypeId\n-                unsafe { value.downcast_mut_unchecked() },\n+                unsafe { value.downcast_unchecked_mut() },\n             )\n         })\n     }"
        },
        {
            "sha": "6d00a5a75f267e2e74c8676f9d0a6b8b2ed5ee20",
            "filename": "turbopack/crates/turbo-tasks/src/lib.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Flib.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Flib.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Flib.rs?ref=507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
            "patch": "@@ -37,7 +37,6 @@\n #![feature(downcast_unchecked)]\n #![feature(ptr_metadata)]\n #![feature(sync_unsafe_cell)]\n-#![feature(vec_into_raw_parts)]\n #![feature(async_fn_traits)]\n \n pub mod backend;"
        },
        {
            "sha": "300578ab83b134be5ec7f12d3cccb7f1f899fa2b",
            "filename": "turbopack/crates/turbo-tasks/src/scope.rs",
            "status": "modified",
            "additions": 8,
            "deletions": 5,
            "changes": 13,
            "blob_url": "https://github.com/vercel/next.js/blob/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fscope.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/507194aa64c6f0ef21a07f40e1f2a4f862154bd9/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fscope.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fscope.rs?ref=507194aa64c6f0ef21a07f40e1f2a4f862154bd9",
            "patch": "@@ -209,13 +209,16 @@ impl<'scope, 'env: 'scope, R: Send + 'env> Scope<'scope, 'env, R> {\n             *result_cell.lock() = Some(result);\n         });\n         let f: *mut (dyn FnOnce() + Send + 'scope) = Box::into_raw(f);\n+\n         // SAFETY: Scope ensures (e. g. in Drop) that spawned tasks is awaited before the\n         // lifetime `'env` ends.\n-        #[allow(\n-            clippy::unnecessary_cast,\n-            reason = \"Clippy thinks this is unnecessary, but it actually changes the lifetime\"\n-        )]\n-        let f = f as *mut (dyn FnOnce() + Send + 'static);\n+        let f = unsafe {\n+            std::mem::transmute::<\n+                *mut (dyn FnOnce() + Send + 'scope),\n+                *mut (dyn FnOnce() + Send + 'static),\n+            >(f)\n+        };\n+\n         // SAFETY: We just called `Box::into_raw`.\n         let f = unsafe { Box::from_raw(f) };\n "
        }
    ],
    "stats": {
        "total": 38,
        "additions": 21,
        "deletions": 17
    }
}