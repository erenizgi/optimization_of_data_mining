{
    "author": "wbinnssmith",
    "message": "Telemetry: include alternate bundler state in key events (#76886)\n\nThis includes `isRspack` in the following telemetry events, determining\nit with the presence of `process.env.NEXT_RSPACK`:\n\n- `NEXT_CLI_SESSION_STARTED`\n- `NEXT_CLI_SESSION_STOPPED`\n- `NEXT_BUILD_OPTIMIZED`\n\nTest Plan: Verify these are included with `NEXT_TELEMETRY_DEBUG=1` for\nboth `next dev` and `next build`",
    "sha": "dfd18f97adff9ba946419526094d37ede55b37ab",
    "files": [
        {
            "sha": "4e826a9bea3a871e30461104235c49e3633187be",
            "filename": "packages/next/src/telemetry/events/build.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/dfd18f97adff9ba946419526094d37ede55b37ab/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fbuild.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dfd18f97adff9ba946419526094d37ede55b37ab/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fbuild.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fbuild.ts?ref=dfd18f97adff9ba946419526094d37ede55b37ab",
            "patch": "@@ -103,6 +103,7 @@ type EventBuildOptimized = {\n   rewritesWithHasCount: number\n   redirectsWithHasCount: number\n   middlewareCount: number\n+  isRspack: boolean\n   totalAppPagesCount?: number\n   staticAppPagesCount?: number\n   serverAppPagesCount?: number\n@@ -114,7 +115,7 @@ export function eventBuildOptimize(\n   pagePaths: string[],\n   event: Omit<\n     EventBuildOptimized,\n-    'totalPageCount' | 'hasDunderPages' | 'hasTestPages'\n+    'totalPageCount' | 'hasDunderPages' | 'hasTestPages' | 'isRspack'\n   >\n ): { eventName: string; payload: EventBuildOptimized } {\n   return {\n@@ -134,6 +135,7 @@ export function eventBuildOptimize(\n       serverAppPagesCount: event.serverAppPagesCount,\n       edgeRuntimeAppCount: event.edgeRuntimeAppCount,\n       edgeRuntimePagesCount: event.edgeRuntimePagesCount,\n+      isRspack: process.env.NEXT_RSPACK !== undefined,\n     },\n   }\n }"
        },
        {
            "sha": "d2ba816349073ba4f85b0e9cadd6a879e83cfcce",
            "filename": "packages/next/src/telemetry/events/session-stopped.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/dfd18f97adff9ba946419526094d37ede55b37ab/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fsession-stopped.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dfd18f97adff9ba946419526094d37ede55b37ab/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fsession-stopped.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fsession-stopped.ts?ref=dfd18f97adff9ba946419526094d37ede55b37ab",
            "patch": "@@ -8,10 +8,14 @@ export type EventCliSessionStopped = {\n   durationMilliseconds?: number | null\n   pagesDir?: boolean\n   appDir?: boolean\n+  isRspack: boolean\n }\n \n export function eventCliSessionStopped(\n-  event: Omit<EventCliSessionStopped, 'nextVersion' | 'nodeVersion'>\n+  event: Omit<\n+    EventCliSessionStopped,\n+    'nextVersion' | 'nodeVersion' | 'isRspack'\n+  >\n ): { eventName: string; payload: EventCliSessionStopped }[] {\n   // This should be an invariant, if it fails our build tooling is broken.\n   if (typeof process.env.__NEXT_VERSION !== 'string') {\n@@ -30,6 +34,7 @@ export function eventCliSessionStopped(\n       : {}),\n     pagesDir: event.pagesDir,\n     appDir: event.appDir,\n+    isRspack: process.env.NEXT_RSPACK !== undefined,\n   }\n   return [{ eventName: EVENT_VERSION, payload }]\n }"
        },
        {
            "sha": "0f7585c63dbfebbe1d99e79147559a44fad0df1d",
            "filename": "packages/next/src/telemetry/events/version.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/dfd18f97adff9ba946419526094d37ede55b37ab/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fversion.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/dfd18f97adff9ba946419526094d37ede55b37ab/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fversion.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Ftelemetry%2Fevents%2Fversion.ts?ref=dfd18f97adff9ba946419526094d37ede55b37ab",
            "patch": "@@ -33,6 +33,7 @@ type EventCliSessionStarted = {\n   reactStrictMode: boolean\n   webpackVersion: number | null\n   turboFlag: boolean\n+  isRspack: boolean\n   appDir: boolean | null\n   pagesDir: boolean | null\n   staticStaleTime: number | null\n@@ -93,6 +94,7 @@ export function eventCliSession(\n     | 'reactCompiler'\n     | 'reactCompilerCompilationMode'\n     | 'reactCompilerPanicThreshold'\n+    | 'isRspack'\n   >\n ): { eventName: string; payload: EventCliSessionStarted }[] {\n   // This should be an invariant, if it fails our build tooling is broken.\n@@ -136,6 +138,7 @@ export function eventCliSession(\n     reactStrictMode: !!nextConfig?.reactStrictMode,\n     webpackVersion: event.webpackVersion || null,\n     turboFlag: event.turboFlag || false,\n+    isRspack: process.env.NEXT_RSPACK !== undefined,\n     appDir: event.appDir,\n     pagesDir: event.pagesDir,\n     staticStaleTime: nextConfig.experimental.staleTimes?.static ?? null,"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
    }
}