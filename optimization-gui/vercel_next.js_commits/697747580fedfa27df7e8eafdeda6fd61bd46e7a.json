{
    "author": "unstubbable",
    "message": "Show invalid default export errors during prerendering (#84242)\n\nThe specific error messages for invalid default exports in pages,\nlayouts, and error files were only shown in development mode. This\nchange ensures that these errors are also displayed during prerendering,\nwhich replaces the unhelpful error messages we were seeing before.\n\nImproving these error messages is the subject of #76330.\n\ncloses NAR-272",
    "sha": "697747580fedfa27df7e8eafdeda6fd61bd46e7a",
    "files": [
        {
            "sha": "2cea1f548ee7c8795330f9cc4cb5d1a12f8fa51c",
            "filename": "packages/next/src/server/app-render/create-component-tree.tsx",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/697747580fedfa27df7e8eafdeda6fd61bd46e7a/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/697747580fedfa27df7e8eafdeda6fd61bd46e7a/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fcreate-component-tree.tsx?ref=697747580fedfa27df7e8eafdeda6fd61bd46e7a",
            "patch": "@@ -371,7 +371,7 @@ async function createComponentTreeInternal(\n    */\n   let MaybeComponent = LayoutOrPage\n \n-  if (process.env.NODE_ENV === 'development') {\n+  if (process.env.NODE_ENV === 'development' || isStaticGeneration) {\n     const { isValidElementType } =\n       require('next/dist/compiled/react-is') as typeof import('next/dist/compiled/react-is')\n     if ("
        },
        {
            "sha": "436fd70cc07e87f0afab84d668b90b03f2c6a9da",
            "filename": "test/e2e/app-dir/undefined-default-export/undefined-default-export.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/697747580fedfa27df7e8eafdeda6fd61bd46e7a/test%2Fe2e%2Fapp-dir%2Fundefined-default-export%2Fundefined-default-export.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/697747580fedfa27df7e8eafdeda6fd61bd46e7a/test%2Fe2e%2Fapp-dir%2Fundefined-default-export%2Fundefined-default-export.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fundefined-default-export%2Fundefined-default-export.test.ts?ref=697747580fedfa27df7e8eafdeda6fd61bd46e7a",
            "patch": "@@ -51,24 +51,24 @@ describe('Undefined default export', () => {\n       `)\n     })\n   } else {\n-    it('errors the build with unhelpful error messages', async () => {\n+    it('errors the build with helpful error messages', async () => {\n       const { cliOutput, exitCode } = await next.build()\n \n       expect(exitCode).toBe(1)\n \n       expect(cliOutput).toContain(\n         `Error occurred prerendering page \"/specific-path/1\". Read more: https://nextjs.org/docs/messages/prerender-error\n-Error: Functions cannot be passed directly to Client Components unless you explicitly expose it by marking it with \"use server\". Or maybe you meant to call this function rather than return it.Module`\n+Error: The default export is not a React Component in \"/specific-path/1/page\"`\n       )\n \n       expect(cliOutput).toContain(\n         `Error occurred prerendering page \"/specific-path/2\". Read more: https://nextjs.org/docs/messages/prerender-error\n-Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: object.`\n+Error: The default export is not a React Component in \"/specific-path/2/layout\"`\n       )\n \n       expect(cliOutput).toContain(\n         `Error occurred prerendering page \"/will-not-found\". Read more: https://nextjs.org/docs/messages/prerender-error\n-Error: Functions cannot be passed directly to Client Components unless you explicitly expose it by marking it with \"use server\". Or maybe you meant to call this function rather than return it.Module`\n+Error: The default export is not a React Component in \"/will-not-found/not-found\"`\n       )\n     })\n   }"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
    }
}