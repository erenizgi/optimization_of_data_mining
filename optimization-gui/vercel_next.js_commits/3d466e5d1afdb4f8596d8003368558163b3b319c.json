{
    "author": "sokra",
    "message": "Turbopack: trace state changes (#83977)\n\n### What?\n\nadd a tracing span when state changes to make this visible in the tracing.",
    "sha": "3d466e5d1afdb4f8596d8003368558163b3b319c",
    "files": [
        {
            "sha": "8e5b4d217df50d188e47eceb787bbd76a29c0ded",
            "filename": "turbopack/crates/turbo-tasks/src/state.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/3d466e5d1afdb4f8596d8003368558163b3b319c/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fstate.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/3d466e5d1afdb4f8596d8003368558163b3b319c/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fstate.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks%2Fsrc%2Fstate.rs?ref=3d466e5d1afdb4f8596d8003368558163b3b319c",
            "patch": "@@ -1,4 +1,5 @@\n use std::{\n+    any::type_name,\n     fmt::Debug,\n     mem::take,\n     ops::{Deref, DerefMut},\n@@ -7,6 +8,7 @@ use std::{\n use auto_hash_map::AutoSet;\n use parking_lot::{Mutex, MutexGuard};\n use serde::{Deserialize, Serialize};\n+use tracing::trace_span;\n \n use crate::{\n     Invalidator, OperationValue, SerializationInvalidator, get_invalidator, mark_session_dependent,\n@@ -54,6 +56,7 @@ impl<T: PartialEq> StateInner<T> {\n         if self.value == value {\n             return false;\n         }\n+        let _span = trace_span!(\"state value changed\", value_type = type_name::<T>()).entered();\n         self.value = value;\n         for invalidator in take(&mut self.invalidators) {\n             invalidator.invalidate();"
        }
    ],
    "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
    }
}