{
    "author": "ijjk",
    "message": "Add new updateTag API and new signature for revalidateTag (#83822)",
    "sha": "e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
    "files": [
        {
            "sha": "6f841be1156ff295db8b43179d097179fcd8c17b",
            "filename": "crates/next-custom-transforms/src/transforms/react_server_components.rs",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Freact_server_components.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Freact_server_components.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Fsrc%2Ftransforms%2Freact_server_components.rs?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -654,8 +654,6 @@ impl ReactServerComponentValidator {\n                         // \"unstable_cache\", // useless in client, but doesn't technically error\n                         \"unstable_cacheLife\",\n                         \"unstable_cacheTag\",\n-                        \"unstable_expirePath\",\n-                        \"unstable_expireTag\",\n                         // \"unstable_noStore\" // no-op in client, but allowed for legacy reasons\n                     ],\n                 ),"
        },
        {
            "sha": "c4ce6b157443c860db98537095c546f5007390e5",
            "filename": "docs/01-app/01-getting-started/09-caching-and-revalidating.mdx",
            "status": "modified",
            "additions": 65,
            "deletions": 5,
            "changes": 70,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/docs%2F01-app%2F01-getting-started%2F09-caching-and-revalidating.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/docs%2F01-app%2F01-getting-started%2F09-caching-and-revalidating.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F01-getting-started%2F09-caching-and-revalidating.mdx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -9,6 +9,7 @@ related:\n     - app/api-reference/functions/unstable_cache\n     - app/api-reference/functions/revalidatePath\n     - app/api-reference/functions/revalidateTag\n+    - app/api-reference/functions/updateTag\n ---\n \n Caching is a technique for storing the result of data fetching and other computations so that future requests for the same data can be served faster, without doing the work again. While revalidation allows you to update cache entries without having to rebuild your entire application.\n@@ -19,6 +20,7 @@ Next.js provides a few APIs to handle caching and revalidation. This guide will\n - [`unstable_cache`](#unstable_cache)\n - [`revalidatePath`](#revalidatepath)\n - [`revalidateTag`](#revalidatetag)\n+- [`updateTag`](#updatetag)\n \n ## `fetch`\n \n@@ -154,7 +156,12 @@ See the [`unstable_cache` API reference](/docs/app/api-reference/functions/unsta\n \n ## `revalidateTag`\n \n-`revalidateTag` is used to revalidate cache entries based on a tag and following an event. To use it with `fetch`, start by tagging the function with the `next.tags` option:\n+`revalidateTag` is used to revalidate cache entries based on a tag and following an event. The function now supports two behaviors:\n+\n+- **With `profile=\"max\"`**: Uses stale-while-revalidate semantics, serving stale content while fetching fresh content in the background\n+- **Without the second argument**: Legacy behavior that immediately expires the cache (deprecated)\n+\n+To use it with `fetch`, start by tagging the function with the `next.tags` option:\n \n ```tsx filename=\"app/lib/data.ts\" highlight={3-5} switcher\n export async function getUserById(id: string) {\n@@ -204,21 +211,21 @@ export const getUserById = unstable_cache(\n \n Then, call `revalidateTag` in a [Route Handler](/docs/app/api-reference/file-conventions/route) or Server Action:\n \n-```tsx filename=\"app/lib/actions.ts\" highlight={1} switcher\n+```tsx filename=\"app/lib/actions.ts\" highlight={1,5} switcher\n import { revalidateTag } from 'next/cache'\n \n export async function updateUser(id: string) {\n   // Mutate data\n-  revalidateTag('user')\n+  revalidateTag('user', 'max') // Recommended: Uses stale-while-revalidate\n }\n ```\n \n-```jsx filename=\"app/lib/actions.js\" highlight={1} switcher\n+```jsx filename=\"app/lib/actions.js\" highlight={1,5} switcher\n import { revalidateTag } from 'next/cache'\n \n export async function updateUser(id) {\n   // Mutate data\n-  revalidateTag('user')\n+  revalidateTag('user', 'max') // Recommended: Uses stale-while-revalidate\n }\n ```\n \n@@ -247,3 +254,56 @@ export async function updateUser(id) {\n ```\n \n See the [`revalidatePath` API reference](/docs/app/api-reference/functions/revalidatePath) to learn more.\n+\n+## `updateTag`\n+\n+`updateTag` is specifically designed for Server Actions to immediately expire cached data for read-your-own-writes scenarios. Unlike `revalidateTag`, it can only be used within Server Actions and immediately expires the cache entry.\n+\n+```tsx filename=\"app/lib/actions.ts\" highlight={1,6} switcher\n+import { updateTag } from 'next/cache'\n+import { redirect } from 'next/navigation'\n+\n+export async function createPost(formData: FormData) {\n+  // Create post in database\n+  const post = await db.post.create({\n+    data: {\n+      title: formData.get('title'),\n+      content: formData.get('content'),\n+    },\n+  })\n+\n+  // Immediately expire cache so the new post is visible\n+  updateTag('posts')\n+  updateTag(`post-${post.id}`)\n+\n+  redirect(`/posts/${post.id}`)\n+}\n+```\n+\n+```jsx filename=\"app/lib/actions.js\" highlight={1,6} switcher\n+import { updateTag } from 'next/cache'\n+import { redirect } from 'next/navigation'\n+\n+export async function createPost(formData) {\n+  // Create post in database\n+  const post = await db.post.create({\n+    data: {\n+      title: formData.get('title'),\n+      content: formData.get('content'),\n+    },\n+  })\n+\n+  // Immediately expire cache so the new post is visible\n+  updateTag('posts')\n+  updateTag(`post-${post.id}`)\n+\n+  redirect(`/posts/${post.id}`)\n+}\n+```\n+\n+The key differences between `revalidateTag` and `updateTag`:\n+\n+- **`updateTag`**: Only in Server Actions, immediately expires cache, for read-your-own-writes\n+- **`revalidateTag`**: In Server Actions and Route Handlers, supports stale-while-revalidate with `profile=\"max\"`\n+\n+See the [`updateTag` API reference](/docs/app/api-reference/functions/updateTag) to learn more."
        },
        {
            "sha": "ab2f553df84ce5b5350c3b59df3119b957bf97b3",
            "filename": "docs/01-app/03-api-reference/04-functions/revalidateTag.mdx",
            "status": "modified",
            "additions": 15,
            "deletions": 6,
            "changes": 21,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/docs%2F01-app%2F03-api-reference%2F04-functions%2FrevalidateTag.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/docs%2F01-app%2F03-api-reference%2F04-functions%2FrevalidateTag.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2FrevalidateTag.mdx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -11,15 +11,24 @@ description: API Reference for the revalidateTag function.\n \n `revalidateTag` cannot be called in Client Components or Middleware, as it only works in server environments.\n \n-> **Good to know**: `revalidateTag` marks tagged data as stale, but fresh data is only fetched when pages using that tag are next visited. This means calling `revalidateTag` will not immediately trigger many revalidations at once. The invalidation only happens when any page using that tag is next visited.\n+### Revalidation Behavior\n+\n+The revalidation behavior depends on whether you provide the second argument:\n+\n+- **With `profile=\"max\"` (recommended)**: The tag entry is marked as stale, and the next time a resource with that tag is visited, it will use stale-while-revalidate semantics. This means the stale content is served while fresh content is fetched in the background.\n+- **With a custom cache life profile**: For advanced usage, you can specify any cache life profile that your application has defined, allowing for custom revalidation behaviors tailored to your specific caching requirements.\n+- **Without the second argument (deprecated)**: The tag entry is expired immediately, and the next request to that resource will be a blocking revalidate/cache miss. This behavior is now deprecated, and you should either use `profile=\"max\"` or migrate to `updateTag`.\n+\n+> **Good to know**: When using `profile=\"max\"`, `revalidateTag` marks tagged data as stale, but fresh data is only fetched when pages using that tag are next visited. This means calling `revalidateTag` will not immediately trigger many revalidations at once. The invalidation only happens when any page using that tag is next visited.\n \n ## Parameters\n \n ```tsx\n-revalidateTag(tag: string): void;\n+revalidateTag(tag: string, profile?: string): void;\n ```\n \n - `tag`: A string representing the cache tag associated with the data you want to revalidate. Must not exceed 256 characters. This value is case-sensitive.\n+- `profile`: A string that specifies the revalidation behavior. The recommended value is `\"max\"` which provides stale-while-revalidate semantics. For advanced usage, this can be configured to any cache life profile that your application defines.\n \n You can add tags to `fetch` as follows:\n \n@@ -48,7 +57,7 @@ import { revalidateTag } from 'next/cache'\n \n export default async function submit() {\n   await addPost()\n-  revalidateTag('posts')\n+  revalidateTag('posts', 'max')\n }\n ```\n \n@@ -59,7 +68,7 @@ import { revalidateTag } from 'next/cache'\n \n export default async function submit() {\n   await addPost()\n-  revalidateTag('posts')\n+  revalidateTag('posts', 'max')\n }\n ```\n \n@@ -73,7 +82,7 @@ export async function GET(request: NextRequest) {\n   const tag = request.nextUrl.searchParams.get('tag')\n \n   if (tag) {\n-    revalidateTag(tag)\n+    revalidateTag(tag, 'max')\n     return Response.json({ revalidated: true, now: Date.now() })\n   }\n \n@@ -92,7 +101,7 @@ export async function GET(request) {\n   const tag = request.nextUrl.searchParams.get('tag')\n \n   if (tag) {\n-    revalidateTag(tag)\n+    revalidateTag(tag, 'max')\n     return Response.json({ revalidated: true, now: Date.now() })\n   }\n "
        },
        {
            "sha": "36ea5963d60283a8ce5ccf771ceb6fd8eb9d4bdc",
            "filename": "docs/01-app/03-api-reference/04-functions/updateTag.mdx",
            "status": "added",
            "additions": 127,
            "deletions": 0,
            "changes": 127,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/docs%2F01-app%2F03-api-reference%2F04-functions%2FupdateTag.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/docs%2F01-app%2F03-api-reference%2F04-functions%2FupdateTag.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/docs%2F01-app%2F03-api-reference%2F04-functions%2FupdateTag.mdx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -0,0 +1,127 @@\n+---\n+title: updateTag\n+description: API Reference for the updateTag function.\n+---\n+\n+`updateTag` allows you to update [cached data](/docs/app/guides/caching) on-demand for a specific cache tag from within Server Actions. This function is designed specifically for read-your-own-writes scenarios.\n+\n+## Usage\n+\n+`updateTag` can **only** be called from within Server Actions. It cannot be used in Route Handlers, Client Components, or any other context.\n+\n+If you need to invalidate cache tags in Route Handlers or other contexts, use [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) instead.\n+\n+> **Good to know**: `updateTag` immediately expires the cached data for the specified tag, causing the next request to that resource to be a blocking revalidate/cache miss. This ensures that Server Actions can immediately see their own writes.\n+\n+## Parameters\n+\n+```tsx\n+updateTag(tag: string): void;\n+```\n+\n+- `tag`: A string representing the cache tag associated with the data you want to update. Must not exceed 256 characters. This value is case-sensitive.\n+\n+## Returns\n+\n+`updateTag` does not return a value.\n+\n+## Differences from revalidateTag\n+\n+While both `updateTag` and `revalidateTag` invalidate cached data, they serve different purposes:\n+\n+- **`updateTag`**:\n+  - Can only be used in Server Actions\n+  - Immediately expires the cache entry (blocking revalidate on next visit)\n+  - Designed for read-your-own-writes scenarios\n+\n+- **`revalidateTag`**:\n+  - Can be used in Server Actions and Route Handlers\n+  - With `profile=\"max\"` (recommended): Uses stale-while-revalidate semantics\n+  - With custom profile: Can be configured to any cache life profile for advanced usage\n+  - Without profile: legacy behavior which is equivalent to `updateTag`\n+\n+## Examples\n+\n+### Server Action with Read-Your-Own-Writes\n+\n+```ts filename=\"app/actions.ts\" switcher\n+'use server'\n+\n+import { updateTag } from 'next/cache'\n+import { redirect } from 'next/navigation'\n+\n+export async function createPost(formData: FormData) {\n+  const title = formData.get('title')\n+  const content = formData.get('content')\n+\n+  // Create the post in your database\n+  const post = await db.post.create({\n+    data: { title, content },\n+  })\n+\n+  // Update the cache so the new post is immediately visible\n+  updateTag('posts')\n+  updateTag(`post-${post.id}`)\n+\n+  // Redirect to the new post\n+  redirect(`/posts/${post.id}`)\n+}\n+```\n+\n+```js filename=\"app/actions.js\" switcher\n+'use server'\n+\n+import { updateTag } from 'next/cache'\n+import { redirect } from 'next/navigation'\n+\n+export async function createPost(formData) {\n+  const title = formData.get('title')\n+  const content = formData.get('content')\n+\n+  // Create the post in your database\n+  const post = await db.post.create({\n+    data: { title, content },\n+  })\n+\n+  // Update the cache so the new post is immediately visible\n+  updateTag('posts')\n+  updateTag(`post-${post.id}`)\n+\n+  // Redirect to the new post\n+  redirect(`/posts/${post.id}`)\n+}\n+```\n+\n+### Error when used outside Server Actions\n+\n+```ts filename=\"app/api/posts/route.ts\" switcher\n+import { updateTag } from 'next/cache'\n+\n+export async function POST() {\n+  // ❌ This will throw an error\n+  updateTag('posts')\n+  // Error: updateTag can only be called from within a Server Action\n+\n+  // ✅ Use revalidateTag instead in Route Handlers\n+  revalidateTag('posts', 'max')\n+}\n+```\n+\n+## When to use updateTag\n+\n+Use `updateTag` when:\n+\n+- You're in a Server Action\n+- You need immediate cache invalidation for read-your-own-writes\n+- You want to ensure the next request sees updated data\n+\n+Use `revalidateTag` instead when:\n+\n+- You're in a Route Handler or other non-action context\n+- You want stale-while-revalidate semantics\n+- You're building a webhook or API endpoint for cache invalidation\n+\n+## Related\n+\n+- [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) - For invalidating tags in Route Handlers\n+- [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath) - For invalidating specific paths"
        },
        {
            "sha": "0241140ac8045826386b9e64ee9fca39b55de17f",
            "filename": "errors/revalidate-tag-single-arg.mdx",
            "status": "added",
            "additions": 53,
            "deletions": 0,
            "changes": 53,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/errors%2Frevalidate-tag-single-arg.mdx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/errors%2Frevalidate-tag-single-arg.mdx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/errors%2Frevalidate-tag-single-arg.mdx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -0,0 +1,53 @@\n+---\n+title: revalidateTag Single Argument Deprecated\n+---\n+\n+## Why This Error Occurred\n+\n+You are using `revalidateTag` without providing the second argument, which is now deprecated. The function now requires a second argument to specify the revalidation behavior.\n+\n+## Possible Ways to Fix It\n+\n+### Option 1: Add the second argument\n+\n+Update your `revalidateTag` calls to include the second argument `\"max\"`:\n+\n+```js\n+// Before (deprecated)\n+revalidateTag('posts')\n+\n+// After\n+revalidateTag('posts', 'max')\n+```\n+\n+### Option 2: Use updateTag in Server Actions\n+\n+If you're calling this from a Server Action and need immediate expiration for read-your-own-writes, use `updateTag` instead:\n+\n+```js\n+// In a Server Action\n+import { updateTag } from 'next/cache'\n+\n+export async function createPost() {\n+  // ... create post ...\n+\n+  // Immediately expire the cache\n+  updateTag('posts')\n+}\n+```\n+\n+## Revalidation Behavior\n+\n+- **`revalidateTag(tag, \"max\")` (recommended)**: The tag entry is marked as stale, and the next time a resource with that tag is visited, it will use stale-while-revalidate semantics. This means the stale content is served while fresh content is fetched in the background.\n+\n+- **`revalidateTag(tag, profile)`**: For advanced usage, you can specify any cache life profile that your application has defined in your `next.config` instead of `\"max\"`, allowing for custom revalidation behaviors.\n+\n+- **`updateTag(tag)`**: Only available in Server Actions. The tag entry is expired immediately, and the next request to that resource will be a blocking revalidate/cache miss. This ensures read-your-own-writes consistency.\n+\n+- **`revalidateTag(tag)` without second argument (deprecated)**: Same behavior as `updateTag` but shows this deprecation warning.\n+\n+## Useful Links\n+\n+- [revalidateTag Documentation](/docs/app/api-reference/functions/revalidateTag)\n+- [updateTag Documentation](/docs/app/api-reference/functions/updateTag)\n+- [Caching in Next.js](/docs/app/getting-started/caching-and-revalidating)"
        },
        {
            "sha": "3e94fb3d997de751ba6692b087e443f20045c871",
            "filename": "packages/next/cache.d.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fcache.d.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fcache.d.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fcache.d.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -3,8 +3,7 @@ export { unstable_cache } from 'next/dist/server/web/spec-extension/unstable-cac\n export {\n   revalidatePath,\n   revalidateTag,\n-  unstable_expirePath,\n-  unstable_expireTag,\n+  updateTag,\n   refresh,\n } from 'next/dist/server/web/spec-extension/revalidate'\n "
        },
        {
            "sha": "961eb0a4db77cfb42bfd86b453b21f1cbf90fdfd",
            "filename": "packages/next/cache.js",
            "status": "modified",
            "additions": 4,
            "deletions": 7,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fcache.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fcache.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fcache.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -2,16 +2,14 @@ const cacheExports = {\n   unstable_cache: require('next/dist/server/web/spec-extension/unstable-cache')\n     .unstable_cache,\n \n+  updateTag: require('next/dist/server/web/spec-extension/revalidate')\n+    .updateTag,\n+\n   revalidateTag: require('next/dist/server/web/spec-extension/revalidate')\n     .revalidateTag,\n   revalidatePath: require('next/dist/server/web/spec-extension/revalidate')\n     .revalidatePath,\n \n-  unstable_expireTag: require('next/dist/server/web/spec-extension/revalidate')\n-    .unstable_expireTag,\n-  unstable_expirePath: require('next/dist/server/web/spec-extension/revalidate')\n-    .unstable_expirePath,\n-\n   refresh: require('next/dist/server/web/spec-extension/revalidate').refresh,\n \n   unstable_noStore:\n@@ -30,8 +28,7 @@ module.exports = cacheExports\n exports.unstable_cache = cacheExports.unstable_cache\n exports.revalidatePath = cacheExports.revalidatePath\n exports.revalidateTag = cacheExports.revalidateTag\n-exports.unstable_expireTag = cacheExports.unstable_expireTag\n-exports.unstable_expirePath = cacheExports.unstable_expirePath\n+exports.updateTag = cacheExports.updateTag\n exports.unstable_noStore = cacheExports.unstable_noStore\n exports.unstable_cacheLife = cacheExports.unstable_cacheLife\n exports.unstable_cacheTag = cacheExports.unstable_cacheTag"
        },
        {
            "sha": "77ff24134fa56f046354326dfbf361107e5c8252",
            "filename": "packages/next/errors.json",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Ferrors.json",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Ferrors.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Ferrors.json?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -869,5 +869,7 @@\n   \"868\": \"No reference found for param: %s in reference: %s\",\n   \"869\": \"No reference found for segment: %s with reference: %s\",\n   \"870\": \"refresh can only be called from within a Server Action. See more info here: https://nextjs.org/docs/app/api-reference/functions/refresh\",\n-  \"871\": \"Image with src \\\"%s\\\" is using a query string which is not configured in images.localPatterns.\\\\nRead more: https://nextjs.org/docs/messages/next-image-unconfigured-localpatterns\"\n+  \"871\": \"Image with src \\\"%s\\\" is using a query string which is not configured in images.localPatterns.\\\\nRead more: https://nextjs.org/docs/messages/next-image-unconfigured-localpatterns\",\n+  \"872\": \"updateTag can only be called from within a Server Action. To invalidate cache tags in Route Handlers or other contexts, use revalidateTag instead. See more info here: https://nextjs.org/docs/app/api-reference/functions/updateTag\",\n+  \"873\": \"Invalid profile provided \\\"%s\\\" must be configured under cacheLife in next.config or be \\\"max\\\"\"\n }"
        },
        {
            "sha": "75ec9bb807839dc330b9a926eb4661c6daa05fdf",
            "filename": "packages/next/src/build/webpack/plugins/next-types-plugin/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fnext-types-plugin%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fnext-types-plugin%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Fplugins%2Fnext-types-plugin%2Findex.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -530,10 +530,9 @@ function createCustomCacheLifeDefinitions(cacheLife: {\n declare module 'next/cache' {\n   export { unstable_cache } from 'next/dist/server/web/spec-extension/unstable-cache'\n   export {\n+    updateTag,\n     revalidateTag,\n     revalidatePath,\n-    unstable_expireTag,\n-    unstable_expirePath,\n     refresh,\n   } from 'next/dist/server/web/spec-extension/revalidate'\n   export { unstable_noStore } from 'next/dist/server/web/spec-extension/unstable-no-store'"
        },
        {
            "sha": "3bf2fb445f9a1a40baca765c71e6bdfdf6505a68",
            "filename": "packages/next/src/server/app-render/action-handler.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Faction-handler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Faction-handler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Faction-handler.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -346,7 +346,7 @@ async function createRedirectRenderResult(\n     if (workStore.pendingRevalidatedTags) {\n       forwardedHeaders.set(\n         NEXT_CACHE_REVALIDATED_TAGS_HEADER,\n-        workStore.pendingRevalidatedTags.join(',')\n+        workStore.pendingRevalidatedTags.map((item) => item.tag).join(',')\n       )\n       forwardedHeaders.set(\n         NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER,"
        },
        {
            "sha": "8c03c769a0803aaf8b55cc5eb50feb63f2871d11",
            "filename": "packages/next/src/server/app-render/work-async-storage.external.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fwork-async-storage.external.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fwork-async-storage.external.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Fwork-async-storage.external.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -66,7 +66,10 @@ export interface WorkStore {\n    * Tags that were revalidated during the current request. They need to be sent\n    * to cache handlers to propagate their revalidation.\n    */\n-  pendingRevalidatedTags?: string[]\n+  pendingRevalidatedTags?: Array<{\n+    tag: string\n+    profile?: string | { stale?: number; revalidate?: number; expire?: number }\n+  }>\n \n   /**\n    * Tags that were previously revalidated (e.g. by a redirecting server action)"
        },
        {
            "sha": "cbea9734c035fe93855d80e19c2ef71da6fcd74a",
            "filename": "packages/next/src/server/base-server.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 25,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fbase-server.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -64,7 +64,7 @@ import RenderResult from './render-result'\n import { removeTrailingSlash } from '../shared/lib/router/utils/remove-trailing-slash'\n import { denormalizePagePath } from '../shared/lib/page-path/denormalize-page-path'\n import * as Log from '../build/output/log'\n-import { getPreviouslyRevalidatedTags, getServerUtils } from './server-utils'\n+import { getServerUtils } from './server-utils'\n import isError, { getProperError } from '../lib/is-error'\n import {\n   addRequestMeta,\n@@ -141,7 +141,6 @@ import { SegmentPrefixRSCPathnameNormalizer } from './normalizers/request/segmen\n import { shouldServeStreamingMetadata } from './lib/streaming-metadata'\n import { decodeQueryPathParameter } from './lib/decode-query-path-parameter'\n import { NoFallbackError } from '../shared/lib/no-fallback-error.external'\n-import { getCacheHandlers } from './use-cache/handlers'\n import { fixMojibake } from './lib/fix-mojibake'\n import { computeCacheBustingSearchParam } from '../shared/lib/router/utils/cache-busting-search-param'\n import { setCacheBustingSearchParamWithHash } from '../client/components/router-reducer/set-cache-busting-search-param'\n@@ -1440,29 +1439,6 @@ export default abstract class Server<\n         ;(globalThis as any).__incrementalCache = incrementalCache\n       }\n \n-      const cacheHandlers = getCacheHandlers()\n-\n-      if (cacheHandlers) {\n-        await Promise.all(\n-          [...cacheHandlers].map(async (cacheHandler) => {\n-            if ('refreshTags' in cacheHandler) {\n-              // Note: cacheHandler.refreshTags() is called lazily before the\n-              // first cache entry is retrieved. It allows us to skip the\n-              // refresh request if no caches are read at all.\n-            } else {\n-              const previouslyRevalidatedTags = getPreviouslyRevalidatedTags(\n-                req.headers,\n-                this.getPrerenderManifest().preview.previewModeId\n-              )\n-\n-              await cacheHandler.receiveExpiredTags(\n-                ...previouslyRevalidatedTags\n-              )\n-            }\n-          })\n-        )\n-      }\n-\n       // set server components HMR cache to request meta so it can be passed\n       // down for edge functions\n       if (!getRequestMeta(req, 'serverComponentsHmrCache')) {"
        },
        {
            "sha": "8bb38a8c1d7ec450e8863312df2ab28df5c4db37",
            "filename": "packages/next/src/server/config-shared.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fconfig-shared.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1406,7 +1406,7 @@ export const defaultConfig = Object.freeze({\n       max: {\n         stale: 60 * 5, // 5 minutes\n         revalidate: 60 * 60 * 24 * 30, // 1 month\n-        expire: INFINITE_CACHE, // Unbounded.\n+        expire: 60 * 60 * 24 * 365, // 1 year\n       },\n     },\n     cacheHandlers: {"
        },
        {
            "sha": "c81b7c6cad48e0f75492fc94ea2541a9c0a52c55",
            "filename": "packages/next/src/server/lib/cache-handlers/default.external.ts",
            "status": "modified",
            "additions": 46,
            "deletions": 14,
            "changes": 60,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fcache-handlers%2Fdefault.external.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fcache-handlers%2Fdefault.external.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fcache-handlers%2Fdefault.external.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -8,10 +8,12 @@\n  */\n \n import { LRUCache } from '../lru-cache'\n-import type { CacheEntry, CacheHandlerV2 } from './types'\n+import type { CacheEntry, CacheHandler } from './types'\n import {\n-  isStale,\n+  areTagsExpired,\n+  areTagsStale,\n   tagsManifest,\n+  type TagManifestEntry,\n } from '../incremental-cache/tags-manifest.external'\n \n type PrivateCacheEntry = {\n@@ -45,7 +47,7 @@ const debug = process.env.NEXT_PRIVATE_DEBUG_CACHE\n   ? console.debug.bind(console, 'DefaultCacheHandler:')\n   : undefined\n \n-const DefaultCacheHandler: CacheHandlerV2 = {\n+const DefaultCacheHandler: CacheHandler = {\n   async get(cacheKey) {\n     const pendingPromise = pendingSets.get(cacheKey)\n \n@@ -74,23 +76,31 @@ const DefaultCacheHandler: CacheHandlerV2 = {\n       return undefined\n     }\n \n-    if (isStale(entry.tags, entry.timestamp)) {\n-      debug?.('get', cacheKey, 'had stale tag')\n+    let revalidate = entry.revalidate\n \n+    if (areTagsExpired(entry.tags, entry.timestamp)) {\n+      debug?.('get', cacheKey, 'had expired tag')\n       return undefined\n     }\n+\n+    if (areTagsStale(entry.tags, entry.timestamp)) {\n+      debug?.('get', cacheKey, 'had stale tag')\n+      revalidate = -1\n+    }\n+\n     const [returnStream, newSaved] = entry.value.tee()\n     entry.value = newSaved\n \n     debug?.('get', cacheKey, 'found', {\n       tags: entry.tags,\n       timestamp: entry.timestamp,\n-      revalidate: entry.revalidate,\n       expire: entry.expire,\n+      revalidate,\n     })\n \n     return {\n       ...entry,\n+      revalidate,\n       value: returnStream,\n     }\n   },\n@@ -138,23 +148,45 @@ const DefaultCacheHandler: CacheHandlerV2 = {\n     // Nothing to do for an in-memory cache handler.\n   },\n \n-  async getExpiration(...tags) {\n-    const expiration = Math.max(\n-      ...tags.map((tag) => tagsManifest.get(tag) ?? 0)\n-    )\n+  async getExpiration(tags) {\n+    const expirations = tags.map((tag) => {\n+      const entry = tagsManifest.get(tag)\n+      if (!entry) return 0\n+      // Return the most recent timestamp (either expired or stale)\n+      return entry.expired || 0\n+    })\n+\n+    const expiration = Math.max(...expirations, 0)\n \n     debug?.('getExpiration', { tags, expiration })\n \n     return expiration\n   },\n \n-  async expireTags(...tags) {\n-    const timestamp = Math.round(performance.timeOrigin + performance.now())\n-    debug?.('expireTags', { tags, timestamp })\n+  async updateTags(tags, durations) {\n+    const now = Math.round(performance.timeOrigin + performance.now())\n+    debug?.('updateTags', { tags, timestamp: now })\n \n     for (const tag of tags) {\n       // TODO: update file-system-cache?\n-      tagsManifest.set(tag, timestamp)\n+      const existingEntry = tagsManifest.get(tag) || {}\n+\n+      if (durations) {\n+        // Use provided durations directly\n+        const updates: TagManifestEntry = { ...existingEntry }\n+\n+        // mark as stale immediately\n+        updates.stale = now\n+\n+        if (durations.expire !== undefined) {\n+          updates.expired = now + durations.expire * 1000 // Convert seconds to ms\n+        }\n+\n+        tagsManifest.set(tag, updates)\n+      } else {\n+        // Update expired field for immediate expiration (default behavior when no durations provided)\n+        tagsManifest.set(tag, { ...existingEntry, expired: now })\n+      }\n     }\n   },\n }"
        },
        {
            "sha": "eee58946be7c6e9648d034a17687e461768d01ad",
            "filename": "packages/next/src/server/lib/cache-handlers/types.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 48,
            "changes": 50,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fcache-handlers%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fcache-handlers%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fcache-handlers%2Ftypes.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -39,43 +39,7 @@ export interface CacheEntry {\n   revalidate: number\n }\n \n-/**\n- * @deprecated Use {@link CacheHandlerV2} instead.\n- */\n export interface CacheHandler {\n-  /**\n-   * Retrieve a cache entry for the given cache key, if available. The softTags\n-   * should be used to check for staleness.\n-   */\n-  get(cacheKey: string, softTags: string[]): Promise<undefined | CacheEntry>\n-\n-  /**\n-   * Store a cache entry for the given cache key. When this is called, the entry\n-   * may still be pending, i.e. its value stream may still be written to. So it\n-   * needs to be awaited first. If a `get` for the same cache key is called\n-   * before the pending entry is complete, the cache handler must wait for the\n-   * `set` operation to finish, before returning the entry, instead of returning\n-   * undefined.\n-   */\n-  set(cacheKey: string, entry: Promise<CacheEntry>): Promise<void>\n-\n-  /**\n-   * Next.js will call this method when `revalidateTag` or `revalidatePath()` is\n-   * called. It should update the tags manifest accordingly.\n-   */\n-  expireTags(...tags: string[]): Promise<void>\n-\n-  /**\n-   * The `receiveExpiredTags` method is called when an action request sends the\n-   * 'x-next-revalidated-tags' header to indicate which tags have been expired\n-   * by the action. The local tags manifest should be updated accordingly. As\n-   * opposed to `expireTags`, the tags don't need to be propagated to a tags\n-   * service, as this was already done by the server action.\n-   */\n-  receiveExpiredTags(...tags: string[]): Promise<void>\n-}\n-\n-export interface CacheHandlerV2 {\n   /**\n    * Retrieve a cache entry for the given cache key, if available. Will return\n    * undefined if there's no valid entry, or if the given soft tags are stale.\n@@ -106,21 +70,11 @@ export interface CacheHandlerV2 {\n    * Returns `Infinity` if the soft tags are supposed to be passed into the\n    * `get` method instead to be checked for expiration.\n    */\n-  getExpiration(...tags: string[]): Promise<Timestamp>\n+  getExpiration(tags: string[]): Promise<Timestamp>\n \n   /**\n    * This function is called when tags are revalidated/expired. If applicable,\n    * it should update the tags manifest accordingly.\n    */\n-  expireTags(...tags: string[]): Promise<void>\n+  updateTags(tags: string[], durations?: { expire?: number }): Promise<void>\n }\n-\n-/**\n- * This is a compatibility type to ease migration between cache handler\n- * versions. Until the old `CacheHandler` type is removed, this type should be\n- * used for all internal Next.js functions that deal with cache handlers to\n- * ensure that we are compatible with both cache handler versions. An exception\n- * is the built-in default cache handler, which implements the\n- * {@link CacheHandlerV2} interface.\n- */\n-export type CacheHandlerCompat = CacheHandler | CacheHandlerV2"
        },
        {
            "sha": "becffcea007b7f72ce9c72cec5a0f619389751e7",
            "filename": "packages/next/src/server/lib/implicit-tags.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fimplicit-tags.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fimplicit-tags.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fimplicit-tags.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -62,7 +62,7 @@ function createTagsExpirationsByCacheKind(\n       if ('getExpiration' in cacheHandler) {\n         expirationsByCacheKind.set(\n           kind,\n-          createLazyResult(async () => cacheHandler.getExpiration(...tags))\n+          createLazyResult(async () => cacheHandler.getExpiration(tags))\n         )\n       }\n     }"
        },
        {
            "sha": "7582532d346f5ec3f3d0dfaefb894d4e2cfb01f3",
            "filename": "packages/next/src/server/lib/incremental-cache/file-system-cache.ts",
            "status": "modified",
            "additions": 31,
            "deletions": 10,
            "changes": 41,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fincremental-cache%2Ffile-system-cache.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fincremental-cache%2Ffile-system-cache.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fincremental-cache%2Ffile-system-cache.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,6 +1,7 @@\n import type { RouteMetadata } from '../../../export/routes/types'\n import type { CacheHandler, CacheHandlerContext, CacheHandlerValue } from '.'\n import type { CacheFs } from '../../../shared/lib/utils'\n+import type { TagManifestEntry } from './tags-manifest.external'\n import {\n   CachedRouteKind,\n   IncrementalCacheKind,\n@@ -21,7 +22,7 @@ import {\n   RSC_SEGMENTS_DIR_SUFFIX,\n   RSC_SUFFIX,\n } from '../../../lib/constants'\n-import { isStale, tagsManifest } from './tags-manifest.external'\n+import { areTagsExpired, tagsManifest } from './tags-manifest.external'\n import { MultiFileWriter } from '../../../lib/multi-file-writer'\n import { getMemoryCache } from './memory-cache.external'\n \n@@ -65,22 +66,39 @@ export default class FileSystemCache implements CacheHandler {\n   public resetRequestCache(): void {}\n \n   public async revalidateTag(\n-    ...args: Parameters<CacheHandler['revalidateTag']>\n+    tags: string | string[],\n+    durations?: { expire?: number }\n   ) {\n-    let [tags] = args\n     tags = typeof tags === 'string' ? [tags] : tags\n \n     if (FileSystemCache.debug) {\n-      console.log('FileSystemCache: revalidateTag', tags)\n+      console.log('FileSystemCache: revalidateTag', tags, durations)\n     }\n \n     if (tags.length === 0) {\n       return\n     }\n \n+    const now = Date.now()\n+\n     for (const tag of tags) {\n-      if (!tagsManifest.has(tag)) {\n-        tagsManifest.set(tag, Date.now())\n+      const existingEntry = tagsManifest.get(tag) || {}\n+\n+      if (durations) {\n+        // Use provided durations directly\n+        const updates: TagManifestEntry = { ...existingEntry }\n+\n+        // mark as stale immediately\n+        updates.stale = now\n+\n+        if (durations.expire !== undefined) {\n+          updates.expired = now + durations.expire * 1000 // Convert seconds to ms\n+        }\n+\n+        tagsManifest.set(tag, updates)\n+      } else {\n+        // Update expired field for immediate expiration (default behavior when no durations provided)\n+        tagsManifest.set(tag, { ...existingEntry, expired: now })\n       }\n     }\n   }\n@@ -297,9 +315,12 @@ export default class FileSystemCache implements CacheHandler {\n         // we trigger a blocking validation if an ISR page\n         // had a tag revalidated, if we want to be a background\n         // revalidation instead we return data.lastModified = -1\n-        if (cacheTags.length > 0 && isStale(cacheTags, data.lastModified)) {\n+        if (\n+          cacheTags.length > 0 &&\n+          areTagsExpired(cacheTags, data.lastModified)\n+        ) {\n           if (FileSystemCache.debug) {\n-            console.log('FileSystemCache: stale tags', cacheTags)\n+            console.log('FileSystemCache: expired tags', cacheTags)\n           }\n \n           return null\n@@ -321,9 +342,9 @@ export default class FileSystemCache implements CacheHandler {\n         return null\n       }\n \n-      if (isStale(combinedTags, data.lastModified)) {\n+      if (areTagsExpired(combinedTags, data.lastModified)) {\n         if (FileSystemCache.debug) {\n-          console.log('FileSystemCache: stale tags', combinedTags)\n+          console.log('FileSystemCache: expired tags', combinedTags)\n         }\n \n         return null"
        },
        {
            "sha": "8840a2d4bf37982080f8c027bf2519c7f9f7acae",
            "filename": "packages/next/src/server/lib/incremental-cache/index.ts",
            "status": "modified",
            "additions": 25,
            "deletions": 10,
            "changes": 35,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fincremental-cache%2Findex.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fincremental-cache%2Findex.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fincremental-cache%2Findex.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -35,7 +35,7 @@ import type { Revalidate } from '../cache-control'\n import { getPreviouslyRevalidatedTags } from '../../server-utils'\n import { workAsyncStorage } from '../../app-render/work-async-storage.external'\n import { DetachedPromise } from '../../../lib/detached-promise'\n-import { isStale as isTagsStale } from './tags-manifest.external'\n+import { areTagsExpired, areTagsStale } from './tags-manifest.external'\n \n export interface CacheHandlerContext {\n   fs?: CacheFs\n@@ -74,7 +74,8 @@ export class CacheHandler {\n   ): Promise<void> {}\n \n   public async revalidateTag(\n-    ..._args: Parameters<IncrementalCache['revalidateTag']>\n+    _tags: string | string[],\n+    _durations?: { expire?: number }\n   ): Promise<void> {}\n \n   public resetRequestCache(): void {}\n@@ -278,8 +279,11 @@ export class IncrementalCache implements IncrementalCacheType {\n     }\n   }\n \n-  async revalidateTag(tags: string | string[]): Promise<void> {\n-    return this.cacheHandler?.revalidateTag(tags)\n+  async revalidateTag(\n+    tags: string | string[],\n+    durations?: { expire?: number }\n+  ): Promise<void> {\n+    return this.cacheHandler?.revalidateTag(tags, durations)\n   }\n \n   // x-ref: https://github.com/facebook/react/blob/2655c9354d8e1c54ba888444220f63e836925caa/packages/react/src/ReactFetch.js#L23\n@@ -485,11 +489,11 @@ export class IncrementalCache implements IncrementalCacheType {\n         combinedTags.some(\n           (tag) =>\n             this.revalidatedTags?.includes(tag) ||\n-            workStore?.pendingRevalidatedTags?.includes(tag)\n+            workStore?.pendingRevalidatedTags?.some((item) => item.tag === tag)\n         )\n       ) {\n         if (IncrementalCache.debug) {\n-          console.log('IncrementalCache: stale tag', cacheKey)\n+          console.log('IncrementalCache: expired tag', cacheKey)\n         }\n \n         return null\n@@ -523,9 +527,15 @@ export class IncrementalCache implements IncrementalCacheType {\n           (cacheData.lastModified || 0)) /\n         1000\n \n-      const isStale = age > revalidate\n+      let isStale = age > revalidate\n       const data = cacheData.value.data\n \n+      if (areTagsExpired(combinedTags, cacheData.lastModified)) {\n+        return null\n+      } else if (areTagsStale(combinedTags, cacheData.lastModified)) {\n+        isStale = true\n+      }\n+\n       return {\n         isStale,\n         value: { kind: CachedRouteKind.FETCH, data, revalidate },\n@@ -560,7 +570,7 @@ export class IncrementalCache implements IncrementalCacheType {\n         revalidateAfter !== false && revalidateAfter < now ? true : undefined\n \n       // If the stale time couldn't be determined based on the revalidation\n-      // time, we check if the tags are stale.\n+      // time, we check if the tags are expired or stale.\n       if (\n         isStale === undefined &&\n         (cacheData?.value?.kind === CachedRouteKind.APP_PAGE ||\n@@ -570,8 +580,13 @@ export class IncrementalCache implements IncrementalCacheType {\n \n         if (typeof tagsHeader === 'string') {\n           const cacheTags = tagsHeader.split(',')\n-          if (cacheTags.length > 0 && isTagsStale(cacheTags, lastModified)) {\n-            isStale = -1\n+\n+          if (cacheTags.length > 0) {\n+            if (areTagsExpired(cacheTags, lastModified)) {\n+              isStale = -1\n+            } else if (areTagsStale(cacheTags, lastModified)) {\n+              isStale = true\n+            }\n           }\n         }\n       }"
        },
        {
            "sha": "664f6e1c6b1867ed42d2e985dbc395b8eabff03a",
            "filename": "packages/next/src/server/lib/incremental-cache/tags-manifest.external.ts",
            "status": "modified",
            "additions": 26,
            "deletions": 5,
            "changes": 31,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fincremental-cache%2Ftags-manifest.external.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fincremental-cache%2Ftags-manifest.external.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fincremental-cache%2Ftags-manifest.external.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,15 +1,36 @@\n import type { Timestamp } from '../cache-handlers/types'\n \n+export interface TagManifestEntry {\n+  stale?: number\n+  expired?: number\n+}\n+\n // We share the tags manifest between the \"use cache\" handlers and the previous\n // file-system cache.\n-export const tagsManifest = new Map<string, number>()\n+export const tagsManifest = new Map<string, TagManifestEntry>()\n+\n+export const areTagsExpired = (tags: string[], timestamp: Timestamp) => {\n+  for (const tag of tags) {\n+    const entry = tagsManifest.get(tag)\n+\n+    if (entry) {\n+      if (entry.expired && entry.expired >= timestamp) {\n+        return true\n+      }\n+    }\n+  }\n+\n+  return false\n+}\n \n-export const isStale = (tags: string[], timestamp: Timestamp) => {\n+export const areTagsStale = (tags: string[], timestamp: Timestamp) => {\n   for (const tag of tags) {\n-    const revalidatedAt = tagsManifest.get(tag)\n+    const entry = tagsManifest.get(tag)\n \n-    if (typeof revalidatedAt === 'number' && revalidatedAt >= timestamp) {\n-      return true\n+    if (entry) {\n+      if (entry.stale && entry.stale >= timestamp) {\n+        return true\n+      }\n     }\n   }\n "
        },
        {
            "sha": "2db060fb53d902e51b416f95c7b648f21c735f95",
            "filename": "packages/next/src/server/response-cache/types.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fresponse-cache%2Ftypes.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fresponse-cache%2Ftypes.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fresponse-cache%2Ftypes.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -289,4 +289,8 @@ export interface IncrementalCache extends IncrementalResponseCache {\n     data: Exclude<IncrementalCacheValue, CachedFetchValue> | null,\n     ctx: SetIncrementalResponseCacheContext\n   ): Promise<void>\n+  revalidateTag(\n+    tags: string | string[],\n+    durations?: { expire?: number }\n+  ): Promise<void>\n }"
        },
        {
            "sha": "cedacbe5c94a7461aab6c04cbabdd18c4aed80cc",
            "filename": "packages/next/src/server/revalidation-utils.ts",
            "status": "modified",
            "additions": 112,
            "deletions": 14,
            "changes": 126,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Frevalidation-utils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Frevalidation-utils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Frevalidation-utils.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -48,12 +48,24 @@ function diffRevalidationState(\n   prev: RevalidationState,\n   curr: RevalidationState\n ): RevalidationState {\n-  const prevTags = new Set(prev.pendingRevalidatedTags)\n+  const prevTagsWithProfile = new Set(\n+    prev.pendingRevalidatedTags.map((item) => {\n+      const profileKey =\n+        typeof item.profile === 'object'\n+          ? JSON.stringify(item.profile)\n+          : item.profile || ''\n+      return `${item.tag}:${profileKey}`\n+    })\n+  )\n   const prevRevalidateWrites = new Set(prev.pendingRevalidateWrites)\n   return {\n-    pendingRevalidatedTags: curr.pendingRevalidatedTags.filter(\n-      (tag) => !prevTags.has(tag)\n-    ),\n+    pendingRevalidatedTags: curr.pendingRevalidatedTags.filter((item) => {\n+      const profileKey =\n+        typeof item.profile === 'object'\n+          ? JSON.stringify(item.profile)\n+          : item.profile || ''\n+      return !prevTagsWithProfile.has(`${item.tag}:${profileKey}`)\n+    }),\n     pendingRevalidates: Object.fromEntries(\n       Object.entries(curr.pendingRevalidates).filter(\n         ([key]) => !(key in prev.pendingRevalidates)\n@@ -66,23 +78,105 @@ function diffRevalidationState(\n }\n \n async function revalidateTags(\n-  tags: string[],\n-  incrementalCache: IncrementalCache | undefined\n+  tagsWithProfile: Array<{\n+    tag: string\n+    profile?: string | { expire?: number }\n+  }>,\n+  incrementalCache: IncrementalCache | undefined,\n+  workStore?: WorkStore\n ): Promise<void> {\n-  if (tags.length === 0) {\n+  if (tagsWithProfile.length === 0) {\n     return\n   }\n \n+  const handlers = getCacheHandlers()\n   const promises: Promise<void>[] = []\n \n-  if (incrementalCache) {\n-    promises.push(incrementalCache.revalidateTag(tags))\n+  // Group tags by profile for batch processing\n+  const tagsByProfile = new Map<\n+    | string\n+    | { stale?: number; revalidate?: number; expire?: number }\n+    | undefined,\n+    string[]\n+  >()\n+\n+  for (const item of tagsWithProfile) {\n+    const profile = item.profile\n+    // Find existing profile by comparing values\n+    let existingKey = undefined\n+    for (const [key] of tagsByProfile) {\n+      if (\n+        typeof key === 'string' &&\n+        typeof profile === 'string' &&\n+        key === profile\n+      ) {\n+        existingKey = key\n+        break\n+      }\n+      if (\n+        typeof key === 'object' &&\n+        typeof profile === 'object' &&\n+        JSON.stringify(key) === JSON.stringify(profile)\n+      ) {\n+        existingKey = key\n+        break\n+      }\n+      if (key === profile) {\n+        existingKey = key\n+        break\n+      }\n+    }\n+\n+    const profileKey = existingKey || profile\n+    if (!tagsByProfile.has(profileKey)) {\n+      tagsByProfile.set(profileKey, [])\n+    }\n+    tagsByProfile.get(profileKey)!.push(item.tag)\n   }\n \n-  const handlers = getCacheHandlers()\n-  if (handlers) {\n-    for (const handler of handlers) {\n-      promises.push(handler.expireTags(...tags))\n+  // Process each profile group\n+  for (const [profile, tagsForProfile] of tagsByProfile) {\n+    // Look up the cache profile from workStore if available\n+    let durations: { expire?: number } | undefined\n+\n+    if (profile) {\n+      let cacheLife:\n+        | { stale?: number; revalidate?: number; expire?: number }\n+        | undefined\n+\n+      if (typeof profile === 'object') {\n+        // Profile is already a cacheLife configuration object\n+        cacheLife = profile\n+      } else if (typeof profile === 'string') {\n+        // Profile is a string key, look it up in workStore\n+        cacheLife = workStore?.cacheLifeProfiles?.[profile]\n+\n+        if (!cacheLife) {\n+          throw new Error(\n+            `Invalid profile provided \"${profile}\" must be configured under cacheLife in next.config or be \"max\"`\n+          )\n+        }\n+      }\n+\n+      if (cacheLife) {\n+        durations = {\n+          expire: cacheLife.expire,\n+        }\n+      }\n+    }\n+    // If profile is not found and not 'max', durations will be undefined\n+    // which will trigger immediate expiration in the cache handler\n+\n+    for (const handler of handlers || []) {\n+      if (profile) {\n+        promises.push(handler.updateTags?.(tagsForProfile, durations))\n+      } else {\n+        promises.push(handler.updateTags?.(tagsForProfile))\n+      }\n+    }\n+\n+    if (incrementalCache) {\n+      promises.push(incrementalCache.revalidateTag(tagsForProfile, durations))\n     }\n   }\n \n@@ -103,7 +197,11 @@ export async function executeRevalidates(\n     state?.pendingRevalidateWrites ?? workStore.pendingRevalidateWrites ?? []\n \n   return Promise.all([\n-    revalidateTags(pendingRevalidatedTags, workStore.incrementalCache),\n+    revalidateTags(\n+      pendingRevalidatedTags,\n+      workStore.incrementalCache,\n+      workStore\n+    ),\n     ...Object.values(pendingRevalidates),\n     ...pendingRevalidateWrites,\n   ])"
        },
        {
            "sha": "0e9df849f6b1614e61c32b2742b8f4d4dcd72dac",
            "filename": "packages/next/src/server/use-cache/handlers.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 13,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fhandlers.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fhandlers.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fhandlers.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,5 +1,5 @@\n import DefaultCacheHandler from '../lib/cache-handlers/default.external'\n-import type { CacheHandlerCompat } from '../lib/cache-handlers/types'\n+import type { CacheHandler } from '../lib/cache-handlers/types'\n \n const debug = process.env.NEXT_PRIVATE_DEBUG_CACHE\n   ? (message: string, ...args: any[]) => {\n@@ -18,11 +18,11 @@ const handlersSetSymbol = Symbol.for('@next/cache-handlers-set')\n  */\n const reference: typeof globalThis & {\n   [handlersSymbol]?: {\n-    RemoteCache?: CacheHandlerCompat\n-    DefaultCache?: CacheHandlerCompat\n+    RemoteCache?: CacheHandler\n+    DefaultCache?: CacheHandler\n   }\n-  [handlersMapSymbol]?: Map<string, CacheHandlerCompat>\n-  [handlersSetSymbol]?: Set<CacheHandlerCompat>\n+  [handlersMapSymbol]?: Map<string, CacheHandler>\n+  [handlersSetSymbol]?: Set<CacheHandler>\n } = globalThis\n \n /**\n@@ -37,11 +37,11 @@ export function initializeCacheHandlers(): boolean {\n   }\n \n   debug?.('initializing cache handlers')\n-  reference[handlersMapSymbol] = new Map<string, CacheHandlerCompat>()\n+  reference[handlersMapSymbol] = new Map<string, CacheHandler>()\n \n   // Initialize the cache from the symbol contents first.\n   if (reference[handlersSymbol]) {\n-    let fallback: CacheHandlerCompat\n+    let fallback: CacheHandler\n     if (reference[handlersSymbol].DefaultCache) {\n       debug?.('setting \"default\" cache handler from symbol')\n       fallback = reference[handlersSymbol].DefaultCache\n@@ -81,7 +81,7 @@ export function initializeCacheHandlers(): boolean {\n  * @returns The cache handler, or `undefined` if it does not exist.\n  * @throws If the cache handlers are not initialized.\n  */\n-export function getCacheHandler(kind: string): CacheHandlerCompat | undefined {\n+export function getCacheHandler(kind: string): CacheHandler | undefined {\n   // This should never be called before initializeCacheHandlers.\n   if (!reference[handlersMapSymbol]) {\n     throw new Error('Cache handlers not initialized')\n@@ -95,9 +95,7 @@ export function getCacheHandler(kind: string): CacheHandlerCompat | undefined {\n  * @returns An iterator over the cache handlers, or `undefined` if they are not\n  * initialized.\n  */\n-export function getCacheHandlers():\n-  | SetIterator<CacheHandlerCompat>\n-  | undefined {\n+export function getCacheHandlers(): SetIterator<CacheHandler> | undefined {\n   if (!reference[handlersSetSymbol]) {\n     return undefined\n   }\n@@ -112,7 +110,7 @@ export function getCacheHandlers():\n  * @throws If the cache handlers are not initialized.\n  */\n export function getCacheHandlerEntries():\n-  | MapIterator<[string, CacheHandlerCompat]>\n+  | MapIterator<[string, CacheHandler]>\n   | undefined {\n   if (!reference[handlersMapSymbol]) {\n     return undefined\n@@ -128,7 +126,7 @@ export function getCacheHandlerEntries():\n  */\n export function setCacheHandler(\n   kind: string,\n-  cacheHandler: CacheHandlerCompat\n+  cacheHandler: CacheHandler\n ): void {\n   // This should never be called before initializeCacheHandlers.\n   if (!reference[handlersMapSymbol] || !reference[handlersSetSymbol]) {"
        },
        {
            "sha": "b287fd70d1346b8243bf88ebf882a3dd2f24f320",
            "filename": "packages/next/src/server/use-cache/use-cache-wrapper.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fuse-cache-wrapper.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fuse-cache-wrapper.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fuse-cache%2Fuse-cache-wrapper.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1394,7 +1394,7 @@ export function cache(\n               implicitTagsExpiration\n             )\n           ) {\n-            debug?.('discarding stale entry', serializedCacheKey)\n+            debug?.('discarding expired entry', serializedCacheKey)\n             entry = undefined\n           }\n         }\n@@ -1755,7 +1755,7 @@ function isRecentlyRevalidatedTag(tag: string, workStore: WorkStore): boolean {\n   // In this case the revalidation might not have been fully propagated by a\n   // remote cache handler yet, so we read it from the pending tags in the work\n   // store.\n-  if (pendingRevalidatedTags?.includes(tag)) {\n+  if (pendingRevalidatedTags?.some((item) => item.tag === tag)) {\n     debug?.('tag', tag, 'was just revalidated')\n \n     return true"
        },
        {
            "sha": "da9c2b4bf7f98f17fe6a13f2703d670dbd886544",
            "filename": "packages/next/src/server/web/spec-extension/revalidate.ts",
            "status": "modified",
            "additions": 62,
            "deletions": 42,
            "changes": 104,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fspec-extension%2Frevalidate.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fspec-extension%2Frevalidate.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fweb%2Fspec-extension%2Frevalidate.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -12,47 +12,44 @@ import { workUnitAsyncStorage } from '../../app-render/work-unit-async-storage.e\n import { DynamicServerError } from '../../../client/components/hooks-server-context'\n import { InvariantError } from '../../../shared/lib/invariant-error'\n \n+type CacheLifeConfig = {\n+  expire?: number\n+}\n+\n /**\n  * This function allows you to purge [cached data](https://nextjs.org/docs/app/building-your-application/caching) on-demand for a specific cache tag.\n  *\n  * Read more: [Next.js Docs: `revalidateTag`](https://nextjs.org/docs/app/api-reference/functions/revalidateTag)\n  */\n-export function revalidateTag(tag: string) {\n-  return revalidate([tag], `revalidateTag ${tag}`)\n+export function revalidateTag(tag: string, profile: string | CacheLifeConfig) {\n+  if (!profile) {\n+    console.warn(\n+      '\"revalidateTag\" without the second argument is now deprecated, add second argument of \"max\" or use \"updateTag\". See more info here: https://nextjs.org/docs/messages/revalidate-tag-single-arg'\n+    )\n+  }\n+  return revalidate([tag], `revalidateTag ${tag}`, profile)\n }\n \n /**\n- * This function allows you to purge [cached data](https://nextjs.org/docs/app/building-your-application/caching) on-demand for a specific path.\n+ * This function allows you to update [cached data](https://nextjs.org/docs/app/building-your-application/caching) on-demand for a specific cache tag.\n+ * This can only be called from within a Server Action to enable read-your-own-writes semantics.\n  *\n- * Read more: [Next.js Docs: `unstable_expirePath`](https://nextjs.org/docs/app/api-reference/functions/unstable_expirePath)\n+ * Read more: [Next.js Docs: `updateTag`](https://nextjs.org/docs/app/api-reference/functions/updateTag)\n  */\n-export function unstable_expirePath(\n-  originalPath: string,\n-  type?: 'layout' | 'page'\n-) {\n-  if (originalPath.length > NEXT_CACHE_SOFT_TAG_MAX_LENGTH) {\n-    console.warn(\n-      `Warning: expirePath received \"${originalPath}\" which exceeded max length of ${NEXT_CACHE_SOFT_TAG_MAX_LENGTH}. See more info here https://nextjs.org/docs/app/api-reference/functions/unstable_expirePath`\n-    )\n-    return\n-  }\n-\n-  let normalizedPath = `${NEXT_CACHE_IMPLICIT_TAG_ID}${originalPath || '/'}`\n+export function updateTag(tag: string) {\n+  const workStore = workAsyncStorage.getStore()\n \n-  if (type) {\n-    normalizedPath += `${normalizedPath.endsWith('/') ? '' : '/'}${type}`\n-  } else if (isDynamicRoute(originalPath)) {\n-    console.warn(\n-      `Warning: a dynamic page path \"${originalPath}\" was passed to \"expirePath\", but the \"type\" parameter is missing. This has no effect by default, see more info here https://nextjs.org/docs/app/api-reference/functions/unstable_expirePath`\n+  // TODO: change this after investigating why phase: 'action' is\n+  // set for route handlers\n+  if (!workStore || workStore.page.endsWith('/route')) {\n+    throw new Error(\n+      'updateTag can only be called from within a Server Action. ' +\n+        'To invalidate cache tags in Route Handlers or other contexts, use revalidateTag instead. ' +\n+        'See more info here: https://nextjs.org/docs/app/api-reference/functions/updateTag'\n     )\n   }\n-  const tags = [normalizedPath]\n-  if (normalizedPath === `${NEXT_CACHE_IMPLICIT_TAG_ID}/`) {\n-    tags.push(`${NEXT_CACHE_IMPLICIT_TAG_ID}/index`)\n-  } else if (normalizedPath === `${NEXT_CACHE_IMPLICIT_TAG_ID}/index`) {\n-    tags.push(`${NEXT_CACHE_IMPLICIT_TAG_ID}/`)\n-  }\n-  return revalidate(tags, `unstable_expirePath ${originalPath}`)\n+  // updateTag uses immediate expiration (no profile) without deprecation warning\n+  return revalidate([tag], `updateTag ${tag}`, undefined)\n }\n \n /**\n@@ -81,15 +78,6 @@ export function refresh() {\n   }\n }\n \n-/**\n- * This function allows you to purge [cached data](https://nextjs.org/docs/app/building-your-application/caching) on-demand for a specific cache tag.\n- *\n- * Read more: [Next.js Docs: `unstable_expireTag`](https://nextjs.org/docs/app/api-reference/functions/unstable_expireTag)\n- */\n-export function unstable_expireTag(...tags: string[]) {\n-  return revalidate(tags, `unstable_expireTag ${tags.join(', ')}`)\n-}\n-\n /**\n  * This function allows you to purge [cached data](https://nextjs.org/docs/app/building-your-application/caching) on-demand for a specific path.\n  *\n@@ -123,7 +111,11 @@ export function revalidatePath(originalPath: string, type?: 'layout' | 'page') {\n   return revalidate(tags, `revalidatePath ${originalPath}`)\n }\n \n-function revalidate(tags: string[], expression: string) {\n+function revalidate(\n+  tags: string[],\n+  expression: string,\n+  profile?: string | CacheLifeConfig\n+) {\n   const store = workAsyncStorage.getStore()\n   if (!store || !store.incrementalCache) {\n     throw new Error(\n@@ -199,11 +191,39 @@ function revalidate(tags: string[], expression: string) {\n   }\n \n   for (const tag of tags) {\n-    if (!store.pendingRevalidatedTags.includes(tag)) {\n-      store.pendingRevalidatedTags.push(tag)\n+    const existingIndex = store.pendingRevalidatedTags.findIndex((item) => {\n+      if (item.tag !== tag) return false\n+      // Compare profiles: both strings, both objects, or both undefined\n+      if (typeof item.profile === 'string' && typeof profile === 'string') {\n+        return item.profile === profile\n+      }\n+      if (typeof item.profile === 'object' && typeof profile === 'object') {\n+        return JSON.stringify(item.profile) === JSON.stringify(profile)\n+      }\n+      return item.profile === profile\n+    })\n+    if (existingIndex === -1) {\n+      store.pendingRevalidatedTags.push({\n+        tag,\n+        profile,\n+      })\n     }\n   }\n \n-  // TODO: only revalidate if the path matches\n-  store.pathWasRevalidated = true\n+  // if profile is provided and this is a stale-while-revalidate\n+  // update we do not mark the path as revalidated so that server\n+  // actions don't pull their own writes\n+  const cacheLife =\n+    profile && typeof profile === 'object'\n+      ? profile\n+      : profile &&\n+          typeof profile === 'string' &&\n+          store?.cacheLifeProfiles?.[profile]\n+        ? store.cacheLifeProfiles[profile]\n+        : undefined\n+\n+  if (!profile || cacheLife?.expire === 0) {\n+    // TODO: only revalidate if the path matches\n+    store.pathWasRevalidated = true\n+  }\n }"
        },
        {
            "sha": "e5b5aa957435cadd6406db6ef5d9e1cfa75a1fc8",
            "filename": "test/deploy-tests-manifest.json",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fdeploy-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fdeploy-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdeploy-tests-manifest.json?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -5,20 +5,20 @@\n       \"failed\": [\n         \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n         \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n-        \"app-dir action handling fetch actions should handle unstable_expireTag\"\n+        \"app-dir action handling fetch actions should handle revalidateTag\"\n       ]\n     },\n     \"test/e2e/app-dir/actions/app-action-node-middleware.test.ts\": {\n       \"failed\": [\n         \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n         \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n-        \"app-dir action handling fetch actions should handle unstable_expireTag\"\n+        \"app-dir action handling fetch actions should handle revalidateTag\"\n       ]\n     },\n     \"test/e2e/app-dir/app-static/app-static.test.ts\": {\n       \"failed\": [\n         \"app-dir static/dynamic handling new tags have been specified on subsequent fetch should not fetch from memory cache\",\n-        \"app-dir static/dynamic handling new tags have been specified on subsequent fetch should not fetch from memory cache after unstable_expireTag is used\"\n+        \"app-dir static/dynamic handling new tags have been specified on subsequent fetch should not fetch from memory cache after revalidateTag is used\"\n       ]\n     },\n     \"test/e2e/app-dir/metadata/metadata.test.ts\": {"
        },
        {
            "sha": "5aa667268aa156e416b641299a3efa23f834a814",
            "filename": "test/development/acceptance-app/fixtures/rsc-build-errors/app/server-with-errors/next-cache-in-client/unstable_expirepath/page.js",
            "status": "removed",
            "additions": 0,
            "deletions": 8,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/8d415853f73c72263d24be3ea92b497d41f242f0/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Frsc-build-errors%2Fapp%2Fserver-with-errors%2Fnext-cache-in-client%2Funstable_expirepath%2Fpage.js",
            "raw_url": "https://github.com/vercel/next.js/raw/8d415853f73c72263d24be3ea92b497d41f242f0/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Frsc-build-errors%2Fapp%2Fserver-with-errors%2Fnext-cache-in-client%2Funstable_expirepath%2Fpage.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Frsc-build-errors%2Fapp%2Fserver-with-errors%2Fnext-cache-in-client%2Funstable_expirepath%2Fpage.js?ref=8d415853f73c72263d24be3ea92b497d41f242f0",
            "patch": "@@ -1,8 +0,0 @@\n-'use client'\n-import { unstable_expirePath } from 'next/cache'\n-\n-console.log({ unstable_expirePath })\n-\n-export default function Page() {\n-  return null\n-}"
        },
        {
            "sha": "dbe846ba5fc49a10f798b30c27ff892ebf22e094",
            "filename": "test/development/acceptance-app/fixtures/rsc-build-errors/app/server-with-errors/next-cache-in-client/unstable_expiretag/page.js",
            "status": "removed",
            "additions": 0,
            "deletions": 8,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/8d415853f73c72263d24be3ea92b497d41f242f0/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Frsc-build-errors%2Fapp%2Fserver-with-errors%2Fnext-cache-in-client%2Funstable_expiretag%2Fpage.js",
            "raw_url": "https://github.com/vercel/next.js/raw/8d415853f73c72263d24be3ea92b497d41f242f0/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Frsc-build-errors%2Fapp%2Fserver-with-errors%2Fnext-cache-in-client%2Funstable_expiretag%2Fpage.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Ffixtures%2Frsc-build-errors%2Fapp%2Fserver-with-errors%2Fnext-cache-in-client%2Funstable_expiretag%2Fpage.js?ref=8d415853f73c72263d24be3ea92b497d41f242f0",
            "patch": "@@ -1,8 +0,0 @@\n-'use client'\n-import { unstable_expireTag } from 'next/cache'\n-\n-console.log({ unstable_expireTag })\n-\n-export default function Page() {\n-  return null\n-}"
        },
        {
            "sha": "925d2e48a1aa1b05cb0b8842f62118c4853273ab",
            "filename": "test/development/acceptance-app/rsc-build-errors.test.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fdevelopment%2Facceptance-app%2Frsc-build-errors.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fdevelopment%2Facceptance-app%2Frsc-build-errors.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Frsc-build-errors.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -284,8 +284,6 @@ describe('Error overlay - RSC build errors', () => {\n       'revalidateTag',\n       'unstable_cacheLife',\n       'unstable_cacheTag',\n-      'unstable_expirePath',\n-      'unstable_expireTag',\n     ])('%s is not allowed', async (api) => {\n       await using sandbox = await createSandbox(\n         next,"
        },
        {
            "sha": "5b80930484c8a1ba4dcdd8db4021afa2c2d19cac",
            "filename": "test/development/acceptance/server-component-compiler-errors-in-pages.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fdevelopment%2Facceptance%2Fserver-component-compiler-errors-in-pages.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fdevelopment%2Facceptance%2Fserver-component-compiler-errors-in-pages.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance%2Fserver-component-compiler-errors-in-pages.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -386,8 +386,8 @@ describe('Error Overlay for server components compiler errors in pages', () => {\n       'revalidateTag',\n       'unstable_cacheLife',\n       'unstable_cacheTag',\n-      'unstable_expirePath',\n-      'unstable_expireTag',\n+      'revalidatePath',\n+      'revalidateTag',\n     ])('%s is not allowed', async (api) => {\n       await using sandbox = await createSandbox(next, initialFiles)\n       const { session } = sandbox"
        },
        {
            "sha": "0bab623bee77804d9b32c5120901e88935ca0845",
            "filename": "test/development/app-dir/cache-components-dev-cache-scope/app/cached/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fdevelopment%2Fapp-dir%2Fcache-components-dev-cache-scope%2Fapp%2Fcached%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fdevelopment%2Fapp-dir%2Fcache-components-dev-cache-scope%2Fapp%2Fcached%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fapp-dir%2Fcache-components-dev-cache-scope%2Fapp%2Fcached%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,5 +1,5 @@\n import {\n-  unstable_expireTag,\n+  revalidateTag,\n   unstable_cacheLife as cacheLife,\n   unstable_cacheTag,\n } from 'next/cache'\n@@ -13,7 +13,7 @@ function InnerComponent({ children }) {\n \n async function refresh() {\n   'use server'\n-  unstable_expireTag('hello')\n+  revalidateTag('hello')\n }\n \n async function reload() {"
        },
        {
            "sha": "beabff09c1be21fcd6929b1252ecdd9a6101c9d1",
            "filename": "test/e2e/app-dir/actions-revalidate-remount/app/test/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions-revalidate-remount%2Fapp%2Ftest%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions-revalidate-remount%2Fapp%2Ftest%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Factions-revalidate-remount%2Fapp%2Ftest%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,5 +1,5 @@\n import React from 'react'\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export default async function HomePage() {\n   await new Promise((resolve) => setTimeout(resolve, 200))\n@@ -9,7 +9,7 @@ export default async function HomePage() {\n       <form\n         action={async () => {\n           'use server'\n-          unstable_expirePath('/test')\n+          revalidatePath('/test')\n         }}\n       >\n         <button>Submit</button>"
        },
        {
            "sha": "caddec0e627702f5f16d03ee8c33e479ec7eac4c",
            "filename": "test/e2e/app-dir/actions/app-action.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp-action.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp-action.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Factions%2Fapp-action.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1301,7 +1301,7 @@ describe('app-dir action handling', () => {\n       }, 5000)\n     })\n \n-    it('should handle unstable_expirePath', async () => {\n+    it('should handle revalidatePath', async () => {\n       const browser = await next.browser('/revalidate')\n       const randomNumber = await browser.elementByCss('#random-number').text()\n       const justPutIt = await browser.elementByCss('#justputit').text()\n@@ -1324,7 +1324,7 @@ describe('app-dir action handling', () => {\n       })\n     })\n \n-    it('should handle unstable_expireTag', async () => {\n+    it('should handle revalidateTag', async () => {\n       const browser = await next.browser('/revalidate')\n       const randomNumber = await browser.elementByCss('#random-number').text()\n       const justPutIt = await browser.elementByCss('#justputit').text()\n@@ -1348,7 +1348,7 @@ describe('app-dir action handling', () => {\n     })\n \n     // TODO: investigate flakey behavior with revalidate\n-    it.skip('should handle unstable_expireTag + redirect', async () => {\n+    it.skip('should handle revalidateTag + redirect', async () => {\n       const browser = await next.browser('/revalidate')\n       const randomNumber = await browser.elementByCss('#random-number').text()\n       const justPutIt = await browser.elementByCss('#justputit').text()"
        },
        {
            "sha": "b84fd819aca04ee92429965ad3a2923f276f64aa",
            "filename": "test/e2e/app-dir/actions/app/action-discarding/actions.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Faction-discarding%2Factions.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Faction-discarding%2Factions.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Faction-discarding%2Factions.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,6 +1,6 @@\n 'use server'\n \n-import { revalidateTag } from 'next/cache'\n+import { updateTag } from 'next/cache'\n \n export async function slowAction() {\n   await new Promise((resolve) => setTimeout(resolve, 2000))\n@@ -9,6 +9,6 @@ export async function slowAction() {\n \n export async function slowActionWithRevalidation() {\n   await new Promise((resolve) => setTimeout(resolve, 2000))\n-  revalidateTag('cached-random')\n+  updateTag('cached-random')\n   return 'slow action with revalidation completed'\n }"
        },
        {
            "sha": "94b37998dbee433359fa2839f689985ac7c0a539",
            "filename": "test/e2e/app-dir/actions/app/delayed-action/actions.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Fdelayed-action%2Factions.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Fdelayed-action%2Factions.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Fdelayed-action%2Factions.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,10 +1,10 @@\n 'use server'\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n import { redirect } from 'next/navigation'\n \n export const action = async () => {\n   console.log('revalidating')\n-  unstable_expirePath('/delayed-action', 'page')\n+  revalidatePath('/delayed-action', 'page')\n   return Math.random()\n }\n "
        },
        {
            "sha": "e067e07fcb4f200efe3aea4e21c7bc929929ceef",
            "filename": "test/e2e/app-dir/actions/app/redirect/actions.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Fredirect%2Factions.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Fredirect%2Factions.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Fredirect%2Factions.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,7 +1,7 @@\n 'use server'\n \n import { redirect } from 'next/navigation'\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n type State = {\n   errors: Record<string, string>\n@@ -16,7 +16,7 @@ export async function action(previousState: State, formData: FormData) {\n   }\n \n   if (revalidate === 'on') {\n-    unstable_expirePath('/redirect')\n+    revalidatePath('/redirect')\n   }\n \n   redirect('/redirect/other')"
        },
        {
            "sha": "30ced161d72b0995dc2ac82af8d1f08771d806df",
            "filename": "test/e2e/app-dir/actions/app/revalidate-2/page.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Frevalidate-2%2Fpage.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Frevalidate-2%2Fpage.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Frevalidate-2%2Fpage.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,4 +1,4 @@\n-import { unstable_expireTag } from 'next/cache'\n+import { updateTag } from 'next/cache'\n import { cookies } from 'next/headers'\n import Link from 'next/link'\n \n@@ -26,7 +26,7 @@ export default async function Page() {\n           id=\"revalidate-tag\"\n           formAction={async () => {\n             'use server'\n-            unstable_expireTag('thankyounext')\n+            updateTag('thankyounext')\n           }}\n         >\n           revalidate thankyounext"
        },
        {
            "sha": "ebbee4cc00b6004132d13d84dc3d9f6d4639a5da",
            "filename": "test/e2e/app-dir/actions/app/revalidate-multiple/page.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Frevalidate-multiple%2Fpage.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Frevalidate-multiple%2Fpage.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Frevalidate-multiple%2Fpage.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,4 +1,4 @@\n-import { unstable_expireTag } from 'next/cache'\n+import { updateTag } from 'next/cache'\n \n export default async function Page() {\n   const data1 = await fetch(\n@@ -29,8 +29,8 @@ export default async function Page() {\n           id=\"revalidate\"\n           formAction={async () => {\n             'use server'\n-            unstable_expireTag('thankyounext')\n-            unstable_expireTag('justputit')\n+            updateTag('thankyounext')\n+            updateTag('justputit')\n           }}\n         >\n           revalidate thankyounext"
        },
        {
            "sha": "f7127bd0bffe744b881bf76ab7ea3347bca26d90",
            "filename": "test/e2e/app-dir/actions/app/revalidate/page.js",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Frevalidate%2Fpage.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Frevalidate%2Fpage.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Frevalidate%2Fpage.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,4 +1,4 @@\n-import { unstable_expirePath, unstable_expireTag } from 'next/cache'\n+import { revalidatePath, updateTag } from 'next/cache'\n import { redirect } from 'next/navigation'\n import Link from 'next/link'\n \n@@ -59,7 +59,7 @@ export default async function Page() {\n           id=\"revalidate-thankyounext\"\n           formAction={async () => {\n             'use server'\n-            unstable_expireTag('thankyounext')\n+            updateTag('thankyounext')\n           }}\n         >\n           revalidate thankyounext\n@@ -70,7 +70,7 @@ export default async function Page() {\n           id=\"revalidate-justputit\"\n           formAction={async () => {\n             'use server'\n-            unstable_expireTag('justputit')\n+            updateTag('justputit')\n           }}\n         >\n           revalidate justputit\n@@ -81,7 +81,7 @@ export default async function Page() {\n           id=\"revalidate-path\"\n           formAction={async () => {\n             'use server'\n-            unstable_expirePath('/revalidate')\n+            revalidatePath('/revalidate')\n           }}\n         >\n           revalidate path\n@@ -92,7 +92,7 @@ export default async function Page() {\n           id=\"revalidate-path-redirect\"\n           formAction={async () => {\n             'use server'\n-            unstable_expireTag('justputit')\n+            updateTag('justputit')\n             redirect('/revalidate')\n           }}\n         >\n@@ -115,7 +115,7 @@ export default async function Page() {\n           id=\"redirect-revalidate\"\n           formAction={async () => {\n             'use server'\n-            unstable_expireTag('justputit')\n+            updateTag('justputit')\n             redirect('/revalidate?foo=bar')\n           }}\n         >\n@@ -125,7 +125,7 @@ export default async function Page() {\n       <RedirectClientComponent\n         action={async () => {\n           'use server'\n-          unstable_expireTag('justputit')\n+          updateTag('justputit')\n         }}\n       />\n     </>"
        },
        {
            "sha": "f3dc0d5e73fc337547b86104ceeee911f5fe91ce",
            "filename": "test/e2e/app-dir/actions/app/shared/action.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Fshared%2Faction.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Fshared%2Faction.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Factions%2Fapp%2Fshared%2Faction.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,12 +1,12 @@\n 'use server'\n \n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n let x = 0\n \n export async function inc() {\n   ++x\n-  unstable_expirePath('/shared')\n+  revalidatePath('/shared')\n }\n \n export async function get() {"
        },
        {
            "sha": "8b287804b9237641ffde48b6101a67600fad325e",
            "filename": "test/e2e/app-dir/app-static/app-static.test.ts",
            "status": "modified",
            "additions": 100,
            "deletions": 1,
            "changes": 101,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp-static.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp-static.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp-static.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -169,7 +169,7 @@ describe('app-dir static/dynamic handling', () => {\n         expect(data1).not.toBe(data2)\n       })\n \n-      it('should not fetch from memory cache after unstable_expireTag is used', async () => {\n+      it('should not fetch from memory cache after revalidateTag is used', async () => {\n         const res1 = await next.fetch('/specify-new-tags/one-tag')\n         expect(res1.status).toBe(200)\n \n@@ -1162,6 +1162,12 @@ describe('app-dir static/dynamic handling', () => {\n            \"unstable-cache/fetch/no-store.segments/unstable-cache/fetch.segment.rsc\",\n            \"unstable-cache/fetch/no-store.segments/unstable-cache/fetch/no-store.segment.rsc\",\n            \"unstable-cache/fetch/no-store.segments/unstable-cache/fetch/no-store/__PAGE__.segment.rsc\",\n+           \"update-tag-test.html\",\n+           \"update-tag-test.rsc\",\n+           \"update-tag-test.segments/_index.segment.rsc\",\n+           \"update-tag-test.segments/_tree.segment.rsc\",\n+           \"update-tag-test.segments/update-tag-test.segment.rsc\",\n+           \"update-tag-test.segments/update-tag-test/__PAGE__.segment.rsc\",\n            \"variable-config-revalidate/revalidate-3.html\",\n            \"variable-config-revalidate/revalidate-3.rsc\",\n            \"variable-config-revalidate/revalidate-3.segments/_index.segment.rsc\",\n@@ -2557,6 +2563,31 @@ describe('app-dir static/dynamic handling', () => {\n            \"prefetchDataRoute\": null,\n            \"srcRoute\": \"/unstable-cache/fetch/no-store\",\n          },\n+         \"/update-tag-test\": {\n+           \"allowHeader\": [\n+             \"host\",\n+             \"x-matched-path\",\n+             \"x-prerender-revalidate\",\n+             \"x-prerender-revalidate-if-generated\",\n+             \"x-next-revalidated-tags\",\n+             \"x-next-revalidate-tag-token\",\n+           ],\n+           \"dataRoute\": \"/update-tag-test.rsc\",\n+           \"experimentalBypassFor\": [\n+             {\n+               \"key\": \"next-action\",\n+               \"type\": \"header\",\n+             },\n+             {\n+               \"key\": \"content-type\",\n+               \"type\": \"header\",\n+               \"value\": \"multipart/form-data;.*\",\n+             },\n+           ],\n+           \"initialRevalidateSeconds\": false,\n+           \"prefetchDataRoute\": null,\n+           \"srcRoute\": \"/update-tag-test\",\n+         },\n          \"/variable-config-revalidate/revalidate-3\": {\n            \"allowHeader\": [\n              \"host\",\n@@ -4884,4 +4915,72 @@ describe('app-dir static/dynamic handling', () => {\n     const browser = await next.browser('/dynamic-param-edge/hello')\n     expect(await browser.elementByCss('#slug').text()).toBe('hello')\n   })\n+\n+  describe('updateTag', () => {\n+    it('should throw error when updateTag is called in route handler', async () => {\n+      const res = await next.fetch('/api/update-tag-error')\n+      const data = await res.json()\n+\n+      expect(data.error).toContain(\n+        'updateTag can only be called from within a Server Action'\n+      )\n+    })\n+\n+    it('should successfully update tag when called from server action', async () => {\n+      // First fetch to get initial data\n+      const browser = await next.browser('/update-tag-test')\n+      const initialData = JSON.parse(await browser.elementByCss('#data').text())\n+\n+      await retry(async () => {\n+        // Click update button to trigger server action with updateTag\n+        await browser.elementByCss('#update-button').click()\n+\n+        // Refresh the page to see if cache was invalidated\n+        await browser.refresh()\n+        const newData = JSON.parse(await browser.elementByCss('#data').text())\n+\n+        // Data should be different after updateTag (immediate expiration)\n+        expect(newData).not.toEqual(initialData)\n+      })\n+    })\n+\n+    it('should use revalidateTag with max profile in server actions', async () => {\n+      // First fetch to get initial data\n+      const browser = await next.browser('/update-tag-test')\n+      const initialData = JSON.parse(await browser.elementByCss('#data').text())\n+\n+      // Click revalidate button to trigger server action with revalidateTag(..., 'max')\n+      await browser.elementByCss('#revalidate-button').click()\n+\n+      // The behavior with 'max' profile would be stale-while-revalidate\n+      // Initial request after revalidation might still show stale data\n+      await retry(async () => {\n+        await browser.refresh()\n+        const dataAfterRevalidate = JSON.parse(\n+          await browser.elementByCss('#data').text()\n+        )\n+\n+        expect(dataAfterRevalidate).toBeDefined()\n+        expect(dataAfterRevalidate).not.toBe(initialData)\n+      })\n+    })\n+\n+    // Runtime logs aren't queryable in deploy mode\n+    if (!isNextDeploy) {\n+      it('should show deprecation warning for revalidateTag without second argument', async () => {\n+        const cliOutputStart = next.cliOutput.length\n+\n+        const browser = await next.browser('/update-tag-test')\n+\n+        await retry(async () => {\n+          // Click deprecated button to trigger server action with revalidateTag (no second arg)\n+          await browser.elementByCss('#deprecated-button').click()\n+          const output = next.cliOutput.substring(cliOutputStart)\n+          expect(output).toContain(\n+            '\"revalidateTag\" without the second argument is now deprecated'\n+          )\n+        })\n+      })\n+    }\n+  })\n })"
        },
        {
            "sha": "ef0efdcbf8f5036097e80d21f476d9ff8117e52d",
            "filename": "test/e2e/app-dir/app-static/app/api/revalidate-path-edge/route.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-path-edge%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-path-edge%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-path-edge%2Froute.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,13 +1,13 @@\n import { NextRequest, NextResponse } from 'next/server'\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export const runtime = 'edge'\n \n export async function GET(req: NextRequest) {\n   const path = req.nextUrl.searchParams.get('path') || '/'\n   try {\n     console.log('revalidating path', path)\n-    unstable_expirePath(path)\n+    revalidatePath(path)\n     return NextResponse.json({ revalidated: true, now: Date.now() })\n   } catch (err) {\n     console.error('Failed to revalidate', path, err)"
        },
        {
            "sha": "a43a5cecb4082305b3dd0b052eb60dacacb5ba97",
            "filename": "test/e2e/app-dir/app-static/app/api/revalidate-path-node/route.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-path-node%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-path-node%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-path-node%2Froute.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,13 +1,13 @@\n import { NextRequest, NextResponse } from 'next/server'\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export const revalidate = 1\n \n export async function GET(req: NextRequest) {\n   const path = req.nextUrl.searchParams.get('path') || '/'\n   try {\n     console.log('revalidating path', path)\n-    unstable_expirePath(path)\n+    revalidatePath(path)\n     return NextResponse.json({ revalidated: true, now: Date.now() })\n   } catch (err) {\n     console.error('Failed to revalidate', path, err)"
        },
        {
            "sha": "2f5fd4df3b6d5065421a865d2b5386912a86be32",
            "filename": "test/e2e/app-dir/app-static/app/api/revalidate-tag-edge/route.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-tag-edge%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-tag-edge%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-tag-edge%2Froute.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,11 +1,11 @@\n import { NextResponse } from 'next/server'\n-import { unstable_expireTag } from 'next/cache'\n+import { revalidateTag } from 'next/cache'\n \n export const revalidate = 0\n export const runtime = 'edge'\n \n export async function GET(req) {\n   const tag = req.nextUrl.searchParams.get('tag')\n-  unstable_expireTag(tag)\n+  revalidateTag(tag, { expire: 0 })\n   return NextResponse.json({ revalidated: true, now: Date.now() })\n }"
        },
        {
            "sha": "76c7ad20fb176f8a0012dccc99293f7ff550c12e",
            "filename": "test/e2e/app-dir/app-static/app/api/revalidate-tag-node/route.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-tag-node%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-tag-node%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Frevalidate-tag-node%2Froute.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,10 +1,10 @@\n import { NextResponse } from 'next/server'\n-import { unstable_expireTag } from 'next/cache'\n+import { revalidateTag } from 'next/cache'\n \n export const revalidate = 0\n \n export async function GET(req) {\n   const tag = req.nextUrl.searchParams.get('tag')\n-  unstable_expireTag(tag)\n+  revalidateTag(tag, 'expireNow')\n   return NextResponse.json({ revalidated: true, now: Date.now() })\n }"
        },
        {
            "sha": "ffbebc2c199f9a08cc53f999bb3a4252010f9b95",
            "filename": "test/e2e/app-dir/app-static/app/api/update-tag-error/route.ts",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Fupdate-tag-error%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Fupdate-tag-error%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fapi%2Fupdate-tag-error%2Froute.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -0,0 +1,23 @@\n+import { NextResponse } from 'next/server'\n+import { updateTag } from 'next/cache'\n+\n+export async function GET() {\n+  try {\n+    // This should throw an error - updateTag cannot be used in route handlers\n+    updateTag('test-tag')\n+    return NextResponse.json({ error: 'Should not reach here' })\n+  } catch (error: unknown) {\n+    return NextResponse.json(\n+      {\n+        error:\n+          (error &&\n+            typeof error === 'object' &&\n+            'message' in error &&\n+            error.message) ||\n+          'unknown error',\n+        expectedError: true,\n+      },\n+      { status: 500 }\n+    )\n+  }\n+}"
        },
        {
            "sha": "087d5f8a9515082257db76f48f3ff1fac906b772",
            "filename": "test/e2e/app-dir/app-static/app/no-store/static/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fno-store%2Fstatic%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fno-store%2Fstatic%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fno-store%2Fstatic%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,11 +1,11 @@\n-import { unstable_expireTag, unstable_cache } from 'next/cache'\n+import { updateTag, unstable_cache } from 'next/cache'\n import { getUncachedRandomData } from '../no-store-fn'\n import { RevalidateButton } from '../revalidate-button'\n \n export default async function Page() {\n   async function revalidate() {\n     'use server'\n-    await unstable_expireTag('no-store-fn')\n+    await updateTag('no-store-fn')\n   }\n \n   const cachedData = await unstable_cache("
        },
        {
            "sha": "eed0b94eea6cd931d3ae9f55da4ada2a49d0da26",
            "filename": "test/e2e/app-dir/app-static/app/unstable-cache/dynamic-undefined/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Funstable-cache%2Fdynamic-undefined%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Funstable-cache%2Fdynamic-undefined%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Funstable-cache%2Fdynamic-undefined%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,12 +1,12 @@\n-import { unstable_expireTag, unstable_cache } from 'next/cache'\n+import { updateTag, unstable_cache } from 'next/cache'\n import { RevalidateButton } from '../revalidate-button'\n \n export const dynamic = 'force-dynamic'\n \n export default async function Page() {\n   async function revalidate() {\n     'use server'\n-    await unstable_expireTag('undefined-value-data')\n+    await updateTag('undefined-value-data')\n   }\n \n   const cachedData = await unstable_cache("
        },
        {
            "sha": "f5bb362eb686f5778b881069b7ae7b3f8f6eddb3",
            "filename": "test/e2e/app-dir/app-static/app/unstable-cache/dynamic/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Funstable-cache%2Fdynamic%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Funstable-cache%2Fdynamic%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Funstable-cache%2Fdynamic%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,13 +1,13 @@\n import { draftMode } from 'next/headers'\n-import { unstable_expireTag, unstable_cache } from 'next/cache'\n+import { updateTag, unstable_cache } from 'next/cache'\n import { RevalidateButton } from '../revalidate-button'\n \n export const dynamic = 'force-dynamic'\n \n export default async function Page() {\n   async function revalidate() {\n     'use server'\n-    await unstable_expireTag('random-value-data')\n+    await updateTag('random-value-data')\n   }\n \n   const cachedData = await unstable_cache("
        },
        {
            "sha": "dfec8df828b362da838a6e9b3745ff6ea1656f64",
            "filename": "test/e2e/app-dir/app-static/app/update-tag-test/actions.ts",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fupdate-tag-test%2Factions.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fupdate-tag-test%2Factions.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fupdate-tag-test%2Factions.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -0,0 +1,24 @@\n+'use server'\n+\n+import { revalidateTag, updateTag } from 'next/cache'\n+\n+export async function updateAction() {\n+  // This should work - updateTag in server action\n+  updateTag('test-update-tag')\n+\n+  return { updated: true, timestamp: Date.now() }\n+}\n+\n+export async function revalidateAction() {\n+  // This should work with second argument\n+  revalidateTag('test-update-tag', 'max')\n+\n+  return { revalidated: true, timestamp: Date.now() }\n+}\n+\n+export async function deprecatedRevalidateAction() {\n+  // @ts-expect-error This should show deprecation warning\n+  revalidateTag('test-update-tag')\n+\n+  return { revalidated: true, timestamp: Date.now() }\n+}"
        },
        {
            "sha": "ae42fbb1755afed991a96901f8334cdcf65d773c",
            "filename": "test/e2e/app-dir/app-static/app/update-tag-test/buttons.tsx",
            "status": "added",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fupdate-tag-test%2Fbuttons.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fupdate-tag-test%2Fbuttons.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fupdate-tag-test%2Fbuttons.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -0,0 +1,30 @@\n+'use client'\n+import {\n+  updateAction,\n+  revalidateAction,\n+  deprecatedRevalidateAction,\n+} from './actions'\n+\n+export function Buttons() {\n+  return (\n+    <>\n+      <button type=\"button\" id=\"update-button\" onClick={() => updateAction()}>\n+        Update Tag\n+      </button>\n+      <button\n+        type=\"button\"\n+        id=\"revalidate-button\"\n+        onClick={() => revalidateAction()}\n+      >\n+        Revalidate Tag\n+      </button>\n+      <button\n+        type=\"button\"\n+        id=\"deprecated-button\"\n+        onClick={() => deprecatedRevalidateAction()}\n+      >\n+        Deprecated Revalidate\n+      </button>\n+    </>\n+  )\n+}"
        },
        {
            "sha": "76347aa93ff1039628b967e16d9e8243a471b3f8",
            "filename": "test/e2e/app-dir/app-static/app/update-tag-test/page.tsx",
            "status": "added",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fupdate-tag-test%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fupdate-tag-test%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fapp%2Fupdate-tag-test%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -0,0 +1,27 @@\n+import { unstable_cache } from 'next/cache'\n+import { Buttons } from './buttons'\n+\n+const getTimestamp = unstable_cache(\n+  async () => {\n+    return {\n+      timestamp: Date.now(),\n+      random: Math.random(),\n+    }\n+  },\n+  ['timestamp'],\n+  {\n+    tags: ['test-update-tag'],\n+  }\n+)\n+\n+export default async function UpdateTagTest() {\n+  const data = await getTimestamp()\n+\n+  return (\n+    <div>\n+      <h1>Update Tag Test</h1>\n+      <div id=\"data\">{JSON.stringify(data)}</div>\n+      <Buttons />\n+    </div>\n+  )\n+}"
        },
        {
            "sha": "e09c13d9fd947fdc771e3c64f725c8d22606f963",
            "filename": "test/e2e/app-dir/app-static/next.config.js",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fapp-static%2Fnext.config.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -3,6 +3,15 @@ module.exports = {\n   logging: {\n     fetches: {},\n   },\n+  experimental: {\n+    cacheLife: {\n+      expireNow: {\n+        stale: 0,\n+        expire: 0,\n+        revalidate: 0,\n+      },\n+    },\n+  },\n   cacheHandler: process.env.CUSTOM_CACHE_HANDLER\n     ? require.resolve('./cache-handler.js')\n     : undefined,"
        },
        {
            "sha": "902a6d21f7a3ab947e409c86d19307ca3e73ff21",
            "filename": "test/e2e/app-dir/dynamic-interception-route-revalidate/app/[locale]/actions.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fdynamic-interception-route-revalidate%2Fapp%2F%5Blocale%5D%2Factions.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fdynamic-interception-route-revalidate%2Fapp%2F%5Blocale%5D%2Factions.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fdynamic-interception-route-revalidate%2Fapp%2F%5Blocale%5D%2Factions.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,9 +1,9 @@\n 'use server'\n \n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export async function doAction() {\n-  unstable_expirePath('/en/photos/1/view')\n+  revalidatePath('/en/photos/1/view')\n   // sleep 1s\n   await new Promise((resolve) => setTimeout(resolve, 1000))\n   return Math.random()"
        },
        {
            "sha": "e77c0361771e825bcd501a76d3e6197b8a2e3336",
            "filename": "test/e2e/app-dir/logging/app/default-cache/page.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Flogging%2Fapp%2Fdefault-cache%2Fpage.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Flogging%2Fapp%2Fdefault-cache%2Fpage.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Flogging%2Fapp%2Fdefault-cache%2Fpage.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,4 +1,4 @@\n-import { revalidateTag } from 'next/cache'\n+import { updateTag } from 'next/cache'\n \n export const fetchCache = 'default-cache'\n \n@@ -80,7 +80,7 @@ function RevalidateForm() {\n     <form\n       action={async () => {\n         'use server'\n-        revalidateTag('test-tag')\n+        updateTag('test-tag')\n       }}\n     >\n       <button id=\"revalidate-button\">Revalidate</button>"
        },
        {
            "sha": "15bd5fe08973e714e2c59f3481deaefce14493ed",
            "filename": "test/e2e/app-dir/navigation/app/popstate-revalidate/foo/action.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnavigation%2Fapp%2Fpopstate-revalidate%2Ffoo%2Faction.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnavigation%2Fapp%2Fpopstate-revalidate%2Ffoo%2Faction.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnavigation%2Fapp%2Fpopstate-revalidate%2Ffoo%2Faction.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,8 +1,8 @@\n 'use server'\n \n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export async function action() {\n-  unstable_expirePath('/', 'layout')\n+  revalidatePath('/', 'layout')\n   return true\n }"
        },
        {
            "sha": "e83c98bf560c43e9a29b3bf7d94a32705d88b880",
            "filename": "test/e2e/app-dir/next-after-app-deploy/app/timestamp/revalidate.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Fapp%2Ftimestamp%2Frevalidate.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Fapp%2Ftimestamp%2Frevalidate.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Fapp%2Ftimestamp%2Frevalidate.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,4 +1,4 @@\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export async function revalidateTimestampPage(/** @type {string} */ key) {\n   const path = `/timestamp/key/${encodeURIComponent(key)}`\n@@ -10,7 +10,7 @@ export async function revalidateTimestampPage(/** @type {string} */ key) {\n   }\n \n   console.log('revalidateTimestampPage :: revalidating', path)\n-  unstable_expirePath(path)\n+  revalidatePath(path)\n }\n \n const WAIT_BEFORE_REVALIDATING_DEFAULT = 1000"
        },
        {
            "sha": "18eb6a554db42aabec725cd2c83b6552bfed936f",
            "filename": "test/e2e/app-dir/next-after-app-deploy/app/timestamp/trigger-revalidate/route.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Fapp%2Ftimestamp%2Ftrigger-revalidate%2Froute.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Fapp%2Ftimestamp%2Ftrigger-revalidate%2Froute.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Fapp%2Ftimestamp%2Ftrigger-revalidate%2Froute.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,7 +1,7 @@\n import { revalidateTimestampPage } from '../revalidate'\n \n export async function POST(/** @type {Request} */ request) {\n-  // we can't call unstable_expirePath from middleware, so we need to do it from here instead\n+  // we can't call revalidatePath from middleware, so we need to do it from here instead\n   const path = new URL(request.url).searchParams.get('path')\n   if (!path) {\n     return Response.json("
        },
        {
            "sha": "4e6617e21e1ff126e87d739e2a1114f65a6ff5d0",
            "filename": "test/e2e/app-dir/next-after-app-deploy/index.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Findex.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -9,7 +9,7 @@ const WAIT_BEFORE_REVALIDATING = 1000\n // If we want to verify that `after()` ran its callback,\n // we need it to perform some kind of side effect (because it can't affect the response).\n // In other tests, we often use logs for this, but we don't have access to those in deploy tests.\n-// So instead this test relies on calling `unstable_expirePath` inside `after`\n+// So instead this test relies on calling `revalidatePath` inside `after`\n // to revalidate an ISR page '/timestamp/key/[key]', and then checking if the timestamp changed --\n // if it did, we successfully ran the callback (and performed a side effect).\n "
        },
        {
            "sha": "520e8780903de636a228ffbcab594c6fd97badcf",
            "filename": "test/e2e/app-dir/next-after-app-deploy/middleware.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Fmiddleware.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Fmiddleware.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnext-after-app-deploy%2Fmiddleware.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -9,7 +9,7 @@ export function middleware(\n   if (match) {\n     const pathPrefix = match.groups.prefix\n     after(async () => {\n-      // we can't call unstable_expirePath from middleware, so we need to do it via an endpoint instead\n+      // we can't call revalidatePath from middleware, so we need to do it via an endpoint instead\n       const pathToRevalidate = pathPrefix + `/middleware`\n \n       const postUrl = new URL('/timestamp/trigger-revalidate', url.href)"
        },
        {
            "sha": "82768d0dc084b7ea0483b6614d282ade860c7b8e",
            "filename": "test/e2e/app-dir/parallel-routes-revalidation/app/@dialog/revalidate-modal/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fparallel-routes-revalidation%2Fapp%2F%40dialog%2Frevalidate-modal%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fparallel-routes-revalidation%2Fapp%2F%40dialog%2Frevalidate-modal%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fparallel-routes-revalidation%2Fapp%2F%40dialog%2Frevalidate-modal%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,6 +1,6 @@\n import Link from 'next/link'\n \n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n import { addData } from '../../actions'\n \n export default function Page() {\n@@ -9,7 +9,7 @@ export default function Page() {\n \n     await addData(new Date().toISOString())\n \n-    unstable_expirePath('/', 'layout')\n+    revalidatePath('/', 'layout')\n   }\n \n   return ("
        },
        {
            "sha": "dc194b76a78eff3a043495b3b78a55a61d1c810d",
            "filename": "test/e2e/app-dir/parallel-routes-revalidation/app/actions.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fparallel-routes-revalidation%2Fapp%2Factions.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fparallel-routes-revalidation%2Fapp%2Factions.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fparallel-routes-revalidation%2Fapp%2Factions.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,5 +1,5 @@\n 'use server'\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n import { redirect } from 'next/navigation'\n \n let data = []\n@@ -25,5 +25,5 @@ export async function redirectAction() {\n \n export async function clearData() {\n   data = []\n-  unstable_expirePath('/')\n+  revalidatePath('/')\n }"
        },
        {
            "sha": "3a45e68c6e3e9c9e5ea7b81c4e724bc3474eca48",
            "filename": "test/e2e/app-dir/parallel-routes-revalidation/app/nested-revalidate/@modal/modal/action.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fparallel-routes-revalidation%2Fapp%2Fnested-revalidate%2F%40modal%2Fmodal%2Faction.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fparallel-routes-revalidation%2Fapp%2Fnested-revalidate%2F%40modal%2Fmodal%2Faction.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fparallel-routes-revalidation%2Fapp%2Fnested-revalidate%2F%40modal%2Fmodal%2Faction.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,10 +1,10 @@\n 'use server'\n \n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export async function revalidateAction() {\n   console.log('revalidate action')\n-  unstable_expirePath('/')\n+  revalidatePath('/')\n   return {\n     success: true,\n   }"
        },
        {
            "sha": "d7dd340d86cf31ba4431bd6cc713a0199d8a30a7",
            "filename": "test/e2e/app-dir/ppr-full/app/api/revalidate/route.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fppr-full%2Fapp%2Fapi%2Frevalidate%2Froute.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fppr-full%2Fapp%2Fapi%2Frevalidate%2Froute.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fppr-full%2Fapp%2Fapi%2Frevalidate%2Froute.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,4 +1,4 @@\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export async function GET(request) {\n   const url = new URL(request.url)\n@@ -12,7 +12,7 @@ export async function GET(request) {\n       type = 'page'\n     }\n \n-    unstable_expirePath(pathname, type)\n+    revalidatePath(pathname, type)\n   }\n \n   return new Response("
        },
        {
            "sha": "382ac84c84bbc485bfba355d018ff50c17564097",
            "filename": "test/e2e/app-dir/ppr-unstable-cache/app/revalidate-tag/route.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fppr-unstable-cache%2Fapp%2Frevalidate-tag%2Froute.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fppr-unstable-cache%2Fapp%2Frevalidate-tag%2Froute.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fppr-unstable-cache%2Fapp%2Frevalidate-tag%2Froute.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,6 +1,6 @@\n-import { unstable_expireTag } from 'next/cache'\n+import { revalidateTag } from 'next/cache'\n \n export const POST = async () => {\n-  unstable_expireTag('unstable-cache-fetch')\n+  revalidateTag('unstable-cache-fetch', 'expireNow')\n   return new Response('OK', { status: 200 })\n }"
        },
        {
            "sha": "e0e7fecdc7757cb77f54209c9233b9c69ddc1c72",
            "filename": "test/e2e/app-dir/ppr-unstable-cache/next.config.js",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fppr-unstable-cache%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fppr-unstable-cache%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fppr-unstable-cache%2Fnext.config.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,5 +1,12 @@\n module.exports = {\n   experimental: {\n+    cacheLife: {\n+      expireNow: {\n+        stale: 0,\n+        expire: 0,\n+        revalidate: 0,\n+      },\n+    },\n     cacheComponents: true,\n   },\n }"
        },
        {
            "sha": "602822742a4424c5d8826c55d0ec1e9cb28fa040",
            "filename": "test/e2e/app-dir/revalidate-dynamic/app/api/revalidate-path/route.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fapp%2Fapi%2Frevalidate-path%2Froute.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fapp%2Fapi%2Frevalidate-path%2Froute.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fapp%2Fapi%2Frevalidate-path%2Froute.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,7 +1,7 @@\n import { NextResponse } from 'next/server'\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export async function GET(req) {\n-  unstable_expirePath('/')\n+  revalidatePath('/')\n   return NextResponse.json({ revalidated: true, now: Date.now() })\n }"
        },
        {
            "sha": "c668f87f2b5e37fbe52e915901e6caf9c8d50e9c",
            "filename": "test/e2e/app-dir/revalidate-dynamic/app/api/revalidate-tag/route.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fapp%2Fapi%2Frevalidate-tag%2Froute.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fapp%2Fapi%2Frevalidate-tag%2Froute.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fapp%2Fapi%2Frevalidate-tag%2Froute.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,7 +1,7 @@\n import { NextResponse } from 'next/server'\n-import { unstable_expireTag } from 'next/cache'\n+import { revalidateTag } from 'next/cache'\n \n export async function GET(req) {\n-  unstable_expireTag('thankyounext')\n+  revalidateTag('thankyounext', 'expireNow')\n   return NextResponse.json({ revalidated: true, now: Date.now() })\n }"
        },
        {
            "sha": "3a2e37c1c3b32868ea87b4386adc826077a75a21",
            "filename": "test/e2e/app-dir/revalidate-dynamic/next.config.mjs",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fnext.config.mjs",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fnext.config.mjs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Fnext.config.mjs?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -0,0 +1,12 @@\n+const nextConfig = {\n+  experimental: {\n+    cacheLife: {\n+      expireNow: {\n+        stale: 0,\n+        expire: 0,\n+        revalidate: 0,\n+      },\n+    },\n+  },\n+}\n+export default nextConfig"
        },
        {
            "sha": "ccaad43fc3202a2543a19da9b5b0b8e5df803d04",
            "filename": "test/e2e/app-dir/revalidate-dynamic/revalidate-dynamic.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Frevalidate-dynamic.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Frevalidate-dynamic.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frevalidate-dynamic%2Frevalidate-dynamic.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -6,7 +6,7 @@ describe('app-dir revalidate-dynamic', () => {\n   })\n \n   if (isNextStart) {\n-    it('should correctly mark a route handler that uses unstable_expireTag as dynamic', async () => {\n+    it('should correctly mark a route handler that uses revalidateTag as dynamic', async () => {\n       expect(next.cliOutput).toContain('ƒ /api/revalidate-path')\n       expect(next.cliOutput).toContain('ƒ /api/revalidate-tag')\n     })"
        },
        {
            "sha": "226b0e84f361c4b24e757c08fe43e0a71cdbc0ff",
            "filename": "test/e2e/app-dir/revalidatetag-rsc/app/actions/revalidate.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidatetag-rsc%2Fapp%2Factions%2Frevalidate.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidatetag-rsc%2Fapp%2Factions%2Frevalidate.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frevalidatetag-rsc%2Fapp%2Factions%2Frevalidate.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,11 +1,11 @@\n 'use server'\n \n-import { unstable_expireTag } from 'next/cache'\n+import { updateTag } from 'next/cache'\n \n export const revalidate = async (\n   tag: string\n ): Promise<{ revalidated: boolean }> => {\n-  unstable_expireTag(tag)\n+  updateTag(tag)\n \n   return { revalidated: true }\n }"
        },
        {
            "sha": "8a56bfe512b4fc3d5eac670cf904c9938ddb49a8",
            "filename": "test/e2e/app-dir/revalidatetag-rsc/app/revalidate_via_page/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidatetag-rsc%2Fapp%2Frevalidate_via_page%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidatetag-rsc%2Fapp%2Frevalidate_via_page%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frevalidatetag-rsc%2Fapp%2Frevalidate_via_page%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,15 +1,15 @@\n 'use server'\n \n import Link from 'next/link'\n-import { unstable_expireTag } from 'next/cache'\n+import { revalidateTag } from 'next/cache'\n \n const RevalidateViaPage = async ({\n   searchParams,\n }: {\n   searchParams: Promise<{ tag: string }>\n }) => {\n   const { tag } = await searchParams\n-  unstable_expireTag(tag)\n+  revalidateTag(tag, 'max')\n \n   return (\n     <div className=\"flex flex-col items-center justify-center h-screen\">"
        },
        {
            "sha": "0b305f6b84b98be4d2e0bf066809ee8601a7415b",
            "filename": "test/e2e/app-dir/revalidatetag-rsc/revalidatetag-rsc.test.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidatetag-rsc%2Frevalidatetag-rsc.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Frevalidatetag-rsc%2Frevalidatetag-rsc.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Frevalidatetag-rsc%2Frevalidatetag-rsc.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,12 +1,12 @@\n import { nextTestSetup } from 'e2e-utils'\n import { assertHasRedbox, getRedboxHeader, retry } from 'next-test-utils'\n \n-describe('unstable_expireTag-rsc', () => {\n+describe('revalidateTag-rsc', () => {\n   const { next, isNextDev, isNextDeploy } = nextTestSetup({\n     files: __dirname,\n   })\n \n-  it('should revalidate fetch cache if unstable_expireTag invoked via server action', async () => {\n+  it('should revalidate fetch cache if revalidateTag invoked via server action', async () => {\n     const browser = await next.browser('/')\n     const randomNumber = await browser.elementById('data').text()\n     await browser.refresh()\n@@ -23,14 +23,14 @@ describe('unstable_expireTag-rsc', () => {\n \n   if (!isNextDeploy) {\n     // skipped in deploy because it uses `next.cliOutput`\n-    it('should error if unstable_expireTag is called during render', async () => {\n+    it('should error if revalidateTag is called during render', async () => {\n       const browser = await next.browser('/')\n       await browser.elementByCss('#revalidate-via-page').click()\n \n       if (isNextDev) {\n         await assertHasRedbox(browser)\n         await expect(getRedboxHeader(browser)).resolves.toContain(\n-          'Route /revalidate_via_page used \"unstable_expireTag data\"'\n+          'Route /revalidate_via_page used \"revalidateTag data\"'\n         )\n       } else {\n         await retry(async () => {\n@@ -41,7 +41,7 @@ describe('unstable_expireTag-rsc', () => {\n       }\n \n       expect(next.cliOutput).toContain(\n-        'Route /revalidate_via_page used \"unstable_expireTag data\"'\n+        'Route /revalidate_via_page used \"revalidateTag data\"'\n       )\n     })\n   }"
        },
        {
            "sha": "5521a212d9a7315266aa1ae96db6c594bd37beb0",
            "filename": "test/e2e/app-dir/segment-cache/revalidation/app/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Frevalidation%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Frevalidation%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fsegment-cache%2Frevalidation%2Fapp%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,4 +1,4 @@\n-import { revalidatePath, revalidateTag } from 'next/cache'\n+import { revalidatePath, updateTag } from 'next/cache'\n import {\n   LinkAccordion,\n   FormAccordion,\n@@ -23,7 +23,7 @@ export default async function Page() {\n           id=\"revalidate-by-tag\"\n           formAction={async function () {\n             'use server'\n-            revalidateTag('random-greeting')\n+            updateTag('random-greeting')\n           }}\n         >\n           Revalidate by tag"
        },
        {
            "sha": "67c60b1382de125771a92530fb0da5efc6a86b48",
            "filename": "test/e2e/app-dir/use-cache-custom-handler/app/legacy/page.tsx",
            "status": "removed",
            "additions": 0,
            "deletions": 46,
            "changes": 46,
            "blob_url": "https://github.com/vercel/next.js/blob/8d415853f73c72263d24be3ea92b497d41f242f0/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fapp%2Flegacy%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/8d415853f73c72263d24be3ea92b497d41f242f0/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fapp%2Flegacy%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fapp%2Flegacy%2Fpage.tsx?ref=8d415853f73c72263d24be3ea92b497d41f242f0",
            "patch": "@@ -1,46 +0,0 @@\n-import { Suspense } from 'react'\n-import {\n-  unstable_cacheLife as cacheLife,\n-  unstable_cacheTag as cacheTag,\n-  revalidateTag,\n-} from 'next/cache'\n-import { redirect } from 'next/navigation'\n-import { connection } from 'next/server'\n-import React from 'react'\n-\n-async function getData() {\n-  'use cache: legacy'\n-\n-  cacheLife({ revalidate: 3 })\n-  cacheTag('legacy')\n-\n-  return new Date().toISOString()\n-}\n-\n-async function AsyncComp() {\n-  let data = await getData()\n-\n-  return <p id=\"data\">{data}</p>\n-}\n-\n-export default async function Legacy() {\n-  await connection()\n-\n-  return (\n-    <main>\n-      <Suspense fallback={<p>Loading...</p>}>\n-        <AsyncComp />\n-      </Suspense>\n-      <form\n-        action={async () => {\n-          'use server'\n-\n-          revalidateTag('legacy')\n-          redirect('/legacy')\n-        }}\n-      >\n-        <button id=\"revalidate\">Revalidate Tag</button>\n-      </form>\n-    </main>\n-  )\n-}"
        },
        {
            "sha": "5f0c7f860bceaf5216dfef1a2557e7cc3d1cb259",
            "filename": "test/e2e/app-dir/use-cache-custom-handler/app/page.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fapp%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fapp%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fapp%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -3,7 +3,7 @@ import {\n   unstable_cacheLife as cacheLife,\n   unstable_cacheTag as cacheTag,\n   revalidatePath,\n-  revalidateTag,\n+  updateTag,\n } from 'next/cache'\n import { redirect } from 'next/navigation'\n import { connection } from 'next/server'\n@@ -38,7 +38,7 @@ export default async function Home() {\n           formAction={async () => {\n             'use server'\n \n-            revalidateTag('modern')\n+            updateTag('modern')\n           }}\n         >\n           Revalidate Tag\n@@ -58,7 +58,7 @@ export default async function Home() {\n           formAction={async () => {\n             'use server'\n \n-            revalidateTag('modern')\n+            updateTag('modern')\n             redirect('/')\n           }}\n         >"
        },
        {
            "sha": "40100e166386b627e30b94b36207d262e3d2ce70",
            "filename": "test/e2e/app-dir/use-cache-custom-handler/handler.js",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fhandler.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fhandler.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fhandler.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -4,7 +4,7 @@ const defaultCacheHandler =\n   require('next/dist/server/lib/cache-handlers/default.external').default\n \n /**\n- * @type {import('next/dist/server/lib/cache-handlers/types').CacheHandlerV2}\n+ * @type {import('next/dist/server/lib/cache-handlers/types').CacheHandler}\n  */\n const cacheHandler = {\n   async get(cacheKey, softTags) {\n@@ -22,16 +22,16 @@ const cacheHandler = {\n     return defaultCacheHandler.refreshTags()\n   },\n \n-  async getExpiration(...tags) {\n+  async getExpiration(tags) {\n     console.log('ModernCustomCacheHandler::getExpiration', JSON.stringify(tags))\n     // Expecting soft tags in `get` to be used by the cache handler for checking\n     // the expiration of a cache entry, instead of letting Next.js handle it.\n     return Infinity\n   },\n \n-  async expireTags(...tags) {\n-    console.log('ModernCustomCacheHandler::expireTags', JSON.stringify(tags))\n-    return defaultCacheHandler.expireTags(...tags)\n+  async updateTags(tags) {\n+    console.log('ModernCustomCacheHandler::updateTags', JSON.stringify(tags))\n+    return defaultCacheHandler.updateTags(tags)\n   },\n }\n "
        },
        {
            "sha": "6fe8f06b4b291f7edba99ebddad29c7b0530b395",
            "filename": "test/e2e/app-dir/use-cache-custom-handler/legacy-handler.js",
            "status": "removed",
            "additions": 0,
            "deletions": 37,
            "changes": 37,
            "blob_url": "https://github.com/vercel/next.js/blob/8d415853f73c72263d24be3ea92b497d41f242f0/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Flegacy-handler.js",
            "raw_url": "https://github.com/vercel/next.js/raw/8d415853f73c72263d24be3ea92b497d41f242f0/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Flegacy-handler.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Flegacy-handler.js?ref=8d415853f73c72263d24be3ea92b497d41f242f0",
            "patch": "@@ -1,37 +0,0 @@\n-// @ts-check\n-\n-const defaultCacheHandler =\n-  require('next/dist/server/lib/cache-handlers/default.external').default\n-\n-/**\n- * @type {import('next/dist/server/lib/cache-handlers/types').CacheHandler}\n- */\n-const cacheHandler = {\n-  async get(cacheKey, softTags) {\n-    console.log(\n-      'LegacyCustomCacheHandler::get',\n-      cacheKey,\n-      JSON.stringify(softTags)\n-    )\n-    return defaultCacheHandler.get(cacheKey, softTags)\n-  },\n-\n-  async set(cacheKey, pendingEntry) {\n-    console.log('LegacyCustomCacheHandler::set', cacheKey)\n-    return defaultCacheHandler.set(cacheKey, pendingEntry)\n-  },\n-\n-  async expireTags(...tags) {\n-    console.log('LegacyCustomCacheHandler::expireTags', JSON.stringify(tags))\n-    return defaultCacheHandler.expireTags(...tags)\n-  },\n-\n-  async receiveExpiredTags(...tags) {\n-    console.log(\n-      'LegacyCustomCacheHandler::receiveExpiredTags',\n-      JSON.stringify(tags)\n-    )\n-  },\n-}\n-\n-module.exports = cacheHandler"
        },
        {
            "sha": "ebc719d50aeb490e1128c2c61c18de0acf06f794",
            "filename": "test/e2e/app-dir/use-cache-custom-handler/next.config.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fnext.config.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -6,7 +6,6 @@ const nextConfig = {\n     cacheComponents: true,\n     cacheHandlers: {\n       default: require.resolve('./handler.js'),\n-      legacy: require.resolve('./legacy-handler.js'),\n     },\n   },\n }"
        },
        {
            "sha": "98375aaf411ae9ba12990c7edfe85e70393b7d75",
            "filename": "test/e2e/app-dir/use-cache-custom-handler/use-cache-custom-handler.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 70,
            "changes": 74,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fuse-cache-custom-handler.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fuse-cache-custom-handler.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-custom-handler%2Fuse-cache-custom-handler.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -72,46 +72,6 @@ describe('use-cache-custom-handler', () => {\n \n     expect(cliOutput).not.toContain('ModernCustomCacheHandler::refreshTags')\n     expect(cliOutput).not.toContain(`ModernCustomCacheHandler::getExpiration`)\n-\n-    // We don't optimize for legacy cache handlers though:\n-    expect(cliOutput).toContain(\n-      `LegacyCustomCacheHandler::receiveExpiredTags []`\n-    )\n-  })\n-\n-  it('should use a legacy custom cache handler if provided', async () => {\n-    const browser = await next.browser(`/legacy`)\n-    const initialData = await browser.elementById('data').text()\n-    expect(initialData).toMatch(isoDateRegExp)\n-\n-    expect(next.cliOutput.slice(outputIndex)).toContain(\n-      'LegacyCustomCacheHandler::receiveExpiredTags []'\n-    )\n-\n-    expect(next.cliOutput.slice(outputIndex)).toMatch(\n-      /LegacyCustomCacheHandler::get \\[\"(development|[A-Za-z0-9_-]{21})\",\"([0-9a-f]{2})+\",\\[\\]\\] \\[\"_N_T_\\/layout\",\"_N_T_\\/legacy\\/layout\",\"_N_T_\\/legacy\\/page\",\"_N_T_\\/legacy\"\\]/\n-    )\n-\n-    expect(next.cliOutput.slice(outputIndex)).toMatch(\n-      /LegacyCustomCacheHandler::set \\[\"(development|[A-Za-z0-9_-]{21})\",\"([0-9a-f]{2})+\",\\[\\]\\]/\n-    )\n-\n-    // The data should be cached initially.\n-\n-    await browser.refresh()\n-    let data = await browser.elementById('data').text()\n-    expect(data).toMatch(isoDateRegExp)\n-    expect(data).toEqual(initialData)\n-\n-    // Because we use a low `revalidate` value for the \"use cache\" function, new\n-    // data should be returned eventually.\n-\n-    await retry(async () => {\n-      await browser.refresh()\n-      data = await browser.elementById('data').text()\n-      expect(data).toMatch(isoDateRegExp)\n-      expect(data).not.toEqual(initialData)\n-    }, 5000)\n   })\n \n   it('should revalidate after redirect using a modern custom cache handler', async () => {\n@@ -123,33 +83,7 @@ describe('use-cache-custom-handler', () => {\n \n     await retry(async () => {\n       expect(next.cliOutput.slice(outputIndex)).toContain(\n-        'ModernCustomCacheHandler::expireTags [\"modern\"]'\n-      )\n-\n-      const data = await browser.elementById('data').text()\n-      expect(data).toMatch(isoDateRegExp)\n-      expect(data).not.toEqual(initialData)\n-    }, 5000)\n-  })\n-\n-  it('should revalidate after redirect using a legacy custom cache handler', async () => {\n-    const browser = await next.browser(`/legacy`)\n-    const initialData = await browser.elementById('data').text()\n-    expect(initialData).toMatch(isoDateRegExp)\n-\n-    expect(next.cliOutput.slice(outputIndex)).toContain(\n-      'LegacyCustomCacheHandler::receiveExpiredTags []'\n-    )\n-\n-    await browser.elementById('revalidate').click()\n-\n-    await retry(async () => {\n-      expect(next.cliOutput.slice(outputIndex)).toContain(\n-        'LegacyCustomCacheHandler::expireTags [\"legacy\"]'\n-      )\n-\n-      expect(next.cliOutput.slice(outputIndex)).toContain(\n-        'LegacyCustomCacheHandler::receiveExpiredTags [\"legacy\"]'\n+        'ModernCustomCacheHandler::updateTags [\"modern\"]'\n       )\n \n       const data = await browser.elementById('data').text()\n@@ -158,13 +92,13 @@ describe('use-cache-custom-handler', () => {\n     }, 5000)\n   })\n \n-  it('should not call expireTags for a normal invocation', async () => {\n+  it('should not call updateTags for a normal invocation', async () => {\n     await next.fetch(`/`)\n \n     await retry(async () => {\n       const cliOutput = next.cliOutput.slice(outputIndex)\n       expect(cliOutput).toInclude('ModernCustomCacheHandler::refreshTags')\n-      expect(cliOutput).not.toInclude('ModernCustomCacheHandler::expireTags')\n+      expect(cliOutput).not.toInclude('ModernCustomCacheHandler::updateTags')\n     })\n   })\n \n@@ -179,7 +113,7 @@ describe('use-cache-custom-handler', () => {\n       const cliOutput = next.cliOutput.slice(outputIndex)\n       expect(cliOutput).not.toInclude('ModernCustomCacheHandler::getExpiration')\n       expect(cliOutput).toIncludeRepeated(\n-        `ModernCustomCacheHandler::expireTags`,\n+        `ModernCustomCacheHandler::updateTags`,\n         1\n       )\n     })"
        },
        {
            "sha": "158b4ee6afe291c572add5c410e6f7e91506c7e4",
            "filename": "test/e2e/app-dir/use-cache/app/(dynamic)/revalidate-and-redirect/redirect/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(dynamic)%2Frevalidate-and-redirect%2Fredirect%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(dynamic)%2Frevalidate-and-redirect%2Fredirect%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(dynamic)%2Frevalidate-and-redirect%2Fredirect%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,4 +1,4 @@\n-import { revalidatePath, revalidateTag } from 'next/cache'\n+import { revalidatePath, updateTag } from 'next/cache'\n import { redirect } from 'next/navigation'\n \n export default function Page() {\n@@ -9,7 +9,7 @@ export default function Page() {\n         formAction={async () => {\n           'use server'\n \n-          revalidateTag('revalidate-and-redirect')\n+          updateTag('revalidate-and-redirect')\n           redirect('/revalidate-and-redirect')\n         }}\n       >"
        },
        {
            "sha": "871f463d0d8700f6dac79a2259dc968176c32019",
            "filename": "test/e2e/app-dir/use-cache/app/(dynamic)/revalidate-and-use/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(dynamic)%2Frevalidate-and-use%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(dynamic)%2Frevalidate-and-use%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(dynamic)%2Frevalidate-and-use%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,4 +1,4 @@\n-import { revalidatePath, revalidateTag, unstable_cacheTag } from 'next/cache'\n+import { revalidatePath, unstable_cacheTag, updateTag } from 'next/cache'\n import { Form } from './form'\n import { connection } from 'next/server'\n \n@@ -26,7 +26,7 @@ export default async function Page() {\n         const initialCachedValue = await getCachedValue()\n \n         if (type === 'tag') {\n-          revalidateTag('revalidate-and-use')\n+          updateTag('revalidate-and-use')\n         } else {\n           revalidatePath('/revalidate-and-use')\n         }"
        },
        {
            "sha": "984f68a3dd40b8f0804a317713ce474bfcd2f8d1",
            "filename": "test/e2e/app-dir/use-cache/app/(partially-static)/api/revalidate-redirect/route.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(partially-static)%2Fapi%2Frevalidate-redirect%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(partially-static)%2Fapi%2Frevalidate-redirect%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(partially-static)%2Fapi%2Frevalidate-redirect%2Froute.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -2,6 +2,6 @@ import { revalidateTag } from 'next/cache'\n import { redirect } from 'next/navigation'\n \n export async function GET() {\n-  revalidateTag('api')\n+  revalidateTag('api', 'expireNow')\n   redirect('/api')\n }"
        },
        {
            "sha": "4f6ddf7baff20b9015af734373ce1fba3f7a2bd1",
            "filename": "test/e2e/app-dir/use-cache/app/(partially-static)/cache-tag/buttons.tsx",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(partially-static)%2Fcache-tag%2Fbuttons.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(partially-static)%2Fcache-tag%2Fbuttons.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(partially-static)%2Fcache-tag%2Fbuttons.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,5 +1,5 @@\n import React from 'react'\n-import { unstable_expirePath, unstable_expireTag } from 'next/cache'\n+import { revalidatePath, updateTag } from 'next/cache'\n \n export function RevalidateButtons() {\n   return (\n@@ -8,7 +8,7 @@ export function RevalidateButtons() {\n         id=\"revalidate-a\"\n         formAction={async () => {\n           'use server'\n-          unstable_expireTag('a')\n+          updateTag('a')\n         }}\n       >\n         revalidate a\n@@ -17,7 +17,7 @@ export function RevalidateButtons() {\n         id=\"revalidate-b\"\n         formAction={async () => {\n           'use server'\n-          unstable_expireTag('b')\n+          updateTag('b')\n         }}\n       >\n         revalidate b\n@@ -26,7 +26,7 @@ export function RevalidateButtons() {\n         id=\"revalidate-c\"\n         formAction={async () => {\n           'use server'\n-          unstable_expireTag('c')\n+          updateTag('c')\n         }}\n       >\n         revalidate c\n@@ -35,7 +35,7 @@ export function RevalidateButtons() {\n         id=\"revalidate-f\"\n         formAction={async () => {\n           'use server'\n-          unstable_expireTag('f')\n+          updateTag('f')\n         }}\n       >\n         revalidate f\n@@ -44,7 +44,7 @@ export function RevalidateButtons() {\n         id=\"revalidate-r\"\n         formAction={async () => {\n           'use server'\n-          unstable_expireTag('r')\n+          updateTag('r')\n         }}\n       >\n         revalidate r\n@@ -53,7 +53,7 @@ export function RevalidateButtons() {\n         id=\"revalidate-path\"\n         formAction={async () => {\n           'use server'\n-          unstable_expirePath('/cache-tag')\n+          revalidatePath('/cache-tag')\n         }}\n       >\n         revalidate path"
        },
        {
            "sha": "504805f15dd085a2911043e5e19aec3c9f4e8ca5",
            "filename": "test/e2e/app-dir/use-cache/app/(partially-static)/form/page.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(partially-static)%2Fform%2Fpage.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(partially-static)%2Fform%2Fpage.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fapp%2F(partially-static)%2Fform%2Fpage.tsx?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,8 +1,8 @@\n-import { unstable_expireTag, unstable_cacheTag as cacheTag } from 'next/cache'\n+import { updateTag, unstable_cacheTag as cacheTag } from 'next/cache'\n \n async function refresh() {\n   'use server'\n-  unstable_expireTag('home')\n+  updateTag('home')\n }\n \n export default async function Page() {"
        },
        {
            "sha": "406bcbd170979a02615ee7e9339f763046d53c36",
            "filename": "test/e2e/app-dir/use-cache/next.config.js",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fnext.config.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -10,6 +10,11 @@ const nextConfig = {\n         revalidate: 100,\n         expire: 300,\n       },\n+      expireNow: {\n+        stale: 0,\n+        expire: 0,\n+        revalidate: 0,\n+      },\n     },\n     cacheHandlers: {\n       custom: require.resolve("
        },
        {
            "sha": "84950005bcb3653bf6de08b4d5f960b5db484328",
            "filename": "test/e2e/app-dir/use-cache/use-cache.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fuse-cache.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fuse-cache.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache%2Fuse-cache.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -220,13 +220,13 @@ describe('use-cache', () => {\n     })\n   })\n \n-  it('should update after unstable_expireTag correctly', async () => {\n+  it('should update after revalidateTag correctly', async () => {\n     const browser = await next.browser('/cache-tag')\n     const initial = await browser.elementByCss('#a').text()\n \n     if (!isNextDev) {\n       // Bust the ISR cache first, to populate the in-memory cache for the\n-      // subsequent unstable_expireTag calls.\n+      // subsequent revalidateTag calls.\n       await browser.elementByCss('#revalidate-path').click()\n       await retry(async () => {\n         expect(await browser.elementByCss('#a').text()).not.toBe(initial)\n@@ -608,7 +608,7 @@ describe('use-cache', () => {\n     })\n   })\n \n-  it('should be able to revalidate a page using unstable_expireTag', async () => {\n+  it('should be able to revalidate a page using revalidateTag', async () => {\n     const browser = await next.browser(`/form`)\n     const time1 = await browser.waitForElementByCss('#t').text()\n "
        },
        {
            "sha": "815a97b132a458633ebd083bc9eb3f8f9ccf18a3",
            "filename": "test/e2e/on-request-error/isr/app/app/self-revalidate/action.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fon-request-error%2Fisr%2Fapp%2Fapp%2Fself-revalidate%2Faction.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fe2e%2Fon-request-error%2Fisr%2Fapp%2Fapp%2Fself-revalidate%2Faction.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fon-request-error%2Fisr%2Fapp%2Fapp%2Fself-revalidate%2Faction.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,7 +1,7 @@\n 'use server'\n \n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export async function revalidateSelf() {\n-  unstable_expirePath('/app/self-revalidate')\n+  revalidatePath('/app/self-revalidate')\n }"
        },
        {
            "sha": "595c0d456bb856c833dee036941035ac2e65cb2f",
            "filename": "test/production/app-dir/global-default-cache-handler/app/revalidate-tag/route.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fapp%2Frevalidate-tag%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fapp%2Frevalidate-tag%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fapp%2Frevalidate-tag%2Froute.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -4,7 +4,7 @@ import { NextRequest, NextResponse } from 'next/server'\n export async function GET(req: NextRequest) {\n   console.log(req.url.toString())\n \n-  revalidateTag(req.nextUrl.searchParams.get('tag') || '')\n+  revalidateTag(req.nextUrl.searchParams.get('tag') || '', 'expireNow')\n \n   return NextResponse.json({ success: true })\n }"
        },
        {
            "sha": "3cababab9493f65b1db96bc21982c13deaa6ff21",
            "filename": "test/production/app-dir/global-default-cache-handler/global-default-cache-handler.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fglobal-default-cache-handler.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fglobal-default-cache-handler.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fglobal-default-cache-handler.test.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -43,8 +43,8 @@ describe('global-default-cache-handler', () => {\n             console.log('symbol getExpiration', tags)\n           },\n         \n-          expireTags(...tags) {\n-            console.log('symbol expireTags', tags)\n+          updateTags(...tags) {\n+            console.log('symbol updateTags', tags)\n           }\n         }\n       }\n@@ -93,12 +93,12 @@ describe('global-default-cache-handler', () => {\n     })\n   })\n \n-  it('should call expireTags on global default cache handler', async () => {\n+  it('should call updateTags on global default cache handler', async () => {\n     const res = await fetchViaHTTP(appPort, '/revalidate-tag', { tag: 'tag1' })\n     expect(res.status).toBe(200)\n \n     await retry(() => {\n-      expect(output).toContain('symbol expireTags')\n+      expect(output).toContain('symbol updateTags')\n       expect(output).toContain('tag1')\n     })\n   })"
        },
        {
            "sha": "3da611fa376bcf0b0c127e91a55fe4319cf69965",
            "filename": "test/production/app-dir/global-default-cache-handler/next.config.js",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fglobal-default-cache-handler%2Fnext.config.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -5,6 +5,13 @@ const nextConfig = {\n   output: 'standalone',\n   experimental: {\n     useCache: true,\n+    cacheLife: {\n+      expireNow: {\n+        stale: 0,\n+        expire: 0,\n+        revalidate: 0,\n+      },\n+    },\n   },\n }\n "
        },
        {
            "sha": "e26460e8628b02837f818eabf2ee2652b8e9bb7b",
            "filename": "test/production/app-dir/resume-data-cache/app/revalidate/route.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fresume-data-cache%2Fapp%2Frevalidate%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fresume-data-cache%2Fapp%2Frevalidate%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fresume-data-cache%2Fapp%2Frevalidate%2Froute.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,6 +1,6 @@\n import { revalidateTag } from 'next/cache'\n \n export function POST() {\n-  revalidateTag('test')\n+  revalidateTag('test', 'expireNow')\n   return new Response(null, { status: 200 })\n }"
        },
        {
            "sha": "d875a2fbebf6e7d7664f5946ef6bf2ff05294308",
            "filename": "test/production/app-dir/resume-data-cache/next.config.js",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fresume-data-cache%2Fnext.config.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fresume-data-cache%2Fnext.config.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fresume-data-cache%2Fnext.config.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -6,6 +6,13 @@ const nextConfig = {\n     cacheComponents: true,\n     clientSegmentCache: true,\n     clientParamParsing: true,\n+    cacheLife: {\n+      expireNow: {\n+        stale: 0,\n+        expire: 0,\n+        revalidate: 0,\n+      },\n+    },\n   },\n }\n "
        },
        {
            "sha": "2d1d363f655c860900ab470625fbd55b76501c45",
            "filename": "test/production/app-dir/ssg-single-pass/app/revalidate/route.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fssg-single-pass%2Fapp%2Frevalidate%2Froute.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fapp-dir%2Fssg-single-pass%2Fapp%2Frevalidate%2Froute.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fssg-single-pass%2Fapp%2Frevalidate%2Froute.ts?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -1,8 +1,8 @@\n import { NextResponse } from 'next/server'\n-import { unstable_expirePath } from 'next/cache'\n+import { revalidatePath } from 'next/cache'\n \n export async function GET() {\n-  unstable_expirePath('/')\n+  revalidatePath('/')\n \n   return NextResponse.json({ success: true })\n }"
        },
        {
            "sha": "6ee7e200fccf29a696aac1c0e61379cc9105e532",
            "filename": "test/production/custom-server/cache-handler.js",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fcustom-server%2Fcache-handler.js",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fproduction%2Fcustom-server%2Fcache-handler.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fcustom-server%2Fcache-handler.js?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -6,7 +6,7 @@ const defaultCacheHandler =\n   require('next/dist/server/lib/cache-handlers/default.external').default\n \n /**\n- * @type {import('next/dist/server/lib/cache-handlers/types').CacheHandlerV2}\n+ * @type {import('next/dist/server/lib/cache-handlers/types').CacheHandler}\n  */\n const cacheHandler = {\n   async get(cacheKey) {\n@@ -23,12 +23,12 @@ const cacheHandler = {\n     return defaultCacheHandler.refreshTags()\n   },\n \n-  async getExpiration(...tags) {\n-    return defaultCacheHandler.getExpiration(...tags)\n+  async getExpiration(tags) {\n+    return defaultCacheHandler.getExpiration(tags)\n   },\n \n-  async expireTags(...tags) {\n-    return defaultCacheHandler.expireTags(...tags)\n+  async updateTags(tags) {\n+    return defaultCacheHandler.updateTags(tags)\n   },\n }\n "
        },
        {
            "sha": "f0615fd513ac8e55c351403487046bca09a29ca4",
            "filename": "test/rspack-build-tests-manifest.json",
            "status": "modified",
            "additions": 13,
            "deletions": 13,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Frspack-build-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Frspack-build-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Frspack-build-tests-manifest.json?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -165,8 +165,8 @@\n       \"app-dir action handling fetch actions should handle calls to redirect() with a relative URL in a single pass\",\n       \"app-dir action handling fetch actions should handle calls to redirect() with external URLs\",\n       \"app-dir action handling fetch actions should handle redirects to routes that provide an invalid RSC response\",\n-      \"app-dir action handling fetch actions should handle unstable_expirePath\",\n-      \"app-dir action handling fetch actions should handle unstable_expireTag\",\n+      \"app-dir action handling fetch actions should handle revalidatePath\",\n+      \"app-dir action handling fetch actions should handle revalidateTag\",\n       \"app-dir action handling fetch actions should invalidate client cache on other routes when cookies.set is called\",\n       \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n       \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n@@ -228,7 +228,7 @@\n     ],\n     \"failed\": [],\n     \"pending\": [\n-      \"app-dir action handling fetch actions should handle unstable_expireTag + redirect\",\n+      \"app-dir action handling fetch actions should handle revalidateTag + redirect\",\n       \"app-dir action handling server actions render client components client component imported action should support importing client components from actions\"\n     ],\n     \"flakey\": [],\n@@ -299,8 +299,8 @@\n       \"app-dir action handling fetch actions should handle calls to redirect() with a relative URL in a single pass\",\n       \"app-dir action handling fetch actions should handle calls to redirect() with external URLs\",\n       \"app-dir action handling fetch actions should handle redirects to routes that provide an invalid RSC response\",\n-      \"app-dir action handling fetch actions should handle unstable_expirePath\",\n-      \"app-dir action handling fetch actions should handle unstable_expireTag\",\n+      \"app-dir action handling fetch actions should handle revalidatePath\",\n+      \"app-dir action handling fetch actions should handle revalidateTag\",\n       \"app-dir action handling fetch actions should invalidate client cache on other routes when cookies.set is called\",\n       \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n       \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n@@ -362,7 +362,7 @@\n     ],\n     \"failed\": [],\n     \"pending\": [\n-      \"app-dir action handling fetch actions should handle unstable_expireTag + redirect\",\n+      \"app-dir action handling fetch actions should handle revalidateTag + redirect\",\n       \"app-dir action handling server actions render client components client component imported action should support importing client components from actions\"\n     ],\n     \"flakey\": [],\n@@ -5729,7 +5729,7 @@\n   },\n   \"test/e2e/app-dir/revalidate-dynamic/revalidate-dynamic.test.ts\": {\n     \"passed\": [\n-      \"app-dir revalidate-dynamic should correctly mark a route handler that uses unstable_expireTag as dynamic\",\n+      \"app-dir revalidate-dynamic should correctly mark a route handler that uses revalidateTag as dynamic\",\n       \"app-dir revalidate-dynamic should revalidate the data with /api/revalidate-path\",\n       \"app-dir revalidate-dynamic should revalidate the data with /api/revalidate-tag\"\n     ],\n@@ -5740,8 +5740,8 @@\n   },\n   \"test/e2e/app-dir/revalidatetag-rsc/revalidatetag-rsc.test.ts\": {\n     \"passed\": [\n-      \"unstable_expireTag-rsc should error if unstable_expireTag is called during render\",\n-      \"unstable_expireTag-rsc should revalidate fetch cache if unstable_expireTag invoked via server action\"\n+      \"revalidateTag-rsc should error if revalidateTag is called during render\",\n+      \"revalidateTag-rsc should revalidate fetch cache if revalidateTag invoked via server action\"\n     ],\n     \"failed\": [],\n     \"pending\": [],\n@@ -7132,7 +7132,7 @@\n   \"test/e2e/app-dir/use-cache-custom-handler/use-cache-custom-handler.test.ts\": {\n     \"passed\": [\n       \"use-cache-custom-handler calls neither refreshTags nor getExpiration if \\\"use cache\\\" is not used\",\n-      \"use-cache-custom-handler should not call expireTags for a normal invocation\",\n+      \"use-cache-custom-handler should not call updateTags for a normal invocation\",\n       \"use-cache-custom-handler should not call getExpiration after an action\",\n       \"use-cache-custom-handler should revalidate after redirect using a legacy custom cache handler\",\n       \"use-cache-custom-handler should revalidate after redirect using a modern custom cache handler\",\n@@ -7260,7 +7260,7 @@\n       \"use-cache can reference server actions in \\\"use cache\\\" functions\",\n       \"use-cache renders the not-found page when `notFound()` is used\",\n       \"use-cache shares caches between the page/layout and generateMetadata\",\n-      \"use-cache should be able to revalidate a page using unstable_expireTag\",\n+      \"use-cache should be able to revalidate a page using revalidateTag\",\n       \"use-cache should cache complex args\",\n       \"use-cache should cache fetch without no-store\",\n       \"use-cache should cache results\",\n@@ -7290,7 +7290,7 @@\n       \"use-cache should revalidate caches nested in unstable_cache\",\n       \"use-cache should send an SWR cache-control header based on the revalidate and expire values\",\n       \"use-cache should store a fetch response without no-store in the incremental cache handler during build\",\n-      \"use-cache should update after unstable_expireTag correctly\",\n+      \"use-cache should update after revalidateTag correctly\",\n       \"use-cache should use revalidate config in fetch\",\n       \"use-cache usage in node_modules should cache results when using a directive with a handler\",\n       \"use-cache usage in node_modules should cache results when using a directive without a handler\",\n@@ -19999,7 +19999,7 @@\n   },\n   \"test/production/app-dir/global-default-cache-handler/global-default-cache-handler.test.ts\": {\n     \"passed\": [\n-      \"global-default-cache-handler should call expireTags on global default cache handler\",\n+      \"global-default-cache-handler should call updateTags on global default cache handler\",\n       \"global-default-cache-handler should call refreshTags on global default cache handler\",\n       \"global-default-cache-handler should use global symbol for default cache handler\"\n     ],"
        },
        {
            "sha": "d52767cb457fdc4962b1e1bac8db6dabd7199b94",
            "filename": "test/rspack-dev-tests-manifest.json",
            "status": "modified",
            "additions": 15,
            "deletions": 15,
            "changes": 30,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Frspack-dev-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Frspack-dev-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Frspack-dev-tests-manifest.json?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -221,8 +221,8 @@\n       \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_cache is allowed\",\n       \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_cacheLife is not allowed\",\n       \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_cacheTag is not allowed\",\n-      \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_expirePath is not allowed\",\n-      \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_expireTag is not allowed\",\n+      \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component revalidatePath is not allowed\",\n+      \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component revalidateTag is not allowed\",\n       \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_noStore is allowed\",\n       \"Error overlay - RSC build errors next/root-params importing 'next/root-params' in a client component\",\n       \"Error overlay - RSC build errors next/root-params importing 'next/root-params' in a client component in a way that bypasses import analysis\",\n@@ -467,8 +467,8 @@\n       \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_cache is allowed\",\n       \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_cacheLife is not allowed\",\n       \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_cacheTag is not allowed\",\n-      \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_expirePath is not allowed\",\n-      \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_expireTag is not allowed\",\n+      \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages revalidatePath is not allowed\",\n+      \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages revalidateTag is not allowed\",\n       \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_noStore is allowed\",\n       \"Error Overlay for server components compiler errors in pages importing 'next/headers' in pages\",\n       \"Error Overlay for server components compiler errors in pages importing 'next/root-params' in pages\",\n@@ -2613,8 +2613,8 @@\n       \"app-dir action handling fetch actions should handle calls to redirect() with a relative URL in a single pass\",\n       \"app-dir action handling fetch actions should handle calls to redirect() with external URLs\",\n       \"app-dir action handling fetch actions should handle redirects to routes that provide an invalid RSC response\",\n-      \"app-dir action handling fetch actions should handle unstable_expirePath\",\n-      \"app-dir action handling fetch actions should handle unstable_expireTag\",\n+      \"app-dir action handling fetch actions should handle revalidatePath\",\n+      \"app-dir action handling fetch actions should handle revalidateTag\",\n       \"app-dir action handling fetch actions should invalidate client cache on other routes when cookies.set is called\",\n       \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n       \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n@@ -2675,7 +2675,7 @@\n     ],\n     \"failed\": [],\n     \"pending\": [\n-      \"app-dir action handling fetch actions should handle unstable_expireTag + redirect\",\n+      \"app-dir action handling fetch actions should handle revalidateTag + redirect\",\n       \"app-dir action handling server actions render client components client component imported action should support importing client components from actions\"\n     ],\n     \"flakey\": [],\n@@ -2742,8 +2742,8 @@\n       \"app-dir action handling fetch actions should handle calls to redirect() with a relative URL in a single pass\",\n       \"app-dir action handling fetch actions should handle calls to redirect() with external URLs\",\n       \"app-dir action handling fetch actions should handle redirects to routes that provide an invalid RSC response\",\n-      \"app-dir action handling fetch actions should handle unstable_expirePath\",\n-      \"app-dir action handling fetch actions should handle unstable_expireTag\",\n+      \"app-dir action handling fetch actions should handle revalidatePath\",\n+      \"app-dir action handling fetch actions should handle revalidateTag\",\n       \"app-dir action handling fetch actions should invalidate client cache on other routes when cookies.set is called\",\n       \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n       \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n@@ -2804,7 +2804,7 @@\n     ],\n     \"failed\": [],\n     \"pending\": [\n-      \"app-dir action handling fetch actions should handle unstable_expireTag + redirect\",\n+      \"app-dir action handling fetch actions should handle revalidateTag + redirect\",\n       \"app-dir action handling server actions render client components client component imported action should support importing client components from actions\"\n     ],\n     \"flakey\": [],\n@@ -7733,8 +7733,8 @@\n   },\n   \"test/e2e/app-dir/revalidatetag-rsc/revalidatetag-rsc.test.ts\": {\n     \"passed\": [\n-      \"unstable_expireTag-rsc should error if unstable_expireTag is called during render\",\n-      \"unstable_expireTag-rsc should revalidate fetch cache if unstable_expireTag invoked via server action\"\n+      \"revalidateTag-rsc should error if revalidateTag is called during render\",\n+      \"revalidateTag-rsc should revalidate fetch cache if revalidateTag invoked via server action\"\n     ],\n     \"failed\": [],\n     \"pending\": [],\n@@ -8984,7 +8984,7 @@\n   \"test/e2e/app-dir/use-cache-custom-handler/use-cache-custom-handler.test.ts\": {\n     \"passed\": [\n       \"use-cache-custom-handler calls neither refreshTags nor getExpiration if \\\"use cache\\\" is not used\",\n-      \"use-cache-custom-handler should not call expireTags for a normal invocation\",\n+      \"use-cache-custom-handler should not call updateTags for a normal invocation\",\n       \"use-cache-custom-handler should not call getExpiration after an action\",\n       \"use-cache-custom-handler should revalidate after redirect using a legacy custom cache handler\",\n       \"use-cache-custom-handler should revalidate after redirect using a modern custom cache handler\",\n@@ -9122,7 +9122,7 @@\n       \"use-cache renders the not-found page when `notFound()` is used\",\n       \"use-cache replays logs from \\\"use cache\\\" functions\",\n       \"use-cache shares caches between the page/layout and generateMetadata\",\n-      \"use-cache should be able to revalidate a page using unstable_expireTag\",\n+      \"use-cache should be able to revalidate a page using revalidateTag\",\n       \"use-cache should cache complex args\",\n       \"use-cache should cache fetch without no-store\",\n       \"use-cache should cache results\",\n@@ -9145,7 +9145,7 @@\n       \"use-cache should revalidate caches after redirect\",\n       \"use-cache should revalidate caches during on-demand revalidation\",\n       \"use-cache should revalidate caches nested in unstable_cache\",\n-      \"use-cache should update after unstable_expireTag correctly\",\n+      \"use-cache should update after revalidateTag correctly\",\n       \"use-cache should use revalidate config in fetch\",\n       \"use-cache usage in node_modules should cache results when using a directive with a handler\",\n       \"use-cache usage in node_modules should cache results when using a directive without a handler\","
        },
        {
            "sha": "74124d0bf09acb2be64305ddbdac28673175ded5",
            "filename": "test/turbopack-build-tests-manifest.json",
            "status": "modified",
            "additions": 13,
            "deletions": 13,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fturbopack-build-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fturbopack-build-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fturbopack-build-tests-manifest.json?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -162,8 +162,8 @@\n       \"app-dir action handling fetch actions should handle calls to redirect() with a relative URL in a single pass\",\n       \"app-dir action handling fetch actions should handle calls to redirect() with external URLs\",\n       \"app-dir action handling fetch actions should handle redirects to routes that provide an invalid RSC response\",\n-      \"app-dir action handling fetch actions should handle unstable_expirePath\",\n-      \"app-dir action handling fetch actions should handle unstable_expireTag\",\n+      \"app-dir action handling fetch actions should handle revalidatePath\",\n+      \"app-dir action handling fetch actions should handle revalidateTag\",\n       \"app-dir action handling fetch actions should invalidate client cache on other routes when cookies.set is called\",\n       \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n       \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n@@ -225,7 +225,7 @@\n     ],\n     \"failed\": [],\n     \"pending\": [\n-      \"app-dir action handling fetch actions should handle unstable_expireTag + redirect\",\n+      \"app-dir action handling fetch actions should handle revalidateTag + redirect\",\n       \"app-dir action handling server actions render client components client component imported action should support importing client components from actions\"\n     ],\n     \"flakey\": [],\n@@ -294,8 +294,8 @@\n       \"app-dir action handling fetch actions should handle calls to redirect() with a relative URL in a single pass\",\n       \"app-dir action handling fetch actions should handle calls to redirect() with external URLs\",\n       \"app-dir action handling fetch actions should handle redirects to routes that provide an invalid RSC response\",\n-      \"app-dir action handling fetch actions should handle unstable_expirePath\",\n-      \"app-dir action handling fetch actions should handle unstable_expireTag\",\n+      \"app-dir action handling fetch actions should handle revalidatePath\",\n+      \"app-dir action handling fetch actions should handle revalidateTag\",\n       \"app-dir action handling fetch actions should invalidate client cache on other routes when cookies.set is called\",\n       \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n       \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n@@ -357,7 +357,7 @@\n     ],\n     \"failed\": [],\n     \"pending\": [\n-      \"app-dir action handling fetch actions should handle unstable_expireTag + redirect\",\n+      \"app-dir action handling fetch actions should handle revalidateTag + redirect\",\n       \"app-dir action handling server actions render client components client component imported action should support importing client components from actions\"\n     ],\n     \"flakey\": [],\n@@ -4776,7 +4776,7 @@\n   },\n   \"test/e2e/app-dir/revalidate-dynamic/revalidate-dynamic.test.ts\": {\n     \"passed\": [\n-      \"app-dir revalidate-dynamic should correctly mark a route handler that uses unstable_expireTag as dynamic\",\n+      \"app-dir revalidate-dynamic should correctly mark a route handler that uses revalidateTag as dynamic\",\n       \"app-dir revalidate-dynamic should revalidate the data with /api/revalidate-path\",\n       \"app-dir revalidate-dynamic should revalidate the data with /api/revalidate-tag\"\n     ],\n@@ -4787,8 +4787,8 @@\n   },\n   \"test/e2e/app-dir/revalidatetag-rsc/revalidatetag-rsc.test.ts\": {\n     \"passed\": [\n-      \"unstable_expireTag-rsc should error if unstable_expireTag is called during render\",\n-      \"unstable_expireTag-rsc should revalidate fetch cache if unstable_expireTag invoked via server action\"\n+      \"revalidateTag-rsc should error if revalidateTag is called during render\",\n+      \"revalidateTag-rsc should revalidate fetch cache if revalidateTag invoked via server action\"\n     ],\n     \"failed\": [],\n     \"pending\": [],\n@@ -5950,7 +5950,7 @@\n   \"test/e2e/app-dir/use-cache-custom-handler/use-cache-custom-handler.test.ts\": {\n     \"passed\": [\n       \"use-cache-custom-handler calls neither refreshTags nor getExpiration if \\\"use cache\\\" is not used\",\n-      \"use-cache-custom-handler should not call expireTags for a normal invocation\",\n+      \"use-cache-custom-handler should not call updateTags for a normal invocation\",\n       \"use-cache-custom-handler should not call getExpiration after an action\",\n       \"use-cache-custom-handler should revalidate after redirect using a legacy custom cache handler\",\n       \"use-cache-custom-handler should revalidate after redirect using a modern custom cache handler\",\n@@ -6052,7 +6052,7 @@\n       \"use-cache can reference server actions in \\\"use cache\\\" functions\",\n       \"use-cache renders the not-found page when `notFound()` is used\",\n       \"use-cache shares caches between the page/layout and generateMetadata\",\n-      \"use-cache should be able to revalidate a page using unstable_expireTag\",\n+      \"use-cache should be able to revalidate a page using revalidateTag\",\n       \"use-cache should cache complex args\",\n       \"use-cache should cache fetch without no-store\",\n       \"use-cache should cache results\",\n@@ -6079,7 +6079,7 @@\n       \"use-cache should revalidate caches nested in unstable_cache\",\n       \"use-cache should send an SWR cache-control header based on the revalidate and expire values\",\n       \"use-cache should store a fetch response without no-store in the incremental cache handler during build\",\n-      \"use-cache should update after unstable_expireTag correctly\",\n+      \"use-cache should update after revalidateTag correctly\",\n       \"use-cache should use revalidate config in fetch\",\n       \"use-cache usage in node_modules should cache results when using a directive with a handler\",\n       \"use-cache usage in node_modules should cache results when using a directive without a handler\",\n@@ -18427,7 +18427,7 @@\n   },\n   \"test/production/app-dir/global-default-cache-handler/global-default-cache-handler.test.ts\": {\n     \"passed\": [\n-      \"global-default-cache-handler should call expireTags on global default cache handler\",\n+      \"global-default-cache-handler should call updateTags on global default cache handler\",\n       \"global-default-cache-handler should call refreshTags on global default cache handler\",\n       \"global-default-cache-handler should use global symbol for default cache handler\"\n     ],"
        },
        {
            "sha": "15665e2de480a14b55e40286e4bfa8ad5a7e9c91",
            "filename": "test/turbopack-dev-tests-manifest.json",
            "status": "modified",
            "additions": 15,
            "deletions": 15,
            "changes": 30,
            "blob_url": "https://github.com/vercel/next.js/blob/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fturbopack-dev-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd/test%2Fturbopack-dev-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fturbopack-dev-tests-manifest.json?ref=e598a4f9763f3ccdaf23f4caf6aea205b84c5dcd",
            "patch": "@@ -2020,8 +2020,8 @@\n       \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_cache is allowed\",\n       \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_cacheLife is not allowed\",\n       \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_cacheTag is not allowed\",\n-      \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_expirePath is not allowed\",\n-      \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_expireTag is not allowed\",\n+      \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component revalidatePath is not allowed\",\n+      \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component revalidateTag is not allowed\",\n       \"Error overlay - RSC build errors importing 'next/cache' APIs in a client component unstable_noStore is allowed\",\n       \"Error overlay - RSC build errors should allow to use and handle rsc poisoning client-only\",\n       \"Error overlay - RSC build errors should allow to use and handle rsc poisoning server-only\",\n@@ -2275,8 +2275,8 @@\n       \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_cache is allowed\",\n       \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_cacheLife is not allowed\",\n       \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_cacheTag is not allowed\",\n-      \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_expirePath is not allowed\",\n-      \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_expireTag is not allowed\",\n+      \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages revalidatePath is not allowed\",\n+      \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages revalidateTag is not allowed\",\n       \"Error Overlay for server components compiler errors in pages importing 'next/cache' APIs in pages unstable_noStore is allowed\",\n       \"Error Overlay for server components compiler errors in pages importing 'next/headers' in pages\",\n       \"Error Overlay for server components compiler errors in pages importing 'server-only' in pages\",\n@@ -4216,8 +4216,8 @@\n       \"app-dir action handling fetch actions should handle calls to redirect() with a relative URL in a single pass\",\n       \"app-dir action handling fetch actions should handle calls to redirect() with external URLs\",\n       \"app-dir action handling fetch actions should handle redirects to routes that provide an invalid RSC response\",\n-      \"app-dir action handling fetch actions should handle unstable_expirePath\",\n-      \"app-dir action handling fetch actions should handle unstable_expireTag\",\n+      \"app-dir action handling fetch actions should handle revalidatePath\",\n+      \"app-dir action handling fetch actions should handle revalidateTag\",\n       \"app-dir action handling fetch actions should invalidate client cache on other routes when cookies.set is called\",\n       \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n       \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n@@ -4279,7 +4279,7 @@\n     ],\n     \"failed\": [],\n     \"pending\": [\n-      \"app-dir action handling fetch actions should handle unstable_expireTag + redirect\",\n+      \"app-dir action handling fetch actions should handle revalidateTag + redirect\",\n       \"app-dir action handling server actions render client components client component imported action should support importing client components from actions\"\n     ],\n     \"flakey\": [],\n@@ -4344,8 +4344,8 @@\n       \"app-dir action handling fetch actions should handle calls to redirect() with a relative URL in a single pass\",\n       \"app-dir action handling fetch actions should handle calls to redirect() with external URLs\",\n       \"app-dir action handling fetch actions should handle redirects to routes that provide an invalid RSC response\",\n-      \"app-dir action handling fetch actions should handle unstable_expirePath\",\n-      \"app-dir action handling fetch actions should handle unstable_expireTag\",\n+      \"app-dir action handling fetch actions should handle revalidatePath\",\n+      \"app-dir action handling fetch actions should handle revalidateTag\",\n       \"app-dir action handling fetch actions should invalidate client cache on other routes when cookies.set is called\",\n       \"app-dir action handling fetch actions should invalidate client cache when path is revalidated\",\n       \"app-dir action handling fetch actions should invalidate client cache when tag is revalidated\",\n@@ -4407,7 +4407,7 @@\n     ],\n     \"failed\": [],\n     \"pending\": [\n-      \"app-dir action handling fetch actions should handle unstable_expireTag + redirect\",\n+      \"app-dir action handling fetch actions should handle revalidateTag + redirect\",\n       \"app-dir action handling server actions render client components client component imported action should support importing client components from actions\"\n     ],\n     \"flakey\": [],\n@@ -8399,8 +8399,8 @@\n   },\n   \"test/e2e/app-dir/revalidatetag-rsc/revalidatetag-rsc.test.ts\": {\n     \"passed\": [\n-      \"unstable_expireTag-rsc should error if unstable_expireTag is called during render\",\n-      \"unstable_expireTag-rsc should revalidate fetch cache if unstable_expireTag invoked via server action\"\n+      \"revalidateTag-rsc should error if revalidateTag is called during render\",\n+      \"revalidateTag-rsc should revalidate fetch cache if revalidateTag invoked via server action\"\n     ],\n     \"failed\": [],\n     \"pending\": [],\n@@ -9502,7 +9502,7 @@\n   \"test/e2e/app-dir/use-cache-custom-handler/use-cache-custom-handler.test.ts\": {\n     \"passed\": [\n       \"use-cache-custom-handler calls neither refreshTags nor getExpiration if \\\"use cache\\\" is not used\",\n-      \"use-cache-custom-handler should not call expireTags for a normal invocation\",\n+      \"use-cache-custom-handler should not call updateTags for a normal invocation\",\n       \"use-cache-custom-handler should not call getExpiration after an action\",\n       \"use-cache-custom-handler should revalidate after redirect using a legacy custom cache handler\",\n       \"use-cache-custom-handler should revalidate after redirect using a modern custom cache handler\",\n@@ -9619,7 +9619,7 @@\n       \"use-cache renders the not-found page when `notFound()` is used\",\n       \"use-cache replays logs from \\\"use cache\\\" functions\",\n       \"use-cache shares caches between the page/layout and generateMetadata\",\n-      \"use-cache should be able to revalidate a page using unstable_expireTag\",\n+      \"use-cache should be able to revalidate a page using revalidateTag\",\n       \"use-cache should cache complex args\",\n       \"use-cache should cache fetch without no-store\",\n       \"use-cache should cache results\",\n@@ -9641,7 +9641,7 @@\n       \"use-cache should revalidate caches after redirect\",\n       \"use-cache should revalidate caches during on-demand revalidation\",\n       \"use-cache should revalidate caches nested in unstable_cache\",\n-      \"use-cache should update after unstable_expireTag correctly\",\n+      \"use-cache should update after revalidateTag correctly\",\n       \"use-cache should use revalidate config in fetch\",\n       \"use-cache usage in node_modules should cache results when using a directive with a handler\",\n       \"use-cache usage in node_modules should cache results when using a directive without a handler\","
        }
    ],
    "stats": {
        "total": 1596,
        "additions": 1032,
        "deletions": 564
    }
}