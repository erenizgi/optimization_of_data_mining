{
    "author": "mischnic",
    "message": "Skip failing test via manifest instead (#78161)\n\nSkip another test via the manifest instead\n\nTurbopack still doesn't print the `middleware contains invalid\nmiddleware config: Expected string` error\n\nCloses #76979",
    "sha": "abd0049f99517d1abbac279afc3b2c20014c3b54",
    "files": [
        {
            "sha": "2d395f6be1b8444f4f4f35fc4e0b07c215642d1f",
            "filename": "test/e2e/app-dir/create-root-layout/create-root-layout.test.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/abd0049f99517d1abbac279afc3b2c20014c3b54/test%2Fe2e%2Fapp-dir%2Fcreate-root-layout%2Fcreate-root-layout.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/abd0049f99517d1abbac279afc3b2c20014c3b54/test%2Fe2e%2Fapp-dir%2Fcreate-root-layout%2Fcreate-root-layout.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcreate-root-layout%2Fcreate-root-layout.test.ts?ref=abd0049f99517d1abbac279afc3b2c20014c3b54",
            "patch": "@@ -3,6 +3,8 @@ import { createNext, FileRef } from 'e2e-utils'\n import { NextInstance } from 'e2e-utils'\n import { check } from 'next-test-utils'\n import stripAnsi from 'strip-ansi'\n+\n+// Skip on Turbopack because the user should create the layout manually\n ;(process.env.IS_TURBOPACK_TEST ? describe.skip : describe)(\n   'app-dir create root layout',\n   () => {"
        },
        {
            "sha": "514a8c3cf8ae9a49cd1d4a0da5e9444a4787e72c",
            "filename": "test/production/app-dir/browser-chunks/browser-chunks.test.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/vercel/next.js/blob/abd0049f99517d1abbac279afc3b2c20014c3b54/test%2Fproduction%2Fapp-dir%2Fbrowser-chunks%2Fbrowser-chunks.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/abd0049f99517d1abbac279afc3b2c20014c3b54/test%2Fproduction%2Fapp-dir%2Fbrowser-chunks%2Fbrowser-chunks.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fbrowser-chunks%2Fbrowser-chunks.test.ts?ref=abd0049f99517d1abbac279afc3b2c20014c3b54",
            "patch": "@@ -1,4 +1,3 @@\n-/* eslint-disable jest/no-standalone-expect */\n import { nextTestSetup } from 'e2e-utils'\n import { SourceMapPayload } from 'module'\n "
        },
        {
            "sha": "f376db0f8b758b18f6b7682ba83c14efa8cc80ee",
            "filename": "test/production/edge-config-validations/index.test.ts",
            "status": "modified",
            "additions": 17,
            "deletions": 25,
            "changes": 42,
            "blob_url": "https://github.com/vercel/next.js/blob/abd0049f99517d1abbac279afc3b2c20014c3b54/test%2Fproduction%2Fedge-config-validations%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/abd0049f99517d1abbac279afc3b2c20014c3b54/test%2Fproduction%2Fedge-config-validations%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fedge-config-validations%2Findex.test.ts?ref=abd0049f99517d1abbac279afc3b2c20014c3b54",
            "patch": "@@ -1,39 +1,31 @@\n-import { createNext } from 'e2e-utils'\n-import { NextInstance } from 'e2e-utils'\n+import { nextTestSetup } from 'e2e-utils'\n \n describe('Edge config validations', () => {\n-  let next: NextInstance\n-\n-  afterAll(() => next.destroy())\n-  ;(process.env.IS_TURBOPACK_TEST ? it.skip : it)(\n-    'fails to build when unstable_allowDynamic is not a string',\n-    async () => {\n-      next = await createNext({\n-        skipStart: true,\n-        files: {\n-          'pages/index.js': `\n+  const { next } = nextTestSetup({\n+    skipStart: true,\n+    skipDeployment: true,\n+    files: {\n+      'pages/index.js': `\n           export default function Page() { \n             return <p>hello world</p>\n           } \n         `,\n-          'middleware.js': `\n+      'middleware.js': `\n           import { NextResponse } from 'next/server'\n           export default async function middleware(request) {\n             return NextResponse.next()\n           }\n \n-          eval('toto')\n-\n           export const config = { unstable_allowDynamic: true }\n         `,\n-        },\n-      })\n-      // eslint-disable-next-line jest/no-standalone-expect\n-      await expect(next.start()).rejects.toThrow('next build failed')\n-      // eslint-disable-next-line jest/no-standalone-expect\n-      expect(next.cliOutput).toMatch(\n-        '/middleware contains invalid middleware config: Expected string, received boolean at \"unstable_allowDynamic\", or Expected array, received boolean at \"unstable_allowDynamic\"'\n-      )\n-    }\n-  )\n+    },\n+  })\n+\n+  it('fails to build when unstable_allowDynamic is not a string', async () => {\n+    const res = await next.build()\n+    expect(res.exitCode).toBe(1)\n+    expect(res.cliOutput).toContain(\n+      '/middleware contains invalid middleware config: Expected string, received boolean at \"unstable_allowDynamic\", or Expected array, received boolean at \"unstable_allowDynamic\"'\n+    )\n+  })\n })"
        },
        {
            "sha": "6aeb64dbb4b9cbf77d2aed3ec6a738a1dd279985",
            "filename": "test/turbopack-build-tests-manifest.json",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/abd0049f99517d1abbac279afc3b2c20014c3b54/test%2Fturbopack-build-tests-manifest.json",
            "raw_url": "https://github.com/vercel/next.js/raw/abd0049f99517d1abbac279afc3b2c20014c3b54/test%2Fturbopack-build-tests-manifest.json",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fturbopack-build-tests-manifest.json?ref=abd0049f99517d1abbac279afc3b2c20014c3b54",
            "patch": "@@ -18486,10 +18486,10 @@\n   },\n   \"test/production/edge-config-validations/index.test.ts\": {\n     \"passed\": [],\n-    \"failed\": [],\n-    \"pending\": [\n+    \"failed\": [\n       \"Edge config validations fails to build when unstable_allowDynamic is not a string\"\n     ],\n+    \"pending\": [],\n     \"flakey\": [],\n     \"runtimeError\": false\n   },"
        }
    ],
    "stats": {
        "total": 49,
        "additions": 21,
        "deletions": 28
    }
}