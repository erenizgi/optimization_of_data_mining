{
    "author": "huozhi",
    "message": "test: disable metadata streaming deployment tests (#76335)",
    "sha": "9df56c2cc0daab331f1a75a9c610c516f048d71f",
    "files": [
        {
            "sha": "ff18229d1d52a6470959410cb0fafece8a66a64b",
            "filename": "test/e2e/app-dir/ppr-metadata-blocking/ppr-metadata-blocking.test.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/9df56c2cc0daab331f1a75a9c610c516f048d71f/test%2Fe2e%2Fapp-dir%2Fppr-metadata-blocking%2Fppr-metadata-blocking.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/9df56c2cc0daab331f1a75a9c610c516f048d71f/test%2Fe2e%2Fapp-dir%2Fppr-metadata-blocking%2Fppr-metadata-blocking.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fppr-metadata-blocking%2Fppr-metadata-blocking.test.ts?ref=9df56c2cc0daab331f1a75a9c610c516f048d71f",
            "patch": "@@ -7,10 +7,13 @@ function countSubstring(str: string, substr: string): number {\n }\n \n describe('ppr-metadata-blocking', () => {\n-  const { next, isNextDev, isNextStart } = nextTestSetup({\n+  const { next, isNextDev, skipped } = nextTestSetup({\n     files: __dirname,\n+    skipDeployment: true,\n   })\n \n+  if (skipped) return\n+\n   // No dynamic APIs used in metadata\n   describe('static metadata', () => {\n     it('should generate metadata in head when page is fully static', async () => {\n@@ -99,8 +102,7 @@ describe('ppr-metadata-blocking', () => {\n     })\n   })\n \n-  // Disable deployment until we support it on infra\n-  if (isNextStart) {\n+  if (!isNextDev) {\n     // This test is only relevant in production mode, as it's testing PPR results\n     describe('html limited bots', () => {\n       it('should serve partial static shell when normal UA requests the page', async () => {"
        },
        {
            "sha": "bc3b9cf775fa2c46d747d6044a481cc293ed89d5",
            "filename": "test/e2e/app-dir/ppr-metadata-streaming/ppr-metadata-streaming.test.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/9df56c2cc0daab331f1a75a9c610c516f048d71f/test%2Fe2e%2Fapp-dir%2Fppr-metadata-streaming%2Fppr-metadata-streaming.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/9df56c2cc0daab331f1a75a9c610c516f048d71f/test%2Fe2e%2Fapp-dir%2Fppr-metadata-streaming%2Fppr-metadata-streaming.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fppr-metadata-streaming%2Fppr-metadata-streaming.test.ts?ref=9df56c2cc0daab331f1a75a9c610c516f048d71f",
            "patch": "@@ -10,10 +10,13 @@ function countSubstring(str: string, substr: string): number {\n }\n \n describe('ppr-metadata-streaming', () => {\n-  const { next, isNextDev, isNextStart } = nextTestSetup({\n+  const { next, isNextDev, isNextDeploy, skipped } = nextTestSetup({\n     files: __dirname,\n+    skipDeployment: true,\n   })\n \n+  if (skipped) return\n+\n   // No dynamic APIs used in metadata\n   describe('static metadata', () => {\n     it('should generate metadata in head when page is fully static', async () => {\n@@ -96,8 +99,8 @@ describe('ppr-metadata-streaming', () => {\n     })\n   })\n \n-  // Disable deployment until we support it on infra\n-  if (isNextStart) {\n+  // Skip the deployment tests for html limited bots\n+  if (!isNextDev && !isNextDeploy) {\n     // This test is only relevant in production mode, as it's testing PPR results\n     describe('html limited bots', () => {\n       it('should serve partial static shell when normal UA requests the page', async () => {"
        },
        {
            "sha": "05a429ba11eb6d8be231ff7d263924a546800015",
            "filename": "test/production/app-dir/metadata-streaming-config/metadata-streaming-config-customized.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/9df56c2cc0daab331f1a75a9c610c516f048d71f/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config-customized.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/9df56c2cc0daab331f1a75a9c610c516f048d71f/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config-customized.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config-customized.test.ts?ref=9df56c2cc0daab331f1a75a9c610c516f048d71f",
            "patch": "@@ -4,8 +4,9 @@ import { nextTestSetup } from 'e2e-utils'\n process.env.__NEXT_EXPERIMENTAL_PPR = 'true'\n \n describe('app-dir - metadata-streaming-config-customized', () => {\n-  const { next } = nextTestSetup({\n+  const { next, skipped } = nextTestSetup({\n     files: __dirname,\n+    skipDeployment: true,\n     overrideFiles: {\n       'next.config.js': `\n         module.exports = {\n@@ -19,6 +20,8 @@ describe('app-dir - metadata-streaming-config-customized', () => {\n     },\n   })\n \n+  if (skipped) return\n+\n   it('should have the customized streaming metadata config output in routes-manifest.json', async () => {\n     const prerenderManifest = JSON.parse(\n       await next.readFile('.next/prerender-manifest.json')"
        },
        {
            "sha": "315671b1894508ee54ea8b7853e88c947cf7fe11",
            "filename": "test/production/app-dir/metadata-streaming-config/metadata-streaming-config.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/9df56c2cc0daab331f1a75a9c610c516f048d71f/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/9df56c2cc0daab331f1a75a9c610c516f048d71f/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fproduction%2Fapp-dir%2Fmetadata-streaming-config%2Fmetadata-streaming-config.test.ts?ref=9df56c2cc0daab331f1a75a9c610c516f048d71f",
            "patch": "@@ -4,10 +4,13 @@ import { nextTestSetup } from 'e2e-utils'\n process.env.__NEXT_EXPERIMENTAL_PPR = 'true'\n \n describe('app-dir - metadata-streaming-config', () => {\n-  const { next } = nextTestSetup({\n+  const { next, skipped } = nextTestSetup({\n     files: __dirname,\n+    skipDeployment: true,\n   })\n \n+  if (skipped) return\n+\n   it('should have the default streaming metadata config output in routes-manifest.json', async () => {\n     const requiredServerFiles = JSON.parse(\n       await next.readFile('.next/required-server-files.json')"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 19,
        "deletions": 8
    }
}