{
    "author": "SyMind",
    "message": "chore: update Rspack test cases snapshot (#83202)",
    "sha": "45b4a985c504f804a463f666fefae7f7eb1fd75c",
    "files": [
        {
            "sha": "e0d1b1f10e1691f639658835ee81025979537b99",
            "filename": "packages/next/src/build/webpack-build/impl.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Fimpl.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Fimpl.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack-build%2Fimpl.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -333,7 +333,7 @@ export async function webpackBuildImpl(\n       throw err\n     }\n     const err = new Error(\n-      `Build failed because of ${process.env.NEXT_RSPACK ? 'rspack' : 'webpack'} errors`\n+      `Build failed because of ${process.env.NEXT_RSPACK ? 'Rspack' : 'webpack'} errors`\n     ) as NextError\n     err.code = 'WEBPACK_ERRORS'\n     throw err"
        },
        {
            "sha": "d72052cbeec6136e6d880f31510febd0394ceb4a",
            "filename": "packages/next/src/build/webpack/loaders/next-invalid-import-error-loader.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 1,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-invalid-import-error-loader.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-invalid-import-error-loader.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fbuild%2Fwebpack%2Floaders%2Fnext-invalid-import-error-loader.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -5,7 +5,16 @@ export type InvalidImportLoaderOpts = { message: string }\n const nextInvalidImportErrorLoader: webpack.LoaderDefinitionFunction<InvalidImportLoaderOpts> =\n   function () {\n     const { message } = this.getOptions()\n-    throw new Error(message)\n+    const error = new Error(message)\n+    if (process.env.NEXT_RSPACK) {\n+      /**\n+       * Rspack uses miette for error formatting, which automatically includes stack\n+       * traces in the error message. To avoid showing redundant stack information\n+       * in the final error output, we clear the stack property.\n+       */\n+      error.stack = undefined\n+    }\n+    throw error\n   }\n \n export default nextInvalidImportErrorLoader"
        },
        {
            "sha": "64516022c336953dd401e65f36d4eba8609ace8f",
            "filename": "test/development/acceptance-app/ReactRefreshLogBox-builtins.test.ts",
            "status": "modified",
            "additions": 81,
            "deletions": 0,
            "changes": 81,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBox-builtins.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBox-builtins.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBox-builtins.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -9,6 +9,8 @@ describe('ReactRefreshLogBox-builtins app', () => {\n     skipStart: true,\n   })\n \n+  const isRspack = !!process.env.NEXT_RSPACK\n+\n   // Module trace is only available with webpack 5\n   test('Node.js builtins', async () => {\n     await using sandbox = await createSandbox(\n@@ -58,6 +60,26 @@ describe('ReactRefreshLogBox-builtins app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect({ browser, next }).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module not found: Can't resolve 'dns' in '<FIXME-project-root>/node_modules/my-package'\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./node_modules/my-package/index.js\n+         × Module not found: Can't resolve 'dns' in '<FIXME-project-root>/node_modules/my-package'\n+          ╭─[1:12]\n+        1 │ const dns = require('dns')\n+          ·             ──────────────\n+        2 │ module.exports = dns\n+          ╰────\n+       Import trace for requested module:\n+       ./node_modules/my-package/index.js\n+       ./index.js\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -105,6 +127,27 @@ describe('ReactRefreshLogBox-builtins app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect({ browser, next }).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module not found: Can't resolve 'b' in '<FIXME-project-root>'\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./index.js\n+         × Module not found: Can't resolve 'b' in '<FIXME-project-root>'\n+          ╭─[2:17]\n+        1 │ import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n+        2 │ import Comp from 'b';\n+          ·                  ───\n+        3 │ export default function Oops() {\n+        4 │     return /*#__PURE__*/ _jsxDEV(\"div\", {\n+          ╰────\n+       Import trace for requested module:\n+       ./index.js\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -153,6 +196,26 @@ describe('ReactRefreshLogBox-builtins app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect({ browser, next }).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module not found: Can't resolve 'b' in '<FIXME-project-root>/app'\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./app/page.js\n+         × Module not found: Can't resolve 'b' in '<FIXME-project-root>/app'\n+          ╭─[2:17]\n+        1 │ /* __next_internal_client_entry_do_not_use__ default auto */ import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n+        2 │ import Comp from 'b';\n+          ·                  ───\n+        3 │ export default function Oops() {\n+        4 │     return /*#__PURE__*/ _jsxDEV(\"div\", {\n+          ╰────\n+       Import trace for requested module:\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -199,6 +262,24 @@ describe('ReactRefreshLogBox-builtins app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect({ browser, next }).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module not found: Can't resolve './non-existent.css' in '<FIXME-project-root>/app'\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./app/page.js\n+         × Module not found: Can't resolve './non-existent.css' in '<FIXME-project-root>/app'\n+          ╭─[2:7]\n+        1 │ /* __next_internal_client_entry_do_not_use__ default auto */ import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n+        2 │ import './non-existent.css';\n+          ·        ────────────────────\n+        3 │ export default function Page(props) {\n+        4 │     return /*#__PURE__*/ _jsxDEV(\"p\", {\n+          ╰────\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {"
        },
        {
            "sha": "de3cb8153cea0be9b6d2772340682cbcee495f04",
            "filename": "test/development/acceptance-app/ReactRefreshLogBox.test.ts",
            "status": "modified",
            "additions": 149,
            "deletions": 1,
            "changes": 150,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBox.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBox.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBox.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -12,6 +12,8 @@ describe('ReactRefreshLogBox app', () => {\n     patchFileDelay: 1000,\n   })\n \n+  const isRspack = !!process.env.NEXT_RSPACK\n+\n   test('should strip whitespace correctly with newline', async () => {\n     await using sandbox = await createSandbox(next)\n     const { browser, session } = sandbox\n@@ -270,6 +272,39 @@ describe('ReactRefreshLogBox app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect({ browser, next }).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./index.js\n+         × Module build failed:\n+         ╰─▶   × Error:   x Unexpected token. Did you mean \\`{'}'}\\` or \\`&rbrace;\\`?\n+               │    ,-[7:1]\n+               │  4 |       <p>lol</p>\n+               │  5 |     div\n+               │  6 |   )\n+               │  7 | }\n+               │    : ^\n+               │    \\`----\n+               │   x Expected '</', got '<eof>'\n+               │    ,-[7:1]\n+               │  4 |       <p>lol</p>\n+               │  5 |     div\n+               │  6 |   )\n+               │  7 | }\n+               │    \\`----\n+               │\n+               │\n+               │ Caused by:\n+               │     Syntax Error\n+       Import trace for requested module:\n+       ./index.js\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -425,6 +460,28 @@ describe('ReactRefreshLogBox app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect({ browser, next }).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./index.module.css\n+         × Module build failed:\n+         ╰─▶   × SyntaxError\n+               │\n+               │ (1:1) <FIXME-project-root>/index.module.css Unknown word\n+               │\n+               │ > 1 | .button\n+               │     | ^\n+               │\n+       Import trace for requested module:\n+       ./index.module.css\n+       ./index.js\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect({ browser, next }).toDisplayRedbox(`\n        {\n@@ -467,6 +524,28 @@ describe('ReactRefreshLogBox app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./index.module.css\n+         × Module build failed:\n+         ╰─▶   × CssSyntaxError\n+               │\n+               │ (1:1) Selector \"button\" is not pure (pure selectors must contain at least one local class or id)\n+               │\n+               │ > 1 | button {}\n+               │     | ^\n+               │\n+       Import trace for requested module:\n+       ./index.module.css\n+       ./index.js\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -1326,6 +1405,24 @@ describe('ReactRefreshLogBox app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect({ browser, next }).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module not found: Can't resolve 'non-existing-module' in '<FIXME-project-root>/app'\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./app/module.js\n+         × Module not found: Can't resolve 'non-existing-module' in '<FIXME-project-root>/app'\n+          ╭────\n+        1 │ import \"non-existing-module\";\n+          ·        ─────────────────────\n+          ╰────\n+       Import trace for requested module:\n+       ./app/module.js\n+       ./app/layout.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -1381,6 +1478,17 @@ describe('ReactRefreshLogBox app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"  ╰─▶   × Error: RspackResolver(NotFound(\"./boom.css\"))\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"× Module build failed:\n+         ╰─▶   × Error: RspackResolver(NotFound(\"./boom.css\"))\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -1413,7 +1521,26 @@ describe('ReactRefreshLogBox app', () => {\n \n       // TODO(veil): Turbopack is flaky. Possibly related to https://linear.app/vercel/issue/NDX-920/turbopack-errors-after-hmr-have-no-stacktraces-in-affected-chunks\n \n-      if (!isTurbopack) {\n+      if (isRspack) {\n+        await expect({ browser, next }).toDisplayRedbox(`\n+         {\n+           \"description\": \"module error\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Runtime Error\",\n+           \"source\": \"index.js (1:7) @ eval\n+         > 1 | throw new Error('module error')\n+             |       ^\",\n+           \"stack\": [\n+             \"eval index.js (1:7)\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"eval ./app/server/page.js\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+           ],\n+         }\n+        `)\n+      } else if (!isTurbopack) {\n         await expect({ browser, next }).toDisplayRedbox(`\n          {\n            \"description\": \"module error\",\n@@ -1578,6 +1705,27 @@ export default function Home() {\n          ],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"utils error\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Runtime Error\",\n+         \"source\": \"app/utils.ts (1:7) @ eval\n+       > 1 | throw new Error('utils error')\n+           |       ^\",\n+         \"stack\": [\n+           \"eval app/utils.ts (1:7)\",\n+           \"<FIXME-next-dist-dir>\",\n+           \"<FIXME-next-dist-dir>\",\n+           \"<FIXME-next-dist-dir>\",\n+           \"eval ./app/page.js\",\n+           \"<FIXME-next-dist-dir>\",\n+           \"<FIXME-next-dist-dir>\",\n+           \"<FIXME-next-dist-dir>\",\n+         ],\n+       }\n+      `)\n     } else {\n       // FIXME: Webpack stack frames are not source mapped\n       await expect(browser).toDisplayRedbox(`"
        },
        {
            "sha": "25204fbb9e9819fd735d1350ede24f3f5a3af73d",
            "filename": "test/development/acceptance-app/ReactRefreshLogBoxMisc.test.ts",
            "status": "modified",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBoxMisc.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBoxMisc.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2FReactRefreshLogBoxMisc.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -8,6 +8,7 @@ describe('ReactRefreshLogBox app', () => {\n     files: new FileRef(path.join(__dirname, 'fixtures', 'default-template')),\n     skipStart: true,\n   })\n+  const isRspack = !!process.env.NEXT_RSPACK\n \n   test('server-side only compilation errors', async () => {\n     await using sandbox = await createSandbox(next)\n@@ -44,6 +45,32 @@ describe('ReactRefreshLogBox app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./app/page.js\n+         × Module build failed:\n+         ╰─▶   × Error:   x \"getStaticProps\" is not supported in app/. Read more: https://nextjs.org/docs/app/building-your-application/data-fetching\n+               │   |\n+               │\n+               │    ,-[3:1]\n+               │  1 | 'use client'\n+               │  2 | import myLibrary from 'my-non-existent-library'\n+               │  3 | export async function getStaticProps() {\n+               │    :                       ^^^^^^^^^^^^^^\n+               │  4 |   return {\n+               │  5 |     props: {\n+               │  6 |       result: myLibrary()\n+               │    \\`----\n+               │\n+       Import trace for requested module:\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {"
        },
        {
            "sha": "4f6b55ecc2ff2585089ba3dddd07ae7646f73a69",
            "filename": "test/development/acceptance-app/error-recovery.test.ts",
            "status": "modified",
            "additions": 161,
            "deletions": 20,
            "changes": 181,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2Ferror-recovery.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2Ferror-recovery.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Ferror-recovery.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -5,13 +5,12 @@ import { check } from 'next-test-utils'\n import path from 'path'\n import { outdent } from 'outdent'\n \n-const isRspack = !!process.env.NEXT_RSPACK\n-\n describe('Error recovery app', () => {\n   const { next, isTurbopack } = nextTestSetup({\n     files: new FileRef(path.join(__dirname, 'fixtures', 'default-template')),\n     skipStart: true,\n   })\n+  const isRspack = !!process.env.NEXT_RSPACK\n \n   test('can recover from a syntax error without losing state', async () => {\n     await using sandbox = await createSandbox(next)\n@@ -63,12 +62,12 @@ describe('Error recovery app', () => {\n          \"label\": \"Build Error\",\n          \"source\": \"./index.js\n          × Module build failed:\n-         ╰─▶   × Error:   x Unexpected eof\n-               │    ,---- \n+         ╰─▶   × Error:   x Expected '>', got '<eof>'\n+               │    ,----\n                │  1 | export default () => <div/\n                │    \\`----\n-               │ \n-               │ \n+               │\n+               │\n                │ Caused by:\n                │     Syntax Error\n        Import trace for requested module:\n@@ -149,6 +148,28 @@ describe('Error recovery app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./app/server/page.js\n+         × Module build failed:\n+         ╰─▶   × Error:   x Expected '}', got '<eof>'\n+               │    ,-[2:1]\n+               │  1 | export default function Page() {\n+               │  2 |   return <p>Hello world</p>\n+               │    \\`----\n+               │\n+               │\n+               │ Caused by:\n+               │     Syntax Error\n+       Import trace for requested module:\n+       ./app/server/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -212,6 +233,28 @@ describe('Error recovery app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./app/client/page.js\n+         × Module build failed:\n+         ╰─▶   × Error:   x Expected '}', got '<eof>'\n+               │    ,-[2:1]\n+               │  1 | export default function Page() {\n+               │  2 |   return <p>Hello world</p>\n+               │    \\`----\n+               │\n+               │\n+               │ Caused by:\n+               │     Syntax Error\n+       Import trace for requested module:\n+       ./app/client/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -569,18 +612,18 @@ describe('Error recovery app', () => {\n     await browser.eval('window.triggerError()')\n     if (isRspack) {\n       await expect(browser).toDisplayCollapsedRedbox(`\n-         {\n-           \"description\": \"no 1\",\n-           \"environmentLabel\": null,\n-           \"label\": \"Runtime Error\",\n-           \"source\": \"index.js (7:11) @ eval\n-         > 7 |     throw Error('no ' + i)\n-             |           ^\",\n-           \"stack\": [\n-             \"eval index.js (7:11)\",\n-           ],\n-         }\n-        `)\n+       {\n+         \"description\": \"no 1\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Runtime Error\",\n+         \"source\": \"index.js (7:11) @ eval\n+       >  7 |     throw Error('no ' + i)\n+            |           ^\",\n+         \"stack\": [\n+           \"eval index.js (7:11)\",\n+         ],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayCollapsedRedbox(`\n        {\n@@ -628,6 +671,31 @@ describe('Error recovery app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./index.js\n+         × Module build failed:\n+         ╰─▶   × Error:   x Expected '}', got '<eof>'\n+               │     ,-[10:1]\n+               │   7 |     throw Error('no ' + i)\n+               │   8 |   }, 0)\n+               │   9 | }\n+               │  10 | export default function FunctionNamed() {\n+               │     \\`----\n+               │\n+               │\n+               │ Caused by:\n+               │     Syntax Error\n+       Import trace for requested module:\n+       ./index.js\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -664,6 +732,31 @@ describe('Error recovery app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./index.js\n+         × Module build failed:\n+         ╰─▶   × Error:   x Expected '}', got '<eof>'\n+               │     ,-[10:1]\n+               │   7 |     throw Error('no ' + i)\n+               │   8 |   }, 0)\n+               │   9 | }\n+               │  10 | export default function FunctionNamed() {\n+               │     \\`----\n+               │\n+               │\n+               │ Caused by:\n+               │     Syntax Error\n+       Import trace for requested module:\n+       ./index.js\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -852,8 +945,8 @@ describe('Error recovery app', () => {\n                │  6 |   }\n                │  7 | }\n                │    \\`----\n-               │ \n-               │ \n+               │\n+               │\n                │ Caused by:\n                │     Syntax Error\n        Import trace for requested module:\n@@ -918,6 +1011,35 @@ describe('Error recovery app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./index.js\n+         × Module build failed:\n+         ╰─▶   × Error:   x Expected '{', got 'throw'\n+               │    ,-[5:1]\n+               │  2 |\n+               │  3 | class ClassDefault extends React.Component {\n+               │  4 |   render()\n+               │  5 |     throw new Error('nooo');\n+               │    :     ^^^^^\n+               │  6 |     return <h1>Default Export</h1>;\n+               │  7 |   }\n+               │  8 | }\n+               │    \\`----\n+               │\n+               │\n+               │ Caused by:\n+               │     Syntax Error\n+       Import trace for requested module:\n+       ./index.js\n+       ./app/page.js\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {\n@@ -1019,6 +1141,25 @@ describe('Error recovery app', () => {\n          \"stack\": [],\n        }\n       `)\n+    } else if (isRspack) {\n+      await expect(browser).toDisplayRedbox(`\n+       {\n+         \"description\": \"  × Module build failed:\",\n+         \"environmentLabel\": null,\n+         \"label\": \"Build Error\",\n+         \"source\": \"./app/page.js\n+         × Module build failed:\n+         ╰─▶   × Error:   x Expected '}', got '<eof>'\n+               │    ,----\n+               │  1 | {{{\n+               │    \\`----\n+               │\n+               │\n+               │ Caused by:\n+               │     Syntax Error\",\n+         \"stack\": [],\n+       }\n+      `)\n     } else {\n       await expect(browser).toDisplayRedbox(`\n        {"
        },
        {
            "sha": "6531d8aa436eef52c9812ec0821a72eecd326a39",
            "filename": "test/development/acceptance-app/invalid-imports.test.ts",
            "status": "modified",
            "additions": 36,
            "deletions": 0,
            "changes": 36,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2Finvalid-imports.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance-app%2Finvalid-imports.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance-app%2Finvalid-imports.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -71,6 +71,18 @@ describe('Error Overlay invalid imports', () => {\n         'client-only' cannot be imported from a Server Component module. It should only be used from a Client Component.\n         The error was caused by using 'styled-jsx'. It only works in a Client Component but none of its parents are marked with \"use client\", so they're Server Components by default.\"\n       `)\n+    } else if (process.env.NEXT_RSPACK) {\n+      expect(await session.getRedboxSource()).toMatchInlineSnapshot(`\n+       \"./app/comp2.js\n+         × 'client-only' cannot be imported from a Server Component module. It should only be used from a Client Component.\n+         │ \n+         │ The error was caused by using 'styled-jsx' in './app/comp2.js'. It only works in a Client Component but none of its parents are marked with \"use client\", so they're Server Components by default.\n+         │ \n+         │ Import trace for requested module:\n+       │   ./app/comp2.js\n+       │   ./app/comp1.js\n+       │   ./app/page.js\"\n+      `)\n     } else {\n       expect(await session.getRedboxSource()).toMatchInlineSnapshot(`\n               \"./app/comp2.js\n@@ -153,6 +165,18 @@ describe('Error Overlay invalid imports', () => {\n         'client-only' cannot be imported from a Server Component module. It should only be used from a Client Component.\n         The error was caused by importing 'node_modules/client-only-package'\"\n       `)\n+    } else if (process.env.NEXT_RSPACK) {\n+      expect(await session.getRedboxSource()).toMatchInlineSnapshot(`\n+       \"./app/comp2.js\n+         × 'client-only' cannot be imported from a Server Component module. It should only be used from a Client Component.\n+         │ \n+         │ The error was caused by importing 'client-only-package/index.js' in './app/comp2.js'.\n+         │ \n+         │ Import trace for requested module:\n+       │   ./app/comp2.js\n+       │   ./app/comp1.js\n+       │   ./app/page.js\"\n+      `)\n     } else {\n       expect(await session.getRedboxSource()).toMatchInlineSnapshot(`\n         \"./app/comp2.js\n@@ -233,6 +257,18 @@ describe('Error Overlay invalid imports', () => {\n         'server-only' cannot be imported from a Client Component module. It should only be used from a Server Component.\n         The error was caused by importing 'node_modules/server-only-package'\"\n       `)\n+    } else if (process.env.NEXT_RSPACK) {\n+      expect(await session.getRedboxSource()).toMatchInlineSnapshot(`\n+       \"./app/comp2.js\n+         × 'server-only' cannot be imported from a Client Component module. It should only be used from a Server Component.\n+         │ \n+         │ The error was caused by importing 'server-only-package/index.js' in './app/comp2.js'.\n+         │ \n+         │ Import trace for requested module:\n+       │   ./app/comp2.js\n+       │   ./app/comp1.js\n+       │   ./app/page.js\"\n+      `)\n     } else {\n       expect(await session.getRedboxSource()).toMatchInlineSnapshot(`\n         \"./app/comp2.js"
        },
        {
            "sha": "e81a04561d13bde24e6787119c39f5a90f0de78c",
            "filename": "test/development/acceptance/ReactRefreshLogBox-app-doc.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance%2FReactRefreshLogBox-app-doc.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance%2FReactRefreshLogBox-app-doc.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance%2FReactRefreshLogBox-app-doc.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -128,15 +128,15 @@ describe('ReactRefreshLogBox _app _document', () => {\n                │    ,-[2:1]\n                │  1 | function MyApp({ Component, pageProps }) {\n                │  2 |   return <<Component {...pageProps} />;\n-               │    :           ^\n+               │    :          ^^\n                │  3 | }\n                │  4 | export default MyApp\n                │    \\`----\n-               │   x Expression expected\n+               │   x Expected ';', got '{'\n                │    ,-[2:1]\n                │  1 | function MyApp({ Component, pageProps }) {\n                │  2 |   return <<Component {...pageProps} />;\n-               │    :            ^^^^^^^^^\n+               │    :                      ^\n                │  3 | }\n                │  4 | export default MyApp\n                │    \\`----"
        },
        {
            "sha": "f25fc50345fafcc0616ff5b375cfebe080b818f7",
            "filename": "test/development/acceptance/server-component-compiler-errors-in-pages.test.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 9,
            "changes": 15,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance%2Fserver-component-compiler-errors-in-pages.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Facceptance%2Fserver-component-compiler-errors-in-pages.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Facceptance%2Fserver-component-compiler-errors-in-pages.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -82,10 +82,9 @@ describe('Error Overlay for server components compiler errors in pages', () => {\n       ).toMatchInlineSnapshot(`\n        \"./components/Comp.js\n          × Module build failed:\n-         ╰─▶   × Error:   x You're importing a component that needs \"next/headers\". That only works in a Server Component which is not supported in the pages/ directory. Read more: https://nextjs.org/docs/app/building-\n-               │   | your-application/rendering/server-components\n-               │   |\n+         ╰─▶   × Error:   x You're importing a component that needs \"next/headers\". That only works in a Server Component which is not supported in the pages/ directory. Read more: https://nextjs.org/docs/app/building-your-application/rendering/server-components\n                │   |\n+               │\n                │    ,-[1:1]\n                │  1 | import { cookies } from 'next/headers'\n                │    : ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -167,10 +166,9 @@ describe('Error Overlay for server components compiler errors in pages', () => {\n       ).toMatchInlineSnapshot(`\n        \"./components/Comp.js\n          × Module build failed:\n-         ╰─▶   × Error:   x You're importing a component that needs \"server-only\". That only works in a Server Component which is not supported in the pages/ directory. Read more: https://nextjs.org/docs/app/building-your-\n-               │   | application/rendering/server-components\n-               │   |\n+         ╰─▶   × Error:   x You're importing a component that needs \"server-only\". That only works in a Server Component which is not supported in the pages/ directory. Read more: https://nextjs.org/docs/app/building-your-application/rendering/server-components\n                │   |\n+               │\n                │    ,-[1:1]\n                │  1 | import 'server-only'\n                │    : ^^^^^^^^^^^^^^^^^^^^\n@@ -254,10 +252,9 @@ describe('Error Overlay for server components compiler errors in pages', () => {\n       ).toMatchInlineSnapshot(`\n        \"./components/Comp.js\n          × Module build failed:\n-         ╰─▶   × Error:   x You're importing a component that needs \"after\". That only works in a Server Component which is not supported in the pages/ directory. Read more: https://nextjs.org/docs/app/building-your-\n-               │   | application/rendering/server-components\n-               │   |\n+         ╰─▶   × Error:   x You're importing a component that needs \"after\". That only works in a Server Component which is not supported in the pages/ directory. Read more: https://nextjs.org/docs/app/building-your-application/rendering/server-components\n                │   |\n+               │\n                │    ,-[1:1]\n                │  1 | import { after } from 'next/server'\n                │    :          ^^^^^"
        },
        {
            "sha": "45e857741f606b787834e9b817f67ef7430b8e8e",
            "filename": "test/development/basic/hmr/run-error-recovery-hmr-test.util.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Fbasic%2Fhmr%2Frun-error-recovery-hmr-test.util.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Fbasic%2Fhmr%2Frun-error-recovery-hmr-test.util.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fbasic%2Fhmr%2Frun-error-recovery-hmr-test.util.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -187,7 +187,7 @@ export function runErrorRecoveryHmrTest(nextConfig: {\n                │  7 | }\n                │    : ^\n                │    \\`----\n-               │   x Unexpected eof\n+               │   x Expected '</', got '<eof>'\n                │    ,-[7:3]\n                │  5 |     div\n                │  6 |   )"
        },
        {
            "sha": "cfde4ec0e2057b3c0bbea25bee27c8e9d53e714f",
            "filename": "test/development/middleware-errors/index.test.ts",
            "status": "modified",
            "additions": 94,
            "deletions": 0,
            "changes": 94,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Fmiddleware-errors%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Fmiddleware-errors%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fmiddleware-errors%2Findex.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -7,6 +7,8 @@ describe('middleware - development errors', () => {\n     files: __dirname,\n     patchFileDelay: 500,\n   })\n+  const isRspack = !!process.env.NEXT_RSPACK\n+\n   beforeEach(async () => {\n     await next.stop()\n   })\n@@ -64,6 +66,20 @@ describe('middleware - development errors', () => {\n            ],\n          }\n         `)\n+      } else if (isRspack) {\n+        await expect(browser).toDisplayRedbox(`\n+         {\n+           \"description\": \"boom\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Runtime Error\",\n+           \"source\": \"middleware.js (3:15) @ default\n+         > 3 |         throw new Error('boom')\n+             |               ^\",\n+           \"stack\": [\n+             \"default middleware.js (3:15)\",\n+           ],\n+         }\n+        `)\n       } else {\n         await expect(browser).toDisplayRedbox(`\n          {\n@@ -213,6 +229,21 @@ describe('middleware - development errors', () => {\n            ],\n          }\n         `)\n+      } else if (isRspack) {\n+        await expect(browser).toDisplayRedbox(`\n+         {\n+           \"description\": \"test is not defined\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Runtime ReferenceError\",\n+           \"source\": \"middleware.js (4:9) @ default\n+         > 4 |         eval('test')\n+             |         ^\",\n+           \"stack\": [\n+             \"<FIXME-file-protocol>\",\n+             \"default middleware.js (4:9)\",\n+           ],\n+         }\n+        `)\n       } else {\n         await expect(browser).toDisplayRedbox(`\n          {\n@@ -294,6 +325,29 @@ describe('middleware - development errors', () => {\n            ],\n          }\n         `)\n+      } else if (isRspack) {\n+        await expect(browser).toDisplayRedbox(`\n+         {\n+           \"description\": \"booooom!\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Runtime Error\",\n+           \"source\": \"middleware.js (3:13) @ eval\n+         > 3 |       throw new Error('booooom!')\n+             |             ^\",\n+           \"stack\": [\n+             \"<FIXME-next-dist-dir>\",\n+             \"eval middleware.js (3:13)\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+           ],\n+         }\n+        `)\n       } else {\n         await expect(browser).toDisplayRedbox(`\n          {\n@@ -434,6 +488,26 @@ describe('middleware - development errors', () => {\n            \"stack\": [],\n          }\n         `)\n+      } else if (isRspack) {\n+        await expect(browser).toDisplayRedbox(`\n+         {\n+           \"description\": \"  × Module build failed:\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Build Error\",\n+           \"source\": \"./middleware.js\n+           × Module build failed:\n+           ╰─▶   × Error:   x Expected '{', got '}'\n+                 │    ,----\n+                 │  1 | export default function () }\n+                 │    :                            ^\n+                 │    \\`----\n+                 │\n+                 │\n+                 │ Caused by:\n+                 │     Syntax Error\",\n+           \"stack\": [],\n+         }\n+        `)\n       } else {\n         await expect(browser).toDisplayRedbox(`\n          {\n@@ -500,6 +574,26 @@ describe('middleware - development errors', () => {\n            \"stack\": [],\n          }\n         `)\n+      } else if (isRspack) {\n+        await expect(browser).toDisplayRedbox(`\n+         {\n+           \"description\": \"  × Module build failed:\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Build Error\",\n+           \"source\": \"./middleware.js\n+           × Module build failed:\n+           ╰─▶   × Error:   x Expected '{', got '}'\n+                 │    ,----\n+                 │  1 | export default function () }\n+                 │    :                            ^\n+                 │    \\`----\n+                 │\n+                 │\n+                 │ Caused by:\n+                 │     Syntax Error\",\n+           \"stack\": [],\n+         }\n+        `)\n       } else {\n         await expect(browser).toDisplayRedbox(`\n          {"
        },
        {
            "sha": "241a36000796dce39d605aa21fdb5fb3a6ea9680",
            "filename": "test/development/pages-dir/client-navigation/rendering.test.ts",
            "status": "modified",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Fpages-dir%2Fclient-navigation%2Frendering.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fdevelopment%2Fpages-dir%2Fclient-navigation%2Frendering.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fdevelopment%2Fpages-dir%2Fclient-navigation%2Frendering.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -17,6 +17,7 @@ describe('Client Navigation rendering', () => {\n       TEST_STRICT_NEXT_HEAD: String(true),\n     },\n   })\n+  const isRspack = !!process.env.NEXT_RSPACK\n \n   function render(\n     pathname: Parameters<typeof renderViaHTTP>[1],\n@@ -282,6 +283,29 @@ describe('Client Navigation rendering', () => {\n            ],\n          }\n         `)\n+      } else if (isRspack) {\n+        await expect(browser).toDisplayRedbox(`\n+         {\n+           \"description\": \"aa is not defined\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Runtime ReferenceError\",\n+           \"source\": \"pages/error-in-the-global-scope.js (1:1) @ eval\n+         > 1 | aa = 10 //eslint-disable-line\n+             | ^\",\n+           \"stack\": [\n+             \"eval pages/error-in-the-global-scope.js (1:1)\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+           ],\n+         }\n+        `)\n       } else {\n         await expect(browser).toDisplayRedbox(`\n          {"
        },
        {
            "sha": "714509e389b919b9dc2991a090cbbc8353f40380",
            "filename": "test/e2e/app-dir/cache-components-errors/cache-components-errors.test.ts",
            "status": "modified",
            "additions": 76,
            "deletions": 2,
            "changes": 78,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fcache-components-errors%2Fcache-components-errors.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -5,14 +5,13 @@ import {\n   getPrerenderOutput,\n } from './utils'\n \n-const isRspack = process.env.NEXT_RSPACK !== undefined\n-\n describe('Cache Components Errors', () => {\n   const { next, isTurbopack, isNextStart, skipped } = nextTestSetup({\n     files: __dirname + '/fixtures/default',\n     skipStart: !isNextDev,\n     skipDeployment: true,\n   })\n+  const isRspack = !!process.env.NEXT_RSPACK\n \n   if (skipped) {\n     return\n@@ -2784,6 +2783,37 @@ describe('Cache Components Errors', () => {\n                  Export encountered an error on /use-cache-private-in-unstable-cache/page: /use-cache-private-in-unstable-cache, exiting the build.\"\n                 `)\n               }\n+            } else if (isRspack) {\n+              if (isDebugPrerender) {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: \"use cache: private\" must not be used within \\`unstable_cache()\\`.\n+                     at 0 (bundler:///app/use-cache-private-in-unstable-cache/page.tsx:21:38)\n+                     at a (<next-dist-dir>)\n+                   19 | }\n+                   20 |\n+                 > 21 | const getCachedData = unstable_cache(async () => {\n+                      |                                      ^\n+                   22 |   'use cache: private'\n+                   23 |\n+                   24 |   return fetch('https://next-data-api-endpoint.vercel.app/api/random').then(\n+                 To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/use-cache-private-in-unstable-cache\" in your browser to investigate the error.\n+                 Error occurred prerendering page \"/use-cache-private-in-unstable-cache\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+                 > Export encountered errors on following paths:\n+                 \t/use-cache-private-in-unstable-cache/page: /use-cache-private-in-unstable-cache\"\n+                `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: \"use cache: private\" must not be used within \\`unstable_cache()\\`.\n+                     at a (<next-dist-dir>)\n+                     at b (<next-dist-dir>)\n+                 To get a more detailed stack trace and pinpoint the issue, try one of the following:\n+                   - Start the app in development mode by running \\`next dev\\`, then open \"/use-cache-private-in-unstable-cache\" in your browser to investigate the error.\n+                   - Rerun the production build with \\`next build --debug-prerender\\` to generate better stack traces.\n+                 Error occurred prerendering page \"/use-cache-private-in-unstable-cache\". Read more: https://nextjs.org/docs/messages/prerender-error\n+                 Export encountered an error on /use-cache-private-in-unstable-cache/page: /use-cache-private-in-unstable-cache, exiting the build.\"\n+                `)\n+              }\n             } else {\n               if (isDebugPrerender) {\n                 expect(output).toMatchInlineSnapshot(`\n@@ -2944,6 +2974,50 @@ describe('Cache Components Errors', () => {\n                  Export encountered an error on /use-cache-private-in-use-cache/page: /use-cache-private-in-use-cache, exiting the build.\"\n                 `)\n               }\n+            } else if (isRspack) {\n+              if (isDebugPrerender) {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n+                     at 0 (bundler:///app/use-cache-private-in-use-cache/page.tsx:15:1)\n+                     at a (<next-dist-dir>)\n+                   13 | }\n+                   14 |\n+                 > 15 | async function Private() {\n+                      | ^\n+                   16 |   'use cache: private'\n+                   17 |\n+                   18 |   return <p>Private</p>\n+                 Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n+                     at 1 (bundler:///app/use-cache-private-in-use-cache/page.tsx:15:1)\n+                     at b (<next-dist-dir>)\n+                   13 | }\n+                   14 |\n+                 > 15 | async function Private() {\n+                      | ^\n+                   16 |   'use cache: private'\n+                   17 |\n+                   18 |   return <p>Private</p>\n+                 To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \\`next dev\\`, then open \"/use-cache-private-in-use-cache\" in your browser to investigate the error.\n+                 Error occurred prerendering page \"/use-cache-private-in-use-cache\". Read more: https://nextjs.org/docs/messages/prerender-error\n+\n+                 > Export encountered errors on following paths:\n+                 \t/use-cache-private-in-use-cache/page: /use-cache-private-in-use-cache\"\n+                `)\n+              } else {\n+                expect(output).toMatchInlineSnapshot(`\n+                 \"Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n+                     at a (<next-dist-dir>)\n+                     at b (<next-dist-dir>)\n+                 Error: \"use cache: private\" must not be used within \"use cache\". It can only be nested inside of another \"use cache: private\".\n+                     at c (<next-dist-dir>)\n+                     at d (<next-dist-dir>)\n+                 To get a more detailed stack trace and pinpoint the issue, try one of the following:\n+                   - Start the app in development mode by running \\`next dev\\`, then open \"/use-cache-private-in-use-cache\" in your browser to investigate the error.\n+                   - Rerun the production build with \\`next build --debug-prerender\\` to generate better stack traces.\n+                 Error occurred prerendering page \"/use-cache-private-in-use-cache\". Read more: https://nextjs.org/docs/messages/prerender-error\n+                 Export encountered an error on /use-cache-private-in-use-cache/page: /use-cache-private-in-use-cache, exiting the build.\"\n+                `)\n+              }\n             } else {\n               if (isDebugPrerender) {\n                 expect(output).toMatchInlineSnapshot(`"
        },
        {
            "sha": "af6f72ea1eb5397558193a2dd8246ebabb94fbba",
            "filename": "test/e2e/app-dir/error-on-next-codemod-comment/error-on-next-codemod-comment.test.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Ferror-on-next-codemod-comment%2Ferror-on-next-codemod-comment.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Ferror-on-next-codemod-comment%2Ferror-on-next-codemod-comment.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Ferror-on-next-codemod-comment%2Ferror-on-next-codemod-comment.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -37,6 +37,22 @@ describe('app-dir - error-on-next-codemod-comment', () => {\n            You have an unresolved @next/codemod comment \"remove jsx of next line\" that needs review.\n            After review, either remove the comment if you made the necessary changes or replace \"@next-codemod-error\" with \"@next-codemod-ignore\" to bypass the build error if no action at this line can be taken.\"\n           `)\n+      } else if (process.env.NEXT_RSPACK) {\n+        expect(await getRedboxSource(browser)).toMatchInlineSnapshot(`\n+         \"./app/page.tsx\n+           × Module build failed:\n+           ╰─▶   × Error:   x You have an unresolved @next/codemod comment \"remove jsx of next line\" that needs review.\n+                 │   | After review, either remove the comment if you made the necessary changes or replace \"@next-codemod-error\" with \"@next-codemod-ignore\" to bypass the build error if no action at this line can be taken.\n+                 │\n+                 │    ,-[2:1]\n+                 │  1 | export default function Page() {\n+                 │  2 |   // @next-codemod-error remove jsx of next line\n+                 │    :  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+                 │  3 |   return <p>hello world</p>\n+                 │  4 | }\n+                 │    \\`----\n+                 │\"\n+        `)\n       } else {\n         expect(await getRedboxSource(browser)).toMatchInlineSnapshot(`\n          \"./app/page.tsx"
        },
        {
            "sha": "196afe8ea2370f62cf5ac0f974c0f6fa7eb6c86e",
            "filename": "test/e2e/app-dir/metadata-invalid-image-file/metadata-invalid-image-file.test.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fmetadata-invalid-image-file%2Fmetadata-invalid-image-file.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fmetadata-invalid-image-file%2Fmetadata-invalid-image-file.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fmetadata-invalid-image-file%2Fmetadata-invalid-image-file.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -6,6 +6,7 @@ describe('metadata-invalid-image-file', () => {\n     skipDeployment: true,\n     skipStart: true,\n   })\n+  const isRspack = !!process.env.NEXT_RSPACK\n \n   if (skipped) return\n \n@@ -33,6 +34,10 @@ describe('metadata-invalid-image-file', () => {\n       // `next build` should fail\n       if (isTurbopack) {\n         expect(next.cliOutput).toContain('Build error occurred')\n+      } else if (isRspack) {\n+        expect(next.cliOutput).toContain(\n+          'Build failed because of Rspack errors'\n+        )\n       } else {\n         expect(next.cliOutput).toContain(\n           'Build failed because of webpack errors'"
        },
        {
            "sha": "cde7606daa3c06166108a2f2459de283b1b10ed0",
            "filename": "test/e2e/app-dir/non-root-project-monorepo/non-root-project-monorepo.test.ts",
            "status": "modified",
            "additions": 57,
            "deletions": 0,
            "changes": 57,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fnon-root-project-monorepo%2Fnon-root-project-monorepo.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fnon-root-project-monorepo%2Fnon-root-project-monorepo.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fnon-root-project-monorepo%2Fnon-root-project-monorepo.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -23,6 +23,7 @@ describe('non-root-project-monorepo', () => {\n     installCommand: 'pnpm i',\n     skipDeployment: true,\n   })\n+  const isRspack = !!process.env.NEXT_RSPACK\n \n   if (skipped) {\n     return\n@@ -103,6 +104,24 @@ describe('non-root-project-monorepo', () => {\n              \"Page app/source-maps-rsc/page.tsx (4:5)\",\n            ]\n           `)\n+        } else if (isRspack) {\n+          expect(await getRedboxSource(browser)).toMatchInlineSnapshot(`\n+           \"app/separate-file.ts (1:11) @ eval\n+\n+           > 1 | throw new Error('Expected error')\n+               |           ^\n+             2 |\"\n+          `)\n+          expect(await getRedboxCallStack(browser)).toMatchInlineSnapshot(`\n+           [\n+             \"eval app/separate-file.ts (1:11)\",\n+             \"<FIXME-file-protocol>\",\n+             \"<FIXME-file-protocol>\",\n+             \"innerArrowFunction app/source-maps-rsc/page.tsx (14:3)\",\n+             \"innerFunction app/source-maps-rsc/page.tsx (10:3)\",\n+             \"Page app/source-maps-rsc/page.tsx (4:5)\",\n+           ]\n+          `)\n         } else {\n           // TODO the function name is incorrect\n           expect(await getRedboxSource(browser)).toMatchInlineSnapshot(`\n@@ -148,6 +167,25 @@ describe('non-root-project-monorepo', () => {\n              \"Page app/source-maps-ssr/page.tsx (6:5)\",\n            ]\n           `)\n+        } else if (isRspack) {\n+          expect(await getRedboxSource(browser)).toMatchInlineSnapshot(`\n+           \"app/separate-file.ts (1:7) @ eval\n+\n+           > 1 | throw new Error('Expected error')\n+               |       ^\n+             2 |\"\n+          `)\n+          expect(await getRedboxCallStack(browser)).toMatchInlineSnapshot(`\n+           [\n+             \"eval app/separate-file.ts (1:7)\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"innerArrowFunction app/source-maps-ssr/page.tsx (16:3)\",\n+             \"innerFunction app/source-maps-ssr/page.tsx (12:3)\",\n+             \"Page app/source-maps-ssr/page.tsx (6:5)\",\n+           ]\n+          `)\n         } else {\n           // TODO the function name should be hidden\n           expect(await getRedboxSource(browser)).toMatchInlineSnapshot(`\n@@ -192,6 +230,25 @@ describe('non-root-project-monorepo', () => {\n              \"effectCallback app/source-maps-client/page.tsx (7:5)\",\n            ]\n           `)\n+        } else if (isRspack) {\n+          expect(await getRedboxSource(browser)).toMatchInlineSnapshot(`\n+           \"app/separate-file.ts (1:7) @ eval\n+\n+           > 1 | throw new Error('Expected error')\n+               |       ^\n+             2 |\"\n+          `)\n+          expect(await getRedboxCallStack(browser)).toMatchInlineSnapshot(`\n+           [\n+             \"eval app/separate-file.ts (1:7)\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"<FIXME-next-dist-dir>\",\n+             \"innerArrowFunction app/source-maps-client/page.tsx (17:3)\",\n+             \"innerFunction app/source-maps-client/page.tsx (13:3)\",\n+             \"effectCallback app/source-maps-client/page.tsx (7:5)\",\n+           ]\n+          `)\n         } else {\n           // TODO the function name should be hidden\n           expect(await getRedboxSource(browser)).toMatchInlineSnapshot(`"
        },
        {
            "sha": "6a04cdf49c7e77daa73b4327e53dadea8438a2b5",
            "filename": "test/e2e/app-dir/scss/compilation-and-prefixing/compilation-and-prefixing.test.ts",
            "status": "modified",
            "additions": 44,
            "deletions": 0,
            "changes": 44,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Fcompilation-and-prefixing%2Fcompilation-and-prefixing.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Fcompilation-and-prefixing%2Fcompilation-and-prefixing.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Fcompilation-and-prefixing%2Fcompilation-and-prefixing.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -128,6 +128,50 @@ describe.each([\n               }\n             `)\n           }\n+        } else if (process.env.NEXT_RSPACK) {\n+          if (dependencies.sass) {\n+            expect(sourceMapContentParsed).toMatchInlineSnapshot(`\n+             {\n+               \"mappings\": \"AAEE,uBACE,SAHE,CAON,cACE,2CAAA\",\n+               \"names\": [],\n+               \"sourcesContent\": [\n+                 \"$var: red;\n+             .redText {\n+               ::placeholder {\n+                 color: $var;\n+               }\n+             }\n+\n+             .flex-parsing {\n+               flex: 0 0 calc(50% - var(--vertical-gutter));\n+             }\n+             \",\n+               ],\n+               \"version\": 3,\n+             }\n+            `)\n+          } else {\n+            expect(sourceMapContentParsed).toMatchInlineSnapshot(`\n+             {\n+               \"mappings\": \"AAEE,uBACE,SAHE,CAON,cACE,2CAAA\",\n+               \"names\": [],\n+               \"sourcesContent\": [\n+                 \"$var: red;\n+             .redText {\n+               ::placeholder {\n+                 color: $var;\n+               }\n+             }\n+\n+             .flex-parsing {\n+               flex: 0 0 calc(50% - var(--vertical-gutter));\n+             }\n+             \",\n+               ],\n+               \"version\": 3,\n+             }\n+            `)\n+          }\n         } else {\n           if (dependencies.sass) {\n             expect(sourceMapContentParsed).toMatchInlineSnapshot(`"
        },
        {
            "sha": "2236f623a81a47848e4d0d2b528e82144d34cdae",
            "filename": "test/e2e/app-dir/scss/invalid-global-module/invalid-global-module.test.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global-module%2Finvalid-global-module.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global-module%2Finvalid-global-module.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global-module%2Finvalid-global-module.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -26,9 +26,12 @@ describe.skip('Invalid CSS Global Module Usage in node_modules', () => {\n         expect(stderr).toMatch(\n           /Global CSS.*cannot.*be imported from within.*node_modules/\n         )\n-        expect(stderr).toMatch(\n-          /Location:.*node_modules[\\\\/]example[\\\\/]index\\.mjs/\n-        )\n+        // Skip: Rspack loaders cannot access module issuer info for location details\n+        if (!process.env.NEXT_RSPACK) {\n+          expect(stderr).toMatch(\n+            /Location:.*node_modules[\\\\/]example[\\\\/]index\\.mjs/\n+          )\n+        }\n       })\n     }\n   )"
        },
        {
            "sha": "03bf423c8f73677c3124ad75eff88bb2538c87b9",
            "filename": "test/e2e/app-dir/scss/invalid-global-with-app/invalid-global-with-app.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global-with-app%2Finvalid-global-with-app.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global-with-app%2Finvalid-global-with-app.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global-with-app%2Finvalid-global-with-app.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -21,6 +21,9 @@ describe('Invalid Global CSS with Custom App', () => {\n     expect(stderr).toMatch(\n       /Please move all first-party global CSS imports.*?pages(\\/|\\\\)_app/\n     )\n-    expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+    // Skip: Rspack loaders cannot access module issuer info for location details\n+    if (!process.env.NEXT_RSPACK) {\n+      expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+    }\n   })\n })"
        },
        {
            "sha": "1a2b574af42d5359959a0ddca0c4c2ab89a167e4",
            "filename": "test/e2e/app-dir/scss/invalid-global/invalid-global.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global%2Finvalid-global.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global%2Finvalid-global.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-global%2Finvalid-global.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -21,6 +21,9 @@ describe('Invalid Global CSS', () => {\n     expect(stderr).toMatch(\n       /Please move all first-party global CSS imports.*?pages(\\/|\\\\)_app/\n     )\n-    expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+    // Skip: Rspack loaders cannot access module issuer info for location details\n+    if (!process.env.NEXT_RSPACK) {\n+      expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+    }\n   })\n })"
        },
        {
            "sha": "ae6a9b721c541a451e44b8fff735bc15e9470da6",
            "filename": "test/e2e/app-dir/scss/invalid-module-document/invalid-module-document.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-module-document%2Finvalid-module-document.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-module-document%2Finvalid-module-document.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-module-document%2Finvalid-module-document.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -29,7 +29,10 @@ import 'e2e-utils'\n           expect(stderr).toMatch(\n             /CSS.*cannot.*be imported within.*pages[\\\\/]_document\\.js/\n           )\n-          expect(stderr).toMatch(/Location:.*pages[\\\\/]_document\\.js/)\n+          // Skip: Rspack loaders cannot access module issuer info for location details\n+          if (!process.env.NEXT_RSPACK) {\n+            expect(stderr).toMatch(/Location:.*pages[\\\\/]_document\\.js/)\n+          }\n         })\n       }\n     )"
        },
        {
            "sha": "e51ca01f58e9df9ae7efbb38a5fdead234db325c",
            "filename": "test/e2e/app-dir/scss/invalid-module/invalid-module.test.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-module%2Finvalid-module.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-module%2Finvalid-module.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Finvalid-module%2Finvalid-module.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -26,9 +26,12 @@ describe.skip('Invalid CSS Module Usage in node_modules', () => {\n         expect(stderr).toMatch(\n           /CSS Modules.*cannot.*be imported from within.*node_modules/\n         )\n-        expect(stderr).toMatch(\n-          /Location:.*node_modules[\\\\/]example[\\\\/]index\\.mjs/\n-        )\n+        // Skip: Rspack loaders cannot access module issuer info for location details\n+        if (!process.env.NEXT_RSPACK) {\n+          expect(stderr).toMatch(\n+            /Location:.*node_modules[\\\\/]example[\\\\/]index\\.mjs/\n+          )\n+        }\n       })\n     }\n   )"
        },
        {
            "sha": "456891779ec0760ef5cfd9ea7f3440c02468c34e",
            "filename": "test/e2e/app-dir/scss/valid-and-invalid-global/valid-and-invalid-global.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Fvalid-and-invalid-global%2Fvalid-and-invalid-global.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fscss%2Fvalid-and-invalid-global%2Fvalid-and-invalid-global.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fscss%2Fvalid-and-invalid-global%2Fvalid-and-invalid-global.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -19,6 +19,9 @@ describe('Valid and Invalid Global CSS with Custom App', () => {\n     expect(stderr).toContain('Failed to compile')\n     expect(stderr).toContain('styles/global.scss')\n     expect(stderr).toContain('Please move all first-party global CSS imports')\n-    expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+    // Skip: Rspack loaders cannot access module issuer info for location details\n+    if (!process.env.NEXT_RSPACK) {\n+      expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+    }\n   })\n })"
        },
        {
            "sha": "ddcb977e411c37d0301dc49892b983f61340d4f4",
            "filename": "test/e2e/app-dir/use-cache-segment-configs/use-cache-segment-configs.test.ts",
            "status": "modified",
            "additions": 23,
            "deletions": 3,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fuse-cache-segment-configs%2Fuse-cache-segment-configs.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fuse-cache-segment-configs%2Fuse-cache-segment-configs.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-segment-configs%2Fuse-cache-segment-configs.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -2,15 +2,15 @@ import { nextTestSetup } from 'e2e-utils'\n import { assertHasRedbox } from 'next-test-utils'\n import stripAnsi from 'strip-ansi'\n \n-const isRspack = !!process.env.NEXT_RSPACK\n-\n describe('use-cache-segment-configs', () => {\n   const { next, skipped, isNextDev, isTurbopack } = nextTestSetup({\n     files: __dirname,\n     skipStart: process.env.NEXT_TEST_MODE !== 'dev',\n     skipDeployment: true,\n   })\n \n+  const isRspack = !!process.env.NEXT_RSPACK\n+\n   if (skipped) {\n     return\n   }\n@@ -34,6 +34,26 @@ describe('use-cache-segment-configs', () => {\n            \"stack\": [],\n          }\n         `)\n+      } else if (isRspack) {\n+        await expect(browser).toDisplayRedbox(`\n+         {\n+           \"description\": \"  × Module build failed:\",\n+           \"environmentLabel\": null,\n+           \"label\": \"Build Error\",\n+           \"source\": \"<FIXME-nextjs-internal-source>\n+           × Module build failed:\n+           ╰─▶   × Error:   x Route segment config \"runtime\" is not compatible with \\`nextConfig.experimental.useCache\\`. Please remove it.\n+                 │    ,-[1:1]\n+                 │  1 | export const runtime = 'edge'\n+                 │    :              ^^^^^^^\n+                 │  2 |\n+                 │  3 | export default function Page() {\n+                 │  4 |   return <div>This page uses \\`export const runtime\\`.</div>\n+                 │    \\`----\n+                 │\",\n+           \"stack\": [],\n+         }\n+        `)\n       } else {\n         // FIXME: Fix broken import trace for Webpack loader resource.\n         await expect(browser).toDisplayRedbox(`\n@@ -95,7 +115,7 @@ describe('use-cache-segment-configs', () => {\n          // TODO(veil): Fix broken import trace for Webpack loader resource.\n \n \n-         > Build failed because of rspack errors\n+         > Build failed because of Rspack errors\n          \"\n         `)\n       } else {"
        },
        {
            "sha": "e371d252dee4dceb70f29d376d4ed0a41e861e7f",
            "filename": "test/e2e/app-dir/use-cache-unknown-cache-kind/use-cache-unknown-cache-kind.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fuse-cache-unknown-cache-kind%2Fuse-cache-unknown-cache-kind.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fuse-cache-unknown-cache-kind%2Fuse-cache-unknown-cache-kind.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-unknown-cache-kind%2Fuse-cache-unknown-cache-kind.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -68,7 +68,7 @@ describe('use-cache-unknown-cache-kind', () => {\n          ./app/page.tsx\n \n \n-         > Build failed because of rspack errors\n+         > Build failed because of Rspack errors\n          \"\n         `)\n       } else {"
        },
        {
            "sha": "ac8f9ce610e002e466cf60abcd4cdfd166e0cd8a",
            "filename": "test/e2e/app-dir/use-cache-without-experimental-flag/use-cache-without-experimental-flag.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fuse-cache-without-experimental-flag%2Fuse-cache-without-experimental-flag.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fe2e%2Fapp-dir%2Fuse-cache-without-experimental-flag%2Fuse-cache-without-experimental-flag.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fe2e%2Fapp-dir%2Fuse-cache-without-experimental-flag%2Fuse-cache-without-experimental-flag.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -73,7 +73,7 @@ describe('use-cache-without-experimental-flag', () => {\n          ./app/page.tsx\n \n \n-         > Build failed because of rspack errors\n+         > Build failed because of Rspack errors\n          \"\n         `)\n       } else {"
        },
        {
            "sha": "c6121c5cca56b00f303145ae53a02eb48808ed37",
            "filename": "test/integration/css-customization/test/index.test.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Fcss-customization%2Ftest%2Findex.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Fcss-customization%2Ftest%2Findex.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fcss-customization%2Ftest%2Findex.test.js?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -6,7 +6,7 @@ import { nextBuild } from 'next-test-utils'\n import escapeStringRegexp from 'escape-string-regexp'\n \n const fixturesDir = join(__dirname, '../..', 'css-fixtures')\n-const BUILD_FAILURE_RE = /Build failed because of (webpack|rspack) errors/\n+const BUILD_FAILURE_RE = /Build failed because of (webpack|Rspack) errors/\n \n // Test checks webpack loaders and plugins.\n ;(process.env.IS_TURBOPACK_TEST ? describe.skip : describe)("
        },
        {
            "sha": "0626a3399b48832c797c2b9d4bea5367d80c7057",
            "filename": "test/integration/css-modules/test/index.test.js",
            "status": "modified",
            "additions": 12,
            "deletions": 6,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Fcss-modules%2Ftest%2Findex.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Fcss-modules%2Ftest%2Findex.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fcss-modules%2Ftest%2Findex.test.js?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -303,9 +303,12 @@ describe.skip('Invalid CSS Module Usage in node_modules', () => {\n         expect(stderr).toMatch(\n           /CSS Modules.*cannot.*be imported from within.*node_modules/\n         )\n-        expect(stderr).toMatch(\n-          /Location:.*node_modules[\\\\/]example[\\\\/]index\\.mjs/\n-        )\n+        // Skip: Rspack loaders cannot access module issuer info for location details\n+        if (!process.env.NEXT_RSPACK) {\n+          expect(stderr).toMatch(\n+            /Location:.*node_modules[\\\\/]example[\\\\/]index\\.mjs/\n+          )\n+        }\n       })\n     }\n   )\n@@ -331,9 +334,12 @@ describe.skip('Invalid Global CSS Module Usage in node_modules', () => {\n         expect(stderr).toMatch(\n           /Global CSS.*cannot.*be imported from within.*node_modules/\n         )\n-        expect(stderr).toMatch(\n-          /Location:.*node_modules[\\\\/]example[\\\\/]index\\.mjs/\n-        )\n+        // Skip: Rspack loaders cannot access module issuer info for location details\n+        if (!process.env.NEXT_RSPACK) {\n+          expect(stderr).toMatch(\n+            /Location:.*node_modules[\\\\/]example[\\\\/]index\\.mjs/\n+          )\n+        }\n       })\n     }\n   )"
        },
        {
            "sha": "a4f8771102ea4726d0eed4f31c5cb958804b90e6",
            "filename": "test/integration/css/test/valid-invalid-css.test.js",
            "status": "modified",
            "additions": 16,
            "deletions": 4,
            "changes": 20,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Fcss%2Ftest%2Fvalid-invalid-css.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Fcss%2Ftest%2Fvalid-invalid-css.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fcss%2Ftest%2Fvalid-invalid-css.test.js?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -36,7 +36,10 @@ const fixturesDir = join(__dirname, '../..', 'css-fixtures')\n           expect(stderr).toMatch(\n             /CSS.*cannot.*be imported within.*pages[\\\\/]_document\\.js/\n           )\n-          expect(stderr).toMatch(/Location:.*pages[\\\\/]_document\\.js/)\n+          // Skip: Rspack loaders cannot access module issuer info for location details\n+          if (!process.env.NEXT_RSPACK) {\n+            expect(stderr).toMatch(/Location:.*pages[\\\\/]_document\\.js/)\n+          }\n         })\n       }\n     )\n@@ -65,7 +68,10 @@ const fixturesDir = join(__dirname, '../..', 'css-fixtures')\n           expect(stderr).toMatch(\n             /Please move all first-party global CSS imports.*?pages(\\/|\\\\)_app/\n           )\n-          expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+          // Skip: Rspack loaders cannot access module issuer info for location details\n+          if (!process.env.NEXT_RSPACK) {\n+            expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+          }\n         })\n       }\n     )\n@@ -142,7 +148,10 @@ describe('Valid Global CSS from npm', () => {\n           expect(stderr).toMatch(\n             /Please move all first-party global CSS imports.*?pages(\\/|\\\\)_app/\n           )\n-          expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+          // Skip: Rspack loaders cannot access module issuer info for location details\n+          if (!process.env.NEXT_RSPACK) {\n+            expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+          }\n         })\n       }\n     )\n@@ -173,7 +182,10 @@ describe('Valid Global CSS from npm', () => {\n           expect(stderr).toContain(\n             'Please move all first-party global CSS imports'\n           )\n-          expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+          // Skip: Rspack loaders cannot access module issuer info for location details\n+          if (!process.env.NEXT_RSPACK) {\n+            expect(stderr).toMatch(/Location:.*pages[\\\\/]index\\.js/)\n+          }\n         })\n       }\n     )"
        },
        {
            "sha": "05cb852811a236928089613b7e50b91f02267c3d",
            "filename": "test/integration/invalid-document-image-import/test/index.test.js",
            "status": "modified",
            "additions": 19,
            "deletions": 7,
            "changes": 26,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Finvalid-document-image-import%2Ftest%2Findex.test.js",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Finvalid-document-image-import%2Ftest%2Findex.test.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Finvalid-document-image-import%2Ftest%2Findex.test.js?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -25,7 +25,10 @@ const nextConfig = new File(join(appDir, 'next.config.js'))\n           expect(stderr).toMatch(\n             /Images.*cannot.*be imported within.*pages[\\\\/]_document\\.js/\n           )\n-          expect(stderr).toMatch(/Location:.*pages[\\\\/]_document\\.js/)\n+          // Skip: Rspack loaders cannot access module issuer info for location details\n+          if (!process.env.NEXT_RSPACK) {\n+            expect(stderr).toMatch(/Location:.*pages[\\\\/]_document\\.js/)\n+          }\n         })\n \n         it('Should fail to build when disableStaticImages in next.config.js', async () => {\n@@ -40,12 +43,21 @@ const nextConfig = new File(join(appDir, 'next.config.js'))\n             stderr: true,\n           })\n           expect(code).not.toBe(0)\n-          expect(stderr).toMatch(\n-            /You may need an appropriate loader to handle this file type, currently no loaders are configured to process this file/\n-          )\n-          expect(stderr).not.toMatch(\n-            /Images.*cannot.*be imported within.*pages[\\\\/]_document\\.js/\n-          )\n+          if (process.env.NEXT_RSPACK) {\n+            expect(stderr).toContain(\n+              'You may need an appropriate loader to handle this file type'\n+            )\n+          } else {\n+            expect(stderr).toMatch(\n+              /You may need an appropriate loader to handle this file type, currently no loaders are configured to process this file/\n+            )\n+          }\n+          // Skip: Rspack loaders cannot access module issuer info for location details\n+          if (!process.env.NEXT_RSPACK) {\n+            expect(stderr).not.toMatch(\n+              /Images.*cannot.*be imported within.*pages[\\\\/]_document\\.js/\n+            )\n+          }\n         })\n       }\n     )"
        },
        {
            "sha": "acc9280f85084cc89158073ef8009d3bc4afaa92",
            "filename": "test/integration/next-image-new/invalid-image-import/test/index.test.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/vercel/next.js/blob/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Fnext-image-new%2Finvalid-image-import%2Ftest%2Findex.test.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/45b4a985c504f804a463f666fefae7f7eb1fd75c/test%2Fintegration%2Fnext-image-new%2Finvalid-image-import%2Ftest%2Findex.test.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/test%2Fintegration%2Fnext-image-new%2Finvalid-image-import%2Ftest%2Findex.test.ts?ref=45b4a985c504f804a463f666fefae7f7eb1fd75c",
            "patch": "@@ -26,6 +26,10 @@ function runTests({ isDev }) {\n       const description = await getRedboxDescription(browser)\n       if (process.env.IS_TURBOPACK_TEST) {\n         expect(description).toMatchInlineSnapshot(`\"Processing image failed\"`)\n+      } else if (process.env.NEXT_RSPACK) {\n+        expect(description).toMatchInlineSnapshot(\n+          `\"  × Error: Image import \"../public/invalid.svg\" is not a valid image file. The image may be corrupted or an unsupported format.\"`\n+        )\n       } else {\n         expect(description).toMatchInlineSnapshot(\n           `\"Image import \"../public/invalid.svg\" is not a valid image file. The image may be corrupted or an unsupported format.\"`\n@@ -50,6 +54,11 @@ function runTests({ isDev }) {\n              ./test/integration/next-image-new/invalid-image-import/public/invalid.svg\n              ./test/integration/next-image-new/invalid-image-import/pages/index.js\"\n         `)\n+      } else if (process.env.NEXT_RSPACK) {\n+        expect(source).toMatchInlineSnapshot(`\n+          \"./pages/index.js:3\n+            × Error: Image import \"../public/invalid.svg\" is not a valid image file. The image may be corrupted or an unsupported format.\"\n+        `)\n       } else {\n         expect(source).toMatchInlineSnapshot(`\n           \"./pages/index.js:3"
        }
    ],
    "stats": {
        "total": 972,
        "additions": 901,
        "deletions": 71
    }
}