{
    "author": "fireairforce",
    "message": "Turbopack: RuleCondition support resourceQuery contains (#83468)\n\n## What?\n\nIn utoopack, we have the situation to match modules with query like\nfollowing case:\n\n```ts\nimport styles from './index.less?modules';\n```\n\nTo deal the case above into css modules(other case the same), so i need\nto use the rule condition to match the module with query like:\n\n```rust\nRuleCondition::ResourceQueryContains {\n    extension: \".less\".into(),\n    query: \"?modules\".into(),\n},\n```",
    "sha": "5889fe579955f63ede696c489721aea140d08f64",
    "files": [
        {
            "sha": "b1ab18fda776e1da7e9df3185f85af6d8f4dc1fd",
            "filename": "turbopack/crates/turbopack/src/module_options/rule_condition.rs",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/5889fe579955f63ede696c489721aea140d08f64/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Frule_condition.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/5889fe579955f63ede696c489721aea140d08f64/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Frule_condition.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack%2Fsrc%2Fmodule_options%2Frule_condition.rs?ref=5889fe579955f63ede696c489721aea140d08f64",
            "patch": "@@ -45,6 +45,7 @@ pub enum RuleCondition {\n         glob: ReadRef<Glob>,\n     },\n     ResourceBasePathGlob(#[turbo_tasks(trace_ignore)] ReadRef<Glob>),\n+    ResourceQueryContains(String),\n }\n \n impl RuleCondition {\n@@ -282,6 +283,10 @@ impl RuleCondition {\n                             FileContent::NotFound => return Ok(false),\n                         }\n                     }\n+                    RuleCondition::ResourceQueryContains(query) => {\n+                        let ident = source.ident().await?;\n+                        return Ok(ident.query.contains(query));\n+                    }\n                 }\n             }\n         }"
        }
    ],
    "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
    }
}