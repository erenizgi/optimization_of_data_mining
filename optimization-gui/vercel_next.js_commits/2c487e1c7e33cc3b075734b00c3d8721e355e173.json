{
    "author": "unstubbable",
    "message": "refactor: Consistently call HMR messages `message` (#83341)\n\nThe HMR messages we send through the WebSocket to the browser were\ninconsistently called `message`, `msg`, `obj`, `payload`, or `action`.\n\nWith this PR, we're streamlining the naming to consistently use\n`message` throughout the codebase. In addition, the discriminating\nproperty `action` is renamed to `type`, aligning it with Turbopack's own\nHMR messages.\n\nAs an alternative, I considered naming them `action` instead, but this\ndid not yield the desired consistency across the codebase. Ultimately, I\ndecided to stick with `message` to avoid confusion and maintain\nalignment with Turbopack's terminology (see\n`@vercel/turbopack-ecmascript-runtime/browser/dev/hmr-client/hmr-client`).",
    "sha": "2c487e1c7e33cc3b075734b00c3d8721e355e173",
    "files": [
        {
            "sha": "1ca846f5e82bfb2546ebf46de97ad860ce32f22c",
            "filename": "packages/next/src/client/dev/amp-dev.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Famp-dev.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Famp-dev.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Famp-dev.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -2,7 +2,7 @@\n import { displayContent } from './fouc'\n import initOnDemandEntries from './on-demand-entries-client'\n import { addMessageListener, connectHMR } from './hot-reloader/pages/websocket'\n-import { HMR_ACTIONS_SENT_TO_BROWSER } from '../../server/dev/hot-reloader-types'\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from '../../server/dev/hot-reloader-types'\n import { reportInvalidHmrMessage } from './hot-reloader/shared'\n \n /// <reference types=\"webpack/module.d.ts\" />\n@@ -78,23 +78,23 @@ async function tryApplyUpdates() {\n \n addMessageListener((message) => {\n   try {\n-    // actions which are not related to amp-dev\n+    // messages which are not related to amp-dev\n     if (\n-      message.action === HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ERROR ||\n-      message.action === HMR_ACTIONS_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE\n+      message.type === HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ERROR ||\n+      message.type === HMR_MESSAGE_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE\n     ) {\n       return\n     }\n     if (\n-      message.action === HMR_ACTIONS_SENT_TO_BROWSER.SYNC ||\n-      message.action === HMR_ACTIONS_SENT_TO_BROWSER.BUILT\n+      message.type === HMR_MESSAGE_SENT_TO_BROWSER.SYNC ||\n+      message.type === HMR_MESSAGE_SENT_TO_BROWSER.BUILT\n     ) {\n       if (!message.hash) {\n         return\n       }\n       mostRecentHash = message.hash\n       tryApplyUpdates()\n-    } else if (message.action === HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE) {\n+    } else if (message.type === HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE) {\n       window.location.reload()\n     }\n   } catch (err: unknown) {"
        },
        {
            "sha": "210b3682c64e6d17cbc4f1d4cba1362831e3e849",
            "filename": "packages/next/src/client/dev/hot-middleware-client.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 14,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-middleware-client.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-middleware-client.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-middleware-client.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -1,3 +1,4 @@\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from '../../server/dev/hot-reloader-types'\n import type {\n   NextRouter,\n   PrivateRouteInfo,\n@@ -23,7 +24,7 @@ let reloading = false\n export default () => {\n   const devClient = connect()\n \n-  devClient.subscribeToHmrEvent((obj: any) => {\n+  devClient.subscribeToHmrEvent((message) => {\n     if (reloading) return\n \n     // Retrieve the router if it's available\n@@ -33,8 +34,8 @@ export default () => {\n     const isOnErrorPage =\n       !router || router.pathname === '/404' || router.pathname === '/_error'\n \n-    switch (obj.action) {\n-      case 'reloadPage': {\n+    switch (message.type) {\n+      case HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE: {\n         sendMessage(\n           JSON.stringify({\n             event: 'client-reload-page',\n@@ -44,8 +45,8 @@ export default () => {\n         reloading = true\n         return window.location.reload()\n       }\n-      case 'removedPage': {\n-        const [page] = obj.data\n+      case HMR_MESSAGE_SENT_TO_BROWSER.REMOVED_PAGE: {\n+        const [page] = message.data\n \n         // Check if the removed page is the current page\n         const isCurrentPage = page === router?.pathname\n@@ -64,15 +65,15 @@ export default () => {\n         }\n         return\n       }\n-      case 'addedPage': {\n-        const [page] = obj.data\n+      case HMR_MESSAGE_SENT_TO_BROWSER.ADDED_PAGE: {\n+        const [page] = message.data\n \n         // Check if the added page is the current page\n         const isCurrentPage = page === router?.pathname\n \n         // Check if the page component is not yet loaded\n         const isPageNotLoaded =\n-          typeof router?.components?.[page] === 'undefined'\n+          page !== null && typeof router?.components?.[page] === 'undefined'\n \n         // We enter this block if the newly added page is the one currently being viewed\n         // but hasn't been loaded yet, or if we're on an error page.\n@@ -88,15 +89,11 @@ export default () => {\n         }\n         return\n       }\n-      case 'serverError':\n-      case 'devPagesManifestUpdate':\n-      case 'isrManifest':\n-      case 'building':\n-      case 'finishBuilding': {\n+      case HMR_MESSAGE_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE: {\n         return\n       }\n       default: {\n-        throw new Error('Unexpected action ' + obj.action)\n+        message satisfies never\n       }\n     }\n   })"
        },
        {
            "sha": "d07759f51a75cc10840f5de31565aac3ef6984a0",
            "filename": "packages/next/src/client/dev/hot-reloader/app/hot-reloader-app.tsx",
            "status": "modified",
            "additions": 49,
            "deletions": 46,
            "changes": 95,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fapp%2Fhot-reloader-app.tsx",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fapp%2Fhot-reloader-app.tsx",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fapp%2Fhot-reloader-app.tsx?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -14,10 +14,10 @@ import { AppDevOverlayErrorBoundary } from '../../../../next-devtools/userspace/\n import { useErrorHandler } from '../../../../next-devtools/userspace/app/errors/use-error-handler'\n import { RuntimeErrorHandler } from '../../runtime-error-handler'\n import { useWebSocketPing } from './web-socket'\n-import { HMR_ACTIONS_SENT_TO_BROWSER } from '../../../../server/dev/hot-reloader-types'\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from '../../../../server/dev/hot-reloader-types'\n import type {\n-  HMR_ACTION_TYPES,\n-  TurbopackMsgToBrowser,\n+  HmrMessageSentToBrowser,\n+  TurbopackMessageSentToBrowser,\n } from '../../../../server/dev/hot-reloader-types'\n import { useUntrackedPathname } from '../../../components/navigation-untracked'\n import reportHmrLatency from '../../report-hmr-latency'\n@@ -197,9 +197,9 @@ function tryApplyUpdatesWebpack(sendMessage: (message: string) => void) {\n \n /** Handles messages from the server for the App Router. */\n export function processMessage(\n-  obj: HMR_ACTION_TYPES,\n+  message: HmrMessageSentToBrowser,\n   sendMessage: (message: string) => void,\n-  processTurbopackMessage: (msg: TurbopackMsgToBrowser) => void,\n+  processTurbopackMessage: (msg: TurbopackMessageSentToBrowser) => void,\n   staticIndicatorState: StaticIndicatorState\n ) {\n   function handleErrors(errors: ReadonlyArray<unknown>) {\n@@ -246,18 +246,18 @@ export function processMessage(\n     }\n   }\n \n-  switch (obj.action) {\n-    case HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST: {\n+  switch (message.type) {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.ISR_MANIFEST: {\n       if (process.env.__NEXT_DEV_INDICATOR) {\n-        staticIndicatorState.appIsrManifest = obj.data\n+        staticIndicatorState.appIsrManifest = message.data\n \n         // handle initial status on receiving manifest\n         // navigation is handled in useEffect for pathname changes\n         // as we'll receive the updated manifest before usePathname\n         // triggers for new value\n         if (\n           staticIndicatorState.pathname &&\n-          staticIndicatorState.pathname in obj.data\n+          staticIndicatorState.pathname in message.data\n         ) {\n           dispatcher.onStaticIndicator(true)\n         } else {\n@@ -266,7 +266,7 @@ export function processMessage(\n       }\n       break\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.BUILDING: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.BUILDING: {\n       dispatcher.buildingIndicatorShow()\n \n       if (process.env.TURBOPACK) {\n@@ -278,22 +278,25 @@ export function processMessage(\n       }\n       break\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.BUILT:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.SYNC: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.BUILT:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.SYNC: {\n       dispatcher.buildingIndicatorHide()\n \n-      if (obj.hash) {\n-        handleAvailableHash(obj.hash)\n+      if (message.hash) {\n+        handleAvailableHash(message.hash)\n       }\n \n-      const { errors, warnings } = obj\n+      const { errors, warnings } = message\n \n       // Is undefined when it's a 'built' event\n-      if ('versionInfo' in obj) dispatcher.onVersionInfo(obj.versionInfo)\n-      if ('debug' in obj && obj.debug) dispatcher.onDebugInfo(obj.debug)\n-      if ('devIndicator' in obj) dispatcher.onDevIndicator(obj.devIndicator)\n-      if ('devToolsConfig' in obj)\n-        dispatcher.onDevToolsConfig(obj.devToolsConfig)\n+      if ('versionInfo' in message)\n+        dispatcher.onVersionInfo(message.versionInfo)\n+      if ('debug' in message && message.debug)\n+        dispatcher.onDebugInfo(message.debug)\n+      if ('devIndicator' in message)\n+        dispatcher.onDevIndicator(message.devIndicator)\n+      if ('devToolsConfig' in message)\n+        dispatcher.onDevToolsConfig(message.devToolsConfig)\n \n       const hasErrors = Boolean(errors && errors.length)\n       // Compilation with errors (e.g. syntax error or missing modules).\n@@ -347,26 +350,26 @@ export function processMessage(\n         })\n       )\n \n-      if (obj.action === HMR_ACTIONS_SENT_TO_BROWSER.BUILT) {\n+      if (message.type === HMR_MESSAGE_SENT_TO_BROWSER.BUILT) {\n         handleHotUpdate()\n       }\n       return\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_CONNECTED: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_CONNECTED: {\n       processTurbopackMessage({\n-        type: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_CONNECTED,\n+        type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_CONNECTED,\n         data: {\n-          sessionId: obj.data.sessionId,\n+          sessionId: message.data.sessionId,\n         },\n       })\n       break\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE: {\n-      turbopackHmr!.onTurbopackMessage(obj)\n+    case HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_MESSAGE: {\n+      turbopackHmr!.onTurbopackMessage(message)\n       dispatcher.onBeforeRefresh()\n       processTurbopackMessage({\n-        type: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE,\n-        data: obj.data,\n+        type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_MESSAGE,\n+        data: message.data,\n       })\n       if (RuntimeErrorHandler.hadRuntimeError) {\n         console.warn(REACT_REFRESH_FULL_RELOAD_FROM_ERROR)\n@@ -376,19 +379,19 @@ export function processMessage(\n       break\n     }\n     // TODO-APP: make server component change more granular\n-    case HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES: {\n       turbopackHmr?.onServerComponentChanges()\n       sendMessage(\n         JSON.stringify({\n           event: 'server-component-reload-page',\n           clientId: __nextDevClientId,\n-          hash: obj.hash,\n+          hash: message.hash,\n         })\n       )\n \n       // Store the latest hash in a session cookie so that it's sent back to the\n       // server with any subsequent requests.\n-      document.cookie = `${NEXT_HMR_REFRESH_HASH_COOKIE}=${obj.hash};path=/`\n+      document.cookie = `${NEXT_HMR_REFRESH_HASH_COOKIE}=${message.hash};path=/`\n \n       if (\n         RuntimeErrorHandler.hadRuntimeError ||\n@@ -413,7 +416,7 @@ export function processMessage(\n \n       return\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE: {\n       turbopackHmr?.onReloadPage()\n       sendMessage(\n         JSON.stringify({\n@@ -425,36 +428,36 @@ export function processMessage(\n       reloading = true\n       return window.location.reload()\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.ADDED_PAGE:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.REMOVED_PAGE: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.ADDED_PAGE:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.REMOVED_PAGE: {\n       turbopackHmr?.onPageAddRemove()\n       // TODO-APP: potentially only refresh if the currently viewed page was added/removed.\n       return publicAppRouterInstance.hmrRefresh()\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ERROR: {\n-      const { errorJSON } = obj\n+    case HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ERROR: {\n+      const { errorJSON } = message\n       if (errorJSON) {\n-        const { message, stack } = JSON.parse(errorJSON)\n-        const error = new Error(message)\n-        error.stack = stack\n+        const errorObject = JSON.parse(errorJSON)\n+        const error = new Error(errorObject.message)\n+        error.stack = errorObject.stack\n         handleErrors([error])\n       }\n       return\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE: {\n       return\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.DEVTOOLS_CONFIG: {\n-      dispatcher.onDevToolsConfig(obj.data)\n+    case HMR_MESSAGE_SENT_TO_BROWSER.DEVTOOLS_CONFIG: {\n+      dispatcher.onDevToolsConfig(message.data)\n       return\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ONLY_CHANGES:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.MIDDLEWARE_CHANGES:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.CLIENT_CHANGES:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ONLY_CHANGES:\n       // These action types are handled in src/client/page-bootstrap.ts\n       break\n     default: {\n-      obj satisfies never\n+      message satisfies never\n     }\n   }\n }"
        },
        {
            "sha": "87c05871fa5150b53b65b1b15622936e6ca71deb",
            "filename": "packages/next/src/client/dev/hot-reloader/app/web-socket.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fapp%2Fweb-socket.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fapp%2Fweb-socket.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fapp%2Fweb-socket.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -1,7 +1,7 @@\n import { useContext, useEffect } from 'react'\n import { GlobalLayoutRouterContext } from '../../../../shared/lib/app-router-context.shared-runtime'\n import { getSocketUrl } from '../get-socket-url'\n-import type { TurbopackMsgToBrowser } from '../../../../server/dev/hot-reloader-types'\n+import type { TurbopackMessageSentToBrowser } from '../../../../server/dev/hot-reloader-types'\n import { reportInvalidHmrMessage } from '../shared'\n import {\n   performFullReload,\n@@ -37,9 +37,9 @@ export function createWebSocket(\n \n   webSocket.addEventListener('message', (event) => {\n     try {\n-      const obj = JSON.parse(event.data)\n+      const message = JSON.parse(event.data)\n       processMessage(\n-        obj,\n+        message,\n         sendMessage,\n         processTurbopackMessage,\n         staticIndicatorState\n@@ -54,15 +54,15 @@ export function createWebSocket(\n \n export function createProcessTurbopackMessage(\n   sendMessage: (data: string) => void\n-): (msg: TurbopackMsgToBrowser) => void {\n+): (msg: TurbopackMessageSentToBrowser) => void {\n   if (!process.env.TURBOPACK) {\n     return () => {}\n   }\n \n-  let queue: TurbopackMsgToBrowser[] = []\n-  let callback: ((msg: TurbopackMsgToBrowser) => void) | undefined\n+  let queue: TurbopackMessageSentToBrowser[] = []\n+  let callback: ((msg: TurbopackMessageSentToBrowser) => void) | undefined\n \n-  const processTurbopackMessage = (msg: TurbopackMsgToBrowser) => {\n+  const processTurbopackMessage = (msg: TurbopackMessageSentToBrowser) => {\n     if (callback) {\n       callback(msg)\n     } else {\n@@ -75,7 +75,7 @@ export function createProcessTurbopackMessage(\n     '@vercel/turbopack-ecmascript-runtime/browser/dev/hmr-client/hmr-client.ts'\n   ).then(({ connect }) => {\n     connect({\n-      addMessageListener(cb: (msg: TurbopackMsgToBrowser) => void) {\n+      addMessageListener(cb: (msg: TurbopackMessageSentToBrowser) => void) {\n         callback = cb\n \n         // Replay all Turbopack messages before we were able to establish the HMR client."
        },
        {
            "sha": "61cbe1bdd2225315b83c311596a9d481713ea5d3",
            "filename": "packages/next/src/client/dev/hot-reloader/pages/hot-reloader-pages.ts",
            "status": "modified",
            "additions": 66,
            "deletions": 47,
            "changes": 113,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fpages%2Fhot-reloader-pages.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fpages%2Fhot-reloader-pages.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fpages%2Fhot-reloader-pages.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -37,10 +37,14 @@ import { register } from '../../../../next-devtools/userspace/pages/pages-dev-ov\n import stripAnsi from 'next/dist/compiled/strip-ansi'\n import { addMessageListener, sendMessage } from './websocket'\n import formatWebpackMessages from '../../../../shared/lib/format-webpack-messages'\n-import { HMR_ACTIONS_SENT_TO_BROWSER } from '../../../../server/dev/hot-reloader-types'\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from '../../../../server/dev/hot-reloader-types'\n import type {\n-  HMR_ACTION_TYPES,\n-  TurbopackMsgToBrowser,\n+  AddedPageMessage,\n+  DevPagesManifestUpdateMessage,\n+  HmrMessageSentToBrowser,\n+  ReloadPageMessage,\n+  RemovedPageMessage,\n+  TurbopackMessageSentToBrowser,\n } from '../../../../server/dev/hot-reloader-types'\n import {\n   REACT_REFRESH_FULL_RELOAD,\n@@ -66,29 +70,42 @@ declare global {\n   }\n }\n \n+type CustomHmrEventHandler = (\n+  message:\n+    | AddedPageMessage\n+    | RemovedPageMessage\n+    | ReloadPageMessage\n+    | DevPagesManifestUpdateMessage\n+) => void\n+\n window.__nextDevClientId = Math.round(Math.random() * 100 + Date.now())\n \n-let customHmrEventHandler: any\n-let turbopackMessageListeners: ((msg: TurbopackMsgToBrowser) => void)[] = []\n+let customHmrEventHandler: CustomHmrEventHandler | undefined\n+\n+let turbopackMessageListeners: ((\n+  message: TurbopackMessageSentToBrowser\n+) => void)[] = []\n export default function connect() {\n   register()\n \n-  addMessageListener((payload) => {\n+  addMessageListener((message) => {\n     try {\n-      processMessage(payload)\n+      processMessage(message)\n     } catch (err: unknown) {\n-      reportInvalidHmrMessage(payload, err)\n+      reportInvalidHmrMessage(message, err)\n     }\n   })\n \n   return {\n-    subscribeToHmrEvent(handler: any) {\n+    subscribeToHmrEvent(handler: CustomHmrEventHandler) {\n       customHmrEventHandler = handler\n     },\n     onUnrecoverableError() {\n       RuntimeErrorHandler.hadRuntimeError = true\n     },\n-    addTurbopackMessageListener(cb: (msg: TurbopackMsgToBrowser) => void) {\n+    addTurbopackMessageListener(\n+      cb: (msg: TurbopackMessageSentToBrowser) => void\n+    ) {\n       turbopackMessageListeners.push(cb)\n     },\n     sendTurbopackMessage(msg: string) {\n@@ -248,14 +265,14 @@ export function handleStaticIndicator() {\n }\n \n /** Handles messages from the server for the Pages Router. */\n-function processMessage(obj: HMR_ACTION_TYPES) {\n-  switch (obj.action) {\n-    case HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST: {\n-      isrManifest = obj.data\n+function processMessage(message: HmrMessageSentToBrowser) {\n+  switch (message.type) {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.ISR_MANIFEST: {\n+      isrManifest = message.data\n       handleStaticIndicator()\n       break\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.BUILDING: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.BUILDING: {\n       dispatcher.buildingIndicatorShow()\n \n       if (process.env.TURBOPACK) {\n@@ -266,19 +283,21 @@ function processMessage(obj: HMR_ACTION_TYPES) {\n       }\n       break\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.BUILT:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.SYNC: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.BUILT:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.SYNC: {\n       dispatcher.buildingIndicatorHide()\n \n-      if (obj.hash) handleAvailableHash(obj.hash)\n+      if (message.hash) handleAvailableHash(message.hash)\n \n-      const { errors, warnings } = obj\n+      const { errors, warnings } = message\n \n       // Is undefined when it's a 'built' event\n-      if ('versionInfo' in obj) dispatcher.onVersionInfo(obj.versionInfo)\n-      if ('devIndicator' in obj) dispatcher.onDevIndicator(obj.devIndicator)\n-      if ('devToolsConfig' in obj)\n-        dispatcher.onDevToolsConfig(obj.devToolsConfig)\n+      if ('versionInfo' in message)\n+        dispatcher.onVersionInfo(message.versionInfo)\n+      if ('devIndicator' in message)\n+        dispatcher.onDevIndicator(message.devIndicator)\n+      if ('devToolsConfig' in message)\n+        dispatcher.onDevToolsConfig(message.devToolsConfig)\n \n       const hasErrors = Boolean(errors && errors.length)\n       if (hasErrors) {\n@@ -313,39 +332,39 @@ function processMessage(obj: HMR_ACTION_TYPES) {\n       )\n       return handleSuccess()\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES: {\n       turbopackHmr?.onServerComponentChanges()\n       if (hasCompileErrors || RuntimeErrorHandler.hadRuntimeError) {\n         window.location.reload()\n       }\n       return\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ERROR: {\n-      const { errorJSON } = obj\n+    case HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ERROR: {\n+      const { errorJSON } = message\n       if (errorJSON) {\n-        const { message, stack } = JSON.parse(errorJSON)\n-        const error = new Error(message)\n-        error.stack = stack\n+        const errorObject = JSON.parse(errorJSON)\n+        const error = new Error(errorObject.message)\n+        error.stack = errorObject.stack\n         handleErrors([error])\n       }\n       return\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_CONNECTED: {\n+    case HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_CONNECTED: {\n       for (const listener of turbopackMessageListeners) {\n         listener({\n-          type: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_CONNECTED,\n-          data: obj.data,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_CONNECTED,\n+          data: message.data,\n         })\n       }\n       break\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE: {\n-      turbopackHmr!.onTurbopackMessage(obj)\n+    case HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_MESSAGE: {\n+      turbopackHmr!.onTurbopackMessage(message)\n       dispatcher.onBeforeRefresh()\n       for (const listener of turbopackMessageListeners) {\n         listener({\n-          type: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE,\n-          data: obj.data,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_MESSAGE,\n+          data: message.data,\n         })\n       }\n       if (RuntimeErrorHandler.hadRuntimeError) {\n@@ -355,24 +374,24 @@ function processMessage(obj: HMR_ACTION_TYPES) {\n       dispatcher.onRefresh()\n       break\n     }\n-    case HMR_ACTIONS_SENT_TO_BROWSER.ADDED_PAGE:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.REMOVED_PAGE:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.ADDED_PAGE:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.REMOVED_PAGE:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE:\n       if (customHmrEventHandler) {\n-        customHmrEventHandler(obj)\n+        customHmrEventHandler(message)\n       }\n       break\n-    case HMR_ACTIONS_SENT_TO_BROWSER.DEVTOOLS_CONFIG:\n-      dispatcher.onDevToolsConfig(obj.data)\n+    case HMR_MESSAGE_SENT_TO_BROWSER.DEVTOOLS_CONFIG:\n+      dispatcher.onDevToolsConfig(message.data)\n       break\n-    case HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES:\n-    case HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ONLY_CHANGES:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.MIDDLEWARE_CHANGES:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.CLIENT_CHANGES:\n+    case HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ONLY_CHANGES:\n       // These action types are handled in src/client/page-bootstrap.ts\n       break\n     default:\n-      obj satisfies never\n+      message satisfies never\n   }\n }\n "
        },
        {
            "sha": "6e01642fe07eaf1b47246b6941a2377141a9690b",
            "filename": "packages/next/src/client/dev/hot-reloader/pages/websocket.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 13,
            "changes": 25,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fpages%2Fwebsocket.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fpages%2Fwebsocket.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fpages%2Fwebsocket.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -3,19 +3,19 @@ import {\n   logQueue,\n } from '../../../../next-devtools/userspace/app/forward-logs'\n import {\n-  HMR_ACTIONS_SENT_TO_BROWSER,\n-  type HMR_ACTION_TYPES,\n+  HMR_MESSAGE_SENT_TO_BROWSER,\n+  type HmrMessageSentToBrowser,\n } from '../../../../server/dev/hot-reloader-types'\n import { getSocketUrl } from '../get-socket-url'\n \n let source: WebSocket\n \n-type ActionCallback = (action: HMR_ACTION_TYPES) => void\n+type MessageCallback = (message: HmrMessageSentToBrowser) => void\n \n-const eventCallbacks: Array<ActionCallback> = []\n+const messageCallbacks: Array<MessageCallback> = []\n \n-export function addMessageListener(callback: ActionCallback) {\n-  eventCallbacks.push(callback)\n+export function addMessageListener(callback: MessageCallback) {\n+  messageCallbacks.push(callback)\n }\n \n export function sendMessage(data: string) {\n@@ -46,13 +46,12 @@ export function connectHMR(options: { path: string; assetPrefix: string }) {\n         return\n       }\n \n-      // Coerce into HMR_ACTION_TYPES as that is the format.\n-      const msg: HMR_ACTION_TYPES = JSON.parse(event.data)\n+      const message: HmrMessageSentToBrowser = JSON.parse(event.data)\n \n-      if (msg.action === HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_CONNECTED) {\n+      if (message.type === HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_CONNECTED) {\n         if (\n           serverSessionId !== null &&\n-          serverSessionId !== msg.data.sessionId\n+          serverSessionId !== message.data.sessionId\n         ) {\n           // Either the server's session id has changed and it's a new server, or\n           // it's been too long since we disconnected and we should reload the page.\n@@ -64,11 +63,11 @@ export function connectHMR(options: { path: string; assetPrefix: string }) {\n           return\n         }\n \n-        serverSessionId = msg.data.sessionId\n+        serverSessionId = message.data.sessionId\n       }\n \n-      for (const eventCallback of eventCallbacks) {\n-        eventCallback(msg)\n+      for (const messageCallback of messageCallbacks) {\n+        messageCallback(message)\n       }\n     }\n "
        },
        {
            "sha": "b4653cee6b6f25e6bfad46f5614ff14190eb6b43",
            "filename": "packages/next/src/client/dev/hot-reloader/shared.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fshared.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fshared.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fshared.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -1,4 +1,4 @@\n-import type { HMR_ACTION_TYPES } from '../../../server/dev/hot-reloader-types'\n+import type { HmrMessageSentToBrowser } from '../../../server/dev/hot-reloader-types'\n \n export const REACT_REFRESH_FULL_RELOAD =\n   '[Fast Refresh] performing full reload\\n\\n' +\n@@ -12,7 +12,7 @@ export const REACT_REFRESH_FULL_RELOAD_FROM_ERROR =\n   '[Fast Refresh] performing full reload because your application had an unrecoverable error'\n \n export function reportInvalidHmrMessage(\n-  message: HMR_ACTION_TYPES | MessageEvent<unknown>,\n+  message: HmrMessageSentToBrowser | MessageEvent<unknown>,\n   err: unknown\n ) {\n   console.warn("
        },
        {
            "sha": "da0e094bd0927c2a4262b5bae113ebb3db28d6a3",
            "filename": "packages/next/src/client/dev/hot-reloader/turbopack-hot-reloader-common.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fturbopack-hot-reloader-common.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fturbopack-hot-reloader-common.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fdev%2Fhot-reloader%2Fturbopack-hot-reloader-common.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -1,4 +1,4 @@\n-import type { TurbopackMessageAction } from '../../../server/dev/hot-reloader-types'\n+import type { TurbopackMessage } from '../../../server/dev/hot-reloader-types'\n import type { Update as TurbopackUpdate } from '../../../build/swc/types'\n \n declare global {\n@@ -72,7 +72,7 @@ export class TurbopackHmr {\n     this.#lastUpdateMsSinceEpoch = Date.now()\n   }\n \n-  onTurbopackMessage(msg: TurbopackMessageAction) {\n+  onTurbopackMessage(msg: TurbopackMessage) {\n     this.#onUpdate()\n     const updatedModules = extractModulesFromTurbopackMessage(msg.data)\n     for (const module of updatedModules) {\n@@ -98,7 +98,7 @@ export class TurbopackHmr {\n    *   the HMR in the browser console, but the HMR was a no-op.\n    */\n   onBuilt(): HmrUpdate | null {\n-    // Check that we got *any* `TurbopackMessageAction`, even if\n+    // Check that we got *any* `TurbopackMessage`, even if\n     // `updatedModules` is empty (not everything gets recorded there).\n     //\n     // There's also a case where `onBuilt` gets called before `onBuilding`,"
        },
        {
            "sha": "d456485c747ec0bc0c60f65ae8a8de014bdffcc2",
            "filename": "packages/next/src/client/next-dev-turbopack.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fnext-dev-turbopack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fnext-dev-turbopack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fnext-dev-turbopack.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -5,7 +5,7 @@ import initHMR from './dev/hot-middleware-client'\n import { pageBootstrap } from './page-bootstrap'\n //@ts-expect-error requires \"moduleResolution\": \"node16\" in tsconfig.json and not .ts extension\n import { connect } from '@vercel/turbopack-ecmascript-runtime/browser/dev/hmr-client/hmr-client.ts'\n-import type { TurbopackMsgToBrowser } from '../server/dev/hot-reloader-types'\n+import type { TurbopackMessageSentToBrowser } from '../server/dev/hot-reloader-types'\n \n window.next = {\n   version,\n@@ -42,7 +42,7 @@ initialize({\n     }\n \n     connect({\n-      addMessageListener(cb: (msg: TurbopackMsgToBrowser) => void) {\n+      addMessageListener(cb: (message: TurbopackMessageSentToBrowser) => void) {\n         devClient.addTurbopackMessageListener(cb)\n       },\n       sendMessage: devClient.sendTurbopackMessage,"
        },
        {
            "sha": "4616e5b518afd8ca3f68dd263ea5486e7b34ff2f",
            "filename": "packages/next/src/client/page-bootstrap.ts",
            "status": "modified",
            "additions": 24,
            "deletions": 24,
            "changes": 48,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fpage-bootstrap.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fclient%2Fpage-bootstrap.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fclient%2Fpage-bootstrap.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -10,7 +10,7 @@ import {\n   assign,\n   urlQueryToSearchParams,\n } from '../shared/lib/router/utils/querystring'\n-import { HMR_ACTIONS_SENT_TO_BROWSER } from '../server/dev/hot-reloader-types'\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from '../server/dev/hot-reloader-types'\n import { RuntimeErrorHandler } from './dev/runtime-error-handler'\n import { REACT_REFRESH_FULL_RELOAD_FROM_ERROR } from './dev/hot-reloader/shared'\n import { performFullReload } from './dev/hot-reloader/pages/hot-reloader-pages'\n@@ -24,22 +24,22 @@ export function pageBootstrap(assetPrefix: string) {\n \n     let reloading = false\n \n-    addMessageListener((payload) => {\n+    addMessageListener((message) => {\n       if (reloading) return\n \n-      switch (payload.action) {\n-        case HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ERROR: {\n-          const { stack, message } = JSON.parse(payload.errorJSON)\n-          const error = new Error(message)\n-          error.stack = stack\n+      switch (message.type) {\n+        case HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ERROR: {\n+          const errorObject = JSON.parse(message.errorJSON)\n+          const error = new Error(errorObject.message)\n+          error.stack = errorObject.stack\n           throw error\n         }\n-        case HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE: {\n+        case HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE: {\n           reloading = true\n           window.location.reload()\n           break\n         }\n-        case HMR_ACTIONS_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE: {\n+        case HMR_MESSAGE_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE: {\n           fetch(\n             `${assetPrefix}/_next/static/development/_devPagesManifest.json`\n           )\n@@ -52,10 +52,10 @@ export function pageBootstrap(assetPrefix: string) {\n             })\n           break\n         }\n-        case HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES: {\n+        case HMR_MESSAGE_SENT_TO_BROWSER.MIDDLEWARE_CHANGES: {\n           return window.location.reload()\n         }\n-        case HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES: {\n+        case HMR_MESSAGE_SENT_TO_BROWSER.CLIENT_CHANGES: {\n           // This is used in `../server/dev/turbopack-utils.ts`.\n           const isOnErrorPage = window.next.router.pathname === '/_error'\n           // On the error page we want to reload the page when a page was changed\n@@ -68,13 +68,13 @@ export function pageBootstrap(assetPrefix: string) {\n           }\n           break\n         }\n-        case HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ONLY_CHANGES: {\n+        case HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ONLY_CHANGES: {\n           if (RuntimeErrorHandler.hadRuntimeError) {\n             console.warn(REACT_REFRESH_FULL_RELOAD_FROM_ERROR)\n             performFullReload(null)\n           }\n \n-          const { pages } = payload\n+          const { pages } = message\n \n           // Make sure to reload when the dev-overlay is showing for an\n           // API route\n@@ -110,22 +110,22 @@ export function pageBootstrap(assetPrefix: string) {\n           }\n           break\n         }\n-        case HMR_ACTIONS_SENT_TO_BROWSER.ADDED_PAGE:\n-        case HMR_ACTIONS_SENT_TO_BROWSER.REMOVED_PAGE:\n-        case HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES:\n-        case HMR_ACTIONS_SENT_TO_BROWSER.SYNC:\n-        case HMR_ACTIONS_SENT_TO_BROWSER.BUILT:\n-        case HMR_ACTIONS_SENT_TO_BROWSER.BUILDING:\n-        case HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE:\n-        case HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_CONNECTED:\n-        case HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST:\n-        case HMR_ACTIONS_SENT_TO_BROWSER.DEVTOOLS_CONFIG:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.ADDED_PAGE:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.REMOVED_PAGE:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.SYNC:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.BUILT:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.BUILDING:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_MESSAGE:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_CONNECTED:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.ISR_MANIFEST:\n+        case HMR_MESSAGE_SENT_TO_BROWSER.DEVTOOLS_CONFIG:\n           // Most of these action types are handled in\n           // src/client/dev/hot-reloader/pages/hot-reloader-pages.ts and\n           // src/client/dev/hot-reloader/app/hot-reloader-app.tsx\n           break\n         default:\n-          payload satisfies never\n+          message satisfies never\n       }\n     })\n   })"
        },
        {
            "sha": "a25610e514196cf8673f38bef86bb184abe620b4",
            "filename": "packages/next/src/server/dev/hot-middleware.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-middleware.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-middleware.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-middleware.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -26,8 +26,8 @@ import type ws from 'next/dist/compiled/ws'\n import type { DevToolsConfig } from '../../next-devtools/dev-overlay/shared'\n import { isMiddlewareFilename } from '../../build/utils'\n import type { VersionInfo } from './parse-version-info'\n-import type { HMR_ACTION_TYPES } from './hot-reloader-types'\n-import { HMR_ACTIONS_SENT_TO_BROWSER } from './hot-reloader-types'\n+import type { HmrMessageSentToBrowser } from './hot-reloader-types'\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from './hot-reloader-types'\n import { devIndicatorServerState } from './dev-indicator-server-state'\n \n function isMiddlewareStats(stats: webpack.Stats) {\n@@ -89,9 +89,9 @@ class EventStream {\n     })\n   }\n \n-  publish(payload: any) {\n+  publish(message: any) {\n     for (const wsClient of this.clients) {\n-      wsClient.send(JSON.stringify(payload))\n+      wsClient.send(JSON.stringify(message))\n     }\n   }\n }\n@@ -141,7 +141,7 @@ export class WebpackHotMiddleware {\n   onClientInvalid = () => {\n     if (this.closed || this.serverLatestStats?.stats.hasErrors()) return\n     this.publish({\n-      action: HMR_ACTIONS_SENT_TO_BROWSER.BUILDING,\n+      type: HMR_MESSAGE_SENT_TO_BROWSER.BUILDING,\n     })\n   }\n \n@@ -216,7 +216,7 @@ export class WebpackHotMiddleware {\n       }\n \n       this.publish({\n-        action: HMR_ACTIONS_SENT_TO_BROWSER.SYNC,\n+        type: HMR_MESSAGE_SENT_TO_BROWSER.SYNC,\n         hash: stats.hash!,\n         errors: [...(stats.errors || []), ...(middlewareStats.errors || [])],\n         warnings: [\n@@ -243,16 +243,16 @@ export class WebpackHotMiddleware {\n     })\n \n     this.publish({\n-      action: HMR_ACTIONS_SENT_TO_BROWSER.BUILT,\n+      type: HMR_MESSAGE_SENT_TO_BROWSER.BUILT,\n       hash: stats.hash!,\n       warnings: stats.warnings || [],\n       errors: stats.errors || [],\n     })\n   }\n \n-  publish = (payload: HMR_ACTION_TYPES) => {\n+  publish = (message: HmrMessageSentToBrowser) => {\n     if (this.closed) return\n-    this.eventStream.publish(payload)\n+    this.eventStream.publish(message)\n   }\n   close = () => {\n     if (this.closed) return"
        },
        {
            "sha": "e28a6efd40262656e02f98394b57cc55e99e5fdd",
            "filename": "packages/next/src/server/dev/hot-reloader-turbopack.ts",
            "status": "modified",
            "additions": 33,
            "deletions": 33,
            "changes": 66,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-turbopack.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -9,13 +9,13 @@ import type { OutputState } from '../../build/output/store'\n import { store as consoleStore } from '../../build/output/store'\n import type {\n   CompilationError,\n-  HMR_ACTION_TYPES,\n+  HmrMessageSentToBrowser,\n   NextJsHotReloaderInterface,\n-  ReloadPageAction,\n-  SyncAction,\n-  TurbopackConnectedAction,\n+  ReloadPageMessage,\n+  SyncMessage,\n+  TurbopackConnectedMessage,\n } from './hot-reloader-types'\n-import { HMR_ACTIONS_SENT_TO_BROWSER } from './hot-reloader-types'\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from './hot-reloader-types'\n import type {\n   Update as TurbopackUpdate,\n   Endpoint,\n@@ -415,8 +415,8 @@ export async function createHotReloaderTurbopack(\n   const clients = new Set<ws>()\n   const clientStates = new WeakMap<ws, ClientState>()\n \n-  function sendToClient(client: ws, payload: HMR_ACTION_TYPES) {\n-    client.send(JSON.stringify(payload))\n+  function sendToClient(client: ws, message: HmrMessageSentToBrowser) {\n+    client.send(JSON.stringify(message))\n   }\n \n   function sendEnqueuedMessages() {\n@@ -446,14 +446,14 @@ export async function createHotReloaderTurbopack(\n         }\n       }\n \n-      for (const payload of state.hmrPayloads.values()) {\n-        sendToClient(client, payload)\n+      for (const message of state.messages.values()) {\n+        sendToClient(client, message)\n       }\n-      state.hmrPayloads.clear()\n+      state.messages.clear()\n \n       if (state.turbopackUpdates.length > 0) {\n         sendToClient(client, {\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_MESSAGE,\n           data: state.turbopackUpdates,\n         })\n         state.turbopackUpdates.length = 0\n@@ -462,9 +462,9 @@ export async function createHotReloaderTurbopack(\n   }\n   const sendEnqueuedMessagesDebounce = debounce(sendEnqueuedMessages, 2)\n \n-  const sendHmr: SendHmr = (id: string, payload: HMR_ACTION_TYPES) => {\n+  const sendHmr: SendHmr = (id: string, message: HmrMessageSentToBrowser) => {\n     for (const client of clients) {\n-      clientStates.get(client)?.hmrPayloads.set(id, payload)\n+      clientStates.get(client)?.messages.set(id, message)\n     }\n \n     hmrEventHappened = true\n@@ -490,13 +490,13 @@ export async function createHotReloaderTurbopack(\n     key: EntryKey,\n     includeIssues: boolean,\n     endpoint: Endpoint,\n-    makePayload: (\n+    createMessage: (\n       change: TurbopackResult,\n       hash: string\n-    ) => Promise<HMR_ACTION_TYPES> | HMR_ACTION_TYPES | void,\n+    ) => Promise<HmrMessageSentToBrowser> | HmrMessageSentToBrowser | void,\n     onError?: (\n       error: Error\n-    ) => Promise<HMR_ACTION_TYPES> | HMR_ACTION_TYPES | void\n+    ) => Promise<HmrMessageSentToBrowser> | HmrMessageSentToBrowser | void\n   ) {\n     if (changeSubscriptions.has(key)) {\n       return\n@@ -512,9 +512,9 @@ export async function createHotReloaderTurbopack(\n       for await (const change of changed) {\n         processIssues(currentEntryIssues, key, change, false, true)\n         // TODO: Get an actual content hash from Turbopack.\n-        const payload = await makePayload(change, String(++hmrHash))\n-        if (payload) {\n-          sendHmr(key, payload)\n+        const message = await createMessage(change, String(++hmrHash))\n+        if (message) {\n+          sendHmr(key, message)\n         }\n       }\n     } catch (e) {\n@@ -568,11 +568,11 @@ export async function createHotReloaderTurbopack(\n       // to fully reload the page to resolve the issue. We can't use\n       // `hotReloader.send` since that would force every connected client to\n       // reload, only this client is out of date.\n-      const reloadAction: ReloadPageAction = {\n-        action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+      const reloadMessage: ReloadPageMessage = {\n+        type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n         data: `error in HMR event subscription for ${id}: ${e}`,\n       }\n-      sendToClient(client, reloadAction)\n+      sendToClient(client, reloadMessage)\n       client.close()\n       return\n     }\n@@ -671,7 +671,7 @@ export async function createHotReloaderTurbopack(\n       distDir,\n       sendUpdateSignal: (data) => {\n         hotReloader.send({\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.DEVTOOLS_CONFIG,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.DEVTOOLS_CONFIG,\n           data,\n         })\n       },\n@@ -751,7 +751,7 @@ export async function createHotReloaderTurbopack(\n         clients.add(client)\n         clientStates.set(client, {\n           clientIssues,\n-          hmrPayloads: new Map(),\n+          messages: new Map(),\n           turbopackUpdates: [],\n           subscriptions,\n         })\n@@ -859,11 +859,11 @@ export async function createHotReloaderTurbopack(\n           }\n         })\n \n-        const turbopackConnected: TurbopackConnectedAction = {\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_CONNECTED,\n+        const turbopackConnectedMessage: TurbopackConnectedMessage = {\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_CONNECTED,\n           data: { sessionId },\n         }\n-        sendToClient(client, turbopackConnected)\n+        sendToClient(client, turbopackConnectedMessage)\n \n         const errors: CompilationError[] = []\n \n@@ -887,8 +887,8 @@ export async function createHotReloaderTurbopack(\n           const versionInfo = await versionInfoPromise\n           const devToolsConfig = await getDevToolsConfig(distDir)\n \n-          const sync: SyncAction = {\n-            action: HMR_ACTIONS_SENT_TO_BROWSER.SYNC,\n+          const syncMessage: SyncMessage = {\n+            type: HMR_MESSAGE_SENT_TO_BROWSER.SYNC,\n             errors,\n             warnings: [],\n             hash: '',\n@@ -900,7 +900,7 @@ export async function createHotReloaderTurbopack(\n             devToolsConfig,\n           }\n \n-          sendToClient(client, sync)\n+          sendToClient(client, syncMessage)\n         })()\n       })\n     },\n@@ -976,7 +976,7 @@ export async function createHotReloaderTurbopack(\n \n         await clearAllModuleContexts()\n         this.send({\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES,\n           hash: String(++hmrHash),\n         })\n       }\n@@ -1167,7 +1167,7 @@ export async function createHotReloaderTurbopack(\n     for await (const updateMessage of project.updateInfoSubscribe(30)) {\n       switch (updateMessage.updateType) {\n         case 'start': {\n-          hotReloader.send({ action: HMR_ACTIONS_SENT_TO_BROWSER.BUILDING })\n+          hotReloader.send({ type: HMR_MESSAGE_SENT_TO_BROWSER.BUILDING })\n           break\n         }\n         case 'end': {\n@@ -1207,7 +1207,7 @@ export async function createHotReloaderTurbopack(\n             addErrors(clientErrors, state.clientIssues)\n \n             sendToClient(client, {\n-              action: HMR_ACTIONS_SENT_TO_BROWSER.BUILT,\n+              type: HMR_MESSAGE_SENT_TO_BROWSER.BUILT,\n               hash: String(++hmrHash),\n               errors: [...clientErrors.values()],\n               warnings: [],"
        },
        {
            "sha": "84f09e166b94a7d3125eed213148fce356e832ae",
            "filename": "packages/next/src/server/dev/hot-reloader-types.ts",
            "status": "modified",
            "additions": 60,
            "deletions": 55,
            "changes": 115,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-types.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-types.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-types.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -10,7 +10,7 @@ import type { DebugInfo } from '../../next-devtools/shared/types'\n import type { DevIndicatorServerState } from './dev-indicator-server-state'\n import type { DevToolsConfig } from '../../next-devtools/dev-overlay/shared'\n \n-export const enum HMR_ACTIONS_SENT_TO_BROWSER {\n+export const enum HMR_MESSAGE_SENT_TO_BROWSER {\n   ADDED_PAGE = 'addedPage',\n   REMOVED_PAGE = 'removedPage',\n   RELOAD_PAGE = 'reloadPage',\n@@ -30,18 +30,18 @@ export const enum HMR_ACTIONS_SENT_TO_BROWSER {\n   DEVTOOLS_CONFIG = 'devtoolsConfig',\n }\n \n-interface ServerErrorAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ERROR\n+export interface ServerErrorMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ERROR\n   errorJSON: string\n }\n \n-export interface TurbopackMessageAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE\n+export interface TurbopackMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_MESSAGE\n   data: TurbopackUpdate | TurbopackUpdate[]\n }\n \n-interface BuildingAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.BUILDING\n+export interface BuildingMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.BUILDING\n }\n \n export interface CompilationError {\n@@ -51,8 +51,9 @@ export interface CompilationError {\n   moduleTrace?: Array<{ moduleName?: string }>\n   stack?: string\n }\n-export interface SyncAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.SYNC\n+\n+export interface SyncMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.SYNC\n   hash: string\n   errors: ReadonlyArray<CompilationError>\n   warnings: ReadonlyArray<CompilationError>\n@@ -62,93 +63,97 @@ export interface SyncAction {\n   devIndicator: DevIndicatorServerState\n   devToolsConfig?: DevToolsConfig\n }\n-interface BuiltAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.BUILT\n+\n+export interface BuiltMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.BUILT\n   hash: string\n   errors: ReadonlyArray<CompilationError>\n   warnings: ReadonlyArray<CompilationError>\n   updatedModules?: ReadonlyArray<string>\n }\n \n-interface AddedPageAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.ADDED_PAGE\n+export interface AddedPageMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.ADDED_PAGE\n   data: [page: string | null]\n }\n \n-interface RemovedPageAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.REMOVED_PAGE\n+export interface RemovedPageMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.REMOVED_PAGE\n   data: [page: string | null]\n }\n \n-export interface ReloadPageAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE\n+export interface ReloadPageMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE\n   data: string\n }\n \n-interface ServerComponentChangesAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES\n+export interface ServerComponentChangesMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES\n   hash: string\n }\n \n-interface MiddlewareChangesAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES\n+export interface MiddlewareChangesMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.MIDDLEWARE_CHANGES\n }\n \n-interface ClientChangesAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES\n+export interface ClientChangesMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.CLIENT_CHANGES\n }\n \n-interface ServerOnlyChangesAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ONLY_CHANGES\n+export interface ServerOnlyChangesMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ONLY_CHANGES\n   pages: ReadonlyArray<string>\n }\n \n-interface DevPagesManifestUpdateAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE\n+export interface DevPagesManifestUpdateMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE\n   data: [\n     {\n       devPagesManifest: true\n     },\n   ]\n }\n \n-export interface TurbopackConnectedAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_CONNECTED\n+export interface TurbopackConnectedMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_CONNECTED\n   data: { sessionId: number }\n }\n \n-export interface AppIsrManifestAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST\n+export interface AppIsrManifestMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.ISR_MANIFEST\n   data: Record<string, true>\n }\n \n-export interface DevToolsConfigAction {\n-  action: HMR_ACTIONS_SENT_TO_BROWSER.DEVTOOLS_CONFIG\n+export interface DevToolsConfigMessage {\n+  type: HMR_MESSAGE_SENT_TO_BROWSER.DEVTOOLS_CONFIG\n   data: DevToolsConfig\n }\n \n-export type HMR_ACTION_TYPES =\n-  | TurbopackMessageAction\n-  | TurbopackConnectedAction\n-  | BuildingAction\n-  | SyncAction\n-  | BuiltAction\n-  | AddedPageAction\n-  | RemovedPageAction\n-  | ReloadPageAction\n-  | ServerComponentChangesAction\n-  | ClientChangesAction\n-  | MiddlewareChangesAction\n-  | ServerOnlyChangesAction\n-  | DevPagesManifestUpdateAction\n-  | ServerErrorAction\n-  | AppIsrManifestAction\n-  | DevToolsConfigAction\n-\n-export type TurbopackMsgToBrowser =\n-  | { type: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_MESSAGE; data: any }\n+export type HmrMessageSentToBrowser =\n+  | TurbopackMessage\n+  | TurbopackConnectedMessage\n+  | BuildingMessage\n+  | SyncMessage\n+  | BuiltMessage\n+  | AddedPageMessage\n+  | RemovedPageMessage\n+  | ReloadPageMessage\n+  | ServerComponentChangesMessage\n+  | ClientChangesMessage\n+  | MiddlewareChangesMessage\n+  | ServerOnlyChangesMessage\n+  | DevPagesManifestUpdateMessage\n+  | ServerErrorMessage\n+  | AppIsrManifestMessage\n+  | DevToolsConfigMessage\n+\n+export type TurbopackMessageSentToBrowser =\n+  | {\n+      type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_MESSAGE\n+      data: any\n+    }\n   | {\n-      type: HMR_ACTIONS_SENT_TO_BROWSER.TURBOPACK_CONNECTED\n+      type: HMR_MESSAGE_SENT_TO_BROWSER.TURBOPACK_CONNECTED\n       data: { sessionId: number }\n     }\n \n@@ -166,7 +171,7 @@ export interface NextJsHotReloaderInterface {\n   setHmrServerError(error: Error | null): void\n   clearHmrServerError(): void\n   start(): Promise<void>\n-  send(action: HMR_ACTION_TYPES): void\n+  send(message: HmrMessageSentToBrowser): void\n   getCompilationErrors(page: string): Promise<any[]>\n   onHMR(\n     req: IncomingMessage,"
        },
        {
            "sha": "726fa84d023fba94aaa67f981f32666afd8c863c",
            "filename": "packages/next/src/server/dev/hot-reloader-webpack.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 12,
            "changes": 24,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-webpack.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-webpack.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fhot-reloader-webpack.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -76,10 +76,10 @@ import {\n } from '../../lib/is-internal-component'\n import { RouteKind } from '../route-kind'\n import {\n-  HMR_ACTIONS_SENT_TO_BROWSER,\n+  HMR_MESSAGE_SENT_TO_BROWSER,\n   type NextJsHotReloaderInterface,\n } from './hot-reloader-types'\n-import type { HMR_ACTION_TYPES } from './hot-reloader-types'\n+import type { HmrMessageSentToBrowser } from './hot-reloader-types'\n import type { WebpackError } from 'webpack'\n import { PAGE_TYPES } from '../../lib/page-types'\n import { FAST_REFRESH_RUNTIME_RELOAD } from './messages'\n@@ -416,15 +416,15 @@ export default class HotReloaderWebpack implements NextJsHotReloaderInterface {\n     if (this.hmrServerError) {\n       this.setHmrServerError(null)\n       this.send({\n-        action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+        type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n         data: 'clear hmr server error',\n       })\n     }\n   }\n \n   protected async refreshServerComponents(hash: string): Promise<void> {\n     this.send({\n-      action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES,\n+      type: HMR_MESSAGE_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES,\n       hash,\n       // TODO: granular reloading of changes\n       // entrypoints: serverComponentChanges,\n@@ -1435,7 +1435,7 @@ export default class HotReloaderWebpack implements NextJsHotReloaderInterface {\n \n         // Notify reload to reload the page, as _document.js was changed (different hash)\n         this.send({\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n           data: '_document has changed',\n         })\n       }\n@@ -1466,13 +1466,13 @@ export default class HotReloaderWebpack implements NextJsHotReloaderInterface {\n \n       if (middlewareChanges.length > 0) {\n         this.send({\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n         })\n       }\n \n       if (pageChanges.length > 0) {\n         this.send({\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ONLY_CHANGES,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ONLY_CHANGES,\n           pages: serverOnlyChanges.map((pg) =>\n             denormalizePagePath(pg.slice('pages'.length))\n           ),\n@@ -1525,7 +1525,7 @@ export default class HotReloaderWebpack implements NextJsHotReloaderInterface {\n             for (const addedPage of addedPages) {\n               const page = getRouteFromEntrypoint(addedPage)\n               this.send({\n-                action: HMR_ACTIONS_SENT_TO_BROWSER.ADDED_PAGE,\n+                type: HMR_MESSAGE_SENT_TO_BROWSER.ADDED_PAGE,\n                 data: [page],\n               })\n             }\n@@ -1535,7 +1535,7 @@ export default class HotReloaderWebpack implements NextJsHotReloaderInterface {\n             for (const removedPage of removedPages) {\n               const page = getRouteFromEntrypoint(removedPage)\n               this.send({\n-                action: HMR_ACTIONS_SENT_TO_BROWSER.REMOVED_PAGE,\n+                type: HMR_MESSAGE_SENT_TO_BROWSER.REMOVED_PAGE,\n                 data: [page],\n               })\n             }\n@@ -1613,7 +1613,7 @@ export default class HotReloaderWebpack implements NextJsHotReloaderInterface {\n           this.webpackHotMiddleware?.updateDevToolsConfig(data)\n \n           this.send({\n-            action: HMR_ACTIONS_SENT_TO_BROWSER.DEVTOOLS_CONFIG,\n+            type: HMR_MESSAGE_SENT_TO_BROWSER.DEVTOOLS_CONFIG,\n             data,\n           })\n         },\n@@ -1659,8 +1659,8 @@ export default class HotReloaderWebpack implements NextJsHotReloaderInterface {\n     }\n   }\n \n-  public send(action: HMR_ACTION_TYPES): void {\n-    this.webpackHotMiddleware!.publish(action)\n+  public send(message: HmrMessageSentToBrowser): void {\n+    this.webpackHotMiddleware!.publish(message)\n   }\n \n   public async ensurePage({"
        },
        {
            "sha": "7056e6f095f77b1e24d6fce20805e36197aceab6",
            "filename": "packages/next/src/server/dev/on-demand-entry-handler.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fon-demand-entry-handler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fon-demand-entry-handler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fon-demand-entry-handler.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -38,7 +38,7 @@ import {\n   UNDERSCORE_NOT_FOUND_ROUTE_ENTRY,\n } from '../../shared/lib/constants'\n import { PAGE_SEGMENT_KEY } from '../../shared/lib/segment'\n-import { HMR_ACTIONS_SENT_TO_BROWSER } from './hot-reloader-types'\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from './hot-reloader-types'\n import { isAppPageRouteDefinition } from '../route-definitions/app-page-route-definition'\n import { scheduleOnNextTick } from '../../lib/scheduler'\n import { Batcher } from '../../lib/batcher'\n@@ -984,7 +984,7 @@ export function onDemandEntryHandler({\n           // New error occurred: buffered error is flushed and new error occurred\n           if (!bufferedHmrServerError && error) {\n             hotReloader.send({\n-              action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ERROR,\n+              type: HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ERROR,\n               errorJSON: stringifyError(error),\n             })\n             bufferedHmrServerError = null"
        },
        {
            "sha": "e367994aef983b8a248ac667accbac1aa1f0e297",
            "filename": "packages/next/src/server/dev/turbopack-utils.ts",
            "status": "modified",
            "additions": 27,
            "deletions": 25,
            "changes": 52,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fturbopack-utils.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fturbopack-utils.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Fdev%2Fturbopack-utils.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -11,8 +11,8 @@ import type {\n   WrittenEndpoint,\n } from '../../build/swc/types'\n import {\n-  type HMR_ACTION_TYPES,\n-  HMR_ACTIONS_SENT_TO_BROWSER,\n+  type HmrMessageSentToBrowser,\n+  HMR_MESSAGE_SENT_TO_BROWSER,\n } from './hot-reloader-types'\n import * as Log from '../../build/output/log'\n import type { PropagateToWorkersField } from '../lib/router-utils/types'\n@@ -106,16 +106,18 @@ export type StartChangeSubscription = (\n   key: EntryKey,\n   includeIssues: boolean,\n   endpoint: Endpoint,\n-  makePayload: (\n+  createMessage: (\n     change: TurbopackResult,\n     hash: string\n-  ) => Promise<HMR_ACTION_TYPES> | HMR_ACTION_TYPES | void,\n-  onError?: (e: Error) => Promise<HMR_ACTION_TYPES> | HMR_ACTION_TYPES | void\n+  ) => Promise<HmrMessageSentToBrowser> | HmrMessageSentToBrowser | void,\n+  onError?: (\n+    e: Error\n+  ) => Promise<HmrMessageSentToBrowser> | HmrMessageSentToBrowser | void\n ) => Promise<void>\n \n export type StopChangeSubscription = (key: EntryKey) => Promise<void>\n \n-export type SendHmr = (id: string, payload: HMR_ACTION_TYPES) => void\n+export type SendHmr = (id: string, message: HmrMessageSentToBrowser) => void\n \n export type StartBuilding = (\n   id: string,\n@@ -127,7 +129,7 @@ export type ReadyIds = Set<string>\n \n export type ClientState = {\n   clientIssues: EntryIssuesMap\n-  hmrPayloads: Map<string, HMR_ACTION_TYPES>\n+  messages: Map<string, HmrMessageSentToBrowser>\n   turbopackUpdates: TurbopackUpdate[]\n   subscriptions: Map<string, AsyncIterator<any>>\n }\n@@ -266,13 +268,13 @@ export async function handleRouteType({\n               // Report the next compilation again\n               readyIds?.delete(pathname)\n               return {\n-                action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ONLY_CHANGES,\n+                type: HMR_MESSAGE_SENT_TO_BROWSER.SERVER_ONLY_CHANGES,\n                 pages: [page],\n               }\n             },\n             (e) => {\n               return {\n-                action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+                type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n                 data: `error in ${page} data subscription: ${e}`,\n               }\n             }\n@@ -283,12 +285,12 @@ export async function handleRouteType({\n             route.htmlEndpoint,\n             () => {\n               return {\n-                action: HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES,\n+                type: HMR_MESSAGE_SENT_TO_BROWSER.CLIENT_CHANGES,\n               }\n             },\n             (e) => {\n               return {\n-                action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+                type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n                 data: `error in ${page} html subscription: ${e}`,\n               }\n             }\n@@ -300,13 +302,13 @@ export async function handleRouteType({\n               entrypoints.global.document,\n               () => {\n                 return {\n-                  action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+                  type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n                   data: '_document has changed (page route)',\n                 }\n               },\n               (e) => {\n                 return {\n-                  action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+                  type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n                   data: `error in _document subscription (page route): ${e}`,\n                 }\n               }\n@@ -364,13 +366,13 @@ export async function handleRouteType({\n             // Report the next compilation again\n             readyIds?.delete(pathname)\n             return {\n-              action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES,\n+              type: HMR_MESSAGE_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES,\n               hash,\n             }\n           },\n           (e) => {\n             return {\n-              action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+              type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n               data: `error in ${page} app-page subscription: ${e}`,\n             }\n           }\n@@ -650,12 +652,12 @@ export async function handleEntrypoints({\n     await dev?.hooks.unsubscribeFromChanges(key)\n     currentEntryIssues.delete(key)\n     dev.hooks.sendHmr('middleware', {\n-      action: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n+      type: HMR_MESSAGE_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n     })\n   } else if (!currentEntrypoints.global.middleware && middleware) {\n     // Went from no middleware to middleware\n     dev.hooks.sendHmr('middleware', {\n-      action: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n+      type: HMR_MESSAGE_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n     })\n   }\n \n@@ -764,12 +766,12 @@ export async function handleEntrypoints({\n \n           finishBuilding?.()\n           return {\n-            action: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n+            type: HMR_MESSAGE_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n           }\n         },\n         () => {\n           return {\n-            action: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n+            type: HMR_MESSAGE_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,\n           }\n         }\n       )\n@@ -882,12 +884,12 @@ export async function handlePagesErrorRoute({\n         // There's a special case for this in `../client/page-bootstrap.ts`.\n         // https://github.com/vercel/next.js/blob/08d7a7e5189a835f5dcb82af026174e587575c0e/packages/next/src/client/page-bootstrap.ts#L69-L71\n         return {\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.CLIENT_CHANGES,\n         }\n       },\n       () => {\n         return {\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n           data: '_app has changed (error route)',\n         }\n       }\n@@ -909,13 +911,13 @@ export async function handlePagesErrorRoute({\n       entrypoints.global.document,\n       () => {\n         return {\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n           data: '_document has changed (error route)',\n         }\n       },\n       (e) => {\n         return {\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n           data: `error in _document subscription (error route): ${e}`,\n         }\n       }\n@@ -937,12 +939,12 @@ export async function handlePagesErrorRoute({\n         // There's a special case for this in `../client/page-bootstrap.ts`.\n         // https://github.com/vercel/next.js/blob/08d7a7e5189a835f5dcb82af026174e587575c0e/packages/next/src/client/page-bootstrap.ts#L69-L71\n         return {\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.CLIENT_CHANGES,\n         }\n       },\n       (e) => {\n         return {\n-          action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,\n+          type: HMR_MESSAGE_SENT_TO_BROWSER.RELOAD_PAGE,\n           data: `error in _error subscription: ${e}`,\n         }\n       }"
        },
        {
            "sha": "c6568add01f7f78d24c92b9b16d5a5160f973d97",
            "filename": "packages/next/src/server/lib/dev-bundler-service.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fdev-bundler-service.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fdev-bundler-service.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Fdev-bundler-service.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -4,7 +4,7 @@ import type { WorkerRequestHandler } from './types'\n \n import { LRUCache } from './lru-cache'\n import { createRequestResponseMocks } from './mock-request'\n-import { HMR_ACTIONS_SENT_TO_BROWSER } from '../dev/hot-reloader-types'\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from '../dev/hot-reloader-types'\n \n /**\n  * The DevBundlerService provides an interface to perform tasks with the\n@@ -101,7 +101,7 @@ export class DevBundlerService {\n       this.appIsrManifestInner.set(key, value)\n     }\n     this.bundler?.hotReloader?.send({\n-      action: HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST,\n+      type: HMR_MESSAGE_SENT_TO_BROWSER.ISR_MANIFEST,\n       data: this.appIsrManifest,\n     })\n   }"
        },
        {
            "sha": "3f4d17e372be51c922816b80a5c1a47dd54848f0",
            "filename": "packages/next/src/server/lib/router-server.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-server.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-server.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-server.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -41,8 +41,8 @@ import { getHostname } from '../../shared/lib/get-hostname'\n import { detectDomainLocale } from '../../shared/lib/i18n/detect-domain-locale'\n import { MockedResponse } from './mock-request'\n import {\n-  HMR_ACTIONS_SENT_TO_BROWSER,\n-  type AppIsrManifestAction,\n+  HMR_MESSAGE_SENT_TO_BROWSER,\n+  type AppIsrManifestMessage,\n } from '../dev/hot-reloader-types'\n import { normalizedAssetPrefix } from '../../shared/lib/normalized-asset-prefix'\n import { NEXT_PATCH_SYMBOL } from './patch-fetch'\n@@ -801,9 +801,9 @@ export async function initialize(opts: {\n             (client) => {\n               client.send(\n                 JSON.stringify({\n-                  action: HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST,\n+                  type: HMR_MESSAGE_SENT_TO_BROWSER.ISR_MANIFEST,\n                   data: devBundlerService?.appIsrManifest || {},\n-                } satisfies AppIsrManifestAction)\n+                } satisfies AppIsrManifestMessage)\n               )\n             }\n           )"
        },
        {
            "sha": "309106765edfbeb348227d824d3bdce2c52365b8",
            "filename": "packages/next/src/server/lib/router-utils/setup-dev-bundler.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/packages%2Fnext%2Fsrc%2Fserver%2Flib%2Frouter-utils%2Fsetup-dev-bundler.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -67,7 +67,7 @@ import {\n } from '../../../build/utils'\n import { devPageFiles } from '../../../build/webpack/plugins/next-types-plugin/shared'\n import type { LazyRenderServerInstance } from '../router-server'\n-import { HMR_ACTIONS_SENT_TO_BROWSER } from '../../dev/hot-reloader-types'\n+import { HMR_MESSAGE_SENT_TO_BROWSER } from '../../dev/hot-reloader-types'\n import { PAGE_TYPES } from '../../../lib/page-types'\n import { createHotReloaderTurbopack } from '../../dev/hot-reloader-turbopack'\n import { generateEncryptionKeyBase64 } from '../../app-render/encryption-utils-server'\n@@ -1014,7 +1014,7 @@ async function startWatcher(\n \n           // emit the change so clients fetch the update\n           hotReloader.send({\n-            action: HMR_ACTIONS_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE,\n+            type: HMR_MESSAGE_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE,\n             data: [\n               {\n                 devPagesManifest: true,\n@@ -1024,14 +1024,14 @@ async function startWatcher(\n \n           addedRoutes.forEach((route) => {\n             hotReloader.send({\n-              action: HMR_ACTIONS_SENT_TO_BROWSER.ADDED_PAGE,\n+              type: HMR_MESSAGE_SENT_TO_BROWSER.ADDED_PAGE,\n               data: [route],\n             })\n           })\n \n           removedRoutes.forEach((route) => {\n             hotReloader.send({\n-              action: HMR_ACTIONS_SENT_TO_BROWSER.REMOVED_PAGE,\n+              type: HMR_MESSAGE_SENT_TO_BROWSER.REMOVED_PAGE,\n               data: [route],\n             })\n           })"
        },
        {
            "sha": "7c3a27c1cb5e2a92547947c283a6b1ef78e43efd",
            "filename": "turbopack/crates/turbopack-cli/js/src/entry/websocket.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/turbopack%2Fcrates%2Fturbopack-cli%2Fjs%2Fsrc%2Fentry%2Fwebsocket.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/turbopack%2Fcrates%2Fturbopack-cli%2Fjs%2Fsrc%2Fentry%2Fwebsocket.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-cli%2Fjs%2Fsrc%2Fentry%2Fwebsocket.ts?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -3,7 +3,7 @@\n import type { WebSocketMessage } from '@vercel/turbopack-ecmascript-runtime/browser/dev/hmr-client/hmr-client'\n \n let source: WebSocket\n-const eventCallbacks: ((msg: WebSocketMessage) => void)[] = []\n+const messageCallbacks: ((message: WebSocketMessage) => void)[] = []\n \n // TODO: add timeout again\n // let lastActivity = Date.now()\n@@ -19,8 +19,8 @@ function getSocketProtocol(assetPrefix: string): string {\n   return protocol === 'http:' ? 'ws' : 'wss'\n }\n \n-export function addMessageListener(cb: (msg: WebSocketMessage) => void) {\n-  eventCallbacks.push(cb)\n+export function addMessageListener(cb: (message: WebSocketMessage) => void) {\n+  messageCallbacks.push(cb)\n }\n \n export function sendMessage(data: any) {\n@@ -46,7 +46,7 @@ export function connectHMR(options: HMROptions) {\n \n     function handleOnline() {\n       const connected = { type: 'turbopack-connected' as const }\n-      eventCallbacks.forEach((cb) => {\n+      messageCallbacks.forEach((cb) => {\n         cb(connected)\n       })\n \n@@ -61,7 +61,7 @@ export function connectHMR(options: HMROptions) {\n         type: 'turbopack-message' as const,\n         data: JSON.parse(event.data),\n       }\n-      eventCallbacks.forEach((cb) => {\n+      messageCallbacks.forEach((cb) => {\n         cb(message)\n       })\n     }"
        },
        {
            "sha": "d1bcee8c5c4be1d1ac96420947809c27ed841d71",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/tree-shaker/analyzer/failed-1/input.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Ftree-shaker%2Fanalyzer%2Ffailed-1%2Finput.js",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Ftree-shaker%2Fanalyzer%2Ffailed-1%2Finput.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Ftree-shaker%2Fanalyzer%2Ffailed-1%2Finput.js?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -1,5 +1,5 @@\n let source;\n-const eventCallbacks = [];\n+const messageCallbacks = [];\n function getSocketProtocol(assetPrefix) {\n     let protocol = location.protocol;\n     try {\n@@ -8,7 +8,7 @@ function getSocketProtocol(assetPrefix) {\n     return protocol === \"http:\" ? \"ws\" : \"wss\";\n }\n export function addMessageListener(cb) {\n-    eventCallbacks.push(cb);\n+    messageCallbacks.push(cb);\n }\n export function sendMessage(data) {\n     if (!source || source.readyState !== source.OPEN) return;\n@@ -23,7 +23,7 @@ export function connectHMR(options) {\n             const connected = {\n                 type: \"turbopack-connected\"\n             };\n-            eventCallbacks.forEach((cb)=>{\n+            messageCallbacks.forEach((cb)=>{\n                 cb(connected);\n             });\n             if (options.log) console.log(\"[HMR] connected\");\n@@ -33,7 +33,7 @@ export function connectHMR(options) {\n                 type: \"turbopack-message\",\n                 data: JSON.parse(event.data)\n             };\n-            eventCallbacks.forEach((cb)=>{\n+            messageCallbacks.forEach((cb)=>{\n                 cb(message);\n             });\n         }"
        },
        {
            "sha": "e336cad6ae82347fcba051790b85c94fd32aa45a",
            "filename": "turbopack/crates/turbopack-ecmascript/tests/tree-shaker/analyzer/failed-1/output.md",
            "status": "modified",
            "additions": 24,
            "deletions": 24,
            "changes": 48,
            "blob_url": "https://github.com/vercel/next.js/blob/2c487e1c7e33cc3b075734b00c3d8721e355e173/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Ftree-shaker%2Fanalyzer%2Ffailed-1%2Foutput.md",
            "raw_url": "https://github.com/vercel/next.js/raw/2c487e1c7e33cc3b075734b00c3d8721e355e173/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Ftree-shaker%2Fanalyzer%2Ffailed-1%2Foutput.md",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript%2Ftests%2Ftree-shaker%2Fanalyzer%2Ffailed-1%2Foutput.md?ref=2c487e1c7e33cc3b075734b00c3d8721e355e173",
            "patch": "@@ -15,12 +15,12 @@ let source;\n ## Item 2: Stmt 1, `VarDeclarator(0)`\n \n ```js\n-const eventCallbacks = [];\n+const messageCallbacks = [];\n \n ```\n \n-- Declares: `eventCallbacks`\n-- Write: `eventCallbacks`\n+- Declares: `messageCallbacks`\n+- Write: `messageCallbacks`\n \n ## Item 3: Stmt 2, `Normal`\n \n@@ -43,16 +43,16 @@ function getSocketProtocol(assetPrefix) {\n \n ```js\n export function addMessageListener(cb) {\n-    eventCallbacks.push(cb);\n+    messageCallbacks.push(cb);\n }\n \n ```\n \n - Hoisted\n - Declares: `addMessageListener`\n-- Reads (eventual): `eventCallbacks`\n+- Reads (eventual): `messageCallbacks`\n - Write: `addMessageListener`\n-- Write (eventual): `eventCallbacks`\n+- Write (eventual): `messageCallbacks`\n \n ## Item 5: Stmt 4, `Normal`\n \n@@ -82,7 +82,7 @@ export function connectHMR(options) {\n             const connected = {\n                 type: \"turbopack-connected\"\n             };\n-            eventCallbacks.forEach((cb)=>{\n+            messageCallbacks.forEach((cb)=>{\n                 cb(connected);\n             });\n             if (options.log) console.log(\"[HMR] connected\");\n@@ -92,7 +92,7 @@ export function connectHMR(options) {\n                 type: \"turbopack-message\",\n                 data: JSON.parse(event.data)\n             };\n-            eventCallbacks.forEach((cb)=>{\n+            messageCallbacks.forEach((cb)=>{\n                 cb(message);\n             });\n         }\n@@ -119,9 +119,9 @@ export function connectHMR(options) {\n \n - Hoisted\n - Declares: `connectHMR`\n-- Reads (eventual): `source`, `eventCallbacks`, `getSocketProtocol`\n+- Reads (eventual): `source`, `messageCallbacks`, `getSocketProtocol`\n - Write: `connectHMR`\n-- Write (eventual): `source`, `eventCallbacks`\n+- Write (eventual): `source`, `messageCallbacks`\n \n # Phase 1\n ```mermaid\n@@ -249,15 +249,15 @@ export { source as a } from \"__TURBOPACK_VAR__\" assert {\n ```\n ## Part 1\n ```js\n-const eventCallbacks = [];\n-export { eventCallbacks as b } from \"__TURBOPACK_VAR__\" assert {\n+const messageCallbacks = [];\n+export { messageCallbacks as b } from \"__TURBOPACK_VAR__\" assert {\n     __turbopack_var__: true\n };\n \n ```\n ## Part 2\n ```js\n-import { b as eventCallbacks } from \"__TURBOPACK_PART__\" assert {\n+import { b as messageCallbacks } from \"__TURBOPACK_PART__\" assert {\n     __turbopack_part__: -1\n };\n import { a as source } from \"__TURBOPACK_PART__\" assert {\n@@ -279,7 +279,7 @@ function connectHMR(options) {\n             const connected = {\n                 type: \"turbopack-connected\"\n             };\n-            eventCallbacks.forEach((cb)=>{\n+            messageCallbacks.forEach((cb)=>{\n                 cb(connected);\n             });\n             if (options.log) console.log(\"[HMR] connected\");\n@@ -289,7 +289,7 @@ function connectHMR(options) {\n                 type: \"turbopack-message\",\n                 data: JSON.parse(event.data)\n             };\n-            eventCallbacks.forEach((cb)=>{\n+            messageCallbacks.forEach((cb)=>{\n                 cb(message);\n             });\n         }\n@@ -322,11 +322,11 @@ export { connectHMR as d } from \"__TURBOPACK_VAR__\" assert {\n ```\n ## Part 3\n ```js\n-import { b as eventCallbacks } from \"__TURBOPACK_PART__\" assert {\n+import { b as messageCallbacks } from \"__TURBOPACK_PART__\" assert {\n     __turbopack_part__: -1\n };\n function addMessageListener(cb) {\n-    eventCallbacks.push(cb);\n+    messageCallbacks.push(cb);\n }\n export { addMessageListener };\n export { addMessageListener as e } from \"__TURBOPACK_VAR__\" assert {\n@@ -402,15 +402,15 @@ export { source as a } from \"__TURBOPACK_VAR__\" assert {\n ```\n ## Part 1\n ```js\n-const eventCallbacks = [];\n-export { eventCallbacks as b } from \"__TURBOPACK_VAR__\" assert {\n+const messageCallbacks = [];\n+export { messageCallbacks as b } from \"__TURBOPACK_VAR__\" assert {\n     __turbopack_var__: true\n };\n \n ```\n ## Part 2\n ```js\n-import { b as eventCallbacks } from \"__TURBOPACK_PART__\" assert {\n+import { b as messageCallbacks } from \"__TURBOPACK_PART__\" assert {\n     __turbopack_part__: -1\n };\n import { a as source } from \"__TURBOPACK_PART__\" assert {\n@@ -432,7 +432,7 @@ function connectHMR(options) {\n             const connected = {\n                 type: \"turbopack-connected\"\n             };\n-            eventCallbacks.forEach((cb)=>{\n+            messageCallbacks.forEach((cb)=>{\n                 cb(connected);\n             });\n             if (options.log) console.log(\"[HMR] connected\");\n@@ -442,7 +442,7 @@ function connectHMR(options) {\n                 type: \"turbopack-message\",\n                 data: JSON.parse(event.data)\n             };\n-            eventCallbacks.forEach((cb)=>{\n+            messageCallbacks.forEach((cb)=>{\n                 cb(message);\n             });\n         }\n@@ -475,11 +475,11 @@ export { connectHMR as d } from \"__TURBOPACK_VAR__\" assert {\n ```\n ## Part 3\n ```js\n-import { b as eventCallbacks } from \"__TURBOPACK_PART__\" assert {\n+import { b as messageCallbacks } from \"__TURBOPACK_PART__\" assert {\n     __turbopack_part__: -1\n };\n function addMessageListener(cb) {\n-    eventCallbacks.push(cb);\n+    messageCallbacks.push(cb);\n }\n export { addMessageListener };\n export { addMessageListener as e } from \"__TURBOPACK_VAR__\" assert {"
        }
    ],
    "stats": {
        "total": 715,
        "additions": 370,
        "deletions": 345
    }
}