{
    "author": "sokra",
    "message": "Turbopack: persist when stopping (after build) (#83014)\n\n### What?\n\nFixes persistent caching with next build.\n\nNeed to investigate how this regression passes the test cases...",
    "sha": "4914f32baeb8c6f991a2baf1dcd59bf5957e0e2e",
    "files": [
        {
            "sha": "ddcf819724ac399317987f95153962abb1c8fd24",
            "filename": "turbopack/crates/turbo-tasks-backend/src/backend/mod.rs",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/vercel/next.js/blob/4914f32baeb8c6f991a2baf1dcd59bf5957e0e2e/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Fmod.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4914f32baeb8c6f991a2baf1dcd59bf5957e0e2e/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Fmod.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Fmod.rs?ref=4914f32baeb8c6f991a2baf1dcd59bf5957e0e2e",
            "patch": "@@ -1231,6 +1231,9 @@ impl<B: BackingStorage> TurboTasksBackendInner<B> {\n             self.is_idle.store(false, Ordering::Release);\n             self.verify_aggregation_graph(turbo_tasks, false);\n         }\n+        if self.should_persist() {\n+            self.snapshot();\n+        }\n         self.task_cache.drop_contents();\n         drop_contents(&self.transient_tasks);\n         self.storage.drop_contents();"
        }
    ],
    "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
    }
}