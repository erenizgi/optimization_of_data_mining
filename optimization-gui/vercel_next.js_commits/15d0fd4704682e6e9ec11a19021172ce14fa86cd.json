{
    "author": "sokra",
    "message": "Turbopack: use batch add in connect children (#85623)\n\n### What?\n\nuse batch add in connect children",
    "sha": "15d0fd4704682e6e9ec11a19021172ce14fa86cd",
    "files": [
        {
            "sha": "36ab4b042ecfa8e4bbcc2657f0251583628cc73b",
            "filename": "turbopack/crates/turbo-tasks-backend/src/backend/operation/connect_children.rs",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/vercel/next.js/blob/15d0fd4704682e6e9ec11a19021172ce14fa86cd/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Fconnect_children.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/15d0fd4704682e6e9ec11a19021172ce14fa86cd/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Fconnect_children.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbo-tasks-backend%2Fsrc%2Fbackend%2Foperation%2Fconnect_children.rs?ref=15d0fd4704682e6e9ec11a19021172ce14fa86cd",
            "patch": "@@ -12,7 +12,7 @@ use crate::{\n         Operation, TaskGuard, aggregation_update::InnerOfUppersHasNewFollowersJob,\n         get_aggregation_number, get_uppers, is_aggregating_node,\n     },\n-    data::CachedDataItem,\n+    data::{CachedDataItem, CachedDataItemType},\n };\n \n pub fn connect_children(\n@@ -27,12 +27,13 @@ pub fn connect_children(\n \n     let parent_aggregation = get_aggregation_number(&parent_task);\n \n-    for &new_child in new_children.iter() {\n-        parent_task.add_new(CachedDataItem::Child {\n+    parent_task.extend_new(\n+        CachedDataItemType::Child,\n+        new_children.iter().map(|&new_child| CachedDataItem::Child {\n             task: new_child,\n             value: (),\n-        });\n-    }\n+        }),\n+    );\n \n     let new_follower_ids: SmallVec<_> = new_children.into_iter().collect();\n "
        }
    ],
    "stats": {
        "total": 11,
        "additions": 6,
        "deletions": 5
    }
}