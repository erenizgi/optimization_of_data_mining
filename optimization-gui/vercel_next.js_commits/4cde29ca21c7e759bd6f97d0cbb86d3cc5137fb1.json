{
    "author": "kdy1",
    "message": "fix(react-compiler): Fix detection of interest (#78874)\n\n### What?\n\nMark function components declared as a variable interesting\n\n### Why?\n\nBecause those are also React Components\n\n### How?\n\n - Closes SWC-646\n-  Closes https://github.com/vercel/next.js/issues/78867",
    "sha": "4cde29ca21c7e759bd6f97d0cbb86d3cc5137fb1",
    "files": [
        {
            "sha": "984e5a771c379b519cb30f3d145340173a9d6f3b",
            "filename": "crates/next-custom-transforms/src/react_compiler.rs",
            "status": "modified",
            "additions": 16,
            "deletions": 1,
            "changes": 17,
            "blob_url": "https://github.com/vercel/next.js/blob/4cde29ca21c7e759bd6f97d0cbb86d3cc5137fb1/crates%2Fnext-custom-transforms%2Fsrc%2Freact_compiler.rs",
            "raw_url": "https://github.com/vercel/next.js/raw/4cde29ca21c7e759bd6f97d0cbb86d3cc5137fb1/crates%2Fnext-custom-transforms%2Fsrc%2Freact_compiler.rs",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/crates%2Fnext-custom-transforms%2Fsrc%2Freact_compiler.rs?ref=4cde29ca21c7e759bd6f97d0cbb86d3cc5137fb1",
            "patch": "@@ -1,5 +1,5 @@\n use swc_core::ecma::{\n-    ast::{Callee, Expr, FnDecl, FnExpr, Program, ReturnStmt},\n+    ast::{Callee, Expr, FnDecl, FnExpr, Pat, Program, ReturnStmt, VarDeclarator},\n     visit::{Visit, VisitWith},\n };\n \n@@ -68,4 +68,19 @@ impl Visit for Finder {\n \n         node.visit_children_with(self);\n     }\n+\n+    fn visit_var_declarator(&mut self, node: &VarDeclarator) {\n+        let old = self.is_interested;\n+\n+        if let Pat::Ident(ident) = &node.name {\n+            self.is_interested = ident.sym.starts_with(\"use\")\n+                || ident.sym.starts_with(|c: char| c.is_ascii_uppercase());\n+        } else {\n+            self.is_interested = false;\n+        }\n+\n+        node.visit_children_with(self);\n+\n+        self.is_interested = old;\n+    }\n }"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 16,
        "deletions": 1
    }
}