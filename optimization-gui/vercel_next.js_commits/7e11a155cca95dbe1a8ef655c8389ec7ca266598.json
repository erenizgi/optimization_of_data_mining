{
    "author": "mischnic",
    "message": "Turbopack: improve missing factory message (#84881)\n\nDon't mention HMR for prod builds",
    "sha": "7e11a155cca95dbe1a8ef655c8389ec7ca266598",
    "files": [
        {
            "sha": "7c6b2a6d2ca53807337d0d7ef3a9e406dbe663f1",
            "filename": "turbopack/crates/turbopack-ecmascript-runtime/js/src/browser/runtime/base/build-base.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/vercel/next.js/blob/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-ecmascript-runtime%2Fjs%2Fsrc%2Fbrowser%2Fruntime%2Fbase%2Fbuild-base.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-ecmascript-runtime%2Fjs%2Fsrc%2Fbrowser%2Fruntime%2Fbase%2Fbuild-base.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript-runtime%2Fjs%2Fsrc%2Fbrowser%2Fruntime%2Fbase%2Fbuild-base.ts?ref=7e11a155cca95dbe1a8ef655c8389ec7ca266598",
            "patch": "@@ -55,7 +55,7 @@ function instantiateModule(\n     // This can happen if modules incorrectly handle HMR disposes/updates,\n     // e.g. when they keep a `setTimeout` around which still executes old code\n     // and contains e.g. a `require(\"something\")` call.\n-    factoryNotAvailable(id, sourceType, sourceData)\n+    throw new Error(factoryNotAvailableMessage(id, sourceType, sourceData))\n   }\n \n   const module: Module = createModuleObject(id)"
        },
        {
            "sha": "2211a80324376a923d49cb3b5f3bfb2708c0181e",
            "filename": "turbopack/crates/turbopack-ecmascript-runtime/js/src/browser/runtime/base/dev-base.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/vercel/next.js/blob/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-ecmascript-runtime%2Fjs%2Fsrc%2Fbrowser%2Fruntime%2Fbase%2Fdev-base.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-ecmascript-runtime%2Fjs%2Fsrc%2Fbrowser%2Fruntime%2Fbase%2Fdev-base.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript-runtime%2Fjs%2Fsrc%2Fbrowser%2Fruntime%2Fbase%2Fdev-base.ts?ref=7e11a155cca95dbe1a8ef655c8389ec7ca266598",
            "patch": "@@ -194,7 +194,10 @@ function instantiateModule(\n     // This can happen if modules incorrectly handle HMR disposes/updates,\n     // e.g. when they keep a `setTimeout` around which still executes old code\n     // and contains e.g. a `require(\"something\")` call.\n-    factoryNotAvailable(id, sourceType, sourceData)\n+    throw new Error(\n+      factoryNotAvailableMessage(id, sourceType, sourceData) +\n+        ' It might have been deleted in an HMR update.'\n+    )\n   }\n \n   const hotData = moduleHotData.get(id)!"
        },
        {
            "sha": "aad72bc7a0ac1598f5d6795ab3b7504df5c52367",
            "filename": "turbopack/crates/turbopack-ecmascript-runtime/js/src/browser/runtime/base/runtime-base.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/vercel/next.js/blob/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-ecmascript-runtime%2Fjs%2Fsrc%2Fbrowser%2Fruntime%2Fbase%2Fruntime-base.ts",
            "raw_url": "https://github.com/vercel/next.js/raw/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-ecmascript-runtime%2Fjs%2Fsrc%2Fbrowser%2Fruntime%2Fbase%2Fruntime-base.ts",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-ecmascript-runtime%2Fjs%2Fsrc%2Fbrowser%2Fruntime%2Fbase%2Fruntime-base.ts?ref=7e11a155cca95dbe1a8ef655c8389ec7ca266598",
            "patch": "@@ -106,11 +106,11 @@ const availableModules: Map<ModuleId, Promise<any> | true> = new Map()\n \n const availableModuleChunks: Map<ChunkPath, Promise<any> | true> = new Map()\n \n-function factoryNotAvailable(\n+function factoryNotAvailableMessage(\n   moduleId: ModuleId,\n   sourceType: SourceType,\n   sourceData: SourceData\n-): never {\n+): string {\n   let instantiationReason\n   switch (sourceType) {\n     case SourceType.Runtime:\n@@ -128,9 +128,7 @@ function factoryNotAvailable(\n         (sourceType) => `Unknown source type: ${sourceType}`\n       )\n   }\n-  throw new Error(\n-    `Module ${moduleId} was instantiated ${instantiationReason}, but the module factory is not available. It might have been deleted in an HMR update.`\n-  )\n+  return `Module ${moduleId} was instantiated ${instantiationReason}, but the module factory is not available.`\n }\n \n function loadChunk("
        },
        {
            "sha": "7c825ab5e7f2136c777d64f9d9af99e4ff0990d8",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/debug-ids/browser/output/aaf3a_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js.map",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fdebug-ids%2Fbrowser%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fdebug-ids%2Fbrowser%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fdebug-ids%2Fbrowser%2Foutput%2Faaf3a_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js.map?ref=7e11a155cca95dbe1a8ef655c8389ec7ca266598"
        },
        {
            "sha": "f9333f66fb9540fb3b8ed688dfc5764636b91649",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/debug-ids/browser/output/ba425_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/vercel/next.js/blob/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fdebug-ids%2Fbrowser%2Foutput%2Fba425_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js",
            "raw_url": "https://github.com/vercel/next.js/raw/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fdebug-ids%2Fbrowser%2Foutput%2Fba425_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fdebug-ids%2Fbrowser%2Foutput%2Fba425_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js?ref=7e11a155cca95dbe1a8ef655c8389ec7ca266598",
            "patch": "@@ -1,4 +1,4 @@\n-;!function(){try { var e=\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof global?global:\"undefined\"!=typeof window?window:\"undefined\"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]=\"9cf0cfff-fe6b-e2a6-ed5a-275f25467c66\")}catch(e){}}();\n+;!function(){try { var e=\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof global?global:\"undefined\"!=typeof window?window:\"undefined\"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]=\"8faf1c28-5e36-9739-d4ef-60847ff8a1f3\")}catch(e){}}();\n (globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([\n     \"output/ba425_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js\",\n     {\"otherChunks\":[\"output/aaf3a_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0b8736b3.js\"],\"runtimeModuleIds\":[\"[project]/turbopack/crates/turbopack-tests/tests/snapshot/debug-ids/browser/input/index.js [test] (ecmascript)\"]}\n@@ -523,7 +523,7 @@ const moduleFactories = new Map();\n contextPrototype.M = moduleFactories;\n const availableModules = new Map();\n const availableModuleChunks = new Map();\n-function factoryNotAvailable(moduleId, sourceType, sourceData) {\n+function factoryNotAvailableMessage(moduleId, sourceType, sourceData) {\n     let instantiationReason;\n     switch(sourceType){\n         case 0:\n@@ -538,7 +538,7 @@ function factoryNotAvailable(moduleId, sourceType, sourceData) {\n         default:\n             invariant(sourceType, (sourceType)=>`Unknown source type: ${sourceType}`);\n     }\n-    throw new Error(`Module ${moduleId} was instantiated ${instantiationReason}, but the module factory is not available. It might have been deleted in an HMR update.`);\n+    return `Module ${moduleId} was instantiated ${instantiationReason}, but the module factory is not available.`;\n }\n function loadChunk(chunkData) {\n     return loadChunkInternal(1, this.m.id, chunkData);\n@@ -819,7 +819,7 @@ function instantiateModule(moduleId, sourceType, sourceData) {\n         // This can happen if modules incorrectly handle HMR disposes/updates,\n         // e.g. when they keep a `setTimeout` around which still executes old code\n         // and contains e.g. a `require(\"something\")` call.\n-        factoryNotAvailable(id, sourceType, sourceData);\n+        throw new Error(factoryNotAvailableMessage(id, sourceType, sourceData) + ' It might have been deleted in an HMR update.');\n     }\n     const hotData = moduleHotData.get(id);\n     const { hot, hotState } = createModuleHot(id, hotData);\n@@ -1834,5 +1834,5 @@ chunkListsToRegister.forEach(registerChunkList);\n })();\n \n \n-//# debugId=9cf0cfff-fe6b-e2a6-ed5a-275f25467c66\n+//# debugId=8faf1c28-5e36-9739-d4ef-60847ff8a1f3\n //# sourceMappingURL=aaf3a_crates_turbopack-tests_tests_snapshot_debug-ids_browser_input_index_0151fefb.js.map\n\\ No newline at end of file"
        },
        {
            "sha": "57ab40e305f6b8bcb2719cb905d6d6e1cfa5356d",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/runtime/default_dev_runtime/output/5c1d0_turbopack-tests_tests_snapshot_runtime_default_dev_runtime_input_index_c0f7e0b0.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/vercel/next.js/blob/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fruntime%2Fdefault_dev_runtime%2Foutput%2F5c1d0_turbopack-tests_tests_snapshot_runtime_default_dev_runtime_input_index_c0f7e0b0.js",
            "raw_url": "https://github.com/vercel/next.js/raw/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fruntime%2Fdefault_dev_runtime%2Foutput%2F5c1d0_turbopack-tests_tests_snapshot_runtime_default_dev_runtime_input_index_c0f7e0b0.js",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fruntime%2Fdefault_dev_runtime%2Foutput%2F5c1d0_turbopack-tests_tests_snapshot_runtime_default_dev_runtime_input_index_c0f7e0b0.js?ref=7e11a155cca95dbe1a8ef655c8389ec7ca266598",
            "patch": "@@ -522,7 +522,7 @@ const moduleFactories = new Map();\n contextPrototype.M = moduleFactories;\n const availableModules = new Map();\n const availableModuleChunks = new Map();\n-function factoryNotAvailable(moduleId, sourceType, sourceData) {\n+function factoryNotAvailableMessage(moduleId, sourceType, sourceData) {\n     let instantiationReason;\n     switch(sourceType){\n         case 0:\n@@ -537,7 +537,7 @@ function factoryNotAvailable(moduleId, sourceType, sourceData) {\n         default:\n             invariant(sourceType, (sourceType)=>`Unknown source type: ${sourceType}`);\n     }\n-    throw new Error(`Module ${moduleId} was instantiated ${instantiationReason}, but the module factory is not available. It might have been deleted in an HMR update.`);\n+    return `Module ${moduleId} was instantiated ${instantiationReason}, but the module factory is not available.`;\n }\n function loadChunk(chunkData) {\n     return loadChunkInternal(1, this.m.id, chunkData);\n@@ -818,7 +818,7 @@ function instantiateModule(moduleId, sourceType, sourceData) {\n         // This can happen if modules incorrectly handle HMR disposes/updates,\n         // e.g. when they keep a `setTimeout` around which still executes old code\n         // and contains e.g. a `require(\"something\")` call.\n-        factoryNotAvailable(id, sourceType, sourceData);\n+        throw new Error(factoryNotAvailableMessage(id, sourceType, sourceData) + ' It might have been deleted in an HMR update.');\n     }\n     const hotData = moduleHotData.get(id);\n     const { hot, hotState } = createModuleHot(id, hotData);"
        },
        {
            "sha": "1371c692f93ff74691c023cc9520648360532c00",
            "filename": "turbopack/crates/turbopack-tests/tests/snapshot/runtime/default_dev_runtime/output/780ce_turbopack-tests_tests_snapshot_runtime_default_dev_runtime_input_index_c0f7e0b0.js.map",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/vercel/next.js/blob/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fruntime%2Fdefault_dev_runtime%2Foutput%2F780ce_turbopack-tests_tests_snapshot_runtime_default_dev_runtime_input_index_c0f7e0b0.js.map",
            "raw_url": "https://github.com/vercel/next.js/raw/7e11a155cca95dbe1a8ef655c8389ec7ca266598/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fruntime%2Fdefault_dev_runtime%2Foutput%2F780ce_turbopack-tests_tests_snapshot_runtime_default_dev_runtime_input_index_c0f7e0b0.js.map",
            "contents_url": "https://api.github.com/repos/vercel/next.js/contents/turbopack%2Fcrates%2Fturbopack-tests%2Ftests%2Fsnapshot%2Fruntime%2Fdefault_dev_runtime%2Foutput%2F780ce_turbopack-tests_tests_snapshot_runtime_default_dev_runtime_input_index_c0f7e0b0.js.map?ref=7e11a155cca95dbe1a8ef655c8389ec7ca266598"
        }
    ],
    "stats": {
        "total": 41,
        "additions": 21,
        "deletions": 20
    }
}