{
    "author": "targos",
    "message": "Revert \"src: fix GetCpuProfiler() deprecation warning\"\n\nThis reverts commit f02b74dfdb364e1ccfa59ba7ee22790fe65548c3.\n\nPR-URL: https://github.com/nodejs/node/pull/19989\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Matheus Marchini <matheus@sthima.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Myles Borins <myles.borins@gmail.com>",
    "sha": "0fc488baf18503a1bfa95aa258f4c925dd3a05d3",
    "files": [
        {
            "sha": "a37efe08832f45fc62571f3b65b769da98f240f4",
            "filename": "src/env.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 11,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/0fc488baf18503a1bfa95aa258f4c925dd3a05d3/src%2Fenv.cc",
            "raw_url": "https://github.com/nodejs/node/raw/0fc488baf18503a1bfa95aa258f4c925dd3a05d3/src%2Fenv.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv.cc?ref=0fc488baf18503a1bfa95aa258f4c925dd3a05d3",
            "patch": "@@ -1,5 +1,6 @@\n #include \"node_internals.h\"\n #include \"async_wrap.h\"\n+#include \"v8-profiler.h\"\n #include \"node_buffer.h\"\n #include \"node_platform.h\"\n #include \"node_file.h\"\n@@ -73,15 +74,6 @@ IsolateData::IsolateData(Isolate* isolate,\n IsolateData::~IsolateData() {\n   if (platform_ != nullptr)\n     platform_->UnregisterIsolate(this);\n-  if (cpu_profiler_ != nullptr)\n-    cpu_profiler_->Dispose();\n-}\n-\n-v8::CpuProfiler* IsolateData::GetCpuProfiler() {\n-  if (cpu_profiler_ != nullptr) return cpu_profiler_;\n-  cpu_profiler_ = v8::CpuProfiler::New(isolate());\n-  CHECK_NOT_NULL(cpu_profiler_);\n-  return cpu_profiler_;\n }\n \n \n@@ -260,12 +252,12 @@ void Environment::CleanupHandles() {\n void Environment::StartProfilerIdleNotifier() {\n   uv_prepare_start(&idle_prepare_handle_, [](uv_prepare_t* handle) {\n     Environment* env = ContainerOf(&Environment::idle_prepare_handle_, handle);\n-    env->isolate_data()->GetCpuProfiler()->SetIdle(true);\n+    env->isolate()->GetCpuProfiler()->SetIdle(true);\n   });\n \n   uv_check_start(&idle_check_handle_, [](uv_check_t* handle) {\n     Environment* env = ContainerOf(&Environment::idle_check_handle_, handle);\n-    env->isolate_data()->GetCpuProfiler()->SetIdle(false);\n+    env->isolate()->GetCpuProfiler()->SetIdle(false);\n   });\n }\n "
        },
        {
            "sha": "96252fa12a13974852680eadf14169bc78eee92a",
            "filename": "src/env.h",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/0fc488baf18503a1bfa95aa258f4c925dd3a05d3/src%2Fenv.h",
            "raw_url": "https://github.com/nodejs/node/raw/0fc488baf18503a1bfa95aa258f4c925dd3a05d3/src%2Fenv.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv.h?ref=0fc488baf18503a1bfa95aa258f4c925dd3a05d3",
            "patch": "@@ -32,7 +32,6 @@\n #include \"req_wrap.h\"\n #include \"util.h\"\n #include \"uv.h\"\n-#include \"v8-profiler.h\"\n #include \"v8.h\"\n #include \"node.h\"\n #include \"node_http2_state.h\"\n@@ -369,8 +368,6 @@ class IsolateData {\n   std::unordered_map<nghttp2_rcbuf*, v8::Eternal<v8::String>> http2_static_strs;\n   inline v8::Isolate* isolate() const;\n \n-  v8::CpuProfiler* GetCpuProfiler();\n-\n  private:\n #define VP(PropertyName, StringValue) V(v8::Private, PropertyName)\n #define VS(PropertyName, StringValue) V(v8::String, PropertyName)\n@@ -386,7 +383,6 @@ class IsolateData {\n   uv_loop_t* const event_loop_;\n   uint32_t* const zero_fill_field_;\n   MultiIsolatePlatform* platform_;\n-  v8::CpuProfiler* cpu_profiler_ = nullptr;\n \n   DISALLOW_COPY_AND_ASSIGN(IsolateData);\n };"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 3,
        "deletions": 15
    }
}