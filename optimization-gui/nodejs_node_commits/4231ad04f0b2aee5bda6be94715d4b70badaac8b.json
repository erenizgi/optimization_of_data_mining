{
    "author": "sam-github",
    "message": "deps: upgrade openssl sources to 1.1.1a\n\nThis updates all sources in deps/openssl/openssl with openssl-1.1.1a.\n\nPR-URL: https://github.com/nodejs/node/pull/25381\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Shigeki Ohtsu <ohtsu@ohtsu.org>",
    "sha": "4231ad04f0b2aee5bda6be94715d4b70badaac8b",
    "files": [
        {
            "sha": "7b384b1149c0d391eed13e7421eccedb62b9d0d4",
            "filename": "deps/openssl/openssl/.github/PULL_REQUEST_TEMPLATE.md",
            "status": "added",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.github%2FPULL_REQUEST_TEMPLATE.md",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.github%2FPULL_REQUEST_TEMPLATE.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2F.github%2FPULL_REQUEST_TEMPLATE.md?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,14 @@\n+<!--\n+Thank you for your pull request. Please review these requirements:\n+\n+Contributors guide: https://github.com/openssl/openssl/blob/master/CONTRIBUTING\n+\n+Other than that, provide a description above this comment if there isn't one already\n+\n+If this fixes a github issue, make sure to have a line saying 'Fixes #XXXX' (without quotes) in the commit message.\n+-->\n+\n+##### Checklist\n+<!-- Remove items that do not apply. For completed items, change [ ] to [x]. -->\n+- [ ] documentation is added or updated\n+- [ ] tests are added or updated"
        },
        {
            "sha": "1b0f25cc81b25b1e3067022deb70465105ae7c30",
            "filename": "deps/openssl/openssl/.gitignore",
            "status": "added",
            "additions": 185,
            "deletions": 0,
            "changes": 185,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.gitignore",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.gitignore",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2F.gitignore?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,185 @@\n+# Ignore editor artefacts\n+/.dir-locals.el\n+\n+# Top level excludes\n+/Makefile.orig\n+/MINFO\n+/TABLE\n+/*.pc\n+/rehash.time\n+/inc.*\n+/makefile.*\n+/out.*\n+/tmp.*\n+/configdata.pm\n+\n+# *all* Makefiles\n+Makefile\n+# ... except in demos\n+!/demos/*/Makefile\n+\n+# Links under apps\n+/apps/CA.pl\n+/apps/tsget\n+/apps/tsget.pl\n+/apps/md4.c\n+\n+# Auto generated headers\n+/crypto/buildinf.h\n+/apps/progs.h\n+/crypto/include/internal/*_conf.h\n+/openssl/include/opensslconf.h\n+/util/domd\n+\n+# error code files\n+/crypto/err/openssl.txt.old\n+/engines/e_afalg.txt.old\n+/engines/e_capi.txt.old\n+/engines/e_dasync.txt.old\n+/engines/e_ossltest.txt.old\n+\n+# Executables\n+/apps/openssl\n+/test/sha256t\n+/test/sha512t\n+/test/gost2814789t\n+/test/ssltest_old\n+/test/*test\n+/test/fips_aesavs\n+/test/fips_desmovs\n+/test/fips_dhvs\n+/test/fips_drbgvs\n+/test/fips_dssvs\n+/test/fips_ecdhvs\n+/test/fips_ecdsavs\n+/test/fips_rngvs\n+/test/fips_test_suite\n+/test/ssltest_old\n+/test/x509aux\n+/test/v3ext\n+/test/versions\n+/test/ossl_shim/ossl_shim\n+/test/rsa_complex\n+\n+# Certain files that get created by tests on the fly\n+/test/test-runs\n+/test/buildtest_*\n+\n+# Fuzz stuff.\n+# Anything without an extension is an executable on Unix, so we keep files\n+# with extensions.  And we keep the corpora subddir versioned as well.\n+# Anything more generic with extensions that should be ignored will be taken\n+# care of by general ignores for those extensions (*.o, *.obj, *.exe, ...)\n+/fuzz/*\n+!/fuzz/README*\n+!/fuzz/corpora\n+!/fuzz/*.*\n+\n+# Misc auto generated files\n+/include/openssl/opensslconf.h\n+/tools/c_rehash\n+/tools/c_rehash.pl\n+/util/shlib_wrap.sh\n+/tags\n+/TAGS\n+/libcrypto.map\n+/libssl.map\n+\n+# Windows (legacy)\n+/tmp32\n+/tmp32.dbg\n+/tmp32dll\n+/tmp32dll.dbg\n+/out32\n+/out32.dbg\n+/out32dll\n+/out32dll.dbg\n+/inc32\n+/MINFO\n+/ms/.rnd\n+/ms/bcb.mak\n+/ms/libeay32.def\n+/ms/nt.mak\n+/ms/ntdll.mak\n+/ms/ssleay32.def\n+/ms/version32.rc\n+\n+# Files created on other branches that are not held in git, and are not\n+# needed on this branch\n+/include/openssl/asn1_mac.h\n+/include/openssl/des_old.h\n+/include/openssl/fips.h\n+/include/openssl/fips_rand.h\n+/include/openssl/krb5_asn.h\n+/include/openssl/kssl.h\n+/include/openssl/pq_compat.h\n+/include/openssl/ssl23.h\n+/include/openssl/tmdiff.h\n+/include/openssl/ui_compat.h\n+/test/fips_aesavs.c\n+/test/fips_desmovs.c\n+/test/fips_dsatest.c\n+/test/fips_dssvs.c\n+/test/fips_hmactest.c\n+/test/fips_randtest.c\n+/test/fips_rngvs.c\n+/test/fips_rsagtest.c\n+/test/fips_rsastest.c\n+/test/fips_rsavtest.c\n+/test/fips_shatest.c\n+/test/fips_test_suite.c\n+/test/shatest.c\n+\n+##### Generic patterns\n+# Auto generated assembly language source files\n+*.s\n+!/crypto/*/asm/*.s\n+/crypto/arm*.S\n+/crypto/*/*.S\n+*.asm\n+!/crypto/*/asm/*.asm\n+\n+# Object files\n+*.o\n+*.obj\n+\n+# editor artefacts\n+*.swp\n+.#*\n+\\#*#\n+*~\n+\n+# Certificate symbolic links\n+*.0\n+\n+# All kinds of libraries and executables\n+*.a\n+*.so\n+*.so.*\n+*.dylib\n+*.dylib.*\n+*.dll\n+*.dll.*\n+*.exe\n+*.pyc\n+*.exp\n+*.lib\n+*.pdb\n+*.ilk\n+*.def\n+*.rc\n+*.res\n+\n+# Misc generated stuff\n+Makefile.save\n+/crypto/**/lib\n+/engines/**/lib\n+/ssl/**/lib\n+*.bak\n+cscope.*\n+*.d\n+pod2htmd.tmp\n+\n+# Windows manifest files\n+*.manifest\n+doc-nits"
        },
        {
            "sha": "af32ea618cf72247fef175a05383300037a534d4",
            "filename": "deps/openssl/openssl/.gitmodules",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.gitmodules",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.gitmodules",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2F.gitmodules?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,11 @@\n+[submodule \"boringssl\"]\n+\tpath = boringssl\n+\turl = https://boringssl.googlesource.com/boringssl\n+\n+[submodule \"pyca.cryptography\"]\n+\tpath = pyca-cryptography\n+\turl = https://github.com/pyca/cryptography.git\n+\n+[submodule \"krb5\"]\n+\tpath = krb5\n+\turl = https://github.com/krb5/krb5"
        },
        {
            "sha": "b39a00137ac578b10399c5d1f1b8d1757ce65cb4",
            "filename": "deps/openssl/openssl/.travis-create-release.sh",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.travis-create-release.sh",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.travis-create-release.sh",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2F.travis-create-release.sh?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -5,7 +5,7 @@\n ./Configure dist\n if [ \"$1\" == osx ]; then\n     make NAME='_srcdist' TARFILE='_srcdist.tar' \\\n-         TAR_COMMAND='$(TAR) $(TARFLAGS) -cvf -' tar\n+         TAR_COMMAND='$(TAR) $(TARFLAGS) -cf -' tar\n else\n     make TARFILE='_srcdist.tar' NAME='_srcdist' dist\n fi"
        },
        {
            "sha": "764da2885e546ffe38eb08d2e271c84e4ff75b5e",
            "filename": "deps/openssl/openssl/.travis.yml",
            "status": "modified",
            "additions": 117,
            "deletions": 71,
            "changes": 188,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.travis.yml",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2F.travis.yml",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2F.travis.yml?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,109 +1,139 @@\n dist: trusty\n sudo: required\n \n+osx_image: xcode9.3\n+\n language: c\n cache: ccache\n+git:\n+    submodules: false\n+    quiet: true\n \n before_install:\n     - if [ -n \"$COVERALLS\" ]; then\n           pip install --user cpp-coveralls;\n       fi;\n-\n-addons:\n-    apt:\n-        packages:\n-            - ccache\n+    - if expr \"$CONFIG_OPTS\" \":\" \".*enable-external-tests\" > /dev/null; then\n+          git submodule update --init --recursive;\n+      fi;\n \n os:\n     - linux\n+    - osx\n \n compiler:\n     - clang\n     - gcc\n \n env:\n     - CONFIG_OPTS=\"\" DESTDIR=\"_install\"\n-    - CONFIG_OPTS=\"--debug no-shared enable-crypto-mdebug enable-rc5 enable-md2\"\n-    - CONFIG_OPTS=\"no-pic --strict-warnings\" BUILDONLY=\"yes\"\n-    - CONFIG_OPTS=\"no-engine no-shared --strict-warnings\" BUILDONLY=\"yes\"\n-    - CONFIG_OPTS=\"no-stdio --strict-warnings\" BUILDONLY=\"yes\"\n-    - CONFIG_OPTS=\"no-ec\" BUILDONLY=\"yes\"\n-    - CONFIG_OPTS=\"no-asm --strict-warnings\" BUILDONLY=\"yes\" CHECKDOCS=\"yes\"\n+    - CONFIG_OPTS=\"no-asm -Werror --debug no-afalgeng no-shared enable-crypto-mdebug enable-rc5 enable-md2\"\n+    - CONFIG_OPTS=\"no-asm no-makedepend --strict-warnings -std=c89 -D_DEFAULT_SOURCE\" BUILDONLY=\"yes\" CHECKDOCS=\"yes\" GENERATE=\"yes\"\n \n matrix:\n     include:\n-        - os: linux\n-          compiler: clang-3.9\n-          env: CONFIG_OPTS=\"--strict-warnings no-deprecated\" BUILDONLY=\"yes\"\n-        - os: linux\n-          compiler: gcc\n-          env: CONFIG_OPTS=\"--debug --coverage no-asm enable-rc5 enable-md2 enable-ec_nistp_64_gcc_128 enable-ssl3 enable-ssl3-method enable-weak-ssl-ciphers\" COVERALLS=\"yes\"\n-        - os: linux\n-          compiler: clang-3.9\n-          env: CONFIG_OPTS=\"enable-asan\"\n-        - os: linux\n-          compiler: clang-3.9\n-          env: CONFIG_OPTS=\"enable-msan\"\n-        - os: linux\n-          compiler: clang-3.9\n-          env: CONFIG_OPTS=\"no-asm enable-ubsan enable-rc5 enable-md2 enable-ssl3 enable-ssl3-method -fno-sanitize=alignment\"\n-        - os: linux\n-          compiler: clang-3.9\n-          env: CONFIG_OPTS=\"no-asm enable-asan enable-rc5 enable-md2\"\n-        - os: linux\n-          compiler: clang-3.9\n-          env: CONFIG_OPTS=\"no-stdio\"\n+        - os: linux-ppc64le\n+          sudo: false\n+          compiler: clang\n+          env: CONFIG_OPTS=\"--strict-warnings -D__NO_STRING_INLINES\"\n         - os: linux\n           addons:\n               apt:\n                   packages:\n                       - gcc-5\n+                      - g++-5\n                   sources:\n                       - ubuntu-toolchain-r-test\n           compiler: gcc-5\n-          env: UBUNTU_GCC_HACK=\"yes\" CONFIG_OPTS=\"no-asm enable-ubsan enable-rc5 enable-md2 -DPEDANTIC\"\n+          env: CONFIG_OPTS=\"--strict-warnings\" COMMENT=\"Move to the BORINGTEST build when interoperable\"\n+        - os: linux\n+          compiler: clang\n+          env: CONFIG_OPTS=\"--strict-warnings -D__NO_STRING_INLINES no-deprecated\" BUILDONLY=\"yes\"\n         - os: linux\n           addons:\n               apt:\n                   packages:\n                       - binutils-mingw-w64\n                       - gcc-mingw-w64\n           compiler: i686-w64-mingw32-gcc\n-          env: CONFIG_OPTS=\"no-pic\"\n+          env: CONFIG_OPTS=\"no-stdio\" BUILDONLY=\"yes\"\n+        # Uncomment if there is reason to believe that PPC-specific problem\n+        # can be diagnosed with this possibly >30 mins sanitizer build...\n+        #- os: linux-ppc64le\n+        #  sudo: false\n+        #  compiler: gcc\n+        #  env: EXTENDED_TEST=\"yes\" CONFIG_OPTS=\"no-asm enable-asan enable-ubsan no-shared -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -D__NO_STRING_INLINES\"\n         - os: linux\n           addons:\n               apt:\n                   packages:\n-                      - binutils-mingw-w64\n-                      - gcc-mingw-w64\n-          compiler: i686-w64-mingw32-gcc\n-          env: CONFIG_OPTS=\"no-stdio\" BUILDONLY=\"yes\"\n+                      - gcc-5\n+                      - g++-5\n+                      - golang-1.6\n+                  sources:\n+                      - ubuntu-toolchain-r-test\n+          compiler: gcc-5\n+          env:  EXTENDED_TEST=\"yes\" CONFIG_OPTS=\"--debug --coverage no-asm enable-rc5 enable-md2 enable-ec_nistp_64_gcc_128 enable-ssl3 enable-ssl3-method enable-nextprotoneg enable-weak-ssl-ciphers no-shared -DPEDANTIC -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\" COVERALLS=\"yes\" BORINGSSL_TESTS=\"yes\" CXX=\"g++-5\"\n+        - os: linux\n+          addons:\n+              apt:\n+                  packages:\n+                      - gcc-5\n+                      - g++-5\n+                      - golang-1.6\n+                  sources:\n+                      - ubuntu-toolchain-r-test\n+          compiler: gcc-5\n+          env:  EXTENDED_TEST=\"yes\" CONFIG_OPTS=\"--debug enable-ssl3 enable-ssl3-method enable-weak-ssl-ciphers enable-external-tests\" BORINGSSL_TESTS=\"yes\" CXX=\"g++-5\" TESTS=95\n+        - os: linux\n+          compiler: clang\n+          env: EXTENDED_TEST=\"yes\" CONFIG_OPTS=\"enable-msan -D__NO_STRING_INLINES -Wno-unused-command-line-argument\"\n+        - os: linux\n+          compiler: clang\n+          env:  EXTENDED_TEST=\"yes\" CONFIG_OPTS=\"no-asm enable-ubsan enable-rc5 enable-md2 enable-ssl3 enable-ssl3-method enable-nextprotoneg no-shared -fno-sanitize=alignment -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -D__NO_STRING_INLINES -Wno-unused-command-line-argument\"\n+        - os: linux\n+          compiler: clang\n+          env: EXTENDED_TEST=\"yes\" CONFIG_OPTS=\"no-asm enable-asan enable-rc5 enable-md2 no-shared -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -D__NO_STRING_INLINES -Wno-unused-command-line-argument\"\n+        - os: linux\n+          addons:\n+              apt:\n+                  packages:\n+                      - gcc-5\n+                      - g++-5\n+                  sources:\n+                      - ubuntu-toolchain-r-test\n+          compiler: gcc-5\n+          env: UBUNTU_GCC_HACK=\"yes\" EXTENDED_TEST=\"yes\" CONFIG_OPTS=\"--debug no-asm enable-ubsan enable-rc5 enable-md2 -DPEDANTIC\" OPENSSL_TEST_RAND_ORDER=0\n         - os: linux\n           addons:\n               apt:\n                   packages:\n                       - binutils-mingw-w64\n                       - gcc-mingw-w64\n-          compiler: x86_64-w64-mingw32-gcc\n-          env: CONFIG_OPTS=\"no-pic\"\n+          compiler: i686-w64-mingw32-gcc\n+          env: EXTENDED_TEST=\"yes\" CONFIG_OPTS=\"no-pic\"\n         - os: linux\n           addons:\n               apt:\n                   packages:\n                       - binutils-mingw-w64\n                       - gcc-mingw-w64\n           compiler: x86_64-w64-mingw32-gcc\n-          env: CONFIG_OPTS=\"no-stdio\" BUILDONLY=\"yes\"\n+          env: EXTENDED_TEST=\"yes\" CONFIG_OPTS=\"no-pic\"\n     exclude:\n         - os: linux\n           compiler: clang\n         - os: osx\n           compiler: gcc\n \n before_script:\n+    - env\n+    - if [ \"$TRAVIS_PULL_REQUEST\" != \"false\" -a -n \"$EXTENDED_TEST\" ]; then\n+          (git log -1 $TRAVIS_COMMIT_RANGE | grep '\\[extended tests\\]' > /dev/null) || exit 0;\n+      fi\n     - if [ -n \"$DESTDIR\" ]; then\n           sh .travis-create-release.sh $TRAVIS_OS_NAME;\n-          tar -xvzf _srcdist.tar.gz;\n+          tar -xzf _srcdist.tar.gz;\n           mkdir _build;\n           cd _build;\n           srcdir=../_srcdist;\n@@ -116,14 +146,14 @@ before_script:\n           $CC -dumpspecs | sed \"s/--push-state//g; s/--pop-state/--as-needed/g\" > gcc-specs.txt;\n           CC=\"$CC -specs=gcc-specs.txt\";\n       fi\n-    - if [ \"$CC\" == i686-w64-mingw32-gcc ]; then\n+    - if [ \"$CC\" = i686-w64-mingw32-gcc ]; then\n           export CROSS_COMPILE=${CC%%gcc}; unset CC;\n           $srcdir/Configure mingw $CONFIG_OPTS -Wno-pedantic-ms-format;\n-      elif [ \"$CC\" == x86_64-w64-mingw32-gcc ]; then\n+      elif [ \"$CC\" = x86_64-w64-mingw32-gcc ]; then\n           export CROSS_COMPILE=${CC%%gcc}; unset CC;\n           $srcdir/Configure mingw64 $CONFIG_OPTS -Wno-pedantic-ms-format;\n       else\n-          if [ \"$CC\" == clang-3.9 ]; then\n+          if [ \"$CC\" = clang-3.9 ]; then\n               sudo cp .travis-apt-pin.preferences /etc/apt/preferences.d/no-ubuntu-clang;\n               curl -sSL \"http://apt.llvm.org/llvm-snapshot.gpg.key\" | sudo -E apt-key add -;\n               echo \"deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.9 main\" | sudo tee -a /etc/apt/sources.list > /dev/null;\n@@ -135,14 +165,7 @@ before_script:\n           fi;\n           $srcdir/config -v $CONFIG_OPTS;\n       fi\n-    - if [ -z \"$BUILDONLY\" ]; then\n-          if [ -n \"$CROSS_COMPILE\" ]; then\n-              if [ \"$TRAVIS_OS_NAME\" == \"linux\" ]; then\n-                  sudo dpkg --add-architecture i386;\n-                  sudo apt-get update;\n-              fi;\n-          fi;\n-      fi\n+    - ./configdata.pm --dump\n     - cd $top\n \n script:\n@@ -151,56 +174,79 @@ script:\n       else\n           make=\"make\";\n       fi\n+    - if [ -n \"$GENERATE\" ]; then\n+          make2=\"$make PERL=no-perl\";\n+      else\n+          make2=\"$make\";\n+      fi\n+    - top=${PWD}\n     - if [ -n \"$DESTDIR\" ]; then\n           cd _build;\n-          top=..;\n-      else\n-          top=.;\n       fi\n     - if $make update; then\n           echo -e '+\\057 MAKE UPDATE OK';\n       else\n           echo -e '+\\057 MAKE UPDATE FAILED'; false;\n-      fi;\n-      git diff --exit-code\n+      fi\n+    - git diff --exit-code\n     - if [ -n \"$CHECKDOCS\" ]; then\n           if $make doc-nits; then\n               echo -e '+\\057\\057 MAKE DOC-NITS OK';\n           else\n               echo -e '+\\057\\057 MAKE DOC-NITS FAILED'; false;\n           fi;\n       fi\n-    - if $make ; then\n-          echo -e '+\\057\\057\\057 MAKE OK';\n+    - if [ -n \"$GENERATE\" ]; then\n+          if $make build_all_generated; then\n+              echo -e '+\\057\\057\\057 MAKE BUILD_ALL_GENERATED OK';\n+          else\n+              echo -e '+\\057\\057\\057 MAKE BUILD_ALL_GENERATED FAILED'; false;\n+          fi;\n+      fi\n+    - if $make2; then\n+          echo -e '+\\057\\057\\057\\057 MAKE OK';\n       else\n-          echo -e '+\\057\\057\\057 MAKE FAILED'; false;\n+          echo -e '+\\057\\057\\057\\057 MAKE FAILED'; false;\n       fi;\n     - if [ -z \"$BUILDONLY\" ]; then\n           if [ -n \"$CROSS_COMPILE\" ]; then\n-              sudo apt-get -yq install wine;\n+              sudo dpkg --add-architecture i386;\n+              sudo apt-get update;\n+              sudo apt-get -yq --no-install-suggests --no-install-recommends --force-yes install wine;\n               export EXE_SHELL=\"wine\" WINEPREFIX=`pwd`;\n           fi;\n-          HARNESS_VERBOSE=yes make test;\n+          if [ -e krb5/src ]; then\n+              sudo apt-get -yq install bison dejagnu gettext keyutils ldap-utils libldap2-dev libkeyutils-dev python-cjson python-paste python-pyrad slapd tcl-dev tcsh;\n+          fi;\n+          if HARNESS_VERBOSE=yes BORING_RUNNER_DIR=$top/boringssl/ssl/test/runner make test; then\n+              echo -e '+\\057\\057\\057\\057\\057 MAKE TEST OK';\n+          else\n+              echo -e '+\\057\\057\\057\\057\\057 MAKE TEST FAILED'; false;\n+          fi;\n       else\n-          if $make build_tests; then\n-              echo -e '+\\057\\057\\075 MAKE BUILD_TESTS OK';\n+          if $make build_tests >~/build.log 2>&1; then\n+              echo -e '+\\057\\057\\057\\057\\057\\057 MAKE BUILD_TESTS OK';\n           else\n-              echo -e '+\\057\\057\\075 MAKE BUILD_TESTS FAILEd'; false;\n+              echo -e '+\\057\\057\\057\\057\\057\\057 MAKE BUILD_TESTS FAILED';\n+              cat ~/build.log\n+              false;\n           fi;\n       fi\n     - if [ -n \"$DESTDIR\" ]; then\n-          mkdir \"../$DESTDIR\";\n-          if $make install DESTDIR=\"../$DESTDIR\"; then\n-              echo -e '+\\057\\057\\057\\057\\057 MAKE INSTALL_DOCS OK';\n+          mkdir \"$top/$DESTDIR\";\n+          if $make install DESTDIR=\"$top/$DESTDIR\" >~/install.log 2>&1 ; then\n+              echo -e '+\\057\\057\\057\\057\\057\\057\\057 MAKE INSTALL OK';\n           else\n-              echo -e '+\\057\\057\\057\\057\\057 MAKE INSTALL_DOCS FAILED'; false;\n+              echo -e '+\\057\\057\\057\\057\\057\\057\\057 MAKE INSTALL FAILED';\n+              cat ~/install.log;\n+              false;\n           fi;\n       fi\n     - cd $top\n \n after_success:\n     - if [ -n \"$COVERALLS\" ]; then\n-          coveralls -b . --gcov-options '\\-lp';\n+          coveralls -b . --gcov gcov-5 --gcov-options '\\-lpbc';\n       fi;\n \n notifications:"
        },
        {
            "sha": "ac93b2e7b975c25e0b87228ead8cefc64fc638b4",
            "filename": "deps/openssl/openssl/AUTHORS",
            "status": "modified",
            "additions": 35,
            "deletions": 21,
            "changes": 56,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FAUTHORS",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FAUTHORS",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FAUTHORS?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,21 +1,35 @@\n-    Andy Polyakov\n-    Ben Laurie\n-    Bodo M�ller\n-    Emilia K�sper\n-    Eric Young\n-    Geoff Thorpe\n-    Holger Reif\n-    Kurt Roeckx\n-    Lutz J�nicke\n-    Mark J. Cox\n-    Matt Caswell\n-    Nils Larsch\n-    Paul C. Sutton\n-    Ralf S. Engelschall\n-    Rich Salz\n-    Richard Levitte\n-    Stephen Henson\n-    Steve Marquess\n-    Tim Hudson\n-    Ulf M�ller\n-    Viktor Dukhovni\n+# This is the list of OpenSSL authors for copyright purposes.\n+#\n+# This does not necessarily list everyone who has contributed code, since in\n+# some cases, their employer may be the copyright holder.  To see the full list\n+# of contributors, see the revision history in source control.\n+OpenSSL Software Services, Inc.\n+OpenSSL Software Foundation, Inc.\n+\n+# Individuals\n+Andy Polyakov\n+Ben Laurie\n+Ben Kaduk\n+Bernd Edlinger\n+Bodo Möller\n+David Benjamin\n+Emilia Käsper\n+Eric Young\n+Geoff Thorpe\n+Holger Reif\n+Kurt Roeckx\n+Lutz Jänicke\n+Mark J. Cox\n+Matt Caswell\n+Matthias St. Pierre\n+Nils Larsch\n+Paul Dale\n+Paul C. Sutton\n+Ralf S. Engelschall\n+Rich Salz\n+Richard Levitte\n+Stephen Henson\n+Steve Marquess\n+Tim Hudson\n+Ulf Möller\n+Viktor Dukhovni"
        },
        {
            "sha": "4b68f4832909b8b1c5d8a9508532692031bd0704",
            "filename": "deps/openssl/openssl/CHANGES",
            "status": "modified",
            "additions": 732,
            "deletions": 279,
            "changes": 1011,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FCHANGES",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FCHANGES",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FCHANGES?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c0eed39e34b2905eae449470123c84fffdcd1fee",
            "filename": "deps/openssl/openssl/CONTRIBUTING",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FCONTRIBUTING",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FCONTRIBUTING",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FCONTRIBUTING?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -50,8 +50,9 @@ guidelines:\n     test/README for information on the test framework.\n \n     6.  New features or changed functionality must include\n-    documentation. Please look at the \"pod\" files in doc for\n-    examples of our style.\n+    documentation. Please look at the \"pod\" files in doc/man[1357] for\n+    examples of our style. Run \"make doc-nits\" to make sure that your\n+    documentation changes are clean.\n \n     7.  For user visible changes (API changes, behaviour changes, ...),\n     consider adding a note in CHANGES.  This could be a summarising"
        },
        {
            "sha": "8555ba158baf7b38e9fc4859af403c1694245f49",
            "filename": "deps/openssl/openssl/Configurations/00-base-templates.conf",
            "status": "modified",
            "additions": 89,
            "deletions": 32,
            "changes": 121,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F00-base-templates.conf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F00-base-templates.conf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F00-base-templates.conf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,14 +1,21 @@\n # -*- Mode: perl -*-\n-%targets=(\n+my %targets=(\n     DEFAULTS => {\n \ttemplate\t=> 1,\n \n \tcflags\t\t=> \"\",\n+\tcppflags\t=> \"\",\n+\tlflags\t\t=> \"\",\n \tdefines\t\t=> [],\n+\tincludes\t=> [],\n+\tlib_cflags\t=> \"\",\n+\tlib_cppflags\t=> \"\",\n+\tlib_defines\t=> [],\n \tthread_scheme\t=> \"(unknown)\", # Assume we don't know\n \tthread_defines\t=> [],\n \n \tapps_aux_src\t=> \"\",\n+\tapps_init_src\t=> \"\",\n \tcpuid_asm_src\t=> \"mem_clr.c\",\n \tuplink_aux_src\t=> \"\",\n \tbn_asm_src\t=> \"bn_asm.c\",\n@@ -27,6 +34,7 @@\n \tpadlock_asm_src\t=> \"\",\n \tchacha_asm_src\t=> \"chacha_enc.c\",\n \tpoly1305_asm_src\t=> \"\",\n+\tkeccak1600_asm_src\t=> \"keccak1600.c\",\n \n \tunistd\t\t=> \"<unistd.h>\",\n \tshared_target\t=> \"\",\n@@ -36,37 +44,63 @@\n \tshared_rcflag\t=> \"\",\n \tshared_extension\t=> \"\",\n \n-        build_scheme    => [ \"unified\", \"unix\" ],\n-        build_file      => \"Makefile\",\n+\t#### Defaults for the benefit of the config targets who don't inherit\n+\t#### a BASE and assume Unix defaults\n+\t#### THESE WILL DISAPPEAR IN OpenSSL 1.2\n+\tbuild_scheme\t=> [ \"unified\", \"unix\" ],\n+\tbuild_file\t=> \"Makefile\",\n+\n+\tAR\t\t=> \"ar\",\n+\tARFLAGS\t\t=> \"r\",\n+\tCC\t\t=> \"cc\",\n+\tHASHBANGPERL\t=> \"/usr/bin/env perl\",\n+\tRANLIB\t\t=> sub { which(\"$config{cross_compile_prefix}ranlib\")\n+                                     ? \"ranlib\" : \"\" },\n+\tRC\t\t=> \"windres\",\n+\n+\t#### THESE WILL BE ENABLED IN OpenSSL 1.2\n+\t#HASHBANGPERL\t=> \"PERL\", # Only Unix actually cares\n     },\n \n     BASE_common => {\n \ttemplate\t=> 1,\n+\n+\tenable\t\t=> [],\n+\tdisable\t\t=> [],\n+\n \tdefines\t\t=>\n \t    sub {\n                 my @defs = ();\n                 push @defs, \"ZLIB\" unless $disabled{zlib};\n                 push @defs, \"ZLIB_SHARED\" unless $disabled{\"zlib-dynamic\"};\n                 return [ @defs ];\n             },\n+        includes        =>\n+            sub {\n+                my @incs = ();\n+                push @incs, $withargs{zlib_include}\n+                    if !$disabled{zlib} && $withargs{zlib_include};\n+                return [ @incs ];\n+            },\n     },\n \n     BASE_unix => {\n         inherit_from    => [ \"BASE_common\" ],\n         template        => 1,\n \n+        AR              => \"ar\",\n+        ARFLAGS         => \"r\",\n+        CC              => \"cc\",\n+        lflags          =>\n+            sub { $withargs{zlib_lib} ? \"-L\".$withargs{zlib_lib} : () },\n         ex_libs         =>\n-            sub {\n-                unless ($disabled{zlib}) {\n-                    if (defined($disabled{\"zlib-dynamic\"})) {\n-                        if (defined($withargs{zlib_lib})) {\n-                            return \"-L\".$withargs{zlib_lib}.\" -lz\";\n-                        } else {\n-                            return \"-lz\";\n-                        }\n-                    }\n-                }\n-                return (); },\n+            sub { !defined($disabled{zlib})\n+                  && defined($disabled{\"zlib-dynamic\"})\n+                  ? \"-lz\" : () },\n+        HASHBANGPERL    => \"/usr/bin/env perl\", # Only Unix actually cares\n+        RANLIB          => sub { which(\"$config{cross_compile_prefix}ranlib\")\n+                                     ? \"ranlib\" : \"\" },\n+        RC              => \"windres\",\n \n         shared_extension => \".so\",\n \n@@ -78,6 +112,15 @@\n         inherit_from    => [ \"BASE_common\" ],\n         template        => 1,\n \n+        lib_defines      =>\n+            sub {\n+                my @defs = ();\n+                unless ($disabled{\"zlib-dynamic\"}) {\n+                    my $zlib = $withargs{zlib_lib} // \"ZLIB1\";\n+                    push @defs, 'LIBZ=' . (quotify(\"perl\", $zlib))[0];\n+                }\n+                return [ @defs ];\n+            },\n         ex_libs         =>\n             sub {\n                 unless ($disabled{zlib}) {\n@@ -88,16 +131,16 @@\n                 return ();\n             },\n \n-        ld              => \"link\",\n-        lflags          => \"/nologo\",\n-        loutflag        => \"/out:\",\n-        ar              => \"lib\",\n-        arflags         => \"/nologo\",\n+        LD              => \"link\",\n+        LDFLAGS         => \"/nologo\",\n+        ldoutflag       => \"/out:\",\n+        AR              => \"lib\",\n+        ARFLAGS         => \"/nologo\",\n         aroutflag       => \"/out:\",\n-        rc               => \"rc\",\n+        RC               => \"rc\",\n         rcoutflag        => \"/fo\",\n-        mt              => \"mt\",\n-        mtflags         => \"-nologo\",\n+        MT              => \"mt\",\n+        MTFLAGS         => \"-nologo\",\n         mtinflag        => \"-manifest \",\n         mtoutflag       => \"-outputresource:\",\n \n@@ -111,6 +154,16 @@\n         inherit_from    => [ \"BASE_common\" ],\n         template        => 1,\n \n+        includes        =>\n+            add(sub {\n+                    my @incs = ();\n+                    # GNV$ZLIB_INCLUDE is the standard logical name for later\n+                    # zlib incarnations.\n+                    push @incs, 'GNV$ZLIB_INCLUDE:'\n+                        if !$disabled{zlib} && !$withargs{zlib_include};\n+                    return [ @incs ];\n+                }),\n+\n         shared_extension => \".exe\",\n \n         build_file       => \"descrip.mms\",\n@@ -119,7 +172,7 @@\n \n     uplink_common => {\n \ttemplate\t=> 1,\n-\tapps_aux_src\t=> add(\"../ms/applink.c\"),\n+\tapps_init_src\t=> add(\"../ms/applink.c\"),\n \tuplink_aux_src\t=> add(\"../ms/uplink.c\"),\n \tdefines\t\t=> add(\"OPENSSL_USE_APPLINK\"),\n     },\n@@ -169,7 +222,7 @@\n \ttemplate\t=> 1,\n \tcpuid_asm_src   => \"x86_64cpuid.s\",\n \tbn_asm_src      => \"asm/x86_64-gcc.c x86_64-mont.s x86_64-mont5.s x86_64-gf2m.s rsaz_exp.c rsaz-x86_64.s rsaz-avx2.s\",\n-\tec_asm_src      => \"ecp_nistz256.c ecp_nistz256-x86_64.s\",\n+\tec_asm_src      => \"ecp_nistz256.c ecp_nistz256-x86_64.s x25519-x86_64.s\",\n \taes_asm_src     => \"aes-x86_64.s vpaes-x86_64.s bsaes-x86_64.s aesni-x86_64.s aesni-sha1-x86_64.s aesni-sha256-x86_64.s aesni-mb-x86_64.s\",\n \tmd5_asm_src     => \"md5-x86_64.s\",\n \tsha1_asm_src    => \"sha1-x86_64.s sha256-x86_64.s sha512-x86_64.s sha1-mb-x86_64.s sha256-mb-x86_64.s\",\n@@ -180,15 +233,14 @@\n \tpadlock_asm_src => \"e_padlock-x86_64.s\",\n \tchacha_asm_src\t=> \"chacha-x86_64.s\",\n \tpoly1305_asm_src=> \"poly1305-x86_64.s\",\n+\tkeccak1600_asm_src\t=> \"keccak1600-x86_64.s\",\n     },\n     ia64_asm => {\n \ttemplate\t=> 1,\n \tcpuid_asm_src   => \"ia64cpuid.s\",\n \tbn_asm_src      => \"bn-ia64.s ia64-mont.s\",\n \taes_asm_src     => \"aes_core.c aes_cbc.c aes-ia64.s\",\n-\tmd5_asm_src     => \"md5-ia64.s\",\n \tsha1_asm_src    => \"sha1-ia64.s sha256-ia64.s sha512-ia64.s\",\n-\trc4_asm_src     => \"rc4-ia64.s rc4_skey.c\",\n \tmodes_asm_src   => \"ghash-ia64.s\",\n \tperlasm_scheme\t=> \"void\"\n     },\n@@ -223,7 +275,7 @@\n     },\n     mips32_asm => {\n \ttemplate\t=> 1,\n-\tbn_asm_src      => \"bn-mips.s mips-mont.s\",\n+\tbn_asm_src      => \"bn-mips.S mips-mont.S\",\n \taes_asm_src     => \"aes_cbc.c aes-mips.S\",\n \tsha1_asm_src    => \"sha1-mips.S sha256-mips.S\",\n     },\n@@ -243,6 +295,7 @@\n \tmodes_asm_src   => \"ghash-s390x.S\",\n \tchacha_asm_src  => \"chacha-s390x.S\",\n \tpoly1305_asm_src=> \"poly1305-s390x.S\",\n+\tkeccak1600_asm_src\t=> \"keccak1600-s390x.S\",\n     },\n     armv4_asm => {\n \ttemplate\t=> 1,\n@@ -254,6 +307,7 @@\n \tmodes_asm_src   => \"ghash-armv4.S ghashv8-armx.S\",\n \tchacha_asm_src  => \"chacha-armv4.S\",\n \tpoly1305_asm_src=> \"poly1305-armv4.S\", \n+\tkeccak1600_asm_src\t=> \"keccak1600-armv4.S\",\n \tperlasm_scheme\t=> \"void\"\n     },\n     aarch64_asm => {\n@@ -266,6 +320,7 @@\n \tmodes_asm_src   => \"ghashv8-armx.S\",\n \tchacha_asm_src  => \"chacha-armv8.S\",\n \tpoly1305_asm_src=> \"poly1305-armv8.S\",\n+\tkeccak1600_asm_src\t=> \"keccak1600-armv8.S\",\n     },\n     parisc11_asm => {\n \ttemplate\t=> 1,\n@@ -282,18 +337,20 @@\n \tinherit_from\t=> [ \"parisc11_asm\" ],\n \tperlasm_scheme\t=> \"64\",\n     },\n-    ppc64_asm => {\n+    ppc32_asm => {\n \ttemplate\t=> 1,\n \tcpuid_asm_src   => \"ppccpuid.s ppccap.c\",\n-\tbn_asm_src      => \"bn-ppc.s ppc-mont.s ppc64-mont.s\",\n+\tbn_asm_src      => \"bn-ppc.s ppc-mont.s\",\n \taes_asm_src     => \"aes_core.c aes_cbc.c aes-ppc.s vpaes-ppc.s aesp8-ppc.s\",\n \tsha1_asm_src    => \"sha1-ppc.s sha256-ppc.s sha512-ppc.s sha256p8-ppc.s sha512p8-ppc.s\",\n \tmodes_asm_src   => \"ghashp8-ppc.s\",\n \tchacha_asm_src\t=> \"chacha-ppc.s\",\n \tpoly1305_asm_src=> \"poly1305-ppc.s poly1305-ppcfp.s\",\n     },\n-    ppc32_asm => {\n-\tinherit_from\t=> [ \"ppc64_asm\" ],\n-\ttemplate\t=> 1\n+    ppc64_asm => {\n+\tinherit_from\t=> [ \"ppc32_asm\" ],\n+\ttemplate\t=> 1,\n+\tec_asm_src\t=> \"ecp_nistz256.c ecp_nistz256-ppc64.s x25519-ppc64.s\",\n+\tkeccak1600_asm_src\t=> \"keccak1600-ppc64.s\",\n     },\n );"
        },
        {
            "sha": "5cf345da0af09a9e1721f2cd657432631062c47d",
            "filename": "deps/openssl/openssl/Configurations/10-main.conf",
            "status": "modified",
            "additions": 661,
            "deletions": 731,
            "changes": 1392,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F10-main.conf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F10-main.conf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F10-main.conf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "10342ed5e3750d37161515604c22933a957dd5ed",
            "filename": "deps/openssl/openssl/Configurations/15-android.conf",
            "status": "added",
            "additions": 255,
            "deletions": 0,
            "changes": 255,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F15-android.conf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F15-android.conf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F15-android.conf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,255 @@\n+#### Android...\n+#\n+# See NOTES.ANDROID for details, and don't miss platform-specific\n+# comments below...\n+\n+{\n+    use File::Spec::Functions;\n+\n+    my $android_ndk = {};\n+    my %triplet = (\n+        arm    => \"arm-linux-androideabi\",\n+        arm64  => \"aarch64-linux-android\",\n+        mips   => \"mipsel-linux-android\",\n+        mips64 => \"mips64el-linux-android\",\n+        x86    => \"i686-linux-android\",\n+        x86_64 => \"x86_64-linux-android\",\n+    );\n+\n+    sub android_ndk {\n+        unless (%$android_ndk) {\n+            if ($now_printing =~ m|^android|) {\n+                return $android_ndk = { bn_ops => \"BN_AUTO\" };\n+            }\n+\n+            my $ndk = $ENV{ANDROID_NDK};\n+            die \"\\$ANDROID_NDK is not defined\"  if (!$ndk);\n+            if (!-d \"$ndk/platforms\" && !-f \"$ndk/AndroidVersion.txt\") {\n+                # $ndk/platforms is traditional \"all-inclusive\" NDK, while\n+                # $ndk/AndroidVersion.txt is so-called standalone toolchain\n+                # tailored for specific target down to API level.\n+                die \"\\$ANDROID_NDK=$ndk is invalid\";\n+            }\n+            $ndk = canonpath($ndk);\n+\n+            my $ndkver = undef;\n+\n+            if (open my $fh, \"<$ndk/source.properties\") {\n+                local $_;\n+                while(<$fh>) {\n+                    if (m|Pkg\\.Revision\\s*=\\s*([0-9]+)|) {\n+                        $ndkver = $1;\n+                        last;\n+                    }\n+                }\n+                close $fh;\n+            }\n+\n+            my ($sysroot, $api, $arch);\n+\n+            $config{target} =~ m|[^-]+-([^-]+)$|;\t# split on dash\n+            $arch = $1;\n+\n+            if ($sysroot = $ENV{CROSS_SYSROOT}) {\n+                $sysroot =~ m|/android-([0-9]+)/arch-(\\w+)/?$|;\n+                ($api, $arch) = ($1, $2);\n+            } elsif (-f \"$ndk/AndroidVersion.txt\") {\n+                $sysroot = \"$ndk/sysroot\";\n+            } else {\n+                $api = \"*\";\n+\n+                # see if user passed -D__ANDROID_API__=N\n+                foreach (@{$useradd{CPPDEFINES}}, @{$user{CPPFLAGS}}) {\n+                    if (m|__ANDROID_API__=([0-9]+)|) {\n+                        $api = $1;\n+                        last;\n+                    }\n+                }\n+\n+                # list available platforms (numerically)\n+                my @platforms = sort { $a =~ m/-([0-9]+)$/; my $aa = $1;\n+                                       $b =~ m/-([0-9]+)$/; $aa <=> $1;\n+                                     } glob(\"$ndk/platforms/android-$api\");\n+                die \"no $ndk/platforms/android-$api\" if ($#platforms < 0);\n+\n+                $sysroot = \"@platforms[$#platforms]/arch-$arch\";\n+                $sysroot =~ m|/android-([0-9]+)/arch-$arch|;\n+                $api = $1;\n+            }\n+            die \"no sysroot=$sysroot\"   if (!-d $sysroot);\n+\n+            my $triarch = $triplet{$arch};\n+            my $cflags;\n+            my $cppflags;\n+\n+            # see if there is NDK clang on $PATH, \"universal\" or \"standalone\"\n+            if (which(\"clang\") =~ m|^$ndk/.*/prebuilt/([^/]+)/|) {\n+                my $host=$1;\n+                # harmonize with gcc default\n+                my $arm = $ndkver > 16 ? \"armv7a\" : \"armv5te\";\n+                (my $tridefault = $triarch) =~ s/^arm-/$arm-/;\n+                (my $tritools   = $triarch) =~ s/(?:x|i6)86(_64)?-.*/x86$1/;\n+                $cflags .= \" -target $tridefault \"\n+                        .  \"-gcc-toolchain \\$(ANDROID_NDK)/toolchains\"\n+                        .  \"/$tritools-4.9/prebuilt/$host\";\n+                $user{CC} = \"clang\" if ($user{CC} !~ m|clang|);\n+                $user{CROSS_COMPILE} = undef;\n+                if (which(\"llvm-ar\") =~ m|^$ndk/.*/prebuilt/([^/]+)/|) {\n+                    $user{AR} = \"llvm-ar\";\n+                    $user{ARFLAGS} = [ \"rs\" ];\n+                    $user{RANLIB} = \":\";\n+                }\n+            } elsif (-f \"$ndk/AndroidVersion.txt\") {    #\"standalone toolchain\"\n+                my $cc = $user{CC} // \"clang\";\n+                # One can probably argue that both clang and gcc should be\n+                # probed, but support for \"standalone toolchain\" was added\n+                # *after* announcement that gcc is being phased out, so\n+                # favouring clang is considered adequate. Those who insist\n+                # have option to enforce test for gcc with CC=gcc.\n+                if (which(\"$triarch-$cc\") !~ m|^$ndk|) {\n+                    die \"no NDK $triarch-$cc on \\$PATH\";\n+                }\n+                $user{CC} = $cc;\n+                $user{CROSS_COMPILE} = \"$triarch-\";\n+            } elsif ($user{CC} eq \"clang\") {\n+                die \"no NDK clang on \\$PATH\";\n+            } else {\n+                if (which(\"$triarch-gcc\") !~ m|^$ndk/.*/prebuilt/([^/]+)/|) {\n+                    die \"no NDK $triarch-gcc on \\$PATH\";\n+                }\n+                $cflags .= \" -mandroid\";\n+                $user{CROSS_COMPILE} = \"$triarch-\";\n+            }\n+\n+            if (!-d \"$sysroot/usr/include\") {\n+                my $incroot = \"$ndk/sysroot/usr/include\";\n+                die \"no $incroot\"          if (!-d $incroot);\n+                die \"no $incroot/$triarch\" if (!-d \"$incroot/$triarch\");\n+                $incroot =~ s|^$ndk/||;\n+                $cppflags  = \"-D__ANDROID_API__=$api\";\n+                $cppflags .= \" -isystem \\$(ANDROID_NDK)/$incroot/$triarch\";\n+                $cppflags .= \" -isystem \\$(ANDROID_NDK)/$incroot\";\n+            }\n+\n+            $sysroot =~ s|^$ndk/||;\n+            $android_ndk = {\n+                cflags   => \"$cflags --sysroot=\\$(ANDROID_NDK)/$sysroot\",\n+                cppflags => $cppflags,\n+                bn_ops   => $arch =~ m/64$/ ? \"SIXTY_FOUR_BIT_LONG\"\n+                                            : \"BN_LLONG\",\n+            };\n+        }\n+\n+        return $android_ndk;\n+    }\n+}\n+\n+my %targets = (\n+    \"android\" => {\n+        inherit_from     => [ \"linux-generic32\" ],\n+        template         => 1,\n+        ################################################################\n+        # Special note about -pie. The underlying reason is that\n+        # Lollipop refuses to run non-PIE. But what about older systems\n+        # and NDKs? -fPIC was never problem, so the only concern is -pie.\n+        # Older toolchains, e.g. r4, appear to handle it and binaries\n+        # turn out mostly functional. \"Mostly\" means that oldest\n+        # Androids, such as Froyo, fail to handle executable, but newer\n+        # systems are perfectly capable of executing binaries targeting\n+        # Froyo. Keep in mind that in the nutshell Android builds are\n+        # about JNI, i.e. shared libraries, not applications.\n+        cflags           => add(sub { android_ndk()->{cflags} }),\n+        cppflags         => add(sub { android_ndk()->{cppflags} }),\n+        cxxflags         => add(sub { android_ndk()->{cflags} }),\n+        bn_ops           => sub { android_ndk()->{bn_ops} },\n+        bin_cflags       => \"-pie\",\n+        enable           => [ ],\n+    },\n+    \"android-arm\" => {\n+        ################################################################\n+        # Contemporary Android applications can provide multiple JNI\n+        # providers in .apk, targeting multiple architectures. Among\n+        # them there is \"place\" for two ARM flavours: generic eabi and\n+        # armv7-a/hard-float. However, it should be noted that OpenSSL's\n+        # ability to engage NEON is not constrained by ABI choice, nor\n+        # is your ability to call OpenSSL from your application code\n+        # compiled with floating-point ABI other than default 'soft'.\n+        # (Latter thanks to __attribute__((pcs(\"aapcs\"))) declaration.)\n+        # This means that choice of ARM libraries you provide in .apk\n+        # is driven by application needs. For example if application\n+        # itself benefits from NEON or is floating-point intensive, then\n+        # it might be appropriate to provide both libraries. Otherwise\n+        # just generic eabi would do. But in latter case it would be\n+        # appropriate to\n+        #\n+        #   ./Configure android-arm -D__ARM_MAX_ARCH__=8\n+        #\n+        # in order to build \"universal\" binary and allow OpenSSL take\n+        # advantage of NEON when it's available.\n+        #\n+        # Keep in mind that (just like with linux-armv4) we rely on\n+        # compiler defaults, which is not necessarily what you had\n+        # in mind, in which case you would have to pass additional\n+        # -march and/or -mfloat-abi flags. NDK defaults to armv5te.\n+        # Newer NDK versions reportedly require additional -latomic.\n+        #\n+        inherit_from     => [ \"android\", asm(\"armv4_asm\") ],\n+        bn_ops           => add(\"RC4_CHAR\"),\n+    },\n+    \"android-arm64\" => {\n+        inherit_from     => [ \"android\", asm(\"aarch64_asm\") ],\n+        bn_ops           => add(\"RC4_CHAR\"),\n+        perlasm_scheme   => \"linux64\",\n+    },\n+\n+    \"android-mips\" => {\n+        inherit_from     => [ \"android\", asm(\"mips32_asm\") ],\n+        bn_ops           => add(\"RC4_CHAR\"),\n+        perlasm_scheme   => \"o32\",\n+    },\n+    \"android-mips64\" => {\n+        ################################################################\n+        # You are more than likely have to specify target processor\n+        # on ./Configure command line. Trouble is that toolchain's\n+        # default is MIPS64r6 (at least in r10d), but there are no\n+        # such processors around (or they are too rare to spot one).\n+        # Actual problem is that MIPS64r6 is binary incompatible\n+        # with previous MIPS ISA versions, in sense that unlike\n+        # prior versions original MIPS binary code will fail.\n+        #\n+        inherit_from     => [ \"android\", asm(\"mips64_asm\") ],\n+        bn_ops           => add(\"RC4_CHAR\"),\n+        perlasm_scheme   => \"64\",\n+    },\n+\n+    \"android-x86\" => {\n+        inherit_from     => [ \"android\", asm(\"x86_asm\") ],\n+        CFLAGS           => add(picker(release => \"-fomit-frame-pointer\")),\n+        bn_ops           => add(\"RC4_INT\"),\n+        perlasm_scheme   => \"android\",\n+    },\n+    \"android-x86_64\" => {\n+        inherit_from     => [ \"android\", asm(\"x86_64_asm\") ],\n+        bn_ops           => add(\"RC4_INT\"),\n+        perlasm_scheme   => \"elf\",\n+    },\n+\n+    ####################################################################\n+    # Backward compatible targets, (might) requre $CROSS_SYSROOT\n+    #\n+    \"android-armeabi\" => {\n+        inherit_from     => [ \"android-arm\" ],\n+    },\n+    \"android64\" => {\n+        inherit_from     => [ \"android\" ],\n+    },\n+    \"android64-aarch64\" => {\n+        inherit_from     => [ \"android-arm64\" ],\n+    },\n+    \"android64-x86_64\" => {\n+        inherit_from     => [ \"android-x86_64\" ],\n+    },\n+    \"android64-mips64\" => {\n+        inherit_from     => [ \"android-mips64\" ],\n+    },\n+);"
        },
        {
            "sha": "1bb9f48d0650524218fa475d1efa6181b2a25cdc",
            "filename": "deps/openssl/openssl/Configurations/15-ios.conf",
            "status": "added",
            "additions": 62,
            "deletions": 0,
            "changes": 62,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F15-ios.conf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F15-ios.conf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F15-ios.conf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,62 @@\n+#### iPhoneOS/iOS\n+#\n+# It takes recent enough XCode to use following two targets. It shouldn't\n+# be a problem by now, but if they don't work, original targets below\n+# that depend on manual definition of environment variables should still\n+# work...\n+#\n+my %targets = (\n+    \"ios-common\" => {\n+        template         => 1,\n+        inherit_from     => [ \"darwin-common\" ],\n+        sys_id           => \"iOS\",\n+        disable          => [ \"engine\", \"async\" ],\n+    },\n+    \"ios-xcrun\" => {\n+        inherit_from     => [ \"ios-common\", asm(\"armv4_asm\") ],\n+        # It should be possible to go below iOS 6 and even add -arch armv6,\n+        # thus targeting iPhone pre-3GS, but it's assumed to be irrelevant\n+        # at this point.\n+        CC               => \"xcrun -sdk iphoneos cc\",\n+        cflags           => add(\"-arch armv7 -mios-version-min=6.0.0 -fno-common\"),\n+        perlasm_scheme   => \"ios32\",\n+    },\n+    \"ios64-xcrun\" => {\n+        inherit_from     => [ \"ios-common\", asm(\"aarch64_asm\") ],\n+        CC               => \"xcrun -sdk iphoneos cc\",\n+        cflags           => add(\"-arch arm64 -mios-version-min=7.0.0 -fno-common\"),\n+        bn_ops           => \"SIXTY_FOUR_BIT_LONG RC4_CHAR\",\n+        perlasm_scheme   => \"ios64\",\n+    },\n+    \"iossimulator-xcrun\" => {\n+        inherit_from     => [ \"ios-common\" ],\n+        CC               => \"xcrun -sdk iphonesimulator cc\",\n+    },\n+# It takes three prior-set environment variables to make it work:\n+#\n+# CROSS_COMPILE=/where/toolchain/is/usr/bin/ [note ending slash]\n+# CROSS_TOP=/where/SDKs/are\n+# CROSS_SDK=iPhoneOSx.y.sdk\n+#\n+# Exact paths vary with Xcode releases, but for couple of last ones\n+# they would look like this:\n+#\n+# CROSS_COMPILE=`xcode-select --print-path`/Toolchains/XcodeDefault.xctoolchain/usr/bin/\n+# CROSS_TOP=`xcode-select --print-path`/Platforms/iPhoneOS.platform/Developer\n+# CROSS_SDK=iPhoneOS.sdk\n+#\n+    \"iphoneos-cross\" => {\n+        inherit_from     => [ \"ios-common\" ],\n+        cflags           => add(\"-isysroot \\$(CROSS_TOP)/SDKs/\\$(CROSS_SDK) -fno-common\"),\n+    },\n+    \"ios-cross\" => {\n+        inherit_from     => [ \"ios-xcrun\" ],\n+        CC               => \"cc\",\n+        cflags           => add(\"-isysroot \\$(CROSS_TOP)/SDKs/\\$(CROSS_SDK)\"),\n+    },\n+    \"ios64-cross\" => {\n+        inherit_from     => [ \"ios64-xcrun\" ],\n+        CC               => \"cc\",\n+        cflags           => add(\"-isysroot \\$(CROSS_TOP)/SDKs/\\$(CROSS_SDK)\"),\n+    },\n+);"
        },
        {
            "sha": "a8853a81a1465189515f3afa01bdb85b8375760e",
            "filename": "deps/openssl/openssl/Configurations/50-djgpp.conf",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-djgpp.conf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-djgpp.conf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-djgpp.conf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -2,13 +2,15 @@\n # and rely entirely on the OpenSSL community to help is fine\n # tune and test.\n \n-%targets = (\n+my %targets = (\n     \"DJGPP\" => {\n         inherit_from     => [ asm(\"x86_asm\") ],\n-        cc               => \"gcc\",\n-        cflags           => \"-I/dev/env/WATT_ROOT/inc -DTERMIOS -DL_ENDIAN -fomit-frame-pointer -O2 -Wall\",\n+        CC               => \"gcc\",\n+        CFLAGS           => \"-fomit-frame-pointer -O2 -Wall\",\n+        cflags           => \"-I/dev/env/WATT_ROOT/inc -DTERMIOS -DL_ENDIAN\",\n         sys_id           => \"MSDOS\",\n-        ex_libs          => add(\"-L/dev/env/WATT_ROOT/lib -lwatt\"),\n+        lflags           => add(\"-L/dev/env/WATT_ROOT/lib\"),\n+        ex_libs          => add(\"-lwatt\"),\n         bn_ops           => \"BN_LLONG\",\n         perlasm_scheme   => \"a.out\",\n     },"
        },
        {
            "sha": "cd6d10e5f082607c153dfa9d1613e757ecf070ab",
            "filename": "deps/openssl/openssl/Configurations/50-haiku.conf",
            "status": "modified",
            "additions": 7,
            "deletions": 6,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-haiku.conf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-haiku.conf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-haiku.conf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,10 +1,11 @@\n-%targets = (\n+my %targets = (\n     \"haiku-common\" => {\n         template         => 1,\n-        cc               => \"cc\",\n-        cflags           => add_before(picker(default => \"-DL_ENDIAN -Wall -include \\$(SRCDIR)/os-dep/haiku.h\",\n+        CC               => \"cc\",\n+        CFLAGS           => add_before(picker(default => \"-Wall\",\n                                               debug   => \"-g -O0\",\n-                                              release => \"-O2\"),\n+                                              release => \"-O2\")),\n+        cflags           => add_before(\"-DL_ENDIAN -include \\$(SRCDIR)/os-dep/haiku.h\",\n                                        threads(\"-D_REENTRANT\")),\n         sys_id           => \"HAIKU\",\n         ex_libs          => \"-lnetwork\",\n@@ -14,11 +15,11 @@\n         shared_target    => \"gnu-shared\",\n         shared_cflag     => \"-fPIC\",\n         shared_ldflag    => \"-shared\",\n-        shared_extension => \".so.\\$(SHLIB_MAJOR).\\$(SHLIB_MINOR)\",\n+        shared_extension => \".so.\\$(SHLIB_VERSION_NUMBER)\",\n     },\n     \"haiku-x86\" => {\n         inherit_from     => [ \"haiku-common\", asm(\"x86_elf_asm\") ],\n-        cflags           => add(picker(release => \"-fomit-frame-pointer\")),\n+        CFLAGS           => add(picker(release => \"-fomit-frame-pointer\")),\n         bn_ops           => \"BN_LLONG\",\n     },\n     \"haiku-x86_64\" => {"
        },
        {
            "sha": "2c55dddc2a0fb4e41d5f025dfe4b9a0130f713d9",
            "filename": "deps/openssl/openssl/Configurations/50-masm.conf",
            "status": "modified",
            "additions": 10,
            "deletions": 4,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-masm.conf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-masm.conf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-masm.conf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -7,11 +7,17 @@\n # proven to be daunting task. This is experimental target, for\n # production builds stick with [up-to-date version of] nasm.\n \n-%targets = (\n+my %targets = (\n     \"VC-WIN64A-masm\" => {\n-        inherit_from    => [ \"VC-WIN64A\" ],\n-        as              => \"ml64\",\n-        asflags         => \"/c /Cp /Cx /Zi\",\n+        inherit_from    => [ \"VC-WIN64-common\", asm(\"x86_64_asm\"),\n+                             sub { $disabled{shared} ? () : \"x86_64_uplink\" } ],\n+        AS              => \"ml64\",\n+        ASFLAGS         => \"/nologo /Zi\",\n         asoutflag       => \"/Fo\",\n+        asflags         => \"/c /Cp /Cx\",\n+        sys_id          => \"WIN64A\",\n+        bn_asm_src      => sub { return undef unless @_;\n+                                 my $r=join(\" \",@_); $r=~s|asm/x86_64-gcc|bn_asm|; $r; },\n+        perlasm_scheme   => \"masm\",\n     },\n );"
        },
        {
            "sha": "c71d3646f23e03516f257f6a18d542197c9cb874",
            "filename": "deps/openssl/openssl/Configurations/50-win-onecore.conf",
            "status": "added",
            "additions": 64,
            "deletions": 0,
            "changes": 64,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-win-onecore.conf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-win-onecore.conf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2F50-win-onecore.conf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,64 @@\n+# Windows OneCore targets.\n+#\n+# OneCore is new API stability \"contract\" that transends Desktop, IoT and\n+# Mobile[?] Windows editions. It's a set up \"umbrella\" libraries that\n+# export subset of Win32 API that are common to all Windows 10 devices.\n+#\n+# OneCore Configuration temporarly dedicated for console applications \n+# due to disabled event logging, which is incompatible with one core.\n+# Error messages are provided via standard error only.\n+# TODO: extend error handling to use ETW based eventing\n+# (Or rework whole error messaging)\n+\n+my %targets = (\n+    \"VC-WIN32-ONECORE\" => {\n+        inherit_from    => [ \"VC-WIN32\" ],\n+        # /NODEFAULTLIB:kernel32.lib is needed, because MSVCRT.LIB has\n+        # hidden reference to kernel32.lib, but we don't actually want\n+        # it in \"onecore\" build.\n+        lflags          => add(\"/NODEFAULTLIB:kernel32.lib\"),\n+        defines         => add(\"OPENSSL_SYS_WIN_CORE\"),\n+        ex_libs         => \"onecore.lib\",\n+    },\n+    \"VC-WIN64A-ONECORE\" => {\n+        inherit_from    => [ \"VC-WIN64A\" ],\n+        lflags          => add(\"/NODEFAULTLIB:kernel32.lib\"),\n+        defines         => add(\"OPENSSL_SYS_WIN_CORE\"),\n+        ex_libs         => \"onecore.lib\",\n+    },\n+\n+    # Windows on ARM targets. ARM compilers are additional components in\n+    # VS2017, i.e. they are not installed by default. And when installed,\n+    # there are no \"ARM Tool Command Prompt\"s on Start menu, you have\n+    # to locate vcvarsall.bat and act accordingly. VC-WIN32-ARM has\n+    # received limited testing with evp_test.exe on Windows 10 IoT Core,\n+    # but not VC-WIN64-ARM, no hardware... In other words they are not\n+    # actually supported...\n+    #\n+    # Another thing to keep in mind [in cross-compilation scenario such\n+    # as this one] is that target's file system has nothing to do with\n+    # compilation system's one. This means that you're are likely to use\n+    # --prefix and --openssldir with target-specific values. 'nmake install'\n+    # step is effectively meaningless in cross-compilation case, though\n+    # it might be useful to 'nmake install DESTDIR=S:\\ome\\where' where you\n+    # can point Visual Studio to when compiling custom application code.\n+\n+    \"VC-WIN32-ARM\" => {\n+        inherit_from    => [ \"VC-noCE-common\" ],\n+        defines         => add(\"_ARM_WINAPI_PARTITION_DESKTOP_SDK_AVAILABLE\",\n+                               \"OPENSSL_SYS_WIN_CORE\"),\n+        bn_ops          => \"BN_LLONG RC4_CHAR EXPORT_VAR_AS_FN\",\n+        lflags          => add(\"/NODEFAULTLIB:kernel32.lib\"),\n+        ex_libs         => \"onecore.lib\",\n+        multilib        => \"-arm\",\n+    },\n+    \"VC-WIN64-ARM\" => {\n+        inherit_from    => [ \"VC-noCE-common\" ],\n+        defines         => add(\"_ARM_WINAPI_PARTITION_DESKTOP_SDK_AVAILABLE\",\n+                               \"OPENSSL_SYS_WIN_CORE\"),\n+        bn_ops          => \"SIXTY_FOUR_BIT RC4_CHAR EXPORT_VAR_AS_FN\",\n+        lflags          => add(\"/NODEFAULTLIB:kernel32.lib\"),\n+        ex_libs         => \"onecore.lib\",\n+        multilib        => \"-arm64\",\n+    },\n+);"
        },
        {
            "sha": "d2d893d8d2fe1c6d6dd80c0954d97214339de4ca",
            "filename": "deps/openssl/openssl/Configurations/README",
            "status": "modified",
            "additions": 85,
            "deletions": 43,
            "changes": 128,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2FREADME",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2FREADME",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2FREADME?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -38,41 +38,78 @@ In each table entry, the following keys are significant:\n         sys_id          => System identity for systems where that\n                            is difficult to determine automatically.\n \n-        cc              => The compiler command, usually one of \"cc\",\n+        enable          => Enable specific configuration features.\n+                           This MUST be an array of words.\n+        disable         => Disable specific configuration features.\n+                           This MUST be an array of words.\n+                           Note: if the same feature is both enabled\n+                           and disabled, disable wins.\n+\n+        as              => The assembler command.  This is not always\n+                           used (for example on Unix, where the C\n+                           compiler is used instead).\n+        asflags         => Default assembler command flags [4].\n+        cpp             => The C preprocessor command, normally not\n+                           given, as the build file defaults are\n+                           usually good enough.\n+        cppflags        => Default C preprocessor flags [4].\n+        defines         => As an alternative, macro definitions may be\n+                           given here instead of in `cppflags' [4].\n+                           If given here, they MUST be as an array of\n+                           the string such as \"MACRO=value\", or just\n+                           \"MACRO\" for definitions without value.\n+        includes        => As an alternative, inclusion directories\n+                           may be given here instead of in `cppflags'\n+                           [4].  If given here, the MUST be an array\n+                           of strings, one directory specification\n+                           each.\n+        cc              => The C compiler command, usually one of \"cc\",\n                            \"gcc\" or \"clang\".  This command is normally\n                            also used to link object files and\n                            libraries into the final program.\n-        cflags          => Flags that are used at all times when\n-                           compiling.\n-        defines         => As an alternative, macro definitions may be\n-                           present here instead of in `cflags'.  If\n-                           given here, they MUST be as an array of the\n-                           string such as \"MACRO=value\", or just\n-                           \"MACRO\" for definitions without value.\n-        shared_cflag    => Extra compilation flags used when\n-                           compiling for shared libraries, typically\n-                           something like \"-fPIC\".\n+        cxx             => The C++ compiler command, usually one of\n+                           \"c++\", \"g++\" or \"clang++\".  This command is\n+                           also used when linking a program where at\n+                           least one of the object file is made from\n+                           C++ source.\n+        cflags          => Defaults C compiler flags [4].\n+        cxxflags        => Default  C++ compiler flags [4].  If unset,\n+                           it gets the same value as cflags.\n \n         (linking is a complex thing, see [3] below)\n         ld              => Linker command, usually not defined\n                            (meaning the compiler command is used\n                            instead).\n                            (NOTE: this is here for future use, it's\n                            not implemented yet)\n-        lflags          => Flags that are used when linking apps.\n-        shared_ldflag   => Flags that are used when linking shared\n-                           or dynamic libraries.\n-        plib_lflags     => Extra linking flags to appear just before\n-                           the libraries on the command line.\n+        lflags          => Default flags used when linking apps,\n+                           shared libraries or DSOs [4].\n         ex_libs         => Extra libraries that are needed when\n-                           linking.\n+                           linking shared libraries, DSOs or programs.\n+                           The value is also assigned to Libs.private\n+                           in $(libdir)/pkgconfig/libcrypto.pc.\n+\n+        shared_cppflags => Extra C preprocessor flags used when\n+                           processing C files for shared libraries.\n+        shared_cflag    => Extra C compiler flags used when compiling\n+                           for shared libraries, typically something\n+                           like \"-fPIC\".\n+        shared_ldflag   => Extra linking flags used when linking\n+                           shared libraries.\n+        module_cppflags\n+        module_cflags\n+        module_ldflags  => Has the same function as the corresponding\n+                           `shared_' attributes, but for building DSOs.\n+                           When unset, they get the same values as the\n+                           corresponding `shared_' attributes.\n \n         ar              => The library archive command, the default is\n                            \"ar\".\n                            (NOTE: this is here for future use, it's\n                            not implemented yet)\n         arflags         => Flags to be used with the library archive\n-                           command.\n+                           command.  On Unix, this includes the\n+                           command letter, 'r' by default.\n \n         ranlib          => The library archive indexing command, the\n                            default is 'ranlib' it it exists.\n@@ -128,7 +165,7 @@ In each table entry, the following keys are significant:\n                            that use dlopen() et al but do not have\n                            fcntl.h), \"DL\" (shl_load() et al), \"WIN32\"\n                            and \"VMS\".\n-        perlasm_scheme  => The perlasm method used to created the\n+        perlasm_scheme  => The perlasm method used to create the\n                            assembler files used when compiling with\n                            assembler implementations.\n         shared_target   => The shared library building method used.\n@@ -189,8 +226,14 @@ In each table entry, the following keys are significant:\n                                                 export vars as\n                                                 accessor functions.\n \n-        apps_extra_src  => Extra source to build apps/openssl, as\n-                           needed by the target.\n+        apps_aux_src    => Extra source to build apps/openssl and other\n+                           apps, as needed by the target and that can be\n+                           collected in a library.\n+        apps_init_src   => Init source to build apps/openssl and other\n+                           apps, as needed by the target.  This code\n+                           cannot be placed in a library, as the rest\n+                           of the code isn't expected to link to it\n+                           explicitly.\n         cpuid_asm_src   => assembler implementation of cpuid code as\n                            well as OPENSSL_cleanse().\n                            Default to mem_clr.c\n@@ -308,18 +351,20 @@ In each table entry, the following keys are significant:\n     of this file):\n \n     shared libraries:\n-        {ld} $(CFLAGS) {shared_ldflag} -shared -o libfoo.so \\\n-            -Wl,--whole-archive libfoo.a -Wl,--no-whole-archive \\\n-            {plib_lflags} -lcrypto {ex_libs}\n+        {ld} $(CFLAGS) {lflags} {shared_ldflag} -o libfoo.so \\\n+            foo/something.o foo/somethingelse.o {ex_libs}\n \n     shared objects:\n-        {ld} $(CFLAGS) {shared_ldflag} -shared -o libeng.so \\\n-            blah1.o blah2.o {plib_lflags} -lcrypto {ex_libs}\n+        {ld} $(CFLAGS) {lflags} {module_ldflags} -o libeng.so \\\n+            blah1.o blah2.o -lcrypto {ex_libs}\n \n     applications:\n         {ld} $(CFLAGS) {lflags} -o app \\\n-            app1.o utils.o {plib_lflags} -lssl -lcrypto {ex_libs}\n+            app1.o utils.o -lssl -lcrypto {ex_libs}\n \n+[4] There are variants of these attribute, prefixed with `lib_',\n+    `dso_' or `bin_'.  Those variants replace the unprefixed attribute\n+    when building library, DSO or program modules specifically.\n \n Historically, the target configurations came in form of a string with\n values separated by colons.  This use is deprecated.  The string form\n@@ -377,14 +422,16 @@ source as well.  However, the files given through SOURCE are expected\n to be located in the source tree while files given through DEPEND are\n expected to be located in the build tree)\n \n-For some libraries, we maintain files with public symbols and their\n-slot in a transfer vector (important on some platforms).  It can be\n-declared like this:\n+It's also possible to depend on static libraries explicitly:\n \n-    ORDINALS[libcrypto]=crypto\n+    DEPEND[foo]=libsomething.a\n+    DEPEND[libbar]=libsomethingelse.a\n \n-The value is not the name of the file in question, but rather the\n-argument to util/mkdef.pl that indicates which file to use.\n+This should be rarely used, and care should be taken to make sure it's\n+only used when supported.  For example, native Windows build doesn't\n+support building static libraries and DLLs at the same time, so using\n+static libraries on Windows can only be done when configured\n+'no-shared'.\n \n One some platforms, shared libraries come with a name that's different\n from their static counterpart.  That's declared as follows:\n@@ -398,7 +445,7 @@ library:\n \n     RENAME[libfoo]=libbar\n \n-That lines has \"libfoo\" get renamed to \"libbar\".  While it makes no\n+That line has \"libfoo\" renamed to \"libbar\".  While it makes no\n sense at all to just have a rename like that (why not just use\n \"libbar\" everywhere?), it does make sense when it can be used\n conditionally.  See a little further below for an example.\n@@ -420,8 +467,8 @@ others, that's done as follows:\n     GENERATE[bar.s]=asm/bar.S\n \n The value of each GENERATE line is a command line or part of it.\n-Configure places no rules on the command line, except the the first\n-item muct be the generator file.  It is, however, entirely up to the\n+Configure places no rules on the command line, except that the first\n+item must be the generator file.  It is, however, entirely up to the\n build file template to define exactly how those command lines should\n be handled, how the output is captured and so on.\n \n@@ -623,8 +670,7 @@ They are all expected to return a string with the lines they produce.\n                         libobj2shlib(shlib => \"PATH/TO/shlibfile\",\n                                      lib => \"PATH/TO/libfile\",\n                                      objs => [ \"PATH/TO/objectfile\", ... ],\n-                                     deps => [ \"PATH/TO/otherlibfile\", ... ],\n-                                     ordinals => [ \"word\", \"/PATH/TO/ordfile\" ]);\n+                                     deps => [ \"PATH/TO/otherlibfile\", ... ]);\n \n                   'lib' has the intended library file name *without*\n                   extension, libobj2shlib is expected to add that.\n@@ -633,11 +679,7 @@ They are all expected to return a string with the lines they produce.\n                   libraries (also *without* extension) this library\n                   needs to be linked with.  'objs' has the list of\n                   object files (also *without* extension) to build\n-                  this library.  'ordinals' MAY be present, and when\n-                  it is, its value is an array where the word is\n-                  \"crypto\" or \"ssl\" and the file is one of the ordinal\n-                  files util/libeay.num or util/ssleay.num in the\n-                  source directory.\n+                  this library.\n \n                   This function has a choice; it can use the\n                   corresponding static library as input to make the"
        },
        {
            "sha": "cae08fc249627cc6bedda084a1f023bda85d3951",
            "filename": "deps/openssl/openssl/Configurations/README.design",
            "status": "modified",
            "additions": 31,
            "deletions": 49,
            "changes": 80,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2FREADME.design",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2FREADME.design",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2FREADME.design?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -41,10 +41,9 @@ end products.  There are variants for them with '_NO_INST' as suffix\n (PROGRAM_NO_INST etc) to specify end products that shouldn't get\n installed.\n \n-The variables SOURCE, DEPEND, INCLUDE and ORDINALS are indexed by a\n-produced file, and their values are the source used to produce that\n-particular produced file, extra dependencies, include directories\n-needed, and ordinal files (explained further below.\n+The variables SOURCE, DEPEND and INCLUDE are indexed by a produced\n+file, and their values are the source used to produce that particular\n+produced file, extra dependencies, and include directories needed.\n \n All their values in all the build.info throughout the source tree are\n collected together and form a set of programs, libraries, engines and\n@@ -57,18 +56,15 @@ dependencies.\n \n     # build.info\n     LIBS=libcrypto libssl\n-    ORDINALS[libcrypto]=crypto\n-    ORDINALS[libssl]=ssl\n     INCLUDE[libcrypto]=include\n     INCLUDE[libssl]=include\n     DEPEND[libssl]=libcrypto\n \n This is the top directory build.info file, and it tells us that two\n-libraries are to be built, there are some ordinals to be used to\n-declare what symbols in those libraries are seen as public, the\n-include directory 'include/' shall be used throughout when building\n-anything that will end up in each library, and that the library\n-'libssl' depend on the library 'libcrypto' to function properly.\n+libraries are to be built, the include directory 'include/' shall be\n+used throughout when building anything that will end up in each\n+library, and that the library 'libssl' depend on the library\n+'libcrypto' to function properly.\n \n     # apps/build.info\n     PROGRAMS=openssl\n@@ -133,7 +129,7 @@ library 'libssl' is built from the source file 'ssl/tls.c'.\n \n     ENGINES_NO_INST=ossltest\n     SOURCE[ossltest]=e_ossltest.c\n-    DEPEND[ossltest]=../libcrypto\n+    DEPEND[ossltest]=../libcrypto.a\n     INCLUDE[ossltest]=../include\n \n This is the build.info file in 'engines/', telling us that two engines\n@@ -142,18 +138,17 @@ dasync's source is 'engines/e_dasync.c' and ossltest's source is\n 'engines/e_ossltest.c' and that the include directory 'include/' may\n be used when building anything that will be part of these engines.\n Also, both engines depend on the library 'libcrypto' to function\n-properly.  Finally, only dasync is being installed, as ossltest is\n-only for internal testing.\n+properly.  ossltest is explicitly linked with the static variant of\n+the library 'libcrypto'.  Finally, only dasync is being installed, as\n+ossltest is only for internal testing.\n \n When Configure digests these build.info files, the accumulated\n information comes down to this:\n \n     LIBS=libcrypto libssl\n-    ORDINALS[libcrypto]=crypto\n     SOURCE[libcrypto]=crypto/aes.c crypto/evp.c crypto/cversion.c\n     DEPEND[crypto/cversion.o]=crypto/buildinf.h\n     INCLUDE[libcrypto]=include\n-    ORDINALS[libssl]=ssl\n     SOURCE[libssl]=ssl/tls.c\n     INCLUDE[libssl]=include\n     DEPEND[libssl]=libcrypto\n@@ -170,7 +165,7 @@ information comes down to this:\n \n     ENGINES_NO_INST=engines/ossltest\n     SOURCE[engines/ossltest]=engines/e_ossltest.c\n-    DEPEND[engines/ossltest]=libcrypto\n+    DEPEND[engines/ossltest]=libcrypto.a\n     INCLUDE[engines/ossltest]=include\n     \n     GENERATE[crypto/buildinf.h]=util/mkbuildinf.pl \"$(CC) $(CFLAGS)\" \"$(PLATFORM)\"\n@@ -186,9 +181,9 @@ PROGRAMS may be used to declare programs only.\n \n ENGINES may be used to declare engines only.\n \n-The indexes for SOURCE and ORDINALS must only be end product files,\n-such as libraries, programs or engines.  The values of SOURCE\n-variables must only be source files (possibly generated)\n+The indexes for SOURCE must only be end product files, such as\n+libraries, programs or engines.  The values of SOURCE variables must\n+only be source files (possibly generated).\n \n INCLUDE and DEPEND shows a relationship between different files\n (usually produced files) or between files and directories, such as a\n@@ -235,12 +230,6 @@ indexes:\n   libraries => a list of libraries.  These are directly inferred from\n                the LIBS variable in build.info files.\n \n-  ordinals  => a hash table containing 'file' => [ 'word', 'ordfile' ]\n-               pairs.  'file' and 'word' are directly inferred from\n-               the ORDINALS variables in build.info files, while the\n-               file 'ofile' comes from internal knowledge in\n-               Configure.\n-\n   programs  => a list of programs.  These are directly inferred from\n                the PROGRAMS variable in build.info files.\n \n@@ -281,10 +270,14 @@ section above would be digested into a %unified_info table:\n                     [\n                         \"crypto/buildinf.h\",\n                     ],\n-                \"engines/ossltest\" =>\n+                \"engines/dasync\" =>\n                     [\n                         \"libcrypto\",\n                     ],\n+                \"engines/ossltest\" =>\n+                    [\n+                        \"libcrypto.a\",\n+                    ],\n                 \"libssl\" =>\n                     [\n                         \"libcrypto\",\n@@ -354,19 +347,6 @@ section above would be digested into a %unified_info table:\n                 \"libcrypto\",\n                 \"libssl\",\n             ],\n-        \"ordinals\" =>\n-            {\n-                \"libcrypto\" =>\n-                    [\n-                        \"crypto\",\n-                        \"util/libcrypto.num\",\n-                    ],\n-                \"libssl\" =>\n-                    [\n-                        \"ssl\",\n-                        \"util/libssl.num\",\n-                    ],\n-            },\n         \"programs\" =>\n             [\n                 \"apps/openssl\",\n@@ -396,6 +376,14 @@ section above would be digested into a %unified_info table:\n                     [\n                         \"crypto/evp.c\",\n                     ],\n+                \"engines/e_dasync.o\" =>\n+                    [\n+                        \"engines/e_dasync.c\",\n+                    ],\n+                \"engines/dasync\" =>\n+                    [\n+                        \"engines/e_dasync.o\",\n+                    ],\n                 \"engines/e_ossltest.o\" =>\n                     [\n                         \"engines/e_ossltest.c\",\n@@ -517,8 +505,7 @@ etc.\n                         libobj2shlib(shlib => \"PATH/TO/shlibfile\",\n                                      lib => \"PATH/TO/libfile\",\n                                      objs => [ \"PATH/TO/objectfile\", ... ],\n-                                     deps => [ \"PATH/TO/otherlibfile\", ... ],\n-                                     ordinals => [ \"word\", \"/PATH/TO/ordfile\" ]);\n+                                     deps => [ \"PATH/TO/otherlibfile\", ... ]);\n \n                   'lib' has the intended library file name *without*\n                   extension, libobj2shlib is expected to add that.\n@@ -527,11 +514,7 @@ etc.\n                   libraries (also *without* extension) this library\n                   needs to be linked with.  'objs' has the list of\n                   object files (also *without* extension) to build\n-                  this library.  'ordinals' MAY be present, and when\n-                  it is, its value is an array where the word is\n-                  \"crypto\" or \"ssl\" and the file is one of the ordinal\n-                  files util/libcrypto.num or util/libssl.num in the\n-                  source directory.\n+                  this library.\n \n                   This function has a choice; it can use the\n                   corresponding static library as input to make the\n@@ -604,8 +587,7 @@ following calls:\n     libobj2shlib(shlib => \"libcrypto\",\n                  lib => \"libcrypto\",\n                  objs => [ \"crypto/aes\", \"crypto/evp\", \"crypto/cversion\" ],\n-                 deps => [  ]\n-                 ordinals => [ \"crypto\", \"util/libcrypto.num\" ]);\n+                 deps => [  ]);\n \n     obj2lib(lib => \"libcrypto\"\n             objs => [ \"crypto/aes\", \"crypto/evp\", \"crypto/cversion\" ]);"
        },
        {
            "sha": "3a466eeb680c9721cfea291dd0a1bee7bc8a6da8",
            "filename": "deps/openssl/openssl/Configurations/common.tmpl",
            "status": "modified",
            "additions": 63,
            "deletions": 71,
            "changes": 134,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fcommon.tmpl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fcommon.tmpl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fcommon.tmpl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -9,15 +9,23 @@\n  # there are no duplicate dependencies and that they are in the\n  # right order.  This is especially used to sort the list of\n  # libraries that a build depends on.\n+ sub extensionlesslib {\n+     my @result = map { $_ =~ /(\\.a)?$/; $` } @_;\n+     return @result if wantarray;\n+     return $result[0];\n+ }\n  sub resolvedepends {\n      my $thing = shift;\n+     my $extensionlessthing = extensionlesslib($thing);\n      my @listsofar = @_;    # to check if we're looping\n-     my @list = @{$unified_info{depends}->{$thing}};\n+     my @list = @{$unified_info{depends}->{$thing} //\n+                      $unified_info{depends}->{$extensionlessthing}};\n      my @newlist = ();\n      if (scalar @list) {\n          foreach my $item (@list) {\n+             my $extensionlessitem = extensionlesslib($item);\n              # It's time to break off when the dependency list starts looping\n-             next if grep { $_ eq $item } @listsofar;\n+             next if grep { extensionlesslib($_) eq $extensionlessitem } @listsofar;\n              push @newlist, $item, resolvedepends($item, @listsofar, $item);\n          }\n      }\n@@ -26,12 +34,34 @@\n  sub reducedepends {\n      my @list = @_;\n      my @newlist = ();\n+     my %replace = ();\n      while (@list) {\n          my $item = shift @list;\n-         push @newlist, $item\n-             unless grep { $item eq $_ } @list;\n+         my $extensionlessitem = extensionlesslib($item);\n+         if (grep { $extensionlessitem eq extensionlesslib($_) } @list) {\n+             if ($item ne $extensionlessitem) {\n+                 # If this instance of the library is explicitly static, we\n+                 # prefer that to any shared library name, since it must have\n+                 # been done on purpose.\n+                 $replace{$extensionlessitem} = $item;\n+             }\n+         } else {\n+             push @newlist, $item;\n+         }\n      }\n-     @newlist;\n+     map { $replace{$_} // $_; } @newlist;\n+ }\n+\n+ # is_installed checks if a given file will be installed (i.e. they are\n+ # not defined _NO_INST in build.info)\n+ sub is_installed {\n+     my $product = shift;\n+     if (grep { $product eq $_ }\n+         map { (@{$unified_info{install}->{$_}}) }\n+         keys %{$unified_info{install}}) {\n+         return 1;\n+     }\n+     return 0;\n  }\n \n  # dogenerate is responsible for producing all the recipes that build\n@@ -66,11 +96,11 @@\n  sub doobj {\n      my $obj = shift;\n      return \"\" if $cache{$obj};\n-     (my $obj_no_o = $obj) =~ s|\\.o$||;\n      my $bin = shift;\n      my %opts = @_;\n      if (@{$unified_info{sources}->{$obj}}) {\n-         $OUT .= src2obj(obj => $obj_no_o,\n+         $OUT .= src2obj(obj => $obj,\n+                         product => $bin,\n                          srcs => $unified_info{sources}->{$obj},\n                          deps => $unified_info{depends}->{$obj},\n                          incs => $unified_info{includes}->{$obj},\n@@ -90,26 +120,28 @@\n  sub dolib {\n      my $lib = shift;\n      return \"\" if $cache{$lib};\n-     unless ($disabled{shared}) {\n-         my %ordinals =\n-             $unified_info{ordinals}->{$lib}\n-             ? (ordinals => $unified_info{ordinals}->{$lib}) : ();\n+     unless ($disabled{shared} || $lib =~ /\\.a$/) {\n          $OUT .= libobj2shlib(shlib => $unified_info{sharednames}->{$lib},\n                               lib => $lib,\n-                              objs => [ map { (my $x = $_) =~ s|\\.o$||; $x }\n-                                        (@{$unified_info{sources}->{$lib}},\n-                                         @{$unified_info{shared_sources}->{$lib}}) ],\n+                              objs => [ @{$unified_info{shared_sources}->{$lib}},\n+                                        @{$unified_info{sources}->{$lib}} ],\n                               deps => [ reducedepends(resolvedepends($lib)) ],\n-                              %ordinals);\n-         foreach (@{$unified_info{shared_sources}->{$lib}}) {\n-             doobj($_, $lib, intent => \"lib\");\n+                              installed => is_installed($lib));\n+         foreach ((@{$unified_info{shared_sources}->{$lib}},\n+                   @{$unified_info{sources}->{$lib}})) {\n+             # If this is somehow a compiled object, take care of it that way\n+             # Otherwise, it might simply be generated\n+             if (defined $unified_info{sources}->{$_}) {\n+                 doobj($_, $lib, intent => \"lib\", installed => is_installed($lib));\n+             } else {\n+                 dogenerate($_, undef, undef, intent => \"lib\");\n+             }\n          }\n      }\n      $OUT .= obj2lib(lib => $lib,\n-                     objs => [ map { (my $x = $_) =~ s|\\.o$||; $x }\n-                               @{$unified_info{sources}->{$lib}} ]);\n+                     objs => [ @{$unified_info{sources}->{$lib}} ]);\n      foreach (@{$unified_info{sources}->{$lib}}) {\n-         doobj($_, $lib, intent => \"lib\");\n+         doobj($_, $lib, intent => \"lib\", installed => is_installed($lib));\n      }\n      $cache{$lib} = 1;\n  }\n@@ -121,13 +153,13 @@\n      my $lib = shift;\n      return \"\" if $cache{$lib};\n      $OUT .= obj2dso(lib => $lib,\n-                     objs => [ map { (my $x = $_) =~ s|\\.o$||; $x }\n-                               (@{$unified_info{sources}->{$lib}},\n-                                @{$unified_info{shared_sources}->{$lib}}) ],\n-                     deps => [ resolvedepends($lib) ]);\n+                     objs => [ @{$unified_info{sources}->{$lib}},\n+                               @{$unified_info{shared_sources}->{$lib}} ],\n+                     deps => [ resolvedepends($lib) ],\n+                     installed => is_installed($lib));\n      foreach ((@{$unified_info{sources}->{$lib}},\n                @{$unified_info{shared_sources}->{$lib}})) {\n-         doobj($_, $lib, intent => \"dso\");\n+         doobj($_, $lib, intent => \"dso\", installed => is_installed($lib));\n      }\n      $cache{$lib} = 1;\n  }\n@@ -139,11 +171,11 @@\n      return \"\" if $cache{$bin};\n      my $deps = [ reducedepends(resolvedepends($bin)) ];\n      $OUT .= obj2bin(bin => $bin,\n-                     objs => [ map { (my $x = $_) =~ s|\\.o$||; $x }\n-                               @{$unified_info{sources}->{$bin}} ],\n-                     deps => $deps);\n+                     objs => [ @{$unified_info{sources}->{$bin}} ],\n+                     deps => $deps,\n+                     installed => is_installed($bin));\n      foreach (@{$unified_info{sources}->{$bin}}) {\n-         doobj($_, $bin, intent => \"bin\");\n+         doobj($_, $bin, intent => \"bin\", installed => is_installed($bin));\n      }\n      $cache{$bin} = 1;\n  }\n@@ -154,7 +186,8 @@\n      my $script = shift;\n      return \"\" if $cache{$script};\n      $OUT .= in2script(script => $script,\n-                       sources => $unified_info{sources}->{$script});\n+                       sources => $unified_info{sources}->{$script},\n+                       installed => is_installed($script));\n      $cache{$script} = 1;\n  }\n \n@@ -170,47 +203,6 @@\n  # Start with populating the cache with all the overrides\n  %cache = map { $_ => 1 } @{$unified_info{overrides}};\n \n- # For convenience collect information regarding directories where\n- # files are generated, those generated files and the end product\n- # they end up in where applicable.  Then, add build rules for those\n- # directories\n- if (exists &generatedir) {\n-     my %loopinfo = ( \"dso\" => [ @{$unified_info{engines}} ],\n-                      \"lib\" => [ @{$unified_info{libraries}} ],\n-                      \"bin\" => [ @{$unified_info{programs}} ],\n-                      \"script\" => [ @{$unified_info{scripts}} ] );\n-     foreach my $type (keys %loopinfo) {\n-         foreach my $product (@{$loopinfo{$type}}) {\n-             my %dirs = ();\n-             my $pd = dirname($product);\n-\n-             # We already have a \"test\" target, and the current directory\n-             # is just silly to make a target for\n-             $dirs{$pd} = 1 unless $pd eq \"test\" || $pd eq \".\";\n-\n-             foreach (@{$unified_info{sources}->{$product}}) {\n-                 my $d = dirname($_);\n-\n-                 # We don't want to create targets for source directories\n-                 # when building out of source\n-                 next if ($config{sourcedir} ne $config{builddir}\n-                          && $d =~ m|^\\Q$config{sourcedir}\\E|);\n-                 # We already have a \"test\" target, and the current directory\n-                 # is just silly to make a target for\n-                 next if $d eq \"test\" || $d eq \".\";\n-\n-                 $dirs{$d} = 1;\n-                 push @{$unified_info{dirinfo}->{$d}->{deps}}, $_\n-                     if $d ne $pd;\n-             }\n-             foreach (keys %dirs) {\n-                 push @{$unified_info{dirinfo}->{$_}->{products}->{$type}},\n-                 $product;\n-             }\n-         }\n-     }\n- }\n-\n  # Build mandatory generated headers\n  foreach (@{$unified_info{depends}->{\"\"}}) { dogenerate($_); }\n "
        },
        {
            "sha": "03acb3e0b35bd923417c64f6bbce2ada91940d8c",
            "filename": "deps/openssl/openssl/Configurations/common0.tmpl",
            "status": "added",
            "additions": 31,
            "deletions": 0,
            "changes": 31,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fcommon0.tmpl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fcommon0.tmpl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fcommon0.tmpl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,31 @@\n+{- # -*- Mode: perl -*-\n+\n+ # Commonly used list of generated files\n+ # The reason for the complexity is that the build.info files provide\n+ # GENERATE rules for *all* platforms without discrimination, while the\n+ # build files only want those for a particular build.  Therefore, we\n+ # need to extrapolate exactly what we need to generate.  The way to do\n+ # that is to extract all possible source files from diverse tables and\n+ # filter out all that are not generated\n+ my %generatables =\n+     map { $_ => 1 }\n+     ( # The sources of stuff may be generated\n+         ( map { @{$unified_info{sources}->{$_}} }\n+               keys %{$unified_info{sources}} ),\n+         $disabled{shared}\n+             ? ()\n+             : ( map { @{$unified_info{shared_sources}->{$_}} }\n+                 keys %{$unified_info{shared_sources}} ),\n+         # Things we explicitly depend on are usually generated\n+         ( map { $_ eq \"\" ? () : @{$unified_info{depends}->{$_}} }\n+               keys %{$unified_info{depends}} ));\n+ our @generated =\n+     sort ( ( grep { defined $unified_info{generate}->{$_} }\n+              sort keys %generatables ),\n+            # Scripts are assumed to be generated, so add thhem too\n+            ( grep { defined $unified_info{sources}->{$_} }\n+              @{$unified_info{scripts}} ) );\n+\n+ # Avoid strange output\n+ \"\";\n+-}"
        },
        {
            "sha": "40876bdf88aa2b273ecaec89c0f7c775e61b16b5",
            "filename": "deps/openssl/openssl/Configurations/descrip.mms.tmpl",
            "status": "modified",
            "additions": 480,
            "deletions": 150,
            "changes": 630,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fdescrip.mms.tmpl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fdescrip.mms.tmpl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fdescrip.mms.tmpl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -3,13 +3,14 @@\n ## {- join(\"\\n## \", @autowarntext) -}\n {-\n   use File::Spec::Functions qw/:DEFAULT abs2rel rel2abs/;\n+  use File::Basename;\n \n   # Our prefix, claimed when speaking with the VSI folks Tuesday\n   # January 26th 2016\n   our $osslprefix = 'OSSL$';\n   (our $osslprefix_q = $osslprefix) =~ s/\\$/\\\\\\$/;\n \n-  our $sover = sprintf \"%02d%02d\", $config{shlib_major}, $config{shlib_minor};\n+  our $sover_dirname = sprintf \"%02d%02d\", split(/\\./, $config{shlib_version_number});\n   our $osslver = sprintf \"%02d%02d\", split(/\\./, $config{version});\n \n   our $sourcedir = $config{sourcedir};\n@@ -42,13 +43,18 @@\n \n   # Because we need to make two computations of these data,\n   # we store them in arrays for reuse\n-  our @shlibs = map { $unified_info{sharednames}->{$_} || () } @{$unified_info{libraries}};\n-  our @install_shlibs = map { $unified_info{sharednames}->{$_} || () } @{$unified_info{install}->{libraries}};\n-  our @generated = ( ( map { (my $x = $_) =~ s|\\.S$|\\.s|; $x }\n-                       grep { defined $unified_info{generate}->{$_} }\n-                       map { @{$unified_info{sources}->{$_}} }\n-                       grep { /\\.o$/ } keys %{$unified_info{sources}} ),\n-                     ( grep { /\\.h$/ } keys %{$unified_info{generate}} ) );\n+  our @libs =\n+      map { (my $x = $_) =~ s/\\.a$//; $x }\n+      @{$unified_info{libraries}};\n+  our @shlibs =\n+      map { $unified_info{sharednames}->{$_} || () }\n+      grep(!/\\.a$/, @{$unified_info{libraries}});\n+  our @install_libs =\n+      map { (my $x = $_) =~ s/\\.a$//; $x }\n+      @{$unified_info{install}->{libraries}};\n+  our @install_shlibs =\n+      map { $unified_info{sharednames}->{$_} || () }\n+      grep(!/\\.a$/, @{$unified_info{install}->{libraries}});\n \n   # This is a horrible hack, but is needed because recursive inclusion of files\n   # in different directories does not work well with HP C.\n@@ -63,17 +69,9 @@\n   }\n   my $sd1 = sourcedir(\"ssl\",\"record\");\n   my $sd2 = sourcedir(\"ssl\",\"statem\");\n-  $unified_info{before}->{\"[.test]heartbeat_test.OBJ\"}\n-      = $unified_info{before}->{\"[.test]ssltest_old.OBJ\"}\n-      = qq(record_include = F\\$PARSE(\"$sd1\",\"A.;\",,,\"SYNTAX_ONLY\") - \"A.;\"\n-        define record 'record_include'\n-        statem_include = F\\$PARSE(\"$sd2\",\"A.;\",,,\"SYNTAX_ONLY\") - \"A.;\"\n-        define statem 'statem_include');\n-  $unified_info{after}->{\"[.test]heartbeat_test.OBJ\"}\n-      = $unified_info{after}->{\"[.test]ssltest.OBJ\"}\n-      = qq(deassign statem\n-        deassign record);\n-  foreach (grep /^\\[\\.ssl\\.(?:record|statem)\\].*\\.o$/, keys %{$unified_info{sources}}) {\n+  my @ssl_locl_users = grep(/^\\[\\.(?:ssl\\.(?:record|statem)|test)\\].*\\.o$/,\n+                            keys %{$unified_info{sources}});\n+  foreach (@ssl_locl_users) {\n       (my $x = $_) =~ s|\\.o$|.OBJ|;\n       $unified_info{before}->{$x}\n           = qq(record_include = F\\$PARSE(\"$sd1\",\"A.;\",,,\"SYNTAX_ONLY\") - \"A.;\"\n@@ -121,7 +119,7 @@ SHLIB_EXT=.EXE\n OBJ_EXT=.OBJ\n DEP_EXT=.D\n \n-LIBS={- join(\", \", map { \"-\\n\\t\".$_.\".OLB\" } @{$unified_info{libraries}}) -}\n+LIBS={- join(\", \", map { \"-\\n\\t\".$_.\".OLB\" } @libs) -}\n SHLIBS={- join(\", \", map { \"-\\n\\t\".$_.\".EXE\" } @shlibs) -}\n ENGINES={- join(\", \", map { \"-\\n\\t\".$_.\".EXE\" } @{$unified_info{engines}}) -}\n PROGRAMS={- join(\", \", map { \"-\\n\\t\".$_.\".EXE\" } @{$unified_info{programs}}) -}\n@@ -133,9 +131,11 @@ DEPS={- our @deps = map { (my $x = $_) =~ s|\\.o$|\\$(DEP_EXT)|; $x; }\n         join(\", \", map { \"-\\n\\t\".$_ } @deps); -}\n {- output_on() if $disabled{makedepend}; \"\" -}\n GENERATED_MANDATORY={- join(\", \", map { \"-\\n\\t\".$_ } @{$unified_info{depends}->{\"\"}} ) -}\n-GENERATED={- join(\", \", map { \"-\\n\\t\".$_ } @generated) -}\n+GENERATED={- # common0.tmpl provides @generated\n+             join(\", \", map { (my $x = $_) =~ s|\\.[sS]$|.asm|; \"-\\n\\t\".$x }\n+                        @generated) -}\n \n-INSTALL_LIBS={- join(\", \", map { \"-\\n\\t\".$_.\".OLB\" } @{$unified_info{install}->{libraries}}) -}\n+INSTALL_LIBS={- join(\", \", map { \"-\\n\\t\".$_.\".OLB\" } @install_libs) -}\n INSTALL_SHLIBS={- join(\", \", map { \"-\\n\\t\".$_.\".EXE\" } @install_shlibs) -}\n INSTALL_ENGINES={- join(\", \", map { \"-\\n\\t\".$_.\".EXE\" } @{$unified_info{install}->{engines}}) -}\n INSTALL_PROGRAMS={- join(\", \", map { \"-\\n\\t\".$_.\".EXE\" } @{$unified_info{install}->{programs}}) -}\n@@ -167,27 +167,175 @@ OPENSSLDIR={- catdir($config{openssldir}) or\n # The same, but for C\n OPENSSLDIR_C={- $osslprefix -}DATAROOT:[000000]\n # Where installed engines reside, for C\n-ENGINESDIR_C={- $osslprefix -}ENGINES{- $sover.$target{pointer_size} -}:\n-\n-CC= {- $target{cc} -}\n-CFLAGS= /DEFINE=({- join(\",\", @{$target{defines}}, @{$config{defines}},\"OPENSSLDIR=\\\"\\\"\\\"\\$(OPENSSLDIR_C)\\\"\\\"\\\"\",\"ENGINESDIR=\\\"\\\"\\\"\\$(ENGINESDIR_C)\\\"\\\"\\\"\") -}) {- $target{cflags} -} {- $config{cflags} -}\n-CFLAGS_Q=$(CFLAGS)\n-DEPFLAG= /DEFINE=({- join(\",\", @{$config{depdefines}}) -})\n-LDFLAGS= {- $target{lflags} -}\n-EX_LIBS= {- $target{ex_libs} ? \",\".$target{ex_libs} : \"\" -}{- $config{ex_libs} ? \",\".$config{ex_libs} : \"\" -}\n-LIB_CFLAGS={- $target{lib_cflags} || \"\" -}\n-DSO_CFLAGS={- $target{dso_cflags} || \"\" -}\n-BIN_CFLAGS={- $target{bin_cflags} || \"\" -}\n-\n-PERL={- $config{perl} -}\n-\n-# We let the C compiler driver to take care of .s files. This is done in\n-# order to be excused from maintaining a separate set of architecture\n-# dependent assembler flags. E.g. if you throw -mcpu=ultrasparc at SPARC\n-# gcc, then the driver will automatically translate it to -xarch=v8plus\n-# and pass it down to assembler.\n-AS={- $target{as} -}\n-ASFLAG={- $target{asflags} -}\n+ENGINESDIR_C={- $osslprefix -}ENGINES{- $sover_dirname.$target{pointer_size} -}:\n+\n+##### User defined commands and flags ################################\n+\n+CC={- $config{CC} -}\n+CPP={- $config{CPP} -}\n+DEFINES={- our $defines1 = join('', map { \",$_\" } @{$config{CPPDEFINES}}) -}\n+INCLUDES={- our $includes1 = join(',', @{$config{CPPINCLUDES}}) -}\n+CPPFLAGS={- our $cppflags1 = join('', @{$config{CPPFLAGS}}) -}\n+CFLAGS={- join('', @{$config{CFLAGS}}) -}\n+LDFLAGS={- join('', @{$config{LFLAGS}}) -}\n+EX_LIBS={- join('', map { \",$_\" } @{$config{LDLIBS}}) -}\n+\n+PERL={- $config{PERL} -}\n+\n+AS={- $config{AS} -}\n+ASFLAGS={- join(' ', @{$config{ASFLAGS}}) -}\n+\n+##### Special command flags ##########################################\n+\n+ASOUTFLAG={- $target{asoutflag} -}$(OSSL_EMPTY)\n+\n+##### Project flags ##################################################\n+\n+# Variables starting with CNF_ are common variables for all product types\n+\n+CNF_ASFLAGS={- join('', $target{asflags} || (),\n+                        @{$config{asflags}}) -}\n+CNF_DEFINES={- our $defines2 = join('', map { \",$_\" } @{$target{defines}},\n+                                                      @{$config{defines}}) -}\n+CNF_INCLUDES={- our $includes2 = join(',', @{$target{includes}},\n+                                           @{$config{includes}}) -}\n+CNF_CPPFLAGS={- our $cppflags2 = join('', $target{cppflags} || (),\n+                                          @{$config{cppflags}}) -}\n+CNF_CFLAGS={- join('', $target{cflags} || (),\n+                       @{$config{cflags}}) -}\n+CNF_CXXFLAGS={- join('', $target{cxxflags} || (),\n+                         @{$config{cxxflags}}) -}\n+CNF_LDFLAGS={- join('', $target{lflags} || (),\n+                        @{$config{lflags}}) -}\n+CNF_EX_LIBS={- join('', map{ \",$_\" } @{$target{ex_libs}},\n+                                     @{$config{ex_libs}}) -}\n+\n+# Variables starting with LIB_ are used to build library object files\n+# and shared libraries.\n+# Variables starting with DSO_ are used to build DSOs and their object files.\n+# Variables starting with BIN_ are used to build programs and their object\n+# files.\n+\n+LIB_ASFLAGS={- join(' ', $target{lib_asflags} || (),\n+                         @{$config{lib_asflags}},\n+                         '$(CNF_ASFLAGS)', '$(ASFLAGS)') -}\n+LIB_DEFINES={- our $lib_defines =\n+               join('', (map { \",$_\" } @{$target{lib_defines}},\n+                                       @{$target{shared_defines}},\n+                                       @{$config{lib_defines}},\n+                                       @{$config{shared_defines}}));\n+               join('', $lib_defines,\n+                        (map { \",$_\" } 'OPENSSLDIR=\"\"\"$(OPENSSLDIR_C)\"\"\"',\n+                                       'ENGINESDIR=\"\"\"$(ENGINESDIR_C)\"\"\"'),\n+                        '$(CNF_DEFINES)', '$(DEFINES)') -}\n+LIB_INCLUDES={- our $lib_includes =\n+                join(',', @{$target{lib_includes}},\n+                          @{$target{shared_includes}},\n+                          @{$config{lib_includes}},\n+                          @{$config{shared_includes}}) -}\n+LIB_CPPFLAGS={- our $lib_cppflags =\n+                join('', $target{lib_cppflags} || (),\n+                         $target{shared_cppflags} || (),\n+                         @{$config{lib_cppflags}},\n+                         @{$config{shared_cppflag}});\n+                join('', \"'qual_includes'\",\n+                         '/DEFINE=(__dummy$(LIB_DEFINES))',\n+                         $lib_cppflags,\n+                         '$(CNF_CPPFLAGS)', '$(CPPFLAGS)') -}\n+LIB_CFLAGS={- join('', $target{lib_cflags} || (),\n+                       $target{shared_cflag} || (),\n+                       @{$config{lib_cflags}},\n+                       @{$config{shared_cflag}},\n+                       '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+LIB_LDFLAGS={- join('', $target{lib_lflags} || (),\n+                        $target{shared_ldflag} || (),\n+                        @{$config{lib_lflags}},\n+                        @{$config{shared_ldflag}},\n+                        '$(CNF_LDFLAGS)', '$(LDFLAGS)') -}\n+LIB_EX_LIBS=$(CNF_EX_LIBS)$(EX_LIBS)\n+DSO_ASFLAGS={- join(' ', $target{dso_asflags} || (),\n+                         $target{module_asflags} || (),\n+                         @{$config{dso_asflags}},\n+                         @{$config{module_asflags}},\n+                         '$(CNF_ASFLAGS)', '$(ASFLAGS)') -}\n+DSO_DEFINES={- join('', (map { \",$_\" } @{$target{dso_defines}},\n+                                       @{$target{module_defines}},\n+                                       @{$config{dso_defines}},\n+                                       @{$config{module_defines}}),\n+                        '$(CNF_DEFINES)', '$(DEFINES)') -}\n+DSO_INCLUDES={- join(',', @{$target{dso_includes}},\n+                          @{$target{module_includes}},\n+                          @{$config{dso_includes}},\n+                          @{$config{module_includes}}) -}\n+DSO_CPPFLAGS={- join('', \"'qual_includes'\",\n+                         '/DEFINE=(__dummy$(DSO_DEFINES))',\n+                         $target{dso_cppflags} || (),\n+                         $target{module_cppflags} || (),\n+                         @{$config{dso_cppflags}},\n+                         @{$config{module_cppflags}},\n+                         '$(CNF_CPPFLAGS)', '$(CPPFLAGS)') -}\n+DSO_CFLAGS={- join('', $target{dso_cflags} || (),\n+                       $target{module_cflags} || (),\n+                       @{$config{dso_cflags}},\n+                       @{$config{module_cflags}},\n+                       '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+DSO_LDFLAGS={- join('', $target{dso_lflags} || (),\n+                        $target{module_ldflags} || (),\n+                        @{$config{dso_lflags}},\n+                        @{$config{module_ldflags}},\n+                        '$(CNF_LDFLAGS)', '$(LDFLAGS)') -}\n+DSO_EX_LIBS=$(CNF_EX_LIBS) $(EX_LIBS)\n+BIN_ASFLAGS={- join(' ', $target{bin_asflags} || (),\n+                         @{$config{bin_asflags}},\n+                         '$(CNF_ASFLAGS)', '$(ASFLAGS)') -}\n+BIN_DEFINES={- join('', (map { \",$_\" } @{$target{bin_defines}},\n+                                       @{$config{bin_defines}}),\n+                        '$(CNF_DEFINES)', '$(DEFINES)') -}\n+BIN_INCLUDES={- join(',', @{$target{bin_includes}},\n+                          @{$config{bin_includes}}) -}\n+BIN_CPPFLAGS={- join('', \"'qual_includes'\",\n+                         '/DEFINE=(__dummy$(DSO_DEFINES))',\n+                         $target{bin_cppflags} || (),\n+                         @{$config{bin_cppflag}},\n+                         '$(CNF_CPPFLAGS)', '$(CPPFLAGS)') -}\n+BIN_CFLAGS={- join('', $target{bin_cflag} || (),\n+                       @{$config{bin_cflag}},\n+                       '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+BIN_LDFLAGS={- join('', $target{bin_lflags} || (),\n+                        @{$config{bin_lflags}} || (),\n+                        '$(CNF_LDFLAGS)', '$(LDFLAGS)') -}\n+BIN_EX_LIBS=$(CNF_EX_LIBS) $(EX_LIBS)\n+NO_INST_LIB_CFLAGS={- join('', $target{no_inst_lib_cflags}\n+                               // $target{lib_cflags}\n+                               // (),\n+                               $target{shared_cflag} || (),\n+                               @{$config{lib_cflags}},\n+                               @{$config{shared_cflag}},\n+                               '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+NO_INST_DSO_CFLAGS={- join('', $target{no_inst_lib_cflags}\n+                               // $target{lib_cflags}\n+                               // (),\n+                               $target{dso_cflags} || (),\n+                               @{$config{lib_cflags}},\n+                               @{$config{dso_cflags}},\n+                               '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+NO_INST_BIN_CFLAGS={- join('', $target{no_inst_bin_cflags}\n+                               // $target{bin_cflags}\n+                               // (),\n+                               @{$config{bin_cflags}},\n+                               '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+\n+PERLASM_SCHEME={- $target{perlasm_scheme} -}\n+\n+# CPPFLAGS_Q is used for one thing only: to build up buildinf.h\n+CPPFLAGS_Q={- (my $c = $lib_cppflags.$cppflags2.$cppflags1) =~ s|\"|\"\"|g;\n+              (my $d = $lib_defines.$defines2.$defines1) =~ s|\"|\"\"|g;\n+              my $i = join(',', $lib_includes || (), $includes2 || (),\n+                                $includes1 || ());\n+              my $x = $c;\n+              $x .= \"/INCLUDE=($i)\" if $i;\n+              $x .= \"/DEFINE=($d)\" if $d;\n+              $x; -}\n \n # .FIRST and .LAST are special targets with MMS and MMK.\n # The defines in there are for C.  includes that look like\n@@ -238,10 +386,10 @@ NODEBUG=@\n         $(NODEBUG) ! Set up logical names for the libraries, so LINK and\n         $(NODEBUG) ! running programs can use them.\n         $(NODEBUG) !\n-        $(NODEBUG) {- join(\"\\n\\t\\$(NODEBUG) \", map { \"DEFINE \".uc($_).\" 'F\\$ENV(\\\"DEFAULT\\\")'\".uc($_).\"\\$(SHLIB_EXT)\" } map { $unified_info{sharednames}->{$_} || () } @{$unified_info{libraries}}) || \"!\" -}\n+        $(NODEBUG) {- join(\"\\n\\t\\$(NODEBUG) \", map { \"DEFINE \".uc($_).\" 'F\\$ENV(\\\"DEFAULT\\\")'\".uc($_).\"\\$(SHLIB_EXT)\" } @shlibs) || \"!\" -}\n \n .LAST :\n-        $(NODEBUG) {- join(\"\\n\\t\\$(NODEBUG) \", map { \"DEASSIGN \".uc($_) } map { $unified_info{sharednames}->{$_} || () } @{$unified_info{libraries}}) || \"!\" -}\n+        $(NODEBUG) {- join(\"\\n\\t\\$(NODEBUG) \", map { \"DEASSIGN \".uc($_) } @shlibs) || \"!\" -}\n         $(NODEBUG) DEASSIGN ossl_dataroot\n         $(NODEBUG) DEASSIGN ossl_installroot\n         $(NODEBUG) DEASSIGN internal\n@@ -267,6 +415,11 @@ build_apps build_tests : build_programs\n # Convenience target to prebuild all generated files, not just the mandatory\n # ones\n build_all_generated : $(GENERATED_MANDATORY) $(GENERATED)\n+\t@ ! {- output_off() if $disabled{makedepend}; \"\" -}\n+\t@ WRITE SYS$OUTPUT \"Warning: consider configuring with no-makedepend, because if\"\n+\t@ WRITE SYS$OUTPUT \"         target system doesn't have $(PERL),\"\n+\t@ WRITE SYS$OUTPUT \"         then make will fail...\"\n+\t@ ! {- output_on() if $disabled{makedepend}; \"\" -}\n \n test : tests\n {- dependmagic('tests'); -} : build_programs_nodep, build_engines_nodep\n@@ -331,13 +484,14 @@ uninstall : uninstall_docs uninstall_sw\n # Because VMS wants the generation number (or *) to delete files, we can't\n # use $(LIBS), $(PROGRAMS), $(GENERATED) and $(ENGINES)directly.\n libclean :\n-        {- join(\"\\n\\t\", map { \"- DELETE $_.OLB;*\" } @{$unified_info{libraries}}) || \"@ !\" -}\n-        {- join(\"\\n\\t\", map { \"- DELETE $_.EXE;*,$_.MAP;*,$_.OPT;*\" } @shlibs) || \"@ !\" -}\n+        {- join(\"\\n\\t\", map { \"- DELETE $_.OLB;*\" } @libs) || \"@ !\" -}\n+        {- join(\"\\n\\t\", map { \"- DELETE $_.EXE;*,$_.MAP;*\" } @shlibs) || \"@ !\" -}\n \n clean : libclean\n         {- join(\"\\n\\t\", map { \"- DELETE $_.EXE;*,$_.OPT;*\" } @{$unified_info{programs}}) || \"@ !\" -}\n         {- join(\"\\n\\t\", map { \"- DELETE $_.EXE;*,$_.OPT;*\" } @{$unified_info{engines}}) || \"@ !\" -}\n         {- join(\"\\n\\t\", map { \"- DELETE $_;*\" } @{$unified_info{scripts}}) || \"@ !\" -}\n+        {- join(\"\\n\\t\", map { \"- DELETE $_;*\" } @{$unified_info{depends}->{\"\"}}) || \"@ !\" -}\n         {- join(\"\\n\\t\", map { \"- DELETE $_;*\" } @generated) || \"@ !\" -}\n         - DELETE [...]*.MAP;*\n         - DELETE [...]*.D;*\n@@ -354,16 +508,7 @@ distclean : clean\n depend : descrip.mms\n descrip.mms : FORCE\n \t@ ! {- output_off() if $disabled{makedepend}; \"\" -}\n-        @ $(PERL) -pe \"if (/^# DO NOT DELETE.*/) { exit(0); }\" -\n-                < descrip.mms > descrip.mms-new\n-        @ OPEN/APPEND DESCRIP descrip.mms-new\n-        @ WRITE DESCRIP \"# DO NOT DELETE THIS LINE -- make depend depends on it.\"\n-        {- join(\"\\n\\t\", map { \"\\@ IF F\\$SEARCH(\\\"$_\\\") .NES. \\\"\\\" THEN TYPE $_ /OUTPUT=DESCRIP:\" } @deps); -}\n-        @ CLOSE DESCRIP\n-        @ PIPE ( $(PERL) -e \"use File::Compare qw/compare_text/; my $x = compare_text(\"\"descrip.mms\"\",\"\"descrip.mms-new\"\"); exit(0x10000000 + ($x == 0));\" || -\n-                 RENAME descrip.mms-new descrip.mms )\n-        @ IF F$SEARCH(\"descrip.mms-new\") .NES. \"\" THEN DELETE descrip.mms-new;*\n-        -@ SPAWN/OUTPUT=NLA0: PURGE/NOLOG descrip.mms\n+\t@ $(PERL) {- sourcefile(\"util\", \"add-depends.pl\") -} \"VMS C\"\n \t@ ! {- output_on() if $disabled{makedepend}; \"\" -}\n \n # Install helper targets #############################################\n@@ -393,6 +538,12 @@ install_ssldirs : check_INSTALLTOP\n         IF F$SEARCH(\"OSSL_DATAROOT:[000000]openssl.cnf\") .EQS. \"\" THEN -\n                 COPY/PROT=W:R {- sourcefile(\"apps\", \"openssl-vms.cnf\") -} -\n                         ossl_dataroot:[000000]openssl.cnf\n+        @ ! Install CTLOG configuration file\n+        COPY/PROT=W:R {- sourcefile(\"apps\", \"ct_log_list.cnf\") -} -\n+                ossl_dataroot:[000000]ct_log_list.cnf-dist\n+        IF F$SEARCH(\"OSSL_DATAROOT:[000000]ct_log_list.cnf\") .EQS. \"\" THEN -\n+                COPY/PROT=W:R {- sourcefile(\"apps\", \"ct_log_list.cnf\") -} -\n+                        ossl_dataroot:[000000]ct_log_list.cnf\n \n install_dev : check_INSTALLTOP install_runtime_libs\n         @ WRITE SYS$OUTPUT \"*** Installing development files\"\n@@ -403,14 +554,14 @@ install_dev : check_INSTALLTOP install_runtime_libs\n         - CREATE/DIR ossl_installroot:[LIB.'arch']\n         {- join(\"\\n        \",\n                 map { \"COPY/PROT=W:R $_.OLB ossl_installroot:[LIB.'arch']\" }\n-                @{$unified_info{install}->{libraries}}) -}\n+                @install_libs) -}\n \n install_engines : check_INSTALLTOP install_runtime_libs build_engines\n         @ {- output_off() unless scalar @{$unified_info{engines}}; \"\" -} !\n         @ WRITE SYS$OUTPUT \"*** Installing engines\"\n-        - CREATE/DIR ossl_installroot:[ENGINES{- $sover.$target{pointer_size} -}.'arch']\n+        - CREATE/DIR ossl_installroot:[ENGINES{- $sover_dirname.$target{pointer_size} -}.'arch']\n         {- join(\"\\n        \",\n-                map { \"COPY/PROT=W:RE $_.EXE ossl_installroot:[ENGINES$sover$target{pointer_size}.'arch']\" }\n+                map { \"COPY/PROT=W:RE $_.EXE ossl_installroot:[ENGINES$sover_dirname$target{pointer_size}.'arch']\" }\n                 @{$unified_info{install}->{engines}}) -}\n         @ {- output_on() unless scalar @{$unified_info{engines}}; \"\" -} !\n \n@@ -485,6 +636,7 @@ vmsconfig.pm : configdata.pm\n         WRITE CONFIG \"our %config = (\"\n         WRITE CONFIG \"  target => '\",\"{- $config{target} -}\",\"',\"\n         WRITE CONFIG \"  version => '\",\"{- $config{version} -}\",\"',\"\n+        WRITE CONFIG \"  shlib_version_number => '\",\"{- $config{shlib_version_number} -}\",\"',\"\n         WRITE CONFIG \"  shlib_major => '\",\"{- $config{shlib_major} -}\",\"',\"\n         WRITE CONFIG \"  shlib_minor => '\",\"{- $config{shlib_minor} -}\",\"',\"\n         WRITE CONFIG \"  no_shared => '\",\"{- $disabled{shared} -}\",\"',\"\n@@ -521,50 +673,157 @@ debug_logicals :\n # Building targets ###################################################\n \n configdata.pm : $(SRCDIR)Configure $(SRCDIR)config.com {- join(\" \", @{$config{build_file_templates}}, @{$config{build_infos}}, @{$config{conf_files}}) -}\n-        @ WRITE SYS$OUTPUT \"Reconfiguring...\"\n-        perl $(SRCDIR)Configure reconf\n+        perl configdata.pm -r\n         @ WRITE SYS$OUTPUT \"*************************************************\"\n         @ WRITE SYS$OUTPUT \"***                                           ***\"\n         @ WRITE SYS$OUTPUT \"***   Please run the same mms command again   ***\"\n         @ WRITE SYS$OUTPUT \"***                                           ***\"\n         @ WRITE SYS$OUTPUT \"*************************************************\"\n         @ PIPE ( EXIT %X10000000 )\n \n+reconfigure reconf :\n+\tperl configdata.pm -r\n+\n {-\n   use File::Basename;\n   use File::Spec::Functions qw/abs2rel rel2abs catfile catdir/;\n \n+  # Helper function to figure out dependencies on libraries\n+  # It takes a list of library names and outputs a list of dependencies\n+  sub compute_lib_depends {\n+      if ($disabled{shared}) {\n+          return map { $_ =~ /\\.a$/ ? $`.\".OLB\" : $_.\".OLB\" } @_;\n+      }\n+      return map { $_ =~ /\\.a$/\n+                   ? $`.\".OLB\"\n+                   : $unified_info{sharednames}->{$_}.\".EXE\" } @_;\n+  }\n+\n+  # Helper function to deal with inclusion directory specs.\n+  # We have to deal with two things:\n+  # 1. comma separation and no possibility of trailing comma\n+  # 2. no inclusion directories given at all\n+  # 3. long compiler command lines\n+  # To resolve 1, we need to iterate through the sources of inclusion\n+  # directories, and only add a comma when needed.\n+  # To resolve 2, we need to have a variable that will hold the whole\n+  # inclusion qualifier, or be the empty string if there are no inclusion\n+  # directories.  That's the symbol 'qual_includes' that's used in CPPFLAGS\n+  # To resolve 3, we creata a logical name TMP_INCLUDES: to hold the list\n+  # of inclusion directories.\n+  #\n+  # This function returns a list of two lists, one being the collection of\n+  # commands to execute before the compiler is called, and the other being\n+  # the collection of commands to execute after.  It takes as arguments the\n+  # collection of strings to include as directory specs.\n+  sub includes {\n+      my @stuff = ( @_ );\n+      my @before = (\n+          'qual_includes :=',\n+      );\n+      my @after = (\n+          'DELETE/SYMBOL/LOCAL qual_includes',\n+      );\n+\n+      if (scalar @stuff > 0) {\n+          push @before, 'tmp_includes := '.shift(@stuff);\n+          while (@stuff) {\n+              push @before, 'tmp_add := '.shift(@stuff);\n+              push @before, 'IF tmp_includes .NES. \"\" .AND. tmp_add .NES. \"\" THEN tmp_includes = tmp_includes + \",\"';\n+              push @before, 'tmp_includes = tmp_includes + tmp_add';\n+          }\n+          push @before, \"IF tmp_includes .NES. \\\"\\\" THEN DEFINE tmp_includes 'tmp_includes'\";\n+          push @before, 'IF tmp_includes .NES. \"\" THEN qual_includes := /INCLUDE=(tmp_includes:)';\n+          push @before, 'DELETE/SYMBOL/LOCAL tmp_includes';\n+          push @before, 'DELETE/SYMBOL/LOCAL tmp_add';\n+          push @after, 'DEASSIGN tmp_includes:'\n+      }\n+      return ([ @before ], [ @after ]);\n+  }\n+\n   sub generatesrc {\n       my %args = @_;\n+      (my $target = $args{src}) =~ s/\\.[sS]$/.asm/;\n       my $generator = join(\" \", @{$args{generator}});\n       my $generator_incs = join(\"\", map { ' \"-I'.$_.'\"' } @{$args{generator_incs}});\n       my $deps = join(\", -\\n\\t\\t\", @{$args{generator_deps}}, @{$args{deps}});\n \n-      if ($args{src} !~ /\\.[sS]$/) {\n+      if ($target !~ /\\.asm$/) {\n           if ($args{generator}->[0] =~ m|^.*\\.in$|) {\n \t      my $dofile = abs2rel(rel2abs(catfile($config{sourcedir},\n                                                    \"util\", \"dofile.pl\")),\n                                    rel2abs($config{builddir}));\n               return <<\"EOF\";\n-$args{src} : $args{generator}->[0] $deps\n+$target : $args{generator}->[0] $deps\n \t\\$(PERL) \"-I\\$(BLDDIR)\" \"-Mconfigdata\" $dofile \\\\\n-\t    \"-o$target{build_file}\" $generator > \\$@\n+\t    \"-o$target{build_file}\" $generator > \\$\\@\n EOF\n \t  } else {\n               return <<\"EOF\";\n-$args{src} : $args{generator}->[0] $deps\n-\t\\$(PERL)$generator_incs $generator > \\$@\n+$target : $args{generator}->[0] $deps\n+\t\\$(PERL)$generator_incs $generator > \\$\\@\n EOF\n \t  }\n       } else {\n-          die \"No method to generate assembler source present.\\n\";\n+          if ($args{generator}->[0] =~ /\\.pl$/) {\n+              $generator = '$(PERL)'.$generator_incs.' '.$generator;\n+          } elsif ($args{generator}->[0] =~ /\\.S$/) {\n+              $generator = undef;\n+          } else {\n+              die \"Generator type for $src unknown: $generator\\n\";\n+          }\n+\n+          my $cppflags = {\n+              lib => '$(LIB_CFLAGS) $(LIB_CPPFLAGS)',\n+              dso => '$(DSO_CFLAGS) $(DSO_CPPFLAGS)',\n+              bin => '$(BIN_CFLAGS) $(BIN_CPPFLAGS)'\n+          } -> {$args{intent}};\n+          my @incs_cmds = includes({ lib => '$(LIB_INCLUDES)',\n+                                     dso => '$(DSO_INCLUDES)',\n+                                     bin => '$(BIN_INCLUDES)' } -> {$args{intent}},\n+                                   '$(CNF_INCLUDES)',\n+                                   '$(INCLUDES)',\n+                                   @{$args{incs}});\n+          my $incs_on = join(\"\\n\\t\\@ \", @{$incs_cmds[0]}) || '!';\n+          my $incs_off = join(\"\\n\\t\\@ \", @{$incs_cmds[1]}) || '!';\n+          if (defined($generator)) {\n+              # If the target is named foo.S in build.info, we want to\n+              # end up generating foo.s in two steps.\n+              if ($args{src} =~ /\\.S$/) {\n+                   return <<\"EOF\";\n+$target : $args{generator}->[0] $deps\n+\t$generator \\$\\@-S\n+        \\@ $incs_on\n+\tPIPE \\$(CPP) $cppflags \\$\\@-S | -\n+        \\$(PERL) -ne \"/^#(\\\\s*line)?\\\\s*[0-9]+\\\\s+\"\"/ or print\" > \\$\\@-i\n+        \\@ $incs_off\n+        RENAME \\$\\@-i \\$\\@\n+        DELETE \\$\\@-S\n+EOF\n+              }\n+              # Otherwise....\n+              return <<\"EOF\";\n+$target : $args{generator}->[0] $deps\n+\t$generator \\$\\@\n+EOF\n+          }\n+          return <<\"EOF\";\n+$target : $args{generator}->[0] $deps\n+        \\@ $incs_on\n+        SHOW SYMBOL qual_includes\n+        PIPE \\$(CPP) $cppflags $args{generator}->[0] | -\n+        \\$(PERL) \"-ne\" \"/^#(\\\\s*line)?\\\\s*[0-9]+\\\\s+\"\"/ or print\" > \\$\\@\n+        \\@ $incs_off\n+EOF\n       }\n   }\n \n   sub src2obj {\n       my %args = @_;\n-      my $obj = $args{obj};\n-      my $deps = join(\", -\\n\\t\\t\", @{$args{srcs}}, @{$args{deps}});\n+      my @srcs = map { (my $x = $_) =~ s/\\.s$/.asm/; $x\n+                     } ( @{$args{srcs}} );\n+      (my $obj = $args{obj}) =~ s|\\.o$||;\n+      my $deps = join(\", -\\n\\t\\t\", @srcs, @{$args{deps}});\n \n       # Because VMS C isn't very good at combining a /INCLUDE path with\n       # #includes having a relative directory (like '#include \"../foo.h\"),\n@@ -577,48 +836,59 @@ EOF\n       my $objd = abs2rel(rel2abs(dirname($obj)), rel2abs($forward));\n       my $objn = basename($obj);\n       my $srcs =\n-          join(\", \",\n-               map { abs2rel(rel2abs($_), rel2abs($forward)) } @{$args{srcs}});\n-      my $ecflags = { lib => '$(LIB_CFLAGS)',\n+          join(\", \", map { abs2rel(rel2abs($_), rel2abs($forward)) } @srcs);\n+      my $before = $unified_info{before}->{$obj.\".OBJ\"} || \"\\@ !\";\n+      my $after = $unified_info{after}->{$obj.\".OBJ\"} || \"\\@ !\";\n+\n+      if ($srcs[0] =~ /\\.asm$/) {\n+          my $asflags = { lib => ' $(LIB_ASFLAGS)',\n+\t\t          dso => ' $(DSO_ASFLAGS)',\n+\t\t          bin => ' $(BIN_ASFLAGS)' } -> {$args{intent}};\n+          return <<\"EOF\";\n+$obj.OBJ : $deps\n+        ${before}\n+        SET DEFAULT $forward\n+        \\$(AS) $asflags \\$(ASOUTFLAG)${objd}${objn}.OBJ $srcs\n+        SET DEFAULT $backward\n+EOF\n+      }\n+\n+      my $cflags;\n+      if ($args{installed}) {\n+          $cflags = { lib => '$(LIB_CFLAGS)',\n                       dso => '$(DSO_CFLAGS)',\n                       bin => '$(BIN_CFLAGS)' } -> {$args{intent}};\n-      my $incs_on = \"\\@ !\";\n-      my $incs_off = \"\\@ !\";\n-      my $incs = \"\";\n-      my @incs = ();\n-      push @incs, @{$args{incs}} if @{$args{incs}};\n-      unless ($disabled{zlib}) {\n-          # GNV$ZLIB_INCLUDE is the standard logical name for later zlib\n-          # incarnations.\n-          push @incs, ($withargs{zlib_include} || 'GNV$ZLIB_INCLUDE:');\n-      }\n-      if (@incs) {\n-          $incs_on =\n-              \"DEFINE tmp_includes \"\n-              .join(\",-\\n\\t\\t\\t\", map {\n-                                      file_name_is_absolute($_)\n-                                      ? $_ : catdir($backward,$_)\n-                                  } @incs);\n-          $incs_off = \"DEASSIGN tmp_includes\";\n-          $incs = \" /INCLUDE=(tmp_includes:)\";\n+      } else {\n+          $cflags = { lib => '$(NO_INST_LIB_CFLAGS)',\n+                      dso => '$(NO_INST_DSO_CFLAGS)',\n+                      bin => '$(NO_INST_BIN_CFLAGS)' } -> {$args{intent}};\n       }\n-      my $before = $unified_info{before}->{$obj.\".OBJ\"} || \"\\@ !\";\n-      my $after = $unified_info{after}->{$obj.\".OBJ\"} || \"\\@ !\";\n+      $cflags .= { lib => '$(LIB_CPPFLAGS)',\n+\t\t   dso => '$(DSO_CPPFLAGS)',\n+\t\t   bin => '$(BIN_CPPFLAGS)' } -> {$args{intent}};\n+\n+      my @incs_cmds = includes({ lib => '$(LIB_INCLUDES)',\n+                                 dso => '$(DSO_INCLUDES)',\n+                                 bin => '$(BIN_INCLUDES)' } -> {$args{intent}},\n+                               '$(INCLUDES)',\n+                               map {\n+                                   file_name_is_absolute($_)\n+                                   ? $_ : catdir($backward,$_)\n+                               } @{$args{incs}});\n+      my $incs_on = join(\"\\n\\t\\@ \", @{$incs_cmds[0]}) || '!';\n+      my $incs_off = join(\"\\n\\t\\@ \", @{$incs_cmds[1]}) || '!';\n       my $depbuild = $disabled{makedepend} ? \"\"\n-          : \" /MMS=(FILE=${objd}${objn}.tmp-D,TARGET=$obj.OBJ)\";\n+          : \" /MMS=(FILE=${objd}${objn}.D,TARGET=$obj.OBJ)\";\n \n       return <<\"EOF\";\n $obj.OBJ : $deps\n         ${before}\n         SET DEFAULT $forward\n-        $incs_on\n-        \\$(CC) \\$(CFLAGS)${ecflags}${incs}${depbuild} /OBJECT=${objd}${objn}.OBJ /REPOSITORY=$backward $srcs\n-        $incs_off\n+        \\@ $incs_on\n+        \\$(CC) ${cflags}${depbuild} /OBJECT=${objd}${objn}.OBJ /REPOSITORY=$backward $srcs\n+        \\@ $incs_off\n         SET DEFAULT $backward\n         ${after}\n-        \\@ PIPE ( \\$(PERL) -e \"use File::Compare qw/compare_text/; my \\$x = compare_text(\"\"$obj.D\"\",\"\"$obj.tmp-D\"\"); exit(0x10000000 + (\\$x == 0));\" || -\n-                 RENAME $obj.tmp-D $obj.d )\n-        \\@ IF F\\$SEARCH(\"$obj.tmp-D\") .NES. \"\" THEN DELETE $obj.tmp-D;*\n         - PURGE $obj.OBJ\n EOF\n   }\n@@ -628,58 +898,56 @@ EOF\n       my $shlib = $args{shlib};\n       my $libd = dirname($lib);\n       my $libn = basename($lib);\n-      (my $mkdef_key = $libn) =~ s/^${osslprefix_q}lib([^0-9]*)\\d*/$1/i;\n-      my @deps = map {\n-          $disabled{shared} ? $_.\".OLB\"\n-              : $unified_info{sharednames}->{$_}.\".EXE\"; } @{$args{deps}};\n-      my $deps = join(\", -\\n\\t\\t\", @deps);\n+      my @objs = map { (my $x = $_) =~ s|\\.o$|.OBJ|; $x }\n+                 grep { $_ =~ m|\\.o$| }\n+                 @{$args{objs}};\n+      my @defs = grep { $_ =~ /\\.opt$/ } @{$args{objs}};\n+      my @deps = compute_lib_depends(@{$args{deps}});\n+      die \"More than one symbol vector\" if scalar @defs > 1;\n+      my $deps = join(\", -\\n\\t\\t\", @defs, @deps);\n       my $shlib_target = $disabled{shared} ? \"\" : $target{shared_target};\n-      my $ordinalsfile = defined($args{ordinals}) ? $args{ordinals}->[1] : \"\";\n-      my $engine_opt = abs2rel(rel2abs(catfile($config{sourcedir},\n-                                               \"VMS\", \"engine.opt\")),\n-                               rel2abs($config{builddir}));\n-      my $mkdef_pl = abs2rel(rel2abs(catfile($config{sourcedir},\n-                                             \"util\", \"mkdef.pl\")),\n-                             rel2abs($config{builddir}));\n       my $translatesyms_pl = abs2rel(rel2abs(catfile($config{sourcedir},\n                                                      \"VMS\", \"translatesyms.pl\")),\n                                      rel2abs($config{builddir}));\n       # The \"[]\" hack is because in .OPT files, each line inherits the\n       # previous line's file spec as default, so if no directory spec\n       # is present in the current line and the previous line has one that\n       # doesn't apply, you're in for a surprise.\n-      my $write_opt =\n+      my $write_opt1 =\n+          join(\",-\\\"\\n\\t\", map { my $x = $_ =~ /\\[/ ? $_ : \"[]\".$_;\n+                                 \"WRITE OPT_FILE \\\"$x\" } @objs).\n+          \"\\\"\";\n+      my $write_opt2 =\n           join(\"\\n\\t\", map { my $x = $_ =~ /\\[/ ? $_ : \"[]\".$_;\n                              $x =~ s|(\\.EXE)|$1/SHARE|;\n                              $x =~ s|(\\.OLB)|$1/LIB|;\n                              \"WRITE OPT_FILE \\\"$x\\\"\" } @deps)\n           || \"\\@ !\";\n-      return <<\"EOF\";\n-$shlib.EXE : $lib.OLB $deps $ordinalsfile\n-        \\$(PERL) $mkdef_pl \"$mkdef_key\" \"VMS\" > $shlib.SYMVEC-tmp\n-        \\$(PERL) $translatesyms_pl \\$(BLDDIR)CXX\\$DEMANGLER_DB. < $shlib.SYMVEC-tmp > $shlib.SYMVEC\n-        DELETE $shlib.SYMVEC-tmp;*\n-        OPEN/WRITE/SHARE=READ OPT_FILE $shlib.OPT\n-        WRITE OPT_FILE \"IDENTIFICATION=\"\"V$config{version}\"\"\"\n-        TYPE $shlib.SYMVEC /OUTPUT=OPT_FILE:\n-        WRITE OPT_FILE \"$lib.OLB/LIBRARY\"\n-        $write_opt\n+      return <<\"EOF\"\n+$shlib.EXE : $lib.OLB $deps\n+        \\$(PERL) $translatesyms_pl \\$(BLDDIR)CXX\\$DEMANGLER_DB. < $defs[0] > $defs[0]-translated\n+        OPEN/WRITE/SHARE=READ OPT_FILE $lib-components.OPT\n+        $write_opt1\n+        $write_opt2\n         CLOSE OPT_FILE\n-        LINK /MAP=$shlib.MAP /FULL/SHARE=$shlib.EXE $shlib.OPT/OPT \\$(EX_LIBS)\n-        DELETE $shlib.SYMVEC;*\n-        PURGE $shlib.EXE,$shlib.OPT,$shlib.MAP\n+        LINK \\$(LIB_LDFLAGS)/SHARE=\\$\\@ $defs[0]-translated/OPT,-\n+                $lib-components.OPT/OPT \\$(LIB_EX_LIBS)\n+        DELETE $defs[0]-translated;*,$lib-components.OPT;*\n+        PURGE $shlib.EXE,$shlib.MAP\n EOF\n+        . ($config{target} =~ m|alpha| ? \"\" : <<\"EOF\"\n+        SET IMAGE/FLAGS=(NOCALL_DEBUG) \\$\\@\n+EOF\n+        );\n   }\n   sub obj2dso {\n       my %args = @_;\n       my $lib = $args{lib};\n       my $libd = dirname($lib);\n       my $libn = basename($lib);\n       (my $libn_nolib = $libn) =~ s/^lib//;\n-      my @objs = map { \"$_.OBJ\" } @{$args{objs}};\n-      my @deps = map {\n-          $disabled{shared} ? $_.\".OLB\"\n-              : $unified_info{sharednames}->{$_}.\".EXE\"; } @{$args{deps}};\n+      my @objs = map { (my $x = $_) =~ s|\\.o$|.OBJ|; $x } @{$args{objs}};\n+      my @deps = compute_lib_depends(@{$args{deps}});\n       my $deps = join(\", -\\n\\t\\t\", @objs, @deps);\n       my $shlib_target = $disabled{shared} ? \"\" : $target{shared_target};\n       my $engine_opt = abs2rel(rel2abs(catfile($config{sourcedir},\n@@ -699,23 +967,28 @@ EOF\n                              $x =~ s|(\\.OLB)|$1/LIB|;\n                              \"WRITE OPT_FILE \\\"$x\\\"\" } @deps)\n           || \"\\@ !\";\n-      return <<\"EOF\";\n+      return <<\"EOF\"\n $lib.EXE : $deps\n         OPEN/WRITE/SHARE=READ OPT_FILE $lib.OPT\n         TYPE $engine_opt /OUTPUT=OPT_FILE:\n         $write_opt1\n         $write_opt2\n         CLOSE OPT_FILE\n-        LINK /MAP=$lib.MAP /FULL/SHARE=$lib.EXE $lib.OPT/OPT \\$(EX_LIBS)\n+        LINK \\$(DSO_LDFLAGS)/SHARE=\\$\\@ $lib.OPT/OPT \\$(DSO_EX_LIBS)\n         - PURGE $lib.EXE,$lib.OPT,$lib.MAP\n EOF\n+        . ($config{target} =~ m|alpha| ? \"\" : <<\"EOF\"\n+        SET IMAGE/FLAGS=(NOCALL_DEBUG) \\$\\@\n+EOF\n+        );\n   }\n   sub obj2lib {\n       my %args = @_;\n-      my $lib = $args{lib};\n-      my $objs = join(\", -\\n\\t\\t\", map { $_.\".OBJ\" } (@{$args{objs}}));\n-      my $fill_lib = join(\"\\n\\t\", (map { \"LIBRARY/REPLACE $lib.OLB $_.OBJ\" }\n-                                    @{$args{objs}}));\n+      (my $lib = $args{lib}) =~ s/\\.a$//;\n+      my @objs = map { (my $x = $_) =~ s|\\.o$|.OBJ|; $x } @{$args{objs}};\n+      my $objs = join(\", -\\n\\t\\t\", @objs);\n+      my $fill_lib = join(\"\\n\\t\", (map { \"LIBRARY/REPLACE $lib.OLB $_\" }\n+                                   @objs));\n       return <<\"EOF\";\n $lib.OLB : $objs\n         LIBRARY/CREATE/OBJECT $lib.OLB\n@@ -728,34 +1001,91 @@ EOF\n       my $bin = $args{bin};\n       my $bind = dirname($bin);\n       my $binn = basename($bin);\n-      my @objs = map { \"$_.OBJ\" } @{$args{objs}};\n-      my @deps = map {\n-          $disabled{shared} ? $_.\".OLB\"\n-              : $unified_info{sharednames}->{$_}.\".EXE\"; } @{$args{deps}};\n+      my @objs = map { (my $x = $_) =~ s|\\.o$|.OBJ|; $x } @{$args{objs}};\n+      my $objs = join(\",\", @objs);\n+      my @deps = compute_lib_depends(@{$args{deps}});\n       my $deps = join(\", -\\n\\t\\t\", @objs, @deps);\n+\n+      my $olb_count = scalar grep(m|\\.OLB$|, @deps);\n+      my $analyse_objs = \"@ !\";\n+      if ($olb_count > 0) {\n+          my $analyse_quals =\n+              $config{target} =~ m|alpha| ? \"/GSD\" : \"/SECTIONS=SYMTAB\";\n+          $analyse_objs = \"- pipe ANALYSE/OBJECT$analyse_quals $objs | SEARCH SYS\\$INPUT \\\"\\\"\\\"main\\\"\\\"\\\" ; nomain = \\$severity .NE. 1\"\n+      }\n       # The \"[]\" hack is because in .OPT files, each line inherits the\n       # previous line's file spec as default, so if no directory spec\n       # is present in the current line and the previous line has one that\n       # doesn't apply, you're in for a surprise.\n       my $write_opt1 =\n           join(\",-\\\"\\n\\t\", map { my $x = $_ =~ /\\[/ ? $_ : \"[]\".$_;\n-                                 \"WRITE OPT_FILE \\\"$x\" } @objs).\n+                                 \"\\@ WRITE OPT_FILE \\\"$x\" } @objs).\n           \"\\\"\";\n       my $write_opt2 =\n-          join(\"\\n\\t\", map { my $x = $_ =~ /\\[/ ? $_ : \"[]\".$_;\n-                             $x =~ s|(\\.EXE)|$1/SHARE|;\n-                             $x =~ s|(\\.OLB)|$1/LIB|;\n-                             \"WRITE OPT_FILE \\\"$x\\\"\" } @deps)\n+          join(\"\\n\\t\", map { my @lines = ();\n+                             my $x = $_ =~ /\\[/ ? $_ : \"[]\".$_;\n+                             if ($x =~ m|\\.EXE$|) {\n+                                 push @lines, \"\\@ WRITE OPT_FILE \\\"$x/SHARE\\\"\";\n+                             } elsif ($x =~ m|\\.OLB$|) {\n+                                 (my $l = $x) =~ s/\\W/_/g;\n+                                 push @lines, \n+                                     \"\\@ IF nomain THEN WRITE OPT_FILE \\\"$x/LIB\\$(INCLUDE_MAIN_$l)\\\"\",\n+                                     \"\\@ IF .NOT. nomain THEN WRITE OPT_FILE \\\"$x/LIB\\\"\"\n+                             }\n+                             @lines\n+                           } @deps)\n           || \"\\@ !\";\n-      return <<\"EOF\";\n+      # The linking commands looks a bit complex, but it's for good reason.\n+      # When you link, say, foo.obj, bar.obj and libsomething.exe/share, and\n+      # bar.obj happens to have a symbol that also exists in libsomething.exe,\n+      # the linker will warn about it, loudly, and will then choose to pick\n+      # the first copy encountered (the one in bar.obj in this example).\n+      # On Unix and on Windows, the corresponding maneuvre goes through\n+      # silently with the same effect.\n+      # With some test programs, made for checking the internals of OpenSSL,\n+      # we do this kind of linking deliberately, picking a few specific object\n+      # files from within [.crypto] or [.ssl] so we can reach symbols that are\n+      # otherwise unreachable (since the shareable images only exports the\n+      # symbols listed in [.util]*.num), and then with the shared libraries\n+      # themselves.  So we need to silence the warning about multiply defined\n+      # symbols, to mimic the way linking work on Unix and Windows, and so\n+      # the build isn't interrupted (MMS stops when warnings are signaled,\n+      # by default), and so someone building doesn't have to worry where it\n+      # isn't necessary.  If there are other warnings, however, we show them\n+      # and let it break the build.\n+      return <<\"EOF\"\n $bin.EXE : $deps\n-        OPEN/WRITE/SHARE=READ OPT_FILE $bin.OPT\n+        $analyse_objs\n+        @ OPEN/WRITE/SHARE=READ OPT_FILE $bin.OPT\n         $write_opt1\n         $write_opt2\n-        CLOSE OPT_FILE\n-        LINK/EXEC=$bin.EXE \\$(LDFLAGS) $bin.OPT/OPT \\$(EX_LIBS)\n+        @ CLOSE OPT_FILE\n+        TYPE $bin.opt ! For debugging\n+        - pipe SPAWN/WAIT/NOLOG/OUT=$bin.LINKLOG -\n+                    LINK \\$(BIN_LDFLAGS)/EXEC=\\$\\@ $bin.OPT/OPT \\$(BIN_EX_LIBS) ; -\n+               link_status = \\$status ; link_severity = link_status .AND. 7\n+        @ search_severity = 1\n+        -@ IF link_severity .EQ. 0 THEN -\n+                pipe SEARCH $bin.LINKLOG \"%\",\"-\"/MATCH=AND | -\n+                     SPAWN/WAIT/NOLOG/OUT=NLA0: -\n+                          SEARCH SYS\\$INPUT: \"-W-MULDEF,\"/MATCH=NOR ; -\n+                     search_severity = \\$severity\n+        @ ! search_severity is 3 when the last search didn't find any matching\n+        @ ! string: %SEARCH-I-NOMATCHES, no strings matched\n+        @ ! If that was the result, we pretend linking got through without\n+        @ ! fault or warning.\n+        @ IF search_severity .EQ. 3 THEN link_severity = 1\n+        @ ! At this point, if link_severity shows that there was a fault\n+        @ ! or warning, make sure to restore the linking status.\n+        -@ IF .NOT. link_severity THEN TYPE $bin.LINKLOG\n+        -@ DELETE $bin.LINKLOG;*\n+        @ IF .NOT. link_severity THEN SPAWN/WAIT/NOLOG EXIT 'link_status'\n         - PURGE $bin.EXE,$bin.OPT\n EOF\n+      . ($config{target} =~ m|alpha| ? \"\" : <<\"EOF\"\n+        SET IMAGE/FLAGS=(NOCALL_DEBUG) \\$\\@\n+EOF\n+        );\n   }\n   sub in2script {\n       my %args = @_;"
        },
        {
            "sha": "2a458bcddfa77fa999a51d79eaffa468e18e7888",
            "filename": "deps/openssl/openssl/Configurations/dist.conf",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fdist.conf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fdist.conf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fdist.conf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -2,11 +2,11 @@\n ## Build configuration targets for openssl-team members\n \n # This is to support 'make dist'\n-%targets = (\n+my %targets = (\n     \"dist\" => {\n         inherit_from     => [ 'BASE_unix' ],\n-        cc               => \"cc\",\n-        cflags           => \"-O\",\n+        CC               => \"cc\",\n+        CFLAGS           => \"-O\",\n         thread_scheme    => \"(unknown)\",\n     },\n );"
        },
        {
            "sha": "47eddd68355bb1f914e55bbde6e72c9d70db5d01",
            "filename": "deps/openssl/openssl/Configurations/shared-info.pl",
            "status": "added",
            "additions": 82,
            "deletions": 0,
            "changes": 82,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fshared-info.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fshared-info.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fshared-info.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,82 @@\n+#! /usr/bin/env perl\n+# -*- mode: perl; -*-\n+# Copyright 2016-2018 The OpenSSL Project Authors. All Rights Reserved.\n+#\n+# Licensed under the OpenSSL license (the \"License\").  You may not use\n+# this file except in compliance with the License.  You can obtain a copy\n+# in the file LICENSE in the source distribution or at\n+# https://www.openssl.org/source/license.html\n+\n+# This is a collection of extra attributes to be used as input for creating\n+# shared libraries, currently on any Unix variant, including Unix like\n+# environments on Windows.\n+\n+sub detect_gnu_ld {\n+    my @lines =\n+        `$config{CROSS_COMPILE}$config{CC} -Wl,-V /dev/null 2>&1`;\n+    return grep /^GNU ld/, @lines;\n+}\n+sub detect_gnu_cc {\n+    my @lines =\n+        `$config{CROSS_COMPILE}$config{CC} -v 2>&1`;\n+    return grep /gcc/, @lines;\n+}\n+\n+my %shared_info;\n+%shared_info = (\n+    'gnu-shared' => {\n+        shared_ldflag         => '-shared -Wl,-Bsymbolic',\n+        shared_sonameflag     => '-Wl,-soname=',\n+    },\n+    'linux-shared' => sub {\n+        return {\n+            %{$shared_info{'gnu-shared'}},\n+            shared_defflag    => '-Wl,--version-script=',\n+        };\n+    },\n+    'bsd-gcc-shared' => sub { return $shared_info{'linux-shared'}; },\n+    'bsd-shared' => sub {\n+        return $shared_info{'gnu-shared'} if detect_gnu_ld();\n+        return {\n+            shared_ldflag     => '-shared -nostdlib',\n+        };\n+    },\n+    'darwin-shared' => {\n+        module_ldflags        => '-bundle',\n+        shared_ldflag         => '-dynamiclib -current_version $(SHLIB_VERSION_NUMBER) -compatibility_version $(SHLIB_VERSION_NUMBER)',\n+        shared_sonameflag     => '-install_name $(INSTALLTOP)/$(LIBDIR)/',\n+    },\n+    'cygwin-shared' => {\n+        shared_ldflag         => '-shared -Wl,--enable-auto-image-base',\n+        shared_impflag        => '-Wl,--out-implib=',\n+    },\n+    'mingw-shared' => sub {\n+        return {\n+            %{$shared_info{'cygwin-shared'}},\n+            # def_flag made to empty string so  it still generates\n+            # something\n+            shared_defflag    => '',\n+        };\n+    },\n+    'alpha-osf1-shared' => sub {\n+        return $shared_info{'gnu-shared'} if detect_gnu_ld();\n+        return {\n+            module_ldflags    => '-shared -Wl,-Bsymbolic',\n+            shared_ldflag     => '-shared -Wl,-Bsymbolic -set_version $(SHLIB_VERSION_NUMBER)',\n+        };\n+    },\n+    'svr3-shared' => sub {\n+        return $shared_info{'gnu-shared'} if detect_gnu_ld();\n+        return {\n+            shared_ldflag     => '-G',\n+            shared_sonameflag => '-h ',\n+        };\n+    },\n+    'svr5-shared' => sub {\n+        return $shared_info{'gnu-shared'} if detect_gnu_ld();\n+        return {\n+            shared_ldflag     => detect_gnu_cc() ? '-shared' : '-G',\n+            shared_sonameflag => '-h ',\n+        };\n+    },\n+);"
        },
        {
            "sha": "e7120194ef8c081840f9a4b768c8058f4f6088d0",
            "filename": "deps/openssl/openssl/Configurations/unix-Makefile.tmpl",
            "status": "modified",
            "additions": 525,
            "deletions": 301,
            "changes": 826,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Funix-Makefile.tmpl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Funix-Makefile.tmpl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Funix-Makefile.tmpl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -12,12 +12,17 @@\n      our $shlibextsimple = $target{shared_extension_simple} || \".so\";\n      our $shlibextimport = $target{shared_import_extension} || \"\";\n      our $dsoext = $target{dso_extension} || \".so\";\n+     our $makedepprog = $disabled{makedepend} ? undef : $config{makedepprog};\n \n      sub windowsdll { $config{target} =~ /^(?:Cygwin|mingw)/ }\n \n-     our $sover = $config{target} =~ /^mingw/\n-         ? $config{shlib_major}.\"_\".$config{shlib_minor}\n-         : $config{shlib_major}.\".\".$config{shlib_minor};\n+     # Shared AIX support is special. We put libcrypto[64].so.ver into\n+     # libcrypto.a and use libcrypto_a.a as static one.\n+     sub sharedaix  { !$disabled{shared} && $config{target} =~ /^aix/ }\n+\n+     our $sover_dirname = $config{shlib_version_number};\n+     $sover_dirname =~ s|\\.|_|g\n+         if $config{target} =~ /^mingw/;\n \n      # shlib and shlib_simple both take a static library name and figure\n      # out what the shlib name should be.\n@@ -39,18 +44,24 @@\n      # removed.  On some systems, they may therefore return the exact same\n      # string.\n      sub shlib {\n-         return () if $disabled{shared};\n          my $lib = shift;\n-         return $unified_info{sharednames}->{$lib}. $shlibvariant. $shlibext;\n+         return () if $disabled{shared} || $lib =~ /\\.a$/;\n+         return $unified_info{sharednames}->{$lib}. $shlibvariant. '$(SHLIB_EXT)';\n      }\n      sub shlib_simple {\n-         return () if $disabled{shared};\n-\n          my $lib = shift;\n+         return () if $disabled{shared} || $lib =~ /\\.a$/;\n+\n          if (windowsdll()) {\n-             return $lib . $shlibextimport;\n+             return $lib . '$(SHLIB_EXT_IMPORT)';\n          }\n-         return $lib .  $shlibextsimple;\n+         return $lib .  '$(SHLIB_EXT_SIMPLE)';\n+     }\n+\n+     # Easy fixing of static library names\n+     sub lib {\n+         (my $lib = shift) =~ s/\\.a$//;\n+         return $lib . $libext;\n      }\n \n      # dso is a complement to shlib / shlib_simple that returns the\n@@ -84,8 +95,11 @@ SHLIB_VERSION_HISTORY={- $config{shlib_version_history} -}\n SHLIB_MAJOR={- $config{shlib_major} -}\n SHLIB_MINOR={- $config{shlib_minor} -}\n SHLIB_TARGET={- $target{shared_target} -}\n+SHLIB_EXT={- $shlibext -}\n+SHLIB_EXT_SIMPLE={- $shlibextsimple -}\n+SHLIB_EXT_IMPORT={- $shlibextimport -}\n \n-LIBS={- join(\" \", map { $_.$libext } @{$unified_info{libraries}}) -}\n+LIBS={- join(\" \", map { lib($_) } @{$unified_info{libraries}}) -}\n SHLIBS={- join(\" \", map { shlib($_) } @{$unified_info{libraries}}) -}\n SHLIB_INFO={- join(\" \", map { \"\\\"\".shlib($_).\";\".shlib_simple($_).\"\\\"\" } @{$unified_info{libraries}}) -}\n ENGINES={- join(\" \", map { dso($_) } @{$unified_info{engines}}) -}\n@@ -96,21 +110,18 @@ DEPS={- join(\" \", map { (my $x = $_) =~ s|\\.o$|$depext|; $x; }\n                   grep { $unified_info{sources}->{$_}->[0] =~ /\\.c$/ }\n                   keys %{$unified_info{sources}}); -}\n {- output_on() if $disabled{makedepend}; \"\" -}\n-GENERATED_MANDATORY={- join(\" \", @{$unified_info{depends}->{\"\"}} ) -}\n-GENERATED={- join(\" \",\n-                  ( grep { defined $unified_info{generate}->{$_} }\n-                    map { @{$unified_info{sources}->{$_}} }\n-                    grep { /\\.o$/ } keys %{$unified_info{sources}} ),\n-                  ( grep { /\\.h$/ } keys %{$unified_info{generate}} )) -}\n-\n-INSTALL_LIBS={- join(\" \", map { $_.$libext } @{$unified_info{install}->{libraries}}) -}\n+GENERATED_MANDATORY={- join(\" \", @{$unified_info{depends}->{\"\"}}) -}\n+GENERATED={- # common0.tmpl provides @generated\n+             join(\" \", @generated ) -}\n+\n+INSTALL_LIBS={- join(\" \", map { lib($_) } @{$unified_info{install}->{libraries}}) -}\n INSTALL_SHLIBS={- join(\" \", map { shlib($_) } @{$unified_info{install}->{libraries}}) -}\n INSTALL_SHLIB_INFO={- join(\" \", map { \"\\\"\".shlib($_).\";\".shlib_simple($_).\"\\\"\" } @{$unified_info{install}->{libraries}}) -}\n INSTALL_ENGINES={- join(\" \", map { dso($_) } @{$unified_info{install}->{engines}}) -}\n INSTALL_PROGRAMS={- join(\" \", map { $_.$exeext } @{$unified_info{install}->{programs}}) -}\n {- output_off() if $disabled{apps}; \"\" -}\n BIN_SCRIPTS=$(BLDDIR)/tools/c_rehash\n-MISC_SCRIPTS=$(BLDDIR)/apps/CA.pl $(BLDDIR)/apps/tsget\n+MISC_SCRIPTS=$(BLDDIR)/apps/CA.pl $(BLDDIR)/apps/tsget.pl:tsget\n {- output_on() if $disabled{apps}; \"\" -}\n \n APPS_OPENSSL={- use File::Spec::Functions;\n@@ -144,21 +155,26 @@ OPENSSLDIR={- #\n                            : catdir($prefix, $config{openssldir}))\n                       : catdir($prefix, \"ssl\");\n               $openssldir -}\n-LIBDIR={- #\n-          # if $prefix/lib$target{multilib} is not an existing\n-          # directory, then assume that it's not searched by linker\n-          # automatically, in which case adding $target{multilib} suffix\n-          # causes more grief than we're ready to tolerate, so don't...\n-          our $multilib =\n-              -d \"$prefix/lib$target{multilib}\" ? $target{multilib} : \"\";\n-          our $libdir = $config{libdir} || \"lib$multilib\";\n-          $libdir -}\n-ENGINESDIR={- use File::Spec::Functions;\n-              catdir($prefix,$libdir,\"engines-$sover\") -}\n+LIBDIR={- our $libdir = $config{libdir};\n+          unless ($libdir) {\n+              #\n+              # if $prefix/lib$target{multilib} is not an existing\n+              # directory, then assume that it's not searched by linker\n+              # automatically, in which case adding $target{multilib} suffix\n+              # causes more grief than we're ready to tolerate, so don't...\n+              our $multilib =\n+                  -d \"$prefix/lib$target{multilib}\" ? $target{multilib} : \"\";\n+              $libdir = \"lib$multilib\";\n+          }\n+          file_name_is_absolute($libdir) ? \"\" : $libdir -}\n+# $(libdir) is chosen to be compatible with the GNU coding standards\n+libdir={- file_name_is_absolute($libdir)\n+          ? $libdir : '$(INSTALLTOP)/$(LIBDIR)' -}\n+ENGINESDIR=$(libdir)/engines-{- $sover_dirname -}\n \n # Convenience variable for those who want to set the rpath in shared\n # libraries and applications\n-LIBRPATH=$(INSTALLTOP)/$(LIBDIR)\n+LIBRPATH=$(libdir)\n \n MANDIR=$(INSTALLTOP)/share/man\n DOCDIR=$(INSTALLTOP)/share/doc/$(BASENAME)\n@@ -170,45 +186,144 @@ HTMLDIR=$(DOCDIR)/html\n MANSUFFIX=\n HTMLSUFFIX=html\n \n+# For \"optional\" echo messages, to get \"real\" silence\n+ECHO = echo\n+\n+##### User defined commands and flags ################################\n+\n+# We let the C compiler driver to take care of .s files. This is done in\n+# order to be excused from maintaining a separate set of architecture\n+# dependent assembler flags. E.g. if you throw -mcpu=ultrasparc at SPARC\n+# gcc, then the driver will automatically translate it to -xarch=v8plus\n+# and pass it down to assembler.  In any case, we do not define AS or\n+# ASFLAGS for this reason.\n+\n+CROSS_COMPILE={- $config{CROSS_COMPILE} -}\n+CC=$(CROSS_COMPILE){- $config{CC} -}\n+CXX={- $config{CXX} ? \"\\$(CROSS_COMPILE)$config{CXX}\" : '' -}\n+CPPFLAGS={- our $cppflags1 = join(\" \",\n+                                  (map { \"-D\".$_} @{$config{CPPDEFINES}}),\n+                                  (map { \"-I\".$_} @{$config{CPPINCLUDES}}),\n+                                  @{$config{CPPFLAGS}}) -}\n+CFLAGS={- join(' ', @{$config{CFLAGS}}) -}\n+CXXFLAGS={- join(' ', @{$config{CXXFLAGS}}) -}\n+LDFLAGS= {- join(' ', @{$config{LDFLAGS}}) -}\n+EX_LIBS= {- join(' ', @{$config{LDLIBS}}) -}\n+\n+MAKEDEPEND={- $config{makedepprog} -}\n+\n+PERL={- $config{PERL} -}\n \n+AR=$(CROSS_COMPILE){- $config{AR} -}\n+ARFLAGS= {- join(' ', @{$config{ARFLAGS}}) -}\n+RANLIB={- $config{RANLIB} ? \"\\$(CROSS_COMPILE)$config{RANLIB}\" : \"true\"; -}\n+RC= $(CROSS_COMPILE){- $config{RC} -}\n+RCFLAGS={- join(' ', @{$config{RCFLAGS}}) -} {- $target{shared_rcflag} -}\n \n-CROSS_COMPILE= {- $config{cross_compile_prefix} -}\n-CC= $(CROSS_COMPILE){- $target{cc} -}\n-CFLAGS={- our $cflags2 = join(\" \",(map { \"-D\".$_} @{$target{defines}}, @{$config{defines}}),\"-DOPENSSLDIR=\\\"\\\\\\\"\\$(OPENSSLDIR)\\\\\\\"\\\"\",\"-DENGINESDIR=\\\"\\\\\\\"\\$(ENGINESDIR)\\\\\\\"\\\"\") -} {- $target{cflags} -} {- $config{cflags} -}\n-CFLAGS_Q={- $cflags2 =~ s|([\\\\\"])|\\\\$1|g; $cflags2 -} {- $config{cflags} -}\n-LDFLAGS= {- $target{lflags} -}\n-PLIB_LDFLAGS= {- $target{plib_lflags} -}\n-EX_LIBS= {- $target{ex_libs} -} {- $config{ex_libs} -}\n-LIB_CFLAGS={- $target{shared_cflag} || \"\" -}\n-LIB_LDFLAGS={- $target{shared_ldflag}.\" \".$config{shared_ldflag} -}\n-DSO_CFLAGS={- $target{shared_cflag} || \"\" -}\n-DSO_LDFLAGS=$(LIB_LDFLAGS)\n-BIN_CFLAGS={- $target{bin_cflags} -}\n-\n-PERL={- $config{perl} -}\n-\n-ARFLAGS= {- $target{arflags} -}\n-AR=$(CROSS_COMPILE){- $target{ar} || \"ar\" -} $(ARFLAGS) r\n-RANLIB= {- $target{ranlib} -}\n-NM= $(CROSS_COMPILE){- $target{nm} || \"nm\" -}\n-RCFLAGS={- $target{shared_rcflag} -}\n-RC= $(CROSS_COMPILE){- $target{rc} || \"windres\" -}\n RM= rm -f\n RMDIR= rmdir\n-TAR= {- $target{tar} || \"tar\" -}\n-TARFLAGS= {- $target{tarflags} -}\n-MAKEDEPEND={- $config{makedepprog} -}\n+TAR= {- $target{TAR} || \"tar\" -}\n+TARFLAGS= {- $target{TARFLAGS} -}\n \n BASENAME=       openssl\n NAME=           $(BASENAME)-$(VERSION)\n TARFILE=        ../$(NAME).tar\n \n-# We let the C compiler driver to take care of .s files. This is done in\n-# order to be excused from maintaining a separate set of architecture\n-# dependent assembler flags. E.g. if you throw -mcpu=ultrasparc at SPARC\n-# gcc, then the driver will automatically translate it to -xarch=v8plus\n-# and pass it down to assembler.  In any case, we do not define AS or\n-# ASFLAGS for this reason.\n+##### Project flags ##################################################\n+\n+# Variables starting with CNF_ are common variables for all product types\n+\n+CNF_CPPFLAGS={- our $cppflags2 =\n+                    join(' ', $target{cppflags} || (),\n+                              (map { \"-D\".$_} @{$target{defines}},\n+                                              @{$config{defines}}),\n+                              (map { \"-I\".$_} @{$target{includes}},\n+                                              @{$config{includes}}),\n+                              @{$config{cppflags}}) -}\n+CNF_CFLAGS={- join(' ', $target{cflags} || (),\n+                        @{$config{cflags}}) -}\n+CNF_CXXFLAGS={- join(' ', $target{cxxflags} || (),\n+                          @{$config{cxxflags}}) -}\n+CNF_LDFLAGS={- join(' ', $target{lflags} || (),\n+                         @{$config{lflags}}) -}\n+CNF_EX_LIBS={- join(' ', $target{ex_libs} || (),\n+                         @{$config{ex_libs}}) -}\n+\n+# Variables starting with LIB_ are used to build library object files\n+# and shared libraries.\n+# Variables starting with DSO_ are used to build DSOs and their object files.\n+# Variables starting with BIN_ are used to build programs and their object\n+# files.\n+\n+LIB_CPPFLAGS={- our $lib_cppflags =\n+                join(' ', $target{lib_cppflags} || (),\n+                          $target{shared_cppflag} || (),\n+                          (map { '-D'.$_ }\n+                               @{$config{lib_defines}},\n+                               @{$config{shared_defines}}),\n+                          @{$config{lib_cppflags}},\n+                          @{$config{shared_cppflag}});\n+                join(' ', $lib_cppflags,\n+                          (map { '-D'.$_ }\n+                               'OPENSSLDIR=\"\\\"$(OPENSSLDIR)\\\"\"',\n+                               'ENGINESDIR=\"\\\"$(ENGINESDIR)\\\"\"'),\n+                          '$(CNF_CPPFLAGS)', '$(CPPFLAGS)') -}\n+LIB_CFLAGS={- join(' ', $target{lib_cflags} || (),\n+                        $target{shared_cflag} || (),\n+                        @{$config{lib_cflags}},\n+                        @{$config{shared_cflag}},\n+                        '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+LIB_CXXFLAGS={- join(' ', $target{lib_cxxflags} || (),\n+                          $target{shared_cxxflag} || (),\n+                          @{$config{lib_cxxflags}},\n+                          @{$config{shared_cxxflag}},\n+                          '$(CNF_CXXFLAGS)', '$(CXXFLAGS)') -}\n+LIB_LDFLAGS={- join(' ', $target{shared_ldflag} || (),\n+                         $config{shared_ldflag} || (),\n+                         '$(CNF_LDFLAGS)', '$(LDFLAGS)') -}\n+LIB_EX_LIBS=$(CNF_EX_LIBS) $(EX_LIBS)\n+DSO_CPPFLAGS={- join(' ', $target{dso_cppflags} || (),\n+                          $target{module_cppflags} || (),\n+                          @{$config{dso_cppflags}},\n+                          @{$config{module_cppflags}},\n+                          '$(CNF_CPPFLAGS)', '$(CPPFLAGS)') -}\n+DSO_CFLAGS={- join(' ', $target{dso_cflags} || (),\n+                        $target{module_cflags} || (),\n+                        @{$config{dso_cflags}},\n+                        @{$config{module_cflags}},\n+                        '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+DSO_CXXFLAGS={- join(' ', $target{dso_cxxflags} || (),\n+                          $target{module_cxxflags} || (),\n+                          @{$config{dso_cxxflags}},\n+                          @{$config{module_cxxflag}},\n+                          '$(CNF_CXXFLAGS)', '$(CXXFLAGS)') -}\n+DSO_LDFLAGS={- join(' ', $target{dso_ldflags} || (),\n+                         $target{module_ldflags} || (),\n+                         @{$config{dso_ldflags}},\n+                         @{$config{module_ldflags}},\n+                         '$(CNF_LDFLAGS)', '$(LDFLAGS)') -}\n+DSO_EX_LIBS=$(CNF_EX_LIBS) $(EX_LIBS)\n+BIN_CPPFLAGS={- join(' ', $target{bin_cppflags} || (),\n+                          @{$config{bin_cppflags}},\n+                          '$(CNF_CPPFLAGS)', '$(CPPFLAGS)') -}\n+BIN_CFLAGS={- join(' ', $target{bin_cflags} || (),\n+                        @{$config{bin_cflags}},\n+                        '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+BIN_CXXFLAGS={- join(' ', $target{bin_cxxflags} || (),\n+                          @{$config{bin_cxxflags}},\n+                          '$(CNF_CXXFLAGS)', '$(CXXFLAGS)') -}\n+BIN_LDFLAGS={- join(' ', $target{bin_lflags} || (),\n+                         @{$config{bin_lflags}},\n+                         '$(CNF_LDFLAGS)', '$(LDFLAGS)') -}\n+BIN_EX_LIBS=$(CNF_EX_LIBS) $(EX_LIBS)\n+\n+# CPPFLAGS_Q is used for one thing only: to build up buildinf.h\n+CPPFLAGS_Q={- $cppflags1 =~ s|([\\\\\"])|\\\\$1|g;\n+              $cppflags2 =~ s|([\\\\\"])|\\\\$1|g;\n+              $lib_cppflags =~ s|([\\\\\"])|\\\\$1|g;\n+              join(' ', $lib_cppflags || (), $cppflags2 || (),\n+                        $cppflags1 || ()) -}\n+\n PERLASM_SCHEME= {- $target{perlasm_scheme} -}\n \n # For x86 assembler: Set PROCESSOR to 386 if you want to support\n@@ -242,6 +357,11 @@ build_apps build_tests: build_programs\n # Convenience target to prebuild all generated files, not just the mandatory\n # ones\n build_all_generated: $(GENERATED_MANDATORY) $(GENERATED)\n+\t@ : {- output_off() if $disabled{makedepend}; \"\" -}\n+\t@echo \"Warning: consider configuring with no-makedepend, because if\"\n+\t@echo \"         target system doesn't have $(PERL),\"\n+\t@echo \"         then make will fail...\"\n+\t@ : {- output_on() if $disabled{makedepend}; \"\" -}\n \n test: tests\n {- dependmagic('tests'); -}: build_programs_nodep build_engines_nodep link-utils\n@@ -253,7 +373,7 @@ test: tests\n \t  RESULT_D=test-runs \\\n \t  PERL=\"$(PERL)\" \\\n \t  EXE_EXT={- $exeext -} \\\n-\t  OPENSSL_ENGINES=`cd ../$(BLDDIR)/engines; pwd` \\\n+\t  OPENSSL_ENGINES=`cd ../$(BLDDIR)/engines 2>/dev/null && pwd` \\\n \t  OPENSSL_DEBUG_MEMORY=on \\\n \t    $(PERL) ../$(SRCDIR)/test/run_tests.pl $(TESTS) )\n \t@ : {- if ($disabled{tests}) { output_on(); } else { output_off(); } \"\" -}\n@@ -274,12 +394,16 @@ uninstall: uninstall_docs uninstall_sw\n \n libclean:\n \t@set -e; for s in $(SHLIB_INFO); do \\\n+\t\tif [ \"$$s\" = \";\" ]; then continue; fi; \\\n \t\ts1=`echo \"$$s\" | cut -f1 -d\";\"`; \\\n \t\ts2=`echo \"$$s\" | cut -f2 -d\";\"`; \\\n-\t\techo $(RM) $$s1; \\\n+\t\t$(ECHO) $(RM) $$s1; {- output_off() unless windowsdll(); \"\" -}\\\n+\t\t$(RM) apps/$$s1; \\\n+\t\t$(RM) test/$$s1; \\\n+\t\t$(RM) fuzz/$$s1; {- output_on() unless windowsdll(); \"\" -}\\\n \t\t$(RM) $$s1; \\\n \t\tif [ \"$$s1\" != \"$$s2\" ]; then \\\n-\t\t\techo $(RM) $$s2; \\\n+\t\t\t$(ECHO) $(RM) $$s2; \\\n \t\t\t$(RM) $$s2; \\\n \t\tfi; \\\n \tdone\n@@ -288,14 +412,14 @@ libclean:\n \n clean: libclean\n \t$(RM) $(PROGRAMS) $(TESTPROGS) $(ENGINES) $(SCRIPTS)\n-\t$(RM) $(GENERATED)\n-\t-$(RM) `find . -name '*{- $depext -}' -a \\! -path \"./.git/*\"`\n-\t-$(RM) `find . -name '*{- $objext -}' -a \\! -path \"./.git/*\"`\n+\t$(RM) $(GENERATED_MANDATORY) $(GENERATED)\n+\t-$(RM) `find . -name .git -prune -o -name '*{- $depext -}' -print`\n+\t-$(RM) `find . -name .git -prune -o -name '*{- $objext -}' -print`\n \t$(RM) core\n \t$(RM) tags TAGS doc-nits\n \t$(RM) -r test/test-runs\n \t$(RM) openssl.pc libcrypto.pc libssl.pc\n-\t-$(RM) `find . -type l -a \\! -path \"./.git/*\"`\n+\t-$(RM) `find . -name .git -prune -o -type l -print`\n \t$(RM) $(TARFILE)\n \n distclean: clean\n@@ -306,19 +430,9 @@ distclean: clean\n # concatenate only if that is true.\n depend:\n \t@: {- output_off() if $disabled{makedepend}; \"\" -}\n-\t@if egrep \"^# DO NOT DELETE THIS LINE\" Makefile >/dev/null && [ -z \"`find $(DEPS) -newer Makefile 2>/dev/null; exit 0`\" ]; then :; else \\\n-\t  ( $(PERL) -pe 'exit 0 if /^# DO NOT DELETE THIS LINE.*/' < Makefile; \\\n-\t    echo '# DO NOT DELETE THIS LINE -- make depend depends on it.'; \\\n-\t    echo; \\\n-\t    for f in $(DEPS); do \\\n-\t      if [ -f $$f ]; then cat $$f; fi; \\\n-\t    done ) > Makefile.new; \\\n-\t  if cmp Makefile.new Makefile >/dev/null 2>&1; then \\\n-\t    rm -f Makefile.new; \\\n-\t  else \\\n-\t    mv -f Makefile.new Makefile; \\\n-\t  fi; \\\n-\tfi\n+\t@$(PERL) $(SRCDIR)/util/add-depends.pl {-\n+\t\t defined $makedepprog  && $makedepprog =~ /\\/makedepend/\n+                 ? 'makedepend' : 'gcc' -}\n \t@: {- output_on() if $disabled{makedepend}; \"\" -}\n \n # Install helper targets #############################################\n@@ -338,103 +452,135 @@ install_ssldirs:\n \t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(OPENSSLDIR)/misc\n \t@set -e; for x in dummy $(MISC_SCRIPTS); do \\\n \t\tif [ \"$$x\" = \"dummy\" ]; then continue; fi; \\\n-\t\tfn=`basename $$x`; \\\n-\t\techo \"install $$x -> $(DESTDIR)$(OPENSSLDIR)/misc/$$fn\"; \\\n-\t\tcp $$x $(DESTDIR)$(OPENSSLDIR)/misc/$$fn.new; \\\n+\t\tx1=`echo \"$$x\" | cut -f1 -d:`; \\\n+\t\tx2=`echo \"$$x\" | cut -f2 -d:`; \\\n+\t\tfn=`basename $$x1`; \\\n+\t\t$(ECHO) \"install $$x1 -> $(DESTDIR)$(OPENSSLDIR)/misc/$$fn\"; \\\n+\t\tcp $$x1 $(DESTDIR)$(OPENSSLDIR)/misc/$$fn.new; \\\n \t\tchmod 755 $(DESTDIR)$(OPENSSLDIR)/misc/$$fn.new; \\\n \t\tmv -f $(DESTDIR)$(OPENSSLDIR)/misc/$$fn.new \\\n \t\t      $(DESTDIR)$(OPENSSLDIR)/misc/$$fn; \\\n+\t\tif [ \"$$x1\" != \"$$x2\" ]; then \\\n+\t\t\tln=`basename \"$$x2\"`; \\\n+\t\t\t: {- output_off() unless windowsdll(); \"\" -}; \\\n+\t\t\t$(ECHO) \"copy $(DESTDIR)$(OPENSSLDIR)/misc/$$ln -> $(DESTDIR)$(OPENSSLDIR)/misc/$$fn\"; \\\n+\t\t\tcp $(DESTDIR)$(OPENSSLDIR)/misc/$$fn $(DESTDIR)$(OPENSSLDIR)/misc/$$ln; \\\n+\t\t\t: {- output_on() unless windowsdll();\n+\t\t\t     output_off() if windowsdll(); \"\" -}; \\\n+\t\t\t$(ECHO) \"link $(DESTDIR)$(OPENSSLDIR)/misc/$$ln -> $(DESTDIR)$(OPENSSLDIR)/misc/$$fn\"; \\\n+\t\t\tln -sf $$fn $(DESTDIR)$(OPENSSLDIR)/misc/$$ln; \\\n+\t\t\t: {- output_on() if windowsdll(); \"\" -}; \\\n+\t\tfi; \\\n \tdone\n-\t@echo \"install $(SRCDIR)/apps/openssl.cnf -> $(DESTDIR)$(OPENSSLDIR)/openssl.cnf.dist\"\n+\t@$(ECHO) \"install $(SRCDIR)/apps/openssl.cnf -> $(DESTDIR)$(OPENSSLDIR)/openssl.cnf.dist\"\n \t@cp $(SRCDIR)/apps/openssl.cnf $(DESTDIR)$(OPENSSLDIR)/openssl.cnf.new\n \t@chmod 644 $(DESTDIR)$(OPENSSLDIR)/openssl.cnf.new\n \t@mv -f  $(DESTDIR)$(OPENSSLDIR)/openssl.cnf.new $(DESTDIR)$(OPENSSLDIR)/openssl.cnf.dist\n-\t@if ! [ -f \"$(DESTDIR)$(OPENSSLDIR)/openssl.cnf\" ]; then \\\n-\t\techo \"install $(SRCDIR)/apps/openssl.cnf -> $(DESTDIR)$(OPENSSLDIR)/openssl.cnf\"; \\\n+\t@if [ ! -f \"$(DESTDIR)$(OPENSSLDIR)/openssl.cnf\" ]; then \\\n+\t\t$(ECHO) \"install $(SRCDIR)/apps/openssl.cnf -> $(DESTDIR)$(OPENSSLDIR)/openssl.cnf\"; \\\n \t\tcp $(SRCDIR)/apps/openssl.cnf $(DESTDIR)$(OPENSSLDIR)/openssl.cnf; \\\n \t\tchmod 644 $(DESTDIR)$(OPENSSLDIR)/openssl.cnf; \\\n \tfi\n+\t@$(ECHO) \"install $(SRCDIR)/apps/ct_log_list.cnf -> $(DESTDIR)$(OPENSSLDIR)/ct_log_list.cnf.dist\"\n+\t@cp $(SRCDIR)/apps/ct_log_list.cnf $(DESTDIR)$(OPENSSLDIR)/ct_log_list.cnf.new\n+\t@chmod 644 $(DESTDIR)$(OPENSSLDIR)/ct_log_list.cnf.new\n+\t@mv -f  $(DESTDIR)$(OPENSSLDIR)/ct_log_list.cnf.new $(DESTDIR)$(OPENSSLDIR)/ct_log_list.cnf.dist\n+\t@if [ ! -f \"$(DESTDIR)$(OPENSSLDIR)/ct_log_list.cnf\" ]; then \\\n+\t\t$(ECHO) \"install $(SRCDIR)/apps/ct_log_list.cnf -> $(DESTDIR)$(OPENSSLDIR)/ct_log_list.cnf\"; \\\n+\t\tcp $(SRCDIR)/apps/ct_log_list.cnf $(DESTDIR)$(OPENSSLDIR)/ct_log_list.cnf; \\\n+\t\tchmod 644 $(DESTDIR)$(OPENSSLDIR)/ct_log_list.cnf; \\\n+\tfi\n \n install_dev: install_runtime_libs\n \t@[ -n \"$(INSTALLTOP)\" ] || (echo INSTALLTOP should not be empty; exit 1)\n-\t@echo \"*** Installing development files\"\n+\t@$(ECHO) \"*** Installing development files\"\n \t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(INSTALLTOP)/include/openssl\n-\t@ : {- output_off() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } @{$target{defines}}; \"\" -}\n-\t@echo \"install $(SRCDIR)/ms/applink.c -> $(DESTDIR)$(INSTALLTOP)/include/openssl/applink.c\"\n+\t@ : {- output_off() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } (@{$target{defines}}, @{$config{defines}}); \"\" -}\n+\t@$(ECHO) \"install $(SRCDIR)/ms/applink.c -> $(DESTDIR)$(INSTALLTOP)/include/openssl/applink.c\"\n \t@cp $(SRCDIR)/ms/applink.c $(DESTDIR)$(INSTALLTOP)/include/openssl/applink.c\n \t@chmod 644 $(DESTDIR)$(INSTALLTOP)/include/openssl/applink.c\n-\t@ : {- output_on() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } @{$target{defines}}; \"\" -}\n+\t@ : {- output_on() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } (@{$target{defines}}, @{$config{defines}}); \"\" -}\n \t@set -e; for i in $(SRCDIR)/include/openssl/*.h \\\n \t\t\t  $(BLDDIR)/include/openssl/*.h; do \\\n \t\tfn=`basename $$i`; \\\n-\t\techo \"install $$i -> $(DESTDIR)$(INSTALLTOP)/include/openssl/$$fn\"; \\\n+\t\t$(ECHO) \"install $$i -> $(DESTDIR)$(INSTALLTOP)/include/openssl/$$fn\"; \\\n \t\tcp $$i $(DESTDIR)$(INSTALLTOP)/include/openssl/$$fn; \\\n \t\tchmod 644 $(DESTDIR)$(INSTALLTOP)/include/openssl/$$fn; \\\n \tdone\n-\t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)\n+\t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(libdir)\n \t@set -e; for l in $(INSTALL_LIBS); do \\\n \t\tfn=`basename $$l`; \\\n-\t\techo \"install $$l -> $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn\"; \\\n-\t\tcp $$l $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn.new; \\\n-\t\t$(RANLIB) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn.new; \\\n-\t\tchmod 644 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn.new; \\\n-\t\tmv -f $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn.new \\\n-\t\t      $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn; \\\n+\t\t$(ECHO) \"install $$l -> $(DESTDIR)$(libdir)/$$fn\"; \\\n+\t\tcp $$l $(DESTDIR)$(libdir)/$$fn.new; \\\n+\t\t$(RANLIB) $(DESTDIR)$(libdir)/$$fn.new; \\\n+\t\tchmod 644 $(DESTDIR)$(libdir)/$$fn.new; \\\n+\t\tmv -f $(DESTDIR)$(libdir)/$$fn.new \\\n+\t\t      $(DESTDIR)$(libdir)/$$fn; \\\n \tdone\n \t@ : {- output_off() if $disabled{shared}; \"\" -}\n \t@set -e; for s in $(INSTALL_SHLIB_INFO); do \\\n \t\ts1=`echo \"$$s\" | cut -f1 -d\";\"`; \\\n \t\ts2=`echo \"$$s\" | cut -f2 -d\";\"`; \\\n \t\tfn1=`basename $$s1`; \\\n \t\tfn2=`basename $$s2`; \\\n-\t\t: {- output_off() if windowsdll(); \"\" -}; \\\n-\t\techo \"install $$s1 -> $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn1\"; \\\n-\t\tcp $$s1 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn1.new; \\\n-\t\tchmod 755 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn1.new; \\\n-\t\tmv -f $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn1.new \\\n-\t\t      $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn1; \\\n+\t\t: {- output_off(); output_on() unless windowsdll() or sharedaix(); \"\" -}; \\\n \t\tif [ \"$$fn1\" != \"$$fn2\" ]; then \\\n-\t\t\techo \"link $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2 -> $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn1\"; \\\n-\t\t\tln -sf $$fn1 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2; \\\n+\t\t\t$(ECHO) \"link $(DESTDIR)$(libdir)/$$fn2 -> $(DESTDIR)$(libdir)/$$fn1\"; \\\n+\t\t\tln -sf $$fn1 $(DESTDIR)$(libdir)/$$fn2; \\\n \t\tfi; \\\n-\t\t: {- output_on() if windowsdll(); \"\" -}{- output_off() unless windowsdll(); \"\" -}; \\\n-\t\techo \"install $$s2 -> $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2\"; \\\n-\t\tcp $$s2 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2.new; \\\n-\t\tchmod 755 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2.new; \\\n-\t\tmv -f $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2.new \\\n-\t\t      $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2; \\\n-\t\t: {- output_on() unless windowsdll(); \"\" -}; \\\n+\t\t: {- output_off() unless windowsdll() or sharedaix(); output_on() if windowsdll(); \"\" -}; \\\n+\t\t$(ECHO) \"install $$s2 -> $(DESTDIR)$(libdir)/$$fn2\"; \\\n+\t\tcp $$s2 $(DESTDIR)$(libdir)/$$fn2.new; \\\n+\t\tchmod 755 $(DESTDIR)$(libdir)/$$fn2.new; \\\n+\t\tmv -f $(DESTDIR)$(libdir)/$$fn2.new \\\n+\t\t      $(DESTDIR)$(libdir)/$$fn2; \\\n+\t\t: {- output_off() if windowsdll(); output_on() if sharedaix(); \"\" -}; \\\n+\t\ta=$(DESTDIR)$(libdir)/$$fn2; \\\n+\t\t$(ECHO) \"install $$s1 -> $$a\"; \\\n+\t\tif [ -f $$a ]; then ( trap \"rm -rf /tmp/ar.$$$$\" INT 0; \\\n+\t\t\tmkdir /tmp/ar.$$$$; ( cd /tmp/ar.$$$$; \\\n+\t\t\tcp -f $$a $$a.new; \\\n+\t\t\tfor so in `$(AR) t $$a`; do \\\n+\t\t\t\t$(AR) x $$a $$so; \\\n+\t\t\t\tchmod u+w $$so; \\\n+\t\t\t\tstrip -X32_64 -e $$so; \\\n+\t\t\t\t$(AR) r $$a.new $$so; \\\n+\t\t\tdone; \\\n+\t\t)); fi; \\\n+\t\t$(AR) r $$a.new $$s1; \\\n+\t\tmv -f $$a.new $$a; \\\n+\t\t: {- output_off() if sharedaix(); output_on(); \"\" -}; \\\n \tdone\n \t@ : {- output_on() if $disabled{shared}; \"\" -}\n-\t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig\n-\t@echo \"install libcrypto.pc -> $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig/libcrypto.pc\"\n-\t@cp libcrypto.pc $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig\n-\t@chmod 644 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig/libcrypto.pc\n-\t@echo \"install libssl.pc -> $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig/libssl.pc\"\n-\t@cp libssl.pc $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig\n-\t@chmod 644 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig/libssl.pc\n-\t@echo \"install openssl.pc -> $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig/openssl.pc\"\n-\t@cp openssl.pc $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig\n-\t@chmod 644 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig/openssl.pc\n-\n-uninstall_dev:\n-\t@echo \"*** Uninstalling development files\"\n-\t@ : {- output_off() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } @{$target{defines}}; \"\" -}\n-\t@echo \"$(RM) $(DESTDIR)$(INSTALLTOP)/include/openssl/applink.c\"\n+\t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(libdir)/pkgconfig\n+\t@$(ECHO) \"install libcrypto.pc -> $(DESTDIR)$(libdir)/pkgconfig/libcrypto.pc\"\n+\t@cp libcrypto.pc $(DESTDIR)$(libdir)/pkgconfig\n+\t@chmod 644 $(DESTDIR)$(libdir)/pkgconfig/libcrypto.pc\n+\t@$(ECHO) \"install libssl.pc -> $(DESTDIR)$(libdir)/pkgconfig/libssl.pc\"\n+\t@cp libssl.pc $(DESTDIR)$(libdir)/pkgconfig\n+\t@chmod 644 $(DESTDIR)$(libdir)/pkgconfig/libssl.pc\n+\t@$(ECHO) \"install openssl.pc -> $(DESTDIR)$(libdir)/pkgconfig/openssl.pc\"\n+\t@cp openssl.pc $(DESTDIR)$(libdir)/pkgconfig\n+\t@chmod 644 $(DESTDIR)$(libdir)/pkgconfig/openssl.pc\n+\n+uninstall_dev: uninstall_runtime_libs\n+\t@$(ECHO) \"*** Uninstalling development files\"\n+\t@ : {- output_off() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } (@{$target{defines}}, @{$config{defines}}); \"\" -}\n+\t@$(ECHO) \"$(RM) $(DESTDIR)$(INSTALLTOP)/include/openssl/applink.c\"\n \t@$(RM) $(DESTDIR)$(INSTALLTOP)/include/openssl/applink.c\n-\t@ : {- output_on() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } @{$target{defines}}; \"\" -}\n+\t@ : {- output_on() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } (@{$target{defines}}, @{$config{defines}}); \"\" -}\n \t@set -e; for i in $(SRCDIR)/include/openssl/*.h \\\n \t\t\t  $(BLDDIR)/include/openssl/*.h; do \\\n \t\tfn=`basename $$i`; \\\n-\t\techo \"$(RM) $(DESTDIR)$(INSTALLTOP)/include/openssl/$$fn\"; \\\n+\t\t$(ECHO) \"$(RM) $(DESTDIR)$(INSTALLTOP)/include/openssl/$$fn\"; \\\n \t\t$(RM) $(DESTDIR)$(INSTALLTOP)/include/openssl/$$fn; \\\n \tdone\n \t-$(RMDIR) $(DESTDIR)$(INSTALLTOP)/include/openssl\n \t-$(RMDIR) $(DESTDIR)$(INSTALLTOP)/include\n \t@set -e; for l in $(INSTALL_LIBS); do \\\n \t\tfn=`basename $$l`; \\\n-\t\techo \"$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn\"; \\\n-\t\t$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn; \\\n+\t\t$(ECHO) \"$(RM) $(DESTDIR)$(libdir)/$$fn\"; \\\n+\t\t$(RM) $(DESTDIR)$(libdir)/$$fn; \\\n \tdone\n \t@ : {- output_off() if $disabled{shared}; \"\" -}\n \t@set -e; for s in $(INSTALL_SHLIB_INFO); do \\\n@@ -443,47 +589,47 @@ uninstall_dev:\n \t\tfn1=`basename $$s1`; \\\n \t\tfn2=`basename $$s2`; \\\n \t\t: {- output_off() if windowsdll(); \"\" -}; \\\n-\t\techo \"$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn1\"; \\\n-\t\t$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn1; \\\n-\t\tif [ \"$$fn1\" != \"$$fn2\" ]; then \\\n-\t\t\techo \"$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2\"; \\\n-\t\t\t$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2; \\\n+\t\t$(ECHO) \"$(RM) $(DESTDIR)$(libdir)/$$fn2\"; \\\n+\t\t$(RM) $(DESTDIR)$(libdir)/$$fn2; \\\n+\t\tif [ \"$$fn1\" != \"$$fn2\" -a -f \"$(DESTDIR)$(libdir)/$$fn1\" ]; then \\\n+\t\t\t$(ECHO) \"$(RM) $(DESTDIR)$(libdir)/$$fn1\"; \\\n+\t\t\t$(RM) $(DESTDIR)$(libdir)/$$fn1; \\\n \t\tfi; \\\n \t\t: {- output_on() if windowsdll(); \"\" -}{- output_off() unless windowsdll(); \"\" -}; \\\n-\t\techo \"$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2\"; \\\n-\t\t$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn2; \\\n+\t\t$(ECHO) \"$(RM) $(DESTDIR)$(libdir)/$$fn2\"; \\\n+\t\t$(RM) $(DESTDIR)$(libdir)/$$fn2; \\\n \t\t: {- output_on() unless windowsdll(); \"\" -}; \\\n \tdone\n \t@ : {- output_on() if $disabled{shared}; \"\" -}\n-\t$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig/libcrypto.pc\n-\t$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig/libssl.pc\n-\t$(RM) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig/openssl.pc\n-\t-$(RMDIR) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/pkgconfig\n-\t-$(RMDIR) $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)\n+\t$(RM) $(DESTDIR)$(libdir)/pkgconfig/libcrypto.pc\n+\t$(RM) $(DESTDIR)$(libdir)/pkgconfig/libssl.pc\n+\t$(RM) $(DESTDIR)$(libdir)/pkgconfig/openssl.pc\n+\t-$(RMDIR) $(DESTDIR)$(libdir)/pkgconfig\n+\t-$(RMDIR) $(DESTDIR)$(libdir)\n \n install_engines: install_runtime_libs build_engines\n \t@[ -n \"$(INSTALLTOP)\" ] || (echo INSTALLTOP should not be empty; exit 1)\n \t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(ENGINESDIR)/\n-\t@echo \"*** Installing engines\"\n+\t@$(ECHO) \"*** Installing engines\"\n \t@set -e; for e in dummy $(INSTALL_ENGINES); do \\\n \t\tif [ \"$$e\" = \"dummy\" ]; then continue; fi; \\\n \t\tfn=`basename $$e`; \\\n-\t\techo \"install $$e -> $(DESTDIR)$(ENGINESDIR)/$$fn\"; \\\n+\t\t$(ECHO) \"install $$e -> $(DESTDIR)$(ENGINESDIR)/$$fn\"; \\\n \t\tcp $$e $(DESTDIR)$(ENGINESDIR)/$$fn.new; \\\n \t\tchmod 755 $(DESTDIR)$(ENGINESDIR)/$$fn.new; \\\n \t\tmv -f $(DESTDIR)$(ENGINESDIR)/$$fn.new \\\n \t\t      $(DESTDIR)$(ENGINESDIR)/$$fn; \\\n \tdone\n \n uninstall_engines:\n-\t@echo \"*** Uninstalling engines\"\n+\t@$(ECHO) \"*** Uninstalling engines\"\n \t@set -e; for e in dummy $(INSTALL_ENGINES); do \\\n \t\tif [ \"$$e\" = \"dummy\" ]; then continue; fi; \\\n \t\tfn=`basename $$e`; \\\n \t\tif [ \"$$fn\" = '{- dso(\"ossltest\") -}' ]; then \\\n \t\t\tcontinue; \\\n \t\tfi; \\\n-\t\techo \"$(RM) $(DESTDIR)$(ENGINESDIR)/$$fn\"; \\\n+\t\t$(ECHO) \"$(RM) $(DESTDIR)$(ENGINESDIR)/$$fn\"; \\\n \t\t$(RM) $(DESTDIR)$(ENGINESDIR)/$$fn; \\\n \tdone\n \t-$(RMDIR) $(DESTDIR)$(ENGINESDIR)\n@@ -493,35 +639,37 @@ install_runtime: install_programs\n install_runtime_libs: build_libs\n \t@[ -n \"$(INSTALLTOP)\" ] || (echo INSTALLTOP should not be empty; exit 1)\n \t@ : {- output_off() if windowsdll(); \"\" -}\n-\t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)\n-\t@ : {- output_on() if windowsdll(); \"\" -}\n-\t@echo \"*** Installing runtime files\"\n+\t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(libdir)\n+\t@ : {- output_on() if windowsdll(); output_off() unless windowsdll(); \"\" -}\n+\t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(INSTALLTOP)/bin\n+\t@ : {- output_on() unless windowsdll(); \"\" -}\n+\t@$(ECHO) \"*** Installing runtime libraries\"\n \t@set -e; for s in dummy $(INSTALL_SHLIBS); do \\\n \t\tif [ \"$$s\" = \"dummy\" ]; then continue; fi; \\\n \t\tfn=`basename $$s`; \\\n \t\t: {- output_off() unless windowsdll(); \"\" -}; \\\n-\t\techo \"install $$s -> $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n+\t\t$(ECHO) \"install $$s -> $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n \t\tcp $$s $(DESTDIR)$(INSTALLTOP)/bin/$$fn.new; \\\n \t\tchmod 644 $(DESTDIR)$(INSTALLTOP)/bin/$$fn.new; \\\n \t\tmv -f $(DESTDIR)$(INSTALLTOP)/bin/$$fn.new \\\n \t\t      $(DESTDIR)$(INSTALLTOP)/bin/$$fn; \\\n \t\t: {- output_on() unless windowsdll(); \"\" -}{- output_off() if windowsdll(); \"\" -}; \\\n-\t\techo \"install $$s -> $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn\"; \\\n-\t\tcp $$s $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn.new; \\\n-\t\tchmod 755 $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn.new; \\\n-\t\tmv -f $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn.new \\\n-\t\t      $(DESTDIR)$(INSTALLTOP)/$(LIBDIR)/$$fn; \\\n+\t\t$(ECHO) \"install $$s -> $(DESTDIR)$(libdir)/$$fn\"; \\\n+\t\tcp $$s $(DESTDIR)$(libdir)/$$fn.new; \\\n+\t\tchmod 755 $(DESTDIR)$(libdir)/$$fn.new; \\\n+\t\tmv -f $(DESTDIR)$(libdir)/$$fn.new \\\n+\t\t      $(DESTDIR)$(libdir)/$$fn; \\\n \t\t: {- output_on() if windowsdll(); \"\" -}; \\\n \tdone\n \n install_programs: install_runtime_libs build_programs\n \t@[ -n \"$(INSTALLTOP)\" ] || (echo INSTALLTOP should not be empty; exit 1)\n \t@$(PERL) $(SRCDIR)/util/mkdir-p.pl $(DESTDIR)$(INSTALLTOP)/bin\n-\t@echo \"*** Installing runtime programs\"\n+\t@$(ECHO) \"*** Installing runtime programs\"\n \t@set -e; for x in dummy $(INSTALL_PROGRAMS); do \\\n \t\tif [ \"$$x\" = \"dummy\" ]; then continue; fi; \\\n \t\tfn=`basename $$x`; \\\n-\t\techo \"install $$x -> $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n+\t\t$(ECHO) \"install $$x -> $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n \t\tcp $$x $(DESTDIR)$(INSTALLTOP)/bin/$$fn.new; \\\n \t\tchmod 755 $(DESTDIR)$(INSTALLTOP)/bin/$$fn.new; \\\n \t\tmv -f $(DESTDIR)$(INSTALLTOP)/bin/$$fn.new \\\n@@ -530,7 +678,7 @@ install_programs: install_runtime_libs build_programs\n \t@set -e; for x in dummy $(BIN_SCRIPTS); do \\\n \t\tif [ \"$$x\" = \"dummy\" ]; then continue; fi; \\\n \t\tfn=`basename $$x`; \\\n-\t\techo \"install $$x -> $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n+\t\t$(ECHO) \"install $$x -> $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n \t\tcp $$x $(DESTDIR)$(INSTALLTOP)/bin/$$fn.new; \\\n \t\tchmod 755 $(DESTDIR)$(INSTALLTOP)/bin/$$fn.new; \\\n \t\tmv -f $(DESTDIR)$(INSTALLTOP)/bin/$$fn.new \\\n@@ -540,55 +688,55 @@ install_programs: install_runtime_libs build_programs\n uninstall_runtime: uninstall_programs uninstall_runtime_libs\n \n uninstall_programs:\n-\t@echo \"*** Uninstalling runtime programs\"\n+\t@$(ECHO) \"*** Uninstalling runtime programs\"\n \t@set -e; for x in dummy $(INSTALL_PROGRAMS); \\\n \tdo  \\\n \t\tif [ \"$$x\" = \"dummy\" ]; then continue; fi; \\\n \t\tfn=`basename $$x`; \\\n-\t\techo \"$(RM) $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n+\t\t$(ECHO) \"$(RM) $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n \t\t$(RM) $(DESTDIR)$(INSTALLTOP)/bin/$$fn; \\\n \tdone;\n \t@set -e; for x in dummy $(BIN_SCRIPTS); \\\n \tdo  \\\n \t\tif [ \"$$x\" = \"dummy\" ]; then continue; fi; \\\n \t\tfn=`basename $$x`; \\\n-\t\techo \"$(RM) $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n+\t\t$(ECHO) \"$(RM) $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n \t\t$(RM) $(DESTDIR)$(INSTALLTOP)/bin/$$fn; \\\n \tdone\n \t-$(RMDIR) $(DESTDIR)$(INSTALLTOP)/bin\n \n uninstall_runtime_libs:\n-\t@echo \"*** Uninstalling runtime libraries\"\n+\t@$(ECHO) \"*** Uninstalling runtime libraries\"\n \t@ : {- output_off() unless windowsdll(); \"\" -}\n \t@set -e; for s in dummy $(INSTALL_SHLIBS); do \\\n \t\tif [ \"$$s\" = \"dummy\" ]; then continue; fi; \\\n \t\tfn=`basename $$s`; \\\n-\t\techo \"$(RM) $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n+\t\t$(ECHO) \"$(RM) $(DESTDIR)$(INSTALLTOP)/bin/$$fn\"; \\\n \t\t$(RM) $(DESTDIR)$(INSTALLTOP)/bin/$$fn; \\\n \tdone\n \t@ : {- output_on() unless windowsdll(); \"\" -}\n \n \n install_man_docs:\n \t@[ -n \"$(INSTALLTOP)\" ] || (echo INSTALLTOP should not be empty; exit 1)\n-\t@echo \"*** Installing manpages\"\n+\t@$(ECHO) \"*** Installing manpages\"\n \t$(PERL) $(SRCDIR)/util/process_docs.pl \\\n \t\t--destdir=$(DESTDIR)$(MANDIR) --type=man --suffix=$(MANSUFFIX)\n \n uninstall_man_docs:\n-\t@echo \"*** Uninstalling manpages\"\n+\t@$(ECHO) \"*** Uninstalling manpages\"\n \t$(PERL) $(SRCDIR)/util/process_docs.pl \\\n \t\t--destdir=$(DESTDIR)$(MANDIR) --type=man --suffix=$(MANSUFFIX) \\\n \t\t--remove\n \n install_html_docs:\n \t@[ -n \"$(INSTALLTOP)\" ] || (echo INSTALLTOP should not be empty; exit 1)\n-\t@echo \"*** Installing HTML manpages\"\n+\t@$(ECHO) \"*** Installing HTML manpages\"\n \t$(PERL) $(SRCDIR)/util/process_docs.pl \\\n \t\t--destdir=$(DESTDIR)$(HTMLDIR) --type=html\n \n uninstall_html_docs:\n-\t@echo \"*** Uninstalling manpages\"\n+\t@$(ECHO) \"*** Uninstalling manpages\"\n \t$(PERL) $(SRCDIR)/util/process_docs.pl \\\n \t\t--destdir=$(DESTDIR)$(HTMLDIR) --type=html --remove\n \n@@ -598,11 +746,13 @@ uninstall_html_docs:\n update: generate errors ordinals\n \n generate: generate_apps generate_crypto_bn generate_crypto_objects \\\n-          generate_crypto_conf generate_crypto_asn1\n+          generate_crypto_conf generate_crypto_asn1 generate_fuzz_oids\n \n+.PHONY: doc-nits\n doc-nits:\n-\t(cd $(SRCDIR); $(PERL) util/find-doc-nits -n ) >doc-nits\n-\tif [ -s doc-nits ] ; then cat doc-nits; rm doc-nits ; exit 1; fi\n+\t(cd $(SRCDIR); $(PERL) util/find-doc-nits -n -p ) >doc-nits\n+\t@if [ -s doc-nits ] ; then cat doc-nits ; exit 1; \\\n+\telse echo 'doc-nits: no errors.'; rm doc-nits ; fi\n \n # Test coverage is a good idea for the future\n #coverage: $(PROGRAMS) $(TESTPROGRAMS)\n@@ -619,13 +769,18 @@ generate_crypto_bn:\n \t( cd $(SRCDIR); $(PERL) crypto/bn/bn_prime.pl > crypto/bn/bn_prime.h )\n \n generate_crypto_objects:\n+\t( cd $(SRCDIR); $(PERL) crypto/objects/objects.pl -n \\\n+\t\t\t\tcrypto/objects/objects.txt \\\n+\t\t\t\tcrypto/objects/obj_mac.num \\\n+\t\t\t\t> crypto/objects/obj_mac.new && \\\n+\t    mv crypto/objects/obj_mac.new crypto/objects/obj_mac.num )\n \t( cd $(SRCDIR); $(PERL) crypto/objects/objects.pl \\\n \t\t\t\tcrypto/objects/objects.txt \\\n \t\t\t\tcrypto/objects/obj_mac.num \\\n-\t\t\t\tinclude/openssl/obj_mac.h )\n+\t\t\t\t> include/openssl/obj_mac.h )\n \t( cd $(SRCDIR); $(PERL) crypto/objects/obj_dat.pl \\\n \t\t\t\tinclude/openssl/obj_mac.h \\\n-\t\t\t\tcrypto/objects/obj_dat.h )\n+\t\t\t\t> crypto/objects/obj_dat.h )\n \t( cd $(SRCDIR); $(PERL) crypto/objects/objxref.pl \\\n \t\t\t\tcrypto/objects/obj_mac.num \\\n \t\t\t\tcrypto/objects/obj_xref.txt \\\n@@ -639,14 +794,24 @@ generate_crypto_asn1:\n \t( cd $(SRCDIR); $(PERL) crypto/asn1/charmap.pl \\\n \t\t\t        > crypto/asn1/charmap.h )\n \n+generate_fuzz_oids:\n+\t( cd $(SRCDIR); $(PERL) fuzz/mkfuzzoids.pl \\\n+\t\t\t\tcrypto/objects/obj_dat.h \\\n+\t\t\t\t> fuzz/oids.txt )\n+\n+# Set to -force to force a rebuild\n+ERROR_REBUILD=\n errors:\n-\t( cd $(SRCDIR); $(PERL) util/ck_errf.pl -strict */*.c */*/*.c )\n-\t( cd $(SRCDIR); $(PERL) util/mkerr.pl -recurse -write )\n-\t( cd $(SRCDIR)/engines; \\\n-\t  for e in *.ec; do \\\n-\t      $(PERL) ../util/mkerr.pl -conf $$e \\\n-\t\t      -nostatic -staticloader -write *.c; \\\n-\t  done )\n+\t( b=`pwd`; set -e; cd $(SRCDIR); \\\n+          $(PERL) util/ck_errf.pl -strict -internal; \\\n+          $(PERL) -I$$b util/mkerr.pl $(ERROR_REBUILD) -internal )\n+\t( b=`pwd`; set -e; cd $(SRCDIR)/engines; \\\n+          for E in *.ec ; do \\\n+              $(PERL) ../util/ck_errf.pl -strict \\\n+                -conf $$E `basename $$E .ec`.c; \\\n+              $(PERL) -I$$b ../util/mkerr.pl $(ERROR_REBUILD) -static \\\n+                -conf $$E `basename $$E .ec`.c ; \\\n+          done )\n \n ordinals:\n \t( b=`pwd`; cd $(SRCDIR); $(PERL) -I$$b util/mkdef.pl crypto update )\n@@ -667,15 +832,16 @@ tags TAGS: FORCE\n \n # If your tar command doesn't support --owner and --group, make sure to\n # use one that does, for example GNU tar\n-TAR_COMMAND=$(TAR) $(TARFLAGS) --owner 0 --group 0 -cvf -\n+TAR_COMMAND=$(TAR) $(TARFLAGS) --owner 0 --group 0 -cf -\n PREPARE_CMD=:\n tar:\n \tset -e; \\\n \tTMPDIR=/var/tmp/openssl-copy.$$$$; \\\n \tDISTDIR=$(NAME); \\\n \tmkdir -p $$TMPDIR/$$DISTDIR; \\\n \t(cd $(SRCDIR); \\\n-\t excl_re=\"^(fuzz/corpora|Configurations/.*\\.norelease\\.conf)\"; \\\n+\t excl_re=`git submodule status | sed -e 's/^.//' | cut -d' ' -f2`; \\\n+\t excl_re=\"^(fuzz/corpora|Configurations/.*\\.norelease\\.conf|`echo $$excl_re | sed -e 's/ /$$|/g'`\\$$)\"; \\\n \t echo \"$$excl_re\"; \\\n \t git ls-tree -r --name-only --full-tree HEAD \\\n \t | egrep -v \"$$excl_re\" \\\n@@ -694,7 +860,7 @@ tar:\n \tcd $(SRCDIR); ls -l $(TARFILE).gz\n \n dist:\n-\t@$(MAKE) PREPARE_CMD='$(PERL) ./Configure dist' tar\n+\t@$(MAKE) PREPARE_CMD='$(PERL) ./Configure dist' TARFILE=\"$(TARFILE)\" NAME=\"$(NAME)\" tar\n \n # Helper targets #####################################################\n \n@@ -714,21 +880,29 @@ libcrypto.pc libssl.pc openssl.pc: configdata.pm $(LIBS) {- join(\" \",map { shlib\n libcrypto.pc:\n \t@ ( echo 'prefix=$(INSTALLTOP)'; \\\n \t    echo 'exec_prefix=$${prefix}'; \\\n-\t    echo 'libdir=$${exec_prefix}/$(LIBDIR)'; \\\n+\t    if [ -n \"$(LIBDIR)\" ]; then \\\n+\t        echo 'libdir=$${exec_prefix}/$(LIBDIR)'; \\\n+\t    else \\\n+\t        echo 'libdir=$(libdir)'; \\\n+\t    fi; \\\n \t    echo 'includedir=$${prefix}/include'; \\\n-\t    echo 'enginesdir=$${libdir}/engines-{- $sover -}'; \\\n+\t    echo 'enginesdir=$${libdir}/engines-{- $sover_dirname -}'; \\\n \t    echo ''; \\\n \t    echo 'Name: OpenSSL-libcrypto'; \\\n \t    echo 'Description: OpenSSL cryptography library'; \\\n \t    echo 'Version: '$(VERSION); \\\n \t    echo 'Libs: -L$${libdir} -lcrypto'; \\\n-\t    echo 'Libs.private: $(EX_LIBS)'; \\\n+\t    echo 'Libs.private: $(LIB_EX_LIBS)'; \\\n \t    echo 'Cflags: -I$${includedir}' ) > libcrypto.pc\n \n libssl.pc:\n \t@ ( echo 'prefix=$(INSTALLTOP)'; \\\n \t    echo 'exec_prefix=$${prefix}'; \\\n-\t    echo 'libdir=$${exec_prefix}/$(LIBDIR)'; \\\n+\t    if [ -n \"$(LIBDIR)\" ]; then \\\n+\t        echo 'libdir=$${exec_prefix}/$(LIBDIR)'; \\\n+\t    else \\\n+\t        echo 'libdir=$(libdir)'; \\\n+\t    fi; \\\n \t    echo 'includedir=$${prefix}/include'; \\\n \t    echo ''; \\\n \t    echo 'Name: OpenSSL-libssl'; \\\n@@ -741,7 +915,11 @@ libssl.pc:\n openssl.pc:\n \t@ ( echo 'prefix=$(INSTALLTOP)'; \\\n \t    echo 'exec_prefix=$${prefix}'; \\\n-\t    echo 'libdir=$${exec_prefix}/$(LIBDIR)'; \\\n+\t    if [ -n \"$(LIBDIR)\" ]; then \\\n+\t        echo 'libdir=$${exec_prefix}/$(LIBDIR)'; \\\n+\t    else \\\n+\t        echo 'libdir=$(libdir)'; \\\n+\t    fi; \\\n \t    echo 'includedir=$${prefix}/include'; \\\n \t    echo ''; \\\n \t    echo 'Name: OpenSSL'; \\\n@@ -751,15 +929,17 @@ openssl.pc:\n \n configdata.pm: $(SRCDIR)/Configure $(SRCDIR)/config {- join(\" \", @{$config{build_file_templates}}, @{$config{build_infos}}, @{$config{conf_files}}) -}\n \t@echo \"Detected changed: $?\"\n-\t@echo \"Reconfiguring...\"\n-\t$(PERL) $(SRCDIR)/Configure reconf\n+\t$(PERL) configdata.pm -r\n \t@echo \"**************************************************\"\n \t@echo \"***                                            ***\"\n \t@echo \"***   Please run the same make command again   ***\"\n \t@echo \"***                                            ***\"\n \t@echo \"**************************************************\"\n \t@false\n \n+reconfigure reconf:\n+\t$(PERL) configdata.pm -r\n+\n {-\n   use File::Basename;\n   use File::Spec::Functions qw/:DEFAULT abs2rel rel2abs/;\n@@ -768,13 +948,13 @@ configdata.pm: $(SRCDIR)/Configure $(SRCDIR)/config {- join(\" \", @{$config{build\n   # It takes a list of library names and outputs a list of dependencies\n   sub compute_lib_depends {\n       if ($disabled{shared}) {\n-          return map { $_.$libext } @_;\n+          return map { lib($_) } @_;\n       }\n \n       # Depending on shared libraries:\n       # On Windows POSIX layers, we depend on {libname}.dll.a\n       # On Unix platforms, we depend on {shlibname}.so\n-      return map { shlib_simple($_) } @_;\n+      return map { $_ =~ /\\.a$/ ? $`.$libext : shlib_simple($_) } @_;\n   }\n \n   sub generatesrc {\n@@ -811,6 +991,11 @@ EOF\n               die \"Generator type for $args{src} unknown: $generator\\n\";\n           }\n \n+          my $cppflags = {\n+              lib => '$(LIB_CFLAGS) $(LIB_CPPFLAGS)',\n+              dso => '$(DSO_CFLAGS) $(DSO_CPPFLAGS)',\n+              bin => '$(BIN_CFLAGS) $(BIN_CPPFLAGS)'\n+          } -> {$args{intent}};\n           if (defined($generator)) {\n               return <<\"EOF\";\n $args{src}: $args{generator}->[0] $deps\n@@ -819,7 +1004,7 @@ EOF\n           }\n           return <<\"EOF\";\n $args{src}: $args{generator}->[0] $deps\n-\t\\$(CC) $incs \\$(CFLAGS) -E $args{generator}->[0] | \\\\\n+\t\\$(CC) $incs $cppflags -E $args{generator}->[0] | \\\\\n \t\\$(PERL) -ne '/^#(line)?\\\\s*[0-9]+/ or print' > \\$@\n EOF\n       }\n@@ -830,45 +1015,57 @@ EOF\n   # last in the line.  We may therefore need to put back a line ending.\n   sub src2obj {\n       my %args = @_;\n-      my $obj = $args{obj};\n+      (my $obj = $args{obj}) =~ s|\\.o$||;\n       my @srcs = @{$args{srcs}};\n       my $srcs = join(\" \",  @srcs);\n       my $deps = join(\" \", @srcs, @{$args{deps}});\n       my $incs = join(\"\", map { \" -I\".$_ } @{$args{incs}});\n-      unless ($disabled{zlib}) {\n-          if ($withargs{zlib_include}) {\n-              $incs .= \" -I\".$withargs{zlib_include};\n-          }\n+      my $cmd;\n+      my $cmdflags;\n+      my $cmdcompile;\n+      if (grep /\\.rc$/, @srcs) {\n+          $cmd = '$(RC)';\n+          $cmdflags = '$(RCFLAGS)';\n+          $cmdcompile = '';\n+      } elsif (grep /\\.(cc|cpp)$/, @srcs) {\n+          $cmd = '$(CXX)';\n+          $cmdcompile = ' -c';\n+          $cmdflags = {\n+              lib => '$(LIB_CXXFLAGS) $(LIB_CPPFLAGS)',\n+              dso => '$(DSO_CXXFLAGS) $(DSO_CPPFLAGS)',\n+              bin => '$(BIN_CXXFLAGS) $(BIN_CPPFLAGS)'\n+          } -> {$args{intent}};\n+      } else {\n+          $cmd = '$(CC)';\n+          $cmdcompile = ' -c';\n+          $cmdflags = {\n+              lib => '$(LIB_CFLAGS) $(LIB_CPPFLAGS)',\n+              dso => '$(DSO_CFLAGS) $(DSO_CPPFLAGS)',\n+              bin => '$(BIN_CFLAGS) $(BIN_CPPFLAGS)'\n+          } -> {$args{intent}};\n       }\n-      my $ecflags = { lib => '$(LIB_CFLAGS)',\n-                      dso => '$(DSO_CFLAGS)',\n-                      bin => '$(BIN_CFLAGS)' } -> {$args{intent}};\n-      my $makedepprog = $config{makedepprog};\n       my $recipe;\n       # extension-specific rules\n       if (grep /\\.s$/, @srcs) {\n           $recipe .= <<\"EOF\";\n $obj$objext: $deps\n-\t\\$(CC) \\$(CFLAGS) $ecflags -c -o \\$\\@ $srcs\n+\t$cmd $cmdflags -c -o \\$\\@ $srcs\n EOF\n       } elsif (grep /\\.S$/, @srcs) {\n-          # In case one wonders why not just $(CC) -c file.S. While it\n-          # does work with contemporary compilers, there are some legacy\n-          # ones that get it wrong. Hence the elaborate scheme... We\n-          # don't care to maintain dependecy lists, because dependency\n-          # is rather weak, at most one header file that lists constants\n-          # which are assigned in ascending order.\n+          # Originally there was mutli-step rule with $(CC) -E file.S\n+          # followed by $(CC) -c file.s. It compensated for one of\n+          # legacy platform compiler's inability to handle .S files.\n+          # The platform is long discontinued by vendor so there is\n+          # hardly a point to drag it along...\n           $recipe .= <<\"EOF\";\n $obj$objext: $deps\n-\t( trap \"rm -f \\$@.*\" INT 0; \\\\\n-\t  \\$(CC) $incs \\$(CFLAGS) $ecflags -E $srcs | \\\\\n-\t  \\$(PERL) -ne '/^#(line)?\\\\s*[0-9]+/ or print' > \\$@.s && \\\\\n-\t  \\$(CC) \\$(CFLAGS) $ecflags -c -o \\$\\@ \\$@.s )\n+\t$cmd $incs $cmdflags -c -o \\$\\@ $srcs\n EOF\n-      } elsif (!$disabled{makedepend} && $makedepprog !~ /\\/makedepend/) {\n+      } elsif (defined $makedepprog && $makedepprog !~ /\\/makedepend/\n+               && !grep /\\.rc$/, @srcs) {\n           $recipe .= <<\"EOF\";\n $obj$objext: $deps\n-\t\\$(CC) $incs \\$(CFLAGS) $ecflags -MMD -MF $obj$depext.tmp -MT \\$\\@ -c -o \\$\\@ $srcs\n+\t$cmd $incs $cmdflags -MMD -MF $obj$depext.tmp -MT \\$\\@ -c -o \\$\\@ $srcs\n \t\\@touch $obj$depext.tmp\n \t\\@if cmp $obj$depext.tmp $obj$depext > /dev/null 2> /dev/null; then \\\\\n \t\trm -f $obj$depext.tmp; \\\\\n@@ -879,106 +1076,117 @@ EOF\n       } else {\n           $recipe .= <<\"EOF\";\n $obj$objext: $deps\n-\t\\$(CC) $incs \\$(CFLAGS) $ecflags -c -o \\$\\@ $srcs\n+\t$cmd $incs $cmdflags $cmdcompile -o \\$\\@ $srcs\n EOF\n-          if (!$disabled{makedepend} && $makedepprog =~ /\\/makedepend/) {\n+          if (defined $makedepprog  && $makedepprog =~ /\\/makedepend/) {\n               $recipe .= <<\"EOF\";\n-\t-\\$(MAKEDEPEND) -f- -o\"|\\$\\@\" -- $incs \\$(CFLAGS) $ecflags -- $srcs \\\\\n-\t    >$obj$depext.tmp 2>/dev/null\n-\t-\\$(PERL) -i -pe 's/^.*\\\\|//; s/ \\\\/(\\\\\\\\.|[^ ])*//; \\$\\$_ = undef if (/: *\\$\\$/ || /^(#.*| *)\\$\\$/); \\$\\$_.=\"\\\\n\" unless !defined(\\$\\$_) or /\\\\R\\$\\$/g;' $obj$depext.tmp\n-\t\\@if cmp $obj$depext.tmp $obj$depext > /dev/null 2> /dev/null; then \\\\\n-\t\trm -f $obj$depext.tmp; \\\\\n-\telse \\\\\n-\t\tmv $obj$depext.tmp $obj$depext; \\\\\n-\tfi\n+\t\\$(MAKEDEPEND) -f- -Y -- $incs $cmdflags -- $srcs 2>/dev/null \\\\\n+\t    > $obj$depext\n EOF\n           }\n       }\n       return $recipe;\n   }\n-  # On Unix, we build shlibs from static libs, so we're ignoring the\n-  # object file array.  We *know* this routine is only called when we've\n-  # configure 'shared'.\n+  # We *know* this routine is only called when we've configure 'shared'.\n   sub libobj2shlib {\n       my %args = @_;\n       my $lib = $args{lib};\n       my $shlib = $args{shlib};\n       my $libd = dirname($lib);\n       my $libn = basename($lib);\n       (my $libname = $libn) =~ s/^lib//;\n-      my $linklibs = join(\"\", map { my $d = dirname($_);\n-                                    my $f = basename($_);\n+      my @linkdirs = ();\n+      foreach (@{args{deps}}) {\n+          my $d = dirname($_);\n+          push @linkdirs, $d unless grep { $d eq $_ } @linkdirs;\n+      }\n+      my $linkflags = join(\"\", map { \"-L$_ \" } @linkdirs);\n+      my $linklibs = join(\"\", map { my $f = basename($_);\n                                     (my $l = $f) =~ s/^lib//;\n-                                    \" -L$d -l$l\" } @{$args{deps}});\n-      my $deps = join(\" \",compute_lib_depends(@{$args{deps}}));\n-      my $shlib_target = $target{shared_target};\n-      my $ordinalsfile = defined($args{ordinals}) ? $args{ordinals}->[1] : \"\";\n-      my $target = shlib_simple($lib);\n-      my $target_full = shlib($lib);\n-      return <<\"EOF\"\n-# With a build on a Windows POSIX layer (Cygwin or Mingw), we know for a fact\n-# that two files get produced, {shlibname}.dll and {libname}.dll.a.\n-# With all other Unix platforms, we often build a shared library with the\n-# SO version built into the file name and a symlink without the SO version\n-# It's not necessary to have both as targets.  The choice falls on the\n-# simplest, {libname}$shlibextimport for Windows POSIX layers and\n-# {libname}$shlibextsimple for the Unix platforms.\n-$target: $lib$libext $deps $ordinalsfile\n-\t\\$(MAKE) -f \\$(SRCDIR)/Makefile.shared -e \\\\\n-\t\tPLATFORM=\\$(PLATFORM) \\\\\n-\t\tPERL=\"\\$(PERL)\" SRCDIR='\\$(SRCDIR)' DSTDIR=\"$libd\" \\\\\n-\t\tINSTALLTOP='\\$(INSTALLTOP)' LIBDIR='\\$(LIBDIR)' \\\\\n-\t\tLIBDEPS='\\$(PLIB_LDFLAGS) '\"$linklibs\"' \\$(EX_LIBS)' \\\\\n-\t\tLIBNAME=$libname SHLIBVERSION=\\$(SHLIB_MAJOR).\\$(SHLIB_MINOR) \\\\\n-\t\tSTLIBNAME=$lib$libext \\\\\n-\t\tSHLIBNAME=$target SHLIBNAME_FULL=$target_full \\\\\n-\t\tCC='\\$(CC)' CFLAGS='\\$(CFLAGS) \\$(LIB_CFLAGS)' \\\\\n-\t\tLDFLAGS='\\$(LDFLAGS)' SHARED_LDFLAGS='\\$(LIB_LDFLAGS)' \\\\\n-\t\tRC='\\$(RC)' SHARED_RCFLAGS='\\$(RCFLAGS)' \\\\\n-\t\tlink_shlib.$shlib_target\n+                                    \" -l$l\" } @{$args{deps}});\n+      my @objs = map { (my $x = $_) =~ s|\\.o$||; \"$x$objext\" }\n+                 grep { $_ !~ m/\\.(?:def|map)$/ }\n+                 @{$args{objs}};\n+      my @defs = grep { $_ =~ /\\.(?:def|map)$/ } @{$args{objs}};\n+      my @deps = compute_lib_depends(@{$args{deps}});\n+      die \"More than one exported symbol map\" if scalar @defs > 1;\n+      my $objs = join(\" \", @objs);\n+      my $deps = join(\" \", @objs, @defs, @deps);\n+      my $simple = shlib_simple($lib);\n+      my $full = shlib($lib);\n+      my $target = \"$simple $full\";\n+      my $shared_soname = \"\";\n+      $shared_soname .= ' '.$target{shared_sonameflag}.basename($full)\n+          if defined $target{shared_sonameflag};\n+      my $shared_imp = \"\";\n+      $shared_imp .= ' '.$target{shared_impflag}.basename($simple)\n+          if defined $target{shared_impflag};\n+      my $shared_def = join(\"\", map { ' '.$target{shared_defflag}.$_ } @defs);\n+      my $recipe = <<\"EOF\";\n+$target: $deps\n+\t\\$(CC) \\$(LIB_CFLAGS) $linkflags\\$(LIB_LDFLAGS)$shared_soname$shared_imp \\\\\n+\t\t-o $full$shared_def $objs \\\\\n+                $linklibs \\$(LIB_EX_LIBS)\n EOF\n-\t  . (windowsdll() ? <<\"EOF\" : \"\");\n-\trm -f apps/$shlib$shlibext\n-\trm -f test/$shlib$shlibext\n-\trm -f fuzz/$shlib$shlibext\n-\tcp -p $shlib$shlibext apps/\n-\tcp -p $shlib$shlibext test/\n-\tcp -p $shlib$shlibext fuzz/\n+      if (windowsdll()) {\n+          $recipe .= <<\"EOF\";\n+\trm -f apps/$shlib'\\$(SHLIB_EXT)'\n+\trm -f test/$shlib'\\$(SHLIB_EXT)'\n+\trm -f fuzz/$shlib'\\$(SHLIB_EXT)'\n+\tcp -p $shlib'\\$(SHLIB_EXT)' apps/\n+\tcp -p $shlib'\\$(SHLIB_EXT)' test/\n+\tcp -p $shlib'\\$(SHLIB_EXT)' fuzz/\n EOF\n+      } elsif (sharedaix()) {\n+          $recipe .= <<\"EOF\";\n+\trm -f $simple && \\\\\n+\t\\$(AR) r $simple $full\n+EOF\n+      } else {\n+          $recipe .= <<\"EOF\";\n+\tif [ '$simple' != '$full' ]; then \\\\\n+\t\trm -f $simple; \\\\\n+\t\tln -s $full $simple; \\\\\n+\tfi\n+EOF\n+      }\n   }\n   sub obj2dso {\n       my %args = @_;\n       my $dso = $args{lib};\n       my $dsod = dirname($dso);\n       my $dson = basename($dso);\n-      my $shlibdeps = join(\"\", map { my $d = dirname($_);\n-                                     my $f = basename($_);\n-                                     (my $l = $f) =~ s/^lib//;\n-                                     \" -L$d -l$l\" } @{$args{deps}});\n-      my $deps = join(\" \",compute_lib_depends(@{$args{deps}}));\n-      my $shlib_target = $target{shared_target};\n-      my $objs = join(\" \", map { $_.$objext } @{$args{objs}});\n+      my @linkdirs = ();\n+      foreach (@{args{deps}}) {\n+          my $d = dirname($_);\n+          push @linkdirs, $d unless grep { $d eq $_ } @linkdirs;\n+      }\n+      my $linkflags = join(\"\", map { \"-L$_ \" } @linkdirs);\n+      my $linklibs = join(\"\", map { my $f = basename($_);\n+                                    (my $l = $f) =~ s/^lib//;\n+                                    \" -l$l\" } @{$args{deps}});\n+      my @objs = map { (my $x = $_) =~ s|\\.o$||; \"$x$objext\" }\n+                 grep { $_ !~ m/\\.(?:def|map)$/ }\n+                 @{$args{objs}};\n+      my @deps = compute_lib_depends(@{$args{deps}});\n+      my $objs = join(\" \", @objs);\n+      my $deps = join(\" \", @deps);\n       my $target = dso($dso);\n       return <<\"EOF\";\n $target: $objs $deps\n-\t\\$(MAKE) -f \\$(SRCDIR)/Makefile.shared -e \\\\\n-\t\tPLATFORM=\\$(PLATFORM) \\\\\n-\t\tPERL=\"\\$(PERL)\" SRCDIR='\\$(SRCDIR)' DSTDIR=\"$dsod\" \\\\\n-\t\tLIBDEPS='\\$(PLIB_LDFLAGS) '\"$shlibdeps\"' \\$(EX_LIBS)' \\\\\n-\t\tSHLIBNAME_FULL=$target LDFLAGS='\\$(LDFLAGS)' \\\\\n-\t\tCC='\\$(CC)' CFLAGS='\\$(CFLAGS) \\$(DSO_CFLAGS)' \\\\\n-\t\tSHARED_LDFLAGS='\\$(DSO_LDFLAGS)' \\\\\n-\t\tLIBEXTRAS=\"$objs\" \\\\\n-\t\tlink_dso.$shlib_target\n+\t\\$(CC) \\$(DSO_CFLAGS) $linkflags\\$(DSO_LDFLAGS) \\\\\n+\t\t-o $target $objs \\\\\n+                $linklibs \\$(DSO_EX_LIBS)\n EOF\n   }\n   sub obj2lib {\n       my %args = @_;\n-      my $lib = $args{lib};\n-      my $objs = join(\" \", map { $_.$objext } @{$args{objs}});\n+      (my $lib = $args{lib}) =~ s/\\.a$//;\n+      my @objs = map { (my $x = $_) =~ s|\\.o$|$objext|; $x } @{$args{objs}};\n+      my $objs = join(\" \", @objs);\n       return <<\"EOF\";\n $lib$libext: $objs\n-\t\\$(AR) \\$\\@ \\$\\?\n+\t\\$(AR) \\$(ARFLAGS) \\$\\@ \\$\\?\n \t\\$(RANLIB) \\$\\@ || echo Never mind.\n EOF\n   }\n@@ -987,24 +1195,36 @@ EOF\n       my $bin = $args{bin};\n       my $bind = dirname($bin);\n       my $binn = basename($bin);\n-      my $objs = join(\" \", map { $_.$objext } @{$args{objs}});\n+      my $objs = join(\" \", map { (my $x = $_) =~ s|\\.o$||; \"$x$objext\" }\n+                           @{$args{objs}});\n       my $deps = join(\" \",compute_lib_depends(@{$args{deps}}));\n-      my $linklibs = join(\"\", map { my $d = dirname($_);\n-                                    my $f = basename($_);\n-                                    $d = \".\" if $d eq $f;\n-                                    (my $l = $f) =~ s/^lib//;\n-                                    \" -L$d -l$l\" } @{$args{deps}});\n-      my $shlib_target = $disabled{shared} ? \"\" : $target{shared_target};\n+      my @linkdirs = ();\n+      foreach (@{args{deps}}) {\n+          next if $_ =~ /\\.a$/;\n+          my $d = dirname($_);\n+          push @linkdirs, $d unless grep { $d eq $_ } @linkdirs;\n+      }\n+      my $linkflags = join(\"\", map { \"-L$_ \" } @linkdirs);\n+      my $linklibs = join(\"\", map { if ($_ =~ s/\\.a$//) {\n+                                        \" $_$libext\";\n+                                    } else {\n+                                        my $f = basename($_);\n+                                        (my $l = $f) =~ s/^lib//;\n+                                        \" -l$l\"\n+                                    }\n+                                  } @{$args{deps}});\n+      my $cmd = '$(CC)';\n+      my $cmdflags = '$(BIN_CFLAGS)';\n+      if (grep /_cc\\.o$/, @{$args{objs}}) {\n+          $cmd = '$(CXX)';\n+          $cmdflags = '$(BIN_CXXFLAGS)';\n+      }\n       return <<\"EOF\";\n $bin$exeext: $objs $deps\n-\t\\$(RM) $bin$exeext\n-\t\\$(MAKE) -f \\$(SRCDIR)/Makefile.shared -e \\\\\n-\t\tPERL=\"\\$(PERL)\" SRCDIR=\\$(SRCDIR) \\\\\n-\t\tAPPNAME=$bin$exeext OBJECTS=\"$objs\" \\\\\n-\t\tLIBDEPS='\\$(PLIB_LDFLAGS) '\"$linklibs\"' \\$(EX_LIBS)' \\\\\n-\t\tCC='\\$(CC)' CFLAGS='\\$(CFLAGS) \\$(BIN_CFLAGS)' \\\\\n-\t\tLDFLAGS='\\$(LDFLAGS)' \\\\\n-\t\tlink_app.$shlib_target\n+\trm -f $bin$exeext\n+\t\\$\\${LDCMD:-$cmd} $cmdflags $linkflags\\$(BIN_LDFLAGS) \\\\\n+\t\t-o $bin$exeext $objs \\\\\n+\t\t$linklibs \\$(BIN_EX_LIBS)\n EOF\n   }\n   sub in2script {\n@@ -1030,6 +1250,10 @@ EOF\n                       lib => $libext,\n                       bin => $exeext );\n \n+      # We already have a 'test' target, and the top directory is just plain\n+      # silly\n+      return if $dir eq \"test\" || $dir eq \".\";\n+\n       foreach my $type ((\"dso\", \"lib\", \"bin\", \"script\")) {\n           next unless defined($unified_info{dirinfo}->{$dir}->{products}->{$type});\n           # For lib object files, we could update the library.  However, it\n@@ -1050,7 +1274,7 @@ EOF\n       my $deps = join(\" \", @deps);\n       my $actions = join(\"\\n\", \"\", @actions);\n       return <<\"EOF\";\n-$args{dir} $args{dir}/: $deps$actions\n+$dir $dir/: $deps$actions\n EOF\n   }\n   \"\"    # Important!  This becomes part of the template result."
        },
        {
            "sha": "d420bfff347d9e86d5130075eabd5779f5fccf1d",
            "filename": "deps/openssl/openssl/Configurations/windows-makefile.tmpl",
            "status": "modified",
            "additions": 295,
            "deletions": 163,
            "changes": 458,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fwindows-makefile.tmpl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fwindows-makefile.tmpl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigurations%2Fwindows-makefile.tmpl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -4,41 +4,50 @@\n ## {- join(\"\\n## \", @autowarntext) -}\n {-\n  our $objext = $target{obj_extension} || \".obj\";\n+ our $resext = $target{res_extension} || \".res\";\n  our $depext = $target{dep_extension} || \".d\";\n  our $exeext = $target{exe_extension} || \".exe\";\n  our $libext = $target{lib_extension} || \".lib\";\n  our $shlibext = $target{shared_extension} || \".dll\";\n  our $shlibextimport = $target{shared_import_extension} || \".lib\";\n  our $dsoext = $target{dso_extension} || \".dll\";\n \n- our $sover = $config{shlib_major}.\"_\".$config{shlib_minor};\n+ (our $sover_dirname = $config{shlib_version_number}) =~ s|\\.|_|g;\n \n+ my $build_scheme = $target{build_scheme};\n+ my $install_flavour = $build_scheme->[$#$build_scheme]; # last element\n  my $win_installenv =\n-     $target{build_scheme}->[2] eq \"VC-W32\" ?\n-     \"ProgramFiles(x86)\" : \"ProgramW6432\";\n+     $install_flavour eq \"VC-WOW\" ? \"ProgramFiles(x86)\"\n+                                  : \"ProgramW6432\";\n  my $win_commonenv =\n-     $target{build_scheme}->[2] eq \"VC-W32\"\n-     ? \"CommonProgramFiles(x86)\" : \"CommonProgramW6432\";\n+     $install_flavour eq \"VC-WOW\" ? \"CommonProgramFiles(x86)\"\n+                                  : \"CommonProgramW6432\";\n  our $win_installroot =\n-     defined($ENV{$win_installenv})\n-     ? $win_installenv : 'ProgramFiles';\n+     defined($ENV{$win_installenv}) ? $win_installenv : 'ProgramFiles';\n  our $win_commonroot =\n-     defined($ENV{$win_commonenv})\n-     ? $win_commonenv : 'CommonProgramFiles';\n+     defined($ENV{$win_commonenv}) ? $win_commonenv : 'CommonProgramFiles';\n \n  # expand variables early\n  $win_installroot = $ENV{$win_installroot};\n  $win_commonroot = $ENV{$win_commonroot};\n \n  sub shlib {\n-     return () if $disabled{shared};\n      my $lib = shift;\n+     return () if $disabled{shared} || $lib =~ /\\.a$/;\n+     return () unless defined $unified_info{sharednames}->{$lib};\n      return $unified_info{sharednames}->{$lib} . $shlibext;\n  }\n \n+ sub lib {\n+     (my $lib = shift) =~ s/\\.a$//;\n+     $lib .= '_static'\n+         if (defined $unified_info{sharednames}->{$lib});\n+     return $lib . $libext;\n+ }\n+\n  sub shlib_import {\n-     return () if $disabled{shared};\n      my $lib = shift;\n+     return () if $disabled{shared} || $lib =~ /\\.a$/;\n      return $lib . $shlibextimport;\n  }\n \n@@ -52,7 +61,7 @@\n  sub dependmagic {\n      my $target = shift;\n \n-     return \"$target: build_generated\\n\\t\\$(MAKE) depend && \\$(MAKE) _$target\\n_$target\";\n+     return \"$target: build_generated\\n\\t\\$(MAKE) /\\$(MAKEFLAGS) depend && \\$(MAKE) /\\$(MAKEFLAGS) _$target\\n_$target\";\n  }\n  '';\n -}\n@@ -67,7 +76,7 @@ MINOR={- $config{minor} -}\n \n SHLIB_VERSION_NUMBER={- $config{shlib_version_number} -}\n \n-LIBS={- join(\" \", map { $_.$libext } @{$unified_info{libraries}}) -}\n+LIBS={- join(\" \", map { ( shlib_import($_), lib($_) ) } @{$unified_info{libraries}}) -}\n SHLIBS={- join(\" \", map { shlib($_) } @{$unified_info{libraries}}) -}\n SHLIBPDBS={- join(\" \", map { local $shlibext = \".pdb\"; shlib($_) } @{$unified_info{libraries}}) -}\n ENGINES={- join(\" \", map { dso($_) } @{$unified_info{engines}}) -}\n@@ -81,14 +90,11 @@ DEPS={- join(\" \", map { (my $x = $_) =~ s|\\.o$|$depext|; $x; }\n                   keys %{$unified_info{sources}}); -}\n {- output_on() if $disabled{makedepend}; \"\" -}\n GENERATED_MANDATORY={- join(\" \", @{$unified_info{depends}->{\"\"}} ) -}\n-GENERATED={- join(\" \",\n-                  ( map { (my $x = $_) =~ s|\\.[sS]$|\\.asm|; $x }\n-                    grep { defined $unified_info{generate}->{$_} }\n-                    map { @{$unified_info{sources}->{$_}} }\n-                    grep { /\\.o$/ } keys %{$unified_info{sources}} ),\n-                  ( grep { /\\.h$/ } keys %{$unified_info{generate}} )) -}\n-\n-INSTALL_LIBS={- join(\" \", map { quotify1($_.$libext) } @{$unified_info{install}->{libraries}}) -}\n+GENERATED={- # common0.tmpl provides @generated\n+             join(\" \", map { (my $x = $_) =~ s|\\.[sS]$|.asm|; $x }\n+                       @generated) -}\n+\n+INSTALL_LIBS={- join(\" \", map { quotify1(shlib_import($_) or lib($_)) } @{$unified_info{install}->{libraries}}) -}\n INSTALL_SHLIBS={- join(\" \", map { quotify_l(shlib($_)) } @{$unified_info{install}->{libraries}}) -}\n INSTALL_SHLIBPDBS={- join(\" \", map { local $shlibext = \".pdb\"; quotify_l(shlib($_)) } @{$unified_info{install}->{libraries}}) -}\n INSTALL_ENGINES={- join(\" \", map { quotify1(dso($_)) } @{$unified_info{install}->{engines}}) -}\n@@ -116,7 +122,7 @@ INSTALLTOP_dev={- # $prefix is used in the OPENSSLDIR perl snippet\n INSTALLTOP_dir={- canonpath($prefix_dir) -}\n OPENSSLDIR_dev={- #\n                   # The logic here is that if no --openssldir was given,\n-                  # OPENSSLDIR will get the value from $prefix plus \"/ssl\".\n+                  # OPENSSLDIR will get the value \"$win_commonroot\\\\SSL\".\n                   # If --openssldir was given and the value is an absolute\n                   # path, OPENSSLDIR will get its value without change.\n                   # If the value from --openssldir is a relative path,\n@@ -135,9 +141,9 @@ OPENSSLDIR_dev={- #\n                   $openssldir_dev -}\n OPENSSLDIR_dir={- canonpath($openssldir_dir) -}\n LIBDIR={- our $libdir = $config{libdir} || \"lib\";\n-          $libdir -}\n+          file_name_is_absolute($libdir) ? \"\" : $libdir -}\n ENGINESDIR_dev={- use File::Spec::Functions qw(:DEFAULT splitpath);\n-                  our $enginesdir = catdir($prefix,$libdir,\"engines-$sover\");\n+                  our $enginesdir = catdir($prefix,$libdir,\"engines-$sover_dirname\");\n                   our ($enginesdir_dev, $enginesdir_dir, $enginesdir_file) =\n                       splitpath($enginesdir, 1);\n                   $enginesdir_dev -}\n@@ -152,39 +158,149 @@ OPENSSLDIR=$(OPENSSLDIR_dev)$(OPENSSLDIR_dir)\n ENGINESDIR=$(ENGINESDIR_dev)$(ENGINESDIR_dir)\n !ENDIF\n \n-CC={- $target{cc} -}\n-CFLAGS={- join(\" \",(map { \"-D\".$_} @{$target{defines}}, @{$config{defines}})) -} {- join(\" \", quotify_l(\"-DENGINESDIR=\\\"$enginesdir\\\"\", \"-DOPENSSLDIR=\\\"$openssldir\\\"\")) -} {- $target{cflags} -} {- $config{cflags} -}\n-COUTFLAG={- $target{coutflag} || \"/Fo\" -}$(OSSL_EMPTY)\n-RC={- $target{rc} || \"rc\" -}\n-RCOUTFLAG={- $target{rcoutflag} || \"/fo\" -}$(OSSL_EMPTY)\n-LD={- $target{ld} || \"link\" -}\n-LDFLAGS={- $target{lflags} -}\n-LDOUTFLAG={- $target{loutflag} || \"/out:\" -}$(OSSL_EMPTY)\n-EX_LIBS={- $target{ex_libs} -}\n-LIB_CFLAGS={- join(\" \", $target{lib_cflags}, $target{shared_cflag}) || \"\" -}\n-LIB_LDFLAGS={- $target{shared_ldflag} || \"\" -}\n-DSO_CFLAGS={- join(\" \", $target{dso_cflags}, $target{shared_cflag}) || \"\" -}\n-DSO_LDFLAGS={- join(\" \", $target{dso_lflags}, $target{shared_ldflag}) || \"\" -}\n-BIN_CFLAGS={- $target{bin_cflags} -}\n-BIN_LDFLAGS={- $target{bin_lflags} -}\n-\n-PERL={- $config{perl} -}\n-\n-AR={- $target{ar} -}\n-ARFLAGS= {- $target{arflags} -}\n-AROUTFLAG={- $target{aroutflag} || \"/out:\" -}$(OSSL_EMPTY)\n-\n-MT={- $target{mt} -}\n-MTFLAGS= {- $target{mtflags} -}\n-MTINFLAG={- $target{mtinflag} || \"-manifest \" -}$(OSSL_EMPTY)\n-MTOUTFLAG={- $target{mtoutflag} || \"-outputresource:\" -}$(OSSL_EMPTY)\n-\n-AS={- $target{as} -}\n-ASFLAGS={- $target{asflags} -}\n-ASOUTFLAG={- $target{asoutflag} -}$(OSSL_EMPTY)\n+# $(libdir) is chosen to be compatible with the GNU coding standards\n+libdir={- file_name_is_absolute($libdir)\n+          ? $libdir : '$(INSTALLTOP)\\$(LIBDIR)' -}\n+\n+##### User defined commands and flags ################################\n+\n+CC={- $config{CC} -}\n+CPP={- $config{CPP} -}\n+CPPFLAGS={- our $cppflags1 = join(\" \",\n+                                  (map { \"-D\".$_} @{$config{CPPDEFINES}}),\n+                                  (map { \" /I \".$_} @{$config{CPPINCLUDES}}),\n+                                  @{$config{CPPFLAGS}}) -}\n+CFLAGS={- join(' ', @{$config{CFLAGS}}) -}\n+LD={- $config{LD} -}\n+LDFLAGS={- join(' ', @{$config{LDFLAGS}}) -}\n+EX_LIBS={- join(' ', @{$config{LDLIBS}}) -}\n+\n+PERL={- $config{PERL} -}\n+\n+AR={- $config{AR} -}\n+ARFLAGS= {- join(' ', @{$config{ARFLAGS}}) -}\n+\n+MT={- $config{MT} -}\n+MTFLAGS= {- join(' ', @{$config{MTFLAGS}}) -}\n+\n+AS={- $config{AS} -}\n+ASFLAGS={- join(' ', @{$config{ASFLAGS}}) -}\n+\n+RC={- $config{RC} -}\n \n ECHO=\"$(PERL)\" \"$(SRCDIR)\\util\\echo.pl\"\n \n+##### Special command flags ##########################################\n+\n+COUTFLAG={- $target{coutflag} -}$(OSSL_EMPTY)\n+LDOUTFLAG={- $target{ldoutflag} -}$(OSSL_EMPTY)\n+AROUTFLAG={- $target{aroutflag} -}$(OSSL_EMPTY)\n+MTINFLAG={- $target{mtinflag} -}$(OSSL_EMPTY)\n+MTOUTFLAG={- $target{mtoutflag} -}$(OSSL_EMPTY)\n+ASOUTFLAG={- $target{asoutflag} -}$(OSSL_EMPTY)\n+RCOUTFLAG={- $target{rcoutflag} -}$(OSSL_EMPTY)\n+\n+##### Project flags ##################################################\n+\n+# Variables starting with CNF_ are common variables for all product types\n+\n+CNF_ASFLAGS={- join(' ', $target{asflags} || (),\n+                         @{$config{asflags}}) -}\n+CNF_CPPFLAGS={- our $cppfags2 =\n+                    join(' ', $target{cppflags} || (),\n+                              (map { '-D'.quotify1($_) } @{$target{defines}},\n+                                                         @{$config{defines}}),\n+                              (map { '-I'.quotify1($_) } @{$target{includes}},\n+                                                         @{$config{includes}}),\n+                              @{$config{cppflags}}) -}\n+CNF_CFLAGS={- join(' ', $target{cflags} || (),\n+                        @{$config{cflags}}) -}\n+CNF_CXXFLAGS={- join(' ', $target{cxxflags} || (),\n+                          @{$config{cxxflags}}) -}\n+CNF_LDFLAGS={- join(' ', $target{lflags} || (),\n+                         @{$config{lflags}}) -}\n+CNF_EX_LIBS={- join(' ', $target{ex_libs} || (),\n+                         @{$config{ex_libs}}) -}\n+\n+# Variables starting with LIB_ are used to build library object files\n+# and shared libraries.\n+# Variables starting with DSO_ are used to build DSOs and their object files.\n+# Variables starting with BIN_ are used to build programs and their object\n+# files.\n+\n+LIB_ASFLAGS={- join(' ', $target{lib_asflags} || (),\n+                         @{$config{lib_asflags}},\n+                         '$(CNF_ASFLAGS)', '$(ASFLAGS)') -}\n+LIB_CPPFLAGS={- our $lib_cppflags =\n+                join(' ', $target{lib_cppflags} || (),\n+                          $target{shared_cppflag} || (),\n+                          (map { '-D'.quotify1($_) }\n+                               @{$target{lib_defines}},\n+                               @{$target{shared_defines}},\n+                               @{$config{lib_defines}},\n+                               @{$config{shared_defines}}),\n+                          (map { '-I'.quotify1($_) }\n+                               @{$target{lib_includes}},\n+                               @{$target{shared_includes}},\n+                               @{$config{lib_includes}},\n+                               @{$config{shared_includes}}),\n+                          @{$config{lib_cppflags}},\n+                          @{$config{shared_cppflag}});\n+                join(' ', $lib_cppflags,\n+                          (map { '-D'.quotify1($_) }\n+                               \"OPENSSLDIR=\\\"$openssldir\\\"\",\n+                               \"ENGINESDIR=\\\"$enginesdir\\\"\"),\n+                          '$(CNF_CPPFLAGS)', '$(CPPFLAGS)') -}\n+LIB_CFLAGS={- join(' ', $target{lib_cflags} || (),\n+                        $target{shared_cflag} || (),\n+                        @{$config{lib_cflags}},\n+                        @{$config{shared_cflag}},\n+                        '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+LIB_LDFLAGS={- join(' ', $target{shared_ldflag} || (),\n+                         $config{shared_ldflag} || (),\n+                         '$(CNF_LDFLAGS)', '$(LDFLAGS)') -}\n+LIB_EX_LIBS=$(CNF_EX_LIBS) $(EX_LIBS)\n+DSO_ASFLAGS={- join(' ', $target{dso_asflags} || (),\n+                         $target{module_asflags} || (),\n+                         @{$config{dso_asflags}},\n+                         @{$config{module_asflags}},\n+                         '$(CNF_ASFLAGS)', '$(ASFLAGS)') -}\n+DSO_CPPFLAGS={- join(' ', $target{dso_cppflags} || (),\n+                          $target{module_cppflags} || (),\n+                          @{$config{dso_cppflags}},\n+                          @{$config{module_cppflags}},\n+                          '$(CNF_CPPFLAGS)', '$(CPPFLAGS)') -}\n+DSO_CFLAGS={- join(' ', $target{dso_cflags} || (),\n+                        $target{module_cflags} || (),\n+                        @{$config{dso_cflags}},\n+                        @{$config{module_cflags}},\n+                        '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+DSO_LDFLAGS={- join(' ', $target{dso_lflags} || (),\n+                         $target{module_ldflags} || (),\n+                         @{$config{dso_lflags}},\n+                         @{$config{module_ldflags}},\n+                         '$(CNF_LDFLAGS)', '$(LDFLAGS)') -}\n+DSO_EX_LIBS=$(CNF_EX_LIBS) $(EX_LIBS)\n+BIN_ASFLAGS={- join(' ', $target{bin_asflags} || (),\n+                         @{$config{bin_asflags}},\n+                         '$(CNF_ASFLAGS)', '$(ASFLAGS)') -}\n+BIN_CPPFLAGS={- join(' ', $target{bin_cppflags} || (),\n+                          @{$config{bin_cppflags}},\n+                          '$(CNF_CPPFLAGS)', '$(CPPFLAGS)') -}\n+BIN_CFLAGS={- join(' ', $target{bin_cflags} || (),\n+                        @{$config{bin_cflags}},\n+                        '$(CNF_CFLAGS)', '$(CFLAGS)') -}\n+BIN_LDFLAGS={- join(' ', $target{bin_lflags} || (),\n+                         @{$config{bin_lflags}},\n+                         '$(CNF_LDFLAGS)', '$(LDFLAGS)') -}\n+BIN_EX_LIBS=$(CNF_EX_LIBS) $(EX_LIBS)\n+\n+# CPPFLAGS_Q is used for one thing only: to build up buildinf.h\n+CPPFLAGS_Q={- $cppflags1 =~ s|([\\\\\"])|\\\\$1|g;\n+              $cppflags2 =~ s|([\\\\\"])|\\\\$1|g;\n+              join(' ', $lib_cppflags || (), $cppflags2 || (),\n+                        $cppflags1 || ()) -}\n+\n PERLASM_SCHEME= {- $target{perlasm_scheme} -}\n \n PROCESSOR= {- $config{processor} -}\n@@ -207,6 +323,11 @@ build_apps build_tests: build_programs\n # Convenience target to prebuild all generated files, not just the mandatory\n # ones\n build_all_generated: $(GENERATED_MANDATORY) $(GENERATED)\n+\t@{- output_off() if $disabled{makedepend}; \"\" -}\n+\t@$(ECHO) \"Warning: consider configuring with no-makedepend, because if\"\n+\t@$(ECHO) \"         target system doesn't have $(PERL),\"\n+\t@$(ECHO) \"         then make will fail...\"\n+\t@{- output_on() if $disabled{makedepend}; \"\" -}\n \n test: tests\n {- dependmagic('tests'); -}: build_programs_nodep build_engines_nodep\n@@ -236,34 +357,29 @@ install: install_sw install_ssldirs install_docs\n uninstall: uninstall_docs uninstall_sw\n \n libclean:\n-\t\"$(PERL)\" -e \"map { m/(.*)\\.dll$$/; unlink glob \"\"\"$$1.*\"\"\"; } @ARGV\" $(SHLIBS)\n-\t\"$(PERL)\" -e \"map { m/(.*)\\.dll$$/; unlink glob \"\"\"apps/$$1.*\"\"\"; } @ARGV\" $(SHLIBS)\n-\t\"$(PERL)\" -e \"map { m/(.*)\\.dll$$/; unlink glob \"\"\"test/$$1.*\"\"\"; } @ARGV\" $(SHLIBS)\n-\t\"$(PERL)\" -e \"map { m/(.*)\\.dll$$/; unlink glob \"\"\"fuzz/$$1.*\"\"\"; } @ARGV\" $(SHLIBS)\n-\t-del /Q /F $(LIBS)\n-\t-del /Q ossl_static.pdb\n+\t\"$(PERL)\" -e \"map { m/(.*)\\.dll$$/; unlink glob \"\"\"{.,apps,test,fuzz}/$$1.*\"\"\"; } @ARGV\" $(SHLIBS)\n+\t-del /Q /F $(LIBS) libcrypto.* libssl.* ossl_static.pdb\n \n clean: libclean\n \t{- join(\"\\n\\t\", map { \"-del /Q /F $_\" } @PROGRAMS) -}\n \t-del /Q /F $(ENGINES)\n \t-del /Q /F $(SCRIPTS)\n+\t-del /Q /F $(GENERATED_MANDATORY)\n \t-del /Q /F $(GENERATED)\n-\t-del /Q /S /F *.d\n-\t-del /Q /S /F *.obj\n-\t-del /Q /S /F *.pdb\n-\t-del /Q /S /F *.exp\n-\t-del /Q /S /F engines\\*.ilk\n-\t-del /Q /S /F engines\\*.lib\n-\t-del /Q /S /F apps\\*.lib\n-\t-del /Q /S /F engines\\*.manifest\n-\t-del /Q /S /F apps\\*.manifest\n-\t-del /Q /S /F test\\*.manifest\n+\t-del /Q /S /F *.d *.obj *.pdb *.ilk *.manifest\n+\t-del /Q /S /F engines\\*.lib engines\\*.exp\n+\t-del /Q /S /F apps\\*.lib apps\\*.rc apps\\*.res apps\\*.exp\n+\t-del /Q /S /F test\\*.exp\n+\t-rmdir /Q /S test\\test-runs\n \n distclean: clean\n \t-del /Q /F configdata.pm\n \t-del /Q /F makefile\n \n depend:\n+\t@ {- output_off() if $disabled{makedepend}; \"\" -}\n+\t@ \"$(PERL)\" \"$(SRCDIR)\\util\\add-depends.pl\" \"VC\"\n+\t@ {- output_on() if $disabled{makedepend}; \"\" -}\n \n # Install helper targets #############################################\n \n@@ -286,26 +402,29 @@ install_ssldirs:\n                                         \"$(OPENSSLDIR)\\openssl.cnf\"\n \t@\"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" $(MISC_SCRIPTS) \\\n                                         \"$(OPENSSLDIR)\\misc\"\n+\t@\"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" \"$(SRCDIR)\\apps\\ct_log_list.cnf\" \\\n+                                        \"$(OPENSSLDIR)\\ct_log_list.cnf.dist\"\n+\t@IF NOT EXIST \"$(OPENSSLDIR)\\ct_log_list.cnf\" \\\n+         \"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" \"$(SRCDIR)\\apps\\ct_log_list.cnf\" \\\n+                                        \"$(OPENSSLDIR)\\ct_log_list.cnf\"\n \n install_dev: install_runtime_libs\n \t@if \"$(INSTALLTOP)\"==\"\" ( $(ECHO) \"INSTALLTOP should not be empty\" & exit 1 )\n \t@$(ECHO) \"*** Installing development files\"\n \t@\"$(PERL)\" \"$(SRCDIR)\\util\\mkdir-p.pl\" \"$(INSTALLTOP)\\include\\openssl\"\n-\t@{- output_off() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } @{$target{defines}}; \"\" -}\n+\t@{- output_off() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } (@{$target{defines}}, @{$config{defines}}); \"\" -}\n \t@\"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" \"$(SRCDIR)\\ms\\applink.c\" \\\n \t\t\t\t       \"$(INSTALLTOP)\\include\\openssl\"\n-\t@{- output_on() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } @{$target{defines}}; \"\" -}\n+\t@{- output_on() unless grep { $_ eq \"OPENSSL_USE_APPLINK\" } (@{$target{defines}}, @{$config{defines}}); \"\" -}\n \t@\"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" \"-exclude_re=/__DECC_\" \\\n \t\t\t\t       \"$(SRCDIR)\\include\\openssl\\*.h\" \\\n \t\t\t\t       \"$(INSTALLTOP)\\include\\openssl\"\n \t@\"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" \"$(BLDDIR)\\include\\openssl\\*.h\" \\\n \t\t\t\t       \"$(INSTALLTOP)\\include\\openssl\"\n-\t@\"$(PERL)\" \"$(SRCDIR)\\util\\mkdir-p.pl\" \"$(INSTALLTOP)\\$(LIBDIR)\"\n-\t@\"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" $(INSTALL_LIBS) \\\n-\t\t\t\t       \"$(INSTALLTOP)\\$(LIBDIR)\"\n+\t@\"$(PERL)\" \"$(SRCDIR)\\util\\mkdir-p.pl\" \"$(libdir)\"\n+\t@\"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" $(INSTALL_LIBS) \"$(libdir)\"\n \t@if \"$(SHLIBS)\"==\"\" \\\n-\t \"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" ossl_static.pdb \\\n-                                       \"$(INSTALLTOP)\\$(LIBDIR)\"\n+\t \"$(PERL)\" \"$(SRCDIR)\\util\\copy.pl\" ossl_static.pdb \"$(libdir)\"\n \n uninstall_dev:\n \n@@ -355,15 +474,17 @@ uninstall_html_docs:\n \n configdata.pm: \"$(SRCDIR)\\Configure\" {- join(\" \", map { '\"'.$_.'\"' } @{$config{build_file_templates}}, @{$config{build_infos}}, @{$config{conf_files}}) -}\n \t@$(ECHO) \"Detected changed: $?\"\n-\t@$(ECHO) \"Reconfiguring...\"\n-\t\"$(PERL)\" \"$(SRCDIR)\\Configure\" reconf\n+\t\"$(PERL)\" configdata.pm -r\n \t@$(ECHO) \"**************************************************\"\n \t@$(ECHO) \"***                                            ***\"\n \t@$(ECHO) \"***   Please run the same make command again   ***\"\n \t@$(ECHO) \"***                                            ***\"\n \t@$(ECHO) \"**************************************************\"\n \t@exit 1\n \n+reconfigure reconf:\n+\t\"$(PERL)\" configdata.pm -r\n+\n {-\n  use File::Basename;\n  use File::Spec::Functions qw/:DEFAULT abs2rel rel2abs/;\n@@ -372,9 +493,9 @@ configdata.pm: \"$(SRCDIR)\\Configure\" {- join(\" \", map { '\"'.$_.'\"' } @{$config{b\n  # It takes a list of library names and outputs a list of dependencies\n  sub compute_lib_depends {\n      if ($disabled{shared}) {\n-\t return map { $_.$libext } @_;\n+\t return map { lib($_) } @_;\n      }\n-     return map { shlib_import($_) } @_;\n+     return map { shlib_import($_) or lib($_) } @_;\n  }\n \n   sub generatesrc {\n@@ -412,6 +533,12 @@ EOF\n               die \"Generator type for $src unknown: $generator\\n\";\n           }\n \n+          my $cppflags = $incs;\n+          $cppflags .= {\n+              lib => ' $(LIB_CFLAGS) $(LIB_CPPFLAGS)',\n+              dso => ' $(DSO_CFLAGS) $(DSO_CPPFLAGS)',\n+              bin => ' $(BIN_CFLAGS) $(BIN_CPPFLAGS)'\n+          } -> {$args{intent}};\n           if (defined($generator)) {\n               # If the target is named foo.S in build.info, we want to\n               # end up generating foo.s in two steps.\n@@ -420,7 +547,7 @@ EOF\n $target: \"$args{generator}->[0]\" $deps\n \tset ASM=\\$(AS)\n \t$generator \\$@.S\n-\t\\$(CC) $incs \\$(CFLAGS) /EP /C \\$@.S > \\$@.i && move /Y \\$@.i \\$@\n+\t\\$(CPP) $cppflags \\$@.S > \\$@.i && move /Y \\$@.i \\$@\n         del /Q \\$@.S\n EOF\n               }\n@@ -433,104 +560,107 @@ EOF\n           }\n           return <<\"EOF\";\n $target: \"$args{generator}->[0]\" $deps\n-\t\\$(CC) $incs \\$(CFLAGS) /EP /C \"$args{generator}->[0]\" > \\$@.i && move /Y \\$@.i \\$@\n+\t\\$(CPP) $incs $cppflags \"$args{generator}->[0]\" > \\$@.i && move /Y \\$@.i \\$@\n EOF\n       }\n   }\n \n  sub src2obj {\n      my %args = @_;\n-     my $obj = $args{obj};\n      my @srcs = map { (my $x = $_) =~ s/\\.s$/.asm/; $x\n                     } ( @{$args{srcs}} );\n      my $srcs = '\"'.join('\" \"',  @srcs).'\"';\n      my $deps = '\"'.join('\" \"', @srcs, @{$args{deps}}).'\"';\n      my $incs = join(\"\", map { ' /I \"'.$_.'\"' } @{$args{incs}});\n-     unless ($disabled{zlib}) {\n-         if ($withargs{zlib_include}) {\n-             $incs .= ' /I \"'.$withargs{zlib_include}.'\"';\n-         }\n-     }\n-     my $ecflags = { lib => '$(LIB_CFLAGS)',\n-\t\t     dso => '$(DSO_CFLAGS)',\n-\t\t     bin => '$(BIN_CFLAGS)' } -> {$args{intent}};\n+     my $cflags = { lib => ' $(LIB_CFLAGS)',\n+\t\t    dso => ' $(DSO_CFLAGS)',\n+\t\t    bin => ' $(BIN_CFLAGS)' } -> {$args{intent}};\n+     $cflags .= $incs;\n+     $cflags .= { lib => ' $(LIB_CPPFLAGS)',\n+\t\t  dso => ' $(DSO_CPPFLAGS)',\n+\t\t  bin => ' $(BIN_CPPFLAGS)' } -> {$args{intent}};\n+     my $asflags = { lib => ' $(LIB_ASFLAGS)',\n+\t\t     dso => ' $(DSO_ASFLAGS)',\n+\t\t     bin => ' $(BIN_ASFLAGS)' } -> {$args{intent}};\n      my $makedepprog = $config{makedepprog};\n+     if ($srcs[0] =~ /\\.rc$/) {\n+         return <<\"EOF\";\n+$args{obj}: $deps\n+\t\\$(RC) \\$(RCOUTFLAG)\\$\\@ $srcs\n+EOF\n+     }\n+     (my $obj = $args{obj}) =~ s|\\.o$||;\n      if ($srcs[0] =~ /\\.asm$/) {\n          return <<\"EOF\";\n $obj$objext: $deps\n-\t\\$(AS) \\$(ASFLAGS) \\$(ASOUTFLAG)\\$\\@ $srcs\n+\t\\$(AS) $asflags \\$(ASOUTFLAG)\\$\\@ $srcs\n+EOF\n+     } elsif ($srcs[0] =~ /.S$/) {\n+         return <<\"EOF\";\n+$obj$objext: $deps\n+\t\\$(CC) /EP /D__ASSEMBLER__ $cflags $srcs > \\$@.asm && \\$(AS) $asflags \\$(ASOUTFLAG)\\$\\@ \\$@.asm\n EOF\n      }\n      my $recipe = <<\"EOF\";\n $obj$objext: $deps\n-\t\\$(CC) $incs \\$(CFLAGS) $ecflags -c \\$(COUTFLAG)\\$\\@ $srcs\n+\t\\$(CC) $cflags -c \\$(COUTFLAG)\\$\\@ $srcs\n EOF\n      $recipe .= <<\"EOF\"\tunless $disabled{makedepend};\n-\t\\$(CC) $incs \\$(CFLAGS) $ecflags /Zs /showIncludes $srcs 2>&1 | \\\\\n-\t    \"\\$(PERL)\" -n << > $obj$depext\n-chomp;\n-s/^Note: including file: *//;\n-\\$\\$collect{\\$\\$_} = 1;\n-END { print '$obj$objext: ',join(\" \", sort keys \\%collect),\"\\\\n\" }\n-<<\n+\t\\$(CC) $cflags /Zs /showIncludes $srcs 2>&1 > $obj$depext\n EOF\n      return $recipe;\n  }\n \n- # On Unix, we build shlibs from static libs, so we're ignoring the\n- # object file array.  We *know* this routine is only called when we've\n- # configure 'shared'.\n+ # We *know* this routine is only called when we've configure 'shared'.\n+ # Also, note that even though the import library built here looks like\n+ # a static library, it really isn't.\n  sub libobj2shlib {\n      my %args = @_;\n      my $lib = $args{lib};\n-     my $shlib = $args{shlib};\n-     (my $mkdef_key = $lib) =~ s/^lib//i;\n-     my $objs = join(\"\\n\", map { $_.$objext } @{$args{objs}});\n-     my $linklibs = join(\"\",\n-\t\t\t map { \"\\n$_\" } compute_lib_depends(@{$args{deps}}));\n-     my $deps = join(\" \",\n-\t\t     (map { $_.$objext } @{$args{objs}}),\n-\t\t     compute_lib_depends(@{$args{deps}}));\n-     my $ordinalsfile = defined($args{ordinals}) ? $args{ordinals}->[1] : \"\";\n-     my $mkdef_pl = abs2rel(rel2abs(catfile($config{sourcedir},\n-\t\t\t\t\t    \"util\", \"mkdef.pl\")),\n-\t\t\t    rel2abs($config{builddir}));\n-     my $mkrc_pl = abs2rel(rel2abs(catfile($config{sourcedir},\n-\t\t\t\t\t   \"util\", \"mkrc.pl\")),\n-\t\t\t   rel2abs($config{builddir}));\n-     my $target = shlib_import($lib);\n+     my @objs = map { (my $x = $_) =~ s|\\.o$|$objext|; $x }\n+                grep { $_ =~ m/\\.(?:o|res)$/ }\n+                @{$args{objs}};\n+     my @defs = grep { $_ =~ /\\.def$/ } @{$args{objs}};\n+     my @deps = compute_lib_depends(@{$args{deps}});\n+     die \"More than one exported symbols list\" if scalar @defs > 1;\n+     my $linklibs = join(\"\", map { \"$_\\n\" } @deps);\n+     my $objs = join(\"\\n\", @objs);\n+     my $deps = join(\" \", @objs, @defs, @deps);\n+     my $import = shlib_import($lib);\n+     my $dll =  shlib($lib);\n+     my $shared_def = join(\"\", map { \" /def:$_\" } @defs);\n      return <<\"EOF\"\n-$target: $deps \"$ordinalsfile\" \"$mkdef_pl\"\n-\t\"\\$(PERL)\" \"$mkdef_pl\" \"$mkdef_key\" 32 > $shlib.def\n-\t\"\\$(PERL)\" -i.tmp -pe \"s|^LIBRARY\\\\s+${mkdef_key}32|LIBRARY $shlib|;\" $shlib.def\n-\tDEL $shlib.def.tmp\n-\t\"\\$(PERL)\" \"$mkrc_pl\" $shlib$shlibext > $shlib.rc\n-\t\\$(RC) \\$(RCOUTFLAG)$shlib.res $shlib.rc\n-\tIF EXIST $shlib$shlibext.manifest DEL /F /Q $shlib$shlibext.manifest\n+# The import library may look like a static library, but it is not.\n+# We MUST make the import library depend on the DLL, in case someone\n+# mistakenly removes the latter.\n+$import: $dll\n+$dll: $deps\n+\tIF EXIST $full.manifest DEL /F /Q $full.manifest\n+\tIF EXIST \\$@ DEL /F /Q \\$@\n \t\\$(LD) \\$(LDFLAGS) \\$(LIB_LDFLAGS) \\\\\n-\t\t/implib:\\$@ \\$(LDOUTFLAG)$shlib$shlibext /def:$shlib.def @<< || (DEL /Q \\$(\\@B).* $shlib.* && EXIT 1)\n-$objs $shlib.res$linklibs \\$(EX_LIBS)\n+\t\t/implib:$import \\$(LDOUTFLAG)$dll$shared_def @<< || (DEL /Q \\$(\\@B).* $import && EXIT 1)\n+$objs\n+$linklibs\\$(LIB_EX_LIBS)\n <<\n-\tIF EXIST $shlib$shlibext.manifest \\\\\n-\t   \\$(MT) \\$(MTFLAGS) \\$(MTINFLAG)$shlib$shlibext.manifest \\$(MTOUTFLAG)$shlib$shlibext\n-\tIF EXIST apps\\\\$shlib$shlibext DEL /Q /F apps\\\\$shlib$shlibext\n-\tIF EXIST test\\\\$shlib$shlibext DEL /Q /F test\\\\$shlib$shlibext\n-\tIF EXIST fuzz\\\\$shlib$shlibext DEL /Q /F fuzz\\\\$shlib$shlibext\n-\tCOPY $shlib$shlibext apps\n-\tCOPY $shlib$shlibext test\n-\tCOPY $shlib$shlibext fuzz\n+\tIF EXIST $dll.manifest \\\\\n+\t   \\$(MT) \\$(MTFLAGS) \\$(MTINFLAG)$dll.manifest \\$(MTOUTFLAG)$dll\n+\tIF EXIST apps\\\\$dll DEL /Q /F apps\\\\$dll\n+\tIF EXIST test\\\\$dll DEL /Q /F test\\\\$dll\n+\tIF EXIST fuzz\\\\$dll DEL /Q /F fuzz\\\\$dll\n+\tCOPY $dll apps\n+\tCOPY $dll test\n+\tCOPY $dll fuzz\n EOF\n  }\n  sub obj2dso {\n      my %args = @_;\n      my $dso = $args{lib};\n      my $dso_n = basename($dso);\n-     my $objs = join(\"\\n\", map { $_.$objext } @{$args{objs}});\n-     my $linklibs = join(\"\",\n-\t\t\t map { \"\\n$_\" } compute_lib_depends(@{$args{deps}}));\n-     my $deps = join(\" \",\n-\t\t     (map { $_.$objext } @{$args{objs}}),\n-\t\t     compute_lib_depends(@{$args{deps}}));\n+     my @objs = map { (my $x = $_) =~ s|\\.o$|$objext|; $x } @{$args{objs}};\n+     my @deps = compute_lib_depends(@{$args{deps}});\n+     my $objs = join(\"\\n\", @objs);\n+     my $linklibs = join(\"\", map { \"$_\\n\" } @deps);\n+     my $deps = join(\" \", @objs, @deps);\n      return <<\"EOF\";\n $dso$dsoext: $deps\n \tIF EXIST $dso$dsoext.manifest DEL /F /Q $dso$dsoext.manifest\n@@ -540,43 +670,41 @@ EXPORTS\n     bind_engine\t\t@1\n     v_check\t\t@2\n <<\n-$objs$linklibs \\$(EX_LIBS)\n+$objs\n+$linklibs \\$(DSO_EX_LIBS)\n <<\n \tIF EXIST $dso$dsoext.manifest \\\\\n \t   \\$(MT) \\$(MTFLAGS) \\$(MTINFLAG)$dso$dsoext.manifest \\$(MTOUTFLAG)$dso$dsoext\n EOF\n  }\n  sub obj2lib {\n-     # Because static libs and import libs are both named the same in native\n-     # Windows, we can't have both.  We skip the static lib in that case,\n-     # as the shared libs are what we use anyway.\n-     return \"\" unless $disabled{\"shared\"};\n-\n      my %args = @_;\n-     my $lib = $args{lib};\n-     my $objs = join(\"\\n\", map { $_.$objext } @{$args{objs}});\n-     my $deps = join(\" \", map { $_.$objext } @{$args{objs}});\n+     my $lib = lib($args{lib});\n+     my @objs = map { (my $x = $_) =~ s|\\.o$|$objext|; $x } @{$args{objs}};\n+     my $objs = join(\"\\n\", @objs);\n+     my $deps = join(\" \", @objs);\n      return <<\"EOF\";\n-$lib$libext: $deps\n-\t\\$(AR) \\$(ARFLAGS) \\$(AROUTFLAG)$lib$libext @<<\n-\\$**\n+$lib: $deps\n+\t\\$(AR) \\$(ARFLAGS) \\$(AROUTFLAG)$lib @<<\n+$objs\n <<\n EOF\n  }\n  sub obj2bin {\n      my %args = @_;\n      my $bin = $args{bin};\n-     my $objs = join(\"\\n\", map { $_.$objext } @{$args{objs}});\n-     my $linklibs = join(\"\",\n-\t\t\t map { \"\\n$_\" } compute_lib_depends(@{$args{deps}}));\n-     my $deps = join(\" \",\n-\t\t     (map { $_.$objext } @{$args{objs}}),\n-\t\t     compute_lib_depends(@{$args{deps}}));\n+     my @objs = map { (my $x = $_) =~ s|\\.o$|$objext|; $x } @{$args{objs}};\n+     my @deps = compute_lib_depends(@{$args{deps}});\n+     my $objs = join(\"\\n\", @objs);\n+     my $linklibs = join(\"\", map { \"$_\\n\" } @deps);\n+     my $deps = join(\" \", @objs, @deps);\n      return <<\"EOF\";\n $bin$exeext: $deps\n \tIF EXIST $bin$exeext.manifest DEL /F /Q $bin$exeext.manifest\n \t\\$(LD) \\$(LDFLAGS) \\$(BIN_LDFLAGS) \\$(LDOUTFLAG)$bin$exeext @<<\n-$objs setargv.obj$linklibs \\$(EX_LIBS)\n+$objs\n+setargv.obj\n+$linklibs\\$(BIN_EX_LIBS)\n <<\n \tIF EXIST $bin$exeext.manifest \\\\\n \t   \\$(MT) \\$(MTFLAGS) \\$(MTINFLAG)$bin$exeext.manifest \\$(MTOUTFLAG)$bin$exeext\n@@ -604,6 +732,10 @@ EOF\n                       lib => $libext,\n                       bin => $exeext );\n \n+      # We already have a 'test' target, and the top directory is just plain\n+      # silly\n+      return if $dir eq \"test\" || $dir eq \".\";\n+\n       foreach my $type ((\"dso\", \"lib\", \"bin\", \"script\")) {\n           next unless defined($unified_info{dirinfo}->{$dir}->{products}->{$type});\n           # For lib object files, we could update the library.  However,\n@@ -621,7 +753,7 @@ EOF\n       my $deps = join(\" \", @deps);\n       my $actions = join(\"\\n\", \"\", @actions);\n       return <<\"EOF\";\n-$args{dir} $args{dir}\\\\ : $deps$actions\n+$dir $dir\\\\ : $deps$actions\n EOF\n   }\n   \"\"    # Important!  This becomes part of the template result."
        },
        {
            "sha": "d5dc36c285bab2755017f736f59a083d098f7cdb",
            "filename": "deps/openssl/openssl/Configure",
            "status": "modified",
            "additions": 1088,
            "deletions": 406,
            "changes": 1494,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigure",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FConfigure",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FConfigure?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -11,6 +11,7 @@\n \n use 5.10.0;\n use strict;\n+use Config;\n use FindBin;\n use lib \"$FindBin::Bin/util/perl\";\n use File::Basename;\n@@ -106,25 +107,28 @@ my $usage=\"Usage: Configure [no-<cipher> ...] [enable-<cipher> ...] [-Dxxx] [-lx\n # past these.\n \n # DEBUG_UNUSED enables __owur (warn unused result) checks.\n+# -DPEDANTIC complements -pedantic and is meant to mask code that\n+# is not strictly standard-compliant and/or implementation-specific,\n+# e.g. inline assembly, disregards to alignment requirements, such\n+# that -pedantic would complain about. Incidentally -DPEDANTIC has\n+# to be used even in sanitized builds, because sanitizer too is\n+# supposed to and does take notice of non-standard behaviour. Then\n+# -pedantic with pre-C9x compiler would also complain about 'long\n+# long' not being supported. As 64-bit algorithms are common now,\n+# it grew impossible to resolve this without sizeable additional\n+# code, so we just tell compiler to be pedantic about everything\n+# but 'long long' type.\n+\n my $gcc_devteam_warn = \"-DDEBUG_UNUSED\"\n-        # -DPEDANTIC complements -pedantic and is meant to mask code that\n-        # is not strictly standard-compliant and/or implementation-specific,\n-        # e.g. inline assembly, disregards to alignment requirements, such\n-        # that -pedantic would complain about. Incidentally -DPEDANTIC has\n-        # to be used even in sanitized builds, because sanitizer too is\n-        # supposed to and does take notice of non-standard behaviour. Then\n-        # -pedantic with pre-C9x compiler would also complain about 'long\n-        # long' not being supported. As 64-bit algorithms are common now,\n-        # it grew impossible to resolve this without sizeable additional\n-        # code, so we just tell compiler to be pedantic about everything\n-        # but 'long long' type.\n         . \" -DPEDANTIC -pedantic -Wno-long-long\"\n         . \" -Wall\"\n         . \" -Wextra\"\n         . \" -Wno-unused-parameter\"\n         . \" -Wno-missing-field-initializers\"\n+        . \" -Wswitch\"\n         . \" -Wsign-compare\"\n         . \" -Wmissing-prototypes\"\n+        . \" -Wstrict-prototypes\"\n         . \" -Wshadow\"\n         . \" -Wformat\"\n         . \" -Wtype-limits\"\n@@ -135,19 +139,20 @@ my $gcc_devteam_warn = \"-DDEBUG_UNUSED\"\n # These are used in addition to $gcc_devteam_warn when the compiler is clang.\n # TODO(openssl-team): fix problems and investigate if (at least) the\n # following warnings can also be enabled:\n-#       -Wswitch-enum\n #       -Wcast-align\n-#       -Wunreachable-code\n+#       -Wunreachable-code -- no, too ugly/compiler-specific\n #       -Wlanguage-extension-token -- no, we use asm()\n #       -Wunused-macros -- no, too tricky for BN and _XOPEN_SOURCE etc\n #       -Wextended-offsetof -- no, needed in CMS ASN1 code\n my $clang_devteam_warn = \"\"\n-        . \" -Qunused-arguments\"\n+        . \" -Wswitch-default\"\n+        . \" -Wno-parentheses-equality\"\n         . \" -Wno-language-extension-token\"\n         . \" -Wno-extended-offsetof\"\n         . \" -Wconditional-uninitialized\"\n         . \" -Wincompatible-pointer-types-discards-qualifiers\"\n         . \" -Wmissing-variable-declarations\"\n+        . \" -Wno-unknown-warning-option\"\n         ;\n \n # This adds backtrace information to the memory leak info.  Is only used\n@@ -178,6 +183,10 @@ my $apitable = {\n our %table = ();\n our %config = ();\n our %withargs = ();\n+our $now_printing;      # set to current entry's name in print_table_entry\n+                        # (todo: right thing would be to encapsulate name\n+                        # into %target [class] and make print_table_entry\n+                        # a method)\n \n # Forward declarations ###############################################\n \n@@ -210,6 +219,8 @@ $config{builddir} = abs2rel($blddir);\n my @argvcopy=@ARGV;\n \n if (grep /^reconf(igure)?$/, @argvcopy) {\n+    die \"reconfiguring with other arguments present isn't supported\"\n+        if scalar @argvcopy > 1;\n     if (-f \"./configdata.pm\") {\n \tmy $file = \"./configdata.pm\";\n \tunless (my $return = do $file) {\n@@ -222,22 +233,7 @@ if (grep /^reconf(igure)?$/, @argvcopy) {\n \t    @{$configdata::config{perlargv}} : ();\n \tdie \"Incorrect data to reconfigure, please do a normal configuration\\n\"\n \t    if (grep(/^reconf/,@argvcopy));\n-\t$ENV{CROSS_COMPILE} = $configdata::config{cross_compile_prefix}\n-\t    if defined($configdata::config{cross_compile_prefix});\n-\t$ENV{CC} = $configdata::config{cc}\n-\t    if defined($configdata::config{cc});\n-\t$ENV{BUILDFILE} = $configdata::config{build_file}\n-\t    if defined($configdata::config{build_file});\n-\t$ENV{$local_config_envname} = $configdata::config{local_config_dir}\n-\t    if defined($configdata::config{local_config_dir});\n-\n-\tprint \"Reconfiguring with: \", join(\" \",@argvcopy), \"\\n\";\n-\tprint \"    CROSS_COMPILE = \",$ENV{CROSS_COMPILE},\"\\n\"\n-\t    if $ENV{CROSS_COMPILE};\n-\tprint \"    CC = \",$ENV{CC},\"\\n\" if $ENV{CC};\n-\tprint \"    BUILDFILE = \",$ENV{BUILDFILE},\"\\n\" if $ENV{BUILDFILE};\n-\tprint \"    $local_config_envname = \",$ENV{$local_config_envname},\"\\n\"\n-\t    if $ENV{$local_config_envname};\n+\t$config{perlenv} = $configdata::config{perlenv} // {};\n     } else {\n \tdie \"Insufficient data to reconfigure, please do a normal configuration\\n\";\n     }\n@@ -276,50 +272,49 @@ foreach (sort glob($pattern)) {\n     &read_config($_);\n }\n \n-if (defined $ENV{$local_config_envname}) {\n+if (defined env($local_config_envname)) {\n     if ($^O eq 'VMS') {\n         # VMS environment variables are logical names,\n         # which can be used as is\n         $pattern = $local_config_envname . ':' . '*.conf';\n     } else {\n-        $pattern = catfile($ENV{$local_config_envname}, '*.conf');\n+        $pattern = catfile(env($local_config_envname), '*.conf');\n     }\n \n     foreach (sort glob($pattern)) {\n         &read_config($_);\n     }\n }\n \n-\n-print \"Configuring OpenSSL version $config{version} ($config{version_num})\\n\";\n+# Save away perl command information\n+$config{perl_cmd} = $^X;\n+$config{perl_version} = $Config{version};\n+$config{perl_archname} = $Config{archname};\n \n $config{prefix}=\"\";\n $config{openssldir}=\"\";\n $config{processor}=\"\";\n $config{libdir}=\"\";\n-$config{cross_compile_prefix}=\"\";\n-$config{fipslibdir}=\"/usr/local/ssl/fips-2.0/lib/\";\n-my $nofipscanistercheck=0;\n-$config{baseaddr}=\"0xFB00000\";\n my $auto_threads=1;    # enable threads automatically? true by default\n my $default_ranlib;\n-$config{fips}=0;\n \n # Top level directories to build\n $config{dirs} = [ \"crypto\", \"ssl\", \"engines\", \"apps\", \"test\", \"util\", \"tools\", \"fuzz\" ];\n # crypto/ subdirectories to build\n $config{sdirs} = [\n     \"objects\",\n-    \"md2\", \"md4\", \"md5\", \"sha\", \"mdc2\", \"hmac\", \"ripemd\", \"whrlpool\", \"poly1305\", \"blake2\",\n-    \"des\", \"aes\", \"rc2\", \"rc4\", \"rc5\", \"idea\", \"bf\", \"cast\", \"camellia\", \"seed\", \"chacha\", \"modes\",\n-    \"bn\", \"ec\", \"rsa\", \"dsa\", \"dh\", \"dso\", \"engine\",\n+    \"md2\", \"md4\", \"md5\", \"sha\", \"mdc2\", \"hmac\", \"ripemd\", \"whrlpool\", \"poly1305\", \"blake2\", \"siphash\", \"sm3\",\n+    \"des\", \"aes\", \"rc2\", \"rc4\", \"rc5\", \"idea\", \"aria\", \"bf\", \"cast\", \"camellia\", \"seed\", \"sm4\", \"chacha\", \"modes\",\n+    \"bn\", \"ec\", \"rsa\", \"dsa\", \"dh\", \"sm2\", \"dso\", \"engine\",\n     \"buffer\", \"bio\", \"stack\", \"lhash\", \"rand\", \"err\",\n     \"evp\", \"asn1\", \"pem\", \"x509\", \"x509v3\", \"conf\", \"txt_db\", \"pkcs7\", \"pkcs12\", \"comp\", \"ocsp\", \"ui\",\n-    \"cms\", \"ts\", \"srp\", \"cmac\", \"ct\", \"async\", \"kdf\"\n+    \"cms\", \"ts\", \"srp\", \"cmac\", \"ct\", \"async\", \"kdf\", \"store\"\n     ];\n+# test/ subdirectories to build\n+$config{tdirs} = [ \"ossl_shim\" ];\n \n # Known TLS and DTLS protocols\n-my @tls = qw(ssl3 tls1 tls1_1 tls1_2);\n+my @tls = qw(ssl3 tls1 tls1_1 tls1_2 tls1_3);\n my @dtls = qw(dtls1 dtls1_2);\n \n # Explicitly known options that are possible to disable.  They can\n@@ -328,11 +323,13 @@ my @dtls = qw(dtls1 dtls1_2);\n \n my @disablables = (\n     \"afalgeng\",\n+    \"aria\",\n     \"asan\",\n     \"asm\",\n     \"async\",\n     \"autoalginit\",\n     \"autoerrinit\",\n+    \"autoload-config\",\n     \"bf\",\n     \"blake2\",\n     \"camellia\",\n@@ -347,6 +344,7 @@ my @disablables = (\n     \"ct\",\n     \"deprecated\",\n     \"des\",\n+    \"devcryptoeng\",\n     \"dgram\",\n     \"dh\",\n     \"dsa\",\n@@ -361,6 +359,7 @@ my @disablables = (\n     \"egd\",\n     \"engine\",\n     \"err\",\n+    \"external-tests\",\n     \"filenames\",\n     \"fuzz-libfuzzer\",\n     \"fuzz-afl\",\n@@ -391,6 +390,10 @@ my @disablables = (\n     \"sctp\",\n     \"seed\",\n     \"shared\",\n+    \"siphash\",\n+    \"sm2\",\n+    \"sm3\",\n+    \"sm4\",\n     \"sock\",\n     \"srp\",\n     \"srtp\",\n@@ -399,11 +402,12 @@ my @disablables = (\n     \"ssl-trace\",\n     \"static-engine\",\n     \"stdio\",\n+    \"tests\",\n     \"threads\",\n     \"tls\",\n     \"ts\",\n     \"ubsan\",\n-    \"ui\",\n+    \"ui-console\",\n     \"unit-test\",\n     \"whirlpool\",\n     \"weak-ssl-ciphers\",\n@@ -413,23 +417,26 @@ my @disablables = (\n foreach my $proto ((@tls, @dtls))\n \t{\n \tpush(@disablables, $proto);\n-\tpush(@disablables, \"$proto-method\");\n+\tpush(@disablables, \"$proto-method\") unless $proto eq \"tls1_3\";\n \t}\n \n my %deprecated_disablables = (\n     \"ssl2\" => undef,\n     \"buf-freelists\" => undef,\n-    \"ripemd\" => \"rmd160\"\n+    \"ripemd\" => \"rmd160\",\n+    \"ui\" => \"ui-console\",\n     );\n \n-# All of the following is disabled by default (RC5 was enabled before 0.9.8):\n+# All of the following are disabled by default:\n \n our %disabled = ( # \"what\"         => \"comment\"\n-                  \"asan\"\t\t=> \"default\",\n+\t\t  \"asan\"\t\t=> \"default\",\n \t\t  \"crypto-mdebug\"       => \"default\",\n \t\t  \"crypto-mdebug-backtrace\" => \"default\",\n+\t\t  \"devcryptoeng\"\t=> \"default\",\n \t\t  \"ec_nistp_64_gcc_128\" => \"default\",\n \t\t  \"egd\"                 => \"default\",\n+\t\t  \"external-tests\"\t=> \"default\",\n \t\t  \"fuzz-libfuzzer\"\t=> \"default\",\n \t\t  \"fuzz-afl\"\t\t=> \"default\",\n \t\t  \"heartbeats\"          => \"default\",\n@@ -476,14 +483,17 @@ my @disable_cascades = (\n     # Without position independent code, there can be no shared libraries or DSOs\n     \"pic\"               => [ \"shared\" ],\n     \"shared\"            => [ \"dynamic-engine\" ],\n-    \"engine\"            => [ \"afalgeng\" ],\n+    \"engine\"            => [ \"afalgeng\", \"devcryptoeng\" ],\n \n     # no-autoalginit is only useful when building non-shared\n     \"autoalginit\"       => [ \"shared\", \"apps\" ],\n \n     \"stdio\"             => [ \"apps\", \"capieng\", \"egd\" ],\n     \"apps\"              => [ \"tests\" ],\n-    \"comp\"\t\t=> [ \"zlib\" ],\n+    \"tests\"             => [ \"external-tests\" ],\n+    \"comp\"              => [ \"zlib\" ],\n+    \"ec\"                => [ \"tls1_3\", \"sm2\" ],\n+    \"sm3\"               => [ \"sm2\" ],\n     sub { !$disabled{\"unit-test\"} } => [ \"heartbeats\" ],\n \n     sub { !$disabled{\"msan\"} } => [ \"asm\" ],\n@@ -513,31 +523,134 @@ while ((my $first, my $second) = (shift @list, shift @list)) {\n \n &usage if ($#ARGV < 0);\n \n-my $user_cflags=\"\";\n-my @user_defines=();\n+# For the \"make variables\" CINCLUDES and CDEFINES, we support lists with\n+# platform specific list separators.  Users from those platforms should\n+# recognise those separators from how you set up the PATH to find executables.\n+# The default is the Unix like separator, :, but as an exception, we also\n+# support the space as separator.\n+my $list_separator_re =\n+    { VMS           => qr/(?<!\\^),/,\n+      MSWin32       => qr/(?<!\\\\);/ } -> {$^O} // qr/(?<!\\\\)[:\\s]/;\n+# All the \"make variables\" we support\n+# Some get pre-populated for the sake of backward compatibility\n+# (we supported those before the change to \"make variable\" support.\n+my %user = (\n+    AR          => env('AR'),\n+    ARFLAGS     => [],\n+    AS          => undef,\n+    ASFLAGS     => [],\n+    CC          => env('CC'),\n+    CFLAGS      => [],\n+    CXX         => env('CXX'),\n+    CXXFLAGS    => [],\n+    CPP         => undef,\n+    CPPFLAGS    => [],  # -D, -I, -Wp,\n+    CPPDEFINES  => [],  # Alternative for -D\n+    CPPINCLUDES => [],  # Alternative for -I\n+    CROSS_COMPILE => env('CROSS_COMPILE'),\n+    HASHBANGPERL=> env('HASHBANGPERL') || env('PERL'),\n+    LD          => undef,\n+    LDFLAGS     => [],  # -L, -Wl,\n+    LDLIBS      => [],  # -l\n+    MT          => undef,\n+    MTFLAGS     => [],\n+    PERL        => env('PERL') || ($^O ne \"VMS\" ? $^X : \"perl\"),\n+    RANLIB      => env('RANLIB'),\n+    RC          => env('RC') || env('WINDRES'),\n+    RCFLAGS     => [],\n+    RM          => undef,\n+   );\n+# Info about what \"make variables\" may be prefixed with the cross compiler\n+# prefix.  This should NEVER mention any such variable with a list for value.\n+my @user_crossable = qw ( AR AS CC CXX CPP LD MT RANLIB RC );\n+# The same but for flags given as Configure options.  These are *additional*\n+# input, as opposed to the VAR=string option that override the corresponding\n+# config target attributes\n+my %useradd = (\n+    CPPDEFINES  => [],\n+    CPPINCLUDES => [],\n+    CPPFLAGS    => [],\n+    CFLAGS      => [],\n+    CXXFLAGS    => [],\n+    LDFLAGS     => [],\n+    LDLIBS      => [],\n+   );\n+\n+my %user_synonyms = (\n+    HASHBANGPERL=> 'PERL',\n+    RC          => 'WINDRES',\n+   );\n+\n+# Some target attributes have been renamed, this is the translation table\n+my %target_attr_translate =(\n+    ar          => 'AR',\n+    as          => 'AS',\n+    cc          => 'CC',\n+    cxx         => 'CXX',\n+    cpp         => 'CPP',\n+    hashbangperl => 'HASHBANGPERL',\n+    ld          => 'LD',\n+    mt          => 'MT',\n+    ranlib      => 'RANLIB',\n+    rc          => 'RC',\n+    rm          => 'RM',\n+   );\n+\n+# Initialisers coming from 'config' scripts\n+$config{defines} = [ split(/$list_separator_re/, env('__CNF_CPPDEFINES')) ];\n+$config{includes} = [ split(/$list_separator_re/, env('__CNF_CPPINCLUDES')) ];\n+$config{cppflags} = [ env('__CNF_CPPFLAGS') || () ];\n+$config{cflags} = [ env('__CNF_CFLAGS') || () ];\n+$config{cxxflags} = [ env('__CNF_CXXFLAGS') || () ];\n+$config{lflags} = [ env('__CNF_LDFLAGS') || () ];\n+$config{ex_libs} = [ env('__CNF_LDLIBS') || () ];\n+\n $config{openssl_api_defines}=[];\n $config{openssl_algorithm_defines}=[];\n $config{openssl_thread_defines}=[];\n $config{openssl_sys_defines}=[];\n $config{openssl_other_defines}=[];\n-my $libs=\"\";\n-my $target=\"\";\n $config{options}=\"\";\n $config{build_type} = \"release\";\n+my $target=\"\";\n \n+my %cmdvars = ();               # Stores FOO='blah' type arguments\n my %unsupported_options = ();\n my %deprecated_options = ();\n+# If you change this, update apps/version.c\n+my @known_seed_sources = qw(getrandom devrandom os egd none rdcpu librandom);\n+my @seed_sources = ();\n while (@argvcopy)\n \t{\n \t$_ = shift @argvcopy;\n+\n+\t# Support env variable assignments among the options\n+\tif (m|^(\\w+)=(.+)?$|)\n+\t\t{\n+\t\t$cmdvars{$1} = $2;\n+\t\t# Every time a variable is given as a configuration argument,\n+\t\t# it acts as a reset if the variable.\n+\t\tif (exists $user{$1})\n+\t\t\t{\n+\t\t\t$user{$1} = ref $user{$1} eq \"ARRAY\" ? [] : undef;\n+\t\t\t}\n+\t\t#if (exists $useradd{$1})\n+\t\t#\t{\n+\t\t#\t$useradd{$1} = [];\n+\t\t#\t}\n+\t\tnext;\n+\t\t}\n+\n \t# VMS is a case insensitive environment, and depending on settings\n \t# out of our control, we may receive options uppercased.  Let's\n \t# downcase at least the part before any equal sign.\n \tif ($^O eq \"VMS\")\n \t\t{\n \t\ts/^([^=]*)/lc($1)/e;\n \t\t}\n-\ts /^-no-/no-/; # some people just can't read the instructions\n+\n+\t# some people just can't read the instructions, clang people have to...\n+\ts/^-no-(?!integrated-as)/no-/;\n \n \t# rewrite some options in \"enable-...\" form\n \ts /^-?-?shared$/enable-shared/;\n@@ -647,7 +760,7 @@ while (@argvcopy)\n \t\t{ $config{processor}=386; }\n \telsif (/^fips$/)\n \t\t{\n-\t\t$config{fips}=1;\n+\t\tdie \"FIPS mode not supported\\n\";\n \t\t}\n \telsif (/^rsaref$/)\n \t\t{\n@@ -657,8 +770,7 @@ while (@argvcopy)\n \t\t}\n \telsif (/^nofipscanistercheck$/)\n \t\t{\n-\t\t$config{fips} = 1;\n-\t\t$nofipscanistercheck = 1;\n+\t\tdie \"FIPS mode not supported\\n\";\n \t\t}\n \telsif (/^[-+]/)\n \t\t{\n@@ -696,50 +808,68 @@ while (@argvcopy)\n \t\t\t{\n \t\t\t$withargs{fuzzer_include}=$1;\n \t\t\t}\n-\t\telsif (/^--with-fipslibdir=(.*)$/)\n+\t\telsif (/^--with-rand-seed=(.*)$/)\n \t\t\t{\n-\t\t\t$config{fipslibdir}=\"$1/\";\n-\t\t\t}\n-\t\telsif (/^--with-baseaddr=(.*)$/)\n-\t\t\t{\n-\t\t\t$config{baseaddr}=\"$1\";\n-\t\t\t}\n+\t\t\tforeach my $x (split(m|,|, $1))\n+\t\t\t    {\n+\t\t\t    die \"Unknown --with-rand-seed choice $x\\n\"\n+\t\t\t\tif ! grep { $x eq $_ } @known_seed_sources;\n+\t\t\t    push @seed_sources, $x;\n+\t\t\t    }\n+                        }\n \t\telsif (/^--cross-compile-prefix=(.*)$/)\n \t\t\t{\n-\t\t\t$config{cross_compile_prefix}=$1;\n+\t\t\t$user{CROSS_COMPILE}=$1;\n \t\t\t}\n \t\telsif (/^--config=(.*)$/)\n \t\t\t{\n \t\t\tread_config $1;\n \t\t\t}\n-\t\telsif (/^-[lL](.*)$/ or /^-Wl,/)\n+\t\telsif (/^-l(.*)$/)\n+\t\t\t{\n+\t\t\tpush @{$useradd{LDLIBS}}, $_;\n+\t\t\t}\n+\t\telsif (/^-framework$/)\n \t\t\t{\n-\t\t\t$libs.=$_.\" \";\n+\t\t\tpush @{$useradd{LDLIBS}}, $_, shift(@argvcopy);\n+\t\t\t}\n+\t\telsif (/^-L(.*)$/ or /^-Wl,/)\n+\t\t\t{\n+\t\t\tpush @{$useradd{LDFLAGS}}, $_;\n \t\t\t}\n \t\telsif (/^-rpath$/ or /^-R$/)\n \t\t\t# -rpath is the OSF1 rpath flag\n \t\t\t# -R is the old Solaris rpath flag\n \t\t\t{\n \t\t\tmy $rpath = shift(@argvcopy) || \"\";\n \t\t\t$rpath .= \" \" if $rpath ne \"\";\n-\t\t\t$libs.=$_.\" \".$rpath;\n+\t\t\tpush @{$useradd{LDFLAGS}}, $_, $rpath;\n \t\t\t}\n \t\telsif (/^-static$/)\n \t\t\t{\n-\t\t\t$libs.=$_.\" \";\n+\t\t\tpush @{$useradd{LDFLAGS}}, $_;\n \t\t\t$disabled{\"dso\"} = \"forced\";\n \t\t\t$disabled{\"pic\"} = \"forced\";\n \t\t\t$disabled{\"shared\"} = \"forced\";\n \t\t\t$disabled{\"threads\"} = \"forced\";\n \t\t\t}\n \t\telsif (/^-D(.*)$/)\n \t\t\t{\n-\t\t\tpush @user_defines, $1;\n+\t\t\tpush @{$useradd{CPPDEFINES}}, $1;\n+\t\t\t}\n+\t\telsif (/^-I(.*)$/)\n+\t\t\t{\n+\t\t\tpush @{$useradd{CPPINCLUDES}}, $1;\n+\t\t\t}\n+\t\telsif (/^-Wp,$/)\n+\t\t\t{\n+\t\t\tpush @{$useradd{CPPFLAGS}}, $1;\n \t\t\t}\n \t\telse\t# common if (/^[-+]/), just pass down...\n \t\t\t{\n \t\t\t$_ =~ s/%([0-9a-f]{1,2})/chr(hex($1))/gei;\n-\t\t\t$user_cflags.=\" \".$_;\n+\t\t\tpush @{$useradd{CFLAGS}}, $_;\n+\t\t\tpush @{$useradd{CXXFLAGS}}, $_;\n \t\t\t}\n \t\t}\n \telse\n@@ -749,7 +879,7 @@ while (@argvcopy)\n \t\t}\n \tunless ($_ eq $target || /^no-/ || /^disable-/)\n \t\t{\n-\t\t# \"no-...\" follows later after implied disactivations\n+\t\t# \"no-...\" follows later after implied deactivations\n \t\t# have been derived.  (Don't take this too seriously,\n \t\t# we really only write OPTIONS to the Makefile out of\n \t\t# nostalgia.)\n@@ -776,22 +906,63 @@ if (keys %unsupported_options)\n \t\tjoin(\", \", keys %unsupported_options), \"\\n\";\n \t}\n \n-if ($libs =~ /(^|\\s)-Wl,-rpath,/\n+# If any %useradd entry has been set, we must check that the \"make\n+# variables\" haven't been set.  We start by checking of any %useradd entry\n+# is set.\n+if (grep { scalar @$_ > 0 } values %useradd) {\n+    # Hash of env / make variables names.  The possible values are:\n+    # 1 - \"make vars\"\n+    # 2 - %useradd entry set\n+    # 3 - both set\n+    my %detected_vars =\n+        map { my $v = 0;\n+              $v += 1 if $cmdvars{$_};\n+              $v += 2 if @{$useradd{$_}};\n+              $_ => $v }\n+        keys %useradd;\n+\n+    # If any of the corresponding \"make variables\" is set, we error\n+    if (grep { $_ & 1 } values %detected_vars) {\n+        my $names = join(', ', grep { $detected_vars{$_} > 0 }\n+                               sort keys %detected_vars);\n+        die <<\"_____\";\n+***** Mixing make variables and additional compiler/linker flags as\n+***** configure command line option is not permitted.\n+***** Affected make variables: $names\n+_____\n+    }\n+}\n+\n+# Check through all supported command line variables to see if any of them\n+# were set, and canonicalise the values we got.  If no compiler or linker\n+# flag or anything else that affects %useradd was set, we also check the\n+# environment for values.\n+my $anyuseradd =\n+    grep { defined $_ && (ref $_ ne 'ARRAY' || @$_) } values %useradd;\n+foreach (keys %user) {\n+    my $value = $cmdvars{$_};\n+    $value //= env($_) unless $anyuseradd;\n+    $value //=\n+        defined $user_synonyms{$_} ? $cmdvars{$user_synonyms{$_}} : undef;\n+    $value //= defined $user_synonyms{$_} ? env($user_synonyms{$_}) : undef\n+        unless $anyuseradd;\n+\n+    if (defined $value) {\n+        if (ref $user{$_} eq 'ARRAY') {\n+            $user{$_} = [ split /$list_separator_re/, $value ];\n+        } elsif (!defined $user{$_}) {\n+            $user{$_} = $value;\n+        }\n+    }\n+}\n+\n+if (grep { /-rpath\\b/ } ($user{LDFLAGS} ? @{$user{LDFLAGS}} : ())\n     && !$disabled{shared}\n     && !($disabled{asan} && $disabled{msan} && $disabled{ubsan})) {\n     die \"***** Cannot simultaneously use -rpath, shared libraries, and\\n\",\n \t\"***** any of asan, msan or ubsan\\n\";\n }\n \n-if ($config{fips})\n-\t{\n-\tdelete $disabled{\"shared\"} if ($disabled{\"shared\"} =~ /^default/);\n-\t}\n-else\n-\t{\n-\t@{$config{dirs}} = grep !/^fips$/, @{$config{dirs}};\n-\t}\n-\n my @tocheckfor = (keys %disabled);\n while (@tocheckfor) {\n     my %new_tocheckfor = ();\n@@ -832,74 +1003,38 @@ if ($target eq \"HASH\") {\n     exit 0;\n }\n \n-# Backward compatibility?\n-if ($target =~ m/^CygWin32(-.*)$/) {\n-    $target = \"Cygwin\".$1;\n-}\n+print \"Configuring OpenSSL version $config{version} ($config{version_num}) \";\n+print \"for $target\\n\";\n \n-foreach (sort (keys %disabled))\n-\t{\n-\t$config{options} .= \" no-$_\";\n-\n-\tprintf \"    no-%-12s %-10s\", $_, \"[$disabled{$_}]\";\n-\n-\tif (/^dso$/)\n-\t\t{ }\n-\telsif (/^threads$/)\n-\t\t{ }\n-\telsif (/^shared$/)\n-\t\t{ }\n-\telsif (/^pic$/)\n-\t\t{ }\n-\telsif (/^zlib$/)\n-\t\t{ }\n-\telsif (/^dynamic-engine$/)\n-\t\t{ }\n-\telsif (/^makedepend$/)\n-\t\t{ }\n-\telsif (/^zlib-dynamic$/)\n-\t\t{ }\n-\telsif (/^sse2$/)\n-\t\t{ }\n-\telsif (/^engine$/)\n-\t\t{\n-\t\t@{$config{dirs}} = grep !/^engines$/, @{$config{dirs}};\n-\t\t@{$config{sdirs}} = grep !/^engine$/, @{$config{sdirs}};\n-\t\tpush @{$config{openssl_other_defines}}, \"OPENSSL_NO_ENGINE\";\n-\t\tprint \" OPENSSL_NO_ENGINE (skip engines)\";\n-\t\t}\n-\telse\n-\t\t{\n-\t\tmy ($WHAT, $what);\n-\n-\t\t($WHAT = $what = $_) =~ tr/[\\-a-z]/[_A-Z]/;\n+if (scalar(@seed_sources) == 0) {\n+    print \"Using os-specific seed configuration\\n\";\n+    push @seed_sources, 'os';\n+}\n+if (scalar(grep { $_ eq 'none' } @seed_sources) > 0) {\n+    die \"Cannot seed with none and anything else\" if scalar(@seed_sources) > 1;\n+    warn <<_____ if scalar(@seed_sources) == 1;\n \n-\t\t# Fix up C macro end names\n-\t\t$WHAT = \"RMD160\" if $what eq \"ripemd\";\n+============================== WARNING ===============================\n+You have selected the --with-rand-seed=none option, which effectively\n+disables automatic reseeding of the OpenSSL random generator.\n+All operations depending on the random generator such as creating keys\n+will not work unless the random generator is seeded manually by the\n+application.\n \n-\t\t# fix-up crypto/directory name(s)\n-\t\t$what = \"ripemd\" if $what eq \"rmd160\";\n-\t\t$what = \"whrlpool\" if $what eq \"whirlpool\";\n+Please read the 'Note on random number generation' section in the\n+INSTALL instructions and the RAND_DRBG(7) manual page for more details.\n+============================== WARNING ===============================\n \n-\t\tif ($what ne \"async\" && $what ne \"err\"\n-\t\t    && grep { $_ eq $what } @{$config{sdirs}})\n-\t\t\t{\n-\t\t\tpush @{$config{openssl_algorithm_defines}}, \"OPENSSL_NO_$WHAT\";\n-\t\t\t@{$config{sdirs}} = grep { $_ ne $what} @{$config{sdirs}};\n-\n-\t\t\tprint \" OPENSSL_NO_$WHAT (skip dir)\";\n-\t\t\t}\n-\t\telse\n-\t\t\t{\n-\t\t\tpush @{$config{openssl_other_defines}}, \"OPENSSL_NO_$WHAT\";\n-\t\t\tprint \" OPENSSL_NO_$WHAT\";\n-\t\t\t}\n-\t\t}\n-\n-\tprint \"\\n\";\n-\t}\n+_____\n+}\n+push @{$config{openssl_other_defines}},\n+     map { (my $x = $_) =~ tr|[\\-a-z]|[_A-Z]|; \"OPENSSL_RAND_SEED_$x\" }\n+\t@seed_sources;\n \n-print \"Configuring for $target\\n\";\n+# Backward compatibility?\n+if ($target =~ m/^CygWin32(-.*)$/) {\n+    $target = \"Cygwin\".$1;\n+}\n \n # Support for legacy targets having a name starting with 'debug-'\n my ($d, $t) = $target =~ m/^(debug-)?(.*)$/;\n@@ -917,54 +1052,161 @@ if ($d) {\n $config{target} = $target;\n my %target = resolve_config($target);\n \n+foreach (keys %target_attr_translate) {\n+    $target{$target_attr_translate{$_}} = $target{$_}\n+        if $target{$_};\n+    delete $target{$_};\n+}\n+\n+%target = ( %{$table{DEFAULTS}}, %target );\n+\n+# Make the flags to build DSOs the same as for shared libraries unless they\n+# are already defined\n+$target{module_cflags} = $target{shared_cflag} unless defined $target{module_cflags};\n+$target{module_cxxflags} = $target{shared_cxxflag} unless defined $target{module_cxxflags};\n+$target{module_ldflags} = $target{shared_ldflag} unless defined $target{module_ldflags};\n+{\n+    my $shared_info_pl =\n+        catfile(dirname($0), \"Configurations\", \"shared-info.pl\");\n+    my %shared_info = read_eval_file($shared_info_pl);\n+    push @{$target{_conf_fname_int}}, $shared_info_pl;\n+    my $si = $target{shared_target};\n+    while (ref $si ne \"HASH\") {\n+        last if ! defined $si;\n+        if (ref $si eq \"CODE\") {\n+            $si = $si->();\n+        } else {\n+            $si = $shared_info{$si};\n+        }\n+    }\n+\n+    # Some of the 'shared_target' values don't have any entried in\n+    # %shared_info.  That's perfectly fine, AS LONG AS the build file\n+    # template knows how to handle this.  That is currently the case for\n+    # Windows and VMS.\n+    if (defined $si) {\n+        # Just as above, copy certain shared_* attributes to the corresponding\n+        # module_ attribute unless the latter is already defined\n+        $si->{module_cflags} = $si->{shared_cflag} unless defined $si->{module_cflags};\n+        $si->{module_cxxflags} = $si->{shared_cxxflag} unless defined $si->{module_cxxflags};\n+        $si->{module_ldflags} = $si->{shared_ldflag} unless defined $si->{module_ldflags};\n+        foreach (sort keys %$si) {\n+            $target{$_} = defined $target{$_}\n+                ? add($si->{$_})->($target{$_})\n+                : $si->{$_};\n+        }\n+    }\n+}\n+\n my %conf_files = map { $_ => 1 } (@{$target{_conf_fname_int}});\n $config{conf_files} = [ sort keys %conf_files ];\n-%target = ( %{$table{DEFAULTS}}, %target );\n \n+foreach my $feature (@{$target{disable}}) {\n+    if (exists $deprecated_disablables{$feature}) {\n+        warn \"***** config $target disables deprecated feature $feature\\n\";\n+    } elsif (!grep { $feature eq $_ } @disablables) {\n+        die \"***** config $target disables unknown feature $feature\\n\";\n+    }\n+    $disabled{$feature} = 'config';\n+}\n+foreach my $feature (@{$target{enable}}) {\n+    if (\"default\" eq ($disabled{$_} // \"\")) {\n+        if (exists $deprecated_disablables{$feature}) {\n+            warn \"***** config $target enables deprecated feature $feature\\n\";\n+        } elsif (!grep { $feature eq $_ } @disablables) {\n+            die \"***** config $target enables unknown feature $feature\\n\";\n+        }\n+        delete $disabled{$_};\n+    }\n+}\n+\n+$target{CXXFLAGS}//=$target{CFLAGS} if $target{CXX};\n+$target{cxxflags}//=$target{cflags} if $target{CXX};\n $target{exe_extension}=\"\";\n $target{exe_extension}=\".exe\" if ($config{target} eq \"DJGPP\"\n                                   || $config{target} =~ /^(?:Cygwin|mingw)/);\n $target{exe_extension}=\".pm\"  if ($config{target} =~ /vos/);\n \n ($target{shared_extension_simple}=$target{shared_extension})\n-    =~ s|\\.\\$\\(SHLIB_MAJOR\\)\\.\\$\\(SHLIB_MINOR\\)||;\n-$target{dso_extension}=$target{shared_extension_simple};\n+    =~ s|\\.\\$\\(SHLIB_VERSION_NUMBER\\)||\n+    unless defined($target{shared_extension_simple});\n+$target{dso_extension}//=$target{shared_extension_simple};\n ($target{shared_import_extension}=$target{shared_extension_simple}.\".a\")\n     if ($config{target} =~ /^(?:Cygwin|mingw)/);\n \n+# Fill %config with values from %user, and in case those are undefined or\n+# empty, use values from %target (acting as a default).\n+foreach (keys %user) {\n+    my $ref_type = ref $user{$_};\n+\n+    # Temporary function.  Takes an intended ref type (empty string or \"ARRAY\")\n+    # and a value that's to be coerced into that type.\n+    my $mkvalue = sub {\n+        my $type = shift;\n+        my $value = shift;\n+        my $undef_p = shift;\n+\n+        die \"Too many arguments for \\$mkvalue\" if @_;\n+\n+        while (ref $value eq 'CODE') {\n+            $value = $value->();\n+        }\n \n-$config{cross_compile_prefix} = $ENV{'CROSS_COMPILE'}\n-    if $config{cross_compile_prefix} eq \"\";\n-\n-# Allow overriding the names of some tools.  USE WITH CARE\n-# Note: only Unix cares about HASHBANGPERL...  that explains\n-# the default string.\n-$config{perl} =    $ENV{'PERL'}    || ($^O ne \"VMS\" ? $^X : \"perl\");\n-$config{hashbangperl} =\n-    $ENV{'HASHBANGPERL'}           || $ENV{'PERL'}     || \"/usr/bin/env perl\";\n-$target{cc} =      $ENV{'CC'}      || $target{cc}      || \"cc\";\n-$target{ranlib} =  $ENV{'RANLIB'}  || $target{ranlib}  ||\n-                   (which(\"$config{cross_compile_prefix}ranlib\") ?\n-                          \"\\$(CROSS_COMPILE)ranlib\" : \"true\");\n-$target{ar} =      $ENV{'AR'}      || $target{ar}      || \"ar\";\n-$target{nm} =      $ENV{'NM'}      || $target{nm}      || \"nm\";\n-$target{rc} =\n-    $ENV{'RC'}  || $ENV{'WINDRES'} || $target{rc}      || \"windres\";\n+        if ($type eq 'ARRAY') {\n+            return undef unless defined $value;\n+            return undef if ref $value ne 'ARRAY' && !$value;\n+            return undef if ref $value eq 'ARRAY' && !@$value;\n+            return [ $value ] unless ref $value eq 'ARRAY';\n+        }\n+        return undef unless $value;\n+        return $value;\n+    };\n+\n+    $config{$_} =\n+        $mkvalue->($ref_type, $user{$_})\n+        || $mkvalue->($ref_type, $target{$_});\n+    delete $config{$_} unless defined $config{$_};\n+}\n \n # Allow overriding the build file name\n-$target{build_file} = $ENV{BUILDFILE} || $target{build_file} || \"Makefile\";\n+$config{build_file} = env('BUILDFILE') || $target{build_file} || \"Makefile\";\n \n-# Cache information necessary for reconfiguration\n-$config{cc} = $target{cc};\n-$config{build_file} = $target{build_file};\n+my %disabled_info = ();         # For configdata.pm\n+foreach my $what (sort keys %disabled) {\n+    $config{options} .= \" no-$what\";\n \n-# For cflags, lflags, plib_lflags, ex_libs and defines, add the debug_\n-# or release_ attributes.\n-# Do it in such a way that no spurious space is appended (hence the grep).\n-$config{defines} = [];\n-$config{cflags} = \"\";\n-$config{ex_libs} = \"\";\n-$config{shared_ldflag} = \"\";\n+    if (!grep { $what eq $_ } ( 'dso', 'threads', 'shared', 'pic',\n+                                'dynamic-engine', 'makedepend',\n+                                'zlib-dynamic', 'zlib', 'sse2' )) {\n+        (my $WHAT = uc $what) =~ s|-|_|g;\n+\n+        # Fix up C macro end names\n+        $WHAT = \"RMD160\" if $what eq \"ripemd\";\n+\n+        # fix-up crypto/directory name(s)\n+        $what = \"ripemd\" if $what eq \"rmd160\";\n+        $what = \"whrlpool\" if $what eq \"whirlpool\";\n+\n+        my $macro = $disabled_info{$what}->{macro} = \"OPENSSL_NO_$WHAT\";\n+\n+        if ((grep { $what eq $_ } @{$config{sdirs}})\n+                && $what ne 'async' && $what ne 'err') {\n+            @{$config{sdirs}} = grep { $what ne $_} @{$config{sdirs}};\n+            $disabled_info{$what}->{skipped} = [ catdir('crypto', $what) ];\n+\n+            if ($what ne 'engine') {\n+                push @{$config{openssl_algorithm_defines}}, $macro;\n+            } else {\n+                @{$config{dirs}} = grep !/^engines$/, @{$config{dirs}};\n+                push @{$disabled_info{engine}->{skipped}}, catdir('engines');\n+                push @{$config{openssl_other_defines}}, $macro;\n+            }\n+        } else {\n+            push @{$config{openssl_other_defines}}, $macro;\n+        }\n+\n+    }\n+}\n \n # Make sure build_scheme is consistent.\n $target{build_scheme} = [ $target{build_scheme} ]\n@@ -994,56 +1236,24 @@ foreach my $checker (($builder_platform.\"-\".$target{build_file}.\"-checker.pm\",\n \n push @{$config{defines}}, \"NDEBUG\"    if $config{build_type} eq \"release\";\n \n-if ($target =~ /^mingw/ && `$target{cc} --target-help 2>&1` =~ m/-mno-cygwin/m)\n+if ($target =~ /^mingw/ && `$config{CC} --target-help 2>&1` =~ m/-mno-cygwin/m)\n \t{\n-\t$config{cflags} .= \" -mno-cygwin\";\n-\t$config{shared_ldflag} .= \" -mno-cygwin\";\n+\tpush @{$config{cflags}}, \"-mno-cygwin\";\n+\tpush @{$config{cxxflags}}, \"-mno-cygwin\" if $config{CXX};\n+\tpush @{$config{shared_ldflag}}, \"-mno-cygwin\";\n \t}\n \n-if ($target =~ /linux.*-mips/ && !$disabled{asm} && $user_cflags !~ /-m(ips|arch=)/) {\n+if ($target =~ /linux.*-mips/ && !$disabled{asm}\n+        && !grep { $_ !~ /-m(ips|arch=)/ } (@{$user{CFLAGS}},\n+                                            @{$useradd{CFLAGS}})) {\n \t# minimally required architecture flags for assembly modules\n-\t$config{cflags}=\"-mips2 $config{cflags}\" if ($target =~ /mips32/);\n-\t$config{cflags}=\"-mips3 $config{cflags}\" if ($target =~ /mips64/);\n+\tmy $value;\n+\t$value = '-mips2' if ($target =~ /mips32/);\n+\t$value = '-mips3' if ($target =~ /mips64/);\n+\tunshift @{$config{cflags}}, $value;\n+\tunshift @{$config{cxxflags}}, $value if $config{CXX};\n }\n \n-my $no_shared_warn=0;\n-my $no_user_cflags=0;\n-my $no_user_defines=0;\n-\n-# The DSO code currently always implements all functions so that no\n-# applications will have to worry about that from a compilation point\n-# of view. However, the \"method\"s may return zero unless that platform\n-# has support compiled in for them. Currently each method is enabled\n-# by a define \"DSO_<name>\" ... we translate the \"dso_scheme\" config\n-# string entry into using the following logic;\n-if (!$disabled{dso} && $target{dso_scheme} ne \"\")\n-\t{\n-\t$target{dso_scheme} =~ tr/[a-z]/[A-Z]/;\n-\tif ($target{dso_scheme} eq \"DLFCN\")\n-\t\t{\n-\t\tunshift @{$config{defines}}, \"DSO_DLFCN\", \"HAVE_DLFCN_H\";\n-\t\t}\n-\telsif ($target{dso_scheme} eq \"DLFCN_NO_H\")\n-\t\t{\n-\t\tunshift @{$config{defines}}, \"DSO_DLFCN\";\n-\t\t}\n-\telse\n-\t\t{\n-\t\tunshift @{$config{defines}}, \"DSO_$target{dso_scheme}\";\n-\t\t}\n-\t}\n-\n-$config{ex_libs}=\"$libs$config{ex_libs}\" if ($libs ne \"\");\n-\n-if ($disabled{asm})\n-\t{\n-\tif ($config{fips})\n-\t\t{\n-\t\t@{$config{defines}} = grep !/^[BL]_ENDIAN$/, @{$config{defines}};\n-\t\t@{$target{defines}} = grep !/^[BL]_ENDIAN$/, @{$target{defines}};\n-\t\t}\n-\t}\n-\n # If threads aren't disabled, check how possible they are\n unless ($disabled{threads}) {\n     if ($auto_threads) {\n@@ -1060,7 +1270,8 @@ unless ($disabled{threads}) {\n             # system-dependent compiler options that are necessary.  We\n             # can't truly check that the given options are correct, but\n             # we expect the user to know what [s]He is doing.\n-            if ($no_user_cflags && $no_user_defines) {\n+            if (!@{$user{CFLAGS}} && !@{$useradd{CFLAGS}}\n+                    && !@{$user{CPPDEFINES}} && !@{$useradd{CPPDEFINES}}) {\n                 die \"You asked for multi-threading support, but didn't\\n\"\n                     ,\"provide any system-specific compiler options\\n\";\n             }\n@@ -1071,55 +1282,54 @@ unless ($disabled{threads}) {\n # If threads still aren't disabled, add a C macro to ensure the source\n # code knows about it.  Any other flag is taken care of by the configs.\n unless($disabled{threads}) {\n-    foreach ((\"defines\", \"openssl_thread_defines\")) {\n-        push @{$config{$_}}, \"OPENSSL_THREADS\";\n-    }\n+    push @{$config{openssl_thread_defines}}, \"OPENSSL_THREADS\";\n }\n \n # With \"deprecated\" disable all deprecated features.\n if (defined($disabled{\"deprecated\"})) {\n         $config{api} = $maxapi;\n }\n \n+my $no_shared_warn=0;\n if ($target{shared_target} eq \"\")\n \t{\n \t$no_shared_warn = 1\n-\t    if ((!$disabled{shared} || !$disabled{\"dynamic-engine\"})\n-\t\t&& !$config{fips});\n+\t    if (!$disabled{shared} || !$disabled{\"dynamic-engine\"});\n \t$disabled{shared} = \"no-shared-target\";\n \t$disabled{pic} = $disabled{shared} = $disabled{\"dynamic-engine\"} =\n \t    \"no-shared-target\";\n \t}\n \n if ($disabled{\"dynamic-engine\"}) {\n-        push @{$config{defines}}, \"OPENSSL_NO_DYNAMIC_ENGINE\";\n+        push @{$config{openssl_other_defines}}, \"OPENSSL_NO_DYNAMIC_ENGINE\";\n         $config{dynamic_engines} = 0;\n } else {\n-        push @{$config{defines}}, \"OPENSSL_NO_STATIC_ENGINE\";\n+        push @{$config{openssl_other_defines}}, \"OPENSSL_NO_STATIC_ENGINE\";\n         $config{dynamic_engines} = 1;\n }\n \n-unless ($disabled{\"fuzz-libfuzzer\"}) {\n-    $config{cflags} .= \"-fsanitize-coverage=edge,indirect-calls \";\n-}\n-\n unless ($disabled{asan}) {\n-    $config{cflags} .= \"-fsanitize=address \";\n+    push @{$config{cflags}}, \"-fsanitize=address\";\n+    push @{$config{cxxflags}}, \"-fsanitize=address\" if $config{CXX};\n }\n \n unless ($disabled{ubsan}) {\n     # -DPEDANTIC or -fnosanitize=alignment may also be required on some\n     # platforms.\n-    $config{cflags} .= \"-fsanitize=undefined -fno-sanitize-recover=all \";\n+    push @{$config{cflags}}, \"-fsanitize=undefined\", \"-fno-sanitize-recover=all\";\n+    push @{$config{cxxflags}}, \"-fsanitize=undefined\", \"-fno-sanitize-recover=all\"\n+        if $config{CXX};\n }\n \n unless ($disabled{msan}) {\n-  $config{cflags} .= \"-fsanitize=memory \";\n+  push @{$config{cflags}}, \"-fsanitize=memory\";\n+  push @{$config{cxxflags}}, \"-fsanitize=memory\" if $config{CXX};\n }\n \n unless ($disabled{\"fuzz-libfuzzer\"} && $disabled{\"fuzz-afl\"}\n         && $disabled{asan} && $disabled{ubsan} && $disabled{msan}) {\n-    $config{cflags} .= \"-fno-omit-frame-pointer -g \";\n+    push @{$config{cflags}}, \"-fno-omit-frame-pointer\", \"-g\";\n+    push @{$config{cxxflags}}, \"-fno-omit-frame-pointer\", \"-g\" if $config{CXX};\n }\n #\n # Platform fix-ups\n@@ -1128,12 +1338,18 @@ unless ($disabled{\"fuzz-libfuzzer\"} && $disabled{\"fuzz-afl\"}\n # This saves the build files from having to check\n if ($disabled{pic})\n \t{\n-\t$target{shared_cflag} = $target{shared_ldflag} =\n-\t\t$target{shared_rcflag} = \"\";\n+\tforeach (qw(shared_cflag shared_cxxflag shared_cppflag\n+\t\t    shared_defines shared_includes shared_ldflag\n+\t\t    module_cflags module_cxxflags module_cppflags\n+\t\t    module_defines module_includes module_lflags))\n+\t\t{\n+\t\tdelete $config{$_};\n+\t\t$target{$_} = \"\";\n+\t\t}\n \t}\n else\n \t{\n-\tpush @{$config{defines}}, \"OPENSSL_PIC\";\n+\tpush @{$config{lib_defines}}, \"OPENSSL_PIC\";\n \t}\n \n if ($target{sys_id} ne \"\")\n@@ -1143,96 +1359,115 @@ if ($target{sys_id} ne \"\")\n \n unless ($disabled{asm}) {\n     $target{cpuid_asm_src}=$table{DEFAULTS}->{cpuid_asm_src} if ($config{processor} eq \"386\");\n+    push @{$config{lib_defines}}, \"OPENSSL_CPUID_OBJ\" if ($target{cpuid_asm_src} ne \"mem_clr.c\");\n+\n     $target{bn_asm_src} =~ s/\\w+-gf2m.c// if (defined($disabled{ec2m}));\n \n     # bn-586 is the only one implementing bn_*_part_words\n-    push @{$config{defines}}, \"OPENSSL_BN_ASM_PART_WORDS\" if ($target{bn_asm_src} =~ /bn-586/);\n-    push @{$config{defines}}, \"OPENSSL_IA32_SSE2\" if (!$disabled{sse2} && $target{bn_asm_src} =~ /86/);\n+    push @{$config{lib_defines}}, \"OPENSSL_BN_ASM_PART_WORDS\" if ($target{bn_asm_src} =~ /bn-586/);\n+    push @{$config{lib_defines}}, \"OPENSSL_IA32_SSE2\" if (!$disabled{sse2} && $target{bn_asm_src} =~ /86/);\n \n-    push @{$config{defines}}, \"OPENSSL_BN_ASM_MONT\" if ($target{bn_asm_src} =~ /-mont/);\n-    push @{$config{defines}}, \"OPENSSL_BN_ASM_MONT5\" if ($target{bn_asm_src} =~ /-mont5/);\n-    push @{$config{defines}}, \"OPENSSL_BN_ASM_GF2m\" if ($target{bn_asm_src} =~ /-gf2m/);\n-\n-    if ($config{fips}) {\n-\tpush @{$config{openssl_other_defines}}, \"OPENSSL_FIPS\";\n-    }\n+    push @{$config{lib_defines}}, \"OPENSSL_BN_ASM_MONT\" if ($target{bn_asm_src} =~ /-mont/);\n+    push @{$config{lib_defines}}, \"OPENSSL_BN_ASM_MONT5\" if ($target{bn_asm_src} =~ /-mont5/);\n+    push @{$config{lib_defines}}, \"OPENSSL_BN_ASM_GF2m\" if ($target{bn_asm_src} =~ /-gf2m/);\n \n     if ($target{sha1_asm_src}) {\n-\tpush @{$config{defines}}, \"SHA1_ASM\"   if ($target{sha1_asm_src} =~ /sx86/ || $target{sha1_asm_src} =~ /sha1/);\n-\tpush @{$config{defines}}, \"SHA256_ASM\" if ($target{sha1_asm_src} =~ /sha256/);\n-\tpush @{$config{defines}}, \"SHA512_ASM\" if ($target{sha1_asm_src} =~ /sha512/);\n+\tpush @{$config{lib_defines}}, \"SHA1_ASM\"   if ($target{sha1_asm_src} =~ /sx86/ || $target{sha1_asm_src} =~ /sha1/);\n+\tpush @{$config{lib_defines}}, \"SHA256_ASM\" if ($target{sha1_asm_src} =~ /sha256/);\n+\tpush @{$config{lib_defines}}, \"SHA512_ASM\" if ($target{sha1_asm_src} =~ /sha512/);\n+    }\n+    if ($target{keccak1600_asm_src} ne $table{DEFAULTS}->{keccak1600_asm_src}) {\n+\tpush @{$config{lib_defines}}, \"KECCAK1600_ASM\";\n     }\n     if ($target{rc4_asm_src} ne $table{DEFAULTS}->{rc4_asm_src}) {\n-\tpush @{$config{defines}}, \"RC4_ASM\";\n+\tpush @{$config{lib_defines}}, \"RC4_ASM\";\n     }\n     if ($target{md5_asm_src}) {\n-\tpush @{$config{defines}}, \"MD5_ASM\";\n+\tpush @{$config{lib_defines}}, \"MD5_ASM\";\n     }\n     $target{cast_asm_src}=$table{DEFAULTS}->{cast_asm_src} unless $disabled{pic}; # CAST assembler is not PIC\n     if ($target{rmd160_asm_src}) {\n-\tpush @{$config{defines}}, \"RMD160_ASM\";\n+\tpush @{$config{lib_defines}}, \"RMD160_ASM\";\n     }\n     if ($target{aes_asm_src}) {\n-\tpush @{$config{defines}}, \"AES_ASM\" if ($target{aes_asm_src} =~ m/\\baes-/);;\n+\tpush @{$config{lib_defines}}, \"AES_ASM\" if ($target{aes_asm_src} =~ m/\\baes-/);;\n \t# aes-ctr.fake is not a real file, only indication that assembler\n \t# module implements AES_ctr32_encrypt...\n-\tpush @{$config{defines}}, \"AES_CTR_ASM\" if ($target{aes_asm_src} =~ s/\\s*aes-ctr\\.fake//);\n+\tpush @{$config{lib_defines}}, \"AES_CTR_ASM\" if ($target{aes_asm_src} =~ s/\\s*aes-ctr\\.fake//);\n \t# aes-xts.fake indicates presence of AES_xts_[en|de]crypt...\n-\tpush @{$config{defines}}, \"AES_XTS_ASM\" if ($target{aes_asm_src} =~ s/\\s*aes-xts\\.fake//);\n+\tpush @{$config{lib_defines}}, \"AES_XTS_ASM\" if ($target{aes_asm_src} =~ s/\\s*aes-xts\\.fake//);\n \t$target{aes_asm_src} =~ s/\\s*(vpaes|aesni)-x86\\.s//g if ($disabled{sse2});\n-\tpush @{$config{defines}}, \"VPAES_ASM\" if ($target{aes_asm_src} =~ m/vpaes/);\n-\tpush @{$config{defines}}, \"BSAES_ASM\" if ($target{aes_asm_src} =~ m/bsaes/);\n+\tpush @{$config{lib_defines}}, \"VPAES_ASM\" if ($target{aes_asm_src} =~ m/vpaes/);\n+\tpush @{$config{lib_defines}}, \"BSAES_ASM\" if ($target{aes_asm_src} =~ m/bsaes/);\n     }\n     if ($target{wp_asm_src} =~ /mmx/) {\n         if ($config{processor} eq \"386\") {\n \t    $target{wp_asm_src}=$table{DEFAULTS}->{wp_asm_src};\n \t} elsif (!$disabled{\"whirlpool\"}) {\n-\t    push @{$config{defines}}, \"WHIRLPOOL_ASM\";\n+\t    push @{$config{lib_defines}}, \"WHIRLPOOL_ASM\";\n \t}\n     }\n     if ($target{modes_asm_src} =~ /ghash-/) {\n-\tpush @{$config{defines}}, \"GHASH_ASM\";\n+\tpush @{$config{lib_defines}}, \"GHASH_ASM\";\n     }\n     if ($target{ec_asm_src} =~ /ecp_nistz256/) {\n-\tpush @{$config{defines}}, \"ECP_NISTZ256_ASM\";\n+\tpush @{$config{lib_defines}}, \"ECP_NISTZ256_ASM\";\n+    }\n+    if ($target{ec_asm_src} =~ /x25519/) {\n+\tpush @{$config{lib_defines}}, \"X25519_ASM\";\n     }\n     if ($target{padlock_asm_src} ne $table{DEFAULTS}->{padlock_asm_src}) {\n-\tpush @{$config{defines}}, \"PADLOCK_ASM\";\n+\tpush @{$config{lib_defines}}, \"PADLOCK_ASM\";\n     }\n     if ($target{poly1305_asm_src} ne \"\") {\n-\tpush @{$config{defines}}, \"POLY1305_ASM\";\n+\tpush @{$config{lib_defines}}, \"POLY1305_ASM\";\n     }\n }\n \n-my %predefined;\n-\n-if ($^O ne \"VMS\") {\n-    my $cc = \"$config{cross_compile_prefix}$target{cc}\";\n-\n-    # collect compiler pre-defines from gcc or gcc-alike...\n-    open(PIPE, \"$cc -dM -E -x c /dev/null 2>&1 |\");\n-    while (<PIPE>) {\n-\tm/^#define\\s+(\\w+(?:\\(\\w+\\))?)(?:\\s+(.+))?/ or last;\n-\t$predefined{$1} = $2 // \"\";\n+my %predefined = compiler_predefined($config{CROSS_COMPILE}.$config{CC});\n+\n+# Check for makedepend capabilities.\n+if (!$disabled{makedepend}) {\n+    if ($config{target} =~ /^(VC|vms)-/) {\n+        # For VC- and vms- targets, there's nothing more to do here.  The\n+        # functionality is hard coded in the corresponding build files for\n+        # cl (Windows) and CC/DECC (VMS).\n+    } elsif (($predefined{__GNUC__} // -1) >= 3\n+\t     && !($predefined{__APPLE_CC__} && !$predefined{__clang__})) {\n+        # We know that GNU C version 3 and up as well as all clang\n+        # versions support dependency generation, but Xcode did not\n+        # handle $cc -M before clang support (but claims __GNUC__ = 3)\n+        $config{makedepprog} = \"\\$(CROSS_COMPILE)$config{CC}\";\n+    } else {\n+        # In all other cases, we look for 'makedepend', and disable the\n+        # capability if not found.\n+        $config{makedepprog} = which('makedepend');\n+        $disabled{makedepend} = \"unavailable\" unless $config{makedepprog};\n     }\n-    close(PIPE);\n+}\n \n-    if (!$disabled{makedepend}) {\n-\t# We know that GNU C version 3 and up as well as all clang\n-\t# versions support dependency generation, but Xcode did not\n-\t# handle $cc -M before clang support (but claims __GNUC__ = 3)\n-\tif (($predefined{__GNUC__} // -1) >= 3\n-\t\t&& !($predefined{__APPLE_CC__} && !$predefined{__clang__})) {\n-\t    $config{makedepprog} = $cc;\n-\t} else {\n-\t    $config{makedepprog} = which('makedepend');\n-\t    $disabled{makedepend} = \"unavailable\" unless $config{makedepprog};\n-\t}\n+if (!$disabled{asm} && !$predefined{__MACH__} && $^O ne 'VMS') {\n+    # probe for -Wa,--noexecstack option...\n+    if ($predefined{__clang__}) {\n+        # clang has builtin assembler, which doesn't recognize --help,\n+        # but it apparently recognizes the option in question on all\n+        # supported platforms even when it's meaningless. In other words\n+        # probe would fail, but probed option always accepted...\n+        push @{$config{cflags}}, \"-Wa,--noexecstack\", \"-Qunused-arguments\";\n+    } else {\n+        my $cc = $config{CROSS_COMPILE}.$config{CC};\n+        open(PIPE, \"$cc -Wa,--help -c -o null.$$.o -x assembler /dev/null 2>&1 |\");\n+        while(<PIPE>) {\n+            if (m/--noexecstack/) {\n+                push @{$config{cflags}}, \"-Wa,--noexecstack\";\n+                last;\n+            }\n+        }\n+        close(PIPE);\n+        unlink(\"null.$$.o\");\n     }\n }\n \n-\n-\n # Deal with bn_ops ###################################################\n \n $config{bn_ll}\t\t\t=0;\n@@ -1260,9 +1495,12 @@ die \"Exactly one of SIXTY_FOUR_BIT|SIXTY_FOUR_BIT_LONG|THIRTY_TWO_BIT can be set\n \n # Hack cflags for better warnings (dev option) #######################\n \n-# \"Stringify\" the C flags string.  This permits it to be made part of a string\n-# and works as well on command lines.\n-$config{cflags} =~ s/([\\\\\\\"])/\\\\$1/g;\n+# \"Stringify\" the C and C++ flags string.  This permits it to be made part of\n+# a string and works as well on command lines.\n+$config{cflags} = [ map { (my $x = $_) =~ s/([\\\\\\\"])/\\\\$1/g; $x }\n+                        @{$config{cflags}} ];\n+$config{cxxflags} = [ map { (my $x = $_) =~ s/([\\\\\\\"])/\\\\$1/g; $x }\n+                          @{$config{cxxflags}} ] if $config{CXX};\n \n if (defined($config{api})) {\n     $config{openssl_api_defines} = [ \"OPENSSL_MIN_API=\".$apitable->{$config{api}} ];\n@@ -1273,17 +1511,27 @@ if (defined($config{api})) {\n if ($strict_warnings)\n \t{\n \tmy $wopt;\n-\tdie \"ERROR --strict-warnings requires gcc or gcc-alike\"\n-            unless defined($predefined{__GNUC__});\n+\tmy $gccver = $predefined{__GNUC__} // -1;\n+\n+\tdie \"ERROR --strict-warnings requires gcc[>=4] or gcc-alike\"\n+            unless $gccver >= 4;\n \tforeach $wopt (split /\\s+/, $gcc_devteam_warn)\n \t\t{\n-\t\t$config{cflags} .= \" $wopt\" unless ($config{cflags} =~ /(?:^|\\s)$wopt(?:\\s|$)/)\n+\t\tpush @{$config{cflags}}, $wopt\n+\t\t\tunless grep { $_ eq $wopt } @{$config{cflags}};\n+\t\tpush @{$config{cxxflags}}, $wopt\n+\t\t\tif ($config{CXX}\n+\t\t\t    && !grep { $_ eq $wopt } @{$config{cxxflags}});\n \t\t}\n \tif (defined($predefined{__clang__}))\n \t\t{\n \t\tforeach $wopt (split /\\s+/, $clang_devteam_warn)\n \t\t\t{\n-\t\t\t$config{cflags} .= \" $wopt\" unless ($config{cflags} =~ /(?:^|\\s)$wopt(?:\\s|$)/)\n+\t\t\tpush @{$config{cflags}}, $wopt\n+\t\t\t\tunless grep { $_ eq $wopt } @{$config{cflags}};\n+\t\t\tpush @{$config{cxxflags}}, $wopt\n+\t\t\t\tif ($config{CXX}\n+\t\t\t\t    && !grep { $_ eq $wopt } @{$config{cxxflags}});\n \t\t\t}\n \t\t}\n \t}\n@@ -1292,26 +1540,23 @@ unless ($disabled{\"crypto-mdebug-backtrace\"})\n \t{\n \tforeach my $wopt (split /\\s+/, $memleak_devteam_backtrace)\n \t\t{\n-\t\t$config{cflags} .= \" $wopt\" unless ($config{cflags} =~ /(?:^|\\s)$wopt(?:\\s|$)/)\n+\t\tpush @{$config{cflags}}, $wopt\n+\t\t\tunless grep { $_ eq $wopt } @{$config{cflags}};\n+\t\tpush @{$config{cxxflags}}, $wopt\n+\t\t\tif ($config{CXX}\n+\t\t\t    && !grep { $_ eq $wopt } @{$config{cxxflags}});\n \t\t}\n \tif ($target =~ /^BSD-/)\n \t\t{\n-\t\t$config{ex_libs} .= \" -lexecinfo\";\n+\t\tpush @{$config{ex_libs}}, \"-lexecinfo\";\n \t\t}\n \t}\n \n-if ($user_cflags ne \"\") { $config{cflags}=\"$config{cflags}$user_cflags\"; }\n-else                    { $no_user_cflags=1;  }\n-if (@user_defines) { $config{defines}=[ @{$config{defines}}, @user_defines ]; }\n-else               { $no_user_defines=1;    }\n-\n-# ALL MODIFICATIONS TO %config and %target MUST BE DONE FROM HERE ON\n-\n unless ($disabled{afalgeng}) {\n     $config{afalgeng}=\"\";\n-    if ($target =~ m/^linux/) {\n+    if (grep { $_ eq 'afalgeng' } @{$target{enable}}) {\n         my $minver = 4*10000 + 1*100 + 0;\n-        if ($config{cross_compile_prefix} eq \"\") {\n+        if ($config{CROSS_COMPILE} eq \"\") {\n             my $verstr = `uname -r`;\n             my ($ma, $mi1, $mi2) = split(\"\\\\.\", $verstr);\n             ($mi2) = $mi2 =~ /(\\d+)/;\n@@ -1331,6 +1576,22 @@ unless ($disabled{afalgeng}) {\n \n push @{$config{openssl_other_defines}}, \"OPENSSL_NO_AFALGENG\" if ($disabled{afalgeng});\n \n+# Finish up %config by appending things the user gave us on the command line\n+# apart from \"make variables\"\n+foreach (keys %useradd) {\n+    # The must all be lists, so we assert that here\n+    die \"internal error: \\$useradd{$_} isn't an ARRAY\\n\"\n+        unless ref $useradd{$_} eq 'ARRAY';\n+\n+    if (defined $config{$_}) {\n+        push @{$config{$_}}, @{$useradd{$_}};\n+    } else {\n+        $config{$_} = [ @{$useradd{$_}} ];\n+    }\n+}\n+\n+# ALL MODIFICATIONS TO %config and %target MUST BE DONE FROM HERE ON\n+\n # If we use the unified build, collect information from build.info files\n my %unified_info = ();\n \n@@ -1379,15 +1640,15 @@ if ($builder eq \"unified\") {\n     my @build_file_templates = ();\n \n     # First, look in the user provided directory, if given\n-    if (defined $ENV{$local_config_envname}) {\n+    if (defined env($local_config_envname)) {\n \t@build_file_templates =\n \t    map {\n \t\tif ($^O eq 'VMS') {\n \t\t    # VMS environment variables are logical names,\n \t\t    # which can be used as is\n \t\t    $local_config_envname . ':' . $_;\n \t\t} else {\n-\t\t    catfile($ENV{$local_config_envname}, $_);\n+\t\t    catfile(env($local_config_envname), $_);\n \t\t}\n \t    }\n \t    @build_file_template_names;\n@@ -1408,7 +1669,9 @@ if ($builder eq \"unified\") {\n \tdie \"*** Couldn't find any of:\\n\", join(\"\\n\", @build_file_templates), \"\\n\";\n     }\n     $config{build_file_templates}\n-      = [ $build_file_template,\n+      = [ cleanfile($srcdir, catfile(\"Configurations\", \"common0.tmpl\"),\n+                    $blddir),\n+          $build_file_template,\n           cleanfile($srcdir, catfile(\"Configurations\", \"common.tmpl\"),\n                     $blddir) ];\n \n@@ -1425,9 +1688,14 @@ if ($builder eq \"unified\") {\n         push @build_infos, [ catdir(\"engines\", $_), \"build.info\" ]\n             if (-f catfile($srcdir, \"engines\", $_, \"build.info\"));\n     }\n+    foreach (@{$config{tdirs}}) {\n+        push @build_infos, [ catdir(\"test\", $_), \"build.info\" ]\n+            if (-f catfile($srcdir, \"test\", $_, \"build.info\"));\n+    }\n \n     $config{build_infos} = [ ];\n \n+    my %ordinals = ();\n     foreach (@build_infos) {\n         my $sourced = catdir($srcdir, $_->[0]);\n         my $buildd = catdir($blddir, $_->[0]);\n@@ -1449,7 +1717,6 @@ if ($builder eq \"unified\") {\n         my @intermediates = ();\n         my @rawlines = ();\n \n-        my %ordinals = ();\n         my %sources = ();\n         my %shared_sources = ();\n         my %includes = ();\n@@ -1597,7 +1864,7 @@ if ($builder eq \"unified\") {\n                             || $target_kind eq $target{build_file}.\"(\".$builder_platform.\")\");\n                 }\n             },\n-            qr/^(?:#.*|\\s*)$/ => sub { },\n+            qr/^\\s*(?:#.*)?$/ => sub { },\n             \"OTHERWISE\" => sub { die \"Something wrong with this line:\\n$_\\nat $sourced/$f\" },\n             \"BEFORE\" => sub {\n                 if ($buildinfo_debug) {\n@@ -1727,33 +1994,24 @@ EOF\n             }\n \n             # Additionally, we set up sharednames for libraries that don't\n-            # have any, as themselves.\n-            foreach (keys %{$unified_info{libraries}}) {\n+            # have any, as themselves.  Only for libraries that aren't\n+            # explicitly static.\n+            foreach (grep !/\\.a$/, keys %{$unified_info{libraries}}) {\n                 if (!defined $unified_info{sharednames}->{$_}) {\n                     $unified_info{sharednames}->{$_} = $_\n                 }\n             }\n-        }\n \n-        foreach (keys %ordinals) {\n-            my $dest = $_;\n-            my $ddest = cleanfile($buildd, $_, $blddir);\n-            if ($unified_info{rename}->{$ddest}) {\n-                $ddest = $unified_info{rename}->{$ddest};\n-            }\n-            foreach (@{$ordinals{$dest}}) {\n-                my %known_ordinals =\n-                    (\n-                     crypto =>\n-                     cleanfile($sourced, catfile(\"util\", \"libcrypto.num\"), $blddir),\n-                     ssl =>\n-                     cleanfile($sourced, catfile(\"util\", \"libssl.num\"), $blddir)\n-                    );\n-                my $o = $known_ordinals{$_};\n-                die \"Ordinals for $ddest defined more than once\\n\"\n-                    if $unified_info{ordinals}->{$ddest};\n-                $unified_info{ordinals}->{$ddest} = [ $_, $o ];\n+            # Check that we haven't defined any library as both shared and\n+            # explicitly static.  That is forbidden.\n+            my @doubles = ();\n+            foreach (grep /\\.a$/, keys %{$unified_info{libraries}}) {\n+                (my $l = $_) =~ s/\\.a$//;\n+                push @doubles, $l if defined $unified_info{sharednames}->{$l};\n             }\n+            die \"these libraries are both explicitly static and shared:\\n  \",\n+                join(\" \", @doubles), \"\\n\"\n+                if @doubles;\n         }\n \n         foreach (keys %sources) {\n@@ -1770,12 +2028,21 @@ EOF\n                 if ($s eq $src_configdata || ! -f $s || $generate{$_}) {\n                     $s = cleanfile($buildd, $_, $blddir);\n                 }\n-                # We recognise C and asm files\n-                if ($s =~ /\\.[csS]\\b$/) {\n-                    (my $o = $_) =~ s/\\.[csS]\\b$/.o/;\n+                # We recognise C++, C and asm files\n+                if ($s =~ /\\.(cc|cpp|c|s|S)$/) {\n+                    my $o = $_;\n+                    $o =~ s/\\.[csS]$/.o/; # C and assembler\n+                    $o =~ s/\\.(cc|cpp)$/_cc.o/; # C++\n                     $o = cleanfile($buildd, $o, $blddir);\n                     $unified_info{sources}->{$ddest}->{$o} = 1;\n                     $unified_info{sources}->{$o}->{$s} = 1;\n+                } elsif ($s =~ /\\.rc$/) {\n+                    # We also recognise resource files\n+                    my $o = $_;\n+                    $o =~ s/\\.rc$/.res/; # Resource configuration\n+                    my $o = cleanfile($buildd, $o, $blddir);\n+                    $unified_info{sources}->{$ddest}->{$o} = 1;\n+                    $unified_info{sources}->{$o}->{$s} = 1;\n                 } else {\n                     $unified_info{sources}->{$ddest}->{$s} = 1;\n                 }\n@@ -1796,12 +2063,27 @@ EOF\n                 if ($s eq $src_configdata || ! -f $s || $generate{$_}) {\n                     $s = cleanfile($buildd, $_, $blddir);\n                 }\n-                # We recognise C and asm files\n-                if ($s =~ /\\.[csS]\\b$/) {\n-                    (my $o = $_) =~ s/\\.[csS]\\b$/.o/;\n+\n+                if ($s =~ /\\.(cc|cpp|c|s|S)$/) {\n+                    # We recognise C++, C and asm files\n+                    my $o = $_;\n+                    $o =~ s/\\.[csS]$/.o/; # C and assembler\n+                    $o =~ s/\\.(cc|cpp)$/_cc.o/; # C++\n                     $o = cleanfile($buildd, $o, $blddir);\n                     $unified_info{shared_sources}->{$ddest}->{$o} = 1;\n                     $unified_info{sources}->{$o}->{$s} = 1;\n+                } elsif ($s =~ /\\.rc$/) {\n+                    # We also recognise resource files\n+                    my $o = $_;\n+                    $o =~ s/\\.rc$/.res/; # Resource configuration\n+                    my $o = cleanfile($buildd, $o, $blddir);\n+                    $unified_info{shared_sources}->{$ddest}->{$o} = 1;\n+                    $unified_info{sources}->{$o}->{$s} = 1;\n+                } elsif ($s =~ /\\.(def|map|opt)$/) {\n+                    # We also recognise .def / .map / .opt files\n+                    # We know they are generated files\n+                    my $def = cleanfile($buildd, $s, $blddir);\n+                    $unified_info{shared_sources}->{$ddest}->{$def} = 1;\n                 } else {\n                     die \"unrecognised source file type for shared library: $s\\n\";\n                 }\n@@ -1850,9 +2132,16 @@ EOF\n                     $d = cleanfile($buildd, $_, $blddir);\n                 }\n                 # Take note if the file to depend on is being renamed\n+                # Take extra care with files ending with .a, they should\n+                # be treated without that extension, and the extension\n+                # should be added back after treatment.\n+                $d =~ /(\\.a)?$/;\n+                my $e = $1 // \"\";\n+                $d = $`;\n                 if ($unified_info{rename}->{$d}) {\n                     $d = $unified_info{rename}->{$d};\n                 }\n+                $d .= $e;\n                 $unified_info{depends}->{$ddest}->{$d} = 1;\n             }\n         }\n@@ -1880,8 +2169,26 @@ EOF\n         }\n     }\n \n+    my $ordinals_text = join(', ', sort keys %ordinals);\n+    warn <<\"EOF\" if $ordinals_text;\n+\n+WARNING: ORDINALS were specified for $ordinals_text\n+They are ignored and should be replaced with a combination of GENERATE,\n+DEPEND and SHARED_SOURCE.\n+EOF\n+\n     # Massage the result\n \n+    # If the user configured no-shared, we allow no shared sources\n+    if ($disabled{shared}) {\n+        foreach (keys %{$unified_info{shared_sources}}) {\n+            foreach (keys %{$unified_info{shared_sources}->{$_}}) {\n+                delete $unified_info{sources}->{$_};\n+            }\n+        }\n+        $unified_info{shared_sources} = {};\n+    }\n+\n     # If we depend on a header file or a perl module, add an inclusion of\n     # its directory to allow smoothe inclusion\n     foreach my $dest (keys %{$unified_info{depends}}) {\n@@ -1946,20 +2253,61 @@ EOF\n                 [ @{$unified_info{includes}->{$dest}->{source}} ];\n         }\n     }\n+\n+    # For convenience collect information regarding directories where\n+    # files are generated, those generated files and the end product\n+    # they end up in where applicable.  Then, add build rules for those\n+    # directories\n+    my %loopinfo = ( \"lib\" => [ @{$unified_info{libraries}} ],\n+                     \"dso\" => [ @{$unified_info{engines}} ],\n+                     \"bin\" => [ @{$unified_info{programs}} ],\n+                     \"script\" => [ @{$unified_info{scripts}} ] );\n+    foreach my $type (keys %loopinfo) {\n+        foreach my $product (@{$loopinfo{$type}}) {\n+            my %dirs = ();\n+            my $pd = dirname($product);\n+\n+            foreach (@{$unified_info{sources}->{$product} // []},\n+                     @{$unified_info{shared_sources}->{$product} // []}) {\n+                my $d = dirname($_);\n+\n+                # We don't want to create targets for source directories\n+                # when building out of source\n+                next if ($config{sourcedir} ne $config{builddir}\n+                             && $d =~ m|^\\Q$config{sourcedir}\\E|);\n+                # We already have a \"test\" target, and the current directory\n+                # is just silly to make a target for\n+                next if $d eq \"test\" || $d eq \".\";\n+\n+                $dirs{$d} = 1;\n+                push @{$unified_info{dirinfo}->{$d}->{deps}}, $_\n+                    if $d ne $pd;\n+            }\n+            foreach (keys %dirs) {\n+                push @{$unified_info{dirinfo}->{$_}->{products}->{$type}},\n+                    $product;\n+            }\n+        }\n+    }\n }\n \n # For the schemes that need it, we provide the old *_obj configs\n # from the *_asm_obj ones\n foreach (grep /_(asm|aux)_src$/, keys %target) {\n     my $src = $_;\n     (my $obj = $_) =~ s/_(asm|aux)_src$/_obj/;\n-    ($target{$obj} = $target{$src}) =~ s/\\.[csS]\\b/.o/g;\n+    $target{$obj} = $target{$src};\n+    $target{$obj} =~ s/\\.[csS]\\b/.o/g; # C and assembler\n+    $target{$obj} =~ s/\\.(cc|cpp)\\b/_cc.o/g; # C++\n }\n \n # Write down our configuration where it fits #########################\n \n+print \"Creating configdata.pm\\n\";\n open(OUT,\">configdata.pm\") || die \"unable to create configdata.pm: $!\\n\";\n print OUT <<\"EOF\";\n+#! $config{HASHBANGPERL}\n+\n package configdata;\n \n use strict;\n@@ -1977,6 +2325,22 @@ foreach (sort keys %config) {\n \tprint OUT \"  \", $_, \" => [ \", join(\", \",\n \t\t\t\t\t   map { quotify(\"perl\", $_) }\n \t\t\t\t\t   @{$config{$_}}), \" ],\\n\";\n+    } elsif (ref($config{$_}) eq \"HASH\") {\n+\tprint OUT \"  \", $_, \" => {\";\n+        if (scalar keys %{$config{$_}} > 0) {\n+            print OUT \"\\n\";\n+            foreach my $key (sort keys %{$config{$_}}) {\n+                print OUT \"      \",\n+                    join(\" => \",\n+                         quotify(\"perl\", $key),\n+                         defined $config{$_}->{$key}\n+                             ? quotify(\"perl\", $config{$_}->{$key})\n+                             : \"undef\");\n+                print OUT \",\\n\";\n+            }\n+            print OUT \"  \";\n+        }\n+        print OUT \"},\\n\";\n     } else {\n \tprint OUT \"  \", $_, \" => \", quotify(\"perl\", $config{$_}), \",\\n\"\n     }\n@@ -2078,52 +2442,298 @@ if ($builder eq \"unified\") {\n \n EOF\n }\n-print OUT \"1;\\n\";\n-close(OUT);\n+print OUT\n+    \"# The following data is only used when this files is use as a script\\n\";\n+print OUT \"my \\@makevars = (\\n\";\n+foreach (sort keys %user) {\n+    print OUT \"    '\",$_,\"',\\n\";\n+}\n+print OUT \");\\n\";\n+print OUT \"my \\%disabled_info = (\\n\";\n+foreach my $what (sort keys %disabled_info) {\n+    print OUT \"    '$what' => {\\n\";\n+    foreach my $info (sort keys %{$disabled_info{$what}}) {\n+        if (ref $disabled_info{$what}->{$info} eq 'ARRAY') {\n+            print OUT \"        $info => [ \",\n+                join(', ', map { \"'$_'\" } @{$disabled_info{$what}->{$info}}),\n+                \" ],\\n\";\n+        } else {\n+            print OUT \"        $info => '\", $disabled_info{$what}->{$info},\n+                \"',\\n\";\n+        }\n+    }\n+    print OUT \"    },\\n\";\n+}\n+print OUT \");\\n\";\n+print OUT 'my @user_crossable = qw( ', join (' ', @user_crossable), \" );\\n\";\n+print OUT << 'EOF';\n+# If run directly, we can give some answers, and even reconfigure\n+unless (caller) {\n+    use Getopt::Long;\n+    use File::Spec::Functions;\n+    use File::Basename;\n+    use Pod::Usage;\n+\n+    my $here = dirname($0);\n+\n+    my $dump = undef;\n+    my $cmdline = undef;\n+    my $options = undef;\n+    my $target = undef;\n+    my $envvars = undef;\n+    my $makevars = undef;\n+    my $buildparams = undef;\n+    my $reconf = undef;\n+    my $verbose = undef;\n+    my $help = undef;\n+    my $man = undef;\n+    GetOptions('dump|d'                 => \\$dump,\n+               'command-line|c'         => \\$cmdline,\n+               'options|o'              => \\$options,\n+               'target|t'               => \\$target,\n+               'environment|e'          => \\$envvars,\n+               'make-variables|m'       => \\$makevars,\n+               'build-parameters|b'     => \\$buildparams,\n+               'reconfigure|reconf|r'   => \\$reconf,\n+               'verbose|v'              => \\$verbose,\n+               'help'                   => \\$help,\n+               'man'                    => \\$man)\n+        or die \"Errors in command line arguments\\n\";\n+\n+    unless ($dump || $cmdline || $options || $target || $envvars || $makevars\n+            || $buildparams || $reconf || $verbose || $help || $man) {\n+        print STDERR <<\"_____\";\n+You must give at least one option.\n+For more information, do '$0 --help'\n+_____\n+        exit(2);\n+    }\n+\n+    if ($help) {\n+        pod2usage(-exitval => 0,\n+                  -verbose => 1);\n+    }\n+    if ($man) {\n+        pod2usage(-exitval => 0,\n+                  -verbose => 2);\n+    }\n+    if ($dump || $cmdline) {\n+        print \"\\nCommand line (with current working directory = $here):\\n\\n\";\n+        print '    ',join(' ',\n+                          $config{PERL},\n+                          catfile($config{sourcedir}, 'Configure'),\n+                          @{$config{perlargv}}), \"\\n\";\n+        print \"\\nPerl information:\\n\\n\";\n+        print '    ',$config{perl_cmd},\"\\n\";\n+        print '    ',$config{perl_version},' for ',$config{perl_archname},\"\\n\";\n+    }\n+    if ($dump || $options) {\n+        my $longest = 0;\n+        my $longest2 = 0;\n+        foreach my $what (@disablables) {\n+            $longest = length($what) if $longest < length($what);\n+            $longest2 = length($disabled{$what})\n+                if $disabled{$what} && $longest2 < length($disabled{$what});\n+        }\n+        print \"\\nEnabled features:\\n\\n\";\n+        foreach my $what (@disablables) {\n+            print \"    $what\\n\" unless $disabled{$what};\n+        }\n+        print \"\\nDisabled features:\\n\\n\";\n+        foreach my $what (@disablables) {\n+            if ($disabled{$what}) {\n+                print \"    $what\", ' ' x ($longest - length($what) + 1),\n+                    \"[$disabled{$what}]\", ' ' x ($longest2 - length($disabled{$what}) + 1);\n+                print $disabled_info{$what}->{macro}\n+                    if $disabled_info{$what}->{macro};\n+                print ' (skip ',\n+                    join(', ', @{$disabled_info{$what}->{skipped}}),\n+                    ')'\n+                    if $disabled_info{$what}->{skipped};\n+                print \"\\n\";\n+            }\n+        }\n+    }\n+    if ($dump || $target) {\n+        print \"\\nConfig target attributes:\\n\\n\";\n+        foreach (sort keys %target) {\n+            next if $_ =~ m|^_| || $_ eq 'template';\n+            my $quotify = sub {\n+                map { (my $x = $_) =~ s|([\\\\\\$\\@\"])|\\\\$1|g; \"\\\"$x\\\"\"} @_;\n+            };\n+            print '    ', $_, ' => ';\n+            if (ref($target{$_}) eq \"ARRAY\") {\n+                print '[ ', join(', ', $quotify->(@{$target{$_}})), \" ],\\n\";\n+            } else {\n+                print $quotify->($target{$_}), \",\\n\"\n+            }\n+        }\n+    }\n+    if ($dump || $envvars) {\n+        print \"\\nRecorded environment:\\n\\n\";\n+        foreach (sort keys %{$config{perlenv}}) {\n+            print '    ',$_,' = ',($config{perlenv}->{$_} || ''),\"\\n\";\n+        }\n+    }\n+    if ($dump || $makevars) {\n+        print \"\\nMakevars:\\n\\n\";\n+        foreach my $var (@makevars) {\n+            my $prefix = '';\n+            $prefix = $config{CROSS_COMPILE}\n+                if grep { $var eq $_ } @user_crossable;\n+            $prefix //= '';\n+            print '    ',$var,' ' x (16 - length $var),'= ',\n+                (ref $config{$var} eq 'ARRAY'\n+                 ? join(' ', @{$config{$var}})\n+                 : $prefix.$config{$var}),\n+                \"\\n\"\n+                if defined $config{$var};\n+        }\n+\n+        my @buildfile = ($config{builddir}, $config{build_file});\n+        unshift @buildfile, $here\n+            unless file_name_is_absolute($config{builddir});\n+        my $buildfile = canonpath(catdir(@buildfile));\n+        print <<\"_____\";\n+\n+NOTE: These variables only represent the configuration view.  The build file\n+template may have processed these variables further, please have a look at the\n+build file for more exact data:\n+    $buildfile\n+_____\n+    }\n+    if ($dump || $buildparams) {\n+        my @buildfile = ($config{builddir}, $config{build_file});\n+        unshift @buildfile, $here\n+            unless file_name_is_absolute($config{builddir});\n+        print \"\\nbuild file:\\n\\n\";\n+        print \"    \", canonpath(catfile(@buildfile)),\"\\n\";\n+\n+        print \"\\nbuild file templates:\\n\\n\";\n+        foreach (@{$config{build_file_templates}}) {\n+            my @tmpl = ($_);\n+            unshift @tmpl, $here\n+                unless file_name_is_absolute($config{sourcedir});\n+            print '    ',canonpath(catfile(@tmpl)),\"\\n\";\n+        }\n+    }\n+    if ($reconf) {\n+        if ($verbose) {\n+            print 'Reconfiguring with: ', join(' ',@{$config{perlargv}}), \"\\n\";\n+\t    foreach (sort keys %{$config{perlenv}}) {\n+\t        print '    ',$_,' = ',($config{perlenv}->{$_} || \"\"),\"\\n\";\n+\t    }\n+        }\n+\n+        chdir $here;\n+        exec $^X,catfile($config{sourcedir}, 'Configure'),'reconf';\n+    }\n+}\n+\n+1;\n+\n+__END__\n+\n+=head1 NAME\n+\n+configdata.pm - configuration data for OpenSSL builds\n+\n+=head1 SYNOPSIS\n+\n+Interactive:\n+\n+  perl configdata.pm [options]\n+\n+As data bank module:\n+\n+  use configdata;\n \n+=head1 DESCRIPTION\n \n-print \"CC            =$config{cross_compile_prefix}$target{cc}\\n\";\n-print \"CFLAG         =$target{cflags} $config{cflags}\\n\";\n-print \"SHARED_CFLAG  =$target{shared_cflag}\\n\";\n-print \"DEFINES       =\",join(\" \", @{$target{defines}}, @{$config{defines}}),\"\\n\";\n-print \"LFLAG         =$target{lflags}\\n\";\n-print \"PLIB_LFLAG    =$target{plib_lflags}\\n\";\n-print \"EX_LIBS       =$target{ex_libs} $config{ex_libs}\\n\";\n-print \"APPS_OBJ      =$target{apps_obj}\\n\";\n-print \"CPUID_OBJ     =$target{cpuid_obj}\\n\";\n-print \"UPLINK_OBJ    =$target{uplink_obj}\\n\";\n-print \"BN_ASM        =$target{bn_obj}\\n\";\n-print \"EC_ASM        =$target{ec_obj}\\n\";\n-print \"DES_ENC       =$target{des_obj}\\n\";\n-print \"AES_ENC       =$target{aes_obj}\\n\";\n-print \"BF_ENC        =$target{bf_obj}\\n\";\n-print \"CAST_ENC      =$target{cast_obj}\\n\";\n-print \"RC4_ENC       =$target{rc4_obj}\\n\";\n-print \"RC5_ENC       =$target{rc5_obj}\\n\";\n-print \"MD5_OBJ_ASM   =$target{md5_obj}\\n\";\n-print \"SHA1_OBJ_ASM  =$target{sha1_obj}\\n\";\n-print \"RMD160_OBJ_ASM=$target{rmd160_obj}\\n\";\n-print \"CMLL_ENC      =$target{cmll_obj}\\n\";\n-print \"MODES_OBJ     =$target{modes_obj}\\n\";\n-print \"PADLOCK_OBJ   =$target{padlock_obj}\\n\";\n-print \"CHACHA_ENC    =$target{chacha_obj}\\n\";\n-print \"POLY1305_OBJ  =$target{poly1305_obj}\\n\";\n-print \"BLAKE2_OBJ    =$target{blake2_obj}\\n\";\n-print \"PROCESSOR     =$config{processor}\\n\";\n-print \"RANLIB        =\", $target{ranlib} eq '$(CROSS_COMPILE)ranlib' ?\n-                             \"$config{cross_compile_prefix}ranlib\" :\n-                             \"$target{ranlib}\", \"\\n\";\n-print \"ARFLAGS       =$target{arflags}\\n\";\n-print \"PERL          =$config{perl}\\n\";\n-print \"\\n\";\n-print \"SIXTY_FOUR_BIT_LONG mode\\n\" if $config{b64l};\n-print \"SIXTY_FOUR_BIT mode\\n\" if $config{b64};\n-print \"THIRTY_TWO_BIT mode\\n\" if $config{b32};\n-print \"BN_LLONG mode\\n\" if $config{bn_ll};\n-print \"RC4 uses $config{rc4_int}\\n\" if $config{rc4_int} ne $def_int;\n+This module can be used in two modes, interactively and as a module containing\n+all the data recorded by OpenSSL's Configure script.\n+\n+When used interactively, simply run it as any perl script, with at least one\n+option, and you will get the information you ask for.  See L</OPTIONS> below.\n+\n+When loaded as a module, you get a few databanks with useful information to\n+perform build related tasks.  The databanks are:\n+\n+    %config             Configured things.\n+    %target             The OpenSSL config target with all inheritances\n+                        resolved.\n+    %disabled           The features that are disabled.\n+    @disablables        The list of features that can be disabled.\n+    %withargs           All data given through --with-THING options.\n+    %unified_info       All information that was computed from the build.info\n+                        files.\n+\n+=head1 OPTIONS\n+\n+=over 4\n+\n+=item B<--help>\n+\n+Print a brief help message and exit.\n+\n+=item B<--man>\n+\n+Print the manual page and exit.\n+\n+=item B<--dump> | B<-d>\n+\n+Print all relevant configuration data.  This is equivalent to B<--command-line>\n+B<--options> B<--target> B<--environment> B<--make-variables>\n+B<--build-parameters>.\n+\n+=item B<--command-line> | B<-c>\n+\n+Print the current configuration command line.\n+\n+=item B<--options> | B<-o>\n+\n+Print the features, both enabled and disabled, and display defined macro and\n+skipped directories where applicable.\n+\n+=item B<--target> | B<-t>\n+\n+Print the config attributes for this config target.\n+\n+=item B<--environment> | B<-e>\n+\n+Print the environment variables and their values at the time of configuration.\n+\n+=item B<--make-variables> | B<-m>\n+\n+Print the main make variables generated in the current configuration\n+\n+=item B<--build-parameters> | B<-b>\n+\n+Print the build parameters, i.e. build file and build file templates.\n+\n+=item B<--reconfigure> | B<--reconf> | B<-r>\n+\n+Redo the configuration.\n+\n+=item B<--verbose> | B<-v>\n+\n+Verbose output.\n+\n+=back\n+\n+=cut\n+\n+EOF\n+close(OUT);\n+if ($builder_platform eq 'unix') {\n+    my $mode = (0755 & ~umask);\n+    chmod $mode, 'configdata.pm'\n+        or warn sprintf(\"WARNING: Couldn't change mode for 'configdata.pm' to 0%03o: %s\\n\",$mode,$!);\n+}\n \n my %builders = (\n     unified => sub {\n+        print 'Creating ',$target{build_file},\"\\n\";\n         run_dofile(catfile($blddir, $target{build_file}),\n                    @{$config{build_file_templates}});\n     },\n@@ -2133,11 +2743,6 @@ $builders{$builder}->($builder_platform, @builder_opts);\n \n $SIG{__DIE__} = $orig_death_handler;\n \n-print <<\"EOF\";\n-\n-Configured for $target.\n-EOF\n-\n print <<\"EOF\" if ($disabled{threads} eq \"unavailable\");\n \n The library could not be configured for supporting multi-threaded\n@@ -2154,6 +2759,24 @@ or position independent code, please let us know (but please first make sure\n you have tried with a current version of OpenSSL).\n EOF\n \n+print <<\"EOF\";\n+\n+**********************************************************************\n+***                                                                ***\n+***   OpenSSL has been successfully configured                     ***\n+***                                                                ***\n+***   If you encounter a problem while building, please open an    ***\n+***   issue on GitHub <https://github.com/openssl/openssl/issues>  ***\n+***   and include the output from the following command:           ***\n+***                                                                ***\n+***       perl configdata.pm --dump                                ***\n+***                                                                ***\n+***   (If you are new to OpenSSL, you might want to consult the    ***\n+***   'Troubleshooting' section in the INSTALL file first)         ***\n+***                                                                ***\n+**********************************************************************\n+EOF\n+\n exit(0);\n \n ######################################################################\n@@ -2243,7 +2866,10 @@ sub threads {\n     return sub { add($disabled{threads} ? () : @flags)->(); }\n }\n \n-\n+sub shared {\n+    my @flags = @_;\n+    return sub { add($disabled{shared} ? () : @flags)->(); }\n+}\n \n our $add_called = 0;\n # Helper function to implement adding values to already existing configuration\n@@ -2301,25 +2927,38 @@ sub add {\n     sub { _add($separator, @_, @x) };\n }\n \n+sub read_eval_file {\n+    my $fname = shift;\n+    my $content;\n+    my @result;\n+\n+    open F, \"< $fname\" or die \"Can't open '$fname': $!\\n\";\n+    {\n+        undef local $/;\n+        $content = <F>;\n+    }\n+    close F;\n+    {\n+        local $@;\n+\n+        @result = ( eval $content );\n+        warn $@ if $@;\n+    }\n+    return wantarray ? @result : $result[0];\n+}\n+\n # configuration reader, evaluates the input file as a perl script and expects\n # it to fill %targets with target configurations.  Those are then added to\n # %table.\n sub read_config {\n     my $fname = shift;\n-    open(CONFFILE, \"< $fname\")\n-\tor die \"Can't open configuration file '$fname'!\\n\";\n-    my $x = $/;\n-    undef $/;\n-    my $content = <CONFFILE>;\n-    $/ = $x;\n-    close(CONFFILE);\n-    my %targets = ();\n+    my %targets;\n+\n     {\n \t# Protect certain tables from tampering\n-\tlocal %table = %::table;\n+\tlocal %table = ();\n \n-\teval $content;\n-\twarn $@ if $@;\n+\t%targets = read_eval_file($fname);\n     }\n     my %preexisting = ();\n     foreach (sort keys %targets) {\n@@ -2513,14 +3152,39 @@ sub run_dofile\n     foreach (@templates) {\n         die \"Can't open $_, $!\" unless -f $_;\n     }\n-    my $perlcmd = (quotify(\"maybeshell\", $config{perl}))[0];\n+    my $perlcmd = (quotify(\"maybeshell\", $config{PERL}))[0];\n     my $cmd = \"$perlcmd \\\"-I.\\\" \\\"-Mconfigdata\\\" \\\"$dofile\\\" -o\\\"Configure\\\" \\\"\".join(\"\\\" \\\"\",@templates).\"\\\" > \\\"$out.new\\\"\";\n     #print STDERR \"DEBUG[run_dofile]: \\$cmd = $cmd\\n\";\n     system($cmd);\n     exit 1 if $? != 0;\n     rename(\"$out.new\", $out) || die \"Can't rename $out.new, $!\";\n }\n \n+sub compiler_predefined {\n+    state %predefined;\n+    my $cc = shift;\n+\n+    return () if $^O eq 'VMS';\n+\n+    die 'compiler_predefined called without a compiler command'\n+        unless $cc;\n+\n+    if (! $predefined{$cc}) {\n+\n+        $predefined{$cc} = {};\n+\n+        # collect compiler pre-defines from gcc or gcc-alike...\n+        open(PIPE, \"$cc -dM -E -x c /dev/null 2>&1 |\");\n+        while (my $l = <PIPE>) {\n+            $l =~ m/^#define\\s+(\\w+(?:\\(\\w+\\))?)(?:\\s+(.+))?/ or last;\n+            $predefined{$cc}->{$1} = $2 // '';\n+        }\n+        close(PIPE);\n+    }\n+\n+    return %{$predefined{$cc}};\n+}\n+\n sub which\n {\n     my ($name)=@_;\n@@ -2542,27 +3206,45 @@ sub which\n     }\n }\n \n+sub env\n+{\n+    my $name = shift;\n+    my %opts = @_;\n+\n+    unless ($opts{cacheonly}) {\n+        # Note that if $ENV{$name} doesn't exist or is undefined,\n+        # $config{perlenv}->{$name} will be created with the value\n+        # undef.  This is intentional.\n+\n+        $config{perlenv}->{$name} = $ENV{$name}\n+            if ! exists $config{perlenv}->{$name};\n+    }\n+    return $config{perlenv}->{$name};\n+}\n+\n # Configuration printer ##############################################\n \n sub print_table_entry\n {\n-    my $target = shift;\n-    my %target = resolve_config($target);\n+    local $now_printing = shift;\n+    my %target = resolve_config($now_printing);\n     my $type = shift;\n \n     # Don't print the templates\n     return if $target{template};\n \n     my @sequence = (\n \t\"sys_id\",\n+\t\"cpp\",\n+\t\"cppflags\",\n+\t\"defines\",\n+\t\"includes\",\n \t\"cc\",\n \t\"cflags\",\n-\t\"defines\",\n \t\"unistd\",\n \t\"ld\",\n \t\"lflags\",\n \t\"loutflag\",\n-\t\"plib_lflags\",\n \t\"ex_libs\",\n \t\"bn_ops\",\n \t\"apps_aux_src\",\n@@ -2614,7 +3296,7 @@ sub print_table_entry\n \n     if ($type eq \"TABLE\") {\n \tprint \"\\n\";\n-\tprint \"*** $target\\n\";\n+\tprint \"*** $now_printing\\n\";\n         foreach (@sequence) {\n             if (ref($target{$_}) eq \"ARRAY\") {\n                 printf \"\\$%-12s = %s\\n\", $_, join(\" \", @{$target{$_}});\n@@ -2625,7 +3307,7 @@ sub print_table_entry\n     } elsif ($type eq \"HASH\") {\n \tmy $largest =\n \t    length((sort { length($a) <=> length($b) } @sequence)[-1]);\n-\tprint \"    '$target' => {\\n\";\n+\tprint \"    '$now_printing' => {\\n\";\n \tforeach (@sequence) {\n \t    if ($target{$_}) {\n                 if (ref($target{$_}) eq \"ARRAY\") {"
        },
        {
            "sha": "4ce6651b6b3422a549bbb0939f6e1725100fa4c6",
            "filename": "deps/openssl/openssl/INSTALL",
            "status": "modified",
            "additions": 299,
            "deletions": 47,
            "changes": 346,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FINSTALL",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FINSTALL",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FINSTALL?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,4 +1,3 @@\n-\n  OPENSSL INSTALLATION\n  --------------------\n \n@@ -23,6 +22,7 @@\n   * NOTES.VMS (OpenVMS)\n   * NOTES.WIN (any supported Windows)\n   * NOTES.DJGPP (DOS platform with DJGPP)\n+  * NOTES.ANDROID (obviously Android [NDK])\n \n  Notational conventions in this document\n  ---------------------------------------\n@@ -145,8 +145,8 @@\n                    put together one-size-fits-all instructions. You might\n                    have to pass more flags or set up environment variables\n                    to actually make it work. Android and iOS cases are\n-                   discussed in corresponding Configurations/10-main.cf\n-                   sections. But there are cases when this option alone is\n+                   discussed in corresponding Configurations/15-*.conf\n+                   files. But there are cases when this option alone is\n                    sufficient. For example to build the mingw64 target on\n                    Linux \"--cross-compile-prefix=x86_64-w64-mingw32-\"\n                    works. Naturally provided that mingw packages are\n@@ -157,10 +157,12 @@\n                    \"--cross-compile-prefix=mipsel-linux-gnu-\" suffices\n                    in such case. Needless to mention that you have to\n                    invoke ./Configure, not ./config, and pass your target\n-                   name explicitly.\n+                   name explicitly. Also, note that --openssldir refers\n+                   to target's file system, not one you are building on.\n \n   --debug\n-                   Build OpenSSL with debugging symbols.\n+                   Build OpenSSL with debugging symbols and zero optimization\n+                   level.\n \n   --libdir=DIR\n                    The name of the directory under the top of the installation\n@@ -209,12 +211,41 @@\n                    without a path). This flag must be provided if the\n                    zlib-dynamic option is not also used. If zlib-dynamic is used\n                    then this flag is optional and a default value (\"ZLIB1\") is\n-                   used if not provided. \n+                   used if not provided.\n                    On VMS: this is the filename of the zlib library (with or\n                    without a path). This flag is optional and if not provided\n                    then \"GNV$LIBZSHR\", \"GNV$LIBZSHR32\" or \"GNV$LIBZSHR64\" is\n                    used by default depending on the pointer size chosen.\n \n+\n+  --with-rand-seed=seed1[,seed2,...]\n+                   A comma separated list of seeding methods which will be tried\n+                   by OpenSSL in order to obtain random input (a.k.a \"entropy\")\n+                   for seeding its cryptographically secure random number\n+                   generator (CSPRNG). The current seeding methods are:\n+\n+                   os:         Use a trusted operating system entropy source.\n+                               This is the default method if such an entropy\n+                               source exists.\n+                   getrandom:  Use the L<getrandom(2)> or equivalent system\n+                               call.\n+                   devrandom:  Use the the first device from the DEVRANDOM list\n+                               which can be opened to read random bytes. The\n+                               DEVRANDOM preprocessor constant expands to\n+                               \"/dev/urandom\",\"/dev/random\",\"/dev/srandom\" on\n+                               most unix-ish operating systems.\n+                   egd:        Check for an entropy generating daemon.\n+                   rdcpu:      Use the RDSEED or RDRAND command if provided by\n+                               the CPU.\n+                   librandom:  Use librandom (not implemented yet).\n+                   none:       Disable automatic seeding. This is the default\n+                               on some operating systems where no suitable\n+                               entropy source exists, or no support for it is\n+                               implemented yet.\n+\n+                   For more information, see the section 'Note on random number\n+                   generation' at the end of this document.\n+\n   no-afalgeng\n                    Don't build the AFALG engine. This option will be forced if\n                    on a platform that does not support AFALG.\n@@ -227,8 +258,10 @@\n                    no-shared option.\n \n   no-asm\n-                   Do not use assembler code. On some platforms a small amount\n-                   of assembler code may still be used.\n+                   Do not use assembler code. This should be viewed as\n+                   debugging/trouble-shooting option rather than production.\n+                   On some platforms a small amount of assembler code may\n+                   still be used even with this option.\n \n   no-async\n                    Do not build support for async operations.\n@@ -249,6 +282,10 @@\n                    error strings. For a statically linked application this may\n                    be undesirable if small executable size is an objective.\n \n+  no-autoload-config\n+                   Don't automatically load the default openssl.cnf file.\n+                   Typically OpenSSL will automatically load a system config\n+                   file which configures default ssl options.\n \n   no-capieng\n                    Don't build the CAPI engine. This option will be forced if\n@@ -304,8 +341,13 @@\n \n   enable-ec_nistp_64_gcc_128\n                    Enable support for optimised implementations of some commonly\n-                   used NIST elliptic curves. This is only supported on some\n-                   platforms.\n+                   used NIST elliptic curves.\n+                   This is only supported on platforms:\n+                   - with little-endian storage of non-byte types\n+                   - that tolerate misaligned memory references\n+                   - where the compiler:\n+                     - supports the non-standard type __uint128_t\n+                     - defines the built-in macro __SIZEOF_INT128__\n \n   enable-egd\n                    Build support for gathering entropy from EGD (Entropy\n@@ -317,6 +359,13 @@\n   no-err\n                    Don't compile in any error strings.\n \n+  enable-external-tests\n+                   Enable building of integration with external test suites.\n+                   This is a developer option and may not work on all platforms.\n+                   The only supported external test suite at the current time is\n+                   the BoringSSL test suite. See the file test/README.external\n+                   for further details.\n+\n   no-filenames\n                    Don't compile in filename and line number information (e.g.\n                    for errors and memory allocation).\n@@ -333,9 +382,6 @@\n                    available if the GOST algorithms are also available through\n                    loading an externally supplied engine.\n \n-  enable-heartbeats\n-                   Build support for DTLS heartbeats.\n-\n   no-hw-padlock\n                    Don't build the padlock engine.\n \n@@ -416,6 +462,9 @@\n                    the OpenSSL tests also use the command line applications the\n                    tests will also be skipped.\n \n+  no-tests\n+                   Don't build test programs or run any test.\n+\n   no-threads\n                    Don't try to build with support for multi-threaded\n                    applications.\n@@ -468,32 +517,37 @@\n \n   no-<prot>\n                    Don't build support for negotiating the specified SSL/TLS\n-                   protocol (one of ssl, ssl3, tls, tls1, tls1_1, tls1_2, dtls,\n-                   dtls1 or dtls1_2). If \"no-tls\" is selected then all of tls1,\n-                   tls1_1 and tls1_2 are disabled. Similarly \"no-dtls\" will\n-                   disable dtls1 and dtls1_2. The \"no-ssl\" option is synonymous\n-                   with \"no-ssl3\". Note this only affects version negotiation.\n-                   OpenSSL will still provide the methods for applications to\n-                   explicitly select the individual protocol versions.\n+                   protocol (one of ssl, ssl3, tls, tls1, tls1_1, tls1_2,\n+                   tls1_3, dtls, dtls1 or dtls1_2). If \"no-tls\" is selected then\n+                   all of tls1, tls1_1, tls1_2 and tls1_3 are disabled.\n+                   Similarly \"no-dtls\" will disable dtls1 and dtls1_2. The\n+                   \"no-ssl\" option is synonymous with \"no-ssl3\". Note this only\n+                   affects version negotiation. OpenSSL will still provide the\n+                   methods for applications to explicitly select the individual\n+                   protocol versions.\n \n   no-<prot>-method\n                    As for no-<prot> but in addition do not build the methods for\n                    applications to explicitly select individual protocol\n-                   versions.\n+                   versions. Note that there is no \"no-tls1_3-method\" option\n+                   because there is no application method for TLSv1.3. Using\n+                   individual protocol methods directly is deprecated.\n+                   Applications should use TLS_method() instead.\n \n   enable-<alg>\n                    Build with support for the specified algorithm, where <alg>\n                    is one of: md2 or rc5.\n \n   no-<alg>\n                    Build without support for the specified algorithm, where\n-                   <alg> is one of: bf, blake2, camellia, cast, chacha, cmac,\n-                   des, dh, dsa, ecdh, ecdsa, idea, md4, mdc2, ocb, poly1305,\n-                   rc2, rc4, rmd160, scrypt, seed or whirlpool. The \"ripemd\"\n-                   algorithm is deprecated and if used is synonymous with rmd160.\n-\n-  -Dxxx, lxxx, -Lxxx, -Wl, -rpath, -R, -framework, -static\n-                   These system specific options will be recocognised and\n+                   <alg> is one of: aria, bf, blake2, camellia, cast, chacha,\n+                   cmac, des, dh, dsa, ecdh, ecdsa, idea, md4, mdc2, ocb,\n+                   poly1305, rc2, rc4, rmd160, scrypt, seed, siphash, sm2, sm3,\n+                   sm4 or whirlpool.  The \"ripemd\" algorithm is deprecated and\n+                   if used is synonymous with rmd160.\n+\n+  -Dxxx, -Ixxx, -Wp, -lxxx, -Lxxx, -Wl, -rpath, -R, -framework, -static\n+                   These system specific options will be recognised and\n                    passed through to the compiler to allow you to define\n                    preprocessor symbols, specify additional libraries, library\n                    directories or other compiler options. It might be worth\n@@ -503,11 +557,123 @@\n                    unsuitable for execution on other, typically older,\n                    processor. Consult your compiler documentation.\n \n+                   Take note of the VAR=value documentation below and how\n+                   these flags interact with those variables.\n+\n   -xxx, +xxx\n                    Additional options that are not otherwise recognised are\n                    passed through as they are to the compiler as well.  Again,\n                    consult your compiler documentation.\n \n+                   Take note of the VAR=value documentation below and how\n+                   these flags interact with those variables.\n+\n+  VAR=value\n+                   Assignment of environment variable for Configure.  These\n+                   work just like normal environment variable assignments,\n+                   but are supported on all platforms and are confined to\n+                   the configuration scripts only.  These assignments override\n+                   the corresponding value in the inherited environment, if\n+                   there is one.\n+\n+                   The following variables are used as \"make variables\" and\n+                   can be used as an alternative to giving preprocessor,\n+                   compiler and linker options directly as configuration.\n+                   The following variables are supported:\n+\n+                   AR              The static library archiver.\n+                   ARFLAGS         Flags for the static library archiver.\n+                   AS              The assembler compiler.\n+                   ASFLAGS         Flags for the assembler compiler.\n+                   CC              The C compiler.\n+                   CFLAGS          Flags for the C compiler.\n+                   CXX             The C++ compiler.\n+                   CXXFLAGS        Flags for the C++ compiler.\n+                   CPP             The C/C++ preprocessor.\n+                   CPPFLAGS        Flags for the C/C++ preprocessor.\n+                   CPPDEFINES      List of CPP macro definitions, separated\n+                                   by a platform specific character (':' or\n+                                   space for Unix, ';' for Windows, ',' for\n+                                   VMS).  This can be used instead of using\n+                                   -D (or what corresponds to that on your\n+                                   compiler) in CPPFLAGS.\n+                   CPPINCLUDES     List of CPP inclusion directories, separated\n+                                   the same way as for CPPDEFINES.  This can\n+                                   be used instead of -I (or what corresponds\n+                                   to that on your compiler) in CPPFLAGS.\n+                   HASHBANGPERL    Perl invocation to be inserted after '#!'\n+                                   in public perl scripts (only relevant on\n+                                   Unix).\n+                   LD              The program linker (not used on Unix, $(CC)\n+                                   is used there).\n+                   LDFLAGS         Flags for the shared library, DSO and\n+                                   program linker.\n+                   LDLIBS          Extra libraries to use when linking.\n+                                   Takes the form of a space separated list\n+                                   of library specifications on Unix and\n+                                   Windows, and as a comma separated list of\n+                                   libraries on VMS.\n+                   RANLIB          The library archive indexer.\n+                   RC              The Windows resource compiler.\n+                   RCFLAGS         Flags for the Windows resource compiler.\n+                   RM              The command to remove files and directories.\n+\n+                   These cannot be mixed with compiling / linking flags given\n+                   on the command line.  In other words, something like this\n+                   isn't permitted.\n+\n+                       ./config -DFOO CPPFLAGS=-DBAR -DCOOKIE\n+\n+                   Backward compatibility note:\n+\n+                   To be compatible with older configuration scripts, the\n+                   environment variables are ignored if compiling / linking\n+                   flags are given on the command line, except for these:\n+\n+                   AR, CC, CXX, CROSS_COMPILE, HASHBANGPERL, PERL, RANLIB, RC\n+                   and WINDRES\n+\n+                   For example, the following command will not see -DBAR:\n+\n+                        CPPFLAGS=-DBAR ./config -DCOOKIE\n+\n+                   However, the following will see both set variables:\n+\n+                        CC=gcc CROSS_COMPILE=x86_64-w64-mingw32- \\\n+                        ./config -DCOOKIE\n+\n+  reconf\n+  reconfigure\n+                   Reconfigure from earlier data.  This fetches the previous\n+                   command line options and environment from data saved in\n+                   \"configdata.pm\", and runs the configuration process again,\n+                   using these options and environment.\n+                   Note: NO other option is permitted together with \"reconf\".\n+                   This means that you also MUST use \"./Configure\" (or\n+                   what corresponds to that on non-Unix platforms) directly\n+                   to invoke this option.\n+                   Note: The original configuration saves away values for ALL\n+                   environment variables that were used, and if they weren't\n+                   defined, they are still saved away with information that\n+                   they weren't originally defined.  This information takes\n+                   precedence over environment variables that are defined\n+                   when reconfiguring.\n+\n+ Displaying configuration data\n+ -----------------------------\n+\n+ The configuration script itself will say very little, and finishes by\n+ creating \"configdata.pm\".  This perl module can be loaded by other scripts\n+ to find all the configuration data, and it can also be used as a script to\n+ display all sorts of configuration data in a human readable form.\n+\n+ For more information, please do:\n+\n+       $ ./configdata.pm --help                         # Unix\n+\n+       or\n+\n+       $ perl configdata.pm --help                      # Windows and VMS\n \n  Installation in Detail\n  ----------------------\n@@ -620,22 +786,34 @@\n      (\"openssl\"). The libraries will be built in the top-level directory,\n      and the binary will be in the \"apps\" subdirectory.\n \n+     Troubleshooting:\n+\n      If the build fails, look at the output.  There may be reasons\n      for the failure that aren't problems in OpenSSL itself (like\n-     missing standard headers).  If you are having problems you can\n-     get help by sending an email to the openssl-users email list (see\n+     missing standard headers).\n+\n+     If the build succeeded previously, but fails after a source or\n+     configuration change, it might be helpful to clean the build tree\n+     before attempting another build. Use this command:\n+\n+       $ make clean                                     # Unix\n+       $ mms clean                                      ! (or mmk) OpenVMS\n+       $ nmake clean                                    # Windows\n+\n+     Assembler error messages can sometimes be sidestepped by using the\n+     \"no-asm\" configuration option.\n+\n+     Compiling parts of OpenSSL with gcc and others with the system\n+     compiler will result in unresolved symbols on some systems.\n+\n+     If you are still having problems you can get help by sending an email\n+     to the openssl-users email list (see\n      https://www.openssl.org/community/mailinglists.html for details). If\n      it is a bug with OpenSSL itself, please open an issue on GitHub, at\n      https://github.com/openssl/openssl/issues. Please review the existing\n      ones first; maybe the bug was already reported or has already been\n      fixed.\n \n-     (If you encounter assembler error messages, try the \"no-asm\"\n-     configuration option as an immediate fix.)\n-\n-     Compiling parts of OpenSSL with gcc and others with the system\n-     compiler will result in unresolved symbols on some systems.\n-\n   3. After a successful build, the libraries should be tested. Run:\n \n        $ make test                                      # Unix\n@@ -664,7 +842,7 @@\n        $ nmake TESTS='test_rsa test_dsa' test           # Windows\n \n      And of course, you can combine (Unix example shown):\n-       \n+\n        $ make VERBOSE=1 TESTS='test_rsa test_dsa' test\n \n      You can find the list of available tests like this:\n@@ -683,6 +861,9 @@\n      To report a bug please open an issue on GitHub, at\n      https://github.com/openssl/openssl/issues.\n \n+     For more details on how the make variables TESTS can be used,\n+     see section TESTS in Detail below.\n+\n   4. If everything tests ok, install OpenSSL with\n \n        $ make install                                   # Unix\n@@ -734,7 +915,7 @@\n                         command symbols.\n          [.SYSTEST]     Contains the installation verification procedure.\n          [.HTML]        Contains the HTML rendition of the manual pages.\n-                        \n+\n \n      Additionally, install will add the following directories under\n      OPENSSLDIR (the directory given with --openssldir or its default)\n@@ -788,7 +969,7 @@\n \n  BUILDFILE\n                 Use a different build file name than the platform default\n-                (\"Makefile\" on Unixly platforms, \"makefile\" on native Windows,\n+                (\"Makefile\" on Unix-like platforms, \"makefile\" on native Windows,\n                 \"descrip.mms\" on OpenVMS).  This requires that there is a\n                 corresponding build file template.  See Configurations/README\n                 for further information.\n@@ -820,11 +1001,14 @@\n                 possible to create your own \".conf\" and \".tmpl\" files and store\n                 them locally, outside the OpenSSL source tree. This environment\n                 variable can be set to the directory where these files are held\n-                and will have Configure to consider them in addition to the\n-                standard ones.\n+                and will be considered by Configure before it looks in the\n+                standard directories.\n \n  PERL\n                 The name of the Perl executable to use when building OpenSSL.\n+                This variable is used in config script only. Configure on the\n+                other hand imposes the interpreter by which it itself was\n+                executed on the whole build procedure.\n \n  HASHBANGPERL\n                 The command string for the Perl executable to insert in the\n@@ -889,12 +1073,68 @@\n  uninstall\n                 Uninstall all OpenSSL components.\n \n+ reconfigure\n+ reconf\n+                Re-run the configuration process, as exactly as the last time\n+                as possible.\n+\n  update\n                 This is a developer option. If you are developing a patch for\n                 OpenSSL you may need to use this if you want to update\n                 automatically generated files; add new error codes or add new\n                 (or change the visibility of) public API functions. (Unix only).\n \n+ TESTS in Detail\n+ ---------------\n+\n+ The make variable TESTS supports a versatile set of space separated tokens\n+ with which you can specify a set of tests to be performed.  With a \"current\n+ set of tests\" in mind, initially being empty, here are the possible tokens:\n+\n+ alltests       The current set of tests becomes the whole set of available\n+                tests (as listed when you do 'make list-tests' or similar).\n+ xxx            Adds the test 'xxx' to the current set of tests.\n+ -xxx           Removes 'xxx' from the current set of tests.  If this is the\n+                first token in the list, the current set of tests is first\n+                assigned the whole set of available tests, effectively making\n+                this token equivalent to TESTS=\"alltests -xxx\".\n+ nn             Adds the test group 'nn' (which is a number) to the current\n+                set of tests.\n+ -nn            Removes the test group 'nn' from the current set of tests.\n+                If this is the first token in the list, the current set of\n+                tests is first assigned the whole set of available tests,\n+                effectively making this token equivalent to\n+                TESTS=\"alltests -xxx\".\n+\n+ Also, all tokens except for \"alltests\" may have wildcards, such as *.\n+ (on Unix and Windows, BSD style wildcards are supported, while on VMS,\n+ it's VMS style wildcards)\n+\n+ Example: All tests except for the fuzz tests:\n+\n+ $ make TESTS=-test_fuzz test\n+\n+ or (if you want to be explicit)\n+\n+ $ make TESTS='alltests -test_fuzz' test\n+\n+ Example: All tests that have a name starting with \"test_ssl\" but not those\n+ starting with \"test_ssl_\":\n+\n+ $ make TESTS='test_ssl* -test_ssl_*' test\n+\n+ Example: Only test group 10:\n+\n+ $ make TESTS='10'\n+\n+ Example: All tests except the slow group (group 99):\n+\n+ $ make TESTS='-99'\n+\n+ Example: All tests in test groups 80 to 99 except for tests in group 90:\n+\n+ $ make TESTS='[89]? -90'\n+\n  Note on multi-threading\n  -----------------------\n \n@@ -931,7 +1171,7 @@\n  part of the file name, i.e. for OpenSSL 1.1.x, 1.1 is somehow part of\n  the name.\n \n- On most POSIXly platforms, shared libraries are named libcrypto.so.1.1\n+ On most POSIX platforms, shared libraries are named libcrypto.so.1.1\n  and libssl.so.1.1.\n \n  on Cygwin, shared libraries are named cygcrypto-1.1.dll and cygssl-1.1.dll\n@@ -956,10 +1196,22 @@\n \n  Availability of cryptographically secure random numbers is required for\n  secret key generation. OpenSSL provides several options to seed the\n- internal PRNG. If not properly seeded, the internal PRNG will refuse\n+ internal CSPRNG. If not properly seeded, the internal CSPRNG will refuse\n  to deliver random bytes and a \"PRNG not seeded error\" will occur.\n- On systems without /dev/urandom (or similar) device, it may be necessary\n- to install additional support software to obtain a random seed.\n- Please check out the manual pages for RAND_add(), RAND_bytes(), RAND_egd(),\n- and the FAQ for more information.\n \n+ The seeding method can be configured using the --with-rand-seed option,\n+ which can be used to specify a comma separated list of seed methods.\n+ However in most cases OpenSSL will choose a suitable default method,\n+ so it is not necessary to explicitly provide this option. Note also\n+ that not all methods are available on all platforms.\n+\n+ I) On operating systems which provide a suitable randomness source (in\n+ form  of a system call or system device), OpenSSL will use the optimal\n+ available  method to seed the CSPRNG from the operating system's\n+ randomness sources. This corresponds to the option --with-rand-seed=os.\n+\n+ II) On systems without such a suitable randomness source, automatic seeding\n+ and reseeding is disabled (--with-rand-seed=none) and it may be necessary\n+ to install additional support software to obtain a random seed and reseed\n+ the CSPRNG manually.  Please check out the manual pages for RAND_add(),\n+ RAND_bytes(), RAND_egd(), and the FAQ for more information."
        },
        {
            "sha": "4f9550aaf18c572b5b5aa65b21034ba3feaab7d7",
            "filename": "deps/openssl/openssl/Makefile.shared",
            "status": "removed",
            "additions": 0,
            "deletions": 521,
            "changes": 521,
            "blob_url": "https://github.com/nodejs/node/blob/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2FMakefile.shared",
            "raw_url": "https://github.com/nodejs/node/raw/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2FMakefile.shared",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FMakefile.shared?ref=5d80f9ea6091847176fa47fb1395fdffc4af9164",
            "patch": "@@ -1,521 +0,0 @@\n-#\n-# Helper makefile to link shared libraries in a portable way.\n-# This is much simpler than libtool, and hopefully not too error-prone.\n-#\n-# The following variables need to be set on the command line to build\n-# properly\n-\n-# CC contains the current compiler.  This one MUST be defined\n-CC=cc\n-CFLAGS=$(CFLAG)\n-# LDFLAGS contains flags to be used when temporary object files (when building\n-# shared libraries) are created, or when an application is linked.\n-# SHARED_LDFLAGS contains flags to be used when the shared library is created.\n-LDFLAGS=$(LDFLAG)\n-SHARED_LDFLAGS=$(SHARED_LDFLAG)\n-\n-RC=windres\n-# SHARED_RCFLAGS are flags used with windres, i.e. when build for Cygwin\n-# or Mingw.\n-SHARED_RCFLAGS=$(SHARED_RCFLAG)\n-\n-NM=nm\n-\n-# LIBNAME contains just the name of the library, without prefix (\"lib\"\n-# on Unix, \"cyg\" for certain forms under Cygwin...) or suffix (.a, .so,\n-# .dll, ...).  This one MUST have a value when using this makefile to\n-# build shared libraries.\n-# For example, to build libfoo.so, you need to do the following:\n-#LIBNAME=foo\n-LIBNAME=\n-\n-# STLIBNAME contains the path of the static library to build the shared\n-# library from, for example:\n-#STLIBNAME=libfoo.a\n-STLIBNAME=\n-\n-# On most Unix platforms, SHLIBNAME contains the path of the short name of\n-# the shared library to build, for example\n-#SHLIBNAME=libfoo.so\n-# On Windows POSIX layers (cygwin and mingw), SHLIBNAME contains the import\n-# library name for the shared library to be built, for example:\n-#SHLIBNAME=libfoo.dll.a\n-\n-# SHLIBNAME_FULL contains the path of the full name of the shared library to\n-# build, for example:\n-#SHLIBNAME_FULL=libfoo.so.1.2\n-# When building DSOs, SHLIBNAME_FULL contains path of the full DSO name, for\n-# example:\n-#SHLIBNAME_FULL=dir/dso.so\n-SHLIBNAME_FULL=\n-\n-# SHLIBVERSION contains the current version of the shared library (not to\n-# be confused with the project version)\n-#SHLIBVERSION=1.2\n-SHLIBVERSION=\n-\n-# NOTE: to build shared libraries, LIBNAME, STLIBNAME, SHLIBNAME and\n-# SHLIBNAME_FULL MUST have values when using this makefile, and in some\n-# cases, SHLIBVERSION as well.  To build DSOs, SHLIBNAME_FULL MUST have\n-# a value, the rest can be left alone.\n-\n-\n-# APPNAME contains just the name of the application, without suffix (\"\"\n-# on Unix, \".exe\" on Windows, ...).  This one MUST have a value when using\n-# this makefile to build applications.\n-# For example, to build foo, you need to do the following:\n-#APPNAME=foo\n-APPNAME=\n-\n-# SRCDIR is the top directory of the source tree.\n-SRCDIR=.\n-\n-# OBJECTS contains all the object files to link together into the application.\n-# This must contain at least one object file.\n-#OBJECTS=foo.o\n-OBJECTS=\n-\n-# LIBEXTRAS contains extra modules to link together with the library.\n-# For example, if a second library, say libbar.a needs to be linked into\n-# libfoo.so, you need to do the following:\n-#LIBEXTRAS=libbar.a\n-# Note that this MUST be used when using the link_dso targets, to hold the\n-# names of all object files that go into the target shared object.\n-LIBEXTRAS=\n-\n-# LIBDEPS contains all the flags necessary to cover all necessary\n-# dependencies to other libraries.\n-LIBDEPS=\n-\n-#------------------------------------------------------------------------------\n-# The rest is private to this makefile.\n-\n-SET_X=:\n-#SET_X=set -x\n-\n-top:\n-\techo \"Trying to use this makefile interactively?  Don't.\"\n-\n-LINK_APP=\t\\\n-  ( $(SET_X);   \\\n-    LIBDEPS=\"$${LIBDEPS:-$(LIBDEPS)}\"; \\\n-    LDCMD=\"$${LDCMD:-$(CC)}\"; LDFLAGS=\"$${LDFLAGS:-$(CFLAGS) $(LDFLAGS)}\"; \\\n-    LIBPATH=`for x in $$LIBDEPS; do echo $$x; done | sed -e 's/^ *-L//;t' -e d | uniq`; \\\n-    LIBPATH=`echo $$LIBPATH | sed -e 's/ /:/g'`; \\\n-    echo LD_LIBRARY_PATH=$$LIBPATH:$$LD_LIBRARY_PATH \\\n-        $${LDCMD} $${LDFLAGS} -o $${APPNAME:=$(APPNAME)} $(OBJECTS) $${LIBDEPS}; \\\n-    LD_LIBRARY_PATH=$$LIBPATH:$$LD_LIBRARY_PATH \\\n-    $${LDCMD} $${LDFLAGS} -o $${APPNAME:=$(APPNAME)} $(OBJECTS) $${LIBDEPS} )\n-\n-LINK_SO=\t\\\n-  ( $(SET_X);   \\\n-    LIBDEPS=\"$${LIBDEPS:-$(LIBDEPS)}\"; \\\n-    SHAREDCMD=\"$${SHAREDCMD:-$(CC)}\"; \\\n-    SHAREDFLAGS=\"$${SHAREDFLAGS:-$(CFLAGS) $(SHARED_LDFLAGS)}\"; \\\n-    LIBPATH=`for x in $$LIBDEPS; do echo $$x; done | sed -e 's/^ *-L//;t' -e d | uniq`; \\\n-    LIBPATH=`echo $$LIBPATH | sed -e 's/ /:/g'`; \\\n-    echo LD_LIBRARY_PATH=$$LIBPATH:$$LD_LIBRARY_PATH \\\n-         $${SHAREDCMD} $${SHAREDFLAGS} \\\n-\t     -o $(SHLIBNAME_FULL) \\\n-\t     $$ALLSYMSFLAGS $$SHOBJECTS $$NOALLSYMSFLAGS $$LIBDEPS; \\\n-    LD_LIBRARY_PATH=$$LIBPATH:$$LD_LIBRARY_PATH \\\n-    $${SHAREDCMD} $${SHAREDFLAGS} \\\n-\t-o $(SHLIBNAME_FULL) \\\n-\t$$ALLSYMSFLAGS $$SHOBJECTS $$NOALLSYMSFLAGS $$LIBDEPS \\\n-  ) && $(SYMLINK_SO)\n-\n-SYMLINK_SO=\t\\\n-\tif [ -n \"$$INHIBIT_SYMLINKS\" ]; then :; else \\\n-\t\tif [ -n \"$(SHLIBNAME_FULL)\" -a -n \"$(SHLIBNAME)\" -a \\\n-\t\t     \"$(SHLIBNAME_FULL)\" != \"$(SHLIBNAME)\" ]; then \\\n-\t\t\t( $(SET_X); \\\n-\t\t\t  rm -f $(SHLIBNAME); \\\n-\t\t\t  ln -s $(SHLIBNAME_FULL) $(SHLIBNAME) ); \\\n-\t\tfi; \\\n-\tfi\n-\n-LINK_SO_SHLIB=\tSHOBJECTS=\"$(STLIBNAME) $(LIBEXTRAS)\"; $(LINK_SO)\n-LINK_SO_DSO=\tINHIBIT_SYMLINKS=yes; SHOBJECTS=\"$(LIBEXTRAS)\"; $(LINK_SO)\n-\n-LINK_SO_SHLIB_VIA_O=\t\\\n-  SHOBJECTS=$(STLIBNAME).o; \\\n-  ALL=$$ALLSYMSFLAGS; ALLSYMSFLAGS=; NOALLSYMSFLAGS=; \\\n-  ( echo ld $(LDFLAGS) -r -o $$SHOBJECTS $$ALL $(STLIBNAME) $(LIBEXTRAS); \\\n-    ld $(LDFLAGS) -r -o $$SHOBJECTS $$ALL $(STLIBNAME) $(LIBEXTRAS) ); \\\n-  $(LINK_SO) && ( echo rm -f $$SHOBJECTS; rm -f $$SHOBJECTS )\n-\n-LINK_SO_SHLIB_UNPACKED=\t\\\n-  UNPACKDIR=link_tmp.$$$$; rm -rf $$UNPACKDIR; mkdir $$UNPACKDIR; \\\n-  (cd $$UNPACKDIR; ar x ../$(STLIBNAME)) && \\\n-  ([ -z \"$(LIBEXTRAS)\" ] || cp $(LIBEXTRAS) $$UNPACKDIR) && \\\n-  SHOBJECTS=$$UNPACKDIR/*.o; \\\n-  $(LINK_SO) && rm -rf $$UNPACKDIR\n-\n-DETECT_GNU_LD=($(CC) -Wl,-V /dev/null 2>&1 | grep '^GNU ld' )>/dev/null\n-\n-DO_GNU_SO_COMMON=\\\n-\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-Bsymbolic -Wl,-soname=$(SHLIBNAME_FULL)\"\n-DO_GNU_DSO=\\\n-\t$(DO_GNU_SO_COMMON)\n-DO_GNU_SO=\\\n-\tALLSYMSFLAGS='-Wl,--whole-archive'; \\\n-\tNOALLSYMSFLAGS='-Wl,--no-whole-archive'; \\\n-\t$(DO_GNU_SO_COMMON)\n-DO_GNU_APP=LDFLAGS=\"$(CFLAGS) $(LDFLAGS)\"\n-\n-#This is rather special.  It's a special target with which one can link\n-#applications without bothering with any features that have anything to\n-#do with shared libraries, for example when linking against static\n-#libraries.  It's mostly here to avoid a lot of conditionals everywhere\n-#else...\n-link_app.:\n-\t$(LINK_APP)\n-\n-link_dso.gnu:\n-\t@ $(DO_GNU_DSO); $(LINK_SO_DSO)\n-link_shlib.gnu:\n-\t@ $(DO_GNU_SO); $(LINK_SO_SHLIB)\n-link_app.gnu:\n-\t@ $(DO_GNU_APP); $(LINK_APP)\n-\n-link_shlib.linux-shared:\n-\t@$(PERL) $(SRCDIR)/util/mkdef.pl $(LIBNAME) linux >$(LIBNAME).map; \\\n-\t$(DO_GNU_SO); \\\n-\tALLSYMSFLAGS='-Wl,--whole-archive,--version-script=$(LIBNAME).map'; \\\n-\t$(LINK_SO_SHLIB)\n-\n-link_dso.bsd:\n-\t@if $(DETECT_GNU_LD); then $(DO_GNU_DSO); else \\\n-\tLIBDEPS=\" \"; \\\n-\tALLSYMSFLAGS=; \\\n-\tNOALLSYMSFLAGS=; \\\n-\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -nostdlib\"; \\\n-\tfi; $(LINK_SO_DSO)\n-link_shlib.bsd:\n-\t@if $(DETECT_GNU_LD); then $(DO_GNU_SO); else \\\n-\tLIBDEPS=\" \"; \\\n-\tALLSYMSFLAGS=\"-Wl,-Bforcearchive\"; \\\n-\tNOALLSYMSFLAGS=; \\\n-\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -nostdlib\"; \\\n-\tfi; $(LINK_SO_SHLIB)\n-link_app.bsd:\n-\t@if $(DETECT_GNU_LD); then $(DO_GNU_APP); else \\\n-\tLDFLAGS=\"$(CFLAGS) $(LDFLAGS)\"; \\\n-\tfi; $(LINK_APP)\n-\n-# For Darwin AKA Mac OS/X (dyld)\n-# Originally link_dso.darwin produced .so, because it was hard-coded\n-# in dso_dlfcn module. At later point dso_dlfcn switched to .dylib\n-# extension in order to allow for run-time linking with vendor-\n-# supplied shared libraries such as libz, so that link_dso.darwin had\n-# to be harmonized with it. This caused minor controversy, because\n-# it was believed that dlopen can't be used to dynamically load\n-# .dylib-s, only so called bundle modules (ones linked with -bundle\n-# flag). The belief seems to be originating from pre-10.4 release,\n-# where dlfcn functionality was emulated by dlcompat add-on. In\n-# 10.4 dlopen was rewritten as native part of dyld and is documented\n-# to be capable of loading both dynamic libraries and bundles. In\n-# order to provide compatibility with pre-10.4 dlopen, modules are\n-# linked with -bundle flag, which makes .dylib extension misleading.\n-# It works, because dlopen is [and always was] extension-agnostic.\n-# Alternative to this heuristic approach is to develop specific\n-# MacOS X dso module relying on whichever \"native\" dyld interface.\n-link_dso.darwin:\n-\t@ ALLSYMSFLAGS=''; \\\n-\tNOALLSYMSFLAGS=''; \\\n-\tSHAREDFLAGS=\"$(CFLAGS) `echo $(SHARED_LDFLAGS) | sed s/dynamiclib/bundle/`\"; \\\n-\t$(LINK_SO_DSO)\n-link_shlib.darwin:\n-\t@ ALLSYMSFLAGS='-all_load'; \\\n-\tNOALLSYMSFLAGS=''; \\\n-\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -current_version $(SHLIBVERSION) -compatibility_version $(SHLIBVERSION) -install_name $(INSTALLTOP)/$(LIBDIR)/$(SHLIBNAME_FULL)\"; \\\n-\t$(LINK_SO_SHLIB)\n-link_app.darwin:\t# is there run-path on darwin?\n-\t$(LINK_APP)\n-\n-link_dso.cygwin:\n-\t@ALLSYMSFLAGS=''; \\\n-\tNOALLSYMSFLAGS=''; \\\n-\tbase=-Wl,--enable-auto-image-base; \\\n-\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared $$base -Wl,-Bsymbolic\"; \\\n-\t$(LINK_SO_DSO)\n-link_shlib.cygwin:\n-\t@ INHIBIT_SYMLINKS=yes; \\\n-\techo \"$(PERL) $(SRCDIR)/util/mkrc.pl $(SHLIBNAME_FULL) |\" \\\n-\t\t     \"$(RC) $(SHARED_RCFLAGS) -o rc.o\"; \\\n-\t$(PERL) $(SRCDIR)/util/mkrc.pl $(SHLIBNAME_FULL) | \\\n-\t\t$(RC) $(SHARED_RCFLAGS) -o rc.o; \\\n-\tALLSYMSFLAGS='-Wl,--whole-archive'; \\\n-\tNOALLSYMSFLAGS='-Wl,--no-whole-archive'; \\\n-\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,--enable-auto-image-base -Wl,-Bsymbolic -Wl,--out-implib,$(SHLIBNAME) rc.o\"; \\\n-\t$(LINK_SO_SHLIB) || exit 1; \\\n-\trm rc.o\n-link_app.cygwin:\n-\t$(LINK_APP)\n-\n-# link_dso.mingw-shared and link_app.mingw-shared are mapped to the\n-# corresponding cygwin targets, as they do the exact same thing.\n-link_shlib.mingw:\n-\t@ INHIBIT_SYMLINKS=yes; \\\n-\tbase=; [ $(LIBNAME) = \"crypto\" -a -n \"$(FIPSCANLIB)\" ] && base=-Wl,--image-base,0x63000000; \\\n-\t$(PERL) $(SRCDIR)/util/mkdef.pl 32 $(LIBNAME) \\\n-\t\t| sed -e 's|^\\(LIBRARY  *\\)$(LIBNAME)32|\\1$(SHLIBNAME_FULL)|' \\\n-\t\t> $(LIBNAME).def; \\\n-\techo \"$(PERL) $(SRCDIR)/util/mkrc.pl $(SHLIBNAME_FULL) |\" \\\n-\t\t\"$(RC) $(SHARED_RCFLAGS) -o rc.o\"; \\\n-\t$(PERL) $(SRCDIR)/util/mkrc.pl $(SHLIBNAME_FULL) | \\\n-\t\t$(RC) $(SHARED_RCFLAGS) -o rc.o; \\\n-\tALLSYMSFLAGS='-Wl,--whole-archive'; \\\n-\tNOALLSYMSFLAGS='-Wl,--no-whole-archive'; \\\n-\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared $$base -Wl,-Bsymbolic -Wl,--out-implib,$(SHLIBNAME) $(LIBNAME).def rc.o\"; \\\n-\t$(LINK_SO_SHLIB) || exit 1; \\\n-\trm $(LIBNAME).def rc.o\n-\n-link_dso.alpha-osf1:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_DSO); \\\n-\telse \\\n-\t\tALLSYMSFLAGS=''; \\\n-\t\tNOALLSYMSFLAGS=''; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-B,symbolic\"; \\\n-\tfi; \\\n-\t$(LINK_SO_DSO)\n-link_shlib.alpha-osf1:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_SO); \\\n-\telse \\\n-\t\tALLSYMSFLAGS='-all'; \\\n-\t\tNOALLSYMSFLAGS='-none'; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-B,symbolic -set_version $(SHLIBVERSION)\"; \\\n-\tfi; \\\n-\t$(LINK_SO_SHLIB)\n-link_app.alpha-osf1:\n-\t@if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_APP); \\\n-\telse \\\n-\t\tLDFLAGS=\"$(CFLAGS) $(LDFLAGS)\"; \\\n-\tfi; \\\n-\t$(LINK_APP)\n-\n-link_dso.solaris:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_DSO); \\\n-\telse \\\n-\t\tALLSYMSFLAGS=\"\"; \\\n-\t\tNOALLSYMSFLAGS=\"\"; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -h $(SHLIBNAME_FULL) -Wl,-Bsymbolic\"; \\\n-\tfi; \\\n-\t$(LINK_SO_DSO)\n-link_shlib.solaris:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_SO); \\\n-\telse \\\n-\t\t$(PERL) $(SRCDIR)/util/mkdef.pl $(LIBNAME) linux >$(LIBNAME).map; \\\n-\t\tALLSYMSFLAGS=\"-Wl,-z,allextract,-M,$(LIBNAME).map\"; \\\n-\t\tNOALLSYMSFLAGS=\"-Wl,-z,defaultextract\"; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -h $(SHLIBNAME_FULL) -Wl,-Bsymbolic\"; \\\n-\tfi; \\\n-\t$(LINK_SO_SHLIB)\n-link_app.solaris:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_APP); \\\n-\telse \\\n-\t\tLDFLAGS=\"$(CFLAGS) $(LDFLAGS)\"; \\\n-\tfi; \\\n-\t$(LINK_APP)\n-\n-# OpenServer 5 native compilers used\n-link_dso.svr3:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_DSO); \\\n-\telse \\\n-\t\tALLSYMSFLAGS=''; \\\n-\t\tNOALLSYMSFLAGS=''; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) -G -h $(SHLIBNAME_FULL)\"; \\\n-\tfi; \\\n-\t$(LINK_SO_DSO)\n-link_shlib.svr3:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_SO); \\\n-\telse \\\n-\t\tALLSYMSFLAGS=''; \\\n-\t\tNOALLSYMSFLAGS=''; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) -G -h $(SHLIBNAME_FULL)\"; \\\n-\tfi; \\\n-\t$(LINK_SO_SHLIB_UNPACKED)\n-link_app.svr3:\n-\t@$(DETECT_GNU_LD) && $(DO_GNU_APP); \\\n-\t$(LINK_APP)\n-\n-# UnixWare 7 and OpenUNIX 8 native compilers used\n-link_dso.svr5:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_DSO); \\\n-\telse \\\n-\t\tSHARE_FLAG='-G'; \\\n-\t\t($(CC) -v 2>&1 | grep gcc) > /dev/null && SHARE_FLAG='-shared'; \\\n-\t\tALLSYMSFLAGS=''; \\\n-\t\tNOALLSYMSFLAGS=''; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) $${SHARE_FLAG} -h $(SHLIBNAME_FULL)\"; \\\n-\tfi; \\\n-\t$(LINK_SO_DSO)\n-link_shlib.svr5:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_SO); \\\n-\telse \\\n-\t\tSHARE_FLAG='-G'; \\\n-\t\t($(CC) -v 2>&1 | grep gcc) > /dev/null && SHARE_FLAG='-shared'; \\\n-\t\tALLSYMSFLAGS=''; \\\n-\t\tNOALLSYMSFLAGS=''; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) $${SHARE_FLAG} -h $(SHLIBNAME_FULL)\"; \\\n-\tfi; \\\n-\t$(LINK_SO_SHLIB_UNPACKED)\n-link_app.svr5:\n-\t@$(DETECT_GNU_LD) && $(DO_GNU_APP); \\\n-\t$(LINK_APP)\n-\n-link_dso.irix:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_DSO); \\\n-\telse \\\n-\t\tALLSYMSFLAGS=\"\"; \\\n-\t\tNOALLSYMSFLAGS=\"\"; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-soname,$(SHLIBNAME_FULL),-B,symbolic\"; \\\n-\tfi; \\\n-\t$(LINK_SO_DSO)\n-link_shlib.irix:\n-\t@ if $(DETECT_GNU_LD); then \\\n-\t\t$(DO_GNU_SO); \\\n-\telse \\\n-\t\tMINUSWL=\"\"; \\\n-\t\t($(CC) -v 2>&1 | grep gcc) > /dev/null && MINUSWL=\"-Wl,\"; \\\n-\t\tALLSYMSFLAGS=\"$${MINUSWL}-all\"; \\\n-\t\tNOALLSYMSFLAGS=\"$${MINUSWL}-none\"; \\\n-\t\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-soname,$(SHLIBNAME_FULL),-B,symbolic\"; \\\n-\tfi; \\\n-\t$(LINK_SO_SHLIB)\n-link_app.irix:\n-\t@LDFLAGS=\"$(CFLAGS) $(LDFLAGS)\"; \\\n-\t$(LINK_APP)\n-\n-# 32-bit PA-RISC HP-UX embeds the -L pathname of libs we link with, so\n-# we compensate for it with +cdp ../: and +cdp ./:. Yes, these rewrite\n-# rules imply that we can only link one level down in catalog structure,\n-# but that's what takes place for the moment of this writing. +cdp option\n-# was introduced in HP-UX 11.x and applies in 32-bit PA-RISC link\n-# editor context only [it's simply ignored in other cases, which are all\n-# ELFs by the way].\n-#\n-link_dso.hpux:\n-\t@if $(DETECT_GNU_LD); then $(DO_GNU_DSO); else \\\n-\tALLSYMSFLAGS=''; \\\n-\tNOALLSYMSFLAGS=''; \\\n-\texpr $(PLATFORM) : 'hpux64' > /dev/null && ALLSYMSFLAGS='-Wl,+forceload'; \\\n-\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-B,symbolic,+vnocompatwarnings,-z,+s,+h,$(SHLIBNAME_FULL),+cdp,../:,+cdp,./:\"; \\\n-\tfi; \\\n-\trm -f $(SHLIBNAME_FULL) || :; \\\n-\t$(LINK_SO_DSO) && chmod a=rx $(SHLIBNAME_FULL)\n-link_shlib.hpux:\n-\t@if $(DETECT_GNU_LD); then $(DO_GNU_SO); else \\\n-\tALLSYMSFLAGS='-Wl,-Fl'; \\\n-\tNOALLSYMSFLAGS=''; \\\n-\texpr $(PLATFORM) : 'hpux64' > /dev/null && ALLSYMSFLAGS='-Wl,+forceload'; \\\n-\tSHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-B,symbolic,+vnocompatwarnings,-z,+s,+h,$(SHLIBNAME_FULL),+cdp,../:,+cdp,./:\"; \\\n-\tfi; \\\n-\trm -f $(SHLIBNAME_FULL) || :; \\\n-\t$(LINK_SO_SHLIB) && chmod a=rx $(SHLIBNAME_FULL)\n-link_app.hpux:\n-\t@if $(DETECT_GNU_LD); then $(DO_GNU_APP); else \\\n-\tLDFLAGS=\"$(CFLAGS) $(LDFLAGS) -Wl,+s,+cdp,../:,+cdp,./:\"; \\\n-\tfi; \\\n-\t$(LINK_APP)\n-\n-link_dso.aix:\n-\t@OBJECT_MODE=`expr \"x$(SHARED_LDFLAGS)\" : 'x\\-[a-z]*\\(64\\)'` || :; \\\n-\tOBJECT_MODE=$${OBJECT_MODE:-32}; export OBJECT_MODE; \\\n-\tALLSYMSFLAGS=''; \\\n-\tNOALLSYMSFLAGS=''; \\\n-\tSHAREDFLAGS='$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-bexpall,-bnolibpath,-bM:SRE'; \\\n-\trm -f $(SHLIBNAME_FULL) 2>&1 > /dev/null ; \\\n-\t$(LINK_SO_DSO);\n-link_shlib.aix:\n-\t@ OBJECT_MODE=`expr \"x$(SHARED_LDFLAGS)\" : 'x\\-[a-z]*\\(64\\)'` || : ; \\\n-\tOBJECT_MODE=$${OBJECT_MODE:-32}; export OBJECT_MODE; \\\n-\tALLSYMSFLAGS='-bnogc'; \\\n-\tNOALLSYMSFLAGS=''; \\\n-\tSHAREDFLAGS='$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-bexpall,-bnolibpath,-bM:SRE'; \\\n-\trm -f $(SHLIBNAME_FULL) 2>&1 > /dev/null ; \\\n-\t$(LINK_SO_SHLIB_VIA_O)\n-link_app.aix:\n-\tLDFLAGS=\"$(CFLAGS) -Wl,-bsvr4 $(LDFLAGS)\"; \\\n-\t$(LINK_APP)\n-\n-\n-# Targets to build symbolic links when needed\n-symlink.gnu symlink.solaris symlink.svr3 symlink.svr5 symlink.irix \\\n-symlink.aix:\n-\t@ $(SYMLINK_SO)\n-symlink.darwin:\n-\t@ $(SYMLINK_SO)\n-symlink.hpux:\n-\t@ $(SYMLINK_SO)\n-# The following lines means those specific architectures do no symlinks\n-symlink.cygwin symlink.alpha-osf1 symlink.tru64 symlink.tru64-rpath:\n-\n-# Compatibility targets\n-link_dso.bsd-gcc-shared link_dso.linux-shared link_dso.gnu-shared: link_dso.gnu\n-link_shlib.bsd-gcc-shared: link_shlib.linux-shared\n-link_shlib.gnu-shared: link_shlib.gnu\n-link_app.bsd-gcc-shared link_app.linux-shared link_app.gnu-shared: link_app.gnu\n-symlink.bsd-gcc-shared symlink.bsd-shared symlink.linux-shared symlink.gnu-shared: symlink.gnu\n-link_dso.bsd-shared: link_dso.bsd\n-link_shlib.bsd-shared: link_shlib.bsd\n-link_app.bsd-shared: link_app.bsd\n-link_dso.darwin-shared: link_dso.darwin\n-link_shlib.darwin-shared: link_shlib.darwin\n-link_app.darwin-shared: link_app.darwin\n-symlink.darwin-shared: symlink.darwin\n-link_dso.cygwin-shared: link_dso.cygwin\n-link_shlib.cygwin-shared: link_shlib.cygwin\n-link_app.cygwin-shared: link_app.cygwin\n-symlink.cygwin-shared: symlink.cygwin\n-link_dso.mingw-shared: link_dso.cygwin\n-link_shlib.mingw-shared: link_shlib.mingw\n-link_app.mingw-shared: link_app.cygwin\n-symlink.mingw-shared: symlink.cygwin\n-link_dso.alpha-osf1-shared: link_dso.alpha-osf1\n-link_shlib.alpha-osf1-shared: link_shlib.alpha-osf1\n-link_app.alpha-osf1-shared: link_app.alpha-osf1\n-symlink.alpha-osf1-shared: symlink.alpha-osf1\n-link_dso.tru64-shared: link_dso.tru64\n-link_shlib.tru64-shared: link_shlib.tru64\n-link_app.tru64-shared: link_app.tru64\n-symlink.tru64-shared: symlink.tru64\n-link_dso.tru64-shared-rpath: link_dso.tru64-rpath\n-link_shlib.tru64-shared-rpath: link_shlib.tru64-rpath\n-link_app.tru64-shared-rpath: link_app.tru64-rpath\n-symlink.tru64-shared-rpath: symlink.tru64-rpath\n-link_dso.solaris-shared: link_dso.solaris\n-link_shlib.solaris-shared: link_shlib.solaris\n-link_app.solaris-shared: link_app.solaris\n-symlink.solaris-shared: symlink.solaris\n-link_dso.svr3-shared: link_dso.svr3\n-link_shlib.svr3-shared: link_shlib.svr3\n-link_app.svr3-shared: link_app.svr3\n-symlink.svr3-shared: symlink.svr3\n-link_dso.svr5-shared: link_dso.svr5\n-link_shlib.svr5-shared: link_shlib.svr5\n-link_app.svr5-shared: link_app.svr5\n-symlink.svr5-shared: symlink.svr5\n-link_dso.irix-shared: link_dso.irix\n-link_shlib.irix-shared: link_shlib.irix\n-link_app.irix-shared: link_app.irix\n-symlink.irix-shared: symlink.irix\n-link_dso.hpux-shared: link_dso.hpux\n-link_shlib.hpux-shared: link_shlib.hpux\n-link_app.hpux-shared: link_app.hpux\n-symlink.hpux-shared: symlink.hpux\n-link_dso.aix-shared: link_dso.aix\n-link_shlib.aix-shared: link_shlib.aix\n-link_app.aix-shared: link_app.aix\n-symlink.aix-shared: symlink.aix"
        },
        {
            "sha": "b95e93027f830d0b5c23f9815037b96aec6062f9",
            "filename": "deps/openssl/openssl/NEWS",
            "status": "modified",
            "additions": 61,
            "deletions": 14,
            "changes": 75,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNEWS",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNEWS",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FNEWS?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -5,17 +5,65 @@\n   This file gives a brief overview of the major changes between each OpenSSL\n   release. For more details please read the CHANGES file.\n \n-  Major changes between OpenSSL 1.1.0i and OpenSSL 1.1.0j [20 Nov 2018]\n+  Major changes between OpenSSL 1.1.1 and OpenSSL 1.1.1a [20 Nov 2018]\n \n       o Timing vulnerability in DSA signature generation (CVE-2018-0734)\n       o Timing vulnerability in ECDSA signature generation (CVE-2018-0735)\n \n-  Major changes between OpenSSL 1.1.0h and OpenSSL 1.1.0i [14 Aug 2018]\n+  Major changes between OpenSSL 1.1.0i and OpenSSL 1.1.1 [11 Sep 2018]\n+\n+      o Support for TLSv1.3 added (see https://wiki.openssl.org/index.php/TLS1.3\n+        for further important information). The TLSv1.3 implementation includes:\n+          o Fully compliant implementation of RFC8446 (TLSv1.3) on by default\n+          o Early data (0-RTT)\n+          o Post-handshake authentication and key update\n+          o Middlebox Compatibility Mode\n+          o TLSv1.3 PSKs\n+          o Support for all five RFC8446 ciphersuites\n+          o RSA-PSS signature algorithms (backported to TLSv1.2)\n+          o Configurable session ticket support\n+          o Stateless server support\n+          o Rewrite of the packet construction code for \"safer\" packet handling\n+          o Rewrite of the extension handling code\n+      o Complete rewrite of the OpenSSL random number generator to introduce the\n+        following capabilities\n+          o The default RAND method now utilizes an AES-CTR DRBG according to\n+            NIST standard SP 800-90Ar1.\n+          o Support for multiple DRBG instances with seed chaining.\n+          o There is a public and private DRBG instance.\n+          o The DRBG instances are fork-safe.\n+          o Keep all global DRBG instances on the secure heap if it is enabled.\n+          o The public and private DRBG instance are per thread for lock free\n+            operation\n+      o Support for various new cryptographic algorithms including:\n+          o SHA3\n+          o SHA512/224 and SHA512/256\n+          o EdDSA (both Ed25519 and Ed448) including X509 and TLS support\n+          o X448 (adding to the existing X25519 support in 1.1.0)\n+          o Multi-prime RSA\n+          o SM2\n+          o SM3\n+          o SM4\n+          o SipHash\n+          o ARIA (including TLS support)\n+      o Significant Side-Channel attack security improvements\n+      o Add a new ClientHello callback to provide the ability to adjust the SSL\n+        object at an early stage.\n+      o Add 'Maximum Fragment Length' TLS extension negotiation and support\n+      o A new STORE module, which implements a uniform and URI based reader of\n+        stores that can contain keys, certificates, CRLs and numerous other\n+        objects.\n+      o Move the display of configuration data to configdata.pm.\n+      o Allow GNU style \"make variables\" to be used with Configure.\n+      o Claim the namespaces OSSL and OPENSSL, represented as symbol prefixes\n+      o Rewrite of devcrypto engine\n+\n+  Major changes between OpenSSL 1.1.0h and OpenSSL 1.1.0i [under development]\n \n       o Client DoS due to large DH parameter (CVE-2018-0732)\n       o Cache timing vulnerability in RSA Key Generation (CVE-2018-0737)\n \n-  Major changes between OpenSSL 1.1.0g and OpenSSL 1.1.0h [27 Mar 2018]\n+  Major changes between OpenSSL 1.1.0g and OpenSSL 1.1.0h [under development]\n \n       o Constructed ASN.1 types with a recursive definition could exceed the\n         stack (CVE-2018-0739)\n@@ -377,7 +425,7 @@\n       o Compression memory leak fixed.\n       o Compression session resumption fixed.\n       o Ticket and SNI coexistence fixes.\n-      o Many fixes to DTLS handling. \n+      o Many fixes to DTLS handling.\n \n   Major changes between OpenSSL 0.9.8k and OpenSSL 0.9.8l [5 Nov 2009]:\n \n@@ -410,7 +458,7 @@\n       o Add gcc 4.2 support.\n       o Add support for AES and SSE2 assembly language optimization\n         for VC++ build.\n-      o Support for RFC4507bis and server name extensions if explicitly \n+      o Support for RFC4507bis and server name extensions if explicitly\n         selected at compile time.\n       o DTLS improvements.\n       o RFC4507bis support.\n@@ -503,7 +551,7 @@\n         affected functions.\n       o Improved platform support for PowerPC.\n       o New FIPS 180-2 algorithms (SHA-224, -256, -384 and -512).\n-      o New X509_VERIFY_PARAM structure to support parametrisation\n+      o New X509_VERIFY_PARAM structure to support parameterisation\n         of X.509 path validation.\n       o Major overhaul of RC4 performance on Intel P4, IA-64 and\n         AMD64.\n@@ -590,7 +638,7 @@\n   Major changes between OpenSSL 0.9.7a and OpenSSL 0.9.7b [10 Apr 2003]:\n \n       o Security: counter the Klima-Pokorny-Rosa extension of\n-        Bleichbacher's attack \n+        Bleichbacher's attack\n       o Security: make RSA blinding default.\n       o Configuration: Irix fixes, AIX fixes, better mingw support.\n       o Support for new platforms: linux-ia64-ecc.\n@@ -650,7 +698,7 @@\n       o SSL/TLS: allow optional cipher choice according to server's preference.\n       o SSL/TLS: allow server to explicitly set new session ids.\n       o SSL/TLS: support Kerberos cipher suites (RFC2712).\n-\tOnly supports MIT Kerberos for now.\n+        Only supports MIT Kerberos for now.\n       o SSL/TLS: allow more precise control of renegotiations and sessions.\n       o SSL/TLS: add callback to retrieve SSL/TLS messages.\n       o SSL/TLS: support AES cipher suites (RFC3268).\n@@ -663,7 +711,7 @@\n   Major changes between OpenSSL 0.9.6i and OpenSSL 0.9.6j [10 Apr 2003]:\n \n       o Security: counter the Klima-Pokorny-Rosa extension of\n-        Bleichbacher's attack \n+        Bleichbacher's attack\n       o Security: make RSA blinding default.\n       o Build: shared library support fixes.\n \n@@ -775,7 +823,7 @@\n \n   Major changes between OpenSSL 0.9.5 and OpenSSL 0.9.5a [1 Apr 2000]:\n \n-      o Bug fixes for Win32, SuSE Linux, NeXTSTEP and FreeBSD 2.2.8 \n+      o Bug fixes for Win32, SuSE Linux, NeXTSTEP and FreeBSD 2.2.8\n       o Shared library support for HPUX and Solaris-gcc\n       o Support of Linux/IA64\n       o Assembler support for Mingw32\n@@ -789,7 +837,7 @@\n       o Automation of 'req' application\n       o Fixes to make s_client, s_server work under Windows\n       o Support for multiple fieldnames in SPKACs\n-      o New SPKAC command line utilty and associated library functions\n+      o New SPKAC command line utility and associated library functions\n       o Options to allow passwords to be obtained from various sources\n       o New public key PEM format and options to handle it\n       o Many other fixes and enhancements to command line utilities\n@@ -871,8 +919,7 @@\n       o Added BIO proxy and filtering functionality\n       o Extended Big Number (BN) library\n       o Added RIPE MD160 message digest\n-      o Addeed support for RC2/64bit cipher\n+      o Added support for RC2/64bit cipher\n       o Extended ASN.1 parser routines\n-      o Adjustations of the source tree for CVS\n+      o Adjustments of the source tree for CVS\n       o Support for various new platforms\n-"
        },
        {
            "sha": "bbbd8e4db9218c42e5275aecce62b24fbfb73757",
            "filename": "deps/openssl/openssl/NOTES.ANDROID",
            "status": "added",
            "additions": 76,
            "deletions": 0,
            "changes": 76,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNOTES.ANDROID",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNOTES.ANDROID",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FNOTES.ANDROID?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,76 @@\n+\n+ NOTES FOR ANDROID PLATFORMS\n+ ===========================\n+\n+ Requirement details\n+ -------------------\n+\n+ Beside basic tools like perl and make you'll need to download the Android\n+ NDK. It's available for Linux, Mac OS X and Windows, but only Linux\n+ version was actually tested. There is no reason to believe that Mac OS X\n+ wouldn't work. And as for Windows, it's unclear which \"shell\" would be\n+ suitable, MSYS2 might have best chances. NDK version should play lesser\n+ role, the goal is to support a range of most recent versions.\n+\n+ Configuration\n+ -------------\n+\n+ Android is naturally cross-compiled target and you can't use ./config.\n+ You have to use ./Configure and name your target explicitly; there are\n+ android-arm, android-arm64, android-mips, android-mip64, android-x86\n+ and android-x86_64. Do not pass --cross-compile-prefix (as you might\n+ be tempted), as it will be \"calculated\" automatically based on chosen\n+ platform. Though you still need to know the prefix to extend your PATH,\n+ in order to invoke $(CROSS_COMPILE)gcc and company. (Configure will fail\n+ and give you a hint if you get it wrong.) Apart from PATH adjustment\n+ you need to set ANDROID_NDK environment to point at NDK directory\n+ as /some/where/android-ndk-<ver>. Both variables are significant at both\n+ configuration and compilation times. NDK customarily supports multiple\n+ Android API levels, e.g. android-14, android-21, etc. By default latest \n+ one available is chosen. If you need to target older platform, pass\n+ additional -D__ANDROID_API__=N to Configure. N is numeric value of the\n+ target platform version. For example, to compile for ICS on ARM with\n+ NDK 10d:\n+\n+    export ANDROID_NDK=/some/where/android-ndk-10d\n+    PATH=$ANDROID_NDK/toolchains/arm-linux-androideabi-4.8/prebuilt/linux-x86_64/bin:$PATH\n+    ./Configure android-arm -D__ANDROID_API__=14\n+    make\n+\n+ Caveat lector! Earlier OpenSSL versions relied on additional CROSS_SYSROOT\n+ variable set to $ANDROID_NDK/platforms/android-<api>/arch-<arch> to\n+ appoint headers-n-libraries' location. It's still recognized in order\n+ to facilitate migration from older projects. However, since API level\n+ appears in CROSS_SYSROOT value, passing -D__ANDROID_API__=N can be in\n+ conflict, and mixing the two is therefore not supported. Migration to\n+ CROSS_SYSROOT-less setup is recommended.\n+\n+ One can engage clang by adjusting PATH to cover same NDK's clang. Just\n+ keep in mind that if you miss it, Configure will try to use gcc...\n+ Also, PATH would need even further adjustment to cover unprefixed, yet\n+ target-specific, ar and ranlib. It's possible that you don't need to\n+ bother, if binutils-multiarch is installed on your Linux system.\n+\n+ Another option is to create so called \"standalone toolchain\" tailored\n+ for single specific platform including Android API level, and assign its\n+ location to ANDROID_NDK. In such case you have to pass matching target\n+ name to Configure and shouldn't use -D__ANDROID_API__=N. PATH adjusment\n+ becomes simpler, $ANDROID_NDK/bin:$PATH suffices.\n+\n+ Running tests (on Linux)\n+ ------------------------\n+\n+ This is not actually supported. Notes are meant rather as inspiration.\n+\n+ Even though build output targets alien system, it's possible to execute\n+ test suite on Linux system by employing qemu-user. The trick is static\n+ linking. Pass -static to Configure, then edit generated Makefile and\n+ remove occurrences of -ldl and -pie flags. You would also need to pick\n+ API version that comes with usable static libraries, 42/2=21 used to\n+ work. Once built, you should be able to\n+\n+    env EXE_SHELL=qemu-<arch> make test\n+\n+ If you need to pass additional flag to qemu, quotes are your friend, e.g.\n+\n+    env EXE_SHELL=\"qemu-mips64el -cpu MIPS64R6-generic\" make test"
        },
        {
            "sha": "6c291cbab6fdfca6099f0323fb8fe403daa1cebd",
            "filename": "deps/openssl/openssl/NOTES.UNIX",
            "status": "modified",
            "additions": 105,
            "deletions": 18,
            "changes": 123,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNOTES.UNIX",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNOTES.UNIX",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FNOTES.UNIX?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -5,26 +5,113 @@\n  For Unix/POSIX runtime systems on Windows, please see NOTES.WIN.\n \n \n- Shared libraries and installation in non-standard locations\n- -----------------------------------------------------------\n-\n- Binaries on Unix variants expect to find shared libraries in standard\n- locations, such as /usr/lib, /usr/local/lib and some other locations\n- configured in the system (for example /etc/ld.so.conf on some systems).\n- If the libraries are installed in non-standard locations, binaries\n- will not find them and therefore fail to run unless they get a bit of\n- help from a defined RPATH or RUNPATH.  This can be applied by adding\n- the appropriate linker flags to the configuration command, such as\n- this (/usr/local/ssl was the default location for OpenSSL installation\n- in versions before 1.1.0):\n+ OpenSSL uses the compiler to link programs and shared libraries\n+ ---------------------------------------------------------------\n+\n+ OpenSSL's generated Makefile uses the C compiler command line to\n+ link programs, shared libraries and dynamically loadable shared\n+ objects.  Because of this, any linking option that's given to the\n+ configuration scripts MUST be in a form that the compiler can accept.\n+ This varies between systems, where some have compilers that accept\n+ linker flags directly, while others take them in '-Wl,' form.  You need\n+ to read your compiler documentation to figure out what is acceptable,\n+ and ld(1) to figure out what linker options are available.\n+\n+\n+ Shared libraries and installation in non-default locations\n+ ----------------------------------------------------------\n+\n+ Every Unix system has its own set of default locations for shared\n+ libraries, such as /lib, /usr/lib or possibly /usr/local/lib.  If\n+ libraries are installed in non-default locations, dynamically linked\n+ binaries will not find them and therefore fail to run, unless they get\n+ a bit of help from a defined runtime shared library search path.\n+\n+ For OpenSSL's application (the 'openssl' command), our configuration\n+ scripts do NOT generally set the runtime shared library search path for\n+ you.  It's therefore advisable to set it explicitly when configuring,\n+ unless the libraries are to be installed in directories that you know\n+ to be in the default list.\n+\n+ Runtime shared library search paths are specified with different\n+ linking options depending on operating system and versions thereof, and\n+ are talked about differently in their respective documentation;\n+ variations of RPATH are the most usual (note: ELF systems have two such\n+ tags, more on that below).\n+\n+ Possible options to set the runtime shared library search path include\n+ the following:\n+\n+    -Wl,-rpath,/whatever/path\t# Linux, *BSD, etc.\n+    -R /whatever/path\t\t# Solaris\n+    -Wl,-R,/whatever/path\t# AIX (-bsvr4 is passed internally)\n+    -Wl,+b,/whatever/path\t# HP-UX\n+    -rpath /whatever/path\t# Tru64, IRIX\n+\n+ OpenSSL's configuration scripts recognise all these options and pass\n+ them to the Makefile that they build. (In fact, all arguments starting\n+ with '-Wl,' are recognised as linker options.)\n+\n+ Please do not use verbatim directories in your runtime shared library\n+ search path!  Some OpenSSL config targets add an extra directory level\n+ for multilib installations.  To help with that, the produced Makefile\n+ includes the variable LIBRPATH, which is a convenience variable to be\n+ used with the runtime shared library search path options, as shown in\n+ this example:\n \n     $ ./config --prefix=/usr/local/ssl --openssldir=/usr/local/ssl \\\n-        -Wl,-rpath,/usr/local/ssl/lib\n+        '-Wl,-rpath,$(LIBRPATH)'\n+\n+ On modern ELF based systems, there are two runtime search paths tags to\n+ consider, DT_RPATH and DT_RUNPATH.  Shared objects are searched for in\n+ this order:\n+\n+    1. Using directories specified in DT_RPATH, unless DT_RUNPATH is\n+       also set.\n+    2. Using the environment variable LD_LIBRARY_PATH\n+    3. Using directories specified in DT_RUNPATH.\n+    4. Using system shared object caches and default directories.\n+\n+ This means that the values in the environment variable LD_LIBRARY_PATH\n+ won't matter if the library is found in the paths given by DT_RPATH\n+ (and DT_RUNPATH isn't set).\n+\n+ Exactly which of DT_RPATH or DT_RUNPATH is set by default appears to\n+ depend on the system.  For example, according to documentation,\n+ DT_RPATH appears to be deprecated on Solaris in favor of DT_RUNPATH,\n+ while on Debian GNU/Linux, either can be set, and DT_RPATH is the\n+ default at the time of writing.\n \n- Because the actual library location may vary further (for example on\n- multilib installations), there is a convenience variable in Makefile\n- that holds the exact installation directory and that can be used like\n- this:\n+ How to choose which runtime search path tag is to be set depends on\n+ your system, please refer to ld(1) for the exact information on your\n+ system.  As an example, the way to ensure the DT_RUNPATH is set on\n+ Debian GNU/Linux systems rather than DT_RPATH is to tell the linker to\n+ set new dtags, like this:\n \n     $ ./config --prefix=/usr/local/ssl --openssldir=/usr/local/ssl \\\n-        -Wl,-rpath,'$(LIBRPATH)'\n+        '-Wl,--enable-new-dtags,-rpath,$(LIBRPATH)'\n+\n+ It might be worth noting that some/most ELF systems implement support\n+ for runtime search path relative to the directory containing current\n+ executable, by interpreting $ORIGIN along with some other internal\n+ variables. Consult your system documentation.\n+\n+ Linking your application\n+ ------------------------\n+\n+ Third-party applications dynamically linked with OpenSSL (or any other)\n+ shared library face exactly the same problem with non-default locations.\n+ The OpenSSL config options mentioned above might or might not have bearing\n+ on linking of the target application. \"Might\" means that under some\n+ circumstances it would be sufficient to link with OpenSSL shared library\n+ \"naturally\", i.e. with -L/whatever/path -lssl -lcrypto. But there are\n+ also cases when you'd have to explicitly specify runtime search path\n+ when linking your application. Consult your system documentation and use\n+ above section as inspiration...\n+\n+ Shared OpenSSL builds also install static libraries. Linking with the\n+ latter is likely to require special care, because linkers usually look\n+ for shared libraries first and tend to remain \"blind\" to static OpenSSL\n+ libraries. Referring to system documentation would suffice, if not for\n+ a corner case. On AIX static libraries (in shared build) are named\n+ differently, add _a suffix to link with them, e.g. -lcrypto_a."
        },
        {
            "sha": "98def0689a77a286c2fd7943fdac6354346dbbc6",
            "filename": "deps/openssl/openssl/NOTES.VMS",
            "status": "modified",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNOTES.VMS",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNOTES.VMS",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FNOTES.VMS?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -56,6 +56,32 @@\n  to use.\n \n \n+ About debugging\n+ ---------------\n+\n+ If you build for debugging, the default on VMS is that image\n+ activation starts the debugger automatically, giving you a debug\n+ prompt.  Unfortunately, this disrupts all other uses, such as running\n+ test programs in the test framework.\n+\n+ Generally speaking, if you build for debugging, only use the programs\n+ directly for debugging.  Do not try to use them from a script, such\n+ as running the test suite.\n+\n+ *The following is not available on Alpha*\n+\n+ As a compromise, we're turning off the flag that makes the debugger\n+ start automatically.  If there is a program that you need to debug,\n+ you need to turn that flag back on first, for example:\n+\n+    $ set image /flag=call_debug [.test]evp_test.exe\n+\n+ Then just run it and you will find yourself in a debugging session.\n+ When done, we recommend that you turn that flag back off:\n+\n+    $ set image /flag=nocall_debug [.test]evp_test.exe\n+\n+\n  Checking the distribution\n  -------------------------\n "
        },
        {
            "sha": "4d39d06f32ad10229318708c80d9454157ff234b",
            "filename": "deps/openssl/openssl/NOTES.WIN",
            "status": "modified",
            "additions": 86,
            "deletions": 60,
            "changes": 146,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNOTES.WIN",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FNOTES.WIN",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FNOTES.WIN?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -2,32 +2,60 @@\n  NOTES FOR THE WINDOWS PLATFORMS\n  ===============================\n \n- Requirement details for native (Visual C++) builds\n- --------------------------------------------------\n+ Windows targets can be classified as \"native\", ones that use Windows API\n+ directly, and \"hosted\" which rely on POSIX-compatible layer. \"Native\"\n+ targets are VC-* (where \"VC\" stems from abbreviating Microsoft Visual C\n+ compiler) and mingw[64]. \"Hosted\" platforms are Cygwin and MSYS[2]. Even\n+ though the latter is not directly supported by OpenSSL Team, it's #1\n+ popular choice for building MinGW targets. In the nutshell MinGW builds\n+ are always cross-compiled. On Linux and Cygwin they look exactly as such\n+ and require --cross-compile-prefix option. While on MSYS[2] it's solved\n+ rather by placing gcc that produces \"MinGW binary\" code 1st on $PATH.\n+ This is customarily source of confusion. \"Hosted\" applications \"live\" in\n+ emulated file system name space with POSIX-y root, mount points, /dev\n+ and even /proc. Confusion is intensified by the fact that MSYS2 shell\n+ (or rather emulated execve(2) call) examines the binary it's about to\n+ start, and if it's found *not* to be linked with MSYS2 POSIX-y thing,\n+ command line arguments that look like file names get translated from\n+ emulated name space to \"native\". For example '/c/some/where' becomes\n+ 'c:\\some\\where', '/dev/null' - 'nul'. This creates an illusion that\n+ there is no difference between MSYS2 shell and \"MinGW binary\", but\n+ there is. Just keep in mind that \"MinGW binary\" \"experiences\" Windows\n+ system in exactly same way as one produced by VC, and in its essence\n+ is indistinguishable from the latter. (Which by the way is why\n+ it's referred to in quotes here, as \"MinGW binary\", it's just as\n+ \"native\" as it can get.)\n+\n+ Visual C++ builds, a.k.a. VC-*\n+ ==============================\n+\n+ Requirement details\n+ -------------------\n \n  In addition to the requirements and instructions listed in INSTALL,\n- this are required as well:\n+ these are required as well:\n \n- - You need Perl.  We recommend ActiveState Perl, available from\n+ - Perl. We recommend ActiveState Perl, available from\n    https://www.activestate.com/ActivePerl. Another viable alternative\n    appears to be Strawberry Perl, http://strawberryperl.com.\n    You also need the perl module Text::Template, available on CPAN.\n    Please read NOTES.PERL for more information.\n \n- - You need a C compiler.  OpenSSL has been tested to build with these:\n+ - Microsoft Visual C compiler. Since we can't test them all, there is\n+   unavoidable uncertainty about which versions are supported. Latest\n+   version along with couple of previous are certainly supported. On\n+   the other hand oldest one is known not to work. Everything between\n+   falls into best-effort category.\n \n-   * Visual C++\n+ - Netwide Assembler, a.k.a. NASM, available from https://www.nasm.us,\n+   is required. Note that NASM is the only supported assembler. Even\n+   though Microsoft provided assembler is NOT supported, contemporary\n+   64-bit version is exercised through continuous integration of\n+   VC-WIN64A-masm target.\n \n- - Netwide Assembler, a.k.a. NASM, available from http://www.nasm.us,\n-   is required if you intend to utilize assembler modules. Note that NASM\n-   is the only supported assembler. The Microsoft provided assembler is NOT\n-   supported.\n-\n-\n- Visual C++ (native Windows)\n- ---------------------------\n \n  Installation directories\n+ ------------------------\n \n  The default installation directories are derived from environment\n  variables.\n@@ -55,62 +83,36 @@\n  is, of course, to choose a different set of directories by using\n  --prefix and --openssldir when configuring.\n \n- GNU C (Cygwin)\n- --------------\n-\n- Cygwin implements a Posix/Unix runtime system (cygwin1.dll) on top of the\n- Windows subsystem and provides a bash shell and GNU tools environment.\n- Consequently, a make of OpenSSL with Cygwin is virtually identical to the\n- Unix procedure.\n-\n- To build OpenSSL using Cygwin, you need to:\n-\n- * Install Cygwin (see https://cygwin.com/)\n-\n- * Install Cygwin Perl and ensure it is in the path. Recall that\n-   as least 5.10.0 is required.\n-\n- * Run the Cygwin bash shell\n-\n- Apart from that, follow the Unix instructions in INSTALL.\n-\n- NOTE: \"make test\" and normal file operations may fail in directories\n- mounted as text (i.e. mount -t c:\\somewhere /home) due to Cygwin\n- stripping of carriage returns. To avoid this ensure that a binary\n- mount is used, e.g. mount -b c:\\somewhere /home.\n-\n- It is also possible to create \"conventional\" Windows binaries that use\n- the Microsoft C runtime system (msvcrt.dll or crtdll.dll) using MinGW\n- development add-on for Cygwin. MinGW is supported even as a standalone\n- setup as described in the following section. In the context you should\n- recognize that binaries targeting Cygwin itself are not interchangeable\n- with \"conventional\" Windows binaries you generate with/for MinGW.\n+ mingw and mingw64\n+ =================\n \n+ * MSYS2 shell and development environment installation:\n \n- GNU C (MinGW/MSYS)\n- ------------------\n+   Download MSYS2 from https://msys2.github.io/ and follow installation\n+   instructions. Once up and running install even make, perl, (git if\n+   needed,) mingw-w64-i686-gcc and/or mingw-w64-x86_64-gcc. You should\n+   have corresponding MinGW items on your start menu, use *them*, not\n+   generic MSYS2. As implied in opening note, difference between them\n+   is which compiler is found 1st on $PATH. At this point ./config\n+   should recognize correct target, roll as if it was Unix...\n \n- * Compiler and shell environment installation:\n+ * It is also possible to build mingw[64] on Linux or Cygwin by\n+   configuring with corresponding --cross-compile-prefix= option. For\n+   example\n \n-   MinGW and MSYS are available from http://www.mingw.org/, both are\n-   required. Run the installers and do whatever magic they say it takes\n-   to start MSYS bash shell with GNU tools and matching Perl on its PATH.\n-   \"Matching Perl\" refers to chosen \"shell environment\", i.e. if built\n-   under MSYS, then Perl compiled for MSYS must be used.\n+     ./Configure mingw --cross-compile-prefix=i686-w64-mingw32- ...\n \n-   Alternatively, one can use MSYS2 from https://msys2.github.io/,\n-   which includes MingW (32-bit and 64-bit).\n+   or\n \n- * It is also possible to cross-compile it on Linux by configuring\n-   with './Configure --cross-compile-prefix=i386-mingw32- mingw ...'.\n-   Other possible cross compile prefixes include x86_64-w64-mingw32-\n-   and i686-w64-mingw32-.\n+     ./Configure mingw64 --cross-compile-prefix=x86_64-w64-mingw32- ...\n \n+   This naturally implies that you've installed corresponding add-on\n+   packages.\n \n  Linking your application\n- ------------------------\n+ ========================\n \n- This section applies to non-Cygwin builds.\n+ This section applies to all \"native\" builds.\n \n  If you link with static OpenSSL libraries then you're expected to\n  additionally link your application with WS2_32.LIB, GDI32.LIB,\n@@ -137,3 +139,27 @@\n  your application code small \"shim\" snippet, which provides glue between\n  OpenSSL BIO layer and your compiler run-time. See the OPENSSL_Applink\n  manual page for further details.\n+\n+ Cygwin, \"hosted\" environment\n+ ============================\n+\n+ Cygwin implements a Posix/Unix runtime system (cygwin1.dll) on top of the\n+ Windows subsystem and provides a bash shell and GNU tools environment.\n+ Consequently, a make of OpenSSL with Cygwin is virtually identical to the\n+ Unix procedure.\n+\n+ To build OpenSSL using Cygwin, you need to:\n+\n+ * Install Cygwin (see https://cygwin.com/)\n+\n+ * Install Cygwin Perl and ensure it is in the path. Recall that\n+   as least 5.10.0 is required.\n+\n+ * Run the Cygwin bash shell\n+\n+ Apart from that, follow the Unix instructions in INSTALL.\n+\n+ NOTE: \"make test\" and normal file operations may fail in directories\n+ mounted as text (i.e. mount -t c:\\somewhere /home) due to Cygwin\n+ stripping of carriage returns. To avoid this ensure that a binary\n+ mount is used, e.g. mount -b c:\\somewhere /home."
        },
        {
            "sha": "affb172e8ba8241dbaeae66eb0bc3d7416f81841",
            "filename": "deps/openssl/openssl/README",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FREADME",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FREADME",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FREADME?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n \n- OpenSSL 1.1.0j 20 Nov 2018\n+ OpenSSL 1.1.1a 20 Nov 2018\n \n  Copyright (c) 1998-2018 The OpenSSL Project\n  Copyright (c) 1995-1998 Eric A. Young, Tim J. Hudson\n@@ -62,14 +62,13 @@\n     - Download the latest version from the repository\n       to see if the problem has already been addressed\n     - Configure with no-asm\n-    - Remove compiler optimisation flags\n+    - Remove compiler optimization flags\n \n  If you wish to report a bug then please include the following information\n  and create an issue on GitHub:\n \n     - OpenSSL version: output of 'openssl version -a'\n-    - Any \"Configure\" options that you selected during compilation of the\n-      library if applicable (see INSTALL)\n+    - Configuration data: output of 'perl configdata.pm --dump'\n     - OS Name, Version, Hardware platform\n     - Compiler Details (name, version)\n     - Application Details (name, version)"
        },
        {
            "sha": "fa3cad7aa7f08c47bcad0ffeffa77e04ea349bcc",
            "filename": "deps/openssl/openssl/README.ECC",
            "status": "removed",
            "additions": 0,
            "deletions": 61,
            "changes": 61,
            "blob_url": "https://github.com/nodejs/node/blob/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2FREADME.ECC",
            "raw_url": "https://github.com/nodejs/node/raw/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2FREADME.ECC",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FREADME.ECC?ref=5d80f9ea6091847176fa47fb1395fdffc4af9164",
            "patch": "@@ -1,61 +0,0 @@\n-NOTE: The OpenSSL Software Foundation has executed a sublicense agreement\n-entitled \"Elliptic Curve Cryptography Patent License Agreement\" with the\n-National Security Agency/ Central Security Service Commercial Solutions\n-Center (NCSC) dated 2010-11-04. That agreement permits implementation and\n-distribution of software containing features covered by any or all of the\n-following patents:\n-\n-1.) U.S. Pat. No. 5,761,305 entitled \"Key Agreement and Transport Protocol \n-    with Implicit Signatures\" issued on June 2, 1998;\n-2.) Can. Pat. Appl. Ser. No. 2176972 entitled \"Key Agreement and Transport \n-    Protocol with Implicit Signature and Reduced Bandwidth\" filed on May \n-    16, 1996;\n-3.) U.S. Pat. No. 5,889,865 entitled \"Key Agreement and Transport Protocol \n-    with Implicit Signatures\" issued on March 30, 1999;\n-4.) U.S. Pat. No. 5,896,455 entitled \"Key Agreement and Transport Protocol \n-    with Implicit Signatures\" issued on April 20, 1999;\n-5.) U.S. Pat. No. 5,933,504 entitled \"Strengthened Public Key Protocol\" \n-    issued on August 3, 1999;\n-6.) Can. Pat. Appl. Ser. No. 2176866 entitled \"Strengthened Public Key \n-    Protocol\" filed on May 17, 1996;\n-7.) E.P. Pat. Appl. Ser. No. 96201322.3 entitled \"Strengthened Public Key \n-    Protocol\" filed on May 17, 1996;\n-8.) U.S. Pat. No. 5,999,626 entitled \"Digital Signatures on a Smartcard\" \n-    issued on December 7, 1999;\n-9.) Can. Pat. Appl. Ser. No. 2202566 entitled \"Digital Signatures on a \n-    Smartcard\" filed on April 14, 1997;\n-10.) E.P. Pat. Appl. No. 97106114.8 entitled \"Digital Signatures on a \n-     Smartcard\" filed on April 15, 1997;\n-11.) U.S Pat. No. 6,122,736 entitled \"Key Agreement and Transport Protocol \n-     with Implicit Signatures\" issued on September 19, 2000;\n-12.) Can. Pat. Appl. Ser. No. 2174261 entitled \"Key Agreement and Transport \n-     Protocol with Implicit Signatures\" filed on April 16, 1996;\n-13.) E.P. Pat. Appl. Ser. No. 96105920.1 entitled \"Key Agreement and \n-     Transport Protocol with Implicit Signatures\" filed on April 16, 1996;\n-14.) U.S. Pat. No. 6,141,420 entitled \"Elliptic Curve Encryption Systems\" \n-     issued on October 31, 2000;\n-15.) Can. Pat. Appl. Ser. No. 2155038 entitled \"Elliptic Curve Encryption \n-     Systems\" filed on July 31, 1995;\n-16.) E.P. Pat. Appl. Ser. No. 95926348.4 entitled \"Elliptic Curve Encryption \n-     Systems\" filed on July 31, 1995;\n-17.) U.S. Pat. No. 6,336,188 entitled \"Authenticated Key Agreement\" issued \n-     on January 1, 2002;\n-18.) U.S. Pat. No. 6,487,661 entitled \"Key Agreement and Transport Protocol\" \n-     issued on November 26, 2002;\n-19.) Can. Pat. Appl. Ser. No. 2174260 entitled \"Key Agreement and Transport \n-     Protocol\" filed on April 16, 1996;\n-20.) E.P. Pat. Appl. Ser. No. 96105921.9 entitled \"Key Agreement and \n-     Transport Protocol\" filed on April 21, 1996;\n-21.) U.S. Pat. No. 6,563,928 entitled \"Strengthened Public Key Protocol\" \n-     issued on May 13, 2003;\n-22.) U.S. Pat. No. 6,618,483 entitled \"Elliptic Curve Encryption Systems\" \n-     issued September 9, 2003;\n-23.) U.S. Pat. Appl. Ser. No. 09/434,247 entitled \"Digital Signatures on a \n-     Smartcard\" filed on November 5, 1999;\n-24.) U.S. Pat. Appl. Ser. No. 09/558,256 entitled \"Key Agreement and \n-     Transport Protocol with Implicit Signatures\" filed on April 25, 2000;\n-25.) U.S. Pat. Appl. Ser. No. 09/942,492 entitled \"Digital Signatures on a \n-     Smartcard\" filed on August 29, 2001 and published on July 18, 2002; and,\n-26.) U.S. Pat. Appl. Ser. No. 10/185,735 entitled \"Strengthened Public Key \n-     Protocol\" filed on July 1, 2000.\n-"
        },
        {
            "sha": "230dc82a87ba72b8c5ce0bbebf87f2ecdf669c2a",
            "filename": "deps/openssl/openssl/README.ENGINE",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FREADME.ENGINE",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FREADME.ENGINE",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FREADME.ENGINE?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -13,7 +13,6 @@\n   There are currently built-in ENGINE implementations for the following\n   crypto devices:\n \n-      o Cryptodev\n       o Microsoft CryptoAPI\n       o VIA Padlock\n       o nCipher CHIL"
        },
        {
            "sha": "9725023a3122df3ea698e4308f6205329302173a",
            "filename": "deps/openssl/openssl/VMS/engine.opt",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FVMS%2Fengine.opt",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FVMS%2Fengine.opt",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FVMS%2Fengine.opt?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,2 +1,3 @@\n CASE_SENSITIVE=YES\n-SYMBOL_VECTOR=(bind_engine=PROCEDURE,v_check=PROCEDURE)\n+SYMBOL_VECTOR=(BIND_ENGINE=PROCEDURE,V_CHECK=PROCEDURE,-\n+               bind_engine/BIND_ENGINE=PROCEDURE,v_check/V_CHECK=PROCEDURE)"
        },
        {
            "sha": "fd4e3d5086d2c62b4766e3a4173a233f275b3a07",
            "filename": "deps/openssl/openssl/VMS/openssl_shutdown.com.in",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FVMS%2Fopenssl_shutdown.com.in",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FVMS%2Fopenssl_shutdown.com.in",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FVMS%2Fopenssl_shutdown.com.in?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -26,7 +26,7 @@ $\tENDIF\n $\n $\t! Abbrevs\n $\tDEAS := DEASSIGN /NOLOG 'P1'\n-$\tsv   := {- sprintf \"%02d%02d\", $config{shlib_major}, $config{shlib_minor} -}\n+$\tsv   := {- sprintf \"%02d%02d\", split m|\\.|, $config{shlib_version_number} -}\n $\tpz   := {- $config{pointer_size} -}\n $\n $\tDEAS OSSL$DATAROOT"
        },
        {
            "sha": "9e6e1c0b35bea0731ced801bd83bf854ea69fa99",
            "filename": "deps/openssl/openssl/VMS/openssl_startup.com.in",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FVMS%2Fopenssl_startup.com.in",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2FVMS%2Fopenssl_startup.com.in",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2FVMS%2Fopenssl_startup.com.in?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -88,7 +88,7 @@ $\n $\t! Abbrevs\n $\tDEFT := DEFINE /TRANSLATION=CONCEALED /NOLOG 'P1'\n $\tDEF  := DEFINE /NOLOG 'P1'\n-$\tsv   := {- sprintf \"%02d%02d\", $config{shlib_major}, $config{shlib_minor} -}\n+$\tsv   := {- sprintf \"%02d%02d\", split m|\\.|, $config{shlib_version_number} -}\n $\tpz   := {- $config{pointer_size} -}\n $\n $\tDEFT OSSL$DATAROOT\t\t'OPENSSLDIR_']"
        },
        {
            "sha": "db3cc383189e6ac4c8d873baabf2433731fb0930",
            "filename": "deps/openssl/openssl/apps/CA.pl.in",
            "status": "modified",
            "additions": 41,
            "deletions": 23,
            "changes": 64,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2FCA.pl.in",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2FCA.pl.in",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2FCA.pl.in?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n-#!{- $config{hashbangperl} -}\n-# Copyright 2000-2016 The OpenSSL Project Authors. All Rights Reserved.\n+#!{- $config{HASHBANGPERL} -}\n+# Copyright 2000-2018 The OpenSSL Project Authors. All Rights Reserved.\n #\n # Licensed under the OpenSSL license (the \"License\").  You may not use\n # this file except in compliance with the License.  You can obtain a copy\n@@ -46,8 +46,25 @@ my $NEWCERT = \"newcert.pem\";\n my $NEWP12 = \"newcert.p12\";\n my $RET = 0;\n my $WHAT = shift @ARGV || \"\";\n+my @OPENSSL_CMDS = (\"req\", \"ca\", \"pkcs12\", \"x509\", \"verify\");\n+my %EXTRA = extra_args(\\@ARGV, \"-extra-\");\n my $FILE;\n \n+sub extra_args {\n+    my ($args_ref, $arg_prefix) = @_;\n+    my %eargs = map {\n+\tif ($_ < $#$args_ref) {\n+\t    my ($arg, $value) = splice(@$args_ref, $_, 2);\n+\t    $arg =~ s/$arg_prefix//;\n+\t    ($arg, $value);\n+\t} else {\n+\t    ();\n+\t}\n+    } reverse grep($$args_ref[$_] =~ /$arg_prefix/, 0..$#$args_ref);\n+    my %empty = map { ($_, \"\") } @OPENSSL_CMDS;\n+    return (%empty, %eargs);\n+}\n+\n # See if reason for a CRL entry is valid; exit if not.\n sub crl_reason_ok\n {\n@@ -96,22 +113,23 @@ sub run\n \n \n if ( $WHAT =~ /^(-\\?|-h|-help)$/ ) {\n-    print STDERR \"usage: CA -newcert|-newreq|-newreq-nodes|-newca|-sign|-signcert|-verify\\n\";\n-    print STDERR \"       CA -pkcs12 [certname]\\n\";\n-    print STDERR \"       CA -crl|-revoke cert-filename [reason]\\n\";\n+    print STDERR \"usage: CA.pl -newcert | -newreq | -newreq-nodes | -xsign | -sign | -signCA | -signcert | -crl | -newca [-extra-cmd extra-params]\\n\";\n+    print STDERR \"       CA.pl -pkcs12 [-extra-pkcs12 extra-params] [certname]\\n\";\n+    print STDERR \"       CA.pl -verify [-extra-verify extra-params] certfile ...\\n\";\n+    print STDERR \"       CA.pl -revoke [-extra-ca extra-params] certfile [reason]\\n\";\n     exit 0;\n }\n if ($WHAT eq '-newcert' ) {\n     # create a certificate\n-    $RET = run(\"$REQ -new -x509 -keyout $NEWKEY -out $NEWCERT $DAYS\");\n+    $RET = run(\"$REQ -new -x509 -keyout $NEWKEY -out $NEWCERT $DAYS $EXTRA{req}\");\n     print \"Cert is in $NEWCERT, private key is in $NEWKEY\\n\" if $RET == 0;\n-} elsif ($WHAT eq '-newreq' ) {\n-    # create a certificate request\n-    $RET = run(\"$REQ -new -keyout $NEWKEY -out $NEWREQ $DAYS\");\n-    print \"Request is in $NEWREQ, private key is in $NEWKEY\\n\" if $RET == 0;\n-} elsif ($WHAT eq '-newreq-nodes' ) {\n+} elsif ($WHAT eq '-precert' ) {\n+    # create a pre-certificate\n+    $RET = run(\"$REQ -x509 -precert -keyout $NEWKEY -out $NEWCERT $DAYS\");\n+    print \"Pre-cert is in $NEWCERT, private key is in $NEWKEY\\n\" if $RET == 0;\n+} elsif ($WHAT =~ /^\\-newreq(\\-nodes)?$/ ) {\n     # create a certificate request\n-    $RET = run(\"$REQ -new -nodes -keyout $NEWKEY -out $NEWREQ $DAYS\");\n+    $RET = run(\"$REQ -new $1 -keyout $NEWKEY -out $NEWREQ $DAYS $EXTRA{req}\");\n     print \"Request is in $NEWREQ, private key is in $NEWKEY\\n\" if $RET == 0;\n } elsif ($WHAT eq '-newca' ) {\n     # create the directory hierarchy\n@@ -136,11 +154,11 @@ if ($WHAT eq '-newcert' ) {\n         print \"Making CA certificate ...\\n\";\n         $RET = run(\"$REQ -new -keyout\"\n                 . \" ${CATOP}/private/$CAKEY\"\n-                . \" -out ${CATOP}/$CAREQ\");\n+                . \" -out ${CATOP}/$CAREQ $EXTRA{req}\");\n         $RET = run(\"$CA -create_serial\"\n                 . \" -out ${CATOP}/$CACERT $CADAYS -batch\"\n                 . \" -keyfile ${CATOP}/private/$CAKEY -selfsign\"\n-                . \" -extensions v3_ca\"\n+                . \" -extensions v3_ca $EXTRA{ca}\"\n                 . \" -infiles ${CATOP}/$CAREQ\") if $RET == 0;\n         print \"CA certificate is in ${CATOP}/$CACERT\\n\" if $RET == 0;\n     }\n@@ -150,32 +168,32 @@ if ($WHAT eq '-newcert' ) {\n     $RET = run(\"$PKCS12 -in $NEWCERT -inkey $NEWKEY\"\n             . \" -certfile ${CATOP}/$CACERT\"\n             . \" -out $NEWP12\"\n-            . \" -export -name \\\"$cname\\\"\");\n+            . \" -export -name \\\"$cname\\\" $EXTRA{pkcs12}\");\n     print \"PKCS #12 file is in $NEWP12\\n\" if $RET == 0;\n } elsif ($WHAT eq '-xsign' ) {\n-    $RET = run(\"$CA -policy policy_anything -infiles $NEWREQ\");\n+    $RET = run(\"$CA -policy policy_anything $EXTRA{ca} -infiles $NEWREQ\");\n } elsif ($WHAT eq '-sign' ) {\n-    $RET = run(\"$CA -policy policy_anything -out $NEWCERT -infiles $NEWREQ\");\n+    $RET = run(\"$CA -policy policy_anything -out $NEWCERT $EXTRA{ca} -infiles $NEWREQ\");\n     print \"Signed certificate is in $NEWCERT\\n\" if $RET == 0;\n } elsif ($WHAT eq '-signCA' ) {\n     $RET = run(\"$CA -policy policy_anything -out $NEWCERT\"\n-            . \" -extensions v3_ca -infiles $NEWREQ\");\n+            . \" -extensions v3_ca $EXTRA{ca} -infiles $NEWREQ\");\n     print \"Signed CA certificate is in $NEWCERT\\n\" if $RET == 0;\n } elsif ($WHAT eq '-signcert' ) {\n     $RET = run(\"$X509 -x509toreq -in $NEWREQ -signkey $NEWREQ\"\n-            . \" -out tmp.pem\");\n+            . \" -out tmp.pem $EXTRA{x509}\");\n     $RET = run(\"$CA -policy policy_anything -out $NEWCERT\"\n-            . \" -infiles tmp.pem\") if $RET == 0;\n+            . \"$EXTRA{ca} -infiles tmp.pem\") if $RET == 0;\n     print \"Signed certificate is in $NEWCERT\\n\" if $RET == 0;\n } elsif ($WHAT eq '-verify' ) {\n     my @files = @ARGV ? @ARGV : ( $NEWCERT );\n     my $file;\n     foreach $file (@files) {\n-        my $status = run(\"$VERIFY \\\"-CAfile\\\" ${CATOP}/$CACERT $file\");\n+        my $status = run(\"$VERIFY \\\"-CAfile\\\" ${CATOP}/$CACERT $file $EXTRA{verify}\");\n         $RET = $status if $status != 0;\n     }\n } elsif ($WHAT eq '-crl' ) {\n-    $RET = run(\"$CA -gencrl -out ${CATOP}/crl/$CACRL\");\n+    $RET = run(\"$CA -gencrl -out ${CATOP}/crl/$CACRL $EXTRA{ca}\");\n     print \"Generated CRL is in ${CATOP}/crl/$CACRL\\n\" if $RET == 0;\n } elsif ($WHAT eq '-revoke' ) {\n     my $cname = $ARGV[0];\n@@ -186,7 +204,7 @@ if ($WHAT eq '-newcert' ) {\n     my $reason = $ARGV[1];\n     $reason = \" -crl_reason $reason\"\n         if defined $reason && crl_reason_ok($reason);\n-    $RET = run(\"$CA -revoke \\\"$cname\\\"\" . $reason);\n+    $RET = run(\"$CA -revoke \\\"$cname\\\"\" . $reason . $EXTRA{ca});\n } else {\n     print STDERR \"Unknown arg \\\"$WHAT\\\"\\n\";\n     print STDERR \"Use -help for help.\\n\";"
        },
        {
            "sha": "2b0bbde034230416f2814cd2de11a4a15b4940d0",
            "filename": "deps/openssl/openssl/apps/app_rand.c",
            "status": "modified",
            "additions": 57,
            "deletions": 79,
            "changes": 136,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fapp_rand.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fapp_rand.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fapp_rand.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -9,107 +9,85 @@\n \n #include \"apps.h\"\n #include <openssl/bio.h>\n+#include <openssl/err.h>\n #include <openssl/rand.h>\n+#include <openssl/conf.h>\n \n-static int seeded = 0;\n-static int egdsocket = 0;\n+static char *save_rand_file;\n \n-int app_RAND_load_file(const char *file, int dont_warn)\n+void app_RAND_load_conf(CONF *c, const char *section)\n {\n-    int consider_randfile = (file == NULL);\n-    char buffer[200];\n+    const char *randfile = NCONF_get_string(c, section, \"RANDFILE\");\n \n-    if (file == NULL)\n-        file = RAND_file_name(buffer, sizeof(buffer));\n-#ifndef OPENSSL_NO_EGD\n-    else if (RAND_egd(file) > 0) {\n-        /*\n-         * we try if the given filename is an EGD socket. if it is, we don't\n-         * write anything back to the file.\n-         */\n-        egdsocket = 1;\n-        return 1;\n+    if (randfile == NULL) {\n+        ERR_clear_error();\n+        return;\n     }\n-#endif\n-    if (file == NULL || !RAND_load_file(file, -1)) {\n-        if (RAND_status() == 0) {\n-            if (!dont_warn) {\n-                BIO_printf(bio_err, \"unable to load 'random state'\\n\");\n-                BIO_printf(bio_err,\n-                           \"This means that the random number generator has not been seeded\\n\");\n-                BIO_printf(bio_err, \"with much random data.\\n\");\n-                if (consider_randfile) { /* explanation does not apply when a\n-                                          * file is explicitly named */\n-                    BIO_printf(bio_err,\n-                               \"Consider setting the RANDFILE environment variable to point at a file that\\n\");\n-                    BIO_printf(bio_err,\n-                               \"'random' data can be kept in (the file will be overwritten).\\n\");\n-                }\n-            }\n-            return 0;\n-        }\n+    if (RAND_load_file(randfile, -1) < 0) {\n+        BIO_printf(bio_err, \"Can't load %s into RNG\\n\", randfile);\n+        ERR_print_errors(bio_err);\n     }\n-    seeded = 1;\n-    return 1;\n+    if (save_rand_file == NULL)\n+        save_rand_file = OPENSSL_strdup(randfile);\n }\n \n-long app_RAND_load_files(char *name)\n+static int loadfiles(char *name)\n {\n-    char *p, *n;\n-    int last;\n-    long tot = 0;\n-#ifndef OPENSSL_NO_EGD\n-    int egd;\n-#endif\n+    char *p;\n+    int last, ret = 1;\n \n-    for (;;) {\n+    for ( ; ; ) {\n         last = 0;\n-        for (p = name; ((*p != '\\0') && (*p != LIST_SEPARATOR_CHAR)); p++) ;\n+        for (p = name; *p != '\\0' && *p != LIST_SEPARATOR_CHAR; p++)\n+            continue;\n         if (*p == '\\0')\n             last = 1;\n         *p = '\\0';\n-        n = name;\n-        name = p + 1;\n-        if (*n == '\\0')\n-            break;\n-\n-#ifndef OPENSSL_NO_EGD\n-        egd = RAND_egd(n);\n-        if (egd > 0)\n-            tot += egd;\n-        else\n-#endif\n-            tot += RAND_load_file(n, -1);\n+        if (RAND_load_file(name, -1) < 0) {\n+            BIO_printf(bio_err, \"Can't load %s into RNG\\n\", name);\n+            ERR_print_errors(bio_err);\n+            ret = 0;\n+        }\n         if (last)\n             break;\n+        name = p + 1;\n+        if (*name == '\\0')\n+            break;\n     }\n-    if (tot > 512)\n-        app_RAND_allow_write_file();\n-    return (tot);\n+    return ret;\n }\n \n-int app_RAND_write_file(const char *file)\n+void app_RAND_write(void)\n {\n-    char buffer[200];\n-\n-    if (egdsocket || !seeded)\n-        /*\n-         * If we did not manage to read the seed file, we should not write a\n-         * low-entropy seed file back -- it would suppress a crucial warning\n-         * the next time we want to use it.\n-         */\n-        return 0;\n-\n-    if (file == NULL)\n-        file = RAND_file_name(buffer, sizeof(buffer));\n-    if (file == NULL || !RAND_write_file(file)) {\n-        BIO_printf(bio_err, \"unable to write 'random state'\\n\");\n-        return 0;\n+    if (save_rand_file == NULL)\n+        return;\n+    if (RAND_write_file(save_rand_file) == -1) {\n+        BIO_printf(bio_err, \"Cannot write random bytes:\\n\");\n+        ERR_print_errors(bio_err);\n     }\n-    return 1;\n+    OPENSSL_free(save_rand_file);\n+    save_rand_file =  NULL;\n }\n \n-void app_RAND_allow_write_file(void)\n+\n+/*\n+ * See comments in opt_verify for explanation of this.\n+ */\n+enum r_range { OPT_R_ENUM };\n+\n+int opt_rand(int opt)\n {\n-    seeded = 1;\n+    switch ((enum r_range)opt) {\n+    case OPT_R__FIRST:\n+    case OPT_R__LAST:\n+        break;\n+    case OPT_R_RAND:\n+        return loadfiles(opt_arg());\n+        break;\n+    case OPT_R_WRITERAND:\n+        OPENSSL_free(save_rand_file);\n+        save_rand_file = OPENSSL_strdup(opt_arg());\n+        break;\n+    }\n+    return 1;\n }"
        },
        {
            "sha": "653e3973e04da7d4ce3de1f4ece0fc8e192ee41e",
            "filename": "deps/openssl/openssl/apps/apps.c",
            "status": "modified",
            "additions": 227,
            "deletions": 138,
            "changes": 365,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fapps.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fapps.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fapps.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -54,9 +54,8 @@ typedef struct {\n     unsigned long mask;\n } NAME_EX_TBL;\n \n-#if !defined(OPENSSL_NO_UI) || !defined(OPENSSL_NO_ENGINE)\n static UI_METHOD *ui_method = NULL;\n-#endif\n+static const UI_METHOD *ui_fallback_method = NULL;\n \n static int set_table_opts(unsigned long *flags, const char *arg,\n                           const NAME_EX_TBL * in_tbl);\n@@ -110,13 +109,13 @@ int chopup_args(ARGS *arg, char *buf)\n         }\n     }\n     arg->argv[arg->argc] = NULL;\n-    return (1);\n+    return 1;\n }\n \n #ifndef APP_INIT\n int app_init(long mesgwin)\n {\n-    return (1);\n+    return 1;\n }\n #endif\n \n@@ -138,41 +137,55 @@ int ctx_set_verify_locations(SSL_CTX *ctx, const char *CAfile,\n \n int ctx_set_ctlog_list_file(SSL_CTX *ctx, const char *path)\n {\n-    if (path == NULL) {\n+    if (path == NULL)\n         return SSL_CTX_set_default_ctlog_list_file(ctx);\n-    }\n \n     return SSL_CTX_set_ctlog_list_file(ctx, path);\n }\n \n #endif\n \n-int dump_cert_text(BIO *out, X509 *x)\n+static unsigned long nmflag = 0;\n+static char nmflag_set = 0;\n+\n+int set_nameopt(const char *arg)\n {\n-    char *p;\n+    int ret = set_name_ex(&nmflag, arg);\n \n-    p = X509_NAME_oneline(X509_get_subject_name(x), NULL, 0);\n-    BIO_puts(out, \"subject=\");\n-    BIO_puts(out, p);\n-    OPENSSL_free(p);\n+    if (ret)\n+        nmflag_set = 1;\n \n-    p = X509_NAME_oneline(X509_get_issuer_name(x), NULL, 0);\n-    BIO_puts(out, \"\\nissuer=\");\n-    BIO_puts(out, p);\n+    return ret;\n+}\n+\n+unsigned long get_nameopt(void)\n+{\n+    return (nmflag_set) ? nmflag : XN_FLAG_ONELINE;\n+}\n+\n+int dump_cert_text(BIO *out, X509 *x)\n+{\n+    print_name(out, \"subject=\", X509_get_subject_name(x), get_nameopt());\n+    BIO_puts(out, \"\\n\");\n+    print_name(out, \"issuer=\", X509_get_issuer_name(x), get_nameopt());\n     BIO_puts(out, \"\\n\");\n-    OPENSSL_free(p);\n \n     return 0;\n }\n \n-#ifndef OPENSSL_NO_UI\n static int ui_open(UI *ui)\n {\n-    return UI_method_get_opener(UI_OpenSSL())(ui);\n+    int (*opener)(UI *ui) = UI_method_get_opener(ui_fallback_method);\n+\n+    if (opener)\n+        return opener(ui);\n+    return 1;\n }\n \n static int ui_read(UI *ui, UI_STRING *uis)\n {\n+    int (*reader)(UI *ui, UI_STRING *uis) = NULL;\n+\n     if (UI_get_input_flags(uis) & UI_INPUT_FLAG_DEFAULT_PWD\n         && UI_get0_user_data(ui)) {\n         switch (UI_get_string_type(uis)) {\n@@ -186,15 +199,25 @@ static int ui_read(UI *ui, UI_STRING *uis)\n                     return 1;\n                 }\n             }\n-        default:\n+            break;\n+        case UIT_NONE:\n+        case UIT_BOOLEAN:\n+        case UIT_INFO:\n+        case UIT_ERROR:\n             break;\n         }\n     }\n-    return UI_method_get_reader(UI_OpenSSL())(ui, uis);\n+\n+    reader = UI_method_get_reader(ui_fallback_method);\n+    if (reader)\n+        return reader(ui, uis);\n+    return 1;\n }\n \n static int ui_write(UI *ui, UI_STRING *uis)\n {\n+    int (*writer)(UI *ui, UI_STRING *uis) = NULL;\n+\n     if (UI_get_input_flags(uis) & UI_INPUT_FLAG_DEFAULT_PWD\n         && UI_get0_user_data(ui)) {\n         switch (UI_get_string_type(uis)) {\n@@ -206,20 +229,36 @@ static int ui_write(UI *ui, UI_STRING *uis)\n                 if (password && password[0] != '\\0')\n                     return 1;\n             }\n-        default:\n+            break;\n+        case UIT_NONE:\n+        case UIT_BOOLEAN:\n+        case UIT_INFO:\n+        case UIT_ERROR:\n             break;\n         }\n     }\n-    return UI_method_get_writer(UI_OpenSSL())(ui, uis);\n+\n+    writer = UI_method_get_writer(ui_fallback_method);\n+    if (writer)\n+        return writer(ui, uis);\n+    return 1;\n }\n \n static int ui_close(UI *ui)\n {\n-    return UI_method_get_closer(UI_OpenSSL())(ui);\n+    int (*closer)(UI *ui) = UI_method_get_closer(ui_fallback_method);\n+\n+    if (closer)\n+        return closer(ui);\n+    return 1;\n }\n \n int setup_ui_method(void)\n {\n+    ui_fallback_method = UI_null();\n+#ifndef OPENSSL_NO_UI_CONSOLE\n+    ui_fallback_method = UI_OpenSSL();\n+#endif\n     ui_method = UI_create_method(\"OpenSSL application user interface\");\n     UI_method_set_opener(ui_method, ui_open);\n     UI_method_set_reader(ui_method, ui_read);\n@@ -235,24 +274,18 @@ void destroy_ui_method(void)\n         ui_method = NULL;\n     }\n }\n-#endif\n+\n+const UI_METHOD *get_ui_method(void)\n+{\n+    return ui_method;\n+}\n \n int password_callback(char *buf, int bufsiz, int verify, PW_CB_DATA *cb_tmp)\n {\n     int res = 0;\n-#ifndef OPENSSL_NO_UI\n     UI *ui = NULL;\n-#endif\n     PW_CB_DATA *cb_data = (PW_CB_DATA *)cb_tmp;\n \n-#ifdef OPENSSL_NO_UI\n-    if (cb_data != NULL && cb_data->password != NULL) {\n-        res = strlen(cb_data->password);\n-        if (res > bufsiz)\n-            res = bufsiz;\n-        memcpy(buf, cb_data->password, res);\n-    }\n-#else\n     ui = UI_new_method(ui_method);\n     if (ui) {\n         int ok = 0;\n@@ -276,9 +309,9 @@ int password_callback(char *buf, int bufsiz, int verify, PW_CB_DATA *cb_tmp)\n         /* We know that there is no previous user data to return to us */\n         (void)UI_add_user_data(ui, cb_data);\n \n-        if (ok >= 0)\n-            ok = UI_add_input_string(ui, prompt, ui_flags, buf,\n-                                     PW_MIN_LENGTH, bufsiz - 1);\n+        ok = UI_add_input_string(ui, prompt, ui_flags, buf,\n+                                 PW_MIN_LENGTH, bufsiz - 1);\n+\n         if (ok >= 0 && verify) {\n             buff = app_malloc(bufsiz, \"password buffer\");\n             ok = UI_add_verify_string(ui, prompt, ui_flags, buff,\n@@ -287,8 +320,7 @@ int password_callback(char *buf, int bufsiz, int verify, PW_CB_DATA *cb_tmp)\n         if (ok >= 0)\n             do {\n                 ok = UI_process(ui);\n-            }\n-            while (ok < 0 && UI_ctrl(ui, UI_CTRL_IS_REDOABLE, 0, 0, 0));\n+            } while (ok < 0 && UI_ctrl(ui, UI_CTRL_IS_REDOABLE, 0, 0, 0));\n \n         OPENSSL_clear_free(buff, (unsigned int)bufsiz);\n \n@@ -308,7 +340,6 @@ int password_callback(char *buf, int bufsiz, int verify, PW_CB_DATA *cb_tmp)\n         UI_free(ui);\n         OPENSSL_free(prompt);\n     }\n-#endif\n     return res;\n }\n \n@@ -317,22 +348,24 @@ static char *app_get_pass(const char *arg, int keepbio);\n int app_passwd(const char *arg1, const char *arg2, char **pass1, char **pass2)\n {\n     int same;\n-    if (!arg2 || !arg1 || strcmp(arg1, arg2))\n+    if (arg2 == NULL || arg1 == NULL || strcmp(arg1, arg2))\n         same = 0;\n     else\n         same = 1;\n-    if (arg1) {\n+    if (arg1 != NULL) {\n         *pass1 = app_get_pass(arg1, same);\n-        if (!*pass1)\n+        if (*pass1 == NULL)\n             return 0;\n-    } else if (pass1)\n+    } else if (pass1 != NULL) {\n         *pass1 = NULL;\n-    if (arg2) {\n+    }\n+    if (arg2 != NULL) {\n         *pass2 = app_get_pass(arg2, same ? 2 : 0);\n-        if (!*pass2)\n+        if (*pass2 == NULL)\n             return 0;\n-    } else if (pass2)\n+    } else if (pass2 != NULL) {\n         *pass2 = NULL;\n+    }\n     return 1;\n }\n \n@@ -346,16 +379,16 @@ static char *app_get_pass(const char *arg, int keepbio)\n         return OPENSSL_strdup(arg + 5);\n     if (strncmp(arg, \"env:\", 4) == 0) {\n         tmp = getenv(arg + 4);\n-        if (!tmp) {\n+        if (tmp == NULL) {\n             BIO_printf(bio_err, \"Can't read environment variable %s\\n\", arg + 4);\n             return NULL;\n         }\n         return OPENSSL_strdup(tmp);\n     }\n-    if (!keepbio || !pwdbio) {\n+    if (!keepbio || pwdbio == NULL) {\n         if (strncmp(arg, \"file:\", 5) == 0) {\n             pwdbio = BIO_new_file(arg + 5, \"r\");\n-            if (!pwdbio) {\n+            if (pwdbio == NULL) {\n                 BIO_printf(bio_err, \"Can't open file %s\\n\", arg + 5);\n                 return NULL;\n             }\n@@ -404,12 +437,12 @@ static char *app_get_pass(const char *arg, int keepbio)\n         return NULL;\n     }\n     tmp = strchr(tpass, '\\n');\n-    if (tmp)\n+    if (tmp != NULL)\n         *tmp = 0;\n     return OPENSSL_strdup(tpass);\n }\n \n-static CONF *app_load_config_(BIO *in, const char *filename)\n+CONF *app_load_config_bio(BIO *in, const char *filename)\n {\n     long errorline = -1;\n     CONF *conf;\n@@ -420,15 +453,21 @@ static CONF *app_load_config_(BIO *in, const char *filename)\n     if (i > 0)\n         return conf;\n \n-    if (errorline <= 0)\n-        BIO_printf(bio_err, \"%s: Can't load config file \\\"%s\\\"\\n\",\n-                   opt_getprog(), filename);\n+    if (errorline <= 0) {\n+        BIO_printf(bio_err, \"%s: Can't load \", opt_getprog());\n+    } else {\n+        BIO_printf(bio_err, \"%s: Error on line %ld of \", opt_getprog(),\n+                   errorline);\n+    }\n+    if (filename != NULL)\n+        BIO_printf(bio_err, \"config file \\\"%s\\\"\\n\", filename);\n     else\n-        BIO_printf(bio_err, \"%s: Error on line %ld of config file \\\"%s\\\"\\n\",\n-                   opt_getprog(), errorline, filename);\n+        BIO_printf(bio_err, \"config input\");\n+\n     NCONF_free(conf);\n     return NULL;\n }\n+\n CONF *app_load_config(const char *filename)\n {\n     BIO *in;\n@@ -438,10 +477,11 @@ CONF *app_load_config(const char *filename)\n     if (in == NULL)\n         return NULL;\n \n-    conf = app_load_config_(in, filename);\n+    conf = app_load_config_bio(in, filename);\n     BIO_free(in);\n     return conf;\n }\n+\n CONF *app_load_config_quiet(const char *filename)\n {\n     BIO *in;\n@@ -451,7 +491,7 @@ CONF *app_load_config_quiet(const char *filename)\n     if (in == NULL)\n         return NULL;\n \n-    conf = app_load_config_(in, filename);\n+    conf = app_load_config_bio(in, filename);\n     BIO_free(in);\n     return conf;\n }\n@@ -515,9 +555,9 @@ static int load_pkcs12(BIO *in, const char *desc,\n         goto die;\n     }\n     /* See if an empty password will do */\n-    if (PKCS12_verify_mac(p12, \"\", 0) || PKCS12_verify_mac(p12, NULL, 0))\n+    if (PKCS12_verify_mac(p12, \"\", 0) || PKCS12_verify_mac(p12, NULL, 0)) {\n         pass = \"\";\n-    else {\n+    } else {\n         if (!pem_cb)\n             pem_cb = (pem_password_cb *)password_callback;\n         len = pem_cb(tpass, PEM_BUFSIZE, 0, cb_data);\n@@ -578,8 +618,7 @@ static int load_cert_crl_http(const char *url, X509 **pcert, X509_CRL **pcrl)\n     OPENSSL_free(host);\n     OPENSSL_free(path);\n     OPENSSL_free(port);\n-    if (bio)\n-        BIO_free_all(bio);\n+    BIO_free_all(bio);\n     OCSP_REQ_CTX_free(rctx);\n     if (rv != 1) {\n         BIO_printf(bio_err, \"Error loading %s from %s\\n\",\n@@ -605,17 +644,18 @@ X509 *load_cert(const char *file, int format, const char *cert_descrip)\n     if (file == NULL) {\n         unbuffer(stdin);\n         cert = dup_bio_in(format);\n-    } else\n+    } else {\n         cert = bio_open_default(file, 'r', format);\n+    }\n     if (cert == NULL)\n         goto end;\n \n-    if (format == FORMAT_ASN1)\n+    if (format == FORMAT_ASN1) {\n         x = d2i_X509_bio(cert, NULL);\n-    else if (format == FORMAT_PEM)\n+    } else if (format == FORMAT_PEM) {\n         x = PEM_read_bio_X509_AUX(cert, NULL,\n                                   (pem_password_cb *)password_callback, NULL);\n-    else if (format == FORMAT_PKCS12) {\n+    } else if (format == FORMAT_PKCS12) {\n         if (!load_pkcs12(cert, cert_descrip, NULL, NULL, NULL, &x, NULL))\n             goto end;\n     } else {\n@@ -628,7 +668,7 @@ X509 *load_cert(const char *file, int format, const char *cert_descrip)\n         ERR_print_errors(bio_err);\n     }\n     BIO_free(cert);\n-    return (x);\n+    return x;\n }\n \n X509_CRL *load_crl(const char *infile, int format)\n@@ -646,11 +686,11 @@ X509_CRL *load_crl(const char *infile, int format)\n     in = bio_open_default(infile, 'r', format);\n     if (in == NULL)\n         goto end;\n-    if (format == FORMAT_ASN1)\n+    if (format == FORMAT_ASN1) {\n         x = d2i_X509_CRL_bio(in, NULL);\n-    else if (format == FORMAT_PEM)\n+    } else if (format == FORMAT_PEM) {\n         x = PEM_read_bio_X509_CRL(in, NULL, NULL, NULL);\n-    else {\n+    } else {\n         BIO_printf(bio_err, \"bad input format specified for input crl\\n\");\n         goto end;\n     }\n@@ -662,7 +702,7 @@ X509_CRL *load_crl(const char *infile, int format)\n \n  end:\n     BIO_free(in);\n-    return (x);\n+    return x;\n }\n \n EVP_PKEY *load_key(const char *file, int format, int maybe_stdin,\n@@ -680,9 +720,9 @@ EVP_PKEY *load_key(const char *file, int format, int maybe_stdin,\n         goto end;\n     }\n     if (format == FORMAT_ENGINE) {\n-        if (e == NULL)\n+        if (e == NULL) {\n             BIO_printf(bio_err, \"no engine specified\\n\");\n-        else {\n+        } else {\n #ifndef OPENSSL_NO_ENGINE\n             if (ENGINE_init(e)) {\n                 pkey = ENGINE_load_private_key(e, file, ui_method, &cb_data);\n@@ -701,8 +741,9 @@ EVP_PKEY *load_key(const char *file, int format, int maybe_stdin,\n     if (file == NULL && maybe_stdin) {\n         unbuffer(stdin);\n         key = dup_bio_in(format);\n-    } else\n+    } else {\n         key = bio_open_default(file, 'r', format);\n+    }\n     if (key == NULL)\n         goto end;\n     if (format == FORMAT_ASN1) {\n@@ -711,21 +752,19 @@ EVP_PKEY *load_key(const char *file, int format, int maybe_stdin,\n         pkey = PEM_read_bio_PrivateKey(key, NULL,\n                                        (pem_password_cb *)password_callback,\n                                        &cb_data);\n-    }\n-    else if (format == FORMAT_PKCS12) {\n+    } else if (format == FORMAT_PKCS12) {\n         if (!load_pkcs12(key, key_descrip,\n                          (pem_password_cb *)password_callback, &cb_data,\n                          &pkey, NULL, NULL))\n             goto end;\n-    }\n #if !defined(OPENSSL_NO_RSA) && !defined(OPENSSL_NO_DSA) && !defined (OPENSSL_NO_RC4)\n-    else if (format == FORMAT_MSBLOB)\n+    } else if (format == FORMAT_MSBLOB) {\n         pkey = b2i_PrivateKey_bio(key);\n-    else if (format == FORMAT_PVK)\n+    } else if (format == FORMAT_PVK) {\n         pkey = b2i_PVK_bio(key, (pem_password_cb *)password_callback,\n                            &cb_data);\n #endif\n-    else {\n+    } else {\n         BIO_printf(bio_err, \"bad input format specified for key file\\n\");\n         goto end;\n     }\n@@ -735,7 +774,7 @@ EVP_PKEY *load_key(const char *file, int format, int maybe_stdin,\n         BIO_printf(bio_err, \"unable to load %s\\n\", key_descrip);\n         ERR_print_errors(bio_err);\n     }\n-    return (pkey);\n+    return pkey;\n }\n \n EVP_PKEY *load_pubkey(const char *file, int format, int maybe_stdin,\n@@ -753,9 +792,9 @@ EVP_PKEY *load_pubkey(const char *file, int format, int maybe_stdin,\n         goto end;\n     }\n     if (format == FORMAT_ENGINE) {\n-        if (e == NULL)\n+        if (e == NULL) {\n             BIO_printf(bio_err, \"no engine specified\\n\");\n-        else {\n+        } else {\n #ifndef OPENSSL_NO_ENGINE\n             pkey = ENGINE_load_public_key(e, file, ui_method, &cb_data);\n             if (pkey == NULL) {\n@@ -771,14 +810,14 @@ EVP_PKEY *load_pubkey(const char *file, int format, int maybe_stdin,\n     if (file == NULL && maybe_stdin) {\n         unbuffer(stdin);\n         key = dup_bio_in(format);\n-    } else\n+    } else {\n         key = bio_open_default(file, 'r', format);\n+    }\n     if (key == NULL)\n         goto end;\n     if (format == FORMAT_ASN1) {\n         pkey = d2i_PUBKEY_bio(key, NULL);\n-    }\n-    else if (format == FORMAT_ASN1RSA) {\n+    } else if (format == FORMAT_ASN1RSA) {\n #ifndef OPENSSL_NO_RSA\n         RSA *rsa;\n         rsa = d2i_RSAPublicKey_bio(key, NULL);\n@@ -808,21 +847,20 @@ EVP_PKEY *load_pubkey(const char *file, int format, int maybe_stdin,\n         BIO_printf(bio_err, \"RSA keys not supported\\n\");\n #endif\n             pkey = NULL;\n-    }\n-    else if (format == FORMAT_PEM) {\n+    } else if (format == FORMAT_PEM) {\n         pkey = PEM_read_bio_PUBKEY(key, NULL,\n                                    (pem_password_cb *)password_callback,\n                                    &cb_data);\n-    }\n #if !defined(OPENSSL_NO_RSA) && !defined(OPENSSL_NO_DSA)\n-    else if (format == FORMAT_MSBLOB)\n+    } else if (format == FORMAT_MSBLOB) {\n         pkey = b2i_PublicKey_bio(key);\n #endif\n+    }\n  end:\n     BIO_free(key);\n     if (pkey == NULL)\n         BIO_printf(bio_err, \"unable to load %s\\n\", key_descrip);\n-    return (pkey);\n+    return pkey;\n }\n \n static int load_certs_crls(const char *file, int format,\n@@ -855,48 +893,48 @@ static int load_certs_crls(const char *file, int format,\n \n     BIO_free(bio);\n \n-    if (pcerts && *pcerts == NULL) {\n+    if (pcerts != NULL && *pcerts == NULL) {\n         *pcerts = sk_X509_new_null();\n-        if (!*pcerts)\n+        if (*pcerts == NULL)\n             goto end;\n     }\n \n-    if (pcrls && *pcrls == NULL) {\n+    if (pcrls != NULL && *pcrls == NULL) {\n         *pcrls = sk_X509_CRL_new_null();\n-        if (!*pcrls)\n+        if (*pcrls == NULL)\n             goto end;\n     }\n \n     for (i = 0; i < sk_X509_INFO_num(xis); i++) {\n         xi = sk_X509_INFO_value(xis, i);\n-        if (xi->x509 && pcerts) {\n+        if (xi->x509 != NULL && pcerts != NULL) {\n             if (!sk_X509_push(*pcerts, xi->x509))\n                 goto end;\n             xi->x509 = NULL;\n         }\n-        if (xi->crl && pcrls) {\n+        if (xi->crl != NULL && pcrls != NULL) {\n             if (!sk_X509_CRL_push(*pcrls, xi->crl))\n                 goto end;\n             xi->crl = NULL;\n         }\n     }\n \n-    if (pcerts && sk_X509_num(*pcerts) > 0)\n+    if (pcerts != NULL && sk_X509_num(*pcerts) > 0)\n         rv = 1;\n \n-    if (pcrls && sk_X509_CRL_num(*pcrls) > 0)\n+    if (pcrls != NULL && sk_X509_CRL_num(*pcrls) > 0)\n         rv = 1;\n \n  end:\n \n     sk_X509_INFO_pop_free(xis, X509_INFO_free);\n \n     if (rv == 0) {\n-        if (pcerts) {\n+        if (pcerts != NULL) {\n             sk_X509_pop_free(*pcerts, X509_free);\n             *pcerts = NULL;\n         }\n-        if (pcrls) {\n+        if (pcrls != NULL) {\n             sk_X509_CRL_pop_free(*pcrls, X509_CRL_free);\n             *pcrls = NULL;\n         }\n@@ -1102,8 +1140,9 @@ static int set_table_opts(unsigned long *flags, const char *arg,\n     } else if (c == '+') {\n         c = 1;\n         arg++;\n-    } else\n+    } else {\n         c = 1;\n+    }\n \n     for (ptbl = in_tbl; ptbl->name; ptbl++) {\n         if (strcasecmp(arg, ptbl->name) == 0) {\n@@ -1148,23 +1187,23 @@ void print_bignum_var(BIO *out, const BIGNUM *in, const char *var,\n                       int len, unsigned char *buffer)\n {\n     BIO_printf(out, \"    static unsigned char %s_%d[] = {\", var, len);\n-    if (BN_is_zero(in))\n-        BIO_printf(out, \"\\n\\t0x00\");\n-    else {\n+    if (BN_is_zero(in)) {\n+        BIO_printf(out, \"\\n        0x00\");\n+    } else {\n         int i, l;\n \n         l = BN_bn2bin(in, buffer);\n         for (i = 0; i < l; i++) {\n-            if ((i % 10) == 0)\n-                BIO_printf(out, \"\\n\\t\");\n+            BIO_printf(out, (i % 10) == 0 ? \"\\n        \" : \" \");\n             if (i < l - 1)\n-                BIO_printf(out, \"0x%02X, \", buffer[i]);\n+                BIO_printf(out, \"0x%02X,\", buffer[i]);\n             else\n                 BIO_printf(out, \"0x%02X\", buffer[i]);\n         }\n     }\n     BIO_printf(out, \"\\n    };\\n\");\n }\n+\n void print_array(BIO *out, const char* title, int len, const unsigned char* d)\n {\n     int i;\n@@ -1198,8 +1237,9 @@ X509_STORE *setup_verify(const char *CAfile, const char *CApath, int noCAfile, i\n                 BIO_printf(bio_err, \"Error loading file %s\\n\", CAfile);\n                 goto end;\n             }\n-        } else\n+        } else {\n             X509_LOOKUP_load_file(lookup, NULL, X509_FILETYPE_DEFAULT);\n+        }\n     }\n \n     if (CApath != NULL || !noCApath) {\n@@ -1211,8 +1251,9 @@ X509_STORE *setup_verify(const char *CAfile, const char *CApath, int noCAfile, i\n                 BIO_printf(bio_err, \"Error loading directory %s\\n\", CApath);\n                 goto end;\n             }\n-        } else\n+        } else {\n             X509_LOOKUP_add_dir(lookup, NULL, X509_FILETYPE_DEFAULT);\n+        }\n     }\n \n     ERR_clear_error();\n@@ -1243,7 +1284,7 @@ ENGINE *setup_engine(const char *engine, int debug)\n     ENGINE *e = NULL;\n \n #ifndef OPENSSL_NO_ENGINE\n-    if (engine) {\n+    if (engine != NULL) {\n         if (strcmp(engine, \"auto\") == 0) {\n             BIO_printf(bio_err, \"enabling auto ENGINE support\\n\");\n             ENGINE_register_all_complete();\n@@ -1298,7 +1339,7 @@ static int index_serial_cmp(const OPENSSL_CSTRING *a,\n \n     for (aa = a[DB_serial]; *aa == '0'; aa++) ;\n     for (bb = b[DB_serial]; *bb == '0'; bb++) ;\n-    return (strcmp(aa, bb));\n+    return strcmp(aa, bb);\n }\n \n static int index_name_qual(char **a)\n@@ -1313,7 +1354,7 @@ static unsigned long index_name_hash(const OPENSSL_CSTRING *a)\n \n int index_name_cmp(const OPENSSL_CSTRING *a, const OPENSSL_CSTRING *b)\n {\n-    return (strcmp(a[DB_name], b[DB_name]));\n+    return strcmp(a[DB_name], b[DB_name]);\n }\n \n static IMPLEMENT_LHASH_HASH_FN(index_serial, OPENSSL_CSTRING)\n@@ -1364,7 +1405,7 @@ BIGNUM *load_serial(const char *serialfile, int create, ASN1_INTEGER **retai)\n  err:\n     BIO_free(in);\n     ASN1_INTEGER_free(ai);\n-    return (ret);\n+    return ret;\n }\n \n int save_serial(const char *serialfile, const char *suffix, const BIGNUM *serial,\n@@ -1414,7 +1455,7 @@ int save_serial(const char *serialfile, const char *suffix, const BIGNUM *serial\n  err:\n     BIO_free_all(out);\n     ASN1_INTEGER_free(ai);\n-    return (ret);\n+    return ret;\n }\n \n int rotate_serial(const char *serialfile, const char *new_suffix,\n@@ -1465,15 +1506,11 @@ int rand_serial(BIGNUM *b, ASN1_INTEGER *ai)\n     BIGNUM *btmp;\n     int ret = 0;\n \n-    if (b)\n-        btmp = b;\n-    else\n-        btmp = BN_new();\n-\n+    btmp = b == NULL ? BN_new() : b;\n     if (btmp == NULL)\n         return 0;\n \n-    if (!BN_pseudo_rand(btmp, SERIAL_RAND_BITS, 0, 0))\n+    if (!BN_rand(btmp, SERIAL_RAND_BITS, BN_RAND_TOP_ANY, BN_RAND_BOTTOM_ANY))\n         goto error;\n     if (ai && !BN_to_ASN1_INTEGER(btmp, ai))\n         goto error;\n@@ -1495,12 +1532,27 @@ CA_DB *load_index(const char *dbfile, DB_ATTR *db_attr)\n     BIO *in;\n     CONF *dbattr_conf = NULL;\n     char buf[BSIZE];\n+#ifndef OPENSSL_NO_POSIX_IO\n+    FILE *dbfp;\n+    struct stat dbst;\n+#endif\n \n     in = BIO_new_file(dbfile, \"r\");\n     if (in == NULL) {\n         ERR_print_errors(bio_err);\n         goto err;\n     }\n+\n+#ifndef OPENSSL_NO_POSIX_IO\n+    BIO_get_fp(in, &dbfp);\n+    if (fstat(fileno(dbfp), &dbst) == -1) {\n+        SYSerr(SYS_F_FSTAT, errno);\n+        ERR_add_error_data(3, \"fstat('\", dbfile, \"')\");\n+        ERR_print_errors(bio_err);\n+        goto err;\n+    }\n+#endif\n+\n     if ((tmpdb = TXT_DB_read(in, DB_NUMBER)) == NULL)\n         goto err;\n \n@@ -1527,13 +1579,21 @@ CA_DB *load_index(const char *dbfile, DB_ATTR *db_attr)\n         }\n     }\n \n+    retdb->dbfname = OPENSSL_strdup(dbfile);\n+#ifndef OPENSSL_NO_POSIX_IO\n+    retdb->dbst = dbst;\n+#endif\n+\n  err:\n     NCONF_free(dbattr_conf);\n     TXT_DB_free(tmpdb);\n     BIO_free_all(in);\n     return retdb;\n }\n \n+/*\n+ * Returns > 0 on success, <= 0 on error\n+ */\n int index_index(CA_DB *db)\n {\n     if (!TXT_DB_create_index(db->db, DB_serial, NULL,\n@@ -1672,6 +1732,7 @@ void free_index(CA_DB *db)\n {\n     if (db) {\n         TXT_DB_free(db->db);\n+        OPENSSL_free(db->dbfname);\n         OPENSSL_free(db);\n     }\n }\n@@ -1861,8 +1922,9 @@ static void nodes_print(const char *name, STACK_OF(X509_POLICY_NODE) *nodes)\n             node = sk_X509_POLICY_NODE_value(nodes, i);\n             X509_POLICY_NODE_print(bio_err, node, 2);\n         }\n-    } else\n+    } else {\n         BIO_puts(bio_err, \" <empty>\\n\");\n+    }\n }\n \n void policies_print(X509_STORE_CTX *ctx)\n@@ -1905,10 +1967,11 @@ unsigned char *next_protos_parse(size_t *outlen, const char *in)\n                 OPENSSL_free(out);\n                 return NULL;\n             }\n-            out[start] = i - start;\n+            out[start] = (unsigned char)(i - start);\n             start = i + 1;\n-        } else\n+        } else {\n             out[i + 1] = in[i];\n+        }\n     }\n \n     *outlen = len + 1;\n@@ -2131,7 +2194,7 @@ double app_tminterval(int stop, int usertime)\n         ret = (__int64)(tmstop.QuadPart - tmstart.QuadPart) * 1e-7;\n     }\n \n-    return (ret);\n+    return ret;\n }\n #elif defined(OPENSSL_SYSTEM_VXWORKS)\n # include <time.h>\n@@ -2167,7 +2230,7 @@ double app_tminterval(int stop, int usertime)\n     else\n         ret = (now - tmstart) / (double)sysClkRateGet();\n # endif\n-    return (ret);\n+    return ret;\n }\n \n #elif defined(OPENSSL_SYSTEM_VMS)\n@@ -2201,7 +2264,7 @@ double app_tminterval(int stop, int usertime)\n     else\n         ret = (now - tmstart) / (double)(CLK_TCK);\n \n-    return (ret);\n+    return ret;\n }\n \n #elif defined(_SC_CLK_TCK)      /* by means of unistd.h */\n@@ -2217,14 +2280,14 @@ double app_tminterval(int stop, int usertime)\n     if (usertime)\n         now = rus.tms_utime;\n \n-    if (stop == TM_START)\n+    if (stop == TM_START) {\n         tmstart = now;\n-    else {\n+    } else {\n         long int tck = sysconf(_SC_CLK_TCK);\n         ret = (now - tmstart) / (double)tck;\n     }\n \n-    return (ret);\n+    return ret;\n }\n \n #else\n@@ -2349,12 +2412,12 @@ int raw_read_stdin(void *buf, int siz)\n {\n     DWORD n;\n     if (ReadFile(GetStdHandle(STD_INPUT_HANDLE), buf, siz, &n, NULL))\n-        return (n);\n+        return n;\n     else\n-        return (-1);\n+        return -1;\n }\n #elif defined(__VMS)\n-#include <sys/socket.h>\n+# include <sys/socket.h>\n \n int raw_read_stdin(void *buf, int siz)\n {\n@@ -2372,9 +2435,9 @@ int raw_write_stdout(const void *buf, int siz)\n {\n     DWORD n;\n     if (WriteFile(GetStdHandle(STD_OUTPUT_HANDLE), buf, siz, &n, NULL))\n-        return (n);\n+        return n;\n     else\n-        return (-1);\n+        return -1;\n }\n #else\n int raw_write_stdout(const void *buf, int siz)\n@@ -2401,14 +2464,26 @@ BIO *dup_bio_in(int format)\n                       BIO_NOCLOSE | (istext(format) ? BIO_FP_TEXT : 0));\n }\n \n+static BIO_METHOD *prefix_method = NULL;\n+\n BIO *dup_bio_out(int format)\n {\n     BIO *b = BIO_new_fp(stdout,\n                         BIO_NOCLOSE | (istext(format) ? BIO_FP_TEXT : 0));\n+    void *prefix = NULL;\n+\n #ifdef OPENSSL_SYS_VMS\n     if (istext(format))\n         b = BIO_push(BIO_new(BIO_f_linebuffer()), b);\n #endif\n+\n+    if (istext(format) && (prefix = getenv(\"HARNESS_OSSL_PREFIX\")) != NULL) {\n+        if (prefix_method == NULL)\n+            prefix_method = apps_bf_prefix();\n+        b = BIO_push(BIO_new(prefix_method), b);\n+        BIO_ctrl(b, PREFIX_CTRL_SET_PREFIX, 0, prefix);\n+    }\n+\n     return b;\n }\n \n@@ -2423,6 +2498,12 @@ BIO *dup_bio_err(int format)\n     return b;\n }\n \n+void destroy_prefix_method(void)\n+{\n+    BIO_meth_free(prefix_method);\n+    prefix_method = NULL;\n+}\n+\n void unbuffer(FILE *fp)\n {\n /*\n@@ -2649,15 +2730,23 @@ int set_cert_times(X509 *x, const char *startdate, const char *enddate,\n         if (X509_gmtime_adj(X509_getm_notBefore(x), 0) == NULL)\n             return 0;\n     } else {\n-        if (!ASN1_TIME_set_string(X509_getm_notBefore(x), startdate))\n+        if (!ASN1_TIME_set_string_X509(X509_getm_notBefore(x), startdate))\n             return 0;\n     }\n     if (enddate == NULL) {\n         if (X509_time_adj_ex(X509_getm_notAfter(x), days, 0, NULL)\n             == NULL)\n             return 0;\n-    } else if (!ASN1_TIME_set_string(X509_getm_notAfter(x), enddate)) {\n+    } else if (!ASN1_TIME_set_string_X509(X509_getm_notAfter(x), enddate)) {\n         return 0;\n     }\n     return 1;\n }\n+\n+void make_uppercase(char *string)\n+{\n+    int i;\n+\n+    for (i = 0; string[i] != '\\0'; i++)\n+        string[i] = toupper((unsigned char)string[i]);\n+}"
        },
        {
            "sha": "d9eb650eb21197a10696d5320c2c2e3016514635",
            "filename": "deps/openssl/openssl/apps/apps.h",
            "status": "modified",
            "additions": 103,
            "deletions": 42,
            "changes": 145,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fapps.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fapps.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fapps.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -10,17 +10,20 @@\n #ifndef HEADER_APPS_H\n # define HEADER_APPS_H\n \n-# include \"e_os.h\"\n-# if defined(__unix) || defined(__unix__)\n-#  include <sys/time.h> /* struct timeval for DTLS */\n-# endif\n+# include \"e_os.h\" /* struct timeval for DTLS */\n+# include \"internal/nelem.h\"\n # include <assert.h>\n \n+# include <sys/types.h>\n+# ifndef OPENSSL_NO_POSIX_IO\n+#  include <sys/stat.h>\n+#  include <fcntl.h>\n+# endif\n+\n # include <openssl/e_os2.h>\n # include <openssl/ossl_typ.h>\n # include <openssl/bio.h>\n # include <openssl/x509.h>\n-# include <openssl/lhash.h>\n # include <openssl/conf.h>\n # include <openssl/txt_db.h>\n # include <openssl/engine.h>\n@@ -40,27 +43,38 @@\n  */\n #define _UC(c) ((unsigned char)(c))\n \n-int app_RAND_load_file(const char *file, int dont_warn);\n-int app_RAND_write_file(const char *file);\n-/*\n- * When `file' is NULL, use defaults. `bio_e' is for error messages.\n- */\n-void app_RAND_allow_write_file(void);\n-long app_RAND_load_files(char *file); /* `file' is a list of files to read,\n-                                       * separated by LIST_SEPARATOR_CHAR\n-                                       * (see e_os.h).  The string is\n-                                       * destroyed! */\n+void app_RAND_load_conf(CONF *c, const char *section);\n+void app_RAND_write(void);\n \n extern char *default_config_file;\n extern BIO *bio_in;\n extern BIO *bio_out;\n extern BIO *bio_err;\n+extern const unsigned char tls13_aes128gcmsha256_id[];\n+extern const unsigned char tls13_aes256gcmsha384_id[];\n+extern BIO_ADDR *ourpeer;\n+\n+BIO_METHOD *apps_bf_prefix(void);\n+/*\n+ * The control used to set the prefix with BIO_ctrl()\n+ * We make it high enough so the chance of ever clashing with the BIO library\n+ * remains unlikely for the foreseeable future and beyond.\n+ */\n+#define PREFIX_CTRL_SET_PREFIX  (1 << 15)\n+/*\n+ * apps_bf_prefix() returns a dynamically created BIO_METHOD, which we\n+ * need to destroy at some point.  When created internally, it's stored\n+ * in an internal pointer which can be freed with the following function\n+ */\n+void destroy_prefix_method(void);\n+\n BIO *dup_bio_in(int format);\n BIO *dup_bio_out(int format);\n BIO *dup_bio_err(int format);\n BIO *bio_open_owner(const char *filename, int format, int private);\n BIO *bio_open_default(const char *filename, char mode, int format);\n BIO *bio_open_default_quiet(const char *filename, char mode, int format);\n+CONF *app_load_config_bio(BIO *in, const char *filename);\n CONF *app_load_config(const char *filename);\n CONF *app_load_config_quiet(const char *filename);\n int app_load_modules(const CONF *config);\n@@ -175,7 +189,7 @@ int set_cert_times(X509 *x, const char *startdate, const char *enddate,\n         case OPT_V_ALLOW_PROXY_CERTS\n \n /*\n- * Common \"extended\"? options.\n+ * Common \"extended validation\" options.\n  */\n # define OPT_X_ENUM \\\n         OPT_X__FIRST=1000, \\\n@@ -210,18 +224,22 @@ int set_cert_times(X509 *x, const char *startdate, const char *enddate,\n # define OPT_S_ENUM \\\n         OPT_S__FIRST=3000, \\\n         OPT_S_NOSSL3, OPT_S_NOTLS1, OPT_S_NOTLS1_1, OPT_S_NOTLS1_2, \\\n-        OPT_S_BUGS, OPT_S_NO_COMP, OPT_S_NOTICKET, \\\n+        OPT_S_NOTLS1_3, OPT_S_BUGS, OPT_S_NO_COMP, OPT_S_NOTICKET, \\\n         OPT_S_SERVERPREF, OPT_S_LEGACYRENEG, OPT_S_LEGACYCONN, \\\n-        OPT_S_ONRESUMP, OPT_S_NOLEGACYCONN, OPT_S_STRICT, OPT_S_SIGALGS, \\\n-        OPT_S_CLIENTSIGALGS, OPT_S_CURVES, OPT_S_NAMEDCURVE, OPT_S_CIPHER, \\\n-        OPT_S_DEBUGBROKE, OPT_S_COMP, OPT_S_MINPROTO, OPT_S_MAXPROTO, \\\n-        OPT_S_NO_RENEGOTIATION, OPT_S__LAST\n+        OPT_S_ONRESUMP, OPT_S_NOLEGACYCONN, OPT_S_ALLOW_NO_DHE_KEX, \\\n+        OPT_S_PRIORITIZE_CHACHA, \\\n+        OPT_S_STRICT, OPT_S_SIGALGS, OPT_S_CLIENTSIGALGS, OPT_S_GROUPS, \\\n+        OPT_S_CURVES, OPT_S_NAMEDCURVE, OPT_S_CIPHER, OPT_S_CIPHERSUITES, \\\n+        OPT_S_RECORD_PADDING, OPT_S_DEBUGBROKE, OPT_S_COMP, \\\n+        OPT_S_MINPROTO, OPT_S_MAXPROTO, \\\n+        OPT_S_NO_RENEGOTIATION, OPT_S_NO_MIDDLEBOX, OPT_S__LAST\n \n # define OPT_S_OPTIONS \\\n         {\"no_ssl3\", OPT_S_NOSSL3, '-',\"Just disable SSLv3\" }, \\\n         {\"no_tls1\", OPT_S_NOTLS1, '-', \"Just disable TLSv1\"}, \\\n         {\"no_tls1_1\", OPT_S_NOTLS1_1, '-', \"Just disable TLSv1.1\" }, \\\n         {\"no_tls1_2\", OPT_S_NOTLS1_2, '-', \"Just disable TLSv1.2\"}, \\\n+        {\"no_tls1_3\", OPT_S_NOTLS1_3, '-', \"Just disable TLSv1.3\"}, \\\n         {\"bugs\", OPT_S_BUGS, '-', \"Turn on SSL bug compatibility\"}, \\\n         {\"no_comp\", OPT_S_NO_COMP, '-', \"Disable SSL/TLS compression (default)\" }, \\\n         {\"comp\", OPT_S_COMP, '-', \"Use SSL/TLS-level compression\" }, \\\n@@ -238,29 +256,41 @@ int set_cert_times(X509 *x, const char *startdate, const char *enddate,\n             \"Disallow session resumption on renegotiation\"}, \\\n         {\"no_legacy_server_connect\", OPT_S_NOLEGACYCONN, '-', \\\n             \"Disallow initial connection to servers that don't support RI\"}, \\\n+        {\"allow_no_dhe_kex\", OPT_S_ALLOW_NO_DHE_KEX, '-', \\\n+            \"In TLSv1.3 allow non-(ec)dhe based key exchange on resumption\"}, \\\n+        {\"prioritize_chacha\", OPT_S_PRIORITIZE_CHACHA, '-', \\\n+            \"Prioritize ChaCha ciphers when preferred by clients\"}, \\\n         {\"strict\", OPT_S_STRICT, '-', \\\n             \"Enforce strict certificate checks as per TLS standard\"}, \\\n         {\"sigalgs\", OPT_S_SIGALGS, 's', \\\n             \"Signature algorithms to support (colon-separated list)\" }, \\\n         {\"client_sigalgs\", OPT_S_CLIENTSIGALGS, 's', \\\n             \"Signature algorithms to support for client certificate\" \\\n             \" authentication (colon-separated list)\" }, \\\n+        {\"groups\", OPT_S_GROUPS, 's', \\\n+            \"Groups to advertise (colon-separated list)\" }, \\\n         {\"curves\", OPT_S_CURVES, 's', \\\n-            \"Elliptic curves to advertise (colon-separated list)\" }, \\\n+            \"Groups to advertise (colon-separated list)\" }, \\\n         {\"named_curve\", OPT_S_NAMEDCURVE, 's', \\\n             \"Elliptic curve used for ECDHE (server-side only)\" }, \\\n-        {\"cipher\", OPT_S_CIPHER, 's', \"Specify cipher list to be used\"}, \\\n+        {\"cipher\", OPT_S_CIPHER, 's', \"Specify TLSv1.2 and below cipher list to be used\"}, \\\n+        {\"ciphersuites\", OPT_S_CIPHERSUITES, 's', \"Specify TLSv1.3 ciphersuites to be used\"}, \\\n         {\"min_protocol\", OPT_S_MINPROTO, 's', \"Specify the minimum protocol version to be used\"}, \\\n         {\"max_protocol\", OPT_S_MAXPROTO, 's', \"Specify the maximum protocol version to be used\"}, \\\n+        {\"record_padding\", OPT_S_RECORD_PADDING, 's', \\\n+            \"Block size to pad TLS 1.3 records to.\"}, \\\n         {\"debug_broken_protocol\", OPT_S_DEBUGBROKE, '-', \\\n-            \"Perform all sorts of protocol violations for testing purposes\"}\n+            \"Perform all sorts of protocol violations for testing purposes\"}, \\\n+        {\"no_middlebox\", OPT_S_NO_MIDDLEBOX, '-', \\\n+            \"Disable TLSv1.3 middlebox compat mode\" }\n \n # define OPT_S_CASES \\\n         OPT_S__FIRST: case OPT_S__LAST: break; \\\n         case OPT_S_NOSSL3: \\\n         case OPT_S_NOTLS1: \\\n         case OPT_S_NOTLS1_1: \\\n         case OPT_S_NOTLS1_2: \\\n+        case OPT_S_NOTLS1_3: \\\n         case OPT_S_BUGS: \\\n         case OPT_S_NO_COMP: \\\n         case OPT_S_COMP: \\\n@@ -270,20 +300,40 @@ int set_cert_times(X509 *x, const char *startdate, const char *enddate,\n         case OPT_S_LEGACYCONN: \\\n         case OPT_S_ONRESUMP: \\\n         case OPT_S_NOLEGACYCONN: \\\n+        case OPT_S_ALLOW_NO_DHE_KEX: \\\n+        case OPT_S_PRIORITIZE_CHACHA: \\\n         case OPT_S_STRICT: \\\n         case OPT_S_SIGALGS: \\\n         case OPT_S_CLIENTSIGALGS: \\\n+        case OPT_S_GROUPS: \\\n         case OPT_S_CURVES: \\\n         case OPT_S_NAMEDCURVE: \\\n         case OPT_S_CIPHER: \\\n+        case OPT_S_CIPHERSUITES: \\\n+        case OPT_S_RECORD_PADDING: \\\n+        case OPT_S_NO_RENEGOTIATION: \\\n         case OPT_S_MINPROTO: \\\n         case OPT_S_MAXPROTO: \\\n-        case OPT_S_NO_RENEGOTIATION: \\\n-        case OPT_S_DEBUGBROKE\n+        case OPT_S_DEBUGBROKE: \\\n+        case OPT_S_NO_MIDDLEBOX\n \n #define IS_NO_PROT_FLAG(o) \\\n  (o == OPT_S_NOSSL3 || o == OPT_S_NOTLS1 || o == OPT_S_NOTLS1_1 \\\n-  || o == OPT_S_NOTLS1_2)\n+  || o == OPT_S_NOTLS1_2 || o == OPT_S_NOTLS1_3)\n+\n+/*\n+ * Random state options.\n+ */\n+# define OPT_R_ENUM \\\n+        OPT_R__FIRST=1500, OPT_R_RAND, OPT_R_WRITERAND, OPT_R__LAST\n+\n+# define OPT_R_OPTIONS \\\n+    {\"rand\", OPT_R_RAND, 's', \"Load the file(s) into the random number generator\"}, \\\n+    {\"writerand\", OPT_R_WRITERAND, '>', \"Write random data to the specified file\"}\n+\n+# define OPT_R_CASES \\\n+        OPT_R__FIRST: case OPT_R__LAST: break; \\\n+        case OPT_R_RAND: case OPT_R_WRITERAND\n \n /*\n  * Option parsing.\n@@ -296,7 +346,7 @@ typedef struct options_st {\n     /*\n      * value type: - no value (also the value zero), n number, p positive\n      * number, u unsigned, l long, s string, < input file, > output file,\n-     * f any format, F der/pem format , E der/pem/engine format identifier.\n+     * f any format, F der/pem format, E der/pem/engine format identifier.\n      * l, n and u include zero; p does not.\n      */\n     int valtype;\n@@ -319,7 +369,7 @@ typedef struct string_int_pair_st {\n # define OPT_FMT_SMIME           (1L <<  3)\n # define OPT_FMT_ENGINE          (1L <<  4)\n # define OPT_FMT_MSBLOB          (1L <<  5)\n-# define OPT_FMT_NETSCAPE        (1L <<  6)\n+/* (1L <<  6) was OPT_FMT_NETSCAPE, but wasn't used */\n # define OPT_FMT_NSS             (1L <<  7)\n # define OPT_FMT_TEXT            (1L <<  8)\n # define OPT_FMT_HTTP            (1L <<  9)\n@@ -328,8 +378,8 @@ typedef struct string_int_pair_st {\n # define OPT_FMT_PDS     (OPT_FMT_PEMDER | OPT_FMT_SMIME)\n # define OPT_FMT_ANY     ( \\\n         OPT_FMT_PEMDER | OPT_FMT_PKCS12 | OPT_FMT_SMIME | \\\n-        OPT_FMT_ENGINE | OPT_FMT_MSBLOB | OPT_FMT_NETSCAPE | \\\n-        OPT_FMT_NSS | OPT_FMT_TEXT | OPT_FMT_HTTP | OPT_FMT_PVK)\n+        OPT_FMT_ENGINE | OPT_FMT_MSBLOB | OPT_FMT_NSS   | \\\n+        OPT_FMT_TEXT   | OPT_FMT_HTTP   | OPT_FMT_PVK)\n \n char *opt_progname(const char *argv0);\n char *opt_getprog(void);\n@@ -355,10 +405,10 @@ int opt_md(const char *name, const EVP_MD **mdp);\n char *opt_arg(void);\n char *opt_flag(void);\n char *opt_unknown(void);\n-char *opt_reset(void);\n char **opt_rest(void);\n int opt_num_rest(void);\n int opt_verify(int i, X509_VERIFY_PARAM *vpm);\n+int opt_rand(int i);\n void opt_help(const OPTIONS * list);\n int opt_format_error(const char *s, unsigned long flags);\n \n@@ -391,6 +441,7 @@ int password_callback(char *buf, int bufsiz, int verify, PW_CB_DATA *cb_data);\n \n int setup_ui_method(void);\n void destroy_ui_method(void);\n+const UI_METHOD *get_ui_method(void);\n \n int chopup_args(ARGS *arg, char *buf);\n # ifdef HEADER_X509_H\n@@ -401,6 +452,8 @@ void print_name(BIO *out, const char *title, X509_NAME *nm,\n void print_bignum_var(BIO *, const BIGNUM *, const char*,\n                       int, unsigned char *);\n void print_array(BIO *, const char *, int, const unsigned char *);\n+int set_nameopt(const char *arg);\n+unsigned long get_nameopt(void);\n int set_cert_ex(unsigned long *flags, const char *arg);\n int set_name_ex(unsigned long *flags, const char *arg);\n int set_ext_copy(int *copy_type, const char *arg);\n@@ -458,16 +511,21 @@ int unpack_revinfo(ASN1_TIME **prevtm, int *preason, ASN1_OBJECT **phold,\n                                  * disabled */\n # define DB_NUMBER       6\n \n-# define DB_TYPE_REV     'R'\n-# define DB_TYPE_EXP     'E'\n-# define DB_TYPE_VAL     'V'\n+# define DB_TYPE_REV     'R'    /* Revoked  */\n+# define DB_TYPE_EXP     'E'    /* Expired  */\n+# define DB_TYPE_VAL     'V'    /* Valid ; inserted with: ca ... -valid */\n+# define DB_TYPE_SUSP    'S'    /* Suspended  */\n \n typedef struct db_attr_st {\n     int unique_subject;\n } DB_ATTR;\n typedef struct ca_db_st {\n     DB_ATTR attributes;\n     TXT_DB *db;\n+    char *dbfname;\n+# ifndef OPENSSL_NO_POSIX_IO\n+    struct stat dbst;\n+# endif\n } CA_DB;\n \n void* app_malloc(int sz, const char *what);\n@@ -490,8 +548,6 @@ int index_name_cmp(const OPENSSL_CSTRING *a, const OPENSSL_CSTRING *b);\n int parse_yesno(const char *str, int def);\n \n X509_NAME *parse_name(const char *str, long chtype, int multirdn);\n-int args_verify(char ***pargs, int *pargc,\n-                int *badarg, X509_VERIFY_PARAM **pm);\n void policies_print(X509_STORE_CTX *ctx);\n int bio_to_mem(unsigned char **out, int maxlen, BIO *in);\n int pkey_ctrl_string(EVP_PKEY_CTX *ctx, const char *value);\n@@ -503,9 +559,9 @@ int do_X509_REQ_sign(X509_REQ *x, EVP_PKEY *pkey, const EVP_MD *md,\n                      STACK_OF(OPENSSL_STRING) *sigopts);\n int do_X509_CRL_sign(X509_CRL *x, EVP_PKEY *pkey, const EVP_MD *md,\n                      STACK_OF(OPENSSL_STRING) *sigopts);\n-# ifndef OPENSSL_NO_PSK\n+\n extern char *psk_key;\n-# endif\n+\n \n unsigned char *next_protos_parse(size_t *outlen, const char *in);\n \n@@ -546,7 +602,12 @@ void store_setup_crl_download(X509_STORE *st);\n \n # define APP_PASS_LEN    1024\n \n-# define SERIAL_RAND_BITS        64\n+/*\n+ * IETF RFC 5280 says serial number must be <= 20 bytes. Use 159 bits\n+ * so that the first bit will never be one, so that the DER encoding\n+ * rules won't force a leading octet.\n+ */\n+# define SERIAL_RAND_BITS        159\n \n int app_isdir(const char *);\n int app_access(const char *, int flag);\n@@ -559,6 +620,8 @@ int raw_write_stdout(const void *, int);\n # define TM_STOP         1\n double app_tminterval(int stop, int usertime);\n \n+void make_uppercase(char *string);\n+\n typedef struct verify_options_st {\n     int depth;\n     int quiet;\n@@ -568,6 +631,4 @@ typedef struct verify_options_st {\n \n extern VERIFY_CB_ARGS verify_args;\n \n-# include \"progs.h\"\n-\n #endif"
        },
        {
            "sha": "62c70b9cc4405e97581316e025241d80e614082b",
            "filename": "deps/openssl/openssl/apps/asn1pars.c",
            "status": "modified",
            "additions": 48,
            "deletions": 21,
            "changes": 69,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fasn1pars.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fasn1pars.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fasn1pars.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -7,28 +7,26 @@\n  * https://www.openssl.org/source/license.html\n  */\n \n-/*\n- * A nice addition from Dr Stephen Henson <steve@openssl.org> to add the\n- * -strparse option which parses nested binary structures\n- */\n-\n #include <stdio.h>\n #include <stdlib.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/err.h>\n #include <openssl/evp.h>\n #include <openssl/x509.h>\n #include <openssl/pem.h>\n+#include <openssl/asn1t.h>\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_INFORM, OPT_IN, OPT_OUT, OPT_INDENT, OPT_NOOUT,\n     OPT_OID, OPT_OFFSET, OPT_LENGTH, OPT_DUMP, OPT_DLIMIT,\n-    OPT_STRPARSE, OPT_GENSTR, OPT_GENCONF, OPT_STRICTPEM\n+    OPT_STRPARSE, OPT_GENSTR, OPT_GENCONF, OPT_STRICTPEM,\n+    OPT_ITEM\n } OPTION_CHOICE;\n \n-OPTIONS asn1parse_options[] = {\n+const OPTIONS asn1parse_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"inform\", OPT_INFORM, 'F', \"input format - one of DER PEM\"},\n     {\"in\", OPT_IN, '<', \"input file\"},\n@@ -49,6 +47,7 @@ OPTIONS asn1parse_options[] = {\n     {OPT_MORE_STR, 0, 0, \"(-inform  will be ignored)\"},\n     {\"strictpem\", OPT_STRICTPEM, 0,\n      \"do not attempt base64 decode outside PEM markers\"},\n+    {\"item\", OPT_ITEM, 's', \"item to parse and print\"},\n     {NULL}\n };\n \n@@ -71,6 +70,7 @@ int asn1parse_main(int argc, char **argv)\n     unsigned char *tmpbuf;\n     unsigned int length = 0;\n     OPTION_CHOICE o;\n+    const ASN1_ITEM *it = NULL;\n \n     prog = opt_init(argc, argv, asn1parse_options);\n \n@@ -134,6 +134,22 @@ int asn1parse_main(int argc, char **argv)\n             strictpem = 1;\n             informat = FORMAT_PEM;\n             break;\n+        case OPT_ITEM:\n+            it = ASN1_ITEM_lookup(opt_arg());\n+            if (it == NULL) {\n+                size_t tmp;\n+\n+                BIO_printf(bio_err, \"Unknown item name %s\\n\", opt_arg());\n+                BIO_puts(bio_err, \"Supported types:\\n\");\n+                for (tmp = 0;; tmp++) {\n+                    it = ASN1_ITEM_get(tmp);\n+                    if (it == NULL)\n+                        break;\n+                    BIO_printf(bio_err, \"    %s\\n\", it->sname);\n+                }\n+                goto end;\n+            }\n+            break;\n         }\n     }\n     argc = opt_num_rest();\n@@ -174,9 +190,7 @@ int asn1parse_main(int argc, char **argv)\n                 ERR_print_errors(bio_err);\n                 goto end;\n             }\n-        }\n-\n-        else {\n+        } else {\n \n             if (informat == FORMAT_PEM) {\n                 BIO *tmp;\n@@ -253,18 +267,31 @@ int asn1parse_main(int argc, char **argv)\n \n     if (length == 0 || length > (unsigned int)num)\n         length = (unsigned int)num;\n-    if (derout) {\n+    if (derout != NULL) {\n         if (BIO_write(derout, str + offset, length) != (int)length) {\n             BIO_printf(bio_err, \"Error writing output\\n\");\n             ERR_print_errors(bio_err);\n             goto end;\n         }\n     }\n-    if (!noout &&\n-        !ASN1_parse_dump(bio_out, &(str[offset]), length,\n-                         indent, dump)) {\n-        ERR_print_errors(bio_err);\n-        goto end;\n+    if (!noout) {\n+        const unsigned char *p = str + offset;\n+\n+        if (it != NULL) {\n+            ASN1_VALUE *value = ASN1_item_d2i(NULL, &p, length, it);\n+            if (value == NULL) {\n+                BIO_printf(bio_err, \"Error parsing item %s\\n\", it->sname);\n+                ERR_print_errors(bio_err);\n+                goto end;\n+            }\n+            ASN1_item_print(bio_out, value, 0, it, NULL);\n+            ASN1_item_free(value, it);\n+        } else {\n+            if (!ASN1_parse_dump(bio_out, p, length, indent, dump)) {\n+                ERR_print_errors(bio_err);\n+                goto end;\n+            }\n+        }\n     }\n     ret = 0;\n  end:\n@@ -280,7 +307,7 @@ int asn1parse_main(int argc, char **argv)\n         OPENSSL_free(str);\n     ASN1_TYPE_free(at);\n     sk_OPENSSL_STRING_free(osk);\n-    return (ret);\n+    return ret;\n }\n \n static int do_generate(char *genstr, const char *genconf, BUF_MEM *buf)\n@@ -290,12 +317,12 @@ static int do_generate(char *genstr, const char *genconf, BUF_MEM *buf)\n     unsigned char *p;\n     ASN1_TYPE *atyp = NULL;\n \n-    if (genconf) {\n+    if (genconf != NULL) {\n         if ((cnf = app_load_config(genconf)) == NULL)\n             goto err;\n-        if (!genstr)\n+        if (genstr == NULL)\n             genstr = NCONF_get_string(cnf, \"default\", \"asn1\");\n-        if (!genstr) {\n+        if (genstr == NULL) {\n             BIO_printf(bio_err, \"Can't find 'asn1' in '%s'\\n\", genconf);\n             goto err;\n         }\n@@ -305,7 +332,7 @@ static int do_generate(char *genstr, const char *genconf, BUF_MEM *buf)\n     NCONF_free(cnf);\n     cnf = NULL;\n \n-    if (!atyp)\n+    if (atyp == NULL)\n         return -1;\n \n     len = i2d_ASN1_TYPE(atyp, NULL);"
        },
        {
            "sha": "bae3c91bf8b385494ec0ffba1a6ee92b5266a052",
            "filename": "deps/openssl/openssl/apps/bf_prefix.c",
            "status": "added",
            "additions": 177,
            "deletions": 0,
            "changes": 177,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fbf_prefix.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fbf_prefix.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fbf_prefix.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -0,0 +1,177 @@\n+/*\n+ * Copyright 2018 The OpenSSL Project Authors. All Rights Reserved.\n+ *\n+ * Licensed under the OpenSSL license (the \"License\").  You may not use\n+ * this file except in compliance with the License.  You can obtain a copy\n+ * in the file LICENSE in the source distribution or at\n+ * https://www.openssl.org/source/license.html\n+ */\n+\n+#include <stdio.h>\n+#include <string.h>\n+#include <errno.h>\n+#include <openssl/bio.h>\n+#include \"apps.h\"\n+\n+static int prefix_write(BIO *b, const char *out, size_t outl,\n+                        size_t *numwritten);\n+static int prefix_read(BIO *b, char *buf, size_t size, size_t *numread);\n+static int prefix_puts(BIO *b, const char *str);\n+static int prefix_gets(BIO *b, char *str, int size);\n+static long prefix_ctrl(BIO *b, int cmd, long arg1, void *arg2);\n+static int prefix_create(BIO *b);\n+static int prefix_destroy(BIO *b);\n+static long prefix_callback_ctrl(BIO *b, int cmd, BIO_info_cb *fp);\n+\n+static BIO_METHOD *prefix_meth = NULL;\n+\n+BIO_METHOD *apps_bf_prefix(void)\n+{\n+    if (prefix_meth == NULL) {\n+        if ((prefix_meth =\n+             BIO_meth_new(BIO_TYPE_FILTER, \"Prefix filter\")) == NULL\n+            || !BIO_meth_set_create(prefix_meth, prefix_create)\n+            || !BIO_meth_set_destroy(prefix_meth, prefix_destroy)\n+            || !BIO_meth_set_write_ex(prefix_meth, prefix_write)\n+            || !BIO_meth_set_read_ex(prefix_meth, prefix_read)\n+            || !BIO_meth_set_puts(prefix_meth, prefix_puts)\n+            || !BIO_meth_set_gets(prefix_meth, prefix_gets)\n+            || !BIO_meth_set_ctrl(prefix_meth, prefix_ctrl)\n+            || !BIO_meth_set_callback_ctrl(prefix_meth, prefix_callback_ctrl)) {\n+            BIO_meth_free(prefix_meth);\n+            prefix_meth = NULL;\n+        }\n+    }\n+    return prefix_meth;\n+}\n+\n+typedef struct prefix_ctx_st {\n+    char *prefix;\n+    int linestart;               /* flag to indicate we're at the line start */\n+} PREFIX_CTX;\n+\n+static int prefix_create(BIO *b)\n+{\n+    PREFIX_CTX *ctx = OPENSSL_zalloc(sizeof(*ctx));\n+\n+    if (ctx == NULL)\n+        return 0;\n+\n+    ctx->prefix = NULL;\n+    ctx->linestart = 1;\n+    BIO_set_data(b, ctx);\n+    BIO_set_init(b, 1);\n+    return 1;\n+}\n+\n+static int prefix_destroy(BIO *b)\n+{\n+    PREFIX_CTX *ctx = BIO_get_data(b);\n+\n+    OPENSSL_free(ctx->prefix);\n+    OPENSSL_free(ctx);\n+    return 1;\n+}\n+\n+static int prefix_read(BIO *b, char *in, size_t size, size_t *numread)\n+{\n+    return BIO_read_ex(BIO_next(b), in, size, numread);\n+}\n+\n+static int prefix_write(BIO *b, const char *out, size_t outl,\n+                        size_t *numwritten)\n+{\n+    PREFIX_CTX *ctx = BIO_get_data(b);\n+\n+    if (ctx == NULL)\n+        return 0;\n+\n+    /* If no prefix is set or if it's empty, we've got nothing to do here */\n+    if (ctx->prefix == NULL || *ctx->prefix == '\\0') {\n+        /* We do note if what comes next will be a new line, though */\n+        if (outl > 0)\n+            ctx->linestart = (out[outl-1] == '\\n');\n+        return BIO_write_ex(BIO_next(b), out, outl, numwritten);\n+    }\n+\n+    *numwritten = 0;\n+\n+    while (outl > 0) {\n+        size_t i;\n+        char c;\n+\n+        /* If we know that we're at the start of the line, output the prefix */\n+        if (ctx->linestart) {\n+            size_t dontcare;\n+\n+            if (!BIO_write_ex(BIO_next(b), ctx->prefix, strlen(ctx->prefix),\n+                              &dontcare))\n+                return 0;\n+            ctx->linestart = 0;\n+        }\n+\n+        /* Now, go look for the next LF, or the end of the string */\n+        for (i = 0, c = '\\0'; i < outl && (c = out[i]) != '\\n'; i++)\n+            continue;\n+        if (c == '\\n')\n+            i++;\n+\n+        /* Output what we found so far */\n+        while (i > 0) {\n+            size_t num = 0;\n+\n+            if (!BIO_write_ex(BIO_next(b), out, i, &num))\n+                return 0;\n+            out += num;\n+            outl -= num;\n+            *numwritten += num;\n+            i -= num;\n+        }\n+\n+        /* If we found a LF, what follows is a new line, so take note */\n+        if (c == '\\n')\n+            ctx->linestart = 1;\n+    }\n+\n+    return 1;\n+}\n+\n+static long prefix_ctrl(BIO *b, int cmd, long num, void *ptr)\n+{\n+    long ret = 0;\n+\n+    switch (cmd) {\n+    case PREFIX_CTRL_SET_PREFIX:\n+        {\n+            PREFIX_CTX *ctx = BIO_get_data(b);\n+\n+            if (ctx == NULL)\n+                break;\n+\n+            OPENSSL_free(ctx->prefix);\n+            ctx->prefix = OPENSSL_strdup((const char *)ptr);\n+            ret = ctx->prefix != NULL;\n+        }\n+        break;\n+    default:\n+        if (BIO_next(b) != NULL)\n+            ret = BIO_ctrl(BIO_next(b), cmd, num, ptr);\n+        break;\n+    }\n+    return ret;\n+}\n+\n+static long prefix_callback_ctrl(BIO *b, int cmd, BIO_info_cb *fp)\n+{\n+    return BIO_callback_ctrl(BIO_next(b), cmd, fp);\n+}\n+\n+static int prefix_gets(BIO *b, char *buf, int size)\n+{\n+    return BIO_gets(BIO_next(b), buf, size);\n+}\n+\n+static int prefix_puts(BIO *b, const char *str)\n+{\n+    return BIO_write(b, str, strlen(str));\n+}"
        },
        {
            "sha": "751d8da82818152995991e4ce50a649927294e37",
            "filename": "deps/openssl/openssl/apps/build.info",
            "status": "modified",
            "additions": 25,
            "deletions": 15,
            "changes": 40,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fbuild.info",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fbuild.info",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fbuild.info?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,28 +1,38 @@\n-{- our $tsget_name = $config{target} =~ /^(VC|vms)-/ ? \"tsget.pl\" : \"tsget\";\n-   our @apps_openssl_src =\n-       ( qw(openssl.c\n-            asn1pars.c ca.c ciphers.c cms.c crl.c crl2p7.c dgst.c dhparam.c\n-            dsa.c dsaparam.c ec.c ecparam.c enc.c engine.c errstr.c gendsa.c\n-            genpkey.c genrsa.c nseq.c ocsp.c passwd.c pkcs12.c pkcs7.c pkcs8.c\n-            pkey.c pkeyparam.c pkeyutl.c prime.c rand.c req.c rsa.c rsautl.c\n-            s_client.c s_server.c s_time.c sess_id.c smime.c speed.c spkac.c\n-            srp.c ts.c verify.c version.c x509.c rehash.c\n-            apps.c opt.c s_cb.c s_socket.c\n-            app_rand.c),\n-          split(/\\s+/, $target{apps_aux_src}) );\n+{- our @apps_openssl_src =\n+       qw(openssl.c\n+          asn1pars.c ca.c ciphers.c cms.c crl.c crl2p7.c dgst.c dhparam.c\n+          dsa.c dsaparam.c ec.c ecparam.c enc.c engine.c errstr.c gendsa.c\n+          genpkey.c genrsa.c nseq.c ocsp.c passwd.c pkcs12.c pkcs7.c pkcs8.c\n+          pkey.c pkeyparam.c pkeyutl.c prime.c rand.c req.c rsa.c rsautl.c\n+          s_client.c s_server.c s_time.c sess_id.c smime.c speed.c spkac.c\n+          srp.c ts.c verify.c version.c x509.c rehash.c storeutl.c);\n+   our @apps_lib_src =\n+       ( qw(apps.c opt.c s_cb.c s_socket.c app_rand.c bf_prefix.c),\n+         split(/\\s+/, $target{apps_aux_src}) );\n+   our @apps_init_src = split(/\\s+/, $target{apps_init_src});\n    \"\" -}\n IF[{- !$disabled{apps} -}]\n+  LIBS_NO_INST=libapps.a\n+  SOURCE[libapps.a]={- join(\" \", @apps_lib_src) -}\n+  INCLUDE[libapps.a]=.. ../include\n+\n   PROGRAMS=openssl\n+  SOURCE[openssl]={- join(\" \", @apps_init_src) -}\n   SOURCE[openssl]={- join(\" \", @apps_openssl_src) -}\n   INCLUDE[openssl]=.. ../include\n-  DEPEND[openssl]=../libssl\n+  DEPEND[openssl]=libapps.a ../libssl\n+\n+IF[{- $config{target} =~ /^(?:Cygwin|mingw|VC-)/ -}]\n+  GENERATE[openssl.rc]=../util/mkrc.pl openssl\n+  SOURCE[openssl]=openssl.rc\n+ENDIF\n \n   {- join(\"\\n  \", map { (my $x = $_) =~ s|\\.c$|.o|; \"DEPEND[$x]=progs.h\" }\n                   @apps_openssl_src) -}\n   GENERATE[progs.h]=progs.pl $(APPS_OPENSSL)\n   DEPEND[progs.h]=../configdata.pm\n \n-  SCRIPTS=CA.pl {- $tsget_name -}\n+  SCRIPTS=CA.pl tsget.pl\n   SOURCE[CA.pl]=CA.pl.in\n-  SOURCE[{- $tsget_name -}]=tsget.in\n+  SOURCE[tsget.pl]=tsget.in\n ENDIF"
        },
        {
            "sha": "69207c0662ed7f16f5c1f87f52ac80bf58a0c099",
            "filename": "deps/openssl/openssl/apps/ca.c",
            "status": "modified",
            "additions": 235,
            "deletions": 233,
            "changes": 468,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fca.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fca.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fca.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -6,9 +6,6 @@\n  * in the file LICENSE in the source distribution or at\n  * https://www.openssl.org/source/license.html\n  */\n-\n-/* The PPKI stuff has been donated by Jeff Barber <jeffb@issl.atl.hp.com> */\n-\n #include <stdio.h>\n #include <stdlib.h>\n #include <string.h>\n@@ -28,27 +25,24 @@\n \n #ifndef W_OK\n # ifdef OPENSSL_SYS_VMS\n-#  if defined(__DECC)\n-#   include <unistd.h>\n-#  else\n-#   include <unixlib.h>\n-#  endif\n+#  include <unistd.h>\n # elif !defined(OPENSSL_SYS_VXWORKS) && !defined(OPENSSL_SYS_WINDOWS)\n #  include <sys/file.h>\n # endif\n #endif\n \n #include \"apps.h\"\n+#include \"progs.h\"\n \n #ifndef W_OK\n # define F_OK 0\n-# define X_OK 1\n # define W_OK 2\n # define R_OK 4\n #endif\n \n-#undef BSIZE\n-#define BSIZE 256\n+#ifndef PATH_MAX\n+# define PATH_MAX 4096\n+#endif\n \n #define BASE_SECTION            \"ca\"\n \n@@ -60,6 +54,7 @@\n #define ENV_NEW_CERTS_DIR       \"new_certs_dir\"\n #define ENV_CERTIFICATE         \"certificate\"\n #define ENV_SERIAL              \"serial\"\n+#define ENV_RAND_SERIAL         \"rand_serial\"\n #define ENV_CRLNUMBER           \"crlnumber\"\n #define ENV_PRIVATE_KEY         \"private_key\"\n #define ENV_DEFAULT_DAYS        \"default_days\"\n@@ -82,12 +77,14 @@\n #define ENV_DATABASE            \"database\"\n \n /* Additional revocation information types */\n-\n-#define REV_NONE                0 /* No additional information */\n-#define REV_CRL_REASON          1 /* Value is CRL reason code */\n-#define REV_HOLD                2 /* Value is hold instruction */\n-#define REV_KEY_COMPROMISE      3 /* Value is cert key compromise time */\n-#define REV_CA_COMPROMISE       4 /* Value is CA key compromise time */\n+typedef enum {\n+    REV_VALID             = -1, /* Valid (not-revoked) status */\n+    REV_NONE              = 0, /* No additional information */\n+    REV_CRL_REASON        = 1, /* Value is CRL reason code */\n+    REV_HOLD              = 2, /* Value is hold instruction */\n+    REV_KEY_COMPROMISE    = 3, /* Value is cert key compromise time */\n+    REV_CA_COMPROMISE     = 4  /* Value is CA key compromise time */\n+} REVINFO_TYPE;\n \n static char *lookup_conf(const CONF *conf, const char *group, const char *tag);\n \n@@ -117,7 +114,6 @@ static int certify_spkac(X509 **xret, const char *infile, EVP_PKEY *pkey,\n                          const char *enddate, long days, const char *ext_sect, CONF *conf,\n                          int verbose, unsigned long certopt,\n                          unsigned long nameopt, int default_op, int ext_copy);\n-static void write_new_certificate(BIO *bp, X509 *x, int output_der, int notext);\n static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n                    const EVP_MD *dgst, STACK_OF(OPENSSL_STRING) *sigopts,\n                    STACK_OF(CONF_VALUE) *policy, CA_DB *db, BIGNUM *serial,\n@@ -126,13 +122,15 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n                    int batch, int verbose, X509_REQ *req, const char *ext_sect,\n                    CONF *conf, unsigned long certopt, unsigned long nameopt,\n                    int default_op, int ext_copy, int selfsign);\n-static int do_revoke(X509 *x509, CA_DB *db, int ext, char *extval);\n static int get_certificate_status(const char *ser_status, CA_DB *db);\n static int do_updatedb(CA_DB *db);\n static int check_time_format(const char *str);\n-char *make_revocation_str(int rev_type, char *rev_arg);\n-int make_revoked(X509_REVOKED *rev, const char *str);\n+static int do_revoke(X509 *x509, CA_DB *db, REVINFO_TYPE rev_type,\n+                     const char *extval);\n+static char *make_revocation_str(REVINFO_TYPE rev_type, const char *rev_arg);\n+static int make_revoked(X509_REVOKED *rev, const char *str);\n static int old_entry_print(const ASN1_OBJECT *obj, const ASN1_STRING *str);\n+static void write_new_certificate(BIO *bp, X509 *x, int output_der, int notext);\n \n static CONF *extconf = NULL;\n static int preserve = 0;\n@@ -148,11 +146,13 @@ typedef enum OPTION_choice {\n     OPT_GENCRL, OPT_MSIE_HACK, OPT_CRLDAYS, OPT_CRLHOURS, OPT_CRLSEC,\n     OPT_INFILES, OPT_SS_CERT, OPT_SPKAC, OPT_REVOKE, OPT_VALID,\n     OPT_EXTENSIONS, OPT_EXTFILE, OPT_STATUS, OPT_UPDATEDB, OPT_CRLEXTS,\n-    OPT_CRL_REASON, OPT_CRL_HOLD, OPT_CRL_COMPROMISE,\n-    OPT_CRL_CA_COMPROMISE\n+    OPT_RAND_SERIAL,\n+    OPT_R_ENUM,\n+    /* Do not change the order here; see related case statements below */\n+    OPT_CRL_REASON, OPT_CRL_HOLD, OPT_CRL_COMPROMISE, OPT_CRL_CA_COMPROMISE\n } OPTION_CHOICE;\n \n-OPTIONS ca_options[] = {\n+const OPTIONS ca_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"verbose\", OPT_VERBOSE, '-', \"Verbose output during processing\"},\n     {\"config\", OPT_CONFIG, 's', \"A config file\"},\n@@ -161,6 +161,8 @@ OPTIONS ca_options[] = {\n     {\"utf8\", OPT_UTF8, '-', \"Input characters are UTF8 (default ASCII)\"},\n     {\"create_serial\", OPT_CREATE_SERIAL, '-',\n      \"If reading serial fails, create a new random serial\"},\n+    {\"rand_serial\", OPT_RAND_SERIAL, '-',\n+     \"Always create a random serial; do not store it\"},\n     {\"multivalue-rdn\", OPT_MULTIVALUE_RDN, '-',\n      \"Enable support for multivalued RDNs\"},\n     {\"startdate\", OPT_STARTDATE, 's', \"Cert notBefore, YYMMDDHHMMSSZ\"},\n@@ -212,6 +214,7 @@ OPTIONS ca_options[] = {\n      \"sets compromise time to val and the revocation reason to keyCompromise\"},\n     {\"crl_CA_compromise\", OPT_CRL_CA_COMPROMISE, 's',\n      \"sets compromise time to val and the revocation reason to CACompromise\"},\n+    OPT_R_OPTIONS,\n #ifndef OPENSSL_NO_ENGINE\n     {\"engine\", OPT_ENGINE, 's', \"Use engine, possibly a hardware device\"},\n #endif\n@@ -242,18 +245,21 @@ int ca_main(int argc, char **argv)\n     char *outdir = NULL, *outfile = NULL, *rev_arg = NULL, *ser_status = NULL;\n     const char *serialfile = NULL, *subj = NULL;\n     char *prog, *startdate = NULL, *enddate = NULL;\n-    char *dbfile = NULL, *f, *randfile = NULL;\n-    char buf[3][BSIZE];\n+    char *dbfile = NULL, *f;\n+    char new_cert[PATH_MAX];\n+    char tmp[10 + 1] = \"\\0\";\n     char *const *pp;\n     const char *p;\n+    size_t outdirlen = 0;\n     int create_ser = 0, free_key = 0, total = 0, total_done = 0;\n     int batch = 0, default_op = 1, doupdatedb = 0, ext_copy = EXT_COPY_NONE;\n     int keyformat = FORMAT_PEM, multirdn = 0, notext = 0, output_der = 0;\n     int ret = 1, email_dn = 1, req = 0, verbose = 0, gencrl = 0, dorevoke = 0;\n-    int i, j, rev_type = REV_NONE, selfsign = 0;\n+    int rand_ser = 0, i, j, selfsign = 0, def_nid, def_ret;\n     long crldays = 0, crlhours = 0, crlsec = 0, days = 0;\n-    unsigned long chtype = MBSTRING_ASC, nameopt = 0, certopt = 0;\n+    unsigned long chtype = MBSTRING_ASC, certopt = 0;\n     X509 *x509 = NULL, *x509p = NULL, *x = NULL;\n+    REVINFO_TYPE rev_type = REV_NONE;\n     X509_REVOKED *r = NULL;\n     OPTION_CHOICE o;\n \n@@ -292,6 +298,9 @@ int ca_main(int argc, char **argv)\n         case OPT_UTF8:\n             chtype = MBSTRING_UTF8;\n             break;\n+        case OPT_RAND_SERIAL:\n+            rand_ser = 1;\n+            break;\n         case OPT_CREATE_SERIAL:\n             create_ser = 1;\n             break;\n@@ -323,6 +332,10 @@ int ca_main(int argc, char **argv)\n         case OPT_PASSIN:\n             passinarg = opt_arg();\n             break;\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n+            break;\n         case OPT_KEY:\n             key = opt_arg();\n             break;\n@@ -338,8 +351,7 @@ int ca_main(int argc, char **argv)\n         case OPT_SIGOPT:\n             if (sigopts == NULL)\n                 sigopts = sk_OPENSSL_STRING_new_null();\n-            if (sigopts == NULL\n-                || !sk_OPENSSL_STRING_push(sigopts, opt_arg()))\n+            if (sigopts == NULL || !sk_OPENSSL_STRING_push(sigopts, opt_arg()))\n                 goto end;\n             break;\n         case OPT_NOTEXT:\n@@ -403,21 +415,12 @@ int ca_main(int argc, char **argv)\n         case OPT_CRLEXTS:\n             crl_ext = opt_arg();\n             break;\n-        case OPT_CRL_REASON:\n-            rev_arg = opt_arg();\n-            rev_type = REV_CRL_REASON;\n-            break;\n+        case OPT_CRL_REASON:   /* := REV_CRL_REASON */\n         case OPT_CRL_HOLD:\n-            rev_arg = opt_arg();\n-            rev_type = REV_HOLD;\n-            break;\n         case OPT_CRL_COMPROMISE:\n-            rev_arg = opt_arg();\n-            rev_type = REV_KEY_COMPROMISE;\n-            break;\n         case OPT_CRL_CA_COMPROMISE:\n             rev_arg = opt_arg();\n-            rev_type = REV_CA_COMPROMISE;\n+            rev_type = (o - OPT_CRL_REASON) + REV_CRL_REASON;\n             break;\n         case OPT_ENGINE:\n             e = setup_engine(opt_arg(), 0);\n@@ -458,33 +461,30 @@ int ca_main(int argc, char **argv)\n         goto end;\n     }\n \n-    randfile = NCONF_get_string(conf, BASE_SECTION, \"RANDFILE\");\n-    if (randfile == NULL)\n-        ERR_clear_error();\n-    app_RAND_load_file(randfile, 0);\n+    app_RAND_load_conf(conf, BASE_SECTION);\n \n     f = NCONF_get_string(conf, section, STRING_MASK);\n-    if (!f)\n+    if (f == NULL)\n         ERR_clear_error();\n \n-    if (f && !ASN1_STRING_set_default_mask_asc(f)) {\n+    if (f != NULL && !ASN1_STRING_set_default_mask_asc(f)) {\n         BIO_printf(bio_err, \"Invalid global string mask setting %s\\n\", f);\n         goto end;\n     }\n \n     if (chtype != MBSTRING_UTF8) {\n         f = NCONF_get_string(conf, section, UTF8_IN);\n-        if (!f)\n+        if (f == NULL)\n             ERR_clear_error();\n         else if (strcmp(f, \"yes\") == 0)\n             chtype = MBSTRING_UTF8;\n     }\n \n     db_attr.unique_subject = 1;\n     p = NCONF_get_string(conf, section, ENV_UNIQUE_SUBJECT);\n-    if (p) {\n+    if (p != NULL)\n         db_attr.unique_subject = parse_yesno(p, 1);\n-    } else\n+    else\n         ERR_clear_error();\n \n     /*****************************************************************/\n@@ -498,7 +498,7 @@ int ca_main(int argc, char **argv)\n         if (db == NULL)\n             goto end;\n \n-        if (!index_index(db))\n+        if (index_index(db) <= 0)\n             goto end;\n \n         if (get_certificate_status(ser_status, db) != 1)\n@@ -513,20 +513,19 @@ int ca_main(int argc, char **argv)\n         && (keyfile = lookup_conf(conf, section, ENV_PRIVATE_KEY)) == NULL)\n         goto end;\n \n-    if (!key) {\n+    if (key == NULL) {\n         free_key = 1;\n         if (!app_passwd(passinarg, NULL, &key, NULL)) {\n             BIO_printf(bio_err, \"Error getting password\\n\");\n             goto end;\n         }\n     }\n     pkey = load_key(keyfile, keyformat, 0, key, e, \"CA private key\");\n-    if (key)\n+    if (key != NULL)\n         OPENSSL_cleanse(key, strlen(key));\n-    if (pkey == NULL) {\n+    if (pkey == NULL)\n         /* load_key() has already printed an appropriate message */\n         goto end;\n-    }\n \n     /*****************************************************************/\n     /* we need a certificate */\n@@ -561,37 +560,36 @@ int ca_main(int argc, char **argv)\n \n     f = NCONF_get_string(conf, section, ENV_NAMEOPT);\n \n-    if (f) {\n-        if (!set_name_ex(&nameopt, f)) {\n+    if (f != NULL) {\n+        if (!set_nameopt(f)) {\n             BIO_printf(bio_err, \"Invalid name options: \\\"%s\\\"\\n\", f);\n             goto end;\n         }\n         default_op = 0;\n-    } else {\n-        nameopt = XN_FLAG_ONELINE;\n-        ERR_clear_error();\n     }\n \n     f = NCONF_get_string(conf, section, ENV_CERTOPT);\n \n-    if (f) {\n+    if (f != NULL) {\n         if (!set_cert_ex(&certopt, f)) {\n             BIO_printf(bio_err, \"Invalid certificate options: \\\"%s\\\"\\n\", f);\n             goto end;\n         }\n         default_op = 0;\n-    } else\n+    } else {\n         ERR_clear_error();\n+    }\n \n     f = NCONF_get_string(conf, section, ENV_EXTCOPY);\n \n-    if (f) {\n+    if (f != NULL) {\n         if (!set_ext_copy(&ext_copy, f)) {\n             BIO_printf(bio_err, \"Invalid extension copy option: \\\"%s\\\"\\n\", f);\n             goto end;\n         }\n-    } else\n+    } else {\n         ERR_clear_error();\n+    }\n \n     /*****************************************************************/\n     /* lookup where to write new certificates */\n@@ -607,7 +605,7 @@ int ca_main(int argc, char **argv)\n         /*\n          * outdir is a directory spec, but access() for VMS demands a\n          * filename.  We could use the DEC C routine to convert the\n-         * directory syntax to Unixly, and give that to app_isdir,\n+         * directory syntax to Unix, and give that to app_isdir,\n          * but for now the fopen will catch the error if it's not a\n          * directory\n          */\n@@ -674,7 +672,7 @@ int ca_main(int argc, char **argv)\n         BIO_printf(bio_err, \"generating index\\n\");\n     }\n \n-    if (!index_index(db))\n+    if (index_index(db) <= 0)\n         goto end;\n \n     /*****************************************************************/\n@@ -698,8 +696,7 @@ int ca_main(int argc, char **argv)\n                 goto end;\n \n             if (verbose)\n-                BIO_printf(bio_err,\n-                           \"Done. %d entries marked as expired\\n\", i);\n+                BIO_printf(bio_err, \"Done. %d entries marked as expired\\n\", i);\n         }\n     }\n \n@@ -731,21 +728,28 @@ int ca_main(int argc, char **argv)\n         }\n     }\n \n-    if (md == NULL\n-        && (md = lookup_conf(conf, section, ENV_DEFAULT_MD)) == NULL)\n+    def_ret = EVP_PKEY_get_default_digest_nid(pkey, &def_nid);\n+    /*\n+     * EVP_PKEY_get_default_digest_nid() returns 2 if the digest is\n+     * mandatory for this algorithm.\n+     */\n+    if (def_ret == 2 && def_nid == NID_undef) {\n+        /* The signing algorithm requires there to be no digest */\n+        dgst = EVP_md_null();\n+    } else if (md == NULL\n+               && (md = lookup_conf(conf, section, ENV_DEFAULT_MD)) == NULL) {\n         goto end;\n-\n-    if (strcmp(md, \"default\") == 0) {\n-        int def_nid;\n-        if (EVP_PKEY_get_default_digest_nid(pkey, &def_nid) <= 0) {\n-            BIO_puts(bio_err, \"no default digest\\n\");\n-            goto end;\n+    } else {\n+        if (strcmp(md, \"default\") == 0) {\n+            if (def_ret <= 0) {\n+                BIO_puts(bio_err, \"no default digest\\n\");\n+                goto end;\n+            }\n+            md = (char *)OBJ_nid2sn(def_nid);\n         }\n-        md = (char *)OBJ_nid2sn(def_nid);\n-    }\n \n-    if (!opt_md(md, &dgst)) {\n-        goto end;\n+        if (!opt_md(md, &dgst))\n+            goto end;\n     }\n \n     if (req) {\n@@ -766,21 +770,25 @@ int ca_main(int argc, char **argv)\n         if (verbose)\n             BIO_printf(bio_err, \"policy is %s\\n\", policy);\n \n-        serialfile = lookup_conf(conf, section, ENV_SERIAL);\n-        if (serialfile == NULL)\n-            goto end;\n+        if (NCONF_get_string(conf, section, ENV_RAND_SERIAL) != NULL) {\n+            rand_ser = 1;\n+        } else {\n+            serialfile = lookup_conf(conf, section, ENV_SERIAL);\n+            if (serialfile == NULL)\n+                goto end;\n+        }\n \n-        if (!extconf) {\n+        if (extconf == NULL) {\n             /*\n              * no '-extfile' option, so we look for extensions in the main\n              * configuration file\n              */\n-            if (!extensions) {\n+            if (extensions == NULL) {\n                 extensions = NCONF_get_string(conf, section, ENV_EXTENSIONS);\n-                if (!extensions)\n+                if (extensions == NULL)\n                     ERR_clear_error();\n             }\n-            if (extensions) {\n+            if (extensions != NULL) {\n                 /* Check syntax of file */\n                 X509V3_CTX ctx;\n                 X509V3_set_ctx_test(&ctx);\n@@ -796,12 +804,11 @@ int ca_main(int argc, char **argv)\n         }\n \n         if (startdate == NULL) {\n-            startdate = NCONF_get_string(conf, section,\n-                                         ENV_DEFAULT_STARTDATE);\n+            startdate = NCONF_get_string(conf, section, ENV_DEFAULT_STARTDATE);\n             if (startdate == NULL)\n                 ERR_clear_error();\n         }\n-        if (startdate && !ASN1_TIME_set_string(NULL, startdate)) {\n+        if (startdate != NULL && !ASN1_TIME_set_string_X509(NULL, startdate)) {\n             BIO_printf(bio_err,\n                        \"start date is invalid, it should be YYMMDDHHMMSSZ or YYYYMMDDHHMMSSZ\\n\");\n             goto end;\n@@ -814,7 +821,7 @@ int ca_main(int argc, char **argv)\n             if (enddate == NULL)\n                 ERR_clear_error();\n         }\n-        if (enddate && !ASN1_TIME_set_string(NULL, enddate)) {\n+        if (enddate != NULL && !ASN1_TIME_set_string_X509(NULL, enddate)) {\n             BIO_printf(bio_err,\n                        \"end date is invalid, it should be YYMMDDHHMMSSZ or YYYYMMDDHHMMSSZ\\n\");\n             goto end;\n@@ -824,24 +831,30 @@ int ca_main(int argc, char **argv)\n             if (!NCONF_get_number(conf, section, ENV_DEFAULT_DAYS, &days))\n                 days = 0;\n         }\n-        if (!enddate && (days == 0)) {\n-            BIO_printf(bio_err,\n-                       \"cannot lookup how many days to certify for\\n\");\n+        if (enddate == NULL && days == 0) {\n+            BIO_printf(bio_err, \"cannot lookup how many days to certify for\\n\");\n             goto end;\n         }\n \n-        if ((serial = load_serial(serialfile, create_ser, NULL)) == NULL) {\n-            BIO_printf(bio_err, \"error while loading serial number\\n\");\n-            goto end;\n-        }\n-        if (verbose) {\n-            if (BN_is_zero(serial))\n-                BIO_printf(bio_err, \"next serial number is 00\\n\");\n-            else {\n-                if ((f = BN_bn2hex(serial)) == NULL)\n-                    goto end;\n-                BIO_printf(bio_err, \"next serial number is %s\\n\", f);\n-                OPENSSL_free(f);\n+        if (rand_ser) {\n+            if ((serial = BN_new()) == NULL || !rand_serial(serial, NULL)) {\n+                BIO_printf(bio_err, \"error generating serial number\\n\");\n+                goto end;\n+            }\n+        } else {\n+            if ((serial = load_serial(serialfile, create_ser, NULL)) == NULL) {\n+                BIO_printf(bio_err, \"error while loading serial number\\n\");\n+                goto end;\n+            }\n+            if (verbose) {\n+                if (BN_is_zero(serial)) {\n+                    BIO_printf(bio_err, \"next serial number is 00\\n\");\n+                } else {\n+                    if ((f = BN_bn2hex(serial)) == NULL)\n+                        goto end;\n+                    BIO_printf(bio_err, \"next serial number is %s\\n\", f);\n+                    OPENSSL_free(f);\n+                }\n             }\n         }\n \n@@ -859,7 +872,7 @@ int ca_main(int argc, char **argv)\n             j = certify_spkac(&x, spkac_file, pkey, x509, dgst, sigopts,\n                               attribs, db, serial, subj, chtype, multirdn,\n                               email_dn, startdate, enddate, days, extensions,\n-                              conf, verbose, certopt, nameopt, default_op,\n+                              conf, verbose, certopt, get_nameopt(), default_op,\n                               ext_copy);\n             if (j < 0)\n                 goto end;\n@@ -880,7 +893,7 @@ int ca_main(int argc, char **argv)\n                              attribs,\n                              db, serial, subj, chtype, multirdn, email_dn,\n                              startdate, enddate, days, batch, extensions,\n-                             conf, verbose, certopt, nameopt, default_op,\n+                             conf, verbose, certopt, get_nameopt(), default_op,\n                              ext_copy);\n             if (j < 0)\n                 goto end;\n@@ -900,7 +913,7 @@ int ca_main(int argc, char **argv)\n             j = certify(&x, infile, pkey, x509p, dgst, sigopts, attribs, db,\n                         serial, subj, chtype, multirdn, email_dn, startdate,\n                         enddate, days, batch, extensions, conf, verbose,\n-                        certopt, nameopt, default_op, ext_copy, selfsign);\n+                        certopt, get_nameopt(), default_op, ext_copy, selfsign);\n             if (j < 0)\n                 goto end;\n             if (j > 0) {\n@@ -919,7 +932,7 @@ int ca_main(int argc, char **argv)\n             j = certify(&x, argv[i], pkey, x509p, dgst, sigopts, attribs, db,\n                         serial, subj, chtype, multirdn, email_dn, startdate,\n                         enddate, days, batch, extensions, conf, verbose,\n-                        certopt, nameopt, default_op, ext_copy, selfsign);\n+                        certopt, get_nameopt(), default_op, ext_copy, selfsign);\n             if (j < 0)\n                 goto end;\n             if (j > 0) {\n@@ -947,14 +960,13 @@ int ca_main(int argc, char **argv)\n                            \"\\n%d out of %d certificate requests certified, commit? [y/n]\",\n                            total_done, total);\n                 (void)BIO_flush(bio_err);\n-                buf[0][0] = '\\0';\n-                if (!fgets(buf[0], 10, stdin)) {\n-                    BIO_printf(bio_err,\n-                               \"CERTIFICATION CANCELED: I/O error\\n\");\n+                tmp[0] = '\\0';\n+                if (fgets(tmp, sizeof(tmp), stdin) == NULL) {\n+                    BIO_printf(bio_err, \"CERTIFICATION CANCELED: I/O error\\n\");\n                     ret = 0;\n                     goto end;\n                 }\n-                if ((buf[0][0] != 'y') && (buf[0][0] != 'Y')) {\n+                if (tmp[0] != 'y' && tmp[0] != 'Y') {\n                     BIO_printf(bio_err, \"CERTIFICATION CANCELED\\n\");\n                     ret = 0;\n                     goto end;\n@@ -964,45 +976,42 @@ int ca_main(int argc, char **argv)\n             BIO_printf(bio_err, \"Write out database with %d new entries\\n\",\n                        sk_X509_num(cert_sk));\n \n-            if (!save_serial(serialfile, \"new\", serial, NULL))\n+            if (serialfile != NULL\n+                    && !save_serial(serialfile, \"new\", serial, NULL))\n                 goto end;\n \n             if (!save_index(dbfile, \"new\", db))\n                 goto end;\n         }\n \n+        outdirlen = OPENSSL_strlcpy(new_cert, outdir, sizeof(new_cert));\n+#ifndef OPENSSL_SYS_VMS\n+        outdirlen = OPENSSL_strlcat(new_cert, \"/\", sizeof(new_cert));\n+#endif\n+\n         if (verbose)\n             BIO_printf(bio_err, \"writing new certificates\\n\");\n+\n         for (i = 0; i < sk_X509_num(cert_sk); i++) {\n             BIO *Cout = NULL;\n             X509 *xi = sk_X509_value(cert_sk, i);\n             ASN1_INTEGER *serialNumber = X509_get_serialNumber(xi);\n-            int k;\n-            char *n;\n-\n-            j = ASN1_STRING_length(serialNumber);\n-            p = (const char *)ASN1_STRING_get0_data(serialNumber);\n+            const unsigned char *psn = ASN1_STRING_get0_data(serialNumber);\n+            const int snl = ASN1_STRING_length(serialNumber);\n+            const int filen_len = 2 * (snl > 0 ? snl : 1) + sizeof(\".pem\");\n+            char *n = new_cert + outdirlen;\n \n-            if (strlen(outdir) >= (size_t)(j ? BSIZE - j * 2 - 6 : BSIZE - 8)) {\n+            if (outdirlen + filen_len > PATH_MAX) {\n                 BIO_printf(bio_err, \"certificate file name too long\\n\");\n                 goto end;\n             }\n \n-            strcpy(buf[2], outdir);\n-\n-#ifndef OPENSSL_SYS_VMS\n-            OPENSSL_strlcat(buf[2], \"/\", sizeof(buf[2]));\n-#endif\n+            if (snl > 0) {\n+                static const char HEX_DIGITS[] = \"0123456789ABCDEF\";\n \n-            n = (char *)&(buf[2][strlen(buf[2])]);\n-            if (j > 0) {\n-                for (k = 0; k < j; k++) {\n-                    if (n >= &(buf[2][sizeof(buf[2])]))\n-                        break;\n-                    BIO_snprintf(n,\n-                                 &buf[2][0] + sizeof(buf[2]) - n,\n-                                 \"%02X\", (unsigned char)*(p++));\n-                    n += 2;\n+                for (j = 0; j < snl; j++, psn++) {\n+                    *n++ = HEX_DIGITS[*psn >> 4];\n+                    *n++ = HEX_DIGITS[*psn & 0x0F];\n                 }\n             } else {\n                 *(n++) = '0';\n@@ -1012,18 +1021,18 @@ int ca_main(int argc, char **argv)\n             *(n++) = 'p';\n             *(n++) = 'e';\n             *(n++) = 'm';\n-            *n = '\\0';\n+            *n = '\\0';          /* closing new_cert */\n             if (verbose)\n-                BIO_printf(bio_err, \"writing %s\\n\", buf[2]);\n+                BIO_printf(bio_err, \"writing %s\\n\", new_cert);\n \n             Sout = bio_open_default(outfile, 'w',\n                                     output_der ? FORMAT_ASN1 : FORMAT_TEXT);\n             if (Sout == NULL)\n                 goto end;\n \n-            Cout = BIO_new_file(buf[2], \"w\");\n+            Cout = BIO_new_file(new_cert, \"w\");\n             if (Cout == NULL) {\n-                perror(buf[2]);\n+                perror(new_cert);\n                 goto end;\n             }\n             write_new_certificate(Cout, xi, 0, notext);\n@@ -1035,7 +1044,8 @@ int ca_main(int argc, char **argv)\n \n         if (sk_X509_num(cert_sk)) {\n             /* Rename the database and the serial file */\n-            if (!rotate_serial(serialfile, \"new\", \"old\"))\n+            if (serialfile != NULL\n+                    && !rotate_serial(serialfile, \"new\", \"old\"))\n                 goto end;\n \n             if (!rotate_index(dbfile, \"new\", \"old\"))\n@@ -1048,20 +1058,19 @@ int ca_main(int argc, char **argv)\n     /*****************************************************************/\n     if (gencrl) {\n         int crl_v2 = 0;\n-        if (!crl_ext) {\n+        if (crl_ext == NULL) {\n             crl_ext = NCONF_get_string(conf, section, ENV_CRLEXT);\n-            if (!crl_ext)\n+            if (crl_ext == NULL)\n                 ERR_clear_error();\n         }\n-        if (crl_ext) {\n+        if (crl_ext != NULL) {\n             /* Check syntax of file */\n             X509V3_CTX ctx;\n             X509V3_set_ctx_test(&ctx);\n             X509V3_set_nconf(&ctx, conf);\n             if (!X509V3_EXT_add_nconf(conf, &ctx, crl_ext, NULL)) {\n                 BIO_printf(bio_err,\n-                           \"Error Loading CRL extension section %s\\n\",\n-                           crl_ext);\n+                           \"Error Loading CRL extension section %s\\n\", crl_ext);\n                 ret = 1;\n                 goto end;\n             }\n@@ -1144,12 +1153,12 @@ int ca_main(int argc, char **argv)\n \n         /* Add any extensions asked for */\n \n-        if (crl_ext || crlnumberfile != NULL) {\n+        if (crl_ext != NULL || crlnumberfile != NULL) {\n             X509V3_CTX crlctx;\n             X509V3_set_ctx(&crlctx, x509, NULL, NULL, crl, 0);\n             X509V3_set_nconf(&crlctx, conf);\n \n-            if (crl_ext)\n+            if (crl_ext != NULL)\n                 if (!X509V3_EXT_CRL_add_nconf(conf, &crlctx, crl_ext, crl))\n                     goto end;\n             if (crlnumberfile != NULL) {\n@@ -1163,15 +1172,15 @@ int ca_main(int argc, char **argv)\n                     goto end;\n             }\n         }\n-        if (crl_ext || crl_v2) {\n+        if (crl_ext != NULL || crl_v2) {\n             if (!X509_CRL_set_version(crl, 1))\n                 goto end;       /* version 2 CRL */\n         }\n \n         /* we have a CRL number that need updating */\n-        if (crlnumberfile != NULL)\n-            if (!save_serial(crlnumberfile, \"new\", crlnumber, NULL))\n-                goto end;\n+        if (crlnumberfile != NULL\n+                && !save_serial(crlnumberfile, \"new\", crlnumber, NULL))\n+            goto end;\n \n         BN_free(crlnumber);\n         crlnumber = NULL;\n@@ -1186,9 +1195,10 @@ int ca_main(int argc, char **argv)\n \n         PEM_write_bio_X509_CRL(Sout, crl);\n \n-        if (crlnumberfile != NULL) /* Rename the crlnumber file */\n-            if (!rotate_serial(crlnumberfile, \"new\", \"old\"))\n-                goto end;\n+        /* Rename the crlnumber file */\n+        if (crlnumberfile != NULL\n+                && !rotate_serial(crlnumberfile, \"new\", \"old\"))\n+            goto end;\n \n     }\n     /*****************************************************************/\n@@ -1202,7 +1212,7 @@ int ca_main(int argc, char **argv)\n             if (revcert == NULL)\n                 goto end;\n             if (dorevoke == 2)\n-                rev_type = -1;\n+                rev_type = REV_VALID;\n             j = do_revoke(revcert, db, rev_type, rev_arg);\n             if (j <= 0)\n                 goto end;\n@@ -1217,17 +1227,16 @@ int ca_main(int argc, char **argv)\n             BIO_printf(bio_err, \"Data Base Updated\\n\");\n         }\n     }\n-    /*****************************************************************/\n     ret = 0;\n+\n  end:\n+    if (ret)\n+        ERR_print_errors(bio_err);\n     BIO_free_all(Sout);\n     BIO_free_all(out);\n     BIO_free_all(in);\n     sk_X509_pop_free(cert_sk, X509_free);\n \n-    if (ret)\n-        ERR_print_errors(bio_err);\n-    app_RAND_write_file(randfile);\n     if (free_key)\n         OPENSSL_free(key);\n     BN_free(serial);\n@@ -1240,7 +1249,7 @@ int ca_main(int argc, char **argv)\n     NCONF_free(conf);\n     NCONF_free(extconf);\n     release_engine(e);\n-    return (ret);\n+    return ret;\n }\n \n static char *lookup_conf(const CONF *conf, const char *section, const char *tag)\n@@ -1277,7 +1286,7 @@ static int certify(X509 **xret, const char *infile, EVP_PKEY *pkey, X509 *x509,\n         goto end;\n     }\n     if (verbose)\n-        X509_REQ_print(bio_err, req);\n+        X509_REQ_print_ex(bio_err, req, nameopt, X509_FLAG_COMPAT);\n \n     BIO_printf(bio_err, \"Check that the request matches the signature\\n\");\n \n@@ -1305,8 +1314,9 @@ static int certify(X509 **xret, const char *infile, EVP_PKEY *pkey, X509 *x509,\n                    \"Signature did not match the certificate request\\n\");\n         ERR_print_errors(bio_err);\n         goto end;\n-    } else\n+    } else {\n         BIO_printf(bio_err, \"Signature ok\\n\");\n+    }\n \n     ok = do_body(xret, pkey, x509, dgst, sigopts, policy, db, serial, subj,\n                  chtype, multirdn, email_dn, startdate, enddate, days, batch,\n@@ -1316,7 +1326,7 @@ static int certify(X509 **xret, const char *infile, EVP_PKEY *pkey, X509 *x509,\n  end:\n     X509_REQ_free(req);\n     BIO_free(in);\n-    return (ok);\n+    return ok;\n }\n \n static int certify_cert(X509 **xret, const char *infile, EVP_PKEY *pkey, X509 *x509,\n@@ -1354,8 +1364,9 @@ static int certify_cert(X509 **xret, const char *infile, EVP_PKEY *pkey, X509 *x\n         ok = 0;\n         BIO_printf(bio_err, \"Signature did not match the certificate\\n\");\n         goto end;\n-    } else\n+    } else {\n         BIO_printf(bio_err, \"Signature ok\\n\");\n+    }\n \n     if ((rreq = X509_to_X509_REQ(req, NULL, NULL)) == NULL)\n         goto end;\n@@ -1368,7 +1379,7 @@ static int certify_cert(X509 **xret, const char *infile, EVP_PKEY *pkey, X509 *x\n  end:\n     X509_REQ_free(rreq);\n     X509_free(req);\n-    return (ok);\n+    return ok;\n }\n \n static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n@@ -1385,8 +1396,7 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n     ASN1_STRING *str, *str2;\n     ASN1_OBJECT *obj;\n     X509 *ret = NULL;\n-    X509_NAME_ENTRY *ne;\n-    X509_NAME_ENTRY *tne, *push;\n+    X509_NAME_ENTRY *ne, *tne;\n     EVP_PKEY *pktmp;\n     int ok = -1, i, j, last, nid;\n     const char *p;\n@@ -1411,49 +1421,44 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n     }\n \n     if (default_op)\n-        BIO_printf(bio_err,\n-                   \"The Subject's Distinguished Name is as follows\\n\");\n+        BIO_printf(bio_err, \"The Subject's Distinguished Name is as follows\\n\");\n \n     name = X509_REQ_get_subject_name(req);\n     for (i = 0; i < X509_NAME_entry_count(name); i++) {\n         ne = X509_NAME_get_entry(name, i);\n         str = X509_NAME_ENTRY_get_data(ne);\n         obj = X509_NAME_ENTRY_get_object(ne);\n+        nid = OBJ_obj2nid(obj);\n \n         if (msie_hack) {\n             /* assume all type should be strings */\n-            nid = OBJ_obj2nid(X509_NAME_ENTRY_get_object(ne));\n \n             if (str->type == V_ASN1_UNIVERSALSTRING)\n                 ASN1_UNIVERSALSTRING_to_string(str);\n \n-            if ((str->type == V_ASN1_IA5STRING) &&\n-                (nid != NID_pkcs9_emailAddress))\n+            if (str->type == V_ASN1_IA5STRING && nid != NID_pkcs9_emailAddress)\n                 str->type = V_ASN1_T61STRING;\n \n-            if ((nid == NID_pkcs9_emailAddress) &&\n-                (str->type == V_ASN1_PRINTABLESTRING))\n+            if (nid == NID_pkcs9_emailAddress\n+                && str->type == V_ASN1_PRINTABLESTRING)\n                 str->type = V_ASN1_IA5STRING;\n         }\n \n         /* If no EMAIL is wanted in the subject */\n-        if ((OBJ_obj2nid(obj) == NID_pkcs9_emailAddress) && (!email_dn))\n+        if (nid == NID_pkcs9_emailAddress && !email_dn)\n             continue;\n \n         /* check some things */\n-        if ((OBJ_obj2nid(obj) == NID_pkcs9_emailAddress) &&\n-            (str->type != V_ASN1_IA5STRING)) {\n+        if (nid == NID_pkcs9_emailAddress && str->type != V_ASN1_IA5STRING) {\n             BIO_printf(bio_err,\n                        \"\\nemailAddress type needs to be of type IA5STRING\\n\");\n             goto end;\n         }\n-        if ((str->type != V_ASN1_BMPSTRING)\n-            && (str->type != V_ASN1_UTF8STRING)) {\n+        if (str->type != V_ASN1_BMPSTRING && str->type != V_ASN1_UTF8STRING) {\n             j = ASN1_PRINTABLE_type(str->data, str->length);\n-            if (((j == V_ASN1_T61STRING) &&\n-                 (str->type != V_ASN1_T61STRING)) ||\n-                ((j == V_ASN1_IA5STRING) &&\n-                 (str->type == V_ASN1_PRINTABLESTRING))) {\n+            if ((j == V_ASN1_T61STRING && str->type != V_ASN1_T61STRING) ||\n+                (j == V_ASN1_IA5STRING && str->type == V_ASN1_PRINTABLESTRING))\n+            {\n                 BIO_printf(bio_err,\n                            \"\\nThe string contains characters that are illegal for the ASN.1 type\\n\");\n                 goto end;\n@@ -1491,6 +1496,8 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n \n         last = -1;\n         for (;;) {\n+            X509_NAME_ENTRY *push = NULL;\n+\n             /* lookup the object in the supplied name list */\n             j = X509_NAME_get_index_by_OBJ(name, obj, last);\n             if (j < 0) {\n@@ -1503,7 +1510,6 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n             last = j;\n \n             /* depending on the 'policy', decide what to do. */\n-            push = NULL;\n             if (strcmp(cv->value, \"optional\") == 0) {\n                 if (tne != NULL)\n                     push = tne;\n@@ -1513,8 +1519,9 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n                                \"The %s field needed to be supplied and was missing\\n\",\n                                cv->name);\n                     goto end;\n-                } else\n+                } else {\n                     push = tne;\n+                }\n             } else if (strcmp(cv->value, \"match\") == 0) {\n                 int last2;\n \n@@ -1532,8 +1539,7 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n                 if ((j < 0) && (last2 == -1)) {\n                     BIO_printf(bio_err,\n                                \"The %s field does not exist in the CA certificate,\\n\"\n-                               \"the 'policy' is misconfigured\\n\",\n-                               cv->name);\n+                               \"the 'policy' is misconfigured\\n\", cv->name);\n                     goto end;\n                 }\n                 if (j >= 0) {\n@@ -1632,7 +1638,7 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n         else\n             X509V3_set_ctx(&ctx, x509, ret, req, NULL, 0);\n \n-        if (extconf) {\n+        if (extconf != NULL) {\n             if (verbose)\n                 BIO_printf(bio_err, \"Extra configuration file found\\n\");\n \n@@ -1705,11 +1711,11 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n             BIO_printf(bio_err, \"Memory allocation failure\\n\");\n             goto end;\n         }\n+        i = -1;\n         while ((i = X509_NAME_get_index_by_NID(dn_subject,\n                                                NID_pkcs9_emailAddress,\n-                                               -1)) >= 0) {\n-            tmpne = X509_NAME_get_entry(dn_subject, i);\n-            X509_NAME_delete_entry(dn_subject, i);\n+                                               i)) >= 0) {\n+            tmpne = X509_NAME_delete_entry(dn_subject, i--);\n             X509_NAME_ENTRY_free(tmpne);\n         }\n \n@@ -1827,13 +1833,13 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n         BIO_printf(bio_err, \"Sign the certificate? [y/n]:\");\n         (void)BIO_flush(bio_err);\n         buf[0] = '\\0';\n-        if (!fgets(buf, sizeof(buf) - 1, stdin)) {\n+        if (fgets(buf, sizeof(buf), stdin) == NULL) {\n             BIO_printf(bio_err,\n                        \"CERTIFICATE WILL NOT BE CERTIFIED: I/O error\\n\");\n             ok = 0;\n             goto end;\n         }\n-        if (!((buf[0] == 'y') || (buf[0] == 'Y'))) {\n+        if (!(buf[0] == 'y' || buf[0] == 'Y')) {\n             BIO_printf(bio_err, \"CERTIFICATE WILL NOT BE CERTIFIED\\n\");\n             ok = 0;\n             goto end;\n@@ -1848,7 +1854,7 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n     if (!do_X509_sign(ret, pkey, dgst, sigopts))\n         goto end;\n \n-    /* We now just add it to the database */\n+    /* We now just add it to the database as DB_TYPE_VAL('V') */\n     row[DB_type] = OPENSSL_strdup(\"V\");\n     tm = X509_get0_notAfter(ret);\n     row[DB_exp_date] = app_malloc(tm->length + 1, \"row expdate\");\n@@ -1887,11 +1893,10 @@ static int do_body(X509 **xret, EVP_PKEY *pkey, X509 *x509,\n         X509_free(ret);\n     else\n         *xret = ret;\n-    return (ok);\n+    return ok;\n }\n \n-static void write_new_certificate(BIO *bp, X509 *x, int output_der,\n-                                  int notext)\n+static void write_new_certificate(BIO *bp, X509 *x, int output_der, int notext)\n {\n \n     if (output_der) {\n@@ -2007,8 +2012,7 @@ static int certify_spkac(X509 **xret, const char *infile, EVP_PKEY *pkey,\n      * Now extract the key from the SPKI structure.\n      */\n \n-    BIO_printf(bio_err,\n-               \"Check that the SPKAC request matches the signature\\n\");\n+    BIO_printf(bio_err, \"Check that the SPKAC request matches the signature\\n\");\n \n     if ((pktmp = NETSCAPE_SPKI_get_pubkey(spki)) == NULL) {\n         BIO_printf(bio_err, \"error unpacking SPKAC public key\\n\");\n@@ -2036,15 +2040,16 @@ static int certify_spkac(X509 **xret, const char *infile, EVP_PKEY *pkey,\n     NETSCAPE_SPKI_free(spki);\n     X509_NAME_ENTRY_free(ne);\n \n-    return (ok);\n+    return ok;\n }\n \n static int check_time_format(const char *str)\n {\n     return ASN1_TIME_set_string(NULL, str);\n }\n \n-static int do_revoke(X509 *x509, CA_DB *db, int type, char *value)\n+static int do_revoke(X509 *x509, CA_DB *db, REVINFO_TYPE rev_type,\n+                     const char *value)\n {\n     const ASN1_TIME *tm = NULL;\n     char *row[DB_NUMBER], **rrow, **irow;\n@@ -2082,7 +2087,7 @@ static int do_revoke(X509 *x509, CA_DB *db, int type, char *value)\n                    \"Adding Entry with serial number %s to DB for %s\\n\",\n                    row[DB_serial], row[DB_name]);\n \n-        /* We now just add it to the database */\n+        /* We now just add it to the database as DB_TYPE_REV('V') */\n         row[DB_type] = OPENSSL_strdup(\"V\");\n         tm = X509_get0_notAfter(x509);\n         row[DB_exp_date] = app_malloc(tm->length + 1, \"row exp_data\");\n@@ -2112,40 +2117,41 @@ static int do_revoke(X509 *x509, CA_DB *db, int type, char *value)\n             row[i] = NULL;\n \n         /* Revoke Certificate */\n-        if (type == -1)\n+        if (rev_type == REV_VALID)\n             ok = 1;\n         else\n-            ok = do_revoke(x509, db, type, value);\n+            /* Retry revocation after DB insertion */\n+            ok = do_revoke(x509, db, rev_type, value);\n \n         goto end;\n \n     } else if (index_name_cmp_noconst(row, rrow)) {\n         BIO_printf(bio_err, \"ERROR:name does not match %s\\n\", row[DB_name]);\n         goto end;\n-    } else if (type == -1) {\n+    } else if (rev_type == REV_VALID) {\n         BIO_printf(bio_err, \"ERROR:Already present, serial number %s\\n\",\n                    row[DB_serial]);\n         goto end;\n-    } else if (rrow[DB_type][0] == 'R') {\n+    } else if (rrow[DB_type][0] == DB_TYPE_REV) {\n         BIO_printf(bio_err, \"ERROR:Already revoked, serial number %s\\n\",\n                    row[DB_serial]);\n         goto end;\n     } else {\n         BIO_printf(bio_err, \"Revoking Certificate %s.\\n\", rrow[DB_serial]);\n-        rev_str = make_revocation_str(type, value);\n+        rev_str = make_revocation_str(rev_type, value);\n         if (!rev_str) {\n             BIO_printf(bio_err, \"Error in revocation arguments\\n\");\n             goto end;\n         }\n-        rrow[DB_type][0] = 'R';\n+        rrow[DB_type][0] = DB_TYPE_REV;\n         rrow[DB_type][1] = '\\0';\n         rrow[DB_rev_date] = rev_str;\n     }\n     ok = 1;\n  end:\n     for (i = 0; i < DB_NUMBER; i++)\n         OPENSSL_free(row[i]);\n-    return (ok);\n+    return ok;\n }\n \n static int get_certificate_status(const char *serial, CA_DB *db)\n@@ -2164,7 +2170,7 @@ static int get_certificate_status(const char *serial, CA_DB *db)\n     if (serial_len % 2) {\n         /*\n          * Set the first char to 0\n-         */ ;\n+         */\n         row[DB_serial][0] = '0';\n \n         /* Copy String from serial to row[DB_serial] */\n@@ -2177,8 +2183,7 @@ static int get_certificate_status(const char *serial, CA_DB *db)\n     }\n \n     /* Make it Upper Case */\n-    for (i = 0; row[DB_serial][i] != '\\0'; i++)\n-        row[DB_serial][i] = toupper((unsigned char)row[DB_serial][i]);\n+    make_uppercase(row[DB_serial]);\n \n     ok = 1;\n \n@@ -2188,19 +2193,19 @@ static int get_certificate_status(const char *serial, CA_DB *db)\n         BIO_printf(bio_err, \"Serial %s not present in db.\\n\", row[DB_serial]);\n         ok = -1;\n         goto end;\n-    } else if (rrow[DB_type][0] == 'V') {\n+    } else if (rrow[DB_type][0] == DB_TYPE_VAL) {\n         BIO_printf(bio_err, \"%s=Valid (%c)\\n\",\n                    row[DB_serial], rrow[DB_type][0]);\n         goto end;\n-    } else if (rrow[DB_type][0] == 'R') {\n+    } else if (rrow[DB_type][0] == DB_TYPE_REV) {\n         BIO_printf(bio_err, \"%s=Revoked (%c)\\n\",\n                    row[DB_serial], rrow[DB_type][0]);\n         goto end;\n-    } else if (rrow[DB_type][0] == 'E') {\n+    } else if (rrow[DB_type][0] == DB_TYPE_EXP) {\n         BIO_printf(bio_err, \"%s=Expired (%c)\\n\",\n                    row[DB_serial], rrow[DB_type][0]);\n         goto end;\n-    } else if (rrow[DB_type][0] == 'S') {\n+    } else if (rrow[DB_type][0] == DB_TYPE_SUSP) {\n         BIO_printf(bio_err, \"%s=Suspended (%c)\\n\",\n                    row[DB_serial], rrow[DB_type][0]);\n         goto end;\n@@ -2213,7 +2218,7 @@ static int get_certificate_status(const char *serial, CA_DB *db)\n     for (i = 0; i < DB_NUMBER; i++) {\n         OPENSSL_free(row[i]);\n     }\n-    return (ok);\n+    return ok;\n }\n \n static int do_updatedb(CA_DB *db)\n@@ -2245,7 +2250,7 @@ static int do_updatedb(CA_DB *db)\n     for (i = 0; i < sk_OPENSSL_PSTRING_num(db->db->data); i++) {\n         rrow = sk_OPENSSL_PSTRING_value(db->db->data, i);\n \n-        if (rrow[DB_type][0] == 'V') {\n+        if (rrow[DB_type][0] == DB_TYPE_VAL) {\n             /* ignore entries that are not valid */\n             if (strncmp(rrow[DB_exp_date], \"49\", 2) <= 0)\n                 db_y2k = 1;\n@@ -2255,14 +2260,14 @@ static int do_updatedb(CA_DB *db)\n             if (db_y2k == a_y2k) {\n                 /* all on the same y2k side */\n                 if (strcmp(rrow[DB_exp_date], a_tm_s) <= 0) {\n-                    rrow[DB_type][0] = 'E';\n+                    rrow[DB_type][0] = DB_TYPE_EXP;\n                     rrow[DB_type][1] = '\\0';\n                     cnt++;\n \n                     BIO_printf(bio_err, \"%s=Expired\\n\", rrow[DB_serial]);\n                 }\n             } else if (db_y2k < a_y2k) {\n-                rrow[DB_type][0] = 'E';\n+                rrow[DB_type][0] = DB_TYPE_EXP;\n                 rrow[DB_type][1] = '\\0';\n                 cnt++;\n \n@@ -2274,7 +2279,7 @@ static int do_updatedb(CA_DB *db)\n \n     ASN1_UTCTIME_free(a_tm);\n     OPENSSL_free(a_tm_s);\n-    return (cnt);\n+    return cnt;\n }\n \n static const char *crl_reasons[] = {\n@@ -2302,16 +2307,17 @@ static const char *crl_reasons[] = {\n  * additional argument\n  */\n \n-char *make_revocation_str(int rev_type, char *rev_arg)\n+static char *make_revocation_str(REVINFO_TYPE rev_type, const char *rev_arg)\n {\n     char *str;\n-    const char *other = NULL;\n-    const char *reason = NULL;\n+    const char *reason = NULL, *other = NULL;\n     ASN1_OBJECT *otmp;\n     ASN1_UTCTIME *revtm = NULL;\n     int i;\n+\n     switch (rev_type) {\n     case REV_NONE:\n+    case REV_VALID:\n         break;\n \n     case REV_CRL_REASON:\n@@ -2329,7 +2335,6 @@ char *make_revocation_str(int rev_type, char *rev_arg)\n \n     case REV_HOLD:\n         /* Argument is an OID */\n-\n         otmp = OBJ_txt2obj(rev_arg, 0);\n         ASN1_OBJECT_free(otmp);\n \n@@ -2344,7 +2349,6 @@ char *make_revocation_str(int rev_type, char *rev_arg)\n \n     case REV_KEY_COMPROMISE:\n     case REV_CA_COMPROMISE:\n-\n         /* Argument is the key compromise time  */\n         if (!ASN1_GENERALIZEDTIME_set_string(NULL, rev_arg)) {\n             BIO_printf(bio_err,\n@@ -2359,7 +2363,6 @@ char *make_revocation_str(int rev_type, char *rev_arg)\n             reason = \"CAkeyTime\";\n \n         break;\n-\n     }\n \n     revtm = X509_gmtime_adj(NULL, 0);\n@@ -2396,7 +2399,7 @@ char *make_revocation_str(int rev_type, char *rev_arg)\n  * 2 OK and some extensions added (i.e. V2 CRL)\n  */\n \n-int make_revoked(X509_REVOKED *rev, const char *str)\n+static int make_revoked(X509_REVOKED *rev, const char *str)\n {\n     char *tmp = NULL;\n     int reason_code = -1;\n@@ -2546,9 +2549,9 @@ int unpack_revinfo(ASN1_TIME **prevtm, int *preason, ASN1_OBJECT **phold,\n             goto end;\n         }\n \n-        if (reason_code == 7)\n+        if (reason_code == 7) {\n             reason_code = OCSP_REVOKED_STATUS_REMOVEFROMCRL;\n-        else if (reason_code == 8) { /* Hold instruction */\n+        } else if (reason_code == 8) { /* Hold instruction */\n             if (!arg_str) {\n                 BIO_printf(bio_err, \"missing hold instruction\\n\");\n                 goto end;\n@@ -2557,8 +2560,7 @@ int unpack_revinfo(ASN1_TIME **prevtm, int *preason, ASN1_OBJECT **phold,\n             hold = OBJ_txt2obj(arg_str, 0);\n \n             if (!hold) {\n-                BIO_printf(bio_err, \"invalid object identifier %s\\n\",\n-                           arg_str);\n+                BIO_printf(bio_err, \"invalid object identifier %s\\n\", arg_str);\n                 goto end;\n             }\n             if (phold)"
        },
        {
            "sha": "0bb33a4aca4ba8a166e502e26e6958d4df905f5c",
            "filename": "deps/openssl/openssl/apps/ciphers.c",
            "status": "modified",
            "additions": 36,
            "deletions": 12,
            "changes": 48,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fciphers.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fciphers.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fciphers.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -11,22 +11,26 @@\n #include <stdlib.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/err.h>\n #include <openssl/ssl.h>\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_STDNAME,\n+    OPT_CONVERT,\n     OPT_SSL3,\n     OPT_TLS1,\n     OPT_TLS1_1,\n     OPT_TLS1_2,\n+    OPT_TLS1_3,\n     OPT_PSK,\n     OPT_SRP,\n+    OPT_CIPHERSUITES,\n     OPT_V, OPT_UPPER_V, OPT_S\n } OPTION_CHOICE;\n \n-OPTIONS ciphers_options[] = {\n+const OPTIONS ciphers_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"v\", OPT_V, '-', \"Verbose listing of the SSL/TLS ciphers\"},\n     {\"V\", OPT_UPPER_V, '-', \"Even more verbose\"},\n@@ -43,15 +47,19 @@ OPTIONS ciphers_options[] = {\n #ifndef OPENSSL_NO_TLS1_2\n     {\"tls1_2\", OPT_TLS1_2, '-', \"TLS1.2 mode\"},\n #endif\n-#ifndef OPENSSL_NO_SSL_TRACE\n-    {\"stdname\", OPT_STDNAME, '-', \"Show standard cipher names\"},\n+#ifndef OPENSSL_NO_TLS1_3\n+    {\"tls1_3\", OPT_TLS1_3, '-', \"TLS1.3 mode\"},\n #endif\n+    {\"stdname\", OPT_STDNAME, '-', \"Show standard cipher names\"},\n #ifndef OPENSSL_NO_PSK\n     {\"psk\", OPT_PSK, '-', \"include ciphersuites requiring PSK\"},\n #endif\n #ifndef OPENSSL_NO_SRP\n     {\"srp\", OPT_SRP, '-', \"include ciphersuites requiring SRP\"},\n #endif\n+    {\"convert\", OPT_CONVERT, 's', \"Convert standard name into OpenSSL name\"},\n+    {\"ciphersuites\", OPT_CIPHERSUITES, 's',\n+     \"Configure the TLSv1.3 ciphersuites to use\"},\n     {NULL}\n };\n \n@@ -78,17 +86,15 @@ int ciphers_main(int argc, char **argv)\n     STACK_OF(SSL_CIPHER) *sk = NULL;\n     const SSL_METHOD *meth = TLS_server_method();\n     int ret = 1, i, verbose = 0, Verbose = 0, use_supported = 0;\n-#ifndef OPENSSL_NO_SSL_TRACE\n     int stdname = 0;\n-#endif\n #ifndef OPENSSL_NO_PSK\n     int psk = 0;\n #endif\n #ifndef OPENSSL_NO_SRP\n     int srp = 0;\n #endif\n     const char *p;\n-    char *ciphers = NULL, *prog;\n+    char *ciphers = NULL, *prog, *convert = NULL, *ciphersuites = NULL;\n     char buf[512];\n     OPTION_CHOICE o;\n     int min_version = 0, max_version = 0;\n@@ -115,9 +121,10 @@ int ciphers_main(int argc, char **argv)\n             use_supported = 1;\n             break;\n         case OPT_STDNAME:\n-#ifndef OPENSSL_NO_SSL_TRACE\n             stdname = verbose = 1;\n-#endif\n+            break;\n+        case OPT_CONVERT:\n+            convert = opt_arg();\n             break;\n         case OPT_SSL3:\n             min_version = SSL3_VERSION;\n@@ -135,6 +142,10 @@ int ciphers_main(int argc, char **argv)\n             min_version = TLS1_2_VERSION;\n             max_version = TLS1_2_VERSION;\n             break;\n+        case OPT_TLS1_3:\n+            min_version = TLS1_3_VERSION;\n+            max_version = TLS1_3_VERSION;\n+            break;\n         case OPT_PSK:\n #ifndef OPENSSL_NO_PSK\n             psk = 1;\n@@ -145,6 +156,9 @@ int ciphers_main(int argc, char **argv)\n             srp = 1;\n #endif\n             break;\n+        case OPT_CIPHERSUITES:\n+            ciphersuites = opt_arg();\n+            break;\n         }\n     }\n     argv = opt_rest();\n@@ -155,6 +169,12 @@ int ciphers_main(int argc, char **argv)\n     else if (argc != 0)\n         goto opthelp;\n \n+    if (convert != NULL) {\n+        BIO_printf(bio_out, \"OpenSSL cipher name: %s\\n\",\n+                   OPENSSL_cipher_name(convert));\n+        goto end;\n+    }\n+\n     ctx = SSL_CTX_new(meth);\n     if (ctx == NULL)\n         goto err;\n@@ -171,6 +191,12 @@ int ciphers_main(int argc, char **argv)\n     if (srp)\n         SSL_CTX_set_srp_client_pwd_callback(ctx, dummy_srp);\n #endif\n+\n+    if (ciphersuites != NULL && !SSL_CTX_set_ciphersuites(ctx, ciphersuites)) {\n+        BIO_printf(bio_err, \"Error setting TLSv1.3 ciphersuites\\n\");\n+        goto err;\n+    }\n+\n     if (ciphers != NULL) {\n         if (!SSL_CTX_set_cipher_list(ctx, ciphers)) {\n             BIO_printf(bio_err, \"Error in cipher list\\n\");\n@@ -217,14 +243,12 @@ int ciphers_main(int argc, char **argv)\n                 else\n                     BIO_printf(bio_out, \"0x%02X,0x%02X,0x%02X,0x%02X - \", id0, id1, id2, id3); /* whatever */\n             }\n-#ifndef OPENSSL_NO_SSL_TRACE\n             if (stdname) {\n                 const char *nm = SSL_CIPHER_standard_name(c);\n                 if (nm == NULL)\n                     nm = \"UNKNOWN\";\n                 BIO_printf(bio_out, \"%s - \", nm);\n             }\n-#endif\n             BIO_puts(bio_out, SSL_CIPHER_description(c, buf, sizeof(buf)));\n         }\n     }\n@@ -238,5 +262,5 @@ int ciphers_main(int argc, char **argv)\n         sk_SSL_CIPHER_free(sk);\n     SSL_CTX_free(ctx);\n     SSL_free(ssl);\n-    return (ret);\n+    return ret;\n }"
        },
        {
            "sha": "e9d760c999b78f51f873aad243cf662469bf2710",
            "filename": "deps/openssl/openssl/apps/cms.c",
            "status": "modified",
            "additions": 114,
            "deletions": 123,
            "changes": 237,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fcms.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fcms.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fcms.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -12,6 +12,7 @@\n #include <stdio.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n \n #ifndef OPENSSL_NO_CMS\n \n@@ -76,15 +77,16 @@ typedef enum OPTION_choice {\n     OPT_RR_ALL, OPT_RR_FIRST, OPT_RCTFORM, OPT_CERTFILE, OPT_CAFILE,\n     OPT_CAPATH, OPT_NOCAPATH, OPT_NOCAFILE,OPT_CONTENT, OPT_PRINT,\n     OPT_SECRETKEY, OPT_SECRETKEYID, OPT_PWRI_PASSWORD, OPT_ECONTENT_TYPE,\n-    OPT_RAND, OPT_PASSIN, OPT_TO, OPT_FROM, OPT_SUBJECT, OPT_SIGNER, OPT_RECIP,\n+    OPT_PASSIN, OPT_TO, OPT_FROM, OPT_SUBJECT, OPT_SIGNER, OPT_RECIP,\n     OPT_CERTSOUT, OPT_MD, OPT_INKEY, OPT_KEYFORM, OPT_KEYOPT, OPT_RR_FROM,\n     OPT_RR_TO, OPT_AES128_WRAP, OPT_AES192_WRAP, OPT_AES256_WRAP,\n     OPT_3DES_WRAP, OPT_ENGINE,\n+    OPT_R_ENUM,\n     OPT_V_ENUM,\n     OPT_CIPHER\n } OPTION_CHOICE;\n \n-OPTIONS cms_options[] = {\n+const OPTIONS cms_options[] = {\n     {OPT_HELP_STR, 1, '-', \"Usage: %s [options] cert.pem...\\n\"},\n     {OPT_HELP_STR, 1, '-',\n         \"  cert.pem... recipient certs for encryption\\n\"},\n@@ -146,14 +148,12 @@ OPTIONS cms_options[] = {\n      \"Do not load certificates from the default certificates directory\"},\n     {\"content\", OPT_CONTENT, '<',\n      \"Supply or override content for detached signature\"},\n-    {\"print\", OPT_PRINT, '-', \n+    {\"print\", OPT_PRINT, '-',\n      \"For the -cmsout operation print out all fields of the CMS structure\"},\n     {\"secretkey\", OPT_SECRETKEY, 's'},\n     {\"secretkeyid\", OPT_SECRETKEYID, 's'},\n     {\"pwri_password\", OPT_PWRI_PASSWORD, 's'},\n     {\"econtent_type\", OPT_ECONTENT_TYPE, 's'},\n-    {\"rand\", OPT_RAND, 's',\n-     \"Load the file(s) into the random number generator\"},\n     {\"passin\", OPT_PASSIN, 's', \"Input file pass phrase source\"},\n     {\"to\", OPT_TO, 's', \"To address\"},\n     {\"from\", OPT_FROM, 's', \"From address\"},\n@@ -169,6 +169,7 @@ OPTIONS cms_options[] = {\n     {\"receipt_request_from\", OPT_RR_FROM, 's'},\n     {\"receipt_request_to\", OPT_RR_TO, 's'},\n     {\"\", OPT_CIPHER, '-', \"Any supported cipher\"},\n+    OPT_R_OPTIONS,\n     OPT_V_OPTIONS,\n     {\"aes128-wrap\", OPT_AES128_WRAP, '-', \"Use AES128 to wrap key\"},\n     {\"aes192-wrap\", OPT_AES192_WRAP, '-', \"Use AES192 to wrap key\"},\n@@ -202,16 +203,13 @@ int cms_main(int argc, char **argv)\n     const char *CAfile = NULL, *CApath = NULL;\n     char *certsoutfile = NULL;\n     int noCAfile = 0, noCApath = 0;\n-    char *infile = NULL, *outfile = NULL, *rctfile = NULL, *inrand = NULL;\n-    char *passinarg = NULL, *passin = NULL, *signerfile = NULL, *recipfile =\n-        NULL;\n+    char *infile = NULL, *outfile = NULL, *rctfile = NULL;\n+    char *passinarg = NULL, *passin = NULL, *signerfile = NULL, *recipfile = NULL;\n     char *to = NULL, *from = NULL, *subject = NULL, *prog;\n     cms_key_param *key_first = NULL, *key_param = NULL;\n-    int flags = CMS_DETACHED, noout = 0, print = 0, keyidx = -1, vpmtouched =\n-        0;\n+    int flags = CMS_DETACHED, noout = 0, print = 0, keyidx = -1, vpmtouched = 0;\n     int informat = FORMAT_SMIME, outformat = FORMAT_SMIME;\n-    int need_rand = 0, operation = 0, ret = 1, rr_print = 0, rr_allorfirst =\n-        -1;\n+    int operation = 0, ret = 1, rr_print = 0, rr_allorfirst = -1;\n     int verify_retcode = 0, rctformat = FORMAT_SMIME, keyform = FORMAT_PEM;\n     size_t secret_keylen = 0, secret_keyidlen = 0;\n     unsigned char *pwri_pass = NULL, *pwri_tmp = NULL;\n@@ -449,10 +447,6 @@ int cms_main(int argc, char **argv)\n                 goto opthelp;\n             }\n             break;\n-        case OPT_RAND:\n-            inrand = opt_arg();\n-            need_rand = 1;\n-            break;\n         case OPT_ENGINE:\n             e = setup_engine(opt_arg(), 0);\n             break;\n@@ -477,7 +471,7 @@ int cms_main(int argc, char **argv)\n             break;\n         case OPT_SIGNER:\n             /* If previous -signer argument add signer to list */\n-            if (signerfile) {\n+            if (signerfile != NULL) {\n                 if (sksigners == NULL\n                     && (sksigners = sk_OPENSSL_STRING_new_null()) == NULL)\n                     goto end;\n@@ -494,7 +488,7 @@ int cms_main(int argc, char **argv)\n             break;\n         case OPT_INKEY:\n             /* If previous -inkey argument add signer to list */\n-            if (keyfile) {\n+            if (keyfile != NULL) {\n                 if (signerfile == NULL) {\n                     BIO_puts(bio_err, \"Illegal -inkey without -signer\\n\");\n                     goto end;\n@@ -525,8 +519,9 @@ int cms_main(int argc, char **argv)\n                     goto end;\n                 sk_X509_push(encerts, cert);\n                 cert = NULL;\n-            } else\n+            } else {\n                 recipfile = opt_arg();\n+            }\n             break;\n         case OPT_CIPHER:\n             if (!opt_cipher(opt_unknown(), &cipher))\n@@ -535,12 +530,12 @@ int cms_main(int argc, char **argv)\n         case OPT_KEYOPT:\n             keyidx = -1;\n             if (operation == SMIME_ENCRYPT) {\n-                if (encerts)\n+                if (encerts != NULL)\n                     keyidx += sk_X509_num(encerts);\n             } else {\n-                if (keyfile || signerfile)\n+                if (keyfile != NULL || signerfile != NULL)\n                     keyidx++;\n-                if (skkeys)\n+                if (skkeys != NULL)\n                     keyidx += sk_OPENSSL_STRING_num(skkeys);\n             }\n             if (keyidx < 0) {\n@@ -567,6 +562,10 @@ int cms_main(int argc, char **argv)\n                 goto end;\n             vpmtouched++;\n             break;\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n+            break;\n         case OPT_3DES_WRAP:\n # ifndef OPENSSL_NO_DES\n             wrap_cipher = EVP_des_ede3_wrap();\n@@ -586,87 +585,77 @@ int cms_main(int argc, char **argv)\n     argc = opt_num_rest();\n     argv = opt_rest();\n \n-    if (((rr_allorfirst != -1) || rr_from) && !rr_to) {\n+    if ((rr_allorfirst != -1 || rr_from != NULL) && rr_to == NULL) {\n         BIO_puts(bio_err, \"No Signed Receipts Recipients\\n\");\n         goto opthelp;\n     }\n \n-    if (!(operation & SMIME_SIGNERS) && (rr_to || rr_from)) {\n+    if (!(operation & SMIME_SIGNERS) && (rr_to != NULL || rr_from != NULL)) {\n         BIO_puts(bio_err, \"Signed receipts only allowed with -sign\\n\");\n         goto opthelp;\n     }\n-    if (!(operation & SMIME_SIGNERS) && (skkeys || sksigners)) {\n+    if (!(operation & SMIME_SIGNERS) && (skkeys != NULL || sksigners != NULL)) {\n         BIO_puts(bio_err, \"Multiple signers or keys not allowed\\n\");\n         goto opthelp;\n     }\n \n     if (operation & SMIME_SIGNERS) {\n-        if (keyfile && !signerfile) {\n+        if (keyfile != NULL && signerfile == NULL) {\n             BIO_puts(bio_err, \"Illegal -inkey without -signer\\n\");\n             goto opthelp;\n         }\n         /* Check to see if any final signer needs to be appended */\n-        if (signerfile) {\n-            if (!sksigners\n+        if (signerfile != NULL) {\n+            if (sksigners == NULL\n                 && (sksigners = sk_OPENSSL_STRING_new_null()) == NULL)\n                 goto end;\n             sk_OPENSSL_STRING_push(sksigners, signerfile);\n-            if (!skkeys && (skkeys = sk_OPENSSL_STRING_new_null()) == NULL)\n+            if (skkeys == NULL && (skkeys = sk_OPENSSL_STRING_new_null()) == NULL)\n                 goto end;\n-            if (!keyfile)\n+            if (keyfile == NULL)\n                 keyfile = signerfile;\n             sk_OPENSSL_STRING_push(skkeys, keyfile);\n         }\n-        if (!sksigners) {\n+        if (sksigners == NULL) {\n             BIO_printf(bio_err, \"No signer certificate specified\\n\");\n             goto opthelp;\n         }\n         signerfile = NULL;\n         keyfile = NULL;\n-        need_rand = 1;\n-    }\n-\n-    else if (operation == SMIME_DECRYPT) {\n-        if (!recipfile && !keyfile && !secret_key && !pwri_pass) {\n+    } else if (operation == SMIME_DECRYPT) {\n+        if (recipfile == NULL && keyfile == NULL\n+            && secret_key == NULL && pwri_pass == NULL) {\n             BIO_printf(bio_err,\n                        \"No recipient certificate or key specified\\n\");\n             goto opthelp;\n         }\n     } else if (operation == SMIME_ENCRYPT) {\n-        if (*argv == NULL && !secret_key && !pwri_pass && !encerts) {\n+        if (*argv == NULL && secret_key == NULL\n+            && pwri_pass == NULL && encerts == NULL) {\n             BIO_printf(bio_err, \"No recipient(s) certificate(s) specified\\n\");\n             goto opthelp;\n         }\n-        need_rand = 1;\n-    } else if (!operation)\n+    } else if (!operation) {\n         goto opthelp;\n+    }\n \n     if (!app_passwd(passinarg, NULL, &passin, NULL)) {\n         BIO_printf(bio_err, \"Error getting password\\n\");\n         goto end;\n     }\n \n-    if (need_rand) {\n-        app_RAND_load_file(NULL, (inrand != NULL));\n-        if (inrand != NULL)\n-            BIO_printf(bio_err, \"%ld semi-random bytes loaded\\n\",\n-                       app_RAND_load_files(inrand));\n-    }\n-\n     ret = 2;\n \n     if (!(operation & SMIME_SIGNERS))\n         flags &= ~CMS_DETACHED;\n \n-    if (!(operation & SMIME_OP)) {\n+    if (!(operation & SMIME_OP))\n         if (flags & CMS_BINARY)\n             outformat = FORMAT_BINARY;\n-    }\n \n-    if (!(operation & SMIME_IP)) {\n+    if (!(operation & SMIME_IP))\n         if (flags & CMS_BINARY)\n             informat = FORMAT_BINARY;\n-    }\n \n     if (operation == SMIME_ENCRYPT) {\n         if (!cipher) {\n@@ -683,7 +672,7 @@ int cms_main(int argc, char **argv)\n             goto end;\n         }\n \n-        if (*argv && !encerts)\n+        if (*argv && encerts == NULL)\n             if ((encerts = sk_X509_new_null()) == NULL)\n                 goto end;\n         while (*argv) {\n@@ -696,15 +685,15 @@ int cms_main(int argc, char **argv)\n         }\n     }\n \n-    if (certfile) {\n+    if (certfile != NULL) {\n         if (!load_certs(certfile, &other, FORMAT_PEM, NULL,\n                         \"certificate file\")) {\n             ERR_print_errors(bio_err);\n             goto end;\n         }\n     }\n \n-    if (recipfile && (operation == SMIME_DECRYPT)) {\n+    if (recipfile != NULL && (operation == SMIME_DECRYPT)) {\n         if ((recip = load_cert(recipfile, FORMAT_PEM,\n                                \"recipient certificate file\")) == NULL) {\n             ERR_print_errors(bio_err);\n@@ -721,17 +710,18 @@ int cms_main(int argc, char **argv)\n     }\n \n     if (operation == SMIME_DECRYPT) {\n-        if (!keyfile)\n+        if (keyfile == NULL)\n             keyfile = recipfile;\n     } else if ((operation == SMIME_SIGN) || (operation == SMIME_SIGN_RECEIPT)) {\n-        if (!keyfile)\n+        if (keyfile == NULL)\n             keyfile = signerfile;\n-    } else\n+    } else {\n         keyfile = NULL;\n+    }\n \n-    if (keyfile) {\n+    if (keyfile != NULL) {\n         key = load_key(keyfile, keyform, 0, passin, e, \"signing key file\");\n-        if (!key)\n+        if (key == NULL)\n             goto end;\n     }\n \n@@ -740,29 +730,29 @@ int cms_main(int argc, char **argv)\n         goto end;\n \n     if (operation & SMIME_IP) {\n-        if (informat == FORMAT_SMIME)\n+        if (informat == FORMAT_SMIME) {\n             cms = SMIME_read_CMS(in, &indata);\n-        else if (informat == FORMAT_PEM)\n+        } else if (informat == FORMAT_PEM) {\n             cms = PEM_read_bio_CMS(in, NULL, NULL, NULL);\n-        else if (informat == FORMAT_ASN1)\n+        } else if (informat == FORMAT_ASN1) {\n             cms = d2i_CMS_bio(in, NULL);\n-        else {\n+        } else {\n             BIO_printf(bio_err, \"Bad input format for CMS file\\n\");\n             goto end;\n         }\n \n-        if (!cms) {\n+        if (cms == NULL) {\n             BIO_printf(bio_err, \"Error reading S/MIME message\\n\");\n             goto end;\n         }\n-        if (contfile) {\n+        if (contfile != NULL) {\n             BIO_free(indata);\n             if ((indata = BIO_new_file(contfile, \"rb\")) == NULL) {\n                 BIO_printf(bio_err, \"Can't read content file %s\\n\", contfile);\n                 goto end;\n             }\n         }\n-        if (certsoutfile) {\n+        if (certsoutfile != NULL) {\n             STACK_OF(X509) *allcerts;\n             allcerts = CMS_get1_certs(cms);\n             if (!save_certs(certsoutfile, allcerts)) {\n@@ -775,25 +765,25 @@ int cms_main(int argc, char **argv)\n         }\n     }\n \n-    if (rctfile) {\n+    if (rctfile != NULL) {\n         char *rctmode = (rctformat == FORMAT_ASN1) ? \"rb\" : \"r\";\n         if ((rctin = BIO_new_file(rctfile, rctmode)) == NULL) {\n             BIO_printf(bio_err, \"Can't open receipt file %s\\n\", rctfile);\n             goto end;\n         }\n \n-        if (rctformat == FORMAT_SMIME)\n+        if (rctformat == FORMAT_SMIME) {\n             rcms = SMIME_read_CMS(rctin, NULL);\n-        else if (rctformat == FORMAT_PEM)\n+        } else if (rctformat == FORMAT_PEM) {\n             rcms = PEM_read_bio_CMS(rctin, NULL, NULL, NULL);\n-        else if (rctformat == FORMAT_ASN1)\n+        } else if (rctformat == FORMAT_ASN1) {\n             rcms = d2i_CMS_bio(rctin, NULL);\n-        else {\n+        } else {\n             BIO_printf(bio_err, \"Bad input format for receipt\\n\");\n             goto end;\n         }\n \n-        if (!rcms) {\n+        if (rcms == NULL) {\n             BIO_printf(bio_err, \"Error reading receipt\\n\");\n             goto end;\n         }\n@@ -823,7 +813,7 @@ int cms_main(int argc, char **argv)\n         int i;\n         flags |= CMS_PARTIAL;\n         cms = CMS_encrypt(NULL, in, cipher, flags);\n-        if (!cms)\n+        if (cms == NULL)\n             goto end;\n         for (i = 0; i < sk_X509_num(encerts); i++) {\n             CMS_RecipientInfo *ri;\n@@ -837,9 +827,9 @@ int cms_main(int argc, char **argv)\n                 }\n             }\n             ri = CMS_add1_recipient_cert(cms, x, tflags);\n-            if (!ri)\n+            if (ri == NULL)\n                 goto end;\n-            if (kparam) {\n+            if (kparam != NULL) {\n                 EVP_PKEY_CTX *pctx;\n                 pctx = CMS_RecipientInfo_get0_pkey_ctx(ri);\n                 if (!cms_set_pkey_param(pctx, kparam->param))\n@@ -853,7 +843,7 @@ int cms_main(int argc, char **argv)\n             }\n         }\n \n-        if (secret_key) {\n+        if (secret_key != NULL) {\n             if (!CMS_add0_recipient_key(cms, NID_undef,\n                                         secret_key, secret_keylen,\n                                         secret_keyid, secret_keyidlen,\n@@ -863,13 +853,13 @@ int cms_main(int argc, char **argv)\n             secret_key = NULL;\n             secret_keyid = NULL;\n         }\n-        if (pwri_pass) {\n+        if (pwri_pass != NULL) {\n             pwri_tmp = (unsigned char *)OPENSSL_strdup((char *)pwri_pass);\n-            if (!pwri_tmp)\n+            if (pwri_tmp == NULL)\n                 goto end;\n-            if (!CMS_add0_recipient_password(cms,\n-                                             -1, NID_undef, NID_undef,\n-                                             pwri_tmp, -1, NULL))\n+            if (CMS_add0_recipient_password(cms,\n+                                            -1, NID_undef, NID_undef,\n+                                            pwri_tmp, -1, NULL) == NULL)\n                 goto end;\n             pwri_tmp = NULL;\n         }\n@@ -886,11 +876,11 @@ int cms_main(int argc, char **argv)\n         STACK_OF(CMS_SignerInfo) *sis;\n         CMS_SignerInfo *si;\n         sis = CMS_get0_SignerInfos(cms);\n-        if (!sis)\n+        if (sis == NULL)\n             goto end;\n         si = sk_CMS_SignerInfo_value(sis, 0);\n         srcms = CMS_sign_receipt(si, signer, key, other, flags);\n-        if (!srcms)\n+        if (srcms == NULL)\n             goto end;\n         CMS_ContentInfo_free(cms);\n         cms = srcms;\n@@ -908,21 +898,22 @@ int cms_main(int argc, char **argv)\n             }\n             flags |= CMS_PARTIAL;\n             cms = CMS_sign(NULL, NULL, other, in, flags);\n-            if (!cms)\n+            if (cms == NULL)\n                 goto end;\n-            if (econtent_type)\n+            if (econtent_type != NULL)\n                 CMS_set1_eContentType(cms, econtent_type);\n \n-            if (rr_to) {\n+            if (rr_to != NULL) {\n                 rr = make_receipt_request(rr_to, rr_allorfirst, rr_from);\n-                if (!rr) {\n+                if (rr == NULL) {\n                     BIO_puts(bio_err,\n                              \"Signed Receipt Request Creation Error\\n\");\n                     goto end;\n                 }\n             }\n-        } else\n+        } else {\n             flags |= CMS_REUSE_DIGEST;\n+        }\n         for (i = 0; i < sk_OPENSSL_STRING_num(sksigners); i++) {\n             CMS_SignerInfo *si;\n             cms_key_param *kparam;\n@@ -931,12 +922,12 @@ int cms_main(int argc, char **argv)\n             keyfile = sk_OPENSSL_STRING_value(skkeys, i);\n \n             signer = load_cert(signerfile, FORMAT_PEM, \"signer certificate\");\n-            if (!signer) {\n+            if (signer == NULL) {\n                 ret = 2;\n                 goto end;\n             }\n             key = load_key(keyfile, keyform, 0, passin, e, \"signing key file\");\n-            if (!key) {\n+            if (key == NULL) {\n                 ret = 2;\n                 goto end;\n             }\n@@ -947,15 +938,15 @@ int cms_main(int argc, char **argv)\n                 }\n             }\n             si = CMS_add1_signer(cms, signer, key, sign_md, tflags);\n-            if (!si)\n+            if (si == NULL)\n                 goto end;\n-            if (kparam) {\n+            if (kparam != NULL) {\n                 EVP_PKEY_CTX *pctx;\n                 pctx = CMS_SignerInfo_get0_pkey_ctx(si);\n                 if (!cms_set_pkey_param(pctx, kparam->param))\n                     goto end;\n             }\n-            if (rr && !CMS_add1_ReceiptRequest(si, rr))\n+            if (rr != NULL && !CMS_add1_ReceiptRequest(si, rr))\n                 goto end;\n             X509_free(signer);\n             signer = NULL;\n@@ -969,7 +960,7 @@ int cms_main(int argc, char **argv)\n         }\n     }\n \n-    if (!cms) {\n+    if (cms == NULL) {\n         BIO_printf(bio_err, \"Error creating CMS structure\\n\");\n         goto end;\n     }\n@@ -979,7 +970,7 @@ int cms_main(int argc, char **argv)\n         if (flags & CMS_DEBUG_DECRYPT)\n             CMS_decrypt(cms, NULL, NULL, NULL, NULL, flags);\n \n-        if (secret_key) {\n+        if (secret_key != NULL) {\n             if (!CMS_decrypt_set1_key(cms,\n                                       secret_key, secret_keylen,\n                                       secret_keyid, secret_keyidlen)) {\n@@ -988,14 +979,14 @@ int cms_main(int argc, char **argv)\n             }\n         }\n \n-        if (key) {\n+        if (key != NULL) {\n             if (!CMS_decrypt_set1_pkey(cms, key, recip)) {\n                 BIO_puts(bio_err, \"Error decrypting CMS using private key\\n\");\n                 goto end;\n             }\n         }\n \n-        if (pwri_pass) {\n+        if (pwri_pass != NULL) {\n             if (!CMS_decrypt_set1_password(cms, pwri_pass, -1)) {\n                 BIO_puts(bio_err, \"Error decrypting CMS using password\\n\");\n                 goto end;\n@@ -1013,9 +1004,9 @@ int cms_main(int argc, char **argv)\n         if (!CMS_uncompress(cms, indata, out, flags))\n             goto end;\n     } else if (operation == SMIME_DIGEST_VERIFY) {\n-        if (CMS_digest_verify(cms, indata, out, flags) > 0)\n+        if (CMS_digest_verify(cms, indata, out, flags) > 0) {\n             BIO_printf(bio_err, \"Verification successful\\n\");\n-        else {\n+        } else {\n             BIO_printf(bio_err, \"Verification failure\\n\");\n             goto end;\n         }\n@@ -1024,15 +1015,15 @@ int cms_main(int argc, char **argv)\n                                        indata, out, flags))\n             goto end;\n     } else if (operation == SMIME_VERIFY) {\n-        if (CMS_verify(cms, other, store, indata, out, flags) > 0)\n+        if (CMS_verify(cms, other, store, indata, out, flags) > 0) {\n             BIO_printf(bio_err, \"Verification successful\\n\");\n-        else {\n+        } else {\n             BIO_printf(bio_err, \"Verification failure\\n\");\n             if (verify_retcode)\n                 ret = verify_err + 32;\n             goto end;\n         }\n-        if (signerfile) {\n+        if (signerfile != NULL) {\n             STACK_OF(X509) *signers;\n             signers = CMS_get0_signers(cms);\n             if (!save_certs(signerfile, signers)) {\n@@ -1047,9 +1038,9 @@ int cms_main(int argc, char **argv)\n             receipt_request_print(cms);\n \n     } else if (operation == SMIME_VERIFY_RECEIPT) {\n-        if (CMS_verify_receipt(rcms, cms, other, store, flags) > 0)\n+        if (CMS_verify_receipt(rcms, cms, other, store, flags) > 0) {\n             BIO_printf(bio_err, \"Verification successful\\n\");\n-        else {\n+        } else {\n             BIO_printf(bio_err, \"Verification failure\\n\");\n             goto end;\n         }\n@@ -1068,11 +1059,11 @@ int cms_main(int argc, char **argv)\n                 ret = SMIME_write_CMS(out, cms, indata, flags);\n             else\n                 ret = SMIME_write_CMS(out, cms, in, flags);\n-        } else if (outformat == FORMAT_PEM)\n+        } else if (outformat == FORMAT_PEM) {\n             ret = PEM_write_bio_CMS_stream(out, cms, in, flags);\n-        else if (outformat == FORMAT_ASN1)\n+        } else if (outformat == FORMAT_ASN1) {\n             ret = i2d_CMS_bio_stream(out, cms, in, flags);\n-        else {\n+        } else {\n             BIO_printf(bio_err, \"Bad output format for CMS file\\n\");\n             goto end;\n         }\n@@ -1085,8 +1076,6 @@ int cms_main(int argc, char **argv)\n  end:\n     if (ret)\n         ERR_print_errors(bio_err);\n-    if (need_rand)\n-        app_RAND_write_file(NULL);\n     sk_X509_pop_free(encerts, X509_free);\n     sk_X509_pop_free(other, X509_free);\n     X509_VERIFY_PARAM_free(vpm);\n@@ -1119,17 +1108,17 @@ int cms_main(int argc, char **argv)\n     BIO_free(indata);\n     BIO_free_all(out);\n     OPENSSL_free(passin);\n-    return (ret);\n+    return ret;\n }\n \n static int save_certs(char *signerfile, STACK_OF(X509) *signers)\n {\n     int i;\n     BIO *tmp;\n-    if (!signerfile)\n+    if (signerfile == NULL)\n         return 1;\n     tmp = BIO_new_file(signerfile, \"w\");\n-    if (!tmp)\n+    if (tmp == NULL)\n         return 0;\n     for (i = 0; i < sk_X509_num(signers); i++)\n         PEM_write_bio_X509(tmp, sk_X509_value(signers, i));\n@@ -1189,9 +1178,9 @@ static void receipt_request_print(CMS_ContentInfo *cms)\n         si = sk_CMS_SignerInfo_value(sis, i);\n         rv = CMS_get1_ReceiptRequest(si, &rr);\n         BIO_printf(bio_err, \"Signer %d:\\n\", i + 1);\n-        if (rv == 0)\n+        if (rv == 0) {\n             BIO_puts(bio_err, \"  No Receipt Request\\n\");\n-        else if (rv < 0) {\n+        } else if (rv < 0) {\n             BIO_puts(bio_err, \"  Receipt Request Parse Error\\n\");\n             ERR_print_errors(bio_err);\n         } else {\n@@ -1204,15 +1193,16 @@ static void receipt_request_print(CMS_ContentInfo *cms)\n             id = (const char *)ASN1_STRING_get0_data(scid);\n             BIO_dump_indent(bio_err, id, idlen, 4);\n             BIO_puts(bio_err, \"  Receipts From\");\n-            if (rlist) {\n+            if (rlist != NULL) {\n                 BIO_puts(bio_err, \" List:\\n\");\n                 gnames_stack_print(rlist);\n-            } else if (allorfirst == 1)\n+            } else if (allorfirst == 1) {\n                 BIO_puts(bio_err, \": First Tier\\n\");\n-            else if (allorfirst == 0)\n+            } else if (allorfirst == 0) {\n                 BIO_puts(bio_err, \": All\\n\");\n-            else\n+            } else {\n                 BIO_printf(bio_err, \" Unknown (%d)\\n\", allorfirst);\n+            }\n             BIO_puts(bio_err, \"  Receipts To:\\n\");\n             gnames_stack_print(rto);\n         }\n@@ -1227,12 +1217,12 @@ static STACK_OF(GENERAL_NAMES) *make_names_stack(STACK_OF(OPENSSL_STRING) *ns)\n     GENERAL_NAMES *gens = NULL;\n     GENERAL_NAME *gen = NULL;\n     ret = sk_GENERAL_NAMES_new_null();\n-    if (!ret)\n+    if (ret == NULL)\n         goto err;\n     for (i = 0; i < sk_OPENSSL_STRING_num(ns); i++) {\n         char *str = sk_OPENSSL_STRING_value(ns, i);\n         gen = a2i_GENERAL_NAME(NULL, NULL, NULL, GEN_EMAIL, str, 0);\n-        if (!gen)\n+        if (gen == NULL)\n             goto err;\n         gens = GENERAL_NAMES_new();\n         if (gens == NULL)\n@@ -1261,14 +1251,15 @@ static CMS_ReceiptRequest *make_receipt_request(STACK_OF(OPENSSL_STRING)\n     STACK_OF(GENERAL_NAMES) *rct_to = NULL, *rct_from = NULL;\n     CMS_ReceiptRequest *rr;\n     rct_to = make_names_stack(rr_to);\n-    if (!rct_to)\n+    if (rct_to == NULL)\n         goto err;\n-    if (rr_from) {\n+    if (rr_from != NULL) {\n         rct_from = make_names_stack(rr_from);\n-        if (!rct_from)\n+        if (rct_from == NULL)\n             goto err;\n-    } else\n+    } else {\n         rct_from = NULL;\n+    }\n     rr = CMS_ReceiptRequest_create0(NULL, -1, rr_allorfirst, rct_from,\n                                     rct_to);\n     return rr;"
        },
        {
            "sha": "031fada14c8436b556a08425c854028ed6a91f89",
            "filename": "deps/openssl/openssl/apps/crl.c",
            "status": "modified",
            "additions": 7,
            "deletions": 12,
            "changes": 19,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fcrl.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fcrl.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fcrl.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -11,6 +11,7 @@\n #include <stdlib.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/bio.h>\n #include <openssl/err.h>\n #include <openssl/x509.h>\n@@ -26,7 +27,7 @@ typedef enum OPTION_choice {\n     OPT_NOOUT, OPT_NAMEOPT, OPT_MD\n } OPTION_CHOICE;\n \n-OPTIONS crl_options[] = {\n+const OPTIONS crl_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"inform\", OPT_INFORM, 'F', \"Input format; default PEM\"},\n     {\"in\", OPT_IN, '<', \"Input file - default stdin\"},\n@@ -69,8 +70,6 @@ int crl_main(int argc, char **argv)\n     X509_OBJECT *xobj = NULL;\n     EVP_PKEY *pkey;\n     const EVP_MD *digest = EVP_sha1();\n-    unsigned long nmflag = 0;\n-    char nmflag_set = 0;\n     char *infile = NULL, *outfile = NULL, *crldiff = NULL, *keyfile = NULL;\n     const char *CAfile = NULL, *CApath = NULL, *prog;\n     OPTION_CHOICE o;\n@@ -169,8 +168,7 @@ int crl_main(int argc, char **argv)\n             badsig = 1;\n             break;\n         case OPT_NAMEOPT:\n-            nmflag_set = 1;\n-            if (!set_name_ex(&nmflag, opt_arg()))\n+            if (!set_nameopt(opt_arg()))\n                 goto opthelp;\n             break;\n         case OPT_MD:\n@@ -182,9 +180,6 @@ int crl_main(int argc, char **argv)\n     if (argc != 0)\n         goto opthelp;\n \n-    if (!nmflag_set)\n-        nmflag = XN_FLAG_ONELINE;\n-\n     x = load_crl(infile, informat);\n     if (x == NULL)\n         goto end;\n@@ -260,7 +255,7 @@ int crl_main(int argc, char **argv)\n         for (i = 1; i <= num; i++) {\n             if (issuer == i) {\n                 print_name(bio_out, \"issuer=\", X509_CRL_get_issuer(x),\n-                           nmflag);\n+                           get_nameopt());\n             }\n             if (crlnumber == i) {\n                 ASN1_INTEGER *crlnum;\n@@ -319,7 +314,7 @@ int crl_main(int argc, char **argv)\n         goto end;\n \n     if (text)\n-        X509_CRL_print(out, x);\n+        X509_CRL_print_ex(out, x, get_nameopt());\n \n     if (noout) {\n         ret = 0;\n@@ -343,5 +338,5 @@ int crl_main(int argc, char **argv)\n     X509_CRL_free(x);\n     X509_STORE_CTX_free(ctx);\n     X509_STORE_free(store);\n-    return (ret);\n+    return ret;\n }"
        },
        {
            "sha": "88fabcb22c3618031690789b75a926c99ab0fd3f",
            "filename": "deps/openssl/openssl/apps/crl2p7.c",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fcrl2p7.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fcrl2p7.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fcrl2p7.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -11,6 +11,7 @@\n #include <string.h>\n #include <sys/types.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/err.h>\n #include <openssl/evp.h>\n #include <openssl/x509.h>\n@@ -25,7 +26,7 @@ typedef enum OPTION_choice {\n     OPT_INFORM, OPT_OUTFORM, OPT_IN, OPT_OUT, OPT_NOCRL, OPT_CERTFILE\n } OPTION_CHOICE;\n \n-OPTIONS crl2pkcs7_options[] = {\n+const OPTIONS crl2pkcs7_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"inform\", OPT_INFORM, 'F', \"Input format - DER or PEM\"},\n     {\"outform\", OPT_OUTFORM, 'F', \"Output format - DER or PEM\"},\n@@ -131,7 +132,7 @@ int crl2pkcs7_main(int argc, char **argv)\n         goto end;\n     p7s->cert = cert_stack;\n \n-    if (certflst)\n+    if (certflst != NULL)\n         for (i = 0; i < sk_OPENSSL_STRING_num(certflst); i++) {\n             certfile = sk_OPENSSL_STRING_value(certflst, i);\n             if (add_certs_from_file(cert_stack, certfile) < 0) {\n@@ -162,7 +163,7 @@ int crl2pkcs7_main(int argc, char **argv)\n     PKCS7_free(p7);\n     X509_CRL_free(crl);\n \n-    return (ret);\n+    return ret;\n }\n \n /*-\n@@ -212,5 +213,5 @@ static int add_certs_from_file(STACK_OF(X509) *stack, char *certfile)\n     /* never need to OPENSSL_free x */\n     BIO_free(in);\n     sk_X509_INFO_free(sk);\n-    return (ret);\n+    return ret;\n }"
        },
        {
            "sha": "650aa22da59c42701f27a3030901ee19538e801b",
            "filename": "deps/openssl/openssl/apps/ct_log_list.cnf",
            "status": "modified",
            "additions": 9,
            "deletions": 34,
            "changes": 43,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fct_log_list.cnf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fct_log_list.cnf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fct_log_list.cnf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,34 +1,9 @@\n-enabled_logs=pilot,aviator,rocketeer,digicert,certly,izempe,symantec,venafi\n-\n-[pilot]\n-description = Google Pilot Log\n-key = MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEfahLEimAoz2t01p3uMziiLOl/fHTDM0YDOhBRuiBARsV4UvxG2LdNgoIGLrtCzWE0J5APC2em4JlvR8EEEFMoA==\n-\n-[aviator]\n-description = Google Aviator log\n-key = MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE1/TMabLkDpCjiupacAlP7xNi0I1JYP8bQFAHDG1xhtolSY1l4QgNRzRrvSe8liE+NPWHdjGxfx3JhTsN9x8/6Q==\n-\n-[rocketeer]\n-description = Google Rocketeer log\n-key = MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEIFsYyDzBi7MxCAC/oJBXK7dHjG+1aLCOkHjpoHPqTyghLpzA9BYbqvnV16mAw04vUjyYASVGJCUoI3ctBcJAeg==\n-\n-[digicert]\n-description = DigiCert Log Server\n-key = MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEAkbFvhu7gkAW6MHSrBlpE1n4+HCFRkC5OLAjgqhkTH+/uzSfSl8ois8ZxAD2NgaTZe1M9akhYlrYkes4JECs6A==\n-\n-[certly]\n-description = Certly.IO log\n-key = MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAECyPLhWKYYUgEc+tUXfPQB4wtGS2MNvXrjwFCCnyYJifBtd2Sk7Cu+Js9DNhMTh35FftHaHu6ZrclnNBKwmbbSA==\n-\n-[izempe]\n-description = Izempe log\n-key = MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEJ2Q5DC3cUBj4IQCiDu0s6j51up+TZAkAEcQRF6tczw90rLWXkJMAW7jr9yc92bIKgV8vDXU4lDeZHvYHduDuvg==\n-\n-[symantec]\n-description = Symantec log\n-key = MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEluqsHEYMG1XcDfy1lCdGV0JwOmkY4r87xNuroPS2bMBTP01CEDPwWJePa75y9CrsHEKqAy8afig1dpkIPSEUhg==\n-\n-[venafi]\n-description = Venafi log\n-key = MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAolpIHxdSlTXLo1s6H1OCdpSj/4DyHDc8wLG9wVmLqy1lk9fz4ATVmm+/1iN2Nk8jmctUKK2MFUtlWXZBSpym97M7frGlSaQXUWyA3CqQUEuIJOmlEjKTBEiQAvpfDjCHjlV2Be4qTM6jamkJbiWtgnYPhJL6ONaGTiSPm7Byy57iaz/hbckldSOIoRhYBiMzeNoA0DiRZ9KmfSeXZ1rB8y8X5urSW+iBzf2SaOfzBvDpcoTuAaWx2DPazoOl28fP1hZ+kHUYvxbcMjttjauCFx+JII0dmuZNIwjfeG/GBb9frpSX219k1O4Wi6OEbHEr8at/XQ0y7gTikOxBn/s5wQIDAQAB\n-\n+# This file specifies the Certificate Transparency logs\n+# that are to be trusted.\n+\n+# Google's list of logs can be found here:\n+#       www.certificate-transparency.org/known-logs \n+# A Python program to convert the log list to OpenSSL's format can be\n+# found here:\n+#       https://github.com/google/certificate-transparency/blob/master/python/utilities/log_list/print_log_list.py \n+# Use the \"--openssl_output\" flag."
        },
        {
            "sha": "affbce3bc94837333486376b5b79edd3a26981c8",
            "filename": "deps/openssl/openssl/apps/demoCA/cacert.pem",
            "status": "removed",
            "additions": 0,
            "deletions": 14,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Fcacert.pem",
            "raw_url": "https://github.com/nodejs/node/raw/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Fcacert.pem",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Fcacert.pem?ref=5d80f9ea6091847176fa47fb1395fdffc4af9164",
            "patch": "@@ -1,14 +0,0 @@\n-subject=/C=AU/SOP=QLD/O=Mincom Pty. Ltd./OU=CS/CN=SSLeay demo server\n-issuer= /C=AU/SOP=QLD/O=Mincom Pty. Ltd./OU=CS/CN=CA\n------BEGIN X509 CERTIFICATE-----\n-\n-MIIBgjCCASwCAQQwDQYJKoZIhvcNAQEEBQAwODELMAkGA1UEBhMCQVUxDDAKBgNV\n-BAgTA1FMRDEbMBkGA1UEAxMSU1NMZWF5L3JzYSB0ZXN0IENBMB4XDTk1MTAwOTIz\n-MzIwNVoXDTk4MDcwNTIzMzIwNVowYDELMAkGA1UEBhMCQVUxDDAKBgNVBAgTA1FM\n-RDEZMBcGA1UEChMQTWluY29tIFB0eS4gTHRkLjELMAkGA1UECxMCQ1MxGzAZBgNV\n-BAMTElNTTGVheSBkZW1vIHNlcnZlcjBcMA0GCSqGSIb3DQEBAQUAA0sAMEgCQQC3\n-LCXcScWua0PFLkHBLm2VejqpA1F4RQ8q0VjRiPafjx/Z/aWH3ipdMVvuJGa/wFXb\n-/nDFLDlfWp+oCPwhBtVPAgMBAAEwDQYJKoZIhvcNAQEEBQADQQArNFsihWIjBzb0\n-DCsU0BvL2bvSwJrPEqFlkDq3F4M6EGutL9axEcANWgbbEdAvNJD1dmEmoWny27Pn\n-IMs6ZOZB\n------END X509 CERTIFICATE-----"
        },
        {
            "sha": "2cdd252d67ca73185fe331a2e7b153babd459523",
            "filename": "deps/openssl/openssl/apps/demoCA/index.txt",
            "status": "removed",
            "additions": 0,
            "deletions": 39,
            "changes": 39,
            "blob_url": "https://github.com/nodejs/node/blob/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Findex.txt",
            "raw_url": "https://github.com/nodejs/node/raw/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Findex.txt",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Findex.txt?ref=5d80f9ea6091847176fa47fb1395fdffc4af9164",
            "patch": "@@ -1,39 +0,0 @@\n-R\t980705233205Z\t951009233205Z\t01\tcerts/00000001\t/CN=Eric Young\n-E\t951009233205Z\t\t02\tcerts/00000002\t/CN=Duncan Young\n-R\t980705233205Z\t951201010000Z\t03\tcerts/00000003\t/CN=Tim Hudson\n-V\t980705233205Z\t\t04\tcerts/00000004\t/CN=Eric Young4\n-V\t980705233205Z\t\t05\tcerts/00000004\t/CN=Eric Young5\n-V\t980705233205Z\t\t06\tcerts/00000004\t/CN=Eric Young6\n-V\t980705233205Z\t\t07\tcerts/00000004\t/CN=Eric Young7\n-V\t980705233205Z\t\t08\tcerts/00000004\t/CN=Eric Young8\n-V\t980705233205Z\t\t09\tcerts/00000004\t/CN=Eric Young9\n-V\t980705233205Z\t\t0A\tcerts/00000004\t/CN=Eric YoungA\n-V\t980705233205Z\t\t0B\tcerts/00000004\t/CN=Eric YoungB\n-V\t980705233205Z\t\t0C\tcerts/00000004\t/CN=Eric YoungC\n-V\t980705233205Z\t\t0D\tcerts/00000004\t/CN=Eric YoungD\n-V\t980705233205Z\t\t0E\tcerts/00000004\t/CN=Eric YoungE\n-V\t980705233205Z\t\t0F\tcerts/00000004\t/CN=Eric YoungF\n-V\t980705233205Z\t\t10\tcerts/00000004\t/CN=Eric Young10\n-V\t980705233205Z\t\t11\tcerts/00000004\t/CN=Eric Young11\n-V\t980705233205Z\t\t12\tcerts/00000004\t/CN=Eric Young12\n-V\t980705233205Z\t\t13\tcerts/00000004\t/CN=Eric Young13\n-V\t980705233205Z\t\t14\tcerts/00000004\t/CN=Eric Young14\n-V\t980705233205Z\t\t15\tcerts/00000004\t/CN=Eric Young15\n-V\t980705233205Z\t\t16\tcerts/00000004\t/CN=Eric Young16\n-V\t980705233205Z\t\t17\tcerts/00000004\t/CN=Eric Young17\n-V\t961206150305Z\t\t010C\tunknown\t/C=AU/SP=QLD/O=Mincom Pty. Ltd./OU=MTR/CN=Eric Young/Email=eay@mincom.oz.au\n-V\t961206153245Z\t\t010D\tunknown\t/C=AU/SP=Queensland/O=Mincom Pty Ltd/OU=MTR/CN=Eric Young/Email=eay@mincom.oz.au\n-V\t970322074816Z\t\t010E\tunknown\t/CN=Eric Young/Email=eay@mincom.oz.au\n-V\t970322075152Z\t\t010F\tunknown\t/CN=Eric Young\n-V\t970322075906Z\t\t0110\tunknown\t/CN=Eric Youngg\n-V\t970324092238Z\t\t0111\tunknown\t/C=AU/SP=Queensland/CN=Eric Young\n-V\t970324221931Z\t\t0112\tunknown\t/CN=Fred\n-V\t970324224934Z\t\t0113\tunknown\t/C=AU/CN=eay\n-V\t971001005237Z\t\t0114\tunknown\t/C=AU/SP=QLD/O=Mincom Pty Ltd/OU=MTR/CN=x509v3 test\n-V\t971001010331Z\t\t0115\tunknown\t/C=AU/SP=Queensland/O=Mincom Pty Ltd/OU=MTR/CN=test again - x509v3\n-V\t971001013945Z\t\t0117\tunknown\t/C=AU/SP=Queensland/O=Mincom Pty Ltd/OU=MTR/CN=x509v3 test\n-V\t971014225415Z\t\t0118\tunknown\t/C=AU/SP=Queensland/CN=test\n-V\t971015004448Z\t\t0119\tunknown\t/C=AU/SP=Queensland/O=Mincom Pty Ltd/OU=MTR/CN=test2\n-V\t971016035001Z\t\t011A\tunknown\t/C=AU/SP=Queensland/O=Mincom Pty Ltd/OU=MTR/CN=test64\n-V\t971016080129Z\t\t011B\tunknown\t/C=FR/O=ALCATEL/OU=Alcatel Mobile Phones/CN=bourque/Email=bourque@art.alcatel.fr\n-V\t971016224000Z\t\t011D\tunknown\t/L=Bedford/O=Cranfield University/OU=Computer Centre/CN=Peter R Lister/Email=P.Lister@cranfield.ac.uk"
        },
        {
            "sha": "48fb18c7d80707fe20ce27c0a70d05cdb2a29063",
            "filename": "deps/openssl/openssl/apps/demoCA/private/cakey.pem",
            "status": "removed",
            "additions": 0,
            "deletions": 24,
            "changes": 24,
            "blob_url": "https://github.com/nodejs/node/blob/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Fprivate%2Fcakey.pem",
            "raw_url": "https://github.com/nodejs/node/raw/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Fprivate%2Fcakey.pem",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Fprivate%2Fcakey.pem?ref=5d80f9ea6091847176fa47fb1395fdffc4af9164",
            "patch": "@@ -1,24 +0,0 @@\n-issuer= /C=AU/SOP=QLD/O=Mincom Pty. Ltd./OU=CS/CN=CA\n-subject=/C=AU/SOP=QLD/O=Mincom Pty. Ltd./OU=CS/CN=SSLeay demo server\n------BEGIN X509 CERTIFICATE-----\n-\n-MIIBgjCCASwCAQQwDQYJKoZIhvcNAQEEBQAwODELMAkGA1UEBhMCQVUxDDAKBgNV\n-BAgTA1FMRDEbMBkGA1UEAxMSU1NMZWF5L3JzYSB0ZXN0IENBMB4XDTk1MTAwOTIz\n-MzIwNVoXDTk4MDcwNTIzMzIwNVowYDELMAkGA1UEBhMCQVUxDDAKBgNVBAgTA1FM\n-RDEZMBcGA1UEChMQTWluY29tIFB0eS4gTHRkLjELMAkGA1UECxMCQ1MxGzAZBgNV\n-BAMTElNTTGVheSBkZW1vIHNlcnZlcjBcMA0GCSqGSIb3DQEBAQUAA0sAMEgCQQC3\n-LCXcScWua0PFLkHBLm2VejqpA1F4RQ8q0VjRiPafjx/Z/aWH3ipdMVvuJGa/wFXb\n-/nDFLDlfWp+oCPwhBtVPAgMBAAEwDQYJKoZIhvcNAQEEBQADQQArNFsihWIjBzb0\n-DCsU0BvL2bvSwJrPEqFlkDq3F4M6EGutL9axEcANWgbbEdAvNJD1dmEmoWny27Pn\n-IMs6ZOZB\n------END X509 CERTIFICATE-----\n------BEGIN RSA PRIVATE KEY-----\n-\n-MIIBPAIBAAJBALcsJdxJxa5rQ8UuQcEubZV6OqkDUXhFDyrRWNGI9p+PH9n9pYfe\n-Kl0xW+4kZr/AVdv+cMUsOV9an6gI/CEG1U8CAwEAAQJAXJMBZ34ZXHd1vtgL/3hZ\n-hexKbVTx/djZO4imXO/dxPGRzG2ylYZpHmG32/T1kaHpZlCHoEPgHoSzmxYXfxjG\n-sQIhAPmZ/bQOjmRUHM/VM2X5zrjjM6z18R1P6l3ObFwt9FGdAiEAu943Yh9SqMRw\n-tL0xHGxKmM/YJueUw1gB6sLkETN71NsCIQCeT3RhoqXfrpXDoEcEU+gwzjI1bpxq\n-agiNTOLfqGoA5QIhAIQFYjgzONxex7FLrsKBm16N2SFl5pXsN9SpRqqL2n63AiEA\n-g9VNIQ3xwpw7og3IbONifeku+J9qGMGQJMKwSTwrFtI=\n------END RSA PRIVATE KEY-----"
        },
        {
            "sha": "69fa0ffe28e7e4f14a2f0847383c68a1a350d4e5",
            "filename": "deps/openssl/openssl/apps/demoCA/serial",
            "status": "removed",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Fserial",
            "raw_url": "https://github.com/nodejs/node/raw/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Fserial",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2FdemoCA%2Fserial?ref=5d80f9ea6091847176fa47fb1395fdffc4af9164",
            "patch": "@@ -1 +0,0 @@\n-011E"
        },
        {
            "sha": "d158a0ccb2843af199467d4dde07b66d02aaf1ae",
            "filename": "deps/openssl/openssl/apps/dgst.c",
            "status": "modified",
            "additions": 53,
            "deletions": 41,
            "changes": 94,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdgst.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdgst.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdgst.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -11,6 +11,7 @@\n #include <string.h>\n #include <stdlib.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/bio.h>\n #include <openssl/err.h>\n #include <openssl/evp.h>\n@@ -29,22 +30,21 @@ int do_fp(BIO *out, unsigned char *buf, BIO *bp, int sep, int binout,\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n-    OPT_C, OPT_R, OPT_RAND, OPT_OUT, OPT_SIGN, OPT_PASSIN, OPT_VERIFY,\n+    OPT_C, OPT_R, OPT_OUT, OPT_SIGN, OPT_PASSIN, OPT_VERIFY,\n     OPT_PRVERIFY, OPT_SIGNATURE, OPT_KEYFORM, OPT_ENGINE, OPT_ENGINE_IMPL,\n     OPT_HEX, OPT_BINARY, OPT_DEBUG, OPT_FIPS_FINGERPRINT,\n     OPT_HMAC, OPT_MAC, OPT_SIGOPT, OPT_MACOPT,\n-    OPT_DIGEST\n+    OPT_DIGEST,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS dgst_options[] = {\n+const OPTIONS dgst_options[] = {\n     {OPT_HELP_STR, 1, '-', \"Usage: %s [options] [file...]\\n\"},\n     {OPT_HELP_STR, 1, '-',\n         \"  file... files to digest (default is stdin)\\n\"},\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"c\", OPT_C, '-', \"Print the digest with separating colons\"},\n     {\"r\", OPT_R, '-', \"Print the digest in coreutils format\"},\n-    {\"rand\", OPT_RAND, 's',\n-     \"Use file(s) containing random data to seed RNG or an EGD sock\"},\n     {\"out\", OPT_OUT, '>', \"Output to filename rather than stdout\"},\n     {\"passin\", OPT_PASSIN, 's', \"Input file pass phrase source\"},\n     {\"sign\", OPT_SIGN, 's', \"Sign digest using private key\"},\n@@ -65,6 +65,7 @@ OPTIONS dgst_options[] = {\n     {\"sigopt\", OPT_SIGOPT, 's', \"Signature parameter in n:v form\"},\n     {\"macopt\", OPT_MACOPT, 's', \"MAC algorithm parameters in n:v form or key\"},\n     {\"\", OPT_DIGEST, '-', \"Any supported digest\"},\n+    OPT_R_OPTIONS,\n #ifndef OPENSSL_NO_ENGINE\n     {\"engine\", OPT_ENGINE, 's', \"Use engine e, possibly a hardware device\"},\n     {\"engine_impl\", OPT_ENGINE_IMPL, '-',\n@@ -84,7 +85,7 @@ int dgst_main(int argc, char **argv)\n     char *passinarg = NULL, *passin = NULL;\n     const EVP_MD *md = NULL, *m;\n     const char *outfile = NULL, *keyfile = NULL, *prog = NULL;\n-    const char *sigfile = NULL, *randfile = NULL;\n+    const char *sigfile = NULL;\n     OPTION_CHOICE o;\n     int separator = 0, debug = 0, keyform = FORMAT_PEM, siglen = 0;\n     int i, ret = 1, out_bin = -1, want_pub = 0, do_verify = 0;\n@@ -113,8 +114,9 @@ int dgst_main(int argc, char **argv)\n         case OPT_R:\n             separator = 2;\n             break;\n-        case OPT_RAND:\n-            randfile = opt_arg();\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n             break;\n         case OPT_OUT:\n             outfile = opt_arg();\n@@ -190,7 +192,7 @@ int dgst_main(int argc, char **argv)\n         goto end;\n     }\n \n-    if (do_verify && !sigfile) {\n+    if (do_verify && sigfile == NULL) {\n         BIO_printf(bio_err,\n                    \"No signature to verify: use the -signature option\\n\");\n         goto end;\n@@ -217,43 +219,51 @@ int dgst_main(int argc, char **argv)\n     }\n \n     if (out_bin == -1) {\n-        if (keyfile)\n+        if (keyfile != NULL)\n             out_bin = 1;\n         else\n             out_bin = 0;\n     }\n \n-    if (randfile)\n-        app_RAND_load_file(randfile, 0);\n-\n     out = bio_open_default(outfile, 'w', out_bin ? FORMAT_BINARY : FORMAT_TEXT);\n     if (out == NULL)\n         goto end;\n \n-    if ((! !mac_name + ! !keyfile + ! !hmac_key) > 1) {\n+    if ((!(mac_name == NULL) + !(keyfile == NULL) + !(hmac_key == NULL)) > 1) {\n         BIO_printf(bio_err, \"MAC and Signing key cannot both be specified\\n\");\n         goto end;\n     }\n \n-    if (keyfile) {\n+    if (keyfile != NULL) {\n+        int type;\n+\n         if (want_pub)\n             sigkey = load_pubkey(keyfile, keyform, 0, NULL, e, \"key file\");\n         else\n             sigkey = load_key(keyfile, keyform, 0, passin, e, \"key file\");\n-        if (!sigkey) {\n+        if (sigkey == NULL) {\n             /*\n              * load_[pub]key() has already printed an appropriate message\n              */\n             goto end;\n         }\n+        type = EVP_PKEY_id(sigkey);\n+        if (type == EVP_PKEY_ED25519 || type == EVP_PKEY_ED448) {\n+            /*\n+             * We implement PureEdDSA for these which doesn't have a separate\n+             * digest, and only supports one shot.\n+             */\n+            BIO_printf(bio_err, \"Key type not supported for this operation\\n\");\n+            goto end;\n+        }\n     }\n \n-    if (mac_name) {\n+    if (mac_name != NULL) {\n         EVP_PKEY_CTX *mac_ctx = NULL;\n         int r = 0;\n         if (!init_gen_str(&mac_ctx, mac_name, impl, 0))\n             goto mac_end;\n-        if (macopts) {\n+        if (macopts != NULL) {\n             char *macopt;\n             for (i = 0; i < sk_OPENSSL_STRING_num(macopts); i++) {\n                 macopt = sk_OPENSSL_STRING_value(macopts, i);\n@@ -277,14 +287,14 @@ int dgst_main(int argc, char **argv)\n             goto end;\n     }\n \n-    if (hmac_key) {\n-        sigkey = EVP_PKEY_new_mac_key(EVP_PKEY_HMAC, impl,\n-                                      (unsigned char *)hmac_key, -1);\n-        if (!sigkey)\n+    if (hmac_key != NULL) {\n+        sigkey = EVP_PKEY_new_raw_private_key(EVP_PKEY_HMAC, impl,\n+                                              (unsigned char *)hmac_key, -1);\n+        if (sigkey == NULL)\n             goto end;\n     }\n \n-    if (sigkey) {\n+    if (sigkey != NULL) {\n         EVP_MD_CTX *mctx = NULL;\n         EVP_PKEY_CTX *pctx = NULL;\n         int r;\n@@ -302,7 +312,7 @@ int dgst_main(int argc, char **argv)\n             ERR_print_errors(bio_err);\n             goto end;\n         }\n-        if (sigopts) {\n+        if (sigopts != NULL) {\n             char *sigopt;\n             for (i = 0; i < sk_OPENSSL_STRING_num(sigopts); i++) {\n                 sigopt = sk_OPENSSL_STRING_value(sigopts, i);\n@@ -331,9 +341,9 @@ int dgst_main(int argc, char **argv)\n         }\n     }\n \n-    if (sigfile && sigkey) {\n+    if (sigfile != NULL && sigkey != NULL) {\n         BIO *sigbio = BIO_new_file(sigfile, \"rb\");\n-        if (!sigbio) {\n+        if (sigbio == NULL) {\n             BIO_printf(bio_err, \"Error opening signature file %s\\n\", sigfile);\n             ERR_print_errors(bio_err);\n             goto end;\n@@ -363,14 +373,14 @@ int dgst_main(int argc, char **argv)\n     } else {\n         const char *md_name = NULL, *sig_name = NULL;\n         if (!out_bin) {\n-            if (sigkey) {\n+            if (sigkey != NULL) {\n                 const EVP_PKEY_ASN1_METHOD *ameth;\n                 ameth = EVP_PKEY_get0_asn1(sigkey);\n                 if (ameth)\n                     EVP_PKEY_asn1_get0_info(NULL, NULL,\n                                             NULL, NULL, &sig_name, ameth);\n             }\n-            if (md)\n+            if (md != NULL)\n                 md_name = EVP_MD_name(md);\n         }\n         ret = 0;\n@@ -380,9 +390,10 @@ int dgst_main(int argc, char **argv)\n                 perror(argv[i]);\n                 ret++;\n                 continue;\n-            } else\n+            } else {\n                 r = do_fp(out, buf, inp, separator, out_bin, sigkey, sigbuf,\n                           siglen, sig_name, md_name, argv[i]);\n+            }\n             if (r)\n                 ret = r;\n             (void)BIO_reset(bmd);\n@@ -399,7 +410,7 @@ int dgst_main(int argc, char **argv)\n     OPENSSL_free(sigbuf);\n     BIO_free(bmd);\n     release_engine(e);\n-    return (ret);\n+    return ret;\n }\n \n int do_fp(BIO *out, unsigned char *buf, BIO *bp, int sep, int binout,\n@@ -420,13 +431,13 @@ int do_fp(BIO *out, unsigned char *buf, BIO *bp, int sep, int binout,\n         if (i == 0)\n             break;\n     }\n-    if (sigin) {\n+    if (sigin != NULL) {\n         EVP_MD_CTX *ctx;\n         BIO_get_md_ctx(bp, &ctx);\n         i = EVP_DigestVerifyFinal(ctx, sigin, (unsigned int)siglen);\n-        if (i > 0)\n+        if (i > 0) {\n             BIO_printf(out, \"Verified OK\\n\");\n-        else if (i == 0) {\n+        } else if (i == 0) {\n             BIO_printf(out, \"Verification Failure\\n\");\n             return 1;\n         } else {\n@@ -436,7 +447,7 @@ int do_fp(BIO *out, unsigned char *buf, BIO *bp, int sep, int binout,\n         }\n         return 0;\n     }\n-    if (key) {\n+    if (key != NULL) {\n         EVP_MD_CTX *ctx;\n         BIO_get_md_ctx(bp, &ctx);\n         len = BUFSIZE;\n@@ -453,22 +464,23 @@ int do_fp(BIO *out, unsigned char *buf, BIO *bp, int sep, int binout,\n         }\n     }\n \n-    if (binout)\n+    if (binout) {\n         BIO_write(out, buf, len);\n-    else if (sep == 2) {\n+    } else if (sep == 2) {\n         for (i = 0; i < (int)len; i++)\n             BIO_printf(out, \"%02x\", buf[i]);\n         BIO_printf(out, \" *%s\\n\", file);\n     } else {\n-        if (sig_name) {\n+        if (sig_name != NULL) {\n             BIO_puts(out, sig_name);\n-            if (md_name)\n+            if (md_name != NULL)\n                 BIO_printf(out, \"-%s\", md_name);\n             BIO_printf(out, \"(%s)= \", file);\n-        } else if (md_name)\n+        } else if (md_name != NULL) {\n             BIO_printf(out, \"%s(%s)= \", md_name, file);\n-        else\n+        } else {\n             BIO_printf(out, \"(%s)= \", file);\n+        }\n         for (i = 0; i < (int)len; i++) {\n             if (sep && (i != 0))\n                 BIO_printf(out, \":\");"
        },
        {
            "sha": "13f76754d27cbe027558b9170f29032fd65f7529",
            "filename": "deps/openssl/openssl/apps/dhparam.c",
            "status": "modified",
            "additions": 27,
            "deletions": 41,
            "changes": 68,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdhparam.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdhparam.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdhparam.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -17,6 +17,7 @@ NON_EMPTY_TRANSLATION_UNIT\n # include <time.h>\n # include <string.h>\n # include \"apps.h\"\n+# include \"progs.h\"\n # include <openssl/bio.h>\n # include <openssl/err.h>\n # include <openssl/bn.h>\n@@ -36,10 +37,11 @@ typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_INFORM, OPT_OUTFORM, OPT_IN, OPT_OUT,\n     OPT_ENGINE, OPT_CHECK, OPT_TEXT, OPT_NOOUT,\n-    OPT_RAND, OPT_DSAPARAM, OPT_C, OPT_2, OPT_5\n+    OPT_DSAPARAM, OPT_C, OPT_2, OPT_5,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS dhparam_options[] = {\n+const OPTIONS dhparam_options[] = {\n     {OPT_HELP_STR, 1, '-', \"Usage: %s [flags] [numbits]\\n\"},\n     {OPT_HELP_STR, 1, '-', \"Valid options are:\\n\"},\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n@@ -50,8 +52,7 @@ OPTIONS dhparam_options[] = {\n     {\"check\", OPT_CHECK, '-', \"Check the DH parameters\"},\n     {\"text\", OPT_TEXT, '-', \"Print a text form of the DH parameters\"},\n     {\"noout\", OPT_NOOUT, '-', \"Don't output any DH parameters\"},\n-    {\"rand\", OPT_RAND, 's',\n-     \"Load the file(s) into the random number generator\"},\n+    OPT_R_OPTIONS,\n     {\"C\", OPT_C, '-', \"Print C code\"},\n     {\"2\", OPT_2, '-', \"Generate parameters using 2 as the generator value\"},\n     {\"5\", OPT_5, '-', \"Generate parameters using 5 as the generator value\"},\n@@ -69,7 +70,7 @@ int dhparam_main(int argc, char **argv)\n {\n     BIO *in = NULL, *out = NULL;\n     DH *dh = NULL;\n-    char *infile = NULL, *outfile = NULL, *prog, *inrand = NULL;\n+    char *infile = NULL, *outfile = NULL, *prog;\n     ENGINE *e = NULL;\n #ifndef OPENSSL_NO_DSA\n     int dsaparam = 0;\n@@ -130,15 +131,16 @@ int dhparam_main(int argc, char **argv)\n         case OPT_NOOUT:\n             noout = 1;\n             break;\n-        case OPT_RAND:\n-            inrand = opt_arg();\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n             break;\n         }\n     }\n     argc = opt_num_rest();\n     argv = opt_rest();\n \n-    if (argv[0] && (!opt_int(argv[0], &num) || num <= 0))\n+    if (argv[0] != NULL && (!opt_int(argv[0], &num) || num <= 0))\n         goto end;\n \n     if (g && !num)\n@@ -170,13 +172,6 @@ int dhparam_main(int argc, char **argv)\n         }\n \n         BN_GENCB_set(cb, dh_cb, bio_err);\n-        if (!app_RAND_load_file(NULL, 1) && inrand == NULL) {\n-            BIO_printf(bio_err,\n-                       \"warning, not much extra random data, consider using the -rand option\\n\");\n-        }\n-        if (inrand != NULL)\n-            BIO_printf(bio_err, \"%ld semi-random bytes loaded\\n\",\n-                       app_RAND_load_files(inrand));\n \n # ifndef OPENSSL_NO_DSA\n         if (dsaparam) {\n@@ -216,7 +211,6 @@ int dhparam_main(int argc, char **argv)\n         }\n \n         BN_GENCB_free(cb);\n-        app_RAND_write_file(NULL);\n     } else {\n \n         in = bio_open_default(infile, 'r', informat);\n@@ -315,33 +309,31 @@ int dhparam_main(int argc, char **argv)\n         bits = DH_bits(dh);\n         DH_get0_pqg(dh, &pbn, NULL, &gbn);\n         data = app_malloc(len, \"print a BN\");\n-        BIO_printf(out, \"#ifndef HEADER_DH_H\\n\"\n-                        \"# include <openssl/dh.h>\\n\"\n-                        \"#endif\\n\"\n-                        \"\\n\");\n-        BIO_printf(out, \"DH *get_dh%d()\\n{\\n\", bits);\n+\n+        BIO_printf(out, \"static DH *get_dh%d(void)\\n{\\n\", bits);\n         print_bignum_var(out, pbn, \"dhp\", bits, data);\n         print_bignum_var(out, gbn, \"dhg\", bits, data);\n         BIO_printf(out, \"    DH *dh = DH_new();\\n\"\n-                        \"    BIGNUM *dhp_bn, *dhg_bn;\\n\"\n+                        \"    BIGNUM *p, *g;\\n\"\n                         \"\\n\"\n                         \"    if (dh == NULL)\\n\"\n                         \"        return NULL;\\n\");\n-        BIO_printf(out, \"    dhp_bn = BN_bin2bn(dhp_%d, sizeof(dhp_%d), NULL);\\n\",\n+        BIO_printf(out, \"    p = BN_bin2bn(dhp_%d, sizeof(dhp_%d), NULL);\\n\",\n                    bits, bits);\n-        BIO_printf(out, \"    dhg_bn = BN_bin2bn(dhg_%d, sizeof(dhg_%d), NULL);\\n\",\n+        BIO_printf(out, \"    g = BN_bin2bn(dhg_%d, sizeof(dhg_%d), NULL);\\n\",\n                    bits, bits);\n-        BIO_printf(out, \"    if (dhp_bn == NULL || dhg_bn == NULL\\n\"\n-                        \"            || !DH_set0_pqg(dh, dhp_bn, NULL, dhg_bn)) {\\n\"\n+        BIO_printf(out, \"    if (p == NULL || g == NULL\\n\"\n+                        \"            || !DH_set0_pqg(dh, p, NULL, g)) {\\n\"\n                         \"        DH_free(dh);\\n\"\n-                        \"        BN_free(dhp_bn);\\n\"\n-                        \"        BN_free(dhg_bn);\\n\"\n+                        \"        BN_free(p);\\n\"\n+                        \"        BN_free(g);\\n\"\n                         \"        return NULL;\\n\"\n                         \"    }\\n\");\n         if (DH_get_length(dh) > 0)\n             BIO_printf(out,\n                         \"    if (!DH_set_length(dh, %ld)) {\\n\"\n                         \"        DH_free(dh);\\n\"\n+                        \"        return NULL;\\n\"\n                         \"    }\\n\", DH_get_length(dh));\n         BIO_printf(out, \"    return dh;\\n}\\n\");\n         OPENSSL_free(data);\n@@ -355,10 +347,11 @@ int dhparam_main(int argc, char **argv)\n                 i = i2d_DHxparams_bio(out, dh);\n             else\n                 i = i2d_DHparams_bio(out, dh);\n-        } else if (q != NULL)\n+        } else if (q != NULL) {\n             i = PEM_write_bio_DHxparams(out, dh);\n-        else\n+        } else {\n             i = PEM_write_bio_DHparams(out, dh);\n+        }\n         if (!i) {\n             BIO_printf(bio_err, \"unable to write DH parameters\\n\");\n             ERR_print_errors(bio_err);\n@@ -371,21 +364,14 @@ int dhparam_main(int argc, char **argv)\n     BIO_free_all(out);\n     DH_free(dh);\n     release_engine(e);\n-    return (ret);\n+    return ret;\n }\n \n static int dh_cb(int p, int n, BN_GENCB *cb)\n {\n-    char c = '*';\n-\n-    if (p == 0)\n-        c = '.';\n-    if (p == 1)\n-        c = '+';\n-    if (p == 2)\n-        c = '*';\n-    if (p == 3)\n-        c = '\\n';\n+    static const char symbols[] = \".+*\\n\";\n+    char c = (p >= 0 && (size_t)p < sizeof(symbols) - 1) ? symbols[p] : '?';\n+\n     BIO_write(BN_GENCB_get_arg(cb), &c, 1);\n     (void)BIO_flush(BN_GENCB_get_arg(cb));\n     return 1;"
        },
        {
            "sha": "6022e64cd4cebecbb710f4dbaa85e0e6a235ddca",
            "filename": "deps/openssl/openssl/apps/dsa.c",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdsa.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdsa.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdsa.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -17,6 +17,7 @@ NON_EMPTY_TRANSLATION_UNIT\n # include <string.h>\n # include <time.h>\n # include \"apps.h\"\n+# include \"progs.h\"\n # include <openssl/bio.h>\n # include <openssl/err.h>\n # include <openssl/dsa.h>\n@@ -34,7 +35,7 @@ typedef enum OPTION_choice {\n     OPT_PUBOUT, OPT_CIPHER, OPT_PASSIN, OPT_PASSOUT\n } OPTION_CHOICE;\n \n-OPTIONS dsa_options[] = {\n+const OPTIONS dsa_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"inform\", OPT_INFORM, 'f', \"Input format, DER PEM PVK\"},\n     {\"outform\", OPT_OUTFORM, 'f', \"Output format, DER PEM PVK\"},\n@@ -161,7 +162,7 @@ int dsa_main(int argc, char **argv)\n         else\n             pkey = load_key(infile, informat, 1, passin, e, \"Private Key\");\n \n-        if (pkey) {\n+        if (pkey != NULL) {\n             dsa = EVP_PKEY_get1_DSA(pkey);\n             EVP_PKEY_free(pkey);\n         }\n@@ -199,16 +200,16 @@ int dsa_main(int argc, char **argv)\n     }\n     BIO_printf(bio_err, \"writing DSA key\\n\");\n     if (outformat == FORMAT_ASN1) {\n-        if (pubin || pubout)\n+        if (pubin || pubout) {\n             i = i2d_DSA_PUBKEY_bio(out, dsa);\n-        else {\n+        } else {\n             assert(private);\n             i = i2d_DSAPrivateKey_bio(out, dsa);\n         }\n     } else if (outformat == FORMAT_PEM) {\n-        if (pubin || pubout)\n+        if (pubin || pubout) {\n             i = PEM_write_bio_DSA_PUBKEY(out, dsa);\n-        else {\n+        } else {\n             assert(private);\n             i = PEM_write_bio_DSAPrivateKey(out, dsa, enc,\n                                             NULL, 0, NULL, passout);\n@@ -235,10 +236,9 @@ int dsa_main(int argc, char **argv)\n #  else\n             i = i2b_PVK_bio(out, pk, pvk_encr, 0, passout);\n #  endif\n-        }\n-        else if (pubin || pubout)\n+        } else if (pubin || pubout) {\n             i = i2b_PublicKey_bio(out, pk);\n-        else {\n+        } else {\n             assert(private);\n             i = i2b_PrivateKey_bio(out, pk);\n         }\n@@ -260,6 +260,6 @@ int dsa_main(int argc, char **argv)\n     release_engine(e);\n     OPENSSL_free(passin);\n     OPENSSL_free(passout);\n-    return (ret);\n+    return ret;\n }\n #endif"
        },
        {
            "sha": "b227b76a372362d1b7ebce98d5ed2c888a939923",
            "filename": "deps/openssl/openssl/apps/dsaparam.c",
            "status": "modified",
            "additions": 22,
            "deletions": 83,
            "changes": 105,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdsaparam.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdsaparam.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fdsaparam.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -17,34 +17,23 @@ NON_EMPTY_TRANSLATION_UNIT\n # include <time.h>\n # include <string.h>\n # include \"apps.h\"\n+# include \"progs.h\"\n # include <openssl/bio.h>\n # include <openssl/err.h>\n # include <openssl/bn.h>\n # include <openssl/dsa.h>\n # include <openssl/x509.h>\n # include <openssl/pem.h>\n \n-# ifdef GENCB_TEST\n-\n-static int stop_keygen_flag = 0;\n-\n-static void timebomb_sigalarm(int foo)\n-{\n-    stop_keygen_flag = 1;\n-}\n-\n-# endif\n-\n static int dsa_cb(int p, int n, BN_GENCB *cb);\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_INFORM, OPT_OUTFORM, OPT_IN, OPT_OUT, OPT_TEXT, OPT_C,\n-    OPT_NOOUT, OPT_GENKEY, OPT_RAND, OPT_ENGINE,\n-    OPT_TIMEBOMB\n+    OPT_NOOUT, OPT_GENKEY, OPT_ENGINE, OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS dsaparam_options[] = {\n+const OPTIONS dsaparam_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"inform\", OPT_INFORM, 'F', \"Input format - DER or PEM\"},\n     {\"in\", OPT_IN, '<', \"Input file\"},\n@@ -54,10 +43,7 @@ OPTIONS dsaparam_options[] = {\n     {\"C\", OPT_C, '-', \"Output C code\"},\n     {\"noout\", OPT_NOOUT, '-', \"No output\"},\n     {\"genkey\", OPT_GENKEY, '-', \"Generate a DSA key\"},\n-    {\"rand\", OPT_RAND, 's', \"Files to use for random number input\"},\n-# ifdef GENCB_TEST\n-    {\"timebomb\", OPT_TIMEBOMB, 'p', \"Interrupt keygen after 'pnum' seconds\"},\n-# endif\n+    OPT_R_OPTIONS,\n # ifndef OPENSSL_NO_ENGINE\n     {\"engine\", OPT_ENGINE, 's', \"Use engine e, possibly a hardware device\"},\n # endif\n@@ -70,13 +56,10 @@ int dsaparam_main(int argc, char **argv)\n     DSA *dsa = NULL;\n     BIO *in = NULL, *out = NULL;\n     BN_GENCB *cb = NULL;\n-    int numbits = -1, num = 0, genkey = 0, need_rand = 0;\n+    int numbits = -1, num = 0, genkey = 0;\n     int informat = FORMAT_PEM, outformat = FORMAT_PEM, noout = 0, C = 0;\n     int ret = 1, i, text = 0, private = 0;\n-# ifdef GENCB_TEST\n-    int timebomb = 0;\n-# endif\n-    char *infile = NULL, *outfile = NULL, *prog, *inrand = NULL;\n+    char *infile = NULL, *outfile = NULL, *prog;\n     OPTION_CHOICE o;\n \n     prog = opt_init(argc, argv, dsaparam_options);\n@@ -108,23 +91,18 @@ int dsaparam_main(int argc, char **argv)\n         case OPT_ENGINE:\n             e = setup_engine(opt_arg(), 0);\n             break;\n-        case OPT_TIMEBOMB:\n-# ifdef GENCB_TEST\n-            timebomb = atoi(opt_arg());\n-            break;\n-# endif\n         case OPT_TEXT:\n             text = 1;\n             break;\n         case OPT_C:\n             C = 1;\n             break;\n         case OPT_GENKEY:\n-            genkey = need_rand = 1;\n+            genkey = 1;\n             break;\n-        case OPT_RAND:\n-            inrand = opt_arg();\n-            need_rand = 1;\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n             break;\n         case OPT_NOOUT:\n             noout = 1;\n@@ -139,7 +117,6 @@ int dsaparam_main(int argc, char **argv)\n             goto end;\n         /* generate a key */\n         numbits = num;\n-        need_rand = 1;\n     }\n     private = genkey ? 1 : 0;\n \n@@ -150,21 +127,19 @@ int dsaparam_main(int argc, char **argv)\n     if (out == NULL)\n         goto end;\n \n-    if (need_rand) {\n-        app_RAND_load_file(NULL, (inrand != NULL));\n-        if (inrand != NULL)\n-            BIO_printf(bio_err, \"%ld semi-random bytes loaded\\n\",\n-                       app_RAND_load_files(inrand));\n-    }\n-\n     if (numbits > 0) {\n+        if (numbits > OPENSSL_DSA_MAX_MODULUS_BITS)\n+            BIO_printf(bio_err,\n+                       \"Warning: It is not recommended to use more than %d bit for DSA keys.\\n\"\n+                       \"         Your key size is %d! Larger key size may behave not as expected.\\n\",\n+                       OPENSSL_DSA_MAX_MODULUS_BITS, numbits);\n+\n         cb = BN_GENCB_new();\n         if (cb == NULL) {\n             BIO_printf(bio_err, \"Error allocating BN_GENCB object\\n\");\n             goto end;\n         }\n         BN_GENCB_set(cb, dsa_cb, bio_err);\n-        assert(need_rand);\n         dsa = DSA_new();\n         if (dsa == NULL) {\n             BIO_printf(bio_err, \"Error allocating DSA object\\n\");\n@@ -173,38 +148,16 @@ int dsaparam_main(int argc, char **argv)\n         BIO_printf(bio_err, \"Generating DSA parameters, %d bit long prime\\n\",\n                    num);\n         BIO_printf(bio_err, \"This could take some time\\n\");\n-# ifdef GENCB_TEST\n-        if (timebomb > 0) {\n-            struct sigaction act;\n-            act.sa_handler = timebomb_sigalarm;\n-            act.sa_flags = 0;\n-            BIO_printf(bio_err,\n-                       \"(though I'll stop it if not done within %d secs)\\n\",\n-                       timebomb);\n-            if (sigaction(SIGALRM, &act, NULL) != 0) {\n-                BIO_printf(bio_err, \"Error, couldn't set SIGALRM handler\\n\");\n-                goto end;\n-            }\n-            alarm(timebomb);\n-        }\n-# endif\n         if (!DSA_generate_parameters_ex(dsa, num, NULL, 0, NULL, NULL, cb)) {\n-# ifdef GENCB_TEST\n-            if (stop_keygen_flag) {\n-                BIO_printf(bio_err, \"DSA key generation time-stopped\\n\");\n-                /* This is an asked-for behaviour! */\n-                ret = 0;\n-                goto end;\n-            }\n-# endif\n             ERR_print_errors(bio_err);\n             BIO_printf(bio_err, \"Error, DSA key generation failed\\n\");\n             goto end;\n         }\n-    } else if (informat == FORMAT_ASN1)\n+    } else if (informat == FORMAT_ASN1) {\n         dsa = d2i_DSAparams_bio(in, NULL);\n-    else\n+    } else {\n         dsa = PEM_read_bio_DSAparams(in, NULL, NULL, NULL);\n+    }\n     if (dsa == NULL) {\n         BIO_printf(bio_err, \"unable to load DSA parameters\\n\");\n         ERR_print_errors(bio_err);\n@@ -268,7 +221,6 @@ int dsaparam_main(int argc, char **argv)\n     if (genkey) {\n         DSA *dsakey;\n \n-        assert(need_rand);\n         if ((dsakey = DSAparams_dup(dsa)) == NULL)\n             goto end;\n         if (!DSA_generate_key(dsakey)) {\n@@ -284,36 +236,23 @@ int dsaparam_main(int argc, char **argv)\n                                             NULL);\n         DSA_free(dsakey);\n     }\n-    if (need_rand)\n-        app_RAND_write_file(NULL);\n     ret = 0;\n  end:\n     BN_GENCB_free(cb);\n     BIO_free(in);\n     BIO_free_all(out);\n     DSA_free(dsa);\n     release_engine(e);\n-    return (ret);\n+    return ret;\n }\n \n static int dsa_cb(int p, int n, BN_GENCB *cb)\n {\n-    char c = '*';\n+    static const char symbols[] = \".+*\\n\";\n+    char c = (p >= 0 && (size_t)p < sizeof(symbols) - 1) ? symbols[p] : '?';\n \n-    if (p == 0)\n-        c = '.';\n-    if (p == 1)\n-        c = '+';\n-    if (p == 2)\n-        c = '*';\n-    if (p == 3)\n-        c = '\\n';\n     BIO_write(BN_GENCB_get_arg(cb), &c, 1);\n     (void)BIO_flush(BN_GENCB_get_arg(cb));\n-# ifdef GENCB_TEST\n-    if (stop_keygen_flag)\n-        return 0;\n-# endif\n     return 1;\n }\n #endif"
        },
        {
            "sha": "03abb00683373b8ea0565af9412d1ed332508e40",
            "filename": "deps/openssl/openssl/apps/ec.c",
            "status": "modified",
            "additions": 13,
            "deletions": 11,
            "changes": 24,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fec.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fec.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fec.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 2002-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 2002-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -16,6 +16,7 @@ NON_EMPTY_TRANSLATION_UNIT\n # include <stdlib.h>\n # include <string.h>\n # include \"apps.h\"\n+# include \"progs.h\"\n # include <openssl/bio.h>\n # include <openssl/err.h>\n # include <openssl/evp.h>\n@@ -42,7 +43,7 @@ typedef enum OPTION_choice {\n     OPT_NO_PUBLIC, OPT_CHECK\n } OPTION_CHOICE;\n \n-OPTIONS ec_options[] = {\n+const OPTIONS ec_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"in\", OPT_IN, 's', \"Input file\"},\n     {\"inform\", OPT_INFORM, 'f', \"Input format - DER or PEM\"},\n@@ -185,7 +186,7 @@ int ec_main(int argc, char **argv)\n     } else if (informat == FORMAT_ENGINE) {\n         EVP_PKEY *pkey;\n         if (pubin)\n-            pkey = load_pubkey(infile, informat , 1, passin, e, \"Public Key\");\n+            pkey = load_pubkey(infile, informat, 1, passin, e, \"Public Key\");\n         else\n             pkey = load_key(infile, informat, 1, passin, e, \"Private Key\");\n         if (pkey != NULL) {\n@@ -244,20 +245,20 @@ int ec_main(int argc, char **argv)\n \n     BIO_printf(bio_err, \"writing EC key\\n\");\n     if (outformat == FORMAT_ASN1) {\n-        if (param_out)\n+        if (param_out) {\n             i = i2d_ECPKParameters_bio(out, group);\n-        else if (pubin || pubout)\n+        } else if (pubin || pubout) {\n             i = i2d_EC_PUBKEY_bio(out, eckey);\n-        else {\n+        } else {\n             assert(private);\n             i = i2d_ECPrivateKey_bio(out, eckey);\n         }\n     } else {\n-        if (param_out)\n+        if (param_out) {\n             i = PEM_write_bio_ECPKParameters(out, group);\n-        else if (pubin || pubout)\n+        } else if (pubin || pubout) {\n             i = PEM_write_bio_EC_PUBKEY(out, eckey);\n-        else {\n+        } else {\n             assert(private);\n             i = PEM_write_bio_ECPrivateKey(out, eckey, enc,\n                                            NULL, 0, NULL, passout);\n@@ -267,15 +268,16 @@ int ec_main(int argc, char **argv)\n     if (!i) {\n         BIO_printf(bio_err, \"unable to write private key\\n\");\n         ERR_print_errors(bio_err);\n-    } else\n+    } else {\n         ret = 0;\n+    }\n  end:\n     BIO_free(in);\n     BIO_free_all(out);\n     EC_KEY_free(eckey);\n     release_engine(e);\n     OPENSSL_free(passin);\n     OPENSSL_free(passout);\n-    return (ret);\n+    return ret;\n }\n #endif"
        },
        {
            "sha": "917f1a86b2e36c238afe631bc24f8b681037a902",
            "filename": "deps/openssl/openssl/apps/ecparam.c",
            "status": "modified",
            "additions": 19,
            "deletions": 40,
            "changes": 59,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fecparam.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fecparam.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fecparam.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,26 +1,13 @@\n /*\n  * Copyright 2002-2018 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright (c) 2002, Oracle and/or its affiliates. All rights reserved\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n  * in the file LICENSE in the source distribution or at\n  * https://www.openssl.org/source/license.html\n  */\n \n-/* ====================================================================\n- * Copyright 2002 Sun Microsystems, Inc. ALL RIGHTS RESERVED.\n- *\n- * Portions of the attached software (\"Contribution\") are developed by\n- * SUN MICROSYSTEMS, INC., and are contributed to the OpenSSL project.\n- *\n- * The Contribution is licensed pursuant to the OpenSSL open source\n- * license provided above.\n- *\n- * The elliptic curve binary polynomial software is originally written by\n- * Sheueling Chang Shantz and Douglas Stebila of Sun Microsystems Laboratories.\n- *\n- */\n-\n #include <openssl/opensslconf.h>\n #ifdef OPENSSL_NO_EC\n NON_EMPTY_TRANSLATION_UNIT\n@@ -31,6 +18,7 @@ NON_EMPTY_TRANSLATION_UNIT\n # include <time.h>\n # include <string.h>\n # include \"apps.h\"\n+# include \"progs.h\"\n # include <openssl/bio.h>\n # include <openssl/err.h>\n # include <openssl/bn.h>\n@@ -42,10 +30,11 @@ typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_INFORM, OPT_OUTFORM, OPT_IN, OPT_OUT, OPT_TEXT, OPT_C,\n     OPT_CHECK, OPT_LIST_CURVES, OPT_NO_SEED, OPT_NOOUT, OPT_NAME,\n-    OPT_CONV_FORM, OPT_PARAM_ENC, OPT_GENKEY, OPT_RAND, OPT_ENGINE\n+    OPT_CONV_FORM, OPT_PARAM_ENC, OPT_GENKEY, OPT_ENGINE,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS ecparam_options[] = {\n+const OPTIONS ecparam_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"inform\", OPT_INFORM, 'F', \"Input format - default PEM (DER or PEM)\"},\n     {\"outform\", OPT_OUTFORM, 'F', \"Output format - default PEM\"},\n@@ -65,7 +54,7 @@ OPTIONS ecparam_options[] = {\n     {\"param_enc\", OPT_PARAM_ENC, 's',\n      \"Specifies the way the ec parameters are encoded\"},\n     {\"genkey\", OPT_GENKEY, '-', \"Generate ec key\"},\n-    {\"rand\", OPT_RAND, 's', \"Files to use for random number input\"},\n+    OPT_R_OPTIONS,\n # ifndef OPENSSL_NO_ENGINE\n     {\"engine\", OPT_ENGINE, 's', \"Use engine, possibly a hardware device\"},\n # endif\n@@ -93,15 +82,15 @@ int ecparam_main(int argc, char **argv)\n     BIO *in = NULL, *out = NULL;\n     EC_GROUP *group = NULL;\n     point_conversion_form_t form = POINT_CONVERSION_UNCOMPRESSED;\n-    char *curve_name = NULL, *inrand = NULL;\n+    char *curve_name = NULL;\n     char *infile = NULL, *outfile = NULL, *prog;\n     unsigned char *buffer = NULL;\n     OPTION_CHOICE o;\n     int asn1_flag = OPENSSL_EC_NAMED_CURVE, new_asn1_flag = 0;\n     int informat = FORMAT_PEM, outformat = FORMAT_PEM, noout = 0, C = 0;\n     int ret = 1, private = 0;\n     int list_curves = 0, no_seed = 0, check = 0, new_form = 0;\n-    int text = 0, i, need_rand = 0, genkey = 0;\n+    int text = 0, i, genkey = 0;\n \n     prog = opt_init(argc, argv, ecparam_options);\n     while ((o = opt_next()) != OPT_EOF) {\n@@ -162,11 +151,11 @@ int ecparam_main(int argc, char **argv)\n             new_asn1_flag = 1;\n             break;\n         case OPT_GENKEY:\n-            genkey = need_rand = 1;\n+            genkey = 1;\n             break;\n-        case OPT_RAND:\n-            inrand = opt_arg();\n-            need_rand = 1;\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n             break;\n         case OPT_ENGINE:\n             e = setup_engine(opt_arg(), 0);\n@@ -232,8 +221,9 @@ int ecparam_main(int argc, char **argv)\n             BIO_printf(bio_err, \"using curve name prime256v1 \"\n                        \"instead of secp256r1\\n\");\n             nid = NID_X9_62_prime256v1;\n-        } else\n+        } else {\n             nid = OBJ_sn2nid(curve_name);\n+        }\n \n         if (nid == 0)\n             nid = EC_curve_nist2nid(curve_name);\n@@ -250,10 +240,11 @@ int ecparam_main(int argc, char **argv)\n         }\n         EC_GROUP_set_asn1_flag(group, asn1_flag);\n         EC_GROUP_set_point_conversion_form(group, form);\n-    } else if (informat == FORMAT_ASN1)\n+    } else if (informat == FORMAT_ASN1) {\n         group = d2i_ECPKParameters_bio(in, NULL);\n-    else\n+    } else {\n         group = PEM_read_bio_ECPKParameters(in, NULL, NULL, NULL);\n+    }\n     if (group == NULL) {\n         BIO_printf(bio_err, \"unable to load elliptic curve parameters\\n\");\n         ERR_print_errors(bio_err);\n@@ -308,7 +299,7 @@ int ecparam_main(int argc, char **argv)\n             goto end;\n         }\n \n-        if (!EC_GROUP_get_curve_GFp(group, ec_p, ec_a, ec_b, NULL))\n+        if (!EC_GROUP_get_curve(group, ec_p, ec_a, ec_b, NULL))\n             goto end;\n \n         if ((point = EC_GROUP_get0_generator(group)) == NULL)\n@@ -409,21 +400,12 @@ int ecparam_main(int argc, char **argv)\n         }\n     }\n \n-    if (need_rand) {\n-        app_RAND_load_file(NULL, (inrand != NULL));\n-        if (inrand != NULL)\n-            BIO_printf(bio_err, \"%ld semi-random bytes loaded\\n\",\n-                       app_RAND_load_files(inrand));\n-    }\n-\n     if (genkey) {\n         EC_KEY *eckey = EC_KEY_new();\n \n         if (eckey == NULL)\n             goto end;\n \n-        assert(need_rand);\n-\n         if (EC_KEY_set_group(eckey, group) == 0) {\n             BIO_printf(bio_err, \"unable to set group when generating key\\n\");\n             EC_KEY_free(eckey);\n@@ -449,9 +431,6 @@ int ecparam_main(int argc, char **argv)\n         EC_KEY_free(eckey);\n     }\n \n-    if (need_rand)\n-        app_RAND_write_file(NULL);\n-\n     ret = 0;\n  end:\n     BN_free(ec_p);\n@@ -465,7 +444,7 @@ int ecparam_main(int argc, char **argv)\n     release_engine(e);\n     BIO_free(in);\n     BIO_free_all(out);\n-    return (ret);\n+    return ret;\n }\n \n #endif"
        },
        {
            "sha": "8e5a57d3e5d74d72410a68cef3445641aad48191",
            "filename": "deps/openssl/openssl/apps/enc.c",
            "status": "modified",
            "additions": 93,
            "deletions": 41,
            "changes": 134,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fenc.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fenc.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fenc.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -12,6 +12,7 @@\n #include <string.h>\n #include <limits.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/bio.h>\n #include <openssl/err.h>\n #include <openssl/evp.h>\n@@ -29,7 +30,7 @@\n #define SIZE    (512)\n #define BSIZE   (8*1024)\n \n-static int set_hex(char *in, unsigned char *out, int size);\n+static int set_hex(const char *in, unsigned char *out, int size);\n static void show_ciphers(const OBJ_NAME *name, void *bio_);\n \n struct doall_enc_ciphers {\n@@ -43,10 +44,11 @@ typedef enum OPTION_choice {\n     OPT_E, OPT_IN, OPT_OUT, OPT_PASS, OPT_ENGINE, OPT_D, OPT_P, OPT_V,\n     OPT_NOPAD, OPT_SALT, OPT_NOSALT, OPT_DEBUG, OPT_UPPER_P, OPT_UPPER_A,\n     OPT_A, OPT_Z, OPT_BUFSIZE, OPT_K, OPT_KFILE, OPT_UPPER_K, OPT_NONE,\n-    OPT_UPPER_S, OPT_IV, OPT_MD, OPT_CIPHER\n+    OPT_UPPER_S, OPT_IV, OPT_MD, OPT_ITER, OPT_PBKDF2, OPT_CIPHER,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS enc_options[] = {\n+const OPTIONS enc_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"ciphers\", OPT_LIST, '-', \"List ciphers\"},\n     {\"in\", OPT_IN, '<', \"Input file\"},\n@@ -72,8 +74,11 @@ OPTIONS enc_options[] = {\n     {\"S\", OPT_UPPER_S, 's', \"Salt, in hex\"},\n     {\"iv\", OPT_IV, 's', \"IV in hex\"},\n     {\"md\", OPT_MD, 's', \"Use specified digest to create a key from the passphrase\"},\n+    {\"iter\", OPT_ITER, 'p', \"Specify the iteration count and force use of PBKDF2\"},\n+    {\"pbkdf2\", OPT_PBKDF2, '-', \"Use password-based key derivation function 2\"},\n     {\"none\", OPT_NONE, '-', \"Don't encrypt\"},\n     {\"\", OPT_CIPHER, '-', \"Any supported cipher\"},\n+    OPT_R_OPTIONS,\n #ifdef ZLIB\n     {\"z\", OPT_Z, '-', \"Use zlib as the 'encryption'\"},\n #endif\n@@ -104,6 +109,8 @@ int enc_main(int argc, char **argv)\n     int ret = 1, inl, nopad = 0;\n     unsigned char key[EVP_MAX_KEY_LENGTH], iv[EVP_MAX_IV_LENGTH];\n     unsigned char *buff = NULL, salt[PKCS5_SALT_LEN];\n+    int pbkdf2 = 0;\n+    int iter = 0;\n     long n;\n     struct doall_enc_ciphers dec;\n #ifdef ZLIB\n@@ -113,13 +120,13 @@ int enc_main(int argc, char **argv)\n \n     /* first check the program name */\n     prog = opt_progname(argv[0]);\n-    if (strcmp(prog, \"base64\") == 0)\n+    if (strcmp(prog, \"base64\") == 0) {\n         base64 = 1;\n #ifdef ZLIB\n-    else if (strcmp(prog, \"zlib\") == 0)\n+    } else if (strcmp(prog, \"zlib\") == 0) {\n         do_zlib = 1;\n #endif\n-    else {\n+    } else {\n         cipher = EVP_get_cipherbyname(prog);\n         if (cipher == NULL && strcmp(prog, \"enc\") != 0) {\n             BIO_printf(bio_err, \"%s is not a known cipher\\n\", prog);\n@@ -252,9 +259,23 @@ int enc_main(int argc, char **argv)\n                 goto opthelp;\n             cipher = c;\n             break;\n+        case OPT_ITER:\n+            if (!opt_int(opt_arg(), &iter))\n+                goto opthelp;\n+            pbkdf2 = 1;\n+            break;\n+        case OPT_PBKDF2:\n+            pbkdf2 = 1;\n+            if (iter == 0)    /* do not overwrite a chosen value */\n+                iter = 10000;\n+            break;\n         case OPT_NONE:\n             cipher = NULL;\n             break;\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n+            break;\n         }\n     }\n     if (opt_num_rest() != 0) {\n@@ -275,6 +296,9 @@ int enc_main(int argc, char **argv)\n     if (dgst == NULL)\n         dgst = EVP_sha256();\n \n+    if (iter == 0)\n+        iter = 1;\n+\n     /* It must be large enough for a base64 encoded line */\n     if (base64 && bsize < 80)\n         bsize = 80;\n@@ -296,12 +320,13 @@ int enc_main(int argc, char **argv)\n \n     if (infile == NULL) {\n         in = dup_bio_in(informat);\n-    } else\n+    } else {\n         in = bio_open_default(infile, 'r', informat);\n+    }\n     if (in == NULL)\n         goto end;\n \n-    if (!str && passarg) {\n+    if (str == NULL && passarg != NULL) {\n         if (!app_passwd(passarg, NULL, &pass, NULL)) {\n             BIO_printf(bio_err, \"Error getting password\\n\");\n             goto end;\n@@ -311,13 +336,13 @@ int enc_main(int argc, char **argv)\n \n     if ((str == NULL) && (cipher != NULL) && (hkey == NULL)) {\n         if (1) {\n-#ifndef OPENSSL_NO_UI\n+#ifndef OPENSSL_NO_UI_CONSOLE\n             for (;;) {\n                 char prompt[200];\n \n                 BIO_snprintf(prompt, sizeof(prompt), \"enter %s %s password:\",\n-                             OBJ_nid2ln(EVP_CIPHER_nid(cipher)),\n-                             (enc) ? \"encryption\" : \"decryption\");\n+                        OBJ_nid2ln(EVP_CIPHER_nid(cipher)),\n+                        (enc) ? \"encryption\" : \"decryption\");\n                 strbuf[0] = '\\0';\n                 i = EVP_read_pw_string((char *)strbuf, SIZE, prompt, enc);\n                 if (i == 0) {\n@@ -397,17 +422,18 @@ int enc_main(int argc, char **argv)\n             unsigned char *sptr;\n             size_t str_len = strlen(str);\n \n-            if (nosalt)\n+            if (nosalt) {\n                 sptr = NULL;\n-            else {\n+            } else {\n                 if (enc) {\n                     if (hsalt) {\n                         if (!set_hex(hsalt, salt, sizeof(salt))) {\n                             BIO_printf(bio_err, \"invalid hex salt value\\n\");\n                             goto end;\n                         }\n-                    } else if (RAND_bytes(salt, sizeof(salt)) <= 0)\n+                    } else if (RAND_bytes(salt, sizeof(salt)) <= 0) {\n                         goto end;\n+                    }\n                     /*\n                      * If -P option then don't bother writing\n                      */\n@@ -430,19 +456,41 @@ int enc_main(int argc, char **argv)\n                     BIO_printf(bio_err, \"bad magic number\\n\");\n                     goto end;\n                 }\n-\n                 sptr = salt;\n             }\n \n-            if (!EVP_BytesToKey(cipher, dgst, sptr,\n-                                (unsigned char *)str,\n-                                str_len, 1, key, iv)) {\n-                BIO_printf(bio_err, \"EVP_BytesToKey failed\\n\");\n-                goto end;\n+            if (pbkdf2 == 1) {\n+                /*\n+                * derive key and default iv\n+                * concatenated into a temporary buffer\n+                */\n+                unsigned char tmpkeyiv[EVP_MAX_KEY_LENGTH + EVP_MAX_IV_LENGTH];\n+                int iklen = EVP_CIPHER_key_length(cipher);\n+                int ivlen = EVP_CIPHER_iv_length(cipher);\n+                /* not needed if HASH_UPDATE() is fixed : */\n+                int islen = (sptr != NULL ? sizeof(salt) : 0);\n+                if (!PKCS5_PBKDF2_HMAC(str, str_len, sptr, islen,\n+                                       iter, dgst, iklen+ivlen, tmpkeyiv)) {\n+                    BIO_printf(bio_err, \"PKCS5_PBKDF2_HMAC failed\\n\");\n+                    goto end;\n+                }\n+                /* split and move data back to global buffer */\n+                memcpy(key, tmpkeyiv, iklen);\n+                memcpy(iv, tmpkeyiv+iklen, ivlen);\n+            } else {\n+                BIO_printf(bio_err, \"*** WARNING : \"\n+                                    \"deprecated key derivation used.\\n\"\n+                                    \"Using -iter or -pbkdf2 would be better.\\n\");\n+                if (!EVP_BytesToKey(cipher, dgst, sptr,\n+                                    (unsigned char *)str, str_len,\n+                                    1, key, iv)) {\n+                    BIO_printf(bio_err, \"EVP_BytesToKey failed\\n\");\n+                    goto end;\n+                }\n             }\n             /*\n              * zero the complete buffer or the string passed from the command\n-             * line bug picked up by Larry J. Hughes Jr. <hughes@indiana.edu>\n+             * line.\n              */\n             if (str == strbuf)\n                 OPENSSL_cleanse(str, SIZE);\n@@ -453,24 +501,27 @@ int enc_main(int argc, char **argv)\n             int siz = EVP_CIPHER_iv_length(cipher);\n             if (siz == 0) {\n                 BIO_printf(bio_err, \"warning: iv not use by this cipher\\n\");\n-            } else if (!set_hex(hiv, iv, sizeof(iv))) {\n+            } else if (!set_hex(hiv, iv, siz)) {\n                 BIO_printf(bio_err, \"invalid hex iv value\\n\");\n                 goto end;\n             }\n         }\n         if ((hiv == NULL) && (str == NULL)\n             && EVP_CIPHER_iv_length(cipher) != 0) {\n             /*\n-             * No IV was explicitly set and no IV was generated during\n-             * EVP_BytesToKey. Hence the IV is undefined, making correct\n-             * decryption impossible.\n+             * No IV was explicitly set and no IV was generated.\n+             * Hence the IV is undefined, making correct decryption impossible.\n              */\n             BIO_printf(bio_err, \"iv undefined\\n\");\n             goto end;\n         }\n-        if ((hkey != NULL) && !set_hex(hkey, key, EVP_CIPHER_key_length(cipher))) {\n-            BIO_printf(bio_err, \"invalid hex key value\\n\");\n-            goto end;\n+        if (hkey != NULL) {\n+            if (!set_hex(hkey, key, EVP_CIPHER_key_length(cipher))) {\n+                BIO_printf(bio_err, \"invalid hex key value\\n\");\n+                goto end;\n+            }\n+            /* wiping secret data as we no longer need it */\n+            OPENSSL_cleanse(hkey, strlen(hkey));\n         }\n \n         if ((benc = BIO_new(BIO_f_cipher())) == NULL)\n@@ -551,8 +602,8 @@ int enc_main(int argc, char **argv)\n \n     ret = 0;\n     if (verbose) {\n-        BIO_printf(bio_err, \"bytes read   :%8\"BIO_PRI64\"u\\n\", BIO_number_read(in));\n-        BIO_printf(bio_err, \"bytes written:%8\"BIO_PRI64\"u\\n\", BIO_number_written(out));\n+        BIO_printf(bio_err, \"bytes read   : %8ju\\n\", BIO_number_read(in));\n+        BIO_printf(bio_err, \"bytes written: %8ju\\n\", BIO_number_written(out));\n     }\n  end:\n     ERR_print_errors(bio_err);\n@@ -567,7 +618,7 @@ int enc_main(int argc, char **argv)\n #endif\n     release_engine(e);\n     OPENSSL_free(pass);\n-    return (ret);\n+    return ret;\n }\n \n static void show_ciphers(const OBJ_NAME *name, void *arg)\n@@ -593,31 +644,32 @@ static void show_ciphers(const OBJ_NAME *name, void *arg)\n         BIO_printf(dec->bio, \" \");\n }\n \n-static int set_hex(char *in, unsigned char *out, int size)\n+static int set_hex(const char *in, unsigned char *out, int size)\n {\n     int i, n;\n     unsigned char j;\n \n+    i = size * 2;\n     n = strlen(in);\n-    if (n > (size * 2)) {\n-        BIO_printf(bio_err, \"hex string is too long\\n\");\n-        return (0);\n+    if (n > i) {\n+        BIO_printf(bio_err, \"hex string is too long, ignoring excess\\n\");\n+        n = i; /* ignore exceeding part */\n+    } else if (n < i) {\n+        BIO_printf(bio_err, \"hex string is too short, padding with zero bytes to length\\n\");\n     }\n+\n     memset(out, 0, size);\n     for (i = 0; i < n; i++) {\n-        j = (unsigned char)*in;\n-        *(in++) = '\\0';\n-        if (j == 0)\n-            break;\n+        j = (unsigned char)*in++;\n         if (!isxdigit(j)) {\n             BIO_printf(bio_err, \"non-hex digit\\n\");\n-            return (0);\n+            return 0;\n         }\n         j = (unsigned char)OPENSSL_hexchar2int(j);\n         if (i & 1)\n             out[i / 2] |= j;\n         else\n             out[i / 2] = (j << 4);\n     }\n-    return (1);\n+    return 1;\n }"
        },
        {
            "sha": "83f9588a0ab19fca3c45269e8f5e9af766ea20a1",
            "filename": "deps/openssl/openssl/apps/engine.c",
            "status": "modified",
            "additions": 71,
            "deletions": 28,
            "changes": 99,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fengine.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fengine.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fengine.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 2000-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 2000-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -13,20 +13,22 @@ NON_EMPTY_TRANSLATION_UNIT\n #else\n \n # include \"apps.h\"\n+# include \"progs.h\"\n # include <stdio.h>\n # include <stdlib.h>\n # include <string.h>\n # include <openssl/err.h>\n # include <openssl/engine.h>\n # include <openssl/ssl.h>\n+# include <openssl/store.h>\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_C, OPT_T, OPT_TT, OPT_PRE, OPT_POST,\n     OPT_V = 100, OPT_VV, OPT_VVV, OPT_VVVV\n } OPTION_CHOICE;\n \n-OPTIONS engine_options[] = {\n+const OPTIONS engine_options[] = {\n     {OPT_HELP_STR, 1, '-', \"Usage: %s [options] engine...\\n\"},\n     {OPT_HELP_STR, 1, '-',\n         \"  engine... Engines to load\\n\"},\n@@ -47,28 +49,38 @@ OPTIONS engine_options[] = {\n \n static int append_buf(char **buf, int *size, const char *s)\n {\n-    if (*buf == NULL) {\n-        *size = 256;\n-        *buf = app_malloc(*size, \"engine buffer\");\n-        **buf = '\\0';\n-    }\n+    const int expand = 256;\n+    int len = strlen(s) + 1;\n+    char *p = *buf;\n+\n+    if (p == NULL) {\n+        *size = ((len + expand - 1) / expand) * expand;\n+        p = *buf = app_malloc(*size, \"engine buffer\");\n+    } else {\n+        const int blen = strlen(p);\n+\n+        if (blen > 0)\n+            len += 2 + blen;\n \n-    if (strlen(*buf) + strlen(s) >= (unsigned int)*size) {\n-        char *tmp;\n-        *size += 256;\n-        tmp = OPENSSL_realloc(*buf, *size);\n-        if (tmp == NULL) {\n-            OPENSSL_free(*buf);\n-            *buf = NULL;\n-            return 0;\n+        if (len > *size) {\n+            *size = ((len + expand - 1) / expand) * expand;\n+            p = OPENSSL_realloc(p, *size);\n+            if (p == NULL) {\n+                OPENSSL_free(*buf);\n+                *buf = NULL;\n+                return 0;\n+            }\n+            *buf = p;\n         }\n-        *buf = tmp;\n-    }\n \n-    if (**buf != '\\0')\n-        OPENSSL_strlcat(*buf, \", \", *size);\n-    OPENSSL_strlcat(*buf, s, *size);\n+        if (blen > 0) {\n+            p += blen;\n+            *p++ = ',';\n+            *p++ = ' ';\n+        }\n+    }\n \n+    strcpy(p, s);\n     return 1;\n }\n \n@@ -147,7 +159,7 @@ static int util_verbose(ENGINE *e, int verbose, BIO *out, const char *indent)\n     }\n \n     cmds = sk_OPENSSL_STRING_new_null();\n-    if (!cmds)\n+    if (cmds == NULL)\n         goto err;\n \n     do {\n@@ -249,15 +261,34 @@ static void util_do_cmds(ENGINE *e, STACK_OF(OPENSSL_STRING) *cmds,\n             if (!ENGINE_ctrl_cmd_string(e, buf, arg, 0))\n                 res = 0;\n         }\n-        if (res)\n+        if (res) {\n             BIO_printf(out, \"[Success]: %s\\n\", cmd);\n-        else {\n+        } else {\n             BIO_printf(out, \"[Failure]: %s\\n\", cmd);\n             ERR_print_errors(out);\n         }\n     }\n }\n \n+struct util_store_cap_data {\n+    ENGINE *engine;\n+    char **cap_buf;\n+    int *cap_size;\n+    int ok;\n+};\n+static void util_store_cap(const OSSL_STORE_LOADER *loader, void *arg)\n+{\n+    struct util_store_cap_data *ctx = arg;\n+\n+    if (OSSL_STORE_LOADER_get0_engine(loader) == ctx->engine) {\n+        char buf[256];\n+        BIO_snprintf(buf, sizeof(buf), \"STORE(%s)\",\n+                     OSSL_STORE_LOADER_get0_scheme(loader));\n+        if (!append_buf(ctx->cap_buf, ctx->cap_size, buf))\n+            ctx->ok = 0;\n+    }\n+}\n+\n int engine_main(int argc, char **argv)\n {\n     int ret = 1, i;\n@@ -380,7 +411,7 @@ int engine_main(int argc, char **argv)\n                     goto end;\n \n                 fn_c = ENGINE_get_ciphers(e);\n-                if (!fn_c)\n+                if (fn_c == NULL)\n                     goto skip_ciphers;\n                 n = fn_c(e, NULL, &nids, 0);\n                 for (k = 0; k < n; ++k)\n@@ -389,7 +420,7 @@ int engine_main(int argc, char **argv)\n \n  skip_ciphers:\n                 fn_d = ENGINE_get_digests(e);\n-                if (!fn_d)\n+                if (fn_d == NULL)\n                     goto skip_digests;\n                 n = fn_d(e, NULL, &nids, 0);\n                 for (k = 0; k < n; ++k)\n@@ -398,14 +429,26 @@ int engine_main(int argc, char **argv)\n \n  skip_digests:\n                 fn_pk = ENGINE_get_pkey_meths(e);\n-                if (!fn_pk)\n+                if (fn_pk == NULL)\n                     goto skip_pmeths;\n                 n = fn_pk(e, NULL, &nids, 0);\n                 for (k = 0; k < n; ++k)\n                     if (!append_buf(&cap_buf, &cap_size, OBJ_nid2sn(nids[k])))\n                         goto end;\n  skip_pmeths:\n-                if (cap_buf && (*cap_buf != '\\0'))\n+                {\n+                    struct util_store_cap_data store_ctx;\n+\n+                    store_ctx.engine = e;\n+                    store_ctx.cap_buf = &cap_buf;\n+                    store_ctx.cap_size = &cap_size;\n+                    store_ctx.ok = 1;\n+\n+                    OSSL_STORE_do_all_loaders(util_store_cap, &store_ctx);\n+                    if (!store_ctx.ok)\n+                        goto end;\n+                }\n+                if (cap_buf != NULL && (*cap_buf != '\\0'))\n                     BIO_printf(out, \" [%s]\\n\", cap_buf);\n \n                 OPENSSL_free(cap_buf);\n@@ -441,6 +484,6 @@ int engine_main(int argc, char **argv)\n     sk_OPENSSL_STRING_free(pre_cmds);\n     sk_OPENSSL_STRING_free(post_cmds);\n     BIO_free_all(out);\n-    return (ret);\n+    return ret;\n }\n #endif"
        },
        {
            "sha": "3ef01f076a8c322e6deb9b124359a99532c41086",
            "filename": "deps/openssl/openssl/apps/errstr.c",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Ferrstr.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Ferrstr.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Ferrstr.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -11,16 +11,16 @@\n #include <stdlib.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/bio.h>\n-#include <openssl/lhash.h>\n #include <openssl/err.h>\n #include <openssl/ssl.h>\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP\n } OPTION_CHOICE;\n \n-OPTIONS errstr_options[] = {\n+const OPTIONS errstr_options[] = {\n     {OPT_HELP_STR, 1, '-', \"Usage: %s [options] errnum...\\n\"},\n     {OPT_HELP_STR, 1, '-', \"  errnum  Error number\\n\"},\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n@@ -50,9 +50,9 @@ int errstr_main(int argc, char **argv)\n \n     ret = 0;\n     for (argv = opt_rest(); *argv; argv++) {\n-        if (sscanf(*argv, \"%lx\", &l) == 0)\n+        if (sscanf(*argv, \"%lx\", &l) == 0) {\n             ret++;\n-        else {\n+        } else {\n             /* We're not really an SSL application so this won't auto-init, but\n              * we're still interested in SSL error strings\n              */\n@@ -63,5 +63,5 @@ int errstr_main(int argc, char **argv)\n         }\n     }\n  end:\n-    return (ret);\n+    return ret;\n }"
        },
        {
            "sha": "401375420bffada2387947cd1f6025a9854996e1",
            "filename": "deps/openssl/openssl/apps/gendsa.c",
            "status": "modified",
            "additions": 17,
            "deletions": 18,
            "changes": 35,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fgendsa.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fgendsa.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fgendsa.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -17,6 +17,7 @@ NON_EMPTY_TRANSLATION_UNIT\n # include <sys/types.h>\n # include <sys/stat.h>\n # include \"apps.h\"\n+# include \"progs.h\"\n # include <openssl/bio.h>\n # include <openssl/err.h>\n # include <openssl/bn.h>\n@@ -26,17 +27,17 @@ NON_EMPTY_TRANSLATION_UNIT\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n-    OPT_OUT, OPT_PASSOUT, OPT_ENGINE, OPT_RAND, OPT_CIPHER\n+    OPT_OUT, OPT_PASSOUT, OPT_ENGINE, OPT_CIPHER,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS gendsa_options[] = {\n+const OPTIONS gendsa_options[] = {\n     {OPT_HELP_STR, 1, '-', \"Usage: %s [args] dsaparam-file\\n\"},\n     {OPT_HELP_STR, 1, '-', \"Valid options are:\\n\"},\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"out\", OPT_OUT, '>', \"Output the key to the specified file\"},\n     {\"passout\", OPT_PASSOUT, 's', \"Output file pass phrase source\"},\n-    {\"rand\", OPT_RAND, 's',\n-     \"Load the file(s) into the random number generator\"},\n+    OPT_R_OPTIONS,\n     {\"\", OPT_CIPHER, '-', \"Encrypt the output with any supported cipher\"},\n # ifndef OPENSSL_NO_ENGINE\n     {\"engine\", OPT_ENGINE, 's', \"Use engine, possibly a hardware device\"},\n@@ -50,7 +51,7 @@ int gendsa_main(int argc, char **argv)\n     BIO *out = NULL, *in = NULL;\n     DSA *dsa = NULL;\n     const EVP_CIPHER *enc = NULL;\n-    char *inrand = NULL, *dsaparams = NULL;\n+    char *dsaparams = NULL;\n     char *outfile = NULL, *passoutarg = NULL, *passout = NULL, *prog;\n     OPTION_CHOICE o;\n     int ret = 1, private = 0;\n@@ -77,8 +78,9 @@ int gendsa_main(int argc, char **argv)\n         case OPT_ENGINE:\n             e = setup_engine(opt_arg(), 0);\n             break;\n-        case OPT_RAND:\n-            inrand = opt_arg();\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n             break;\n         case OPT_CIPHER:\n             if (!opt_cipher(opt_unknown(), &enc))\n@@ -114,21 +116,18 @@ int gendsa_main(int argc, char **argv)\n     if (out == NULL)\n         goto end2;\n \n-    if (!app_RAND_load_file(NULL, 1) && inrand == NULL) {\n+    DSA_get0_pqg(dsa, &p, NULL, NULL);\n+\n+    if (BN_num_bits(p) > OPENSSL_DSA_MAX_MODULUS_BITS)\n         BIO_printf(bio_err,\n-                   \"warning, not much extra random data, consider using the -rand option\\n\");\n-    }\n-    if (inrand != NULL)\n-        BIO_printf(bio_err, \"%ld semi-random bytes loaded\\n\",\n-                   app_RAND_load_files(inrand));\n+                   \"Warning: It is not recommended to use more than %d bit for DSA keys.\\n\"\n+                   \"         Your key size is %d! Larger key size may behave not as expected.\\n\",\n+                   OPENSSL_DSA_MAX_MODULUS_BITS, BN_num_bits(p));\n \n-    DSA_get0_pqg(dsa, &p, NULL, NULL);\n     BIO_printf(bio_err, \"Generating DSA key, %d bits\\n\", BN_num_bits(p));\n     if (!DSA_generate_key(dsa))\n         goto end;\n \n-    app_RAND_write_file(NULL);\n-\n     assert(private);\n     if (!PEM_write_bio_DSAPrivateKey(out, dsa, enc, NULL, 0, NULL, passout))\n         goto end;\n@@ -142,6 +141,6 @@ int gendsa_main(int argc, char **argv)\n     DSA_free(dsa);\n     release_engine(e);\n     OPENSSL_free(passout);\n-    return (ret);\n+    return ret;\n }\n #endif"
        },
        {
            "sha": "39fa73c91cf4ddc418260b7dd3b0392365666d24",
            "filename": "deps/openssl/openssl/apps/genpkey.c",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fgenpkey.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fgenpkey.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fgenpkey.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 2006-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 2006-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -10,6 +10,7 @@\n #include <stdio.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/pem.h>\n #include <openssl/err.h>\n #include <openssl/evp.h>\n@@ -26,7 +27,7 @@ typedef enum OPTION_choice {\n     OPT_ALGORITHM, OPT_PKEYOPT, OPT_GENPARAM, OPT_TEXT, OPT_CIPHER\n } OPTION_CHOICE;\n \n-OPTIONS genpkey_options[] = {\n+const OPTIONS genpkey_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"out\", OPT_OUT, '>', \"Output file\"},\n     {\"outform\", OPT_OUTFORM, 'F', \"output format (DER or PEM)\"},\n@@ -119,6 +120,13 @@ int genpkey_main(int argc, char **argv)\n             if (!opt_cipher(opt_unknown(), &cipher)\n                 || do_param == 1)\n                 goto opthelp;\n+            if (EVP_CIPHER_mode(cipher) == EVP_CIPH_GCM_MODE ||\n+                EVP_CIPHER_mode(cipher) == EVP_CIPH_CCM_MODE ||\n+                EVP_CIPHER_mode(cipher) == EVP_CIPH_XTS_MODE ||\n+                EVP_CIPHER_mode(cipher) == EVP_CIPH_OCB_MODE) {\n+                BIO_printf(bio_err, \"%s: cipher mode not supported\\n\", prog);\n+                goto end;\n+            }\n         }\n     }\n     argc = opt_num_rest();\n@@ -156,9 +164,9 @@ int genpkey_main(int argc, char **argv)\n         }\n     }\n \n-    if (do_param)\n+    if (do_param) {\n         rv = PEM_write_bio_Parameters(out, pkey);\n-    else if (outformat == FORMAT_PEM) {\n+    } else if (outformat == FORMAT_PEM) {\n         assert(private);\n         rv = PEM_write_bio_PrivateKey(out, pkey, cipher, NULL, 0, NULL, pass);\n     } else if (outformat == FORMAT_ASN1) {"
        },
        {
            "sha": "c17cd147154eea5c78915b0bb1ee8552d1026abd",
            "filename": "deps/openssl/openssl/apps/genrsa.c",
            "status": "modified",
            "additions": 27,
            "deletions": 24,
            "changes": 51,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fgenrsa.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fgenrsa.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fgenrsa.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -17,6 +17,7 @@ NON_EMPTY_TRANSLATION_UNIT\n # include <sys/types.h>\n # include <sys/stat.h>\n # include \"apps.h\"\n+# include \"progs.h\"\n # include <openssl/bio.h>\n # include <openssl/err.h>\n # include <openssl/bn.h>\n@@ -27,28 +28,30 @@ NON_EMPTY_TRANSLATION_UNIT\n # include <openssl/rand.h>\n \n # define DEFBITS 2048\n+# define DEFPRIMES 2\n \n static int genrsa_cb(int p, int n, BN_GENCB *cb);\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_3, OPT_F4, OPT_ENGINE,\n-    OPT_OUT, OPT_RAND, OPT_PASSOUT, OPT_CIPHER\n+    OPT_OUT, OPT_PASSOUT, OPT_CIPHER, OPT_PRIMES,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS genrsa_options[] = {\n+const OPTIONS genrsa_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"3\", OPT_3, '-', \"Use 3 for the E value\"},\n     {\"F4\", OPT_F4, '-', \"Use F4 (0x10001) for the E value\"},\n     {\"f4\", OPT_F4, '-', \"Use F4 (0x10001) for the E value\"},\n-    {\"out\", OPT_OUT, 's', \"Output the key to specified file\"},\n-    {\"rand\", OPT_RAND, 's',\n-     \"Load the file(s) into the random number generator\"},\n+    {\"out\", OPT_OUT, '>', \"Output the key to specified file\"},\n+    OPT_R_OPTIONS,\n     {\"passout\", OPT_PASSOUT, 's', \"Output file pass phrase source\"},\n     {\"\", OPT_CIPHER, '-', \"Encrypt the output with any supported cipher\"},\n # ifndef OPENSSL_NO_ENGINE\n     {\"engine\", OPT_ENGINE, 's', \"Use engine, possibly a hardware device\"},\n # endif\n+    {\"primes\", OPT_PRIMES, 'p', \"Specify number of primes\"},\n     {NULL}\n };\n \n@@ -62,10 +65,10 @@ int genrsa_main(int argc, char **argv)\n     const BIGNUM *e;\n     RSA *rsa = NULL;\n     const EVP_CIPHER *enc = NULL;\n-    int ret = 1, num = DEFBITS, private = 0;\n+    int ret = 1, num = DEFBITS, private = 0, primes = DEFPRIMES;\n     unsigned long f4 = RSA_F4;\n     char *outfile = NULL, *passoutarg = NULL, *passout = NULL;\n-    char *inrand = NULL, *prog, *hexe, *dece;\n+    char *prog, *hexe, *dece;\n     OPTION_CHOICE o;\n \n     if (bn == NULL || cb == NULL)\n@@ -97,8 +100,9 @@ int genrsa_main(int argc, char **argv)\n         case OPT_ENGINE:\n             eng = setup_engine(opt_arg(), 0);\n             break;\n-        case OPT_RAND:\n-            inrand = opt_arg();\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n             break;\n         case OPT_PASSOUT:\n             passoutarg = opt_arg();\n@@ -107,6 +111,10 @@ int genrsa_main(int argc, char **argv)\n             if (!opt_cipher(opt_unknown(), &enc))\n                 goto end;\n             break;\n+        case OPT_PRIMES:\n+            if (!opt_int(opt_arg(), &primes))\n+                goto end;\n+            break;\n         }\n     }\n     argc = opt_num_rest();\n@@ -115,6 +123,11 @@ int genrsa_main(int argc, char **argv)\n     if (argc == 1) {\n         if (!opt_int(argv[0], &num) || num <= 0)\n             goto end;\n+        if (num > OPENSSL_RSA_MAX_MODULUS_BITS)\n+            BIO_printf(bio_err,\n+                       \"Warning: It is not recommended to use more than %d bit for RSA keys.\\n\"\n+                       \"         Your key size is %d! Larger key size may behave not as expected.\\n\",\n+                       OPENSSL_RSA_MAX_MODULUS_BITS, num);\n     } else if (argc > 0) {\n         BIO_printf(bio_err, \"Extra arguments given.\\n\");\n         goto opthelp;\n@@ -130,26 +143,16 @@ int genrsa_main(int argc, char **argv)\n     if (out == NULL)\n         goto end;\n \n-    if (!app_RAND_load_file(NULL, 1) && inrand == NULL\n-        && !RAND_status()) {\n-        BIO_printf(bio_err,\n-                   \"warning, not much extra random data, consider using the -rand option\\n\");\n-    }\n-    if (inrand != NULL)\n-        BIO_printf(bio_err, \"%ld semi-random bytes loaded\\n\",\n-                   app_RAND_load_files(inrand));\n-\n-    BIO_printf(bio_err, \"Generating RSA private key, %d bit long modulus\\n\",\n-               num);\n+    BIO_printf(bio_err, \"Generating RSA private key, %d bit long modulus (%d primes)\\n\",\n+               num, primes);\n     rsa = eng ? RSA_new_method(eng) : RSA_new();\n     if (rsa == NULL)\n         goto end;\n \n-    if (!BN_set_word(bn, f4) || !RSA_generate_key_ex(rsa, num, bn, cb))\n+    if (!BN_set_word(bn, f4)\n+        || !RSA_generate_multi_prime_key(rsa, num, primes, bn, cb))\n         goto end;\n \n-    app_RAND_write_file(NULL);\n-\n     RSA_get0_key(rsa, NULL, &e, NULL);\n     hexe = BN_bn2hex(e);\n     dece = BN_bn2dec(e);\n@@ -176,7 +179,7 @@ int genrsa_main(int argc, char **argv)\n     OPENSSL_free(passout);\n     if (ret != 0)\n         ERR_print_errors(bio_err);\n-    return (ret);\n+    return ret;\n }\n \n static int genrsa_cb(int p, int n, BN_GENCB *cb)"
        },
        {
            "sha": "a067c915926f2f427ffb9876b53c670a9e9cb9ae",
            "filename": "deps/openssl/openssl/apps/nseq.c",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fnseq.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fnseq.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fnseq.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1999-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1999-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -10,6 +10,7 @@\n #include <stdio.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/pem.h>\n #include <openssl/err.h>\n \n@@ -18,7 +19,7 @@ typedef enum OPTION_choice {\n     OPT_TOSEQ, OPT_IN, OPT_OUT\n } OPTION_CHOICE;\n \n-OPTIONS nseq_options[] = {\n+const OPTIONS nseq_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"toseq\", OPT_TOSEQ, '-', \"Output NS Sequence file\"},\n     {\"in\", OPT_IN, '<', \"Input file\"},\n@@ -109,5 +110,5 @@ int nseq_main(int argc, char **argv)\n     BIO_free_all(out);\n     NETSCAPE_CERT_SEQUENCE_free(seq);\n \n-    return (ret);\n+    return ret;\n }"
        },
        {
            "sha": "7fd78624bbcca18c614c5a7cf6f7eaa93ee233cb",
            "filename": "deps/openssl/openssl/apps/ocsp.c",
            "status": "modified",
            "additions": 453,
            "deletions": 149,
            "changes": 602,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Focsp.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Focsp.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Focsp.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -17,8 +17,6 @@ NON_EMPTY_TRANSLATION_UNIT\n                                  * on OpenVMS */\n # endif\n \n-# define USE_SOCKETS\n-\n # include <stdio.h>\n # include <stdlib.h>\n # include <string.h>\n@@ -27,27 +25,32 @@ NON_EMPTY_TRANSLATION_UNIT\n \n /* Needs to be included before the openssl headers */\n # include \"apps.h\"\n+# include \"progs.h\"\n+# include \"internal/sockets.h\"\n # include <openssl/e_os2.h>\n # include <openssl/crypto.h>\n # include <openssl/err.h>\n # include <openssl/ssl.h>\n # include <openssl/evp.h>\n # include <openssl/bn.h>\n # include <openssl/x509v3.h>\n-\n-# if defined(NETWARE_CLIB)\n-#  ifdef NETWARE_BSDSOCK\n-#   include <sys/socket.h>\n-#   include <sys/bsdskt.h>\n-#  else\n-#   include <novsock2.h>\n-#  endif\n-# elif defined(NETWARE_LIBC)\n-#  ifdef NETWARE_BSDSOCK\n-#   include <sys/select.h>\n-#  else\n-#   include <novsock2.h>\n-#  endif\n+# include <openssl/rand.h>\n+\n+# if defined(OPENSSL_SYS_UNIX) && !defined(OPENSSL_NO_SOCK) \\\n+     && !defined(OPENSSL_NO_POSIX_IO)\n+#  define OCSP_DAEMON\n+#  include <sys/types.h>\n+#  include <sys/wait.h>\n+#  include <syslog.h>\n+#  include <signal.h>\n+#  define MAXERRLEN 1000 /* limit error text sent to syslog to 1000 bytes */\n+# else\n+#  undef LOG_INFO\n+#  undef LOG_WARNING\n+#  undef LOG_ERR\n+#  define LOG_INFO      0\n+#  define LOG_WARNING   1\n+#  define LOG_ERR       2\n # endif\n \n /* Maximum leeway in validity period: default 5 minutes */\n@@ -63,16 +66,28 @@ static void print_ocsp_summary(BIO *out, OCSP_BASICRESP *bs, OCSP_REQUEST *req,\n                               STACK_OF(OPENSSL_STRING) *names,\n                               STACK_OF(OCSP_CERTID) *ids, long nsec,\n                               long maxage);\n-static void make_ocsp_response(OCSP_RESPONSE **resp, OCSP_REQUEST *req,\n-                              CA_DB *db, X509 *ca, X509 *rcert,\n+static void make_ocsp_response(BIO *err, OCSP_RESPONSE **resp, OCSP_REQUEST *req,\n+                              CA_DB *db, STACK_OF(X509) *ca, X509 *rcert,\n                               EVP_PKEY *rkey, const EVP_MD *md,\n+                              STACK_OF(OPENSSL_STRING) *sigopts,\n                               STACK_OF(X509) *rother, unsigned long flags,\n                               int nmin, int ndays, int badsig);\n \n static char **lookup_serial(CA_DB *db, ASN1_INTEGER *ser);\n static BIO *init_responder(const char *port);\n-static int do_responder(OCSP_REQUEST **preq, BIO **pcbio, BIO *acbio);\n+static int do_responder(OCSP_REQUEST **preq, BIO **pcbio, BIO *acbio, int timeout);\n static int send_ocsp_response(BIO *cbio, OCSP_RESPONSE *resp);\n+static void log_message(int level, const char *fmt, ...);\n+static char *prog;\n+static int multi = 0;\n+\n+# ifdef OCSP_DAEMON\n+static int acfd = (int) INVALID_SOCKET;\n+static int index_changed(CA_DB *);\n+static void spawn_loop(void);\n+static int print_syslog(const char *str, size_t len, void *levPtr);\n+static void sock_timeout(int signum);\n+# endif\n \n # ifndef OPENSSL_NO_SOCK\n static OCSP_RESPONSE *query_responder(BIO *cbio, const char *host,\n@@ -94,12 +109,13 @@ typedef enum OPTION_choice {\n     OPT_VALIDITY_PERIOD, OPT_STATUS_AGE, OPT_SIGNKEY, OPT_REQOUT,\n     OPT_RESPOUT, OPT_PATH, OPT_ISSUER, OPT_CERT, OPT_SERIAL,\n     OPT_INDEX, OPT_CA, OPT_NMIN, OPT_REQUEST, OPT_NDAYS, OPT_RSIGNER,\n-    OPT_RKEY, OPT_ROTHER, OPT_RMD, OPT_HEADER,\n+    OPT_RKEY, OPT_ROTHER, OPT_RMD, OPT_RSIGOPT, OPT_HEADER,\n     OPT_V_ENUM,\n-    OPT_MD\n+    OPT_MD,\n+    OPT_MULTI\n } OPTION_CHOICE;\n \n-OPTIONS ocsp_options[] = {\n+const OPTIONS ocsp_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"out\", OPT_OUTFILE, '>', \"Output filename\"},\n     {\"timeout\", OPT_TIMEOUT, 'p',\n@@ -108,14 +124,17 @@ OPTIONS ocsp_options[] = {\n     {\"host\", OPT_HOST, 's', \"TCP/IP hostname:port to connect to\"},\n     {\"port\", OPT_PORT, 'p', \"Port to run responder on\"},\n     {\"ignore_err\", OPT_IGNORE_ERR, '-',\n-     \"Ignore Error response from OCSP responder, and retry \"},\n+     \"Ignore error on OCSP request or response and continue running\"},\n     {\"noverify\", OPT_NOVERIFY, '-', \"Don't verify response at all\"},\n     {\"nonce\", OPT_NONCE, '-', \"Add OCSP nonce to request\"},\n     {\"no_nonce\", OPT_NO_NONCE, '-', \"Don't add OCSP nonce to request\"},\n     {\"resp_no_certs\", OPT_RESP_NO_CERTS, '-',\n      \"Don't include any certificates in response\"},\n     {\"resp_key_id\", OPT_RESP_KEY_ID, '-',\n      \"Identify response by signing certificate key ID\"},\n+# ifdef OCSP_DAEMON\n+    {\"multi\", OPT_MULTI, 'p', \"run multiple responder processes\"},\n+# endif\n     {\"no_certs\", OPT_NO_CERTS, '-',\n      \"Don't include any certificates in signed request\"},\n     {\"no_signature_verify\", OPT_NO_SIGNATURE_VERIFY, '-',\n@@ -171,6 +190,7 @@ OPTIONS ocsp_options[] = {\n     {\"rkey\", OPT_RKEY, '<', \"Responder key to sign responses with\"},\n     {\"rother\", OPT_ROTHER, '<', \"Other certificates to include in response\"},\n     {\"rmd\", OPT_RMD, 's', \"Digest Algorithm to use in signature of OCSP response\"},\n+    {\"rsigopt\", OPT_RSIGOPT, 's', \"OCSP response signature parameter in n:v form\"},\n     {\"header\", OPT_HEADER, 's', \"key=value header to add\"},\n     {\"\", OPT_MD, '-', \"Any supported digest algorithm (sha1,sha256, ... )\"},\n     OPT_V_OPTIONS,\n@@ -181,6 +201,7 @@ int ocsp_main(int argc, char **argv)\n {\n     BIO *acbio = NULL, *cbio = NULL, *derbio = NULL, *out = NULL;\n     const EVP_MD *cert_id_md = NULL, *rsign_md = NULL;\n+    STACK_OF(OPENSSL_STRING) *rsign_sigopts = NULL;\n     int trailing_md = 0;\n     CA_DB *rdb = NULL;\n     EVP_PKEY *key = NULL, *rkey = NULL;\n@@ -192,7 +213,8 @@ int ocsp_main(int argc, char **argv)\n     STACK_OF(OPENSSL_STRING) *reqnames = NULL;\n     STACK_OF(X509) *sign_other = NULL, *verify_other = NULL, *rother = NULL;\n     STACK_OF(X509) *issuers = NULL;\n-    X509 *issuer = NULL, *cert = NULL, *rca_cert = NULL;\n+    X509 *issuer = NULL, *cert = NULL;\n+    STACK_OF(X509) *rca_cert = NULL;\n     X509 *signer = NULL, *rsigner = NULL;\n     X509_STORE *store = NULL;\n     X509_VERIFY_PARAM *vpm = NULL;\n@@ -209,19 +231,16 @@ int ocsp_main(int argc, char **argv)\n     int accept_count = -1, add_nonce = 1, noverify = 0, use_ssl = -1;\n     int vpmtouched = 0, badsig = 0, i, ignore_err = 0, nmin = 0, ndays = -1;\n     int req_text = 0, resp_text = 0, ret = 1;\n-#ifndef OPENSSL_NO_SOCK\n     int req_timeout = -1;\n-#endif\n     long nsec = MAX_VALIDITY_PERIOD, maxage = -1;\n     unsigned long sign_flags = 0, verify_flags = 0, rflags = 0;\n     OPTION_CHOICE o;\n-    char *prog;\n \n     reqnames = sk_OPENSSL_STRING_new_null();\n-    if (!reqnames)\n+    if (reqnames == NULL)\n         goto end;\n     ids = sk_OCSP_CERTID_new_null();\n-    if (!ids)\n+    if (ids == NULL)\n         goto end;\n     if ((vpm = X509_VERIFY_PARAM_new()) == NULL)\n         return 1;\n@@ -435,6 +454,12 @@ int ocsp_main(int argc, char **argv)\n             if (!opt_md(opt_arg(), &rsign_md))\n                 goto end;\n             break;\n+        case OPT_RSIGOPT:\n+            if (rsign_sigopts == NULL)\n+                rsign_sigopts = sk_OPENSSL_STRING_new_null();\n+            if (rsign_sigopts == NULL || !sk_OPENSSL_STRING_push(rsign_sigopts, opt_arg()))\n+                goto end;\n+            break;\n         case OPT_HEADER:\n             header = opt_arg();\n             value = strchr(header, '=');\n@@ -457,9 +482,13 @@ int ocsp_main(int argc, char **argv)\n                 goto opthelp;\n             trailing_md = 1;\n             break;\n+        case OPT_MULTI:\n+# ifdef OCSP_DAEMON\n+            multi = atoi(opt_arg());\n+# endif\n+            break;\n         }\n     }\n-\n     if (trailing_md) {\n         BIO_printf(bio_err, \"%s: Digest must be before -cert or -serial\\n\",\n                    prog);\n@@ -470,62 +499,105 @@ int ocsp_main(int argc, char **argv)\n         goto opthelp;\n \n     /* Have we anything to do? */\n-    if (!req && !reqin && !respin && !(port && ridx_filename))\n+    if (req == NULL && reqin == NULL\n+        && respin == NULL && !(port != NULL && ridx_filename != NULL))\n         goto opthelp;\n \n     out = bio_open_default(outfile, 'w', FORMAT_TEXT);\n     if (out == NULL)\n         goto end;\n \n-    if (!req && (add_nonce != 2))\n+    if (req == NULL && (add_nonce != 2))\n         add_nonce = 0;\n \n-    if (!req && reqin) {\n+    if (req == NULL && reqin != NULL) {\n         derbio = bio_open_default(reqin, 'r', FORMAT_ASN1);\n         if (derbio == NULL)\n             goto end;\n         req = d2i_OCSP_REQUEST_bio(derbio, NULL);\n         BIO_free(derbio);\n-        if (!req) {\n+        if (req == NULL) {\n             BIO_printf(bio_err, \"Error reading OCSP request\\n\");\n             goto end;\n         }\n     }\n \n-    if (!req && port) {\n+    if (req == NULL && port != NULL) {\n         acbio = init_responder(port);\n-        if (!acbio)\n+        if (acbio == NULL)\n             goto end;\n     }\n \n-    if (rsignfile) {\n-        if (!rkeyfile)\n+    if (rsignfile != NULL) {\n+        if (rkeyfile == NULL)\n             rkeyfile = rsignfile;\n         rsigner = load_cert(rsignfile, FORMAT_PEM, \"responder certificate\");\n-        if (!rsigner) {\n+        if (rsigner == NULL) {\n             BIO_printf(bio_err, \"Error loading responder certificate\\n\");\n             goto end;\n         }\n-        rca_cert = load_cert(rca_filename, FORMAT_PEM, \"CA certificate\");\n-        if (rcertfile) {\n+        if (!load_certs(rca_filename, &rca_cert, FORMAT_PEM,\n+                        NULL, \"CA certificate\"))\n+            goto end;\n+        if (rcertfile != NULL) {\n             if (!load_certs(rcertfile, &rother, FORMAT_PEM, NULL,\n                             \"responder other certificates\"))\n                 goto end;\n         }\n         rkey = load_key(rkeyfile, FORMAT_PEM, 0, NULL, NULL,\n                         \"responder private key\");\n-        if (!rkey)\n+        if (rkey == NULL)\n             goto end;\n     }\n-    if (acbio)\n-        BIO_printf(bio_err, \"Waiting for OCSP client connections...\\n\");\n \n- redo_accept:\n+    if (ridx_filename != NULL\n+        && (rkey == NULL || rsigner == NULL || rca_cert == NULL)) {\n+        BIO_printf(bio_err,\n+                   \"Responder mode requires certificate, key, and CA.\\n\");\n+        goto end;\n+    }\n \n-    if (acbio) {\n-        if (!do_responder(&req, &cbio, acbio))\n+    if (ridx_filename != NULL) {\n+        rdb = load_index(ridx_filename, NULL);\n+        if (rdb == NULL || index_index(rdb) <= 0) {\n+            ret = 1;\n             goto end;\n-        if (!req) {\n+        }\n+    }\n+\n+# ifdef OCSP_DAEMON\n+    if (multi && acbio != NULL)\n+        spawn_loop();\n+    if (acbio != NULL && req_timeout > 0)\n+        signal(SIGALRM, sock_timeout);\n+#endif\n+\n+    if (acbio != NULL)\n+        log_message(LOG_INFO, \"waiting for OCSP client connections...\");\n+\n+redo_accept:\n+\n+    if (acbio != NULL) {\n+# ifdef OCSP_DAEMON\n+        if (index_changed(rdb)) {\n+            CA_DB *newrdb = load_index(ridx_filename, NULL);\n+\n+            if (newrdb != NULL && index_index(newrdb) > 0) {\n+                free_index(rdb);\n+                rdb = newrdb;\n+            } else {\n+                free_index(newrdb);\n+                log_message(LOG_ERR, \"error reloading updated index: %s\",\n+                            ridx_filename);\n+            }\n+        }\n+# endif\n+\n+        req = NULL;\n+        if (!do_responder(&req, &cbio, acbio, req_timeout))\n+            goto redo_accept;\n+\n+        if (req == NULL) {\n             resp =\n                 OCSP_response_create(OCSP_RESPONSE_STATUS_MALFORMEDREQUEST,\n                                      NULL);\n@@ -534,30 +606,32 @@ int ocsp_main(int argc, char **argv)\n         }\n     }\n \n-    if (!req && (signfile || reqout || host || add_nonce || ridx_filename)) {\n+    if (req == NULL\n+        && (signfile != NULL || reqout != NULL\n+            || host != NULL || add_nonce || ridx_filename != NULL)) {\n         BIO_printf(bio_err, \"Need an OCSP request for this operation!\\n\");\n         goto end;\n     }\n \n-    if (req && add_nonce)\n+    if (req != NULL && add_nonce)\n         OCSP_request_add1_nonce(req, NULL, -1);\n \n-    if (signfile) {\n-        if (!keyfile)\n+    if (signfile != NULL) {\n+        if (keyfile == NULL)\n             keyfile = signfile;\n         signer = load_cert(signfile, FORMAT_PEM, \"signer certificate\");\n-        if (!signer) {\n+        if (signer == NULL) {\n             BIO_printf(bio_err, \"Error loading signer certificate\\n\");\n             goto end;\n         }\n-        if (sign_certfile) {\n+        if (sign_certfile != NULL) {\n             if (!load_certs(sign_certfile, &sign_other, FORMAT_PEM, NULL,\n                             \"signer certificates\"))\n                 goto end;\n         }\n         key = load_key(keyfile, FORMAT_PEM, 0, NULL, NULL,\n                        \"signer private key\");\n-        if (!key)\n+        if (key == NULL)\n             goto end;\n \n         if (!OCSP_request_sign\n@@ -567,54 +641,40 @@ int ocsp_main(int argc, char **argv)\n         }\n     }\n \n-    if (req_text && req)\n+    if (req_text && req != NULL)\n         OCSP_REQUEST_print(out, req, 0);\n \n-    if (reqout) {\n+    if (reqout != NULL) {\n         derbio = bio_open_default(reqout, 'w', FORMAT_ASN1);\n         if (derbio == NULL)\n             goto end;\n         i2d_OCSP_REQUEST_bio(derbio, req);\n         BIO_free(derbio);\n     }\n \n-    if (ridx_filename && (!rkey || !rsigner || !rca_cert)) {\n-        BIO_printf(bio_err,\n-                   \"Need a responder certificate, key and CA for this operation!\\n\");\n-        goto end;\n-    }\n-\n-    if (ridx_filename && !rdb) {\n-        rdb = load_index(ridx_filename, NULL);\n-        if (!rdb)\n-            goto end;\n-        if (!index_index(rdb))\n-            goto end;\n-    }\n-\n-    if (rdb) {\n-        make_ocsp_response(&resp, req, rdb, rca_cert, rsigner, rkey,\n-                               rsign_md, rother, rflags, nmin, ndays, badsig);\n-        if (cbio)\n+    if (rdb != NULL) {\n+        make_ocsp_response(bio_err, &resp, req, rdb, rca_cert, rsigner, rkey,\n+                               rsign_md, rsign_sigopts, rother, rflags, nmin, ndays, badsig);\n+        if (cbio != NULL)\n             send_ocsp_response(cbio, resp);\n-    } else if (host) {\n+    } else if (host != NULL) {\n # ifndef OPENSSL_NO_SOCK\n         resp = process_responder(req, host, path,\n                                  port, use_ssl, headers, req_timeout);\n-        if (!resp)\n+        if (resp == NULL)\n             goto end;\n # else\n         BIO_printf(bio_err,\n                    \"Error creating connect BIO - sockets not supported.\\n\");\n         goto end;\n # endif\n-    } else if (respin) {\n+    } else if (respin != NULL) {\n         derbio = bio_open_default(respin, 'r', FORMAT_ASN1);\n         if (derbio == NULL)\n             goto end;\n         resp = d2i_OCSP_RESPONSE_bio(derbio, NULL);\n         BIO_free(derbio);\n-        if (!resp) {\n+        if (resp == NULL) {\n             BIO_printf(bio_err, \"Error reading OCSP response\\n\");\n             goto end;\n         }\n@@ -625,7 +685,7 @@ int ocsp_main(int argc, char **argv)\n \n  done_resp:\n \n-    if (respout) {\n+    if (respout != NULL) {\n         derbio = bio_open_default(respout, 'w', FORMAT_ASN1);\n         if (derbio == NULL)\n             goto end;\n@@ -637,16 +697,15 @@ int ocsp_main(int argc, char **argv)\n     if (i != OCSP_RESPONSE_STATUS_SUCCESSFUL) {\n         BIO_printf(out, \"Responder Error: %s (%d)\\n\",\n                    OCSP_response_status_str(i), i);\n-        if (ignore_err)\n-            goto redo_accept;\n-        goto end;\n+        if (!ignore_err)\n+                goto end;\n     }\n \n     if (resp_text)\n         OCSP_RESPONSE_print(out, resp, 0);\n \n     /* If running as responder don't verify our own response */\n-    if (cbio) {\n+    if (cbio != NULL) {\n         /* If not unlimited, see if we took all we should. */\n         if (accept_count != -1 && --accept_count <= 0) {\n             ret = 0;\n@@ -660,34 +719,34 @@ int ocsp_main(int argc, char **argv)\n         resp = NULL;\n         goto redo_accept;\n     }\n-    if (ridx_filename) {\n+    if (ridx_filename != NULL) {\n         ret = 0;\n         goto end;\n     }\n \n-    if (!store) {\n+    if (store == NULL) {\n         store = setup_verify(CAfile, CApath, noCAfile, noCApath);\n         if (!store)\n             goto end;\n     }\n     if (vpmtouched)\n         X509_STORE_set1_param(store, vpm);\n-    if (verify_certfile) {\n+    if (verify_certfile != NULL) {\n         if (!load_certs(verify_certfile, &verify_other, FORMAT_PEM, NULL,\n                         \"validator certificate\"))\n             goto end;\n     }\n \n     bs = OCSP_response_get1_basic(resp);\n-    if (!bs) {\n+    if (bs == NULL) {\n         BIO_printf(bio_err, \"Error parsing response\\n\");\n         goto end;\n     }\n \n     ret = 0;\n \n     if (!noverify) {\n-        if (req && ((i = OCSP_check_nonce(req, bs)) <= 0)) {\n+        if (req != NULL && ((i = OCSP_check_nonce(req, bs)) <= 0)) {\n             if (i == -1)\n                 BIO_printf(bio_err, \"WARNING: no nonce in response\\n\");\n             else {\n@@ -707,9 +766,9 @@ int ocsp_main(int argc, char **argv)\n             BIO_printf(bio_err, \"Response Verify Failure\\n\");\n             ERR_print_errors(bio_err);\n             ret = 1;\n-        } else\n+        } else {\n             BIO_printf(bio_err, \"Response verify OK\\n\");\n-\n+        }\n     }\n \n     print_ocsp_summary(out, bs, req, reqnames, ids, nsec, maxage);\n@@ -719,16 +778,17 @@ int ocsp_main(int argc, char **argv)\n     X509_free(signer);\n     X509_STORE_free(store);\n     X509_VERIFY_PARAM_free(vpm);\n+    sk_OPENSSL_STRING_free(rsign_sigopts);\n     EVP_PKEY_free(key);\n     EVP_PKEY_free(rkey);\n     X509_free(cert);\n     sk_X509_pop_free(issuers, X509_free);\n     X509_free(rsigner);\n-    X509_free(rca_cert);\n+    sk_X509_pop_free(rca_cert, X509_free);\n     free_index(rdb);\n     BIO_free_all(cbio);\n     BIO_free_all(acbio);\n-    BIO_free(out);\n+    BIO_free_all(out);\n     OCSP_REQUEST_free(req);\n     OCSP_RESPONSE_free(resp);\n     OCSP_BASICRESP_free(bs);\n@@ -741,15 +801,195 @@ int ocsp_main(int argc, char **argv)\n     OPENSSL_free(tport);\n     OPENSSL_free(tpath);\n \n-    return (ret);\n+    return ret;\n+}\n+\n+static void\n+log_message(int level, const char *fmt, ...)\n+{\n+    va_list ap;\n+\n+    va_start(ap, fmt);\n+# ifdef OCSP_DAEMON\n+    if (multi) {\n+        char buf[1024];\n+        if (vsnprintf(buf, sizeof(buf), fmt, ap) > 0) {\n+            syslog(level, \"%s\", buf);\n+        }\n+        if (level >= LOG_ERR)\n+            ERR_print_errors_cb(print_syslog, &level);\n+    }\n+# endif\n+    if (!multi) {\n+        BIO_printf(bio_err, \"%s: \", prog);\n+        BIO_vprintf(bio_err, fmt, ap);\n+        BIO_printf(bio_err, \"\\n\");\n+    }\n+    va_end(ap);\n+}\n+\n+# ifdef OCSP_DAEMON\n+\n+static int print_syslog(const char *str, size_t len, void *levPtr)\n+{\n+    int level = *(int *)levPtr;\n+    int ilen = (len > MAXERRLEN) ? MAXERRLEN : len;\n+\n+    syslog(level, \"%.*s\", ilen, str);\n+\n+    return ilen;\n }\n \n+static int index_changed(CA_DB *rdb)\n+{\n+    struct stat sb;\n+\n+    if (rdb != NULL && stat(rdb->dbfname, &sb) != -1) {\n+        if (rdb->dbst.st_mtime != sb.st_mtime\n+            || rdb->dbst.st_ctime != sb.st_ctime\n+            || rdb->dbst.st_ino != sb.st_ino\n+            || rdb->dbst.st_dev != sb.st_dev) {\n+            syslog(LOG_INFO, \"index file changed, reloading\");\n+            return 1;\n+        }\n+    }\n+    return 0;\n+}\n+\n+static void killall(int ret, pid_t *kidpids)\n+{\n+    int i;\n+\n+    for (i = 0; i < multi; ++i)\n+        if (kidpids[i] != 0)\n+            (void)kill(kidpids[i], SIGTERM);\n+    sleep(1);\n+    exit(ret);\n+}\n+\n+static int termsig = 0;\n+\n+static void noteterm (int sig)\n+{\n+    termsig = sig;\n+}\n+\n+/*\n+ * Loop spawning up to `multi` child processes, only child processes return\n+ * from this function.  The parent process loops until receiving a termination\n+ * signal, kills extant children and exits without returning.\n+ */\n+static void spawn_loop(void)\n+{\n+    pid_t *kidpids = NULL;\n+    int status;\n+    int procs = 0;\n+    int i;\n+\n+    openlog(prog, LOG_PID, LOG_DAEMON);\n+\n+    if (setpgid(0, 0)) {\n+        syslog(LOG_ERR, \"fatal: error detaching from parent process group: %s\",\n+               strerror(errno));\n+        exit(1);\n+    }\n+    kidpids = app_malloc(multi * sizeof(*kidpids), \"child PID array\");\n+    for (i = 0; i < multi; ++i)\n+        kidpids[i] = 0;\n+\n+    signal(SIGINT, noteterm);\n+    signal(SIGTERM, noteterm);\n+\n+    while (termsig == 0) {\n+        pid_t fpid;\n+\n+        /*\n+         * Wait for a child to replace when we're at the limit.\n+         * Slow down if a child exited abnormally or waitpid() < 0\n+         */\n+        while (termsig == 0 && procs >= multi) {\n+            if ((fpid = waitpid(-1, &status, 0)) > 0) {\n+                for (i = 0; i < procs; ++i) {\n+                    if (kidpids[i] == fpid) {\n+                        kidpids[i] = 0;\n+                        --procs;\n+                        break;\n+                    }\n+                }\n+                if (i >= multi) {\n+                    syslog(LOG_ERR, \"fatal: internal error: \"\n+                           \"no matching child slot for pid: %ld\",\n+                           (long) fpid);\n+                    killall(1, kidpids);\n+                }\n+                if (status != 0) {\n+                    if (WIFEXITED(status))\n+                        syslog(LOG_WARNING, \"child process: %ld, exit status: %d\",\n+                               (long)fpid, WEXITSTATUS(status));\n+                    else if (WIFSIGNALED(status))\n+                        syslog(LOG_WARNING, \"child process: %ld, term signal %d%s\",\n+                               (long)fpid, WTERMSIG(status),\n+#ifdef WCOREDUMP\n+                               WCOREDUMP(status) ? \" (core dumped)\" :\n+#endif\n+                               \"\");\n+                    sleep(1);\n+                }\n+                break;\n+            } else if (errno != EINTR) {\n+                syslog(LOG_ERR, \"fatal: waitpid(): %s\", strerror(errno));\n+                killall(1, kidpids);\n+            }\n+        }\n+        if (termsig)\n+            break;\n+\n+        switch(fpid = fork()) {\n+        case -1:            /* error */\n+            /* System critically low on memory, pause and try again later */\n+            sleep(30);\n+            break;\n+        case 0:             /* child */\n+            OPENSSL_free(kidpids);\n+            signal(SIGINT, SIG_DFL);\n+            signal(SIGTERM, SIG_DFL);\n+            if (termsig)\n+                _exit(0);\n+            if (RAND_poll() <= 0) {\n+                syslog(LOG_ERR, \"fatal: RAND_poll() failed\");\n+                _exit(1);\n+            }\n+            return;\n+        default:            /* parent */\n+            for (i = 0; i < multi; ++i) {\n+                if (kidpids[i] == 0) {\n+                    kidpids[i] = fpid;\n+                    procs++;\n+                    break;\n+                }\n+            }\n+            if (i >= multi) {\n+                syslog(LOG_ERR, \"fatal: internal error: no free child slots\");\n+                killall(1, kidpids);\n+            }\n+            break;\n+        }\n+    }\n+\n+    /* The loop above can only break on termsig */\n+    OPENSSL_free(kidpids);\n+    syslog(LOG_INFO, \"terminating on signal: %d\", termsig);\n+    killall(0, kidpids);\n+}\n+# endif\n+\n static int add_ocsp_cert(OCSP_REQUEST **req, X509 *cert,\n                          const EVP_MD *cert_id_md, X509 *issuer,\n                          STACK_OF(OCSP_CERTID) *ids)\n {\n     OCSP_CERTID *id;\n-    if (!issuer) {\n+\n+    if (issuer == NULL) {\n         BIO_printf(bio_err, \"No issuer certificate specified\\n\");\n         return 0;\n     }\n@@ -758,7 +998,7 @@ static int add_ocsp_cert(OCSP_REQUEST **req, X509 *cert,\n     if (*req == NULL)\n         goto err;\n     id = OCSP_cert_to_id(cert_id_md, cert, issuer);\n-    if (!id || !sk_OCSP_CERTID_push(ids, id))\n+    if (id == NULL || !sk_OCSP_CERTID_push(ids, id))\n         goto err;\n     if (!OCSP_request_add0_id(*req, id))\n         goto err;\n@@ -777,7 +1017,8 @@ static int add_ocsp_serial(OCSP_REQUEST **req, char *serial,\n     X509_NAME *iname;\n     ASN1_BIT_STRING *ikey;\n     ASN1_INTEGER *sno;\n-    if (!issuer) {\n+\n+    if (issuer == NULL) {\n         BIO_printf(bio_err, \"No issuer certificate specified\\n\");\n         return 0;\n     }\n@@ -788,7 +1029,7 @@ static int add_ocsp_serial(OCSP_REQUEST **req, char *serial,\n     iname = X509_get_subject_name(issuer);\n     ikey = X509_get0_pubkey_bitstr(issuer);\n     sno = s2i_ASN1_INTEGER(NULL, serial);\n-    if (!sno) {\n+    if (sno == NULL) {\n         BIO_printf(bio_err, \"Error converting serial number %s\\n\", serial);\n         return 0;\n     }\n@@ -815,7 +1056,7 @@ static void print_ocsp_summary(BIO *out, OCSP_BASICRESP *bs, OCSP_REQUEST *req,\n     int i, status, reason;\n     ASN1_GENERALIZEDTIME *rev, *thisupd, *nextupd;\n \n-    if (!bs || !req || !sk_OPENSSL_STRING_num(names)\n+    if (bs == NULL || req == NULL || !sk_OPENSSL_STRING_num(names)\n         || !sk_OCSP_CERTID_num(ids))\n         return;\n \n@@ -862,16 +1103,19 @@ static void print_ocsp_summary(BIO *out, OCSP_BASICRESP *bs, OCSP_REQUEST *req,\n     }\n }\n \n-static void make_ocsp_response(OCSP_RESPONSE **resp, OCSP_REQUEST *req,\n-                              CA_DB *db, X509 *ca, X509 *rcert,\n+static void make_ocsp_response(BIO *err, OCSP_RESPONSE **resp, OCSP_REQUEST *req,\n+                              CA_DB *db, STACK_OF(X509) *ca, X509 *rcert,\n                               EVP_PKEY *rkey, const EVP_MD *rmd,\n+                              STACK_OF(OPENSSL_STRING) *sigopts,\n                               STACK_OF(X509) *rother, unsigned long flags,\n                               int nmin, int ndays, int badsig)\n {\n     ASN1_TIME *thisupd = NULL, *nextupd = NULL;\n-    OCSP_CERTID *cid, *ca_id = NULL;\n+    OCSP_CERTID *cid;\n     OCSP_BASICRESP *bs = NULL;\n     int i, id_count;\n+    EVP_MD_CTX *mctx = NULL;\n+    EVP_PKEY_CTX *pkctx = NULL;\n \n     id_count = OCSP_request_onereq_count(req);\n \n@@ -891,6 +1135,8 @@ static void make_ocsp_response(OCSP_RESPONSE **resp, OCSP_REQUEST *req,\n         OCSP_ONEREQ *one;\n         ASN1_INTEGER *serial;\n         char **inf;\n+        int jj;\n+        int found = 0;\n         ASN1_OBJECT *cert_id_md_oid;\n         const EVP_MD *cert_id_md;\n         one = OCSP_request_onereq_get0(req, i);\n@@ -899,32 +1145,38 @@ static void make_ocsp_response(OCSP_RESPONSE **resp, OCSP_REQUEST *req,\n         OCSP_id_get0_info(NULL, &cert_id_md_oid, NULL, NULL, cid);\n \n         cert_id_md = EVP_get_digestbyobj(cert_id_md_oid);\n-        if (!cert_id_md) {\n+        if (cert_id_md == NULL) {\n             *resp = OCSP_response_create(OCSP_RESPONSE_STATUS_INTERNALERROR,\n                                          NULL);\n             goto end;\n         }\n-        OCSP_CERTID_free(ca_id);\n-        ca_id = OCSP_cert_to_id(cert_id_md, NULL, ca);\n+        for (jj = 0; jj < sk_X509_num(ca) && !found; jj++) {\n+            X509 *ca_cert = sk_X509_value(ca, jj);\n+            OCSP_CERTID *ca_id = OCSP_cert_to_id(cert_id_md, NULL, ca_cert);\n \n-        /* Is this request about our CA? */\n-        if (OCSP_id_issuer_cmp(ca_id, cid)) {\n+            if (OCSP_id_issuer_cmp(ca_id, cid) == 0)\n+                found = 1;\n+\n+            OCSP_CERTID_free(ca_id);\n+        }\n+\n+        if (!found) {\n             OCSP_basic_add1_status(bs, cid,\n                                    V_OCSP_CERTSTATUS_UNKNOWN,\n                                    0, NULL, thisupd, nextupd);\n             continue;\n         }\n         OCSP_id_get0_info(NULL, NULL, NULL, &serial, cid);\n         inf = lookup_serial(db, serial);\n-        if (!inf)\n+        if (inf == NULL) {\n             OCSP_basic_add1_status(bs, cid,\n                                    V_OCSP_CERTSTATUS_UNKNOWN,\n                                    0, NULL, thisupd, nextupd);\n-        else if (inf[DB_type][0] == DB_TYPE_VAL)\n+        } else if (inf[DB_type][0] == DB_TYPE_VAL) {\n             OCSP_basic_add1_status(bs, cid,\n                                    V_OCSP_CERTSTATUS_GOOD,\n                                    0, NULL, thisupd, nextupd);\n-        else if (inf[DB_type][0] == DB_TYPE_REV) {\n+        } else if (inf[DB_type][0] == DB_TYPE_REV) {\n             ASN1_OBJECT *inst = NULL;\n             ASN1_TIME *revtm = NULL;\n             ASN1_GENERALIZEDTIME *invtm = NULL;\n@@ -934,10 +1186,10 @@ static void make_ocsp_response(OCSP_RESPONSE **resp, OCSP_REQUEST *req,\n             single = OCSP_basic_add1_status(bs, cid,\n                                             V_OCSP_CERTSTATUS_REVOKED,\n                                             reason, revtm, thisupd, nextupd);\n-            if (invtm)\n+            if (invtm != NULL)\n                 OCSP_SINGLERESP_add1_ext_i2d(single, NID_invalidity_date,\n                                              invtm, 0, 0);\n-            else if (inst)\n+            else if (inst != NULL)\n                 OCSP_SINGLERESP_add1_ext_i2d(single,\n                                              NID_hold_instruction_code, inst,\n                                              0, 0);\n@@ -949,7 +1201,23 @@ static void make_ocsp_response(OCSP_RESPONSE **resp, OCSP_REQUEST *req,\n \n     OCSP_copy_nonce(bs, req);\n \n-    OCSP_basic_sign(bs, rcert, rkey, rmd, rother, flags);\n+    mctx = EVP_MD_CTX_new();\n+    if ( mctx == NULL || !EVP_DigestSignInit(mctx, &pkctx, rmd, NULL, rkey)) {\n+        *resp = OCSP_response_create(OCSP_RESPONSE_STATUS_INTERNALERROR, NULL);\n+        goto end;\n+    }\n+    for (i = 0; i < sk_OPENSSL_STRING_num(sigopts); i++) {\n+        char *sigopt = sk_OPENSSL_STRING_value(sigopts, i);\n+\n+        if (pkey_ctrl_string(pkctx, sigopt) <= 0) {\n+            BIO_printf(err, \"parameter error \\\"%s\\\"\\n\", sigopt);\n+            ERR_print_errors(bio_err);\n+            *resp = OCSP_response_create(OCSP_RESPONSE_STATUS_INTERNALERROR,\n+                                         NULL);\n+            goto end;\n+        }\n+    }\n+    OCSP_basic_sign_ctx(bs, rcert, mctx, rother, flags);\n \n     if (badsig) {\n         const ASN1_OCTET_STRING *sig = OCSP_resp_get0_signature(bs);\n@@ -959,9 +1227,9 @@ static void make_ocsp_response(OCSP_RESPONSE **resp, OCSP_REQUEST *req,\n     *resp = OCSP_response_create(OCSP_RESPONSE_STATUS_SUCCESSFUL, bs);\n \n  end:\n+    EVP_MD_CTX_free(mctx);\n     ASN1_TIME_free(thisupd);\n     ASN1_TIME_free(nextupd);\n-    OCSP_CERTID_free(ca_id);\n     OCSP_BASICRESP_free(bs);\n }\n \n@@ -1004,16 +1272,14 @@ static BIO *init_responder(const char *port)\n     if (acbio == NULL\n         || BIO_set_bind_mode(acbio, BIO_BIND_REUSEADDR) < 0\n         || BIO_set_accept_port(acbio, port) < 0) {\n-        BIO_printf(bio_err, \"Error setting up accept BIO\\n\");\n-        ERR_print_errors(bio_err);\n+        log_message(LOG_ERR, \"Error setting up accept BIO\");\n         goto err;\n     }\n \n     BIO_set_accept_bios(acbio, bufbio);\n     bufbio = NULL;\n     if (BIO_do_accept(acbio) <= 0) {\n-        BIO_printf(bio_err, \"Error starting accept\\n\");\n-        ERR_print_errors(bio_err);\n+        log_message(LOG_ERR, \"Error starting accept\");\n         goto err;\n     }\n \n@@ -1052,7 +1318,16 @@ static int urldecode(char *p)\n }\n # endif\n \n-static int do_responder(OCSP_REQUEST **preq, BIO **pcbio, BIO *acbio)\n+# ifdef OCSP_DAEMON\n+static void sock_timeout(int signum)\n+{\n+    if (acfd != (int)INVALID_SOCKET)\n+        (void)shutdown(acfd, SHUT_RD);\n+}\n+# endif\n+\n+static int do_responder(OCSP_REQUEST **preq, BIO **pcbio, BIO *acbio,\n+                        int timeout)\n {\n # ifdef OPENSSL_NO_SOCK\n     return 0;\n@@ -1062,27 +1337,37 @@ static int do_responder(OCSP_REQUEST **preq, BIO **pcbio, BIO *acbio)\n     char inbuf[2048], reqbuf[2048];\n     char *p, *q;\n     BIO *cbio = NULL, *getbio = NULL, *b64 = NULL;\n+    const char *client;\n \n-    if (BIO_do_accept(acbio) <= 0) {\n-        BIO_printf(bio_err, \"Error accepting connection\\n\");\n-        ERR_print_errors(bio_err);\n+    *preq = NULL;\n+\n+    /* Connection loss before accept() is routine, ignore silently */\n+    if (BIO_do_accept(acbio) <= 0)\n         return 0;\n-    }\n \n     cbio = BIO_pop(acbio);\n     *pcbio = cbio;\n+    client = BIO_get_peer_name(cbio);\n+\n+#  ifdef OCSP_DAEMON\n+    if (timeout > 0) {\n+        (void) BIO_get_fd(cbio, &acfd);\n+        alarm(timeout);\n+    }\n+#  endif\n \n     /* Read the request line. */\n     len = BIO_gets(cbio, reqbuf, sizeof(reqbuf));\n     if (len <= 0)\n-        return 1;\n+        goto out;\n+\n     if (strncmp(reqbuf, \"GET \", 4) == 0) {\n         /* Expecting GET {sp} /URL {sp} HTTP/1.x */\n         for (p = reqbuf + 4; *p == ' '; ++p)\n             continue;\n         if (*p != '/') {\n-            BIO_printf(bio_err, \"Invalid request -- bad URL\\n\");\n-            return 1;\n+            log_message(LOG_INFO, \"Invalid request -- bad URL: %s\", client);\n+            goto out;\n         }\n         p++;\n \n@@ -1091,51 +1376,70 @@ static int do_responder(OCSP_REQUEST **preq, BIO **pcbio, BIO *acbio)\n             if (*q == ' ')\n                 break;\n         if (strncmp(q, \" HTTP/1.\", 8) != 0) {\n-            BIO_printf(bio_err, \"Invalid request -- bad HTTP vesion\\n\");\n-            return 1;\n+            log_message(LOG_INFO,\n+                        \"Invalid request -- bad HTTP version: %s\", client);\n+            goto out;\n         }\n         *q = '\\0';\n+\n+        /*\n+         * Skip \"GET / HTTP...\" requests often used by load-balancers\n+         */\n+        if (p[1] == '\\0')\n+            goto out;\n+\n         len = urldecode(p);\n         if (len <= 0) {\n-            BIO_printf(bio_err, \"Invalid request -- bad URL encoding\\n\");\n-            return 1;\n+            log_message(LOG_INFO,\n+                        \"Invalid request -- bad URL encoding: %s\", client);\n+            goto out;\n         }\n         if ((getbio = BIO_new_mem_buf(p, len)) == NULL\n             || (b64 = BIO_new(BIO_f_base64())) == NULL) {\n-            BIO_printf(bio_err, \"Could not allocate memory\\n\");\n-            ERR_print_errors(bio_err);\n-            return 1;\n+            log_message(LOG_ERR, \"Could not allocate base64 bio: %s\", client);\n+            goto out;\n         }\n         BIO_set_flags(b64, BIO_FLAGS_BASE64_NO_NL);\n         getbio = BIO_push(b64, getbio);\n     } else if (strncmp(reqbuf, \"POST \", 5) != 0) {\n-        BIO_printf(bio_err, \"Invalid request -- bad HTTP verb\\n\");\n-        return 1;\n+        log_message(LOG_INFO, \"Invalid request -- bad HTTP verb: %s\", client);\n+        goto out;\n     }\n \n     /* Read and skip past the headers. */\n     for (;;) {\n         len = BIO_gets(cbio, inbuf, sizeof(inbuf));\n         if (len <= 0)\n-            return 1;\n+            goto out;\n         if ((inbuf[0] == '\\r') || (inbuf[0] == '\\n'))\n             break;\n     }\n \n+#  ifdef OCSP_DAEMON\n+    /* Clear alarm before we close the client socket */\n+    alarm(0);\n+    timeout = 0;\n+#  endif\n+\n     /* Try to read OCSP request */\n-    if (getbio) {\n+    if (getbio != NULL) {\n         req = d2i_OCSP_REQUEST_bio(getbio, NULL);\n         BIO_free_all(getbio);\n-    } else\n+    } else {\n         req = d2i_OCSP_REQUEST_bio(cbio, NULL);\n-\n-    if (!req) {\n-        BIO_printf(bio_err, \"Error parsing OCSP request\\n\");\n-        ERR_print_errors(bio_err);\n     }\n \n+    if (req == NULL)\n+        log_message(LOG_ERR, \"Error parsing OCSP request\");\n+\n     *preq = req;\n \n+out:\n+#  ifdef OCSP_DAEMON\n+    if (timeout > 0)\n+        alarm(0);\n+    acfd = (int)INVALID_SOCKET;\n+#  endif\n     return 1;\n # endif\n }\n@@ -1145,7 +1449,7 @@ static int send_ocsp_response(BIO *cbio, OCSP_RESPONSE *resp)\n     char http_resp[] =\n         \"HTTP/1.0 200 OK\\r\\nContent-type: application/ocsp-response\\r\\n\"\n         \"Content-Length: %d\\r\\n\\r\\n\";\n-    if (!cbio)\n+    if (cbio == NULL)\n         return 0;\n     BIO_printf(cbio, http_resp, i2d_OCSP_RESPONSE(resp, NULL));\n     i2d_OCSP_RESPONSE_bio(cbio, resp);\n@@ -1223,11 +1527,11 @@ static OCSP_RESPONSE *query_responder(BIO *cbio, const char *host,\n         openssl_fdset(fd, &confds);\n         tv.tv_usec = 0;\n         tv.tv_sec = req_timeout;\n-        if (BIO_should_read(cbio))\n+        if (BIO_should_read(cbio)) {\n             rv = select(fd + 1, (void *)&confds, NULL, NULL, &tv);\n-        else if (BIO_should_write(cbio))\n+        } else if (BIO_should_write(cbio)) {\n             rv = select(fd + 1, NULL, (void *)&confds, NULL, &tv);\n-        else {\n+        } else {\n             BIO_puts(bio_err, \"Unexpected retry condition\\n\");\n             goto err;\n         }\n@@ -1258,11 +1562,11 @@ OCSP_RESPONSE *process_responder(OCSP_REQUEST *req,\n     OCSP_RESPONSE *resp = NULL;\n \n     cbio = BIO_new_connect(host);\n-    if (!cbio) {\n+    if (cbio == NULL) {\n         BIO_printf(bio_err, \"Error creating connect BIO\\n\");\n         goto end;\n     }\n-    if (port)\n+    if (port != NULL)\n         BIO_set_conn_port(cbio, port);\n     if (use_ssl == 1) {\n         BIO *sbio;\n@@ -1277,7 +1581,7 @@ OCSP_RESPONSE *process_responder(OCSP_REQUEST *req,\n     }\n \n     resp = query_responder(cbio, host, path, headers, req, req_timeout);\n-    if (!resp)\n+    if (resp == NULL)\n         BIO_printf(bio_err, \"Error querying OCSP responder\\n\");\n  end:\n     BIO_free_all(cbio);"
        },
        {
            "sha": "178a0b0f2d3036bf79c629d844fa29fc8508ae4a",
            "filename": "deps/openssl/openssl/apps/openssl-vms.cnf",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopenssl-vms.cnf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopenssl-vms.cnf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopenssl-vms.cnf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -3,10 +3,13 @@\n # This is mostly being used for generation of certificate requests.\n #\n \n+# Note that you can include other files from the main configuration\n+# file using the .include directive.\n+#.include filename\n+\n # This definition stops the following lines choking if HOME isn't\n # defined.\n HOME\t\t\t= .\n-RANDFILE\t\t= $ENV::HOME/.rnd\n \n # Extra OBJECT IDENTIFIER info:\n #oid_file\t\t= $ENV::HOME/.oid\n@@ -53,7 +56,6 @@ crlnumber\t= $dir]crlnumber.\t# the current crl number\n \t\t\t\t\t# must be commented out to leave a V1 CRL\n crl\t\t= $dir]crl.pem \t\t# The current CRL\n private_key\t= $dir.private]cakey.pem# The private key\n-RANDFILE\t= $dir.private].rand\t# private random number file\n \n x509_extensions\t= usr_cert\t\t# The extensions to add to the cert\n \n@@ -344,3 +346,5 @@ tsa_name\t\t= yes\t# Must the TSA name be included in the reply?\n \t\t\t\t# (optional, default: no)\n ess_cert_id_chain\t= no\t# Must the ESS cert id chain be included?\n \t\t\t\t# (optional, default: no)\n+ess_cert_id_alg\t\t= sha1\t# algorithm to compute certificate\n+\t\t\t\t# identifier (optional, default: sha1)"
        },
        {
            "sha": "a872e2c5eeec8bd8764c7e129b75e0b9ccfd3846",
            "filename": "deps/openssl/openssl/apps/openssl.c",
            "status": "modified",
            "additions": 199,
            "deletions": 76,
            "changes": 275,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopenssl.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopenssl.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopenssl.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -7,6 +7,7 @@\n  * https://www.openssl.org/source/license.html\n  */\n \n+#include <internal/cryptlib.h>\n #include <stdio.h>\n #include <string.h>\n #include <stdlib.h>\n@@ -21,26 +22,22 @@\n # include <openssl/engine.h>\n #endif\n #include <openssl/err.h>\n-#ifdef OPENSSL_FIPS\n-# include <openssl/fips.h>\n-#endif\n-#define USE_SOCKETS /* needed for the _O_BINARY defs in the MS world */\n #include \"s_apps.h\"\n /* Needed to get the other O_xxx flags. */\n #ifdef OPENSSL_SYS_VMS\n # include <unixio.h>\n #endif\n-#define INCLUDE_FUNCTION_TABLE\n #include \"apps.h\"\n+#define INCLUDE_FUNCTION_TABLE\n+#include \"progs.h\"\n \n-\n-#ifdef OPENSSL_NO_CAMELLIA\n-# define FORMAT \"%-15s\"\n-# define COLUMNS 5\n-#else\n-# define FORMAT \"%-18s\"\n-# define COLUMNS 4\n-#endif\n+/* Structure to hold the number of columns to be displayed and the\n+ * field width used to display them.\n+ */\n+typedef struct {\n+    int columns;\n+    int width;\n+} DISPLAY_COLUMNS;\n \n /* Special sentinel to exit the program. */\n #define EXIT_THE_PROGRAM (-1)\n@@ -54,15 +51,30 @@\n static LHASH_OF(FUNCTION) *prog_init(void);\n static int do_cmd(LHASH_OF(FUNCTION) *prog, int argc, char *argv[]);\n static void list_pkey(void);\n-static void list_type(FUNC_TYPE ft);\n+static void list_pkey_meth(void);\n+static void list_type(FUNC_TYPE ft, int one);\n static void list_disabled(void);\n char *default_config_file = NULL;\n \n BIO *bio_in = NULL;\n BIO *bio_out = NULL;\n BIO *bio_err = NULL;\n \n-static int apps_startup()\n+static void calculate_columns(DISPLAY_COLUMNS *dc)\n+{\n+    FUNCTION *f;\n+    int len, maxlen = 0;\n+\n+    for (f = functions; f->name != NULL; ++f)\n+        if (f->type == FT_general || f->type == FT_md || f->type == FT_cipher)\n+            if ((len = strlen(f->name)) > maxlen)\n+                maxlen = len;\n+\n+    dc->width = maxlen + 2;\n+    dc->columns = (80 - 1) / dc->width;\n+}\n+\n+static int apps_startup(void)\n {\n #ifdef SIGPIPE\n     signal(SIGPIPE, SIG_IGN);\n@@ -73,21 +85,18 @@ static int apps_startup()\n                           | OPENSSL_INIT_LOAD_CONFIG, NULL))\n         return 0;\n \n-#ifndef OPENSSL_NO_UI\n     setup_ui_method();\n-#endif\n \n     return 1;\n }\n \n-static void apps_shutdown()\n+static void apps_shutdown(void)\n {\n-#ifndef OPENSSL_NO_UI\n     destroy_ui_method();\n-#endif\n+    destroy_prefix_method();\n }\n \n-static char *make_config_name()\n+static char *make_config_name(void)\n {\n     const char *t;\n     size_t len;\n@@ -143,15 +152,8 @@ int main(int argc, char *argv[])\n     CRYPTO_mem_ctrl(CRYPTO_MEM_CHECK_ON);\n \n     if (getenv(\"OPENSSL_FIPS\")) {\n-#ifdef OPENSSL_FIPS\n-        if (!FIPS_mode_set(1)) {\n-            ERR_print_errors(bio_err);\n-            return 1;\n-        }\n-#else\n         BIO_printf(bio_err, \"FIPS mode not supported.\\n\");\n         return 1;\n-#endif\n     }\n \n     if (!apps_startup()) {\n@@ -254,6 +256,7 @@ int main(int argc, char *argv[])\n     OPENSSL_free(default_config_file);\n     lh_FUNCTION_free(prog);\n     OPENSSL_free(arg.argv);\n+    app_RAND_write();\n \n     BIO_free(bio_in);\n     BIO_free_all(bio_out);\n@@ -266,19 +269,15 @@ int main(int argc, char *argv[])\n     EXIT(ret);\n }\n \n-OPTIONS exit_options[] = {\n-    {NULL}\n-};\n-\n static void list_cipher_fn(const EVP_CIPHER *c,\n                            const char *from, const char *to, void *arg)\n {\n-    if (c)\n+    if (c != NULL) {\n         BIO_printf(arg, \"%s\\n\", EVP_CIPHER_name(c));\n-    else {\n-        if (!from)\n+    } else {\n+        if (from == NULL)\n             from = \"<undefined>\";\n-        if (!to)\n+        if (to == NULL)\n             to = \"<undefined>\";\n         BIO_printf(arg, \"%s => %s\\n\", from, to);\n     }\n@@ -287,27 +286,74 @@ static void list_cipher_fn(const EVP_CIPHER *c,\n static void list_md_fn(const EVP_MD *m,\n                        const char *from, const char *to, void *arg)\n {\n-    if (m)\n+    if (m != NULL) {\n         BIO_printf(arg, \"%s\\n\", EVP_MD_name(m));\n-    else {\n-        if (!from)\n+    } else {\n+        if (from == NULL)\n             from = \"<undefined>\";\n-        if (!to)\n+        if (to == NULL)\n             to = \"<undefined>\";\n         BIO_printf((BIO *)arg, \"%s => %s\\n\", from, to);\n     }\n }\n \n+static void list_missing_help(void)\n+{\n+    const FUNCTION *fp;\n+    const OPTIONS *o;\n+\n+    for (fp = functions; fp->name != NULL; fp++) {\n+        if ((o = fp->help) != NULL) {\n+            /* If there is help, list what flags are not documented. */\n+            for ( ; o->name != NULL; o++) {\n+                if (o->helpstr == NULL)\n+                    BIO_printf(bio_out, \"%s %s\\n\", fp->name, o->name);\n+            }\n+        } else if (fp->func != dgst_main) {\n+            /* If not aliased to the dgst command, */\n+            BIO_printf(bio_out, \"%s *\\n\", fp->name);\n+        }\n+    }\n+}\n+\n+static void list_options_for_command(const char *command)\n+{\n+    const FUNCTION *fp;\n+    const OPTIONS *o;\n+\n+    for (fp = functions; fp->name != NULL; fp++)\n+        if (strcmp(fp->name, command) == 0)\n+            break;\n+    if (fp->name == NULL) {\n+        BIO_printf(bio_err, \"Invalid command '%s'; type \\\"help\\\" for a list.\\n\",\n+                command);\n+        return;\n+    }\n+\n+    if ((o = fp->help) == NULL)\n+        return;\n+\n+    for ( ; o->name != NULL; o++) {\n+        if (o->name == OPT_HELP_STR\n+                || o->name == OPT_MORE_STR\n+                || o->name[0] == '\\0')\n+            continue;\n+        BIO_printf(bio_out, \"%s %c\\n\", o->name, o->valtype);\n+    }\n+}\n+\n+\n /* Unified enum for help and list commands. */\n typedef enum HELPLIST_CHOICE {\n-    OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n-    OPT_COMMANDS, OPT_DIGEST_COMMANDS,\n+    OPT_ERR = -1, OPT_EOF = 0, OPT_HELP, OPT_ONE,\n+    OPT_COMMANDS, OPT_DIGEST_COMMANDS, OPT_OPTIONS,\n     OPT_DIGEST_ALGORITHMS, OPT_CIPHER_COMMANDS, OPT_CIPHER_ALGORITHMS,\n-    OPT_PK_ALGORITHMS, OPT_DISABLED\n+    OPT_PK_ALGORITHMS, OPT_PK_METHOD, OPT_DISABLED, OPT_MISSING_HELP\n } HELPLIST_CHOICE;\n \n-OPTIONS list_options[] = {\n+const OPTIONS list_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n+    {\"1\", OPT_ONE, '-', \"List in one column\"},\n     {\"commands\", OPT_COMMANDS, '-', \"List of standard commands\"},\n     {\"digest-commands\", OPT_DIGEST_COMMANDS, '-',\n      \"List of message digest commands\"},\n@@ -318,16 +364,22 @@ OPTIONS list_options[] = {\n      \"List of cipher algorithms\"},\n     {\"public-key-algorithms\", OPT_PK_ALGORITHMS, '-',\n      \"List of public key algorithms\"},\n+    {\"public-key-methods\", OPT_PK_METHOD, '-',\n+     \"List of public key methods\"},\n     {\"disabled\", OPT_DISABLED, '-',\n      \"List of disabled features\"},\n+    {\"missing-help\", OPT_MISSING_HELP, '-',\n+     \"List missing detailed help strings\"},\n+    {\"options\", OPT_OPTIONS, 's',\n+     \"List options for specified command\"},\n     {NULL}\n };\n \n int list_main(int argc, char **argv)\n {\n     char *prog;\n     HELPLIST_CHOICE o;\n-    int done = 0;\n+    int one = 0, done = 0;\n \n     prog = opt_init(argc, argv, list_options);\n     while ((o = opt_next()) != OPT_EOF) {\n@@ -340,27 +392,39 @@ int list_main(int argc, char **argv)\n         case OPT_HELP:\n             opt_help(list_options);\n             break;\n+        case OPT_ONE:\n+            one = 1;\n+            break;\n         case OPT_COMMANDS:\n-            list_type(FT_general);\n+            list_type(FT_general, one);\n             break;\n         case OPT_DIGEST_COMMANDS:\n-            list_type(FT_md);\n+            list_type(FT_md, one);\n             break;\n         case OPT_DIGEST_ALGORITHMS:\n             EVP_MD_do_all_sorted(list_md_fn, bio_out);\n             break;\n         case OPT_CIPHER_COMMANDS:\n-            list_type(FT_cipher);\n+            list_type(FT_cipher, one);\n             break;\n         case OPT_CIPHER_ALGORITHMS:\n             EVP_CIPHER_do_all_sorted(list_cipher_fn, bio_out);\n             break;\n         case OPT_PK_ALGORITHMS:\n             list_pkey();\n             break;\n+        case OPT_PK_METHOD:\n+            list_pkey_meth();\n+            break;\n         case OPT_DISABLED:\n             list_disabled();\n             break;\n+        case OPT_MISSING_HELP:\n+            list_missing_help();\n+            break;\n+        case OPT_OPTIONS:\n+            list_options_for_command(opt_arg());\n+            break;\n         }\n         done = 1;\n     }\n@@ -375,42 +439,60 @@ int list_main(int argc, char **argv)\n     return 0;\n }\n \n-OPTIONS help_options[] = {\n-    {\"help\", OPT_HELP, '-', \"Display this summary\"},\n+typedef enum HELP_CHOICE {\n+    OPT_hERR = -1, OPT_hEOF = 0, OPT_hHELP\n+} HELP_CHOICE;\n+\n+const OPTIONS help_options[] = {\n+    {OPT_HELP_STR, 1, '-', \"Usage: help [options]\\n\"},\n+    {OPT_HELP_STR, 1, '-', \"       help [command]\\n\"},\n+    {\"help\", OPT_hHELP, '-', \"Display this summary\"},\n     {NULL}\n };\n \n+\n int help_main(int argc, char **argv)\n {\n     FUNCTION *fp;\n     int i, nl;\n     FUNC_TYPE tp;\n     char *prog;\n-    HELPLIST_CHOICE o;\n+    HELP_CHOICE o;\n+    DISPLAY_COLUMNS dc;\n \n     prog = opt_init(argc, argv, help_options);\n-    while ((o = opt_next()) != OPT_EOF) {\n+    while ((o = opt_next()) != OPT_hEOF) {\n         switch (o) {\n-        default:\n+        case OPT_hERR:\n+        case OPT_hEOF:\n             BIO_printf(bio_err, \"%s: Use -help for summary.\\n\", prog);\n             return 1;\n-        case OPT_HELP:\n+        case OPT_hHELP:\n             opt_help(help_options);\n             return 0;\n         }\n     }\n \n+    if (opt_num_rest() == 1) {\n+        char *new_argv[3];\n+\n+        new_argv[0] = opt_rest()[0];\n+        new_argv[1] = \"--help\";\n+        new_argv[2] = NULL;\n+        return do_cmd(prog_init(), 2, new_argv);\n+    }\n     if (opt_num_rest() != 0) {\n         BIO_printf(bio_err, \"Usage: %s\\n\", prog);\n         return 1;\n     }\n \n-    BIO_printf(bio_err, \"\\nStandard commands\");\n+    calculate_columns(&dc);\n+    BIO_printf(bio_err, \"Standard commands\");\n     i = 0;\n     tp = FT_none;\n     for (fp = functions; fp->name != NULL; fp++) {\n         nl = 0;\n-        if (((i++) % COLUMNS) == 0) {\n+        if (i++ % dc.columns == 0) {\n             BIO_printf(bio_err, \"\\n\");\n             nl = 1;\n         }\n@@ -428,37 +510,43 @@ int help_main(int argc, char **argv)\n                            \"\\nCipher commands (see the `enc' command for more details)\\n\");\n             }\n         }\n-        BIO_printf(bio_err, FORMAT, fp->name);\n+        BIO_printf(bio_err, \"%-*s\", dc.width, fp->name);\n     }\n     BIO_printf(bio_err, \"\\n\\n\");\n     return 0;\n }\n \n-int exit_main(int argc, char **argv)\n-{\n-    return EXIT_THE_PROGRAM;\n-}\n-\n-static void list_type(FUNC_TYPE ft)\n+static void list_type(FUNC_TYPE ft, int one)\n {\n     FUNCTION *fp;\n     int i = 0;\n+    DISPLAY_COLUMNS dc = {0};\n \n-    for (fp = functions; fp->name != NULL; fp++)\n-        if (fp->type == ft) {\n-            if ((i++ % COLUMNS) == 0)\n+    if (!one)\n+        calculate_columns(&dc);\n+\n+    for (fp = functions; fp->name != NULL; fp++) {\n+        if (fp->type != ft)\n+            continue;\n+        if (one) {\n+            BIO_printf(bio_out, \"%s\\n\", fp->name);\n+        } else {\n+            if (i % dc.columns == 0 && i > 0)\n                 BIO_printf(bio_out, \"\\n\");\n-            BIO_printf(bio_out, FORMAT, fp->name);\n+            BIO_printf(bio_out, \"%-*s\", dc.width, fp->name);\n+            i++;\n         }\n-    BIO_printf(bio_out, \"\\n\");\n+    }\n+    if (!one)\n+        BIO_printf(bio_out, \"\\n\\n\");\n }\n \n static int do_cmd(LHASH_OF(FUNCTION) *prog, int argc, char *argv[])\n {\n     FUNCTION f, *fp;\n \n     if (argc <= 0 || argv[0] == NULL)\n-        return (0);\n+        return 0;\n     f.name = argv[0];\n     fp = lh_FUNCTION_retrieve(prog, &f);\n     if (fp == NULL) {\n@@ -473,7 +561,7 @@ static int do_cmd(LHASH_OF(FUNCTION) *prog, int argc, char *argv[])\n         }\n     }\n     if (fp != NULL) {\n-        return (fp->func(argc, argv));\n+        return fp->func(argc, argv);\n     }\n     if ((strncmp(argv[0], \"no-\", 3)) == 0) {\n         /*\n@@ -483,7 +571,7 @@ static int do_cmd(LHASH_OF(FUNCTION) *prog, int argc, char *argv[])\n         f.name = argv[0] + 3;\n         if (lh_FUNCTION_retrieve(prog, &f) == NULL) {\n             BIO_printf(bio_out, \"%s\\n\", argv[0]);\n-            return (0);\n+            return 0;\n         }\n         BIO_printf(bio_out, \"%s\\n\", argv[0] + 3);\n         return 1;\n@@ -495,7 +583,7 @@ static int do_cmd(LHASH_OF(FUNCTION) *prog, int argc, char *argv[])\n \n     BIO_printf(bio_err, \"Invalid command '%s'; type \\\"help\\\" for a list.\\n\",\n                argv[0]);\n-    return (1);\n+    return 1;\n }\n \n static void list_pkey(void)\n@@ -527,6 +615,22 @@ static void list_pkey(void)\n     }\n }\n \n+static void list_pkey_meth(void)\n+{\n+    size_t i;\n+    size_t meth_count = EVP_PKEY_meth_get_count();\n+\n+    for (i = 0; i < meth_count; i++) {\n+        const EVP_PKEY_METHOD *pmeth = EVP_PKEY_meth_get0(i);\n+        int pkey_id, pkey_flags;\n+\n+        EVP_PKEY_meth_get0_info(&pkey_id, &pkey_flags, pmeth);\n+        BIO_printf(bio_out, \"%s\\n\", OBJ_nid2ln(pkey_id));\n+        BIO_printf(bio_out, \"\\tType: %s Algorithm\\n\",\n+                   pkey_flags & ASN1_PKEY_DYNAMIC ?  \"External\" : \"Builtin\");\n+    }\n+}\n+\n static int function_cmp(const FUNCTION * a, const FUNCTION * b)\n {\n     return strncmp(a->name, b->name, 8);\n@@ -550,6 +654,9 @@ static int SortFnByName(const void *_f1, const void *_f2)\n static void list_disabled(void)\n {\n     BIO_puts(bio_out, \"Disabled algorithms:\\n\");\n+#ifdef OPENSSL_NO_ARIA\n+    BIO_puts(bio_out, \"ARIA\\n\");\n+#endif\n #ifdef OPENSSL_NO_BF\n     BIO_puts(bio_out, \"BF\\n\");\n #endif\n@@ -655,6 +762,15 @@ static void list_disabled(void)\n #ifdef OPENSSL_NO_SEED\n     BIO_puts(bio_out, \"SEED\\n\");\n #endif\n+#ifdef OPENSSL_NO_SM2\n+    BIO_puts(bio_out, \"SM2\\n\");\n+#endif\n+#ifdef OPENSSL_NO_SM3\n+    BIO_puts(bio_out, \"SM3\\n\");\n+#endif\n+#ifdef OPENSSL_NO_SM4\n+    BIO_puts(bio_out, \"SM4\\n\");\n+#endif\n #ifdef OPENSSL_NO_SOCK\n     BIO_puts(bio_out, \"SOCK\\n\");\n #endif\n@@ -686,18 +802,25 @@ static void list_disabled(void)\n \n static LHASH_OF(FUNCTION) *prog_init(void)\n {\n-    LHASH_OF(FUNCTION) *ret;\n+    static LHASH_OF(FUNCTION) *ret = NULL;\n+    static int prog_inited = 0;\n     FUNCTION *f;\n     size_t i;\n \n+    if (prog_inited)\n+        return ret;\n+\n+    prog_inited = 1;\n+\n     /* Sort alphabetically within category. For nicer help displays. */\n-    for (i = 0, f = functions; f->name != NULL; ++f, ++i) ;\n+    for (i = 0, f = functions; f->name != NULL; ++f, ++i)\n+        ;\n     qsort(functions, i, sizeof(*functions), SortFnByName);\n \n     if ((ret = lh_FUNCTION_new(function_hash, function_cmp)) == NULL)\n-        return (NULL);\n+        return NULL;\n \n     for (f = functions; f->name != NULL; f++)\n         (void)lh_FUNCTION_insert(ret, f);\n-    return (ret);\n+    return ret;\n }"
        },
        {
            "sha": "6df2878d5021551e8cceae297ac07b5675f627dd",
            "filename": "deps/openssl/openssl/apps/openssl.cnf",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopenssl.cnf",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopenssl.cnf",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopenssl.cnf?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -3,10 +3,13 @@\n # This is mostly being used for generation of certificate requests.\n #\n \n+# Note that you can include other files from the main configuration\n+# file using the .include directive.\n+#.include filename\n+\n # This definition stops the following lines choking if HOME isn't\n # defined.\n HOME\t\t\t= .\n-RANDFILE\t\t= $ENV::HOME/.rnd\n \n # Extra OBJECT IDENTIFIER info:\n #oid_file\t\t= $ENV::HOME/.oid\n@@ -53,7 +56,6 @@ crlnumber\t= $dir/crlnumber\t# the current crl number\n \t\t\t\t\t# must be commented out to leave a V1 CRL\n crl\t\t= $dir/crl.pem \t\t# The current CRL\n private_key\t= $dir/private/cakey.pem# The private key\n-RANDFILE\t= $dir/private/.rand\t# private random number file\n \n x509_extensions\t= usr_cert\t\t# The extensions to add to the cert\n \n@@ -344,3 +346,5 @@ tsa_name\t\t= yes\t# Must the TSA name be included in the reply?\n \t\t\t\t# (optional, default: no)\n ess_cert_id_chain\t= no\t# Must the ESS cert id chain be included?\n \t\t\t\t# (optional, default: no)\n+ess_cert_id_alg\t\t= sha1\t# algorithm to compute certificate\n+\t\t\t\t# identifier (optional, default: sha1)"
        },
        {
            "sha": "666856535d5ed4329e5acddbf14b99f27ba1f7f8",
            "filename": "deps/openssl/openssl/apps/opt.c",
            "status": "modified",
            "additions": 40,
            "deletions": 119,
            "changes": 159,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopt.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopt.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fopt.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,13 +1,11 @@\n /*\n- * Copyright 2015-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 2015-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n  * in the file LICENSE in the source distribution or at\n  * https://www.openssl.org/source/license.html\n  */\n-\n-/* #define COMPILE_STANDALONE_TEST_DRIVER  */\n #include \"apps.h\"\n #include <string.h>\n #if !defined(OPENSSL_SYS_MSDOS)\n@@ -170,7 +168,6 @@ static OPT_PAIR formats[] = {\n     {\"smime\", OPT_FMT_SMIME},\n     {\"engine\", OPT_FMT_ENGINE},\n     {\"msblob\", OPT_FMT_MSBLOB},\n-    {\"netscape\", OPT_FMT_NETSCAPE},\n     {\"nss\", OPT_FMT_NSS},\n     {\"text\", OPT_FMT_TEXT},\n     {\"http\", OPT_FMT_HTTP},\n@@ -183,10 +180,10 @@ int opt_format_error(const char *s, unsigned long flags)\n {\n     OPT_PAIR *ap;\n \n-    if (flags == OPT_FMT_PEMDER)\n+    if (flags == OPT_FMT_PEMDER) {\n         BIO_printf(bio_err, \"%s: Bad format \\\"%s\\\"; must be pem or der\\n\",\n                    prog, s);\n-    else {\n+    } else {\n         BIO_printf(bio_err, \"%s: Bad format \\\"%s\\\"; must be one of:\\n\",\n                    prog, s);\n         for (ap = formats; ap->name; ap++)\n@@ -266,8 +263,9 @@ int opt_format(const char *s, unsigned long flags, int *result)\n             if ((flags & OPT_FMT_PKCS12) == 0)\n                 return opt_format_error(s, flags);\n             *result = FORMAT_PKCS12;\n-        } else\n+        } else {\n             return 0;\n+        }\n         break;\n     }\n     return 1;\n@@ -277,9 +275,9 @@ int opt_format(const char *s, unsigned long flags, int *result)\n int opt_cipher(const char *name, const EVP_CIPHER **cipherp)\n {\n     *cipherp = EVP_get_cipherbyname(name);\n-    if (*cipherp)\n+    if (*cipherp != NULL)\n         return 1;\n-    BIO_printf(bio_err, \"%s: Unknown cipher %s\\n\", prog, name);\n+    BIO_printf(bio_err, \"%s: Unrecognized flag %s\\n\", prog, name);\n     return 0;\n }\n \n@@ -289,9 +287,9 @@ int opt_cipher(const char *name, const EVP_CIPHER **cipherp)\n int opt_md(const char *name, const EVP_MD **mdp)\n {\n     *mdp = EVP_get_digestbyname(name);\n-    if (*mdp)\n+    if (*mdp != NULL)\n         return 1;\n-    BIO_printf(bio_err, \"%s: Unknown digest %s\\n\", prog, name);\n+    BIO_printf(bio_err, \"%s: Unrecognized flag %s\\n\", prog, name);\n     return 0;\n }\n \n@@ -327,6 +325,30 @@ int opt_int(const char *value, int *result)\n     return 1;\n }\n \n+static void opt_number_error(const char *v)\n+{\n+    size_t i = 0;\n+    struct strstr_pair_st {\n+        char *prefix;\n+        char *name;\n+    } b[] = {\n+        {\"0x\", \"a hexadecimal\"},\n+        {\"0X\", \"a hexadecimal\"},\n+        {\"0\", \"an octal\"}\n+    };\n+\n+    for (i = 0; i < OSSL_NELEM(b); i++) {\n+        if (strncmp(v, b[i].prefix, strlen(b[i].prefix)) == 0) {\n+            BIO_printf(bio_err,\n+                       \"%s: Can't parse \\\"%s\\\" as %s number\\n\",\n+                       prog, v, b[i].name);\n+            return;\n+        }\n+    }\n+    BIO_printf(bio_err, \"%s: Can't parse \\\"%s\\\" as a number\\n\", prog, v);\n+    return;\n+}\n+\n /* Parse a long, put it into *result; return 0 on failure, else 1. */\n int opt_long(const char *value, long *result)\n {\n@@ -340,8 +362,7 @@ int opt_long(const char *value, long *result)\n             || endp == value\n             || ((l == LONG_MAX || l == LONG_MIN) && errno == ERANGE)\n             || (l == 0 && errno != 0)) {\n-        BIO_printf(bio_err, \"%s: Can't parse \\\"%s\\\" as a number\\n\",\n-                   prog, value);\n+        opt_number_error(value);\n         errno = oerrno;\n         return 0;\n     }\n@@ -366,8 +387,7 @@ int opt_imax(const char *value, intmax_t *result)\n             || endp == value\n             || ((m == INTMAX_MAX || m == INTMAX_MIN) && errno == ERANGE)\n             || (m == 0 && errno != 0)) {\n-        BIO_printf(bio_err, \"%s: Can't parse \\\"%s\\\" as a number\\n\",\n-                   prog, value);\n+        opt_number_error(value);\n         errno = oerrno;\n         return 0;\n     }\n@@ -389,8 +409,7 @@ int opt_umax(const char *value, uintmax_t *result)\n             || endp == value\n             || (m == UINTMAX_MAX && errno == ERANGE)\n             || (m == 0 && errno != 0)) {\n-        BIO_printf(bio_err, \"%s: Can't parse \\\"%s\\\" as a number\\n\",\n-                   prog, value);\n+        opt_number_error(value);\n         errno = oerrno;\n         return 0;\n     }\n@@ -415,8 +434,7 @@ int opt_ulong(const char *value, unsigned long *result)\n             || endptr == value\n             || ((l == ULONG_MAX) && errno == ERANGE)\n             || (l == 0 && errno != 0)) {\n-        BIO_printf(bio_err, \"%s: Can't parse \\\"%s\\\" as an unsigned number\\n\",\n-                   prog, value);\n+        opt_number_error(value);\n         errno = oerrno;\n         return 0;\n     }\n@@ -657,26 +675,16 @@ int opt_next(void)\n             /* Just a string. */\n             break;\n         case '/':\n-            if (app_isdir(arg) >= 0)\n+            if (app_isdir(arg) > 0)\n                 break;\n             BIO_printf(bio_err, \"%s: Not a directory: %s\\n\", prog, arg);\n             return -1;\n         case '<':\n             /* Input file. */\n-            if (strcmp(arg, \"-\") == 0 || app_access(arg, R_OK) >= 0)\n-                break;\n-            BIO_printf(bio_err,\n-                       \"%s: Cannot open input file %s, %s\\n\",\n-                       prog, arg, strerror(errno));\n-            return -1;\n+            break;\n         case '>':\n             /* Output file. */\n-            if (strcmp(arg, \"-\") == 0 || app_access(arg, W_OK) >= 0 || errno == ENOENT)\n-                break;\n-            BIO_printf(bio_err,\n-                       \"%s: Cannot open output file %s, %s\\n\",\n-                       prog, arg, strerror(errno));\n-            return -1;\n+            break;\n         case 'p':\n         case 'n':\n             if (!opt_int(arg, &ival)\n@@ -888,90 +896,3 @@ void opt_help(const OPTIONS *list)\n         BIO_printf(bio_err, \"%s  %s\\n\", start, help);\n     }\n }\n-\n-#ifdef COMPILE_STANDALONE_TEST_DRIVER\n-# include <sys/stat.h>\n-\n-typedef enum OPTION_choice {\n-    OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n-    OPT_IN, OPT_INFORM, OPT_OUT, OPT_COUNT, OPT_U, OPT_FLAG,\n-    OPT_STR, OPT_NOTUSED\n-} OPTION_CHOICE;\n-\n-static OPTIONS options[] = {\n-    {OPT_HELP_STR, 1, '-', \"Usage: %s flags\\n\"},\n-    {OPT_HELP_STR, 1, '-', \"Valid options are:\\n\"},\n-    {\"help\", OPT_HELP, '-', \"Display this summary\"},\n-    {\"in\", OPT_IN, '<', \"input file\"},\n-    {OPT_MORE_STR, 1, '-', \"more detail about input\"},\n-    {\"inform\", OPT_INFORM, 'f', \"input file format; defaults to pem\"},\n-    {\"out\", OPT_OUT, '>', \"output file\"},\n-    {\"count\", OPT_COUNT, 'p', \"a counter greater than zero\"},\n-    {\"u\", OPT_U, 'u', \"an unsigned number\"},\n-    {\"flag\", OPT_FLAG, 0, \"just some flag\"},\n-    {\"str\", OPT_STR, 's', \"the magic word\"},\n-    {\"areallyverylongoption\", OPT_HELP, '-', \"long way for help\"},\n-    {NULL}\n-};\n-\n-BIO *bio_err;\n-\n-int app_isdir(const char *name)\n-{\n-    struct stat sb;\n-\n-    return name != NULL && stat(name, &sb) >= 0 && S_ISDIR(sb.st_mode);\n-}\n-\n-int main(int ac, char **av)\n-{\n-    OPTION_CHOICE o;\n-    char **rest;\n-    char *prog;\n-\n-    bio_err = BIO_new_fp(stderr, BIO_NOCLOSE | BIO_FP_TEXT);\n-\n-    prog = opt_init(ac, av, options);\n-    while ((o = opt_next()) != OPT_EOF) {\n-        switch (c) {\n-        case OPT_NOTUSED:\n-        case OPT_EOF:\n-        case OPT_ERR:\n-            printf(\"%s: Usage error; try -help.\\n\", prog);\n-            return 1;\n-        case OPT_HELP:\n-            opt_help(options);\n-            return 0;\n-        case OPT_IN:\n-            printf(\"in %s\\n\", opt_arg());\n-            break;\n-        case OPT_INFORM:\n-            printf(\"inform %s\\n\", opt_arg());\n-            break;\n-        case OPT_OUT:\n-            printf(\"out %s\\n\", opt_arg());\n-            break;\n-        case OPT_COUNT:\n-            printf(\"count %s\\n\", opt_arg());\n-            break;\n-        case OPT_U:\n-            printf(\"u %s\\n\", opt_arg());\n-            break;\n-        case OPT_FLAG:\n-            printf(\"flag\\n\");\n-            break;\n-        case OPT_STR:\n-            printf(\"str %s\\n\", opt_arg());\n-            break;\n-        }\n-    }\n-    argc = opt_num_rest();\n-    argv = opt_rest();\n-\n-    printf(\"args = %d\\n\", argc);\n-    if (argc)\n-        while (*argv)\n-            printf(\"  %s\\n\", *argv++);\n-    return 0;\n-}\n-#endif"
        },
        {
            "sha": "aa516c874e656fca0f3ed4df803417be51cea1ce",
            "filename": "deps/openssl/openssl/apps/passwd.c",
            "status": "modified",
            "additions": 467,
            "deletions": 126,
            "changes": 593,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpasswd.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpasswd.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpasswd.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,32 +1,26 @@\n /*\n- * Copyright 2000-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 2000-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n  * in the file LICENSE in the source distribution or at\n  * https://www.openssl.org/source/license.html\n  */\n \n-#if defined OPENSSL_NO_MD5 || defined CHARSET_EBCDIC\n-# define NO_MD5CRYPT_1\n-#endif\n-\n-#if !defined(OPENSSL_NO_DES) || !defined(NO_MD5CRYPT_1)\n-\n-# include <string.h>\n+#include <string.h>\n \n-# include \"apps.h\"\n+#include \"apps.h\"\n+#include \"progs.h\"\n \n-# include <openssl/bio.h>\n-# include <openssl/err.h>\n-# include <openssl/evp.h>\n-# include <openssl/rand.h>\n-# ifndef OPENSSL_NO_DES\n-#  include <openssl/des.h>\n-# endif\n-# ifndef NO_MD5CRYPT_1\n-#  include <openssl/md5.h>\n-# endif\n+#include <openssl/bio.h>\n+#include <openssl/err.h>\n+#include <openssl/evp.h>\n+#include <openssl/rand.h>\n+#ifndef OPENSSL_NO_DES\n+# include <openssl/des.h>\n+#endif\n+#include <openssl/md5.h>\n+#include <openssl/sha.h>\n \n static unsigned const char cov_2char[64] = {\n     /* from crypto/des/fcrypt.c */\n@@ -40,19 +34,31 @@ static unsigned const char cov_2char[64] = {\n     0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7A\n };\n \n+static const char ascii_dollar[] = { 0x24, 0x00 };\n+\n+typedef enum {\n+    passwd_unset = 0,\n+    passwd_crypt,\n+    passwd_md5,\n+    passwd_apr1,\n+    passwd_sha256,\n+    passwd_sha512,\n+    passwd_aixmd5\n+} passwd_modes;\n+\n static int do_passwd(int passed_salt, char **salt_p, char **salt_malloc_p,\n                      char *passwd, BIO *out, int quiet, int table,\n-                     int reverse, size_t pw_maxlen, int usecrypt, int use1,\n-                     int useapr1);\n+                     int reverse, size_t pw_maxlen, passwd_modes mode);\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_IN,\n     OPT_NOVERIFY, OPT_QUIET, OPT_TABLE, OPT_REVERSE, OPT_APR1,\n-    OPT_1, OPT_CRYPT, OPT_SALT, OPT_STDIN\n+    OPT_1, OPT_5, OPT_6, OPT_CRYPT, OPT_AIXMD5, OPT_SALT, OPT_STDIN,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS passwd_options[] = {\n+const OPTIONS passwd_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"in\", OPT_IN, '<', \"Read passwords from file\"},\n     {\"noverify\", OPT_NOVERIFY, '-',\n@@ -62,13 +68,15 @@ OPTIONS passwd_options[] = {\n     {\"reverse\", OPT_REVERSE, '-', \"Switch table columns\"},\n     {\"salt\", OPT_SALT, 's', \"Use provided salt\"},\n     {\"stdin\", OPT_STDIN, '-', \"Read passwords from stdin\"},\n-# ifndef NO_MD5CRYPT_1\n+    {\"6\", OPT_6, '-', \"SHA512-based password algorithm\"},\n+    {\"5\", OPT_5, '-', \"SHA256-based password algorithm\"},\n     {\"apr1\", OPT_APR1, '-', \"MD5-based password algorithm, Apache variant\"},\n     {\"1\", OPT_1, '-', \"MD5-based password algorithm\"},\n-# endif\n-# ifndef OPENSSL_NO_DES\n+    {\"aixmd5\", OPT_AIXMD5, '-', \"AIX MD5-based password algorithm\"},\n+#ifndef OPENSSL_NO_DES\n     {\"crypt\", OPT_CRYPT, '-', \"Standard Unix password algorithm (default)\"},\n-# endif\n+#endif\n+    OPT_R_OPTIONS,\n     {NULL}\n };\n \n@@ -79,12 +87,15 @@ int passwd_main(int argc, char **argv)\n     char *salt_malloc = NULL, *passwd_malloc = NULL, *prog;\n     OPTION_CHOICE o;\n     int in_stdin = 0, pw_source_defined = 0;\n-# ifndef OPENSSL_NO_UI\n+#ifndef OPENSSL_NO_UI_CONSOLE\n     int in_noverify = 0;\n-# endif\n+#endif\n     int passed_salt = 0, quiet = 0, table = 0, reverse = 0;\n-    int ret = 1, usecrypt = 0, use1 = 0, useapr1 = 0;\n-    size_t passwd_malloc_size = 0, pw_maxlen = 256;\n+    int ret = 1;\n+    passwd_modes mode = passwd_unset;\n+    size_t passwd_malloc_size = 0;\n+    size_t pw_maxlen = 256; /* arbitrary limit, should be enough for most\n+                             * passwords */\n \n     prog = opt_init(argc, argv, passwd_options);\n     while ((o = opt_next()) != OPT_EOF) {\n@@ -105,9 +116,9 @@ int passwd_main(int argc, char **argv)\n             pw_source_defined = 1;\n             break;\n         case OPT_NOVERIFY:\n-# ifndef OPENSSL_NO_UI\n+#ifndef OPENSSL_NO_UI_CONSOLE\n             in_noverify = 1;\n-# endif\n+#endif\n             break;\n         case OPT_QUIET:\n             quiet = 1;\n@@ -119,13 +130,36 @@ int passwd_main(int argc, char **argv)\n             reverse = 1;\n             break;\n         case OPT_1:\n-            use1 = 1;\n+            if (mode != passwd_unset)\n+                goto opthelp;\n+            mode = passwd_md5;\n+            break;\n+        case OPT_5:\n+            if (mode != passwd_unset)\n+                goto opthelp;\n+            mode = passwd_sha256;\n+            break;\n+        case OPT_6:\n+            if (mode != passwd_unset)\n+                goto opthelp;\n+            mode = passwd_sha512;\n             break;\n         case OPT_APR1:\n-            useapr1 = 1;\n+            if (mode != passwd_unset)\n+                goto opthelp;\n+            mode = passwd_apr1;\n+            break;\n+        case OPT_AIXMD5:\n+            if (mode != passwd_unset)\n+                goto opthelp;\n+            mode = passwd_aixmd5;\n             break;\n         case OPT_CRYPT:\n-            usecrypt = 1;\n+#ifndef OPENSSL_NO_DES\n+            if (mode != passwd_unset)\n+                goto opthelp;\n+            mode = passwd_crypt;\n+#endif\n             break;\n         case OPT_SALT:\n             passed_salt = 1;\n@@ -137,35 +171,31 @@ int passwd_main(int argc, char **argv)\n             in_stdin = 1;\n             pw_source_defined = 1;\n             break;\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n+            break;\n         }\n     }\n     argc = opt_num_rest();\n     argv = opt_rest();\n \n-    if (*argv) {\n+    if (*argv != NULL) {\n         if (pw_source_defined)\n             goto opthelp;\n         pw_source_defined = 1;\n         passwds = argv;\n     }\n \n-    if (!usecrypt && !use1 && !useapr1) {\n+    if (mode == passwd_unset) {\n         /* use default */\n-        usecrypt = 1;\n-    }\n-    if (usecrypt + use1 + useapr1 > 1) {\n-        /* conflict */\n-        goto opthelp;\n+        mode = passwd_crypt;\n     }\n \n-# ifdef OPENSSL_NO_DES\n-    if (usecrypt)\n-        goto opthelp;\n-# endif\n-# ifdef NO_MD5CRYPT_1\n-    if (use1 || useapr1)\n+#ifdef OPENSSL_NO_DES\n+    if (mode == passwd_crypt)\n         goto opthelp;\n-# endif\n+#endif\n \n     if (infile != NULL && in_stdin) {\n         BIO_printf(bio_err, \"%s: Can't combine -in and -stdin\\n\", prog);\n@@ -182,11 +212,8 @@ int passwd_main(int argc, char **argv)\n             goto end;\n     }\n \n-    if (usecrypt)\n+    if (mode == passwd_crypt)\n         pw_maxlen = 8;\n-    else if (use1 || useapr1)\n-        pw_maxlen = 256;        /* arbitrary limit, should be enough for most\n-                                 * passwords */\n \n     if (passwds == NULL) {\n         /* no passwords on the command line */\n@@ -204,7 +231,7 @@ int passwd_main(int argc, char **argv)\n          * avoid rot of not-frequently-used code.\n          */\n         if (1) {\n-# ifndef OPENSSL_NO_UI\n+#ifndef OPENSSL_NO_UI_CONSOLE\n             /* build a null-terminated list */\n             static char *passwds_static[2] = { NULL, NULL };\n \n@@ -217,7 +244,7 @@ int passwd_main(int argc, char **argv)\n             }\n             passwds[0] = passwd_malloc;\n         } else {\n-# endif\n+#endif\n             BIO_printf(bio_err, \"password required\\n\");\n             goto end;\n         }\n@@ -230,8 +257,7 @@ int passwd_main(int argc, char **argv)\n         do {                    /* loop over list of passwords */\n             passwd = *passwds++;\n             if (!do_passwd(passed_salt, &salt, &salt_malloc, passwd, bio_out,\n-                           quiet, table, reverse, pw_maxlen, usecrypt, use1,\n-                           useapr1))\n+                           quiet, table, reverse, pw_maxlen, mode))\n                 goto end;\n         } while (*passwds != NULL);\n     } else {\n@@ -255,7 +281,7 @@ int passwd_main(int argc, char **argv)\n \n                 if (!do_passwd\n                     (passed_salt, &salt, &salt_malloc, passwd, bio_out, quiet,\n-                     table, reverse, pw_maxlen, usecrypt, use1, useapr1))\n+                     table, reverse, pw_maxlen, mode))\n                     goto end;\n             }\n             done = (r <= 0);\n@@ -264,14 +290,15 @@ int passwd_main(int argc, char **argv)\n     ret = 0;\n \n  end:\n+#if 0\n     ERR_print_errors(bio_err);\n+#endif\n     OPENSSL_free(salt_malloc);\n     OPENSSL_free(passwd_malloc);\n     BIO_free(in);\n-    return (ret);\n+    return ret;\n }\n \n-# ifndef NO_MD5CRYPT_1\n /*\n  * MD5-based password algorithm (should probably be available as a library\n  * function; then the static buffer would not be acceptable). For magic\n@@ -286,48 +313,82 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)\n     /* \"$apr1$..salt..$.......md5hash..........\\0\" */\n     static char out_buf[6 + 9 + 24 + 2];\n     unsigned char buf[MD5_DIGEST_LENGTH];\n+    char ascii_magic[5];         /* \"apr1\" plus '\\0' */\n+    char ascii_salt[9];          /* Max 8 chars plus '\\0' */\n+    char *ascii_passwd = NULL;\n     char *salt_out;\n     int n;\n     unsigned int i;\n     EVP_MD_CTX *md = NULL, *md2 = NULL;\n     size_t passwd_len, salt_len, magic_len;\n \n     passwd_len = strlen(passwd);\n-    out_buf[0] = '$';\n-    out_buf[1] = 0;\n+\n+    out_buf[0] = 0;\n     magic_len = strlen(magic);\n+    OPENSSL_strlcpy(ascii_magic, magic, sizeof(ascii_magic));\n+#ifdef CHARSET_EBCDIC\n+    if ((magic[0] & 0x80) != 0)    /* High bit is 1 in EBCDIC alnums */\n+        ebcdic2ascii(ascii_magic, ascii_magic, magic_len);\n+#endif\n \n-    if (magic_len > 4)    /* assert it's  \"1\" or \"apr1\" */\n+    /* The salt gets truncated to 8 chars */\n+    OPENSSL_strlcpy(ascii_salt, salt, sizeof(ascii_salt));\n+    salt_len = strlen(ascii_salt);\n+#ifdef CHARSET_EBCDIC\n+    ebcdic2ascii(ascii_salt, ascii_salt, salt_len);\n+#endif\n+\n+#ifdef CHARSET_EBCDIC\n+    ascii_passwd = OPENSSL_strdup(passwd);\n+    if (ascii_passwd == NULL)\n         return NULL;\n+    ebcdic2ascii(ascii_passwd, ascii_passwd, passwd_len);\n+    passwd = ascii_passwd;\n+#endif\n+\n+    if (magic_len > 0) {\n+        OPENSSL_strlcat(out_buf, ascii_dollar, sizeof(out_buf));\n+\n+        if (magic_len > 4)    /* assert it's  \"1\" or \"apr1\" */\n+            goto err;\n+\n+        OPENSSL_strlcat(out_buf, ascii_magic, sizeof(out_buf));\n+        OPENSSL_strlcat(out_buf, ascii_dollar, sizeof(out_buf));\n+    }\n \n-    OPENSSL_strlcat(out_buf, magic, sizeof(out_buf));\n-    OPENSSL_strlcat(out_buf, \"$\", sizeof(out_buf));\n-    OPENSSL_strlcat(out_buf, salt, sizeof(out_buf));\n+    OPENSSL_strlcat(out_buf, ascii_salt, sizeof(out_buf));\n \n     if (strlen(out_buf) > 6 + 8) /* assert \"$apr1$..salt..\" */\n-        return NULL;\n+        goto err;\n \n-    salt_out = out_buf + 2 + magic_len;\n-    salt_len = strlen(salt_out);\n+    salt_out = out_buf;\n+    if (magic_len > 0)\n+        salt_out += 2 + magic_len;\n \n     if (salt_len > 8)\n-        return NULL;\n+        goto err;\n \n     md = EVP_MD_CTX_new();\n     if (md == NULL\n         || !EVP_DigestInit_ex(md, EVP_md5(), NULL)\n-        || !EVP_DigestUpdate(md, passwd, passwd_len)\n-        || !EVP_DigestUpdate(md, \"$\", 1)\n-        || !EVP_DigestUpdate(md, magic, magic_len)\n-        || !EVP_DigestUpdate(md, \"$\", 1)\n-        || !EVP_DigestUpdate(md, salt_out, salt_len))\n+        || !EVP_DigestUpdate(md, passwd, passwd_len))\n+        goto err;\n+\n+    if (magic_len > 0)\n+        if (!EVP_DigestUpdate(md, ascii_dollar, 1)\n+            || !EVP_DigestUpdate(md, ascii_magic, magic_len)\n+            || !EVP_DigestUpdate(md, ascii_dollar, 1))\n+          goto err;\n+\n+    if (!EVP_DigestUpdate(md, ascii_salt, salt_len))\n         goto err;\n \n     md2 = EVP_MD_CTX_new();\n     if (md2 == NULL\n         || !EVP_DigestInit_ex(md2, EVP_md5(), NULL)\n         || !EVP_DigestUpdate(md2, passwd, passwd_len)\n-        || !EVP_DigestUpdate(md2, salt_out, salt_len)\n+        || !EVP_DigestUpdate(md2, ascii_salt, salt_len)\n         || !EVP_DigestUpdate(md2, passwd, passwd_len)\n         || !EVP_DigestFinal_ex(md2, buf, NULL))\n         goto err;\n@@ -356,7 +417,7 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)\n                               (i & 1) ? passwd_len : sizeof(buf)))\n             goto err;\n         if (i % 3) {\n-            if (!EVP_DigestUpdate(md2, salt_out, salt_len))\n+            if (!EVP_DigestUpdate(md2, ascii_salt, salt_len))\n                 goto err;\n         }\n         if (i % 7) {\n@@ -387,15 +448,15 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)\n             buf_perm[dest] = buf[source];\n         buf_perm[14] = buf[5];\n         buf_perm[15] = buf[11];\n-#  ifndef PEDANTIC              /* Unfortunately, this generates a \"no\n+# ifndef PEDANTIC              /* Unfortunately, this generates a \"no\n                                  * effect\" warning */\n         assert(16 == sizeof(buf_perm));\n-#  endif\n+# endif\n \n         output = salt_out + salt_len;\n         assert(output == out_buf + strlen(out_buf));\n \n-        *output++ = '$';\n+        *output++ = ascii_dollar[0];\n \n         for (i = 0; i < 15; i += 3) {\n             *output++ = cov_2char[buf_perm[i + 2] & 0x3f];\n@@ -410,21 +471,309 @@ static char *md5crypt(const char *passwd, const char *magic, const char *salt)\n         *output++ = cov_2char[buf_perm[i] >> 6];\n         *output = 0;\n         assert(strlen(out_buf) < sizeof(out_buf));\n+#ifdef CHARSET_EBCDIC\n+        ascii2ebcdic(out_buf, out_buf, strlen(out_buf));\n+#endif\n     }\n \n     return out_buf;\n \n  err:\n+    OPENSSL_free(ascii_passwd);\n     EVP_MD_CTX_free(md2);\n     EVP_MD_CTX_free(md);\n     return NULL;\n }\n-# endif\n+\n+/*\n+ * SHA based password algorithm, describe by Ulrich Drepper here:\n+ * https://www.akkadia.org/drepper/SHA-crypt.txt\n+ * (note that it's in the public domain)\n+ */\n+static char *shacrypt(const char *passwd, const char *magic, const char *salt)\n+{\n+    /* Prefix for optional rounds specification.  */\n+    static const char rounds_prefix[] = \"rounds=\";\n+    /* Maximum salt string length.  */\n+# define SALT_LEN_MAX 16\n+    /* Default number of rounds if not explicitly specified.  */\n+# define ROUNDS_DEFAULT 5000\n+    /* Minimum number of rounds.  */\n+# define ROUNDS_MIN 1000\n+    /* Maximum number of rounds.  */\n+# define ROUNDS_MAX 999999999\n+\n+    /* \"$6$rounds=<N>$......salt......$...shahash(up to 86 chars)...\\0\" */\n+    static char out_buf[3 + 17 + 17 + 86 + 1];\n+    unsigned char buf[SHA512_DIGEST_LENGTH];\n+    unsigned char temp_buf[SHA512_DIGEST_LENGTH];\n+    size_t buf_size = 0;\n+    char ascii_magic[2];\n+    char ascii_salt[17];          /* Max 16 chars plus '\\0' */\n+    char *ascii_passwd = NULL;\n+    size_t n;\n+    EVP_MD_CTX *md = NULL, *md2 = NULL;\n+    const EVP_MD *sha = NULL;\n+    size_t passwd_len, salt_len, magic_len;\n+    unsigned int rounds = 5000;        /* Default */\n+    char rounds_custom = 0;\n+    char *p_bytes = NULL;\n+    char *s_bytes = NULL;\n+    char *cp = NULL;\n+\n+    passwd_len = strlen(passwd);\n+    magic_len = strlen(magic);\n+\n+    /* assert it's \"5\" or \"6\" */\n+    if (magic_len != 1)\n+        return NULL;\n+\n+    switch (magic[0]) {\n+    case '5':\n+        sha = EVP_sha256();\n+        buf_size = 32;\n+        break;\n+    case '6':\n+        sha = EVP_sha512();\n+        buf_size = 64;\n+        break;\n+    default:\n+        return NULL;\n+    }\n+\n+    if (strncmp(salt, rounds_prefix, sizeof(rounds_prefix) - 1) == 0) {\n+        const char *num = salt + sizeof(rounds_prefix) - 1;\n+        char *endp;\n+        unsigned long int srounds = strtoul (num, &endp, 10);\n+        if (*endp == '$') {\n+            salt = endp + 1;\n+            if (srounds > ROUNDS_MAX)\n+                rounds = ROUNDS_MAX;\n+            else if (srounds < ROUNDS_MIN)\n+                rounds = ROUNDS_MIN;\n+            else\n+                rounds = (unsigned int)srounds;\n+            rounds_custom = 1;\n+        } else {\n+            return NULL;\n+        }\n+    }\n+\n+    OPENSSL_strlcpy(ascii_magic, magic, sizeof(ascii_magic));\n+#ifdef CHARSET_EBCDIC\n+    if ((magic[0] & 0x80) != 0)    /* High bit is 1 in EBCDIC alnums */\n+        ebcdic2ascii(ascii_magic, ascii_magic, magic_len);\n+#endif\n+\n+    /* The salt gets truncated to 16 chars */\n+    OPENSSL_strlcpy(ascii_salt, salt, sizeof(ascii_salt));\n+    salt_len = strlen(ascii_salt);\n+#ifdef CHARSET_EBCDIC\n+    ebcdic2ascii(ascii_salt, ascii_salt, salt_len);\n+#endif\n+\n+#ifdef CHARSET_EBCDIC\n+    ascii_passwd = OPENSSL_strdup(passwd);\n+    if (ascii_passwd == NULL)\n+        return NULL;\n+    ebcdic2ascii(ascii_passwd, ascii_passwd, passwd_len);\n+    passwd = ascii_passwd;\n+#endif\n+\n+    out_buf[0] = 0;\n+    OPENSSL_strlcat(out_buf, ascii_dollar, sizeof(out_buf));\n+    OPENSSL_strlcat(out_buf, ascii_magic, sizeof(out_buf));\n+    OPENSSL_strlcat(out_buf, ascii_dollar, sizeof(out_buf));\n+    if (rounds_custom) {\n+        char tmp_buf[80]; /* \"rounds=999999999\" */\n+        sprintf(tmp_buf, \"rounds=%u\", rounds);\n+#ifdef CHARSET_EBCDIC\n+        /* In case we're really on a ASCII based platform and just pretend */\n+        if (tmp_buf[0] != 0x72)  /* ASCII 'r' */\n+            ebcdic2ascii(tmp_buf, tmp_buf, strlen(tmp_buf));\n+#endif\n+        OPENSSL_strlcat(out_buf, tmp_buf, sizeof(out_buf));\n+        OPENSSL_strlcat(out_buf, ascii_dollar, sizeof(out_buf));\n+    }\n+    OPENSSL_strlcat(out_buf, ascii_salt, sizeof(out_buf));\n+\n+    /* assert \"$5$rounds=999999999$......salt......\" */\n+    if (strlen(out_buf) > 3 + 17 * rounds_custom + salt_len )\n+        goto err;\n+\n+    md = EVP_MD_CTX_new();\n+    if (md == NULL\n+        || !EVP_DigestInit_ex(md, sha, NULL)\n+        || !EVP_DigestUpdate(md, passwd, passwd_len)\n+        || !EVP_DigestUpdate(md, ascii_salt, salt_len))\n+        goto err;\n+\n+    md2 = EVP_MD_CTX_new();\n+    if (md2 == NULL\n+        || !EVP_DigestInit_ex(md2, sha, NULL)\n+        || !EVP_DigestUpdate(md2, passwd, passwd_len)\n+        || !EVP_DigestUpdate(md2, ascii_salt, salt_len)\n+        || !EVP_DigestUpdate(md2, passwd, passwd_len)\n+        || !EVP_DigestFinal_ex(md2, buf, NULL))\n+        goto err;\n+\n+    for (n = passwd_len; n > buf_size; n -= buf_size) {\n+        if (!EVP_DigestUpdate(md, buf, buf_size))\n+            goto err;\n+    }\n+    if (!EVP_DigestUpdate(md, buf, n))\n+        goto err;\n+\n+    n = passwd_len;\n+    while (n) {\n+        if (!EVP_DigestUpdate(md,\n+                              (n & 1) ? buf : (unsigned const char *)passwd,\n+                              (n & 1) ? buf_size : passwd_len))\n+            goto err;\n+        n >>= 1;\n+    }\n+    if (!EVP_DigestFinal_ex(md, buf, NULL))\n+        return NULL;\n+\n+    /* P sequence */\n+    if (!EVP_DigestInit_ex(md2, sha, NULL))\n+        goto err;\n+\n+    for (n = passwd_len; n > 0; n--)\n+        if (!EVP_DigestUpdate(md2, passwd, passwd_len))\n+            goto err;\n+\n+    if (!EVP_DigestFinal_ex(md2, temp_buf, NULL))\n+        return NULL;\n+\n+    if ((p_bytes = OPENSSL_zalloc(passwd_len)) == NULL)\n+        goto err;\n+    for (cp = p_bytes, n = passwd_len; n > buf_size; n -= buf_size, cp += buf_size)\n+        memcpy(cp, temp_buf, buf_size);\n+    memcpy(cp, temp_buf, n);\n+\n+    /* S sequence */\n+    if (!EVP_DigestInit_ex(md2, sha, NULL))\n+        goto err;\n+\n+    for (n = 16 + buf[0]; n > 0; n--)\n+        if (!EVP_DigestUpdate(md2, ascii_salt, salt_len))\n+            goto err;\n+\n+    if (!EVP_DigestFinal_ex(md2, temp_buf, NULL))\n+        return NULL;\n+\n+    if ((s_bytes = OPENSSL_zalloc(salt_len)) == NULL)\n+        goto err;\n+    for (cp = s_bytes, n = salt_len; n > buf_size; n -= buf_size, cp += buf_size)\n+        memcpy(cp, temp_buf, buf_size);\n+    memcpy(cp, temp_buf, n);\n+\n+    for (n = 0; n < rounds; n++) {\n+        if (!EVP_DigestInit_ex(md2, sha, NULL))\n+            goto err;\n+        if (!EVP_DigestUpdate(md2,\n+                              (n & 1) ? (unsigned const char *)p_bytes : buf,\n+                              (n & 1) ? passwd_len : buf_size))\n+            goto err;\n+        if (n % 3) {\n+            if (!EVP_DigestUpdate(md2, s_bytes, salt_len))\n+                goto err;\n+        }\n+        if (n % 7) {\n+            if (!EVP_DigestUpdate(md2, p_bytes, passwd_len))\n+                goto err;\n+        }\n+        if (!EVP_DigestUpdate(md2,\n+                              (n & 1) ? buf : (unsigned const char *)p_bytes,\n+                              (n & 1) ? buf_size : passwd_len))\n+                goto err;\n+        if (!EVP_DigestFinal_ex(md2, buf, NULL))\n+                goto err;\n+    }\n+    EVP_MD_CTX_free(md2);\n+    EVP_MD_CTX_free(md);\n+    md2 = NULL;\n+    md = NULL;\n+    OPENSSL_free(p_bytes);\n+    OPENSSL_free(s_bytes);\n+    p_bytes = NULL;\n+    s_bytes = NULL;\n+\n+    cp = out_buf + strlen(out_buf);\n+    *cp++ = ascii_dollar[0];\n+\n+# define b64_from_24bit(B2, B1, B0, N)                                   \\\n+    do {                                                                \\\n+        unsigned int w = ((B2) << 16) | ((B1) << 8) | (B0);             \\\n+        int i = (N);                                                    \\\n+        while (i-- > 0)                                                 \\\n+            {                                                           \\\n+                *cp++ = cov_2char[w & 0x3f];                            \\\n+                w >>= 6;                                                \\\n+            }                                                           \\\n+    } while (0)\n+\n+    switch (magic[0]) {\n+    case '5':\n+        b64_from_24bit (buf[0], buf[10], buf[20], 4);\n+        b64_from_24bit (buf[21], buf[1], buf[11], 4);\n+        b64_from_24bit (buf[12], buf[22], buf[2], 4);\n+        b64_from_24bit (buf[3], buf[13], buf[23], 4);\n+        b64_from_24bit (buf[24], buf[4], buf[14], 4);\n+        b64_from_24bit (buf[15], buf[25], buf[5], 4);\n+        b64_from_24bit (buf[6], buf[16], buf[26], 4);\n+        b64_from_24bit (buf[27], buf[7], buf[17], 4);\n+        b64_from_24bit (buf[18], buf[28], buf[8], 4);\n+        b64_from_24bit (buf[9], buf[19], buf[29], 4);\n+        b64_from_24bit (0, buf[31], buf[30], 3);\n+        break;\n+    case '6':\n+        b64_from_24bit (buf[0], buf[21], buf[42], 4);\n+        b64_from_24bit (buf[22], buf[43], buf[1], 4);\n+        b64_from_24bit (buf[44], buf[2], buf[23], 4);\n+        b64_from_24bit (buf[3], buf[24], buf[45], 4);\n+        b64_from_24bit (buf[25], buf[46], buf[4], 4);\n+        b64_from_24bit (buf[47], buf[5], buf[26], 4);\n+        b64_from_24bit (buf[6], buf[27], buf[48], 4);\n+        b64_from_24bit (buf[28], buf[49], buf[7], 4);\n+        b64_from_24bit (buf[50], buf[8], buf[29], 4);\n+        b64_from_24bit (buf[9], buf[30], buf[51], 4);\n+        b64_from_24bit (buf[31], buf[52], buf[10], 4);\n+        b64_from_24bit (buf[53], buf[11], buf[32], 4);\n+        b64_from_24bit (buf[12], buf[33], buf[54], 4);\n+        b64_from_24bit (buf[34], buf[55], buf[13], 4);\n+        b64_from_24bit (buf[56], buf[14], buf[35], 4);\n+        b64_from_24bit (buf[15], buf[36], buf[57], 4);\n+        b64_from_24bit (buf[37], buf[58], buf[16], 4);\n+        b64_from_24bit (buf[59], buf[17], buf[38], 4);\n+        b64_from_24bit (buf[18], buf[39], buf[60], 4);\n+        b64_from_24bit (buf[40], buf[61], buf[19], 4);\n+        b64_from_24bit (buf[62], buf[20], buf[41], 4);\n+        b64_from_24bit (0, 0, buf[63], 2);\n+        break;\n+    default:\n+        goto err;\n+    }\n+    *cp = '\\0';\n+#ifdef CHARSET_EBCDIC\n+    ascii2ebcdic(out_buf, out_buf, strlen(out_buf));\n+#endif\n+\n+    return out_buf;\n+\n+ err:\n+    EVP_MD_CTX_free(md2);\n+    EVP_MD_CTX_free(md);\n+    OPENSSL_free(p_bytes);\n+    OPENSSL_free(s_bytes);\n+    OPENSSL_free(ascii_passwd);\n+    return NULL;\n+}\n \n static int do_passwd(int passed_salt, char **salt_p, char **salt_malloc_p,\n                      char *passwd, BIO *out, int quiet, int table,\n-                     int reverse, size_t pw_maxlen, int usecrypt, int use1,\n-                     int useapr1)\n+                     int reverse, size_t pw_maxlen, passwd_modes mode)\n {\n     char *hash = NULL;\n \n@@ -433,36 +782,34 @@ static int do_passwd(int passed_salt, char **salt_p, char **salt_malloc_p,\n \n     /* first make sure we have a salt */\n     if (!passed_salt) {\n-# ifndef OPENSSL_NO_DES\n-        if (usecrypt) {\n-            if (*salt_malloc_p == NULL)\n-                *salt_p = *salt_malloc_p = app_malloc(3, \"salt buffer\");\n-            if (RAND_bytes((unsigned char *)*salt_p, 2) <= 0)\n-                goto end;\n-            (*salt_p)[0] = cov_2char[(*salt_p)[0] & 0x3f]; /* 6 bits */\n-            (*salt_p)[1] = cov_2char[(*salt_p)[1] & 0x3f]; /* 6 bits */\n-            (*salt_p)[2] = 0;\n-#  ifdef CHARSET_EBCDIC\n-            ascii2ebcdic(*salt_p, *salt_p, 2); /* des_crypt will convert back\n-                                                * to ASCII */\n-#  endif\n-        }\n-# endif                         /* !OPENSSL_NO_DES */\n+        size_t saltlen = 0;\n+        size_t i;\n \n-# ifndef NO_MD5CRYPT_1\n-        if (use1 || useapr1) {\n-            int i;\n+#ifndef OPENSSL_NO_DES\n+        if (mode == passwd_crypt)\n+            saltlen = 2;\n+#endif                         /* !OPENSSL_NO_DES */\n \n-            if (*salt_malloc_p == NULL)\n-                *salt_p = *salt_malloc_p = app_malloc(9, \"salt buffer\");\n-            if (RAND_bytes((unsigned char *)*salt_p, 8) <= 0)\n-                goto end;\n+        if (mode == passwd_md5 || mode == passwd_apr1 || mode == passwd_aixmd5)\n+            saltlen = 8;\n \n-            for (i = 0; i < 8; i++)\n-                (*salt_p)[i] = cov_2char[(*salt_p)[i] & 0x3f]; /* 6 bits */\n-            (*salt_p)[8] = 0;\n-        }\n-# endif                         /* !NO_MD5CRYPT_1 */\n+        if (mode == passwd_sha256 || mode == passwd_sha512)\n+            saltlen = 16;\n+\n+        assert(saltlen != 0);\n+\n+        if (*salt_malloc_p == NULL)\n+            *salt_p = *salt_malloc_p = app_malloc(saltlen + 1, \"salt buffer\");\n+        if (RAND_bytes((unsigned char *)*salt_p, saltlen) <= 0)\n+            goto end;\n+\n+        for (i = 0; i < saltlen; i++)\n+            (*salt_p)[i] = cov_2char[(*salt_p)[i] & 0x3f]; /* 6 bits */\n+        (*salt_p)[i] = 0;\n+# ifdef CHARSET_EBCDIC\n+        /* The password encryption funtion will convert back to ASCII */\n+        ascii2ebcdic(*salt_p, *salt_p, saltlen);\n+# endif\n     }\n \n     assert(*salt_p != NULL);\n@@ -481,14 +828,16 @@ static int do_passwd(int passed_salt, char **salt_p, char **salt_malloc_p,\n     assert(strlen(passwd) <= pw_maxlen);\n \n     /* now compute password hash */\n-# ifndef OPENSSL_NO_DES\n-    if (usecrypt)\n+#ifndef OPENSSL_NO_DES\n+    if (mode == passwd_crypt)\n         hash = DES_crypt(passwd, *salt_p);\n-# endif\n-# ifndef NO_MD5CRYPT_1\n-    if (use1 || useapr1)\n-        hash = md5crypt(passwd, (use1 ? \"1\" : \"apr1\"), *salt_p);\n-# endif\n+#endif\n+    if (mode == passwd_md5 || mode == passwd_apr1)\n+        hash = md5crypt(passwd, (mode == passwd_md5 ? \"1\" : \"apr1\"), *salt_p);\n+    if (mode == passwd_aixmd5)\n+        hash = md5crypt(passwd, \"\", *salt_p);\n+    if (mode == passwd_sha256 || mode == passwd_sha512)\n+        hash = shacrypt(passwd, (mode == passwd_sha256 ? \"5\" : \"6\"), *salt_p);\n     assert(hash != NULL);\n \n     if (table && !reverse)\n@@ -502,11 +851,3 @@ static int do_passwd(int passed_salt, char **salt_p, char **salt_malloc_p,\n  end:\n     return 0;\n }\n-#else\n-\n-int passwd_main(int argc, char **argv)\n-{\n-    BIO_printf(bio_err, \"Program not available.\\n\");\n-    return (1);\n-}\n-#endif"
        },
        {
            "sha": "c8fc452ec6d2e7baa5ac595e62d63c7902971e48",
            "filename": "deps/openssl/openssl/apps/pkcs12.c",
            "status": "modified",
            "additions": 72,
            "deletions": 46,
            "changes": 118,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkcs12.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkcs12.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkcs12.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1999-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1999-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -16,6 +16,7 @@ NON_EMPTY_TRANSLATION_UNIT\n # include <stdlib.h>\n # include <string.h>\n # include \"apps.h\"\n+# include \"progs.h\"\n # include <openssl/crypto.h>\n # include <openssl/err.h>\n # include <openssl/pem.h>\n@@ -27,6 +28,8 @@ NON_EMPTY_TRANSLATION_UNIT\n # define CLCERTS         0x8\n # define CACERTS         0x10\n \n+#define PASSWD_BUF_SIZE 2048\n+\n static int get_cert_chain(X509 *cert, X509_STORE *store,\n                           STACK_OF(X509) **chain);\n int dump_certs_keys_p12(BIO *out, const PKCS12 *p12,\n@@ -51,12 +54,13 @@ typedef enum OPTION_choice {\n     OPT_CACERTS, OPT_NOOUT, OPT_INFO, OPT_CHAIN, OPT_TWOPASS, OPT_NOMACVER,\n     OPT_DESCERT, OPT_EXPORT, OPT_NOITER, OPT_MACITER, OPT_NOMACITER,\n     OPT_NOMAC, OPT_LMK, OPT_NODES, OPT_MACALG, OPT_CERTPBE, OPT_KEYPBE,\n-    OPT_RAND, OPT_INKEY, OPT_CERTFILE, OPT_NAME, OPT_CSP, OPT_CANAME,\n+    OPT_INKEY, OPT_CERTFILE, OPT_NAME, OPT_CSP, OPT_CANAME,\n     OPT_IN, OPT_OUT, OPT_PASSIN, OPT_PASSOUT, OPT_PASSWORD, OPT_CAPATH,\n-    OPT_CAFILE, OPT_NOCAPATH, OPT_NOCAFILE, OPT_ENGINE\n+    OPT_CAFILE, OPT_NOCAPATH, OPT_NOCAFILE, OPT_ENGINE,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS pkcs12_options[] = {\n+const OPTIONS pkcs12_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"nokeys\", OPT_NOKEYS, '-', \"Don't output private keys\"},\n     {\"keyex\", OPT_KEYEX, '-', \"Set MS key exchange type\"},\n@@ -89,8 +93,7 @@ OPTIONS pkcs12_options[] = {\n     {\"macalg\", OPT_MACALG, 's',\n      \"Digest algorithm used in MAC (default SHA1)\"},\n     {\"keypbe\", OPT_KEYPBE, 's', \"Private key PBE algorithm (default 3DES)\"},\n-    {\"rand\", OPT_RAND, 's',\n-     \"Load the file(s) into the random number generator\"},\n+    OPT_R_OPTIONS,\n     {\"inkey\", OPT_INKEY, 's', \"Private key if not infile\"},\n     {\"certfile\", OPT_CERTFILE, '<', \"Load certs from file\"},\n     {\"name\", OPT_NAME, 's', \"Use name as friendly name\"},\n@@ -119,7 +122,7 @@ int pkcs12_main(int argc, char **argv)\n {\n     char *infile = NULL, *outfile = NULL, *keyname = NULL, *certfile = NULL;\n     char *name = NULL, *csp_name = NULL;\n-    char pass[2048] = \"\", macpass[2048] = \"\";\n+    char pass[PASSWD_BUF_SIZE] = \"\", macpass[PASSWD_BUF_SIZE] = \"\";\n     int export_cert = 0, options = 0, chain = 0, twopass = 0, keytype = 0;\n     int iter = PKCS12_DEFAULT_ITER, maciter = PKCS12_DEFAULT_ITER;\n # ifndef OPENSSL_NO_RC2\n@@ -131,7 +134,7 @@ int pkcs12_main(int argc, char **argv)\n     int ret = 1, macver = 1, add_lmk = 0, private = 0;\n     int noprompt = 0;\n     char *passinarg = NULL, *passoutarg = NULL, *passarg = NULL;\n-    char *passin = NULL, *passout = NULL, *inrand = NULL, *macalg = NULL;\n+    char *passin = NULL, *passout = NULL, *macalg = NULL;\n     char *cpass = NULL, *mpass = NULL, *badpass = NULL;\n     const char *CApath = NULL, *CAfile = NULL, *prog;\n     int noCApath = 0, noCAfile = 0;\n@@ -223,8 +226,9 @@ int pkcs12_main(int argc, char **argv)\n             if (!set_pbe(&key_pbe, opt_arg()))\n                 goto opthelp;\n             break;\n-        case OPT_RAND:\n-            inrand = opt_arg();\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n             break;\n         case OPT_INKEY:\n             keyname = opt_arg();\n@@ -285,7 +289,7 @@ int pkcs12_main(int argc, char **argv)\n \n     private = 1;\n \n-    if (passarg) {\n+    if (passarg != NULL) {\n         if (export_cert)\n             passoutarg = passarg;\n         else\n@@ -297,33 +301,27 @@ int pkcs12_main(int argc, char **argv)\n         goto end;\n     }\n \n-    if (!cpass) {\n+    if (cpass == NULL) {\n         if (export_cert)\n             cpass = passout;\n         else\n             cpass = passin;\n     }\n \n-    if (cpass) {\n+    if (cpass != NULL) {\n         mpass = cpass;\n         noprompt = 1;\n     } else {\n         cpass = pass;\n         mpass = macpass;\n     }\n \n-    if (export_cert || inrand) {\n-        app_RAND_load_file(NULL, (inrand != NULL));\n-        if (inrand != NULL)\n-            BIO_printf(bio_err, \"%ld semi-random bytes loaded\\n\",\n-                       app_RAND_load_files(inrand));\n-    }\n-\n     if (twopass) {\n+        /* To avoid bit rot */\n         if (1) {\n-#ifndef OPENSSL_NO_UI\n-            if (EVP_read_pw_string\n-                (macpass, sizeof(macpass), \"Enter MAC Password:\", export_cert)) {\n+#ifndef OPENSSL_NO_UI_CONSOLE\n+            if (EVP_read_pw_string(\n+                macpass, sizeof(macpass), \"Enter MAC Password:\", export_cert)) {\n                 BIO_printf(bio_err, \"Can't read Password\\n\");\n                 goto end;\n             }\n@@ -353,7 +351,7 @@ int pkcs12_main(int argc, char **argv)\n         if (!(options & NOKEYS)) {\n             key = load_key(keyname ? keyname : infile,\n                            FORMAT_PEM, 1, passin, e, \"private key\");\n-            if (!key)\n+            if (key == NULL)\n                 goto export_end;\n         }\n \n@@ -363,7 +361,7 @@ int pkcs12_main(int argc, char **argv)\n                             \"certificates\"))\n                 goto export_end;\n \n-            if (key) {\n+            if (key != NULL) {\n                 /* Look for matching private key */\n                 for (i = 0; i < sk_X509_num(certs); i++) {\n                     x = sk_X509_value(certs, i);\n@@ -377,7 +375,7 @@ int pkcs12_main(int argc, char **argv)\n                         break;\n                     }\n                 }\n-                if (!ucert) {\n+                if (ucert == NULL) {\n                     BIO_printf(bio_err,\n                                \"No certificate matches private key\\n\");\n                     goto export_end;\n@@ -387,7 +385,7 @@ int pkcs12_main(int argc, char **argv)\n         }\n \n         /* Add any more certificates asked for */\n-        if (certfile) {\n+        if (certfile != NULL) {\n             if (!load_certs(certfile, &certs, FORMAT_PEM, NULL,\n                             \"certificates from certfile\"))\n                 goto export_end;\n@@ -429,19 +427,20 @@ int pkcs12_main(int argc, char **argv)\n             X509_alias_set1(sk_X509_value(certs, i), catmp, -1);\n         }\n \n-        if (csp_name && key)\n+        if (csp_name != NULL && key != NULL)\n             EVP_PKEY_add1_attr_by_NID(key, NID_ms_csp_name,\n                                       MBSTRING_ASC, (unsigned char *)csp_name,\n                                       -1);\n \n-        if (add_lmk && key)\n+        if (add_lmk && key != NULL)\n             EVP_PKEY_add1_attr_by_NID(key, NID_LocalKeySet, 0, NULL, -1);\n \n         if (!noprompt) {\n+            /* To avoid bit rot */\n             if (1) {\n-#ifndef OPENSSL_NO_UI\n-                if (EVP_read_pw_string(pass, sizeof(pass), \"Enter Export Password:\",\n-                                       1)) {\n+#ifndef OPENSSL_NO_UI_CONSOLE\n+                if (EVP_read_pw_string(pass, sizeof(pass),\n+                                       \"Enter Export Password:\", 1)) {\n                     BIO_printf(bio_err, \"Can't read Password\\n\");\n                     goto export_end;\n                 }\n@@ -505,7 +504,7 @@ int pkcs12_main(int argc, char **argv)\n \n     if (!noprompt) {\n         if (1) {\n-#ifndef OPENSSL_NO_UI\n+#ifndef OPENSSL_NO_UI_CONSOLE\n             if (EVP_read_pw_string(pass, sizeof(pass), \"Enter Import Password:\",\n                                    0)) {\n                 BIO_printf(bio_err, \"Can't read Password\\n\");\n@@ -525,12 +524,20 @@ int pkcs12_main(int argc, char **argv)\n         const ASN1_INTEGER *tmaciter;\n         const X509_ALGOR *macalgid;\n         const ASN1_OBJECT *macobj;\n-        PKCS12_get0_mac(NULL, &macalgid, NULL, &tmaciter, p12);\n+        const ASN1_OCTET_STRING *tmac;\n+        const ASN1_OCTET_STRING *tsalt;\n+\n+        PKCS12_get0_mac(&tmac, &macalgid, &tsalt, &tmaciter, p12);\n+        /* current hash algorithms do not use parameters so extract just name,\n+           in future alg_print() may be needed */\n         X509_ALGOR_get0(&macobj, NULL, NULL, macalgid);\n-        BIO_puts(bio_err, \"MAC:\");\n+        BIO_puts(bio_err, \"MAC: \");\n         i2a_ASN1_OBJECT(bio_err, macobj);\n-        BIO_printf(bio_err, \" Iteration %ld\\n\",\n-                   tmaciter  != NULL ? ASN1_INTEGER_get(tmaciter) : 1L);\n+        BIO_printf(bio_err, \", Iteration %ld\\n\",\n+                   tmaciter != NULL ? ASN1_INTEGER_get(tmaciter) : 1L);\n+        BIO_printf(bio_err, \"MAC length: %ld, salt length: %ld\\n\",\n+                   tmac != NULL ? ASN1_STRING_length(tmac) : 0L,\n+                   tsalt != NULL ? ASN1_STRING_length(tsalt) : 0L);\n     }\n     if (macver) {\n         /* If we enter empty password try no password first */\n@@ -572,16 +579,14 @@ int pkcs12_main(int argc, char **argv)\n     ret = 0;\n  end:\n     PKCS12_free(p12);\n-    if (export_cert || inrand)\n-        app_RAND_write_file(NULL);\n     release_engine(e);\n     BIO_free(in);\n     BIO_free_all(out);\n     sk_OPENSSL_STRING_free(canames);\n     OPENSSL_free(badpass);\n     OPENSSL_free(passin);\n     OPENSSL_free(passout);\n-    return (ret);\n+    return ret;\n }\n \n int dump_certs_keys_p12(BIO *out, const PKCS12 *p12, const char *pass,\n@@ -609,8 +614,9 @@ int dump_certs_keys_p12(BIO *out, const PKCS12 *p12, const char *pass,\n                 alg_print(p7->d.encrypted->enc_data->algorithm);\n             }\n             bags = PKCS12_unpack_p7encdata(p7, pass, passlen);\n-        } else\n+        } else {\n             continue;\n+        }\n         if (!bags)\n             goto err;\n         if (!dump_certs_pkeys_bags(out, bags, pass, passlen,\n@@ -785,7 +791,7 @@ static int alg_print(const X509_ALGOR *alg)\n         if (aparamtype == V_ASN1_SEQUENCE)\n             pbe2 = ASN1_item_unpack(aparam, ASN1_ITEM_rptr(PBE2PARAM));\n         if (pbe2 == NULL) {\n-            BIO_puts(bio_err, \"<unsupported parameters>\");\n+            BIO_puts(bio_err, \", <unsupported parameters>\");\n             goto done;\n         }\n         X509_ALGOR_get0(&aoid, &aparamtype, &aparam, pbe2->keyfunc);\n@@ -801,7 +807,7 @@ static int alg_print(const X509_ALGOR *alg)\n             if (aparamtype == V_ASN1_SEQUENCE)\n                 kdf = ASN1_item_unpack(aparam, ASN1_ITEM_rptr(PBKDF2PARAM));\n             if (kdf == NULL) {\n-                BIO_puts(bio_err, \"<unsupported parameters>\");\n+                BIO_puts(bio_err, \", <unsupported parameters>\");\n                 goto done;\n             }\n \n@@ -814,13 +820,31 @@ static int alg_print(const X509_ALGOR *alg)\n             BIO_printf(bio_err, \", Iteration %ld, PRF %s\",\n                        ASN1_INTEGER_get(kdf->iter), OBJ_nid2sn(prfnid));\n             PBKDF2PARAM_free(kdf);\n+#ifndef OPENSSL_NO_SCRYPT\n+        } else if (pbenid == NID_id_scrypt) {\n+            SCRYPT_PARAMS *kdf = NULL;\n+\n+            if (aparamtype == V_ASN1_SEQUENCE)\n+                kdf = ASN1_item_unpack(aparam, ASN1_ITEM_rptr(SCRYPT_PARAMS));\n+            if (kdf == NULL) {\n+                BIO_puts(bio_err, \", <unsupported parameters>\");\n+                goto done;\n+            }\n+            BIO_printf(bio_err, \", Salt length: %d, Cost(N): %ld, \"\n+                       \"Block size(r): %ld, Paralelizm(p): %ld\",\n+                       ASN1_STRING_length(kdf->salt),\n+                       ASN1_INTEGER_get(kdf->costParameter),\n+                       ASN1_INTEGER_get(kdf->blockSize),\n+                       ASN1_INTEGER_get(kdf->parallelizationParameter));\n+            SCRYPT_PARAMS_free(kdf);\n+#endif\n         }\n         PBE2PARAM_free(pbe2);\n     } else {\n         if (aparamtype == V_ASN1_SEQUENCE)\n             pbe = ASN1_item_unpack(aparam, ASN1_ITEM_rptr(PBEPARAM));\n         if (pbe == NULL) {\n-            BIO_puts(bio_err, \"<unsupported parameters>\");\n+            BIO_puts(bio_err, \", <unsupported parameters>\");\n             goto done;\n         }\n         BIO_printf(bio_err, \", Iteration %ld\", ASN1_INTEGER_get(pbe->iter));\n@@ -874,8 +898,9 @@ int print_attribs(BIO *out, const STACK_OF(X509_ATTRIBUTE) *attrlst,\n         if (attr_nid == NID_undef) {\n             i2a_ASN1_OBJECT(out, attr_obj);\n             BIO_printf(out, \": \");\n-        } else\n+        } else {\n             BIO_printf(out, \"%s: \", OBJ_nid2ln(attr_nid));\n+        }\n \n         if (X509_ATTRIBUTE_count(attr)) {\n             av = X509_ATTRIBUTE_get0_type(attr, 0);\n@@ -903,8 +928,9 @@ int print_attribs(BIO *out, const STACK_OF(X509_ATTRIBUTE) *attrlst,\n                 BIO_printf(out, \"<Unsupported tag %d>\\n\", av->type);\n                 break;\n             }\n-        } else\n+        } else {\n             BIO_printf(out, \"<No Values>\\n\");\n+        }\n     }\n     return 1;\n }"
        },
        {
            "sha": "c3e9f5c692608e09cf9b07b810f84f3cd974931e",
            "filename": "deps/openssl/openssl/apps/pkcs7.c",
            "status": "modified",
            "additions": 5,
            "deletions": 4,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkcs7.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkcs7.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkcs7.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -12,6 +12,7 @@\n #include <string.h>\n #include <time.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/err.h>\n #include <openssl/objects.h>\n #include <openssl/evp.h>\n@@ -25,7 +26,7 @@ typedef enum OPTION_choice {\n     OPT_TEXT, OPT_PRINT, OPT_PRINT_CERTS, OPT_ENGINE\n } OPTION_CHOICE;\n \n-OPTIONS pkcs7_options[] = {\n+const OPTIONS pkcs7_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"inform\", OPT_INFORM, 'F', \"Input format - DER or PEM\"},\n     {\"in\", OPT_IN, '<', \"Input file\"},\n@@ -163,7 +164,7 @@ int pkcs7_main(int argc, char **argv)\n             for (i = 0; i < sk_X509_CRL_num(crls); i++) {\n                 crl = sk_X509_CRL_value(crls, i);\n \n-                X509_CRL_print(out, crl);\n+                X509_CRL_print_ex(out, crl, get_nameopt());\n \n                 if (!noout)\n                     PEM_write_bio_X509_CRL(out, crl);\n@@ -193,5 +194,5 @@ int pkcs7_main(int argc, char **argv)\n     release_engine(e);\n     BIO_free(in);\n     BIO_free_all(out);\n-    return (ret);\n+    return ret;\n }"
        },
        {
            "sha": "205536560ac13413de476e306390c88a418c2b01",
            "filename": "deps/openssl/openssl/apps/pkcs8.c",
            "status": "modified",
            "additions": 30,
            "deletions": 24,
            "changes": 54,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkcs8.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkcs8.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkcs8.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 1999-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1999-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -11,6 +11,7 @@\n #include <stdlib.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/pem.h>\n #include <openssl/err.h>\n #include <openssl/evp.h>\n@@ -24,10 +25,11 @@ typedef enum OPTION_choice {\n     OPT_SCRYPT, OPT_SCRYPT_N, OPT_SCRYPT_R, OPT_SCRYPT_P,\n #endif\n     OPT_V2, OPT_V1, OPT_V2PRF, OPT_ITER, OPT_PASSIN, OPT_PASSOUT,\n-    OPT_TRADITIONAL\n+    OPT_TRADITIONAL,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS pkcs8_options[] = {\n+const OPTIONS pkcs8_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"inform\", OPT_INFORM, 'F', \"Input format (DER or PEM)\"},\n     {\"outform\", OPT_OUTFORM, 'F', \"Output format (DER or PEM)\"},\n@@ -36,6 +38,7 @@ OPTIONS pkcs8_options[] = {\n     {\"topk8\", OPT_TOPK8, '-', \"Output PKCS8 file\"},\n     {\"noiter\", OPT_NOITER, '-', \"Use 1 as iteration count\"},\n     {\"nocrypt\", OPT_NOCRYPT, '-', \"Use or expect unencrypted private key\"},\n+    OPT_R_OPTIONS,\n     {\"v2\", OPT_V2, 's', \"Use PKCS#5 v2.0 and cipher\"},\n     {\"v1\", OPT_V1, 's', \"Use PKCS#5 v1.5 and cipher\"},\n     {\"v2prf\", OPT_V2PRF, 's', \"Set the PRF algorithm to use with PKCS#5 v2.0\"},\n@@ -65,7 +68,7 @@ int pkcs8_main(int argc, char **argv)\n     const EVP_CIPHER *cipher = NULL;\n     char *infile = NULL, *outfile = NULL;\n     char *passinarg = NULL, *passoutarg = NULL, *prog;\n-#ifndef OPENSSL_NO_UI\n+#ifndef OPENSSL_NO_UI_CONSOLE\n     char pass[APP_PASS_LEN];\n #endif\n     char *passin = NULL, *passout = NULL, *p8pass = NULL;\n@@ -112,6 +115,10 @@ int pkcs8_main(int argc, char **argv)\n         case OPT_NOCRYPT:\n             nocrypt = 1;\n             break;\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n+            break;\n         case OPT_TRADITIONAL:\n             traditional = 1;\n             break;\n@@ -196,7 +203,7 @@ int pkcs8_main(int argc, char **argv)\n \n     if (topk8) {\n         pkey = load_key(infile, informat, 1, passin, e, \"key\");\n-        if (!pkey)\n+        if (pkey == NULL)\n             goto end;\n         if ((p8inf = EVP_PKEY2PKCS8(pkey)) == NULL) {\n             BIO_printf(bio_err, \"Error converting key\\n\");\n@@ -205,11 +212,11 @@ int pkcs8_main(int argc, char **argv)\n         }\n         if (nocrypt) {\n             assert(private);\n-            if (outformat == FORMAT_PEM)\n+            if (outformat == FORMAT_PEM) {\n                 PEM_write_bio_PKCS8_PRIV_KEY_INFO(out, p8inf);\n-            else if (outformat == FORMAT_ASN1)\n+            } else if (outformat == FORMAT_ASN1) {\n                 i2d_PKCS8_PRIV_KEY_INFO_bio(out, p8inf);\n-            else {\n+            } else {\n                 BIO_printf(bio_err, \"Bad format specified for key\\n\");\n                 goto end;\n             }\n@@ -232,10 +239,11 @@ int pkcs8_main(int argc, char **argv)\n                 ERR_print_errors(bio_err);\n                 goto end;\n             }\n-            if (passout)\n+            if (passout != NULL) {\n                 p8pass = passout;\n-            else if (1) {\n-#ifndef OPENSSL_NO_UI\n+            } else if (1) {\n+                /* To avoid bit rot */\n+#ifndef OPENSSL_NO_UI_CONSOLE\n                 p8pass = pass;\n                 if (EVP_read_pw_string\n                     (pass, sizeof(pass), \"Enter Encryption Password:\", 1)) {\n@@ -247,15 +255,13 @@ int pkcs8_main(int argc, char **argv)\n                 BIO_printf(bio_err, \"Password required\\n\");\n                 goto end;\n             }\n-            app_RAND_load_file(NULL, 0);\n             p8 = PKCS8_set0_pbe(p8pass, strlen(p8pass), p8inf, pbe);\n             if (p8 == NULL) {\n                 X509_ALGOR_free(pbe);\n                 BIO_printf(bio_err, \"Error encrypting key\\n\");\n                 ERR_print_errors(bio_err);\n                 goto end;\n             }\n-            app_RAND_write_file(NULL);\n             assert(private);\n             if (outformat == FORMAT_PEM)\n                 PEM_write_bio_PKCS8(out, p8);\n@@ -272,33 +278,33 @@ int pkcs8_main(int argc, char **argv)\n     }\n \n     if (nocrypt) {\n-        if (informat == FORMAT_PEM)\n+        if (informat == FORMAT_PEM) {\n             p8inf = PEM_read_bio_PKCS8_PRIV_KEY_INFO(in, NULL, NULL, NULL);\n-        else if (informat == FORMAT_ASN1)\n+        } else if (informat == FORMAT_ASN1) {\n             p8inf = d2i_PKCS8_PRIV_KEY_INFO_bio(in, NULL);\n-        else {\n+        } else {\n             BIO_printf(bio_err, \"Bad format specified for key\\n\");\n             goto end;\n         }\n     } else {\n-        if (informat == FORMAT_PEM)\n+        if (informat == FORMAT_PEM) {\n             p8 = PEM_read_bio_PKCS8(in, NULL, NULL, NULL);\n-        else if (informat == FORMAT_ASN1)\n+        } else if (informat == FORMAT_ASN1) {\n             p8 = d2i_PKCS8_bio(in, NULL);\n-        else {\n+        } else {\n             BIO_printf(bio_err, \"Bad format specified for key\\n\");\n             goto end;\n         }\n \n-        if (!p8) {\n+        if (p8 == NULL) {\n             BIO_printf(bio_err, \"Error reading key\\n\");\n             ERR_print_errors(bio_err);\n             goto end;\n         }\n-        if (passin)\n+        if (passin != NULL) {\n             p8pass = passin;\n-        else if (1) {\n-#ifndef OPENSSL_NO_UI\n+        } else if (1) {\n+#ifndef OPENSSL_NO_UI_CONSOLE\n             p8pass = pass;\n             if (EVP_read_pw_string(pass, sizeof(pass), \"Enter Password:\", 0)) {\n                 BIO_printf(bio_err, \"Can't read Password\\n\");\n@@ -312,7 +318,7 @@ int pkcs8_main(int argc, char **argv)\n         p8inf = PKCS8_decrypt(p8, p8pass, strlen(p8pass));\n     }\n \n-    if (!p8inf) {\n+    if (p8inf == NULL) {\n         BIO_printf(bio_err, \"Error decrypting key\\n\");\n         ERR_print_errors(bio_err);\n         goto end;"
        },
        {
            "sha": "0dd5590bdc0bc7cc63a3500a2c7c879146048ff1",
            "filename": "deps/openssl/openssl/apps/pkey.c",
            "status": "modified",
            "additions": 48,
            "deletions": 5,
            "changes": 53,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkey.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkey.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkey.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -10,6 +10,7 @@\n #include <stdio.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/pem.h>\n #include <openssl/err.h>\n #include <openssl/evp.h>\n@@ -18,10 +19,10 @@ typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_INFORM, OPT_OUTFORM, OPT_PASSIN, OPT_PASSOUT, OPT_ENGINE,\n     OPT_IN, OPT_OUT, OPT_PUBIN, OPT_PUBOUT, OPT_TEXT_PUB,\n-    OPT_TEXT, OPT_NOOUT, OPT_MD, OPT_TRADITIONAL\n+    OPT_TEXT, OPT_NOOUT, OPT_MD, OPT_TRADITIONAL, OPT_CHECK, OPT_PUB_CHECK\n } OPTION_CHOICE;\n \n-OPTIONS pkey_options[] = {\n+const OPTIONS pkey_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"inform\", OPT_INFORM, 'f', \"Input format (DER or PEM)\"},\n     {\"outform\", OPT_OUTFORM, 'F', \"Output format (DER or PEM)\"},\n@@ -41,6 +42,8 @@ OPTIONS pkey_options[] = {\n #ifndef OPENSSL_NO_ENGINE\n     {\"engine\", OPT_ENGINE, 's', \"Use engine, possibly a hardware device\"},\n #endif\n+    {\"check\", OPT_CHECK, '-', \"Check key consistency\"},\n+    {\"pubcheck\", OPT_PUB_CHECK, '-', \"Check public key consistency\"},\n     {NULL}\n };\n \n@@ -55,7 +58,7 @@ int pkey_main(int argc, char **argv)\n     OPTION_CHOICE o;\n     int informat = FORMAT_PEM, outformat = FORMAT_PEM;\n     int pubin = 0, pubout = 0, pubtext = 0, text = 0, noout = 0, ret = 1;\n-    int private = 0, traditional = 0;\n+    int private = 0, traditional = 0, check = 0, pub_check = 0;\n \n     prog = opt_init(argc, argv, pkey_options);\n     while ((o = opt_next()) != OPT_EOF) {\n@@ -110,6 +113,12 @@ int pkey_main(int argc, char **argv)\n         case OPT_TRADITIONAL:\n             traditional = 1;\n             break;\n+        case OPT_CHECK:\n+            check = 1;\n+            break;\n+        case OPT_PUB_CHECK:\n+            pub_check = 1;\n+            break;\n         case OPT_MD:\n             if (!opt_cipher(opt_unknown(), &cipher))\n                 goto opthelp;\n@@ -136,9 +145,44 @@ int pkey_main(int argc, char **argv)\n         pkey = load_pubkey(infile, informat, 1, passin, e, \"Public Key\");\n     else\n         pkey = load_key(infile, informat, 1, passin, e, \"key\");\n-    if (!pkey)\n+    if (pkey == NULL)\n         goto end;\n \n+    if (check || pub_check) {\n+        int r;\n+        EVP_PKEY_CTX *ctx;\n+\n+        ctx = EVP_PKEY_CTX_new(pkey, e);\n+        if (ctx == NULL) {\n+            ERR_print_errors(bio_err);\n+            goto end;\n+        }\n+\n+        if (check)\n+            r = EVP_PKEY_check(ctx);\n+        else\n+            r = EVP_PKEY_public_check(ctx);\n+\n+        if (r == 1) {\n+            BIO_printf(out, \"Key is valid\\n\");\n+        } else {\n+            /*\n+             * Note: at least for RSA keys if this function returns\n+             * -1, there will be no error reasons.\n+             */\n+            unsigned long err;\n+\n+            BIO_printf(out, \"Key is invalid\\n\");\n+\n+            while ((err = ERR_peek_error()) != 0) {\n+                BIO_printf(out, \"Detailed error: %s\\n\",\n+                           ERR_reason_error_string(err));\n+                ERR_get_error(); /* remove err from error stack */\n+            }\n+        }\n+        EVP_PKEY_CTX_free(ctx);\n+    }\n+\n     if (!noout) {\n         if (outformat == FORMAT_PEM) {\n             if (pubout) {\n@@ -170,7 +214,6 @@ int pkey_main(int argc, char **argv)\n             BIO_printf(bio_err, \"Bad format specified for key\\n\");\n             goto end;\n         }\n-\n     }\n \n     if (text) {"
        },
        {
            "sha": "41c3f532b3450fa55ac62d724fe7cec8c151cffc",
            "filename": "deps/openssl/openssl/apps/pkeyparam.c",
            "status": "modified",
            "additions": 43,
            "deletions": 5,
            "changes": 48,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkeyparam.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkeyparam.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkeyparam.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 2006-2016 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 2006-2018 The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -10,16 +10,18 @@\n #include <stdio.h>\n #include <string.h>\n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/pem.h>\n #include <openssl/err.h>\n #include <openssl/evp.h>\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n-    OPT_IN, OPT_OUT, OPT_TEXT, OPT_NOOUT, OPT_ENGINE\n+    OPT_IN, OPT_OUT, OPT_TEXT, OPT_NOOUT,\n+    OPT_ENGINE, OPT_CHECK\n } OPTION_CHOICE;\n \n-OPTIONS pkeyparam_options[] = {\n+const OPTIONS pkeyparam_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"in\", OPT_IN, '<', \"Input file\"},\n     {\"out\", OPT_OUT, '>', \"Output file\"},\n@@ -28,6 +30,7 @@ OPTIONS pkeyparam_options[] = {\n #ifndef OPENSSL_NO_ENGINE\n     {\"engine\", OPT_ENGINE, 's', \"Use engine, possibly a hardware device\"},\n #endif\n+    {\"check\", OPT_CHECK, '-', \"Check key param consistency\"},\n     {NULL}\n };\n \n@@ -36,7 +39,7 @@ int pkeyparam_main(int argc, char **argv)\n     ENGINE *e = NULL;\n     BIO *in = NULL, *out = NULL;\n     EVP_PKEY *pkey = NULL;\n-    int text = 0, noout = 0, ret = 1;\n+    int text = 0, noout = 0, ret = 1, check = 0;\n     OPTION_CHOICE o;\n     char *infile = NULL, *outfile = NULL, *prog;\n \n@@ -67,6 +70,9 @@ int pkeyparam_main(int argc, char **argv)\n         case OPT_NOOUT:\n             noout = 1;\n             break;\n+        case OPT_CHECK:\n+            check = 1;\n+            break;\n         }\n     }\n     argc = opt_num_rest();\n@@ -80,12 +86,44 @@ int pkeyparam_main(int argc, char **argv)\n     if (out == NULL)\n         goto end;\n     pkey = PEM_read_bio_Parameters(in, NULL);\n-    if (!pkey) {\n+    if (pkey == NULL) {\n         BIO_printf(bio_err, \"Error reading parameters\\n\");\n         ERR_print_errors(bio_err);\n         goto end;\n     }\n \n+    if (check) {\n+        int r;\n+        EVP_PKEY_CTX *ctx;\n+\n+        ctx = EVP_PKEY_CTX_new(pkey, e);\n+        if (ctx == NULL) {\n+            ERR_print_errors(bio_err);\n+            goto end;\n+        }\n+\n+        r = EVP_PKEY_param_check(ctx);\n+\n+        if (r == 1) {\n+            BIO_printf(out, \"Parameters are valid\\n\");\n+        } else {\n+            /*\n+             * Note: at least for RSA keys if this function returns\n+             * -1, there will be no error reasons.\n+             */\n+            unsigned long err;\n+\n+            BIO_printf(out, \"Parameters are invalid\\n\");\n+\n+            while ((err = ERR_peek_error()) != 0) {\n+                BIO_printf(out, \"Detailed error: %s\\n\",\n+                           ERR_reason_error_string(err));\n+                ERR_get_error(); /* remove err from error stack */\n+            }\n+        }\n+        EVP_PKEY_CTX_free(ctx);\n+    }\n+\n     if (!noout)\n         PEM_write_bio_Parameters(out, pkey);\n "
        },
        {
            "sha": "2c4e524b693e4794b0e4d31bef8d371a490b2967",
            "filename": "deps/openssl/openssl/apps/pkeyutl.c",
            "status": "modified",
            "additions": 33,
            "deletions": 16,
            "changes": 49,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkeyutl.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkeyutl.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fpkeyutl.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -8,6 +8,7 @@\n  */\n \n #include \"apps.h\"\n+#include \"progs.h\"\n #include <string.h>\n #include <openssl/err.h>\n #include <openssl/pem.h>\n@@ -36,10 +37,11 @@ typedef enum OPTION_choice {\n     OPT_PUBIN, OPT_CERTIN, OPT_ASN1PARSE, OPT_HEXDUMP, OPT_SIGN,\n     OPT_VERIFY, OPT_VERIFYRECOVER, OPT_REV, OPT_ENCRYPT, OPT_DECRYPT,\n     OPT_DERIVE, OPT_SIGFILE, OPT_INKEY, OPT_PEERKEY, OPT_PASSIN,\n-    OPT_PEERFORM, OPT_KEYFORM, OPT_PKEYOPT, OPT_KDF, OPT_KDFLEN\n+    OPT_PEERFORM, OPT_KEYFORM, OPT_PKEYOPT, OPT_KDF, OPT_KDFLEN,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS pkeyutl_options[] = {\n+const OPTIONS pkeyutl_options[] = {\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"in\", OPT_IN, '<', \"Input file - default stdin\"},\n     {\"out\", OPT_OUT, '>', \"Output file - default stdout\"},\n@@ -64,6 +66,7 @@ OPTIONS pkeyutl_options[] = {\n     {\"peerform\", OPT_PEERFORM, 'E', \"Peer key format - default PEM\"},\n     {\"keyform\", OPT_KEYFORM, 'E', \"Private key format - default PEM\"},\n     {\"pkeyopt\", OPT_PKEYOPT, 's', \"Public key options as opt:value\"},\n+    OPT_R_OPTIONS,\n #ifndef OPENSSL_NO_ENGINE\n     {\"engine\", OPT_ENGINE, 's', \"Use engine, possibly a hardware device\"},\n     {\"engine_impl\", OPT_ENGINE_IMPL, '-',\n@@ -133,6 +136,10 @@ int pkeyutl_main(int argc, char **argv)\n             if (!opt_format(opt_arg(), OPT_FMT_PDE, &keyform))\n                 goto opthelp;\n             break;\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n+            break;\n         case OPT_ENGINE:\n             e = setup_engine(opt_arg(), 0);\n             break;\n@@ -234,21 +241,18 @@ int pkeyutl_main(int argc, char **argv)\n         }\n     }\n \n-    if (sigfile && (pkey_op != EVP_PKEY_OP_VERIFY)) {\n+    if (sigfile != NULL && (pkey_op != EVP_PKEY_OP_VERIFY)) {\n         BIO_printf(bio_err,\n                    \"%s: Signature file specified for non verify\\n\", prog);\n         goto end;\n     }\n \n-    if (!sigfile && (pkey_op == EVP_PKEY_OP_VERIFY)) {\n+    if (sigfile == NULL && (pkey_op == EVP_PKEY_OP_VERIFY)) {\n         BIO_printf(bio_err,\n                    \"%s: No signature file specified for verify\\n\", prog);\n         goto end;\n     }\n \n-/* FIXME: seed PRNG only if needed */\n-    app_RAND_load_file(NULL, 0);\n-\n     if (pkey_op != EVP_PKEY_OP_DERIVE) {\n         in = bio_open_default(infile, 'r', FORMAT_BINARY);\n         if (in == NULL)\n@@ -258,9 +262,10 @@ int pkeyutl_main(int argc, char **argv)\n     if (out == NULL)\n         goto end;\n \n-    if (sigfile) {\n+    if (sigfile != NULL) {\n         BIO *sigbio = BIO_new_file(sigfile, \"rb\");\n-        if (!sigbio) {\n+\n+        if (sigbio == NULL) {\n             BIO_printf(bio_err, \"Can't open signature file %s\\n\", sigfile);\n             goto end;\n         }\n@@ -272,12 +277,12 @@ int pkeyutl_main(int argc, char **argv)\n         }\n     }\n \n-    if (in) {\n+    if (in != NULL) {\n         /* Read the input data */\n         buf_inlen = bio_to_mem(&buf_in, keysize * 10, in);\n         if (buf_inlen < 0) {\n             BIO_printf(bio_err, \"Error reading input Data\\n\");\n-            exit(1);\n+            goto end;\n         }\n         if (rev) {\n             size_t i;\n@@ -291,14 +296,25 @@ int pkeyutl_main(int argc, char **argv)\n         }\n     }\n \n+    /* Sanity check the input */\n+    if (buf_inlen > EVP_MAX_MD_SIZE\n+            && (pkey_op == EVP_PKEY_OP_SIGN\n+                || pkey_op == EVP_PKEY_OP_VERIFY\n+                || pkey_op == EVP_PKEY_OP_VERIFYRECOVER)) {\n+        BIO_printf(bio_err,\n+                   \"Error: The input data looks too long to be a hash\\n\");\n+        goto end;\n+    }\n+\n     if (pkey_op == EVP_PKEY_OP_VERIFY) {\n         rv = EVP_PKEY_verify(ctx, sig, (size_t)siglen,\n                              buf_in, (size_t)buf_inlen);\n         if (rv == 1) {\n             BIO_puts(out, \"Signature Verified Successfully\\n\");\n             ret = 0;\n-        } else\n+        } else {\n             BIO_puts(out, \"Signature Verification Failure\\n\");\n+        }\n         goto end;\n     }\n     if (kdflen != 0) {\n@@ -328,10 +344,11 @@ int pkeyutl_main(int argc, char **argv)\n     if (asn1parse) {\n         if (!ASN1_parse_dump(out, buf_out, buf_outlen, 1, -1))\n             ERR_print_errors(bio_err);\n-    } else if (hexdump)\n+    } else if (hexdump) {\n         BIO_dump(out, (char *)buf_out, buf_outlen);\n-    else\n+    } else {\n         BIO_write(out, buf_out, buf_outlen);\n+    }\n \n  end:\n     EVP_PKEY_CTX_free(ctx);\n@@ -393,7 +410,7 @@ static EVP_PKEY_CTX *init_ctx(const char *kdfalg, int *pkeysize,\n         impl = e;\n #endif\n \n-    if (kdfalg) {\n+    if (kdfalg != NULL) {\n         int kdfnid = OBJ_sn2nid(kdfalg);\n \n         if (kdfnid == NID_undef) {\n@@ -463,7 +480,7 @@ static int setup_peer(EVP_PKEY_CTX *ctx, int peerform, const char *file,\n     if (peerform == FORMAT_ENGINE)\n         engine = e;\n     peer = load_pubkey(file, peerform, 0, NULL, engine, \"Peer Key\");\n-    if (!peer) {\n+    if (peer == NULL) {\n         BIO_printf(bio_err, \"Error reading peer key %s\\n\", file);\n         ERR_print_errors(bio_err);\n         return 0;"
        },
        {
            "sha": "6944797646962c369f3f7bed27c7f4086282c270",
            "filename": "deps/openssl/openssl/apps/prime.c",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fprime.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fprime.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fprime.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -10,14 +10,15 @@\n #include <string.h>\n \n #include \"apps.h\"\n+#include \"progs.h\"\n #include <openssl/bn.h>\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n     OPT_HEX, OPT_GENERATE, OPT_BITS, OPT_SAFE, OPT_CHECKS\n } OPTION_CHOICE;\n \n-OPTIONS prime_options[] = {\n+const OPTIONS prime_options[] = {\n     {OPT_HELP_STR, 1, '-', \"Usage: %s [options] [number...]\\n\"},\n     {OPT_HELP_STR, 1, '-',\n         \"  number Number to check for primality\\n\"},\n@@ -112,7 +113,7 @@ int prime_main(int argc, char **argv)\n             else\n                 r = BN_dec2bn(&bn, argv[0]);\n \n-            if(!r) {\n+            if (!r) {\n                 BIO_printf(bio_err, \"Failed to process value (%s)\\n\", argv[0]);\n                 goto end;\n             }"
        },
        {
            "sha": "57671405dda007dff588246e67e50b6f23d7d443",
            "filename": "deps/openssl/openssl/apps/progs.pl",
            "status": "modified",
            "additions": 91,
            "deletions": 74,
            "changes": 165,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fprogs.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fprogs.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fprogs.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -14,34 +14,36 @@\n use lib '.';\n use configdata qw/@disablables %unified_info/;\n \n-my %commands = ();\n-my $cmdre = qr/^\\s*int\\s+([a-z_][a-z0-9_]*)_main\\(\\s*int\\s+argc\\s*,/;\n-\n+my %commands     = ();\n+my $cmdre        = qr/^\\s*int\\s+([a-z_][a-z0-9_]*)_main\\(\\s*int\\s+argc\\s*,/;\n my $apps_openssl = shift @ARGV;\n+my $YEAR         = [localtime()]->[5] + 1900;\n+\n # because the program apps/openssl has object files as sources, and\n # they then have the corresponding C files as source, we need to chain\n # the lookups in %unified_info\n my @openssl_source =\n     map { @{$unified_info{sources}->{$_}} }\n-    @{$unified_info{sources}->{$apps_openssl}};\n+    grep { /\\.o$/ }\n+        @{$unified_info{sources}->{$apps_openssl}};\n \n foreach my $filename (@openssl_source) {\n-\topen F, $filename or die \"Couldn't open $filename: $!\\n\";\n-\tforeach (grep /$cmdre/, <F>) {\n-\t\tmy @foo = /$cmdre/;\n-\t\t$commands{$1} = 1;\n-\t}\n-\tclose F;\n+    open F, $filename or die \"Couldn't open $filename: $!\\n\";\n+    foreach ( grep /$cmdre/, <F> ) {\n+        my @foo = /$cmdre/;\n+        $commands{$1} = 1;\n+    }\n+    close F;\n }\n \n @ARGV = sort keys %commands;\n \n-print <<'EOF';\n+print <<\"EOF\";\n /*\n  * WARNING: do not edit!\n  * Generated by apps/progs.pl\n  *\n- * Copyright 1995-2018 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright 1995-$YEAR The OpenSSL Project Authors. All Rights Reserved.\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n@@ -66,17 +68,15 @@\n EOF\n \n foreach (@ARGV) {\n-\tprintf \"extern int %s_main(int argc, char *argv[]);\\n\", $_;\n+    printf \"extern int %s_main(int argc, char *argv[]);\\n\", $_;\n }\n-\n print \"\\n\";\n \n foreach (@ARGV) {\n-\tprintf \"extern OPTIONS %s_options[];\\n\", $_;\n+    printf \"extern const OPTIONS %s_options[];\\n\", $_;\n }\n+print \"\\n\";\n \n-print \"\\n#ifdef INCLUDE_FUNCTION_TABLE\\n\";\n-print \"static FUNCTION functions[] = {\\n\";\n my %cmd_disabler = (\n     ciphers  => \"sock\",\n     genrsa   => \"rsa\",\n@@ -87,78 +87,95 @@\n     dhparam  => \"dh\",\n     ecparam  => \"ec\",\n     pkcs12   => \"des\",\n-    );\n-foreach my $cmd (@ARGV) {\n-\tmy $str=\"    { FT_general, \\\"$cmd\\\", ${cmd}_main, ${cmd}_options },\\n\";\n-\tif ($cmd =~ /^s_/) {\n-\t\tprint \"#ifndef OPENSSL_NO_SOCK\\n${str}#endif\\n\";\n-\t} elsif (grep { $cmd eq $_ } @disablables) {\n-\t\tprint \"#ifndef OPENSSL_NO_\".uc($cmd).\"\\n${str}#endif\\n\";\n-\t} elsif (my $disabler = $cmd_disabler{$cmd}) {\n-\t\tprint \"#ifndef OPENSSL_NO_\".uc($disabler).\"\\n${str}#endif\\n\";\n-\t} else {\n-\t\tprint $str;\n-\t}\n+);\n+\n+print \"#ifdef INCLUDE_FUNCTION_TABLE\\n\";\n+print \"static FUNCTION functions[] = {\\n\";\n+foreach my $cmd ( @ARGV ) {\n+    my $str = \"    {FT_general, \\\"$cmd\\\", ${cmd}_main, ${cmd}_options},\\n\";\n+    if ($cmd =~ /^s_/) {\n+        print \"#ifndef OPENSSL_NO_SOCK\\n${str}#endif\\n\";\n+    } elsif (grep { $cmd eq $_ } @disablables) {\n+        print \"#ifndef OPENSSL_NO_\" . uc($cmd) . \"\\n${str}#endif\\n\";\n+    } elsif (my $disabler = $cmd_disabler{$cmd}) {\n+        print \"#ifndef OPENSSL_NO_\" . uc($disabler) . \"\\n${str}#endif\\n\";\n+    } else {\n+        print $str;\n+    }\n }\n \n my %md_disabler = (\n     blake2b512 => \"blake2\",\n     blake2s256 => \"blake2\",\n-    );\n+);\n foreach my $cmd (\n-\t\"md2\", \"md4\", \"md5\",\n-\t\"gost\",\n-\t\"sha1\", \"sha224\", \"sha256\", \"sha384\", \"sha512\",\n-\t\"mdc2\", \"rmd160\", \"blake2b512\", \"blake2s256\"\n+    \"md2\", \"md4\", \"md5\",\n+    \"gost\",\n+    \"sha1\", \"sha224\", \"sha256\", \"sha384\",\n+    \"sha512\", \"sha512-224\", \"sha512-256\",\n+    \"sha3-224\", \"sha3-256\", \"sha3-384\", \"sha3-512\",\n+    \"shake128\", \"shake256\",\n+    \"mdc2\", \"rmd160\", \"blake2b512\", \"blake2s256\",\n+    \"sm3\"\n ) {\n-        my $str = \"    { FT_md, \\\"\".$cmd.\"\\\", dgst_main},\\n\";\n-        if (grep { $cmd eq $_ } @disablables) {\n-                print \"#ifndef OPENSSL_NO_\".uc($cmd).\"\\n${str}#endif\\n\";\n-        } elsif (my $disabler = $md_disabler{$cmd}) {\n-                print \"#ifndef OPENSSL_NO_\".uc($disabler).\"\\n${str}#endif\\n\";\n-        } else {\n-                print $str;\n-        }\n+    my $str = \"    {FT_md, \\\"$cmd\\\", dgst_main},\\n\";\n+    if (grep { $cmd eq $_ } @disablables) {\n+        print \"#ifndef OPENSSL_NO_\" . uc($cmd) . \"\\n${str}#endif\\n\";\n+    } elsif (my $disabler = $md_disabler{$cmd}) {\n+        print \"#ifndef OPENSSL_NO_\" . uc($disabler) . \"\\n${str}#endif\\n\";\n+    } else {\n+        print $str;\n+    }\n }\n \n my %cipher_disabler = (\n     des3  => \"des\",\n     desx  => \"des\",\n     cast5 => \"cast\",\n-    );\n+);\n foreach my $cmd (\n-\t\"aes-128-cbc\", \"aes-128-ecb\",\n-\t\"aes-192-cbc\", \"aes-192-ecb\",\n-\t\"aes-256-cbc\", \"aes-256-ecb\",\n-\t\"camellia-128-cbc\", \"camellia-128-ecb\",\n-\t\"camellia-192-cbc\", \"camellia-192-ecb\",\n-\t\"camellia-256-cbc\", \"camellia-256-ecb\",\n-\t\"base64\", \"zlib\",\n-\t\"des\", \"des3\", \"desx\", \"idea\", \"seed\", \"rc4\", \"rc4-40\",\n-\t\"rc2\", \"bf\", \"cast\", \"rc5\",\n-\t\"des-ecb\", \"des-ede\",    \"des-ede3\",\n-\t\"des-cbc\", \"des-ede-cbc\",\"des-ede3-cbc\",\n-\t\"des-cfb\", \"des-ede-cfb\",\"des-ede3-cfb\",\n-\t\"des-ofb\", \"des-ede-ofb\",\"des-ede3-ofb\",\n-\t\"idea-cbc\",\"idea-ecb\",    \"idea-cfb\", \"idea-ofb\",\n-\t\"seed-cbc\",\"seed-ecb\",    \"seed-cfb\", \"seed-ofb\",\n-\t\"rc2-cbc\", \"rc2-ecb\", \"rc2-cfb\",\"rc2-ofb\", \"rc2-64-cbc\", \"rc2-40-cbc\",\n-\t\"bf-cbc\",  \"bf-ecb\",     \"bf-cfb\",   \"bf-ofb\",\n-\t\"cast5-cbc\",\"cast5-ecb\", \"cast5-cfb\",\"cast5-ofb\",\n-\t\"cast-cbc\", \"rc5-cbc\",   \"rc5-ecb\",  \"rc5-cfb\",  \"rc5-ofb\"\n+    \"aes-128-cbc\", \"aes-128-ecb\",\n+    \"aes-192-cbc\", \"aes-192-ecb\",\n+    \"aes-256-cbc\", \"aes-256-ecb\",\n+    \"aria-128-cbc\", \"aria-128-cfb\",\n+    \"aria-128-ctr\", \"aria-128-ecb\", \"aria-128-ofb\",\n+    \"aria-128-cfb1\", \"aria-128-cfb8\",\n+    \"aria-192-cbc\", \"aria-192-cfb\",\n+    \"aria-192-ctr\", \"aria-192-ecb\", \"aria-192-ofb\",\n+    \"aria-192-cfb1\", \"aria-192-cfb8\",\n+    \"aria-256-cbc\", \"aria-256-cfb\",\n+    \"aria-256-ctr\", \"aria-256-ecb\", \"aria-256-ofb\",\n+    \"aria-256-cfb1\", \"aria-256-cfb8\",\n+    \"camellia-128-cbc\", \"camellia-128-ecb\",\n+    \"camellia-192-cbc\", \"camellia-192-ecb\",\n+    \"camellia-256-cbc\", \"camellia-256-ecb\",\n+    \"base64\", \"zlib\",\n+    \"des\", \"des3\", \"desx\", \"idea\", \"seed\", \"rc4\", \"rc4-40\",\n+    \"rc2\", \"bf\", \"cast\", \"rc5\",\n+    \"des-ecb\", \"des-ede\", \"des-ede3\",\n+    \"des-cbc\", \"des-ede-cbc\",\"des-ede3-cbc\",\n+    \"des-cfb\", \"des-ede-cfb\",\"des-ede3-cfb\",\n+    \"des-ofb\", \"des-ede-ofb\",\"des-ede3-ofb\",\n+    \"idea-cbc\",\"idea-ecb\", \"idea-cfb\", \"idea-ofb\",\n+    \"seed-cbc\",\"seed-ecb\", \"seed-cfb\", \"seed-ofb\",\n+    \"rc2-cbc\", \"rc2-ecb\", \"rc2-cfb\",\"rc2-ofb\", \"rc2-64-cbc\", \"rc2-40-cbc\",\n+    \"bf-cbc\", \"bf-ecb\", \"bf-cfb\", \"bf-ofb\",\n+    \"cast5-cbc\",\"cast5-ecb\", \"cast5-cfb\",\"cast5-ofb\",\n+    \"cast-cbc\", \"rc5-cbc\", \"rc5-ecb\", \"rc5-cfb\", \"rc5-ofb\",\n+    \"sm4-cbc\", \"sm4-ecb\", \"sm4-cfb\", \"sm4-ofb\", \"sm4-ctr\"\n ) {\n-\tmy $str=\"    { FT_cipher, \\\"$cmd\\\", enc_main, enc_options },\\n\";\n-\t(my $algo= $cmd) =~ s/-.*//g;\n-        if ($cmd eq \"zlib\") {\n-                print \"#ifdef ZLIB\\n${str}#endif\\n\";\n-        } elsif (grep { $algo eq $_ } @disablables) {\n-                print \"#ifndef OPENSSL_NO_\".uc($algo).\"\\n${str}#endif\\n\";\n-        } elsif (my $disabler = $cipher_disabler{$algo}) {\n-                print \"#ifndef OPENSSL_NO_\".uc($disabler).\"\\n${str}#endif\\n\";\n-\t} else {\n-\t\tprint $str;\n-\t}\n+    my $str = \"    {FT_cipher, \\\"$cmd\\\", enc_main, enc_options},\\n\";\n+    (my $algo = $cmd) =~ s/-.*//g;\n+    if ($cmd eq \"zlib\") {\n+        print \"#ifdef ZLIB\\n${str}#endif\\n\";\n+    } elsif (grep { $algo eq $_ } @disablables) {\n+        print \"#ifndef OPENSSL_NO_\" . uc($algo) . \"\\n${str}#endif\\n\";\n+    } elsif (my $disabler = $cipher_disabler{$algo}) {\n+        print \"#ifndef OPENSSL_NO_\" . uc($disabler) . \"\\n${str}#endif\\n\";\n+    } else {\n+        print $str;\n+    }\n }\n \n-print \"    { 0, NULL, NULL}\\n};\\n\";\n+print \"    {0, NULL, NULL}\\n};\\n\";\n print \"#endif\\n\";"
        },
        {
            "sha": "4c6181507bd5af6de183cd8004d1e8579d59441f",
            "filename": "deps/openssl/openssl/apps/rand.c",
            "status": "modified",
            "additions": 11,
            "deletions": 14,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Frand.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Frand.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Frand.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -8,6 +8,7 @@\n  */\n \n #include \"apps.h\"\n+#include \"progs.h\"\n \n #include <ctype.h>\n #include <stdio.h>\n@@ -19,16 +20,16 @@\n \n typedef enum OPTION_choice {\n     OPT_ERR = -1, OPT_EOF = 0, OPT_HELP,\n-    OPT_OUT, OPT_ENGINE, OPT_RAND, OPT_BASE64, OPT_HEX\n+    OPT_OUT, OPT_ENGINE, OPT_BASE64, OPT_HEX,\n+    OPT_R_ENUM\n } OPTION_CHOICE;\n \n-OPTIONS rand_options[] = {\n+const OPTIONS rand_options[] = {\n     {OPT_HELP_STR, 1, '-', \"Usage: %s [flags] num\\n\"},\n     {OPT_HELP_STR, 1, '-', \"Valid options are:\\n\"},\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n     {\"out\", OPT_OUT, '>', \"Output file\"},\n-    {\"rand\", OPT_RAND, 's',\n-     \"Load the file(s) into the random number generator\"},\n+    OPT_R_OPTIONS,\n     {\"base64\", OPT_BASE64, '-', \"Base64 encode output\"},\n     {\"hex\", OPT_HEX, '-', \"Hex encode output\"},\n #ifndef OPENSSL_NO_ENGINE\n@@ -41,7 +42,7 @@ int rand_main(int argc, char **argv)\n {\n     ENGINE *e = NULL;\n     BIO *out = NULL;\n-    char *inrand = NULL, *outfile = NULL, *prog;\n+    char *outfile = NULL, *prog;\n     OPTION_CHOICE o;\n     int format = FORMAT_BINARY, i, num = -1, r, ret = 1;\n \n@@ -63,8 +64,9 @@ int rand_main(int argc, char **argv)\n         case OPT_ENGINE:\n             e = setup_engine(opt_arg(), 0);\n             break;\n-        case OPT_RAND:\n-            inrand = opt_arg();\n+        case OPT_R_CASES:\n+            if (!opt_rand(o))\n+                goto end;\n             break;\n         case OPT_BASE64:\n             format = FORMAT_BASE64;\n@@ -84,11 +86,6 @@ int rand_main(int argc, char **argv)\n         goto opthelp;\n     }\n \n-    app_RAND_load_file(NULL, (inrand != NULL));\n-    if (inrand != NULL)\n-        BIO_printf(bio_err, \"%ld semi-random bytes loaded\\n\",\n-                   app_RAND_load_files(inrand));\n-\n     out = bio_open_default(outfile, 'w', format);\n     if (out == NULL)\n         goto end;\n@@ -122,7 +119,7 @@ int rand_main(int argc, char **argv)\n     }\n     if (format == FORMAT_TEXT)\n         BIO_puts(out, \"\\n\");\n-    if (BIO_flush(out) <= 0 || !app_RAND_write_file(NULL))\n+    if (BIO_flush(out) <= 0)\n         goto end;\n \n     ret = 0;\n@@ -132,5 +129,5 @@ int rand_main(int argc, char **argv)\n         ERR_print_errors(bio_err);\n     release_engine(e);\n     BIO_free_all(out);\n-    return (ret);\n+    return ret;\n }"
        },
        {
            "sha": "bb41d3129f9c518566bb4c1f072d803c6856b87a",
            "filename": "deps/openssl/openssl/apps/rehash.c",
            "status": "modified",
            "additions": 19,
            "deletions": 38,
            "changes": 57,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Frehash.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Frehash.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Frehash.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b",
            "patch": "@@ -1,19 +1,15 @@\n /*\n  * Copyright 2015-2018 The OpenSSL Project Authors. All Rights Reserved.\n+ * Copyright (c) 2013-2014 Timo Teräs <timo.teras@gmail.com>\n  *\n  * Licensed under the OpenSSL license (the \"License\").  You may not use\n  * this file except in compliance with the License.  You can obtain a copy\n  * in the file LICENSE in the source distribution or at\n  * https://www.openssl.org/source/license.html\n  */\n \n-/*\n- * C implementation based on the original Perl and shell versions\n- *\n- * Copyright (c) 2013-2014 Timo Teräs <timo.teras@iki.fi>\n- */\n-\n #include \"apps.h\"\n+#include \"progs.h\"\n \n #if defined(OPENSSL_SYS_UNIX) || defined(__APPLE__) || \\\n     (defined(__VMS) && defined(__DECC) && __CRTL_VER >= 80300000)\n@@ -255,19 +251,19 @@ static int do_file(const char *filename, const char *fullpath, enum Hash h)\n         goto end;\n     }\n     x = sk_X509_INFO_value(inf, 0);\n-    if (x->x509) {\n+    if (x->x509 != NULL) {\n         type = TYPE_CERT;\n         name = X509_get_subject_name(x->x509);\n         X509_digest(x->x509, evpmd, digest, NULL);\n-    } else if (x->crl) {\n+    } else if (x->crl != NULL) {\n         type = TYPE_CRL;\n         name = X509_CRL_get_issuer(x->crl);\n         X509_CRL_digest(x->crl, evpmd, digest, NULL);\n     } else {\n         ++errs;\n         goto end;\n     }\n-    if (name) {\n+    if (name != NULL) {\n         if ((h == HASH_NEW) || (h == HASH_BOTH))\n             errs += add_entry(type, X509_NAME_hash(name), filename, digest, 1, ~0);\n         if ((h == HASH_OLD) || (h == HASH_BOTH))\n@@ -298,24 +294,6 @@ static int ends_with_dirsep(const char *path)\n     return *path == '/';\n }\n \n-static int massage_filename(char *name)\n-{\n-# ifdef __VMS\n-    char *p = strchr(name, ';');\n-    char *q = p;\n-\n-    if (q != NULL) {\n-        for (q++; *q != '\\0'; q++) {\n-            if (!isdigit((unsigned char)*q))\n-                return 1;\n-        }\n-    }\n-\n-    *p = '\\0';\n-# endif\n-    return 1;\n-}\n-\n /*\n  * Process a directory; return number of errors found.\n  */\n@@ -330,7 +308,7 @@ static int do_dir(const char *dirname, enum Hash h)\n     size_t i;\n     const char *pathsep;\n     const char *filename;\n-    char *buf, *copy;\n+    char *buf, *copy = NULL;\n     STACK_OF(OPENSSL_STRING) *files = NULL;\n \n     if (app_access(dirname, W_OK) < 0) {\n@@ -347,14 +325,16 @@ static int do_dir(const char *dirname, enum Hash h)\n \n     if ((files = sk_OPENSSL_STRING_new_null()) == NULL) {\n         BIO_printf(bio_err, \"Skipping %s, out of memory\\n\", dirname);\n-        exit(1);\n+        errs = 1;\n+        goto err;\n     }\n     while ((filename = OPENSSL_DIR_read(&d, dirname)) != NULL) {\n-        if ((copy = strdup(filename)) == NULL\n-                || !massage_filename(copy)\n+        if ((copy = OPENSSL_strdup(filename)) == NULL\n                 || sk_OPENSSL_STRING_push(files, copy) == 0) {\n+            OPENSSL_free(copy);\n             BIO_puts(bio_err, \"out of memory\\n\");\n-            exit(1);\n+            errs = 1;\n+            goto err;\n         }\n     }\n     OPENSSL_DIR_end(&d);\n@@ -372,7 +352,6 @@ static int do_dir(const char *dirname, enum Hash h)\n             continue;\n         errs += do_file(filename, buf, h);\n     }\n-    sk_OPENSSL_STRING_pop_free(files, str_free);\n \n     for (i = 0; i < OSSL_NELEM(hash_table); i++) {\n         for (bp = hash_table[i]; bp; bp = nextbp) {\n@@ -440,6 +419,8 @@ static int do_dir(const char *dirname, enum Hash h)\n         hash_table[i] = NULL;\n     }\n \n+ err:\n+    sk_OPENSSL_STRING_pop_free(files, str_free);\n     OPENSSL_free(buf);\n     return errs;\n }\n@@ -449,7 +430,7 @@ typedef enum OPTION_choice {\n     OPT_COMPAT, OPT_OLD, OPT_N, OPT_VERBOSE\n } OPTION_CHOICE;\n \n-OPTIONS rehash_options[] = {\n+const OPTIONS rehash_options[] = {\n     {OPT_HELP_STR, 1, '-', \"Usage: %s [options] [cert-directory...]\\n\"},\n     {OPT_HELP_STR, 1, '-', \"Valid options are:\\n\"},\n     {\"help\", OPT_HELP, '-', \"Display this summary\"},\n@@ -500,8 +481,8 @@ int rehash_main(int argc, char **argv)\n     evpmd = EVP_sha1();\n     evpmdsize = EVP_MD_size(evpmd);\n \n-    if (*argv) {\n-        while (*argv)\n+    if (*argv != NULL) {\n+        while (*argv != NULL)\n             errs += do_dir(*argv++, h);\n     } else if ((env = getenv(X509_get_default_cert_dir_env())) != NULL) {\n         char lsc[2] = { LIST_SEPARATOR_CHAR, '\\0' };\n@@ -518,14 +499,14 @@ int rehash_main(int argc, char **argv)\n }\n \n #else\n-OPTIONS rehash_options[] = {\n+const OPTIONS rehash_options[] = {\n     {NULL}\n };\n \n int rehash_main(int argc, char **argv)\n {\n     BIO_printf(bio_err, \"Not available; use c_rehash script\\n\");\n-    return (1);\n+    return 1;\n }\n \n #endif /* defined(OPENSSL_SYS_UNIX) || defined(__APPLE__) */"
        },
        {
            "sha": "6fd28a2aba240656e8480921d7d584fc6b321df8",
            "filename": "deps/openssl/openssl/apps/req.c",
            "status": "modified",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Freq.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Freq.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Freq.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "fdd02dce32419a764ac7e7b7fc9eaa4fd4b80409",
            "filename": "deps/openssl/openssl/apps/rsa.c",
            "status": "modified",
            "additions": 19,
            "deletions": 13,
            "changes": 32,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Frsa.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Frsa.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Frsa.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "5da8504d3c061fe8bceb693fff2c8154725b30a9",
            "filename": "deps/openssl/openssl/apps/rsautl.c",
            "status": "modified",
            "additions": 15,
            "deletions": 11,
            "changes": 26,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Frsautl.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Frsautl.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Frsautl.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0a3bc962808be2ab6360c1942465c58522de8fba",
            "filename": "deps/openssl/openssl/apps/s_apps.h",
            "status": "modified",
            "additions": 19,
            "deletions": 32,
            "changes": 51,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_apps.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_apps.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_apps.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "2d4568f40ccbc1eeb8d20fc2b5e15666c7e432cc",
            "filename": "deps/openssl/openssl/apps/s_cb.c",
            "status": "modified",
            "additions": 266,
            "deletions": 120,
            "changes": 386,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_cb.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_cb.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_cb.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "dcaa10cf44ebae4de0d828dcd4508692ad26526a",
            "filename": "deps/openssl/openssl/apps/s_client.c",
            "status": "modified",
            "additions": 912,
            "deletions": 208,
            "changes": 1120,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_client.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_client.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_client.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ac7dca607ba471f7fc90c72b43acda28ecf265ed",
            "filename": "deps/openssl/openssl/apps/s_server.c",
            "status": "modified",
            "additions": 602,
            "deletions": 291,
            "changes": 893,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_server.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_server.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_server.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "76f9289002076254ad84be0f863498d4297c84ee",
            "filename": "deps/openssl/openssl/apps/s_socket.c",
            "status": "modified",
            "additions": 174,
            "deletions": 29,
            "changes": 203,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_socket.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_socket.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_socket.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "82d40a5a513246acf7e47642a4864bc6e489bed9",
            "filename": "deps/openssl/openssl/apps/s_time.c",
            "status": "modified",
            "additions": 47,
            "deletions": 27,
            "changes": 74,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_time.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_time.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_time.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "8fd584f3b131196025126cc2fee213e22e37ef4b",
            "filename": "deps/openssl/openssl/apps/sess_id.c",
            "status": "modified",
            "additions": 15,
            "deletions": 14,
            "changes": 29,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fsess_id.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fsess_id.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fsess_id.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "6fd473775f45a4ac7fb49823c8e4949be391d82d",
            "filename": "deps/openssl/openssl/apps/smime.c",
            "status": "modified",
            "additions": 57,
            "deletions": 66,
            "changes": 123,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fsmime.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fsmime.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fsmime.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "40e990408ab92fa73d5b92c02ad15fb651f3d5b2",
            "filename": "deps/openssl/openssl/apps/speed.c",
            "status": "modified",
            "additions": 1046,
            "deletions": 499,
            "changes": 1545,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fspeed.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fspeed.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fspeed.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "f384af6eb60b0bbc82fa9886fefb0ba2c73b01e0",
            "filename": "deps/openssl/openssl/apps/spkac.c",
            "status": "modified",
            "additions": 12,
            "deletions": 6,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fspkac.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fspkac.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fspkac.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "689574a4854c846866805d174369a96e8c499d7e",
            "filename": "deps/openssl/openssl/apps/srp.c",
            "status": "modified",
            "additions": 25,
            "deletions": 25,
            "changes": 50,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fsrp.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fsrp.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fsrp.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "50007f6e8b69eea044a55ebe9a39c4ce75c2d3b1",
            "filename": "deps/openssl/openssl/apps/storeutl.c",
            "status": "added",
            "additions": 473,
            "deletions": 0,
            "changes": 473,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fstoreutl.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fstoreutl.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fstoreutl.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "3c4b459db117e822fc6f557b87f1d79ca7a28bb9",
            "filename": "deps/openssl/openssl/apps/testdsa.h",
            "status": "modified",
            "additions": 52,
            "deletions": 82,
            "changes": 134,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Ftestdsa.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Ftestdsa.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Ftestdsa.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "930c1daaab6d4369a82ceb192acae2b9880c7e1d",
            "filename": "deps/openssl/openssl/apps/ts.c",
            "status": "modified",
            "additions": 26,
            "deletions": 35,
            "changes": 61,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fts.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fts.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fts.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "bec365e28ce546a5bec093ba671788a55c3cadad",
            "filename": "deps/openssl/openssl/apps/tsget.in",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Ftsget.in",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Ftsget.in",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Ftsget.in?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "38377a57e4a9f7ad5bfc2b968453e2554726d31f",
            "filename": "deps/openssl/openssl/apps/verify.c",
            "status": "modified",
            "additions": 14,
            "deletions": 8,
            "changes": 22,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fverify.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fverify.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fverify.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "2aca1636152bb263ba36b978a49ecec8fcf1fa14",
            "filename": "deps/openssl/openssl/apps/version.c",
            "status": "modified",
            "additions": 57,
            "deletions": 8,
            "changes": 65,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fversion.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fversion.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fversion.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "9a90a1e7901254212a9dc148b4de38f65da9c39d",
            "filename": "deps/openssl/openssl/apps/vms_term_sock.c",
            "status": "modified",
            "additions": 18,
            "deletions": 17,
            "changes": 35,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fvms_term_sock.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fvms_term_sock.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fvms_term_sock.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c4d1702d799ecc7d7c0a8138a21df10519aaa36a",
            "filename": "deps/openssl/openssl/apps/vms_term_sock.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fvms_term_sock.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fvms_term_sock.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fvms_term_sock.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "df4bff41a24dea4df475c4fa361d5646d1ec342d",
            "filename": "deps/openssl/openssl/apps/win32_init.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fwin32_init.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fwin32_init.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fwin32_init.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "81291a9a4f90f2c01fe5bbfd5f2bbd2531a671e1",
            "filename": "deps/openssl/openssl/apps/x509.c",
            "status": "modified",
            "additions": 178,
            "deletions": 81,
            "changes": 259,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fx509.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fapps%2Fx509.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fx509.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "24966c0faa5ce46f5ba49c6f048a5ca37b93b8ab",
            "filename": "deps/openssl/openssl/appveyor.yml",
            "status": "modified",
            "additions": 32,
            "deletions": 11,
            "changes": 43,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fappveyor.yml",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fappveyor.yml",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fappveyor.yml?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "3dda4e89bf5cc5c23b665b3712c9cbfab98ab3a6",
            "filename": "deps/openssl/openssl/build.info",
            "status": "modified",
            "additions": 72,
            "deletions": 10,
            "changes": 82,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fbuild.info",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fbuild.info",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fbuild.info?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b8adf3499953d4cb3eb6f10f299fb7e2bb0f37d7",
            "filename": "deps/openssl/openssl/config",
            "status": "modified",
            "additions": 94,
            "deletions": 82,
            "changes": 176,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fconfig",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fconfig",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fconfig?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b02449f7c04af4c4dc1775a63ad737b809715a80",
            "filename": "deps/openssl/openssl/crypto/LPdir_nyi.c",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_nyi.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_nyi.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_nyi.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b1022895c85540003cd82cde9f55ea379d2a35c3",
            "filename": "deps/openssl/openssl/crypto/LPdir_unix.c",
            "status": "modified",
            "additions": 41,
            "deletions": 3,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_unix.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_unix.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_unix.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e35363fd6614443db7984517be54554739a4381a",
            "filename": "deps/openssl/openssl/crypto/LPdir_vms.c",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_vms.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_vms.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_vms.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1dc1ef122c0c460d53b898fe7fa7c21028cbc758",
            "filename": "deps/openssl/openssl/crypto/LPdir_win.c",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_win.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_win.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_win.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "edceb98d6f81fd5b766ed2a5bdf374f8e46821ff",
            "filename": "deps/openssl/openssl/crypto/LPdir_win32.c",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_win32.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_win32.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_win32.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "a24e73829289bac2a75622fcc818a3e7e2125dab",
            "filename": "deps/openssl/openssl/crypto/LPdir_wince.c",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_wince.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_wince.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2FLPdir_wince.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "f1f11fd8de7bf5f9bcacb3c5ba7fa13da65dfd15",
            "filename": "deps/openssl/openssl/crypto/aes/aes_core.c",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Faes_core.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Faes_core.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Faes_core.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1b660d716d6c18baa13b5f7a2d114b95d583ce26",
            "filename": "deps/openssl/openssl/crypto/aes/aes_x86core.c",
            "status": "modified",
            "additions": 11,
            "deletions": 12,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Faes_x86core.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Faes_x86core.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Faes_x86core.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "29059edf8b7a6bfacf9dfa02769e630a9db27f2a",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aes-586.pl",
            "status": "modified",
            "additions": 17,
            "deletions": 17,
            "changes": 34,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-586.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-586.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-586.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "03f79b7ae3b777853195287beefa083767825f43",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aes-ia64.S",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-ia64.S",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-ia64.S",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-ia64.S?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "716c3356ead90c0d39249441082fc6be4cab7d73",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aes-mips.pl",
            "status": "modified",
            "additions": 68,
            "deletions": 29,
            "changes": 97,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-mips.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-mips.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-mips.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e817c757f8c28215e4688cbdc50d25db04689768",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aes-parisc.pl",
            "status": "modified",
            "additions": 12,
            "deletions": 3,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-parisc.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-parisc.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-parisc.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ca69df4c3e95bd30bf545e94a575ff0f5fa8a1f5",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aes-ppc.pl",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-ppc.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-ppc.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-ppc.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0c40059066508dfc73d6b3cdb0e391a03b745c74",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aes-s390x.pl",
            "status": "modified",
            "additions": 78,
            "deletions": 22,
            "changes": 100,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-s390x.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-s390x.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-s390x.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "40d1f94ccd7213f150a43136ef3355ddbb4d5b6f",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aes-sparcv9.pl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-sparcv9.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-sparcv9.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-sparcv9.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "4d1dc9c70199db0f8bd5b87d5c46b04d1df76823",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aes-x86_64.pl",
            "status": "modified",
            "additions": 108,
            "deletions": 26,
            "changes": 134,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-x86_64.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-x86_64.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faes-x86_64.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "9ddf0b4b00ecbe528b1cbdbdc61a66e8a218cf24",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aesfx-sparcv9.pl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesfx-sparcv9.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesfx-sparcv9.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesfx-sparcv9.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1f356d2d3fbb615ee918ec4e6cb48ad77c575c7a",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aesni-mb-x86_64.pl",
            "status": "modified",
            "additions": 90,
            "deletions": 18,
            "changes": 108,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-mb-x86_64.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-mb-x86_64.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-mb-x86_64.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b01a4c55c86aed96b54d752e2539b31ab6b5aeb6",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aesni-sha1-x86_64.pl",
            "status": "modified",
            "additions": 69,
            "deletions": 1,
            "changes": 70,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-sha1-x86_64.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-sha1-x86_64.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-sha1-x86_64.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ef460237108ec4bdeb3aa620e542d67576114191",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aesni-sha256-x86_64.pl",
            "status": "modified",
            "additions": 83,
            "deletions": 30,
            "changes": 113,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-sha256-x86_64.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-sha256-x86_64.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-sha256-x86_64.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b351fca28e023f4060ecdee00c62cb840cf2c2b0",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aesni-x86.pl",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-x86.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-x86.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-x86.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "2a202c53e5f841d93e8f6d04b4d8625481a11cb7",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aesni-x86_64.pl",
            "status": "modified",
            "additions": 217,
            "deletions": 152,
            "changes": 369,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-x86_64.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-x86_64.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesni-x86_64.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "488b133250c677edd34a98d3fd15ae9c8e5ae6ad",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aesp8-ppc.pl",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesp8-ppc.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesp8-ppc.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesp8-ppc.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "54d0c58821a7f47aff5d155d8b03cc9fa305e0da",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aest4-sparcv9.pl",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faest4-sparcv9.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faest4-sparcv9.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faest4-sparcv9.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "8b37cfc452a02d57f83f666b49a4960dc8570464",
            "filename": "deps/openssl/openssl/crypto/aes/asm/aesv8-armx.pl",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesv8-armx.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesv8-armx.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Faesv8-armx.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "bfe825af0d92b8c0b8f5ba53aed639de76765cff",
            "filename": "deps/openssl/openssl/crypto/aes/asm/bsaes-armv7.pl",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fbsaes-armv7.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fbsaes-armv7.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fbsaes-armv7.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "2c79c2b67c897d60eca6ea0a5d28af75e4ca3f84",
            "filename": "deps/openssl/openssl/crypto/aes/asm/bsaes-x86_64.pl",
            "status": "modified",
            "additions": 197,
            "deletions": 75,
            "changes": 272,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fbsaes-x86_64.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fbsaes-x86_64.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fbsaes-x86_64.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "5131e13a09a29523d3c8c92ae5ecafa679304968",
            "filename": "deps/openssl/openssl/crypto/aes/asm/vpaes-armv8.pl",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-armv8.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-armv8.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-armv8.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "3c771a7e98b1c2af3d68e92fb6318667a16b2c07",
            "filename": "deps/openssl/openssl/crypto/aes/asm/vpaes-ppc.pl",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-ppc.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-ppc.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-ppc.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "7d57edc0eb6c1090838b50ac367a978f64b07118",
            "filename": "deps/openssl/openssl/crypto/aes/asm/vpaes-x86.pl",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-x86.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-x86.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-x86.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b715aca167d170f6dc0224776c807e3bc789375a",
            "filename": "deps/openssl/openssl/crypto/aes/asm/vpaes-x86_64.pl",
            "status": "modified",
            "additions": 10,
            "deletions": 10,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-x86_64.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-x86_64.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fasm%2Fvpaes-x86_64.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0f04863640def6bd905cc838a085efb2be1b6516",
            "filename": "deps/openssl/openssl/crypto/aes/build.info",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fbuild.info",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fbuild.info",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faes%2Fbuild.info?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "293bcc72bd03bcb4d634fa2888e37bc938540aaa",
            "filename": "deps/openssl/openssl/crypto/aria/aria.c",
            "status": "added",
            "additions": 1212,
            "deletions": 0,
            "changes": 1212,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faria%2Faria.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faria%2Faria.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faria%2Faria.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "218d0612f74735961945e44d78c0a8737e0d9add",
            "filename": "deps/openssl/openssl/crypto/aria/build.info",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faria%2Fbuild.info",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faria%2Fbuild.info",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Faria%2Fbuild.info?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "06c8add7a07561f1f00b2e5edb6826881771ba83",
            "filename": "deps/openssl/openssl/crypto/arm64cpuid.pl",
            "status": "modified",
            "additions": 22,
            "deletions": 1,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Farm64cpuid.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Farm64cpuid.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Farm64cpuid.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "f11b543df64f0ca5edbff10eff5cda19c8c1e571",
            "filename": "deps/openssl/openssl/crypto/arm_arch.h",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Farm_arch.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Farm_arch.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Farm_arch.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1b3c2722d1e168e249a686bb30886323c7b26e9d",
            "filename": "deps/openssl/openssl/crypto/armcap.c",
            "status": "modified",
            "additions": 20,
            "deletions": 5,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Farmcap.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Farmcap.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Farmcap.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "bffbd160a233ee83061f264a2fb64665150f3d77",
            "filename": "deps/openssl/openssl/crypto/asn1/a_bitstr.c",
            "status": "modified",
            "additions": 10,
            "deletions": 10,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_bitstr.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_bitstr.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_bitstr.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "a1a17901b8f8c12905073827b612c1906168c1ba",
            "filename": "deps/openssl/openssl/crypto/asn1/a_d2i_fp.c",
            "status": "modified",
            "additions": 8,
            "deletions": 9,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_d2i_fp.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_d2i_fp.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_d2i_fp.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "f4cc1f2e0eaa52ff1582400b1c0ac4720439ddfd",
            "filename": "deps/openssl/openssl/crypto/asn1/a_digest.c",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_digest.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_digest.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_digest.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "50af6b0006094e56bf341e429836cc84d2188e01",
            "filename": "deps/openssl/openssl/crypto/asn1/a_dup.c",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_dup.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_dup.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_dup.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "d3878d6e57fe4731d083747a024f8acd0cb9fbf7",
            "filename": "deps/openssl/openssl/crypto/asn1/a_gentm.c",
            "status": "modified",
            "additions": 20,
            "deletions": 211,
            "changes": 231,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_gentm.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_gentm.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_gentm.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "980c65a25d2daa9638328a78c2653efda20e0fc9",
            "filename": "deps/openssl/openssl/crypto/asn1/a_i2d_fp.c",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_i2d_fp.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_i2d_fp.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_i2d_fp.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "70a45cb3cc770de2f30254fecd0dc6d887f29401",
            "filename": "deps/openssl/openssl/crypto/asn1/a_int.c",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_int.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_int.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_int.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "949fe6c1611ac37a64a36ae03995da7fac1fd383",
            "filename": "deps/openssl/openssl/crypto/asn1/a_mbstr.c",
            "status": "modified",
            "additions": 9,
            "deletions": 61,
            "changes": 70,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_mbstr.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_mbstr.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_mbstr.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "5e1424a806fbd98089b66e151f009169892c21bc",
            "filename": "deps/openssl/openssl/crypto/asn1/a_object.c",
            "status": "modified",
            "additions": 18,
            "deletions": 16,
            "changes": 34,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_object.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_object.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_object.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "8a373d9da9f61aefaa63d4f96d662dd8f932a80d",
            "filename": "deps/openssl/openssl/crypto/asn1/a_print.c",
            "status": "modified",
            "additions": 16,
            "deletions": 30,
            "changes": 46,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_print.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_print.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_print.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "130e23eaaa1e6160a561c8e4a1285cc5eca8c497",
            "filename": "deps/openssl/openssl/crypto/asn1/a_sign.c",
            "status": "modified",
            "additions": 10,
            "deletions": 6,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_sign.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_sign.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_sign.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ea4dd1c5b189e53bc6a6f6e1d1e229da3a91a686",
            "filename": "deps/openssl/openssl/crypto/asn1/a_strex.c",
            "status": "modified",
            "additions": 19,
            "deletions": 8,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_strex.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_strex.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_strex.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "f19a9de647b1cf9b0a2d378371fa4be6a89ba3f6",
            "filename": "deps/openssl/openssl/crypto/asn1/a_strnid.c",
            "status": "modified",
            "additions": 21,
            "deletions": 91,
            "changes": 112,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_strnid.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_strnid.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_strnid.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1babb9636054c627598989fa207bf7525514c331",
            "filename": "deps/openssl/openssl/crypto/asn1/a_time.c",
            "status": "modified",
            "additions": 444,
            "deletions": 61,
            "changes": 505,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_time.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_time.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_time.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0c7aebe3076b4ea4bba0fd2a633186a774ef6868",
            "filename": "deps/openssl/openssl/crypto/asn1/a_type.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_type.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_type.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_type.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b224991aa3df1ee06e3d5e53ce5a9dfd25c75a18",
            "filename": "deps/openssl/openssl/crypto/asn1/a_utctm.c",
            "status": "modified",
            "additions": 24,
            "deletions": 180,
            "changes": 204,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_utctm.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_utctm.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_utctm.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "973d50d24de901c787bcd244ad8998d4271ed0a0",
            "filename": "deps/openssl/openssl/crypto/asn1/a_verify.c",
            "status": "modified",
            "additions": 7,
            "deletions": 16,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_verify.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_verify.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fa_verify.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "9a1644148af5d564163b04c4de15b5acdddf17ee",
            "filename": "deps/openssl/openssl/crypto/asn1/ameth_lib.c",
            "status": "modified",
            "additions": 66,
            "deletions": 42,
            "changes": 108,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fameth_lib.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fameth_lib.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fameth_lib.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "613f9ae71333a5b0248bbf444232ca6a43c62e35",
            "filename": "deps/openssl/openssl/crypto/asn1/asn1_err.c",
            "status": "modified",
            "additions": 319,
            "deletions": 242,
            "changes": 561,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_err.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_err.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_err.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "9798192f4be221e9512a6931ada1705bb36fa22a",
            "filename": "deps/openssl/openssl/crypto/asn1/asn1_item_list.c",
            "status": "added",
            "additions": 42,
            "deletions": 0,
            "changes": 42,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_item_list.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_item_list.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_item_list.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "db8107ed1b1905e1f22ddd8360521dad67f4dc4b",
            "filename": "deps/openssl/openssl/crypto/asn1/asn1_item_list.h",
            "status": "added",
            "additions": 178,
            "deletions": 0,
            "changes": 178,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_item_list.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_item_list.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_item_list.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "88c4b539180267b6bccedd4a8b17d416e61d583f",
            "filename": "deps/openssl/openssl/crypto/asn1/asn1_lib.c",
            "status": "modified",
            "additions": 32,
            "deletions": 25,
            "changes": 57,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_lib.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_lib.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_lib.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "cec141721b3485d758fca5d4973df02a59c86664",
            "filename": "deps/openssl/openssl/crypto/asn1/asn1_locl.h",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_locl.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_locl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_locl.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "4b60c615de7645d045afc76b8985de92e4d5fd5b",
            "filename": "deps/openssl/openssl/crypto/asn1/asn1_par.c",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_par.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_par.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn1_par.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "dfd5be6347543b8d50c56301f9743290add1d6ef",
            "filename": "deps/openssl/openssl/crypto/asn1/asn_mime.c",
            "status": "modified",
            "additions": 14,
            "deletions": 34,
            "changes": 48,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn_mime.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn_mime.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn_mime.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "68a01f31179efede5db474f792bc04cb90f4b10f",
            "filename": "deps/openssl/openssl/crypto/asn1/asn_moid.c",
            "status": "modified",
            "additions": 20,
            "deletions": 25,
            "changes": 45,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn_moid.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn_moid.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn_moid.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ddcbcd07fe6ef71765e6fde34fcc46a1f0411c2f",
            "filename": "deps/openssl/openssl/crypto/asn1/asn_mstbl.c",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn_mstbl.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn_mstbl.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fasn_mstbl.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "86ee566323052d5728e0dbd49780e68ae95d5a7f",
            "filename": "deps/openssl/openssl/crypto/asn1/bio_asn1.c",
            "status": "modified",
            "additions": 15,
            "deletions": 8,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fbio_asn1.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fbio_asn1.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fbio_asn1.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "6222c99074de8d5394ed2c1bdd6732548ff98b12",
            "filename": "deps/openssl/openssl/crypto/asn1/bio_ndef.c",
            "status": "modified",
            "additions": 7,
            "deletions": 5,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fbio_ndef.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fbio_ndef.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fbio_ndef.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "d3e92c81acfe3b65c059a321891d528d389113ca",
            "filename": "deps/openssl/openssl/crypto/asn1/build.info",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fbuild.info",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fbuild.info",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fbuild.info?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "bfccac2cb4e317a4e4994715b36ee686d525d1b1",
            "filename": "deps/openssl/openssl/crypto/asn1/charmap.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fcharmap.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fcharmap.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fcharmap.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "fbab1f3b0ad7ec72f17fd09c5a3fece555724514",
            "filename": "deps/openssl/openssl/crypto/asn1/charmap.pl",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fcharmap.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fcharmap.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fcharmap.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "aa0d6ad6aed076f1f3a609ae21c552a6f4359069",
            "filename": "deps/openssl/openssl/crypto/asn1/d2i_pr.c",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fd2i_pr.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fd2i_pr.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fd2i_pr.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "9452e08a5874c654e35d170f1d34b8eb338b5514",
            "filename": "deps/openssl/openssl/crypto/asn1/d2i_pu.c",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fd2i_pu.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fd2i_pu.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fd2i_pu.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "895085a520a1638df93a2049dae79cc234357949",
            "filename": "deps/openssl/openssl/crypto/asn1/evp_asn1.c",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fevp_asn1.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fevp_asn1.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fevp_asn1.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "6d6bddc651cc738166a51332d8232551f7733422",
            "filename": "deps/openssl/openssl/crypto/asn1/f_int.c",
            "status": "modified",
            "additions": 6,
            "deletions": 17,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ff_int.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ff_int.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ff_int.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "f893489a67198c3ee475322f76e5448f7a4dad23",
            "filename": "deps/openssl/openssl/crypto/asn1/f_string.c",
            "status": "modified",
            "additions": 7,
            "deletions": 19,
            "changes": 26,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ff_string.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ff_string.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ff_string.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "d1fb8a146d6208a039687ce47f4b3429c6e57013",
            "filename": "deps/openssl/openssl/crypto/asn1/n_pkey.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fn_pkey.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fn_pkey.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fn_pkey.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "f91ba08f1ea4cbdf2f7938574458ce930617e34a",
            "filename": "deps/openssl/openssl/crypto/asn1/p5_pbev2.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fp5_pbev2.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fp5_pbev2.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fp5_pbev2.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1491d96ec8d389c17ee3dd4d5368d28f4e6c47e4",
            "filename": "deps/openssl/openssl/crypto/asn1/p5_scrypt.c",
            "status": "modified",
            "additions": 3,
            "deletions": 12,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fp5_scrypt.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fp5_scrypt.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fp5_scrypt.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e74de55ffeb6215f8c075de5d331832df385b4f7",
            "filename": "deps/openssl/openssl/crypto/asn1/standard_methods.h",
            "status": "added",
            "additions": 61,
            "deletions": 0,
            "changes": 61,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fstandard_methods.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fstandard_methods.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fstandard_methods.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c2a521ed51800bfc1f8243e3b3e896c9111d0fcc",
            "filename": "deps/openssl/openssl/crypto/asn1/tasn_dec.c",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_dec.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_dec.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_dec.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "30be314ff982a6d68e81d2e554715c96f9d4e8d9",
            "filename": "deps/openssl/openssl/crypto/asn1/tasn_enc.c",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_enc.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_enc.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_enc.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "6b8ea8ddd74dbe0138e35cc942ec4b515099b164",
            "filename": "deps/openssl/openssl/crypto/asn1/tasn_new.c",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_new.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_new.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_new.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1fb66f1062ba648695e1cb16ad8f0640c17dec69",
            "filename": "deps/openssl/openssl/crypto/asn1/tasn_prn.c",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_prn.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_prn.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_prn.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "7ceecffce75822ed7d428beb75a3030750b63031",
            "filename": "deps/openssl/openssl/crypto/asn1/tasn_utl.c",
            "status": "modified",
            "additions": 28,
            "deletions": 15,
            "changes": 43,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_utl.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_utl.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftasn_utl.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "777a734482467baa65242cbe64c0ec8942d26bf5",
            "filename": "deps/openssl/openssl/crypto/asn1/tbl_standard.h",
            "status": "added",
            "additions": 61,
            "deletions": 0,
            "changes": 61,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftbl_standard.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftbl_standard.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Ftbl_standard.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "853d45b8bc8aac00ce66202f55e3a2a48b6763e7",
            "filename": "deps/openssl/openssl/crypto/asn1/x_algor.c",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_algor.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_algor.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_algor.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0ee552cf0a4885b418b67be79e98a7af216b17c8",
            "filename": "deps/openssl/openssl/crypto/asn1/x_int64.c",
            "status": "modified",
            "additions": 34,
            "deletions": 8,
            "changes": 42,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_int64.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_int64.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_int64.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "bf9371ef55aaf123821f32a7fc9d9c6016246dfb",
            "filename": "deps/openssl/openssl/crypto/asn1/x_long.c",
            "status": "modified",
            "additions": 16,
            "deletions": 11,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_long.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_long.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_long.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0d72a3f3a9d2390c3c2a198c2eb5aea9203d8756",
            "filename": "deps/openssl/openssl/crypto/asn1/x_spki.c",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_spki.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_spki.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasn1%2Fx_spki.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "62449fe60e04ff54c0a2500d7292c98953da5735",
            "filename": "deps/openssl/openssl/crypto/async/arch/async_posix.h",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Farch%2Fasync_posix.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Farch%2Fasync_posix.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Farch%2Fasync_posix.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1d83e4576f81455ca6b9c3c8456bfce8389d2b49",
            "filename": "deps/openssl/openssl/crypto/async/async.c",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "fd5527aae8c98b6d74cc3a7789af412dc30dac3a",
            "filename": "deps/openssl/openssl/crypto/async/async_err.c",
            "status": "modified",
            "additions": 22,
            "deletions": 22,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync_err.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync_err.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync_err.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "d7790293f74f52d3d0b9af3b472fc2130f5297a3",
            "filename": "deps/openssl/openssl/crypto/async/async_locl.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync_locl.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync_locl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync_locl.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b23e43e8c8624aa5a40df5bf9937dcfdef62d48f",
            "filename": "deps/openssl/openssl/crypto/async/async_wait.c",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync_wait.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync_wait.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fasync%2Fasync_wait.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "4e913aecf42da0cfd525a1484949fa469f52019d",
            "filename": "deps/openssl/openssl/crypto/bf/asm/bf-586.pl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fasm%2Fbf-586.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fasm%2Fbf-586.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fasm%2Fbf-586.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "6ed62578ace3cba54c37dffd6958ded723b77dc8",
            "filename": "deps/openssl/openssl/crypto/bf/bf_cbc.c",
            "status": "removed",
            "additions": 0,
            "deletions": 86,
            "changes": 86,
            "blob_url": "https://github.com/nodejs/node/blob/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbf_cbc.c",
            "raw_url": "https://github.com/nodejs/node/raw/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbf_cbc.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbf_cbc.c?ref=5d80f9ea6091847176fa47fb1395fdffc4af9164"
        },
        {
            "sha": "dc1becdbe4ed054caba2f84cdd95210ae590ebed",
            "filename": "deps/openssl/openssl/crypto/bf/bf_ecb.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbf_ecb.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbf_ecb.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbf_ecb.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "67c0d78aec5cba4cb2ca1ab9476e2cb8d5fcd6f7",
            "filename": "deps/openssl/openssl/crypto/bf/bf_enc.c",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbf_enc.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbf_enc.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbf_enc.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "29adc8ce5072142f6661394fe2920523be1f75b1",
            "filename": "deps/openssl/openssl/crypto/bf/build.info",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbuild.info",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbuild.info",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbf%2Fbuild.info?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "abec7bb8dbba47f04a58945cba8a7b3208a9d955",
            "filename": "deps/openssl/openssl/crypto/bio/b_addr.c",
            "status": "modified",
            "additions": 33,
            "deletions": 20,
            "changes": 53,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_addr.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_addr.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_addr.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0d06414e7d912f9465845d0e73ac2e3d7246fed5",
            "filename": "deps/openssl/openssl/crypto/bio/b_dump.c",
            "status": "modified",
            "additions": 36,
            "deletions": 31,
            "changes": 67,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_dump.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_dump.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_dump.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "9e907fcaa778c65b35f08bed0e9e27b3b00ab16c",
            "filename": "deps/openssl/openssl/crypto/bio/b_print.c",
            "status": "modified",
            "additions": 46,
            "deletions": 42,
            "changes": 88,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_print.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_print.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_print.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e7a24d02cbe5b0a773bf1c415761f59676fd139b",
            "filename": "deps/openssl/openssl/crypto/bio/b_sock.c",
            "status": "modified",
            "additions": 14,
            "deletions": 23,
            "changes": 37,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_sock.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_sock.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_sock.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "5d82ab22dc304c337d70140f849d4a0f253a5eb6",
            "filename": "deps/openssl/openssl/crypto/bio/b_sock2.c",
            "status": "modified",
            "additions": 65,
            "deletions": 25,
            "changes": 90,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_sock2.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_sock2.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fb_sock2.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "8e87a629b8b5422ee6a8de2975199e3208034057",
            "filename": "deps/openssl/openssl/crypto/bio/bf_buff.c",
            "status": "modified",
            "additions": 52,
            "deletions": 32,
            "changes": 84,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_buff.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_buff.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_buff.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "194c7b8af7137fe745a81831d15e96a706587ffd",
            "filename": "deps/openssl/openssl/crypto/bio/bf_lbuf.c",
            "status": "modified",
            "additions": 34,
            "deletions": 28,
            "changes": 62,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_lbuf.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_lbuf.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_lbuf.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "4bc84eeba659c418d10cc1442883d34315f1fd54",
            "filename": "deps/openssl/openssl/crypto/bio/bf_nbio.c",
            "status": "modified",
            "additions": 29,
            "deletions": 23,
            "changes": 52,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_nbio.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_nbio.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_nbio.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "613fb2e0583dd1524b1bc8c55cfe678221a41559",
            "filename": "deps/openssl/openssl/crypto/bio/bf_null.c",
            "status": "modified",
            "additions": 19,
            "deletions": 15,
            "changes": 34,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_null.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_null.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbf_null.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1154c233afd8d3e7fadd3e21ccdcb0dacff1a904",
            "filename": "deps/openssl/openssl/crypto/bio/bio_cb.c",
            "status": "modified",
            "additions": 19,
            "deletions": 20,
            "changes": 39,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_cb.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_cb.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_cb.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "7aa9dabb29154c9f8b43cbaef68232183482f012",
            "filename": "deps/openssl/openssl/crypto/bio/bio_err.c",
            "status": "modified",
            "additions": 115,
            "deletions": 96,
            "changes": 211,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_err.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_err.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_err.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e2c05a20de6cbc9e750a44d92ff6599b74d5118d",
            "filename": "deps/openssl/openssl/crypto/bio/bio_lcl.h",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_lcl.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_lcl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_lcl.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ca375b911ae8b510b39c0456f90b897a3aff6756",
            "filename": "deps/openssl/openssl/crypto/bio/bio_lib.c",
            "status": "modified",
            "additions": 301,
            "deletions": 115,
            "changes": 416,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_lib.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_lib.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_lib.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "493ff63a9012b626b639ff662f0cfd4272e9fa80",
            "filename": "deps/openssl/openssl/crypto/bio/bio_meth.c",
            "status": "modified",
            "additions": 73,
            "deletions": 4,
            "changes": 77,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_meth.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_meth.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbio_meth.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "993e5903a04faca426934273d2928902bfa75c34",
            "filename": "deps/openssl/openssl/crypto/bio/bss_acpt.c",
            "status": "modified",
            "additions": 23,
            "deletions": 25,
            "changes": 48,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_acpt.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_acpt.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_acpt.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e34382c5578141496b4e02d322400b59f0b0d080",
            "filename": "deps/openssl/openssl/crypto/bio/bss_bio.c",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_bio.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_bio.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_bio.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e9673fe783369308316b07231c232f052dade344",
            "filename": "deps/openssl/openssl/crypto/bio/bss_conn.c",
            "status": "modified",
            "additions": 27,
            "deletions": 30,
            "changes": 57,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_conn.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_conn.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_conn.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "d5fe5bb5a8a2d7c7b394577131cafbd15777160e",
            "filename": "deps/openssl/openssl/crypto/bio/bss_dgram.c",
            "status": "modified",
            "additions": 61,
            "deletions": 59,
            "changes": 120,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_dgram.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_dgram.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_dgram.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "5bc539c90b961fb89cd7084f4ba9b3fe1e761c04",
            "filename": "deps/openssl/openssl/crypto/bio/bss_fd.c",
            "status": "modified",
            "additions": 23,
            "deletions": 18,
            "changes": 41,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_fd.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_fd.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_fd.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "8de2391267afe8d9d2b33edb03b0750ee12c1d46",
            "filename": "deps/openssl/openssl/crypto/bio/bss_file.c",
            "status": "modified",
            "additions": 27,
            "deletions": 25,
            "changes": 52,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_file.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_file.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_file.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e9ab932ec29531e87a7175cb9126fc0c847dbd3e",
            "filename": "deps/openssl/openssl/crypto/bio/bss_log.c",
            "status": "modified",
            "additions": 14,
            "deletions": 10,
            "changes": 24,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_log.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_log.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_log.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e0a97c3b43e188dd740f299c246f47fb404335c9",
            "filename": "deps/openssl/openssl/crypto/bio/bss_mem.c",
            "status": "modified",
            "additions": 32,
            "deletions": 28,
            "changes": 60,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_mem.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_mem.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_mem.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "08f1d2bc98a37d35c64dc9c0e2ecb937e2b8c507",
            "filename": "deps/openssl/openssl/crypto/bio/bss_null.c",
            "status": "modified",
            "additions": 11,
            "deletions": 7,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_null.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_null.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_null.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ad38453201f17114645ebda814c593ce43f40d2a",
            "filename": "deps/openssl/openssl/crypto/bio/bss_sock.c",
            "status": "modified",
            "additions": 18,
            "deletions": 16,
            "changes": 34,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_sock.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_sock.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbio%2Fbss_sock.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "80b717e79c08ab4ae9dd5163c13c0cdc58ec9a6d",
            "filename": "deps/openssl/openssl/crypto/blake2/blake2_impl.h",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2_impl.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2_impl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2_impl.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "926bae944c174ca5ffe30d43d2b71ddae1d56988",
            "filename": "deps/openssl/openssl/crypto/blake2/blake2_locl.h",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2_locl.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2_locl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2_locl.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "829ba5b50a5c44a3ea743018894e07071807e678",
            "filename": "deps/openssl/openssl/crypto/blake2/blake2b.c",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2b.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2b.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2b.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "8211374d123f1275e36cc8025cfb5b9b36fbe953",
            "filename": "deps/openssl/openssl/crypto/blake2/blake2s.c",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2s.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2s.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fblake2s.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c493648c3cd08675ba7387a653aa7645e9e7008a",
            "filename": "deps/openssl/openssl/crypto/blake2/m_blake2b.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fm_blake2b.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fm_blake2b.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fm_blake2b.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "83b2811e443283651e48e9e9edadffe52c6c4d1c",
            "filename": "deps/openssl/openssl/crypto/blake2/m_blake2s.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fm_blake2s.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fm_blake2s.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fblake2%2Fm_blake2s.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "706a140342cd69f6f0eec64769bac712bab97f18",
            "filename": "deps/openssl/openssl/crypto/bn/README.pod",
            "status": "modified",
            "additions": 1,
            "deletions": 7,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2FREADME.pod",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2FREADME.pod",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2FREADME.pod?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c9b962a150de61c07a922a8a1a1390a7a6d6d6d4",
            "filename": "deps/openssl/openssl/crypto/bn/asm/alpha-mont.pl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Falpha-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Falpha-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Falpha-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "7a0cdb2e8a009642e15844016158d3089787c295",
            "filename": "deps/openssl/openssl/crypto/bn/asm/armv4-gf2m.pl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Farmv4-gf2m.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Farmv4-gf2m.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Farmv4-gf2m.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "6bedc62ba62deb6b85a716943097290df62b84c5",
            "filename": "deps/openssl/openssl/crypto/bn/asm/armv4-mont.pl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Farmv4-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Farmv4-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Farmv4-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "58effc8808dd4793398d2cb6431eb4ed6b4580bd",
            "filename": "deps/openssl/openssl/crypto/bn/asm/bn-586.pl",
            "status": "modified",
            "additions": 13,
            "deletions": 13,
            "changes": 26,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fbn-586.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fbn-586.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fbn-586.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "9c46da3af8d1f5406de210c3745ab5481e0d53d6",
            "filename": "deps/openssl/openssl/crypto/bn/asm/c64xplus-gf2m.pl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fc64xplus-gf2m.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fc64xplus-gf2m.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fc64xplus-gf2m.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "97f5e3a19fc43a862c3adcecfd4d37e35019fdf6",
            "filename": "deps/openssl/openssl/crypto/bn/asm/co-586.pl",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fco-586.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fco-586.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fco-586.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ec486f77792be6c2f0c430cd1437a0cd47800646",
            "filename": "deps/openssl/openssl/crypto/bn/asm/ia64-mont.pl",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fia64-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fia64-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fia64-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "d235c45e2d632166f374c2d3fab95ecdea642464",
            "filename": "deps/openssl/openssl/crypto/bn/asm/ia64.S",
            "status": "modified",
            "additions": 14,
            "deletions": 11,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fia64.S",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fia64.S",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fia64.S?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "fbe5d04f716c989090944655bea742ea5c777f35",
            "filename": "deps/openssl/openssl/crypto/bn/asm/mips-mont.pl",
            "status": "modified",
            "additions": 52,
            "deletions": 50,
            "changes": 102,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fmips-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fmips-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fmips-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "da35ec1b30cea5496b758ba0da317a8c6c1ccc3a",
            "filename": "deps/openssl/openssl/crypto/bn/asm/mips.pl",
            "status": "modified",
            "additions": 384,
            "deletions": 368,
            "changes": 752,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fmips.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fmips.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fmips.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "413eac71237c2f1e84d636a0904f69139e3145ab",
            "filename": "deps/openssl/openssl/crypto/bn/asm/pa-risc2.s",
            "status": "removed",
            "additions": 0,
            "deletions": 1624,
            "changes": 1624,
            "blob_url": "https://github.com/nodejs/node/blob/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fpa-risc2.s",
            "raw_url": "https://github.com/nodejs/node/raw/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fpa-risc2.s",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fpa-risc2.s?ref=5d80f9ea6091847176fa47fb1395fdffc4af9164"
        },
        {
            "sha": "97381172e727cb7c0ad3bb3bcbe65176a88f76f5",
            "filename": "deps/openssl/openssl/crypto/bn/asm/pa-risc2W.s",
            "status": "removed",
            "additions": 0,
            "deletions": 1612,
            "changes": 1612,
            "blob_url": "https://github.com/nodejs/node/blob/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fpa-risc2W.s",
            "raw_url": "https://github.com/nodejs/node/raw/5d80f9ea6091847176fa47fb1395fdffc4af9164/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fpa-risc2W.s",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fpa-risc2W.s?ref=5d80f9ea6091847176fa47fb1395fdffc4af9164"
        },
        {
            "sha": "aa9f626ed267681311fda3624fb5cbdf24342963",
            "filename": "deps/openssl/openssl/crypto/bn/asm/parisc-mont.pl",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fparisc-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fparisc-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fparisc-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ec7e019a4380fbf35fbfadbcb07e87b414590c75",
            "filename": "deps/openssl/openssl/crypto/bn/asm/ppc-mont.pl",
            "status": "modified",
            "additions": 1672,
            "deletions": 25,
            "changes": 1697,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fppc-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fppc-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fppc-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "e37068192f2f5e39196b372e8e65854f61bc0f9f",
            "filename": "deps/openssl/openssl/crypto/bn/asm/ppc.pl",
            "status": "modified",
            "additions": 136,
            "deletions": 139,
            "changes": 275,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fppc.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fppc.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fppc.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c41b620bc23ec87a0bf46a2b9671d88bafa07d2b",
            "filename": "deps/openssl/openssl/crypto/bn/asm/ppc64-mont.pl",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fppc64-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fppc64-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fppc64-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "f1292cc75cfb5eed601def82b63447ecb3079706",
            "filename": "deps/openssl/openssl/crypto/bn/asm/rsaz-avx2.pl",
            "status": "modified",
            "additions": 77,
            "deletions": 68,
            "changes": 145,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Frsaz-avx2.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Frsaz-avx2.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Frsaz-avx2.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b1797b649f0034e3c1b0c2e92a1005cd8035ac98",
            "filename": "deps/openssl/openssl/crypto/bn/asm/rsaz-x86_64.pl",
            "status": "modified",
            "additions": 122,
            "deletions": 76,
            "changes": 198,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Frsaz-x86_64.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Frsaz-x86_64.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Frsaz-x86_64.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "06181bf9b95f77a0c2589a17045d7d6673b1880a",
            "filename": "deps/openssl/openssl/crypto/bn/asm/s390x-gf2m.pl",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fs390x-gf2m.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fs390x-gf2m.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fs390x-gf2m.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c2fc5adffe0d145dcb5a4bb15ec2c97c9044cca9",
            "filename": "deps/openssl/openssl/crypto/bn/asm/s390x-mont.pl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fs390x-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fs390x-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fs390x-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "fcae9cfc5b44bf43877c9ec1cddc64eca594a7e9",
            "filename": "deps/openssl/openssl/crypto/bn/asm/sparct4-mont.pl",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparct4-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparct4-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparct4-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "75d72eb92c7482bb32fbbe7162ceb02125351afa",
            "filename": "deps/openssl/openssl/crypto/bn/asm/sparcv8.S",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv8.S",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv8.S",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv8.S?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "fe4699b2bdd144cc619e124c0a2858329a55a815",
            "filename": "deps/openssl/openssl/crypto/bn/asm/sparcv8plus.S",
            "status": "modified",
            "additions": 6,
            "deletions": 10,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv8plus.S",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv8plus.S",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv8plus.S?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b41903af985f56adeb1f22f8194611e0485e1a28",
            "filename": "deps/openssl/openssl/crypto/bn/asm/sparcv9-mont.pl",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv9-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv9-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv9-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c8f759df9fbd1a73298ea9041adf31ad186382af",
            "filename": "deps/openssl/openssl/crypto/bn/asm/sparcv9a-mont.pl",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv9a-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv9a-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fsparcv9a-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "9cf717e8410248a46a369d20e6df1fe76f3ef13b",
            "filename": "deps/openssl/openssl/crypto/bn/asm/via-mont.pl",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fvia-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fvia-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fvia-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "04833a0c876df048b05c67dcba38236cab7720c2",
            "filename": "deps/openssl/openssl/crypto/bn/asm/vis3-mont.pl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fvis3-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fvis3-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fvis3-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "d03efcc75023dcadb711ed5e6badc57b3e6aae45",
            "filename": "deps/openssl/openssl/crypto/bn/asm/x86-gf2m.pl",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86-gf2m.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86-gf2m.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86-gf2m.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "7ba2133ac9c3a1e6efed81d84abc875714d416b8",
            "filename": "deps/openssl/openssl/crypto/bn/asm/x86-mont.pl",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "31839ba060fa5a998cbd797571cc224f5c2bc67a",
            "filename": "deps/openssl/openssl/crypto/bn/asm/x86_64-gcc.c",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-gcc.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-gcc.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-gcc.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0fd6e985d7b05886c07354d4f7a019a488aff015",
            "filename": "deps/openssl/openssl/crypto/bn/asm/x86_64-gf2m.pl",
            "status": "modified",
            "additions": 32,
            "deletions": 5,
            "changes": 37,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-gf2m.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-gf2m.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-gf2m.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c051135e30dd336922f49d35a83daa72e5ce98b0",
            "filename": "deps/openssl/openssl/crypto/bn/asm/x86_64-mont.pl",
            "status": "modified",
            "additions": 76,
            "deletions": 4,
            "changes": 80,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-mont.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-mont.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-mont.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "ad6e8ada3ce75ea9814163462a455454f776bca8",
            "filename": "deps/openssl/openssl/crypto/bn/asm/x86_64-mont5.pl",
            "status": "modified",
            "additions": 118,
            "deletions": 11,
            "changes": 129,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-mont5.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-mont5.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fasm%2Fx86_64-mont5.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "f2736b8f6d4194abb83ef8a7d015eddf3bf5360c",
            "filename": "deps/openssl/openssl/crypto/bn/bn_add.c",
            "status": "modified",
            "additions": 47,
            "deletions": 85,
            "changes": 132,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_add.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_add.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_add.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "729b2480acd18e5af64d7b772604398ed65cb4b8",
            "filename": "deps/openssl/openssl/crypto/bn/bn_asm.c",
            "status": "modified",
            "additions": 16,
            "deletions": 16,
            "changes": 32,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_asm.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_asm.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_asm.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "450cdfb34866e65017d08cdad1cbf2c34ca838b1",
            "filename": "deps/openssl/openssl/crypto/bn/bn_blind.c",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_blind.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_blind.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_blind.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "aa08b31a34bb9b9d93d7951ffe7624b17fe2ccf2",
            "filename": "deps/openssl/openssl/crypto/bn/bn_ctx.c",
            "status": "modified",
            "additions": 11,
            "deletions": 5,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_ctx.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_ctx.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_ctx.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "38acdee234d08f5dcdf621518f03f719d41333b1",
            "filename": "deps/openssl/openssl/crypto/bn/bn_dh.c",
            "status": "modified",
            "additions": 294,
            "deletions": 2,
            "changes": 296,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_dh.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_dh.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_dh.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "70add10c7d6cefdf45642499d39df58d31e19516",
            "filename": "deps/openssl/openssl/crypto/bn/bn_div.c",
            "status": "modified",
            "additions": 11,
            "deletions": 17,
            "changes": 28,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_div.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_div.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_div.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "dd87c152cf375816c06498b56a4f9d8e53192295",
            "filename": "deps/openssl/openssl/crypto/bn/bn_err.c",
            "status": "modified",
            "additions": 89,
            "deletions": 78,
            "changes": 167,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_err.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_err.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_err.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c026ffcb339ceca205378df8fe63a92dbdb5b0e3",
            "filename": "deps/openssl/openssl/crypto/bn/bn_exp.c",
            "status": "modified",
            "additions": 99,
            "deletions": 87,
            "changes": 186,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_exp.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_exp.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_exp.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "082c9286a0f4b38eb48ac05701eb84647e8c71fc",
            "filename": "deps/openssl/openssl/crypto/bn/bn_exp2.c",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_exp2.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_exp2.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_exp2.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0091ea4e08a67cf1daedf50beb5fa8278fe05000",
            "filename": "deps/openssl/openssl/crypto/bn/bn_gcd.c",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_gcd.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_gcd.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_gcd.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "34d8b69c1ec9d70da5625809cc48c15e0df1bf88",
            "filename": "deps/openssl/openssl/crypto/bn/bn_gf2m.c",
            "status": "modified",
            "additions": 50,
            "deletions": 110,
            "changes": 160,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_gf2m.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_gf2m.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_gf2m.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "46bc97575dfe47c8c8da0fc40327b96dbc41a2dd",
            "filename": "deps/openssl/openssl/crypto/bn/bn_intern.c",
            "status": "modified",
            "additions": 0,
            "deletions": 15,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_intern.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_intern.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_intern.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "8a36db2e8b671c2b082048144e05a411efbd3976",
            "filename": "deps/openssl/openssl/crypto/bn/bn_lcl.h",
            "status": "modified",
            "additions": 43,
            "deletions": 74,
            "changes": 117,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_lcl.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_lcl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_lcl.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "80f910c807793490908cb8abbba286787397c91f",
            "filename": "deps/openssl/openssl/crypto/bn/bn_lib.c",
            "status": "modified",
            "additions": 55,
            "deletions": 140,
            "changes": 195,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_lib.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_lib.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_lib.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "712fc8ac145be2efad7b6ae876e4da4a0a43ac3d",
            "filename": "deps/openssl/openssl/crypto/bn/bn_mod.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_mod.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_mod.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_mod.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "393d27c392c7383e6bd8784c52a992639ae3919d",
            "filename": "deps/openssl/openssl/crypto/bn/bn_mont.c",
            "status": "modified",
            "additions": 23,
            "deletions": 21,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_mont.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_mont.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_mont.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "5eda65cfbb048105a697c5eaca64387454642fd5",
            "filename": "deps/openssl/openssl/crypto/bn/bn_mul.c",
            "status": "modified",
            "additions": 2,
            "deletions": 339,
            "changes": 341,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_mul.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_mul.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_mul.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "dcdd321c6688cda6da783d0812edaa58570224da",
            "filename": "deps/openssl/openssl/crypto/bn/bn_nist.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_nist.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_nist.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_nist.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "b91b31b1f304d2e75445d72244becc03b3094cb3",
            "filename": "deps/openssl/openssl/crypto/bn/bn_prime.c",
            "status": "modified",
            "additions": 23,
            "deletions": 150,
            "changes": 173,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_prime.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_prime.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_prime.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "a64c9630f3b04f428a913434eb3672b08f72b992",
            "filename": "deps/openssl/openssl/crypto/bn/bn_prime.h",
            "status": "modified",
            "additions": 257,
            "deletions": 258,
            "changes": 515,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_prime.h",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_prime.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_prime.h?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "eeca475b9366bbe9a51af2f2bf2d9fc5b7779aad",
            "filename": "deps/openssl/openssl/crypto/bn/bn_prime.pl",
            "status": "modified",
            "additions": 7,
            "deletions": 5,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_prime.pl",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_prime.pl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_prime.pl?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "1853269d903df17db2196b436a7c916cef38b30c",
            "filename": "deps/openssl/openssl/crypto/bn/bn_print.c",
            "status": "modified",
            "additions": 54,
            "deletions": 52,
            "changes": 106,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_print.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_print.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_print.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "c0d1a32292bace170ad817964b3497a158e1d964",
            "filename": "deps/openssl/openssl/crypto/bn/bn_rand.c",
            "status": "modified",
            "additions": 36,
            "deletions": 26,
            "changes": 62,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_rand.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_rand.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_rand.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "9ab767f42fe9ff869f60c209d2eeadde5522820e",
            "filename": "deps/openssl/openssl/crypto/bn/bn_recp.c",
            "status": "modified",
            "additions": 16,
            "deletions": 21,
            "changes": 37,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_recp.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_recp.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_recp.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "15d4b321ba2684f74b5a1d87015a5d3f523c639f",
            "filename": "deps/openssl/openssl/crypto/bn/bn_shift.c",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_shift.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_shift.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_shift.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        },
        {
            "sha": "0c0a590f0c6ab1504bc4295e8c719b3b58b99b6f",
            "filename": "deps/openssl/openssl/crypto/bn/bn_sqr.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_sqr.c",
            "raw_url": "https://github.com/nodejs/node/raw/4231ad04f0b2aee5bda6be94715d4b70badaac8b/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_sqr.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fbn%2Fbn_sqr.c?ref=4231ad04f0b2aee5bda6be94715d4b70badaac8b"
        }
    ],
    "stats": {
        "total": 288130,
        "additions": 208623,
        "deletions": 79507
    }
}