{
    "author": "BridgeAR",
    "message": "buffer: inspect extra properties\n\nThis makes sure extra properties on buffers are not ignored anymore\nwhen inspecting the buffer.\n\nPR-URL: https://github.com/nodejs/node/pull/25150\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "d385e2cc5a85e150538fd1f41087db9b38943c49",
    "files": [
        {
            "sha": "0521375cf5386740ae201a406918047b7a3768f1",
            "filename": "lib/buffer.js",
            "status": "modified",
            "additions": 22,
            "deletions": 1,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/d385e2cc5a85e150538fd1f41087db9b38943c49/lib%2Fbuffer.js",
            "raw_url": "https://github.com/nodejs/node/raw/d385e2cc5a85e150538fd1f41087db9b38943c49/lib%2Fbuffer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fbuffer.js?ref=d385e2cc5a85e150538fd1f41087db9b38943c49",
            "patch": "@@ -38,6 +38,13 @@ const {\n   kStringMaxLength\n } = internalBinding('buffer');\n const { isAnyArrayBuffer } = internalBinding('types');\n+const {\n+  getOwnNonIndexProperties,\n+  propertyFilter: {\n+    ALL_PROPERTIES,\n+    ONLY_ENUMERABLE\n+  }\n+} = internalBinding('util');\n const {\n   customInspectSymbol,\n   isInsideNodeModules,\n@@ -48,6 +55,10 @@ const {\n   isArrayBufferView,\n   isUint8Array\n } = require('internal/util/types');\n+const {\n+  formatProperty,\n+  kObjectType\n+} = require('internal/util/inspect');\n \n const {\n   ERR_BUFFER_OUT_OF_BOUNDS,\n@@ -671,10 +682,20 @@ Buffer.prototype.equals = function equals(otherBuffer) {\n Buffer.prototype[customInspectSymbol] = function inspect(recurseTimes, ctx) {\n   const max = exports.INSPECT_MAX_BYTES;\n   const actualMax = Math.min(max, this.length);\n-  let str = this.hexSlice(0, actualMax).replace(/(.{2})/g, '$1 ').trim();\n   const remaining = this.length - max;\n+  let str = this.hexSlice(0, actualMax).replace(/(.{2})/g, '$1 ').trim();\n   if (remaining > 0)\n     str += ` ... ${remaining} more byte${remaining > 1 ? 's' : ''}`;\n+  // Inspect special properties as well, if possible.\n+  if (ctx) {\n+    const filter = ctx.showHidden ? ALL_PROPERTIES : ONLY_ENUMERABLE;\n+    str += getOwnNonIndexProperties(this, filter).reduce((str, key) => {\n+      // Using `formatProperty()` expects an indentationLvl to be set.\n+      ctx.indentationLvl = 0;\n+      str += `, ${formatProperty(ctx, this, recurseTimes, key, kObjectType)}`;\n+      return str;\n+    }, '');\n+  }\n   return `<${this.constructor.name} ${str}>`;\n };\n Buffer.prototype.inspect = Buffer.prototype[customInspectSymbol];"
        },
        {
            "sha": "a6f49c5c05c2197265578a6bee51b8d1903333c6",
            "filename": "lib/internal/util/inspect.js",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/d385e2cc5a85e150538fd1f41087db9b38943c49/lib%2Finternal%2Futil%2Finspect.js",
            "raw_url": "https://github.com/nodejs/node/raw/d385e2cc5a85e150538fd1f41087db9b38943c49/lib%2Finternal%2Futil%2Finspect.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Futil%2Finspect.js?ref=d385e2cc5a85e150538fd1f41087db9b38943c49",
            "patch": "@@ -1217,5 +1217,7 @@ function reduceToSingleString(ctx, output, base, braces) {\n }\n \n module.exports = {\n-  inspect\n+  inspect,\n+  formatProperty,\n+  kObjectType\n };"
        },
        {
            "sha": "9230d7b089dd1606984ddac7e3d9ebf6f6e8923d",
            "filename": "test/parallel/test-buffer-inspect.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/d385e2cc5a85e150538fd1f41087db9b38943c49/test%2Fparallel%2Ftest-buffer-inspect.js",
            "raw_url": "https://github.com/nodejs/node/raw/d385e2cc5a85e150538fd1f41087db9b38943c49/test%2Fparallel%2Ftest-buffer-inspect.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-buffer-inspect.js?ref=d385e2cc5a85e150538fd1f41087db9b38943c49",
            "patch": "@@ -55,4 +55,4 @@ assert.strictEqual(util.inspect(b), expected);\n assert.strictEqual(util.inspect(s), expected);\n \n b.inspect = undefined;\n-assert.strictEqual(util.inspect(b), expected);\n+assert.strictEqual(util.inspect(b), '<Buffer 31 32, inspect: undefined>');"
        }
    ],
    "stats": {
        "total": 29,
        "additions": 26,
        "deletions": 3
    }
}