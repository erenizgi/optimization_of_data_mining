{
    "author": "joyeecheung",
    "message": "process: exit on --debug and --debug-brk after option parsing\n\nMoves the exit of `--debug` and `--debug-brk` earlier, that is,\nafter the option parsing is done in the C++ land.\n\nAlso removes `process._invalidDebug`.\n\nPR-URL: https://github.com/nodejs/node/pull/25828\nRefs: https://github.com/nodejs/node/pull/12949\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Eugene Ostroukhov <eostroukhov@google.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>",
    "sha": "154efc9bdef3ba8df5d3dfe3b32102baf3ac4311",
    "files": [
        {
            "sha": "c16e1a02d520c4b9783a0848e8b49acf44dda2d3",
            "filename": "lib/internal/bootstrap/node.js",
            "status": "modified",
            "additions": 1,
            "deletions": 7,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/154efc9bdef3ba8df5d3dfe3b32102baf3ac4311/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "raw_url": "https://github.com/nodejs/node/raw/154efc9bdef3ba8df5d3dfe3b32102baf3ac4311/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fnode.js?ref=154efc9bdef3ba8df5d3dfe3b32102baf3ac4311",
            "patch": "@@ -204,13 +204,7 @@ Object.defineProperty(process, 'argv0', {\n process.argv[0] = process.execPath;\n \n // Handle `--debug*` deprecation and invalidation.\n-if (process._invalidDebug) {\n-  process.emitWarning(\n-    '`node --debug` and `node --debug-brk` are invalid. ' +\n-    'Please use `node --inspect` or `node --inspect-brk` instead.',\n-    'DeprecationWarning', 'DEP0062', undefined, true);\n-  process.exit(9);\n-} else if (process._deprecatedDebugBrk) {\n+if (process._deprecatedDebugBrk) {\n   process.emitWarning(\n     '`node --inspect --debug-brk` is deprecated. ' +\n     'Please use `node --inspect-brk` instead.',"
        },
        {
            "sha": "c1e75ff8106da8f489435f1cba38c0b042f214bd",
            "filename": "src/node_options.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/154efc9bdef3ba8df5d3dfe3b32102baf3ac4311/src%2Fnode_options.cc",
            "raw_url": "https://github.com/nodejs/node/raw/154efc9bdef3ba8df5d3dfe3b32102baf3ac4311/src%2Fnode_options.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_options.cc?ref=154efc9bdef3ba8df5d3dfe3b32102baf3ac4311",
            "patch": "@@ -30,6 +30,12 @@ void DebugOptions::CheckOptions(std::vector<std::string>* errors) {\n                       \"--without-v8-platform\");\n   }\n #endif\n+\n+  if (deprecated_debug && !inspector_enabled) {\n+    errors->push_back(\"[DEP0062]: `node --debug` and `node --debug-brk` \"\n+                      \"are invalid. Please use `node --inspect` or \"\n+                      \"`node --inspect-brk` instead.\");\n+  }\n }\n \n void PerProcessOptions::CheckOptions(std::vector<std::string>* errors) {"
        },
        {
            "sha": "d4e373d05d9280cced96eac8deb65bec7fe71b68",
            "filename": "src/node_options.h",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/154efc9bdef3ba8df5d3dfe3b32102baf3ac4311/src%2Fnode_options.h",
            "raw_url": "https://github.com/nodejs/node/raw/154efc9bdef3ba8df5d3dfe3b32102baf3ac4311/src%2Fnode_options.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_options.h?ref=154efc9bdef3ba8df5d3dfe3b32102baf3ac4311",
            "patch": "@@ -81,10 +81,6 @@ class DebugOptions : public Options {\n       break_first_line;\n   }\n \n-  bool invalid_invocation() const {\n-    return deprecated_debug && !inspector_enabled;\n-  }\n-\n   bool wait_for_connect() const {\n     return break_first_line || break_node_first_line;\n   }"
        },
        {
            "sha": "89abe19a84ff5778a68aca1b0d3ac80faf30a9a5",
            "filename": "src/node_process_object.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/154efc9bdef3ba8df5d3dfe3b32102baf3ac4311/src%2Fnode_process_object.cc",
            "raw_url": "https://github.com/nodejs/node/raw/154efc9bdef3ba8df5d3dfe3b32102baf3ac4311/src%2Fnode_process_object.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_process_object.cc?ref=154efc9bdef3ba8df5d3dfe3b32102baf3ac4311",
            "patch": "@@ -265,12 +265,6 @@ MaybeLocal<Object> CreateProcessObject(\n                                 \"_deprecatedDebugBrk\", True(env->isolate()));\n   }\n \n-  // --debug or, --debug-brk without --inspect\n-  if (env->options()->debug_options().invalid_invocation()) {\n-    READONLY_DONT_ENUM_PROPERTY(process,\n-                                \"_invalidDebug\", True(env->isolate()));\n-  }\n-\n   // --security-revert flags\n #define V(code, _, __)                                                        \\\n   do {                                                                        \\"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 7,
        "deletions": 17
    }
}