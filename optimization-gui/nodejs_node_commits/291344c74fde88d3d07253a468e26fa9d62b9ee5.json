{
    "author": "RReverser",
    "message": "test: fix scriptParsed event expectations\n\nAs per Node.js docs, vm.Script instance is not bound to any context.\n\nHowever, this test was expecting otherwise and depended on\nimplementation details which are going to change.\n\nRefs: https://chromium-review.googlesource.com/c/v8/v8/+/1013581\n\nPR-URL: https://github.com/nodejs/node/pull/21079\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Yang Guo <yangguo@chromium.org>",
    "sha": "291344c74fde88d3d07253a468e26fa9d62b9ee5",
    "files": [
        {
            "sha": "e5c3acfdbb8f5d16ef4dd62f99c1bc4dfe658635",
            "filename": "test/sequential/test-inspector-scriptparsed-context.js",
            "status": "modified",
            "additions": 7,
            "deletions": 27,
            "changes": 34,
            "blob_url": "https://github.com/nodejs/node/blob/291344c74fde88d3d07253a468e26fa9d62b9ee5/test%2Fsequential%2Ftest-inspector-scriptparsed-context.js",
            "raw_url": "https://github.com/nodejs/node/raw/291344c74fde88d3d07253a468e26fa9d62b9ee5/test%2Fsequential%2Ftest-inspector-scriptparsed-context.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-inspector-scriptparsed-context.js?ref=291344c74fde88d3d07253a468e26fa9d62b9ee5",
            "patch": "@@ -9,27 +9,17 @@ const script = `\n   'use strict';\n   const assert = require('assert');\n   const vm = require('vm');\n-  const { kParsingContext } = process.binding('contextify');\n   global.outer = true;\n   global.inner = false;\n   const context = vm.createContext({\n     outer: false,\n     inner: true\n   });\n+  const script = new vm.Script(\"outer\");\n   debugger;\n \n-  const scriptMain = new vm.Script(\"outer\");\n-  debugger;\n-\n-  const scriptContext = new vm.Script(\"inner\", {\n-    [kParsingContext]: context\n-  });\n-  debugger;\n-\n-  assert.strictEqual(scriptMain.runInThisContext(), true);\n-  assert.strictEqual(scriptMain.runInContext(context), false);\n-  assert.strictEqual(scriptContext.runInThisContext(), false);\n-  assert.strictEqual(scriptContext.runInContext(context), true);\n+  assert.strictEqual(script.runInThisContext(), true);\n+  assert.strictEqual(script.runInContext(context), false);\n   debugger;\n \n   vm.runInContext('inner', context);\n@@ -64,35 +54,25 @@ async function runTests() {\n   await session.waitForBreakOnLine(0, '[eval]');\n \n   await session.send({ 'method': 'Runtime.enable' });\n-  const topContext = await getContext(session);\n+  await getContext(session);\n   await session.send({ 'method': 'Debugger.resume' });\n   const childContext = await getContext(session);\n   await session.waitForBreakOnLine(13, '[eval]');\n \n-  console.error('[test]', 'Script associated with current context by default');\n-  await session.send({ 'method': 'Debugger.resume' });\n-  await checkScriptContext(session, topContext);\n-  await session.waitForBreakOnLine(16, '[eval]');\n-\n-  console.error('[test]', 'Script associated with selected context');\n-  await session.send({ 'method': 'Debugger.resume' });\n-  await checkScriptContext(session, childContext);\n-  await session.waitForBreakOnLine(21, '[eval]');\n-\n   console.error('[test]', 'Script is unbound');\n   await session.send({ 'method': 'Debugger.resume' });\n-  await session.waitForBreakOnLine(27, '[eval]');\n+  await session.waitForBreakOnLine(17, '[eval]');\n \n   console.error('[test]', 'vm.runInContext associates script with context');\n   await session.send({ 'method': 'Debugger.resume' });\n   await checkScriptContext(session, childContext);\n-  await session.waitForBreakOnLine(30, '[eval]');\n+  await session.waitForBreakOnLine(20, '[eval]');\n \n   console.error('[test]', 'vm.runInNewContext associates script with context');\n   await session.send({ 'method': 'Debugger.resume' });\n   const thirdContext = await getContext(session);\n   await checkScriptContext(session, thirdContext);\n-  await session.waitForBreakOnLine(33, '[eval]');\n+  await session.waitForBreakOnLine(23, '[eval]');\n \n   console.error('[test]', 'vm.runInNewContext can contain debugger statements');\n   await session.send({ 'method': 'Debugger.resume' });"
        }
    ],
    "stats": {
        "total": 34,
        "additions": 7,
        "deletions": 27
    }
}