{
    "author": "bzoz",
    "message": "win, build: skip building cctest by default\n\nvcbuild will build cctest only if it will be run, or for CI and\nrelease builds\n\nPR-URL: https://github.com/nodejs/node/pull/21408\nReviewed-By: Jo√£o Reis <reis@janeasystems.com>\nReviewed-By: Refael Ackermann <refack@gmail.com>",
    "sha": "2c473d65a4ef77d4f7880993503852ab2c7137ca",
    "files": [
        {
            "sha": "11f623ad0d35c118de5733f76092c853a6b8df56",
            "filename": "vcbuild.bat",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/2c473d65a4ef77d4f7880993503852ab2c7137ca/vcbuild.bat",
            "raw_url": "https://github.com/nodejs/node/raw/2c473d65a4ef77d4f7880993503852ab2c7137ca/vcbuild.bat",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/vcbuild.bat?ref=2c473d65a4ef77d4f7880993503852ab2c7137ca",
            "patch": "@@ -55,13 +55,14 @@ set http2_debug=\n set nghttp2_debug=\n set link_module=\n set no_cctest=\n+set cctest=\n set openssl_no_asm=\n set doc=\n \n :next-arg\n if \"%1\"==\"\" goto args-done\n if /i \"%1\"==\"debug\"         set config=Debug&goto arg-ok\n-if /i \"%1\"==\"release\"       set config=Release&set ltcg=1&set \"pch=\"&goto arg-ok\n+if /i \"%1\"==\"release\"       set config=Release&set ltcg=1&set \"pch=\"&set cctest=1&goto arg-ok\n if /i \"%1\"==\"clean\"         set target=Clean&goto arg-ok\n if /i \"%1\"==\"ia32\"          set target_arch=x86&goto arg-ok\n if /i \"%1\"==\"x86\"           set target_arch=x86&goto arg-ok\n@@ -125,6 +126,7 @@ if /i \"%1\"==\"no-NODE-OPTIONS\"\tset no_NODE_OPTIONS=1&goto arg-ok\n if /i \"%1\"==\"debug-nghttp2\" set debug_nghttp2=1&goto arg-ok\n if /i \"%1\"==\"link-module\"   set \"link_module= --link-module=%2%link_module%\"&goto arg-ok-2\n if /i \"%1\"==\"no-cctest\"     set no_cctest=1&goto arg-ok\n+if /i \"%1\"==\"cctest\"        set cctest=1&goto arg-ok\n if /i \"%1\"==\"openssl-no-asm\"   set openssl_no_asm=1&goto arg-ok\n if /i \"%1\"==\"doc\"           set doc=1&goto arg-ok\n \n@@ -151,6 +153,7 @@ if defined build_release (\n   set download_arg=\"--download=all\"\n   set i18n_arg=small-icu\n   set projgen=1\n+  set cctest=1\n   set ltcg=1\n   set \"pch=\"\n )\n@@ -301,7 +304,12 @@ set \"msbcpu=/m:2\"\n if \"%NUMBER_OF_PROCESSORS%\"==\"1\" set \"msbcpu=/m:1\"\n set \"msbplatform=Win32\"\n if \"%target_arch%\"==\"x64\" set \"msbplatform=x64\"\n-if \"%target%\"==\"Build\" if defined no_cctest set target=node\n+if \"%target%\"==\"Build\" (\n+  if defined no_cctest set target=rename_node_bin_win\n+  if \"%test_args%\"==\"\" set target=rename_node_bin_win\n+  if defined cctest set target=\"Build\"\n+)\n+if \"%target%\"==\"rename_node_bin_win\" if exist \"%config%\\cctest.exe\" del \"%config%\\cctest.exe\"\n msbuild node.sln %msbcpu% /t:%target% /p:Configuration=%config% /p:Platform=%msbplatform% /clp:NoSummary;NoItemAndPropertyList;Verbosity=minimal /nologo\n if errorlevel 1 (\n   if not defined project_generated echo Building Node with reused solution failed. To regenerate project files use \"vcbuild projgen\"\n@@ -533,7 +541,7 @@ if \"%test_args%\"==\"\" goto test-v8\n if \"%config%\"==\"Debug\" set test_args=--mode=debug %test_args%\n if \"%config%\"==\"Release\" set test_args=--mode=release %test_args%\n if defined no_cctest echo Skipping cctest because no-cctest was specified && goto run-test-py\n-if not exist %config%\\cctest.exe goto run-test-py\n+if not exist \"%config%\\cctest.exe\" echo cctest.exe not found. Run \"vcbuild test\" or \"vcbuild cctest\" to build it. && goto run-test-py\n echo running 'cctest %cctest_args%'\n \"%config%\\cctest\" %cctest_args%\n :run-test-py\n@@ -635,7 +643,7 @@ del .used_configure_flags\n goto exit\n \n :help\n-echo vcbuild.bat [debug/release] [msi] [doc] [test/test-ci/test-all/test-addons/test-addons-napi/test-benchmark/test-internet/test-pummel/test-simple/test-message/test-tick-processor/test-known-issues/test-node-inspect/test-check-deopts/test-npm/test-async-hooks/test-v8/test-v8-intl/test-v8-benchmarks/test-v8-all] [ignore-flaky] [static/dll] [noprojgen] [projgen] [small-icu/full-icu/without-intl] [nobuild] [nosnapshot] [noetw] [ltcg] [nopch] [licensetf] [sign] [ia32/x86/x64] [vs2017] [download-all] [enable-vtune] [lint/lint-ci/lint-js/lint-js-ci/lint-md] [lint-md-build] [package] [build-release] [upload] [no-NODE-OPTIONS] [link-module path-to-module] [debug-http2] [debug-nghttp2] [clean] [no-cctest] [openssl-no-asm]\n+echo vcbuild.bat [debug/release] [msi] [doc] [test/test-ci/test-all/test-addons/test-addons-napi/test-benchmark/test-internet/test-pummel/test-simple/test-message/test-tick-processor/test-known-issues/test-node-inspect/test-check-deopts/test-npm/test-async-hooks/test-v8/test-v8-intl/test-v8-benchmarks/test-v8-all] [ignore-flaky] [static/dll] [noprojgen] [projgen] [small-icu/full-icu/without-intl] [nobuild] [nosnapshot] [noetw] [ltcg] [nopch] [licensetf] [sign] [ia32/x86/x64] [vs2017] [download-all] [enable-vtune] [lint/lint-ci/lint-js/lint-js-ci/lint-md] [lint-md-build] [package] [build-release] [upload] [no-NODE-OPTIONS] [link-module path-to-module] [debug-http2] [debug-nghttp2] [clean] [cctest] [no-cctest] [openssl-no-asm]\n echo Examples:\n echo   vcbuild.bat                          : builds release build\n echo   vcbuild.bat debug                    : builds debug build"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 12,
        "deletions": 4
    }
}