{
    "author": "devsnek",
    "message": "test: formalize exposure of internal bindings\n\nmoves exposed internalBindings to a single location with short\nguidelines on how to expose them and a warning for users should they\ncome across it\n\nPR-URL: https://github.com/nodejs/node/pull/18698\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "3e8af961b384445564babfb1f0edd3cdefd19466",
    "files": [
        {
            "sha": "b2b11daead7ddeb59f5e63332fba036bc86a49a1",
            "filename": "lib/internal/loader/ModuleWrap.js",
            "status": "removed",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/01d049165c7d3ef9d102c85f0218044cb45f4787/lib%2Finternal%2Floader%2FModuleWrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/01d049165c7d3ef9d102c85f0218044cb45f4787/lib%2Finternal%2Floader%2FModuleWrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Floader%2FModuleWrap.js?ref=01d049165c7d3ef9d102c85f0218044cb45f4787",
            "patch": "@@ -1,5 +0,0 @@\n-'use strict';\n-\n-// exposes ModuleWrap for testing\n-\n-module.exports = internalBinding('module_wrap').ModuleWrap;"
        },
        {
            "sha": "7b9e1a089d2c369656b6a19efe278c5482cecc3b",
            "filename": "lib/internal/test/binding.js",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/3e8af961b384445564babfb1f0edd3cdefd19466/lib%2Finternal%2Ftest%2Fbinding.js",
            "raw_url": "https://github.com/nodejs/node/raw/3e8af961b384445564babfb1f0edd3cdefd19466/lib%2Finternal%2Ftest%2Fbinding.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ftest%2Fbinding.js?ref=3e8af961b384445564babfb1f0edd3cdefd19466",
            "patch": "@@ -0,0 +1,13 @@\n+'use strict';\n+\n+process.emitWarning(\n+  'These APIs are exposed only for testing and are not ' +\n+  'tracked by any versioning system or deprecation process.',\n+  'internal/test/binding');\n+\n+// These exports should be scoped as specifically as possible\n+// to avoid exposing APIs because even with that warning and\n+// this file being internal people will still try to abuse it.\n+module.exports = {\n+  ModuleWrap: internalBinding('module_wrap').ModuleWrap,\n+};"
        },
        {
            "sha": "d5bfad90fd7842d31aa504283b681233b83a9e44",
            "filename": "node.gyp",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/3e8af961b384445564babfb1f0edd3cdefd19466/node.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/3e8af961b384445564babfb1f0edd3cdefd19466/node.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/node.gyp?ref=3e8af961b384445564babfb1f0edd3cdefd19466",
            "patch": "@@ -107,7 +107,6 @@\n       'lib/internal/loader/DefaultResolve.js',\n       'lib/internal/loader/ModuleJob.js',\n       'lib/internal/loader/ModuleMap.js',\n-      'lib/internal/loader/ModuleWrap.js',\n       'lib/internal/loader/Translators.js',\n       'lib/internal/safe_globals.js',\n       'lib/internal/net.js',\n@@ -125,6 +124,7 @@\n       'lib/internal/repl.js',\n       'lib/internal/repl/await.js',\n       'lib/internal/socket_list.js',\n+      'lib/internal/test/binding.js',\n       'lib/internal/test/unicode.js',\n       'lib/internal/timers.js',\n       'lib/internal/tls.js',"
        },
        {
            "sha": "66a17a0f344701c37de89c90bdd81e17538a5805",
            "filename": "test/parallel/test-internal-module-wrap.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/3e8af961b384445564babfb1f0edd3cdefd19466/test%2Fparallel%2Ftest-internal-module-wrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/3e8af961b384445564babfb1f0edd3cdefd19466/test%2Fparallel%2Ftest-internal-module-wrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-internal-module-wrap.js?ref=3e8af961b384445564babfb1f0edd3cdefd19466",
            "patch": "@@ -6,7 +6,7 @@ const common = require('../common');\n common.crashOnUnhandledRejection();\n const assert = require('assert');\n \n-const ModuleWrap = require('internal/loader/ModuleWrap');\n+const { ModuleWrap } = require('internal/test/binding');\n const { getPromiseDetails, isPromise } = process.binding('util');\n const setTimeoutAsync = require('util').promisify(setTimeout);\n "
        }
    ],
    "stats": {
        "total": 22,
        "additions": 15,
        "deletions": 7
    }
}