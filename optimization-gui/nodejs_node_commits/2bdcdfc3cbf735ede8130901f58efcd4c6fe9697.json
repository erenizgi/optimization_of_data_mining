{
    "author": "devsnek",
    "message": "vm: rename vm.Module to vm.SourceTextModule\n\nAt the last TC39 meeting, a new type of Module Records backed by\nJavaScript source called Dynamic Module Records was discussed, and\nit is now at Stage 1. Regardless of whether that proposal makes it\nall the way into the spec, SourceTextModule is indeed a more\ndescriptive and accurate name for what this class represents.\n\nPR-URL: https://github.com/nodejs/node/pull/22007\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Jan Krems <jan.krems@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Yuta Hiroto <hello@hiroppy.me>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: John-David Dalton <john.david.dalton@gmail.com>\nReviewed-By: Bradley Farias <bradley.meck@gmail.com>",
    "sha": "2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
    "files": [
        {
            "sha": "c545e2ac072e465bb6e52d44a10b67b0113d4ef4",
            "filename": "doc/api/errors.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/doc%2Fapi%2Ferrors.md",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/doc%2Fapi%2Ferrors.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Ferrors.md?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -1811,7 +1811,7 @@ The module must be successfully linked before instantiation.\n <a id=\"ERR_VM_MODULE_NOT_MODULE\"></a>\n ### ERR_VM_MODULE_NOT_MODULE\n \n-The fulfilled value of a linking promise is not a `vm.Module` object.\n+The fulfilled value of a linking promise is not a `vm.SourceTextModule` object.\n \n <a id=\"ERR_VM_MODULE_STATUS\"></a>\n ### ERR_VM_MODULE_STATUS"
        },
        {
            "sha": "e2e3eba0c12820c222f5327d8d2d392207c16756",
            "filename": "doc/api/vm.md",
            "status": "modified",
            "additions": 22,
            "deletions": 22,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/doc%2Fapi%2Fvm.md",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/doc%2Fapi%2Fvm.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fvm.md?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -43,7 +43,7 @@ console.log(x); // 1; y is not defined.\n **The vm module is not a security mechanism. Do not use it to run untrusted\n code**.\n \n-## Class: vm.Module\n+## Class: vm.SourceTextModule\n <!-- YAML\n added: v9.6.0\n -->\n@@ -53,20 +53,20 @@ added: v9.6.0\n *This feature is only available with the `--experimental-vm-modules` command\n flag enabled.*\n \n-The `vm.Module` class provides a low-level interface for using ECMAScript\n-modules in VM contexts. It is the counterpart of the `vm.Script` class that\n-closely mirrors [Source Text Module Record][]s as defined in the ECMAScript\n-specification.\n+The `vm.SourceTextModule` class provides a low-level interface for using\n+ECMAScript modules in VM contexts. It is the counterpart of the `vm.Script`\n+class that closely mirrors [Source Text Module Record][]s as defined in the\n+ECMAScript specification.\n \n-Unlike `vm.Script` however, every `vm.Module` object is bound to a context from\n-its creation. Operations on `vm.Module` objects are intrinsically asynchronous,\n-in contrast with the synchronous nature of `vm.Script` objects. With the help\n-of async functions, however, manipulating `vm.Module` objects is fairly\n-straightforward.\n+Unlike `vm.Script` however, every `vm.SourceTextModule` object is bound to a\n+context from its creation. Operations on `vm.SourceTextModule` objects are\n+intrinsically asynchronous, in contrast with the synchronous nature of\n+`vm.Script` objects. With the help of async functions, however, manipulating\n+`vm.SourceTextModule` objects is fairly straightforward.\n \n-Using a `vm.Module` object requires four distinct steps: creation/parsing,\n-linking, instantiation, and evaluation. These four steps are illustrated in the\n-following example.\n+Using a `vm.SourceTextModule` object requires four distinct steps:\n+creation/parsing, linking, instantiation, and evaluation. These four steps are\n+illustrated in the following example.\n \n This implementation lies at a lower level than the [ECMAScript Module\n loader][]. There is also currently no way to interact with the Loader, though\n@@ -80,15 +80,15 @@ const contextifiedSandbox = vm.createContext({ secret: 42 });\n (async () => {\n   // Step 1\n   //\n-  // Create a Module by constructing a new `vm.Module` object. This parses the\n-  // provided source text, throwing a `SyntaxError` if anything goes wrong. By\n-  // default, a Module is created in the top context. But here, we specify\n-  // `contextifiedSandbox` as the context this Module belongs to.\n+  // Create a Module by constructing a new `vm.SourceTextModule` object. This\n+  // parses the provided source text, throwing a `SyntaxError` if anything goes\n+  // wrong. By default, a Module is created in the top context. But here, we\n+  // specify `contextifiedSandbox` as the context this Module belongs to.\n   //\n   // Here, we attempt to obtain the default export from the module \"foo\", and\n   // put it into local binding \"secret\".\n \n-  const bar = new vm.Module(`\n+  const bar = new vm.SourceTextModule(`\n     import s from 'foo';\n     s;\n   `, { context: contextifiedSandbox });\n@@ -118,7 +118,7 @@ const contextifiedSandbox = vm.createContext({ secret: 42 });\n \n   async function linker(specifier, referencingModule) {\n     if (specifier === 'foo') {\n-      return new vm.Module(`\n+      return new vm.SourceTextModule(`\n         // The \"secret\" variable refers to the global variable we added to\n         // \"contextifiedSandbox\" when creating the context.\n         export default secret;\n@@ -155,7 +155,7 @@ const contextifiedSandbox = vm.createContext({ secret: 42 });\n })();\n ```\n \n-### Constructor: new vm.Module(code[, options])\n+### Constructor: new vm.SourceTextModule(code[, options])\n \n * `code` {string} JavaScript Module code to parse\n * `options`\n@@ -170,7 +170,7 @@ const contextifiedSandbox = vm.createContext({ secret: 42 });\n   * `initalizeImportMeta` {Function} Called during evaluation of this `Module`\n     to initialize the `import.meta`. This function has the signature `(meta,\n     module)`, where `meta` is the `import.meta` object in the `Module`, and\n-    `module` is this `vm.Module` object.\n+    `module` is this `vm.SourceTextModule` object.\n \n Creates a new ES `Module` object.\n \n@@ -185,7 +185,7 @@ const vm = require('vm');\n const contextifiedSandbox = vm.createContext({ secret: 42 });\n \n (async () => {\n-  const module = new vm.Module(\n+  const module = new vm.SourceTextModule(\n     'Object.getPrototypeOf(import.meta.prop).secret = secret;',\n     {\n       initializeImportMeta(meta) {"
        },
        {
            "sha": "c622084415f7a90955086cea2dec4a2ea8e81c59",
            "filename": "lib/internal/process/esm_loader.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/lib%2Finternal%2Fprocess%2Fesm_loader.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/lib%2Finternal%2Fprocess%2Fesm_loader.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fprocess%2Fesm_loader.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -13,7 +13,7 @@ const { URL } = require('url');\n const {\n   initImportMetaMap,\n   wrapToModuleMap\n-} = require('internal/vm/module');\n+} = require('internal/vm/source_text_module');\n \n function normalizeReferrerURL(referrer) {\n   if (typeof referrer === 'string' && path.isAbsolute(referrer)) {\n@@ -30,8 +30,8 @@ function initializeImportMetaObject(wrap, meta) {\n   } else {\n     const initializeImportMeta = initImportMetaMap.get(vmModule);\n     if (initializeImportMeta !== undefined) {\n-      // This ModuleWrap belongs to vm.Module, initializer callback was\n-      // provided.\n+      // This ModuleWrap belongs to vm.SourceTextModule,\n+      // initializer callback was provided.\n       initializeImportMeta(meta, vmModule);\n     }\n   }"
        },
        {
            "sha": "bea7d7c94aea0414b659d0978a52dfcd83216019",
            "filename": "lib/internal/vm/source_text_module.js",
            "status": "renamed",
            "additions": 7,
            "deletions": 6,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/lib%2Finternal%2Fvm%2Fsource_text_module.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/lib%2Finternal%2Fvm%2Fsource_text_module.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fvm%2Fsource_text_module.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -44,15 +44,16 @@ const perContextModuleId = new WeakMap();\n const wrapMap = new WeakMap();\n const dependencyCacheMap = new WeakMap();\n const linkingStatusMap = new WeakMap();\n-// vm.Module -> function\n+// vm.SourceTextModule -> function\n const initImportMetaMap = new WeakMap();\n-// ModuleWrap -> vm.Module\n+// ModuleWrap -> vm.SourceTextModule\n const wrapToModuleMap = new WeakMap();\n const defaultModuleName = 'vm:module';\n \n-class Module {\n+// TODO(devsnek): figure out AbstractModule class or protocol\n+class SourceTextModule {\n   constructor(src, options = {}) {\n-    emitExperimentalWarning('vm.Module');\n+    emitExperimentalWarning('vm.SourceTextModule');\n \n     if (typeof src !== 'string')\n       throw new ERR_INVALID_ARG_TYPE('src', 'string', src);\n@@ -229,7 +230,7 @@ class Module {\n \n   [customInspectSymbol](depth, options) {\n     let ctor = getConstructorOf(this);\n-    ctor = ctor === null ? Module : ctor;\n+    ctor = ctor === null ? SourceTextModule : ctor;\n \n     if (typeof depth === 'number' && depth < 0)\n       return options.stylize(`[${ctor.name}]`, 'special');\n@@ -244,7 +245,7 @@ class Module {\n }\n \n module.exports = {\n-  Module,\n+  SourceTextModule,\n   initImportMetaMap,\n   wrapToModuleMap\n };",
            "previous_filename": "lib/internal/vm/module.js"
        },
        {
            "sha": "c813ca3049e3e07d986f243b7cd67d06ec708bd3",
            "filename": "lib/vm.js",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/lib%2Fvm.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/lib%2Fvm.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fvm.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -296,5 +296,7 @@ module.exports = {\n   isContext,\n };\n \n-if (process.binding('config').experimentalVMModules)\n-  module.exports.Module = require('internal/vm/module').Module;\n+if (process.binding('config').experimentalVMModules) {\n+  const { SourceTextModule } = require('internal/vm/source_text_module');\n+  module.exports.SourceTextModule = SourceTextModule;\n+}"
        },
        {
            "sha": "7460d73c0b578a84d1947981506743c82c354922",
            "filename": "node.gyp",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/node.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/node.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/node.gyp?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -167,7 +167,7 @@\n       'lib/internal/v8_prof_processor.js',\n       'lib/internal/validators.js',\n       'lib/internal/stream_base_commons.js',\n-      'lib/internal/vm/module.js',\n+      'lib/internal/vm/source_text_module.js',\n       'lib/internal/worker.js',\n       'lib/internal/streams/lazy_transform.js',\n       'lib/internal/streams/async_iterator.js',"
        },
        {
            "sha": "f2b6e57178b0417f76fa3ae61dd6a0147cd57e6d",
            "filename": "test/parallel/test-util-inspect-namespace.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-util-inspect-namespace.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-util-inspect-namespace.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-util-inspect-namespace.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -5,11 +5,11 @@\n require('../common');\n const assert = require('assert');\n \n-const { Module } = require('vm');\n+const { SourceTextModule } = require('vm');\n const { inspect } = require('util');\n \n (async () => {\n-  const m = new Module('export const a = 1; export var b = 2');\n+  const m = new SourceTextModule('export const a = 1; export var b = 2');\n   await m.link(() => 0);\n   m.instantiate();\n   assert.strictEqual("
        },
        {
            "sha": "740ac7f472dc1f85c16fa4f2a15f2e2fbb6a2321",
            "filename": "test/parallel/test-util-types.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-util-types.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-util-types.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-util-types.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -126,7 +126,7 @@ for (const [ value, _method ] of [\n }\n \n (async () => {\n-  const m = new vm.Module('');\n+  const m = new vm.SourceTextModule('');\n   await m.link(() => 0);\n   m.instantiate();\n   await m.evaluate();"
        },
        {
            "sha": "ffe376ccc2b1b175bd0aa7cba163149f5d7db82a",
            "filename": "test/parallel/test-vm-module-basic.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-basic.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-basic.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-basic.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -4,15 +4,15 @@\n \n const common = require('../common');\n const assert = require('assert');\n-const { Module, createContext } = require('vm');\n+const { SourceTextModule, createContext } = require('vm');\n \n (async function test1() {\n   const context = createContext({\n     foo: 'bar',\n     baz: undefined,\n     typeofProcess: undefined,\n   });\n-  const m = new Module(\n+  const m = new SourceTextModule(\n     'baz = foo; typeofProcess = typeof process; typeof Object;',\n     { context }\n   );\n@@ -32,7 +32,7 @@ const { Module, createContext } = require('vm');\n }());\n \n (async () => {\n-  const m = new Module(\n+  const m = new SourceTextModule(\n     'global.vmResult = \"foo\"; Object.prototype.toString.call(process);'\n   );\n   await m.link(common.mustNotCall());\n@@ -44,7 +44,7 @@ const { Module, createContext } = require('vm');\n })();\n \n (async () => {\n-  const m = new Module('while (true) {}');\n+  const m = new SourceTextModule('while (true) {}');\n   await m.link(common.mustNotCall());\n   m.instantiate();\n   await m.evaluate({ timeout: 500 })"
        },
        {
            "sha": "35c57d8b3efcbe37e0162b1c10473de58eaeb5c4",
            "filename": "test/parallel/test-vm-module-dynamic-import.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-dynamic-import.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-dynamic-import.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-dynamic-import.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -5,12 +5,12 @@\n const common = require('../common');\n \n const assert = require('assert');\n-const { Module, createContext } = require('vm');\n+const { SourceTextModule, createContext } = require('vm');\n \n const finished = common.mustCall();\n \n (async function() {\n-  const m = new Module('import(\"foo\")', { context: createContext() });\n+  const m = new SourceTextModule('import(\"foo\")', { context: createContext() });\n   await m.link(common.mustNotCall());\n   m.instantiate();\n   const { result } = await m.evaluate();"
        },
        {
            "sha": "6803e0d86b3ff4d20e17a22642a6bd6d8d2503a8",
            "filename": "test/parallel/test-vm-module-errors.js",
            "status": "modified",
            "additions": 22,
            "deletions": 22,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-errors.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-errors.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-errors.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -6,7 +6,7 @@ const common = require('../common');\n \n const assert = require('assert');\n \n-const { Module, createContext } = require('vm');\n+const { SourceTextModule, createContext } = require('vm');\n \n async function expectsRejection(fn, settings) {\n   const validateError = common.expectsError(settings);\n@@ -29,14 +29,14 @@ async function expectsRejection(fn, settings) {\n }\n \n async function createEmptyLinkedModule() {\n-  const m = new Module('');\n+  const m = new SourceTextModule('');\n   await m.link(common.mustNotCall());\n   return m;\n }\n \n async function checkArgType() {\n   common.expectsError(() => {\n-    new Module();\n+    new SourceTextModule();\n   }, {\n     code: 'ERR_INVALID_ARG_TYPE',\n     type: TypeError\n@@ -46,7 +46,7 @@ async function checkArgType() {\n     0, 1, null, true, 'str', () => {}, { url: 0 }, Symbol.iterator\n   ]) {\n     common.expectsError(() => {\n-      new Module('', invalidOptions);\n+      new SourceTextModule('', invalidOptions);\n     }, {\n       code: 'ERR_INVALID_ARG_TYPE',\n       type: TypeError\n@@ -57,7 +57,7 @@ async function checkArgType() {\n     0, 1, undefined, null, true, 'str', {}, Symbol.iterator\n   ]) {\n     await expectsRejection(async () => {\n-      const m = new Module('');\n+      const m = new SourceTextModule('');\n       await m.link(invalidLinker);\n     }, {\n       code: 'ERR_INVALID_ARG_TYPE',\n@@ -69,7 +69,7 @@ async function checkArgType() {\n // Check methods/properties can only be used under a specific state.\n async function checkModuleState() {\n   await expectsRejection(async () => {\n-    const m = new Module('');\n+    const m = new SourceTextModule('');\n     await m.link(common.mustNotCall());\n     assert.strictEqual(m.linkingStatus, 'linked');\n     await m.link(common.mustNotCall());\n@@ -78,7 +78,7 @@ async function checkModuleState() {\n   });\n \n   await expectsRejection(async () => {\n-    const m = new Module('');\n+    const m = new SourceTextModule('');\n     m.link(common.mustNotCall());\n     assert.strictEqual(m.linkingStatus, 'linking');\n     await m.link(common.mustNotCall());\n@@ -87,14 +87,14 @@ async function checkModuleState() {\n   });\n \n   common.expectsError(() => {\n-    const m = new Module('');\n+    const m = new SourceTextModule('');\n     m.instantiate();\n   }, {\n     code: 'ERR_VM_MODULE_NOT_LINKED'\n   });\n \n   await expectsRejection(async () => {\n-    const m = new Module('import \"foo\";');\n+    const m = new SourceTextModule('import \"foo\";');\n     try {\n       await m.link(common.mustCall(() => ({})));\n     } catch (err) {\n@@ -107,7 +107,7 @@ async function checkModuleState() {\n   });\n \n   {\n-    const m = new Module('import \"foo\";');\n+    const m = new SourceTextModule('import \"foo\";');\n     await m.link(common.mustCall(async (specifier, module) => {\n       assert.strictEqual(module, m);\n       assert.strictEqual(specifier, 'foo');\n@@ -117,14 +117,14 @@ async function checkModuleState() {\n       }, {\n         code: 'ERR_VM_MODULE_NOT_LINKED'\n       });\n-      return new Module('');\n+      return new SourceTextModule('');\n     }));\n     m.instantiate();\n     await m.evaluate();\n   }\n \n   await expectsRejection(async () => {\n-    const m = new Module('');\n+    const m = new SourceTextModule('');\n     await m.evaluate();\n   }, {\n     code: 'ERR_VM_MODULE_STATUS',\n@@ -140,7 +140,7 @@ async function checkModuleState() {\n   });\n \n   common.expectsError(() => {\n-    const m = new Module('');\n+    const m = new SourceTextModule('');\n     m.error;\n   }, {\n     code: 'ERR_VM_MODULE_STATUS',\n@@ -158,7 +158,7 @@ async function checkModuleState() {\n   });\n \n   common.expectsError(() => {\n-    const m = new Module('');\n+    const m = new SourceTextModule('');\n     m.namespace;\n   }, {\n     code: 'ERR_VM_MODULE_STATUS',\n@@ -177,7 +177,7 @@ async function checkModuleState() {\n // Check link() fails when the returned module is not valid.\n async function checkLinking() {\n   await expectsRejection(async () => {\n-    const m = new Module('import \"foo\";');\n+    const m = new SourceTextModule('import \"foo\";');\n     try {\n       await m.link(common.mustCall(() => ({})));\n     } catch (err) {\n@@ -191,9 +191,9 @@ async function checkLinking() {\n \n   await expectsRejection(async () => {\n     const c = createContext({ a: 1 });\n-    const foo = new Module('', { context: c });\n+    const foo = new SourceTextModule('', { context: c });\n     await foo.link(common.mustNotCall());\n-    const bar = new Module('import \"foo\";');\n+    const bar = new SourceTextModule('import \"foo\";');\n     try {\n       await bar.link(common.mustCall(() => foo));\n     } catch (err) {\n@@ -206,7 +206,7 @@ async function checkLinking() {\n   });\n \n   await expectsRejection(async () => {\n-    const erroredModule = new Module('import \"foo\";');\n+    const erroredModule = new SourceTextModule('import \"foo\";');\n     try {\n       await erroredModule.link(common.mustCall(() => ({})));\n     } catch (err) {\n@@ -215,7 +215,7 @@ async function checkLinking() {\n       assert.strictEqual(erroredModule.linkingStatus, 'errored');\n     }\n \n-    const rootModule = new Module('import \"errored\";');\n+    const rootModule = new SourceTextModule('import \"errored\";');\n     await rootModule.link(common.mustCall(() => erroredModule));\n   }, {\n     code: 'ERR_VM_MODULE_LINKING_ERRORED'\n@@ -225,8 +225,8 @@ async function checkLinking() {\n // Check the JavaScript engine deals with exceptions correctly\n async function checkExecution() {\n   await (async () => {\n-    const m = new Module('import { nonexistent } from \"module\";');\n-    await m.link(common.mustCall(() => new Module('')));\n+    const m = new SourceTextModule('import { nonexistent } from \"module\";');\n+    await m.link(common.mustCall(() => new SourceTextModule('')));\n \n     // There is no code for this exception since it is thrown by the JavaScript\n     // engine.\n@@ -236,7 +236,7 @@ async function checkExecution() {\n   })();\n \n   await (async () => {\n-    const m = new Module('throw new Error();');\n+    const m = new SourceTextModule('throw new Error();');\n     await m.link(common.mustNotCall());\n     m.instantiate();\n     const evaluatePromise = m.evaluate();"
        },
        {
            "sha": "f7bc82f9b272adff30cd1d582587c4115f051648",
            "filename": "test/parallel/test-vm-module-import-meta.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-import-meta.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-import-meta.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-import-meta.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -4,10 +4,10 @@\n \n const common = require('../common');\n const assert = require('assert');\n-const { Module } = require('vm');\n+const { SourceTextModule } = require('vm');\n \n async function testBasic() {\n-  const m = new Module('import.meta;', {\n+  const m = new SourceTextModule('import.meta;', {\n     initializeImportMeta: common.mustCall((meta, module) => {\n       assert.strictEqual(module, m);\n       meta.prop = 42;\n@@ -27,7 +27,7 @@ async function testInvalid() {\n     null, {}, 0, Symbol.iterator, [], 'string', false\n   ]) {\n     common.expectsError(() => {\n-      new Module('', {\n+      new SourceTextModule('', {\n         initializeImportMeta: invalidValue\n       });\n     }, {"
        },
        {
            "sha": "20518c405404851d5c84daf4583bacbd4ddcb7f8",
            "filename": "test/parallel/test-vm-module-link.js",
            "status": "modified",
            "additions": 11,
            "deletions": 9,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-link.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-link.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-link.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -7,13 +7,13 @@ const common = require('../common');\n const assert = require('assert');\n const { URL } = require('url');\n \n-const { Module } = require('vm');\n+const { SourceTextModule } = require('vm');\n \n async function simple() {\n-  const foo = new Module('export default 5;');\n+  const foo = new SourceTextModule('export default 5;');\n   await foo.link(common.mustNotCall());\n \n-  const bar = new Module('import five from \"foo\"; five');\n+  const bar = new SourceTextModule('import five from \"foo\"; five');\n \n   assert.deepStrictEqual(bar.dependencySpecifiers, ['foo']);\n \n@@ -29,11 +29,11 @@ async function simple() {\n }\n \n async function depth() {\n-  const foo = new Module('export default 5');\n+  const foo = new SourceTextModule('export default 5');\n   await foo.link(common.mustNotCall());\n \n   async function getProxy(parentName, parentModule) {\n-    const mod = new Module(`\n+    const mod = new SourceTextModule(`\n       import ${parentName} from '${parentName}';\n       export default ${parentName};\n     `);\n@@ -56,12 +56,12 @@ async function depth() {\n }\n \n async function circular() {\n-  const foo = new Module(`\n+  const foo = new SourceTextModule(`\n     import getFoo from 'bar';\n     export let foo = 42;\n     export default getFoo();\n   `);\n-  const bar = new Module(`\n+  const bar = new SourceTextModule(`\n     import { foo } from 'foo';\n     export default function getFoo() {\n       return foo;\n@@ -109,12 +109,14 @@ async function circular2() {\n     `\n   };\n   const moduleMap = new Map();\n-  const rootModule = new Module(sourceMap.root, { url: 'vm:root' });\n+  const rootModule = new SourceTextModule(sourceMap.root, { url: 'vm:root' });\n   async function link(specifier, referencingModule) {\n     if (moduleMap.has(specifier)) {\n       return moduleMap.get(specifier);\n     }\n-    const mod = new Module(sourceMap[specifier], { url: new URL(specifier, 'file:///').href });\n+    const mod = new SourceTextModule(sourceMap[specifier], {\n+      url: new URL(specifier, 'file:///').href,\n+    });\n     moduleMap.set(specifier, mod);\n     return mod;\n   }"
        },
        {
            "sha": "c3914f362fa814b4e481376950dff4242284e065",
            "filename": "test/parallel/test-vm-module-reevaluate.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-reevaluate.js",
            "raw_url": "https://github.com/nodejs/node/raw/2bdcdfc3cbf735ede8130901f58efcd4c6fe9697/test%2Fparallel%2Ftest-vm-module-reevaluate.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-reevaluate.js?ref=2bdcdfc3cbf735ede8130901f58efcd4c6fe9697",
            "patch": "@@ -6,13 +6,13 @@ const common = require('../common');\n \n const assert = require('assert');\n \n-const { Module } = require('vm');\n+const { SourceTextModule } = require('vm');\n \n const finished = common.mustCall();\n \n (async function main() {\n   {\n-    const m = new Module('1');\n+    const m = new SourceTextModule('1');\n     await m.link(common.mustNotCall());\n     m.instantiate();\n     assert.strictEqual((await m.evaluate()).result, 1);\n@@ -21,7 +21,7 @@ const finished = common.mustCall();\n   }\n \n   {\n-    const m = new Module('throw new Error()');\n+    const m = new SourceTextModule('throw new Error()');\n     await m.link(common.mustNotCall());\n     m.instantiate();\n "
        }
    ],
    "stats": {
        "total": 167,
        "additions": 86,
        "deletions": 81
    }
}