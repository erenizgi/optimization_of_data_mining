{
    "author": "hashseed",
    "message": "deps: V8: cherry-pick 64-bit hash seed commits\n\nThis serves as mitigation for the so-called HashWick vulnerability.\n\nOriginal commit messages:\n\n  commit 3833fef57368c53c6170559ffa524c8c69f16ee5\n    Author: Yang Guo <yangguo@chromium.org>\n    Date: Thu Sep 20 11:43:13 2018\n\n    Refactor integer hashing function names\n\n    We now clearly differentiate between:\n    - unseeded hash for 32-bit integers\n    - unseeded hash for 64-bit integers\n    - seeded hash for 32-bit integers\n    - seeded hash for strings\n\n    R=bmeurer@chromium.org\n\n    Bug: chromium:680662\n    Change-Id: I7459958c4158ee3501c962943dff8f33258bb5ce\n    Reviewed-on: https://chromium-review.googlesource.com/1235973\n    Commit-Queue: Yang Guo <yangguo@chromium.org>\n    Reviewed-by: Benedikt Meurer <bmeurer@chromium.org>\n    Cr-Commit-Position: refs/heads/master@{#56068}\n\n  commit 95a979e02d7154e45b293261a6998c99d71fc238\n    Author: Yang Guo <yangguo@chromium.org>\n    Date: Thu Sep 20 14:34:48 2018\n\n    Call into C++ to compute seeded integer hash\n\n    R=bmeurer@chromium.org\n\n    Bug: chromium:680662\n    Change-Id: I8dace89d576dfcc5833fd539ce698a9ade1cb5a0\n    Reviewed-on: https://chromium-review.googlesource.com/1235928\n    Commit-Queue: Yang Guo <yangguo@chromium.org>\n    Reviewed-by: Benedikt Meurer <bmeurer@chromium.org>\n    Cr-Commit-Position: refs/heads/master@{#56091}\n\n  commit 2c2af0022d5feb9e525a00a76cb15db9f3e38dba\n    Author: Yang Guo <yangguo@chromium.org>\n    Date: Thu Sep 27 16:37:57 2018\n\n    Use 64-bit for seeded integer hashes\n\n    R=petermarshall@chromium.org\n\n    Bug: chromium:680662\n    Change-Id: If48d1043dbe1e1bb695ec890c23e103a6cacf2d4\n    Reviewed-on: https://chromium-review.googlesource.com/1244220\n    Commit-Queue: Yang Guo <yangguo@chromium.org>\n    Reviewed-by: Peter Marshall <petermarshall@chromium.org>\n    Cr-Commit-Position: refs/heads/master@{#56271}\n\nRefs: https://github.com/nodejs/node/issues/23259\n\nPR-URL: https://github.com/nodejs/node/pull/23264\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Ali Ijaz Sheikh <ofrobots@google.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>",
    "sha": "314c1fa5839559f29507e93a3b14fa4b4d380460",
    "files": [
        {
            "sha": "4c43db48f3cd30e23e2865a8d732a60a3d41b862",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -25,7 +25,7 @@\n     'uv_library%': 'static_library',\n \n     'clang%': 0,\n-    \n+\n     'openssl_fips%': '',\n \n     # Default to -O0 for debug builds."
        },
        {
            "sha": "aab0475e21bd8a9c9d9db0ef51653edff002189b",
            "filename": "deps/v8/src/builtins/builtins-collections-gen.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-collections-gen.cc",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-collections-gen.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-collections-gen.cc?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -689,7 +689,7 @@ class CollectionsBuiltinsAssembler : public BaseCollectionsAssembler {\n                                              Node* key_tagged, Variable* result,\n                                              Label* entry_found,\n                                              Label* not_found);\n-  Node* ComputeIntegerHashForString(Node* context, Node* string_key);\n+  Node* ComputeStringHash(Node* context, Node* string_key);\n   void SameValueZeroString(Node* context, Node* key_string, Node* candidate_key,\n                            Label* if_same, Label* if_not_same);\n \n@@ -846,8 +846,7 @@ void CollectionsBuiltinsAssembler::FindOrderedHashTableEntryForSmiKey(\n     Node* table, Node* smi_key, Variable* result, Label* entry_found,\n     Label* not_found) {\n   Node* const key_untagged = SmiUntag(smi_key);\n-  Node* const hash =\n-      ChangeInt32ToIntPtr(ComputeIntegerHash(key_untagged, Int32Constant(0)));\n+  Node* const hash = ChangeInt32ToIntPtr(ComputeUnseededHash(key_untagged));\n   CSA_ASSERT(this, IntPtrGreaterThanOrEqual(hash, IntPtrConstant(0)));\n   result->Bind(hash);\n   FindOrderedHashTableEntry<CollectionType>(\n@@ -862,7 +861,7 @@ template <typename CollectionType>\n void CollectionsBuiltinsAssembler::FindOrderedHashTableEntryForStringKey(\n     Node* context, Node* table, Node* key_tagged, Variable* result,\n     Label* entry_found, Label* not_found) {\n-  Node* const hash = ComputeIntegerHashForString(context, key_tagged);\n+  Node* const hash = ComputeStringHash(context, key_tagged);\n   CSA_ASSERT(this, IntPtrGreaterThanOrEqual(hash, IntPtrConstant(0)));\n   result->Bind(hash);\n   FindOrderedHashTableEntry<CollectionType>(\n@@ -920,8 +919,8 @@ void CollectionsBuiltinsAssembler::FindOrderedHashTableEntryForOtherKey(\n       result, entry_found, not_found);\n }\n \n-Node* CollectionsBuiltinsAssembler::ComputeIntegerHashForString(\n-    Node* context, Node* string_key) {\n+Node* CollectionsBuiltinsAssembler::ComputeStringHash(Node* context,\n+                                                      Node* string_key) {\n   VARIABLE(var_result, MachineType::PointerRepresentation());\n \n   Label hash_not_computed(this), done(this, &var_result);"
        },
        {
            "sha": "5bd780b520b307df7d3c9390e938e722c4024eaa",
            "filename": "deps/v8/src/code-stub-assembler.cc",
            "status": "modified",
            "additions": 18,
            "deletions": 51,
            "changes": 69,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.cc",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.cc?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -253,40 +253,6 @@ HEAP_IMMUTABLE_IMMOVABLE_OBJECT_LIST(HEAP_CONSTANT_ACCESSOR);\n HEAP_IMMOVABLE_OBJECT_LIST(HEAP_CONSTANT_TEST);\n #undef HEAP_CONSTANT_TEST\n \n-TNode<Int64T> CodeStubAssembler::HashSeed() {\n-  DCHECK(Is64());\n-  TNode<HeapObject> hash_seed_root =\n-      TNode<HeapObject>::UncheckedCast(LoadRoot(Heap::kHashSeedRootIndex));\n-  return TNode<Int64T>::UncheckedCast(LoadObjectField(\n-      hash_seed_root, ByteArray::kHeaderSize, MachineType::Int64()));\n-}\n-\n-TNode<Int32T> CodeStubAssembler::HashSeedHigh() {\n-  DCHECK(!Is64());\n-#ifdef V8_TARGET_BIG_ENDIAN\n-  static int kOffset = 0;\n-#else\n-  static int kOffset = kInt32Size;\n-#endif\n-  TNode<HeapObject> hash_seed_root =\n-      TNode<HeapObject>::UncheckedCast(LoadRoot(Heap::kHashSeedRootIndex));\n-  return TNode<Int32T>::UncheckedCast(LoadObjectField(\n-      hash_seed_root, ByteArray::kHeaderSize + kOffset, MachineType::Int32()));\n-}\n-\n-TNode<Int32T> CodeStubAssembler::HashSeedLow() {\n-  DCHECK(!Is64());\n-#ifdef V8_TARGET_BIG_ENDIAN\n-  static int kOffset = kInt32Size;\n-#else\n-  static int kOffset = 0;\n-#endif\n-  TNode<HeapObject> hash_seed_root =\n-      TNode<HeapObject>::UncheckedCast(LoadRoot(Heap::kHashSeedRootIndex));\n-  return TNode<Int32T>::UncheckedCast(LoadObjectField(\n-      hash_seed_root, ByteArray::kHeaderSize + kOffset, MachineType::Int32()));\n-}\n-\n Node* CodeStubAssembler::IntPtrOrSmiConstant(int value, ParameterMode mode) {\n   if (mode == SMI_PARAMETERS) {\n     return SmiConstant(value);\n@@ -7709,14 +7675,9 @@ template void CodeStubAssembler::NameDictionaryLookup<GlobalDictionary>(\n     TNode<GlobalDictionary>, TNode<Name>, Label*, TVariable<IntPtrT>*, Label*,\n     int, LookupMode);\n \n-Node* CodeStubAssembler::ComputeIntegerHash(Node* key) {\n-  return ComputeIntegerHash(key, IntPtrConstant(kZeroHashSeed));\n-}\n-\n-Node* CodeStubAssembler::ComputeIntegerHash(Node* key, Node* seed) {\n-  // See v8::internal::ComputeIntegerHash()\n+Node* CodeStubAssembler::ComputeUnseededHash(Node* key) {\n+  // See v8::internal::ComputeUnseededHash()\n   Node* hash = TruncateIntPtrToInt32(key);\n-  hash = Word32Xor(hash, seed);\n   hash = Int32Add(Word32Xor(hash, Int32Constant(0xFFFFFFFF)),\n                   Word32Shl(hash, Int32Constant(15)));\n   hash = Word32Xor(hash, Word32Shr(hash, Int32Constant(12)));\n@@ -7727,6 +7688,21 @@ Node* CodeStubAssembler::ComputeIntegerHash(Node* key, Node* seed) {\n   return Word32And(hash, Int32Constant(0x3FFFFFFF));\n }\n \n+Node* CodeStubAssembler::ComputeSeededHash(Node* key) {\n+  Node* const function_addr =\n+      ExternalConstant(ExternalReference::compute_integer_hash());\n+  Node* const isolate_ptr =\n+      ExternalConstant(ExternalReference::isolate_address(isolate()));\n+\n+  MachineType type_ptr = MachineType::Pointer();\n+  MachineType type_uint32 = MachineType::Uint32();\n+\n+  Node* const result =\n+      CallCFunction2(type_uint32, type_ptr, type_uint32, function_addr,\n+                     isolate_ptr, TruncateIntPtrToInt32(key));\n+  return result;\n+}\n+\n void CodeStubAssembler::NumberDictionaryLookup(\n     TNode<NumberDictionary> dictionary, TNode<IntPtrT> intptr_index,\n     Label* if_found, TVariable<IntPtrT>* var_entry, Label* if_not_found) {\n@@ -7737,16 +7713,7 @@ void CodeStubAssembler::NumberDictionaryLookup(\n   TNode<IntPtrT> capacity = SmiUntag(GetCapacity<NumberDictionary>(dictionary));\n   TNode<WordT> mask = IntPtrSub(capacity, IntPtrConstant(1));\n \n-  TNode<Int32T> int32_seed;\n-\n-  if (Is64()) {\n-    int32_seed = TruncateInt64ToInt32(HashSeed());\n-  } else {\n-    int32_seed = HashSeedLow();\n-  }\n-\n-  TNode<WordT> hash =\n-      ChangeUint32ToWord(ComputeIntegerHash(intptr_index, int32_seed));\n+  TNode<WordT> hash = ChangeUint32ToWord(ComputeSeededHash(intptr_index));\n   Node* key_as_float64 = RoundIntPtrToFloat64(intptr_index);\n \n   // See Dictionary::FirstProbe()."
        },
        {
            "sha": "38fc9717de0542b9b94f4143c5a5e4e3e60f1dc0",
            "filename": "deps/v8/src/code-stub-assembler.h",
            "status": "modified",
            "additions": 2,
            "deletions": 6,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.h",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.h?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -450,10 +450,6 @@ class V8_EXPORT_PRIVATE CodeStubAssembler : public compiler::CodeAssembler {\n   HEAP_IMMOVABLE_OBJECT_LIST(HEAP_CONSTANT_TEST)\n #undef HEAP_CONSTANT_TEST\n \n-  TNode<Int64T> HashSeed();\n-  TNode<Int32T> HashSeedHigh();\n-  TNode<Int32T> HashSeedLow();\n-\n   Node* IntPtrOrSmiConstant(int value, ParameterMode mode);\n   TNode<Smi> LanguageModeConstant(LanguageMode mode) {\n     return SmiConstant(static_cast<int>(mode));\n@@ -2288,8 +2284,8 @@ class V8_EXPORT_PRIVATE CodeStubAssembler : public compiler::CodeAssembler {\n                             int inlined_probes = kInlinedDictionaryProbes,\n                             LookupMode mode = kFindExisting);\n \n-  Node* ComputeIntegerHash(Node* key);\n-  Node* ComputeIntegerHash(Node* key, Node* seed);\n+  Node* ComputeUnseededHash(Node* key);\n+  Node* ComputeSeededHash(Node* key);\n \n   void NumberDictionaryLookup(TNode<NumberDictionary> dictionary,\n                               TNode<IntPtrT> intptr_index, Label* if_found,"
        },
        {
            "sha": "4bb4f8df776ffde88c5b76cea6d58d6c482a767f",
            "filename": "deps/v8/src/compiler/effect-control-linearizer.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fcompiler%2Feffect-control-linearizer.cc",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fcompiler%2Feffect-control-linearizer.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fcompiler%2Feffect-control-linearizer.cc?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -4768,8 +4768,8 @@ Node* EffectControlLinearizer::LowerFindOrderedHashMapEntry(Node* node) {\n   }\n }\n \n-Node* EffectControlLinearizer::ComputeIntegerHash(Node* value) {\n-  // See v8::internal::ComputeIntegerHash()\n+Node* EffectControlLinearizer::ComputeUnseededHash(Node* value) {\n+  // See v8::internal::ComputeUnseededHash()\n   value = __ Int32Add(__ Word32Xor(value, __ Int32Constant(0xFFFFFFFF)),\n                       __ Word32Shl(value, __ Int32Constant(15)));\n   value = __ Word32Xor(value, __ Word32Shr(value, __ Int32Constant(12)));\n@@ -4787,7 +4787,7 @@ Node* EffectControlLinearizer::LowerFindOrderedHashMapEntryForInt32Key(\n   Node* key = NodeProperties::GetValueInput(node, 1);\n \n   // Compute the integer hash code.\n-  Node* hash = ChangeUint32ToUintPtr(ComputeIntegerHash(key));\n+  Node* hash = ChangeUint32ToUintPtr(ComputeUnseededHash(key));\n \n   Node* number_of_buckets = ChangeSmiToIntPtr(__ LoadField(\n       AccessBuilder::ForOrderedHashTableBaseNumberOfBuckets(), table));"
        },
        {
            "sha": "272bc44599692c27abc2d86b566b3eb8a1c2fdfc",
            "filename": "deps/v8/src/compiler/effect-control-linearizer.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fcompiler%2Feffect-control-linearizer.h",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fcompiler%2Feffect-control-linearizer.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fcompiler%2Feffect-control-linearizer.h?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -182,7 +182,7 @@ class V8_EXPORT_PRIVATE EffectControlLinearizer {\n   Node* BuildFloat64RoundDown(Node* value);\n   Node* BuildFloat64RoundTruncate(Node* input);\n   Node* BuildUint32Mod(Node* lhs, Node* rhs);\n-  Node* ComputeIntegerHash(Node* value);\n+  Node* ComputeUnseededHash(Node* value);\n   Node* LowerStringComparison(Callable const& callable, Node* node);\n   Node* IsElementsKindGreaterThan(Node* kind, ElementsKind reference_kind);\n "
        },
        {
            "sha": "0fbde95a1cbd1fb6a02119f82330ad5ce1fa58f9",
            "filename": "deps/v8/src/external-reference.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fexternal-reference.cc",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fexternal-reference.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fexternal-reference.cc?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -764,6 +764,15 @@ ExternalReference ExternalReference::jsreceiver_create_identity_hash(\n   return ExternalReference(Redirect(FUNCTION_ADDR(f)));\n }\n \n+static uint32_t ComputeSeededIntegerHash(Isolate* isolate, uint32_t key) {\n+  DisallowHeapAllocation no_gc;\n+  return ComputeSeededHash(key, isolate->heap()->HashSeed());\n+}\n+\n+ExternalReference ExternalReference::compute_integer_hash() {\n+  return ExternalReference(Redirect(FUNCTION_ADDR(ComputeSeededIntegerHash)));\n+}\n+\n ExternalReference\n ExternalReference::copy_fast_number_jsarray_elements_to_typed_array() {\n   return ExternalReference("
        },
        {
            "sha": "fb3ec07c8bf713abb51d09898d39c3f3ef6176dc",
            "filename": "deps/v8/src/external-reference.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fexternal-reference.h",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fexternal-reference.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fexternal-reference.h?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -83,6 +83,7 @@ class StatsCounter;\n   V(address_of_uint32_bias, \"uint32_bias\")                                    \\\n   V(bytecode_size_table_address, \"Bytecodes::bytecode_size_table_address\")    \\\n   V(check_object_type, \"check_object_type\")                                   \\\n+  V(compute_integer_hash, \"ComputeSeededHash\")                                \\\n   V(compute_output_frames_function, \"Deoptimizer::ComputeOutputFrames()\")     \\\n   V(copy_fast_number_jsarray_elements_to_typed_array,                         \\\n     \"copy_fast_number_jsarray_elements_to_typed_array\")                       \\"
        },
        {
            "sha": "9dee01698e3ae1ee1a32b859cec336888db35186",
            "filename": "deps/v8/src/frames.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fframes.cc",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fframes.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fframes.cc?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -2133,7 +2133,7 @@ InnerPointerToCodeCache::InnerPointerToCodeCacheEntry*\n     InnerPointerToCodeCache::GetCacheEntry(Address inner_pointer) {\n   isolate_->counters()->pc_to_code()->Increment();\n   DCHECK(base::bits::IsPowerOfTwo(kInnerPointerToCodeCacheSize));\n-  uint32_t hash = ComputeIntegerHash(\n+  uint32_t hash = ComputeUnseededHash(\n       ObjectAddressForHashing(reinterpret_cast<void*>(inner_pointer)));\n   uint32_t index = hash & (kInnerPointerToCodeCacheSize - 1);\n   InnerPointerToCodeCacheEntry* entry = cache(index);"
        },
        {
            "sha": "ed3e15ed9e9856fb6b5217a46910b92c21dc536b",
            "filename": "deps/v8/src/objects-inl.h",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fobjects-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fobjects-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fobjects-inl.h?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -2980,14 +2980,14 @@ bool NumberDictionaryBaseShape::IsMatch(uint32_t key, Object* other) {\n }\n \n uint32_t NumberDictionaryBaseShape::Hash(Isolate* isolate, uint32_t key) {\n-  return ComputeIntegerHash(key, isolate->heap()->HashSeed());\n+  return ComputeSeededHash(key, isolate->heap()->HashSeed());\n }\n \n uint32_t NumberDictionaryBaseShape::HashForObject(Isolate* isolate,\n                                                   Object* other) {\n   DCHECK(other->IsNumber());\n-  return ComputeIntegerHash(static_cast<uint32_t>(other->Number()),\n-                            isolate->heap()->HashSeed());\n+  return ComputeSeededHash(static_cast<uint32_t>(other->Number()),\n+                           isolate->heap()->HashSeed());\n }\n \n Handle<Object> NumberDictionaryBaseShape::AsHandle(Isolate* isolate,\n@@ -3067,18 +3067,18 @@ uint32_t ObjectHashTableShape::HashForObject(Isolate* isolate, Object* other) {\n Object* Object::GetSimpleHash(Object* object) {\n   DisallowHeapAllocation no_gc;\n   if (object->IsSmi()) {\n-    uint32_t hash = ComputeIntegerHash(Smi::ToInt(object));\n+    uint32_t hash = ComputeUnseededHash(Smi::ToInt(object));\n     return Smi::FromInt(hash & Smi::kMaxValue);\n   }\n   if (object->IsHeapNumber()) {\n     double num = HeapNumber::cast(object)->value();\n     if (std::isnan(num)) return Smi::FromInt(Smi::kMaxValue);\n-    // Use ComputeIntegerHash for all values in Signed32 range, including -0,\n+    // Use ComputeUnseededHash for all values in Signed32 range, including -0,\n     // which is considered equal to 0 because collections use SameValueZero.\n     uint32_t hash;\n     // Check range before conversion to avoid undefined behavior.\n     if (num >= kMinInt && num <= kMaxInt && FastI2D(FastD2I(num)) == num) {\n-      hash = ComputeIntegerHash(FastD2I(num));\n+      hash = ComputeUnseededHash(FastD2I(num));\n     } else {\n       hash = ComputeLongHash(double_to_uint64(num));\n     }"
        },
        {
            "sha": "a30a4779deef8ca72bead4b31815860d51075422",
            "filename": "deps/v8/src/objects/bigint.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fobjects%2Fbigint.h",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fobjects%2Fbigint.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fobjects%2Fbigint.h?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -137,7 +137,7 @@ class V8_EXPORT_PRIVATE BigInt : public BigIntBase {\n   bool ToBoolean() { return !is_zero(); }\n   uint32_t Hash() {\n     // TODO(jkummerow): Improve this. At least use length and sign.\n-    return is_zero() ? 0 : ComputeIntegerHash(static_cast<uint32_t>(digit(0)));\n+    return is_zero() ? 0 : ComputeLongHash(static_cast<uint64_t>(digit(0)));\n   }\n \n   static bool EqualToString(Isolate* isolate, Handle<BigInt> x,"
        },
        {
            "sha": "0ee0f71c5c8ac284490a9abdbd9fba285fcc9233",
            "filename": "deps/v8/src/objects/ordered-hash-table.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fobjects%2Fordered-hash-table.h",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fobjects%2Fordered-hash-table.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fobjects%2Fordered-hash-table.h?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -144,7 +144,7 @@ class OrderedHashTable : public OrderedHashTableBase {\n     // This special cases for Smi, so that we avoid the HandleScope\n     // creation below.\n     if (key->IsSmi()) {\n-      uint32_t hash = ComputeIntegerHash(Smi::ToInt(key));\n+      uint32_t hash = ComputeUnseededHash(Smi::ToInt(key));\n       return HashToEntry(hash & Smi::kMaxValue);\n     }\n     HandleScope scope(isolate);"
        },
        {
            "sha": "e5b31397855171c08be8f6c0e6a02b01661ee9b3",
            "filename": "deps/v8/src/profiler/allocation-tracker.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fallocation-tracker.cc",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fallocation-tracker.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fallocation-tracker.cc?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -239,7 +239,7 @@ void AllocationTracker::AllocationEvent(Address addr, int size) {\n \n \n static uint32_t SnapshotObjectIdHash(SnapshotObjectId id) {\n-  return ComputeIntegerHash(static_cast<uint32_t>(id));\n+  return ComputeUnseededHash(static_cast<uint32_t>(id));\n }\n \n "
        },
        {
            "sha": "5d98a98b8ea0e9d9cf62e5cfe2aef51d8648fa04",
            "filename": "deps/v8/src/profiler/heap-snapshot-generator.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fheap-snapshot-generator.cc",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fheap-snapshot-generator.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fheap-snapshot-generator.cc?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -535,7 +535,7 @@ SnapshotObjectId HeapObjectsMap::GenerateId(v8::RetainedObjectInfo* info) {\n                                            heap_->HashSeed());\n   intptr_t element_count = info->GetElementCount();\n   if (element_count != -1) {\n-    id ^= ComputeIntegerHash(static_cast<uint32_t>(element_count));\n+    id ^= ComputeUnseededHash(static_cast<uint32_t>(element_count));\n   }\n   return id << 1;\n }"
        },
        {
            "sha": "f25bee9f46435bf181583eb2e2bb4d2073ea26bc",
            "filename": "deps/v8/src/profiler/heap-snapshot-generator.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fheap-snapshot-generator.h",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fheap-snapshot-generator.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fheap-snapshot-generator.h?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -309,7 +309,7 @@ class HeapEntriesMap {\n \n  private:\n   static uint32_t Hash(HeapThing thing) {\n-    return ComputeIntegerHash(\n+    return ComputeUnseededHash(\n         static_cast<uint32_t>(reinterpret_cast<uintptr_t>(thing)));\n   }\n \n@@ -520,7 +520,7 @@ class NativeObjectsExplorer {\n \n   struct RetainedInfoHasher {\n     std::size_t operator()(v8::RetainedObjectInfo* info) const {\n-      return ComputeIntegerHash(static_cast<uint32_t>(info->GetHash()));\n+      return ComputeUnseededHash(static_cast<uint32_t>(info->GetHash()));\n     }\n   };\n   struct RetainedInfoEquals {"
        },
        {
            "sha": "d60da5a44dfa2ff913916e801be1b1d3b33feda2",
            "filename": "deps/v8/src/profiler/profile-generator.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.cc",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.cc?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -84,16 +84,16 @@ CodeEntry* CodeEntry::UnresolvedEntryCreateTrait::Create() {\n }\n \n uint32_t CodeEntry::GetHash() const {\n-  uint32_t hash = ComputeIntegerHash(tag());\n+  uint32_t hash = ComputeUnseededHash(tag());\n   if (script_id_ != v8::UnboundScript::kNoScriptId) {\n-    hash ^= ComputeIntegerHash(static_cast<uint32_t>(script_id_));\n-    hash ^= ComputeIntegerHash(static_cast<uint32_t>(position_));\n+    hash ^= ComputeUnseededHash(static_cast<uint32_t>(script_id_));\n+    hash ^= ComputeUnseededHash(static_cast<uint32_t>(position_));\n   } else {\n-    hash ^= ComputeIntegerHash(\n+    hash ^= ComputeUnseededHash(\n         static_cast<uint32_t>(reinterpret_cast<uintptr_t>(name_)));\n-    hash ^= ComputeIntegerHash(\n+    hash ^= ComputeUnseededHash(\n         static_cast<uint32_t>(reinterpret_cast<uintptr_t>(resource_name_)));\n-    hash ^= ComputeIntegerHash(line_number_);\n+    hash ^= ComputeUnseededHash(line_number_);\n   }\n   return hash;\n }"
        },
        {
            "sha": "ac9506ab219c91d1196af15ae246b89711e574e8",
            "filename": "deps/v8/src/profiler/profile-generator.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.h",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.h?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -243,7 +243,7 @@ class ProfileNode {\n   };\n   struct Hasher {\n     std::size_t operator()(CodeEntryAndLineNumber pair) const {\n-      return pair.code_entry->GetHash() ^ ComputeIntegerHash(pair.line_number);\n+      return pair.code_entry->GetHash() ^ ComputeUnseededHash(pair.line_number);\n     }\n   };\n "
        },
        {
            "sha": "f4669524a72e8f11b49054a155c726447a65ef90",
            "filename": "deps/v8/src/utils.h",
            "status": "modified",
            "additions": 8,
            "deletions": 10,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Futils.h",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Fsrc%2Futils.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Futils.h?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -476,10 +476,9 @@ class BitSetComputer {\n static const uint64_t kZeroHashSeed = 0;\n \n // Thomas Wang, Integer Hash Functions.\n-// http://www.concentric.net/~Ttwang/tech/inthash.htm\n-inline uint32_t ComputeIntegerHash(uint32_t key, uint64_t seed) {\n+// http://www.concentric.net/~Ttwang/tech/inthash.htm`\n+inline uint32_t ComputeUnseededHash(uint32_t key) {\n   uint32_t hash = key;\n-  hash = hash ^ static_cast<uint32_t>(seed);\n   hash = ~hash + (hash << 15);  // hash = (hash << 15) - hash - 1;\n   hash = hash ^ (hash >> 12);\n   hash = hash + (hash << 2);\n@@ -489,10 +488,6 @@ inline uint32_t ComputeIntegerHash(uint32_t key, uint64_t seed) {\n   return hash & 0x3fffffff;\n }\n \n-inline uint32_t ComputeIntegerHash(uint32_t key) {\n-  return ComputeIntegerHash(key, kZeroHashSeed);\n-}\n-\n inline uint32_t ComputeLongHash(uint64_t key) {\n   uint64_t hash = key;\n   hash = ~hash + (hash << 18);  // hash = (hash << 18) - hash - 1;\n@@ -501,17 +496,20 @@ inline uint32_t ComputeLongHash(uint64_t key) {\n   hash = hash ^ (hash >> 11);\n   hash = hash + (hash << 6);\n   hash = hash ^ (hash >> 22);\n-  return static_cast<uint32_t>(hash);\n+  return static_cast<uint32_t>(hash & 0x3fffffff);\n }\n \n+inline uint32_t ComputeSeededHash(uint32_t key, uint64_t seed) {\n+  return ComputeLongHash(static_cast<uint64_t>(key) ^ seed);\n+}\n \n inline uint32_t ComputePointerHash(void* ptr) {\n-  return ComputeIntegerHash(\n+  return ComputeUnseededHash(\n       static_cast<uint32_t>(reinterpret_cast<intptr_t>(ptr)));\n }\n \n inline uint32_t ComputeAddressHash(Address address) {\n-  return ComputeIntegerHash(static_cast<uint32_t>(address & 0xFFFFFFFFul));\n+  return ComputeUnseededHash(static_cast<uint32_t>(address & 0xFFFFFFFFul));\n }\n \n // ----------------------------------------------------------------------------"
        },
        {
            "sha": "2036e13450548e8de6639127f5070e359eb7a119",
            "filename": "deps/v8/test/cctest/test-code-stub-assembler.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 10,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Ftest%2Fcctest%2Ftest-code-stub-assembler.cc",
            "raw_url": "https://github.com/nodejs/node/raw/314c1fa5839559f29507e93a3b14fa4b4d380460/deps%2Fv8%2Ftest%2Fcctest%2Ftest-code-stub-assembler.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fcctest%2Ftest-code-stub-assembler.cc?ref=314c1fa5839559f29507e93a3b14fa4b4d380460",
            "patch": "@@ -332,15 +332,7 @@ TEST(ComputeIntegerHash) {\n   CodeAssemblerTester asm_tester(isolate, kNumParams);\n   CodeStubAssembler m(asm_tester.state());\n \n-  TNode<Int32T> int32_seed;\n-  if (m.Is64()) {\n-    int32_seed = m.TruncateInt64ToInt32(m.HashSeed());\n-  } else {\n-    int32_seed = m.HashSeedLow();\n-  }\n-\n-  m.Return(m.SmiFromInt32(\n-      m.ComputeIntegerHash(m.SmiUntag(m.Parameter(0)), int32_seed)));\n+  m.Return(m.SmiFromInt32(m.ComputeSeededHash(m.SmiUntag(m.Parameter(0)))));\n \n   FunctionTester ft(asm_tester.GenerateCode(), kNumParams);\n \n@@ -352,7 +344,7 @@ TEST(ComputeIntegerHash) {\n     Handle<Smi> key(Smi::FromInt(k), isolate);\n     Handle<Object> result = ft.Call(key).ToHandleChecked();\n \n-    uint32_t hash = ComputeIntegerHash(k, isolate->heap()->HashSeed());\n+    uint32_t hash = ComputeSeededHash(k, isolate->heap()->HashSeed());\n     Smi* expected = Smi::FromInt(hash & Smi::kMaxValue);\n     CHECK_EQ(expected, Smi::cast(*result));\n   }"
        }
    ],
    "stats": {
        "total": 178,
        "additions": 70,
        "deletions": 108
    }
}