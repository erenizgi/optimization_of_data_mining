{
    "author": "joyeecheung",
    "message": "src: move node::errno_string into node_errors.h/cc\n\nMove `node::errno_string` into node_errors.h/cc and move it into\nthe `node:errors` namespace to reduce the size of the header.\nIt's not on any performance-critical code path so does not need\nto be inlined.\n\nPR-URL: https://github.com/nodejs/node/pull/25396\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>",
    "sha": "48f9b36459aa9d71b10f26471127cba2dc43042a",
    "files": [
        {
            "sha": "2cbbd14e713b9b25a1f2bc166e35267fcbb376e3",
            "filename": "src/env.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fenv.cc",
            "raw_url": "https://github.com/nodejs/node/raw/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fenv.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv.cc?ref=48f9b36459aa9d71b10f26471127cba2dc43042a",
            "patch": "@@ -816,7 +816,7 @@ void Environment::CollectExceptionInfo(Local<Value> object,\n     return;\n \n   Local<Object> obj = object.As<Object>();\n-  const char* err_string = node::errno_string(errorno);\n+  const char* err_string = errors::errno_string(errorno);\n \n   if (message == nullptr || message[0] == '\\0') {\n     message = strerror(errorno);"
        },
        {
            "sha": "d5c05fdf4209265306fb98b4200d93c40e418c9b",
            "filename": "src/exceptions.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fexceptions.cc",
            "raw_url": "https://github.com/nodejs/node/raw/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fexceptions.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fexceptions.cc?ref=48f9b36459aa9d71b10f26471127cba2dc43042a",
            "patch": "@@ -1,9 +1,11 @@\n-#include \"node.h\"\n-#include \"node_internals.h\"\n+// This file contains implementation of error APIs exposed in node.h\n+\n #include \"env-inl.h\"\n+#include \"node.h\"\n+#include \"node_errors.h\"\n #include \"util-inl.h\"\n-#include \"v8.h\"\n #include \"uv.h\"\n+#include \"v8.h\"\n \n #include <string.h>\n \n@@ -27,7 +29,7 @@ Local<Value> ErrnoException(Isolate* isolate,\n   Environment* env = Environment::GetCurrent(isolate);\n \n   Local<Value> e;\n-  Local<String> estring = OneByteString(isolate, errno_string(errorno));\n+  Local<String> estring = OneByteString(isolate, errors::errno_string(errorno));\n   if (msg == nullptr || msg[0] == '\\0') {\n     msg = strerror(errorno);\n   }"
        },
        {
            "sha": "2a86c7402b5a6490b4ca246aadabf311718faa9e",
            "filename": "src/node_errors.cc",
            "status": "modified",
            "additions": 330,
            "deletions": 0,
            "changes": 330,
            "blob_url": "https://github.com/nodejs/node/blob/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fnode_errors.cc",
            "raw_url": "https://github.com/nodejs/node/raw/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fnode_errors.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_errors.cc?ref=48f9b36459aa9d71b10f26471127cba2dc43042a",
            "patch": "@@ -1,4 +1,6 @@\n+#include <errno.h>\n #include <stdarg.h>\n+\n #include \"node_errors.h\"\n #include \"node_internals.h\"\n \n@@ -326,6 +328,334 @@ TryCatchScope::~TryCatchScope() {\n   }\n }\n \n+const char* errno_string(int errorno) {\n+#define ERRNO_CASE(e)                                                          \\\n+  case e:                                                                      \\\n+    return #e;\n+  switch (errorno) {\n+#ifdef EACCES\n+    ERRNO_CASE(EACCES);\n+#endif\n+\n+#ifdef EADDRINUSE\n+    ERRNO_CASE(EADDRINUSE);\n+#endif\n+\n+#ifdef EADDRNOTAVAIL\n+    ERRNO_CASE(EADDRNOTAVAIL);\n+#endif\n+\n+#ifdef EAFNOSUPPORT\n+    ERRNO_CASE(EAFNOSUPPORT);\n+#endif\n+\n+#ifdef EAGAIN\n+    ERRNO_CASE(EAGAIN);\n+#endif\n+\n+#ifdef EWOULDBLOCK\n+#if EAGAIN != EWOULDBLOCK\n+    ERRNO_CASE(EWOULDBLOCK);\n+#endif\n+#endif\n+\n+#ifdef EALREADY\n+    ERRNO_CASE(EALREADY);\n+#endif\n+\n+#ifdef EBADF\n+    ERRNO_CASE(EBADF);\n+#endif\n+\n+#ifdef EBADMSG\n+    ERRNO_CASE(EBADMSG);\n+#endif\n+\n+#ifdef EBUSY\n+    ERRNO_CASE(EBUSY);\n+#endif\n+\n+#ifdef ECANCELED\n+    ERRNO_CASE(ECANCELED);\n+#endif\n+\n+#ifdef ECHILD\n+    ERRNO_CASE(ECHILD);\n+#endif\n+\n+#ifdef ECONNABORTED\n+    ERRNO_CASE(ECONNABORTED);\n+#endif\n+\n+#ifdef ECONNREFUSED\n+    ERRNO_CASE(ECONNREFUSED);\n+#endif\n+\n+#ifdef ECONNRESET\n+    ERRNO_CASE(ECONNRESET);\n+#endif\n+\n+#ifdef EDEADLK\n+    ERRNO_CASE(EDEADLK);\n+#endif\n+\n+#ifdef EDESTADDRREQ\n+    ERRNO_CASE(EDESTADDRREQ);\n+#endif\n+\n+#ifdef EDOM\n+    ERRNO_CASE(EDOM);\n+#endif\n+\n+#ifdef EDQUOT\n+    ERRNO_CASE(EDQUOT);\n+#endif\n+\n+#ifdef EEXIST\n+    ERRNO_CASE(EEXIST);\n+#endif\n+\n+#ifdef EFAULT\n+    ERRNO_CASE(EFAULT);\n+#endif\n+\n+#ifdef EFBIG\n+    ERRNO_CASE(EFBIG);\n+#endif\n+\n+#ifdef EHOSTUNREACH\n+    ERRNO_CASE(EHOSTUNREACH);\n+#endif\n+\n+#ifdef EIDRM\n+    ERRNO_CASE(EIDRM);\n+#endif\n+\n+#ifdef EILSEQ\n+    ERRNO_CASE(EILSEQ);\n+#endif\n+\n+#ifdef EINPROGRESS\n+    ERRNO_CASE(EINPROGRESS);\n+#endif\n+\n+#ifdef EINTR\n+    ERRNO_CASE(EINTR);\n+#endif\n+\n+#ifdef EINVAL\n+    ERRNO_CASE(EINVAL);\n+#endif\n+\n+#ifdef EIO\n+    ERRNO_CASE(EIO);\n+#endif\n+\n+#ifdef EISCONN\n+    ERRNO_CASE(EISCONN);\n+#endif\n+\n+#ifdef EISDIR\n+    ERRNO_CASE(EISDIR);\n+#endif\n+\n+#ifdef ELOOP\n+    ERRNO_CASE(ELOOP);\n+#endif\n+\n+#ifdef EMFILE\n+    ERRNO_CASE(EMFILE);\n+#endif\n+\n+#ifdef EMLINK\n+    ERRNO_CASE(EMLINK);\n+#endif\n+\n+#ifdef EMSGSIZE\n+    ERRNO_CASE(EMSGSIZE);\n+#endif\n+\n+#ifdef EMULTIHOP\n+    ERRNO_CASE(EMULTIHOP);\n+#endif\n+\n+#ifdef ENAMETOOLONG\n+    ERRNO_CASE(ENAMETOOLONG);\n+#endif\n+\n+#ifdef ENETDOWN\n+    ERRNO_CASE(ENETDOWN);\n+#endif\n+\n+#ifdef ENETRESET\n+    ERRNO_CASE(ENETRESET);\n+#endif\n+\n+#ifdef ENETUNREACH\n+    ERRNO_CASE(ENETUNREACH);\n+#endif\n+\n+#ifdef ENFILE\n+    ERRNO_CASE(ENFILE);\n+#endif\n+\n+#ifdef ENOBUFS\n+    ERRNO_CASE(ENOBUFS);\n+#endif\n+\n+#ifdef ENODATA\n+    ERRNO_CASE(ENODATA);\n+#endif\n+\n+#ifdef ENODEV\n+    ERRNO_CASE(ENODEV);\n+#endif\n+\n+#ifdef ENOENT\n+    ERRNO_CASE(ENOENT);\n+#endif\n+\n+#ifdef ENOEXEC\n+    ERRNO_CASE(ENOEXEC);\n+#endif\n+\n+#ifdef ENOLINK\n+    ERRNO_CASE(ENOLINK);\n+#endif\n+\n+#ifdef ENOLCK\n+#if ENOLINK != ENOLCK\n+    ERRNO_CASE(ENOLCK);\n+#endif\n+#endif\n+\n+#ifdef ENOMEM\n+    ERRNO_CASE(ENOMEM);\n+#endif\n+\n+#ifdef ENOMSG\n+    ERRNO_CASE(ENOMSG);\n+#endif\n+\n+#ifdef ENOPROTOOPT\n+    ERRNO_CASE(ENOPROTOOPT);\n+#endif\n+\n+#ifdef ENOSPC\n+    ERRNO_CASE(ENOSPC);\n+#endif\n+\n+#ifdef ENOSR\n+    ERRNO_CASE(ENOSR);\n+#endif\n+\n+#ifdef ENOSTR\n+    ERRNO_CASE(ENOSTR);\n+#endif\n+\n+#ifdef ENOSYS\n+    ERRNO_CASE(ENOSYS);\n+#endif\n+\n+#ifdef ENOTCONN\n+    ERRNO_CASE(ENOTCONN);\n+#endif\n+\n+#ifdef ENOTDIR\n+    ERRNO_CASE(ENOTDIR);\n+#endif\n+\n+#ifdef ENOTEMPTY\n+#if ENOTEMPTY != EEXIST\n+    ERRNO_CASE(ENOTEMPTY);\n+#endif\n+#endif\n+\n+#ifdef ENOTSOCK\n+    ERRNO_CASE(ENOTSOCK);\n+#endif\n+\n+#ifdef ENOTSUP\n+    ERRNO_CASE(ENOTSUP);\n+#else\n+#ifdef EOPNOTSUPP\n+    ERRNO_CASE(EOPNOTSUPP);\n+#endif\n+#endif\n+\n+#ifdef ENOTTY\n+    ERRNO_CASE(ENOTTY);\n+#endif\n+\n+#ifdef ENXIO\n+    ERRNO_CASE(ENXIO);\n+#endif\n+\n+#ifdef EOVERFLOW\n+    ERRNO_CASE(EOVERFLOW);\n+#endif\n+\n+#ifdef EPERM\n+    ERRNO_CASE(EPERM);\n+#endif\n+\n+#ifdef EPIPE\n+    ERRNO_CASE(EPIPE);\n+#endif\n+\n+#ifdef EPROTO\n+    ERRNO_CASE(EPROTO);\n+#endif\n+\n+#ifdef EPROTONOSUPPORT\n+    ERRNO_CASE(EPROTONOSUPPORT);\n+#endif\n+\n+#ifdef EPROTOTYPE\n+    ERRNO_CASE(EPROTOTYPE);\n+#endif\n+\n+#ifdef ERANGE\n+    ERRNO_CASE(ERANGE);\n+#endif\n+\n+#ifdef EROFS\n+    ERRNO_CASE(EROFS);\n+#endif\n+\n+#ifdef ESPIPE\n+    ERRNO_CASE(ESPIPE);\n+#endif\n+\n+#ifdef ESRCH\n+    ERRNO_CASE(ESRCH);\n+#endif\n+\n+#ifdef ESTALE\n+    ERRNO_CASE(ESTALE);\n+#endif\n+\n+#ifdef ETIME\n+    ERRNO_CASE(ETIME);\n+#endif\n+\n+#ifdef ETIMEDOUT\n+    ERRNO_CASE(ETIMEDOUT);\n+#endif\n+\n+#ifdef ETXTBSY\n+    ERRNO_CASE(ETXTBSY);\n+#endif\n+\n+#ifdef EXDEV\n+    ERRNO_CASE(EXDEV);\n+#endif\n+\n+    default:\n+      return \"\";\n+  }\n+}\n+\n }  // namespace errors\n \n void DecorateErrorStack(Environment* env,"
        },
        {
            "sha": "cea7c108c168f3b481fc195278d043afebda2ae8",
            "filename": "src/node_errors.h",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fnode_errors.h",
            "raw_url": "https://github.com/nodejs/node/raw/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fnode_errors.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_errors.h?ref=48f9b36459aa9d71b10f26471127cba2dc43042a",
            "patch": "@@ -189,11 +189,12 @@ class TryCatchScope : public v8::TryCatch {\n   CatchMode mode_;\n };\n \n+const char* errno_string(int errorno);\n+\n }  // namespace errors\n \n void DecorateErrorStack(Environment* env,\n                         const errors::TryCatchScope& try_catch);\n-\n }  // namespace node\n \n #endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS"
        },
        {
            "sha": "5dd0593f41dc307615d32bd02781d42f29753e5f",
            "filename": "src/node_internals.h",
            "status": "modified",
            "additions": 0,
            "deletions": 326,
            "changes": 326,
            "blob_url": "https://github.com/nodejs/node/blob/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fnode_internals.h",
            "raw_url": "https://github.com/nodejs/node/raw/48f9b36459aa9d71b10f26471127cba2dc43042a/src%2Fnode_internals.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_internals.h?ref=48f9b36459aa9d71b10f26471127cba2dc43042a",
            "patch": "@@ -347,332 +347,6 @@ int ThreadPoolWork::CancelWork() {\n tracing::AgentWriterHandle* GetTracingAgentWriter();\n void DisposePlatform();\n \n-static inline const char* errno_string(int errorno) {\n-#define ERRNO_CASE(e)  case e: return #e;\n-  switch (errorno) {\n-#ifdef EACCES\n-  ERRNO_CASE(EACCES);\n-#endif\n-\n-#ifdef EADDRINUSE\n-  ERRNO_CASE(EADDRINUSE);\n-#endif\n-\n-#ifdef EADDRNOTAVAIL\n-  ERRNO_CASE(EADDRNOTAVAIL);\n-#endif\n-\n-#ifdef EAFNOSUPPORT\n-  ERRNO_CASE(EAFNOSUPPORT);\n-#endif\n-\n-#ifdef EAGAIN\n-  ERRNO_CASE(EAGAIN);\n-#endif\n-\n-#ifdef EWOULDBLOCK\n-# if EAGAIN != EWOULDBLOCK\n-  ERRNO_CASE(EWOULDBLOCK);\n-# endif\n-#endif\n-\n-#ifdef EALREADY\n-  ERRNO_CASE(EALREADY);\n-#endif\n-\n-#ifdef EBADF\n-  ERRNO_CASE(EBADF);\n-#endif\n-\n-#ifdef EBADMSG\n-  ERRNO_CASE(EBADMSG);\n-#endif\n-\n-#ifdef EBUSY\n-  ERRNO_CASE(EBUSY);\n-#endif\n-\n-#ifdef ECANCELED\n-  ERRNO_CASE(ECANCELED);\n-#endif\n-\n-#ifdef ECHILD\n-  ERRNO_CASE(ECHILD);\n-#endif\n-\n-#ifdef ECONNABORTED\n-  ERRNO_CASE(ECONNABORTED);\n-#endif\n-\n-#ifdef ECONNREFUSED\n-  ERRNO_CASE(ECONNREFUSED);\n-#endif\n-\n-#ifdef ECONNRESET\n-  ERRNO_CASE(ECONNRESET);\n-#endif\n-\n-#ifdef EDEADLK\n-  ERRNO_CASE(EDEADLK);\n-#endif\n-\n-#ifdef EDESTADDRREQ\n-  ERRNO_CASE(EDESTADDRREQ);\n-#endif\n-\n-#ifdef EDOM\n-  ERRNO_CASE(EDOM);\n-#endif\n-\n-#ifdef EDQUOT\n-  ERRNO_CASE(EDQUOT);\n-#endif\n-\n-#ifdef EEXIST\n-  ERRNO_CASE(EEXIST);\n-#endif\n-\n-#ifdef EFAULT\n-  ERRNO_CASE(EFAULT);\n-#endif\n-\n-#ifdef EFBIG\n-  ERRNO_CASE(EFBIG);\n-#endif\n-\n-#ifdef EHOSTUNREACH\n-  ERRNO_CASE(EHOSTUNREACH);\n-#endif\n-\n-#ifdef EIDRM\n-  ERRNO_CASE(EIDRM);\n-#endif\n-\n-#ifdef EILSEQ\n-  ERRNO_CASE(EILSEQ);\n-#endif\n-\n-#ifdef EINPROGRESS\n-  ERRNO_CASE(EINPROGRESS);\n-#endif\n-\n-#ifdef EINTR\n-  ERRNO_CASE(EINTR);\n-#endif\n-\n-#ifdef EINVAL\n-  ERRNO_CASE(EINVAL);\n-#endif\n-\n-#ifdef EIO\n-  ERRNO_CASE(EIO);\n-#endif\n-\n-#ifdef EISCONN\n-  ERRNO_CASE(EISCONN);\n-#endif\n-\n-#ifdef EISDIR\n-  ERRNO_CASE(EISDIR);\n-#endif\n-\n-#ifdef ELOOP\n-  ERRNO_CASE(ELOOP);\n-#endif\n-\n-#ifdef EMFILE\n-  ERRNO_CASE(EMFILE);\n-#endif\n-\n-#ifdef EMLINK\n-  ERRNO_CASE(EMLINK);\n-#endif\n-\n-#ifdef EMSGSIZE\n-  ERRNO_CASE(EMSGSIZE);\n-#endif\n-\n-#ifdef EMULTIHOP\n-  ERRNO_CASE(EMULTIHOP);\n-#endif\n-\n-#ifdef ENAMETOOLONG\n-  ERRNO_CASE(ENAMETOOLONG);\n-#endif\n-\n-#ifdef ENETDOWN\n-  ERRNO_CASE(ENETDOWN);\n-#endif\n-\n-#ifdef ENETRESET\n-  ERRNO_CASE(ENETRESET);\n-#endif\n-\n-#ifdef ENETUNREACH\n-  ERRNO_CASE(ENETUNREACH);\n-#endif\n-\n-#ifdef ENFILE\n-  ERRNO_CASE(ENFILE);\n-#endif\n-\n-#ifdef ENOBUFS\n-  ERRNO_CASE(ENOBUFS);\n-#endif\n-\n-#ifdef ENODATA\n-  ERRNO_CASE(ENODATA);\n-#endif\n-\n-#ifdef ENODEV\n-  ERRNO_CASE(ENODEV);\n-#endif\n-\n-#ifdef ENOENT\n-  ERRNO_CASE(ENOENT);\n-#endif\n-\n-#ifdef ENOEXEC\n-  ERRNO_CASE(ENOEXEC);\n-#endif\n-\n-#ifdef ENOLINK\n-  ERRNO_CASE(ENOLINK);\n-#endif\n-\n-#ifdef ENOLCK\n-# if ENOLINK != ENOLCK\n-  ERRNO_CASE(ENOLCK);\n-# endif\n-#endif\n-\n-#ifdef ENOMEM\n-  ERRNO_CASE(ENOMEM);\n-#endif\n-\n-#ifdef ENOMSG\n-  ERRNO_CASE(ENOMSG);\n-#endif\n-\n-#ifdef ENOPROTOOPT\n-  ERRNO_CASE(ENOPROTOOPT);\n-#endif\n-\n-#ifdef ENOSPC\n-  ERRNO_CASE(ENOSPC);\n-#endif\n-\n-#ifdef ENOSR\n-  ERRNO_CASE(ENOSR);\n-#endif\n-\n-#ifdef ENOSTR\n-  ERRNO_CASE(ENOSTR);\n-#endif\n-\n-#ifdef ENOSYS\n-  ERRNO_CASE(ENOSYS);\n-#endif\n-\n-#ifdef ENOTCONN\n-  ERRNO_CASE(ENOTCONN);\n-#endif\n-\n-#ifdef ENOTDIR\n-  ERRNO_CASE(ENOTDIR);\n-#endif\n-\n-#ifdef ENOTEMPTY\n-# if ENOTEMPTY != EEXIST\n-  ERRNO_CASE(ENOTEMPTY);\n-# endif\n-#endif\n-\n-#ifdef ENOTSOCK\n-  ERRNO_CASE(ENOTSOCK);\n-#endif\n-\n-#ifdef ENOTSUP\n-  ERRNO_CASE(ENOTSUP);\n-#else\n-# ifdef EOPNOTSUPP\n-  ERRNO_CASE(EOPNOTSUPP);\n-# endif\n-#endif\n-\n-#ifdef ENOTTY\n-  ERRNO_CASE(ENOTTY);\n-#endif\n-\n-#ifdef ENXIO\n-  ERRNO_CASE(ENXIO);\n-#endif\n-\n-\n-#ifdef EOVERFLOW\n-  ERRNO_CASE(EOVERFLOW);\n-#endif\n-\n-#ifdef EPERM\n-  ERRNO_CASE(EPERM);\n-#endif\n-\n-#ifdef EPIPE\n-  ERRNO_CASE(EPIPE);\n-#endif\n-\n-#ifdef EPROTO\n-  ERRNO_CASE(EPROTO);\n-#endif\n-\n-#ifdef EPROTONOSUPPORT\n-  ERRNO_CASE(EPROTONOSUPPORT);\n-#endif\n-\n-#ifdef EPROTOTYPE\n-  ERRNO_CASE(EPROTOTYPE);\n-#endif\n-\n-#ifdef ERANGE\n-  ERRNO_CASE(ERANGE);\n-#endif\n-\n-#ifdef EROFS\n-  ERRNO_CASE(EROFS);\n-#endif\n-\n-#ifdef ESPIPE\n-  ERRNO_CASE(ESPIPE);\n-#endif\n-\n-#ifdef ESRCH\n-  ERRNO_CASE(ESRCH);\n-#endif\n-\n-#ifdef ESTALE\n-  ERRNO_CASE(ESTALE);\n-#endif\n-\n-#ifdef ETIME\n-  ERRNO_CASE(ETIME);\n-#endif\n-\n-#ifdef ETIMEDOUT\n-  ERRNO_CASE(ETIMEDOUT);\n-#endif\n-\n-#ifdef ETXTBSY\n-  ERRNO_CASE(ETXTBSY);\n-#endif\n-\n-#ifdef EXDEV\n-  ERRNO_CASE(EXDEV);\n-#endif\n-\n-  default: return \"\";\n-  }\n-}\n-\n #define TRACING_CATEGORY_NODE \"node\"\n #define TRACING_CATEGORY_NODE1(one)                                           \\\n     TRACING_CATEGORY_NODE \",\"                                                 \\"
        }
    ],
    "stats": {
        "total": 671,
        "additions": 339,
        "deletions": 332
    }
}