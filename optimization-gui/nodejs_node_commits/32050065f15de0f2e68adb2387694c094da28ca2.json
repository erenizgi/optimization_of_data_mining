{
    "author": "bnoordhuis",
    "message": "deps: upgrade http-parser to v2.8.0\n\nPR-URL: https://github.com/nodejs-private/http-parser-private/pull/1\nReviewed-By: Сковорода Никита Андреевич <chalkerx@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Evan Lucas <evanlucas@me.com>\nReviewed-By: Fedor Indutny <fedor.indutny@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Rod Vagg <rod@vagg.org>",
    "sha": "32050065f15de0f2e68adb2387694c094da28ca2",
    "files": [
        {
            "sha": "c122e76fb9126b8c1b4c0132e4b531caedba021c",
            "filename": "deps/http_parser/.gitignore",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2F.gitignore",
            "raw_url": "https://github.com/nodejs/node/raw/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2F.gitignore",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2F.gitignore?ref=32050065f15de0f2e68adb2387694c094da28ca2",
            "patch": "@@ -12,6 +12,8 @@ parsertrace_g\n *.mk\n *.Makefile\n *.so.*\n+*.exe.*\n+*.exe\n *.a\n \n "
        },
        {
            "sha": "1ec0ab4e1746be2b5a7a817eb9c92cf8e3ff7e6d",
            "filename": "deps/http_parser/LICENSE-MIT",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2FLICENSE-MIT",
            "raw_url": "https://github.com/nodejs/node/raw/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2FLICENSE-MIT",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2FLICENSE-MIT?ref=32050065f15de0f2e68adb2387694c094da28ca2",
            "patch": "@@ -1,8 +1,4 @@\n-http_parser.c is based on src/http/ngx_http_parse.c from NGINX copyright\n-Igor Sysoev.\n-\n-Additional changes are licensed under the same terms as NGINX and\n-copyright Joyent, Inc. and other Node contributors. All rights reserved.\n+Copyright Joyent, Inc. and other Node contributors.\n \n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to"
        },
        {
            "sha": "6cf63bd35ea12b01a282ce1efabb63ea93a02990",
            "filename": "deps/http_parser/Makefile",
            "status": "modified",
            "additions": 25,
            "deletions": 14,
            "changes": 39,
            "blob_url": "https://github.com/nodejs/node/blob/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2FMakefile",
            "raw_url": "https://github.com/nodejs/node/raw/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2FMakefile",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2FMakefile?ref=32050065f15de0f2e68adb2387694c094da28ca2",
            "patch": "@@ -21,16 +21,22 @@\n PLATFORM ?= $(shell sh -c 'uname -s | tr \"[A-Z]\" \"[a-z]\"')\n HELPER ?=\n BINEXT ?=\n+SOLIBNAME = libhttp_parser\n+SOMAJOR = 2\n+SOMINOR = 8\n+SOREV   = 0\n ifeq (darwin,$(PLATFORM))\n-SONAME ?= libhttp_parser.2.7.0.dylib\n SOEXT ?= dylib\n+SONAME ?= $(SOLIBNAME).$(SOMAJOR).$(SOMINOR).$(SOEXT)\n+LIBNAME ?= $(SOLIBNAME).$(SOMAJOR).$(SOMINOR).$(SOREV).$(SOEXT)\n else ifeq (wine,$(PLATFORM))\n CC = winegcc\n BINEXT = .exe.so\n HELPER = wine\n else\n-SONAME ?= libhttp_parser.so.2.7.0\n SOEXT ?= so\n+SONAME ?= $(SOLIBNAME).$(SOEXT).$(SOMAJOR).$(SOMINOR)\n+LIBNAME ?= $(SOLIBNAME).$(SOEXT).$(SOMAJOR).$(SOMINOR).$(SOREV)\n endif\n \n CC?=gcc\n@@ -55,11 +61,13 @@ CFLAGS_LIB = $(CFLAGS_FAST) -fPIC\n LDFLAGS_LIB = $(LDFLAGS) -shared\n \n INSTALL ?= install\n-PREFIX ?= $(DESTDIR)/usr/local\n+PREFIX ?= /usr/local\n LIBDIR = $(PREFIX)/lib\n INCLUDEDIR = $(PREFIX)/include\n \n-ifneq (darwin,$(PLATFORM))\n+ifeq (darwin,$(PLATFORM))\n+LDFLAGS_LIB += -Wl,-install_name,$(LIBDIR)/$(SONAME)\n+else\n # TODO(bnoordhuis) The native SunOS linker expects -h rather than -soname...\n LDFLAGS_LIB += -Wl,-soname=$(SONAME)\n endif\n@@ -102,7 +110,7 @@ libhttp_parser.o: http_parser.c http_parser.h Makefile\n \t$(CC) $(CPPFLAGS_FAST) $(CFLAGS_LIB) -c http_parser.c -o libhttp_parser.o\n \n library: libhttp_parser.o\n-\t$(CC) $(LDFLAGS_LIB) -o $(SONAME) $<\n+\t$(CC) $(LDFLAGS_LIB) -o $(LIBNAME) $<\n \n package: http_parser.o\n \t$(AR) rcs libhttp_parser.a http_parser.o\n@@ -123,19 +131,22 @@ tags: http_parser.c http_parser.h test.c\n \tctags $^\n \n install: library\n-\t$(INSTALL) -D  http_parser.h $(INCLUDEDIR)/http_parser.h\n-\t$(INSTALL) -D $(SONAME) $(LIBDIR)/$(SONAME)\n-\tln -s $(LIBDIR)/$(SONAME) $(LIBDIR)/libhttp_parser.$(SOEXT)\n+\t$(INSTALL) -D  http_parser.h $(DESTDIR)$(INCLUDEDIR)/http_parser.h\n+\t$(INSTALL) -D $(LIBNAME) $(DESTDIR)$(LIBDIR)/$(LIBNAME)\n+\tln -s $(LIBNAME) $(DESTDIR)$(LIBDIR)/$(SONAME)\n+\tln -s $(LIBNAME) $(DESTDIR)$(LIBDIR)/$(SOLIBNAME).$(SOEXT)\n \n install-strip: library\n-\t$(INSTALL) -D  http_parser.h $(INCLUDEDIR)/http_parser.h\n-\t$(INSTALL) -D -s $(SONAME) $(LIBDIR)/$(SONAME)\n-\tln -s $(LIBDIR)/$(SONAME) $(LIBDIR)/libhttp_parser.$(SOEXT)\n+\t$(INSTALL) -D  http_parser.h $(DESTDIR)$(INCLUDEDIR)/http_parser.h\n+\t$(INSTALL) -D -s $(LIBNAME) $(DESTDIR)$(LIBDIR)/$(LIBNAME)\n+\tln -s $(LIBNAME) $(DESTDIR)$(LIBDIR)/$(SONAME)\n+\tln -s $(LIBNAME) $(DESTDIR)$(LIBDIR)/$(SOLIBNAME).$(SOEXT)\n \n uninstall:\n-\trm $(INCLUDEDIR)/http_parser.h\n-\trm $(LIBDIR)/$(SONAME)\n-\trm $(LIBDIR)/libhttp_parser.so\n+\trm $(DESTDIR)$(INCLUDEDIR)/http_parser.h\n+\trm $(DESTDIR)$(LIBDIR)/$(SOLIBNAME).$(SOEXT)\n+\trm $(DESTDIR)$(LIBDIR)/$(SONAME)\n+\trm $(DESTDIR)$(LIBDIR)/$(LIBNAME)\n \n clean:\n \trm -f *.o *.a tags test test_fast test_g \\"
        },
        {
            "sha": "9c4c9999c2663fbaa26fc596b9442623c739d406",
            "filename": "deps/http_parser/README.md",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2FREADME.md",
            "raw_url": "https://github.com/nodejs/node/raw/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2FREADME.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2FREADME.md?ref=32050065f15de0f2e68adb2387694c094da28ca2",
            "patch": "@@ -72,9 +72,9 @@ if (parser->upgrade) {\n }\n ```\n \n-HTTP needs to know where the end of the stream is. For example, sometimes\n+`http_parser` needs to know where the end of the stream is. For example, sometimes\n servers send responses without Content-Length and expect the client to\n-consume input (for the body) until EOF. To tell http_parser about EOF, give\n+consume input (for the body) until EOF. To tell `http_parser` about EOF, give\n `0` as the fourth parameter to `http_parser_execute()`. Callbacks and errors\n can still be encountered during an EOF, so one must still be prepared\n to receive them.\n@@ -93,7 +93,7 @@ the on_body callback.\n The Special Problem of Upgrade\n ------------------------------\n \n-HTTP supports upgrading the connection to a different protocol. An\n+`http_parser` supports upgrading the connection to a different protocol. An\n increasingly common example of this is the WebSocket protocol which sends\n a request like\n \n@@ -144,7 +144,7 @@ parse a request, and then give a response over that socket. By instantiation\n of a thread-local struct containing relevant data (e.g. accepted socket,\n allocated memory for callbacks to write into, etc), a parser's callbacks are\n able to communicate data between the scope of the thread and the scope of the\n-callback in a threadsafe manner. This allows http-parser to be used in\n+callback in a threadsafe manner. This allows `http_parser` to be used in\n multi-threaded contexts.\n \n Example:\n@@ -202,7 +202,7 @@ void http_parser_thread(socket_t sock) {\n \n In case you parse HTTP message in chunks (i.e. `read()` request line\n from socket, parse, read half headers, parse, etc) your data callbacks\n-may be called more than once. Http-parser guarantees that data pointer is only\n+may be called more than once. `http_parser` guarantees that data pointer is only\n valid for the lifetime of callback. You can also `read()` into a heap allocated\n buffer to avoid copying memory around if this fits your application.\n "
        },
        {
            "sha": "3daa7f46a19370fa54b883e1e04b6806003d3d14",
            "filename": "deps/http_parser/contrib/parsertrace.c",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2Fcontrib%2Fparsertrace.c",
            "raw_url": "https://github.com/nodejs/node/raw/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2Fcontrib%2Fparsertrace.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2Fcontrib%2Fparsertrace.c?ref=32050065f15de0f2e68adb2387694c094da28ca2",
            "patch": "@@ -1,7 +1,4 @@\n-/* Based on src/http/ngx_http_parse.c from NGINX copyright Igor Sysoev\n- *\n- * Additional changes are licensed under the same terms as NGINX and\n- * copyright Joyent, Inc. and other Node contributors. All rights reserved.\n+/* Copyright Joyent, Inc. and other Node contributors.\n  *\n  * Permission is hereby granted, free of charge, to any person obtaining a copy\n  * of this software and associated documentation files (the \"Software\"), to"
        },
        {
            "sha": "7a9c688b1ca7508829ffac7cef1ad6b7ea00bf3c",
            "filename": "deps/http_parser/http_parser.c",
            "status": "modified",
            "additions": 81,
            "deletions": 127,
            "changes": 208,
            "blob_url": "https://github.com/nodejs/node/blob/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2Fhttp_parser.c",
            "raw_url": "https://github.com/nodejs/node/raw/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2Fhttp_parser.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2Fhttp_parser.c?ref=32050065f15de0f2e68adb2387694c094da28ca2",
            "patch": "@@ -1,7 +1,4 @@\n-/* Based on src/http/ngx_http_parse.c from NGINX copyright Igor Sysoev\n- *\n- * Additional changes are licensed under the same terms as NGINX and\n- * copyright Joyent, Inc. and other Node contributors. All rights reserved.\n+/* Copyright Joyent, Inc. and other Node contributors.\n  *\n  * Permission is hereby granted, free of charge, to any person obtaining a copy\n  * of this software and associated documentation files (the \"Software\"), to\n@@ -25,7 +22,6 @@\n #include <assert.h>\n #include <stddef.h>\n #include <ctype.h>\n-#include <stdlib.h>\n #include <string.h>\n #include <limits.h>\n \n@@ -286,10 +282,10 @@ enum state\n   , s_res_HT\n   , s_res_HTT\n   , s_res_HTTP\n-  , s_res_first_http_major\n   , s_res_http_major\n-  , s_res_first_http_minor\n+  , s_res_http_dot\n   , s_res_http_minor\n+  , s_res_http_end\n   , s_res_first_status_code\n   , s_res_status_code\n   , s_res_status_start\n@@ -316,10 +312,10 @@ enum state\n   , s_req_http_HT\n   , s_req_http_HTT\n   , s_req_http_HTTP\n-  , s_req_first_http_major\n   , s_req_http_major\n-  , s_req_first_http_minor\n+  , s_req_http_dot\n   , s_req_http_minor\n+  , s_req_http_end\n   , s_req_line_almost_done\n \n   , s_header_field_start\n@@ -795,75 +791,48 @@ size_t http_parser_execute (http_parser *parser,\n \n       case s_res_HTTP:\n         STRICT_CHECK(ch != '/');\n-        UPDATE_STATE(s_res_first_http_major);\n+        UPDATE_STATE(s_res_http_major);\n         break;\n \n-      case s_res_first_http_major:\n-        if (UNLIKELY(ch < '0' || ch > '9')) {\n+      case s_res_http_major:\n+        if (UNLIKELY(!IS_NUM(ch))) {\n           SET_ERRNO(HPE_INVALID_VERSION);\n           goto error;\n         }\n \n         parser->http_major = ch - '0';\n-        UPDATE_STATE(s_res_http_major);\n+        UPDATE_STATE(s_res_http_dot);\n         break;\n \n-      /* major HTTP version or dot */\n-      case s_res_http_major:\n+      case s_res_http_dot:\n       {\n-        if (ch == '.') {\n-          UPDATE_STATE(s_res_first_http_minor);\n-          break;\n-        }\n-\n-        if (!IS_NUM(ch)) {\n-          SET_ERRNO(HPE_INVALID_VERSION);\n-          goto error;\n-        }\n-\n-        parser->http_major *= 10;\n-        parser->http_major += ch - '0';\n-\n-        if (UNLIKELY(parser->http_major > 999)) {\n+        if (UNLIKELY(ch != '.')) {\n           SET_ERRNO(HPE_INVALID_VERSION);\n           goto error;\n         }\n \n+        UPDATE_STATE(s_res_http_minor);\n         break;\n       }\n \n-      /* first digit of minor HTTP version */\n-      case s_res_first_http_minor:\n+      case s_res_http_minor:\n         if (UNLIKELY(!IS_NUM(ch))) {\n           SET_ERRNO(HPE_INVALID_VERSION);\n           goto error;\n         }\n \n         parser->http_minor = ch - '0';\n-        UPDATE_STATE(s_res_http_minor);\n+        UPDATE_STATE(s_res_http_end);\n         break;\n \n-      /* minor HTTP version or end of request line */\n-      case s_res_http_minor:\n+      case s_res_http_end:\n       {\n-        if (ch == ' ') {\n-          UPDATE_STATE(s_res_first_status_code);\n-          break;\n-        }\n-\n-        if (UNLIKELY(!IS_NUM(ch))) {\n-          SET_ERRNO(HPE_INVALID_VERSION);\n-          goto error;\n-        }\n-\n-        parser->http_minor *= 10;\n-        parser->http_minor += ch - '0';\n-\n-        if (UNLIKELY(parser->http_minor > 999)) {\n+        if (UNLIKELY(ch != ' ')) {\n           SET_ERRNO(HPE_INVALID_VERSION);\n           goto error;\n         }\n \n+        UPDATE_STATE(s_res_first_status_code);\n         break;\n       }\n \n@@ -890,10 +859,9 @@ size_t http_parser_execute (http_parser *parser,\n               UPDATE_STATE(s_res_status_start);\n               break;\n             case CR:\n-              UPDATE_STATE(s_res_line_almost_done);\n-              break;\n             case LF:\n-              UPDATE_STATE(s_header_field_start);\n+              UPDATE_STATE(s_res_status_start);\n+              REEXECUTE();\n               break;\n             default:\n               SET_ERRNO(HPE_INVALID_STATUS);\n@@ -915,19 +883,13 @@ size_t http_parser_execute (http_parser *parser,\n \n       case s_res_status_start:\n       {\n-        if (ch == CR) {\n-          UPDATE_STATE(s_res_line_almost_done);\n-          break;\n-        }\n-\n-        if (ch == LF) {\n-          UPDATE_STATE(s_header_field_start);\n-          break;\n-        }\n-\n         MARK(status);\n         UPDATE_STATE(s_res_status);\n         parser->index = 0;\n+\n+        if (ch == CR || ch == LF)\n+          REEXECUTE();\n+\n         break;\n       }\n \n@@ -980,7 +942,7 @@ size_t http_parser_execute (http_parser *parser,\n             /* or PROPFIND|PROPPATCH|PUT|PATCH|PURGE */\n             break;\n           case 'R': parser->method = HTTP_REPORT; /* or REBIND */ break;\n-          case 'S': parser->method = HTTP_SUBSCRIBE; /* or SEARCH */ break;\n+          case 'S': parser->method = HTTP_SUBSCRIBE; /* or SEARCH, SOURCE */ break;\n           case 'T': parser->method = HTTP_TRACE; break;\n           case 'U': parser->method = HTTP_UNLOCK; /* or UNSUBSCRIBE, UNBIND, UNLINK */ break;\n           default:\n@@ -1007,7 +969,7 @@ size_t http_parser_execute (http_parser *parser,\n           UPDATE_STATE(s_req_spaces_before_url);\n         } else if (ch == matcher[parser->index]) {\n           ; /* nada */\n-        } else if (IS_ALPHA(ch)) {\n+        } else if ((ch >= 'A' && ch <= 'Z') || ch == '-') {\n \n           switch (parser->method << 16 | parser->index << 8 | ch) {\n #define XX(meth, pos, ch, new_meth) \\\n@@ -1016,31 +978,28 @@ size_t http_parser_execute (http_parser *parser,\n \n             XX(POST,      1, 'U', PUT)\n             XX(POST,      1, 'A', PATCH)\n+            XX(POST,      1, 'R', PROPFIND)\n+            XX(PUT,       2, 'R', PURGE)\n             XX(CONNECT,   1, 'H', CHECKOUT)\n             XX(CONNECT,   2, 'P', COPY)\n             XX(MKCOL,     1, 'O', MOVE)\n             XX(MKCOL,     1, 'E', MERGE)\n+            XX(MKCOL,     1, '-', MSEARCH)\n             XX(MKCOL,     2, 'A', MKACTIVITY)\n             XX(MKCOL,     3, 'A', MKCALENDAR)\n             XX(SUBSCRIBE, 1, 'E', SEARCH)\n+            XX(SUBSCRIBE, 1, 'O', SOURCE)\n             XX(REPORT,    2, 'B', REBIND)\n-            XX(POST,      1, 'R', PROPFIND)\n             XX(PROPFIND,  4, 'P', PROPPATCH)\n-            XX(PUT,       2, 'R', PURGE)\n             XX(LOCK,      1, 'I', LINK)\n             XX(UNLOCK,    2, 'S', UNSUBSCRIBE)\n             XX(UNLOCK,    2, 'B', UNBIND)\n             XX(UNLOCK,    3, 'I', UNLINK)\n #undef XX\n-\n             default:\n               SET_ERRNO(HPE_INVALID_METHOD);\n               goto error;\n           }\n-        } else if (ch == '-' &&\n-                   parser->index == 1 &&\n-                   parser->method == HTTP_MKCOL) {\n-          parser->method = HTTP_MSEARCH;\n         } else {\n           SET_ERRNO(HPE_INVALID_METHOD);\n           goto error;\n@@ -1153,57 +1112,41 @@ size_t http_parser_execute (http_parser *parser,\n \n       case s_req_http_HTTP:\n         STRICT_CHECK(ch != '/');\n-        UPDATE_STATE(s_req_first_http_major);\n-        break;\n-\n-      /* first digit of major HTTP version */\n-      case s_req_first_http_major:\n-        if (UNLIKELY(ch < '1' || ch > '9')) {\n-          SET_ERRNO(HPE_INVALID_VERSION);\n-          goto error;\n-        }\n-\n-        parser->http_major = ch - '0';\n         UPDATE_STATE(s_req_http_major);\n         break;\n \n-      /* major HTTP version or dot */\n       case s_req_http_major:\n-      {\n-        if (ch == '.') {\n-          UPDATE_STATE(s_req_first_http_minor);\n-          break;\n-        }\n-\n         if (UNLIKELY(!IS_NUM(ch))) {\n           SET_ERRNO(HPE_INVALID_VERSION);\n           goto error;\n         }\n \n-        parser->http_major *= 10;\n-        parser->http_major += ch - '0';\n+        parser->http_major = ch - '0';\n+        UPDATE_STATE(s_req_http_dot);\n+        break;\n \n-        if (UNLIKELY(parser->http_major > 999)) {\n+      case s_req_http_dot:\n+      {\n+        if (UNLIKELY(ch != '.')) {\n           SET_ERRNO(HPE_INVALID_VERSION);\n           goto error;\n         }\n \n+        UPDATE_STATE(s_req_http_minor);\n         break;\n       }\n \n-      /* first digit of minor HTTP version */\n-      case s_req_first_http_minor:\n+      case s_req_http_minor:\n         if (UNLIKELY(!IS_NUM(ch))) {\n           SET_ERRNO(HPE_INVALID_VERSION);\n           goto error;\n         }\n \n         parser->http_minor = ch - '0';\n-        UPDATE_STATE(s_req_http_minor);\n+        UPDATE_STATE(s_req_http_end);\n         break;\n \n-      /* minor HTTP version or end of request line */\n-      case s_req_http_minor:\n+      case s_req_http_end:\n       {\n         if (ch == CR) {\n           UPDATE_STATE(s_req_line_almost_done);\n@@ -1215,21 +1158,8 @@ size_t http_parser_execute (http_parser *parser,\n           break;\n         }\n \n-        /* XXX allow spaces after digit? */\n-\n-        if (UNLIKELY(!IS_NUM(ch))) {\n-          SET_ERRNO(HPE_INVALID_VERSION);\n-          goto error;\n-        }\n-\n-        parser->http_minor *= 10;\n-        parser->http_minor += ch - '0';\n-\n-        if (UNLIKELY(parser->http_minor > 999)) {\n-          SET_ERRNO(HPE_INVALID_VERSION);\n-          goto error;\n-        }\n-\n+        SET_ERRNO(HPE_INVALID_VERSION);\n+        goto error;\n         break;\n       }\n \n@@ -1366,12 +1296,7 @@ size_t http_parser_execute (http_parser *parser,\n                   || c != CONTENT_LENGTH[parser->index]) {\n                 parser->header_state = h_general;\n               } else if (parser->index == sizeof(CONTENT_LENGTH)-2) {\n-                if (parser->flags & F_CONTENTLENGTH) {\n-                  SET_ERRNO(HPE_UNEXPECTED_CONTENT_LENGTH);\n-                  goto error;\n-                }\n                 parser->header_state = h_content_length;\n-                parser->flags |= F_CONTENTLENGTH;\n               }\n               break;\n \n@@ -1474,6 +1399,12 @@ size_t http_parser_execute (http_parser *parser,\n               goto error;\n             }\n \n+            if (parser->flags & F_CONTENTLENGTH) {\n+              SET_ERRNO(HPE_UNEXPECTED_CONTENT_LENGTH);\n+              goto error;\n+            }\n+\n+            parser->flags |= F_CONTENTLENGTH;\n             parser->content_length = ch - '0';\n             break;\n \n@@ -1793,10 +1724,17 @@ size_t http_parser_execute (http_parser *parser,\n         UPDATE_STATE(s_headers_done);\n \n         /* Set this here so that on_headers_complete() callbacks can see it */\n-        parser->upgrade =\n-          ((parser->flags & (F_UPGRADE | F_CONNECTION_UPGRADE)) ==\n-           (F_UPGRADE | F_CONNECTION_UPGRADE) ||\n-           parser->method == HTTP_CONNECT);\n+        if ((parser->flags & F_UPGRADE) &&\n+            (parser->flags & F_CONNECTION_UPGRADE)) {\n+          /* For responses, \"Upgrade: foo\" and \"Connection: upgrade\" are\n+           * mandatory only when it is a 101 Switching Protocols response,\n+           * otherwise it is purely informational, to announce support.\n+           */\n+          parser->upgrade =\n+              (parser->type == HTTP_REQUEST || parser->status_code == 101);\n+        } else {\n+          parser->upgrade = (parser->method == HTTP_CONNECT);\n+        }\n \n         /* Here we call the headers_complete callback. This is somewhat\n          * different than other callbacks because if the user returns 1, we\n@@ -1815,6 +1753,7 @@ size_t http_parser_execute (http_parser *parser,\n             case 2:\n               parser->upgrade = 1;\n \n+            /* FALLTHROUGH */\n             case 1:\n               parser->flags |= F_SKIPBODY;\n               break;\n@@ -2373,7 +2312,7 @@ http_parser_parse_url(const char *buf, size_t buflen, int is_connect,\n       case s_req_server_with_at:\n         found_at = 1;\n \n-      /* FALLTROUGH */\n+      /* FALLTHROUGH */\n       case s_req_server:\n         uf = UF_HOST;\n         break;\n@@ -2427,12 +2366,27 @@ http_parser_parse_url(const char *buf, size_t buflen, int is_connect,\n   }\n \n   if (u->field_set & (1 << UF_PORT)) {\n-    /* Don't bother with endp; we've already validated the string */\n-    unsigned long v = strtoul(buf + u->field_data[UF_PORT].off, NULL, 10);\n-\n-    /* Ports have a max value of 2^16 */\n-    if (v > 0xffff) {\n-      return 1;\n+    uint16_t off;\n+    uint16_t len;\n+    const char* p;\n+    const char* end;\n+    unsigned long v;\n+\n+    off = u->field_data[UF_PORT].off;\n+    len = u->field_data[UF_PORT].len;\n+    end = buf + off + len;\n+\n+    /* NOTE: The characters are already validated and are in the [0-9] range */\n+    assert(off + len <= buflen && \"Port number overflow\");\n+    v = 0;\n+    for (p = buf + off; p < end; p++) {\n+      v *= 10;\n+      v += *p - '0';\n+\n+      /* Ports have a max value of 2^16 */\n+      if (v > 0xffff) {\n+        return 1;\n+      }\n     }\n \n     u->port = (uint16_t) v;"
        },
        {
            "sha": "1fbf30e2b4740b9f4b1aef2bef53da142bf0b3ec",
            "filename": "deps/http_parser/http_parser.h",
            "status": "modified",
            "additions": 74,
            "deletions": 3,
            "changes": 77,
            "blob_url": "https://github.com/nodejs/node/blob/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2Fhttp_parser.h",
            "raw_url": "https://github.com/nodejs/node/raw/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2Fhttp_parser.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2Fhttp_parser.h?ref=32050065f15de0f2e68adb2387694c094da28ca2",
            "patch": "@@ -26,14 +26,13 @@ extern \"C\" {\n \n /* Also update SONAME in the Makefile whenever you change these. */\n #define HTTP_PARSER_VERSION_MAJOR 2\n-#define HTTP_PARSER_VERSION_MINOR 7\n+#define HTTP_PARSER_VERSION_MINOR 8\n #define HTTP_PARSER_VERSION_PATCH 0\n \n-#include <sys/types.h>\n+#include <stddef.h>\n #if defined(_WIN32) && !defined(__MINGW32__) && \\\n   (!defined(_MSC_VER) || _MSC_VER<1600) && !defined(__WINE__)\n #include <BaseTsd.h>\n-#include <stddef.h>\n typedef __int8 int8_t;\n typedef unsigned __int8 uint8_t;\n typedef __int16 int16_t;\n@@ -90,6 +89,76 @@ typedef int (*http_data_cb) (http_parser*, const char *at, size_t length);\n typedef int (*http_cb) (http_parser*);\n \n \n+/* Status Codes */\n+#define HTTP_STATUS_MAP(XX)                                                 \\\n+  XX(100, CONTINUE,                        Continue)                        \\\n+  XX(101, SWITCHING_PROTOCOLS,             Switching Protocols)             \\\n+  XX(102, PROCESSING,                      Processing)                      \\\n+  XX(200, OK,                              OK)                              \\\n+  XX(201, CREATED,                         Created)                         \\\n+  XX(202, ACCEPTED,                        Accepted)                        \\\n+  XX(203, NON_AUTHORITATIVE_INFORMATION,   Non-Authoritative Information)   \\\n+  XX(204, NO_CONTENT,                      No Content)                      \\\n+  XX(205, RESET_CONTENT,                   Reset Content)                   \\\n+  XX(206, PARTIAL_CONTENT,                 Partial Content)                 \\\n+  XX(207, MULTI_STATUS,                    Multi-Status)                    \\\n+  XX(208, ALREADY_REPORTED,                Already Reported)                \\\n+  XX(226, IM_USED,                         IM Used)                         \\\n+  XX(300, MULTIPLE_CHOICES,                Multiple Choices)                \\\n+  XX(301, MOVED_PERMANENTLY,               Moved Permanently)               \\\n+  XX(302, FOUND,                           Found)                           \\\n+  XX(303, SEE_OTHER,                       See Other)                       \\\n+  XX(304, NOT_MODIFIED,                    Not Modified)                    \\\n+  XX(305, USE_PROXY,                       Use Proxy)                       \\\n+  XX(307, TEMPORARY_REDIRECT,              Temporary Redirect)              \\\n+  XX(308, PERMANENT_REDIRECT,              Permanent Redirect)              \\\n+  XX(400, BAD_REQUEST,                     Bad Request)                     \\\n+  XX(401, UNAUTHORIZED,                    Unauthorized)                    \\\n+  XX(402, PAYMENT_REQUIRED,                Payment Required)                \\\n+  XX(403, FORBIDDEN,                       Forbidden)                       \\\n+  XX(404, NOT_FOUND,                       Not Found)                       \\\n+  XX(405, METHOD_NOT_ALLOWED,              Method Not Allowed)              \\\n+  XX(406, NOT_ACCEPTABLE,                  Not Acceptable)                  \\\n+  XX(407, PROXY_AUTHENTICATION_REQUIRED,   Proxy Authentication Required)   \\\n+  XX(408, REQUEST_TIMEOUT,                 Request Timeout)                 \\\n+  XX(409, CONFLICT,                        Conflict)                        \\\n+  XX(410, GONE,                            Gone)                            \\\n+  XX(411, LENGTH_REQUIRED,                 Length Required)                 \\\n+  XX(412, PRECONDITION_FAILED,             Precondition Failed)             \\\n+  XX(413, PAYLOAD_TOO_LARGE,               Payload Too Large)               \\\n+  XX(414, URI_TOO_LONG,                    URI Too Long)                    \\\n+  XX(415, UNSUPPORTED_MEDIA_TYPE,          Unsupported Media Type)          \\\n+  XX(416, RANGE_NOT_SATISFIABLE,           Range Not Satisfiable)           \\\n+  XX(417, EXPECTATION_FAILED,              Expectation Failed)              \\\n+  XX(421, MISDIRECTED_REQUEST,             Misdirected Request)             \\\n+  XX(422, UNPROCESSABLE_ENTITY,            Unprocessable Entity)            \\\n+  XX(423, LOCKED,                          Locked)                          \\\n+  XX(424, FAILED_DEPENDENCY,               Failed Dependency)               \\\n+  XX(426, UPGRADE_REQUIRED,                Upgrade Required)                \\\n+  XX(428, PRECONDITION_REQUIRED,           Precondition Required)           \\\n+  XX(429, TOO_MANY_REQUESTS,               Too Many Requests)               \\\n+  XX(431, REQUEST_HEADER_FIELDS_TOO_LARGE, Request Header Fields Too Large) \\\n+  XX(451, UNAVAILABLE_FOR_LEGAL_REASONS,   Unavailable For Legal Reasons)   \\\n+  XX(500, INTERNAL_SERVER_ERROR,           Internal Server Error)           \\\n+  XX(501, NOT_IMPLEMENTED,                 Not Implemented)                 \\\n+  XX(502, BAD_GATEWAY,                     Bad Gateway)                     \\\n+  XX(503, SERVICE_UNAVAILABLE,             Service Unavailable)             \\\n+  XX(504, GATEWAY_TIMEOUT,                 Gateway Timeout)                 \\\n+  XX(505, HTTP_VERSION_NOT_SUPPORTED,      HTTP Version Not Supported)      \\\n+  XX(506, VARIANT_ALSO_NEGOTIATES,         Variant Also Negotiates)         \\\n+  XX(507, INSUFFICIENT_STORAGE,            Insufficient Storage)            \\\n+  XX(508, LOOP_DETECTED,                   Loop Detected)                   \\\n+  XX(510, NOT_EXTENDED,                    Not Extended)                    \\\n+  XX(511, NETWORK_AUTHENTICATION_REQUIRED, Network Authentication Required) \\\n+\n+enum http_status\n+  {\n+#define XX(num, name, string) HTTP_STATUS_##name = num,\n+  HTTP_STATUS_MAP(XX)\n+#undef XX\n+  };\n+\n+\n /* Request Methods */\n #define HTTP_METHOD_MAP(XX)         \\\n   XX(0,  DELETE,      DELETE)       \\\n@@ -132,6 +201,8 @@ typedef int (*http_cb) (http_parser*);\n   /* RFC-2068, section 19.6.1.2 */  \\\n   XX(31, LINK,        LINK)         \\\n   XX(32, UNLINK,      UNLINK)       \\\n+  /* icecast */                     \\\n+  XX(33, SOURCE,      SOURCE)       \\\n \n enum http_method\n   {"
        },
        {
            "sha": "bc4e664f525360dc75e96258454f2c36e5af27b5",
            "filename": "deps/http_parser/test.c",
            "status": "modified",
            "additions": 261,
            "deletions": 6,
            "changes": 267,
            "blob_url": "https://github.com/nodejs/node/blob/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2Ftest.c",
            "raw_url": "https://github.com/nodejs/node/raw/32050065f15de0f2e68adb2387694c094da28ca2/deps%2Fhttp_parser%2Ftest.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2Ftest.c?ref=32050065f15de0f2e68adb2387694c094da28ca2",
            "patch": "@@ -78,6 +78,7 @@ struct message {\n   int message_begin_cb_called;\n   int headers_complete_cb_called;\n   int message_complete_cb_called;\n+  int status_cb_called;\n   int message_complete_on_eof;\n   int body_is_final;\n };\n@@ -1131,7 +1132,7 @@ const struct message requests[] =\n   }\n \n #define UNLINK_REQUEST 41\n-, {.name = \"link request\"\n+, {.name = \"unlink request\"\n   ,.type= HTTP_REQUEST\n   ,.raw= \"UNLINK /images/my_dog.jpg HTTP/1.1\\r\\n\"\n          \"Host: example.com\\r\\n\"\n@@ -1153,6 +1154,26 @@ const struct message requests[] =\n   ,.body= \"\"\n   }\n \n+#define SOURCE_REQUEST 42\n+, {.name = \"source request\"\n+  ,.type= HTTP_REQUEST\n+  ,.raw= \"SOURCE /music/sweet/music HTTP/1.1\\r\\n\"\n+         \"Host: example.com\\r\\n\"\n+         \"\\r\\n\"\n+  ,.should_keep_alive= TRUE\n+  ,.message_complete_on_eof= FALSE\n+  ,.http_major= 1\n+  ,.http_minor= 1\n+  ,.method= HTTP_SOURCE\n+  ,.request_path= \"/music/sweet/music\"\n+  ,.request_url= \"/music/sweet/music\"\n+  ,.query_string= \"\"\n+  ,.fragment= \"\"\n+  ,.num_headers= 1\n+  ,.headers= { { \"Host\", \"example.com\" } }\n+  ,.body= \"\"\n+  }\n+\n , {.name= NULL } /* sentinel */\n };\n \n@@ -1745,6 +1766,193 @@ const struct message responses[] =\n   ,.body= \"\"\n   }\n \n+#define CONTENT_LENGTH_X 21\n+, {.name= \"Content-Length-X\"\n+  ,.type= HTTP_RESPONSE\n+  ,.raw= \"HTTP/1.1 200 OK\\r\\n\"\n+         \"Content-Length-X: 0\\r\\n\"\n+         \"Transfer-Encoding: chunked\\r\\n\"\n+         \"\\r\\n\"\n+         \"2\\r\\n\"\n+         \"OK\\r\\n\"\n+         \"0\\r\\n\"\n+         \"\\r\\n\"\n+  ,.should_keep_alive= TRUE\n+  ,.message_complete_on_eof= FALSE\n+  ,.http_major= 1\n+  ,.http_minor= 1\n+  ,.status_code= 200\n+  ,.response_status= \"OK\"\n+  ,.num_headers= 2\n+  ,.headers= { { \"Content-Length-X\", \"0\" }\n+             , { \"Transfer-Encoding\", \"chunked\" }\n+             }\n+  ,.body= \"OK\"\n+  ,.num_chunks_complete= 2\n+  ,.chunk_lengths= { 2 }\n+  }\n+\n+#define HTTP_101_RESPONSE_WITH_UPGRADE_HEADER 22\n+, {.name= \"HTTP 101 response with Upgrade header\"\n+  ,.type= HTTP_RESPONSE\n+  ,.raw= \"HTTP/1.1 101 Switching Protocols\\r\\n\"\n+         \"Connection: upgrade\\r\\n\"\n+         \"Upgrade: h2c\\r\\n\"\n+         \"\\r\\n\"\n+         \"proto\"\n+  ,.should_keep_alive= TRUE\n+  ,.message_complete_on_eof= FALSE\n+  ,.http_major= 1\n+  ,.http_minor= 1\n+  ,.status_code= 101\n+  ,.response_status= \"Switching Protocols\"\n+  ,.upgrade= \"proto\"\n+  ,.num_headers= 2\n+  ,.headers=\n+    { { \"Connection\", \"upgrade\" }\n+    , { \"Upgrade\", \"h2c\" }\n+    }\n+  }\n+\n+#define HTTP_101_RESPONSE_WITH_UPGRADE_HEADER_AND_CONTENT_LENGTH 23\n+, {.name= \"HTTP 101 response with Upgrade and Content-Length header\"\n+  ,.type= HTTP_RESPONSE\n+  ,.raw= \"HTTP/1.1 101 Switching Protocols\\r\\n\"\n+         \"Connection: upgrade\\r\\n\"\n+         \"Upgrade: h2c\\r\\n\"\n+         \"Content-Length: 4\\r\\n\"\n+         \"\\r\\n\"\n+         \"body\"\n+         \"proto\"\n+  ,.should_keep_alive= TRUE\n+  ,.message_complete_on_eof= FALSE\n+  ,.http_major= 1\n+  ,.http_minor= 1\n+  ,.status_code= 101\n+  ,.response_status= \"Switching Protocols\"\n+  ,.body= \"body\"\n+  ,.upgrade= \"proto\"\n+  ,.num_headers= 3\n+  ,.headers=\n+    { { \"Connection\", \"upgrade\" }\n+    , { \"Upgrade\", \"h2c\" }\n+    , { \"Content-Length\", \"4\" }\n+    }\n+  }\n+\n+#define HTTP_101_RESPONSE_WITH_UPGRADE_HEADER_AND_TRANSFER_ENCODING 24\n+, {.name= \"HTTP 101 response with Upgrade and Transfer-Encoding header\"\n+  ,.type= HTTP_RESPONSE\n+  ,.raw= \"HTTP/1.1 101 Switching Protocols\\r\\n\"\n+         \"Connection: upgrade\\r\\n\"\n+         \"Upgrade: h2c\\r\\n\"\n+         \"Transfer-Encoding: chunked\\r\\n\"\n+         \"\\r\\n\"\n+         \"2\\r\\n\"\n+         \"bo\\r\\n\"\n+         \"2\\r\\n\"\n+         \"dy\\r\\n\"\n+         \"0\\r\\n\"\n+         \"\\r\\n\"\n+         \"proto\"\n+  ,.should_keep_alive= TRUE\n+  ,.message_complete_on_eof= FALSE\n+  ,.http_major= 1\n+  ,.http_minor= 1\n+  ,.status_code= 101\n+  ,.response_status= \"Switching Protocols\"\n+  ,.body= \"body\"\n+  ,.upgrade= \"proto\"\n+  ,.num_headers= 3\n+  ,.headers=\n+    { { \"Connection\", \"upgrade\" }\n+    , { \"Upgrade\", \"h2c\" }\n+    , { \"Transfer-Encoding\", \"chunked\" }\n+    }\n+  ,.num_chunks_complete= 3\n+  ,.chunk_lengths= { 2, 2 }\n+  }\n+\n+#define HTTP_200_RESPONSE_WITH_UPGRADE_HEADER 25\n+, {.name= \"HTTP 200 response with Upgrade header\"\n+  ,.type= HTTP_RESPONSE\n+  ,.raw= \"HTTP/1.1 200 OK\\r\\n\"\n+         \"Connection: upgrade\\r\\n\"\n+         \"Upgrade: h2c\\r\\n\"\n+         \"\\r\\n\"\n+         \"body\"\n+  ,.should_keep_alive= FALSE\n+  ,.message_complete_on_eof= TRUE\n+  ,.http_major= 1\n+  ,.http_minor= 1\n+  ,.status_code= 200\n+  ,.response_status= \"OK\"\n+  ,.body= \"body\"\n+  ,.upgrade= NULL\n+  ,.num_headers= 2\n+  ,.headers=\n+    { { \"Connection\", \"upgrade\" }\n+    , { \"Upgrade\", \"h2c\" }\n+    }\n+  }\n+\n+#define HTTP_200_RESPONSE_WITH_UPGRADE_HEADER_AND_CONTENT_LENGTH 26\n+, {.name= \"HTTP 200 response with Upgrade and Content-Length header\"\n+  ,.type= HTTP_RESPONSE\n+  ,.raw= \"HTTP/1.1 200 OK\\r\\n\"\n+         \"Connection: upgrade\\r\\n\"\n+         \"Upgrade: h2c\\r\\n\"\n+         \"Content-Length: 4\\r\\n\"\n+         \"\\r\\n\"\n+         \"body\"\n+  ,.should_keep_alive= TRUE\n+  ,.message_complete_on_eof= FALSE\n+  ,.http_major= 1\n+  ,.http_minor= 1\n+  ,.status_code= 200\n+  ,.response_status= \"OK\"\n+  ,.num_headers= 3\n+  ,.body= \"body\"\n+  ,.upgrade= NULL\n+  ,.headers=\n+    { { \"Connection\", \"upgrade\" }\n+    , { \"Upgrade\", \"h2c\" }\n+    , { \"Content-Length\", \"4\" }\n+    }\n+  }\n+\n+#define HTTP_200_RESPONSE_WITH_UPGRADE_HEADER_AND_TRANSFER_ENCODING 27\n+, {.name= \"HTTP 200 response with Upgrade and Transfer-Encoding header\"\n+  ,.type= HTTP_RESPONSE\n+  ,.raw= \"HTTP/1.1 200 OK\\r\\n\"\n+         \"Connection: upgrade\\r\\n\"\n+         \"Upgrade: h2c\\r\\n\"\n+         \"Transfer-Encoding: chunked\\r\\n\"\n+         \"\\r\\n\"\n+         \"2\\r\\n\"\n+         \"bo\\r\\n\"\n+         \"2\\r\\n\"\n+         \"dy\\r\\n\"\n+         \"0\\r\\n\"\n+         \"\\r\\n\"\n+  ,.should_keep_alive= TRUE\n+  ,.message_complete_on_eof= FALSE\n+  ,.http_major= 1\n+  ,.http_minor= 1\n+  ,.status_code= 200\n+  ,.response_status= \"OK\"\n+  ,.num_headers= 3\n+  ,.body= \"body\"\n+  ,.upgrade= NULL\n+  ,.headers=\n+    { { \"Connection\", \"upgrade\" }\n+    , { \"Upgrade\", \"h2c\" }\n+    , { \"Transfer-Encoding\", \"chunked\" }\n+    }\n+  ,.num_chunks_complete= 3\n+  ,.chunk_lengths= { 2, 2 }\n+  }\n+\n , {.name= NULL } /* sentinel */\n };\n \n@@ -1955,6 +2163,9 @@ int\n response_status_cb (http_parser *p, const char *buf, size_t len)\n {\n   assert(p == parser);\n+\n+  messages[num_messages].status_cb_called = TRUE;\n+\n   strlncat(messages[num_messages].response_status,\n            sizeof(messages[num_messages].response_status),\n            buf,\n@@ -2379,6 +2590,7 @@ message_eq (int index, int connect, const struct message *expected)\n   } else {\n     MESSAGE_CHECK_NUM_EQ(expected, m, status_code);\n     MESSAGE_CHECK_STR_EQ(expected, m, response_status);\n+    assert(m->status_cb_called);\n   }\n \n   if (!connect) {\n@@ -2450,7 +2662,9 @@ message_eq (int index, int connect, const struct message *expected)\n     if (!r) return 0;\n   }\n \n-  MESSAGE_CHECK_STR_EQ(expected, m, upgrade);\n+  if (!connect) {\n+    MESSAGE_CHECK_STR_EQ(expected, m, upgrade);\n+  }\n \n   return 1;\n }\n@@ -3287,9 +3501,11 @@ test_message_count_body (const struct message *message)\n }\n \n void\n-test_simple (const char *buf, enum http_errno err_expected)\n+test_simple_type (const char *buf,\n+                  enum http_errno err_expected,\n+                  enum http_parser_type type)\n {\n-  parser_init(HTTP_REQUEST);\n+  parser_init(type);\n \n   enum http_errno err;\n \n@@ -3313,6 +3529,12 @@ test_simple (const char *buf, enum http_errno err_expected)\n   }\n }\n \n+void\n+test_simple (const char *buf, enum http_errno err_expected)\n+{\n+  test_simple_type(buf, err_expected, HTTP_REQUEST);\n+}\n+\n void\n test_invalid_header_content (int req, const char* str)\n {\n@@ -3462,6 +3684,30 @@ test_header_cr_no_lf_error (int req)\n   abort();\n }\n \n+void\n+test_no_overflow_parse_url (void)\n+{\n+  int rv;\n+  struct http_parser_url u;\n+\n+  http_parser_url_init(&u);\n+  rv = http_parser_parse_url(\"http://example.com:8001\", 22, 0, &u);\n+\n+  if (rv != 0) {\n+    fprintf(stderr,\n+            \"\\n*** test_no_overflow_parse_url invalid return value=%d\\n\",\n+            rv);\n+    abort();\n+  }\n+\n+  if (u.port != 800) {\n+    fprintf(stderr,\n+            \"\\n*** test_no_overflow_parse_url invalid port number=%d\\n\",\n+            u.port);\n+    abort();\n+  }\n+}\n+\n void\n test_header_overflow_error (int req)\n {\n@@ -3850,11 +4096,10 @@ test_message_connect (const struct message *msg)\n {\n   char *buf = (char*) msg->raw;\n   size_t buflen = strlen(msg->raw);\n-  size_t nread;\n \n   parser_init(msg->type);\n \n-  nread = parse_connect(buf, buflen);\n+  parse_connect(buf, buflen);\n \n   if (num_messages != 1) {\n     printf(\"\\n*** num_messages != 1 after testing '%s' ***\\n\\n\", msg->name);\n@@ -3898,6 +4143,7 @@ main (void)\n   test_header_nread_value();\n \n   //// OVERFLOW CONDITIONS\n+  test_no_overflow_parse_url();\n \n   test_header_overflow_error(HTTP_REQUEST);\n   test_no_overflow_long_body(HTTP_REQUEST, 1000);\n@@ -3924,6 +4170,12 @@ main (void)\n \n   //// RESPONSES\n \n+  test_simple_type(\"HTP/1.1 200 OK\\r\\n\\r\\n\", HPE_INVALID_VERSION, HTTP_RESPONSE);\n+  test_simple_type(\"HTTP/01.1 200 OK\\r\\n\\r\\n\", HPE_INVALID_VERSION, HTTP_RESPONSE);\n+  test_simple_type(\"HTTP/11.1 200 OK\\r\\n\\r\\n\", HPE_INVALID_VERSION, HTTP_RESPONSE);\n+  test_simple_type(\"HTTP/1.01 200 OK\\r\\n\\r\\n\", HPE_INVALID_VERSION, HTTP_RESPONSE);\n+  test_simple_type(\"HTTP/1.1\\t200 OK\\r\\n\\r\\n\", HPE_INVALID_VERSION, HTTP_RESPONSE);\n+\n   for (i = 0; i < response_count; i++) {\n     test_message(&responses[i]);\n   }\n@@ -4001,6 +4253,9 @@ main (void)\n   /// REQUESTS\n \n   test_simple(\"GET / HTP/1.1\\r\\n\\r\\n\", HPE_INVALID_VERSION);\n+  test_simple(\"GET / HTTP/01.1\\r\\n\\r\\n\", HPE_INVALID_VERSION);\n+  test_simple(\"GET / HTTP/11.1\\r\\n\\r\\n\", HPE_INVALID_VERSION);\n+  test_simple(\"GET / HTTP/1.01\\r\\n\\r\\n\", HPE_INVALID_VERSION);\n \n   // Extended characters - see nodejs/test/parallel/test-http-headers-obstext.js\n   test_simple(\"GET / HTTP/1.1\\r\\n\""
        },
        {
            "sha": "43541707a4350c731cfc5a91614d5237bce9cf9e",
            "filename": "test/parallel/test-http-methods.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/32050065f15de0f2e68adb2387694c094da28ca2/test%2Fparallel%2Ftest-http-methods.js",
            "raw_url": "https://github.com/nodejs/node/raw/32050065f15de0f2e68adb2387694c094da28ca2/test%2Fparallel%2Ftest-http-methods.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http-methods.js?ref=32050065f15de0f2e68adb2387694c094da28ca2",
            "patch": "@@ -60,7 +60,8 @@ const methods = [\n   'PURGE',\n   'MKCALENDAR',\n   'LINK',\n-  'UNLINK'\n+  'UNLINK',\n+  'SOURCE',\n ];\n \n assert.deepStrictEqual(http.METHODS, methods.sort());"
        }
    ],
    "stats": {
        "total": 617,
        "additions": 452,
        "deletions": 165
    }
}