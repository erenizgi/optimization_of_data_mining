{
    "author": "refack",
    "message": "build: remove AIX/ppc (32bit) dead code\n\n* also dedup OS400 detection\n\nPR-URL: https://github.com/nodejs/node/pull/25523\nRefs: https://github.com/nodejs/node/pull/25447/files/36839defcfaf7c46435e16fb1f0da006f3ebe8ac#r247378894\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Beth Griggs <Bethany.Griggs@uk.ibm.com>",
    "sha": "b1a4e4100635da33d9dbee7908758c8523a520b2",
    "files": [
        {
            "sha": "63a81f2c4fd5a3434ff98421a018d3bcbbb3cbd7",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 27,
            "deletions": 50,
            "changes": 77,
            "blob_url": "https://github.com/nodejs/node/blob/b1a4e4100635da33d9dbee7908758c8523a520b2/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/b1a4e4100635da33d9dbee7908758c8523a520b2/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=b1a4e4100635da33d9dbee7908758c8523a520b2",
            "patch": "@@ -145,28 +145,8 @@\n             'msvs_configuration_platform': 'x64',\n           }],\n           ['OS==\"aix\"', {\n-            'variables': {'real_os_name': '<!(uname -s)',},\n             'cflags': [ '-gxcoff' ],\n             'ldflags': [ '-Wl,-bbigtoc' ],\n-            'conditions': [\n-              ['target_arch==\"ppc64\"', {\n-                'ldflags': [\n-                  '-Wl,-blibpath:/usr/lib:/lib:'\n-                    '/opt/freeware/lib/pthread/ppc64'\n-                ],\n-              }],\n-              ['target_arch==\"ppc\"', {\n-                'ldflags': [\n-                  '-Wl,-blibpath:/usr/lib:/lib:/opt/freeware/lib/pthread'\n-                ],\n-              }],\n-              ['\"<(real_os_name)\"==\"OS400\"', {\n-                'ldflags': [\n-                  '-Wl,-blibpath:/QOpenSys/pkgs/lib:/QOpenSys/usr/lib',\n-                  '-Wl,-brtl',\n-                ],\n-              }],\n-            ],\n           }],\n           ['OS == \"android\"', {\n             'cflags': [ '-fPIE' ],\n@@ -451,9 +431,9 @@\n             'ldflags': [ '-m32' ],\n           }],\n           [ 'target_arch==\"ppc64\" and OS!=\"aix\"', {\n-\t    'cflags': [ '-m64', '-mminimal-toc' ],\n-\t    'ldflags': [ '-m64' ],\n-\t   }],\n+            'cflags': [ '-m64', '-mminimal-toc' ],\n+            'ldflags': [ '-m64' ],\n+          }],\n           [ 'target_arch==\"s390\"', {\n             'cflags': [ '-m31', '-march=z196' ],\n             'ldflags': [ '-m31', '-march=z196' ],\n@@ -468,38 +448,35 @@\n             'cflags!': [ '-pthread' ],\n             'ldflags!': [ '-pthread' ],\n           }],\n-          [ 'OS==\"aix\"', {\n-            'variables': {'real_os_name': '<!(uname -s)',},\n-            'conditions': [\n-              [ 'target_arch==\"ppc\"', {\n-                'ldflags': [\n-                  '-Wl,-bmaxdata:0x60000000/dsa',\n-                  '-Wl,-blibpath:/usr/lib:/lib:/opt/freeware/lib/pthread',\n-                 ],\n-              }],\n-              [ 'target_arch==\"ppc64\"', {\n-                'cflags': [ '-maix64' ],\n-                'ldflags': [\n-                  '-maix64',\n-                  '-Wl,-blibpath:/usr/lib:/lib:'\n-                    '/opt/freeware/lib/pthread/ppc64',\n-                ],\n-              }],\n-              ['\"<(real_os_name)\"==\"OS400\"', {\n-                'ldflags': [\n-                  '-Wl,-blibpath:/QOpenSys/pkgs/lib:/QOpenSys/usr/lib',\n-                  '-Wl,-brtl',\n-                ],\n-              }],\n-            ],\n-            'ldflags': [ '-Wl,-bbigtoc' ],\n-            'ldflags!': [ '-rdynamic' ],\n-          }],\n           [ 'node_shared==\"true\"', {\n             'cflags': [ '-fPIC' ],\n           }],\n         ],\n       }],\n+      [ 'OS==\"aix\"', {\n+        'variables': {\n+          # Used to differentiate `AIX` and `OS400`(IBM i).\n+          'aix_variant_name': '<!(uname -s)',\n+        },\n+        'cflags': [ '-maix64', ],\n+        'ldflags!': [ '-rdynamic', ],\n+        'ldflags': [\n+          '-Wl,-bbigtoc',\n+          '-maix64',\n+        ],\n+        'conditions': [\n+          [ '\"<(aix_variant_name)\"==\"OS400\"', {            # a.k.a. `IBM i`\n+            'ldflags': [\n+              '-Wl,-blibpath:/QOpenSys/pkgs/lib:/QOpenSys/usr/lib',\n+              '-Wl,-brtl',\n+            ],\n+          }, {                                             # else it's `AIX`\n+            'ldflags': [\n+              '-Wl,-blibpath:/usr/lib:/lib:/opt/freeware/lib/pthread/ppc64',\n+            ],\n+          }],\n+        ],\n+      }],\n       ['OS==\"android\"', {\n         'target_conditions': [\n           ['_toolset==\"target\"', {"
        },
        {
            "sha": "3beeb71c1d3dff941e76a2059896a7ce064accfd",
            "filename": "node.gyp",
            "status": "modified",
            "additions": 0,
            "deletions": 21,
            "changes": 21,
            "blob_url": "https://github.com/nodejs/node/blob/b1a4e4100635da33d9dbee7908758c8523a520b2/node.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/b1a4e4100635da33d9dbee7908758c8523a520b2/node.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/node.gyp?ref=b1a4e4100635da33d9dbee7908758c8523a520b2",
            "patch": "@@ -1043,34 +1043,13 @@\n \n   'conditions': [\n     [ 'OS==\"aix\" and node_shared==\"true\"', {\n-      'variables': {'real_os_name': '<!(uname -s)',},\n       'targets': [\n         {\n           'target_name': 'node_aix_shared',\n           'type': 'shared_library',\n           'product_name': '<(node_core_target_name)',\n           'ldflags': [ '--shared' ],\n           'product_extension': '<(shlib_suffix)',\n-          'conditions': [\n-            ['target_arch==\"ppc64\"', {\n-              'ldflags': [\n-                '-Wl,-blibpath:/usr/lib:/lib:'\n-                  '/opt/freeware/lib/pthread/ppc64'\n-              ],\n-            }],\n-            ['target_arch==\"ppc\"', {\n-              'ldflags': [\n-                '-Wl,-blibpath:/usr/lib:/lib:/opt/freeware/lib/pthread'\n-              ],\n-            }],\n-            ['\"<(real_os_name)\"==\"OS400\"', {\n-              'ldflags': [\n-                '-Wl,-blibpath:/QOpenSys/pkgs/lib:/QOpenSys/usr/lib',\n-                '-Wl,-bbigtoc',\n-                '-Wl,-brtl',\n-              ],\n-            }],\n-          ],\n           'includes': [\n             'node.gypi'\n           ],"
        }
    ],
    "stats": {
        "total": 98,
        "additions": 27,
        "deletions": 71
    }
}