{
    "author": "unknown",
    "message": "inspector: do not allow host names\n\nPR-URL: https://github.com/nodejs-private/node-private/pull/102/\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Сковорода Никита Андреевич <chalkerx@gmail.com>",
    "sha": "bc690e9ef52bebc34cad7ddb40e74472bcb272ca",
    "files": [
        {
            "sha": "b3a810d99c31ed327005b598733591ea02e4db94",
            "filename": "src/inspector_socket.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 32,
            "changes": 35,
            "blob_url": "https://github.com/nodejs/node/blob/bc690e9ef52bebc34cad7ddb40e74472bcb272ca/src%2Finspector_socket.cc",
            "raw_url": "https://github.com/nodejs/node/raw/bc690e9ef52bebc34cad7ddb40e74472bcb272ca/src%2Finspector_socket.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector_socket.cc?ref=bc690e9ef52bebc34cad7ddb40e74472bcb272ca",
            "patch": "@@ -141,8 +141,6 @@ static void remove_from_beginning(std::vector<char>* buffer, size_t count) {\n   buffer->erase(buffer->begin(), buffer->begin() + count);\n }\n \n-// Cleanup\n-\n static const char CLOSE_FRAME[] = {'\\x88', '\\x00'};\n \n enum ws_decode_result {\n@@ -160,15 +158,6 @@ static void generate_accept_string(const std::string& client_key,\n   node::base64_encode(hash, sizeof(hash), *buffer, sizeof(*buffer));\n }\n \n-static bool IsOneOf(const std::string& host,\n-                    const std::vector<std::string>& hosts) {\n-  for (const std::string& candidate : hosts) {\n-    if (node::StringEqualNoCase(host.data(), candidate.data()))\n-      return true;\n-  }\n-  return false;\n-}\n-\n static std::string TrimPort(const std::string& host) {\n   size_t last_colon_pos = host.rfind(\":\");\n   if (last_colon_pos == std::string::npos)\n@@ -192,16 +181,6 @@ static bool IsIPAddress(const std::string& host) {\n   return quads == 3;\n }\n \n-// This is a value coming from the interface, it can only be IPv4 or IPv6\n-// address string.\n-static bool IsIPv4Localhost(const std::string& host) {\n-  std::string v6_tunnel_prefix = \"::ffff:\";\n-  if (host.substr(0, v6_tunnel_prefix.length()) == v6_tunnel_prefix)\n-    return IsIPv4Localhost(host.substr(v6_tunnel_prefix.length()));\n-  std::string localhost_net = \"127.\";\n-  return host.substr(0, localhost_net.length()) == localhost_net;\n-}\n-\n // Constants for hybi-10 frame format.\n \n typedef int OpCode;\n@@ -600,17 +579,9 @@ class HttpHandler : public ProtocolHandler {\n \n   bool IsAllowedHost(const std::string& host_with_port) const {\n     std::string host = TrimPort(host_with_port);\n-    if (host.empty())\n-      return false;\n-    if (IsIPAddress(host))\n-       return true;\n-    std::string socket_host = GetHost();\n-    if (IsIPv4Localhost(socket_host)) {\n-      return IsOneOf(host, { \"localhost\" });\n-    } else if (socket_host == \"::1\") {\n-      return IsOneOf(host, { \"localhost\", \"localhost6\" });\n-    }\n-    return true;\n+    return host.empty() || IsIPAddress(host)\n+           || node::StringEqualNoCase(host.data(), \"localhost\")\n+           || node::StringEqualNoCase(host.data(), \"localhost6\");\n   }\n \n   bool parsing_value_;"
        }
    ],
    "stats": {
        "total": 35,
        "additions": 3,
        "deletions": 32
    }
}