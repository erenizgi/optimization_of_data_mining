{
    "author": "targos",
    "message": "src: remove calls to deprecated V8 functions (Int32Value)\n\nRemove all calls to deprecated V8 functions (here: Value::Int32Value)\ninside the code.\n\nPR-URL: https://github.com/nodejs/node/pull/22662\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Minwoo Jung <minwoo@nodesource.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ujjwal Sharma <usharma1998@gmail.com>",
    "sha": "594a84d8f2cb3c630744487d02dbcff05675d6cf",
    "files": [
        {
            "sha": "c74678977d633a796c1efd7cdaf4ef793a727678",
            "filename": "src/cares_wrap.cc",
            "status": "modified",
            "additions": 14,
            "deletions": 13,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fcares_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fcares_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fcares_wrap.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -61,6 +61,7 @@ using v8::EscapableHandleScope;\n using v8::FunctionCallbackInfo;\n using v8::FunctionTemplate;\n using v8::HandleScope;\n+using v8::Int32;\n using v8::Integer;\n using v8::Local;\n using v8::Null;\n@@ -1987,23 +1988,23 @@ void GetAddrInfo(const FunctionCallbackInfo<Value>& args) {\n \n   int32_t flags = 0;\n   if (args[3]->IsInt32()) {\n-    flags = args[3]->Int32Value(env->context()).FromJust();\n+    flags = args[3].As<Int32>()->Value();\n   }\n \n   int family;\n \n-  switch (args[2]->Int32Value(env->context()).FromJust()) {\n-  case 0:\n-    family = AF_UNSPEC;\n-    break;\n-  case 4:\n-    family = AF_INET;\n-    break;\n-  case 6:\n-    family = AF_INET6;\n-    break;\n-  default:\n-    CHECK(0 && \"bad address family\");\n+  switch (args[2].As<Int32>()->Value()) {\n+    case 0:\n+      family = AF_UNSPEC;\n+      break;\n+    case 4:\n+      family = AF_INET;\n+      break;\n+    case 6:\n+      family = AF_INET6;\n+      break;\n+    default:\n+      CHECK(0 && \"bad address family\");\n   }\n \n   auto req_wrap = new GetAddrInfoReqWrap(env, req_wrap_obj, args[4]->IsTrue());"
        },
        {
            "sha": "4769a9c56d633f4170caf8bfadd596f33720e967",
            "filename": "src/js_stream.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fjs_stream.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fjs_stream.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fjs_stream.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -14,6 +14,7 @@ using v8::Context;\n using v8::FunctionCallbackInfo;\n using v8::FunctionTemplate;\n using v8::HandleScope;\n+using v8::Int32;\n using v8::Local;\n using v8::Object;\n using v8::String;\n@@ -154,7 +155,8 @@ void JSStream::Finish(const FunctionCallbackInfo<Value>& args) {\n   CHECK(args[0]->IsObject());\n   Wrap* w = static_cast<Wrap*>(StreamReq::FromObject(args[0].As<Object>()));\n \n-  w->Done(args[1]->Int32Value());\n+  CHECK(args[1]->IsInt32());\n+  w->Done(args[1].As<Int32>()->Value());\n }\n \n "
        },
        {
            "sha": "0d22eb6dbd0d65a3be2dc20fbe1a9a694667b529",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -1198,7 +1198,8 @@ static void Exit(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n   WaitForInspectorDisconnect(env);\n   v8_platform.StopTracingAgent();\n-  env->Exit(args[0]->Int32Value());\n+  int code = args[0]->Int32Value(env->context()).FromMaybe(0);\n+  env->Exit(code);\n }\n \n extern \"C\" void node_module_register(void* m) {"
        },
        {
            "sha": "7b0bb6c1637dabeedf6857815d85c16f0478fdb9",
            "filename": "src/node_crypto.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 19,
            "changes": 29,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_crypto.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_crypto.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -1045,7 +1045,7 @@ void SecureContext::SetSessionTimeout(const FunctionCallbackInfo<Value>& args) {\n         sc->env(), \"Session timeout must be a 32-bit integer\");\n   }\n \n-  int32_t sessionTimeout = args[0]->Int32Value();\n+  int32_t sessionTimeout = args[0].As<Int32>()->Value();\n   SSL_CTX_set_timeout(sc->ctx_.get(), sessionTimeout);\n }\n \n@@ -1267,7 +1267,8 @@ int SecureContext::TicketKeyCallback(SSL* ssl,\n                                         {0, 0}).ToLocalChecked();\n   Local<Array> arr = ret.As<Array>();\n \n-  int r = arr->Get(kTicketKeyReturnIndex)->Int32Value();\n+  int r =\n+      arr->Get(kTicketKeyReturnIndex)->Int32Value(env->context()).FromJust();\n   if (r < 0)\n     return r;\n \n@@ -3629,14 +3630,10 @@ void Sign::SignFinal(const FunctionCallbackInfo<Value>& args) {\n   char* buf = Buffer::Data(args[0]);\n \n   CHECK(args[2]->IsInt32());\n-  Maybe<int32_t> maybe_padding = args[2]->Int32Value(env->context());\n-  CHECK(maybe_padding.IsJust());\n-  int padding = maybe_padding.ToChecked();\n+  int padding = args[2].As<Int32>()->Value();\n \n   CHECK(args[3]->IsInt32());\n-  Maybe<int32_t> maybe_salt_len = args[3]->Int32Value(env->context());\n-  CHECK(maybe_salt_len.IsJust());\n-  int salt_len = maybe_salt_len.ToChecked();\n+  int salt_len = args[3].As<Int32>()->Value();\n \n   ClearErrorOnReturn clear_error_on_return;\n   unsigned char md_value[8192];\n@@ -3783,8 +3780,6 @@ SignBase::Error Verify::VerifyFinal(const char* key_pem,\n \n \n void Verify::VerifyFinal(const FunctionCallbackInfo<Value>& args) {\n-  Environment* env = Environment::GetCurrent(args);\n-\n   ClearErrorOnReturn clear_error_on_return;\n \n   Verify* verify;\n@@ -3797,14 +3792,10 @@ void Verify::VerifyFinal(const FunctionCallbackInfo<Value>& args) {\n   ssize_t hlen = Buffer::Length(args[1]);\n \n   CHECK(args[2]->IsInt32());\n-  Maybe<int32_t> maybe_padding = args[2]->Int32Value(env->context());\n-  CHECK(maybe_padding.IsJust());\n-  int padding = maybe_padding.ToChecked();\n+  int padding = args[2].As<Int32>()->Value();\n \n   CHECK(args[3]->IsInt32());\n-  Maybe<int32_t> maybe_salt_len = args[3]->Int32Value(env->context());\n-  CHECK(maybe_salt_len.IsJust());\n-  int salt_len = maybe_salt_len.ToChecked();\n+  int salt_len = args[3].As<Int32>()->Value();\n \n   bool verify_result;\n   Error err = verify->VerifyFinal(kbuf, klen, hbuf, hlen, padding, salt_len,\n@@ -4076,14 +4067,14 @@ void DiffieHellman::New(const FunctionCallbackInfo<Value>& args) {\n   if (args.Length() == 2) {\n     if (args[0]->IsInt32()) {\n       if (args[1]->IsInt32()) {\n-        initialized = diffieHellman->Init(args[0]->Int32Value(),\n-                                          args[1]->Int32Value());\n+        initialized = diffieHellman->Init(args[0].As<Int32>()->Value(),\n+                                          args[1].As<Int32>()->Value());\n       }\n     } else {\n       if (args[1]->IsInt32()) {\n         initialized = diffieHellman->Init(Buffer::Data(args[0]),\n                                           Buffer::Length(args[0]),\n-                                          args[1]->Int32Value());\n+                                          args[1].As<Int32>()->Value());\n       } else {\n         initialized = diffieHellman->Init(Buffer::Data(args[0]),\n                                           Buffer::Length(args[0]),"
        },
        {
            "sha": "517d32064ea2322aeca74d6f008ff9620223fa35",
            "filename": "src/node_dtrace.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 7,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_dtrace.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_dtrace.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_dtrace.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -69,13 +69,15 @@ using v8::Value;\n   if ((*(const char **)valp = *_##member) == nullptr)                      \\\n     *(const char **)valp = \"<unknown>\";\n \n-#define SLURP_INT(obj, member, valp)                                       \\\n-  if (!(obj)->IsObject()) {                                                \\\n-    return node::THROW_ERR_INVALID_ARG_TYPE(env,                           \\\n-        \"expected object for \" #obj \" to contain integer member \" #member);\\\n-  }                                                                        \\\n-  *valp = obj->Get(OneByteString(env->isolate(), #member))                 \\\n-      ->Int32Value();\n+#define SLURP_INT(obj, member, valp)                                           \\\n+  if (!(obj)->IsObject()) {                                                    \\\n+    return node::THROW_ERR_INVALID_ARG_TYPE(                                   \\\n+        env,                                                                   \\\n+        \"expected object for \" #obj \" to contain integer member \" #member);    \\\n+  }                                                                            \\\n+  *valp = obj->Get(OneByteString(env->isolate(), #member))                     \\\n+              ->Int32Value(env->context())                                     \\\n+              .FromJust();\n \n #define SLURP_OBJECT(obj, member, valp)                                    \\\n   if (!(obj)->IsObject()) {                                                \\"
        },
        {
            "sha": "f2ec2c0bbde4f2a39ed16a1cbd12acf1b878ede6",
            "filename": "src/node_http_parser.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_http_parser.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_http_parser.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_http_parser.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -57,6 +57,7 @@ using v8::Function;\n using v8::FunctionCallbackInfo;\n using v8::FunctionTemplate;\n using v8::HandleScope;\n+using v8::Int32;\n using v8::Integer;\n using v8::Local;\n using v8::MaybeLocal;\n@@ -361,8 +362,9 @@ class Parser : public AsyncWrap, public StreamListener {\n \n   static void New(const FunctionCallbackInfo<Value>& args) {\n     Environment* env = Environment::GetCurrent(args);\n+    CHECK(args[0]->IsInt32());\n     http_parser_type type =\n-        static_cast<http_parser_type>(args[0]->Int32Value());\n+        static_cast<http_parser_type>(args[0].As<Int32>()->Value());\n     CHECK(type == HTTP_REQUEST || type == HTTP_RESPONSE);\n     new Parser(env, args.This(), type);\n   }\n@@ -458,8 +460,9 @@ class Parser : public AsyncWrap, public StreamListener {\n   static void Reinitialize(const FunctionCallbackInfo<Value>& args) {\n     Environment* env = Environment::GetCurrent(args);\n \n+    CHECK(args[0]->IsInt32());\n     http_parser_type type =\n-        static_cast<http_parser_type>(args[0]->Int32Value());\n+        static_cast<http_parser_type>(args[0].As<Int32>()->Value());\n \n     CHECK(type == HTTP_REQUEST || type == HTTP_RESPONSE);\n     Parser* parser;"
        },
        {
            "sha": "abe8addfadccde48acd02550f120ff516f904333",
            "filename": "src/node_i18n.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_i18n.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_i18n.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_i18n.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -87,6 +87,7 @@ namespace node {\n using v8::Context;\n using v8::FunctionCallbackInfo;\n using v8::HandleScope;\n+using v8::Int32;\n using v8::Isolate;\n using v8::Local;\n using v8::MaybeLocal;\n@@ -502,7 +503,8 @@ void Transcode(const FunctionCallbackInfo<Value>&args) {\n \n void ICUErrorName(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n-  UErrorCode status = static_cast<UErrorCode>(args[0]->Int32Value());\n+  CHECK(args[0]->IsInt32());\n+  UErrorCode status = static_cast<UErrorCode>(args[0].As<Int32>()->Value());\n   args.GetReturnValue().Set(\n       String::NewFromUtf8(env->isolate(),\n                           u_errorName(status),"
        },
        {
            "sha": "ba774fd8fa652ee608da188516fbe8e587c12332",
            "filename": "src/node_process.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_process.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_process.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_process.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -165,12 +165,15 @@ void HrtimeBigInt(const FunctionCallbackInfo<Value>& args) {\n \n void Kill(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n+  Local<Context> context = env->context();\n \n   if (args.Length() != 2)\n     return env->ThrowError(\"Bad argument.\");\n \n-  int pid = args[0]->Int32Value();\n-  int sig = args[1]->Int32Value();\n+  int pid;\n+  if (!args[0]->Int32Value(context).To(&pid)) return;\n+  int sig;\n+  if (!args[1]->Int32Value(context).To(&sig)) return;\n   int err = uv_kill(pid, sig);\n   args.GetReturnValue().Set(err);\n }"
        },
        {
            "sha": "cd15603f0b036d3bea7fd5a1c09ea6ed410e0317",
            "filename": "src/node_zlib.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 3,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_zlib.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fnode_zlib.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_zlib.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -45,6 +45,7 @@ using v8::Function;\n using v8::FunctionCallbackInfo;\n using v8::FunctionTemplate;\n using v8::HandleScope;\n+using v8::Int32;\n using v8::Local;\n using v8::Number;\n using v8::Object;\n@@ -419,7 +420,8 @@ class ZCtx : public AsyncWrap, public ThreadPoolWork {\n   static void New(const FunctionCallbackInfo<Value>& args) {\n     Environment* env = Environment::GetCurrent(args);\n     CHECK(args[0]->IsInt32());\n-    node_zlib_mode mode = static_cast<node_zlib_mode>(args[0]->Int32Value());\n+    node_zlib_mode mode =\n+        static_cast<node_zlib_mode>(args[0].As<Int32>()->Value());\n     new ZCtx(env, args.This(), mode);\n   }\n \n@@ -459,7 +461,8 @@ class ZCtx : public AsyncWrap, public ThreadPoolWork {\n           \"invalid windowBits\");\n     }\n \n-    int level = args[1]->Int32Value();\n+    int level;\n+    if (!args[1]->Int32Value(context).To(&level)) return;\n     CHECK((level >= Z_MIN_LEVEL && level <= Z_MAX_LEVEL) &&\n       \"invalid compression level\");\n \n@@ -506,7 +509,12 @@ class ZCtx : public AsyncWrap, public ThreadPoolWork {\n     CHECK(args.Length() == 2 && \"params(level, strategy)\");\n     ZCtx* ctx;\n     ASSIGN_OR_RETURN_UNWRAP(&ctx, args.Holder());\n-    ctx->Params(args[0]->Int32Value(), args[1]->Int32Value());\n+    Environment* env = ctx->env();\n+    int level;\n+    if (!args[0]->Int32Value(env->context()).To(&level)) return;\n+    int strategy;\n+    if (!args[1]->Int32Value(env->context()).To(&strategy)) return;\n+    ctx->Params(level, strategy);\n   }\n \n   static void Reset(const FunctionCallbackInfo<Value> &args) {"
        },
        {
            "sha": "00c0eef6549464802baf924f98ed715cf8044e8e",
            "filename": "src/pipe_wrap.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fpipe_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fpipe_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fpipe_wrap.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -173,7 +173,8 @@ void PipeWrap::Bind(const FunctionCallbackInfo<Value>& args) {\n void PipeWrap::SetPendingInstances(const FunctionCallbackInfo<Value>& args) {\n   PipeWrap* wrap;\n   ASSIGN_OR_RETURN_UNWRAP(&wrap, args.Holder());\n-  int instances = args[0]->Int32Value();\n+  CHECK(args[0]->IsInt32());\n+  int instances = args[0].As<Int32>()->Value();\n   uv_pipe_pending_instances(&wrap->handle_, instances);\n }\n #endif\n@@ -193,7 +194,9 @@ void PipeWrap::Fchmod(const v8::FunctionCallbackInfo<v8::Value>& args) {\n void PipeWrap::Listen(const FunctionCallbackInfo<Value>& args) {\n   PipeWrap* wrap;\n   ASSIGN_OR_RETURN_UNWRAP(&wrap, args.Holder());\n-  int backlog = args[0]->Int32Value();\n+  Environment* env = wrap->env();\n+  int backlog;\n+  if (!args[0]->Int32Value(env->context()).To(&backlog)) return;\n   int err = uv_listen(reinterpret_cast<uv_stream_t*>(&wrap->handle_),\n                       backlog,\n                       OnConnection);\n@@ -207,7 +210,8 @@ void PipeWrap::Open(const FunctionCallbackInfo<Value>& args) {\n   PipeWrap* wrap;\n   ASSIGN_OR_RETURN_UNWRAP(&wrap, args.Holder());\n \n-  int fd = args[0]->Int32Value();\n+  int fd;\n+  if (!args[0]->Int32Value(env->context()).To(&fd)) return;\n \n   int err = uv_pipe_open(&wrap->handle_, fd);\n   wrap->set_fd(fd);"
        },
        {
            "sha": "70f656ae5e67d3fc3e8bcb0f0e9bb07e7a60d780",
            "filename": "src/process_wrap.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fprocess_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fprocess_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fprocess_wrap.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -36,6 +36,7 @@ using v8::Context;\n using v8::FunctionCallbackInfo;\n using v8::FunctionTemplate;\n using v8::HandleScope;\n+using v8::Int32;\n using v8::Integer;\n using v8::Local;\n using v8::Number;\n@@ -158,7 +159,7 @@ class ProcessWrap : public HandleWrap {\n         js_options->Get(context, env->uid_string()).ToLocalChecked();\n     if (!uid_v->IsUndefined() && !uid_v->IsNull()) {\n       CHECK(uid_v->IsInt32());\n-      const int32_t uid = uid_v->Int32Value(context).FromJust();\n+      const int32_t uid = uid_v.As<Int32>()->Value();\n       options.flags |= UV_PROCESS_SETUID;\n       options.uid = static_cast<uv_uid_t>(uid);\n     }\n@@ -168,7 +169,7 @@ class ProcessWrap : public HandleWrap {\n         js_options->Get(context, env->gid_string()).ToLocalChecked();\n     if (!gid_v->IsUndefined() && !gid_v->IsNull()) {\n       CHECK(gid_v->IsInt32());\n-      const int32_t gid = gid_v->Int32Value(context).FromJust();\n+      const int32_t gid = gid_v.As<Int32>()->Value();\n       options.flags |= UV_PROCESS_SETGID;\n       options.gid = static_cast<uv_gid_t>(gid);\n     }"
        },
        {
            "sha": "78b4155fd596406ab4311b64835145191077b037",
            "filename": "src/signal_wrap.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fsignal_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fsignal_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fsignal_wrap.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -88,7 +88,9 @@ class SignalWrap : public HandleWrap {\n   static void Start(const FunctionCallbackInfo<Value>& args) {\n     SignalWrap* wrap;\n     ASSIGN_OR_RETURN_UNWRAP(&wrap, args.Holder());\n-    int signum = args[0]->Int32Value();\n+    Environment* env = wrap->env();\n+    int signum;\n+    if (!args[0]->Int32Value(env->context()).To(&signum)) return;\n #if defined(__POSIX__) && HAVE_INSPECTOR\n     if (signum == SIGPROF) {\n       Environment* env = Environment::GetCurrent(args);"
        },
        {
            "sha": "46d895e38a7389a554d75dfee4b116b6ae5953dd",
            "filename": "src/spawn_sync.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fspawn_sync.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fspawn_sync.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fspawn_sync.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -35,6 +35,7 @@ using v8::Context;\n using v8::EscapableHandleScope;\n using v8::FunctionCallbackInfo;\n using v8::HandleScope;\n+using v8::Int32;\n using v8::Integer;\n using v8::Isolate;\n using v8::Just;\n@@ -783,7 +784,7 @@ Maybe<int> SyncProcessRunner::ParseOptions(Local<Value> js_value) {\n       js_options->Get(context, env()->uid_string()).ToLocalChecked();\n   if (IsSet(js_uid)) {\n     CHECK(js_uid->IsInt32());\n-    const int32_t uid = js_uid->Int32Value(context).FromJust();\n+    const int32_t uid = js_uid.As<Int32>()->Value();\n     uv_process_options_.uid = static_cast<uv_uid_t>(uid);\n     uv_process_options_.flags |= UV_PROCESS_SETUID;\n   }\n@@ -792,7 +793,7 @@ Maybe<int> SyncProcessRunner::ParseOptions(Local<Value> js_value) {\n       js_options->Get(context, env()->gid_string()).ToLocalChecked();\n   if (IsSet(js_gid)) {\n     CHECK(js_gid->IsInt32());\n-    const int32_t gid = js_gid->Int32Value(context).FromJust();\n+    const int32_t gid = js_gid.As<Int32>()->Value();\n     uv_process_options_.gid = static_cast<uv_gid_t>(gid);\n     uv_process_options_.flags |= UV_PROCESS_SETGID;\n   }\n@@ -833,7 +834,7 @@ Maybe<int> SyncProcessRunner::ParseOptions(Local<Value> js_value) {\n       js_options->Get(context, env()->kill_signal_string()).ToLocalChecked();\n   if (IsSet(js_kill_signal)) {\n     CHECK(js_kill_signal->IsInt32());\n-    kill_signal_ = js_kill_signal->Int32Value(context).FromJust();\n+    kill_signal_ = js_kill_signal.As<Int32>()->Value();\n   }\n \n   Local<Value> js_stdio ="
        },
        {
            "sha": "dd507e6ebde6f4acbb10dc8bb4080aef476a6539",
            "filename": "src/tcp_wrap.cc",
            "status": "modified",
            "additions": 17,
            "deletions": 9,
            "changes": 26,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Ftcp_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Ftcp_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftcp_wrap.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -180,7 +180,9 @@ void TCPWrap::SetKeepAlive(const FunctionCallbackInfo<Value>& args) {\n   ASSIGN_OR_RETURN_UNWRAP(&wrap,\n                           args.Holder(),\n                           args.GetReturnValue().Set(UV_EBADF));\n-  int enable = args[0]->Int32Value();\n+  Environment* env = wrap->env();\n+  int enable;\n+  if (!args[0]->Int32Value(env->context()).To(&enable)) return;\n   unsigned int delay = args[1].As<Uint32>()->Value();\n   int err = uv_tcp_keepalive(&wrap->handle_, enable, delay);\n   args.GetReturnValue().Set(err);\n@@ -220,8 +222,10 @@ void TCPWrap::Bind(const FunctionCallbackInfo<Value>& args) {\n   ASSIGN_OR_RETURN_UNWRAP(&wrap,\n                           args.Holder(),\n                           args.GetReturnValue().Set(UV_EBADF));\n-  node::Utf8Value ip_address(args.GetIsolate(), args[0]);\n-  int port = args[1]->Int32Value();\n+  Environment* env = wrap->env();\n+  node::Utf8Value ip_address(env->isolate(), args[0]);\n+  int port;\n+  if (!args[1]->Int32Value(env->context()).To(&port)) return;\n   sockaddr_in addr;\n   int err = uv_ip4_addr(*ip_address, port, &addr);\n   if (err == 0) {\n@@ -238,8 +242,10 @@ void TCPWrap::Bind6(const FunctionCallbackInfo<Value>& args) {\n   ASSIGN_OR_RETURN_UNWRAP(&wrap,\n                           args.Holder(),\n                           args.GetReturnValue().Set(UV_EBADF));\n-  node::Utf8Value ip6_address(args.GetIsolate(), args[0]);\n-  int port = args[1]->Int32Value();\n+  Environment* env = wrap->env();\n+  node::Utf8Value ip6_address(env->isolate(), args[0]);\n+  int port;\n+  if (!args[1]->Int32Value(env->context()).To(&port)) return;\n   sockaddr_in6 addr;\n   int err = uv_ip6_addr(*ip6_address, port, &addr);\n   if (err == 0) {\n@@ -256,7 +262,9 @@ void TCPWrap::Listen(const FunctionCallbackInfo<Value>& args) {\n   ASSIGN_OR_RETURN_UNWRAP(&wrap,\n                           args.Holder(),\n                           args.GetReturnValue().Set(UV_EBADF));\n-  int backlog = args[0]->Int32Value();\n+  Environment* env = wrap->env();\n+  int backlog;\n+  if (!args[0]->Int32Value(env->context()).To(&backlog)) return;\n   int err = uv_listen(reinterpret_cast<uv_stream_t*>(&wrap->handle_),\n                       backlog,\n                       OnConnection);\n@@ -300,20 +308,20 @@ void TCPWrap::Connect(const FunctionCallbackInfo<Value>& args) {\n \n \n void TCPWrap::Connect6(const FunctionCallbackInfo<Value>& args) {\n-  Environment* env = Environment::GetCurrent(args);\n-\n   TCPWrap* wrap;\n   ASSIGN_OR_RETURN_UNWRAP(&wrap,\n                           args.Holder(),\n                           args.GetReturnValue().Set(UV_EBADF));\n+  Environment* env = wrap->env();\n \n   CHECK(args[0]->IsObject());\n   CHECK(args[1]->IsString());\n   CHECK(args[2]->IsUint32());\n \n   Local<Object> req_wrap_obj = args[0].As<Object>();\n   node::Utf8Value ip_address(env->isolate(), args[1]);\n-  int port = args[2]->Int32Value();\n+  int port;\n+  if (!args[2]->Int32Value(env->context()).To(&port)) return;\n \n   sockaddr_in6 addr;\n   int err = uv_ip6_addr(*ip_address, port, &addr);"
        },
        {
            "sha": "8151ba02a2aae4f3ff3be21c437230fc9c38d2a8",
            "filename": "src/tty_wrap.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Ftty_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Ftty_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftty_wrap.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -75,7 +75,8 @@ uv_tty_t* TTYWrap::UVHandle() {\n \n void TTYWrap::GuessHandleType(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n-  int fd = args[0]->Int32Value();\n+  int fd;\n+  if (!args[0]->Int32Value(env->context()).To(&fd)) return;\n   CHECK_GE(fd, 0);\n \n   uv_handle_type t = uv_guess_handle(fd);\n@@ -97,7 +98,9 @@ void TTYWrap::GuessHandleType(const FunctionCallbackInfo<Value>& args) {\n \n \n void TTYWrap::IsTTY(const FunctionCallbackInfo<Value>& args) {\n-  int fd = args[0]->Int32Value();\n+  Environment* env = Environment::GetCurrent(args);\n+  int fd;\n+  if (!args[0]->Int32Value(env->context()).To(&fd)) return;\n   CHECK_GE(fd, 0);\n   bool rc = uv_guess_handle(fd) == UV_TTY;\n   args.GetReturnValue().Set(rc);\n@@ -144,7 +147,8 @@ void TTYWrap::New(const FunctionCallbackInfo<Value>& args) {\n   // normal function.\n   CHECK(args.IsConstructCall());\n \n-  int fd = args[0]->Int32Value();\n+  int fd;\n+  if (!args[0]->Int32Value(env->context()).To(&fd)) return;\n   CHECK_GE(fd, 0);\n \n   int err = 0;"
        },
        {
            "sha": "c7ca7fc44d67de55997b70689f6498a738e90002",
            "filename": "src/udp_wrap.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 8,
            "changes": 19,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fudp_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fudp_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fudp_wrap.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -267,14 +267,17 @@ void UDPWrap::BufferSize(const FunctionCallbackInfo<Value>& args) {\n   args.GetReturnValue().Set(size);\n }\n \n-\n-#define X(name, fn)                                                           \\\n-  void UDPWrap::name(const FunctionCallbackInfo<Value>& args) {               \\\n-    UDPWrap* wrap = Unwrap<UDPWrap>(args.Holder());                           \\\n-    CHECK_EQ(args.Length(), 1);                                               \\\n-    int flag = args[0]->Int32Value();                                         \\\n-    int err = wrap == nullptr ? UV_EBADF : fn(&wrap->handle_, flag);          \\\n-    args.GetReturnValue().Set(err);                                           \\\n+#define X(name, fn)                                                            \\\n+  void UDPWrap::name(const FunctionCallbackInfo<Value>& args) {                \\\n+    UDPWrap* wrap = Unwrap<UDPWrap>(args.Holder());                            \\\n+    Environment* env = wrap->env();                                            \\\n+    CHECK_EQ(args.Length(), 1);                                                \\\n+    int flag;                                                                  \\\n+    if (!args[0]->Int32Value(env->context()).To(&flag)) {                      \\\n+      return;                                                                  \\\n+    }                                                                          \\\n+    int err = wrap == nullptr ? UV_EBADF : fn(&wrap->handle_, flag);           \\\n+    args.GetReturnValue().Set(err);                                            \\\n   }\n \n X(SetTTL, uv_udp_set_ttl)"
        },
        {
            "sha": "da67fce80390eb9b21b5a7732857aced9dedd9fd",
            "filename": "src/uv.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fuv.cc",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/src%2Fuv.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fuv.cc?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -43,7 +43,8 @@ using v8::Value;\n // lib/util.getSystemErrorName()\n void ErrName(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n-  int err = args[0]->Int32Value();\n+  int err;\n+  if (!args[0]->Int32Value(env->context()).To(&err)) return;\n   CHECK_LT(err, 0);\n   const char* name = uv_err_name(err);\n   args.GetReturnValue().Set(OneByteString(env->isolate(), name));"
        },
        {
            "sha": "b44bc3f453a325980ba44ffdf0d94f8524d8b795",
            "filename": "test/parallel/test-http-parser-bad-ref.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/test%2Fparallel%2Ftest-http-parser-bad-ref.js",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/test%2Fparallel%2Ftest-http-parser-bad-ref.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http-parser-bad-ref.js?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -25,7 +25,7 @@ function flushPool() {\n function demoBug(part1, part2) {\n   flushPool();\n \n-  const parser = new HTTPParser('REQUEST');\n+  const parser = new HTTPParser(0);\n \n   parser.headers = [];\n   parser.url = '';"
        },
        {
            "sha": "aac356df2a00ed3f690e13adc7bc76bf845bf6f3",
            "filename": "test/sequential/test-async-wrap-getasyncid.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/594a84d8f2cb3c630744487d02dbcff05675d6cf/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "raw_url": "https://github.com/nodejs/node/raw/594a84d8f2cb3c630744487d02dbcff05675d6cf/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-async-wrap-getasyncid.js?ref=594a84d8f2cb3c630744487d02dbcff05675d6cf",
            "patch": "@@ -148,7 +148,7 @@ if (common.hasCrypto) { // eslint-disable-line node-core/crypto-check\n \n {\n   const { HTTPParser } = internalBinding('http_parser');\n-  testInitialized(new HTTPParser(), 'HTTPParser');\n+  testInitialized(new HTTPParser(0), 'HTTPParser');\n }\n \n "
        }
    ],
    "stats": {
        "total": 199,
        "additions": 118,
        "deletions": 81
    }
}