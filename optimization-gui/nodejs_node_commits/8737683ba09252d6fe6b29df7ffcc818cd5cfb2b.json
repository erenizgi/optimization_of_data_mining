{
    "author": "rubys",
    "message": "tools: add [src] links to child-process.html\n\nhandle exports. as an alternative to module.exports\n\nPR-URL: https://github.com/nodejs/node/pull/22706\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "8737683ba09252d6fe6b29df7ffcc818cd5cfb2b",
    "files": [
        {
            "sha": "880fdf6c9dbe0d8b66c3b7a58d87c01543977213",
            "filename": "test/fixtures/apilinks/exports.js",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/8737683ba09252d6fe6b29df7ffcc818cd5cfb2b/test%2Ffixtures%2Fapilinks%2Fexports.js",
            "raw_url": "https://github.com/nodejs/node/raw/8737683ba09252d6fe6b29df7ffcc818cd5cfb2b/test%2Ffixtures%2Fapilinks%2Fexports.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fapilinks%2Fexports.js?ref=8737683ba09252d6fe6b29df7ffcc818cd5cfb2b",
            "patch": "@@ -0,0 +1,13 @@\n+'use strict';\n+\n+// Support `exports` as an alternative to `module.exports`.\n+\n+function Buffer() {};\n+\n+exports.Buffer = Buffer;\n+exports.fn1 = function fn1() {};\n+\n+var fn2 = exports.fn2 = function() {};\n+\n+function fn3() {};\n+exports.fn3 = fn3;"
        },
        {
            "sha": "f17367a0fc8557d4ab41d36e50d7ae894d6e3741",
            "filename": "test/fixtures/apilinks/exports.json",
            "status": "added",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/8737683ba09252d6fe6b29df7ffcc818cd5cfb2b/test%2Ffixtures%2Fapilinks%2Fexports.json",
            "raw_url": "https://github.com/nodejs/node/raw/8737683ba09252d6fe6b29df7ffcc818cd5cfb2b/test%2Ffixtures%2Fapilinks%2Fexports.json",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fapilinks%2Fexports.json?ref=8737683ba09252d6fe6b29df7ffcc818cd5cfb2b",
            "patch": "@@ -0,0 +1,6 @@\n+{\n+  \"exports.Buffer\": \"exports.js#L5\",\n+  \"exports.fn1\": \"exports.js#L8\",\n+  \"exports.fn2\": \"exports.js#L10\",\n+  \"exports.fn3\": \"exports.js#L12\"\n+}"
        },
        {
            "sha": "0a33125a17b1033b7a465e574f6f5cda84872669",
            "filename": "tools/doc/apilinks.js",
            "status": "modified",
            "additions": 41,
            "deletions": 25,
            "changes": 66,
            "blob_url": "https://github.com/nodejs/node/blob/8737683ba09252d6fe6b29df7ffcc818cd5cfb2b/tools%2Fdoc%2Fapilinks.js",
            "raw_url": "https://github.com/nodejs/node/raw/8737683ba09252d6fe6b29df7ffcc818cd5cfb2b/tools%2Fdoc%2Fapilinks.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fdoc%2Fapilinks.js?ref=8737683ba09252d6fe6b29df7ffcc818cd5cfb2b",
            "patch": "@@ -61,6 +61,7 @@ process.argv.slice(2).forEach((file) => {\n \n   // Scan for exports.\n   const exported = { constructors: [], identifiers: [] };\n+  const indirect = {};\n   program.forEach((statement) => {\n     if (statement.type === 'ExpressionStatement') {\n       const expr = statement.expression;\n@@ -69,35 +70,52 @@ process.argv.slice(2).forEach((file) => {\n       let lhs = expr.left;\n       if (expr.left.object.type === 'MemberExpression') lhs = lhs.object;\n       if (lhs.type !== 'MemberExpression') return;\n-      if (lhs.object.name !== 'module') return;\n-      if (lhs.property.name !== 'exports') return;\n-\n-      let rhs = expr.right;\n-      while (rhs.type === 'AssignmentExpression') rhs = rhs.right;\n-\n-      if (rhs.type === 'NewExpression') {\n-        exported.constructors.push(rhs.callee.name);\n-      } else if (rhs.type === 'ObjectExpression') {\n-        rhs.properties.forEach((property) => {\n-          if (property.value.type === 'Identifier') {\n-            exported.identifiers.push(property.value.name);\n-            if (/^[A-Z]/.test(property.value.name[0])) {\n-              exported.constructors.push(property.value.name);\n-            }\n+      if (lhs.object.name === 'exports') {\n+        const name = lhs.property.name;\n+        if (expr.right.type === 'FunctionExpression') {\n+          definition[`${basename}.${name}`] =\n+            `${link}#L${statement.loc.start.line}`;\n+        } else if (expr.right.type === 'Identifier') {\n+          if (expr.right.name === name) {\n+            indirect[name] = `${basename}.${name}`;\n           }\n-        });\n-      } else if (rhs.type === 'Identifier') {\n-        exported.identifiers.push(rhs.name);\n+        } else {\n+          exported.identifiers.push(name);\n+        }\n+      } else if (lhs.object.name === 'module') {\n+        if (lhs.property.name !== 'exports') return;\n+\n+        let rhs = expr.right;\n+        while (rhs.type === 'AssignmentExpression') rhs = rhs.right;\n+\n+        if (rhs.type === 'NewExpression') {\n+          exported.constructors.push(rhs.callee.name);\n+        } else if (rhs.type === 'ObjectExpression') {\n+          rhs.properties.forEach((property) => {\n+            if (property.value.type === 'Identifier') {\n+              exported.identifiers.push(property.value.name);\n+              if (/^[A-Z]/.test(property.value.name[0])) {\n+                exported.constructors.push(property.value.name);\n+              }\n+            }\n+          });\n+        } else if (rhs.type === 'Identifier') {\n+          exported.identifiers.push(rhs.name);\n+        }\n       }\n     } else if (statement.type === 'VariableDeclaration') {\n       for (const decl of statement.declarations) {\n         let init = decl.init;\n         while (init && init.type === 'AssignmentExpression') init = init.left;\n         if (!init || init.type !== 'MemberExpression') continue;\n-        if (init.object.name !== 'module') continue;\n-        if (init.property.name !== 'exports') continue;\n-        exported.constructors.push(decl.id.name);\n-        definition[decl.id.name] = `${link}#L${statement.loc.start.line}`;\n+        if (init.object.name === 'exports') {\n+          definition[`${basename}.${init.property.name}`] =\n+            `${link}#L${statement.loc.start.line}`;\n+        } else if (init.object.name === 'module') {\n+          if (init.property.name !== 'exports') continue;\n+          exported.constructors.push(decl.id.name);\n+          definition[decl.id.name] = `${link}#L${statement.loc.start.line}`;\n+        }\n       }\n     }\n   });\n@@ -107,10 +125,8 @@ process.argv.slice(2).forEach((file) => {\n   //   ClassName.foo = ...;\n   //   ClassName.prototype.foo = ...;\n   //   function Identifier(...) {...};\n-  //   class Foo {...}\n+  //   class Foo {...};\n   //\n-  const indirect = {};\n-\n   program.forEach((statement) => {\n     if (statement.type === 'ExpressionStatement') {\n       const expr = statement.expression;"
        }
    ],
    "stats": {
        "total": 85,
        "additions": 60,
        "deletions": 25
    }
}