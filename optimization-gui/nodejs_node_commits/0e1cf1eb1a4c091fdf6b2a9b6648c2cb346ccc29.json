{
    "author": "vsemozhetbyt",
    "message": "doc: fix section order in vm.md\n\nThis PR just places the `vm.SourceTextModule` class section\nafter the `vm.Script` class section, restoring the alphabetical order.\n\nPR-URL: https://github.com/nodejs/node/pull/25374\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "0e1cf1eb1a4c091fdf6b2a9b6648c2cb346ccc29",
    "files": [
        {
            "sha": "808ed2f00d97b24990cad452ce67b3e3bde7ae5d",
            "filename": "doc/api/vm.md",
            "status": "modified",
            "additions": 354,
            "deletions": 354,
            "changes": 708,
            "blob_url": "https://github.com/nodejs/node/blob/0e1cf1eb1a4c091fdf6b2a9b6648c2cb346ccc29/doc%2Fapi%2Fvm.md",
            "raw_url": "https://github.com/nodejs/node/raw/0e1cf1eb1a4c091fdf6b2a9b6648c2cb346ccc29/doc%2Fapi%2Fvm.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fvm.md?ref=0e1cf1eb1a4c091fdf6b2a9b6648c2cb346ccc29",
            "patch": "@@ -43,6 +43,264 @@ console.log(sandbox.y); // 17\n console.log(x); // 1; y is not defined.\n ```\n \n+## Class: vm.Script\n+<!-- YAML\n+added: v0.3.1\n+-->\n+\n+Instances of the `vm.Script` class contain precompiled scripts that can be\n+executed in specific sandboxes (or \"contexts\").\n+\n+### Constructor: new vm.Script(code[, options])\n+<!-- YAML\n+added: v0.3.1\n+changes:\n+  - version: v5.7.0\n+    pr-url: https://github.com/nodejs/node/pull/4777\n+    description: The `cachedData` and `produceCachedData` options are\n+                 supported now.\n+  - version: v10.6.0\n+    pr-url: https://github.com/nodejs/node/pull/20300\n+    description: The `produceCachedData` is deprecated in favour of\n+                 `script.createCachedData()`\n+-->\n+\n+* `code` {string} The JavaScript code to compile.\n+* `options` {Object|string}\n+  * `filename` {string} Specifies the filename used in stack traces produced\n+    by this script. **Default:** `'evalmachine.<anonymous>'`.\n+  * `lineOffset` {number} Specifies the line number offset that is displayed\n+    in stack traces produced by this script. **Default:** `0`.\n+  * `columnOffset` {number} Specifies the column number offset that is displayed\n+    in stack traces produced by this script. **Default:** `0`.\n+  * `cachedData` {Buffer|TypedArray|DataView} Provides an optional `Buffer` or\n+    `TypedArray`, or `DataView` with V8's code cache data for the supplied\n+     source. When supplied, the `cachedDataRejected` value will be set to\n+     either `true` or `false` depending on acceptance of the data by V8.\n+  * `produceCachedData` {boolean} When `true` and no `cachedData` is present, V8\n+    will attempt to produce code cache data for `code`. Upon success, a\n+    `Buffer` with V8's code cache data will be produced and stored in the\n+    `cachedData` property of the returned `vm.Script` instance.\n+    The `cachedDataProduced` value will be set to either `true` or `false`\n+    depending on whether code cache data is produced successfully.\n+    This option is **deprecated** in favor of `script.createCachedData()`.\n+    **Default:** `false`.\n+  * `importModuleDynamically` {Function} Called during evaluation of this module\n+    when `import()` is called. If this option is not specified, calls to\n+    `import()` will reject with [`ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING`][].\n+    This option is part of the experimental API for the `--experimental-modules`\n+    flag, and should not be considered stable.\n+     * `specifier` {string} specifier passed to `import()`\n+     * `module` {vm.SourceTextModule}\n+     * Returns: {Module Namespace Object|vm.SourceTextModule} Returning a\n+       `vm.SourceTextModule` is recommended in order to take advantage of error\n+       tracking, and to avoid issues with namespaces that contain `then`\n+       function exports.\n+\n+If `options` is a string, then it specifies the filename.\n+\n+Creating a new `vm.Script` object compiles `code` but does not run it. The\n+compiled `vm.Script` can be run later multiple times. The `code` is not bound to\n+any global object; rather, it is bound before each run, just for that run.\n+\n+### script.createCachedData()\n+<!-- YAML\n+added: v10.6.0\n+-->\n+\n+* Returns: {Buffer}\n+\n+Creates a code cache that can be used with the Script constructor's\n+`cachedData` option. Returns a Buffer. This method may be called at any\n+time and any number of times.\n+\n+```js\n+const script = new vm.Script(`\n+function add(a, b) {\n+  return a + b;\n+}\n+\n+const x = add(1, 2);\n+`);\n+\n+const cacheWithoutX = script.createCachedData();\n+\n+script.runInThisContext();\n+\n+const cacheWithX = script.createCachedData();\n+```\n+\n+### script.runInContext(contextifiedSandbox[, options])\n+<!-- YAML\n+added: v0.3.1\n+changes:\n+  - version: v6.3.0\n+    pr-url: https://github.com/nodejs/node/pull/6635\n+    description: The `breakOnSigint` option is supported now.\n+-->\n+\n+* `contextifiedSandbox` {Object} A [contextified][] object as returned by the\n+  `vm.createContext()` method.\n+* `options` {Object}\n+  * `displayErrors` {boolean} When `true`, if an [`Error`][] occurs\n+    while compiling the `code`, the line of code causing the error is attached\n+    to the stack trace. **Default:** `true`.\n+  * `timeout` {integer} Specifies the number of milliseconds to execute `code`\n+    before terminating execution. If execution is terminated, an [`Error`][]\n+    will be thrown. This value must be a strictly positive integer.\n+  * `breakOnSigint` {boolean} If `true`, the execution will be terminated when\n+    `SIGINT` (Ctrl+C) is received. Existing handlers for the\n+    event that have been attached via `process.on('SIGINT')` will be disabled\n+    during script execution, but will continue to work after that. If execution\n+    is terminated, an [`Error`][] will be thrown. **Default:** `false`.\n+* Returns: {any} the result of the very last statement executed in the script.\n+\n+Runs the compiled code contained by the `vm.Script` object within the given\n+`contextifiedSandbox` and returns the result. Running code does not have access\n+to local scope.\n+\n+The following example compiles code that increments a global variable, sets\n+the value of another global variable, then execute the code multiple times.\n+The globals are contained in the `sandbox` object.\n+\n+```js\n+const util = require('util');\n+const vm = require('vm');\n+\n+const sandbox = {\n+  animal: 'cat',\n+  count: 2\n+};\n+\n+const script = new vm.Script('count += 1; name = \"kitty\";');\n+\n+const context = vm.createContext(sandbox);\n+for (let i = 0; i < 10; ++i) {\n+  script.runInContext(context);\n+}\n+\n+console.log(util.inspect(sandbox));\n+\n+// { animal: 'cat', count: 12, name: 'kitty' }\n+```\n+\n+Using the `timeout` or `breakOnSigint` options will result in new event loops\n+and corresponding threads being started, which have a non-zero performance\n+overhead.\n+\n+### script.runInNewContext([sandbox[, options]])\n+<!-- YAML\n+added: v0.3.1\n+changes:\n+  - version: v10.0.0\n+    pr-url: https://github.com/nodejs/node/pull/19016\n+    description: The `contextCodeGeneration` option is supported now.\n+  - version: v6.3.0\n+    pr-url: https://github.com/nodejs/node/pull/6635\n+    description: The `breakOnSigint` option is supported now.\n+-->\n+\n+* `sandbox` {Object} An object that will be [contextified][]. If `undefined`, a\n+  new object will be created.\n+* `options` {Object}\n+  * `displayErrors` {boolean} When `true`, if an [`Error`][] occurs\n+    while compiling the `code`, the line of code causing the error is attached\n+    to the stack trace. **Default:** `true`.\n+  * `timeout` {integer} Specifies the number of milliseconds to execute `code`\n+    before terminating execution. If execution is terminated, an [`Error`][]\n+    will be thrown. This value must be a strictly positive integer.\n+  * `breakOnSigint` {boolean} If `true`, the execution will be terminated when\n+    `SIGINT` (Ctrl+C) is received. Existing handlers for the\n+    event that have been attached via `process.on('SIGINT')` will be disabled\n+    during script execution, but will continue to work after that. If execution\n+    is terminated, an [`Error`][] will be thrown. **Default:** `false`.\n+  * `contextName` {string} Human-readable name of the newly created context.\n+    **Default:** `'VM Context i'`, where `i` is an ascending numerical index of\n+    the created context.\n+  * `contextOrigin` {string} [Origin][origin] corresponding to the newly\n+    created context for display purposes. The origin should be formatted like a\n+    URL, but with only the scheme, host, and port (if necessary), like the\n+    value of the [`url.origin`][] property of a [`URL`][] object. Most notably,\n+    this string should omit the trailing slash, as that denotes a path.\n+    **Default:** `''`.\n+  * `contextCodeGeneration` {Object}\n+    * `strings` {boolean} If set to false any calls to `eval` or function\n+      constructors (`Function`, `GeneratorFunction`, etc) will throw an\n+      `EvalError`. **Default:** `true`.\n+    * `wasm` {boolean} If set to false any attempt to compile a WebAssembly\n+      module will throw a `WebAssembly.CompileError`. **Default:** `true`.\n+* Returns: {any} the result of the very last statement executed in the script.\n+\n+First contextifies the given `sandbox`, runs the compiled code contained by\n+the `vm.Script` object within the created sandbox, and returns the result.\n+Running code does not have access to local scope.\n+\n+The following example compiles code that sets a global variable, then executes\n+the code multiple times in different contexts. The globals are set on and\n+contained within each individual `sandbox`.\n+\n+```js\n+const util = require('util');\n+const vm = require('vm');\n+\n+const script = new vm.Script('globalVar = \"set\"');\n+\n+const sandboxes = [{}, {}, {}];\n+sandboxes.forEach((sandbox) => {\n+  script.runInNewContext(sandbox);\n+});\n+\n+console.log(util.inspect(sandboxes));\n+\n+// [{ globalVar: 'set' }, { globalVar: 'set' }, { globalVar: 'set' }]\n+```\n+\n+### script.runInThisContext([options])\n+<!-- YAML\n+added: v0.3.1\n+changes:\n+  - version: v6.3.0\n+    pr-url: https://github.com/nodejs/node/pull/6635\n+    description: The `breakOnSigint` option is supported now.\n+-->\n+\n+* `options` {Object}\n+  * `displayErrors` {boolean} When `true`, if an [`Error`][] occurs\n+    while compiling the `code`, the line of code causing the error is attached\n+    to the stack trace. **Default:** `true`.\n+  * `timeout` {integer} Specifies the number of milliseconds to execute `code`\n+    before terminating execution. If execution is terminated, an [`Error`][]\n+    will be thrown. This value must be a strictly positive integer.\n+  * `breakOnSigint` {boolean} If `true`, the execution will be terminated when\n+    `SIGINT` (Ctrl+C) is received. Existing handlers for the\n+    event that have been attached via `process.on('SIGINT')` will be disabled\n+    during script execution, but will continue to work after that. If execution\n+    is terminated, an [`Error`][] will be thrown. **Default:** `false`.\n+* Returns: {any} the result of the very last statement executed in the script.\n+\n+Runs the compiled code contained by the `vm.Script` within the context of the\n+current `global` object. Running code does not have access to local scope, but\n+*does* have access to the current `global` object.\n+\n+The following example compiles code that increments a `global` variable then\n+executes that code multiple times:\n+\n+```js\n+const vm = require('vm');\n+\n+global.globalVar = 0;\n+\n+const script = new vm.Script('globalVar += 1', { filename: 'myfile.vm' });\n+\n+for (let i = 0; i < 1000; ++i) {\n+  script.runInThisContext();\n+}\n+\n+console.log(globalVar);\n+\n+// 1000\n+```\n+\n ## Class: vm.SourceTextModule\n <!-- YAML\n added: v9.6.0\n@@ -268,398 +526,140 @@ evaluated, in which case it will do one of the following two things:\n   evaluation ended in an error (`module.status` is `'errored'`)\n \n This method cannot be called while the module is being evaluated\n-(`module.status` is `'evaluating'`) to prevent infinite recursion.\n-\n-Corresponds to the [Evaluate() concrete method][] field of [Source Text Module\n-Record][]s in the ECMAScript specification.\n-\n-### module.instantiate()\n-\n-Instantiate the module. This must be called after linking has completed\n-(`linkingStatus` is `'linked'`); otherwise it will throw an error. It may also\n-throw an exception if one of the dependencies does not provide an export the\n-parent module requires.\n-\n-However, if this function succeeded, further calls to this function after the\n-initial instantiation will be no-ops, to be consistent with the ECMAScript\n-specification.\n-\n-Unlike other methods operating on `Module`, this function completes\n-synchronously and returns nothing.\n-\n-Corresponds to the [Instantiate() concrete method][] field of [Source Text\n-Module Record][]s in the ECMAScript specification.\n-\n-### module.link(linker)\n-\n-* `linker` {Function}\n-  * `specifier` {string} The specifier of the requested module:\n-    <!-- eslint-skip -->\n-    ```js\n-    import foo from 'foo';\n-    //              ^^^^^ the module specifier\n-    ```\n-  * `referencingModule` {vm.SourceTextModule} The `Module` object `link()` is\n-    called on.\n-  * Returns: {vm.SourceTextModule|Promise}\n-* Returns: {Promise}\n-\n-Link module dependencies. This method must be called before instantiation, and\n-can only be called once per module.\n-\n-The function is expected to return a `Module` object or a `Promise` that\n-eventually resolves to a `Module` object. The returned `Module` must satisfy the\n-following two invariants:\n-\n-- It must belong to the same context as the parent `Module`.\n-- Its `linkingStatus` must not be `'errored'`.\n-\n-If the returned `Module`'s `linkingStatus` is `'unlinked'`, this method will be\n-recursively called on the returned `Module` with the same provided `linker`\n-function.\n-\n-`link()` returns a `Promise` that will either get resolved when all linking\n-instances resolve to a valid `Module`, or rejected if the linker function either\n-throws an exception or returns an invalid `Module`.\n-\n-The linker function roughly corresponds to the implementation-defined\n-[HostResolveImportedModule][] abstract operation in the ECMAScript\n-specification, with a few key differences:\n-\n-- The linker function is allowed to be asynchronous while\n-  [HostResolveImportedModule][] is synchronous.\n-- The linker function is executed during linking, a Node.js-specific stage\n-  before instantiation, while [HostResolveImportedModule][] is called during\n-  instantiation.\n-\n-The actual [HostResolveImportedModule][] implementation used during module\n-instantiation is one that returns the modules linked during linking. Since at\n-that point all modules would have been fully linked already, the\n-[HostResolveImportedModule][] implementation is fully synchronous per\n-specification.\n-\n-### module.linkingStatus\n-\n-* {string}\n-\n-The current linking status of `module`. It will be one of the following values:\n-\n-- `'unlinked'`: `module.link()` has not yet been called.\n-- `'linking'`: `module.link()` has been called, but not all Promises returned by\n-  the linker function have been resolved yet.\n-- `'linked'`: `module.link()` has been called, and all its dependencies have\n-  been successfully linked.\n-- `'errored'`: `module.link()` has been called, but at least one of its\n-  dependencies failed to link, either because the callback returned a `Promise`\n-  that is rejected, or because the `Module` the callback returned is invalid.\n-\n-### module.namespace\n-\n-* {Object}\n-\n-The namespace object of the module. This is only available after instantiation\n-(`module.instantiate()`) has completed.\n-\n-Corresponds to the [GetModuleNamespace][] abstract operation in the ECMAScript\n-specification.\n-\n-### module.status\n-\n-* {string}\n-\n-The current status of the module. Will be one of:\n-\n-- `'uninstantiated'`: The module is not instantiated. It may because of any of\n-  the following reasons:\n-\n-  - The module was just created.\n-  - `module.instantiate()` has been called on this module, but it failed for\n-    some reason.\n-\n-  This status does not convey any information regarding if `module.link()` has\n-  been called. See `module.linkingStatus` for that.\n-\n-- `'instantiating'`: The module is currently being instantiated through a\n-  `module.instantiate()` call on itself or a parent module.\n-\n-- `'instantiated'`: The module has been instantiated successfully, but\n-  `module.evaluate()` has not yet been called.\n-\n-- `'evaluating'`: The module is being evaluated through a `module.evaluate()` on\n-  itself or a parent module.\n-\n-- `'evaluated'`: The module has been successfully evaluated.\n-\n-- `'errored'`: The module has been evaluated, but an exception was thrown.\n-\n-Other than `'errored'`, this status string corresponds to the specification's\n-[Source Text Module Record][]'s `[[Status]]` field. `'errored'` corresponds to\n-`'evaluated'` in the specification, but with `[[EvaluationError]]` set to a\n-value that is not `undefined`.\n-\n-### module.url\n-\n-* {string}\n-\n-The URL of the current module, as set in the constructor.\n-\n-## Class: vm.Script\n-<!-- YAML\n-added: v0.3.1\n--->\n-\n-Instances of the `vm.Script` class contain precompiled scripts that can be\n-executed in specific sandboxes (or \"contexts\").\n-\n-### Constructor: new vm.Script(code[, options])\n-<!-- YAML\n-added: v0.3.1\n-changes:\n-  - version: v5.7.0\n-    pr-url: https://github.com/nodejs/node/pull/4777\n-    description: The `cachedData` and `produceCachedData` options are\n-                 supported now.\n-  - version: v10.6.0\n-    pr-url: https://github.com/nodejs/node/pull/20300\n-    description: The `produceCachedData` is deprecated in favour of\n-                 `script.createCachedData()`\n--->\n-\n-* `code` {string} The JavaScript code to compile.\n-* `options` {Object|string}\n-  * `filename` {string} Specifies the filename used in stack traces produced\n-    by this script. **Default:** `'evalmachine.<anonymous>'`.\n-  * `lineOffset` {number} Specifies the line number offset that is displayed\n-    in stack traces produced by this script. **Default:** `0`.\n-  * `columnOffset` {number} Specifies the column number offset that is displayed\n-    in stack traces produced by this script. **Default:** `0`.\n-  * `cachedData` {Buffer|TypedArray|DataView} Provides an optional `Buffer` or\n-    `TypedArray`, or `DataView` with V8's code cache data for the supplied\n-     source. When supplied, the `cachedDataRejected` value will be set to\n-     either `true` or `false` depending on acceptance of the data by V8.\n-  * `produceCachedData` {boolean} When `true` and no `cachedData` is present, V8\n-    will attempt to produce code cache data for `code`. Upon success, a\n-    `Buffer` with V8's code cache data will be produced and stored in the\n-    `cachedData` property of the returned `vm.Script` instance.\n-    The `cachedDataProduced` value will be set to either `true` or `false`\n-    depending on whether code cache data is produced successfully.\n-    This option is **deprecated** in favor of `script.createCachedData()`.\n-    **Default:** `false`.\n-  * `importModuleDynamically` {Function} Called during evaluation of this module\n-    when `import()` is called. If this option is not specified, calls to\n-    `import()` will reject with [`ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING`][].\n-    This option is part of the experimental API for the `--experimental-modules`\n-    flag, and should not be considered stable.\n-     * `specifier` {string} specifier passed to `import()`\n-     * `module` {vm.SourceTextModule}\n-     * Returns: {Module Namespace Object|vm.SourceTextModule} Returning a\n-       `vm.SourceTextModule` is recommended in order to take advantage of error\n-       tracking, and to avoid issues with namespaces that contain `then`\n-       function exports.\n-\n-If `options` is a string, then it specifies the filename.\n-\n-Creating a new `vm.Script` object compiles `code` but does not run it. The\n-compiled `vm.Script` can be run later multiple times. The `code` is not bound to\n-any global object; rather, it is bound before each run, just for that run.\n+(`module.status` is `'evaluating'`) to prevent infinite recursion.\n \n-### script.createCachedData()\n-<!-- YAML\n-added: v10.6.0\n--->\n+Corresponds to the [Evaluate() concrete method][] field of [Source Text Module\n+Record][]s in the ECMAScript specification.\n \n-* Returns: {Buffer}\n+### module.instantiate()\n \n-Creates a code cache that can be used with the Script constructor's\n-`cachedData` option. Returns a Buffer. This method may be called at any\n-time and any number of times.\n+Instantiate the module. This must be called after linking has completed\n+(`linkingStatus` is `'linked'`); otherwise it will throw an error. It may also\n+throw an exception if one of the dependencies does not provide an export the\n+parent module requires.\n \n-```js\n-const script = new vm.Script(`\n-function add(a, b) {\n-  return a + b;\n-}\n+However, if this function succeeded, further calls to this function after the\n+initial instantiation will be no-ops, to be consistent with the ECMAScript\n+specification.\n \n-const x = add(1, 2);\n-`);\n+Unlike other methods operating on `Module`, this function completes\n+synchronously and returns nothing.\n \n-const cacheWithoutX = script.createCachedData();\n+Corresponds to the [Instantiate() concrete method][] field of [Source Text\n+Module Record][]s in the ECMAScript specification.\n \n-script.runInThisContext();\n+### module.link(linker)\n \n-const cacheWithX = script.createCachedData();\n-```\n+* `linker` {Function}\n+  * `specifier` {string} The specifier of the requested module:\n+    <!-- eslint-skip -->\n+    ```js\n+    import foo from 'foo';\n+    //              ^^^^^ the module specifier\n+    ```\n+  * `referencingModule` {vm.SourceTextModule} The `Module` object `link()` is\n+    called on.\n+  * Returns: {vm.SourceTextModule|Promise}\n+* Returns: {Promise}\n \n-### script.runInContext(contextifiedSandbox[, options])\n-<!-- YAML\n-added: v0.3.1\n-changes:\n-  - version: v6.3.0\n-    pr-url: https://github.com/nodejs/node/pull/6635\n-    description: The `breakOnSigint` option is supported now.\n--->\n+Link module dependencies. This method must be called before instantiation, and\n+can only be called once per module.\n \n-* `contextifiedSandbox` {Object} A [contextified][] object as returned by the\n-  `vm.createContext()` method.\n-* `options` {Object}\n-  * `displayErrors` {boolean} When `true`, if an [`Error`][] occurs\n-    while compiling the `code`, the line of code causing the error is attached\n-    to the stack trace. **Default:** `true`.\n-  * `timeout` {integer} Specifies the number of milliseconds to execute `code`\n-    before terminating execution. If execution is terminated, an [`Error`][]\n-    will be thrown. This value must be a strictly positive integer.\n-  * `breakOnSigint` {boolean} If `true`, the execution will be terminated when\n-    `SIGINT` (Ctrl+C) is received. Existing handlers for the\n-    event that have been attached via `process.on('SIGINT')` will be disabled\n-    during script execution, but will continue to work after that. If execution\n-    is terminated, an [`Error`][] will be thrown. **Default:** `false`.\n-* Returns: {any} the result of the very last statement executed in the script.\n+The function is expected to return a `Module` object or a `Promise` that\n+eventually resolves to a `Module` object. The returned `Module` must satisfy the\n+following two invariants:\n \n-Runs the compiled code contained by the `vm.Script` object within the given\n-`contextifiedSandbox` and returns the result. Running code does not have access\n-to local scope.\n+- It must belong to the same context as the parent `Module`.\n+- Its `linkingStatus` must not be `'errored'`.\n \n-The following example compiles code that increments a global variable, sets\n-the value of another global variable, then execute the code multiple times.\n-The globals are contained in the `sandbox` object.\n+If the returned `Module`'s `linkingStatus` is `'unlinked'`, this method will be\n+recursively called on the returned `Module` with the same provided `linker`\n+function.\n \n-```js\n-const util = require('util');\n-const vm = require('vm');\n+`link()` returns a `Promise` that will either get resolved when all linking\n+instances resolve to a valid `Module`, or rejected if the linker function either\n+throws an exception or returns an invalid `Module`.\n \n-const sandbox = {\n-  animal: 'cat',\n-  count: 2\n-};\n+The linker function roughly corresponds to the implementation-defined\n+[HostResolveImportedModule][] abstract operation in the ECMAScript\n+specification, with a few key differences:\n \n-const script = new vm.Script('count += 1; name = \"kitty\";');\n+- The linker function is allowed to be asynchronous while\n+  [HostResolveImportedModule][] is synchronous.\n+- The linker function is executed during linking, a Node.js-specific stage\n+  before instantiation, while [HostResolveImportedModule][] is called during\n+  instantiation.\n \n-const context = vm.createContext(sandbox);\n-for (let i = 0; i < 10; ++i) {\n-  script.runInContext(context);\n-}\n+The actual [HostResolveImportedModule][] implementation used during module\n+instantiation is one that returns the modules linked during linking. Since at\n+that point all modules would have been fully linked already, the\n+[HostResolveImportedModule][] implementation is fully synchronous per\n+specification.\n \n-console.log(util.inspect(sandbox));\n+### module.linkingStatus\n \n-// { animal: 'cat', count: 12, name: 'kitty' }\n-```\n+* {string}\n \n-Using the `timeout` or `breakOnSigint` options will result in new event loops\n-and corresponding threads being started, which have a non-zero performance\n-overhead.\n+The current linking status of `module`. It will be one of the following values:\n \n-### script.runInNewContext([sandbox[, options]])\n-<!-- YAML\n-added: v0.3.1\n-changes:\n-  - version: v10.0.0\n-    pr-url: https://github.com/nodejs/node/pull/19016\n-    description: The `contextCodeGeneration` option is supported now.\n-  - version: v6.3.0\n-    pr-url: https://github.com/nodejs/node/pull/6635\n-    description: The `breakOnSigint` option is supported now.\n--->\n+- `'unlinked'`: `module.link()` has not yet been called.\n+- `'linking'`: `module.link()` has been called, but not all Promises returned by\n+  the linker function have been resolved yet.\n+- `'linked'`: `module.link()` has been called, and all its dependencies have\n+  been successfully linked.\n+- `'errored'`: `module.link()` has been called, but at least one of its\n+  dependencies failed to link, either because the callback returned a `Promise`\n+  that is rejected, or because the `Module` the callback returned is invalid.\n \n-* `sandbox` {Object} An object that will be [contextified][]. If `undefined`, a\n-  new object will be created.\n-* `options` {Object}\n-  * `displayErrors` {boolean} When `true`, if an [`Error`][] occurs\n-    while compiling the `code`, the line of code causing the error is attached\n-    to the stack trace. **Default:** `true`.\n-  * `timeout` {integer} Specifies the number of milliseconds to execute `code`\n-    before terminating execution. If execution is terminated, an [`Error`][]\n-    will be thrown. This value must be a strictly positive integer.\n-  * `breakOnSigint` {boolean} If `true`, the execution will be terminated when\n-    `SIGINT` (Ctrl+C) is received. Existing handlers for the\n-    event that have been attached via `process.on('SIGINT')` will be disabled\n-    during script execution, but will continue to work after that. If execution\n-    is terminated, an [`Error`][] will be thrown. **Default:** `false`.\n-  * `contextName` {string} Human-readable name of the newly created context.\n-    **Default:** `'VM Context i'`, where `i` is an ascending numerical index of\n-    the created context.\n-  * `contextOrigin` {string} [Origin][origin] corresponding to the newly\n-    created context for display purposes. The origin should be formatted like a\n-    URL, but with only the scheme, host, and port (if necessary), like the\n-    value of the [`url.origin`][] property of a [`URL`][] object. Most notably,\n-    this string should omit the trailing slash, as that denotes a path.\n-    **Default:** `''`.\n-  * `contextCodeGeneration` {Object}\n-    * `strings` {boolean} If set to false any calls to `eval` or function\n-      constructors (`Function`, `GeneratorFunction`, etc) will throw an\n-      `EvalError`. **Default:** `true`.\n-    * `wasm` {boolean} If set to false any attempt to compile a WebAssembly\n-      module will throw a `WebAssembly.CompileError`. **Default:** `true`.\n-* Returns: {any} the result of the very last statement executed in the script.\n+### module.namespace\n \n-First contextifies the given `sandbox`, runs the compiled code contained by\n-the `vm.Script` object within the created sandbox, and returns the result.\n-Running code does not have access to local scope.\n+* {Object}\n \n-The following example compiles code that sets a global variable, then executes\n-the code multiple times in different contexts. The globals are set on and\n-contained within each individual `sandbox`.\n+The namespace object of the module. This is only available after instantiation\n+(`module.instantiate()`) has completed.\n \n-```js\n-const util = require('util');\n-const vm = require('vm');\n+Corresponds to the [GetModuleNamespace][] abstract operation in the ECMAScript\n+specification.\n \n-const script = new vm.Script('globalVar = \"set\"');\n+### module.status\n \n-const sandboxes = [{}, {}, {}];\n-sandboxes.forEach((sandbox) => {\n-  script.runInNewContext(sandbox);\n-});\n+* {string}\n \n-console.log(util.inspect(sandboxes));\n+The current status of the module. Will be one of:\n \n-// [{ globalVar: 'set' }, { globalVar: 'set' }, { globalVar: 'set' }]\n-```\n+- `'uninstantiated'`: The module is not instantiated. It may because of any of\n+  the following reasons:\n \n-### script.runInThisContext([options])\n-<!-- YAML\n-added: v0.3.1\n-changes:\n-  - version: v6.3.0\n-    pr-url: https://github.com/nodejs/node/pull/6635\n-    description: The `breakOnSigint` option is supported now.\n--->\n+  - The module was just created.\n+  - `module.instantiate()` has been called on this module, but it failed for\n+    some reason.\n \n-* `options` {Object}\n-  * `displayErrors` {boolean} When `true`, if an [`Error`][] occurs\n-    while compiling the `code`, the line of code causing the error is attached\n-    to the stack trace. **Default:** `true`.\n-  * `timeout` {integer} Specifies the number of milliseconds to execute `code`\n-    before terminating execution. If execution is terminated, an [`Error`][]\n-    will be thrown. This value must be a strictly positive integer.\n-  * `breakOnSigint` {boolean} If `true`, the execution will be terminated when\n-    `SIGINT` (Ctrl+C) is received. Existing handlers for the\n-    event that have been attached via `process.on('SIGINT')` will be disabled\n-    during script execution, but will continue to work after that. If execution\n-    is terminated, an [`Error`][] will be thrown. **Default:** `false`.\n-* Returns: {any} the result of the very last statement executed in the script.\n+  This status does not convey any information regarding if `module.link()` has\n+  been called. See `module.linkingStatus` for that.\n \n-Runs the compiled code contained by the `vm.Script` within the context of the\n-current `global` object. Running code does not have access to local scope, but\n-*does* have access to the current `global` object.\n+- `'instantiating'`: The module is currently being instantiated through a\n+  `module.instantiate()` call on itself or a parent module.\n \n-The following example compiles code that increments a `global` variable then\n-executes that code multiple times:\n+- `'instantiated'`: The module has been instantiated successfully, but\n+  `module.evaluate()` has not yet been called.\n \n-```js\n-const vm = require('vm');\n+- `'evaluating'`: The module is being evaluated through a `module.evaluate()` on\n+  itself or a parent module.\n \n-global.globalVar = 0;\n+- `'evaluated'`: The module has been successfully evaluated.\n \n-const script = new vm.Script('globalVar += 1', { filename: 'myfile.vm' });\n+- `'errored'`: The module has been evaluated, but an exception was thrown.\n \n-for (let i = 0; i < 1000; ++i) {\n-  script.runInThisContext();\n-}\n+Other than `'errored'`, this status string corresponds to the specification's\n+[Source Text Module Record][]'s `[[Status]]` field. `'errored'` corresponds to\n+`'evaluated'` in the specification, but with `[[EvaluationError]]` set to a\n+value that is not `undefined`.\n \n-console.log(globalVar);\n+### module.url\n \n-// 1000\n-```\n+* {string}\n+\n+The URL of the current module, as set in the constructor.\n \n ## vm.compileFunction(code[, params[, options]])\n <!-- YAML"
        }
    ],
    "stats": {
        "total": 708,
        "additions": 354,
        "deletions": 354
    }
}