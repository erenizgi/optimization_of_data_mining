{
    "author": "rubys",
    "message": "repl: make own properties shadow prototype properties\n\nPreviously, the code displayed properties backwards (e.g., showing\nprototype properties before own properties).  It also did uniqueness\nchecks during this processing, so these checks were done backwards.\n\nAfter this change, the properties continue to be displayed backwards,\nbut the uniqueness checks are done in the proper order.\n\nSee also: https://github.com/nodejs/node/issues/21586 which was\ndiscovered during the testing of this fix.\n\nFixes: https://github.com/nodejs/node/issues/15199\nPR-URL: https://github.com/nodejs/node/pull/21588\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>",
    "sha": "4d42083d1a2a5632589e79aa3b780a7d7c93a2e1",
    "files": [
        {
            "sha": "92c90de7bb16462d3536288e51339382c75aa7db",
            "filename": "lib/repl.js",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/4d42083d1a2a5632589e79aa3b780a7d7c93a2e1/lib%2Frepl.js",
            "raw_url": "https://github.com/nodejs/node/raw/4d42083d1a2a5632589e79aa3b780a7d7c93a2e1/lib%2Frepl.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Frepl.js?ref=4d42083d1a2a5632589e79aa3b780a7d7c93a2e1",
            "patch": "@@ -1229,20 +1229,20 @@ function complete(line, callback) {\n       // Completion group 0 is the \"closest\"\n       // (least far up the inheritance chain)\n       // so we put its completions last: to be closest in the REPL.\n-      for (i = completionGroups.length - 1; i >= 0; i--) {\n+      for (i = 0; i < completionGroups.length; i++) {\n         group = completionGroups[i];\n         group.sort();\n-        for (var j = 0; j < group.length; j++) {\n+        for (var j = group.length - 1; j >= 0; j--) {\n           c = group[j];\n           if (!hasOwnProperty(uniq, c)) {\n-            completions.push(c);\n+            completions.unshift(c);\n             uniq[c] = true;\n           }\n         }\n-        completions.push(''); // Separator btwn groups\n+        completions.unshift(''); // Separator btwn groups\n       }\n-      while (completions.length && completions[completions.length - 1] === '') {\n-        completions.pop();\n+      while (completions.length && completions[0] === '') {\n+        completions.shift();\n       }\n     }\n "
        },
        {
            "sha": "9d6ecf4e2848110df4775e9537a11a4ac6f25363",
            "filename": "test/parallel/test-repl-tab-complete.js",
            "status": "modified",
            "additions": 18,
            "deletions": 1,
            "changes": 19,
            "blob_url": "https://github.com/nodejs/node/blob/4d42083d1a2a5632589e79aa3b780a7d7c93a2e1/test%2Fparallel%2Ftest-repl-tab-complete.js",
            "raw_url": "https://github.com/nodejs/node/raw/4d42083d1a2a5632589e79aa3b780a7d7c93a2e1/test%2Fparallel%2Ftest-repl-tab-complete.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-repl-tab-complete.js?ref=4d42083d1a2a5632589e79aa3b780a7d7c93a2e1",
            "patch": "@@ -149,7 +149,10 @@ putIn.run([\n   ' one:1',\n   '};'\n ]);\n-testMe.complete('inner.o', getNoResultsFunction());\n+// See: https://github.com/nodejs/node/issues/21586\n+// testMe.complete('inner.o', getNoResultsFunction());\n+testMe.complete('inner.o', common.mustCall(function(error, data) {\n+}));\n \n putIn.run(['.clear']);\n \n@@ -206,6 +209,20 @@ testMe.complete('toSt', common.mustCall(function(error, data) {\n   assert.deepStrictEqual(data, [['toString'], 'toSt']);\n }));\n \n+// own properties should shadow properties on the prototype\n+putIn.run(['.clear']);\n+putIn.run([\n+  'var x = Object.create(null);',\n+  'x.a = 1;',\n+  'x.b = 2;',\n+  'var y = Object.create(x);',\n+  'y.a = 3;',\n+  'y.c = 4;'\n+]);\n+testMe.complete('y.', common.mustCall(function(error, data) {\n+  assert.deepStrictEqual(data, [['y.b', '', 'y.a', 'y.c'], 'y.']);\n+}));\n+\n // Tab complete provides built in libs for require()\n putIn.run(['.clear']);\n "
        }
    ],
    "stats": {
        "total": 31,
        "additions": 24,
        "deletions": 7
    }
}