{
    "author": "joyeecheung",
    "message": "src: migrate ERR_INDEX_OUT_OF_RANGE in C++\n\nThis patch migrates the \"Index out of range\" errors in C++\nto errors with the code `ERR_INDEX_OUT_OF_RANGE` which have\nequivalents in JavaScript.\n\nPR-URL: https://github.com/nodejs/node/pull/20121\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Jeremiah Senkpiel <fishrock123@rocketmail.com>",
    "sha": "7e269f52667104c94dcf65e527b04c2632d701bb",
    "files": [
        {
            "sha": "2e968697176ead0324ab9261e1af49c2ee8ca367",
            "filename": "src/node_buffer.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 4,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/7e269f52667104c94dcf65e527b04c2632d701bb/src%2Fnode_buffer.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7e269f52667104c94dcf65e527b04c2632d701bb/src%2Fnode_buffer.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_buffer.cc?ref=7e269f52667104c94dcf65e527b04c2632d701bb",
            "patch": "@@ -21,6 +21,7 @@\n \n #include \"node.h\"\n #include \"node_buffer.h\"\n+#include \"node_errors.h\"\n \n #include \"env-inl.h\"\n #include \"string_bytes.h\"\n@@ -38,7 +39,7 @@\n \n #define THROW_AND_RETURN_IF_OOB(r)                                          \\\n   do {                                                                      \\\n-    if (!(r)) return env->ThrowRangeError(\"Index out of range\");            \\\n+    if (!(r)) return node::THROW_ERR_INDEX_OUT_OF_RANGE(env);               \\\n   } while (0)\n \n #define SLICE_START_END(start_arg, end_arg, end_max)                        \\\n@@ -544,7 +545,7 @@ void Copy(const FunctionCallbackInfo<Value> &args) {\n     return args.GetReturnValue().Set(0);\n \n   if (source_start > ts_obj_length)\n-    return env->ThrowRangeError(\"Index out of range\");\n+    return node::THROW_ERR_INDEX_OUT_OF_RANGE(env);\n \n   if (source_end - source_start > target_length - target_start)\n     source_end = source_start + target_length - target_start;\n@@ -728,9 +729,9 @@ void CompareOffset(const FunctionCallbackInfo<Value> &args) {\n   THROW_AND_RETURN_IF_OOB(ParseArrayIndex(args[5], ts_obj_length, &source_end));\n \n   if (source_start > ts_obj_length)\n-    return env->ThrowRangeError(\"Index out of range\");\n+    return node::THROW_ERR_INDEX_OUT_OF_RANGE(env);\n   if (target_start > target_length)\n-    return env->ThrowRangeError(\"Index out of range\");\n+    return node::THROW_ERR_INDEX_OUT_OF_RANGE(env);\n \n   CHECK_LE(source_start, source_end);\n   CHECK_LE(target_start, target_end);"
        },
        {
            "sha": "584a62ece189ef44f534bbedbde1b46b59694d8b",
            "filename": "src/node_errors.h",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/7e269f52667104c94dcf65e527b04c2632d701bb/src%2Fnode_errors.h",
            "raw_url": "https://github.com/nodejs/node/raw/7e269f52667104c94dcf65e527b04c2632d701bb/src%2Fnode_errors.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_errors.h?ref=7e269f52667104c94dcf65e527b04c2632d701bb",
            "patch": "@@ -17,8 +17,9 @@ namespace node {\n // a `Local<Value>` containing the TypeError with proper code and message\n \n #define ERRORS_WITH_CODE(V)                                                  \\\n+  V(ERR_INDEX_OUT_OF_RANGE, RangeError)                                      \\\n   V(ERR_MEMORY_ALLOCATION_FAILED, Error)                                     \\\n-  V(ERR_STRING_TOO_LONG, Error)                                             \\\n+  V(ERR_STRING_TOO_LONG, Error)                                              \\\n   V(ERR_BUFFER_TOO_LARGE, Error)\n \n #define V(code, type)                                                         \\\n@@ -42,6 +43,7 @@ namespace node {\n // Errors with predefined static messages\n \n #define PREDEFINED_ERROR_MESSAGES(V)                                         \\\n+  V(ERR_INDEX_OUT_OF_RANGE, \"Index out of range\")                            \\\n   V(ERR_MEMORY_ALLOCATION_FAILED, \"Failed to allocate memory\")\n \n #define V(code, message)                                                     \\"
        },
        {
            "sha": "b06ca2a68cffb050de1dc328189142c95fd290fc",
            "filename": "test/parallel/test-buffer-alloc.js",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/7e269f52667104c94dcf65e527b04c2632d701bb/test%2Fparallel%2Ftest-buffer-alloc.js",
            "raw_url": "https://github.com/nodejs/node/raw/7e269f52667104c94dcf65e527b04c2632d701bb/test%2Fparallel%2Ftest-buffer-alloc.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-buffer-alloc.js?ref=7e269f52667104c94dcf65e527b04c2632d701bb",
            "patch": "@@ -982,7 +982,11 @@ common.expectsError(() => {\n   const a = Buffer.alloc(1);\n   const b = Buffer.alloc(1);\n   a.copy(b, 0, 0x100000000, 0x100000001);\n-}, { code: undefined, type: RangeError, message: 'Index out of range' });\n+}, {\n+  code: 'ERR_INDEX_OUT_OF_RANGE',\n+  type: RangeError,\n+  message: 'Index out of range'\n+});\n \n // Unpooled buffer (replaces SlowBuffer)\n {"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 13,
        "deletions": 6
    }
}