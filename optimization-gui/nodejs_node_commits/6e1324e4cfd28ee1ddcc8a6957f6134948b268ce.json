{
    "author": "Trott",
    "message": "test: isolate unusual assert test in its own file\n\ntest-assert.js contains a test that writes to the source tree, requires\nan internal module, and depends on modules not needed by the plethora of\nother test cases in the file. Move it to its own file so that there are\nnot side effects in test-assert.js and so that it can be refactored to\nnot write to the source tree.\n\nPR-URL: https://github.com/nodejs/node/pull/20861\nReviewed-By: Sakthipriyan Vairamani <thechargingvolcano@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "6e1324e4cfd28ee1ddcc8a6957f6134948b268ce",
    "files": [
        {
            "sha": "154dc3b33ef87ae30b91433d7a406f977fb00653",
            "filename": "test/parallel/test-assert-builtins-not-read-from-filesystem.js",
            "status": "added",
            "additions": 44,
            "deletions": 0,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/6e1324e4cfd28ee1ddcc8a6957f6134948b268ce/test%2Fparallel%2Ftest-assert-builtins-not-read-from-filesystem.js",
            "raw_url": "https://github.com/nodejs/node/raw/6e1324e4cfd28ee1ddcc8a6957f6134948b268ce/test%2Fparallel%2Ftest-assert-builtins-not-read-from-filesystem.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-assert-builtins-not-read-from-filesystem.js?ref=6e1324e4cfd28ee1ddcc8a6957f6134948b268ce",
            "patch": "@@ -0,0 +1,44 @@\n+// Flags: --expose-internals\n+\n+'use strict';\n+\n+require('../common');\n+\n+const assert = require('assert');\n+const EventEmitter = require('events');\n+const { errorCache } = require('internal/assert');\n+const { writeFileSync, unlinkSync } = require('fs');\n+\n+// Do not read filesystem for error messages in builtin modules.\n+{\n+  const e = new EventEmitter();\n+\n+  e.on('hello', assert);\n+\n+  let threw = false;\n+  try {\n+    e.emit('hello', false);\n+  } catch (err) {\n+    const frames = err.stack.split('\\n');\n+    const [, filename, line, column] = frames[1].match(/\\((.+):(\\d+):(\\d+)\\)/);\n+    // Reset the cache to check again\n+    const size = errorCache.size;\n+    errorCache.delete(`${filename}${line - 1}${column - 1}`);\n+    assert.strictEqual(errorCache.size, size - 1);\n+    const data = `${'\\n'.repeat(line - 1)}${' '.repeat(column - 1)}` +\n+                 'ok(failed(badly));';\n+    try {\n+      writeFileSync(filename, data);\n+      assert.throws(\n+        () => e.emit('hello', false),\n+        {\n+          message: 'false == true'\n+        }\n+      );\n+      threw = true;\n+    } finally {\n+      unlinkSync(filename);\n+    }\n+  }\n+  assert(threw);\n+}"
        },
        {
            "sha": "12ae82475726a0008abb8ce44b0359fb487986e8",
            "filename": "test/parallel/test-assert.js",
            "status": "modified",
            "additions": 0,
            "deletions": 39,
            "changes": 39,
            "blob_url": "https://github.com/nodejs/node/blob/6e1324e4cfd28ee1ddcc8a6957f6134948b268ce/test%2Fparallel%2Ftest-assert.js",
            "raw_url": "https://github.com/nodejs/node/raw/6e1324e4cfd28ee1ddcc8a6957f6134948b268ce/test%2Fparallel%2Ftest-assert.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-assert.js?ref=6e1324e4cfd28ee1ddcc8a6957f6134948b268ce",
            "patch": "@@ -19,17 +19,12 @@\n // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n // USE OR OTHER DEALINGS IN THE SOFTWARE.\n \n-// Flags: --expose-internals\n-\n 'use strict';\n \n /* eslint-disable node-core/prefer-common-expectserror */\n \n const common = require('../common');\n const assert = require('assert');\n-const EventEmitter = require('events');\n-const { errorCache } = require('internal/assert');\n-const { writeFileSync, unlinkSync } = require('fs');\n const { inspect } = require('util');\n const a = assert;\n \n@@ -793,40 +788,6 @@ common.expectsError(\n   }\n );\n \n-// Do not try to check Node.js modules.\n-{\n-  const e = new EventEmitter();\n-\n-  e.on('hello', assert);\n-\n-  let threw = false;\n-  try {\n-    e.emit('hello', false);\n-  } catch (err) {\n-    const frames = err.stack.split('\\n');\n-    const [, filename, line, column] = frames[1].match(/\\((.+):(\\d+):(\\d+)\\)/);\n-    // Reset the cache to check again\n-    const size = errorCache.size;\n-    errorCache.delete(`${filename}${line - 1}${column - 1}`);\n-    assert.strictEqual(errorCache.size, size - 1);\n-    const data = `${'\\n'.repeat(line - 1)}${' '.repeat(column - 1)}` +\n-                 'ok(failed(badly));';\n-    try {\n-      writeFileSync(filename, data);\n-      assert.throws(\n-        () => e.emit('hello', false),\n-        {\n-          message: 'false == true'\n-        }\n-      );\n-      threw = true;\n-    } finally {\n-      unlinkSync(filename);\n-    }\n-  }\n-  assert(threw);\n-}\n-\n common.expectsError(\n   // eslint-disable-next-line no-restricted-syntax\n   () => assert.throws(() => {}, 'Error message', 'message'),"
        }
    ],
    "stats": {
        "total": 83,
        "additions": 44,
        "deletions": 39
    }
}