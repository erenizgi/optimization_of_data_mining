{
    "author": "BridgeAR",
    "message": "util: update set iterator entries inspection\n\nThe inspection output for Set#entries() was wrong so far as it did\nnot return an array as it should have. That was a bug in V8 that is\nnow fixed and the code in Node.js has to be updated accordingly.\n\nPR-URL: https://github.com/nodejs/node/pull/25941\nFixes: https://github.com/nodejs/node/issues/24629\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>",
    "sha": "3d62d0c4804813ff36a051160a57fc4596804b8f",
    "files": [
        {
            "sha": "5246ed89b790bb23d0f9bace4ac78b884ffccfc8",
            "filename": "lib/internal/util/inspect.js",
            "status": "modified",
            "additions": 5,
            "deletions": 10,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/3d62d0c4804813ff36a051160a57fc4596804b8f/lib%2Finternal%2Futil%2Finspect.js",
            "raw_url": "https://github.com/nodejs/node/raw/3d62d0c4804813ff36a051160a57fc4596804b8f/lib%2Finternal%2Futil%2Finspect.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Futil%2Finspect.js?ref=3d62d0c4804813ff36a051160a57fc4596804b8f",
            "patch": "@@ -595,11 +595,11 @@ function formatRaw(ctx, value, recurseTimes, typedArray) {\n     } else if (isMapIterator(value)) {\n       keys = getKeys(value, ctx.showHidden);\n       braces = [`[${tag}] {`, '}'];\n-      formatter = formatMapIterator;\n+      formatter = formatIterator;\n     } else if (isSetIterator(value)) {\n       keys = getKeys(value, ctx.showHidden);\n       braces = [`[${tag}] {`, '}'];\n-      formatter = formatSetIterator;\n+      formatter = formatIterator;\n     } else {\n       noIterator = true;\n     }\n@@ -731,10 +731,10 @@ function formatRaw(ctx, value, recurseTimes, typedArray) {\n       }\n       if (isMapIterator(value)) {\n         braces = [`[${tag || 'Map Iterator'}] {`, '}'];\n-        formatter = formatMapIterator;\n+        formatter = formatIterator;\n       } else if (isSetIterator(value)) {\n         braces = [`[${tag || 'Set Iterator'}] {`, '}'];\n-        formatter = formatSetIterator;\n+        formatter = formatIterator;\n       // Handle other regular objects again.\n       } else if (keys.length === 0) {\n         if (isExternal(value))\n@@ -1091,12 +1091,7 @@ function formatWeakMap(ctx, value, recurseTimes) {\n   return formatMapIterInner(ctx, recurseTimes, entries, kWeak);\n }\n \n-function formatSetIterator(ctx, value, recurseTimes) {\n-  const entries = previewEntries(value);\n-  return formatSetIterInner(ctx, recurseTimes, entries, kIterator);\n-}\n-\n-function formatMapIterator(ctx, value, recurseTimes) {\n+function formatIterator(ctx, value, recurseTimes) {\n   const [entries, isKeyValue] = previewEntries(value, true);\n   if (isKeyValue) {\n     return formatMapIterInner(ctx, recurseTimes, entries, kMapEntries);"
        },
        {
            "sha": "f2c008c797d61b16c4060e97c56c73cbe01093b0",
            "filename": "src/node_util.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/3d62d0c4804813ff36a051160a57fc4596804b8f/src%2Fnode_util.cc",
            "raw_url": "https://github.com/nodejs/node/raw/3d62d0c4804813ff36a051160a57fc4596804b8f/src%2Fnode_util.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_util.cc?ref=3d62d0c4804813ff36a051160a57fc4596804b8f",
            "patch": "@@ -100,7 +100,7 @@ static void PreviewEntries(const FunctionCallbackInfo<Value>& args) {\n   Local<Array> entries;\n   if (!args[0].As<Object>()->PreviewEntries(&is_key_value).ToLocal(&entries))\n     return;\n-  // Fast path for WeakMap, WeakSet and Set iterators.\n+  // Fast path for WeakMap and WeakSet.\n   if (args.Length() == 1)\n     return args.GetReturnValue().Set(entries);\n "
        },
        {
            "sha": "a9afdbf8af049fad2b99683be3e01190f999179e",
            "filename": "test/parallel/test-util-inspect.js",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/3d62d0c4804813ff36a051160a57fc4596804b8f/test%2Fparallel%2Ftest-util-inspect.js",
            "raw_url": "https://github.com/nodejs/node/raw/3d62d0c4804813ff36a051160a57fc4596804b8f/test%2Fparallel%2Ftest-util-inspect.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-util-inspect.js?ref=3d62d0c4804813ff36a051160a57fc4596804b8f",
            "patch": "@@ -995,7 +995,8 @@ if (typeof Symbol !== 'undefined') {\n   const aSet = new Set([1, 3]);\n   assert.strictEqual(util.inspect(aSet.keys()), '[Set Iterator] { 1, 3 }');\n   assert.strictEqual(util.inspect(aSet.values()), '[Set Iterator] { 1, 3 }');\n-  assert.strictEqual(util.inspect(aSet.entries()), '[Set Iterator] { 1, 3 }');\n+  assert.strictEqual(util.inspect(aSet.entries()),\n+                     '[Set Iterator] { [ 1, 1 ], [ 3, 3 ] }');\n   // Make sure the iterator doesn't get consumed.\n   const keys = aSet.keys();\n   assert.strictEqual(util.inspect(keys), '[Set Iterator] { 1, 3 }');\n@@ -1609,7 +1610,7 @@ assert.strictEqual(util.inspect('\"\\'${a}'), \"'\\\"\\\\'${a}'\");\n   [{ a: 5 }, '{ a: 5 }'],\n   [new Set([1, 2]), 'Set { 1, 2 }'],\n   [new Map([[1, 2]]), 'Map { 1 => 2 }'],\n-  [new Set([1, 2]).entries(), '[Set Iterator] { 1, 2 }'],\n+  [new Set([1, 2]).entries(), '[Set Iterator] { [ 1, 1 ], [ 2, 2 ] }'],\n   [new Map([[1, 2]]).keys(), '[Map Iterator] { 1 }'],\n   [new Date(2000), '1970-01-01T00:00:02.000Z'],\n   [new Uint8Array(2), 'Uint8Array [ 0, 0 ]'],"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 9,
        "deletions": 13
    }
}