{
    "author": "BridgeAR",
    "message": "tty: add attribution for chalk\n\nThis adds attributions for the getColorDepth function as it got\ninspired by https://github.com/chalk/supports-color and more sources.\n\nPR-URL: https://github.com/nodejs/node/pull/19730\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "1b715221b9b875fc24d6aae3480c4c55d7f3dd76",
    "files": [
        {
            "sha": "a581ac312f532733eb88451abbfabd49ab18663b",
            "filename": "lib/internal/tty.js",
            "status": "added",
            "additions": 104,
            "deletions": 0,
            "changes": 104,
            "blob_url": "https://github.com/nodejs/node/blob/1b715221b9b875fc24d6aae3480c4c55d7f3dd76/lib%2Finternal%2Ftty.js",
            "raw_url": "https://github.com/nodejs/node/raw/1b715221b9b875fc24d6aae3480c4c55d7f3dd76/lib%2Finternal%2Ftty.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ftty.js?ref=1b715221b9b875fc24d6aae3480c4c55d7f3dd76",
            "patch": "@@ -0,0 +1,104 @@\n+// MIT License\n+\n+// Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (sindresorhus.com)\n+\n+// Permission is hereby granted, free of charge, to any person obtaining a copy\n+// of this software and associated documentation files (the \"Software\"), to deal\n+// in the Software without restriction, including without limitation the rights\n+// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+// copies of the Software, and to permit persons to whom the Software is\n+// furnished to do so, subject to the following conditions:\n+\n+// The above copyright notice and this permission notice shall be included in\n+// all copies or substantial portions of the Software.\n+\n+// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+// SOFTWARE.\n+\n+'use strict';\n+\n+const { release } = require('os');\n+\n+const OSRelease = release().split('.');\n+\n+const COLORS_2 = 1;\n+const COLORS_16 = 4;\n+const COLORS_256 = 8;\n+const COLORS_16m = 24;\n+\n+// The `getColorDepth` API got inspired by multiple sources such as\n+// https://github.com/chalk/supports-color,\n+// https://github.com/isaacs/color-support.\n+function getColorDepth(env = process.env) {\n+  if (env.NODE_DISABLE_COLORS || env.TERM === 'dumb' && !env.COLORTERM) {\n+    return COLORS_2;\n+  }\n+\n+  if (process.platform === 'win32') {\n+    // Windows 10 build 10586 is the first Windows release that supports 256\n+    // colors. Windows 10 build 14931 is the first release that supports\n+    // 16m/TrueColor.\n+    if (+OSRelease[0] >= 10) {\n+      const build = +OSRelease[2];\n+      if (build >= 14931)\n+        return COLORS_16m;\n+      if (build >= 10586)\n+        return COLORS_256;\n+    }\n+\n+    return COLORS_16;\n+  }\n+\n+  if (env.TMUX) {\n+    return COLORS_256;\n+  }\n+\n+  if (env.CI) {\n+    if ('TRAVIS' in env || 'CIRCLECI' in env || 'APPVEYOR' in env ||\n+      'GITLAB_CI' in env || env.CI_NAME === 'codeship') {\n+      return COLORS_256;\n+    }\n+    return COLORS_2;\n+  }\n+\n+  if ('TEAMCITY_VERSION' in env) {\n+    return /^(9\\.(0*[1-9]\\d*)\\.|\\d{2,}\\.)/.test(env.TEAMCITY_VERSION) ?\n+      COLORS_16 : COLORS_2;\n+  }\n+\n+  switch (env.TERM_PROGRAM) {\n+    case 'iTerm.app':\n+      if (!env.TERM_PROGRAM_VERSION ||\n+        /^[0-2]\\./.test(env.TERM_PROGRAM_VERSION)) {\n+        return COLORS_256;\n+      }\n+      return COLORS_16m;\n+    case 'HyperTerm':\n+    case 'Hyper':\n+    case 'MacTerm':\n+      return COLORS_16m;\n+    case 'Apple_Terminal':\n+      return COLORS_256;\n+  }\n+\n+  if (env.TERM) {\n+    if (/^xterm-256/.test(env.TERM))\n+      return COLORS_256;\n+    if (/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(env.TERM))\n+      return COLORS_16;\n+  }\n+\n+  if (env.COLORTERM)\n+    return COLORS_16;\n+\n+  return COLORS_2;\n+}\n+\n+module.exports = {\n+  getColorDepth\n+};"
        },
        {
            "sha": "dfb76bbe53da54c9933adc8e3ddcfba066202438",
            "filename": "lib/tty.js",
            "status": "modified",
            "additions": 2,
            "deletions": 72,
            "changes": 74,
            "blob_url": "https://github.com/nodejs/node/blob/1b715221b9b875fc24d6aae3480c4c55d7f3dd76/lib%2Ftty.js",
            "raw_url": "https://github.com/nodejs/node/raw/1b715221b9b875fc24d6aae3480c4c55d7f3dd76/lib%2Ftty.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ftty.js?ref=1b715221b9b875fc24d6aae3480c4c55d7f3dd76",
            "patch": "@@ -27,14 +27,7 @@ const { TTY, isTTY } = process.binding('tty_wrap');\n const errors = require('internal/errors');\n const { ERR_INVALID_FD } = errors.codes;\n const readline = require('readline');\n-const { release } = require('os');\n-\n-const OSRelease = release().split('.');\n-\n-const COLORS_2 = 1;\n-const COLORS_16 = 4;\n-const COLORS_256 = 8;\n-const COLORS_16m = 24;\n+const { getColorDepth } = require('internal/tty');\n \n function isatty(fd) {\n   return Number.isInteger(fd) && fd >= 0 && isTTY(fd);\n@@ -108,70 +101,7 @@ inherits(WriteStream, net.Socket);\n \n WriteStream.prototype.isTTY = true;\n \n-WriteStream.prototype.getColorDepth = function(env = process.env) {\n-  if (env.NODE_DISABLE_COLORS || env.TERM === 'dumb' && !env.COLORTERM) {\n-    return COLORS_2;\n-  }\n-\n-  if (process.platform === 'win32') {\n-    // Windows 10 build 10586 is the first Windows release that supports 256\n-    // colors. Windows 10 build 14931 is the first release that supports\n-    // 16m/TrueColor.\n-    if (+OSRelease[0] >= 10) {\n-      const build = +OSRelease[2];\n-      if (build >= 14931)\n-        return COLORS_16m;\n-      if (build >= 10586)\n-        return COLORS_256;\n-    }\n-\n-    return COLORS_16;\n-  }\n-\n-  if (env.TMUX) {\n-    return COLORS_256;\n-  }\n-\n-  if (env.CI) {\n-    if ('TRAVIS' in env || 'CIRCLECI' in env || 'APPVEYOR' in env ||\n-      'GITLAB_CI' in env || env.CI_NAME === 'codeship') {\n-      return COLORS_256;\n-    }\n-    return COLORS_2;\n-  }\n-\n-  if ('TEAMCITY_VERSION' in env) {\n-    return /^(9\\.(0*[1-9]\\d*)\\.|\\d{2,}\\.)/.test(env.TEAMCITY_VERSION) ?\n-      COLORS_16 : COLORS_2;\n-  }\n-\n-  switch (env.TERM_PROGRAM) {\n-    case 'iTerm.app':\n-      if (!env.TERM_PROGRAM_VERSION ||\n-        /^[0-2]\\./.test(env.TERM_PROGRAM_VERSION)) {\n-        return COLORS_256;\n-      }\n-      return COLORS_16m;\n-    case 'HyperTerm':\n-    case 'Hyper':\n-    case 'MacTerm':\n-      return COLORS_16m;\n-    case 'Apple_Terminal':\n-      return COLORS_256;\n-  }\n-\n-  if (env.TERM) {\n-    if (/^xterm-256/.test(env.TERM))\n-      return COLORS_256;\n-    if (/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(env.TERM))\n-      return COLORS_16;\n-  }\n-\n-  if (env.COLORTERM)\n-    return COLORS_16;\n-\n-  return COLORS_2;\n-};\n+WriteStream.prototype.getColorDepth = getColorDepth;\n \n WriteStream.prototype._refreshSize = function() {\n   const oldCols = this.columns;"
        },
        {
            "sha": "dc1cd5f72fd3da28a39da78e7d7742e3d4bbff59",
            "filename": "node.gyp",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/1b715221b9b875fc24d6aae3480c4c55d7f3dd76/node.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/1b715221b9b875fc24d6aae3480c4c55d7f3dd76/node.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/node.gyp?ref=1b715221b9b875fc24d6aae3480c4c55d7f3dd76",
            "patch": "@@ -133,6 +133,7 @@\n       'lib/internal/timers.js',\n       'lib/internal/tls.js',\n       'lib/internal/trace_events_async_hooks.js',\n+      'lib/internal/tty.js',\n       'lib/internal/url.js',\n       'lib/internal/util.js',\n       'lib/internal/util/comparisons.js',"
        }
    ],
    "stats": {
        "total": 179,
        "additions": 107,
        "deletions": 72
    }
}