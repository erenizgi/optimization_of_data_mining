{
    "author": "cjihrig",
    "message": "lib: make pipe_wrap binding internal\n\nPR-URL: https://github.com/nodejs/node/pull/22482\nRefs: https://github.com/nodejs/node/issues/22160\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
    "files": [
        {
            "sha": "f806d70b99c76a282e25572c263e7621fdd03ca4",
            "filename": "lib/_tls_wrap.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2F_tls_wrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2F_tls_wrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_tls_wrap.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -35,7 +35,7 @@ const debug = util.debuglog('tls');\n const { internalBinding } = require('internal/bootstrap/loaders');\n const { TCP, constants: TCPConstants } = internalBinding('tcp_wrap');\n const tls_wrap = internalBinding('tls_wrap');\n-const { Pipe, constants: PipeConstants } = process.binding('pipe_wrap');\n+const { Pipe, constants: PipeConstants } = internalBinding('pipe_wrap');\n const { owner_symbol } = require('internal/async_hooks').symbols;\n const { SecureContext: NativeSecureContext } = internalBinding('crypto');\n const {"
        },
        {
            "sha": "05afcdbc6c8bb9d2d15af2e1dbd000173970c477",
            "filename": "lib/child_process.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2Fchild_process.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2Fchild_process.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fchild_process.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -28,7 +28,8 @@ const {\n const { isArrayBufferView } = require('internal/util/types');\n const debug = util.debuglog('child_process');\n const { Buffer } = require('buffer');\n-const { Pipe, constants: PipeConstants } = process.binding('pipe_wrap');\n+const { internalBinding } = require('internal/bootstrap/loaders');\n+const { Pipe, constants: PipeConstants } = internalBinding('pipe_wrap');\n const {\n   ERR_INVALID_ARG_VALUE,\n   ERR_CHILD_PROCESS_IPC_REQUIRED,"
        },
        {
            "sha": "26d0b2710f74d6f9ba28cab1b3a397a74cf8ef36",
            "filename": "lib/internal/bootstrap/node.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fnode.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -350,6 +350,7 @@\n       new SafeSet([\n         'fs_event_wrap',\n         'uv',\n+        'pipe_wrap',\n         'http_parser',\n         'process_wrap',\n         'v8',"
        },
        {
            "sha": "70211e99fec95418dffa9b577c15c7fc92115e9a",
            "filename": "lib/internal/child_process.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2Finternal%2Fchild_process.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2Finternal%2Fchild_process.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fchild_process.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -25,7 +25,7 @@ const { internalBinding } = require('internal/bootstrap/loaders');\n \n const { Process } = internalBinding('process_wrap');\n const { WriteWrap } = internalBinding('stream_wrap');\n-const { Pipe, constants: PipeConstants } = process.binding('pipe_wrap');\n+const { Pipe, constants: PipeConstants } = internalBinding('pipe_wrap');\n const { TCP } = internalBinding('tcp_wrap');\n const { TTY } = internalBinding('tty_wrap');\n const { UDP } = process.binding('udp_wrap');"
        },
        {
            "sha": "33c41c126ef4c8e523ea2a036e837695819a8cff",
            "filename": "lib/net.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2Fnet.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/lib%2Fnet.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fnet.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -53,7 +53,7 @@ const {\n   Pipe,\n   PipeConnectWrap,\n   constants: PipeConstants\n-} = process.binding('pipe_wrap');\n+} = internalBinding('pipe_wrap');\n const {\n   newAsyncId,\n   defaultTriggerAsyncIdScope,"
        },
        {
            "sha": "8fcf7007f59df7a21865db85e20ed5d83506e1ac",
            "filename": "src/pipe_wrap.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/src%2Fpipe_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/src%2Fpipe_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fpipe_wrap.cc?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -242,4 +242,4 @@ void PipeWrap::Connect(const FunctionCallbackInfo<Value>& args) {\n \n }  // namespace node\n \n-NODE_BUILTIN_MODULE_CONTEXT_AWARE(pipe_wrap, node::PipeWrap::Initialize)\n+NODE_MODULE_CONTEXT_AWARE_INTERNAL(pipe_wrap, node::PipeWrap::Initialize)"
        },
        {
            "sha": "eb3adf65c13624469584e0b2330f6e26d0bf6498",
            "filename": "test/parallel/test-handle-wrap-isrefed.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fparallel%2Ftest-handle-wrap-isrefed.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fparallel%2Ftest-handle-wrap-isrefed.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-handle-wrap-isrefed.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -3,6 +3,7 @@\n \n const common = require('../common');\n const strictEqual = require('assert').strictEqual;\n+const { internalBinding } = require('internal/test/binding');\n \n // child_process\n {\n@@ -72,7 +73,7 @@ const { kStateSymbol } = require('internal/dgram');\n \n // pipe\n {\n-  const { Pipe, constants: PipeConstants } = process.binding('pipe_wrap');\n+  const { Pipe, constants: PipeConstants } = internalBinding('pipe_wrap');\n   const handle = new Pipe(PipeConstants.SOCKET);\n   strictEqual(Object.getPrototypeOf(handle).hasOwnProperty('hasRef'),\n               true, 'pipe_wrap: hasRef() missing');"
        },
        {
            "sha": "468e230ec7370ad0a55cbc566066d6f14438be98",
            "filename": "test/parallel/test-net-connect-options-fd.js",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fparallel%2Ftest-net-connect-options-fd.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fparallel%2Ftest-net-connect-options-fd.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-net-connect-options-fd.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -1,3 +1,4 @@\n+// Flags: --expose-internals\n 'use strict';\n const common = require('../common');\n if (common.isWindows)\n@@ -6,7 +7,8 @@ if (common.isWindows)\n const assert = require('assert');\n const net = require('net');\n const path = require('path');\n-const { Pipe, constants: PipeConstants } = process.binding('pipe_wrap');\n+const { internalBinding } = require('internal/test/binding');\n+const { Pipe, constants: PipeConstants } = internalBinding('pipe_wrap');\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();"
        },
        {
            "sha": "b1182221fcbd0615ce99ab93e8139ac7505a47e4",
            "filename": "test/parallel/test-net-server-listen-handle.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fparallel%2Ftest-net-server-listen-handle.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fparallel%2Ftest-net-server-listen-handle.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-net-server-listen-handle.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -8,7 +8,7 @@ const fs = require('fs');\n const { getSystemErrorName } = require('util');\n const { internalBinding } = require('internal/test/binding');\n const { TCP, constants: TCPConstants } = internalBinding('tcp_wrap');\n-const { Pipe, constants: PipeConstants } = process.binding('pipe_wrap');\n+const { Pipe, constants: PipeConstants } = internalBinding('pipe_wrap');\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();"
        },
        {
            "sha": "ebbb2af5e93ea1252945eea419489db7f65c3cec",
            "filename": "test/parallel/test-process-wrap.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fparallel%2Ftest-process-wrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fparallel%2Ftest-process-wrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-wrap.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -25,7 +25,7 @@ require('../common');\n const assert = require('assert');\n const { internalBinding } = require('internal/test/binding');\n const Process = internalBinding('process_wrap').Process;\n-const { Pipe, constants: PipeConstants } = process.binding('pipe_wrap');\n+const { Pipe, constants: PipeConstants } = internalBinding('pipe_wrap');\n const pipe = new Pipe(PipeConstants.SOCKET);\n const p = new Process();\n "
        },
        {
            "sha": "6e17b657932ab3d4b0aac46544ae1ab0373866eb",
            "filename": "test/sequential/test-async-wrap-getasyncid.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "raw_url": "https://github.com/nodejs/node/raw/6a689c8aa3ef3bf517cc86807406b9a8958d4ffb/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-async-wrap-getasyncid.js?ref=6a689c8aa3ef3bf517cc86807406b9a8958d4ffb",
            "patch": "@@ -158,7 +158,7 @@ if (common.hasCrypto) { // eslint-disable-line node-core/crypto-check\n }\n \n {\n-  const binding = process.binding('pipe_wrap');\n+  const binding = internalBinding('pipe_wrap');\n   const handle = new binding.Pipe(binding.constants.IPC);\n   testInitialized(handle, 'Pipe');\n }\n@@ -169,7 +169,7 @@ if (common.hasCrypto) { // eslint-disable-line node-core/crypto-check\n   const server = net.createServer(common.mustCall((socket) => {\n     server.close();\n   })).listen(common.PIPE, common.mustCall(() => {\n-    const binding = process.binding('pipe_wrap');\n+    const binding = internalBinding('pipe_wrap');\n     const handle = new binding.Pipe(binding.constants.SOCKET);\n     testInitialized(handle, 'Pipe');\n     const req = new binding.PipeConnectWrap();"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 16,
        "deletions": 11
    }
}