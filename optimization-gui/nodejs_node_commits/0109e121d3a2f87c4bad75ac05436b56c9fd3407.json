{
    "author": "cjihrig",
    "message": "deps: upgrade to libuv 1.26.0\n\nNotable changes:\n- A bug that could result in 100% CPU utilization in Node\n  has been fixed (https://github.com/libuv/libuv/issues/2162)\n- Node's report module will now include the entire Windows\n  product name (https://github.com/libuv/libuv/pull/2170)\n\nPR-URL: https://github.com/nodejs/node/pull/26037\nFixes: https://github.com/nodejs/node/issues/26013\nFixes: https://github.com/nodejs/node/issues/25875\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Jeremiah Senkpiel <fishrock123@rocketmail.com>",
    "sha": "0109e121d3a2f87c4bad75ac05436b56c9fd3407",
    "files": [
        {
            "sha": "25447eb0e6e834f796d0b3a57413e586ce8bbc18",
            "filename": "deps/uv/AUTHORS",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2FAUTHORS",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2FAUTHORS",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2FAUTHORS?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -366,3 +366,6 @@ ptlomholt <pt@lomholt.com>\n Victor Costan <pwnall@chromium.org>\n sid <sidyhe@hotmail.com>\n Kevin Adler <kadler@us.ibm.com>\n+Stephen Belanger <admin@stephenbelanger.com>\n+yeyuanfeng <yeyuanfeng@bytedance.com>\n+erw7 <erw7.github@gmail.com>"
        },
        {
            "sha": "5dc61eb825a2c509579ce2625ee42879f56ffc81",
            "filename": "deps/uv/CMakeLists.txt",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2FCMakeLists.txt",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2FCMakeLists.txt",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2FCMakeLists.txt?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -149,6 +149,7 @@ set(uv_test_sources\n     test/test-timer-from-check.c\n     test/test-timer.c\n     test/test-tmpdir.c\n+    test/test-tty-duplicate-key.c\n     test/test-tty.c\n     test/test-udp-alloc-cb-fail.c\n     test/test-udp-bind.c"
        },
        {
            "sha": "7f02045e03ef7b10e0edb55be848557cceeb70ad",
            "filename": "deps/uv/ChangeLog",
            "status": "modified",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2FChangeLog",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2FChangeLog",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2FChangeLog?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -1,3 +1,26 @@\n+2019.02.11, Version 1.26.0 (Stable), 8669d8d3e93cddb62611b267ef62a3ddb5ba3ca0\n+\n+Changes since version 1.25.0:\n+\n+* doc: fix uv_get_free_memory doc (Stephen Belanger)\n+\n+* unix: fix epoll cpu 100% issue (yeyuanfeng)\n+\n+* openbsd,tcp: special handling of EINVAL on connect (ptlomholt)\n+\n+* win: simplify registry closing in uv_cpu_info() (cjihrig)\n+\n+* src,include: define UV_MAXHOSTNAMESIZE (cjihrig)\n+\n+* win: return product name in uv_os_uname() version (cjihrig)\n+\n+* thread: allow specifying stack size for new thread (Anna Henningsen)\n+\n+* win: fix duplicate tty vt100 fn key (erw7)\n+\n+* unix: don't attempt to invalidate invalid fd (Ben Noordhuis)\n+\n+\n 2019.01.19, Version 1.25.0 (Stable), 4a10a9d425863330af199e4b74bd688e62d945f1\n \n Changes since version 1.24.1:"
        },
        {
            "sha": "7e49d8ad0bee168eaa99357300bbf9d83a4abadf",
            "filename": "deps/uv/Makefile.am",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2FMakefile.am",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2FMakefile.am",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2FMakefile.am?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -277,6 +277,7 @@ test_run_tests_SOURCES = test/blackhole-server.c \\\n                          test/test-timer-from-check.c \\\n                          test/test-timer.c \\\n                          test/test-tmpdir.c \\\n+                         test/test-tty-duplicate-key.c \\\n                          test/test-tty.c \\\n                          test/test-udp-alloc-cb-fail.c \\\n                          test/test-udp-bind.c \\"
        },
        {
            "sha": "931ac3e3615e3326f97fb3cedad6d73b254d66aa",
            "filename": "deps/uv/configure.ac",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fconfigure.ac",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fconfigure.ac",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fconfigure.ac?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -13,7 +13,7 @@\n # OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n \n AC_PREREQ(2.57)\n-AC_INIT([libuv], [1.25.0], [https://github.com/libuv/libuv/issues])\n+AC_INIT([libuv], [1.26.0], [https://github.com/libuv/libuv/issues])\n AC_CONFIG_MACRO_DIR([m4])\n m4_include([m4/libuv-extra-automake-flags.m4])\n m4_include([m4/as_case.m4])"
        },
        {
            "sha": "14e9acce9abb2ba83bd9e1b6f566667a2014914d",
            "filename": "deps/uv/docs/src/misc.rst",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fdocs%2Fsrc%2Fmisc.rst",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fdocs%2Fsrc%2Fmisc.rst",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fdocs%2Fsrc%2Fmisc.rst?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -431,7 +431,10 @@ API\n \n     .. versionadded:: 1.9.0\n \n-.. uint64_t uv_get_free_memory(void)\n+.. c:function:: uint64_t uv_get_free_memory(void)\n+\n+    Gets memory information (in bytes).\n+\n .. c:function:: uint64_t uv_get_total_memory(void)\n \n     Gets memory information (in bytes).\n@@ -531,6 +534,10 @@ API\n \n     .. versionadded:: 1.12.0\n \n+    .. versionchanged:: 1.26.0 `UV_MAXHOSTNAMESIZE` is available and represents\n+                               the maximum `buffer` size required to store a\n+                               hostname and terminating `nul` character.\n+\n .. c:function:: int uv_os_getpriority(uv_pid_t pid, int* priority)\n \n     Retrieves the scheduling priority of the process specified by `pid`. The"
        },
        {
            "sha": "a5759a38a67f06f8838938a2f03341f5c75c3fe2",
            "filename": "deps/uv/docs/src/threading.rst",
            "status": "modified",
            "additions": 29,
            "deletions": 0,
            "changes": 29,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fdocs%2Fsrc%2Fthreading.rst",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fdocs%2Fsrc%2Fthreading.rst",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fdocs%2Fsrc%2Fthreading.rst?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -55,10 +55,39 @@ API\n Threads\n ^^^^^^^\n \n+.. c:type:: uv_thread_options_t\n+\n+    Options for spawning a new thread (passed to :c:func:`uv_thread_create_ex`).\n+\n+    ::\n+\n+        typedef struct uv_process_options_s {\n+          enum {\n+            UV_THREAD_NO_FLAGS = 0x00,\n+            UV_THREAD_HAS_STACK_SIZE = 0x01\n+          } flags;\n+          size_t stack_size;\n+        } uv_process_options_t;\n+\n+    More fields may be added to this struct at any time, so its exact\n+    layout and size should not be relied upon.\n+\n+    .. versionadded:: 1.26.0\n+\n .. c:function:: int uv_thread_create(uv_thread_t* tid, uv_thread_cb entry, void* arg)\n \n     .. versionchanged:: 1.4.1 returns a UV_E* error code on failure\n \n+.. c:function:: int uv_thread_create_ex(uv_thread_t* tid, const uv_thread_options_t* params, uv_thread_cb entry, void* arg)\n+\n+    Like :c:func:`uv_thread_create`, but additionally specifies options for creating a new thread.\n+\n+    If `UV_THREAD_HAS_STACK_SIZE` is set, `stack_size` specifies a stack size for the new thread.\n+    `0` indicates that the default value should be used, i.e. behaves as if the flag was not set.\n+    Other values will be rounded up to the nearest page boundary.\n+\n+    .. versionadded:: 1.26.0\n+\n .. c:function:: uv_thread_t uv_thread_self(void)\n .. c:function:: int uv_thread_join(uv_thread_t *tid)\n .. c:function:: int uv_thread_equal(const uv_thread_t* t1, const uv_thread_t* t2)"
        },
        {
            "sha": "1578bbd5682e40340b5dbede39978a825ba226af",
            "filename": "deps/uv/include/uv.h",
            "status": "modified",
            "additions": 29,
            "deletions": 0,
            "changes": 29,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Finclude%2Fuv.h",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Finclude%2Fuv.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Finclude%2Fuv.h?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -1144,6 +1144,17 @@ UV_EXTERN int uv_os_getenv(const char* name, char* buffer, size_t* size);\n UV_EXTERN int uv_os_setenv(const char* name, const char* value);\n UV_EXTERN int uv_os_unsetenv(const char* name);\n \n+#ifdef MAXHOSTNAMELEN\n+# define UV_MAXHOSTNAMESIZE (MAXHOSTNAMELEN + 1)\n+#else\n+  /*\n+    Fallback for the maximum hostname size, including the null terminator. The\n+    Windows gethostname() documentation states that 256 bytes will always be\n+    large enough to hold the null-terminated hostname.\n+  */\n+# define UV_MAXHOSTNAMESIZE 256\n+#endif\n+\n UV_EXTERN int uv_os_gethostname(char* buffer, size_t* size);\n \n UV_EXTERN int uv_os_uname(uv_utsname_t* buffer);\n@@ -1574,6 +1585,24 @@ UV_EXTERN void uv_key_set(uv_key_t* key, void* value);\n typedef void (*uv_thread_cb)(void* arg);\n \n UV_EXTERN int uv_thread_create(uv_thread_t* tid, uv_thread_cb entry, void* arg);\n+\n+typedef enum {\n+  UV_THREAD_NO_FLAGS = 0x00,\n+  UV_THREAD_HAS_STACK_SIZE = 0x01\n+} uv_thread_create_flags;\n+\n+struct uv_thread_options_s {\n+  unsigned int flags;\n+  size_t stack_size;\n+  /* More fields may be added at any time. */\n+};\n+\n+typedef struct uv_thread_options_s uv_thread_options_t;\n+\n+UV_EXTERN int uv_thread_create_ex(uv_thread_t* tid,\n+                                  const uv_thread_options_t* params,\n+                                  uv_thread_cb entry,\n+                                  void* arg);\n UV_EXTERN uv_thread_t uv_thread_self(void);\n UV_EXTERN int uv_thread_join(uv_thread_t *tid);\n UV_EXTERN int uv_thread_equal(const uv_thread_t* t1, const uv_thread_t* t2);"
        },
        {
            "sha": "2363701b414728247c5853d486035f0af3ecb893",
            "filename": "deps/uv/include/uv/unix.h",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Finclude%2Fuv%2Funix.h",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Finclude%2Fuv%2Funix.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Finclude%2Fuv%2Funix.h?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -31,13 +31,14 @@\n #include <netinet/in.h>\n #include <netinet/tcp.h>\n #include <arpa/inet.h>\n-#include <netdb.h>\n+#include <netdb.h>  /* MAXHOSTNAMELEN on Solaris */\n \n #include <termios.h>\n #include <pwd.h>\n \n #if !defined(__MVS__)\n #include <semaphore.h>\n+#include <sys/param.h> /* MAXHOSTNAMELEN on Linux and the BSDs */\n #endif\n #include <pthread.h>\n #include <signal.h>"
        },
        {
            "sha": "fa7320cf4d4a11e26ddc394c3192780662115690",
            "filename": "deps/uv/include/uv/version.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Finclude%2Fuv%2Fversion.h",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Finclude%2Fuv%2Fversion.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Finclude%2Fuv%2Fversion.h?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -31,7 +31,7 @@\n  */\n \n #define UV_VERSION_MAJOR 1\n-#define UV_VERSION_MINOR 25\n+#define UV_VERSION_MINOR 26\n #define UV_VERSION_PATCH 0\n #define UV_VERSION_IS_RELEASE 1\n #define UV_VERSION_SUFFIX \"\""
        },
        {
            "sha": "ec1fb8b01e182307baab68562f45c97b936a5291",
            "filename": "deps/uv/src/unix/aix.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Faix.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Faix.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Faix.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -1041,6 +1041,7 @@ void uv__platform_invalidate_fd(uv_loop_t* loop, int fd) {\n   struct poll_ctl pc;\n \n   assert(loop->watchers != NULL);\n+  assert(fd >= 0);\n \n   events = (struct pollfd*) loop->watchers[loop->nwatchers];\n   nfds = (uintptr_t) loop->watchers[loop->nwatchers + 1];"
        },
        {
            "sha": "7e42337b9aae05087e1107030e0e217a0ff75cb9",
            "filename": "deps/uv/src/unix/core.c",
            "status": "modified",
            "additions": 3,
            "deletions": 12,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fcore.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fcore.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fcore.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -43,7 +43,6 @@\n #include <sys/utsname.h>\n \n #ifdef __sun\n-# include <netdb.h> /* MAXHOSTNAMELEN on Solaris */\n # include <sys/filio.h>\n # include <sys/types.h>\n # include <sys/wait.h>\n@@ -88,15 +87,6 @@\n #include <sys/ioctl.h>\n #endif\n \n-#if !defined(__MVS__)\n-#include <sys/param.h> /* MAXHOSTNAMELEN on Linux and the BSDs */\n-#endif\n-\n-/* Fallback for the maximum hostname length */\n-#ifndef MAXHOSTNAMELEN\n-# define MAXHOSTNAMELEN 256\n-#endif\n-\n static int uv__run_pending(uv_loop_t* loop);\n \n /* Verify that uv_buf_t is ABI-compatible with struct iovec. */\n@@ -892,7 +882,8 @@ void uv__io_close(uv_loop_t* loop, uv__io_t* w) {\n   QUEUE_REMOVE(&w->pending_queue);\n \n   /* Remove stale events for this file descriptor */\n-  uv__platform_invalidate_fd(loop, w->fd);\n+  if (w->fd != -1)\n+    uv__platform_invalidate_fd(loop, w->fd);\n }\n \n \n@@ -1291,7 +1282,7 @@ int uv_os_gethostname(char* buffer, size_t* size) {\n     instead by creating a large enough buffer and comparing the hostname length\n     to the size input.\n   */\n-  char buf[MAXHOSTNAMELEN + 1];\n+  char buf[UV_MAXHOSTNAMESIZE];\n   size_t len;\n \n   if (buffer == NULL || size == NULL || *size == 0)"
        },
        {
            "sha": "38c88d7da732af4c5c1b6808d82f46488c8da641",
            "filename": "deps/uv/src/unix/kqueue.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fkqueue.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fkqueue.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fkqueue.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -387,6 +387,7 @@ void uv__platform_invalidate_fd(uv_loop_t* loop, int fd) {\n   uintptr_t nfds;\n \n   assert(loop->watchers != NULL);\n+  assert(fd >= 0);\n \n   events = (struct kevent*) loop->watchers[loop->nwatchers];\n   nfds = (uintptr_t) loop->watchers[loop->nwatchers + 1];"
        },
        {
            "sha": "7165fe2fb4dd1b574df766460916ee1a543981a2",
            "filename": "deps/uv/src/unix/linux-core.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Flinux-core.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Flinux-core.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Flinux-core.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -141,6 +141,7 @@ void uv__platform_invalidate_fd(uv_loop_t* loop, int fd) {\n   uintptr_t nfds;\n \n   assert(loop->watchers != NULL);\n+  assert(fd >= 0);\n \n   events = (struct epoll_event*) loop->watchers[loop->nwatchers];\n   nfds = (uintptr_t) loop->watchers[loop->nwatchers + 1];"
        },
        {
            "sha": "70e389ece3bc73cb8604c606ea58cb24ab8b19aa",
            "filename": "deps/uv/src/unix/os390.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fos390.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fos390.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fos390.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -657,6 +657,7 @@ void uv__platform_invalidate_fd(uv_loop_t* loop, int fd) {\n   uintptr_t nfds;\n \n   assert(loop->watchers != NULL);\n+  assert(fd >= 0);\n \n   events = (struct epoll_event*) loop->watchers[loop->nwatchers];\n   nfds = (uintptr_t) loop->watchers[loop->nwatchers + 1];"
        },
        {
            "sha": "228d158800acdc78e6587405f8142268ed179cdb",
            "filename": "deps/uv/src/unix/pipe.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fpipe.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fpipe.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fpipe.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -215,7 +215,7 @@ void uv_pipe_connect(uv_connect_t* req,\n   }\n \n   if (err == 0)\n-    uv__io_start(handle->loop, &handle->io_watcher, POLLIN | POLLOUT);\n+    uv__io_start(handle->loop, &handle->io_watcher, POLLOUT);\n \n out:\n   handle->delayed_error = err;"
        },
        {
            "sha": "a3b9f2196d58723f979666e23728412b65352296",
            "filename": "deps/uv/src/unix/posix-poll.c",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fposix-poll.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fposix-poll.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fposix-poll.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -298,6 +298,8 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n void uv__platform_invalidate_fd(uv_loop_t* loop, int fd) {\n   size_t i;\n \n+  assert(fd >= 0);\n+\n   if (loop->poll_fds_iterating) {\n     /* uv__io_poll is currently iterating.  Just invalidate fd.  */\n     for (i = 0; i < loop->poll_fds_used; i++)"
        },
        {
            "sha": "75501f7a0a79b6a6d4657ad80141136732564134",
            "filename": "deps/uv/src/unix/sunos.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fsunos.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fsunos.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fsunos.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -117,6 +117,7 @@ void uv__platform_invalidate_fd(uv_loop_t* loop, int fd) {\n   uintptr_t nfds;\n \n   assert(loop->watchers != NULL);\n+  assert(fd >= 0);\n \n   events = (struct port_event*) loop->watchers[loop->nwatchers];\n   nfds = (uintptr_t) loop->watchers[loop->nwatchers + 1];"
        },
        {
            "sha": "900839a99dfccce4e392db5617c8156e01cf4596",
            "filename": "deps/uv/src/unix/tcp.c",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Ftcp.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Ftcp.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Ftcp.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -235,12 +235,16 @@ int uv__tcp_connect(uv_connect_t* req,\n   if (r == -1 && errno != 0) {\n     if (errno == EINPROGRESS)\n       ; /* not an error */\n-    else if (errno == ECONNREFUSED)\n-    /* If we get a ECONNREFUSED wait until the next tick to report the\n-     * error. Solaris wants to report immediately--other unixes want to\n-     * wait.\n+    else if (errno == ECONNREFUSED\n+#if defined(__OpenBSD__)\n+      || errno == EINVAL\n+#endif\n+      )\n+    /* If we get ECONNREFUSED (Solaris) or EINVAL (OpenBSD) wait until the\n+     * next tick to report the error. Solaris and OpenBSD wants to report\n+     * immediately -- other unixes want to wait.\n      */\n-      handle->delayed_error = UV__ERR(errno);\n+      handle->delayed_error = UV__ERR(ECONNREFUSED);\n     else\n       return UV__ERR(errno);\n   }"
        },
        {
            "sha": "c17a51fed23efed7b1a31679c9cc8f50dff71160",
            "filename": "deps/uv/src/unix/thread.c",
            "status": "modified",
            "additions": 23,
            "deletions": 2,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fthread.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Funix%2Fthread.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fthread.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -194,13 +194,34 @@ static size_t thread_stack_size(void) {\n \n \n int uv_thread_create(uv_thread_t *tid, void (*entry)(void *arg), void *arg) {\n+  uv_thread_options_t params;\n+  params.flags = UV_THREAD_NO_FLAGS;\n+  return uv_thread_create_ex(tid, &params, entry, arg);\n+}\n+\n+int uv_thread_create_ex(uv_thread_t* tid,\n+                        const uv_thread_options_t* params,\n+                        void (*entry)(void *arg),\n+                        void *arg) {\n   int err;\n-  size_t stack_size;\n   pthread_attr_t* attr;\n   pthread_attr_t attr_storage;\n+  size_t pagesize;\n+  size_t stack_size;\n+\n+  stack_size =\n+      params->flags & UV_THREAD_HAS_STACK_SIZE ? params->stack_size : 0;\n \n   attr = NULL;\n-  stack_size = thread_stack_size();\n+  if (stack_size == 0) {\n+    stack_size = thread_stack_size();\n+  } else {\n+    pagesize = (size_t)getpagesize();\n+    /* Round up to the nearest page boundary. */\n+    stack_size = (stack_size + pagesize - 1) &~ (pagesize - 1);\n+    if (stack_size < PTHREAD_STACK_MIN)\n+      stack_size = PTHREAD_STACK_MIN;\n+  }\n \n   if (stack_size > 0) {\n     attr = &attr_storage;"
        },
        {
            "sha": "89c53ada755b175f090faf9a00abd943140581c1",
            "filename": "deps/uv/src/win/thread.c",
            "status": "modified",
            "additions": 26,
            "deletions": 1,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Fwin%2Fthread.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Fwin%2Fthread.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Fthread.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -112,9 +112,34 @@ static UINT __stdcall uv__thread_start(void* arg) {\n \n \n int uv_thread_create(uv_thread_t *tid, void (*entry)(void *arg), void *arg) {\n+  uv_thread_options_t params;\n+  params.flags = UV_THREAD_NO_FLAGS;\n+  return uv_thread_create_ex(tid, &params, entry, arg);\n+}\n+\n+int uv_thread_create_ex(uv_thread_t* tid,\n+                        const uv_thread_options_t* params,\n+                        void (*entry)(void *arg),\n+                        void *arg) {\n   struct thread_ctx* ctx;\n   int err;\n   HANDLE thread;\n+  SYSTEM_INFO sysinfo;\n+  size_t stack_size;\n+  size_t pagesize;\n+\n+  stack_size =\n+      params->flags & UV_THREAD_HAS_STACK_SIZE ? params->stack_size : 0;\n+\n+  if (stack_size != 0) {\n+    GetNativeSystemInfo(&sysinfo);\n+    pagesize = (size_t)sysinfo.dwPageSize;\n+    /* Round up to the nearest page boundary. */\n+    stack_size = (stack_size + pagesize - 1) &~ (pagesize - 1);\n+\n+    if ((unsigned)stack_size != stack_size)\n+      return UV_EINVAL;\n+  }\n \n   ctx = uv__malloc(sizeof(*ctx));\n   if (ctx == NULL)\n@@ -126,7 +151,7 @@ int uv_thread_create(uv_thread_t *tid, void (*entry)(void *arg), void *arg) {\n   /* Create the thread in suspended state so we have a chance to pass\n    * its own creation handle to it */\n   thread = (HANDLE) _beginthreadex(NULL,\n-                                   0,\n+                                   (unsigned)stack_size,\n                                    uv__thread_start,\n                                    ctx,\n                                    CREATE_SUSPENDED,"
        },
        {
            "sha": "a98fe26335e4b8179b9efa0ab2411eb1de3c3b08",
            "filename": "deps/uv/src/win/tty.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Fwin%2Ftty.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Fwin%2Ftty.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Ftty.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -736,8 +736,8 @@ void uv_process_tty_read_raw_req(uv_loop_t* loop, uv_tty_t* handle,\n       /* Ignore keyup events, unless the left alt key was held and a valid\n        * unicode character was emitted. */\n       if (!KEV.bKeyDown &&\n-          KEV.wVirtualKeyCode != VK_MENU &&\n-          KEV.uChar.UnicodeChar != 0) {\n+          (KEV.wVirtualKeyCode != VK_MENU ||\n+           KEV.uChar.UnicodeChar == 0)) {\n         continue;\n       }\n "
        },
        {
            "sha": "395d958c036958cc5a0158cd01bffd37d7ffc2df",
            "filename": "deps/uv/src/win/util.c",
            "status": "modified",
            "additions": 57,
            "deletions": 23,
            "changes": 80,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Fwin%2Futil.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Fsrc%2Fwin%2Futil.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Futil.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -59,13 +59,6 @@\n # define UNLEN 256\n #endif\n \n-/*\n-  Max hostname length. The Windows gethostname() documentation states that 256\n-  bytes will always be large enough to hold the null-terminated hostname.\n-*/\n-#ifndef MAXHOSTNAMELEN\n-# define MAXHOSTNAMELEN 256\n-#endif\n \n /* Maximum environment variable size, including the terminating null */\n #define MAX_ENV_VAR_LENGTH 32767\n@@ -684,12 +677,9 @@ int uv_cpu_info(uv_cpu_info_t** cpu_infos_ptr, int* cpu_count_ptr) {\n                            NULL,\n                            (BYTE*)&cpu_brand,\n                            &cpu_brand_size);\n-    if (err != ERROR_SUCCESS) {\n-      RegCloseKey(processor_key);\n-      goto error;\n-    }\n-\n     RegCloseKey(processor_key);\n+    if (err != ERROR_SUCCESS)\n+      goto error;\n \n     cpu_info = &cpu_infos[i];\n     cpu_info->speed = cpu_speed;\n@@ -1510,7 +1500,7 @@ int uv_os_unsetenv(const char* name) {\n \n \n int uv_os_gethostname(char* buffer, size_t* size) {\n-  char buf[MAXHOSTNAMELEN + 1];\n+  char buf[UV_MAXHOSTNAMESIZE];\n   size_t len;\n \n   if (buffer == NULL || size == NULL || *size == 0)\n@@ -1634,6 +1624,10 @@ int uv_os_uname(uv_utsname_t* buffer) {\n      https://github.com/gagern/gnulib/blob/master/lib/uname.c */\n   OSVERSIONINFOW os_info;\n   SYSTEM_INFO system_info;\n+  HKEY registry_key;\n+  WCHAR product_name_w[256];\n+  DWORD product_name_w_size;\n+  int version_size;\n   int processor_level;\n   int r;\n \n@@ -1658,16 +1652,56 @@ int uv_os_uname(uv_utsname_t* buffer) {\n   }\n \n   /* Populate the version field. */\n-  if (WideCharToMultiByte(CP_UTF8,\n-                          0,\n-                          os_info.szCSDVersion,\n-                          -1,\n-                          buffer->version,\n-                          sizeof(buffer->version),\n-                          NULL,\n-                          NULL) == 0) {\n-    r = uv_translate_sys_error(GetLastError());\n-    goto error;\n+  version_size = 0;\n+  r = RegOpenKeyExW(HKEY_LOCAL_MACHINE,\n+                    L\"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\",\n+                    0,\n+                    KEY_QUERY_VALUE,\n+                    &registry_key);\n+\n+  if (r == ERROR_SUCCESS) {\n+    product_name_w_size = sizeof(product_name_w);\n+    r = RegGetValueW(registry_key,\n+                     NULL,\n+                     L\"ProductName\",\n+                     RRF_RT_REG_SZ,\n+                     NULL,\n+                     (PVOID) product_name_w,\n+                     &product_name_w_size);\n+    RegCloseKey(registry_key);\n+\n+    if (r == ERROR_SUCCESS) {\n+      version_size = WideCharToMultiByte(CP_UTF8,\n+                                         0,\n+                                         product_name_w,\n+                                         -1,\n+                                         buffer->version,\n+                                         sizeof(buffer->version),\n+                                         NULL,\n+                                         NULL);\n+      if (version_size == 0) {\n+        r = uv_translate_sys_error(GetLastError());\n+        goto error;\n+      }\n+    }\n+  }\n+\n+  /* Append service pack information to the version if present. */\n+  if (os_info.szCSDVersion[0] != L'\\0') {\n+    if (version_size > 0)\n+      buffer->version[version_size - 1] = ' ';\n+\n+    if (WideCharToMultiByte(CP_UTF8,\n+                            0,\n+                            os_info.szCSDVersion,\n+                            -1,\n+                            buffer->version + version_size,\n+                            sizeof(buffer->version) - version_size,\n+                            NULL,\n+                            NULL) == 0) {\n+      r = uv_translate_sys_error(GetLastError());\n+      goto error;\n+    }\n   }\n \n   /* Populate the sysname field. */"
        },
        {
            "sha": "ac636f0aba638bb91ac4205b5df79ea25d4e6bed",
            "filename": "deps/uv/test/test-gethostname.c",
            "status": "modified",
            "additions": 2,
            "deletions": 6,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest-gethostname.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest-gethostname.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-gethostname.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -23,12 +23,8 @@\n #include \"task.h\"\n #include <string.h>\n \n-#ifndef MAXHOSTNAMELEN\n-# define MAXHOSTNAMELEN 256\n-#endif\n-\n TEST_IMPL(gethostname) {\n-  char buf[MAXHOSTNAMELEN + 1];\n+  char buf[UV_MAXHOSTNAMESIZE];\n   size_t size;\n   size_t enobufs_size;\n   int r;\n@@ -52,7 +48,7 @@ TEST_IMPL(gethostname) {\n   ASSERT(enobufs_size > 1);\n \n   /* Successfully get the hostname */\n-  size = MAXHOSTNAMELEN + 1;\n+  size = UV_MAXHOSTNAMESIZE;\n   r = uv_os_gethostname(buf, &size);\n   ASSERT(r == 0);\n   ASSERT(size > 1 && size == strlen(buf));"
        },
        {
            "sha": "d81416fad22b54d9ed8f06c6cce3c934cca6b782",
            "filename": "deps/uv/test/test-list.h",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest-list.h",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest-list.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-list.h?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -53,6 +53,9 @@ TEST_DECLARE   (tty_raw)\n TEST_DECLARE   (tty_empty_write)\n TEST_DECLARE   (tty_large_write)\n TEST_DECLARE   (tty_raw_cancel)\n+TEST_DECLARE   (tty_duplicate_vt100_fn_key)\n+TEST_DECLARE   (tty_duplicate_alt_modifier_key)\n+TEST_DECLARE   (tty_composing_character)\n #endif\n TEST_DECLARE   (tty_file)\n TEST_DECLARE   (tty_pty)\n@@ -365,6 +368,7 @@ TEST_DECLARE   (threadpool_cancel_fs)\n TEST_DECLARE   (threadpool_cancel_single)\n TEST_DECLARE   (thread_local_storage)\n TEST_DECLARE   (thread_stack_size)\n+TEST_DECLARE   (thread_stack_size_explicit)\n TEST_DECLARE   (thread_mutex)\n TEST_DECLARE   (thread_mutex_recursive)\n TEST_DECLARE   (thread_rwlock)\n@@ -500,6 +504,9 @@ TASK_LIST_START\n   TEST_ENTRY  (tty_empty_write)\n   TEST_ENTRY  (tty_large_write)\n   TEST_ENTRY  (tty_raw_cancel)\n+  TEST_ENTRY  (tty_duplicate_vt100_fn_key)\n+  TEST_ENTRY  (tty_duplicate_alt_modifier_key)\n+  TEST_ENTRY  (tty_composing_character)\n #endif\n   TEST_ENTRY  (tty_file)\n   TEST_ENTRY  (tty_pty)\n@@ -930,6 +937,7 @@ TASK_LIST_START\n   TEST_ENTRY  (threadpool_cancel_single)\n   TEST_ENTRY  (thread_local_storage)\n   TEST_ENTRY  (thread_stack_size)\n+  TEST_ENTRY  (thread_stack_size_explicit)\n   TEST_ENTRY  (thread_mutex)\n   TEST_ENTRY  (thread_mutex_recursive)\n   TEST_ENTRY  (thread_rwlock)"
        },
        {
            "sha": "be72d5e8b39979f7d09e11345e2a35d899cd3456",
            "filename": "deps/uv/test/test-thread.c",
            "status": "modified",
            "additions": 55,
            "deletions": 2,
            "changes": 57,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest-thread.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest-thread.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-thread.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -26,6 +26,10 @@\n #include <stdlib.h>\n #include <string.h> /* memset */\n \n+#ifdef __POSIX__\n+#include <pthread.h>\n+#endif\n+\n struct getaddrinfo_req {\n   uv_thread_t thread_id;\n   unsigned int counter;\n@@ -207,10 +211,15 @@ TEST_IMPL(thread_local_storage) {\n \n static void thread_check_stack(void* arg) {\n #if defined(__APPLE__)\n+  size_t expected;\n+  expected = arg == NULL ? 0 : ((uv_thread_options_t*)arg)->stack_size;\n   /* 512 kB is the default stack size of threads other than the main thread\n    * on MacOS. */\n-  ASSERT(pthread_get_stacksize_np(pthread_self()) > 512*1024);\n+  if (expected == 0)\n+    expected = 512 * 1024;\n+  ASSERT(pthread_get_stacksize_np(pthread_self()) >= expected);\n #elif defined(__linux__) && defined(__GLIBC__)\n+  size_t expected;\n   struct rlimit lim;\n   size_t stack_size;\n   pthread_attr_t attr;\n@@ -219,7 +228,10 @@ static void thread_check_stack(void* arg) {\n     lim.rlim_cur = 2 << 20;  /* glibc default. */\n   ASSERT(0 == pthread_getattr_np(pthread_self(), &attr));\n   ASSERT(0 == pthread_attr_getstacksize(&attr, &stack_size));\n-  ASSERT(stack_size >= lim.rlim_cur);\n+  expected = arg == NULL ? 0 : ((uv_thread_options_t*)arg)->stack_size;\n+  if (expected == 0)\n+    expected = (size_t)lim.rlim_cur;\n+  ASSERT(stack_size >= expected);\n #endif\n }\n \n@@ -230,3 +242,44 @@ TEST_IMPL(thread_stack_size) {\n   ASSERT(0 == uv_thread_join(&thread));\n   return 0;\n }\n+\n+TEST_IMPL(thread_stack_size_explicit) {\n+  uv_thread_t thread;\n+  uv_thread_options_t options;\n+\n+  options.flags = UV_THREAD_HAS_STACK_SIZE;\n+  options.stack_size = 1024 * 1024;\n+  ASSERT(0 == uv_thread_create_ex(&thread, &options,\n+                                  thread_check_stack, &options));\n+  ASSERT(0 == uv_thread_join(&thread));\n+\n+  options.stack_size = 8 * 1024 * 1024;  /* larger than most default os sizes */\n+  ASSERT(0 == uv_thread_create_ex(&thread, &options,\n+                                  thread_check_stack, &options));\n+  ASSERT(0 == uv_thread_join(&thread));\n+\n+  options.stack_size = 0;\n+  ASSERT(0 == uv_thread_create_ex(&thread, &options,\n+                                  thread_check_stack, &options));\n+  ASSERT(0 == uv_thread_join(&thread));\n+\n+#ifdef PTHREAD_STACK_MIN\n+  options.stack_size = PTHREAD_STACK_MIN - 42;  /* unaligned size */\n+  ASSERT(0 == uv_thread_create_ex(&thread, &options,\n+                                  thread_check_stack, &options));\n+  ASSERT(0 == uv_thread_join(&thread));\n+\n+  options.stack_size = PTHREAD_STACK_MIN / 2 - 42;  /* unaligned size */\n+  ASSERT(0 == uv_thread_create_ex(&thread, &options,\n+                                  thread_check_stack, &options));\n+  ASSERT(0 == uv_thread_join(&thread));\n+#endif\n+\n+  /* unaligned size, should be larger than PTHREAD_STACK_MIN */\n+  options.stack_size = 1234567;\n+  ASSERT(0 == uv_thread_create_ex(&thread, &options,\n+                                  thread_check_stack, &options));\n+  ASSERT(0 == uv_thread_join(&thread));\n+\n+  return 0;\n+}"
        },
        {
            "sha": "1ec2f3695d99a4dec93396f74ea2759cfdb0b4f2",
            "filename": "deps/uv/test/test-tty-duplicate-key.c",
            "status": "added",
            "additions": 321,
            "deletions": 0,
            "changes": 321,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest-tty-duplicate-key.c",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest-tty-duplicate-key.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-tty-duplicate-key.c?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -0,0 +1,321 @@\n+/* Copyright libuv project contributors. All rights reserved.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to\n+ * deal in the Software without restriction, including without limitation the\n+ * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n+ * sell copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n+ * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n+ * IN THE SOFTWARE.\n+ */\n+\n+#ifdef _WIN32\n+\n+#include \"uv.h\"\n+#include \"task.h\"\n+\n+#include <errno.h>\n+#include <io.h>\n+#include <string.h>\n+#include <windows.h>\n+\n+#define ESC \"\\x1b\"\n+#define EUR_UTF8 \"\\xe2\\x82\\xac\"\n+#define EUR_UNICODE 0x20AC\n+\n+\n+const char* expect_str = NULL;\n+ssize_t expect_nread = 0;\n+\n+static void dump_str(const char* str, ssize_t len) {\n+  ssize_t i;\n+  for (i = 0; i < len; i++) {\n+    fprintf(stderr, \"%#02x \", *(str + i));\n+  }\n+}\n+\n+static void print_err_msg(const char* expect, ssize_t expect_len,\n+                          const char* found, ssize_t found_len) {\n+  fprintf(stderr, \"expect \");\n+  dump_str(expect, expect_len);\n+  fprintf(stderr, \", but found \");\n+  dump_str(found, found_len);\n+  fprintf(stderr, \"\\n\");\n+}\n+\n+static void tty_alloc(uv_handle_t* handle, size_t size, uv_buf_t* buf) {\n+  buf->base = malloc(size);\n+  ASSERT(buf->base != NULL);\n+  buf->len = size;\n+}\n+\n+static void tty_read(uv_stream_t* tty_in, ssize_t nread, const uv_buf_t* buf) {\n+  if (nread > 0) {\n+    if (nread != expect_nread) {\n+      fprintf(stderr, \"expected nread %ld, but found %ld\\n\",\n+              (long)expect_nread, (long)nread);\n+      print_err_msg(expect_str, expect_nread, buf->base, nread);\n+      ASSERT(FALSE);\n+    }\n+    if (strncmp(buf->base, expect_str, nread) != 0) {\n+      print_err_msg(expect_str, expect_nread, buf->base, nread);\n+      ASSERT(FALSE);\n+    }\n+    uv_close((uv_handle_t*) tty_in, NULL);\n+  } else {\n+    ASSERT(nread == 0);\n+  }\n+}\n+\n+static void make_key_event_records(WORD virt_key, DWORD ctr_key_state,\n+                                   BOOL is_wsl, INPUT_RECORD* records) {\n+# define KEV(I) records[(I)].Event.KeyEvent\n+  BYTE kb_state[256] = {0};\n+  WCHAR buf[2];\n+  int ret;\n+\n+  records[0].EventType = records[1].EventType = KEY_EVENT;\n+  KEV(0).bKeyDown = TRUE;\n+  KEV(1).bKeyDown = FALSE;\n+  KEV(0).wVirtualKeyCode = KEV(1).wVirtualKeyCode = virt_key;\n+  KEV(0).wRepeatCount = KEV(1).wRepeatCount = 1;\n+  KEV(0).wVirtualScanCode = KEV(1).wVirtualScanCode =\n+    MapVirtualKeyW(virt_key, MAPVK_VK_TO_VSC);\n+  KEV(0).dwControlKeyState = KEV(1).dwControlKeyState = ctr_key_state;\n+  if (ctr_key_state & LEFT_ALT_PRESSED) {\n+    kb_state[VK_LMENU] = 0x01;\n+  }\n+  if (ctr_key_state & RIGHT_ALT_PRESSED) {\n+    kb_state[VK_RMENU] = 0x01;\n+  }\n+  if (ctr_key_state & LEFT_CTRL_PRESSED) {\n+    kb_state[VK_LCONTROL] = 0x01;\n+  }\n+  if (ctr_key_state & RIGHT_CTRL_PRESSED) {\n+    kb_state[VK_RCONTROL] = 0x01;\n+  }\n+  if (ctr_key_state & SHIFT_PRESSED) {\n+    kb_state[VK_SHIFT] = 0x01;\n+  }\n+  ret = ToUnicode(virt_key, KEV(0).wVirtualScanCode, kb_state, buf, 2, 0);\n+  if (ret == 1) {\n+    if(!is_wsl &&\n+        ((ctr_key_state & LEFT_ALT_PRESSED) ||\n+         (ctr_key_state & RIGHT_ALT_PRESSED))) {\n+      /*\n+       * If ALT key is pressed, the UnicodeChar value of the keyup event is\n+       * set to 0 on nomal console. Emulate this behavior.\n+       * See https://github.com/Microsoft/console/issues/320\n+       */\n+      KEV(0).uChar.UnicodeChar = buf[0];\n+      KEV(1).uChar.UnicodeChar = 0;\n+    } else{\n+      /*\n+       * In WSL UnicodeChar is normally set. This behavior cause #2111.\n+       */\n+      KEV(0).uChar.UnicodeChar = KEV(1).uChar.UnicodeChar = buf[0];\n+    }\n+  } else {\n+    KEV(0).uChar.UnicodeChar = KEV(1).uChar.UnicodeChar = 0;\n+  }\n+# undef KEV\n+}\n+\n+TEST_IMPL(tty_duplicate_vt100_fn_key) {\n+  int r;\n+  int ttyin_fd;\n+  uv_tty_t tty_in;\n+  uv_loop_t* loop;\n+  HANDLE handle;\n+  INPUT_RECORD records[2];\n+  DWORD written;\n+\n+  loop = uv_default_loop();\n+\n+  /* Make sure we have an FD that refers to a tty */\n+  handle = CreateFileA(\"conin$\",\n+                       GENERIC_READ | GENERIC_WRITE,\n+                       FILE_SHARE_READ | FILE_SHARE_WRITE,\n+                       NULL,\n+                       OPEN_EXISTING,\n+                       FILE_ATTRIBUTE_NORMAL,\n+                       NULL);\n+  ASSERT(handle != INVALID_HANDLE_VALUE);\n+  ttyin_fd = _open_osfhandle((intptr_t) handle, 0);\n+  ASSERT(ttyin_fd >= 0);\n+  ASSERT(UV_TTY == uv_guess_handle(ttyin_fd));\n+\n+  r = uv_tty_init(uv_default_loop(), &tty_in, ttyin_fd, 1);  /* Readable. */\n+  ASSERT(r == 0);\n+  ASSERT(uv_is_readable((uv_stream_t*) &tty_in));\n+  ASSERT(!uv_is_writable((uv_stream_t*) &tty_in));\n+\n+  r = uv_read_start((uv_stream_t*)&tty_in, tty_alloc, tty_read);\n+  ASSERT(r == 0);\n+\n+  expect_str = ESC\"[[A\";\n+  expect_nread = strlen(expect_str);\n+\n+  /* Turn on raw mode. */\n+  r = uv_tty_set_mode(&tty_in, UV_TTY_MODE_RAW);\n+  ASSERT(r == 0);\n+\n+  /*\n+   * Send F1 keystrokes. Test of issue cause by #2114 that vt100 fn key\n+   * duplicate.\n+   */\n+  make_key_event_records(VK_F1, 0, TRUE, records);\n+  WriteConsoleInputW(handle, records, ARRAY_SIZE(records), &written);\n+  ASSERT(written == ARRAY_SIZE(records));\n+\n+  uv_run(loop, UV_RUN_DEFAULT);\n+\n+  MAKE_VALGRIND_HAPPY();\n+  return 0;\n+}\n+\n+TEST_IMPL(tty_duplicate_alt_modifier_key) {\n+  int r;\n+  int ttyin_fd;\n+  uv_tty_t tty_in;\n+  uv_loop_t* loop;\n+  HANDLE handle;\n+  INPUT_RECORD records[2];\n+  INPUT_RECORD alt_records[2];\n+  DWORD written;\n+\n+  loop = uv_default_loop();\n+\n+  /* Make sure we have an FD that refers to a tty */\n+  handle = CreateFileA(\"conin$\",\n+                       GENERIC_READ | GENERIC_WRITE,\n+                       FILE_SHARE_READ | FILE_SHARE_WRITE,\n+                       NULL,\n+                       OPEN_EXISTING,\n+                       FILE_ATTRIBUTE_NORMAL,\n+                       NULL);\n+  ASSERT(handle != INVALID_HANDLE_VALUE);\n+  ttyin_fd = _open_osfhandle((intptr_t) handle, 0);\n+  ASSERT(ttyin_fd >= 0);\n+  ASSERT(UV_TTY == uv_guess_handle(ttyin_fd));\n+\n+  r = uv_tty_init(uv_default_loop(), &tty_in, ttyin_fd, 1);  /* Readable. */\n+  ASSERT(r == 0);\n+  ASSERT(uv_is_readable((uv_stream_t*) &tty_in));\n+  ASSERT(!uv_is_writable((uv_stream_t*) &tty_in));\n+\n+  r = uv_read_start((uv_stream_t*)&tty_in, tty_alloc, tty_read);\n+  ASSERT(r == 0);\n+\n+  expect_str = ESC\"a\"ESC\"a\";\n+  expect_nread = strlen(expect_str);\n+\n+  /* Turn on raw mode. */\n+  r = uv_tty_set_mode(&tty_in, UV_TTY_MODE_RAW);\n+  ASSERT(r == 0);\n+\n+  /* Emulate transmission of M-a at normal console */\n+  make_key_event_records(VK_MENU, 0, TRUE, alt_records);\n+  WriteConsoleInputW(handle, &alt_records[0], 1, &written);\n+  ASSERT(written == 1);\n+  make_key_event_records(L'A', LEFT_ALT_PRESSED, FALSE, records);\n+  WriteConsoleInputW(handle, records, ARRAY_SIZE(records), &written);\n+  ASSERT(written == 2);\n+  WriteConsoleInputW(handle, &alt_records[1], 1, &written);\n+  ASSERT(written == 1);\n+\n+  /* Emulate transmission of M-a at WSL(#2111) */\n+  make_key_event_records(VK_MENU, 0, TRUE, alt_records);\n+  WriteConsoleInputW(handle, &alt_records[0], 1, &written);\n+  ASSERT(written == 1);\n+  make_key_event_records(L'A', LEFT_ALT_PRESSED, TRUE, records);\n+  WriteConsoleInputW(handle, records, ARRAY_SIZE(records), &written);\n+  ASSERT(written == 2);\n+  WriteConsoleInputW(handle, &alt_records[1], 1, &written);\n+  ASSERT(written == 1);\n+\n+  uv_run(loop, UV_RUN_DEFAULT);\n+\n+  MAKE_VALGRIND_HAPPY();\n+  return 0;\n+}\n+\n+TEST_IMPL(tty_composing_character) {\n+  int r;\n+  int ttyin_fd;\n+  uv_tty_t tty_in;\n+  uv_loop_t* loop;\n+  HANDLE handle;\n+  INPUT_RECORD records[2];\n+  INPUT_RECORD alt_records[2];\n+  DWORD written;\n+\n+  loop = uv_default_loop();\n+\n+  /* Make sure we have an FD that refers to a tty */\n+  handle = CreateFileA(\"conin$\",\n+                       GENERIC_READ | GENERIC_WRITE,\n+                       FILE_SHARE_READ | FILE_SHARE_WRITE,\n+                       NULL,\n+                       OPEN_EXISTING,\n+                       FILE_ATTRIBUTE_NORMAL,\n+                       NULL);\n+  ASSERT(handle != INVALID_HANDLE_VALUE);\n+  ttyin_fd = _open_osfhandle((intptr_t) handle, 0);\n+  ASSERT(ttyin_fd >= 0);\n+  ASSERT(UV_TTY == uv_guess_handle(ttyin_fd));\n+\n+  r = uv_tty_init(uv_default_loop(), &tty_in, ttyin_fd, 1);  /* Readable. */\n+  ASSERT(r == 0);\n+  ASSERT(uv_is_readable((uv_stream_t*) &tty_in));\n+  ASSERT(!uv_is_writable((uv_stream_t*) &tty_in));\n+\n+  r = uv_read_start((uv_stream_t*)&tty_in, tty_alloc, tty_read);\n+  ASSERT(r == 0);\n+\n+  expect_str = EUR_UTF8;\n+  expect_nread = strlen(expect_str);\n+\n+  /* Turn on raw mode. */\n+  r = uv_tty_set_mode(&tty_in, UV_TTY_MODE_RAW);\n+  ASSERT(r == 0);\n+\n+  /* Emulate EUR inputs by LEFT ALT+NUMPAD ASCII KeyComos */\n+  make_key_event_records(VK_MENU, 0, FALSE, alt_records);\n+  alt_records[1].Event.KeyEvent.uChar.UnicodeChar = EUR_UNICODE;\n+  WriteConsoleInputW(handle, &alt_records[0], 1, &written);\n+  make_key_event_records(VK_NUMPAD0, LEFT_ALT_PRESSED, FALSE, records);\n+  WriteConsoleInputW(handle, records, ARRAY_SIZE(records), &written);\n+  ASSERT(written == ARRAY_SIZE(records));\n+  make_key_event_records(VK_NUMPAD1, LEFT_ALT_PRESSED, FALSE, records);\n+  WriteConsoleInputW(handle, records, ARRAY_SIZE(records), &written);\n+  ASSERT(written == ARRAY_SIZE(records));\n+  make_key_event_records(VK_NUMPAD2, LEFT_ALT_PRESSED, FALSE, records);\n+  WriteConsoleInputW(handle, records, ARRAY_SIZE(records), &written);\n+  ASSERT(written == ARRAY_SIZE(records));\n+  make_key_event_records(VK_NUMPAD8, LEFT_ALT_PRESSED, FALSE, records);\n+  WriteConsoleInputW(handle, records, ARRAY_SIZE(records), &written);\n+  ASSERT(written == ARRAY_SIZE(records));\n+  WriteConsoleInputW(handle, &alt_records[1], 1, &written);\n+\n+  uv_run(loop, UV_RUN_DEFAULT);\n+\n+  MAKE_VALGRIND_HAPPY();\n+  return 0;\n+}\n+\n+#else\n+\n+typedef int file_has_no_tests;  /* ISO C forbids an empty translation unit. */\n+\n+#endif  /* ifndef _WIN32 */"
        },
        {
            "sha": "8fc6cca140dc7ef8632f22e3306677650ab8c16f",
            "filename": "deps/uv/test/test.gyp",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/0109e121d3a2f87c4bad75ac05436b56c9fd3407/deps%2Fuv%2Ftest%2Ftest.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest.gyp?ref=0109e121d3a2f87c4bad75ac05436b56c9fd3407",
            "patch": "@@ -133,6 +133,7 @@\n         'test-timer-again.c',\n         'test-timer-from-check.c',\n         'test-timer.c',\n+        'test-tty-duplicate-key.c',\n         'test-tty.c',\n         'test-udp-alloc-cb-fail.c',\n         'test-udp-bind.c',"
        }
    ],
    "stats": {
        "total": 671,
        "additions": 613,
        "deletions": 58
    }
}