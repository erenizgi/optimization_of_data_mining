{
    "author": "jasnell",
    "message": "test: use module.exports consistently\n\nPR-URL: https://github.com/nodejs/node/pull/22557\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Weijia Wang <starkwang@126.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "25d29da10adfa00cb10e7ff89535749453add775",
    "files": [
        {
            "sha": "e522a71b4748d851c8d2983c926ce38b6fecfebe",
            "filename": "test/common/shared-lib-util.js",
            "status": "modified",
            "additions": 24,
            "deletions": 20,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/25d29da10adfa00cb10e7ff89535749453add775/test%2Fcommon%2Fshared-lib-util.js",
            "raw_url": "https://github.com/nodejs/node/raw/25d29da10adfa00cb10e7ff89535749453add775/test%2Fcommon%2Fshared-lib-util.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Fshared-lib-util.js?ref=25d29da10adfa00cb10e7ff89535749453add775",
            "patch": "@@ -2,48 +2,52 @@\n const common = require('../common');\n const path = require('path');\n \n+const kNodeShared = Boolean(process.config.variables.node_shared);\n+const kShlibSuffix = process.config.variables.shlib_suffix;\n+const kExecPath = path.dirname(process.execPath);\n+\n // If node executable is linked to shared lib, need to take care about the\n // shared lib path.\n-exports.addLibraryPath = function(env) {\n-  if (!process.config.variables.node_shared) {\n+function addLibraryPath(env) {\n+  if (!kNodeShared) {\n     return;\n   }\n \n   env = env || process.env;\n \n   env.LD_LIBRARY_PATH =\n     (env.LD_LIBRARY_PATH ? env.LD_LIBRARY_PATH + path.delimiter : '') +\n-    path.join(path.dirname(process.execPath), 'lib.target');\n+    path.join(kExecPath, 'lib.target');\n   // For AIX.\n   env.LIBPATH =\n     (env.LIBPATH ? env.LIBPATH + path.delimiter : '') +\n-    path.join(path.dirname(process.execPath), 'lib.target');\n+    path.join(kExecPath, 'lib.target');\n   // For Mac OSX.\n   env.DYLD_LIBRARY_PATH =\n     (env.DYLD_LIBRARY_PATH ? env.DYLD_LIBRARY_PATH + path.delimiter : '') +\n-    path.dirname(process.execPath);\n+    kExecPath;\n   // For Windows.\n-  env.PATH =\n-    (env.PATH ? env.PATH + path.delimiter : '') +\n-    path.dirname(process.execPath);\n-};\n+  env.PATH = (env.PATH ? env.PATH + path.delimiter : '') + kExecPath;\n+}\n \n // Get the full path of shared lib.\n-exports.getSharedLibPath = function() {\n+function getSharedLibPath() {\n   if (common.isWindows) {\n-    return path.join(path.dirname(process.execPath), 'node.dll');\n+    return path.join(kExecPath, 'node.dll');\n   } else if (common.isOSX) {\n-    return path.join(path.dirname(process.execPath),\n-                     `libnode.${process.config.variables.shlib_suffix}`);\n+    return path.join(kExecPath, `libnode.${kShlibSuffix}`);\n   } else {\n-    return path.join(path.dirname(process.execPath),\n-                     'lib.target',\n-                     `libnode.${process.config.variables.shlib_suffix}`);\n+    return path.join(kExecPath, 'lib.target', `libnode.${kShlibSuffix}`);\n   }\n-};\n+}\n \n // Get the binary path of stack frames.\n-exports.getBinaryPath = function() {\n-  return process.config.variables.node_shared ?\n-    exports.getSharedLibPath() : process.execPath;\n+function getBinaryPath() {\n+  return kNodeShared ? getSharedLibPath() : process.execPath;\n+}\n+\n+module.exports = {\n+  addLibraryPath,\n+  getBinaryPath,\n+  getSharedLibPath\n };"
        },
        {
            "sha": "ca761b7f94a64217c859539f021e9b1e1aeda949",
            "filename": "test/common/tmpdir.js",
            "status": "modified",
            "additions": 10,
            "deletions": 4,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/25d29da10adfa00cb10e7ff89535749453add775/test%2Fcommon%2Ftmpdir.js",
            "raw_url": "https://github.com/nodejs/node/raw/25d29da10adfa00cb10e7ff89535749453add775/test%2Fcommon%2Ftmpdir.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Ftmpdir.js?ref=25d29da10adfa00cb10e7ff89535749453add775",
            "patch": "@@ -59,9 +59,15 @@ let tmpdirName = '.tmp';\n if (process.env.TEST_THREAD_ID) {\n   tmpdirName += `.${process.env.TEST_THREAD_ID}`;\n }\n-exports.path = path.join(testRoot, tmpdirName);\n \n-exports.refresh = () => {\n-  rimrafSync(exports.path);\n-  fs.mkdirSync(exports.path);\n+const tmpPath = path.join(testRoot, tmpdirName);\n+\n+function refresh() {\n+  rimrafSync(this.path);\n+  fs.mkdirSync(this.path);\n+}\n+\n+module.exports = {\n+  path: tmpPath,\n+  refresh\n };"
        }
    ],
    "stats": {
        "total": 58,
        "additions": 34,
        "deletions": 24
    }
}