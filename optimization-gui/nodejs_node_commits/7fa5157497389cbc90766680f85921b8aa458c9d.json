{
    "author": "addaleax",
    "message": "module: do not use `process.exit()`\n\nInside workers, using stdio is always asynchronous, so using\n`process.exit()` always interrupts sending of messages to the\nparent thread, including error messages presented over stdio.\n\nDo not use `process.exit()` and instead trigger a “real”\nuncaught exception.\n\nPR-URL: https://github.com/nodejs/node/pull/25769\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Michaël Zasso <targos@protonmail.com>\nReviewed-By: Guy Bedford <guybedford@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "7fa5157497389cbc90766680f85921b8aa458c9d",
    "files": [
        {
            "sha": "3405ef43229bcc724ce233f0ed0911a4b5f67410",
            "filename": "lib/internal/modules/cjs/loader.js",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/7fa5157497389cbc90766680f85921b8aa458c9d/lib%2Finternal%2Fmodules%2Fcjs%2Floader.js",
            "raw_url": "https://github.com/nodejs/node/raw/7fa5157497389cbc90766680f85921b8aa458c9d/lib%2Finternal%2Fmodules%2Fcjs%2Floader.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fmodules%2Fcjs%2Floader.js?ref=7fa5157497389cbc90766680f85921b8aa458c9d",
            "patch": "@@ -60,14 +60,12 @@ module.exports = Module;\n let asyncESM;\n let ModuleJob;\n let createDynamicModule;\n-let decorateErrorStack;\n \n function lazyLoadESM() {\n   asyncESM = require('internal/process/esm_loader');\n   ModuleJob = require('internal/modules/esm/module_job');\n   createDynamicModule = require(\n     'internal/modules/esm/create_dynamic_module');\n-  decorateErrorStack = require('internal/util').decorateErrorStack;\n }\n \n const {\n@@ -794,9 +792,7 @@ Module.runMain = function() {\n       return loader.import(pathToFileURL(process.argv[1]).pathname);\n     })\n     .catch((e) => {\n-      decorateErrorStack(e);\n-      console.error(e);\n-      process.exit(1);\n+      internalBinding('util').triggerFatalException(e);\n     });\n   } else {\n     Module._load(process.argv[1], null, true);"
        },
        {
            "sha": "8d2cf8f3f3e6c5f454cb7b6b9973832ad432242b",
            "filename": "test/parallel/test-worker-esm-missing-main.js",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/7fa5157497389cbc90766680f85921b8aa458c9d/test%2Fparallel%2Ftest-worker-esm-missing-main.js",
            "raw_url": "https://github.com/nodejs/node/raw/7fa5157497389cbc90766680f85921b8aa458c9d/test%2Fparallel%2Ftest-worker-esm-missing-main.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-worker-esm-missing-main.js?ref=7fa5157497389cbc90766680f85921b8aa458c9d",
            "patch": "@@ -0,0 +1,13 @@\n+'use strict';\n+const common = require('../common');\n+const assert = require('assert');\n+const { Worker } = require('worker_threads');\n+\n+const worker = new Worker('./does-not-exist.js', {\n+  execArgv: ['--experimental-modules'],\n+});\n+\n+worker.on('error', common.mustCall((err) => {\n+  // eslint-disable-next-line node-core/no-unescaped-regexp-dot\n+  assert(/Cannot find module .+does-not-exist.js/.test(err.message), err);\n+}));"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 14,
        "deletions": 5
    }
}