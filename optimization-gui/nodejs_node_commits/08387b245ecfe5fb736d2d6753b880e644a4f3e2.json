{
    "author": "sam-github",
    "message": "tls: remove unused ocsp extension parsing\n\nThe OCSP info from parsing the TLS ClientHello has not been used since\n550c263, remove it.\n\nSee: https://github.com/nodejs/node/pull/1464\n\nPR-URL: https://github.com/nodejs/node/pull/25153\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>",
    "sha": "08387b245ecfe5fb736d2d6753b880e644a4f3e2",
    "files": [
        {
            "sha": "8d5ac869196318ce5157d02f900f18a8d37f0f8f",
            "filename": "src/node_crypto.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/08387b245ecfe5fb736d2d6753b880e644a4f3e2/src%2Fnode_crypto.cc",
            "raw_url": "https://github.com/nodejs/node/raw/08387b245ecfe5fb736d2d6753b880e644a4f3e2/src%2Fnode_crypto.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto.cc?ref=08387b245ecfe5fb736d2d6753b880e644a4f3e2",
            "patch": "@@ -1559,9 +1559,6 @@ void SSLWrap<Base>::OnClientHello(void* arg,\n   hello_obj->Set(context,\n                  env->tls_ticket_string(),\n                  Boolean::New(env->isolate(), hello.has_ticket())).FromJust();\n-  hello_obj->Set(context,\n-                 env->ocsp_request_string(),\n-                 Boolean::New(env->isolate(), hello.ocsp_request())).FromJust();\n \n   Local<Value> argv[] = { hello_obj };\n   w->MakeCallback(env->onclienthello_string(), arraysize(argv), argv);"
        },
        {
            "sha": "1262186a9277d20baa1265e9301d35559c53baf2",
            "filename": "src/node_crypto_clienthello-inl.h",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/08387b245ecfe5fb736d2d6753b880e644a4f3e2/src%2Fnode_crypto_clienthello-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/08387b245ecfe5fb736d2d6753b880e644a4f3e2/src%2Fnode_crypto_clienthello-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto_clienthello-inl.h?ref=08387b245ecfe5fb736d2d6753b880e644a4f3e2",
            "patch": "@@ -48,7 +48,6 @@ inline void ClientHelloParser::Reset() {\n   tls_ticket_ = nullptr;\n   servername_size_ = 0;\n   servername_ = nullptr;\n-  ocsp_request_ = 0;\n }\n \n inline void ClientHelloParser::Start(ClientHelloParser::OnHelloCb onhello_cb,"
        },
        {
            "sha": "b037575577431829a14d9f7ee2158bcc86a45584",
            "filename": "src/node_crypto_clienthello.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 13,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/08387b245ecfe5fb736d2d6753b880e644a4f3e2/src%2Fnode_crypto_clienthello.cc",
            "raw_url": "https://github.com/nodejs/node/raw/08387b245ecfe5fb736d2d6753b880e644a4f3e2/src%2Fnode_crypto_clienthello.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto_clienthello.cc?ref=08387b245ecfe5fb736d2d6753b880e644a4f3e2",
            "patch": "@@ -112,7 +112,6 @@ void ClientHelloParser::ParseHeader(const uint8_t* data, size_t avail) {\n   hello.session_id_ = session_id_;\n   hello.session_size_ = session_size_;\n   hello.has_ticket_ = tls_ticket_ != nullptr && tls_ticket_size_ != 0;\n-  hello.ocsp_request_ = ocsp_request_;\n   hello.servername_ = servername_;\n   hello.servername_size_ = static_cast<uint8_t>(servername_size_);\n   onhello_cb_(cb_arg_, hello);\n@@ -149,18 +148,6 @@ void ClientHelloParser::ParseExtension(const uint16_t type,\n         }\n       }\n       break;\n-    case kStatusRequest:\n-      // We are ignoring any data, just indicating the presence of extension\n-      if (len < kMinStatusRequestSize)\n-        return;\n-\n-      // Unknown type, ignore it\n-      if (data[0] != kStatusRequestOCSP)\n-        break;\n-\n-      // Ignore extensions, they won't work with caching on backend anyway\n-      ocsp_request_ = 1;\n-      break;\n     case kTLSSessionTicket:\n       tls_ticket_size_ = len;\n       tls_ticket_ = data + len;"
        },
        {
            "sha": "2ced72c4e8d1e6c2567ef50deccc6f7e87a1f4ca",
            "filename": "src/node_crypto_clienthello.h",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/08387b245ecfe5fb736d2d6753b880e644a4f3e2/src%2Fnode_crypto_clienthello.h",
            "raw_url": "https://github.com/nodejs/node/raw/08387b245ecfe5fb736d2d6753b880e644a4f3e2/src%2Fnode_crypto_clienthello.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto_clienthello.h?ref=08387b245ecfe5fb736d2d6753b880e644a4f3e2",
            "patch": "@@ -41,15 +41,13 @@ class ClientHelloParser {\n     inline bool has_ticket() const { return has_ticket_; }\n     inline uint8_t servername_size() const { return servername_size_; }\n     inline const uint8_t* servername() const { return servername_; }\n-    inline int ocsp_request() const { return ocsp_request_; }\n \n    private:\n     uint8_t session_size_;\n     const uint8_t* session_id_;\n     bool has_ticket_;\n     uint8_t servername_size_;\n     const uint8_t* servername_;\n-    int ocsp_request_;\n \n     friend class ClientHelloParser;\n   };\n@@ -69,7 +67,6 @@ class ClientHelloParser {\n   static const size_t kMaxTLSFrameLen = 16 * 1024 + 5;\n   static const size_t kMaxSSLExFrameLen = 32 * 1024;\n   static const uint8_t kServernameHostname = 0;\n-  static const uint8_t kStatusRequestOCSP = 1;\n   static const size_t kMinStatusRequestSize = 5;\n \n   enum ParseState {\n@@ -93,7 +90,6 @@ class ClientHelloParser {\n \n   enum ExtensionType {\n     kServerName = 0,\n-    kStatusRequest = 5,\n     kTLSSessionTicket = 35\n   };\n \n@@ -115,7 +111,6 @@ class ClientHelloParser {\n   const uint8_t* session_id_ = nullptr;\n   uint16_t servername_size_ = 0;\n   const uint8_t* servername_ = nullptr;\n-  uint8_t ocsp_request_ = 0;\n   uint16_t tls_ticket_size_ = -1;\n   const uint8_t* tls_ticket_ = nullptr;\n };"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 0,
        "deletions": 22
    }
}