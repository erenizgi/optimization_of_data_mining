{
    "author": "ZYSzys",
    "message": "vm: reuse validateString of internal/validators\n\nPR-URL: https://github.com/nodejs/node/pull/25074\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Anto Aravinth <anto.aravinth.cse@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Daijiro Wachi <daijiro.wachi@gmail.com>",
    "sha": "e5966ef60c24609c1bd716742836dc40be64db0b",
    "files": [
        {
            "sha": "e50b08d336b9b5517b0b22a963358b8f1cf1adfe",
            "filename": "lib/vm.js",
            "status": "modified",
            "additions": 16,
            "deletions": 26,
            "changes": 42,
            "blob_url": "https://github.com/nodejs/node/blob/e5966ef60c24609c1bd716742836dc40be64db0b/lib%2Fvm.js",
            "raw_url": "https://github.com/nodejs/node/raw/e5966ef60c24609c1bd716742836dc40be64db0b/lib%2Fvm.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fvm.js?ref=e5966ef60c24609c1bd716742836dc40be64db0b",
            "patch": "@@ -33,7 +33,11 @@ const {\n   ERR_VM_MODULE_NOT_MODULE,\n } = require('internal/errors').codes;\n const { isModuleNamespaceObject, isArrayBufferView } = require('util').types;\n-const { validateInt32, validateUint32 } = require('internal/validators');\n+const {\n+  validateInt32,\n+  validateUint32,\n+  validateString\n+} = require('internal/validators');\n const kParsingContext = Symbol('script parsing context');\n \n const ArrayForEach = Function.call.bind(Array.prototype.forEach);\n@@ -58,9 +62,7 @@ class Script extends ContextifyScript {\n       [kParsingContext]: parsingContext,\n     } = options;\n \n-    if (typeof filename !== 'string') {\n-      throw new ERR_INVALID_ARG_TYPE('options.filename', 'string', filename);\n-    }\n+    validateString(filename, 'options.filename');\n     validateInt32(lineOffset, 'options.lineOffset');\n     validateInt32(columnOffset, 'options.columnOffset');\n     if (cachedData !== undefined && !isArrayBufferView(cachedData)) {\n@@ -149,11 +151,6 @@ function validateContext(sandbox) {\n   }\n }\n \n-function validateString(prop, propName) {\n-  if (prop !== undefined && typeof prop !== 'string')\n-    throw new ERR_INVALID_ARG_TYPE(propName, 'string', prop);\n-}\n-\n function validateBool(prop, propName) {\n   if (prop !== undefined && typeof prop !== 'boolean')\n     throw new ERR_INVALID_ARG_TYPE(propName, 'boolean', prop);\n@@ -208,8 +205,10 @@ function getContextOptions(options) {\n         wasm: options.contextCodeGeneration.wasm,\n       } : undefined,\n     };\n-    validateString(contextOptions.name, 'options.contextName');\n-    validateString(contextOptions.origin, 'options.contextOrigin');\n+    if (contextOptions.name !== undefined)\n+      validateString(contextOptions.name, 'options.contextName');\n+    if (contextOptions.origin !== undefined)\n+      validateString(contextOptions.origin, 'options.contextOrigin');\n     if (contextOptions.codeGeneration) {\n       validateBool(contextOptions.codeGeneration.strings,\n                    'options.contextCodeGeneration.strings');\n@@ -244,10 +243,9 @@ function createContext(sandbox = {}, options = {}) {\n     codeGeneration\n   } = options;\n \n-  if (typeof name !== 'string') {\n-    throw new ERR_INVALID_ARG_TYPE('options.name', 'string', options.name);\n-  }\n-  validateString(origin, 'options.origin');\n+  validateString(name, 'options.name');\n+  if (origin !== undefined)\n+    validateString(origin, 'options.origin');\n   validateObject(codeGeneration, 'options.codeGeneration');\n \n   let strings = true;\n@@ -319,18 +317,12 @@ function runInThisContext(code, options) {\n }\n \n function compileFunction(code, params, options = {}) {\n-  if (typeof code !== 'string') {\n-    throw new ERR_INVALID_ARG_TYPE('code', 'string', code);\n-  }\n+  validateString(code, 'code');\n   if (params !== undefined) {\n     if (!ArrayIsArray(params)) {\n       throw new ERR_INVALID_ARG_TYPE('params', 'Array', params);\n     }\n-    ArrayForEach(params, (param, i) => {\n-      if (typeof param !== 'string') {\n-        throw new ERR_INVALID_ARG_TYPE(`params[${i}]`, 'string', param);\n-      }\n-    });\n+    ArrayForEach(params, (param, i) => validateString(param, `params[${i}]`));\n   }\n \n   const {\n@@ -343,9 +335,7 @@ function compileFunction(code, params, options = {}) {\n     contextExtensions = [],\n   } = options;\n \n-  if (typeof filename !== 'string') {\n-    throw new ERR_INVALID_ARG_TYPE('options.filename', 'string', filename);\n-  }\n+  validateString(filename, 'options.filename');\n   validateUint32(columnOffset, 'options.columnOffset');\n   validateUint32(lineOffset, 'options.lineOffset');\n   if (cachedData !== undefined && !isArrayBufferView(cachedData)) {"
        }
    ],
    "stats": {
        "total": 42,
        "additions": 16,
        "deletions": 26
    }
}