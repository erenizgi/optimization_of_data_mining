{
    "author": "ofrobots",
    "message": "src: deprecate legacy node::MakeCallback\n\nThe legacy MakeCallback functions do not provide a mechanism to\npropagate async context. This means that any native modules using these\ndirectly is likely breaking async debugging & tracing tools. For\nexample it is possible that such a module will cause incorrect async\nstack traces to be reported (even when the module is not on the stack).\n\nThe new MakeCallback allow the user to specify the async context in\nwhich the callback is to be executed.\n\nRef: https://github.com/nodejs/node/issues/13254\nPR-URL: https://github.com/nodejs/node/pull/18632\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Evan Lucas <evanlucas@me.com>\nReviewed-By: Jan Krems <jan.krems@gmail.com>\nReviewed-By: Andreas Madsen <amwebdk@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Gibson Fahnestock <gibfahn@gmail.com>",
    "sha": "efb32592e1b78ec2559e1a409faa049e756a9501",
    "files": [
        {
            "sha": "d1751cdff661807ea331ef87ded6d01bd4997c03",
            "filename": "doc/api/deprecations.md",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/efb32592e1b78ec2559e1a409faa049e756a9501/doc%2Fapi%2Fdeprecations.md",
            "raw_url": "https://github.com/nodejs/node/raw/efb32592e1b78ec2559e1a409faa049e756a9501/doc%2Fapi%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fdeprecations.md?ref=efb32592e1b78ec2559e1a409faa049e756a9501",
            "patch": "@@ -893,6 +893,15 @@ Use [`asyncResource.runInAsyncScope()`][] API instead which provides a much\n safer, and more convenient, alternative. See\n https://github.com/nodejs/node/pull/18513 for more details.\n \n+<a id=\"DEP0098\"></a>\n+### DEP0098: async context-unaware node::MakeCallback C++ APIs\n+\n+Type: Compile-time\n+\n+Certain versions of `node::MakeCallback` APIs available to native modules are\n+deprecated. Please use the versions of the API that accept an `async_context`\n+parameter.\n+\n [`--pending-deprecation`]: cli.html#cli_pending_deprecation\n [`Buffer.allocUnsafeSlow(size)`]: buffer.html#buffer_class_method_buffer_allocunsafeslow_size\n [`Buffer.from(array)`]: buffer.html#buffer_class_method_buffer_from_array"
        },
        {
            "sha": "cb4346893014ef794eea9984192fd1328cbe7ba8",
            "filename": "src/node.h",
            "status": "modified",
            "additions": 22,
            "deletions": 19,
            "changes": 41,
            "blob_url": "https://github.com/nodejs/node/blob/efb32592e1b78ec2559e1a409faa049e756a9501/src%2Fnode.h",
            "raw_url": "https://github.com/nodejs/node/raw/efb32592e1b78ec2559e1a409faa049e756a9501/src%2Fnode.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.h?ref=efb32592e1b78ec2559e1a409faa049e756a9501",
            "patch": "@@ -151,27 +151,30 @@ inline v8::Local<v8::Value> UVException(int errorno,\n  * These methods need to be called in a HandleScope.\n  *\n  * It is preferred that you use the `MakeCallback` overloads taking\n- * `async_id` arguments.\n+ * `async_context` arguments.\n  */\n \n-NODE_EXTERN v8::Local<v8::Value> MakeCallback(\n-    v8::Isolate* isolate,\n-    v8::Local<v8::Object> recv,\n-    const char* method,\n-    int argc,\n-    v8::Local<v8::Value>* argv);\n-NODE_EXTERN v8::Local<v8::Value> MakeCallback(\n-    v8::Isolate* isolate,\n-    v8::Local<v8::Object> recv,\n-    v8::Local<v8::String> symbol,\n-    int argc,\n-    v8::Local<v8::Value>* argv);\n-NODE_EXTERN v8::Local<v8::Value> MakeCallback(\n-    v8::Isolate* isolate,\n-    v8::Local<v8::Object> recv,\n-    v8::Local<v8::Function> callback,\n-    int argc,\n-    v8::Local<v8::Value>* argv);\n+NODE_DEPRECATED(\"Use MakeCallback(..., async_context)\",\n+                NODE_EXTERN v8::Local<v8::Value> MakeCallback(\n+                    v8::Isolate* isolate,\n+                    v8::Local<v8::Object> recv,\n+                    const char* method,\n+                    int argc,\n+                    v8::Local<v8::Value>* argv));\n+NODE_DEPRECATED(\"Use MakeCallback(..., async_context)\",\n+                NODE_EXTERN v8::Local<v8::Value> MakeCallback(\n+                    v8::Isolate* isolate,\n+                    v8::Local<v8::Object> recv,\n+                    v8::Local<v8::String> symbol,\n+                    int argc,\n+                    v8::Local<v8::Value>* argv));\n+NODE_DEPRECATED(\"Use MakeCallback(..., async_context)\",\n+                NODE_EXTERN v8::Local<v8::Value> MakeCallback(\n+                    v8::Isolate* isolate,\n+                    v8::Local<v8::Object> recv,\n+                    v8::Local<v8::Function> callback,\n+                    int argc,\n+                    v8::Local<v8::Value>* argv));\n \n }  // namespace node\n "
        }
    ],
    "stats": {
        "total": 50,
        "additions": 31,
        "deletions": 19
    }
}