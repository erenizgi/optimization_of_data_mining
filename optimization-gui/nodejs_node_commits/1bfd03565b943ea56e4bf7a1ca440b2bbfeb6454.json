{
    "author": "edevil",
    "message": "http2: don't send trailers on a closed connection\n\nThere is a race condition between onStreamCloseResponse(), which\nremoves the wantTrailers listener, and Http2Stream.close(), which\nwill invalidate the connection. IE, sendTrailers can be called on\na closed connection which would crash with a:\nError [ERR_HTTP2_INVALID_STREAM]: The stream has been destroyed\n\nPR-URL: https://github.com/nodejs/node/pull/23146\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "1bfd03565b943ea56e4bf7a1ca440b2bbfeb6454",
    "files": [
        {
            "sha": "a772fb277d77670483c12ff8e679fb7d8fb3fd01",
            "filename": "lib/internal/http2/core.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1bfd03565b943ea56e4bf7a1ca440b2bbfeb6454/lib%2Finternal%2Fhttp2%2Fcore.js",
            "raw_url": "https://github.com/nodejs/node/raw/1bfd03565b943ea56e4bf7a1ca440b2bbfeb6454/lib%2Finternal%2Fhttp2%2Fcore.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fhttp2%2Fcore.js?ref=1bfd03565b943ea56e4bf7a1ca440b2bbfeb6454",
            "patch": "@@ -330,7 +330,7 @@ function tryClose(fd) {\n function onStreamTrailers() {\n   const stream = this[kOwner];\n   stream[kState].trailersReady = true;\n-  if (stream.destroyed)\n+  if (stream.destroyed || stream.closed)\n     return;\n   if (!stream.emit('wantTrailers')) {\n     // There are no listeners, send empty trailing HEADERS frame and close."
        }
    ],
    "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    }
}