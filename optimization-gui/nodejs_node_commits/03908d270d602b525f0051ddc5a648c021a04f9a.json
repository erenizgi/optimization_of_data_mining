{
    "author": "addaleax",
    "message": "src: pass along errors from tls object creation\n\nPR-URL: https://github.com/nodejs/node/pull/25822\nReviewed-By: Gireesh Punathil <gpunathi@in.ibm.com>",
    "sha": "03908d270d602b525f0051ddc5a648c021a04f9a",
    "files": [
        {
            "sha": "df6bb9c56fd2ee37ea6f45a017a01ea8d7bda273",
            "filename": "src/tls_wrap.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 5,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/03908d270d602b525f0051ddc5a648c021a04f9a/src%2Ftls_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/03908d270d602b525f0051ddc5a648c021a04f9a/src%2Ftls_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftls_wrap.cc?ref=03908d270d602b525f0051ddc5a648c021a04f9a",
            "patch": "@@ -49,13 +49,11 @@ using v8::String;\n using v8::Value;\n \n TLSWrap::TLSWrap(Environment* env,\n+                 Local<Object> obj,\n                  Kind kind,\n                  StreamBase* stream,\n                  SecureContext* sc)\n-    : AsyncWrap(env,\n-                env->tls_wrap_constructor_function()\n-                    ->NewInstance(env->context()).ToLocalChecked(),\n-                AsyncWrap::PROVIDER_TLSWRAP),\n+    : AsyncWrap(env, obj, AsyncWrap::PROVIDER_TLSWRAP),\n       SSLWrap<TLSWrap>(env, sc, kind),\n       StreamBase(env),\n       sc_(sc) {\n@@ -160,7 +158,14 @@ void TLSWrap::Wrap(const FunctionCallbackInfo<Value>& args) {\n   StreamBase* stream = static_cast<StreamBase*>(stream_obj->Value());\n   CHECK_NOT_NULL(stream);\n \n-  TLSWrap* res = new TLSWrap(env, kind, stream, Unwrap<SecureContext>(sc));\n+  Local<Object> obj;\n+  if (!env->tls_wrap_constructor_function()\n+           ->NewInstance(env->context())\n+           .ToLocal(&obj)) {\n+    return;\n+  }\n+\n+  TLSWrap* res = new TLSWrap(env, obj, kind, stream, Unwrap<SecureContext>(sc));\n \n   args.GetReturnValue().Set(res->object());\n }"
        },
        {
            "sha": "be694526abf203a51d2f786017f60e968b8f2760",
            "filename": "src/tls_wrap.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/03908d270d602b525f0051ddc5a648c021a04f9a/src%2Ftls_wrap.h",
            "raw_url": "https://github.com/nodejs/node/raw/03908d270d602b525f0051ddc5a648c021a04f9a/src%2Ftls_wrap.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftls_wrap.h?ref=03908d270d602b525f0051ddc5a648c021a04f9a",
            "patch": "@@ -108,6 +108,7 @@ class TLSWrap : public AsyncWrap,\n   static const int kSimultaneousBufferCount = 10;\n \n   TLSWrap(Environment* env,\n+          v8::Local<v8::Object> obj,\n           Kind kind,\n           StreamBase* stream,\n           crypto::SecureContext* sc);"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 11,
        "deletions": 5
    }
}