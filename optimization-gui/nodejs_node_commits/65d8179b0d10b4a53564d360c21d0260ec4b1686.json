{
    "author": "BridgeAR",
    "message": "buffer: simplify code\n\nThis refactors some code for simplicity. It also removes a call\nindirection used in the buffers custom inspect function.\n\nPR-URL: https://github.com/nodejs/node/pull/25151\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Masashi Hirano <shisama07@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "65d8179b0d10b4a53564d360c21d0260ec4b1686",
    "files": [
        {
            "sha": "ed3928b1b4a537caa1e7402efcf06cb5f7b17c8b",
            "filename": "lib/buffer.js",
            "status": "modified",
            "additions": 16,
            "deletions": 19,
            "changes": 35,
            "blob_url": "https://github.com/nodejs/node/blob/65d8179b0d10b4a53564d360c21d0260ec4b1686/lib%2Fbuffer.js",
            "raw_url": "https://github.com/nodejs/node/raw/65d8179b0d10b4a53564d360c21d0260ec4b1686/lib%2Fbuffer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fbuffer.js?ref=65d8179b0d10b4a53564d360c21d0260ec4b1686",
            "patch": "@@ -296,11 +296,13 @@ Buffer.allocUnsafeSlow = function allocUnsafeSlow(size) {\n // If --zero-fill-buffers command line argument is set, a zero-filled\n // buffer is returned.\n function SlowBuffer(length) {\n+  const len = +length;\n   // eslint-disable-next-line eqeqeq\n-  if (+length != length)\n+  if (len != length)\n     length = 0;\n-  assertSize(+length);\n-  return createUnsafeBuffer(+length);\n+  else\n+    assertSize(len);\n+  return createUnsafeBuffer(len);\n }\n \n Object.setPrototypeOf(SlowBuffer.prototype, Uint8Array.prototype);\n@@ -317,9 +319,8 @@ function allocate(size) {\n     poolOffset += size;\n     alignPool();\n     return b;\n-  } else {\n-    return createUnsafeBuffer(size);\n   }\n+  return createUnsafeBuffer(size);\n }\n \n function fromString(string, encoding) {\n@@ -637,21 +638,18 @@ Buffer.prototype.toString = function toString(encoding, start, end) {\n   }\n \n   const len = this.length;\n-  if (len === 0)\n-    return '';\n \n-  if (!start || start < 0)\n+  if (start <= 0)\n     start = 0;\n   else if (start >= len)\n     return '';\n+  else\n+    start |= 0;\n \n   if (end === undefined || end > len)\n     end = len;\n-  else if (end <= 0)\n-    return '';\n-\n-  start |= 0;\n-  end |= 0;\n+  else\n+    end |= 0;\n \n   if (end <= start)\n     return '';\n@@ -670,10 +668,10 @@ Buffer.prototype.equals = function equals(otherBuffer) {\n };\n \n // Override how buffers are presented by util.inspect().\n-Buffer.prototype[customInspectSymbol] = function inspect() {\n-  var str = '';\n-  var max = exports.INSPECT_MAX_BYTES;\n-  str = this.toString('hex', 0, max).replace(/(.{2})/g, '$1 ').trim();\n+Buffer.prototype[customInspectSymbol] = function inspect(recurseTimes, ctx) {\n+  const max = exports.INSPECT_MAX_BYTES;\n+  const actualMax = Math.min(max, this.length);\n+  let str = this.hexSlice(0, actualMax).replace(/(.{2})/g, '$1 ').trim();\n   const remaining = this.length - max;\n   if (remaining > 0)\n     str += ` ... ${remaining} more byte${remaining > 1 ? 's' : ''}`;\n@@ -975,9 +973,8 @@ Buffer.prototype.toJSON = function toJSON() {\n     for (var i = 0; i < this.length; ++i)\n       data[i] = this[i];\n     return { type: 'Buffer', data };\n-  } else {\n-    return { type: 'Buffer', data: [] };\n   }\n+  return { type: 'Buffer', data: [] };\n };\n \n function adjustOffset(offset, length) {"
        }
    ],
    "stats": {
        "total": 35,
        "additions": 16,
        "deletions": 19
    }
}