{
    "author": "XadillaX",
    "message": "test: check endless loop while writing empty string\n\nRefs: https://github.com/nodejs/node/pull/18673\nPR-URL: https://github.com/nodejs/node/pull/18924\nRefs: https://github.com/nodejs/node/pull/18673\nRefs: https://github.com/nodejs/node/blob/v9.5.0/src/node_http2.cc#L1481-L1484\nRefs: https://github.com/nodejs/node/blob/v9.5.0/lib/_http_outgoing.js#L659-L661\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "16facd7ef48b9d43af02009524983b05901dc26b",
    "files": [
        {
            "sha": "c10698d417038d5f6271d1798dcc02c954d720ab",
            "filename": "test/parallel/test-http2-client-write-empty-string.js",
            "status": "added",
            "additions": 54,
            "deletions": 0,
            "changes": 54,
            "blob_url": "https://github.com/nodejs/node/blob/16facd7ef48b9d43af02009524983b05901dc26b/test%2Fparallel%2Ftest-http2-client-write-empty-string.js",
            "raw_url": "https://github.com/nodejs/node/raw/16facd7ef48b9d43af02009524983b05901dc26b/test%2Fparallel%2Ftest-http2-client-write-empty-string.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http2-client-write-empty-string.js?ref=16facd7ef48b9d43af02009524983b05901dc26b",
            "patch": "@@ -0,0 +1,54 @@\n+'use strict';\n+\n+const assert = require('assert');\n+const http2 = require('http2');\n+\n+const common = require('../common');\n+if (!common.hasCrypto)\n+  common.skip('missing crypto');\n+\n+for (const chunkSequence of [\n+  [ '' ],\n+  [ '', '' ]\n+]) {\n+  const server = http2.createServer();\n+  server.on('stream', common.mustCall((stream, headers, flags) => {\n+    stream.respond({ 'content-type': 'text/html' });\n+\n+    let data = '';\n+    stream.on('data', common.mustNotCall((chunk) => {\n+      data += chunk.toString();\n+    }));\n+    stream.on('end', common.mustCall(() => {\n+      stream.end(`\"${data}\"`);\n+    }));\n+  }));\n+\n+  server.listen(0, common.mustCall(() => {\n+    const port = server.address().port;\n+    const client = http2.connect(`http://localhost:${port}`);\n+\n+    const req = client.request({\n+      ':method': 'POST',\n+      ':path': '/'\n+    });\n+\n+    req.on('response', common.mustCall((headers) => {\n+      assert.strictEqual(headers[':status'], 200);\n+      assert.strictEqual(headers['content-type'], 'text/html');\n+    }));\n+\n+    let data = '';\n+    req.setEncoding('utf8');\n+    req.on('data', common.mustCallAtLeast((d) => data += d));\n+    req.on('end', common.mustCall(() => {\n+      assert.strictEqual(data, '\"\"');\n+      server.close();\n+      client.close();\n+    }));\n+\n+    for (const chunk of chunkSequence)\n+      req.write(chunk);\n+    req.end();\n+  }));\n+}"
        }
    ],
    "stats": {
        "total": 54,
        "additions": 54,
        "deletions": 0
    }
}