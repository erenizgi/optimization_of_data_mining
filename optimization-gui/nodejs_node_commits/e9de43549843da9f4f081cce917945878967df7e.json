{
    "author": "suguru03",
    "message": "timers: fix setTimeout expiration logic\n\nFix the timer logic to be the same as v10.30.0.\n\nFixes: https://github.com/nodejs/node/issues/24203\n\nPR-URL: https://github.com/nodejs/node/pull/24214\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Jeremiah Senkpiel <fishrock123@rocketmail.com>",
    "sha": "e9de43549843da9f4f081cce917945878967df7e",
    "files": [
        {
            "sha": "1531cd1fb607262541b1df98cb7c56374e311154",
            "filename": "lib/timers.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/e9de43549843da9f4f081cce917945878967df7e/lib%2Ftimers.js",
            "raw_url": "https://github.com/nodejs/node/raw/e9de43549843da9f4f081cce917945878967df7e/lib%2Ftimers.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ftimers.js?ref=e9de43549843da9f4f081cce917945878967df7e",
            "patch": "@@ -283,7 +283,7 @@ function listOnTimeout(list, now) {\n     // Check if this loop iteration is too early for the next timer.\n     // This happens if there are more timers scheduled for later in the list.\n     if (diff < msecs) {\n-      list.expiry = timer._idleStart + msecs;\n+      list.expiry = Math.max(timer._idleStart + msecs, now + 1);\n       list.id = timerListId++;\n       queue.percolateDown(1);\n       debug('%d list wait because diff is %d', msecs, diff);"
        },
        {
            "sha": "96efc69e5096fd3a01e5757e29ada9ef441b34a0",
            "filename": "test/parallel/test-timers-timeout-with-non-integer.js",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/e9de43549843da9f4f081cce917945878967df7e/test%2Fparallel%2Ftest-timers-timeout-with-non-integer.js",
            "raw_url": "https://github.com/nodejs/node/raw/e9de43549843da9f4f081cce917945878967df7e/test%2Fparallel%2Ftest-timers-timeout-with-non-integer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-timers-timeout-with-non-integer.js?ref=e9de43549843da9f4f081cce917945878967df7e",
            "patch": "@@ -0,0 +1,15 @@\n+'use strict';\n+const common = require('../common');\n+\n+/**\n+ * This test is for https://github.com/nodejs/node/issues/24203\n+ */\n+let count = 50;\n+const time = 1.00000000000001;\n+const exec = common.mustCall(() => {\n+  if (--count === 0) {\n+    return;\n+  }\n+  setTimeout(exec, time);\n+}, count);\n+exec();"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 16,
        "deletions": 1
    }
}