{
    "author": "tniessen",
    "message": "tls: use internal API instead of crypto module\n\nPR-URL: https://github.com/nodejs/node/pull/22501\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Denys Otrishko <shishugi@gmail.com>",
    "sha": "fa3d6bedf9b1507bc17265eb9fad70b623247d85",
    "files": [
        {
            "sha": "12896b294ce1ebd44cd8dfdb318f973c02a0983e",
            "filename": "lib/_tls_common.js",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/fa3d6bedf9b1507bc17265eb9fad70b623247d85/lib%2F_tls_common.js",
            "raw_url": "https://github.com/nodejs/node/raw/fa3d6bedf9b1507bc17265eb9fad70b623247d85/lib%2F_tls_common.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_tls_common.js?ref=fa3d6bedf9b1507bc17265eb9fad70b623247d85",
            "patch": "@@ -31,8 +31,8 @@ const {\n \n const { SSL_OP_CIPHER_SERVER_PREFERENCE } = process.binding('constants').crypto;\n \n-// Lazily loaded\n-var crypto = null;\n+// Lazily loaded from internal/crypto/util.\n+let toBuf = null;\n \n const { internalBinding } = require('internal/bootstrap/loaders');\n const { SecureContext: NativeSecureContext } = internalBinding('crypto');\n@@ -178,26 +178,26 @@ exports.createSecureContext = function createSecureContext(options, context) {\n   }\n \n   if (options.pfx) {\n-    if (!crypto)\n-      crypto = require('crypto');\n+    if (!toBuf)\n+      toBuf = require('internal/crypto/util').toBuf;\n \n     if (Array.isArray(options.pfx)) {\n       for (i = 0; i < options.pfx.length; i++) {\n         const pfx = options.pfx[i];\n         const raw = pfx.buf ? pfx.buf : pfx;\n-        const buf = crypto._toBuf(raw);\n+        const buf = toBuf(raw);\n         const passphrase = pfx.passphrase || options.passphrase;\n         if (passphrase) {\n-          c.context.loadPKCS12(buf, crypto._toBuf(passphrase));\n+          c.context.loadPKCS12(buf, toBuf(passphrase));\n         } else {\n           c.context.loadPKCS12(buf);\n         }\n       }\n     } else {\n-      const buf = crypto._toBuf(options.pfx);\n+      const buf = toBuf(options.pfx);\n       const passphrase = options.passphrase;\n       if (passphrase) {\n-        c.context.loadPKCS12(buf, crypto._toBuf(passphrase));\n+        c.context.loadPKCS12(buf, toBuf(passphrase));\n       } else {\n         c.context.loadPKCS12(buf);\n       }"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 8,
        "deletions": 8
    }
}