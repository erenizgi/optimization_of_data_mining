{
    "author": "joyeecheung",
    "message": "lib: fix code cache generation\n\ne7f710c1 broke the code cache generation since internalBinding\nis now passed in through the wrapper and cannot be redeclared.\nThis patch fixes that.\n\nRefs: https://github.com/nodejs/node/issues/21563\nPR-URL: https://github.com/nodejs/node/pull/23855\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Refael Ackermann <refack@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "9c0c3f1443bc02eb46071028b2135a62661f0478",
    "files": [
        {
            "sha": "6181228b033228b1c2408410a3d278ef3d9cde04",
            "filename": "lib/internal/bootstrap/cache.js",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/9c0c3f1443bc02eb46071028b2135a62661f0478/lib%2Finternal%2Fbootstrap%2Fcache.js",
            "raw_url": "https://github.com/nodejs/node/raw/9c0c3f1443bc02eb46071028b2135a62661f0478/lib%2Finternal%2Fbootstrap%2Fcache.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fcache.js?ref=9c0c3f1443bc02eb46071028b2135a62661f0478",
            "patch": "@@ -6,8 +6,9 @@\n // cannot be tampered with even with --expose-internals\n \n const {\n-  NativeModule, internalBinding\n+  NativeModule\n } = require('internal/bootstrap/loaders');\n+const { hasTracing } = process.binding('config');\n \n function getCodeCache(id) {\n   const cached = NativeModule.getCached(id);\n@@ -42,6 +43,16 @@ const cannotUseCache = [\n   'internal/bootstrap/node'\n ].concat(depsModule);\n \n+// Skip modules that cannot be required when they are not\n+// built into the binary.\n+if (process.config.variables.v8_enable_inspector !== 1) {\n+  cannotUseCache.push('inspector');\n+  cannotUseCache.push('internal/util/inspector');\n+}\n+if (!hasTracing) {\n+  cannotUseCache.push('trace_events');\n+}\n+\n module.exports = {\n   cachableBuiltins: Object.keys(NativeModule._source).filter(\n     (key) => !cannotUseCache.includes(key)"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 12,
        "deletions": 1
    }
}