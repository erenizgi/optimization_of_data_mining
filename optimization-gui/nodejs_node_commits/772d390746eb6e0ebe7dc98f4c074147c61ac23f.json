{
    "author": "rvagg",
    "message": "deps: float ea7abee from openssl / CVE-2018-0732\n\nPending OpenSSL 1.1.0i release.\n\nPR-URL: https://github.com/nodejs/node/pull/21282\nReviewed-By: Shigeki Ohtsu <ohtsu@ohtsu.org>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nUpstream: https://github.com/openssl/openssl/commit/ea7abee\n\nOriginal commit message:\n\n    Reject excessively large primes in DH key generation.\n\n    CVE-2018-0732\n\n    Signed-off-by: Guido Vranken <guidovranken@gmail.com>\n\n    (cherry picked from commit 91f7361f47b082ae61ffe1a7b17bb2adf213c7fe)\n\n    Reviewed-by: Tim Hudson <tjh@openssl.org>\n    Reviewed-by: Matt Caswell <matt@openssl.org>\n    (Merged from https://github.com/openssl/openssl/pull/6457)",
    "sha": "772d390746eb6e0ebe7dc98f4c074147c61ac23f",
    "files": [
        {
            "sha": "58003d708781f3ec679daeccda1b4a15378f7aeb",
            "filename": "deps/openssl/openssl/crypto/dh/dh_key.c",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/772d390746eb6e0ebe7dc98f4c074147c61ac23f/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fdh%2Fdh_key.c",
            "raw_url": "https://github.com/nodejs/node/raw/772d390746eb6e0ebe7dc98f4c074147c61ac23f/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fdh%2Fdh_key.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fcrypto%2Fdh%2Fdh_key.c?ref=772d390746eb6e0ebe7dc98f4c074147c61ac23f",
            "patch": "@@ -78,10 +78,15 @@ static int generate_key(DH *dh)\n     int ok = 0;\n     int generate_new_key = 0;\n     unsigned l;\n-    BN_CTX *ctx;\n+    BN_CTX *ctx = NULL;\n     BN_MONT_CTX *mont = NULL;\n     BIGNUM *pub_key = NULL, *priv_key = NULL;\n \n+    if (BN_num_bits(dh->p) > OPENSSL_DH_MAX_MODULUS_BITS) {\n+        DHerr(DH_F_GENERATE_KEY, DH_R_MODULUS_TOO_LARGE);\n+        return 0;\n+    }\n+\n     ctx = BN_CTX_new();\n     if (ctx == NULL)\n         goto err;"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
    }
}