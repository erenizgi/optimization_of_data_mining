{
    "author": "joyeecheung",
    "message": "src: use PauseOnNextJavascriptStatement to implement --inspect-brk-node\n\nInstead of using the `debugger;` statement which is visible in the\nJS source code and makes primordials.js environment-dependent.\n\nPR-URL: https://github.com/nodejs/node/pull/26034\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "45b7c98f09bca9716c20f855f38b8dd6aba66ef0",
    "files": [
        {
            "sha": "df399dc1736a54870a8b50190c5ac928501f5812",
            "filename": "lib/internal/bootstrap/primordials.js",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/45b7c98f09bca9716c20f855f38b8dd6aba66ef0/lib%2Finternal%2Fbootstrap%2Fprimordials.js",
            "raw_url": "https://github.com/nodejs/node/raw/45b7c98f09bca9716c20f855f38b8dd6aba66ef0/lib%2Finternal%2Fbootstrap%2Fprimordials.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fprimordials.js?ref=45b7c98f09bca9716c20f855f38b8dd6aba66ef0",
            "patch": "@@ -1,6 +1,6 @@\n 'use strict';\n \n-/* global breakAtBootstrap, primordials */\n+/* global primordials */\n \n // This file subclasses and stores the JS builtins that come from the VM\n // so that Node.js's builtin modules do not need to later look these up from\n@@ -12,10 +12,6 @@\n // `primordials.Object` where `primordials` is a lexical variable passed\n // by the native module compiler.\n \n-if (breakAtBootstrap) {\n-  debugger;  // eslint-disable-line no-debugger\n-}\n-\n function copyProps(src, dest) {\n   for (const key of Reflect.ownKeys(src)) {\n     if (!Reflect.getOwnPropertyDescriptor(dest, key)) {"
        },
        {
            "sha": "f257495a1351e2e0c854eff517f99d567a32663e",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/45b7c98f09bca9716c20f855f38b8dd6aba66ef0/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/45b7c98f09bca9716c20f855f38b8dd6aba66ef0/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=45b7c98f09bca9716c20f855f38b8dd6aba66ef0",
            "patch": "@@ -249,14 +249,18 @@ MaybeLocal<Value> RunBootstrapping(Environment* env) {\n   // Store primordials\n   env->set_primordials(Object::New(isolate));\n   std::vector<Local<String>> primordials_params = {\n-    FIXED_ONE_BYTE_STRING(isolate, \"breakAtBootstrap\"),\n     env->primordials_string()\n   };\n   std::vector<Local<Value>> primordials_args = {\n-    Boolean::New(isolate,\n-                  env->options()->debug_options().break_node_first_line),\n     env->primordials()\n   };\n+\n+#if HAVE_INSPECTOR\n+  if (env->options()->debug_options().break_node_first_line) {\n+    env->inspector_agent()->PauseOnNextJavascriptStatement(\n+        \"Break at bootstrap\");\n+  }\n+#endif  // HAVE_INSPECTOR\n   MaybeLocal<Value> primordials_ret =\n       ExecuteBootstrapper(env,\n                           \"internal/bootstrap/primordials\","
        }
    ],
    "stats": {
        "total": 16,
        "additions": 8,
        "deletions": 8
    }
}