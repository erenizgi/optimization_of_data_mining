{
    "author": "apapirovski",
    "message": "test: add test for tls benchmarks\n\nPR-URL: https://github.com/nodejs/node/pull/18489\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "5c2c412f21f40bb4bb60f9e260a7c0f26aa28baa",
    "files": [
        {
            "sha": "1ca52ad9496237952ee30fe675a22ed7f61cfce8",
            "filename": "benchmark/tls/throughput.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/5c2c412f21f40bb4bb60f9e260a7c0f26aa28baa/benchmark%2Ftls%2Fthroughput.js",
            "raw_url": "https://github.com/nodejs/node/raw/5c2c412f21f40bb4bb60f9e260a7c0f26aa28baa/benchmark%2Ftls%2Fthroughput.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Ftls%2Fthroughput.js?ref=5c2c412f21f40bb4bb60f9e260a7c0f26aa28baa",
            "patch": "@@ -40,11 +40,11 @@ function main({ dur, type, size }) {\n   };\n \n   server = tls.createServer(options, onConnection);\n-  setTimeout(done, dur * 1000);\n   var conn;\n   server.listen(common.PORT, function() {\n     const opt = { port: common.PORT, rejectUnauthorized: false };\n     conn = tls.connect(opt, function() {\n+      setTimeout(done, dur * 1000);\n       bench.start();\n       conn.on('drain', write);\n       write();"
        },
        {
            "sha": "7c87aa3cbcd89ed771f8ddbdcfcdb0af5ce592d6",
            "filename": "test/sequential/test-benchmark-tls.js",
            "status": "added",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/5c2c412f21f40bb4bb60f9e260a7c0f26aa28baa/test%2Fsequential%2Ftest-benchmark-tls.js",
            "raw_url": "https://github.com/nodejs/node/raw/5c2c412f21f40bb4bb60f9e260a7c0f26aa28baa/test%2Fsequential%2Ftest-benchmark-tls.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-benchmark-tls.js?ref=5c2c412f21f40bb4bb60f9e260a7c0f26aa28baa",
            "patch": "@@ -0,0 +1,25 @@\n+'use strict';\n+\n+const common = require('../common');\n+\n+if (!common.enoughTestMem)\n+  common.skip('Insufficient memory for TLS benchmark test');\n+\n+// Because the TLS benchmarks use hardcoded ports, this should be in sequential\n+// rather than parallel to make sure it does not conflict with tests that choose\n+// random available ports.\n+\n+const runBenchmark = require('../common/benchmark');\n+\n+runBenchmark('tls',\n+             [\n+               'concurrency=1',\n+               'dur=0.1',\n+               'n=1',\n+               'size=2',\n+               'type=asc'\n+             ],\n+             {\n+               NODEJS_BENCHMARK_ZERO_ALLOWED: 1,\n+               duration: 0\n+             });"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 26,
        "deletions": 1
    }
}