{
    "author": "BridgeAR",
    "message": "test: add eslint rule to verify assertion input\n\nThe input for `assert.deepStrictEqual` and similar expect the actual\ninput first and the expected input as second argument. This verifies\nthat this is actually done correct in our tests.\n\nThis is important so the possible error message actually makes sense.\n\nPR-URL: https://github.com/nodejs/node/pull/20718\nReviewed-By: Rich Trott <rtrott@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "dd9d32f94ce5ed6d136c16677ef323239e708e32",
    "files": [
        {
            "sha": "f07dd076d93865a6e17aca4f3440d20ad0d96eb0",
            "filename": "test/.eslintrc.yaml",
            "status": "modified",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/dd9d32f94ce5ed6d136c16677ef323239e708e32/test%2F.eslintrc.yaml",
            "raw_url": "https://github.com/nodejs/node/raw/dd9d32f94ce5ed6d136c16677ef323239e708e32/test%2F.eslintrc.yaml",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2F.eslintrc.yaml?ref=dd9d32f94ce5ed6d136c16677ef323239e708e32",
            "patch": "@@ -19,6 +19,33 @@ rules:\n   ## common module is mandatory in tests\n   node-core/required-modules: [error, common]\n \n+  no-restricted-syntax:\n+    # Config copied from .eslintrc.js\n+    - error\n+    - selector: \"CallExpression[callee.object.name='assert'][callee.property.name='doesNotThrow']\"\n+      message: \"Please replace `assert.doesNotThrow()` and add a comment next to the code instead.\"\n+    - selector: \"CallExpression[callee.object.name='assert'][callee.property.name='rejects'][arguments.length<2]\"\n+      message: \"assert.rejects() must be invoked with at least two arguments.\"\n+    - selector: \"CallExpression[callee.object.name='assert'][callee.property.name='throws'][arguments.1.type='Literal']:not([arguments.1.regex])\"\n+      message: \"Use an object as second argument of assert.throws()\"\n+    - selector: \"CallExpression[callee.object.name='assert'][callee.property.name='throws'][arguments.length<2]\"\n+      message: \"assert.throws() must be invoked with at least two arguments.\"\n+    - selector: \"CallExpression[callee.name='setTimeout'][arguments.length<2]\"\n+      message: \"setTimeout() must be invoked with at least two arguments.\"\n+    - selector: \"CallExpression[callee.name='setInterval'][arguments.length<2]\"\n+      message: \"setInterval() must be invoked with at least 2 arguments.\"\n+    - selector: \"ThrowStatement > CallExpression[callee.name=/Error$/]\"\n+      message: \"Use new keyword when throwing an Error.\"\n+    # Specific to /test\n+    - selector: \"CallExpression[callee.object.name='assert'][callee.property.name='notDeepStrictEqual'][arguments.0.type='Literal']:not([arguments.1.type='Literal']):not([arguments.1.type='ObjectExpression']):not([arguments.1.type='ArrayExpression'])\"\n+      message: \"The first argument should be the `actual`, not the `expected` value.\"\n+    - selector: \"CallExpression[callee.object.name='assert'][callee.property.name='notStrictEqual'][arguments.0.type='Literal']:not([arguments.1.type='Literal']):not([arguments.1.type='ObjectExpression']):not([arguments.1.type='ArrayExpression'])\"\n+      message: \"The first argument should be the `actual`, not the `expected` value.\"\n+    - selector: \"CallExpression[callee.object.name='assert'][callee.property.name='deepStrictEqual'][arguments.0.type='Literal']:not([arguments.1.type='Literal']):not([arguments.1.type='ObjectExpression']):not([arguments.1.type='ArrayExpression'])\"\n+      message: \"The first argument should be the `actual`, not the `expected` value.\"\n+    # TODO: Activate the `strictEqual` rule as soon as it produces less churn.\n+    # - selector: \"CallExpression[callee.object.name='assert'][callee.property.name='strictEqual'][arguments.0.type='Literal']:not([arguments.1.type='Literal']):not([arguments.1.type='ObjectExpression']):not([arguments.1.type='ArrayExpression'])\"\n+    #   message: \"The first argument should be the `actual`, not the `expected` value.\"\n # Global scoped methods and vars\n globals:\n   WebAssembly: false"
        },
        {
            "sha": "27e1fb322c4c476c8703505645522595b577c04a",
            "filename": "test/addons-napi/test_conversions/test.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/dd9d32f94ce5ed6d136c16677ef323239e708e32/test%2Faddons-napi%2Ftest_conversions%2Ftest.js",
            "raw_url": "https://github.com/nodejs/node/raw/dd9d32f94ce5ed6d136c16677ef323239e708e32/test%2Faddons-napi%2Ftest_conversions%2Ftest.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Faddons-napi%2Ftest_conversions%2Ftest.js?ref=dd9d32f94ce5ed6d136c16677ef323239e708e32",
            "patch": "@@ -118,10 +118,10 @@ assert.deepStrictEqual(new String(''), test.toObject(''));\n assert.deepStrictEqual(new Number(0), test.toObject(0));\n assert.deepStrictEqual(new Number(Number.NaN), test.toObject(Number.NaN));\n assert.deepStrictEqual(new Object(testSym), test.toObject(testSym));\n-assert.notDeepStrictEqual(false, test.toObject(false));\n-assert.notDeepStrictEqual(true, test.toObject(true));\n-assert.notDeepStrictEqual('', test.toObject(''));\n-assert.notDeepStrictEqual(0, test.toObject(0));\n+assert.notDeepStrictEqual(test.toObject(false), false);\n+assert.notDeepStrictEqual(test.toObject(true), true);\n+assert.notDeepStrictEqual(test.toObject(''), '');\n+assert.notDeepStrictEqual(test.toObject(0), 0);\n assert.ok(!Number.isNaN(test.toObject(Number.NaN)));\n \n assert.strictEqual('', test.toString(''));"
        },
        {
            "sha": "41aaf992cfc8c980b8a7186a082c5c11d128ee73",
            "filename": "test/parallel/test-child-process-exec-env.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/dd9d32f94ce5ed6d136c16677ef323239e708e32/test%2Fparallel%2Ftest-child-process-exec-env.js",
            "raw_url": "https://github.com/nodejs/node/raw/dd9d32f94ce5ed6d136c16677ef323239e708e32/test%2Fparallel%2Ftest-child-process-exec-env.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-child-process-exec-env.js?ref=dd9d32f94ce5ed6d136c16677ef323239e708e32",
            "patch": "@@ -34,10 +34,10 @@ function after(err, stdout, stderr) {\n     console.log(`error!: ${err.code}`);\n     console.log(`stdout: ${JSON.stringify(stdout)}`);\n     console.log(`stderr: ${JSON.stringify(stderr)}`);\n-    assert.strictEqual(false, err.killed);\n+    assert.strictEqual(err.killed, false);\n   } else {\n     success_count++;\n-    assert.notStrictEqual('', stdout);\n+    assert.notStrictEqual(stdout, '');\n   }\n }\n \n@@ -56,7 +56,7 @@ child.stdout.on('data', function(chunk) {\n \n process.on('exit', function() {\n   console.log('response: ', response);\n-  assert.strictEqual(1, success_count);\n-  assert.strictEqual(0, error_count);\n+  assert.strictEqual(success_count, 1);\n+  assert.strictEqual(error_count, 0);\n   assert.ok(response.includes('HELLO=WORLD'));\n });"
        },
        {
            "sha": "88d49167100fbe858df305818486cf0a22e2795d",
            "filename": "test/parallel/test-crypto.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/dd9d32f94ce5ed6d136c16677ef323239e708e32/test%2Fparallel%2Ftest-crypto.js",
            "raw_url": "https://github.com/nodejs/node/raw/dd9d32f94ce5ed6d136c16677ef323239e708e32/test%2Fparallel%2Ftest-crypto.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto.js?ref=dd9d32f94ce5ed6d136c16677ef323239e708e32",
            "patch": "@@ -129,7 +129,7 @@ assert(tlsCiphers.every((value) => noCapitals.test(value)));\n validateList(tlsCiphers);\n \n // Assert that we have sha1 and sha256 but not SHA1 and SHA256.\n-assert.notStrictEqual(0, crypto.getHashes().length);\n+assert.notStrictEqual(crypto.getHashes().length, 0);\n assert(crypto.getHashes().includes('sha1'));\n assert(crypto.getHashes().includes('sha256'));\n assert(!crypto.getHashes().includes('SHA1'));\n@@ -139,7 +139,7 @@ assert(!crypto.getHashes().includes('rsa-sha1'));\n validateList(crypto.getHashes());\n \n // Assume that we have at least secp384r1.\n-assert.notStrictEqual(0, crypto.getCurves().length);\n+assert.notStrictEqual(crypto.getCurves().length, 0);\n assert(crypto.getCurves().includes('secp384r1'));\n assert(!crypto.getCurves().includes('SECP384R1'));\n validateList(crypto.getCurves());"
        }
    ],
    "stats": {
        "total": 47,
        "additions": 37,
        "deletions": 10
    }
}