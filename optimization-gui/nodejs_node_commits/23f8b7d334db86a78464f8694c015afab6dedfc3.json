{
    "author": "richardlau",
    "message": "test: enable trace-events tests for workers\n\nUse the `cwd` option for `child_process` instead of `process.chdir()`\nto enable the trace events tests to run on workers.\n\nPR-URL: https://github.com/nodejs/node/pull/23698\nRefs: https://github.com/nodejs/node/pull/23674#discussion_r225335819\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "23f8b7d334db86a78464f8694c015afab6dedfc3",
    "files": [
        {
            "sha": "d0cdd4a87492139e5cdf35f8875d508f5204856b",
            "filename": "test/parallel/test-trace-events-all.js",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-all.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-all.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-all.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -3,20 +3,18 @@ const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n const fs = require('fs');\n-\n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n+const path = require('path');\n \n const CODE =\n   'setTimeout(() => { for (var i = 0; i < 100000; i++) { \"test\" + i } }, 1)';\n-const FILE_NAME = 'node_trace.1.log';\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n+const FILE_NAME = path.join(tmpdir.path, 'node_trace.1.log');\n \n const proc = cp.spawn(process.execPath,\n-                      [ '--trace-events-enabled', '-e', CODE ]);\n+                      [ '--trace-events-enabled', '-e', CODE ],\n+                      { cwd: tmpdir.path });\n \n proc.once('exit', common.mustCall(() => {\n   assert(fs.existsSync(FILE_NAME));"
        },
        {
            "sha": "2810ac0dd0f6d762b002b485295a0b963ee3272d",
            "filename": "test/parallel/test-trace-events-api.js",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-api.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-api.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-api.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -5,8 +5,7 @@ const common = require('../common');\n \n if (!process.binding('config').hasTracing)\n   common.skip('missing trace events');\n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n+common.skipIfWorker(); // https://github.com/nodejs/node/issues/22767\n \n const assert = require('assert');\n const cp = require('child_process');"
        },
        {
            "sha": "09017e47745c496fc801c8358cd570b4c9b05a27",
            "filename": "test/parallel/test-trace-events-async-hooks.js",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-async-hooks.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-async-hooks.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-async-hooks.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -3,22 +3,20 @@ const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n const fs = require('fs');\n+const path = require('path');\n const util = require('util');\n \n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n-\n const CODE =\n   'setTimeout(() => { for (var i = 0; i < 100000; i++) { \"test\" + i } }, 1)';\n-const FILE_NAME = 'node_trace.1.log';\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n+const FILE_NAME = path.join(tmpdir.path, 'node_trace.1.log');\n \n const proc = cp.spawn(process.execPath,\n                       [ '--trace-event-categories', 'node.async_hooks',\n-                        '-e', CODE ]);\n+                        '-e', CODE ],\n+                      { cwd: tmpdir.path });\n \n proc.once('exit', common.mustCall(() => {\n   assert(fs.existsSync(FILE_NAME));"
        },
        {
            "sha": "a6994d47b3e69529016a55c67626b92ee5883ac9",
            "filename": "test/parallel/test-trace-events-binding.js",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-binding.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-binding.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-binding.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -3,9 +3,7 @@ const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n const fs = require('fs');\n-\n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n+const path = require('path');\n \n const CODE = `\n   const { internalBinding } = require('internal/test/binding');\n@@ -18,17 +16,17 @@ const CODE = `\n   trace('b'.charCodeAt(0), 'missing',\n         'type-value', 10, {'extra-value': 20 });\n `;\n-const FILE_NAME = 'node_trace.1.log';\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n+const FILE_NAME = path.join(tmpdir.path, 'node_trace.1.log');\n \n const proc = cp.spawn(process.execPath,\n                       [ '--trace-event-categories', 'custom',\n                         '--no-warnings',\n                         '--expose-internals',\n-                        '-e', CODE ]);\n+                        '-e', CODE ],\n+                      { cwd: tmpdir.path });\n \n proc.once('exit', common.mustCall(() => {\n   assert(fs.existsSync(FILE_NAME));"
        },
        {
            "sha": "087fbd2f182a612ae97b321ed2c1c8e8ff108254",
            "filename": "test/parallel/test-trace-events-bootstrap.js",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-bootstrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-bootstrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-bootstrap.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -2,13 +2,10 @@\n const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n-const path = require('path');\n const fs = require('fs');\n+const path = require('path');\n const tmpdir = require('../common/tmpdir');\n \n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n-\n const names = [\n   'environment',\n   'nodeStart',\n@@ -30,10 +27,10 @@ if (process.argv[2] === 'child') {\n   1 + 1;\n } else {\n   tmpdir.refresh();\n-  process.chdir(tmpdir.path);\n \n   const proc = cp.fork(__filename,\n                        [ 'child' ], {\n+                         cwd: tmpdir.path,\n                          execArgv: [\n                            '--trace-event-categories',\n                            'node.bootstrap'"
        },
        {
            "sha": "bedc27bac4d45bb52660e89319ad7a111694a72c",
            "filename": "test/parallel/test-trace-events-category-used.js",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-category-used.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-category-used.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-category-used.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -3,9 +3,6 @@ const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n \n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n-\n const CODE = `\n   const { internalBinding } = require('internal/test/binding');\n   const { isTraceCategoryEnabled } = internalBinding('trace_events');\n@@ -16,7 +13,6 @@ const CODE = `\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n \n const procEnabled = cp.spawn(\n   process.execPath,\n@@ -25,7 +21,8 @@ const procEnabled = cp.spawn(\n     // emits a warning.\n     '--no-warnings',\n     '--expose-internals',\n-    '-e', CODE ]\n+    '-e', CODE ],\n+  { cwd: tmpdir.path }\n );\n let procEnabledOutput = '';\n \n@@ -42,7 +39,8 @@ const procDisabled = cp.spawn(\n     // emits a warning.\n     '--no-warnings',\n     '--expose-internals',\n-    '-e', CODE ]\n+    '-e', CODE ],\n+  { cwd: tmpdir.path }\n );\n let procDisabledOutput = '';\n "
        },
        {
            "sha": "a60559b7f91b2bbf88d7ede3fcb118f0b04a8c4f",
            "filename": "test/parallel/test-trace-events-file-pattern.js",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-file-pattern.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-file-pattern.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-file-pattern.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -4,12 +4,9 @@ const tmpdir = require('../common/tmpdir');\n const assert = require('assert');\n const cp = require('child_process');\n const fs = require('fs');\n-\n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n+const path = require('path');\n \n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n \n const CODE =\n   'setTimeout(() => { for (var i = 0; i < 100000; i++) { \"test\" + i } }, 1)';\n@@ -20,10 +17,11 @@ const proc = cp.spawn(process.execPath, [\n   // eslint-disable-next-line no-template-curly-in-string\n   '${pid}-${rotation}-${pid}-${rotation}.tracing.log',\n   '-e', CODE\n-]);\n+], { cwd: tmpdir.path });\n \n proc.once('exit', common.mustCall(() => {\n-  const expectedFilename = `${proc.pid}-1-${proc.pid}-1.tracing.log`;\n+  const expectedFilename = path.join(tmpdir.path,\n+                                     `${proc.pid}-1-${proc.pid}-1.tracing.log`);\n \n   assert(fs.existsSync(expectedFilename));\n   fs.readFile(expectedFilename, common.mustCall((err, data) => {"
        },
        {
            "sha": "d8e9ca30a8ebd3429c093dafff63a255fe137a71",
            "filename": "test/parallel/test-trace-events-fs-sync.js",
            "status": "modified",
            "additions": 3,
            "deletions": 6,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-fs-sync.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-fs-sync.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-fs-sync.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -3,13 +3,10 @@ const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n const fs = require('fs');\n+const path = require('path');\n const util = require('util');\n \n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n-\n const tests = new Array();\n-const traceFile = 'node_trace.1.log';\n \n let gid = 1;\n let uid = 1;\n@@ -119,14 +116,14 @@ if (common.canCreateSymLink()) {\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n+const traceFile = path.join(tmpdir.path, 'node_trace.1.log');\n \n for (const tr in tests) {\n   const proc = cp.spawnSync(process.execPath,\n                             [ '--trace-events-enabled',\n                               '--trace-event-categories', 'node.fs.sync',\n                               '-e', tests[tr] ],\n-                            { encoding: 'utf8' });\n+                            { cwd: tmpdir.path, encoding: 'utf8' });\n   // Some AIX versions don't support futimes or utimes, so skip.\n   if (common.isAIX && proc.status !== 0 && tr === 'fs.sync.futimes') {\n     continue;"
        },
        {
            "sha": "951f398404ac66111b8d5c20894501d5c61fc832",
            "filename": "test/parallel/test-trace-events-metadata.js",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-metadata.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-metadata.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-metadata.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -3,23 +3,21 @@ const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n const fs = require('fs');\n-\n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n+const path = require('path');\n \n const CODE =\n   'setTimeout(() => { for (var i = 0; i < 100000; i++) { \"test\" + i } }, 1);' +\n   'process.title = \"foo\"';\n-const FILE_NAME = 'node_trace.1.log';\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n+const FILE_NAME = path.join(tmpdir.path, 'node_trace.1.log');\n \n const proc = cp.spawn(process.execPath,\n                       [ '--trace-event-categories', 'node.perf.usertiming',\n                         '--title=bar',\n-                        '-e', CODE ]);\n+                        '-e', CODE ],\n+                      { cwd: tmpdir.path });\n proc.once('exit', common.mustCall(() => {\n   assert(fs.existsSync(FILE_NAME));\n   fs.readFile(FILE_NAME, common.mustCall((err, data) => {"
        },
        {
            "sha": "dfe77e4b39369f44caae1200879970b0abee6bd3",
            "filename": "test/parallel/test-trace-events-none.js",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-none.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-none.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-none.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -3,21 +3,19 @@ const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n const fs = require('fs');\n-\n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n+const path = require('path');\n \n const CODE =\n   'setTimeout(() => { for (var i = 0; i < 100000; i++) { \"test\" + i } }, 1)';\n-const FILE_NAME = 'node_trace.1.log';\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n+const FILE_NAME = path.join(tmpdir.path, 'node_trace.1.log');\n \n const proc_no_categories = cp.spawn(\n   process.execPath,\n-  [ '--trace-event-categories', '\"\"', '-e', CODE ]\n+  [ '--trace-event-categories', '\"\"', '-e', CODE ],\n+  { cwd: tmpdir.path }\n );\n \n proc_no_categories.once('exit', common.mustCall(() => {"
        },
        {
            "sha": "2403a8078a47fdf2be9f78b6911b119d1c124f5e",
            "filename": "test/parallel/test-trace-events-perf.js",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-perf.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-perf.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-perf.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -2,13 +2,10 @@\n const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n-const path = require('path');\n const fs = require('fs');\n+const path = require('path');\n const tmpdir = require('../common/tmpdir');\n \n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n-\n if (process.argv[2] === 'child') {\n   const { performance } = require('perf_hooks');\n \n@@ -25,7 +22,6 @@ if (process.argv[2] === 'child') {\n   ff();  // Will emit a timerify trace event\n } else {\n   tmpdir.refresh();\n-  process.chdir(tmpdir.path);\n \n   const expectedMarks = ['A', 'B'];\n   const expectedBegins = [\n@@ -41,6 +37,7 @@ if (process.argv[2] === 'child') {\n                        [\n                          'child'\n                        ], {\n+                         cwd: tmpdir.path,\n                          execArgv: [\n                            '--trace-event-categories',\n                            'node.perf'"
        },
        {
            "sha": "1a39b889a3c809bc74088526bfb336ed44490215",
            "filename": "test/parallel/test-trace-events-process-exit.js",
            "status": "modified",
            "additions": 4,
            "deletions": 8,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-process-exit.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-process-exit.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-process-exit.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -3,20 +3,16 @@ const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n const fs = require('fs');\n-\n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n+const path = require('path');\n \n const tmpdir = require('../common/tmpdir');\n-\n-const FILE_NAME = 'node_trace.1.log';\n-\n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n+const FILE_NAME = path.join(tmpdir.path, 'node_trace.1.log');\n \n const proc = cp.spawn(process.execPath,\n                       [ '--trace-events-enabled',\n-                        '-e', 'process.exit()' ]);\n+                        '-e', 'process.exit()' ],\n+                      { cwd: tmpdir.path });\n \n proc.once('exit', common.mustCall(() => {\n   assert(fs.existsSync(FILE_NAME));"
        },
        {
            "sha": "0dd4fddc6d75ba92e3153ea83600ccfb977e4fec",
            "filename": "test/parallel/test-trace-events-promises.js",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-promises.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-promises.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-promises.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -2,15 +2,12 @@\n const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n-const path = require('path');\n const fs = require('fs');\n+const path = require('path');\n const tmpdir = require('../common/tmpdir');\n \n common.disableCrashOnUnhandledRejection();\n \n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n-\n if (process.argv[2] === 'child') {\n   const p = Promise.reject(1);  // Handled later\n   Promise.reject(2);  // Unhandled\n@@ -19,10 +16,10 @@ if (process.argv[2] === 'child') {\n   });\n } else {\n   tmpdir.refresh();\n-  process.chdir(tmpdir.path);\n \n   const proc = cp.fork(__filename,\n                        [ 'child' ], {\n+                         cwd: tmpdir.path,\n                          execArgv: [\n                            '--no-warnings',\n                            '--trace-event-categories',"
        },
        {
            "sha": "d79838892baa0d769297bc340f2c12ebf763b438",
            "filename": "test/parallel/test-trace-events-v8.js",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-v8.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-v8.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-v8.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -3,22 +3,20 @@ const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n const fs = require('fs');\n-\n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n+const path = require('path');\n \n const CODE =\n   'setTimeout(() => { for (var i = 0; i < 100000; i++) { \"test\" + i } }, 1)';\n-const FILE_NAME = 'node_trace.1.log';\n \n const tmpdir = require('../common/tmpdir');\n tmpdir.refresh();\n-process.chdir(tmpdir.path);\n+const FILE_NAME = path.join(tmpdir.path, 'node_trace.1.log');\n \n const proc = cp.spawn(process.execPath,\n                       [ '--trace-events-enabled',\n                         '--trace-event-categories', 'v8',\n-                        '-e', CODE ]);\n+                        '-e', CODE ],\n+                      { cwd: tmpdir.path });\n \n proc.once('exit', common.mustCall(() => {\n   assert(fs.existsSync(FILE_NAME));"
        },
        {
            "sha": "3e5d32b6c3f82c3097f4f499acb2462f22a9e85d",
            "filename": "test/parallel/test-trace-events-vm.js",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-vm.js",
            "raw_url": "https://github.com/nodejs/node/raw/23f8b7d334db86a78464f8694c015afab6dedfc3/test%2Fparallel%2Ftest-trace-events-vm.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-trace-events-vm.js?ref=23f8b7d334db86a78464f8694c015afab6dedfc3",
            "patch": "@@ -2,13 +2,10 @@\n const common = require('../common');\n const assert = require('assert');\n const cp = require('child_process');\n-const path = require('path');\n const fs = require('fs');\n+const path = require('path');\n const tmpdir = require('../common/tmpdir');\n \n-if (!common.isMainThread)\n-  common.skip('process.chdir is not available in Workers');\n-\n const names = [\n   'ContextifyScript::New',\n   'RunInThisContext',\n@@ -20,10 +17,10 @@ if (process.argv[2] === 'child') {\n   vm.runInNewContext('1 + 1');\n } else {\n   tmpdir.refresh();\n-  process.chdir(tmpdir.path);\n \n   const proc = cp.fork(__filename,\n                        [ 'child' ], {\n+                         cwd: tmpdir.path,\n                          execArgv: [\n                            '--trace-event-categories',\n                            'node.vm.script'"
        }
    ],
    "stats": {
        "total": 132,
        "additions": 48,
        "deletions": 84
    }
}