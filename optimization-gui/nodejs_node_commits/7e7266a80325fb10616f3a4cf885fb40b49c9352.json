{
    "author": "danbev",
    "message": "build: introduce --openssl-is-fips flag\n\nThis commit introduces a new configuration flag named\n--openssl-is-fips which is intended to be used when linking against\nan OpenSSL library that is FIPS compatible.\n\nThe motivation for this is that Red Hat Enterprise Linux 8 (RHEL8)\ncomes with OpenSSL 1.1.1 and includes FIPS support, and we would\nlike to be able to dynamically link against this version and also have\nFIPS features enabled in node, like would be done when statically\nlinking and using the --openssl-fips flag.\n\nThe suggestion here is to introduce a new flag:\n$ ./configure --help\n...\n--openssl-is-fips specifies that the shared OpenSSL version is FIPS\n                  compatible\n\nThis flag could be used in combination with the shared-openssl flag:\n$ ./configure --shared-openssl ---openssl-is-fips\n\nThis will enable FIPS support in node and the runtime flags will be\navailalbe to enable FIPS (--enable-fips, --force-fips).\n\nPR-URL: https://github.com/nodejs/node/pull/25412\nReviewed-By: Sam Roberts <vieuxtech@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>",
    "sha": "7e7266a80325fb10616f3a4cf885fb40b49c9352",
    "files": [
        {
            "sha": "8cb4c58c21809b169d65356654f0a92ee392165d",
            "filename": "configure.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/7e7266a80325fb10616f3a4cf885fb40b49c9352/configure.py",
            "raw_url": "https://github.com/nodejs/node/raw/7e7266a80325fb10616f3a4cf885fb40b49c9352/configure.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/configure.py?ref=7e7266a80325fb10616f3a4cf885fb40b49c9352",
            "patch": "@@ -173,6 +173,11 @@\n     dest='openssl_fips',\n     help='Build OpenSSL using FIPS canister .o file in supplied folder')\n \n+parser.add_option('--openssl-is-fips',\n+    action='store_true',\n+    dest='openssl_is_fips',\n+    help='specifies that the OpenSSL library is FIPS compatible')\n+\n parser.add_option('--openssl-use-def-ca-store',\n     action='store_true',\n     dest='use_openssl_ca_store',\n@@ -1187,6 +1192,7 @@ def configure_openssl(o):\n   variables = o['variables']\n   variables['node_use_openssl'] = b(not options.without_ssl)\n   variables['node_shared_openssl'] = b(options.shared_openssl)\n+  variables['openssl_is_fips'] = b(options.openssl_is_fips)\n   variables['openssl_fips'] = ''\n \n   if options.openssl_no_asm:"
        },
        {
            "sha": "d4b3c9c8d7dd1f22c3266d4ecc25f0313bfc0ee7",
            "filename": "node.gypi",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7e7266a80325fb10616f3a4cf885fb40b49c9352/node.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/7e7266a80325fb10616f3a4cf885fb40b49c9352/node.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/node.gypi?ref=7e7266a80325fb10616f3a4cf885fb40b49c9352",
            "patch": "@@ -315,7 +315,7 @@\n     [ 'node_use_openssl==\"true\"', {\n       'defines': [ 'HAVE_OPENSSL=1' ],\n       'conditions': [\n-        ['openssl_fips != \"\"', {\n+        ['openssl_fips != \"\" or openssl_is_fips==\"true\"', {\n           'defines': [ 'NODE_FIPS_MODE' ],\n         }],\n         [ 'node_shared_openssl==\"false\"', {"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 7,
        "deletions": 1
    }
}