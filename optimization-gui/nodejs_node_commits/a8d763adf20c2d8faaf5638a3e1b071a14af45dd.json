{
    "author": "addaleax",
    "message": "report: remove `InitializeReport()`\n\nPR-URL: https://github.com/nodejs/node/pull/25598\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>",
    "sha": "a8d763adf20c2d8faaf5638a3e1b071a14af45dd",
    "files": [
        {
            "sha": "1fab882a611271b9fa7fc331d9af444da5aa7b4c",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/a8d763adf20c2d8faaf5638a3e1b071a14af45dd/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/a8d763adf20c2d8faaf5638a3e1b071a14af45dd/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=a8d763adf20c2d8faaf5638a3e1b071a14af45dd",
            "patch": "@@ -737,12 +737,6 @@ void RunBootstrapping(Environment* env) {\n     return;\n   }\n \n-#ifdef NODE_REPORT\n-  if (env->options()->experimental_report) {\n-    report::InitializeReport(env->isolate(), env);\n-  }\n-#endif  // NODE_REPORT\n-\n   // process, loaderExports, isMainThread\n   std::vector<Local<String>> node_params = {\n       env->process_string(),"
        },
        {
            "sha": "0ccc2321d4a0ed907b82cc4fa2507c584136824c",
            "filename": "src/node_report.h",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/a8d763adf20c2d8faaf5638a3e1b071a14af45dd/src%2Fnode_report.h",
            "raw_url": "https://github.com/nodejs/node/raw/a8d763adf20c2d8faaf5638a3e1b071a14af45dd/src%2Fnode_report.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_report.h?ref=a8d763adf20c2d8faaf5638a3e1b071a14af45dd",
            "patch": "@@ -38,8 +38,6 @@ typedef struct tm TIME_TYPE;\n #define PATHSEP \"/\"\n #endif\n \n-void InitializeReport(v8::Isolate* isolate, node::Environment* env);\n-\n // Function declarations - functions in src/node_report.cc\n std::string TriggerNodeReport(v8::Isolate* isolate,\n                               node::Environment* env,"
        },
        {
            "sha": "d13eb61c83820a34c23082ed90f5b9ffe6e250f2",
            "filename": "src/node_report_module.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 13,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/a8d763adf20c2d8faaf5638a3e1b071a14af45dd/src%2Fnode_report_module.cc",
            "raw_url": "https://github.com/nodejs/node/raw/a8d763adf20c2d8faaf5638a3e1b071a14af45dd/src%2Fnode_report_module.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_report_module.cc?ref=a8d763adf20c2d8faaf5638a3e1b071a14af45dd",
            "patch": "@@ -108,15 +108,6 @@ void OnUserSignal(const FunctionCallbackInfo<Value>& info) {\n       isolate, env, *value, __func__, filename, info[0].As<String>());\n }\n \n-// Native module initializer function, called when the module is require'd\n-void InitializeReport(Isolate* isolate, Environment* env) {\n-  // Register the boot time of the process, for\n-  // computing resource consumption average etc.\n-  std::shared_ptr<PerIsolateOptions> options = env->isolate_data()->options();\n-\n-  if (options->report_signal == \"\") options->report_signal = \"SIGUSR2\";\n-}\n-\n // A method to sync up data elements in the JS land with its\n // corresponding elements in the C++ world. Required because\n // (i) the tunables are first intercepted through the CLI but\n@@ -236,8 +227,9 @@ void SyncConfig(const FunctionCallbackInfo<Value>& info) {\n     Local<Value> signal_value;\n     Local<Value> file_value;\n     Local<Value> path_value;\n-    if (!node::ToV8Value(context, options->report_signal)\n-             .ToLocal(&signal_value))\n+    std::string signal = options->report_signal;\n+    if (signal.empty()) signal = \"SIGUSR2\";\n+    if (!node::ToV8Value(context, signal).ToLocal(&signal_value))\n       return;\n     if (!obj->Set(context, signalkey, signal_value).FromJust()) return;\n \n@@ -264,8 +256,6 @@ static void Initialize(Local<Object> exports,\n                        Local<Context> context) {\n   Environment* env = Environment::GetCurrent(context);\n   std::shared_ptr<PerIsolateOptions> options = env->isolate_data()->options();\n-  Isolate* isolate = env->isolate();\n-  InitializeReport(isolate, env);\n   env->SetMethod(exports, \"triggerReport\", TriggerReport);\n   env->SetMethod(exports, \"getReport\", GetReport);\n   env->SetMethod(exports, \"onUnCaughtException\", OnUncaughtException);"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 3,
        "deletions": 21
    }
}