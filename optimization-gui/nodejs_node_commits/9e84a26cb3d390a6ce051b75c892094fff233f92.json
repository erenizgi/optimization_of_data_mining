{
    "author": "addaleax",
    "message": "worker: keep stdio after exit\n\nThis addresses review comments from\nhttps://github.com/nodejs/node/pull/25871.\n\nRefs: https://github.com/nodejs/node/pull/25871\n\nPR-URL: https://github.com/nodejs/node/pull/26017\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "9e84a26cb3d390a6ce051b75c892094fff233f92",
    "files": [
        {
            "sha": "f43a9610495ac0d3d4c3ad031385843db217b278",
            "filename": "lib/internal/worker.js",
            "status": "modified",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/9e84a26cb3d390a6ce051b75c892094fff233f92/lib%2Finternal%2Fworker.js",
            "raw_url": "https://github.com/nodejs/node/raw/9e84a26cb3d390a6ce051b75c892094fff233f92/lib%2Finternal%2Fworker.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fworker.js?ref=9e84a26cb3d390a6ce051b75c892094fff233f92",
            "patch": "@@ -171,7 +171,6 @@ class Worker extends EventEmitter {\n     this[kPublicPort] = null;\n \n     const { stdout, stderr } = this[kParentSideStdio];\n-    this[kParentSideStdio] = null;\n \n     if (!stdout._readableState.ended) {\n       debug(`[${threadId}] explicitly closes stdout for ${this.threadId}`);\n@@ -221,20 +220,14 @@ class Worker extends EventEmitter {\n   }\n \n   get stdin() {\n-    if (this[kParentSideStdio] === null) return null;\n-\n     return this[kParentSideStdio].stdin;\n   }\n \n   get stdout() {\n-    if (this[kParentSideStdio] === null) return null;\n-\n     return this[kParentSideStdio].stdout;\n   }\n \n   get stderr() {\n-    if (this[kParentSideStdio] === null) return null;\n-\n     return this[kParentSideStdio].stderr;\n   }\n }"
        },
        {
            "sha": "69856659a5773be870b0cedf29b92f5bd5e566ec",
            "filename": "test/parallel/test-worker-safe-getters.js",
            "status": "modified",
            "additions": 5,
            "deletions": 9,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/9e84a26cb3d390a6ce051b75c892094fff233f92/test%2Fparallel%2Ftest-worker-safe-getters.js",
            "raw_url": "https://github.com/nodejs/node/raw/9e84a26cb3d390a6ce051b75c892094fff233f92/test%2Fparallel%2Ftest-worker-safe-getters.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-worker-safe-getters.js?ref=9e84a26cb3d390a6ce051b75c892094fff233f92",
            "patch": "@@ -12,6 +12,8 @@ if (isMainThread) {\n     stderr: true\n   });\n \n+  const { stdin, stdout, stderr } = w;\n+\n   w.on('exit', common.mustCall((code) => {\n     assert.strictEqual(code, 0);\n \n@@ -21,17 +23,11 @@ if (isMainThread) {\n     w.ref();\n     w.unref();\n \n-    // Although not browser specific, probably wise to\n-    // make sure the stream getters don't throw either.\n-    w.stdin;\n-    w.stdout;\n-    w.stderr;\n-\n     // Sanity check.\n     assert.strictEqual(w.threadId, -1);\n-    assert.strictEqual(w.stdin, null);\n-    assert.strictEqual(w.stdout, null);\n-    assert.strictEqual(w.stderr, null);\n+    assert.strictEqual(w.stdin, stdin);\n+    assert.strictEqual(w.stdout, stdout);\n+    assert.strictEqual(w.stderr, stderr);\n   }));\n } else {\n   process.exit(0);"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 5,
        "deletions": 16
    }
}