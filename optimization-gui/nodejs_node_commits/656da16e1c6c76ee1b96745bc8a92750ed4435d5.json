{
    "author": "mcollina",
    "message": "test,stream: fix pipeline test so it runs well on Windows in older nodes\n\nThis test is ported automatically in readable-stream, and it fails there\non Windows and older Node.js versions because of some bad interactions\nbetween the code and the event loop on Windows.\n\nSee: https://github.com/nodejs/readable-stream/issues/353\n\nPR-URL: https://github.com/nodejs/node/pull/22456\nReviewed-By: Mathias Buus <mathiasbuus@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "656da16e1c6c76ee1b96745bc8a92750ed4435d5",
    "files": [
        {
            "sha": "84fb01fe0dd48e9721afb998aef3888cf18f41e0",
            "filename": "test/parallel/test-stream-pipeline.js",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/656da16e1c6c76ee1b96745bc8a92750ed4435d5/test%2Fparallel%2Ftest-stream-pipeline.js",
            "raw_url": "https://github.com/nodejs/node/raw/656da16e1c6c76ee1b96745bc8a92750ed4435d5/test%2Fparallel%2Ftest-stream-pipeline.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-stream-pipeline.js?ref=656da16e1c6c76ee1b96745bc8a92750ed4435d5",
            "patch": "@@ -165,8 +165,13 @@ const { promisify } = require('util');\n \n {\n   const server = http.createServer((req, res) => {\n+    let sent = false;\n     const rs = new Readable({\n       read() {\n+        if (sent) {\n+          return;\n+        }\n+        sent = true;\n         rs.push('hello');\n       },\n       destroy: common.mustCall((err, cb) => {\n@@ -195,8 +200,12 @@ const { promisify } = require('util');\n \n {\n   const server = http.createServer((req, res) => {\n+    let sent = 0;\n     const rs = new Readable({\n       read() {\n+        if (sent++ > 10) {\n+          return;\n+        }\n         rs.push('hello');\n       },\n       destroy: common.mustCall((err, cb) => {\n@@ -242,8 +251,12 @@ const { promisify } = require('util');\n       port: server.address().port\n     });\n \n+    let sent = 0;\n     const rs = new Readable({\n       read() {\n+        if (sent++ > 10) {\n+          return;\n+        }\n         rs.push('hello');\n       }\n     });"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 13,
        "deletions": 0
    }
}