{
    "author": "maclover7",
    "message": "tls: de-duplicate for TLSSocket methods\n\nSimilar approach is used for `TLSWrap`, where C++ handle methods are\nmapped one-to-one in JS.\n\nPR-URL: https://github.com/nodejs/node/pull/22142\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "3c2aa4b9f3a566c58d2958e96f239d59f509b50c",
    "files": [
        {
            "sha": "7df4b6612229aac34732d5a5f12d424643ed5daf",
            "filename": "lib/_tls_wrap.js",
            "status": "modified",
            "additions": 15,
            "deletions": 45,
            "changes": 60,
            "blob_url": "https://github.com/nodejs/node/blob/3c2aa4b9f3a566c58d2958e96f239d59f509b50c/lib%2F_tls_wrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/3c2aa4b9f3a566c58d2958e96f239d59f509b50c/lib%2F_tls_wrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_tls_wrap.js?ref=3c2aa4b9f3a566c58d2958e96f239d59f509b50c",
            "patch": "@@ -591,10 +591,6 @@ TLSSocket.prototype.setMaxSendFragment = function setMaxSendFragment(size) {\n   return this._handle.setMaxSendFragment(size) === 1;\n };\n \n-TLSSocket.prototype.getTLSTicket = function getTLSTicket() {\n-  return this._handle.getTLSTicket();\n-};\n-\n TLSSocket.prototype._handleTimeout = function() {\n   this._emitTLSError(new ERR_TLS_HANDSHAKE_TIMEOUT());\n };\n@@ -671,51 +667,25 @@ TLSSocket.prototype.getPeerCertificate = function(detailed) {\n   return null;\n };\n \n-TLSSocket.prototype.getFinished = function() {\n-  if (this._handle)\n-    return this._handle.getFinished();\n-};\n-\n-TLSSocket.prototype.getPeerFinished = function() {\n-  if (this._handle)\n-    return this._handle.getPeerFinished();\n-};\n-\n-TLSSocket.prototype.getSession = function() {\n-  if (this._handle) {\n-    return this._handle.getSession();\n-  }\n-\n-  return null;\n-};\n-\n-TLSSocket.prototype.isSessionReused = function() {\n-  if (this._handle) {\n-    return this._handle.isSessionReused();\n-  }\n-\n-  return null;\n-};\n-\n-TLSSocket.prototype.getCipher = function(err) {\n-  if (this._handle) {\n-    return this._handle.getCurrentCipher();\n-  } else {\n+// Proxy TLSSocket handle methods\n+function makeSocketMethodProxy(name) {\n+  return function socketMethodProxy(...args) {\n+    if (this._handle)\n+      return this._handle[name].apply(this._handle, args);\n     return null;\n-  }\n-};\n-\n-TLSSocket.prototype.getEphemeralKeyInfo = function() {\n-  if (this._handle)\n-    return this._handle.getEphemeralKeyInfo();\n+  };\n+}\n \n-  return null;\n-};\n+[\n+  'getFinished', 'getPeerFinished', 'getSession', 'isSessionReused',\n+  'getEphemeralKeyInfo', 'getProtocol', 'getTLSTicket'\n+].forEach((method) => {\n+  TLSSocket.prototype[method] = makeSocketMethodProxy(method);\n+});\n \n-TLSSocket.prototype.getProtocol = function() {\n+TLSSocket.prototype.getCipher = function(err) {\n   if (this._handle)\n-    return this._handle.getProtocol();\n-\n+    return this._handle.getCurrentCipher();\n   return null;\n };\n "
        }
    ],
    "stats": {
        "total": 60,
        "additions": 15,
        "deletions": 45
    }
}