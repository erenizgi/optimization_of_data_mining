{
    "author": "santigimeno",
    "message": "test: fix flaky repl-timeout-throw\n\nDon't disconnect the child until all exceptions are thrown.\n\nFixes: https://github.com/nodejs/node/issues/18659\n\nPR-URL: https://github.com/nodejs/node/pull/18692\nFixes: https://github.com/nodejs/node/issues/18659\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "01d049165c7d3ef9d102c85f0218044cb45f4787",
    "files": [
        {
            "sha": "3636b93ddfc2b2836591501502e62f30d8307439",
            "filename": "test/sequential/test-repl-timeout-throw.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/01d049165c7d3ef9d102c85f0218044cb45f4787/test%2Fsequential%2Ftest-repl-timeout-throw.js",
            "raw_url": "https://github.com/nodejs/node/raw/01d049165c7d3ef9d102c85f0218044cb45f4787/test%2Fsequential%2Ftest-repl-timeout-throw.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-repl-timeout-throw.js?ref=01d049165c7d3ef9d102c85f0218044cb45f4787",
            "patch": "@@ -1,5 +1,5 @@\n 'use strict';\n-const common = require('../common');\n+require('../common');\n const assert = require('assert');\n \n const spawn = require('child_process').spawn;\n@@ -13,6 +13,8 @@ child.stdout.setEncoding('utf8');\n child.stdout.on('data', function(c) {\n   process.stdout.write(c);\n   stdout += c;\n+  if (stdout.includes('> THROW 2'))\n+    child.stdin.end();\n });\n \n child.stdin.write = function(original) {\n@@ -46,8 +48,6 @@ child.stdout.once('data', function() {\n                       '    });\\n' +\n                       '  });\\n' +\n                       '});\"\";\\n');\n-\n-    setTimeout(child.stdin.end.bind(child.stdin), common.platformTimeout(200));\n   }\n });\n "
        }
    ],
    "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
    }
}