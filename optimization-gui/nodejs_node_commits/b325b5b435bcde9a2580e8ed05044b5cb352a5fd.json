{
    "author": "yhwang",
    "message": "test: fix test-abort-backtrace in shared lib build\n\nWhen using shared lib build, the binary path in the stack frames points\nto shared lib. Change the checking criteria in the test case to match\nthat.\n\nRefs: https://github.com/nodejs/node/issues/18535\n\nSigned-off-by: Yihong Wang <yh.wang@ibm.com>\n\nPR-URL: https://github.com/nodejs/node/pull/19213\nRefs: https://github.com/nodejs/node/issues/18535\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "b325b5b435bcde9a2580e8ed05044b5cb352a5fd",
    "files": [
        {
            "sha": "7f87ef0e7f45591e56f3be8fa11c033234b9fe1a",
            "filename": "test/abort/test-abort-backtrace.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/b325b5b435bcde9a2580e8ed05044b5cb352a5fd/test%2Fabort%2Ftest-abort-backtrace.js",
            "raw_url": "https://github.com/nodejs/node/raw/b325b5b435bcde9a2580e8ed05044b5cb352a5fd/test%2Fabort%2Ftest-abort-backtrace.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fabort%2Ftest-abort-backtrace.js?ref=b325b5b435bcde9a2580e8ed05044b5cb352a5fd",
            "patch": "@@ -19,7 +19,8 @@ if (process.argv[2] === 'child') {\n     }\n \n     if (!common.isWindows) {\n-      if (!frames.some((frame) => frame.includes(`[${process.execPath}]`))) {\n+      const { getBinaryPath } = require('../common/shared-lib-util');\n+      if (!frames.some((frame) => frame.includes(`[${getBinaryPath()}]`))) {\n         assert.fail(`Some frames should include the binary name:\\n${stderr}`);\n       }\n     }"
        },
        {
            "sha": "36c518a2f03c94b680086d852145de3ea720d6ae",
            "filename": "test/common/shared-lib-util.js",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/b325b5b435bcde9a2580e8ed05044b5cb352a5fd/test%2Fcommon%2Fshared-lib-util.js",
            "raw_url": "https://github.com/nodejs/node/raw/b325b5b435bcde9a2580e8ed05044b5cb352a5fd/test%2Fcommon%2Fshared-lib-util.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Fshared-lib-util.js?ref=b325b5b435bcde9a2580e8ed05044b5cb352a5fd",
            "patch": "@@ -28,7 +28,7 @@ exports.addLibraryPath = function(env) {\n     path.dirname(process.execPath);\n };\n \n-// Get the full path of shared lib\n+// Get the full path of shared lib.\n exports.getSharedLibPath = function() {\n   if (common.isWindows) {\n     return path.join(path.dirname(process.execPath), 'node.dll');\n@@ -41,3 +41,9 @@ exports.getSharedLibPath = function() {\n                      `libnode.${process.config.variables.shlib_suffix}`);\n   }\n };\n+\n+// Get the binary path of stack frames.\n+exports.getBinaryPath = function() {\n+  return process.config.variables.node_shared ?\n+    exports.getSharedLibPath() : process.execPath;\n+};"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
    }
}