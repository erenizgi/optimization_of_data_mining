{
    "author": "ryzokuken",
    "message": "tools: patch gyp to avoid xcrun errors\n\nPreviously running ./configure with only the Xcode Command Line Tools\ninstalled would give:\n\nxcrun: error: unable to lookup item 'PlatformPath' from command line tools installation\nxcrun: error: unable to lookup item 'PlatformPath' in SDK '/'\n\nCo-authored-by: Ben Noordhuis <info@bnoordhuis.nl>\nFixes: https://github.com/nodejs/node/issues/12531\n\nPR-URL: https://github.com/nodejs/node/pull/21520\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Gibson Fahnestock <gibfahn@gmail.com>\nReviewed-By: Refael Ackermann <refack@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "51812ff12b9e10549725bcda57167148428e256c",
    "files": [
        {
            "sha": "c303313a30fcebced6418f247686f4bebce4450c",
            "filename": "tools/gyp/pylib/gyp/xcode_emulation.py",
            "status": "modified",
            "additions": 9,
            "deletions": 7,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/51812ff12b9e10549725bcda57167148428e256c/tools%2Fgyp%2Fpylib%2Fgyp%2Fxcode_emulation.py",
            "raw_url": "https://github.com/nodejs/node/raw/51812ff12b9e10549725bcda57167148428e256c/tools%2Fgyp%2Fpylib%2Fgyp%2Fxcode_emulation.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fgyp%2Fpylib%2Fgyp%2Fxcode_emulation.py?ref=51812ff12b9e10549725bcda57167148428e256c",
            "patch": "@@ -645,9 +645,10 @@ def GetCflags(self, configname, arch=None):\n \n     cflags += self._Settings().get('WARNING_CFLAGS', [])\n \n-    platform_root = self._XcodePlatformPath(configname)\n-    if platform_root and self._IsXCTest():\n-      cflags.append('-F' + platform_root + '/Developer/Library/Frameworks/')\n+    if self._IsXCTest():\n+        platform_root = self._XcodePlatformPath(configname)\n+        if platform_root:\n+          cflags.append('-F' + platform_root + '/Developer/Library/Frameworks/')\n \n     if sdk_root:\n       framework_root = sdk_root\n@@ -913,10 +914,11 @@ def GetLdflags(self, configname, product_dir, gyp_to_build_path, arch=None):\n     for directory in framework_dirs:\n       ldflags.append('-F' + directory.replace('$(SDKROOT)', sdk_root))\n \n-    platform_root = self._XcodePlatformPath(configname)\n-    if sdk_root and platform_root and self._IsXCTest():\n-      ldflags.append('-F' + platform_root + '/Developer/Library/Frameworks/')\n-      ldflags.append('-framework XCTest')\n+    if self._IsXCTest():\n+        platform_root = self._XcodePlatformPath(configname)\n+        if sdk_root and platform_root:\n+          ldflags.append('-F' + platform_root + '/Developer/Library/Frameworks/')\n+          ldflags.append('-framework XCTest')\n \n     is_extension = self._IsIosAppExtension() or self._IsIosWatchKitExtension()\n     if sdk_root and is_extension:"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 9,
        "deletions": 7
    }
}