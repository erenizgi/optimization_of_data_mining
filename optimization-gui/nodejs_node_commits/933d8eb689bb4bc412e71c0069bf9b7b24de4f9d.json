{
    "author": "tniessen",
    "message": "crypto: move createCipher to runtime deprecation\n\nPR-URL: https://github.com/nodejs/node/pull/22089\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Yihong Wang <yh.wang@ibm.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Ujjwal Sharma <usharma1998@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "933d8eb689bb4bc412e71c0069bf9b7b24de4f9d",
    "files": [
        {
            "sha": "97042cbc7f86e79876ad5f755f6f4daefa4c9207",
            "filename": "doc/api/deprecations.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/doc%2Fapi%2Fdeprecations.md",
            "raw_url": "https://github.com/nodejs/node/raw/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/doc%2Fapi%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fdeprecations.md?ref=933d8eb689bb4bc412e71c0069bf9b7b24de4f9d",
            "patch": "@@ -954,7 +954,7 @@ Type: End-of-Life\n <a id=\"DEP0106\"></a>\n ### DEP0106: crypto.createCipher and crypto.createDecipher\n \n-Type: Documentation-only\n+Type: Runtime\n \n Using [`crypto.createCipher()`][] and [`crypto.createDecipher()`][] should be\n avoided as they use a weak key derivation function (MD5 with no salt) and static"
        },
        {
            "sha": "fa9412bc85289d21122669bb182f3b2d04986cb5",
            "filename": "lib/crypto.js",
            "status": "modified",
            "additions": 10,
            "deletions": 2,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/lib%2Fcrypto.js",
            "raw_url": "https://github.com/nodejs/node/raw/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/lib%2Fcrypto.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fcrypto.js?ref=933d8eb689bb4bc412e71c0069bf9b7b24de4f9d",
            "patch": "@@ -140,9 +140,7 @@ function createVerify(algorithm, options) {\n module.exports = exports = {\n   // Methods\n   _toBuf: toBuf,\n-  createCipher,\n   createCipheriv,\n-  createDecipher,\n   createDecipheriv,\n   createDiffieHellman,\n   createDiffieHellmanGroup,\n@@ -209,6 +207,16 @@ function getFipsForced() {\n }\n \n Object.defineProperties(exports, {\n+  createCipher: {\n+    enumerable: false,\n+    value: deprecate(createCipher,\n+                     'crypto.createCipher is deprecated.', 'DEP0106')\n+  },\n+  createDecipher: {\n+    enumerable: false,\n+    value: deprecate(createDecipher,\n+                     'crypto.createDecipher is deprecated.', 'DEP0106')\n+  },\n   // crypto.fips is deprecated. DEP0093. Use crypto.getFips()/crypto.setFips()\n   fips: {\n     get: !fipsMode ? getFipsDisabled :"
        },
        {
            "sha": "c7e89d6244d2d7361f73f0a36183f11d14520829",
            "filename": "test/parallel/test-crypto-authenticated.js",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/test%2Fparallel%2Ftest-crypto-authenticated.js",
            "raw_url": "https://github.com/nodejs/node/raw/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/test%2Fparallel%2Ftest-crypto-authenticated.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-authenticated.js?ref=933d8eb689bb4bc412e71c0069bf9b7b24de4f9d",
            "patch": "@@ -71,8 +71,10 @@ const expectedWarnings = common.hasFipsCrypto ?\n     ['Use Cipheriv for counter mode of aes-256-ccm', common.noWarnCode]\n   ];\n \n-const expectedDeprecationWarnings = ['crypto.DEFAULT_ENCODING is deprecated.',\n-                                     'DEP0091'];\n+const expectedDeprecationWarnings = [\n+  ['crypto.DEFAULT_ENCODING is deprecated.', 'DEP0091'],\n+  ['crypto.createCipher is deprecated.', 'DEP0106']\n+];\n \n common.expectWarning({\n   Warning: expectedWarnings,"
        },
        {
            "sha": "81c5f32d492839a72aef810ceacbd5c4041d3788",
            "filename": "test/parallel/test-crypto-cipher-decipher.js",
            "status": "modified",
            "additions": 9,
            "deletions": 4,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/test%2Fparallel%2Ftest-crypto-cipher-decipher.js",
            "raw_url": "https://github.com/nodejs/node/raw/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/test%2Fparallel%2Ftest-crypto-cipher-decipher.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-cipher-decipher.js?ref=933d8eb689bb4bc412e71c0069bf9b7b24de4f9d",
            "patch": "@@ -10,6 +10,15 @@ if (common.hasFipsCrypto)\n const crypto = require('crypto');\n const assert = require('assert');\n \n+common.expectWarning({\n+  Warning: [\n+    ['Use Cipheriv for counter mode of aes-256-gcm', common.noWarnCode]\n+  ],\n+  DeprecationWarning: [\n+    ['crypto.createCipher is deprecated.', 'DEP0106']\n+  ]\n+});\n+\n function testCipher1(key) {\n   // Test encryption and decryption\n   const plaintext = 'Keep this a secret? No! Tell everyone about node.js!';\n@@ -235,10 +244,6 @@ testCipher2(Buffer.from('0123456789abcdef'));\n   const aadbuf = Buffer.from('aadbuf');\n   const data = Buffer.from('test-crypto-cipher-decipher');\n \n-  common.expectWarning('Warning',\n-                       'Use Cipheriv for counter mode of aes-256-gcm',\n-                       common.noWarnCode);\n-\n   const cipher = crypto.createCipher('aes-256-gcm', key);\n   cipher.setAAD(aadbuf);\n   cipher.setAutoPadding();"
        },
        {
            "sha": "530b7a24047b9218bb4fd56fc45bba084b49c62e",
            "filename": "test/parallel/test-process-emit-warning-from-native.js",
            "status": "modified",
            "additions": 8,
            "deletions": 3,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/test%2Fparallel%2Ftest-process-emit-warning-from-native.js",
            "raw_url": "https://github.com/nodejs/node/raw/933d8eb689bb4bc412e71c0069bf9b7b24de4f9d/test%2Fparallel%2Ftest-process-emit-warning-from-native.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-emit-warning-from-native.js?ref=933d8eb689bb4bc412e71c0069bf9b7b24de4f9d",
            "patch": "@@ -11,9 +11,14 @@ const crypto = require('crypto');\n const key = '0123456789';\n \n {\n-  common.expectWarning('Warning',\n-                       'Use Cipheriv for counter mode of aes-256-gcm',\n-                       common.noWarnCode);\n+  common.expectWarning({\n+    DeprecationWarning: [\n+      ['crypto.createCipher is deprecated.', 'DEP0106']\n+    ],\n+    Warning: [\n+      ['Use Cipheriv for counter mode of aes-256-gcm', common.noWarnCode]\n+    ]\n+  });\n \n   // Emits regular warning expected by expectWarning()\n   crypto.createCipher('aes-256-gcm', key);"
        }
    ],
    "stats": {
        "total": 44,
        "additions": 32,
        "deletions": 12
    }
}