{
    "author": "BridgeAR",
    "message": "assert: fix generatedMessage\n\nThe generatedMessage was wrong in case simple assert was used and\na message was auto generated. This fixed the TODO.\n\nPR-URL: https://github.com/nodejs/node/pull/18322\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "a27f48d6199eac396a488b5625a1b3f629d5b070",
    "files": [
        {
            "sha": "8f324b86493f9803d2caf21f935990e48d53c574",
            "filename": "lib/assert.js",
            "status": "modified",
            "additions": 10,
            "deletions": 5,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/a27f48d6199eac396a488b5625a1b3f629d5b070/lib%2Fassert.js",
            "raw_url": "https://github.com/nodejs/node/raw/a27f48d6199eac396a488b5625a1b3f629d5b070/lib%2Fassert.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fassert.js?ref=a27f48d6199eac396a488b5625a1b3f629d5b070",
            "patch": "@@ -204,7 +204,10 @@ function innerOk(args, fn) {\n   var [value, message] = args;\n \n   if (!value) {\n+    let generatedMessage = false;\n+\n     if (args.length === 0) {\n+      generatedMessage = true;\n       message = 'No value argument passed to `assert.ok()`';\n     } else if (message == null) {\n       // Use the call as error message if possible.\n@@ -222,20 +225,22 @@ function innerOk(args, fn) {\n       const call = err.stack[0];\n       Error.prepareStackTrace = tmpPrepare;\n \n-      // TODO(BridgeAR): fix the \"generatedMessage property\"\n-      // Since this is actually a generated message, it has to be\n-      // determined differently from now on.\n-\n       // Make sure it would be \"null\" in case that is used.\n       message = getErrMessage(call) || message;\n+      generatedMessage = true;\n+    } else if (message instanceof Error) {\n+      throw message;\n     }\n-    innerFail({\n+\n+    const err = new AssertionError({\n       actual: value,\n       expected: true,\n       message,\n       operator: '==',\n       stackStartFn: fn\n     });\n+    err.generatedMessage = generatedMessage;\n+    throw err;\n   }\n }\n "
        },
        {
            "sha": "e422acbbfbcddd45ee6725a8b0b38c93f14d3ce2",
            "filename": "test/parallel/test-assert.js",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/a27f48d6199eac396a488b5625a1b3f629d5b070/test%2Fparallel%2Ftest-assert.js",
            "raw_url": "https://github.com/nodejs/node/raw/a27f48d6199eac396a488b5625a1b3f629d5b070/test%2Fparallel%2Ftest-assert.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-assert.js?ref=a27f48d6199eac396a488b5625a1b3f629d5b070",
            "patch": "@@ -919,6 +919,7 @@ common.expectsError(\n   {\n     code: 'ERR_ASSERTION',\n     type: assert.AssertionError,\n+    generatedMessage: true,\n     message: `The expression evaluated to a falsy value:${EOL}${EOL}  ` +\n              `assert.ok(null)${EOL}`\n   }\n@@ -928,6 +929,7 @@ common.expectsError(\n   {\n     code: 'ERR_ASSERTION',\n     type: assert.AssertionError,\n+    generatedMessage: true,\n     message: `The expression evaluated to a falsy value:${EOL}${EOL}  ` +\n              `assert(typeof 123 === 'string')${EOL}`\n   }\n@@ -1011,7 +1013,8 @@ common.expectsError(\n   {\n     code: 'ERR_ASSERTION',\n     type: assert.AssertionError,\n-    message: '0 == true'\n+    message: '0 == true',\n+    generatedMessage: true\n   }\n );\n \n@@ -1020,7 +1023,8 @@ common.expectsError(\n   {\n     code: 'ERR_ASSERTION',\n     type: assert.AssertionError,\n-    message: 'test'\n+    message: 'test',\n+    generatedMessage: false\n   }\n );\n "
        }
    ],
    "stats": {
        "total": 23,
        "additions": 16,
        "deletions": 7
    }
}