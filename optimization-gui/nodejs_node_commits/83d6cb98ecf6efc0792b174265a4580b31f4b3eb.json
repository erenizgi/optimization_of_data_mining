{
    "author": "addaleax",
    "message": "process: fix omitting `--` from `process.execArgv`\n\nThis was essentially a typo that went unnoticed because we\ndidnâ€™t have tests for this particular situation.\n\nFixes: https://github.com/nodejs/node/issues/24647\n\nPR-URL: https://github.com/nodejs/node/pull/24654\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Franziska Hinkelmann <franziska.hinkelmann@gmail.com>",
    "sha": "83d6cb98ecf6efc0792b174265a4580b31f4b3eb",
    "files": [
        {
            "sha": "468368ac84f6306703f216f3f9e073c75c20c47d",
            "filename": "src/node_options-inl.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/83d6cb98ecf6efc0792b174265a4580b31f4b3eb/src%2Fnode_options-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/83d6cb98ecf6efc0792b174265a4580b31f4b3eb/src%2Fnode_options-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_options-inl.h?ref=83d6cb98ecf6efc0792b174265a4580b31f4b3eb",
            "patch": "@@ -253,7 +253,7 @@ struct ArgsInfo {\n       // on the command line (i.e. not generated through alias expansion).\n       // '--' is a special case here since its purpose is to end `exec_argv`,\n       // which is why we do not include it.\n-      if (exec_args != nullptr && first() != \"--\")\n+      if (exec_args != nullptr && ret != \"--\")\n         exec_args->push_back(ret);\n       underlying->erase(underlying->begin() + 1);\n     } else {"
        },
        {
            "sha": "578ee7b5d1a5e333ca8b71fb76af500423c0271e",
            "filename": "test/parallel/test-process-exec-argv.js",
            "status": "modified",
            "additions": 13,
            "deletions": 10,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/83d6cb98ecf6efc0792b174265a4580b31f4b3eb/test%2Fparallel%2Ftest-process-exec-argv.js",
            "raw_url": "https://github.com/nodejs/node/raw/83d6cb98ecf6efc0792b174265a4580b31f4b3eb/test%2Fparallel%2Ftest-process-exec-argv.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-exec-argv.js?ref=83d6cb98ecf6efc0792b174265a4580b31f4b3eb",
            "patch": "@@ -27,16 +27,19 @@ const spawn = require('child_process').spawn;\n if (process.argv[2] === 'child') {\n   process.stdout.write(JSON.stringify(process.execArgv));\n } else {\n-  const execArgv = ['--stack-size=256'];\n-  const args = [__filename, 'child', 'arg0'];\n-  const child = spawn(process.execPath, execArgv.concat(args));\n-  let out = '';\n+  for (const extra of [ [], [ '--' ] ]) {\n+    const execArgv = ['--stack-size=256'];\n+    const args = [__filename, 'child', 'arg0'];\n+    const child = spawn(process.execPath, [...execArgv, ...extra, ...args]);\n+    let out = '';\n \n-  child.stdout.on('data', function(chunk) {\n-    out += chunk;\n-  });\n+    child.stdout.setEncoding('utf8');\n+    child.stdout.on('data', function(chunk) {\n+      out += chunk;\n+    });\n \n-  child.on('close', function() {\n-    assert.deepStrictEqual(JSON.parse(out), execArgv);\n-  });\n+    child.on('close', function() {\n+      assert.deepStrictEqual(JSON.parse(out), execArgv);\n+    });\n+  }\n }"
        }
    ],
    "stats": {
        "total": 25,
        "additions": 14,
        "deletions": 11
    }
}