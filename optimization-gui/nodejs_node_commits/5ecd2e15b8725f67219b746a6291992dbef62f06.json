{
    "author": "bshankar",
    "message": "test: improve error message output\n\nPR-URL: https://github.com/nodejs/node/pull/18498\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Gireesh Punathil <gpunathi@in.ibm.com>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>",
    "sha": "5ecd2e15b8725f67219b746a6291992dbef62f06",
    "files": [
        {
            "sha": "bcaa13d894bedcba90f49b6af7142bde090d7294",
            "filename": "test/addons-napi/test_general/test.js",
            "status": "modified",
            "additions": 14,
            "deletions": 8,
            "changes": 22,
            "blob_url": "https://github.com/nodejs/node/blob/5ecd2e15b8725f67219b746a6291992dbef62f06/test%2Faddons-napi%2Ftest_general%2Ftest.js",
            "raw_url": "https://github.com/nodejs/node/raw/5ecd2e15b8725f67219b746a6291992dbef62f06/test%2Faddons-napi%2Ftest_general%2Ftest.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Faddons-napi%2Ftest_general%2Ftest.js?ref=5ecd2e15b8725f67219b746a6291992dbef62f06",
            "patch": "@@ -63,22 +63,25 @@ let w = {};\n test_general.wrap(w);\n w = null;\n global.gc();\n-assert.strictEqual(test_general.derefItemWasCalled(), true,\n+const derefItemWasCalled = test_general.derefItemWasCalled();\n+assert.strictEqual(derefItemWasCalled, true,\n                    'deref_item() was called upon garbage collecting a ' +\n-                   'wrapped object');\n+                   'wrapped object. test_general.derefItemWasCalled() ' +\n+                   `returned ${derefItemWasCalled}`);\n+\n \n // Assert that wrapping twice fails.\n const x = {};\n test_general.wrap(x);\n-assert.throws(() => test_general.wrap(x), Error);\n+common.expectsError(() => test_general.wrap(x),\n+                    { type: Error, message: 'Invalid argument' });\n \n // Ensure that wrapping, removing the wrap, and then wrapping again works.\n const y = {};\n test_general.wrap(y);\n test_general.removeWrap(y);\n-assert.doesNotThrow(() => test_general.wrap(y), Error,\n-                    'Wrapping twice succeeds if a remove_wrap()' +\n-                    ' separates the instances');\n+// Wrapping twice succeeds if a remove_wrap() separates the instances\n+assert.doesNotThrow(() => test_general.wrap(y));\n \n // Ensure that removing a wrap and garbage collecting does not fire the\n // finalize callback.\n@@ -87,8 +90,11 @@ test_general.testFinalizeWrap(z);\n test_general.removeWrap(z);\n z = null;\n global.gc();\n-assert.strictEqual(test_general.finalizeWasCalled(), false,\n-                   'finalize callback was not called upon garbage collection');\n+const finalizeWasCalled = test_general.finalizeWasCalled();\n+assert.strictEqual(finalizeWasCalled, false,\n+                   'finalize callback was not called upon garbage collection.' +\n+                   ' test_general.finalizeWasCalled() ' +\n+                   `returned ${finalizeWasCalled}`);\n \n // test napi_adjust_external_memory\n const adjustedValue = test_general.testAdjustExternalMemory();"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 14,
        "deletions": 8
    }
}