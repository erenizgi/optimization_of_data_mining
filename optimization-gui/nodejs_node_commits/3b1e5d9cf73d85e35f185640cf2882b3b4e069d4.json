{
    "author": "mythrialle",
    "message": "src: request code cache explicitly\n\nEarlier we used to produce code cache along with compile. Now V8 has\nadded an API to request code cache. Support for producing code cache\nalong with compile will be removed soon.\n\nPR-URL: https://github.com/nodejs/node/pull/18453\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Yang Guo <yangguo@chromium.org>\nReviewed-By: Ali Ijaz Sheikh <ofrobots@google.com>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>",
    "sha": "3b1e5d9cf73d85e35f185640cf2882b3b4e069d4",
    "files": [
        {
            "sha": "ef785936b77a691a435b4d59c4d6e9b163476099",
            "filename": "src/node_contextify.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/3b1e5d9cf73d85e35f185640cf2882b3b4e069d4/src%2Fnode_contextify.cc",
            "raw_url": "https://github.com/nodejs/node/raw/3b1e5d9cf73d85e35f185640cf2882b3b4e069d4/src%2Fnode_contextify.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_contextify.cc?ref=3b1e5d9cf73d85e35f185640cf2882b3b4e069d4",
            "patch": "@@ -880,8 +880,6 @@ class ContextifyScript : public BaseObject {\n \n     if (source.GetCachedData() != nullptr)\n       compile_options = ScriptCompiler::kConsumeCodeCache;\n-    else if (produce_cached_data)\n-      compile_options = ScriptCompiler::kProduceCodeCache;\n \n     Context::Scope scope(maybe_context.FromMaybe(env->context()));\n \n@@ -903,8 +901,9 @@ class ContextifyScript : public BaseObject {\n       args.This()->Set(\n           env->cached_data_rejected_string(),\n           Boolean::New(env->isolate(), source.GetCachedData()->rejected));\n-    } else if (compile_options == ScriptCompiler::kProduceCodeCache) {\n-      const ScriptCompiler::CachedData* cached_data = source.GetCachedData();\n+    } else if (produce_cached_data) {\n+      const ScriptCompiler::CachedData* cached_data =\n+        ScriptCompiler::CreateCodeCache(v8_script.ToLocalChecked(), code);\n       bool cached_data_produced = cached_data != nullptr;\n       if (cached_data_produced) {\n         MaybeLocal<Object> buf = Buffer::Copy("
        }
    ],
    "stats": {
        "total": 7,
        "additions": 3,
        "deletions": 4
    }
}