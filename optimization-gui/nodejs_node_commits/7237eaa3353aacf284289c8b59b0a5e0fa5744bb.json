{
    "author": "unknown",
    "message": "url: return backslashes from fileURLToPath on win\n\nPR-URL: https://github.com/nodejs/node/pull/25349\nFixes: https://github.com/nodejs/node/issues/25265\nReviewed-By: Guy Bedford <guybedford@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Bartosz Sosnowski <bartosz@janeasystems.com>\nReviewed-By: John-David Dalton <john.david.dalton@gmail.com>",
    "sha": "7237eaa3353aacf284289c8b59b0a5e0fa5744bb",
    "files": [
        {
            "sha": "6ad7122b864353cefdf32e2eb8ea0eb4c3be03ee",
            "filename": "lib/internal/url.js",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/7237eaa3353aacf284289c8b59b0a5e0fa5744bb/lib%2Finternal%2Furl.js",
            "raw_url": "https://github.com/nodejs/node/raw/7237eaa3353aacf284289c8b59b0a5e0fa5744bb/lib%2Finternal%2Furl.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Furl.js?ref=7237eaa3353aacf284289c8b59b0a5e0fa5744bb",
            "patch": "@@ -1275,6 +1275,8 @@ function urlToOptions(url) {\n   return options;\n }\n \n+const forwardSlashRegEx = /\\//g;\n+\n function getPathFromURLWin32(url) {\n   var hostname = url.hostname;\n   var pathname = url.pathname;\n@@ -1289,6 +1291,7 @@ function getPathFromURLWin32(url) {\n       }\n     }\n   }\n+  pathname = pathname.replace(forwardSlashRegEx, '\\\\');\n   pathname = decodeURIComponent(pathname);\n   if (hostname !== '') {\n     // If hostname is set, then we have a UNC path\n@@ -1297,7 +1300,7 @@ function getPathFromURLWin32(url) {\n     // about percent encoding because the URL parser will have\n     // already taken care of that for us. Note that this only\n     // causes IDNs with an appropriate `xn--` prefix to be decoded.\n-    return `//${domainToUnicode(hostname)}${pathname}`;\n+    return `\\\\\\\\${domainToUnicode(hostname)}${pathname}`;\n   } else {\n     // Otherwise, it's a local path that requires a drive letter\n     var letter = pathname.codePointAt(1) | 0x20;"
        },
        {
            "sha": "c5f4d81dfb34f52f95ea7f91a2ce94516a00c9d2",
            "filename": "test/parallel/test-fs-whatwg-url.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7237eaa3353aacf284289c8b59b0a5e0fa5744bb/test%2Fparallel%2Ftest-fs-whatwg-url.js",
            "raw_url": "https://github.com/nodejs/node/raw/7237eaa3353aacf284289c8b59b0a5e0fa5744bb/test%2Fparallel%2Ftest-fs-whatwg-url.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-whatwg-url.js?ref=7237eaa3353aacf284289c8b59b0a5e0fa5744bb",
            "patch": "@@ -63,7 +63,7 @@ if (common.isWindows) {\n       code: 'ERR_INVALID_ARG_VALUE',\n       type: TypeError,\n       message: 'The argument \\'path\\' must be a string or Uint8Array without ' +\n-               'null bytes. Received \\'c:/tmp/\\\\u0000test\\''\n+               'null bytes. Received \\'c:\\\\\\\\tmp\\\\\\\\\\\\u0000test\\''\n     }\n   );\n } else {"
        },
        {
            "sha": "9a9b751201766f336c2ce6facdddb870e282b623",
            "filename": "test/parallel/test-url-fileurltopath.js",
            "status": "added",
            "additions": 152,
            "deletions": 0,
            "changes": 152,
            "blob_url": "https://github.com/nodejs/node/blob/7237eaa3353aacf284289c8b59b0a5e0fa5744bb/test%2Fparallel%2Ftest-url-fileurltopath.js",
            "raw_url": "https://github.com/nodejs/node/raw/7237eaa3353aacf284289c8b59b0a5e0fa5744bb/test%2Fparallel%2Ftest-url-fileurltopath.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-url-fileurltopath.js?ref=7237eaa3353aacf284289c8b59b0a5e0fa5744bb",
            "patch": "@@ -0,0 +1,152 @@\n+'use strict';\n+const { isWindows } = require('../common');\n+const assert = require('assert');\n+const url = require('url');\n+\n+function testInvalidArgs(...args) {\n+  for (const arg of args) {\n+    assert.throws(() => url.fileURLToPath(arg), {\n+      code: 'ERR_INVALID_ARG_TYPE'\n+    });\n+  }\n+}\n+\n+// Input must be string or URL\n+testInvalidArgs(null, undefined, 1, {}, true);\n+\n+// Input must be a file URL\n+assert.throws(() => url.fileURLToPath('https://a/b/c'), {\n+  code: 'ERR_INVALID_URL_SCHEME'\n+});\n+\n+{\n+  const withHost = new URL('file://host/a');\n+\n+  if (isWindows) {\n+    assert.strictEqual(url.fileURLToPath(withHost), '\\\\\\\\host\\\\a');\n+  } else {\n+    assert.throws(() => url.fileURLToPath(withHost), {\n+      code: 'ERR_INVALID_FILE_URL_HOST'\n+    });\n+  }\n+}\n+\n+{\n+  if (isWindows) {\n+    assert.throws(() => url.fileURLToPath('file:///C:/a%2F/'), {\n+      code: 'ERR_INVALID_FILE_URL_PATH'\n+    });\n+    assert.throws(() => url.fileURLToPath('file:///C:/a%5C/'), {\n+      code: 'ERR_INVALID_FILE_URL_PATH'\n+    });\n+    assert.throws(() => url.fileURLToPath('file:///?:/'), {\n+      code: 'ERR_INVALID_FILE_URL_PATH'\n+    });\n+  } else {\n+    assert.throws(() => url.fileURLToPath('file:///a%2F/'), {\n+      code: 'ERR_INVALID_FILE_URL_PATH'\n+    });\n+  }\n+}\n+\n+{\n+  let testCases;\n+  if (isWindows) {\n+    testCases = [\n+      // lowercase ascii alpha\n+      { path: 'C:\\\\foo', fileURL: 'file:///C:/foo' },\n+      // uppercase ascii alpha\n+      { path: 'C:\\\\FOO', fileURL: 'file:///C:/FOO' },\n+      // dir\n+      { path: 'C:\\\\dir\\\\foo', fileURL: 'file:///C:/dir/foo' },\n+      // trailing separator\n+      { path: 'C:\\\\dir\\\\', fileURL: 'file:///C:/dir/' },\n+      // dot\n+      { path: 'C:\\\\foo.mjs', fileURL: 'file:///C:/foo.mjs' },\n+      // space\n+      { path: 'C:\\\\foo bar', fileURL: 'file:///C:/foo%20bar' },\n+      // question mark\n+      { path: 'C:\\\\foo?bar', fileURL: 'file:///C:/foo%3Fbar' },\n+      // number sign\n+      { path: 'C:\\\\foo#bar', fileURL: 'file:///C:/foo%23bar' },\n+      // ampersand\n+      { path: 'C:\\\\foo&bar', fileURL: 'file:///C:/foo&bar' },\n+      // equals\n+      { path: 'C:\\\\foo=bar', fileURL: 'file:///C:/foo=bar' },\n+      // colon\n+      { path: 'C:\\\\foo:bar', fileURL: 'file:///C:/foo:bar' },\n+      // semicolon\n+      { path: 'C:\\\\foo;bar', fileURL: 'file:///C:/foo;bar' },\n+      // percent\n+      { path: 'C:\\\\foo%bar', fileURL: 'file:///C:/foo%25bar' },\n+      // backslash\n+      { path: 'C:\\\\foo\\\\bar', fileURL: 'file:///C:/foo/bar' },\n+      // backspace\n+      { path: 'C:\\\\foo\\bbar', fileURL: 'file:///C:/foo%08bar' },\n+      // tab\n+      { path: 'C:\\\\foo\\tbar', fileURL: 'file:///C:/foo%09bar' },\n+      // newline\n+      { path: 'C:\\\\foo\\nbar', fileURL: 'file:///C:/foo%0Abar' },\n+      // carriage return\n+      { path: 'C:\\\\foo\\rbar', fileURL: 'file:///C:/foo%0Dbar' },\n+      // latin1\n+      { path: 'C:\\\\fÃ³Ã³bÃ r', fileURL: 'file:///C:/f%C3%B3%C3%B3b%C3%A0r' },\n+      // euro sign (BMP code point)\n+      { path: 'C:\\\\â‚¬', fileURL: 'file:///C:/%E2%82%AC' },\n+      // rocket emoji (non-BMP code point)\n+      { path: 'C:\\\\ðŸš€', fileURL: 'file:///C:/%F0%9F%9A%80' }\n+    ];\n+  } else {\n+    testCases = [\n+      // lowercase ascii alpha\n+      { path: '/foo', fileURL: 'file:///foo' },\n+      // uppercase ascii alpha\n+      { path: '/FOO', fileURL: 'file:///FOO' },\n+      // dir\n+      { path: '/dir/foo', fileURL: 'file:///dir/foo' },\n+      // trailing separator\n+      { path: '/dir/', fileURL: 'file:///dir/' },\n+      // dot\n+      { path: '/foo.mjs', fileURL: 'file:///foo.mjs' },\n+      // space\n+      { path: '/foo bar', fileURL: 'file:///foo%20bar' },\n+      // question mark\n+      { path: '/foo?bar', fileURL: 'file:///foo%3Fbar' },\n+      // number sign\n+      { path: '/foo#bar', fileURL: 'file:///foo%23bar' },\n+      // ampersand\n+      { path: '/foo&bar', fileURL: 'file:///foo&bar' },\n+      // equals\n+      { path: '/foo=bar', fileURL: 'file:///foo=bar' },\n+      // colon\n+      { path: '/foo:bar', fileURL: 'file:///foo:bar' },\n+      // semicolon\n+      { path: '/foo;bar', fileURL: 'file:///foo;bar' },\n+      // percent\n+      { path: '/foo%bar', fileURL: 'file:///foo%25bar' },\n+      // backslash\n+      { path: '/foo\\\\bar', fileURL: 'file:///foo%5Cbar' },\n+      // backspace\n+      { path: '/foo\\bbar', fileURL: 'file:///foo%08bar' },\n+      // tab\n+      { path: '/foo\\tbar', fileURL: 'file:///foo%09bar' },\n+      // newline\n+      { path: '/foo\\nbar', fileURL: 'file:///foo%0Abar' },\n+      // carriage return\n+      { path: '/foo\\rbar', fileURL: 'file:///foo%0Dbar' },\n+      // latin1\n+      { path: '/fÃ³Ã³bÃ r', fileURL: 'file:///f%C3%B3%C3%B3b%C3%A0r' },\n+      // euro sign (BMP code point)\n+      { path: '/â‚¬', fileURL: 'file:///%E2%82%AC' },\n+      // rocket emoji (non-BMP code point)\n+      { path: '/ðŸš€', fileURL: 'file:///%F0%9F%9A%80' },\n+    ];\n+  }\n+\n+  for (const { path, fileURL } of testCases) {\n+    const fromString = url.fileURLToPath(fileURL);\n+    assert.strictEqual(fromString, path);\n+    const fromURL = url.fileURLToPath(new URL(fileURL));\n+    assert.strictEqual(fromURL, path);\n+  }\n+}"
        }
    ],
    "stats": {
        "total": 159,
        "additions": 157,
        "deletions": 2
    }
}