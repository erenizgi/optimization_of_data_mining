{
    "author": "addaleax",
    "message": "src: clean up PackageConfig pseudo-boolean fields\n\nPR-URL: https://github.com/nodejs/node/pull/21987\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "a196aa2e24ef7069289fa4a9aa8c6862d82e6b5f",
    "files": [
        {
            "sha": "8e6da729c4094f4dc95bb241b5f8d1a87610028f",
            "filename": "src/env.h",
            "status": "modified",
            "additions": 10,
            "deletions": 17,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/a196aa2e24ef7069289fa4a9aa8c6862d82e6b5f/src%2Fenv.h",
            "raw_url": "https://github.com/nodejs/node/raw/a196aa2e24ef7069289fa4a9aa8c6862d82e6b5f/src%2Fenv.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv.h?ref=a196aa2e24ef7069289fa4a9aa8c6862d82e6b5f",
            "patch": "@@ -65,23 +65,15 @@ class Worker;\n namespace loader {\n class ModuleWrap;\n \n-struct Exists {\n-  enum Bool { Yes, No };\n-};\n-\n-struct IsValid {\n-  enum Bool { Yes, No };\n-};\n-\n-struct HasMain {\n-  enum Bool { Yes, No };\n-};\n-\n struct PackageConfig {\n-  const Exists::Bool exists;\n-  const IsValid::Bool is_valid;\n-  const HasMain::Bool has_main;\n-  const std::string main;\n+  enum class Exists { Yes, No };\n+  enum class IsValid { Yes, No };\n+  enum class HasMain { Yes, No };\n+\n+  Exists exists;\n+  IsValid is_valid;\n+  HasMain has_main;\n+  std::string main;\n };\n }  // namespace loader\n \n@@ -672,7 +664,8 @@ class Environment {\n \n   std::unordered_multimap<int, loader::ModuleWrap*> module_map;\n \n-  std::unordered_map<std::string, loader::PackageConfig> package_json_cache;\n+  std::unordered_map<std::string, const loader::PackageConfig>\n+      package_json_cache;\n \n   inline double* heap_statistics_buffer() const;\n   inline void set_heap_statistics_buffer(double* pointer);"
        },
        {
            "sha": "63e886ab0d7ac07c0082e9f6a933be0a97802171",
            "filename": "src/module_wrap.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/a196aa2e24ef7069289fa4a9aa8c6862d82e6b5f/src%2Fmodule_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/a196aa2e24ef7069289fa4a9aa8c6862d82e6b5f/src%2Fmodule_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fmodule_wrap.cc?ref=a196aa2e24ef7069289fa4a9aa8c6862d82e6b5f",
            "patch": "@@ -488,8 +488,12 @@ Maybe<uv_file> CheckFile(const std::string& path,\n   return Just(fd);\n }\n \n+using Exists = PackageConfig::Exists;\n+using IsValid = PackageConfig::IsValid;\n+using HasMain = PackageConfig::HasMain;\n+\n const PackageConfig& GetPackageConfig(Environment* env,\n-                                                   const std::string path) {\n+                                      const std::string& path) {\n   auto existing = env->package_json_cache.find(path);\n   if (existing != env->package_json_cache.end()) {\n     return existing->second;\n@@ -530,7 +534,7 @@ const PackageConfig& GetPackageConfig(Environment* env,\n   }\n \n   Local<Value> pkg_main;\n-  HasMain::Bool has_main = HasMain::No;\n+  HasMain has_main = HasMain::No;\n   std::string main_std;\n   if (pkg_json->Get(env->context(), env->main_string()).ToLocal(&pkg_main)) {\n     has_main = HasMain::Yes;"
        }
    ],
    "stats": {
        "total": 35,
        "additions": 16,
        "deletions": 19
    }
}