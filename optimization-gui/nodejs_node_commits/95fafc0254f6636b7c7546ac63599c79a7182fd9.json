{
    "author": "apapirovski",
    "message": "http: fix undefined error in parser event\n\nThe current check for socket.server[kIncomingMessage] does not\naccount for the possibility of a socket.server that doesn't\nhave that property defined. Fix it.\n\nPR-URL: https://github.com/nodejs/node/pull/20029\nFixes: https://github.com/nodejs/node/issues/19231\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Khaidi Chu <i@2333.moe>",
    "sha": "95fafc0254f6636b7c7546ac63599c79a7182fd9",
    "files": [
        {
            "sha": "7f53aca246b040371e385946570eeecae2eaa6f8",
            "filename": "lib/_http_common.js",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/95fafc0254f6636b7c7546ac63599c79a7182fd9/lib%2F_http_common.js",
            "raw_url": "https://github.com/nodejs/node/raw/95fafc0254f6636b7c7546ac63599c79a7182fd9/lib%2F_http_common.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_common.js?ref=95fafc0254f6636b7c7546ac63599c79a7182fd9",
            "patch": "@@ -62,7 +62,8 @@ function parserOnHeaders(headers, url) {\n function parserOnHeadersComplete(versionMajor, versionMinor, headers, method,\n                                  url, statusCode, statusMessage, upgrade,\n                                  shouldKeepAlive) {\n-  var parser = this;\n+  const parser = this;\n+  const { socket } = parser;\n \n   if (!headers) {\n     headers = parser._headers;\n@@ -75,10 +76,11 @@ function parserOnHeadersComplete(versionMajor, versionMinor, headers, method,\n   }\n \n   // Parser is also used by http client\n-  var ParserIncomingMessage = parser.socket && parser.socket.server ?\n-    parser.socket.server[kIncomingMessage] : IncomingMessage;\n+  const ParserIncomingMessage = (socket && socket.server &&\n+                                 socket.server[kIncomingMessage]) ||\n+                                 IncomingMessage;\n \n-  parser.incoming = new ParserIncomingMessage(parser.socket);\n+  parser.incoming = new ParserIncomingMessage(socket);\n   parser.incoming.httpVersionMajor = versionMajor;\n   parser.incoming.httpVersionMinor = versionMinor;\n   parser.incoming.httpVersion = `${versionMajor}.${versionMinor}`;"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
    }
}