{
    "author": "joyeecheung",
    "message": "process: remove pushValueToArray in GetActiveRequests\n\nInstead of calling into JS from C++ to push values into an array,\nuse the new Array::New API that takes a pointer and a length\ndirectly.\n\nPR-URL: https://github.com/nodejs/node/pull/24264\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Refael Ackermann <refack@gmail.com>",
    "sha": "235afb4c6ad79fbf44c2a2d8e1aa8b85b5ac39f7",
    "files": [
        {
            "sha": "6e9c06e02d81b836829521095aedf3c9bf6a7a79",
            "filename": "src/node_process.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 16,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/235afb4c6ad79fbf44c2a2d8e1aa8b85b5ac39f7/src%2Fnode_process.cc",
            "raw_url": "https://github.com/nodejs/node/raw/235afb4c6ad79fbf44c2a2d8e1aa8b85b5ac39f7/src%2Fnode_process.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_process.cc?ref=235afb4c6ad79fbf44c2a2d8e1aa8b85b5ac39f7",
            "patch": "@@ -797,29 +797,17 @@ void GetActiveRequests(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n \n   Local<Array> ary = Array::New(args.GetIsolate());\n-  Local<Context> ctx = env->context();\n-  Local<Function> fn = env->push_values_to_array_function();\n-  Local<Value> argv[NODE_PUSH_VAL_TO_ARRAY_MAX];\n-  size_t idx = 0;\n-\n+  std::vector<Local<Value>> request_v;\n   for (auto w : *env->req_wrap_queue()) {\n     if (w->persistent().IsEmpty())\n       continue;\n-    argv[idx] = w->GetOwner();\n-    if (++idx >= arraysize(argv)) {\n-      fn->Call(ctx, ary, idx, argv).ToLocalChecked();\n-      idx = 0;\n-    }\n-  }\n-\n-  if (idx > 0) {\n-    fn->Call(ctx, ary, idx, argv).ToLocalChecked();\n+    request_v.push_back(w->GetOwner());\n   }\n \n-  args.GetReturnValue().Set(ary);\n+  args.GetReturnValue().Set(\n+      Array::New(env->isolate(), request_v.data(), request_v.size()));\n }\n \n-\n // Non-static, friend of HandleWrap. Could have been a HandleWrap method but\n // implemented here for consistency with GetActiveRequests().\n void GetActiveHandles(const FunctionCallbackInfo<Value>& args) {"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 4,
        "deletions": 16
    }
}