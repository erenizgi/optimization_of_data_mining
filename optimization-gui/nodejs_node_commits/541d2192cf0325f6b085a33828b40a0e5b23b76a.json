{
    "author": "BridgeAR",
    "message": "test: fix a TODO and remove obsolete TODOs\n\nThis removes outdated TODOs and adds a test for invalid input in\n`fs.copyFile` and solves a TODO by doing so.\n\nPR-URL: https://github.com/nodejs/node/pull/20319\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "541d2192cf0325f6b085a33828b40a0e5b23b76a",
    "files": [
        {
            "sha": "e4326e80b5d9486b0ef8db6f0145a407e3e92386",
            "filename": "lib/url.js",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/541d2192cf0325f6b085a33828b40a0e5b23b76a/lib%2Furl.js",
            "raw_url": "https://github.com/nodejs/node/raw/541d2192cf0325f6b085a33828b40a0e5b23b76a/lib%2Furl.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Furl.js?ref=541d2192cf0325f6b085a33828b40a0e5b23b76a",
            "patch": "@@ -281,9 +281,6 @@ Url.prototype.parse = function parse(url, parseQueryString, slashesDenoteHost) {\n     // http://a@b@c/ => user:a@b host:c\n     // http://a@b?@c => user:a host:b path:/?@c\n \n-    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n-    // Review our test case against browsers more comprehensively.\n-\n     var hostEnd = -1;\n     var atSign = -1;\n     var nonHost = -1;"
        },
        {
            "sha": "9e039541cd26f1104f334534ad335405082693c2",
            "filename": "test/parallel/test-cluster-http-pipe.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/541d2192cf0325f6b085a33828b40a0e5b23b76a/test%2Fparallel%2Ftest-cluster-http-pipe.js",
            "raw_url": "https://github.com/nodejs/node/raw/541d2192cf0325f6b085a33828b40a0e5b23b76a/test%2Fparallel%2Ftest-cluster-http-pipe.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-cluster-http-pipe.js?ref=541d2192cf0325f6b085a33828b40a0e5b23b76a",
            "patch": "@@ -45,7 +45,6 @@ if (cluster.isMaster) {\n http.createServer(common.mustCall((req, res) => {\n   assert.strictEqual(req.connection.remoteAddress, undefined);\n   assert.strictEqual(req.connection.localAddress, undefined);\n-  // TODO common.PIPE?\n \n   res.writeHead(200);\n   res.end('OK');"
        },
        {
            "sha": "28141f33f629655c62ca7d614a1a54e2099f8936",
            "filename": "test/parallel/test-fs-error-messages.js",
            "status": "modified",
            "additions": 11,
            "deletions": 12,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/541d2192cf0325f6b085a33828b40a0e5b23b76a/test%2Fparallel%2Ftest-fs-error-messages.js",
            "raw_url": "https://github.com/nodejs/node/raw/541d2192cf0325f6b085a33828b40a0e5b23b76a/test%2Fparallel%2Ftest-fs-error-messages.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-error-messages.js?ref=541d2192cf0325f6b085a33828b40a0e5b23b76a",
            "patch": "@@ -636,22 +636,21 @@ if (!common.isAIX) {\n   );\n }\n \n-// copyFile with invalid flags\n+// Check copyFile with invalid flags.\n {\n-  const validateError = (err) => {\n-    assert.strictEqual(err.message,\n-                       'EINVAL: invalid argument, copyfile ' +\n-                       `'${existingFile}' -> '${nonexistentFile}'`);\n-    assert.strictEqual(err.errno, uv.UV_EINVAL);\n-    assert.strictEqual(err.code, 'EINVAL');\n-    assert.strictEqual(err.syscall, 'copyfile');\n-    return true;\n+  const validateError = {\n+    // TODO: Make sure the error message always also contains the src.\n+    message: `EINVAL: invalid argument, copyfile -> '${nonexistentFile}'`,\n+    errno: uv.UV_EINVAL,\n+    code: 'EINVAL',\n+    syscall: 'copyfile'\n   };\n \n-  // TODO(joyeecheung): test fs.copyFile() when uv_fs_copyfile does not\n-  // keep the loop open when the flags are invalid.\n-  // See https://github.com/libuv/libuv/pull/1747\n+  fs.copyFile(existingFile, nonexistentFile, -1,\n+              common.expectsError(validateError));\n \n+  validateError.message = 'EINVAL: invalid argument, copyfile ' +\n+                          `'${existingFile}' -> '${nonexistentFile}'`;\n   assert.throws(\n     () => fs.copyFileSync(existingFile, nonexistentFile, -1),\n     validateError"
        },
        {
            "sha": "938781a43084a5e9576956c1c6883a92658a9c13",
            "filename": "test/parallel/test-util-isDeepStrictEqual.js",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/541d2192cf0325f6b085a33828b40a0e5b23b76a/test%2Fparallel%2Ftest-util-isDeepStrictEqual.js",
            "raw_url": "https://github.com/nodejs/node/raw/541d2192cf0325f6b085a33828b40a0e5b23b76a/test%2Fparallel%2Ftest-util-isDeepStrictEqual.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-util-isDeepStrictEqual.js?ref=541d2192cf0325f6b085a33828b40a0e5b23b76a",
            "patch": "@@ -419,8 +419,6 @@ notUtilIsDeepStrict([1, , , 3], [1, , , 3, , , ]);\n   const err3 = new TypeError('foo1');\n   notUtilIsDeepStrict(err1, err2, assert.AssertionError);\n   notUtilIsDeepStrict(err1, err3, assert.AssertionError);\n-  // TODO: evaluate if this should throw or not. The same applies for RegExp\n-  // Date and any object that has the same keys but not the same prototype.\n   notUtilIsDeepStrict(err1, {}, assert.AssertionError);\n }\n "
        }
    ],
    "stats": {
        "total": 29,
        "additions": 11,
        "deletions": 18
    }
}