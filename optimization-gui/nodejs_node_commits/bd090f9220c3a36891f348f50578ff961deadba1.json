{
    "author": "BridgeAR",
    "message": "util: mark special entries as such\n\nThis adds the color code to special entries if colors are active.\n\nPR-URL: https://github.com/nodejs/node/pull/22287\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "bd090f9220c3a36891f348f50578ff961deadba1",
    "files": [
        {
            "sha": "33c4cdfff72167f80a25104ee17e9f21f616b920",
            "filename": "lib/util.js",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/bd090f9220c3a36891f348f50578ff961deadba1/lib%2Futil.js",
            "raw_url": "https://github.com/nodejs/node/raw/bd090f9220c3a36891f348f50578ff961deadba1/lib%2Futil.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Futil.js?ref=bd090f9220c3a36891f348f50578ff961deadba1",
            "patch": "@@ -758,14 +758,14 @@ function formatValue(ctx, value, recurseTimes) {\n       if (ctx.showHidden) {\n         formatter = formatWeakSet;\n       } else {\n-        extra = '<items unknown>';\n+        extra = ctx.stylize('<items unknown>', 'special');\n       }\n     } else if (isWeakMap(value)) {\n       braces[0] = `${getPrefix(constructor, tag, 'WeakMap')}{`;\n       if (ctx.showHidden) {\n         formatter = formatWeakMap;\n       } else {\n-        extra = '<items unknown>';\n+        extra = ctx.stylize('<items unknown>', 'special');\n       }\n     } else if (types.isModuleNamespaceObject(value)) {\n       braces[0] = `[${tag}] {`;\n@@ -1210,14 +1210,18 @@ function formatPromise(ctx, value, recurseTimes, keys) {\n   let output;\n   const [state, result] = getPromiseDetails(value);\n   if (state === kPending) {\n-    output = ['<pending>'];\n+    output = [ctx.stylize('<pending>', 'special')];\n   } else {\n     // Using `formatValue` is correct here without the need to fix the\n     // indentation level.\n     ctx.indentationLvl += 2;\n     const str = formatValue(ctx, result, recurseTimes);\n     ctx.indentationLvl -= 2;\n-    output = [state === kRejected ? `<rejected> ${str}` : str];\n+    output = [\n+      state === kRejected ?\n+        `${ctx.stylize('<rejected>', 'special')} ${str}` :\n+        str\n+    ];\n   }\n   for (var n = 0; n < keys.length; n++) {\n     output.push(formatProperty(ctx, value, recurseTimes, keys[n], 0));"
        },
        {
            "sha": "433b16c39e7ce5e81edc4a04f7c1a3e822d8e758",
            "filename": "test/parallel/test-util-inspect.js",
            "status": "modified",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/bd090f9220c3a36891f348f50578ff961deadba1/test%2Fparallel%2Ftest-util-inspect.js",
            "raw_url": "https://github.com/nodejs/node/raw/bd090f9220c3a36891f348f50578ff961deadba1/test%2Fparallel%2Ftest-util-inspect.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-util-inspect.js?ref=bd090f9220c3a36891f348f50578ff961deadba1",
            "patch": "@@ -1647,3 +1647,30 @@ assert.strictEqual(inspect(new BigUint64Array([0n])), 'BigUint64Array [ 0n ]');\n     '{ [Non\\\\nenumerable\\\\tkey]: true }'\n   );\n }\n+\n+// Check for special colors.\n+{\n+  const special = inspect.colors[inspect.styles.special];\n+  const string = inspect.colors[inspect.styles.string];\n+\n+  assert.strictEqual(\n+    inspect(new WeakSet(), { colors: true }),\n+    `WeakSet { \\u001b[${special[0]}m<items unknown>\\u001b[${special[1]}m }`\n+  );\n+  assert.strictEqual(\n+    inspect(new WeakMap(), { colors: true }),\n+    `WeakMap { \\u001b[${special[0]}m<items unknown>\\u001b[${special[1]}m }`\n+  );\n+  assert.strictEqual(\n+    inspect(new Promise(() => {}), { colors: true }),\n+    `Promise { \\u001b[${special[0]}m<pending>\\u001b[${special[1]}m }`\n+  );\n+\n+  const rejection = Promise.reject('Oh no!');\n+  assert.strictEqual(\n+    inspect(rejection, { colors: true }),\n+    `Promise { \\u001b[${special[0]}m<rejected>\\u001b[${special[1]}m ` +\n+    `\\u001b[${string[0]}m'Oh no!'\\u001b[${string[1]}m }`\n+  );\n+  rejection.catch(() => {});\n+}"
        }
    ],
    "stats": {
        "total": 39,
        "additions": 35,
        "deletions": 4
    }
}