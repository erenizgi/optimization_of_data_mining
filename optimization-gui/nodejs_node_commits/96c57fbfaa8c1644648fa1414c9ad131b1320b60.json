{
    "author": "BridgeAR",
    "message": "lib: switch to Number.isNaN\n\nNumber.isNaN is now as fast as `val !== val`. Switch to the more\nreadable version. Also switch all `isNaN` to `Number.isNaN`.\n\nPR-URL: https://github.com/nodejs/node/pull/18744\nReviewed-By: Weijia Wang <starkwang@126.com>\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Yuta Hiroto <hello@about-hiroppy.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "96c57fbfaa8c1644648fa1414c9ad131b1320b60",
    "files": [
        {
            "sha": "a46caecf085bb867860e2e0b5c7ec1cb97fabf2f",
            "filename": ".eslintrc.yaml",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/.eslintrc.yaml",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/.eslintrc.yaml",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/.eslintrc.yaml?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -74,6 +74,7 @@ rules:\n       message: __defineSetter__ is deprecated.\n   no-return-await: error\n   no-self-assign: error\n+  no-self-compare: error\n   no-throw-literal: error\n   no-unused-labels: error\n   no-useless-call: error"
        },
        {
            "sha": "5cdc0864a0e1ebeb1f59aaf2377cc56d0c424f36",
            "filename": "lib/_stream_readable.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2F_stream_readable.js",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2F_stream_readable.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_stream_readable.js?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -341,7 +341,7 @@ function howMuchToRead(n, state) {\n     return 0;\n   if (state.objectMode)\n     return 1;\n-  if (n !== n) {\n+  if (Number.isNaN(n)) {\n     // Only flow one buffer at a time\n     if (state.flowing && state.length)\n       return state.buffer.head.data.length;"
        },
        {
            "sha": "f43f67bb9404c57707e00888e609ad966f8c0093",
            "filename": "lib/buffer.js",
            "status": "modified",
            "additions": 10,
            "deletions": 10,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Fbuffer.js",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Fbuffer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fbuffer.js?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -363,8 +363,7 @@ function fromArrayBuffer(obj, byteOffset, length) {\n     byteOffset = 0;\n   } else {\n     byteOffset = +byteOffset;\n-    // check for NaN\n-    if (byteOffset !== byteOffset)\n+    if (Number.isNaN(byteOffset))\n       byteOffset = 0;\n   }\n \n@@ -376,7 +375,7 @@ function fromArrayBuffer(obj, byteOffset, length) {\n   if (length === undefined) {\n     length = maxLength;\n   } else {\n-    // convert length to non-negative integer\n+    // Convert length to non-negative integer.\n     length = +length;\n     if (length > 0) {\n       if (length > maxLength)\n@@ -760,8 +759,7 @@ function bidirectionalIndexOf(buffer, val, byteOffset, encoding, dir) {\n   // Coerce to Number. Values like null and [] become 0.\n   byteOffset = +byteOffset;\n   // If the offset is undefined, \"foo\", {}, coerces to NaN, search whole buffer.\n-  // `x !== x`-style conditionals are a faster form of `isNaN(x)`\n-  if (byteOffset !== byteOffset) {\n+  if (Number.isNaN(byteOffset)) {\n     byteOffset = dir ? 0 : buffer.length;\n   }\n   dir = !!dir;  // Cast to bool.\n@@ -996,15 +994,17 @@ function adjustOffset(offset, length) {\n   // Use Math.trunc() to convert offset to an integer value that can be larger\n   // than an Int32. Hence, don't use offset | 0 or similar techniques.\n   offset = Math.trunc(offset);\n-  // `x !== x`-style conditionals are a faster form of `isNaN(x)`\n-  if (offset === 0 || offset !== offset) {\n+  if (offset === 0) {\n     return 0;\n-  } else if (offset < 0) {\n+  }\n+  if (offset < 0) {\n     offset += length;\n     return offset > 0 ? offset : 0;\n-  } else {\n-    return offset < length ? offset : length;\n   }\n+  if (offset < length) {\n+    return offset;\n+  }\n+  return Number.isNaN(offset) ? 0 : length;\n }\n \n "
        },
        {
            "sha": "aec30e7239d13d261ede303690307c12ad5beebb",
            "filename": "lib/events.js",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Fevents.js",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Fevents.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fevents.js?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -52,9 +52,7 @@ Object.defineProperty(EventEmitter, 'defaultMaxListeners', {\n     return defaultMaxListeners;\n   },\n   set: function(arg) {\n-    // check whether the input is a positive number (whose value is zero or\n-    // greater and not a NaN).\n-    if (typeof arg !== 'number' || arg < 0 || arg !== arg) {\n+    if (typeof arg !== 'number' || arg < 0 || Number.isNaN(arg)) {\n       const errors = lazyErrors();\n       throw new errors.RangeError('ERR_OUT_OF_RANGE',\n                                   'defaultMaxListeners',\n@@ -79,7 +77,7 @@ EventEmitter.init = function() {\n // Obviously not all Emitters should be limited to 10. This function allows\n // that to be increased. Set to zero for unlimited.\n EventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n-  if (typeof n !== 'number' || n < 0 || isNaN(n)) {\n+  if (typeof n !== 'number' || n < 0 || Number.isNaN(n)) {\n     const errors = lazyErrors();\n     throw new errors.RangeError('ERR_OUT_OF_RANGE', 'n',\n                                 'a non-negative number', n);"
        },
        {
            "sha": "9ffaa4de76f6525d450196c3276f6b9bb5b728fa",
            "filename": "lib/internal/crypto/random.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Finternal%2Fcrypto%2Frandom.js",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Finternal%2Fcrypto%2Frandom.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fcrypto%2Frandom.js?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -11,7 +11,7 @@ const { kMaxLength } = require('buffer');\n const kMaxUint32 = Math.pow(2, 32) - 1;\n \n function assertOffset(offset, length) {\n-  if (typeof offset !== 'number' || offset !== offset) {\n+  if (typeof offset !== 'number' || Number.isNaN(offset)) {\n     throw new errors.TypeError('ERR_INVALID_ARG_TYPE', 'offset', 'number');\n   }\n \n@@ -25,7 +25,7 @@ function assertOffset(offset, length) {\n }\n \n function assertSize(size, offset = 0, length = Infinity) {\n-  if (typeof size !== 'number' || size !== size) {\n+  if (typeof size !== 'number' || Number.isNaN(size)) {\n     throw new errors.TypeError('ERR_INVALID_ARG_TYPE', 'size', 'number');\n   }\n "
        },
        {
            "sha": "4c4e3c8cb4e2754fde5e2aa6c454c65f98c07d38",
            "filename": "lib/internal/repl.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Finternal%2Frepl.js",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Finternal%2Frepl.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Frepl.js?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -51,7 +51,7 @@ function createRepl(env, opts, cb) {\n   }\n \n   const historySize = Number(env.NODE_REPL_HISTORY_SIZE);\n-  if (!isNaN(historySize) && historySize > 0) {\n+  if (!Number.isNaN(historySize) && historySize > 0) {\n     opts.historySize = historySize;\n   } else {\n     // XXX(chrisdickinson): set here to avoid affecting existing applications"
        },
        {
            "sha": "41ddda767d832ab8b39eefe745f668ee49b24dd1",
            "filename": "lib/net.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Fnet.js",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Fnet.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fnet.js?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -1304,7 +1304,7 @@ function createServerHandle(address, port, addressType, fd) {\n     handle = new Pipe(PipeConstants.SERVER);\n     if (process.platform === 'win32') {\n       var instances = parseInt(process.env.NODE_PENDING_PIPE_INSTANCES);\n-      if (!isNaN(instances)) {\n+      if (!Number.isNaN(instances)) {\n         handle.setPendingInstances(instances);\n       }\n     }"
        },
        {
            "sha": "15933e69302d840f1c51105ba9d276ae235b2af1",
            "filename": "lib/readline.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Freadline.js",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Freadline.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Freadline.js?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -103,7 +103,7 @@ function Interface(input, output, completer, terminal) {\n   }\n \n   if (typeof historySize !== 'number' ||\n-      isNaN(historySize) ||\n+      Number.isNaN(historySize) ||\n       historySize < 0) {\n     throw new errors.RangeError(\n       'ERR_INVALID_OPT_VALUE',"
        },
        {
            "sha": "bd41ecdccf6972f4dd86429213679504918b48d7",
            "filename": "lib/repl.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Frepl.js",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Frepl.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Frepl.js?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -575,7 +575,7 @@ function REPLServer(prompt,\n     // display next prompt and return.\n     if (trimmedCmd) {\n       if (trimmedCmd.charAt(0) === '.' && trimmedCmd.charAt(1) !== '.' &&\n-          isNaN(parseFloat(trimmedCmd))) {\n+          Number.isNaN(parseFloat(trimmedCmd))) {\n         const matches = trimmedCmd.match(/^\\.([^\\s]+)\\s*(.*)$/);\n         const keyword = matches && matches[1];\n         const rest = matches && matches[2];"
        },
        {
            "sha": "aff72a868612e5c161a4961b50b58e03680593f9",
            "filename": "lib/zlib.js",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Fzlib.js",
            "raw_url": "https://github.com/nodejs/node/raw/96c57fbfaa8c1644648fa1414c9ad131b1320b60/lib%2Fzlib.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fzlib.js?ref=96c57fbfaa8c1644648fa1414c9ad131b1320b60",
            "patch": "@@ -177,7 +177,7 @@ function Zlib(opts, mode) {\n \n   if (opts) {\n     chunkSize = opts.chunkSize;\n-    if (chunkSize !== undefined && chunkSize === chunkSize) {\n+    if (chunkSize !== undefined && !Number.isNaN(chunkSize)) {\n       if (chunkSize < Z_MIN_CHUNK || !Number.isFinite(chunkSize))\n         throw new errors.RangeError('ERR_INVALID_OPT_VALUE',\n                                     'chunkSize',\n@@ -187,15 +187,15 @@ function Zlib(opts, mode) {\n     }\n \n     flush = opts.flush;\n-    if (flush !== undefined && flush === flush) {\n+    if (flush !== undefined && !Number.isNaN(flush)) {\n       if (flush < Z_NO_FLUSH || flush > Z_BLOCK || !Number.isFinite(flush))\n         throw new errors.RangeError('ERR_INVALID_OPT_VALUE', 'flush', flush);\n     } else {\n       flush = Z_NO_FLUSH;\n     }\n \n     finishFlush = opts.finishFlush;\n-    if (finishFlush !== undefined && finishFlush === finishFlush) {\n+    if (finishFlush !== undefined && !Number.isNaN(finishFlush)) {\n       if (finishFlush < Z_NO_FLUSH || finishFlush > Z_BLOCK ||\n           !Number.isFinite(finishFlush)) {\n         throw new errors.RangeError('ERR_INVALID_OPT_VALUE',\n@@ -207,7 +207,7 @@ function Zlib(opts, mode) {\n     }\n \n     windowBits = opts.windowBits;\n-    if (windowBits !== undefined && windowBits === windowBits) {\n+    if (windowBits !== undefined && !Number.isNaN(windowBits)) {\n       if (windowBits < Z_MIN_WINDOWBITS || windowBits > Z_MAX_WINDOWBITS ||\n           !Number.isFinite(windowBits)) {\n         throw new errors.RangeError('ERR_INVALID_OPT_VALUE',\n@@ -219,7 +219,7 @@ function Zlib(opts, mode) {\n     }\n \n     level = opts.level;\n-    if (level !== undefined && level === level) {\n+    if (level !== undefined && !Number.isNaN(level)) {\n       if (level < Z_MIN_LEVEL || level > Z_MAX_LEVEL ||\n           !Number.isFinite(level)) {\n         throw new errors.RangeError('ERR_INVALID_OPT_VALUE',\n@@ -230,7 +230,7 @@ function Zlib(opts, mode) {\n     }\n \n     memLevel = opts.memLevel;\n-    if (memLevel !== undefined && memLevel === memLevel) {\n+    if (memLevel !== undefined && !Number.isNaN(memLevel)) {\n       if (memLevel < Z_MIN_MEMLEVEL || memLevel > Z_MAX_MEMLEVEL ||\n           !Number.isFinite(memLevel)) {\n         throw new errors.RangeError('ERR_INVALID_OPT_VALUE',\n@@ -241,7 +241,7 @@ function Zlib(opts, mode) {\n     }\n \n     strategy = opts.strategy;\n-    if (strategy !== undefined && strategy === strategy) {\n+    if (strategy !== undefined && !Number.isNaN(strategy)) {\n       if (strategy < Z_DEFAULT_STRATEGY || strategy > Z_FIXED ||\n           !Number.isFinite(strategy)) {\n         throw new errors.TypeError('ERR_INVALID_OPT_VALUE',"
        }
    ],
    "stats": {
        "total": 55,
        "additions": 27,
        "deletions": 28
    }
}