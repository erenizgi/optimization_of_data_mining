{
    "author": "danbev",
    "message": "src: don't create Undefined if not needed\n\nThis commit moves the creation of argv and only creates an undefined\nvalue if the passed in status was not 0.\n\nThe variable name client_handle was already used in this function but\nI've change that usage so that this variable name matches the\nonconnection callback functions parameter name clientHandle.\n\nPR-URL: https://github.com/nodejs/node/pull/20573\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Anna Henningsen <anna@addaleax.net>",
    "sha": "590769bb96a9012e85b06569952743abb8fe68ad",
    "files": [
        {
            "sha": "01d0388d4de3ce51a9e524a88271fd521138c65f",
            "filename": "src/connection_wrap.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/590769bb96a9012e85b06569952743abb8fe68ad/src%2Fconnection_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/590769bb96a9012e85b06569952743abb8fe68ad/src%2Fconnection_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fconnection_wrap.cc?ref=590769bb96a9012e85b06569952743abb8fe68ad",
            "patch": "@@ -45,10 +45,7 @@ void ConnectionWrap<WrapType, UVType>::OnConnection(uv_stream_t* handle,\n   // uv_close() on the handle.\n   CHECK_EQ(wrap_data->persistent().IsEmpty(), false);\n \n-  Local<Value> argv[] = {\n-    Integer::New(env->isolate(), status),\n-    Undefined(env->isolate())\n-  };\n+  Local<Value> client_handle;\n \n   if (status == 0) {\n     // Instantiate the client javascript object and handle.\n@@ -59,17 +56,20 @@ void ConnectionWrap<WrapType, UVType>::OnConnection(uv_stream_t* handle,\n     // Unwrap the client javascript object.\n     WrapType* wrap;\n     ASSIGN_OR_RETURN_UNWRAP(&wrap, client_obj);\n-    uv_stream_t* client_handle =\n-        reinterpret_cast<uv_stream_t*>(&wrap->handle_);\n+    uv_stream_t* client = reinterpret_cast<uv_stream_t*>(&wrap->handle_);\n     // uv_accept can fail if the new connection has already been closed, in\n     // which case an EAGAIN (resource temporarily unavailable) will be\n     // returned.\n-    if (uv_accept(handle, client_handle))\n+    if (uv_accept(handle, client))\n       return;\n \n     // Successful accept. Call the onconnection callback in JavaScript land.\n-    argv[1] = client_obj;\n+    client_handle = client_obj;\n+  } else {\n+    client_handle = Undefined(env->isolate());\n   }\n+\n+  Local<Value> argv[] = { Integer::New(env->isolate(), status), client_handle };\n   wrap_data->MakeCallback(env->onconnection_string(), arraysize(argv), argv);\n }\n "
        }
    ],
    "stats": {
        "total": 16,
        "additions": 8,
        "deletions": 8
    }
}