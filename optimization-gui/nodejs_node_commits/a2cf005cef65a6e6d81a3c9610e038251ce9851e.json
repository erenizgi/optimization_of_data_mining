{
    "author": "apapirovski",
    "message": "test: fix long-running buffer benchmarks\n\nPR-URL: https://github.com/nodejs/node/pull/20125\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Rich Trott <rtrott@gmail.com>",
    "sha": "a2cf005cef65a6e6d81a3c9610e038251ce9851e",
    "files": [
        {
            "sha": "7aee5a89c4f58274e48aeac418da73c7ebefbd8c",
            "filename": "benchmark/buffers/buffer-base64-decode-wrapped.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/a2cf005cef65a6e6d81a3c9610e038251ce9851e/benchmark%2Fbuffers%2Fbuffer-base64-decode-wrapped.js",
            "raw_url": "https://github.com/nodejs/node/raw/a2cf005cef65a6e6d81a3c9610e038251ce9851e/benchmark%2Fbuffers%2Fbuffer-base64-decode-wrapped.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fbuffers%2Fbuffer-base64-decode-wrapped.js?ref=a2cf005cef65a6e6d81a3c9610e038251ce9851e",
            "patch": "@@ -3,12 +3,12 @@\n const common = require('../common.js');\n \n const bench = common.createBenchmark(main, {\n+  charsPerLine: [76],\n+  linesCount: [8 << 16],\n   n: [32],\n });\n \n-function main({ n }) {\n-  const charsPerLine = 76;\n-  const linesCount = 8 << 16;\n+function main({ charsPerLine, linesCount, n }) {\n   const bytesCount = charsPerLine * linesCount / 4 * 3;\n \n   const line = `${'abcd'.repeat(charsPerLine / 4)}\\n`;"
        },
        {
            "sha": "0ac694fe8c4ae786308ce8d7fff7742779baa84c",
            "filename": "benchmark/buffers/buffer-base64-decode.js",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/a2cf005cef65a6e6d81a3c9610e038251ce9851e/benchmark%2Fbuffers%2Fbuffer-base64-decode.js",
            "raw_url": "https://github.com/nodejs/node/raw/a2cf005cef65a6e6d81a3c9610e038251ce9851e/benchmark%2Fbuffers%2Fbuffer-base64-decode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fbuffers%2Fbuffer-base64-decode.js?ref=a2cf005cef65a6e6d81a3c9610e038251ce9851e",
            "patch": "@@ -4,10 +4,11 @@ const common = require('../common.js');\n \n const bench = common.createBenchmark(main, {\n   n: [32],\n+  size: [8 << 20]\n });\n \n-function main({ n }) {\n-  const s = 'abcd'.repeat(8 << 20);\n+function main({ n, size }) {\n+  const s = 'abcd'.repeat(size);\n   // eslint-disable-next-line node-core/no-unescaped-regexp-dot\n   s.match(/./);  // Flatten string.\n   assert.strictEqual(s.length % 4, 0);"
        },
        {
            "sha": "26d82c506db3b03ad400655ac50e04ca6a049e05",
            "filename": "benchmark/buffers/buffer-indexof.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/a2cf005cef65a6e6d81a3c9610e038251ce9851e/benchmark%2Fbuffers%2Fbuffer-indexof.js",
            "raw_url": "https://github.com/nodejs/node/raw/a2cf005cef65a6e6d81a3c9610e038251ce9851e/benchmark%2Fbuffers%2Fbuffer-indexof.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fbuffers%2Fbuffer-indexof.js?ref=a2cf005cef65a6e6d81a3c9610e038251ce9851e",
            "patch": "@@ -25,10 +25,10 @@ const bench = common.createBenchmark(main, {\n   search: searchStrings,\n   encoding: ['undefined', 'utf8', 'ucs2', 'binary'],\n   type: ['buffer', 'string'],\n-  iter: [100000]\n+  n: [100000]\n });\n \n-function main({ iter, search, encoding, type }) {\n+function main({ n, search, encoding, type }) {\n   var aliceBuffer = fs.readFileSync(\n     path.resolve(__dirname, '../fixtures/alice.html')\n   );\n@@ -46,8 +46,8 @@ function main({ iter, search, encoding, type }) {\n   }\n \n   bench.start();\n-  for (var i = 0; i < iter; i++) {\n+  for (var i = 0; i < n; i++) {\n     aliceBuffer.indexOf(search, 0, encoding);\n   }\n-  bench.end(iter);\n+  bench.end(n);\n }"
        },
        {
            "sha": "171f755647d21f4f4e9fd1d2ac0f524c1e0dc076",
            "filename": "test/sequential/test-benchmark-buffer.js",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/a2cf005cef65a6e6d81a3c9610e038251ce9851e/test%2Fsequential%2Ftest-benchmark-buffer.js",
            "raw_url": "https://github.com/nodejs/node/raw/a2cf005cef65a6e6d81a3c9610e038251ce9851e/test%2Fsequential%2Ftest-benchmark-buffer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-benchmark-buffer.js?ref=a2cf005cef65a6e6d81a3c9610e038251ce9851e",
            "patch": "@@ -10,9 +10,11 @@ runBenchmark('buffers',\n                'args=1',\n                'buffer=fast',\n                'byteLength=1',\n+               'charsPerLine=6',\n                'encoding=utf8',\n                'endian=BE',\n                'len=2',\n+               'linesCount=1',\n                'method=',\n                'n=1',\n                'pieces=1',"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 12,
        "deletions": 9
    }
}