{
    "author": "danbev",
    "message": "test: add hasCrypto check to common flags check\n\nCurrently, if node is configured --without-ssl there will be a number of\ntest errors related to crypto flags:\n\nError: Test has to be started with the flag: '--tls-v1.1'\n\nThis commit adds a hasCrypto check to the flags checking similar to what\nis done for --without-intl.\n\nPR-URL: https://github.com/nodejs/node/pull/25147\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "2a02b9df6ef35b34b7d93cf8408ce53fb2f66b53",
    "files": [
        {
            "sha": "5ac79f4998acc8951b07053255a9123e02c80952",
            "filename": "test/common/index.js",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/2a02b9df6ef35b34b7d93cf8408ce53fb2f66b53/test%2Fcommon%2Findex.js",
            "raw_url": "https://github.com/nodejs/node/raw/2a02b9df6ef35b34b7d93cf8408ce53fb2f66b53/test%2Fcommon%2Findex.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Findex.js?ref=2a02b9df6ef35b34b7d93cf8408ce53fb2f66b53",
            "patch": "@@ -36,6 +36,8 @@ const {\n \n const noop = () => {};\n \n+const hasCrypto = Boolean(process.versions.openssl);\n+\n const isMainThread = (() => {\n   try {\n     return require('worker_threads').isMainThread;\n@@ -73,6 +75,9 @@ if (process.argv.length === 2 &&\n     const args = process.execArgv.map((arg) => arg.replace(/_/g, '-'));\n     for (const flag of flags) {\n       if (!args.includes(flag) &&\n+          // If the binary was built without-ssl then the crypto flags are\n+          // invalid (bad option). The test itself should handle this case.\n+          hasCrypto &&\n           // If the binary is build without `intl` the inspect option is\n           // invalid. The test itself should handle this case.\n           (process.config.variables.v8_enable_inspector !== 0 ||\n@@ -105,7 +110,6 @@ const rootDir = isWindows ? 'c:\\\\' : '/';\n \n const buildType = process.config.target_defaults.default_configuration;\n \n-const hasCrypto = Boolean(process.versions.openssl);\n \n // If env var is set then enable async_hook hooks for all tests.\n if (process.env.NODE_TEST_WITH_ASYNC_HOOKS) {"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
    }
}