{
    "author": "BridgeAR",
    "message": "tty: add color support for more terminals\n\nThis adds support for a couple more terminals.\n\nPR-URL: https://github.com/nodejs/node/pull/19730\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "ceaeee012066e7e56332ba9d9f9306401c971560",
    "files": [
        {
            "sha": "c4edab24fb87abae3ad0591e2de1c2b0ad92ae77",
            "filename": "lib/internal/tty.js",
            "status": "modified",
            "additions": 48,
            "deletions": 2,
            "changes": 50,
            "blob_url": "https://github.com/nodejs/node/blob/ceaeee012066e7e56332ba9d9f9306401c971560/lib%2Finternal%2Ftty.js",
            "raw_url": "https://github.com/nodejs/node/raw/ceaeee012066e7e56332ba9d9f9306401c971560/lib%2Finternal%2Ftty.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ftty.js?ref=ceaeee012066e7e56332ba9d9f9306401c971560",
            "patch": "@@ -31,6 +31,41 @@ const COLORS_16 = 4;\n const COLORS_256 = 8;\n const COLORS_16m = 24;\n \n+// Some entries were taken from `dircolors`\n+// (https://linux.die.net/man/1/dircolors). The corresponding terminals might\n+// support more than 16 colors, but this was not tested for.\n+//\n+// Copyright (C) 1996-2016 Free Software Foundation, Inc. Copying and\n+// distribution of this file, with or without modification, are permitted\n+// provided the copyright notice and this notice are preserved.\n+const TERM_ENVS = [\n+  'Eterm',\n+  'cons25',\n+  'console',\n+  'cygwin',\n+  'dtterm',\n+  'gnome',\n+  'hurd',\n+  'jfbterm',\n+  'konsole',\n+  'kterm',\n+  'mlterm',\n+  'putty',\n+  'st',\n+  'terminator'\n+];\n+\n+const TERM_ENVS_REG_EXP = [\n+  /ansi/,\n+  /color/,\n+  /linux/,\n+  /^con[0-9]*x[0-9]/,\n+  /^rxvt/,\n+  /^screen/,\n+  /^xterm/,\n+  /^vt100/\n+];\n+\n // The `getColorDepth` API got inspired by multiple sources such as\n // https://github.com/chalk/supports-color,\n // https://github.com/isaacs/color-support.\n@@ -89,8 +124,19 @@ function getColorDepth(env = process.env) {\n   if (env.TERM) {\n     if (/^xterm-256/.test(env.TERM))\n       return COLORS_256;\n-    if (/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(env.TERM))\n-      return COLORS_16;\n+\n+    const termEnv = env.TERM.toLowerCase();\n+\n+    for (const term of TERM_ENVS) {\n+      if (termEnv === term) {\n+        return COLORS_16;\n+      }\n+    }\n+    for (const term of TERM_ENVS_REG_EXP) {\n+      if (term.test(termEnv)) {\n+        return COLORS_16;\n+      }\n+    }\n   }\n \n   if (env.COLORTERM)"
        }
    ],
    "stats": {
        "total": 50,
        "additions": 48,
        "deletions": 2
    }
}