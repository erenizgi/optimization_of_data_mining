{
    "author": "TimothyGu",
    "message": "src: add Env::profiler_idle_notifier_started()\n\nRefs: https://github.com/ayojs/ayo/pull/93\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Stephen Belanger <admin@stephenbelanger.com>\n\nPR-URL: https://github.com/nodejs/node/pull/20876\nReviewed-By: Gireesh Punathil <gpunathi@in.ibm.com>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Shingo Inoue <leko.noor@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: John-David Dalton <john.david.dalton@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>",
    "sha": "8939f36630bd718fc0b0b8557cf7f2ed9ecab312",
    "files": [
        {
            "sha": "50328bd77c1a898d303b202b746853b278f5bd33",
            "filename": "src/env-inl.h",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/8939f36630bd718fc0b0b8557cf7f2ed9ecab312/src%2Fenv-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/8939f36630bd718fc0b0b8557cf7f2ed9ecab312/src%2Fenv-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv-inl.h?ref=8939f36630bd718fc0b0b8557cf7f2ed9ecab312",
            "patch": "@@ -322,6 +322,10 @@ inline Environment* Environment::GetThreadLocalEnv() {\n   return static_cast<Environment*>(uv_key_get(&thread_local_env));\n }\n \n+inline bool Environment::profiler_idle_notifier_started() const {\n+  return profiler_idle_notifier_started_;\n+}\n+\n inline v8::Isolate* Environment::isolate() const {\n   return isolate_;\n }"
        },
        {
            "sha": "090b43968bf66532117ec2726415cb823560c471",
            "filename": "src/env.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/8939f36630bd718fc0b0b8557cf7f2ed9ecab312/src%2Fenv.cc",
            "raw_url": "https://github.com/nodejs/node/raw/8939f36630bd718fc0b0b8557cf7f2ed9ecab312/src%2Fenv.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv.cc?ref=8939f36630bd718fc0b0b8557cf7f2ed9ecab312",
            "patch": "@@ -263,6 +263,11 @@ void Environment::CleanupHandles() {\n }\n \n void Environment::StartProfilerIdleNotifier() {\n+  if (profiler_idle_notifier_started_)\n+    return;\n+\n+  profiler_idle_notifier_started_ = true;\n+\n   uv_prepare_start(&idle_prepare_handle_, [](uv_prepare_t* handle) {\n     Environment* env = ContainerOf(&Environment::idle_prepare_handle_, handle);\n     env->isolate()->SetIdle(true);\n@@ -275,6 +280,7 @@ void Environment::StartProfilerIdleNotifier() {\n }\n \n void Environment::StopProfilerIdleNotifier() {\n+  profiler_idle_notifier_started_ = false;\n   uv_prepare_stop(&idle_prepare_handle_);\n   uv_check_stop(&idle_check_handle_);\n }"
        },
        {
            "sha": "cdb592732a42645862e4f6bca2483eecd196a397",
            "filename": "src/env.h",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8939f36630bd718fc0b0b8557cf7f2ed9ecab312/src%2Fenv.h",
            "raw_url": "https://github.com/nodejs/node/raw/8939f36630bd718fc0b0b8557cf7f2ed9ecab312/src%2Fenv.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv.h?ref=8939f36630bd718fc0b0b8557cf7f2ed9ecab312",
            "patch": "@@ -615,6 +615,7 @@ class Environment {\n \n   void StartProfilerIdleNotifier();\n   void StopProfilerIdleNotifier();\n+  inline bool profiler_idle_notifier_started() const;\n \n   inline v8::Isolate* isolate() const;\n   inline tracing::Agent* tracing_agent() const;\n@@ -840,6 +841,7 @@ class Environment {\n   uv_idle_t immediate_idle_handle_;\n   uv_prepare_t idle_prepare_handle_;\n   uv_check_t idle_check_handle_;\n+  bool profiler_idle_notifier_started_ = false;\n \n   AsyncHooks async_hooks_;\n   ImmediateInfo immediate_info_;"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 12,
        "deletions": 0
    }
}