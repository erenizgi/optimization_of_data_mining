{
    "author": "shigeki",
    "message": "build: limit assembler version check on x86\n\nThe current openssl checks assembler version only x86_64 or ia32\ntarget arch for use of AES-NI, AVX and AVX2.\nThis requires --openssl-no-asm option during configure when an older\nassembler version is found only on x86_64 or ia32.\n\nPR-URL: https://github.com/nodejs/node/pull/20226\nFixes: https://github.com/nodejs/node/issues/19944\nRefs: https://github.com/nodejs/node/pull/20217\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ali Ijaz Sheikh <ofrobots@google.com>\nReviewed-By: Myles Borins <myles.borins@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>",
    "sha": "3bcd8576fcb800077c922233da251a2299b66923",
    "files": [
        {
            "sha": "9690e826c396f84d0be4a928def54f569d82940e",
            "filename": "BUILDING.md",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/3bcd8576fcb800077c922233da251a2299b66923/BUILDING.md",
            "raw_url": "https://github.com/nodejs/node/raw/3bcd8576fcb800077c922233da251a2299b66923/BUILDING.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/BUILDING.md?ref=3bcd8576fcb800077c922233da251a2299b66923",
            "patch": "@@ -94,14 +94,16 @@ Depending on host platform, the selection of toolchains may vary.\n #### OpenSSL asm support\n \n OpenSSL-1.1.0 requires the following asssembler version for use of asm\n-support.\n+support on x86_64 and ia32.\n \n * gas (GNU assembler) version 2.23 or higher\n * xcode version 5.0 or higher\n * llvm version 3.3 or higher\n * nasm version 2.10 or higher in Windows\n \n-Otherwise, `--openssl-no-asm` is added with warning in configure.\n+Otherwise `configure` will fail with an error. This can be avoided by\n+either providing a newer assembler as per the list above or by\n+using the `--openssl-no-asm` flag.\n \n *Note:* The forthcoming OpenSSL-1.1.1 will require higher\n  version. Please refer"
        },
        {
            "sha": "c1170f9a132a16dfce2f73efc285191e29a69cf3",
            "filename": "configure",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/3bcd8576fcb800077c922233da251a2299b66923/configure",
            "raw_url": "https://github.com/nodejs/node/raw/3bcd8576fcb800077c922233da251a2299b66923/configure",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/configure?ref=3bcd8576fcb800077c922233da251a2299b66923",
            "patch": "@@ -1106,6 +1106,8 @@ def configure_openssl(o):\n       o['defines'] += ['NODE_WITHOUT_NODE_OPTIONS']\n \n   if not options.shared_openssl and not options.openssl_no_asm:\n+    is_x86 = 'x64' in variables['target_arch'] or 'ia32' in variables['target_arch']\n+\n     # supported asm compiler for AVX2. See https://github.com/openssl/openssl/\n     # blob/OpenSSL_1_1_0-stable/crypto/modes/asm/aesni-gcm-x86_64.pl#L52-L69\n     openssl110_asm_supported = \\\n@@ -1114,7 +1116,7 @@ def configure_openssl(o):\n       ('llvm_version' in variables and float(variables['llvm_version']) >= 3.3) or \\\n       ('nasm_version' in variables and float(variables['nasm_version']) >= 2.10)\n \n-    if not openssl110_asm_supported:\n+    if is_x86 and not openssl110_asm_supported:\n       error('''Did not find a new enough assembler, install one or build with\n        --openssl-no-asm.\n        Please refer to BUILDING.md''')"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 7,
        "deletions": 3
    }
}