{
    "author": "addaleax",
    "message": "src: minor refactor to node_errors.h\n\nAdd overloads of the error generation/throwing methods\nthat take an `Isolate*` argument, since the created objects\ndonâ€™t depend on the `Environment*` in question.\n\nAlso, remove `THROW_ERR_OUT_OF_RANGE_WITH_TEXT`, which did the\nsame thing as `THROW_ERR_OUT_OF_RANGE` in a more convoluted way.\n\nPR-URL: https://github.com/nodejs/node/pull/23879\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Eugene Ostroukhov <eostroukhov@google.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Matheus Marchini <mat@mmarchini.me>",
    "sha": "0fd55e71fe376458d1d82503a643114db8675208",
    "files": [
        {
            "sha": "d4f7c751634b4d1668c78d740c4160fe4ebbb3cd",
            "filename": "src/node_buffer.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/0fd55e71fe376458d1d82503a643114db8675208/src%2Fnode_buffer.cc",
            "raw_url": "https://github.com/nodejs/node/raw/0fd55e71fe376458d1d82503a643114db8675208/src%2Fnode_buffer.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_buffer.cc?ref=0fd55e71fe376458d1d82503a643114db8675208",
            "patch": "@@ -41,8 +41,7 @@\n #define THROW_AND_RETURN_IF_OOB(r)                                          \\\n   do {                                                                      \\\n     if (!(r))                                                               \\\n-      return node::THROW_ERR_OUT_OF_RANGE_WITH_TEXT(env,                    \\\n-                                                    \"Index out of range\");  \\\n+      return node::THROW_ERR_OUT_OF_RANGE(env, \"Index out of range\");       \\\n   } while (0)                                                               \\\n \n #define SLICE_START_END(start_arg, end_arg, end_max)                        \\\n@@ -494,7 +493,7 @@ void Copy(const FunctionCallbackInfo<Value> &args) {\n     return args.GetReturnValue().Set(0);\n \n   if (source_start > ts_obj_length)\n-    return node::THROW_ERR_OUT_OF_RANGE_WITH_TEXT(\n+    return THROW_ERR_OUT_OF_RANGE(\n         env, \"The value of \\\"sourceStart\\\" is out of range.\");\n \n   if (source_end - source_start > target_length - target_start)\n@@ -685,10 +684,10 @@ void CompareOffset(const FunctionCallbackInfo<Value> &args) {\n   THROW_AND_RETURN_IF_OOB(ParseArrayIndex(args[5], ts_obj_length, &source_end));\n \n   if (source_start > ts_obj_length)\n-    return node::THROW_ERR_OUT_OF_RANGE_WITH_TEXT(\n+    return THROW_ERR_OUT_OF_RANGE(\n         env, \"The value of \\\"sourceStart\\\" is out of range.\");\n   if (target_start > target_length)\n-    return node::THROW_ERR_OUT_OF_RANGE_WITH_TEXT(\n+    return THROW_ERR_OUT_OF_RANGE(\n         env, \"The value of \\\"targetStart\\\" is out of range.\");\n \n   CHECK_LE(source_start, source_end);"
        },
        {
            "sha": "a958eccf8af4b9b56d4f094b2b71f4bdfe12701b",
            "filename": "src/node_errors.h",
            "status": "modified",
            "additions": 8,
            "deletions": 9,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/0fd55e71fe376458d1d82503a643114db8675208/src%2Fnode_errors.h",
            "raw_url": "https://github.com/nodejs/node/raw/0fd55e71fe376458d1d82503a643114db8675208/src%2Fnode_errors.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_errors.h?ref=0fd55e71fe376458d1d82503a643114db8675208",
            "patch": "@@ -52,8 +52,11 @@ namespace node {\n            js_code).FromJust();                                               \\\n     return e;                                                                 \\\n   }                                                                           \\\n+  inline void THROW_ ## code(v8::Isolate* isolate, const char* message) {     \\\n+    isolate->ThrowException(code(isolate, message));                          \\\n+  }                                                                           \\\n   inline void THROW_ ## code(Environment* env, const char* message) {         \\\n-    env->isolate()->ThrowException(code(env->isolate(), message));            \\\n+    THROW_ ## code(env->isolate(), message);                                  \\\n   }\n   ERRORS_WITH_CODE(V)\n #undef V\n@@ -80,8 +83,11 @@ namespace node {\n   inline v8::Local<v8::Value> code(v8::Isolate* isolate) {                   \\\n     return code(isolate, message);                                           \\\n   }                                                                          \\\n+  inline void THROW_ ## code(v8::Isolate* isolate) {                         \\\n+    isolate->ThrowException(code(isolate, message));                         \\\n+  }                                                                          \\\n   inline void THROW_ ## code(Environment* env) {                             \\\n-    env->isolate()->ThrowException(code(env->isolate(), message));           \\\n+    THROW_ ## code(env->isolate());                                          \\\n   }\n   PREDEFINED_ERROR_MESSAGES(V)\n #undef V\n@@ -95,13 +101,6 @@ inline void THROW_ERR_SCRIPT_EXECUTION_TIMEOUT(Environment* env,\n   THROW_ERR_SCRIPT_EXECUTION_TIMEOUT(env, message.str().c_str());\n }\n \n-inline void THROW_ERR_OUT_OF_RANGE_WITH_TEXT(Environment* env,\n-                                             const char* messageText) {\n-  std::ostringstream message;\n-  message << messageText;\n-  THROW_ERR_OUT_OF_RANGE(env, message.str().c_str());\n-}\n-\n inline v8::Local<v8::Value> ERR_BUFFER_TOO_LARGE(v8::Isolate* isolate) {\n   char message[128];\n   snprintf(message, sizeof(message),"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 12,
        "deletions": 14
    }
}