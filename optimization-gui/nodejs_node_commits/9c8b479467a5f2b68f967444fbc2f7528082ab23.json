{
    "author": "targos",
    "message": "deps: cherry-pick 76cab5f from upstream V8\n\nOriginal commit message:\n\n    Fix Object.entries/.values with non-enumerable properties\n\n    Iterate over all descriptors instead of bailing out early and missing\n    enumerable properties later.\n\n    Bug: chromium:836145\n    Change-Id: I104f7ea89480383b6b4b9204942a166bdf8e0597\n    Reviewed-on: https://chromium-review.googlesource.com/1027832\n    Reviewed-by: Jakob Gruber <jgruber@chromium.org>\n    Commit-Queue: Camillo Bruni <cbruni@chromium.org>\n    Cr-Commit-Position: refs/heads/master@{#52786}\n\nRefs: https://github.com/v8/v8/commit/76cab5ff786bea157a6931296924384a2242da93\nFixes: https://github.com/nodejs/node/issues/20278\n\nPR-URL: https://github.com/nodejs/node/pull/20350\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Ali Ijaz Sheikh <ofrobots@google.com>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>",
    "sha": "9c8b479467a5f2b68f967444fbc2f7528082ab23",
    "files": [
        {
            "sha": "3bb10d611fb1d5f104df0f9e3ee75fcfef3af22f",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/9c8b479467a5f2b68f967444fbc2f7528082ab23/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/9c8b479467a5f2b68f967444fbc2f7528082ab23/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=9c8b479467a5f2b68f967444fbc2f7528082ab23",
            "patch": "@@ -27,7 +27,7 @@\n \n     # Reset this number to 0 on major V8 upgrades.\n     # Increment by one for each non-official patch applied to deps/v8.\n-    'v8_embedder_string': '-node.5',\n+    'v8_embedder_string': '-node.6',\n \n     # Enable disassembler for `--print-code` v8 options\n     'v8_enable_disassembler': 1,"
        },
        {
            "sha": "3fb8d7792d6df05a3118f648fd83548abb0cbada",
            "filename": "deps/v8/src/builtins/builtins-object-gen.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 9,
            "changes": 19,
            "blob_url": "https://github.com/nodejs/node/blob/9c8b479467a5f2b68f967444fbc2f7528082ab23/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-object-gen.cc",
            "raw_url": "https://github.com/nodejs/node/raw/9c8b479467a5f2b68f967444fbc2f7528082ab23/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-object-gen.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-object-gen.cc?ref=9c8b479467a5f2b68f967444fbc2f7528082ab23",
            "patch": "@@ -268,7 +268,7 @@ TNode<JSArray> ObjectEntriesValuesBuiltinsAssembler::FastGetOwnValuesOrEntries(\n       object_enum_length, IntPtrConstant(kInvalidEnumCacheSentinel));\n \n   // In case, we found enum_cache in object,\n-  // we use it as array_length becuase it has same size for\n+  // we use it as array_length because it has same size for\n   // Object.(entries/values) result array object length.\n   // So object_enum_length use less memory space than\n   // NumberOfOwnDescriptorsBits value.\n@@ -285,7 +285,7 @@ TNode<JSArray> ObjectEntriesValuesBuiltinsAssembler::FastGetOwnValuesOrEntries(\n                            INTPTR_PARAMETERS, kAllowLargeObjectAllocation));\n \n     // If in case we have enum_cache,\n-    // we can't detect accessor of object until loop through descritpros.\n+    // we can't detect accessor of object until loop through descriptors.\n     // So if object might have accessor,\n     // we will remain invalid addresses of FixedArray.\n     // Because in that case, we need to jump to runtime call.\n@@ -299,7 +299,7 @@ TNode<JSArray> ObjectEntriesValuesBuiltinsAssembler::FastGetOwnValuesOrEntries(\n     Variable* vars[] = {&var_descriptor_number, &var_result_index};\n     // Let desc be ? O.[[GetOwnProperty]](key).\n     TNode<DescriptorArray> descriptors = LoadMapDescriptors(map);\n-    Label loop(this, 2, vars), after_loop(this), loop_condition(this);\n+    Label loop(this, 2, vars), after_loop(this), next_descriptor(this);\n     Branch(IntPtrEqual(var_descriptor_number.value(), object_enum_length),\n            &after_loop, &loop);\n \n@@ -316,7 +316,7 @@ TNode<JSArray> ObjectEntriesValuesBuiltinsAssembler::FastGetOwnValuesOrEntries(\n       Node* next_key = DescriptorArrayGetKey(descriptors, descriptor_index);\n \n       // Skip Symbols.\n-      GotoIf(IsSymbol(next_key), &loop_condition);\n+      GotoIf(IsSymbol(next_key), &next_descriptor);\n \n       TNode<Uint32T> details = TNode<Uint32T>::UncheckedCast(\n           DescriptorArrayGetDetails(descriptors, descriptor_index));\n@@ -326,8 +326,9 @@ TNode<JSArray> ObjectEntriesValuesBuiltinsAssembler::FastGetOwnValuesOrEntries(\n       GotoIf(IsPropertyKindAccessor(kind), if_call_runtime_with_fast_path);\n       CSA_ASSERT(this, IsPropertyKindData(kind));\n \n-      // If desc is not undefined and desc.[[Enumerable]] is true, then\n-      GotoIfNot(IsPropertyEnumerable(details), &loop_condition);\n+      // If desc is not undefined and desc.[[Enumerable]] is true, then skip to\n+      // the next descriptor.\n+      GotoIfNot(IsPropertyEnumerable(details), &next_descriptor);\n \n       VARIABLE(var_property_value, MachineRepresentation::kTagged,\n                UndefinedConstant());\n@@ -357,12 +358,12 @@ TNode<JSArray> ObjectEntriesValuesBuiltinsAssembler::FastGetOwnValuesOrEntries(\n       StoreFixedArrayElement(values_or_entries, var_result_index.value(),\n                              value);\n       Increment(&var_result_index, 1);\n-      Goto(&loop_condition);\n+      Goto(&next_descriptor);\n \n-      BIND(&loop_condition);\n+      BIND(&next_descriptor);\n       {\n         Increment(&var_descriptor_number, 1);\n-        Branch(IntPtrEqual(var_descriptor_number.value(), object_enum_length),\n+        Branch(IntPtrEqual(var_result_index.value(), object_enum_length),\n                &after_loop, &loop);\n       }\n     }"
        },
        {
            "sha": "51ce4692e40e19e819213dc59165fea7025e9695",
            "filename": "deps/v8/test/mjsunit/es8/object-entries.js",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/9c8b479467a5f2b68f967444fbc2f7528082ab23/deps%2Fv8%2Ftest%2Fmjsunit%2Fes8%2Fobject-entries.js",
            "raw_url": "https://github.com/nodejs/node/raw/9c8b479467a5f2b68f967444fbc2f7528082ab23/deps%2Fv8%2Ftest%2Fmjsunit%2Fes8%2Fobject-entries.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fmjsunit%2Fes8%2Fobject-entries.js?ref=9c8b479467a5f2b68f967444fbc2f7528082ab23",
            "patch": "@@ -210,6 +210,24 @@ function TestPropertyFilter(withWarmup) {\n TestPropertyFilter();\n TestPropertyFilter(true);\n \n+function TestPropertyFilter2(withWarmup) {\n+  var object = { };\n+  Object.defineProperty(object, \"prop1\", { value: 10 });\n+  Object.defineProperty(object, \"prop2\", { value: 20 });\n+  object.prop3 = 30;\n+\n+  if (withWarmup) {\n+    for (const key in object) {}\n+  }\n+\n+  values = Object.entries(object);\n+  assertEquals(1, values.length);\n+  assertEquals([\n+    [ \"prop3\", 30 ],\n+  ], values);\n+}\n+TestPropertyFilter2();\n+TestPropertyFilter2(true);\n \n function TestWithProxy(withWarmup) {\n   var obj1 = {prop1:10};"
        }
    ],
    "stats": {
        "total": 39,
        "additions": 29,
        "deletions": 10
    }
}