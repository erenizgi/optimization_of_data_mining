{
    "author": "addaleax",
    "message": "src: reset `StopTracingAgent()` before platform teardown\n\nThis makes sure that `StopTracingAgent()` is always called\nbefore tearing down the `tracing::Agent`,\nsince previously its destructor might have tried to access the\nagent, which would be destroyed by the (earlier) `Dispose()` call.\n\nPR-URL: https://github.com/nodejs/node/pull/25472\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Minwoo Jung <minwoo@nodesource.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "84e90decd508afc2e2d53b475258ae4ec36ea586",
    "files": [
        {
            "sha": "d9cb4f9be768bf1fc3b89790c838ba50b000e5cf",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/84e90decd508afc2e2d53b475258ae4ec36ea586/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/84e90decd508afc2e2d53b475258ae4ec36ea586/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=84e90decd508afc2e2d53b475258ae4ec36ea586",
            "patch": "@@ -240,6 +240,7 @@ static struct {\n   }\n \n   void Dispose() {\n+    StopTracingAgent();\n     platform_->Shutdown();\n     delete platform_;\n     platform_ = nullptr;\n@@ -579,7 +580,6 @@ static void WaitForInspectorDisconnect(Environment* env) {\n void Exit(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n   WaitForInspectorDisconnect(env);\n-  v8_platform.StopTracingAgent();\n   int code = args[0]->Int32Value(env->context()).FromMaybe(0);\n   env->Exit(code);\n }\n@@ -1477,7 +1477,6 @@ int Start(int argc, char** argv) {\n   per_process::v8_initialized = true;\n   const int exit_code =\n       Start(uv_default_loop(), args, exec_args);\n-  v8_platform.StopTracingAgent();\n   per_process::v8_initialized = false;\n   V8::Dispose();\n "
        }
    ],
    "stats": {
        "total": 3,
        "additions": 1,
        "deletions": 2
    }
}