{
    "author": "cjihrig",
    "message": "os: implement os.type() using uv_os_uname()\n\nThe happy path behavior should be identical on all\nplatforms except MinGW, which now identifies MinGW\nseparately from Windows.\n\nPR-URL: https://github.com/nodejs/node/pull/25659\nReviewed-By: Bartosz Sosnowski <bartosz@janeasystems.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Minwoo Jung <minwoo@nodesource.com>\nReviewed-By: Jeremiah Senkpiel <fishrock123@rocketmail.com>",
    "sha": "16e4cd19f29287677500583918449b87e29fa29a",
    "files": [
        {
            "sha": "5639453d2c46edb3f8be9e1ed291308feb52a6b8",
            "filename": "src/node_os.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 11,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/16e4cd19f29287677500583918449b87e29fa29a/src%2Fnode_os.cc",
            "raw_url": "https://github.com/nodejs/node/raw/16e4cd19f29287677500583918449b87e29fa29a/src%2Fnode_os.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_os.cc?ref=16e4cd19f29287677500583918449b87e29fa29a",
            "patch": "@@ -36,7 +36,6 @@\n # include <netdb.h>         // MAXHOSTNAMELEN on Solaris.\n # include <unistd.h>        // gethostname, sysconf\n # include <sys/param.h>     // MAXHOSTNAMELEN on Linux and the BSDs.\n-# include <sys/utsname.h>\n #endif  // __POSIX__\n \n // Add Windows fallback.\n@@ -84,21 +83,16 @@ static void GetHostname(const FunctionCallbackInfo<Value>& args) {\n \n static void GetOSType(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n-  const char* rval;\n+  uv_utsname_t info;\n+  int err = uv_os_uname(&info);\n \n-#ifdef __POSIX__\n-  struct utsname info;\n-  if (uname(&info) < 0) {\n+  if (err != 0) {\n     CHECK_GE(args.Length(), 1);\n-    env->CollectExceptionInfo(args[args.Length() - 1], errno, \"uname\");\n+    env->CollectUVExceptionInfo(args[args.Length() - 1], err, \"uv_os_uname\");\n     return args.GetReturnValue().SetUndefined();\n   }\n-  rval = info.sysname;\n-#else  // __MINGW32__\n-  rval = \"Windows_NT\";\n-#endif  // __POSIX__\n \n-  args.GetReturnValue().Set(OneByteString(env->isolate(), rval));\n+  args.GetReturnValue().Set(OneByteString(env->isolate(), info.sysname));\n }\n \n "
        }
    ],
    "stats": {
        "total": 16,
        "additions": 5,
        "deletions": 11
    }
}