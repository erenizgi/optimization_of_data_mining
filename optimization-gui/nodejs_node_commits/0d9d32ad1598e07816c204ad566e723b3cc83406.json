{
    "author": "shobhitchittora",
    "message": "child_process: handle undefined/null for fork() args\n\nPR-URL: https://github.com/nodejs/node/pull/22416\nFixes: https://github.com/nodejs/node/issues/20749\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Denys Otrishko <shishugi@gmail.com>\nReviewed-By: Matheus Marchini <mat@mmarchini.me>",
    "sha": "0d9d32ad1598e07816c204ad566e723b3cc83406",
    "files": [
        {
            "sha": "e2b7a3292069d12da4c330ffc27a32b551563d68",
            "filename": "lib/child_process.js",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/0d9d32ad1598e07816c204ad566e723b3cc83406/lib%2Fchild_process.js",
            "raw_url": "https://github.com/nodejs/node/raw/0d9d32ad1598e07816c204ad566e723b3cc83406/lib%2Fchild_process.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fchild_process.js?ref=0d9d32ad1598e07816c204ad566e723b3cc83406",
            "patch": "@@ -69,6 +69,11 @@ exports.fork = function fork(modulePath /* , args, options */) {\n     args = arguments[pos++];\n   }\n \n+  if (pos < arguments.length &&\n+      (arguments[pos] === undefined || arguments[pos] === null)) {\n+    pos++;\n+  }\n+\n   if (pos < arguments.length && arguments[pos] != null) {\n     if (typeof arguments[pos] !== 'object') {\n       throw new ERR_INVALID_ARG_VALUE(`arguments[${pos}]`, arguments[pos]);"
        },
        {
            "sha": "04f3f8dcffe6a9f03202f4e60503f09d9eba3541",
            "filename": "test/fixtures/child-process-echo-options.js",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0d9d32ad1598e07816c204ad566e723b3cc83406/test%2Ffixtures%2Fchild-process-echo-options.js",
            "raw_url": "https://github.com/nodejs/node/raw/0d9d32ad1598e07816c204ad566e723b3cc83406/test%2Ffixtures%2Fchild-process-echo-options.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fchild-process-echo-options.js?ref=0d9d32ad1598e07816c204ad566e723b3cc83406",
            "patch": "@@ -0,0 +1 @@\n+process.send({ env: process.env });"
        },
        {
            "sha": "5efb9bdbb497359b9823a25796e5b69c33aedc9d",
            "filename": "test/parallel/test-child-process-fork-options.js",
            "status": "added",
            "additions": 37,
            "deletions": 0,
            "changes": 37,
            "blob_url": "https://github.com/nodejs/node/blob/0d9d32ad1598e07816c204ad566e723b3cc83406/test%2Fparallel%2Ftest-child-process-fork-options.js",
            "raw_url": "https://github.com/nodejs/node/raw/0d9d32ad1598e07816c204ad566e723b3cc83406/test%2Fparallel%2Ftest-child-process-fork-options.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-child-process-fork-options.js?ref=0d9d32ad1598e07816c204ad566e723b3cc83406",
            "patch": "@@ -0,0 +1,37 @@\n+'use strict';\n+const common = require('../common');\n+const fixtures = require('../common/fixtures');\n+\n+// This test ensures that fork should parse options\n+// correctly if args is undefined or null\n+\n+const assert = require('assert');\n+const { fork } = require('child_process');\n+\n+const expectedEnv = { foo: 'bar' };\n+\n+{\n+  const cp = fork(fixtures.path('child-process-echo-options.js'), undefined,\n+                  { env: Object.assign({}, process.env, expectedEnv) });\n+\n+  cp.on('message', common.mustCall(({ env }) => {\n+    assert.strictEqual(env.foo, expectedEnv.foo);\n+  }));\n+\n+  cp.on('exit', common.mustCall((code) => {\n+    assert.strictEqual(code, 0);\n+  }));\n+}\n+\n+{\n+  const cp = fork(fixtures.path('child-process-echo-options.js'), null,\n+                  { env: Object.assign({}, process.env, expectedEnv) });\n+\n+  cp.on('message', common.mustCall(({ env }) => {\n+    assert.strictEqual(env.foo, expectedEnv.foo);\n+  }));\n+\n+  cp.on('exit', common.mustCall((code) => {\n+    assert.strictEqual(code, 0);\n+  }));\n+}"
        }
    ],
    "stats": {
        "total": 43,
        "additions": 43,
        "deletions": 0
    }
}