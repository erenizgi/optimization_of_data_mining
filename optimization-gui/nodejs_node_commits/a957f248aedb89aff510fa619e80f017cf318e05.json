{
    "author": "apapirovski",
    "message": "benchmark: fix next-tick-depth\n\nA recent change made these benchmarks fail by always finishing\nwith 0 iterations. Restore a counter variable.\n\nPR-URL: https://github.com/nodejs/node/pull/20461\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Rich Trott <rtrott@gmail.com>",
    "sha": "a957f248aedb89aff510fa619e80f017cf318e05",
    "files": [
        {
            "sha": "a7670d99efc35444ca50c436bd718141a3f18768",
            "filename": "benchmark/process/next-tick-depth-args.js",
            "status": "modified",
            "additions": 17,
            "deletions": 16,
            "changes": 33,
            "blob_url": "https://github.com/nodejs/node/blob/a957f248aedb89aff510fa619e80f017cf318e05/benchmark%2Fprocess%2Fnext-tick-depth-args.js",
            "raw_url": "https://github.com/nodejs/node/raw/a957f248aedb89aff510fa619e80f017cf318e05/benchmark%2Fprocess%2Fnext-tick-depth-args.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fprocess%2Fnext-tick-depth-args.js?ref=a957f248aedb89aff510fa619e80f017cf318e05",
            "patch": "@@ -8,52 +8,53 @@ const bench = common.createBenchmark(main, {\n process.maxTickDepth = Infinity;\n \n function main({ n }) {\n+  let counter = n;\n   function cb4(arg1, arg2, arg3, arg4) {\n-    if (--n) {\n-      if (n % 4 === 0)\n+    if (--counter) {\n+      if (counter % 4 === 0)\n         process.nextTick(cb4, 3.14, 1024, true, false);\n-      else if (n % 3 === 0)\n+      else if (counter % 3 === 0)\n         process.nextTick(cb3, 512, true, null);\n-      else if (n % 2 === 0)\n+      else if (counter % 2 === 0)\n         process.nextTick(cb2, false, 5.1);\n       else\n         process.nextTick(cb1, 0);\n     } else\n       bench.end(n);\n   }\n   function cb3(arg1, arg2, arg3) {\n-    if (--n) {\n-      if (n % 4 === 0)\n+    if (--counter) {\n+      if (counter % 4 === 0)\n         process.nextTick(cb4, 3.14, 1024, true, false);\n-      else if (n % 3 === 0)\n+      else if (counter % 3 === 0)\n         process.nextTick(cb3, 512, true, null);\n-      else if (n % 2 === 0)\n+      else if (counter % 2 === 0)\n         process.nextTick(cb2, false, 5.1);\n       else\n         process.nextTick(cb1, 0);\n     } else\n       bench.end(n);\n   }\n   function cb2(arg1, arg2) {\n-    if (--n) {\n-      if (n % 4 === 0)\n+    if (--counter) {\n+      if (counter % 4 === 0)\n         process.nextTick(cb4, 3.14, 1024, true, false);\n-      else if (n % 3 === 0)\n+      else if (counter % 3 === 0)\n         process.nextTick(cb3, 512, true, null);\n-      else if (n % 2 === 0)\n+      else if (counter % 2 === 0)\n         process.nextTick(cb2, false, 5.1);\n       else\n         process.nextTick(cb1, 0);\n     } else\n       bench.end(n);\n   }\n   function cb1(arg1) {\n-    if (--n) {\n-      if (n % 4 === 0)\n+    if (--counter) {\n+      if (counter % 4 === 0)\n         process.nextTick(cb4, 3.14, 1024, true, false);\n-      else if (n % 3 === 0)\n+      else if (counter % 3 === 0)\n         process.nextTick(cb3, 512, true, null);\n-      else if (n % 2 === 0)\n+      else if (counter % 2 === 0)\n         process.nextTick(cb2, false, 5.1);\n       else\n         process.nextTick(cb1, 0);"
        },
        {
            "sha": "1ad32c806181b0670e24f93a801063e3b9eca8e3",
            "filename": "benchmark/process/next-tick-depth.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/a957f248aedb89aff510fa619e80f017cf318e05/benchmark%2Fprocess%2Fnext-tick-depth.js",
            "raw_url": "https://github.com/nodejs/node/raw/a957f248aedb89aff510fa619e80f017cf318e05/benchmark%2Fprocess%2Fnext-tick-depth.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fprocess%2Fnext-tick-depth.js?ref=a957f248aedb89aff510fa619e80f017cf318e05",
            "patch": "@@ -7,11 +7,11 @@ const bench = common.createBenchmark(main, {\n process.maxTickDepth = Infinity;\n \n function main({ n }) {\n-\n+  let counter = n;\n   bench.start();\n   process.nextTick(onNextTick);\n   function onNextTick() {\n-    if (--n)\n+    if (--counter)\n       process.nextTick(onNextTick);\n     else\n       bench.end(n);"
        }
    ],
    "stats": {
        "total": 37,
        "additions": 19,
        "deletions": 18
    }
}