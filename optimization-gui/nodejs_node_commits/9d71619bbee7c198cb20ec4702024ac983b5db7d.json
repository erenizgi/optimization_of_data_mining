{
    "author": "jasnell",
    "message": "src: add --title command line argument\n\nSimple utility command line argument for setting the process\ntitle on process startup.\n\nPR-URL: https://github.com/nodejs/node/pull/21477\nReviewed-By: Bradley Farias <bradley.meck@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>",
    "sha": "9d71619bbee7c198cb20ec4702024ac983b5db7d",
    "files": [
        {
            "sha": "7ebfb084d76abb0ce5fcfc629da48c42402e0a4d",
            "filename": "doc/api/cli.md",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/9d71619bbee7c198cb20ec4702024ac983b5db7d/doc%2Fapi%2Fcli.md",
            "raw_url": "https://github.com/nodejs/node/raw/9d71619bbee7c198cb20ec4702024ac983b5db7d/doc%2Fapi%2Fcli.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fcli.md?ref=9d71619bbee7c198cb20ec4702024ac983b5db7d",
            "patch": "@@ -278,6 +278,13 @@ added: v0.11.14\n \n Throw errors for deprecations.\n \n+### `--title=title`\n+<!-- YAML\n+added: REPLACEME\n+-->\n+\n+Set `process.title` on startup.\n+\n ### `--tls-cipher-list=list`\n <!-- YAML\n added: v4.0.0\n@@ -539,6 +546,7 @@ Node options that are allowed are:\n - `--redirect-warnings`\n - `--require`, `-r`\n - `--throw-deprecation`\n+- `--title`\n - `--tls-cipher-list`\n - `--trace-deprecation`\n - `--trace-event-categories`"
        },
        {
            "sha": "31d39c226818608f76c656b2a28ccac35b9d58fe",
            "filename": "doc/node.1",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/9d71619bbee7c198cb20ec4702024ac983b5db7d/doc%2Fnode.1",
            "raw_url": "https://github.com/nodejs/node/raw/9d71619bbee7c198cb20ec4702024ac983b5db7d/doc%2Fnode.1",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fnode.1?ref=9d71619bbee7c198cb20ec4702024ac983b5db7d",
            "patch": "@@ -167,6 +167,9 @@ instead of printing to stderr.\n .It Fl -throw-deprecation\n Throw errors for deprecations.\n .\n+.It Fl -title Ns = Ns Ar title\n+Specify process.title on startup.\n+.\n .It Fl -tls-cipher-list Ns = Ns Ar list\n Specify an alternative default TLS cipher list.\n Requires Node.js to be built with crypto support. (Default)"
        },
        {
            "sha": "f9ac48c077022148042dd11c78c585ea5398a6f9",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/9d71619bbee7c198cb20ec4702024ac983b5db7d/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/9d71619bbee7c198cb20ec4702024ac983b5db7d/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=9d71619bbee7c198cb20ec4702024ac983b5db7d",
            "patch": "@@ -275,6 +275,8 @@ std::string config_warning_file;  // NOLINT(runtime/string)\n // that is used by lib/internal/bootstrap/node.js\n bool config_expose_internals = false;\n \n+std::string config_process_title;  // NOLINT(runtime/string)\n+\n bool v8_initialized = false;\n \n bool linux_at_secure = false;\n@@ -2521,6 +2523,7 @@ static void PrintHelp() {\n          \"                             write warnings to file instead of\\n\"\n          \"                             stderr\\n\"\n          \"  --throw-deprecation        throw an exception on deprecations\\n\"\n+         \"  --title=title              the process title to use on start up\\n\"\n #if HAVE_OPENSSL\n          \"  --tls-cipher-list=val      use an alternative default TLS cipher \"\n          \"list\\n\"\n@@ -2658,6 +2661,7 @@ static void CheckIfAllowedInEnv(const char* exe, bool is_env,\n     \"--redirect-warnings\",\n     \"--require\",\n     \"--throw-deprecation\",\n+    \"--title\",\n     \"--tls-cipher-list\",\n     \"--trace-deprecation\",\n     \"--trace-event-categories\",\n@@ -2828,6 +2832,8 @@ static void ParseArgs(int* argc,\n     } else if (strncmp(arg, \"--security-revert=\", 18) == 0) {\n       const char* cve = arg + 18;\n       Revert(cve);\n+    } else if (strncmp(arg, \"--title=\", 8) == 0) {\n+      config_process_title = arg + 8;\n     } else if (strcmp(arg, \"--preserve-symlinks\") == 0) {\n       config_preserve_symlinks = true;\n     } else if (strcmp(arg, \"--preserve-symlinks-main\") == 0) {\n@@ -3319,6 +3325,10 @@ void Init(int* argc,\n \n   ProcessArgv(argc, argv, exec_argc, exec_argv);\n \n+  // Set the process.title immediately after processing argv if --title is set.\n+  if (!config_process_title.empty())\n+    uv_set_process_title(config_process_title.c_str());\n+\n #if defined(NODE_HAVE_I18N_SUPPORT)\n   // If the parameter isn't given, use the env variable.\n   if (icu_data_dir.empty())"
        },
        {
            "sha": "b6160fed1d03901ef5c7b5f5e5e82ea7a801c529",
            "filename": "test/parallel/test-process-title-cli.js",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/9d71619bbee7c198cb20ec4702024ac983b5db7d/test%2Fparallel%2Ftest-process-title-cli.js",
            "raw_url": "https://github.com/nodejs/node/raw/9d71619bbee7c198cb20ec4702024ac983b5db7d/test%2Fparallel%2Ftest-process-title-cli.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-title-cli.js?ref=9d71619bbee7c198cb20ec4702024ac983b5db7d",
            "patch": "@@ -0,0 +1,13 @@\n+// Flags: --title=foo\n+'use strict';\n+\n+const common = require('../common');\n+\n+if (common.isSunOS)\n+  common.skip(`Unsupported platform [${process.platform}]`);\n+\n+const assert = require('assert');\n+\n+// Verifies that the --title=foo command line flag set the process\n+// title on startup.\n+assert.strictEqual(process.title, 'foo');"
        }
    ],
    "stats": {
        "total": 34,
        "additions": 34,
        "deletions": 0
    }
}