{
    "author": "apapirovski",
    "message": "console: fix class inheritance regression\n\nDue to a return statement with new inside the function, extending\nConsole class does not work when passing in just the stdout arg.\n\nPR-URL: https://github.com/nodejs/node/pull/20158\nFixes: https://github.com/nodejs/node/issues/20157\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "700344e388b57651c190222f570d658504b8c06f",
    "files": [
        {
            "sha": "39bcf701bf83eb57d8221c1c8c80933f3351c3b3",
            "filename": "lib/console.js",
            "status": "modified",
            "additions": 10,
            "deletions": 11,
            "changes": 21,
            "blob_url": "https://github.com/nodejs/node/blob/700344e388b57651c190222f570d658504b8c06f/lib%2Fconsole.js",
            "raw_url": "https://github.com/nodejs/node/raw/700344e388b57651c190222f570d658504b8c06f/lib%2Fconsole.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fconsole.js?ref=700344e388b57651c190222f570d658504b8c06f",
            "patch": "@@ -62,22 +62,21 @@ function Console(options /* or: stdout, stderr, ignoreErrors = true */) {\n     return new Console(...arguments);\n   }\n \n-  let stdout, stderr, ignoreErrors, colorMode;\n-  if (options && typeof options.write !== 'function') {\n-    ({\n-      stdout,\n-      stderr = stdout,\n-      ignoreErrors = true,\n-      colorMode = 'auto'\n-    } = options);\n-  } else {\n-    return new Console({\n+  if (!options || typeof options.write === 'function') {\n+    options = {\n       stdout: options,\n       stderr: arguments[1],\n       ignoreErrors: arguments[2]\n-    });\n+    };\n   }\n \n+  const {\n+    stdout,\n+    stderr = stdout,\n+    ignoreErrors = true,\n+    colorMode = 'auto'\n+  } = options;\n+\n   if (!stdout || typeof stdout.write !== 'function') {\n     throw new ERR_CONSOLE_WRITABLE_STREAM('stdout');\n   }"
        },
        {
            "sha": "5a2e10b419cb03ff1287121558ab0e08796b6fa2",
            "filename": "test/parallel/test-console-instance.js",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/700344e388b57651c190222f570d658504b8c06f/test%2Fparallel%2Ftest-console-instance.js",
            "raw_url": "https://github.com/nodejs/node/raw/700344e388b57651c190222f570d658504b8c06f/test%2Fparallel%2Ftest-console-instance.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-console-instance.js?ref=700344e388b57651c190222f570d658504b8c06f",
            "patch": "@@ -89,6 +89,13 @@ out.write = common.mustCall((d) => {\n // Console() detects if it is called without `new` keyword.\n Console(out, err);\n \n+// Extending Console works.\n+class MyConsole extends Console {\n+  hello() {}\n+}\n+const myConsole = new MyConsole(process.stdout);\n+assert.strictEqual(typeof myConsole.hello, 'function');\n+\n // Instance that does not ignore the stream errors.\n const c2 = new Console(out, err, false);\n "
        }
    ],
    "stats": {
        "total": 28,
        "additions": 17,
        "deletions": 11
    }
}