{
    "author": "lundibundi",
    "message": "child_process: fix handling of incorrect uid/gid in spawn\n\nuid/gid must be uint32, which is asserted on a c++ side but wasn't\nchecked on a JS side and therefore resulted in a process crash.\n\nRefs: https://github.com/nodejs/node/issues/22570\n\nPR-URL: https://github.com/nodejs/node/pull/22574\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Weijia Wang <starkwang@126.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "22789fd6d0a53a986073373136c269016d4267c8",
    "files": [
        {
            "sha": "2e75ace1ba0c849dbf1faf9415f161e1ce7c85d2",
            "filename": "lib/child_process.js",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/22789fd6d0a53a986073373136c269016d4267c8/lib%2Fchild_process.js",
            "raw_url": "https://github.com/nodejs/node/raw/22789fd6d0a53a986073373136c269016d4267c8/lib%2Fchild_process.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fchild_process.js?ref=22789fd6d0a53a986073373136c269016d4267c8",
            "patch": "@@ -38,7 +38,7 @@ const {\n   ERR_INVALID_OPT_VALUE,\n   ERR_OUT_OF_RANGE\n } = require('internal/errors').codes;\n-const { validateString } = require('internal/validators');\n+const { validateString, isInt32 } = require('internal/validators');\n const child_process = require('internal/child_process');\n const {\n   _validateStdio,\n@@ -426,13 +426,13 @@ function normalizeSpawnArguments(file, args, options) {\n   }\n \n   // Validate the uid, if present.\n-  if (options.uid != null && !Number.isInteger(options.uid)) {\n-    throw new ERR_INVALID_ARG_TYPE('options.uid', 'integer', options.uid);\n+  if (options.uid != null && !isInt32(options.uid)) {\n+    throw new ERR_INVALID_ARG_TYPE('options.uid', 'int32', options.uid);\n   }\n \n   // Validate the gid, if present.\n-  if (options.gid != null && !Number.isInteger(options.gid)) {\n-    throw new ERR_INVALID_ARG_TYPE('options.gid', 'integer', options.gid);\n+  if (options.gid != null && !isInt32(options.gid)) {\n+    throw new ERR_INVALID_ARG_TYPE('options.gid', 'int32', options.gid);\n   }\n \n   // Validate the shell, if present."
        },
        {
            "sha": "31a1867df945f74f163a34b2925d347de4b4baf3",
            "filename": "test/parallel/test-child-process-spawn-typeerror.js",
            "status": "modified",
            "additions": 9,
            "deletions": 1,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/22789fd6d0a53a986073373136c269016d4267c8/test%2Fparallel%2Ftest-child-process-spawn-typeerror.js",
            "raw_url": "https://github.com/nodejs/node/raw/22789fd6d0a53a986073373136c269016d4267c8/test%2Fparallel%2Ftest-child-process-spawn-typeerror.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-child-process-spawn-typeerror.js?ref=22789fd6d0a53a986073373136c269016d4267c8",
            "patch": "@@ -33,7 +33,7 @@ const invalidArgValueError =\n   common.expectsError({ code: 'ERR_INVALID_ARG_VALUE', type: TypeError }, 14);\n \n const invalidArgTypeError =\n-  common.expectsError({ code: 'ERR_INVALID_ARG_TYPE', type: TypeError }, 10);\n+  common.expectsError({ code: 'ERR_INVALID_ARG_TYPE', type: TypeError }, 12);\n \n assert.throws(function() {\n   const child = spawn(invalidcmd, 'this is not an array');\n@@ -76,6 +76,14 @@ assert.throws(function() {\n   spawn(cmd, [], 1);\n }, invalidArgTypeError);\n \n+assert.throws(function() {\n+  spawn(cmd, [], { uid: 2 ** 63 });\n+}, invalidArgTypeError);\n+\n+assert.throws(function() {\n+  spawn(cmd, [], { gid: 2 ** 63 });\n+}, invalidArgTypeError);\n+\n // Argument types for combinatorics.\n const a = [];\n const o = {};"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 14,
        "deletions": 6
    }
}