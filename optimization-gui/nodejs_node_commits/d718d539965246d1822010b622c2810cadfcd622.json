{
    "author": "apapirovski",
    "message": "buffer: fix deprecation warning emit\n\nDue to npm using workers on Windows which inititate processes\nfor code within node_modules, the current way of testing is a\nlittle too strict to catch all occurrences.\n\nPR-URL: https://github.com/nodejs/node/pull/20163\nFixes: https://github.com/nodejs/node/issues/20160\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Minwoo Jung <minwoo@nodesource.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "d718d539965246d1822010b622c2810cadfcd622",
    "files": [
        {
            "sha": "ce25317b778a3fd02b10bb349280d6f95c196ce8",
            "filename": "lib/internal/util.js",
            "status": "modified",
            "additions": 1,
            "deletions": 15,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/d718d539965246d1822010b622c2810cadfcd622/lib%2Finternal%2Futil.js",
            "raw_url": "https://github.com/nodejs/node/raw/d718d539965246d1822010b622c2810cadfcd622/lib%2Finternal%2Futil.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Futil.js?ref=d718d539965246d1822010b622c2810cadfcd622",
            "patch": "@@ -332,21 +332,8 @@ function spliceOne(list, index) {\n const kNodeModulesRE = /^(.*)[\\\\/]node_modules[\\\\/]/;\n \n let getStructuredStack;\n-let mainPrefix;\n \n function isInsideNodeModules() {\n-  // Match the prefix of the main file, if it is inside a `node_modules` folder,\n-  // up to and including the innermost `/node_modules/` bit, so that\n-  // we can later ignore files which are at the same node_modules level.\n-  // For example, having the main script at `/c/node_modules/d/d.js`\n-  // would match all code coming from `/c/node_modules/`.\n-  if (mainPrefix === undefined) {\n-    const match = process.mainModule &&\n-                  process.mainModule.filename &&\n-                  process.mainModule.filename.match(kNodeModulesRE);\n-    mainPrefix = match ? match[0] : '';\n-  }\n-\n   if (getStructuredStack === undefined) {\n     // Lazy-load to avoid a circular dependency.\n     const { runInNewContext } = require('vm');\n@@ -375,8 +362,7 @@ function isInsideNodeModules() {\n     // it's likely from Node.js core.\n     if (!/^\\/|\\\\/.test(filename))\n       continue;\n-    const match = filename.match(kNodeModulesRE);\n-    return !!match && match[0] !== mainPrefix;\n+    return kNodeModulesRE.test(filename);\n   }\n \n   return false;  // This should be unreachable."
        },
        {
            "sha": "c6a419f82ade7950b6980550819b29d21fffa087",
            "filename": "test/parallel/test-buffer-constructor-node-modules-paths.js",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/d718d539965246d1822010b622c2810cadfcd622/test%2Fparallel%2Ftest-buffer-constructor-node-modules-paths.js",
            "raw_url": "https://github.com/nodejs/node/raw/d718d539965246d1822010b622c2810cadfcd622/test%2Fparallel%2Ftest-buffer-constructor-node-modules-paths.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-buffer-constructor-node-modules-paths.js?ref=d718d539965246d1822010b622c2810cadfcd622",
            "patch": "@@ -20,16 +20,18 @@ function test(main, callSite, expected) {\n     assert.strictEqual(stderr.trim(), '');\n }\n \n-test('/a/node_modules/b.js', '/a/node_modules/x.js', true);\n+test('/a/node_modules/b.js', '/a/node_modules/x.js', false);\n test('/a/node_modules/b.js', '/a/node_modules/foo/node_modules/x.js', false);\n test('/a/node_modules/foo/node_modules/b.js', '/a/node_modules/x.js', false);\n test('/node_modules/foo/b.js', '/node_modules/foo/node_modules/x.js', false);\n test('/a.js', '/b.js', true);\n test('/a.js', '/node_modules/b.js', false);\n-test('c:\\\\a\\\\node_modules\\\\b.js', 'c:\\\\a\\\\node_modules\\\\x.js', true);\n+test('/node_modules/a.js.js', '/b.js', true);\n+test('c:\\\\a\\\\node_modules\\\\b.js', 'c:\\\\a\\\\node_modules\\\\x.js', false);\n test('c:\\\\a\\\\node_modules\\\\b.js',\n      'c:\\\\a\\\\node_modules\\\\foo\\\\node_modules\\\\x.js', false);\n test('c:\\\\node_modules\\\\foo\\\\b.js',\n      'c:\\\\node_modules\\\\foo\\\\node_modules\\\\x.js', false);\n test('c:\\\\a.js', 'c:\\\\b.js', true);\n test('c:\\\\a.js', 'c:\\\\node_modules\\\\b.js', false);\n+test('c:\\\\node_modules\\\\a.js', 'c:\\\\b.js', true);"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 5,
        "deletions": 17
    }
}