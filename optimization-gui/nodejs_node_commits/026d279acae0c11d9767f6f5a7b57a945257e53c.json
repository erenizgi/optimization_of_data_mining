{
    "author": "GauthamBanasandra",
    "message": "inspector: use js_app.html as the landing page for chrome devtools\n\nAs of this commit in chromium -\nhttps://chromium-review.googlesource.com/c/chromium/src/+/905450\na new landing page (js_app.html) has been added and inspector.html\nhas been made as the fallback page.\n\nAnother motivation for this patch is the following bug in\nchromium -\nhttps://bugs.chromium.org/p/chromium/issues/detail?id=846642\ndue to which, source maps won't get applied with inspector.html,\nbut works with js_app.html\n\nIn order to maintain compatibility, this patch adds a URL\n\"devtoolsFrontendUrlCompat\" to the response of /json/list REST API\nso that those using Chrome browsers older than 66.0.3345.0\ncould use this to open DevTools.\n\nPR-URL: https://github.com/nodejs/node/pull/21385\nRefs: https://bugs.chromium.org/p/chromium/issues/detail?id=846642\nRefs: https://chromium-review.googlesource.com/c/chromium/src/+/905450\nReviewed-By: Aleksei Koziatinskii <ak239spb@gmail.com>\nReviewed-By: Jan Krems <jan.krems@gmail.com>\nReviewed-By: Matheus Marchini <matheus@sthima.com>",
    "sha": "026d279acae0c11d9767f6f5a7b57a945257e53c",
    "files": [
        {
            "sha": "5a5e1cd7c7acff8833421e80c9545ebb0c18ec18",
            "filename": "doc/api/debugger.md",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/026d279acae0c11d9767f6f5a7b57a945257e53c/doc%2Fapi%2Fdebugger.md",
            "raw_url": "https://github.com/nodejs/node/raw/026d279acae0c11d9767f6f5a7b57a945257e53c/doc%2Fapi%2Fdebugger.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fdebugger.md?ref=026d279acae0c11d9767f6f5a7b57a945257e53c",
            "patch": "@@ -187,12 +187,15 @@ flag instead of `--inspect`.\n $ node --inspect index.js\n Debugger listening on 127.0.0.1:9229.\n To start debugging, open the following URL in Chrome:\n-    chrome-devtools://devtools/bundled/inspector.html?experiments=true&v8only=true&ws=127.0.0.1:9229/dc9010dd-f8b8-4ac5-a510-c1a114ec7d29\n+    chrome-devtools://devtools/bundled/js_app.html?experiments=true&v8only=true&ws=127.0.0.1:9229/dc9010dd-f8b8-4ac5-a510-c1a114ec7d29\n ```\n \n (In the example above, the UUID dc9010dd-f8b8-4ac5-a510-c1a114ec7d29\n at the end of the URL is generated on the fly, it varies in different\n debugging sessions.)\n \n+If the Chrome browser is older than 66.0.3345.0,\n+use `inspector.html` instead of `js_app.html` in the above URL.\n+\n [Chrome DevTools Protocol]: https://chromedevtools.github.io/devtools-protocol/\n [V8 Inspector]: #debugger_v8_inspector_integration_for_node_js"
        },
        {
            "sha": "174dc7c726f21c3c2a0f0ee6a14a1b6b50bdf262",
            "filename": "src/inspector_socket_server.cc",
            "status": "modified",
            "additions": 16,
            "deletions": 5,
            "changes": 21,
            "blob_url": "https://github.com/nodejs/node/blob/026d279acae0c11d9767f6f5a7b57a945257e53c/src%2Finspector_socket_server.cc",
            "raw_url": "https://github.com/nodejs/node/raw/026d279acae0c11d9767f6f5a7b57a945257e53c/src%2Finspector_socket_server.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector_socket_server.cc?ref=026d279acae0c11d9767f6f5a7b57a945257e53c",
            "patch": "@@ -334,16 +334,27 @@ void InspectorSocketServer::SendListResponse(InspectorSocket* socket,\n       detected_host = FormatHostPort(socket->GetHost(),\n                                      session->server_port());\n     }\n-    std::ostringstream frontend_url;\n-    frontend_url << \"chrome-devtools://devtools/bundled\";\n-    frontend_url << \"/inspector.html?experiments=true&v8only=true&ws=\";\n-    frontend_url << FormatAddress(detected_host, id, false);\n-    target_map[\"devtoolsFrontendUrl\"] += frontend_url.str();\n+    std::string formatted_address = FormatAddress(detected_host, id, false);\n+    target_map[\"devtoolsFrontendUrl\"] = GetFrontendURL(false,\n+                                                       formatted_address);\n+    // The compat URL is for Chrome browsers older than 66.0.3345.0\n+    target_map[\"devtoolsFrontendUrlCompat\"] = GetFrontendURL(true,\n+                                                             formatted_address);\n     target_map[\"webSocketDebuggerUrl\"] = FormatAddress(detected_host, id, true);\n   }\n   SendHttpResponse(socket, MapsToString(response));\n }\n \n+std::string InspectorSocketServer::GetFrontendURL(bool is_compat,\n+    const std::string &formatted_address) {\n+  std::ostringstream frontend_url;\n+  frontend_url << \"chrome-devtools://devtools/bundled/\";\n+  frontend_url << (is_compat ? \"inspector\" : \"js_app\");\n+  frontend_url << \".html?experiments=true&v8only=true&ws=\";\n+  frontend_url << formatted_address;\n+  return frontend_url.str();\n+}\n+\n bool InspectorSocketServer::Start() {\n   CHECK_NE(delegate_, nullptr);\n   CHECK_EQ(state_, ServerState::kNew);"
        },
        {
            "sha": "bbc2195095772f91de1740b6bca941aaea872d77",
            "filename": "src/inspector_socket_server.h",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/026d279acae0c11d9767f6f5a7b57a945257e53c/src%2Finspector_socket_server.h",
            "raw_url": "https://github.com/nodejs/node/raw/026d279acae0c11d9767f6f5a7b57a945257e53c/src%2Finspector_socket_server.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector_socket_server.h?ref=026d279acae0c11d9767f6f5a7b57a945257e53c",
            "patch": "@@ -81,6 +81,8 @@ class InspectorSocketServer {\n \n   void SendListResponse(InspectorSocket* socket, const std::string& host,\n                         SocketSession* session);\n+  std::string GetFrontendURL(bool is_compat,\n+                             const std::string &formatted_address);\n   bool TargetExists(const std::string& id);\n \n   enum class ServerState {kNew, kRunning, kStopping, kStopped};"
        }
    ],
    "stats": {
        "total": 28,
        "additions": 22,
        "deletions": 6
    }
}