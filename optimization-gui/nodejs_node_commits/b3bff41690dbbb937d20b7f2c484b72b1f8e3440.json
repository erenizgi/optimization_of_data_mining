{
    "author": "vsemozhetbyt",
    "message": "doc, tools: make type parsing more strict\n\nPR-URL: https://github.com/nodejs/node/pull/19881\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "b3bff41690dbbb937d20b7f2c484b72b1f8e3440",
    "files": [
        {
            "sha": "16040e85352c7734acaa750dbd89b5a392dba4e9",
            "filename": "doc/api/addons.md",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/doc%2Fapi%2Faddons.md",
            "raw_url": "https://github.com/nodejs/node/raw/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/doc%2Fapi%2Faddons.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Faddons.md?ref=b3bff41690dbbb937d20b7f2c484b72b1f8e3440",
            "patch": "@@ -1096,8 +1096,10 @@ has ended but before the JavaScript VM is terminated and Node.js shuts down.\n \n #### void AtExit(callback, args)\n \n-* `callback` {void (\\*)(void\\*)} A pointer to the function to call at exit.\n-* `args` {void\\*} A pointer to pass to the callback at exit.\n+* `callback` <span class=\"type\">&lt;void (\\*)(void\\*)&gt;</span>\n+  A pointer to the function to call at exit.\n+* `args` <span class=\"type\">&lt;void\\*&gt;</span>\n+  A pointer to pass to the callback at exit.\n \n Registers exit hooks that run after the event loop has ended but before the VM\n is killed."
        },
        {
            "sha": "0a22723c65e0a58d28596ade78945784fa75799f",
            "filename": "doc/api/deprecations.md",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/doc%2Fapi%2Fdeprecations.md",
            "raw_url": "https://github.com/nodejs/node/raw/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/doc%2Fapi%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fdeprecations.md?ref=b3bff41690dbbb937d20b7f2c484b72b1f8e3440",
            "patch": "@@ -890,12 +890,13 @@ should start using the `async_context` variant of `MakeCallback` or\n `CallbackScope`, or the high-level `AsyncResource` class.\n \n <a id=\"DEP0098\"></a>\n-### DEP0098: AsyncHooks Embedder AsyncResource.emit{Before,After} APIs\n+### DEP0098: AsyncHooks Embedder AsyncResource.emitBefore and AsyncResource.emitAfter APIs\n \n Type: Runtime\n \n-The embedded API provided by AsyncHooks exposes emit{Before,After} methods\n-which are very easy to use incorrectly which can lead to unrecoverable errors.\n+The embedded API provided by AsyncHooks exposes `.emitBefore()` and\n+`.emitAfter()` methods which are very easy to use incorrectly which can lead\n+to unrecoverable errors.\n \n Use [`asyncResource.runInAsyncScope()`][] API instead which provides a much\n safer, and more convenient, alternative. See"
        },
        {
            "sha": "4bb62e9124ac49b36261159e45879ae35703a89c",
            "filename": "doc/api/http2.md",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/doc%2Fapi%2Fhttp2.md",
            "raw_url": "https://github.com/nodejs/node/raw/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/doc%2Fapi%2Fhttp2.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fhttp2.md?ref=b3bff41690dbbb937d20b7f2c484b72b1f8e3440",
            "patch": "@@ -2532,7 +2532,7 @@ authentication details.\n added: v8.4.0\n -->\n \n-* {http2.Http2Stream}\n+* {Http2Stream}\n \n The [`Http2Stream`][] object backing the request.\n \n@@ -2948,7 +2948,7 @@ an empty string.\n added: v8.4.0\n -->\n \n-* {http2.Http2Stream}\n+* {Http2Stream}\n \n The [`Http2Stream`][] object backing the response.\n "
        },
        {
            "sha": "c454d67574655bf980a721b023cd6d448a6f1b61",
            "filename": "doc/api/process.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/doc%2Fapi%2Fprocess.md",
            "raw_url": "https://github.com/nodejs/node/raw/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/doc%2Fapi%2Fprocess.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fprocess.md?ref=b3bff41690dbbb937d20b7f2c484b72b1f8e3440",
            "patch": "@@ -89,8 +89,8 @@ the child process.\n \n The listener callback is invoked with the following arguments:\n * `message` {Object} a parsed JSON object or primitive value.\n-* `sendHandle` {Handle object} a [`net.Socket`][] or [`net.Server`][] object, or\n-  undefined.\n+* `sendHandle` {net.Server|net.Socket} a [`net.Server`][] or [`net.Socket`][]\n+  object, or undefined.\n \n The message goes through serialization and parsing. The resulting message might\n not be the same as what is originally sent.\n@@ -1531,7 +1531,7 @@ added: v0.5.9\n -->\n \n * `message` {Object}\n-* `sendHandle` {Handle object}\n+* `sendHandle` {net.Server|net.Socket}\n * `options` {Object}\n * `callback` {Function}\n * Returns: {boolean}"
        },
        {
            "sha": "f1e634a04e4400cf26889104881be4d6cf753397",
            "filename": "tools/doc/type-parser.js",
            "status": "modified",
            "additions": 22,
            "deletions": 13,
            "changes": 35,
            "blob_url": "https://github.com/nodejs/node/blob/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/tools%2Fdoc%2Ftype-parser.js",
            "raw_url": "https://github.com/nodejs/node/raw/b3bff41690dbbb937d20b7f2c484b72b1f8e3440/tools%2Fdoc%2Ftype-parser.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fdoc%2Ftype-parser.js?ref=b3bff41690dbbb937d20b7f2c484b72b1f8e3440",
            "patch": "@@ -2,15 +2,15 @@\n \n const jsDocPrefix = 'https://developer.mozilla.org/en-US/docs/Web/JavaScript/';\n \n-const jsPrimitiveUrl = `${jsDocPrefix}Data_structures`;\n+const jsDataStructuresUrl = `${jsDocPrefix}Data_structures`;\n const jsPrimitives = {\n-  'boolean': 'Boolean',\n-  'integer': 'Number', // Not a primitive, used for clarification.\n-  'null': 'Null',\n-  'number': 'Number',\n-  'string': 'String',\n-  'symbol': 'Symbol',\n-  'undefined': 'Undefined'\n+  boolean: 'Boolean',\n+  integer: 'Number', // Not a primitive, used for clarification.\n+  null: 'Null',\n+  number: 'Number',\n+  string: 'String',\n+  symbol: 'Symbol',\n+  undefined: 'Undefined'\n };\n \n const jsGlobalObjectsUrl = `${jsDocPrefix}Reference/Global_Objects/`;\n@@ -25,13 +25,15 @@ const jsGlobalTypes = [\n ];\n \n const customTypesMap = {\n+  'any': `${jsDataStructuresUrl}#Data_types`,\n+\n+  'this': `${jsDocPrefix}Reference/Operators/this`,\n+\n   'Iterable':\n     `${jsDocPrefix}Reference/Iteration_protocols#The_iterable_protocol`,\n   'Iterator':\n     `${jsDocPrefix}Reference/Iteration_protocols#The_iterator_protocol`,\n \n-  'this': `${jsDocPrefix}Reference/Operators/this`,\n-\n   'AsyncHook': 'async_hooks.html#async_hooks_async_hooks_createhook_callbacks',\n \n   'Buffer': 'buffer.html#buffer_class_buffer',\n@@ -63,12 +65,14 @@ const customTypesMap = {\n   'http.Server': 'http.html#http_class_http_server',\n   'http.ServerResponse': 'http.html#http_class_http_serverresponse',\n \n+  'ClientHttp2Session': 'http2.html#http2_class_clienthttp2session',\n   'ClientHttp2Stream': 'http2.html#http2_class_clienthttp2stream',\n   'HTTP/2 Headers Object': 'http2.html#http2_headers_object',\n   'HTTP/2 Settings Object': 'http2.html#http2_settings_object',\n   'http2.Http2ServerRequest': 'http2.html#http2_class_http2_http2serverrequest',\n   'http2.Http2ServerResponse':\n     'http2.html#http2_class_http2_http2serverresponse',\n+  'Http2SecureServer': 'http2.html#http2_class_http2secureserver',\n   'Http2Server': 'http2.html#http2_class_http2server',\n   'Http2Session': 'http2.html#http2_class_http2session',\n   'Http2Stream': 'http2.html#http2_class_http2stream',\n@@ -83,6 +87,8 @@ const customTypesMap = {\n   'os.constants.dlopen': 'os.html#os_dlopen_constants',\n \n   'PerformanceEntry': 'perf_hooks.html#perf_hooks_class_performanceentry',\n+  'PerformanceNodeTiming':\n+    'perf_hooks.html#perf_hooks_class_performancenodetiming_extends_performanceentry', // eslint-disable-line max-len\n   'PerformanceObserver':\n     'perf_hooks.html#perf_hooks_class_performanceobserver_callback',\n   'PerformanceObserverEntryList':\n@@ -123,10 +129,10 @@ function toLink(typeInput) {\n       const typeTextFull = typeText;\n       typeText = typeText.replace(arrayPart, '');\n \n-      const primitive = jsPrimitives[typeText.toLowerCase()];\n+      const primitive = jsPrimitives[typeText];\n \n       if (primitive !== undefined) {\n-        typeUrl = `${jsPrimitiveUrl}#${primitive}_type`;\n+        typeUrl = `${jsDataStructuresUrl}#${primitive}_type`;\n       } else if (jsGlobalTypes.includes(typeText)) {\n         typeUrl = `${jsGlobalObjectsUrl}${typeText}`;\n       } else if (customTypesMap[typeText]) {\n@@ -137,7 +143,10 @@ function toLink(typeInput) {\n         typeLinks.push(\n           `<a href=\"${typeUrl}\" class=\"type\">&lt;${typeTextFull}&gt;</a>`);\n       } else {\n-        typeLinks.push(`<span class=\"type\">&lt;${typeTextFull}&gt;</span>`);\n+        throw new Error(\n+          `Unrecognized type: '${typeTextFull}'.\\n` +\n+          \"Please, edit the type or update the 'tools/doc/type-parser.js'.\"\n+        );\n       }\n     } else {\n       throw new Error(`Empty type slot: ${typeInput}`);"
        }
    ],
    "stats": {
        "total": 58,
        "additions": 35,
        "deletions": 23
    }
}