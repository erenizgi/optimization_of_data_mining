{
    "author": "ryzokuken",
    "message": "tools: update cpplint to check for inline headers\n\nUpdate cpplint.py to check for inline headers when the corresponding\nheader is already included.\n\nPR-URL: https://github.com/nodejs/node/pull/21521\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "fc81e801913de3e3f3c0c8e26c105f983a74e539",
    "files": [
        {
            "sha": "d96713aa80a1ffac48b8f9eaa851d74b869a15f4",
            "filename": "tools/cpplint.py",
            "status": "modified",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/fc81e801913de3e3f3c0c8e26c105f983a74e539/tools%2Fcpplint.py",
            "raw_url": "https://github.com/nodejs/node/raw/fc81e801913de3e3f3c0c8e26c105f983a74e539/tools%2Fcpplint.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fcpplint.py?ref=fc81e801913de3e3f3c0c8e26c105f983a74e539",
            "patch": "@@ -1900,6 +1900,21 @@ def CheckForBadCharacters(filename, lines, error):\n       error(filename, linenum, 'readability/nul', 5, 'Line contains NUL byte.')\n \n \n+def CheckInlineHeader(filename, include_state, error):\n+  \"\"\"Logs an error if both a header and its inline variant are included.\"\"\"\n+\n+  all_headers = dict(item for sublist in include_state.include_list\n+                     for item in sublist)\n+  bad_headers = set('%s.h' % name[:-6] for name in all_headers.keys()\n+                    if name.endswith('-inl.h'))\n+  bad_headers &= set(all_headers.keys())\n+\n+  for name in bad_headers:\n+    err =  '%s includes both %s and %s-inl.h' % (filename, name, name)\n+    linenum = all_headers[name]\n+    error(filename, linenum, 'build/include', 5, err)\n+\n+\n def CheckForNewlineAtEOF(filename, lines, error):\n   \"\"\"Logs an error if there is no newline char at the end of the file.\n \n@@ -5866,6 +5881,8 @@ def ProcessFileData(filename, file_extension, lines, error,\n \n   CheckForNewlineAtEOF(filename, lines, error)\n \n+  CheckInlineHeader(filename, include_state, error)\n+\n def ProcessConfigOverrides(filename):\n   \"\"\" Loads the configuration files and processes the config overrides.\n "
        }
    ],
    "stats": {
        "total": 17,
        "additions": 17,
        "deletions": 0
    }
}