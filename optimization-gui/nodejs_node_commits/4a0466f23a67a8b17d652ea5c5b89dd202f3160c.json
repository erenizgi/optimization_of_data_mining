{
    "author": "yanivfriedensohn",
    "message": "net: throw error if port/path does not exist in options\n\nThrow error ERR_INVALID_ARG_VALUE if the port and path properties\ndo not exist in the options object argument when calling\nserver.listen().\n\nRefs: https://github.com/nodejs/node/issues/16712\n\nPR-URL: https://github.com/nodejs/node/pull/22085\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>",
    "sha": "4a0466f23a67a8b17d652ea5c5b89dd202f3160c",
    "files": [
        {
            "sha": "e78e1b6f3fb9427d68dbc12b4fcc4d0d2d80aa61",
            "filename": "lib/net.js",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4a0466f23a67a8b17d652ea5c5b89dd202f3160c/lib%2Fnet.js",
            "raw_url": "https://github.com/nodejs/node/raw/4a0466f23a67a8b17d652ea5c5b89dd202f3160c/lib%2Fnet.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fnet.js?ref=4a0466f23a67a8b17d652ea5c5b89dd202f3160c",
            "patch": "@@ -68,6 +68,7 @@ const errors = require('internal/errors');\n const {\n   ERR_INVALID_ADDRESS_FAMILY,\n   ERR_INVALID_ARG_TYPE,\n+  ERR_INVALID_ARG_VALUE,\n   ERR_INVALID_FD_TYPE,\n   ERR_INVALID_IP_ADDRESS,\n   ERR_INVALID_OPT_VALUE,\n@@ -1496,6 +1497,11 @@ Server.prototype.listen = function(...args) {\n     return this;\n   }\n \n+  if (!(('port' in options) || ('path' in options))) {\n+    throw new ERR_INVALID_ARG_VALUE('options', options,\n+                                    'must have the property \"port\" or \"path\"');\n+  }\n+\n   throw new ERR_INVALID_OPT_VALUE('options', util.inspect(options));\n };\n "
        },
        {
            "sha": "41cc07d40d4d6e5ffcce1dc21b5f73fab4585c34",
            "filename": "test/parallel/test-net-server-listen-options.js",
            "status": "modified",
            "additions": 23,
            "deletions": 7,
            "changes": 30,
            "blob_url": "https://github.com/nodejs/node/blob/4a0466f23a67a8b17d652ea5c5b89dd202f3160c/test%2Fparallel%2Ftest-net-server-listen-options.js",
            "raw_url": "https://github.com/nodejs/node/raw/4a0466f23a67a8b17d652ea5c5b89dd202f3160c/test%2Fparallel%2Ftest-net-server-listen-options.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-net-server-listen-options.js?ref=4a0466f23a67a8b17d652ea5c5b89dd202f3160c",
            "patch": "@@ -57,12 +57,23 @@ const listenOnPort = [\n     const block = () => {\n       net.createServer().listen(options, common.mustNotCall());\n     };\n-    common.expectsError(block,\n-                        {\n-                          code: 'ERR_INVALID_OPT_VALUE',\n-                          type: TypeError,\n-                          message: /^The value \"{.*}\" is invalid for option \"options\"$/\n-                        });\n+\n+    if (typeof options === 'object' &&\n+      !(('port' in options) || ('path' in options))) {\n+      common.expectsError(block,\n+                          {\n+                            code: 'ERR_INVALID_ARG_VALUE',\n+                            type: TypeError,\n+                            message: /^The argument 'options' must have the property \"port\" or \"path\"\\. Received .+$/,\n+                          });\n+    } else {\n+      common.expectsError(block,\n+                          {\n+                            code: 'ERR_INVALID_OPT_VALUE',\n+                            type: TypeError,\n+                            message: /^The value \"{.*}\" is invalid for option \"options\"(?:\\. .+)?$/,\n+                          });\n+    }\n   }\n \n   shouldFailToListen(false, { port: false });\n@@ -73,6 +84,11 @@ const listenOnPort = [\n   shouldFailToListen({ fd: -1 });\n   // Invalid path in listen(options)\n   shouldFailToListen({ path: -1 });\n-  // Host without port\n+\n+  // Neither port or path are specified in options\n+  shouldFailToListen({});\n   shouldFailToListen({ host: 'localhost' });\n+  shouldFailToListen({ host: 'localhost:3000' });\n+  shouldFailToListen({ host: { port: 3000 } });\n+  shouldFailToListen({ exclusive: true });\n }"
        }
    ],
    "stats": {
        "total": 36,
        "additions": 29,
        "deletions": 7
    }
}