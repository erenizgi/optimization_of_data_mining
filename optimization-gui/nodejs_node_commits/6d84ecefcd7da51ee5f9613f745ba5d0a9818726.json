{
    "author": "devsnek",
    "message": "vm: flip Module#link's signature\n\nThe specifier parameter is deemed to be more essential than\nreferencingModule. Flipping the parameter order allows developers to\nwrite simple linker functions that only take in a specifier.\n\nPR-URL: https://github.com/nodejs/node/pull/18471\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "6d84ecefcd7da51ee5f9613f745ba5d0a9818726",
    "files": [
        {
            "sha": "8ea217da86b23f67b6213fb95cb1fdce3fcc9cc8",
            "filename": "doc/api/vm.md",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/6d84ecefcd7da51ee5f9613f745ba5d0a9818726/doc%2Fapi%2Fvm.md",
            "raw_url": "https://github.com/nodejs/node/raw/6d84ecefcd7da51ee5f9613f745ba5d0a9818726/doc%2Fapi%2Fvm.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fvm.md?ref=6d84ecefcd7da51ee5f9613f745ba5d0a9818726",
            "patch": "@@ -117,7 +117,7 @@ const contextifiedSandbox = vm.createContext({ secret: 42 });\n   // \"foo\" module every time it is called. In a full-fledged module system, a\n   // cache would probably be used to avoid duplicated modules.\n \n-  async function linker(referencingModule, specifier) {\n+  async function linker(specifier, referencingModule) {\n     if (specifier === 'foo') {\n       return new vm.Module(`\n         // The \"secret\" variable refers to the global variable we added to\n@@ -319,14 +319,13 @@ can only be called once per module.\n \n Two parameters will be passed to the `linker` function:\n \n-- `referencingModule` The `Module` object `link()` is called on.\n - `specifier` The specifier of the requested module:\n-\n   <!-- eslint-skip -->\n   ```js\n   import foo from 'foo';\n   //              ^^^^^ the module specifier\n   ```\n+- `referencingModule` The `Module` object `link()` is called on.\n \n The function is expected to return a `Module` object or a `Promise` that\n eventually resolves to a `Module` object. The returned `Module` must satisfy the"
        },
        {
            "sha": "2f139d8b260f86e1c8044ca6cc69312ee0217c4c",
            "filename": "lib/internal/vm/Module.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/6d84ecefcd7da51ee5f9613f745ba5d0a9818726/lib%2Finternal%2Fvm%2FModule.js",
            "raw_url": "https://github.com/nodejs/node/raw/6d84ecefcd7da51ee5f9613f745ba5d0a9818726/lib%2Finternal%2Fvm%2FModule.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fvm%2FModule.js?ref=6d84ecefcd7da51ee5f9613f745ba5d0a9818726",
            "patch": "@@ -135,7 +135,7 @@ class Module {\n     const promises = [];\n     wrap.link((specifier) => {\n       const p = (async () => {\n-        const m = await linker(this, specifier);\n+        const m = await linker(specifier, this);\n         if (!m || !wrapMap.has(m))\n           throw new errors.Error('ERR_VM_MODULE_NOT_MODULE');\n         if (m.context !== this.context)"
        },
        {
            "sha": "1c7e01cf30e51baf0248d55af7e6097bc9df27c2",
            "filename": "test/parallel/test-vm-module-errors.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/6d84ecefcd7da51ee5f9613f745ba5d0a9818726/test%2Fparallel%2Ftest-vm-module-errors.js",
            "raw_url": "https://github.com/nodejs/node/raw/6d84ecefcd7da51ee5f9613f745ba5d0a9818726/test%2Fparallel%2Ftest-vm-module-errors.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-errors.js?ref=6d84ecefcd7da51ee5f9613f745ba5d0a9818726",
            "patch": "@@ -109,7 +109,7 @@ async function checkModuleState() {\n \n   {\n     const m = new Module('import \"foo\";');\n-    await m.link(common.mustCall(async (module, specifier) => {\n+    await m.link(common.mustCall(async (specifier, module) => {\n       assert.strictEqual(module, m);\n       assert.strictEqual(specifier, 'foo');\n       assert.strictEqual(m.linkingStatus, 'linking');"
        },
        {
            "sha": "843c1fdc517787ed75e343552940c872f259ab9a",
            "filename": "test/parallel/test-vm-module-link.js",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/6d84ecefcd7da51ee5f9613f745ba5d0a9818726/test%2Fparallel%2Ftest-vm-module-link.js",
            "raw_url": "https://github.com/nodejs/node/raw/6d84ecefcd7da51ee5f9613f745ba5d0a9818726/test%2Fparallel%2Ftest-vm-module-link.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-link.js?ref=6d84ecefcd7da51ee5f9613f745ba5d0a9818726",
            "patch": "@@ -18,7 +18,7 @@ async function simple() {\n \n   assert.deepStrictEqual(bar.dependencySpecifiers, ['foo']);\n \n-  await bar.link(common.mustCall((module, specifier) => {\n+  await bar.link(common.mustCall((specifier, module) => {\n     assert.strictEqual(module, bar);\n     assert.strictEqual(specifier, 'foo');\n     return foo;\n@@ -38,7 +38,7 @@ async function depth() {\n       import ${parentName} from '${parentName}';\n       export default ${parentName};\n     `);\n-    await mod.link(common.mustCall((module, specifier) => {\n+    await mod.link(common.mustCall((specifier, module) => {\n       assert.strictEqual(module, mod);\n       assert.strictEqual(specifier, parentName);\n       return parentModule;\n@@ -68,10 +68,10 @@ async function circular() {\n       return foo;\n     }\n   `);\n-  await foo.link(common.mustCall(async (fooModule, fooSpecifier) => {\n+  await foo.link(common.mustCall(async (fooSpecifier, fooModule) => {\n     assert.strictEqual(fooModule, foo);\n     assert.strictEqual(fooSpecifier, 'bar');\n-    await bar.link(common.mustCall((barModule, barSpecifier) => {\n+    await bar.link(common.mustCall((barSpecifier, barModule) => {\n       assert.strictEqual(barModule, bar);\n       assert.strictEqual(barSpecifier, 'foo');\n       assert.strictEqual(foo.linkingStatus, 'linking');\n@@ -111,7 +111,7 @@ async function circular2() {\n   };\n   const moduleMap = new Map();\n   const rootModule = new Module(sourceMap.root, { url: 'vm:root' });\n-  async function link(referencingModule, specifier) {\n+  async function link(specifier, referencingModule) {\n     if (moduleMap.has(specifier)) {\n       return moduleMap.get(specifier);\n     }"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 9,
        "deletions": 10
    }
}