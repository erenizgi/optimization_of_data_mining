{
    "author": "joyeecheung",
    "message": "src: move process object creation into node_process_object.cc\n\nChanges `SetupProcessObject` to `CreateProessObject` which creates\nthe process object from scratch and return it to `Environment::Start`\nto be stored in the Environment object.\n\nPR-URL: https://github.com/nodejs/node/pull/25397\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>",
    "sha": "5a15f4bdfa060082757062dc5f39519d93e7b8fb",
    "files": [
        {
            "sha": "36a6ea92dc3f071aeeff4e3ffcb563649686e85f",
            "filename": "node.gyp",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/5a15f4bdfa060082757062dc5f39519d93e7b8fb/node.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/5a15f4bdfa060082757062dc5f39519d93e7b8fb/node.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/node.gyp?ref=5a15f4bdfa060082757062dc5f39519d93e7b8fb",
            "patch": "@@ -370,7 +370,8 @@\n         'src/node_perf.cc',\n         'src/node_platform.cc',\n         'src/node_postmortem_metadata.cc',\n-        'src/node_process.cc',\n+        'src/node_process_methods.cc',\n+        'src/node_process_object.cc',\n         'src/node_serdes.cc',\n         'src/node_stat_watcher.cc',\n         'src/node_symbols.cc',"
        },
        {
            "sha": "19cc16fcfac2711f8309c664dfe1c98aa23d0b16",
            "filename": "src/env.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 10,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fenv.cc",
            "raw_url": "https://github.com/nodejs/node/raw/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fenv.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv.cc?ref=5a15f4bdfa060082757062dc5f39519d93e7b8fb",
            "patch": "@@ -22,7 +22,6 @@ using v8::Context;\n using v8::EmbedderGraph;\n using v8::External;\n using v8::Function;\n-using v8::FunctionTemplate;\n using v8::HandleScope;\n using v8::Integer;\n using v8::Isolate;\n@@ -339,17 +338,9 @@ void Environment::Start(const std::vector<std::string>& args,\n     StartProfilerIdleNotifier();\n   }\n \n-  auto process_template = FunctionTemplate::New(isolate());\n-  process_template->SetClassName(FIXED_ONE_BYTE_STRING(isolate(), \"process\"));\n-\n-  auto process_object = process_template->GetFunction(context())\n-                            .ToLocalChecked()\n-                            ->NewInstance(context())\n-                            .ToLocalChecked();\n+  Local<Object> process_object = CreateProcessObject(this, args, exec_args);\n   set_process_object(process_object);\n \n-  SetupProcessObject(this, args, exec_args);\n-\n   static uv_once_t init_once = UV_ONCE_INIT;\n   uv_once(&init_once, InitThreadLocalOnce);\n   uv_key_set(&thread_local_env, this);"
        },
        {
            "sha": "59c13aba329d4bac5ee8a1ffc55ee4efc17ec0c2",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 226,
            "changes": 226,
            "blob_url": "https://github.com/nodejs/node/blob/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=5a15f4bdfa060082757062dc5f39519d93e7b8fb",
            "patch": "@@ -124,14 +124,12 @@ using v8::MaybeLocal;\n using v8::Message;\n using v8::MicrotasksPolicy;\n using v8::NewStringType;\n-using v8::None;\n using v8::Nothing;\n using v8::Object;\n using v8::ObjectTemplate;\n using v8::Script;\n using v8::ScriptOrigin;\n using v8::SealHandleScope;\n-using v8::SideEffectType;\n using v8::String;\n using v8::TracingController;\n using v8::Undefined;\n@@ -686,230 +684,6 @@ static void OnMessage(Local<Message> message, Local<Value> error) {\n   }\n }\n \n-void SetupProcessObject(Environment* env,\n-                        const std::vector<std::string>& args,\n-                        const std::vector<std::string>& exec_args) {\n-  Isolate* isolate = env->isolate();\n-  HandleScope scope(isolate);\n-  Local<Context> context = env->context();\n-\n-  Local<Object> process = env->process_object();\n-\n-  auto title_string = FIXED_ONE_BYTE_STRING(env->isolate(), \"title\");\n-  CHECK(process->SetAccessor(\n-      env->context(),\n-      title_string,\n-      ProcessTitleGetter,\n-      env->is_main_thread() ? ProcessTitleSetter : nullptr,\n-      env->as_external(),\n-      DEFAULT,\n-      None,\n-      SideEffectType::kHasNoSideEffect).FromJust());\n-\n-  // process.version\n-  READONLY_PROPERTY(process,\n-                    \"version\",\n-                    FIXED_ONE_BYTE_STRING(env->isolate(), NODE_VERSION));\n-\n-  // process.versions\n-  Local<Object> versions = Object::New(env->isolate());\n-  READONLY_PROPERTY(process, \"versions\", versions);\n-\n-#define V(key)                                                                 \\\n-  if (!per_process::metadata.versions.key.empty()) {                           \\\n-    READONLY_STRING_PROPERTY(                                                  \\\n-        versions, #key, per_process::metadata.versions.key);                   \\\n-  }\n-  NODE_VERSIONS_KEYS(V)\n-#undef V\n-\n-  // process.arch\n-  READONLY_STRING_PROPERTY(process, \"arch\", per_process::metadata.arch);\n-\n-  // process.platform\n-  READONLY_STRING_PROPERTY(process, \"platform\", per_process::metadata.platform);\n-\n-  // process.release\n-  Local<Object> release = Object::New(env->isolate());\n-  READONLY_PROPERTY(process, \"release\", release);\n-  READONLY_STRING_PROPERTY(release, \"name\", per_process::metadata.release.name);\n-#if NODE_VERSION_IS_LTS\n-  READONLY_STRING_PROPERTY(release, \"lts\", per_process::metadata.release.lts);\n-#endif  // NODE_VERSION_IS_LTS\n-\n-#ifdef NODE_HAS_RELEASE_URLS\n-  READONLY_STRING_PROPERTY(\n-      release, \"sourceUrl\", per_process::metadata.release.source_url);\n-  READONLY_STRING_PROPERTY(\n-      release, \"headersUrl\", per_process::metadata.release.headers_url);\n-#ifdef _WIN32\n-  READONLY_STRING_PROPERTY(\n-      release, \"libUrl\", per_process::metadata.release.lib_url);\n-#endif  // _WIN32\n-#endif  // NODE_HAS_RELEASE_URLS\n-\n-  // process.argv\n-  process->Set(env->context(),\n-               FIXED_ONE_BYTE_STRING(env->isolate(), \"argv\"),\n-               ToV8Value(env->context(), args).ToLocalChecked()).FromJust();\n-\n-  // process.execArgv\n-  process->Set(env->context(),\n-               FIXED_ONE_BYTE_STRING(env->isolate(), \"execArgv\"),\n-               ToV8Value(env->context(), exec_args)\n-                   .ToLocalChecked()).FromJust();\n-\n-  // create process.env\n-  process\n-      ->Set(env->context(),\n-            FIXED_ONE_BYTE_STRING(env->isolate(), \"env\"),\n-            CreateEnvVarProxy(context, isolate, env->as_external()))\n-      .FromJust();\n-\n-  READONLY_PROPERTY(process, \"pid\",\n-                    Integer::New(env->isolate(), uv_os_getpid()));\n-\n-  CHECK(process->SetAccessor(env->context(),\n-                             FIXED_ONE_BYTE_STRING(env->isolate(), \"ppid\"),\n-                             GetParentProcessId).FromJust());\n-\n-  // -e, --eval\n-  // TODO(addaleax): Remove this.\n-  if (env->options()->has_eval_string) {\n-    READONLY_PROPERTY(process,\n-                      \"_eval\",\n-                      String::NewFromUtf8(\n-                          env->isolate(),\n-                          env->options()->eval_string.c_str(),\n-                          NewStringType::kNormal).ToLocalChecked());\n-  }\n-\n-  // -p, --print\n-  // TODO(addaleax): Remove this.\n-  if (env->options()->print_eval) {\n-    READONLY_PROPERTY(process, \"_print_eval\", True(env->isolate()));\n-  }\n-\n-  // -c, --check\n-  // TODO(addaleax): Remove this.\n-  if (env->options()->syntax_check_only) {\n-    READONLY_PROPERTY(process, \"_syntax_check_only\", True(env->isolate()));\n-  }\n-\n-  // -i, --interactive\n-  // TODO(addaleax): Remove this.\n-  if (env->options()->force_repl) {\n-    READONLY_PROPERTY(process, \"_forceRepl\", True(env->isolate()));\n-  }\n-\n-  // -r, --require\n-  // TODO(addaleax): Remove this.\n-  const std::vector<std::string>& preload_modules =\n-      env->options()->preload_modules;\n-  if (!preload_modules.empty()) {\n-    READONLY_PROPERTY(process,\n-                      \"_preload_modules\",\n-                      ToV8Value(env->context(), preload_modules)\n-                          .ToLocalChecked());\n-  }\n-\n-  // --no-deprecation\n-  if (env->options()->no_deprecation) {\n-    READONLY_PROPERTY(process, \"noDeprecation\", True(env->isolate()));\n-  }\n-\n-  // --no-warnings\n-  if (env->options()->no_warnings) {\n-    READONLY_PROPERTY(process, \"noProcessWarnings\", True(env->isolate()));\n-  }\n-\n-  // --trace-warnings\n-  if (env->options()->trace_warnings) {\n-    READONLY_PROPERTY(process, \"traceProcessWarnings\", True(env->isolate()));\n-  }\n-\n-  // --throw-deprecation\n-  if (env->options()->throw_deprecation) {\n-    READONLY_PROPERTY(process, \"throwDeprecation\", True(env->isolate()));\n-  }\n-\n-#ifdef NODE_NO_BROWSER_GLOBALS\n-  // configure --no-browser-globals\n-  READONLY_PROPERTY(process, \"_noBrowserGlobals\", True(env->isolate()));\n-#endif  // NODE_NO_BROWSER_GLOBALS\n-\n-  // --prof-process\n-  // TODO(addaleax): Remove this.\n-  if (env->options()->prof_process) {\n-    READONLY_PROPERTY(process, \"profProcess\", True(env->isolate()));\n-  }\n-\n-  // --trace-deprecation\n-  if (env->options()->trace_deprecation) {\n-    READONLY_PROPERTY(process, \"traceDeprecation\", True(env->isolate()));\n-  }\n-\n-  // TODO(refack): move the following 4 to `node_config`\n-  // --inspect-brk\n-  if (env->options()->debug_options().wait_for_connect()) {\n-    READONLY_DONT_ENUM_PROPERTY(process,\n-                                \"_breakFirstLine\", True(env->isolate()));\n-  }\n-\n-  if (env->options()->debug_options().break_node_first_line) {\n-    READONLY_DONT_ENUM_PROPERTY(process,\n-                                \"_breakNodeFirstLine\", True(env->isolate()));\n-  }\n-\n-  // --inspect --debug-brk\n-  if (env->options()->debug_options().deprecated_invocation()) {\n-    READONLY_DONT_ENUM_PROPERTY(process,\n-                                \"_deprecatedDebugBrk\", True(env->isolate()));\n-  }\n-\n-  // --debug or, --debug-brk without --inspect\n-  if (env->options()->debug_options().invalid_invocation()) {\n-    READONLY_DONT_ENUM_PROPERTY(process,\n-                                \"_invalidDebug\", True(env->isolate()));\n-  }\n-\n-  // --security-revert flags\n-#define V(code, _, __)                                                        \\\n-  do {                                                                        \\\n-    if (IsReverted(SECURITY_REVERT_ ## code)) {                               \\\n-      READONLY_PROPERTY(process, \"REVERT_\" #code, True(env->isolate()));      \\\n-    }                                                                         \\\n-  } while (0);\n-  SECURITY_REVERSIONS(V)\n-#undef V\n-\n-  {\n-    size_t exec_path_len = 2 * PATH_MAX;\n-    std::vector<char> exec_path(exec_path_len);\n-    Local<String> exec_path_value;\n-    if (uv_exepath(exec_path.data(), &exec_path_len) == 0) {\n-      exec_path_value = String::NewFromUtf8(env->isolate(),\n-                                            exec_path.data(),\n-                                            NewStringType::kInternalized,\n-                                            exec_path_len).ToLocalChecked();\n-    } else {\n-      exec_path_value = String::NewFromUtf8(env->isolate(), args[0].c_str(),\n-          NewStringType::kInternalized).ToLocalChecked();\n-    }\n-    process->Set(env->context(),\n-                 FIXED_ONE_BYTE_STRING(env->isolate(), \"execPath\"),\n-                 exec_path_value).FromJust();\n-  }\n-\n-  auto debug_port_string = FIXED_ONE_BYTE_STRING(env->isolate(), \"debugPort\");\n-  CHECK(process->SetAccessor(env->context(),\n-                             debug_port_string,\n-                             DebugPortGetter,\n-                             env->is_main_thread() ? DebugPortSetter : nullptr,\n-                             env->as_external()).FromJust());\n-}\n-\n-\n void SignalExit(int signo) {\n   uv_tty_reset_mode();\n #ifdef __FreeBSD__"
        },
        {
            "sha": "a192c519a364562aca4abeda600321fb70672fee",
            "filename": "src/node_internals.h",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fnode_internals.h",
            "raw_url": "https://github.com/nodejs/node/raw/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fnode_internals.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_internals.h?ref=5a15f4bdfa060082757062dc5f39519d93e7b8fb",
            "patch": "@@ -185,9 +185,10 @@ v8::Maybe<bool> ProcessEmitDeprecationWarning(Environment* env,\n                                               const char* warning,\n                                               const char* deprecation_code);\n \n-void SetupProcessObject(Environment* env,\n-                        const std::vector<std::string>& args,\n-                        const std::vector<std::string>& exec_args);\n+v8::Local<v8::Object> CreateProcessObject(\n+    Environment* env,\n+    const std::vector<std::string>& args,\n+    const std::vector<std::string>& exec_args);\n \n enum Endianness {\n   kLittleEndian,  // _Not_ LITTLE_ENDIAN, clashes with endian.h."
        },
        {
            "sha": "69f08a219b67e6bfde1243aec31c224dbc169bbc",
            "filename": "src/node_process_methods.cc",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/nodejs/node/blob/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fnode_process_methods.cc",
            "raw_url": "https://github.com/nodejs/node/raw/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fnode_process_methods.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_process_methods.cc?ref=5a15f4bdfa060082757062dc5f39519d93e7b8fb",
            "previous_filename": "src/node_process.cc"
        },
        {
            "sha": "07f28653deeb386c2e0decf9f8b910c66700fec9",
            "filename": "src/node_process_object.cc",
            "status": "added",
            "additions": 258,
            "deletions": 0,
            "changes": 258,
            "blob_url": "https://github.com/nodejs/node/blob/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fnode_process_object.cc",
            "raw_url": "https://github.com/nodejs/node/raw/5a15f4bdfa060082757062dc5f39519d93e7b8fb/src%2Fnode_process_object.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_process_object.cc?ref=5a15f4bdfa060082757062dc5f39519d93e7b8fb",
            "patch": "@@ -0,0 +1,258 @@\n+#include <limits.h>  // PATH_MAX\n+\n+#include \"env-inl.h\"\n+#include \"node_internals.h\"\n+#include \"node_options-inl.h\"\n+#include \"node_metadata.h\"\n+#include \"node_revert.h\"\n+#include \"util-inl.h\"\n+\n+namespace node {\n+using v8::Context;\n+using v8::DEFAULT;\n+using v8::EscapableHandleScope;\n+using v8::Function;\n+using v8::FunctionTemplate;\n+using v8::HandleScope;\n+using v8::Integer;\n+using v8::Isolate;\n+using v8::Just;\n+using v8::Local;\n+using v8::NewStringType;\n+using v8::None;\n+using v8::Object;\n+using v8::SideEffectType;\n+using v8::String;\n+using v8::Value;\n+\n+Local<Object> CreateProcessObject(Environment* env,\n+                                  const std::vector<std::string>& args,\n+                                  const std::vector<std::string>& exec_args) {\n+  Isolate* isolate = env->isolate();\n+  EscapableHandleScope scope(isolate);\n+  Local<Context> context = env->context();\n+\n+  Local<FunctionTemplate> process_template = FunctionTemplate::New(isolate);\n+  process_template->SetClassName(FIXED_ONE_BYTE_STRING(isolate, \"process\"));\n+  Local<Object> process = process_template->GetFunction(context)\n+                              .ToLocalChecked()\n+                              ->NewInstance(context)\n+                              .ToLocalChecked();\n+\n+  auto title_string = FIXED_ONE_BYTE_STRING(env->isolate(), \"title\");\n+  CHECK(process->SetAccessor(\n+      env->context(),\n+      title_string,\n+      ProcessTitleGetter,\n+      env->is_main_thread() ? ProcessTitleSetter : nullptr,\n+      env->as_external(),\n+      DEFAULT,\n+      None,\n+      SideEffectType::kHasNoSideEffect).FromJust());\n+\n+  // process.version\n+  READONLY_PROPERTY(process,\n+                    \"version\",\n+                    FIXED_ONE_BYTE_STRING(env->isolate(), NODE_VERSION));\n+\n+  // process.versions\n+  Local<Object> versions = Object::New(env->isolate());\n+  READONLY_PROPERTY(process, \"versions\", versions);\n+\n+#define V(key)                                                                 \\\n+  if (!per_process::metadata.versions.key.empty()) {                           \\\n+    READONLY_STRING_PROPERTY(                                                  \\\n+        versions, #key, per_process::metadata.versions.key);                   \\\n+  }\n+  NODE_VERSIONS_KEYS(V)\n+#undef V\n+\n+  // process.arch\n+  READONLY_STRING_PROPERTY(process, \"arch\", per_process::metadata.arch);\n+\n+  // process.platform\n+  READONLY_STRING_PROPERTY(process, \"platform\", per_process::metadata.platform);\n+\n+  // process.release\n+  Local<Object> release = Object::New(env->isolate());\n+  READONLY_PROPERTY(process, \"release\", release);\n+  READONLY_STRING_PROPERTY(release, \"name\", per_process::metadata.release.name);\n+#if NODE_VERSION_IS_LTS\n+  READONLY_STRING_PROPERTY(release, \"lts\", per_process::metadata.release.lts);\n+#endif  // NODE_VERSION_IS_LTS\n+\n+#ifdef NODE_HAS_RELEASE_URLS\n+  READONLY_STRING_PROPERTY(\n+      release, \"sourceUrl\", per_process::metadata.release.source_url);\n+  READONLY_STRING_PROPERTY(\n+      release, \"headersUrl\", per_process::metadata.release.headers_url);\n+#ifdef _WIN32\n+  READONLY_STRING_PROPERTY(\n+      release, \"libUrl\", per_process::metadata.release.lib_url);\n+#endif  // _WIN32\n+#endif  // NODE_HAS_RELEASE_URLS\n+\n+  // process.argv\n+  process->Set(env->context(),\n+               FIXED_ONE_BYTE_STRING(env->isolate(), \"argv\"),\n+               ToV8Value(env->context(), args).ToLocalChecked()).FromJust();\n+\n+  // process.execArgv\n+  process->Set(env->context(),\n+               FIXED_ONE_BYTE_STRING(env->isolate(), \"execArgv\"),\n+               ToV8Value(env->context(), exec_args)\n+                   .ToLocalChecked()).FromJust();\n+\n+  // create process.env\n+  process\n+      ->Set(env->context(),\n+            FIXED_ONE_BYTE_STRING(env->isolate(), \"env\"),\n+            CreateEnvVarProxy(context, isolate, env->as_external()))\n+      .FromJust();\n+\n+  READONLY_PROPERTY(process, \"pid\",\n+                    Integer::New(env->isolate(), uv_os_getpid()));\n+\n+  CHECK(process->SetAccessor(env->context(),\n+                             FIXED_ONE_BYTE_STRING(env->isolate(), \"ppid\"),\n+                             GetParentProcessId).FromJust());\n+\n+  // -e, --eval\n+  // TODO(addaleax): Remove this.\n+  if (env->options()->has_eval_string) {\n+    READONLY_PROPERTY(process,\n+                      \"_eval\",\n+                      String::NewFromUtf8(\n+                          env->isolate(),\n+                          env->options()->eval_string.c_str(),\n+                          NewStringType::kNormal).ToLocalChecked());\n+  }\n+\n+  // -p, --print\n+  // TODO(addaleax): Remove this.\n+  if (env->options()->print_eval) {\n+    READONLY_PROPERTY(process, \"_print_eval\", True(env->isolate()));\n+  }\n+\n+  // -c, --check\n+  // TODO(addaleax): Remove this.\n+  if (env->options()->syntax_check_only) {\n+    READONLY_PROPERTY(process, \"_syntax_check_only\", True(env->isolate()));\n+  }\n+\n+  // -i, --interactive\n+  // TODO(addaleax): Remove this.\n+  if (env->options()->force_repl) {\n+    READONLY_PROPERTY(process, \"_forceRepl\", True(env->isolate()));\n+  }\n+\n+  // -r, --require\n+  // TODO(addaleax): Remove this.\n+  const std::vector<std::string>& preload_modules =\n+      env->options()->preload_modules;\n+  if (!preload_modules.empty()) {\n+    READONLY_PROPERTY(process,\n+                      \"_preload_modules\",\n+                      ToV8Value(env->context(), preload_modules)\n+                          .ToLocalChecked());\n+  }\n+\n+  // --no-deprecation\n+  if (env->options()->no_deprecation) {\n+    READONLY_PROPERTY(process, \"noDeprecation\", True(env->isolate()));\n+  }\n+\n+  // --no-warnings\n+  if (env->options()->no_warnings) {\n+    READONLY_PROPERTY(process, \"noProcessWarnings\", True(env->isolate()));\n+  }\n+\n+  // --trace-warnings\n+  if (env->options()->trace_warnings) {\n+    READONLY_PROPERTY(process, \"traceProcessWarnings\", True(env->isolate()));\n+  }\n+\n+  // --throw-deprecation\n+  if (env->options()->throw_deprecation) {\n+    READONLY_PROPERTY(process, \"throwDeprecation\", True(env->isolate()));\n+  }\n+\n+#ifdef NODE_NO_BROWSER_GLOBALS\n+  // configure --no-browser-globals\n+  READONLY_PROPERTY(process, \"_noBrowserGlobals\", True(env->isolate()));\n+#endif  // NODE_NO_BROWSER_GLOBALS\n+\n+  // --prof-process\n+  // TODO(addaleax): Remove this.\n+  if (env->options()->prof_process) {\n+    READONLY_PROPERTY(process, \"profProcess\", True(env->isolate()));\n+  }\n+\n+  // --trace-deprecation\n+  if (env->options()->trace_deprecation) {\n+    READONLY_PROPERTY(process, \"traceDeprecation\", True(env->isolate()));\n+  }\n+\n+  // TODO(refack): move the following 4 to `node_config`\n+  // --inspect-brk\n+  if (env->options()->debug_options().wait_for_connect()) {\n+    READONLY_DONT_ENUM_PROPERTY(process,\n+                                \"_breakFirstLine\", True(env->isolate()));\n+  }\n+\n+  if (env->options()->debug_options().break_node_first_line) {\n+    READONLY_DONT_ENUM_PROPERTY(process,\n+                                \"_breakNodeFirstLine\", True(env->isolate()));\n+  }\n+\n+  // --inspect --debug-brk\n+  if (env->options()->debug_options().deprecated_invocation()) {\n+    READONLY_DONT_ENUM_PROPERTY(process,\n+                                \"_deprecatedDebugBrk\", True(env->isolate()));\n+  }\n+\n+  // --debug or, --debug-brk without --inspect\n+  if (env->options()->debug_options().invalid_invocation()) {\n+    READONLY_DONT_ENUM_PROPERTY(process,\n+                                \"_invalidDebug\", True(env->isolate()));\n+  }\n+\n+  // --security-revert flags\n+#define V(code, _, __)                                                        \\\n+  do {                                                                        \\\n+    if (IsReverted(SECURITY_REVERT_ ## code)) {                               \\\n+      READONLY_PROPERTY(process, \"REVERT_\" #code, True(env->isolate()));      \\\n+    }                                                                         \\\n+  } while (0);\n+  SECURITY_REVERSIONS(V)\n+#undef V\n+\n+  {\n+    size_t exec_path_len = 2 * PATH_MAX;\n+    std::vector<char> exec_path(exec_path_len);\n+    Local<String> exec_path_value;\n+    if (uv_exepath(exec_path.data(), &exec_path_len) == 0) {\n+      exec_path_value = String::NewFromUtf8(env->isolate(),\n+                                            exec_path.data(),\n+                                            NewStringType::kInternalized,\n+                                            exec_path_len).ToLocalChecked();\n+    } else {\n+      exec_path_value = String::NewFromUtf8(env->isolate(), args[0].c_str(),\n+          NewStringType::kInternalized).ToLocalChecked();\n+    }\n+    process->Set(env->context(),\n+                 FIXED_ONE_BYTE_STRING(env->isolate(), \"execPath\"),\n+                 exec_path_value).FromJust();\n+  }\n+\n+  auto debug_port_string = FIXED_ONE_BYTE_STRING(env->isolate(), \"debugPort\");\n+  CHECK(process->SetAccessor(env->context(),\n+                             debug_port_string,\n+                             DebugPortGetter,\n+                             env->is_main_thread() ? DebugPortSetter : nullptr,\n+                             env->as_external()).FromJust());\n+\n+  return scope.Escape(process);\n+}\n+\n+}  // namespace node"
        }
    ],
    "stats": {
        "total": 505,
        "additions": 265,
        "deletions": 240
    }
}