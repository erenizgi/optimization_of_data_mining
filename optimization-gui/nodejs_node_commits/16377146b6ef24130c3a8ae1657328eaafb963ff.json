{
    "author": "unknown",
    "message": "test: fix tests that fail under coverage\n\nMake test runner capable of skipping tests, which makes it possible\nto skip the failing test/message/core_line_numbers.js test.\n\nMake nyc no longer generate compact instrumentation (this causes\nsignificantly different code output, which leads to failing test\nassertions).\n\nPR-URL: https://github.com/nodejs/node/pull/20794\nReviewed-By: Rich Trott <rtrott@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Khaidi Chu <i@2333.moe>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>",
    "sha": "16377146b6ef24130c3a8ae1657328eaafb963ff",
    "files": [
        {
            "sha": "c826fbc02d5dd0c827527596da480afb52512786",
            "filename": ".nycrc",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/16377146b6ef24130c3a8ae1657328eaafb963ff/.nycrc",
            "raw_url": "https://github.com/nodejs/node/raw/16377146b6ef24130c3a8ae1657328eaafb963ff/.nycrc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/.nycrc?ref=16377146b6ef24130c3a8ae1657328eaafb963ff",
            "patch": "@@ -2,5 +2,6 @@\n   \"exclude\": [\n     \"**/internal/process/write-coverage.js\"\n   ],\n+  \"compact\": false,\n   \"reporter\": [\"html\", \"text\"]\n }"
        },
        {
            "sha": "a7099947c72a783a4b9d96c950ac084153532d94",
            "filename": "Makefile",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/16377146b6ef24130c3a8ae1657328eaafb963ff/Makefile",
            "raw_url": "https://github.com/nodejs/node/raw/16377146b6ef24130c3a8ae1657328eaafb963ff/Makefile",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/Makefile?ref=16377146b6ef24130c3a8ae1657328eaafb963ff",
            "patch": "@@ -233,6 +233,7 @@ v8:\n .PHONY: jstest\n jstest: build-addons build-addons-napi ## Runs addon tests and JS tests\n \t$(PYTHON) tools/test.py $(PARALLEL_ARGS) --mode=$(BUILDTYPE_LOWER) \\\n+\t\t--skip-tests=$(CI_SKIP_TESTS) \\\n \t\t$(CI_JS_SUITES) \\\n \t\t$(CI_NATIVE_SUITES)\n \n@@ -263,8 +264,7 @@ test-cov: all\n \t$(MAKE) build-addons\n \t$(MAKE) build-addons-napi\n \t# $(MAKE) cctest\n-\t$(MAKE) jstest\n-\t$(MAKE) lint\n+\tCI_SKIP_TESTS=core_line_numbers.js $(MAKE) jstest\n \n test-parallel: all\n \t$(PYTHON) tools/test.py $(PARALLEL_ARGS) --mode=$(BUILDTYPE_LOWER) parallel"
        },
        {
            "sha": "e5581e8da41c4421682d4765ffb9c2ac5ea75bb6",
            "filename": "tools/test.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/16377146b6ef24130c3a8ae1657328eaafb963ff/tools%2Ftest.py",
            "raw_url": "https://github.com/nodejs/node/raw/16377146b6ef24130c3a8ae1657328eaafb963ff/tools%2Ftest.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Ftest.py?ref=16377146b6ef24130c3a8ae1657328eaafb963ff",
            "patch": "@@ -1382,6 +1382,9 @@ def BuildOptions():\n   result.add_option(\"--flaky-tests\",\n       help=\"Regard tests marked as flaky (run|skip|dontcare)\",\n       default=\"run\")\n+  result.add_option(\"--skip-tests\",\n+      help=\"Tests that should not be executed (comma-separated)\",\n+      default=\"\")\n   result.add_option(\"--warn-unused\", help=\"Report unused rules\",\n       default=False, action=\"store_true\")\n   result.add_option(\"-j\", help=\"The number of parallel tasks to run\",\n@@ -1424,6 +1427,7 @@ def ProcessOptions(options):\n   options.arch = options.arch.split(',')\n   options.mode = options.mode.split(',')\n   options.run = options.run.split(',')\n+  options.skip_tests = options.skip_tests.split(',')\n   if options.run == [\"\"]:\n     options.run = None\n   elif len(options.run) != 2:\n@@ -1710,6 +1714,11 @@ def Main():\n \n   result = None\n   def DoSkip(case):\n+    # A list of tests that should be skipped can be provided. This is\n+    # useful for tests that fail in some environments, e.g., under coverage.\n+    if options.skip_tests != [\"\"]:\n+        if [ st for st in options.skip_tests if st in case.case.file ]:\n+            return True\n     if SKIP in case.outcomes or SLOW in case.outcomes:\n       return True\n     return FLAKY in case.outcomes and options.flaky_tests == SKIP"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
    }
}