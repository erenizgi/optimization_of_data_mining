{
    "author": "timotew",
    "message": "vm: consolidate validation\n\nPR-URL: https://github.com/nodejs/node/pull/18816\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "3cb3618973bcf7817b55eb4fd96cc5fe7284cbd9",
    "files": [
        {
            "sha": "78a2de16d38603cfb23c5eae03ef600821d9ea43",
            "filename": "lib/vm.js",
            "status": "modified",
            "additions": 16,
            "deletions": 18,
            "changes": 34,
            "blob_url": "https://github.com/nodejs/node/blob/3cb3618973bcf7817b55eb4fd96cc5fe7284cbd9/lib%2Fvm.js",
            "raw_url": "https://github.com/nodejs/node/raw/3cb3618973bcf7817b55eb4fd96cc5fe7284cbd9/lib%2Fvm.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fvm.js?ref=3cb3618973bcf7817b55eb4fd96cc5fe7284cbd9",
            "patch": "@@ -79,22 +79,23 @@ Script.prototype.runInNewContext = function(sandbox, options) {\n   return this.runInContext(context, options);\n };\n \n+function validateString(prop, propName) {\n+  if (prop !== undefined && typeof prop !== 'string')\n+    throw new errors.TypeError('ERR_INVALID_ARG_TYPE', propName,\n+                               'string', prop);\n+}\n+\n function getContextOptions(options) {\n-  const contextOptions = options ? {\n-    name: options.contextName,\n-    origin: options.contextOrigin\n-  } : {};\n-  if (contextOptions.name !== undefined &&\n-      typeof contextOptions.name !== 'string') {\n-    throw new errors.TypeError('ERR_INVALID_ARG_TYPE', 'options.contextName',\n-                               'string', contextOptions.name);\n-  }\n-  if (contextOptions.origin !== undefined &&\n-      typeof contextOptions.origin !== 'string') {\n-    throw new errors.TypeError('ERR_INVALID_ARG_TYPE', 'options.contextOrigin',\n-                               'string', contextOptions.origin);\n+  if (options) {\n+    const contextOptions = {\n+      name: options.contextName,\n+      origin: options.contextOrigin\n+    };\n+    validateString(contextOptions.name, 'options.contextName');\n+    validateString(contextOptions.origin, 'options.contextOrigin');\n+    return contextOptions;\n   }\n-  return contextOptions;\n+  return {};\n }\n \n let defaultContextNameIndex = 1;\n@@ -120,10 +121,7 @@ function createContext(sandbox, options) {\n       throw new errors.TypeError('ERR_INVALID_ARG_TYPE', 'options.name',\n                                  'string', options.name);\n     }\n-    if (options.origin !== undefined && typeof options.origin !== 'string') {\n-      throw new errors.TypeError('ERR_INVALID_ARG_TYPE', 'options.origin',\n-                                 'string', options.origin);\n-    }\n+    validateString(options.origin, 'options.origin');\n   } else {\n     options = {\n       name: `VM Context ${defaultContextNameIndex++}`"
        }
    ],
    "stats": {
        "total": 34,
        "additions": 16,
        "deletions": 18
    }
}