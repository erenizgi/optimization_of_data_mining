{
    "author": "jasnell",
    "message": "test: add test-http2-large-file sequential test\n\nRefs: https://github.com/nodejs/node/issues/19141\n\nPR-URL: https://github.com/nodejs/node/pull/22254\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: George Adams <george.adams@uk.ibm.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "c29aff3ac7071a2d66206a3767fd946691c36c7f",
    "files": [
        {
            "sha": "d1a44e8d6be53c369d6ce69bd3f75df03f5262ae",
            "filename": "test/sequential/test-http2-large-file.js",
            "status": "added",
            "additions": 39,
            "deletions": 0,
            "changes": 39,
            "blob_url": "https://github.com/nodejs/node/blob/c29aff3ac7071a2d66206a3767fd946691c36c7f/test%2Fsequential%2Ftest-http2-large-file.js",
            "raw_url": "https://github.com/nodejs/node/raw/c29aff3ac7071a2d66206a3767fd946691c36c7f/test%2Fsequential%2Ftest-http2-large-file.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-http2-large-file.js?ref=c29aff3ac7071a2d66206a3767fd946691c36c7f",
            "patch": "@@ -0,0 +1,39 @@\n+'use strict';\n+\n+// Test to ensure sending a large stream with a large initial window size works\n+// See: https://github.com/nodejs/node/issues/19141\n+\n+const common = require('../common');\n+if (!common.hasCrypto)\n+  common.skip('missing crypto');\n+\n+const http2 = require('http2');\n+\n+const server = http2.createServer({ settings: { initialWindowSize: 6553500 } });\n+server.on('stream', (stream) => {\n+  stream.resume();\n+  stream.respond();\n+  stream.end('ok');\n+});\n+\n+server.listen(0, common.mustCall(() => {\n+  let remaining = 1e8;\n+  const chunk = 1e6;\n+  const client = http2.connect(`http://localhost:${server.address().port}`,\n+                               { settings: { initialWindowSize: 6553500 } });\n+  const request = client.request({ ':method': 'POST' });\n+  function writeChunk() {\n+    if (remaining > 0) {\n+      remaining -= chunk;\n+      request.write(Buffer.alloc(chunk, 'a'), writeChunk);\n+    } else {\n+      request.end();\n+    }\n+  }\n+  writeChunk();\n+  request.on('close', common.mustCall(() => {\n+    client.close();\n+    server.close();\n+  }));\n+  request.resume();\n+}));"
        }
    ],
    "stats": {
        "total": 39,
        "additions": 39,
        "deletions": 0
    }
}