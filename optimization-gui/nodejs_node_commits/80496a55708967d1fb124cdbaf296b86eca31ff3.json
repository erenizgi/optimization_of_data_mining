{
    "author": "not-an-aardvark",
    "message": "util: add inspect suffix to BigInt64Array elements\n\nThis commit updates `util.inspect` to add an `n` suffix to BigInts that\nappear in BigInt64Arrays. BigInts are formatted with an `n` suffix in\nmost cases, but this did not occur in BigInt64Arrays due to an apparent\noversight where the implementation of `inspect` for typed arrays assumed\nthat all typed array elements are numbers.\n\nPR-URL: https://github.com/nodejs/node/pull/21499\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Yuta Hiroto <hello@hiroppy.me>",
    "sha": "80496a55708967d1fb124cdbaf296b86eca31ff3",
    "files": [
        {
            "sha": "afd3cae724a6a76922fb9670b51270906341cc02",
            "filename": "lib/util.js",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/80496a55708967d1fb124cdbaf296b86eca31ff3/lib%2Futil.js",
            "raw_url": "https://github.com/nodejs/node/raw/80496a55708967d1fb124cdbaf296b86eca31ff3/lib%2Futil.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Futil.js?ref=80496a55708967d1fb124cdbaf296b86eca31ff3",
            "patch": "@@ -739,6 +739,10 @@ function formatNumber(fn, value) {\n   return fn(`${value}`, 'number');\n }\n \n+function formatBigInt(fn, value) {\n+  return fn(`${value}n`, 'bigint');\n+}\n+\n function formatPrimitive(fn, value, ctx) {\n   if (typeof value === 'string') {\n     if (ctx.compact === false &&\n@@ -779,7 +783,7 @@ function formatPrimitive(fn, value, ctx) {\n     return formatNumber(fn, value);\n   // eslint-disable-next-line valid-typeof\n   if (typeof value === 'bigint')\n-    return fn(`${value}n`, 'bigint');\n+    return formatBigInt(fn, value);\n   if (typeof value === 'boolean')\n     return fn(`${value}`, 'boolean');\n   if (typeof value === 'undefined')\n@@ -915,8 +919,11 @@ function formatTypedArray(ctx, value, recurseTimes, keys) {\n   const maxLength = Math.min(Math.max(0, ctx.maxArrayLength), value.length);\n   const remaining = value.length - maxLength;\n   const output = new Array(maxLength + (remaining > 0 ? 1 : 0));\n+  const elementFormatter = value.length > 0 && typeof value[0] === 'number' ?\n+    formatNumber :\n+    formatBigInt;\n   for (var i = 0; i < maxLength; ++i)\n-    output[i] = formatNumber(ctx.stylize, value[i]);\n+    output[i] = elementFormatter(ctx.stylize, value[i]);\n   if (remaining > 0)\n     output[i] = `... ${remaining} more item${remaining > 1 ? 's' : ''}`;\n   if (ctx.showHidden) {"
        },
        {
            "sha": "92ddd6669007f430b92f6420412e0c52f47bac04",
            "filename": "test/parallel/test-util-inspect-bigint.js",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/80496a55708967d1fb124cdbaf296b86eca31ff3/test%2Fparallel%2Ftest-util-inspect-bigint.js",
            "raw_url": "https://github.com/nodejs/node/raw/80496a55708967d1fb124cdbaf296b86eca31ff3/test%2Fparallel%2Ftest-util-inspect-bigint.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-util-inspect-bigint.js?ref=80496a55708967d1fb124cdbaf296b86eca31ff3",
            "patch": "@@ -10,3 +10,5 @@ const { inspect } = require('util');\n assert.strictEqual(inspect(1n), '1n');\n assert.strictEqual(inspect(Object(-1n)), '[BigInt: -1n]');\n assert.strictEqual(inspect(Object(13n)), '[BigInt: 13n]');\n+assert.strictEqual(inspect(new BigInt64Array([0n])), 'BigInt64Array [ 0n ]');\n+assert.strictEqual(inspect(new BigUint64Array([0n])), 'BigUint64Array [ 0n ]');"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 11,
        "deletions": 2
    }
}