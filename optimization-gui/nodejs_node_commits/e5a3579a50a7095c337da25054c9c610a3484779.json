{
    "author": "unknown",
    "message": "test: increase coverage for fs.promises.truncate\n\nTo increase test coverage, added tests for fs.promises.truncate\nand FileHandle.truncate.\n\nPR-URL: https://github.com/nodejs/node/pull/20638\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "e5a3579a50a7095c337da25054c9c610a3484779",
    "files": [
        {
            "sha": "44d919a042e276fdbde3d53f00a961db37f57ef1",
            "filename": "test/parallel/test-fs-promises-file-handle-truncate.js",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/nodejs/node/blob/e5a3579a50a7095c337da25054c9c610a3484779/test%2Fparallel%2Ftest-fs-promises-file-handle-truncate.js",
            "raw_url": "https://github.com/nodejs/node/raw/e5a3579a50a7095c337da25054c9c610a3484779/test%2Fparallel%2Ftest-fs-promises-file-handle-truncate.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-promises-file-handle-truncate.js?ref=e5a3579a50a7095c337da25054c9c610a3484779",
            "patch": "@@ -0,0 +1,26 @@\n+'use strict';\n+\n+const common = require('../common');\n+const assert = require('assert');\n+const path = require('path');\n+const { open, readFile } = require('fs').promises;\n+const tmpdir = require('../common/tmpdir');\n+\n+tmpdir.refresh();\n+common.crashOnUnhandledRejection();\n+\n+async function validateTruncate() {\n+  const text = 'Hello world';\n+  const filename = path.resolve(tmpdir.path, 'truncate-file.txt');\n+  const fileHandle = await open(filename, 'w+');\n+\n+  const buffer = Buffer.from(text, 'utf8');\n+  await fileHandle.write(buffer, 0, buffer.length);\n+\n+  assert.deepStrictEqual((await readFile(filename)).toString(), text);\n+\n+  await fileHandle.truncate(5);\n+  assert.deepStrictEqual((await readFile(filename)).toString(), 'Hello');\n+}\n+\n+validateTruncate().then(common.mustCall());"
        },
        {
            "sha": "32439ce0c48cac9d74bd03e84423e62815c7923f",
            "filename": "test/parallel/test-fs-promises.js",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/e5a3579a50a7095c337da25054c9c610a3484779/test%2Fparallel%2Ftest-fs-promises.js",
            "raw_url": "https://github.com/nodejs/node/raw/e5a3579a50a7095c337da25054c9c610a3484779/test%2Fparallel%2Ftest-fs-promises.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-promises.js?ref=e5a3579a50a7095c337da25054c9c610a3484779",
            "patch": "@@ -17,13 +17,15 @@ const {\n   mkdir,\n   mkdtemp,\n   open,\n+  readFile,\n   readdir,\n   readlink,\n   realpath,\n   rename,\n   rmdir,\n   stat,\n   symlink,\n+  truncate,\n   unlink,\n   utimes\n } = fsPromises;\n@@ -99,6 +101,8 @@ function verifyStatObject(stat) {\n     const ret2 = await handle.read(Buffer.alloc(buf2Len), 0, buf2Len, 0);\n     assert.strictEqual(ret2.bytesRead, buf2Len);\n     assert.deepStrictEqual(ret2.buffer, buf2);\n+    await truncate(dest, 5);\n+    assert.deepStrictEqual((await readFile(dest)).toString(), 'hello');\n \n     await chmod(dest, 0o666);\n     await handle.chmod(0o666);"
        }
    ],
    "stats": {
        "total": 30,
        "additions": 30,
        "deletions": 0
    }
}