{
    "author": "indranil",
    "message": "doc: add flags section to document all flags\n\nAdds a section at the very end to document all flags and links\nto it from every function that takes a flag argument.\n\nFixes: https://github.com/nodejs/node/issues/16971\n\nPR-URL: https://github.com/nodejs/node/pull/20042\nReviewed-By: Vse Mozhet Byt <vsemozhetbyt@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "53822f605d3171530ab820d71e8832f473479c27",
    "files": [
        {
            "sha": "a80a5efcb42f87583f1acd90d79fe6a01e963d3a",
            "filename": "doc/api/fs.md",
            "status": "modified",
            "additions": 109,
            "deletions": 164,
            "changes": 273,
            "blob_url": "https://github.com/nodejs/node/blob/53822f605d3171530ab820d71e8832f473479c27/doc%2Fapi%2Ffs.md",
            "raw_url": "https://github.com/nodejs/node/raw/53822f605d3171530ab820d71e8832f473479c27/doc%2Fapi%2Ffs.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Ffs.md?ref=53822f605d3171530ab820d71e8832f473479c27",
            "patch": "@@ -917,7 +917,7 @@ changes:\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `'utf8'`\n   * `mode` {integer} **Default:** `0o666`\n-  * `flag` {string} **Default:** `'a'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'a'`.\n * `callback` {Function}\n   * `err` {Error}\n \n@@ -972,7 +972,7 @@ changes:\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `'utf8'`\n   * `mode` {integer} **Default:** `0o666`\n-  * `flag` {string} **Default:** `'a'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'a'`.\n \n Synchronously append data to a file, creating the file if it does not yet\n exist. `data` can be a string or a [`Buffer`][].\n@@ -1305,7 +1305,8 @@ changes:\n \n * `path` {string|Buffer|URL}\n * `options` {string|Object}\n-  * `flags` {string} **Default:** `'r'`\n+  * `flags` {string} See [support of file system `flags`][]. **Default:**\n+  `'r'`.\n   * `encoding` {string} **Default:** `null`\n   * `fd` {integer} **Default:** `null`\n   * `mode` {integer} **Default:** `0o666`\n@@ -1368,7 +1369,8 @@ changes:\n \n * `path` {string|Buffer|URL}\n * `options` {string|Object}\n-  * `flags` {string} **Default:** `'w'`\n+  * `flags` {string} See [support of file system `flags`][]. **Default:**\n+  `'w'`.\n   * `encoding` {string} **Default:** `'utf8'`\n   * `fd` {integer} **Default:** `null`\n   * `mode` {integer} **Default:** `0o666`\n@@ -2110,92 +2112,19 @@ changes:\n -->\n \n * `path` {string|Buffer|URL}\n-* `flags` {string|number}\n+* `flags` {string|number} See [support of file system `flags`][].\n * `mode` {integer} **Default:** `0o666` (readable and writable)\n * `callback` {Function}\n   * `err` {Error}\n   * `fd` {integer}\n \n-Asynchronous file open. See open(2). `flags` can be:\n-\n-* `'r'` - Open file for reading.\n-An exception occurs if the file does not exist.\n-\n-* `'r+'` - Open file for reading and writing.\n-An exception occurs if the file does not exist.\n-\n-* `'rs+'` - Open file for reading and writing in synchronous mode. Instructs\n-  the operating system to bypass the local file system cache.\n-\n-  This is primarily useful for opening files on NFS mounts as it allows skipping\n-  the potentially stale local cache. It has a very real impact on I/O\n-  performance so using this flag is not recommended unless it is needed.\n-\n-  Note that this doesn't turn `fs.open()` into a synchronous blocking call.\n-  If synchronous operation is desired `fs.openSync()` should be used.\n-\n-* `'w'` - Open file for writing.\n-The file is created (if it does not exist) or truncated (if it exists).\n-\n-* `'wx'` - Like `'w'` but fails if `path` exists.\n-\n-* `'w+'` - Open file for reading and writing.\n-The file is created (if it does not exist) or truncated (if it exists).\n-\n-* `'wx+'` - Like `'w+'` but fails if `path` exists.\n-\n-* `'a'` - Open file for appending.\n-The file is created if it does not exist.\n-\n-* `'ax'` - Like `'a'` but fails if `path` exists.\n-\n-* `'as'` - Open file for appending in synchronous mode.\n-The file is created if it does not exist.\n-\n-* `'a+'` - Open file for reading and appending.\n-The file is created if it does not exist.\n-\n-* `'ax+'` - Like `'a+'` but fails if `path` exists.\n-\n-* `'as+'` - Open file for reading and appending in synchronous mode.\n-The file is created if it does not exist.\n+Asynchronous file open. See open(2).\n \n `mode` sets the file mode (permission and sticky bits), but only if the file was\n created.\n \n The callback gets two arguments `(err, fd)`.\n \n-The exclusive flag `'x'` (`O_EXCL` flag in open(2)) ensures that `path` is newly\n-created. On POSIX systems, `path` is considered to exist even if it is a symlink\n-to a non-existent file. The exclusive flag may or may not work with network file\n-systems.\n-\n-`flags` can also be a number as documented by open(2); commonly used constants\n-are available from `fs.constants`. On Windows, flags are translated to\n-their equivalent ones where applicable, e.g. `O_WRONLY` to `FILE_GENERIC_WRITE`,\n-or `O_EXCL|O_CREAT` to `CREATE_NEW`, as accepted by CreateFileW.\n-\n-On Linux, positional writes don't work when the file is opened in append mode.\n-The kernel ignores the position argument and always appends the data to\n-the end of the file.\n-\n-The behavior of `fs.open()` is platform-specific for some flags. As such,\n-opening a directory on macOS and Linux with the `'a+'` flag - see example\n-below - will return an error. In contrast, on Windows and FreeBSD, a file\n-descriptor will be returned.\n-\n-```js\n-// macOS and Linux\n-fs.open('<directory>', 'a+', (err, fd) => {\n-  // => [Error: EISDIR: illegal operation on a directory, open <directory>]\n-});\n-\n-// Windows and FreeBSD\n-fs.open('<directory>', 'a+', (err, fd) => {\n-  // => null, <fd>\n-});\n-```\n-\n Some characters (`< > : \" / \\ | ? *`) are reserved under Windows as documented\n by [Naming Files, Paths, and Namespaces][]. Under NTFS, if the filename contains\n a colon, Node.js will open a file system stream, as described by\n@@ -2204,11 +2133,6 @@ a colon, Node.js will open a file system stream, as described by\n Functions based on `fs.open()` exhibit this behavior as well. eg.\n `fs.writeFile()`, `fs.readFile()`, etc.\n \n-*Note:* On Windows, opening an existing hidden file using the `w` flag (either\n-through `fs.open()` or `fs.writeFile()`) will fail with `EPERM`. Existing hidden\n-files can be opened for writing with the `r+` flag. A call to `fs.ftruncate()`\n-can be used to reset the file contents.\n-\n ## fs.openSync(path, flags[, mode])\n <!-- YAML\n added: v0.1.21\n@@ -2220,7 +2144,7 @@ changes:\n -->\n \n * `path` {string|Buffer|URL}\n-* `flags` {string|number}\n+* `flags` {string|number} See [support of file system `flags`][].\n * `mode` {integer} **Default:** `0o666`\n * Returns: {number}\n \n@@ -2354,7 +2278,7 @@ changes:\n * `path` {string|Buffer|URL|integer} filename or file descriptor\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `null`\n-  * `flag` {string} **Default:** `'r'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'r'`.\n * `callback` {Function}\n   * `err` {Error}\n   * `data` {string|Buffer}\n@@ -2420,7 +2344,7 @@ changes:\n * `path` {string|Buffer|URL|integer} filename or file descriptor\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `null`\n-  * `flag` {string} **Default:** `'r'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'r'`.\n * Returns: {string|Buffer}\n \n Synchronous version of [`fs.readFile()`][]. Returns the contents of the `path`.\n@@ -3347,7 +3271,7 @@ changes:\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `'utf8'`\n   * `mode` {integer} **Default:** `0o666`\n-  * `flag` {string} **Default:** `'w'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'w'`.\n * `callback` {Function}\n   * `err` {Error}\n \n@@ -3397,7 +3321,7 @@ changes:\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `'utf8'`\n   * `mode` {integer} **Default:** `0o666`\n-  * `flag` {string} **Default:** `'w'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'w'`.\n \n The synchronous version of [`fs.writeFile()`][]. Returns `undefined`.\n \n@@ -3473,7 +3397,7 @@ added: REPLACEME\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `'utf8'`\n   * `mode` {integer} **Default:** `0o666`\n-  * `flag` {string} **Default:** `'a'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'a'`.\n * Returns: {Promise}\n \n Asynchronously append data to this file, creating the file if it does not yet\n@@ -3577,7 +3501,7 @@ added: REPLACEME\n -->\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `null`\n-  * `flag` {string} **Default:** `'r'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'r'`.\n * Returns: {Promise}\n \n Asynchronously reads the entire contents of a file.\n@@ -3711,7 +3635,7 @@ added: REPLACEME\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `'utf8'`\n   * `mode` {integer} **Default:** `0o666`\n-  * `flag` {string} **Default:** `'w'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'w'`.\n * Returns: {Promise}\n \n Asynchronously writes data to a file, replacing the file if it already exists.\n@@ -3777,7 +3701,7 @@ added: REPLACEME\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `'utf8'`\n   * `mode` {integer} **Default:** `0o666`\n-  * `flag` {string} **Default:** `'a'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'a'`.\n * Returns: {Promise}\n \n Asynchronously append data to a file, creating the file if it does not yet\n@@ -4086,89 +4010,21 @@ added: REPLACEME\n -->\n \n * `path` {string|Buffer|URL}\n-* `flags` {string|number}\n+* `flags` {string|number} See [support of file system `flags`][].\n * `mode` {integer} **Default:** `0o666` (readable and writable)\n * Returns: {Promise}\n \n Asynchronous file open that returns a `Promise` that, when resolved, yields a\n `FileHandle` object. See open(2).\n \n-The `flags` argument can be:\n-\n-* `'r'` - Open file for reading.\n-An exception occurs if the file does not exist.\n-\n-* `'r+'` - Open file for reading and writing.\n-An exception occurs if the file does not exist.\n-\n-* `'rs+'` - Open file for reading and writing in synchronous mode. Instructs\n-  the operating system to bypass the local file system cache.\n-\n-  This is primarily useful for opening files on NFS mounts as it allows skipping\n-  the potentially stale local cache. It has a very real impact on I/O\n-  performance so using this flag is not recommended unless it is needed.\n-\n-  Note that this does not turn `fsPromises.open()` into a synchronous blocking\n-  call.\n-\n-* `'w'` - Open file for writing.\n-The file is created (if it does not exist) or truncated (if it exists).\n-\n-* `'wx'` - Like `'w'` but fails if `path` exists.\n-\n-* `'w+'` - Open file for reading and writing.\n-The file is created (if it does not exist) or truncated (if it exists).\n-\n-* `'wx+'` - Like `'w+'` but fails if `path` exists.\n-\n-* `'a'` - Open file for appending.\n-The file is created if it does not exist.\n-\n-* `'ax'` - Like `'a'` but fails if `path` exists.\n-\n-* `'as'` - Open file for appending in synchronous mode.\n-The file is created if it does not exist.\n-\n-* `'a+'` - Open file for reading and appending.\n-The file is created if it does not exist.\n-\n-* `'ax+'` - Like `'a+'` but fails if `path` exists.\n-\n-* `'as+'` - Open file for reading and appending in synchronous mode.\n-The file is created if it does not exist.\n-\n `mode` sets the file mode (permission and sticky bits), but only if the file was\n created.\n \n-The exclusive flag `'x'` (`O_EXCL` flag in open(2)) ensures that `path` is newly\n-created. On POSIX systems, `path` is considered to exist even if it is a symlink\n-to a non-existent file. The exclusive flag may or may not work with network file\n-systems.\n-\n-`flags` can also be a number as documented by open(2); commonly used constants\n-are available from `fs.constants`. On Windows, flags are translated to\n-their equivalent ones where applicable, e.g. `O_WRONLY` to `FILE_GENERIC_WRITE`,\n-or `O_EXCL|O_CREAT` to `CREATE_NEW`, as accepted by CreateFileW.\n-\n-On Linux, positional writes don't work when the file is opened in append mode.\n-The kernel ignores the position argument and always appends the data to\n-the end of the file.\n-\n-The behavior of `fsPromises.open()` is platform-specific for some\n-flags. As such, opening a directory on macOS and Linux with the `'a+'` flag will\n-return an error. In contrast, on Windows and FreeBSD, a `FileHandle` will be\n-returned.\n-\n Some characters (`< > : \" / \\ | ? *`) are reserved under Windows as documented\n by [Naming Files, Paths, and Namespaces][]. Under NTFS, if the filename contains\n a colon, Node.js will open a file system stream, as described by\n [this MSDN page][MSDN-Using-Streams].\n \n-*Note:* On Windows, opening an existing hidden file using the `w` flag (e.g.\n-using `fsPromises.open()`) will fail with `EPERM`. Existing hidden\n-files can be opened for writing with the `r+` flag. A call to\n-`fsPromises.ftruncate()` can be used to reset the file contents.\n-\n ### fsPromises.read(filehandle, buffer, offset, length, position)\n <!-- YAML\n added: REPLACEME\n@@ -4224,7 +4080,7 @@ added: REPLACEME\n * `path` {string|Buffer|URL|FileHandle} filename or `FileHandle`\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `null`\n-  * `flag` {string} **Default:** `'r'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'r'`.\n * Returns: {Promise}\n \n Asynchronously reads the entire contents of a file.\n@@ -4425,7 +4281,7 @@ added: REPLACEME\n * `options` {Object|string}\n   * `encoding` {string|null} **Default:** `'utf8'`\n   * `mode` {integer} **Default:** `0o666`\n-  * `flag` {string} **Default:** `'w'`\n+  * `flag` {string} See [support of file system `flags`][]. **Default:** `'w'`.\n * Returns: {Promise}\n \n Asynchronously writes data to a file, replacing the file if it already exists.\n@@ -4697,6 +4553,94 @@ The following constants are meant for use with the [`fs.Stats`][] object's\n   </tr>\n </table>\n \n+## File System Flags\n+\n+The following flags are available wherever the `flag` option takes a\n+string:\n+\n+* `'a'` - Open file for appending.\n+  The file is created if it does not exist.\n+\n+* `'ax'` - Like `'a'` but fails if the path exists.\n+\n+* `'a+'` - Open file for reading and appending.\n+  The file is created if it does not exist.\n+\n+* `'ax+'` - Like `'a+'` but fails if the path exists.\n+\n+* `'as'` - Open file for appending in synchronous mode.\n+  The file is created if it does not exist.\n+\n+* `'as+'` - Open file for reading and appending in synchronous mode.\n+  The file is created if it does not exist.\n+\n+* `'r'` - Open file for reading.\n+  An exception occurs if the file does not exist.\n+\n+* `'r+'` - Open file for reading and writing.\n+  An exception occurs if the file does not exist.\n+\n+* `'rs+'` - Open file for reading and writing in synchronous mode. Instructs\n+  the operating system to bypass the local file system cache.\n+\n+  This is primarily useful for opening files on NFS mounts as it allows\n+  skipping the potentially stale local cache. It has a very real impact on\n+  I/O performance so using this flag is not recommended unless it is needed.\n+\n+  Note that this doesn't turn `fs.open()` or `fsPromises.open()` into a\n+  synchronous blocking call. If synchronous operation is desired, something\n+  like `fs.openSync()` should be used.\n+\n+* `'w'` - Open file for writing.\n+  The file is created (if it does not exist) or truncated (if it exists).\n+\n+* `'wx'` - Like `'w'` but fails if the path exists.\n+\n+* `'w+'` - Open file for reading and writing.\n+The file is created (if it does not exist) or truncated (if it exists).\n+\n+* `'wx+'` - Like `'w+'` but fails if the path exists.\n+\n+`flag` can also be a number as documented by open(2); commonly used constants\n+are available from `fs.constants`. On Windows, flags are translated to\n+their equivalent ones where applicable, e.g. `O_WRONLY` to `FILE_GENERIC_WRITE`,\n+or `O_EXCL|O_CREAT` to `CREATE_NEW`, as accepted by CreateFileW.\n+\n+The exclusive flag `'x'` (`O_EXCL` flag in open(2)) ensures that path is newly\n+created. On POSIX systems, path is considered to exist even if it is a symlink\n+to a non-existent file. The exclusive flag may or may not work with network\n+file systems.\n+\n+On Linux, positional writes don't work when the file is opened in append mode.\n+The kernel ignores the position argument and always appends the data to\n+the end of the file.\n+\n+Modifying a file rather than replacing it may require a flags mode of `'r+'`\n+rather than the default mode `'w'`.\n+\n+The behavior of some flags are platform-specific. As such, opening a directory\n+on macOS and Linux with the `'a+'` flag - see example below - will return an\n+error. In contrast, on Windows and FreeBSD, a file descriptor or a `FileHandle`\n+will be returned.\n+\n+```js\n+// macOS and Linux\n+fs.open('<directory>', 'a+', (err, fd) => {\n+  // => [Error: EISDIR: illegal operation on a directory, open <directory>]\n+});\n+\n+// Windows and FreeBSD\n+fs.open('<directory>', 'a+', (err, fd) => {\n+  // => null, <fd>\n+});\n+```\n+\n+On Windows, opening an existing hidden file using the `'w'` flag (either\n+through `fs.open()` or `fs.writeFile()` or `fsPromises.open()`) will fail with\n+`EPERM`. Existing hidden files can be opened for writing with the `'r+'` flag.\n+\n+A call to `fs.ftruncate()` or `fsPromises.ftruncate()` can be used to reset\n+the file contents.\n \n [`AHAFS`]: https://www.ibm.com/developerworks/aix/library/au-aix_event_infrastructure/\n [`Buffer.byteLength`]: buffer.html#buffer_class_method_buffer_bytelength_string_encoding\n@@ -4747,3 +4691,4 @@ The following constants are meant for use with the [`fs.Stats`][] object's\n [inode]: https://en.wikipedia.org/wiki/Inode\n [Naming Files, Paths, and Namespaces]: https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247(v=vs.85).aspx\n [MSDN-Using-Streams]: https://msdn.microsoft.com/en-us/library/windows/desktop/bb540537.aspx\n+[support of file system `flags`]: #fs_file_system_flags"
        }
    ],
    "stats": {
        "total": 273,
        "additions": 109,
        "deletions": 164
    }
}