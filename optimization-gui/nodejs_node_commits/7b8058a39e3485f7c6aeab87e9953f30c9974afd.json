{
    "author": "joyeecheung",
    "message": "process: refactor the bootstrap mode branching for readability\n\nThis patch refactors the branches for choosing the mode to run\nNode.js in `internal/bootstrap/node.js`. Instead of inlining the\ndecision making all in `startup`, we create a `startExecution()`\nfunction which either detects and start the non-user-code mode,\nor prepares for user code execution (worker setup, preloading modules)\nand starts user code execution.\nWe use early returns when we decide the mode to run Node.js in for fewer\nindentations and better readability.\n\nThis patch also adds a few comments about the command-line switches\nand a few TODOs to remove underscore properties on `process` that\nare mainly used for bootstrap mode branching. It also includes\na few other refactoring such as inlining functions/variables\nthat are not reused and removing the default argument of\n`evalScript` for better clarity.\n\nPR-URL: https://github.com/nodejs/node/pull/24673\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "7b8058a39e3485f7c6aeab87e9953f30c9974afd",
    "files": [
        {
            "sha": "673a3f1b1d889e8460b3f316463401acf259bd5e",
            "filename": "lib/internal/bootstrap/node.js",
            "status": "modified",
            "additions": 151,
            "deletions": 112,
            "changes": 263,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fnode.js?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -104,18 +104,13 @@\n     }\n \n     const { getOptionValue } = NativeModule.require('internal/options');\n-    const helpOption = getOptionValue('--help');\n-    const completionBashOption = getOptionValue('--completion-bash');\n-    const experimentalModulesOption = getOptionValue('--experimental-modules');\n-    const experimentalVMModulesOption =\n-      getOptionValue('--experimental-vm-modules');\n-    const experimentalWorkerOption = getOptionValue('--experimental-worker');\n-    if (helpOption) {\n+\n+    if (getOptionValue('--help')) {\n       NativeModule.require('internal/print_help').print(process.stdout);\n       return;\n     }\n \n-    if (completionBashOption) {\n+    if (getOptionValue('--completion-bash')) {\n       NativeModule.require('internal/bash_completion').print(process.stdout);\n       return;\n     }\n@@ -135,7 +130,7 @@\n       setupQueueMicrotask();\n     }\n \n-    if (experimentalWorkerOption) {\n+    if (getOptionValue('--experimental-worker')) {\n       setupDOMException();\n     }\n \n@@ -167,8 +162,10 @@\n         'DeprecationWarning', 'DEP0062', startup, true);\n     }\n \n-    if (experimentalModulesOption || experimentalVMModulesOption) {\n-      if (experimentalModulesOption) {\n+    const experimentalModules = getOptionValue('--experimental-modules');\n+    const experimentalVMModules = getOptionValue('--experimental-vm-modules');\n+    if (experimentalModules || experimentalVMModules) {\n+      if (experimentalModules) {\n         process.emitWarning(\n           'The ESM module loader is experimental.',\n           'ExperimentalWarning', undefined);\n@@ -228,22 +225,33 @@\n \n     setupAllowedFlags();\n \n-    // There are various modes that Node can run in. The most common two\n-    // are running from a script and running the REPL - but there are a few\n-    // others like the debugger or running --eval arguments. Here we decide\n-    // which mode we run in.\n+    startExecution();\n+  }\n+\n+  // There are various modes that Node can run in. The most common two\n+  // are running from a script and running the REPL - but there are a few\n+  // others like the debugger or running --eval arguments. Here we decide\n+  // which mode we run in.\n+  function startExecution() {\n+    // This means we are in a Worker context, and any script execution\n+    // will be directed by the worker module.\n     if (internalBinding('worker').getEnvMessagePort() !== undefined) {\n-      // This means we are in a Worker context, and any script execution\n-      // will be directed by the worker module.\n       NativeModule.require('internal/worker').setupChild(evalScript);\n-    } else if (NativeModule.exists('_third_party_main')) {\n-      // To allow people to extend Node in different ways, this hook allows\n-      // one to drop a file lib/_third_party_main.js into the build\n-      // directory which will be executed instead of Node's normal loading.\n+      return;\n+    }\n+\n+    // To allow people to extend Node in different ways, this hook allows\n+    // one to drop a file lib/_third_party_main.js into the build\n+    // directory which will be executed instead of Node's normal loading.\n+    if (NativeModule.exists('_third_party_main')) {\n       process.nextTick(() => {\n         NativeModule.require('_third_party_main');\n       });\n-    } else if (process.argv[1] === 'inspect' || process.argv[1] === 'debug') {\n+      return;\n+    }\n+\n+    // `node inspect ...` or `node debug ...`\n+    if (process.argv[1] === 'inspect' || process.argv[1] === 'debug') {\n       if (process.argv[1] === 'debug') {\n         process.emitWarning(\n           '`node debug` is deprecated. Please use `node inspect` instead.',\n@@ -254,95 +262,136 @@\n       process.nextTick(() => {\n         NativeModule.require('internal/deps/node-inspect/lib/_inspect').start();\n       });\n+      return;\n+    }\n \n-    } else if (process.profProcess) {\n+    // `node --prof-process`\n+    // TODO(joyeecheung): use internal/options instead of process.profProcess\n+    if (process.profProcess) {\n       NativeModule.require('internal/v8_prof_processor');\n-    } else {\n-      // There is user code to be run.\n-\n-      // If this is a worker in cluster mode, start up the communication\n-      // channel. This needs to be done before any user code gets executed\n-      // (including preload modules).\n-      if (process.argv[1] && process.env.NODE_UNIQUE_ID) {\n-        const cluster = NativeModule.require('cluster');\n-        cluster._setupWorker();\n-        // Make sure it's not accidentally inherited by child processes.\n-        delete process.env.NODE_UNIQUE_ID;\n+      return;\n+    }\n+\n+    // There is user code to be run.\n+    prepareUserCodeExecution();\n+    executeUserCode();\n+  }\n+\n+  function prepareUserCodeExecution() {\n+    // If this is a worker in cluster mode, start up the communication\n+    // channel. This needs to be done before any user code gets executed\n+    // (including preload modules).\n+    if (process.argv[1] && process.env.NODE_UNIQUE_ID) {\n+      const cluster = NativeModule.require('cluster');\n+      cluster._setupWorker();\n+      // Make sure it's not accidentally inherited by child processes.\n+      delete process.env.NODE_UNIQUE_ID;\n+    }\n+\n+    // For user code, we preload modules if `-r` is passed\n+    // TODO(joyeecheung): use internal/options instead of\n+    // process._preload_modules\n+    if (process._preload_modules) {\n+      const {\n+        _preloadModules\n+      } = NativeModule.require('internal/modules/cjs/loader');\n+      _preloadModules(process._preload_modules);\n+    }\n+  }\n+\n+  function executeUserCode() {\n+    // User passed `-e` or `--eval` arguments to Node without `-i` or\n+    // `--interactive`.\n+    // Note that the name `forceRepl` is merely an alias of `interactive`\n+    // in code.\n+    // TODO(joyeecheung): use internal/options instead of\n+    // process._eval/process._forceRepl\n+    if (process._eval != null && !process._forceRepl) {\n+      const {\n+        addBuiltinLibsToObject\n+      } = NativeModule.require('internal/modules/cjs/helpers');\n+      addBuiltinLibsToObject(global);\n+      evalScript('[eval]', wrapForBreakOnFirstLine(process._eval));\n+      return;\n+    }\n+\n+    // If the first argument is a file name, run it as a main script\n+    if (process.argv[1] && process.argv[1] !== '-') {\n+      // Expand process.argv[1] into a full path.\n+      const path = NativeModule.require('path');\n+      process.argv[1] = path.resolve(process.argv[1]);\n+\n+      const CJSModule = NativeModule.require('internal/modules/cjs/loader');\n+\n+      // If user passed `-c` or `--check` arguments to Node, check its syntax\n+      // instead of actually running the file.\n+      // TODO(joyeecheung): use internal/options instead of\n+      // process._syntax_check_only\n+      if (process._syntax_check_only != null) {\n+        const fs = NativeModule.require('fs');\n+        // Read the source.\n+        const filename = CJSModule._resolveFilename(process.argv[1]);\n+        const source = fs.readFileSync(filename, 'utf-8');\n+        checkScriptSyntax(source, filename);\n+        process.exit(0);\n       }\n \n-      if (process._eval != null && !process._forceRepl) {\n-        // User passed '-e' or '--eval' arguments to Node without '-i' or\n-        // '--interactive'.\n-        preloadModules();\n-\n-        const {\n-          addBuiltinLibsToObject\n-        } = NativeModule.require('internal/modules/cjs/helpers');\n-        addBuiltinLibsToObject(global);\n-        evalScript('[eval]');\n-      } else if (process.argv[1] && process.argv[1] !== '-') {\n-        // Make process.argv[1] into a full path.\n-        const path = NativeModule.require('path');\n-        process.argv[1] = path.resolve(process.argv[1]);\n-\n-        const CJSModule = NativeModule.require('internal/modules/cjs/loader');\n-\n-        preloadModules();\n-        // Check if user passed `-c` or `--check` arguments to Node.\n-        if (process._syntax_check_only != null) {\n-          const fs = NativeModule.require('fs');\n-          // Read the source.\n-          const filename = CJSModule._resolveFilename(process.argv[1]);\n-          const source = fs.readFileSync(filename, 'utf-8');\n-          checkScriptSyntax(source, filename);\n-          process.exit(0);\n+      // Note: this actually tries to run the module as a ESM first if\n+      // --experimental-modules is on.\n+      // TODO(joyeecheung): can we move that logic to here? Note that this\n+      // is an undocumented method available via `require('module').runMain`\n+      CJSModule.runMain();\n+      return;\n+    }\n+\n+    // Create the REPL if `-i` or `--interactive` is passed, or if\n+    // stdin is a TTY.\n+    // Note that the name `forceRepl` is merely an alias of `interactive`\n+    // in code.\n+    if (process._forceRepl || NativeModule.require('tty').isatty(0)) {\n+      const cliRepl = NativeModule.require('internal/repl');\n+      cliRepl.createInternalRepl(process.env, (err, repl) => {\n+        if (err) {\n+          throw err;\n         }\n-        CJSModule.runMain();\n-      } else {\n-        preloadModules();\n-        // If -i or --interactive were passed, or stdin is a TTY.\n-        if (process._forceRepl || NativeModule.require('tty').isatty(0)) {\n-          // REPL\n-          const cliRepl = NativeModule.require('internal/repl');\n-          cliRepl.createInternalRepl(process.env, (err, repl) => {\n-            if (err) {\n-              throw err;\n-            }\n-            repl.on('exit', () => {\n-              if (repl._flushing) {\n-                repl.pause();\n-                return repl.once('flushHistory', () => {\n-                  process.exit();\n-                });\n-              }\n+        repl.on('exit', () => {\n+          if (repl._flushing) {\n+            repl.pause();\n+            return repl.once('flushHistory', () => {\n               process.exit();\n             });\n-          });\n-\n-          if (process._eval != null) {\n-            // User passed '-e' or '--eval'\n-            evalScript('[eval]');\n           }\n-        } else {\n-          // Read all of stdin - execute it.\n-          process.stdin.setEncoding('utf8');\n-\n-          let code = '';\n-          process.stdin.on('data', (d) => {\n-            code += d;\n-          });\n-\n-          process.stdin.on('end', function() {\n-            if (process._syntax_check_only != null) {\n-              checkScriptSyntax(code, '[stdin]');\n-            } else {\n-              process._eval = code;\n-              evalScript('[stdin]');\n-            }\n-          });\n-        }\n+          process.exit();\n+        });\n+      });\n+\n+      // User passed '-e' or '--eval' along with `-i` or `--interactive`\n+      if (process._eval != null) {\n+        evalScript('[eval]', wrapForBreakOnFirstLine(process._eval));\n       }\n+      return;\n     }\n+\n+    // Stdin is not a TTY, we will read it and execute it.\n+    readAndExecuteStdin();\n+  }\n+\n+  function readAndExecuteStdin() {\n+    process.stdin.setEncoding('utf8');\n+\n+    let code = '';\n+    process.stdin.on('data', (d) => {\n+      code += d;\n+    });\n+\n+    process.stdin.on('end', () => {\n+      if (process._syntax_check_only != null) {\n+        checkScriptSyntax(code, '[stdin]');\n+      } else {\n+        process._eval = code;\n+        evalScript('[stdin]', wrapForBreakOnFirstLine(process._eval));\n+      }\n+    });\n   }\n \n   function setupTraceCategoryState() {\n@@ -651,7 +700,7 @@\n     return `process.binding('inspector').callAndPauseOnStart(${fn}, {})`;\n   }\n \n-  function evalScript(name, body = wrapForBreakOnFirstLine(process._eval)) {\n+  function evalScript(name, body) {\n     const CJSModule = NativeModule.require('internal/modules/cjs/loader');\n     const path = NativeModule.require('path');\n     const cwd = tryGetCwd(path);\n@@ -673,16 +722,6 @@\n     process._tickCallback();\n   }\n \n-  // Load preload modules.\n-  function preloadModules() {\n-    if (process._preload_modules) {\n-      const {\n-        _preloadModules\n-      } = NativeModule.require('internal/modules/cjs/loader');\n-      _preloadModules(process._preload_modules);\n-    }\n-  }\n-\n   function checkScriptSyntax(source, filename) {\n     const CJSModule = NativeModule.require('internal/modules/cjs/loader');\n     const vm = NativeModule.require('vm');"
        },
        {
            "sha": "371bd9ff917b86de1d233ae8cdaedfa26ad9e9bf",
            "filename": "test/message/assert_throws_stack.out",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fassert_throws_stack.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fassert_throws_stack.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Fassert_throws_stack.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -18,3 +18,4 @@ AssertionError [ERR_ASSERTION]: Expected values to be strictly deep-equal:\n     at *\n     at *\n     at *\n+    at *"
        },
        {
            "sha": "59953132fa0542f45222b726b91cac0ad7b4e90a",
            "filename": "test/message/core_line_numbers.out",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fcore_line_numbers.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fcore_line_numbers.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Fcore_line_numbers.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -12,4 +12,4 @@ RangeError: Invalid input\n     at tryModuleLoad (internal/modules/cjs/loader.js:*:*)\n     at Function.Module._load (internal/modules/cjs/loader.js:*:*)\n     at Function.Module.runMain (internal/modules/cjs/loader.js:*:*)\n-    at startup (internal/bootstrap/node.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)"
        },
        {
            "sha": "39692a7b6e4482b339728a99495902e116f3d6f0",
            "filename": "test/message/error_exit.out",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Ferror_exit.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Ferror_exit.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Ferror_exit.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -14,5 +14,6 @@ AssertionError [ERR_ASSERTION]: Expected values to be strictly equal:\n     at tryModuleLoad (internal/modules/cjs/loader.js:*:*)\n     at Function.Module._load (internal/modules/cjs/loader.js:*:*)\n     at Function.Module.runMain (internal/modules/cjs/loader.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)\n     at startup (internal/bootstrap/node.js:*:*)\n-    at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)"
        },
        {
            "sha": "c26c63d2b0d016dc5020c226857e4659248ffb71",
            "filename": "test/message/eval_messages.out",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Feval_messages.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Feval_messages.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Feval_messages.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -9,6 +9,8 @@ SyntaxError: Strict mode code may not include a with statement\n     at Object.<anonymous> ([eval]-wrapper:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     at evalScript (internal/bootstrap/node.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)\n     at startup (internal/bootstrap/node.js:*:*)\n     at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)\n 42\n@@ -24,6 +26,8 @@ Error: hello\n     at Object.<anonymous> ([eval]-wrapper:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     at evalScript (internal/bootstrap/node.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)\n     at startup (internal/bootstrap/node.js:*:*)\n     at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)\n \n@@ -38,6 +42,8 @@ Error: hello\n     at Object.<anonymous> ([eval]-wrapper:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     at evalScript (internal/bootstrap/node.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)\n     at startup (internal/bootstrap/node.js:*:*)\n     at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)\n 100\n@@ -52,6 +58,8 @@ ReferenceError: y is not defined\n     at Object.<anonymous> ([eval]-wrapper:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     at evalScript (internal/bootstrap/node.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)\n     at startup (internal/bootstrap/node.js:*:*)\n     at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)\n "
        },
        {
            "sha": "67be22554fb41edd83503def8159ee8c78190aba",
            "filename": "test/message/events_unhandled_error_common_trace.out",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fevents_unhandled_error_common_trace.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fevents_unhandled_error_common_trace.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Fevents_unhandled_error_common_trace.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -12,11 +12,11 @@ Error: foo:bar\n     at tryModuleLoad (internal/modules/cjs/loader.js:*:*)\n     at Function.Module._load (internal/modules/cjs/loader.js:*:*)\n     at Function.Module.runMain (internal/modules/cjs/loader.js:*:*)\n-    at startup (internal/bootstrap/node.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n Emitted 'error' event at:\n     at quux (*events_unhandled_error_common_trace.js:*:*)\n     at Object.<anonymous> (*events_unhandled_error_common_trace.js:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     [... lines matching original stack trace ...]\n-    at startup (internal/bootstrap/node.js:*:*)\n-    at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)"
        },
        {
            "sha": "d043839fe2c40c6d5663b360dc07aa7a4c7fec24",
            "filename": "test/message/events_unhandled_error_nexttick.out",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fevents_unhandled_error_nexttick.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fevents_unhandled_error_nexttick.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Fevents_unhandled_error_nexttick.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -10,12 +10,15 @@ Error\n     at tryModuleLoad (internal/modules/cjs/loader.js:*:*)\n     at Function.Module._load (internal/modules/cjs/loader.js:*:*)\n     at Function.Module.runMain (internal/modules/cjs/loader.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)\n     at startup (internal/bootstrap/node.js:*:*)\n-    at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)\n Emitted 'error' event at:\n     at process.nextTick (*events_unhandled_error_nexttick.js:*:*)\n     at internalTickCallback (internal/process/next_tick.js:*:*)\n     at process._tickCallback (internal/process/next_tick.js:*:*)\n     at Function.Module.runMain (internal/modules/cjs/loader.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)\n     at startup (internal/bootstrap/node.js:*:*)\n     at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)"
        },
        {
            "sha": "cd2b76120326ca07119aed5c493ffdfb3b6ed0c1",
            "filename": "test/message/events_unhandled_error_sameline.out",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fevents_unhandled_error_sameline.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fevents_unhandled_error_sameline.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Fevents_unhandled_error_sameline.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -10,10 +10,11 @@ Error\n     at tryModuleLoad (internal/modules/cjs/loader.js:*:*)\n     at Function.Module._load (internal/modules/cjs/loader.js:*:*)\n     at Function.Module.runMain (internal/modules/cjs/loader.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)\n     at startup (internal/bootstrap/node.js:*:*)\n-    at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)\n Emitted 'error' event at:\n     at Object.<anonymous> (*events_unhandled_error_sameline.js:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     [... lines matching original stack trace ...]\n-    at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)\n+    at startup (internal/bootstrap/node.js:*:*)"
        },
        {
            "sha": "5f3c85f874c5993b861ca6c4d6f5686480c53cac",
            "filename": "test/message/nexttick_throw.out",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fnexttick_throw.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fnexttick_throw.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Fnexttick_throw.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -7,5 +7,7 @@ ReferenceError: undefined_reference_error_maker is not defined\n     at internalTickCallback (internal/process/next_tick.js:*:*)\n     at process._tickCallback (internal/process/next_tick.js:*:*)\n     at Function.Module.runMain (internal/modules/cjs/loader.js:*:*)\n+    at executeUserCode (internal/bootstrap/node.js:*:*)\n+    at startExecution (internal/bootstrap/node.js:*:*)\n     at startup (internal/bootstrap/node.js:*:*)\n     at bootstrapNodeJSCore (internal/bootstrap/node.js:*:*)"
        },
        {
            "sha": "6ec340c0c42cd31f980e1fe51b39d87a02306a7c",
            "filename": "test/message/stdin_messages.out",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fstdin_messages.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Fstdin_messages.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Fstdin_messages.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -9,7 +9,7 @@ SyntaxError: Strict mode code may not include a with statement\n     at Object.<anonymous> ([stdin]-wrapper:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     at evalScript (internal/bootstrap/node.js:*:*)\n-    at Socket.<anonymous> (internal/bootstrap/node.js:*:*)\n+    at Socket.process.stdin.on (internal/bootstrap/node.js:*:*)\n     at Socket.emit (events.js:*:*)\n     at endReadableNT (_stream_readable.js:*:*)\n     at process.internalTickCallback (internal/process/next_tick.js:*:*)\n@@ -26,7 +26,7 @@ Error: hello\n     at Object.<anonymous> ([stdin]-wrapper:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     at evalScript (internal/bootstrap/node.js:*:*)\n-    at Socket.<anonymous> (internal/bootstrap/node.js:*:*)\n+    at Socket.process.stdin.on (internal/bootstrap/node.js:*:*)\n     at Socket.emit (events.js:*:*)\n     at endReadableNT (_stream_readable.js:*:*)\n     at process.internalTickCallback (internal/process/next_tick.js:*:*)\n@@ -41,7 +41,7 @@ Error: hello\n     at Object.<anonymous> ([stdin]-wrapper:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     at evalScript (internal/bootstrap/node.js:*:*)\n-    at Socket.<anonymous> (internal/bootstrap/node.js:*:*)\n+    at Socket.process.stdin.on (internal/bootstrap/node.js:*:*)\n     at Socket.emit (events.js:*:*)\n     at endReadableNT (_stream_readable.js:*:*)\n     at process.internalTickCallback (internal/process/next_tick.js:*:*)\n@@ -57,7 +57,7 @@ ReferenceError: y is not defined\n     at Object.<anonymous> ([stdin]-wrapper:*:*)\n     at Module._compile (internal/modules/cjs/loader.js:*:*)\n     at evalScript (internal/bootstrap/node.js:*:*)\n-    at Socket.<anonymous> (internal/bootstrap/node.js:*:*)\n+    at Socket.process.stdin.on (internal/bootstrap/node.js:*:*)\n     at Socket.emit (events.js:*:*)\n     at endReadableNT (_stream_readable.js:*:*)\n     at process.internalTickCallback (internal/process/next_tick.js:*:*)"
        },
        {
            "sha": "2187ee1e85b8f84e2b80b49fc5bee26d005ed610",
            "filename": "test/message/unhandled_promise_trace_warnings.out",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Funhandled_promise_trace_warnings.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Funhandled_promise_trace_warnings.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Funhandled_promise_trace_warnings.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -15,6 +15,9 @@\n     at *\n     at *\n     at *\n+    at *\n+    at *\n+    at *\n (node:*) Error: This was rejected\n     at * (*test*message*unhandled_promise_trace_warnings.js:*)\n     at *\n@@ -25,6 +28,7 @@\n     at *\n     at *\n     at *\n+    at *\n (node:*) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\n     at *\n     at *\n@@ -34,6 +38,8 @@\n     at *\n     at *\n     at *\n+    at *\n+    at *\n (node:*) PromiseRejectionHandledWarning: Promise rejection was handled asynchronously (rejection id: 1)\n     at handledRejection (internal/process/promises.js:*)\n     at handler (internal/process/promises.js:*)"
        },
        {
            "sha": "408a3c8baf6d8f5ba3b18371e2b6a35ea3a452b6",
            "filename": "test/message/util_inspect_error.out",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Futil_inspect_error.out",
            "raw_url": "https://github.com/nodejs/node/raw/7b8058a39e3485f7c6aeab87e9953f30c9974afd/test%2Fmessage%2Futil_inspect_error.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Futil_inspect_error.out?ref=7b8058a39e3485f7c6aeab87e9953f30c9974afd",
            "patch": "@@ -10,6 +10,7 @@\n        at *\n        at *\n        at *\n+       at *\n   nested:\n    { err:\n       Error: foo\n@@ -22,6 +23,7 @@\n           at *\n           at *\n           at *\n+          at *\n           at * } }\n {\n   err: Error: foo\n@@ -34,6 +36,7 @@\n       at *\n       at *\n       at *\n+      at *\n       at *,\n   nested: {\n     err: Error: foo\n@@ -47,6 +50,7 @@\n         at *\n         at *\n         at *\n+        at *\n   }\n }\n { Error: foo\n@@ -60,4 +64,5 @@ bar\n     at *\n     at *\n     at *\n+    at *\n   foo: 'bar' }"
        }
    ],
    "stats": {
        "total": 314,
        "additions": 190,
        "deletions": 124
    }
}