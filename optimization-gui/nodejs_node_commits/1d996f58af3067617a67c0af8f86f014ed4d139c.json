{
    "author": "ofrobots",
    "message": "src: properly configure default heap limits\n\nUnless configured, V8 defaults to limiting the max heaps size to 700 MB\nor 1400MB on 32 and 64-bit platforms respectively. This default is\nbased on the browser use-cases and doesn't make a lot of sense\ngenerally. This change properly configures the heap size based on\nactual available memory.\n\nPR-URL: https://github.com/nodejs/node/pull/25576\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Yang Guo <yangguo@chromium.org>\nReviewed-By: Ujjwal Sharma <usharma1998@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "1d996f58af3067617a67c0af8f86f014ed4d139c",
    "files": [
        {
            "sha": "e54252824bdcc972aacfcb49ee670cfc441807b4",
            "filename": "src/api/environment.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/1d996f58af3067617a67c0af8f86f014ed4d139c/src%2Fapi%2Fenvironment.cc",
            "raw_url": "https://github.com/nodejs/node/raw/1d996f58af3067617a67c0af8f86f014ed4d139c/src%2Fapi%2Fenvironment.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fapi%2Fenvironment.cc?ref=1d996f58af3067617a67c0af8f86f014ed4d139c",
            "patch": "@@ -80,6 +80,15 @@ void FreeArrayBufferAllocator(ArrayBufferAllocator* allocator) {\n Isolate* NewIsolate(ArrayBufferAllocator* allocator, uv_loop_t* event_loop) {\n   Isolate::CreateParams params;\n   params.array_buffer_allocator = allocator;\n+\n+  double total_memory = uv_get_total_memory();\n+  if (total_memory > 0) {\n+    // V8 defaults to 700MB or 1.4GB on 32 and 64 bit platforms respectively.\n+    // This default is based on browser use-cases. Tell V8 to configure the\n+    // heap based on the actual physical memory.\n+    params.constraints.ConfigureDefaults(total_memory, 0);\n+  }\n+\n #ifdef NODE_ENABLE_VTUNE_PROFILING\n   params.code_event_handler = vTune::GetVtuneCodeEventHandler();\n #endif"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 9,
        "deletions": 0
    }
}