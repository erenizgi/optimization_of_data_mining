{
    "author": "cjihrig",
    "message": "console: improve inspectOptions validation\n\nThis commit adds stricter type checking to the inspectOptions\noption to the Console constructor.\n\nPR-URL: https://github.com/nodejs/node/pull/25090\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Anto Aravinth <anto.aravinth.cse@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "bf36f0755c0a41702fe506bcfc90d156030d0497",
    "files": [
        {
            "sha": "7e1bcf802f85f55bbcaae6fc9eb44305caa174bb",
            "filename": "lib/internal/console/constructor.js",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/bf36f0755c0a41702fe506bcfc90d156030d0497/lib%2Finternal%2Fconsole%2Fconstructor.js",
            "raw_url": "https://github.com/nodejs/node/raw/bf36f0755c0a41702fe506bcfc90d156030d0497/lib%2Finternal%2Fconsole%2Fconstructor.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fconsole%2Fconstructor.js?ref=bf36f0755c0a41702fe506bcfc90d156030d0497",
            "patch": "@@ -91,13 +91,15 @@ function Console(options /* or: stdout, stderr, ignoreErrors = true */) {\n   if (typeof colorMode !== 'boolean' && colorMode !== 'auto')\n     throw new ERR_INVALID_ARG_VALUE('colorMode', colorMode);\n \n-  if (inspectOptions) {\n+  if (typeof inspectOptions === 'object' && inspectOptions !== null) {\n     if (inspectOptions.colors !== undefined &&\n         options.colorMode !== undefined) {\n       throw new ERR_INCOMPATIBLE_OPTION_PAIR(\n         'inspectOptions.color', 'colorMode');\n     }\n     optionsMap.set(this, inspectOptions);\n+  } else if (inspectOptions !== undefined) {\n+    throw new ERR_INVALID_ARG_TYPE('inspectOptions', 'object', inspectOptions);\n   }\n \n   // Bind the prototype functions to this Console instance"
        },
        {
            "sha": "1c8b54ef4ca725ab98b8b9778f7a42b0d7660505",
            "filename": "test/parallel/test-console-instance.js",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/bf36f0755c0a41702fe506bcfc90d156030d0497/test%2Fparallel%2Ftest-console-instance.js",
            "raw_url": "https://github.com/nodejs/node/raw/bf36f0755c0a41702fe506bcfc90d156030d0497/test%2Fparallel%2Ftest-console-instance.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-console-instance.js?ref=bf36f0755c0a41702fe506bcfc90d156030d0497",
            "patch": "@@ -128,3 +128,21 @@ out.write = err.write = (d) => {};\n   assert.throws(() => c2.warn('foo'), /^Error: err$/);\n   assert.throws(() => c2.dir('foo'), /^Error: out$/);\n }\n+\n+// Console constructor throws if inspectOptions is not an object.\n+[null, true, false, 'foo', 5, Symbol()].forEach((inspectOptions) => {\n+  assert.throws(\n+    () => {\n+      new Console({\n+        stdout: out,\n+        stderr: err,\n+        inspectOptions\n+      });\n+    },\n+    {\n+      message: 'The \"inspectOptions\" argument must be of type object.' +\n+               ` Received type ${typeof inspectOptions}`,\n+      code: 'ERR_INVALID_ARG_TYPE'\n+    }\n+  );\n+});"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 21,
        "deletions": 1
    }
}