{
    "author": "chinhuang007",
    "message": "test: add useful info to error msg and refactor\n\nAdd useful info about process.domain to error meesages in the\nuncaughtException event listener and the beforeExit event listener.\n\nRefactor code such as using template literals, and also make sure\nuncaughtException listner is detached after firing once to avoid\nendless loop in case of exception throw in the beforeExit event\nlistner.\n\nPR-URL: https://github.com/nodejs/node/pull/18541\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "c3ff89920e43a246324842c915d33893a7456568",
    "files": [
        {
            "sha": "e9e8ab12d59d2cda0601592b8f566f85808d5c02",
            "filename": "test/parallel/test-domain-stack-empty-in-process-uncaughtexception.js",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/c3ff89920e43a246324842c915d33893a7456568/test%2Fparallel%2Ftest-domain-stack-empty-in-process-uncaughtexception.js",
            "raw_url": "https://github.com/nodejs/node/raw/c3ff89920e43a246324842c915d33893a7456568/test%2Fparallel%2Ftest-domain-stack-empty-in-process-uncaughtexception.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-domain-stack-empty-in-process-uncaughtexception.js?ref=c3ff89920e43a246324842c915d33893a7456568",
            "patch": "@@ -6,15 +6,18 @@ const assert = require('assert');\n \n const d = domain.create();\n \n-process.on('uncaughtException', common.mustCall(function onUncaught() {\n+process.once('uncaughtException', common.mustCall(function onUncaught() {\n   assert.strictEqual(\n     process.domain, null,\n-    'domains stack should be empty in uncaughtException handler');\n+    'Domains stack should be empty in uncaughtException handler ' +\n+    `but the value of process.domain is ${JSON.stringify(process.domain)}`);\n }));\n \n process.on('beforeExit', common.mustCall(function onBeforeExit() {\n-  assert.strictEqual(process.domain, null,\n-                     'domains stack should be empty in beforeExit handler');\n+  assert.strictEqual(\n+    process.domain, null,\n+    'Domains stack should be empty in beforeExit handler ' +\n+    `but the value of process.domain is ${JSON.stringify(process.domain)}`);\n }));\n \n d.run(function() {"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 7,
        "deletions": 4
    }
}