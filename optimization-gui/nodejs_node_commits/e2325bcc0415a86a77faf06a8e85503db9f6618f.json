{
    "author": "BeniCheni",
    "message": "string_decoder: support typed array or data view\n\nRefs: https://github.com/nodejs/node/issues/1826\nPR-URL: https://github.com/nodejs/node/pull/22562\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "e2325bcc0415a86a77faf06a8e85503db9f6618f",
    "files": [
        {
            "sha": "c2e5434ac72c4a8d67b6df293e9c77b57012f373",
            "filename": "doc/api/string_decoder.md",
            "status": "modified",
            "additions": 7,
            "deletions": 5,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/e2325bcc0415a86a77faf06a8e85503db9f6618f/doc%2Fapi%2Fstring_decoder.md",
            "raw_url": "https://github.com/nodejs/node/raw/e2325bcc0415a86a77faf06a8e85503db9f6618f/doc%2Fapi%2Fstring_decoder.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fstring_decoder.md?ref=e2325bcc0415a86a77faf06a8e85503db9f6618f",
            "patch": "@@ -59,7 +59,8 @@ Creates a new `StringDecoder` instance.\n added: v0.9.3\n -->\n \n-* `buffer` {Buffer} A `Buffer` containing the bytes to decode.\n+* `buffer` {Buffer|TypedArray|DataView} A `Buffer`, or `TypedArray`, or\n+ `DataView` containing the bytes to decode.\n * Returns: {string}\n \n Returns any remaining input stored in the internal buffer as a string. Bytes\n@@ -79,10 +80,11 @@ changes:\n                  character instead of one for each individual byte.\n -->\n \n-* `buffer` {Buffer} A `Buffer` containing the bytes to decode.\n+* `buffer` {Buffer|TypedArray|DataView} A `Buffer`, or `TypedArray`, or\n+ `DataView` containing the bytes to decode.\n * Returns: {string}\n \n Returns a decoded string, ensuring that any incomplete multibyte characters at\n-the end of the `Buffer` are omitted from the returned string and stored in an\n-internal buffer for the next call to `stringDecoder.write()` or\n-`stringDecoder.end()`.\n+ the end of the `Buffer`, or `TypedArray`, or `DataView` are omitted from the\n+ returned string and stored in an internal buffer for the next call to\n+ `stringDecoder.write()` or `stringDecoder.end()`."
        },
        {
            "sha": "e5f396cab30d3b4c044690042e9bd4f65394e2cc",
            "filename": "lib/string_decoder.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/e2325bcc0415a86a77faf06a8e85503db9f6618f/lib%2Fstring_decoder.js",
            "raw_url": "https://github.com/nodejs/node/raw/e2325bcc0415a86a77faf06a8e85503db9f6618f/lib%2Fstring_decoder.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fstring_decoder.js?ref=e2325bcc0415a86a77faf06a8e85503db9f6618f",
            "patch": "@@ -73,7 +73,7 @@ StringDecoder.prototype.write = function write(buf) {\n     return buf;\n   if (!ArrayBuffer.isView(buf))\n     throw new ERR_INVALID_ARG_TYPE('buf',\n-                                   ['Buffer', 'Uint8Array', 'ArrayBufferView'],\n+                                   ['Buffer', 'TypedArray', 'DataView'],\n                                    buf);\n   return decode(this[kNativeDecoder], buf);\n };"
        },
        {
            "sha": "c4607672b0420c1c9c137fbb8370318a8c1e259f",
            "filename": "test/parallel/test-string-decoder.js",
            "status": "modified",
            "additions": 13,
            "deletions": 2,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/e2325bcc0415a86a77faf06a8e85503db9f6618f/test%2Fparallel%2Ftest-string-decoder.js",
            "raw_url": "https://github.com/nodejs/node/raw/e2325bcc0415a86a77faf06a8e85503db9f6618f/test%2Fparallel%2Ftest-string-decoder.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-string-decoder.js?ref=e2325bcc0415a86a77faf06a8e85503db9f6618f",
            "patch": "@@ -97,6 +97,17 @@ assert.strictEqual(decoder.lastTotal, 3);\n \n assert.strictEqual(decoder.end(), '\\ufffd');\n \n+// ArrayBufferView tests\n+const arrayBufferViewStr = 'String for ArrayBufferView tests\\n';\n+const inputBuffer = Buffer.from(arrayBufferViewStr.repeat(8), 'utf8');\n+for (const expectView of common.getArrayBufferViews(inputBuffer)) {\n+  assert.strictEqual(\n+    decoder.write(expectView),\n+    inputBuffer.toString('utf8')\n+  );\n+  assert.strictEqual(decoder.end(), '');\n+}\n+\n decoder = new StringDecoder('utf8');\n assert.strictEqual(decoder.write(Buffer.from('E18B', 'hex')), '');\n assert.strictEqual(decoder.end(), '\\ufffd');\n@@ -174,8 +185,8 @@ common.expectsError(\n   {\n     code: 'ERR_INVALID_ARG_TYPE',\n     type: TypeError,\n-    message: 'The \"buf\" argument must be one of type Buffer, Uint8Array, or' +\n-      ' ArrayBufferView. Received type object'\n+    message: 'The \"buf\" argument must be one of type Buffer, TypedArray,' +\n+      ' or DataView. Received type object'\n   }\n );\n "
        }
    ],
    "stats": {
        "total": 29,
        "additions": 21,
        "deletions": 8
    }
}