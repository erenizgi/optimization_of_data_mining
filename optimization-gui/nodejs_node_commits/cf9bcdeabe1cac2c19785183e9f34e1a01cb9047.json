{
    "author": "cjihrig",
    "message": "tools: lint for use of internalBinding()\n\nUse of process.binding() has largely been replaced by\ninternalBinding(). This commit updates the custom crypto\ncheck ESLint rule to check for both process.binding() and\ninternalBinding().\n\nRefs: https://github.com/nodejs/node/pull/24952\nPR-URL: https://github.com/nodejs/node/pull/25395\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "cf9bcdeabe1cac2c19785183e9f34e1a01cb9047",
    "files": [
        {
            "sha": "2325a04354c53bbf9129d02e8407745b39047553",
            "filename": "test/parallel/test-eslint-crypto-check.js",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/cf9bcdeabe1cac2c19785183e9f34e1a01cb9047/test%2Fparallel%2Ftest-eslint-crypto-check.js",
            "raw_url": "https://github.com/nodejs/node/raw/cf9bcdeabe1cac2c19785183e9f34e1a01cb9047/test%2Fparallel%2Ftest-eslint-crypto-check.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-eslint-crypto-check.js?ref=cf9bcdeabe1cac2c19785183e9f34e1a01cb9047",
            "patch": "@@ -19,6 +19,12 @@ new RuleTester().run('crypto-check', rule, {\n       common.skip(\"missing crypto\");\n     }\n     require(\"crypto\");\n+    `,\n+    `\n+    if (!common.hasCrypto) {\n+      common.skip(\"missing crypto\");\n+    }\n+    internalBinding(\"crypto\");\n     `\n   ],\n   invalid: [\n@@ -51,6 +57,18 @@ new RuleTester().run('crypto-check', rule, {\n               '}\\n' +\n               'if (common.foo) {}\\n' +\n               'require(\"crypto\")'\n+    },\n+    {\n+      code: 'require(\"common\")\\n' +\n+            'if (common.foo) {}\\n' +\n+            'internalBinding(\"crypto\")',\n+      errors: [{ message }],\n+      output: 'require(\"common\")\\n' +\n+              'if (!common.hasCrypto) {' +\n+              ' common.skip(\"missing crypto\");' +\n+              '}\\n' +\n+              'if (common.foo) {}\\n' +\n+              'internalBinding(\"crypto\")'\n     }\n   ]\n });"
        },
        {
            "sha": "315e7ca0adf2efc96c53dbaf6b33caf88e96573b",
            "filename": "tools/eslint-rules/rules-utils.js",
            "status": "modified",
            "additions": 7,
            "deletions": 6,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/cf9bcdeabe1cac2c19785183e9f34e1a01cb9047/tools%2Feslint-rules%2Frules-utils.js",
            "raw_url": "https://github.com/nodejs/node/raw/cf9bcdeabe1cac2c19785183e9f34e1a01cb9047/tools%2Feslint-rules%2Frules-utils.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Feslint-rules%2Frules-utils.js?ref=cf9bcdeabe1cac2c19785183e9f34e1a01cb9047",
            "patch": "@@ -33,14 +33,15 @@ module.exports.isCommonModule = function(node) {\n \n /**\n  * Returns true if any of the passed in modules are used in\n- * binding calls.\n+ * process.binding() or internalBinding() calls.\n  */\n module.exports.isBinding = function(node, modules) {\n-  if (node.callee.object) {\n-    return node.callee.object.name === 'process' &&\n-           node.callee.property.name === 'binding' &&\n-           modules.includes(node.arguments[0].value);\n-  }\n+  const isProcessBinding = node.callee.object &&\n+                           node.callee.object.name === 'process' &&\n+                           node.callee.property.name === 'binding';\n+\n+  return (isProcessBinding || node.callee.name === 'internalBinding') &&\n+         modules.includes(node.arguments[0].value);\n };\n \n /**"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 25,
        "deletions": 6
    }
}