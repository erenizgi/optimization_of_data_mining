{
    "author": "maclover7",
    "message": "src,lib: rename FSReqWrap to FSReqCallback\n\nGiven that FSReqPromise does not inherit from FSReqWrap, FSReqWrap\nshould be renamed FSReqCallback to better describe what it does.\n\nFirst of a few upcoming `fs` refactorings :)\n\nPR-URL: https://github.com/nodejs/node/pull/21971\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "172b4d7cebaa3ee047dd80ea908f06dd031c39f2",
    "files": [
        {
            "sha": "6badc808d2b4768cb4d70927e857e1e9dcf07ade",
            "filename": "lib/fs.js",
            "status": "modified",
            "additions": 33,
            "deletions": 33,
            "changes": 66,
            "blob_url": "https://github.com/nodejs/node/blob/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/lib%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/lib%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs.js?ref=172b4d7cebaa3ee047dd80ea908f06dd031c39f2",
            "patch": "@@ -52,7 +52,7 @@ const {\n   ERR_INVALID_CALLBACK\n } = errors.codes;\n \n-const { FSReqWrap, statValues } = binding;\n+const { FSReqCallback, statValues } = binding;\n const internalFS = require('internal/fs/utils');\n const { getPathFromURL } = require('internal/url');\n const internalUtil = require('internal/util');\n@@ -179,7 +179,7 @@ function access(path, mode, callback) {\n   validatePath(path);\n \n   mode = mode | 0;\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = makeCallback(callback);\n   binding.access(pathModule.toNamespacedPath(path), mode, req);\n }\n@@ -243,7 +243,7 @@ function readFileAfterOpen(err, fd) {\n \n   context.fd = fd;\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = readFileAfterStat;\n   req.context = context;\n   binding.fstat(fd, false, req);\n@@ -284,7 +284,7 @@ function readFile(path, options, callback) {\n   const context = new ReadFileContext(callback, options.encoding);\n   context.isUserFd = isFd(path); // file descriptor ownership\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.context = context;\n   req.oncomplete = readFileAfterOpen;\n \n@@ -393,7 +393,7 @@ function readFileSync(path, options) {\n \n function close(fd, callback) {\n   validateUint32(fd, 'fd');\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = makeCallback(callback);\n   binding.close(fd, req);\n }\n@@ -418,7 +418,7 @@ function open(path, flags, mode, callback) {\n     callback = makeCallback(callback);\n   }\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n \n   binding.open(pathModule.toNamespacedPath(path),\n@@ -470,7 +470,7 @@ function read(fd, buffer, offset, length, position, callback) {\n     callback && callback(err, bytesRead || 0, buffer);\n   }\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = wrapper;\n \n   binding.read(fd, buffer, offset, length, position, req);\n@@ -519,7 +519,7 @@ function write(fd, buffer, offset, length, position, callback) {\n \n   validateUint32(fd, 'fd');\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = wrapper;\n \n   if (isUint8Array(buffer)) {\n@@ -588,7 +588,7 @@ function rename(oldPath, newPath, callback) {\n   validatePath(oldPath, 'oldPath');\n   newPath = getPathFromURL(newPath);\n   validatePath(newPath, 'newPath');\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.rename(pathModule.toNamespacedPath(oldPath),\n                  pathModule.toNamespacedPath(newPath),\n@@ -622,7 +622,7 @@ function truncate(path, len, callback) {\n   callback = maybeCallback(callback);\n   fs.open(path, 'r+', function(er, fd) {\n     if (er) return callback(er);\n-    const req = new FSReqWrap();\n+    const req = new FSReqCallback();\n     req.oncomplete = function oncomplete(er) {\n       fs.close(fd, function(er2) {\n         callback(er || er2);\n@@ -661,7 +661,7 @@ function ftruncate(fd, len = 0, callback) {\n   validateUint32(fd, 'fd');\n   validateInteger(len, 'len');\n   len = Math.max(0, len);\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = makeCallback(callback);\n   binding.ftruncate(fd, len, req);\n }\n@@ -679,7 +679,7 @@ function rmdir(path, callback) {\n   callback = makeCallback(callback);\n   path = getPathFromURL(path);\n   validatePath(path);\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.rmdir(pathModule.toNamespacedPath(path), req);\n }\n@@ -694,7 +694,7 @@ function rmdirSync(path) {\n \n function fdatasync(fd, callback) {\n   validateUint32(fd, 'fd');\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = makeCallback(callback);\n   binding.fdatasync(fd, req);\n }\n@@ -708,7 +708,7 @@ function fdatasyncSync(fd) {\n \n function fsync(fd, callback) {\n   validateUint32(fd, 'fd');\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = makeCallback(callback);\n   binding.fsync(fd, req);\n }\n@@ -732,7 +732,7 @@ function mkdir(path, mode, callback) {\n     mode = validateMode(mode, 'mode', 0o777);\n   }\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.mkdir(pathModule.toNamespacedPath(path), mode, req);\n }\n@@ -752,7 +752,7 @@ function readdir(path, options, callback) {\n   path = getPathFromURL(path);\n   validatePath(path);\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.readdir(pathModule.toNamespacedPath(path), options.encoding, req);\n }\n@@ -774,7 +774,7 @@ function fstat(fd, options, callback) {\n     options = {};\n   }\n   validateUint32(fd, 'fd');\n-  const req = new FSReqWrap(options.bigint);\n+  const req = new FSReqCallback(options.bigint);\n   req.oncomplete = makeStatsCallback(callback);\n   binding.fstat(fd, options.bigint, req);\n }\n@@ -787,7 +787,7 @@ function lstat(path, options, callback) {\n   callback = makeStatsCallback(callback);\n   path = getPathFromURL(path);\n   validatePath(path);\n-  const req = new FSReqWrap(options.bigint);\n+  const req = new FSReqCallback(options.bigint);\n   req.oncomplete = callback;\n   binding.lstat(pathModule.toNamespacedPath(path), options.bigint, req);\n }\n@@ -800,7 +800,7 @@ function stat(path, options, callback) {\n   callback = makeStatsCallback(callback);\n   path = getPathFromURL(path);\n   validatePath(path);\n-  const req = new FSReqWrap(options.bigint);\n+  const req = new FSReqCallback(options.bigint);\n   req.oncomplete = callback;\n   binding.stat(pathModule.toNamespacedPath(path), options.bigint, req);\n }\n@@ -838,7 +838,7 @@ function readlink(path, options, callback) {\n   options = getOptions(options, {});\n   path = getPathFromURL(path);\n   validatePath(path, 'oldPath');\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.readlink(pathModule.toNamespacedPath(path), options.encoding, req);\n }\n@@ -864,7 +864,7 @@ function symlink(target, path, type_, callback_) {\n   validatePath(path);\n \n   const flags = stringToSymlinkType(type);\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n \n   binding.symlink(preprocessSymlinkDestination(target, type, path),\n@@ -894,7 +894,7 @@ function link(existingPath, newPath, callback) {\n   validatePath(existingPath, 'existingPath');\n   validatePath(newPath, 'newPath');\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n \n   binding.link(pathModule.toNamespacedPath(existingPath),\n@@ -920,7 +920,7 @@ function unlink(path, callback) {\n   callback = makeCallback(callback);\n   path = getPathFromURL(path);\n   validatePath(path);\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.unlink(pathModule.toNamespacedPath(path), req);\n }\n@@ -938,7 +938,7 @@ function fchmod(fd, mode, callback) {\n   mode = validateMode(mode, 'mode');\n   callback = makeCallback(callback);\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.fchmod(fd, mode, req);\n }\n@@ -989,7 +989,7 @@ function chmod(path, mode, callback) {\n   mode = validateMode(mode, 'mode');\n   callback = makeCallback(callback);\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.chmod(pathModule.toNamespacedPath(path), mode, req);\n }\n@@ -1010,7 +1010,7 @@ function lchown(path, uid, gid, callback) {\n   validatePath(path);\n   validateUint32(uid, 'uid');\n   validateUint32(gid, 'gid');\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.lchown(pathModule.toNamespacedPath(path), uid, gid, req);\n }\n@@ -1030,7 +1030,7 @@ function fchown(fd, uid, gid, callback) {\n   validateUint32(uid, 'uid');\n   validateUint32(gid, 'gid');\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = makeCallback(callback);\n   binding.fchown(fd, uid, gid, req);\n }\n@@ -1052,7 +1052,7 @@ function chown(path, uid, gid, callback) {\n   validateUint32(uid, 'uid');\n   validateUint32(gid, 'gid');\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.chown(pathModule.toNamespacedPath(path), uid, gid, req);\n }\n@@ -1072,7 +1072,7 @@ function utimes(path, atime, mtime, callback) {\n   path = getPathFromURL(path);\n   validatePath(path);\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.utimes(pathModule.toNamespacedPath(path),\n                  toUnixTimestamp(atime),\n@@ -1094,7 +1094,7 @@ function futimes(fd, atime, mtime, callback) {\n   validateUint32(fd, 'fd');\n   atime = toUnixTimestamp(atime, 'atime');\n   mtime = toUnixTimestamp(mtime, 'mtime');\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = makeCallback(callback);\n   binding.futimes(fd, atime, mtime, req);\n }\n@@ -1635,7 +1635,7 @@ realpath.native = function(path, options, callback) {\n   options = getOptions(options, {});\n   path = getPathFromURL(path);\n   validatePath(path);\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   return binding.realpath(path, options.encoding, req);\n };\n@@ -1647,7 +1647,7 @@ function mkdtemp(prefix, options, callback) {\n     throw new ERR_INVALID_ARG_TYPE('prefix', 'string', prefix);\n   }\n   nullCheck(prefix, 'prefix');\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = callback;\n   binding.mkdtemp(`${prefix}XXXXXX`, options.encoding, req);\n }\n@@ -1684,7 +1684,7 @@ function copyFile(src, dest, flags, callback) {\n   src = pathModule._makeLong(src);\n   dest = pathModule._makeLong(dest);\n   flags = flags | 0;\n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = makeCallback(callback);\n   binding.copyFile(src, dest, flags, req);\n }"
        },
        {
            "sha": "62d2ed9e7d91ca5e1e21cf110b9a740f6c8d717d",
            "filename": "lib/internal/fs/read_file_context.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/lib%2Finternal%2Ffs%2Fread_file_context.js",
            "raw_url": "https://github.com/nodejs/node/raw/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/lib%2Finternal%2Ffs%2Fread_file_context.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ffs%2Fread_file_context.js?ref=172b4d7cebaa3ee047dd80ea908f06dd031c39f2",
            "patch": "@@ -1,7 +1,7 @@\n 'use strict';\n \n const { Buffer } = require('buffer');\n-const { FSReqWrap, close, read } = process.binding('fs');\n+const { FSReqCallback, close, read } = process.binding('fs');\n \n const kReadFileBufferLength = 8 * 1024;\n \n@@ -81,15 +81,15 @@ class ReadFileContext {\n       length = Math.min(kReadFileBufferLength, this.size - this.pos);\n     }\n \n-    const req = new FSReqWrap();\n+    const req = new FSReqCallback();\n     req.oncomplete = readFileAfterRead;\n     req.context = this;\n \n     read(this.fd, buffer, offset, length, -1, req);\n   }\n \n   close(err) {\n-    const req = new FSReqWrap();\n+    const req = new FSReqCallback();\n     req.oncomplete = readFileAfterClose;\n     req.context = this;\n     this.err = err;"
        },
        {
            "sha": "14d13062755cbcb0ab6986cd0775202be1a6cb71",
            "filename": "lib/internal/fs/streams.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/lib%2Finternal%2Ffs%2Fstreams.js",
            "raw_url": "https://github.com/nodejs/node/raw/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/lib%2Finternal%2Ffs%2Fstreams.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ffs%2Fstreams.js?ref=172b4d7cebaa3ee047dd80ea908f06dd031c39f2",
            "patch": "@@ -1,7 +1,7 @@\n 'use strict';\n \n const {\n-  FSReqWrap,\n+  FSReqCallback,\n   writeBuffers\n } = process.binding('fs');\n const {\n@@ -330,7 +330,7 @@ function writev(fd, chunks, position, callback) {\n     callback(err, written || 0, chunks);\n   }\n \n-  const req = new FSReqWrap();\n+  const req = new FSReqCallback();\n   req.oncomplete = wrapper;\n   writeBuffers(fd, chunks, position, req);\n }"
        },
        {
            "sha": "9303bcc3035fd73ea906cd08da1f76be6436c2a0",
            "filename": "src/node_file.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 10,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/src%2Fnode_file.cc",
            "raw_url": "https://github.com/nodejs/node/raw/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/src%2Fnode_file.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_file.cc?ref=172b4d7cebaa3ee047dd80ea908f06dd031c39f2",
            "patch": "@@ -407,15 +407,15 @@ int FileHandle::DoShutdown(ShutdownWrap* req_wrap) {\n }\n \n \n-void FSReqWrap::Reject(Local<Value> reject) {\n+void FSReqCallback::Reject(Local<Value> reject) {\n   MakeCallback(env()->oncomplete_string(), 1, &reject);\n }\n \n-void FSReqWrap::ResolveStat(const uv_stat_t* stat) {\n+void FSReqCallback::ResolveStat(const uv_stat_t* stat) {\n   Resolve(node::FillGlobalStatsArray(env(), stat, use_bigint()));\n }\n \n-void FSReqWrap::Resolve(Local<Value> value) {\n+void FSReqCallback::Resolve(Local<Value> value) {\n   Local<Value> argv[2] {\n     Null(env()->isolate()),\n     value\n@@ -425,14 +425,14 @@ void FSReqWrap::Resolve(Local<Value> value) {\n                argv);\n }\n \n-void FSReqWrap::SetReturnValue(const FunctionCallbackInfo<Value>& args) {\n+void FSReqCallback::SetReturnValue(const FunctionCallbackInfo<Value>& args) {\n   args.GetReturnValue().SetUndefined();\n }\n \n-void NewFSReqWrap(const FunctionCallbackInfo<Value>& args) {\n+void NewFSReqCallback(const FunctionCallbackInfo<Value>& args) {\n   CHECK(args.IsConstructCall());\n   Environment* env = Environment::GetCurrent(args.GetIsolate());\n-  new FSReqWrap(env, args.This(), args[0]->IsTrue());\n+  new FSReqCallback(env, args.This(), args[0]->IsTrue());\n }\n \n FSReqAfterScope::FSReqAfterScope(FSReqBase* wrap, uv_fs_t* req)\n@@ -600,7 +600,7 @@ void AfterScanDir(uv_fs_t* req) {\n \n \n // This class is only used on sync fs calls.\n-// For async calls FSReqWrap is used.\n+// For async calls FSReqCallback is used.\n class FSReqWrapSync {\n  public:\n   FSReqWrapSync() {}\n@@ -1957,13 +1957,13 @@ void Initialize(Local<Object> target,\n \n   StatWatcher::Initialize(env, target);\n \n-  // Create FunctionTemplate for FSReqWrap\n+  // Create FunctionTemplate for FSReqCallback\n   Local<FunctionTemplate> fst =\n-      FunctionTemplate::New(env->isolate(), NewFSReqWrap);\n+      FunctionTemplate::New(env->isolate(), NewFSReqCallback);\n   fst->InstanceTemplate()->SetInternalFieldCount(1);\n   AsyncWrap::AddWrapMethods(env, fst);\n   Local<String> wrapString =\n-      FIXED_ONE_BYTE_STRING(env->isolate(), \"FSReqWrap\");\n+      FIXED_ONE_BYTE_STRING(env->isolate(), \"FSReqCallback\");\n   fst->SetClassName(wrapString);\n   target->Set(context, wrapString, fst->GetFunction()).FromJust();\n "
        },
        {
            "sha": "049074e111ac6538a30df631448a08bf09898a0d",
            "filename": "src/node_file.h",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/src%2Fnode_file.h",
            "raw_url": "https://github.com/nodejs/node/raw/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/src%2Fnode_file.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_file.h?ref=172b4d7cebaa3ee047dd80ea908f06dd031c39f2",
            "patch": "@@ -85,9 +85,9 @@ class FSReqBase : public ReqWrap<uv_fs_t> {\n   DISALLOW_COPY_AND_ASSIGN(FSReqBase);\n };\n \n-class FSReqWrap : public FSReqBase {\n+class FSReqCallback : public FSReqBase {\n  public:\n-  FSReqWrap(Environment* env, Local<Object> req, bool use_bigint)\n+  FSReqCallback(Environment* env, Local<Object> req, bool use_bigint)\n       : FSReqBase(env, req, AsyncWrap::PROVIDER_FSREQWRAP, use_bigint) { }\n \n   void Reject(Local<Value> reject) override;\n@@ -99,10 +99,10 @@ class FSReqWrap : public FSReqBase {\n     tracker->TrackThis(this);\n   }\n \n-  ADD_MEMORY_INFO_NAME(FSReqWrap)\n+  ADD_MEMORY_INFO_NAME(FSReqCallback)\n \n  private:\n-  DISALLOW_COPY_AND_ASSIGN(FSReqWrap);\n+  DISALLOW_COPY_AND_ASSIGN(FSReqCallback);\n };\n \n template <typename NativeT = double, typename V8T = v8::Float64Array>"
        },
        {
            "sha": "1f77267922689d71b9d2e38dcb7f573ba442b80c",
            "filename": "test/sequential/test-async-wrap-getasyncid.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "raw_url": "https://github.com/nodejs/node/raw/172b4d7cebaa3ee047dd80ea908f06dd031c39f2/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-async-wrap-getasyncid.js?ref=172b4d7cebaa3ee047dd80ea908f06dd031c39f2",
            "patch": "@@ -133,11 +133,11 @@ if (common.hasCrypto) { // eslint-disable-line node-core/crypto-check\n   const binding = process.binding('fs');\n   const path = require('path');\n \n-  const FSReqWrap = binding.FSReqWrap;\n-  const req = new FSReqWrap();\n+  const FSReqCallback = binding.FSReqCallback;\n+  const req = new FSReqCallback();\n   req.oncomplete = () => { };\n \n-  testInitialized(req, 'FSReqWrap');\n+  testInitialized(req, 'FSReqCallback');\n   binding.access(path.toNamespacedPath('../'), fs.F_OK, req);\n \n   const StatWatcher = binding.StatWatcher;"
        }
    ],
    "stats": {
        "total": 110,
        "additions": 55,
        "deletions": 55
    }
}