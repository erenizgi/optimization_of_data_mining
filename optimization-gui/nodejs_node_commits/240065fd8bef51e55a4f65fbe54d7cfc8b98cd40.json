{
    "author": "BridgeAR",
    "message": "test: verify input flags\n\nThis makes sure all required flags are passed through to the test.\nIf that's not the case an error is thrown to inform the user what\nflag is missing.\n\nPR-URL: https://github.com/nodejs/node/pull/24876\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Rich Trott <rtrott@gmail.com>",
    "sha": "240065fd8bef51e55a4f65fbe54d7cfc8b98cd40",
    "files": [
        {
            "sha": "5cd8a725b09fafdcb3a83a1c68d859e1a3560abe",
            "filename": "test/common/index.js",
            "status": "modified",
            "additions": 38,
            "deletions": 0,
            "changes": 38,
            "blob_url": "https://github.com/nodejs/node/blob/240065fd8bef51e55a4f65fbe54d7cfc8b98cd40/test%2Fcommon%2Findex.js",
            "raw_url": "https://github.com/nodejs/node/raw/240065fd8bef51e55a4f65fbe54d7cfc8b98cd40/test%2Fcommon%2Findex.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Findex.js?ref=240065fd8bef51e55a4f65fbe54d7cfc8b98cd40",
            "patch": "@@ -45,6 +45,44 @@ const isMainThread = (() => {\n   }\n })();\n \n+// Check for flags. Skip this for workers (both, the `cluster` module and\n+// `worker_threads`) and child processes.\n+if (process.argv.length === 2 &&\n+    isMainThread &&\n+    module.parent &&\n+    require('cluster').isMaster) {\n+  // The copyright notice is relatively big and the flags could come afterwards.\n+  const bytesToRead = 1500;\n+  const buffer = Buffer.allocUnsafe(bytesToRead);\n+  const fd = fs.openSync(module.parent.filename, 'r');\n+  fs.readSync(fd, buffer, 0, bytesToRead);\n+  fs.closeSync(fd);\n+  const source = buffer.toString();\n+\n+  const flagStart = source.indexOf('// Flags: --') + 10;\n+  if (flagStart !== 9) {\n+    let flagEnd = source.indexOf('\\n', flagStart);\n+    // Normalize different EOL.\n+    if (source[flagEnd - 1] === '\\r') {\n+      flagEnd--;\n+    }\n+    const flags = source\n+      .substring(flagStart, flagEnd)\n+      .replace(/_/g, '-')\n+      .split(' ');\n+    const args = process.execArgv.map((arg) => arg.replace(/_/g, '-'));\n+    for (const flag of flags) {\n+      if (!args.includes(flag) &&\n+          // If the binary is build without `intl` the inspect option is\n+          // invalid. The test itself should handle this case.\n+          (process.config.variables.v8_enable_inspector !== 0 ||\n+            !flag.startsWith('--inspect'))) {\n+        throw new Error(`Test has to be started with the flag: '${flag}'`);\n+      }\n+    }\n+  }\n+}\n+\n const isWindows = process.platform === 'win32';\n const isAIX = process.platform === 'aix';\n const isLinuxPPCBE = (process.platform === 'linux') &&"
        }
    ],
    "stats": {
        "total": 38,
        "additions": 38,
        "deletions": 0
    }
}