{
    "author": "jasnell",
    "message": "test: add regression test for nghttp2 CVE-2018-1000168\n\nPR-URL: https://github.com/nodejs-private/node-private/pull/117\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Evan Lucas <evanlucas@me.com>",
    "sha": "0d79c84a839fb52ccb9e3f0c46541613a1d3db3a",
    "files": [
        {
            "sha": "f84a66861755b950ae34ceb7ca0cb08228c5d9b1",
            "filename": "test/common/http2.js",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/0d79c84a839fb52ccb9e3f0c46541613a1d3db3a/test%2Fcommon%2Fhttp2.js",
            "raw_url": "https://github.com/nodejs/node/raw/0d79c84a839fb52ccb9e3f0c46541613a1d3db3a/test%2Fcommon%2Fhttp2.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Fhttp2.js?ref=0d79c84a839fb52ccb9e3f0c46541613a1d3db3a",
            "patch": "@@ -127,8 +127,18 @@ class PingFrame extends Frame {\n   }\n }\n \n+class AltSvcFrame extends Frame {\n+  constructor(size) {\n+    const buffers = [Buffer.alloc(size)];\n+    super(size, 10, 0, 0);\n+    buffers.unshift(this[kFrameData]);\n+    this[kFrameData] = Buffer.concat(buffers);\n+  }\n+}\n+\n module.exports = {\n   Frame,\n+  AltSvcFrame,\n   DataFrame,\n   HeadersFrame,\n   SettingsFrame,"
        },
        {
            "sha": "28c0fb46b42281acc62e9d72db08ef3f6d9b921a",
            "filename": "test/parallel/test-http2-malformed-altsvc.js",
            "status": "added",
            "additions": 39,
            "deletions": 0,
            "changes": 39,
            "blob_url": "https://github.com/nodejs/node/blob/0d79c84a839fb52ccb9e3f0c46541613a1d3db3a/test%2Fparallel%2Ftest-http2-malformed-altsvc.js",
            "raw_url": "https://github.com/nodejs/node/raw/0d79c84a839fb52ccb9e3f0c46541613a1d3db3a/test%2Fparallel%2Ftest-http2-malformed-altsvc.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http2-malformed-altsvc.js?ref=0d79c84a839fb52ccb9e3f0c46541613a1d3db3a",
            "patch": "@@ -0,0 +1,39 @@\n+'use strict';\n+\n+const common = require('../common');\n+\n+if (!common.hasCrypto)\n+  common.skip('missing crypto');\n+\n+const http2 = require('http2');\n+const net = require('net');\n+const h2test = require('../common/http2');\n+\n+const server = http2.createServer();\n+server.on('stream', common.mustNotCall());\n+\n+const settings = new h2test.SettingsFrame();\n+const settingsAck = new h2test.SettingsFrame(true);\n+const altsvc = new h2test.AltSvcFrame((1 << 14) + 1);\n+\n+server.listen(0, () => {\n+  const client = net.connect(server.address().port, () => {\n+    client.write(h2test.kClientMagic, () => {\n+      client.write(settings.data, () => {\n+        client.write(settingsAck.data);\n+        // Prior to nghttp2 1.31.1, sending this malformed altsvc frame\n+        // would cause a segfault. This test is successful if a segfault\n+        // does not occur.\n+        client.write(altsvc.data, common.mustCall(() => {\n+          client.destroy();\n+        }));\n+      });\n+    });\n+  });\n+\n+  // An error may or may not be emitted on the client side, we don't care\n+  // either way if it is, but we don't want to die if it is.\n+  client.on('error', () => {});\n+  client.on('close', common.mustCall(() => server.close()));\n+  client.resume();\n+});"
        }
    ],
    "stats": {
        "total": 49,
        "additions": 49,
        "deletions": 0
    }
}