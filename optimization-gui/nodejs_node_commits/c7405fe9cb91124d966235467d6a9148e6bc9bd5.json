{
    "author": "addaleax",
    "message": "Revert \"tty: make _read throw ERR_TTY_WRITABLE_NOT_READABLE\"\n\nThis reverts commit 91eec00ca20a54b1dc010cfc2fb34bc2f39eab6b.\n\nRefs: https://github.com/nodejs/node/pull/21654\nRefs: https://github.com/nodejs/node/issues/21203\n\nPR-URL: https://github.com/nodejs/node/pull/23053\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "c7405fe9cb91124d966235467d6a9148e6bc9bd5",
    "files": [
        {
            "sha": "1cdd1d0f20aa73d71cd29bb6ff54073351de45e6",
            "filename": "doc/api/errors.md",
            "status": "modified",
            "additions": 7,
            "deletions": 6,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/c7405fe9cb91124d966235467d6a9148e6bc9bd5/doc%2Fapi%2Ferrors.md",
            "raw_url": "https://github.com/nodejs/node/raw/c7405fe9cb91124d966235467d6a9148e6bc9bd5/doc%2Fapi%2Ferrors.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Ferrors.md?ref=c7405fe9cb91124d966235467d6a9148e6bc9bd5",
            "patch": "@@ -1708,12 +1708,6 @@ A `Transform` stream finished with data still in the write buffer.\n \n The initialization of a TTY failed due to a system error.\n \n-<a id=\"ERR_TTY_WRITABLE_NOT_READABLE\"></a>\n-### ERR_TTY_WRITABLE_NOT_READABLE\n-\n-This `Error` is thrown when a read is attempted on a TTY `WriteStream`,\n-such as `process.stdout.on('data')`.\n-\n <a id=\"ERR_UNCAUGHT_EXCEPTION_CAPTURE_ALREADY_SET\"></a>\n ### ERR_UNCAUGHT_EXCEPTION_CAPTURE_ALREADY_SET\n \n@@ -2068,6 +2062,13 @@ instance.setEncoding('utf8');\n An attempt has been made to create a string larger than the maximum allowed\n size.\n \n+<a id=\"ERR_TTY_WRITABLE_NOT_READABLE\"></a>\n+#### ERR_TTY_WRITABLE_NOT_READABLE\n+\n+This `Error` is thrown when a read is attempted on a TTY `WriteStream`,\n+such as `process.stdout.on('data')`.\n+\n+\n [`--force-fips`]: cli.html#cli_force_fips\n [`'uncaughtException'`]: process.html#process_event_uncaughtexception\n [`child_process`]: child_process.html"
        },
        {
            "sha": "b9a1282c6e673a7c89bf384807be8124dbcd8ee6",
            "filename": "lib/internal/errors.js",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/c7405fe9cb91124d966235467d6a9148e6bc9bd5/lib%2Finternal%2Ferrors.js",
            "raw_url": "https://github.com/nodejs/node/raw/c7405fe9cb91124d966235467d6a9148e6bc9bd5/lib%2Finternal%2Ferrors.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ferrors.js?ref=c7405fe9cb91124d966235467d6a9148e6bc9bd5",
            "patch": "@@ -844,9 +844,6 @@ E('ERR_TRANSFORM_ALREADY_TRANSFORMING',\n E('ERR_TRANSFORM_WITH_LENGTH_0',\n   'Calling transform done when writableState.length != 0', Error);\n E('ERR_TTY_INIT_FAILED', 'TTY initialization failed', SystemError);\n-E('ERR_TTY_WRITABLE_NOT_READABLE',\n-  'The Writable side of a TTY is not Readable',\n-  Error);\n E('ERR_UNCAUGHT_EXCEPTION_CAPTURE_ALREADY_SET',\n   '`process.setupUncaughtExceptionCapture()` was called while a capture ' +\n     'callback was already active',"
        },
        {
            "sha": "62945a78eb1f0f4f46ee4d5e23c3ebaf7164f792",
            "filename": "lib/tty.js",
            "status": "modified",
            "additions": 1,
            "deletions": 12,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/c7405fe9cb91124d966235467d6a9148e6bc9bd5/lib%2Ftty.js",
            "raw_url": "https://github.com/nodejs/node/raw/c7405fe9cb91124d966235467d6a9148e6bc9bd5/lib%2Ftty.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ftty.js?ref=c7405fe9cb91124d966235467d6a9148e6bc9bd5",
            "patch": "@@ -25,11 +25,7 @@ const { inherits, _extend } = require('util');\n const net = require('net');\n const { TTY, isTTY } = internalBinding('tty_wrap');\n const errors = require('internal/errors');\n-const {\n-  ERR_INVALID_FD,\n-  ERR_TTY_INIT_FAILED,\n-  ERR_TTY_WRITABLE_NOT_READABLE\n-} = errors.codes;\n+const { ERR_INVALID_FD, ERR_TTY_INIT_FAILED } = errors.codes;\n const { getColorDepth } = require('internal/tty');\n \n // Lazy loaded for startup performance.\n@@ -131,13 +127,6 @@ WriteStream.prototype._refreshSize = function() {\n   }\n };\n \n-// A WriteStream is not readable from, so _read become a no-op.\n-// this method could still be called because net.Socket()\n-// is a duplex\n-WriteStream.prototype._read = function() {\n-  this.destroy(new ERR_TTY_WRITABLE_NOT_READABLE());\n-};\n-\n // Backwards-compat\n WriteStream.prototype.cursorTo = function(x, y) {\n   if (readline === undefined) readline = require('readline');"
        },
        {
            "sha": "12ec1df45ad59806c055c4445a8bfe75b32b918b",
            "filename": "test/pseudo-tty/test-tty-write-stream-resume-crash.js",
            "status": "removed",
            "additions": 0,
            "deletions": 17,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/17a0cd2bab405bbaaf890aa52043b273d61db3d8/test%2Fpseudo-tty%2Ftest-tty-write-stream-resume-crash.js",
            "raw_url": "https://github.com/nodejs/node/raw/17a0cd2bab405bbaaf890aa52043b273d61db3d8/test%2Fpseudo-tty%2Ftest-tty-write-stream-resume-crash.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fpseudo-tty%2Ftest-tty-write-stream-resume-crash.js?ref=17a0cd2bab405bbaaf890aa52043b273d61db3d8",
            "patch": "@@ -1,17 +0,0 @@\n-'use strict';\n-\n-const common = require('../common');\n-const { WriteStream } = require('tty');\n-const fd = common.getTTYfd();\n-\n-// Calling resume on a tty.WriteStream should be a no-op\n-// Ref: https://github.com/nodejs/node/issues/21203\n-\n-const stream = new WriteStream(fd);\n-stream.resume();\n-\n-stream.on('error', common.expectsError({\n-  code: 'ERR_TTY_WRITABLE_NOT_READABLE',\n-  type: Error,\n-  message: 'The Writable side of a TTY is not Readable'\n-}));"
        },
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "test/pseudo-tty/test-tty-write-stream-resume-crash.out",
            "status": "removed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/nodejs/node/blob/17a0cd2bab405bbaaf890aa52043b273d61db3d8/test%2Fpseudo-tty%2Ftest-tty-write-stream-resume-crash.out",
            "raw_url": "https://github.com/nodejs/node/raw/17a0cd2bab405bbaaf890aa52043b273d61db3d8/test%2Fpseudo-tty%2Ftest-tty-write-stream-resume-crash.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fpseudo-tty%2Ftest-tty-write-stream-resume-crash.out?ref=17a0cd2bab405bbaaf890aa52043b273d61db3d8"
        }
    ],
    "stats": {
        "total": 46,
        "additions": 8,
        "deletions": 38
    }
}