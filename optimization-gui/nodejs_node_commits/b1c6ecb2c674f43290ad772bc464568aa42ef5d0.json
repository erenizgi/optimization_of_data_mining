{
    "author": "joyeecheung",
    "message": "fs: fix misplaced errors in fs.symlinkSync\n\nThe ctx.error is supposed to be handled in fs.readlinkSync,\nbut was handled in fs.symlinkSync by mistake.\n\nAlso fix the error number check in readlink to be consistent\nwith SYNC_CALL.\n\nPR-URL: https://github.com/nodejs/node/pull/18548\nRefs: https://github.com/nodejs/node/pull/18348\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "b1c6ecb2c674f43290ad772bc464568aa42ef5d0",
    "files": [
        {
            "sha": "da718f3f334413fada492cb2b064fcb0ba56a6f0",
            "filename": "lib/fs.js",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/b1c6ecb2c674f43290ad772bc464568aa42ef5d0/lib%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/b1c6ecb2c674f43290ad772bc464568aa42ef5d0/lib%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs.js?ref=b1c6ecb2c674f43290ad772bc464568aa42ef5d0",
            "patch": "@@ -1161,6 +1161,11 @@ fs.readlinkSync = function(path, options) {\n                                   options.encoding, undefined, ctx);\n   if (ctx.errno !== undefined) {\n     throw errors.uvException(ctx);\n+  } else if (ctx.error) {\n+    // TODO(joyeecheung): this is an encoding error usually caused by memory\n+    // problems. We need to figure out proper error code(s) for this.\n+    Error.captureStackTrace(ctx.error);\n+    throw ctx.error;\n   }\n   return result;\n };\n@@ -1232,11 +1237,6 @@ fs.symlinkSync = function(target, path, type) {\n \n   if (ctx.errno !== undefined) {\n     throw errors.uvException(ctx);\n-  } else if (ctx.error) {\n-    // TODO(joyeecheung): this is an encoding error usually caused by memory\n-    // problems. We need to figure out proper error code(s) for this.\n-    Error.captureStackTrace(ctx.error);\n-    throw ctx.error;\n   }\n };\n "
        },
        {
            "sha": "62dd5fe80cf8b2c29b6b47bb484e0cc69ff9f967",
            "filename": "src/node_file.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/b1c6ecb2c674f43290ad772bc464568aa42ef5d0/src%2Fnode_file.cc",
            "raw_url": "https://github.com/nodejs/node/raw/b1c6ecb2c674f43290ad772bc464568aa42ef5d0/src%2Fnode_file.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_file.cc?ref=b1c6ecb2c674f43290ad772bc464568aa42ef5d0",
            "patch": "@@ -886,7 +886,7 @@ static void ReadLink(const FunctionCallbackInfo<Value>& args) {\n     fs_req_wrap req;\n     int err = SyncCall(env, args[3], &req, \"readlink\",\n                        uv_fs_readlink, *path);\n-    if (err) {\n+    if (err < 0) {\n       return;  // syscall failed, no need to continue, error info is in ctx\n     }\n     const char* link_path = static_cast<const char*>(req.req.ptr);"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 6,
        "deletions": 6
    }
}